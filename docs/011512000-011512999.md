# StackOverflow 问答 11512000-11512999

# forms - 如何在 Coldfusion CFC 中使用 15 位动态 ID 参数表单字段？

> ID：11512005
> 
> 赞同：0
> 
> 时间：2012-07-16T20:27:39.423
> 
> 标签：forms, coldfusion, cfc

我有一个购物篮，它根据数据库记录使用 id 标记隐藏的输入。所以输入可能如下所示：

```
<input type="hidden" name="qty12345678" value="5" /> 
```

其中“12345678”是篮子中记录的 ID。

我正在使用 AJAX 提交带有这些输入的表单并将它们发送到 CFC 进行处理。我通常在 CFC 中预先定义我的所有表单字段值，如下所示：

```
<cfcomponent output="false">
<cfscript>
    VARIABLES.Instance.Validation = {
            field_A = "pass"
        , field_B = "pass"
        ...
    }

<cffunction name="Defaults" access="public" returntype="struct" output="false">
    <cfscript>
    var formDefaults = {
            field_a = ""
        , field_b = ""
        ...
    }
</cfcomponent> 
```

我的问题是，我不知道如何在这个结构中定义动态表单字段。字段可以有任何 15 位 ID，所以当我不知道输入字段的 ID 和名称时，我需要某种循环来预设表单字段。

**问题**：
如何定义使用动态 15 位 ID 的表单域？如果有更好的方法将信息输入我的 CFC，我也不介意。我的购物篮表中确实有卖家 ID、买家 ID、商品编号和数量作为记录，但是当用户订购 10 件商品时，我无法在表单中设置名称为 ean/qty/buyer/seller 的 10 个输入，可以吗？我也不能在我的 CFC 中对这些值进行参数化。我迷路了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:42:06.783

我不能用一个简单的答案完全回答你的问题，但我可以为你提供一些对我很有帮助的好建议，可能会引导你走向不同的更好的方向。

开始使用微数据。创建键/值对并使用它们而不仅仅是 name 属性。浏览器不会呈现微数据。它严格用于隐藏相关信息。您可以使用 jQuery 的 data 方法或在原始 JavaScript 中类似的方式轻松检索它>

例如，你可以做这样的事情

```
<label data-dbrecord='' data-productid='' data-productqty=''></label> 
```

几个月前有人向我指出了这种方法，它真的很有帮助。我想你会看到我在使用 CFC、Ajax 和 JavaScript 时遇到了类似的问题。

[如何实现微数据属性--data-*并摆脱ID属性？](https://stackoverflow.com/questions/9197415/how-to-implement-microdata-attributes-data-and-getting-rid-of-the-id-attrib)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:31:39.707

行。问题是找到合适的位置来截取表单并添加所有动态值。

就我而言，这是在表单验证之前。我的 AJAX 调用了一个名为“process”的方法，它将表单值传递给服务器端验证，我在这里执行此操作：

```
 <!--- VALIDATE --->
 <cffunction name="Validate" access="public" returntype="array" output="false" hint="validate form inputs">

      <cfscript>
           var LOCAL = {};
           var double = structNew();
           double.form = VARIABLES.Instance.FormData;
           double.criteria = VARIABLES.Instance.Validation;
      </cfscript>

      <cfinvoke component="fvalidate" method="val" double="#double#" returnvariable="valerrors"></cfinvoke>
      <cfset LOCAL.ErrorMessages = valerrors />
      <cfreturn LOCAL.ErrorMessages />
 </cffunction> 
```

所以在调用我的验证cfc之前，我添加了这个：

```
 <cfloop collection="#VARIABLES.Instance.FormData#" item="formField">
      <cfscript>
      if ( LEFT(formField, 5) EQ "menge" OR LEFT(formField, 5) EQ "MENGE")
           VARIABLES.Instance.Validation[formField]="pass_or_criteria";
      </cfscript>
 </cfloop> 
```

所以现在我正在循环表单并检查“MENGE”的字段名称，这是我上面示例中的“val”。如果找到，我将此字段添加到我的验证结构中。这样它就不会再失败了，我也不会预先定义 100 多个表单输入。

我想当需要表单输入默认值时我也需要这样做，但这也应该在那里工作。

# types - 不匹配的类型：`expected fn@(&&@type) -> uint` but found `extern fn(@map_a) -> uint`（预期的参数模式 ++ 但找到了 &&）

> ID：11512007
> 
> 赞同：0
> 
> 时间：2012-07-16T20:27:46.783
> 
> 标签：types, rust

```
$ rustc --test mapAsMapKey.rs 
mapAsMapKey.rs:18:43: 18:52 error: mismatched types: expected `fn@(&&@map_a) -> uint` but found `extern fn(@map_a) -> uint` (expected argument mode ++ but found &&)
mapAsMapKey.rs:18     let b: map_b = hashmap::<@map_a, uint>(rmap_hash, rmap_eqer);
                                                             ^~~~~~~~~
mapAsMapKey.rs:18:54: 18:63 error: mismatched types: expected `fn@(&&@map_a, &&@map_a) -> bool` but found `extern fn(@map_a, @map_b) -> bool` (expected argument mode ++ but found &&)
mapAsMapKey.rs:18     let b: map_b = hashmap::<@map_a, uint>(rmap_hash, rmap_eqer);
                                                                        ^~~~~~~~~
error: aborting due to 2 previous errors 
```

防锈功能：

```
fn rmap_hash (m: @map_a) -> uint { 0 }
fn rmap_eqer (m1: @map_a, m2: @map_b) -> bool { true } 
```

线路触发：

```
let b: map_b = hashmap::<@map_a, uint>(rmap_hash, rmap_eqer); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T17:40:30.337

如果你像这样编写 Rust 函数，它会起作用吗？

```
fn rmap_hash (&&m: @map_a) -> uint { 0 }

fn rmap_eqer (&&m1: @map_a, &&m2: @map_b) -> bool { true } 
```

# deployment - 如何在 AWS Elastic Beanstalk 部署新版本应用程序期间防止停机？

> ID：11512011
> 
> 赞同：29
> 
> 时间：2012-07-16T20:28:16.927
> 
> 标签：deployment, amazon-web-services, amazon-ec2, production-environment, amazon-elastic-beanstalk

我对[Elastic Beanstalk](http://aws.amazon.com/elasticbeanstalk/)的理解是，当您部署应用程序的新版本时，它会一次将其部署到[Amazon EC2](http://aws.amazon.com/ec2/)实例（如果您有多个实例）。但是，即使至少有两个实例，当我`.war`在部署应用程序时上传新的应用程序时，它也会导致很短的停机时间，就好像它同时更新它们一样。有没有一种方法可以确保没有停机时间并且一个实例已完全更新并在下一次开始之前接受请求：这是事件的外观。请注意，这是应用程序的零负载，因此生产流量只会变得更糟。

```
INFO
Environment update completed successfully.

INFO
New application version was deployed to running EC2 instances.

ERROR
The application did not respond at the health check URL.

INFO
Waiting for 8 seconds while EC2 instances download the updated application version.

INFO
Deploying version SomethingMore to 2 instance(s). 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-17T17:09:17.947

[要在Elastic Beanstalk](http://aws.amazon.com/elasticbeanstalk/)中实现此目标，您需要扩展部署过程以促进多个*环境*（请参阅[AWS Elastic Beanstalk 组件](http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/concepts.components.html)）：

> 环境是部署到 AWS 资源上的版本。每个环境只运行一个版本，但是**您可以在多个环境中同时运行相同或不同的版本**。[...] 有关创建的环境和资源的更多信息，请参阅[架构概述](http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/concepts.concepts.architecture.html)。*[强调我的]*

此功能对于已经测试/调试单独的版本很有用，但特别是这也支持环境的热交换，请参阅[部署具有零停机时间的版本以](http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/using-features.CNAMESwap.html)获取相应的演练：

> 由于 AWS Elastic Beanstalk 在您更新应用程序版本时会执行就地更新，因此您会遇到一些停机时间。但是，**可以通过为您的环境交换 CNAME 来避免这种停机时间**。本部分将引导您了解如何使用 AWS 管理控制台、命令行界面或 API 执行 CNAME 交换。*[强调我的]*

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-11-02T21:02:47.547

我知道这是一个老问题，但是对于使用谷歌搜索的人（比如我），Elastic Beanstalk 今天（2014 年 11 月 2 日）发布了滚动应用程序版本部署。

[http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/using-features.rolling-version-deploy.html?sc_ichannel=em&sc_icountry=global&sc_icampaigntype=launch&sc_icampaign=em_125873140&sc_idetail=em_14124901705&ref_=pe_411040_125873140_8](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/using-features.rolling-version-deploy.html?sc_ichannel=em&sc_icountry=global&sc_icampaigntype=launch&sc_icampaign=em_125873140&sc_idetail=em_14124901705&ref_=pe_411040_125873140_8)

这使您可以一次使用新应用程序更新部分队列，确保始终有主机可用于获取流量。

# excel - Excel 2003 - 将 A 列与 B 列和 C 列匹配以对应于 B 列

> ID：11512012
> 
> 赞同：0
> 
> 时间：2012-07-16T20:28:21.103
> 
> 标签：excel, sorting

标题令人困惑，但这正是我所拥有的以及我需要做的：

`Column A`有一个数字列表。

`Column B`以完全不同的顺序具有相同的数字列表。

`Column C`有一个与 直接对应的数字列表`Column B`。

`Column B`需要进行排序以匹配`Column A`，并且在同一排序期间，`Column C`需要移动的内容与`Column B`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:33:28.963

*   按升序对 A 列进行排序
*   THEN 按 B 列的升序对 B + C 列进行排序

**更新**

截图在这里： [http ://www.gcflearnfree.org/excel2003/22.2](http://www.gcflearnfree.org/excel2003/22.2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:34:43.990

尝试在排序和过滤按钮下使用自定义排序。如果 A 列和 B 列具有相同的数字，您应该能够对 B 列进行升序或降序排序，然后添加第二级以对 A 列进行排序。

# spring - 如何将带注释的@Controller 注入通过 XML 配置的另一个 bean

> ID：11512014
> 
> 赞同：1
> 
> 时间：2012-07-16T20:28:32.243
> 
> 标签：spring, rest, controller, jms

我继承了一个通过两个渠道提供类似服务的代码库：

1.  REST/HTTP - 由带注释的 Spring 控制器处理
2.  JMS - 由消息驱动的 POJO 处理

两个通道上的消息结构或多或少相似，因此控制器和 JMS 侦听器中有很多冗余/重复的处理逻辑。解决此问题的一种方法是将通用逻辑提取到另一个组件中，并将该组件注入到@Controller 和 JMS 侦听器中。

可以说我现在没有时间这样做。有没有一种方法可以将控制器注入 JMS 侦听器并调用相同的控制器方法，这些方法在 REST 请求到达时由 Spring 的调度程序 servlet 自动调用。由于控制器没有 XML 配置，我如何获取其参考以注入 JMS 侦听器？我不想创建另一个具有不同“id”的控制器 bean。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:39:41.820

> 解决这个问题的一种方法是提取通用逻辑

这不是“*一种方式*”，而是**唯一的方式**。不仅因为将控制器注入 JMS 消息侦听器是您可以对架构做的最尴尬的事情之一。但也因为 Spring 本身不会让你这样做。

在 Spring MVC 中实际上有两个上下文：主要的一个（声明 JMS 侦听器的地方）和`DispatcherServlet`（MVC）上下文。后者是前者的子代，这意味着它可以从主上下文访问 bean（否则将无法访问控制器中的服务和 DAO），但反之则不行。

> 可以说我现在没有时间这样做

您当前的架构相当糟糕的事实并不能证明让它变得更糟是合理的。过去可能一些开发人员没有时间提取通用逻辑，因此出现了重复。现在你想引入从 JMS 层到 Web 层的非常不寻常的依赖关系......我宁愿忍受重复。

> 由于控制器没有 XML 配置，我如何获得它的参考

仅作记录，如果您的控制器名为`FooBarController`，则：

```
@Resource
private FooBarController fooBarController; 
```

可能有效，但幸运的是不是从父到子上下文。

# visual-c++ - 如何将 VC++ 项目导入 MS Visual Studio Express 2012 RC for Windows 8

> ID：11512029
> 
> 赞同：0
> 
> 时间：2012-07-16T20:29:47.020
> 
> 标签：visual-c++, windows-8, microsoft-metro, visual-studio-2012

如何将现有的 VC++ 库项目 (EG myVisualStudio2010project.vcxproj) 导入 MS Visual Studio Express 2012 RC for Windows 8？。

如果您尝试简单地将其包含在您的解决方案中，则会收到此错误：

**无法加载项目“myVisualStudio2010proj”，因为此版本的 Visual Studio 仅支持 Metro 风格应用、本机桌面库 (dll) 和静态库 (lib) 项目。**

我正在使用的项目相当复杂，我在尝试在新 IDE 中重新创建它时遇到了问题。有人有建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:34:25.673

Visual Studio 2012 RC Express SKU 不支持桌面应用程序开发。您将需要安装 Ultimate SKU，可从[Visual Studio 网页](http://www.microsoft.com/visualstudio/11/en-us/downloads)下载。

当 Visual Studio 2012 RTM 发布时（[8 月](https://twitter.com/jlzander/status/222895124739391488)），将有一个[Visual Studio Express 2012 for Windows Desktop](http://blogs.msdn.com/b/visualstudio/archive/2012/06/08/visual-studio-express-2012-for-windows-desktop.aspx)，它将支持桌面应用程序开发。

# java - Bean Property dataSource 在 Spring + Hibernate 3 中不可写

> ID：11512031
> 
> 赞同：0
> 
> 时间：2012-07-16T20:29:59.267
> 
> 标签：java

我搜索了很多地方，但没有找到解决以下错误的方法：

```
Exception in thread "main" org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'hibernateDaoImpl' defined in class path resource [spring.xml]: Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: Invalid property 'dataSource' of bean class [com.springhibernate.example.HibernateDaoImpl]: Bean property 'dataSource' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter?
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1385)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1107)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:516)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:455)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:139)
    at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:83)
    at com.springhibernate.example.SpringHibernateDemo.main(SpringHibernateDemo.java:13)
Caused by: org.springframework.beans.NotWritablePropertyException: Invalid property 'dataSource' of bean class [com.springhibernate.example.HibernateDaoImpl]: Bean property 'dataSource' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter?
    at org.springframework.beans.BeanWrapperImpl.setPropertyValue(BeanWrapperImpl.java:1057)
    at org.springframework.beans.BeanWrapperImpl.setPropertyValue(BeanWrapperImpl.java:920)
    at org.springframework.beans.AbstractPropertyAccessor.setPropertyValues(AbstractPropertyAccessor.java:76)
    at org.springframework.beans.AbstractPropertyAccessor.setPropertyValues(AbstractPropertyAccessor.java:58)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1382)
    ... 13 more 
```

异常来自以下 spring xml 文件配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="
http://www.springframework.org/schema/beans     
http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
http://www.springframework.org/schema/context 
http://www.springframework.org/schema/context/spring-context-3.0.xsd">

<context:annotation-config/>

<context:component-scan base-package="com.springhibernate.example"/>

<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
    <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
    <property name="url" value="jdbc:mysql://localhost:3306/HibernateTest"/>
    <property name="username" value="root"/>
    <property name="password" value="admin"/>
</bean>

<bean id="hibernateDaoImpl" class="com.springhibernate.example.HibernateDaoImpl">
    <property name="dataSource" ref="dataSource"/>
</bean>

<bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <property name="dataSource" ref="dataSource"/>
    <property name="packagesToScan" value="com.springhibernate.model"/>
    <property name="hibernateProperties">
    <props>
        <prop key="dialect">
            org.hibernate.dialect.MySQLDialect
        </prop>
    </props>
    </property>

</bean>
</beans> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:13:55.920

还没有收到你的回音-但我要在这里冒险了

通常，对于 Hibernate DAO 对象，您需要 sessionFactory 而不是 dataSource。所以给你的 DAO 一种设置 sessionFactory 的方法（例如，一个 setter 或一个构造函数——我更喜欢构造函数，因为它不需要是可变的）。

```
public class HibernateDaoImpl implements HibernateDao
{
   private SessionFactory sessionFactory;

   public HibernateDaoImpl(SessionFactory sessionFactory)
   {
     this.sessionFactory = sessionFactory;
   }
} 
```

配置

```
 <bean id="hibernateDaoImpl" class="com.springhibernate.example.HibernateDaoImpl">
   <constructor-arg ref="sessionFactory"/>
 </bean> 
```

# javascript - 检测下拉导航是否会离开屏幕并重新定位

> ID：11512032
> 
> 赞同：46
> 
> 时间：2012-07-16T20:30:02.743
> 
> 标签：javascript, jquery, html, css

我有你典型的下拉导航，我试图确保下拉菜单链接始终可访问和可见：

```
<li><a href="#">Link 1</a>
    <ul>
        <li><a href="#">Link 1</a></li>
        <li><a href="#">Link 2</a></li>
        <li><a href="#">Link 3</a></li>
    </ul>
</li>
<li><a href="#">Link 2</a>
    <ul>
        <li><a href="#">Link 1</a></li>
        <li><a href="#">Link 2</a></li>
        <li><a href="#">Link 3</a></li>
    </ul>
</li>
<!-- etc. -->
</ul> 
```

CSS 真的没有什么特别的（去除了颜色和背景）：

```
.dropdown,
.dropdown li,
.dropdown ul {
    list-style:none;
    margin:0;
    padding:0;
}
.dropdown {
    position:relative;
    z-index:10000;
    float:left;
    width:100%;
}
.dropdown ul {
    position:absolute;
    top:100%;
    visibility:hidden;
    display:none;
    width:16em;
}
.dropdown ul ul {
    top:0;
    left:100%;
}
.dropdown li {
    position:relative;
    float:left;
}
.dropdown li:hover{
    z-index:910;
}
.dropdown ul:hover,
.dropdown li:hover > ul,
.dropdown a:hover + ul,
.dropdown a:focus + ul {
    visibility:visible;
    display:block;
}
.dropdown a {
    display:block;
    padding:1em 2em;
}
.dropdown ul li {
    width:100%;
} 
```

有未知数量的顶级链接（它们是由用户创建的）。我遇到的问题是，如果顶级链接离右侧太远，有时下拉菜单（向右）会离开屏幕。我添加了一些 CSS 来弥补：

```
.dropdown > li:last-child ul { /* ...or use a class on the last link for IE */
    right:0;
} 
```

现在最后一个移到左边而不是屏幕外，这很好，但有几个问题：

1.  最后一个链接我并不总是需要这些样式，因为它并不总是在屏幕的边缘（比如只有 3 个链接）。
2.  当浏览器窗口调整大小时，链接堆叠在彼此之上（按设计）。有时，序列中间的链接最终位于右边缘，并且它们的下拉菜单被切断。
3.  有时“倒数第二个”链接的菜单也会超出边界。

调整此演示中的面板大小以了解我**的意思（红色区域被认为是“屏幕外”）** [http://jsfiddle.net/G7qfq/](http://jsfiddle.net/G7qfq/)

多年来，我一直在为这个烦人的常见问题苦苦挣扎，但从未找到令人满意的解决方案。有什么方法可以检查下拉菜单是否会离开屏幕，如果是，添加/删除`class`名称或其他内容，以便我可以使用 CSS 将其保留在屏幕上？

我可能使用的一个线索是，如果菜单*确实*离开屏幕，它总是会在窗口底部产生一个垂直滚动条，但我不确定如何使用这些知识。我尝试了[这个](https://stackoverflow.com/questions/2146874/detect-if-a-page-has-a-vertical-scrollbar)关于检测垂直滚动条的问题的公认答案，但由于某种原因它总是返回`true`，并且总是添加“边缘”类（也许时间有问题？）：

```
$(".dropdown li").on('mouseenter mouseleave', function (e) {

    // Get the computed style of the body element
    var cStyle = document.body.currentStyle||window.getComputedStyle(document.body, "");

    // Check the overflow and overflowY properties for "auto" and "visible" values
    hasVScroll = cStyle.overflow == "visible" 
             || cStyle.overflowY == "visible"
             || (hasVScroll && cStyle.overflow == "auto")
             || (hasVScroll && cStyle.overflowY == "auto");

    if (hasVScroll) {
        $(this).addClass('edge');
    } else {
        $(this).removeClass('edge');
    }
});​ 
```

使用 javascript 演示：http: [//jsfiddle.net/G7qfq/2/](http://jsfiddle.net/G7qfq/2/)

真的，我不想看到垂直滚动条，即使是一瞬间，所以我不确定这是要走的路，而且可能会出现误报（滚动条出于其他原因）。

我也尝试了[这个答案](https://stackoverflow.com/a/1725550/398242)中的解决方案，我承认，我不太明白，并且无法让它工作：http: [//jsfiddle.net/G7qfq/3/](http://jsfiddle.net/G7qfq/3/)

```
$(".dropdown li").on('mouseenter mouseleave', function (e) {

    var elm = $('ul:first', this);
    var off = elm .offset();
    var t = off.top;
    var l = off.left;
    var h = elm.height();
    var w = elm.width();
    var docH = $(window).height();
    var docW = $(window).width();

    var isEntirelyVisible = (t > 0 && l > 0 && t + h < docH && l+ w < docW);

    if ( ! isEntirelyVisible ) {
        $(this).addClass('edge');
    } else {
        $(this).removeClass('edge');
    }
});​ 
```

我假设该解决方案需要 javascript，并且我正在使用 jQuery，但我不知道如何解决这个问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-07-17T14:50:47.283

我想你几乎在那里...

你真的应该只对涉及宽度的计算感兴趣。如果下拉元素的宽度和该元素的偏移量大于容器的宽度，则需要切换菜单。

```
$(function () {
    $(".dropdown li").on('mouseenter mouseleave', function (e) {
        if ($('ul', this).length) {
            var elm = $('ul:first', this);
            var off = elm.offset();
            var l = off.left;
            var w = elm.width();
            var docH = $(".container").height();
            var docW = $(".container").width();

            var isEntirelyVisible = (l + w <= docW);

            if (!isEntirelyVisible) {
                $(this).addClass('edge');
            } else {
                $(this).removeClass('edge');
            }
        }
    });
}); 
```

[http://jsfiddle.net/G7qfq/582/](http://jsfiddle.net/G7qfq/582/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-26T13:28:03.190

这是一个可用于向右或向下弹出菜单的函数（基于@r0m4n 的代码）：

```
function fixFlyout (containerElement, parentElement,flyoutElement,flyoutDirection) {
    $(parentElement).on('mouseenter mouseleave', function (e) {
        var element = $(flyoutElement, this);
        var offset = element .offset();
        switch(flyoutDirection) {
            case 'down':
                var top = offset.top;
                var height = element.height();
                var windowHeight = $(containerElement).height();
                var isEntirelyVisible = (top + height <= windowHeight);
                break;
            case 'right':
                var left = offset.left;
                var width = element.width();
                var windowWidth = $(containerElement).width();
                var isEntirelyVisible = (left + width <= windowWidth);
                break;
        }
        if (!isEntirelyVisible ) {
            $(element).addClass('edge');
        } else {
            $(element).removeClass('edge');
        }
    });
}
//Level 1 Flyout
fixFlyout(containerElement = '.header',parentElement = '.header .navigation>.menu>.expanded',flyoutElement = '.menu:first',flyoutDirection = 'down'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-16T01:33:34.687

我无法让 addClass('edge') 正常工作，但我能够修改相关元素的 CSS 以实现该行为。（仅从 r0m4n 稍作修改）：

```
 //Align submenu to right if cut-off from window
        $(function () {
            $(".dropdown").on('mouseenter mouseleave', function (e) {
                if ($('.dropdown-content', this).length) {
                    var dropdownElement = $('.dropdown-content:first', this);
                    var elementOffset = dropdownElement.offset();
                    var elementOffsetLeft = elementOffset.left;
                    var elementWidth = dropdownElement.width();
                    var pageHeigth = $(".show-on-scroll-wrapper").height();
                    var pageWidth = $(".show-on-scroll-wrapper").width();
                    //if left offset + width of dropdown is bigger than container width then it is cut-off
                    if ((elementOffsetLeft + elementWidth) > pageWidth) {
                        //Align Right
                        $(".dropdown-content").css({ "left":"auto", "right":"0", "margin-right":"-10px;"});
                    } else {
                        //Align Left
                        $(".dropdown-content").css({ "left":"0", "right":"auto", "margin-left": "-10px;" });
                    }
                }
            });
        }); 
```

# java - java.util.List.isEmpty() 是否检查列表本身是否为空？

> ID：11512034
> 
> 赞同：128
> 
> 时间：2012-07-16T20:30:12.513
> 
> 标签：java, list

是否`java.util.List.isEmpty()`检查列表本身是否是`null`，还是我必须自己检查？

例如：

```
List<String> test = null;

if (!test.isEmpty()) {
    for (String o : test) {
        // do stuff here            
    }
} 
```

这会抛出一个`NullPointerException`因为 test is`null`吗？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2012-07-16T20:34:12.837

您正在尝试`isEmpty()`在引用上调用该方法`null`（as `List test = null;`）。这肯定会抛出一个`NullPointerException`. 你应该这样做`if(test!=null)`（首先检查`null`）。

如果对象不包含任何元素，则该方法`isEmpty()`返回 true ；`ArrayList`否则为 false （因为`List`在您的情况下，必须首先实例化是`null`）。

你可能想看看[这个问题](https://stackoverflow.com/questions/4802015/difference-between-null-and-java-string)。

* * *

## 回答 #2

> 赞同：127
> 
> 时间：2013-03-26T11:23:58.460

我建议使用[Apache Commons](https://en.wikipedia.org/wiki/Apache_Commons) Collections：

[http://commons.apache.org/proper/commons-collections/javadocs/api-release/org/apache/commons/collections4/CollectionUtils.html#isEmpty(java.util.Collection)](http://commons.apache.org/proper/commons-collections/javadocs/api-release/org/apache/commons/collections4/CollectionUtils.html#isEmpty(java.util.Collection))

它实现它非常好并且有据可查：

```
/**
 * Null-safe check if the specified collection is empty.
 * <p>
 * Null returns true.
 *
 * @param coll  the collection to check, may be null
 * @return true if empty or null
 * @since Commons Collections 3.2
 */
public static boolean isEmpty(Collection coll) {
    return (coll == null || coll.isEmpty());
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-07-16T20:33:45.377

这**将**引发`NullPointerException`- 任何尝试在引用上调用实例方法的尝试`null`- 但在这种情况下，您应该明确检查`null`：

```
if ((test != null) && !test.isEmpty()) 
```

这比传播`Exception`.

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2016-08-25T03:30:11.937

不，`java.util.List.isEmpty()`不检查列表是否为`null`.

如果您使用的是[Spring](https://en.wikipedia.org/wiki/Spring_Framework)框架，则可以使用`CollectionUtils`该类来检查列表是否为空。它还负责`null`引用。以下是 Spring 框架`CollectionUtils`类的代码片段。

```
public static boolean isEmpty(Collection<?> collection) {
    return (collection == null || collection.isEmpty());
} 
```

即使您不使用 Spring，您也可以继续调整此代码以添加到您的`AppUtil`类中。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-07-16T20:33:35.363

在任何空引用上调用任何方法总是会导致异常。先测试对象是否为空：

```
List<Object> test = null;
if (test != null && !test.isEmpty()) {
    // ...
} 
```

或者，编写一个方法来封装此逻辑：

```
public static <T> boolean IsNullOrEmpty(Collection<T> list) {
    return list == null || list.isEmpty();
} 
```

然后你可以这样做：

```
List<Object> test = null;
if (!IsNullOrEmpty(test)) {
    // ...
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-07-16T20:33:43.607

是的，它会**抛出一个 Exception**。也许你习惯了**PHP**代码，那里`empty($element)`也检查`isset($element)`. 在 Java 中，情况并非如此。

你可以很容易地记住这一点，因为该方法是直接在列表上调用的（该方法属于列表）。因此，如果没有列表，那么就没有方法。Java 会抱怨没有可以调用此方法的列表。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-07-06T09:09:27.597

除了[狮子的回答](https://stackoverflow.com/questions/11512034/does-java-util-list-isempty-check-if-the-list-itself-is-null/11512091#11512091)，我可以说你更好地使用`if(CollectionUtils.isNotEmpty(test)){...}`。

这也会检查 null，因此不需要手动检查。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-06-16T07:42:21.890

您也可以使用自己的 isEmpty （用于多个集合）方法。将此添加到您的 Util 类。

```
public static boolean isEmpty(Collection... collections) {
    for (Collection collection : collections) {
        if (null == collection || collection.isEmpty())
            return true;
    }
    return false;
} 
```

# python - 在 Ubuntu 上安装 Pycuda

> ID：11512039
> 
> 赞同：0
> 
> 时间：2012-07-16T20:30:35.363
> 
> 标签：python, boost-python, pycuda

我很难安装 pycuda。我在 Ubuntu 12.04 上运行。我首先安装了 Enthought python 发行版（即使我已经在计算机上安装了 python）。我将 enthought python 位置添加到我的 .profile 的路径中（这可以正常工作，从命令行键入 python 或 ipython 正确使用 enthought 版本）。然后我按照[http://wiki.tiker.net/PyCuda/Installation/Linux/Ubuntu](http://wiki.tiker.net/PyCuda/Installation/Linux/Ubuntu)的说明进行操作（跳过步骤 0-1，因为我已经安装了 numpy 和 cuda）。

一切似乎都可以正常运行和安装。但是当我尝试实际使用 pycuda 时，它失败了。例如，当我尝试运行 hello_gpu.py 示例时，会发生以下情况：

```
:~/Downloads/pycuda-2012.1$ python examples/hello_gpu.py 
Traceback (most recent call last):
  File "examples/hello_gpu.py", line 1, in <module>
    import pycuda.driver as drv
  File "/usr/lib/python_enthought/lib/python2.7/site-packages/pycuda-2012.1-py2.7-linux-        x86_64.egg/pycuda/driver.py", line 2, in <module>
    from pycuda._driver import *
ImportError: /usr/lib/libboost_python-py27.so.1.46.1: undefined symbol:         
PyUnicodeUCS4_FromEncodedObject 
```

或者，当我尝试从空闲导入 pycuda 包时，我得到一个不同的错误：

```
Python 2.7.3 |EPD 7.3-1 (64-bit)| (default, Apr 11 2012, 17:52:16) 
[GCC 4.1.2 20080704 (Red Hat 4.1.2-44)] on linux2
Type "credits", "demo" or "enthought" for more information.
>>> import pycuda
>>> pycuda
<module 'pycuda' from 'pycuda/__init__.pyc'>
>>> import pycuda.driver as drv
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "pycuda/driver.py", line 2, in <module>
    from pycuda._driver import *
ImportError: No module named _driver 
```

我怀疑问题的一部分是我在某个地方没有指定 python 解释器的正确路径，但我无法弄清楚这个错误发生在哪里。任何建议都会受到欢迎，我没有想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-23T09:59:11.053

此问题似乎是由同一系统上的两个不同 Python 安装之间的冲突引起的。OP 显然通过卸载 Enthough Python 安装并仅使用系统 Python 安装解决了这个问题。很可能还有其他方法可以使用非系统 Python 安装来解决这个问题，如此处所建议[的](http://markmail.org/message/7mdmxypqjwrfph4e#query:+page:1+mid:5ucnxedz4b7mblx4+state:results)

[这个答案是从评论中收集起来的，并作为社区 wiki 条目添加，希望它能获得投票并从 PyCUDA 标签的未回答列表中删除]

# jquery - 我如何正确使用 jQuery.parseJSON

> ID：11512040
> 
> 赞同：0
> 
> 时间：2012-07-16T20:30:38.990
> 
> 标签：jquery, jquery-selectors

我有一组来自服务器端的值，我试图生成 JSON 并在我的代码中使用它

这是现在的声明，问题是如果没有单引号和双引号的值很好，它工作得很好。

```
var stds = jQuery.parseJSON('<?php echo json_encode($this->emps); ?>');

  CASE 1:
  ABC:"E" DTSM  
  VCD:"E" DMST  

CASE 2:
  *****
  ABC:E DTSM  
  VCD:E DMST 
```

我如何仍然使用案例 1 生成 JSON。我收到 JS 错误“抛出异常且未捕获”。这是由于格式错误的 JSON 字符串

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T20:33:37.527

因为 JSON 已经是 JavaScript 的有效片段，所以您可以简单地编写

```
var stds = <?php echo json_encode( $this->emps ); ?>; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:33:38.217

利用`<?php echo json_encode($str); ?>`

# ios - ios opencv cvReleaseImage - 它什么时候释放内存？

> ID：11512046
> 
> 赞同：2
> 
> 时间：2012-07-16T20:30:57.437
> 
> 标签：ios, opencv, memory-leaks

我是opencv的新手。我正在将它集成到我的 ios 项目中。在我的项目中，我正在从 UIImage 转换为 IplImage，反之亦然。我还在使用 openCV 库应用不同的图像过滤器。

我正在测试我的应用程序是否泄漏。我正在使用内存监视器运行，我注意到每次运行我的 opencv 函数集时，我的应用程序都会增长大约 1 兆字节。每次我分配一个新的 iplimage 时，我都会稍后通过调用来释放它：

```
cvReleaseImage(&iplimage); 
```

我正在使用模拟器来强制低内存警告，从而释放图像内存。它似乎不会影响我的应用程序的内存大小。

cvReleaseImage 什么时候真正释放内存？我漏水了吗？

我正在使用 ios 5.1 并打开了 ARC。

编辑：

这是我用来将 UIImage 转换为 iplImage 的代码（我找到了一些复制粘贴）

```
- (UIImage *)UIImageFromIplImage:(IplImage *)image {
    NSLog(@"IplImage (%d, %d) %d bits by %d channels, %d bytes/row %s", image->width, image->height, image->depth, image->nChannels, image->widthStep, image->channelSeq);

    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    NSData *data = [NSData dataWithBytes:image->imageData length:image->imageSize];
    CGDataProviderRef provider = CGDataProviderCreateWithCFData((__bridge CFDataRef)data);
    CGImageRef imageRef = CGImageCreate(image->width, image->height,
                                        image->depth, image->depth * image->nChannels, image->widthStep,
                                        colorSpace, kCGBitmapByteOrderDefault | kCGImageAlphaLast ,
                                        provider, NULL, false, kCGRenderingIntentDefault);
    UIImage *ret = [UIImage imageWithCGImage:imageRef];
    CGImageRelease(imageRef);
    CGDataProviderRelease(provider);
    CGColorSpaceRelease(colorSpace);
    return ret;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T05:48:08.937

cvReleaseImage 绝对是在调用它的那一刻释放内存。它为图像的两个部分调用 dellocator：

*   数据
*   图片标题

如果您的应用报告内存泄漏，您应该检查整个代码 - 也许您创建 2 个图像，然后发布一个，或者其他什么。

# c# - 使用 C# 通过 targetpath 删除/修改快捷方式

> ID：11512048
> 
> 赞同：2
> 
> 时间：2012-07-16T20:31:07.803
> 
> 标签：c#, shortcut

我们有用户将他们桌面上的快捷方式文件重命名为我们的应用程序。如果应用程序的图标发生变化，基于目标路径删除/修改快捷方式的最佳方法是什么？换句话说，我很难找到文件名，因为它一直在变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:00:04.980

您应该使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)类：

> 侦听文件系统更改通知并在目录或目录中的文件更改时引发事件。

事实上，您可以利用`FileSystemWatcher.Changed`, `FileSystemWatcher.Created`, `FileSystemWatcher.Renamed`,`FileSystemWatcher.Deleted`事件来控制您的文件。

这是 MSDN 的一个例子：

```
public static void Main()
{
    // Create a new FileSystemWatcher and set its properties.
    FileSystemWatcher watcher = new FileSystemWatcher();
    watcher.Path = "mypath";
    /* Watch for changes in LastAccess and LastWrite times, and
       the renaming of files or directories. */
    watcher.NotifyFilter = NotifyFilters.LastAccess | NotifyFilters.LastWrite
       | NotifyFilters.FileName | NotifyFilters.DirectoryName;
    // Only watch text files.
    watcher.Filter = "*.txt";

    // Add event handlers.
    watcher.Changed += new FileSystemEventHandler(OnChanged);
    watcher.Created += new FileSystemEventHandler(OnChanged);
    watcher.Deleted += new FileSystemEventHandler(OnChanged);
    watcher.Renamed += new RenamedEventHandler(OnRenamed);

    // Begin watching.
    watcher.EnableRaisingEvents = true;

    // Wait for the user to quit the program.
    Console.WriteLine("Press \'q\' to quit the sample.");
    while(Console.Read()!='q');
}

// Define the event handlers.
private static void OnChanged(object source, FileSystemEventArgs e)
{
    // Specify what is done when a file is changed, created, or deleted.
   Console.WriteLine("File: " +  e.FullPath + " " + e.ChangeType);
}

private static void OnRenamed(object source, RenamedEventArgs e)
{
    // Specify what is done when a file is renamed.
    Console.WriteLine("File: {0} renamed to {1}", e.OldFullPath, e.FullPath);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:36:12.270

要删除文件，请使用[System.IO.File.Delete](http://msdn.microsoft.com/en-us/library/system.io.file.delete.aspx)方法

要修改文件，您可以使用[System.IO.File.AppendText](http://msdn.microsoft.com/en-us/library/system.io.file.appendtext)方法

> 在下面的评论后更新：
> 
> 请使用 ShellClass 创建或修改快捷方式您还需要使用 Environment.SpecialFolder.DesktopDirectory 从桌面获取特殊目录
> 
> 可以在这里找到一个非常好的示例逐步显示[http://www.codeproject.com/Articles/146757/Add-Remove-Startup-Folder-Shortcut-to-Your-App](http://www.codeproject.com/Articles/146757/Add-Remove-Startup-Folder-Shortcut-to-Your-App)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:49:24.707

重命名快捷方式不会修改目标路径，但是，我知道在 c# 中使用快捷方式的最佳方法是使用[`IwshRuntimeLibrary`](http://www.codeproject.com/Articles/3905/Creating-Shell-Links-Shortcuts-in-NET-Programs-Usi).

# iphone - 单击 UIActionSheet 中的按钮会导致我的应用程序崩溃

> ID：11512056
> 
> 赞同：1
> 
> 时间：2012-07-16T20:31:59.950
> 
> 标签：iphone, objective-c, ios, button, uiactionsheet

我正在尝试实现一个 UIActionSheet，它上面会有一些共享按钮，用于共享到 twitter、facebook、电子邮件和打印。

这是我的共享视图控制器.h

```
@interface ShareViewController : UITableViewController <UIActionSheetDelegate, MFMailComposeViewControllerDelegate>
@property (nonatomic, strong) NSMutableDictionary *services;
@property (strong, nonatomic) UIActionSheet *actionSheet;
@property (strong, nonatomic) id <ShareViewControllerDelegate> delegate;
@property (nonatomic, strong) UIPopoverController *popCon;
@property (nonatomic, strong) NSString *serviceTitle;

-(IBAction)loadActionSheet:(id)sender;
- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex;
- (void)tweetThis;
- (void)printThis;
- (void)openMail;
- (void)mailComposeController:(MFMailComposeViewController*)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error;

@end 
```

这是我的共享视图控制器.m

```
-(IBAction)loadActionSheet:(id)sender{
if (self.actionSheet) {
            // do nothing
} 
else {
UIActionSheet *sharing = [[UIActionSheet alloc] 
                          initWithTitle:nil 
                          delegate:self 
                          cancelButtonTitle:nil 
                          destructiveButtonTitle:nil 
                          otherButtonTitles:@"Twitter", @"Facebook", @"Email", @"Print", nil];

[sharing showFromBarButtonItem:sender animated:YES];
}
}

- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex
{

     NSLog(@"Button index: %d",buttonIndex);
switch (buttonIndex) {
    case 0:
        [self tweetThis];
        break;
    case 1:
        [self sendToFacebook];
        break;
    case 2:
        NSLog(@"email");
        [self openMail];
        break;
    case 3:
        NSLog(@"Print");
        [self printThis];
        break;
    default:
        NSLog(@"Error");
        break;
}
} 
```

我在主视图 controller.m 中初始化我的共享视图控制器，如下所示：

```
- (IBAction)shareButtonTapped:(id)sender {

ShareViewController *svc = [[ShareViewController alloc] initWithStyle:UIActionSheetStyleDefault];
[svc loadActionSheet:(id)sender];

} 
```

我可以很好地打开操作表，但是当我单击任何按钮时，它会使应用程序崩溃。关于为什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:37:28.187

是的。转到您的 .xib 文件。

您应该看到您拥有的所有按钮。

单击一个按钮并转到“连接检查器”

删除参考插座。

将引用插座拖到按钮上，并将按钮设置为您想要的“ID”。

让我知道这是否有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:15:15.450

这很可能是内存管理问题。看起来您正在使用 ARC，因此在`shareButtonTapped`方法返回后，ARC 将自动 release `svc`，因为它不再在任何地方引用。操作表的委托属性是`weak`，因此它也不会被保留。

我真的不明白为什么`ShareViewController`首先要使用视图控制器，因为您似乎从未加载过它的视图，但您可能有自己的理由......无论如何，您应该将该控制器设为`strong`属性或实例变量您的另一个（主）视图控制器，以便在操作表完成之前不会自动释放它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:38:26.397

只是一个愚蠢的答案 - 像 - (void) sendToFacebook; 这样的方法；都实施了，对吧？

# actionscript-3 - Actionscript-3：movieclip 中的按钮

> ID：11512060
> 
> 赞同：1
> 
> 时间：2012-07-16T20:32:15.957
> 
> 标签：actionscript-3, function, variables, button

所以，我有一个名为 bg 的电影剪辑，其中有一个名为 sleep_btn 的按钮。我正在舞台上的一个图层上进行编码，它是这样的：

```
sleep_btn.addEventListener(MouseEvent.CLICK, sleepClick);
function sleepClick(event:MouseEvent):void{
    health = 100;
    day += 1;
} 
```

我很快意识到如果没有在编码中定义电影剪辑，它将无法工作，所以我尝试了：

```
bg.sleep_btn.addEventListener(MouseEvent.CLICK, sleepClick);
function sleepClick(event:MouseEvent):void{
    health = 100;
    day = day + 1;
} 
```

我的错误消失了，但我发现当我点击按钮时，健康和日子保持不变。

这一天在文本字段中，编码如下：

```
var day:int = 1;
if (day==1) date.text = "July 1";
if (day==2) date.text = "July 2";
if (day==3) date.text = "July 3"; 
```

不断地

健康是一个 101 帧的影片剪辑，其编码如下：

```
var health:int = 100;
   lifebar.gotoAndStop(health + 1); 
```

***编辑***

**顶部横幅层：**

```
stop();
var health:int = 100;
   lifebar.gotoAndStop(health + 1);
    //Can write this also: lifebar.health += 45;
    trace("health is "+health);
    trace("day is "+day);

var day:int = 1;
updateDay();

function updateDay():void{
if (day==1) date.text = "July 1";
if (day==2) date.text = "July 2";
if (day==3) date.text = "July 3";
if (day==4) date.text = "July 3";
}

fortyfivedown_btn.addEventListener(MouseEvent.CLICK, fortyfivedownClick);
function fortyfivedownClick(event:MouseEvent):void{
    if (health < 45) {
       return;
    }
    health -= 45;
    if(health < 0) health = 0;
    else if(health > 100) health = 100;
    lifebar.gotoAndStop(health + 1);
     trace("health is "+health);
}

bg.sleep_btn.addEventListener(MouseEvent.CLICK, sleepClick);
function sleepClick(event:MouseEvent):void{
    health = 100;
    day = day + 1;

    //update lifebar
    lifebar.gotoAndStop(health + 1);

    //update day
    updateDay();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:41:00.370

是在舞台上展示吗`health`？`day`它们是什么类型的？您是否将 TextField 的文本设置为它们的值？

如果它们只是变量并且它们没有被 UI 显示，您将不会看到它们发生变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:19:19.197

您没有使用新数据更新实际的 UI 文本框。将您的日期确定代码（可以大量清理，但这超出了本问题的范围）移动到自己的函数中，以便可以重用：

```
var day:int = 1;
updateDay();

function updateDay():void{
    if (day==1) date.text = "July 1";
    if (day==2) date.text = "July 2";
    if (day==3) date.text = "July 3";
    // ...and so on...
} 
```

然后在处理程序中调用该函数（和健康更新）`sleepClick`：

```
function sleepClick(event:MouseEvent):void{
    health = 100;
    day = day + 1;

    //update lifebar
    lifebar.gotoAndStop(health + 1);

    //update day
    updateDay();
} 
```

# android - 了解片段活动生命周期

> ID：11512061
> 
> 赞同：4
> 
> 时间：2012-07-16T20:32:16.720
> 
> 标签：android, android-fragments, android-lifecycle

我创建了一个 android 应用程序，它使用 ViewPager 来浏览三个片段（三个片段中的每一个都包含一个 gridview）。

我最近开始学习片段，并假设在我的网格视图在它们的片段中创建之后，每个片段都将在内存中并且永远不必再次加载。

最近我注意到，当我从左边的片段滑到中间的片段，然后到右边的片段时，最左边的片段必须用我的适配器再次填充它的网格视图。

我只是想知道为什么当我从最左边的片段导航到最右边的片段时会发生这种情况，而不是当我在并排的片段之间导航时会发生这种情况。它是否只将最近的片段保留在内存中并杀死另一个片段？还是有其他原因导致应用程序不会将所有三个片段都保存在内存中？当我在片段之间快速导航时，我的应用程序会变得有点迟钝和缓慢，所以如果可能的话，最好只绘制一次每个 gridview。

我在 onCreate() 中填充我的arraylist（用于填充适配器），然后在 onActivityCreated(Bundle savedInstanceState) 中用适配器填充我的gridview

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T20:38:57.923

在内存中`ViewPager`保留了一定数量的屏幕外标签（`Fragment`当然是 s）。我相信所有设备的默认值是 1。因此，当您滚动到最右边时，只有它左边的那个会被保存在内存中。

如果您希望`ViewPager`将所有选项卡保留在内存中（小心——这在设备或其他正在运行的应用程序上可能很难），您可以设置在内存中保留多少个屏幕外选项卡。为此，请使用对象上的[`setOffscreenPageLimit`](http://developer.android.com/reference/android/support/v4/view/ViewPager.html#setOffscreenPageLimit(int))方法。`ViewPager``ViewPager`

例子：

```
ViewPager pager = (ViewPager) findViewById(R.id.pager); // Your pager's ID
pager.setOffscreenPageLimit(2); // Will retain 2 off-screen tabs + your selected tab 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T20:37:59.450

这是 a`FragmentPagerAdapter`和`FragmentPagerStateAdapter`工作方式的本质。从谷歌的网站：

```
The fragment of each page the user visits will be kept in memory, though its view hierarchy may be destroyed when not visible. 
```

意思是，您`GridView`正在重新填充，因为您`ViewPager`杀死了视图并且必须重建它。

编辑：如果您需要将所有三个片段都保存`Views`在内存中以加快速度，那么您必须创建自己的片段，`PagerAdapter`将视图存储在某种`instantiateItem(ViewGroup, int)`内部。`Collection`

或者，如果您逐字使用 Google 的示例，那么您可能正在执行以下操作：

```
@Override
public Fragment getItem(int position) {
  return ArrayListFragment.newInstance(position);
} 
```

在这种情况下，每次 ViewPager 请求一个片段时，您都在重建一个新片段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T20:40:16.147

默认情况下`ViewPager`，当前页面左侧一个片段，右侧一个片段保持空闲状态。您可以使用 更改此行为`ViewPager.setOffscreenPageLimit()`。查看[文档](http://developer.android.com/reference/android/support/v4/view/ViewPager.html#setOffscreenPageLimit%28int%29)

# java - 从 MySQL 收集 dateTime 时，Java 给出 00:00:00 时间

> ID：11512064
> 
> 赞同：2
> 
> 时间：2012-07-16T20:32:24.630
> 
> 标签：java, mysql, sql, time, jodatime

我正在尝试从我的 SQL 数据库中收集某个时间，然后将其与当前日期进行比较以检查用户当前是否被禁止。

它正确显示了从数据库收集的日期，但时间每次都只是 00:00:00。

这是我正在使用的代码：

```
public static boolean checkBan(String playerName, String type) {
    Format formatter;
    Date date = new Date();
    formatter = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss");
    try {
        createConnection();
        Statement statement = con.createStatement();
        String query = "SELECT * FROM players WHERE username = '"
                + playerName + "'";
        ResultSet results = statement.executeQuery(query);
        while (results.next()) {
            java.sql.Date mysqlDate = results.getDate(type);
            if (mysqlDate == null || formatter.format(date) == null) {
                return false;
            } else {
                java.util.Date dateConverter = new java.util.Date(
                        mysqlDate.getTime());
                DateTime now = new DateTime(formatter.format(date));
                DateTime end = new DateTime(formatter.format(dateConverter));
                int mins = Minutes.minutesBetween(now, end).getMinutes();
                System.out.println("Start time: " + now);
                System.out.println("End time: " + end);
                System.out.println("Difference in minutes:" + mins);
                if (mins <= 0) {
                    return false;
                } else {
                    return true;
                }
            }
        }
        destroyCon();
    } catch (SQLException e) {
        destroyCon();
        e.printStackTrace();
    }
    return false;
} 
```

它给我的输出是：

开始时间：2012-07-16T20:26:50.000Z

结束时间：2012-07-16T00:00:00.000Z

分钟差：-1226

但是SQL数据库中存储的结束时间是：2012-07-16 21:13:31

其他一些信息：我正在使用 Joda-time 和 sql 数据库，并且 java 服务器在同一台服务器上运行。如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:36:57.847

`java.sql.Date`被定义为无时间日期。当您使用该类型时，无论数据库中有什么，它都会将时间信息从日期中剔除。如果您需要 Date 和 Time 信息，`getTimestamp()`则要在 ResultSet 上使用，而不是`getDate()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T20:39:17.090

正如 API 文档中所述， [java.sql.Date](http://docs.oracle.com/javase/6/docs/api/java/sql/Date.html)没有时间组件（所有与时间相关的字段都设置为 0）。它与 SQL 日期匹配。

请改用[java.sql.Timestamp](http://docs.oracle.com/javase/1.5.0/docs/api/java/sql/Timestamp.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:36:47.673

从未将 mysql 与 java 一起使用，
但如果`java.sql.Date mysqlDate`是 mysql `DATE`，则插入 a `DATETIME`，
那么这可能是问题所在

 **在[oracle 文档中](http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/Date.html)**更新：java.sql.Date****

 **“如果给定的......值包含时间信息，驱动程序会将时间组件......设置为零格林威治标准时间。”**

# c# - 在 if 语句中使用独占或 C#

> ID：11512070
> 
> 赞同：2
> 
> 时间：2012-07-16T20:32:58.583
> 
> 标签：c#, if-statement, xor

我搜索了网站和谷歌，但无法找到我想要的东西。我认为这很简单，但是我对 C# 还很陌生，所以我在使用这个时遇到了一些麻烦。

基本上，我有一个 if 语句来测试我拥有的单选按钮的选择，这是在单击按钮时触发的。默认情况下，我没有任何选择，如果我忘记选择一个，我的程序会通过 MessageBox 通知我。所以本质上，在你做出选择之前，你什么都做不了。

到目前为止，我只有 3 个单选按钮，但今天我又添加了一个，以及与新单选按钮相关的更多代码，包括一个新功能。

我仍在试图找出测试radioButton的最有效的内存方法是什么。现在检查，是使用临时变量还是使用这个if语句？

```
if (pRKButton.Checked != true ^ hexButton.Checked != true ^ binaryButton.Checked != true)
        {
            MessageBox.Show("Choose a method of encryption.");
            return null;
        }
        else....//More Goes Here 
```

我的主要问题是：为什么当我在 if 语句中添加一个参数时，使用独占或，像这样；

```
if (pRKButton.Checked != true ^ hexButton.Checked != true ^ binaryButton.Checked != true ^ md5Button.Checked != true) 
```

该程序不会注册我单击**任何**单选按钮。

在这一点上，我正在考虑制作一个列表框来保存所有值并选择选项，因为列表会增长。但我对无法使用独占或超过 3 个参数的原因非常好奇。无论如何，我都不是数学家，但我很想了解更多。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T20:35:24.583

在我进入问题的主要部分之前，我想指出您实际上不需要在这里使用 XOR。当您有单选按钮时，只能选择零或一。当您选择一个时，同一组中的其他人将自动取消选择。因此，您可以使用`||`来测试是否至少选择了一个。

```
if (pRKButton.Checked || hexButton.Checked || binaryButton.Checked)
{
   // At least one (i.e. exactly one) is checked.
}
else
{
   // None checked.
} 
```

要回答您问题的主要部分，您的代码将失败，因为当您选择一个按钮时，您会得到`false ^ true ^ true`（注意您正在测试按钮是否*未选中*）。这样做的结果是错误的。但是当你有四个变量时，你就有了`false ^ true ^ true ^ true`哪个是真的。

`XOR`并不像您想象的那样意味着“只有一个是真的”。`A XOR B XOR C`如果奇数个 A、B、C 为真，则为真。这与“完全一个”不同，因为如果 A、B 和 C 三个都为真，则为真。

请参阅以下[真值表](http://www.wolframalpha.com/input/?i=A+XOR+B+XOR+C)以了解具有三个输入的链式 XOR 的行为：

![A 异或 B 异或 C](../Images/3d091d4820abdc9693a6d637080e24df.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T20:52:22.293

除了 Mark Byer 关于单选按钮功能的良好信息之外，您可能还担心您的代码会因为很长的 if 语句而变得很臭。

尝试使用 LINQ 来简化：

```
container.Controls.OfType<RadioButton>().Any<RadioButton>(r => r.Checked); 
```

将根据选中的任何单选按钮为真或假。

# css - CSS，相对字体大小

> ID：11512082
> 
> 赞同：5
> 
> 时间：2012-07-16T20:33:41.000
> 
> 标签：css, fonts

是否可以将字体大小设置为容器大小的百分比？我有一个包含图像、标题和描述的项目列表。当用户调整窗口大小时，图像会自动调整大小。我希望标题字体也这样做。

**编辑：Javascript/JQuery 很好。**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-16T21:16:10.333

在 CSS3 中，有一个`vw`单位，代表视口宽度的 1/100。例如，

```
h1 { font-size: 5.5vw; } 
```

将标题字体大小设置为视口宽度的 5.5%。

但是，到目前为止，这似乎仅适用于 IE 9（标准模式）。此外，IE 9 不会在调整浏览器窗口大小时动态更改单位的值，只会在重新加载时更改。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T21:16:06.700

只是为了扩展 Tyler 的答案，这就是 javascript 的含义，尽管我确信您可以使用 CSS3 视口实现相同的壮举，但使用 jQuery 会更好（它*通常*位于大多数浏览器的缓存中并且*始终*托管在谷歌上所以不用担心:)

如果你有这样的 CSS：

```
#body #mytext {
   font-size: 50%;
} 
```

您可以像这样在 jQuery 中动态调整大小：

```
$(window).resize(function(){
    $('#body #mytext').css('font-size',($(window).width()*0.5)+'px');
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-16T20:34:32.727

不，这只能在 JavaScript 中完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T20:54:11.817

jquery是一种选择吗？

如果是的话，超级简单：[小提琴](http://jsfiddle.net/yhRvr/1/)

```
<div id="container">
    <p>HELLO WORLD!</p>
</div>​

<script>
$(document).ready(function() {
    var sizeMe = ($('#container').height() / 100) * 90; /* 90% of container */
    $('p').css('font-size', sizeMe);
};
</script> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-16T20:48:48.263

我过去用 jquery 完成了它。如果您对本文感兴趣，请查看这篇文章。您还可以使用 CSS 来检测设备宽度（不是浏览器，旧浏览器不支持）。

[http://css-tricks.com/resolution-specific-stylesheets/](http://css-tricks.com/resolution-specific-stylesheets/)

# javascript - 有什么区别：$(this.el).html 和 this.$el.html

> ID：11512090
> 
> 赞同：38
> 
> 时间：2012-07-16T20:34:09.310
> 
> 标签：javascript, jquery, backbone.js

有什么区别：

```
$(this.el).html 
```

和

```
this.$el.html 
```

阅读一些主干示例，其中一些以一种方式和另一种方式来做。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-07-16T20:41:35.857

`$(this.el)`用 jQuery（或 Zepto）包装一个元素。因此，如果您的视图 HTML 是这样的：

`<div id="myViewElement"></div>`

...并`this.el`引用了该 div，则`$(this.el)`相当于直接通过 jQuery: 检索它`$('#myViewElement')`。

`this.$el`是对 jQuery（或 Zepto）对象的缓存引用，因此是调用`$(this.el)`. 目的是为您节省 call 的需要`$(this.el)`，这可能会产生一些开销，因此会产生性能问题。

**请注意：**两者不等价。`this.el`单独是对宿主对象 HTMLElement 的引用——不涉及任何库。这就是回归`document.getElementById`。`$(this.el)`创建 jQuery/Zepto 对象的新实例。`this.$el`引用前一个对象的单个实例。只要您了解多次调用`$(this.el)`.

在代码中：

```
this.ele = document.getElementById('myViewElement');
this.$ele = $('#myViewElement');

$('#myViewElement') == $(this.ele); 
```

此外，值得一提的是，jQuery 和 Zepto 有部分内部缓存，因此额外调用`$(this.el)` *可能*最终返回缓存结果，这就是我说“可能存在性能问题”的原因。它也可能不会。

**文档**

*   `view.$el`- [http://backbonejs.org/#View-$el](http://backbonejs.org/#View-$el)
*   `$`在骨干网 - [http://backbonejs.org/#View-dollar](http://backbonejs.org/#View-dollar)
*   jQuery 基础对象 - [http://api.jquery.com/jQuery/](http://api.jquery.com/jQuery/)
*   Zepto 基础对象 - [http://zeptojs.com/#$()](http://zeptojs.com/#$%28%29)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-16T20:44:59.107

两者*本质上是*等价的，`$el`作为jQuery 或 Zepto 对象的[缓存版本](http://backbonejs.org/#View-$el)`el`，您看到使用示例的原因`$(this.el)`是因为它仅在更高[版本](http://backbonejs.org/#changelog)的主干.js (0.9.0) 中添加。

*[从技术上讲，正如[Chris Baker](https://stackoverflow.com/users/610573/chris-baker)指出的那样，`$(this.el)`每次调用它时（可能）都会创建一个新的 jQuery/Zepto 对象，而每次`this.$el`都会引用同一个对象。]

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T20:38:34.500

如果`$el`存在于`this`并且是 jQuery 对象，则不应使用`$(this.el)`，因为它会在已经存在的情况下初始化一个新的 jQuery 对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-16T20:47:49.280

它们产生完全相同的东西；也就是说，对视图元素的引用。$el 只是 $(this.el) 的 jquery 包装器。看看这个参考：[http](http://documentcloud.github.com/backbone/#View-) ://documentcloud.github.com/backbone/#View- $el

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-16T20:43:11.603

我经常看到这个：

```
var markup = $(this).html();
$(this).html('<strong>whoo hoo</strong>'); 
```

我同意拉米农的观点。你看到的例子看起来不对。

此代码通常出现在 jquery 循环中，例如 each() 或事件处理程序。在循环内部，“el”变量将指向纯元素，而不是 jQuery 对象。事件处理程序中的“this”也是如此。

当您看到以下内容时：$(el) 或 $(this)，作者正在获取对 dom 对象的 jQuery 引用。

这是我刚刚用来将数字转换为罗马数字的示例：（注意，我总是使用 jQuery 而不是 $——与 mootools 的冲突太多......）

```
jQuery(document).ready(function(){
    jQuery('.rom_num').each(function(idx,el){
        var span = jQuery(el);
        span.html(toRoman(span.text()));
    });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-16T20:41:31.963

在 $() 中包装元素会将 jQuery 扩展附加到对象原型。一旦完成，就不需要再次执行，尽管多次执行它除了性能之外没有任何危害。

# wcf - WCF Restful 服务 URI 模板不起作用

> ID：11512094
> 
> 赞同：0
> 
> 时间：2012-07-16T20:34:15.700
> 
> 标签：wcf

我正在创建一个简单的 WCF Restful 服务。目前，当我浏览到：localhost/AzamSharpService.svc 时，它会显示 Web 服务默认页面，我可以在其中检查 WSDL。

我想浏览到 localhost/AzamSharpService.svc/LatestArticles 并从 GetLatestArticles 方法中获取 json。目前，当浏览到 /LatestArticles 网址时，它说找不到页面。

实现如下图所示：

```
 [ServiceContract]
    public interface IAzamSharpService
    {
        [OperationContract]
        [WebGet(BodyStyle  = WebMessageBodyStyle.Bare, RequestFormat =WebMessageFormat.Json,ResponseFormat = WebMessageFormat.Json, UriTemplate = "/LatestArticles")]
        List<ArticleContract> GetArticles();
    }

 public class AzamSharpService : IAzamSharpService
    {
        public List<ArticleContract> GetArticles()
        {
            var articles = new List<ArticleContract>()
                               {
                                   new ArticleContract() {Title = "iOS"}, 
                                   new ArticleContract() { Title="Android"},
                                   new ArticleContract() { Title = "Windows 7"}

                               };
            return articles; 
        }
    } 
```

配置如下图所示：

```
 <system.serviceModel>

      <services>
        <service name="AzamSharpNewLook.AzamSharpService">
          <endpoint address="AzamSharpService.svc"
                    binding="webHttpBinding"
                    contract="AzamSharpNewLook.IAzamSharpService"
                    behaviorConfiguration="webby"/>

            </service>
      </services>
        <behaviors>

          <endpointBehaviors>
            <behavior name="webby">
              <webHttp/>
            </behavior>
          </endpointBehaviors>

            <serviceBehaviors>
                <behavior name="">
                    <serviceMetadata httpGetEnabled="true" />
                    <serviceDebug includeExceptionDetailInFaults="false" />
                </behavior>
            </serviceBehaviors>
        </behaviors>
        <serviceHostingEnvironment multipleSiteBindingsEnabled="false" />
    </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:27:43.970

有几件事要尝试...将端点地址设置为空字符串...在 webHttp 节点中尝试启用帮助...您应该能够导航到 localhost/AzamSharpService.svc/help 并获取更多信息。最后，我会使用 fiddler 并构造一个到适当地址的 get 请求，然后只需检查响应，你应该有你需要的东西。希望这可以帮助...

# c# - 如何使用类型的 EntityCollection 使用带有实体框架的部分类？

> ID：11512095
> 
> 赞同：0
> 
> 时间：2012-07-16T20:34:21.217
> 
> 标签：c#, entity-framework, interface

我正在使用部分类。一个类是从 EntityFramework 生成的。我自己生成的另一个类，以便我可以实现一个接口。将使用该接口，因此两个库/程序集不会相互了解，但能够实现通用接口。

我的自定义接口声明了属性 EntityCollection( **ITimesheetLabors** ) 但我的 EntityFramework 生成 EntityCollection(TimesheetLabors) 所以编译器告诉我我的类没有实现可以理解的 EntityCollection(ITimesheetLabors)。但是，让我的部分类返回我想要的接口集合的最佳方法是什么？

我的部分类的集合属性的获取是否应该返回一个新实例化的 EntityCollection 以便它可以将具体类型转换为我的接口？好像有点矫枉过正了。我错过了什么？

```
public interface ITimesheet //My Interface
{
    EntityCollection<ITimesheetLabors> Timesheets {get;set;} 
}

public partial class Timesheet//Class generated by Entity Framework
{
    EntityCollection<TimesheetLabors> Timesheets {get;set;} 
}

public partial class Timesheet : ITimesheet  //My Partial Class that implements my interface
{
    EntityCollection<ITimesheetLabors> Timesheets {get;set;} 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T08:20:27.143

EF 不支持接口，因此唯一的方法是同时使用 EF 生成的原始属性和将在内部访问生成的属性的接口属性。

顺便提一句。你的设计有味道——一方面你试图通过使用接口来隐藏你的实体，同时你正在暴露`EntityCollection`=>你正在让你的上层依赖于 EF。常见的做法是做相反的设计——隐藏 EF 并使用 POCO（通常不需要接口）。

# ruby-on-rails - Rails 应用程序：has_one 关系似乎有效，但无法访问记录

> ID：11512097
> 
> 赞同：0
> 
> 时间：2012-07-16T20:34:26.053
> 
> 标签：ruby-on-rails

我有两个模型，站点和 robots_file。站点 has_one robots 文件和 robots_file 属于站点。

从站点模型中，我可以在 robots_file 表上创建一条新记录。但我实际上无法访问那条新记录。所以，如果我在控制台中，我可以这样做：

```
Site.last.create_robots_file 
```

它将在 robots_file 表上创建必要的记录。但如果试试这个：

```
Site.last.robots_files.first 
```

我收到一个错误：

```
NoMethodError: undefined method `robots_files' for #<Site:0x007fcccaff2f28> 
```

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:08:12.527

如果你有一对一的关系，你不能访问“robots_files”，你应该访问“robot_file”

```
Site.last.robot_file 
```

希望能帮助到你！

# c#-4.0 - 我应该使用哪个 webcontrol 列出主管和员工在一段时间内的休息日

> ID：11512101
> 
> 赞同：0
> 
> 时间：2012-07-16T20:34:42.720
> 
> 标签：c#-4.0, web-controls

我正在寻找看起来像这样的东西。

*   主管姓名
    *   员工姓名
        *   2012 年 3 月 4 日病假
        *   2012 年 3 月 5 日病假
        *   2012 年 3 月 7 日假期
    *   员工 #2 姓名
        *   2012 年 3 月 6 日陪审团职责

我应该使用什么样的控件？我有一个包含相关数据的数据库，我可以创建一个视图来让它看起来像我需要的任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:40:03.873

树视图？

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treeview.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treeview.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:38:11.093

你应该使用asp Tree view Control。它可以帮助你下面的链接

[http://www.asp.net/cssadapters/WalkThru/WalkThrough.aspx#PopulateOnDemandTreeView](http://www.asp.net/cssadapters/WalkThru/WalkThrough.aspx#PopulateOnDemandTreeView)

# php - 树遍历递归计算

> ID：11512104
> 
> 赞同：0
> 
> 时间：2012-07-16T20:34:43.590
> 
> 标签：php, mysql, algorithm, tree

我们有用户、问题和无限级别的类别。用户可以从问题中获得一些分数。问题可以有多个类别。

我想做的是计算每个类别的顶级用户：它只是从该类别下的问题中获取的总分，它也是子类别。

所以，我有这些表：

```
questions
--------------
id
title
question

categories
--------------
id
parent_id
category
lft
rgt

question_categories
--------------
question_id
category_id

users
--------------
id
username

user_points
--------------
id
user_id
question_id
point_type
points

user_category
--------------
user_id
category_id
points 
```

我想做的是计算 user_category.points 值。总结每个类别的分数很容易，但包括子类别变得越来越复杂。

最好的方法是什么？

示例计算：

假设类别是：

```
Programming
   PHP
      Zend Framework
      Symfony
   Java
   Ruby on Rails 
```

假设用户从 Zend Framework获得**3 分**，从 PHP获得**2 分**，从 java获得**5 分**，从 Rails获得**1 分。**该用户每个类别的积分将是：

```
Programming            11 (5+5+1)
   PHP                  5 (2+3)
      Zend Framework    3
      Symfony
   Java                 5
   Ruby on Rails        1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:47:07.437

也许最好使用标签而不是层次结构。例如，任何带有“Zend Framework”的东西也会有“PHP”和“Programming”标签。当某些类别可以出现在多个位置时，这也很有帮助。例如，我可以在 jQuery 和 Javascript 中使用 ajax。然后，将 1 添加到用户类别中列出的每个标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:45:28.490

我将创建一个`user_categories`表，在其中存储 3 个值`user_id`：`category_id`和`user_score`。它很容易维护（只需要`INSERT`or `UPDATE`），也很容易查询每个类别的顶级用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:07:30.140

如果您只想对每个顶级类别求和，那么您应该在您的类别表中添加一个名为 root_id 的字段（保存该类别的传递父项的 id）。

那么您的总和将计算为：

```
select up.user_id, ctg.root_id, sum(up.points)
from user_points up
join question_categories qc on up.question_id = qc.question_id
join categories ctg on qc.category_id = ctg.id
group by up.user_id, ctg.root_id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T21:18:21.427

这个 php 和 SQL 应该为您提供每个类别的前 3 名用户，包括子类别：

```
$query = "SELECT id, parent_id FROM categories";
$parent = array();
...fetch mysql data loop depending on what connection you use, mysqli or pdo...
{
   $parent[$result['id']] = $result['parent_id'];
}

$childs = array();

foreach($parent as $id => $parrent_id)
{
   $childs[$parrent_id][$id] = $id;
   $next_parrent_id = $parrent_id;
   while($next_parrent_id = $parent[$next_parrent_id])
   {
      $childs[$next_parrent_id][$id] = $id;
   }
}

foreach($parent as $id => $parrent_id)
{
   $current_categories = array($id => $id) + $childs[$id];
   $query = "SELECT user_id, username, SUM(points) AS total_points
             FROM user_points 
             LEFT JOIN users ON (user_id = users.id)
             LEFT JOIN question_categories USING (question_id)
             WHERE category_id IN (" . implode(', ', $current_categories). ")
             ORDER BY total_points DESC
             LIMIT 3";
   ...fetch mysql data loop...
} 
```

# google-maps - 根据特定条件打开 Google Maps InfoWindow

> ID：11512107
> 
> 赞同：4
> 
> 时间：2012-07-16T20:34:51.317
> 
> 标签：google-maps, google-maps-api-3, infowindow, conditional-statements

我想`InfoWindow`根据我的一栋建筑物是否发出建筑物警报来打开谷歌地图。我有标记的建筑物都有警报状态（打开或关闭），如果它们处于警报状态，我会将标记的颜色更改为黄色或红色，具体取决于警报的严重程度。当警报是“红色”警报时，标记会以`google.maps.Animation.BOUNCE`效果为动画。

弹跳效果有时不足以引起注意（我们让这个屏幕在墙上打开，`$(this).children(".alarm-count")`下面的 div 中的数据由于我们在后台在站点上运行的另一个脚本而动态变化。

我已经知道如何根据警报状态更改标记，我还可以在相同条件下打开信息窗口吗？我试过这个：

```
 google.maps.event.addListener(map,'idle',(function(marker,i){
            return function(){
                infowindow.setContent(

                    '<div class="infowindow-inner">'+
                        '<a href="'+bldgGfx[i]+'" onclick="window.open('+bldgGfx[i]+');return false;" target="_blank" title="'+bldgName[i]+' ('+bldgAddr[i]+')">'+
                            '<h2>'+bldgName[i]+'</h2>'+
                            '<h4>'+bldgAddr[i]+'</h4>'+
                            '<p>'+mainMeter[i]+' kW</p>'+
                            '<p>'+alarmCount[i]+' Alarms</p>'+
                    '</div>'

                );infowindow.open(map,marker);
            }
        })(marker,i)); 
```

但它似乎没有工作。

**总而言之，我需要为页面中的每个标记评估一个值，并根据该值打开（或不打开）每个建筑物的信息窗口。**

这是我的代码：

```
$(".building").each(function(i){

    bldgNo[i] = $(this).children(".bldg-no").html().slice(1);
    bldgName[i] =   $(this).children(".bldg-name").html();
    bldgAddr[i] =   $(this).children(".bldg-address").html();
    bldgGfx[i] =    $(this).children(".bldg-graphic").html();
    mainMeter[i] =  $(this).children(".main-meter").html();
    alarmCount[i] = $(this).children(".alarm-count").html();
    latitude[i] =   $(this).children(".latitude").html();
    longitude[i] =  $(this).children(".longitude").html();

    if (alarmCount[i]!="N/A"){alarmCount[i]=alarmCount[i].slice(0,-3);}
    if (alarmCount[i]>"0" && alarmCount[i]!="N/A"){
        marker=new google.maps.Marker({position:new google.maps.LatLng(latitude[i],longitude[i]),map:map,shadow:shadow,icon:redIcon,title:bldgName[i]+" \n"+bldgAddr[i],optimized:false});marker.setAnimation(google.maps.Animation.BOUNCE);

    ////    
    //// THE COMMAND TO OPEN THE INFOWINDOW WILL GO HERE, RIGHT?
    ////

    }
    else if ($(this).hasClass("new")||(mainMeter[i]=="N/A")||(!isNumber(mainMeter[i]))) {
        marker=new google.maps.Marker({position:new google.maps.LatLng(latitude[i],longitude[i]),map:map,shadow:shadow,icon:yellowIcon,title:bldgName[i]+" \n"+bldgAddr[i],optimized:false});marker.setAnimation(google.maps.Animation.NULL);}
    else {
        marker=new google.maps.Marker({position:new google.maps.LatLng(latitude[i],longitude[i]),map:map,shadow:shadow,icon:greenIcon,title:bldgName[i]+" \n"+bldgAddr[i],optimized:false});marker.setAnimation(google.maps.Animation.NULL);}

    markersArray.push(marker);
    google.maps.event.addListener(marker,'click',(function(marker,i){
        return function(){
            infowindow.setContent(

                '<div class="infowindow-inner">'+
                    '<a href="'+bldgGfx[i]+'" onclick="window.open('+bldgGfx[i]+');return false;" target="_blank" title="'+bldgName[i]+' ('+bldgAddr[i]+')">'+
                        '<h2>'+bldgName[i]+'</h2>'+
                        '<h4>'+bldgAddr[i]+'</h4>'+
                        '<p>'+mainMeter[i]+' kW</p>'+
                        '<p>'+alarmCount[i]+' Alarms</p>'+
                '</div>'

            );infowindow.open(map,marker);
        }
    })(marker,i));

    i++;

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T11:38:41.823

由于许多建筑物可能处于“戒备状态”，因此您需要一个 InfoWindow 数组（在我的演示中，它是一个全局数组，因为我使用了内联调用）；但是，屏幕可能很容易变得混乱。我编写了一个 Z-Index 例程来将点击的 InfoWindow 放在前面。您可能还想考虑`MarkerWithLabel`或者`InfoBubble`因为在我看来它们看起来比普通的 InfoWindow 更好。

请看[**演示**](http://jsfiddle.net/yV6xv/174/embedded/result/)

[*与代码并排演示*](http://jsfiddle.net/yV6xv/174/)

我只会复制一些非常不同的部分。

```
var infowindows = [];

function initialize() {
  map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

  // MANY LINES SKIPPED
  // ...

  $(this).children(".longitude").html();

  infowindows[i] = new google.maps.InfoWindow({
      content:'<div class="infowindow"
         onclick="bringToFront('+i+')">'+bldgName[i]+'</div>'});

  if (alarmCount[i]>0 && alarmCount[i]!="N/A"){
  //      marker=new google.maps.Marker({position:new google.maps.LatLng(latitude[i],longitude[i]),map:map,shadow:shadow,icon:redIcon,title:bldgName[i]+" \n"+bldgAddr[i],optimized:false});marker.setAnimation(google.maps.Animation.BOUNCE);

    marker = new google.maps.Marker({position:new google.maps.LatLng(latitude[i],longitude[i]),map:map,title:"red"});

    infowindows[i].open(map,marker);

  //// THE COMMAND TO OPEN THE INFOWINDOW WILL GO HERE, RIGHT?
}

...

google.maps.event.addListener(marker,'click',(function(marker,i){
      return function(){
        infowindows[i].open(map,marker);
        bringToFront(i);
      }
    })(marker,i));
  });
}

function bringToFront(windowIndex) {
  console.log(windowIndex);
  for (var i = infowindows.length-1, n = 0; i >= n; i--) {
    infowindows[i].setZIndex(0);
  }
  infowindows[windowIndex].setZIndex(1);
} 
```

# iphone - LED显示屏仿真Xcode

> ID：11512110
> 
> 赞同：2
> 
> 时间：2012-07-16T20:35:02.870
> 
> 标签：iphone, xcode, ipad, led

我一直在网上寻找我的问题的答案，但我没有发现任何有用的信息，所以我决定问你。

基本上我想像[这个](http://www.youtube.com/watch?v=ZlZu9oADIKs)视频显示的那样编写一个应用程序。对我来说另一件大事是 - 如何更改文本大小？

对于每个字符，我应该创建一个布尔数组来确定 LED 引脚是打开还是关闭。我认为这是以**固定**文本大小显示文本的最聪明的方法。

我是否必须为要使此功能正常工作的每种文本大小的每个字符创建一个数组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:49:25.380

本质上，您正在为您希望在大型 LED 显示屏上显示的每种字体制作字体图。就像常规显示器上的字体一样，恐怕答案是肯定的，您必须为您希望支持的每种字体制作一个映射文件。

它可能不必是真正的布尔值，但是，您可以通过将多个布尔位存储在单个字节、短字节或整数等中来摆脱更紧凑的布尔值版本......

# iphone - 更改方向时iOS子视图大小不正确

> ID：11512112
> 
> 赞同：0
> 
> 时间：2012-07-16T20:35:14.907
> 
> 标签：iphone, ios, ipad, orientation, subview

我有一个应用程序将为用户自动登录。登录服务器时，将有 50% 透明视图显示“正在登录...”消息，它阻止用户做任何其他事情（请不要与我争论我是否应该通过 HIG 这样做，我们必须让用户登录才能做任何事情）。所以我所做的是在 IB 中创建一个 xib LoadingMessageViewController，在主视图控制器中`- (void)viewDidLoad()`，我初始化视图控制器并执行`[self.view addSubview:LoadingMessageViewController.view]`；

它在纵向模式下可以正常工作，但在横向模式下不行。我看到了很多关于这个问题的帖子，但没有什么对我有用。

我将 autoresizingMask 设置为 true，在 IB 中设置自动调整大小，我也尝试使用`[[[window subviews] objectAtIndex:0] addSubview:LoadingMessageViewController.view]`而不是`[self.view addSubview:LoadingMessageViewController.view]`. 使用的问题`[[window subviews] objectAtIndex:0]`是它发生在 中`-(void)ViewDidLoad`，此时视图还没有真正完成加载到屏幕上，此时的子视图为零，调用 objectAtIndex 将导致指针超出范围异常。

请指出正确的方向。

感谢您阅读我的帖子。

这是它的样子：

![在此处输入图像描述](../Images/b1c0f9844d2e21c4b89b0c0861f9dc49.png)

# java - 在 Android 中获取时区与 GMT 的比较

> ID：11512113
> 
> 赞同：2
> 
> 时间：2012-07-16T20:35:20.793
> 
> 标签：java, android, timezone, integer

我需要将移动**时区**与Android中的**GMT**进行比较。我只能看到一个函数返回它，但是`String`：

```
Calendar c = Calendar.getInstance(); 
TimeZone tz = c.getTimeZone();
tz.getID(); 
```

这是 的描述`getID()`：

> 返回此时区的 ID，例如 America/Los_Angeles、GMT-08:00 或 UTC。

问题是我需要`Integer`像 +3，-5 一样得到它......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:39:30.493

您应该能够根据 TimeZone`getOffset()`值计算差异，请参阅[http://developer.android.com/reference/java/util/TimeZone.html#getOffset(long](http://developer.android.com/reference/java/util/TimeZone.html#getOffset(long) )

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-21T22:34:48.903

```
public static String getCurrentTimezoneOffset() {

    TimeZone tz = TimeZone.getDefault();  
    Calendar cal = GregorianCalendar.getInstance(tz);
    int offsetInMillis = tz.getOffset(cal.getTimeInMillis());

    String offset = String.format("%02d:%02d", Math.abs(offsetInMillis / 3600000), Math.abs((offsetInMillis / 60000) % 60));
    offset = (offsetInMillis >= 0 ? "+" : "-") + offset;

    return offset;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T20:39:40.390

使用[TimeZone.getOffset](http://developer.android.com/reference/java/util/TimeZone.html#getOffset%28long%29)。请注意，时差可能会因夏令时而发生变化，并且每个国家和一年中的每一天都会有很大差异。因此，您不应全年依赖该偏移量。相反，使用 TimeZone 标识符更可靠。

# php - 使用 sha256 时 SQL 表中的实际密码可视化

> ID：11512114
> 
> 赞同：1
> 
> 时间：2012-07-16T20:35:22.977
> 
> 标签：php, sql, sha256

我正在接受培训以确保登录过程的安全。

我在 sign_up.php 中使用了 sha 256：

```
$username= check_input($_POST['username']);
$password= check_input($_POST['password']);
//the password is encrypted in sha256
$secure_sign_up_password = hash('sha256', $password); 
```

然后当然在我的 SQL 数据库中的用户表中，我可以阅读：

*   在“登录”列中实际键入的登录示例：如果有人键入“迈克尔”，我将在 SQL 数据库中看到“迈克尔”

*   在“密码”列中实际输入的登录示例：如果有人输入“水果”，我将在 SQL 数据库中看到像“e8bfab56c53980cd014206c8da2f8c9b9708eaacc61”这样的散列值

我的问题很简单，但可能有点天真（我是新手）：我认为我仍然可以在我的数据库中的某处读取实际密码，并且哈希只是为了保护密码不被拦截和读取而它正在发送。我永远不知道，有人可能会要求我将他的真实密码发送给他。但我唯一能看到的是密码列中的“散列”。

*   是这样设计的吗？
*   是否也可以可视化真实密码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:39:35.903

如果您能够“解码”这些密码，那将不是一个非常安全的系统。一旦有人获得了对您数据库的访问权限 - 他们将能够在不知情的情况下访问每个人的密码...

如果您曾经忘记了某个网站的密码（我们都有 - 不要否认！），您会记得他们通常***不会**简单地将您的密码（以纯文本形式）发送给您，以提醒您电子邮件 - 他们会给你机会**重置**它。这样（通常通过您的电子邮件/电话号码进行验证）他们会知道您确实是开设帐户的人。

** 如果他们以纯文本形式向您发送您的密码，这可能意味着他们正在以这种方式或其他易于解密的形式存储它。这个网站很可能没有他们想的那么安全……*

* * *

如果您有兴趣为自己留下一个能够访问任何用户帐户的“后门”，您可能会想到在您的管理员帐户中使用一个特殊的登录表单，它允许您使用编码密码登录。这意味着您只需省略`hash('sha256', $password)`并传递`$password`已经编码的（您从数据库中提取的）。这有点hacky，如果您已经拥有管理员帐户，那么能够以其他用户身份登录就没有多大用处，因为您已经**非常强大了！**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T20:38:28.883

这是设计使然。 **除了我，没有人**应该知道我的密码是什么。即使你作为一个（在这里插入花哨的标题）也不应该知道我的密码。如果我忘记了，那是我的问题，但您的网站应该为我提供重置它的方法。然后当我重置时，您的网站应该再次存储哈希。纯文本密码永远不应存储在任何地方。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T21:02:19.707

1.  永远永远永远不会在数据库中以开放格式保存密码。如果有人在系统中发现漏洞，他将能够进行任何 sql 查询并获取用户密码。黑客将能够以用户身份登录系统，因为他知道用户名和密码
2.  如果用户想要恢复密码，请使用重新生成密码的功能。切勿以纯文本形式存储密码。
3.  SHA256 是哈希函数。从数学上讲，这意味着 - 数据只能以一种方式“散列”。我的意思是，从哈希中您无法恢复数据。你可以阅读这个[http://en.wikipedia.org/wiki/Hash_function](http://en.wikipedia.org/wiki/Hash_function)关于哈希函数和这个关于[http://en.wikipedia.org/wiki/Sha256](http://en.wikipedia.org/wiki/Sha256) sha256 结果：如果有人破解你的数据库并获取用户名和密码，他无法登录系统。因为黑客只有哈希数据，无法获得准确的登录密码。
4.  正如我之前提到的，散列函数只能以一种方式“散列”数据。但是一些黑客为一些预定义的算法构建了非常大的数据。我的意思是，他们为密码构建哈希表。这样的哈希表看起来像这样：

```
    密码哈希
    ------------------
    一个 some_hash1
    b some_hash2
    …………
    qwerty some_hash3
    some_data some_hash3 -- 是的，数据可能有冲突。请参阅有关散列函数的 wiki

```

如果黑客入侵了你的数据库并拥有这样的表，他就可以恢复密码。例如，黑客获取管理员用户哈希“some_hash3”，然后黑客在哈希表中搜索该哈希，发现哈希“some_hash3”有密码“qwerty”和“some_data”，黑客将尝试使用这些密码登录。结果：使用盐。对于现在的黑客有这样的表 6 符号密码。但是您可以用非常简单的技术“吸”它们：当您将密码存储在数据库中时，向密码添加一些值（盐）并从该值哈希中获取：

```
// somewhere in code, where creating/updating users password

$password = hash('sha256', $salt.$password); 
```

当您检查密码时，请使用相同的逻辑

谢谢

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T22:40:45.587

sha256 散列和其他散列是一种方法。请参阅[http://en.wikipedia.org/wiki/Cryptographic_hash_function](http://en.wikipedia.org/wiki/Cryptographic_hash_function)。如果您希望能够解密您在数据库的密码字段中写入的内容，您可能需要使用另一种方法。

您可以使用不与用户共享的密钥进行加密，而不是创建哈希。看看[http://www.php.net/manual/en/book.mcrypt.php](http://www.php.net/manual/en/book.mcrypt.php)。但是，密钥将成为您代码的一部分，因为它是对称加密。

要做到真正安全，请尝试真正的 PKI 加密（使用公钥加密，使用私钥解密）。查看 php.net/manual/en/function.gnupg-encrypt.php 或 php.net/manual/en/book.openssl.php。

但正如这里的其他人所说，这样的事情是合理地没有完成的；）

# c++ - 在函数调用中包装 std::cout

> ID：11512121
> 
> 赞同：2
> 
> 时间：2012-07-16T20:35:55.767
> 
> 标签：c++

我有很多 couts，所以我希望能够制作一个只需要三个参数的函数。该函数会将它们打印到屏幕上，就像 cout 一样：

```
print( 5, " is a ", "number" );

// should do the same thing as

cout << 5 << " is a " << "number" << endl; 
```

我不要求任何人这样做。我只是在寻找一种能够做到的方法。但如果你能提供代码也很好。有人有建议吗？谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-16T20:37:30.430

```
template <typename T0, typename T1, typename T2>
void print(T0 const& t0, T1 const& t1, T2 const& t2)
{
    std::cout << t0 << t1 << t2 << std::endl;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T21:21:20.377

> 我希望能够制作一个只需要三个参数的函数

你确定吗？C++11 为我们提供了比这更多的功能。

```
void print()
{
    std::cout << std::endl;
}

template<typename T, typename... Args>
void print(const T & val, Args&&... args)
{
    std::cout << val;
    print(args...);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-16T20:37:24.147

您可以使用模板来做到这一点：

```
template<typename T, typename S, typename U>
print(T x, S y, U z)
{
    std::cout << x << y << z;
} 
```

编辑：如果您希望传递复杂类型（不仅仅是`int`or `char *`），您应该遵循 James 的回答并使用`const`引用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-16T20:37:24.753

你可以使用宏......（如果你想这样做，有时会很难看）

```
#define PRINT(x,y,z) cout << (x) << (y) << (z) << endl; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-16T20:38:07.370

如果您希望简化打印三个项目的特定任务，您可以使用 #define 宏来完成：

```
#define print(A,B,C) cout << (A) << (B) << (C) << endl 
```

如果您更喜欢函数调用语法，请考虑使用 C 样式的输出：`printf`它是 C++ 标准库的“一流成员”，当它在您的特定应用程序中有意义时，没有理由回避它：

```
printf("%d %s %s\n", 5, "is a", "number"); 
```

方法的优点`printf`是它不限于任何特定数量的参数。

# ios - 需要外部订阅的免费应用程序中的广告（如 netflix）

> ID：11512124
> 
> 赞同：0
> 
> 时间：2012-07-16T20:36:07.567
> 
> 标签：ios

如果您在免费应用程序中显示广告，而该应用程序需要外部订阅服务，它是否违反苹果的任何类型的服务条款？比如Netflix。

这不完全是一个编程问题，所以如果没有人知道或不想回答，是否有我可以去的站点或位置以找出答案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:43:57.143

Apple 对免费应用程序中的广告没有任何限制。有几个广告支持的应用程序存在。

但是，使用用户的位置数据进行广告**可能会**导致应用程序不被批准。

# joomla - 如何编辑我的 Joomla 登录页面？

> ID：11512128
> 
> 赞同：4
> 
> 时间：2012-07-16T20:36:37.643
> 
> 标签：joomla, joomla2.5

我很难弄清楚我的服务器上的哪个文件正在创建位于“http://www.website.com/component/users/?view=login”的页面我没有组件目录但是我确实有一个组件目录。我深入研究并检查了 com_users/views 模板，但我无法编辑任何真正反映相关页面更改的内容。需要注意的一点是，如果我在“components/com_users/views/login”修改 view.html.php 文件，它似乎会影响页面，并且似乎想从代码行加载页面上的内容内容如下：

```
$menus = $app->getMenu(); 
```

知道如何编辑此页面吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T23:13:10.367

如果您打算对登录页面进行样式或布局更改，这是您要编辑的文件。

```
components/com_users/views/login/tmpl/default_login.php 
```

...

包含登录页面功能且我不建议编辑的文件是：

```
components/com_users/views/view.html.php 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T18:12:04.100

感谢 GDP 提供了我一直在寻找的答案：

“您可能还想检查活动模板的 \html 文件夹。如果 templates\yourtemplate\html\com_users 存在，如果找到匹配的视图和文件，Joomla 将从那里检查和加载。”

# python - 辐条API？刮刀

> ID：11512129
> 
> 赞同：3
> 
> 时间：2012-07-16T20:36:40.103
> 
> 标签：python, xml, json, api, web-scraping

有没有用于spokeo的API？我想获得 json 或 xml 格式的结果，我尝试为它找到一个 api，但找不到。有没有人尝试过使用或不使用 api 来刮轮辐？我确信我们可以用一种通用的方式进行抓取，但是当搜索结果出现多个位置区域时，我不知道如何进行。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T13:50:08.990

根据 Spokeo 的[使用条款，](http://www.spokeo.com/terms-of-use)明确禁止抓取工具，以及*任何*“衍生作品”——即使所有此类作品只是从其网站框架内容。

如果您在公开可用的应用程序中发布此内容，请准备好接受一些抨击。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-11T20:48:26.943

我认为更简单的答案是使用[FullContact Person API](http://www.fullcontact.com/developer/docs/person/)

# java - 在 ListView 中显示 SQLite

> ID：11512131
> 
> 赞同：0
> 
> 时间：2012-07-16T20:36:51.647
> 
> 标签：java, android, sqlite, listview, android-listview

嗨，我有一个 SQLite 数据库，我正在使用一个简单的光标来读取数据库，然后将其显示给 TextView。但是，我想在 ListView 中显示数据。

所以我有字符串，但我不知道如何在 ListView 中显示它。有没有简单的方法或者我必须创建一个适配器？

我还想知道如何将列表视图的一部分设置为标题，将其他部分设置为副标题。如果可能的话，我希望每一行都是不同的列表项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-17T04:42:41.227

这是一个简单的示例。假设您的主要活动中有两个名为“Items”和“ItemsId”的数组列表。现在，在您的数据库处理程序类中，使用以下代码获取您的表并将值存储到 Items 和 ItmesId 数组列表中。

```
 MainActivity.Items.clear();
    MainActivity.ItemsId.clear();

    // Select All Query
    String selectQuery = "SELECT  * FROM " + TABLE_NAME;

    SQLiteDatabase db = this.getWritableDatabase();
    Cursor cursor = db.rawQuery(selectQuery, null);

    // looping through all rows and adding to list
    if (cursor.moveToFirst()) {
        do {
            // Adding values to list
            MainActivity.Items.add(cursor.getString(0));
            MainActivity.ItemsId.add(cursor.getString(0));
           } while (cursor.moveToNext());
    } 
```

现在使用 Main 活动中的 Items 数组列表填充您的列表视图。

```
final StableArrayAdapter adapter = new StableArrayAdapter(this,
    android.R.layout.simple_list_item_1, Items);
listview.setAdapter(adapter); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:00:29.603

使用[SimpleCursorAdapter](http://developer.android.com/reference/android/widget/SimpleCursorAdapter.html)。

这是一个简单的例子：

```
 yourListView.setAdapter(new SimpleCursorAdapter(
    /* The context where the ListView associated with this SimpleListItemFactory is running */, 
    /* resource identifier of a layout file that defines the views for this list item. The layout file should include at least those named views defined in "to" */, 
    /* The database cursor. Can be null if the cursor is not available yet. */,
    /* A list of column names representing the data to bind to the UI. Can be null if the cursor is not available yet. */, 
    /* The views that should display column in the "from" parameter. These should all be TextViews. The first N views in this list are given the values of the first N columns in the from parameter. Can be null if the cursor is not available yet. */, 
    /* Flags used to determine the behavior of the adapter, as per CursorAdapter(Context, Cursor, int). */)); 
```

# javascript - 按下后退按钮时防止浏览器捕捉到先前的滚动位置

> ID：11512140
> 
> 赞同：7
> 
> 时间：2012-07-16T20:37:26.497
> 
> 标签：javascript, html, browser, browser-history

当用户按下这样的后退按钮时，我需要防止浏览器捕捉到先前的滚动位置：

```
<a href="javascript:history.go(-1)"
      onClick="javascript:history.go(-1)" title="< GO BACK"></a> 
```

按下该按钮后，浏览器将返回到此页面上的先前滚动位置，我想停止该行为并仅加载页面顶部。

希望有人知道正确的解决方案。

-示例-

打开页面向下滚动转到新页面并点击后退按钮页面将自动向下滚动到您之前滚动的位置！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:18:52.490

我相当确定您所描述的行为最好归类为被认为是用户偏好的行为之一。（你不想篡改的那些东西之一）

@mrtsherman 为此提出了一个[hack/解决方法](https://stackoverflow.com/a/7035679/665401)，但除非它严重破坏了您的 web 应用程序的可用性，否则我认为您应该让浏览器按照用户通常期望的方式运行（并滚动到他们离开时所处的位置这页纸）。如果您使用它，请务必为 mrtsherman 的 js 甜心点赞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T11:31:49.980

我有同样的问题，我还没有找到正确的解决方案，
但我可以为你提供一个非常好的解决这个问题的方法。

只需在加载下一页**之前**滚动到顶部。
当用户单击返回时，浏览器将滚动到顶部。

**例子：**

第一页：
`<a href="page2.htm" onclick="window.scrollTo(0, 0);">Next</a>`

第二页：
`<a href="page1.htm" onclick="history.go(-1); return false;">Back</a>`

请注意，`href="page1.htm"`仅当用户选择在新窗口/标签中打开时才加载

原谅我的英语。我希望这有帮助。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2013-01-24T15:32:28.173

**我找到了更好的解决方案！**

将以下代码放在每一页上：

```
<script>
  setTimeout('window.scrollTo(0, 0);', 1);
</script> 
```

# php - 进行 AJAX 调用以更新文本区域的数据库 onChange

> ID：11512146
> 
> 赞同：1
> 
> 时间：2012-07-16T20:37:49.703
> 
> 标签：php, javascript, jquery, ajax

我正在尝试在我的网站上创建一个功能，该功能会自动更新数据库 onchange 下面的文本区域（这将充当“提醒的便利贴”）。我是 ajax 新手，我想知道是否有人可以向我展示一个基本示例，说明我将如何进行 AJAX 调用以更新我的数据库 onChange 下面的 textarea？

```
<?php
//Create mysql connect variable
$conn = mysql_connect('samplesource.com', 'example', 'pass');

//kill connection if error occurs
if(!$conn){
    die('Error: Unable to connect.' . '<br>' . mysql_error());
}
//connect to mysql database
mysql_select_db("mydb", $conn);

session_start();
$userid = $_SESSION['id'];

$results = ("SELECT * FROM notes WHERE userid='$userid'");
?>

<html>
<head>
<title>practice</title>
<script src="jquery.js"></script>
<script type="text/javascript">
$(document).ready(function() {     
    $(".sometext").change(function(){   
        //make ajax call to update database onChange    
    }); 
}); 
</script>
</head>
<body>

<textarea class="note" style="resize:none; width:300px; height:200px;"> </textarea>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T20:44:54.417

首先，您需要将数据库保存脚本移动到一个新文件中，例如 save.php

在你的`<textarea>`我会添加

```
<textarea onchange="saveChanges(this);"></textarea> 
```

对于进行更改时调用的 javascript save 函数：

```
function saveChanges(object){   
    $.ajax({
        url: 'save.php',
        data: 'content=' + object.value,
        cache: false,
        error: function(e){
            alert(e);
        },
        success: function(response){
            // A response to say if it's updated or not
            alert(response);
        }
    });   
} 
```

这是一种非常快速和肮脏的方式。

# r - 使用同一数据框中的数据填充 data.frame 中的缺失值

> ID：11512147
> 
> 赞同：2
> 
> 时间：2012-07-16T20:37:54.457
> 
> 标签：r, dataframe, fill, na

我正在尝试用最近的前列数据回填一个完全外连接的表。

我拥有的数据框看起来像..（没有行两边都为 NA，表格按日期排序）。

```
 date     X         Y
2012-07-05 00:01:19   0.0122     NA
2012-07-05 03:19:34   0.0121     NA
2012-07-05 03:19:56   0.0121   0.027
2012-07-05 03:20:31   0.0121     NA
2012-07-05 04:19:56   0.0121   0.028
2012-07-05 04:20:31   0.0121     NA
2012-07-05 04:20:50   0.0121     NA
2012-07-05 04:22:29   0.0121   0.027
2012-07-05 04:24:37   0.0121     NA
2012-07-05 20:48:45   0.0121     NA
2012-07-05 23:02:34    NA      0.029
2012-07-05 23:30:45    NA      0.029 
```

有了这个，我正在寻找..

1.  保留非数据缺失的行。
2.  如果任一侧缺失（NA），则用具有有效对侧值的“最近的前一个”行填充它。

所以结果，我想让桌子看起来像......

```
 date     X         Y
2012-07-05 00:01:19   0.0122     NA
2012-07-05 03:19:34   0.0121     NA
2012-07-05 03:19:56   0.0121   0.027
2012-07-05 03:20:31   0.0121   0.027
2012-07-05 04:19:56   0.0121   0.028
2012-07-05 04:20:31   0.0121   0.028
2012-07-05 04:20:50   0.0121   0.028
2012-07-05 04:22:29   0.0121   0.027
2012-07-05 04:24:37   0.0121   0.027
2012-07-05 20:48:45   0.0121   0.027
2012-07-05 23:02:34   0.0121   0.029
2012-07-05 23:30:45   0.0121   0.029 
```

我可以使用什么样的 R 命令来实现这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T20:44:10.557

`na.locf`从`zoo`包装中使用

```
dat <- read.table(text="2012-07-05 00:01:19   0.0122     NA
2012-07-05 03:19:34   0.0121     NA
2012-07-05 03:19:56   0.0121   0.027
2012-07-05 03:20:31   0.0121     NA
2012-07-05 04:19:56   0.0121   0.028
2012-07-05 04:20:31   0.0121     NA
2012-07-05 04:20:50   0.0121     NA
2012-07-05 04:22:29   0.0121   0.027
2012-07-05 04:24:37   0.0121     NA
2012-07-05 20:48:45   0.0121     NA
2012-07-05 23:02:34    NA      0.029
2012-07-05 23:30:45    NA      0.029")

require("zoo")
na.locf(dat)
#           V1       V2     V3    V4
#1  2012-07-05 00:01:19 0.0122  <NA>
#2  2012-07-05 03:19:34 0.0121  <NA>
#3  2012-07-05 03:19:56 0.0121 0.027
#4  2012-07-05 03:20:31 0.0121 0.027
#5  2012-07-05 04:19:56 0.0121 0.028
#6  2012-07-05 04:20:31 0.0121 0.028
#7  2012-07-05 04:20:50 0.0121 0.028
#8  2012-07-05 04:22:29 0.0121 0.027
#9  2012-07-05 04:24:37 0.0121 0.027
#10 2012-07-05 20:48:45 0.0121 0.027
#11 2012-07-05 23:02:34 0.0121 0.029
#12 2012-07-05 23:30:45 0.0121 0.029 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T20:49:31.703

也许你应该试试这个

```
> library(zoo)
> na.locf(Data)
                x     y
2012-07-17 0.0122  <NA>
2012-07-18 0.0121  <NA>
2012-07-19 0.0121 0.027
2012-07-20 0.0121 0.027
2012-07-21 0.0121 0.028
2012-07-22 0.0121 0.028
2012-07-23 0.0121 0.028
2012-07-24 0.0121 0.027
2012-07-25 0.0121 0.027
2012-07-26 0.0121 0.027
2012-07-27 0.0121 0.029
2012-07-28 0.0121 0.029 
```

`Data`你在哪里`data.frame`

# python - QGraphicsItem 是否接收到所有鼠标移动？

> ID：11512152
> 
> 赞同：2
> 
> 时间：2012-07-16T20:38:04.627
> 
> 标签：python, qt, pyqt, pyside

我有一个 QGraphicsItem 的子类。默认情况下，QGraphicsItem 仅在指针位于项目的 boundingRect 内并且还发生了 mousePressEvent 时才接收 mouseMoveEvents。

我希望这个子类接收在它所属的 QGraphicsScene 中发生的所有 mouseMoveEvents（最好在项目坐标中）。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:16:17.833

是的。您可以使用它`QGraphicsItem::grabMouse()`来确保您获得所有鼠标事件。如果你这样做了，那么[Qt 承诺如下](http://qt-project.org/doc/qt-4.8/qgraphicsitem.html#grabMouse)：

> 该项目将接收场景的所有鼠标事件，直到发生以下任何事件：
> 
> *   该项目变得不可见
> *   该项目已从场景中移除
> *   项目已删除
> *   该项目调用 ungrabMouse()
> *   另一个项目调用grabMouse(); 当另一个项目调用 ungrabMouse() 时，该项目将重新获得鼠标抓取。

# git - 如何测试 git 钩子

> ID：11512155
> 
> 赞同：40
> 
> 时间：2012-07-16T20:38:10.637
> 
> 标签：git, git-post-receive

由于“测试”是 Git 钩子的常见用途，我的问题很难搜索。

我正在编写一个相当复杂的 git post-receive 钩子，并想知道测试它的最佳方法是什么。目前我的流程是：

*   在一个虚拟的“远程”仓库中对 post-receive 进行更改
*   更改虚拟本地存储库
*   在虚拟本地仓库中提交更改
*   将更改推送到虚拟远程仓库

有没有更简单的方法来测试这个？理想情况下，它看起来像：

*   对虚拟回购中的接收后进行更改
*   发出“魔术”命令来测试接收后

也许我可以“重新发布”以前的推送，或者让远程仓库就像它刚刚收到带有特定哈希的推送一样？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-16T20:47:59.797

编写一个只记录其参数/环境并将其转储到文件的钩子。然后，您可以在闲暇时使用相同的环境/参数重新调用真正的钩子，它就像您刚刚重新发出完全相同的推送一样。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2016-09-05T02:12:13.087

回答这个四年前的问题。

如果你想测试钩子，你需要先在本地环境中测试，我给出了后续的详细命令，`post-receive`作为示例：

```
$ mkdir /tmp/hook_test
$ cd /tmp/hook_test

# set local git repo, where you put hooks in it.
$ git clone --bare https://github.com/git/git.git

# set develop environment which is cloned from the new created repo. 
$ git clone git.git repo 

# copy and rename the hook you need test to "post-receive"
$ cd git.git/hooks
$ cp ~/post-receive-test post-receive

# suppose the hook script is bash script.
# edit "post-receive" and add "set -x" to second line in it to active debug

$ cd /tmp/hook_test/repo
# emulate a hook trigger, do some changes, "git add" and "git commit" it 

$ git push

# Now you should see the script "post-receive" runs automatically with debug details. 
```

您应该可以自由运行`git push`，更新仅推送到本地存储库`/tmp/hook_test/git.git`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-12-07T20:30:21.107

我的方法是在远程仓库中拨回 HEAD 一次提交，然后再次推送：

```
ssh <repo> 'cd /<repo_path>; git update-ref refs/heads/master HEAD^' && git push origin master 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-04-03T13:00:07.870

对于调试，你也可以像这样结束你的钩子：

```
echo "No errors found."
exit 1 
```

如果你对你的钩子感到满意，你当然会再次取出最后一行。

# android - 如何测量高达毫秒之间的点击时间？

> ID：11512157
> 
> 赞同：-1
> 
> 时间：2012-07-16T20:38:17.373
> 
> 标签：android

我想以毫秒为单位测量连续点击之间的时间。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T21:25:23.603

```
View myView;
long previousClickTime;

...

myView.setOnTouchListener(new View.OnTouchListener(){
    @Override
    public boolean onTouch(View v, MotionEvent ev)
    {
        long temp = System.currentTimeMillis();
        if (previousClickTime != 0)
        {
            Log.i("MyView", "Time Between Clicks=" + (temp - previousClickTime));
        }
        else
        {
            Log.i("MyView", "First Click");
        }
        previousClickTime = temp;

        return true;//Note that you can return false, and any underlying Views will then receive this touch event.
    }
} 
```

附带说明，如果您尝试检测双击，请尝试[GuestureDetector.setOnDoubleTapListener](http://developer.android.com/reference/android/view/GestureDetector.html#setOnDoubleTapListener%28android.view.GestureDetector.OnDoubleTapListener%29)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:44:26.767

覆盖`onCLick()`事件。

活动内部`onClick()`。让您的应用获得第一次点击并存储时间。然后存储第二次，得到两次抽头的差值。并且只是显示差异。

*下面的代码非常简单，可能不是您要找的，但我把它放在那里作为一个非常微不足道的例子。*

```
long initialTime = 0;
long endTime = 0;

onClick() {

    if(initialTime == 0){
        initialTime = System.currentTimeMillis();
    } else {
        endTime = System.currentTimeMillis();
        long diff = endTime - initialTime;
        initialTime = endTime;
        Log.i("your app", "time between click: " + diff);
    }

} 
```

# ruby-on-rails - 如何在 Windows 上测试 Rails？

> ID：11512158
> 
> 赞同：0
> 
> 时间：2012-07-16T20:38:20.043
> 
> 标签：ruby-on-rails, unit-testing

在运行我的 Rails 测试之前，我很沮丧地发现 rake 需要 20 多秒才能加载。我搜索了一下，似乎 Rails 中的所有内容在 Windows 上都慢得多。我尝试使用 spork 但它在 Windows 上不起作用。

那么如何在 Windows 上测试 Rails？你如何设置你的环境？

连续测试怎么样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T17:00:05.933

经过大量搜索后，得出的结论是：

1) Windows 上的 Ruby（以及 Rails）非常缓慢。

2) 尝试在 Windows ( [https://github.com/thecodeshop/ruby/wiki/Downloads](https://github.com/thecodeshop/ruby/wiki/Downloads) ) 上使 Ruby 更快。虽然它不如 *nix 快，但它的速度足以应付。

所以答案是：尽可能避免在 Windows 上开发 Rails。如果您仍然想/必须在 Windows 上进行开发，那么将您的 Ruby 文件替换为 The Code Shop 的 Ruby 构建，它将为您提供可行的速度。

作为旁注，对于所有关于开放、拥抱多样性等的讨论，Ruby 和 Rails 社区非常反对人们询问如何在 Windows 上执行 X 或 Y。在我的搜索中，我看到的大多数帖子的语气都是“Winblows sux00rz！获得 Mac 或 Linux”。

**更新：** 我让 spork + autotest + growl 在 Windows 上工作，因此测试更快且自动化。我把说明放在这篇[博](http://www.manueldeleon.com/Blog/post/2012/07/30/Rails-Testing-on-Windows-%28The-Fast-and-Easy-Way%29.aspx)文中。

# redirect - 在同一个网站上托管多个域

> ID：11512159
> 
> 赞同：0
> 
> 时间：2012-07-16T20:38:23.350
> 
> 标签：redirect, iis-6, isapi-rewrite, isapi-redirect

在 IIS 6 中，我需要允许多个域通过单个网站，以便它们都可以共享相同的母版页和数据库。他们都会有一个统一的外观。我为每个站点拥有一个单独的域名。我需要知道实现这一目标的最佳方法是什么。我已经阅读了有关 ISAPI 重写的信息，但并不真正了解它是如何工作的。我还考虑过仅使用基于 url 的重定向语句。每个网站都有相同的目的，但每个网站都是为一家单独的公司服务的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:51:08.067

听起来您想使用主机标头。一个站点可以“回答”多个域名。

[使用主机头名称托管多个网站 (IIS 6.0)](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/883a9544-3f70-4d46-a6df-bbadbd1fe7de.mspx)

# javascript - 从 URL 获取 JSON 文件，XMLHttpRequest 无法加载错误

> ID：11512171
> 
> 赞同：1
> 
> 时间：2012-07-16T20:38:57.213
> 
> 标签：javascript, json, parsing, xmlhttprequest, jsonp

我需要从 URL 读取 JSON 文件并显示。我已经阅读了很多帖子，但仍然无法解决问题。

网址：[http ://webapp.armadealo.com/home.json](http://webapp.armadealo.com/home.json)

我面临这个错误： XMLHttpRequest cannot load

代码如下

```
$.getJSON("http://webapp.armadealo.com/home.json", function(data){
alert(data);
}); 
```

我尝试添加到网址

```
&callback=? 
```

并使其成为 jsonp，仍然没有运气。我也用过

```
<meta http-equiv="Access-Control-Allow-Origin" content="*" /> 
```

仍然没有运气。

在服务器端我们需要做些什么吗？遇到这种错误并找到解决方案的人，请帮帮我！非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:52:46.723

由于安全原因，您不能发出这样的跨域 AJAX 请求。因此，如果您想从另一个域加载内容，则必须使用一种解决方法：JSONP（[更多信息](http://bob.ippoli.to/archives/2005/12/05/remote-json-jsonp/)，[示例](http://www.jquery4u.com/json/jsonp-examples/)）

对 AJAX 请求使用以下代码：

```
$.ajax({
    url: 'http://webapp.armadealo.com/home.json',
    type: 'GET',
    jsonpCallback: 'myCallback',
    dataType: "jsonp",
    success: function(data) {
        console.log(data);
    }
}); 
```

为了使其工作，您必须将 JSON 数据包装在括号中并在开头添加回调名称：

```
myCallback({ ... JSON ... }) 
```

编辑：刚刚注意到你已经尝试过使用 JSONP ......好吧，至少上面的代码对我有用，也许你想试一试。;)

# indexing - 字段含义：执行解释分析的索引的缓冲池页数

> ID：11512172
> 
> 赞同：1
> 
> 时间：2012-07-16T20:39:02.300
> 
> 标签：indexing, db2

我正在使用解释工具分析 IBM Data Studio 中 SQL 语句的访问计划。我添加了一个新的索引，它大大提高了我的 SQL 语句的成本。我对索引的 B-Tree 结构很感兴趣。索引级别的数量是三个。我想知道内存中有多少 2 级页面以及 2 级节点的分支因子（扇出，例如 1001）。因此，我尝试查看以下字段：缓冲池页数。它是 191646。索引引用的表也有 191646 的缓冲池页数。显然这两个数字是相同的。此外，索引叶页数为 35257。如果有 35257 个索引叶页，则有 191646 个缓冲池页是没有意义的。

如何估计完整 B-Tree 的大小？如何找出存在多少索引页（在每个级别）以及它们中有多少驻留在内存中？

# winapi - 为什么 DeviceIoControl 将 12 个字节的信息添加到用户提供的输入缓冲区？

> ID：11512178
> 
> 赞同：1
> 
> 时间：2012-07-16T20:39:20.427
> 
> 标签：winapi, usb, driver, wdf

我希望这不是一个完全脑残的问题。

我正在编辑模板 WDF Windows USB 设备驱动程序，以将格式化数据发送到设备的批量输出管道之一；必须以某种方式设置数据以告诉设备读取内部寄存器。

问题是我无法让数据以所需的确切格式通过总线。我编写了一个小型测试应用程序来枚举设备并`DeviceIoControl`在输入缓冲区设置为我根据规范设置的结构的情况下进行调用。

我有一个工作案例的 USB 总线跟踪副本（由我无权访问其源的驱动程序执行），并且我捕获了一个总线跟踪，以了解当我在驱动程序中调用自定义 IOCTL 时会发生什么。我通过总线看到的是我设置的以 12 个字节数据为前缀的数据结构；数据结构是正确的，但我想知道最初的十二字节数据是什么，并阻止驱动程序发送它们。

我相信驱动程序已经正确编写；我在驱动程序中放置了一些调试跟踪，看起来由检索到的缓冲区`WdfRequestRetrieveInputMemory`已经预先添加了 12 个字节，所以这似乎是在驱动程序前发生的。

如果它是有用的信息，则 IOCTL 设置`METHOD_BUFFERED`为`FILE_ANY_ACCESS`.

设置它的测试代码的相关部分非常简单：

```
const ULONG         ulBufferSize = sizeof( CONTROL_READ_DATA );
unsigned char       pBuffer[sizeof(CONTROL_READ_DATA)];
DWORD               dwBytesReturned;
CONTROL_READ_DATA*  readData = (CONTROL_READ_DATA*)pBuffer;

readData->field1 = data;
readData->field2 = moreData;
// ... all fields filled in...

// Send IOCTLs into camera
if( !::DeviceIoControl( hDevice,
                        IOCTL_CUSTOM_000,
                        &readData,
                        ulBufferSize,
                        &readData,
                        ulBufferSize,
                        &dwBytesReturned,
                        NULL ) )
{
    dwError = ::GetLastError();
    // Clean up here
    return dwError;
} 
```

我通过总线看到的数据是：`80FD1200 CCCCCCCC CCCCCCCC`+（我的数据）。

有没有人有任何见解？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:51:54.547

哇，真是可笑的错误。请注意，我正在传递to的*地址*，它本身已经是一个指针。我不敢相信我在这上面浪费了这么多时间。`readData``DeviceIoControl`

谢谢大家！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:48:26.400

数据对齐是罪魁祸首。查看[http://msdn.microsoft.com/en-us/library/2e70t5y1(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/2e70t5y1(v=vs.80).aspx)将其设置为 1。

# cocos2d-iphone - 使用 Cocos2d 实现格力

> ID：11512187
> 
> 赞同：0
> 
> 时间：2012-07-16T20:39:49.290
> 
> 标签：cocos2d-iphone

（如果你想直接回答这个问题，你可以放弃部分）几个月前我花了几个小时来成功实现 OpenFeint。太糟糕了，OpenFeint 已经被 104Mo$ 买了，我必须重新制作所有东西。由于我在 OpenFeint 中创建了一个随机测试帐户，并且无法再创建新帐户，我被困住了！

（实际问题）嗯，有人在基本的 Cocos2d 示例应用程序上实现 Gree 吗？GameCenter 的实现现在如何与格力一起工作？我已经查看了这个博客：[http](http://www.mostafaberg.com/2012/06/how-to-add-gree-to-your-ios-game/) ://www.mostafaberg.com/2012/06/how-to-add-gree-to-your-ios-game/ ，它对我有所帮助但还不足以成功！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:24:21.037

对于所有坚持使用 Gree 和 Cocos2d 的人：

[http://www.mostafaberg.com/2012/08/integrating-gree-into-your-cocos2d-game/](http://www.mostafaberg.com/2012/08/integrating-gree-into-your-cocos2d-game/)

# eclipse - 如何解析 Xtext 语法中的伪浮点数？

> ID：11512193
> 
> 赞同：0
> 
> 时间：2012-07-16T20:40:38.320
> 
> 标签：eclipse, dsl, xtext

我需要过滤 XX.XX 形式的“参考编号”，其中 X 是任何大写或小写字母或数字 (0-9)。这就是我想出的：

```
SCR_REF:
  'Scr_Ref' ':' value=PROFILE
;

terminal PROFILE :
   ((CHAR|INT)(CHAR|INT)'.'(CHAR|INT)(CHAR|INT))
;

terminal CHAR returns ecore::EString : ('a'..'z'|'A'..'Z'); 
```

但他在生成的编辑器中不起作用。以下测试条目：

```
Scr_Ref: 11.22 
```

抛出一个错误说：

> “在角色'没有可行的选择。' "

我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T06:15:46.313

我认为你的问题是你在这里使用默认的 INT 。11 和 22 本身都是整数。您需要这里的数字而不是整数。下面我给你做了一个例子。

```
 grammar org.xtext.example.mydsl.MyDsl with org.eclipse.xtext.common.Terminals

generate myDsl "http://www.xtext.org/example/mydsl/MyDsl"
import"http://www.eclipse.org/emf/2002/Ecore" as ecore 

Model:
    greetings+=Greeting*;

Greeting:
    'Hello' name=ID '!' "val=" val= PROFILE;
terminal PROFILE :
   ((CHAR|DIGIT)(CHAR|DIGIT)'.'(CHAR|DIGIT)(CHAR|DIGIT))
;
terminal DIGIT:
    ('0'..'9')
;
terminal CHAR returns ecore::EString : 
    ('a'..'z'|'A'..'Z')
; 
```

希望这可以帮助。

# powerpoint - ooxml 中存储的透明度是什么单位？

> ID：11512198
> 
> 赞同：0
> 
> 时间：2012-07-16T20:40:51.510
> 
> 标签：powerpoint, openxml

我有一个单一形状的 pptx 文件。将其设置为 70% transaprent 我可以比较 pptx 并看到唯一的区别在于 /ppt/slides/slide1.xml

```
 <a:solidFill>
  <a:schemeClr val="accent1">
   <a:alpha val="40000"/>
  </a:schemeClr>
 </a:solidFill> 
```

有人知道地球上的“70%”如何转换为“40000”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T17:47:55.967

对我来说似乎不同。我的 alpha 值似乎使用了这个函数：

```
y = -1000x + 100000 
```

其中`x`是百分比，`y`是 alpha 值。我建议您也这样做（根据您的计算机找出一个功能并验证它们）而不必担心。

似乎每个百分比单位对应于 1000 个这些 alpha 单位。

# c# - 如何访问返回泛型类型的类中的方法

> ID：11512201
> 
> 赞同：0
> 
> 时间：2012-07-16T20:41:07.103
> 
> 标签：c#, .net

我有一个名为 config 的类，其中包含两个名为 key paramValue 和 parameterPath 的字符串字段。

当我应用类的ChooseType 方法时，该方法必须返回一个不同类型（Int 或bool 或String）的变量paramValue。

我实现它如下：

```
 class ConfigValue
  {
      public string paramPath;
      private string paramValue;

      public enum RetType {RetInt, RetBool, RetString};

       public T PolimorphProperty<T>(RetType how) 
       {

          { 
            switch (how)
             {
             case RetType.RetInt:
               return (dynamic)int.Parse(paramValue);

             case RetType.RetBool:
               return (dynamic)Boolean.Parse(paramValue);

             case RetType.RetString:
               return (T)(object)paramValue;

             default:
               throw new ArgumentException("RetType not supported", "how");

              }
          }   
      }
  } 
```

我的问题是如何访问 ConfigValue 类中的 PolimorphProperty 方法，以检索例如 paramValue Int 类型。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:44:46.150

拥有`T`和`RetType`是多余的。它应该是这样的：

```
class ConfigValue
{
    public string paramPath;
    private string paramValue;

    public T PolimorphProperty<T>()
    {
        return (T)Convert.ChangeType(paramValue, typeof(T));
    }
} 
```

称它为`configValue.PolimorphProperty<int>()`.

或者如果您需要手动实现类型转换，您可以执行以下操作：

```
class ConfigValue
{
    public string paramPath;
    private string paramValue;

    public T PolimorphProperty<T>()
    {
        if (typeof(T) == typeof(MySpecialType))
            return (T)(object)new MySpecialType(paramValue);
        else
            return (T)Convert.ChangeType(paramValue, typeof(T));
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:56:51.347

我认为以下代码最符合您的要求（我在写这里之前已经对其进行了测试......）

```
public T PolimorphProperty<T>()
{
      object tt = Convert.ChangeType(paramValue, typeof(T));
      if (tt == null)
         return default(T);
      return (T) tt;
} 
```

你可以这样调用代码：

```
 int ret = cv.PolimorphProperty<int>(); 
```

### 笔记：

*   你真的不需要在参数列表中传递任何东西来确定返回值的类型。
*   确保将 try-catch 放在您检查适合您未来使用的类型的任何位置。

# java - 本机方法上的 JNI UnsatisfiedLinkError

> ID：11512203
> 
> 赞同：1
> 
> 时间：2012-07-16T20:41:24.800
> 
> 标签：java, c++, c, java-native-interface

我正在为 C++ BSD 套接字客户端运行一个基本的 Java 包装器。我可以编译 Java 并生成一个头文件，但是当我尝试运行它时，它返回`Exception in thread "main" java.lang.UnsatisfiedLinkError: JavaClient.socketComm()V`

从我能找到的情况来看，这似乎表明方法签名之间不匹配，但我找不到我的任何问题。

Java 代码

```
public class JavaClient 
{
    public native void socketComm();

    public static void main(String[] args)
    {
        System.load("/home/cougar/workspace/ArbiterBSDSocketComms/JNIClient/JavaClient.so");
        JavaClient client = new JavaClient();
        client.socketComm();

        System.out.println("Done");
    }
} 
```

C 实现

```
#include <iostream>
#include <string.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netdb.h>
#include <unistd.h>
#include <errno.h>
#include <cstdlib>
#include <stdio.h>
#include <jni.h>
#include "JavaClient.h"
#define MAXHOSTNAME 256

JNIEXPORT void JNICALL Java_JavaClient_socketComm
    (JNIEnv *env, jobject obj) {
    struct sockaddr_in remoteSocketInfo;
    struct hostent *hPtr;
    int socketHandle;
    char *remoteHost="localhost";
    int portNumber = 8080;

memset(&remoteSocketInfo, 0, sizeof(struct sockaddr_in));       //Clear structure memory

if ((hPtr = gethostbyname(remoteHost)) == NULL)             //Get sysinfo
{
    printf("System DNS resolution misconfigured.");
    printf("Error number: ", ECONNREFUSED);
    exit(EXIT_FAILURE);
}

if((socketHandle = socket(AF_INET, SOCK_STREAM, 0)) < 0)        //Create socket
{
    close(socketHandle);
    exit(EXIT_FAILURE);
}

memcpy((char *)&remoteSocketInfo.sin_addr,
        hPtr->h_addr, hPtr->h_length);                          //Load sys info into sock data structures
remoteSocketInfo.sin_family = AF_INET;
remoteSocketInfo.sin_port = htons((u_short)portNumber);         //Set port number

if(connect(socketHandle, (struct sockaddr *)&remoteSocketInfo, sizeof(struct sockaddr_in)) < 0)
{
    close(socketHandle);
    exit(EXIT_FAILURE);
}

int rc=0;
char buf[512];

strcpy(buf, "Sup server");
send(socketHandle, buf, strlen(buf)+1, 0);
}

void main(){} 
```

头文件

```
/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class JavaClient */

#ifndef _Included_JavaClient
#define _Included_JavaClient
#ifdef __cplusplus
extern "C" {
#endif
/*
 * Class:     JavaClient
 * Method:    socketComm
 * Signature: ()V
 */
JNIEXPORT void JNICALL Java_JavaClient_socketComm
  (JNIEnv *, jobject);

#ifdef __cplusplus
}
#endif
#endif 
```

请原谅一些错误的格式，我没有太多使用stackoverflow，代码格式有点粗略。

这些文件都驻留在 /JNIClient 中。

我正在运行 Ubuntu 12.04 x64，并且安装了 32 位和 64 位 JDK。我尝试首先使用 32 位版本生成 .so，这本来是理想的，但我遇到了 ELF 不匹配，所以我只使用 64 位，所以我不必处理这个问题。（也欢迎对此的任何见解。）

我的流程是：

`$>javac JavaClient.java`

`$>javah JavaClient`

`$>cc -m64 -g -I/usr/lib/jvm/java-6-openjdk-amd64/include -I/usr/lib/jvm/java-6-openjdk-amd64/include/linux -shared JavaClient.c -o JavaClient.so`

`$>java JavaClient`

完整的错误信息是

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: JavaClient.socketComm()V
    at JavaClient.socketComm(Native Method)
    at JavaClient.main(JavaClient.java:9) 
```

`$>nm JavaClient.so`返回：

```
cougar@Wanda:~/workspace/ArbiterBSDSocketComms/JNIClient$ nm JavaClient.so
0000000000200e50 a _DYNAMIC
0000000000200fe8 a _GLOBAL_OFFSET_TABLE_
             w _Jv_RegisterClasses
0000000000200e30 d __CTOR_END__
0000000000200e28 d __CTOR_LIST__
0000000000200e40 d __DTOR_END__
0000000000200e38 d __DTOR_LIST__
00000000000005e0 r __FRAME_END__
0000000000200e48 d __JCR_END__
0000000000200e48 d __JCR_LIST__
0000000000201010 A __bss_start
                 w __cxa_finalize@@GLIBC_2.2.5
0000000000000540 t __do_global_ctors_aux
0000000000000490 t __do_global_dtors_aux
0000000000201008 d __dso_handle
                 w __gmon_start__
0000000000201010 A _edata
0000000000201020 A _end
0000000000000578 T _fini
0000000000000438 T _init
0000000000000470 t call_gmon_start
0000000000201010 b completed.6531
0000000000201018 b dtor_idx.6533
0000000000000510 t frame_dummy 
```

编辑：我有一个理论认为 .so 构建不正确，因为`$>nm JavaClient.so`它没有显示其中的方法名称。关于该 cc 命令有什么问题的任何建议？

**好的，所以：我坚持这样做是因为似乎没有什么是对的。方法签名都匹配了，应该没有错，eclipse文件属性说正在编辑正确的文件等等等等。我终于猫了JavaClient.c，它是空白的。显然 eclipse 并没有真正编辑它所说的文件。修复了它，现在一切都很好。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:10:29.807

我会给你一个更好的解决方案。

```
public void socketComm() throws IOException
{
  Socket socket = new Socket("localhost", 8080);
  try
  {
    socket.getOutputStream().write("Sup server\u0000".getBytes());
  }
  finally
  {
    socket.close(); // You forgot this
  }
} 
```

根本不需要 JNI。如果 socket() 返回 < 0，它也不会关闭无效句柄，这与您的代码不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:52:27.033

我坚持这样做，因为似乎没有什么是对的。方法签名都匹配了，应该没有错，eclipse文件属性说正在编辑正确的文件等等等等。我终于猫了JavaClient.c，它是空白的。显然 eclipse 并没有真正编辑它所说的文件。修复了它，现在一切都很好。

不知道为什么 Eclipse 声称正在编辑一个空白文件，我检查并重新检查它并没有引用任何链接或任何东西，但如果你遇到和我一样的问题，请检查一下。

# json - 来自 Google Places Library 响应的 geoxml3 标记

> ID：11512205
> 
> 赞同：-1
> 
> 时间：2012-07-16T20:41:30.553
> 
> 标签：json, google-maps-api-3

有人知道如何将来自 Google Places Library 的响应翻译成 geoxml3 可以理解和呈现的内容吗？

工作至今：

这对我很有效

```
var a = {
    location: new google.maps.LatLng(12, 13),
    radius: 1000
};
var places = new google.maps.places.PlacesService(map);
places.search(a,searchCallback);
...
(in searchCallback function)    
var m = new google.maps.Marker({map: map, position: place.LatLng}); 
```

但我还需要动态创建标记，所以我需要使用 geoxml3。我的问题是用这个替换最后一行

```
var m = parser.createMarker(place); 
```

导致此错误

```
Uncaught TypeError: Cannot read property 'icon' of undefined 
```

可能是因为它的来源无法加载图标`http://maps.gstatic.com/mapfiles/place_api/icons/restaurant-71.png`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:12:34.110

[geoxml3](http://code.google.com/p/geoxml3/)是一个谷歌地图 API v3 kml 解析器。如果您将来自places API 的响应翻译成kml，您可以完成这项工作，但我不知道您为什么要这样做。也许您可以解释为什么要使用 geoxml3，您不需要它来实现“动态创建标记”的既定目标，因为没有它，您可以使用 google maps API v3 轻松做到这一点。

# php - 在 db 表中计算它自己的 ID 的总分钟数

> ID：11512209
> 
> 赞同：0
> 
> 时间：2012-07-16T20:42:01.660
> 
> 标签：php, mysql, yii

我正在尝试显示一些给定日期范围的统计数据。在表行中有许多 ID 并试图计算它自己的 ID 的总分钟数。

当前返回值如下：

```
{"id":"25","minute":13}
{"id":"17","minute":12}
{"id":"16","minute":10}
{"id":"17","minute":10}
{"id":"16","minute":4}
{"id":"34","minute":5}
{"id":"17","minute":21}
{"id":"30","minute":12}
{"id":"30","minute":13}
{"id":"30","minute":50} 
```

控制器

```
public function actionStats()  {
    if (isset($_POST['begin'], $_POST['end'])) {
        $begin = strtotime($_POST['begin']);
        $end = strtotime($_POST['end']);

        $Criteria = new CDbCriteria();
        $Criteria->condition = "created >= $begin and  created <= $end and status=1";
        $transcripts = Transcripts::model()->findAll($Criteria);

        foreach($transcripts as $transcript)  {
            $op = $transcript->opID;
            $minute = $transcript->ended - $transcript->created;

            echo json_encode(array("id" => $op, "minute" => floor($minute/60)));
        }
    }       
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:48:43.073

在 MySQL 查询中添加它怎么样？例如具有以下`SUM`功能：

[http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:49:26.483

我会将您的代码修改为：

```
public function actionStats()
{

    if (isset($_POST['begin'], $_POST['end']))
    {
        $begin = strtotime($_POST['begin']);
        $end = strtotime($_POST['end']);

        $Criteria = new CDbCriteria();
        $Criteria->condition = "created >= $begin and  created <= $end and status=1";
        $transcripts = Transcripts::model()->findAll($Criteria);

        $transcriptTotals = array();
        foreach($transcripts as $transcript)
        {

            $op = $transcript->opID;
            $minute = $transcript->ended - $transcript->created;
            if (array_key_exists($op, $transcriptTotals)) {
                $transcriptTotals[$op] += floor($minute/60);
            } else {
                $transcriptTotals[$op] = floor($minute/60);
            }
        }
        echo json_encode($transcriptTotals);
    }       

} 
```

这应该会产生如下所示的输出：

```
{'1':'2', 'id':'sumOfMinutes', etc} 
```

如果您的 JSON 需要像上面指定的那样，您将有如下代码：

```
foreach ($transcriptTotals as $id=>$sum) {
    echo json_encode(array('id'=>$id, 'minutes'=>$sum));
} 
```

# javascript - trigger('click') 的行为与实际用户点击不同

> ID：11512216
> 
> 赞同：0
> 
> 时间：2012-07-16T20:42:38.667
> 
> 标签：javascript, jquery, forms, events, click

我试图让网页在通过 url 传递字符串时单击特定按钮。

```
...url?key=button1 
```

HTML：

```
 <button type="submit" id="button1" value="*some other url*" >Button 1</button 
```

然后我有以下jquery：

```
var locate = window.location;
locate = locate.toString();
var text = locate;

$(function(){
 var temp = "?key="; 
        if (text.indexOf(temp) !== -1)
        {
        var position = text.indexOf(temp) + temp.length;
        text = text.substring (position); 
       $(window).load(function ()
            { 
                if (text == 'button1')
                {
                    $("#button1").trigger('click');
                } 
            })
        }             
   }) 
```

然后在我的jQuery中，我有以下代码

```
$("#button1").live("click", function() {

     $('#userform').attr('target', '_blank'); 
     $('#userform').delay(3000).queue(function()
           {
            $('#userform').attr('target', '').dequeue();
           });
}); 
```

那么我这样做的原因超出了我的控制范围。

出于隐私原因，我只能说页面执行提交，然后重定向到提交按钮值中的指定页面。

现在，页面的行为与您想象的一样。

用户单击按钮，表单目标设置为'_blank'，表单提交一些数据并重定向到按钮值中的url。单击该按钮会打开一个新选项卡。

但是，我的问题是，在使用 url 中的信息加载页面时，单击的是按钮，而不是像通常那样在新选项卡中打开，而是在新窗口中打开。

有什么理由为什么 .trigger('click') 甚至 $("#button1").click() 在新窗口中打开而不是当用户单击按钮并在新选项卡中打开时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:46:56.333

您需要在使用 click 绑定到 button1 的函数中防止按钮的默认行为（即提交到指定的 URL）。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:52:19.813

尝试`.click()`在元素本身（即，不是 jQuery 对象）上调用该方法：

```
var btn = $("#button1");
if (text == 'button1' && btn.length)
{
    btn[0].click();
} 
```

# python - python - 字符串转换

> ID：11512218
> 
> 赞同：0
> 
> 时间：2012-07-16T20:42:45.343
> 
> 标签：python

我知道，这个问题的标题很模糊，但我真的不知道如何描述它。这就是我正在尝试做的事情。

我`pyodbc`用来查询数据库，我想允许用户指定一个列，并让我的代码动态地获取它。换句话说，我需要做这样的事情：

```
row_id = "row.%s" % id_column 
```

当然，这会返回一个字符串。pyodbc 期望的是一个变量/属性，如下所示：

```
row_id = row.id 
```

有人可以告诉我该怎么做吗？我尝试搜索“python string to val”，但所有这些页面都告诉我如何将字符串转换为 int——这与我正在尝试做的不同。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T20:45:14.333

您正在寻找[`getattr`](http://docs.python.org/library/functions.html#getattr)：

```
row_id = getattr(row, id_column) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:46:11.463

你的意思是这样的：

```
getattr(row,'id') 
```

或者也许我真的不明白你想要做什么......

# vba - 在工作表之间复制数据

> ID：11512219
> 
> 赞同：1
> 
> 时间：2012-07-16T20:42:51.713
> 
> 标签：vba, excel, pivot-table

我在 excel 的不同工作表中有多个数据透视表（每个工作表 1 个）。我想将它们全部复制到一个新的工作表中，但我希望它们彼此下方，每个之间有 2 行间隙。

我有将表格从一个工作表复制到另一个工作表的代码，但我无法弄清楚如何将另一个表格复制到同一个工作表而不将其粘贴到前一个表格上......

```
'Copy table 1
Sheet1.PivotTables(1).TableRange2.Copy
With Sheet7.Range(Sheet1.PivotTables(1).TableRange2.Address)
    .PasteSpecial xlPasteValuesAndNumberFormats
    .PasteSpecial xlPasteColumnWidths
End With
Application.CutCopyMode = False 
```

每个数据透视表的高度（和宽度）都可以是动态的，因此后续表的偏移量将取决于前一个表的大小......

有谁知道如何实现这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:03:17.200

```
Sub CopyPT()

Dim rngDest As Range
Dim sht As Worksheet, tr As Range

    Set rngDest = Sheet7.Range("B2")

    For Each sht In ThisWorkbook.Worksheets

        If sht.Name <> Sheet7.Name Then
            If sht.PivotTables.Count = 1 Then
                Set tr = sht.PivotTables(1).TableRange2
                'Debug.Print sht.Name, tr.Rows.Count
                tr.Copy
                With rngDest
                    .PasteSpecial xlPasteValuesAndNumberFormats
                    .PasteSpecial xlPasteColumnWidths
                End With
                Set rngDest = rngDest.Offset(tr.Rows.Count + 2, 0)
            End If
        End If

    Next sht

    Application.CutCopyMode = False

End Sub 
```

# facebook - 如何通过 API/文本访问 Facebook 的“点赞”？

> ID：11512221
> 
> 赞同：0
> 
> 时间：2012-07-16T20:42:51.853
> 
> 标签：facebook, facebook-graph-api

我希望我网站上的用户能够说他们对基于 facebook 数据库的东西感兴趣。

例如，在我的网站上，用户将能够搜索“正在运行”，它将访问 Facebook API，并返回该兴趣的 FB Graph API id。

似乎无法在 Facebook 文档中找到执行此操作的方法。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:20:19.023

您可以使用 fql 并查询当前用户的兴趣。下面的 php 代码应该在您拥有当前登录的 userId 后执行此操作。然后只需搜索结果数组以查看它是否包含“正在运行”或等效关键字。

```
$fql = "SELECT interests FROM user WHERE uid = [userId]";
$interests = $facebook->api(array(
    'method' => 'fql.query',
    'query' => $fql
)); 
```

# bash - Solaris10：如何在 inted-started bash 脚本中获取远程端 IP 地址？

> ID：11512222
> 
> 赞同：0
> 
> 时间：2012-07-16T20:42:55.463
> 
> 标签：bash, solaris, solaris-10, inetd

在 Solaris 10 主机上，配置了一个 inetd 服务，以在它获得到预配置端口/服务的传入 TCP 连接时启动 bash 脚本。有没有办法在调用的 bash 脚本中找到远程客户端的 IP 地址？

如果我使用的是 GNU 版本的 inetd，我会使用`--environment`命令行标志。但是我使用的是默认的 Solaris 版本的 inetd/inetadm，它似乎不支持这个标志。有与此设置等效的 Solaris 吗？

我还假设在0 ( ) 或 1 ( )`getpeername(2)`上调用会返回所需的信息，但我正在运行一个 bash 脚本，我似乎没有找到一种方法来调用from bash 的等价物。`fd``stdin``stdout``getpeername(2)`

我唯一的选择是调用 C 包装器，将`getpeername(2)`其存储在环境变量（或命令行参数）中，然后调用主 bash 脚本？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:58:23.870

您可以从 Perl 单行中调用[getpeername ：](http://perldoc.perl.org/functions/getpeername.html)

```
perl -le 'use Socket; ($port,$addr) = sockaddr_in(getpeername(STDIN)); print inet_ntoa($addr);' 
```

包含反引号或任何从 shell 脚本运行的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:51:13.667

您可以通过解析`pfiles`输出来获取它们，例如：

```
pfiles $$ | grep peername | head -1 | nawk '{print $3}' 
```

编辑：

这里有一个更轻松的方式来回复 Nemo 关于启动的进程数的正确评论：

```
pfiles $$ | nawk '/peername/ {print $3;exit}' 
```

# wordpress - Wordpress 自定义帖子类型单循环输出错误帖子

> ID：11512225
> 
> 赞同：0
> 
> 时间：2012-07-16T20:43:15.603
> 
> 标签：wordpress, loops

我一直无法让我的 single-portfolio.php 模板正常运行。

所以我有一个名为投资组合的自定义帖子类型。我在 front-page.php 中显示所有这些帖子，它工作得非常好。这是 front-page.php 的循环：

[http://pastie.org/4268087](http://pastie.org/4268087)

然而，就我的一生而言，我无法在我的 single-portfolio.php 模板中找到正确的帖子。

基本上，如果我去我的一个帖子（例如，让我们说[http://example.com/portfolio/test-post/](http://example.com/portfolio/test-post/)）我最终会得到一个显示错误帖子的帖子页面（所以而不是“测试帖子”我得到“错误的帖子”）。无论我打开什么帖子，都会显示完全相同的帖子（“错误帖子”）。如果我将 posts_per_page 设置为无限，它将显示所有帖子。

我尝试了许多不同的循环。我已经尝试了如上所示的完全相同的循环，以及在 Wordpress Codex 中找到的默认自定义帖子类型循环。

关于如何解决这个问题的任何建议？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T03:19:18.350

在结束后使用[wp_reset_query](http://codex.wordpress.org/Function_Reference/wp_reset_query)。

```
endwhile;
wp_reset_query(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:36:14.767

Zourbuth 的解决方案对我不起作用，但是，在多次失败之后，我找到了 Wordpress 中自定义帖子类型的分页和单页的最佳解决方案。这是我的循环：

```
 <?php

    if ( get_query_var('paged') ) {
        $paged = get_query_var('paged');
    } else if ( get_query_var('page') ) {
        $paged = get_query_var('page');
    } else {
        $paged = 1;
    }

    query_posts( array(
        'post_type' => 'case-study',
        'paged' => $paged,
        'posts_per_page' => 12,
        'post_status' => 'publish',
        'order' => 'ASC',
        'orderby' => 'menu_order'
    ));

    while (have_posts()) : the_post();

        if(!get_post_format()) {
            get_template_part('format', 'standard');
        } else {
            get_template_part('format', get_post_format());
        }

        $i++;

    endwhile;

    ?> 
```

# iis - ISAPI 扩展加载错误的 DLL

> ID：11512226
> 
> 赞同：0
> 
> 时间：2012-07-16T20:43:17.923
> 
> 标签：iis, httpmodule, isapi, dll, setdlldirectory

IIS 加载旧版 ISAPI 扩展和 IIS 模块，两者都使用同名的 DLL，但是这些 DLL 是不同的（链接到不同版本的第三方）。到目前为止应该没有问题，每个组件（扩展和模块）都驻留在自己的文件夹中，每个都有自己的 DLL 版本，但是当 IIS 启动工作进程并且扩展和模块以某种方式加载时，扩展会尝试加载来自模块文件夹的 DLL。我检查了模块的代码，发现使用 SetDllDirectory 会影响整个过程。瞧，这就是问题所在，我说。在摆脱了这个调用（用适合我需要的 DLL 搜索标志的 LoadLibraryEx 替换）之后，问题仍然存在。最后，我发现自己为这两个 DLL 赋予了唯一的名称，这显然（或没有）解决了问题。然而，它不是干净和优雅的解决方案。有谁知道为什么 IIS 表现出如此奇怪的行为？

运行 Win2008、IIS7.5、ISAPI 扩展 - 本机、C++、VC2010、IIS 模块 - 本机、C++、VS2010，上面有问题的 DLL - C++/CLI，与 .NET3.5 第三方程序集链接。一切都是 x64

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T07:53:05.083

“你不能在同一个进程中拥有两个同名的“经典”DLL，除非它们被设计为支持 SxS”它与这里所说的相关：[我们可以在一个中加载 2 个同名的 DLL过程](https://stackoverflow.com/questions/1341010/could-we-have-2-dlls-with-the-same-name-being-loaded-in-one-process)

EDIT001：5 年后:) 根本原因是 IIS 加载内容的方式。当工作进程启动时，无论如何都会加载 IIS 模块内容，然后是 ISAPI。因此，如果两者都使用相同的 DLL（例如，这两个具有共同的基础设施实现），IIS 模块将首先加载，ISAPI 将不得不使用模块加载的 DLL。因此，您最好为相同版本的 IIS 模块和 ISAPI 保留共享 DLL。

# markdown - 可以在代码片段周围放置框的降价翻译器

> ID：11512227
> 
> 赞同：0
> 
> 时间：2012-07-16T20:43:28.710
> 
> 标签：markdown

我想用markdown写博客文章。这些帖子将包括代码片段。我喜欢 github 呈现这些文件的方式。尤其是代码片段被框包围着，可以更好地将它们与文本的其余部分区分开来。我尝试了一些降价翻译器，但在其中任何一个中都找不到这样做的选项。他们是能够做到这一点的翻译吗？

谢谢内森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:55:35.513

Markdown 通常会生成 HTML 纯 HTML 作为输出。具体来说，一个 Markdown 代码块将被翻译成`<pre><code>…&lt;/code></pre>`标签。如果没有特定的样式，这些块将按照浏览器样式表中的定义显示。

要在一个框中显示这些标签，您可以使用 CSS 为它们设置样式（例如使用`border`）。

# python - NewRelic 代理运行时错误——日志看起来很干净

> ID：11512228
> 
> 赞同：1
> 
> 时间：2012-07-16T20:43:32.133
> 
> 标签：python, amazon-ec2, analytics, newrelic

我尝试使用我的服务器启动 NewRelic，我按照安装说明进行操作，但是，每当我运行验证时，网站都会返回以下响应：

```
Traceback (most recent call last): 
File "/usr/local/lib/python2.6/dist-packages/newrelic-1.3.0.289/newrelic/api/error_trace.py", line 69, in __call__ return self._nr_next_object(*args, **kwargs) 
File "/usr/local/lib/python2.6/dist-packages/newrelic-1.3.0.289/newrelic/api/function_trace.py", line 86, in __call__ return self._nr_next_object(*args, **kwargs) 
File "/usr/local/lib/python2.6/dist-packages/newrelic-1.3.0.289/newrelic/admin.py", line 165, in _function3 raise RuntimeError('error') 
RuntimeError: error 
```

我检查了日志，但是日志看起来很干净。我尝试安装几种不同的方式。我还尝试了基本配置和常规配置。服务器监控服务工作，但应用程序服务不工作。

来自 Newrelic 的 Stacktrace：http: [//imgur.com/a/cxDKk](http://imgur.com/a/cxDKk)

最新日志文件：http: [//pastebin.com/cwfaMcJv](http://pastebin.com/cwfaMcJv)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T05:59:09.533

配置验证的重点是测试连接并测试数据，包括示例事务跟踪和错误是否可以报告。所以它报告一些错误的事实是完全正常的。

# java - 如何在多台远程机器上运行 Jython 脚本？

> ID：11512229
> 
> 赞同：1
> 
> 时间：2012-07-16T20:43:33.613
> 
> 标签：java, python, shell, parallel-processing, jython

所以我有一些 shell 脚本可以提取和转换 .tar.gz 格式的某些数据。提取/转换获取大量数据并将其转换为可用于填充数据库的单个文件。因为这组数据非常大，我需要使用“GNU 并行”在多台机器上运行进程。这些脚本充当我的 Java 应用程序的包装脚本。

但是，我希望以更直接的方式将此过程与我的 Java 应用程序集成，以便进行更高级别的测试。我的第一个想法是用 Jython 替换 shell 脚本，并直接从 Jython 调用我的 Java 方法和应用程序。但是，我似乎找不到一个类似于 GNU 并行程序的程序，它允许我在多台机器上同时运行脚本。

有什么想法/想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:53:10.477

不确定这是否正是您所需要的，但看看 Jsch：[http ://www.jcraft.com/jsch/examples/](http://www.jcraft.com/jsch/examples/)

特别是 Exec.java 和 Shell.java 示例：

[http://www.jcraft.com/jsch/examples/Exec.java.html](http://www.jcraft.com/jsch/examples/Exec.java.html)

[http://www.jcraft.com/jsch/examples/Shell.java.html](http://www.jcraft.com/jsch/examples/Shell.java.html)

# javascript - ie不能设置属性

> ID：11512231
> 
> 赞同：0
> 
> 时间：2012-07-16T20:43:35.417
> 
> 标签：javascript, html, internet-explorer

我在获取脚本以将 onsubmit 属性添加到 IE 中的表单时遇到问题。不过它在 Chrome 中运行良好。

```
document.getElementsByName('form_name').item(0).setAttribute("onsubmit","add_to_form()"); 
```

它很好地抓住了元素，我可以很好`getAttribute`地打印出预先存在的属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:53:22.853

让我们重写一下：

```
function listen(event, elem, func) { // cross-browser event listener
  if (elem.addEventListener) elem.addEventListener(event, func, false);
  else if (elem.attachEvent) elem.attachEvent('on' + event, func); // IE
}

listen('load', window, function() {
  var form = document.getElementsByName('form_name')[0];
  listen('submit', form, add_to_form);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T21:06:14.430

您的文档可能将 IE 置于 Quirks 模式，因为在标准模式下，代码似乎可以正常工作。

要使代码也可以在 Quirks 模式下工作，您可以分配给 DOM 属性`onsubmit`而不是 HTML 属性。这两者在旧版本和 IE 的 Quirks Mode 中不一定相互对应。在您的示例中，请改用：

```
document.getElementsByName('form_name').item(0).onsubmit = add_to_form; 
```

# java - 包括来自外部 java 文件的面板？

> ID：11512232
> 
> 赞同：2
> 
> 时间：2012-07-16T20:43:34.847
> 
> 标签：java, swing, jpanel

是否可以将 jpanel 从另一个 java 文件包含到容器中？假设我有 2 个 java 文件`fileA.java`和`fileB.java`. 我想`fileB.java`在`fileA.java`. 这可能吗？只是一个混乱运行了很长时间。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:52:16.920

您可以制作其他文件/cass `extends JPanel`，然后由于它*是*JPanel，您可以将其添加到任何其他文件中。例如：

文件A.java

```
public class FileA {
    public FileA() { 
        JFrame jf = new JFrame();
        jf.setLayout(new BorderLayout());

        FileB b = new FileB();

        jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        jf.setBounds(100,100,800,600);
        jf.setVisible(true);

        add(b, BorderLayout.CENTER);
    }
    public static void main(String[] args) {
        new FileA();
    }
} 
```

文件B.java

```
public class FileB extends JPanel {
    public FileB() { 
        setLayout(new BorderLayout());
        add(new JLabel("Example"), BorderLayout.CENTER);
    }
} 
```

或者您可以简单地将 JPanel 作为另一个文件中的字段并使用 getter 方法访问它。

例子：

文件C.java

```
public class FileC {

    private JPanel panel;

    public FileC() {
        panel = new JPanel();
        panel.add(new JLabel("Example 2"));
    }

    public JPanel getPanel() {
        return panel;
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T20:48:00.103

是的你可以。

1-如果`fileB`class extends `JPanel`，则创建一个实例`fileB`并将其添加到您拥有的任何容器中：

```
fileB panel = new fileB();
container.add(panel); 
```

2-如果`fileB`有一个 JPanel 作为一个字段，那么如果它是公共字段，则您需要自行访问它，否则需要通过 getter 方法访问它：

```
fileB f = new fileB();
JPanel panel = f.getPanel(); // or f.panel if the panel is a public field
container.add(panel); 
```

# java - 如何使用使用默认值的方法生成 ObjectFactory 类？

> ID：11512233
> 
> 赞同：0
> 
> 时间：2012-07-16T20:43:41.003
> 
> 标签：java, cxf

我有一个使用默认值的 WSDL 文件，我想生成 ObjectFactory 类，这些类使用 CXF 创建具有这些默认值的方法。例如，我有一个这样定义的对象

```
 <xsd:complexType name="Smoker">
            <xsd:sequence>          
                    <xsd:element default="0" minOccurs="0" name="numCigarettesPerDay" nillable="false" type="xsd:integer"/>         
                    <xsd:element default="0" minOccurs="0" name="numYearsSmoking" nillable="false" type="xsd:integer"/>
            </xsd:sequence>
    </xsd:complexType> 
```

我想得到这样的方法

```
 public Smoker createSmoker() {
            Smoker smoker = new Smoker();
            smoker.setNumCigarettesPerDay(0);
            smoker.setNumYearsSmoking(0);
            return smoker;
    } 
```

而不是这个

```
 public Smoker createSmoker() {  
            return new Smoker();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T13:14:25.370

CXF XJC 默认值插件提供了 XJC 插件，用于更新生成的 bean 以返回模式中为实例中未设置的字段定义的默认值。

您可以通过以下链接找到有关您需要做什么的更多信息：

*   [http://cxf.apache.org/cxf-xjc-dv.html](http://cxf.apache.org/cxf-xjc-dv.html)
*   [http://java.net/projects/jaxb2-commons/pages/Default-Value](http://java.net/projects/jaxb2-commons/pages/Default-Value)

希望这可以帮助。

# c# - 获取 ASP.NET 中两个等待已久的并发进程的正确进度更新

> ID：11512235
> 
> 赞同：2
> 
> 时间：2012-07-16T20:44:09.373
> 
> 标签：c#, asp.net, ffmpeg

[我使用带有进度条指示的 .net ffmpeg 包装器http://www.mediasoftpro.com](http://www.mediasoftpro.com)实现了后台视频处理，以计算处理了多少视频并将信息发送到网页以更新进度条指示器。如果一次只有一个进程工作，它工作正常，但在两个并发进程的情况下（从两台不同的计算机同时开始两个视频发布），进度条突然混合进度状态。这是我的代码，我使用静态对象将单个实例的信息正确发送到进度条。

```
static string FileName = "grey_03";
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {
        if (Request.Params["file"] != null)
        {
            FileName = Request.Params["file"].ToString();
        }
    }
}
public static double ProgressValue = 0;
public static MediaHandler _mhandler = new MediaHandler();

[WebMethod]
public static string EncodeVideo()
{
    // MediaHandler _mhandler = new MediaHandler();
    string RootPath = HttpContext.Current.Server.MapPath(HttpContext.Current.Request.ApplicationPath);
    _mhandler.FFMPEGPath = HttpContext.Current.Server.MapPath("~\\ffmpeg_july_2012\\bin\\ffmpeg.exe");
    _mhandler.InputPath = RootPath + "\\contents\\original";
    _mhandler.OutputPath = RootPath + "\\contents\\mp4";
    _mhandler.BackgroundProcessing = true;
    _mhandler.FileName = "Grey.avi";
    _mhandler.OutputFileName =FileName;
    string presetpath = RootPath + "\\ffmpeg_july_2012\\presets\\libx264-ipod640.ffpreset";
    _mhandler.Parameters = " -b:a 192k -b:v 500k -fpre \"" + presetpath + "\"";
    _mhandler.OutputExtension = ".mp4";
    _mhandler.VCodec = "libx264";
    _mhandler.ACodec = "libvo_aacenc";
    _mhandler.Channel = 2;
    _mhandler.ProcessMedia();
    return _mhandler.vinfo.ErrorCode.ToString();
}

[WebMethod]
public static string GetProgressStatus()
{
    return Math.Round(_mhandler.vinfo.ProcessingCompleted, 2).ToString();
    // if vinfo.processingcomplete==100, then you can get complete information from vinfo object and store it in database and perform other processing.
} 
```

这是负责在每秒等之后更新进度条指示的 jquery 函数。

```
$(function () {
         $("#vprocess").on({
             click: function (e) {
                 ProcessEncoding();
                 var IntervalID = setInterval(function () {
                     GetProgressValue(IntervalID);
                 }, 1000);
                 return false;
             }
         }, '#btn_process');

     });
     function GetProgressValue(intervalid) {
         $.ajax({
             type: "POST",
             url: "concurrent_03.aspx/GetProgressStatus",
             data: "{}",
             contentType: "application/json; charset=utf-8",
             dataType: "json",
             success: function (msg) {
                 // Do something interesting here.
                 $("#pstats").text(msg.d);
                 $("#pbar_int_01").attr('style', 'width: ' + msg.d + '%;');
                 if (msg.d == "100") {
                     $('#pbar01').removeClass("progress-danger");
                     $('#pbar01').addClass("progress-success");
                     if (intervalid != 0) {
                         clearInterval(intervalid);
                     }
                     FetchInfo();
                 }
             }
         });
     } 
```

由于静态媒体处理程序对象而出现问题

```
public static MediaHandler _mhandler = new MediaHandler(); 
```

我需要一种方法来保持两个并发进程信息彼此分开，以便更新进度条，其值恰好属于该进程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T15:09:07.083

我想你在这里有一个误解。

因为您使用的是`static`变量，所以您会看到并发问题。这是因为在 ASP.NET 中，`static`所有请求都共享变量，因为它们是每个 AppDomain 一次，直到应用程序池回收。

您应该公开一个 WCF 端点，您可以使用它来询问您的服务是否已完成。该服务应该在队列中工作并为队列中的每个项目调用您的`ffmpeg`程序。您还没有提到有多少用户将调用您的页面，但这样设计可能会更好，这样您就可以更简单地控制服务器一次允许处理的项目数量。您也会遇到更少的问题，因为您是在服务上下文而不是 ASP.NET 下运行进程。

# php - PHP/xdebug profiler require_once 性能不佳

> ID：11512241
> 
> 赞同：3
> 
> 时间：2012-07-16T20:44:27.837
> 
> 标签：php, profiler, xdebug, require-once

我刚开始使用**xdebug**来分析我的应用程序，并立即注意到结果中有一些奇怪的地方。显示其中一项`require_once`功能需要大约 12% 的处理时间。在整个应用程序中还有很多其他调用`require_once`，它们都占用不到 1% 的处理时间。

表现不佳的`require_once`是包含一个与其他任何文件没有显着差异或更大的文件，所以我不确定是什么导致了问题。有没有其他人经历过这样的事情？

编辑：想提供更多信息。我正在使用 XAMPP 在 Windows 上进行分析。通常，该应用程序在 unix 机器上运行。我没有一种简单的方法可以将 xdebug 安装到盒子上，因此尝试以这种方式比较结果对我来说可能是不可行的。

最后一个编辑：这是一个代码的想法，以防万一（出于标准的 CYA 法律原因，故意含糊不清）：

此类是包含速度较慢的类（test.inc）：

```
require_once('/xx/yy/zz/dao/basedao.inc');
require_once('/xx/yy/zz/vo/test.inc');

class TestDAO extends BaseDAO {
  // bunch of code to handle database records and return VO objects 
```

这是包含的文件：

```
require_once('/xx/yy/zz/vo/basevo.inc');

class Test extends BaseVO {
  // bunch of properties, getters/setters, that kinda stuff 
```

我有很多其他的 VO/DAO 对象，它们以完全相同的方式构建，没有任何问题。所有都位于相同的各自路径内。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:54:26.130

这听起来确实很奇怪。绝对值得追求，尽管如果没有看到实际代码就很难确定它。单曲总节目时间的 12%`require_once()`听起来确实很多余。

但这里有一些关于可能的调查途径的想法：

1.  `require_once()`保留已包含文件的查找表，因此可能会减慢必须参考该查找表的速度。如果这是原因，您可以通过使用`require()`而不是`require_once()`尽可能地解决它。

2.  也许是路径查找？您是否包含带有文件名的路径？如果没有，它将在许多地方检查以查找文件；也许它不是它看起来的第一个地方，它需要更长的时间才能找到文件才能包含它。如果这是原因，您可以通过更具体地了解代码中的路径来解决它。

希望有帮助。很想听听这是怎么回事。

哦，顺便说一句——如果你的代码中最大的问题是`require_once()`，那么听起来你的代码做得很好！我梦想着这一天`require_once()`甚至出现在我的分析器报告中，更不用说产生重大影响了。

# ruby-on-rails - 如何在同一个控制器中以不同的方法使用对象？

> ID：11512242
> 
> 赞同：0
> 
> 时间：2012-07-16T20:44:28.310
> 
> 标签：ruby-on-rails, controller

我有一个具有不同方法的控制器。在第一种方法中，`authorize`我实例化了一个我想在另一个方法中重用的对象。问题是两种方法都有不同的视图，并且控制器实例不会保持不变。

她的是我的代码

```
def authorize
 @session ||= get_session
 puts @session
 @authorize_url = @session.get_authorize_url
end

def list
  puts self
  @session ||= get_session
  @client = DropboxClient.new(@session, ACCESS_TYPE)
  metadata = get_meta_data("/")
  @files = []
  metadata.each do |data|
   @files.push data
  end
  @files
end 
```

那么如何重用@session 变量呢？

最佳菲尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:48:12.743

你没有，真的。控制器中呈现视图的每个公共方法都意味着作为请求的端点。请求的生命周期到此结束。

要在请求之间保留数据，您应该使用会话。这可能会更令人困惑，因为您确实在尝试`@session`在请求之间保留一个调用的实例变量，但这就是它们的用途。

`session`Rails 通过控制器中可用的哈希公开会话数据。[Rails 文档](http://guides.rubyonrails.org/action_controller_overview.html#session)中提供了有关 Rails 如何处理会话的更多信息

```
class YourController < ApplicationController
    def authorize
        @session ||= get_session
        session[:dropbox_session] = @session
    end

    def list
        @client = DropboxClient.new(session[:dropbox_session], ACCESS_TYPE)
    end
end 
```

# python - SQLAlchemy 不在 MySQL [Debian Linux] 上创建外键

> ID：11512246
> 
> 赞同：3
> 
> 时间：2012-07-16T20:44:47.127
> 
> 标签：python, mysql, sqlalchemy, debian, constraints

对于相同的代码片段，SQLAlchemy 在 Mac OX 上创建外键约束，但是，它无法在 Debian Linux 上创建外键约束。

**环境与图书馆：**

蟒蛇 2.7

SQLAlchemy 0.7.8

MySQL-python-1.2.3 [这是连接器，我怀疑这里有问题]

**代码片段：**

```
class PRStatusCV(globalBase):

    __tablename__ = 'pr_status_cv'
    pr_status_cv_id = Column(Integer, primary_key=True)
    name            = Column(VARCHAR(100), nullable=False, unique=True)

    def __init__(self, id, name, desc):
        self.pr_status_cv_id = id
        self.name            = name
        self.description     = desc

class PhysicalRun(globalBase):

    __tablename__ = 'prs'
    pr_id       = Column(Integer, primary_key=True)
    run_name              = Column(VARCHAR(200), nullable=False, unique=True)
    pr_status_cv_id       = Column(Integer, ForeignKey('pr_status_cv.pr_status_cv_id'))

    def __init__(self, name, status):
        self.run_name              = name
        self.pr_status_cv_id       = status 
```

**在 Debian Linux 中，创建的表包含：**

```
CREATE TABLE `prs` (
  `pr_id` int(11) NOT NULL AUTO_INCREMENT,
  `run_name` varchar(200) NOT NULL,
  `pr_status_cv_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`pr_id`),
  UNIQUE KEY `run_name` (`run_name`),
  KEY `pr_status_cv_id` (`pr_status_cv_id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 | 
```

**在 Mac OSX 中，创建的表如下所示：**

```
CREATE TABLE `prs` (
  `pr_id` int(11) NOT NULL AUTO_INCREMENT,
  `run_name` varchar(200) NOT NULL,
  `pr_status_cv_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`pr_id`),
  UNIQUE KEY `run_name` (`run_name`),
  KEY `pr_status_cv_id` (`pr_status_cv_id`),
  CONSTRAINT `prs_ibfk_1` FOREIGN KEY (`pr_status_cv_id`) REFERENCES `pr_status_cv` (`pr_status_cv_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 
```

观察：Mac OSX SQLAlchemy 似乎默认选择了 InnoDB DB Engine，而 Debian 选择了 MyISAM。知道为什么会这样吗？

我需要进行哪些修改才能有约束 -`CONSTRAINT `prs_ibfk_1` FOREIGN KEY (`pr_status_cv_id`) REFERENCES `pr_status_cv``而不仅仅是`KEY `pr_status_cv_id` (`pr_status_cv_id`)`？

我的 Debian Python 部署有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:48:28.483

`ENGINE=MyISAM`MyISAM 没有外键

添加`__table_args__ = {'mysql_engine':'InnoDB'}`以安装 InnoDB

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:00:09.380

[`default-storage-enginge`](http://dev.mysql.com/doc/refman/5.1/en/server-options.html#option_mysqld_default-storage-engine)很可能在两个系统中设置不同。另请查看[选项文件](http://dev.mysql.com/doc/refman/5.1/en/option-files.html)以了解如何配置此选项。理想情况下，您不应该将其保留为默认值；使用`mysql_engine`选项在`Table()`mysql 连接上强制它。

# javascript - 当图像的src发生变化时如何重新绑定$(image).load()？

> ID：11512254
> 
> 赞同：1
> 
> 时间：2012-07-16T20:45:08.110
> 
> 标签：javascript, jquery, image

请注意`.load()`以下代码中的事件。

```
var img; 
var path = "/theimage.jpg";

$(document).ready(function () {

    img = new Image;

    img.src = path;

    $(img).load(function () {
        redraw(0);
        zoom(-2, 1.7, false);
    });
}); 
```

图像加载时成功触发此事件...

但是，如果在页面生命周期的后期（例如当用户单击链接时）我将of更改为全新的路径（新图像），我如何让该`.load()`事件*再次触发？*`src``img`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:55:53.510

结合duri和Roko所说的话。

如果您`.src`在初始加载之后设置，加载事件会触发。[http://jsfiddle.net/2wWDN/](http://jsfiddle.net/2wWDN/)

如果图像被缓存，事件仍然会再次触发，至少在我上面创建的 jsfiddle 中是这样的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:48:29.800

加载整个新图像后，该`load`事件将再次自行触发。

# ios - Avaudioplayer 如何停止从其他控制器播放对象

> ID：11512259
> 
> 赞同：1
> 
> 时间：2012-07-16T20:45:36.863
> 
> 标签：ios, avaudioplayer

我有`firstViewController`和`SecondViewController`。在两个控制器中，我都可以点击播放按钮，旋律就会播放。因此，当我点击 1 个控制器中的播放按钮，然后转到 2 个控制器并点击其他播放按钮时，2 个旋律将一起播放。所以我的问题是当我点击第二个控制器中的播放按钮时，如何从第一个控制器中停止第一个旋律。谢谢！

在第一个ViewController`viewdidload`

```
NSString *soundPath = [[NSBundle mainBundle] pathForResource:@"first" ofType:@"wav"];
NSURL *soundURL_ = [NSURL fileURLWithPath:soundPath];
AVAudioPlayer *first = [[AVAudioPlayer alloc] initWithContentsOfURL:soundURL_ error:nil];
[first prepareToPlay]; 
```

相同`secondViewcontroller`但第二而不是第一

当我按下按钮时：

```
[first play] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:19:37.830

您可以创建一个包含 AVAudioPlayer 和与播放器关联的方法的自定义对象的实例化，然后在两个视图中为该对象创建一个指针。

如果您想从 AppDelegate 中实例化您的 AVAudioPlayer，您必须首先设置您的 AVAudioPlayer 并将其分配给您的 AppDelegate 的一个属性。

在 View Controller 中，访问 App Delegate 的任何属性都很容易，只需编写：

```
AppNameAppDelegate *ad = (AppNameAppDelegate *)[[UIApplication sharedApplication] delegate]; 
```

其次是：

```
localAVAudioPlayerInstance = ad.audioPlayer; 
```

如果您需要更详细的说明，请告诉我。

# asp.net-mvc - 在 ASP.NET MVC 3 中创建基于平台显示不同视图的自定义 ViewResult

> ID：11512260
> 
> 赞同：2
> 
> 时间：2012-07-16T20:45:43.373
> 
> 标签：asp.net-mvc

我正在尝试让我的 Action 针对不同的平台返回不同的视图，同时尊重路由配置。如果我创建自定义 ViewResult，我会覆盖 FindView 方法吗？如果是这样，我该如何修改自动找到的视图？

例如：HomeController.About 动作将在计算机上显示 View\Home\About.cshtml，在平板电脑上显示 View\Home\AboutTablet.cshtml，在手机上显示 View\Home\AboutMobile.cshtml

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T06:56:06.187

有一个 NuGet 适合您：[MobileViewEngines](http://nuget.org/packages/MobileViewEngines)。ScottHa 在一篇[博](http://www.hanselman.com/blog/NuGetPackageOfTheWeek10NewMobileViewEnginesForASPNETMVC3SpeccompatibleWithASPNETMVC4.aspx)文中介绍了它。它的规范与 ASP.NET MVC 4 兼容，您可以轻松摆脱它，因为此功能是内置的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-29T14:03:18.260

你可以像这样定义一个 Actionfilter：

```
public class SetDeviceDependantView : ActionFilterAttribute
{
    public override void OnResultExecuting(ResultExecutingContext filterContext)
    {
        // Only works on ViewResults...
        ViewResultBase viewResult = filterContext.Result as ViewResultBase;
        if (viewResult != null)
        {
            if (filterContext == null)
                throw new ArgumentNullException("context");

            // Default the viewname to the action name
            if (String.IsNullOrEmpty(viewResult.ViewName))
                viewResult.ViewName = filterContext.RouteData.GetRequiredString("action");

            // Add suffix according to device type
            if (IsTablet(filterContext.HttpContext))
                viewResult.ViewName += "Tablet";
            else if (IsMobile(filterContext.HttpContext))
                viewResult.ViewName += "Mobile";
        }
        base.OnResultExecuting(filterContext);
    }

    private static bool IsMobile(HttpContextBase httpContext)
    {
        return httpContext.Request.Browser.IsMobileDevice;
    }

    private static bool IsTablet(HttpContextBase httpContext)
    {
        // this requires the 51degrees "Device Data" package: http://51degrees.mobi/Products/DeviceData/PropertyDictionary.aspx
        var isTablet = httpContext.Request.Browser["IsTablet"];
        return isTablet != null && isTablet.Equals(bool.TrueString, StringComparison.OrdinalIgnoreCase);
    }
} 
```

然后您可以像这样注释所需的操作/控制器：

```
[SetDeviceDependantView]
public ActionResult About()
{
    return View();
} 
```

或者在 global.asax 中全局设置：

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    filters.Add(new HandleErrorAttribute());
    filters.Add(new SetDeviceDependantView());
} 
```

请注意，我在这里依靠 51degrees 库来检测平板电脑，您可以考虑使用不同的技术。然而，这是一个不同的话题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:59:54.043

如果您想在 MVC4 之前执行此操作，请查看 Christopher Bennage 的这篇博文

[http://dev.bennage.com/blog/2012/04/27/render-action/](http://dev.bennage.com/blog/2012/04/27/render-action/)

我对 ContentTypeAwareResult 类特别感兴趣，它看起来可能就是您正在寻找的。

[https://github.com/liike/reference-application/blob/master/MileageStats.Web/ContentTypeAwareResult.cs](https://github.com/liike/reference-application/blob/master/MileageStats.Web/ContentTypeAwareResult.cs)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T15:09:52.827

您必须创建自己的`ViewEngine`（可能是从您正在使用的那个派生的）并覆盖`FindView`and `FindPartialView`。您可以提供备用方案（即，如果没有找到平板电脑，则使用通用视图）。

最麻烦的是定义区分不同“模式”的标准。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T06:51:05.633

构建自定义 ViewEngine 是 MVC3 中满足此要求的首选方法。供您参考 - MVC4 开箱即用地支持此功能。

有关设备特定视图的更多信息，在 StackOverflow 上发布了类似的答案[https://stackoverflow.com/a/1387555/125651](https://stackoverflow.com/a/1387555/125651)

# php - 在 jQuery Mobile 和 PHP 中处理会话

> ID：11512261
> 
> 赞同：1
> 
> 时间：2012-07-16T20:45:44.590
> 
> 标签：php, jquery, session, mobile

我正在编写一个带有 PHP Web 服务的 JQM Web 应用程序。用户将能够登录并注册他们从俱乐部购买了例如苏打水。此信息将存储在数据库中并最终计费。

为了说明我想要做什么：我已经将它实现为一个 Android 应用程序。我在 Android 应用程序中的“会话处理”包括在成功通过服务器身份验证后将用户的凭据存储在 Android 的 savedPeferences（持久本地存储）中。然后，这些凭据会随每个后续服务器请求重新发送，以便用户只需登录一次 - 在第一次运行应用程序时。

我想在我的 JQM 应用程序中尽可能地模仿这种行为。理想情况下，用户应该只需要登录一次，除非他们选择注销。

在网站编程方面我有点生疏，那么最好的方法是什么？不会过期的菜？我是使用 PHP 会话还是使用 javascript 处理所有内容？

这是一个爱好项目；我更喜欢简单的解决方案，而不是过于安全和复杂的解决方案。谢谢！

编辑：阅读迈克的回答后，我偶然发现了这个插件：[https](https://github.com/carhartl/jquery-cookie) ://github.com/carhartl/jquery-cookie 也许这是让用户保持登录状态的最简单方法......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:53:32.370

PHP 会话将在一定时间后失效（取决于您的 php.ini 设置或对设置的任何运行时修改）。

您可以使用长时间过期的 cookie 来保持登录（通常在登录时为用户提供复选框以允许存储其登录凭据）。

由于您正在为移动设备进行开发，因此您也可以选择使用 HTML5 本地存储，因为大多数 Android 浏览器都支持它。在下面的链接中查看更多信息。

[HTML5 本地存储信息](http://www.w3schools.com/html5/html5_webstorage.asp)

我更喜欢这个，因为即使用户清除了他们的浏览器 cookie，登录哈希也可以保留，并且可以在 Javascript 中严格处理。

# annotations - Symfony/Doctrine：“可捕获的致命错误：类对象 持久化时无法转换为字符串”

> ID：11512262
> 
> 赞同：0
> 
> 时间：2012-07-16T20:45:45.080
> 
> 标签：annotations, doctrine-orm, symfony-2.1

一个 symfony2 应用程序有一个`Job`实体，该实体具有 type 的属性`WebSite`。

没有其他属性或方法的简化表示：

```
/**
 * @ORM\Entity
 * @ORM\Table(name="Job")
 */
class Job
{
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @ORM\Column(type="integer", name="website_id", nullable=false)
     * @ORM\ManyToOne(targetEntity="Example\ExampleBundle\Entity\WebSite")
     */
    protected $website;
} 
```

Symfony/Doctrine 在持久化时尝试将`website`属性转换为字符串，从而导致错误：

> 可捕获的致命错误：无法将类 Example\ExampleBundle\Entity\WebSite 的对象转换为 /vendor/doctrine/dbal/lib/Doctrine/DBAL/Statement.php 第 131 行中的字符串

我相信上面的 @ORM\Column 注释表示该`website`属性是一个整数。我不明白为什么 Symfony/Doctrine 希望尝试将`website`属性转换为字符串。

我尝试解决此问题的非理想解决方法：

*   向 中添加`__toString()`方法`WebSite`，返回属性的字符串表示`id`，导致正确的值最终出现在`Job.website_id`数据字段中；这种解决方法是不切实际的，因为我将来需要`__toString()`在应用程序的其他地方显示字符串。

*   从属性中删除`@ORM\Column`注释；`website`这将导致所有未来由差异生成的迁移（php app/console dictionary:migrations:diff）删除相关数据库字段的“非空”方面。

我应该对上述注释进行任何更改以通知 Symfony/Doctrine 调用`getId()`方法`WebSite`以获取持久化时所需的内容吗？我可以做些什么改变`WebSite`来达到同样的效果吗？

需要进行哪些更改才能确保上述注释可以保留在原地，以便 Doctrine`WebSite.getId()`在持久化时最终调用以获取所需的内容，而不是尝试将对象强制转换为字符串？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T22:12:31.303

您必须从属性中删除`@ORM\Column(type="integer"`注释。`$website`

为确保 website_id 列保持`NOT NULL`约束，请在其中添加`JoinColumn`注释`nullable=false`：

```
/**
 * @var Example\ExampleBundle\Entity\WebSite
 * 
 * @ORM\ManyToOne(targetEntity="Example\ExampleBundle\Entity\WebSite")
 * @ORM\JoinColumn(name="website_id", referencedColumnName="id", nullable=false)
 */
protected $website; 
```

# regex - 在 perl 正则表达式中删除字符串的顽固第一个空格

> ID：11512264
> 
> 赞同：2
> 
> 时间：2012-07-16T20:45:56.750
> 
> 标签：regex, perl, whitespace, space

好的，我正在尝试使用正则表达式从字符串的开头删除一个非常顽固的空格。使用 Text:CSV 模块将此字符串从 CSV 文件解析为 Perl，当我打印字符串的 Dumper 时，我得到：

```
$VAR1 = ' Mgmt-General-Other'; 
```

现在我尝试使用正则表达式删除这个空间，有人会告诉我使用：

```
$string =~ s/\s+$//; 
```

我已经尝试过这个以及：

```
$string =~ s/\s//g; 
```

和

```
$string =~ s/^\s//g; 
```

这些都不起作用，中间的一个把所有的空间都拉出来了，除了我想要的那个。我正在尝试遍历一个 2,000 行的 CSV 文件，所以我宁愿让它自动化，而不必为这个奇怪的实例做一个特殊情况。

有没有办法让这个字符开头的不是空格或空格？或者怎么取出来？

添加更多我尝试过的东西；

```
$string =~ s/^\s+//; 
```

这是我的代码：

```
my @value = @columns[1..12];
my $string = @value[9];
$string =~ s/^\s+//;
$string =~ s/\s+$//;
print Dumper $string; 
```

如果重要的话，这些是我在脚本顶部的声明：

```
use strict;
use DBI;
use Getopt::Long;
use Spreadsheet::WriteExcel;
use Spreadsheet::WriteExcel::Utility;
use Data::Dumper;
use Text::CSV; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T20:47:38.123

实际上，您非常接近，因为在字符串*开头*替换空格的正确正则表达式是：

```
$sting =~ s/^\s+//; 
```

至于其他解决方案：

```
$sting =~ s/\s+$//; # the same as 'rtrim', removes whitespace at the end of the string
$sting =~ s/\s//g;  # will just remove all whitespace
$sting =~ s/^\s//g; # will remove single whitespace symbol right at the beginning of the string. 
```

更新：原来你的字符串中有一个`\xA0`（所谓的“不可破坏的空格”，不包含在 中`\s`）。） 尝试这个：

```
$sting =~ s/^[\s\xA0]+//; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T23:30:26.417

这是一个例子，说明**不再有“只是一个字符串”这样的东西**。

最简单的解决方案是确保您在`unicode_strings`正则表达式中使用语义。您可以通过以下几种方法之一来实现。同样，为了简单起见，您可以在脚本开头将其打开：

```
use utf8;
use feature qw( unicode_strings );
binmode STDOUT, ':utf8';

my $string
    = join '', map { chr } ( 160,  77, 103, 109, 116,  45,
                              71, 101, 110, 101, 114,  97,
                             108,  45,  79, 116, 104, 101,
                             114 );

print $string, "\n";

$string =~ s/^\s+//;

print $string, "\n"; 
```

`unicode_strings`另一种选择是只为处理 Unicode 字符串的特定正则表达式打开语义：

```
use utf8;
binmode STDOUT, ':utf8';

my $string
    = join '', map { chr } ( 160,  77, 103, 109, 116,  45,
                              71, 101, 110, 101, 114,  97,
                             108,  45,  79, 116, 104, 101,
                             114 );

print $string, "\n";

$string =~ s/^\s+//u;

print $string, "\n"; 
```

另一种方法是明确指定包含各种空格字符的 Unicode 属性，包括通常在以下位置找到的那些`\s`：

```
s/^\p{Space}//; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T23:37:46.843

我发布这个是因为我没有看到一个*通用*的解决方案。这是你需要做的。

```
say ord( $string ); # prints out the numeric value of the character.

# In your case it would print out: 160

# OR

say sprintf( '\x{%x}', ord( $string )); # prints out \x{00} in hex

# In your case: \x{a0} 
```

并将其剪切并粘贴到您的替换中：

```
$string =~ s/^[\s\x{00}]//; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T20:50:14.987

要删除前导空格，请尝试：`$string =~ s/^\s+//;`

这应该删除前导标签：`$string =~ s/^\t+//;`

# javascript - 如何通过只是对它们的引用的变量为对象赋值？

> ID：11512273
> 
> 赞同：2
> 
> 时间：2012-07-16T20:46:39.520
> 
> 标签：javascript, arrays, oop, object, methods

我无法真正含糊地表达这个问题，但我想你会明白......

我正在用 Javascript 开发一个游戏引擎，该`Scene`对象是许多东西的容器，它有一个方法应该改变其中的一个数组，特别是一个包含所有可以绘制的东西的数组。

该数组的访问方式如下：

`scene.internals.draw`

问题是，它在方法中被多次引用，我认为名称/路径可能会改变。自然，我不想每次更改数组的路径时都更改方法中对它的每个引用，所以我这样做了：

`var location = scene.internals.draw;`

现在，实际的方法代码和算法可以保持不变，如果场景中数组的名称/路径发生变化，我只需要更改那一行。

它在大多数情况下运行良好。我可以`.push(obj)`这样做，等等，但是在某一时刻，我需要“剖析”数组，即将它分成两半，添加一些东西，然后将其放回原处，如下所示：

```
buff1 = location.slice(0, i); //First slice of the array.
buff2 = location.slice(i, location.length); //Second slice of the array.

//Add something in between those slices.
buff1.push(ob);
location = buff1.concat(buff2); //Problems here! 
```

这在`location`just时效果很好`scene.internals.draw`，因为它直接更改了数组。但是现在，我将新值分配给局部`location`变量，而不是所需的值`scene.internals.draw`！

问题：**如何使用 = 运算符将值分配给“真实”对象，而不是包含对这些对象的引用的变量（如`location`）？**

显而易见的解决方案是，在方法结束时：

`scene.internals.draw = location.slice();`

没关系，唯一的副作用是我将不得不写两次原始名称，并编辑两次，这不是什么大问题。但是，我可能会发现自己处于其他可能需要该功能的情况，所以我仍然想要一个答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:03:14.043

javascript 中没有引用赋值，所以你不能这样做。您所做的通常被误认为是通过引用分配，但实际上它是具有类似含义的引用值的副本。

自从你这样做以来，你可能在某个地方遇到了更深层次的问题，但我不想进入那个。

你可以这样做：

```
location.splice( 0, location.length ); //Remove all items in the array
location.push.apply( location, buff1.concat(buff2) ); //Push the buffers into the array 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T21:06:12.990

用你的术语来说，Javascript 中没有“真正的”对象——只有对象和持有对它们的*引用*的变量。

当您分配给`location`您时，您只是在创建对对象的*附加*引用。系统不知道它是哪个“真实”对象，也不知道可能持有对它的引用的任何其他变量。

因此，当您*重新分配*给`location`您时，您只是覆盖了该特定参考。对该对象的任何其他原始引用将保持指向它们所在的位置。

# java - 下面的 java 正则表达式是什么？

> ID：11512274
> 
> 赞同：-2
> 
> 时间：2012-07-16T20:46:46.027
> 
> 标签：java, regex

我有一个字符串，它可以包含 abc+123def 或 abc-123def 或仅 abc123def 之类的字符。只提取数字和符号的正则表达式是什么？例如 +123 或 -123 或 123 ...？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:48:55.363

这是我认为您正在寻找的正则表达式。

```
"[-\+]?\d+" 
```

小心，您可能必须转义`'`密钥

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:59:36.413

```
([+-]?[0-9]+) 
```

`[+-]?`说给我零个或一个符号
`[0-9]+`给我至少1个数字

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:49:44.177

如果数字总是紧跟在符​​号后面：`[+-]?\d+`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T20:50:08.530

使用这个正则表达式`[+-]?\d+`

# iphone - 如何在 iOS 上的 UIBezierPath 中编辑点？

> ID：11512275
> 
> 赞同：3
> 
> 时间：2012-07-16T20:46:48.453
> 
> 标签：iphone, ios, quartz-graphics, uibezierpath

我正在构建一个绘图应用程序（类似于[MiniDraw](http://itunes.apple.com/us/app/minidraw-lite-vector-graphics/id355567916?mt=8)）。 [UIBezierPath](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIBezierPath_class/Reference/Reference.html)类很酷，我可以完成动态路径构建：

```
[path addCurve:23.0 controlPoint:5.5]; //etc... 
```

当我完成后，我希望能够在不创建新 UIBezierPath 的情况下更改该路径中的点，这样我就可以完成路径的动态编辑。

例如，[FabricJS](http://fabricjs.com/) javascript 库可以通过每个路径对象包含如下数组结构的方式来执行此操作：

```
[['M', 20, 20], ['L', 40, 40], ['Q', 70, 50, 30], ['Z']] //etc... 
```

这样我可以编辑每个点，但在 UIBezierPath 类中看不到任何类似的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:11:11.543

`UIBezierPath`不允许您更改已添加到路径的点。您将不得不创建一条新路径。

# c++ - 有没有办法将精神::lex 字符串标记的内容匹配为精神::qi 语法中的文字

> ID：11512282
> 
> 赞同：3
> 
> 时间：2012-07-16T20:47:24.677
> 
> 标签：c++, dsl, boost-spirit, boost-spirit-qi, boost-spirit-lex

我正在编写 DSL 并使用 Boost Spirit 词法分析器来标记我的输入。在我的语法中，我想要一个类似的规则（`tok`词法分析器在哪里）：

```
header_block =
    tok.name >> ':' >> tok.stringval > ';' >>
    tok.description >> ':' >> tok.stringval > ';'
  ; 
```

我不想为语言指定保留字（例如“名称”、“描述”）并处理在词法分析器和语法之间同步这些，我只想将匹配的所有内容标记`[a-zA-Z_]\w*`为单个标记类型（例如`tok.symbol`），并让语法梳理出来。如果我*不*使用词法分析器，我可能会这样做：

```
stringval = lexeme['"' >> *(char_ - '"') >> '"'];
header_block =
    lit("name") >> ':' >> stringval > ';' >>
    lit("description") >> ':' >> stringval > ';'
  ; 
```

使用混合词法分析器，我可以编译以下规则，但当然它匹配的比我想要的要多——它不关心特定的符号值“名称”和“描述”：

```
header_block =
    tok.symbol >> ':' >> tok.stringval > ';' >>
    tok.symbol >> ':' >> tok.stringval > ';'
  ; 
```

我正在寻找的是这样的：

```
header_block =
    specific_symbol_matcher("name") >> ':' >> tok.stringval > ';' >>
    specific_symbol_matcher("description") >> ':' >> tok.stringval > ';'
  ; 
```

Qi 是否提供任何我可以使用的东西来代替我`specific_symbol_matcher`的挥手，那里？如果我可以使用提供的东西接近，我宁愿不编写自己的匹配器。如果我必须编写自己的匹配器，任何人都可以建议如何做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T00:11:01.443

如果令牌暴露了一个 std::string，你应该能够做到：

```
 statement =
      ( tok.keyword [ qi::_pass = (_1 == "if")   ] >> if_stmt )
    | ( tok.keyword [ qi::_pass = (_1 == "while) ] >> while_stmt ); 
```

如果我理解你的话，这或多或少就是你要问的。

当您使用它时，请查看它[`qi::symbol<>`](http://www.boost.org/doc/libs/1_50_0/libs/spirit/doc/html/spirit/qi/reference/string/symbols.html)的一个特别漂亮的应用程序，称为[Nabialek Trick](http://boost-spirit.com/home/articles/qi-example/nabialek-trick/)。

* * *

### 奖金材料

如果您只是在努力使现有语法与词法分析器一起工作，这就是我刚刚对[`calc_utree_ast.cpp`](http://www.boost.org/doc/libs/1_50_0/libs/spirit/example/qi/calc_utree_ast.cpp)示例所做的以使其与词法分析器一起工作。

表明

*   如何直接使用暴露的属性
*   只要将这些字符文字注册为（匿名）标记，您如何仍然可以基于字符文字进行解析
*   （简单的）表达式 gammar 如何最小地改变
*   跳过行为是如何移动到词法分析器中的

```
///////////////////////////////////////////////////////////////////////////////
//
//  Plain calculator example demonstrating the grammar. The parser is a
//  syntax checker only and does not do any semantic evaluation.
//
//  [ JDG May 10, 2002 ]        spirit1
//  [ JDG March 4, 2007 ]       spirit2
//  [ HK November 30, 2010 ]    spirit2/utree
//  [ SH July 17, 2012 ]        use a lexer
//
///////////////////////////////////////////////////////////////////////////////

#define BOOST_SPIRIT_DEBUG

#include <boost/config/warning_disable.hpp>
#include <boost/spirit/include/lex_lexertl.hpp>
#include <boost/spirit/include/support_utree.hpp>
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix_operator.hpp>
#include <boost/spirit/include/phoenix_function.hpp>

#include <iostream>
#include <string>

namespace lex    = boost::spirit::lex;
namespace qi     = boost::spirit::qi;
namespace spirit = boost::spirit;
namespace phx    = boost::phoenix;

// base iterator type
typedef std::string::const_iterator BaseIteratorT;

// token type
typedef lex::lexertl::token<BaseIteratorT, boost::mpl::vector<char, uint32_t> > TokenT;

// lexer type
typedef lex::lexertl::actor_lexer<TokenT> LexerT;

template <typename LexerT_>
struct Tokens: public lex::lexer<LexerT_> {
   Tokens() {
      // literals
      uint_ = "[0-9]+";
      space = " \t\r\n";

      // literal rules
      this->self += uint_;
      this->self += '+';
      this->self += '-';
      this->self += '*';
      this->self += '/';
      this->self += '(';
      this->self += ')';

      using lex::_pass;
      using lex::pass_flags;
      this->self += space [ _pass = pass_flags::pass_ignore ];
   }

   lex::token_def<uint32_t> uint_;
   lex::token_def<lex::omit> space;
};

namespace client
{
    namespace qi     = boost::spirit::qi;
    namespace ascii  = boost::spirit::ascii;
    namespace spirit = boost::spirit;

    struct expr
    {
        template <typename T1, typename T2 = void>
        struct result { typedef void type; };

        expr(char op) : op(op) {}

        void operator()(spirit::utree& expr, spirit::utree const& rhs) const
        {
            spirit::utree lhs;
            lhs.swap(expr);
            expr.push_back(spirit::utf8_symbol_range_type(&op, &op+1));
            expr.push_back(lhs);
            expr.push_back(rhs);
        }

        char const op;
    };
    boost::phoenix::function<expr> const plus   = expr('+');
    boost::phoenix::function<expr> const minus  = expr('-');
    boost::phoenix::function<expr> const times  = expr('*');
    boost::phoenix::function<expr> const divide = expr('/');

    struct negate_expr
    {
        template <typename T1, typename T2 = void>
        struct result { typedef void type; };

        void operator()(spirit::utree& expr, spirit::utree const& rhs) const
        {
            char const op = '-';
            expr.clear();
            expr.push_back(spirit::utf8_symbol_range_type(&op, &op+1));
            expr.push_back(rhs);
        }
    };
    boost::phoenix::function<negate_expr> neg;

    ///////////////////////////////////////////////////////////////////////////////
    //  Our calculator grammar
    ///////////////////////////////////////////////////////////////////////////////
    template <typename Iterator>
    struct calculator : qi::grammar<Iterator, spirit::utree()>
    {
        template <typename Tokens>
        calculator(Tokens const& toks) : calculator::base_type(expression)
        {
            using qi::_val;
            using qi::_1;

            expression =
                term                            [_val = _1]
                >> *(   ('+' >> term            [plus(_val, _1)])
                    |   ('-' >> term            [minus(_val, _1)])
                    )
                ;

            term =
                factor                          [_val = _1]
                >> *(   ('*' >> factor          [times(_val, _1)])
                    |   ('/' >> factor          [divide(_val, _1)])
                    )
                ;

            factor =
                    toks.uint_                  [_val = _1]
                |   '(' >> expression           [_val = _1] >> ')'
                |   ('-' >> factor              [neg(_val, _1)])
                |   ('+' >> factor              [_val = _1])
                ;

            BOOST_SPIRIT_DEBUG_NODE(expression);
            BOOST_SPIRIT_DEBUG_NODE(term);
            BOOST_SPIRIT_DEBUG_NODE(factor);
        }

        qi::rule<Iterator, spirit::utree()> expression, term, factor;
    };
}

///////////////////////////////////////////////////////////////////////////////
//  Main program
///////////////////////////////////////////////////////////////////////////////
int main()
{
    std::cout << "/////////////////////////////////////////////////////////\n\n";
    std::cout << "Expression parser...\n\n";
    std::cout << "/////////////////////////////////////////////////////////\n\n";
    std::cout << "Type an expression...or [q or Q] to quit\n\n";

    using boost::spirit::utree;
    typedef std::string::const_iterator iterator_type;
    typedef Tokens<LexerT>::iterator_type IteratorT;
    typedef client::calculator<IteratorT> calculator;

    Tokens<LexerT> l;
    calculator calc(l); // Our grammar

    std::string str;
    while (std::getline(std::cin, str))
    {
        if (str.empty() || str[0] == 'q' || str[0] == 'Q')
            break;

        std::string::const_iterator iter = str.begin();
        std::string::const_iterator end  = str.end();
        utree ut;
        bool r = lex::tokenize_and_parse(iter, end, l, calc, ut);

        if (r && iter == end)
        {
            std::cout << "-------------------------\n";
            std::cout << "Parsing succeeded: " << ut << "\n";
            std::cout << "-------------------------\n";
        }
        else
        {
            std::string rest(iter, end);
            std::cout << "-------------------------\n";
            std::cout << "Parsing failed\n";
            std::cout << "stopped at: \"" << rest << "\"\n";
            std::cout << "-------------------------\n";
        }
    }

    std::cout << "Bye... :-) \n\n";
    return 0;
} 
```

对于输入

```
8*12312*(4+5) 
```

它打印（没有调试信息）

```
Parsing succeeded: ( * ( * 8 12312 ) ( + 4 5 ) ) 
```

# c++ - 是否有一个很好的 C++ 内存管理教程，涵盖 shared_ptr、scoped_ptr 和 weak_ptr？

> ID：11512285
> 
> 赞同：3
> 
> 时间：2012-07-16T20:47:41.890
> 
> 标签：c++, memory-management, shared-ptr, weak-ptr

> **可能重复：**
> [我什么时候使用哪种指针？](https://stackoverflow.com/questions/8706192/which-kind-of-pointer-do-i-use-when)

我是一名前 C++ 程序员，后来转为 .NET 程序员。我对 C++ 内存管理的了解可以追溯到 2000 年代初期，而且我还没有跟上 C++11 的特性。我被要求用 C++ 做一个新项目，我希望找到一个关于使用 shared_ptr、weak_ptr 和 scoped_ptr 进行现代 C++ 内存管理的好教程。涵盖常见模式和最佳实践的东西将是理想的。你对我有什么指示吗？

# javascript - Javascript 错误 - 对象没有方法

> ID：11512286
> 
> 赞同：1
> 
> 时间：2012-07-16T20:47:44.660
> 
> 标签：javascript, jquery, object

我缩短了以下脚本：

```
var HTH = HTH || {};

(function() {
    var assetGrouping = function() {
        var self = this;

        this.options = {
            _tmpElement:        '',
            QuantityAssigned:   0,
            qtyInputField:      ''
        };

        this.init = function(options){
            // ...
            this.options.QuantityAssigned = 0;
            jQuery(this.options.qtyInputField).bind('keyup', function(){
                self._tmpElement = jQuery(this);
                self.CalculateQuantityAssigned();
            });

            // ...
        }

        CalculateQuantityAssigned = function(){
            // ...
        }
    }

    HTH.assetGrouping = new assetGrouping();
})();

$(document).ready(function(){
    HTH.assetGrouping.init({
        qtyInputField: 'input[name^="at700_group_qty"]'
    });
}); 
```

错误发生在以下行：`self.CalculateQuantityAssigned();`并且错误是`Uncaught TypeError: Object [object Object] has no method 'CalculateQuantityAssigned'`。

我不明白。使用`this`当然会失败，并且`self`当我想访问`self.options`但不用于`self.CalculateQuantityAssigned()`.

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T20:49:47.130

改变：

```
CalculateQuantityAssigned = function(){
            // ...
} 
```

至

```
this.CalculateQuantityAssigned = function(){
            // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:57:13.820

```
(function () {
});  <-- You have a function, but you never execute it! 
```

您需要添加`();`

# zxing - Zxing - 生成自定义彩色二维码

> ID：11512287
> 
> 赞同：1
> 
> 时间：2012-07-16T20:47:48.497
> 
> 标签：zxing

我正在使用 zxing javase 客户端库和 zxing 核心库从 java 应用程序中的 URL 生成 QR 码。我需要生成自定义彩色二维码并查看 javadocs，使用 MatrixToImageConfig 和 MatrixToImageWriter（都在 javase 包中）似乎是一个理想的解决方案。但是，我在下载页面上找到的最新版本的 zxing(2.0) 没有任何名为 MatrixToImageConfig 的类。

该文件存在于我从 subversion 下载的最新代码中。这个功能已经发布了吗？如果没有，是否有其他方法可以使用 zxing 实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:00:03.487

是的，它是在 2.0 之后添加的。它在颠覆中；您可以只使用来自 Subversion 的代码/JAR 或在 Maven 中使用 2.1-SNAPSHOT。

# javascript - setTimeout 不执行传递的函数

> ID：11512290
> 
> 赞同：0
> 
> 时间：2012-07-16T20:47:50.467
> 
> 标签：javascript, settimeout

我正在开发一个供测试人员使用的简单界面，我将其编写为 HTML 页面。我需要做的是在用户按下按钮时打开一个特定的 URL（该 URL 会触发另一台服务器上的 Hudson/Jenkins 作业）。这是我用来完成此操作的代码：

```
function triggerJob() {
  var url = "...";
  var trigger = window.open(url);
  setTimeout(function() {trigger.close();}, 1000);
} 
```

几点注意事项：

*   我知道这是完成我想做的事情的不好方法。我已经使用 jQuery 实现了该解决方案，并且由于某种原因，在以这种方式查询 URL 时，Hudson 服务器上的工作没有启动。奇怪的是，当我在同一台机器上使用 Ruby 脚本查询它时，它工作得很好。

*   我必须做超时，因为如果我只是打开窗口然后立即关闭它，浏览器会做它应该做的事情，但是对于 Hudson 服务器来说注册它并开始工作太快了。

*   `trigger.close();`除了匿名函数之外，我还尝试过将其他语句放入其中，但它们也没有被执行。毫无疑问，setTimeout 没有执行它应该执行的块。

谢谢你能给我的任何帮助。我已经玩了几个小时了，无法弄清楚为什么我的代码没有正确执行超时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T14:33:28.543

在做其他事情的过程中发现了这个问题，所以我想我会分享解决方案，以防其他人遇到同样的问题。问题是我正在使用`onClick`表单中提交按钮的属性调用此函数。当表单提交时，它调用函数，然后在函数执行后立即重新加载页面，这取消了`triggerJob`函数中设置的超时。`setTimeout`如果您想以这种方式使用，您必须使用链接、单选按钮等。感谢所有试图帮助我的人。

德鲁

# ios - 前缀静态库 iOS

> ID：11512291
> 
> 赞同：13
> 
> 时间：2012-07-16T20:47:54.013
> 
> 标签：ios, ios-frameworks

我正在构建一个 iOS 静态库（根据[https://github.com/jverkoey/iOS-Framework](https://github.com/jverkoey/iOS-Framework)）。我依赖于 SBJson 和 AFNetworking。我想包含这些库以避免版本问题和安装简单；为此，我需要为这些库添加前缀以避免命名冲突。

如何以简单的方式为其他静态库添加前缀？

理想情况下，这将是我构建过程的一部分。不太理想但可以接受的是有关如何以理智的方式重构和重命名的提示。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-10-13T02:54:36.240

唯一安全的解决方案（除了根本不这样做）是在所有符号上构建任何带有前缀的依赖项。

最简单的前缀方法是经典的“查找和替换”。这很容易出错，因此最好使用 .a`nm -a`并搜索任何非前缀符号的结果。

第二种更安全的方法是使用两遍编译过程。

*   第一遍构建依赖项目并运行`nm`以将所有符号转储到头文件中。
*   第二遍再次构建依赖项目，但这次将生成的前缀头文件导入预编译头文件中。必须在您从框架中的依赖项中引用符号的任何地方使用此前缀标头，以便正确引用重命名的符号。

> 作为参考，我们将它与[Nimbus](http://nimbuskit.info/)一起使用来生成 Nimbus 前缀标头： [https ://github.com/jverkoey/nimbus/blob/master/scripts/generate_namespace_header](https://github.com/jverkoey/nimbus/blob/master/scripts/generate_namespace_header)
> 
> 这允许您分发嵌入了 Nimbus 前缀版本的 .framework。

您现在可以将生成的 .a 链接到您的框架中，并且当第三方开发人员不可避免地将他们自己的依赖版本链接到他们的项目时，可以安全地避免任何链接器冲突。

# objective-c - NSTextView 不工作

> ID：11512296
> 
> 赞同：1
> 
> 时间：2012-07-16T20:48:01.947
> 
> 标签：objective-c, nstextview

嗨社区，

我正在使用 NSTextView，我无法告诉你它有多么令人沮丧。我正在使用 NSAttributedStrings，所以我将 textStorage 设置为一个变量，告诉它开始编辑，然后我一直在 textStroage 上使用 appendAttributedString。第一次单击按钮更新 NSTextView 时，我收到以下错误消息：

-[NSNull _isDefaultFace]：无法识别的选择器发送到实例 0x7fff70bdefa0

第二次单击按钮时， NSTextView 完全空白，当我单击它时（好像试图选择它的文本），我收到以下消息：

_NSLayoutTreeLineFragmentRectForGlyphAtIndex 无效字形索引 0

这可能是什么原因造成的？？我已经尝试了几个小时来完成这项工作，所以任何帮助将不胜感激。谢谢！

〜乔希

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:29:28.073

我想到了。我一直在尝试使用两种不同的字体大小，而 NSTextView 不喜欢它

# objective-c - AudioFileOpen 没有以读/写权限打开

> ID：11512302
> 
> 赞同：0
> 
> 时间：2012-07-16T20:48:28.203
> 
> 标签：objective-c, macos, audio, core-audio, audio-streaming

我正在尝试以编程方式优化由 iTunes 以外的软件或使用 AudioFileOptimize() 的 afconvert 创建的 AAC 文件 (.m4a)。

但是，当我尝试使用读/写权限执行 AudioFileOpen 时，它给了我一个错误。即使我手动将 POSIX 权限设置为 0666（每个人都可以读/写），我也只能以读取权限打开。

我正在使用[此处描述的](https://developer.apple.com/library/mac/#documentation/MusicAudio/Reference/AudioFileConvertRef/Reference/reference.html)[AudioFileOpenUrl](https://developer.apple.com/library/mac/#documentation/MusicAudio/Reference/AudioFileConvertRef/Reference/reference.html)方法并返回“prm？” (kAudioFilePermissionsError)。

这是引发错误的代码：

```
#import <Cocoa/Cocoa.h>
#import <CoreFoundation/CoreFoundation.h>
#import <AudioToolbox/AudioToolbox.h>
#import "CAXException.h"

int main(int argc, const char * argv[])
{

    int result = 0;

    try {

    //optimize the output file:
    AudioFileID outfile;

    NSURL *outputFileURL = [NSURL fileURLWithPath:@"/DIR/PATH TO.m4a"];

    OSStatus err = AudioFileOpenURL((__bridge CFURLRef)outputFileURL, kAudioFileReadWritePermission, 0, &outfile);
    XThrowIfError(err, "AudioFileOpenURL");

    err = AudioFileOptimize(outfile); //Optimize the file
    XThrowIfError(err, "AudioFileOptimize");

    err = AudioFileClose(outfile);
    XThrowIfError(err, "AudioFileClose");

    } catch (CAXException e) {
        char str[32];
        printf ("CAXException thrown from CoreAudioConverter.mm. : %s, %s\n", e.FormatError(str), e.mOperation);
        result = 1;
    } catch (...) {
        result = 1;
    }

    return result;
} 
```

这输出：

```
CAXException thrown from CoreAudioConverter.mm. : 'prm?', AudioFileOpenURL 
```

如果有人可以提供帮助，那就太棒了！

旁注，是否有人以编程方式向 aac 文件添加流式提示？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:50:29.960

AudioFile 服务将不允许对某些文件进行写入访问：

> 但是，在使用 MPEG-4 文件类型时存在限制，其中包括：.mp4 (kAudioFileMPEG4Type)、.m4a (kAudioFileM4AType)、.3g2 (kAudioFile3GP2Type) 和 .3gp (kAudioFile3GPType)。
> 
> AudioFile 目前不支持写入这些类型的现有文件。

请参阅：http: [//developer.apple.com/library/mac/#qa/qa1676/_index.html](http://developer.apple.com/library/mac/#qa/qa1676/_index.html)

# html - 如何将图像放入选择菜单

> ID：11512305
> 
> 赞同：2
> 
> 时间：2012-07-16T20:48:36.977
> 
> 标签：html, css, html-select

如何将图像放在选择菜单中的文本旁边。

例如，这不起作用：

```
<select style="background-color:black; width:150px;color:white;">
   <option style="background-image:url(images/english.png);">English</option>
</select> 
```

这是行不通的。我想先有一个小标志，然后是语言的名称。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:00:06.343

select 元素不支持这种类型的东西。它旨在成为一种本机控件，无论在何处使用都是一致的。但是，您可以创建自己的自定义下拉样式菜单。

[这](http://gigsperusd.com/)是我做的一个（在图表下）。
此外，[这里](http://jamielottering.github.com/DropKick/)有一个 jquery 插件，它可能会让您更轻松。

祝你好运！

# php - ->find($id) in entity 返回一个空的代理对象 symfony2

> ID：11512307
> 
> 赞同：0
> 
> 时间：2012-07-16T20:48:47.373
> 
> 标签：php, symfony, doctrine-orm

我正在对实体进行搜索，但这会返回一个代理对象。因此，我正在尝试进行搜索。

```
$em = $this->getDoctrine()->getEntityManager();
$tipou = $em->getRepository('SertecomvendoautosBundle:TipoUsuario')->find(5); 
```

在数据库中，表 tipo_usuario 我只有两条 ID 为 4 和 5 的记录，但要使用 ID 4 进行搜索，学说会为我返回对象，而不是返回 ID 为 5 的代理对象。

```
$em = $this->getDoctrine()->getEntityManager();
$tipou = $em->getRepository('SertecomvendoautosBundle:TipoUsuario')->find(4); 
```

这以正常方式带来对象。

实在不明白这种行为学说，我想知道这是怎么回事。

这是实体tipo_usuario 的代码。

```
class TipoUsuario {
/**
 * @var string $tipouNombre
 */
private $tipouNombre;

/**
 * @var string $tipouToken
 */
private $tipouToken;

/**
 * @var datetime $tipouCreatedAt
 */
private $tipouCreatedAt;

/**
 * @var datetime $tipouUpdatedAt
 */
private $tipouUpdatedAt;

/**
 * @var integer $tipouId
 */
private $tipouId;

/**
 * Set tipouNombre
 *
 * @param string $tipouNombre
 */
public function setTipouNombre($tipouNombre)
{
    $this->tipouNombre = $tipouNombre;
}

/**
 * Get tipouNombre
 *
 * @return string 
 */
public function getTipouNombre()
{
    return $this->tipouNombre;
}

/**
 * Set tipouToken
 *
 * @param string $tipouToken
 */
public function setTipouToken($tipouToken)
{
    $this->tipouToken = $tipouToken;
}

/**
 * Get tipouToken
 *
 * @return string 
 */
public function getTipouToken()
{
    return $this->tipouToken;
}

/**
 * Set tipouCreatedAt
 *
 * @param datetime $tipouCreatedAt
 */
public function setTipouCreatedAt($tipouCreatedAt)
{
    $this->tipouCreatedAt = $tipouCreatedAt;
}

/**
 * Get tipouCreatedAt
 *
 * @return datetime 
 */
public function getTipouCreatedAt()
{
    return $this->tipouCreatedAt;
}

/**
 * Set tipouUpdatedAt
 *
 * @param datetime $tipouUpdatedAt
 */
public function setTipouUpdatedAt($tipouUpdatedAt)
{
    $this->tipouUpdatedAt = $tipouUpdatedAt;
}

/**
 * Get tipouUpdatedAt
 *
 * @return datetime 
 */
public function getTipouUpdatedAt()
{
    return $this->tipouUpdatedAt;
}

/**
 * Get tipouId
 *
 * @return integer 
 */
public function getTipouId()
{
    return $this->tipouId;
} 
```

# haskell - Haskell 中的 ByteStrings：我应该使用 Put 还是 Builder？

> ID：11512313
> 
> 赞同：10
> 
> 时间：2012-07-16T20:49:12.250
> 
> 标签：haskell, functional-programming, monads, binary-data

我对`Put`monad 提供的`Builder`直接使用的内容感到困惑，在`Data.Binary`. 我阅读了处理二进制数据的[二进制生成](http://www.haskell.org/haskellwiki/DealingWithBinaryData#Binary_generation)部分，似乎假设您应该使用`Put`，但它很短并没有解释原因。

**数据.二进制.Put**

> Put 单子。用于有效构造惰性字节串的 monad。
> 
> ```
> type Put = PutM () 
> ```
> 
> 只将 Builder 提升为 Writer monad，应用于 ()。

**Data.Binary.Builder**

> 懒惰字节字符串的高效构造。

* * *

*`Writer`应用单子有什么意义`()`？*

我可以看到这`Put`是（类型同义词）一个单子，而`Builder`不是，但我真的不明白为什么`Put`需要。

就我而言，我正在渲染一个 3D 场景并将每个像素写入 3 个字节，然后将 PPM 格式的标题添加到开头（稍后将使用 PNG）。

`Binary`似乎它旨在为可以序列化和反序列化二进制数据的类型实例化。这不完全是我正在做的事情，但是`Binary`为我的颜色类型实例化感觉很自然

```
instance (Binary a) => Binary (Colour a) where
    put (Colour r g b) = put r >> put g >> put b
    get = Colour <$> get <*> get <*> get 
```

这使得它很容易`put`变成`Colour Word8`24 位。但是我还必须添加标题，我不知道该怎么做。

是`Builder`要隐藏在幕后，还是取决于？该类`Binary`仅用于（反）序列化数据，还是用于所有二进制生成目的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-16T21:55:10.493

首先注意概念上的差异。构建器用于高效构建字节串流，而`PutM`monad 真正用于序列化。所以你应该问自己的第一个问题是你是否真的在序列化（回答这个问题时问问你自己是否有一个有意义且完全相反的操作——反序列化​​）。

一般来说，我会选择`Builder`它提供的便利。但是，不是`Builder`来自*二进制*包，而是来自*blaze-builder*包。它是一个幺半群，并有许多预定义的字符串生成器。它也是非常可组合的。最后，它非常快，实际上可以进行微调。

最后但并非最不重要的一点是，如果您真的想要速度、便利和优雅的代码，您将希望将其与各种流处理器库之一结合起来，如*管道*、*枚举*器或*管道*。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-16T21:15:38.837

> 我可以看到这`Put`是一个单子，而`Builder`不是，但我真的不明白为什么`Put`需要。

准确地说，`PutM`是`Monad`. 需要它来方便，并减少出错的机会。以 monadic 或 applicative 风格编写代码通常比显式携带所有临时代码要方便得多，并且在`Monad`实例中完成了管道，您不会`Builder`在函数中间意外使用错误。

您可以`PutM`使用 only完成所有操作`Builder`，但通常编写代码需要更多工作。

> 但是我还必须添加标题，我不知道该怎么做。

我不知道 PPM 格式，所以我不知道如何构造标题。但是在构建它之后，您可以简单地使用`putByteString`或`putLazyByteString`附加它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-31T16:01:06.447

我不确定这在多大程度上是准确的，但我的理解一直是，`Put`如您所见，它的表示在很大程度上是对 do-notation 的滥用，因此您可以编写如下代码：

```
putThing :: Thing -> Put
putThing (Thing thing1 thing2) = do
  putThing1 thing1
  putThing2 thing2 
```

我们没有使用“本质” `Monad`（特别是，我们从不绑定任何东西的结果），但我们获得了一种方便且简洁的连接语法。然而，相对于纯单曲面替代方案的美学优势：

```
putThing :: Thing -> Builder
putThing (Thing thing1 thing2) = mconcat [
  putThing thing1,
  putThing thing2] 
```

在我看来，是相当小的。

（请注意`Get`，相比之下，真正*是*一个 Monad，并且以清晰的方式受益）。

# qt - QPluginLoader 找不到模块

> ID：11512314
> 
> 赞同：0
> 
> 时间：2012-07-16T20:49:12.997
> 
> 标签：qt, gdal

我为我的应用程序创建了一个插件。如果我不在我的代码中使用 GDAL 库，我的应用程序可以使用这个插件（QPlugin 加载它）并且它工作正常。但是，如果我使用 GDAL 库中的类，`QPluginLoader`则无法加载它并且该`errorstring()`方法返回`../serverplugin.dll Can't find module`.

在插件 DLL 中有两个导出的符号（我用 Dependency walker 找到了它们`qt_plugin_instance`）。在内部使用该类与导出到 DLL 的 C 符号进行交互。如果我不使用 GDAL，我一开始在所有插件中只有两个导出的符号。当我使用 GDAL 时，这两个符号被移动到导出符号的大列表的末尾。也许这两个导出的符号应该在开头。`qt_plugin_query_verification_data``QPluginLoader``QLibrary`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T22:42:05.827

我对 QPluginLoader 也有同样的问题。简而言之，我是如何解决它的：我创建了插件库，比如说 lib1.dll，它使用了 lib2.dll 中的一些东西。在我的应用程序中，我尝试通过 QPluginLoader 加载 lib1。

```
QPluginLoader loader( adaptersDir.absoluteFilePath(fileName) );
AdapterInterface* adapterIface = qobject_cast<AdapterInterface*>(loader.instance()); 
```

在这种情况下，loader.instance() 返回 0。解决方案是将 lib2.dll 复制到应用程序文件夹中，因为应用程序使用它来正确加载插件 lib1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-14T01:25:56.690

```
QT_BEGIN_NAMESPACE
#define Plugin_iid "Plugin"
Q_DECLARE_INTERFACE(PluginInterface,Plugin_iid)
QT_END_NAMESPACE 

Q_PLUGIN_METADATA(IID "PluginInterface" FILE "Plugin.json")
Q_INTERFACES(PluginInterface) 
```

# ruby - Ruby IDE（来自 Visual Studio 背景）

> ID：11512317
> 
> 赞同：2
> 
> 时间：2012-07-16T20:49:17.833
> 
> 标签：ruby, ide

对于一所大学，我被建议在开始之前学习 Ruby。我有很强的 .NET 背景（使用 C#）并且想为 Ruby 找到一个 IDE。我目前非常熟悉/习惯于 VS2010 和 VS2012。

*   哪个 IDE 与 Visual Studio 最相似？
*   是否有某个突出的 IDE 比它的竞争对手好得多？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:53:44.407

我发现[JetBrains](http://www.jetbrains.com/ruby/)的 RubyMine 是我发现的最接近 Visual Studio 的。它是付费的，附带支持，并且是基于 Eclipse 构建的（我认为）。

如果您对使用文本编辑器感兴趣，我发现[Sublime Text 2](http://sublimetext.com/)是一个非常不错的选择。我曾经一直使用 TextMate，但我正在逐渐切换到 Sublime Text。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T01:04:30.447

> 哪个 IDE 与 Visual Studio 最相似？

[当然是Visual Studio](http://SapphireSteel.Com/Products/Ruby-In-Steel/)！

> 是否有某个突出的 IDE 比它的竞争对手好得多？

[RubyMine](http://JetBrains.Com/ruby/)有时被认为是最好的。就个人而言，我没有使用过它，所以我无法评论它。RubyMine 基本上是 IntelliJ IDEA 的精简（即不支持 Java）版本，预装了 IDEA Ruby 插件。

我一直使用 NetBeans Ruby 插件并且对它有些满意。

现在，如果您有使用其他动态语言（例如 Lisp 或 Smalltalk）的 IDE 的经验，那么所有 Ruby IDE，无论是 RubyMine、Eclipse RDT、Eclipse DLTK/Ruby、Ruby in Steel、RadRails 或 3rd Rail，还是“IDE” ”比如 Vim、Emacs、TextMate、Sublime 等，相比之下会感觉像是原始石器时代的工具。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-03T18:34:12.647

我编写了一个名为 visualruby 的 IDE，它的工作原理与 Visual Basic 类似。您可以使用 glade 界面设计器直观地构建表单。

看一眼

[http://visualruby.net](http://visualruby.net)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T20:46:05.117

RubyMine 是最接近 Visual Studio 的，是过渡到编写 Ruby 代码的好方法。不幸的是，一旦你加入一个*不*使用 IDE 的团队，你将很难让一个人开心。

IDE 通常需要关于代码的“提示”，并且由于 Ruby 的动态特性，编写 IDE 无法理解的代码变得非常容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T20:52:41.367

我相信[Netbeans](http://netbeans.org/)和[Eclipse](http://www.eclipse.org/)都有 Ruby 插件，在这两者之间我个人更喜欢 Netbeans，但我只将它们用于 Java 编程。对于 Ruby，我使用 Vim，您可以根据自己的需要对其进行自定义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-16T20:59:02.853

我认识的所有人都使用 Ruby 的文本编辑器（在我的公司，要么是 Vim，要么是 Sublime Text 2）。并不是说 Ruby 程序员不能使用 IDE，但他们通常不会。

如果您想学习 Ruby，那么在没有成熟的 IDE 的情况下可能值得一试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-24T20:37:26.630

如果您已经安装了 Visual Studio 2010（似乎总是作为其他 Microsoft 工具的一部分安装）Ruby In Steel 2.0 绝对值得一看。当然，它使用的是较旧的 shell，但它又快又熟悉。

# perl - 如何取消引用 STDIN 文件句柄的副本？

> ID：11512318
> 
> 赞同：7
> 
> 时间：2012-07-16T20:49:21.167
> 
> 标签：perl, reference, stdin, perl-module, filehandle

我试图弄清楚如何让 Perl 模块受到尊重并打开对文件句柄的引用。当你看到主程序时，你就会明白我的意思：

```
#!/usr/bin/perl
use strict;
use warnings;

use lib '/usr/local/share/custom_pm';
use Read_FQ;

# open the STDIN filehandle and make a copy of it for (safe handling)
open(FILECOPY, "<&STDIN") or die "Couldn't duplicate STDIN: $!";

# filehandle ref
my $FH_ref = \*FILECOPY;

# pass a reference of the filehandle copy to the module's subroutine
# the value the perl module returns gets stored in $value
my $value = {Read_FQ::read_fq($FH_ref)};

# do something with $value 
```

基本上，我希望主程序通过 STDIN 接收输入，制作 STDIN 文件句柄的副本（用于安全处理），然后将该副本的引用传递给 Read_FQ.pm 文件（perl 模块）中的 read_fq() 子例程。然后，子例程将从该文件句柄中读取输入，对其进行处理并返回一个值。这里是 Read_FQ.pm 文件：

```
package Read_FQ;

sub read_fq{
my ($filehandle) = @_;
my contents = '';

open my $fh, '<', $filehandle or die "Too bad! Couldn't open $filehandle for read\n";
while (<$fh>) {
# do something
}
close $fh;
return $contents; 
```

这就是我遇到麻烦的地方。在终端中，当我将文件名传递给主程序以打开时：

`cat file.txt | ./script01.pl`

它给出以下错误消息：`Too bad! Couldn't open GLOB(0xfa97f0) for read`

这告诉我问题是我如何取消引用并打开对 perl 模块中文件句柄的引用。主程序没问题。我读到这`$refGlob = \*FILE;`是对文件句柄的引用，在大多数情况下，应该由 Perl 自动取消引用。但是，这里不是这种情况。有谁知道如何取消引用文件句柄 ref 以便我可以处理它？

谢谢。非常感谢任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:58:27.273

你`$filehandle`应该已经打开了——你已经打开了`FILECOPY`，拿了一个参考并把它放进去`$FH_ref`，就是`$filehandle`。如果您想再次重新打开它，请使用`<&`in 中的参数或*立即*`open`开始阅读它。

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T20:59:00.567

如果我理解正确，您需要 3-arg 等效项

```
open my $fh, '<&STDIN' 
```

那将是

```
open my $fh, '<&', $filehandle 
```*

# html - 有什么方法可以从使用 :before 类插入的内容中删除斜体样式？

> ID：11512323
> 
> 赞同：7
> 
> 时间：2012-07-16T20:49:34.960
> 
> 标签：html, css

我有这样的代码

```
<li class="iconic camera">Pentax K-5 16 Megapixel DSLR</li> 
```

我像使用 CSS

```
.iconic.camera:before {
font-size: 35px;
font-family: "KameraDings";
content: "A";
padding-right: 8px;
vertical-align: -10%;
} 
```

插入带有特殊符号字体的相机符号。但是，我将 li 设置为斜体的样式。有没有办法从这一个内容字母中删除斜体？我试过`font-style: none;`无济于事

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-16T20:57:25.777

那`font-style: normal;`不是`font-style: none;`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T20:55:45.570

## *[jsBin 演示](http://jsbin.com/iqilor/2/edit)*

```
.iconic{
    font-style:italic;
}

.iconic.camera:before {
    font-size: 35px;
    font-family: "KameraDings";
    content: "A";
    padding-right: 8px;
    vertical-align: -10%;
    font-style:normal;            /* ta-da!*/
} 
```

# iphone - 如何冻结 UItableview 中的条形图

> ID：11512324
> 
> 赞同：0
> 
> 时间：2012-07-16T20:49:37.897
> 
> 标签：iphone, ios, uiview, uitableview, toolbar

我制作了一个自定义类，其中包含在我所有视图中实例化的自定义动画工具栏。它在使用 [view addSubview:] 的经典 UIview 中运行良好。该栏位于标签栏和视图之间。但是在我的 tableviewcontroller 中，当我滑动它们时，它会跟随单元格。我这里没有 Xcode，所以我不能发布任何明确的代码，但我只是在寻找提示。谢谢 PS：我试图通过堆栈和谷歌搜索它，但我认为我使用了错误的关键字（英语不太好：p）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:52:56.443

您添加了哪个视图？

尝试将其添加到 tableview 的 superview 而不是 tableview 本身。

# ruby - 如何判断哪个 gem 导致依赖另一个（已卸载）gem？

> ID：11512325
> 
> 赞同：1
> 
> 时间：2012-07-16T20:49:40.627
> 
> 标签：ruby, rubygems, jruby

当我安装另一个 gem 时，我如何知道为什么要安装一个特定的 gem？

也就是说，有没有一种简单的方法可以找出依赖项的来源？gem 安装失败，所以 gem 依赖不起作用，因为它只处理已安装的 gem。这就是为什么我想追踪依赖关系，它破坏了安装，而且似乎没有必要。

是否有工具可以帮助跟踪尚未安装的 gem 之间的依赖关系？也许是一个打印依赖树的秘密 bundlerswitch？

**更新**他们刚刚发布了一个新版本的 twitter-bootstrap-rails 来解决这个问题。尽管如此，如果有一种方法可以跟踪已卸载 gem 的依赖关系图，那将会很有用。

这是失败的命令，在带有 JRuby 的 Windows 上运行

```
gem install twitter-bootstrap-rails 
```

不知何故，这会导致安装旧版本的 libv8 gem，然后安装失败。twitter-bootstrap-rails 没有在它的 gem_spec 中列出 libv8，只有 ruby​​rhino 和 less-rails，它们依赖于其他人和其他人......最终有人依赖于旧版本的 libv8（v3.3.10.4）。问题是哪个 gem 会导致对 libv8 的依赖？

这是我的环境。

```
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.15
  - RUBY VERSION: 1.9.2 (2012-02-22 patchlevel 312) [java]
  - INSTALLATION DIRECTORY: c:/jruby-1.6.7/lib/ruby/gems/1.8
  - RUBY EXECUTABLE: c:/jruby-1.6.7/bin/jruby.exe
  - EXECUTABLE DIRECTORY: c:/jruby-1.6.7/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - universal-java-1.7
  - GEM PATHS:
     - c:/jruby-1.6.7/lib/ruby/gems/1.8
     - c:/Users/alex/.gem/jruby/1.9
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
     - "install" => "--no-rdoc --no-ri --env-shebang"
     - "update" => "--no-rdoc --no-ri --env-shebang"
  - REMOTE SOURCES:
     - http://rubygems.org/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:00:15.510

如果可以在 MRI 下安装它，则可以使用[gemviz](https://github.com/davidrupp/gemviz#readme)显示依赖关系图，如下所示：

```
gemviz twitter-bootstrap-rails 
```

应该可以使用未安装的 gem 来做到这一点（必须有一个这样做的网站），但 gemviz 不能这样做。

**编辑：**这是依赖关系图：

![twitter-bootstrap-rails gem 依赖图](../Images/39d0256a6e22d5c81dad81d24e13feef.png)

所以*therubyracer*依赖于*libv8*。那里有很多依赖项..

# jquery - 为什么 JQuery 不更改 IE 中的选择选项？

> ID：11512326
> 
> 赞同：1
> 
> 时间：2012-07-16T20:49:42.343
> 
> 标签：jquery, internet-explorer, select, case, option

我们试图让一个投递箱改变另一个。我们有这段代码在 Firefox、safari 和 chrome 上运行良好。但在 IE 8+ 中，更改第一个下拉菜单对第二个下拉菜单没有影响。我们必须改变什么才能让它在 IE 中工作？谢谢，

我们有这个jquery：

```
 //set up the global variable maxChecks which stops donor ticking too many boxes
    var maxChecks
    var checkCount=0
    var boxeschecked = 0
    //now change the drop down
    jQuery.noConflict();
    jQuery(document).ready(function($) {
        $(function() {      
            $("#json-one").change(function() {
                if ($(this).val() >= "1" ) {
                    $("#hide1").slideDown("fast"); //Slide Down Effect
                }
                var $dropdown = $(this);
                var key = $dropdown.val();
                var vals = [];
                switch(key) {
            case '1': document.getElementById("t3").innerHTML ="<option value=2>&pound;2.50 per month</option>, <option value=3>&pound;30 per year</option>, <option value=1>A single donation of &pound;30</option>"; maxChecks=1; boxeschecked=0; checkCount=0; document.getElementById("nsdiv").innerHTML =""; for (var i = 0; i < 1 ; i++) {document.getElementById("nsdiv").innerHTML +='<input type="hidden" name="childid[]" value="newchild" checked>';} break;
            case '2': document.getElementById("t3").innerHTML ="<option  value=5>&pound;5 per month</option>, <option value=4>&pound;60 per year</option>, <option value=22>A single donation of &pound;60</option>"; maxChecks=2; boxeschecked=0; checkCount=0; document.getElementById("nsdiv").innerHTML =""; for (var i = 0; i < 2 ; i++) {document.getElementById("nsdiv").innerHTML +='<input type="hidden" name="childid[]" value="newchild" checked>';} break;

case 'base': vals = ['-'];
                }
                $jsontwo.empty();
            });
        });
    }); 
```

这是html：

```
 <select id="json-one" name="json-one">
        <option selected value="base">Please select</option>
        <option value="1">1 child</option>
        <option value="2">2 children</option>
    </select>
    <!-- this select box will be hidden at first -->
    <div style="display:none;" id="hide1">
        By donating <select id="t3" name="t3"><option>-</option></select>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:05:57.470

以下似乎在 IE 中工作：

```
 //set up the global variable maxChecks which stops donor ticking too many boxes
    var maxChecks;
    var checkCount=0;
    var boxeschecked = 0;
    //now change the drop down
    jQuery.noConflict();
    jQuery(document).ready(function($) {
        $(function() {      
            $("#json-one").change(function() {
                if ($(this).val() >= "1" ) {
                    $("#hide1").slideDown("fast"); //Slide Down Effect
                }
                var key = $(this).val();
                var vals = [];
            switch(key) {
              case "1": 
                $("#t3").html('<option value=2>&pound;2.50 per month</option> <option value=3>&pound;30 per year</option> <option value=1>A single donation of &pound;30</option>');
                maxChecks=1; 
                boxeschecked=0; 
                checkCount=0; 
                $("#nsdiv").html('');
                for (var i = 0; i < 1 ; i++) {
                    $("#nsdiv").append('<input type="hidden" name="childid[]" value="newchild" checked>');
                } 
                break;
              case "2": 
                $("#t3").html('<option  value=5>&pound;5 per month</option> <option value=4>&pound;60 per year</option> <option value=22>A single donation of &pound;60</option>'); 
                maxChecks=2; 
                boxeschecked=0; 
                checkCount=0; 
                $("#nsdiv").html('');
                for (var i = 0; i < 2 ; i++) {
                    $("#nsdiv").append('<input type="hidden" name="childid[]" value="newchild" checked>');
                } 
                break;

              case 'base': 
                vals = ['-'];
                break;
            }
            });
        });
    });
​ 
```

请参阅此处的示例：http: [//jsfiddle.net/m6A8z/](http://jsfiddle.net/m6A8z/)

# position - Position Absolute 的 jQuery-Validation-Engine - 表单字段的条件验证

> ID：11512328
> 
> 赞同：3
> 
> 时间：2012-07-16T20:49:45.120
> 
> 标签：position, conditional, absolute, jquery-validation-engine

我正在使用 Position Absolute 的表单验证引擎。

我有一个特定的验证案例，我希望这可以为我解决。我需要能够根据另一个字段的值创建一个字段。

例如：

```
If country.dropdown = "USA", then state.dropdown is required. 
```

或者

```
If country.dropdown <> 'USA" then state.dropdown is not required. 
```

您认为 JQuery Validation Engine 可以做到这一点吗？如果是这样，你能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:41:13.883

我不得不说，首先，我从未使用过 Position Absolute 的表单验证引擎，但我对它感兴趣，阅读了你的问题。从文档（[https://github.com/posabsolute/jQuery-Validation-Engine](https://github.com/posabsolute/jQuery-Validation-Engine)）看来，您必须创建一个自定义验证函数。

我在这里创建了一个工作小提琴：http: [//jsfiddle.net/5pKjW/6/](http://jsfiddle.net/5pKjW/6/)

即使它有效，我也不完全满意，因为第 584 行的验证引擎中存在这种情况，因此需要一个“哨兵值”。

```
// If the rules required is not added, an empty field is not validated
if(!required && field.val() == "" && !errorMsg) options.isError = false; 
```

这是带有自定义功能的选择标记：

```
<select class="validate[funcCall[checkCountry]]" type="text" name="state" id="state">
    <option value="none" ></option>
    <option value="CALIFORNIA" >CALIFORNIA</option>
    <option value="NEW ENGLAND" >NEW ENGLAND</option>
    <option value="TEXAS" >TEXAS</option>
</select> 
```

这是验证器初始化：

```
jQuery("#formID").validationEngine({
    'customFunctions': {
        'checkCountry': function (field, rules, i, options){
            if ($('#country').val() === 'USA' && field.val() === 'none') {
                return options.allrules.required.alertText;
            }
        }
    }
}); 
```

1) 首先，您必须定义一个验证函数，它可以是全局的，也可以作为插件的参数传递（就像我在上面所做的那样）。自定义函数接受以下输入：字段、规则、i、选项。您没有对表单的引用，您只有对当前字段的引用。因此，如果您想访问另一个字段，您必须像往常一样使用 jQuery 选择它（在示例中： $('#country') ）。

2）您检查验证条件。在示例中，如果出现以下情况，它将失败：

```
$('#country').val() === 'USA' && field.val() === 'none' 
```

如果不遵守条件，该函数必须返回一个字符串。在示例中，我在 options.allrules.required 中返回了标准消息。该文档解释了如何为自定义函数定义自定义消息。

如您所见，由于

```
if(!required && field.val() == "" && !errorMsg) options.isError = false; 
```

在验证引擎的行中，开发人员被迫使里面的条件`if`失败，并且将所需条件设置为 true 或将错误消息设置为 falsy 值是不正确的。所以，唯一的办法就是制作`field.val() != ''`. 出于这个原因，标记中的第一个选项元素具有标记值`none`，而不是空的。这不是一个干净的解决方案，甚至可能无法轻松实现（我不知道您是否自己生成标记（如果不这样做，事情会变得更加困难，您需要通过 javascript 操作表单，在验证引擎初始化之前））。

这不是一个干净的解决方案。一个更好的解决方案是使用`condRequired`，如果它接受一个自定义函数，而不是只检查它的一个参数是否已被填充。

# c# - 这个 VB.net 的等效 C# 是什么？

> ID：11512334
> 
> 赞同：1
> 
> 时间：2012-07-16T20:50:02.623
> 
> 标签：c#, vb.net

当我在 VB.net 中创建一个新的空 Web 应用程序项目时，我会`Application.myapp`在我的项目下看到该文件。

相同的文件不会出现在 C# 中。那么在 C# 项目中创建了哪些与此文件等效的内容呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:57:05.600

C# 中 Application.myapp 的等价物是 app.config

# c# - 使用 SQL 返回 JSON 字符串

> ID：11512335
> 
> 赞同：10
> 
> 时间：2012-07-16T20:50:02.933
> 
> 标签：c#, asp.net-mvc, json, sql-server-2008

这是一个“最佳实践”问题。我们正在就这个话题进行内部讨论，并希望获得更广泛受众的意见。

我需要将我的数据存储在`MS SQL Server`具有普通列和行的传统表中。有时我需要将 a 返回`DataTable`到我的 Web 应用程序，而其他时候我需要返回一个`JSON`字符串。

目前，我将表格返回到中间层并将其解析为`JSON`字符串。这似乎在大多数情况下运行良好，但有时在大型数据集上需要一段时间（解析数据，而不是返回表）。

我正在考虑修改存储过程以选择性地返回一个`DataTable`或一个`JSON`字符串。我会简单地`@isJson bit`向 SP 添加一个参数。

如果用户想要字符串而不是表，SP 将执行如下查询：

```
DECLARE @result varchar(MAX)
SELECT @result = COALESCE(@results ',', '') + '{id:"' + colId + '",name:"' + colName + '"}'
    FROM MyTable
SELECT @result 
```

这会产生如下内容：

```
{id:"1342",name:"row1"},{id:"3424",name:"row2"} 
```

当然，用户也可以通过@isJson参数传入false来获取表。

我想明确一点，数据存储不受影响，任何现有视图和其他流程也不受影响。这只是对某些存储过程的结果的更改。

我的问题是：

1.  有没有人在大型应用程序中尝试过这个？如果有，结果如何？
2.  您看到/期望这种方法有哪些问题？
3.  除了以这种方式修改存储过程或在中间层解析字符串之外，是否有更好更快的方法从 SQL Server 中的表转到 JSON？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T21:24:15.430

我个人认为这种字符串操作的最佳位置是在程序代码中使用具有功能并且可以编译的完全表达语言的程序代码。在 T-SQL 中这样做并不好。程序代码可以有快速的函数来进行正确的转义。

让我们稍微考虑一下：

*   当您部署应用程序的各个部分的新版本时，该功能的最佳位置是哪里？

*   如果您必须恢复您的数据库（及其所有存储过程），这会对任何事情产生负面影响吗？如果您正在部署新版本的 Web 前端，绑定到数据库的 JSON 转换是否会导致问题？

*   你将如何正确地转义字符？您是否通过发送任何日期？日期字符串将采用什么格式以及如何将它们转换为另一端的实际 Date 对象（如果需要）？

*   您将如何对其进行单元测试（并使用自动化测试！）以证明它工作正常？你将如何对其进行回归测试？

*   SQL Server UDF 可能非常慢。您是否满足于使用慢速函数，或者为了快速破解您的 SQL 代码之类的东西`Replace(Replace(Replace(Replace(Value, '\', '\\'), '"', '\"'), '''', '\'''), Char(13), '\n')`？Unicode`\u`和`\x`转义呢？分裂`'</script>'`成怎么样`'<' + '/script>'`？（也许这不适用，但也许确实如此，这取决于您如何使用 JSON。）您的 T-SQL 过程是否会完成所有这些工作，并且可重复用于不同的记录集，或者您是否每次都将其重写为每个记录集？ SP 需要返回 JSON 吗？

*   您可能只有一个 SP 需要返回 JSON。目前。有一天，你可能会拥有更多。然后，如果您发现错误，则必须在两个地方进行修复。或五个。或者更多。

通过让中间层进行翻译，您似乎使事情变得更加复杂，但我向您保证，从长远来看，它会变得更好。如果您的产品横向扩展并开始大规模并行化——您总是可以廉价地投入更多的 Web 服务器，但您不能轻易解决数据库服务器资源饱和的问题！所以不要让数据库做比它应该做的更多的工作。它是数据访问层，而不是表示层。让它做尽可能少的工作。为其他一切编写代码。你会很高兴你做到了。

**Web 应用程序中字符串处理的速度提示**

1.  确保您的 Web 字符串连接代码不会受到[Schlemiel the Painter's Algorithm 的](http://en.wikipedia.org/wiki/Schlemiel_the_Painter%27s_algorithm)影响。要么在生成 JSON 时直接写入输出缓冲区（Response.Write），要么使用适当的 StringBuilder 对象，或者将 JSON 的部分写入数组并稍后加入（）它。不要一遍又一遍地对越来越长的字符串进行简单的香草连接。
2.  尽可能少地取消引用对象。我不知道您的服务器端语言，但如果它恰好是 ASP Classic，请不要使用字段名称——要么获取对变量中每个字段的引用，要么至少使用整数字段索引。在循环中根据字段名称取消引用字段会（非常）糟糕的性能。
3.  使用预建库。当您可以使用经过验证的真实库时，请不要自己动手。性能应该与您自己的相同或更好，并且（最重要的是）它将*经过测试*并*正确*。
4.  如果您打算花时间做这件事，请使其抽象到足以处理任何记录集的转换，而不仅仅是您现在拥有的记录集。
5.  使用编译后的代码。在编译而不是解释时，您总是可以获得最快的代码。如果您确定 JSON 转换例程确实是瓶颈（并且您必须证明这一点是真实的，不要猜测）然后将代码放入已编译的内容中。
6.  减少字符串长度。这不是一个大的，但如果可能的话，使用一个字母的 json 名称而不是多字母。对于一个巨大的记录集，这*将*增加两端的节省。
7.  确保它是 GZipped。这并不是服务器端的改进，但我不能不完整地提及 JSON 性能。

**在 JSON 中传递日期**

我建议使用单独的 JSON 模式（它本身在 JSON 中，定义要遵循的虚拟记录集的结构）。该模式可以作为标头发送到“记录集”以进行跟踪，也可以已经加载到页面中（包含在基本 javascript 文件中），因此不必每次都发送。然后，在您的 JSON 解析回调（或最终结果对象的后回调）中，查看当前列的架构并根据需要进行转换。您可能会考虑使用 ISO 格式，因为在[ECMAScript 5 严格模式下](http://ejohn.org/blog/ecmascript-5-strict-mode-json-and-more/)应该有更好的日期支持，并且您的代码可以简化而无需更改数据格式（并且简单的对象检测可以让您将此代码用于任何支持的浏览器它）：

> **日期**
> 
> 日期现在能够解析和输出 ISO 格式的日期。
> 
> Date 构造函数现在尝试解析日期，就好像它是 ISO 格式的，首先，然后移动到它接受的其他输入。
> 
> 此外，日期对象现在有一个新的 .toISOString() 方法，它以 ISO 格式输出日期。var date = new Date("2009-05-21T16:06:05.000Z");
> 
> 打印（日期.toISOString（））；// 2009-05-21T16:06:05.000Z

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T20:56:18.227

我不会那样做你正在做的（contatenating）

您可以尝试创建一个使用 JSON.net 并返回 varchar 的 CLR SQL 函数。

请参阅此处如何创建 SQL CLR 函数： http: [//msdn.microsoft.com/en-us/library/w2kae45k (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/w2kae45k(v=vs.80).aspx)

像这样的东西（未经测试的代码）

```
[Microsoft.SqlServer.Server.SqlFunction]
public static SqlString MyFunctionName(int id) {
    // Put your code here (maybe find the object you want to serialize using the id passed?)
    using (var cn = new SqlConnection("context connection=true") ) {
        //get your data into an object
        var myObject = new {Name = "My Name"};
        return new SqlString(Newtonsoft.Json.JsonConvert.SerializeObject(myObject));
    }
} 
```

# batch-file - < > 批处理文件中的符号

> ID：11512342
> 
> 赞同：0
> 
> 时间：2012-07-16T20:50:19.207
> 
> 标签：batch-file, cmd

我正在尝试运行 mysql 转储，当我执行文件时，< 或 > 符号之前出现 0 或 1，如何在批处理文件中使用此符号？

`mysqldump -u root -p extractor --routines > E:\MySQLDumpCMD\newsql.sql`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:21:07.523

这很正常。`cmd`只输出预期的内容。在您的情况下`<`重定向标准输入流（0）并`>`重定向标准输出流（1）。也就是说和`0<`一样`<`和`1>`一样`>`。所以这两种写法是等价的。

# java - XMLStreamReader 打印

> ID：11512344
> 
> 赞同：0
> 
> 时间：2012-07-16T20:50:24.183
> 
> 标签：java, xml

我正在使用`XMLStreamReader`读取 XML 文件并查找特定元素，然后更新相应的值。

我的问题是有没有一种方法可以打印每个元素，包括文档的开头，例如：

```
<?xml version="1.0" encoding="UTF-8"?> 
```

每次我做`reader.next()`什么？

例如：

```
XMLStreamReader reader = inputFactory.createXMLStreamReader(new FileInputStream(
                file));
while(reader.hasNext())
reader.next().ToString() //Something like this?
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:17:50.740

我对你在问什么感到有点困惑。

要打印，`<?xml version="1.0" encoding="UTF-8"?>`您必须处理该`START_DOCUMENT`事件。您可以为此状态调用以下方法：

```
next(), getEncoding(), getVersion(), isStandalone(), standaloneSet(), getCharacterEncodingScheme(), nextTag() 
```

要打印每次`next()`调用时最先读取的元素的名称：

```
XMLStreamReader reader = inputFactory.createXMLStreamReader(new FileInputStream(
                   file));
String currentElement = "";
while(reader.hasNext()) {
   int next = reader.next();

   ..
   if(next == XMLStreamReader.START_ELEMENT){
        currentElement = reader.getLocalName();
   ..

   System.out.println(currentElement );
} 
```

或者，如果您只想打印出 XML 文件中的所有数据，则需要相应地处理每个事件：

```
XMLStreamReader reader = inputFactory.createXMLStreamReader(new FileInputStream(
                file));
while(reader.hasNext()) {
   int next = reader.next();

   ..
   if(next == XMLStreamReader.START_ELEMENT){
        System.out.println(reader.getLocalName());
   }
   else if(next == XMLStreamReader.ATTRIBUTE) {
        // Print out all the attributes
   }
   else if(next == XMLStreamReader.COMMENT) {
        // Print the comment
   }
   ..

} 
```

有关事件的完整列表，请参考[文档](http://docs.oracle.com/javase/6/docs/api/javax/xml/stream/XMLStreamReader.html)。

# full-text-search - 按输入流属性搜索

> ID：11512345
> 
> 赞同：0
> 
> 时间：2012-07-16T20:50:29.157
> 
> 标签：full-text-search, inputstream, jackrabbit, jcr

我有一个关于通过`inputStream`名为 data 的类型的属性来过滤资源的 xpath 表达式的问题。如何进行文本搜索，例如这是有效的：

```
String xpath1 = "<my app path>//element(*, nt:resource) [jcr:contains(@jcr:mimeType,'*plain*')]";
String xpath2 = "<my app path>//element(*, nt:resource) [jcr:contains(@jcr:encoding,'*utf*')]"; 
```

但这不起作用。

```
String xpath3 = "<my app path>//element(*, nt:resource) [jcr:contains(@jcr:data,'*plain*')]"; 
```

真正的事实是我们使用了一些自定义节点，让我们解释一下属性定义：

**在 Java 术语中...**

```
public class Resource extends BaseNode {

  /** Encoding media type. It cannot be null or empty. */
  @Field(jcrName = "jcr:encoding", jcrDefaultValue = "")
  private String encoding;

  /** Resource's MIME type. It cannot be null or empty. */
  @Field(jcrName="jcr:mimeType", jcrDefaultValue = "")
  private String mimeType;

  /** Resource's size (bytes). */
  @Field(jcrName="skl:size")
  private long size;

  /** Resource's content data as stream. It cannot be null. */
  @Field(jcrName="jcr:data")
  private InputStream data;

  ...
}

@Node(jcrType = "baseNode", isAbstract = true)
public abstract class BaseNode {

  @Field(jcrName = "name", id = true)
  protected String name;

  @Field(jcrName = "creationDate")
  protected Date creationDate;

  ...
} 
```

**在 JackRabbit 术语中......**

```
<!-- Base node type definition -->
  <nodeType name="docs:baseNode"
            isMixin="false"
            hasOrderableChildNodes="false" >
    <supertypes>
      <supertype>nt:hierarchyNode</supertype>
    </supertypes>
    <propertyDefinition name="docs:name"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="docs:searchPath"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="false"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="docs:creationDate"
                        requiredType="Date"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="docs:lastModified"
                        requiredType="Date"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <childNodeDefinition name="*"
                         defaultPrimaryType="docs:baseNode"
                         autoCreated="false"
                         mandatory="false"
                         onParentVersion="COPY"
                         protected="false"
                         sameNameSiblings="false">
      <requiredPrimaryTypes>
        <requiredPrimaryType>docs:baseNode</requiredPrimaryType>
      </requiredPrimaryTypes>
    </childNodeDefinition>
  </nodeType>

  <!-- Resource node type definition -->
  <nodeType name="skl:resource"
            isMixin="false"
            hasOrderableChildNodes="false" >
    <supertypes>
      <supertype>docs:baseNode</supertype>
      <supertype>nt:resource</supertype>
    </supertypes>
    <propertyDefinition name="skl:size"
                        requiredType="Long"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="skl:externalUri"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="false"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
  </nodeType> 
```

关键是，我如何执行此查询以按 jcr:data 属性进行过滤。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:12:36.217

我认为您必须打开文本提取，以便您的“jcr:data”属性中的可搜索文本将被索引。在 Jackrabbit 讨论列表中查看[此电子邮件主题。](http://jackrabbit.510166.n4.nabble.com/jcr-sql2-contains-full-text-search-not-working-tt4655655.html#a4655938)

顺便说一句，JCR [CND 格式](http://www.day.com/specs/jcr/2.0/25_Appendix.html#25.2.3%20CND%20Grammar)是描述节点类型的更紧凑的方式。

# vb6 - 从 VB6 exe Main 返回值？

> ID：11512346
> 
> 赞同：5
> 
> 时间：2012-07-16T20:50:32.200
> 
> 标签：vb6, main

我的印象是这是不可能的，但这就是我到目前为止所得到的。

```
Sub Main()        
    On Error GoTo ErrorHandler        
    If Command$ = "" Then
        LogAction "Begin document lockdown"
        LockdownDocs
        LogAction "Lockdown complete"
    Else
        LogAction "Begin document enabling"
        EnableDocs
        LogAction "Documents have be enabled"
    End If
Exit Sub
ErrorHandler:
    LogAction "DocLock Error " & Err.Number & "::" & Err.Description
End Sub 
```

我希望它看起来像这样：

```
Function Main() As Boolean
    On Error GoTo ErrorHandler        
    If Command$ = "" Then
        LogAction "Begin document lockdown"
        LockdownDocs
        LogAction "Lockdown complete"
    Else
        LogAction "Begin document enabling"
        EnableDocs
        LogAction "Documents have be enabled"
    End If
    Return True
Exit Function
ErrorHandler:
    LogAction "Error " & Err.Number & "::" & Err.Description
    Return False
End Function 
```

我见过的最接近的是`Function Main() As Integer`Visual Studio 2005，但我使用的是 VB6。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T20:54:22.730

[这里](http://www.tek-tips.com/viewthread.cfm?qid=794886)有一个可能的解决方案，通过使用 Win32 API 调用。本质上：

```
Private Declare Sub ExitProcess Lib "kernel32" (ByVal uExitCode As Long)

' Exit with ErrorLevel set to 9
ExitProcess 9 
```

请注意，这相当于`End`VB 运行时，因此您必须在调用`ExitProcess`.

# java - 在服务器上的 Applet 中使用 OutputFileStream("test.abc") 正在浏览器的文件夹中创建一个新文件

> ID：11512357
> 
> 赞同：1
> 
> 时间：2012-07-16T20:51:22.363
> 
> 标签：java, web, applet, relative-path

首先，对不起我的英语不好。

我不是java专业人士，以前从未编写过小程序。所以我正在尝试为我的网站编写一个小游戏。在这个游戏中，我想要一张图片作为背景，所以我尝试加载它：

```
Image im = Toolkit.getDefaultToolkit().getImage(path); 
```

这会引发 FileNotFoundException，因此我尝试使用 FileOutputStream("test.abc") 创建一个新文件，以查看将在何处创建它。我这样做了，它是在我本地的 firefox 文件夹中创建的。那么如何从服务器上的文件夹中加载图片呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T23:35:45.877

由于它是一个 BG 图像，它也可能是一个[嵌入式资源](https://stackoverflow.com/tags/embedded-resource/info)。要“嵌入”它，请将其包含在小程序的一个罐子中，然后根据上面的链接访问它。

您还可以考虑使用[Java Web Start](https://stackoverflow.com/tags/java-web-start/info)从链接部署框架（而不是小程序） 。这提供了更少的开发/维护时间和更好的用户体验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T02:20:16.587

> 我这样做了，它是在我本地的 firefox 文件夹中创建的。

当然是的。你为什么惊讶？FileOutputStream 不会向您的服务器发送 HTTP。它与本地文件系统对话。

> 那么如何从服务器上的文件夹中加载图片呢？

`getCodeBase()+"/back.jpg"`*如果* `back.jpg`在 . 引用的目录中应该可以工作`getCodeBase()`。

# pyqt - Signal/Slot help--设置一个信号到当前类之外的一个槽

> ID：11512359
> 
> 赞同：1
> 
> 时间：2012-07-16T20:51:26.227
> 
> 标签：pyqt, signals-slots

我正在尝试从位于单独类中的小部件中的滑块填充表（存在于主窗口中）。我似乎无法让它工作......这样做的最佳方法是什么？
这是我当前的代码：

```
class Widget(QWidget):
    def __init__(self,filename,parent=None):
        super(Widget,self).__init__(parent)
        self.resize(900,900)
        self.layout=QVBoxLayout(self)

        frame=Frame(filename)
        self.image=pg.ImageView()
        self.image.setImage(frame.data)
        self.image.setCurrentIndex(0)

        fileheader=FileHeader(filename)
        self.slider=QSlider(self)
        self.slider.setOrientation(Qt.Horizontal)
        self.slider.setMinimum(1)
        self.slider.setMaximum(fileheader.numframes)
        self.slider.sliderMoved.connect(self.sliderMoved)

        self.layout.addWidget(self.image)
        self.layout.addWidget(self.slider)

    def sliderMoved(self,val):
        print "slider moved to:", val
        fileheader=FileHeader(filename)
        idx=val
        frame=fileheader.frameAtIndex(idx)
        self.image.setImage(frame.data)

class MainWindow(QMainWindow):
    def __init__(self, filename, parent=None):
        super(MainWindow,self).__init__(parent)

        self.initUI(filename)

    def initUI(self,filename):
        self.filetable=QTableWidget()

        self.frametable=QTableWidget()

        self.imageBrowser=Widget(filename)
        self.imagesplitter=QSplitter(Qt.Horizontal)
        self.tablesplitter=QSplitter(Qt.Horizontal)
        self.imagesplitter.addWidget(self.imageBrowser)
        self.tablesplitter.addWidget(self.imagesplitter)
        self.tablesplitter.addWidget(self.filetable)
        self.tablesplitter.addWidget(self.frametable)
        self.setCentralWidget(self.tablesplitter)

        exitAction=QAction(QIcon('exit.png'),'&Exit',self)
        exitAction.setShortcut('Ctrl+Q')
        exitAction.triggered.connect(qApp.quit)

        openAction=QAction(QIcon('open.png'),'&Open',self)
        openAction.setShortcut('Ctrl+O')

        menubar=self.menuBar()
        fileMenu=menubar.addMenu('&File')
        fileMenu.addAction(exitAction)
        fileMenu.addAction(openAction)

        self.fileheader=FileHeader(filename)
        self.connect(self.frametable,  
                     SIGNAL("Widget.sliderMoved(idx)"),
                     self.fileheader.frameAtIndex(idx))
        self.frameheader=self.fileheader.frameAtIndex(0)
        self.populate()

    def populate(self):
        self.filetable.setRowCount(len(self.fileheader.fileheader_fields))
        self.filetable.setColumnCount(2)
        self.filetable.setHorizontalHeaderLabels(['File Header','value'])
        for i,field in enumerate(self.fileheader.fileheader_fields):
            name=QTableWidgetItem(field)
            value=QTableWidgetItem(unicode(getattr(self.fileheader,field)))
            self.filetable.setItem(i,0,name)
            self.filetable.setItem(i,1,value)

        self.frametable.setRowCount(len(self.frameheader.frameheader_fields))
        self.frametable.setColumnCount(2)
        self.frametable.setHorizontalHeaderLabels(['Frame Header','Value'])
        for i,fields in enumerate(self.frameheader.frameheader_fields):
            Name=QTableWidgetItem(fields)
            Value=QTableWidgetItem(unicode(getattr(self.frameheader,fields)))
            self.frametable.setItem(i,0,Name)
            self.frametable.setItem(i,1,Value) 
```

我知道“连接”是错误的——我对 PyQt 和 Python 很陌生，所以我不太确定从哪里开始。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T04:14:33.937

由于`self.imageBrowser`是您的 Widget 类，因此它将具有具有 sliderMoved 信号的滑块属性。你只需要多几个点。

```
self.imageBrowser.slider.sliderMoved.connect(self.fileheader.frameAtIndex) 
```

你组织它的方式是正确的。您的主窗口组成您的自定义小部件并将连接绑定在一起。

虽然因为您有一个数据源，还有一个需要更新的 QTableWidget，但您可能需要将这些步骤包装成一个小方法：

```
def initUI(self,filename):
    ...
    self.imageBrowser.slider.sliderMoved.connect(self._handle_slider_moved)
    # initialize it the first time during the window set up
    self._handle_slider_moved(0)

def _handle_slider_moved(self, val):
    # update the data source
    self.fileheader.frameAtIndex(val)
    # update the second data source 
    self.frameheader=self.fileheader.frameAtIndex(0)
    # now refresh the tables
    self.populate() 
```

# macos - 在不重新采样图像层的情况下缩放扫描的 PDF

> ID：11512362
> 
> 赞同：3
> 
> 时间：2012-07-16T20:51:47.420
> 
> 标签：macos, unix, pdf, imagemagick, ghostscript

我有一批由扫描页面组成的 PDF（大约 80,000 个文件）。图像层的像素大小与300dpi一致，但似乎设置为72dpi。结果，页面大小显示为 46x35 英寸。我需要调整这些文件，以便将它们注册为 8.5 x 11，或者它们的自然大小，并且我需要能够编写该过程的脚本，以便我可以将其保留在 80,000 个文档上（每个文档 2-5 页。）

我想避免重新采样图像层，因为这可能会增加损失，并显着减慢处理速度。我试过了：

```
convert -density 300x300 input.pdf output.pdf 
```

但它会重新采样图像。我在 ghostscript 上尝试过不同的变体，例如

```
gs \
  -o output.pdf \
  -sDEVICE=pdfwrite \
  -dDownsampleMonoImages=false \
  -dMonoImageResolution=300 \
   input.pdf 
```

这会生成一个文件，但它似乎没有改变，并且仍然注册为超大。此外，页面的大小和方向不同。因此，将它们全部强制为一种尺寸/方向是行不通的。

（仅供参考，我真的不在乎，但下一步是让所有这些文件都有 Acrobat Pro OCR，它的 OCR 会阻塞超过 45 英寸的任何东西。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T07:15:36.250

PDF 是一种与分辨率无关的格式，因此图像的分辨率等无关紧要。页面的“自然大小”是 Acrobat 所说的，这是从文件中的 MediaBox（或 CropBox）信息收集的。

在我看来，原始转换为 PDF 是有问题的，而且文件确实是他们现在声称的（媒体）大小。

我怀疑你可能会得到你需要的结果；您“只是”需要调整文档的大小。问题在于，在媒体尺寸不同的地方（你说他们确实如此），这并非微不足道。

但是，在继续之前，我建议您获取一个您希望为 8.5x11 的文件并尝试以下操作：

```
gs -dBATCH -dNOPAUSE \
   -sDEVICE=pdfwrite \
   -dDEVICEWIDTHPOINTS=612 -dDEVICEHEIGHTPOINTS=792 \
   -dFIXEDMEDIA \
   -dPDFFitPage \
   -sOutputFile=output.pdf \
    input.pdf 
```

这将修复正在使用的媒体为 8.5x11，并告诉 Ghostscript 调整文档大小以适应页面（通过计算和应用比例因子）。除了压缩之外，它不应该影响图像数据，如果有彩色图像，我们可能需要担心 JPEG 伪影，但可以单独处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T10:49:26.157

cpdf -scale-pages usletterportrait in.pdf -o out.pdf

除了将其包装在转换矩阵中以进行缩放之外，不会触及页面内容，并且也会缩放媒体/裁剪/艺术/出血/修剪框。

（商业，恐怕：

[http://www.coherentpdf.com/](http://www.coherentpdf.com/)

免责声明：我写的。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T11:05:35.393

像这样修改您的原始`gs`命令：

```
gs \
  -o output.pdf \
  -sDEVICE=pdfwrite \
  -dPDFFitPage \
  -g6120x7920 \
   input.pdf 
```

然后检查两件事：

1.  页面尺寸现在显示为“字母”（或 612x792 磅或 8.5x11 英寸）。
2.  文件大小与原始文件大小仅略有不同（表明没有对页面图像进行重新采样）。

如果输入是仅以灰度扫描的文档（看起来是这样），则无需设置`-dDownSample*Images`或设置`-d*ImageResolution`。

# php - 限制 PHP 中 shell_script 的执行时间

> ID：11512365
> 
> 赞同：1
> 
> 时间：2012-07-16T20:52:00.600
> 
> 标签：php, linux, shell, shell-exec

我正在使用 PHP 脚本在 Linux 中调用 shell 脚本，我执行以下操作：

```
shell_exec('./shell_script.sh'); 
```

在此之后，PHP 脚本继续运行。所有这些都按预期工作。

但是，有时 shell_script 出于某种原因没有完成执行，所以这里有一个问题：

如何在执行 x 时间后终止 shell_script.sh？应该以某种方式在 PHP 本身中处理这件事（在这种情况下不认为这是可能的）还是应该在 .sh 本身中完成？

所以就在：

```
#!/bin/bash 
```

在 .sh 的开头，如果执行时间可能超过 20 秒，我可以把它终止吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:59:36.293

我不知道你是否可以在 php 中做到这一点，并且在 bash 中可能存在更好的解决方案，但这是你可以做到的：

这是您可以在 20 秒后立即终止`#!/bin/bash`当前脚本的行：

```
(sleep 20 && kill $$) & 
```

bash 将 $$ 替换为当前脚本的 pid。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T12:19:23.247

你可以使用这样的东西：

```
# start timer
( sleep $TIMEOUT ; kill $$ ) 2>/dev/null &
TIMER_PID=$!

# "payload"
echo hello

# cancel timer
kill $TIMER_PID 
```

但是，YMMV 在我的测试中，应该取消计时器的部分有时不会终止`sleep`，程序会一直等到超时结束。

# java - 从 torrent 文件中解析信息

> ID：11512372
> 
> 赞同：2
> 
> 时间：2012-07-16T20:52:27.050
> 
> 标签：java, php, c++

我想从 *.torrent 文件中获取信息。我读过我可以获得所有种子文件的列表，公告，每件的大小和件数。

1.  您能否建议我为服务器端程序提供一个用于 php 的库或类（另一方面，我可以执行 C++/Java 桌面实用程序并在服务器上上传它的输出信息，所以它也适用）以便轻松解析此信息？
2.  我可以获得有关每个文件的偏移量和件数的信息吗？例如，我只想从彼此中选择一个文件。我可以从同行那里获取仅请求此文件的数据吗？

# c# - FindWindow 和 SetForegroundWindow 的替代品？

> ID：11512373
> 
> 赞同：17
> 
> 时间：2012-07-16T20:52:30.510
> 
> 标签：c#, .net, process

我正在寻找使用和`User32.dll`切换到不同应用程序的旧版本的替代方案。`FindWindow()``SetForegroundWindow()`

我确实找到了第一个使用的替代方法，`Process.GetProcessesByName()`但我没有看到相应的方法来切换（设置活动/前台）到该应用程序。

*有没有办法在不使用旧*方法的情况下做到这一点`User32.dll`？

感谢您的帮助。

**编辑**

我接受了@Sorceri 的答案，尽管这不是我想要的答案。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-10-06T10:30:07.620

回答：没有。

但是，为了帮助下一个想找到一个窗口并从 C# 激活它的好奇者，您必须执行以下操作：

```
[DllImport("user32.dll")]
static extern bool SetForegroundWindow(IntPtr hWnd);

void ActivateApp(string processName)
{
    Process[] p = Process.GetProcessesByName(processName);

    // Activate the first application we find with this name
    if (p.Count() > 0)
        SetForegroundWindow(p[0].MainWindowHandle);
} 
```

例如，要将记事本放在前面，您可以调用：

```
ActivateApp("notepad"); 
```

* * *

作为旁注 - 对于那些试图将*应用程序*中的窗口置于前台的人来说，只需调用[Activate() 方法](http://msdn.microsoft.com/en-us/library/system.windows.window.activate.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T21:32:10.007

您可以[`SetActiveWindow`](http://msdn.microsoft.com/en-us/library/ms646311%28v=vs.85%29.aspx)用作`SetForeGroundWindow`. 我想说你应该检查所有的[Windows Manipulation Api Functions](http://msdn.microsoft.com/en-us/library/windows/desktop/ff468919%28v=vs.85%29.aspx)，看看你是否遗漏了一些东西。

另外请注意，您可以`System.Diagnostics.Process`通过`Process.Handle`属性获取对象的句柄。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-06-26T19:11:26.277

SetForeGroundWindow 的替代方法是 VisualBasic 的 AppActivate

像这样称呼它

```
Microsoft.VisualBasic.Interaction.AppActivate("WindowTitle") 
```

Just because it is in the VisualBasic namespace doesn't mean you can't use it in C#.

Full Documentation [here](https://msdn.microsoft.com/en-us/library/x57y7863(v=vs.110).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T21:18:10.627

您可以使用`System.Diagnostics.Process Object`FindWindow 等效项。目前没有 SetForegroundWindow 的等效项。您将希望将 Pinvoke 与 SetForgroundWindow 一起使用。

```
[DllImport("user32.dll")]
static extern bool SetForegroundWindow(IntPtr hWnd); 
```

# javascript - 调用 window.print 在 IE 中不起作用

> ID：11512375
> 
> 赞同：0
> 
> 时间：2012-07-16T20:52:38.253
> 
> 标签：javascript, asp.net

在 asp.net 内容页面中，我有一个超链接，我正在调用 window.print.. 但它不起作用，没有打开打印窗口。

```
<a href="javascript:window.print(); return false;" style="border:none" >
    <input type="image" src="print.png" alt="" />
</a> 
```

任何想法为什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:04:34.777

我建议*不要*在`href`. 试试这个：

```
<a href="#" onclick="window.print(); return false;" style="border:none" >
    <input type="image" src="print.png" alt="" />
</a> 
```

就个人而言，我不喜欢在我的元素中添加任何内联 JavaScript。所以，我会这样做：

CSS：

```
#printPage{
    cursor: pointer;
} 
```

HTML：

```
<input type="image" src="print.png" alt="" id="printPage" /> 
```

JavaScript：

```
document.getElementById('printPage').addEventListener('click', function(){
    window.print();
}); 
```

演示：http: [//jsfiddle.net/J5MBt/](http://jsfiddle.net/J5MBt/)

# wpf - 为自定义控件的自定义属性设置样式

> ID：11512385
> 
> 赞同：0
> 
> 时间：2012-07-16T20:53:18.753
> 
> 标签：wpf, xaml, wpf-controls

在我正在工作的应用程序中，我需要让所有下一个按钮看起来都一样。所以我的计划是制作一种称为下一个按钮样式的样式并根据需要应用。但是我需要将按钮上的一些依赖属性设置为相同。

这是样式的 xmal

```
<Style x:Key="NextButtonStyle" TargetType="diControls:DIButton">
            <Setter Property="Margin" Value="5"></Setter>
            <Setter Property="DIButtonStyle" Value="DIGreenImageButtonWithText_Medium"></Setter>
            <Setter Property="Image" Value="RightArrowIcon_Gray"></Setter>
            <Setter Property="HoverImage" Value="RightArrowIcon_White"></Setter>
            <Setter Property="Command" Value="{Binding Path=NextPressedCommand}"></Setter>
        </Style> 
```

自定义属性 DIButtonStyle、Image 和 HoverImage 都表示调用目标引发了异常。有没有办法解决这个错误？

谢谢！

# php - 选择所有文本区域并添加到一个文本区域

> ID：11512388
> 
> 赞同：0
> 
> 时间：2012-07-16T20:53:29.670
> 
> 标签：php, javascript

您好，我目前正在编写我自己的 javascript/PHP css 编辑器，我让它将文件分解为标签，并将其全部从循环中回显到单独的文本区域中，我想知道是否可以使用 javascript 扫描页面并获取所有内容从所有文本区域并将它们添加到一个变量或一个文本区域中，在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:58:02.350

试试这个：

```
 function getTextAreasText() {
      var all = document.getElementsByTagName("textarea");
        var values = "";
        for(var i=0; i<all.length; i++) {
            values += all[i].value;
        }
      return values;
    }
.
.
.
.
var allTexts = getTextAreasText(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:07:14.030

是的，

如果你熟悉 jquery，这真的很简单。你会做这样的事情：

```
var compiled_content = '';
$.('.name_of_class_to_extract').each(function() {
    compiled_content += $(this).html();
}); 
```

这将为您提供变量compiled_content 中指定类（'name_of_class_to_extract'）的所有HTML 内容。然后，您可以将此内容插入到另一个元素中，例如：

```
$('.class_to_inseert').html(compiled_content); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:12:45.083

```
var a = "";
$("textarea").each(function(){
  a += $(this).text();
  $(this).prepend("<h1>" + "someValue" + "</h1>") //prepend some markup before each textarea
});
a //concatenated data 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-16T21:00:22.857

是的可能。为自己编辑以下几行

```
// jquery code
$(function(){
    $.ajax({
        url : 'get_content_via.php',
        type : 'GET',
        data : 'maybe_use_filename',
        success:function(data){
            var splittedData = data.split("your_seperator"); // like explode
            for( var i = 0 ; i < splittedData.lenght ; i++){
                $('#targetInput').append(splittedData[i]);
            }
        }
    });
}); 
```

# drupal - 文件字段显示我之前上传的文件为 0 字节

> ID：11512399
> 
> 赞同：2
> 
> 时间：2012-07-16T20:54:17.297
> 
> 标签：drupal, drupal-7, drupal-files

这里有点奇怪的问题。我最近开始在一个我最初没有建立的网站上进行维护。Drupal 站点有一堆带有音频文件字段的节点，以及一个播放它们的 jQuery 播放器。在很多节点上播放器没有加载，我意识到这是因为当我编辑节点时文件被报告为 0 字节。我不确定这是为什么。起初我认为这可能是文件权限的问题，但我不认为是这样，因为权限对我来说很好。为了解决这个问题，我所要做的就是重新上传文件。问题是这些文件有数百个，如果可能的话，我想通过进行一次更新来修复它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-22T00:55:35.010

Here is a working version of Terry's pseudocode for Drupal 7.

```
$fids = db_query('SELECT fid FROM {file_managed} WHERE filesize = 0')->fetchCol();

foreach(file_load_multiple($fids) as $file) {
  // Get full path to file.
  $target = drupal_realpath($file->uri);
  // If the file does not exist try the next file.
  if (!file_exists($target)) {
    echo "File $file->uri does not exist." .PHP_EOL;
    continue;
  }
  // Find and store size of file
    $file->filesize = filesize($target);
    // Size of file is
    if ($file->filesize > 0) {
      file_save($file);
    }
    else {
      echo "Size of $file->uri is still zero." . PHP_EOL;
    }
} 
```

Run it with drush:

```
drush php-script fix-file-sizes.php 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T18:58:40.803

我们遇到了同样的问题：数据库中有很多 0 字节的文件。我们所做的看起来像这样：

```
function update_my_filesizes() {
    $fileIDs = db_query('SELECT fid FROM {file_managed) WHERE filesize = 0')->fetchCol();

    foreach(file_load_multiple($fids) as $file) {
        // determine size of file
        $filesize = SIZE_OF_THE_FILE; (pseudocode, we had to use filesize())
        $file->filesize = $filesize;

        if($file->filesize > 0) {        
            file_save($file);
        } else {
            echo "Filesize for file <filename here> is still 0 :(";
        }
    }
} 
```

# php - facebook graph api - 发布大图

> ID：11512409
> 
> 赞同：0
> 
> 时间：2012-07-16T20:54:56.537
> 
> 标签：php, facebook, facebook-graph-api

我终于让 facebooks graph api 在我的粉丝 PAGE 上发布消息，因为`page`
我如何让它将大图像作为帖子而不是链接发布？

`'source' => $photo`似乎创建了一个缩略图

这就是我到目前为止所拥有的

```
<?php

$page_id = 'YOUR-PAGE-ID';
$message = "I'm a Page!";
$photo = "http://www.urlToMyImage.com/pic.jpg";

require '../src/facebook.php';

// Create our Application instance (replace this with your appId and secret).
$facebook = new Facebook(array(
    'appId'  => 'YOUR-APP-ID',
    'secret' => 'YOUR-SECRET-ID',
));

$user = $facebook->getUser();

if ($user) {
    try {
        $page_info = $facebook->api("/$page_id/?fields=access_token");
        if( !empty($page_info['access_token']) ) {
                $facebook->setFileUploadSupport(true); // very important
                $args = array(
                        'access_token'  => $page_info['access_token'],
                        'message'       => $message,
                        'source'        => $photo

                );
                $post_id = $facebook->api("/$page_id/feed","post",$args);
        }
    } catch (FacebookApiException $e) {
        error_log($e);
        $user = null;
    }
}

// Login or logout url will be needed depending on current user state.
if ($user) {
    $logoutUrl = $facebook->getLogoutUrl(array( 'next' => 'http://mydomain.com/logout_page.php' ));
} else {
    $loginUrl = $facebook->getLoginUrl(array('scope'=>'manage_pages,publish_stream'));
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:05:54.317

这里的问题是您实际上并没有发布照片。您正在做的是发布该照片的链接，因此您看到的确实是 Facebook 从该 URL 检索到的缩略图预览图像。

您要做的是提供服务器上以`@`符号为前缀的文件的完整路径。该主题已在网站上进行了很多讨论，因此我将向您指出规范帖子的方向，该帖子处理使用 PHP SDK 将图像上传到 Facebook

[使用 Facebook 的 Graph API 将照片上传到相册](https://stackoverflow.com/questions/2718610/upload-photo-to-album-with-facebooks-graph-api)

代码如下所示 -

```
$facebook->setFileUploadSupport(true);
$params = array('message' => 'Photo Message');
$params['image'] = '@' . realpath($FILE_PATH);
$data = $facebook->api('/me/photos', 'post', $params); 
```

# java - 将 JLayeredPane 引入现有的 JFrame

> ID：11512411
> 
> 赞同：1
> 
> 时间：2012-07-16T20:55:02.430
> 
> 标签：java, swing, jlayeredpane, glasspane, jlayer

我一直在盯着 Oracle 的 JLayeredPane 教程，但它们的布局方式让我感到困惑，并且没有理解我想要做什么。

我有一个应用程序，到目前为止还没有层的概念。一切都布置在一个单层中，在一个 JFrame 内。

我现在想介绍一个零星出现的组件，根据需要，在某个位置，覆盖正常停留在那里的现有组件。我是否必须修改我现有的应用程序 JFrame，以便将其所有顶级内容（即直接添加到 JFrame 的组件）添加到 JFrame 的 JLayeredPane 中？

或者，究竟是什么？

我正在寻找一种简单的方法来调整此 gui 以使用现有 GUI 的最少返工的层。

在此先感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:57:47.230

您可能要考虑在[玻璃窗格](http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html)上绘制覆盖元素。这样你就可以完全保持底层结构不变。

# python - 使用 pyspotify 将歌曲添加到播放列表

> ID：11512412
> 
> 赞同：3
> 
> 时间：2012-07-16T20:55:13.900
> 
> 标签：python, spotify

我正在尝试使用 pyspotify 搜索 spotify 的曲目，然后将最受欢迎的曲目（最相关的搜索结果）添加到特定的播放列表中。我可以用 libspotify 在 c 中做到这一点，如下所示：

```
sp_playlistcontainer *container = sp_session_playlistcontainer(session);
sp_playlist *playlist = sp_playlistcontainer_playlist(container, 66); // 66 is the index of a playlist that I want to add songs to
sp_search *search = sp_search_create(session, "wild ones", 0, 1, 0, 0, 0, 0, 0, 0, SP_SEARCH_STANDARD, &search_complete, NULL);
sp_track *track = sp_search_track(search, 0);
sp_playlist_add_tracks(playlist, (const sp_track **) &track, 1, 0, session); 
```

我将如何使用 pyspotify 有效地做同样的事情？给出的唯一示例是 jukebox.py ，这对于我正在做的事情来说太复杂了。我希望能够在 20 行以下的 python 中实现这一点。

另外，我将如何处理登录 pyspotify？对于 libspotify，我只使用了其中一个示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-25T08:17:59.410

我迟到了两年，但对于未来的读者来说，这大致就是你使用 pyspotify v2.x 执行此操作的方式：

```
import spotify
session = spotify.Session()
# Login, etc.
playlist = session.playlist_container[66]
search = session.search('wild ones')
search.loaded_event.wait()
track = search.tracks[0]
playlist.add_tracks(track) 
```

# python - Python os.getcwd() 在路径中返回波浪号。例如 C:\MYFOLD~1\test

> ID：11512413
> 
> 赞同：4
> 
> 时间：2012-07-16T20:55:34.160
> 
> 标签：python, path, directory, tilde, getcwd

如何让 python 返回 C:\myfolderisafolder\test 的完整路径名？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T21:59:25.290

```
E:\dev>cd VARESE~1

E:\dev\VARESE~1>python
>>> import os
>>> os.getcwd()
'E:\\dev\\VARESE~1'
>>> exit()

E:\dev\VARESE~1>cd ..
E:\dev>cd VAResearchDemo

E:\dev\VAResearchDemo>python
>>> import os
>>> os.getcwd()
'E:\\dev\\VAResearchDemo'
>>> exit() 
```

如您所见，如果我`python`在`VARESE~1`目录中运行，则`os.getcwd()`返回短路径。如果我`python`在同一个目录中运行但路径很长，它会返回长路径。

因此，您应该尝试运行`python`（`C:\myfolderisafolder\test`检查链接的属性或运行方式）。

但是如果需要*把*短路径转换成长路径，就得调用win32的`GetLongPathName`函数了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:03:49.760

尝试使用`os.path.realpath`, `os.path.normpath`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T02:24:10.667

也许这会有所帮助：

```
fullpath = os.path.expanduser('~/my/path') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T13:06:01.080

您可以在波浪号处使用 .split() 拆分字符串，然后使用 .join() 方法重新加入完整的文件路径。

# mysql - MySQL小于语法

> ID：11512415
> 
> 赞同：0
> 
> 时间：2012-07-16T20:55:43.850
> 
> 标签：mysql

谁能明白为什么这个 MySQL 命令会抛出错误？

```
DELETE FROM mytable WHERE SUM(mycolumn) < 15.0; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:58:07.160

简而言之，`Sum`是一个聚合函数，而`DELETE`对单个记录进行操作。

# c# - 搜索 SQL 数据库并返回其列包含特定值的行

> ID：11512417
> 
> 赞同：-1
> 
> 时间：2012-07-16T20:55:51.540
> 
> 标签：c#, sql-server, database, search

更新澄清

[不久前我在这里](https://stackoverflow.com/questions/11145486/searching-an-array-for-combinations-of-values)发布了一个类似的问题，它使用了 Matlab（和 Matlab GUI）。

但是，现在我正在尝试做同样的事情，但通过 Windows 窗体、C# 和已填充数据的本地静态数据库文件来实现。

数据库中的数据如下：

```
Compound_ID    Component1    Component2    Component3    Value
int            string        string        string        int 
```

约 24,000 行数据。

第一列“Compound_ID”是主键。接下来的三列，“Component1”、“Component2”和“Component3”，分别包含一组约 100 个可能组件中的一个组件。每个化合物由 100 个组中的 3 个不同组件组成。组件的顺序无关紧要，因此化合物是 3 个组件的组合（不同于排列）。例子：

```
Compound_ID    Component1    Component2    Component3    Value
1456           a            b              c             10
1457           a            b              m             50
1458           a            c              g             25 
```

等等。从这个例子中，我们知道数据库中永远不会有另一个化合物是“ag c”或其任何其他排列，因为顺序无关紧要（100 个值的列表将生成约 161,000 个 3 的组合，但几乎有 1,000,000 个 3) 的排列。

用户将在 Windows 窗体上选择一些组件（带有复选框列表或电子表格）。他们将按下表格上的按钮。该按钮将调用一个方法来查找数据库中列出的所有化合物，这些化合物可以从用户选择的组件列表中生成。此数据将显示在同一表单上的 dataGridView 中。

一种可能完成的方法（类似于我之前帖子中另一个用户描述的 Matlab 解决方案）：生成 3 个逻辑数组，每列一个，其中“1”表示包含 15 个组件之一的行。将列加在一起，只有那些值为“3”的行是我要查找的行。然后构建一个包含这些行的新表，并在 datagridview 中显示。有关此代码外观的任何提示都会有所帮助。

我将尝试一些已经提供的解决方案。这将涉及找出一种从 C# 调用 SQL 查询的方法，我被告知可以查找，并且已经提供了一个示例。

感谢大家的帮助。这是一个出于好奇而产生的完全独立的项目，所以这不是严肃的事情，我只是想弄清楚。我对 C#（当然是 SQL 查询）比较陌生，所以请原谅我的无知。如果这会更好地利用每个人的时间，请向我指出一些解释的来源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:04:03.770

```
Select ct.*
From costtable ct
Where ct.Col1 <> ct.Col2 and ct.Col2 <> ct.Col3 and
ct.Col1 in ('Test1', 'Test2', 'Test3') and
ct.Col2 in ('Test1', 'Test2', 'Test3') and
ct.Col3 in ('Test1', 'Test2', 'Test3') 
```

我不确定您的用例，但是重复的组件可能吗？像 Col1 和 Col2 具有相同的值？

这是您可以使用的 SqlFiddle： [http ://sqlfiddle.com/#!3/46944/1/0](http://sqlfiddle.com/#!3/46944/1/0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:04:46.513

像这样的东西，其中@a、@b、@c 是您寻求的值

```
select 
*
from
table
where
(
case col1 when @a then 1 when @b then 2 when @c then 4 else 0 end
+ case col2 when @a then 1 when @b then 2 when @c then 4 else 0 end
+ case col3 when @a then 1 when @b then 2 when @c then 4 else 0 end
      ) = 7 
```

与简单的`IN`解决方案不同，这将确保组合的唯一性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T18:37:38.050

这是最终完成我需要的代码。它结合了[LittleBobbyTables 的 SQL 查询](https://stackoverflow.com/a/11512537/1470783)和[GrayFox374 的 C# 代码](https://stackoverflow.com/a/11512561/1470783)来实现该查询。我会赞成你们两个，但显然我还没有这样做的影响力！

```
class Program
{
    static void Main(string[] args)
    {
        List<string> components = new List<string>();
        components.Add("Ing1");
        components.Add("Ing2");
        components.Add("Ing3");
        components.Add("Ing5");
        components.Add("Ing9");

        StringBuilder sb1 = new StringBuilder();
        sb1.Append("(");

        foreach (string s in components)
        {
            string stemp = "'" + s + "'" + ",";
            sb1.Append(stemp);
        }

        int start = sb1.ToString().Length - 2;

        sb1.Replace(",", ")", start, 2);

        List<Result> results = new List<Result>();

        SqlConnection con = new SqlConnection("Data Source=.\\SQLEXPRESS;AttachDbFilename=C:\\dbTestCSV.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True");
        StringBuilder sb = new StringBuilder();
        sb.Append("SELECT [Numbers], [Col1], [Col2], [Col3], [Col4], [Col5]");
        sb.Append("FROM Table1 ");
        sb.Append("WHERE [Col1] IN ");
        sb.Append(sb1.ToString());
        sb.Append(" AND [Col2] IN ");
        sb.Append(sb1.ToString());
        sb.Append(" AND [Col3] IN ");
        sb.Append(sb1.ToString());

        SqlCommand cmd = new SqlCommand(sb.ToString(), con);
        try
        {
            con.Open();
            cmd.CommandType = System.Data.CommandType.Text;

            SqlDataReader dr = cmd.ExecuteReader();
            if (dr.HasRows)
            {
                while (dr.Read())
                {
                    results.Add(new Result(Convert.ToInt32(dr[0].ToString()), dr[1].ToString(), dr[2].ToString(), dr[3].ToString(), dr[4].ToString(), dr[5].ToString()));
                }
            }
            dr.Close();
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message.ToString());
        }
        finally
        {
            con.Close();
        }

        foreach (Result res1 in results)
        {
            Console.WriteLine(res1.PK.ToString());
        }
        Console.ReadLine();
        //process/present results at this point

    }

}

public class Result
{
    public int PK { get; set; }
    public string Col1 { get; set; }
    public string Col2 { get; set; }
    public string Col3 { get; set; }
    public string Col4 { get; set; }
    public string Col5 { get; set; }

    public Result(int pk, string col1, string col2, string col3, string col4, string col5)
    {
        PK = pk; Col1 = col1; Col2 = col2; Col3 = col3; Col4 = col4; Col5 = col5;
    }
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-16T21:05:49.120

我觉得这就是：

更新

数据库表值

```
PKID    Col1        Col2        Col3        Cost 
1   Helium      Oxygen      Nitrogen    10
2   Hydrogen    Chlorine    Sodium      10 
3   Chlorine    Sodium      Gold        10
4   Hydrogen    Carbon      Potassium   10 
5   Carbon      Silicon     Boron       10
6   Uranium     Cesium      Plutonium   10 
7   Titanium    Iodine      Fluorine    10
8   Helium      Neon        Argon       10 
9   Krypton     Xenon       Radon       10
10  Barium      Chromium    Calcium     10 
11  Helium      Lithium     Sodium      10 
```

因此，如果您选择氦、氧、氮、钡、铬、钙和铀，您应该得到 PKID 为 1 和 10 的行，仅此而已。对？

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void btnFind_Click(object sender, EventArgs e)
    {            
        List<Component> results = new List<Component>();

        foreach (object itemChecked in checkedListBox1.CheckedItems)
        {
            var cn = new OdbcConnection(@"Driver={Microsoft Access Driver (*.mdb)};Dbq=C:\elements.mdb;Uid=Admin;Pwd=;");
            StringBuilder sb = new StringBuilder();
            sb.Append("SELECT [PKID], [Col1], [Col2], [Col3], [Cost] ");
            sb.Append("FROM components ");
            sb.Append("WHERE ? IN (Col1, Col2, Col3) ");
            var cm = new OdbcCommand(sb.ToString(), cn);
            try
            {
                cn.Open();
                cm.CommandType = System.Data.CommandType.Text;
                cm.Parameters.AddWithValue("?", itemChecked.ToString());
                OdbcDataReader dr = cm.ExecuteReader();
                if (dr.HasRows)
                {
                    while (dr.Read())
                    {
                        var comp = new Component(Convert.ToInt32(dr[0].ToString()),
                            dr[1].ToString(), dr[2].ToString(), dr[3].ToString(), Convert.ToInt32(dr[4].ToString()));

                        Component r = results.Find(
                            delegate(Component c)
                            {
                                return c.CompoundID == Convert.ToInt32(dr[0].ToString());
                            }
                            );
                        if (r != null)
                        {
                            //update the frequency
                            var obj = results.FirstOrDefault(x => x.CompoundID == comp.CompoundID);
                            if (obj != null) obj.Frequency++;
                        }
                        else { results.Add(comp); }
                    }
                }
                dr.Close();
            }
            catch (Exception ex) { Console.WriteLine(ex.Message); }
            finally { cn.Close(); }
        }

        //process/present results at this point
        //for each result in list with freq >= 3, output to grid
        IEnumerable<Component> rowsWithThreeHits = results.Where(cFreq => int.Equals(cFreq.Frequency, 3))
            .Select(x => new Component { CompoundID = x.CompoundID, Component1 = x.Component1, 
                Component2 = x.Component2, Component3 = x.Component3, CompoundValue = x.CompoundValue });
        List<Component> final = new List<Component>(rowsWithThreeHits);
        dataGridView1.DataSource = final;
    }        
}

public class Component
{
    public int CompoundID { get; set; }
    public string Component1 { get; set; }
    public string Component2 { get; set; }
    public string Component3 { get; set; }
    public int CompoundValue { get; set; }
    public int Frequency { get; set; }

    public Component() {}

    public Component(int compoundID, string component1, string component2, string component3, int compoundValue)
    {
        CompoundID = compoundID; 
        Component1 = component1;
        Component2 = component2;
        Component3 = component3;
        CompoundValue = compoundValue;
        Frequency = 1;
    }
} 
```

我使用 Access 是因为我们在这里不使用 SQL Server，但是您可以将 ODBC 对象换成 SQL 对象，并且它可以工作。

![带有结果的 UI 屏幕截图](../Images/8ea4dd156ba61e3763ea58419bf69a44.png)

# scala - 如何使用 Scala 对关系数据库链接表进行建模？

> ID：11512421
> 
> 赞同：2
> 
> 时间：2012-07-16T20:56:00.413
> 
> 标签：scala, scalaquery

我需要在 Scala 中做很多多对多的对象映射并将其保存到关系数据库中。

这是一个简化问题的假示例：

假设我们要为教室和学生建模。一个教室可能有很多学生，但这些学生也可以去不同的房间。从关系数据库模型的角度来看，您将创建 3 张表，一张用于 ROOM，一张用于 STUDENT，一张用于链接学生和房间，ROOM_STUDENT。

假设表格如下所示：

```
ROOM
-----
id
subject

STUDENT
-------
id
name

ROOM_STUDENT
-------------
room_id
student_id 
```

如果我想使用 Scala 来访问（并且可能创建）这样的数据库，那么如何使用 ScalaQuery 或 SLICK 来做到这一点，或者是否有更好的 Scala 解决方案？我应该以某种方式使用案例类，还是以某种方式使用普通的旧 SQL？

我基本上希望这里有两个提示，1\. 一种在 Scala 中呈现 STUDENT 和 ROOM 的好方法，2\. 针对这个问题的关系数据库持久性的一些想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:31:46.730

为此，我个人更喜欢[Lift 的 Mapper 库](http://www.assembla.com/spaces/liftweb/wiki/Mapper/)，并且偶尔会在 Lift Web 应用程序的上下文之外使用它。以下是一个完整的工作示例，您可以从中运行`sbt`，例如，将以下内容作为您的`build.sbt`：

```
libraryDependencies ++= Seq(
  "net.liftweb" %% "lift-mapper" % "2.4" % "compile->default",
  "com.h2database" % "h2" % "1.2.127"
) 
```

首先是模型：

```
import net.liftweb.common._, net.liftweb.mapper._

object Student extends Student with LongKeyedMetaMapper[Student]
class Student extends LongKeyedMapper[Student] with IdPK with ManyToMany {
  def getSingleton = Student
  object name extends MappedString(this, 40)
  object rooms extends MappedManyToMany(
    StudentRoom, StudentRoom.student, StudentRoom.room, Room
  )
}

object Room extends Room with LongKeyedMetaMapper[Room]
class Room extends LongKeyedMapper[Room] with IdPK with ManyToMany {
  def getSingleton = Room
  object subject extends MappedString(this, 40)
  object students extends MappedManyToMany(
    StudentRoom, StudentRoom.room, StudentRoom.student, Student
  )
}

object StudentRoom extends StudentRoom with LongKeyedMetaMapper[StudentRoom] {
  override def dbIndexes = Index(student, room) :: super.dbIndexes
}

class StudentRoom extends LongKeyedMapper[StudentRoom] with IdPK {
  def getSingleton = StudentRoom
  object student extends MappedLongForeignKey(this, Student)
  object room extends MappedLongForeignKey(this, Room)
} 
```

还有一些数据库设置：

```
DB.defineConnectionManager(
  DefaultConnectionIdentifier,
  new StandardDBVendor("org.h2.Driver", "jdbc:h2:mem:example", Empty, Empty)
)

Schemifier.schemify(true, Schemifier.infoF _, Student, Room, StudentRoom) 
```

还有一些数据：

```
val m = Student.create.name("Mary"); m.save
val j = Student.create.name("John"); j.save
val physics = Room.create.subject("Physics"); physics.save
StudentRoom.create.student(m).room(physics).save
StudentRoom.create.student(j).room(physics).save 
```

我们准备好了：

```
scala> Room.findAll(By(Room.subject, "Physics")).flatMap(_.students)
res7: List[Student] = List(Student={name=Mary,id=2}, Student={name=John,id=3}) 
```

# java - 为什么 log4j 根记录器不接收我对其附加器之一所做的更改？

> ID：11512422
> 
> 赞同：1
> 
> 时间：2012-07-16T20:56:08.050
> 
> 标签：java, logging, log4j

我有一个 Java 程序，它会每小时扫描一次日志文件，并在检测到错误时向 IT 发送电子邮件。记录器是使用 log4j.properties 文件配置的。

现在，我想在运行时更改电子邮件的收件人。代码如下所示：

```
SMTPAppender smtp = (SMTPAppender)(logger.getAppender("smtp"));
smtp.activateOptions();
smtp.setTo(email);
logger.removeAppender("smtp");  // I tried it with or without the two lines
logger.addAppender(smtp);       // It's the same result 
```

当我调试它时，我可以在堆栈上看到 smtp 的 To 字段确实是我想要的电子邮件地址，但是当我`logger.error(message);`稍后调用它时，它仍然发送到配置文件中指定的电子邮件地址。

谁能告诉我为什么会这样？我知道我可以在运行时以编程方式创建 smtp appender，但我想知道是否有办法混合编程配置和属性文件配置。

# arrays - 将多维数组传递给函数

> ID：11512426
> 
> 赞同：2
> 
> 时间：2012-07-16T20:56:32.363
> 
> 标签：arrays, function, powershell, parameters, multidimensional-array

我有一个多维整数数组，它只能在函数内部工作，但是当我尝试将它传递给另一个函数时会产生随机数。

```
PS> $array
1
2
3
4
PS> $array[0]
1
2
PS> $array[0][1]
2 
```

该数组最初是由以下组成的：

```
$array = @(($data1),($data)) 
```

并附加到 $data 之后的任何数组：（每次迭代都会清除 $data）

```
$array += ,($data) 
```

这似乎很好，考虑到在我尝试创建函数之前一切正常。然后我尝试将数组传递给另一个函数

```
theFunc ($array)
    Function theFunc {
    param ($theData)
    #process data
    } 
```

我得到了正确数量的数组，但其中的数字与我传入的多维数组不匹配。任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:08:11.360

我尝试了以下示例，一切似乎都很好：

```
$data1 = @(1, 2, 3, 4)
$data2 = @(5, 6, 7, 8)
@($data1, $data2)
$array[0]
1
2
3
4
$array[1]
5
6
7
8
function myFunc { param($arr) $arr; $arr[0]; $arr[1]; }
myFunc($array)
1
2
3
4
5
6
7
8
1
2
3
4
5
6
7
8 
```

请提供你得到的输出。

# ios - NSURLConnection sendAsynchronousRequest：不发起请求

> ID：11512427
> 
> 赞同：1
> 
> 时间：2012-07-16T20:56:38.567
> 
> 标签：ios, ios5

我有一些看起来应该可以工作的代码，它尝试发送异步请求，但从未生成请求：

这是功能：

```
-(void) setEmail: (NSString *) subject andBody: (NSString *) body
{
    NSString *urlString = @"http://www.my_url.com?";     

    // Create encoded query string
    NSString *query_string = @"subject=%@&body=%@";
    NSString *query_with_args = [NSString stringWithFormat:query_string , subject , body];     

    // Now encode the query
//    NSString *encodedQuery = (__bridge NSString *)CFURLCreateStringByAddingPercentEscapes(NULL,
//                                                                                           (__bridge CFStringRef)query_with_args,
//                                                                                           NULL,
//                                                                                           (CFStringRef)@"!*'();:@&=+$,/?%#[]",
//                                                                                           kCFStringEncodingUTF8);
//

    // Now concatinate url and query    
    NSString *final_url = [urlString stringByAppendingString:query_with_args];

    NSURL *url = [NSURL URLWithString:final_url];

    // Now send to the server    
    NSURLRequest *urlRequest = [NSURLRequest requestWithURL:url];

    // TODO: ok I dont really understand what this is
    NSOperationQueue *queue = [[NSOperationQueue alloc] init];

    NSLog(@"......before request");

    [NSURLConnection sendAsynchronousRequest:urlRequest queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
     {         
         NSLog(@"On return");

         NSLog(@"This is data: %@" , data);
         NSLog(@"This is response: %@" , response);
         NSLog(@"This is error: %@" , error);

         NSLog(@"OK");         
     }];        
} 
```

知道这里可能出了什么问题以及为什么永远不会发送请求吗？记录器与

NSLog(@"......请求前"); 确实被打印了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:16:20.820

像这样尝试..您需要在其中实现`NSURLConnectionDelegate`协议和方法。

```
NSString *final_url = [NSString stringWithFormat:@"http://www.my_url.com?subject=%@&body=%@",subject, body];
NSURL *url = [NSURL URLWithString:final_url];
NSMutableURLRequest *theRequest = [NSMutableURLRequest requestWithURL:url];
NSURLConnection *theConnection = [[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
    if( theConnection )
    {
        webData = [NSMutableData data];
    }
    else
    {
        NSLog(@"theConnection is NULL");
    }
} 
```

希望这个对您有所帮助.. [http://www.cocoaintheshell.com/2011/04/nsurlconnection-synchronous-asynchronous/](http://www.cocoaintheshell.com/2011/04/nsurlconnection-synchronous-asynchronous/)

# java - 如何创建类似 GMail.app 的菜单

> ID：11512432
> 
> 赞同：1
> 
> 时间：2012-07-16T20:57:13.357
> 
> 标签：java, android, android-4.2-jelly-bean

我是 Android 编程的新手，但在这方面取得了稳步进展。我的应用程序有几个活动，我想向它添加一个类似 GMail.app 的菜单。

![在此处输入图像描述](../Images/8279c5cddfdc5582ff221ed845e20044.png)

如果有人能给我一个提示，我应该在 API 文档中搜索什么来创建这样的菜单，那将是非常惊人的。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:02:43.520

您可以从创建自定义`Menu`. [在这里](http://developer.android.com/guide/topics/ui/menus.html)阅读它。为了让你的菜单看起来像某种方式，你会想要弄乱`Themes`and `Styles`。您可以在[此处](http://developer.android.com/guide/topics/ui/themes.html)找到有关该内容的基本教程。您的问题有点宽泛，所以我无法提供具体的代码示例，但这些链接应该能让您顺利上路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:14:41.660

在这种情况下，您要特别寻找的是`ActionBar`下拉导航模式（请参阅[文档`ActionBar`）](http://developer.android.com/guide/topics/ui/actionbar.html#Dropdown)。当然，这仅适用于 API 级别 11 及更高级别，因为它涉及 ActionBar。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:44:44.297

如果您的目标是 API 11 或更高版本，您可以使用 ActionBar。如果你也想为旧版 Android 设备提供相同的 UI，你可以[试试 ActionBarSherlock](http://actionbarsherlock.com/index.html)。这是[有关如何使用它的教程](http://collegewires.com/android/2012/07/implementing-action-bar-in-pre-honeycomb-devices/)。

# php - 如何在php中处理实体的空对象

> ID：11512433
> 
> 赞同：0
> 
> 时间：2012-07-16T20:57:13.660
> 
> 标签：php, design-patterns, orm, entity

我有一个从 MySQL 数据库映射记录的实体类。例如，继承实体类的用户类将映射表用户。

```
class User extends Entity
{
    function init(){ $this->_table = 'user';}
} 
```

当我使用 id 30 映射对象时，我使用

```
$user = new User(30); 
```

当对象 id 30 不可用（假设它被删除）时，最好的处理方法是什么。

1.  抛出异常，“此对象不可用”
2.  返回一个空对象。

一个或一组具有优点/缺点的解决方案将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:59:20.273

我喜欢在这种情况下使用异常，因为异常可能包含对象不可用的各种原因。一个你不知道的空对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:59:51.800

抛出异常意味着您的应用程序中发生了异常情况。在我看来，具有特定 ID 的对象不存在并不是特殊情况。我会返回一个空对象。

抛出/捕获异常的机制会带来性能损失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:22:49.633

我个人更喜欢返回带有错误代码属性的对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T20:59:33.920

抛出异常。这样，您可以在尝试构建 User 对象的任何地方捕获它，并决定在那里做什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T21:27:57.627

如果不知道程序的设计，例如这些“ID”的来源、生成方式等，很难说。
这里的优缺点取决于您的程序设计和您对给定情况的需求. 一旦你评估了这些，你就可以确定什么是最适合你的。

# r - 合并矩阵中具有相同列名的列

> ID：11512441
> 
> 赞同：4
> 
> 时间：2012-07-16T20:57:53.887
> 
> 标签：r, aggregate

我有一个矩阵，其中的列重复字符列名。

```
set.seed(1)
m <- matrix(sample(1:10,12,replace=TRUE), nrow = 3, ncol = 4, byrow = TRUE,
       dimnames = list(c("s1", "s2", "s3"),c("x", "y","x","y")))

m
   x y  x  y
s1 3 4  6 10
s2 3 9 10  7
s3 7 1  3  2 
```

我需要将具有相同列名的所有列汇总为一列，即

```
m <- matrix(c(9,14,13,16,10,3), nrow = 3, ncol = , byrow = TRUE,dimnames = list(c("s1", "s2", "s3"),c("x", "y")))

    x  y
s1  9 14
s2 13 16
s3 10  3 
```

我玩过聚合函数中的简单总和，但没有任何运气。有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T21:26:30.303

好吧，这个解决方案不会因为代码的透明性而赢得任何奖项，但我更喜欢它：

```
nms <- colnames(m)
m %*% sapply(unique(nms),"==", nms)
#     x  y
# s1  9 14
# s2 13 16
# s3 10  3 
```

* * *

它通过构造一个矩阵来工作，该矩阵形成`m`' 列的适当线性组合。要查看它是如何工作的，请将第二行分成两个分量矩阵，使用 相乘`%*%`，如下所示：

```
 -          -      -   -
|  3 4  6 10 |    | 1 0 |
|  3 9 10  7 |    | 0 1 |
|  7 1  3  2 |    | 1 0 |
 -          -     | 0 1 |
                   -   - 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-16T21:24:43.580

```
nms <- colnames(m)
sapply(unique(nms), function(i)rowSums(m[, nms==i]))

   x  y
s1  9 14
s2 13 16
s3 10  3 
```

# sql - 如何摆脱选择查询返回数据中的双列表

> ID：11512443
> 
> 赞同：0
> 
> 时间：2012-07-16T20:58:04.513
> 
> 标签：sql, sql-server

我有两张桌子：

```
Tasks[id_task,task_title,author,id_project]
SubTasks[id_subtask,subtask_title,author,id_task] 
```

我使用这个查询来返回数据：

```
Select PS.task_title as subtask_category, PS.id_task, PS.id_project, P.* 
  From SubTasks P inner join Tasks PS 
    on P.id_task=PS.id_task 
 where PS.id_project = 1  
 order by PS.id_task desc 
```

问题是结果表包含重复的 id_task 列，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:00:39.840

如果您知道 SubTasks 表总是会`PS.id_task`从选择中删除 id_task （因为加入而这样做），那么它只会被`P.*`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:03:35.813

将您的`SELECT`子句更改为`SELECT PS.id_task, PS.task_title, PS.author, PS.id_project, P.id_subtask, P.subtask_title, P.author`并去掉`P.id_task`. 当您之前已经告诉查询返回 Tasks 表中的 PS.id_task 时，您`P.*`正在告诉查询返回 SubTasks 表中的所有列。

# java - 在调用另一个方法之前等待 SwingWorker.isDone()

> ID：11512445
> 
> 赞同：0
> 
> 时间：2012-07-16T20:58:07.600
> 
> 标签：java, synchronization, swingworker

我有一个程序，我正在加载文件，同时我正在显示一个窗口以通知用户正在加载文件。我决定创建一个 FileLoader 类，它是一个 SwingWorker，它实际处理加载文件，以及一个实现 PropertyChangeListener 的 ProgressWindow，以通知用户传递给它的 SwingWorker 的状态。

我的代码目前如下所示：

```
FileLoader loader = new FileLoader(filePath);
new ProgressWindow(loader, "Loading File", "Loading File");
//ProgressWindow's constructor calls loader.execute() inherited from SwingWorker
doc = loader.getFile(); 
```

问题是我有一个竞争条件。ProgressWindow 被构造，它调用 loader.execute()，然后运行它的东西直到任务完成。我原本希望在上面的代码继续运行之前完成所有工作，但是在加载程序的执行方法运行时它会继续运行，从而导致竞争条件。

我试过阅读 Java 同步的东西，但我很难理解它。我要做的就是等到 FileLoader 的 isDone() 方法返回 true，然后继续 loader.getFile() 行。有没有简单的方法来做到这一点？或者就此而言，这是最好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:08:59.943

好吧，我找到了原始问题的答案，即使出现了另一个问题。我发现我可以从`SwingWorker<Void,Void>`to更改`SwingWorker<File,File>`，然后使用内置的 get() 方法返回文件（它会自动等待 Swingworker 完成）。这解决了我的并发问题。然而，GUI 最终在这个过程中被锁定，但这似乎是另一个问题。

# node.js - 强制 Heroku 将 App 视为 Node.js

> ID：11512446
> 
> 赞同：2
> 
> 时间：2012-07-16T20:58:12.393
> 
> 标签：node.js, heroku

我有一个尝试部署到 Heroku 的 Node.js 应用程序。然而，Heroku 似乎认为它是一个 Ruby 应用程序，可能是因为它有一个 Gemfile（我们有一个包含一些自定义脚本等的私有 gem，以及用于命令行控制的 Heroku gem 本身）。我将 Gemfile 和 Gemfile.lock 添加到 .slugignore（在[Heroku 的 Slug Compiler 文章](https://devcenter.heroku.com/articles/slug-compiler)中讨论），但该应用程序仍被检测为 Ruby 应用程序。

```
$ git push heroku master
Total 0 (delta 0), reused 0 (delta 0)

-----> Heroku receiving push
-----> Ruby app detected
-----> Installing dependencies using Bundler version 1.2.0.pre
       Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment 
```

捆绑包失败了，因为我们的自定义 gem 是一个私人仓库，我再也没有得到任何进一步的信息。我找不到任何方法来强制 Heroku 将应用程序视为 Node.js 应用程序并使用 Procfile 启动 Web 应用程序。有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:00:38.740

好吧，废话，我一定是看的不够远。这已经[在 Stack Overflow 上](https://stackoverflow.com/questions/10008200/heroku-wrongly-detecting-my-node-app-as-a-ruby-app?rq=1)被问过了，答案是使用自定义的 Node.js 构建包，例如：

```
heroku config:add BUILDPACK_URL=https://github.com/heroku/heroku-buildpack-nodejs.git 
```

# jquery - 验证至少一个复选框

> ID：11512448
> 
> 赞同：11
> 
> 时间：2012-07-16T20:58:13.930
> 
> 标签：jquery, asp.net-mvc-3, jquery-validate

我已经看到其他几个有相同问题的帖子，但无法找到适合我的解决方案，所以我发布了我自己的问题。

让我先说我是 JQuery 和 MVC 的新手。我有 3 个复选框，我需要确保至少其中一个被选中。我有一些正在使用 Jquery 自定义验证的东西。但它在验证摘要中显示 3 条消息。我希望它只显示一条消息，如果可能的话不在验证摘要中。我怎么能做到这一点？

html代码

```
<label for="river1">river1</label>
<input checked="checked" class="checkbox" data-val="true" data-val-required="The     river1 field is required." id="river1" name="river1" type="checkbox" value="true" />
<input name="river1" type="hidden" value="false" /><br />

<label for="river2">river2</label>
<input checked="checked" class="checkbox" data-val="true" data-val-required="The river2 field is required." id="river2" name="river2" type="checkbox" value="true" />
<input name="river2" type="hidden" value="false" /><br />

<label for="river3">river3</label>
<input checked="checked" class="checkbox" data-val="true" data-val-required="The river3 field is required." id="river3" name="river3" type="checkbox" value="true" />
<input name="river3" type="hidden" value="false" /><br /> 
```

jQuery

```
$.validator.addMethod("checkbox", function (value, element) {
  return $('.checkbox:checked').length > 0;
  }, 'At least one river must be selected.'); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-16T21:10:24.913

**工作演示** [http://jsfiddle.net/RGUTv/](http://jsfiddle.net/RGUTv/)

**更新**- 2015 年 1 月 12 日 => [http://jsfiddle.net/r24kcvz6/](http://jsfiddle.net/r24kcvz6/) CDN 已更改[http://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.1/jquery.validate.js](http://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.1/jquery.validate.js) - 您可以复制通过取消选择所有复选框并单击`submit`按钮来进行行为。

*   [http://jqueryvalidation.org/#latest-files-on-jsdelivr-cdn-%28hotlinking-welcome%29](http://jqueryvalidation.org/#latest-files-on-jsdelivr-cdn-%28hotlinking-welcome%29)：

**代码**

```
$.validator.addMethod('require-one', function(value) {
    return $('.require-one:checked').size() > 0;
}, 'Please check at least one box.');

var checkboxes = $('.require-one');
var checkbox_names = $.map(checkboxes, function(e, i) {
    return $(e).attr("name")
}).join(" ");

$("#itemForm").validate({
    groups: {
        checks: checkbox_names
    },
    errorPlacement: function(error, element) {
        if (element.attr("type") == "checkbox") error.insertAfter(checkboxes.last());
        else error.insertAfter(element);
    }
}); 
```

**html**

```
<form name="itemForm" id="itemForm" method="post">

<label for="river1">river1</label>
<input checked="checked" data-val="true" data-val-required="The     river1 field is required." id="river1" name="river1" type="checkbox" value="true" class="require-one" />
<input name="river1" type="hidden" value="false" /><br />

<label for="river2">river2</label>
<input checked="checked" data-val="true" data-val-required="The river2 field is required." id="river2" name="river2" type="checkbox" value="true" class="require-one" />
<input name="river2" type="hidden" value="false" /><br />

<label for="river3">river3</label>
<input checked="checked" data-val="true" data-val-required="The river3 field is required." id="river3" name="river3" type="checkbox" value="true" class="require-one" />
<input name="river3" type="hidden" value="false" /><br />

<input type="submit" />
</form> 
```

**图片**如果你取消勾选验证将触发

![在此处输入图像描述](../Images/da91f15c177c39dc176cc9bfcf6ac956.png)

# asp.net - 在 SQL SUM 语句中设置精度

> ID：11512453
> 
> 赞同：0
> 
> 时间：2012-07-16T20:58:26.680
> 
> 标签：asp.net, sql, oracle, gridview, sum

我有一个我也在划分的 SQL SUM，但我想将精度设置在第十位，例如 10.1 而不是 10.12。你会怎么做呢？这是我的 SQL 语句：

```
 SELECT DISTINCT PAINT_LINE, SUM(HOURS_REQUIRED/WORKING_DAYS) AS HOURS_REQUIRED,
  TO_CHAR(WEEK_START, 'YYYY/MM/DD') AS WEEK_START FROM 
 DCSI.PAINTYEARLYPAINTHRSPROJECTIONS WHERE USER_ID = :UserID AND WEEK_START>=SYSDATE-7
  AND WEEK_START<=SYSDATE+63 GROUP BY WEEK_START, PAINT_LINE ORDER BY WEEK_START DESC, PAINT_LINE 
```

我想将 HOURS_REQUIRED 设置为十分之一的精度，但我不知道该怎么做。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:08:42.553

尝试：

ROUND(SUM(HOURS_REQUIRED/WORKING_DAYS),1) 作为 HOURS_REQUIRED

看：

[http://msdn.microsoft.com/en-us/library/ms175003.aspx](http://msdn.microsoft.com/en-us/library/ms175003.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T21:23:17.367

最好的方法是将其转换为具有正确精度的数字：

```
cast(<val> as numeric(8,1)) 
```

例如。

在你的情况下，这将是：

```
cast(SUM(HOURS_REQUIRED/WORKING_DAYS) as numeric(8, 1)) AS HOURS_REQUIRED 
```

# javascript - 按组追加结果

> ID：11512457
> 
> 赞同：2
> 
> 时间：2012-07-16T20:58:41.980
> 
> 标签：javascript, jquery

我有一个简单的函数，我试图按组附加结果。我已经能够显示单个表单的结果，但不确定从哪里继续。这是 Jsfiddle 上的功能。[http://jsfiddle.net/XBSVn/](http://jsfiddle.net/XBSVn/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:12:38.980

尝试这个。请注意，您的类名之间存在差异，并且您的选择器仅选择第一个输入元素：

```
$(function() {
    $('.ratingroups input').each(function(i, v) {
        var star = '&#9733';
        var val = parseInt(this.value, 10)  
        for (var i = 0; i < val; i++) {
           $(this).parent().siblings('div').append($('<div>').html(star).text())        
        }
    });
}); 
```

[演示](http://jsfiddle.net/XBSVn/19/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:12:28.407

这里的问题是类名选择器中的拼写错误（您使用了 .ratinggroups 和 .ratingroups）以及文本框选择器（您总是得到第一个文本框来检查值）。

检查这个更新的 JsFiddle：http: [//jsfiddle.net/XBSVn/12/](http://jsfiddle.net/XBSVn/12/)

将您的 HTML 更改为：

```
<form class="ratingroups">
    <p><input class="asstars" value="5"/> </p>
    <div class="rstars"></div>
</form>
<form class="ratingroups">
    <p><input class="asstars" value="4"/> </p>
    <div class="rstars"></div>
</form>
<form class="ratingroups">
    <p><input class="asstars" value="3"/> </p>
    <div class="rstars"></div>
</form>
<form class="ratingroups">
    <p><input class="asstars" value="2"/> </p>
    <div class="rstars"></div>
</form>
<form class="ratingroups">
    <p><input class="asstars" value="1"/> </p>
    <div class="rstars"></div>
</form> 
```

和你的Javascript：

```
$(function() {
    console.log($('.ratingroups input').length);
    $('.ratingroups input').each(function() {
        var asstars = $(this);
        var stars = asstars.closest('.ratingroups').find('.rstars');
        var display = true;
        if (asstars.val() == '5') {
            stars.append('<span>&#9733;&#9733;&#9733;&#9733;&#9733;</span>');
            display = false;
        }
        else if (asstars.val() == '4') {
            stars.append('<span>&#9733;&#9733;&#9733;&#9733;</span>');
            display = false;
        }
        else if (asstars.val() == '3') {
            stars.append('<span>&#9733;&#9733;&#9733;</span>');
            display = false;
        }
        else if (asstars.val() == '2') {
            stars.append('<span>&#9733;&#9733;</span>');
            display = false;
        }
        else if (asstars.val() == '1') {
            stars.append('<span>&#9733;</span>');
            display = false;
        }
        if (display) {
            stars.css('display', 'none');
        }
        else {
            stars.css('display', 'block');
        }
    });
}); 
```

# c# - SMTPClient 类错误

> ID：11512464
> 
> 赞同：0
> 
> 时间：2012-07-16T20:59:09.370
> 
> 标签：c#, .net, email, gmail

我正在尝试使用以下代码通过 gmail 发送电子邮件：

```
MailMessage msg = new MailMessage();
            msg.From = new MailAddress("admin@XXXXXX.com");
            msg.To.Add(destinos);
            msg.Subject = "XXXX";
            msg.Body = "XXXX"
            //msg.Attachments.Add(new Attachment(archivo + ".pdf"));
            //msg.Attachments.Add(new Attachment(archivo + ".xml"));
            SmtpClient client = new SmtpClient("smtp.google.com", 587);//587 465 
            client.EnableSsl = true;
            client.DeliveryMethod = SmtpDeliveryMethod.Network;
            client.Credentials = new System.Net.NetworkCredential("admin@XXXX.com", pass);

                client.Send(msg); 
```

但是它失败了，给出了这个例外：

```
16/07/2012 03:45 p.m. ERROR: Error al enviar correo. Data: System.Collections.ListDictionaryInternal System.Net.WebException: No se puede resolver el nombre remoto: 'smtp.google.com'
   en System.Net.ServicePoint.GetConnection(PooledStream PooledStream, Object owner, Boolean async, IPAddress& address, Socket& abortSocket, Socket& abortSocket6, Int32 timeout)
   en System.Net.PooledStream.Activate(Object owningObject, Boolean async, Int32 timeout, GeneralAsyncDelegate asyncCallback)
   en System.Net.PooledStream.Activate(Object owningObject, GeneralAsyncDelegate asyncCallback)
   en System.Net.ConnectionPool.GetConnection(Object owningObject, GeneralAsyncDelegate asyncCallback, Int32 creationTimeout)
   en System.Net.Mail.SmtpConnection.GetConnection(ServicePoint servicePoint)
   en System.Net.Mail.SmtpTransport.GetConnection(ServicePoint servicePoint)
   en System.Net.Mail.SmtpClient.GetConnection()
   en System.Net.Mail.SmtpClient.Send(MailMessage message) Exception actual: Void Send(System.Net.Mail.MailMessage) 
```

西班牙文是个例外，我也不是很喜欢，但它说的是：

```
There was an error when sending the mail, Couldn't resolve host smtp.google.com 
```

我检查了当前的谷歌参数，它们看起来很适合这段代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:05:23.300

您的代码无法解析 dmain。应该是 smtp.GMAIL.com

看：

[http://support.google.com/mail/bin/answer.py?hl=en&answer=13287](http://support.google.com/mail/bin/answer.py?hl=en&answer=13287)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:06:56.977

请查看下面从 google 获取的 ifnromation，看起来您的 smtp 主机错误 [http://support.google.com/mail/bin/answer.py?hl=en&answer=13287](http://support.google.com/mail/bin/answer.py?hl=en&answer=13287)

```
Configure your client to match the settings below:
Incoming Mail (POP3) Server - requires SSL: pop.gmail.com
Use SSL: Yes
Port: 995
Outgoing Mail (SMTP) Server - requires TLS3 
    or SSL: smtp.gmail.com (use authentication)
Use Authentication: Yes
Port for TLS/STARTTLS: 587
Port for SSL: 465
Account Name:   your full email address (including @gmail.com or @your_domain.com)
Email Address:  your email address (username@gmail.com or username@your_domain.com)
Password:   your Gmail password 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:11:29.557

```
SmtpClient client = new SmtpClient("smtp.gmail.com", 587); 
```

（呼）

# ruby-on-rails - 带有 CanCan 的 Rails 可安装引擎

> ID：11512469
> 
> 赞同：1
> 
> 时间：2012-07-16T20:59:20.953
> 
> 标签：ruby-on-rails, cancan, rails-engines

我正在开发一个博客引擎，我不想设置 cancan。我找到了一些方法来做到这一点：

[forem](https://github.com/radar/forem/)通过在主机用户模型中添加一个管理字段来解决问题，但是拥有多个角色需要很多字段，这绝对不是这样做的方法

我看到了一些这样[的](http://www.tonyamoyal.com/2010/07/28/rails-authentication-with-devise-and-cancan-customizing-devise-controllers/)考试，但要做到这一点，我需要让我的主机应用程序用户模型与我的引擎模型有 has_many 关系，就像这样

```
class User < ActiveRecord::Base
    attr_accessible :name
    has_many Blogcms::RoleUser
    has_many Blogcms::Role, :through => Blogcms::RoleUser
end 
```

我真的不知道这是否是正确的方法，但这不会起作用，因为作为一个孤立的引擎，引擎模型将是不可见的

有人试过这个吗？对不起我的英语不好

**编辑**

我找到了一种方法，不必搜索用户模型，只需在我的角色模型中设置关系

```
module Blogcms
  class Role < ActiveRecord::Base

    has_many :role_user
    has_many :user, :class_name =>  Blogcms.user_class, :through => :role_user

    attr_accessible :name

    # Return all the roles for a user
    def self.roles_for_user(user)
        joins(:user).where('users.id' => user.id)
    end

  end
end 
```

像这样我的 roles_for_user 方法返回用户的所有角色

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:43:42.830

我找到了一种方法，不必搜索用户模型，只需在我的角色模型中设置关系

```
module Blogcms
  class Role < ActiveRecord::Base

    has_many :role_user
    has_many :user, :class_name =>  Blogcms.user_class, :through => :role_user

    attr_accessible :name

    # Return all the roles for a user
    def self.roles_for_user(user)
        joins(:user).where('users.id' => user.id)
    end

  end
end 
```

像这样我的 roles_for_user 方法返回用户的所有角色

# ruby-on-rails - 使用 Formtastic-Boostrap 对控制组中的输入进行分组

> ID：11512476
> 
> 赞同：1
> 
> 时间：2012-07-16T20:59:38.067
> 
> 标签：ruby-on-rails, twitter-bootstrap, formtastic

我将 Formtastic 与[Bootstrap formbuilder](https://github.com/mjbellantoni/formtastic-bootstrap/)一起使用。我不知道如何将多个输入添加到控制组中，例如：

![3 个输入并排](../Images/c89cdfcf7ed70e1d1f9d71bd0af56ca7.png)

对我来说合乎逻辑的事情是执行以下操作（我正在使用 HAML）：

```
= f.inputs do
      = f.input :city, :input_html=>{:class=>'input-small'}, :label=>false, :placeholder=>'City'
      = f.input :state, :input_html=>{:class=>'input-small'}, :label=>false, :placeholder=>'State'
      = f.input :zip, :input_html=>{:class=>'input-small'}, :label=>false, :placeholder=>'Zip' 
```

但这只是将控件分组在一个字段集中。

我在文档中没有看到任何内容，谷歌也没有提供太多帮助。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T19:56:49.387

我最终将默认的 Rails 表单构建器用于需要相邻输入的区域。

# html - 哪些 HTML 标签对于 HTML 文档是必不可少的？

> ID：11512477
> 
> 赞同：0
> 
> 时间：2012-07-16T20:59:47.660
> 
> 标签：html

忘掉那些最先进的浏览器的智能渲染引擎吧。根据 W3C 标准，哪些是标准 HTML 文档的“必不可少”（不可移除）标签？

此外，它在HTML5标准中有什么区别吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:04:18.560

根据[验证器](http://validator.w3.org/check)，这是有效的：

```
<!DOCTYPE html>
<head>
<title>Title</title> 
```

**编辑：**更小：

```
<!DOCTYPE html>
<title>Title</title> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:00:40.313

每个文档必须具有的元素是：`<html>`, `<head>`, `<title>`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:35:50.893

根据 HTML 4.01 规范，唯一的强制性标签是`<title>`和`</title>`。HTML5 草稿也是如此。在 XHTML 中，适用不同的规则，请参阅规范。

# jquery - 加载页面的 PhoneGap 和 JQuery 移动问题（又一个“Access-Control-Allow-Origin”）

> ID：11512488
> 
> 赞同：2
> 
> 时间：2012-07-16T21:00:19.370
> 
> 标签：jquery, jquery-mobile, cordova

我有以下使用 PhoneGap 和 JQuery Mobile 的代码：

```
<!DOCTYPE HTML>
<html>
<head>
<meta name="viewport" content="width=320; user-scalable=no" />
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<title>Test RSS</title>

<script type="text/javascript" charset="utf-8" src="jquery.mobile/jquery-1.7.2.js"></script>
<script type="text/javascript" charset="utf-8" src="jquery.mobile/jquery.mobile-1.1.1.js"></script>
<link rel="stylesheet" href="jquery.mobile/jquery.mobile-1.1.1.css" />

<script type="text/javascript" charset="utf-8" src="cordova-1.9.0.js"></script>
<script type="text/javascript" charset="utf-8">
    var onDeviceReady = function() {
        ... //some code

        $("#homePage").live("pageinit", function() {

            ... //some more code

        });
    };

    function init() {
        document.addEventListener("deviceready", onDeviceReady, true);
    }
</script>

</head>
<body onload="init();" id="stage" class="theme">

<div data-role="page" id="homePage">
    <div data-role="header">
        <h1></h1>
    </div>

    <div data-role="content">
        <ul id="linkList" data-role="listview" data-inset="true"></ul>
    </div>

    <div data-role="footer">
        <h6>Market Bytes by @toddysm</h6>
    </div>
</div>

<div data-role="page" id="contentPage">
    <div data-role="header">
        <a href="#homePage" data-rel="back">Home</a>
        <h1></h1>
    </div>

    <div data-role="content" id="entryText"></div>
</div>
</body>
</html> 
```

出于某种原因，虽然我在执行 $("#homePage").live("pageinit", function() 时看到以下错误： *XMLHttpRequest cannot load http://127.0.0.1:44104/[some-GUID]. Origin Access-Control-Allow-Origin 不允许 null* 问题是我没有尝试加载单独的页面，并且到目前为止我发现的建议不起作用。

任何想法解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:03:37.053

刚刚在 Cordova 问题跟踪器中搜索，似乎在 2.1.0 版中已解决：[https ://issues.apache.org/jira/browse/CB-1101](https://issues.apache.org/jira/browse/CB-1101)

编辑：我已经构建并测试了[cordova version 2.1.0](https://github.com/apache/incubator-cordova-android/zipball/2.1.0)，我不再收到这些消息。要构建它，请下载 zip 文件并按照 README.md 文件中的步骤操作，但不是运行此命令：`android update project -p . -t android-15`，您需要指定 android-16，因此命令为：`android update project -p . -t android-16`。

# c - 释放内存时出现分段错误

> ID：11512493
> 
> 赞同：0
> 
> 时间：2012-07-16T21:00:38.490
> 
> 标签：c

我希望实现一个网络套接字握手，为此我正在使用以下代码片段。但是当我开始释放动态分配的内存时出现分段错误。第一次使用free功能的地方出现错误。请帮忙。

```
char rbuf[656];        
char handshake[800];
char *handshake_part2, *handshake_part3,*key,*magic,*final;
unsigned char hash [20];

key=strndup(rbuf+359, 24);     
magic = malloc(strlen("258EAFA5-E914-47DA-95CA-C5AB0DC85B11")+2);
strcpy(magic,"258EAFA5-E914-47DA-95CA-C5AB0DC85B11");
final = malloc (60);
final = strcat(key,magic);   
SHA1(final,strlen(final),hash);
base64(hash, sizeof(hash));
handshake_part2= malloc(400);
handshake_part2= base64(hash, sizeof(hash));
strcpy (handshake,"HTTP/1.1 101 Web Socket Protocol Handshake\r\nUpgrade: Websocket\r   \nConnection: Upgrade\r\nSec-WebSocket-Accept: ");
strcat(handshake,handshake_part2);
handshake_part3= malloc(400);
handshake_part3="\r\nWebSocket-Origin: http://localhost:9605\r\nWebSocket-Location: ws://localhost:9609/\r\n\r\n";
strcat(handshake,handshake_part3);
printf("Response Header :\n%s", handshake);

free(handshake_part3);
handshake_part3=NULL;
printf("Free 1");
free(handshake_part2);
handshake_part2=NULL;
printf("Free 2");
free(final);`
final=NULL;
printf("Free 3");
free(magic);
magic=NULL;
printf("Free 4");
free(key); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:02:45.727

您正在重新分配`handshake_part3`为常量字符串`"\r\n..."`；你的意思是`strcpy()`（最好`strncpy()`或等效的！）这个代替吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T21:03:37.053

您正在释放一个常量字符串。内存泄漏是因为在您调用 malloc 之后，您分配了常量字符串（并且 malloc 的内存被泄漏）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:03:45.340

```
handshake_part3= malloc(400); 
handshake_part3="\r\nWebSocket-Origin: http://localhost:9605\r\nWebSocket-Location: ws://localhost:9609/\r\n\r\n"; 
```

您将字符串文字分配给`handshake_part3`，然后尝试释放它...这会导致分配的缓冲区泄漏，并且您`free`的崩溃。您应该`strcpy`将该字符串文字分配给分配的缓冲区，或者避免分配和释放。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T21:06:40.290

看看这段代码：

```
final = malloc (60);
final = strcat(key,magic); 
```

你所做的是放弃新分配的`final`并用`key`'s 地址覆盖它。稍后您将其删除两次（一次 via`final`和一次 via `key`），这是不允许的。

这是我一眼就注意到的唯一东西，但我感觉可能还有更多……

**编辑：**看看其他答案，我可以看到确实有“更多”

# css - 在 Chrome 中使用 CSS3 转换的视频上的刚性边缘

> ID：11512496
> 
> 赞同：0
> 
> 时间：2012-07-16T21:00:39.450
> 
> 标签：css, transform

我正在对 HTML5`video`元素应用一个微妙的 CSS3 转换，但我在 Chrome 中的视频两侧出现了令人不快的僵硬边缘。

[http://cl.ly/image/0v0m421N1J1U/Screen%20Shot%202012-07-16%20at%2021.57.37.png](http://cl.ly/image/0v0m421N1J1U/Screen%20Shot%202012-07-16%20at%2021.57.37.png)

我在互联网上四处寻找解决方案。有些人建议添加白色边框或框阴影来掩盖边缘，但我没有找到运气。我也尝试将`-webkit-backface-visibility`属性设置为隐藏。还有其他可能的解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T15:34:36.793

我玩了一下这个，我可以想出一个解决方案：

```
.wrapper {
  -webkit-transform: rotate(30deg) translate(100px,100px);
  position: relative;
  float: left
}

.wrapper:after {
 content: '';
 position: absolute;
 display: block;
 top: 0;
 bottom: 0;
 left: 0;
 right: 0;
box-shadow: inset 0 0 0 1px #fff, 0 0 0 1px #fff;

}

video {
  display: block;
}
​ 
```

它只是视频顶部的一个伪元素，它有两个盒子阴影，一个是插图，另一个是插图。此解决方案仅在您的背景为纯色时才有效。

[http://jsfiddle.net/5SuGb/](http://jsfiddle.net/5SuGb/) ​</p>

# objective-c - iPhone - 从模拟器调试不会加载源文件，而是显示反汇编

> ID：11512498
> 
> 赞同：0
> 
> 时间：2012-07-16T21:00:48.660
> 
> 标签：objective-c, iphone, xcode, debugging

我刚开始做 iPhone 开发。目前，我正在尝试修复已构建的应用程序中存在的错误。主函数如下所示：

```
#import <UIKit/UIKit.h>

int main(int argc, char *argv[]) {

    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
    int retVal = UIApplicationMain(argc, argv, nil, nil);
    [pool release];
    return retVal;
} 
```

据我了解，这似乎很典型；我猜`UIApplicationMain`是主循环，为应用程序创建的源文件通过在 Objective-C 中使用委托/函数指针专门连接到主循环（注意，虽然我非常精通 C++，但我几乎不知道很多关于 iOS 或 Objective-C 的内容）。

所以，我想知道的是如何逐步浏览我的源文件并追踪我在这个应用程序中遇到的计算错误。不幸的是，当`UIApplicationMain`我进入 .似乎正在输出 AT&T 语法（注意：如果可以将 asm 语法更改为 Intel，如果有人能说明如何做到这一点，我将不胜感激）。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:09:23.037

iOS 中的主要功能在所有项目中几乎相同。它只是为了让球滚动。这是一个很好的调试教程，尤其是 Xcode 中的崩溃。[调试教程](http://www.raywenderlich.com/10209/my-app-crashed-now-what-part-1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:09:54.140

您可以通过单击左侧代码和项目资源管理器之间的灰色空间在每一行上放置断点。运行时，遇到断点模拟器或设备将停止运行并显示代码。然后点击将显示在底部调试窗口左上角的向下箭头按钮逐行运行，这将在适当时显示 asm，或者点击将运行直到下一个断点的向右箭头打。您可以通过单独删除断点或切换顶部的断点按钮来禁用断点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T22:09:18.637

（回答注意不是实际问题）

xcode 可以设置为使用 gdb（在方案设置中）：

只需添加到您的 .gdbinit （位于您的主目录中）：

“设置拆解-风味英特尔”

对于 lldb 可能有类似的东西

# python - 分析多进程 Python 脚本时出现神秘的 pickle 错误

> ID：11512499
> 
> 赞同：6
> 
> 时间：2012-07-16T21:00:51.400
> 
> 标签：python, parallel-processing, profiling

我`multiprocessing`正在使用模块，并且正在使用`UpdateMessage`通过对象发送的对象（我自己的类）`multiprocessing.Queue`在进程之间进行通信。这是类：

```
class UpdateMessage:
    def __init__(self, arrayref, rowslice, colslice, newval):
        self.arrayref = arrayref
        self.rowslice = rowslice
        self.colslice = colslice
        self.newval = newval
    def do_update(self):
        if self.arrayref == 'uL':
            arr = uL
        elif self.arrayref == 'uR':
            arr = uR
        else:
            raise Exception('UpdateMessage.arrayref neither uL nor uR')
        arr[self.rowslice, self.colslice] = self.newval 
```

当我运行脚本时，它工作得很好。但是，当我使用`cProfile`or运行它时`profile`，会出现以下错误：

```
_pickle.PicklingError: Can't pickle <class '__main__.UpdateMessage'>: attribute lookup __main__.UpdateMessage failed 
```

它似乎试图腌制课程，但我不明白为什么会这样。我的代码没有这样做，没有它也可以正常工作，所以它可能是`multiprocessing`模块。但是为什么需要 pickle `UpdateMessage`，我该如何解决这个错误？

编辑：这是发送的代码的一部分`UpdateMessage`（脚本的多个部分执行此操作，但都以相同的方式）：

```
msg = UpdateMessage(uLref, refer[0] + marker[0] - 2,
                    slice(uL.shape[1]), ustar.copy())
queue.put(msg) 
```

回溯不是很有帮助：

```
Traceback (most recent call last):
  File "/usr/lib/python3.2/multiprocessing/queues.py", line 272, in _feed
    send(obj) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T22:32:53.703

我不知道您的流程如何，但是：

```
'__main__.UpdateMessage' 
```

指已启动模块中的 UpdateMessage。

当另一个进程不使用类的 Module 启动时`UpdateMessage`，UpdateMessage 将不可用。

您必须导入包含 UpdateMessage 的模块 `UpdateMessage.__module__ is not '__main__'`。

然后Pickle 也可以在其他程序中找到UpdateMessage。

我建议`__main__.py`看起来像这样：

```
import UpdateMessage_module

UpdateMessage_module.main() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-02T08:16:38.017

我有同样的问题，并通过在自己的文件中定义要腌制的类来解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:43:05.787

我假设在您的课程被发送到另一个进程之前，您的课程正在发生酸洗尝试。最简单的解决方案可能只是在你的类上显式地实现泡菜协议......

# apache-flex - Flash Builder 中用于插入 ASDoc 注释的键盘快捷键

> ID：11512508
> 
> 赞同：0
> 
> 时间：2012-07-16T21:01:37.427
> 
> 标签：apache-flex, flash-builder

是否有在 ActionScript 中插入 ASDoc 注释的键盘命令？

前：

```
|
public var width:Number; 
```

后：

```
/**
* |
* */
public var width:Number; 
```

表示光标位置的竖线字符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:24:23.243

我部分找到了答案。

Command + SHIFT + D 将插入：

```
/**
* 
*/ 
```

这不是我希望的格式，它在最后插入空格。所以我不认为这个解决了，而只是更近了一步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-28T07:57:32.910

您可以从 Flash builder 4.6 更新 ASDoc 模板文本。窗口->首选项-> ASDoc 生成。在此窗口中，您可以根据需要编辑要为函数/属性/类插入的模板文本。

要在源代码中插入此 ASDoc 模板，请将光标放在要为其生成 ASDoc 的元素上并使用 Alt+SHIft+J 组合键。

# mysql - 在 VB 2010 中将数据绑定组合框的数据转换为 ProperCase

> ID：11512509
> 
> 赞同：2
> 
> 时间：2012-07-16T21:01:51.457
> 
> 标签：mysql, visual-studio-2010

在 VB 2010 中，我试图在不修改现有 MySQL 表的情况下以 ProperCase 显示 DisplayMember。

我的代码片段如下所示：

```
 Dim sql0 As String = "SELECT business, customer_id FROM customers WHERE cab = '1'"
 Dim data0 As New MySqlDataAdapter(sql0, main.conn)
 Dim ds0 As New DataSet
 ds0.Clear()
 data0.Fill(ds0, "customers")
 cmb_company.DataSource = ds0
 cmb_company.DisplayMember = "customers.business"
 cmb_company.ValueMember = "customers.customer_id" 
```

我试过这样的事情：

```
 cmb_company.DisplayMember = StrConv("customers.business_name", VbStrConv.ProperCase) 
```

但这只会改变引号部分的大小写，而不是实际返回的值。我也尝试像这样从 MySQL 查询：

```
 "SELECT UPPER(business), customer_id FROM customers WHERE cab = '1'" 
```

但这无法返回“业务”字段..

如果我的组合框有适当的案例而不改变一切，我会喜欢它。

我很感激任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T13:26:41.450

使用 while 循环来实现这一点似乎有点愚蠢，尤其是在使用适配器填充表之后。我想我可以跳过 .fill 并通过循环手动添加项目，同时 ProperCasing 它们。无论如何，这是我的代码：

```
 Dim sql1 As String = "SELECT * FROM table"
        Dim data1 As New MySqlDataAdapter(sql1, main.conn)
        Dim ds1 As New DataSet
        ds1.Clear()
        data1.Fill(ds1, "table")
        cmb_buyout.DataSource = ds1

        Dim i As Integer = 0
        While i < ds1.Tables(0).Rows.Count
            Dim name As String = StrConv(ds1.Tables(0).Rows(i).Item(1).ToString, VbStrConv.ProperCase)
            ds1.Tables(0).Rows(i).Item(1) = name
            i += 1
        End While

        cmb_buyout.DisplayMember = "table.buyoutType"
        cmb_buyout.ValueMember = "table.id" 
```

对于任何试图做到这一点的人来说，只需更改数据库中条目的大小写可能更简单。我可能最终会这样做！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:06:16.140

使用第二个，但使用这样的别名：

```
"SELECT UPPER(business) AS Business, customer_id FROM customers WHERE cab = '1'" 
```

MySQL[文档](http://dev.mysql.com/doc/refman/5.0/en/select.html)：

> 可以使用 AS alias_name 为 select_expr 指定别名。别名用作表达式的列名，可用于 GROUP BY、ORDER BY 或 HAVING 子句。例如：
> 
> SELECT CONCAT(last_name,', ',first_name) AS full_name FROM mytable ORDER BY full_name;

# java - 集合中通配符的 Java 类型捕获

> ID：11512511
> 
> 赞同：1
> 
> 时间：2012-07-16T21:02:12.540
> 
> 标签：java, generics, collections, types

我想这样做（最少的复制）：

```
String key = "foo";
Object value = new Bar();

if (target instanceof Map<?,?>) {
    Map<?,?> map = (Map<?,?>)target;
    map.put(key, value);
    ... 
```

但有人告诉我：

> Map 类型中的 put(capture#25-of ?, capture#26-of ?) 方法不适用于参数 (String, Object)

似乎 String 和 Object 在这里都应该没问题。我的问题有两个部分：（1）为什么？（2）我怎样才能做这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:05:20.107

问题是使用无界通配符的集合不允许向其中添加元素。如果他们这样做了，您可以将集合强制转换为具有更具体的类型参数，并且突然之间泛型应该提供的类型安全性消失了：

```
Map<?,?> map = (Map<?,?>)target;
map.put(key, value);  // Not actually allowed
Map<String, String> evilMap = (Map<String, String>)map;
String barAsString = evilMap.get(key); // But it's actually a Bar! 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:15:44.740

Map<?, ?> 真正的意思是，Map<? 扩展对象，？extends Object> 根据 Java 类型系统，您只能获取使用 ? 专门化的类型参数的值。从方法调用扩展通配符。你不能将它传递给方法。

PS 可能你想要 Map<Object, Object>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:10:15.767

[这篇博](http://blog.codeaholics.org/2011/generics-and-the-mystical-wildcard/)文提供了答案。简而言之，编译器不知道是否`Map<?, ?>`真的是 a`Map<String, Object>`或者说 a `Map<Integer, Double>`，所以它不能保证你的类型安全。

# opengl - 带有 SDL 和 OpenGL 问题的 2D TTF 文本渲染

> ID：11512513
> 
> 赞同：1
> 
> 时间：2012-07-16T21:02:17.087
> 
> 标签：opengl, 2d, sdl, truetype

所以我环顾四周，并没有找到在 SDL 和 OpenGL 中实际实现这一点的最佳方法。目前，我可以使用 TTF 在屏幕上显示文本，但它并没有真正按照应有的方式显示文本。附件是显示文本时引擎外观的屏幕截图。基本上从我在代码中看到的内容来看，我认为正在发生的事情是我没有使用我用作窗口的主 SDL_Surface 来对我的文本纹理进行 blitting。我这么说是因为在图片中我的角色周围有一个红色的碰撞框被我渲染文本的文本纹理所掩盖。关于我能做什么的任何想法？

在我的游戏循环中，我在将所有内容绘制到屏幕之前和之后调用 beginDraw() 和 endDraw()。

图片：[http ://public.gamedev.net/uploads/monthly_07_2012/post-200874-0-25909300-1342404845_thumb.png](http://public.gamedev.net/uploads/monthly_07_2012/post-200874-0-25909300-1342404845_thumb.png)

所有引擎代码都可以在这里找到：[https ://github.com/Jevi/SDL_GL_ENGINE](https://github.com/Jevi/SDL_GL_ENGINE)

PS：我将为此再发一篇文章，但如果你们已经在查看我的代码，我也不妨问一下。我一直注意到引擎的一些内存问题。在任务管理器中，分配给我的程序的内存从大约 11000 K 开始就不断攀升。

```
void graphics::SDL_GL_RenderText(float x1, float y1, int width, int height, const char* text, int ptsize, const char* ttfLoc, int r, int g, int b){
SDL_Surface* temp;
SDL_Surface* temp2;
SDL_Rect rect;
TTF_Font* font;
SDL_Color textColor;
unsigned int texture;

font = TTF_OpenFont( ttfLoc , ptsize );
textColor.r = r;
textColor.g = g;
textColor.b = b;

temp = TTF_RenderText_Blended( font, text, textColor );

// width = nextpoweroftwo(width);
// height = nextpoweroftwo(height);

temp2 = SDL_CreateRGBSurface(0, width, height, 32, r, g, b, 0);
SDL_BlitSurface(temp, 0, temp2, 0);

glGenTextures(1, &texture);
glBindTexture(GL_TEXTURE_2D, texture);
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, temp2->w, temp2->h, 0, GL_RGBA, GL_UNSIGNED_BYTE, temp2->pixels);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);

/* prepare to render our texture */
glEnable(GL_TEXTURE_2D);
glBindTexture(GL_TEXTURE_2D, texture);
glColor3f(1.0f, 1.0f, 1.0f);

/* Draw a quad at location */
glBegin(GL_QUADS);
glTexCoord2d(0,0);
glVertex2f(x1, y1);
glTexCoord2d(1,0);
glVertex2f(x1 + temp2->w, y1);
glTexCoord2d(1,1);
glVertex2f(x1 + temp2->w, y1 + temp2->h);
glTexCoord2d(0,1);
glVertex2f(x1, y1 + temp2->h);
glEnd();
glFinish();
glDisable(GL_BLEND);
glDisable(GL_TEXTURE_2D);

SDL_FreeSurface(temp);
SDL_FreeSurface(temp2);
TTF_CloseFont(font);
glDeleteTextures(1, &texture); 
```

}

```
void graphics::GL_BeginDraw(){
glClear(GL_COLOR_BUFFER_BIT);
glPushMatrix(); //Start rendering phase
glOrtho(0,width,height,0,-1,1); //Set the matrix 
```

}

```
void graphics::GL_EndDraw(){
glPopMatrix(); //End rendering phase
SDL_GL_SwapBuffers();
glFinish(); 
```

}

# php - PHP：重构为 OO——如何为连接建模

> ID：11512522
> 
> 赞同：5
> 
> 时间：2012-07-16T21:02:43.200
> 
> 标签：php, oop, model-view-controller, join

假设我有两个模型：

```
class Book
{
    public $book_id;
    public $book_author_id;
    public $title;
}

class Author
{
    public $author_id;
    public $author_name;
} 
```

我习惯写这样的东西：

```
$DB->query("SELECT book_id, title, author_name 
            FROM book 
            LEFT JOIN author 
                ON book_author_id = author_id
           "); 
```

假设，我对对此关联进行单独查询不感兴趣。我该如何进行？以下是我听说过的一些事情：

*   创建 JOIN 的 MySQL VIEW
*   创建 VIEW 的模型类

我正在处理的应用程序涉及数十个表，并且在程序代码中进行了高度优化（例如，几乎没有 SELECT * 任何地方）。我正在重构以使其更易于维护（我也是最初的创建者），但我希望能够在需要时灵活地使用连接，而不会影响我的文件和数据库调用的结构。

我的一个可能相关的问题与包含其他模型有关：

```
class Author
{
    public $author_id;
    public $author_name;

    /* @var Book */ //<--don't really fully understand this but I've seen something like it somewhere
    public (array) $authors_books;
} 
```

我仍在寻找答案，但如果您能以我的方式发送链接，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:54:05.810

您所说的“模型”实际上是[域对象](http://c2.com/cgi/wiki?DomainObject)。他们应该负责处理领域业务逻辑，与存储无关。

与存储相关的逻辑和交互应由单独的对象组处理。最明智的解决方案之一是使用[数据映射器](http://martinfowler.com/eaaCatalog/dataMapper.html)。每个映射器可以处理多个表和复杂的 SQL。

至于您的查询，此类查询的结果将包含适合传递给域对象集合的信息。

顺便说一句，该查询毫无用处。您忘记了每本书可以有多个作者。[以这本书](https://rads.stackoverflow.com/amzn/click/com/0201633612)为例——它有 4 位不同的作者。要使此查询有用，您应该必须`GROUP_CONCAT()`基于`author_id`或`book_id`。

实现此类`JOIN`语句时，数据库响应很可能是一个集合：

```
$mapper = $factory->buildMapper('BookCollection');
$collection = $factory->buildCollection('Book');

$collection->setSomeCondition('foobar');
$mapper->fetch( $collection );
foreach ( $collection as $item )
{
    $item->setSomething('marker');
}
$mapper->store( $collection ); 
```

**PS**您的代码示例似乎正在泄漏抽象。让其他结构直接访问对象的变量是一种不好的做法。

**PPS看来您对 MVC 模型部分的理解与**[我的看法](https://stackoverflow.com/a/5864000/727208)大不相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T21:48:19.283

数据库连接是关系数据库的产物，您不需要对它们进行建模。您需要对您的数据*是*什么以及它的*行为*方式进行建模，例如，您的实例中可能有一个`getBooks()`方法`Author`，或者您的类中有一个静态`getByAuthor()`方法`Book`（通常，`$author->getBooks()`应该实现为`Book::getByAuthor($this)`，因此您的`Author`类不应该关心`Book`的实现细节）。自动实例化所有相关数据并不总是一个好主意（例如`Book`，通过给定实例实例化所有书籍的`Author`实例，正如您似乎正在考虑使用您的`$author_books`属性），因为这可能很容易降级为“将整个数据库加载到内存中每个请求”的场景。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:11:12.360

如果您尝试在类中建模您的数据库，这是一个已经解决的问题。

我建议你试试[Doctrine](http://www.doctrine-project.org/)框架，它是 PHP 的完整 ORM 框架。

希望有帮助。

# sql - 查找表中的第一个最低值和最低值出现的日期

> ID：11512523
> 
> 赞同：1
> 
> 时间：2012-07-16T21:02:43.450
> 
> 标签：sql, postgresql

如果我有一个具有以下架构的表：

```
CREATE TABLE diet_watch (
  entry_date date NOT NULL,
  weight     double precision NOT NULL
);

INSERT INTO diet_watch VALUES ('2001-01-01', 128.2);
INSERT INTO diet_watch VALUES ('2001-01-02', 121.0);
INSERT INTO diet_watch VALUES ('2001-01-03', 122.3);
INSERT INTO diet_watch VALUES ('2001-01-04', 303.7);
INSERT INTO diet_watch VALUES ('2001-01-05', 121.0);
INSERT INTO diet_watch VALUES ('2001-01-06', 128.0); 
```

我将如何编写一个查询来返回两个日期之间的第一个最小重量**和****最小**重量发生的日期？

理想情况下，这将是 ANSI-SQL，即 db 不可知论。如果我不得不被迫选择一种 SQL 风格，那将是 PostgreSQL，因为那是我正在使用的数据库。

**伪 SQL：**

```
SELECT min(entry_date), min(weight)
FROM   diet_watch
where  entry date between date1 and date2
group  by entry_date; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:20:29.650

### 简单快速的解决方案：

```
SELECT weight, entry_date
FROM   diet_watch
WHERE  entry_date BETWEEN '2001-01-02' AND '2001-01-06'
ORDER  BY 1, 2
LIMIT  1; 
```

适用于 PostgreSQL 或 MySQL 以及可能的其他（不在 Oracle 或 MS SQL Server 中）。

### 标准 SQL (SQL:2003)：

```
SELECT weight, entry_date
FROM  (
    SELECT weight, entry_date
          ,row_number() OVER (ORDER BY weight, entry_date) AS rn
    FROM   diet_watch
    WHERE  entry_date between '2001-01-02' and '2001-01-06'
    ) AS x
WHERE rn = 1; 
```

不支持不实现窗口函数（如 MySQL）的 RDBMS。

### 标准 SQL 变体 (SQL:2008)：

```
SELECT weight, entry_date
FROM   diet_watch
WHERE  entry_date BETWEEN '2001-01-02' AND '2001-01-06'
ORDER  BY weight, entry_date
FETCH  FIRST 1 ROWS ONLY; 
```

只有少数 RDBMS 支持 -[在 Wikipedia 上查找列表](http://en.wikipedia.org/wiki/Select_%28SQL%29#FETCH_FIRST_clause)。

**唯一**支持所有这些的RDBMS 是 PostgreSQL（v8.4 或更高版本）。

* * *

解决评论中的问题，我[在此处引用有关 ORDER BY 的手册](http://www.postgresql.org/docs/current/interactive/sql-select.html#SQL-ORDERBY)：

> 每个表达式可以是输出列（SELECT 列表项）的名称**或序号**，也可以是由输入列值形成的任意表达式。

强调我的。它只是一种语法快捷方式，许多 RDBMS 都支持它。SQL Server 显然不在其中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T21:09:03.760

```
SELECT min(entry_date), min(weight) from diet_watch where weight = (
    SELECT MIN(weight) as wt from diet_watch where entry_date between date1 and date2
) and entry_date between date1 and date2 
```

[**编辑**：答案略有调整，因为问题似乎从找到最小日期的重量变成了最小重量的日期]

此外，问题要求“FIRST”最小重量......我假设这意味着最小重量的最早日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:08:53.777

您可能会请求 SELECT * ORDER BY weight ASC LIMIT 1（大多数 DB 支持 LIMIT），或者根本不使用 LIMIT 而只从游标中检索第一行。

否则，您需要一个 JOIN 来获取最小值，然后检索最小值确实发生的日期；并且在多个日期达到最小值的情况下，您仍然需要 LIMIT 和/或一次提取。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T21:21:05.990

根据 Gerrat 的回答，可以按 entry_date 排序并获取第一行。

```
SELECT top 1 entry_date, weight
FROM diet_watch
WHERE weight = (SELECT MIN(weight) as wt from diet_watch)
ORDER BY entry_date 
```

编辑：这是 SQL Server 代码。不过，您可以使用 postgre 中的任何等价物。

# python - 提高 xmlrpclib 的速度

> ID：11512525
> 
> 赞同：0
> 
> 时间：2012-07-16T21:03:09.677
> 
> 标签：python, xmlrpclib

我正在使用一个本质上是黑匣子的设备，它唯一已知的通信方法是 XML-RPC。它适用于大多数需求，除了当我需要非常快速地执行两个命令时。由于开销和等待 RPC 响应，这并不像期望的那么快。

我的主要问题是，如何减少这种开销以使此功能成为可能？我知道显而易见的解决方案是放弃 XML-RPC，但我认为这对这个设备来说是不可能的，因为我无法控制从“服务器”实现任何其他协议。这也使得无法进行 MultiCall，因为我无法为 MultiCall 添加有效指令。MultiCall 是否必须在服务器端实现？例如，如果我已经由服务器实现了 method1()、method2() 和 method3()，那么这段代码是否应该在一个回复中执行它们？到目前为止，我假设我的测试没有，因为[文档](http://docs.python.org/library/xmlrpclib.html#multicall-objects)显示了我需要在服务器端初始化命令的示例。

```
server=xmlrpclib.ServerProxy(serverURL)
multicall=xmlrpclib.MultiCall(server)
multicall.method1()
multicall.method2()
mutlicall.method3()
multicall() 
```

此外，查看 xmlrpclib 的源代码，我看到对“FastParser”的引用，而不是使用的默认值。但是，我无法确定如何在默认情况下启用此解析器。此外，[对此答案的评论](https://stackoverflow.com/a/3343497/546311)提到它一次解析一个字符。我相信这是相关的，但同样，不知道如何更改此设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T00:38:24.180

除非您的请求或响应的体积非常大，否则更改解析器不太可能影响周转时间（因为 CPU 比网络快得多）。

如果可能，您可能需要考虑向设备发送多个命令，而无需等待第一个命令的响应。如果设备可以一次处理多个请求，那么这可能是有益的。即使设备只按顺序处理请求，您仍然可以让下一个请求在设备处等待，这样在处理前一个请求之后就没有延迟。如果设备以这种方式序列化请求，那么这将是你能做的最好的事情。

# android - Android 应用中使用 RecognizerIntent 实现数据安全

> ID：11512530
> 
> 赞同：3
> 
> 时间：2012-07-16T21:03:35.423
> 
> 标签：android, security, speech-recognition, speech-to-text, recognizer-intent

我正在使用 RecognizerIntent 开发一个 Android 语音识别应用程序。客户端关心设备和谷歌语音识别服务器之间传输的数据以及是否可以截获。

我发现关于什么格式以及如何来回发送数据的文档很少。

有谁知道我在哪里可以找到这些信息？设备与 Google 语音识别之间的通信是否以任何方式加密/安全？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T17:20:23.787

如果您的客户担心安全问题，则值得使用仅在设备上工作且不会向外部发送数据的语音识别器。一种这样的工具是 Pocketsphinx

[http://cmusphinx.sourceforge.net/2011/05/building-pocketsphinx-on-android/](http://cmusphinx.sourceforge.net/2011/05/building-pocketsphinx-on-android/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T12:57:53.260

请参阅[Google 的语音搜索语音识别服务](https://stackoverflow.com/questions/4055830/googles-voice-search-speech-recognition-service)，这可能会有所帮助。当然，现在著名的[http://mikepultz.com/2011/03/accessing-google-speech-api-chrome-11/](http://mikepultz.com/2011/03/accessing-google-speech-api-chrome-11/)展示了 Chrome 浏览器中 Google 语音识别的工作原理。

# sitecore - Sitecore WFM - 根据字段值显示/隐藏表单字段？

> ID：11512535
> 
> 赞同：2
> 
> 时间：2012-07-16T21:03:54.137
> 
> 标签：sitecore, sitecore6, web-forms-for-marketers

我目前正在使用 Sitecore 中的 WFM 模块来显示一个包含多个字段的表单。

我正在尝试执行以下操作：

*   使用“布局规则”显示/隐藏部分字段，具体取决于复选框值

当我尝试在要隐藏/显示的部分上使用布局规则时，它似乎不起作用（一切都在显示）。

我已经输入了以下逻辑：

*   新条件
*   其中 HotelAmenitiesCheckbox 字段不等于 1
*   隐藏元素

“HotelAmenitiesCheckbox”是表单中的一个复选框字段。我已将 Sitecore 中的名称和 DisplayName 设置为与我在上面键入的内容完全相同。

任何人都可以帮助解释我需要去哪个方向吗？这让我对 .NET 的有限知识和 Sitecore 有限的文档感到沮丧。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T15:44:30.243

I have the same issue and haven't been able to find an out-of-box solution with the WFFM module so I came up with this workaround that leverages the `Help` field of a WFFM field to store a "line of code". I gave the marketers an `if` statement that they can write in the `Help` field and when the form loads on the front-end, there's some JS that parses that `if` statement and hides/shows fields that are dependent on each other. I asked this question just this weekend, and got a lot of help from the community here on Stackoverflow: [Conditional Renderings with JavaScript Regex](https://stackoverflow.com/questions/12118921/conditional-renderings-with-javascript-regex).

# c# - 对 LinqDataSource 使用通配符

> ID：11512539
> 
> 赞同：2
> 
> 时间：2012-07-16T21:04:11.360
> 
> 标签：c#, asp.net, .net, linq, linq-to-sql

我目前在 ASP.NET 页面上有一个 LinqDataSource，它用作 FormView 的数据源。我需要`where`根据通过查询字符串传递的参数动态更改子句。除了我希望最终用户能够使用通配符之外，我的工作正常：

*   一种 ”？” 用于表示单个字符。
*   “*”代表多个字符。

看起来很简单，我只需要使用 LIKE 运算符并替换`?`为`_`（匹配单个字符）和`*`替换为`%`（匹配所有字符）。

下面是执行花哨步法的方法（称为 on `PageLoad`），除了我的通配符被转义外，它工作得很好。

```
private void ApplyFilter(ref LinqDataSource lds)
{
    if (Request.QueryString.Keys.Count > 0)
    {
        string where = "";
        int counter = 0;

        foreach (string key in Request.QueryString.Keys)
        {
            if (Request.QueryString[key] != "")
            {
                if (counter == 0)
                {
                    where += key + ".Contains(@" + key + ")";
                }
                else
                {
                    where += " AND " + key + ".Contains(@" + key + ")";
                }

                lds.WhereParameters.Add(key, Request.QueryString[key].Replace("?", "_").Replace("*", "%"));
                counter++;
            }
        }

        if (where != "")
            lds.Where = where;
    }
} 
```

以下是从此查询字符串生成的查询：`.aspx?LOOP_DESCRIPTION=*&LOOP=*&AREA=01`

```
exec sp_executesql N'SELECT [t1].[AREA], [t1].[LOOP], [t1].[LOOP DESCRIPTION] AS [LOOP_DESCRIPTION]
FROM (
    SELECT ROW_NUMBER() OVER (ORDER BY [t0].[AREA], [t0].[LOOP], [t0].[LOOP DESCRIPTION]) AS [ROW_NUMBER], [t0].[AREA], [t0].[LOOP], [t0].[LOOP DESCRIPTION]
    FROM [dbo].[INSTRUMENT LOOP DESCRIPTION] AS [t0]
    WHERE ([t0].[LOOP DESCRIPTION] LIKE @p0 ESCAPE ''~'') AND ([t0].[LOOP] LIKE @p1 ESCAPE ''~'') AND ([t0].[AREA] LIKE @p2)
    ) AS [t1]
WHERE [t1].[ROW_NUMBER] BETWEEN @p3 + 1 AND @p3 + @p4
ORDER BY [t1].[ROW_NUMBER]',N'@p0 nvarchar(4000),@p1 nvarchar(4000),@p2 nvarchar(4000),@p3 int,@p4 int',@p0=N'%~%%',@p1=N'%~%%',@p2=N'%01%',@p3=0,@p4=1 
```

正如您通过参数分配所看到的，我的通配符正在使用波浪字符进行转义：

```
@p0=N'%~%%',@p1=N'%~%%',@p2=N'%01%' 
```

我的问题是，是否可以阻止`_`and`%`字符被转义？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:43:32.527

请尝试 url 解码 `Request.QueryString[key]`

例子：

```
HttpUtility.UrlDecode(Request.QueryString[key]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T17:06:27.280

我终于设法弄清楚了。感谢[这篇文章](http://forums.asp.net/post/3494722.aspx)中的一个类，我能够使用 LinqDataSource_Selecting 事件并使用使用此代码的通配符成功过滤我的数据：

```
protected void ldsData_Selecting(object sender, LinqDataSourceSelectEventArgs e)
{
    var result = db.INSTRUMENT_LOOP_DESCRIPTIONs.AsQueryable();

    foreach (string key in Request.QueryString.Keys)
    {
        if (Request.QueryString[key].Trim() != "")
        {
            result = result.WhereLike(key, Request.QueryString[key].Replace("?", "_").Replace("*", "%"));
        }
    }

    e.Result = result;
} 
```

# c# - 有没有办法将类型参数限制为 SqlDbType？

> ID：11512548
> 
> 赞同：0
> 
> 时间：2012-07-16T21:05:15.713
> 
> 标签：c#, .net, generics, .net-4.0

我正在寻找将类型参数限制为 SqlDbType 的通用工厂方法。这是我对签名的尝试：

```
 private static SqlParameter SqlParameterFactory<ValTYpe>(String 
       ParamName, SqlParamInOrOut Direction) where ValTYpe: SqlDbType 
```

这给出了错误：“错误 1 ​​'System.Data.SqlDbType' 不是有效的约束。用作约束的类型必须是接口、非密封类或类型参数。”

我觉得这是可行的，但这是我的语法......任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:06:37.577

`SqlDbType`是一个枚举。将其作为参数传递

```
 private static SqlParameter SqlParameterFactory(SqlDbType ValType, String  
   ParamName, SqlParamInOrOut Direction) 
```

# ios - 调试构建的符号化崩溃报告

> ID：11512549
> 
> 赞同：0
> 
> 时间：2012-07-16T21:05:17.023
> 
> 标签：ios, xcode

有一个构建设置显示“默认隐藏符号”，我在调试构建中将其设置为 NO，但我的设备上仍然没有出现符号化崩溃。这在ios上是不可能的吗？我知道在 mac 上是这样，但也许我还缺少另一个设置？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T10:03:33.943

只有在将构建部署到设备后没有启动另一个构建过程时，符号化才会起作用。每个构建都将生成具有相同 UUID 的应用程序二进制文件和 dSYM 文件的唯一组合。此 ID 在崩溃报告中设置，用于查找正确的 dSYM 以解析崩溃报告中的符号。

如果您再次构建，这些文件将被替换，因此也会获得一个新的 UUID。所以符号化过程找不到相应的文件，也不会解析应用程序特定的符号。iOS 符号应该可以正常工作。

# javascript - 动态选择命名元素

> ID：11512550
> 
> 赞同：0
> 
> 时间：2012-07-16T21:05:17.910
> 
> 标签：javascript, jquery, jquery-selectors

我有这个代码

```
$('#addPhone').click(function() {
    phoneCount = $("#phoneTabs").tabs("length") + 1;
    $('#phoneTabs').show();
    $('#phoneTabs').append('<div id="phoneTabs' + phoneCount + '"><form id="phoneForm' + phoneCount + '" novalidate="novalidate" action="" method="post"><table><tr><td><b>Phone Number ' + phoneCount + '</b></td><td></td></tr><tr><td>Phone number</td><td><input type="text" class="required digits" maxlength="10" minlength="10"  name="phone_number' + phoneCount + '" /></td></tr><tr><td>Comment</td><td><textarea rows="5" cols="25" name="phone_comment' + phoneCount + '"></textarea></td></tr></table><br /><button id="addPhone' + phoneCount + '">Add</button></form></div>');

    $("#phoneForm" + phoneCount).validate({
        submitHandler: function() {
            return false;
        }
    });
    $('#addPhone' + phoneCount).button();
    $('#addPhone' + phoneCount).click(function() {
        $(this).button({
            disabled: true
        });
        $('#phoneForm' + phoneCount + ' input').attr('disabled', true);
    });

    $("#phoneTabs").tabs("add", "#phoneTabs" + phoneCount, phoneCount);
    $('#phoneTabs').tabs("select", phoneCount - 1);
    phoneCount++;
});​ 
```

为什么当我单击 addPhone 按钮时，只有按钮被禁用，为什么其他输入元素是 #phoneForm'+ phoneCount 的子元素没有被禁用？

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:20:17.210

这是一个[闭包问题](http://www.javascriptkit.com/javatutors/closures.shtml)，`phoneCount`值在单击处理程序中应用之前会发生变化，要删除闭包试试这个

```
$('#addPhone' + phoneCount).click((function(selector){ return function() {
    $(this).button({
        disabled: true
    });
    $(selector).attr('disabled', true);
}})('#phoneForm' + phoneCount + ' input')); 
```

编辑

如果要`phoneCount`在函数中使用 的值，则仅将其传递给 IIFE

```
$('#addPhone' + phoneCount).click((function(phoneCount){ return function() {
    if (phoneCount operator operand){
        code
    }
    $(this).button({
        disabled: true
    });
    $('#phoneForm' + phoneCount + ' input, other selectors').prop('disabled', true);
}})(phoneCount)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:15:31.037

如果您更改该行，它可能会禁用 LAST 选项卡上的输入

```
$(this).button({disabled : true});
$('#phoneForm'+ phoneCount+ ' input').attr('disabled',true); 
```

成为

```
$(this).button({disabled : true});
$(this).closest("form[id^='phoneForm'])".filter('input').attr('disabled',true); 
```

应该希望得到有效的形式。

# django - 带有“meetup”API 的 http 错误 400

> ID：11512554
> 
> 赞同：2
> 
> 时间：2012-07-16T21:05:29.363
> 
> 标签：django, oauth-2.0, http-error, bad-request, meetup

我正在尝试将我的网站连接到 Meetup.com。
[指示](http://www.meetup.com/meetup_api/auth/)

当我请求授权时，一切正常。但是，当我尝试获取访问令牌时，我不断得到：

> http 错误 400：错误请求。

这是我的代码：

```
def meetupauth(request):

r =request.REQUEST
code = r['code']
state = r['state']

consumer = OAuthConsumer.objects.filter(apiservice_id=LINKEDINAPI)[0]

url_str = {'client_id' : consumer.token, 'client_secret' : consumer.tokensecret, 'grant_type' : 'authorization_code', 'redirect_uri' : 'http://127.0.0.1:8000/apiservice/meetupauth', 'code' : code}

#url_str = (('client_id' , consumer.token), ('client_secret' , consumer.tokensecret), ('grant_type' , 'authorization_code'), ('redirect_uri' , 'http://127.0.0.1:8000/apiservice/meetupauth'), ('code' , code))

url_string = urllib.urlencode(url_str)

req = urllib2.Request(meetup_access_token_url, url_string)

resp = urllib2.urlopen(req)

return redirect("/dashboard/") 
```

这是错误：

```
HTTPError at /apiservice/meetupauth
HTTP Error 400: Bad Request
Request Method: GET
Request URL:    http://127.0.0.1:8000/apiservice/meetupauth?code=acd62b4e1f28e3454c322d6b00136443&state=
Django Version: 1.4
Exception Type: HTTPError
Exception Value:    HTTP Error 400: Bad Request 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T02:24:38.937

愚蠢的错误。

代码是：

```
consumer = OAuthConsumer.objects.filter(apiservice_id=LINKEDINAPI)[0] 
```

应该是

```
consumer = OAuthConsumer.objects.filter(apiservice_id=MEETUPAPI)[0] 
```

# hibernate - 找不到持久性单元和逆向工程工具

> ID：11512555
> 
> 赞同：2
> 
> 时间：2012-07-16T21:05:29.823
> 
> 标签：hibernate, jboss7.x, persistence.xml

我目前正在使用 Hibernate 工具和逆向工程创建我的实体和 DAO。我的配置是 Eclipse Indigo、JBoss AS7、Hibernate Tools 3.4 和 Hibernate 4。问题是当我尝试将我的 .jar 部署到 JBoss AS7 时，我得到了这个：

[http://pastebin.com/1hvHBM7z](http://pastebin.com/1hvHBM7z)

更准确地说：

> 在部署“businessLayer.jar”中找不到名为 null 的持久性单元

现在，我搜索了这个问题，它表明我应该在 META-INF 下有一个 persistence.xml 文件。问题是，这一代并没有对这个文件做任何事情（当我在控制台配置期间检查注释而不是 JPA 时，它甚至禁用了它的生成），当我查看示例时，我不确定要指定什么......另一个问题：据我了解，这个文件对于 EntityManager 是必需的，但是如果所有必需的信息都已经在我的 hibernate.cfg.xml 中，为什么我需要这个（因为我的意思是，这两个文件看起来有点相似...... ) ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T15:19:35.797

Actually it seems you need to have the persistence xml, which get rid of the issue above. Then you're likely to have a new exception : JDBC Driver not found etc. The problem came from JBoss 7 and Postgre9 for me. More information [here](https://community.jboss.org/thread/168958) (last post).

# c# - 在 HTML 表格中查找控件的行号

> ID：11512556
> 
> 赞同：0
> 
> 时间：2012-07-16T21:05:31.230
> 
> 标签：c#, javascript

我有一个名为 DataTable 的 HTML 表。在我的 C# 代码中，我向表中添加了几行/单元格。每行的第一个单元格都有一个名为“ddlLevels_[id]”的下拉列表，其中 id 是数据库中对应的 id。

我的最终目标是根据下拉列表中选择的某些选项，在当前行下添加一行。

我将如何完成添加行？我假设我需要找到该元素当前所在的行号，然后插入一行。我如何找到该行号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:15:19.180

每个 TR 都有一个`rowIndex`属性。只需遍历 DOM`.parentNode`直到找到 TR，然后访问其`rowIndex`属性。[http://msdn.microsoft.com/en-us/library/ie/ms534377(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/ms534377(v=vs.85).aspx)

# extjs - 带有小按钮的 ExtJs TextField

> ID：11512558
> 
> 赞同：11
> 
> 时间：2012-07-16T21:05:36.640
> 
> 标签：extjs, extjs4

如何在文本字段中创建带有图标的小按钮，例如使用日期字段？在 ExtJS 的早期版本中，有一个 CompositeField，但在 ExtJS 4 中找不到它。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-16T21:31:10.170

只需扩展[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.field.Trigger](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.field.Trigger)就可以用 CSS 改变触发字段的图标，实现点击的行为`onTriggerClick`模板方法中的图标

```
Ext.define('Ext.ux.CustomTrigger', {
    extend: 'Ext.form.field.Trigger',
    alias: 'widget.customtrigger',

    // override onTriggerClick
    onTriggerClick: function() {
        Ext.Msg.alert('Status', 'You clicked my trigger!');
    }
});

Ext.create('Ext.form.FormPanel', {
    title: 'Form with TriggerField',
    renderTo: Ext.getBody(),
    items:[{
        xtype: 'customtrigger',
        fieldLabel: 'Sample Trigger',
        emptyText: 'click the trigger'
    }]
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-16T21:32:56.737

图标可以点击吗？如果是这样，您正在寻找`Ext.form.field.Trigger`. 如果没有，您可以尝试覆盖 Text 字段的 getSubTplMarkup() 函数以提供一些自定义 dom。

例如：

```
Ext.define('MyField', {
    extend: 'Ext.form.field.Text',

    getSubTplMarkup: function() {
        return this.callParent(arguments) + '<span class="my-icon"></span>';
    }
}); 
```

# php - PHP/WordPress：在 foreach 循环中覆盖 page_id

> ID：11512569
> 
> 赞同：1
> 
> 时间：2012-07-16T21:06:15.320
> 
> 标签：php, wordpress

我有一个 WordPress 网站，目前它设置为根据页面标题创建标题的代码。标题是：室内房屋绘画，外部房屋绘画和商业绘画。我想覆盖标题以删除“房屋”一词。这是当前的代码：

```
<?php
// interior_painting: 18
// exterior_painting: 25
// other services: 36
$page_ids = array(18, 25, 36);
$images = array('servicesInterior.jpg', 'servicesExterior.jpg', 'servicesOther.jpg');
foreach ($page_ids as $key => $page_id) {
    $page_post = get_post($page_id);
    $page_custom_key = 'home_page_info';
    $page_link = $page_post->post_name;
    $li_class = $page_id == 36 ? 'noMargin' : '';
    $title = $page_id == 18 ? 'Interior Painting' : $page_post->post_title . " ";
    $title = $page_id == 36 ? 'Commercial Projects' : $page_post->post_title . " ";
    $title = $page_id == 25 ? 'Exterior Painting' : $page_post->post_title . " ";

    echo '<li class="' . $li_class . '"> <a href="' . $page_link . '">';
    echo '<img class="alignright size-full wp-image-349" title="servicesInterior" src="/wp-content/uploads/2011/04/' . $images[$key] . '" alt="" width="200" height="95" /></a>';
    echo '<h2>' . $title . '</h2>';
    echo get_post_meta($page_id, $page_custom_key, true);
    echo '<a class="btn-find-more" href="' . $page_post->post_name . '">FIND OUT MORE</a></li>';
}

?> 
```

输出是这样的：室内房屋绘画，外部绘画，商业绘画。如何从“室内房屋绘画”中删除“房屋”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:09:47.670

只需使用`preg_replace('House'|| 'house','',/*Variable Page title is in*/);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:22:15.393

您可以尝试替换该行：

```
echo '<h2>' . $title . '</h2>'; 
```

像这样：

```
if (is_page('Interior House Painting')) { echo '<h2>Interior Painting</h2>'; } 
if (is_page('Exterior House Painting')) { echo '<h2>Exterior Painting</h2>'; } 
else { echo '<h2>' . $title. '</h2>'; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:52:27.810

```
$title = ucwords(trim(strtolower(str_replace('house', '', $page_post->post_title)))); 
```

不过，我有点好奇为什么你不喜欢完全从标题中删除这个词。

**另外：**其他人提到使用 preg_replace。这也是完全可能的，但最好进行不区分大小写的搜索：

```
$title = trim(preg_replace('/house/i', '', $page_post->post_title)); 
```

# iphone - 无法更新表格视图中单元格的图像

> ID：11512572
> 
> 赞同：0
> 
> 时间：2012-07-16T21:06:16.273
> 
> 标签：iphone, uitableview

我正在为合适的视图定制单元格，如下所示

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    NSString *CellIdentifier    =   @"overViewCell";
    tableCell                   =   [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if ( tableCell == nil ) {
        [[NSBundle mainBundle] loadNibNamed:@"OverViewCell" owner:self options:nil];
        tableCell           =   overViewCell;
        self.overViewCell   =   nil;
    }
    ..............................................................
} 
```

OverViewCell.xib 看起来像（右图标记为 3 ）

![在此处输入图像描述](../Images/1126f881f967b6c9c56f4a81f4553770.png)

后来，我想通过这样做从表格视图中更改特定单元格的图像

```
- (void) updateImageView {
    // currentRow is getting value when cellForRowAtIndex is clicked  
    NSIndexPath *indexPath  =   [NSIndexPath indexPathForRow:currentRow inSection:0];
    UITableViewCell *cell   =   [self.tableContent cellForRowAtIndexPath:indexPath];
    imageView               =   (UIImageView*)[cell viewWithTag:3];
    imageView.image         =   [UIImage imageNamed:@"checked.png"];
    [self dismissViewControllerAnimated:YES completion:nil];

} 
```

但是，图像根本没有改变

我中间缺少什么...如果您对此问题有任何线索，请提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:19:47.483

我想出了问题所在。这是因为我为该图像分配了错误的标签

# android - 自动更改 Wi-Fi Direct 设置

> ID：11512577
> 
> 赞同：1
> 
> 时间：2012-07-16T21:06:38.380
> 
> 标签：android, settings, wifi-direct

我找到了可以更改和不能更改的系统设置列表（安全设置），但启用/禁用 Wifi-Direct (ICS) 不在其中。启动应用程序时如何自动打开 Wi-Fi Direct？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:45:41.793

不幸的是，没有公开的方式来实现这一点。ICS 和 JB 中的设置应用程序使用管理器类上的隐藏方法来切换服务为启用/禁用。

*   在 ICS 中，使用了 WifiP2PManager.enableP2P() 和 WifiP2PManager.disableP2P()，这两种方法都是隐藏的。
*   在 JB 中，使用了 NsdManager.setEnabled()。

所以这是可能的，因为这些类上确实存在方法。但是，由于这种差异，您必须创建非常特定于版本的反射代码，这些代码几乎肯定会在以后的版本中中断，以便直接从您的应用程序中提供功能。

更好的解决方案是检查该服务是否已启用，并向用户显示一个对话框，让他们直接进入“无线设置”页面以自行启用 WiFi Direct（如果他们愿意）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T17:11:18.047

JB 引入了并发的概念，这意味着只要 wifi 开启，应用程序就不必直接开启 wifi。

对于 ICS，最好将用户带到无线设置中，让他打开它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-16T21:16:17.430

您是否尝试过使用[WiFi 管理器](http://developer.android.com/reference/android/net/wifi/WifiManager.html)？您应该能够在 Activity 中像这样切换它：

```
WifiManager wifi = (WifiManager)getSystemService(Context.WIFI_SERVICE);
if (!wifi.isWifiEnabled()){
  wifi.setWifiEnabled(true);
} 
```

这应该打开 WIFI，但不能保证一个有 Wifi 连接！您还可以使用 WifiManager 来查找[WifiInfo](http://developer.android.com/reference/android/net/wifi/WifiInfo.html)

```
WifiInfo wifiInfo = wifi.getConnectionInfo(); 
```

或 ping 接入点

```
if (wifi.pingSupplicant()){
  //at least connected to a network
} 
```

# php - PhP TextArea 每行带有explode和foreach postgresql

> ID：11512586
> 
> 赞同：0
> 
> 时间：2012-07-16T21:07:19.220
> 
> 标签：php, postgresql, foreach, textarea, explode

这是一个非常简单的问题。我有一个文本区域。在此文本区域中是名称。新行中的每个名称。

```
Brad Pitt
LMFAO
Green Day 
```

等等...

我想将这些名称放入数据库中。我用explode() 和foreach 试过了，但是没用。：/

这是代码：

```
$kilencedik=array();
$kilencedik=explode('\n',$_POST['9']);
foreach($kilencedik as $nev9) {
    $adat9 = pg_escape_string($nev9);
    pg_query($kapcsolodas, "INSERT INTO diakok (nev, ev) values ('$adat9', '9')");
} 
```

我正在使用带有 PHP 的 postgreSQL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:12:33.707

将 '\n' 更改为 "\n" 是一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:11:46.590

尝试使用 explode(PHP_EOL, $_POST['9']);

使用 PHP_EOL 跨平台的兼容性更好。

如果您不想使用它，您至少需要在 \n 周围使用双引号而不是单引号。使用双引号，PHP 会将其解释为换行符，而使用单引号将查找文字 \n 作为要爆炸的字符串段。

# sql-server - 使用大量来自 C# 的存储过程

> ID：11512587
> 
> 赞同：3
> 
> 时间：2012-07-16T21:07:19.607
> 
> 标签：sql-server, entity-framework, stored-procedures, orm, petapoco

我正在查看一个项目，其中客户拥有一个带有大量 sps（大约 250 个）的遗留数据库（MS SQL）。我需要能够与我的 C# 项目中的所有这些对话，但我需要找到一种生成尽可能多的管道的好方法。

我不确定我是否应该使用 ORM 或一些代码生成工具？优点和缺点？我看过实体框架，它能够将复杂类型用作强类型模型，但我宁愿有一个 poco 模型并以某种方式填充我的对象。似乎 miniORM 喜欢 ie。PetaPoco 可能是要走的路吗？

有人对此问题有任何提示和想法要分享吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:34:47.157

您将需要一个执行反向存储过程映射的 ORM，例如[Telerik 的 OpenAccess ORM](http://www.telerik.com/help/openaccess-orm/programming-with-openaccess-reverse-mapping-stored-procedures.html)。

> Telerik OpenAccess ORM 提供了导入和使用数据库中已经存在的存储过程的能力。它们可以映射到静态方法或在内部用于替换默认的写入操作并实现自定义逻辑。

[Telerik OpenAccess](http://www.telerik.com/products/orm.aspx)现在是免费的。我猜他们意识到当有这么多免费的替代品（如 nHibernate）可用时，他们无法出售 ORM。

* * *

如果您正在寻找可以映射存储过程的轻量级替代方案，请尝试 Sam Saffron 的 Dapper。Dapper 是 Stack Overflow 的驱动力。

[https://stackoverflow.com/a/6645870](https://stackoverflow.com/a/6645870)
[http://code.google.com/p/dapper-dot-net/](http://code.google.com/p/dapper-dot-net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:00:48.843

PetaPoco 适用于存储过程。

如果你愿意，我可以用 T4 模板编写一个 Stored Proc 映射器。

您使用 PetaPoco 获得的模板（至少在我上次查看时）没有映射存储的过程。

您可能可以编辑此处使用的模板：

*   [http://erraticdev.blogspot.co.uk/2010/11/t4-template-to-generate-bltoolkit.html](http://erraticdev.blogspot.co.uk/2010/11/t4-template-to-generate-bltoolkit.html)
*   [http://code.google.com/p/bltoolkit-storedprocedures2csharp-t4/](http://code.google.com/p/bltoolkit-storedprocedures2csharp-t4/)

刚刚看到您对调用 petapoco 存储过程的方式的评论，这是真的……我只将它与 MSSQL 一起使用过，所以可能是我那里的一个站点。

# java - 如何引用从另一个来源导入的 bean？

> ID：11512589
> 
> 赞同：1
> 
> 时间：2012-07-16T21:07:44.237
> 
> 标签：java, xml, spring

我有`wireup-A.xml`一个

```
<bean id="xml-saver" class="com.org.blah.XMLSaver"/> 
```

另一个`wireup-B.xml`作为

```
<import resource="classpath:com/A/wireup-A.xml" />

    <bean id="save-xml" class="com.org.post.SaveXML">
        <constructor-arg ref="xml-saver"/>
    </bean> 
```

**问题**

怎么能`ref="xml-saver"`引用里面的bean`import resource`呢？
现在是说`can not resolve bean xml-saver`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:57:04.450

一旦我参考了正确的路径，一切都很好

```
<import resource="classpath:com/A/blah/wireup-A.xml" /> 
```

# c# - .NET 4 等效于 Task.WhenAll()

> ID：11512590
> 
> 赞同：16
> 
> 时间：2012-07-16T21:07:47.133
> 
> 标签：c#, .net-4.0, task-parallel-library, .net-4.5, async-ctp

在 .NET 4 中，是否有与 .NET 4.5 的[System.Threading.Tasks.Task.WhenAll()](http://msdn.microsoft.com/en-us/library/hh160384%28v=vs.110%29.aspx)等效的功能？

目标是将多个异步任务打包成一个，当其所有组成任务完成时完成。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-19T12:28:31.440

在 .NET Framework 4.0中，在 Visual Studio 2010 的情况下，WhenAll 和 WhenAny 可以与已安装的[AsyncCTP一起使用，在 Visual Studio 2012 的情况下，可以与](http://www.microsoft.com/en-us/download/details.aspx?id=9983)[Async Targeting Pack](http://www.microsoft.com/en-us/download/details.aspx?id=29576)一起使用。

然后在 TaskEx 类型上提供 WhenAll 和 WhenAny 方法。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-07-16T21:41:53.767

我认为 .Net 4.0 中内置的最接近的东西是[`ContinueWhenAll()`](http://msdn.microsoft.com/en-us/library/dd321258). 您可以使`continuationAction`a 简单`tasks => tasks`并使用返回的`Task`.

出于性能原因，您可能希望将其与`TaskContinuationOptions.ExecuteSynchronously`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T21:18:49.853

`Task.WaitAll()`尝试在另一个任务中等待。使用 LINQ 扩展方法`ToArray`从`IEnumerable<Task>`.`Task[]`

```
Task WhenAll(IEnumerable<Task> tasks)
{
    return Task.Factory.StartNew(() => Task.WaitAll(tasks.ToArray()));
} 
```

# tsql - 针对 INFORMATION_SCHEMA 的查询超时

> ID：11512591
> 
> 赞同：2
> 
> 时间：2012-07-16T21:07:56.580
> 
> 标签：tsql, timeout, sql-server-2000, information-schema

我正在使用 SQL Server 2008 Management Studio 连接到 SQL Server 2000。

```
use [MyPrettyDb]
select top 19 * from information_schema.tables 
```

它工作得很好，又甜又快。但是这个：

```
select top 20 * from information_schema.tables 
```

超时停止。

超时的原因是什么？

PS`select count(*) from information_schema.tables`快速返回；数据库中有 334 个表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T23:55:02.190

您可能被事务中运行的 DDL 语句阻塞。运行`DBCC OPENTRAN`或`sp_lock`确定哪个会话对此负责。

您可以通过运行以下脚本来重现这一点。

```
USE TEMPDB
GO

BEGIN TRAN
CREATE tABLE ttt(id int) 
```

在另一个会话中，运行

```
SELECT TOP 5 * FROM INFORMATION_SCHEMA.TABLES --will work

SELECT  * FROM INFORMATION_SCHEMA.TABLES --will not work 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T12:01:48.390

我已经自己解决了这个问题。该问题仅存在于 Windows 2008 中。并且 32/64 冲突。

Windows 2008 中有两个 odbc 驱动程序： 32：在 System32 文件夹（或系统）中 64：在 sys SystemWOW64

据我了解，默认情况下它使用 64 版本。但它与远程机器上的 32 版本不兼容。这就是为什么我有奇怪的行为。

运行 odbc wizzard friom 32 文件夹，它神奇地变得正常工作。

# ruby-on-rails - Ruby Markdown / 字符串处理 - 编码问题？

> ID：11512592
> 
> 赞同：1
> 
> 时间：2012-07-16T21:08:05.250
> 
> 标签：ruby-on-rails, ruby, string, encoding, markdown

下午好，

我正在尝试使用基于 javascript 的编辑器 (EpicEditor) 来允许我网站上的管理员为博客文章输入降价。单击提交按钮后，编辑器生成的字符串将发送到 Ruby/Rails 服务器，以便通过 RDiscount 处理成 HTML。

它似乎大部分都在工作，除了与`&nbsp;`, 空间等有关的东西。单击 EpicEditor 中的“预览”按钮会给出我期望的确切输出，所以我知道这与将字符串发送到服务器的方式有关。我对 ruby​​ 还是很陌生，而且对字符串编码等不太擅长。我相信这对合适的人来说是一个相当简单的问题。

为了说明这个问题 - 只显示代码可能是最好的。我正在尝试在有序列表下方输入项目符号列表。因此，降价将类似于：

`1\. Hello
2\. Goodbye
- a list
- entry
3\. For something`

我的问题似乎在有序列表条目之后的换行符内和周围。保存到数据库中的字符串以及 javascript 编辑器中的字符串看起来完全一样： `"\n - had\n"`

然而，在进一步检查中，“工作字符串”（EpicEditor 的预览视图中使用的内容）和“失败字符串”（存储在我的数据库中并通过表单传递的确切字符串）之间存在细微差别：

`working_string.each_byte {|c| puts c}
--> 10, 32, 32, 45, 32, 104, 97, 100, 10
failing_string.each_byte {|c| puts c}
--> 10, 194, 160, 32, 45, 32, 104, 97, 100, 10`

不知何故/不知何故，一个`32`字节被更改为`194 160`. 在进一步的研究中，这似乎是字符串中的常规空格与 a `\xC2`or的一些问题`\xA0`，并且（我认为）与`&nbsp;`'s.

有没有一种简单的方法可以确保字符串从 EpicEditor 正确传递到 rails 服务器，然后再传递到数据库中？如果有帮助的话，我也可以在服务器端使用字符串替换......

谢谢！

**更新 1**

我通过并试图找到确切的问题。我从 Epiceditor 中抓取了文本，从我从 Epiceditor 镜像的文本区域（与表单一起提交）、通过网络传输的参数以及数据库中的字符串。降价如下（直接从epiceditor文本区域复制：

```
## Testing this yet again

Because I want more!! More things to have a good time....

1\.  Everywhere!
2\.  Anywhere!
  - happy place
  - sad place
3\.  Goodbye 
```

如果我将其直接粘贴到此输入中，您可以看到它正确呈现：

## 再次测试这个

因为我想要更多！！更多的事情来度过美好的时光......

1.  到处！
2.  任何地方！
    *   快乐的地方
    *   伤心的地方
3.  再见

该字符串的 ASCII 字符如下：

```
[35, 35, 32, 84, 101, 115, 116, 105, 110, 103, 32, 116, 104, 105, 115, 32, 121, 101, 116, 32, 97, 103, 97, 105, 110, 10, 10, 66, 101, 99, 97, 117, 115, 101, 32, 73, 32, 119, 97, 110, 116, 32, 109, 111, 114, 101, 33, 33, 32, 77, 111, 114, 101, 32, 116, 104, 105, 110, 103, 115, 32, 116, 111, 32, 104, 97, 118, 101, 32, 97, 32, 103, 111, 111, 100, 32, 116, 105, 109, 101, 46, 46, 46, 46, 10, 10, 49, 46, 32, 32, 69, 118, 101, 114, 121, 119, 104, 101, 114, 101, 33, 10, 50, 46, 32, 32, 65, 110, 121, 119, 104, 101, 114, 101, 33, 10, 32, 32, 45, 32, 104, 97, 112, 112, 121, 32, 112, 108, 97, 99, 101, 10, 32, 32, 45, 32, 115, 97, 100, 32, 112, 108, 97, 99, 101, 10, 51, 46, 32, 32, 71, 111, 111, 100, 98, 121, 101] 
```

我正在通过 exportFile() 将编辑器内容复制到文本区域。该文本区域中的 ASCII 字符如下：

```
[35,35,32,84,101,115,116,105,110,103,32,116,104,105,115,32,121,101,116,32,97,103,97,105,110,10,10,66,101,99,97,117,115,101,32,73,32,119,97,110,116,32,109,111,114,101,33,33,32,77,111,114,101,32,116,104,105,110,103,115,32,116,111,32,104,97,118,101,32,97,32,103,111,111,100,32,116,105,109,101,46,46,46,46,10,10,49,46,32,160,69,118,101,114,121,119,104,101,114,101,33,10,50,46,32,160,65,110,121,119,104,101,114,101,33,10,160,32,45,32,104,97,112,112,121,32,112,108,97,99,101,10,160,32,45,32,115,97,100,32,112,108,97,99,101,10,51,46,32,160,71,111,111,100,98,121,101] 
```

如果你区分这些数组，我会得到以下信息：

```
textarea - epiceditor
 => [160, 160, 160, 160, 160] 
```

换句话说，`&nbsp;`exportFile() 中的 EpicEditor 似乎仍然输出了额外的 '。关于这可能来自哪里的任何想法？我完成镜像如下：

```
var post_body = $("#post_body");
var content = post_body.val();

var editor = new EpicEditor(opts);

editor.on('load', function () {
  editor.importFile(window.location.href, content); //Imports a file when the user clicks this     button
}); 

editor.on('save', function () {
  post_body.val(editor.exportFile());
}); 
```

**更新 2**

PS 以下修复了 exportFile() 输出。我很高兴至少我已经弄清楚了，但我希望能得到一些与 EpicEditor 原生兼容的东西！

```
bad = "#{194.chr}#{160.chr}".force_encoding('utf-8')
good = 32.chr
self.body = body.gsub(bad, good) 
```

# java - 记住我/保持登录状态，在 jsp 登录页面

> ID：11512593
> 
> 赞同：2
> 
> 时间：2012-07-16T21:08:06.943
> 
> 标签：java, jsp, servlets, login, remember-me

我有一个登录屏幕，我想通过检查数据库中的凭据来验证用户。我知道大多数浏览器都可以记住密码，但是如何使用浏览器 cookie 实现记住我复选框？我正在使用 sign.jsp 和 Auth servlet (doPost) 以及带有 https 的基本访问身份验证。

我知道我需要将用户 ID + 令牌存储到 cookie 中。我从另一个线程中找到了以下代码。

在您的 servlet 响应处理程序（doPost、doGet 等）中，按以下方式创建一个 cookie -

```
if(remember_me_is_checked)
{
    Cookie c = new Cookie("userid", userId.toString());
    c.setMaxAge(24*60*60);
    response.addCookie(c);  // response is an instance of type HttpServletReponse
} 
```

要阅读它们，你可以使用这样的东西 -

```
Cookie[] cookies = request.getCookies();     // request is an instance of type 
                                             //HttpServletRequest
boolean foundCookie = false;

for(int i = 0; i < cookies.length; i++)
{ 
    Cookie c = cookies[i];
    if (c.getName().equals("userid"))
    {
        string userId= c.getValue();
        foundCookie = true;
    }
} 
```

我的问题是，在我将用户信息存储到cookies后，如何在用户下次登录时自动登录？我不明白的是我只有用户的登录 ID 存储在 cookie 中，我怎么能在没有密码的情况下登录用户。我可以使用什么方法？

如果可能，请具体解释或提供一些代码。我对这种东西真的很陌生。

此致

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:48:34.857

仅在 cookie 中存储用户 ID 是不够的。我看到的最简单的解决方案是将某种密码哈希与用户 ID 一起存储。

取用户 ID + some_secret_string + 密码。

从中计算哈希函数。

将用户 ID 和计算的哈希推送到 cookie。

当用户返回时，您将获得 2 个字符串。

根据用户 ID，您将从数据库中获取密码。

再次计算哈希函数。

将计算的哈希值与 cookie 中的哈希值进行比较。

如果它们匹配 - 用户再次登录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:30:04.450

通常，我们将*令牌*（用于确定用户是否登录的状态信息）存储到 cookie 中。（不要在 cookie 中存储密码和其他凭据）。

我想建议你使用`filter`. 在 doFilter() 方法中读取 cookie 并根据 cookie 的值或 cookie 的可用性，您可以验证请求。

# ocean - 从海洋访问海燕的地震属性

> ID：11512598
> 
> 赞同：0
> 
> 时间：2012-07-16T21:08:19.953
> 
> 标签：ocean, petrel

我怎样才能访问由体积属性生成器估计的地震属性，即没有在地震集合树中发布它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T06:49:09.227

虚拟地震属性始终显示在 SeismicCube（源几何）下的树中。有什么理由隐藏虚拟属性立方体吗？

# android - 使用 NDK 构建 Tesseract 不适用于 Cygwin

> ID：11512600
> 
> 赞同：1
> 
> 时间：2012-07-16T21:08:23.690
> 
> 标签：android, android-ndk, cygwin

我正在按照[本](http://kurup87.blogspot.com/2012/03/android-ocr-tutorial-image-to-text.html)教程让 tesseract 在我的 android 项目上运行。在教程的第 6.e 步中，它说在 Cygwin 中的 ndk-build 如下所示`ndk-build(for windows user, /cygdrive/<ndk-directory>/ndk-build)`。我的 ndk 目录是`C:\Program Files\android-ndk-r8`. 但是当我尝试这个时：`/cygdrive/C:/android-ndk-r8/ndk-build`它，它给了我`No such file or directory error`。该文件确实存在于提到的目录中。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:56:11.130

你应该使用`/cygdrive/c/Program\ Files/android-ndk-r8/ndk-build`

有`ls`命令可以查看文件夹的内容。因此，请尝试执行这些命令以更好地理解文件夹层次结构：

```
ls /cygdrive
ls /cygdrive/c
ls /cygdrive/c/Program\ Files
... 
```

# c++ - 为什么一个字会大于 1 个字节？

> ID：11512601
> 
> 赞同：3
> 
> 时间：2012-07-16T21:08:24.883
> 
> 标签：c++, memory, assembly, cpu, cpu-registers

如果变量是 a`boolean`或 a `char`（在 C/C++ 中）或 a `byte`（在某些语言中，如 Java - 在 VM 上无需等待 Java）并且 CPU 使用大于 1 字节的字，是否浪费空间？我听说当变量存储在内存中时，它可以存储得更紧凑，例如 1 个字节，即使一个字是 4 个字节。有人可以解释这是怎么发生的吗？这似乎倒退了，因为寄存器比 RAM 更珍贵。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T21:29:20.073

尽管它们能够存储数字，但寄存器并不完全是“空间”。

考虑这个例子：你有一堆名片放在一个大盒子里，你想按字母顺序排列它们。在这样做的过程中，您将盒子中的卡片从一个地方移动到另一个地方。尽管您在将卡片移动到盒子中的新位置时将其握在手中，但您的手并不能像盒子那样为卡片提供存储空间。你手中的位置太宝贵了，不能称为“空间”。

继续卡片类比，想象卡片有不同的大小。你手的大小可以让你一次拿着一张大牌、两张中牌或四张小牌。然而，当你对卡片进行排序时，拿走多张卡片的能力对你来说很少有好处，尤其是当卡片被均匀洗牌时：多张卡片有多个目的地，所以如果你抓到，你需要做更复杂或不必要的操作同时多张卡。

同样，一个 CPU 的寄存器可能包含多个字节，但如果需要执行计算，通常没有办法告诉 CPU 使用哪些字节：寄存器作为不可分割的单元参与操作。这就是为什么寄存器中的数据使用一个完整的字，即使只有一个字节就足够了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-16T21:10:51.210

一般来说，一个[词](http://en.wikipedia.org/wiki/Word_%28computer_architecture%29)是适合单个寄存器的数据量。

如果您使寄存器更窄，例如 8 位，则添加 2 个 32 位整数需要多个周期。

我还认为您希望您的 RAM 地址空间也适合一个单词。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T05:49:28.730

对于每个指令集，都有这些类型的定义。例如，一个字节是 8 位或 9 位或其他一些大小。该架构定义了一个词来表示某事。

8086/8088 将一个字节定义为 8 位，将一个字定义为 16 位。您有 16 位寄存器，但您也可以将它们用作 8 位半寄存器 ax 是 16 位寄存器 ah 是 ax 的上半部分，al 是下半部分。不典型，但他们是如何做到的。后来 80x86 EAX 变成了 32 位寄存器，其中 ax 是下半部分，依此类推。由于一个字被定义为 16 位 EAX 被定义为一个双字或双字。后来出现了 64 位寄存器……在这种架构中，64 位被称为四字。

ARM 定义一个字节为 8 位，半字为 16 位，一个字为 32 位。其他人也这样做。

那是在硬件层面。然后你进入编程语言，他们可以自由地更改定义，以及可能想要利用 typedef 或语言中的任何东西来创建或更改其他定义的程序员，并且可以自由地制作他们想要的任何大小。语言大小不必与硬件匹配，有时这样做是个好主意，但他们不必这样做，这取决于为特定目标实现该编译器和/或后端的人。

关于废...

x86 架构使用可变字长指令。这意味着有一些8位指令，一些16位指令，24位，32位等。您可能想从一个寄存器移动到另一个，该指令可能只需要一个字节，但如果您想将一个 16 位值移动到一个寄存器中，这可能需要一个字节来表示我想将一个立即数移动到一个寄存器中，然后再定义两个字节来定义该指令的立即数，总共三个字节。指令集是在内存为 8 位宽时发明的，对于 8 位宽的内存系统，这是有道理的。现在我们使用 32 位和 64 位宽的内存系统，这是非常痛苦的。然而，指令集有 8 位寄存器，ah、al、bh、bl 等，并且可以对 8 位寄存器进行 8 位操作。因此，将 bool 或其他类似的东西设为字节大小以节省一些空间可能是有意义的。无论如何，你已经在没有对齐的情况下将你的内存分割成可变大小，也许是这样。

ARM，考虑传统的 ARM（不是 thumb/thumb2），指令总是 32 位宽，不多不少。寄存器多于 x86 位，它们不分为半寄存器或字节大小的寄存器。你没有像比较等 8 位操作。一切都是 32 位的，因为它是通过寄存器完成的（有一些小的立即数，是的）。如果您的高级语言中有一个变量永远不会小于 -5 或大于 +20，那么您可能希望在高级语言中使用有符号字节以节省一些空间。您会发现有时您必须使用额外的指令来对数据进行符号扩展或屏蔽，以使用 32 位寄存器模拟 8 位操作。节省 3 个字节会花费您 4 个或 8 个或更多。32 位 int 会比有符号字节便宜。

存在对齐问题，只是因为 x86 允许未对齐的访问（比如使用 32 位数据总线从/到地址 0x4 的 32 位读/写），它会花费额外的周期。ARM 和其他人不允许这样做。但是出于同样的原因，即使通过缓存，字节写入也会花费您读取-修改-写入，因为缓存可能是 32 位宽的 ram。要更改一个字节，您必须读取 32 位，修改 8 并写回 32。成本时钟周期。如果您使用 32 位变量而不是 8 位变量，即使该变量可能永远不会超出 -5 到 +20 的范围。你花费了更多的时钟周期。更多的浪费。

现在关于您的问题，为什么具有 8 位寄存器的系统比 32 位系统需要更多的周期来添加 32 位数字。当您很可能上小学并学会用铅笔和纸添加时，您已经知道了这个问题的答案。

如果我想在允许使用 3 位寄存器的世界中添加十进制数 123+789，我可以在一个周期内执行该添加：

```
 110 <--- carry bits/numbers
 123
+789
====
 912 
```

将其视为基于 32 位寄存器的系统。现在对于基于 8 位寄存器的系统，世界一次只允许一个数字：

一个循环 3 + 9，进位为 0

```
 10 
  3
+ 9
====
  2 
```

进位是1，我们必须执行那个操作才能得到进位，所以我们可以用它作为下一组寄存器的下一个操作的进位，下一个周期2 + 8，我们的进位为1

```
 11 
  2
+ 8
====
  1 
```

进位也是一个，第三个循环 1 + 7，进位为 1

```
 01
  1
+ 7
====
  9 
```

如果我们需要它，执行是 0...

数字系统无关紧要（以 10 为底，以 2 为底等），它们的工作原理都是一样的。

现在，如果您要问的问题是，例如，我有 2 和 3，并且想将它们加在一起，那么在 64 位处理器中使用两个 64 位寄存器来执行以下操作似乎确实是一种巨大的浪费只需要几列。同样，将它们保存到内存等。对于布尔值或 alu 操作（加法或等），寄存器的宽度无关紧要，它是为该宽度设计的，流水线平均一个时钟。无论如何，它都会执行 64 位加法。是的，这是很多浪费的逻辑空间。见上文，您可以选择使用更少的逻辑但更多的时钟或更多的逻辑和更少的时钟。更多时钟的解决方案也可能涉及更多的内存周期，从而花费更多的时钟。更宽的变量可能会浪费更多的内存，但在更宽的内存系统上使用更少的时钟。这都是一种权衡。现在逻辑在几千兆赫兹中达到最大值，内存非常慢，但是通过使总线更宽和其他并行技巧，您可以使其看起来更快。如果您要以时钟周期为代价来节省逻辑和内存上的钱，您可能无法实时观看 youtube 视频，或者无法看到足够的像素来查看正在发生的事情。或上网，因为绘制通常使用数学函数压缩的字体和图像需要很长时间，用户无法忍受。

我建议你看一下微芯片 pic 指令集

[http://en.wikipedia.org/wiki/Microchip_PIC](http://en.wikipedia.org/wiki/Microchip_PIC)

上页列出的 12 位指令集表。想想您编写的最后一个程序并使用该指令集实现该程序。更好的是，使用 pic 指令集添加三个简单的数字。它只有一个寄存器，要进行数学运算，您必须将一个操作数放入 w 寄存器，使用 f 寄存器执行数学运算，如果您不想弄乱 f 寄存器的内容，可以说，然后您离开导致 w 寄存器。现在，添加另一个 f 寄存器，结果到 w，然后添加第三个寄存器，结果到 w，然后将 w 保存在第四个 f 寄存器中。d = a+b+c。当然，在 arm 或 mips 或其他任何操作上，如果您只需要 a、b、c 来执行一个操作，则您必须执行 3 次读取然后添加，但如果这些操作数中的一个或多个是其他操作的结果，不需要存储到 ram 因为我们有更多的寄存器等，你开始看到规模经济。6502（表面上，除非您了解零页）和其他指令集旨在以时钟周期为代价减少逻辑，减少内存。对于较旧的设计（包括 x86），这是因为逻辑的制造和构建（相对）成本很高，而内存也同样昂贵。

您可以以一条指令为代价，以时钟周期为代价对处理器进行这种简化。

[http://en.wikipedia.org/wiki/Single_instruction_set_computer](http://en.wikipedia.org/wiki/Single_instruction_set_computer)

opencores.org 有几个这样的一个或几个指令处理器。

您提到了 java，如果您要在硬件中构建它，它的虚拟机会以时钟周期为代价（具有可移植性）。有关基于堆栈的处理器的示例（不是 java，只是基于堆栈的解决方案的另一个示例），请参见 opencores 的 zpu。当然不是用 java 发明的，pascal 最初是基于堆栈的伪代码，然后您在目标上实现了该伪代码。small-c 生成的基于堆栈的程序，您为每个目标实现等等。基于堆栈的解决方案非常便携，但以时钟周期为代价。

对您的问题的简短回答是，不要过分关注微观，退后一点，看看整个画面。我们在处理器中使用越来越大的寄存器的原因是因为速度，大多数时候您不会在 64 位处理器上的 alu 操作中使用所有这些地址位或数据位，非常正确，但是对于您确实，那些更宽的寄存器、更宽的总线和存储器会产生巨大的性能差异，足以弥补其他地方的浪费。无论如何，浪费相当便宜，处理器、内存、磁盘空间的成本，如果需要提供相同的用户体验或足够接近，8 位千兆赫系统不会比 64 位千兆赫系统便宜 8 倍相同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T21:12:32.503

它与总线宽度有关。处理器的每个时钟周期都会根据总线宽度向前移动整个处理器，因此可能无法优化每个操作数类型的寄存器宽度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T21:24:36.547

通过使用体系结构的存储字节指令（通常将寄存器的低位存储在内存位置），您可以从字大小的寄存器将一个字节的值存储在内存中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-16T22:07:12.163

许多早期的计算机以较小的增量存储数据，通常为 4 或 6 位数字。当数据路径很窄并且算术是串行完成时，这工作得相当好，一次一个数字。而且它的存储效率很高（这是一种珍贵的商品）。

存储不再那么珍贵——吞吐量是——并且计算机可以通过更宽的数据路径实现更好的吞吐量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-17T00:53:39.837

需要考虑的一件事：

用于处理器设计的“现代”（约 1985 年）RISC 方案考虑到，与处理器芯片的“成本”（在芯片“房地产”中）相比，在处理器芯片上放置大量相当宽的寄存器相对便宜。 “控制逻辑”。

虽然有理由质疑这个论点的全部真实性，但它确实有一些真实的元素，虽然一个寄存器比相同数量的 RAM 贵很多倍（可能是 1000 或更多），但它仍然相对便宜。使寄存器更窄并需要更多周期来完成相同的操作将是错误的经济。相反，设计师试图在一个周期内尽可能多地完成。

# c# - FluentNHibernate 单向多对多关联

> ID：11512604
> 
> 赞同：2
> 
> 时间：2012-07-16T21:08:30.543
> 
> 标签：c#, nhibernate, fluent-nhibernate, fluent-nhibernate-mapping

我对多对多映射有疑问。这就是我所拥有的：

```
public class Asset
{
    public virtual int id {get;set;}
    //other props
    public virtual IList<Tag> Tags { get; set; }
}

public class Tag
{
    public virtual int Id { get; set; }
    public virtual string Description { get; set; }
    public virtual string Slug { get; set; }
} 
```

映射单向多对多

```
public class AssetMap : IAutoMappingOverride<Asset>
{

    public void Override(AutoMapping<Asset> mapping)
    {
        mapping.HasManyToMany(x => x.Tags)
        .Table("AssetTag")
        .ParentKeyColumn("AssetId")
        .ChildKeyColumn("TagId")
        .Cascade.SaveUpdate();
    }
} 
```

我的第一个问题是：映射正确吗？

眼下：

```
var asset = new Asset
    {
         //props
    };

asset.Tags.Add(new Tag{...});
repository.Save(asset) 
```

它插入标签，但没有在中间表“AssetTag”中插入任何标签

和

```
var asset = new Asset
    {
         //props
    };

asset.Tags.Add(existing TAG);
repository.Save(asset) 
```

它确实插入了资产，但没有在中间表“AssetTag”中插入任何资产

谢谢你的帮助，丹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T12:29:04.397

映射是正确的。

我使用几乎相同的结构、相同的映射、NHibernate 3.3.1.4000、SQL Server 2005，它工作正常。唯一的区别是我在主对象的构造函数中初始化列表。我还允许 NH 创建模式，包括。关系表。

# django - 是否可以从 Django 请求中检测到浏览器刷新？

> ID：11512608
> 
> 赞同：4
> 
> 时间：2012-07-16T21:09:01.607
> 
> 标签：django

是否可以在 Django 请求中检测用户的浏览器刷新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:35:51.157

就其本身而言，我相信仅通过查看请求对象就无法知道页面是否已刷新。客户可以很容易地打开页面的第二个版本。您还必须保留有关所有请求的一些状态数据，以便比较时间戳之类的内容，但这只是对实际发生的情况的假设......

您可能会做的是在 django 中检查请求和一些 javascript 魔术的组合。这样做的原因是，客户端是唯一真正知道页面刷新是否正在发生并且必须为此操作记录一些状态的客户端。在这里快速搜索一下这个小教程：[检测页面刷新:: 在客户端使用 JavaScript](http://www.tedpavlic.com/post_detect_refresh_with_javascript.php)。它捕获页面卸载并设置 cookie 值，然后在下一次重新加载时检查。您可以使用该方法的一部分来设置 cookie，然后检查 django 视图中的[request.cookies](https://docs.djangoproject.com/en/dev/ref/request-response/#django.http.HttpRequest.COOKIES)以查看该请求是否记录了页面重新加载事件。

*注意：我链接的那个javascript页面有点旧，但信息仍然相关。这是一个[类似的SO问题](https://stackoverflow.com/questions/5004978/check-if-page-reloaded-or-refresh-in-js)

# css - 根据内容或父元素拉伸元素

> ID：11512615
> 
> 赞同：0
> 
> 时间：2012-07-16T21:09:48.727
> 
> 标签：css, positioning

是否有一种非 javascript 方法可以相对于其父元素（如果内容太短）或跟随内容来拉伸元素。这里有三张图片来解释这个话题：

![内容少](../Images/36c68f8abd6107f915ed9e16e45cef93.png)
这是一个20px的`div`位置`absolute``top``bottom`

![很多内容](../Images/2d1ddc1ec21554189d144e529102bb3b.png)
这是一些内容更多“破坏”的情况，`div`这不是它应该的方式。

![应该看起来像这样](../Images/70128bfabf1a7c4fb6fdd067f1343bc7.png)
你明白吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:13:26.153

当然，不要`position: absolute`内部 div。

```
<style type="text/css">
    * {
        margin: 0;
        padding: 0;
    }
    #outer {
        background: #ccc;
        padding: 20px;
        margin: 20px;
        width: 200px;
        height: 100px;
        overflow-y: auto;
    }
    #inner {
        background: white;
        border: 1px black solid;
        box-sizing: border-box;
        min-height: 100%;                
    }
</style>
<div id=outer>
    <div id=inner>
        <p>Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum
            tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas
            semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo. Quisque sit amet est et sapien
            ullamcorper pharetra. Vestibulum erat wisi, condimentum sed, commodo vitae, ornare sit amet, wisi. Aenean
            fermentum, elit eget tincidunt condimentum, eros ipsum rutrum orci, sagittis tempus lacus enim ac dui. Donec
            non enim in turpis pulvinar facilisis. Ut felis. Praesent dapibus, neque id cursus faucibus, tortor neque
            egestas augue, eu vulputate magna eros eu erat. Aliquam erat volutpat. Nam dui mi, tincidunt quis, accumsan
            porttitor, facilisis luctus, metus</p>
    </div>
</div> 
```

**[现场示例](http://jsfiddle.net/QkXdZ/)**

# php - 无法使用 mysqli、mysqli_connect 或 PDO 连接到数据库

> ID：11512625
> 
> 赞同：0
> 
> 时间：2012-07-16T21:10:44.787
> 
> 标签：php, pdo, mysqli

我曾尝试将 php 连接到我的数据库，但完全不成功；（我不断收到类似的消息：“PHP 通知：未定义变量：conn”我尝试了以下各项：

```
$conn = new PDO("mysql:host=localhost;dbname=ar_data", 'login', 'pass');
$conn = mysqli('localhost', 'login', 'pass', 'dbname') or die("error" :.mysqli_connect_error());
$conn = mysqli_connect('localhost', 'login', 'pass', 'ar_data') or die("error" :.mysqli_connect_error()); 
```

在我尝试了最后一个之后，我得到了这个`var_dump($conn)`：

```
object(mysqli)#17 (18) { ["affected_rows"]=> int(0) ["client_info"]=> string(78) 
"mysqlnd 5.0.8-dev - 20102224 - $Id: SOME_VALUE_I_AM_CENSORING $" 
["client_version"]=> int(50008) ["connect_errno"]=> int(0) ["connect_error"]=> NULL 
["errno"]=> int(0) ["error"]=> string(0) "" ["field_count"]=> int(0) ["host_info"]=> 
string(20) "localhost via TCP/IP" ["info"]=> NULL ["insert_id"]=> int(0) ["server_info"]=>
string(6) "5.5.25" ["server_version"]=> int(50525) ["stat"]=> string(140) "Uptime: 477847 
Threads: 6 Questions: 202259 Slow queries: 1 Opens: 1454 Flush tables: 1 Open tables: 10 
Queries per second avg: 0.423" ["sqlstate"]=> string(5) "00000" 
["protocol_version"]=> int(10)
["thread_id"]=> int(1506) ["warning_count"]=> int(0) } 
```

此外，我尝试使用对 ar_data 数据库没有权限的用户，它会按预期给我一个错误。如果我`var_dump($conn)`在 a 之前这样做，`mysqli_prepare($conn, $sql)`那么它将打印 NULL。如何连接到数据库？

注意：我已将名称从 conn 更改为其他变量，以防它被更改但行为仍然相同。我还安装了 Drupal 7 和 Wordpress（我想他们只是使用基本的 msql 进行连接）

更新：

整个文件：[https ://dl.dropbox.com/u/6688861/phpconn.txt](https://dl.dropbox.com/u/6688861/phpconn.txt)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:14:04.880

最后一个`var_dump`表示连接工作正常。您的问题是您在函数中引用而没有在`$conn`该`ValidateForm()`函数中声明`global $conn`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:16:46.543

在最后一个结果中，您的连接很好。如果您的连接不起作用，您将无法取回 MySQL 服务器信息。您在哪里得到与此调用相关的未定义变量错误？了解更多上下文可能会有所帮助。

# jquery - jQuery animate() 事件在 IE 中不起作用

> ID：11512627
> 
> 赞同：0
> 
> 时间：2012-07-16T21:10:52.963
> 
> 标签：jquery, jquery-animate

我正在开发一个热点，其中有球从窗口顶部落到底部。你可以在这里看到：xxxx

此动画适用于所有现代浏览器。顺便说一句，热点已完成。

唯一的问题是在 Internet Explorer < 9 上，其中将球设置为动画到底部的功能不起作用。IE 根本不调用它，在您调用之前停止所有脚本。

功能是：

```
function bolaQueda1(bola, altura, tempo, esquerda) {
                esquerda = $(bola).css('left');
                $(bola).animate({
                    left: esquerda + '%',
                    top: altura + '%'
                }, tempo, "easeOutQuad");
                $(bola).attr('data-destino',altura);
                $(bola).attr('data-tempo',tempo);
            } 
```

有谁知道是什么问题？

非常感谢。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:50:34.443

尝试设置要移动的元素的初始位置。也许设置“顶部”和“左侧”（我认为你的情况）。

```
.ball{
    position: absolute; top: 0; left: 0;
} 
```

# join - 模型用户 - CouchDB 中的组关系

> ID：11512631
> 
> 赞同：1
> 
> 时间：2012-07-16T21:11:12.893
> 
> 标签：join, couchdb

我有要存储在 CouchDB 中的组和用户文档，用户可以加入多个组。一个组可以有数千个用户。以下是我提出的文件：

```
Group: { "_id":"group1", "name":"abc", "type":"group" }
Group: { "_id":"group2", "name":"abc", "type":"group" }
User: { "_id":"user1", "login":"whatever", "groupIds": ["group1" , "group2"], "type":"user" }
User: { "_id":"user2", "login":"whatever", "groupIds": ["group2"], "type":"user" } 
```

我想按用户 ID 获取组。似乎我能做的最好的事情就是定义这个视图：

```
function(doc) {
  if (doc.type == "user")
  {
    emit(doc._id, doc.groupIds);
  }
} 
```

但在这种情况下，我需要在一个请求中获取组 ID，然后在单独的请求中获取每个组。有没有办法编写`groups by user id`视图，以便所有组都在一个请求中返回给 CouchDB？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:20:11.483

您可以使用链接文档语法来获取给定用户的组文档列表。创建此视图：

```
function(doc) {
  if( doc.type === 'user' ) {
    var gids = doc.groupIds;
    for( var i=0, l=gids.length; i<l; i++) {
      emit( doc._id, { '_id': gids[i] } );
    }
  }
} 
```

然后您将使用`include_docs=true`参数查询它，Couch 会看到特殊值`{ "_id": "group1" }`并为您检索该链接文档。您最终将`doc`在返回的哈希行的元素中获得所有组文档。

# iphone - 为什么我不能更改 UIBarButtonSystemItemPageCurl 项目色调？

> ID：11512632
> 
> 赞同：0
> 
> 时间：2012-07-16T21:11:18.450
> 
> 标签：iphone, uitoolbar, page-curl, tint, uitoolbaritem

我正在使用带有 StoryBoards 的 iOS 5.1。我想改变标准页面卷曲按钮的色调，但我似乎也做不到。

该按钮位于视图控制器上，是导航控制器的推送视图控制器。工具栏是推断出来的，因为我更改了导航控制器上的色调。工具栏以所需的颜色出现。

我的 viewDidLoad 方法如下：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // adjust the color of the curl button
    if (self.curlButton) {
        NSMutableArray * toolbarItems = [self.toolbarItems mutableCopy];
        [toolbarItems removeObject:self.curlButton];
        UIColor *barColor = self.navigationController.toolbar.tintColor;
        UIBarButtonItem *newPageCurl = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemPageCurl target:self.curlButton.target action:self.curlButton.action];
        newPageCurl.tintColor = barColor;
        NSLog(@"%@", newPageCurl.tintColor);
        [toolbarItems addObject:newPageCurl];
        self.toolbarItems = toolbarItems;
    }
} 
```

`self.curlButton`是在 Interface Builder 中配置的页面卷曲按钮的出口。

我已经尝试将色调设置为`self.curlButton`，最初为 nil，但这不起作用，按钮是相同的蓝色色调。

SO上的一些答案说你必须以编程方式创建一个新按钮，这就是我在这里尝试的。

我已验证`barColor`包含正确的颜色。我注释掉了这`removeObject`条线并且正确地产生了两个卷曲按钮，但都是蓝色的。

NSLog 验证`newPageCurl`按钮是否设置了正确的色调。

我尝试这样做`viewDidAppear`，以防需要首先显示工具栏，但按钮仍然是蓝色并且没有使用新的色调。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:37:36.170

从 iOS 5 开始，您应该能够使用外观选择器来执行此操作。

（编辑，很抱歉让 curl 按钮误入歧途。外观或外观WhenContainedIn：似乎适用于除 curl 按钮之外的所有内容......甚至其他系统栏按钮项目。对于 curl，一位用户说[UIBarButtonSystemItem PageCurl 的解决方案不会改变工具栏的颜色](https://stackoverflow.com/q/11123883/774691)有效，但是当我测试它时，它对我不起作用。）

```
 if ([[UIBarButtonItem class] respondsToSelector:@selector(appearanceWhenContainedIn:)])
    {
        id barButtonAppearance
          = [UIBarButtonItem appearanceWhenContainedIn:[UINavigationBar class], nil];
        [barButtonAppearance setTintColor:self.navigationController.toolbar.tintColor];
        barButtonAppearance
          = [UIBarButtonItem appearanceWhenContainedIn:[UIToolBar class], nil];
        // you'll have to have toolbar already, or pick something like [UIColor chartreuseColor] or whatever
        [barButtonAppearance setTintColor:toolbar.tintColor];
    } 
```

# opencv - opencv 潜在支持向量机

> ID：11512637
> 
> 赞同：15
> 
> 时间：2012-07-16T21:12:05.637
> 
> 标签：opencv, computer-vision

我想使用基于零件的模型进行对象分类。为此，我在 opencv 中选择了潜在的 svm。

1.  任何人都可以向我指出如何使用潜在 svm 检测器的教程或示例
2.  如何训练新的潜在 svm 检测器

# ruby - 如何将 config.ru 文件转换为单个 Rack 应用程序？

> ID：11512641
> 
> 赞同：10
> 
> 时间：2012-07-16T21:12:26.207
> 
> 标签：ruby, rack

我有一个开始有重复代码的 config.ru 文件：

```
map '/route1' do
  run SampleApp.new
end

map '/route2' do
  run SampleApp.new
end 
```

我想把这个 config.ru 文件变成它自己的 Rack 应用程序，这样我所要做的就是：

```
map '/' do
  run MyApp.new
end 
```

创建自己的 Rack 应用程序的正确方法是什么？具体来说，我怎样才能创建一个类，以便我可以使用`map`我的类中的方法来定义一堆路由？

* * *

解决方案：

这是一个有效的解决方案：

```
class MyApp

  def initialize
    @app = Rack::Builder.new do
      # copy contents of your config.ru into this block
      map '/route1' do
        run SampleApp.new
      end

      map '/route2' do
        run SampleApp.new
      end
    end
  end

  def call(env)
    @app.call(env)
  end
end 
```

我之前尝试过这个，但无法让它工作，因为我试图将实例变量传递给`map`块。例如：

```
def initialize
  @sample_app = SampleApp.new
  @app = Rack::Builder.new do
    map '/route1' do
      run @sample_app   # will not work
    end
  end
end 
```

这不起作用的原因是因为正在传递给的块正在[实例](https://github.com/rack/rack/blob/master/lib/rack/builder.rb#L51)`map`的上下文中进行[评估`Rack::Builder`](https://github.com/rack/rack/blob/master/lib/rack/builder.rb#L51)。

但是，如果我传递一个局部变量，它将起作用：

```
def initialize
  sample_app = SampleApp.new
  @app = Rack::Builder.new do
    map '/route1' do
      run sample_app   # will work
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-16T21:50:43.263

中使用的 DSL`config.ru`定义在[`Rack::Builder`](https://github.com/rack/rack/blob/master/lib/rack/builder.rb). 使用 a`config.ru`时，文件的内容将传递给 的实例`Builder`以创建 Rack 应用程序。您可以直接在代码中自己执行此操作。

例如，您可以获取现有 的内容`config.ru`，并从中创建一个新类：

```
require 'rack'

class MyApp

  def initialize
    @app = Rack::Builder.new do
      # copy contents of your config.ru into this block
      map '/route1' do
        run SampleApp.new
      end

      map '/route2' do
        run SampleApp.new
      end
    end
  end

  def call(env)
    @app.call(env)
  end
end 
```

您需要该`call`方法，以便您的类是一个 Rack 应用程序，但您可以将请求转发到您使用创建的应用程序`Builder`。然后，您可以创建`config.ru`使用新应用的新应用：

```
require './my_app'

run MyApp.new 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T21:26:09.627

这是一个*非常*基本的例子。您可能应该考虑`Rack::Response`处理响应而不是自己构建它，但它可以让您很好地了解基本 Rack 中间件的工作原理：

```
class MyApp
  def call(env)
    request = Rack::Request.new(env)
    headers = { 'Content-Type' => 'text/html' }

    case request.path
    when '/'
      [200, headers, ["You're at the root url!"]]
    when '/foo'
      [200, headers, ["You're at /foo!"]]
    else
      [404, headers, ["Uh oh, path not found!"]]
    end
  end
end 
```

* * *

编辑：

将多个 Rack 应用程序映射为一个：

```
class RootApp
  def call(env)
    [200, {'Content-Type' => 'text/html' }, ['Main root url']]
  end
end

class FooApp
  def call(env)
    [200, {'Content-Type' => 'text/html' }, ['Foo app url!']]
  end
end

class MyApp
  def initialize
    @apps = {}
  end

  def map(route, app)
    @apps[route] = app
  end

  def call(env)
    request = Rack::Request.new(env)

    if @apps[request.path]
      @apps[request.path].call(env)
    else
      [404, {'Content-Type' => 'text/html' }, ['404 not found']]
    end
  end
end

app = MyApp.new
app.map '/', RootApp.new
app.map '/foo', FooApp.new

run app 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-11T04:42:14.050

使用 URLMap 怎么样？

```
app = Rack::URLMap.new(
  "/path1" => Path1App.new,
  "/path2" => Path2App.new
)

run app 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T21:29:46.723

我这样做：

```
class MyApp 
  def call(env)
    @env = env

    # REQUEST_URI is still encoded; split before decoding to allow encoded slashes
    @path = env['REQUEST_URI'].split('/')

    # REQUEST_URI starts with a slash, so delete blank first element
    @path.delete_at(0)

    @path.each_index do |i|
      @path[i]= CGI.unescape(@path[i])
    end

    route()
  end
end 
```

然后`route()`可以做任何它想要路由请求的事情，例如：

```
class MyApp 
  def route
    m = @env['REQUEST_METHOD']
    @section = @path.shift

    if not @section
      home()
    elsif @section == 'route1' and m == 'GET'
      route1()
    # else ...
    end
  end
end 
```

# ajax - CakePHP AuthComponent 使用没有表单的 Ajax 登录？

> ID：11512651
> 
> 赞同：2
> 
> 时间：2012-07-16T21:12:55.420
> 
> 标签：ajax, json, cakephp, authentication

我想使用 CakePHP 2.2 创建一个允许非浏览器客户端连接和存储/访问数据的应用程序。我一直在查看用户使用 UserController 中的这段代码登录的示例：

```
public function login()
{
    if($this->request->is('post'))
    {
        if($this->Auth->login())
        {
            $this->Session->setFlash('Login Passed');
        }
        else
       {
            $this->Session->setFlash('Login Failed');
        }
    }
} 
```

这是通过浏览器在浏览器上显示一个表单来完成的，用户填写“用户名”和“密码”，然后单击一个按钮提交。我知道使用 Javascript 和 Ajax，您可以“序列化”表单并将其发送到服务器，但假设我不想（或不能）使用表单，而只是让客户端发送两位信息：“用户名”和“密码”，我怎样才能通过上面的“登录”方法处理这些数据？我知道这`Auth->login`需要一个可选参数`$user`，但是有没有办法`$user`从用户名/密码组合中获取，以便我可以将其传递给`Auth->login`？我想象这样的事情：

```
public function login()
{
    if($this->request->is('post'))
    {
        if($this->Auth->login())
        {
            $this->Session->setFlash('Login Passed');
        }
        else
        {
            $this->Session->setFlash('Login Failed');
        }
    }
    else if ($this->RequestHandler->isAjax())
    {
        $tmpUser = getUser ('username', 'password'); // ????? ===> Whatever call is needed here.
        if($this->Auth->login($tmpUser))
        {
            $this->Session->setFlash('Login Passed');
        }
        else
        {
            $this->Session->setFlash('Login Failed');
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T05:10:47.933

您可以在使用Ajax 登录实现 Auth 时使用[AuthComponent :: $ajaxLogin属性。](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html#authcomponent-api)除此之外，您可以尝试以下代码：

```
public function login()
{
if($this->request->is('post'))
{
    if($this->Auth->login())
    {
        $this->Session->setFlash('Login Passed');
    }
    else
    {
        $this->Session->setFlash('Login Failed');
    }
}
else if ($this->RequestHandler->isAjax())
{
    $tmpUser['User']['username'] = $this->request->params['username'];
    $tmpUser['User']['password'] = $this->request->params['password'];
    if($this->Auth->login($tmpUser))
    {
        $this->Session->setFlash('Login Passed');
    }
    else
    {
        $this->Session->setFlash('Login Failed');
    }
}
} 
```

您可以使用 firebug 控制台检查响应。

# sql-server-2008 - 计算不同行中的值

> ID：11512654
> 
> 赞同：0
> 
> 时间：2012-07-16T21:13:28.650
> 
> 标签：sql-server-2008, count

我有一个显示 Proyects、Date 和 Estate（“Por Iniciar”、“Iniciado”、“Terminado”）的查询，但我需要一个显示存在多少个庄园的查询，例如名为 Por_Iniciar 的列并显示编号 5 ，一列名为 Iniciado 并显示数字 1 和一列名为 Terminado 并显示 1，这是我的代码：

```
select a.nombre as Proyecto,a.fecha_Ter as Fecha_Termino, b.descripcion as Estado from
Proyecto a, 
Proyecto_Estado b,
empresa c
where 
a.id_Proyecto_Estado=b.id_Proyecto_Estado  
and c.id_empresa=a.id_Empresa
and c.rut='96659140' 
```

实际上，查询显示了这一点：

![在此处输入图像描述](../Images/fd0409491489fb8d37136d5ba14c86b3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:49:02.127

听起来您正在寻找这样的东西：

```
select b.descripcion as Estado, Count(42) as [HowMany]
  from Proyecto a, Proyecto_Estado b, empresa c
  where
    a.id_Proyecto_Estado=b.id_Proyecto_Estado and
    c.id_empresa=a.id_Empresa and
    c.rut='96659140'
  group by b.descripcion 
```

# sharepoint - Windows 7 家庭高级版上的 Sharepoint 2010

> ID：11512655
> 
> 赞同：0
> 
> 时间：2012-07-16T21:13:28.463
> 
> 标签：sharepoint, sharepoint-2010

我想使用 sharepoint 2010。我已经在我的 W7 家庭高级操作系统上安装了 sharepoint Designer 2010。但它要求服务器具有sharepoint Foundation 2010。当我尝试安装 sharepoint Foundation 2010 时，它会显示错误消息，即 Home premium 不支持它。但我看到一些帖子已经有人在 windows7 Home premium 上安装了它。谁能帮我在 Windows7 Home 高级版上安装 sharepoint Foundation 2010，这样我就可以开始使用 sharepoint。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T04:56:18.753

SharePoint 2010 需要 x64，因此如果您的 Windows 7 设备是 32 位，那么您就不走运了。如果您有 64 位操作系统，您可以按照此处的说明进行操作：http: [//msdn.microsoft.com/en-us/library/ee554869.aspx](http://msdn.microsoft.com/en-us/library/ee554869.aspx)

但是，如果您有 HD 空间和足够的 RAM，我建议您为此环境创建一个 VM。SharePoint 在某些方面“接管”了您的机器。我强烈建议不要将它安装在您的主 PC 上，除非该机器仅用作服务器。

您可以 DL Virtual Box 的 VMWare Player 的免费副本来创建 VM。

# c++ - 如何将 C++ wstring UTF-8 字符打印到 Mac OS 或 Unix 终端？

> ID：11512656
> 
> 赞同：2
> 
> 时间：2012-07-16T21:13:38.337
> 
> 标签：c++, macos, unicode

如何打印`std::wstring`using `std::wcout`？

我尝试了以下内容，这是[在这里](https://stackoverflow.com/a/2557315/60628)推荐的，但它仅适用于打印此内容`¡Hola!`，但不适用于此内容`日本`：

```
#include <iostream>
#include <clocale>

int main(int argc, char* argv[])
{
  char* locale = setlocale(LC_ALL, ""); 
  std::cout << "locale: " << locale << std::endl; // "C" for me
  std::locale lollocale(locale);
  setlocale(LC_ALL, locale); 
  std::wcout.imbue(lollocale);
  std::wcout << L"¡Hola!" << std::endl; // ok
  std::wcout << L"日本" << std::endl;    // empty :(
  return 0;
} 
```

此外，以下内容（[此处](https://stackoverflow.com/a/3130688/60628)推荐）根本不打印日文字符：

```
#include <stdio.h>
#include <string>
#include <locale>
#include <iostream>

using namespace std;

int main()
{

        std::locale::global(std::locale(""));
        wstring japan = L"日本";
        wstring message = L"Welcome! Japan is ";

        message += japan;

        wprintf(message.c_str());
        wcout << message << endl;
} 
```

所有这些都在 Mac OS 10.6.8 上。使用 g++ 4.2.1，使用终端 2.1.2。

终端通常可以很好地显示字符，例如，当我`cat`输入源代码时。此外，此命令工作正常`cout << "日本" << std::endl;`，但我确实需要打印`wstring`。

我`$LANG`的是这样的：

```
$ echo $LANG 
en_US.UTF-8 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T01:51:36.470

打印 wstring 的方式是将其转换为基于 UTF-8 字符的字符串。严重[的是 wchar_t 在 Windows 或其他各种平台库之一之外毫无意义](https://stackoverflow.com/a/11107667/365496)，不幸的是，在它变得很糟糕之前，它采用了 wchar_t 的使用。

```
// move to clang and libc++ then
#include <codecvt>

int main(){
    std::wstring_convert<std::codecvt_utf8<wchar_t>,wchar_t> convert; // converts between UTF-8 and UCS-4 (given sizeof(wchar_t)==4)
    std:wstring s = L"日本";
    std::cout << convert.to_bytes(s);
} 
```

* * *

只是为了解释您显示的代码中出了什么问题；

```
char* locale = setlocale(LC_ALL, ""); 
std::cout << "locale: " << locale << std::endl; // "C" for me 
```

此处的语言环境字符串是应用更改后的语言环境名称。既然你说你得到“C”，这意味着你正在使用“C”语言环境。通常人们会得到一个像“en_US.UTF-8”这样的名称，但无论出于何种原因，您的环境都没有为此正确设置。您表明`$LANG`设置正确，但其他语言环境变量之一可能设置不同。

在任何情况下，您都在使用“C”语言环境，它只需要支持基本字符集。我相信在 OS X 上，你会得到的行为是 any`char`将直接转换为相同的`wchar_t`值，并且只有`wchar_t`在 支持的范围内的值`char`才会转换回来。这实际上与使用基于 ISO 8859-1 的语言环境相同，因此无法使用日文字符。

* * *

如果你真的坚持让这个基于语言环境的东西工作，那么你需要获得一个合适的语言环境，一个使用 UTF-8 的语言环境。你可以找出你的环境出了什么问题，或者你可以使用一个不可移植的、明确的语言环境名称。

```
std::wcout.imbue(std::locale("en_US.UTF-8"));
std::wcout << L"¡Hola!\n";
std::wcout << L"日本\n"; 
```

此外，如果您使用的是 libstdc++，您应该知道它在 OS X 上不支持正确的语言环境。您必须使用 libc++ 才能使 OS X 的语言环境名称（例如，“en_US.UTF-8”）工作.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T21:59:38.453

根据有关 libstdc++ 的多个错误报告（例如[http://gcc.gnu.org/bugzilla/show_bug.cgi?id=35353](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=35353)），C 运行时和 libstdc++ 之间存在令人讨厌的交互，似乎没有人急于尝试修复它，可能是因为 utf-8 在大多数情况下“正常工作”。

错误报告提到了两种解决方法，使用`ios_base::sync_with_stdio(false)`或`locale::global(...)`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-01-26T06:54:09.363

默认编码：

> *   Windows UTF-16。
> *   Linux UTF-8。
> *   macOS UTF-8。

我的解决方案步骤，包括空字符 \0 （避免截断）。不使用 windows.h 标头上的函数：

> 1.  **添加宏以检测平台。** Windows/Linux 和其他

> 2.  **创建函数以将 std::wstring 转换为 std::string 并将 std::string 反转为 std::wstring**

> 3.  **创建打印功能**

> 4.  **打印 std::string/ std::wstring**

检查[RawString 文字](https://en.cppreference.com/w/cpp/string/basic_string/operator%22%22s)。原始字符串后缀。

Linux 代码。使用**std::cout**直接打印**std::string**，Linux 上的默认编码是 UTF-8，不需要额外的功能。

 **在 Windows 上，如果您需要打印 unicode。我们可以使用[WriteConsole](https://docs.microsoft.com/en-us/windows/console/writeconsole)从 std::wstring 打印 unicode 字符。

**终于在Windows上。您需要对控制台中的 unicode 字符提供强大而完整的视图支持。** 我推荐[Windows 终端](https://docs.microsoft.com/en-us/windows/terminal/)

**质量保证**

> *   使用 VC++ 在 Microsoft Visual Studio 2019 上测试；标准=c++17。（视窗项目）
> *   使用 Clang 编译器在 repl.it 上测试；标准=c++17。

> **问**：为什么不使用`<codecvt>`标头函数和类？
> **A.**弃用 [删除或弃用的功能](https://isocpp.org/files/papers/p0636r0.html)不可能在 VC++ 上构建，但在 g++ 上没有问题。我更喜欢 0 警告和头痛。

> **问**：std ::wstring 是跨平台的吗？
> **答：**不，std::wstring 使用 wchar_t 元素。在 Windows 上 wchar_t 大小为 2 个字节，每个字符以 UTF-16 单元存储，如果字符大于 U+FFFF，则该字符以称为代理对的两个 UTF-16 单元（2 个 wchar_t 元素）表示。在 Linux 上 wchar_t 大小为 4 个字节，每个字符存储在一个 wchar_t 元素中，不需要代理对。检查[UNIX、Linux 和 Windowsl 上的标准数据类型](https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_9.0.0/com.ibm.mq.ref.dev.doc/q104610_.html)。

> **问**：std ::string 是跨平台的吗？
> **答：**是的。std::string 使用 char 元素。char 类型保证在大多数编译器中具有相同的字节大小。char 类型大小为 1 字节。检查[UNIX、Linux 和 Windowsl 上的标准数据类型](https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_9.0.0/com.ibm.mq.ref.dev.doc/q104610_.html)。

**完整的示例代码**

```
 #include <iostream>
#include <set>
#include <string>
#include <locale>

// WINDOWS
#if (_WIN32)
#include <Windows.h>
#include <conio.h>
#define WINDOWS_PLATFORM 1
#define DLLCALL STDCALL
#define DLLIMPORT _declspec(dllimport)
#define DLLEXPORT _declspec(dllexport)
#define DLLPRIVATE
#define NOMINMAX

//EMSCRIPTEN
#elif defined(__EMSCRIPTEN__)
#include <emscripten/emscripten.h>
#include <emscripten/bind.h>
#include <unistd.h>
#include <termios.h>
#define EMSCRIPTEN_PLATFORM 1
#define DLLCALL
#define DLLIMPORT
#define DLLEXPORT __attribute__((visibility("default")))
#define DLLPRIVATE __attribute__((visibility("hidden")))

// LINUX - Ubuntu, Fedora, , Centos, Debian, RedHat
#elif (__LINUX__ || __gnu_linux__ || __linux__ || __linux || linux)
#define LINUX_PLATFORM 1
#include <unistd.h>
#include <termios.h>
#define DLLCALL CDECL
#define DLLIMPORT
#define DLLEXPORT __attribute__((visibility("default")))
#define DLLPRIVATE __attribute__((visibility("hidden")))
#define CoTaskMemAlloc(p) malloc(p)
#define CoTaskMemFree(p) free(p)

//ANDROID
#elif (__ANDROID__ || ANDROID)
#define ANDROID_PLATFORM 1
#define DLLCALL
#define DLLIMPORT
#define DLLEXPORT __attribute__((visibility("default")))
#define DLLPRIVATE __attribute__((visibility("hidden")))

//MACOS
#elif defined(__APPLE__)
#include <unistd.h>
#include <termios.h>
#define DLLCALL
#define DLLIMPORT
#define DLLEXPORT __attribute__((visibility("default")))
#define DLLPRIVATE __attribute__((visibility("hidden")))
#include "TargetConditionals.h"
#if TARGET_OS_IPHONE && TARGET_IPHONE_SIMULATOR
#define IOS_SIMULATOR_PLATFORM 1
#elif TARGET_OS_IPHONE
#define IOS_PLATFORM 1
#elif TARGET_OS_MAC
#define MACOS_PLATFORM 1
#else

#endif

#endif

typedef std::string String;
typedef std::wstring WString;

#define EMPTY_STRING u8""s
#define EMPTY_WSTRING L""s

using namespace std::literals::string_literals;

class Strings
{
public:
    static String WideStringToString(const WString& wstr)
    {
        if (wstr.empty())
        {
            return String();
        }
        size_t pos;
        size_t begin = 0;
        String ret;

#if WINDOWS_PLATFORM
        int size;
        pos = wstr.find(static_cast<wchar_t>(0), begin);
        while (pos != WString::npos && begin < wstr.length())
        {
            WString segment = WString(&wstr[begin], pos - begin);
            size = WideCharToMultiByte(CP_UTF8, WC_ERR_INVALID_CHARS, &segment[0], segment.size(), NULL, 0, NULL, NULL);
            String converted = String(size, 0);
            WideCharToMultiByte(CP_UTF8, WC_ERR_INVALID_CHARS, &segment[0], segment.size(), &converted[0], converted.size(), NULL, NULL);
            ret.append(converted);
            ret.append({ 0 });
            begin = pos + 1;
            pos = wstr.find(static_cast<wchar_t>(0), begin);
        }
        if (begin <= wstr.length())
        {
            WString segment = WString(&wstr[begin], wstr.length() - begin);
            size = WideCharToMultiByte(CP_UTF8, WC_ERR_INVALID_CHARS, &segment[0], segment.size(), NULL, 0, NULL, NULL);
            String converted = String(size, 0);
            WideCharToMultiByte(CP_UTF8, WC_ERR_INVALID_CHARS, &segment[0], segment.size(), &converted[0], converted.size(), NULL, NULL);
            ret.append(converted);
        }
#elif LINUX_PLATFORM || MACOS_PLATFORM || EMSCRIPTEN_PLATFORM
        size_t size;
        pos = wstr.find(static_cast<wchar_t>(0), begin);
        while (pos != WString::npos && begin < wstr.length())
        {
            WString segment = WString(&wstr[begin], pos - begin);
            size = wcstombs(nullptr, segment.c_str(), 0);
            String converted = String(size, 0);
            wcstombs(&converted[0], segment.c_str(), converted.size());
            ret.append(converted);
            ret.append({ 0 });
            begin = pos + 1;
            pos = wstr.find(static_cast<wchar_t>(0), begin);
        }
        if (begin <= wstr.length())
        {
            WString segment = WString(&wstr[begin], wstr.length() - begin);
            size = wcstombs(nullptr, segment.c_str(), 0);
            String converted = String(size, 0);
            wcstombs(&converted[0], segment.c_str(), converted.size());
            ret.append(converted);
        }
#else
        static_assert(false, "Unknown Platform");
#endif
        return ret;
    }

    static WString StringToWideString(const String& str)
    {
        if (str.empty())
        {
            return WString();
        }

        size_t pos;
        size_t begin = 0;
        WString ret;
#ifdef WINDOWS_PLATFORM
        int size = 0;
        pos = str.find(static_cast<char>(0), begin);
        while (pos != std::string::npos) {
            std::string segment = std::string(&str[begin], pos - begin);
            std::wstring converted = std::wstring(segment.size() + 1, 0);
            size = MultiByteToWideChar(CP_UTF8, MB_ERR_INVALID_CHARS, &segment[0], segment.size(), &converted[0], converted.length());
            converted.resize(size);
            ret.append(converted);
            ret.append({ 0 });
            begin = pos + 1;
            pos = str.find(static_cast<char>(0), begin);
        }
        if (begin < str.length()) {
            std::string segment = std::string(&str[begin], str.length() - begin);
            std::wstring converted = std::wstring(segment.size() + 1, 0);
            size = MultiByteToWideChar(CP_UTF8, MB_ERR_INVALID_CHARS, segment.c_str(), segment.size(), &converted[0], converted.length());
            converted.resize(size);
            ret.append(converted);
        }

#elif LINUX_PLATFORM || MACOS_PLATFORM || EMSCRIPTEN_PLATFORM
        size_t size;
        pos = str.find(static_cast<char>(0), begin);
        while (pos != String::npos)
        {
            String segment = String(&str[begin], pos - begin);
            WString converted = WString(segment.size(), 0);
            size = mbstowcs(&converted[0], &segment[0], converted.size());
            converted.resize(size);
            ret.append(converted);
            ret.append({ 0 });
            begin = pos + 1;
            pos = str.find(static_cast<char>(0), begin);
        }
        if (begin < str.length())
        {
            String segment = String(&str[begin], str.length() - begin);
            WString converted = WString(segment.size(), 0);
            size = mbstowcs(&converted[0], &segment[0], converted.size());
            converted.resize(size);
            ret.append(converted);
        }
#else
        static_assert(false, "Unknown Platform");
#endif
        return ret;
    }
};

enum class ConsoleTextStyle
{
    DEFAULT = 0,
    BOLD = 1,
    FAINT = 2,
    ITALIC = 3,
    UNDERLINE = 4,
    SLOW_BLINK = 5,
    RAPID_BLINK = 6,
    REVERSE = 7,
};

enum class ConsoleForeground
{
    DEFAULT = 39,
    BLACK = 30,
    DARK_RED = 31,
    DARK_GREEN = 32,
    DARK_YELLOW = 33,
    DARK_BLUE = 34,
    DARK_MAGENTA = 35,
    DARK_CYAN = 36,
    GRAY = 37,
    DARK_GRAY = 90,
    RED = 91,
    GREEN = 92,
    YELLOW = 93,
    BLUE = 94,
    MAGENTA = 95,
    CYAN = 96,
    WHITE = 97
};

enum class ConsoleBackground
{
    DEFAULT = 49,
    BLACK = 40,
    DARK_RED = 41,
    DARK_GREEN = 42,
    DARK_YELLOW = 43,
    DARK_BLUE = 44,
    DARK_MAGENTA = 45,
    DARK_CYAN = 46,
    GRAY = 47,
    DARK_GRAY = 100,
    RED = 101,
    GREEN = 102,
    YELLOW = 103,
    BLUE = 104,
    MAGENTA = 105,
    CYAN = 106,
    WHITE = 107
};

class Console
{
private:
    static void EnableVirtualTermimalProcessing()
    {
#if defined WINDOWS_PLATFORM
        HANDLE hOut = GetStdHandle(STD_OUTPUT_HANDLE);
        DWORD dwMode = 0;
        GetConsoleMode(hOut, &dwMode);
        if (!(dwMode & ENABLE_VIRTUAL_TERMINAL_PROCESSING))
        {
            dwMode |= ENABLE_VIRTUAL_TERMINAL_PROCESSING;
            SetConsoleMode(hOut, dwMode);
        }
#endif
    }

    static void ResetTerminalFormat()
    {
        std::cout << u8"\033[0m";
    }

    static void SetVirtualTerminalFormat(ConsoleForeground foreground, ConsoleBackground background, std::set<ConsoleTextStyle> styles)
    {
        String format = u8"\033[";
        format.append(std::to_string(static_cast<int>(foreground)));
        format.append(u8";");
        format.append(std::to_string(static_cast<int>(background)));
        if (styles.size() > 0)
        {
            for (auto it = styles.begin(); it != styles.end(); ++it)
            {
                format.append(u8";");
                format.append(std::to_string(static_cast<int>(*it)));
            }
        }
        format.append(u8"m");
        std::cout << format;
    }
public:
    static void Clear()
    {

#ifdef WINDOWS_PLATFORM
        std::system(u8"cls");
#elif LINUX_PLATFORM || defined MACOS_PLATFORM
        std::system(u8"clear");
#elif EMSCRIPTEN_PLATFORM
        emscripten::val::global()["console"].call<void>(u8"clear");
#else
        static_assert(false, "Unknown Platform");
#endif
    }

    static void Write(const String& s, ConsoleForeground foreground = ConsoleForeground::DEFAULT, ConsoleBackground background = ConsoleBackground::DEFAULT, std::set<ConsoleTextStyle> styles = {})
    {
#ifndef EMSCRIPTEN_PLATFORM
        EnableVirtualTermimalProcessing();
        SetVirtualTerminalFormat(foreground, background, styles);
#endif
        String str = s;
#ifdef WINDOWS_PLATFORM
        WString unicode = Strings::StringToWideString(str);
        WriteConsole(GetStdHandle(STD_OUTPUT_HANDLE), unicode.c_str(), static_cast<DWORD>(unicode.length()), nullptr, nullptr);
#elif defined LINUX_PLATFORM || defined MACOS_PLATFORM || EMSCRIPTEN_PLATFORM
        std::cout << str;
#else
        static_assert(false, "Unknown Platform");
#endif

#ifndef EMSCRIPTEN_PLATFORM
        ResetTerminalFormat();
#endif
    }

    static void WriteLine(const String& s, ConsoleForeground foreground = ConsoleForeground::DEFAULT, ConsoleBackground background = ConsoleBackground::DEFAULT, std::set<ConsoleTextStyle> styles = {})
    {
        Write(s, foreground, background, styles);
        std::cout << std::endl;
    }

    static void Write(const WString& s, ConsoleForeground foreground = ConsoleForeground::DEFAULT, ConsoleBackground background = ConsoleBackground::DEFAULT, std::set<ConsoleTextStyle> styles = {})
    {
#ifndef EMSCRIPTEN_PLATFORM
        EnableVirtualTermimalProcessing();
        SetVirtualTerminalFormat(foreground, background, styles);
#endif
        WString str = s;

#ifdef WINDOWS_PLATFORM
        WriteConsole(GetStdHandle(STD_OUTPUT_HANDLE), str.c_str(), static_cast<DWORD>(str.length()), nullptr, nullptr);
#elif LINUX_PLATFORM || MACOS_PLATFORM || EMSCRIPTEN_PLATFORM
        std::cout << Strings::WideStringToString(str);
#else
        static_assert(false, "Unknown Platform");
#endif

#ifndef EMSCRIPTEN_PLATFORM
        ResetTerminalFormat();
#endif
    }

    static void WriteLine(const WString& s, ConsoleForeground foreground = ConsoleForeground::DEFAULT, ConsoleBackground background = ConsoleBackground::DEFAULT, std::set<ConsoleTextStyle> styles = {})
    {
        Write(s, foreground, background, styles);
        std::cout << std::endl;
    }

    static void WriteLine()
    {
        std::cout << std::endl;
    }

    static void Pause()
    {
        char c;
        do
        {
            c = getchar();
            std::cout << "Press Key " << std::endl;
        } while (c != 64);
        std::cout << "KeyPressed" << std::endl;
    }

    static int PauseAny(bool printWhenPressed = false, ConsoleForeground foreground = ConsoleForeground::DEFAULT, ConsoleBackground background = ConsoleBackground::DEFAULT, std::set<ConsoleTextStyle> styles = {})
    {
        int ch;
#ifdef WINDOWS_PLATFORM
        ch = _getch();
#elif LINUX_PLATFORM || MACOS_PLATFORM || EMSCRIPTEN_PLATFORM
        struct termios oldt, newt;
        tcgetattr(STDIN_FILENO, &oldt);
        newt = oldt;
        newt.c_lflag &= ~(ICANON | ECHO);
        tcsetattr(STDIN_FILENO, TCSANOW, &newt);
        ch = getchar();
        tcsetattr(STDIN_FILENO, TCSANOW, &oldt);
#else
        static_assert(false, "Unknown Platform");
#endif
        if (printWhenPressed)
        {
            Console::Write(String(1, ch), foreground, background, styles);
        }
        return ch;
    }
};

int main()
{
    std::locale::global(std::locale(u8"en_US.UTF8"));
    auto str = u8"\0Hello\0123456789也不是可运行的程序１２３４５６７８９日本"s;//
    WString wstr = L"\0Hello\0123456789也不是可运行的程序１２３４５６７８９日本"s;
    WString wstrResult = Strings::StringToWideString(str);
    String strResult = Strings::WideStringToString(wstr);
    bool equals1 = wstr == wstrResult;
    bool equals2 = str == strResult;

    Console::WriteLine(u8"█ Converted Strings printed with Console::WriteLine"s, ConsoleForeground::GREEN);
    Console::WriteLine(wstrResult, ConsoleForeground::BLUE);//Printed OK on Windows/Linux.
    Console::WriteLine(strResult, ConsoleForeground::BLUE);//Printed OK on Windows/Linux.

    Console::WriteLine(u8"█ Converted Strings printed with std::cout/std::wcout"s, ConsoleForeground::GREEN);
    std::cout << strResult << std::endl;//Printed OK on Linux. BAD on Windows.
    std::wcout << wstrResult << std::endl; //Printed BAD on Windows/Linux.
    Console::WriteLine();
    Console::WriteLine(u8"Press any key to exit"s, ConsoleForeground::DARK_GRAY);
    Console::PauseAny();

} 
```

您无法在[https://repl.it/@JomaCorpFX/StringToWideStringToString#main.cpp上测试此代码](https://repl.it/@JomaCorpFX/StringToWideStringToString#main.cpp)

* * *

**截图**

使用 Windows 终端 [![视窗终端](../Images/348e9ebee3c4b2627302b828fd7065d6.png)](https://i.stack.imgur.com/moR2g.png)

使用 cmd/powershell [![在此处输入图像描述](../Images/151c032171ef5a8c3937e1027d8eb006.png)](https://i.stack.imgur.com/K8WpR.png)

Repl.it 捕获
[![在此处输入图像描述](../Images/6cc89ccfdd42e7f4eba8275db7c4c432.png)](https://i.stack.imgur.com/9mSQC.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T19:04:56.413

使用 noide 库以最简单的方式转换为 UTF-8。然后，使用常规 printf。**

# session - Java EE 6 并发会话和共享

> ID：11512657
> 
> 赞同：2
> 
> 时间：2012-07-16T21:13:45.517
> 
> 标签：session, jakarta-ee, cdi, sharing, codi

我正在使用 Java EE 6（JSF CDI EJB）开发一个 Web 应用程序，该应用程序不允许并发登录（相同的用户和密码）。

我喜欢的是：

如果用户登录两次，则第一个会话需要失效，并且旧会话数据（包括所有具有 SessionScope 的 CDI Bean 或来自 Apache CODI 的 WindowScope 等其他范围）被传输到新会话。

这有点像想要的会话劫持方法:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T06:43:58.873

Java EE 6 中没有这种固有机制。

由于我无法想象您想将正在进行的用例（例如，打开的结帐流程）从一个会话转移到另一个会话，因此我建议您只需**跟踪用户的 GUI 状态**。

RESTful URL 听起来是一种理想的方法。保留最后一个用户 URL/用户操作（例如`www.myapp.com/orders/new/12`）并在新登录时重新打开它。

如果您不想将其保留在数据库中，则应用程序范围的映射用户 ID / url 可能是 KISS 方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T08:42:53.700

您可以为用户使用无状态 bean，因此每次尝试登录/重新登录时，当前会话都会失效（在登录过程开始时）

考虑这种方法：

```
try {           
   session = request.getSession();   //the request is passed by another page or action
   if(session.getAttribute("user") != null) {

           //your code to forward or handle the existing user (re-log in/ do nothing etc.)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T11:05:13.333

我在过滤器的帮助下解决了这个问题

公共类 SessionReplicationFilter 实现过滤器 {

```
@Inject
SessionReplicationManager manager;

public SessionReplicationFilter() {
}

@Override
public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
        throws IOException, ServletException {
    //Process chain first 
    if (chain != null) {
        chain.doFilter(request, response);
    }

    //check http request
    if (request instanceof HttpServletRequest) {
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        // Retrieve the session and the principal (authenticated user)
        // The principal name is actually the username
        HttpSession session = httpRequest.getSession();
        Principal principal = httpRequest.getUserPrincipal();
        if (principal != null && principal.getName() != null && session != null) {
            manager.checkExistingSession(principal.getName(), session)) 
        }
    }

}

@Override
public void init(FilterConfig filterConfig) throws ServletException {

}

@Override
public void destroy() {

} 
```

}

经理看起来如下

@ApplicationScoped 公共类 SessionReplicationManager {

```
private Map<String, HttpSession> map = new ConcurrentHashMap<String, HttpSession>();

public boolean checkExistingSession(String user, HttpSession session) {
    if (map.keySet().contains(user)) {
        if (!session.getId().equals(map.get(user).getId())) {
            System.out.println("User already logged in ");
            HttpSession oldSession = map.get(user);
            // copies all attributes from the old session to the new session (replicate the session)
            Enumeration<String> enumeration = oldSession.getAttributeNames();
            while (enumeration.hasMoreElements()) {
                String name = enumeration.nextElement();
                System.out.println("Chaning attribut " + name);
                session.setAttribute(name, oldSession.getAttribute(name));
            }
            // invalidates the old user session (this keeps one session per user)
            oldSession.invalidate();
            map.put(user, session);
            return true;
        }
    } else {
        System.out.println("Putting "+user+" into session cache");
        map.put(user, session);
        return false;
    }
    return false;
} 
```

}

它与 CoDI ViewScoped 带注释的 Bean 配合得很好

如果第一个用户每次（AJAX）请求都无效导致会话过期异常，即使使用恢复会话按钮也可以轻松处理

viewscoped bean 的唯一小问题是，它们获得了新的视图 ID。通过将它们改回原点，一切正常。

我需要补充的东西：

*   自动注销（ajax 轮询，websockets，...）
*   存储所有 viewscoped-id 的某种注册表

此评论中缺少：

*   web.xml 配置

问候

# c# - 使用电子邮件地址作为 loginID 登录到 asp.net 应用程序

> ID：11512658
> 
> 赞同：3
> 
> 时间：2012-07-16T21:13:53.333
> 
> 标签：c#, asp.net, sql-server, login, email-address

我正在开发我的 asp.net 应用程序的登录组件，部分要求是将电子邮件地址用作登录 ID。

对于我的“客户”对象，我应该有一个 LoginID 和一个 EmailAddress 属性还是只有 EmailAddress？对于 SQL 数据库，我需要一个 LoginID 字段还是只需要一个 EMailAddress 字段？

**更新：**在“编辑个人资料”页面中，客户可以编辑他们的电子邮件地址。

好奇在我深入研究之前是否有人有建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T21:18:33.253

您可以按照自己的方式进行操作 - 使用电子邮件地址作为主键，或使用另一个外部客户 ID 字段。

我个人的偏好是使用另一个字段，并将电子邮件地址作为属性。另一个字段可能是一个 guid，或者是一些其他难以猜测的序列。我会走这条路有两个原因：

1.  从安全的角度来看，如果开发人员做一些草率的事情，比如在 url 或隐藏字段中泄露 guid，它（略）比泄露实际客户电子邮件地址的破坏性要小。

    *   使用自动化来生成一堆 GUID 并找到用户/密码匹配比购买电子邮件地址列表并将其输入自动漏洞利用工具包更难。
2.  易于维护 - 人们更改电子邮件地址。如果您使用电子邮件地址作为主键，则必须弄清楚如何转移帐户设置。

* * *

我知道问题中没有要求这样做，但是您显然是在构建自己的登录机制，听起来您可能不一定经验丰富。为了帮助您避免我个人过去犯过的错误，这里有一些很好的阅读材料：

[http://www.codinghorror.com/blog/2007/09/youre-probably-storing-passwords-incorrectly.html](http://www.codinghorror.com/blog/2007/09/youre-probably-storing-passwords-incorrectly.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:24:01.960

根据经验，我建议您在行的唯一 ID 和用户邮件之间使用组合键。并且您都可以将它们用作属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:16:08.360

最佳做法是确保登录 ID 是唯一的。电子邮件地址确实是独一无二的，但如果有人希望更改他们的电子邮件地址，您可能会遇到问题。我建议使用单独的 ID 而不是电子邮件作为主键。

另请注意，使用电子邮件地址作为主要地址时，有一些性能注意事项。在这个非常相似的问题中有一些很好的回答：[使用电子邮件地址作为主键？](https://stackoverflow.com/questions/3804108/is-email-address-a-bad-primary-key).

# ios - 如何在 APNS 的生产列表中识别开发推送令牌？

> ID：11512661
> 
> 赞同：2
> 
> 时间：2012-07-16T21:14:03.423
> 
> 标签：ios, push, apple-push-notifications

我有一个 Apple 推送通知的生产推送令牌列表，里面几乎没有开发令牌。是否可以在不向 Apple 发送通知的情况下识别它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T07:42:53.200

最简洁的答案是不。

每个 pushtoken 都是在运行时通过开发构建或临时/分发构建在设备上生成的。每个构建都会生成一个不同的推送令牌，但是如果不知道构建，就无法可靠地知道哪个是哪个。

如果您有一个推送令牌列表并且大多数是生产的，并且如果您能够向这些推送令牌发送推送通知，您可以尝试使用 Apple 的推送通知服务 ( [APNs](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CommunicatingWIthAPS/CommunicatingWIthAPS.html) ) 向每台设备发送推送通知。理想情况下，使用增强的二进制接口从 Apple 获得即时反馈。如果您通过生产网关推送到开发推送令牌，Apple 将返回显式错误（错误 1 ​​或 8，不确定）。或者，您可以使用提供较少细节的反馈服务。反馈服务的唯一问题是您可能会收到有效生产令牌的报告，这些令牌在发送时只是处于非活动状态。

# java - Android 多播 - 有时接收阻塞线程

> ID：11512663
> 
> 赞同：1
> 
> 时间：2012-07-16T21:14:13.423
> 
> 标签：java, android, networking, network-programming, multicast

我相信 MulticastSocket.receive 方法阻塞了我的线程。除非应用程序转到 onResume()，否则它不会再次工作，这会重新启动线程。我怎样才能解决这个问题？

**收货人代码**

```
private class ReceiverThread extends Thread
{

    private static final String TAG = ComMessageReceiver.TAG + "Thread";

    private WifiManager wifiManager;
    private MulticastSocket multicastSocket;
    private InetSocketAddress groupInetSocketAddress;
    private boolean joinedGroup = false;

    public ReceiverThread(String group, int port, int timeout) throws IOException {

        super();

        wifiManager = (WifiManager) App.context.getSystemService(Context.WIFI_SERVICE);
        groupInetSocketAddress = new InetSocketAddress(InetAddress.getByName(group), port);
        multicastSocket = new MulticastSocket(port);
        multicastSocket.setSoTimeout(timeout);
    }

    public ReceiverThread() throws IOException {

        this(Config.multicastAddress, Config.multicastPort, DEFAULT_TIMEOUT);
    }

    @Override
    public void run() {

        Log.d(TAG, "started");

        while (!this.isInterrupted()) {

            if (wifiManager.getWifiState() == WifiManager.WIFI_STATE_ENABLED) {

                if (!joinedGroup) {

                    try {
                        multicastSocket.joinGroup(groupInetSocketAddress,
                                NetworkInterface.getByInetAddress(getWifiInetAddress()));

                        wifiManager.createMulticastLock("ComMessageReceiverLock").acquire();

                        joinedGroup = true;

                    } catch (IOException ex) {

                        Log.e(TAG, "Failed to join Multicast group: " + ex.getMessage());
                    }
                }

                try {

                    byte[] buffer = new byte[256];

                    DatagramPacket packet = new DatagramPacket(buffer, buffer.length);

                    multicastSocket.receive(packet);

                    Log.d(TAG, "Message received: " + message.message);

                } catch (SocketTimeoutException e) {
                } catch (IOException ex) {

                    multicastSocket = null;

                    Log.e(TAG, ex.getMessage());
                }
            } else
                joinedGroup = false;
        }
    }

} 
```

**组播代码**

```
private class ComServerThread extends Thread {

    private static final String LOG = "ComServerThread";
    private final static long INTERVAL = 1000;
    private boolean alert = true;

    private DatagramSocket socket;

    public ComServerThread() {

        try {

            socket = new DatagramSocket(5500);
        } catch (SocketException ex) {

            Log.e(LOG, "Error opening socket: " + ex.getMessage());
        }
    }

    @Override
    public void run() {

        while (!this.isInterrupted()) {

            try {

                try {

                    sleep(INTERVAL);
                } catch (InterruptedException ex) {

                    Log.e(LOG, "Interrupted the thread sleep! not cool: "
                            + ex.getMessage());
                }

                byte[] buffer;

                String msg = "Test"

                buffer = msg.getBytes();

                InetAddress group = InetAddress.getByName("230.0.0.1");

                DatagramPacket packet = new DatagramPacket(buffer,
                        buffer.length, group, 5500);
                socket.send(packet);

                Log.d(LOG, "Packet sent.");

            } catch (UnknownHostException ex) {

                Log.e(LOG, "Oops. Invalid host: " + ex.getMessage());
            } catch (IOException ex) {

                Log.e(LOG,
                        "Something bad happened while sending the packet. Take a look: "
                                + ex.getMessage());
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T22:08:47.213

你是对的，这是一种阻塞方法。

如果您设置读取超时，它会抛出`SocketTimeoutException,`您似乎忽略的一个，因此您的代码将再次循环并阻塞。

您不需要每次循环都加入多播组：这只是浪费。

# java - 数据传输

> ID：11512669
> 
> 赞同：-1
> 
> 时间：2012-07-16T21:14:46.667
> 
> 标签：java, date, grails, web-applications, file-upload

我需要一些建议

我被授权设计和实施一个允许客户提交订单（上传）的系统。订单将分批提交（一次多个） 基本上每个订单都可以视为一条记录（行）。这些字段可以是自由文本、数字或选择表单预定义的文本值（下拉列表样式）。

首先，我需要为数据定义一个标准。字段是什么以及例外的数据类型。大多数数据都是预定义的文本值这一事实给我带来了一个问题

然后我需要确定如何传输这些数据。使用什么介质和协议

所以这就是我到目前为止得到的

1) xml - 我可以使用 XSD 来定义数据标准。这将允许在客户端进行验证。但是预定义的值可以更改，因此必须动态生成 xsd - 然后客户端可以上传 xml。我将 xml 转换为对象并将其保存到我的数据库中

2）让他们使用分隔的文本文件。我必须向他们提供有关数据搁浅的文件。在这里我无法验证，直到我尝试读取文件，所以我可以除了很多错误

这是我想出的两个选项。我想知道是否有其他方法或解决方案

我在 grails 中开发

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:20:39.863

我喜欢 XML 方法。您可以以一种有意义的方式构造数据，并且如您所说，在客户端上进行一些验证。我想不出分隔文件有什么优势（文件大小除外，这可能不会成为问题）。做这个方法！

# jquery - JQuery单选按钮的多个结果

> ID：11512670
> 
> 赞同：0
> 
> 时间：2012-07-16T21:14:50.287
> 
> 标签：jquery, html, forms, radio-button

JQuery 很新，我遇到了问题。我有一个由 7 或 8 个字段集组成的表单，每个字段集都有许多单选按钮。我需要做的是记住每个字段集中每个单选按钮的每个选定选项，并在用户决定更改选项时更改存储的值。我到目前为止的代码如下：

```
<html>
  <head>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script>
      price = [];
      total = 0;
      function Update_Subtotal(radio){
        $('input:checked').each( function() {
          price[1] = radio.getAttribute('price1');
          price[2] = radio.getAttribute('price2');
        });
        $("#1").text("$" + price[1]);
        $("#2").text("$" + price[2]);
      }
    </script>
  </head>
  <body>
    <form name="form" method="post" action="">
      <fieldset style="width: 50%;">
        <input type="radio" name="opt1" value="1" price1="100" class="1" onclick="Update_Subtotal(this);" />Option 1<br />
        <input type="radio" name="opt1" value="2" price1="200" class="1" onclick="Update_Subtotal(this);" />Option 2<br />
        <input type="radio" name="opt1" value="3" price1="300" class="1" onclick="Update_Subtotal(this);" />Option 3<br />
      </fieldset>
      <fieldset style="width: 50%;">
        <input type="radio" name="opt2" value="1" price2="10" class="2" onclick="Update_Subtotal(this);" />Option 1<br />
        <input type="radio" name="opt2" value="2" price2="20" class="2" onclick="Update_Subtotal(this);" />Option 2<br />
        <input type="radio" name="opt2" value="3" price2="30" class="2" onclick="Update_Subtotal(this);" />Option 3<br />
      </fieldset>
    </form>
    Totals:
    <div id="1"></div>
    <div id="2"></div>
  </body>
</html> 
```

这可以在每个字段集中显示更改的选择，但是当移动到第二个字段集时，第一个字段集的总数显示在

```
<div id="1"></div> 
```

变成

```
$null 
```

我也无法更改输入单选按钮的名称、值或类。任何帮助都很棒，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:26:15.950

无需重写 HTML，您可以尝试以下操作：

```
$(':radio').click(function() {
    $('#1').html($('[name=opt1]:checked').attr('price1'));
    $('#2').html($('[name=opt2]:checked').attr('price2'));
});​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/5LQWs/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:22:48.537

几个变化：

1.  主要修复是使用`radio.getAttribute('price1')`. Eveytime`Update_Subtotal`被称为您试图从同一个单选按钮获取 price1 和 price2，而您的 HTML 并非如此。所以请遵循接下来的两点。
2.  您将 div 的 id 设为 1,2，它们不是有效的 id。将它们更改为价格 1、价格 2 之类的东西。
3.  您使用的自定义属性 price1、price2 很好，但为什么不使用 HTML5 data-* 标签。

试试这个：

```
<html>
  <head>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script>
      var total = 0;
      function Update_Subtotal(radio){
        $('input:checked').each( function(i, el) {
          var price = $(el).data('price');
          $("#price-" + (i + 1)).text("$" + price);
        });
      }
    </script>
  </head>
  <body>
    <form name="form" method="post" action="">
      <fieldset style="width: 50%;">
        <input type="radio" name="opt1" value="1" data-price="100" class="1" onclick="Update_Subtotal(this);" />Option 1<br />
        <input type="radio" name="opt1" value="2" data-price="200" class="1" onclick="Update_Subtotal(this);" />Option 2<br />
        <input type="radio" name="opt1" value="3" data-price="300" class="1" onclick="Update_Subtotal(this);" />Option 3<br />
      </fieldset>
      <fieldset style="width: 50%;">
        <input type="radio" name="opt2" value="1" data-price="10" class="2" onclick="Update_Subtotal(this);" />Option 1<br />
        <input type="radio" name="opt2" value="2" data-price="20" class="2" onclick="Update_Subtotal(this);" />Option 2<br />
        <input type="radio" name="opt2" value="3" data-price="30" class="2" onclick="Update_Subtotal(this);" />Option 3<br />
      </fieldset>
    </form>
    Totals:
    <div id="price-1"></div>
    <div id="price-2"></div>
  </body>
</html> 
```

[http://jsbin.com/obozuk/](http://jsbin.com/obozuk/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:27:58.017

发生这种情况的原因是，当它到达第二个元素时，它找不到 price1 并因此设置为 null。您可以通过执行以下操作来纠正此问题：

```
$('input:checked').each( function() {  
     price[1] = radio.getAttribute('price1') != null ? radio.getAttribute('price1') : price[1];  
     price[2] = radio.getAttribute('price2') != null ? radio.getAttribute('price2') : price[2];  
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T21:35:45.677

你也可以试试这个。我想很简单。:)

```
$('input:radio').click(function(){
   $('#1').text($(this).attr('price1'));
   $('#2').text($(this).attr('price2'));
      });​ 
```

[jsFiddle 链接](http://jsfiddle.net/XH4dh/)

# php - CakePHP 面包屑配置

> ID：11512671
> 
> 赞同：0
> 
> 时间：2012-07-16T21:14:51.473
> 
> 标签：php, cakephp

我正在使用 HtmlHelper 为我的 CakePHP 网站创建面包屑，我需要最后一个面包屑不是链接而是有一个 ID。如果我使用

```
$this->Html->addCrumb($news['News']['title'],null, array('id' => 'crumbselected')); 
```

我得到了我的面包屑，但它是没有 html 属性的简单文本。

如果我添加了一个链接而不是 null ，那么一切正常。但正如我所说——我需要最后一个面包屑不是链接，而是有一个 ID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:39:16.097

该`$options`参数仅在您输出链接时使用。你可以尝试这样的事情：

```
$this->Html->addCrumb('<span id="crumbselected">' . $news['News']['title'] . '</span>',null); 
```

# objective-c - CoreData 致命错误：非法变异 NSFetchedResultsController

> ID：11512672
> 
> 赞同：0
> 
> 时间：2012-07-16T21:14:58.413
> 
> 标签：objective-c, ios, cocoa-touch, core-data, nsfetchedresultscontroller

我`CoreData`每隔一段时间就会收到一个奇怪的错误：

> CoreData：致命错误：部分信息的持久缓存与当前配置不匹配。你在没有禁用缓存或使用 +deleteCacheWithName 的情况下非法改变了 NSFetchedResultsController 的获取请求、谓词或排序描述符：

我发现另一个 Stackoverflow 线程说将缓存设置为 nil，我已经这样做了，但这并没有解决错误：

```
NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:nil cacheName:nil]; 
```

错误来自我的`getData`方法，该方法返回获取结果的数组。我经常调用这个方法，因为我想检查计数，并更新一个 tableView：

```
+ (NSArray *)getData {

    // Fetch Data
    NSError *error = nil;
    if (![[[AppDelegate instance] fetchedResultsController] performFetch:&error]) {
        // Update to handle the error appropriately.
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }

    return [[AppDelegate instance].fetchedResultsController fetchedObjects];

}//end 
```

为什么这会导致错误？这是从 中获取更新的对象数组的不正确方法`fetchedResultsController`吗？

# c++ - 使用模板时出现“错误 LNK2019：无法解析的外部符号”

> ID：11512674
> 
> 赞同：3
> 
> 时间：2012-07-16T21:15:06.543
> 
> 标签：c++, templates

> **可能重复：**
> [为什么在使用模板时会出现“未解析的外部符号”错误？](https://stackoverflow.com/questions/456713/why-do-i-get-unresolved-external-symbol-errors-when-using-templates)

我在我的代码中使用模板，但总是出现错误 LNK2019。这是我的代码的一部分：

方法.h

```
template<typename type>
void Method(Model<type>* sys); 
```

方法.cpp

```
template<typename type>
void Method(Model<type>* sys){ blablabla;} 
```

模型.h

```
template<typename type>
class Model{ blablabla;}

class Model1:public Model<double>{ blablabla;} 
```

主文件

```
Model<double> *sys=new Model1();
Method(sys); 
```

但是，总是显示错误 LNK2019: unresolved external symbol "void __cdec1 Method(class Model*)" referenced in function_main. 有人知道我哪里出错了吗？非常感谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-16T21:17:25.090

模板应在标头中实现。

方法.h

```
template<typename type>
void Method(Model<type>* sys){ /*Your code here*/ }; 
```

另请参阅：[https ://stackoverflow.com/a/495056/868546](https://stackoverflow.com/a/495056/868546)

从[马克赎金](https://stackoverflow.com/users/5987/mark-ransom)：

> 在 .cpp 文件中，当你在其他文件中使用该函数时，编译器无法猜测模板参数是什么，因此它不会生成任何实际代码。链接器注意到缺少代码并抱怨。
> 
> 通常的方法是在头文件中定义整个函数体，就像一个内联函数，这样编译器可以在看到正在使用的函数被填充模板参数时发出代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-16T21:18:38.260

在 .cpp 文件中，当你在其他文件中使用该函数时，编译器无法猜测模板参数是什么，因此它不会生成任何实际代码。链接器注意到缺少代码并抱怨。

通常的方法是在头文件中定义整个函数体，就像一个内联函数，这样编译器可以在看到正在使用的函数被填充模板参数时发出代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:21:01.593

模板应该在标头中实现，或者您可以使用模板函数/类的*显式实例化。*

# php - php XSLTProcessor 生成服务器 500 错误

> ID：11512677
> 
> 赞同：0
> 
> 时间：2012-07-16T21:15:19.357
> 
> 标签：php, xslt

我正在尝试运行 xslt 进程：

```
$xslt = new XSLTProcessor(); 
```

相当标准，但是我有点恼火，因为它正在生成服务器 500 错误，我试图定位 PHP 错误日志无济于事，并通过 httpd 错误日志进行检查，因此我没有看到与此问题相关的错误。

我目前正在运行安装了 PHP 5.3.3（最新）的 Centos v6 64 位操作系统，我已经完成了 php-xml 的 yum 安装，因为 php-xsl 不存在，我想知道是否还有其他人可以了解为什么在我的本地 Windows 机器上这是快乐的日子！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:37:21.023

错误 500 表示解析错误或另一个致命错误，所以我的第一个猜测是缺少 XSLTProcessor 类（尚未加载 XSL 模块）。确保 xsl.so 已作为加载扩展 (extension=xsl.so) 添加，并且它与 xml 模块一起安装（应该是 - 据我所知，它位于 Centos 的 php-xml 中）。

执行 phpinfo() 调用，查看 xsl / xml 是否可用。检查 error_log 的值以查看记录特定 PHP 错误的位置，验证 error_reporting 未设置为 E_NONE / 0 并确保 log_errors 已打开（如果未打开，您将不会在错误日志中看到任何错误或php日志）。

如果您仍然不明智，只需尝试执行 var_dump(class_exists("XSLTProcessor")) 以查看该类是否可用。

虽然这不是您需要做什么的确切答案，但它应该为您提供足够的信息，以便从您提供的信息中找出问题所在。

# air - 从三星智能电视获取原始流数据

> ID：11512680
> 
> 赞同：1
> 
> 时间：2012-07-16T21:15:32.727
> 
> 标签：air, samsung-smart-tv

嗨，我正在尝试为三星智能电视开发一个代码，它需要从直播有线电视服务中获取 RAW 音频\视频，以便对其做出反应。我准备好了所有三星 eclipse 开发工具和用于电视环境的 Adob​​e Air。但是如何将音频\视频流 pip 从电视获取到 Air 应用程序？他们是一个已知的本地 C Air 插件，还是其他一些三星 API？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T06:57:44.263

三星不让您在 Flash 中播放三星电视源。我检查了文档，看起来您需要使用三星原生 JavaScript API。

在这里，您有`ExternalInterface.call();`用于与 JavaScript API 通信的三星示例。

[http://www.samsungdforum.com/Guide/View/Developer_Documentation/Samsung_SmartTV_Developer_Documentation_2.5/Flash/Access_Flash_Content/Tutorial_Accessing_Flash_Using_Player_and_Audio_APIs_Externally](http://www.samsungdforum.com/Guide/View/Developer_Documentation/Samsung_SmartTV_Developer_Documentation_2.5/Flash/Access_Flash_Content/Tutorial_Accessing_Flash_Using_Player_and_Audio_APIs_Externally)

在示例中是播放器控件，例如在 Flash 中制作的播放/停止/暂停，视频播放器是三星的原生插件。

因此，在您的情况下，首先您需要创建将在后台播放电视源的 JavaScript 应用程序。我在这里解释它：

[三星 SmartTV overlay（新闻行情）应用程序](https://stackoverflow.com/questions/10102923/samsung-smarttv-ovelray-news-ticker-application/10137818#10137818)

然后实现你的 Flash 部分。可以制作透明背景，以便在电视源上显示 Flash 内容。

不要犹豫，询问您是否需要更多解释。

# tcpdf - 在 tcpdf 中嵌入 SVG XML

> ID：11512681
> 
> 赞同：4
> 
> 时间：2012-07-16T21:15:36.187
> 
> 标签：tcpdf

我正在使用 tcpdf 使用 PHP 生成 PDF 文件，并且以包含表示图像的 XML 标记的 .svg 文件的形式嵌入 SVG 图像没有问题。但是，我希望能够使用该 XML，例如作为 PHP 字符串，并将其直接提供给 tcpdf，而无需将其存储在文件中。

这有可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T21:40:39.300

我通过检查 tcpdf 的源代码找到了解决方案（然后我看到它实际上也在文档中；我只是错过了）：可以提供前面带有 @ 的 XML 字符串，而不是提供文件名.

# iphone - Core Data 使我的应用程序崩溃

> ID：11512686
> 
> 赞同：0
> 
> 时间：2012-07-16T21:15:45.047
> 
> 标签：iphone, xcode, ios5, core-data

我用核心数据构建了我的应用程序。它适用于具有两个属性的实体。当我想添加具有单个属性的新实体时，我的应用程序在启动时崩溃。

```
2012-07-16 23:11:13.579 myApp[6773:fb03] Unresolved error Error Domain=NSCocoaErrorDomain Code=134100 "The operation couldn’t be completed. (Cocoa error 134100.)" UserInfo=0x6bb36e0 {metadata=<CFBasicHash 0x6bbae90 [0x1748b48]>{type = immutable dict, count = 7,
entries =>
    2 : <CFString 0x6bbab30 [0x1748b48]>{contents = "NSStoreModelVersionIdentifiers"} = <CFArray 0x6bbaf20 [0x1748b48]>{type = immutable, count = 1, values = (
    0 : <CFString 0x1743cd8 [0x1748b48]>{contents = ""}
)}
    4 : <CFString 0x6bbab60 [0x1748b48]>{contents = "NSPersistenceFrameworkVersion"} = <CFNumber 0x6bbaa30 [0x1748b48]>{value = +386, type = kCFNumberSInt64Type}
    6 : <CFString 0x6bbaec0 [0x1748b48]>{contents = "NSStoreModelVersionHashes"} = <CFBasicHash 0x6bbafb0 [0x1748b48]>{type = immutable dict, count = 1,
entries =>
    2 : <CFString 0x6bbaf40 [0x1748b48]>{contents = "AllFamille"} = <CFData 0x6bbaf60 [0x1748b48]>{length = 32, capacity = 32, bytes = 0x5a5b78eb9edf4005bbe8a8d5e85fd102 ... 208bdf48b8b44695}
}

    7 : <CFString 0x1101ad8 [0x1748b48]>{contents = "NSStoreUUID"} = <CFString 0x6bbad30 [0x1748b48]>{contents = "45640157-116E-4616-93C5-2DA6027F4E9C"}
    8 : <CFString 0x1101978 [0x1748b48]>{contents = "NSStoreType"} = <CFString 0x1101988 [0x1748b48]>{contents = "SQLite"}
    9 : <CFString 0x6bba9e0 [0x1748b48]>{contents = "_NSAutoVacuumLevel"} = <CFString 0x6bbb000 [0x1748b48]>{contents = "2"}
    10 : <CFString 0x6bbaef0 [0x1748b48]>{contents = "NSStoreModelVersionHashesVersion"} = <CFNumber 0x6d84b60 [0x1748b48]>{value = +3, type = kCFNumberSInt32Type}
}
, reason=The model used to open the store is incompatible with the one used to create the store}, {
    metadata =     {
        NSPersistenceFrameworkVersion = 386;
        NSStoreModelVersionHashes =         {
            AllFamille = <5a5b78eb 9edf4005 bbe8a8d5 e85fd102 3c6d4040 f1b7fc6c 208bdf48 b8b44695>;
        };
        NSStoreModelVersionHashesVersion = 3;
        NSStoreModelVersionIdentifiers =         (
            ""
        );
        NSStoreType = SQLite;
        NSStoreUUID = "45640157-116E-4616-93C5-2DA6027F4E9C";
        "_NSAutoVacuumLevel" = 2;
    };
    reason = "The model used to open the store is incompatible with the one used to create the store";
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T21:19:37.480

可能是因为您添加了该属性。因此，您的新数据库与旧数据库不一致。尝试删除模拟器文件夹下的数据库并再次运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T21:41:32.343

发生此问题是因为用于保存数据库的托管对象模型不同，因为您添加了新实体，因此修改后的托管对象模型不能用于加载使用前一个模型保存的数据。

如果您正在使用数据库的第一个版本，则可以从模拟器/设备中删除该应用程序。但是，如果您要更改已发布的应用程序，这可能会变成一个大问题，因为您不能要求用户在安装新版本之前卸载您的应用程序。

在这种情况下，您应该创建一个新版本的托管对象模型，然后配置 Core Data 以在您的数据库上执行从以前的模型版本到最新版本的轻量级迁移。

请按照[文档中详细说明的步骤进行操作](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreDataVersioning/Articles/vmLightweightMigration.html)。

# api - 带有桌面应用程序的 Shutterfly API：回调如何工作？

> ID：11512696
> 
> 赞同：1
> 
> 时间：2012-07-16T21:16:31.163
> 
> 标签：api, callback, desktop-application

我正在尝试编写一个桌面应用程序来对抗 Shutterfly API。它们获取令牌的两条路径（“无缝”和“交互式”）都涉及 API 将授权令牌发送到回调 URL。关于这对于没有网站组件的桌面应用程序如何工作的任何想法或经验？他们的文档似乎表明他们的“交互式”路径旨在支持桌面应用程序。

# svn - svn：如何加快结帐（svn 中的选择性结帐）？

> ID：11512697
> 
> 赞同：2
> 
> 时间：2012-07-16T21:16:41.537
> 
> 标签：svn, tortoisesvn

在工作中，我们使用 SVN，trunk 包含许多不同开发人员使用的文件夹。我在我们产品的 c++ 端工作，并且由于各种原因，我经常需要检查我们代码的单独副本，但这需要非常多的时间。问题是主干包含许多我的 c++ 部分不需要的东西（它包含许多我不需要的 iPhone、Android 的 gui 相关项目）。那么，是否可以在 svn 中进行某种检出，只检出某些文件夹？

我知道我可以检查它，然后排除一些文件夹，但我可以在一开始就这样做，这样我就不需要检查所有东西了吗？

是否有一些特定于 svn 的方法来制作一些结帐标签，例如，我可以为 c++、android 或 iPhone 开发人员提供单独的快捷方式，这样他们就不需要签出所有内容，也不需要一些神秘的结帐字符串来结帐仅某些选定的文件夹？

（更改 svn，重新排序结构不是选项）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:36:41.413

您可以随时手动签出所需的子项目。如果您需要经常这样做，您可以创建自己的“超级项目”，其中包含所有需要的子项目`svn:externals`。之后，您只需一个命令即可检查所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-16T09:41:35.080

TortoiseSVN 正是您需要的功能。这是它的样子（抱歉模糊）。

首先，您在这里选择“选择项目...”： [![在此处输入图像描述](../Images/ecf770c9147611c016353a20c96255ac.png)](https://i.stack.imgur.com/jV5BL.png)

然后在打开的树中选择你想要的： [![在此处输入图像描述](../Images/0b42e76b8dd51f7b8fba0daf61412dbb.png)](https://i.stack.imgur.com/F61Lz.png)

“省略外部”独立于此过程，您可以选择也可以不选择它。

请注意，如果稍后您执行“更新”，您的初始选择将被忽略并且更新会拉取所有内容。

回答你的最后一部分，如果你需要任何花哨的结帐，恐怕脚本是唯一的选择。

# c++ - io 用于 std::string 的非关联容器

> ID：11512700
> 
> 赞同：1
> 
> 时间：2012-07-16T21:16:48.680
> 
> 标签：c++, string, templates

我想为库中的 std::string 容器提供基于通用行的 IO。基于行，因为字符串可能包含空格。以下代码似乎工作正常，但我不确定这是否是最好的方法，或者它是否会产生一些歧义，我无法掌握。

```
#define boostForeach BOOST_FOREACH

template< template<typename ELEM, typename ALLOC=std::allocator<ELEM> > class Container >
std::ostream& operator<< (std::ostream& o, Container<std::string>const & container){
  boostForeach(std::string const& str, container) {
    o << str << "\n";
  }
  return o;
}

template< template<typename ELEM, typename ALLOC=std::allocator<ELEM> > class Container >
std::istream& operator>> (std::istream& in, Container<std::string>& container){
  container.clear();
  std::string buf;
  while(getline(in, buf)) {
    if(buf.empty()) break; //stop if empty line found to separate map from other data
    container.insert(container.end(),buf);
  }
  return in;
} 
```

所以问题是：这安全可靠吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:01:22.797

第一个问题是标准容器中模板参数的数量不是标准规定的，这意味着您的代码在任何有任何额外参数的平台上都会失败。

一般来说，我不会为您尚未定义的类型提供运算符重载，尤其是标准容器。原因是你不能*正确地*做到这一点。特别是您不能在容器所在的命名空间中*声明*它们，这意味着 ADL 不会神奇地选择正确的重载。如果你想要一个辅助函数，你应该提供一个*命名*函数，如果需要的话，它会更容易帮助查找。

试试这个：

```
#include <iostream>
#include <vector>
#include <string>

template < template<typename,typename> class Container >
std::ostream& operator<<( std::ostream& o, Container<std::string> const & c );
namespace A {
   struct S {};
   std::ostream& operator<<( std::ostream& o, S const & );
   void f() {
      std::vector<std::string> v;
      std::cout << v;
   }
}
int main() {
   A::f();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T22:02:32.780

您可以使用以下方法编写输出算法`std::copy()`：

```
std::copy(container.begin(),
    container.end(),
    std::ostream_iterator<std::string>(o, "\n")); 
```

您可以将输入迭代器用于段落输入，即多行由空行分隔：

```
class istream_paragraph_iterator: public std::iterator<std::forward_iterator_tag,std::string>{
    std::istream* stream;
    std::string line;
public:

    istream_paragraph_iterator() : stream(0) {}

    istream_paragraph_iterator(std::istream& stream) : stream(&stream) {++*this; //get the first element
    }

    std::string operator*() const {
        return line;
    }

    const std::string* operator->() const {
        return &line;
    }

    istream_paragraph_iterator& operator++() {
        if (stream && (!std::getline(*stream, line) || line.empty()))
            stream = 0;
        return *this;
    }

    istream_paragraph_iterator operator++(int) {
        istream_paragraph_iterator previous(*this);
        ++*this;
        return previous;
    }

    bool operator==(const istream_paragraph_iterator& other) const {
        return stream == other.stream;
    }

    bool operator!=(const istream_paragraph_iterator& other) const {
        return !(*this == other);
    }

}; 
```

然后您也可以使用以下方法编写输入算法`std::copy()`：

```
std::copy(istream_paragraph_iterator(in),
    istream_paragraph_iterator(),
    std::back_inserter(container)); 
```

将逻辑分离为迭代器类型可以使输入和输出算法可参数化，因此更通用。在模板库中，这通常是一件好事。我会避免为标准容器添加重载，因为您无法知道它们在每个平台上都做正确的事情；基于迭代器的算法更具可移植性，您不必编写所有`template<template<...> class ...>`繁琐的代码。

# php - 在 php 中打印 false

> ID：11512705
> 
> 赞同：2
> 
> 时间：2012-07-16T21:17:08.917
> 
> 标签：php, syntax, boolean

我正在尝试打印以下语句：

```
print false . "\n" . true . "\n";
echo false . (bool)false . "\n" . true . "\n";
print "0" . "\n" . true . "\n"; 
```

我得到的结果只是“1 1 0 1”。预期结果是：

> 0
> 1
> 0
> 1
> 0
> 1

我正在使用 PHP 5.4.3 MSVC9 x64 有人可以解释为什么以及如何使它以正确的方式打印吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T21:19:55.370

您的问题来自您对`+`PHP 中字符串运算符的误解。字符串连接运算符`.`就像 PHP 是松散类型的，它不知道您是要连接还是添加字符串。

我给你分解一下：

```
print false + "\n" + true + "\n";
echo false+(bool)false + "\n" + true + "\n";
print "0" + "\n" + true + "\n"; 
```

首先，您可能想选择留下来`echo`或`print`。现在，继续：

```
print false + "\n" + true + "\n"; 
```

PHP 字符串，[当添加（未联系）](http://php.net/manual/en/language.operators.string.php)时，评估为`0`. 因此，此语句的计算结果为：

```
print 0 + 0 + 1 + 0; 
```

这是`1`。其他人也纷纷效仿。如果您希望您的代码工作，您应该使用连接运算符 ( `.`)。如果您想编写`True`或`False`喜欢 .NET 的方式，您可以编写一个简单的函数：

```
function writeBool($var)
{
    echo ($var) ? "True" : "False";
} 
```

根据 PHP 的松散类型（如果你问我，这很糟糕），任何将[评估为 的`true`](http://php.net/manual/en/language.types.boolean.php)东西都会写成“True”。我仍然不鼓励使用函数来执行此操作，因为[PHP 中的函数调用很*昂贵*](https://stackoverflow.com/questions/3691625)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T21:33:50.083

这应该可以解决问题。使用数组。

```
$boolarray = Array(false => 'false', true => 'true');
echo $boolarray[false],"  ", $boolarray[true]; 
```

输出 ：`false true`

# expressionengine - 如何过滤草稿/已关闭帖子的评论？

> ID：11512711
> 
> 赞同：1
> 
> 时间：2012-07-16T21:17:52.273
> 
> 标签：expressionengine

在表达式引擎中，我正在使用 {exp:comment:entries} 但我需要它来过滤掉处于草稿/关闭状态的博客文章的评论。

```
{exp:comment:entries limit="5" dynamic="no" channel="blog"}{/exp:comment:entries} 
```

看起来我需要使用 {status} 或 {entry_status} 但既不能作为参数也不能作为条件？

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:22:16.483

你是说你试过这个：

```
{exp:comment:entries limit="5" dynamic="no" channel="blog" entry_status="not closed|draft"}{/exp:comment:entries} 
```

??

这就是我所期望的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T02:08:36.283

您是否为该频道分配了状态组？（管理员 > 频道管理 > 频道 > 编辑组分配 > 状态组）

如果该通道的状态组设置为无，我已经看到按状态过滤的问题。

# ios - href 标记无法在新的 web 视图或移动 Safari 中打开

> ID：11512712
> 
> 赞同：2
> 
> 时间：2012-07-16T21:17:58.167
> 
> 标签：ios, ios-3.x

我正在与一家制作 iPhone 应用程序的公司合作，他们正试图在他们控制的 web 视图中显示网页。所以我给他们的只是一个 url，他们用某些参数点击它来自定义我返回的页面。（我的页面可能在 iFrame 或其他一些我不知道的标记中提供。）问题是，当意图让这些链接在移动设备中打开时，该网页上的链接在 web 视图中打开Safari 或在另一个 web 视图中。我尝试将 href 标记的目标更改为`_blank`, `_self`, `_parent`,`_top`但无济于事。

如果不清楚，我无法控制该应用程序。所以我不能尝试类似的东西`[UIApplication openURL:[NSURL URLWithString:myLink]]`。我只能控制要返回的页面的内容。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:34:40.993

要保持在同一个 web 视图中，您不应该使用 href。改用`ontouchstart`事件。 **例子：**

```
<a ontouchstart="javascript:window.location = '../abc.html';">Click here</a> 
```

不久前，我使用了下面的 javascript 函数，以确保我的 href 仅在 iPad 上浏览时转换为 ontouchstart 事件。

```
function clearLinks()
{
var isiPad = navigator.userAgent.match(/iPad/i) != null;
if(isiPad)
    {
    var obj = document.getElementById('body').getElementsByTagName('a');
    for(var i =0; i<obj.length; i++)
          {
            var url = obj[i].getAttribute('href');
                if(url.indexOf("javascript")==-1)
                {
                obj[i].setAttribute('ontouchstart', "window.location='" + url + "'");
                obj[i].setAttribute('href', 'javascript:function(){return false;}');
                }
            }
     }

} 
```

# regex - 如何通过引用过滤 PO 文件？

> ID：11512715
> 
> 赞同：1
> 
> 时间：2012-07-16T21:18:19.020
> 
> 标签：regex, sed, grep, gettext, po

我需要**从 PO 文件中过滤掉所有仅在 wordpress 管理员中使用的条目**（因此我只能翻译面向用户的字符串）。换句话说，**如果任何给定条目的所有引用都包含字符串“../admin”（即，以“#: ../admin”开头），我不希望它们出现在输出文件**中。

工具可以是 grep、sed、基于 windows 的任何东西。有任何想法吗？

> （欢迎提出实现此目的的其他方法的想法，但我正在考虑过滤掉面向用户的字符串进行翻译，然后仅将这些字符串放在 PO 文件中。母语是英语，我可以将所有面向管理员的内容保留为英语。）

过滤掉这个：

```
#: ../admin/add_new_packet.php:64
#: ../admin_processing/add_new_packet_processing.php:9
msgstr "取消"
msgstr ""

```

把它留在：

```
#: ../header-employer.php:81
#: ../admin/add_new_packet.php:64
msgstr "注销"
msgstr ""

```

以下是不熟悉的人[的 PO 文件格式。](http://www.gnu.org/software/gettext/manual/html_node/PO-Files.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:33:27.443

一种使用`awk`. 内容`script.awk`：

```
BEGIN {
    ## Separate records by one or more blank lines.
    RS = ""

    ## Each line will be one field. Both for input and output.
    FS = OFS = "\n"
}

## For every paragraph...
{
    ## Flag: If 0, print current record of PO file. If 1, don't
    ## print it.
    admin = 0 

    ## Traverse all lines of each record. If matches '#: ../admin'
    ## set flag and end processing.
    for (i = 1; i <= NF; i++ ) { 
        if ( $i ~ /^#: *\.\.\/admin\/?/ ) { 
            admin = 1 
            break
        }   
    }   

    ## Print only if flag hasn't been set.
    if ( ! admin ) { 
        print $0 "\n"
    }   
} 
```

*正如Lev Levitsky*在评论中所建议的那样，您既没有提供输入也没有提供输出，因此很难猜测脚本应该如何表现以获得解决方案并对其进行测试以检查其是否有效。

# javascript - 如何在 Mongoose.js 中应用字段类型验证而不会收到 CastError？

> ID：11512717
> 
> 赞同：3
> 
> 时间：2012-07-16T21:18:23.577
> 
> 标签：javascript, node.js, mongodb, express, mongoose

我正在尝试使用 Express 和 Mongoose 创建一个简单的表单，允许用户将新项目添加到集合中。

猫鼬模式：

```
var Item = new Schema({
  name   : {type : String, required : true},
  price  : {type : Number, required : true},
  description : {type: String, required: true},
}); 
```

快车路线：

```
var create = function(req, res) {
  Item.create(req.body, function(err) {
    if (err) return res.render('admin/items/new', {title: "New Item", errors: _.values(err.errors)});
    res.redirect('/admin/items/index');
  });
}; 
```

到目前为止很简单。我想要做的是添加适当的验证以确保`price`用户输入的是数字，如果没有显示适当的错误。

使用上面的代码，如果用户在价格文本字段中输入非数字字符，我会抛出 CastError。

因此，我尝试将以下验证添加到我的架构中：

```
Item.path('price').validate(function(v, fn) {
  if (typeof v === 'number' || v === undefined) return fn(true);
  return fn(false);
}, "must-be-numeric"); 
```

但是，Mongoose 似乎在应用此验证之前尝试转换该值，因此无法为此返回适当的验证错误，您仍然只会得到一个 CastError。此外， CastError 防止对正在运行的其他字段进行任何验证检查。

我认为我正在尝试做的事情是相当普遍的（在 Rails 中你只需添加`validate :price, :numericality => true`到你的模型中就可以了）。

**有没有我遗漏的明显模式可以促进这种类型验证？**

**其他人如何做到这一点？**

* * *

我尝试过/想到的事情：

*   我意识到在将表单字段传递给 Mongoose 之前，我可以使用辅助验证库（例如 node-validator）来“预验证”表单字段。但是，我真的不希望代码重复，或者将来自两个验证器的错误对象组合在一起以提供一组将反馈给用户的错误的样板混乱。
*   理想情况下，我会使用 HTML5“数字”`input`元素来防止错误的用户输入，但考虑到 Firefox 和 IE 还不支持它，它是一个非首发。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-03T06:49:20.220

我知道这是一个非常古老的帖子，我的回答可能对您没有太大帮助，但我仍然发布此帖子是为了将要使用它的用户。

我个人建议在用户提交他的数据之后使用[节点验证器](https://github.com/chriso/node-validator)（即甚至在数据提交给猫鼬之前）。这样您就可以验证用户输入本身，这是一个非常安全的想法。其次，这会创建一个清晰的代码，因为 mongoose 只允许您处理数据库，而不是您正在寻找的所有自定义验证。

您可以使用[express-validator](https://github.com/ctavan/express-validator)，它是使用节点验证器的中间件。这是处理验证的一种非常好的方法。

尽管记录在案，但我个人认为预保存实际上并不是为了验证。它主要用于创建任何引用的数据或发出事件以用于代码的其他部分。

我希望你也觉得这很有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-15T05:13:48.997

还有另一种方法可以做到这一点。您可以使用自定义设置器和自定义验证器：

```
var setNumberOrUndefined = function (val) {

    // this prevents set undefined if the user did not
    // enter any value
    if (val == '')
        return null

    // Return undefined prevents CastError
    // now a validator must validate if it's a number or not
    var v = Number(val)
    return (isNaN(v))? undefined : v

}

var isNumberOrEmpty = function (val) {

    // This prevents return false if the user did not
    // enter any value
    if (val === null)
        return true
    else
        return 'number' == typeof val
}

var Item = new Schema({
    name   : {type : String, required : true},
    price  : {
        type : Number, 
        required : true,
        set: setNumberOrUndefined,
        validate: [
            {validator: isNumberOrEmpty, msg: 'Price must be numeric!'},
        ]
    },
    description : {type: String, required: true},
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-17T00:07:33.987

Mongoose 中间件是你的朋友。

```
Item.pre('save' function(next) {
  if (this.price) {
    if (!myValidationFunction(this.price)) {
      return next(new Error('Price must be yada yada yada'))    
    }
  }
  next()
}) 
```

pre('save' ... 事件在 mongoose 级别验证之前触发，因此您可以更好地控制错误的生成方式。然后您可以在 express 中设置一个通用错误处理中间件，以捕获所有未捕获的错误和格式错误消息随心所欲。Express 2.x 有一个 .on('error'... 事件，但在 Express 3 中已删除。

本质上，错误捕获中间件会做这样的事情

```
app.use(function(err, req, res, next) {
  if (!(err instanceof Error)) next()
  // First param was some kind of error
  // format and send err.message however you like
  // in dev mode err.stack is usually interesting
  // this code is usually terminal, and does not call next() 
```

})

在使用 mongoose 中间件时使用的一些技巧没有得到很好的记录：

首先，要使保存失败，只需将 Error 对象传递给 next。不会触及数据库。其次，您可以通过检查 this.isNew 属性来区分插入和更新。

使用这样的模式的一个优点是大多数流行的节点库都使用它，因此您可以自信地整合您的错误处理，无论出现什么问题，您都将有机会格式化一些合理的东西。

最后一点，如果您通常采用这种方法，您可能会发现自己想要在 node.js 中创建自己的自定义错误对象。这些效果很好，但设置起来有点棘手。这是一篇好文章： [http ://dustinsenos.com/articles/customErrorsInNode](http://dustinsenos.com/articles/customErrorsInNode)

希望有帮助！

# windbg - 有没有办法在 WinDbg 中找到完全限定的方法名称？

> ID：11512721
> 
> 赞同：2
> 
> 时间：2012-07-16T21:18:42.140
> 
> 标签：windbg, sos

当我想使用 !bpmd 设置断点时，我需要完全限定的方法名称。

根据 MDSN 文档（[http://msdn.microsoft.com/en-us/library/bb190764.aspx](http://msdn.microsoft.com/en-us/library/bb190764.aspx)），我可以使用 ILDASM 找到类型名称。（所以我可以使用 ILDASM 找到完全限定的方法名称。）但是，这意味着我需要另一个单独的工具来搜索方法名称。

这个问题的背景是：
我知道我可以对本机应用程序使用“x”命令。由于 'x' 显示符号，我可以很容易地找到函数名称。因此，如果 .NET 应用程序有类似“x”命令的东西，我不需要使用单独的工具。我通常模糊地记得方法名称，但我不记得完全限定的方法名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:09:21.120

正如 'x' 是本机代码， !sosex.mx 是托管代码。

从 stevestechspot.com 免费下载 sosex。你可以通过通配符吗？和 * 在您的搜索中。但是，如果您只想设置断点，则可以使用 !sosex.mbm（或 !mbp，如果您想在源文件上中断，则使用行号）。

# c# - 如何以编程方式启动 IIS 6.0 SMTP 虚拟服务器？

> ID：11512727
> 
> 赞同：3
> 
> 时间：2012-07-16T21:19:28.183
> 
> 标签：c#, iis, smtp

我想知道如何以编程方式重新启动 IIS 6.0 SMTP 服务器。

我设置的 SMTP 服务器不时崩溃。我有几天都没有注意到它，但现在做任何事情都为时已晚。

我想每 30 分钟左右设置一个计划任务来测试 SMTP 服务器是否正在运行，如果没有，计划任务会自动启动它。

我找到了一种方法来检查 SMTP 服务器是否已启动并正在运行，但我还没有弄清楚如果它崩溃了如何重新启动该进程。

这种方式发布在这里：[Testing SMTP server is running via C#](https://stackoverflow.com/questions/1633391/testing-smtp-server-is-running-via-c-sharp)

任何帮助都会很棒！

谢谢你。

我在 C# 中开发控制台应用程序以检查它是否正在运行，所以任何代码示例也会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T21:49:04.113

[ServiceController](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicecontroller.aspx)可以帮助您，因为它具有启动和停止方法。查看 msdn 页面中的示例。

另一个示例取自[ServiceControllerStatus 枚举](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicecontrollerstatus.aspx)几乎是您需要的（只需替换服务名称）。

```
ServiceController sc = new ServiceController("Telnet");
Console.WriteLine("The Telnet service status is currently set to {0}", 
                  sc.Status.ToString());

if  ((sc.Status.Equals(ServiceControllerStatus.Stopped)) ||
     (sc.Status.Equals(ServiceControllerStatus.StopPending)))
{
   // Start the service if the current status is stopped.

   Console.WriteLine("Starting the Telnet service...");
   sc.Start();
}  
else
{
   // Stop the service if its status is not set to "Stopped".

   Console.WriteLine("Stopping the Telnet service...");
   sc.Stop();
}  

// Refresh and display the current service status.
sc.Refresh();
Console.WriteLine("The Telnet service status is now set to {0}.", 
                   sc.Status.ToString()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-25T09:03:59.837

也许我遗漏了一些东西，或者改变了一些东西，但是当你在**Windows 2012R2**上安装 SMTP 服务时，没有专门的服务。因此，对于最新版本的 Windows，上述建议将不起作用。

幸运的是，有一种方法可以轻松得多。电源外壳：

```
([ADSI]'IIS://LOCALHOST/SMTPSVC/1').Start() #to start
([ADSI]'IIS://LOCALHOST/SMTPSVC/1').Stop()  #to ... you guess 
```

最奇怪的是，你通过AD控制smtp服务，但它确实有效。当然，这应该被提升。如果您有多个虚拟 SMTP 服务器，您可能需要首先通过索引或某些属性（例如`.ConnectionTimeout`）来识别您的服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-05T15:20:00.083

在c#中你可以写：

```
 enum StatusVirtualServerSMTP
            {
                 Started = 2,
                 Stopped = 4
            }

            DirectoryEntry dir = new DirectoryEntry("IIS://localhost/SMTPSVC/1");

            if (Convert.ToInt32(dir.Properties["SERVERSTATE"].Value) == (int)StatusVirtualServerSMTP.Stopped)
            {
                dir.Properties["SERVERSTATE"].Value = (int)StatusVirtualServerSMTP.Started;
                dir.CommitChanges();
            } 
```

# javascript - 使用 jQuery，如何获取 HTML 元素的属性，即不是匹配集的第一个元素？

> ID：11512728
> 
> 赞同：0
> 
> 时间：2012-07-16T21:19:35.503
> 
> 标签：javascript, jquery, jquery-selectors

我知道您使用该`attr`方法获取匹配集中*第一个项目*的属性，例如`$('input').attr('name')`为您提供第一个匹配输入元素的名称属性。

但是我如何直接从 HTML 元素中获取属性，例如`$('input')[0]`？我想做类似的事情，`$('input')[0].attr('name')`但这不起作用，因为`attr`这只是 jQuery 匹配集的一种方法，而不是匹配集中的项目。

（顺便说一句，这是因为我想将匹配集中的项目传递给函数，并能够在函数中看到该项目的属性。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:21:47.880

如果`[0]`您只是想从匹配集中获取特定元素，请使用`eq()`：

```
$(selector).eq(0).attr('name'); 
```

将获取`name`返回的集合中第一个元素的属性`selector`。当然，`0`可以替换为该选择器返回的任何元素的索引号。

同样，您可以使用`:eq()`选择器：

```
$('div:eq(0)').attr('name'); 
```

或者，如果`selector`是一个变量：

```
$(selector + ':eq(0)').attr('name'); 
```

正如 Alnitak 所指出的，在下面的评论中：

> 如果您要使用 eq，请使用`.eq(n)`而不是`:eq(n)`让浏览器可以使用`querySelectorAll()`- 后者是 jQuery 扩展。

当然，对于某些名称或属性，您可以回退到 DOM 方法：

```
$(selector)[0].name; 
```

或者：

```
$(selector)[0].getAttribute('name'); 
```

参考：

*   [`:eq()`](http://api.jquery.com/eq-selector/).
*   [`eq()`](http://api.jquery.com/eq/).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:32:24.063

当你有一个实际的 HTML 对象时，你仍然可以通过将它包装在 $(element) 中来 JQuery 化它，然后可以访问 attr()

```
var secondThing = $('input')[1]
foo(secondThing)

function foo(element){
var elem = $(element);
var name = elem.attr('name');

//or
name = element.getAttribute('name')

} 
```

# c# - 有没有办法检查表单是否有表单边框？（按把手）

> ID：11512730
> 
> 赞同：-1
> 
> 时间：2012-07-16T21:19:41.837
> 
> 标签：c#, winforms, handle, formborderstyle

我想通过其句柄检查表单是否具有表单边框。而且，句柄来自另一个应用程序。

我该如何处理？请帮助我..谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:20:31.857

```
[DllImport("user32.dll")]
extern static int GetWindowLong(IntPtr hWnd, int nIndex);

const int GWL_STYLE = -16;
const int WS_BORDER = 0x00800000;  // thin border
const int WS_THICKFRAME = 0x00040000;  // sizing (thick) border

public static bool NativeWindowHasBorder(IntPtr hWnd)
{
     return (GetWindowLong(hWnd, GWL_STYLE) & (WS_BORDER | WS_THICKFRAME)) != 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:23:04.020

`Control`s 本身实际上并没有句柄。`Control.Handle`实际上返回它的父窗口的`.Handle`.

来自[MSDN`Control.Handle`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.handle.aspx)：

> 获取控件绑定到的窗口句柄。

如果您查看反编译的源代码`Control`，您会看到：

```
internal IntPtr HandleInternal
{
  get
  {
    return this.window.Handle;
  }
} 
```

* * *

**编辑**

我上面所说的完全不正确。出于历史原因，我要离开它。

`Button`可以通过将 a放在a 上`Form`并查看`IntPtr Handle`它们的值来很容易地证明这一点。它们是不同的。

# qt - 如何重新启动 QWizard？

> ID：11512733
> 
> 赞同：0
> 
> 时间：2012-07-16T21:19:50.117
> 
> 标签：qt

我有一个 QWizard，我有一个子类，不想完成。当用户单击完成按钮时，我只想回到开头。我第一次尝试只是覆盖 nextId() 方法，但这不会让我倒退。还有其他想法吗？这是 Qt 4.6

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:44:44.990

[`restart()`](http://doc.qt.nokia.com/4.6/qwizard.html#restart)例如，可以从`done()`. 请注意，这会重置您的字段。

# firefox - 哪个观察者在 har 中的 t=0 时被解雇？

> ID：11512744
> 
> 赞同：0
> 
> 时间：2012-07-16T21:20:43.407
> 
> 标签：firefox, firefox-addon, firebug, har

我正在为 firefox 做扩展，想知道哪个观察者在 har 文件中的 time=0 时监听事件。

以下是我做的一些作业：我发现 http-on-modify-request 将针对来自 firefox 的所有请求触发。但是，如果我监听第一个 http-on-modify-request 事件，我什至在加载 firefox GUI 之前就触发了此事件，并且当我将其时间与其 har 文件进行比较时，时间已关闭。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T10:21:19.940

在不知道 Firebug 到底在做什么的情况下，我怀疑它正在使用[progress listeners](https://developer.mozilla.org/en/Code_snippets/Progress_Listeners)。因此，正在记录的“事件”是带有和标志的`onStateChange`调用- 在特定浏览器选项卡中开始加载。`STATE_START``STATE_IS_WINDOW`

# c# - 装箱和拆箱也是铸造？

> ID：11512750
> 
> 赞同：9
> 
> 时间：2012-07-16T21:21:11.957
> 
> 标签：c#, casting, boxing

当我们在原始数据类型之间转换数据类型时，它被称为数据类型转换。

但是当在 ValueType 和 ReferenceType 之间进行转换时，我们称之为装箱和拆箱。

装箱和拆箱也可以称为铸造吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T21:23:21.407

本质上，装箱只是将值类型包装在对象外壳中。它实际上并不像说那样涉及类型转换`(int)3.14`。即使他们都使用强制转换运算符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-28T12:20:29.287

C#类型系统包含三种类型，它们是值类型、引用类型和指针类型。C# 允许我们将值类型转换为引用类型，然后再转换回值类型。将值类型转换为引用类型的操作称为装箱，相反的操作称为拆箱。

拳击

1.  `int Val = 1;`

2.  `Object Obj = Val; //Boxing`

第一行我们创建了一个值类型 Val 并为 Val 赋值。第二行，我们创建了 Object Obj 的实例并将 Val 的值分配给 Obj。从上面的操作（Object Obj = i）我们看到将 Value Type 的值转换为相应的 Reference Type 的值。这些类型的操作称为装箱。

拆箱

1.  `int Val = 1;`

2.  `Object Obj = Val; //Boxing`

3.  `int i = (int)Obj; //Unboxing`

前两行显示了如何将值类型装箱。下一行 (int i = (int) Obj) 显示从 Object 中提取值类型。那就是将引用类型的值转换为值类型的值。此操作称为拆箱。

装箱和拆箱是计算成本高昂的过程。当一个值类型被装箱时，必须分配和构造一个全新的对象，拆箱所需的强制转换在计算上也很昂贵

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:26:28.373

每个不可为空的值类型都有一个关联的具有相同成员的堆对象类型。对值类型存储位置进行装箱会创建一个新的堆类型实例，并将值类型存储位置中的所有字段复制到新实例的相应字段中。拆箱值类型会将所有字段从其对应的堆对象类型的实例复制到值类型存储位置的对应字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T21:32:35.330

装箱是将值类型转换为类型对象并取消装箱以取回值的过程[http://msdn.microsoft.com/en-us/library/yz2be5wk.aspx](http://msdn.microsoft.com/en-us/library/yz2be5wk.aspx)

以及[铸造](http://msdn.microsoft.com/en-us/library/ms173105)是将一种类型转换为另一种兼容类型

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T21:36:05.327

装箱基本上是将值类型装箱到稍后可以拆箱的匿名对象中。

```
int x = 567;
object y = x; //boxing

int z = (int) y; //z will be 123

int x = 567;
object y = (object)x; //explicit boxing (not necessary)

int z = (int) y; //z will be 123 
```

装箱/拆箱不应与类型转换混淆，因为装箱时我们只是在变量周围放置一个包装器。通过进行类型转换，您实际上是在更改变量或对象的类型。

```
Double x = 3.14444;
Integer y = (Integer)x; //(type cast or static cast in c++) changing the type and loosing the original value too in this case.

int x = 567;
object y = (object)x; //explicit boxing (not necessary)

float z = (float) y; //another example of type casting while unboxing 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-16T21:37:59.507

铸造：（基本上是将一种类型的实例转换为另一种类型）

```
int a = (int) 3.14 // from the example above does casting with loosing precision.
double b = a; // casting again (we may write (double) a - gives the same result). 
```

装箱：（将值类型复制到堆中的过程）

```
object c = new MyStruct(); // MyStruct = struct.
object d = 1;
object e = (int) 3.14; // here we have actually casting and then boxing. 
```

拆箱（将装箱的值类型复制回堆栈）：

```
Button f = (MyStruct) c;
int g = (int) d; // it still unboxing however it looks exactly like the line #1 above. 
```

希望能帮助到你。

# java - 等价于其他流行语言的后期静态绑定（PHP）

> ID：11512752
> 
> 赞同：8
> 
> 时间：2012-07-16T21:21:20.413
> 
> 标签：java, php, c++, python

```
<?php
class A {
    public static function who() {
        echo __CLASS__;
    }
    public static function test() {
        static::who(); // Here comes Late Static Bindings
    }
}

class B extends A {
    public static function who() {
        echo __CLASS__;
    }
}

B::test(); // Outputs "B"
?> 
```

我想在Java中得到一个等价物......所以像

```
class A {
    public static void who(){
        System.out.println("A");
    };

    public static void test(){
        who(); //<<< How to implement a static:: thing here???
    }
}

class B extends A {
     public static void who(){
        System.out.println("B");
     };

     public static void main(String[] args){
        B.test(); // Outputs "A" but I want "B"
     }
} 
```

我希望`who()`内部`A::test`调用通过调用`B::who`.

编辑：我知道在最流行的语言中没有这样做的“标准方式”。我正在寻找黑客等。此外，这在 C/C++ 或任何其他流行的 OOP 语言中是否可行？

这不适用于任何真正的设计。我只是好奇。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:23:52.677

在 Java 中是不可能的。（至少不是没有丑陋的反射黑客。）

我鼓励您重新考虑您的设计并依赖适当的对象。

**相关问题：**

*   [我可以在 Java 中覆盖和重载静态方法吗？](https://stackoverflow.com/questions/2475259/can-i-override-and-overload-static-methods-in-java)

**编辑：** `B.test()`将（或至少根据规范）编译为对 的调用`A.test()`，因此无法*发现*调用是如何从`A.test()`. 换句话说，没有办法让 的行为`A.test`依赖于它是否通过`A.test()`or调用`B.test()`。

由于您是出于好奇而询问，因此这是 AFAIK 最接近的“解决方案”。

1.  `test`使用 a作为参数重载`test(Class<?> c)`定义预期`who`方法的类。
2.  *`test()`在 class 中*隐藏*（注意不能覆盖）`B`。*
**   并`A.test`稍作改动执行。*

 *在代码中：

```
class A {
    public static void who() {
        System.out.println("A");
    }

    public static void test() {
        test(A.class);
    }

    public static void test(Class<?> c) {
        //who(); //<<< How to implement a static:: thing here???
        try {
            c.getMethod("who").invoke(null); // Call static who on given class.
        } catch (Exception e) {
        }
    }

}

public class B extends A {
     public static void who(){
        System.out.println("B");
     }

     public static void test() {
         test(B.class);
     }

     public static void main(String[] args){
        A.test(); // Outputs "A"
        B.test(); // Outputs "B"
     }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T22:45:57.477

`B.test`即使`B`没有声明名为`test`.

```
Bytecode of main method:

invokestatic #5 = Method B.test(()V)
return 
```

给定类和方法的名称（`"B"`和`"who"`），您可以轻松地使用反射来调用该方法。所以问题变成了

> 你可以`B`通过结合调用堆栈和字节码来提取`A.test`吗？

您需要使用存储在堆栈中的返回地址来定位`B.test`字节码中的调用并提取声明的调用。有很多字节码操作库，但我不知道它们是否允许您将其绑定到 JVM 中的执行堆栈。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:26:22.240

你不能覆盖java中的静态方法。

[http://geekexplains.blogspot.co.uk/2008/06/can-you-override-static-methods-in-java.html](http://geekexplains.blogspot.co.uk/2008/06/can-you-override-static-methods-in-java.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-28T17:59:49.483

这是Java的一个例子。它使用 Java 8 默认方法和`getClass()`. 我敢打赌它也适用于类：

```
interface A {
    default String name() {
       return getClass().getName();
    }
}

class B implements A {}

public class LateBinding {
    public static void main(String[] args) {

        // Create an anonymous class in `LateBinding` (called `$1`)
        System.out.println(new A(){}.name());

        // Instantiate a new `B`
        B b = new B();
        System.out.println(b.name());
    }
} 
```

结果：

```
$ javac LateBinding.java && java LateBinding
LateBinding$1
B 
```

正如您所看到的，该方法在两种情况下都知道它正在运行，尽管它是在`A`. 这个例子并不是真正的静态，因为你不能`getClass()`静态调用，但是 PHP 中的 LSB 并不真正局限于静态上下文。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T21:28:30.257

使用静态方法声明没有优雅的方法（据我所知，只有 Delphi 支持覆盖静态方法）。但是，如果您不需要静态，您可以编写如下内容：

```
class A {
    public void who(){
        System.out.println("A");
    };

    public void test(){
        who(); //<<< How to implement a static:: thing here???
    }
}

class B extends A {
    @Override
    public void who(){
        System.out.println("B");
    };
    public void main(String[] args){
        A instance = new A();
        instance.test(); // prints 'A'

        instance = new B();
        instance.test(); // prints 'B'
    }
} 
```

澄清后编辑： 这样做很hacky的方式：[Thread.currentThread().getStackTrace()](https://stackoverflow.com/questions/1069066/get-current-stack-trace-in-java)然后从最顶层的记录获取方法和该方法所属的类。拥有 c 类 - 你可以编写 c.getMethod("who").invoke(null); 调用对应的 who() 方法。*

# javascript - jquery 在使用 html() 进行的 DOM 修改上失败

> ID：11512755
> 
> 赞同：0
> 
> 时间：2012-07-16T21:21:41.860
> 
> 标签：javascript, jquery, html, hashchange

在我的网站中，我基于以下内容构建页面导航`hashchange`：

```
var hashHome;
$(window).bind( 'hashchange', function(e) {
    var homeClass = "home";
    var url = $.param.fragment();
    if($('#page-content').hasClass(homeClass)){
        hashHome = $('#page-content').html();
    }

    if(url ==''){
        //homepage with nothing(no hash)
        if(!$('#page-content').hasClass(homeClass)){
            //alert("load frim cache ->#"+url);
            $('#page-content').addClass(homeClass);

            $('#page-content').html(hashHome);
        }
    }else{
        //go to some page 
        if($('#page-content').hasClass(homeClass))
            $('#page-content').removeClass(homeClass);
        initAction(url);
    }
})
$(window).trigger( 'hashchange' ); 
```

当站点加载其主页时，主页将存储在`hashHome`. 如果用户离开，`initAction(id)`则将整个`$('#page-content')`' 内容替换为其他页面的内容。当用户导航回主页时，它会将存储的主页恢复为`$('#page-content')`.

我的问题是所有 jQuery 都停止在主页上工作。

我已经阅读过，`live()`但似乎它需要一个类似的事件`click()`才能工作。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T13:19:13.303

我发现在更改围绕它的 div 的内容之前，我需要存储整个页面

```
var content$('#page-content').html(); 
```

然后做内容改变

这样，当我重新初始化所有 jQuery 插件时，它们将丢失所有旧引用并使用新`content`变量，而不是双重初始化

最后，我的原始问题代码也不起作用，因为脚本标签看起来像这样：`<script type="text/javascript">...</script>`，IE 由于某些原因无法识别，所以我必须将其更改为`<script></script>`以使其跨浏览器兼容

# sql - 大型记录集上的锁定问题

> ID：11512757
> 
> 赞同：3
> 
> 时间：2012-07-16T21:22:06.200
> 
> 标签：sql, sql-server-2008, sql-server-2005

我有一个用作队列系统的数据库表，其中相互通信的单独进程在表中创建和读取条目。例如，当用户启动搜索时，会创建一个条目，然后每隔一两秒运行一次的另一个进程将获取该新条目，更新状态然后进行搜索，当搜索完成时再次更新条目。这一切似乎都适用于每小时数千次搜索。

但是，我有一个主管理屏幕，可以让我查看所有这些“作业”的状态，但运行速度非常慢。我基本上会返回最后一小时表中的所有条目，这样我就可以密切关注正在发生的事情。我认为我遇到了某种锁定问题。我只需要阅读每个条目，并不关心数据是否有点过时。我只是使用标准的“Select * from Table”语句，所以它可能正在等待其他锁在返回数据之前过期，因为作业会不断更新数据。

这是否可以通过某种游标更好地处理以一次返回每一行等？还有其他想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:26:24.360

您需要`FROM yourtable WITH (NOLOCK)`表格提示。

您可能还想在更新过程中查看事务隔离，如果您还没有的话

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T21:27:18.703

如果您真的不在乎数据是否有点过时......或者如果您只需要数据 99.99% 准确，请考虑使用[`WITH (NOLOCK)`](http://msdn.microsoft.com/en-us/library/ms187373.aspx)：

```
SELECT * FROM Table WITH (NOLOCK); 
```

这将指示您的查询使用`READ UNCOMMITTED ISOLATION LEVEL`具有以下行为的 ：

> 指定允许脏读。不下发共享锁以防止其他事务修改当前事务读取的数据，其他事务设置的排他锁不会阻止当前事务读取锁定的数据。

请注意，这[`NOLOCK`可能会导致数据不准确](http://blogs.msdn.com/b/davidlean/archive/2009/04/06/sql-server-nolock-hint-other-poor-ideas.aspx)，因此在系统的其余部分中使用它可能不是一个好主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:31:41.320

An alternative to `NOLOCK` (which can lead to very bad things, such as missed rows or duplicated rows) is to [allow read committed snapshot isolation at the database level](http://msdn.microsoft.com/en-us/library/ms345124.aspx) and then issue your query with:

```
SET TRANSACTION ISOLATION LEVEL SNAPSHOT; 
```

# javascript - 单页 JavaScript MVC 应用程序的评论框架，如 AngularJS 的 Disqus

> ID：11512759
> 
> 赞同：4
> 
> 时间：2012-07-16T21:22:07.107
> 
> 标签：javascript, comments, angularjs, singlepage

我正在开发没有任何后端但使用 mongolab 存储数据的单页 AngularJS 应用程序。

它还使用相同的 URL 进行所有调用（如 CRUD 和过滤），仅更改 hashbang ( `#`) 之后的部分。

所以 URL 看起来像`mysite.com/#!/`主页，`mysite.com/#!/view/:id`用于查看故事，`mysite.com/#!/edit/:id`用于编辑它等。

我想使用一些第三方托管的评论工具来允许用户评论每个故事。我尝试过 Disqus 和 Livefyre，但它们在 hashbang 之前绑定到 URL，所以所有网站页面都只是它们的单个页面。我尝试重新加载 Disqus，但它每次都尝试重新附加它自己的 javascript，因此多次加载它会导致 js 错误。我查看了 Facebook 评论，但它甚至没有页面 ID，因此评论仅针对每个站点。

Disqus 有它自己的 API，但是没有 JS 绑定到最新（也是唯一）版本的 API（3.0），我自己创建绑定看起来有点过分。

有谁知道我可以与 AngularJS 或任何可以提供帮助的托管解决方案一起使用的好的 JS 评论框架？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T21:49:53.927

[http://docs.angularjs.org/](http://docs.angularjs.org/)已经完成了您在此处描述的大部分内容。Disqus 非常适合我们。随意查看源代码。一切都在github上。

# c# - 如果没有自动添加时间，则无法从 SQL 日期字段显示日期

> ID：11512760
> 
> 赞同：2
> 
> 时间：2012-07-16T21:22:09.207
> 
> 标签：c#

C＃; .Net 3.5

MessageBox.Show(String.Format("{0:MM/dd/yyyy}", reader2["SentDate"].ToString()));

返回：

2012 年 7 月 12 日上午 12:00:00

SentDate 是一个 SQL 日期字段（不是日期时间），字段中只包含“2012-07-12”。

我究竟做错了什么？我只想让 MessageBox 显示“7-12-2012”而不显示“12:00:00 AM”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:25:20.190

脱掉`.ToString()`。在将其发送到模板之前，您将使用默认格式将其转换为字符串。

```
MessageBox.Show(String.Format("{0:MM/dd/yyyy}", reader2["SentDate"])); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T21:23:23.133

```
DateTime dt = getSomeDateTime();
dt.ToString("MMddyy"); 
```

您可以通过执行将其应用到您的消息框

```
MessageBox.Show(reader2["SentDate"].ToString("MMddyy")); 
```

[本文档可能会帮助您对此进行扩展。](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:36:27.773

尝试其中任何一个，如果它有效

```
 // create date time 2008-03-09 16:05:07.123

    DateTime dt = new DateTime(2008, 3, 9, 16, 5, 7, 123);

    String.Format("{0:y yy yyy yyyy}", dt);  // "8 08 008 2008"   year

    String.Format("{0:M MM MMM MMMM}", dt);  // "3 03 Mar March"  month

    String.Format("{0:d dd ddd dddd}", dt);  // "9 09 Sun Sunday" day

    String.Format("{0:h hh H HH}", dt);  // "4 04 16 16"      hour 12/24

    String.Format("{0:m mm}", dt);  // "5 05"            minute

    String.Format("{0:s ss}", dt);  // "7 07"            second

    String.Format("{0:f ff fff ffff}", dt);  // "1 12 123 1230"   sec.fraction

    String.Format("{0:F FF FFF FFFF}", dt);  // "1 12 123 123"    without zeroes

    String.Format("{0:t tt}", dt);  // "P PM"            A.M. or P.M.

    String.Format("{0:z zz zzz}", dt);  // "-6 -06 -06:00"   time zone 
```

另一个相同的例子在这里 [看](http://www.csharp-examples.net/string-format-datetime/)

# iis - 使用 IIS URL 重写模块修改查询字符串

> ID：11512763
> 
> 赞同：1
> 
> 时间：2012-07-16T21:22:27.700
> 
> 标签：iis, sharepoint-2010, url-rewriting

我正在将一些 Sharepoint 站点从一个场迁移到另一个场。它有点复杂，但为了简单起见......

我想要维护的是人们为这些站点、文档等提供的旧 URL，而 IIS URL 重写模块似乎是一个不错的选择。

这是结构的概念：

```
_______________________         _______________________
|oldfarm.company.com**|         |newfarm.company.com**|
|oldsitecollection**  |         |newsitecollection**  |
|subsitename          |         |subsitename          |
|...                  |         |...                  |
|_____________________|         |_____________________| 
```

** = 变化，其他一切都保持不变，URLwise。

在“newfarm”上，我扩展了 Web 应用程序以响应“oldfarm.company.com”，并且该 Web 应用程序有一个 URL 重定向规则，将[http://oldfarm.company.com/oldsitecollection/](http://oldfarm.company.com/oldsitecollection/) ... 重定向到[http ://newfarm.company.com/newsitecollection/](http://newfarm.company.com/newsitecollection/) ...

这对我想做的绝大多数事情都很有效。

我遇到的困难是重写 QUERYSTRING 值。Sharepoint 的 Office 文档查看器在 QUERYSTRING 中包含路径信息，这就是我需要更改的内容。

这是一个原始 URL 示例： [http ://oldfarm.company.com/oldsitecollection/subsitename/_layouts/WordViewer.aspx?id=/oldsitecollection/subsitename/doclib/doc.docx&Source=http%3A%2F%2Foldfarm%2Ecompany% 2Ecom%2Foldsitecollection%2Fsubsitename%2Fdoclib%2FForms%2FAllItems%2Easpx&DefaultItemOpen=1](http://oldfarm.company.com/oldsitecollection/subsitename/_layouts/WordViewer.aspx?id=/oldsitecollection/subsitename/doclib/doc.docx&Source=http%3A%2F%2Foldfarm%2Ecompany%2Ecom%2Foldsitecollection%2Fsubsitename%2Fdoclib%2FForms%2FAllItems%2Easpx&DefaultItemOpen=1)

这是重定向后的 URL（也是我卡住的地方）： http://newfarm.company.com/newsitecollection/subsitename/_layouts/WordViewer.aspx?id=/oldsitecollection/subsitename/doclib/doc.docx&Source= [http %3A%2F%2Foldfarm%2Ecompany%2Ecom%2Foldsitecollection%2Fsubsitename%2Fdoclib%2FForms%2FAllItems%2Easpx&DefaultItemOpen=1](http://newfarm.company.com/newsitecollection/subsitename/_layouts/WordViewer.aspx?id=/oldsitecollection/subsitename/doclib/doc.docx&Source=http%3A%2F%2Foldfarm%2Ecompany%2Ecom%2Foldsitecollection%2Fsubsitename%2Fdoclib%2FForms%2FAllItems%2Easpx&DefaultItemOpen=1)

这是我需要的 URL 的样子： [http ://newfarm.company.com/newsitecollection/subsitename/_layouts/WordViewer.aspx?id=/newsitecollection/subsitename/doclib/doc.docx&Source=http%3A%2F% 2Fnewfarm%2Ecompany%2Ecom%2Fnewsitecollection%2Fsubsitename%2Fdoclib%2FForms%2FAllItems%2Easpx&DefaultItemOpen=1](http://newfarm.company.com/newsitecollection/subsitename/_layouts/WordViewer.aspx?id=/newsitecollection/subsitename/doclib/doc.docx&Source=http%3A%2F%2Fnewfarm%2Ecompany%2Ecom%2Fnewsitecollection%2Fsubsitename%2Fdoclib%2FForms%2FAllItems%2Easpx&DefaultItemOpen=1)

我曾尝试使用 Rewrite Maps，因为这些不是动态替换，但我无法让它们修改 QUERYSTRING。

这是我正在处理的重写规则的示例：

```
<rewrite>
    <rewriteMaps>
        <rewriteMap name="WordViewer">
            <add key="id=/oldsitecollection" value="id=/newsitecollection" />
        </rewriteMap>
    </rewriteMaps>
    <rules>
        <rule name="Rewrite rule1 for WordViewer">
            <match url=".*WordViewer.aspx" />
            <conditions>
                <add input="{WordViewer:{QUERY_STRING}}" pattern="(.+)" />
            </conditions>
            <action type="Rewrite" url="{C:1}" appendQueryString="false" />
        </rule>
    </rules>
</rewrite> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T19:02:38.067

为了回答我自己的问题，对我有用的是创建我自己的[自定义重写提供程序](http://learn.iis.net/page.aspx/804/developing-a-custom-rewrite-provider-for-url-rewrite-module/)。

我创建的提供程序是一个简单的查找/替换提供程序，如下所示：

```
public class FindReplaceProvider : IRewriteProvider, IProviderDescriptor
{
    public string Find { get; private set; }
    public string Replace { get; private set; }

    public void Initialize(IDictionary<string, string> settings, IRewriteContext rewriteContext)
    {
        string tmpFind, tmpReplace;

        if (!settings.TryGetValue("Find", out tmpFind) || string.IsNullOrEmpty(tmpFind))
            throw new ArgumentException("FindReplaceProvider setting 'Find' is required and cannot be empty");

        if (!settings.TryGetValue("Replace", out tmpReplace))
            throw new ArgumentException("FindReplaceProvider setting 'Replace' is required and cannot be null");

        if (!string.IsNullOrEmpty(tmpFind))
            Find = tmpFind;
        else
            throw new ArgumentException("FindReplaceProvider parameter 'Find' cannot be empty");

        if (!string.IsNullOrEmpty(tmpReplace))
            Replace = tmpReplace;
        else
            Replace = String.Empty;
    }

    public string Rewrite(string value)
    {
        return Regex.Replace(value, Find, Replace, RegexOptions.IgnoreCase);
    }

    public IEnumerable<SettingDescriptor> GetSettings()
    {
        yield return new SettingDescriptor("Find", "String to find");
        yield return new SettingDescriptor("Replace", "String to replace");
    }
} 
```

我的重写规则最终看起来像这样：

```
<rewrite>
  <providers>
    <provider name="OfficeWebAppsReplaceId" type="MyFindReplaceProvider">
      <settings>
        <add key="Find" value="id=/oldsitecollection" />
        <add key="Replace" value="id=/newsitecollection" />
      </settings>
    </provider>
    <provider name="OfficeWebAppsReplaceSource" type="MyFindReplaceProvider">
      <settings>
        <add key="Find" value="http%3A%2F%2Foldfarm%2Ecompany%2Ecom%2Foldsitecollection%2" />
        <add key="Replace" value="http%3A%2F%2Fnewfarm%2Ecompany%2Ecom%2Fnewsitecollection%2" />
      </settings>
    </provider>
  </providers>
  <rules>
    <rule name="OfficeWebAppsQuerystringRedirect" stopProcessing="true">
      <match url=".*(WordViewer.aspx|WordEditor.aspx|xlviewer.aspx|PowerPoint.aspx)$" />
      <conditions logicalGrouping="MatchAny">
        <add input="{QUERY_STRING}" pattern=".*id=/oldsitecollection.+" />
        <add input="{QUERY_STRING}" pattern=".*Source=http%3A%2F%2Foldfarm%2Ecompany%2Ecom%2Foldsitecollection%2F.+" />
      </conditions>
      <action type="Redirect" url="{R:0}?{OfficeWebAppsReplaceId:{OfficeWebAppsReplaceSource:{C:0}}}" appendQueryString="false" redirectType="Temporary" />
    </rule>
  </rules>
</rewrite> 
```

# jasper-reports - 接收 REPORT_DATA_SOURCE 未找到，即使它存在

> ID：11512781
> 
> 赞同：-1
> 
> 时间：2012-07-16T21:23:54.407
> 
> 标签：jasper-reports

我尝试使用*iReport中的默认***REPORT_DATA_SOURCE**参数将数据从数据源传递到我的子报表，以进一步传递到子报表中的另一个子报表。我可以在主报告的参数列表中看到**REPORT_DATA_SOURCE**作为参数，但是当我在子报告中设置连接类型并尝试将数据源表达式设置为以下内容时，我得到一个***JRValidationException***说参数不是成立。****`new net.sf.jasperreports.engine.data.JRBeanCollectionDataSource($P{REPORT_DATA_SOURC‌​E})`****

 ****当这是一个内置参数时，知道为什么要这样做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:02:20.063

你不应该做

```
new net.sf.jasperreports.engine.data.JRBeanCollectionDataSource($P{REPORT_DATA_SOURC‌​E}) 
```

一点也不。您应该能够简单地将数据源表达式设置为

```
$P{REPORT_DATA_SOURCE} 
```

$P{REPORT_DATA_SOURCE} 是 JRDataSource 的一个实例，它是 JasperReports 定义的所有不同类型的数据源实现的接口。在实际报告级别，它是 JRDataSource 的哪个具体实现并不重要。

也不是在您的代码中，您实际上试图将 JRDataSource 实例传递给 JRBeanCollectionDataSource 的构造函数以创建新实例。也不需要这样做。****

# ios - 未选择 UITabBar 颜色？

> ID：11512783
> 
> 赞同：66
> 
> 时间：2012-07-16T21:24:04.907
> 
> 标签：ios, uitabbarcontroller, uitabbar, uitabbaritem

我有一个包含 5 个项目的 UITabBar。我想更改所有项目的未选择颜色。这些项目未在 UIViewController 类中声明（我构建了它们并链接了 Storyboard 中的视图）。

有没有这样的代码：`[[UITabBar appearance] set***UN***SelectedImageTintColor:[UIColor whiteColor]];`？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2016-10-15T20:08:57.417

在**iOS 10 及更高版本**中，有 3 种可能的简单解决方案：

A. 来自代码的实例（Swift）：

```
self.tabBar.unselectedItemTintColor = unselectedcolor 
```

B. 来自 IB 的实例：

添加一个关键路径：`unselectedItemTintColor`类型：`Color`

C. 全局外观（Swift）：

```
UITabBar.appearance().unselectedItemTintColor = unselectedcolor 
```

[![](../Images/8d8358264e034f19ec0759c03c0b6126.png)](https://i.stack.imgur.com/CfajP.png)

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2013-08-25T21:38:04.727

据我所知，这在 iOS 7 下不起作用。特别是，选项卡栏的*tintColor*将定义选定选项卡的颜色，而不是未*选定选项卡*的颜色。如果您想更改 iOS 7 中的默认设置，似乎您必须实际使用不同的图标（使用您喜欢的未选中选项卡的颜色）并设置文本的颜色。

此示例应将选定的选项卡着色为红色，并将其他选项卡渲染为绿色。在 TabBarController 中运行此代码：

```
// set color of selected icons and text to red
self.tabBar.tintColor = [UIColor redColor];
[[UITabBarItem appearance] setTitleTextAttributes:[NSDictionary dictionaryWithObjectsAndKeys: [UIColor redColor], NSForegroundColorAttributeName, nil] forState:UIControlStateSelected];

// set color of unselected text to green
[[UITabBarItem appearance] setTitleTextAttributes:[NSDictionary dictionaryWithObjectsAndKeys:[UIColor greenColor], NSForegroundColorAttributeName, nil]
                                         forState:UIControlStateNormal];

// set selected and unselected icons
UITabBarItem *item0 = [self.tabBar.items objectAtIndex:0];

// this way, the icon gets rendered as it is (thus, it needs to be green in this example)
item0.image = [[UIImage imageNamed:@"unselected-icon.png"] imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal];

// this icon is used for selected tab and it will get tinted as defined in self.tabBar.tintColor
item0.selectedImage = [UIImage imageNamed:@"selected-icon.png"]; 
```

如果仅在故事板中设置图标，则只能控制所选选项卡的颜色（tintColor）。所有其他图标和相应的文本将以灰色绘制。

也许有人知道在 iOS 7 下采用颜色的更简单方法？

* * *

## 回答 #3

> 赞同：71
> 
> 时间：2014-06-08T13:29:43.910

扩展@Sven Tiffe 对 iOS 7 的回答，您可以让您的代码自动为故事板中添加的未选择的 UITabBar 图像着色。以下方法将使您不必创建两组图标图像（即选中与未选中）并且必须以编程方式加载它们。添加类别方法 imageWithColor:（请参阅 -[我如何在 iOS 和 WatchKit 中更改图像 tintColor](https://stackoverflow.com/questions/19274789/change-image-tintcolor-in-ios7)）到您的项目然后将以下内容放入您的自定义 UITabBarController viewDidLoad 方法中：

```
// set the selected colors
[self.tabBar setTintColor:[UIColor whiteColor]];
[[UITabBarItem appearance] setTitleTextAttributes:[NSDictionary dictionaryWithObjectsAndKeys: [UIColor whiteColor], NSForegroundColorAttributeName, nil] forState:UIControlStateSelected];

UIColor * unselectedColor = [UIColor colorWithRed:184/255.0f green:224/255.0f blue:242/255.0f alpha:1.0f];

// set color of unselected text
[[UITabBarItem appearance] setTitleTextAttributes:[NSDictionary dictionaryWithObjectsAndKeys:unselectedColor, NSForegroundColorAttributeName, nil]
                                         forState:UIControlStateNormal];

// generate a tinted unselected image based on image passed via the storyboard
for(UITabBarItem *item in self.tabBar.items) {
    // use the UIImage category code for the imageWithColor: method
    item.image = [[item.selectedImage imageWithColor:unselectedColor] imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal];
} 
```

在 UIImage+Overlay.m 上创建一个名为 UIImage+Overlay 的类别（摘自[此答案](https://stackoverflow.com/a/19275079/2347363) ）：

```
@implementation UIImage(Overlay)

- (UIImage *)imageWithColor:(UIColor *)color1
{
        UIGraphicsBeginImageContextWithOptions(self.size, NO, self.scale);
        CGContextRef context = UIGraphicsGetCurrentContext();
        CGContextTranslateCTM(context, 0, self.size.height);
        CGContextScaleCTM(context, 1.0, -1.0);
        CGContextSetBlendMode(context, kCGBlendModeNormal);
        CGRect rect = CGRectMake(0, 0, self.size.width, self.size.height);
        CGContextClipToMask(context, rect, self.CGImage);
        [color1 setFill];
        CGContextFillRect(context, rect);
        UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();
        return newImage;
}
@end 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2012-07-16T21:32:07.090

SO说我不能删除接受的答案（我试过），但显然，有很多评论认为这不适用于iOS 7。

请参阅下面的其他答案以及更多赞成票，或@Liam 对此答案的评论中的链接。

* * *

*仅适用于 iOS 6*

它应该像这样简单：

```
[[UITabBar appearance] setTintColor:[UIColor grayColor]]; // for unselected items that are gray
[[UITabBar appearance] setSelectedImageTintColor:[UIColor greenColor]]; // for selected items that are green 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2017-08-01T13:23:16.447

iOS 10 及更高版本中的 Swift 版本 -

```
UITabBar.appearance().tintColor = UIColor.gray
UITabBar.appearance().unselectedItemTintColor = UIColor.gray 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2015-10-17T00:29:18.717

翻译 user3719695 对 Swift 的回答，现在使用扩展：

**UIImage+Overlay.swift**

```
extension UIImage {
  func imageWithColor(color1: UIColor) -> UIImage {
    UIGraphicsBeginImageContextWithOptions(self.size, false, self.scale)
    color1.setFill()

    let context = UIGraphicsGetCurrentContext()
    CGContextTranslateCTM(context, 0, self.size.height)
    CGContextScaleCTM(context, 1.0, -1.0);
    CGContextSetBlendMode(context, CGBlendMode.Normal)

    let rect = CGRectMake(0, 0, self.size.width, self.size.height) as CGRect
    CGContextClipToMask(context, rect, self.CGImage)
    CGContextFillRect(context, rect)

    let newImage = UIGraphicsGetImageFromCurrentImageContext() as UIImage
    UIGraphicsEndImageContext()

    return newImage
  }
} 
```

**customTabBar.swift**

```
override func viewDidLoad() {
  super.viewDidLoad()
  for item in self.tabBar.items! {
    item.image = item.selectedImage?.imageWithColor(unselectedColor).imageWithRenderingMode(UIImageRenderingMode.AlwaysOriginal)
    //In case you wish to change the font color as well
    let attributes = [NSForegroundColorAttributeName: unselectedColor]
    item.setTitleTextAttributes(attributes, forState: UIControlState.Normal)
  }
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-08-06T03:41:23.473

我不得不将代码移入`viewWillAppear`，因为`viewDidLoad`尚未设置图像。

**斯威夫特 4 翻译**

```
import Foundation
import UIKit

extension UIImage {
    func with(color: UIColor) -> UIImage {
        guard let cgImage = self.cgImage else {
            return self
        }
        UIGraphicsBeginImageContextWithOptions(size, false, scale)
        let context = UIGraphicsGetCurrentContext()!
        context.translateBy(x: 0, y: size.height)
        context.scaleBy(x: 1.0, y: -1.0)
        context.setBlendMode(.normal)
        let imageRect = CGRect(x: 0, y: 0, width: size.width, height: size.height)
        context.clip(to: imageRect, mask: cgImage)
        color.setFill()
        context.fill(imageRect)
        let newImage = UIGraphicsGetImageFromCurrentImageContext()!
        UIGraphicsEndImageContext();
        return newImage
    }
}

class MYTabBarController: UITabBarController {

    let unselectedColor = UIColor(red: 108/255.0, green: 110/255.0, blue: 114/255.0, alpha: 1.0)
    let selectedColor = UIColor.blue()

    override func viewWillAppear(_ animated: Bool) {
        super.viewWillAppear(animated)

        // Unselected state colors
        for item in self.tabBar.items! {
            item.image = item.selectedImage!.with(color: unselectedColor).withRenderingMode(.alwaysOriginal)
        }
        UITabBarItem.appearance().setTitleTextAttributes([.foregroundColor : unselectedColor], for: .normal)

        // Selected state colors
        tabBar.tintColor = selectedColor
        UITabBarItem.appearance().setTitleTextAttributes([.foregroundColor : selectedColor], for: .selected)
    }
} 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2020-06-17T09:39:29.453

iOS 13 中有一个新的外观 API。要正确使用 Xcode 11.0 为标签栏项目的图标和文本着色，您可以像这样使用它：

```
 if #available(iOS 13.0, *)
     {
        let appearance = tabBar.standardAppearance
        appearance.stackedLayoutAppearance.normal.titleTextAttributes = [NSAttributedString.Key.foregroundColor: UIColor.black]
        appearance.stackedLayoutAppearance.selected.titleTextAttributes = [NSAttributedString.Key.foregroundColor: UIColor.blue]
        appearance.stackedLayoutAppearance.normal.iconColor = UIColor.black
        appearance.stackedLayoutAppearance.selected.iconColor = UIColor.blue
        tabBar.standardAppearance = appearance
    } 
    else 
    {
        tabBar.unselectedItemTintColor = UIColor.black
        tabBar.tintColor = UIColor.blue
    } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-10-29T05:11:27.953

从 iOS 10+ 开始，以编程方式执行此操作的新方法是使用[`unselectedItemTintColor`](https://developer.apple.com/reference/uikit/uitabbar/1648949-unselecteditemtintcolor)API。例如，如果您在 中初始化了标签栏控制器`AppDelegate`，它将如下所示：

```
 func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -> Bool {
        ...

        let firstViewController = VC1()
        let secondViewController = VC2()
        let thirdViewController = VC3()

        let tabBarCtrl = UITabBarController()
        tabBarCtrl.viewControllers = [firstViewController, secondViewController, thirdViewController]

        // set the color of the active tab
        tabBarCtrl.tabBar.tintColor = UIColor.white

        // set the color of the inactive tabs
        tabBarCtrl.tabBar.unselectedItemTintColor = UIColor.gray

        ...
    } 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-12-26T10:52:50.537

或者只是*不编码*。**斯威夫特 4**，**Xcode 10.1**。

1.  **使用Interface Builder**添加`UITabBar`您的视图控制器。
***   在左侧面板中选择添加的视图。*   键入`cmd + alt + 3`或单击`Show the Identity Inspector`右侧面板。*   在部分`User Defined Runtime Attributes`中单击**加号**按钮以添加新属性并将其称为`unselectedItemTintColor`（参见[此处](https://developer.apple.com/documentation/uikit/uitabbar/1648949-unselecteditemtintcolor)）。*   不离开上一步中的部分（参见第 4 步），在`Type`选择`Color`类型列下。*   最后，在部分下设置必要的颜色`Value`。*   编译你的项目*   超过。恭喜。**

 **[![在此处输入图像描述](../Images/576ec1ec342caef19d3e2c267ae03ceb.png)](https://i.stack.imgur.com/j7GYt.png)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-04-10T07:52:14.790

参考这里的答案：[iOS 7中的UITabBar tint](https://stackoverflow.com/questions/19231074/uitabbar-tint-in-ios-7)

您可以为选定和未选定的标签栏按钮设置色调颜色，如下所示：

```
[[UIView appearanceWhenContainedIn:[UITabBar class], nil] setTintColor:[UIColor redColor]];
[[UITabBar appearance] setSelectedImageTintColor:[UIColor greenColor]]; 
```

第一行通过设置 UIView 包含在选项卡栏中时的 tintColor 来设置未选择的颜色（在此示例中为红色）。请注意，这仅设置未选择图像的色调颜色 - 它不会更改其下方文本的颜色。

第二行将选项卡栏的选定图像色调设置为绿色。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-11-15T14:26:40.937

Swift 4 版本（没有隐式展开 Optionals）：

**UIImage+Overlay.swift**

```
import UIKit

extension UIImage {
    func with(color: UIColor) -> UIImage? {
        guard let cgImage = self.cgImage else {
            return self
        }
        UIGraphicsBeginImageContextWithOptions(size, false, scale)
        if let context = UIGraphicsGetCurrentContext() {
            context.translateBy(x: 0, y: size.height)
            context.scaleBy(x: 1.0, y: -1.0)
            context.setBlendMode(.normal)
            let imageRect = CGRect(x: 0, y: 0, width: size.width, height: size.height)
            context.clip(to: imageRect, mask: cgImage)
            color.setFill()
            context.fill(imageRect)
            if let newImage = UIGraphicsGetImageFromCurrentImageContext() {
                UIGraphicsEndImageContext();
                return newImage
            }
        }
        return nil;
    }
} 
```

**CustomTabBarController.swift**

```
class CustomTabBarController: UITabBarController {

    override func viewDidLoad() {
        super.viewDidLoad()

        if #available(iOS 10.0, *) {
            self.tabBar.unselectedItemTintColor = UIColor.init(white: 1, alpha: 0.5)
        } else {
            // Fallback on earlier versions
            if let items = self.tabBar.items {
                let unselectedColor = UIColor.init(white: 1, alpha: 0.5)
                let selectedColor = UIColor.white
                // Unselected state colors
                for item in items {
                    if let selectedImage = item.selectedImage?.with(color: unselectedColor)?.withRenderingMode(.alwaysOriginal) {
                        item.image = selectedImage
                    }
                }
                UITabBarItem.appearance().setTitleTextAttributes([NSAttributedStringKey.foregroundColor : unselectedColor], for: .normal)

                // Selected state colors
                tabBar.tintColor = selectedColor
                UITabBarItem.appearance().setTitleTextAttributes([NSAttributedStringKey.foregroundColor : selectedColor], for: .selected)
            }
        }

        UITabBarItem.appearance().setTitleTextAttributes([NSAttributedStringKey.font: UIFont(name: "overpass-light", size: 12)!, NSAttributedStringKey.foregroundColor: UIColor.white], for: UIControlState.normal)
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-09-06T12:18:08.463

@JoeGalid 的`imageWithColor:`Xamarin 解决方案：

```
using CoreGraphics;
using UIKit;

namespace Example
{
    public static class UIImageExtensions
    {
        public static UIImage ImageWithColor(this UIImage image, UIColor color)
        {
            UIGraphics.BeginImageContextWithOptions(image.Size, false, image.CurrentScale);

            color.SetFill();

            var context = UIGraphics.GetCurrentContext();

            context.TranslateCTM(0, image.Size.Height);
            context.ScaleCTM(1.0f, -1.0f);
            context.SetBlendMode(CoreGraphics.CGBlendMode.Normal);

            var rect = new CGRect(0, 0, image.Size.Width, image.Size.Height);
            context.ClipToMask(rect, image.CGImage);
            context.FillRect(rect);

            var newImage = UIGraphics.GetImageFromCurrentImageContext() as UIImage;
            UIGraphics.EndImageContext();

            return newImage;
        }
    }
} 
```

然后在设置标签栏项目时使用它：

```
var image = UIImage.FromBundle("name");
barItem.Image = image.ImageWithColor(UIColor.Gray).ImageWithRenderingMode(UIImageRenderingMode.AlwaysOriginal);
barItem.SelectedImage = image.ImageWithColor(UIColor.Red).ImageWithRenderingMode(UIImageRenderingMode.AlwaysOriginal) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-02-20T19:22:02.697

使用swift未选择标签栏的颜色

1.  获取 TabBarViewController 的参考
2.  使用以下代码。

    ```
     [You tabbar controller name]?.tabBar.unselectedItemTintColor = [color name here] 
    ```

希望它会有所帮助。**

# java - 登录网页具有隐藏的令牌，在提交表单时会在 POST 中发送。如何在 Java HttpPost 中使用令牌？

> ID：11512787
> 
> 赞同：1
> 
> 时间：2012-07-16T21:24:15.873
> 
> 标签：java, httpclient

所以这个网站有一个登录表单。我想登录然后下载文件。提交表单时，不仅用户名和密码会在 http POST 中传输，还会在隐藏`<input>`标签中传输一个令牌。现在，我的问题是，每当我在 java 中打开 URL 并获取令牌以进行 POST 时，当我使用`HttpClient`. 我不知何故需要使用同一个客户端来调用网站以获取令牌并发布帖子。不幸的是，我在尝试访问文件时收到 403 FORBIDDEN 返回码。这是我到目前为止所拥有的：

```
public static void main(String[] args){

    try {
        String token = getTokenFromPage("http://my.url");   

        HttpContext context = new BasicHttpContext();   
        DefaultHttpClient client = new DefaultHttpClient();         

        List <NameValuePair> parameters = new ArrayList <NameValuePair>();
        HttpPost post = new HttpPost("http://my.url");
        parameters.add(new BasicNameValuePair("username", "MYNAME"));
        parameters.add(new BasicNameValuePair("password", "MYPW"));
        parameters.add(new BasicNameValuePair("token", token));

        UrlEncodedFormEntity entity = new UrlEncodedFormEntity(parameters, HTTP.UTF_8);
        post.setEntity(entity); 

        System.out.println("URL: " + post.getURI());
        HttpResponse postResponse = client.execute(post, context);
        System.out.println(postResponse.getStatusLine());
        EntityUtils.consume(postResponse.getEntity());
//Now download the file

        HttpGet httpget = new HttpGet("http://url.to.file");

        HttpResponse getResponse = client.execute(httpget, context);

        System.out.println(getResponse.toString());

        System.out.print((postResponse.getEntity().getContent()));
        client.getConnectionManager().shutdown();

    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:33:00.357

您将不得不对登录页面发出 HTTP 请求，解析 HTTP 响应流中生成的 HTML，并从那里获取要使用的令牌值。建议使用像[jsoup](http://jsoup.org "汤")这样的库来解析 HTML。

# sencha-touch-2 - 如何在 Sencha Touch 2 中制作搜索列表？商店已经定义

> ID：11512790
> 
> 赞同：0
> 
> 时间：2012-07-16T21:24:23.380
> 
> 标签：sencha-touch-2

嗨 stackoverflow 社区，

是的，我知道，其他人也有同样的问题，但他们在同一个文件中定义了商店，sencha touch 2 的示例对我有用，但是当我尝试将此代码应用于我的时，我收到此错误：

> Uncaught SyntaxError: Unexpected identifier Alertas.js:105 Uncaught Error: 以下类即使文件已加载也未声明：'myMoney.view.Alertas'。请检查其相应文件的源代码是否存在拼写错误：'app/view/Alertas.js

我认为我需要以另一种方式给我的商店打电话，但这是我的问题：

**如何调用已为搜索列表定义的商店？**

有我的代码：

```
Ext.define('myMoney.view.Alertas',{
extend: 'Ext.navigation.View',
fullscreen: true,
scrollable: true,
styleHtmlContent: true,
xtype: 'alertas',

config: {
    title: 'Contactos',
    iconCls: 'bookmarks',

    items: [
        {
            xtype: 'list',
            grouped: true,
            ui: 'round',
            title: 'Contactos',
            fullscreen: true,
            itemTpl: '{title}',
            styleHtmlCls: true,
            //cls: 'x-contacts',
            store: 'Contactos',
            itemTpl: [
                '<div class="headshot" style="background-image:url(resources/images/headshots/{headshot});"></div>',
                '{firstName} {lastName}',
                '<span>{title}</span>'
            ].join(''),

            items: [
                {
                    xtype: 'searchfield',
                    placeHolder: 'Buscar contacto...',
                    listeners: {
                        scope: this,
                        clearicontap: this.onSearchClearIconTap,
                        keyup: this.onSearchKeyUp
                    }
                },
            ]
        },
    ]
},

/**
 * Llamado cuando la barra de busqueda tiene un evento keyup
 */
onSearchKeyUp: function(field) {
    //Se obtiene el store y el valor del field
    var value = field.getValue(),
        //store = this.getStore();
            //NOW:
            store = Ext.data.StoreManager.lookup('Contactos');

    //se limpian los filtros actuales del store para comenzar la nueva busqueda
    store.clearFilter();

    //Verificamos que el valor tenga alguna  modificacion
    if (value) {
        //El usuario pudo haber introducido espacion en blanco,asi que los cortamos para poder recorrer todo el valor 
        var searches = value.split(' '),
            regexps = [],
            i;

        //recorremos todo el valor
        for (i = 0; i < searches.length; i++) {
            //si no hay nada continuamos
            if (!searches[i]) continue;

            //Si encontramos algo creamos una expresion regular que es sensible a mayusculas
            regexps.push(new RegExp(searches[i], 'i'));
        }

        //Ahora se filtra el store
        //El metodo se pasara a cada record en el store
        store.filter(function(record) {
            var matched = [];

            //Iteramos a traves de cada expresion regular
            for (i = 0; i < regexps.length; i++) {
                var search = regexps[i],
                    didMatch = record.get('firstName').match(search) || record.get('lastName').match(search);

                //Si coincide el primer o ultimo nombre se coloca en la lista de los que coinciden
                matched.push(didMatch);
            }

            //Si nada se consigue no se retorna nada
            if (regexps.length > 1 && matched.indexOf(false) != -1) {
                return false;
            } else {
                //Si no se muestra lo que se encontro
                return matched[0];
            }
        });
    }
},
/**
 * Llamado cuando el usuario presiona el icono de 'x' en la barra de busqueda
 * Solo que quitan los filtros del store
 */
onSearchClearIconTap: function() {
    //this.getStore().clearFilter();
        //NOW:
        store = Ext.data.StoreManager.lookup('Contactos');
}
/**
 * Metodo llamado para tomar el store
 */
      //I DELETE THIS FUNCTION
/*getStore: function() {
        this.store = 'myMoney.store.Contactos'*/
}
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T15:33:50.267

您需要使用 Ext.StoreManager，以便通过 id 使用指定的商店。

例子：

与这家商店：

```
Ext.create('Ext.data.Store', {
    model: 'SomeModel',
    storeId: 'myStore'
}); 
```

利用

```
var store = Ext.data.StoreManager.lookup('myStore'); 
```

或在视图中使用它：

```
Ext.create('Ext.view.View', {
    store: 'myStore',
    // other configuration here
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T09:38:21.860

请小心吸气剂:)

```
getStore: function() {
        this.store = 'myMoney.store.Contactos'
} 
```

我认为它打算返回商店，而不仅仅是分配给班级成员。

```
onSearchKeyUp: function(field) {
    //Se obtiene el store y el valor del field
    var value = field.getValue(),
        store = this.getStore();  // undefined 
```

变量*存储*始终未定义...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-03T09:21:54.290

以上 NeoMorfeo 代码是唯一正确的获取商店价值

您需要使用 Ext.StoreManager，以便通过 id 使用指定的商店。

例子：

与这家商店：

```
Ext.create('Ext.data.Store', {
    model: 'SomeModel',
    storeId: 'myStore'
}); 
```

利用

```
var store =  Ext.getStore('myStore'); 
```

或在视图中使用它：

```
Ext.create('Ext.view.View', {
    store: 'myStore',
    // other configuration here
}); 
```

# ruby - NoMethodError：“一些刺痛”的未定义方法`+@'：字符串

> ID：11512793
> 
> 赞同：3
> 
> 时间：2012-07-16T21:24:37.333
> 
> 标签：ruby

我的 Rails 应用程序今天才开始收到此错误。这是代码上下文。它在以开头的行抛出错误`new_host_id`

```
while @host_ids.include?(new_host_id)
  i++
  new_host_id = duplicate_host_id + i.to_s
end 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T21:31:21.923

Ruby 没有*运算*符`++`。

Ruby 中的成语`i += 1`是 . 的缩写形式`i = i + 1`。

* * *

最初我认为发布的代码不正确，必须`++i`生成该错误。然而，正如 Jörg W Mittag 在评论中解释的那样，情况并非如此：

> [..] Ruby 允许在运算符和操作数之间使用空格（包括换行符），因此整个事情被解释为`i + (+(new_host_id = duplicate_host_id + i.to_s))`[.. 这就是为什么 NoMethodError 指的是字符串。

这是一个显示问题的简化示例（发布的代码是指第一种情况）：

```
> x =“你好”
> +x
"hello" 的未定义方法 `+@':String (NoMethodError)
> x+
语法错误，意外 $end

```

我使用`+`and not `++`above 来简化示例：Ruby 将`++i`and`i++`视为产品`+(+i)`和 [大致] `i+(+)`..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T21:24:37.333

原来错误是由上一行引起的`i++`

我改成现在它正在工作`i++`。`i = i + 1`

这是工作代码

```
while @host_ids.include?(new_host_id)
  i = i + 1
  new_host_id = duplicate_host_id + i.to_s
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T23:10:02.987

如果您有警告，您可能会收到关于该行的警告。

```
$VERBOSE = true
def foo
  i = 2
  i++
  j = 5
  j + i
end

warning: possibly useless use of + in void context 
```

# c++ - “忽略未知选项 /NODEFAULTLIB:LIBCMTD”

> ID：11512795
> 
> 赞同：2
> 
> 时间：2012-07-16T21:24:40.433
> 
> 标签：c++, visual-studio-2008, libcmtd

仍然在经历[这里](https://stackoverflow.com/questions/11478887/unresolved-externals-nightmare)详述的主要编译，但我有一个关于使用 /NODEFAULTLIB 的具体问题。

我一直在尝试使用此 /NODEFAULTLIB:LIBCMTD 开关来解决链接器问题，其中解决方案中的一个项目使用 /MTd (LIBCMTD.LIB) 而不是 /MDd MSVCR90D.DLL。

不幸的是，正如您可能从这篇文章的标题中猜到的那样，我似乎没有正确使用它。在构建解决方案时，我在三个地方看到了这个警告：

`1>cl : Command line warning D9002 : ignoring unknown option '/NODEFAULTLIB:LIBCMTD'`

我在 Windows XP Professional SP3 上运行 Visual Studio 2008 Standard SP1。我通过右键单击麻烦的项目，选择属性，展开“配置属性”，展开 C/C++ 列表，选择“命令行”，并在“附加选项”中输入 /NODEFAULTLIB:LIBCMTD 来添加此开关场地。

我在网上其他地方读到这应该是链接器设置，而不是 C/C++ 设置，所以我也尝试在配置属性->构建事件->预链接事件->命令行下输入它，不过这给了我自己的警告，而没有从编译中产生任何不同的结果：

`1>The filename, directory name, or volume label syntax is incorrect. 1>Project : error PRJ0019: A tool returned an error code from "Performing Pre-Link Event..."`

所以伙计们......我在这里不理解 /NODEFAULTLIB 开关怎么样？如何让 VS2008 识别命令并停止忽略它？

谢谢，-亚历克斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T21:45:29.277

在项目属性中，您将找到：配置属性 -> 链接器 -> 输入 ->

```
 'Ignore All Default Libraries'
 'Ignore Specific Default Libraries' <-- this is I suppose of interest for you 
```

您可以尝试将 libc;libcmtd;libcd 放在那里，但我从未尝试过，在相同配置下编译所有库是正确的方法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T22:18:50.710

[此处](https://docs.microsoft.com/en-us/cpp/build/reference/nodefaultlib-ignore-libraries?view=msvc-160)记录了此选项。从表面上看，现在您在链接器页面而不是 C++ 页面上使用它，您似乎正在正确使用它，但我*怀疑*可能缺少的是您需要包含`.lib`在文件名中，例如：

```
/NODEFAULTLIB:LIBCMTD.LIB 
```

我认为，如果您删除此选项并查看您得到的链接器错误，那么它将告诉您您需要的确切语法。更好的解决方案是查看该项目中的所有单独的库和 dll，并找出哪些正在使用其他运行时库。最好解决问题的根源，而不是稍后解决它。

# ruby-on-rails - 基于新模型的 Rails 下拉菜单

> ID：11512802
> 
> 赞同：1
> 
> 时间：2012-07-16T21:25:25.513
> 
> 标签：ruby-on-rails, drop-down-menu, html-select

这几天我一直在努力解决这个问题，但什么也做不了。我一直在根据 Michael Hartl 的精彩教程构建我的第一个应用程序：[http](http://ruby.railstutorial.org/) ://ruby.railstutorial.org/ 。此外，我已经尝试过本[教程](http://agilewarrior.wordpress.com/2011/09/30/how-to-add-a-drop-down-resource-to-an-existing-rails-model/)，但我的代码和他的代码之间的差异对我来说太大了，无法遵循。

我的应用程序与 Michael Hurtl 的不同之处在于，我正在尝试创建一个网站，您可以在其中发布剩余的油漆罐（而不是微博，AKA twitter）。当我创建应用程序时，我在 Paints 模型中有一个名为“color_family”的列。现在我希望将其从文本字段更改为具有预定值的下拉列表，例如“红色”、“橙色”、“黄色”、“绿色”等。

我从生成一个新的脚手架开始：

```
rails generate scaffold Color_Family family:string 
```

然后我生成了一个迁移：

```
rails generate migration AddColor_FamilyToPaints family_id:int 
```

并将其全部迁移。

然后我创建了关联

```
class ColorFamily < ActiveRecord::Base
    has_many :paints
end 
```

和

```
class Paint < ActiveRecord::Base
    attr_accessible :family_id, :name, :hex, :location, :quantity, :additional_info
    belongs_to :user
    belongs_to :color_family
    ...
end 
```

这就是我迷路的地方，我尝试遵循的任何教程都会破坏一切。我在哪里定义我预先确定的 color_families 列表？

对我来说，创建一个新模型是否值得？我之前在表单字段中尝试过：

```
<%= form_for(@paint) do |f| %>
<%= render 'shared/error_messages', object: f.object %>
<div class="field">
    <%= f.label :color_family %>
    <%= select_tag(:color_family, options_for_select([['Red', 1],
                                                        ['Orange', 2], 
                                                        ['Yellow', 3], 
                                                        ['Green', 4], 
                                                        ['Blue', 5], 
                                                        ['Purple', 6], 
                                                        ['Black', 7], 
                                                        ['Grey', 8], 
                                                        ['White', 9], 
                                                        ['Cream', 10],
                                                        ['Brown', 12]])) %> 
```

虽然它为我创建了一个下拉列表，但当我添加新油漆时它从未捕获过信息。

任何帮助是极大的赞赏。此外，一个教程的链接可能会给我最大的帮助，因为我对 RoR 和后端的东西很陌生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:37:46.553

我不确定你是在做这本书的阅读版，还是视频。就个人而言，我推荐两者！绝对精彩的教程！不过，他确实提到的第一件事是，“脚手架并不是真正适合现实世界的”，您应该考虑这一点。当我在做项目时，新旧项目或只是重构，我通常使用脚本/生成手动添加所有内容。我曾经使用过的唯一“脚手架”是scaffold_controller，因为我懒得手工制作控制器。

简短的回答，你应该有另一个模型“颜色”，表格应该：

```
f.collection_select(:color_id, Color.find(:all), :id, :name, {:include_blank => 'Please Select A Color'}) 
```

而 ColorFamily 应该是 has_many_and_belongs_to_many 颜色

如果你能给我一些应该发生的细节关联，我可以为你写一个小数据模式。

* * *

**编辑#1**

你需要一个 has_one :through 关系。一般概念将是...

*数据透视表：*

```
rails g migration ColorFamilyPaints paint_id:integer color_family_id:integer 
```

*油漆类：*

```
class Paint < ActiveRecord::Base
    attr_accessible :family_id, :name, :hex, :location, :quantity, :additional_info,
                    :color_families_attributes # Need to add this in order for you to be able to post with drop down
    belongs_to :user
    ...
    # Creates the Relationship
    has_one :color_families, :through => :color_family_paints

    # Allows color families to be nested in the form.
    accepts_nested_attributes_for :color_families, :allow_destroy => true
end 
```

你会注意到一些变化。除了 attr_accessible 和accepts_nested_attributes_for（你可能需要这个，但不确定是否有has_one）。构建表单时，请查看选择框的 ID/名称。如果它以 _attributes 结尾，请使用接受行。如果没有，你不需要它。更改 :color_families_attributes 以匹配选择框的名称。

*表单 HTML：*

```
<%= form_for(@paint) do |f| %>
    <%= render 'shared/error_messages', object: f.object %>
    <div class="field">
        <%= f.label :color_family %>
        <%= f.collection_select(:color_family, ColorFamily.find(:all), :id, :name, {:include_blank => 'Please Select Color Family'}) %>
    </div>
<% end %> 
```

[有关协会@ RoR 网站的更多信息。](http://guides.rubyonrails.org/association_basics.html)

# facebook-graph-api - 由于 URL 大写，我的网页的总点赞数显示不正确

> ID：11512804
> 
> 赞同：1
> 
> 时间：2012-07-16T21:25:30.197
> 
> 标签：facebook-graph-api, facebook-like

在意识到我的网站不包含 og 标签并且我错过了一些关键的统计信息后，我迅速在每篇文章中添加了以下标签：

*   OG：站点名称
*   og：类型（文章）
*   OG：描述
*   OG：网址
*   OG：标题
*   OG：图像
*   FB:app_id

我还实现了最新的like 按钮（like + 在发布到 fb 之前添加描述的能力）。我正在使用按钮的 iframe 版本。

示例网址：http://www.rocksquare.com/Community/FeaturedArtists/692

**原点赞数：526**

[http://graph.facebook.com/http://www.rocksquare.com/Community/FeaturedArtists/692](http://graph.facebook.com/http://www.rocksquare.com/Community/FeaturedArtists/692)

"id": "http://www.rocksquare.com/Community/FeaturedArtists/692", "shares": 526

**当前 LIKE 数：60（从 7/13 到现在）**

[http://graph.facebook.com/http://www.RockSquare.com/Community/FeaturedArtists/692](http://graph.facebook.com/http://www.RockSquare.com/Community/FeaturedArtists/692)

“id”：“http://www.RockSquare.com/Community/FeaturedArtists/692”，“分享”：60

**应该是：586 个赞**

如果您仔细查看 URL，您会注意到 URL 的写法不同。一个是 RockSquare.com，另一个是 rocksquare.com。出于某种原因，facebook 图可以区分并创建了两个实体。一个有 562 股，一个有 60 股。无论如何我们可以将这两者结合起来吗？

**当前OG信息**

```
<meta property="og:type" content="article"></meta>    

<meta property="og:url" content="http://www.RockSquare.com/Community/FeaturedArtists/692"></meta>

<meta property="og:title" content="Marillion: Inside the making of “Sounds That Can’t Be Made”"></meta>

<meta property="og:description" content="When a band names its new album Sounds that Can’t Be Made, you’d be forgiven for wondering what on earth it sounds like—or if it sounds like anything on Earth."></meta>

<meta property="og:image" content="http://secure.rocksquare.com/RockSquareResources/CommunityArticleFiles/cmart_img_660x305_ddd3a82a-f7df-41d9-9d54-358d065ca6b5.png"></meta>

<meta property="fb:app_id" content="268121463293096" /> 
```

# sql - 将递归限制到某个级别 - 重复行

> ID：11512805
> 
> 赞同：2
> 
> 时间：2012-07-16T21:25:37.950
> 
> 标签：sql, sql-server, sql-server-2008, recursion

首先，这不是我的另一个同名问题的重复，我只是想不出一个更好的名字！

我有一个名为 Player 的 SQL 表和另一个名为 Unit 的 SQL 表。

*   每个玩家必须通过外键 UnitID 属于一个团队。
*   每个单元可以通过递归字段 ParentUnitID 属于另一个团队。
*   ParentUnit 可以是 ParentUnit（无限递归），但 Player 只能属于一个 Team。
*   一个单元可能有很多孩子

所以它可能是（自上而下）......

*   TeamA（是顶级）
*   TeamB (属于^^)
*   TeamC (属于^^)
*   TeamD (属于^^)
*   Player_1 (属于^^)

我的问题是，如果给我一个 Player's PlayerID（该表的 PK），那么获得特定团队的最佳方法是什么？

有关数据、结构和查询，请参阅我的 SQLFiddle：[http ://sqlfiddle.com/#!3/78965/3](http://sqlfiddle.com/#!3/78965/3)

使用我的数据（来自小提琴），我希望能够让每个玩家都在“TeamB”之下，但是“Player4”的顶级单位应该是“TeamC”。为此，我只想传入 PlayerID 和“TeamB”的 ID。所以我的意思是“让 TeamB 下的所有玩家和顶级单位，然后过滤掉除 Player4 之外的所有玩家。

*编辑：我相信上面的段落应该是：* ***使用我的数据（来自小提琴），我希望能够建立在“TeamB”之下比赛的顶级球队。然后，对于“TeamB”以下的每个顶级球队，我想建立所有为该球队效力或低于该球队的球员。然后，我希望能够将玩家列表限制为一个或多个特定玩家。***

正如您在 SQLFiddle 中看到的那样，我为每个玩家返回了多行，我确定这是一个快速修复，但我无法弄清楚......这就是我在小提琴中想要的，但它是，好吧，呃，有点繁琐... :)

编辑：更多信息：

好的，所以如果想象这是一个存储过程。

*   我传入 PlayerIDs 1,2,3,4
*   我传入 UnitID 2

我希望返回的数据看起来像

```
Player3, TeamC 
```

仅返回 Player3，因为它是 TeamB (ID 2) 的唯一后代玩家，返回 TeamC，因为它是 Player3 所属的最高级别单元 (UnitID 2 以下)。

如果我改为通过：

*   我传入 PlayerIDs 1,2,3,4
*   我传入 UnitID 6

我希望

```
Player1, Team2
Player2, Team2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:36:09.483

```
with UnitCTE as (
  select UnitID,
         Designation,
         ParentUnitID as ParentUnitID,
         cast(null as varchar(50)) as ParentUnitDesignation,
         UnitID TopUnitID,
         Designation TopUnitDesignation,
         1 as TeamLevel
    from Unit
   where ParentUnitID is null
  union all
  select t.UnitID,
         t.Designation,
         c.UnitID,
         c.Designation,
         c.TopUnitID,
         c.TopUnitDesignation,
         TeamLevel+1 as TeamLevel
    from Unit t
    join UnitCTE c
      on t.ParentUnitID = c.UnitID
      --WHERE t.UnitID = 1
),
x AS (
select Player.PlayerID,
       pDesignation = Player.Designation, t1.*,
       rn = ROW_NUMBER() OVER (PARTITION BY Player.PlayerID ORDER BY Player.Designation)
  from Player
  join UnitCTE t1
    on Player.UnitID = t1.UnitID
  join UnitCTE t2
    on t1.TopUnitID = t2.TopUnitID
   and t2.TeamLevel=2
)
SELECT * FROM x
WHERE rn = 1
   ORDER BY TeamLevel 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T22:41:09.343

***这个答案已被完全重写。原版在所有情况下都无法正常工作***

我必须更改 CTE 以将每个单元的完整单元层次结构表示为可能的根（顶部单元）。它允许一个真正的层次结构，每个单元有多个子级。

我扩展了此[SQL Fiddle](http://sqlfiddle.com/#!3/87ccf/2)中的示例数据，将一名球员分配给了第 11 和第 12 单元。它正确地为在第 1 单元下方某个级别上为某个单位效力的 3 名球员中的每一位返回正确的行。

“根”单元 ID 和玩家 ID 列表方便地位于底部最外层的 WHERE 子句中，可以根据需要轻松更改 ID。

```
with UnitCTE as (
  select u.UnitID,
         u.Designation UnitDesignation,
         u.ParentUnitID as ParentUnitID,
         p.Designation as ParentUnitDesignation,
         u.UnitID TopUnitID,
         u.Designation TopUnitDesignation,
         1 as TeamLevel
    from Unit u
    left outer join Unit p
      on u.ParentUnitId = p.UnitID
  union all
  select t.UnitID,
         t.Designation UnitDesignation,
         c.UnitID as ParentUnitID,
         c.UnitDesignation as ParentUnitDesignation,
         c.TopUnitID,
         c.TopUnitDesignation,
         TeamLevel+1 as TeamLevel
    from Unit t
    join UnitCTE c
      on t.ParentUnitID = c.UnitID
)
select p.PlayerID,
       p.Designation,
       t1.*
  from UnitCTE t1
  join UnitCTE t2
    on t2.TopUnitID = t1.UnitID
   and t2.TopUnitID = t1.TopUnitID
  join Player p
    on p.UnitID = t2.UnitID
 where t1.ParentUnitID = 1
   and playerID in (1,2,3,4,5,6) 
```

这是一个略微优化的版本，它在 CTE 中嵌入了 Unit ID 标准。CTE 仅计算以父 ID 为所选单元 ID（在本例中为 1）的单元为根的层次结构

```
with UnitCTE as (
  select u.UnitID,
         u.Designation UnitDesignation,
         u.ParentUnitID as ParentUnitID,
         p.Designation as ParentUnitDesignation,
         u.UnitID TopUnitID,
         u.Designation TopUnitDesignation,
         1 as TeamLevel
    from Unit u
    left outer join Unit p
      on u.ParentUnitId = p.UnitID
   where u.ParentUnitID = 1
  union all
  select t.UnitID,
         t.Designation UnitDesignation,
         c.UnitID as ParentUnitID,
         c.UnitDesignation as ParentUnitDesignation,
         c.TopUnitID,
         c.TopUnitDesignation,
         TeamLevel+1 as TeamLevel
    from Unit t
    join UnitCTE c
      on t.ParentUnitID = c.UnitID
)
select p.PlayerID,
       p.Designation,
       t1.*
  from UnitCTE t1
  join UnitCTE t2
    on t2.TopUnitID = t1.UnitID
  join Player p
    on p.UnitID = t2.UnitID
 where playerID in (1,2,3,4,5,6) 
```

* * *

***这是我的原始答案。*** *它仅在单元层次结构被限制为每个单元只允许一个孩子时才有效。问题中的 SQL Fiddle 示例有 Unit 1 的 3 个子项，因此如果针对 Unit 1 运行，它会错误地为玩家 3、5 和 6 返回多行*

*这是一个演示问题的[SQL Fiddle](http://sqlfiddle.com/#!3/87ccf/6)。*

```
with UnitCTE as
  select UnitID,
         Designation UnitDesignation,
         ParentUnitID as ParentUnitID,
         cast(null as varchar(50)) as ParentUnitDesignation,
         UnitID TopUnitID,
         Designation TopUnitDesignation,
         1 as TeamLevel
    from Unit
   where ParentUnitID is null
  union all
  select t.UnitID,
         t.Designation UnitDesignation,
         c.UnitID,
         c.UnitDesignation,
         c.TopUnitID,
         c.TopUnitDesignation,
         TeamLevel+1 as TeamLevel
    from Unit t
    join UnitCTE c
      on t.ParentUnitID = c.UnitID
)
select p.PlayerID,
       p.Designation,
       t2.*
  from Player p
  join UnitCTE t1
    on p.UnitID = t1.UnitID
  join UnitCTE t2
    on t2.TopUnitID = t1.TopUnitID
   and t1.TeamLevel >= t2.TeamLevel
  join UnitCTE t3
    on t3.TopUnitID = t1.TopUnitID
   and t2.TeamLevel = t3.TeamLevel+1
 where t3.UnitID = 2
   and playerID in (1,2,3,4) 
```

# javascript - 什么是 JavaScript 代码库（或者可能只是一个片段），它为“标记”博客文章或其他项目提供干净的 UI？

> ID：11512814
> 
> 赞同：0
> 
> 时间：2012-07-16T21:26:16.530
> 
> 标签：javascript, code-snippets

什么是 JavaScript 代码库或片段，可以为我提供一个干净的界面来标记帖子或其他具有类别的项目？（类似于 stackoverflow 上用于标记问题的系统。）

我当然有能力自己编写代码，但如果已经有这样的东西，我不想重新发明轮子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:29:20.117

我喜欢[Select2](http://ivaynberg.github.com/select2/#tags)用于这种类型的小部件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:36:28.057

彼得斯的小费看起来很棒！如果您正在运行 jQuery UI，它们有一个自动完成小部件，它也可以解决您的问题。这篇博文包含一些不错的小部件：

[http://laurii.info/2011/04/10-jquery-tagging-widgets/](http://laurii.info/2011/04/10-jquery-tagging-widgets/)

# c# - 如何阻止 C# 控制台应用程序自动关闭？

> ID：11512821
> 
> 赞同：414
> 
> 时间：2012-07-16T21:26:32.667
> 
> 标签：c#, console-application

我在 Visual Studio 上的控制台应用程序会自动关闭，因此，我想使用 C 之类的东西`system("PAUSE")`在应用程序执行结束时“暂停”应用程序。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：624
> 
> 时间：2012-07-16T21:27:26.053

```
Console.ReadLine(); 
```

或者

```
Console.ReadKey(); 
```

[`ReadLine()`](http://www.google.at/url?sa=t&rct=j&q=msdn%20console.readline&source=web&cd=1&ved=0CF0QFjAA&url=http://msdn.microsoft.com/en-us/library/system.console.readline.aspx&ei=TYcEULiaJrP44QTu67yvCA&usg=AFQjCNFMXhCW9ehvUKRE3oSY4hDHnpeX8Q)等待`↩</kbd>, [`ReadKey()`](http://www.google.at/url?sa=t&rct=j&q=msdn%20console.readkey&source=web&cd=1&ved=0CFkQFjAA&url=http://msdn.microsoft.com/en-us/library/system.console.readkey.aspx&ei=f4cEUPfwCcOn4gTJrt2TCA&usg=AFQjCNEzY4-zX-qXR8RLKZW-9_xbT2uxxQ) waits for any key (except for modifier keys).`

*编辑：从达林那里偷了钥匙符号。*

* * *

## 回答 #2

> 赞同：205
> 
> 时间：2013-09-13T19:52:45.773

您可以使用`Ctrl`+编译（开始调试）您的工作`F5`。

尝试一下。我总是这样做，控制台会向我显示我的结果。不需要额外的代码。

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2014-08-05T15:00:38.227

尝试在 Visual Studio 中使用**Ctrl + F5**来运行您的程序，这将在没有任何 Console.Readline() 或 ReadKey() 函数的情况下自动添加“按任意键继续...”的暂停。

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2012-07-16T21:27:17.473

`Console.ReadLine()`等待用户`Enter`或`Console.ReadKey`等待任何键。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2012-07-16T21:27:50.460

采用：

```
Console.ReadKey(); 
```

当有人按下任何键时它会关闭，或者：

```
Console.ReadLine(); 
```

当用户输入内容并按下回车时。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2014-12-07T12:40:26.237

或者，您可以使用以下代码延迟关闭：

```
System.Threading.Thread.Sleep(1000); 
```

注意`Sleep`使用毫秒。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2015-07-02T09:18:53.883

Ctrl + F5 更好，因为您不需要额外的行。最后，您可以点击进入和退出运行模式。

但是，当您使用 F5 启动程序并设置断点时，您可以调试您的应用程序，这会给您带来其他优势。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2016-06-15T03:21:34.253

提到的这些解决方案会改变您的程序的工作方式。

您当然可以放置控制台调用`#if DEBUG`，`#endif`但如果您真的想阻止窗口仅在 Visual Studio 下的开发机器上关闭，或者如果 VS 仅在您明确配置它时才运行，并且您不想要`'Press any key to exit...'`从命令行运行时很烦人，要走的路是使用`System.Diagnostics.Debugger`API。

如果您只希望它在 中工作`DEBUG`，只需将此代码包装在一个`[Conditional("DEBUG")] void BreakConditional()`方法中。

```
// Test some configuration option or another
bool launch;
var env = Environment.GetEnvironmentVariable("LAUNCH_DEBUGGER_IF_NOT_ATTACHED");
if (!bool.TryParse(env, out launch))
    launch = false;

// Break either if a debugger is already attached, or if configured to launch
if (launch || Debugger.IsAttached) {
    if (Debugger.IsAttached || Debugger.Launch())
        Debugger.Break();
} 
```

这也适用于调试需要提升特权或需要能够提升自身的程序。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-03-24T13:53:00.957

如果您不希望程序关闭，即使用户按任意键；

```
 while (true) {
      System.Console.ReadKey();                
 };//This wont stop app 
```

# asp.net-mvc - 如何从 ActionLink 访问 id 参数？

> ID：11512822
> 
> 赞同：0
> 
> 时间：2012-07-16T21:26:52.757
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

问题是 id = 5 已经在 URL 中作为`http://localhost:4032/Category/5`. 但是要将该值传递给 ActionLink 似乎我必须这样做：

```
<td> @Html.ActionLink(p.ProdNo, "Main", "Home", new { id = 5, prodno = p.ProdNo }, null) </td> 
```

这会产生正确的 URL：`http://localhost:4032/Main/5/1097`

但不得不这样做似乎不太正确。我知道必须有一些聪明的方法来处理这个问题。不幸的是，现在已经很晚了，我已经不聪明了。

我试过这个：

```
<td> @Html.ActionLink(p.ProdNo, "Main", "Home", new {prodno = p.ProdNo }, null) </td> 
```

但最终以`http://localhost:4032/Main?prodno=1097`.

我尝试将参数添加到代码隐藏中的相应方法中，但这似乎也不起作用。

简而言之，当使用 ActionLink 时，如何获取 URL 中已有的路由值并传入另一个/新的路由值？

全球.asax

```
public static void RegisterRoutes(RouteCollection routes)
        {
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

            routes.MapRoute(
                "Sections", // Route name
                "{controller}/{action}/{id}/{prodno}/{instid}/{section}", // URL with parameters
                new { controller = "TestEdit", action = "Index", id = UrlParameter.Optional, prodno = UrlParameter.Optional, instid = UrlParameter.Optional, section = UrlParameter.Optional } // Parameter defaults
            );

            routes.MapRoute(
                "Pumps", // Route name
                "{controller}/{action}/{id}/{prodno}", // URL with parameters
                new { controller = "Home", action = "Main", id = UrlParameter.Optional, prodno = UrlParameter.Optional  } // Parameter defaults
            );

            routes.MapRoute(
                "Jobs", // Route name
                "{controller}/{action}/{id}", // URL with parameters
                new { controller = "Home", action = "Jobs", id = UrlParameter.Optional } // Parameter defaults
            );

            routes.MapRoute(
                "Default", // Route name
                "{controller}/{action}/{id}", // URL with parameters
                new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
            );

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:29:42.680

我认为您需要为您的 prodno 参数设置路线。看起来这个线程可能包含一个解决方案：

[使用 ASP.NET MVC 进行多参数路由](https://stackoverflow.com/questions/2246481/routing-with-multiple-parameters-using-asp-net-mvc)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T06:20:04.497

您可以从以下位置获取它`RouteData`：

```
@Html.ActionLink(
    p.ProdNo, 
    "Main", 
    "Home", 
    new { id = ViewContext.RouteData["id"], prodno = p.ProdNo }, 
    null
) 
```

# bash - Bash -- 如何执行语法：./myscript.sh *.dat？

> ID：11512823
> 
> 赞同：2
> 
> 时间：2012-07-16T21:26:59.843
> 
> 标签：bash

我想递归运行 myscript.sh，以执行目录中的所有文件：

[这里](https://stackoverflow.com/questions/1810404/shell-scripting-debug-help-iterating-through-files-in-a-directory)已经讨论过我可以这样做：

```
#!/bin/bash

for file in * ; do
    echo $file
done 
```

但我希望 myscript.sh 使用这种语法执行，这样我就可以只选择某些要执行的文件类型：

./myscript.sh *.dat

因此我修改了上面的脚本：

```
#!/bin/bash

for file in $1 ; do
    echo $file
done 
```

其中执行时，它只执行第一次出现，而不是所有带有 *.dat 扩展名的文件。

这里有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T21:29:17.340

通配符在您的脚本看到它之前`*.dat`由*shell扩展。*所以文件名在你的脚本中显示为`$1`, `$2`, `$3`, 等等。

您可以使用特殊`$@`变量一次性使用它们：

```
for file in "$@"; do
    echo $file
done 
```

请注意，周围的双引号`"$@"`是特殊的。来自`man bash`：

```
@ 展开为位置参数，从一开始。膨胀的时候
   出现在双引号中，每个参数扩展为一个单独的单词。那
   就是，“$@”等价于“$1”“$2”……如果出现双引号展开
   总之，第一个参数的扩展与开始 -
   原词的 ning 部分，最后一个参数的扩展为
   与原词的最后一部分连在一起。当没有位置
   参数，"$@" 和 $@ 扩展为空（即，它们被删除）。

```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-16T21:30:30.287

你可以做同样的事情：`ls *.dat | xargs echo`

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-16T21:33:44.170

您需要获取 * 的实际内容，如下所示：

```
for file in $* ; do
 echo $file 
done 
```

# ruby-on-rails-3.1 - 机架中间件如何重定向到我的 Rails 应用程序中的视图

> ID：11512825
> 
> 赞同：2
> 
> 时间：2012-07-16T21:27:07.470
> 
> 标签：ruby-on-rails-3.1, rack

在我的 Rails 3.1 应用程序中，我创建了一个机架中间件来验证访问权限。如果访问未被批准，用户将被重定向到页面。具体来说，这将是我在我的视图中已经拥有的页面。假设我正在尝试重定向到 dummy.html.erb 并在我的 routes.rb 中定义为

```
match '/dummy', to :'page#dummy' 
```

页面是我的控制器。

我尝试了以下方法，但似乎陷入了一些重定向循环。

我的机架中间件位于 /lib ：

```
class AccessVerifier
  def initialize(app)
    @app = app
  end
  def call (env)
    #....
    #....do some type of verification here and redirect if fail verification
    #....
    [301, {"Location" => '/dummy', "Content-Type" => "text/html"}, []]
  end
end 
```

在 application.rb 我有

```
config.autoload_paths += %W(#{config.root}/lib)
config.middleware.use "AccessVerifier" 
```

我也尝试在我的中间件中调用一个控制器，但我再次陷入了一些重定向循环。我从我的中间件类中调用了控制器，如下所示：

```
 def call (env)
    ...
    status,headers,response=PageController.action("validateAccess").call(env)
  end 
```

在我的控制器中：

```
 class PageController < ApplicationController
   def validateAccess
     redirect_to :controller => 'page', :action => "dummy"
   end
   ...
 end 
```

我已经看到在不使用机架中间件的情况下成功完成重定向，例如仅使用控制器，但请注意，在我的应用程序运行之前，我需要在中间件中执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T15:31:20.553

答案很简单，我觉得很傻。问题是，当我重定向到某个地方说 /dummy 时，这又会导致另一个通过 Rack 中间件并再次遍历我的 AccessVerifier 代码，该代码重定向到 /dummy 并一遍又一遍地执行此操作，从而导致重定向循环。为了解决这个问题，我通过检查传入路径是否包含在我的停止点列表中（/dummy 在该列表中）来强制停止点，然后停止。所以一个伪代码的例子

```
if path in ListOfAcceptableStoppingPoints
    @app.call(env) 
```

这解决了重定向循环问题，但现在我质疑对于我的特定情况是否更好不使用 rake 中间件，因为我发现现在我正在过滤其他东西，例如资产。当然，我可以尝试通过并挑选出我认为需要通过的所有内容，但这似乎太乏味且不正确。似乎最终，我需要在导轨级别而不是机架级别进行过滤。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-05T16:11:59.433

我没有直接回答您的问题的答案。但是，我建议使用 cancan gem 来处理授权，而不是创建自己的解决方案。见[https://github.com/ryanb/cancan](https://github.com/ryanb/cancan)

# qt - 创建 QTransform 给定 4 个点定义变换的单位正方形

> ID：11512829
> 
> 赞同：7
> 
> 时间：2012-07-16T21:27:19.703
> 
> 标签：qt, math, geometry, perspective, coordinate-transformation

鉴于 4 分是结果

```
QPolygon poly = transform.mapToPolygon(QRectF(0, 0, 1, 1)); 
```

我怎样才能找到`QTransform transform`？（更好的是：也给定一个任意源矩形）

*动机：*给定要在透视扭曲坐标系中绘制的图像的四个角点，我如何使用 QPainter 绘制图像？

![问题说明](../Images/993e5fc240db30f854b3169a0488e731.png)

这是说明 GIMP 中问题的屏幕截图，其中可以通过围绕图层的 4 个角移动来变换图层。这导致透视变换。我想在 Qt 应用程序中做同样的事情。我知道 QTransform 不仅限于仿射变换，还可以处理透视变换。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T17:22:22.550

您应该可以使用`QTransform.squareToQuad`. 只需将它传递给`QPolygonF`您要转换的对象即可。

有时我在让 squareToQuad 做我想做的事情时遇到一些问题，而不得不使用它`QTransform.quadToQuad`来定义我自己的起始四边形，但你可能会有更多的运气。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:53:02.890

我想我找到了一个解决方案，它逐步计算转换矩阵。

```
// some example points:
QPointF p1(1.0, 2.0);
QPointF p2(2.0, 2.5);
QPointF p3(1.5, 4.0);
QPointF p4(3.0, 5.0);

// define the affine transformation which will position p1, p2, p3 correctly:
QTransform trans;
trans.translate(p1.x(), p1.y());
trans.scale(p2.x() - p1.x(), p3.y() - p1.y());
trans.shear((p3.x() - p1.x()) / trans.m11(), (p2.y() - p1.y()) / trans.m22()); 
```

到目前为止，trans 描述了一个平行四边形变换。在这个平行四边形中，我在下一步中找到了 p4（相对）。我认为这可以使用不涉及反式反转的直接公式来完成。

```
// relative position of the 4th point in the transformed coordinate system:
qreal px = trans.inverted().map(p4).x();
qreal py = trans.inverted().map(p4).y();

// this defines the perspective distortion:
qreal y = 1 + (py - 1) / px;
qreal x = 1 + (px - 1) / py; 
```

这些值`x`很难`y`解释。仅给定其中一个（另一个设置为`1`），这定义了`p4`only 的相对缩放。但是结合x和y的透视变换，x和y的含义都很难；我通过反复试验找到了公式。

```
// and thus the perspective matrix:
QTransform persp(1/y, 0, 1/y-1,
                 0, 1/x, 1/x-1,
                 0, 0, 1);

// premultiply the perspective matrix to the affine transformation:
trans = persp * trans; 
```

一些测试表明，这会导致正确的结果。但是，我没有测试两个点相等或其中一个点在另外两个点之间的线段上的特殊情况；我认为这种解决方案可能会在这种情况下中断。

**因此，我仍然在给定点坐标, ... ,的情况下寻找矩阵值`m11`, `m12`...的一些直接公式。`m33``p1.x()``p1.y()``p4.x()``p4.y()`**

# javascript - 如何在可视化 Web 开发人员中将 javascript 结合到 html / ASP.Net 中？

> ID：11512830
> 
> 赞同：1
> 
> 时间：2012-07-16T21:27:23.017
> 
> 标签：javascript, asp.net, html, visual-studio-2010, visual-web-developer-2010

我想创建脚本，然后从 html 代码或 ASP.Net 代码隐藏中调用它们。我怎么做？

这可能很简单，但谷歌搜索没有帮助。

例如：我想要`ImageButton`一个`onmouseover="this.src='...'"`. 但我希望脚本是分开的而不是内联的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:34:49.300

特别是您的这部分代码

```
onmouseover="this.src='...'" 
```

你做一个函数

```
<script>
  function cOnMouseOver(me)
  {
     me.src='...';
  }
</script> 
```

你称之为：`onmouseover="cOnMouseOver(this);"`

`Attributes`或使用此控件将其设置在代码后面

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:32:45.970

```
ImageButton btn = .... (from designer)
btn.Attributes["onmouseover"] = "return false;"; 
```

用您生成的脚本替换字符串。至于@ispiro 的评论，您可以用任何合法的 javascript 替换该语句，甚至是在外部 .js 文件中定义的函数。

# ios - 两个数字之间的随机浮点数？

> ID：11512833
> 
> 赞同：2
> 
> 时间：2012-07-16T21:27:36.560
> 
> 标签：ios, random, floating-point

我目前有一种方法可以尝试在我提供的两个数字之间获得随机浮点数，但是它不能正常工作。

例如，如果我输入 4.0 作为较低的浮点数，4.5 作为较高的浮点数，我得到的结果类似于 0.8 或 1.2，有时它介于这两个数字之间。所以这让我相信这种方法不好。这是方法：

```
- (float)randomFloatBetween:(float)num1 andLargerFloat:(float)num2 {
    return ((float)arc4random() / ARC4RANDOM_MAX) * num2-num1 + num1;
} 
```

这是 ARC4RANDOM_MAX

```
#define ARC4RANDOM_MAX 0x100000000 
```

无论如何，是什么原因造成的，我该如何解决？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T21:30:22.440

您的代码意味着：

```
return (((float)arc4random() / ARC4RANDOM_MAX) * num2) - num1 + num1; 
```

你需要括号`num2-num1`：

```
return ((float)arc4random() / ARC4RANDOM_MAX) * (num2-num1) + num1; 
```

# javascript - 是否可以在函数构造函数中识别调用它的对象并在调用错误对象时中止创建？

> ID：11512837
> 
> 赞同：0
> 
> 时间：2012-07-16T21:27:51.327
> 
> 标签：javascript, oop, constructor

我有函数构造函数。我想控制什么函数（对象）可以调用它。这是示例：

```
function Bar() {

    // foo can be created only here, when Bar is instantiated
    var foo = new Foo();
}

function Foo() {

   // I'd like to have something like this here:
   if (caller != Bar) {
       alert("Not allowed, the caller is not Bar");
       return;
   }
}

var bar = new Bar();    // this is correct, Foo can be created inside Bar
var foo = new Foo();    // prints "Not allowed, the caller is not Bar" and exits 
```

可以在JS中实现吗？这种控制有一些功能吗？

如果以这种方式中止创建，将从 Foo 创建什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:30:36.187

您无法跨浏览器可靠地识别构造函数中的调用者，尤其是在新的严格模式下。

相反，您可以在同一个自执行函数内部定义`Foo()`或`Bar()`定义它们，这样`Foo()`在范围之外不知道，`Bar()`因此只能在那里创建。

一些例子：

```
// Bar() is only known within a single scope
var Foo;
(function(){
    Foo = function() {
    }

    function Bar() {
    }
})();

// Bar() is only known inside of Foo()'s constructor
function Foo() {
    function Bar() {
    }
} 
```

您可能会发现这篇说明性的文章讨论了使实例数据真正私有的各种方法：[http](http://www.crockford.com/javascript/private.html) ://www.crockford.com/javascript/private.html 。它与您在此处询问的内容不完全相同，但使用了一些相同的技术（将私有数据隐藏在闭包中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:34:13.333

您可以尝试类似的方法：（但不要认为这是跨浏览器解决方案）

```
var caller = Foo.caller.name;
if (caller != "Bar") {
} 
```

有关更多详细信息，请参阅[此](https://stackoverflow.com/questions/1333498/determine-calling-function-in-javascript)答案。

另一种选择是拥有一个默认为 false 的全局变量，然后在要允许的函数中分配为 true 并检查该函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:31:06.393

如果要限制在 Bar 中创建 Foo 对象，则可以在 Bar 中定义函数。

例如：

```
function Bar() {
  var Foo = function Foo() {

    // I'd like to have something like this here:
    if (caller != Bar) {
       alert("Not allowed, the caller is not Bar");
       return;
    }
  }
  var foo = new Foo();
    .
    .
    .
    .
} 
```

现在 Foo 在 Bar 范围之外是不可见的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T21:32:02.250

你不能简单地暴露`Foo`：

```
(function() {

    function Bar() {
        var foo = new Foo();
    }

    function Foo() {

    }

    window.Bar = Bar; //Expose bar to global scope

})(); 
```

除非您显式返回非原始值，否则作为构造函数调用的函数将返回创建的对象。所以 have`return;`仍然会返回创建的对象。

# asp.net-mvc - automapper，你在哪里把你的代码映射到视图模型到实体

> ID：11512838
> 
> 赞同：6
> 
> 时间：2012-07-16T21:27:57.310
> 
> 标签：asp.net-mvc, asp.net-mvc-3, automapper

我的 mvc3 项目有以下几层。

控制器 -> 服务 -> 存储库。

我需要将 ViewModel 映射到 Entity，不确定哪一层是放置代码的正确层。

我知道它的控制器或服务，请让我知道我应该使用哪一个，如果可以请告诉我原因。

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T21:29:41.573

> 我需要将 ViewModel 映射到 Entity，不确定哪一层是放置代码的正确层。

当然是控制器。服务层和存储库层不知道*视图模型*的含义。他们只操纵领域模型。

因此，在控制器内部，您使用`.Map<TSource, TDest>`调用在域模型和视图模型之间来回映射。但是映射定义本身（`.CreateMap<TSource, TDest>`调用）在每个 AppDomain 生命周期中完成一次，理想情况下是在`Profile`.

因此，让我们考虑一下 RESTful 术语中控制器操作中的几个典型工作流

`GET`（以 RDBMS 术语选择）：

1.  控制器查询服务层以检索域模型（大多数情况下为聚合根）
2.  控制器调用映射层将域模型映射到视图模型
3.  控制器将视图模型传递给视图

`PUT`（以 RDBMS 术语插入）：

1.  控制器从视图接收视图模型作为动作参数
2.  控制器将视图模型映射到域模型
3.  控制器将领域模型传递给服务层进行处理
4.  控制器重定向到 GET 操作

`DELETE`（在 RDBMS 术语中删除）

1.  控制器接收一个 id 作为动作参数
2.  控制器将id传递给服务层进行处理（删除）
3.  控制器重定向到 GET 操作

`POST`（RDBMS 术语中的更新）：

1.  控制器从视图接收视图模型作为动作参数
2.  控制器使用视图模型中包含的唯一 ID 查询服务层以获取我们想要更新的域模型
3.  控制器仅更新检索到的域模型的属性，这些属性也存在于视图模型中。例如，域模型可能包含一个用户名和 IsAdmin 属性，而视图模型显然只包含一个用户名属性。因此，我们保持域模型上的 IsAdmin 属性不变，并更新 Username 属性。在 AutoMapper 术语中，这转换为`.Map<TSource, TDest>`方法的以下 void 重载：`Mapper.Map<ADomain, ViewModel>(domainInstanceControllerRetrievedUsingTheId, viewModelInstancePassedAsArgument);`
4.  控制器将更新后的域模型传递给服务层进行处理（更新）
5.  控制器重定向到 GET 操作

* * *

有了这 4 个工作流程，您就可以进入 CRUD 世界了。

PS 一个 REST 提醒：

```
Create = PUT
Retrieve = GET
Update = POST
Delete = DELETE 
```

# php - 运行 PHP 文件的 GUI

> ID：11512847
> 
> 赞同：0
> 
> 时间：2012-07-16T21:28:47.213
> 
> 标签：php, visual-studio, user-interface

我创建了一个 html 页面，它将自定义数据发送到一个 php 文件，然后该文件对其进行处理和评估。

我的下一个任务是将其制作成具有以下要求的 GUI：

```
1\. A box for a custom search with button (it then posts this into the
php)

2\. A box where xml/json request can be seen

3\. A box where the xml/json response can be seen

4\. A box where the parsed version is translated and made to look pretty.

 ***MUST CONNECT TO INTERNET, PHP ESTABLISHES CONNECTION BUT DO NOT WANT A GUI ISSUE 
```

关于程序或语言等的任何建议可以帮助我以 GUI 形式与 PHP 进行交流。它需要能够访问互联网！

我在想可能是 Visual Basic，因为这是我用过的唯一一个真正使用 GUI 的软件，但我想知道你们的想法！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:39:28.173

基本上，您需要的是一个 Web 浏览器，带有一个非常简单的 HTML/Javascript 前端网页来进行 PHP 调用并显示结果。我不完全确定浏览器环境是什么让您认为它不合适，但它基本上正是您所要求的。

如果一个成熟的网络浏览器真的不适合，您可以尝试在一个简单的 GUI 应用程序中使用网络浏览器控件。这仍然可以完全一样地工作，但是没有浏览器控件，例如 URL 栏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:31:49.280

只需使用浏览器。

如果您不想这样做 - 构建一个浏览器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:34:36.893

如果您只是在寻找基本上基于 Web 的 REST 测试工具，请尝试使用 Firefox RESTClient 插件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T22:10:17.103

为什么不使用框架？你可以看看这里：

1.  适用于 Linux、Windows 和 Mac 的[AppJS ，使用 HTML、CSS 和 Javascript](http://appjs.org/)
2.  [Adobe AIR](http://www.adobe.com/devnet/air.html)：使用 ActionScript/FLEX 或 HTML/Javascript 的跨平台
3.  [Titanium](http://www.appcelerator.com/)：HTML/CSS（不再支持）
4.  [PhoneGap](http://phonegap.com/)：主要用于跨手机平台，但[这里](https://github.com/davejohnson/phonegap-windows)是它的 Windows 实现（你应该阅读 README.md ...）
5.  您也可以[从](http://hacks.mozilla.org/2012/05/desktop-apps-with-html5-and-the-mozilla-web-runtime/)Mozilla中查看

# java - 使用 junit 和 easymock 持久化一个模拟对象

> ID：11512860
> 
> 赞同：0
> 
> 时间：2012-07-16T21:29:35.223
> 
> 标签：java, unit-testing, easymock

所以我在单元测试时使用了easymock来模拟我的数据层对象。我正在使用 JPA 来实现持久性。例如项目项目 = EasyMock.cre..(Project.class); 等等

现在我要测试的方法让这个项目做一些事情，然后调用persist(project) 将其持久化。project 是一个模拟对象，所以它在这里抛出错误。我的经理告诉我，因为您只想测试该方法的功能。db 的返回值不是 imp 这就是为什么你应该使用 mocking 而不是真正的 db。所以如果这个方法有persist方法调用，我该怎么办？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T21:35:58.233

您应该嘲笑实体管理器而不是实体。

实体只是您可以轻松创建的pojo，您需要查看是否在实体管理器上调用了persist。

`Edit`

看起来您正在通过静态方法在类下的测试中创建实体管理器的实例。没有简单的方法来模拟它。

[您应该使用依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)将实体管理器传递给使用它的对象。然后，您可以只传递模拟实例，而不是传递真正的实现。

所以你的代码看起来像：

```
Project project = ...    

EntityManager manager = EasyMock.createStrictMock(EntityManager.class); 
ClassUnderTest test = new ClassUnderTest(manager)

//You expect this to be called    
manager.persist(project);

EasyMock.replay(manager);

//The method you are testing
test.save(project);

EasyMock.verify(manager); 
```

（我有一段时间没有使用easymock，所以方法可能不太正确。）

# javascript - 为什么 lineTo() 会改变内部像素？

> ID：11512861
> 
> 赞同：12
> 
> 时间：2012-07-16T21:29:37.340
> 
> 标签：javascript, html, canvas

这种情况很难解释，我用一张图来说明： ![像素变亮](../Images/88fa2362e49757f1d5c7ef639aa65f0e.png)

创建的第一个形状内的那些像素会变亮。用黑色清除屏幕，绘制红色和绿色框，然后绘制路径。到目前为止，我发现的唯一解决方法是将框的线宽设置为 2 像素，原因如下所述[。](http://corlan.org/2012/01/12/canvas-quirks/ "这里")

这是用于绘制正方形的代码：

```
sctx.save();
sctx.strokeStyle = this.color;
sctx.lineWidth = this.width;
sctx.beginPath();
sctx.moveTo(this.points[0].x, this.points[0].y);
for (var i = 1; i < this.points.length; i++)
{
    sctx.lineTo(this.points[i].x, this.points[i].y);
}
sctx.closePath();
sctx.stroke();
sctx.restore(); 
```

和行：

```
sctx.save();
sctx.strokeStyle = 'orange';
sctx.lineWidth = 5;
console.log(sctx);
sctx.beginPath();
sctx.moveTo(this.points[0].x, this.points[0].y);
for (var i = 1; i < this.points.length; i++)
{
    sctx.lineTo(this.points[i].x, this.points[i].y);
}
sctx.closePath();
sctx.stroke();
sctx.restore(); 
```

以及以 2px 宽度绘制框的相同情况的图片： ![第二个尴尬](../Images/ebb97a1cf9c944779be77a0fc01c91cd.png)

也许是`lineTo()`在弄乱 alpha 值？任何帮助是极大的赞赏。

`sctx.closePath();`编辑：为了澄清，当从正在绘制的路径中省略时，也会发生同样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T21:30:19.897

似乎这是一个当前未记录的渲染错误，由于某种原因出现在所有平台上。关于它的信息很少，希望在 HTML5 成为官方标准之前得到关注。

作为一种解决方法，不要使用`lineTo()`'s，使用多组单行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T16:04:27.323

假设你有：[http://jsfiddle.net/g3Kvw/](http://jsfiddle.net/g3Kvw/) 你可以看到它似乎是 2px 宽。但是，如果您将其更改为使用 fillRect() 而不是 lineTo()，您将拥有看起来不错的[http://jsfiddle.net/g3Kvw/1/ 。](http://jsfiddle.net/g3Kvw/1/)

问题：您将无法使用此方法绘制不是矩形的东西。

但是，如果您将 0.5 与每个 int 坐标 (x,y) 相加：http: [//jsfiddle.net/g3Kvw/3/](http://jsfiddle.net/g3Kvw/3/)您将得到常规行。

我认为这是 FF 和 webkit 上的某种抗锯齿计算错误......但我没有在错误跟踪器中找到它，而这个将数字转换为浮点数的“奇怪”解决方案是为了得到一条实线是相当混乱。因为使用整数应该就足够了。

# javascript - 查询 Rally 的项目所有者

> ID：11512865
> 
> 赞同：1
> 
> 时间：2012-07-16T21:29:56.237
> 
> 标签：javascript, rally

我一直在尝试用以下方式查询项目的所有者：

```
queries.push({
   type:"Project",
   key:"project",
   fetch:"Owner",
   query:"(ObjectID = __PROJECT_OID__)"
}); 
```

但它不起作用，我在互联网上没有找到关于如何做到这一点的建议有人可以告诉我如何做吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:41:46.857

尝试调整您的获取：

```
 fetch: "Owner,UserName" 
```

然后调整您的查询：

```
 query: "(Owner.Username = \"user@company.com\")" 
```

哪个应该给你 user@company.com 拥有的项目。

# iphone - iOS Storyboard Segue 类型之间的区别

> ID：11512873
> 
> 赞同：0
> 
> 时间：2012-07-16T21:30:56.190
> 
> 标签：iphone, objective-c, ios, cocoa-touch, storyboard

`performSegueWithIdentifier:`调用的程序化 segue和通过将 UIButton 拖动到视图执行的segue 之间有什么区别。我认为它们会是相同的，但前者在加载被“segued”到的视图时会关闭 UIWebView（facebook OAuth 对话框），而后者则不会。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T08:11:49.107

为了打电话`performSegueWithIdentifier`，您仍然需要在界面构建器中链接一个segue。唯一的区别是，以编程方式调用 segue 允许您创建将导致视图更改的条件或自定义触发器。不仅仅是点击一个按钮。

# object - QTP 中的测试对象和运行时对象有什么区别？给出的解释是否正确？

> ID：11512875
> 
> 赞同：1
> 
> 时间：2012-07-16T21:31:00.933
> 
> 标签：object, qtp

在[关于 QTP 的博客上](http://qualitypoint.blogspot.com/2009/04/understanding-object-repository-in-qtp.html)，声明如下：

> “所有的软件应用程序和网站都是使用许多不同的组件或小单元（例如 vb 中的文本框控件、HTML 中的输入标签、.net 中的网络浏览器控制）开发的，它们可以称为对象。
> 
> 某些属性可以在运行时更改。这些被称为 RO（运行时对象）属性。其中一些是无法更改的。它们被称为 TO（测试对象）属性。”

这个解释正确吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-03-22T19:23:57.150

要了解测试对象和运行时对象之间的区别，在计算机之外思考片刻会有所帮助。

想象一下，如果你愿意，你正坐在办公桌前，口渴了。但是你不能自己去休息室从汽水机里拿饮料。所以，你找一个实习生，给他一些硬币，然后把他送到休息室给你喝一杯。

这个实习生很新，所以你必须一步一步地向实习生解释你想让他们做什么。

您的脚本非常简单：

```
1) go to "the break room".
2) go to "the machine"
2) insert coins into "the coin slot"
3) press "the Coke button".
4) bring the can back to you. 
```

所以，在你的剧本中，你已经描述了一些事情。

```
"the break room" is the name of the room that contains the machine.
"the machine" is the name of the machine in the break room.
"the coin slot" is the name of a hole in the front of the machine.
"the Coke button" is the name of a button on the fronf of the machine. 
```

现在，由于这个实习生很新，他问你“当我看到这些东西时，我怎么知道它们？”

因此，您必须将“休息室”描述为“这是走廊上最后一个有绿色门的房间”。您还必须将“机器”描述为“它是右侧有很多按钮的红色机器”您还描述了“投币槽”=“这是所有按钮上方的长矩形槽”最后，您描述了“可乐按钮" = "这是一个白色的大按钮，上面有可乐标志"。

实习生将所有这些描述写在一张纸上。实习生现在有一张纸，上面有您希望他在到达休息室时看到的事物的名称和描述。

所以，接下来实习生真的走到了休息室……

他发现机器...

他找到投币口，把硬币放进去……

他在控件中搜索带有可口可乐标志的白色大按钮，但找不到。所以，他会回到你身边。

“我找不到你描述的‘可乐按钮’，”他说。事实证明，最近更改了按钮，现在所有按钮都有黑色背景。你向实习生解释这一点，他改变了他纸上的描述。你把他送回去再试一次。

于是，实习生走回休息室……

他发现机器...

他找到投币口并投入硬币......（机器之前自动将它们吐出来，他把它们拿回来）

他在控件中搜索“带有可口可乐标志的黑色大按钮”，然后他找到并按下了它。

机器分配可乐。

所以，他回来了，把你的饮料递给你。

现在，使用上面的故事，应该更容易解释测试对象和运行时对象之间的区别。

实习生就是你的测试工具——QTP。

测试对象只是您的测试工具应该寻找的真实对象的描述，就像实习生必须在机器上搜索真实对象（或“事物”）一样。

你的实习生在纸上写下的东西清单就像一个对象存储库。每个描述都有一个名称和描述。该脚本具有名称，QTP 会查找这些名称并从 OR 中获取描述。例如，您对实习生的指示可能如下所示：

```
Room("the break room").machine("the machine").slot("the coin slot").insert-coins-into
Room("the break room").machine("the machine").button("the Coke button").press 
```

运行时对象是 AUT 中的实际对象，就像有一个真实的物理机器、一个真实的物理硬币槽和一个真实的物理按钮来获取可乐一样。在软件测试中，这些对象不是物理的，但它们是真实的。

您可以使用 GetTOProperty 以编程方式读取对象的描述。此外，您可以通过编辑对象存储库来更改对象的描述，或者您可以使用代码中的 .SetTOProperty() 以编程方式即时更改对象的描述。这样做是更改您要查找的对象的描述 - 例如，如果您将描述从可口可乐徽标更改为 Sprite 徽标，那么您的实习生将成功识别 Sprite 的按钮，并且您的脚本可以与其他人一起使用变化，除了你最终会让你的实习生给你带来雪碧而不是可乐。

虽然您可以更改描述，但您无法更改实际的实物，就像您的实习生无法将可乐按钮从黑色更改为白色一样。然而——一旦你的实习生找到按钮——他可以通过按下按钮、看它、摇晃它或闻它来与按钮交互。他只是不能把它换成别的东西。对象没有 SetROproperty 方法，但您可以使用 GetROProperty，这意味着一旦通过按钮的大小、颜色和徽标识别按钮，您还可以让实习生告诉您它的宽度，或者它是否有“超出库存”指示器，您可以要求实习生告诉您该灯是否亮起。

希望这完全回答了您关于 QTP 中测试对象和实时对象之间区别的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:54:54.903

> 某些属性可以在运行时更改

上述说法不正确。

测试对象是记录期间存储的对象。

运行时对象是播放脚本时在 AUT 中显示的对象。

# nhibernate - Fluent nhibernate 在尝试获取 ISession 时抛出 TypeInitializationException

> ID：11512876
> 
> 赞同：-1
> 
> 时间：2012-07-16T21:31:00.707
> 
> 标签：nhibernate, fluent-nhibernate

我有这个使用 NHibernate 的代码

```
 public bool ValidateUser(string username, string password)
    {
        bool loginResult;
        using (var session = SessionFactory.Session)
        {
            session.BeginTransaction();

            var makeQuery = session.Query<User>().SingleOrDefault(x => x.Username == username && x.Password == password);

            loginResult = makeQuery != null;
        }

        return loginResult;
    } 
```

我的 SessionFactory 看起来像这样

```
using NHibernate;
using FluentNHibernate.Cfg;
using FluentNHibernate.Cfg.Db;
using NHibernate.Cfg;
using NHibernate.Tool.hbm2ddl;
using WebSite.DatabaseModels;
using System;
namespace GameServer.Repository
{
public class SessionFactory
{
    private static string connString = System.Configuration.ConfigurationManager.ConnectionStrings["MySQLConnectionString"].ConnectionString;

    private static ISessionFactory session;
    private static object syncRoot = new Object();

    private static ISessionFactory CreateSessionFactory()
    {
        return Fluently.Configure()
            .Database(MySQLConfiguration
            .Standard
            .ConnectionString(connString))
            .Mappings(m => m.FluentMappings
                .AddFromAssemblyOf<UserMap>())
                .ExposeConfiguration(UpdateSchema)
                .BuildSessionFactory();
    }

    private static void UpdateSchema(Configuration cfg)
    {
        new SchemaUpdate(cfg);
    }

    public static ISession Session
    {
        get
        {
            if (session == null)
            {
                lock (syncRoot)
                {
                    if (session == null)
                        session = CreateSessionFactory();
                }
            }
            return session.OpenSession();
        }
    } 
```

^ 我尝试在 Session 属性上放置一个断点，但没有命中，但是在使用 (var session = SessionFactory.Session) 时抛出异常，并且无法真正看到如何在错误报告中修复它 ![在此处输入图像描述](../Images/748df618522ab4ddbfbee2c3efca2ec9.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:18:38.183

如果您粘贴实际的异常字符串（带有堆栈跟踪的整个异常）而不是图像会更好。

正如您在堆栈跟踪中看到的那样，异常发生在`cctor`您的`SessionFactory`类中。`cctor`是一个静态构造函数。由于您没有明确的，您的代码可能会在初始化`SessionFactory`类的静态字段时中断。

我最好的选择是`MySQLConnectionString`您的配置文件中没有命名的连接字符串。在这种情况下：

```
// this is null
ConfigurationManager.ConnectionStrings["MySQLConnectionString"];

// this will throw NullReferenceException
ConfigurationManager.ConnectionStrings["MySQLConnectionString"].ConnectionString; 
```

# math - 四元数 - YawPitchRoll 和 EulerAngles 之间的转换仅在 Pi 的间距下产生不正确的结果

> ID：11512882
> 
> 赞同：4
> 
> 时间：2012-07-16T21:31:25.343
> 
> 标签：math, quaternions

我花了一些时间实现了几个算法来在 EulerAngles 和 Quaternions 之间进行转换。

我正在测试四元数值是否与此代码相同

```
 Quaternion orientation0 = Prototype1.Mathematics.ToolBox.QuaternionFromYawPitchRoll(0, 0, 0);
        Vector3 rotation = orientation0.ToEulerAngles();
        Quaternion orientation1 = Prototype1.Mathematics.ToolBox.QuaternionFromYawPitchRoll(rotation.Y, rotation.X, rotation.Z);

        Console.WriteLine(orientation0);
        Console.WriteLine(orientation1); 
```

我使用了[此处](https://stackoverflow.com/questions/11492299/quaternion-to-euler-angles-algorithm-how-to-convert-to-y-up-and-between-ha)讨论的先前方法，并且已经实现了此处描述的另一种[方法](http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToEuler/)

```
 public static Quaternion QuaternionFromYawPitchRoll(float yaw, float pitch, float roll)
    {
        float rollOver2 = roll * 0.5f;
        float sinRollOver2 = (float)Math.Sin((double)rollOver2);
        float cosRollOver2 = (float)Math.Cos((double)rollOver2);
        float pitchOver2 = pitch * 0.5f;
        float sinPitchOver2 = (float)Math.Sin((double)pitchOver2);
        float cosPitchOver2 = (float)Math.Cos((double)pitchOver2);
        float yawOver2 = yaw * 0.5f;
        float sinYawOver2 = (float)Math.Sin((double)yawOver2);
        float cosYawOver2 = (float)Math.Cos((double)yawOver2);

        // X = PI is giving incorrect result (pitch)

        // Heading = Yaw
        // Attitude = Pitch
        // Bank = Roll

        Quaternion result;
        //result.X = cosYawOver2 * cosPitchOver2 * cosRollOver2 + sinYawOver2 * sinPitchOver2 * sinRollOver2;
        //result.Y = cosYawOver2 * cosPitchOver2 * sinRollOver2 - sinYawOver2 * sinPitchOver2 * cosRollOver2;
        //result.Z = cosYawOver2 * sinPitchOver2 * cosRollOver2 + sinYawOver2 * cosPitchOver2 * sinRollOver2;
        //result.W = sinYawOver2 * cosPitchOver2 * cosRollOver2 - cosYawOver2 * sinPitchOver2 * sinRollOver2;

        result.W = cosYawOver2 * cosPitchOver2 * cosRollOver2 - sinYawOver2 * sinPitchOver2 * sinRollOver2;
        result.X = sinYawOver2 * sinPitchOver2 * cosRollOver2 + cosYawOver2 * cosPitchOver2 * sinRollOver2;
        result.Y = sinYawOver2 * cosPitchOver2 * cosRollOver2 + cosYawOver2 * sinPitchOver2 * sinRollOver2;
        result.Z = cosYawOver2 * sinPitchOver2 * cosRollOver2 - sinYawOver2 * cosPitchOver2 * sinRollOver2;

        return result;
    }

    public static Vector3 ToEulerAngles(this Quaternion q)
    {
        // Store the Euler angles in radians
        Vector3 pitchYawRoll = new Vector3();

        double sqx = q.X * q.X;
        double sqy = q.Y * q.Y;
        double sqz = q.Z * q.Z;
        double sqw = q.W * q.W;

        // If quaternion is normalised the unit is one, otherwise it is the correction factor
        double unit = sqx + sqy + sqz + sqw;

        double test = q.X * q.Y + q.Z * q.W;
        //double test = q.X * q.Z - q.W * q.Y;

        if (test > 0.4999f * unit)                              // 0.4999f OR 0.5f - EPSILON
        {
            // Singularity at north pole
            pitchYawRoll.Y = 2f * (float)Math.Atan2(q.X, q.W);  // Yaw
            pitchYawRoll.X = PIOVER2;                           // Pitch
            pitchYawRoll.Z = 0f;                                // Roll
            return pitchYawRoll;
        }
        else if (test < -0.4999f * unit)                        // -0.4999f OR -0.5f + EPSILON
        {
            // Singularity at south pole
            pitchYawRoll.Y = -2f * (float)Math.Atan2(q.X, q.W); // Yaw
            pitchYawRoll.X = -PIOVER2;                          // Pitch
            pitchYawRoll.Z = 0f;                                // Roll
            return pitchYawRoll;
        }
        else
        {
            pitchYawRoll.Y = (float)Math.Atan2(2f * q.Y * q.W - 2f * q.X * q.Z, sqx - sqy - sqz + sqw);       // Yaw
            pitchYawRoll.X = (float)Math.Asin(2f * test / unit);                                              // Pitch
            pitchYawRoll.Z = (float)Math.Atan2(2f * q.X * q.W - 2f * q.Y * q.Z, -sqx + sqy - sqz + sqw);      // Roll

            //pitchYawRoll.Y = (float)Math.Atan2(2f * q.X * q.W + 2f * q.Y * q.Z, 1 - 2f * (sqz + sqw));      // Yaw 
            //pitchYawRoll.X = (float)Math.Asin(2f * (q.X * q.Z - q.W * q.Y));                                // Pitch 
            //pitchYawRoll.Z = (float)Math.Atan2(2f * q.X * q.Y + 2f * q.Z * q.W, 1 - 2f * (sqy + sqz));      // Roll 
        }

        return pitchYawRoll;
    } 
```

除了音高值为±PI时，我所有的实现都有效。

```
 Quaternion orientation0 = Prototype1.Mathematics.ToolBox.QuaternionFromYawPitchRoll(0, PI, 0);
    Vector3 rotation = orientation0.ToEulerAngles();
    Quaternion orientation1 = Prototype1.Mathematics.ToolBox.QuaternionFromYawPitchRoll(rotation.Y, rotation.X, rotation.Z);

    Console.WriteLine(orientation0);
    Console.WriteLine(orientation1);     // Not the same quaternion values 
```

为什么这不适用于该特定值？如果它是一个奇点，那么它不会在算法中被确定为一个，而“测试”值将非常接近于 0。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T15:02:48.783

旋转空间环绕自身。显然，如果你绕任何轴旋转 2PI，你最终会回到你开始的地方。同样，如果您绕轴旋转 PI，则与绕同一轴旋转 -PI 相同。或者，如果您围绕轴旋转任意角度，则与围绕该轴的负向旋转该角度的负向相同。

所有这一切意味着您的四元数转换算法必须决定在处理冗余时要做什么。您在评论中提供的两个方向是相同的方向：(0,0,0,1) 和 (0,0,0,-1) [我更喜欢按字母顺序排列 'w']。

你应该确保你总是标准化你的四元数，否则你最终会得到一些奇怪的漂移。除此之外，似乎正在发生的是，当您围绕“z”轴旋转 PI 时，浮点舍入或“小于”与“小于或等于”差异是将围绕圆的表示推到您的算法决定将角度表示为 -PI 绕 z 轴旋转的点。那是一样的。

以类似的方式，如果您围绕任何轴旋转 2PI，您的四元数可能是 (-1,0,0,0)。但是如果你旋转零，它将是（1,0,0,0）。然而，从这些四元数中的任何一个返回的欧拉角表示应该是 (0,0,0)。

# ruby-on-rails - 导入 CSV - 没有这样的文件或目录

> ID：11512891
> 
> 赞同：0
> 
> 时间：2012-07-16T21:32:22.580
> 
> 标签：ruby-on-rails, csv, import, filefield

当我想通过 file_field 选择一个文件时，它会给我一个错误，即我的文件是“nil”。这是错误：“没有这样的文件或目录 - Book1.csv”

我可以知道为什么吗？以下是代码：

**控制器**

```
def import_csv
@list = List.find(params[:list_id])
@lists = List.all

respond_to do |format|

@csv_text = File.read(params[:list][:file])
@csv = CSV.parse(@csv_text, :headers => true)
@n=0
@csv.each do | row |
  @user_new = User.new
  @user_new.first_name = row[0]
  @user_new.last_name = row[1]
  @user_new.email = row[2]
  @user_new.company = row[3]
  @user_new.address = row[4]
  @user_new.city = row[5]
  @user_new.state = row[6]
  @user_new.zipcode = row[7]
  @user_new.country = row[8]
  @user_new.notes = row[9]
  @user_new.birthday = row[10]
  @user_new.home_number = row[11]
  @user_new.mobile_number = row[12]
  @user_new.list_id = @list.id
  @user_new.save

  @list.subscribers += 1
  @list.save
  @n=@n+1
  GC.start if @n%50==0
  flash[:notice] = "CSV Imported Successfully, with  #{@n} records"                                
end

  format.html { redirect_to lists_url }
  format.json { head :no_content }
end
  end 
```

**看法**

```
<%= form_for(:list, :url => list_import_csv_path(@list), :method => :get, :html => {:multipart => true}) do |f| %>
 <table>
    <tr>
        <td><label for="dump_file">Select a CSV File :</label></td>
        <td><%= f.file_field :file %></td>
    </tr>
    <tr>
        <td colspan='2'><%= submit_tag 'Import from CSV file' %></td>
    </tr>
</table>
<% end %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:11:49.693

这是因为您尝试将`ActionDispatch::Http::UploadedFile`Object 作为路径而不是真实路径传递。你做：

```
@csv_text = File.read(params[:list][:file]) 
```

你应该做：

```
@csv_text = File.read(params[:list][:file].tempfile.to_path.to_s) 
```

`:method => :get`当您上传不那么小的文件时，这也可能是您使用的问题。通常 GET 和 File Upload 并不是一个很好的组合。^^

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-27T18:27:25.093

2017 年 6 月 27 日 - 希望如果有人处于与我相同的情况，他们会从中受益。

事实证明，而我有：

```
 = form_tag action: :bulk_upload_submit, multipart: true do
    ...
          = file_field_tag :file, accept: 'text/csv' 
```

并将文件参数发送为：

`"file"=>"subscribers.csv"`

我需要更改 form_tag 以使用路径而不是操作：

`= form_tag upload_subscribers_path, multipart: true do`

将参数更改为：

```
"file"=>
  #<ActionDispatch::Http::UploadedFile:0x007ffda857b5e0
   @content_type="text/csv",
   @headers="Content-Disposition: form-data; name=\"file\"; filename=\"subscribers.csv\"\r\nContent-Type: text/csv\r\n",
   @original_filename="subscribers.csv",
   @tempfile=#<File:/var/folders/_4/50fjk9z57x544klj30k0g1780000gn/T/RackMultipart20170627-33947-12xwfow.csv>> 
```

# module - 链接 fortran 模块：“未定义的引用”

> ID：11512897
> 
> 赞同：5
> 
> 时间：2012-07-16T21:32:48.220
> 
> 标签：module, linker, fortran, gfortran

我正在尝试在一个模块中编写一些函数/子例程，这些函数/子例程调用同一模块中的另一个函数并遇到链接器错误。显示相同行为的玩具示例：

```
!in test.f

module m1
  implicit none
contains
  real function mult(a, b)
    real :: a
    real :: b
    mult = a * b
    return
  end function mult

  real function sq(a)
    real :: a, mult
    sq = mult(a, a)
    return
  end function sq

end module m1

program main
use m1
write(*,*) sq(2.0)
end program 
```

当我尝试编译它时，我遇到了麻烦：

```
[christopher@archlinux metropolis]$ gfortran -ffree-form test.f
/tmp/ccpzdTLE.o: In function `__m1_MOD_sq':
test.f:(.text+0x20): undefined reference to `mult_'
collect2: error: ld returned 1 exit status 
```

另一方面，只编译 ( `gfortran -c -ffree-form test.f -Wall`) 运行没有任何抱怨。

现在，这就像编译器错误一样寻找全世界——在它提出的模块中，它提供了一个`mult_`真正应该出现的参考`__m1_MOD_sq`——但我很难相信这是一个编译器错误，而不是比我做一些愚蠢的事。

DDG 没有发现任何有用的东西。大多数类似的问题发生在将模块从一个主文件中分离出来时。在这些情况下，当模块与`program`. 我查看了许多有关 Fortran 模块的页面，但没有看到任何相关内容。

任何人都可以向我指出适当的文档，或者更好的是，解释发生了什么以及如何解决它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T21:57:32.390

您不需要在函数sq 中声明函数mult，即不需要“real :: mult”。sq 已经“知道” mult 因为它在同一个模块中。mult 的接口对于 sq 来说是已知的，因为它们在同一个模块中。mult 和 sq 的接口对于主程序来说是已知的，因为它使用了模块。同时提供接口和声明的模块会使编译器感到困惑。

# c# - 转换集合

> ID：11512898
> 
> 赞同：9
> 
> 时间：2012-07-16T21:32:50.023
> 
> 标签：c#, .net, linq

有一个对象的集合。示意图：

```
[
    { A = 1, B = 1 }
    { A = 1, B = 2 }
    { A = 2, B = 3 }
    { A = 2, B = 4 }
    { A = 1, B = 5 }
    { A = 3, B = 6 }
] 
```

需要：

```
[
    { A = 1, Bs = [ 1, 2 ] }
    { A = 2, Bs = [ 3, 4 ] }
    { A = 1, Bs = [ 5 ] }
    { A = 3, Bs = [ 6 ] }
] 
```

有可能这样的LINQ吗？

**注意：**订购很重要。所以`Bs = [5]`不能合并`Bs = [1, 2]`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:22:08.880

鉴于这些简单的类：

```
class C {
  public int A;
  public int B;
}
class R {
  public int A;
  public List<int> Bs = new List<int>();
} 
```

你可以这样做：

```
var cs = new C[] {
  new C() { A = 1, B = 1 },
  new C() { A = 1, B = 2 },
  new C() { A = 2, B = 3 },
  new C() { A = 2, B = 4 },
  new C() { A = 1, B = 5 },
  new C() { A = 3, B = 6 }
};

var rs = cs.
  OrderBy(o => o.B).
  ThenBy(o => o.A).
  Aggregate(new List<R>(), (l, o) => {
    if (l.Count > 0 && l.Last().A == o.A) {
      l.Last().Bs.Add(o.B);
    }
    else {
      l.Add(new R { A = o.A, Bs = { o.B } });
    }
    return l;
  }); 
```

**注意**：在上面我假设必须对 Bs 和 As 进行排序。如果不是这种情况，只需删除排序指令即可：

```
var rs = cs.
  Aggregate(new List<R>(), (l, o) => {
    if (l.Count > 0 && l.Last().A == o.A) {
      l.Last().Bs.Add(o.B);
    }
    else {
      l.Add(new R { A = o.A, Bs = { o.B } });
    }
    return l;
  }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T22:57:08.593

所以基本上你想将具有相同`A`-value 并且是连续的组合在一起。

您需要将对象列表转换为包含上一个/下一个元素的匿名类型。我用了两个`Selects`让它更红。然后您需要检查这两个元素是否是连续的（相邻索引）。现在，您拥有所需的一切`GroupBy`、价值和`bool`.

你的对象：

```
var list = new System.Collections.Generic.List<Foo>(){
    new Foo(){ A = 1, B = 1 },
    new Foo(){ A = 1, B = 2 },
    new Foo(){ A = 2, B = 3 },
    new Foo(){ A = 2, B = 4 },
    new Foo(){ A = 1, B = 5 },
    new Foo(){ A = 3, B = 6 }
}; 
```

查询：

```
var groups = list
    .Select((f, i) => new
    {
        Obj = f,
        Next = list.ElementAtOrDefault(i + 1),
        Prev = list.ElementAtOrDefault(i - 1)
    })
    .Select(x => new
    {
        A = x.Obj.A,
        x.Obj,
        Consecutive = (x.Next != null && x.Next.A == x.Obj.A)
                   || (x.Prev != null && x.Prev.A == x.Obj.A)
    })
    .GroupBy(x => new { x.Consecutive, x.A }); 
```

输出结果：

```
foreach (var abGroup in groups)
{
    int aKey = abGroup.Key.A;
    var bList = string.Join(",", abGroup.Select(x => x.Obj.B));
    Console.WriteLine("A = {0}, Bs = [ {1} ] ", aKey, bList);
} 
```

这是工作**演示**：http : [//ideone.com/fXgQ3](http://ideone.com/fXgQ3)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T00:00:14.623

您可以使用[GroupAdjacent 扩展方法](http://blogs.msdn.com/b/ericwhite/archive/2008/04/21/the-groupadjacent-extension-method.aspx)。

然后，你只需要

```
var grps = objects.GroupAdjacent(p => new { p.A }); 
```

我认为这是实现它的最简单方法。

**编辑：**

这是我的测试代码。

```
class Program
{
    static void Main(string[] args)
    {
       var ia = new Dummycls[] { 
           new Dummycls{ A = 1, B = 1 },
           new Dummycls{ A = 1, B = 2 },
           new Dummycls{ A = 2, B = 3 },
           new Dummycls{ A = 2, B = 4 },
           new Dummycls{ A = 1, B = 5 },
           new Dummycls{ A = 3, B = 6 },

       };
        var groups = ia.GroupAdjacent(i => i.A);
        foreach (var g in groups)
        {
            Console.WriteLine("Group {0}", g.Key);
            foreach (var i in g)
                Console.WriteLine(i.ToString());
            Console.WriteLine();
        }

        Console.ReadKey();
    }
}

class Dummycls
{
    public int A { get; set; }
    public int B { get; set; }

    public override string ToString()
    {
        return string.Format("A={0};B={1}" , A , B);
    }
} 
```

结果是

```
Group 1
A=1;B=1
A=1;B=2

Group 2
A=2;B=3
A=2;B=4

Group 1
A=1;B=5

Group 3
A=3;B=6 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T22:01:08.267

这是执行您想要的方法的结构：

```
public static IEnumerable<IGrouping<TKey, TElement>> GroupWithKeyBreaks<T, TKey, TElement>(IEnumerable<T> enumerable,
        Func<T, TKey> keySelector,
        Func<T, TElement> itemSelector)    
{
    // Error handling goes here
    TKey currentKey = default(TKey);
    List<TElement> elements = new List<TElement>();

    foreach (T element in enumerable)
    {
        TKey thisKey = keySelector(element);
        if (thisKey == null)
        {
            continue;
        }

        if (!thisKey.Equals(currentKey) && elements.Count > 0)
        {
            yield return new SimpleGrouping<TKey, TElement>(currentKey, elements);
            elements = new List<TElement>();
        }

        elements.Add(itemSelector(element));
        currentKey = thisKey;
     }

    // Add the "last" item
    if (elements.Count > 0)
    {
        yield return new SimpleGrouping<TKey, TElement>(currentKey, elements);
    }
} 
```

它使用以下帮助类：

```
private class SimpleGrouping<T, U> : IGrouping<T, U>
{
    private T key;
    private IEnumerable<U> grouping;

    T IGrouping<T, U>.Key
    {
        get { return key; }
    }

    IEnumerator<U> IEnumerable<U>.GetEnumerator()
    {
        return grouping.GetEnumerator();
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        return grouping.GetEnumerator();
    }

    public SimpleGrouping(T k, IEnumerable<U> g)
    {
        this.key = k;
        this.grouping = g;
    }
} 
```

这是一个示例用法：

```
foreach (var grouping in data.GroupWithKeyBreaks(x => x.A, x => x.B))
{
    Console.WriteLine("Key: " + grouping.Key);
    foreach (var element in grouping)
    {
        Console.Write(element);
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-16T22:48:48.823

```
var result = list.ToKeyValuePairs(x => x.A)
                 .Select(x => new { A = x.Key, Bs = x.Value.Select(y => y.B) }); 

foreach (var item in result)
{
    Console.WriteLine("A = {0} Bs=[{1}]",item.A, String.Join(",",item.Bs));
} 
```

-

```
public static class MyExtensions
{
    public static IEnumerable<KeyValuePair<S,IEnumerable<T>>> ToKeyValuePairs<T,S>(
            this IEnumerable<T> list, 
            Func<T,S> keySelector)
    {
        List<T> retList = new List<T>();
        S prev = keySelector(list.FirstOrDefault());
        foreach (T item in list)
        {
            if (keySelector(item).Equals(prev))
                retList.Add(item);
            else
            {
                yield return new KeyValuePair<S, IEnumerable<T>>(prev, retList);
                prev = keySelector(item);
                retList = new List<T>();
                retList.Add(item);
            }
        }
        if(retList.Count>0)
            yield return new KeyValuePair<S, IEnumerable<T>>(prev, retList);
    }
} 
```

**输出：**

```
A = 1 Bs=[1,2]
A = 2 Bs=[3,4]
A = 1 Bs=[5]
A = 3 Bs=[6] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-16T23:08:17.850

```
var groupCounter = 0;
int? prevA = null;

collection
    .Select(item => { 
        var groupId = item.A == prevA ? groupCounter : ++groupCounter; 
        prevA = item.A;
        return new { groupId, item.A, item.B }; 
    })
    .GroupBy(item => item.groupId)
    .Select(grp => new { A = grp.First().A, Bs = grp.Select(g => g.B) }); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-16T23:52:42.043

如果您的收藏在 中`o`，则：

```
 var trans = o.Aggregate
    (
            new {
                List = new List<Tuple<int, List<int>>>(),
                            LastSeed = (int?)0
            },
            (acc, item) =>
            {
                if (acc.LastSeed == null || item.A != acc.LastSeed)
                    acc.List.Add(Tuple.Create(item.A, new List<int>()));
                acc.List[acc.List.Count - 1].Item2.Add(item.B);
                return new { List = acc.List, LastSeed = (int?)item.A};
            },
            acc => acc.List.Select(
                  z=>new {A = z.Item1,
                          B = z.Item2 as IEnumerable<int>
                         })
       ); 
```

这会产生`IEnumerable<int, IEnumerable<int>>`所需的表格。

# powershell - 启动过程不适用于 VSIXInstaller.exe

> ID：11512903
> 
> 赞同：2
> 
> 时间：2012-07-16T21:33:15.643
> 
> 标签：powershell, powershell-2.0, vsix

我正在尝试运行该过程并等到它关闭。当我像下面那样运行 VSIXInstaller 时，它可以工作：

```
$pathToTheExtension = $path + "VS2012.Ext.vsix"
VSIXInstaller.exe $pathToTheExtension 
```

但是当我通过 Start-Process VSIXInstaller 运行它时，它没有得到 $pathToTheExtension 作为参数。

```
$pathToTheExtension = $path + "VS2012.Ext.vsix"
$result = $(Start-Process -filePath "VSIXInstaller.exe" -argumentList $pathToTheExtension -Wait) 
```

我应该如何通过 Start-Process 传递 vsix 文件的路径？

下面是运行 Start-Process 的结果。

![在此处输入图像描述](../Images/9f929a30be8d76ac4c974150bba08a5b.png)

**编辑**

我从进程资源管理器中检查了正在运行的 VSIXInstaller 进程的命令行参数，这对我来说似乎是正确的。

```
"C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\VSIXInstaller.exe" "C:\VS2012.Ext.vsix" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T21:39:59.993

您需要用引号将参数值括起来。

```
$pathToTheExtension = '"{0}VS2012.Ext.vsix"' -f $path;
$result = Start-Process -FilePath "VSIXInstaller.exe" -ArgumentList $pathToTheExtension -Wait -PassThru; 
```

# javascript - 如何获取 javascript/dom 加载和处理时间的指标

> ID：11512905
> 
> 赞同：0
> 
> 时间：2012-07-16T21:33:33.820
> 
> 标签：javascript, optimization, metrics

我们发现自己在一个能够与超过 20k 用户实时合作的网页中工作。

我们努力优化后端系统，但我们现在需要在前端进行优化。

我想出的第一件事是使用一些工具来监控 JS 文件的加载时间。

但是我们真的不需要知道加载 javascript 的时间，我们真正需要的是知道我们的 javascript 代码的哪些部分需要更多的时间来完成。

现在我们正在使用 new relic 来跟踪我们的站点，并知道需要优化哪些服务器端脚本。

但我看不到任何关于前端代码或巫婆文件的指标需要优化。

有什么工具可以帮助我们解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:02:36.560

测试您的 javascript 跨浏览器速度的最佳方法是编写您自己的函数。将要测试的任何代码包装到一个函数中，并在 1 秒内尽可能多地运行该函数，计算迭代次数。至少运行该测试五次，因为每次都会得到不同的结果，然后找到平均迭代次数。我还建议使用 chrome，因为它在 javascript 性能方面比任何其他浏览器快约 4 倍。测试您的所有代码并针对您的浏览器进行优化，改进也会影响您的用户体验。

我有我自己编写的 speedTest obj，您可以在我的网站[http://www.deckersdesign.com/source.php](http://www.deckersdesign.com/source.php)上查看，它正在建设中。仅供参考，这个 obj 找到迭代的中位数而不是平均值。

# flot - 如何告诉 FLOT 不要使用 0 作为条形图中 Y 轴的默认最小值？

> ID：11512907
> 
> 赞同：2
> 
> 时间：2012-07-16T21:33:38.087
> 
> 标签：flot

我正在使用 FLOT 图表库来绘制随时间消耗的卡路里。我希望 y 轴使用自动缩放（仅显示数据集中 +/- 最小值和最大值的值）。

但是，该图表始终使用 0 作为条形图的最小值，而不是自动缩放 y 轴值。这是我的代码：

```
function DrawCalorieChart(calorieData) {
    plot = $.plot($("#CalorieHistoryChart"), [calorieData],
    {
        series: {
            bars: { show: true, barWidth: 0.8, align: "center" }
        },
        legend: {
            show: false
        },
        xaxis: { tickDecimals: 0, tickSize: 1, mode: "categories", tickLength: 0 },
        yaxis: { autoscaleMargin: 0.025 },
        grid: { labelMargin: 10 }
    });
} 
```

我可以手动设置最小值，但问题是我不知道输入新数据后最小值可能是多少。我尝试完全删除 yaxis 规范，设置 autoscaleMargin（如图所示）并将 min 设置为 null。但没有任何效果 - 最小值是静态值或零！任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:41:09.823

目前没有办法在库自己的 API 中执行此操作。您需要编写一些 JS 来迭代您的值并手动找到最小值/最大值。这可以在您的绘图/重绘调用之外完成，也可以在 processRawData 挂钩中完成，如果您不断添加值和重绘，这可能会更好。

解决这个问题实际上是一个活跃的项目，我预计它将在未来 2-3 周内合并到 Github 主分支中。因此，取决于您是否能够等待并愿意使用不太稳定的代码，这是另一种选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-05T15:06:23.930

[实施DNS答案](https://stackoverflow.com/a/11514158/2610249)中提到的更改后的当前答案：

`zero: false`在`bar`选项中设置。

从[官方文档](https://github.com/flot/flot/blob/master/API.md#customizing-the-data-series)：

> 无论数据的范围如何，面积图和条形图通常从零开始。这是因为它们通过大小传达信息，从不同的值开始会扭曲它们的含义。然而，在填充纯粹是为了装饰目的的情况下，“零”允许您覆盖此行为。对于填充的线条和条形，它默认为 true；将其设置为 false 告诉系列使用与未填充线相同的自动缩放。

# wordpress - 需要在 Wordpress 3.4.1 中使用 Mod_Rewrite 但它不起作用 - 我已经尽我所能

> ID：11512911
> 
> 赞同：1
> 
> 时间：2012-07-16T21:33:50.020
> 
> 标签：wordpress, mod-rewrite, permalinks

在任何其他网站上，这都是小菜一碟……但是使用 Wordpress，我一辈子都无法让它发挥作用。我已经尝试了所有我能想到甚至研究的东西。我绝对 100% 需要让它正常工作。 **示例：page-language.php?lang=english 被重写为 /language-learning-software/learn-how-to-speak-english 以使其对 SEO 友好**

我的 .htaccess 如下：

```
Options +FollowSymlinks
RewriteEngine On
RewriteRule ^language-learning-software/learn-how-to-speak-([a-zA-Z0-9_-]+)$ /wp-content/themes/bizway/page-language.php?lang=$1 [N]

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

我有hostgator，如果这有帮助的话。我已经在支持下发言了一个多小时，除了他们无法将“AllowOverride”更改为“All”之外，没有任何结果——我觉得这可能会解决它，但我想这是不可能的，因为它是一个“共享”主机。

有没有可以解决这个问题的插件？有什么方法可以自定义永久链接？任何帮助将不胜感激！

谢谢你。

# javascript - 为什么我不能查询我刚刚通过 append() 添加的元素？

> ID：11512912
> 
> 赞同：1
> 
> 时间：2012-07-16T21:33:56.607
> 
> 标签：javascript, jquery

为什么我不能查询我刚刚通过 append() 添加的元素？

```
$('body').append('<div id="testing"></div>');
if($("#testing").length == 0)
    alert("WTF!  Testing div should be there!"); 
```

是否有某种布局在 JS 完成运行之前不会发生？

我怎样才能解决这个问题？是否有其他方法可以调用来创建 dom 元素以立即使用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T21:42:19.343

我会看看这段代码在哪里执行。这是使用 jQuery(document).ready() 功能块运行的吗？我看不到你的完整代码。

当我遇到这样的事情时，通常是因为我的代码在 dom 准备好之前执行。请试试这个：

```
jQuery(document).ready(function(){
    $('body').append('<div id="testing"></div>');
    if($("#testing").length == 0){
        alert("WTF!  Testing div should be there!");
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:36:26.813

因为长度`#testing`是1。如图：http: [//jsfiddle.net/Skooljester/FrsHs/2/](http://jsfiddle.net/Skooljester/FrsHs/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:38:23.633

## *[jsFiddle 演示](http://jsfiddle.net/roXon/9ucYA/1/)*

```
$(function(){

    if( $("#testing").length  ){   // test for existance               
            alert("YEEE there it is!");                
    }else{                 
             alert("Buuuubububu :( ");            
    }

}); 
```

如果您**测试不存在**使用：

```
if( $("#testing").length <= 0  ) 
```

或者：

```
if( !($("#testing").length)  ) 
```

# ibm-mq - 使用 java 从 mq 清除消息

> ID：11512916
> 
> 赞同：2
> 
> 时间：2012-07-16T21:34:26.277
> 
> 标签：ibm-mq

使用 Java 和 JMS 连接到 websphere mq v7.1 并清除一个或多个指定队列的所有消息的最佳方法是什么？我是否需要使用 Websphere MQ 特定的 java API？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T02:32:56.720

像所有好的问题一样，“这取决于。”

仅当队列上没有打开的句柄时，才能使用命令清除队列。在这种情况下，发送一个 PCF 命令来清除队列是非常有效的，但是如果有打开的句柄，你会得到一个错误。PCF 命令当然是 Java 功能而不是 JMS，因为它们是 WebSphere MQ 专有的。

另一方面，任何被授权执行破坏性的程序离开队列都可以清除队列。在这种情况下，只需循环一次 get，直到获得 2033 返回码，表明队列为空。这可以使用 JMS 或 Java 来执行，但它们都为您管理输入缓冲区。如果队列真的很深，那么您最终会移动所有数据，并且如果应用程序是客户端连接的，那么您将以网络速度而不是在内存中移动它。

为了解决这个问题，您需要指定最少量的缓冲区，并且作为 GET 选项之一还指定`MQGMO.TRUNCATED_MSG_ACCEPTED`. 这仅在 get 调用期间移动消息头，并且可以显着加快。

最后，如果您以编程方式执行此操作并且无论您使用哪种方法，请分离多个线程并且不要使用同步点。实际上，您必须不遗余力地在队列中获取独占输入，因此一旦获得会话，只需从中产生许多线程。优雅地关闭每个线程，并在所有线程关闭后关闭会话。

# iphone - 将 iPhone 应用程序转换为 iPad

> ID：11512917
> 
> 赞同：0
> 
> 时间：2012-07-16T21:34:31.767
> 
> 标签：iphone, objective-c, xcode, ipad

我开始将 iPhone 应用程序转换为 iPad，该应用程序是一个特殊的计算器，手感和外观都像一个。在 iPhone 上是使用肖像，因为它最适合。

我的问题是：

一世。当我在 iPad 上运行它时，我需要使用整个 iPad 屏幕尺寸吗？我只想将所有控件的大小和宽度放大原始大小的 125%。在 iPad 上运行时，如何检查设备屏幕尺寸以及如何将计算器居中居中？目前是 iPad，`CGRectMake(0,0,640,1024)`但将来可能会改变。

ii. 我也喜欢它在 iPad 的两个方向上进行相应的调整，但在 iPhone 上只有纵向。而且我不确定如何以最有效-简单的方式做到这一点......如果你可以建议的话。

我当前的 iPhone 代码具有`.xib`不同的控件，但我使用 `-setFrame:CGRectMake(...)`in 代码调整它们，到目前为止，我将`TARGETED_DEVICE_FAMILY`in project 设置设置为在两个设备上运行应用程序，但没有`-setFrame:CGRectMake(...)`根据设备将任何更改为动态的。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:03:00.317

1）您可以向 [UIScreen mainScreen] 询问它的边界 - 这会给您大小。

2）您需要响应您的 UIViewController 中与旋转相关的旋转方法：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation 
```

3) 您可以使用它来确定您的应用程序是否在 iPhone 或 iPad 上运行：

```
[[UIDevice currentDevice] userInterfaceIdiom] 
```

4）要在更大的视图中居中视图，请使用以下代码：

```
+ (CGRect)centeredFrameForSize:(CGSize)size inRect:(CGRect)rect
{
    CGRect frame;
    frame.origin.x = rintf((rect.size.width - size.width)/2) + rect.origin.x;
    frame.origin.y = rintf((rect.size.height - size.height)/2) + rect.origin.y;
    frame.size = size;

    return frame;
} 
```

# c - 有没有一种方法可以在 C 中以周期性方式递减数组

> ID：11512918
> 
> 赞同：2
> 
> 时间：2012-07-16T21:34:32.813
> 
> 标签：c

我正在为 LED 段上的数字编写代码，每五秒减少 1

我现在的实际代码是这个

```
FiveSecDelay+=1;
if (FiveSecDelay ==100)
{
count2--; //decrement count2

for (uint32_t x = 0; x < 4; x++) //split count to to individual digits
{
new_value[x] = count2 % 10;
count2 = count2 / 10;
}

for (uint32_t i = 0; i < 4; i++)
{

Segment_Write(Digit[i],new_value[i]); assign  value to segments
}
FiveSecDelay =0;
} 
```

我使用调度程序每毫秒调用一次函数，理论上这应该可以工作，因为我使用相同的技术为段分配值，发生的情况是我的起始值为 8，它应该得到 7， 6,5,4 依此类推直到 0，但由于某种原因，它从 8 变为 42 并停留在那里

我曾试图修复它，但没有完成。

任何帮助都会很棒

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:45:31.207

快速而肮脏的方式：

```
while(true)
{
    check();
    sleep(5);
}

int values[1];
int check(void)
{
    if (values[0] > 0)
       values[0]--;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:46:20.093

如果您可以访问系统时间，则可以存储调用的初始时间，然后每次查询其值时，检查系统时间以确定正确的调整值，以及设置值的小片段，像这样：

```
// initialize
int check = 142;
unsigned long long time = getMillis();

int get_value(void)
{
    unsigned long long time_factor = ((getMillis() - time) / (unsigned long long) 5);
    if (time_factor > (unsigned long long) check)
        return 0;
    else
        return check - time_factor;
}

void set_value(int v)
{
    check = v;
    time = getMillis();
} 
```

请注意，我不知道如何在 c 中获取系统时间（尽管我敢打赌你需要`#include <time.h>`），所以我编写了一个名为 getMillis() 的函数，它将系统时间作为 unsigned long long 返回（应该是一个 64 位无符号整数）。实施取决于读者。

还值得一提的是，您将在大约 6 亿年后遇到环绕错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:36:31.723

有`check`一个参数，它是数字。然后在程序的主循环中有一个计数器，它从某个值开始，每次调用 check 时都会递减。

我假设您正在做的事情比您当前的`check`功能更复杂，因为显然它没有以提供的形式做任何事情。如果您提供更多信息，我们将能够为您提供更彻底和适用的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T21:48:16.193

```
void check() {
  static int array[] = {142}; // why are you using an array here?
  (*array)--;
}

int main() {
  while(true)
  {
    check();
    usleep(5000); // approximate
  }
  return 0;
} 
```

# rest - 使用自定义媒体类型是一个不错的选择吗？

> ID：11512923
> 
> 赞同：10
> 
> 时间：2012-07-16T21:34:44.140
> 
> 标签：rest

一位开发人员（现已离开）使我确信，发展 RESTful Web 服务的正确方法是为您的服务创建自定义媒体类型。

例如 application/vnd.acme.payroll.v1+json

这样，您可以告诉您的客户端指定要使用的编码，而无需更改 URI。

这种技术好不好？通常服务会将版本嵌入到 url 中：

例如/acme/1.0/payroll/

我在强制客户使用这个方案时遇到了很多困难，特别是因为 DELETE 似乎没有强制使用媒体类型

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-17T03:59:41.967

您可以在 RESTful 服务中使用一些主要的信号机制：

*   媒体类型
*   `rel`您链接到的资源的。
*   自定义标头，例如`Accept-Version`/ `Api-Version`。

它们中的每一个都有不同的用途，我将概述我们在设计 API 时理解它们的方式。

* * *

## 媒体类型

为了表明对给定资源可以进行哪些操作，以及这些操作的语义是什么，许多人使用自定义媒体类型。在我看来，这并不完全正确，而 a`rel`更准确。

自定义媒体类型应该告诉您数据的*类型*，例如其格式或某些信息的体现或嵌入方式。拥有自定义媒体类型意味着您的 API 的使用者与该特定表示紧密耦合。然而，使用更通用的东西，比如`application/json`“这只是 JSON 数据”。

通常仅 JSON 不足以用于 RESTful 服务，因为它没有内置链接或资源嵌入功能。这就是像[HAL](http://stateless.co/hal_specification.html) ( `application/hal+json`) 这样的东西的用武之地。它是 JSON 的一种特殊化，仍然是一种通用格式，而不是特定于应用程序的格式。但它足以覆盖 JSON 之上的链接和嵌入语义，这是连贯地表达 RESTful API 所必需的。

## 链接关系类型（`rel`s）

这将我们带到了`rel`s。对我来说，自定义 rel 是一种*完美*的方式来表明正在处理或链接到哪种类型的资源。例如，`rel`用户资源的自定义可能是`http://rel.myapi.com/user`，它有两个目的：

*   您的 API 的客户端必须提前知道此密钥，因为它是特定于 API 的知识。例如，如果它在您的初始资源上可用并且您正在使用 HAL 链接到用户资源，则客户端可能会通过`initialResource._links["http://rel.myapi.com/user"].href`.
*   *编写*API 客户端的开发人员可以在他们的 Web 浏览器中访问该 URI，并了解该资源在您的 API 中代表什么，包括哪些方法适用以及它们做什么。这是一种非常方便的方式来传达我提到的 API 特定知识。有关这方面的示例，请参阅[http://rel.nkstdy.co](http://rel.nkstdy.co/)。

如果您将`rel`s 与标准或半标准媒体类型（如）结合使用`application/hal+json`，您将获得遵循其媒体类型指定的统一格式的资源，以及由其`rel`s 定义的 API 特定语义。这几乎可以让你到达那里。

## 自定义标题

剩下的问题是版本控制。您如何允许客户端协商资源的不同版本，同时又不使旧 URI 失效？

我们的解决方案受[Restify](http://mcavage.github.com/node-restify/#Routing) Node.js 框架的启发，是两个自定义标头：`Accept-Version`来自客户端，与服务器非常匹配`X-Api-Version`（或`Api-Version`在即将发布的 Restify 2.0 版本中，根据新的[RFC 6648](https://www.rfc-editor.org/rfc/rfc6648)）。如果它们不匹配，`400 Bad Request`则结果为 a。

我承认自定义媒体类型在这里是一个相当流行的解决方案。在我看来，鉴于上述考虑，它们在概念上不太合适，但如果你选择它们作为你的版本控制机制，你就不会做一些奇怪的事情。`GET`正如您所注意到的，当与其他方法一起使用时，它会出现一些语义问题。

要记住的一件事是，在真正的 RESTful 系统中，版本控制不应该是这样的问题。它只在一种非常特殊的情况下才重要：当您的资源表示以向后不兼容的方式发生变化时，但您仍然希望保持相同`rel`的 s. 因此，如果`http://rel.myapi.com/friend`资源突然失去了它的`username`领域并获得了一个`id`领域，那将是合格的。但是如果它突然获得了一个`nickname`字段，那并不是向后不兼容的，所以不需要版本控制。如果“朋友”的概念在你的 API 中完全被“连接”的概念取代，*这实际上并不是向后不兼容的*，因为 API 使用者将不再`http://rel.myapi.com/friend`在 API 中的任何地方找到链接供他们遵循.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T02:25:29.187

是的，这是一个不错的选择。正如您正确指出的那样，它阐明了您将用于有效负载的编码，并让双方在不更改 URI 的情况下协商不同版本的编码。

是的，客户端不需要连同实体主体一起发送 DELETE。我相信它会被兼容的 HTTP 服务器简单地忽略，因为在这种情况下没有传输有效负载数据。客户端为 URI 发出 DELETE，服务器返回一个响应代码，指示它是否成功。又好又简单！如果服务器希望在 DELETE 之后返回一些数据，那么它可以自由地这样做，并且应该在它返回时指定响应的媒体类型。

# javascript - 如何强制 JavaScript 等到动态添加的脚本文件完成加载？

> ID：11512927
> 
> 赞同：3
> 
> 时间：2012-07-16T21:35:01.963
> 
> 标签：javascript, jquery

我正在尝试编写一个将 javascript 文件附加到 DOM 的函数，但我希望让其余代码等到新添加的 JS 文件完全加载。这是我要完成的示例，尽管此代码无法正常工作：

```
$(document).ready(function () {
    var newScript = document.createElement("script");
    newScript.setAttribute("type", "text/javascript");
    newScript.src = "http://www.domain.com/script.js";
    document.getElementsByTagName("body")[0].appendChild(newScript);
    $(newScript).ready(function () { // This is the idea of what I'm trying to do, but this doesn't seem to actually wait until the new file is completely loaded.
        foo.bar(); // foo is a new global variable which is declared in the newScript. This causes an error "foo is not defined".
        // Here is where more code I wish to execute should continue.
    });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:43:03.627

正如穆萨在上面的评论中提到的那样。使用 jQuery 的[getScript](http://api.jquery.com/jQuery.getScript/)并使用成功回调函数来触发您的其他函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:43:11.480

如果你想要更健壮的模块加载功能，那么 require.js 在这种能力上效果很好。查看：[http](http://requirejs.org/docs/why.html) ://requirejs.org/docs/why.html以获得概述。我使用 require.js 专门用于延迟加载脚本模块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:43:50.450

使用 jQuery（如您所标记的），这非常容易：

```
$.getScript('/script.js', function() {
    foo.bar();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T21:42:22.457

有几种不同的方法可以做到这一点......通过库或“手动”，可以这么说，只使用浏览器 API 和直接的 JavaScript。有关如何仅在 JS 中执行此操作的答案，请在此处查找[Stoyan 的帖子](http://www.phpied.com/dynamic-script-and-style-elements-in-ie/)以提供指导。基本上，它的要点是为脚本`unload`和`onreadystatechange`属性设置一个事件处理程序，然后检查它`readyState`是“加载”还是“完成”（如果它存在的话）。它看起来像这样：

```
var done = false;
newScript.onload = newScript.onreadystatechange = function () {
    if (!done && (!newScript.readyState || newScript.readyState === "loaded" || newScript.readyState === "complete)) {
        done = true;
        // run your actual code here
    }
}; 
```

# java - 如何计算一个点到另一个点一定距离的纬度/经度？

> ID：11512929
> 
> 赞同：0
> 
> 时间：2012-07-16T21:35:19.743
> 
> 标签：java, android, google-maps

考虑在地图上画一个圆，中心为 GLatLng (A)，半径 (r) 以米为单位。

![在此处输入图像描述](../Images/0634cc3ec5f320ecac4321cb72b6eda7.png)

如何计算位置 B 的 GLatLng？假设 r 平行于赤道。

使用 GLatLng.distanceFrom() 方法在给出 A 和 B 时获取半径是微不足道的 - 但反之则不然。

总而言之，给定 A 点和 R 的纬度/经度（以米为单位），我需要获得 B 点的经度/经度。方向并不重要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T21:40:41.280

您需要做的就是取原点并计算向东或向西一度的距离。这将为您提供沿该纬度线的每度距离。然后将 r 除以每度的距离，它会告诉你东或西多少度 B。

# java - Android 2D像素完美碰撞库

> ID：11512931
> 
> 赞同：1
> 
> 时间：2012-07-16T21:35:43.210
> 
> 标签：java, android, collision-detection

我正在开发一个 2D 四面滚动游戏，我目前正在实施碰撞。我惊讶地发现标准库中没有实现像素完美的碰撞库，因此我编写了自己的碰撞“引擎”，用几何形式表示非几何图形。现在，它工作得很好，但我真的很想知道是否有办法让它全部完成，这要归功于一个构建良好的库。如果有人知道，请分享一下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:57:16.377

我建议你看看[AndEngine](http://www.andengine.org/)。你可以在这里看到一个关于 2d 像素完美碰撞的视频：

[http://www.youtube.com/watch?v=abbXURuDaTo](http://www.youtube.com/watch?v=abbXURuDaTo)

# asp.net - asp.net 比较两个页面的性能

> ID：11512939
> 
> 赞同：1
> 
> 时间：2012-07-16T21:36:12.797
> 
> 标签：asp.net, performance, compare

我有两页，基本上它们显示相同的输出，但它们的编程风格不同。我想比较这两个页面的性能，比如页面加载需要多长时间？如果我们执行提交操作，那么第 1 页与第 2 页相比有多快等等。

如何比较性能？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:47:45.520

最简单的方法是将 Page trace 属性设置为 true 并在浏览器中观察每个页面事件处理程序的执行时间。

这是一个类似问题的示例：

[测量 ASP.NET 页面加载时间](https://stackoverflow.com/questions/1395587/measure-asp-net-page-load-time)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:49:16.637

提交需要多长时间是一回事，而您可能要检查的另一件事是渲染时间。 **如果两个页面都没有，如何测量和比较性能的最简单的想法**可能是编写点击测试（例如使用[web-driver](http://seleniumhq.org/docs/03_webdriver.html#introducing-webdriver)）并测量测试的执行速度（可能在一个序列）。这种方法让您不仅可以简单地衡量渲染 html 本身需要多少时间，还可以衡量浏览器加载该 html（和相关资源）并处理它的时间。

如果您想从真实用户那里收集和汇总性能指标，那是完全不同的故事，我认为这超出了您的问题范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:49:51.890

对于您尝试计时的页面，请维护两个 DateTime 对象`dtStart`和`dtEnd`. `OnPreInit`在方法中和方法`dtEnd = DateTime.Now`结束时将 dtStart 设置为 DateTime.Now `Render`。然后，您可以从两个时间戳计算 TimeSpan 并记录您维护加载时间的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T10:30:45.070

在这两个页面上，添加此 Trace 模式：

```
<%@ Page Language="VB" Trace="True" TraceMode="SortByTime" %> 
```

当页面呈现时，在页面底部，您将看到每个 ASP.NET 页面事件的所有计时转储。然后您可以看到时差在哪里。

如果您对测量客户端渲染时间感兴趣，那么您需要使用一些浏览器分析器。例如，在 IE 9 上，按 F12，转到 Developer Tool，转到 Profiler，然后单击 Start。然后刷新页面。然后停止。然后它会告诉你昂贵的 javascript 函数在哪里。

Google chrome 和 Firebug 有类似的工具，功能更强大。

有帮助吗？

# c# - GridView 没有绑定到数据表

> ID：11512942
> 
> 赞同：1
> 
> 时间：2012-07-16T21:36:24.917
> 
> 标签：c#, asp.net

如果我有 gridview 自动生成列，那么表格会添加正确的列，但是我在表格中添加了下拉标题并且不希望自动生成列。当我将行添加到数据表并将其绑定到 gridview 时，什么都没有显示。

这是我的网格视图代码：

```
 <asp:GridView ID="GridView3" runat="server" CellPadding="3"
        ForeColor="#333333" GridLines="None"
        AllowSorting="True" SortedAscendingHeaderStyle-CssClass="sortasc-header" 
        SortedDescendingHeaderStyle-CssClass="sortdesc-header"
        AllowPaging="True" PageSize="17" PagerSettings-Mode="NextPreviousFirstLast" 
        ShowHeaderWhenEmpty="True" PagerStyle-Font-Names="WebDings" PagerStyle-Font-     Size="Medium"
        PagerSettings-FirstPageText=" 7 " PagerSettings-PreviousPageText=" 3 " 
        PagerSettings-NextPageText=" 4 " PagerSettings-LastPageText=" 8 " 
          Font-Size="Small" onpageindexchanging="GridView3_PageIndexChanging" 
          onsorting="GridView3_Sorting" AutoGenerateColumns="False">

        <AlternatingRowStyle BackColor="White" ForeColor="#333333" />
         <Columns>
             <asp:BoundField HeaderText="Date" />

             <asp:BoundField HeaderText="Time" />

            <asp:TemplateField HeaderText="Type">
                <HeaderTemplate>
                    <asp:DropDownList ID="TypeList" runat="server" Height="21px" Width="134px" 
                    DataSourceId="dsWarningType"
                    DataTextValue="Name" DataValueField="Name">
                    </asp:DropDownList>
                 </HeaderTemplate>
             </asp:TemplateField>

                  <asp:TemplateField HeaderText="Process">
             <HeaderTemplate>
                  <asp:DropDownList ID="Process" runat="server" Height="21px" Width="134px" 
                   >
                  </asp:DropDownList>
             </HeaderTemplate>
             </asp:TemplateField>

                   <asp:TemplateField HeaderText="Index">
             <HeaderTemplate>
                  <asp:DropDownList ID="Index" runat="server" Height="21px" Width="134px" 
                   >
                  </asp:DropDownList>
             </HeaderTemplate>
             </asp:TemplateField>

             <asp:BoundField HeaderText="Body" />

         </Columns>
        <EditRowStyle BackColor="#999999" />
        <FooterStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />
        <HeaderStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />                <PagerSettings FirstPageText=" 7 " LastPageText=" 8 " Mode="NextPreviousFirstLast" NextPageText=" 4 " PreviousPageText=" 3 "></PagerSettings>
        <PagerStyle BackColor="#5D7B9D" ForeColor="White" HorizontalAlign="Center" />
        <RowStyle BackColor="#DCE2E8" ForeColor="#333333" />
        <SelectedRowStyle BackColor="#E2DED6" Font-Bold="True" ForeColor="#333333" />
<SortedAscendingHeaderStyle CssClass="sortasc-header"></SortedAscendingHeaderStyle>

<SortedDescendingHeaderStyle CssClass="sortdesc-header"></SortedDescendingHeaderStyle>
      </asp:GridView> 
```

我声明了数据表和相应的列。在我手动填写 DataTable 后，我只是绑定它：

```
dt = new DataTable();

dt.Columns.Add("Date");
dt.Columns.Add("Time");
dt.Columns.Add("Type");
dt.Columns.Add("Process");
dt.Columns.Add("Index");
dt.Columns.Add("Body");
//Manually fill in data....
...

GridView3.DataSource = dt;
GridView3.DataBind(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:43:50.297

您需要设置绑定字段的 DataField 属性。

```
 <asp:BoundField HeaderText="Date" DataField="Date" /> 
```

看看这个例子：

[http://msdn.microsoft.com/en-us/library/aa479342.aspx](http://msdn.microsoft.com/en-us/library/aa479342.aspx)

# cocoa - Cocoa 惰性实例化 - 最佳实践

> ID：11512953
> 
> 赞同：0
> 
> 时间：2012-07-16T21:37:21.920
> 
> 标签：cocoa, lazy-initialization

我对惰性实例化的最佳编码实践有疑问。 

我有一个自定义类（MainClass），它构成了我的视图控制器的模型。MainClass 的属性之一是另一个自定义类（SubClass）。现在假设我想从我的视图控制器访问和设置 SubClass 的一些属性。我应该在 MainClass 中延迟实例化子类吗？

每次我想设置它的一个属性时，在 MainClass 中延迟实例化 SubClass 为我省去了检查 SubClass 是否存在（如果不存在则创建它）的麻烦。

另一方面，尽管只有 SubClass 存在时，我才无法在视图中设置变量。让我解释得更好。假设我只想在 SubClass.name 存在的情况下设置我的文本字段的 stringValue。每次我询问 SubClass.name 的存在时，MainClass 都会懒惰地实例化 SubClass，这是一种浪费。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T22:01:00.677

您需要对美学做出决定，如果这是驱动这个问题的原因，或者您需要解释性能限制。

是的，延迟初始化有优点也有缺点。

好处

*   您无需为从不使用的物品付费
*   您不需要在永远不会使用的对象上实际设置字段
*   如果需要，可以在最后一刻构建对象，这通常比在启动时构建它更可取

缺点

*   （轻微的）复杂性——特别是如果你或同事不习惯这个成语
*   如果您忘记在访问器中调用 Initialize() 或等效项，您可能会在某些语言中遇到棘手的错误，或者在其他语言中崩溃

混合方法是可能的。对于重要任务，使用惰性实例化：

```
 - (void) display {
     [self initialize];
     [self display];
     } 
```

对于不重要的任务，只需检查初始化。

```
 - (void) updateCaches {
     if ([self isInitialized]) {
         [self reloadCachedDataFrom: [self startDatabaseSession]];
     }
 } 
```

您不想构建对象只是为了更新其缓存，但也许，如果对象是活动的，您可能希望继续保持缓存温暖。所以，你看看你是否已经实例化了对象，并且只有在它已经设置好的情况下才重新加载缓存。

# android - Android 剪辑子视图

> ID：11512957
> 
> 赞同：2
> 
> 时间：2012-07-16T21:37:45.700
> 
> 标签：android, imageview, android-linearlayout

我里面有一个线性布局和一个图像视图。线性布局具有圆角。我希望我的图像位于视图的最顶部，但是当图像出现时，角不再是圆形的。我能为此做些什么？我知道在 iOS 中有一个用于容器（UIView）的剪辑子视图选项。但不确定Android。

```
 <LinearLayout   xmlns:android="http://schemas.android.com/apk/res/android"   
    android:orientation="vertical"
    android:gravity="top"
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent"  
    android:background="@drawable/cell_rounded_edges">  
    <ImageView
        android:id="@+id/prodImage"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="top"
        android:gravity="top"   
        android:focusable="false"
        android:clickable="false"   
        android:adjustViewBounds="true"       
        />
.....and so on 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:43:30.793

Any `ViewGroup`（包括`LinearLayout`）具有布尔 XML 属性[`android:clipChildren`](http://developer.android.com/reference/android/view/ViewGroup.html#attr_android:clipChildren)（也可通过编程方式设置[`setClipChildren(boolean)`](http://developer.android.com/reference/android/view/ViewGroup.html#setClipChildren%28boolean%29)），但根据文档，默认情况下设置为 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-21T20:26:40.997

我找到了一个伟大而简单的解决方案！

我的布局顶部有一个图像，其中只有顶角必须是圆形的（模拟 iOS 中子视图的剪辑），因为我的图层的所有角都是圆形的。

在我的图像背景上：

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" >
<solid android:color="#e3e3e3"/>
<corners android:bottomRightRadius="0dip"
         android:bottomLeftRadius="0dip"
         android:topLeftRadius="25dip"
         android:topRightRadius="25dip"/>
<padding android:left="0dip" android:top="0dip" android:right="0dip" android:bottom="0dip" />
</shape> 
```

在我的图层背景上：

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" >
<solid android:color="#FFF"/>
<corners android:radius="25dip"/>
<padding android:left="0dip" android:top="0dip" android:right="0dip" android:bottom="0dip" /> 
</shape> 
```

# java - 将 std::unique_ptr 传递给 JNI

> ID：11512960
> 
> 赞同：5
> 
> 时间：2012-07-16T21:38:01.347
> 
> 标签：java, c++, c++11, java-native-interface, unique-ptr

我正在用 JNI 包装一些 C++ 代码，并偶然发现了以下工厂函数：

```
std::unique_ptr<MetricPlanner> create_metric_planner(*arguments*) 
```

我需要将对该函数创建的计划器的引用传递回 Java 以供以后使用，但我对 a) 如何将其传递回来以及 b) 一旦传递它会发生什么感到困惑。

通常，我一直这样通过：

```
Director *DIRECTOR = new Director(arguments);
return (jlong)DIRECTOR; 
```

它就像一个魅力。

当使用返回这种类型的指针的工厂函数而不是普通的构造函数时，有人可以解释用 JNI 引用对象的类似过程吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:55:45.510

由于您将`create_metric_planner`函数的返回值传递给 Java，然后再使用它，因此您不希望`unique_ptr`在其作用域结束时破坏返回值。为此，您必须调用[`unique_ptr::release`](http://en.cppreference.com/w/cpp/memory/unique_ptr/release).

```
return (jlong)create_metric_planner( ... ).release(); 
```

不要忘记在某些时候，当您使用完该函数返回的对象时，您必须使用`delete`它（或调用您正在使用的库提供的一些删除器函数）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-31T21:58:02.283

我使用以下代码创建、使用和删除带有 a 的对象`std::unique_ptr`，同时在 Java 端保持引用（以保持对象处于活动状态，即使在切换活动时也是如此）。

要创建对象并将指针传递给 Java：

```
void Java_com_domain_project_activity_createObject(JNIEnv *env, jobject obj) {
        Object* object = (std::makeUnique<Object>()).release();
        env->SetLongField(obj, getPtrFieldId(env, obj), (jlong)object);
    } 
```

要删除对象：

```
void Java_com_domain_project_activity_deleteObject(JNIEnv *env, jobject obj) {
        Object* object = (Object*) env->GetLongField(obj, getPtrFieldId(env, obj));
        delete object;
    } 
```

要处理对象：

```
void Java_com_domain_project_activity_workOnObject(JNIEnv *env, jobject obj) {
        Object* object = (Object*) env->GetLongField(obj, getPtrFieldId(env, obj));
        // Work on object
} 
```

最后将指针保存在 Java 端：

```
jfieldID getPtrFieldId(JNIEnv * env, jobject obj)
{
    static jfieldID ptrFieldId = 0;

    if (!ptrFieldId)
    {
        jclass c = env->GetObjectClass(obj);
        ptrFieldId = env->GetFieldID(c, "objPtr", "J");
        env->DeleteLocalRef(c);
    }

    return ptrFieldId;
} 
```

理想情况下，我不会`unique_ptr`在这些情况下使用，只使用普通指针，但`unique_ptr`在我的项目中是必需的。

我还发现这个网站非常有用：[https ://www.studiofuga.com/2017/03/10/ac-smart-pointer-wrapper-for-use-with-jni/](https://www.studiofuga.com/2017/03/10/a-c-smart-pointer-wrapper-for-use-with-jni/)

# javascript - Mongoose，按填充字段排序查询

> ID：11512965
> 
> 赞同：23
> 
> 时间：2012-07-16T21:38:32.197
> 
> 标签：javascript, node.js, mongodb, sorting, mongoose

据我所知，可以使用 Mongoose ( [source](https://groups.google.com/forum/?fromgroups#!topic/mongoose-orm/6t-AzCSPgHs) ) 对填充的文档进行排序。

我正在寻找一种按一个或多个填充字段对查询进行排序的方法。

考虑这两个猫鼬模式：

```
var Wizard = new Schema({
    name  : { type: String }
, spells  : { [{ type: Schema.ObjectId, ref: 'Spell' }] }
});

var Spell = new Schema({
    name    : { type: String }
,   damages : { type: Number }
}); 
```

示例 JSON：

```
[{
    name: 'Gandalf',
    spells: [{
            name: 'Fireball',
            damages: 20
        }]
}, {
    name: 'Saruman',
    spells: [{
            name: 'Frozenball',
            damages: 10
        }]
}, {
    name: 'Radagast',
    spells: [{
            name: 'Lightball',
            damages: 15
        }]
}] 
```

我想按照他们的法术伤害对这些巫师进行排序，使用类似的东西：

```
WizardModel
  .find({})
  .populate('spells', myfields, myconditions, { sort: [['damages', 'asc']] })
// Should return in the right order: Saruman, Radagast, Gandalf 
```

我实际上是在查询后手动进行这些排序并希望对其进行优化。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-08-30T16:57:38.250

您可以仅显式指定填充方法的必需参数：

```
WizardModel
  .find({})
  .populate({path: 'spells', options: { sort: [['damages', 'asc']] }}) 
```

看看[http://mongoosejs.com/docs/api.html#document_Document-populate](http://mongoosejs.com/docs/api.html#document_Document-populate) 这是上面链接的一个例子。

```
doc
.populate('company')
.populate({
  path: 'notes',
  match: /airline/,
  select: 'text',
  model: 'modelName'
  options: opts
}, function (err, user) {
  assert(doc._id == user._id) // the document itself is passed
}) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-01-14T09:02:20.323

尽管这是一篇相当老的帖子，但我想通过 MongoDB 聚合查找管道分享一个解决方案

重要的部分是：

```
 {
      $lookup: {
        from: 'spells',
        localField: 'spells',
        foreignField:'_id',
        as: 'spells'
      }
    },
    {
      $project: {
        _id: 1,
        name: 1,
        // project the values from damages in the spells array in a new array called damages
        damages: '$spells.damages',
        spells: {
          name: 1,
          damages: 1
        }
      }
    },
    // take the maximum damage from the damages array
    {
      $project: {
        _id: 1,
        spells: 1,
        name: 1,
        maxDamage: {$max: '$damages'}
      }
    },
    // do the sorting
    {
      $sort: {'maxDamage' : -1}
    } 
```

在下面找到一个完整的例子

```
'use strict';

const mongoose = require('mongoose');
const Schema = mongoose.Schema;

mongoose.connect('mongodb://localhost/lotr');

const db = mongoose.connection;

db.on('error', console.error.bind(console, 'connection error:'));
db.once('open', () => {

  let SpellSchema = new Schema({
    name    : { type: String },
    damages : { type: Number }
  });

  let Spell = mongoose.model('Spell', SpellSchema);

  let WizardSchema = new Schema({
    name: { type: String },
    spells: [{ type: Schema.Types.ObjectId, ref: 'Spell' }]
  });

  let Wizard = mongoose.model('Wizard', WizardSchema);

  let fireball = new Spell({
    name: 'Fireball',
    damages: 20
  });

  let frozenball = new Spell({
    name: 'Frozenball',
    damages: 10
  });

  let lightball = new Spell({
    name: 'Lightball',
    damages: 15
  });

  let spells = [fireball, frozenball, lightball];

  let wizards = [{
    name: 'Gandalf',
    spells:[fireball]
  }, {

    name: 'Saruman',
    spells:[frozenball]
  }, {
    name: 'Radagast',
    spells:[lightball]
  }];

  let aggregation = [
    {
      $match: {}
    },
    // find all spells in the spells collection related to wizards and fill populate into wizards.spells
    {
      $lookup: {
        from: 'spells',
        localField: 'spells',
        foreignField:'_id',
        as: 'spells'
      }
    },
    {
      $project: {
        _id: 1,
        name: 1,
        // project the values from damages in the spells array in a new array called damages
        damages: '$spells.damages',
        spells: {
          name: 1,
          damages: 1
        }
      }
    },
    // take the maximum damage from the damages array
    {
      $project: {
        _id: 1,
        spells: 1,
        name: 1,
        maxDamage: {$max: '$damages'}
      }
    },
    // do the sorting
    {
      $sort: {'maxDamage' : -1}
    }
  ];
  Spell.create(spells, (err, spells) => {
    if (err) throw(err);
    else {
      Wizard.create(wizards, (err, wizards) =>{
        if (err) throw(err);
        else {
          Wizard.aggregate(aggregation)
          .exec((err, models) => {
            if (err) throw(err);
            else {
              console.log(models[0]); // eslint-disable-line
              console.log(models[1]); // eslint-disable-line
              console.log(models[2]); // eslint-disable-line
              Wizard.remove().exec(() => {
                Spell.remove().exec(() => {
                  process.exit(0);
                });
              });
            }
          });
        }
      });
    }
  });
}); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2018-08-18T18:08:21.810

这是猫鼬文档的示例。

```
var PersonSchema = new Schema({
    name: String,
    band: String
});

var BandSchema = new Schema({
    name: String
});
BandSchema.virtual('members', {
    ref: 'Person', // The model to use
    localField: 'name', // Find people where `localField`
    foreignField: 'band', // is equal to `foreignField`
    // If `justOne` is true, 'members' will be a single doc as opposed to
    // an array. `justOne` is false by default.
    justOne: false,
    options: { sort: { name: -1 }, limit: 5 }
}); 
```

# java - ListView 中的复选框具有奇怪的检查行为

> ID：11512967
> 
> 赞同：0
> 
> 时间：2012-07-16T21:39:01.207
> 
> 标签：java, android, android-listview, android-checkbox

我是 Java 和 Andriod 开发的新手。

我的应用程序中有一个视图，其中包含一个 ListView

然后我有一个继承自 ArrayAdapter 的自定义适配器

在 getView 方法的视图中，我返回一行，其中包含一些文本和一个复选框

现在到目前为止，这一切都很好，我的列表已填充，我可以检查我的项目，并且所有事件似乎都按预期触发。

我遇到的问题是我检查了前 3 个项目，然后我注意到第 11 个、第 12 个和第 13 个项目被选中，当我滚动时，我看到每隔一段时间，其他复选框似乎也以相同的模式被选中。

如果我检查大约 10 个复选框，那么它最终会检查大约 80 个列表中的所有项目......

谁能解释我做错了什么？

我认为没有任何代码可以帮助解释这一点，因为我没有在任何地方设置复选框的检查状态，这一切都是自己处理的，所以检查项目的事实让我感到困惑。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:08:04.950

发生这种情况是因为 Android 出于性能目的回收列表项，在这里您可以解决此问题： [ListView reusing views when ... I don't want it to](https://stackoverflow.com/questions/6921462/listview-reusing-views-when-i-dont-want-it-to)

希望有所帮助:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:11:52.083

这是预期的行为。ListView 重用适配器中的视图。所以你想要的是保留一个`Set`“选定的项目”并在点击时添加一个项目或删除它`CheckBox`，然后在你的 getView 添加以下代码：

```
if(mSelected.contains(getItem(position)) {
    checkBox.setChecked(true);
} else {
    checkBox.setChecked(false);
} 
```

这样，当行被重用时，`CheckBox`将是正确的状态。

# wcf - HTTPS 上的 WCF 生成“提供的 URI 方案 'https' 无效；应为 'http'。”

> ID：11512969
> 
> 赞同：2
> 
> 时间：2012-07-16T21:39:02.517
> 
> 标签：wcf, ssl, https, iis-7.5

我一直在谷歌搜索我可能找到的所有地方（包括 Stackoverflow 上的此处）以找出一个错误，我试图在 Windows 7 x64 上将 WCF 服务部署到 IIS 7.5，该服务仅通过 SSL 和基本 HTTP 身份验证运行。我在 IIS 中有一个站点，它绑定到带有自签名证书的 HTTPS 端口 50443。（我不能使用标准端口 443，因为我们计划将它部署到已经运行 Tomcat 的服务器上的 IIS，该服务器正在监听 80 和 443。）

这是 web.config：

```
<configuration>
  <system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <serviceMetadata httpsGetEnabled="true"/>
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <bindings>
      <basicHttpBinding>
        <binding name="SSLBinding">
          <security mode="TransportCredentialOnly">
            <transport clientCredentialType="Basic"/>
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <services>
      <service name="HelloWorldWcf.HelloWorldWcfService">
        <endpoint name="HelloWorldWcf.HelloWorldWcfService" 
                  address="https://mylaptop:50443/HelloWorld/Service1.svc" 
                  binding="basicHttpBinding" 
                  bindingConfiguration="SSLBinding" 
                  contract="HelloWorldWcf.IHelloWorldWcfService"/>
        <endpoint address="https://mylaptop:50443/HelloWorld/Service1.svc/mex" 
                  binding="mexHttpsBinding" 
                  contract="IMetadataExchange"/>
      </service>
    </services>
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
</configuration> 
```

如果我浏览到服务端点地址并手动输入基本身份验证凭据，我会在浏览器中收到以下异常错误消息：

> 提供的 URI 方案“https”无效；预期的“http”。
> 参数名称：context.ListenUriBaseAddress

这与我尝试针对类似服务运行 WCF 客户端时遇到的错误相同，只是它以“参数名称：via”结尾（因为调用堆栈中显示的方法的参数名称为“System.ServiceModel. Channels.TransportChannelFactory`1.ValidateScheme(URI via)”，其实就是“via”）。

我已经调整了服务器和客户端配置文件很多次了，但我已经迷失了方向，但是上面的 web.config 文件是我迄今为止最好的猜测——它甚至不能在浏览器上运行，更不用说 WCF 客户端了.

我需要做什么才能访问托管在非标准 SSL 端口上的 IIS 7.5 中的 WCF 服务，并通过 HTTPS 进行基本 HTTP 身份验证？帮助！（＆ 谢谢！）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T21:45:56.610

尝试将此添加到绑定

```
<security mode="Transport"> 
    <transport clientCredentialType="None" proxyCredentialType="None" realm=""/> 
    <message clientCredentialType="Certificate" algorithmSuite="Default" />
</security> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T18:46:12.713

啊！好的，让它工作的剩余步骤：

1.  将 web.config 中的 <security> 节点替换为burning_LEGION。

2.  从 web.config 中删除“mex”端点。（这使我可以在浏览器中访问通常的“您已创建服务”友好网页。）

3.  转义了我在客户端 C# 代码中分配给 HelloWorldWcfServiceClient.ClientCredentials.UserName.UserName 的“DOMAIN\username”字符串中的反斜杠。（我是不是说“arrrrgh！”？伙计，我的脸红了。）这消除了我在第 1 步和第 2 步后得到的错误：

> System.ServiceModel.Security.MessageSecurityException：“HTTP 请求未使用客户端身份验证方案“基本”进行授权。从服务器收到的身份验证标头是“基本领域 =“mylaptop”'.---> System.Net.WebException：远程服务器返回错误：（401）未经授权。

我从[这里](https://stackoverflow.com/questions/2904883/how-can-i-use-wcf-with-only-basichttpbinding-ssl-and-basic-authentication-in-ii)得到了第 2 步的想法，这让我认为 mex 对 HTTPS 不满意，而对于第 3 步[，](http://mikearnett.wordpress.com/2011/09/20/the-http-request-is-unauthorized-with-client-authentication-scheme-anonymous-the-authentication-header-received-from-the-server-was-basic/)我注意到用户名是 @"domain\username"，而不是"domain\username"。

+1 燃烧_LEGION 的协助！

所以，未回答的问题：（1）为什么安全/消息节点对不使用消息安全（仅传输安全）的配置有任何影响？(2) 如果 mex 端点只是干扰正常操作，它的意义何在？(3) 如果 mode="TransportCredentialOnly" 不适用于 HTTPS，为什么我没有收到错误提示？

# c# - 如何在 razor 中加载 Subgurim GMap 对象（MVC3/4）

> ID：11512970
> 
> 赞同：0
> 
> 时间：2012-07-16T21:39:09.697
> 
> 标签：c#, asp.net-mvc, razor, subgurim-maps

我正在使用 ASP.NET MVC 4，并且正在尝试在我的页面上加载 Google 地图。

我正在使用[Subgurim](http://en.googlemaps.subgurim.net/)库并且已经有了地图对象，但我不知道如何将它加载到页面中。

这是我到目前为止得到的：

```
 @model Subgurim.Controles.GMap
 @{    
      ViewBag.Title = "Pesquisa Carona";
 }
<h2>PesquisaCarona</h2>
<h4>Diga o endereço</h4>
<input type="text" name="txEndereco" />
<input type="submit" />
<cc1:GMap ID="googleMap" runat="server" /> <!-- This doesnt work!!!--!> 
```

我知道通常我会添加直接访问它的地图，例如：

对于服务器端：

```
GMap1.addGMarker(oMarker); 
```

对于页面：

```
<cc1:GMap ID="GMap1" runat="server" Height="300px" Width="300px" /> 
```

但是对于 MVC，我无法做到这一点。

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-07T17:04:50.383

通过将 ascx 用户控件呈现为 cshtml 中的部分，我能够使用 .NET 4.5、MVC 5 (razor)、GMaps 4.1.0.6 和 Visual Studio 2013 来实现基本示例。这是我为使其工作所做的工作：

*   从 NuGet 添加 Subgurim.Maps 包。
*   添加一个 ascx 控件：在我的例子中，它是 Gmap.ascx，与我想使用的 cshtml 放在同一个文件夹中。您的代码最终应如下所示：
*   在 ascx 中：

    > ```
    > <%@ Control Language="C#" AutoEventWireup="true" CodeBehind="Gmap.ascx.cs" Inherits="YourApp.Views.Gmap" %>  
    > <%@ Register Assembly="GMaps" Namespace="Subgurim.Controles" TagPrefix="gmaps" %>
    > <form id="form1" runat="server">
    >     <gmaps:GMap
    >         ID="GMap1"
    >         runat="server"
    >         Width="500px"
    >         Height="250px"
    >         EnableViewState="False" />
    > </form> 
    > ```

*   在 ascx.cs 中：

    > ```
    > namespace YourAPP.Views
    > {
    >     using System;
    >     using System.Drawing;
    >     using System.Web.Mvc;
    > 
    >     public partial class Gmap : ViewUserControl
    >     {
    >         protected void Page_Load(object sender, EventArgs e)
    >         {
    >             GMap1.enableDragging = false;
    >             GMap1.Language = "en";
    >             GMap1.BackColor = Color.White;
    >             GMap1.Key = "YOUR GOOGLE KEY";
    >             GMap1.CommercialKey="YOUR COMMERCIAL KEY";
    >         }
    >     }
    > } 
    > ```

*   在 cshtml 中：

    > @Html.Partial("Gmap")

** 有几点需要注意：

*   ascx 中的表单标签是必需的，没有它就无法工作。

*   该控件需要继承自 ViewUserControl 而不是 UserControl 才能与 razor 一起使用。

*   确保您拥有用于控制的密钥（Google、Commercial）。有关这些的详细信息，请参见控制站点。

*   如果您没有将控件放在与 cshtml 相同的文件夹中，则需要调整提供给 Partial 助手的路径。

谢谢至：

*   最后一点关于需要表单标签和基本示例的 subgurim 论坛。
*   [如何在 MVC 3 中将 WebForms .ascx 显示为部分视图，](https://stackoverflow.com/questions/14328835/how-to-display-webforms-ascx-as-partial-view-in-mvc-3)以了解如何将 ascx 加载到剃刀视图中。
*   如果我遗漏了什么，请放轻松，这是我的第一个。

我希望这会有所帮助 - 干杯，

安克尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T12:05:22.247

我是该项目的开发人员之一，我们正在开发适合 MVC（Razor 或其他选择的视图引擎）的新版本。当它准备好投入生产时，我会更新这个响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T10:49:57.053

我有同样的问题。

在我的项目（使用 MVC3 制作）中，我在 aspx 引擎中添加了一个局部视图（我网站的其余部分使用的是 razor）。我关注了 subgurim 教程网站。然后我添加了 google api 密钥，但即使一切正常，我也会得到一个灰色矩形！然后我在谷歌上找到了这篇文章：http: [//it.googlemaps.subgurim.net/Foro/general-discussions-perm5956-5963.aspx](http://it.googlemaps.subgurim.net/Foro/general-discussions-perm5956-5963.aspx)

:(

# django - Django 2 模型 1 形式

> ID：11512972
> 
> 赞同：2
> 
> 时间：2012-07-16T21:39:18.123
> 
> 标签：django, django-models, django-forms

所以，我仍然是 Django 的菜鸟，我想知道如何执行以下操作：

所以可以说我有类似下面的代码：

```
class UserProfile(models.Model):
    #Some fields
class UserProfileOther(models.Model):
    #Some other fields that I want in another table for organization
    user_profile = models.OneToOneField(UserProfile) 
```

我现在如何创建一个包含上述两个模型的表单？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T05:27:36.457

这种问题就是[内联表单集](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#inline-formsets)的设计目的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T00:43:37.527

您可以创建两个单独的 ModelForm 类。但在您看来，您必须为其实例添加前缀。

```
def viewname(request):
    if request.method == 'POST':
        form1 = forms.YourForm(request.POST, prefix="form1")
        form2 = forms.YourOtherForm(request.POST, prefix="form2")
        if form1.is_valid() and form2.is_valid():
            # process valid forms
    else:
        form1 = forms.YourForm(prefix="form1")
        form2 = forms.YourOtherForm(prefix="form2")

    .... 
```

使用前缀可确保名称相似的字段不会混淆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:49:34.153

我这样做的方式是基于第一个模型创建一个表单，然后基于继承第一个表单的第二个模型创建一个表单。意义：

类 UserProfileForm(ModelForm): ...

类 UserProfileOtherForm(UserProfileForm): ...

并传递`UserProfileOtherForm`到表单模板。它对我有用。不确定是否有更简单的方法。

# objective-c - 如何让 UIScrollView 跟踪一些东西？

> ID：11512974
> 
> 赞同：0
> 
> 时间：2012-07-16T21:39:19.897
> 
> 标签：objective-c, ios, xcode, uiscrollview

我希望我的应用程序能够在他二维向上移动时跟踪一个人。我已经有一个垂直滚动视图，它可以工作，但是当我按下一个按钮时，我希望它在他垂直行走时跟踪一个小人物，我该如何控制它？我想将 scrollview.contentoffset 设置为某个位置，但是当我希望它流畅地更改它时，它只会更改一次。我想我可以制作一个计时器，每隔 0.001 秒左右更新一次 contentOffSet，但我认为可能有更好的方法。

* * *

另外，当我搜索 UIScrollView 的方法时，其中一个是 isTracking 方法，它是一个布尔值，我假设如果滚动视图正在跟踪某些东西，它会返回是，所以假设我假设滚动视图中有一个功能所以你可以跟踪的东西。此外，如果要跟踪事物，您必须使用其他有助于了解的框架事物

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:50:09.497

该属性[`tracking`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/doc/uid/TP40006922-CH3-SW3)告诉滚动视图当前是否正在跟踪用户的移动。所以这绝对不会帮助你。（有关属性指示的更好解释，请参见 David H 的帖子。）

但是，您可以使用[`setContentOffset:animated:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/doc/uid/TP40006922-CH3-SW1)并设置`animated`为`YES`. 这会导致平滑过渡到新的内容偏移量。

您可能会发现指定包含简笔画的区域更容易，而不是计算合理的内容偏移量。如果是这样使用[`scrollRectToVisible:animated:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/doc/uid/TP40006922-CH3-SW26). 显然`animated`应该设置为`YES`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:53:14.103

1) 不要使用 contentOffset = x;，使用“- (void)setContentOffset:(CGPoint)contentOffset animated:(BOOL)animated”。试验一下您需要多久发送一次此消息，但我猜您每秒最多可以发送 10 次并获得不错的结果。

2) isTracking 表示用户将手指放在滚动视图上但尚未开始拖动它。通过测试“isTracking”和“isDragging”，您可以确定用户是否在摆弄您的滚动视图。

# powershell - Powershell：将电子邮件字符串转换为 Send-MailMessage cmdlet 的有效格式

> ID：11512976
> 
> 赞同：1
> 
> 时间：2012-07-16T21:39:29.397
> 
> 标签：powershell

因此，我尝试读取包含多个电子邮件地址的 CSV 文件中的字段，然后使用 Send-MailMessage cmdlet 发送到这些地址。地址字符串在 CSV 文件中如下所示。

```
john.doe@domain.com;jane.doe@domain.com 
```

发送的有效格式是：

```
("john.doe@domain.com", "jane.doe@domain.com") 
```

有没有人有将原始字符串转换为有效格式的好方法？

再次感谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:43:21.443

`-Split`您可以像这样使用 PowerShell运算符：

```
$emailstring = 'john.doe@domain.com;jane.doe@domain.com';
$emailarray  = $emailstring -split ';';
Send-MailMessage -To $emailarray ... ...; 
```

# php - 大文件中的shell脚本字符串替换

> ID：11512977
> 
> 赞同：0
> 
> 时间：2012-07-16T21:39:38.673
> 
> 标签：php, shell

我需要解析一个巨大的页面......有一些这样的字符串：

```
<li class="specialclass"><a href="http://some.changingurl.com" ..(some changing classes)..> 
```

我需要将以上内容更改为：

```
<li class="specialclass">http://some.changingurl.com<a href="http://some.changingurl.com" ..(some changing classes)..> 
```

然后稍后我可以删除所有 html 标签，但保留 url。只有网址在变化。

请帮我写一个替代品。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:42:34.763

```
sed -r 's/<a href="([^["]*)"/\1&/' input-file >new-file 
```

这个 oneliner 可以解决问题。

# groovy - 为什么 groovy .class 返回与 .getClass() 不同的值

> ID：11512978
> 
> 赞同：17
> 
> 时间：2012-07-16T21:39:39.387
> 
> 标签：groovy

根据[http://groovy.codehaus.org/Things+you+can+do+but+better+leave+undone](http://groovy.codehaus.org/Things+you+can+do+but+better+leave+undone)

> 1.  像访问属性一样访问对象的类型
> 
> 使用 .class 而不是 .getClass() 是可以的——只要你确切地知道你拥有什么样的对象。但是你根本不需要那个。否则，您将面临获得 null 或其他内容的风险，而不是对象的类。
> 
> a = [:] println a.class.simpleName // NullPointerException，因为 a.class 为空。

有人可以解释这是为什么吗？为什么`.class`返回的东西不同于`getClass()`

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-16T22:06:35.380

因为 when`a`是一个映射，`a.class`在 Groovy 中与`a.get( "class" )`. 正如您在文档中的示例中看到的那样，这将返回 null。这就是为什么规则倾向于使用 getClass 除非您绝对确定变量不会是地图

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-11-20T11:40:44.857

非映射示例是类型的类与实例的类之间的差异。实例的 .class 和 .getClass() 是它的类型，但有一些例外，例如映射。类型的 .class 是类型。类型的 .getClass() 是 java.lang.Class

例如：

```
def a = Integer.getClass()
def b = Integer.class
def c = 1.getClass()
def d = 1.class    

println a
println b
println c
println d 
```

将给出输出：

```
class java.lang.Class
class java.lang.Integer
class java.lang.Integer
class java.lang.Integer 
```

# json - 用于在复杂 JSON 中搜索的 Solr 设计

> ID：11512980
> 
> 赞同：1
> 
> 时间：2012-07-16T21:39:46.503
> 
> 标签：json, solr, solrj

使用 Solr 在复杂 JSON 中搜索的好设计是什么？例如，可能有这样的文件：

```
{
    "books" : [
        {
            "title" : "Some title",
            "author" : "Some author",
            "genres" : [
                "thriller",
                "drama"
             ]
        },
        {
            "title" : "Some other title",
            "author" : "Some author",
            "genres" : [
                "comedy",
                "nonfiction",
                "thriller"
             ]
         }
    ]
 } 
```

一个示例查询将获取所有具有作者为“某作者”且该书的类型之一为“戏剧”的书的文档。

现在我想出的设计是在 schema.xml 中有一个 dynamicField 将所有内容索引为文本（现在），如下所示：

```
 <dynamicField name="*" type="text" index="true" stored="true"/> 
```

然后 SolrJ 用于解析 JSON 并创建一个 SolrInputDocument，其中包含每条数据的字段。例如，这些是将为上面的示例 JSON 创建的字段/值：

```
books0.title : "Some title"
books0.author : "Some author"
books0.genres0 : "thriller"
books0.genres1 : "drama"
books1.title : "Some other title"
books1.author : "Some author"
books1.genres0 : "comedy"
books1.genres1 : "nonfiction"
books1.genres2 : "thriller" 
```

此时我们可以使用 LukeRequestHandler 获取索引中的所有字段，然后进行一个大的 Solr 查询来检查我们感兴趣的所有字段。对于上面的示例查询，查询将检查所有“books#.author”和“books#.genres#”字段。这个解决方案看起来不优雅，如果有很多字段，查询可能会变得非常大。

能够在字段名称中使用通配符会很有用，但我认为 Solr 不可能。

有没有更好的方法来实现这一点，可能是通过在模式中使用“copyField”和“multiValued”的一些巧妙组合？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T04:33:16.893

您可以将书籍实体索引为文档。

```
<field name="id" type="string" indexed="true" stored="true" required="true" />  
<field name="title" type="text_general" indexed="true" stored="true"/>   
<!-- Don't perform stemming on authors - You can use field with lower case, ascii folding for analysis -->   
<field name="authors" type="string" indexed="true" stored="true" multiValued="true"/>  
<field name="genre" type="string" indexed="true" stored="true" multiValued="true"/> 
```

使用[Dismax 解析器](http://wiki.apache.org/solr/DisMax)搜索作者和流派。
在这些字段上匹配应该会返回文档。
您也可以使用流派过滤[器查询](http://wiki.apache.org/solr/CommonQueryParameters#fq)进行过滤，例如 fq=genre:drama

如果您希望字段的搜索行为不同，您可以简单地使用[copyField](http://wiki.apache.org/solr/SchemaXml#Copy_Fields)复制字段并对它们执行不同的分析。例如

```
<field name="genre_search" type="text_general" indexed="true" stored="true" multiValued="true"/>

<copyField source="genre" dest="genre_search"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:24:12.257

也许值得你看看[Solr Joins](http://wiki.apache.org/solr/Join)。它仅在 4.0 中可用，现在在 alpha 版本中，但可以让您至少对部分或所有这些复杂关系进行建模。性能不如没有连接的 vanilla solr，但可能完全有效，您应该验证。

# git - 如何制作脚本来更新 git 子模块？

> ID：11512984
> 
> 赞同：0
> 
> 时间：2012-07-16T21:40:26.463
> 
> 标签：git

我有一个添加了子模块的项目。问题是，我总是希望这些子模块与当前版本保持同步。我如何总是告诉这些子模块寻找最新的提交并与之同步？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:42:12.953

git 子模块 foreach 真的很方便。

```
git submodule foreach git pull 
```

这将在所有子模块中执行拉取（即提取/合并）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-31T16:09:34.260

> 子模块来查找最新的提交并与之同步

Marcus Johansson 的回答解释了如何使子模块针对它们各自的来源获得最新（如果您的主要项目是游戏，但它包含一个图形和逻辑库作为子模块，那么图形和逻辑库将是最新的）。

如果您希望将子模块更新为主项目使用的最新版本（在我的示例中为“游戏”），那么您可以使用

```
git pull --recurse-submodules 
```

当您更新主项目以更新子模块时。此外，您可以随时使用

```
git submodule update --init 
```

将您的子模块更新到主项目的版本。

当您的主项目需要与库的版本保持同步时，这很有用（如果更新库会更改其 API，您只想在有人更新主项目以匹配时更新它）。

另请参阅[此答案](https://stackoverflow.com/a/17163981/79125)。

# android - 如何正确更新通知发布 api 11？

> ID：11512986
> 
> 赞同：18
> 
> 时间：2012-07-16T21:40:39.657
> 
> 标签：android, android-notifications, android-4.2-jelly-bean

*   在[`Notification.Builder`](http://developer.android.com/reference/android/app/Notification.Builder.html)出现之前[，更新](http://developer.android.com/guide/topics/ui/notifiers/notifications.html#Updating)已经在通知托盘中的通知的方法是调用`setLatestEventInfo()`，然后通过`NotificationManager.notify()`调用将通知发回，其 ID 与`notify()`您拨打的第一个电话相匹配。

*   现在[`setLatestEventInfo()`](http://developer.android.com/reference/android/app/Notification.html#setLatestEventInfo%28android.content.Context,%20java.lang.CharSequence,%20java.lang.CharSequence,%20android.app.PendingIntent%29)不推荐使用消息：`Use Notification.Builder`而是。但我找不到任何有关如何使用`Notification.Builder`.

*   `Notification`您是否只是假设每次需要更新通知时都重新创建一个新实例？然后简单地将其传递给`NotificationManager.notify()`您之前使用的 ID？

*   它似乎有效，但我想看看是否有人有任何官方证实这是新的“这样做的方式”？

**我问这个的真正原因**是因为在 中`Android 4.1.1 Jelly Bean`，通知现在每次`notify()`被调用时都会闪烁。当用这个更新进度条[`setProgress()`](http://developer.android.com/reference/android/app/Notification.Builder.html#setProgress%28int,%20int,%20boolean%29)看起来真的很糟糕并且很难点击通知。在 4.1 或以前的版本中不是这种情况。所以我想在提交错误之前确保我正确地执行了此操作。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-18T22:50:34.847

我通过调用`setWhen(0)`我的 Notification.Builder 解决了这个问题。在整个通知淡出/淡入的情况下，Android 的此参数的默认值似乎不适合更新通知视图的位。

```
Notification.Builder builder = new Notification.Builder(c)
                .setContentTitle("Notification Title")
                .setSmallIcon(R.drawable.ic_notification_icon)
                .setProgress(max_progress,current_progress,false)
                .setWhen(0);
                notification = builder.getNotification();

mNotificationManager.notify(NOTIFICATION_ID, notification); 
```

## 更新：

正如[WolframRittmeyer](https://stackoverflow.com/questions/11512986/how-to-properly-update-a-notification-post-api-11#comment41810560_12486197)所说，使用`when=0`不是一种优雅的方式。我形成了如下解决方案：

```
if(mNotif == null) {
//either setting mNotif first time
//or was lost when app went to background/low memory
    mNotif = createNewNotification();
}
else {
    long oldWhen = mNotif.when;
    mNotif = createNewNotification();
    mNotif.when = oldWhen;
}
mNotificationManager.notify(NOTIFICATION_ID, mNotif); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-09T14:00:47.650

您所做的是正确的，您只是缺少可以设置的标志。我不知道您的特定通知实现，但您可以考虑使用：

```
setOngoing(boolean ongoing) 
```

或者

```
setOnlyAlertOnce(boolean onlyAlertOnce) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T13:43:18.547

我猜（因为我刚才遇到了同样的麻烦）您在通知中使用了 RemoteView。我设法更新通知而不像这样闪烁：

```
RemoteViews views;
if( this.mNotification == null) {
    views = new RemoteViews(getPackageName(), R.layout.notification);
    this.mNotification = new Notification.Builder(this)
        .setContent(views)
        .setSmallIcon(R.drawable.status_icon)
        .setContentIntent(mNotificationAction)
        .setOngoing(true)
        .setOnlyAlertOnce(true)
        .getNotification();
} else {
    views = this.mNotification.contentView;
} 
```

感谢@seanmonstar 回答[通知栏中的刷新进度条](https://stackoverflow.com/questions/2689729/refresh-progress-bar-in-notification-bar)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-21T17:53:12.963

此处描述的解决方案效果很好：[悄悄更新正在进行的通知](https://stackoverflow.com/questions/6406730/updating-an-ongoing-notification-quietly/15538209#15538209)

关键是用来重用builder和setOnlyAlertOnce(true)：

```
if (firstTime) {
  mBuilder.setSmallIcon(R.drawable.icon)
  .setContentTitle("My Notification") 
  .setOnlyAlertOnce(true); 
  firstTime = false;
} 
mBuilder.setContentText(message)
.setProgress(100, progress, true);

mNotificationManager.notify(mNotificationId, mBuilder.build()); 
```

# css - 只显示第一个字母

> ID：11512989
> 
> 赞同：23
> 
> 时间：2012-07-16T21:41:05.133
> 
> 标签：css, pseudo-element

让我们说这个标记：

```
<div id="socialMedia">
    <a class="Twitter">Twitter</a>
</div> 
```

我想要的只是可见文本的第一个字母（在这种情况下，只是一个 T）

（实际上我最终不会使用它，但我对此感到好奇；以后肯定会有所帮助）

所以这是我的尝试：

```
#socialMedia .Twitter{
    display:none;
}
#socialMedia .Twitter:first-letter {
    display: block !important;
} 
```

我能够检查它不会实现它。问题是为什么？有一些解决方法吗？

-编辑-

我们正在寻找支持 IE=+7/8 版本的解决方案..

致敬

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-09-03T08:37:39.827

尝试这样的事情：

```
.Twitter {
  font-size: 0;
}

.Twitter:first-letter {
  font-size: 12px;
}
```

```
<div class="Twitter">Twitter</div>
```

也许这不是最好的解决方案，但它确实有效。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-07-16T22:32:04.903

**编辑：免责声明：根据评论，这不起作用。请不要在没有检查它是否符合您的需求的情况下按原样使用。**

如果您检查`:first-letter`伪元素的规范，您会注意到以下内容：

> :first-letter 伪元素必须选择块第一行的第一个字母，如果它的行上没有任何其他内容（例如图像或内联表）。

这里重要的词是“块”。

`<a/>`您正在尝试在类别为 的标签上使用伪元素`Twitter`。默认情况下，锚标签是内联元素（不是块级元素）。

对于您给定的标记，您的问题的一种解决方案是以这种方式设置锚的样式：

```
.Twitter {
    display:block;
    visibility:hidden;
}

.Twitter:first-letter {
    visibility:visible;
}​ 
```

我不确定您到底要做什么，但这对于实验目的来说已经足够了。在此处查看演示：http: [//jsfiddle.net/H7jhF/](http://jsfiddle.net/H7jhF/)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-04-20T22:09:51.257

另一种方法是使用`color: transparent`

```
.twitter{
  display: block;
  color: transparent;
}

.twitter:first-letter{
  color: #000;
}
```

```
<div id="socialMedia">
    <a class="twitter">Twitter</a>
</div>
```

[JSFiddle](https://jsfiddle.net/ygunfy5g/)

* * *

但是，这不适用于**lte** IE8。

参考：

*   [IE7 IE8 IE9`color:transparent`属性](https://stackoverflow.com/questions/10110547/ie7-ie8-ie9-colortransparent-property)
*   [`color: transparent`在 Internet Explorer 中不工作](https://stackoverflow.com/questions/3171586/color-transparent-is-not-working-in-internet-explorer.)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-16T21:49:06.630

你所做的就像隐藏一个父元素并试图显示它的一个子元素，它不会起作用，因为父元素的样式会覆盖它。父元素也必须是块级元素才能工作。就像一个`div`或`p`标签，或`display: block;`在`a`标签上。

这是使用颜色的东西：

HTML

```
<div id="socialMedia">
    <a class="Twitter">Twitter</a>
</div> 
```

CSS

```
body {
  background-color:#FFF;
}
.Twitter{
    display: block;
    color:#FFF;
}
.Twitter:first-letter {
    color:#000;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-11-01T02:10:01.950

从页面上拍摄内容并使用动态内容显示字母：

```
 .twitter{
    text-indent:-9999px;
    display:block; 
    position:relative;
}
.twitter:before,.twitter::before{
    content:"T";
     position:absolute;
    width:10px;
    height:15px;
    z-index:100; 
    text-indent:9999px;
} 
```

在这个小提琴中发挥作用：http:
[//jsfiddle.net/jalbertbowdenii/H7jhF/67/](http://jsfiddle.net/jalbertbowdenii/H7jhF/67/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-16T21:53:52.193

为什么不直接使用 JavaScript 并将字符串拆分为数组并使用数组中的第一项。或 charAt()

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-11-01T01:53:54.067

纯 CSS 答案使用可见性和颜色技巧来隐藏剩余的字母，但它们仍然存在并影响布局。它可能会导致布局问题，例如，如果您希望浮动元素并在其旁边放置一些东西。

我找到了一种有趣的方法来做到这一点，而无需隐藏元素。诀窍是将整个单词缩小到几乎没有，然后只炸掉第一个字母。这有点像 OP 试图做的事情，但它之所以有效，是因为它在连续频谱上运行，而不是`display: none`仅仅关闭其中的任何东西。（一种模拟>数字的情况。）

[演示](http://jsbin.com/fafiyi/1/edit?html,css,output)

HTML：

```
<div>Ding Dong</div> and other stuff 
```

CSS：

```
div {
  font-size: 0.0000016px;
  float: left;
}

div::first-letter {
  color: red;
  font-size: 10000000em;
} 
```

结果：

![http://i.imgur.com/3WeNZ55.png](../Images/9fb57a738a6c5f5d2e9ea7385c92bd0d.png)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-11-06T12:58:49.383

这就是我所做的：

```
.Twitter{
        display:block;
        width:1ch;
        overflow:hidden;
        white-space: nowrap;
    } 
```

# osx-lion - 尝试使用 ONI 录制时“功能未实现”

> ID：11512990
> 
> 赞同：0
> 
> 时间：2012-07-16T21:41:07.050
> 
> 标签：osx-lion, kinect, playback, recording, openni

我正在尝试`oni`使用 OpenNI 在我的应用程序中使用录音。这是我的`xml`文件：

```
<OpenNI>
    <Licenses>
        <!-- Add application-specific licenses here 
        <License vendor="vendor" key="key"/>
        -->
    </Licenses>
    <Log writeToConsole="false" writeToFile="false">
        <!-- 0 - Verbose, 1 - Info, 2 - Warning, 3 - Error (default) -->
        <LogLevel value="3"/>
        <Masks>
            <Mask name="ALL" on="true"/>
        </Masks>
        <Dumps>
        </Dumps>
    </Log>
    <ProductionNodes>
        <Recording file="Recording.oni" />

        <!-- Set global mirror -->
        <GlobalMirror on="true"/>

    </ProductionNodes>
</OpenNI> 
```

一切看起来都不错，但是当我尝试运行我的程序时，我得到：

```
Open failed: Function was not implemented! 
```

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:41:07.050

问题是以下两行：

```
 <!-- Set global mirror -->
    <GlobalMirror on="true"/> 
```

删除它们后，我的程序运行良好。

# php - 如何解析mysql表中的列，如“ <14-abc>;<8-def>;

> ID：11512992
> 
> 赞同：-2
> 
> 时间：2012-07-16T21:41:10.140
> 
> 标签：php, mysql, parsing

如何解析mysql表中的列， `<14-abc>;<8-def>;` 如：

```
abc =14
def = 8 
```

abc 存储值 14 和 def 存储值 8 并具有多个条目。

因此需要存储类似的数组或列表，以便以后能够访问和处理解析的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:57:01.360

我不知道有任何解析器支持这种语法，因此您可以为如此琐碎的事情编写自己的解析器。这是一个示例，未经测试：

```
$row = ' <14-abc>;<8-def>; ';

$output = Array();
$entries = explode(';', $row);              //Split the row by every ';' delimiter
foreach ($entries as $item) {               //For each entries
    if (!empty($item)) {                    //Make sure the item isn't empty (last entry might be)
        $item = str_replace(' ','',$item);  //Remove useless char
        $item = str_replace('<','',$item);  //Remove useless char
        $item = str_replace('>','',$item);  //Remove useless char
        $params = explode('-', $item);      //Again, subsplit the key and the value from the item
        $output[$params[1]] = $params[0];   //Push them into an array
    }
} 
```

然后你可以像这样使用你很棒的数组：

```
foreach ($output as $key=>$value) {
    echo $key.'='.$value;
} 
```

输入是一个`$row`字符串，输出是一个`$output`数组。你甚至可以将它包装成一个函数；）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-08T18:20:56.657

```
?php

function parser($row)
{
$output = Array();

$entries = explode(';', $row);       //Split the row by every ';' delimiter
foreach ($entries as $item) {                   //For each entries
    if (!empty($item)) {                        //Make sure the item isn't empty (last entry might be)
        $item = str_replace(' ','',$item);      //Remove extra char
        $item = str_replace('<','',$item);      //Remove extra char
        $item = str_replace('>','',$item);      //Remove extra char
        $params = explode('-', $item);          //Again, subsplit the key and the value from the item
        $output[$params[1]] = $params[0];       //Push them into an array
    }
}
foreach ($output as $key=>$value) {

    $sql1 = "INSERT INTO `tablename`(`column name`, `column name`) VALUES ('$key','$value')";
    mysql_query($sql1); 

    }
}
?> 
```

这完成了所有工作。定义解析器函数，解析数据并将结果插入数据库

# java - SQLite 数据库列表视图

> ID：11512993
> 
> 赞同：0
> 
> 时间：2012-07-16T21:41:20.790
> 
> 标签：java, android, sqlite, listview, cursor

我创建了一个带有游标的数据库。我想在列表视图中显示它。这是我的活动文件：

```
package com.ucas.course;

import java.util.List;

import org.w3c.dom.Comment;

import android.app.Activity;
import android.app.ListActivity;
import android.os.Bundle;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.SimpleCursorAdapter;
import android.widget.TextView;

public class SQLView extends ListActivity {

 public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.list_example);
        UCAS info = new UCAS(this);
        info.open();
        String values = info.getData();
        info.close();
        AString[] columns = new String[] {UCAS.KEY_UNIVERSITY};
        int[] to = new int[] { R.id.name_entry, R.id.number_entry };
        startManagingCursor(c);
        SimpleCursorAdapter mAdapter = new SimpleCursorAdapter(this, R.layout.sqlview, c, columns, to);
        this.setListAdapter(mAdapter);

 }

} 
```

目前除了一个光标错误“fillWindow（）中的无效语句”之外没有任何错误，我不知道这是否与我的问题有关，但是当我开始活动时，我只是得到一个空白屏幕

```
public Cursor getData() {
    // TODO Auto-generated method stub
    String[] columns = new String[]{KEY_ROWID, KEY_UNIVERSITY, KEY_OFFER};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, null, null, null, null, null);

    return c;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:23:16.413

列表可以并且在您的情况下应该使用游标来支持其数据。您没有理由构建一个结果字符串来保存您的查询值。您可以将光标直接传递给适配器。

```
public String getData() {
     String[] columns = new String[]{KEY_ROWID, KEY_UNIVERSITY, 
         KEY_COURSE, KEY_UCAS, KEY_SATISFACTION, KEY_EMPLOYED, 
         KEY_OFFER, KEY_OTHER};

     Cursor c = ourDatabase.query(DATABASE_TABLE, 
         columns, null, null, null, null, null);

     return c;

} 
```

获得光标后，使用 SimpleCursorAdapter 将其绑定到 ListActivity。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T10:03:59.797

你的功能有很小的变化

```
 public String getData() {
     String[] columns = new String[]{KEY_ROWID, KEY_UNIVERSITY, 
         KEY_COURSE, KEY_UCAS, KEY_SATISFACTION, KEY_EMPLOYED, 
         KEY_OFFER, KEY_OTHER};

     Cursor c = mDBHelper.getReadableDatabase.query(DATABASE_TABLE, 
         columns, null, null, null, null, null);

     return c;

} 
```

# google-drive-api - Google Drive API Files.List 查询字符串 - “非”运算符

> ID：11512999
> 
> 赞同：1
> 
> 时间：2012-07-16T21:41:55.013
> 
> 标签：google-drive-api

类似于[Google Drive API Files.List Query String](https://stackoverflow.com/questions/11457235/google-drive-api-files-list-query-string)这个问题，我想知道 setQ 方法的所有语法： FileList files = drive.files().list() .setQ("trashed=true") .setMaxResults(100) .execute();

特别是我想从查询中获取文件（不是文件夹）。

要获取文件夹，此查询有效：`request.Q = "mimeType='application/vnd.google-apps.folder' and trashed=false "`

我尝试过不同的组合，比如

```
request.Q = "not mimeType='application/vnd.google-apps.folder' and trashed=false "
request.Q = "mimeType!='application/vnd.google-apps.folder' and trashed=false " 
```

ETC

有些运行但忽略不，有些只是崩溃。

有没有办法获取唯一文件的列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T23:24:48.793

答案似乎很旧，目前googlde drive api accept != operator。

希望它有所帮助，阿尔瓦罗。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:57:44.700

Drive API 查询语言中目前没有否定，抱歉！这是我们应该考虑添加的一个很棒的功能。