# StackOverflow 问答 10000-10999

# wcf - 在 Silverlight 中向 WCF 添加压缩的最简单方法是什么？

> ID：10006
> 
> 赞同：24
> 
> 时间：2008-08-13T16:08:43.680
> 
> 标签：wcf, silverlight, compression, gzip

我有一个访问 WCF Web 服务的 silverlight 2 beta 2 应用程序。正因为如此，它目前只能使用 basicHttp 绑定。Web 服务将返回相当大量的 XML 数据。从带宽使用的角度来看，这似乎是相当浪费的，因为响应，如果压缩，会小 5 倍（我实际上将响应粘贴到一个 txt 文件并压缩它。）。

该请求确实具有“Accept-Encoding: gzip, deflate” - 有什么方法可以让 WCF 服务 gzip（或以其他方式压缩）响应？

我确实找到了这个[链接](http://www.vistax64.com/indigo/113763-wcf-client-j2ee-server-using-gzip.html)，但对于应该开箱即用的功能来说，它确实似乎有点复杂恕我直言。

好的 - 起初我使用 System.IO.Compression 作为答案标记了解决方案，因为我永远无法“似乎”让 IIS7 动态压缩工作。好吧，事实证明：

1.  IIS7 上的动态压缩**一直在**工作。只是 Nikhil 的 IE Web Developer Helper 插件没有显示它工作。我的猜测是，由于 SL 将 Web 服务调用交给浏览器，浏览器会“在幕后”处理它，而 Nikhil 的工具永远不会看到压缩响应。我能够通过使用监视浏览器应用程序外部流量的 Fiddler 来确认这一点。在提琴手中，响应实际上是 gzip 压缩的！

2.  System.IO.Compression 解决方案的另一个问题是 Silverlight CLR 中不存在 System.IO.Compression。

所以从我的角度来看，在 Silverlight 中启用 WCF 压缩的最简单方法是在 IIS7 中启用动态压缩并且根本不编写任何代码。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-12T01:47:06.687

WCF 的 WS-Compression 允许您在绑定上配置压缩。

请参阅Pablo M. Cibraro[的 WCF 的 WS-Compression](http://weblogs.asp.net/cibrax/WS_2D00_Compression-for-WCF)

或者，尝试 Microsoft的[GZip 编码器示例](http://msdn.microsoft.com/en-us/library/cc138373.aspx)，它“创建一个使用 System.IO.Compression.GZipStream 类来压缩传出 WCF 消息的编码器通道”

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-08-13T16:28:06.933

最近在做 WCF 项目时，我没有看到 WCF 进行压缩的原生方式。我刚刚使用了 System.IO.Compression 命名空间并制作了一个快速压缩器。这是我使用的代码

```
public static class CompressedSerializer
{
    /// <summary>
    /// Decompresses the specified compressed data.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="compressedData">The compressed data.</param>
    /// <returns></returns>
    public static T Decompress<T>(byte[] compressedData) where T : class
    {
        T result = null;
        using (MemoryStream memory = new MemoryStream())
        {
            memory.Write(compressedData, 0, compressedData.Length);
            memory.Position = 0L;

            using (GZipStream zip= new GZipStream(memory, CompressionMode.Decompress, true))
            {
                zip.Flush();
                var formatter = new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter();
                result = formatter.Deserialize(zip) as T;
            }
        }

        return result;
    }

    /// <summary>
    /// Compresses the specified data.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="data">The data.</param>
    /// <returns></returns>
    public static byte[] Compress<T>(T data)
    {
        byte[] result = null;
        using (MemoryStream memory = new MemoryStream())
        {
            using (GZipStream zip= new GZipStream(memory, CompressionMode.Compress, true))
            {
                var formatter = new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter();
                formatter.Serialize(zip, data);
            }

            result = memory.ToArray();
        }

        return result;
    }
} 
```

然后我只是让我的服务接受一个字节数组作为输入，就像这样

```
void ReceiveData(byte[] data); 
```

对我来说效果很好。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-08-13T18:22:03.273

如果您使用的是 IIS7，请查看[Compression Module](http://blogs.iis.net/ksingla/archive/2006/06/13/changes-to-compression-in-iis7.aspx)。这允许您为对服务器的 HTTP 请求配置压缩。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-16T17:24:33.160

还应该注意的是，除了为站点启用压缩之外，您可能还需要将 mime 类型添加到`applicationHost.config`下面的部分：`<httpCompression><dynamicTypes>`

```
<add mimeType="application/soap+msbin1" enabled="true" /> 
```

如果某些动态响应没有被压缩（有些是），则可能是 mime 类型的问题。使用 Fiddler 获取与请求相关的细节。失败的请求跟踪可能有助于确定 IIS 是否甚至尝试压缩响应。如果压缩配置正确，您将在跟踪输出`NO_MATCHING_CONTENT_TYPE`的**完整跟踪**部分看到一个。

# javascript - javascript中的动画，一个起点

> ID：10038
> 
> 赞同：9
> 
> 时间：2008-08-13T16:26:10.463
> 
> 标签：javascript, animation

我了解 JS 是如何运行的，并且我想我了解大部分 DOM，但我对动画一无所知。这里有没有人知道一个很好的指南可以向我解释它是如何在 Javascript 中完成的？

另外，我什至应该考虑使用 Javascript 制作动画吗？我应该改为学习 Flash 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-08-13T16:36:44.780

避免使用 flash，这是一个可怕的要求，Google 无法抓取，一堆浏览器和系统（例如 iPhone）不支持，最重要的是：它迫使您重新发明 Web 标准（例如滚动条和诸如此类），另一方面，Javascript 更容易在 noscript 案例中维护和编码。

为您的动画尝试[脚本](http://script.aculo.us/)；

*   [这是一个快速的 3 行教程，因此您可以看到它的工作原理](http://woork.blogspot.com/2008/01/toggle-effect-using-scriptaculous.html)
*   [这是一个更完整的教程](http://www.tutorialspoint.com/script.aculo.us/index.htm)
*   [这是scriptaculous wiki](http://github.com/madrobby/scriptaculous/wikis)

请注意，有大量的 JS 动画库，我想到了一些非常好的[jQuery 。](http://jquery.com/)通常它们只是一个脚本标签和一个要设置的 onclick 事件。

祝你好运！

/mp

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-08-13T16:32:37.503

如果你的动画很简单，随着时间的推移改变颜色，在 3 秒内从 x 移动到 y。Javascript很好。如果你想要各种wizbang按钮和屏幕的协调旋转，那么直接js + dhtml充其量是笨拙的。Silverlight vs Flash 是你当时的问题。有趣的是，您使用 javascript 对 Silverlight 进行编程，这将是简单升级到更快、更动态的 DOM 的主要好处，该 DOM 在 Silverlight 中实现，但仍编写相同的代码。根据我的经验，Flash 的可编程性非常有限，你可以做任何事情，但它会很慢并且需要数千行代码才能到达那里。对于简单的 JS 动画，请查看 jQuery 或 Scriptaculous。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-13T16:36:38.493

查看像 Bernard Sumption 的[Animator.js](http://web.archive.org/web/20101028234136/http://berniecode.com/writing/animator.html)这样的 JS 动画框架。它的重量很轻，并且有一些很好的例子。

就个人而言，我不会在 JS 中制作动画。闪存 FTW。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-08-25T21:28:27.033

如果您不关心 IE 支持，您也可以尝试使用 canvas 元素：

MOZILLA DEVELOPER NETWORK[基本动画](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Basic_animations)

# java - 如何在 Java 中创建链表数据结构？

> ID：10042
> 
> 赞同：136
> 
> 时间：2008-08-13T16:29:22.063
> 
> 标签：java, data-structures, linked-list

用Java制作链表的最佳方法是什么？

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2008-08-24T20:03:56.310

对于熟悉 Java 的开发人员来说，显而易见的解决方案是使用**java.util 中**已经提供的**LinkedList**类。但是，假设您出于某种原因想要进行自己的实现。这是一个链接列表的快速示例，它在列表的开头插入一个新链接，从列表的开头删除并循环遍历列表以打印其中包含的链接。**对此实现的增强**包括使其成为**双链表**，添加从中间或末尾**插入**和**删除的方法，以及添加****get**和**sort**方法。

 ********注意**：在示例中，Link 对象实际上并不包含另一个 Link 对象 - *nextLink*实际上只是对另一个链接的引用。

```
class Link {
    public int data1;
    public double data2;
    public Link nextLink;

    //Link constructor
    public Link(int d1, double d2) {
        data1 = d1;
        data2 = d2;
    }

    //Print Link data
    public void printLink() {
        System.out.print("{" + data1 + ", " + data2 + "} ");
    }
}

class LinkList {
    private Link first;

    //LinkList constructor
    public LinkList() {
        first = null;
    }

    //Returns true if list is empty
    public boolean isEmpty() {
        return first == null;
    }

    //Inserts a new Link at the first of the list
    public void insert(int d1, double d2) {
        Link link = new Link(d1, d2);
        link.nextLink = first;
        first = link;
    }

    //Deletes the link at the first of the list
    public Link delete() {
        Link temp = first;
        if(first == null){
         return null;
         //throw new NoSuchElementException(); // this is the better way. 
        }
        first = first.nextLink;
        return temp;
    }

    //Prints list data
    public void printList() {
        Link currentLink = first;
        System.out.print("List: ");
        while(currentLink != null) {
            currentLink.printLink();
            currentLink = currentLink.nextLink;
        }
        System.out.println("");
    }
}  

class LinkListTest {
    public static void main(String[] args) {
        LinkList list = new LinkList();

        list.insert(1, 1.01);
        list.insert(2, 2.02);
        list.insert(3, 3.03);
        list.insert(4, 4.04);
        list.insert(5, 5.05);

        list.printList();

        while(!list.isEmpty()) {
            Link deletedLink = list.delete();
            System.out.print("deleted: ");
            deletedLink.printLink();
            System.out.println("");
        }
        list.printList();
    }
} 
```

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-08-13T16:35:02.990

Java 有一个[LinkedList](http://java.sun.com/j2se/1.5.0/docs/api/java/util/LinkedList.html)实现，你可能想看看。[您可以在java.sun.com](http://java.sun.com/javase/downloads/index.jsp)下载 JDK 及其源代码。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-08-15T16:11:25.190

使用[java.util.LinkedList](http://java.sun.com/j2se/1.5.0/docs/api/java/util/LinkedList.html)。像这样：

```
list = new java.util.LinkedList() 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-12-26T17:13:25.753

上面的链表以相反的方向显示。我认为插入方法的正确实现应该是

```
public void insert(int d1, double d2) { 
    Link link = new Link(d1, d2); 

    if(first==null){
        link.nextLink = null;
        first = link; 
        last=link;
    }
    else{
        last.nextLink=link;
        link.nextLink=null;
        last=link;
    }
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-27T17:14:20.560

使用 java.util.LinkedList 要好得多，因为它可能比您将编写的优化得多。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-07-13T05:32:05.193

```
//slightly improved code without using collection framework

package com.test;

public class TestClass {

    private static Link last;
    private static Link first;

    public static void main(String[] args) {

        //Inserting
        for(int i=0;i<5;i++){
            Link.insert(i+5);
        }
        Link.printList();

        //Deleting
        Link.deletefromFirst();
        Link.printList();
    }

    protected  static class Link {
        private int data;
        private Link nextlink;

        public Link(int d1) {
            this.data = d1;
        }

        public static void insert(int d1) {
            Link a = new Link(d1);
            a.nextlink = null;
            if (first != null) {
                last.nextlink = a;
                last = a;
            } else {
                first = a;
                last = a;
            }
            System.out.println("Inserted -:"+d1);
        }

        public static void deletefromFirst() {
            if(null!=first)
            {
                System.out.println("Deleting -:"+first.data);
                first = first.nextlink;
            }
            else{
                System.out.println("No elements in Linked List");
            }
        }

        public static void printList() {
            System.out.println("Elements in the list are");
            System.out.println("-------------------------");
            Link temp = first;
            while (temp != null) {
                System.out.println(temp.data);
                temp = temp.nextlink;
            }
        }
    }
} 
```******

# .net - .NET：打开文件夹重定向时如何找到桌面路径？

> ID：10043
> 
> 赞同：3
> 
> 时间：2008-08-13T16:29:56.883
> 
> 标签：.net

我一直在使用

> Environment.GetFolderPath(Environment.SpecialFolder.Desktop)

现在获取用户桌面的路径已经很久了，但是由于我们在工作中更改了此处的设置，因此我们使用文件夹重定向将用户的**桌面**和**我的文档**文件夹映射到服务器，它不再有效。它仍然指向**C:\Documents and Settings中的****Desktop**文件夹，这不是我的桌面所在的位置。

 **有想法该怎么解决这个吗？

伯恩斯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-08-13T16:54:08.973

您需要改用 DesktopDirectory 特殊文件夹：

`Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory)`

应该给你重定向的目录。**

# c++ - 从 Windows 标题栏中删除图标而不放弃关闭按钮或系统菜单？

> ID：10059
> 
> 赞同：7
> 
> 时间：2008-08-13T16:42:40.570
> 
> 标签：c++, windows, user-interface, mfc

我正在开发一个 MFC 应用程序，我最近一直在寻找一种从 Windows 标题栏中删除图标但保留关闭按钮的好方法。两个明显的候选解决方案是关闭系统菜单样式或使用工具窗口样式，但我不希望禁用系统菜单或使用缩小的工具窗口标题栏。许多 MFC 应用程序都有这个功能，所以我想知道：我是否缺少一些标准的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T13:43:34.090

设置`WS_EX_DLGMODALFRAME`扩展样式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-08-14T01:28:13.567

您可以使用`WM_NCRBUTTONDOWN`来检测用户是否右键单击您的标题，然后调出系统菜单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-05T21:04:39.117

您可以使用完全透明的图标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-08-13T17:12:52.490

摆脱系统菜单然后将其放回您自己的另一个地方（比如关闭按钮旁边等）怎么样？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-14T00:49:13.007

如果没有图标，我可以想象用户访问系统菜单的唯一方法是通过右键单击标题栏。

如果这是您的想法，您可以在主框架上处理 WM_RBUTTONDOWN，然后计算右键单击是否在标题栏上。

```
int clickX = GET_X_LPARAM(lParam);
int clickY = GET_Y_LPARAM(lParam);

CRect frameRect;
mainFrame.GetWindowRect(&frameRect);

int titleBarHeight = GetSystemMetrics(SM_CYCAPTION);

if (clickX >= frameRect.left &&
    clickX <= frameRect.right &&
    clickY >= frameRect.top &&
    clickY <= frameRect.top + titleBarHeight)
{
   TrackPopupMenu(m_systemMenu);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-11T17:22:24.877

Delphi中删除图标的示例代码：

```
const
  WM_ResetIcon = WM_APP - 1;

type
  TForm1 = class(TForm)
    procedure FormShow(Sender: TObject);
  protected
    procedure WMResetIcon(var Message: TMessage); message WM_ResetIcon;
  end;

implementation

procedure TForm1.FormShow(Sender: TObject);
begin
  PostMessage(Handle, WM_ResetIcon, 0, 0);
end;

procedure TForm1.WMResetIcon(var Message: TMessage);
const
  ICON_SMALL = 0;
  ICON_BIG   = 1;
begin
  DestroyIcon(SendMessage(Handle, WM_SETICON, ICON_BIG, 0));
  DestroyIcon(SendMessage(Handle, WM_SETICON, ICON_SMALL, 0));
end; 
```

类似的代码应该适用于 MFC。基本上，您只需要将 WM_SETICON 设置为 NULL 在正确的位置。

# api - 寻找具有良好 API 的 GPS

> ID：10061
> 
> 赞同：3
> 
> 时间：2008-08-13T16:45:03.000
> 
> 标签：api, gps

我正在寻找具有良好 API 的 GPS。我希望能够向它发送一个地址，并告诉它导航到该地址。我还需要从 GPS 中提取当前位置。我希望能够通过蓝牙甚至只是 USB 电缆将 GPS 连接到笔记本电脑上来做到这一点。

我看了一点 Dash，但每月订阅是一个缺点。另外，我想在我们的专用网络上保留位置和地址。

我是一名 .NET 程序员，所以 .NET 友好的 API 最适合我。

如果您可以向我展示一些使用 API 将数据推送到 GPS 和从 GPS 拉取数据的示例，则可以获得奖励积分。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-08-13T16:50:28.323

如果您想与 Garmin GPS 通话，可以查看他们的[开发者网站](http://developer.garmin.com)。他们拥有从与 Web 服务交谈到进行低级串行和 USB I/O 以直接与设备交互的各种资源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T20:27:03.323

使用运行 WM 的 GPS 手机怎么样？我有摩托罗拉 Q9c。我正在研究 GPS 数据记录器，以便绘制我的航班图。windows mobile SDK 有一个很棒的 C# 示例可以使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T16:30:01.057

GPS 设备通常不提供转弯信息。

几乎所有 GPS 设备（内部、通过蓝牙或其他连接）都符合 NMEA 标准，该标准仅提供封装在简单的基于文本的协议中的纬度、经度和海拔。几乎所有这些都通过一个简单的串行端口进行通信，您可以使用 .NET 在大约 4 行代码中访问该端口。

转弯方向由 GPS 连接到的设备（您的 PDA、电话或计算机）计算。如果有可用的 Internet 连接，Google Maps 或 Windows Live Local API 真的很容易使用（尤其是从 .NET 使用 WebRequest 或 Sockets）并且可能是解决您问题的最佳方法！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-08-13T16:54:36.210

我想你所说的 GPS 是指卫星导航？大多数 GPS 装置不提供在道路上有效导航所需的逐向转弯功能，也不提供与此相关的基础路线图数据。

***更新：***好的，因为 Garmin 是迄今为止最大的狗，我建议看看 Garmin 的[Location Based Services Toolkit](http://developer.garmin.com/lbs/lbs-toolkit/)、 [Fleet Management Toolkit](http://developer.garmin.com/lbs/fleet-management/)和他们的[Communicator API](http://developer.garmin.com/web-device/garmin-communicator-plugin/)（特别是[DeviceControl](http://developer.garmin.com/web-device/garmin-communicator-plugin/devicecontrol/)模块）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-09T15:00:43.973

看看 routes.tomtom.com，他们可以将地址发送到 TomTom。

（警告：[正在申请专利](http://www.freepatentsonline.com/y2007/0266177.html)！）

# c# - Compact Framework/Threading - 选择选项后，MessageBox 显示在其他控件之上

> ID：10071
> 
> 赞同：4
> 
> 时间：2008-08-13T16:55:51.387
> 
> 标签：c#, winforms, multithreading, compact-framework

我正在开发一个应用程序，该应用程序可以从外部服务器获取并安装大量更新，并且需要一些线程方面的帮助。用户遵循这个过程：

*   点击按钮
*   方法检查更新，返回计数。
*   如果大于 0，则询问用户是否要使用 MessageBox.Show() 进行安装。
*   如果是，它会运行一个循环并在每次更新的 run() 方法上调用 BeginInvoke() 以在后台运行它。
*   我的更新类有一些用于更新进度条等的事件。

进度条更新很好，但 MessageBox 没有从屏幕上完全清除，因为更新循环在用户单击是后立即开始（见下面的屏幕截图）。

*   我应该怎么做才能使消息框在更新循环开始之前立即消失？
*   我应该使用线程而不是 BeginInvoke() 吗？
*   我应该在单独的线程上进行初始更新检查并从该线程调用 MessageBox.Show() 吗？

**代码**

```
// Button clicked event handler code...
DialogResult dlgRes = MessageBox.Show(
    string.Format("There are {0} updates available.\n\nInstall these now?", 
    um2.Updates.Count), "Updates Available", 
    MessageBoxButtons.YesNo, 
    MessageBoxIcon.Question, 
    MessageBoxDefaultButton.Button2
);

if (dlgRes == DialogResult.Yes)
{
    ProcessAllUpdates(um2); 
}

// Processes a bunch of items in a loop
private void ProcessAllUpdates(UpdateManager2 um2)
{
    for (int i = 0; i < um2.Updates.Count; i++)
    {
        Update2 update = um2.Updates[i];

        ProcessSingleUpdate(update);

        int percentComplete = Utilities.CalculatePercentCompleted(i, um2.Updates.Count);

        UpdateOverallProgress(percentComplete);
    }
}

// Process a single update with IAsyncResult
private void ProcessSingleUpdate(Update2 update)
{
    update.Action.OnStart += Action_OnStart;
    update.Action.OnProgress += Action_OnProgress;
    update.Action.OnCompletion += Action_OnCompletion;

    //synchronous
    //update.Action.Run();

    // async
    IAsyncResult ar = this.BeginInvoke((MethodInvoker)delegate() { update.Action.Run(); });
} 
```

**截屏**

[![Windows 移动错误](../Images/c82a751bb96fa7e8cbfe2df699b9a62e.png)](http://www.flickr.com/photos/brianly/2760435228/ "BrianLy 的 Windows Mobile 错误，在 Flickr 上")

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-08-13T18:17:23.483

您的 UI 没有更新，因为所有工作都发生在用户界面线程中。您致电：

```
this.BeginInvoke((MethodInvoker)delegate() {update.Action.Run(); }) 
```

在创建“this”（您的表单）的线程上调用 update.Action.Run()，这是用户界面线程。

```
Application.DoEvents() 
```

确实会给 UI 线程重绘屏幕的机会，但我很想创建新的委托，并在上面调用 BeginInvoke。

这将在从线程池分配的单独线程上执行 update.Action.Run() 函数。然后，您可以继续检查 IAsyncResult 直到更新完成，在每次检查后查询更新对象的进度（因为您不能让其他线程更新进度条/UI），然后调用 Application.DoEvents()。

您还应该在之后调用 EndInvoke() 否则您最终可能会泄漏资源

我也很想在进度对话框上放置一个取消按钮，并添加一个超时，否则如果更新卡住（或花费太长时间），那么您的应用程序将永远锁定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-08-13T17:37:08.167

你试过放一个

```
Application.DoEvents() 
```

在这里

```
if (dlgRes == DialogResult.Yes)
{
   Application.DoEvents(); 
   ProcessAllUpdates(um2); 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-21T20:21:42.187

@约翰·西布利

[在处理 WinForms 时，您可以*不调用 EndInvoke 而不会产生任何负面后果。*](http://www.interact-sw.co.uk/iangblog/2005/05/16/endinvokerequired)

> 我知道的唯一记录在案的规则例外是在 Windows 窗体中，正式允许您调用 Control.BeginInvoke 而无需费心调用 Control.EndInvoke。

但是，在处理 Begin/End Async 模式的所有其他情况下，您应该假设它会泄漏，正如您所说。

# html - 浏览器地址栏中 URL 地址旁边的个性化图标？

> ID：10072
> 
> 赞同：8
> 
> 时间：2008-08-13T16:55:58.000
> 
> 标签：html

如何编写代码，使公司图标出现在浏览器地址栏中 URL 地址旁边的左侧？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-08-13T16:58:10.353

您正在寻找[Favicon](https://stackoverflow.com/questions/6642/preferred-way-to-use-favicons#6645)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-08-13T16:57:59.887

它加载 www.whateveryouron.com/favicon.ico

如果您的域是 robermyers.com，只需放置一个可访问的 favicon.ico 16px 图标，您就会像燧石一样。试试这个[googles](http://www.google.com/favicon.ico)或[stackoverflows](https://stackoverflow.com/favicon.ico)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-08-13T18:11:24.963

您需要创建一个网站图标。favicon 使用标准（至少在 Windows 中）.ico 文件。如果您有徽标，可以在[http://www.favicongenerator.com/等网站进行转换](http://www.favicongenerator.com/)

在`<head>`您的 html 页面中，使用`<link>`标签来定义 favicon 的位置，如下所示：

```
<link type="image/x-icon" rel="shortcut icon" href="favicon.ico" /> 
```

您可能需要刷新页面才能显示图标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-08-13T16:58:00.960

在网络服务器上加载一个名为[favicon.ico的文件](https://stackoverflow.com/favicon.ico)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-13T18:52:27.453

在现代浏览器中，.ico 以外的其他文件格式也可以使用。您甚至可以将动画 gif 放在那里！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-08-15T02:16:03.013

[DynamicDrive 也有一个简单的图标制作工具](http://tools.dynamicdrive.com/favicon/)。

不同的页面/目录也可以调用不同的 .ico，其代码类似于 y0mbo 的示例（这是 Mint 使用的）：

```
<link href="sc/ph645.43/images/icons/mint.ico" rel="icon" type="text/x-icon" /> 
```

[这](http://perishablepress.com/press/2007/10/17/everything-you-ever-wanted-to-know-about-favicons/)是一篇关于网站图标的好文章。

我怀疑动画网站图标有可能走上眨眼标签的道路。[Mint](https://wwws.mint.com/login.event)正在使用他们的整体设计来匹配他们的整体设计，如果您在 FF3 中访问，您会看到它与 FF 用来指定公认 SSL 证书的绿色相匹配。

# windows - 更好的 Windows 命令？

> ID：10083
> 
> 赞同：13
> 
> 时间：2008-08-13T17:06:04.127
> 
> 标签：windows, macos, command-line, terminal

在我使用 MSWindows 长大的过程中，我在几年前过渡到了我深受喜爱的 Mac。我不想在操作系统上引发一场激烈的战争。但是，我确实想要一个更接近我习惯的终端。

我不是要求完整的 POSIX 支持——我没有耐心安装 Cygwin——但我想念标签式终端，能够轻松剪切和粘贴，以及我的好朋友`ls`, `mkdir`, `rm`, et al。（对于最后这些，我总是可以将 .bat 文件放在我的路径上，但这会很快变老。）

有人有 MSWindows XP 的终端应用程序吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-08-13T17:07:20.957

我正在使用[powershell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)，它可以防止你发疯，它有 rm 和 mkdir 和 ls。选项卡式终端仍然不在 powershell 中，复制粘贴类似于 cmd，但比 cmd.exe 更好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-08-13T17:27:16.440

还有一些选择：

[MSYS](http://www.mingw.org) : 一个提供 POSIX 兼容的 Bourne shell 环境的最小系统，带有一小部分 UNIX 命令行工具。主要开发用于执行用于构建开源软件的配置脚本和 Makefile，但也可用作通用命令行界面来替代 Windows cmd.exe。

[Win32 的 GNU 实用程序](http://unxutils.sourceforge.net)：通用 GNU 实用程序到本机 Win32 的端口。在这种情况下，本机意味着可执行文件仅依赖于 Microsoft C 运行时 (msvcrt.dll)，而不是像 Cygwin 工具提供的模拟层。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-08-13T17:13:47.420

[PowerCmd](http://www.powercmd.com/)很棒，有很多功能，包括标签、剪切/复制/过去等。

[控制台](http://sourceforge.net/projects/console/)也是一个很好的替代品，并且比 PowerCmd 更加精简（有时功能可能有点*过于*丰富。

此外，如果您安装了这两者，则可以从 withing 运行 powershell。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-08-18T21:56:55.100

如果你有点 Pythonista，那么[iPython](http://ipython.scipy.org/)就很难被击败。它有一些更常见的shell命令编码（即ls，pwd，cd等），也可以通过前缀'！'运行任何其他shell命令 （即！latex file.tex）但也是一个完整的 Python shell，具有历史记录、制表符完成、多行编辑器支持、日志记录等。

此外，您可以将 iPython 重新安装到您的 UNIX 机器以及 Windows 上，这意味着您的环境可以随处跟随。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-03-06T18:18:18.460

有一个名为*cmder*的新开源控制台[模拟器](https://github.com/bliker/cmder)。它看起来非常漂亮，并且具有一些使其更好用的高级功能。您也可以使用 powershell。最重要的是，它是便携式的！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-08-13T17:32:52.590

我从来没有找到比 Cygwin 更喜欢的东西。

我还继续安装了带有 Openbox 的 Cygwin/X，所以我可以得到这样的东西：

![替代文字](../Images/ae3a39ce3e3e2b1655521b0bf6242e5f.png)

它在 Openbox 主窗口中有多个工作区，因此我可以轻松地拥有多达 20 个不重叠的 xterm，我可以轻松地循环浏览它们。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-08-13T17:09:42.780

我知道你说过你不想安装任何东西，但我强烈建议你试试 Services For Unix：

[http://technet.microsoft.com/en-us/interopmigration/bb380242.aspx](http://technet.microsoft.com/en-us/interopmigration/bb380242.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-08-13T17:26:26.427

我将[控制台](http://sourceforge.net/projects/console/)与[unxutils一起使用](http://unxutils.sourceforge.net/)

选项卡控制台，更易于管理选择/复制/粘贴

unxutils 用于 ls、rm、grep、uniq、sort ... 和其他优点。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-08-13T17:28:19.933

PowerShell 是惊人的，但是除了最基本的命令之外，从 bash 等切换时有一个学习曲线。

我回去使用cygwin。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-08-13T17:15:33.127

[PowerShell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)值得研究。

# visual-studio - TFS 工作项帮助文本显示在哪里？

> ID：10088
> 
> 赞同：3
> 
> 时间：2008-08-13T17:09:26.210
> 
> 标签：visual-studio, tfs

我正在 TFS 中创建一些自定义工作项，helptext 字段看起来很方便，但我看不到它在 Team Explorer 或 Team System Web Access 中的显示位置。

**这些信息在哪里显示？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-08-13T18:30:52.723

当您将鼠标悬停在字段的类型上时。例如，创建一个新错误并将鼠标悬停在“排名”上，您应该会看到“用于优先工作的堆栈排名”

# c# - 可以同时执行 WebForms 和 MVC 的最佳模拟框架？

> ID：10098
> 
> 赞同：2
> 
> 时间：2008-08-13T17:16:33.857
> 
> 标签：c#, asp.net, asp.net-mvc, testing

我正在进入更多的 TDD 工作流程，并且混合了 MVC 和 asp.net Web Forms 应用程序。

建议 MVC 起订量。

我已经将 Rhino 用于 Web 表单。

有没有人有一个最佳实践来为两者都提供 1 个框架模拟？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-08-28T23:10:33.830

This is sort of a silly question, but I prefer Rhino Mocks as it represents a more complete understanding of [mocks vs. stubs](http://martinfowler.com/articles/mocksArentStubs.html).

Look deep into TypeMock before committing to the price.

Also, there is no recommended mocking framework for ASP.NET MVC.

Finally - I'd suggest you stick to one mocking framework in your project (and even in your team) - the differences, while not huge, can lead to confusion that is unwarranted on such a "polishing-the-rock" decision. By that I mean the decision should not be a long one, just pick what works and get on with creating value.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-08-13T18:38:46.733

Rhino 的最新版本包含了 MoQ 所拥有的大部分甜蜜甜蜜 3.5 的爱。我是 MoQ 的粉丝，所以这就是我正在使用的。但我也有 Rhino，以防它做 MoQ 不做的事情。

TL；DR：起订量吧宝贝。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-14T04:47:21.590

TypeMock 非常强大。当我*需要*对一个不是为可测试性设计的 Web 表单应用程序进行单元测试时，TypeMock 救了我的命。

但是，当我花时间选择一种架构模式 (MVC) 或设计一种允许 Mockability 的架构模式（你知道，公共虚拟化状态更改方法）时，我会使用 Moq。它使用起来很简单，教别人也很简单。

TypeMock 的记录回放语法仍然让我感到困惑，但它在紧张的发布计划中为我节省了大量时间。Moq 的 API 几乎是不言自明的，考虑到模拟库的历史，这是一项了不起的成就。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-08-13T18:17:00.973

我会继续使用我最喜欢的框架。我认为我没有任何理由为 Web 表单选择一个框架而为 MVC 选择另一个框架。一个更大的问题是我将如何对我的 Web 表单页面进行单元测试，因为将页面与 HttpRequest 堆栈的其余部分分开是出了名的困难。

我最喜欢的是起订量。我也使用过 TypeMock。它需要花钱，但它真的很强大——它可以让你模拟具体的类和构造函数，所以你可以模拟 HttpContext 或 HttpRequest 之类的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T10:36:38.013

Look into Ivonna for faking HTTPContext and traditional webforms.

[http://sm-art.biz/Ivonna.aspx](http://sm-art.biz/Ivonna.aspx)

# python - 如何在 Python 中将整数视为字节数组？

> ID：10123
> 
> 赞同：15
> 
> 时间：2008-08-13T17:46:41.940
> 
> 标签：python

我正在尝试解码 Python os.wait() 函数的结果。根据 Python 文档，这将返回：

> 一个包含其 pid 和退出状态指示的元组：一个 16 位数字，其低字节是杀死进程的信号号，其高字节是退出状态（如果信号号为零）；如果生成了核心文件，则设置低字节的高位。

如何解码退出状态指示（整数）以获得高字节和低字节？具体来说，如何实现以下代码片段中使用的解码功能：

```
(pid,status) = os.wait()
(exitstatus, signum) = decode(status) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-08-13T17:56:34.167

这将做你想要的：

```
signum = status & 0xff
exitstatus = (status & 0xff00) >> 8 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-08-13T18:52:36.270

要回答您的一般问题，您可以使用[位操作](https://en.wikipedia.org/wiki/Bit_manipulation)

```
pid, status = os.wait()
exitstatus, signum = status & 0xFF, (status & 0xFF00) >> 8 
```

但是，也有用于解释退出状态值的[内置函数：](https://docs.python.org/3/library/functions.html)

```
pid, status = os.wait()
exitstatus, signum = os.WEXITSTATUS( status ), os.WTERMSIG( status ) 
```

也可以看看：

*   os.WCOREDUMP()
*   os.WIFCONTINUED()
*   os.WIFSTOPPED()
*   os.WIFSIGNALED()
*   os.WIFEXITED()
*   os.WSTOPSIG()

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T14:52:42.200

[您可以使用struct](http://docs.python.org/library/struct.html)模块将 int 分解为一串无符号字节：

```
import struct
i = 3235830701  # 0xC0DEDBAD
s = struct.pack(">L", i)  # ">" = Big-endian, "<" = Little-endian
print s         # '\xc0\xde\xdb\xad'
print s[0]      # '\xc0'
print ord(s[0]) # 192 (which is 0xC0) 
```

如果将它与[数组](http://docs.python.org/library/array.html)模块结合使用，则可以更方便地执行此操作：

```
import struct
i = 3235830701  # 0xC0DEDBAD
s = struct.pack(">L", i)  # ">" = Big-endian, "<" = Little-endian

import array
a = array.array("B")  # B: Unsigned bytes
a.fromstring(s)
print a   # array('B', [192, 222, 219, 173]) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-26T23:48:20.277

```
exitstatus, signum= divmod(status, 256) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-08-13T17:58:27.563

您可以使用[位移](https://docs.python.org/3/reference/expressions.html#shifting-operations)和[掩码](https://docs.python.org/3/reference/expressions.html#binary-bitwise-operations)运算符解压缩状态。

```
low = status & 0x00FF
high = (status & 0xFF00) >> 8 
```

我不是 Python 程序员，所以我希望语法正确。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-08-13T18:14:10.947

我之前的人已经搞定了，但如果你真的想把它放在一条线上，你可以这样做：

```
(signum, exitstatus) = (status & 0xFF, (status >> 8) & 0xFF) 
```

编辑：倒过来了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-04-28T07:50:13.887

```
import amp as amp
import status
signum = status &amp; 0xff
exitstatus = (status &amp; 0xff00) &gt;&gt; 8 
```

# regex - 如何将正则表达式绑定到 emacs 中的组合键？

> ID：10149
> 
> 赞同：6
> 
> 时间：2008-08-13T18:15:09.340
> 
> 标签：regex, emacs, lisp

对于上下文，我是一个 emacs 新手。我已经很久没有使用它了，但是已经越来越多地使用它（我非常喜欢它）。我对 lisp 也很满意，但对 elisp 不是很熟悉。

我需要做的是将正则表达式绑定到键盘组合，因为我经常使用这个特定的正则表达式。

我一直在做什么：

```
M-C-s ^.*Table\(\(.*\n\)*?GO\) 
```

请注意，我在上面使用了换行符，但我发现对于`isearch-forward-regexp`，您确实需要将`\n`正则表达式中的 替换为`C-q Q-j`. 这会插入一个文字换行符（不结束命令），使我能够将换行符放入表达式并跨行匹配。

如何将其绑定到组合键？

我隐约明白我需要创建一个`isearch-forward-regexp`用表达式执行的 elisp 函数，但我对细节很模糊。我搜索了谷歌，发现大多数文档有点令人困惑。

*如何将正则表达式绑定到 emacs 中的组合键？*

* * *

**到目前为止，迈克·斯通（Mike Stone）给出了最好的答案——不*完全*是我想要的，但它满足了我的需要**

编辑 - 这种工作，但是在存储宏之后，当我稍后回去使用它时，我无法将它与`C-x e`. （即，如果我重新启动 emacs，然后键入`M-x macro-name`, 然后`C-x e`，我会在 minibuffer 中收到一条消息，例如“没有最后一个 kbd 宏”或类似的东西）

* * *

@Mike Stone - 感谢您提供信息。我尝试像这样创建一个宏：

```
C-x( M-C-s ^.*Table\(\(.*C-q C-J\)*?GO\) C-x) 
```

这创建了我的宏，但是当我执行我的宏时，我没有得到与我通常使用`isearch-forward-regexp`. 相反，它只是跳到表达式的下一个匹配项的末尾。所以这并不能满足我的需要。有任何想法吗？

编辑：看起来我*可以*使用宏来做我想做的事，我只需要跳出`isearch-forward-regexp`. 我会尝试你的建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-08-13T18:21:06.830

您可以使用宏，只需`C-x (`为宏执行所有操作，然后`C-x )`结束宏，然后`C-x e`将执行最后定义的宏。然后，您可以使用`M-x name-last-kbd-macro`它命名它，让您为其分配一个名称，然后您可以调用它`M-x TESTIT`，然后存储定义，使用`M-x insert-kbd-macro`它将宏放入当前缓冲区，然后您可以将其存储在您的`.emacs`文件中。

例子：

```
C-x( abc *return* C-x) 
```

将定义一个宏来键入“abc”并按回车键。

```
C-xeee 
```

立即执行上述宏，3 次（第一个 e 执行它，然后后面的 2 个 e 将再执行两次）。

```
M-x name-last-kbd-macro testit 
```

将宏命名为“testit”

```
M-x testit 
```

执行刚刚命名的宏（打印“abc”然后返回）。

```
M-x insert-kbd-macro 
```

将以下内容放入当前缓冲区：

```
(fset 'testit
   [?a ?b ?c return]) 
```

然后可以将其保存在您的`.emacs`文件中，以便在重新启动 emacs 后一遍又一遍地使用命名宏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-13T00:34:28.763

我已经开始从字面上解决你的问题，

```
(defun search-maker (s)
  `(lambda ()
     (interactive)
     (let ((regexp-search-ring (cons ,s regexp-search-ring)) ;add regexp to history
           (isearch-mode-map (copy-keymap isearch-mode-map)))
       (define-key isearch-mode-map (vector last-command-event) 'isearch-repeat-forward) ;make last key repeat
       (isearch-forward-regexp)))) ;`

(global-set-key (kbd "C-. t") (search-maker "^.*Table\\(\\(.*\\n\\)*?GO\\)"))
(global-set-key (kbd "<f6>") (search-maker "HELLO WORLD")) 
```

键盘序列 from`(kbd ...)`开始新的空白搜索。要实际搜索您的字符串，您可以根据需要再次按*最后一个键。*所以`C-. t t t`或`<f6> <f6> <f6>`。该解决方案基本上是一个 hack，但如果您想尝试它，我会把它留在这里。

以下可能是最接近您需要的，

```
(defmacro define-isearch-yank (key string)
  `(define-key isearch-mode-map ,key 
     (lambda ()
       (interactive) 
       (isearch-yank-string ,string)))) ;`

(define-isearch-yank (kbd "C-. t") "^.*Table\\(\\(.*\\n\\)*?GO\\)")
(define-isearch-yank (kbd "<f6>") "HELLO WORLD") 
```

按键组合现在仅在 isearch 模式下有效。您正常开始搜索，然后按组合键插入您的预定义字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-13T18:44:39.997

@贾斯汀：

执行宏时，情况略有不同......增量搜索只会发生一次，如果您想再次搜索，则必须再次执行宏。你可以做更强大和更复杂的事情，比如搜索关键字，跳转到行首，标记，到行尾，Mw（复制），然后跳转到另一个缓冲区，然后 Cy（粘贴)，然后跳回另一个缓冲区并结束您的宏。然后，每次执行宏时，都会将一行复制到下一个缓冲区。

关于 emacs 宏的真正酷的事情是它会在看到铃声时停止......当您无法匹配增量搜索（以及其他事情）时会发生这种情况。所以上面的宏，你可以做 Cu 1000 Cx e 这将执行宏 1000 次......但是由于你做了搜索，它只会复制 1000 行，或者直到搜索失败！这意味着如果有 100 个匹配项，它只会执行宏 100 次。

编辑：查看 C-hf highlight-lines-matching-regexp 它将显示一个命令的帮助，该命令突出显示与正则表达式匹配的所有内容......我不知道如何撤消突出显示......无论如何你可以使用存储宏以突出显示所有匹配正则表达式，然后另一个宏来查找下一个...？

进一步编辑： Mx unhighlight-regexp 将撤消突出显示，但您必须输入最后一个正则表达式（但它默认为您用来突出显示的正则表达式）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-08-24T08:12:16.660

通常，要在 Emacs 中定义自定义键绑定，您会编写

```
(define-key global-map (kbd "C-c C-f") 'function-name) 
```

`define-key`不出所料，它是定义新键的功能。`global-map`是全局键映射，而不是每个模式的单独映射。`(kbd "C-c C-f")`返回一个表示键序列的字符串`C-c C-f`。还有其他方法可以做到这一点，包括直接输入字符串，但这通常是最直接的，因为它采用正常的书面表示。`'function-name`是一个符号，它是函数的名称。

现在，除非您的函数已经定义，否则您需要在使用它之前定义它。为此，请写

```
(defun function-name (args)
  (interactive)
  stuff
  ...) 
```

`defun`定义一个功能 -`C-h f defun`用于更具体的信息。`(interactive)`没有真正的函数调用；它告诉编译器用户可以使用`M-x function-name`和通过键绑定调用该函数。

现在，特别是对于交互式搜索，这很棘手；该`isearch`模块似乎并未真正针对您要执行的操作进行设置。但是你可以用它来做类似的事情。

# regex - 由于 Instr 正则表达式拒绝匹配

> ID：10158
> 
> 赞同：3
> 
> 时间：2008-08-13T18:18:30.643
> 
> 标签：regex, xpath

使用正则表达式执行“instring”类型函数的最简单方法是什么？例如，我怎么能因为存在单个字符（例如？）而拒绝整个字符串`:`？例如：

*   `this`- 好的
*   `there:is`- 不好，因为`:`

更实际的是，如何匹配以下字符串：

```
//foo/bar/baz[1]/ns:foo2/@attr/text() 
```

对于不包含命名空间的 xpath 上的任何节点测试？

```
(/)?(/)([^:/]+) 
```

将匹配节点测试，但包含使其出错的命名空间前缀。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-08-14T00:13:24.030

我仍然不确定您是否只是想检测 Xpath 是否包含命名空间，或者是否要删除对命名空间的引用。所以这里有一些示例代码（在 C# 中），两者兼而有之。

```
class Program
{
    static void Main(string[] args)
    {
        string withNamespace = @"//foo/ns2:bar/baz[1]/ns:foo2/@attr/text()";
        string withoutNamespace = @"//foo/bar/baz[1]/foo2/@attr/text()";

        ShowStuff(withNamespace);
        ShowStuff(withoutNamespace);
    }

    static void ShowStuff(string input)
    {
        Console.WriteLine("'{0}' does {1}contain namespaces", input, ContainsNamespace(input) ? "" : "not ");
        Console.WriteLine("'{0}' without namespaces is '{1}'", input, StripNamespaces(input));
    }

    static bool ContainsNamespace(string input)
    {
        // a namspace must start with a character, but can have characters and numbers
        // from that point on.
        return Regex.IsMatch(input, @"/?\w[\w\d]+:\w[\w\d]+/?");
    }

    static string StripNamespaces(string input)
    {
        return Regex.Replace(input, @"(/?)\w[\w\d]+:(\w[\w\d]+)(/?)", "$1$2$3");
    }
} 
```

希望有帮助！祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-08-13T18:34:59.067

匹配:? 我认为这个问题还不够清楚，因为答案很明显：

```
if(Regex.Match(":", input)) // reject 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-08-13T18:26:34.167

我不太了解正则表达式的语法，但你不能这样做：

`[any alpha numeric]\*:[any alphanumeric]\*`

我认为这样的事情不应该有效吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-08-13T18:36:02.823

您可能想要 \w 这是一个“单词”字符。从[javadocs](http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Pattern.html)，它被定义为 [a-zA-Z_0-9]，所以如果你也不想要下划线，那可能行不通....

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-13T20:21:08.400

是的，我的问题不是很清楚。这是一个解决方案，但不是使用正则表达式进行单次传递，而是使用**拆分**并执行迭代。它也可以，但不那么优雅：

```
string xpath = "//foo/bar/baz[1]/ns:foo2/@attr/text()";
string[] nodetests = xpath.Split( new char[] { '/' } );
for (int i = 0; i < nodetests.Length; i++) 
{
    if (nodetests[i].Length > 0 && Regex.IsMatch( nodetests[i], @"^(\w|\[|\])+$" ))
    {
        // does not have a ":", we can manipulate it.
    }
}

xpath = String.Join( "/", nodetests ); 
```

# .net - 如何从 SQL 返回一页结果？

> ID：10190
> 
> 赞同：11
> 
> 时间：2008-08-13T18:38:02.740
> 
> 标签：.net, sql, linq, pagination

许多应用程序都有网格，一次显示一页数据库表中的数据。其中许多还允许用户选择每页的记录数，按任何列排序，并在结果中来回导航。

什么是实现这种模式的好算法，而不是将整个表带到客户端，然后在客户端过滤数据。您如何只将要显示的记录提供给用户？

LINQ 是否简化了解决方案？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-08-13T18:40:32.220

在 MS SQL Server 2005 及更高版本上，[ROW_NUMBER()](http://msdn.microsoft.com/en-us/library/ms186734.aspx)似乎工作：

[T-SQL：使用 ROW_NUMBER() 进行分页](http://blogs.x2line.com/al/archive/2005/11/18/1323.aspx)

```
DECLARE @PageNum AS INT;
DECLARE @PageSize AS INT;
SET @PageNum = 2;
SET @PageSize = 10;

WITH OrdersRN AS
(
    SELECT ROW_NUMBER() OVER(ORDER BY OrderDate, OrderID) AS RowNum
          ,OrderID
          ,OrderDate
          ,CustomerID
          ,EmployeeID
      FROM dbo.Orders
)

SELECT * 
  FROM OrdersRN
 WHERE RowNum BETWEEN (@PageNum - 1) * @PageSize + 1 
                  AND @PageNum * @PageSize
 ORDER BY OrderDate
         ,OrderID; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-08-13T19:29:28.380

我建议要么使用 LINQ，要么尝试复制它的功能。我有一个应用程序，我在其中使用 LINQ Take 和 Skip 方法来检索分页数据。代码看起来像这样：

```
MyDataContext db = new MyDataContext();
var results = db.Products
    .Skip((pageNumber - 1) * pageSize)
    .Take(pageSize); 
```

运行 SQL Server Profiler 显示 LINQ 正在将此查询转换为类似于以下内容的 SQL：

```
SELECT [ProductId], [Name], [Cost], and so on...
FROM (
    SELECT [ProductId], [Name], [Cost], [ROW_NUMBER]
    FROM (
       SELECT ROW_NUMBER() OVER (ORDER BY [Name]) AS [ROW_NUMBER], 
           [ProductId], [Name], [Cost]
       FROM [Products]
    )
    WHERE [ROW_NUMBER] BETWEEN 10 AND 20
)
ORDER BY [ROW_NUMBER] 
```

用简单的英语：
1\. 过滤您的行并使用 ROW_NUMBER 函数按您想要的顺序添加行号。
2\. 过滤器 (1) 仅返回页面上所需的行号。
3\. 按行号对 (2) 进行排序，这与您想要的顺序相同（在本例中，按名称）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-10-26T18:32:02.040

在数据库中进行分页基本上有两种方法（我假设您使用的是 SQL Server）：

### 使用偏移量

其他人已经解释了如何使用`ROW_NUMBER() OVER()`排名功能来执行页面。值得一提的是，SQL Server 2012 终于包含了对 SQL 标准[`OFFSET .. FETCH`](http://technet.microsoft.com/en-us/library/gg699618.aspx)子句的支持：

```
SELECT first_name, last_name, score
FROM players
ORDER BY score DESC
OFFSET 40 ROWS FETCH NEXT 10 ROWS ONLY 
```

如果您使用的是 SQL Server 2012 并且向后兼容性不是问题，您可能应该更喜欢这个子句，因为在极端情况下，SQL Server 会更优化地执行它。

### 使用 SEEK 方法

在 SQL 中执行分页有一种完全不同的、更快但鲜为人知的方法。这通常被称为“seek 方法”，如[本博](http://blog.jooq.org/2013/10/26/faster-sql-paging-with-jooq-using-the-seek-method/)文中所述。

```
SELECT TOP 10 first_name, last_name, score
FROM players
WHERE (score < @previousScore)
   OR (score = @previousScore AND player_id < @previousPlayerId)
ORDER BY score DESC, player_id DESC 
```

`@previousScore`和`@previousPlayerId`值是上一页最后一条记录的相应值。这允许您获取“下一页”。如果`ORDER BY`方向是`ASC`，只需使用即可`>`。

使用上述方法，您不能在没有先获取前 40 条记录的情况下立即跳转到第 4 页。但通常，无论如何你都不想跳那么远。相反，您将获得更快的查询，该查询可能能够在恒定时间内获取数据，具体取决于您的索引。另外，您的页面保持“稳定”，无论基础数据是否发生变化（例如，在第 1 页，而您在第 4 页）。

例如，当在 Web 应用程序中延迟加载更多数据时，这是实现分页的最佳方式。

注意，“seek 方法”也称为[keyset paging](https://stackoverflow.com/a/3215973/521799)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-08-15T22:07:40.743

LINQ 与 .Net 3.5 中的 lambda 表达式和匿名类相结合，*极大*地简化了这类事情。

查询数据库：

```
var customers = from c in db.customers
                join p in db.purchases on c.CustomerID equals p.CustomerID
                where p.purchases > 5
                select c; 
```

每页记录数：

```
customers = customers.Skip(pageNum * pageSize).Take(pageSize); 
```

按任意列排序：

```
customers = customers.OrderBy(c => c.LastName); 
```

仅从服务器获取选定的字段：

```
var customers = from c in db.customers
                join p in db.purchases on c.CustomerID equals p.CustomerID
                where p.purchases > 5
                select new
                {
                    CustomerID = c.CustomerID,
                    FirstName = c.FirstName,
                    LastName = c.LastName
                }; 
```

这将创建一个静态类型的匿名类，您可以在其中访问其属性：

```
var firstCustomer = customer.First();
int id = firstCustomer.CustomerID; 
```

默认情况下，查询的结果是延迟加载的，因此在您真正需要数据之前，您不会与数据库对话。.Net 中的 LINQ 还通过保留您所做的任何更改的数据上下文并仅更新您更改的字段来极大地简化更新。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-08-13T18:43:17.893

实际上，LINQ 有 Skip 和 Take 方法，可以组合起来选择获取哪些记录。

检查那些。

对于 DB：[SQL Server 2005 中的分页](http://web.archive.org/web/20170901080057/http://www.singingeels.com:80/Articles/Pagination_In_SQL_Server_2005.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-13T19:00:32.320

甲骨文解决方案：

```
select * from (
    select a.*, rownum rnum from (
        YOUR_QUERY_GOES_HERE -- including the order by
    ) a
    where rownum <= MAX_ROW
 ) where rnum >= MIN_ROW 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-08-15T21:44:25.533

我在 MS SQL 2005 中使用了一些解决方案。

其中之一是 ROW_NUMBER()。但是，就个人而言，我不喜欢 ROW_NUMBER() 因为它不适用于大结果（我工作的数据库非常大 - 超过 1TB 的数据在一秒钟内运行数千个查询 - 你知道 - 大型社交网络地点）。

这是我最喜欢的解决方案。

我将使用一种 T-SQL 的伪代码。

让我们找到按姓、名排序的用户的第二页，其中每页有 10 条记录。

```
@page = 2 -- input parameter
@size = 10 -- can be optional input parameter

if @page < 1 then begin
    @page = 1 -- check page number
end
@start = (@page-1) * @size + 1 -- @page starts at record no @start

-- find the beginning of page @page
SELECT TOP (@start)
    @forename = forename,
    @surname = surname
    @id = id
FROM
    users
ORDER BY
    forename,
    surname,
    id -- to keep correct order in case of have two John Smith.

-- select @size records starting from @start
SELECT TOP (@size)
    id,
    forename,
    surname
FROM
    users
WHERE
    (forename = @forename and surname = @surname and id >= @id) -- the same name and surname, but bigger id
    OR (forename = @forename and surname > @surname) -- the same name, but bigger surname, id doesn't matter
    OR (forename > @forename) -- bigger forename, the rest doesn't matter
ORDER BY
    forename,
    surname,
    id 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-11T16:04:25.703

[这里](http://www.4guysfromrolla.com/webtech/042606-1.shtml)有一个关于这个的讨论

该技术在 78 毫秒内从 150,000 行数据库中获取页码 100,000

> 使用优化器知识和 SET ROWCOUNT，请求的页面中的第一个 EmployeeID 存储在本地变量中作为起点。接下来，将 ROWCOUNT 设置为 @maximumRows 中请求的最大记录数。这允许以更有效的方式对结果集进行分页。使用此方法还可以利用表上预先存在的索引，因为它直接进入基表而不是本地创建的表。

恐怕我无法判断它是否比当前接受的答案更好。

# c# - 分隔字符串解析？

> ID：10205
> 
> 赞同：2
> 
> 时间：2008-08-13T18:46:44.517
> 
> 标签：c#, text-parsing, csv

我正在研究解析一个分隔字符串，大约是

a,b,c

但这是一个非常简单的例子，解析分隔数据会变得很复杂；例如

1，“你的简单算法，它失败了”，真

会把你天真的 string.Split 实现吹成碎片。有什么我可以自由使用/窃取/复制和粘贴的东西，可以为解析分隔文本提供相对安全的解决方案吗？.NET，plox。

*更新：* 我决定使用[TextFieldParser](http://msdn.microsoft.com/en-us/library/f68t4563.aspx)，它是隐藏在 Microsoft.VisualBasic.DLL 中的 VB.NET 一堆好东西的一部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-08-13T19:18:26.730

我用它来读取文件

```
string filename = @textBox1.Text;
string[] fields;
string[] delimiter = new string[] {"|"};
using (Microsoft.VisualBasic.FileIO.TextFieldParser parser =
       new Microsoft.VisualBasic.FileIO.TextFieldParser(filename)) {
    parser.Delimiters = delimiter;
    parser.HasFieldsEnclosedInQuotes = false;

    while (!parser.EndOfData) {
        fields = parser.ReadFields();
        //Do what you need
    }
} 
```

我相信这里有人可以将其转换为解析内存中的字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-08-13T18:53:44.660

我不知道任何框架，但是一个简单的状态机可以工作：

*   状态 1：读取每个字符，直到您点击 " 或 a ，
    *   如果是“：移动到状态 2
    *   如果是 ,: 移动到状态 3
    *   在文件结束的情况下：移动到状态 4
*   状态 2：读取每个字符，直到您点击“
    *   如果是 ": 移动到状态 1
    *   在文件结束的情况下：移动到状态 4 或由于未终止的字符串而发出错误信号
*   状态 3：将当前缓冲区添加到输出数组，将光标向前移动到 后面，然后回到状态 1。
*   状态 4：这是最终状态，除了返回输出数组之外什么都不做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-08-13T18:57:15.463

如

```
var elements = new List<string>();
var current = new StringBuilder();
var p = 0;

while (p < internalLine.Length) {
    if (internalLine[p] == '"') {
        p++;

        while (internalLine[p] != '"') {
            current.Append(internalLine[p]);
            p++;
        }

        // Skip past last ',
        p += 2;
    }
    else {
        while ((p < internalLine.Length) && (internalLine[p] != ',')) {
            current.Append(internalLine[p]);
            p++;
        }

        // Skip past ,
        p++;
    }

    elements.Add(current.ToString());
    current.Length = 0;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T17:04:01.933

可以在这里找到一个非常全面的库：[FileHelpers](http://www.filehelpers.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-08-13T18:55:40.427

这里有一些很好的答案：[Split a string ignoring quoted section](https://stackoverflow.com/questions/6209/split-a-string-ignoring-quoted-sections)

您可能想将您的问题重新表述为更精确的内容（例如**，我可以使用哪些代码片段或库来解析 .NET 中的 CSV 数据**？）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-13T19:54:40.807

为了做一个无耻的插件，我一直在研究一个名为[fotelo](http://www.codeplex.com/fotelo) （格式化文本加载器）的库，我用它来快速解析基于分隔符、位置或正则表达式的大量文本。对于快速字符串来说，它是矫枉过正的，但如果您正在使用日志或大量，它可能正是您所需要的。它使用类似于 SQL*Loader 的控制文件模型（它背后的灵感）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-06-30T11:02:55.473

迟到总比没有好（增加 SO 的完整性）：

[http://www.codeproject.com/KB/database/CsvReader.aspx](http://www.codeproject.com/KB/database/CsvReader.aspx)

这是一项规则。

GJ

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-08-13T18:49:40.020

我认为通用框架需要在两件事之间指定：1.什么是分隔符。2\. 在什么情况下这些字符不算数（例如引号之间的字符）。

我认为每次需要执行此类操作时编写自定义逻辑可能会更好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-08-13T18:57:16.790

最简单的方法是将字符串拆分为 char 数组并查找您的字符串确定器并拆分 char。

单元测试应该相对容易。

您可以将其包装在类似于基本 .Spilt 方法的扩展方法中。

# php - 按特定顺序运行 PHPUnit 测试

> ID：10228
> 
> 赞同：74
> 
> 时间：2008-08-13T19:02:23.660
> 
> 标签：php, unit-testing, phpunit

有没有办法让 a 内部的测试`TestCase`按特定顺序运行？例如，我想将对象的生命周期从创建到使用到销毁分开，但我需要确保在运行其他测试之前先设置对象。

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2009-12-16T14:46:13.273

[PHPUnit 通过@depends](https://phpunit.de/manual/current/en/writing-tests-for-phpunit.html#writing-tests-for-phpunit.test-dependencies)注释支持测试依赖。

这是文档中的一个示例，其中测试将以满足依赖关系的顺序运行，每个依赖测试将参数传递给下一个：

```
class StackTest extends PHPUnit_Framework_TestCase
{
    public function testEmpty()
    {
        $stack = array();
        $this->assertEmpty($stack);

        return $stack;
    }

    /**
     * @depends testEmpty
     */
    public function testPush(array $stack)
    {
        array_push($stack, 'foo');
        $this->assertEquals('foo', $stack[count($stack)-1]);
        $this->assertNotEmpty($stack);

        return $stack;
    }

    /**
     * @depends testPush
     */
    public function testPop(array $stack)
    {
        $this->assertEquals('foo', array_pop($stack));
        $this->assertEmpty($stack);
    }
} 
```

但是，重要的是要注意，具有未解决依赖关系的测试将*不会*被执行（这是可取的，因为这会很快引起对失败测试的注意）。因此，在使用依赖项时要密切注意。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2008-08-13T20:13:42.830

也许您的测试中存在设计问题。

通常每个测试都不能依赖于任何其他测试，因此它们可以以任何顺序运行。

每个测试都需要实例化和销毁它运行所需的一切，这将是完美的方法，你不应该在测试之间共享对象和状态。

您能否更具体地说明为什么 N 次测试需要相同的对象？

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2017-07-26T10:09:27.937

正确的答案是测试的正确配置文件。我遇到了同样的问题，并通过创建具有必要测试文件顺序的测试套件来解决它：

```
phpunit.xml:

<phpunit
        colors="true"
        bootstrap="./tests/bootstrap.php"
        convertErrorsToExceptions="true"
        convertNoticesToExceptions="true"
        convertWarningsToExceptions="true"
        strict="true"
        stopOnError="false"
        stopOnFailure="false"
        stopOnIncomplete="false"
        stopOnSkipped="false"
        stopOnRisky="false"
>
    <testsuites>
        <testsuite name="Your tests">
            <file>file1</file> //this will be run before file2
            <file>file2</file> //this depends on file1
        </testsuite>
    </testsuites>
</phpunit> 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-08-23T22:30:48.447

如果您希望您的测试共享各种帮助对象和设置，您可以使用`setUp()`,`tearDown()`添加到`sharedFixture`属性中。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-12-29T10:22:31.247

PHPUnit 允许使用 '@depends' 注释来指定依赖测试用例并允许在依赖测试用例之间传递参数。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-06-17T10:31:05.743

替代解决方案：在测试中使用 static(!) 函数来创建可重用元素。例如（我使用 selenium IDE 记录测试和 phpunit-selenium (github) 在浏览器中运行测试）

```
class LoginTest extends SeleniumClearTestCase
{
    public function testAdminLogin()
    {
        self::adminLogin($this);
    }

    public function testLogout()
    {
        self::adminLogin($this);
        self::logout($this);
    }

    public static function adminLogin($t)
    {
        self::login($t, 'john.smith@gmail.com', 'pAs$w0rd');
        $t->assertEquals('John Smith', $t->getText('css=span.hidden-xs'));
    }

    // @source LoginTest.se
    public static function login($t, $login, $pass)
    {
        $t->open('/');
        $t->click("xpath=(//a[contains(text(),'Log In')])[2]");
        $t->waitForPageToLoad('30000');
        $t->type('name=email', $login);
        $t->type('name=password', $pass);
        $t->click("//button[@type='submit']");
        $t->waitForPageToLoad('30000');
    }

    // @source LogoutTest.se
    public static function logout($t)
    {
        $t->click('css=span.hidden-xs');
        $t->click('link=Logout');
        $t->waitForPageToLoad('30000');
        $t->assertEquals('PANEL', $t->getText("xpath=(//a[contains(text(),'Panel')])[2]"));
    }
} 
```

好的，现在，我可以在其他测试中使用这个可重用的元素 :) 例如：

```
class ChangeBlogTitleTest extends SeleniumClearTestCase
{
    public function testAddBlogTitle()
    {
      self::addBlogTitle($this,'I like my boobies');
      self::cleanAddBlogTitle();
    }

    public static function addBlogTitle($t,$title) {
      LoginTest::adminLogin($t);

      $t->click('link=ChangeTitle');
      ...
      $t->type('name=blog-title', $title);
      LoginTest::logout($t);
      LoginTest::login($t, 'paris@gmail.com','hilton');
      $t->screenshot(); // take some photos :)
      $t->assertEquals($title, $t->getText('...'));
    }

    public static function cleanAddBlogTitle() {
        $lastTitle = BlogTitlesHistory::orderBy('id')->first();
        $lastTitle->delete();
    } 
```

*   通过这种方式，您可以构建测试的层次结构。
*   您可以保持每个测试用例与其他测试用例完全分开的属性（如果您在每次测试后清理数据库）。
*   最重要的是，例如，如果将来登录方式发生变化，您只需修改 LoginTest 类，并且在其他测试中不需要正确的登录部分（它们应该在更新 LoginTest 后工作）:)

当我运行测试时，我的脚本开始清理数据库广告。上面我使用了我的`SeleniumClearTestCase`类（我在那里制作 screenshot() 和其他不错的功能）它是`MigrationToSelenium2`（从 gi​​thub，使用 seleniumIDE + ff 插件“Selenium IDE：PHP Formatters”在 Firefox 中移植记录的测试）的扩展，这是我的类的扩展LaravelTestCase（它是 Illuminate\Foundation\Testing\TestCase 的副本，但不扩展 PHPUnit_Framework_TestCase），它设置 laravel 以在我们想要在测试结束时清理 DB 时访问 eloquent）这是 PHPUnit_Extensions_Selenium2TestCase 的扩展。要设置 laravel eloquent，我还在 SeleniumClearTestCase 函数 createApplication 中（调用 at `setUp`，我从 laral test/TestCase 中获取此函数）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-03-28T10:42:21.223

在我看来，采用以下场景，我需要测试特定资源的创建和销毁。

最初我有两种方法，a。testCreateResource 和 b. 测试销毁资源

一种。测试创建资源

```
<?php
$app->createResource('resource');
$this->assertTrue($app->hasResource('resource'));
?> 
```

湾。测试销毁资源

```
<?php
$app->destroyResource('resource');
$this->assertFalse($app->hasResource('resource'));
?> 
```

我认为这是一个坏主意，因为 testDestroyResource 依赖于 testCreateResource。更好的做法是

一种。测试创建资源

```
<?php
$app->createResource('resource');
$this->assertTrue($app->hasResource('resource'));
$app->deleteResource('resource');
?> 
```

湾。测试销毁资源

```
<?php
$app->createResource('resource');
$app->destroyResource('resource');
$this->assertFalse($app->hasResource('resource'));
?> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-08-14T15:39:32.847

如果它们需要按特定顺序运行，那么您的测试确实存在问题。每个测试都应该完全独立于其他测试：它可以帮助您进行缺陷定位，并允许您获得可重复（因此可调试）的结果。

查看[此站点](http://www.xunitpatterns.com)以获取有关如何以避免此类问题的方式对测试进行分解的大量想法/信息。

# .net - 多线程设计最佳实践

> ID：10229
> 
> 赞同：3
> 
> 时间：2008-08-13T19:03:21.427
> 
> 标签：.net, multithreading

考虑这个问题：我有一个程序应该从数据库中获取（比方说）100 条记录，然后对于每条记录，它应该从 Web 服务中获取更新的信息。在这种情况下，有两种方法可以引入并行性：

1.  我在一个新线程上启动对 Web 服务的每个请求。同时线程的数量由一些外部参数控制（或以某种方式动态调整）。

2.  我创建较小的批次（假设每个 10 条记录）并在单独的线程上启动每个批次（以我们的示例为例，10 个线程）。

哪种方法更好，您为什么这么认为？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-08-13T23:35:50.270

选项 3 是最好的：

使用异步 IO。

除非您的请求处理复杂且繁重，否则您的程序将花费 99% 的时间等待 HTTP 请求。

这正是 Async IO 的设计目的 - 让 windows 网络堆栈（或 .net 框架或其他）担心所有等待，只需使用单个线程来调度和“获取”结果。

不幸的是，.NET 框架使它成为一个真正的痛苦。如果您只使用原始套接字或 Win32 api，它会更容易。这是一个使用 C#3 的（经过测试的！）示例：

```
using System.Net; // need this somewhere

// need to declare an class so we can cast our state object back out
class RequestState {
    public WebRequest Request { get; set; }
}

static void Main( string[] args ) {
    // stupid cast neccessary to create the request
    HttpWebRequest request = WebRequest.Create( "http://www.stackoverflow.com" ) as HttpWebRequest;

    request.BeginGetResponse(
        /* callback to be invoked when finished */
        (asyncResult) => { 
            // fetch the request object out of the AsyncState
            var state = (RequestState)asyncResult.AsyncState; 
            var webResponse = state.Request.EndGetResponse( asyncResult ) as HttpWebResponse;

            // there we go;
            Debug.Assert( webResponse.StatusCode == HttpStatusCode.OK ); 

            Console.WriteLine( "Got Response from server:" + webResponse.Server );
        },
        /* pass the request through to our callback */
        new RequestState { Request = request }  
    );

    // blah
    Console.WriteLine( "Waiting for response. Press a key to quit" );
    Console.ReadKey();
} 
```

编辑：

对于 .NET，“完成回调”实际上是在 ThreadPool 线程中触发的，而不是在您的主线程中，因此您仍然需要锁定任何共享资源，但它仍然为您省去了管理线程的所有麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-08-13T19:19:32.017

有两件事要考虑。

### 1\. 处理记录需要多长时间？

如果记录处理非常快，则将记录移交给线程的开销可能会成为瓶颈。在这种情况下，您可能希望捆绑记录，这样您就不必经常交出它们。

如果记录处理运行时间相当长，则差异可以忽略不计，因此更简单的方法（每个线程 1 条记录）可能是最好的。

### 2.你打算启动多少线程？

如果您不使用线程池，我认为您要么需要手动限制线程数，要么需要将数据分成大块。如果记录数量变大，为每条记录启动一个新线程将使您的系统崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-08-13T19:34:24.593

运行程序的计算机可能不是瓶颈，所以： 请记住，HTTP 协议有一个 keep-alive 标头，它可以让您在同一个套接字上发送多个 GET 请求，从而避免与 TCP/IP 握手。不幸的是，我不知道如何在 .net 库中使用它。（应该是可能的。）

回复您的请求也可能会有延迟。您可以尝试确保始终有给定数量的服务器未完成请求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-08-13T19:40:41.133

获取[Parallel Fx](http://www.microsoft.com/downloads/details.aspx?FamilyID=e848dc1d-5be3-4941-8705-024bc7f180ba)。查看 BlockingCollection。使用一个线程为其提供成批的记录，并使用 1 到 n 个线程将记录从集合中拉出以提供服务。您可以控制收集收集的速率，以及调用 Web 服务的线程数。通过 ConfigSection 使其可配置，并通过提供集合 Action 委托使其通用，您将拥有一个不错的小批处理器，您可以重用您的心脏内容。

# string - 检查字符串内容？字符串长度与空字符串

> ID：10230
> 
> 赞同：18
> 
> 时间：2008-08-13T19:03:27.683
> 
> 标签：string, optimization, language-agnostic, compiler-construction

哪个对编译器更有效，以及检查字符串是否为空白的最佳实践？

1.  检查字符串的长度是否== 0
2.  检查字符串是否为空（strVar == ""）

另外，答案是否取决于语言？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-08-13T19:05:42.357

是的，这取决于语言，因为字符串存储因语言而异。

*   帕斯卡类型字符串：`Length = 0`.
*   C 风格的字符串：`[0] == 0`.
*   .NET `.IsNullOrEmpty`：。

等等。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-08-13T19:12:19.177

在使用 C 风格（空终止）字符串的语言中，比较起来`""`会更快。这是一个 O(1) 操作，而 C 风格字符串的长度是 O(n)。

在将长度存储为字符串对象的一部分的语言（C#、Java、...）中，检查长度也是 O(1)。在这种情况下，直接检查长度会更快，因为它避免了构造新空字符串的开销。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-08-13T19:52:16.163

> 在使用 C 风格（空终止）字符串的语言中，与 "" 相比会更快

实际上，最好检查字符串中的第一个字符是否为 '\0'：

```
char *mystring;
/* do something with the string */
if ((mystring != NULL) && (mystring[0] == '\0')) {
    /* the string is empty */
} 
```

在 Perl 中还有第三个选项，即字符串未定义。这与 C 中的 NULL 指针有点不同，只是因为访问未定义字符串时不会出现分段错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-08-13T19:05:54.197

在 .Net 中：

```
string.IsNullOrEmpty( nystr ); 
```

字符串可以为空，因此 .Length 有时会抛出 NullReferenceException

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-08-14T11:26:53.060

`String.IsNullOrEmpty()`仅适用于 .net 2.0 及更高版本，对于 .net 1/1.1，我倾向于使用：

```
if (inputString == null || inputString == String.Empty)
{
    // String is null or empty, do something clever here. Or just expload.
} 
```

我使用 String.Empty 而不是 "" 因为 "" 将创建一个对象，而 String.Empty 不会 - 我知道它是一些小而微不足道的东西，但是当我不需要它们时，我仍然宁愿不创建对象！（[来源](http://blogs.msdn.com/brada/archive/2003/04/22/49997.aspx)）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-13T19:30:28.063

在 Java 1.6 中，String 类有一个新方法 [isEmpty] [1](http://java.sun.com/javase/6/docs/api/java/lang/String.html#isEmpty())

还有 Jakarta commons library，它有 [isBlank] [2](http://web.archive.org/web/20100802010006/http://commons.apache.org:80/lang/api/org/apache/commons/lang/StringUtils.html)方法。空白定义为仅包含空格的字符串。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-08-13T19:51:33.653

对于 C 字符串，

```
if (s[0] == 0) 
```

会比任何一个都快

```
if (strlen(s) == 0) 
```

或者

```
if (strcmp(s, "") == 0) 
```

因为您将避免函数调用的开销。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-02-21T17:17:42.363

假设您的问题是 .NET：

如果您想验证您的字符串是否为空，请使用 IsNullOrEmpty，如果您已经知道您的字符串不为空，例如在检查 TextBox.Text 等时，请不要使用 IsNullOrEmpty，然后提出您的问题。
因此，在我看来，String.Length 的性能不如字符串比较。

我对它进行了测试（我也用 C# 进行了测试，结果相同）：

```
Module Module1
  Sub Main()
    Dim myString = ""

    Dim a, b, c, d As Long

    Console.WriteLine("Way 1...")

    a = Now.Ticks
    For index = 0 To 10000000
      Dim isEmpty = myString = ""
    Next
    b = Now.Ticks

    Console.WriteLine("Way 2...")

    c = Now.Ticks
    For index = 0 To 10000000
      Dim isEmpty = myString.Length = 0
    Next
    d = Now.Ticks

    Dim way1 = b - a, way2 = d - c

    Console.WriteLine("way 1 took {0} ticks", way1)
    Console.WriteLine("way 2 took {0} ticks", way2)
    Console.WriteLine("way 1 took {0} ticks more than way 2", way1 - way2)
    Console.Read()
  End Sub
End Module 
```

结果：

```
Way 1...
Way 2...
way 1 took 624001 ticks
way 2 took 468001 ticks
way 1 took 156000 ticks more than way 2 
```

这意味着比较不仅仅是字符串长度检查。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-12-13T07:13:43.000

读完这篇文章后，我做了一个小实验，得出了两个截然不同且有趣的发现。

考虑以下。

```
strInstallString    "1" string 
```

以上是从 Visual Studio 调试器的本地窗口复制而来的。以下三个示例都使用相同的值。

**if (strInstallString == "") === if (strInstallString == string.Empty)**

以下是 Visual Studio 2013 调试器的反汇编窗口中显示的这两种基本相同情况的代码。

```
if ( strInstallString == "" )
003126FB  mov         edx,dword ptr ds:[31B2184h]
00312701  mov         ecx,dword ptr [ebp-50h]
00312704  call        59DEC0B0            ; On return, EAX = 0x00000000.
00312709  mov         dword ptr [ebp-9Ch],eax
0031270F  cmp         dword ptr [ebp-9Ch],0
00312716  sete        al
00312719  movzx       eax,al
0031271C  mov         dword ptr [ebp-64h],eax
0031271F  cmp         dword ptr [ebp-64h],0
00312723  jne         00312750

if ( strInstallString == string.Empty )
00452443  mov         edx,dword ptr ds:[3282184h]
00452449  mov         ecx,dword ptr [ebp-50h]
0045244C  call        59DEC0B0        ; On return, EAX = 0x00000000.
00452451  mov         dword ptr [ebp-9Ch],eax
00452457  cmp         dword ptr [ebp-9Ch],0
0045245E  sete        al
00452461  movzx       eax,al
00452464  mov         dword ptr [ebp-64h],eax
00452467  cmp         dword ptr [ebp-64h],0
0045246B  jne         00452498 
```

**if (strInstallString == string.Empty) 没有显着差异**

```
if ( strInstallString.Length == 0 )
003E284B  mov         ecx,dword ptr [ebp-50h]
003E284E  cmp         dword ptr [ecx],ecx
003E2850  call        5ACBC87E        ; On return, EAX = 0x00000001.
003E2855  mov         dword ptr [ebp-9Ch],eax
003E285B  cmp         dword ptr [ebp-9Ch],0
003E2862  setne       al
003E2865  movzx       eax,al
003E2868  mov         dword ptr [ebp-64h],eax
003E286B  cmp         dword ptr [ebp-64h],0
003E286F  jne         003E289C 
```

从以上由.NET Framework 4.5 版的NGEN 模块生成的机器代码清单，我得出以下结论。

1.  对空字符串文字和 System.string 类上的静态 string.Empty 属性进行相等性测试，就所有实际目的而言，都是相同的。两个代码片段之间的唯一区别是第一个移动指令的来源，两者都是相对于 ds 的偏移量，这意味着它们都引用了烘焙常量。

2.  对空字符串（作为文字或 string.Empty 属性）进行相等性测试，会设置一个双参数函数调用，它通过返回零来表示*不相等。*我基于几个月前执行的其他测试得出这个结论，在这些测试中，我遵循了一些我自己的代码，跨越了托管/非托管的鸿沟并返回。在所有情况下，任何需要两个或更多参数的调用都将第一个参数放在寄存器 ECX 中，将第二个参数放在寄存器 EDX 中。我不记得后来的论点是如何通过的。尽管如此，呼叫设置看起来更像 __fastcall 而不是 __stdcall。同样，预期的返回值总是出现在寄存器 EAX 中，这几乎是通用的。

3.  测试字符串的长度会建立一个单参数函数调用，它返回 1（在寄存器 EAX 中），这恰好是被测试字符串的长度。

4.  鉴于立即可见的机器代码几乎相同，我能想象到的唯一原因是字符串相等性优于**Shinny**报告的字符串长度的唯一原因是执行比较的双参数函数明显更好比从字符串实例中读取长度的单参数函数进行了优化。

**结论**

作为一个原则问题，我避免将空字符串作为文字进行比较，因为空字符串文字在源代码中可能显得模棱两可。为此，我的 .NET 帮助程序类早就将空字符串定义为常量。尽管我使用**string.Empty**进行直接的内联比较，但该常量仍可用于定义其他值为空字符串的常量，因为不能将常量指定为**string.Empty**作为其值。

这个练习一劳永逸地解决了我可能对与**string.Empty**或我的助手类定义的常量进行比较的成本（如果有的话）的任何担忧。

然而，它也提出了一个令人费解的问题来取代它；为什么与**string.Empty**进行比较比测试字符串的长度更有效？或者由于循环的实现方式，Shinny 使用的测试是否无效？（我觉得这很难相信，但话说回来，我以前也被愚弄过，我相信你也一样！）

我一直认为**system.string**对象是计数字符串，基本上类似于我们从 COM 早就知道的长期建立的基本字符串 (BSTR)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-08-13T19:06:38.877

实际上，IMO 最好的确定方法是字符串类的 IsNullOrEmpty() 方法。

[http://msdn.microsoft.com/en-us/library/system.string.isnullorempty。](http://msdn.microsoft.com/en-us/library/system.string.isnullorempty.)

更新：我假设.Net，在其他语言中，这可能会有所不同。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-08-13T19:35:37.680

> 在这种情况下，直接检查长度会更快，因为它避免了构造新空字符串的开销。

@DerekPark：这并不总是正确的。"" 是一个字符串文字，所以在 Java 中，它几乎肯定已经被实习了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-08-13T20:00:55.633

@内森

> 实际上，最好检查字符串中的第一个字符是否为 '\0'：

我几乎提到了这一点，但最终将其忽略了，因为`strcmp()`使用空字符串调用并直接检查字符串中的第一个字符都是 O(1)。您基本上只需为额外的函数调用付费，这非常便宜。但是，如果您*真的*需要绝对的最佳速度，请务必进行直接的 first-char-to-0 比较。

老实说，我总是使用`strlen() == 0`，因为我*从来没有*写过一个程序，这实际上是一个可测量的性能问题，我认为这是表达检查的最易读的方式。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-02T17:32:08.123

同样，如果不了解语言，就无法分辨。

但是，我建议您选择对后续维护程序员最有意义的技术，并且必须维护您的工作。

我建议编写一个明确执行您想要的功能的函数，例如

```
#define IS_EMPTY(s) ((s)[0]==0) 
```

或可比的。现在毫无疑问，您正在检查。

# browser - 如何让 PNG 透明度在本身不支持它的浏览器中工作？

> ID：10243
> 
> 赞同：12
> 
> 时间：2008-08-13T19:09:24.113
> 
> 标签：browser, png, transparency

我们（心爱的）设计师不断创建具有透明背景的 PNG 文件，以便在我们的应用程序中使用。我想确保 PNG 的此功能也适用于“旧”浏览器。最好的解决方案是什么？

*下面的编辑*

@mabwi & @syd - 我是否同意使用 PNG 不是重点。这是我需要解决的问题！

@Tim Sullivan - IE7.js 看起来很酷，但我认为我不想介绍应用程序的所有其他更改。我想要一个专门解决 PNG 问题的解决方案。感谢您的链接。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-08-13T20:39:54.803

我在这里找到了一个非常好的解决方案：[Unit Interactive -> Labs -> Unit PNG Fix](http://web.archive.org/web/20170521133429/http://labs.unitinteractive.com:80/unitpngfix.php)

*更新*Unit PNG 也出现[在 NETTUTS 上的 PNG 修复选项列表中](http://nettuts.com/videos/screencasts/5-easy-ways-to-tackle-ie6s-transparency-issues/)

以下是他们网站上的亮点：

*   非常紧凑的 javascript：不到 1kb！
*   修复了一些由 IE 的 filter 属性引起的交互问题。
*   适用于 img 对象和背景图像属性。
*   自动运行。您不必定义类或调用函数。
*   允许自动宽度和自动高度元素。
*   部署超级简单。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T14:08:03.403

*   [IE PNG Fix 2.0](http://www.twinhelix.com/css/iepngfix/)支持`background-position`和`-repeat`！

*还存在具有完全 alpha 透明度*的调色板 8 位 PNG ，这与 Photoshop 和 GIMP 可能让你相信的相反，它们在 IE6 中的降级更好——它只是将透明度降低到 1 位。使用[pngquant](http://pngquant.org/)从 24 位 PNG 生成此类文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T13:29:34.007

在 IE6 中使用 PNG 几乎不比任何其他浏览器更难。您可以在没有 Javascript 的情况下在您的 CSS 中支持所有这些。我以前看过这个黑客...

```
div.theImage {
    background  : url(smile.png) top left no-repeat;
    height      : 100px;
    width       : 100px;
}

* html div.theImage {
    background  : none;     
    progid:DXImageTransform.Microsoft.AlphaImageLoader(src="layout/smile.png", sizingMethod="scale");
} 
```

我不太确定这是有效的 CSS，但根据站点的不同，它可能并不重要。

（值得注意的是，第一张图片的 URL 是基于样式表的目录，而第二张图片的 URL 是基于正在查看的页面的目录 - 因此它们不匹配）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T13:56:00.183

@Hboss

如果您确切地知道要显示的所有文件（以及每个文件的尺寸），那就太好了——维护那个 CSS 文件会很痛苦，但我想这是可能的。当您想出于某些非常常见的目的开始使用透明 PNG 时：a) 附带的图形，例如适用于任何背景的图标（可能大小不同），以及 b) 重复背景；那你就完蛋了。我尝试过的每个解决方法都在某个时候遇到了障碍（当背景透明时无法选择文本，*有时*图像以古怪的尺寸显示等等），我发现为了获得最大的可靠性，我'将不得不恢复为 gif。

我的建议是尝试一下 PNG 透明度，但同时要意识到它绝对不是完美的——请记住，**对于 7 岁以上浏览器**的用户，您正在向后弯腰。这些天我所做的是在 IE6 用户第一次访问该网站时弹出一个窗口，并友好地提醒他们的浏览器已经过时并且不提供现代网站所需的功能，尽管我们会尽力给您最好的，如果您升级得很好，您将从我们的网站和整个互联网获得更好的体验。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-08-13T19:12:56.477

[IE7.js](http://code.google.com/p/ie7-js/)将在 IE6 中提供对 PNG（包括透明度）的支持。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-08-13T23:31:12.307

我一直在尝试用 .pngs 创建一个网站，但这并不值得。网站变慢了，而且你使用了不能 100% 工作的黑客。这是[一篇关于一些选项的好文章](http://24ways.org/2007/supersleight-transparent-png-in-ie6)，但我的建议是找到一种方法让 gif 工作，直到你不必支持 IE6。或者只是给 IE6 一个降级的体验。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-08-13T19:34:04.093

我相信所有浏览器都支持 PNG-8。它不是 alpha 混合的，但它确实具有透明背景。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-08-13T23:11:57.807

> 我可能弄错了，但我很确定 IE6 和更少的只是不使用 PNG 文件做透明度。

你有点是，你有点不是。

IE6 本身不支持它们。

然而，IE 支持疯狂的自定义 javascript/css 和 COM 对象（这是他们最初实现 XmlHttpRequest 的方式）

所有这些黑客基本上都是这样做的：

*   找到所有的 png 图像
*   使用 directx 图像过滤器加载它们并以 IE 理解的某种格式生成透明图像
*   用过滤后的副本替换图像。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T23:24:49.570

要考虑的一件事是电子邮件客户端。您经常需要 PNG-24 透明度，但在 Outlook 2003 中使用的是使用 IE6 的机器。电子邮件客户端不允许使用 CSS 或 JS 技巧。

这是处理该问题的好方法。 [http://commadot.com/png-8-that-acts-like-png-24-without-fireworks/](http://commadot.com/png-8-that-acts-like-png-24-without-fireworks/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-08T14:31:22.390

如果您从 Fireworks 将图像导出为 PNG-8，那么它们的作用与 gif 图像相同。所以它们不会看起来很糟糕和灰色，透明度将是透明的，但它们不会像其他浏览器那样具有完整的 24 位可爱。

可能无法完全解决您的问题，但至少您可以部分解决问题，只需将它们重新导出即可。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-08-13T19:12:49.910

我可能弄错了，但我很确定 IE6 和更少的只是不使用 PNG 文件做透明度。

我有两个我使用的“解决方案”。要么创建具有透明度的 GIF 文件并在任何地方使用它们，要么只将它们用于 IE 6 和更早版本的条件样式表。第二个只有在您将它们用作背景等时才有效。

# asp.net - .NET Framework 3.5 中有哪些有用的新 ASP.NET 功能？

> ID：10260
> 
> 赞同：7
> 
> 时间：2008-08-13T19:18:07.667
> 
> 标签：asp.net

随着 C# 语言从第 1 版到第 3 版的更新，我一直在了解它的新功能。我在与 ASP.NET 保持同步方面做得还不够好。我觉得第 1 版后的一些功能不是那么好（例如 AJAX 框架）或者对我没有那么有用（例如会员框架）。任何人都可以推荐任何可能被忽视的新杀手级 ASP.NET 功能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-08-14T08:39:11.060

对于 ASP.NET，您有很多改进：

*   拆分视图（代码和设计）
*   在代码和设计视图之间更快地切换
*   嵌入式母版页（一个母版页在另一个）
*   javascript调试

无论如何，大多数有用的东西实际上都在语言的实质中，对于 .NET 3.5，C# 3.0 的新语言特性将是（是的，我发现它们都很有用）

*   匿名对象
*   自动属性
*   对象初始化器
*   集合初始化器（集合的内联初始化）
*   隐式类型（var 关键字）
*   lambda 表达式
*   LINQ
*   扩展方法

我可能忘记了一些，但我认为这是关于大多数新的很酷*和*有用的东西。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-08-13T19:26:42.237

查看基于 3.5 构建的[MVC 框架。](http://weblogs.asp.net/scottgu/archive/2007/10/14/asp-net-mvc-framework.aspx)对传统网络表单模型的重大改进。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-08-13T19:23:07.783

我还在学习 ASP.net，所以我不能确切地告诉你，但如果你浏览[http://www.asp.net/learn/](http://www.asp.net/learn/)，你可能会发现一些新的宝石，甚至还有 3.5 部分。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-08-13T21:03:54.537

ListView 和它的朋友 DataPager 可能值得一看，但它们几乎不是“杀手”功能。

特别是 ASP.NET 之外的东西（例如 LINQ）可能更有可能获得“杀手”的称赞。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-08-13T19:28:09.787

它的[MVC 框架](http://www.asp.net/mvc/)。没有 3.5，就没有 MVC。没有 MVC，ASP.NET 就是一个 PITA。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-13T21:12:48.153

> 母版页
> 
> （当然，这些都是从 2.0 版开始的）

**嵌套**母版页是 3.5 中的新功能。我还没有使用它们，但我只能想象如果不小心使用它们可能会变成一场可怕的噩梦。

您只需要查看在使用母版页的页面[中触发事件的顺序来思考“呃”。](http://msdn.microsoft.com/en-us/library/dct97kc3.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-08-13T21:51:47.857

> 我认为 MVC 框架还没有为黄金时间做好准备

仅供参考，这个网站是用 MVC 构建的。我在 mvc 上也有 2 个正在生产中的应用程序，我认为它绝对准备好迎接黄金时段。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-08-13T23:25:05.890

@IainMH 嵌套母版页始终受到 ASP.NET 的支持，只是设计师不支持。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-08-14T08:35:30.553

正如其他人所说，[www.asp.net](http://www.asp.net/learn/3.5-videos/) /learn 上有一个很好的列表。我认为最大的 ASP.NET 特定变化是：

*   官方 ASP.NET AJAX 集成
*   ListView（比 GridView / DataView 好得多，因为它们可以让你写出干净的 HTML）
*   用于 CSS / HTML 编辑的 IDE 的重大改进
*   Javascript调试

请注意，ASP.NET MVC 尚未发布，并且绝对不包含在 ASP.NET 3.5 中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-08-14T09:57:18.830

这是我最喜欢的简短列表：

*   LINQ
*   扩展方法
*   Lambda 方法

而且我实际上并没有使用 ASP.NET，但是 ASP.NET AJAX 现在也包含在 3.5 中，而 ASP.NET MVC 也包含在 3.5 SP1 中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-08-13T20:22:25.213

我认为 MVC 框架还没有为黄金时间做好准备，尽管我肯定计划在明年的某个时候使用它。我喜欢干净的 URL、干净的 XHTML（Web 表单真的会吐出一些讨厌的 HTML）以及创建没有关联视图的控制器操作的能力。

自从母版页发布以来，我一直在使用它们，它们提供了很大的帮助。我真的不喜欢母版页将讨厌的前缀添加到控件 ID 的方式。它会产生一些丑陋的 CSS。我认为 MVC 框架可能会消除这个问题。

还有其他杀手级功能吗？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-08-13T21:15:14.810

拆分设计/代码视图非常酷。它还不完美，但它很酷。现在也在设计视图中编辑你的css，然后。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-07T15:38:42.673

还必须考虑动态数据

# c# - 什么时候不应该在 .Net 中使用 ThreadPool？

> ID：10274
> 
> 赞同：40
> 
> 时间：2008-08-13T19:24:22.337
> 
> 标签：c#, .net, multithreading, design-decisions

**什么时候不**应该在 .Net 中使用 ThreadPool？

看起来最好的选择是使用线程池，在这种情况下，为什么它不是唯一的选择？

您对此有何经验？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-08-13T21:05:26.250

@Eric，我将不得不同意 Dean 的观点。线程很昂贵。您不能假设您的程序是唯一运行的程序。当每个人都贪图资源时，问题就会成倍增加。

> 我更喜欢手动创建线程并自己控制它们。它使代码非常容易理解。

合适的时候就好了。但是，如果您需要一堆工作线程，那么您所做的就是让您的代码更加复杂。现在您必须编写代码来管理它们。如果您只是使用线程池，您将免费获得所有线程管理。并且该语言提供的线程池很可能比您自己滚动的任何东西都更健壮、更高效且错误更少。

> ```
> Thread t = new Thread(new ThreadStart(DoSomething));  
> t.Start();  
> t.Join(); 
> ```

我希望您通常在`Start()`和之间有一些额外的代码`Join()`。否则，多余的线程是没有用的，你在无缘无故地浪费资源。

> 人们太害怕线程使用的资源。我从未见过创建和启动线程花费超过一毫秒。您可以创建的线程数没有硬性限制。RAM 使用率极低。一旦你有几百个线程，CPU 就会因为上下文切换而成为一个问题，所以此时你可能想要对你的设计有所了解。

在现代硬件上，一毫秒是很*长的时间。*这是 3GHz 机器上的 300 万个周期。再说一次，你不是唯一一个创建线程的人。您的线程与所有其他程序的线程一起竞争 CPU。如果您使用了不太多的线程，另一个程序也是如此，那么您一起使用了太多的线程。

> 说真的，不要让生活变得比它需要的更复杂。除非您需要它提供的非常具体的东西，否则不要使用线程池。

确实。不要让生活变得更复杂。如果您的程序需要多个工作线程，请不要重新发明轮子。使用线程池。这就是它在那里的原因。你会推出自己的弦乐课程吗？

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-08-13T19:32:25.253

我不使用便宜的多线程的唯一原因`ThreadPool`是如果我需要……

1.  与正在运行的方法交互（例如，杀死它）
2.  [在STA 线程](http://msdn.microsoft.com/en-us/library/system.stathreadattribute.aspx "单线程单元线程； 参见例如这个 MSDN 参考页的 STAThreadAttribute")上运行代码（这发生在我身上）
3.  在我的应用程序死亡后保持线程处于活动状态（`ThreadPool`线程是后台线程）
4.  以防我需要更改线程的优先级。我们无法更改默认为 Normal 的 ThreadPool 中线程的优先级。

> **PS：** MSDN 文章[*“托管线程池”*](http://msdn.microsoft.com/en-us/library/0ka9477y.aspx "托管线程池（MSDN 上的页面）")包含标题为*“何时不使用线程池线程”*的部分，其中包含一个非常相似但稍微更完整的不使用线程池的可能原因列表。

您需要跳过 的原因有很多`ThreadPool`，但如果您不知道它们，那么`ThreadPool`应该对您来说已经足够了。

或者，查看新的[Parallel Extensions Framework](https://docs.microsoft.com/en-us/visualstudio/extensibility/debugger/parallel-extension-internals-for-the-dotnet-framework)，其中有一些简洁的东西可以满足您的需求，而无需使用`ThreadPool`.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-08-13T19:32:16.267

只要您有工作线程的概念，线程池就有意义。任何时候您可以轻松地将处理划分为较小的作业，每个作业都可以独立处理，工作线程（因此是线程池）是有意义的。

当您需要执行完全不同且不相关的操作的线程时，线程池没有意义，这些操作不能被视为“作业”；例如，一个线程用于 GUI 事件处理，另一个用于后端处理。当处理形成管道时，线程池也没有意义。

基本上，如果您有启动、处理作业和退出的线程，那么线程池可能是要走的路。否则，线程池并没有真正的帮助。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-08-13T19:34:29.273

对于 quarrelsome 的回答，我要补充一点，如果您需要保证您的线程将立即开始工作，最好不要使用 ThreadPool 线程。每个应用程序域的最大运行线程池线程数是有限的，因此如果它们都忙，您的工作可能不得不等待。毕竟，它被称为“队列用户工作项”。

当然，有两个警告：

1.  您可以在运行时更改代码中线程池线程的最大数量，因此没有什么可以阻止您检查当前与最大数量并在需要时提高最大值。
2.  启动一个新线程会带来时间上的损失——你是否值得接受这个打击取决于你的情况。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-08-13T22:08:27.857

> 我不是作为一个只有理论知识的人说话。我编写和维护大量使用多线程的大量应用程序，我通常不认为线程池是正确的答案。

啊，来自权威的论点——但请始终留意可能在 Windows 内核团队中的人。

我们都没有争论这样一个事实，即如果您有一些特定的要求，那么 .NET 线程池可能不是正确的选择。我们反对的是创建线程的机器成本微不足道。

首先在 ThreadPool 的存在理由中创建线程的巨大费用。我不希望我的机器被那些被错误告知创建线程的费用的人编写的代码填充，并且不知道它会导致在每个单独的 DLL 中调用一个方法附加到进程（其中一些将由第 3 方创建），并且很可能会启动大量根本不需要在 RAM 中并且几乎可以肯定不需要在 L1 中的代码。

现代机器中内存层次结构的形状意味着“分散” CPU 的注意力是您可能做的最糟糕的事情，每个关心自己工艺的人都应该努力避免它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-13T19:27:42.673

当您要执行一个需要很长时间的操作时，或者可能是一个连续的后台线程。我想您总是可以将池中可用的线程数量推高，但不会产生永远不会返回池的线程的管理成本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-13T04:45:32.770

MSDN 在这里列出了一些原因：

[http://msdn.microsoft.com/en-us/library/0ka9477y.aspx](http://msdn.microsoft.com/en-us/library/0ka9477y.aspx)

> 有几种情况适合创建和管理自己的线程而不是使用线程池线程：
> 
> *   您需要一个前台线程。
> *   您需要一个线程具有特定的优先级。
> *   您的任务会导致线程长时间阻塞。线程池具有最大线程数，因此大量阻塞的线程池线程可能会阻止任务启动。
> *   您需要将线程放入单线程单元中。所有 ThreadPool 线程都在多线程单元中。
> *   您需要有一个与线程相关联的稳定身份，或者将线程专用于某项任务。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-30T20:57:44.627

线程池线程适用于满足以下两个条件的任务：

1.  该任务将不必花费任何大量时间等待某事发生
2.  等待任务完成的任何事情都可能会等待许多任务完成，因此它的调度优先级不会对事情产生太大影响。

使用线程池线程而不是创建新线程将节省大量但有限的时间。如果该时间与执行任务所需的时间相比很重要，那么线程池任务可能是合适的。然而，执行任务所需的时间越长，使用线程池的好处就越小，任务阻碍线程池效率的可能性就越大。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-08-13T22:05:27.050

@埃里克

> @Derek，我不完全同意您用作示例的场景。如果您不确切知道您的机器上正在运行什么，以及您的应用在一定负载下将使用多少总线程、句柄、CPU 时间、RAM 等，那么您就有麻烦了。

您是您编写的程序的唯一目标客户吗？如果不是，您无法确定其中的大部分内容。当您编写程序时，您通常不知道它是否会有效地单独执行，或者它是否会在受到 DDOS 攻击的网络服务器上运行。您无法知道您将拥有多少 CPU 时间。

假设您的程序的行为会根据输入而发生变化，甚至很难确切地知道您的程序将消耗多少内存或 CPU 时间。当然，您应该对程序的运行方式有一个很好的了解，但是大多数程序从不分析以确定将使用多少内存、多少句柄等，因为全面分析的成本很高。如果您不编写实时软件，那么付出的努力是不值得的。

一般来说，声称确切地知道你的程序将如何运行是牵强附会的，并且声称知道关于机器的一切都是荒谬的。

> 老实说，如果您不确切知道应该使用什么方法：手动线程、线程池、委托，以及如何实现它来满足您的应用程序的需求，那么您就有麻烦了。

我并不完全不同意，但我真的不明白这有什么关系。这个网站专门在这里，因为程序员并不总是有所有的答案。

> 如果您的应用程序足够复杂，需要限制您使用的线程数量，您是否几乎总是想要比框架提供的更多控制？

不。如果我需要一个线程池，我将使用提供的线程池，除非并且直到我发现它还不够。我不会简单地假设提供的线程池不足以满足我的需求，而无需确认是这种情况。

> 我不是作为一个只有理论知识的人说话。我编写和维护大量使用多线程的大量应用程序，我通常不认为线程池是正确的答案。

我的大部分专业经验都与多线程和多处理程序有关。我也经常需要推出自己的解决方案。这并不意味着线程池在许多情况下没有用或不合适。线程池是为处理工作线程而构建的。在适合多个工作线程的情况下，提供的线程池通常应该是第一种方法。

# performance - 有人在生产中使用过 Jaxer 吗？

> ID：10293
> 
> 赞同：9
> 
> 时间：2008-08-13T19:35:31.643
> 
> 标签：performance, aptana, jaxer

有没有人在生产环境中使用过[Jaxer](http://web.archive.org/web/20090803092709/http://www.aptana.com:80/Jaxer)，我很好奇它与 php、ruby 等相比如何保持，以及是否有人知道使用它的任何众所周知的陷阱。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-08-14T12:09:46.950

@Stu：不一定，也许有很多人在使用它并且没有问题。我喜欢只需编写一次验证的概念，对客户端和服务器端的所有内容使用一种语言听起来是一种有趣的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-08-13T20:35:48.667

一般来说，如果你不得不问这个问题，那是个坏主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-08-30T03:32:46.207

我会将此[网址](http://www.ibm.com/developerworks/web/library/wa-aj-jaxer/index.html?ca=dgr-jw64wa-aj-jaxer&S_TACT=105AGY46&S_CMP=GRsitejw64)添加到我今天找到的帖子中，它包含一些有关该主题的信息，但没有真正的“性能”信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-21T05:59:55.003

我已经发布了一个[类似的问题](https://stackoverflow.com/questions/98915/is-anyone-familiar-with-jaxer-im-looking-for-pros-and-cons)并得到了答复……目前还没有太多信息。

我确实遇到了这组[性能基准](http://www.aptana.com/taxonomy/term/14)，并且我还发布了一个关于[Jaxer 中面向对象开发](https://stackoverflow.com/questions/109762/defining-objects-when-using-jaxer)的问题，我认为这可能会留下一些不足之处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-16T22:54:02.240

我想我会回答这个问题，以免让它挂起。这个答案与 Jaxer 没有直接关系，但自从提出了这个问题。诸如 Node.JS 之类的技术已经问世，它带来了 Jaxer 提出的相同想法和技术，并表明 Javascript 可以像在前端一样在 Web 技术堆栈的后端也是可行的。

# asp.net-mvc - 在 ASP.NET MVC 框架中验证已发布的表单数据

> ID：10300
> 
> 赞同：10
> 
> 时间：2008-08-13T19:45:33.917
> 
> 标签：asp.net-mvc, validation

我一直在使用 ASP.NET MVC 框架，而真正让我困惑的一件事是我打算如何对已发布的表单数据进行服务器端验证。我假设我没有回发到同一个 URL，但如果我不发回，我如何重新显示带有输入数据和错误消息的表单？另外，验证逻辑应该去哪里？在模型或控制器中？这似乎是 Web 表单强大得多的少数几个领域之一（我错过了验证控件）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-08-13T23:15:32.277

以下是 MVC 中的流程概述：

1.  /new - 呈现您的“新”视图，其中包含供用户填写的表单
    *   用户填写表格并将其发布到 /create
    *   帖子被路由到控制器上的 Create 操作
    *   在您的操作方法中，使用已发布的数据更新模型。
    *   您的模型应该自我验证。
    *   如果模型有效，您的控制器应该读取。
    *   如果模型有效，请将其保存到您的数据库中。重定向到 /show 以呈现对象的显示视图。
    *   如果 Model 无效，请将表单值和错误消息保存在 TempData 中，然后再次重定向到 New 操作。使用 TempData 中的数据填写表单字段并显示错误消息。

验证框架将在此过程中为您提供帮助。另外，我认为 ASP.NET MVC 团队正在为下一次预览计划一个验证框架。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-05T12:29:11.297

您可能想看看 ScottGu 为 ASP.Net prev 5 发布的最新帖子。它介绍了一个非常有趣的验证示例：

[http://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx](http://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-19T13:50:59.240

据我所知，每个人仍在试图找出“标准”的做法。也就是说，请务必查看 Phil Haack 和 Scott Guthrie 在 MVC 上的最新帖子，您会发现一些关于他们如何做的有趣信息。当我自己玩弄它时，我为我生成的 LinqToSql 数据类创建了一个 ModelBinder。您可以查看这篇文章以了解如何组合一个基本的 ModelBinder：

[ASP.Net MVC 模型绑定器](http://blog.maartenballiauw.be/post/2008/08/29/Using-the-ASPNET-MVC-ModelBinder-attribute.aspx)

如果您创建了一个“产品”ModelBinder，那么在您的操作中，您只需像这样声明该操作：

public ActionResult New(Product prod)

并且模型绑定器将负责将发布的数据分配给对象属性，只要您已经正确构建它。

之后在您的 GetValue() 方法中，您可以实现任何您想要的验证，无论是使用异常、正则表达式还是任何您可以拨打电话的方式：

(ModelStateDictionary_name).AddModelError("form_element_id", "entered_value", "error_message");

然后你可以在你的视图中抛出一个 <%= Html.ValidationSummary() %> 来显示你所有的错误。

对于客户端验证，我只使用了 jQuery。在获得基本示例设置后，您可以开始做一些有趣的事情，将所有这些与部分视图和 Ajax 调用结合起来。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-08-13T19:59:49.783

你看过这个吗？ [http://www.codeplex.com/MvcValidatorToolkit](http://www.codeplex.com/MvcValidatorToolkit)

从页面引用

> Validator Toolkit 为新的 ASP.NET MVC 框架提供了一组验证器，以使用验证集在客户端和服务器端验证 HTML 表单。

恐怕比我更精通 MVC 的人不得不谈论你应该在架构中的哪个位置放置东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-13T20:58:00.540

我也只是在学习 MVC 框架，所以我不确定这有多好，但据我了解，您将在诸如 Edit.aspx 之类的视图上拥有一个表单。然后，此表单将向控制器发布到另一个操作方法，例如 Update()，将您在 Edit.aspx 中设置的表单内容作为参数传递。

```
Update(int id, string name, string foo) 
```

您可以在该方法中进行验证。如果一切正常，

```
return View("Item", yourObject) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-08-22T12:36:40.987

Castle 项目中有[Castle.Components.Validator](http://209.85.135.104/search?q=cache:EzaP2dgUM9cJ:hammett.castleproject.org/%3Fp%3D114+Castle.Components.Validator&hl=ru&ct=clnk&cd=2&gl=ru&client=firefox-a)模块。它非常敏捷和强大。它基于模型属性（或任何其他来源）生成验证规则，甚至能够使用 jQuery、Prototype Validation、fValidate 等生成 JS 验证。当然，将验证器抽象到 IValidationEngine 接口后面是明智的。

# database - 我可以使用哪些 FoxPro 数据工具来查找损坏的数据？

> ID：10303
> 
> 赞同：3
> 
> 时间：2008-08-13T19:51:02.437
> 
> 标签：database, foxpro

我有一些从 FoxPro 数据库导入数据的 SQL Server DTS 包。直到最近，这一切都很好。现在，从 FoxPro 表之一导入数据的脚本将大约 470,000 条记录轰炸到导入中。我只是将数据拉入带有可为空的 varchar 字段的表中，所以我认为这一定是一个奇怪/损坏的数据问题。

你会使用什么工具来追踪这样的问题？

仅供参考，这是我得到的错误：

> 源列 1（“field1”）的数据不可用。您的提供程序可能要求所有 Blob 列都位于源结果集中的最右侧。

此表中不应有任何 blob 列。

* * *

感谢您的建议。我不确定这是否是腐败问题。我刚开始从我的 MSDN 订阅中下载 FoxPro，所以我看看能不能打开表。SSRS 打开表，在遍历所有记录之前它只是窒息。我只是想找出它有问题的记录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-08-13T20:34:58.887

[Cmrepair](http://www.cmstory.com/_cm/CMrepair.zip)是一款出色的免费软件实用程序，可修复损坏的 .DBF 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-08-14T15:28:39.280

在 470,000 条记录时，您可能需要检查是否接近 FoxPro 表大小的 2 GB 限制。据我了解，记录仍然可以在那里，但在 2 gig 点之后变得无法访问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-13T19:58:04.047

您是否尝试过编写一个仅将现有数据复制到新表的小程序？

还，

[http://fox.wikis.com/wc.dll?Wiki~TableCorruptionRepairTools~VFP](http://fox.wikis.com/wc.dll?Wiki~TableCorruptionRepairTools~VFP)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-08-14T01:10:07.053

我的公司使用 Foxpro 来存储相当多的数据...根据我的经验，数据损坏非常明显，表首先无法打开。你有 foxpro 的副本来打开表吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-14T12:39:24.643

@槊：

如果您有权访问 Visual FoxPro 命令行窗口，请键入：

```
SET TABLEVALIDATE 11
USE "YourTable" EXCLUSIVE    && If the table is damaged VFP must display an error here
PACK    && To reindex the table and deleted "marked" records
PACK MEMO    && If you have memo fields 
```

完成后，表的结构必须有效，如果您想查看包含无效数据的字段，您可以尝试：

```
SELECT * FROM YourTable WHERE EMPTY(YourField)   && All records with YourField empty
SELECT * FROM YourTable WHERE LEN(YourMemoField) > 200   && All records with a long memo field, there can be corrupted data 
```

等等

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-19T19:31:59.810

免费使用我的网站 (www.shershahsoft.com) 上的修复数据库（并且永远免费）。

我设计了这个程序来修复损坏的 Foxpro/FoxBase/Dbase 文件。该程序非常快。它将在不到一分钟的时间内修复 1 GB 表。

您可以将文件和文件夹分配给程序。当您启动程序时，它将标记所有损坏的文件，并通过单击修复或检查并修复按钮，它将修复所有损坏的文件。此外，它将在实际数据所在的文件夹中创建一个文件夹“CorruptData”，并将损坏文件的副本保存在那里。

要记住的一件事是，始终在存储文件的驱动器上运行 Windows CheckDsk。原因，当正在将记录复制到表中并且发生电源故障时，存在丢失的簇，Windows 在 CheckDsk 期间将其转换为文件。之后，RepairDatabases 将为您完成这项工作。

我使用过许多修复表格的付费和免费程序，但所有这些程序都会在表格中留下带有 embigit 字符的额外记录（而且它们也很耗时）。程序员需要手动查找和删除此类记录。但是，Repair Databases 实际上恢复了原始记录，您无需进一步操作。您需要的唯一操作是重新索引文件。

在修复过程中，有时会出现文件打开对话框，要求为具有索引的表定位紧凑索引文件。您可以在此时单击取消对话框，该表将被修复，但是，您稍后需要重新索引文件。（此对话框可能会出现多次，具体取决于损坏的索引数。）

# svn - SVN 分支/合并活动的图形表示

> ID：10308
> 
> 赞同：32
> 
> 时间：2008-08-13T19:55:06.393
> 
> 标签：svn

您是否知道任何工具可以创建图表来显示 SVN 存储库中的分支/合并活动？

我们都在各种教程中看到过这些图表。有些好，有些不太好。它们可以自动创建吗（或者可能需要一点点刺激——如果你的分支哲学是 dev-test-prod、branch-per-release 等，你可能必须告诉它怎么办？）

我现在正在查看 TortoiseSVN 修订图，但它的细节比我想要的要多，而且布局错误。

* * *

猎户座，感谢您的回复。我想由于分支和合并更像是管理存储库中文件的约定，而不是“SVN 的内置功能，这将非常困难。我将坚持使用我们团队的白板顶部绘制的糟糕图表办公室。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-19T12:32:14.143

从 Tigris.org查看[SvnMapper](http://svnmapper.tigris.org/)

![在此处输入图像描述](../Images/67f2cc98e449e783878b8f31932708a5.png)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-03T17:15:17.577

看看[来自 Tigris.org 的 Subclipse](http://subclipse.tigris.org/graph.html)

![在此处输入图像描述](../Images/ae279e76760ddcaa0c0be750c3c7d78c.png)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-03T15:29:49.133

好吧，你可以使用 git 和 git-svn。首先，将您的 SVN 存储库克隆到 Git 存储库中，如下所示：

```
git svn init "http://host/repo/location/trunk" 
```

然后，使用命令：

```
gitk --all 
```

从那里，您会看到一个漂亮的修订历史图表。当然，这假设你已经正确设置了 git 和 git-svn 并且在命令行上很舒服。

通过 Git 跟踪源的好处之一是通过内容修改来跟踪合并历史，而不是按时间顺序或分支名称。因此，您的 SVN 存储库是否没有合并历史并不重要。

如果 gitk 修订图不够用，您可以直接从 Git 中提取 repo 历史记录并制作自己的图。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-08-13T23:08:59.777

在 SVN 1.5 之前（已经过了一个月左右），它根本不跟踪合并，所以分支“重新连接”到主干的位无论如何都不可能做到

# compact-framework - 在 Compact Framework 上开发时，找到所有内存的最佳方法是什么？

> ID：10309
> 
> 赞同：6
> 
> 时间：2008-08-13T19:56:52.707
> 
> 标签：compact-framework, windows-ce

我使用了 CF [Remote Performance Monitor](http://blogs.msdn.com/stevenpr/archive/2006/04/17/577636.aspx)，但是这似乎只跟踪在托管世界中初始化的内存，而不是在非托管世界中。好吧，我只能假设这是因为探查器中列出的数字远低于允许的最大值（CE 5 上为 32mb）。使用 RPM 对特定应用程序进行分析表明，所有缓存的总使用量只能达到 12mb 左右，然后随着（我假设）一些非托管的东西开始占用更多内存而慢慢缩小。系统中的内存滑块还显示设备内存非常不足。如果我终止进程，滑块会显示所有内存都回来了。所以它必须（？）是这个吞噬内存的托管进程。

是否有任何简单（ish？）的方式可以以某种方式跟踪非托管内存使用情况，这可能使我能够将其与相应的 P/Invoke 调用相匹配？

**编辑：对于所有重新标记的人来说，它不是 .NET**，像这样标记问题会使事情变得混乱。它是 .NETCF / Compact Framework。我知道它们看起来很相似，但它们不同，因为 .NET 摇滚，而 CF 基本上只是 NotImplementedException 的包装器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-08-13T20:33:46.253

尝试启用[互操作日志记录](http://blogs.msdn.com/stevenpr/archive/2005/06/22/431612.aspx)。

此外，如果您可以访问您正在使用的本机 dll 的代码，请查看：http: [//msdn.microsoft.com/en-us/netframework/bb630228.aspx](http://msdn.microsoft.com/en-us/netframework/bb630228.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-08-14T16:06:04.087

一段时间以来，我肯定一直在与 C# 托管应用程序中的非托管问题作斗争——这并不容易。

我发现最有用的是定期输出到文本日志文件。例如，您可以 每隔几分钟打印一次[GlobalMemoryStatus的输出，并在每次加载新表单时进行记录。](http://msdn.microsoft.com/en-us/library/aa908760.aspx)从那里你至少可以看到要么记忆逐渐消失，要么一大块记忆在一天中的特定时间消失了。

对我们来说，只要使用该设备，我们就会发现一整天的记忆力逐渐丧失。从那里我们最终发现条形码扫描设备在我们的 Form 基类中没有特别的原因被初始化（我责怪以前的开发人员！:-)

设置此日志记录可能是一个小麻烦，但从长远来看，它为我们带来了巨大的好处，特别是在实时使用的设备上，我们可以获得真实数据、检测、异常堆栈跟踪等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T11:35:15.200

好的，我在 CE 上使用 C++，而不是 C#，所以这可能没有帮助，但是......

我使用了一个名为[Entrk toolbox](http://www.entrek.com/products.htm#CodeSnitch)的包，它在 Windows CE 下监视内存和资源的使用、泄漏和异常。很像一个轻量级的 CE 版本的边界检查器。大多数时候都在做这个把戏。

# powershell - 我可以从脚本或命令行将文件复制到网上邻居吗？

> ID：10313
> 
> 赞同：12
> 
> 时间：2008-08-13T20:02:06.533
> 
> 标签：powershell, scripting, command-line, moss, wss

在 Windows XP 中，是否可以从命令行、批处理文件或更好的 PowerShell 脚本将文件复制到网上邻居？

让我走上这条研究道路的原因是试图从用户的机器上将文件发布到 WSS 3.0 文档库。我无法将驱动器映射到有问题的库，因为 WSS 站点只能通过 NTLM 在 80 或 443 以外的端口上进行身份验证。我想我可以交替使用 WSS Web 服务将文件推出，但我'现在真的很好奇这个问题的答案。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-08-18T11:06:03.683

使用批处理文件，您既可以登录资源也可以复制文件：

批处理文件将包含以下内容：

```
net use \\{dest-machine}\{destfolder} {password} /user:{username}
copy {file} \\{dest-machine}\{destfolder} 
```

例如

```
net use \\Development\myfolder mypassword /user:Administrator
copy newfile.c \\development\myfolder 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-11-19T10:05:51.867

如果您指的是`windows box`，只需使用`xcopy`. 可用是相当标准的`xcopy`。

```
xcopy src \\dest-machine\shared-library-name\dest
xcopy \\src-machine\shared-library-name\dest src 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-08-17T20:13:50.427

Powershell 使用 Providers 的抽象来提供一个通用的数据存储接口。这些似乎与常用名词“Item”保持一致，因此您可以使用`man *item*`. 如果您知道另一种方法来复制和以其他方式处理存储中的数据，您不妨使用它，但使用 cmdlet 提供了一种更好的“一次学习，经常使用”的方法。在您的情况下，您可以：

```
Copy-Item test.txt -Destination \\dest-machine\share 
```

如果需要，Copy-item 还支持 -Credential 参数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-16T02:28:04.987

“网上邻居”并没有真正的 API，它只是一堆快捷方式，如果我没记错的话，SharePoint 共享使用 Shell 扩展。

综上所述：从 PowerShell 将 Sharepoint 作为文件系统访问*还*需要一个扩展，即[SharePoint Provider](http://www.codeplex.com/PSSharePoint)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-08-13T20:08:47.893

您可以使用“net”命令进行身份验证，然后复制文件。

```
copy src \\dest-machine\shared-library-name\dest 
```

如果需要，我*不确定*如何处理身份验证。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-27T14:35:37.993

从我所看到的情况来看，似乎无法从命令行直接访问/操作网上邻居，无论是在 PowerShell 中还是在普通的 ol' 命令提示符中。

@slipsec (#13899)：感谢您的建议，但 PowerShell 与`net use`命令一样不支持目标路径中的端口号。

因此，在我的特殊情况下，我能想到的最好的事情就是咬紧牙关，购买类似 WebDrive 的东西，以通过非标准端口上的 WebDAV 启用驱动器映射，或者进行一些不同的配置（例如，具有不同 IP 地址的单独 Web 应用程序和主机标头）在 SharePoint 中通过标准端口上的 NTLM 公开网站。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-08-13T20:44:29.460

如果您需要编写脚本，则应考虑[NAnt](http://nant.sourceforge.net/)。

它主要用于构建脚本，但它非常强大并且相当容易上手。

还有[NAntContrib](http://nantcontrib.sourceforge.net/)和[nant ftp 任务](http://web.archive.org/web/20110319094509/http://www.spinthemoose.com:80/%7Eftptask/help/tasks/ftp.html)可以帮助你。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-08-13T21:23:10.583

我可能错了，但我认为 Nick 的 robocopy 解决方案或 Nathan 的复制命令解决方案都行不通。Robocopy 似乎想要一个映射驱动器，我不能这样做，因为它没有在端口 80 或 443 上运行，并且 Windows 无法处理包含 UNC 样式名称中的端口的路径：

```
copy src \\dest-machine:45000\shared-library-name\dest 
```

我也没有看到可以处理这种情况的 NAnt 任务。

我也知道有一些工具可以让我映射 WebDAV 驱动器。我更想知道是否有某种方法可以在不使用 GUI 的情况下使用已设置的网上邻居。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-08-13T20:04:20.930

是的你可以。我建议使用像 robocopy 这样的工具。

# objective-c - 你如何命名你的实例/参数值？

> ID：10314
> 
> 赞同：4
> 
> 时间：2008-08-13T20:03:53.503
> 
> 标签：objective-c, cocoa

作为 Objective-C（但长期 C/++）程序员的新手，我正在寻找有关变量命名约定的建议/建议。

我个人的偏好是为实例变量使用前缀，这既是为了在函数中清晰，又是为了防止函数参数的阴影。但是，我喜欢排除前缀的属性（除非您还为属性名称添加前缀，这不能很好地工作并且看起来很愚蠢）。同样，我可以使用“self.variable”约定，但前提是我将所有内容都设为属性。

那么，鉴于下面的代码，您对实例/函数变量的首选命名风格是什么？如果你不打扰，你如何处理函数参数上的阴影？

```
@interface GridItem : NSObject
{
    CGRect _rect;
    ...  
}
@end

-(void) initFromRect:(CGRect)rect
{
    _rect = rect;
    ...
} 
```

干杯!

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-08-15T05:32:40.293

大多数 Cocoa 项目使用下划线作为非`IBOutlet`实例变量前缀，并且不使用实例变量前缀`IBOutlet`。

我不使用下划线作为`IBOutlet`实例变量的原因是，当加载 nib 文件时，如果您有一个用于连接的插座的 setter 方法，则将调用该 setter。 *然而*，这种机制不*使用*键值编码，因此*不会设置名称以下划线 (* *eg* `_myField` )为前缀的 IBOutlet，除非设置器的名称与插座 ( *eg* ) 完全相同，这是非标准且粗略的。 **`set_myField:`**

 **另外，请注意，使用类似`self.myProp`的属性**与**访问实例变量不同。当您使用属性时，您正在**发送消息**，就像您使用括号表示法一样`[self myProp]`。所有属性所做的就是为您提供简洁的语法，以便在一行中指定 getter 和 setter，并允许您综合它们的实现；它们实际上并没有使消息分发机制短路。如果你想直接访问一个实例变量但在它前面加上`self`你需要把它`self`当作一个指针来对待，就像`self->myProp`它实际上是一个 C 风格的字段访问一样。

最后，在编写 Cocoa 代码时不要使用匈牙利符号，并避免使用其他前缀，如“f”和“m_”——这会将代码标记为由不“明白”的人编写，并会导致它被其他 Cocoa 开发者怀疑。

一般来说，遵循[Apple Developer Connection上的](http://developer.apple.com/ "Apple Developer Connection")[Cocoa 编码指南](http://developer.apple.com/documentation/Cocoa/Conceptual/CodingGuidelines/index.html "Cocoa 编码指南")文档中的建议，其他开发人员将能够获取并理解您的代码，并且您的代码将与所有使用运行时内省的 Cocoa 功能一起工作。

下面是一个窗口控制器类的样子，使用我的约定：

```
// EmployeeWindowController.h
#import <AppKit/NSWindowController.h>

@interface EmployeeWindowController : NSWindowController {
@private
    // model object this window is presenting
    Employee *_employee;

    // outlets connected to views in the window
    IBOutlet NSTextField *nameField;
    IBOutlet NSTextField *titleField;
}

- (id)initWithEmployee:(Employee *)employee;

@property(readwrite, retain) Employee *employee;

@end

// EmployeeWindowController.m
#import "EmployeeWindowController.h"

@implementation EmployeeWindowController

@synthesize employee = _employee;

- (id)initWithEmployee:(Employee *)employee {
    if (self = [super initWithWindowNibName:@"Employee"]) {
        _employee = [employee retain];
    }
    return self;
}

- (void)dealloc {
    [_employee release];

    [super dealloc];
}

- (void)windowDidLoad {
    // populates the window's controls, not necessary if using bindings
    [nameField setStringValue:self.employee.name];
    [titleField setStringValue:self.employee.title];
}

@end 
```

您会看到我在我的and方法中使用了`Employee`直接引用 an 的实例变量，而我在其他方法中使用了该属性。这通常是一个很好的属性模式：只在初始值设定项、 in以及属性的 getter 和 setter 中触及属性的底层实例变量。`-init``-dealloc``-dealloc`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-10T16:31:11.157

我遵循 Chris Hanson 关于下划线 ivar 前缀的建议，尽管我承认我也确实将下划线用于 IBOutlets。[但是，根据@mmalc 的建议](https://stackoverflow.com/questions/155964/what-are-best-practices-that-you-use-when-writing-objective-c-and-cocoa#167495)，我最近开始将我的`IBOutlet`声明移到该`@property`行。好处是我所有的 ivars 现在都有一个下划线，并且标准的 KVC 设置器被称为（即）。此外，接口生成器中的插座名称没有下划线。`setNameField:`

```
@interface EmployeeWindowController : NSWindowController {
@private
    // model object this window is presenting
    Employee *_employee;

    // outlets connected to views in the window
    NSTextField *_nameField;
    NSTextField *_titleField;
}

- (id)initWithEmployee:(Employee *)employee;

@property(readwrite, retain) Employee *employee;
@property(nonatomic, retain) IBOutlet NSTextField *nameField;
@property(nonatomic, retain) IBOutlet NSTextField *titleField;

@end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-15T16:20:12.153

您可以在您的 ivars 上使用下划线前缀，并且仍然为您的属性使用非下划线名称。对于合成访问器，只需执行以下操作：

```
@synthesize foo = _foo; 
```

这告诉编译器使用 the_foo ivar 合成 foo 属性。

如果您编写自己的访问器，那么您只需在实现中使用下划线 ivar 并保留非下划线方法名称。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-08-13T20:38:36.397

就个人而言，我遵循 Cocoa 命名约定，对函数和变量使用驼峰式大小写，对对象名称使用大写驼峰式大小写（当然没有前导 NS）。

我发现类型前缀使代码对不编写它的任何人都更加不透明（因为每个人总是使用不同的前缀），并且在现代 IDE 中找出某些东西的类型并不是那么困难。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-15T06:00:54.000

随着属性的引入，我认为无需在类实例变量前加上“_”前缀。您可以设置一个简单的规则（在您的头文件中描述），任何要在类外部访问的变量都必须通过属性访问，或者通过使用类上的自定义方法来影响值。这对我来说似乎比在他们前面贴上“_”的名字要干净得多。它还正确封装了这些值，以便您可以控制它们的更改方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-13T20:36:32.877

我不喜欢使用下划线作为任何标识符的前缀，因为 C 和 C++ 都保留了某些下划线前缀供实现使用。

我认为使用“self.variable”是丑陋的。

通常，我对实例变量使用朴素的标识符（即没有前缀或后缀）。如果你的类太复杂以至于你不记得实例变量，你就有麻烦了。因此，对于您的示例，我将使用“rect”作为实例变量的名称，并使用“newRect”或“aRect”作为参数名称。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-08-15T05:36:36.043

Andrew：实际上有很多 Cocoa 开发人员根本不使用实例变量前缀。这在 Smalltalk 世界中也非常普遍（事实上，我想说在 Smalltalk 中几乎闻所未闻在实例变量上使用前缀）。

实例变量的前缀总是让我觉得是一种 C++ 主义，它被带到 Java 和 C#。由于 Objective-C 世界在很大程度上与 C++ 世界平行，而 Java 和 C# 世界是它的继承者，这可以解释您在不同开发人员之间可能会看到的“文化”差异。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-01T14:46:47.170

我的风格是混合的，实际上是 PowerPlant 时代的延续：

我使用的最有用的前缀是函数/方法参数的“in”和“out”。这可以帮助您一目了然地了解参数的用途，并且确实有助于防止方法参数和实例变量之间发生冲突（您见过多少次参数“表”与同名的实例变量冲突）。例如：

```
- (void)doSomethingWith:(id)inSomeObject error:(NSError **)outError; 
```

然后我将裸名称用于实例变量和属性名称：

然后我使用“the”作为局部变量的前缀：theTable、theURL 等。这再次有助于区分局部变量和实例变量。

然后遵循 PowerPlant 样式，我使用了一些其他前缀：k 代表常量，E 代表枚举，g 代表全局变量，s 代表静态变量。

我使用这种风格已经有 12 年了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-10T16:37:38.727

虽然我喜欢为 ivars 使用下划线前缀，但我讨厌写`@synthesize`行，因为所有的重复（它不是很[干](http://en.wikipedia.org/wiki/Don't_repeat_yourself)）。我创建了一个宏来帮助做到这一点并减少代码重复。因此，而不是：

```
@synthesize employee = _employee; 
```

我写这个：

```
ddsynthesize(employee); 
```

这是一个使用标记粘贴在右侧添加下划线的简单宏：

```
#define ddsynthesize(_X_) @synthesize _X_ = _##_X_ 
```

唯一的缺点是它会混淆 Xcode 的重构工具，并且如果你通过重构重命名属性，它不会被重命名。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-17T21:21:30.377

除了这里所说的，请务必阅读 Cocoa 文档中关于 Key Value Observing 兼容命名的内容。从长远来看，严格遵循这种模式将对您有很大帮助。**

# ruby - 为什么 Ruby 没有真正的 StringBuffer 或 StringIO？

> ID：10323
> 
> 赞同：56
> 
> 时间：2008-08-13T20:19:09.807
> 
> 标签：ruby, string, io, buffer

我最近阅读了一篇关于在 Ruby中使用的好[文章。](http://macdevelopertips.com/ruby/using-a-string-as-a-file-in-ruby.html)`StringIO`然而，作者没有提到的是，这`StringIO`只是一个“我”。没有“O”。你*不能*这样做，例如：

```
s = StringIO.new
s << 'foo'
s << 'bar'
s.to_s
# => should be "foo\nbar"
# => really is ''` 
```

Ruby 确实需要一个 StringBuffer，就像 Java 一样。StringBuffers 有两个重要用途。首先，它们让您测试 Ruby 的 StringIO 所做的输出的一半。其次，它们对于从小部分构建长弦很有用——乔尔一遍又一遍地提醒我们的东西是非常非常缓慢的。

有没有好的替代品？

Ruby 中的字符串确实是可变的，但这并不意味着我们应该始终依赖该功能。如果`stuff`很大，例如这对性能和内存的要求真的很差。

```
result = stuff.map(&:to_s).join(' ') 
```

在 Java 中执行此操作的“正确”方法是：

```
result = StringBuffer.new("")
for(String s : stuff) {
  result.append(s);
} 
```

虽然我的 Java 有点生疏。

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2008-08-13T20:41:29.153

我查看了 ruby​​ 文档`StringIO`，看起来你想要的是[`StringIO#string`](http://ruby-doc.org/stdlib/libdoc/stringio/rdoc/classes/StringIO.html#method-i-string)，而不是`StringIO#to_s`

因此，将您的代码更改为：

```
s = StringIO.new
s << 'foo'
s << 'bar'
s.string 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-08-09T19:39:21.843

与 Ruby 中的其他 IO 类型对象一样，当您写入 IO 时，字符指针会前进。

```
>> s = StringIO.new
=> #<StringIO:0x3659d4>
>> s << 'foo'
=> #<StringIO:0x3659d4>
>> s << 'bar'
=> #<StringIO:0x3659d4>
>> s.pos
=> 6
>> s.rewind
=> 0
>> s.read
=> "foobar" 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-11-07T18:57:33.277

我做了一些基准测试，最快的方法是使用该`String#<<`方法。使用`StringIO`速度有点慢。

```
s = ""; Benchmark.measure{5000000.times{s << "some string"}}
=>   3.620000   0.100000   3.720000 (  3.970463)

>> s = StringIO.new; Benchmark.measure{5000000.times{s << "some string"}}
=>   4.730000   0.120000   4.850000 (  5.329215) 
```

使用该方法连接字符串`String#+`是多个数量级的最慢方法：

```
s = ""; Benchmark.measure{10000.times{s = s + "some string"}}
=>   0.700000   0.560000   1.260000 (  1.420272)

s = ""; Benchmark.measure{10000.times{s << "some string"}}
=>   0.000000   0.000000   0.000000 (  0.005639) 
```

所以我认为正确的答案是Java的等价物`StringBuffer`只是`String#<<`在Ruby中使用。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-08-13T20:46:30.500

您的示例适用于 Ruby - 我刚刚尝试过。

```
irb(main):001:0> require 'stringio'
=> true
irb(main):002:0> s = StringIO.new
=> #<StringIO:0x2ced9a0>
irb(main):003:0> s << 'foo'
=> #<StringIO:0x2ced9a0>
irb(main):004:0> s << 'bar'
=> #<StringIO:0x2ced9a0>
irb(main):005:0> s.string
=> "foobar" 
```

除非我错过了您使用 to_s 的原因 - 只是输出对象 ID。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-08-13T20:31:29.050

好吧，在 Ruby 中 StringBuffer 不是必需的，主要是因为 Ruby 中的字符串是可变的……因此您可以通过修改现有字符串来构建字符串，而不是使用每个 concat 构造新字符串。

请注意，您还可以使用特殊的字符串语法，您可以在其中构建一个引用字符串中其他变量的字符串，这使得字符串构造非常易读。考虑：

```
first = "Mike"
last = "Stone"
name = "#{first} #{last}" 
```

这些字符串还可以包含表达式，而不仅仅是变量……例如：

```
str = "The count will be: #{count + 1}"
count = count + 1 
```

# c - 在C中有效地将十六进制字符串转换为整数？

> ID：10324
> 
> 赞同：28
> 
> 时间：2008-08-13T20:20:27.620
> 
> 标签：c, performance, hex, strtol

在C中，将一串十六进制数字转换为二进制`unsigned int`或的最有效方法是`unsigned long`什么？

例如，如果我有`0xFFFFFFFE`，我想要一个`int`带有 base10 值的`4294967294`。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-08-13T20:22:13.357

你想要[`strtol`](http://www.cplusplus.com/reference/clibrary/cstdlib/strtol.html)或[`strtoul`](http://en.cppreference.com/w/c/string/byte/strtoul)。另请参见[Unix 手册页](http://man7.org/linux/man-pages/man3/strtoul.3.html)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-06-17T04:08:31.780

编辑：**现在与 MSVC、C++ 和非 GNU 编译器兼容（见末尾）。**

问题是“最有效的方式”。OP 没有指定平台，他可能正在为基于 RISC 的 ATMEL 芯片进行编译，该芯片具有 256 字节的闪存存储空间来存储他的代码。

为了记录，对于那些（像我一样）欣赏“最简单的方法”和“最有效的方法”之间的区别，并且喜欢学习的人......

```
static const long hextable[] = {
   [0 ... 255] = -1, // bit aligned access into this table is considerably
   ['0'] = 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, // faster for most modern processors,
   ['A'] = 10, 11, 12, 13, 14, 15,       // for the space conscious, reduce to
   ['a'] = 10, 11, 12, 13, 14, 15        // signed char.
};

/** 
 * @brief convert a hexidecimal string to a signed long
 * will not produce or process negative numbers except 
 * to signal error.
 * 
 * @param hex without decoration, case insensitive. 
 * 
 * @return -1 on error, or result (max (sizeof(long)*8)-1 bits)
 */
long hexdec(unsigned const char *hex) {
   long ret = 0; 
   while (*hex && ret >= 0) {
      ret = (ret << 4) | hextable[*hex++];
   }
   return ret; 
} 
```

它不需要外部库，而且速度应该非常快。它处理大写、小写、无效字符、奇数大小的十六进制输入（例如：0xfff），最大大小仅受编译器限制。

**对于非 GCC 或 C++ 编译器或不接受花哨的 hextable 声明的编译器。**

用这个（更长，但更符合）版本替换第一条语句：

```
static const long hextable[] = { 
    -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
    -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
    -1,-1, 0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,-1,
    -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
    -1,-1,10,11,12,13,14,15,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
    -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
    -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
    -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
    -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
    -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
    -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1
}; 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-08-13T20:25:01.793

试试这个：

```
#include <stdio.h>
int main()
{
    char s[] = "fffffffe";
    int x;
    sscanf(s, "%x", &x);
    printf("%u\n", x);
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-24T23:18:41.550

如果您没有标准库，那么您必须手动完成。

```
unsigned long hex2int(char *a, unsigned int len)
{
    int i;
    unsigned long val = 0;

    for(i=0;i<len;i++)
       if(a[i] <= 57)
        val += (a[i]-48)*(1<<(4*(len-1-i)));
       else
        val += (a[i]-55)*(1<<(4*(len-1-i)));

    return val;
} 
```

注意：此代码假定为大写 AF。如果 len 超出最长整数 32 位或 64 位，则它不起作用，并且没有错误捕获非法十六进制字符。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-08-20T10:03:15.577

对于 AVR 微控制器，我编写了以下函数，包括相关注释以使其易于理解：

```
/**
 * hex2int
 * take a hex string and convert it to a 32bit number (max 8 hex digits)
 */
uint32_t hex2int(char *hex) {
    uint32_t val = 0;
    while (*hex) {
        // get current character then increment
        char byte = *hex++; 
        // transform hex character to the 4bit equivalent number, using the ascii table indexes
        if (byte >= '0' && byte <= '9') byte = byte - '0';
        else if (byte >= 'a' && byte <='f') byte = byte - 'a' + 10;
        else if (byte >= 'A' && byte <='F') byte = byte - 'A' + 10;    
        // shift 4 to make space for new digit, and add the 4 bits of the new digit 
        val = (val << 4) | (byte & 0xF);
    }
    return val;
} 
```

例子：

```
char *z ="82ABC1EF";
uint32_t x = hex2int(z);
printf("Number is [%X]\n", x); 
```

将输出： [![在此处输入图像描述](../Images/e36958774b6e2800abdcb310c99b92e7.png)](https://i.stack.imgur.com/IjCX0.png)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-10-29T17:10:09.480

好像经常发生一样，您的问题存在严重的术语错误/歧义。在普通话中它通常无关紧要，但在这个特定问题的背景下，它是至关重要的。

你看，没有“十六进制值”和“十进制值”（或“十六进制数”和“十进制数”）之类的东西。“十六进制”和“十进制”是值*表示*的属性。同时，值（或数字）本身没有表示，因此它们不能是“十六进制”或“十进制”。例如，`0xF`and在 C 语法中是*相同数字*`15`的两种不同*表示*。

 *我猜你的问题，它的陈述方式，表明你需要将一个值（即字符串）的 ASCII 十六进制表示转换为一个值（另一个字符串）的 ASCII 十进制表示。一种方法是使用整数表示作为中间表示：首先，将 ASCII 十六进制表示转换为足够大小的整数（使用`strto...`组中的函数，如`strtol`），然后将整数转换为 ASCII 十进制表示（使用`sprintf`）。

如果这不是你需要做的，那么你必须澄清你的问题，因为不可能从你的问题提出的方式中弄清楚。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-08-14T00:21:45.417

@埃里克

> 为什么一个有效的代码解决方案会被否决？当然，这很丑陋，可能不是最快的方法，但说“strtol”或“sscanf”更有指导意义。如果您自己尝试一下，您将了解事情是如何在幕后发生的。

我真的不认为您的解决方案应该被否决，但我猜测它为什么会发生是因为它不太实用。投票的想法是“最佳”答案将浮到顶部，虽然您的答案可能对幕后发生的事情（或可能发生的方式）更具指导性，但这绝对不是解析十六进制数字的最佳方式在生产系统中。

同样，从教育的角度来看，我认为您的回答没有任何问题，我当然不会（也不会）投反对票。不要因为有些人不喜欢您的某个答案而气馁并停止发帖。它发生了。

我怀疑我的回答会让你对自己的被否决感觉更好，但我知道当你问为什么某件事被否决而[没有人回答](https://stackoverflow.com/questions/7430/suggestion-link-to-feature-requests-on-uservoice#7457)时，这尤其不好玩。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-08-14T01:16:16.573

@埃里克

> 我实际上希望看到一个 C 向导发布一些非常酷的东西，有点像我所做的，但不那么冗长，同时仍然“手动”做。

好吧，我不是 C 大师，但这是我想出的：

```
unsigned int parseHex(const char * str)
{
    unsigned int val = 0;
    char c;

    while(c = *str++)
    {
        val <<= 4;

        if (c >= '0' && c <= '9')
        {
            val += c & 0x0F;
            continue;
        }

        c &= 0xDF;
        if (c >= 'A' && c <= 'F')
        {
            val += (c & 0x07) + 9;
            continue;
        }

        errno = EINVAL;
        return 0;
    }

    return val;
} 
```

我最初有更多的位掩码而不是比较，但我严重怀疑位掩码是否比现代硬件上的比较快。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-08-14T14:29:34.500

对于示例中较大的十六进制字符串，我需要使用[strtoul](http://www.cplusplus.com/reference/clibrary/cstdlib/strtoul.html)。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-11-26T22:18:44.030

十六进制转十进制。不要在在线编译器上运行它，因为它不起作用。

```
#include<stdio.h>
void main()
{
    unsigned int i;
    scanf("%x",&i);
    printf("%d",i);
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-10-06T00:44:55.777

如前所述，效率基本上取决于优化对象。

当优化代码行，或者只是在没有配备齐全的标准库的环境中工作时，一个快速而肮脏的选择可能是：

```
// makes a number from two ascii hexa characters
int ahex2int(char a, char b){

    a = (a <= '9') ? a - '0' : (a & 0x7) + 9;
    b = (b <= '9') ? b - '0' : (b & 0x7) + 9;

    return (a << 4) + b;
} 
```

...更多类似的线程在这里：[https ://stackoverflow.com/a/58253380/5951263](https://stackoverflow.com/a/58253380/5951263)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-08-23T11:32:17.217

> 为什么一个有效的代码解决方案会被否决？当然，丑...

也许是因为除了丑陋之外，它没有教育意义，**也**不起作用。另外，我怀疑像我一样，大多数人目前没有编辑的权力（根据所需的等级来判断 - 永远不会）。

使用数组可以提高效率，但是这段代码中没有提到。它也没有考虑大小写，因此它不适用于问题中提供的示例。FFFFFFFE

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-08-04T13:51:38.600

```
#include "math.h"
#include "stdio.h"
///////////////////////////////////////////////////////////////
//  The bits arg represents the bit say:8,16,32...                                                                                                              
/////////////////////////////////////////////////////////////
volatile long Hex_To_Int(long Hex,char bits)
{
    long Hex_2_Int;
    char byte;
    Hex_2_Int=0;

    for(byte=0;byte<bits;byte++)
    {
        if(Hex&(0x0001<<byte))
            Hex_2_Int+=1*(pow(2,byte));
        else
            Hex_2_Int+=0*(pow(2,byte));
    }

    return Hex_2_Int;
}
///////////////////////////////////////////////////////////////
//                                                                                                                  
/////////////////////////////////////////////////////////////

void main (void)
{
    int Dec;   
    char Hex=0xFA;
    Dec= Hex_To_Int(Hex,8);  //convert an 8-bis hexadecimal value to a number in base 10
    printf("the number is %d",Dec);
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-12-19T17:39:45.453

试试这个从十进制转换为十六进制

```
 #include<stdio.h>
    #include<conio.h>

    int main(void)
    {
      int count=0,digit,n,i=0;
      int hex[5];
      clrscr();
      printf("enter a number   ");
      scanf("%d",&n);

      if(n<10)
      {
          printf("%d",n);
      }

      switch(n)
      {
          case 10:
              printf("A");
            break;
          case 11:
              printf("B");
            break;
          case 12:
              printf("B");
            break;
          case 13:
              printf("C");
            break;
          case 14:
              printf("D");
            break;
          case 15:
              printf("E");
            break;
          case 16:
              printf("F");
            break;
          default:;
       }

       while(n>16)
       {
          digit=n%16;
          hex[i]=digit;
          i++;
          count++;
          n=n/16;
       }

       hex[i]=n;

       for(i=count;i>=0;i--)
       {
          switch(hex[i])
          {
             case 10:
                 printf("A");
               break;
             case 11:
                 printf("B");
               break;
             case 12:
                 printf("C");
               break;
             case  13:
                 printf("D");
               break;
             case 14:
                 printf("E");
               break;
             case 15:
                 printf("F");
               break;
             default:
                 printf("%d",hex[i]);
          }
    }

    getch();

    return 0;
} 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2017-07-19T12:24:02.900

在 C 中，您可以通过多种方式将十六进制数转换为十进制数。一种方法是将十六进制数转换为整数。我个人觉得这既简单又小。

这是一个示例代码，用于在强制转换的帮助下将十六进制数转换为十进制数。

```
#include <stdio.h>

int main(){
    unsigned char Hexadecimal = 0x6D;   //example hex number
    int Decimal = 0;    //decimal number initialized to 0

        Decimal = (int) Hexadecimal;  //conversion

    printf("The decimal number is %d\n", Decimal);  //output
    return 0;
} 
```

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2010-10-29T17:01:32.753

这目前仅适用于小写，但它非常容易使其与两者一起使用。

```
cout << "\nEnter a hexadecimal number: ";
cin >> hexNumber;
orighex = hexNumber;

strlength = hexNumber.length();

for (i=0;i<strlength;i++)
{
    hexa = hexNumber.substr(i,1);
    if ((hexa>="0") && (hexa<="9"))
    {
        //cout << "This is a numerical value.\n";
    }
    else
    {
        //cout << "This is a alpabetical value.\n";
        if (hexa=="a"){hexa="10";}
        else if (hexa=="b"){hexa="11";}
        else if (hexa=="c"){hexa="12";}
        else if (hexa=="d"){hexa="13";}
        else if (hexa=="e"){hexa="14";}
        else if (hexa=="f"){hexa="15";}
        else{cout << "INVALID ENTRY! ANSWER WONT BE CORRECT\n";}
    }
    //convert from string to integer

    hx = atoi(hexa.c_str());
    finalhex = finalhex + (hx*pow(16.0,strlength-i-1));
}
cout << "The hexadecimal number: " << orighex << " is " << finalhex << " in decimal.\n"; 
```*

# winforms - 在 WinForms 中，为什么不能从其他线程更新 UI 控件？

> ID：10349
> 
> 赞同：18
> 
> 时间：2008-08-13T20:41:24.927
> 
> 标签：winforms, multithreading

我确信这有一个很好的（或至少体面的）理由。它是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-08-13T22:34:57.083

> 我认为这是一个绝妙的问题——而且我认为需要一个更好的答案。
> 
> 当然，唯一的原因是框架中的某个地方不是非常线程安全的。

这个“东西”几乎是 System.Windows.Forms 中每个控件上的每个实例成员。

System.Windows.Forms 中的许多控件（如果不是全部）的 MSDN 文档说 *“这种类型的任何公共静态（在 Visual Basic 中共享）成员都是线程安全的。不保证任何实例成员都是线程安全的。”*

这意味着实例成员如`TextBox.Text {get; set;}`不可***重入***。

使这些实例成员中的每一个都成为线程安全的可能会引入大多数应用程序不需要的大量开销。相反，.Net 框架的设计者决定，而且我认为是正确的，应该把从多个线程同步访问表单控件的负担放在程序员身上。

[编辑]

虽然这个问题只问“为什么”，但这里有一个解释“如何”的文章的链接：

*如何：*对 MSDN 上的 Windows 窗体控件进行线程安全调用

[http://msdn.microsoft.com/en-us/library/ms171728.aspx](http://msdn.microsoft.com/en-us/library/ms171728.aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-08-13T20:47:12.760

因为您很容易陷入僵局（以及其他问题）。

例如，您的辅助线程可能正在尝试更新 UI 控件，但 UI 控件将等待由辅助线程锁定的资源被释放，因此两个线程最终都在等待对方完成。正如其他人所评论的那样，这种情况并非 UI 代码所独有，而是特别常见。

在 C++ 等其他语言中，您可以自由地尝试执行此操作（不会像在 WinForms 中那样引发异常），但如果发生死锁，您的应用程序可能会冻结并停止响应。

顺便说一句，您可以轻松地告诉 UI 线程您要更新控件，只需创建一个委托，然后调用该控件上的（异步）BeginInvoke 方法，将其传递给您的委托。例如

```
myControl.BeginInvoke(myControl.UpdateFunction); 
```

这相当于从工作线程执行 C++/MFC PostMessage

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-08-13T23:09:03.443

尽管听起来很合理，但约翰斯的回答并不正确。事实上，即使在使用 Invoke 时，如果不遇到死锁情况，您仍然不安全。在使用 Invoke 处理在后台线程上触发的事件时，甚至可能会导致此问题。

真正的原因更多地与比赛条件有关，并且可以追溯到古老的 Win32 时代。我在这里无法解释细节，关键字是消息泵、WM_PAINT 事件以及“SEND”和“POST”之间的细微差别。

更多信息可以在[这里](http://weblogs.asp.net/justin_rogers/articles/126345.aspx)和[这里](http://msdn.microsoft.com/en-us/library/ms644927.aspx#posting_sending)找到。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-08-13T20:52:21.190

回到 1.0/1.1，在调试期间没有抛出异常，而是出现了间歇性运行时挂起的情况。好的！:) 因此，在 2.0 中，他们使这种情况引发了异常，这是非常正确的。

造成这种情况的实际原因可能是（正如 Adam Haile 所说）某种并发/锁定问题。请注意，普通的 .NET api（例如 TextBox.Text = "Hello";）包装了 SEND 命令（需要立即采取行动），如果在执行更新的线程之外的单独线程上执行这些命令，则会产生问题。使用 Invoke/BeginInvoke 使用 POST 而不是将操作排队。

有关发送和邮寄的更多信息，请[点击此处](http://msdn.microsoft.com/en-us/library/ms644927.aspx#posting_sending)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-08-13T20:44:01.473

这样您就不会有两件事试图同时更新控件。（如果 CPU 在写入/读取过程中切换到另一个线程，则可能会发生这种情况）在访问多个线程之间的共享变量时需要使用互斥锁（或其他一些同步）的原因相同。

编辑：

> 在 C++ 等其他语言中，您可以自由地尝试这样做（不会像在 WinForms 中那样抛出异常），但您最终会以艰难的方式学习！

啊，是的...我在 C/C++ 和 C# 之间切换，因此比我应该的更通用一点，抱歉...他是对的，你*可以*在 C/C++ 中做到这一点，但它会回到咬你！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-13T21:26:44.617

还需要在对同时调用敏感的更新函数中实现同步。对 UI 元素执行此操作在应用程序和操作系统级别都将是昂贵的，并且对于绝大多数代码来说完全是多余的。

一些 API 提供了一种更改系统当前线程所有权的方法，因此您可以临时（或永久）从其他线程更新系统，而无需求助于线程间通信。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-13T13:44:54.790

嗯，我不太确定，但我认为当我们有诸如等待条、进度条之类的进度控件时，我们可以从另一个线程更新它们的值，并且一切正常，没有任何故障。

# javascript - 样式显示在 Firefox、Opera、Safari 中不起作用 -（IE7 可以）

> ID：10366
> 
> 赞同：15
> 
> 时间：2008-08-13T20:59:54.360
> 
> 标签：javascript, html, css

我有一个绝对定位`div`，我想在用户单击链接时显示。链接的`onclick`调用了一个js函数，该函数将div的显示设置为阻塞（也尝试过：“” `inline`，，，，`table-cell`等`inline-table`）。这在 IE7 中效果很好，在我尝试过的所有其他浏览器（FF2、FF3、Opera 9.5、Safari）中都没有。

我尝试在通话前后添加警报，它们显示显示已从 更改为`none`，`block`但未`div`显示。

`div`如果我使用 Firebug 的 HTML 检查器更改显示值（但不是通过 Firebug 的控制台运行 javascript），我可以在 FF3 中显示 - 所以我知道它不仅仅是在屏幕外显示，等等。

我已经尝试了我能想到的一切，包括：

*   使用不同的文档类型（XHTML 1、HTML 4 等）
*   使用可见性可见/隐藏而不是显示块/无
*   使用内联 javascript 而不是函数调用
*   从不同的机器测试

关于可能导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-08-13T21:10:41.933

你能提供一些重现错误的标记吗？

您的情况一定与您的代码有关，因为我可以让它在 IE、FF3 和 Opera 9.5 上运行：

```
function show() {
  var d = document.getElementById('testdiv');
  d.style.display = 'block';
}
```

```
#testdiv {
  position: absolute;
  height: 20px;
  width: 20px; 
  display: none;
  background-color: red;
}
```

```
<div id="testdiv"></div>
<a href="javascript:show();">Click me</a>
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-08-14T15:23:10.273

由于使用 javascript 设置属性似乎从来没有工作，但使用 Firebug 的检查进行设置，我开始怀疑 javascript ID 选择器已损坏 - 也许 DOM 中有多个具有相同 ID 的项目？源代码没有显示有，但是使用 javascript 循环遍历所有 div 我发现情况就是这样。这是我最终用来显示弹出窗口的函数：

```
function openPopup(popupID)
{
  var divs = getObjectsByTagAndClass('div','popupDiv');
  if (divs != undefined && divs != null)
  {
    for (var i = 0; i < divs.length; i++)
    {
      if (divs[i].id == popupID)
        divs[i].style.display = 'block';        
    }
  }
} 
```

（实用函数 getObjectsByTagAndClass 未列出）

理想情况下，我会找出为什么多次插入同一个项目，但我无法控制渲染平台，只能控制它的输入。

因此，在调试此类问题时，**请记住检查 DOM 中的重复 ID，这可能会破坏 getElementById**。

感谢所有回答的人，感谢您的帮助！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-29T16:55:29.210

找到了答案：我需要使用以下方法使其在两种浏览器上都能正常工作：

```
document.getElementById('editRow').style.display = ''; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-18T16:12:45.880

其实我遇到了你在这里描述的同样的问题。真正解决我的问题的是更改文档属性。

**旧 DOCTYPE/html 规范**

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

**替换为**

```
<html> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-08-13T21:05:23.100

检查错误控制台（Firefox 3 中的工具菜单 > 错误控制台）以确保没有发生您没有看到的另一个错误，这会阻止您的脚本工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-13T23:36:09.770

尝试设置 div 的高度和宽度，并通过将其 z-index 设置为高于其他所有内容来确保它位于顶部。如果绝对定位的 div 位于相对定位的元素内部，则它的顶部和左侧位置基于相对定位元素的顶部和左侧。尝试将您的 div 放在 body 元素的下方。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-08-05T06:23:51.233

你必须写一个`window.onload`方法：

```
window.onload = document.getElementById('testdiv').style.display='inline'; 
```

或者你也可以创建一个变量：

```
var d = document.getElementById('testdiv');
window.onload = d.style.display = 'inline'; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-21T21:10:04.920

在 Firefox 3.5 上有一个恼人的显示错误，但在 IE7 或 Firefox 2.0.9 上没有

我有 3 个 DIV 的绝对位置 - 第一个是纯文本；第二个带有 CSS 菜单（带有 UL 和 LI 的 sucklefish 类型），第三个同上。第三个根本不会显示，即使已经检查了编码并发现它与 W3C 的 HTML 验证器完美匹配。

作为临时措施，我已经合并了第二个和第三个DIV的内容。

当 IE7 和 FF2 显示 OK 但不是 FF 3.5 时，Mozilla 的情况一定很糟糕

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-14T03:46:46.350

我给你一个大提示：

```
<div style="..." class="..."> ... </div> 
```

如果你有一些风格，那么 document.style 就可以了！如果你在课堂上有东西，它不会出现在 document.style 和 class="..." 将覆盖它！

想想这个，这会解决很多问题。只需这一点点了解，您就可以摆脱这种 MIND VIRUS。祝你有美好的一天。干杯，Ron Lentjes，LC CLS。

# c# - 如何在 C# 中创建 Word 文档？

> ID：10412
> 
> 赞同：73
> 
> 时间：2008-08-13T22:07:45.173
> 
> 标签：c#, .net, ms-word, openxml

我有一个项目，我想生成 MS Word 格式的报告导出。报告将包括图像/图表、表格和文本。做这个的最好方式是什么？第三方工具？你有什么经验？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-08-13T22:19:48.597

答案将稍微取决于应用程序是在服务器上运行还是在客户端计算机上运行。如果您在服务器上运行，那么您将要使用基于 XML 的 Office 生成格式之一，因为[在服务器上使用 Office 自动化](http://support.microsoft.com/kb/257757)时存在已知问题。

但是，如果您在客户端计算机上工作，那么您可以选择[使用 Office 自动化](http://msdn.microsoft.com/en-us/office/default.aspx)或使用 Office Open XML 格式（请参阅下面的链接），Microsoft Office 2000 及更高版本本机或通过服务包支持该格式。但是，一个缺点是您可能无法嵌入您希望显示的某些类型的图形或图像。

处理事情的最佳方式将完全取决于您必须在开发上投入多少时间。如果你走办公自动化的路线，那里有很多很好的教程，可以通过谷歌找到，而且学习起来相当简单。但是，Open Office XML 格式相当新，因此您可能会发现学习曲线要​​高一些。

Office Open XML 信息

*   Office Open XML - [http://en.wikipedia.org/wiki/Office_Open_XML](http://en.wikipedia.org/wiki/Office_Open_XML)
*   OpenXML 开发人员 - [http://openxmldeveloper.org/default.aspx](http://openxmldeveloper.org/default.aspx)
*   介绍 Office (2007) Open XML 文件格式 - [http://msdn.microsoft.com/en-us/library/aa338205.aspx](http://msdn.microsoft.com/en-us/library/aa338205.aspx)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-07-22T15:07:43.890

[DocX 免费库](http://docx.codeplex.com/)，用于创建 DocX 文档，积极开发，使用起来非常简单直观。由于 CodePlex 即将死去，项目已移至[github](https://github.com/WordDocX/DocX)。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-20T13:40:29.133

过去一周左右，我一直在快速了解[Office Open XML](http://en.wikipedia.org/wiki/Office_Open_XML)。我们有一个数据库应用程序，用于存储我们想要在 Microsoft Word 中报告的调查数据。您实际上可以在 C# 中从头开始创建 Word 2007 (docx) 文件。Open XML SDK 版本 2 包含一个很酷的应用程序，称为 Document Reflector，它实际上将提供 C# 代码来完全重新创建 Word 文档。您可以使用部分或全部代码，并即时替换您想要更改的位。SDK 附带的帮助文件也有一些很好的代码示例。

服务器上不需要 Office Interop 或任何其他 Office 软件 - 新格式是 100% XML。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-08-14T14:43:18.967

您是否考虑过使用 .RTF 作为替代方案？

它支持嵌入图像和表格以及文本，默认情况下使用 Microsoft Word 打开，虽然它的功能集更有限（不包括任何高级格式），但它的外观和感觉以及像 Word 文档一样打开它并不遥远。

您的最终用户可能不会注意到。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-08-14T14:57:55.410

我发现[Aspose Words](http://www.aspose.com/categories/file-format-components/aspose.words-for-.net-and-java/default.aspx)是最好的，因为不是每个人都可以打开 Office Open XML/*.docx 格式文件，而且 Word 互操作和 Word 自动化可能有问题。Aspose Words 支持 Word 97 以上的大多数文档文件类型。

这是一个付费组件，但有很大的支持。已经建议的另一种选择是 RTF。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-12-01T22:50:07.213

要在 .NET 中使用 Office 自动化生成 Word 文档，特别是在 C# 或 VB.NET 中：

1.  将**Microsoft.Office.Interop.Word**程序集引用添加到您的项目。路径是**\Visual Studio Tools for Office\PIA\Office11\Microsoft.Office.Interop.Word.dll**。

2.  按照您可以在此处找到的 Microsoft 代码示例进行操作：http: [//support.microsoft.com/kb/316384/en-us](http://support.microsoft.com/kb/316384/en-us)。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-08-13T23:21:17.520

Schmidty，如果您想在 Web 服务器上生成 Word 文档，您将需要每个**客户端**（不仅仅是 Web 服务器）的许可证。请参阅Rob 发布的第一个[链接](http://support.microsoft.com/kb/257757)中的此部分：

“除了技术问题之外，您还必须考虑许可问题。当前的许可指南禁止在服务器上使用 Office 应用程序来服务客户端请求，除非这些客户端本身拥有 Office 的许可副本。使用服务器端自动化提供 Office 功能以最终用户许可协议 (EULA) 不涵盖未经许可的工作站。”

如果您满足许可要求，我认为您将需要使用 COM Interop - 具体而言，[Office XP Primary Interop Assemblies](http://msdn.microsoft.com/en-us/library/aa163987.aspx)。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-08-14T15:03:28.893

查看 VSTO（适用于 Office 的 Visual Studio 工具）。创建一个 Word 模板，将一个 xml 数据岛注入其中，然后将其发送到客户端是相当简单的。当用户在 Word 中打开文档时，Word 会读取 xml 并将其转换为 WordML 并呈现它。您将需要查看 VSTO 库的 ServerDocument 类。根据我的经验，不需要额外的许可。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-25T21:51:35.273

我遇到了这个问题并为此创建了一个小型库。它被用于几个项目，然后我决定发布它。它是免费的，非常简单，但我相信它会帮助你完成任务。调用 Office Open XML 库， http: [//invoke.co.nz/products/docx.aspx](http://invoke.co.nz/products/docx.aspx)。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-09T04:07:49.337

我使用支持 doc 和 docx 格式的 Syncfusion Backoffice DocIO 取得了很好的成功。

在以前的版本中，它不支持 word 中的所有内容，但根据您的列表，我们使用表格和文本作为邮件合并方法对其进行了测试，并且效果很好。

虽然不确定图像的导入。在他们的简介页面[http://www.syncfusion.com/products/DocIO/Backoffice/features/default.aspx](http://www.syncfusion.com/products/DocIO/Backoffice/features/default.aspx)它说

> Blockquote Essential DocIO 支持在文档中插入几乎所有格式的标量和矢量图像。位图、gif、png 和 tiff 是支持的一些常见图像类型。

所以值得考虑。

正如其他人提到的那样，您可以构建一个 RTF 文档，有一些很好的 RTF 库用于 .net，例如[http://www.codeproject.com/KB/string/nrtftree.aspx](http://www.codeproject.com/KB/string/nrtftree.aspx)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-05-12T03:50:12.827

我写了[一篇关于 Open XML WordprocessingML 文档生成的博文系列](http://ericwhite.com/blog/map/generating-open-xml-wordprocessingml-documents-blog-post-series/)。我的方法是创建一个包含内容控件的模板文档，并在每个内容控件中编写一个 XPath 表达式，该表达式定义如何从包含驱动文档生成过程的数据的 XML 文档中检索内容。该代码是免费的，并在[Microsoft Reciprocal License (Ms-RL)](http://en.wikipedia.org/wiki/Shared_source)下获得许可。在同一个博客文章系列中，我还探讨了一种在内容控件中编写 C# 代码的方法。文档生成过程然后处理模板文档并生成生成所需文档的 C# 程序。这种方法的一个优点是您可以使用*任何*数据源作为文档生成过程的数据源。该代码还根据 Microsoft Reciprocal License 获得许可。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-15T11:05:14.050

我目前正在做这件事。

如果文档不是很大，不包含图像等，那么我将其存储为带有#MergeFields# 的 RTF，然后简单地用内容替换它们，将结果作为 RTF 发送给用户。

对于较大的文档，包括图像和动态插入的图像，我将初始 Word 文档另存为包含 #MergeFields# 的单个网页 *.mht 文件。然后我做和上面一样的事情。使用它，我可以轻松地呈现带有一些基本 Html 表格标签的 DataTable，并将其中一个 #MergeFields# 替换为整个表格。

图像可以存储在您的服务器上，并且 URL 也可以嵌入到文档中。

有趣的是，新的 Office 2007 文件格式实际上是 zip 文件 - 如果您将扩展名重命名为 .zip，您可以打开它们并查看其内容。这意味着您应该能够使用简单的 C# zip 库来切换图像等内容。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-08-13T22:21:07.313

@Dale Ragan：这将适用于 Office 2003 XML 格式，但这不是可移植的（例如 .doc 或 .docx 文件）。

要读/写这些，您需要使用 Word 对象库 ActiveX 控件：

[http://www.codeproject.com/KB/aspnet/wordapplication.aspx](http://www.codeproject.com/KB/aspnet/wordapplication.aspx)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-08-13T22:34:09.410

@Danny Smurf：实际上，这篇文章描述了 Rob 回答的 Office Open XML 格式。我将更加关注我现在发布的链接，以确保它们不会过时。我实际上在 WordML 上进行了搜索，这就是当时的名称。

我相信 Office Open XML 格式是最好的选择。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-11-14T09:56:50.777

[LibreOffice](http://www.libreoffice.org/)还支持通过 API 进行无头交互。不幸的是，目前还没有关于此功能的太多信息.. :(

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-12-27T19:08:10.487

您还可以使用 Word 文档生成器。它可用于客户端或服务器端部署。从项目描述：

> WordDocumentGenerator 是一个使用 Visual Studio 2010 和 Open XML 2.0 SDK 从模板生成 Word 文档的实用程序。WordDocumentGenerator 帮助生成不可刷新和可刷新的 Word 文档，基于预定义的模板，使用最少的代码更改。内容控件用作文档生成的占位符。它支持 Word 2007 和 Word 2010。

抓住它：[http ://worddocgenerator.codeplex.com/](http://worddocgenerator.codeplex.com/)

下载 SDK：[http ://www.microsoft.com/en-us/download/details.aspx?id=5124](http://www.microsoft.com/en-us/download/details.aspx?id=5124)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-06-06T22:37:33.763

另一种选择是[Windward Docgen](https://www.windwardstudios.com/programming-languages/csharp)（免责声明 - 我是创始人）。使用 Windward，您可以在 Word 中设计模板，包括图像、表格、图形、仪表和任何您想要的东西。您可以设置插入 XML 或 SQL 数据源数据的标签（包括 forEach 循环、导入等功能）。然后生成报告为 DOCX、PDF、HTML 等。

# configuration - IIS 7.0 中的模拟

> ID：10435
> 
> 赞同：7
> 
> 时间：2008-08-13T22:31:17.153
> 
> 标签：configuration, iis-7, impersonation

我有一个在 IIS 6.0 下可以正常工作的网站：它使用 Windows 凭据对用户进行身份验证，然后在与访问数据库的服务交谈时，它会传递凭据。

在 IIS 7.0 中，相同的配置设置不传递凭据，并且数据库被 NT AUTHORITY\ANONYMOUS 命中。

有什么我想念的吗？我已经在我的 IIS 7.0 网站中关闭了匿名访问，但我无法让它工作。

这些是我在 IIS 6.0 和 7.0 上使用的设置：

```
<authentication mode="Windows">
<identity impersonate="true"> 
```

从 6.0 到 7.0 发生了什么变化？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T00:13:52.377

IIS7 和 IIS6.0 之间发生了变化。我为您找到了一篇可能对您有实际帮助的博文（[点击此处查看](http://mvolo.com/blogs/serverside/archive/2007/12/08/IIS-7.0-Breaking-Changes-ASP.NET-2.0-applications-Integrated-mode.aspx)）。

您是在集成模式还是经典模式下运行您的应用程序？从我所见，将 Impersonate 属性设置为 true 应该会显示 500 错误，并显示以下错误消息：

> 内部服务器错误。这是 HTTP 错误 500.19：无法访问请求的页面，因为该页面的相关配置数据无效。

这是建议的解决方法：

> 解决方法：
> 
> 1) 如果您的应用程序不依赖于在 BeginRequest 和 AuthenticateRequest 阶段（在集成模式下无法模拟的唯一阶段）模拟请求用户，请通过将以下内容添加到应用程序的 web.config 来忽略此错误：
> 
> ```
> <validation validateIntegratedModeConfiguration="false" 
> ```
> 
> />
> 
> 2) 如果您的应用程序确实依赖于 BeginRequest 和 AuthenticateRequest 中的模拟，或者您不确定，请转到经典模式。

我希望这有助于了解 IIS 7.0 现在的工作原理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T02:38:35.910

您的 IIS 服务器是否设置为受 SQLServer 委派信任？我之前在使用 WebDAV 时遇到过这种情况，我们必须让运行受文件服务器信任的 IIS 的服务器代表文件服务器进行身份验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-08-13T22:41:29.613

有趣...我有相反的问题 -**无法**从客户端浏览器通过网络服务器并通过防火墙传递到大型企业网络内的数据库中的身份验证。

我还觉得对数据库的“端到端用户”身份验证是一个坏主意，并且存在潜在的安全风险。没有什么可以阻止最终用户加载 SQL 查询并直接连接到您的数据库，因此您最好锁定您的架构！

@Esteban - 澄清了我在帮助您回答*方面不是很有用。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T06:33:50.457

通常，如果您正在执行这样的双跳身份验证，则通常会涉及 Kerberos，除非第一个身份验证是 Basic。

我会检查 IIS 6 服务器上的身份验证，并确保它在 IIS 7 上相同。

如果 IIS 6 框设置为 Windows Integrated，那么您需要验证 kerberos 设置 - SPN、委派等。

# c - Send messages to program through command line

> ID：10443
> 
> 赞同：9
> 
> 时间：2008-08-13T22:40:57.603
> 
> 标签：c, architecture, command-line, io

I have this program, we'll call it Host. Host does all kinds of good stuff, but it needs to be able to accept input through the command line **while it's running**. This means it has to somehow send its other process data and then quit. For example, I need to be able to do this:

```
./Host --blahblah 3 6 3 5 
```

This should somehow end up calling some function in Host called

```
handleBlahBlah(int x1, int y1, int x2, int y2){
  //do some more sweet stuff
} 
```

Host is a C program, and does not need to support multiple instances.

An example of this is Amarok music player. With Amarok running and playing, you can type "amarok --pause" and it will pause the music.

I need to be able to do this in Linux or Windows. Preferably Linux.

What is the cleanest way to implement this?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-08-13T22:49:13.653

如果您在 Windows 上，我会告诉您使用隐藏窗口来接收消息，但是由于您使用`./`，我假设您想要基于 Unix 的东西。

在这种情况下，我会使用[命名管道](http://en.wikipedia.org/wiki/Named_pipe)。Sun 有一个关于命名管道的[教程](http://developers.sun.com/solaris/articles/named_pipes.html)，可能很有用。

该程序可能会创建管道并收听。您可以有一个单独的命令行脚本来打开管道并将其命令行参数回显给它。

您*可以*修改程序以支持命令行发送，而不是使用单独的脚本。在这种情况下，你会做同样的基本事情。您的程序将查看它的命令行参数，如果适用，打开通往程序“主”实例的管道，并发送参数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-08-13T22:51:30.453

如果它需要跨平台，您可能需要考虑让正在运行的实例侦听 TCP 端口，并让您从命令行启动的实例向该端口发送消息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-08-18T08:55:41.417

我建议使用[Unix 套接字](http://en.wikipedia.org/wiki/Unix_domain_socket)或[D-Bus](http://en.wikipedia.org/wiki/D-Bus)。如果您熟悉 Unix 套接字编程并且只需要一些操作，那么使用套接字可能会更快，而 D-Bus 可能更容易专注于以熟悉的面向对象方式实现功能。

看看[Beej 的 Unix IPC 指南，尤其是关于](http://beej.us/guide/bgipc/output/html/multipage/index.html)[Unix 套接字](http://beej.us/guide/bgipc/output/html/multipage/unixsock.html)的章节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-07T14:47:50.567

没有人在这里说过的是：“你不能从这里到达那里”。

命令行仅在调用程序时可用。

一旦**fillinthename**运行，调用“ **fillinthename** arguments ...”与**fillinthename**通信的例子只能通过使用相互通信的程序的两个实例来完成。

 **其他答案提出了实现沟通的方法。

一个类似于**amarok**的程序需要检测它自己的另一个实例的存在，以便知道它必须扮演哪个角色，持久消息接收器/服务器的主要角色，或者一次消息发送者的次要角色。

编辑以使单词 fillinthename 实际显示。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-11T17:32:45.453

我见过的一种技术是让你的`Host`程序仅仅是你真正程序的“外壳”。例如，当您正常启动应用程序时（例如：）`./Host`，程序将分叉到代码的“主应用程序”部分。当您以一种建议您希望向正在运行的实例发出信号的方式启动程序时（例如：）`./Host --send-message restart`，该程序将分叉到代码的“消息发送者”部分。这就像将两个应用程序合二为一。另一个不使用的选项`fork`是`Host`纯粹制作一个“消息发送者”应用程序，并将您的“主应用程序”作为一个单独的可执行文件（例如：）`Host_core`，`Host`可以单独启动。

程序的“主应用程序”部分需要打开某种通信通道来接收消息，而“消息发送者”部分需要连接到该通道并使用它来发送消息。有几种不同的选项可用于在进程之间发送消息。一些更常见的方法是[管道](http://www.tldp.org/LDP/lpg/node15.html)和[套接字](http://www.kernel.org/doc/man-pages/online/pages/man2/socket.2.html)。根据您的操作系统，您可能有其他可用选项；例如，QNX 有[频道](http://www.qnx.com/developers/docs/6.3.2/neutrino/lib_ref/c/channelcreate.html)，BeOS/Haiku 有[BMessages](http://api.haiku-os.org/classBMessage.html)。您也许还可以找到一个巧妙地封装了此功能的库，例如[lcm](http://code.google.com/p/lcm/)。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-08-13T22:43:34.367

So, I may be missing the point here, but by deafult a C program's main function takes two arguments; argc, a count of the number of arguments (at least one), and argv (or arg vector), the argument list. You could just parse through the arguments and call the correct method. For example:

```
 int main(int argc, *argv[])
 {
     /*loop through each argument and take action*/
      while (--argc > 0)
      {
           printf(%s%s, *++argv, (argc > 1) ? " " : "");
      }
 } 
```

would print all of the arguments to screen. I am no C guru, so I hope I haven't made any mistakes.

EDIT: Ok, he was after something else, but it wasn't really clear before the question was edited. Don't have to jump on my rep...**

# c# - 如何仅在您的应用中禁用 WebBrowser 的“点击声音”

> ID：10456
> 
> 赞同：27
> 
> 时间：2008-08-13T23:01:01.477
> 
> 标签：c#, .net, winforms

有问题的“点击声音”实际上是系统范围的偏好，所以我只希望在我的应用程序有焦点时禁用它，然后在应用程序关闭/失去焦点时重新启用。

本来我想在stackoverflow上问这个问题，但是我还没有进入beta版。因此，在谷歌搜索答案并仅找到一点点信息后，我想出了以下内容，并决定将其发布在这里，因为我处于测试阶段。

```
using System;
using Microsoft.Win32;

namespace HowTo
{
    class WebClickSound
    {
        /// <summary>
        /// Enables or disables the web browser navigating click sound.
        /// </summary>
        public static bool Enabled
        {
            get
            {
                RegistryKey key = Registry.CurrentUser.OpenSubKey(@"AppEvents\Schemes\Apps\Explorer\Navigating\.Current");
                string keyValue = (string)key.GetValue(null);
                return String.IsNullOrEmpty(keyValue) == false && keyValue != "\"\"";
            }
            set
            {
                string keyValue;

                if (value)
                {
                    keyValue = "%SystemRoot%\\Media\\";
                    if (Environment.OSVersion.Version.Major == 5 && Environment.OSVersion.Version.Minor > 0)
                    {
                        // XP
                        keyValue += "Windows XP Start.wav";
                    }
                    else if (Environment.OSVersion.Version.Major == 6)
                    {
                        // Vista
                        keyValue += "Windows Navigation Start.wav";
                    }
                    else
                    {
                        // Don't know the file name so I won't be able to re-enable it
                        return;
                    }
                }
                else
                {
                    keyValue = "\"\"";
                }

                // Open and set the key that points to the file
                RegistryKey key = Registry.CurrentUser.OpenSubKey(@"AppEvents\Schemes\Apps\Explorer\Navigating\.Current", true);
                key.SetValue(null, keyValue,  RegistryValueKind.ExpandString);
                isEnabled = value;
            }
        }
    }
} 
```

然后在主窗体中，我们在这 3 个事件中使用上述代码：

*   活性
*   停用
*   表格关闭

    ```
    private void Form1_Activated(object sender, EventArgs e)
    {
        // Disable the sound when the program has focus
        WebClickSound.Enabled = false;
    }

    private void Form1_Deactivate(object sender, EventArgs e)
    {
        // Enable the sound when the program is out of focus
        WebClickSound.Enabled = true;
    }

    private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
        // Enable the sound on app exit
        WebClickSound.Enabled = true;
    } 
    ```

我目前看到的一个问题是，如果程序崩溃，他们在重新启动我的应用程序之前不会有点击声音，但他们不知道这样做。

你们有什么感想？这是一个好的解决方案吗？可以做哪些改进？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2011-01-11T09:06:31.527

```
const int FEATURE_DISABLE_NAVIGATION_SOUNDS = 21;
const int SET_FEATURE_ON_PROCESS = 0x00000002;

[DllImport("urlmon.dll")]
[PreserveSig]
[return: MarshalAs(UnmanagedType.Error)]
static extern int CoInternetSetFeatureEnabled(int FeatureEntry,
                                              [MarshalAs(UnmanagedType.U4)] int dwFlags,
                                              bool fEnable);

static void DisableClickSounds()
{
    CoInternetSetFeatureEnabled(FEATURE_DISABLE_NAVIGATION_SOUNDS,
                                SET_FEATURE_ON_PROCESS,
                                true);
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-08-13T23:10:16.810

我注意到，如果您使用 WebBrowser.Document.Write 而不是 WebBrowser.DocumentText，则不会发生单击声音。

所以代替这个：

```
webBrowser1.DocumentText = "<h1>Hello, world!</h1>"; 
```

试试这个：

```
webBrowser1.Document.OpenNew(true);
webBrowser1.Document.Write("<h1>Hello, world!</h1>"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-23T22:38:50.290

您可以通过将导航声音的 Internet Explorer 注册表值更改为“NULL”来禁用它：

```
Registry.SetValue("HKEY_CURRENT_USER\\AppEvents\\Schemes\\Apps\\Explorer\\Navigating\\.Current","","NULL"); 
```

并通过将导航声音的 Internet Explorer 注册表值更改为“C:\Windows\Media\Cityscape\Windows Navigation Start.wav”来启用它：

```
Registry.SetValue("HKEY_CURRENT_USER\\AppEvents\\Schemes\\Apps\\Explorer\\Navigating\\.Current","","C:\Windows\Media\Cityscape\Windows Navigation Start.wav"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-08-13T23:13:02.750

绝对感觉像是一个 hack，但是很久以前对此进行了一些研究并且没有找到任何其他解决方案，这可能是您最好的选择。

更好的是设计您的应用程序，这样它就不需要很多烦人的页面重新加载。例如，如果您正在刷新 iframe 以检查服务器上的更新，请改用 XMLHttpRequest。（你能告诉我在“AJAX”一词被创造之前的日子里我正在处理这个问题吗？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-03T21:01:02.913

如果要使用替换 Windows 注册表，请使用以下命令：

```
// backup value
RegistryKey key = Registry.CurrentUser.OpenSubKey(@"AppEvents\Schemes\Apps\Explorer\Navigating\.Current");
string BACKUP_keyValue = (string)key.GetValue(null);

// write nothing
key = Registry.CurrentUser.OpenSubKey(@"AppEvents\Schemes\Apps\Explorer\Navigating\.Current", true);
key.SetValue(null, "",  RegistryValueKind.ExpandString);

// do navigation ...

// write backup key
RegistryKey key = Registry.CurrentUser.OpenSubKey(@"AppEvents\Schemes\Apps\Explorer\Navigating\.Current", true);
key.SetValue(null, BACKUP_keyValue,  RegistryValueKind.ExpandString); 
```

# c# - .Net 中是否有“Set”数据结构？

> ID：10458
> 
> 赞同：56
> 
> 时间：2008-08-13T23:03:42.253
> 
> 标签：c#, data-structures, set

理想情况下，我正在寻找一个模板化的逻辑 Set 类。它将具有所有标准集合操作，例如 Union、Intersection 等，并折叠重复项。

我最终基于 C# Dictionary<> 创建了我自己的集合类 - 仅使用键。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-08-13T23:05:20.457

[`HashSet<T>`](http://msdn.microsoft.com/en-us/library/bb359438.aspx)大概是你能得到的最接近的，我想。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-08-13T23:44:59.063

我见过的最好的集合实现是精彩的 Wintellect 的 Power Collections 的一部分：http: [//www.codeplex.com/PowerCollections](http://www.codeplex.com/PowerCollections)。

集合实现可以在这里找到： http:
[//www.codeplex.com/PowerCollections/SourceControl/FileView.aspx?itemId=101886](http://www.codeplex.com/PowerCollections/SourceControl/FileView.aspx?itemId=101886&changeSetId=6259)
&changeSetId=6259 它具有所有预期的集合操作（​​联合、相交等）。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-08-13T23:08:53.973

不，框架中没有原生的。大多数项目都使用一个开源实现（即 nHibernate），称为 Iesi.Collections。这是一篇关于它的 CodeProject 文章：

[http://www.codeproject.com/KB/recipes/sets.aspx](http://www.codeproject.com/KB/recipes/sets.aspx)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-14T04:05:00.453

你检查过 3.5中的[HashSet吗？](http://msdn.microsoft.com/en-us/library/bb397727.aspx)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-08-13T23:17:00.557

我不认为 c# 有任何内置的东西，但我知道网上有几个实现。也有一些关于这类事情的好文章：

[这是](http://msdn.microsoft.com/en-us/library/ms379575(VS.80).aspx)关于有效表示数据结构的系列文章的第 6 部分。本部分重点介绍用 C# 表示集合。

集合
[的实现 集合类的实现](http://www.codeproject.com/KB/recipes/Types_Set.aspx)[集合](http://www.codeproject.com/KB/collections/SetCollectionsForCSharp.aspx)类的另一个
[实现](http://www.codeproject.com/KB/recipes/yaset.aspx)

最后...

实际上，我自己使用[这个库](http://www.codeproject.com/KB/recipes/sets.aspx)作为我大约一年前所做的一组实现的基础。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-05-10T01:51:59.153

这是一个简单的实现：

```
public sealed class MathSet<T> : HashSet<T>, IEquatable<MathSet<T>>
{
    public override int GetHashCode() => this.Select(elt => elt.GetHashCode()).Sum().GetHashCode();

    public bool Equals(MathSet<T> obj) => SetEquals(obj);

    public override bool Equals(object obj) => Equals(obj as MathSet<T>);

    public static bool operator ==(MathSet<T> a, MathSet<T> b) =>
        ReferenceEquals(a, null) ? ReferenceEquals(b, null) : a.Equals(b);

    public static bool operator !=(MathSet<T> a, MathSet<T> b) => !(a == b);
} 
```

示例用法：

```
var a = new MathSet<int> { 1, 2, 3 };
var b = new MathSet<int> { 3, 2, 1 };

var c = a.Equals(b);                        // true

var d = new MathSet<MathSet<int>> { a, b }; // contains one element

var e = a == b;                             // true 
```

请参阅[这个问题](https://stackoverflow.com/questions/47688779/set-class-with-mathematical-set-equality-by-default)，了解为什么这种方法被认为是过度的`HashSet`。

# editor - 触控打字软件推荐

> ID：10475
> 
> 赞同：26
> 
> 时间：2008-08-13T23:29:38.707
> 
> 标签：editor, touch-typing

由于键盘是我们使用计算机**的**界面，我一直认为触摸打字应该是我应该学习的东西，但我一直是，好吧，懒惰是这个词。那么，有人推荐任何好的触摸打字软件吗？

谷歌很容易，但我想听听建议。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-08-13T23:32:27.560

[亡灵打字！](http://en.wikipedia.org/wiki/Typing_of_the_Dead)

它已经好几年了，所以你可能不得不四处打猎，但它很有趣，除了主游戏之外，还有许多小游戏可以练习你可能不擅长的特定领域。

![替代文字](../Images/5cd00db50a5d8ccf85ba7a77b4e2cd95.png)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-08-14T03:06:20.547

[我在GNU Typist](http://www.gnu.org/software/gtypist/)上训练了我的打字。如果您愿意，它会附带各种语言和键盘布局的练习。

我用过的最*有趣*的打字程序之一是 dvorak7min。它有一个*令人讨厌*的模式，对于您输入的每个错字，光标都会返回 1。因此，如果您不注意打字，您将返回到第 1 格……。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-11T16:14:55.337

如果你想要一些学习触摸打字的**动力，请阅读 Steve Yegge 的博客咆哮：**

[编程最肮脏的小秘密](http://steve-yegge.blogspot.com/2008/09/programmings-dirtiest-little-secret.html)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-11-01T22:08:08.783

使用 Firefox 在网络上查找长文档

按`CTRL`+`F`

与文档一起键入。试试看，它有效。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-08-13T23:37:53.620

梅维斯灯塔。

虽然不如 Typing of the Dead 有趣！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-08-14T03:28:03.467

我从 10 岁起就开始使用触摸打字（当时是在一台真正的打字机上！），但帮助我姐姐学习触摸打字的一件事是在 IRC 频道上闲逛。您希望能够尽可能快地“说话”，这可以训练她更快地打字。

我知道这是一个蹩脚的答案，而不是真正的软件解决方案或什么，但它对我认识的很多人都有效。:)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-04-02T20:44:59.850

试试[http://keybr.com/](http://keybr.com/)？它与免费打字导师的通常格式略有不同。如果您创建一个帐户，它也会跟踪您的进度。没有附加软件，没有弹出窗口或其他无用的垃圾。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-08-13T23:33:53.800

如果您想通过深入学习来学习... [DasKeyboard Ultimate](http://www.daskeyboard.com/)将让您立即触摸打字 :)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-04T15:15:16.940

我使用[快速打字](http://www.rapidtyping.com/downloads.html)来学习触摸打字。它具有出色的视觉效果，打字甚至有些放松。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-08-13T23:55:56.127

关于使用 DasKeyboard 的推荐，我今天才开始使用！但请注意，它会产生很多噪音。在我超级安静的办公室里挤满了其他人，他们是工程师，但大多数人不是开发人员，我感到羞愧。我问对面的人是不是太吵了。她犹豫了片刻，坚持说没关系，当我说我会把它收起来时，她几乎没有抗议。所以我把它打包了。也许如果您只是被其他开发人员包围，那就没问题了。我很想听听相反的经历。不过，我现在正在离家出走，尽可能大声，并且喜欢它！

哦，你一定会学会触摸打字！现在我有一张带标签的键盘图片作为我的桌面图像，但我越来越少地提到它。

麦克风

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-08-14T01:09:36.337

我有一种非常奇怪的习惯性打字方式，我左手用几个手指，但右手只用一两个手指。这已经为我服务了多年，显然每分钟给我 80 多个单词，但它确实是一种非常奇怪的打字方式。这是触摸打字，但不使用“标准”手指排列。虽然尝试修复已经有效的东西可能不是一个好主意，但我想我会尝试重新学习以正确的方式输入（左手指在 asdf 上，右手指在 jkl 上；）。

我一直在尝试 Mavis Beacon，它看起来不错，它会慢慢地在你的曲目中添加越来越多的字母，让你获得肌肉记忆或其他任何东西，然后专注于速度。“游戏”似乎有点毫无意义（这个程序是为孩子设计的吗？），但我想对于那些不知道键在哪里的人来说，它可以很好地告诉你使用哪些手指以及在哪里移动它们。正如我已经知道大部分程序的键在哪里并没有真正帮助我。一旦您知道按键在哪里，您可能只想练习输入文本，而除了记事本之外，这样的程序除了计算每分钟的单词数并给您一些输入内容之外，并不会真正帮助您。不过，我同意 Typing of the dead 非常棒，而且一旦你的速度肯定会有所帮助

所有你触摸的打字机都使用标准的手指排列还是你只是做你自己的事情？我想我已经得出结论，我会坚持我所知道的，无论如何它似乎都有效。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-08-14T04:19:18.247

为了完整起见，我的妻子使用了[KP Typing Tutor](http://www.fonlow.com/kptypingtutor/)，效果很好。

+1 聊天更多

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-03-03T00:24:35.480

我为 Vim 使用了 TTCoach 插件并且对它非常满意。然而，它没有任何数字和符号的练习，但很容易自己制作一些文本文件并编写：TTCustom file.txt 以用于练习。

一次只学习几个字符，当你确定它们时，再学习几个，依此类推......

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-08-13T23:57:29.150

我一直在使用[TypeFaster](http://www.typefastertypingtutor.com/)。它并不漂亮，但一个不错的功能是它可以加载不同键盘布局的课程，例如 Colemak（[此处的布局文件](http://colemak.com/Learn)）或 Dvorak。

# graphics - 贝塞尔曲线上的等距点

> ID：10477
> 
> 赞同：9
> 
> 时间：2008-08-13T23:31:32.697
> 
> 标签：graphics, interpolation, bezier, curve

目前，我正在尝试使多个贝塞尔曲线具有等距点。我目前正在使用三次插值来查找这些点，但是由于贝塞尔曲线的工作方式，某些区域比其他区域更密集，并且由于距离可变，因此证明纹理映射很粗糙。 **有没有办法通过距离而不是百分比来查找贝塞尔曲线上的点？此外，是否可以将其扩展到多条连接曲线？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-12T22:23:58.293

这称为“弧长”参数化。几年前我写了一篇关于这个的论文：

[http://www.saccade.com/writing/graphics/RE-PARAM.PDF](http://www.saccade.com/writing/graphics/RE-PARAM.PDF)

这个想法是预先计算“参数化”曲线，并通过它评估曲线。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-08-14T00:47:05.103

P_0 和 P_3 之间的距离（立方形式），是的，但我想你知道，是直截了当的。

曲线上的距离就是弧长：

[图 1 http://www.codecogs.com/eq.latex?%5Cint_%7Bt_0%7D%5E%7Bt_1%7D%20%7B%20|P'(t)|%20dt](http://www.codecogs.com/eq.latex?%5Cint_%7Bt_0%7D%5E%7Bt_1%7D%20%7B%20|P'(t)|%20dt)

在哪里：

[图 2 http://www.codecogs.com/eq.latex?P%27(t)%20=%20[%7Bx%27,y%27,z%27%7D]%20=%20[% 7B%5Cfrac%7Bdx(t)%7D%7Bdt%7D,%5Cfrac%7Bdy(t)%7D%7Bdt%7D,%5Cfrac%7Bdz(t)%7D%7Bdt%7D%7D]](http://www.codecogs.com/eq.latex?P%27(t)%20=%20[%7Bx%27,y%27,z%27%7D]%20=%20[%7B%5Cfrac%7Bdx(t)%7D%7Bdt%7D,%5Cfrac%7Bdy(t)%7D%7Bdt%7D,%5Cfrac%7Bdz(t)%7D%7Bdt%7D%7D])

[（见其余）](http://steve.hollasch.net/cgindex/curves/cbezarclen.html)

可能你会有 t_0 = 0、t_1 = 1.0 和 dz(t) = 0（二维平面）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-15T04:40:56.887

我知道这是一个老问题，但我最近遇到了这个问题并创建了一个`UIBezierPath`扩展来解决`X`给定坐标的`Y`坐标，反之亦然。速写。

[https://github.com/rkotzy/RKBezierMath](https://github.com/rkotzy/RKBezierMath)

```
extension UIBezierPath {

func solveBezerAtY(start: CGPoint, point1: CGPoint, point2: CGPoint, end: CGPoint, y: CGFloat) -> [CGPoint] {

    // bezier control points
    let C0 = start.y - y
    let C1 = point1.y - y
    let C2 = point2.y - y
    let C3 = end.y - y

    // The cubic polynomial coefficients such that Bez(t) = A*t^3 + B*t^2 + C*t + D
    let A = C3 - 3.0*C2 + 3.0*C1 - C0
    let B = 3.0*C2 - 6.0*C1 + 3.0*C0
    let C = 3.0*C1 - 3.0*C0
    let D = C0

    let roots = solveCubic(A, b: B, c: C, d: D)

    var result = [CGPoint]()

    for root in roots {
        if (root >= 0 && root <= 1) {
            result.append(bezierOutputAtT(start, point1: point1, point2: point2, end: end, t: root))
        }
    }

    return result
}

func solveBezerAtX(start: CGPoint, point1: CGPoint, point2: CGPoint, end: CGPoint, x: CGFloat) -> [CGPoint] {

    // bezier control points
    let C0 = start.x - x
    let C1 = point1.x - x
    let C2 = point2.x - x
    let C3 = end.x - x

    // The cubic polynomial coefficients such that Bez(t) = A*t^3 + B*t^2 + C*t + D
    let A = C3 - 3.0*C2 + 3.0*C1 - C0
    let B = 3.0*C2 - 6.0*C1 + 3.0*C0
    let C = 3.0*C1 - 3.0*C0
    let D = C0

    let roots = solveCubic(A, b: B, c: C, d: D)

    var result = [CGPoint]()

    for root in roots {
        if (root >= 0 && root <= 1) {
            result.append(bezierOutputAtT(start, point1: point1, point2: point2, end: end, t: root))
        }
    }

    return result

}

func solveCubic(a: CGFloat?, var b: CGFloat, var c: CGFloat, var d: CGFloat) -> [CGFloat] {

    if (a == nil) {
        return solveQuadratic(b, b: c, c: d)
    }

    b /= a!
    c /= a!
    d /= a!

    let p = (3 * c - b * b) / 3
    let q = (2 * b * b * b - 9 * b * c + 27 * d) / 27

    if (p == 0) {
        return [pow(-q, 1 / 3)]

    } else if (q == 0) {
        return [sqrt(-p), -sqrt(-p)]

    } else {

        let discriminant = pow(q / 2, 2) + pow(p / 3, 3)

        if (discriminant == 0) {
            return [pow(q / 2, 1 / 3) - b / 3]

        } else if (discriminant > 0) {
            let x = crt(-(q / 2) + sqrt(discriminant))
            let z = crt((q / 2) + sqrt(discriminant))
            return [x - z - b / 3]
        } else {

            let r = sqrt(pow(-(p/3), 3))
            let phi = acos(-(q / (2 * sqrt(pow(-(p / 3), 3)))))

            let s = 2 * pow(r, 1/3)

            return [
                s * cos(phi / 3) - b / 3,
                s * cos((phi + CGFloat(2) * CGFloat(M_PI)) / 3) - b / 3,
                s * cos((phi + CGFloat(4) * CGFloat(M_PI)) / 3) - b / 3
            ]

        }

    }
}

func solveQuadratic(a: CGFloat, b: CGFloat, c: CGFloat) -> [CGFloat] {

    let discriminant = b * b - 4 * a * c;

    if (discriminant < 0) {
        return []

    } else {
        return [
            (-b + sqrt(discriminant)) / (2 * a),
            (-b - sqrt(discriminant)) / (2 * a)
        ]
    }

}

private func crt(v: CGFloat) -> CGFloat {
    if (v<0) {
        return -pow(-v, 1/3)
    }
    return pow(v, 1/3)
}

private func bezierOutputAtT(start: CGPoint, point1: CGPoint, point2: CGPoint, end: CGPoint, t: CGFloat) -> CGPoint {

    // bezier control points
    let C0 = start
    let C1 = point1
    let C2 = point2
    let C3 = end

    // The cubic polynomial coefficients such that Bez(t) = A*t^3 + B*t^2 + C*t + D
    let A = CGPointMake(C3.x - 3.0*C2.x + 3.0*C1.x - C0.x, C3.y - 3.0*C2.y + 3.0*C1.y - C0.y)
    let B = CGPointMake(3.0*C2.x - 6.0*C1.x + 3.0*C0.x, 3.0*C2.y - 6.0*C1.y + 3.0*C0.y)
    let C = CGPointMake(3.0*C1.x - 3.0*C0.x, 3.0*C1.y - 3.0*C0.y)
    let D = C0

    return CGPointMake(((A.x*t+B.x)*t+C.x)*t+D.x, ((A.y*t+B.y)*t+C.y)*t+D.y)
}

// TODO: - future implementation
private func tangentAngleAtT(start: CGPoint, point1: CGPoint, point2: CGPoint, end: CGPoint, t: CGFloat) -> CGFloat {

    // bezier control points
    let C0 = start
    let C1 = point1
    let C2 = point2
    let C3 = end

    // The cubic polynomial coefficients such that Bez(t) = A*t^3 + B*t^2 + C*t + D
    let A = CGPointMake(C3.x - 3.0*C2.x + 3.0*C1.x - C0.x, C3.y - 3.0*C2.y + 3.0*C1.y - C0.y)
    let B = CGPointMake(3.0*C2.x - 6.0*C1.x + 3.0*C0.x, 3.0*C2.y - 6.0*C1.y + 3.0*C0.y)
    let C = CGPointMake(3.0*C1.x - 3.0*C0.x, 3.0*C1.y - 3.0*C0.y)

    return atan2(3.0*A.y*t*t + 2.0*B.y*t + C.y, 3.0*A.x*t*t + 2.0*B.x*t + C.x)
}

} 
```

# javascript - 在浏览器中获取选定的文本，跨平台

> ID：10478
> 
> 赞同：14
> 
> 时间：2008-08-13T23:32:09.370
> 
> 标签：javascript, browser

我想在基于浏览器的应用程序中做的一件事是允许用户选择一些文本（不是在 <textarea> 中，只是纯文本！），然后让我的应用程序弹出一个小工具栏然后可以与下一个交互（在我的例子中，添加注释）。

我在谷歌上找到了很多似乎专注于编写所见即所得编辑器的东西，**但这不是我想要**的，而且大部分都在 IE 中工作，但在 FF2 或 3 中没有。理想情况下，我想要一些可以在**IE7（和 6，如果可能）、FireFox 2 & 3 和 Safari 2**中工作的浏览器窗口中返回当前选定文本的函数。如果它在 Opera 中工作，那将是一个奖励，但这不是必需的。

任何人都有这样做的功能？或者知道从哪里开始？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-04T06:41:01.140

那个 jQuery 插件很酷，但它完成了一项非常具体的任务：用标签包裹你突出显示的文本。这可能正是您想要的。但是，如果您不想（或处于无法）向页面添加任何无关标记，则可以尝试以下解决方案：

```
function getSelectedText() {
  var txt = '';

  if (window.getSelection) {
    txt = window.getSelection();
  }
  else if (document.getSelection) {
    txt = document.getSelection();
  }
  else if (document.selection) {
    txt = document.selection.createRange().text;
  }
  else return; 

  return txt;
} 
```

此函数返回一个表示文本选择的对象。它可以跨浏览器工作（尽管我怀疑它返回的对象会因浏览器而略有不同，并且仅对结果的实际文本而不是任何附加属性可靠）。

注意：我最初在这里发现了该代码片段：http: [//www.codetoad.com/javascript_get_selected_text.asp](http://www.codetoad.com/javascript_get_selected_text.asp)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-08-13T23:52:35.400

看看[jQuery](http://jquery.com)和[wrapSelection 插件](http://plugins.jquery.com/project/wrapSelection)。这可能是您正在寻找的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-17T20:21:46.323

[Range 简介](http://www.quirksmode.org/dom/range_intro.html)有一些关于不同浏览器如何让您访问文本选择的详细信息。

我的经验是，直接使用这些不同的 API 非常笨拙，所以如果[wrapSelection](http://plugins.jquery.com/project/wrapSelection)对你有用，我会选择它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-04T12:38:59.487

这些天这种方法[应该足够了](https://caniuse.com/#search=window.getSelection)：

```
function getSelectedText() {
    return window.getSelection ? window.getSelection().toString() : '';
} 
```

它会`''`在极少数情况下在真正旧的浏览器中返回，并且可能是在 Opera Mini 的情况下（尽管有待测试，这可能已经过时）+ 请参阅 Android 版 UC 浏览器的说明。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-08-17T20:25:28.047

[此处概述](http://quirksmode.org/dom/w3c_range.html)了各个浏览器在选择方面的行为。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-08-17T20:35:22.440

此代码适用于 Safari、IE 和 Firefox - 希望对您有所帮助

```
var str = (window.getSelection) ? window.getSelection() : document.selection.createRange();
str = str.text || str;
str = str + ''; // the best way to make object a string... 
```

# unit-testing - 单元测试执行速度（每秒多少次测试？）

> ID：10486
> 
> 赞同：24
> 
> 时间：2008-08-13T23:36:28.130
> 
> 标签：unit-testing, performance

你的单元测试目标是什么类型的执行率（每秒测试 # 个）？对于单个单元测试来说，多长时间太长了？

我很想知道人们是否有任何特定的阈值来确定他们的测试是否太慢，或者只是当长时间运行的测试套件的摩擦变得更好时？

最后，当您决定测试需要更快地运行时，您使用什么技术来加快测试速度？

*注意：集成测试显然又是另一回事了。我们严格来说是需要尽可能频繁地运行的单元测试。*

* * *

**回应综述：**感谢迄今为止的出色回应。大多数建议似乎是不要担心速度——专注于质量，如果它们太慢，就选择性地运行它们。具有特定数字的答案包括每次测试的目标是 <10ms，最多 0.5 和 1 秒，或者只是将整个通常运行的测试套件保持在 10 秒以下。

不确定当它们都有帮助时将其标记为“已接受的答案”是否正确:)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-08-14T00:08:30.467

所有单元测试应在一秒钟内运行（即所有单元测试组合应在 1 秒内运行）。现在我确信这有实际限制，但我有一个项目有 1000 次测试，可以在笔记本电脑上快速运行。您真的需要这样的速度，这样您的开发人员就不会害怕重构模型的某些核心部分（即，让我在运行这些测试时去喝杯咖啡……10 分钟后他回来了）。

此要求还迫使您正确设计应用程序。这意味着您的域模型是纯粹的，并且包含对任何类型的持久性（文件 I/O、数据库等）的零引用。单元测试都是关于测试那些业务关系。

现在这并不意味着您忽略测试您的数据库或持久性。但是这些问题现在被隔离在可以使用位于单独项目中的集成测试单独测试的存储库后面。在编写域代码时不断运行单元测试，然后在签入时运行集成测试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-20T17:05:38.237

目标是每秒进行 100 次测试。到达那里的方法是遵循 Michael Feather 的[单元测试规则](http://www.artima.com/weblogs/viewpost.jsp?thread=126923)。

[在过去的CITCON](http://www.citconf.com/)讨论中提出的重要一点是，如果您的测试没有这么快，那么您很可能无法获得单元测试的设计优势。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-08-13T23:44:35.290

如果我们在谈论严格的单元测试，我会更注重完整性而不是速度。如果运行时间开始引起摩擦，请将测试分成不同的项目/类等，并且只运行与您正在处理的内容相关的测试。让集成服务器在签入时运行所有测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-08-13T23:44:34.743

我倾向于更多地关注测试的可读性而不是速度。但是，我仍然尝试使它们相当快。我认为如果它们以毫秒的数量级运行，你就可以了。如果他们每次测试运行第二个或更多......那么你可能正在做一些应该优化的事情。

缓慢的测试只会在系统成熟并导致构建花费数小时时才会成为问题，此时您更有可能遇到许多缓慢测试的问题，而不是您可以轻松优化的一两个测试。 . 因此，如果您看到许多测试每次运行数百毫秒（或更糟，每次运行几秒钟），您可能应该立即注意，而不是等到它达到数百个测试需要很长时间（此时它正在运行）真的很难解决问题）。

即便如此，它只会减少您的自动构建发出错误之间的时间......我认为，如果它是一个小时后（甚至几个小时后）也没关系。问题是在您签入之前运行它们，但这可以通过选择一小部分与您正在处理的工作相关的测试来运行来避免。如果您签入的代码会破坏您未运行的测试，请确保修复构建！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-08-13T23:48:17.450

我们目前在大约 3.something 秒内进行了 270 次测试。可能有大约 8 个测试执行文件 IO。

这些是在每台工程师机器上成功构建我们的库后自动运行的。我们有更广泛（和耗时）的冒烟测试，每晚由构建机器完成，或者可以在工程师机器上手动启动。

如您所见，我们还没有解决测试太耗时的问题。对我来说 10 秒是它开始变得侵入性的点，当我们开始接近它时，我们会看看它。我们可能会将较低级别的库移动到夜间构建或仅由构建机器执行的配置中，这些库更健壮，因为它们不经常更改并且几乎没有依赖关系。

如果您发现运行一百个左右的测试花费的时间超过几秒钟，您可能需要检查您归类为单元测试的内容以及是否将其更好地视为冒烟测试。

您的里程显然会根据您的开发领域而变化很大。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-14T05:59:27.343

数据点——Python回归测试

以下是我的笔记本电脑上为 Python 2.5.2 运行“make test”的数字：

*   测试次数：3851（大约）
*   执行时间：9 分 6 秒
*   执行率：7 次测试/秒

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-08-13T23:54:16.037

我根据每个测试来判断我的单元测试，而不是每秒的测试次数。我的目标是 500 毫秒或更少。如果高于此，我将研究测试以找出为什么需要这么长时间。

当我认为测试变慢时，通常意味着它做得太多。因此，只需通过将测试拆分为更多测试来重构测试通常就可以解决问题。我注意到我的测试运行缓慢的其他时间是，当测试显示我的代码存在瓶颈时，则需要对代码进行重构。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-20T12:35:00.733

> 对于单个单元测试来说，多长时间太长了？

我会说这取决于编译速度。通常在每次编译时执行测试。单元测试的目的不是放慢速度，而是带来一个信息“*没有坏，继续*”（或“有什么坏*了，停止*”）。

在这开始变得烦人之前，我不会担心测试执行速度。

危险是停止运行测试，因为它们太慢了。

> 最后，当您决定测试需要更快地运行时，您使用什么技术来加快测试速度？

首先要做的是设法找出为什么它们太慢，**问题是在单元测试中还是在被测代码中？**

我会尝试将测试套件分成几个逻辑部分，只运行 *应该*受到我在每次编译时更改的代码影响的部分。我会减少运行其他套件的频率，也许每天一次，或者当我怀疑我可能会破坏某些东西时，至少**在集成**.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-24T08:47:35.607

一些框架提供基于启发式（例如上次修改时间）的特定单元测试的自动执行。对于 Ruby 和 Rails，AutoTest 提供了更快和响应更快的测试执行——当我保存 Rails 模型`app/models/foo.rb`时，相应的单元测试`test/unit/foo_test.rb`就会运行。

我不知道其他平台是否存在类似的东西，但这是有道理的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-09-17T08:33:06.063

关于单元测试的最重要的规则之一是它们应该运行***得快***。

> 对于单个单元测试来说，多长时间太长了？

开发人员应该能够在几秒钟内运行整套单元测试，绝对不是几分钟。无论如何，开发人员应该能够在更改代码后快速运行它们。如果花费的时间太长，他们将不会费心运行它们，并且您会失去测试的主要好处之一。

> 你的单元测试目标是什么类型的执行率（每秒测试 # 个）？

您应该瞄准每个测试以毫秒为单位运行，任何超过 1 秒的时间都可能测试太多。

我们目前有大约 800 个测试在 30 秒内运行，大约每秒 27 个测试。这包括启动运行它们所需的移动模拟器的时间。它们中的大多数都需要 0-5 毫秒（如果我没记错的话）。

我们有一两个大约需要 3 秒的时间，这可能是检查的候选对象，但重要的是整个测试套件不会花费太长时间以至于它会推迟开发人员运行它，并且不会显着减慢我们的持续集成构建。

我们还将可配置的超时限制设置为 5 秒——任何花费更长的时间都会失败。

# oracle - Oracle - 我使用的是什么 TNS 名称文件？

> ID：10499
> 
> 赞同：57
> 
> 时间：2008-08-13T23:49:15.623
> 
> 标签：oracle, connection, tnsnames, tns

有时我会遇到 Oracle 连接问题，因为我无法确定我的数据库客户端正在使用哪个 tnsnames.ora 文件。

解决这个问题的最佳方法是什么？++对各种平台解决方案感到高兴。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2008-08-27T09:41:36.483

Oracle 提供了一个名为`tnsping`：

```
R:\>tnsping someconnection

TNS Ping Utility for 32-bit Windows: Version 9.0.1.3.1 - Production on 27-AUG-20
08 10:38:07

Copyright (c) 1997 Oracle Corporation.  All rights reserved.

Used parameter files:
C:\Oracle92\network\ADMIN\sqlnet.ora
C:\Oracle92\network\ADMIN\tnsnames.ora

TNS-03505: Failed to resolve name

R:\>

R:\>tnsping entpr01

TNS Ping Utility for 32-bit Windows: Version 9.0.1.3.1 - Production on 27-AUG-20
08 10:39:22

Copyright (c) 1997 Oracle Corporation.  All rights reserved.

Used parameter files:
C:\Oracle92\network\ADMIN\sqlnet.ora
C:\Oracle92\network\ADMIN\tnsnames.ora

Used TNSNAMES adapter to resolve the alias
Attempting to contact (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = **)
 (PROTOCOL = TCP) (Host = ****) (Port = 1521))) (CONNECT_DATA = (SID = ENTPR0
1)))
OK (40 msec)

R:\> 
```

这应该显示您正在使用的文件。该实用程序位于 Oracle`bin`目录中。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-08-13T23:52:15.570

对于 Linux：

```
$ strace sqlplus -L scott/tiger@orcl 2>&1| grep -i 'open.*tnsnames.ora' 
```

显示如下内容：

```
open("/opt/oracle/product/10.2.0/db_1/network/admin/tnsnames.ora",O_RDONLY)=7 
```

更改为

```
$ strace sqlplus -L scott/tiger@orcl 2>&1| grep -i 'tnsnames.ora' 
```

将显示所有失败的文件路径。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-08-30T09:12:33.723

TNS 位置存储在另一个地方：如果您使用的是 Windows，请打开`regedit`并导航到`My HKEY Local Machine/Software/ORACLE/KEY_OraClient10_home1`您`KEY_OraClient10_home1`的 Oracle 主目录。如果有一个名为 的字符串条目`TNS_ADMIN`，那么该条目的值将指向 Oracle 在您的计算机上使用的 TNS 文件。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-14T08:09:28.587

在我的开发机器上，我有三个不同版本的 Oracle 客户端软件。我`tnsnames.ora`在其中一个中管理文件。在另外两个中，我在`tnsnames.ora`文件中输入了：

```
ifile=path_to_tnsnames.ora_file/tnsnames.ora 
```

这样，如果由于某种原因`tnsnames.ora`客户端使用了错误的文件，它将始终以最新版本结束。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-08-27T09:08:55.297

对于 Windows： SysInternals 的[Filemon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)将显示正在访问的文件。

请记住设置您的过滤器，这样您就不会被繁琐的文件系统流量所淹没。

![过滤器对话框](../Images/f673ad0903f375846536d5bb8affa9db.png)

**补充：** Filemon 不适用于较新的 Windows 版本，因此您可能必须使用[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645)。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-09T20:45:48.043

Codeslave 询问“难道不应该一直是”$ORACLE_HOME/network/admin/tnsnames.ora”吗？答案是否定的，不是。考虑在同一台机器上的这两个 tnsping 调用：

```
C:\Documents and Settings\me>D:\Oracle\10.2.0_DB\BIN\tnsping orcl

TNS Ping Utility for 32-bit Windows: Version 10.2.0.4.0 - Production on 09-OCT-2
008 14:30:12

Copyright (c) 1997,  2007, Oracle.  All rights reserved.

Used parameter files:
D:\Oracle\10.2.0_DB\network\admin\sqlnet.ora

Used TNSNAMES adapter to resolve the alias
Attempting to contact (DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = xxxx
)(PORT = 1521)) (CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ORCL)))

OK (40 msec)

C:\Documents and Settings\me>tnsping orcl

TNS Ping Utility for 32-bit Windows: Version 10.2.0.1.0 - Production on 09-OCT-2
008 14:30:21

Copyright (c) 1997, 2005, Oracle.  All rights reserved.

Used parameter files:
D:\oracle\10.2.0_Client\network\admin\sqlnet.ora

Used TNSNAMES adapter to resolve the alias
Attempting to contact (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)
(HOST = XXXX)(PORT = 1521))) (CONNECT_DATA = (SERVICE_NAME = ORCL)))
OK (20 msec)

C:\Documents and Settings\me> 
```

请注意两个不同的参数文件位置，这取决于您正在运行的 tnsping 可执行文件（以及可能从哪里运行它）。对于基于 tnsnames 的 oracle 网络，使用 TNS_ADMIN 变量是确保获得一致的 tnsnames.ora 文件的唯一方法。（注意：以 Windows 为中心的答案）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-08-31T23:05:25.133

默认情况下，tnsnames.ora 位于 UNIX 操作系统上的 $ORACLE_HOME/network/admin 目录和 Windows 操作系统上的 ORACLE_HOME\network\admin 目录中。tnsnames.ora 也可以存储在以下位置：

TNS_ADMIN 环境变量（或注册表值）指定的目录

在 UNIX 操作系统上，全局配置目录。例如，在 Solaris 操作系统上，此目录为 /var/opt/oracle

如果您有多个 ORACLE_HOMES，请注意您使用的是哪一个，因为 tnsnames.ora 文件的位置可能从一个 ORACLE_HOME 到另一个不同。

对于提到 TWO_TASK 环境变量的人，它用于设置要连接的默认数据库服务名称（可能是另一台服务器上的数据库）。然后在连接时在 tnsnames.ora 文件中查找您设置 TWO_TASK 的服务名称。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-08-14T17:23:45.723

它不应该总是“$ORACLE_HOME/network/admin/tnsnames.ora”吗？然后你可以只做“echo $oracle_home”或*nix等价物。

@Pete Holberton 你是完全正确的。这让我想起了，在作品中还有另一个活动扳手，叫做 TWO_TASK

根据[http://www.orafaq.com/wiki/TNS_ADMIN](http://www.orafaq.com/wiki/TNS_ADMIN)
TNS_ADMIN 是一个环境变量，它指向 SQL*Net 配置文件（如 sqlnet.ora 和 tnsnames.ora）所在的目录。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-12-11T15:30:40.087

`strace sqlplus -L scott/tiger@orcl`有助于查找`.tnsnames.ora`文件`/home/oracle`以查找所需的文件而不是`$ORACLE_HOME/network/admin/tnsnames.ora`文件。感谢您的发帖。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-03-25T22:24:15.723

不是直接回答您的问题，但我自己尝试查找和更新所有 tnsnames 文件感到非常沮丧，因为我安装了几个 oracle：客户端、BI 工具、OWB 等，每个都有自己的 oracle 主页。我最终创建了一个名为 TNSNamesSync 的实用程序，它将更新所有 oracle home 中的所有 tnsname。它在 MIT 许可下，可以在这里免费使用[https://github.com/artybug/TNSNamesSync/releases](https://github.com/artybug/TNSNamesSync/releases)

文档在这里： [https ://github.com/artchik/TNSNamesSync/blob/master/README.md](https://github.com/artchik/TNSNamesSync/blob/master/README.md)

不过，这仅适用于 Windows。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-04T20:31:19.863

最简单的方法可能是检查连接到数据库的进程的**PATH环境变量。**tnsnames.ora 文件很可能位于路径..\network\admin中的*第一个 Oracle bin 目录中。*TNS_ADMIN 环境变量或注册表中的值（对于当前的 Oracle 主目录）可能会覆盖它。

像其他人建议的那样使用 filemon 也可以解决问题。

# java - DBUnit 的奇怪 DB2 问题

> ID：10506
> 
> 赞同：3
> 
> 时间：2008-08-13T23:57:01.567
> 
> 标签：java, db2, dbunit, db2-luw

我在运行 DBUnit 测试时遇到了一个奇怪的 DB2 问题。我的 DBUnit 测试是高度定制的，但我认为这不是问题。当我运行测试时，我遇到了失败：

> SQLCODE：-1084，SQLSTATE：57019

[这转化为](https://www1.columbia.edu/sec/acis/db2/db2m0/sql1000.htm)

> SQL1084C 无法分配共享内存段。

这听起来像是一个奇怪的内存问题，尽管这是一个很奇怪的事情。如果我 ssh 到测试数据库服务器，然后进入 db2 并执行“连接到 MY_DB”，测试开始成功！这似乎与正在报告的假定内存错误无关。

我有 2 个测试，第一个实际上成功了，第二个是失败的。但是，当它获取到数据库服务器的连接以加载我的 xml 数据集时，它在 DBUnit 设置代码中失败。

任何想法可能会发生什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-08-14T01:05:31.087

好吧，我想我通过执行以下操作来修复它：

```
db2stop force
db2start 
```

至少，现在事情似乎正在运作......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T20:32:58.720

就我而言，这是一个过期的 DB/2 许可证。您可以通过发出 db2licm -l 查看您的许可证

如果您有许可证文件，您可以通过以下方式安装它，例如：db2licm -a db2ese.lic

[也可以看看](http://publib.boulder.ibm.com/infocenter/tivihelp/v2r1/index.jsp?topic=/com.ibm.IBMDS.doc/pdguide10.htm)

# php - 在 IIS 上运行 PHP 应用程序需要什么？

> ID：10515
> 
> 赞同：8
> 
> 时间：2008-08-14T00:12:18.980
> 
> 标签：php, windows, iis, portability, lamp

作为 LAMP 服务器上的 PHP 开发人员已经有一段时间了，在为 Windows 上的*IIS*准备应用程序时，有什么需要考虑的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-08-14T00:17:03.463

确保获得 IIS 6.0 或 IIS 7.0 的 FastCGI 扩展。这是在 IIS 下运行 PHP 时最重要的事情。这篇文章也应该让你设置：

[http://learn.iis.net/page.aspx/247/using-fastcgi-to-host-php-applications-on-iis-60/](http://learn.iis.net/page.aspx/247/using-fastcgi-to-host-php-applications-on-iis-60/)

除此之外的一切都很简单，MySQL 等等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-08-14T01:02:52.340

我们刚刚在我们的共享主机平台上推出了 PHP 5.2.6 + FastCGI，没有任何问题。只要您按照[尼克链接](https://stackoverflow.com/questions/10515/php-on-iis#10519)到的文章中概述的步骤进行操作，就可以了。

我唯一的额外建议是忘记使用`fcgiconfig.js`脚本来修改 fcgiext.ini 文件，这与其说是帮助，不如说是一个障碍。只需手动编辑它，您还可以了解更多关于它的工作原理。

如果您将 PHP 安装到 IIS 7 上，那么此链接应该值得一读：

> [使用 FastCGI 在 IIS 7 上托管 PHP 应用程序](http://learn.iis.net/page.aspx/246/using-fastcgi-to-host-php-applications-on-iis7/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-14T13:42:07.827

@pix0r

这实际上也让我很恼火，没有什么能比得上 Apache mod_rewrite。因为它们都有这种过于复杂的 XML 结构。所以我实际上花时间为 IIS 6.0 和 IIS 7.0 编写了自己的重写器。非 .NET 应用程序仅适用于 IIS 7.0。

[http://www.managedfusion.com/products/url-rewriter/](http://www.managedfusion.com/products/url-rewriter/)

[http://www.codeplex.com/urlrewriter](http://www.codeplex.com/urlrewriter)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-08-14T00:56:51.837

我对 IIS 的主要症结之一是缺少 Apache 的 mod_rewrite。根据您所做的工作，还有其他变通方法和类似工作，但请记住，如果您广泛使用 mod rewrite，则需要稍微更改以使用 IIS。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-27T15:33:02.300

由于您正在从 LAMP（一个有点酷的首字母缩写词）转向 WIMP（一个不太酷的），您可能需要在精神上肯定自己。否则，我在 Windows 上使用 PHP 时遇到的麻烦很少。

ISAPI 重写 ( [http://www.isapirewrite.com/](http://www.isapirewrite.com/) ) 是 99 美元，对我来说在 URL 重写方面效果很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-08-27T15:34:54.090

为什么不在 Windows 上使用 Apache？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-10T16:18:12.283

如果您使用 iis 7 密切关注这个项目，[http](http://phpmanager.codeplex.com/) ://phpmanager.codeplex.com/ 。

# .net - Expression.Invoke 在实体框架中？

> ID：10524
> 
> 赞同：29
> 
> 时间：2008-08-14T00:24:43.320
> 
> 标签：.net, linq, entity-framework, linq-to-entities

实体框架不支持`Expression.Invoke`运算符。尝试使用它时收到以下异常：

> “LINQ to Entities 不支持 LINQ 表达式节点类型‘Invoke’。

有没有人为这个缺失的功能找到解决方法？我想在实体框架上下文中使用[此处详述的 PredicateBuilder。](http://www.albahari.com/nutshell/predicatebuilder.html)

**编辑 1** @marxidad - 我喜欢你的建议，但它确实让我有些困惑。您能否就您提出的解决方案提供进一步的建议？

**编辑 2** @marxidad - 感谢您的澄清。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-05T04:56:19.300

[PredicateBuilder](http://www.albahari.com/nutshell/predicatebuilder.aspx)和[LINQKit](http://www.albahari.com/nutshell/linqkit.aspx)现在支持实体框架。

对不起，伙计们，因为没有早点这样做！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-08-17T22:06:30.667

实体框架将 LINQ 表达式转换为实体命令树，并且在其中仅支持其规范函数。您必须使用带有规范函数的命令树来执行 PredicateBuilder 之类的操作。

# c# - 通过反射使用 C# 和 OpenOffice

> ID：10531
> 
> 赞同：5
> 
> 时间：2008-08-14T00:36:01.600
> 
> 标签：c#, reflection

我正在编写一些代码以直接从 C#粘贴到当前活动的[OpenOffice文档中。](http://en.wikipedia.org/wiki/OpenOffice.org)我不能包含任何 OpenOffice 库，因为我们不想打包它们，所以我们使用反射来访问[OpenOffice API](http://en.wikipedia.org/wiki/Universal_Network_Objects)。

我的问题涉及通过反射使用调度程序。我无法弄清楚传递给它的正确参数，由于类型不匹配，给了我一个可爱的“TargetInvocationException”。

```
object objframe = GetProperty<object>(objcontroller, "frame");
if (objframe != null)
{
    object[] paramlist = new object[2] {".uno:Paste", objframe};
    InvokeMethod<object>(objdispatcher, "executeDispatch", paramlist);
} 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-08-14T01:29:10.960

只是我还是你的参数是错误的方式？另外，你有正确数量的参数吗？不过，我可能会遗漏一些东西，如果你已经检查过这些东西，很抱歉：

文档说：

```
dispatcher.executeDispatch(document, ".uno:Paste", "", 0, Array()) 
```

这将向我表明您需要将参数列表定义为

```
object[] paramlist = new object[5] {objframe, ".uno:Paste", "", 0, null}; 
```

# php - 从 PHP 连接到 postgresql 数据库的首选方法是什么？

> ID：10532
> 
> 赞同：7
> 
> 时间：2008-08-14T00:36:20.287
> 
> 标签：php, postgresql

我已经使用 PHP 和 MySQL 很长时间了，现在我将开始使用 PostgreSQL。

首选方法是什么？

是通过 PDO 对象还是有更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-08-14T00:54:51.030

PDO 对象是新的热点。我建议只要您能确保您的目标平台将始终运行 PHP 5.2+。

还有许多其他支持 PostgreSQL 的数据库抽象层与旧版本的 PHP 兼容；我推荐[ADODB](http://adodb.sourceforge.net/)。

即使您的 MySQL 工作，您也应该真正使用 PDO 或不同的抽象层；这样你就不会再遇到这个问题了！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-08-14T05:11:13.930

使用 Zend 数据库：

```
require_once 'Zend/Db.php';
$DB_ADAPTER = 'Pdo_Pgsql';
$DB_CONFIG = array(
    'username' => 'app_db_user',
    'password' => 'xxxxxxxxx',
    'host'     => 'localhost',
    'port'     => 5432,
    'dbname'   => 'mydb'
);
$db = Zend_Db::factory($DB_ADAPTER, $DB_CONFIG); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-14T00:55:59.217

当我有选择的时候，我个人会使用 PDO 来完成我所有的数据库工作。准备好的语句让我的生活变得轻松，并且它在数据库系统之间是无缝的 - 如果您必须使用一个您不习惯的系统，它会很方便。

如果你想推出自己的抽象，或者使用程序模型，这里是 Postgre 函数：[http ://ca.php.net/manual/en/ref.pgsql.php](http://ca.php.net/manual/en/ref.pgsql.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-20T05:01:18.990

还有[pg_whatever 函数](http://us.php.net/manual/en/book.pgsql.php)，但不要使用它们。

他们使用较旧的、未维护的数据库驱动程序。 [PDO](http://us.php.net/pdo)是要走的路。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-14T04:46:37.817

如果您决定不使用 PDO，我还建议创建一个继承的 PDO 类或包装类。这将在未来为您提供更多的灵活性。IE。计算查询执行时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-08-14T05:31:03.327

根据应用程序的规模，您可能希望考虑到后端的连接数。共识似乎是 PHP 持久连接和 PostgreSQL 不能很好地协同工作，所以像[pgpool-||这样的东西](http://pgpool.projects.postgresql.org/ "pgpool-II") 应该用作中介。

# regex - 在 Perl 中使用正则表达式解析属性

> ID：10533
> 
> 赞同：2
> 
> 时间：2008-08-14T00:40:26.753
> 
> 标签：regex, perl

这是我最近遇到的一个问题。我有表单的属性字符串

```
"x=1 and y=abc and z=c4g and ..." 
```

一些属性具有数值，一些具有字母值，一些具有混合属性，一些具有日期，等等。

每个字符串都*应该*以“ `x=someval and y=anotherval`”开头，但有些则没有。我有三件事需要做。

1.  验证字符串以确保它们具有`x`和`y`。
2.  `x`实际上解析和的值`y`。
3.  获取字符串的其余部分。

鉴于顶部的示例，这将导致以下变量：

```
$x = 1;
$y = "abc";
$remainder = "z=c4g and ..." 
```

我的问题是：是否有（合理）简单的方法来解析这些*并*使用单个正则表达式进行验证？IE：

```
if ($str =~ /someexpression/)
{
    $x = $1;
    $y = $2;
    $remainder = $3;
} 
```

请注意，字符串可能*仅* `x`包含和`y`属性。这是一个有效的字符串。

我将发布我的解决方案作为答案，但它不符合我的单正则表达式偏好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-08-21T20:02:11.173

假设您还想对其他 name=value 对做一些事情，我会这样做（使用 Perl 版本 5.10）：

```
use 5.10.0;
use strict;
use warnings;

my %hash;
while(
    $string =~ m{
       (?: ^ | \G )    # start of string or previous match
       \s*

       (?<key>   \w+ ) # word characters
       =
       (?<value> \S+ ) # non spaces

       \s*             # get to the start of the next match
       (?: and )?
    }xgi
){
    $hash{$+{key}} = $+{value};
}

# to make sure that x & y exist
die unless exists $hash{x} and exists $hash{y}; 
```

在较旧的 Perl 上（至少 Perl 5.6）；

```
use strict;
use warnings;

my %hash;
while(
    $string =~ m{
       (?: ^ | \G )   # start of string or previous match
       \s*

       ( \w+ ) = ( \S+ )

       \s*            # get to the start of the next match
       (?: and )?
    }xgi
){
    $hash{$1} = $2;
}

# to make sure that x & y exist
die unless exists $hash{x} and exists $hash{y}; 
```

如果您需要处理更多数据，这些还​​有继续工作的额外好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-08-14T01:56:53.480

我不是最擅长正则表达式，但这似乎非常接近您正在寻找的内容：

```
/x=(.+) and y=([^ ]+)( and (.*))?/ 
```

除非您使用 1 美元、2 美元和 4 美元。正在使用：

```
my @strs = ("x=1 and y=abc and z=c4g and w=v4l",
            "x=yes and y=no",
            "z=nox and w=noy");

foreach (@strs) {
    if ($_ =~ /x=(.+) and y=([^ ]+)( and (.*))?/) {
        $x = $1;
        $y = $2;
        $remainder = $4;
        print "x: $x; y: $y; remainder: $remainder\n";
    } else {
        print "Failed.\n";
    }
} 
```

输出：

```
x: 1; y: abc; remainder: z=c4g and w=v4l
x: yes; y: no; remainder: 
Failed. 
```

这当然会遗漏大量的错误检查，而且我对您的输入一无所知，但这似乎可行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-17T15:39:50.480

作为对陆克文版本的一个相当简单的修改，

```
/^x=(.+) and y=([^ ]+)(?: and (.*))?/ 
```

将允许您使用 $1、$2 和 $3（?: 使其成为非捕获组），并将确保字符串以“x=”开头，而不是允许“not_x=”匹配

如果您对 x 和 y 值有更好的了解，则应该使用它来进一步收紧正则表达式：

```
my @strs = ("x=1 and y=abc and z=c4g and w=v4l",
        "x=yes and y=no",
        "z=nox and w=noy",
        "not-x=nox and y=present",
        "x=yes and w='there is no and y=something arg here'");

foreach (@strs) {
    if ($_ =~ /^x=(.+) and y=([^ ]+)(?: and (.*))?/) {
        $x = $1;
        $y = $2;
        $remainder = $3;
        print "x: {$x}; y: {$y}; remainder: {$remainder}\n";
    } else {
        print "$_ Failed.\n";
    }
} 
```

输出：

```
x: {1}; y: {abc}; remainder: {z=c4g and w=v4l}
x: {yes}; y: {no}; remainder: {}
z=nox and w=noy Failed.
not-x=nox and y=present Failed.
x: {yes and w='there is no}; y: {something}; remainder: {} 
```

请注意，最后一个测试的缺失部分是由于当前版本的 y 测试不需要空格，如果 x 测试具有相同的限制，则字符串会失败。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T15:20:12.470

Rudd 和 Cebjyre 已经帮助你完成了大部分工作，但他们都有一些问题：

路德建议：

> /x=(.+) and y=([^ ]+)( and (.*))?/

Cebjyre 将其修改为：

> /^x=(.+) and y=([^ ]+)(?: and (.*))?/

第二个版本更好，因为它不会将 "not_x=foo" 与 "x=foo" 混淆，但会接受诸如 "x=foo z=bar y=baz" 之类的内容并设置 $1 = "foo z=bar" 即不可取。

这可能是您正在寻找的：

> /^x=(\w+) 和 y=(\w+)(?: 和 (.*))?/

这不允许 x= 和 y= 选项、places 和 allow 以及可选的 "and..." 之间的任何内容，这将是 $3

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-14T00:46:38.473

这基本上是我为解决这个问题所做的：

```
($x_str, $y_str, $remainder) = split(/ and /, $str, 3);

if ($x_str !~ /x=(.*)/)
{
    # error
}

$x = $1;

if ($y_str !~ /y=(.*)/)
{
    # error
}

$y = $1; 
```

我省略了一些额外的验证和错误处理。这种技术有效，但并不像我希望的那样简洁或漂亮。我希望有人能给我更好的建议。

# windows - 如何设置编辑器以在 Windows 上使用 Git？

> ID：10564
> 
> 赞同：611
> 
> 时间：2008-08-14T01:43:04.270
> 
> 标签：windows, git, cygwin, editor

我正在**Windows 上试用 Git**。我到了尝试“git commit”的地步，但出现了这个错误：

> 终端是哑的，但没有定义 VISUAL 或 EDITOR。请使用 -m 或 -F 选项提供消息。

所以我发现我需要一个名为 EDITOR 的环境变量。没问题。我将其设置为指向记事本。这几乎奏效了。默认提交消息在记事本中打开。但记事本不支持裸换行。我出去买了[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)，但我不知道如何将 Notepad++ 设置为`%EDITOR%`它可以按预期与 Git 一起使用。

我没有嫁给记事本++。在这一点上，我不介意我使用什么编辑器。我只想能够**在编辑器中输入提交消息，**而不是在命令行（使用`-m`）。

那些在 Windows 上使用 Git 的人：你用什么工具来编辑你的提交消息，你必须做什么才能让它工作？

* * *

## 回答 #1

> 赞同：605
> 
> 时间：2009-04-21T18:34:54.007

2015 年 9 月更新（6 年后）

[git-for-Windows (2.5.3)](https://github.com/git-for-windows/git/releases/tag/v2.5.3.windows.1)的最新版本现在包括：

> 通过配置**`git config core.editor notepad`**，用户[现在可以`notepad.exe`用作他们的默认编辑器](https://github.com/git-for-windows/git/issues/381)。
> 配置`git config format.commitMessageColumns 72`将由记事本包装器拾取，并在用户编辑提交消息后对其进行换行。

请参阅[Johannes Schindelin (](https://github.com/dscho) [)](https://github.com/dscho)的[提交 69b301b](https://github.com/git-for-windows/build-extra/commit/69b301bbd7c18226c63d83638991cb2b7f84fb64)。[`dscho`](https://github.com/dscho)

并且 Git 2.16（2018 年第一季度）将显示一条消息，告诉用户它在生成编辑器时正在等待用户完成编辑，以防编辑器打开到隐藏窗口或模糊的地方而用户迷路。

请参阅[提交 a64f213](https://github.com/git/git/commit/abfb04d0c74cde804c734015ff5868a88c84fb6f)（2017年 11 月 29 日）由[Lars Schneider (](https://github.com/larsxschneider) [)](https://github.com/larsxschneider)[提交 a64f213](https://github.com/git/git/commit/a64f213d3fa13fa01e582b6734fe7883ed975dc9) （2017 年 12 月 7 日） 。 帮助者：[Junio C Hamano (](https://github.com/gitster) [)](https://github.com/gitster)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 0c69a13](https://github.com/git/git/commit/0c69a132cb1adf0ce9f31e6631f89321e437cb76))^(中，2017 年 12 月 19 日）)[`larsxschneider`](https://github.com/larsxschneider)
[`gitster`](https://github.com/gitster)
^([`gitster`](https://github.com/gitster))

> ## `launch_editor()`: 表示 Git 等待用户输入
> 
> 当图形`GIT_EDITOR`由打开并等待用户输入的 Git 命令生成（例如“ `git rebase -i`”）时，编辑器窗口可能会被其他窗口遮挡。
> 用户可能会盯着原始的 Git 终端窗口，甚至没有意识到他/她需要在 Git 继续之前与另一个窗口交互。对于这个用户，Git 似乎挂起。
> 
> 如果终端支持擦除最后一行，则在原始终端中打印 Git 正在等待编辑器输入的消息，并在编辑器返回时将其删除

* * *

原始答案

我刚刚用 git 版本 1.6.2.msysgit.0.186.gf7512 和 Notepad++5.3.1 测试了它

我宁愿*不必*设置 EDITOR 变量，所以我尝试了：

```
git config --global core.editor "\"c:\Program Files\Notepad++\notepad++.exe\""
# or
git config --global core.editor "\"c:\Program Files\Notepad++\notepad++.exe\" %*" 
```

这总是给出：

```
C:\prog\git>git config --global --edit
"c:\Program Files\Notepad++\notepad++.exe" %*: c:\Program Files\Notepad++\notepad++.exe: command not found
error: There was a problem with the editor '"c:\Program Files\Notepad++\notepad++.exe" %*'. 
```

如果我定义一个 npp.bat 包括：

```
"c:\Program Files\Notepad++\notepad++.exe" %* 
```

我输入：

```
C:\prog\git>git config --global core.editor C:\prog\git\npp.bat 
```

它只适用于 DOS 会话，**但不适用于 git shell**。
（不是 core.editor 的配置机制，带“ `start /WAIT...`”的脚本是不行的，只能打开一个新的 DOS 窗口）

* * *

[Bennett 的回答](https://stackoverflow.com/questions/10564/how-can-i-set-up-an-editor-to-work-with-git-on-windows/1431003#1431003)提到了避免添加脚本的可能性，而是**在简单的引号之间**直接引用程序本身。注意斜线的方向！使用`/`NOT`\`分隔路径名中的文件夹！

```
git config --global core.editor \
"'C:/Program Files/Notepad++/notepad++.exe' -multiInst -notabbar -nosession -noPlugin" 
```

或者，如果您在 64 位系统中：

```
git config --global core.editor \
"'C:/Program Files (x86)/Notepad++/notepad++.exe' -multiInst -notabbar -nosession -noPlugin" 
```

但我更喜欢使用脚本（见下文）：这样我就可以使用不同的路径或不同的选项，而无需再次注册`git config`.

* * *

实际的解决方案（使用脚本）是要意识到：
**您在配置文件中引用的实际上是一个 shell ( `/bin/sh`) 脚本**，而不是 DOS 脚本。

那么起作用的是：

```
C:\prog\git>git config --global core.editor C:/prog/git/npp.bat 
```

与`C:/prog/git/npp.bat`：

```
#!/bin/sh
"c:/Program Files/Notepad++/notepad++.exe" -multiInst "$*" 
```

或者

```
#!/bin/sh
"c:/Program Files/Notepad++/notepad++.exe" -multiInst -notabbar -nosession -noPlugin "$*" 
```

使用该设置，我可以`git config --global --edit`从 DOS 或 Git Shell 执行 ' '，或者我可以`git rebase -i ...`从 DOS 或 Git Shell 执行 ' '。
Bot 命令将触发 notepad++ 的新实例（因此有`-multiInst`' 选项），并等待该实例关闭后再继续。

请注意，我只使用'/'，而不是`\`'。我[使用选项 2 安装了 msysgit。](https://stackoverflow.com/questions/623518/msysgit-on-windows-what-should-i-be-aware-of-if-any)（将`git\bin`目录添加到`PATH`环境变量，但没有覆盖一些内置的 windows 工具）

notepad++ 包装器被称为 .bat 的事实并不重要。
最好将其命名为“npp.sh”并将其放在`[git]\cmd`目录中（或放在 PATH 环境变量引用的任何目录中）。

* * *

也可以看看：

*   [如何使用可视 diff 程序查看“git diff”输出？](https://stackoverflow.com/questions/255202/how-do-i-view-git-diff-output-with-visual-diff-program/255212#255212)对于一般理论
*   [如何使用 msysgit / gitk 设置 DiffMerge？](https://stackoverflow.com/questions/780425/how-do-i-setup-diffmerge-with-msysgit-gitk/783667#783667)另一个外部工具示例（DiffMerge 和 WinMerge）

* * *

[lightfire228](https://stackoverflow.com/users/2716305/lightfire228)[在评论中](https://stackoverflow.com/questions/10564/how-can-i-set-up-an-editor-to-work-with-git-on-windows/773973#comment74027740_773973)添加：

> 对于任何遇到 N++ 只打开一个空白文件而 git 不接受您的提交消息的问题的人，请参阅“ [Aborting commit due to empty message](https://stackoverflow.com/q/30085970/6309) ”：将您的`.bat`or`.sh`文件更改为：

```
"<path-to-n++" .git/COMMIT_EDITMSG -<arguments>. 
```

> 这将告诉 notepad++ 打开临时提交文件，而不是一个空白的新文件。

* * *

## 回答 #2

> 赞同：327
> 
> 时间：2009-09-16T04:48:39.503

基于[Darren 的回答](https://stackoverflow.com/questions/10564/how-can-i-set-up-an-editor-to-work-with-git-on-windows/1083830#1083830)，要使用 Notepad++，您可以简单地执行此操作（全部在一行上）：

```
git config --global core.editor "'C:/Program Files/Notepad++/notepad++.exe' -multiInst -notabbar -nosession -noPlugin" 
```

显然，该`C:/Program Files/Notepad++/notepad++.exe`部分应该是系统上 Notepad++ 可执行文件的路径。例如，它可能是`C:/Program Files (x86)/Notepad++/notepad++.exe`.

它对我来说就像一个魅力。

文章[How to set Notepad++ as the default Git editor for the commits instead of Vim](https://www.theserverside.com/blog/Coffee-Talk-Java-News-Stories-and-Opinions/How-to-set-Notepad-as-the-default-Git-editor-for-commits-instead-of-Vim)解释了命令的参数。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2009-07-05T10:46:18.873

无论如何，我一直在玩这个，发现以下内容对我很有效：

```
git config --global core.editor "'C:/Program Files/TextPad 5/TextPad.exe' -m" 
```

我认为 CMD 不喜欢单引号，因此您必须使用双引号“指定嵌入空格的字符串参数”。

另一方面，Cygwin（我相信它是 Git 的 Bash 的底层平台）同时`'`喜欢`"`; 您可以指定类似 CMD 的路径，使用`/`而不是`\`，只要字符串被引用，即在这种情况下，使用单引号。

覆盖/指示使用`-m`多个编辑器，并且不需要`%*`在最后添加。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2011-01-10T22:02:12.710

**编辑：**更新到 Vim 7.3 后，我得出的结论是，最干净和最简单的方法是：

1.  将 Vim 的主文件夹添加到您的路径（右键单击*我的电脑*→*属性*→*高级*→*环境变量*）

2.  运行这个：

    ```
    git config --global core.editor "gvim --nofork '%*'" 
    ```

如果你这样做，那么我相当肯定它也适用于 Cygwin。

**原答案：**

即使有几个与 Vim 相关的答案，我也无法在 Windows 下使用 gVim（而不使用批处理文件或 %EDITOR% 或 Cygwin）。

我最终得出的结论是干净整洁，并借鉴了这里的一些解决方案：

```
git config --global core.editor \
"'C:/Program Files/Vim/vim72/gvim.exe' --nofork '%*'" 
```

我花了一段时间的一个问题是这些不是 Windows 风格的反斜杠。它们是正常的正斜杠。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-08-14T03:18:32.830

Notepad++ 工作得很好，虽然我选择坚持使用记事本、-m，甚至有时是内置的“编辑”。

您在使用 Notepad++ 时遇到的问题与 Git 如何启动编辑器可执行文件有关。我对此的解决方案是将环境变量设置`EDITOR`为批处理文件，而不是实际的编辑器可执行文件，它执行以下操作：

```
start /WAIT "E:\PortableApps\Notepad++Portable\Notepad++Portable.exe" %* 
```

`/WAIT`告诉命令行会话暂停直到应用程序退出，因此您将能够在 Git 愉快地等待您的同时编辑您心中的内容。%* 将所有参数传递给批处理文件到 Notepad++。

```
C:\src> echo %EDITOR%
C:\tools\runeditor.bat 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2010-08-06T09:37:00.710

**[写字板](http://en.wikipedia.org/wiki/WordPad)！**

我很高兴使用 Vim，但由于我试图将 Git 介绍给公司，所以我想要我们都拥有的东西，并发现写字板似乎工作正常（即 Git 确实等到你完成编辑并关闭窗户）。

```
git config core.editor '"C:\Program Files\Windows NT\Accessories\wordpad.exe"' 
```

那是在 msysgit 上使用 Git Bash；我没有尝试过 Windows 命令提示符（如果这有什么不同的话）。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2016-10-06T15:46:28.207

对于**[Atom](https://en.wikipedia.org/wiki/Atom_(text_editor))**你可以做

```
git config --global core.editor "atom --wait" 
```

和**[Visual Studio Code类似](https://en.wikipedia.org/wiki/Visual_Studio_Code)**

```
git config --global core.editor "code --wait" 
```

这将打开一个**Atom**或**Visual Studio Code**窗口供您提交，

或**[崇高文本](http://en.wikipedia.org/wiki/Sublime_Text)**：

```
git config --global core.editor "subl -n -w" 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2009-10-15T19:28:15.843

我也在 Windows 上使用 Cygwin，但使用 gVim（而不是基于终端的[Vim](http://en.wikipedia.org/wiki/Vim_%28text_editor%29)）。

为了完成这项工作，我做了以下工作：

1.  `git_editor.bat`创建了一个包含以下内容 的单行批处理文件（名为）：`"C:/Program Files/Vim/vim72/gvim.exe" --nofork "%*"`
2.  放在`git_editor.bat`我的`PATH`.
3.  放`GIT_EDITOR=git_editor.bat`

完成此操作后`git commit`， 等将正确调用 gVim 可执行文件。

注意 1：`--nofork`gVim 的选项确保它在提交消息被写入之前一直阻塞。

注意 2：如果路径中有空格，则需要在 gVim 路径周围加上引号。

注意 3：如果 Git 传递带有空格的文件路径，则需要在 "%*" 周围加上引号。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2011-09-26T00:54:56.867

感谢 Stack Overflow 社区……以及一些研究，我能够让我最喜欢的编辑器 [**EditPad Pro**](http://www.editpadpro.com)作为核心编辑器在 Windows XP SP3 上使用 msysgit 1.7.5.GIT 和 TortoiseGit v1.7.3.0。 ..

按照上面的建议，我为代码编辑器添加了 Bash 脚本的路径......

```
git config --global core.editor c:/msysgit/cmd/epp.sh 
```

然而，在对上述解决方案进行了几次失败的尝试之后......我终于能够让它工作了。根据 EditPad Pro 的文档，添加 '/newinstance' 标志将允许 shell 等待编辑器输入......

' **/newinstance** '标志是我案例的关键......

```
#!/bin/sh
"C:/Program Files/JGsoft/EditPadPro6/EditPadPro.exe" //newinstance "$*" 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2011-07-08T14:44:27.650

这是更大问题的一个症状。值得注意的是，您有一些设置`TERM=dumb`。其他无法正常工作的`less`命令是表示您没有功能齐全的终端的命令。

这似乎最常见的原因是在全局 Windows 环境变量中将 TERM 设置为某个值。对我来说，当我安装[Strawberry Perl](http://en.wikipedia.org/wiki/Strawberry_Perl)时出现了这个问题，一些关于这个问题的信息是关于[这个问题的 msysgit 错误](http://code.google.com/p/msysgit/issues/detail?id=184#c42)以及几个解决方案。

第一个解决方案是在您的 ~/.bashrc 中添加以下内容来修复它：

```
export TERM=msys 
```

您可以从 Git Bash 提示符执行此操作，如下所示：

```
echo "export TERM=msys" >> ~/.bashrc 
```

另一个解决方案，最终是我所做的，因为我不关心 Strawberry Perl 添加到我的环境设置的原因，是[按照 msysgit bug report 的评论中的指示](http://code.google.com/p/msysgit/issues/detail?id=184#c40)去`TERM=dumb`删除。`TERM=dumb`

> 控制面板/系统/高级/环境变量...（或类似，取决于您的 Windows 版本）是在 Windows 上设置粘性环境变量的位置。默认情况下，未设置 TERM。如果在那里设置了 TERM，那么您（或您已安装的程序之一 - 例如 Strawberry Perl）已设置它。删除该设置，你应该没问题。

同样，如果您使用 Strawberry Perl 并关心[CPAN](http://en.wikipedia.org/wiki/CPAN)客户端或类似的东西，您可以不理会它`TERM=dumb`并`unset TERM`在您的 ~/.bashrc 文件中使用它，这将具有与如上所述设置显式术语类似的效果。

当然，所有其他解决方案都是正确的，因为您可以使用它`git config --global core.editor $MYFAVORITEEDITOR`来确保 Git 在需要为您启动一个编辑器时使用您最喜欢的编辑器。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2017-01-13T14:39:55.153

编辑 c:\Users\YourUser 文件夹中的 .gitconfig 文件并添加：

```
[core]
editor = 'C:\\Program files\\path\\to\\editor.exe' 
```

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-08-14T14:39:14.887

[Vim/gVim](http://www.vim.org/)很适合我。

```
>echo %EDITOR%

c:\Vim\Vim71\vim.exe 
```

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2018-10-29T15:15:15.637

我需要执行以下*两项*操作才能让 Git 在 Windows 中启动 Notepad++：

*   将以下内容添加到 .gitconfig：

    ```
    editor = 'C:/Program Files/Notepad++/notepad++.exe' -multiInst -notabbar -nosession -noPlugin 
    ```

*   修改启动 Git Bash shell 的快捷方式以管理员身份运行，然后使用该快捷方式启动 Git Bash shell。我猜测上下文菜单条目“Git Bash here”没有以所需的权限启动 Notepad++。

完成上述两项后，它起作用了。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2010-04-06T09:36:53.073

我的 PortableGit 1.6 工作正常，但升级到 PortableGit 1.7 Windows 版本后，我遇到了问题。一些 Git 命令可以很好地打开 Notepad++.exe，但有些不能，尤其是*Git rebase*的行为不同。

问题是一些命令运行 Windows cmd 进程，而一些使用 Unix cmd 进程。我想给记事本++编辑器提供启动属性，所以我需要一个自定义的脚本。我的解决方案是这样的。

1.  创建一个脚本来运行适当的文本编辑器。该脚本看起来很奇怪，但它同时处理了 Windows 和 Unix 变体。

    **c:/PortableGit/cmd/git-editor.bat**

    ```
    #!/bin/sh
    # Open a new instance

    function doUnix() {
      "c:\program files\notepad++\notepad++.exe" -multiInst -nosession -notabbar $*
      exit
    }

    doUnix $*

    :WINCALL
    "c:\program files\notepad++\notepad++.exe" -multiInst -nosession -notabbar %* 
    ```

2.  设置全局 core.editor 变量

    该脚本已保存到 git/cmd 文件夹，因此它已经在 gitconsole 路径中。这是强制性的，因为完整路径可能无法正常工作。

    ```
    git config --global core.editor "git-editor.bat" 
    ```

现在我可以运行*git commit -a*和*git rebase -i master*命令。如果您在 Git Windows 工具中遇到问题，请尝试一下。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2013-06-10T13:01:15.550

我在多个平台上使用 Git，我喜欢在所有平台上使用相同的 Git 设置。（事实上​​，我所有的配置文件都在 Git 的发布控制之下，并在每台机器上放置了一个 Git 存储库克隆。）我想出的解决方案是这样的：

我将**编辑器**设置为**giteditor**

```
git config --global core.editor giteditor 
```

然后我在我的**PATH中创建一个名为****giteditor**的符号链接。（我有一个个人**bin**目录，但**PATH**中的任何位置都可以。）该链接指向我当前选择的编辑器。在不同的机器和不同的平台上，我使用不同的编辑器，所以这意味着我不必更改我的通用 Git 配置（**.gitconfig**），只需**更改 giteditor**指向的链接。

 ******符号链接由我所知道的每个操作系统处理，尽管它们可能使用不同的命令。对于 Linux，您使用**ln -s**。对于 Windows，您使用**cmd**内置**mklink**。它们有不同的语法（你应该查一下），但它们的工作方式都是一样的，真​​的。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2016-05-11T17:04:00.660

根据[VonC 的](https://stackoverflow.com/users/6309/vonc) [建议](https://stackoverflow.com/a/773973/6309)，这对我有用（让我发疯）：

```
git config --global core.editor "'C:/Program Files (x86)/Sublime Text 3/subl.exe' -wait" 
```

省略`-wait`可能会导致问题，尤其是当您使用[Gerrit](https://en.wikipedia.org/wiki/Gerrit_(software))并更改必须手动复制到提交消息底部的 ID 时。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-07-06T11:50:28.653

我在 Windows 上使用[Cygwin ，所以我使用：](http://en.wikipedia.org/wiki/Cygwin)

```
export EDITOR="emacs -nw" 
```

这`-nw`是为了`no-windows`，即告诉 Emacs 不要尝试使用[X Window](http://en.wikipedia.org/wiki/X_Window_System)。

Emacs 键绑定在 Windows shell 中对我不起作用，所以我只会在 Cygwin shell 中使用它...（推荐使用[rxvt](https://en.wikipedia.org/wiki/Rxvt)。）

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2010-09-29T08:51:54.683

这是我使用[Geany](http://www.geany.org/)作为 Git 编辑器的设置：

```
git config --global core.editor C:/path/to/geany.bat 
```

包含以下内容`geany.bat`：

```
#!/bin/sh
"C:\Program Files\Geany\bin\Geany.exe" --new-instance "$*" 
```

它可以在 DOS 控制台和 msysgit 中运行。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-08-14T01:57:55.007

我很难让 Git 与[WordPad](http://en.wikipedia.org/wiki/WordPad)、[Komodo Edit](https://en.wikipedia.org/wiki/Komodo_Edit)以及我给它的几乎所有其他编辑器合作。大多数打开编辑，但 Git 显然不会等待保存/关闭发生。

作为拐杖，我一直在做

```
git commit -m "Fixed the LoadAll method" 
```

保持事情的进展。它倾向于使我的提交消息比它们应该的要短一些，但显然在 Windows 版本的 Git 上还有一些工作要做。

GitGUI 也没有那么糟糕。它需要一点方向，但在那之后，它工作得相当好。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-03-12T19:27:28.013

如果路径中有空格，似乎 Git 找不到编辑器。因此，您必须将[帕特里克回答](https://stackoverflow.com/questions/10564/how-can-i-set-up-an-editor-to-work-with-git-on-windows/10625#10625)中提到的批处理文件放入非空白路径中。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2010-07-23T15:32:49.963

我更喜欢使用 Emacs。设置它可能有点棘手。

1.  下载 Emacs 并将其解压缩到`c:\emacs`.
2.  运行`c:\emacs\bin\addpm.exe`。如果您使用的是 Windows Vista 或更高版本，则需要右键单击并“以管理员身份运行”。这会将可执行文件放在您的路径中。
3.  在文件`(server-start)`中的某处添加。`.emacs`请参阅[Emacs Windows 常见问题解答](http://www.gnu.org/software/emacs/windows/Installing-Emacs.html#Installing-Emacs)以获取有关将`.emacs`文件放置在何处的建议。
4.  `git config --global core.editor emacsclientw`

Git 现在将在现有的 Emacs 进程中打开文件。您必须从`c:\emacs\bin\runemacs.exe`.

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-09-04T15:55:51.810

我刚刚遇到同样的问题并找到了不同的解决方案。我得到

```
error: There was a problem with the editor 'ec' 
```

我有`VISUAL=ec`，并且在我的路径上调用了一个批处理文件`ec.bat`，其中包含一行：

```
c:\emacs\emacs-23.1\bin\emacsclient.exe %* 
```

这让我可以从命令行编辑文件`ec <filename>`，并且`VISUAL`设置意味着大多数 unixy 程序也可以使用它。不过，Git 搜索路径的方式似乎与我的其他命令不同——当我查看[进程监视器](http://en.wikipedia.org/wiki/Process_Monitor)`git commit`时，我看到它在路径上的每个文件夹中查找 for和 for ，但不是 for 。我添加了另一个环境变量 ( )，一切都很好。`ec``ec.exe``ec.bat``GIT_EDITOR=ec.bat`

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2011-01-25T11:33:42.413

我设法通过使用引号和设置 EDITOR 变量来使环境版本正常工作`/`：

```
EDITOR="c:/Program Files (x86)/Notepad++/notepad++.exe" 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2015-02-07T19:08:25.430

我正在使用 GitHub for Windows，这是一个不错的视觉选择。但我也更喜欢命令行，所以当我在 Git shell 中打开存储库时，为了让它工作，我只需设置以下内容：

```
git config --global core.editor vim 
```

效果很好。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-08-01T02:48:22.913

这适用于 PowerShell 和[cmder](https://cmder.net/) 1.2（与 PowerShell 一起使用时）。在文件中`~/.gitconfig`：

```
[core]
    editor = 'c:/program files/sublime text 3/subl.exe' -w 
```

*[如何让 Sublime Text 成为 Git 的默认编辑器？](https://stackoverflow.com/questions/8951275/how-can-i-make-sublime-text-the-default-editor-for-git/9408117#9408117)*

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2015-10-27T12:42:33.827

[我在这里](https://danlimerick.wordpress.com/2014/01/07/git-for-windows-tip-opening-sublime-text-from-bash/ "这里")找到了一个非常简单的解决方案- 尽管您必须复制作者给出的“subl”文件的路径可能存在错误。

我正在运行 Windows 7 x64，我必须将“subl”文件放在我的`/Git/cmd/`文件夹中才能使其工作。

不过，它就像一个魅力。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2016-06-01T02:10:00.660

## Atom 和 Windows 10

1.  我右键单击桌面上的 Atom 图标，然后单击属性。

2.  复制了“开始于”位置路径

3.  用 Windows 资源管理器查看那里并找到“atom.exe”。

4.  我在 Git Bash 中输入了这个：

    ```
    git config --global core.editor C:/Users/YOURNAMEUSER/AppData/Local/atom/app-1.7.4/atom.exe" 
    ```

注意：我全部更改`\`为`/`. 我在我的主目录中创建了一个 .bashrc 并用于`/`设置我的主目录并且它有效，所以我认为`/`这将是要走的路。

[原子编辑器](/questions/tagged/atom-editor "显示标记为“原子编辑器”的问题") [git](/questions/tagged/git "显示标记为“git”的问题") [git-bash](/questions/tagged/git-bash "显示标记为“git-bash”的问题") [windows-10](/questions/tagged/windows-10 "显示标记为“windows-10”的问题")

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2020-12-18T10:49:47.150

添加崇高`git config --global core.editor "'C:\Program Files\Sublime Text 3\sublime_text.exe'"`

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2021-07-26T08:56:26.523

`GIT_EDITOR`我使用变量和`notepad2`编辑器解决了类似的问题。

解决方案 1：将环境变量设置`GIT_EDITOR`为`C:/tools/notepad2.exe`. 这很好用，但是如果提交消息包含非 ASCII 字符，git 会抱怨。

解决方案 2：设置`GIT_EDITOR`为`C:/tools/notepad2.exe //utf8`. 注意程序开关前面的双斜杠。顺便说一句：`-utf8`本来也可以。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2011-08-23T15:55:52.370

当使用远程安装的 homedrive（[Samba](http://en.wikipedia.org/wiki/Samba_%28software%29)共享、NFS、...）时，您的`~/.git`文件夹在所有系统之间共享，这可能会导致一些问题。因此，我更喜欢使用脚本来为正确的系统确定正确的编辑器：

```
#!/usr/bin/perl
# Detect which system I'm on and choose the right editor
$unamea = `uname -a`;
if($unamea =~ /mingw/i){
    if($unamea =~ /devsystem/i){#Check hostname
        exec('C:\Program Files (x86)\Notepad++\notepad++.exe', '-multiInst', '-nosession', @ARGV);
    }
    if($unamea =~ /testsystem/i){
        exec('C:\Program Files\Notepad++\notepad++.exe', '-multiInst', '-nosession', @ARGV);
    }
}
$MCEDIT=`which mcedit`;
if($MCEDIT =~ /mcedit/){
    exec($MCEDIT, @ARGV);
}
$NANO=`which nano`;
if($NANO =~ /nano/){
    exec($NANO, @ARGV);
}
die "You don't have a suitable editor!\n"; 
```

人们可能会考虑一个普通的 shell 脚本，但我使用的是 Perl，因为它是随 msysgit 一起提供的，而你的[类 Unix](https://en.wikipedia.org/wiki/Unix-like)系统通常也会提供一个。将脚本放入`/home/username/bin`，应将其添加到`PATH`in`.bashrc`或`.profile`. 添加后`git config --global core.editor giteditor.pl`，无论您身在何处，您都拥有合适的编辑器。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2012-10-15T16:22:43.187

这对我使用 Cygwin 和[TextPad](http://en.wikipedia.org/wiki/TextPad) 6 有效（编辑：只要您对脚本进行明显更改，它也适用于 TextPad 5），并且大概该模型也可用于其他编辑器：

文件`~/.gitconfig`：

```
[core]
    editor = ~/script/textpad.sh 
```

文件`~/script/textpad.sh`：

```
#!/bin/bash

APP_PATH=`cygpath "c:/program files (x86)/textpad 6/textpad.exe"`
FILE_PATH=`cygpath -w $1`

"$APP_PATH" -m "$FILE_PATH" 
```

这个单线也适用：

文件`~/script/textpad.sh`（选项 2）：

```
"`cygpath "c:/program files (x86)/textpad 6/textpad.exe"`" -m "`cygpath -w $1`" 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2014-01-15T02:00:05.043

这对我有用：

1.  将包含编辑器可执行文件的目录添加到***PATH***变量中。（例如*"C:\Program Files\Sublime Text 3\"*）
2.  重新启动计算机。
3.  *将core.editor*全局 Git 变量更改为**不带扩展名** *“.exe”*的编辑器可执行文件的名称（例如 git config --global core.editor sublime_text）

就是这样！

**注意：** [Sublime Text](http://en.wikipedia.org/wiki/Sublime_Text) 3 是我在这个例子中使用的编辑器。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2016-12-24T17:19:55.300

这是 Cygwin 的解决方案：

```
#!/bin/dash -e
if [ "$1" ]
then k=$(cygpath -w "$1")
elif [ "$#" != 0 ]
then k=
fi
Notepad2 ${k+"$k"} 
```

1.  如果没有路径，则不传递路径

2.  如果路径为空，则传递空路径

3.  如果路径不为空，则转换为 Windows 格式。

然后我设置这些变量：

```
export EDITOR=notepad2.sh
export GIT_EDITOR='dash /usr/local/bin/notepad2.sh' 
```

1.  EDITOR 允许脚本与 Git 一起工作

2.  GIT_EDITOR 允许脚本使用[Hub 命令](//hub.github.com)

[来源](//github.com/svnpenn/dotfiles/tree/2973070/editor)

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2020-05-23T05:09:48.327

> 那些在 Windows 上使用 Git 的人：你用什么工具来编辑你的提交消息，你必须做什么才能让它工作？

我发现在 Windows*和*Linux中作为*git 编辑器**和**通用代码编辑器最有用的工具是*[Sublime Text 3](https://www.sublimetext.com/)。它工作得非常好，但需要一些设置才能让它恰到好处，所以我在这里完整地记录了这一点：

 **   [如何让 Git 使用我选择的编辑器进行提交？- Sublime Text 3 作为 Git 编辑器的最佳设置（Windows 和 Linux 说明）](https://stackoverflow.com/questions/2596805/how-do-i-make-git-use-the-editor-of-my-choice-for-commits/48212377#48212377)

关于我的主编辑器的旁注：对于大型项目，我使用 Eclipse 作为我的主编辑器，并使用 Sublime Text 3 作为我的 git 编辑器和附加文件编辑器，当我需要使用它的高级功能时，例如多光标模式、垂直/列选择模式等。对于中小型项目，我只使用 Sublime Text 3。有关 Eclipse 的设置说明，请[在此处查看我的 PDF 文档](https://github.com/ElectricRCAircraftGuy/eRCaGuy_dotfiles/blob/master/eclipse/Eclipse%20setup%20instructions%20on%20a%20new%20Linux%20(or%20other%20OS)%20computer.pdf)。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2022-02-20T08:47:14.200

假设您想将*VsCode*配置为您的编辑器。请执行下列操作：

## 将以下行添加到您的`.gitconfig`文件中：

> 文件的默认位置`.gitconfig`是`C:\Users\USER_NAME\.gitconfig`

```
[core]
  editor = code -w -n
[diff]
  tool = vscode
[difftool "vscode"]
  cmd = code -w -n --diff $LOCAL $REMOTE
[merge]
  tool = vscode
[mergetool "vscode"]
  cmd = code -w -n $MERGED 
```

> 笔记：
> 
> *   `-w`是强制性的，并告诉`git`等待*vscode*加载。
> *   `-n`是可选的，并告诉在新窗口`git`中打开*vscode 。*

### 如果您想在 Windows 中配置编辑器的自定义路径：

您需要将单词替换`code`为*VsCode 的“.exe”路径*。

例如：

```
[core]
  editor = "'C:/Users/Tal/AppData/Local/Programs/Microsoft VS Code/Code.exe'" -w -n
[diff]
  tool = vscode
[difftool "vscode"]
  cmd = "'C:/Users/Tal/AppData/Local/Programs/Microsoft VS Code/Code.exe'" -w -n --diff $LOCAL $REMOTE
[merge]
  tool = vscode
[mergetool "vscode"]
  cmd = "'C:/Users/Tal/AppData/Local/Programs/Microsoft VS Code/Code.exe'" -w -n $MERGED 
```

> 笔记：
> 
> *   您需要用*单引号* `''`将路径括起来。
> *   路径中的斜杠应该是*正斜杠* `/`。

或者另一个例子：

```
[core]
    editor = \"C:\\Users\\Tal\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe\" -w -n

[diff]
    tool = vscode
[difftool "vscode"]
    cmd = \"C:\\Users\\Tal\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe\" -w -n --diff $LOCAL $REMOTE

[merge]
    tool = vscode
[mergetool "vscode"]
    cmd = \"C:\\Users\\Tal\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe\" -w -n $MERGED 
```

* * *

## 回答 #36

> 赞同：-1
> 
> 时间：2012-06-10T12:13:32.797

我只是直接使用[TortoiseGit](http://en.wikipedia.org/wiki/TortoiseGit)。它与我的[PuTTY](http://en.wikipedia.org/wiki/PuTTY)公钥完美地集成在一起。

它有一个完美的提交消息编辑器。*******

# voip - 您的交互式语音响应平台是什么？

> ID：10575
> 
> 赞同：4
> 
> 时间：2008-08-14T02:01:02.253
> 
> 标签：voip, voice, telephony, ivr

对于那些在语音领域工作的人，您使用什么作为 IVR 平台？我正在使用 Microsoft Speech Server 2007。有哪些等效软件包？是否有人使用开源软件来处理呼入或呼出电话？请注意，我不只是在谈论语音识别，它是一个综合包的一个组成部分。IVR 平台将包括语音识别、文本到语音、VUI 技术（如 VoiceXML）以及通过 SIP 或电话硬件的呼叫终止。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T01:55:18.863

我已经成功地用 Lumenvox 尝试了 Asterisk 的语音识别 IVR。Asterisk 在 IVR 方面非常灵活，不仅如此。借助 Digium 和其他供应商（Sangoma、Rhino、 ETC）。[您可以在http://www.voip-info.org/wiki/view/Asterisk](http://www.voip-info.org/wiki/view/Asterisk)找到有关 Asterisk 的更多信息

Asterisk 是一个开源软件 PBX，主要在 Linux 上运行。 [http://www.asterisk.org/](http://www.asterisk.org/)

Lumenvox 语音引擎是一个商业语音识别解决方案 [http://www.lumenvox.com/](http://www.lumenvox.com/)

Digium、Sangoma 和 Rhino 是与 Asterisk 兼容的电话卡制造商。 [http://www.digium.com/](http://www.digium.com/) [http://www.sangoma.com/](http://www.sangoma.com/) [http://www.rhinoequipment.com/](http://www.rhinoequipment.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-15T18:58:03.710

在 envox.com 上试用 Envox studio 7

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-03T02:44:04.653

我相信[Nuance](http://www.nuance.com)（最近与 VoiceGenie 合并）是领先的 IVR 平台，在行业中比微软的语音服务器更具吸引力。您可以阅读更多关于它的[wiki 文章](http://en.wikipedia.org/wiki/Nuance_Communications)。

如果听起来不像推销员，我不知道该怎么说，但我使用它工作了几年并且很享受它。我的公司当时评估了 Microsoft 的产品，但认为它不够成熟，无法考虑放弃 Nuance / VoiceGenie 产品。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-15T18:45:09.950

从商业角度来看，您可能希望查看[Genesys](http://www.genesyslab.com/)。相比之下，我不确定它如何与其他商业解决方案相媲美，但我的公司自 2005 年以来一直在成功使用它并取得了很好的效果。虽然我主要从事 IVR 方面的实施工作，但该系统往往非常稳定且相对容易维护。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T18:03:16.690

我看过或合作过的主要参与者有几位：

**Voxeo**：早期版本使用 Nuance ASR，但我相信他们现在使用自己的。使用 VoiceXML 和 CCXML 进行呼叫控制。当您扩大规模时，它们会变得昂贵，但开发许可证（2 个端口）是免费的。

**Loquendo**：我只列出这个是因为 a) 我做了演示 b) 他们拥有我听过的最好的 TTS 引擎。真的值得一个演示只是为了听到质量。

**Nuance Voice Platform (NVP)**：我几乎每天都在使用它。Nuance 拥有迄今为止市场上最强大的 ASR，但它的价格很高。如果您必须询问价格，请不要费心爱上发动机的质量。它使用稍微调整过的 VoiceXML 版本。

**Microsoft Speech Server**：您当然已经知道这一点。物有所值，这是一个很棒的平台。VoiceXML 支持是临界的（从 VXML 属性对引擎的有限控制），但如果您愿意使用 Workflows，您可以做任何您想做的事情。ASR 很好，尽管它与 Nuance 等大型或复杂语法的准确性不相上下。这是目前我对大多数应用程序的首选平台。和 Voxeo 一样，开发者许可证是免费的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-15T11:50:43.280

我不是语音工程师，但我们的 SME 绝对喜欢[Pactolus](http://www.pactolus.com/)的产品。我看着他在其他产品上经历了几年的痛苦，他现在对他构建的基于 Pactolus 的解决方案非常非常满意。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T01:24:20.607

Dialogic 和 Gridborg (Uniqall) 都有出色的表现。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-12T13:06:45.990

我已经使用[Voxeo](http://www.voxeo.com/)有一段时间了。这很棒。他们拥有*出色的*技术支持和功能齐全的 2 行模拟账户。即使您有免费帐户，他们也有非常好的调试工具和免费支持。他们所有的员工都知道并理解 VoiceXML。强烈推荐。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-24T13:02:30.880

取决于您是在自助服务市场还是呼叫中心头部路由市场。

对于自主应用程序，您可以试用 Genesys Stack。他们为您自己的插件提供了一个很好的解决方案，其中包含一堆 BYOB 选项。适用于大量基于交易的金融服务应用程序。

如果您面向呼叫中心并且拥有 Cisco 堆栈的一部分，您可以尝试他们的 IPCC 解决方案，该解决方案与傻瓜式 UI 屏幕配合良好。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-19T10:57:29.820

我们目前正在构建一个视频 ivr 并且已经尝试了一堆平台。

*   **Genesys** - 少数支持视频的公司之一。由于糟糕的视频支持、繁琐的 Web 管理和整体复杂性，我对这个平台不满意。
*   **Voxpilot** - 也是一个支持视频的，到目前为止性能比 Genesys 更好。您可以下载免费试用版，以及一些演示视频 IVR 功能的优秀 VoiceXML 示例
*   **Voxeo** - 刚刚演示，仅适用于 IVR（没有像genesys 和 voxpilot 这样的 IVVR）

*   **Nuance** - ASR 和 TTS 非常好

*   **Speechwork 和 Scansoft** - 我猜它们合并了（不太确定）。这是一个不错的 TTS 和 ASR 服务器

*   **Asterisk** - 可以用一些扩展来做 IVR 和 IVVR，但我们用它来管理呼叫。一个很棒的软件。

我还没有找到满足我们所有需求的好的 IVVR 平台。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-28T21:23:46.407

我会推荐 Katalina 'VoiceGuide' - 一个基于 Windows 的 CTI、IVR 和拨号系统，价格合理，支持传统的 POTS/ISDN 电话卡和 VoIP。见：www.voiceguide.com

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-08-14T08:57:21.320

您可以查看[Asterisk](http://www.asterisk.org/)以获取开源解决方案。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-26T19:32:38.210

我之前使用 Telesage 进行了数十万次交互式调查。这是一款不错的软件，我们的支持也很好，但他们的系统并不是为我们的工作类型而设计的。

我们涉足星号。

对于我的下一个项目，我打算使用托管的 Twilio ( [http://www.twilio.com/](http://www.twilio.com/) )

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-05-04T09:20:32.243

试试 Envox。即使是刚出生的婴儿也可以用它开发 IVR 应用程序。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2010-10-18T16:38:05.507

在我的工作地点，我们曾经使用 Genesys，但我们改用 Nortel 来提供 CTI 和 TAPI，并改用 IBM WebSphere Voice Response 来提供用户体验。我还没有为其他平台开发 IVR 的东西，所以我不能说这个平台是否比其他平台更好，但我可以说我们的 IVR 接到了大量的电话，而且它坚如磐石。

# binding - 早期绑定和后期绑定有什么区别？

> ID：10580
> 
> 赞同：95
> 
> 时间：2008-08-14T02:10:53.873
> 
> 标签：binding, dynamic-binding, static-binding

早期绑定和后期绑定有什么区别？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-08-14T02:24:04.047

简短的回答是，早期（或静态）绑定是指编译时绑定，后期（或动态）绑定是指运行时绑定（例如，当您使用反射时）。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-08-14T02:16:42.283

在编译语言中，差异是明显的。

爪哇：

```
//early binding:
public create_a_foo(*args) {
 return new Foo(args)
}
my_foo = create_a_foo();

//late binding:
public create_something(Class klass, *args) {
  klass.new_instance(args)
}
my_foo = create_something(Foo); 
```

在第一个示例中，编译器可以在编译时执行各种简洁的操作。其次，您只需要希望使用该方法的人负责任地这样做。（当然，较新的 JVM 支持这种`Class<? extends Foo> klass`结构，可以大大降低这种风险。）

另一个好处是 IDE 可以热链接到类定义，因为它是在方法中声明的。对 create_something(Foo) 的调用可能与方法定义相距*甚*远，如果您正在查看方法定义，可能会很高兴看到实现。

后期绑定的主要优点是它使控制反转之类的事情变得更容易，以及多态性和鸭子类型的某些其他用途（如果您的语言支持这样的事情）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-05-23T00:37:47.047

Herbert Schildt C++ 书中类似但更详细的答案：-

早期绑定是指在编译时发生的事件。本质上，当调用函数所需的所有信息在编译时已知时，就会发生早期绑定。（换句话说，早期绑定意味着在编译期间绑定对象和函数调用。）早期绑定的示例包括普通函数调用（包括标准库函数）、重载函数调用和重载运算符。早期绑定的主要优点是效率。因为调用函数所需的所有信息都是在编译时确定的，所以这些类型的函数调用非常快。

早期绑定的反面是后期绑定。后期绑定是指直到运行时才解析的函数调用。虚函数用于实现后期绑定。如您所知，当通过基指针或引用访问时，实际调用的虚函数由指针指向的对象类型决定。因为在大多数情况下，这在编译时无法确定，所以对象和函数直到运行时才链接。后期绑定的主要优点是灵活性。与早期绑定不同，后期绑定允许您创建可以响应程序执行时发生的事件的程序，而无需创建大量“应急代码”。请记住，由于直到运行时才解析函数调用，所以后期绑定可能会使执行时间变慢。然而今天，

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-08-14T02:16:32.660

直接取自[http://word.mvps.org/fAQs/InterDev/EarlyvsLateBinding.htm](http://word.mvps.org/fAQs/InterDev/EarlyvsLateBinding.htm)

> 有两种方法可以使用自动化（或 OLE 自动化）以编程方式控制另一个应用程序。
> 
> 后期绑定使用 CreateObject 创建应用程序对象的实例，然后您可以对其进行控制。例如，要使用后期绑定创建新的 Excel 实例：
> 
> ```
>  Dim oXL As Object
>  Set oXL = CreateObject("Excel.Application") 
> ```
> 
> 另一方面，要操作现有的 Excel 实例（如果 Excel 已打开），您将使用 GetObject（无论您使用的是早期绑定还是后期绑定）：
> 
> ```
>  Dim oXL As Object
>  Set oXL = GetObject(, "Excel.Application") 
> ```
> 
> 要使用早期绑定，首先需要在项目中设置对要操作的应用程序的引用。在任何 Office 应用程序的 VB 编辑器中，或在 VB 本身中，您可以通过选择工具 + 参考，然后从列表中选择所需的应用程序（例如“Microsoft Excel 8.0 对象库”）来执行此操作。
> 
> 要使用早期绑定创建新的 Excel 实例：
> 
> ```
>  Dim oXL As Excel.Application
>  Set oXL = New Excel.Application 
> ```
> 
> 在这两种情况下，顺便说一句，您可以先尝试获取现有的 Excel 实例，如果返回错误，您可以在错误处理程序中创建一个新实例。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-08-14T02:21:56.207

在解释型语言中，差异要微妙一些。

红宝石：

```
# early binding:
def create_a_foo(*args)
  Foo.new(*args)
end
my_foo = create_a_foo

# late binding:
def create_something(klass, *args)
  klass.new(*args)
end
my_foo = create_something(Foo) 
```

因为 Ruby（通常）没有被编译，所以没有编译器来做漂亮的前期工作。JRuby 的发展意味着现在编译了更多的 Ruby，这使得它更像上面的 Java。

IDE 的问题仍然存在：如果您对类定义进行硬编码，像 Eclipse 这样的平台可以查找类定义，但如果将它们留给调用者则不能。

控制反转在 Ruby 中并不是很流行，可能是因为它具有极高的运行时灵活性，但 Rails 充分利用后期绑定来减少启动应用程序所需的配置量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-21T22:46:00.443

```
public class child()
{    public void method1()
     {     System.out.println("child1");
     }
    public void method2()
     {     System.out.println("child2");
     }

}
public class teenager extends child()
{    public void method3()
     {      System.out.println("teenager3");
     }
}
public class adult extends teenager()
{     
    public void method1()
    {    System.out.println("adult1);
         super.method1();
     }
}

//In java
public static void main(String []args)
{    ((teenager)var).method1();
} 
```

这将打印出来

```
adult1
child1 
```

在早期绑定中，编译器将可以访问 child 和 Teen 中的所有方法，但在后期绑定中（在运行时），它将检查在运行时被覆盖的方法。

因此，method1（来自child - 早期绑定）将在运行时被成人的method1覆盖（后期绑定）然后它将从child实现method1，因为在青少年的method1中没有method1。

请注意，如果 child 没有 method1，则 main 中的代码将无法编译。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-15T03:34:34.163

当我们具有相同的方法名称但行为不同时，编译时多态性也称为重载或早期绑定或静态绑定。通过实现相同方法的多个原型，其中会发生不同的行为。早期绑定是指程序的第一次编译。但是在后期绑定对象是运行时发生在程序中。也称为动态绑定或覆盖或运行时多态性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-02-18T15:13:23.970

java中最简单的例子：

早期（静态或重载）绑定：

```
public class Duck {
    public static void quack(){
        System.out.println("Quack");
    }
}

public class RubberDuck extends Duck {
    public static void quack(){
        System.out.println("Piiiiiiiiii");
    }
}

public class EarlyTest {
    public static void main(String[] args) {
        Duck duck = new Duck();
        Duck rubberduck = new RubberDuck();

        duck.quack();
        rubberduck.quack(); //early binding - compile time
    }
} 
```

结果是：

```
Quack
Quack 
```

而对于后期（动态或覆盖）绑定：

```
public class Duck {
    public void quack(){
        System.out.println("Quack");
    }
}

public class RubberDuck extends Duck {
    public void quack(){
        System.out.println("Piiiiiiiiii");
    }
}

public class LateTest {
    public static void main(String[] args){
        Duck duck = new Duck();
        Duck rubberduck = new RubberDuck();

        duck.quack();
        rubberduck.quack(); //late binding - runtime
    }
} 
```

结果是：

```
Quack
Piiiiiiiiii 
```

早期绑定发生在编译时，而后期绑定发生在运行时。

# java - 使用 StAX 对 XML 文档进行小修改

> ID：10586
> 
> 赞同：6
> 
> 时间：2008-08-14T02:22:37.920
> 
> 标签：java, xml, stax

我目前正在尝试读取 XML 文件，进行一些小的更改（更改某些属性的值），然后再次将其写回。

我打算使用 StAX`javax.xml.stream.XMLStreamReader`解析器`javax.xml.stream.XMLStreamReader`（

不幸的是，这看起来并不那么简单——编写者没有办法获取事件类型和解析器对象，只有像`writeAttribute`和这样的方法`writeStartElement`。显然，我可以为 XML 文档中可能出现的每种可能类型的元素编写一个带有 case 的大 switch 语句，然后再次将其写回，但对于看起来应该很简单的事情来说，这似乎很麻烦.

有没有什么我遗漏的东西可以很容易地写出一个与你用 StAX 读到的非常相似的 XML 文档？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-08-14T04:13:24.717

经过一番折腾，答案似乎是使用事件读取器/写入器版本而不是流版本。

（即 javax.xml.stream.XMLEventReader 和 javax.xml.stream.XMLEventWriter）

另请参阅[http://www.devx.com/tips/Tip/37795](http://www.devx.com/tips/Tip/37795)，这最终让我感动。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-08-14T05:52:27.730

StAX 运行良好且速度非常快。我在一个项目中使用它来解析最大 20MB 的 XML 文件。我没有彻底的分析，但它肯定比 SAX 快。

至于您的问题：流媒体和事件处理之间的区别，AFAIK 是控制。使用流式 API，您可以逐步浏览文档并获取所需的内容。而基于事件的 API 您只能处理您感兴趣的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-10T20:12:44.567

我知道这是一个相当老的问题，但如果其他人正在寻找这样的东西，还有另一种选择：Woodstox Stax2 扩展 API 有方法：

```
XMLStreamWriter2.copyEventFromReader(XMLStreamReader2 r, boolean preserveEventData) 
```

它使用流写入器从流读取器复制当前指向的事件。这不仅简单而且非常有效。我已经成功地将它用于类似的修改。

（如何获得 XMLStreamWriter2 等？所有 Woodstox 提供的实例都实现了这些扩展版本——另外还有包装器，以防有人也想使用“基本”Stax 变体）

# ruby - 我如何编写那些很酷的命令行代码生成器（rails、sproutcore、webgen）

> ID：10595
> 
> 赞同：0
> 
> 时间：2008-08-14T02:39:38.917
> 
> 标签：ruby

我已经了解了所有上述应用程序的代码，但我仍然找不到从单个命令创建静态目录结构的直接方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-08-15T04:24:56.700

检查[rubigen](http://rubigen.rubyforge.org)。您还可以查看 dr nic 的[演示文稿](http://rubyconf2007.confreaks.com/d3t1p1_rubigen.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-08-14T03:08:02.073

那么你想要的是能够发出一个将生成整个目录树的命令？

```
cp -r <template> <destination> 
```

还是我误会了？如果要生成一致的目录结构，最好的办法是简单地从模板中复制它。快速，简单，完成。

# webpage - 网页字段验证

> ID：10599
> 
> 赞同：2
> 
> 时间：2008-08-14T02:50:26.210
> 
> 标签：webpage

我需要验证网页上的日期/时间字段，但希望它在不重新加载页面的情况下执行此操作，并希望为用户提供“即时”反馈。

什么是最好/最简单的解决方案。顺便说一句：最简单的分数占总分的 65%

编辑：如果最好是总分的 65% 怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-08-14T03:16:44.863

如果您想使用 JavaScript，那么它内置了日期验证功能。但是，如果您不想走 JavaScript 路线，您可以将 UI 更改为下拉控件，这将限制用户输入无效数据的能力。您仍然需要检查服务器端以确保没有人在 2 月 30 日提交。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-08-14T02:56:56.913

查看这个[javascript 日期验证](http://www.expertsrt.com/scripts/Rod/validate_date.php)功能。

它使用 javascript、正则表达式和文本输入的“onblur”事件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-08-15T10:47:34.683

@大卫·H·奥斯特

使用 onblur 进行验证是有问题的，因为有些人使用回车键而不是鼠标来提交表单。结合使用 onblur 和表单的 onsubmit 事件可能是一个更好的解决方案。当我对表单进行更多的 JS 验证时，我会针对 keyup 事件运行。这为用户提供了关于他们的输入是否正确的即时反馈。您可以（我也这样做了）也可以进行检查，以便用户在离开该字段之前不会收到“不正确”的消息（因为如果他们没有完成，您不应该告诉他们他们不正确然而）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-08-14T18:39:28.490

如上所述，我建议使用下拉列表来显示日期。我真的想不出任何不这样做的理由——你希望用户从预定义的数据中进行选择，而不是给你一些你无法预料的独特的东西。

您可以使用一点 Javascript 来避免 2 月 30 日（使日期字段根据月份动态填充）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-08-18T03:54:16.143

@Brian Warshaw
关于不要忘记通过键盘导航的用户（呃，我），这是一个非常好的观点。

感谢您引起我们的注意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-08-14T03:03:22.033

一个简单的 javascript 方法，它读取提交时输入字段中的内容并对其进行验证。如果它无效，则返回 false 以便表单不会提交到服务器。

```
... onSubmit="return validateForm();" ... 
```

确保您也在服务器端进行验证，很容易绕过 javascript 验证。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-08-14T03:18:31.363

如果您使用的是 ASP.NET，它具有验证器控件，您可以指向文本框，然后可以使用这些文本框来验证正确的日期/时间格式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-08-14T08:48:50.027

以太中有几个日期小部件可用。然后你可以只允许有效的输入。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-08-14T18:33:33.213

看起来有一个很棒的视频，关于 ASP.NET AJAX 控件工具包提供了很好的 MaskedEdit 控件和 MaskedEditValidator 控件。对于初学者来说并不容易，但非常好的即时反馈。

感谢所有的答案！

[网](http://www.asp.net/learn/ajax-videos/video-131.aspx)

~~不幸的是我不能接受这个答案~~。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-08-18T15:54:06.627

我已经在几个项目中使用了这一小段 js 代码，它会与其他一些项目一起快速轻松地进行约会。

[关联](http://tetlaw.id.au/view/javascript/really-easy-field-validation/)

# sql-server - 自动测量所有 SQL 查询

> ID：10604
> 
> 赞同：5
> 
> 时间：2008-08-14T02:57:18.507
> 
> 标签：sql-server, optimization

在[Maybe Normalizing Is Not Normal](http://www.codinghorror.com/blog/archives/001152.html)中，Jeff Atwood 说：“您正在自动测量流经您的软件的所有查询，对吗？” 我不是，但我愿意。

相关应用程序的一些功能：

*   ASP.NET
*   依赖于[MS 企业库数据访问应用程序块的数据访问层](http://msdn.microsoft.com/en-us/library/cc309504.aspx)
*   微软 SQL 服务器

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-08-14T03:13:56.770

除了 Brad 提到的 SQL Profiler 之外，如果您想在代码中执行此操作，那么**您的所有数据库调用都需要通过一个公共库进行汇集**。您在那里插入计时代码，瞧，您知道系统中的每个查询需要多长时间。

单一的数据库入口点是任何 ORM 或数据库层的一个相当标准的特性——或者至少它已经出现在我迄今为止从事的任何项目中！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-08-14T03:00:29.997

[SQL Profiler](http://msdn.microsoft.com/en-us/library/ms181091.aspx)是我用来监控流向我的 SQL Server 的流量的工具。它允许您收集有关 SQL Server 的详细数据。SQL Profiler 至少从 SQL Server 2000 开始就与 SQL Server 一起分发（但也可能在此之前）。

强烈推荐。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-14T07:23:00.933

看看这一章 Jeff Atwood 和我写的关于网站性能优化的文章。我们涵盖了很多内容，但也有很多关于数据库跟踪和优化的内容： [加速您的网站：8 个 ASP.NET 性能技巧](http://www.sitepoint.com/article/aspnet-performance-tips)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-08-14T03:54:38.873

CodePlex 上的[Dropthings](http://www.codeplex.com/dropthings)项目有一个用于计时代码块的类。该类名为 TimedLog。它实现了 IDisposable。您将希望计时的代码块包装在 using 语句中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-14T05:00:51.767

如果您使用 Rails，它会自动在您的开发日志文件中记录所有 SQL 查询以及它们执行所花费的时间。

我发现这非常有用，因为如果您确实看到需要一段时间的内容，只需将其直接复制并粘贴到屏幕/日志文件中，然后在 mysql 中将“解释”放在其前面即可。

你不必去挖掘你的代码并重建正在发生的事情。

不用说这在生产中不会发生，因为它会在大约一个小时内耗尽您的磁盘空间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T11:56:44.413

如果您定义了一个为您创建 SqlCommands 的工厂，并且在您需要新命令时始终调用它，您可以将[RealProxy](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.proxies.realproxy.aspx)返回给 SqlCommand。

然后，该代理可以使用 StopWatch 测量 ExecuteReader / ExecuteScalar 等需要多长时间并将其记录在某处。使用这种方法优于 Sql Server Profiler 的优点是您可以获得每个执行的 SQL 片段的完整堆栈跟踪。

# regex - 预建的正则表达式模式或正则表达式库？

> ID：10610
> 
> 赞同：7
> 
> 时间：2008-08-14T03:04:16.977
> 
> 标签：regex

有没有人使用有一个他们喜欢使用的好的正则表达式库？您在网上找到的大多数正则表达式要么包含错误，要么过于关注边缘情况，以至于它变成了 100% 验证任何规范的竞争。当然你可以自己写，但是当你按小时计费时，周围有一个图书馆很方便。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-08-14T03:15:59.980

升压，对于 C++

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-08-14T03:53:27.237

[您可以在regexlib](http://regexlib.com/)中搜索正则表达式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-08-14T03:10:22.660

除了几乎是市场上最好的正则表达式工具（说真的），RegexBuddy 是我所知道的唯一一个可以让你在不同的正则表达式渲染引擎之间切换的工具。

[http://www.regexbuddy.com/](http://www.regexbuddy.com/)

在此处查看信息：

[http://en.wikipedia.org/wiki/RegexBuddy](http://en.wikipedia.org/wiki/RegexBuddy)

> RegexBuddy 的专有正则表达式引擎允许该软件模拟许多流行的正则表达式风格的规则和限制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-08-14T03:25:26.263

最近，我在 Perl 中进行所有文本解析。如果我需要另一种语言的正则表达式，我会选择[PCRE](http://www.pcre.org/)。

> PCRE 库是一组使用与 Perl 5 相同的语法和语义实现正则表达式模式匹配的函数。PCRE 有自己的原生 API，以及一组对应于 POSIX 正则表达式 API 的包装函数。PCRE 库是免费的，即使用于构建商业软件。
> 
> PCRE 最初是为 [Exim MTA](http://www.exim.org/)编写的，但现在被许多知名开源项目使用，包括 [Apache](http://httpd.apache.org/)、 [PHP](http://www.php.net/)、 [KDE](http://www.kde.org/)、 [Postfix](http://www.postfix.org/)、 [Analog](http://www.analog.cx/)和 [Nmap](http://nmap.org/)。PCRE 还进入了一些知名的商业产品，例如 [Apple Safari](http://www.apple.com/safari/)。其他一些使用 PCRE 的有趣项目包括 [Chicken](http://www.call-with-current-continuation.org/)、 [Ferite](http://www.ferite.org/)、 [Onyx](http://www.canonware.com/onyx/)、 [Hypermail](http://www.hypermail.org/)、 [Leafnode](http://leafnode.sourceforge.net/)、 [Assemos](http://www.askemos.org/)和[Wenlin](http://www.wenlin.com/)。

PCRE是成熟的，得到了​​众多项目的支持。Apache 和 Apple 都对使其成为高质量有既得利益。我怀疑任何其他 RE 库都可能很快在功能和质量（或可能两者之一）上超越它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-31T09:37:53.927

提供常用正则表达式的一个很好的来源是 Perl 的[Regexp::Common](https://metacpan.org/pod/Regexp::Common)。

目前提供以下模式（来自主页）：

```
Regexp::Common::balanced
Provides regexes for strings with balanced parenthesized delimiters.

Regexp::Common::comment
Provides regexes for comments of various languages (43 languages currently).

Regexp::Common::delimited
Provides regexes for delimited strings.

Regexp::Common::lingua
Provides regexes for palindromes.

Regexp::Common::list
Provides regexes for lists.

Regexp::Common::net
Provides regexes for IPv4 addresses and MAC addresses.

Regexp::Common::number
Provides regexes for numbers (integers and reals).

Regexp::Common::profanity
Provides regexes for profanity.

Regexp::Common::whitespace
Provides regexes for leading and trailing whitespace.

Regexp::Common::zip
Provides regexes for zip codes. 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-08-14T05:03:34.303

e-texteditor 会在您键入时突出显示您正在搜索的内容。这非常有用，因为您可以将“示例文本”粘贴到文件中，然后在搜索字段中输入您的正则表达式，然后在您面前查看匹配的内容。

这些“视觉正则表达式构建器”都不能替代实际学习正则表达式。

# mysql - MySQL 和 SQL Server 的区别

> ID：10616
> 
> 赞同：147
> 
> 时间：2008-08-14T03:13:26.633
> 
> 标签：mysql, sql-server, tsql

我是一名[ASP.NET](http://en.wikipedia.org/wiki/ASP.NET)开发人员，他已经使用`Microsoft SQL Server`了我所有的数据库需求（无论是在工作中还是个人项目中）。

我正在考虑为我的一些个人项目尝试[LAMP堆栈。](http://en.wikipedia.org/wiki/LAMP_%28software_bundle%29)

`MySQL`和之间的主要区别是`SQL Server`什么？使用[存储过程](http://en.wikipedia.org/wiki/Stored_procedure)是一种常见的做法`MySQL`吗？

您有什么建议或资源可以帮助我进行转换吗？

对于两者都有经验的人，是否缺少任何功能`MySQL`？

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2008-08-14T03:17:18.153

您必须注意的一件事是 SQL Server 和 MySQL 实现 SQL 语法的方式存在相当严重的差异。

这是不同 SQL 实现的一个很好的[比较](http://troels.arvin.dk/db/rdbms/)。

例如，看一下 top-n 部分。在 MySQL 中：

```
SELECT age
FROM person
ORDER BY age ASC
LIMIT 1 OFFSET 2 
```

在 SQL Server (T-SQL) 中：

```
SELECT TOP 3 WITH TIES *
FROM person
ORDER BY age ASC 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2010-09-01T07:41:14.790

这里的很多评论听起来更像是宗教论点，而不是现实生活中的陈述。我已经使用 MySQL 和 MSSQL 多年，它们都是很好的产品。我会主要根据您正在使用的环境选择 MySQL。大多数开源项目都使用 MySQL，所以如果你朝这个方向发展，MySQL 是你的选择。如果您使用 .Net 开发一些东西，我会选择 MSSQL，不是因为它更好，而是因为这是大多数人使用的。我实际上目前正在使用带有 MySQL 和 C# 的 ASP.NET 的项目。它工作得很好。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-10-12T19:18:08.190

我不敢相信没有人提到 MySQL 不支持 Common Table Expressions (CTE) / "with" 语句。这是一个非常烦人的区别。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-08-20T16:28:51.663

MySQL 更有可能出现数据库损坏问题，并且当它们发生时它不会自动修复它们。我从 6.5 版开始使用 MSSQL，不记得数据库损坏问题导致数据库脱机。有几次我在生产环境中使用 MySQL，数据库损坏问题导致整个数据库脱机，直到我们从命令行运行神奇的“请修复我损坏的索引”。

根据我的经验，MSSQL 的事务和日志系统几乎可以处理任何事情——包括电源循环或硬件故障——而不会损坏数据库，如果出现问题，它会自动修复。

这是我的经验，我很高兴听到这个问题已经解决或者我们做错了什么。

[http://dev.mysql.com/doc/refman/6.0/en/corrupted-myisam-tables.html](http://dev.mysql.com/doc/refman/6.0/en/corrupted-myisam-tables.html)

[http://www.google.com/search?q=site%3Abugs.mysql.com+index+corruption](http://www.google.com/search?q=site%3Abugs.mysql.com+index+corruption)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-09T04:51:26.853

坦率地说，我找不到使用 MySQL 而不是 MSSQL 的单一理由。以前的问题是成本，但 SQL Server 2005 Express 是免费的，并且有许多网络托管公司提供完整的 sql server 托管服务，每月不到 5.00 美元。

MSSQL 更易于使用，并且具有 MySQL 中不存在的许多功能。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-23T21:11:29.147

MySQL 中的一切似乎都比 MSSQL 更接近于金属，并且文档是这样处理的。特别是对于优化，您需要了解索引、系统配置和优化器在各种情况下如何交互。

“优化器”更像是一个解析器。在 MSSQL 中，您的查询计划通常是一个惊喜（通常是好的，有时不是）。在 MySQL 中，它几乎按照您期望的方式执行您要求它执行的操作。这意味着您自己需要对可能完成的各种方式有深入的了解。

不是围绕良好的 TRANSACTION 模型（默认 MyISAM 引擎）构建的。

文件系统设置是您的问题。

所有的数据库配置都是你的问题——尤其是各种缓存大小。

有时最好将其视为临时的、美化的伊萨姆。Codd 和 Date 在这里没有太大的分量。他们会毫不尴尬地说出来。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-08-14T03:20:06.040

我认为需要注意的主要事情之一是 MySQL 5.0 之前的版本没有视图、触发器和存储过程。

更多内容在[MySQL 5.0 下载页面](http://dev.mysql.com/downloads/mysql/5.0.html#downloads)中进行了解释。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-09T05:22:28.587

@abdu

我发现 MySQL 对 MSSQL 的主要支持是时区支持 - 能够在时区之间很好地更改，尊重夏令时非常棒。

比较一下：

```
mysql> SELECT CONVERT_TZ('2008-04-01 12:00:00', 'UTC', 'America/Los_Angeles');
+-----------------------------------------------------------------+
| CONVERT_TZ('2008-04-01 12:00:00', 'UTC', 'America/Los_Angeles') |
+-----------------------------------------------------------------+
| 2008-04-01 05:00:00                                             |
+-----------------------------------------------------------------+ 
```

[对于这个答案](https://stackoverflow.com/questions/24797/effectively-converting-dates-between-utc-and-local-ie-pst-time-in-sql-2005#25073)所涉及的扭曲。

至于“更容易使用”的评论，我想说的是它们是不同的，如果你知道一个，学习另一个就会有开销。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-03-08T14:10:06.210

两者都是 DBMS 的产品 Sql server 是一个商业应用程序，而 MySql 是一个开源应用程序。两个产品都包含类似的功能，但是 sql server 应该用于企业解决方案，而 mysql 可能适合较小的实现。如果您需要恢复之类的功能，复制，粒度安全和重要，你需要sql server

MySql占用磁盘空间少，使用内存和cpu比sql server少

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-08-14T11:24:57.133

> 有人对从 SQL Server 到 MySQL 的数据库“端口”有任何好的经验吗？

这应该是相当痛苦的！我将 MySQL 的版本从 4.x 切换到 5.x，并且各种语句不再像以前那样工作。查询分析器已“改进”，因此以前针对性能进行了调整的语句将不再按预期工作。

从使用 500GB MySQL 数据库中吸取的教训：这是一个微妙的话题，其他任何事情都不是微不足道的！

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-09T23:36:18.473

@Cebjyre。无论是 Enterprise Manager 还是 Management Studio，IDE 都比我迄今为止看到的 MySQL 更好。我说“更容易使用”是因为我可以在 MSSQL 中做很多事情，而 MySQL 没有对应物。在 MySQL 中，我不知道如何通过简单地查看查询计划或查看统计信息来调整查询。MSSQL 中的索引调优向导对丢失或错位的索引进行了大部分猜测工作。

MySQL 的一个缺点是没有数据库的最大大小。数据库只会增加大小，直到填满磁盘。想象一下，如果这个磁盘正在与其他用户共享数据库，突然他们的所有查询都失败了，因为他们的数据库无法增长。我很久以前就向 MySQL 报告了这个问题。我认为它还没有修复。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-23T20:09:37.350

花一些时间使用 MySQL，从 MSSQL 到 MySQL 语法 POV，我一直发现自己的能力有限。

在更新期间引用同一个表时更新表有一些奇怪的限制。

此外 UPDATE FROM 不起作用，上次我检查它们也不支持 Oracle MERGE INTO 语法。这对我来说是一个表演停止者，我不再认为在那之后我会用 MySQL 取得任何进展。

# msbuild - 我应该从 nant 切换到 msbuild 吗？

> ID：10634
> 
> 赞同：28
> 
> 时间：2008-08-14T03:36:54.790
> 
> 标签：msbuild, build-process, build-automation, nant

我目前使用 nant、ccnet（巡航控制）、svn、mbunit。我使用 msbuild 来构建我的 sln 只是因为它更容易脱壳。

将我的整个构建脚本切换到 MSBuild 有什么好处吗？我需要能够运行测试、watir 风格测试、xcopy 部署。这更容易吗？

**更新：是否有任何引人注目的功能会导致我从 nant 转移到 msbuild？**

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-08-14T06:14:26.970

我喜欢 MSBuild。一个原因是 .csproj 文件是 msbuild 文件，在 VS 中构建就像在命令行中构建一样。另一个原因是我一直在使用的 CI 服务器 TeamCity 的良好支持。如果您开始使用 MSBuild，并且想要在构建过程中执行更多自定义操作，请获取[MSBuild 社区任务](http://msbuildtasks.tigris.org/)。他们给你一堆不错的额外任务。我已经好几年没用过 NAnt 了，也没有后悔过。

此外，正如 Ruben 所提到的，CodePlex 上有[SDC Tasks](http://www.codeplex.com/sdctasks)任务。

更有趣的是[，CodePlex 上有 MSBuild 扩展包](http://www.codeplex.com/MSBuildExtensionPack)，其中包括一个 twitter 任务。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-08-15T14:49:46.790

我的建议正好相反——避免像瘟疫一样的 MSBuild。NANT 更容易设置您的构建以进行自动测试、部署到多个生产环境、与 Cruisecontrol 集成以实现入门环境、与源代码控制集成。我们在使用 TFS/MSBuild（使用 TFSDeployer、自定义 powershell 脚本等）方面经历了很多痛苦，以使其能够完成我们使用 NANT 开箱即可完成的工作。不要浪费你的时间。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-08-15T14:39:02.070

使用 MSBuild（至少在 .NET 3.5 及更高版本中）的最令人信服的理由 - 构建引擎可以同时构建。

这意味着在您拥有多个内核/处理器的情况下，您的构建速度会大大加快。

在 3.5 之前，MSBuild 不进行并行构建。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-08-14T03:43:04.777

我觉得 MSBuild 和 Nant 是相当可比的。如果您使用其中之一，我通常不会在它们之间切换，除非您选择的产品中缺少引人注目的功能。

我个人将 MSBuild 用于任何新项目，但您的里程可能会有所不同。

希望有帮助！

**编辑：** @ChanChan - @Jon 提到 Nant 不构建 .NET 3.5 应用程序。这可能足以成为改变或至少并行使用它们的理由。随着我更多地转向 MSBuild，我可能不是最有见识的人来强调任何其他技术的阻碍。

**编辑：**看起来 Nant 现在构建 .NET 3.5 应用程序。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-17T04:20:01.623

NAnt 存在的时间更长，并且是相当成熟的产品，而且 IMO 更易于使用。如果您对构建可以在 Mono 以及 .NET 和 Silverlight 下运行的应用程序感兴趣，可以利用很多社区知识，而且它也是跨平台的。开箱即用，它比 MSBuild 所做的要多得多。哦，是的，您可以从 NAnt 调用 MSBuild（好的，从 NAntContrib 调用）:-)

不利的一面是，NAnt 及其姊妹项目 NAntContrib 似乎确实停滞不前，最近一次更新是在 2007 年底。

我看到的 MSBuild 的主要优点是它附带 .NET 框架，因此安装的产品少了一个；并且正在进行更积极的开发（尽管在某些地方赶上了旧的 NAnt）。

就个人而言，我发现它的语法有点难以掌握，但我确信继续接触 ti 会让事情变得更容易。

结论？如果您正在使用现有的 NAnt 脚本，请坚持使用它们，不值得麻烦移植。如果您正在开始一个新项目，并且喜欢冒险，那么试试 MSBuild。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-04T07:37:23.560

我们还从 nant 切换到了 msbuild。如果您的构建非常标准，那么设置它不会有太多问题，但是如果您有很多特定的构建任务，您将不得不编写自定义 ms 构建任务，因为 msbuild 的自定义任务要少得多。

如果您想显示合理的构建结果，您将不得不使用自定义记录器等。整个团队构建不如 nant 成熟。

但真正的好处是与 TFS 源代码控制和报告服务的集成。如果您没有使用 TFS 作为您的源代码控制系统，那是不值得的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-11T11:20:35.247

*   除非您有非常令人信服的理由（至少），否则不要切换。
*   NAnt 是开源的，如果不是，我将无法自定义我们的构建系统，MSBuild 不是。
*   NAnt 可以轻松运行 MSBuild，我不确定是否可以反过来。
*   如果您使用 VS2005 或更新版本，则已经为您编写了 MSBuild 脚本（项目文件**是**MSBuild 文件。）
*   如果您使用 NAnt，并且使用 VS 来编辑项目文件、设置和配置，则必须编写一个转换器/同步工具来从 VS 项目文件更新您的 NAnt 文件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-08-14T03:49:42.190

@布拉德·里奇

> 除非缺少引人注目的功能，否则我通常不会在它们之间切换

使用 msbuild 的令人信服的理由是什么？有缺点吗？

到目前为止，我从你的回答中得到了一个很好的“不，不要打扰”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-08-14T06:07:42.770

我认为它们在功能和易用性方面都具有可比性。仅仅因为基于 C#，我发现 msbuild 比 nants 更容易使用，尽管这并不是一个令人信服的切换理由。

南特到底没有为你做什么？或者您只是希望您可能会错过一些很酷的功能？:)

关于 C# 的一件非常好的事情是，如果您拥有 .net 框架，那么您就拥有了运行 msbuild 所需的一切。当您在大型团队/项目中工作并且人员/硬件更替时，这非常棒。

就我个人而言，我更喜欢 SCons 而不是他们两个 :)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-08-15T14:51:51.293

我仍然使用 nAnt 而不是 msbuild 进行自动构建的主要原因是我对构建有更精细的控制。由于使用 csproj 的 msbuild 有它的构建文件，因此该项目中的所有源代码都被编译到一个程序集中。这导致我的解决方案中有很多项目用于我分离逻辑的大型项目。有了 nant，我可以安排我的构建，在那里我可以将我想要的东西从一个项目编译成多个程序集。

我喜欢这条路线，因为它使我不必在我的解决方案中使用许多项目文件。我可以有一个项目，其中文件夹拆分图层，然后使用 nant 将每一层构建到它自己的程序集中。

但是，对于某些构建任务，例如构建 WPF 应用程序，我确实将 nant 和 msbuild 结合使用。在 nant 中使用 msbuild 目标编译 WPF 应用程序要容易得多。

最后，我的回答是我喜欢并排使用它们，但是当我在此配置中使用 msbuild 时，它通常用于直接编译，不执行任何构建自动化任务，例如将文件复制到目录，生成例如，帮助文档或运行我的单元测试。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-30T07:41:58.263

我实际上还在尝试自己解决这个问题，但是这里的 MSBuild 有一个很大的好处：通过直接调用 msbuild.exe 使用相同的构建文件进行本地持续集成，同时还能够使用 VSTS 的服务器端持续与相同的构建文件集成（尽管很可能是不同的属性/设置）。

即相对于 TeamCity 对 MSBuild 脚本的支持，VSTS***只***支持 MSBuild 脚本！我过去通过从 MSBuild 执行 NAnt 解决了这个问题；我已经看到其他人推荐这种做法以及相反的做法，但它对我来说似乎很笨拙，所以如果我能避免它，我尽量不这样做。因此，当您使用“完整的 Microsoft 堆栈”（VSTS 和 TFS）时，我建议您只使用 MSBuild 脚本。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-28T23:58:04.260

**Nant**具有更多开箱即用的功能，但**MSBuild**具有更好的基本结构（项目元数据岩石），这使得构建可重用的 MSBuild 脚本变得更加容易。

MSBuild 需要一段时间才能理解，但一旦你完成它就会非常好。

学习资料：

*   [在 Microsoft Build Engine 内部：使用 MSBuild 和 Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)
    ，作者 Sayed Ibrahim Hashimi（2009 年 1 月）
*   [部署 .NET 应用程序：学习 MSBuild 和 ClickOnce，](https://rads.stackoverflow.com/amzn/click/com/B001D25YT6)
    Y. Hashimi 的 Sayed（2008 年 9 月）

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-16T19:04:17.697

我看不出有任何改变的理由。MsBuild 本身将您锁定在您正在使用的框架中。如果您使用 NAnt，您可以在许多框架中使用它，并使用 msbuild 来实际为您完成构建任务。

在这方面，我是 NAnt 的拥护者，因为它让你从框架中解耦了一点。

我创建了一个框架，将约定放入自动构建中，并在 NAnt 上构建它。它被称为 UppercuT，它是非常容易使用的构建框架。

自动化构建就像 (1) 解决方案名称，(2) 源代码控制路径，(3) 大多数项目的公司名称一样简单！

[http://code.google.com/p/uppercut/](http://code.google.com/p/uppercut/)

这里有一些很好的解释：[Uppercut](http://ferventcoder.com/category/10094.aspx)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-10-16T17:36:47.233

与 Visual Studio 集成的 MSBuild 可以减少程序员使用构建系统的摩擦。它主要归结为他们只需要“构建解决方案”就可以了，这一切都可以工作，而不是必须使用自定义构建步骤和其他类似的东西，或者更糟糕的是，通过启动某种外部脚本来强制开发人员进行构建。

现在，我主要倾向于 MSBuild 而不是 NAnt，因为它更简单。当然，NAnt 有更多的功能，更强大等等，但它很快就会失控。如果您和您的构建工程师有纪律保持 NAnt 脚本简单，那么一切都很好。然而，我已经看到太多基于 NAnt 的系统走向南方，以至于没有人知道它在做什么了，除了做相当于一个好的 ol'printf 之外，没有真正的方法来调试它。当您开始使用一些 if/else 语句或 for 循环时，恕我直言，这就是它开始闻起来的地方。

另一方面，MSBuild 具有基于元数据的坚实基础和不太冗长的语法。它的简单性（或缺少功能……取决于您如何看待它）迫使您通过新任务在 .NET 代码中编写逻辑，而不是在 XML 标记中编写逻辑。这鼓励了可重用性，最重要的是，让您可以在真正的调试器中实际调试您的构建系统。

MSBuild 的唯一问题是不那么偶然的错误（尤其是在第一个版本中）或晦涩难懂（尽管有文档记录）的行为。而且，如果那是真正困扰你的事情，那就是与微软联系在一起。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2010-06-11T14:52:13.407

我从 NANT 切换到 MSBuild。该项目在.Net 4.0 中运行。

我在南特的经历很好。这个项目有点死了。当 .Net 4.0 出现时，是时候重新评估构建过程了。

自从 Nant 上次发布以来，MSBuild 已经出现。在这一点上，MSBuild 是要走的路。它易于使用，有许多扩展。我用一天半的时间重写了我的 Nant 脚本。MSBuild 脚本是 Nant 脚本大小的 1/3。

Nant 脚本中的大部分工作是设置不同的环境。在 MsBuild/.Net 4.0 中它是内置的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-08-14T03:53:09.687

我将 MSBuild*与*Nant 一起使用，因为当前版本的 Nant 还不能编译 .NET 3.5 应用程序（当 .NET 2.0 首次出现时也是如此）。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-08-14T04:06:00.847

我能看到使用 msbuild 的唯一原因是您是否想使用自动构建服务器，如巡航控制。如果您不打算切换，那么我将不理会它。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-07-30T17:21:25.567

我使用 Nant，我喜欢它。由于以下原因，我使用了 MSBuild 并讨厌它：

1.  微软强迫你遵循他们自己的构建过程，这对他们的行为来说是如此内在，以至于我至少无法让它工作（我必须编译 NET1.1，所以我不得不混合使用 Nant 和 MSbuild）。我知道您可以创建自己的 MSBuild 文件，但我认为理解和维护它很复杂。

2.  进行文件操作的 ItemTypes 太难理解了。你可以让 Nant 做完全相同的事情，而且更容易和直接（我必须创建一个 ItemType 列表，然后传递给文件操作）。

3.  在 MsBuild 中您必须创建自己的任务 dll，在 Nant 中您可以这样做，或者您可以在脚本中嵌入 C# 代码，因此更容易推进并构建整个项目。

4.  Nant 适用于 Net1.1，MsBuild 不适用。

5.  要安装 nant，我什至可以解压缩并在我自己的存储库中定位来运行它。安装 MsBuild 要困难得多，因为它依赖于 Visual Studio 等的许多东西（也许我在这里错了，但这似乎是事实）。

嗯，这些是我的意见...

# powershell - 为什么我的 PowerShell 脚本没有运行？

> ID：10635
> 
> 赞同：111
> 
> 时间：2008-08-14T03:39:17.610
> 
> 标签：powershell

我编写了一个简单的批处理文件作为 PowerShell 脚本，运行时出现错误。

它位于我路径中的脚本目录中。这是我得到的错误：

> 无法加载，因为在此系统上禁用了脚本的执行。请参阅“获取有关签名的帮助”。

我查看了帮助，但它没有帮助。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2008-08-14T03:41:33.003

它可能是 PowerShell 的默认安全级别，它 (IIRC) 将只运行签名脚本。

试着输入这个：

```
set-executionpolicy remotesigned 
```

这将告诉 PowerShell 允许本地（即在本地驱动器上）未签名的脚本运行。

然后尝试再次执行您的脚本。

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2013-11-14T10:15:31.470

你需要运行`Set-ExecutionPolicy`：

```
Set-ExecutionPolicy Restricted <-- Will not allow any powershell scripts to run.  Only individual commands may be run.

Set-ExecutionPolicy AllSigned <-- Will allow signed powershell scripts to run.

Set-ExecutionPolicy RemoteSigned <-- Allows unsigned local script and signed remote powershell scripts to run.

Set-ExecutionPolicy Unrestricted <-- Will allow unsigned powershell scripts to run.  Warns before running downloaded scripts.

Set-ExecutionPolicy Bypass <-- Nothing is blocked and there are no warnings or prompts. 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2013-04-22T07:16:58.470

采用：

```
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process 
```

始终使用上述命令启用在当前会话中执行 PowerShell。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2015-11-30T20:13:10.583

我可以通过像这样调用 PowerShell 来绕过这个错误：

```
powershell -executionpolicy bypass -File .\MYSCRIPT.ps1 
```

也就是说，我在`-executionpolicy bypass`调用脚本的方式中添加了 。

这适用于 Windows 7 Service Pack 1。我是 PowerShell 新手，因此可能会有一些我不知道的警告。

[编辑 2017-06-26] 我继续在其他系统上使用此技术，包括 Windows 10 和 Windows 2012 R2，没有问题。

这是我现在正在使用的。这可以防止我通过单击意外运行脚本。当我在调度程序中运行它时，我添加了一个参数：“调度程序”并且绕过了提示。

这也会在最后暂停窗口，以便我可以看到 PowerShell 的输出。

```
if NOT "%1" == "scheduler" (
   @echo looks like you started the script by clicking on it.
   @echo press space to continue or control C to exit.
   pause
)

C:
cd \Scripts

powershell -executionpolicy bypass -File .\rundps.ps1

set psexitcode=%errorlevel%

if NOT "%1" == "scheduler" (
   @echo Powershell finished.  Press space to exit.
   pause
)

exit /b %psexitcode% 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-02-21T00:23:53.893

```
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process 
```

即使发生以下错误，上述命令也对我有用：

```
Access to the registry key 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\PowerShell\1\ShellIds\Microsoft.PowerShell' is denied. 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-08-14T03:47:47.857

另外值得知道的是，您可能需要`.\`在脚本名称前面包含。例如：

```
.\scriptname.ps1 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-18T20:23:26.260

该命令`set-executionpolicy unrestricted`将允许您创建的任何脚本以登录用户身份运行。`set-executionpolicy signed`只需确保在注销之前使用命令将执行策略设置回签名。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-09-27T02:37:58.180

我们可以很好地绕过执行策略（在命令提示符内）：

```
type file.ps1 | powershell -command - 
```

或者在powershell里面：

```
gc file.ps1|powershell -c - 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-09-20T09:08:32.270

在 Windows 10 上：单击更改 myfile.ps1 的安全属性并通过右键单击 myfile.ps1 上的 / 属性更改“允许访问”

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-09T14:25:02.613

绕过执行策略是理想的，例如通过

```
powershell -executionpolicy bypass -File .\MYSCRIPT.ps1 
```

不幸的是，这仍然可以通过组策略来防止。作为一种解决方法，您可以通过在 PowerShell 中运行将脚本编码为 Base64：

```
[Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes((Get-Content .\MYSCRIPT.ps1))) 
```

然后像这样执行结果：

```
powershell.exe -EncodedCommand "put-your-base64-string-here" 
```

警告：这不适用于需要参数的脚本。

# c# - 有没有像样的 C# 分析器？

> ID：10644
> 
> 赞同：83
> 
> 时间：2008-08-14T03:52:55.553
> 
> 标签：c#, .net, profiling, profiler

我需要一个 C# 分析器。

虽然我不反对付费，但免费的或至少有试用版的东西会是理想的，因为需要时间来提高采购订单。

有什么建议吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-08-14T03:59:30.673

一年半前，我在一个大型 c# 项目中使用了[Ants 分析器。](http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/)它的成本确实非常好，甚至超过了一些更昂贵的竞争对手。

它以几乎逐行的分辨率计算成本。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-08-14T04:01:56.410

您可以尝试以下方法：

*   [nprof](http://nprof.sourceforge.net/Site/Description.html)（免费但有点旧）
*   [ProfileSharp](http://sourceforge.net/projects/profilesharp/)（开源）
*   [.Net Memory Profiler](http://memprofiler.com/)（非常适合内存泄漏，有试用版）

* * *

编辑：Nprof 已被[SlimTune](https://code.google.com/p/slimtune/)取代并适用于 .Net 4.0 应用程序

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-05-13T12:53:20.570

[EQATEC 分析器](http://www.eqatec.com/tools/profiler)非常好，完全免费。它易于设置和使用，并且似乎不会给应用程序增加太多开销。我今天才开始使用它，并且已经发现了一些我不会发现的瓶颈。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2008-08-14T04:00:15.993

[JetBrains 的dotTrace](http://www.jetbrains.com/profiler/)被广泛使用。

Patrick Smacchia 很棒的[NDepend](http://www.ndepend.com/#)非常适合提供静态分析。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-10-27T17:38:25.877

我在 SharpToolbox.com 上维护了一份完整[的 .NET 分析器列表。](http://sharptoolbox.com/categories/profilers-debuggers)

您会在此处找到建议的工具以及更多工具，每个工具都有其建议的简短描述。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-08-14T04:04:26.887

我们在我工作的地方使用[Ants 分析器。](http://www.red-gate.com/products/ants_performance_profiler/index.htm)它以简单的方式提供了非常详细的信息。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-08-14T10:03:47.380

有趣的是，没有人提到在 Visual Studio 的高端版本中有一个 - 我一直发现它足以用于执行分析。对于内存分析，我使用已经提到的 Memory Profiler，但这*不是*我通常所说的“分析器”。

你试图做什么样的分析？

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-12-30T22:03:26.743

我们使用[.NET Memory Profiler](http://memprofiler.com)。它有点难看，但对于查找悬空引用非常有用。

我最初尝试了[Red Gate 的 ANTS profiler](http://www.red-gate.com)，它非常性感，但从内存泄漏的角度来看，它很糟糕，原因如下：

1) 它慢得离谱。让应用程序进入开始录制状态需要半小时（没有红门需要 20 秒）。

2) Red Gate 需要在自己的工具上运行自己的工具。当我完成两张快照时，它正在使用 900MB 的内存！然后它崩溃了:(

然而，Red Gate ANTS 的计时组件令人印象深刻。只是不要打扰内存分析器，除非您正在处理一个微不足道的（小占用空间）应用程序。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-08-14T03:57:36.963

我用过 AQtime，它从来没有让我失望过。我确定有试用版。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-23T21:19:44.463

我将第二次[红门的 ANTS profiler](http://www.red-gate.com/products/ants_profiler/index.htm)。我用它来追踪一些真正令人不安的性能问题，它使用起来非常简单（学习曲线低），并且以易于理解的方式呈现了漂亮、详细的数据。价格标签是值得的，但它不是免费的......

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-08-14T04:26:03.193

> Patrick Smacchia 很棒的 NDepend 非常适合提供静态分析。

我会彻底推荐 NDepend 进行静态分析，但请注意，您可能需要花一两天时间来实际分析它提供的大量信息，并计算出所有统计数据的实际含义你的代码。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-05-11T18:43:19.190

我对 .NET 内存分析器很幸运

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-07-23T12:17:41.123

EQATEC profiler 在这里完成了这项工作。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-02-08T13:13:54.090

当前版本的[SharpDevelop (3.1.1)](http://www.icsharpcode.net/OpenSource/SD/)有一个很好的集成分析器。它非常快，并且很好地集成到了 SharpDevelop IDE 及其 NUnit 运行器中。结果以灵活的树/列表样式显示（使用 LINQ 创建您自己的选择）。双击显示的方法直接跳转到源代码。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-08-14T03:55:21.617

目前不要使用它们，我的一个朋友对 Ants profiler 赞不绝口。我知道它是一种付费产品，不知道有多贵。如果您碰巧配备了 MVP，您也许可以利用它免费获得许可证。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-12T06:07:15.143

AQTime（性能和内存）或 ANTS（v4 性能分析器或 v5 beta 内存分析器）。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-08-14T07:50:47.743

我昨天找到了[.NET Memory Profiler](http://memprofiler.com/)，我必须说我对它印象深刻。
我今天要订购我的驾照。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-11T18:54:00.310

尽管对内存使用情况进行分析不是很好，但某些版本的 Visual Studio 中包含的分析器在分析执行速度方面做得非常好。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-06T14:49:07.180

你的目标是什么？

您的目标是定位特定语句并大致了解它们对您的总执行时间的贡献，以便找到不同的方法吗？

[为此，我发誓这种方法。](https://stackoverflow.com/questions/926266/performance-optimization-strategies-of-last-resort/927773#927773)

# c# - 在 c# 中创建 iCal 文件

> ID：10658
> 
> 赞同：76
> 
> 时间：2008-08-14T04:07:36.150
> 
> 标签：c#, asp.net, icalendar

我正在寻找一种在 c# (asp.net) 中生成 iCalendar 文件 (*.ics) 的好方法。我找到了一些资源，但缺少的一件事是它们对**引用可打印**字段的支持 - 具有回车和换行符的字段。

例如，如果**描述**字段未正确编码，则只会显示第一行，并可能破坏 *.ics 文件中的其余信息。

我正在寻找可以生成 *.ics 文件的现有类和/或可以生成**带引号的可打印**字段的类。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-08-14T04:09:48.813

我使用[DDay.Ical](http://sourceforge.net/projects/dday-ical/)，它的好东西。能够打开一个 ical 文件并在一个不错的对象模型中获取其数据。它说的是测试版，但它对我们很有用。

# 编辑 2016 年 11 月

该库已被弃用，但被另一个开发人员拾取并重新发布为 iCal.NET。

发布说明：[rianjs.net/2016/07/dday-ical-is-now-ical-net](http://rianjs.net/2016/07/dday-ical-is-now-ical-net)

GitHub上的来源：[github.com/rianjs/ical.net](https://github.com/rianjs/ical.net)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-08-20T08:02:15.577

我发现这样做的最简单方法是使用[microformats](http://microformats.org/)标记您的 HTML 。

如果您要生成 iCalendar 文件，则可以使用[hCalendar 微格式](http://microformats.org/wiki/hcalendar)，然后包含一个链接，例如“添加到日历”，该链接指向：

**[http://feeds.technorati.com/events/[](http://feeds.technorati.com/events/[)您页面的完整 URL，包括 http:// ]**

然后 Technorati 页面解析您的页面，提取 hCalendar 信息并将 iCalendar 文件发送到客户端。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-01-21T21:15:57.873

我写了一个 shim 函数来处理这个问题。它基本上是合规的——唯一的问题是第一行是 74 个字符而不是 75 个（74 是处理后续行的空格）......

```
 Private Function RFC2445TextField(ByVal LongText As String) As String

     LongText = LongText.Replace("\", "\\")
     LongText = LongText.Replace(";", "\;")
     LongText = LongText.Replace(",", "\,")

     Dim sBuilder As New StringBuilder
     Dim charArray() As Char = LongText.ToCharArray

     For i = 1 To charArray.Length
         sBuilder.Append(charArray(i - 1))
         If i Mod 74 = 0 Then sBuilder.Append(vbCrLf & " ")
     Next

     Return sBuilder.ToString

 End Function 
```

我将其用于我们的 ICS 提要的摘要和描述。只需在前面添加字段（例如 LongText = "SUMMARY:Event Title"）。只要您将缓存设置得相当长，操作就不会太昂贵。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T19:11:56.157

**iCal** (ical 2.0) 和quoted-printable 不能一起使用。

**Quoted-printable 在vCal** (vCal 1.0)中被大量使用来表示不可打印的字符，例如换行符 (=0D=0A)。默认的 vCal 编码是 7 位的，所以有时需要使用quoted-printable 来表示非 ASCII 字符（可以覆盖默认编码，但不需要其他符合 vCal 的通信方理解它。）

在**iCal**中，特殊字符使用转义符表示，例如 '\n'。默认编码是 UTF-8，所有 iCal 兼容方都必须支持它，这使得在 iCal 2.0（和 vCard 3.0，就此而言）完全不需要引用打印。

您可能需要支持您的客户/利益相关者来阐明要求。vCal 和 iCal 之间似乎存在混淆。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-10-19T19:23:28.080

我缺少自定义时区的示例。所以这里有一个片段，展示了如何在 ics 中设置时区（并将其发送到 asp.net 中的浏览器）。

```
//set a couple of variables for demo purposes
DateTime IcsDateStart = DateTime.Now.AddDays(2);
DateTime IcsDateEnd = IcsDateStart.AddMinutes(90);
string IcsSummary = "ASP.Net demo snippet";
string IcsLocation = "Amsterdam (Netherlands)";
string IcsDescription = @"This snippes show you how to create a calendar item file (.ics) in ASP.NET.\nMay it be useful for you.";
string IcsFileName = "MyCalendarFile";

//create a new stringbuilder instance
StringBuilder sb = new StringBuilder();

//begin the calendar item
sb.AppendLine("BEGIN:VCALENDAR");
sb.AppendLine("VERSION:2.0");
sb.AppendLine("PRODID:stackoverflow.com");
sb.AppendLine("CALSCALE:GREGORIAN");
sb.AppendLine("METHOD:PUBLISH");

//create a custom time zone if needed, TZID to be used in the event itself
sb.AppendLine("BEGIN:VTIMEZONE");
sb.AppendLine("TZID:Europe/Amsterdam");
sb.AppendLine("BEGIN:STANDARD");
sb.AppendLine("TZOFFSETTO:+0100");
sb.AppendLine("TZOFFSETFROM:+0100");
sb.AppendLine("END:STANDARD");
sb.AppendLine("END:VTIMEZONE");

//add the event
sb.AppendLine("BEGIN:VEVENT");

//with a time zone specified
sb.AppendLine("DTSTART;TZID=Europe/Amsterdam:" + IcsDateStart.ToString("yyyyMMddTHHmm00"));
sb.AppendLine("DTEND;TZID=Europe/Amsterdam:" + IcsDateEnd.ToString("yyyyMMddTHHmm00"));

//or without a time zone
//sb.AppendLine("DTSTART:" + IcsDateStart.ToString("yyyyMMddTHHmm00"));
//sb.AppendLine("DTEND:" + IcsDateEnd.ToString("yyyyMMddTHHmm00"));

//contents of the calendar item
sb.AppendLine("SUMMARY:" + IcsSummary + "");
sb.AppendLine("LOCATION:" + IcsLocation + "");
sb.AppendLine("DESCRIPTION:" + IcsDescription + "");
sb.AppendLine("PRIORITY:3");
sb.AppendLine("END:VEVENT");

//close calendar item
sb.AppendLine("END:VCALENDAR");

//create a string from the stringbuilder
string CalendarItemAsString = sb.ToString();

//send the ics file to the browser
Response.ClearHeaders();
Response.Clear();
Response.Buffer = true;
Response.ContentType = "text/calendar";
Response.AddHeader("content-length", CalendarItemAsString.Length.ToString());
Response.AddHeader("content-disposition", "attachment; filename=\"" + IcsFileName + ".ics\"");
Response.Write(CalendarItemAsString);
Response.Flush();
HttpContext.Current.ApplicationInstance.CompleteRequest(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-19T18:51:07.673

查看[http://www.codeproject.com/KB/vb/vcalendar.aspx](http://www.codeproject.com/KB/vb/vcalendar.aspx)

它不会像您询问的那样处理带引号的可打印字段，但其余代码都在那里并且可以修改。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-15T18:47:52.300

根据 RFC-2445，comment 和 description 字段是 TEXT。测试字段的规则是： [1] TEXT 字段中的单行不超过 75 个八位字节。[2] 包装是通过插入 CRLF 后跟空格来实现的。[3] 有几个字符必须编码，包括\（反斜杠）；（分号）、（逗号）和换行符。使用 \（反斜杠）作为分隔符给出 \ \; \, \n

示例：以下是属性值中带有格式化换行符的属性示例：

```
 DESCRIPTION:Meeting to provide technical review for "Phoenix"
   design.\n Happy Face Conference Room. Phoenix design team
   MUST attend this meeting.\n RSVP to team leader. 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-08-14T06:10:00.863

iCal 可能很复杂，所以我建议使用库。DDay 是一个很好的免费解决方案。最后我检查了它没有完全支持重复事件，但除此之外它看起来真的很好。一定要与几个客户一起测试日历。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-05-09T18:19:20.967

我知道为时已晚，但它可能对其他人有所帮助。就我而言，我编写了以下带有 .ics 扩展名的文本文件

```
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Calendly//EN
CALSCALE:GREGORIAN
METHOD:PUBLISH
BEGIN:VEVENT
DTSTAMP:20170509T164109Z
UID:your id-11273661
DTSTART:20170509T190000Z
DTEND:20170509T191500Z
CLASS:PRIVATE
DESCRIPTION:Event Name: 15 Minute Meeting\nDate & Time: 03:00pm - 03:15pm (
 Eastern Time - US & Canada) on Tuesday\, May 9\, 2017\n\nBest Phone Number
  To Reach You :: xxxxxxxxx\n\nany "link": https://wwww.yahoo.com\n\n
SUMMARY:15 Minute Meeting
TRANSP:OPAQUE
END:VEVENT
END:VCALENDAR 
```

它对我有用。

# c# - Microsoft MVC Preview 4 中的 OutputCacheFilter 是否实际上保存了操作调用？

> ID：10661
> 
> 赞同：6
> 
> 时间：2008-08-14T04:16:18.610
> 
> 标签：c#, asp.net, asp.net-mvc, outputcache

我们使用包含严格压力测试的预览版 3 部署了一个实时、新鲜、时髦的网站。

页面输出缓存是我们的救星，使我们能够满足我们的性能合同要求。

`OutputCacheFilter`我的问题是，动作和页面输出缓存之间有区别吗？

动作输出缓存比页面输出缓存快吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-08-14T16:32:22.693

[在内部，OutputCacheAttribute（又名输出缓存过滤器）使用与页面输出缓存](http://msdn.microsoft.com/en-us/library/hdxfb6cy.aspx)（又名@OutputCache 指令）相同的内部机制。

因此，它并不比页面输出缓存快。但是，使用 MVC，您确实不能通过 MVC 中的 @OutputCache 指令使用页面输出缓存，因为我们在操作运行**后渲染视图（也称为页面）。**因此，您将获得的收益很少。

使用输出缓存过滤器，如果结果在输出缓存中，它会做正确的事情并且不执行操作代码。希望有帮助。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-08-16T13:17:05.620

请注意，如果您在标记为缓存的 Action 上调用 Html.RenderAction(..)，则当前存在错误。而不是缓存特定的操作，而是缓存整个页面。我已经在 codeplex 上报告了这个问题，这似乎是一个已知问题： [Calling <% HTML.RenderAction<...>(...); %> 到带有 [OutputCache(..)] 的操作会导致整个页面缓存。](http://www.codeplex.com/aspnet/WorkItem/View.aspx?WorkItemId=2062)

# c - 在 OS X 中读取其他进程的内存？

> ID：10668
> 
> 赞同：25
> 
> 时间：2008-08-14T04:31:32.903
> 
> 标签：c, macos, memory, ptrace

我一直在尝试了解如何在 Mac OS X 上读取其他进程的内存，但我运气不佳。我在网上看到了很多使用`ptrace`with等的示例，但是它在 BSD ^[ ^]`PEEKDATA`上没有该选项。^([`man ptrace`](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man2/ptrace.2.html))

```
int pid = fork();
if (pid > 0) {
    // mess around with child-process's memory
} 
```

如何在 Mac OS X 上读取和写入另一个进程的内存？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-15T13:48:35.297

使用`task_for_pid()`或其他方法获取目标进程的任务端口。此后，您可以使用`vm_read()`、`vm_write()`等直接操作进程的地址空间。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-08-14T04:46:37.850

Matasano Chargen 前段时间发表了一篇关于将一些调试代码移植到 OS X 的好帖子，其中包括学习如何在另一个进程中读取和写入内存（除其他外）。

[它必须工作，否则 GDB 不会](http://replay.web.archive.org/20090627062246/http://www.matasano.com/log/1100/what-ive-been-doing-on-my-summer-vacation-or-it-has-to-work-otherwise-gdb-wouldnt/)：

> 事实证明，苹果以其无限的智慧，已经将`ptrace()`. OS X 手册页列出了以下请求代码：
> 
> *   `PT_ATTACH`— 选择要调试的进程
> *   `PT_DENY_ATTACH`— 因此进程可以阻止自己被调试
>     [...]
> 
> 没有提到读取或写入内存或寄存器。如果手册页没有在错误代码部分中也提到`PT_GETREGS`, `PT_SETREGS`,`PT_GETFPREGS`和，那将是令人沮丧的。`PT_SETFPREGS`所以，我检查了`ptrace.h`. 在那里我发现：
> 
> *   `PT_READ_I`——阅读指导词
> *   `PT_READ_D`— 读取数据字
> *   `PT_READ_U`— 如果您的年龄足以记住 U 区是什么，则可以读取 U 区数据
>     [...]
> 
> 有一个问题解决了。我可以为断点读写内存。但是我仍然无法访问寄存器，我需要能够弄乱 EIP。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-07-27T20:12:47.623

我知道这个线程已有 100 年历史，但对于从搜索引擎来到这里的人来说：

[xnumem](https://github.com/jona-t4/xnumem)完全符合您的要求，操作和读取进程间内存。

```
// Create new xnu_proc instance
xnu_proc *Process = new xnu_proc();

// Attach to pid (or process name)
Process->Attach(getpid());

// Manipulate memory
int i = 1337, i2 = 0;
i2 = process->memory().Read<int>((uintptr_t)&i);

// Detach from process
Process->Detach(); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-15T16:08:25.320

如果您希望能够在进程之间共享内存块，您应该查看 shm_open(2) 和 mmap(2)。在一个进程中分配一块内存并将路径（用于 shm_open）传递给另一个进程非常容易，然后两者都可以一起发疯。正如 Chris Hanson 所提到的，这比在另一个进程的地址空间中闲逛要安全得多。当然，如果你不能控制这两个过程，这对你没有多大好处。

（请注意， shm_open 的最大路径长度似乎是 26 字节，尽管这似乎没有在任何地方记录。）

```
// Create shared memory block
void* sharedMemory = NULL;
size_t shmemSize = 123456;
const char* shmName = "mySharedMemPath";        
int shFD = shm_open(shmName, (O_CREAT | O_EXCL | O_RDWR), 0600);
if (shFD >= 0) {
    if (ftruncate(shFD, shmemSize) == 0) {
        sharedMemory = mmap(NULL, shmemSize, (PROT_READ | PROT_WRITE), MAP_SHARED, shFD, 0);
        if (sharedMemory != MAP_FAILED) {
            // Initialize shared memory if needed
            // Send 'shmemSize' & 'shmemSize' to other process(es)
        } else handle error
    } else handle error
    close(shFD);        // Note: sharedMemory still valid until munmap() called
} else handle error

...
Do stuff with shared memory
...

// Tear down shared memory
if (sharedMemory != NULL) munmap(sharedMemory, shmemSize);
if (shFD >= 0) shm_unlink(shmName);

// Get the shared memory block from another process
void* sharedMemory = NULL;
size_t shmemSize = 123456;              // Or fetched via some other form of IPC
const char* shmName = "mySharedMemPath";// Or fetched via some other form of IPC
int shFD = shm_open(shmName, (O_RDONLY), 0600); // Can be R/W if you want
if (shFD >= 0) {
    data = mmap(NULL, shmemSize, PROT_READ, MAP_SHARED, shFD, 0);
    if (data != MAP_FAILED) {
        // Check shared memory for validity
    } else handle error
    close(shFD);        // Note: sharedMemory still valid until munmap() called
} else handle error

...
Do stuff with shared memory
...

// Tear down shared memory
if (sharedMemory != NULL) munmap(sharedMemory, shmemSize);
// Only the creator should shm_unlink() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-30T23:19:02.240

您想使用共享内存方法进行进程间通信。有关其他公共方法的摘要，请参见[此处](https://en.wikipedia.org/wiki/Inter-process_communication#Main_IPC_methods "主要 IPC 方法的简短介绍")

我很快就在这[本书](http://books.google.fr/books?id=V8xQAAAAMAAJ&q=Unix+System+V:+Programmer's+Reference+Manual&dq=Unix+System+V:+Programmer's+Reference+Manual&hl=fr&sa=X&ei=yq1KUuSYN-WX1AXY04HABw&ved=0CEgQ6AEwAQ "AT&T Unix System V：程序员参考手册")中找到了你需要的东西，它包含了当今所有 UNIX 通用的所有 API（比我想象的要多得多）。你应该在未来买它。这本书是一组（数百）印刷手册页，很少安装在现代机器上。每个手册页都详细介绍了一个 C 函数。

我很快就找到了***shmat()*** ***shmctl()***；***shmdt()***和***shmget()***。我没有广泛搜索，也许还有更多。

它看起来有点过时了，但是：是的，现代 UNIX 操作系统的基本用户空间 API 可以追溯到 80 年代。

更新：书中描述的大多数功能都是 POSIX C 头文件的一部分，您不需要安装任何东西。很少有例外，例如原始库“curses”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-10-07T23:45:37.623

我肯定找到了您需要的简短实现（只有一个源文件（main.c））。它是专门为 XNU 设计的。

它在谷歌搜索的前十名中，关键字«dump process memory os x»

源代码在[这里](https://github.com/gdbinit/readmem "自述文件")

但从虚拟地址空间点de vue的严格角度来看，您应该对这个问题更感兴趣：[OS X：生成核心转储而不关闭进程？](https://stackoverflow.com/questions/2179416/os-x-generate-core-dump-without-bringing-down-the-process)（也看[这个](http://osxbook.com/book/bonus/chapter8/core/ "获取 gcore（旧版本）源代码的链接")）

当您查看 gcore 源代码时，执行此操作非常复杂，因为您需要处理胎面及其状态......

在大多数 Linux 发行版上，gcore 程序现在是 GDB 包的一部分。我认为 OSX 版本是使用 xcode/开发工具安装的。

***更新： wxHexEditor 是一个可以编辑设备的编辑器。它还可以像编辑常规文件一样编辑进程内存。它适用于所有 UNIX 机器。***

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-08-14T09:19:08.283

在其背后操纵进程的内存是一件坏事，并且充满危险。这就是为什么 Mac OS X（像任何 Unix 系统一样）具有受保护的内存，并使进程彼此隔离的原因。

当然可以：在显式合作的进程之间有共享内存的设施。也有方法来操作其他进程的地址空间，只要这样做的进程具有这样做的明确权利（如安全框架所授予的那样）。但这对于编写调试工具的人来说是可用的。对于 Mac OS X 上的绝大多数开发来说，这不应该是正常的——甚至是罕见的——发生。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-01-19T16:36:48.617

一般来说，我建议您使用常规 open() 打开临时文件。一旦它在两个进程中都打开，您就可以从文件系统中 unlink() 它，并且您的设置与使用 shm_open 时的设置非常相似。该过程与 Scott Marcy 为 shm_open 指定的过程极为相似。

这种方法的缺点是，如果执行 unlink() 的进程崩溃，您最终会得到一个未使用的文件，并且没有进程负责清理它。这个缺点与 shm_open 相同，因为如果没有任何 shm_unlinks 给定名称，则该名称保留在共享内存空间中，可供未来进程使用 shm_opened。

# c# - 异步远程调用

> ID：10670
> 
> 赞同：9
> 
> 时间：2008-08-14T04:35:16.810
> 
> 标签：c#, .net-3.5, .net-2.0, remoting, rpc

我们有一个在单独的 Windows 服务中运行的远程处理单例服务器（我们称她为 RemotingService）。RemotingService 的客户端是 ASP.NET 实例（很多很多）。

目前，客户端远程调用 RemotingService 并在服务 RemotingService 调用时阻塞。然而，远程服务变得足够复杂（有更多的 RPC 调用和复杂的算法），以至于 asp.net 工作线程被阻塞了很长时间（4-5 秒）。

根据[这篇 msdn 文章](http://msdn.microsoft.com/en-us/magazine/cc164128.aspx)，这样做不会很好地扩展，因为每个远程 RPC 都会阻塞一个 asp.net 工作线程。它建议切换到异步处理程序以释放 asp.net 工作线程。

> 异步处理程序的目的是在处理程序处理原始请求时释放 ASP.NET 线程池线程以服务其他请求。

这似乎很好，除了远程调用仍然从线程池中占用一个线程。这是与 asp.net 工作线程相同的线程池吗？

**我应该如何将我的远程单例服务器变成一个异步系统，以便释放我的 asp.net 工作线程？**

我可能错过了一些重要信息，如果您还需要知道什么来回答这个问题，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-08-14T05:53:40.397

使用 ThreadPool 背后的想法是，通过它你可以控制同步线程的数量，如果同步线程太多，那么线程池会自动管理新线程的等待。

Asp.Net 工作线程 (AFAIK) 不是来自线程池，也不应该受到您对远程服务的调用的影响（除非这是一个非常慢的处理器，并且您的远程处理功能是 CPU 密集型的 - 其中情况下，您计算机上的所有内容都会受到影响）。

您始终可以在不同的物理服务器上托管远程服务。在这种情况下，您的 asp.net 工作线程将完全独立于您的远程调用（如果远程调用是在单独的线程上调用的）。

# c - on_exit() 和 atexit() 函数之间有区别吗？

> ID：10680
> 
> 赞同：21
> 
> 时间：2008-08-14T04:53:45.620
> 
> 标签：c, linux

有没有区别

```
 int on_exit(void (*function)(int , void *), void *arg); 
```

和

```
 int atexit(void (*function)(void)); 
```

除了 on_exit 使用的函数获得退出状态之外？

也就是说，如果我不关心退出状态，是否有任何理由使用其中一个？

**编辑：**许多答案都被警告，`on_exit`因为它是非标准的。如果我正在开发一个供内部公司使用并保证在特定配置上运行的应用程序，我应该担心这个吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-08-14T04:59:55.607

如果可能的话，你应该使用`atexit()`。 `on_exit()`是非标准的，不太常见。例如，它在 OS X 上不可用。

内核.org - [`on_exit()`](http://www.kernel.org/doc/man-pages/online/pages/man3/on_exit.3.html)：

> 此函数来自 SunOS 4，但也存在于 libc4、libc5 和 glibc 中。它不再出现在 Solaris (SunOS 5) 中。避免使用这个函数，而是使用标准的 atexit(3)。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-08-14T05:03:17.707

根据我发现的[这个链接](http://www.delorie.com/gnu/docs/glibc/libc_560.html)，似乎有一些差异。 `on_exit`将允许您传入一个在`on_exit`调用函数时传递给函数的参数......这可能让您设置一些指针，以便在退出时进行一些清理工作。

此外，它似乎`on_exit`是 SunOS 特定的功能，可能无法在所有平台上兼容......所以你可能想坚持使用 atexit，尽管它更具限制性。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-07-17T20:20:53.750

不同之处在于它`atexit`是 C 并且`on_exit`是 GNU 和谁知道什么其他 Unixy 系统（但**不是**POSIX 的一部分）上可用的一些奇怪的扩展。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-08-14T08:09:47.563

@Nathan，我找不到任何会返回当前运行进程的退出代码的函数。`atexit()`无论如何，我希望它在被调用的时候还没有设置。我的意思是运行时知道它是什么，但可能没有将它报告给操作系统。不过，这几乎只是猜测。

看起来您将需要使用`on_exit()`或构建您的程序，以便退出代码无关紧要。`exited_cleanly`让主函数中的最后一条语句将全局变量翻转为 true并不是不合理的。在您注册的函数中`atexit()`，您可以检查此变量以确定程序如何退出。这只会给你两种状态，但我希望这足以满足大多数需求。如有必要，您还可以扩展此类方案以支持更多退出状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-14T06:51:23.337

@内森

首先，看看是否有另一个 API 调用来确定退出状态......快速浏览一下，我没有看到，但我并不精通标准 C API。

一个简单的替代方法是拥有一个存储退出状态的全局变量......默认是未知的错误原因（如果程序异常终止）。然后，当您调用 exit 时，您可以将退出状态存储在全局中并从任何 atexit 函数中检索它。这需要在每次退出调用之前认真存储退出状态，显然并不理想，但如果没有 API 并且您不想冒险`on_exit`不在平台上......这可能是唯一的选择。

# sql - 保持 SQL 游标打开的“合理”时间长度是多少？

> ID：10727
> 
> 赞同：3
> 
> 时间：2008-08-14T06:07:53.347
> 
> 标签：sql, cursors

在您的应用程序中，在提交或回滚之前保持事务打开的“长时间”是多少？分钟？秒？小时？

在哪个数据库上？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-08-14T06:10:46.197

我可能会为此大发雷霆，但你真的应该尽量避免使用游标，因为它们会严重影响性能。如果你必须使用它，你应该尽可能保持打开它的绝对最短时间，以便尽快释放被游标阻塞的资源。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-08-14T06:10:22.983

交易：分钟。

光标：最多 0 秒，如果您使用光标，我们会解雇您。

**当您考虑到我们处于一个必须运行 sql server 的高可用性 Web 环境中时，这并不荒谬，而且由于无法准确地对它们进行版本化和维护，我们甚至不允许存储过程。如果我们使用 oracle 可能。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-08-14T07:34:12.470

一般来说，我同意其他答案：尽可能避免使用游标（在大多数情况下）并尽快关闭它们。

但是：这完全取决于您工作的环境。

*   如果它是一个拥有大量用户的生产网站环境，请确保光标在有人超时之前消失。
*   如果您 - 例如 - 在不执行其他任何操作的专有机器上编写“日志分析存储过程”（或其他）：随意做任何您想做的事情。你将是唯一需要等待的人。数据库服务器不会因为您使用游标而死掉。但是，您应该考虑到，使用行为可能会随着时间而改变，并且在某个时候可能有 10 个人在使用该应用程序。所以尝试寻找另一种方式;）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-08-14T08:59:38.023

@lomaxx，@ChanChan：据我所知，游标只是 SQL Server 和 Sybase（T-SQL 变体）上的问题。如果您选择的数据库是 Oracle，那么游标就是您的朋友。我见过许多使用游标实际上提高了性能的案例。游标是一种非常有用的机制，而且说“如果你使用游标，我们就会解雇你”之类的话有点荒谬。

话虽如此，您只想将光标保持在所需的绝对最小值。如果不了解问题域，指定最大时间将是任意且毫无意义的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-08-14T13:05:04.733

@nineside：抛开性能问题不谈，这也是关于使用正确的工具来完成这项工作。考虑到将光标从查询中移出到代码中的选择，我认为 100 次中有 99 次最好将循环逻辑放入某种托管代码中。这样做可以让您获得使用调试器、编译时错误检查、类型安全等的优势。

我对这个问题的回答仍然是一样的，如果您使用的是游标，请尽快关闭它，在 oracle 中我也会尝试使用显式游标。

# sql-server - 将数据库密码存储在启动脚本/配置文件中的最佳方法？

> ID：10731
> 
> 赞同：8
> 
> 时间：2008-08-14T06:10:25.013
> 
> 标签：sql-server, security, passwords

所以我们的网络服务器应用需要连接到数据库，而其他一些应用有在启动时执行的启动脚本。

就这些应用程序而言，存储名称/密码的最佳方式是什么？

*   安全性，例如我们可能不希望系统管理员知道数据库密码
*   可维护性，例如在密码更改时使配置易于更改等。

windows 和 linux 解决方案都赞赏！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-08-14T09:03:47.627

保护密码的最佳方法是停止使用密码。使用受信任的连接： [如何：在 ASP.NET 2.0 中使用 Windows 身份验证连接到 SQL Server](http://msdn.microsoft.com/en-us/library/ms998292.aspx)。然后你就没有什么可隐藏的了 - 将你的 web.config 和源发布到全世界，他们仍然无法访问你的数据库。

如果这对您不起作用，请使用[ASP.NET 中的内置配置加密系统](http://msdn.microsoft.com/en-us/magazine/cc163614.aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-05-25T07:01:51.893

PostgreSQL在他们的文档中为这种情况提供了一个[很好的解决方案。](http://www.postgresql.org/docs/current/static/ssh-tunnels.html)本质上，您使用 ssh 将您机器上的端口桥接到远程机器上的 PostgreSQL 服务器端口。这具有三个身份验证阶段：

1.  限制对本地端口的访问，例如只让特定用户连接到它。
2.  使用 ssh 作为特定用户设置与 PostgreSQL 主机的无密码连接。
3.  允许用户 ssh 连接为无需密码即可本地访问 PostgreSQL。

这降低了您的用户帐户是否受到保护以及您的 ssh 配置是否合理的安全性，并且您不需要在任何地方存储密码。

**编辑**：我应该补充一点，这将适用于任何侦听 TCP/IP 端口的数据库。它恰好在 PostgreSQL 中有描述。而且你会希望 iptables（或 Linux 下的等价物）来做端口限制。看到[这个](http://www.linuxjournal.com/article/6091)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-08-14T06:41:12.330

我同意 lomaxx 的观点：如果有人已经在服务器上或者可以广泛访问它（比如系统管理员），那么游戏就差不多结束了。因此，我们的想法是使用您信任的服务器，它在您希望的程度上是安全的。具体来说：

*   您需要信任系统管理员
*   您需要信任在同一服务器上运行代码的任何其他人（这就是为什么共享主机对我来说是一个很大的禁忌）

除此之外，环境变量似乎是存储这些类型凭据的流行选择，因为这意味着仅访问源（例如通过破坏开发框）不会直接显示它，而且它可以很好地本地化每个服务器（开发、测试等）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-08-14T06:12:31.013

纯文本？如果它们在您的服务器上，我希望服务器足够安全，不会允许未经授权的访问。如果人们可以访问您在服务器上的配置文件，那么早就出现了问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-08-14T06:20:30.187

澄清：在安全性、可维护性方面（例如如果登录需要更改，我可以稍后找到它等）

@lomax：也许我可能不希望每个有权访问物理服务器的人（例如系统管理员）都看到密码。

谢谢！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-14T07:13:19.597

在大多数情况下，我相信在纯文本文件（例如使用 base64）中混淆密码就足够了。您无法完全保护存储的密码免受具有 root 访问权限的确定系统管理员的影响，因此实际上没有必要尝试。然而，简单的混淆可以防止意外地将密码泄露给肩冲浪者。

一个更复杂的替代方法是设置一个专用的安全密码服务器，它可以：

*   提供密码解密服务
*   实际上存储密码供其他不太安全的服务器使用

根据所使用的网络协议，这可能无法防止使用 tcpdump 的流氓系统管理员。而且它也可能无法使用调试器来防止确定的系统管理员。那时，可能是时候看看 Kerberos 票证之类的东西了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-08-14T06:39:42.627

您可以将对称加密密钥烘焙到二进制文件中，并让该二进制文件在启动时从磁盘上的文件中读取加密的用户名/密码。

然而，这并不仅仅是混淆，因为您的代码很可能存储在某个源存储库中的某个地方。

我建议您最好使用防火墙和专用网络气泡控制对服务器的物理访问和网络访问，并将密码以明文（或 base-64 编码）存储在磁盘上，并锁定权限给您的 Web 应用程序的运行用户。

您还可以锁定数据库服务器以仅接受来自您的 Web 应用程序计算机的 IP 连接。

最终，您的问题是密钥（您的数据库用户名/密码对）需要可供您的 Web 应用程序以编程方式、无人值守的方式使用。

# unit-testing - 集成测试和单元测试有什么区别？

> ID：10752
> 
> 赞同：335
> 
> 时间：2008-08-14T06:27:57.207
> 
> 标签：unit-testing, integration-testing

我知道单元测试和集成测试的所谓教科书定义。我很好奇的是什么时候应该编写单元测试......我将编写它们以涵盖尽可能多的类集。

例如，如果我有一个`Word`类，我将为该类编写一些单元测试`Word`。然后，我开始编写我的`Sentence`类，当它需要与`Word`类交互时，我会经常编写我的单元测试，以便它们同时测试`Sentence`……`Word`至少在它们交互的地方。

*这些测试是否本质上成为集成测试，因为它们现在测试这 2 个类的集成，还是只是一个跨越 2 个类的单元测试？*

一般来说，由于这条不确定的路线，我很少会真正编写集成测试......或者我正在使用成品来查看所有部分是否正常工作实际集成测试，即使它们是手动的并且很少重复超出范围每个单独的功能？

我是否误解了集成测试，或者集成测试和单元测试之间真的只有很小的区别？

* * *

## 回答 #1

> 赞同：328
> 
> 时间：2011-10-24T13:05:37.817

对我来说，关键的区别在于**集成测试可以**揭示一个功能是正常工作还是被破坏，因为它们在接近现实的场景中强调代码。他们调用一种或多种软件方法或功能并测试它们是否按预期运行。

相反，测试单个方法的**单元测试依赖于（通常是错误的）假设，即软件的其余部分正常工作，因为它显式地模拟了每个依赖项。**

因此，当实现某个功能的方法的单元测试为绿色时，并不**意味着**该功能正在工作。

假设您有这样的方法：

```
public SomeResults DoSomething(someInput) {
  var someResult = [Do your job with someInput];
  Log.TrackTheFactYouDidYourJob();
  return someResults;
} 
```

`DoSomething`对您的客户来说非常重要：这是一项功能，是唯一重要的事情。这就是为什么您通常编写 Cucumber 规范来断言它：您希望*验证*并*传达*该功能是否有效。

```
Feature: To be able to do something
  In order to do something
  As someone
  I want the system to do this thing

Scenario: A sample one
  Given this situation
  When I do something
  Then what I get is what I was expecting for 
```

毫无疑问：如果测试通过，您可以断言您正在交付一个工作功能。这就是你可以称之为**商业价值**的东西。

如果你想为你编写一个单元测试，`DoSomething`你应该假装（使用一些模拟）其余的类和方法正在工作（即：该方法使用的所有依赖项都正常工作）并断言你的方法正在工作。

在实践中，您可以执行以下操作：

```
public SomeResults DoSomething(someInput) {
  var someResult = [Do your job with someInput];
  FakeAlwaysWorkingLog.TrackTheFactYouDidYourJob(); // Using a mock Log
  return someResults;
} 
```

您可以使用依赖注入、某些工厂方法或任何 Mock 框架或仅扩展被测类来做到这一点。

假设`Log.DoSomething()`. 幸运的是，Gherkin 规范会找到它，并且您的端到端测试将失败。

该功能不起作用，因为`Log`它被破坏了，而不是因为`[Do your job with someInput]`它没有完成它的工作。而且，顺便说一句，`[Do your job with someInput]`这是该方法的唯一责任。

另外，假设`Log`用于 100 个其他功能，100 个其他类的 100 个其他方法。

是的，100 个功能会失败。但是，幸运的是，100 次端到端测试也失败了，并揭示了问题所在。而且，是的：**他们说的是实话**。

这是非常有用的信息：我知道我的产品坏了。这也是非常令人困惑的信息：它没有告诉我问题出在哪里。它告诉我的是症状，而不是根本原因。

然而，`DoSomething`的单元测试是绿色的，因为它使用了一个假的`Log`，构建为永不中断。而且，是**的：这显然是在撒谎**。它正在传达一个损坏的功能正在工作。怎么可能有用？

（如果`DoSomething()`的单元测试失败，请确保：`[Do your job with someInput]`有一些错误。）

假设这是一个类损坏的系统： ![一个有损坏类的系统](../Images/0847222665bae5c5a8844966f473d53d.png)

一个错误会破坏几个功能，并且几个集成测试会失败。

![一个 bug 会破坏几个特性，几个集成测试会失败](../Images/265e699eeb510d02e6082fe8fe2d7a62.png)

另一方面，同样的错误只会破坏一个单元测试。

![相同的错误只会破坏一个单元测试](../Images/bccf57abbd6c66a79b7144d3ca0dfbe5.png)

现在，比较这两种情况。

同样的错误只会破坏一个单元测试。

*   您使用损坏的所有功能`Log`都是红色的
*   你所有的单元测试都是绿色的，只有单元测试`Log`是红色的

实际上，使用损坏功能的所有模块的单元测试都是绿色的，因为通过使用模拟，它们删除了依赖项。换句话说，它们运行在一个理想的、完全虚构的世界中。这是隔离错误并寻找它们的唯一方法。单元测试意味着模拟。如果你不嘲笑，你就不是单元测试。

## 区别

集成测试告诉**我们什么**是行不通的。但是它们对于**猜测**问题可能出在哪里是没有用的。

单元测试是唯一能告诉你错误**到底在哪里**的测试。要获取此信息，他们必须在模拟环境中运行该方法，其中所有其他依赖项都应该正确工作。

这就是为什么我认为你的句子“或者它只是一个跨越 2 个类的单元测试”在某种程度上被取代了。单元测试不应该跨越 2 个类。

这个回复基本上是我在这里写的总结：[单元测试撒谎，这就是我喜欢它们的原因](http://arialdomartini.wordpress.com/2011/10/21/unit-tests-lie-thats-why-i-love-them/)。

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2008-09-01T19:33:42.823

当我编写单元测试时，我通过模拟依赖项将正在测试的代码范围限制在我当前正在编写的类中。如果我正在编写一个 Sentence 类，并且 Sentence 依赖于 Word，我将使用模拟 Word。通过模拟 Word，我可以只关注它的界面并测试我的 Sentence 类在与 Word 的界面交互时的各种行为。这样我只测试 Sentence 的行为和实现，而不是同时测试 Word 的实现。

一旦我编写了单元测试以确保 Sentence 在基于 Word 的界面与 Word 交互时行为正确，然后我编写集成测试以确保我对交互的假设是正确的。为此，我提供了实际对象并编写了一个测试，该测试将使用最终将使用 Sentence 和 Word 的功能。

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2008-08-14T08:59:28.557

我的 10 位 :D

我总是被告知，**单元测试**是对*单个组件*的测试——应该充分利用它。现在，这往往有很多层次，因为大多数组件都是由较小的部分组成的。对我来说，一个*单元*是系统的一个功能部分。所以它必须提供一些有价值的东西（即不是字符串解析的方法，但可能是*HtmlSanitizer*）。

**集成测试**是下一步，它采用一个或多个组件并确保它们按应有的方式协同工作。然后，您不必担心组件*如何*单独工作，但是当您在*HtmlEditControl*中输入 html 时，它不知何故神奇地知道它是否有效..

虽然它是一条真正的可移动线..我宁愿更多地专注于让该死的代码完全停止工作^_^

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2019-07-31T05:28:36.733

在单元测试中，您测试隔离的每个部分： [![在此处输入图像描述](../Images/cdec6222406149be7a7e055d43066e64.png)](https://i.stack.imgur.com/bmhZg.jpg)

在集成测试中，您测试系统的许多模块：

[![在此处输入图像描述](../Images/b051313cb555306b85eda8f6d3fa66f6.png)](https://i.stack.imgur.com/v186T.jpg)

当您只使用单元测试时会发生这种情况（通常两个窗口都在工作，不幸的是不能一起工作）：

[![在此处输入图像描述](../Images/3da72911d82c82a14c46a022429caab0.png)](https://i.stack.imgur.com/yHGn1.gif)

来源：来源 [1来源](https://dariuszwozniak.net/posts/kurs-tdd-2-testy-jednostkowe-a-testy-integracyjne/) [2](http://softwaretestingfundamentals.com/integration-testing/)

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-08-03T17:07:18.523

**单元测试使用模拟**

您正在谈论的是集成测试，它实际上测试了您系统的整个集成。但是当您进行单元测试时，您实际上应该分别测试每个单元。其他一切都应该被嘲笑。所以在你的`Sentence`类的情况下，如果它使用`Word`类，那么你的`Word`类应该被嘲笑。这样，您将只测试您的`Sentence`类功能。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2008-08-14T06:34:05.853

我认为当您开始考虑集成测试时，您更多地是在谈论物理层而不是逻辑层之间的交叉。

例如，如果您的测试涉及生成内容，那么它就是一个单元测试：如果您的测试只涉及写入磁盘，它仍然是一个单元测试，但是一旦您测试了 I/O 和文件的内容，然后你有自己的集成测试。当您在服务中测试函数的输出时，它是一个单元测试，但是一旦您进行服务调用并查看函数结果是否相同，那么这就是一个集成测试。

从技术上讲，无论如何您都不能只对一类进行单元测试。如果您的班级由其他几个班级组成怎么办？这会自动使其成为集成测试吗？我不这么认为。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2008-08-14T06:32:30.317

采用单一职责设计，黑白分明。不止一个责任，它是一个集成测试。

通过鸭子测试（看起来，嘎嘎，蹒跚，它是一只鸭子），它只是一个单元测试，其中包含超过 1 个新对象。

当您进入 mvc 并对其进行测试时，控制器测试始终是集成的，因为控制器包含模型单元和视图单元。在该模型中测试逻辑，我称之为单元测试。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2013-07-21T00:00:53.987

在我看来，答案是“为什么重要？”

是因为单元测试是你做的，而集成测试是你不做的吗？或相反亦然？当然不是，你应该尝试两者都做。

是因为单元测试需要快速、隔离、可重复、自我验证和及时，而集成测试不应该？当然不是，所有的测试都应该是这些。

这是因为您在单元测试中使用了模拟，但您没有在集成测试中使用它们？当然不是。这意味着如果我有一个有用的集成测试，我不允许为某些部分添加模拟，担心我不得不将我的测试重命名为“单元测试”或将它交给另一个程序员来处理。

是因为单元测试测试一个单元而集成测试测试多个单元吗？当然不是。这有什么实际意义？无论如何，关于测试范围的理论讨论在实践中都失败了，因为“单元”一词完全取决于上下文。在类级别，一个单元可能是一个方法。在装配级别，一个单元可能是一个类，而在服务级别，一个单元可能是一个组件。甚至类都使用其他类，那么哪个是单位？

这无关紧要。

测试很重要，FIRST 很重要，对定义争论不休是浪费时间，只会让新手对测试感到困惑。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2014-09-22T14:49:20.580

# 测试的性质

模块 X的**单元测试**是一种仅在模块 X 中预期（并检查）问题的测试。

许多模块的**集成测试**是一种预期模块*之间*的协作会出现问题的测试，因此单独使用单元测试很难发现这些问题。

用以下术语考虑测试的性质：

*   **降低风险**：这就是测试的目的。只有*单元测试和集成测试的组合*才能完全降低风险，因为一方面单元测试本身不能测试模块之间的正确交互，另一方面集成测试只能行使非平凡模块的功能在很小的程度上。
*   **测试编写工作**：集成测试可以节省工作量，因为您可能不需要编写存根/伪造/模拟。但是，在实现（和维护！）这些存根/伪造/模拟时，单元测试也可以节省工作量，这比在没有它们的情况下配置测试设置更容易。
*   **测试执行延迟**：涉及重量级操作（例如访问数据库或远程服务器等外部系统）的集成测试往往很慢（呃）。这意味着可以更频繁地执行单元测试，从而在任何失败时减少调试工作，因为您可以更好地了解在此期间所做的更改。如果您使用测试驱动开发 (TDD)，这一点变得尤为重要。
*   **调试工作**：如果集成测试失败，但没有一个单元测试失败，这可能非常不方便，因为涉及的代码太多*可能*包含问题。如果您之前只更改了几行，这不是一个大问题——但由于集成测试运行缓慢，您可能没有*在*如此短的时间间隔内运行它们......

请记住，集成测试可能仍会存根/伪造/模拟它的*一些*依赖项。这在单元测试和系统测试（最全面的集成测试，测试所有系统）之间提供了大量的中间地带。

## 实用的方法来使用两者

所以一个务实的方法是：尽可能灵活地依赖集成测试，并在风险太大或不方便的地方使用单元测试。这种思维方式可能比单元测试和集成测试的一些教条区分更有用。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-08-14T06:37:17.407

我认为我仍然会将几个交互类称为单元测试，前提是 class1 的单元测试正在测试 class1 的功能，而 class2 的单元测试正在测试其功能，并且它们没有访问数据库。

当测试通过我的大部分堆栈甚至命中数据库时，我将测试称为集成测试。

我真的很喜欢这个问题，因为 TDD 讨论有时对我来说有点过于纯粹，看到一些具体的例子对我有好处。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-08-14T06:47:54.093

我也这样做——我把它们都称为单元测试，但在某些时候我有一个“单元测试”，它涵盖了这么多，我经常将它重命名为“..IntegrationTest”——只是一个名称的改变，没有其他改变。

我认为从“原子测试”（测试一个小类或一种方法）到单元测试（类级别）和集成测试 - 然后是功能测试（通常从上到下涵盖更多内容） - 似乎没有一个干净的切断。

如果您的测试设置了数据，并且可能加载了数据库/文件等，那么它可能更像是一个集成测试（集成测试我发现使用较少的模拟和更多的真实类，但这并不意味着您不能模拟一些系统）。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-08-14T10:26:18.613

[单元测试](http://en.wikipedia.org/wiki/Unit_testing)是一种测试方法，用于验证源代码的各个单元是否正常工作。

[集成测试](http://en.wikipedia.org/wiki/Integration_testing)是软件测试的阶段，其中将各个软件模块组合在一起并作为一个组进行测试。

[Wikipedia](http://en.wikipedia.org/wiki/Unit_testing)将单元定义为应用程序的最小可测试部分，在 Java/C# 中它是一种方法。但是在您的 Word 和 Sentence 类示例中，我可能只会为句子编写测试，因为我可能会发现使用[模拟](http://en.wikipedia.org/wiki/Mock_object)词类来测试句子类有点矫枉过正。所以句子将是我的单位，而单词是该单位的实现细节。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2012-07-13T18:56:23.410

集成测试：测试数据库持久性。
单元测试：模拟数据库访问。测试代码方法。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-08-14T06:36:58.140

如果您愿意，单元测试是针对工作单元或代码块进行测试。通常由单个开发人员执行。

集成测试是指当开发人员将他们的代码提交到源代码控制存储库时，最好在集成服务器上执行的测试。集成测试可能由 Cruise Control 等实用程序执行。

因此，您进行单元测试以验证您构建的工作单元是否正常工作，然后集成测试验证您添加到存储库的任何内容都没有破坏其他内容。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-08-14T12:19:55.603

我将那些白盒测试类的测试称为单元测试。类所需的任何依赖项都被替换为假的（模拟）。

集成测试是同时测试多个类及其交互的那些测试。在这些情况下，只有一些依赖项被伪造/模拟。

我不会调用 Controller 的集成测试，除非它们的依赖项之一是真实的（即不是伪造的）（例如 IFormsAuthentication）。

分离两种类型的测试对于在不同级别测试系统很有用。此外，集成测试往往寿命很长，单元测试应该很快。执行速度的区别意味着它们的执行方式不同。在我们的开发流程中，单元测试在签入时运行（这很好，因为它们非常快），集成测试每天运行一次/两次。我尝试尽可能多地运行集成测试，但通常会访问数据库/写入文件/使 rpc/etc 变慢。

这提出了另一个重要的观点，单元测试应该避免碰到 IO（例如磁盘、网络、数据库）。否则他们会慢很多。设计这些 IO 依赖项需要一些努力——我不能承认我一直忠实于“单元测试必须快速”的规则，但如果你这样做了，那么在更大的系统上的好处会很快变得明显.

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-12-06T00:58:19.397

## 类比的简单解释

上面的例子做得很好，我不需要重复它们。因此，我将专注于使用示例来帮助您理解。

### 集成测试

集成测试检查一切是否协同工作。想象一下手表中的一系列齿轮一起工作。集成测试将是：手表显示的时间是否正确？3天后它仍然告诉正确的时间吗？

它告诉你的只是整个作品是否有效。如果失败：它不会准确地告诉你失败的地方。

### 单元测试

这些确实是特定类型的测试。它们会告诉您一件特定的事情是有效还是失败。这种测试的关键是它只测试一个特定的东西，同时假设其他一切都很好。这是关键点。

*示例：* 让我们通过一个示例来详细说明这一点：

*   让我们以汽车为例。
*   **汽车的集成**测试：例如，汽车是否开往 Woop Woop 并返回？如果它这样做，您可以肯定地说汽车从整体角度来看正在工作。这是一个集成测试。如果它失败了，你不知道它实际上在哪里失败：是散热器、变速箱、发动机还是化油器？你不知道。它可以是任何东西。
*   **汽车的单元测试**：引擎是否在工作？该测试假定汽车中的其他一切工作正常。这样，如果这个特定的单元测试失败：您可以非常确信问题出在引擎上——因此您可以快速隔离并修复问题。

### 使用存根

*   假设您的汽车集成测试失败。它没有成功开往伊丘卡。问题出在哪里？

*   现在让我们假设您的发动机使用了特殊的燃油喷射系统，并且该发动机单元测试也失败了。换句话说，集成测试和引擎单元测试都失败了。那么问题出在哪里？（给自己 10 秒的时间来得到答案。）

*   是发动机的问题，还是燃油喷射系统的问题？

你看到这里的问题了吗？你不知道到底是什么失败了。如果您使用不同的外部依赖项，那么这 10 个中的每一个都可能导致问题 - 您将不知道从哪里开始。这就是为什么单元测试使用存根来假设其他一切工作正常。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-25T09:37:29.267

> 这些测试是否本质上成为集成测试，因为它们现在测试这两个类的集成？或者它只是一个跨越 2 个类的单元测试？

我认为是的，是的。跨越 2 个类的单元测试变成了集成测试。

您可以通过使用模拟实现（MockWord 类）测试 Sentence 类来避免这种情况，当系统的这些部分大到足以由不同的开发人员实现时，这一点很重要。在这种情况下，Word 单独进行单元测试，Sentence 在 MockWord 的帮助下进行单元测试，然后 Sentence 与 Word 进行集成测试。

实际差异的示例如下 1) 1,000,000 个元素的数组很容易进行单元测试并且工作正常。2) BubbleSort 很容易在 10 个元素的模拟数组上进行单元测试，并且工作正常 3) 集成测试表明有些东西不太好。

如果这些部分是单人开发的，在单元测试 BubbleSoft 的时候很可能会发现问题，因为开发者已经有了真正的数组，不需要 mock 实现。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-08-14T06:37:59.870

这个问题有点学术，不是吗？;-) 我的观点：对我来说，集成测试是对整个部分的测试，而不是十分之二的部分一起进行的测试。我们的集成测试表明，如果主构建（包含 40 个项目）将成功。对于这些项目，我们有大量的单元测试。对我来说，关于单元测试最重要的一点是，一个单元测试不能依赖于另一个单元测试。所以对我来说，你上面描述的两个测试都是单元测试，如果它们是独立的。对于集成测试，这并不重要。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2013-09-10T17:12:33.200

此外，重要的是要记住，单元测试和集成测试都可以使用例如 JUnit 来自动化和编写。在 JUnit 集成测试中，可以使用`org.junit.Assume`该类来测试环境元素（例如，数据库连接）或其他条件的可用性。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-11-02T17:08:54.510

如果您是 TDD 纯粹主义者，那么您会在编写生产代码之前编写测试。当然，测试不会编译，所以你先让测试编译，然后让测试通过。

您可以通过单元测试来做到这一点，但不能通过集成或验收测试来做到这一点。如果您尝试使用集成测试，那么在您完成之前，什么都不会编译！

# asp.net - 将 asp.net 应用程序转换为 IIS7 集成模式

> ID：10782
> 
> 赞同：2
> 
> 时间：2008-08-14T07:21:12.653
> 
> 标签：asp.net, iis-7, .net-2.0

为了将 asp.net 2 应用程序从 IIS7 经典模式转换为集成模式，我需要执行哪些步骤？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-08-14T07:34:47.073

这是一个过程： [Rick Strahl 的博客](http://www.west-wind.com/WebLog/posts/6075.aspx)

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2008-08-20T12:52:19.827

真的没什么。ASP.NET 2.0 应用程序将像在 IIS 6.0 中一样运行。如果您想利用任何新功能，那么您只需要更新您的代码。但除非您更改响应标头的结构或拦截其他应用程序的请求，否则您可能不需要做任何事情。

# asp.net - 在 ASP.NET 用户控件中捕获未处理的异常

> ID：10793
> 
> 赞同：5
> 
> 时间：2008-08-14T08:06:59.457
> 
> 标签：asp.net, exception, user-controls

我正在动态加载用户控件，将它们添加到 Web 表单的 Controls 集合中。

如果用户控件在渲染时导致未处理的异常，我想隐藏它们。

因此，我尝试连接到每个 UserControl 的 Error 事件，但似乎该事件永远不会像对 Page 类那样为 UserControls 触发。

做了一些谷歌搜索，它似乎并不乐观。这里有什么想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-08-15T07:49:57.927

mmilic，继[您对](https://stackoverflow.com/questions/10793/catching-unhandled-exceptions-in-aspnet-usercontrols#10910)我[之前想法](https://stackoverflow.com/questions/10793/catching-unhandled-exceptions-in-aspnet-usercontrols#10815)的回应之后..

不需要额外的逻辑！这就是重点，您对有问题的类什么都不做，只是将它们包装在一些实例化气泡包装中！:)

好的，我打算只是要点，但我想亲眼看看这个工作，所以我拼凑了一些*非常*粗略的代码，但这个概念就在那里，而且它似乎工作。

**为长篇道歉**

## 安全加载器

这基本上就是我提到的“气泡”。它将获取控件 HTML，捕获渲染期间发生的任何错误。

```
public class SafeLoader
{
    public static string LoadControl(Control ctl)
    {
        // In terms of what we could do here, its down
        // to you, I will just return some basic HTML saying
        // I screwed up.
        try
        {
            // Get the Controls HTML (which may throw)
            // And store it in our own writer away from the
            // actual Live page.
            StringWriter writer = new StringWriter();
            HtmlTextWriter htmlWriter = new HtmlTextWriter(writer);
            ctl.RenderControl(htmlWriter);

            return writer.GetStringBuilder().ToString();
        }
        catch (Exception)
        {
            string ctlType = ctl.GetType().Name;
            return "<span style=\"color: red; font-weight:bold; font-size: smaller;\">" + 
                "Rob + Controls = FAIL (" + 
                ctlType + " rendering failed) Sad face :(</span>";
        }
    }
} 
```

## 还有一些控件..

好的，我只是在这里模拟了两个控件，一个会抛出另一个会渲染垃圾。点这里，我不废话。这些将替换为您的自定义控件..

### 坏控制

```
public class BadControl : WebControl
{
    protected override void Render(HtmlTextWriter writer)
    {
        throw new ApplicationException("Rob can't program controls");
    }
} 
```

### 好控制

```
public class GoodControl : WebControl
{
    protected override void Render(HtmlTextWriter writer)
    {
        writer.Write("<b>Holy crap this control works</b>");
    }
} 
```

## 这页纸

好的，让我们看一下“测试”页面。这里我只是简单地实例化控件，获取它们的 html 并输出它，我将继续思考设计器支持等。

### 页面代码隐藏

```
 protected void Page_Load(object sender, EventArgs e)
    {
        // Create some controls (BadControl will throw)
        string goodHtml = SafeLoader.LoadControl(new BadControl());
        Response.Write(goodHtml);

        string badHtml = SafeLoader.LoadControl(new GoodControl());
        Response.Write(badHtml);
    } 
```

### 想法

好的，我知道你在想什么，“这些控件是以编程方式实例化的，设计师支持呢？我花了好几个小时让这些控件对设计师来说很好，现在你在搞乱我的魔力”。

好的，所以我还没有真正测试过这个（可能会在几分钟内完成！）但这里的想法是覆盖页面的 CreateChildControls 方法，并获取表单上添加的每个控件的实例并通过 SafeLoader 运行它。如果代码通过，您可以像往常一样将它添加到 Controls 集合中，如果没有，那么您可以创建错误的文字或其他内容，这取决于您我的朋友。

## 最后..

再说一次，很抱歉这篇长文，但我想在这里获取代码，以便我们讨论这个:) 我希望这有助于证明我的想法 :)

## 更新

通过在设计器上插入一个控件并用它覆盖 CreateChildControls 方法进行测试，工作正常，可能需要一些清理以使事情看起来更好，但我会把它留给你；）

```
protected override void CreateChildControls()
{
    // Pass each control through the Loader to check
    // its not lame
    foreach (Control ctl in Controls)
    {
        string s = SafeLoader.LoadControl(ctl);
        // If its bad, smack it downnnn!
        if (s == string.Empty)
        {
            ctl.Visible = false; // Prevent Rendering
            string ctlType = ctl.GetType().Name;
            Response.Write("<b>Problem Occurred Rendering " + 
                ctlType + " '" + ctl.ID + "'.</b>");
        }
    }
} 
```

享受！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-08-14T08:51:47.853

这是一个有趣的问题.. 在自定义控件等方面我仍然很新鲜，但这是我的想法（请随意评论/纠正人！）..（我有点想/在这里大声写出来！）

*   如果在渲染过程中出现错误，在某些情况下，会不会太晚了？（因为某些控件 HTML 可能已经发送到 Writer 并输出）。
*   因此，最好包装用户控件的 Render 方法，而不是将其传递给“实时”HtmlTextWriter 的引用，而是传递自己的，捕获在这个小安全“气泡”中引发的任何异常，如果一切顺利的话，然后将生成的 HTML 传递给实际的 HtmlTextWriter？
*   这个逻辑可能会被挂在一个通用的包装类中，你可以用它在运行时动态加载/渲染控件。
*   如果确实发生任何错误，您可以使用所有需要的信息！（即控制参考等）。

只是我的想法，火焰消失！:D ;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-14T11:56:38.053

根据您的错误发生的位置，您可以执行类似...

```
public abstract class SilentErrorControl : UserControl
{
    protected override void Render( HtmlTextWriter writer )
    {
        //call the base's render method, but with a try catch
        try { base.Render( writer ); }
        catch ( Exception ex ) { /*do nothing*/ }
    }
} 
```

然后继承 SilentErrorControl 而不是 UserControl。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-08-14T08:11:14.503

Global.asax 和 Application_Error？

[http://www.15seconds.com/issue/030102.htm](http://www.15seconds.com/issue/030102.htm)

或仅在单个页面上的 Page_Error 事件：

[http://support.microsoft.com/kb/306355](http://support.microsoft.com/kb/306355)

```
void Page_Load(object sender, System.EventArgs e)
{
    throw(new ArgumentNullException());
}

public void Page_Error(object sender,EventArgs e)
{
    Exception objErr = Server.GetLastError().GetBaseException();
    string err =    "<b>Error Caught in Page_Error event</b><hr><br>" + 
                    "<br><b>Error in: </b>" + Request.Url.ToString() +
                    "<br><b>Error Message: </b>" + objErr.Message.ToString()+
                    "<br><b>Stack Trace:</b><br>" + 
                      objErr.StackTrace.ToString();
    Response.Write(err.ToString());
    Server.ClearError();
} 
```

此外，Karl Seguin（嗨，Karl！）有一篇关于使用 HttpHandler 的帖子：

[http://codebetter.com/blogs/karlseguin/archive/2006/06/12/146356.aspx](http://codebetter.com/blogs/karlseguin/archive/2006/06/12/146356.aspx)

（不确定复制它的权限，但如果你想写一个答案，你得到了我的支持☺）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-14T08:42:16.733

如何添加一个新的 UserControl 子类来错误处理其渲染和加载方法（以便它们按您的意愿隐藏），然后为您的用户控件继承它？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-08-20T12:59:40.653

我不确定我是否理解[您的回复](https://stackoverflow.com/questions/10793/catching-unhandled-exceptions-in-aspnet-usercontrols#15999)。您如何加载控件并将它们添加到控件集合中？

这就是“更新”部分中添加的部分的全部意义。您可以灵活地在任何地方使用*SafeLoader*。

我不知道为什么你觉得你没有对 Html 的访问/控制？SafeLoader 的目标是您不*关心*html 是什么，您只需尝试“输出”控件（在“气泡”内）并确定它是否在当前状态下加载正常。

如果确实如此（即返回 html），那么您可以用它做您喜欢的事情，输出 html，将控件添加到控件集合中，等等！

如果没有，那么你可以做你喜欢的事，呈现错误消息，抛出自定义异常。选择是你的！

我希望这有助于为您澄清事情，如果没有，请大喊：）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-08T18:32:52.790

我使用了@Keith 的方法，但问题是控件会一直渲染，直到抛出异常，这可能会导致打开的 HTML 标记。如果处于调试模式，我还将在控件中呈现异常信息。

```
 protected override void Render(System.Web.UI.HtmlTextWriter writer)
  {
     try
     {
        // Render the module to a local a temporary writer so that if an Exception occurs
        // the control is not halfway rendered - "it is all or nothing" proposition
        System.IO.StringWriter sw = new System.IO.StringWriter();
        System.Web.UI.HtmlTextWriter htw = new System.Web.UI.HtmlTextWriter(sw);
        base.Render(htw);

        // We made it!  Copy the Control Render over
        writer.Write(sw.GetStringBuilder().ToString());
     }
     catch (System.Exception ex)
     {
        string message = string.Format("Error Rendering Control {0}\n", ID);
        Log.Error(message, ex);
        if (Page.IsDebug)
           writer.Write(string.Format("{0}<br>Exception:<br><pre>{1}\n{2}</pre>", message, ex.Message, ex.StackTrace));
     }
  } 
```

# asp.net - ASP.NET 网站或 Web 项目

> ID：10798
> 
> 赞同：19
> 
> 时间：2008-08-14T08:14:15.293
> 
> 标签：asp.net, visual-studio, web-site-project, web-application-project

在 Visual Studio 中创建新的 ASP.NET 项目时，我应该选择创建：网站还是项目？

我知道 Web 应用程序项目是过去使用 VS 2003 实现它的方式，但它今天仍然适用吗？使用其中一个有哪些注意事项？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-08-14T08:18:23.177

MSDN 上有一个[很好的比较图](http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx#wapp_topic5)。

网站项目很简单，因为添加到项目文件夹的所有文件都会自动编译和包含，据说是为了使其更适合经典的 ASP 和 PHP 开发人员。一个好处是它包含构建提供程序，它允许将某些操作与文件类型相关联——当您将 .abp 文件添加到站点时，这就是 SubSonic 的第一个版本将如何重建数据访问层。

不过，Web 应用程序项目要灵活得多。例如，网站项目中的所有类库都需要在 App_Code 文件夹中，这在复杂的应用程序中令人沮丧。有很多场景不适用于网站项目。

您可以从一个转换到另一个，但如果您不确定，我建议您从 Web 应用程序开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T23:10:49.510

我强烈不同意[网站和网络项目](http://igurr.com/blogs/programming/archive/2009/03/25/websites-and-web-projects.aspx)文章所说的一些内容。

首先，不是任何“小”开发者群体反抗——我建议是我们大多数人，他们没有被问到我们是否想完全改变我们的开发方式。他们当然没有问我是否想浪费六周的开发时间来弄清楚他们做了什么来破坏一个完美的网络服务。

这不是一些“下载”MS 发布的——它是 VS2005 SP1，他们发布得非常快。

在他们的无项目开发中，“复制项目”命令效果很好，我们不必避免调试或项目文件；您可以移动页面 - 如果您不使用源代码管理；他们从哪里得知您必须锁定项目文件才能进行协作？他们用什么来控制源代码？

我还要在辩论中添加一个问题：网站有什么特别之处，以至于它们应该是唯一不使用“项目”文件的“项目”类型（据我所知）？我什么都想不出来，除非是微软认为 Web 开发人员头脑太简单，无法理解项目。

当然，如果有人知道任何其他不使用项目文件的 Visual Studio“项目”类型，我将不胜感激。

# ruby-on-rails - Ruby mixins 和调用超级方法

> ID：10808
> 
> 赞同：35
> 
> 时间：2008-08-14T08:30:27.570
> 
> 标签：ruby-on-rails, ruby

好的，所以我一直在我的小 Rails 应用程序中重构我的代码，以消除重复，总的来说让我的生活更轻松（因为我喜欢轻松的生活）。这种重构的一部分是将我的两个模型共有的代码移动到我可以包含在我需要的地方的模块中。

到现在为止还挺好。看起来它会成功，但我刚刚遇到了一个我不知道如何解决的问题。该模块（我称之为可发送的）只是处理传真、电子邮件或打印文档 PDF 的代码。因此，例如，我有一个采购订单，我有内部销售订单（想象地缩写为 ISO）。

我遇到的问题是，我希望在加载对象后初始化一些变量（为拼写不正确的人初始化 :P ），所以我一直在使用**after_initialize**钩子。没问题......直到我开始添加更多的mixin。

我遇到的问题是，我可以在我的**`after_initialize`**任何一个 mixin 中都有一个，所以我需要在开始时包含一个**super**调用以确保调用其他 mixin**`after_initialize`**调用。太好了，直到我最终调用 super 并且我得到一个错误，因为没有 super 可以调用。

这是一个小例子，以防我不够混乱：

```
class Iso < ActiveRecord::Base
  include Shared::TracksSerialNumberExtension
  include Shared::OrderLines
  extend  Shared::Filtered
  include Sendable::Model

  validates_presence_of   :customer
  validates_associated    :lines

  owned_by                :customer
  order_lines             :despatched # Mixin

  tracks_serial_numbers   :items  # Mixin

  sendable :customer                      # Mixin

  attr_accessor :address

  def initialize( params = nil )
    super
    self.created_at ||= Time.now.to_date
  end
end 
```

那么，如果每个 mixin 都有一个 after_initialize 调用，以及一个**super**调用，我怎样才能阻止最后一个**super**调用引发错误？如何在调用之前测试超级方法是否存在？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2010-10-05T20:34:17.547

你可以使用这个：

```
super if defined?(super) 
```

这是一个例子：

```
class A
end

class B < A
  def t
    super if defined?(super)
    puts "Hi from B"
  end
end

B.new.t 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-08-14T22:37:56.463

你试过`alias_method_chain`吗？您基本上可以将所有`after_initialize`电话链接起来。它就像一个装饰器：每个新方法都会添加一个新的功能层，并将控制权传递给“覆盖”的方法来完成其余的工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-08-15T01:28:04.920

包含类（从 继承的东西`ActiveRecord::Base`，在这种情况下是`Iso`）*可以*定义自己的，因此除了（或保存原始的其他别名）之外的`after_initialize`任何解决方案都有覆盖代码的风险。`alias_method_chain`@Orion Edwards 的解决方案是我能想到的最好的解决方案。还有其他的，但它们**更**骇人听闻。

`alias_method_chain`还具有创建 after_initialize 方法的命名版本的好处，这意味着您可以在重要的罕见情况下自定义调用顺序。否则，您将受包含类包含混入的任何顺序的支配。

*后来*：

我已经向 ruby​​-on-rails-core 邮件列表发布了一个关于创建所有回调的默认空实现的问题。无论如何，保存过程都会检查它们，所以我不明白为什么它们不应该在那里。唯一的缺点是创建额外的空堆栈帧，但这在每个已知的实现中都相当便宜。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-25T06:53:52.397

你可以在那里抛出一个快速的条件：

```
super if respond_to?('super') 
```

你应该没问题 - 不要添加无用的方法；干净整洁。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-14T21:30:58.813

而不是检查超级方法是否存在，您可以定义它

```
class ActiveRecord::Base
    def after_initialize
    end
end 
```

这在我的测试中有效，并且不应破坏您现有的任何代码，因为定义它的所有其他类无论如何都会默默地覆盖此方法

# c# - 为什么调用 AzMan 时出现“无法更新密码”错误？

> ID：10810
> 
> 赞同：4
> 
> 时间：2008-08-14T08:38:24.760
> 
> 标签：c#, winforms, authorization, adam, azman

我正在企业库中的 AzMan 授权提供程序的帮助下从 WinForms 应用程序进行授权检查，并且收到以下错误：

> 无法更新密码。作为当前密码提供的值不正确。（来自 HRESULT 的异常：0x8007052B）（Microsoft.Practices.EnterpriseLibrary.Security.AzMan）
> 
> * * *
> 
> 无法更新密码。作为当前密码提供的值不正确。（来自 HRESULT 的异常：0x8007052B）（Microsoft.Interop.Security.AzRoles）

AzMan 商店托管在同一域中另一台计算机上的 ADAM 中。其他电脑和用户没有这个问题。进行调用的用户具有对 ADAM 和 AzMan 存储的读取权限。运行 WinForms 应用程序的计算机和运行 ADAM 的计算机都在 Windows XP SP2 上。

在解决之前我遇到过 AzMan 的访问问题，但这是一个新问题……我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-08-14T14:34:30.030

`web.config`对于带有 ASP.NET 的 AzMan，在( )中打开模拟`<identity impersonate="true" username="xx" pasword="xx" />`，并与 AD 管理员一起确保模拟帐户对 AzMan 商店具有“读者”权限；`Temporary ASP.NET Files`另外，在文件夹中授予此帐户的写入权限（在 下`C:\Windows\Microsoft.NET\<framework>`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-08-15T09:44:36.773

我从事件日志中发现，用户从远程计算机调用 AzMan 存在安全问题。用户不属于运行 ADAM/AzMan 的计算机上的本地用户组。当我纠正一切都再次起作用时。

# sql - SQL，数字辅助表

> ID：10819
> 
> 赞同：59
> 
> 时间：2008-08-14T09:01:37.663
> 
> 标签：sql, sql-server

对于某些类型的 sql 查询，辅助数字表可能非常有用。它可以创建为包含特定任务所需行数的表，也可以创建为返回每个查询所需行数的用户定义函数。

创建这样一个函数的最佳方法是什么？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2010-04-18T17:44:31.607

嘿...对不起，我这么晚才回复旧帖子。而且，是的，我必须做出回应，因为该线程上最受欢迎的答案（当时，带有指向 14 种不同方法的链接的递归 CTE 答案）是，嗯......性能充其量是挑战。

首先，包含 14 种不同解决方案的文章非常适合查看动态创建 Numbers/Tally 表的不同方法，但正如文章和引用的线程中所指出的，有一个*非常*重要的引用......

> “关于效率和性能的建议通常是主观的。无论如何使用查询，物理实现都决定了查询的效率。因此，不要依赖有偏见的指导方针，而是必须测试查询并确定哪一个表现更好。”

具有讽刺意味的是，这篇文章本身包含许多主观陈述和“有偏见的指导方针”，例如“递归 CTE 可以***非常有效地****生成数字列表”***和*“这是使用 Itzik Ben-Gen 发布的新闻组中的 WHILE 循环**的有效方法***” （我敢肯定他只是为了比较而发布的）。来吧，伙计们......仅仅提到Itzik的好名字可能会导致一些可怜的懒汉实际使用这种可怕的方法。作者应该实践他所宣扬的内容，并且应该在做出如此荒谬的错误陈述之前进行一些性能测试，尤其是在面对任何可扩展性时。**

 **考虑到在对任何代码的功能或某人“喜欢”什么做出任何主观主张之前实际进行一些测试，这里有一些代码您可以自己进行测试。为您运行测试的 SPID 设置分析器并亲自检查...只需为您的“最喜欢”号码执行数字 1000000 的“Search'n'Replace”并查看...

```
--===== Test for 1000000 rows ==================================
GO
--===== Traditional RECURSIVE CTE method
   WITH Tally (N) AS 
        ( 
         SELECT 1 UNION ALL 
         SELECT 1 + N FROM Tally WHERE N < 1000000 
        ) 
 SELECT N 
   INTO #Tally1 
   FROM Tally 
 OPTION (MAXRECURSION 0);
GO
--===== Traditional WHILE LOOP method
 CREATE TABLE #Tally2 (N INT);
    SET NOCOUNT ON;
DECLARE @Index INT;
    SET @Index = 1;
  WHILE @Index <= 1000000 
  BEGIN 
         INSERT #Tally2 (N) 
         VALUES (@Index);
            SET @Index = @Index + 1;
    END;
GO
--===== Traditional CROSS JOIN table method
 SELECT TOP (1000000)
        ROW_NUMBER() OVER (ORDER BY (SELECT 1)) AS N
   INTO #Tally3
   FROM Master.sys.All_Columns ac1
  CROSS JOIN Master.sys.ALL_Columns ac2;
GO
--===== Itzik's CROSS JOINED CTE method
   WITH E00(N) AS (SELECT 1 UNION ALL SELECT 1),
        E02(N) AS (SELECT 1 FROM E00 a, E00 b),
        E04(N) AS (SELECT 1 FROM E02 a, E02 b),
        E08(N) AS (SELECT 1 FROM E04 a, E04 b),
        E16(N) AS (SELECT 1 FROM E08 a, E08 b),
        E32(N) AS (SELECT 1 FROM E16 a, E16 b),
   cteTally(N) AS (SELECT ROW_NUMBER() OVER (ORDER BY N) FROM E32)
 SELECT N
   INTO #Tally4
   FROM cteTally
  WHERE N <= 1000000;
GO
--===== Housekeeping
   DROP TABLE #Tally1, #Tally2, #Tally3, #Tally4;
GO 
```

当我们在这里的时候，这是我从 SQL Profiler 获得的数字，它们的值是 100、1000、10000、100000 和 1000000……

```
SPID TextData                                 Dur(ms) CPU   Reads   Writes
---- ---------------------------------------- ------- ----- ------- ------
  51 --===== Test for 100 rows ==============       8     0       0      0
  51 --===== Traditional RECURSIVE CTE method      16     0     868      0
  51 --===== Traditional WHILE LOOP method CR      73    16     175      2
  51 --===== Traditional CROSS JOIN table met      11     0      80      0
  51 --===== Itzik's CROSS JOINED CTE method        6     0      63      0
  51 --===== Housekeeping   DROP TABLE #Tally      35    31     401      0

  51 --===== Test for 1000 rows =============       0     0       0      0
  51 --===== Traditional RECURSIVE CTE method      47    47    8074      0
  51 --===== Traditional WHILE LOOP method CR      80    78    1085      0
  51 --===== Traditional CROSS JOIN table met       5     0      98      0
  51 --===== Itzik's CROSS JOINED CTE method        2     0      83      0
  51 --===== Housekeeping   DROP TABLE #Tally       6    15     426      0

  51 --===== Test for 10000 rows ============       0     0       0      0
  51 --===== Traditional RECURSIVE CTE method     434   344   80230     10
  51 --===== Traditional WHILE LOOP method CR     671   563   10240      9
  51 --===== Traditional CROSS JOIN table met      25    31     302     15
  51 --===== Itzik's CROSS JOINED CTE method       24     0     192     15
  51 --===== Housekeeping   DROP TABLE #Tally       7    15     531      0

  51 --===== Test for 100000 rows ===========       0     0       0      0
  51 --===== Traditional RECURSIVE CTE method    4143  3813  800260    154
  51 --===== Traditional WHILE LOOP method CR    5820  5547  101380    161
  51 --===== Traditional CROSS JOIN table met     160   140     479    211
  51 --===== Itzik's CROSS JOINED CTE method      153   141     276    204
  51 --===== Housekeeping   DROP TABLE #Tally      10    15     761      0

  51 --===== Test for 1000000 rows ==========       0     0       0      0
  51 --===== Traditional RECURSIVE CTE method   41349 37437 8001048   1601
  51 --===== Traditional WHILE LOOP method CR   59138 56141 1012785   1682
  51 --===== Traditional CROSS JOIN table met    1224  1219    2429   2101
  51 --===== Itzik's CROSS JOINED CTE method     1448  1328    1217   2095
  51 --===== Housekeeping   DROP TABLE #Tally       8     0     415      0 
```

如您所见，**递归 CTE 方法在 Duration 和 CPU 方面仅次于 While 循环，其内存压力是 While 循环的 8 倍**。它是类固醇上的 RBAR，应该不惜一切代价避免任何单行计算，就像应该避免 While 循环一样。 **有些地方递归非常有价值，但这不是其中之一**。

作为一个边栏，Denny 先生绝对是……正确大小的永久数字或 Tally 表是大多数事情的方式。大小合适是什么意思？好吧，大多数人使用 Tally 表来生成日期或在 VARCHAR(8000) 上进行拆分。如果您使用“N”上的正确聚集索引创建一个 11,000 行的 Tally 表，您将有足够的行来创建超过 30 年的日期（我经常使用抵押贷款，所以 30 年对我来说是一个关键数字) 并且肯定足以处理 VARCHAR(8000) 拆分。为什么“正确的尺寸”如此重要？如果 Tally 表被大量使用，它很容易放入缓存中，这使得它非常快，根本不会对内存造成太大压力。

最后但并非最不重要的一点是，每个人都知道，如果您创建一个永久的 Tally 表，那么您使用哪种方法来构建它并不重要，因为 1）它只会制作一次，2）如果它是 11,000 行表，所有方法都将运行“足够好”。 **那么为什么我对使用哪种方法感到愤慨？？？**

答案是，一些不知道更好，只需要完成他或她的工作的可怜人/女孩可能会看到类似递归 CTE 方法的东西，并决定将其用于比建筑更大、更频繁使用的东西一个永久的 Tally 表，我试图**保护这些人，他们的代码运行的服务器，以及拥有这些服务器上数据的公司**。是的……这有什么大不了的。它也应该适用于其他所有人。教导正确的做事方式，而不是“足够好”。在发布或使用帖子或书中的内容之前进行一些测试......事实上，您所拯救的生命可能是您自己的，特别是如果您认为递归 CTE 是实现此类目标的方法。;-)

感谢收听...

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-02T09:48:19.837

最优化的函数是使用表格而不是函数。使用函数会导致额外的 CPU 负载来为返回的数据创建值，尤其是在返回的值覆盖非常大的范围时。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-09-25T19:50:34.407

[本文](http://web.archive.org/web/20120413120912/http://www.projectdmx.com:80/tsql/tblnumbers.aspx)给出了 14 种不同的可能解决方案，并对每种解决方案进行了讨论。重要的一点是：

> 关于效率和性能的建议通常是主观的。无论如何使用查询，物理实现都决定了查询的效率。因此，与其依赖有偏见的指导方针，不如测试查询并确定哪一个表现更好。

我个人喜欢：

```
WITH Nbrs ( n ) AS (
    SELECT 1 UNION ALL
    SELECT 1 + n FROM Nbrs WHERE n < 500 )
SELECT n FROM Nbrs
OPTION ( MAXRECURSION 500 ) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-07-04T12:24:12.060

这个视图超级快并且包含所有正值`int`。

```
CREATE VIEW dbo.Numbers
WITH SCHEMABINDING
AS
    WITH Int1(z) AS (SELECT 0 UNION ALL SELECT 0)
    , Int2(z) AS (SELECT 0 FROM Int1 a CROSS JOIN Int1 b)
    , Int4(z) AS (SELECT 0 FROM Int2 a CROSS JOIN Int2 b)
    , Int8(z) AS (SELECT 0 FROM Int4 a CROSS JOIN Int4 b)
    , Int16(z) AS (SELECT 0 FROM Int8 a CROSS JOIN Int8 b)
    , Int32(z) AS (SELECT TOP 2147483647 0 FROM Int16 a CROSS JOIN Int16 b)
    SELECT ROW_NUMBER() OVER (ORDER BY z) AS n
    FROM Int32
GO 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-05-02T16:29:41.807

`SQL Server 2016+`用于生成数字表，您可以使用`OPENJSON`：

```
-- range from 0 to @max - 1
DECLARE @max INT = 40000;

SELECT rn = CAST([key] AS INT) 
FROM OPENJSON(CONCAT('[1', REPLICATE(CAST(',1' AS VARCHAR(MAX)),@max-1),']')); 
```

`**[`LiveDemo`](https://data.stackexchange.com/stackoverflow/query/481961)**`

* * *

想法取自[How can we use OPENJSON to generate series of numbers?](https://blogs.msdn.microsoft.com/sqlserverstorageengine/2015/11/03/generate-serie-of-numbers-in-sql-server-2016-using-openjson/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-20T09:28:30.397

编辑：见下面康拉德的评论。

Jeff Moden 的回答很棒……但我在 Postgres 上发现 Itzik 方法会失败，除非您删除 E32 行。

在 postgres 上稍微快一点（40ms vs 100ms）是我在[这里](http://www.sqlservercentral.com/articles/T-SQL/67899/)找到的另一种适用于 postgres 的方法：

```
WITH 
    E00 (N) AS ( 
        SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL 
        SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 ),
    E01 (N) AS (SELECT a.N FROM E00 a CROSS JOIN E00 b),
    E02 (N) AS (SELECT a.N FROM E01 a CROSS JOIN E01 b ),
    E03 (N) AS (SELECT a.N FROM E02 a CROSS JOIN E02 b 
        LIMIT 11000  -- end record  11,000 good for 30 yrs dates
    ), -- max is 100,000,000, starts slowing e.g. 1 million 1.5 secs, 2 mil 2.5 secs, 3 mill 4 secs
    Tally (N) as (SELECT row_number() OVER (ORDER BY a.N) FROM E03 a)

SELECT N
FROM Tally 
```

当我从 SQL Server 迁移到 Postgres 世界时，可能错过了在该平台上创建计数表的更好方法...... INTEGER()？顺序（）？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-10-22T10:06:40.443

很久以后，我想贡献一个稍微不同的“传统”CTE（不接触基表来获取行数）：

```
--===== Hans CROSS JOINED CTE method
WITH Numbers_CTE (Digit)
AS
(SELECT 0 UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9)
SELECT HundredThousand.Digit * 100000 + TenThousand.Digit * 10000 + Thousand.Digit * 1000 + Hundred.Digit * 100 + Ten.Digit * 10 + One.Digit AS Number
INTO #Tally5
FROM Numbers_CTE AS One CROSS JOIN Numbers_CTE AS Ten CROSS JOIN Numbers_CTE AS Hundred CROSS JOIN Numbers_CTE AS Thousand CROSS JOIN Numbers_CTE AS TenThousand CROSS JOIN Numbers_CTE AS HundredThousand 
```

此 CTE 执行的 READ 比 Itzik 的 CTE 多，但比传统 CTE 少。 **但是，它始终比其他查询执行更少的 WRITES。** 如您所知，写入始终比读取昂贵得多。

持续时间很大程度上取决于核心数（MAXDOP），但在我的 8core 上，执行速度始终比其他查询更快（以毫秒为单位的持续时间更短）。

我在用：

```
Microsoft SQL Server 2012 - 11.0.5058.0 (X64) 
May 14 2014 18:34:29 
Copyright (c) Microsoft Corporation
Enterprise Edition (64-bit) on Windows NT 6.3 <X64> (Build 9600: ) 
```

在 Windows Server 2012 R2、32 GB、Xeon X3450 @2.67Ghz、4 核 HT 上启用。**

# .net - .NET 的快速数据库访问测试

> ID：10822
> 
> 赞同：5
> 
> 时间：2008-08-14T09:09:52.607
> 
> 标签：.net, database, connection, connection-string

确定您的连接字符串是否允许您连接到数据库的快速方法是什么？

通常，连接尝试会让用户等待很长时间，然后才通知尝试无论如何都是徒劳的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-08-14T09:13:45.797

但是，您还没有提到要连接的数据库。在[SQL Server 2005](http://en.wikipedia.org/wiki/Microsoft_SQL_Server#SQL_Server_2005)中，来自 .NET，您可以在连接字符串中指定连接超时，如下所示：

```
server=<server>;database=<database>;uid=<user>;password=<password>;Connect Timeout=3 
```

这将尝试连接到服务器，如果它在三秒内没有这样做，它将引发超时错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-08-14T09:13:44.143

缩短连接字符串的超时时间并执行一些琐碎的事情。

等待应该与超时大致相同。

不过，您仍然需要一两秒钟。

# sql-server - 将日期字符串与 SQL Server 中的日期时间进行比较？

> ID：10825
> 
> 赞同：50
> 
> 时间：2008-08-14T09:14:07.683
> 
> 标签：sql-server, database, tsql, datetime

在 SQL Server 中，我有一`DATETIME`列包含时间元素。

例子：

```
'14 AUG 2008 14:23:019' 
```

什么是仅选择特定日期的记录而忽略时间部分的**最佳方法？**

示例：（不安全，因为它与时间部分不匹配并且不返回任何行）

```
DECLARE  @p_date DATETIME
SET      @p_date = CONVERT( DATETIME, '14 AUG 2008', 106 )

SELECT *
FROM   table1
WHERE  column_datetime = @p_date 
```

*注意：鉴于这个站点也是关于记下你拿起然后忘记的笔记和技术，我将发布我自己对这个问题的答案，因为 MSSQL 中的 DATETIME 内容可能是我在 SQLBOL 中查找最多的主题。*

* * *

**更新**澄清的例子更具体。

* * *

**编辑**对不起，但我不得不降低错误答案（返回错误结果的答案）。

@Jorrit：`WHERE (date>'20080813' AND date<'20080815')`将返回 13 号和 14 号。

@wearejimbo：*关闭，但没有雪茄！*授予您的徽章。您错过了 2008 年 8 月 14 日 23:59:001 到 23:59:999（即午夜前不到 1 秒）写入的记录。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-08-14T09:16:03.530

技术1：

```
 DECLARE @p_date DATETIME
 SET     @p_date = CONVERT( DATETIME, '14 AUG 2008', 106 )

 SELECT  *
 FROM    table1
 WHERE   column_datetime >= @p_date
 AND     column_datetime < DATEADD(d, 1, @p_date) 
```

这样做的好处是它将使用“column_datetime”上的任何索引（如果存在）。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-08-14T09:42:14.537

在 SQL Server 2008 中，您可以使用新的 DATE 数据类型

```
DECLARE @pDate DATE='2008-08-14'  

SELECT colA, colB
FROM table1
WHERE convert(date, colDateTime) = @pDate 
```

@盖伊。我想你会发现这个解决方案可以很好地扩展。查看原始查询的[查询执行计划](http://cid-936d87e62ae20947.skydrive.live.com/self.aspx/vzczcPublic/Stackoverflow10825Query1.JPG)。

对于[我](http://cid-936d87e62ae20947.skydrive.live.com/self.aspx/vzczcPublic/Stackoverflow10825Query2.JPG)的：

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-08-14T09:19:55.190

只需比较年、月和日的值。

```
Declare @DateToSearch DateTime
Set @DateToSearch = '14 AUG 2008'

SELECT * 
FROM table1
WHERE Year(column_datetime) = Year(@DateToSearch)
      AND Month(column_datetime) = Month(@DateToSearch)
      AND Day(column_datetime) = Day(@DateToSearch) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-08-14T09:19:16.067

技术2：

```
DECLARE @p_date DATETIME
SET     @p_date = CONVERT( DATETIME, '14 AUG 2008', 106 )

SELECT  *
FROM    table1
WHERE   DATEDIFF( d, column_datetime, @p_date ) = 0 
```

如果 column_datetime 字段没有被索引，并且不太可能（或者索引不太可能被使用），那么使用 DATEDIFF() 会更短。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-08-14T09:23:23.390

像这样的东西？

```
SELECT  *
FROM    table1
WHERE   convert(varchar, column_datetime, 111) = '2008/08/14' 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-02-16T07:51:10.160

关于您接受的答案中的索引的要点。

不过，如果您真的只搜索特定`DATE`或`DATE ranges` **经常**搜索，那么我发现的最佳解决方案是向您的表中添加另一个持久计算列，该列仅包含`DATE`, 并在此列上添加索引：

```
ALTER TABLE "table1" 
    ADD "column_date" AS CONVERT(DATE, "column_datetime") PERSISTED 
```

在该列上添加索引：

```
CREATE NONCLUSTERED INDEX "table1_column_date_nu_nci"
ON  "table1" ( "column_date" ASC )
GO 
```

然后你的搜索会更快：

```
DECLARE  @p_date DATE
SET      @p_date = CONVERT( DATE, '14 AUG 2008', 106 )

SELECT   *
FROM     table1
WHERE    column_date = @p_date 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-02-24T22:53:56.713

我通常将日期时间转换为日期并进行比较，如下所示：

```
SELECT 'Same Date' WHERE CAST(getDate() as date) = cast('2/24/2012 2:23 PM' as date) 
```

或者

```
SELECT 'Same Date' WHERE DATEDIFF(dd, cast(getDate() as date), cast('2/24/2012 2:23 PM' as date)) = 0 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-08-14T09:20:36.843

此函数**Cast(Floor(Cast(GetDate() As Float)) As DateTime)**返回一个删除了时间部分的日期时间数据类型，可以这样使用。

```
Select
*
Table1
Where
Cast(Floor(Cast(Column_DateTime As Float)) As DateTime) = '14-AUG-2008' 
```

或者

```
DECLARE  @p_date DATETIME
SET      @p_date = Cast('14 AUG 2008' as DateTime)

SELECT   *
FROM     table1
WHERE    Cast(Floor(Cast(column_datetime As Float)) As DateTime) = @p_date 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-08-18T13:26:53.617

**如何在 MS SQL Server 中获取 DATETIME 字段的 DATE 部分：**

最快和最简洁的方法之一是使用

```
DATEADD(dd, DATEDIFF( dd, 0, @DAY ), 0) 
```

它避免了 CPU 破坏“将日期转换为没有时间的字符串，然后再将其转换回来”的逻辑。

它也没有公开“时间部分表示为日期的一部分”的内部实现。

**获取当月第一天的日期**

```
DATEADD(dd, DATEDIFF( dd, -1, GetDate() - DAY(GetDate()) ), 0) 
```

**获取日期 rfom 1 年前**

```
DATEADD(m,-12,DATEADD(dd, DATEDIFF( dd, -1, GetDate() - DAY(GetDate()) ), 0)) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-08-14T09:18:37.783

```
SELECT  *
FROM    table1
WHERE   CONVERT(varchar(10),columnDatetime,121) = 
        CONVERT(varchar(10),CONVERT('14 AUG 2008' ,smalldatetime),121) 
```

这会将数据时间和字符串转换为“YYYY-MM-DD”格式的varchars。

这很丑陋，但应该可以

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-08-14T09:22:54.547

我知道这不是您想要的方式，但这可能是一个开始：

```
SELECT *
FROM (SELECT *, DATEPART(yy, column_dateTime) as Year, 
      DATEPART(mm, column_dateTime) as Month, 
      DATEPART(dd, column_dateTime) as Day 
      FROM table1)
WHERE Year = '2008'
AND Month = '8'
AND Day = '14' 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-02-16T07:12:34.347

```
DECLARE @Dat

SELECT * 
FROM Jai
WHERE                                                                                                          
CONVERT(VARCHAR(2),DATEPART("dd",Date)) +'/'+                                                              
             CONVERT(VARCHAR(2),DATEPART("mm",Date)) +'/'+              
                     CONVERT(VARCHAR(4), DATEPART("yy",Date)) = @Dat 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-12-07T06:15:08.033

日期可以在 sqlserver 中使用字符串比较进行比较：例如

```
DECLARE @strDate VARCHAR(15)
SET @strDate ='07-12-2010'

SELECT * FROM table
WHERE CONVERT(VARCHAR(15),dtInvoice, 112)>= CONVERT(VARCHAR(15),@strDate , 112) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-02-16T06:36:34.980

```
SELECT CONVERT(VARCHAR(2),DATEPART("dd",doj)) + 
    '/' + CONVERT(VARCHAR(2),DATEPART("mm",doj)) + 
    '/' + CONVERT(VARCHAR(4),DATEPART("yy",doj)) FROM emp 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-01-30T09:49:46.040

```
SELECT * FROM tablename
WHERE CAST(FLOOR(CAST(column_datetime AS FLOAT))AS DATETIME) = '30 jan 2012' 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-05-23T15:42:08.920

最好的方法是使用 SQL DATE() 函数简单地提取日期部分：

```
SELECT * 
FROM table1
WHERE DATE(column_datetime) = @p_date; 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-03-07T16:45:07.887

SQL 中的日期格式有很多种，它们正在被指定。参考[https://msdn.microsoft.com/en-in/library/ms187928.aspx](https://msdn.microsoft.com/en-in/library/ms187928.aspx)

将 varchar 列与选定日期进行转换和比较。

句法：

```
SELECT * FROM tablename where CONVERT(datetime,columnname,103) 
    between '2016-03-01' and '2016-03-03' 
```

```
In CONVERT(DATETIME,COLUMNNAME,103) "103" SPECIFIES THE DATE FORMAT as dd/mm/yyyy 
```

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2010-04-03T10:28:38.743

在 sqlserver 中

```
DECLARE @p_date DATE

SELECT * 
FROM table1
WHERE column_dateTime=@p_date 
```

在 C# 中，使用 ToShortDateString() 函数传递日期值的短字符串。示例：DateVariable.ToShortDateString();

# ios - 如何以编程方式在 iPhone 上发送短信？

> ID：10848
> 
> 赞同：538
> 
> 时间：2008-08-14T09:51:06.207
> 
> 标签：ios, objective-c, cocoa-touch, sms

有人知道使用官方 SDK / Cocoa Touch 以编程方式发送 SMS 是否可行，以及如何**？**`iPhone`

* * *

## 回答 #1

> 赞同：414
> 
> 时间：2008-09-12T15:00:54.210

### 限制

如果您可以在 iPhone 上的程序中发送 SMS，您将能够编写在后台向人们发送垃圾邮件的游戏。我敢肯定你真的很想收到朋友的垃圾邮件，“试试这个新游戏！它让我的 boxxers 感到兴奋，你的也会如此！roxxersboxxers.com!!!!如果你现在注册，你将获得 3,200 RB积分！！”

Apple 对自动化（甚至部分自动化）短信和拨号操作有限制。（想象一下，如果游戏在一天中的特定时间拨打 911）

您最好的选择是在 Internet 上设置使用在线 SMS 发送服务的中间服务器，如果您需要完全自动化，则通过该路线发送 SMS。（即，您在 iPhone 上的程序向您的服务器发送一个 UDP 数据包，该服务器发送真正的 SMS）

### iOS 4 更新

然而，iOS 4 现在提供了一个`viewController`可以导入到应用程序中的功能。您预填充 SMS 字段，然后用户可以在控制器内启动 SMS 发送。与使用“SMS:...” url 格式不同，这允许您的应用程序保持打开状态，并允许您填充*to*和*body*字段。您甚至可以指定多个收件人。

这可以防止应用程序在用户没有明确意识到的情况下发送自动 SMS。您仍然无法从 iPhone 本身发送全自动短信，它需要一些用户交互。但这至少允许您填充所有内容，并避免关闭应用程序。

MFMessageComposeViewController类有很好的文档，并且[教程](https://developer.apple.com/documentation/messageui/mfmessagecomposeviewcontroller)[显示](http://blog.mugunthkumar.com/coding/iphone-tutorial-how-to-send-in-app-sms/)了它是多么容易实现。

### iOS 5 更新

iOS 5 包括用于 iPod touch 和 iPad 设备的消息传递，所以虽然我自己还没有对此进行测试，但可能所有 iOS 设备都能够通过 MFMessageComposeViewController 发送 SMS。如果是这种情况，那么 Apple 正在运行一个 SMS 服务器，它代表没有蜂窝调制解调器的设备发送消息。

### iOS 6 更新

这个类没有变化。

### iOS 7 更新

您现在可以检查您正在使用的消息媒体是否会接受主题或附件，以及它将接受什么样的附件。您可以在媒体允许的情况下编辑主题并向邮件添加附件。

### iOS 8 更新

这个类没有变化。

### iOS 9 更新

这个类没有变化。

### iOS 10 更新

这个类没有变化。

### iOS 11 更新

[对此类没有重大变化](https://developer.apple.com/documentation/messageui/mfmessagecomposeviewcontroller?changes=latest_major)

### 这个类的限制

请记住，这在没有 iOS 4 的手机上不起作用，在 iPod touch 或 iPad 上也不起作用，可能在 iOS 5 下除外。在使用它之前，您必须检测设备和 iOS 限制控制器，或冒险将您的应用程序限制为最近升级的 3G、3GS 和 4 iPhone。

但是，发送 SMS 的中间服务器将允许任何和所有这些 iOS 设备发送 SMS，只要它们可以访问 Internet，因此对于许多应用程序来说，它可能仍然是一个更好的解决方案。或者，两者都使用，并且仅在设备不支持时才回退到在线 SMS 服务。

* * *

## 回答 #2

> 赞同：146
> 
> 时间：2010-07-24T19:09:07.580

这是一个教程，它完全符合您的要求：`MFMessageComposeViewController`.

[http://blog.mugunthkumar.com/coding/iphone-tutorial-how-to-send-in-app-sms/](http://blog.mugunthkumar.com/coding/iphone-tutorial-how-to-send-in-app-sms/)

本质上：

```
MFMessageComposeViewController *controller = [[[MFMessageComposeViewController alloc] init] autorelease];
if([MFMessageComposeViewController canSendText])
{
    controller.body = @"SMS message here";
    controller.recipients = [NSArray arrayWithObjects:@"1(234)567-8910", nil];
    controller.messageComposeDelegate = self;
    [self presentModalViewController:controller animated:YES];
} 
```

以及文档的链接。

[https://developer.apple.com/documentation/messageui/mfmessagecomposeviewcontroller](https://developer.apple.com/documentation/messageui/mfmessagecomposeviewcontroller)

* * *

## 回答 #3

> 赞同：100
> 
> 时间：2011-12-07T16:50:58.800

1.  您必须将 MessageUI.framework 添加到您的 Xcode 项目中
2.  `#import <MessageUI/MessageUI.h>`在头文件中包含一个
3.  将这些委托添加到您的头文件`MFMessageComposeViewControllerDelegate` &`UINavigationControllerDelegate`
4.  在您的方法中声明say的`IBAction`实例`MFMessageComposeViewController``messageInstance`
5.  要检查您的设备是否可以在 if 条件下发送文本使用`[MFMessageComposeViewController canSendText]`，它将返回 Yes/No
6.  在这种`if`情况下，请执行以下操作：

    1.  首先为您设置身体`messageInstance`：

        ```
        messageInstance.body = @"Hello from Shah"; 
        ```

    2.  然后将消息的收件人确定为：

        ```
        messageInstance.recipients = [NSArray arrayWithObjects:@"12345678", @"87654321",         nil]; 
        ```

    3.  将您的 messageInstance 的委托设置为：

        ```
        messageInstance.messageComposeDelegate = self; 
        ```

    4.  在最后一行执行以下操作：

        ```
        [self presentModalViewController:messageInstance animated:YES]; 
        ```

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2008-09-12T14:41:55.753

您可以使用`sms:[target phone number]`URL 打开 SMS 应用程序，但没有说明如何使用文本预填充 SMS 正文。

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2012-10-25T07:17:31.843

MacOS 中的进程间通信系统之一是 XPC。该系统层已开发用于基于使用 libSystem 和 launchd 传输 plist 结构的进程间通信。事实上，它是一个允许通过交换诸如字典之类的结构来管理进程的接口。由于遗传，iOS 5 也拥有这种机制。

你可能已经明白我所说的这个介绍的意思了。是的，iOS 中有包含 XPC 通信工具的系统服务。我想用一个用于 SMS 发送的守护进程来举例说明这项工作。不过需要说明的是，这个能力在 iOS 6 中是固定的，但与 iOS 5.0—5.1.1 相关。越狱、私有框架和其他非法工具都不需要它的利用。只需要目录 /usr/include/xpc/* 中的一组头文件。

iOS 中短信发送的要素之一是系统服务 com.apple.chatkit，其任务包括生成、管理和发送短信。为了便于控制，它具有公开可用的通信端口 com.apple.chatkit.clientcomposeserver.xpc。使用 XPC 子系统，您可以在未经用户批准的情况下生成和发送消息。</p>

好吧，让我们尝试创建一个连接。

```
xpc_connection_t myConnection;

dispatch_queue_t queue = dispatch_queue_create("com.apple.chatkit.clientcomposeserver.xpc", DISPATCH_QUEUE_CONCURRENT);

myConnection = xpc_connection_create_mach_service("com.apple.chatkit.clientcomposeserver.xpc", queue, XPC_CONNECTION_MACH_SERVICE_PRIVILEGED); 
```

现在我们将 XPC 连接 myConnection 设置为 SMS 发送服务。然而，XPC 配置提供了暂停连接的创建——我们需要再采取一步来激活。

```
xpc_connection_set_event_handler(myConnection, ^(xpc_object_t event){
xpc_type_t xtype = xpc_get_type(event);
if(XPC_TYPE_ERROR == xtype)
{
NSLog(@"XPC sandbox connection error: %s\n", xpc_dictionary_get_string(event, XPC_ERROR_KEY_DESCRIPTION));
}
// Always set an event handler. More on this later.

NSLog(@"Received a message event!");

});

xpc_connection_resume(myConnection); 
```

连接已激活。就在此时，iOS 6 将在电话日志中显示一条消息，禁止此类通信。现在我们需要生成一个类似于 xpc_dictionary 的字典，其中包含消息发送所需的数据。

```
NSArray *recipient = [NSArray arrayWithObjects:@"+7 (90*) 000-00-00", nil];

NSData *ser_rec = [NSPropertyListSerialization dataWithPropertyList:recipient format:200 options:0 error:NULL];

xpc_object_t mydict = xpc_dictionary_create(0, 0, 0);
xpc_dictionary_set_int64(mydict, "message-type", 0);
xpc_dictionary_set_data(mydict, "recipients", [ser_rec bytes], [ser_rec length]);
xpc_dictionary_set_string(mydict, "text", "hello from your application!"); 
```

所剩无几：将消息发送到 XPC 端口并确保它已送达。

```
xpc_connection_send_message(myConnection, mydict);
xpc_connection_send_barrier(myConnection, ^{
NSLog(@"The message has been successfully delivered");
}); 
```

就这样。短信发送。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2013-05-10T21:38:08.053

添加 MessageUI.Framework 并使用以下代码

```
#import <MessageUI/MessageUI.h> 
```

接着：

```
if ([MFMessageComposeViewController canSendText]) {
  MFMessageComposeViewController *messageComposer =
  [[MFMessageComposeViewController alloc] init];
  NSString *message = @"Your Message here";
  [messageComposer setBody:message];
  messageComposer.messageComposeDelegate = self;
  [self presentViewController:messageComposer animated:YES completion:nil];
} 
```

和委托方法 -

```
- (void)messageComposeViewController:(MFMessageComposeViewController *)controller
             didFinishWithResult:(MessageComposeResult)result {
      [self dismissViewControllerAnimated:YES completion:nil];
 } 
```

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2014-02-26T07:13:20.487

您可以使用这种方法：

```
[[UIApplication sharedApplication]openURL:[NSURL URLWithString:@"sms:MobileNumber"]] 
```

iOS 会自动从您的应用导航到消息应用的消息撰写页面。由于 URL 的方案以 sms: 开头，因此这被标识为消息应用程序识别并启动它的类型。

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2014-07-29T10:32:29.250

**遵循此程序**

1.`MessageUI.Framework`添加到项目![在此处输入图像描述](../Images/2a8d79149648ebe5033a75dfa1890c5c.png)

2\. 导入`#import <MessageUI/MessageUI.h>`.h 文件。

3\. 复制此代码以发送消息

```
 if ([MFMessageComposeViewController canSendText]) {
    MFMessageComposeViewController *messageComposer =
    [[MFMessageComposeViewController alloc] init];
    NSString *message = @"Message!!!";
    [messageComposer setBody:message];
    messageComposer.messageComposeDelegate = self;
    [self presentViewController:messageComposer animated:YES completion:nil];
} 
```

4\. `delegate`如果您愿意，请实施方法。

```
- (void)messageComposeViewController:(MFMessageComposeViewController *)controller didFinishWithResult:(MessageComposeResult)result{

   ///your stuff here 

    [self dismissViewControllerAnimated:YES completion:nil];
} 
```

奔跑吧！

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2012-08-27T12:33:43.430

```
//Add the Framework in .h file

#import <MessageUI/MessageUI.h>
#import <MessageUI/MFMailComposeViewController.h>

//Set the delegate methods

UIViewController<UINavigationControllerDelegate,MFMessageComposeViewControllerDelegate>

//add the below code in .m file

- (void)viewDidAppear:(BOOL)animated{
    [super viewDidAppear:animated];

    MFMessageComposeViewController *controller = 
    [[[MFMessageComposeViewController alloc] init] autorelease];

    if([MFMessageComposeViewController canSendText])
    { 
        NSString *str= @"Hello";
        controller.body = str;
        controller.recipients = [NSArray arrayWithObjects:
                                 @"", nil];
        controller.delegate = self;
        [self presentModalViewController:controller animated:YES];  
    }

}

- (void)messageComposeViewController:
(MFMessageComposeViewController *)controller
                 didFinishWithResult:(MessageComposeResult)result 
{
    switch (result)
    {
        case MessageComposeResultCancelled:  
            NSLog(@"Cancelled");    
            break; 
        case MessageComposeResultFailed:
            NSLog(@"Failed");
            break;   
        case MessageComposeResultSent:      
            break; 
        default:  
            break;  
    }  
    [self dismissModalViewControllerAnimated:YES]; 
} 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2015-05-23T07:40:59.003

这是在 iOS 中发送 SMS 的 Swift 版本代码。请注意，它仅适用于真实设备。在 iOS 7+ 中测试的代码。[你可以在这里](http://cungcode.com/how-to-send-sms-programmatically-ios/)阅读更多。

1) 创建一个继承 MFMessageComposeViewControllerDelegate 和 NSObject 的新类：

```
import Foundation
import MessageUI

class MessageComposer: NSObject, MFMessageComposeViewControllerDelegate {
    // A wrapper function to indicate whether or not a text message can be sent from the user's device
    func canSendText() -> Bool {
        return MFMessageComposeViewController.canSendText()
    }

    // Configures and returns a MFMessageComposeViewController instance
    func configuredMessageComposeViewController(textMessageRecipients:[String] ,textBody body:String) -> MFMessageComposeViewController {
        let messageComposeVC = MFMessageComposeViewController()
        messageComposeVC.messageComposeDelegate = self  //  Make sure to set this property to self, so that the controller can be dismissed!
        messageComposeVC.recipients = textMessageRecipients
        messageComposeVC.body = body
        return messageComposeVC
    }

    // MFMessageComposeViewControllerDelegate callback - dismisses the view controller when the user is finished with it
    func messageComposeViewController(controller: MFMessageComposeViewController!, didFinishWithResult result: MessageComposeResult) {
        controller.dismissViewControllerAnimated(true, completion: nil)
        }
} 
```

2）如何使用这个类：

```
func openMessageComposerHelper(sender:AnyObject ,withIndexPath indexPath: NSIndexPath) {
    var recipients = [String]()

    //modify your recipients here

    if (messageComposer.canSendText()) {
        println("can send text")
        // Obtain a configured MFMessageComposeViewController
        let body = Utility.createInvitationMessageText()

        let messageComposeVC = messageComposer.configuredMessageComposeViewController(recipients, textBody: body)

        // Present the configured MFMessageComposeViewController instance
        // Note that the dismissal of the VC will be handled by the messageComposer instance,
        // since it implements the appropriate delegate call-back
        presentViewController(messageComposeVC, animated: true, completion: nil)
    } else {
        // Let the user know if his/her device isn't able to send text messages
        self.displayAlerViewWithTitle("Cannot Send Text Message", andMessage: "Your device is not able to send text messages.")
    }
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-09-10T08:32:07.300

iOS 4 中有一个类支持从您的应用程序发送带有正文和recipents 的消息。它的工作原理与发送邮件相同。您可以在此处找到文档：[链接文本](http://developer.apple.com/iphone/library/documentation/MessageUI/Reference/MFMessageComposeViewController_class/Reference/Reference.html)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-03-10T12:48:03.400

//使用名称和号码调用方法。

```
-(void)openMessageViewWithName:(NSString*)contactName withPhone:(NSString *)phone{

CTTelephonyNetworkInfo *networkInfo=[[CTTelephonyNetworkInfo alloc]init];

CTCarrier *carrier=networkInfo.subscriberCellularProvider;

NSString *Countrycode = carrier.isoCountryCode;

if ([Countrycode length]>0)     //Check If Sim Inserted
{

    [self sendSMS:msg recipientList:[NSMutableArray arrayWithObject:phone]];
}
else
{

    [AlertHelper showAlert:@"Message" withMessage:@"No sim card inserted"];
} 
```

}

//发送消息的方法

```
- (void)sendSMS:(NSString *)bodyOfMessage recipientList:(NSMutableArray *)recipients{  
 MFMessageComposeViewController *controller1 = [[MFMessageComposeViewController alloc] init] ;
 controller1 = [[MFMessageComposeViewController alloc] init] ;
 if([MFMessageComposeViewController canSendText])
{
    controller1.body = bodyOfMessage;
    controller1.recipients = recipients;
    controller1.messageComposeDelegate = self;
    [self presentViewController:controller1 animated:YES completion:Nil];
 }
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-09-09T11:17:09.503

```
- (void)sendSMS:(NSString *)bodyOfMessage recipientList:(NSArray *)recipients
{
    UIPasteboard *pasteboard = [UIPasteboard generalPasteboard];
    UIImage *ui =resultimg.image;
    pasteboard.image = ui;
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"sms:"]];
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-01-29T02:15:13.963

如果需要，可以使用`CoreTelephony`称为`CTMessageCenter`类的私有框架。有几种发送短信的方法。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-08-04T12:36:30.317

```
[[UIApplication sharedApplication]openURL:[NSURL URLWithString:@"sms:number"]] 
```

这将是最好和最简单的方法。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-05-18T05:47:57.230

用这个：

```
- (void)showSMSPicker
{
    Class messageClass = (NSClassFromString(@"MFMessageComposeViewController"));

    if (messageClass != nil) {          
        // Check whether the current device is configured for sending SMS messages
        if ([messageClass canSendText]) {
           [self displaySMSComposerSheet];
        }   
    }
}

- (void)messageComposeViewController:(MFMessageComposeViewController *)controller didFinishWithResult:(MessageComposeResult)result
{       
    //feedbackMsg.hidden = NO;
    // Notifies users about errors associated with the interface
    switch (result)
    {
        case MessageComposeResultCancelled:
        {   
            UIAlertView *alert1 = [[UIAlertView alloc] initWithTitle:@"Message" message:@"SMS sending canceled!!!" delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
            [alert1 show];
            [alert1 release];
        }   

        // feedbackMsg.text = @"Result: SMS sending canceled";
        break;

        case MessageComposeResultSent:
        {
            UIAlertView *alert2 = [[UIAlertView alloc] initWithTitle:@"Message" message:@"SMS sent!!!" delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
            [alert2 show];
            [alert2 release];
        }   

        // feedbackMsg.text = @"Result: SMS sent";
        break;

        case MessageComposeResultFailed:
        {   
            UIAlertView *alert3 = [[UIAlertView alloc] initWithTitle:@"Message" message:@"SMS sending failed!!!" delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
            [alert3 show];
            [alert3 release];
        }   

        // feedbackMsg.text = @"Result: SMS sending failed";
        break;

        default:
        {   
            UIAlertView *alert4 = [[UIAlertView alloc] initWithTitle:@"Message" message:@"SMS not sent!!!" delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
            [alert4 show];
            [alert4 release];
        }   

        // feedbackMsg.text = @"Result: SMS not sent";
        break;
    }

    [self dismissModalViewControllerAnimated: YES];
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-11-26T01:33:14.047

You can present MFMessageComposeViewController, which can send SMS, but with user prompt(he taps send button). No way to do that without user permission. On iOS 11, you can make extension, that can be like filter for incoming messages , telling iOS either its spam or not. Nothing more with SMS cannot be done

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-03-30T06:31:19.730

如果您想在自己的应用程序中显示创建和发送消息，则需要使用**MFMessageComposeViewController 。**

否则，您可以使用**sharedApplication**方法。

# c# - 对 DataTable 的 LINQ 查询

> ID：10855
> 
> 赞同：1102
> 
> 时间：2008-08-14T10:08:27.123
> 
> 标签：c#, .net, linq, datatable, .net-3.5

我正在尝试对 DataTable 对象执行 LINQ 查询，但奇怪的是，我发现对 DataTables 执行此类查询并不简单。例如：

```
var results = from myRow in myDataTable
where results.Field("RowNo") == 1
select results; 
```

这是不允许的。我怎样才能得到这样的工作？

我很惊讶数据表上不允许使用 LINQ 查询！

* * *

## 回答 #1

> 赞同：1353
> 
> 时间：2008-08-14T19:45:01.383

您不能查询`DataTable`'s *Rows*集合，因为`DataRowCollection`没有实现`IEnumerable<T>`. 您需要`AsEnumerable()`使用`DataTable`. 像这样：

```
var results = from myRow in myDataTable.AsEnumerable()
where myRow.Field<int>("RowNo") == 1
select myRow; 
```

正如[@Keith](https://stackoverflow.com/a/10893/5519709)所说，您需要添加对[System.Data.DataSetExtensions的引用](http://msdn.microsoft.com/en-us/library/system.data.datarowextensions.aspx)

`AsEnumerable()`返回`IEnumerable<DataRow>`。如果您需要转换`IEnumerable<DataRow>`为`DataTable`，请使用`CopyToDataTable()`扩展名。

下面是使用 Lambda 表达式的查询，

```
var result = myDataTable
    .AsEnumerable()
    .Where(myRow => myRow.Field<int>("RowNo") == 1); 
```

* * *

## 回答 #2

> 赞同：139
> 
> 时间：2009-03-05T02:53:10.860

```
var results = from DataRow myRow in myDataTable.Rows
    where (int)myRow["RowNo"] == 1
    select myRow 
```

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2008-08-14T10:10:55.917

并不是故意不允许在 DataTables 上使用它们，只是 DataTables 早于可以执行 Linq 查询的 IQueryable 和通用 IEnumerable 构造。

这两个接口都需要某种类型的安全验证。数据表不是强类型的。例如，这与人们无法查询 ArrayList 的原因相同。

为了使 Linq 工作，您需要将结果映射到类型安全的对象并对其进行查询。

* * *

## 回答 #4

> 赞同：53
> 
> 时间：2008-08-14T11:07:52.613

正如@ch00k 所说：

```
using System.Data; //needed for the extension methods to work

...

var results = 
    from myRow in myDataTable.Rows 
    where myRow.Field<int>("RowNo") == 1 
    select myRow; //select the thing you want, not the collection 
```

您还需要将项目引用添加到`System.Data.DataSetExtensions`

* * *

## 回答 #5

> 赞同：43
> 
> 时间：2016-02-02T21:22:20.983

我意识到这已经回答了几次，但只是为了提供另一种方法：

我喜欢使用该`.Cast<T>()`方法，它可以帮助我在查看定义的显式类型时保持理智，并且我认为`.AsEnumerable()`无论如何都会调用它：

```
var results = from myRow in myDataTable.Rows.Cast<DataRow>() 
                  where myRow.Field<int>("RowNo") == 1 select myRow; 
```

或者

```
var results = myDataTable.Rows.Cast<DataRow>()
                  .FirstOrDefault(x => x.Field<int>("RowNo") == 1); 
```

*如评论中所述，不需要`System.Data.DataSetExtensions`或任何其他程序集（[参考](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.cast)）*

* * *

## 回答 #6

> 赞同：40
> 
> 时间：2010-05-23T04:03:29.717

```
var query = from p in dt.AsEnumerable()
                    where p.Field<string>("code") == this.txtCat.Text
                    select new
                    {
                        name = p.Field<string>("name"),
                        age= p.Field<int>("age")                         
                    }; 
```

name 和 age 字段现在是查询对象的一部分，可以像这样访问：**Console.WriteLine(query.name);**

* * *

## 回答 #7

> 赞同：31
> 
> 时间：2011-07-13T11:21:07.110

[使用 LINQ 操作 DataSet/DataTable 中的数据](http://dotnetarchitect.wordpress.com/2009/03/18/using-linq-to-manipulate-data-in-datasetdatatable/)

```
var results = from myRow in tblCurrentStock.AsEnumerable()
              where myRow.Field<string>("item_name").ToUpper().StartsWith(tbSearchItem.Text.ToUpper())
              select myRow;
DataView view = results.AsDataView(); 
```

* * *

## 回答 #8

> 赞同：30
> 
> 时间：2012-01-05T08:43:15.667

```
//Create DataTable 
DataTable dt= new DataTable();
dt.Columns.AddRange(new DataColumn[]
{
   new DataColumn("ID",typeof(System.Int32)),
   new DataColumn("Name",typeof(System.String))

});

//Fill with data

dt.Rows.Add(new Object[]{1,"Test1"});
dt.Rows.Add(new Object[]{2,"Test2"});

//Now  Query DataTable with linq
//To work with linq it should required our source implement IEnumerable interface.
//But DataTable not Implement IEnumerable interface
//So we call DataTable Extension method  i.e AsEnumerable() this will return EnumerableRowCollection<DataRow>

// Now Query DataTable to find Row whoes ID=1

DataRow drow = dt.AsEnumerable().Where(p=>p.Field<Int32>(0)==1).FirstOrDefault();
 // 
```

* * *

## 回答 #9

> 赞同：24
> 
> 时间：2016-04-05T09:38:59.350

试试这个简单的查询行：

```
var result=myDataTable.AsEnumerable().Where(myRow => myRow.Field<int>("RowNo") == 1); 
```

* * *

## 回答 #10

> 赞同：17
> 
> 时间：2008-08-14T10:11:08.787

您可以对 Rows 集合上的对象使用 LINQ，如下所示：

```
var results = from myRow in myDataTable.Rows where myRow.Field("RowNo") == 1 select myRow; 
```

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2015-03-18T22:13:55.987

这是一种适用于我并使用 lambda 表达式的简单方法：

```
var results = myDataTable.Select("").FirstOrDefault(x => (int)x["RowNo"] == 1) 
```

然后，如果您想要一个特定的值：

```
if(results != null) 
    var foo = results["ColName"].ToString() 
```

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2012-05-18T07:15:08.957

试试这个

```
var row = (from result in dt.AsEnumerable().OrderBy( result => Guid.NewGuid()) select result).Take(3) ; 
```

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2013-04-24T17:17:47.570

最有可能的是，解决方案中已经定义了 DataSet、DataTable 和 DataRow 的类。如果是这种情况，您将不需要 DataSetExtensions 参考。

前任。DataSet 类名-> CustomSet、DataRow 类名-> CustomTableRow（定义列：RowNo，...）

```
var result = from myRow in myDataTable.Rows.OfType<CustomSet.CustomTableRow>()
             where myRow.RowNo == 1
             select myRow; 
```

或者（如我所愿）

```
var result = myDataTable.Rows.OfType<CustomSet.CustomTableRow>().Where(myRow => myRow.RowNo); 
```

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2014-02-01T11:51:43.540

```
var results = from myRow in myDataTable
where results.Field<Int32>("RowNo") == 1
select results; 
```

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2014-10-14T17:51:10.997

在我的应用程序中，我发现使用 LINQ to Datasets 和答案中建议的 DataTable 的 AsEnumerable() 扩展非常慢。如果您对优化速度感兴趣，请使用 James Newtonking 的 Json.Net 库 ( [http://james.newtonking.com/json/help/index.html](http://james.newtonking.com/json/help/index.html) )

```
// Serialize the DataTable to a json string
string serializedTable = JsonConvert.SerializeObject(myDataTable);    
Jarray dataRows = Jarray.Parse(serializedTable);

// Run the LINQ query
List<JToken> results = (from row in dataRows
                    where (int) row["ans_key"] == 42
                    select row).ToList();

// If you need the results to be in a DataTable
string jsonResults = JsonConvert.SerializeObject(results);
DataTable resultsTable = JsonConvert.DeserializeObject<DataTable>(jsonResults); 
```

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2017-10-25T16:04:52.260

下面提供了有关如何实现此目的的示例：

```
DataSet dataSet = new DataSet(); //Create a dataset
dataSet = _DataEntryDataLayer.ReadResults(); //Call to the dataLayer to return the data

//LINQ query on a DataTable
var dataList = dataSet.Tables["DataTable"]
              .AsEnumerable()
              .Select(i => new
              {
                 ID = i["ID"],
                 Name = i["Name"]
               }).ToList(); 
```

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2012-10-17T16:04:52.607

对于 VB.NET，代码将如下所示：

```
Dim results = From myRow In myDataTable  
Where myRow.Field(Of Int32)("RowNo") = 1 Select myRow 
```

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2015-08-04T07:32:55.757

```
IEnumerable<string> result = from myRow in dataTableResult.AsEnumerable()
                             select myRow["server"].ToString() ; 
```

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2014-04-10T10:24:31.120

试试这个...

```
SqlCommand cmd = new SqlCommand( "Select * from Employee",con);
SqlDataReader dr = cmd.ExecuteReader( );
DataTable dt = new DataTable( "Employee" );
dt.Load( dr );
var Data = dt.AsEnumerable( );
var names = from emp in Data select emp.Field<String>( dt.Columns[1] );
foreach( var name in names )
{
    Console.WriteLine( name );
} 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2013-11-03T17:54:15.080

你可以通过 linq 让它优雅地工作，如下所示：

```
from prod in TenMostExpensiveProducts().Tables[0].AsEnumerable()
where prod.Field<decimal>("UnitPrice") > 62.500M
select prod 
```

或者像动态 linq 这样（直接在 DataSet 上调用 AsDynamic）：

```
TenMostExpensiveProducts().AsDynamic().Where (x => x.UnitPrice > 62.500M) 
```

我更喜欢最后一种方法，而 is 是最灵活的。PS：别忘了连接`System.Data.DataSetExtensions.dll`参考

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2018-02-01T21:43:07.783

你可以试试这个，但你必须确定每列的值类型

```
List<MyClass> result = myDataTable.AsEnumerable().Select(x=> new MyClass(){
     Property1 = (string)x.Field<string>("ColumnName1"),
     Property2 = (int)x.Field<int>("ColumnName2"),
     Property3 = (bool)x.Field<bool>("ColumnName3"),    
}); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-08-19T14:18:58.957

我提出以下解决方案：

```
DataView view = new DataView(myDataTable); 
view.RowFilter = "RowNo = 1";
DataTable results = view.ToTable(true); 
```

查看[DataView 文档](https://docs.microsoft.com/de-de/dotnet/api/system.data.dataview?view=netframework-4.8)，我们首先看到的是：

> 表示用于排序、筛选、搜索、编辑和导航的 DataTable 的可数据绑定的自定义视图。

我从中得到的是，DataTable 仅用于存储数据，而 DataView 使我们能够对 DataTable 进行“查询”。

这是在这种特殊情况下的工作原理：

您尝试执行 SQL 语句

```
SELECT *
FROM myDataTable
WHERE RowNo = 1 
```

在“数据表语言”中。在 C# 中，我们会这样读：

```
FROM myDataTable
WHERE RowNo = 1
SELECT * 
```

在 C# 中看起来像这样：

```
DataView view = new DataView(myDataTable);  //FROM myDataTable
view.RowFilter = "RowNo = 1";  //WHERE RowNo = 1
DataTable results = view.ToTable(true);  //SELECT * 
```

# .net - 数据层最佳实践

> ID：10860
> 
> 赞同：10
> 
> 时间：2008-08-14T10:23:05.657
> 
> 标签：.net, n-tier-architecture

我正在与一位同事“讨论”在新应用程序中实现数据层的最佳方式。

一种观点是数据层应该知道业务对象（我们自己的代表实体的类），并且能够在本地使用该对象。

相反的观点是数据层应该与对象无关，并且纯粹处理简单的数据类型（字符串、布尔值、日期等）。

我可以看到这两种方法都可能有效，但我自己的观点是我更喜欢前者。这样，如果数据存储介质发生变化，业务层就不必（必然）改变以适应新的数据层。因此，从 SQL 数据存储更改为序列化的 xml 文件系统存储将是一件微不足道的事情。

我同事的观点是，数据层不应该知道对象定义，只要数据传递得当，这就足够了。

现在，我知道这是有可能引发一场宗教战争的问题之一，但我希望社区提供任何关于您如何处理此类事情的反馈。

TIA

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-08-14T10:38:04.677

这真的取决于你对世界的看法——我曾经在非耦合阵营中。DAL 只是为了向 BAL 提供数据——故事的结尾。

随着 Linq to SQL 和实体框架等新兴技术变得越来越流行，DAL 和 BAL 之间的界限变得有些模糊。在 L2S 中，尤其是您的 DAL 与业务对象非常紧密耦合，因为对象模型与您的数据库字段具有 1-1 映射。

就像软件开发中的任何事情一样，没有正确或错误的答案。您需要了解您的要求和未来的要求，并从那里开始工作。我不会再在达喀尔拉力赛上使用法拉利，就像我在赛道日使用路虎揽胜一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-08-14T10:28:43.070

你可以两者兼得。让数据层不知道您的业务对象，并使其能够处理多种类型的数据源。如果您提供一个通用接口（或抽象类）来与数据交互，那么您可以为每种类型的数据源提供不同的实现。工厂模式在这里很顺利。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-14T10:27:50.500

我拥有的一本涵盖该主题的优秀书籍是Clifton Nock 的[《数据访问模式](https://rads.stackoverflow.com/amzn/click/com/0131401572)》。关于如何将业务层与持久层解耦，它有很多很好的解释和很好的想法。你真的应该试一试。这是我最喜欢的书之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-08-14T10:30:21.243

Jeffrey Palermo 写了一篇关于这个的好文章。他称之为[洋葱架构](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-14T10:28:08.673

我发现方便的一个技巧是让我的数据层“与集合无关”。也就是说，每当我想从我的数据层返回一个对象列表时，我都会让调用者传入列表。所以代替这个：

```
public IList<Foo> GetFoosById(int id) { ... } 
```

我这样做：

```
public void GetFoosById(IList<Foo> foos, int id) { ... } 
```

如果这就是我所需要的，这让我可以传入一个普通的旧 List，或者如果我打算从 UI 绑定到它，则可以传入更智能的 IList<T> 实现（如 ObservableCollection<T>）。这种技术还可以让我从方法中返回一些内容，例如 ValidationResult，如果发生错误消息，则包含错误消息。

这仍然意味着我的数据层知道我的对象定义，但它给了我额外的灵活性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-08-14T10:28:20.810

查看 Linq to SQL，如果我现在正在创建一个新应用程序，我会考虑依赖完全基于 Linq 的数据层。

除此之外，我认为尽可能多地分离数据和逻辑是一种很好的做法，但这并不总是可行的。逻辑和数据访问之间的纯粹分离使得连接和优化变得困难，这就是使 Linq 如此强大的原因。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-08-14T10:30:51.773

在我们使用 NHibernate 的应用程序中，答案变为“介于两者之间”，因为 XML 映射定义（它们指定哪个表属于哪个对象以及哪些列属于哪个字段等）显然在业务对象层中.

它们被传递给不知道任何业务对象的通用数据会话管理器；唯一的要求是为 CRUD 传递给它的业务对象必须有一个映射文件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-11T13:24:06.287

旧帖子但在搜索类似信息时我遇到了[这个](http://www.simple-talk.com/dotnet/.net-framework/.net-application-architecture-the-data-access-layer/)很好地解释了它。

# actionscript-3 - 我怎样才能“不接受”Flex 中的拖累？

> ID：10870
> 
> 赞同：5
> 
> 时间：2008-08-14T10:32:52.610
> 
> 标签：actionscript-3, apache-flex, drag-and-drop

一旦我打电话`DragManager.acceptDrag`，有什么办法可以“不接受”拖累吗？假设我有一个可以接受拖放的视图，但仅限于某些区域。一旦用户拖动我调用的这些区域之一`DragManager.acceptDrag(this)`（从`DragEvent.DRAG_OVER`处理程序），但如果用户随后移出该区域，我想将拖动的状态更改为不接受并显示`DragManager.NONE`反馈。但是，无论调用`DragManager.acceptDrag(null)`还是`DragManager.showFeedback(DragManager.NONE)`似乎都没有任何效果。一旦我接受了拖动设置反馈类型，我似乎无法更改它。

明确一点：用户应该能够放置的区域不是组件，甚至不是显示对象，实际上它们只是文本字段文本中的范围（如选择）。如果他们是他们自己的组件，我可以通过让他们每个人单独接受拖动事件来解决它。我想我可以创建漂浮在文本上的代理组件来模拟它，但如果没有必要，我宁愿不这样做。

* * *

我现在已经设法让它在 AIR 和浏览器中工作，但只能通过将代理组件放在应该能够放置内容的文本范围的顶部。这样我就得到了正确的反馈，并且在拖动退出时会自动不接受下降。

这是 AIR 中关于 D&D 最奇怪的事情：

```
DragManager.doDrag(initiator, source, event, dragImage, offsetX, offsetY); 
```

在基于浏览器的 Flex 中，`offsetX`应该`offsetY`是负数（文档如是说，它工作正常）。但是，当在 AIR 中运行*完全相同的代码*时，您必须使偏移量为正。相同的数字，但为正数。这是非常非常奇怪的。

* * *

我已经测试了更多以及[@maclema 的](https://stackoverflow.com/questions/10870/how-can-i-unaccept-a-drag-in-flex#11209)工作原理，但如果你在 AIR 中运行则不行。AIR中的拖放似乎有所不同。这真的很奇怪，因为不仅反馈没有正确显示，而且不可能不接受，而且坐标也完全关闭了。我只是在浏览器而不是 AIR 中尝试了我的应用程序，并且拖放完全被破坏了。

此外，跳过`dragEnter`处理程序在 AIR 中工作正常，但在浏览器中运行时会破坏一切。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-08-14T15:29:51.070

您是否仅使用 dragEnter 方法？如果您尝试拒绝拖动，同时仍拖动同一组件，则需要同时使用 dragEnter 和 dragOver 方法。

看看这个例子：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
    <mx:Script>
        <![CDATA[
            import mx.core.DragSource;
            import mx.managers.DragManager;
            import mx.events.DragEvent;

            private function onDragEnter(e:DragEvent):void {
                if ( e.target == lbl ) {

                    if ( e.localX < lbl.width/2 ) {
                        trace("accept");
                        DragManager.acceptDragDrop(this);
                    }
                    else {
                        DragManager.acceptDragDrop(null);
                    }
                }
            }

            private function doStartDrag(e:MouseEvent):void {
                if ( e.buttonDown ) {
                    var ds:DragSource = new DragSource();
                    ds.addData("test", "text");

                    DragManager.doDrag(btn, ds, e);
                }
            }
        ]]>
    </mx:Script>
    <mx:Label id="lbl" text="hello world!" left="10" top="10" dragEnter="onDragEnter(event)" dragOver="onDragEnter(event)" />
    <mx:Button id="btn" x="47" y="255" label="Button" mouseMove="doStartDrag(event)"/>
</mx:Application> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T05:37:31.300

如果您不需要 AIR 中的原生拖放，则可以通过子类化 WindowedApplication 并设置 DragManager 来获得 Flex 拖放行为。有关更多信息，请参阅 Adob​​e Jira 上的此帖子：[https ://bugs.adobe.com/jira/browse/SDK-13983](https://bugs.adobe.com/jira/browse/SDK-13983)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T18:41:51.117

你误解了这个概念。您的“不接受”是通过实现 dragOverHandler 并发出不需要数据的信号来实现的。

这是基本概念：

1.  注册 dragEnterHandler 或覆盖已经注册的方法。

    ```
    function dragEnterHandler(event: DragEvent):void {
        if (data suites at least one location in this component)
            DragManager.acceptDragDrop(this);
    } 
    ```

    这使您的容器能够接收更多消息（dragOver/dragExit）。但这**不是**决定应该显示哪种鼠标光标的位置。

    没有**DragManager.acceptDragDrop(this);** 不调用其他处理程序。

2.  注册 dragOverHandler 或覆盖已经注册的方法。

    ```
    function dragOverHandler(event: DragEvent):void {
        if (data suites at least no location in this component) {
            DragManager.showFeedback(DragManager.NONE);
            return;
        }

        ... // handle other cases and show the cursor / icon you want
    } 
    ```

    调用**DragManager.showFeedback(DragManager.NONE);** 诀窍是显示“不接受”。

3.  注册 dragExitHandler 或覆盖已经注册的方法。

    ```
    function dragOverHandler(event: DragEvent):void {
        // handle the recieved data as you like.
    } 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-08-19T15:16:08.433

Yes, drag and drop is different in AIR. I HATE that! It takes a lot of playing around to figure out how to get things to work the same as custom dnd that was built in flex.

As for the coordinates, maybe play around with localToContent, and localToGlobal methods. They may help in translating the coordinates to something useful.

Good luck. I will let you know if I think of anything else.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-15T17:57:40.840

好的，我现在看到了问题。尝试将其设置为 dragInitiator，而不是 null。

看一下这个。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
    <mx:Script>
        <![CDATA[
            import mx.controls.Alert;
            import mx.events.DragEvent;
            import mx.managers.DragManager;
            import mx.core.DragSource;

            private function doStartDrag(e:MouseEvent):void {
                if ( e.buttonDown && !DragManager.isDragging ) {
                var ds:DragSource = new DragSource();
                ds.addData("test", "test");

                DragManager.doDrag(btn, ds, e);
                }
            }

            private function handleDragOver(e:DragEvent):void {
                if ( e.localX < cvs.width/2 ) {
                    //since null does nothing, lets just set to accept the drag
                    //operation, but accept it to the dragInitiator
                    DragManager.acceptDragDrop(e.dragInitiator);
                }   
                else {
                    //accept drag
                    DragManager.acceptDragDrop(cvs);
                    DragManager.showFeedback( DragManager.COPY );
                }
            }

            private function handleDragDrop(e:DragEvent):void {
                if ( e.dragSource.hasFormat("test") ) {
                    Alert.show("Got a drag drop!");
                }
            }
        ]]>
    </mx:Script>
    <mx:Canvas x="265" y="66" width="321" height="245" backgroundColor="#FF0000" id="cvs" dragOver="handleDragOver(event)" dragDrop="handleDragDrop(event)">
    </mx:Canvas>
    <mx:Button id="btn" x="82" y="140" label="Drag Me" mouseDown="doStartDrag(event)"/>
</mx:WindowedApplication> 
```

# language-agnostic - 如何鼓励某人学习编程？

> ID：10872
> 
> 赞同：3
> 
> 时间：2008-08-14T10:34:05.073
> 
> 标签：language-agnostic

我有一个朋友有一点假期即将到来，他们想知道他们应该在假期做什么，我打算向他们建议编程，我需要提到的优点和缺点是什么？

当人们回复时，我将添加到下面的列表中，如果我重复任何条目，我深表歉意。

**到目前为止我的优点**

1.  最低的金钱要求（他们已经有一台电脑）
2.  将帮助他们以新的方式思考
3.  (Rob Cooper) 巨大的挑战，每一天在某种方式、形式或形式上确实是一个新的挑战。没有多少工作可以真正提供这一点。
4.  （Rob Cooper）我喜欢它让我思考的方式。随着我的技能提高，我会更合理地看待一切。这有助于一般生活和编程。
5.  (Rob Cooper) 金钱是/可以是相当不错的。
6.  （Rob Cooper）这是一项非常便携的交易。有了协作技术，只要您有互联网连接，您几乎可以在世界任何地方工作。
7.  (Rob Cooper) 这是一个令人兴奋的行业，有大量的技术可以工作和玩耍！
8.  （争吵）喷气背包。编程就是技术，我们花在技术上的时间越多，我们就越接近拥有 Jetpack。（*Teifion：这是一个非常酷的类比！*）
9.  (Saj) 锻炼脑部肌肉的盈利方式。
10.  (Saj) 它让你在某些观众眼里看起来很出色。
11.  (Saj) 让你变得科技智能。
12.  (Saj) 使你有资格进入未来的世界。
13.  （Saj）这很容易，很有趣，而不是数学方式..
14.  (kiwiBastard) 如果这个人喜欢解决问题，那么编程就是最好的例子。
15.  (kiwiBastard) 当你可以与你设计和编码的东西进行交互时，你会获得非凡的成就感
16.  （kiwiBastard）结识小鸡/小伙子的好方法 - 呃，也许不是那个（*Teifion：我不知道你在哪里编程，但我想有时间过来看看*）
17.  (epatel) 学习如何编程就像在霍格沃茨学习拼写。电脑永远是你的仆人……

**到目前为止我的缺点**

1.  当它不工作时可能会令人沮丧
2.  不是体育锻炼
3.  (Rob Cooper) 很多人只是为了钱。他们不喜欢手艺，只是显得懒惰、烦人，有时看到我非常喜欢的行业和劳动力被废话稀释，这真的会让我感到厌烦。这往往会对我们所有人产生不良影响。
4.  (Rob Cooper) 不太确定初始成本。是的，您可以以较低的成本开始使用 Java 或其他东西，但对我来说，在本地，对 .NET 开发人员的巨大需求，启动和运行成本可能很高. 然而，随着微软发布其主要开发产品线的非常好的 Express 版本所投入的大量工作，这种情况正在迅速/尚未成为这种情况。
5.  （Rob Cooper）这是一个终生的职业。我真的觉得你从来没有真正成为这个行业的“大师”，你停止了1-2年。你落伍了。。有些人不喜欢这个节奏。
6.  （Rob Cooper）有些极客可能很难共事。虽然我认为一般极客运动确实在变得更好，但你将永远拥有经典的“我比你更聪明”的极客，这真的很痛苦在所有的屁股！
7.  (Saj) 可能造成虚拟伤害。
8.  (Saj) 可以让人把他们的电脑扔掉。
9.  (Saj) 可以使一个只有虚拟可用的世界。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-08-14T10:50:21.420

## 我是为女士们做的：D

不过说真的，对我来说

### 专业人士

*   巨大的挑战，每一天在某种方式、形式或形式上确实是一个新的挑战。没有多少工作可以真正提供这一点。
*   我喜欢它让我思考的方式。随着我的技能提高，我会更合理地看待一切。这有助于一般生活和编程。
*   钱是/可以是相当不错的。
*   这是一项非常便携的交易。借助协作技术，只要您有互联网连接，您几乎可以在世界任何地方工作。
*   这是一个令人兴奋的行业，有大量的技术可以工作和玩耍！

### 缺点（其中一些也很容易成为 Pro 的）

*   有很多人*只是*为了钱。他们不喜欢**手艺**，只是显得懒惰、烦人，有时看到我非常喜欢的行业和劳动力被废话稀释，这真的会让我感到厌烦。这往往会对我们所有人产生不良影响。
*   不太确定初始成本。是的，您可以以低成本开始使用 Java 或其他东西，但对我而言，在本地，对 .NET 开发人员的巨大需求是启动和运行的成本高昂。然而，随着微软发布其主要开发产品线的非常好的 Express 版本所投入的大量工作，这种情况正在迅速/尚未成为这种情况。
*   这是一个终身的职业。我真的觉得你从来没有真正成为这个行业的“大师”，你停止了1-2年。你落伍了。。有些人不喜欢这个节奏。
*   有些极客可能很难共事。虽然我认为一般极客运动确实在变得更好，但你将*永远*拥有经典的“我比你更聪明”的极客，这真的只是一个痛苦的屁股全部！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-08-14T10:42:36.227

喷气背包。
编程就是技术，我们花在技术上的时间越多，我们就越接近拥有 Jetpack。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-08-14T10:36:04.350

编程是成为世界上最富有的人的方式之一。到目前为止，我们不知道其他任何人。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-08-14T16:45:34.227

我的建议是你不要太用力地逼迫你的朋友。如果您要建议他们从事编程，请随便提及。

向“未受启蒙”的人建议娱乐性计算机编程可以采取与建议他们做一些娱乐性数学或集邮相同的方式（没有冒犯任何集邮爱好者！）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-08-14T11:09:46.027

学习如何编程就像在*霍格沃茨*学习拼写。
电脑永远是你的仆人……

## --如果你有Mac--

一个简单的开始可能只是看一下*Automator*（是几个在线截屏视频，[即](http://www.youtube.com/watch?v=aq2lEsG68JU)），这是一种使程序比坐下来等待用户交互多一点的简单方法……不是**真正的**编程，但给人一种感觉很少编程可以做到。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-08-14T10:42:16.460

*   如果这个人喜欢解决问题，那么编程就是最好的例子。
*   当您可以与您设计和编码的东西进行交互时，会产生出色的成就感
*   认识小鸡/小伙子的好方法 - 呃，也许不是那个

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-08-14T17:04:36.823

我会跟进 Carl Russmann 的评论，建议你不要对你的朋友施加太大压力。

这个网站的大多数读者都觉得编程很有趣，但我们真的很奇怪。

对于大多数人来说，学习编程将是一项非常艰苦的工作，短期收益不大。大多数人没有编程的天分，并且会发现它和缴纳所得税一样有趣。这是一个大骗局。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-08-14T17:08:44.693

你可以告诉他女孩是多么喜欢程序员……你知道，撒谎。

# html - 如何自定义有序列表中的数字？

> ID：10877
> 
> 赞同：117
> 
> 时间：2008-08-14T10:42:32.013
> 
> 标签：html, css, html-lists, roman-numerals

如何左对齐有序列表中的数字？

```
1\.  an item
// skip some items for brevity 
9\.  another item
10\. notice the 1 is under the 9, and the item contents also line up 
```

更改有序列表中数字后的字符？

```
1) an item 
```

还有一个 CSS 解决方案可以从数字更改为字母/罗马列表，而不是使用 ol 元素上的 type 属性。

我最感兴趣的是适用于 Firefox 3 的答案。

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-01-28T06:31:49.953

这是我在 Firefox 3、Opera 和 Google Chrome 中使用的解决方案。该列表仍显示在 IE7 中（但没有右括号和左对齐数字）：

```
ol {
  counter-reset: item;
  margin-left: 0;
  padding-left: 0;
}
li {
  display: block;
  margin-bottom: .5em;
  margin-left: 2em;
}
li::before {
  display: inline-block;
  content: counter(item) ") ";
  counter-increment: item;
  width: 2em;
  margin-left: -2em;
}
```

```
<ol>
  <li>One</li>
  <li>Two</li>
  <li>Three</li>
  <li>Four</li>
  <li>Five</li>
  <li>Six</li>
  <li>Seven</li>
  <li>Eight</li>
  <li>Nine<br>Items</li>
  <li>Ten<br>Items</li>
</ol>
```

**编辑：**包含由 strager 进行的多行修复

> 还有一个 CSS 解决方案可以从数字更改为字母/罗马列表，而不是使用 ol 元素上的 type 属性。

请参阅[list-style-type](http://www.w3.org/TR/CSS2/generate.html#lists) CSS 属性。或者当使用计数器时，第二个参数接受一个列表样式类型的值。例如以下将使用大写罗马：

```
li::before {
  content: counter(item, upper-roman) ") ";
  counter-increment: item;
/* ... */ 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-08-14T11:01:30.880

样式列表的 CSS 在[这里](http://www.w3.org/TR/REC-CSS2/generate.html#lists)，但基本上是：

```
li {
    list-style-type: decimal;
    list-style-position: inside;
} 
```

但是，您所追求的特定布局可能只能通过像[这样](http://www.w3.org/TR/REC-CSS2/generate.html#counters)深入研究布局的内部来实现（请注意，我实际上并没有尝试过）：

```
ol { counter-reset: item }
li { display: block }
li:before { content: counter(item) ") "; counter-increment: item } 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2020-02-06T17:40:42.843

# HTML5：使用`value`属性（不需要 CSS）

现代浏览器将解释该`value`属性并将其显示为您所期望的。请参阅[MDN 文档](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/li#attr-value)。

```
<ol>
  <li value="3">This is item three.</li>
  <li value="50">This is item fifty.</li>
  <li value="100">This is item one hundred.</li>
</ol>
```

还可以查看 MDN 上[的`<ol>`文章](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ol)，尤其是`start`and 属性的文档。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-08-05T04:53:54.147

您还可以在 HTML 中指定自己的数字 - 例如，如果数字是由数据库提供的：

```
ol {
  list-style: none;
}

ol>li:before {
  content: attr(seq) ". ";
}
```

```
<ol>
  <li seq="1">Item one</li>
  <li seq="20">Item twenty</li>
  <li seq="300">Item three hundred</li>
</ol>
```

`seq`使用类似于其他答案中给出的方法使该属性可见。但我们不使用`content: counter(foo)`，而是使用`content: attr(seq)`。

[更多样式的 CodePen 演示](http://codepen.io/anon/pen/xGMERG)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-28T15:54:43.423

从其他答案中偷了很多，但这对我来说在 FF3 中有效。它有`upper-roman`，统一缩进，一个右括号。

```
ol {
  counter-reset: item;
  margin-left: 0;
  padding-left: 0;
}
li {
  margin-bottom: .5em;
}
li:before {
  display: inline-block;
  content: counter(item, upper-roman) ")";
  counter-increment: item;
  width: 3em;
}
```

```
<ol>
  <li>One</li>
  <li>Two</li>
  <li>Three</li>
  <li>Four</li>
  <li>Five</li>
  <li>Six</li>
  <li>Seven</li>
  <li>Eight</li>
  <li>Nine</li>
  <li>Ten</li>
</ol>
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-08-18T14:51:27.767

我建议使用 :before 属性，看看你能用它实现什么。这将意味着您的代码确实仅限于漂亮的新浏览器，并且排除了仍在使用垃圾旧浏览器的市场（令人讨厌的大）部分，

像下面这样的东西，它强制对项目进行固定。是的，我知道必须自己选择宽度不太优雅，但是使用 CSS 进行布局就像卧底警察一样：无论你的动机多么好，它总是会变得混乱。

```
li:before {
  content: counter(item) ") ";
  counter-increment: item;
  display: marker;
  width: 2em;
} 
```

但是您将不得不进行实验以找到确切的解决方案。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-08-24T10:30:06.393

如果将前导零添加到数字中，则数字排列得更好，方法是将[list-style-type](http://www.w3.org/TR/REC-CSS2/generate.html#propdef-list-style-type)设置为：

```
ol { list-style-type: decimal-leading-zero; } 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-28T20:01:32.097

借用并改进了[马库斯唐宁的答案](https://stackoverflow.com/questions/10877/how-can-you-customize-the-numbers-in-an-ordered-list#10887)。在 Firefox 3 和 Opera 9 中测试并运行。也支持多行。

```
ol {
    counter-reset: item;
    margin-left: 0;
    padding-left: 0;
}

li {
    display: block;
    margin-left: 3.5em;          /* Change with margin-left on li:before.  Must be -li:before::margin-left + li:before::padding-right.  (Causes indention for other lines.) */
}

li:before {
    content: counter(item) ")";  /* Change 'item' to 'item, upper-roman' or 'item, lower-roman' for upper- and lower-case roman, respectively. */
    counter-increment: item;
    display: inline-block;
    text-align: right;
    width: 3em;                  /* Must be the maximum width of your list's numbers, including the ')', for compatability (in case you use a fixed-width font, for example).  Will have to beef up if using roman. */
    padding-right: 0.5em;
    margin-left: -3.5em;         /* See li comments. */
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-08-14T11:03:49.830

有一个[Type 属性](http://www.htmlcodetutorial.com/_OL_TYPE.html)允许您更改编号样式，但是，您不能更改数字/字母后的句号。

```
<ol type="a">
    <li>Turn left on Maple Street</li>
    <li>Turn right on Clover Court</li>
</ol> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-28T06:53:43.827

文档说关于[`list-style-position`](http://www.w3.org/TR/CSS2/generate.html#propdef-list-style-position)`: outside`

> CSS1 没有指定标记框的精确位置，出于兼容性的原因，CSS2 仍然同样模棱两可。要更精确地控制标记框，请使用标记。

再往上一页是关于标记的东西。

一个例子是：

```
 LI:before { 
           display: marker;
           content: "(" counter(counter) ")";
           counter-increment: counter;
           width: 6em;
           text-align: center;
       } 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-11-22T23:45:10.347

不...只需使用 DL：

```
dl { overflow:hidden; }
dt {
 float:left;
 clear: left;
 width:4em; /* adjust the width; make sure the total of both is 100% */
 text-align: right
}
dd {
 float:left;
 width:50%; /* adjust the width; make sure the total of both is 100% */
 margin: 0 0.5em;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-01T17:02:14.400

**快速和肮脏的**替代解决方案。您可以将制表符与预先格式化的文本一起使用。这是一种可能性：

```
<style type="text/css">
ol {
    list-style-position: inside;
}
li:first-letter {
    white-space: pre;
}
</style> 
```

和你的html：

```
<ol>
<li>    an item</li>
<li>    another item</li>
...
</ol> 
```

请注意，`li`标记和文本开头之间的空格是一个制表符（当您在记事本中按 Tab 键时得到的）。

如果您需要支持较旧的浏览器，您可以这样做：

```
<style type="text/css">
ol {
    list-style-position: inside;
}
</style>

<ol>
    <li><pre>   </pre>an item</li>
    <li><pre>   </pre>another item</li>
    ...
</ol> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-02-08T17:10:48.170

我将在这里给出我通常不喜欢阅读的那种答案，但我认为，由于还有其他答案告诉你如何实现你想要的，重新考虑你想要实现的是否真的是很好的一个好主意。

首先，您应该考虑以非标准方式显示项目是否是一个好主意，并且分隔符字符与提供的不同。

我不知道原因，但让我们假设你有充分的理由。

这里提出的实现方式包括向您的标记添加内容，主要是通过 CSS :before 伪类。该内容实际上是在修改您的 DOM 结构，将这些项目添加到其中。

当您使用标准的“ol”计数时，您将拥有一个呈现的内容，其中“li”文本是可选的，但它前面的数字是不可选的。也就是说，标准的编号系统看起来更像是“装饰”而不是真实的内容。如果您使用例如那些“:before”方法为数字添加内容，则该内容将是可选的，并且由于此，执行不希望的vopy/paste问题，或屏幕阅读器的可访问性问题，将阅读此“新”内容此外到标准计数系统。

也许另一种方法是使用图像来设置数字的样式，尽管这种替代方法会带来自己的问题（禁用图像时数字不显示，数字的文本大小不变，...）。

无论如何，这个答案的原因不仅仅是提出这个“图像”替代方案，而是让人们思考试图改变有序列表的标准计数系统的后果。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-03-27T14:52:35.330

此代码使编号样式与 li 内容的标题相同。

```
<style>
    h4 {font-size: 18px}
    ol.list-h4 {counter-reset: item; padding-left:27px}
    ol.list-h4 > li {display: block}
    ol.list-h4 > li::before {display: block; position:absolute;  left:16px;  top:auto; content: counter(item)"."; counter-increment: item; font-size: 18px}
    ol.list-h4 > li > h4 {padding-top:3px}
</style>

<ol class="list-h4">
    <li>
        <h4>...</h4>
        <p>...</p> 
    </li>
    <li>...</li>
</ol> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-01-27T18:30:25.333

Vhndaree在一个重复的问题上[发布了这个问题的有趣实现](https://stackoverflow.com/a/70835307/2756409)，它比任何现有答案都更进一步，因为它在递增数字*之前实现了一个自定义字符：*

> ```
>  .custom {
>      list-style-type: none;
>  }
>  .custom li {
>      counter-increment: step-counter;
>  }
>  .custom li::before {
>      content: '(' counter(step-counter) ')';
>      margin-right: 5px;
>  } 
> ```
> 
> ```
>  <ol class="custom">
>     <li>First</li>
>     <li>Second</li>
>     <li>Third</li>
>     <li>Fourth</li>
>     <li>Fifth</li>
>     <li>Sixth</li>
>     <li>Seventh</li>
>     <li>Eighth</li>
>     <li>Ninth</li>
>     <li>Tenth</li>
>  </ol> 
> ```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-01-28T14:49:18.687

我有它。尝试以下操作：

```
<html>
<head>
<style type='text/css'>

    ol { counter-reset: item; }

    li { display: block; }

    li:before { content: counter(item) ")"; counter-increment: item; 
        display: inline-block; width: 50px; }

</style>
</head>
<body>
<ol>
    <li>Something</li>
    <li>Something</li>
    <li>Something</li>
    <li>Something</li>
    <li>Something</li>
    <li>Something</li>
    <li>Something</li>
    <li>Something</li>
    <li>Something</li>
    <li>Something</li>
    <li>Something</li>
    <li>Something</li>
</ol>
</body> 
```

问题是，这*绝对*不适用于较旧或不太兼容的浏览器：`display: inline-block`这是一个非常新的属性。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2011-11-28T02:44:12.240

从概念的角度来看，其他答案更好。但是，您可以用适当数量的 ' ' 填充数字 让他们排队。

***注意：我一开始并没有意识到正在使用编号列表。我认为该列表是明确生成的。

# c++ - 关于在 C++ 项目中使用 emacs 有什么好的建议吗？

> ID：10880
> 
> 赞同：39
> 
> 时间：2008-08-14T10:42:59.627
> 
> 标签：c++, emacs

我正在寻找一篇关于将 emacs 用作 C/C++ IDE 的好文章。

类似于 Steve Yegge 的[“Effective emacs”](http://steve.yegge.googlepages.com/effective-emacs)。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-08-14T11:04:13.680

没有具体的文章，真的，但我发现[EmacsWiki](http://www.emacswiki.org/cgi-bin/wiki)充满了有用的信息。考虑检查这些条目：

*   [CPlusPlus](http://www.emacswiki.org/cgi-bin/wiki/CPlusPlus)作为许多 C++ 相关文章的起点，以及
*   [CppTemplate](http://www.emacswiki.org/cgi-bin/wiki/CppTemplate)定义一个模板，当你开始新文件时可以给你一个很好的骨架

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-11T08:55:54.657

我最近偶然发现了这篇[文章](http://www.physics.ucsb.edu/~taro/comp/tips/emacs/emacs-c-dev.html)，非常好。

编辑：是的，链接不再有效。好像他们最近更改了他们的网址，并且没有正确重定向。希望它会很快回来。无论如何，这篇文章被称为“Benjamin Rutt 的 Emacs C 开发技巧”。我设法在[这里](http://xugx2007.blogspot.com/2007/06/benjamin-rutts-emacs-c-development-tips.html)找到了一份副本。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-19T08:15:27.310

我打算在不久的将来写这样的文章，但你现在可以使用[我](http://xtalk.msk.su/~ott/common/emacs/rc/emacs-rc-cedet.el.html)的[Cedet](http://cedet.sf.net) + Emacs 配置，这有助于我有效地编辑 C++ 源代码。有问题可以直接问我

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-05-05T01:05:44.197

请注意，Emacs 的 C++ 模式仅基于正则表达式，而不是语法。因此，语法高亮并不严格基于语言本身的语法，而是主要基于普通格式。C++ 的 Emacs 语法高亮经常出错。

问题不仅限于语法高亮。相同的缺陷设计适用于自动格式化。综上所述，自 cfront 时代以来，20 多年来我一直只使用 Emacs 来编辑 C++ 源代码。（我通常关闭电子键绑定，因为 Emacs 基于正则表达式的设计有缺陷。正则表达式没有足够的表达能力来准确描述 C++ 语法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-05T15:32:31.770

我推荐[ggtags](https://github.com/leoliu/ggtags)和[irony-mode](https://github.com/Sarcasm/irony-mode)。除此之外，您可能希望使用[helm-ag](https://github.com/syohex/emacs-helm-ag)在代码库中搜索（“grep”）字符串。

# sql-server - 使用 MFC 连接到 Sql Server 的最佳方式

> ID：10891
> 
> 赞同：4
> 
> 时间：2008-08-14T11:05:21.743
> 
> 标签：sql-server, mfc

太好了，我很快就要开始这项新工作，其中大部分代码都是旧版 MFC。最终目标是转换/重写为`C#`.

我对 MFC 有点生疏，所以写了一些代码，这样我就可以尝试激发我的记忆。无论如何，想知道用 MFC 连接到 SS2005 数据库的最佳方法。过去通过 ODBC 的 CDatabase 是要走的路，在过去的几年里发生了变化吗？我看到您可以使用 ATL 和 ADO，但看起来有点冗长，我喜欢吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-08-14T11:49:25.883

OleDb 的 ATL 使用者模板是一个选项 - 从[这里](http://msdn.microsoft.com/en-us/library/fk4h509a(VS.80).aspx)开始。ClassWizard 仍然在那里为您提供帮助，因此一开始的冗长并不是太大的障碍。不过，很快您将需要手动编码。有很多小心翼翼的操作，例如确保您的命令字符串具有完全正确的 ? 对应于访问器的 COLUMN_ENTRY 的标记。然后你可能会有一百万个 CopyToCommandFromObject 和 CopyToObjectFromCommand 方法。

这个应用程序还没有任何数据访问权限，您要添加它吗？如果是这样，我会认真考虑在单独的托管程序集中实施现代 DAL（ADO.Net，linq，如果你有幸在 2008 年）并进行一些互操作。

# sql-server - 如何在 64 位 SQL Server 2005 上设置 DB2 链接服务器？

> ID：10898
> 
> 赞同：4
> 
> 时间：2008-08-14T11:18:39.113
> 
> 标签：sql-server, db2

我需要在大型机上创建一个连接到 DB2 数据库的链接服务器。有没有人在 64 位版本的 SQL Server 2005 上成功完成此操作？如果是这样，使用了哪些提供程序和设置？

无论我们是使用 Windows 身份验证帐户登录 SQL Server 还是使用 SQL Server 登录，链接服务器都能正常工作，这一点很重要。`OPENQUERY`由 4 部分组成的名称和查询方法都可以正常工作也很重要。我们在一台运行良好的 SQL Server 2000 机器上设置了一个，但它使用的提供程序不适用于 64 位 SS 2005。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-08-22T01:01:54.557

去年年底（2007 年 9 月），我们在生产系统中遇到了同样的问题，我们的 Microsoft 联系人的官方消息是他们有一个 64 位 oledb 驱动程序可以连接到 ASI/DB2 **，但**当时它还处于**BETA**阶段。

不确定它什么时候会退出测试版，但这是去年的新闻。

我们决定将生产服务器移到 32 位机器上，因为我们不习惯在生产系统上使用 beta 驱动程序。

我知道这不能*回答*您的问题，但希望能给您一些见解

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-08-21T23:50:22.640

您为 Sql 2000 使用的提供程序是什么？我很确定 MS 有一个用于 DB2 的 x64 OLEDB 驱动程序（主机集成服务器的一部分，但可以单独下载）。IBM 有用于 .NET 和 ODBC 的 x64，以及可能的 OLEDB（虽然它是一个 PITA 可找到）。

一旦您设置了链接服务器，我很确定您的所有其他要求都是自动的....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-08-22T14:53:58.287

从[Sql 2005 February 2007 Feature Pack 开始](http://www.microsoft.com/downloads/details.aspx?FamilyID=50b97994-8453-4998-8226-fa42ec403d17&DisplayLang=en)：

> Microsoft OLE DB Provider for DB2 是一个 COM 组件，用于将存储在 IBM DB2 数据库中的重要数据与基于 Microsoft SQL Server 2005 Enterprise Edition 和 Developer Edition 的新解决方案集成。SQL Server 开发人员和管理员可以将提供程序与集成服务、分析服务、复制、报告服务和分布式查询处理器一起使用。运行自解压下载包，创建安装文件夹。单个安装程序将在 x86、x64 和 IA64 计算机上安装提供程序和工具。

# c# - 面向未来的大型 UI 应用程序 - 带有 2008 功能包的 MFC，还是 C# 和 Winforms？

> ID：10901
> 
> 赞同：12
> 
> 时间：2008-08-14T11:26:02.733
> 
> 标签：c#, c++, winforms, mfc, user-interface

我的公司开发了一个长期使用的产品，它使用 Visual C++ 中的 MFC 作为 UI 开发的事实标准。我们的代码库包含大量必须保持可操作的遗留/过时代码。其中一些代码比我更老（最初是在 70 年代后期编写的），我们团队的一些成员仍在使用 Visual Studio 6。

然而，值得庆幸的是，内部得出的结论是，与竞争对手的产品相比，我们的产品看起来有些过时，需要做点什么。

我目前正在开发 UI 的一个新区域，该区域与产品的其余部分完全不同。因此，我有机会在 UI 其余部分的漫长过程开始之前尝试“新”技术堆栈作为一种试验场。

我在业余时间一直在使用 C# 与 Windows 窗体和 .net 框架并享受它，但有点担心互操作带来的头痛。虽然 UI 的这个特定分支不需要与传统 C++ 代码库进行太多互操作，但我可以预见这将成为未来的一个问题。

另一种方法是继续使用 MFC，但尝试利用 VS2008 附带的新功能包。我想这是最简单的选择，但我担心长寿而不是利用 .net 的优点......

那么，我该选哪个？我们是一个小团队，所以我的建议很可能会被接受为我们未来的发展方向——我想把它做好。

MFC死了吗？C#/Winforms 是前进的方向吗？还有什么我完全想念的吗？非常感谢帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-08-14T13:32:29.810

我是一个拥有大量遗留 MFC 代码的应用程序的开发人员，我们也有你同样的担忧。我们战略的一个重要推动力是尽可能多地消除风险和不确定性，这意味着避免大重写。众所周知，TBR 大部分时间都失败了。因此，我们选择了一种增量方法，允许我们保留在当前版本中不会更改的模块，编写托管的新功能，并移植正在增强托管的功能。

您可以通过以下几种方式执行此操作：

1.  在 MFC 视图上托管 WPF 内容（请参见[此处](http://www.codeguru.com/cpp/cpp/cpp_managed/interop/article.php/c14589)）

2.  对于 MFC MDI 应用程序，创建一个新的 WinForms 框架并托管您的 MFC MDI 视图（请参阅[此处](http://www.codeproject.com/KB/miscctrl/HostMFC.aspx)）

3.  在 MFC 对话框和视图中托管 WinForms 用户控件（请参阅[此处](http://msdn.microsoft.com/en-us/library/ahdd1h97.aspx)）

采用 WPF（选项 1）的问题在于，它需要您一次重写所有 UI，否则它看起来会让人精神分裂。

第二种方法看起来可行但非常复杂。

第三种方法是我们选择的方法，效果很好。它允许您有选择地刷新应用程序的区域，同时保持整体一致性并且不触及未损坏的内容。

Visual C++ 2008 Feature Pack 看起来很有趣，不过我还没有玩过。似乎它可能有助于解决您过时的外观问题。如果“功能区”对您的用户来说过于刺耳，您可以查看第三方 MFC 和/或 WinForms 控件供应商。

我的总体建议是互操作 + 增量更改绝对比彻底更改更可取。

* * *

在阅读了您的后续文章后，我可以肯定地确认该框架的生产力收益大大超过了学习它的投资。我们团队中没有人在这项工作开始时使用过 C#，现在我们都更喜欢它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-08-14T11:40:53.373

根据应用程序和客户安装 .NET 的意愿（并非所有客户都安装），我肯定会转向 WinForms 或 WPF。通过使用 C++/CLI 将非 UI 代码重构为类库，与 C++ 代码的互操作大大简化（正如您在选择标签时所指出的那样）。

WPF 的唯一问题是可能很难保持当前的外观。可以在保持 GUI 的当前外观的同时迁移到 WinForms。WPF 使用如此不同的模型，试图保持当前布局可能是徒劳的，而且绝对不符合 WPF 的精神。当运行多个 WPF 进程时，WPF 在 Vista 之前的机器上的性能显然也很差。

我的建议是找出您的客户正在使用什么。如果大多数人已经迁移到 Vista 并且您的团队准备投入大量 GUI 工作，我会说跳过 WinForms 并迁移到 WPF。否则，一定要认真看待 WinForms。无论哪种情况，C++/CLI 中的类库都可以解决您的互操作问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-08-14T12:04:56.460

您没有详细说明遗留代码的功能或结构。如果您有某些性能标准，您可能希望在 C++ 中维护一些代码库。如果以正确的方式公开旧代码，您将更容易与旧代码进行互操作 - 您今天可以从 C# 调用现有代码库吗？可能值得考虑一个使这种结构正确的项目。

关于 WPF，您可能会争辩说 WinForms 可能更合适。迁移到 WinForms 对您和您的团队来说是一大步。也许他们可能更愿意迁移到 WinForms？如果您仍然需要支持 Windows 2000 客户端，它会提供更好的文档、更多的市场经验和有用的信息。

您可能对[使用 .NET Framework 扩展 MFC 应用程序感兴趣](https://rads.stackoverflow.com/amzn/click/com/032117352X)

其他需要考虑的是[C++/CLI](http://en.wikipedia.org/wiki/C%2B%2B/CLI)，但我没有这方面的经验。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-08-14T13:30:47.177

非常感谢大家的回复，令人欣慰的是，普遍共识遵循我的思路。我很幸运，我们的软件也可以在我们自己的定制硬件上运行（用于广播行业）——所以操作系统的选择实际上是我们的，并且是强加给我们的客户的。目前我们正在运行 XP/2000，但我可以看到希望尽快升级到 Vista。

但是，我们还需要对 GPU 性能保持非常精细的控制，我猜这会自动排除 WPF 和硬件加速？我应该在我原来的帖子中指出这一点——对不起。也许可以使用两个 GPU……但这完全是另一个问题……

该团队没有任何重要的 C# 经验，我自己也不是专家，但我认为托管环境的整体长期利益可能超过了加快速度所需的时间。

看起来像 Winforms 和 C# 现在有它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-08-14T11:28:23.570

如果您考虑迁移到 C# 并因此迁移到 .NET，我会考虑 Windows Presentation Foundation 而不是 WinForms。WPF 是 .NET 中智能客户端的未来，如果您想制作浏览器托管的 Silverlight 应用程序，您将能够重用所掌握的技能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-08-14T11:36:47.173

我同意 WPF 的观点。基于标签/XML 的 UI 似乎比 WinForms 更便携。

我想你也必须考虑你的团队，如果当前没有很多 C# 技能，那么这是一个因素，但未来 MFC 开发人员的市场正在减少，而 C# 正在增长。

也许某种零碎的方法是可能的？我已经参与了很多将遗留应用程序重新编码为 C# 的工作，而且它总是需要比你估计的要长得多，特别是如果你保留一些遗留代码，或者你的团队不太熟悉 C#。

# c# - 你可以在 C# 中使用泛型表单吗？

> ID：10905
> 
> 赞同：32
> 
> 时间：2008-08-14T11:30:54.970
> 
> 标签：c#, .net, winforms

您应该能够创建一个通用表单：

```
public partial class MyGenericForm<T> :
    Form where T : class
{
    /* form code */
    public List<T> TypedList { get; set; }
} 
```

是有效的 C#，并且可以编译。但是，如果您有任何图像表明它无法找到资源，则设计器将无法工作，并且表单将引发运行时异常。

我认为这是因为 Windows 窗体设计器假定资源将存储在简单类型的名称下。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-08-14T11:33:21.377

是的你可以！这是我不久前用这个技巧写的一篇博文：

[设计通用表单](http://www.madprops.org/blog/designing-generic-forms/)

编辑：看起来你已经这样做了。这种方法效果很好，所以我不会认为它太 hacky。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-08-14T11:32:45.137

我有一个解决这个问题的方法，它有效但并不理想：

向项目中添加一个新类，该类以其简单名称继承表单。

```
internal class MyGenericForm:
    MyGenericForm<object> { } 
```

这意味着尽管设计者仍然是错误的，但`<>`仍然可以找到预期的简单类型（即没有 ）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-23T11:21:12.997

您可以分三个步骤完成。

1) 在 Form1.cs 文件中替换

```
public partial class Form1<TEntity, TContext> : Formbase // where.... 
```

2) 在 Form1.Designer.cs 中替换

```
 partial class Form1<TEntity, TContext> 
```

3）创建新文件：Form1.Generic.cs（用于打开设计）

```
partial class Form1
{
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-04T09:03:29.703

如果旧石器时代的代码不让你害怕

```
 public  static MyForm GetInstance<T>(T arg) where T : MyType
{
    MyForm myForm = new MyForm();

    myForm.InitializeStuffs<T>(arg);
    myForm.StartPosition = myForm.CenterParent;

    return myForm;
} 
```

用它

```
var myFormInstance = MyForm.GetInstance<T>(arg);                                                                      myFormInstance.ShowDialog(this); 
```

# c# - 处理遗留数据库时在 NHibernate 中建模多对一关系的最佳方法？

> ID：10915
> 
> 赞同：3
> 
> 时间：2008-08-14T11:56:29.550
> 
> 标签：c#, nhibernate

警告 - 我对 NHibernate 很陌生。我知道这个问题看起来很简单——我敢肯定有一个简单的答案，但我已经在这个问题上旋转了一段时间。我正在处理一个在结构上确实无法改变的遗留数据库。我有一个详细信息表，其中列出了客户已接受的付款计划。每个付款计划都有一个 ID，它链接回参考表以获取计划的条款、条件等。在我的对象模型中，我有一个 AcceptedPlan 类和一个 Plan 类。最初，我在 NHibernate 中使用从 detail 表到 ref 表的多对一关系来建模这种关系。我还创建了一个从 Plan 类到 AcceptedPlan 类的相反方向的一对多关系。当我只是读取数据时，这很好。我可以转到我的计划对象，这是我的 AcceptedPlan 类的一个属性，以阅读计划的详细信息。当我不得不开始向详细信息表中插入新行时，我的问题就出现了。根据我的阅读，似乎创建新子对象的唯一方法是将其添加到父对象，然后保存会话。但是我不想每次创建新的详细记录时都必须创建一个新的父 Plan 对象。这似乎是不必要的开销。有谁知道我是否以错误的方式处理这个问题？不想每次我想创建一个新的详细记录时都必须创建一个新的父计划对象。这似乎是不必要的开销。有谁知道我是否以错误的方式处理这个问题？不想每次我想创建一个新的详细记录时都必须创建一个新的父计划对象。这似乎是不必要的开销。有谁知道我是否以错误的方式处理这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-08-14T15:04:15.240

我会避免让子对象包含其逻辑父对象，当您这样做时，它会很快变得非常混乱和非常递归。在你做那种事情之前，我会先看看你打算如何使用域模型。您仍然可以轻松地在表中保留 ID 引用，而无需将它们映射。

这里有两个示例映射可能会推动您朝着正确的方向前进，我不得不即兴发挥表名等，但它可能会有所帮助。我可能还建议将 StatusId 映射到枚举。

注意包有效地将详细信息表映射到集合的方式。

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping default-cascade="save-update" xmlns="urn:nhibernate-mapping-2.2">
    <class lazy="false" name="Namespace.Customer, Namespace" table="Customer">
        <id name="Id" type="Int32" unsaved-value="0">
            <column name="CustomerAccountId" length="4" sql-type="int" not-null="true" unique="true" index="CustomerPK"/>
            <generator class="native" />
        </id>

        <bag name="AcceptedOffers" inverse="false" lazy="false" cascade="all-delete-orphan" table="details">
          <key column="CustomerAccountId" foreign-key="AcceptedOfferFK"/>
          <many-to-many
            class="Namespace.AcceptedOffer, Namespace"
            column="AcceptedOfferFK"
            foreign-key="AcceptedOfferID"
            lazy="false"
           />
        </bag>

  </class>
</hibernate-mapping>

<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping default-cascade="save-update" xmlns="urn:nhibernate-mapping-2.2">
    <class lazy="false" name="Namespace.AcceptedOffer, Namespace" table="AcceptedOffer">
        <id name="Id" type="Int32" unsaved-value="0">
            <column name="AcceptedOfferId" length="4" sql-type="int" not-null="true" unique="true" index="AcceptedOfferPK"/>
            <generator class="native" />
        </id>

        <many-to-one 
          name="Plan"
          class="Namespace.Plan, Namespace"
          lazy="false"
          cascade="save-update"
        >
        <column name="PlanFK" length="4" sql-type="int" not-null="false"/>
        </many-to-one>

        <property name="StatusId" type="Int32">
            <column name="StatusId" length="4" sql-type="int" not-null="true"/>
        </property>

  </class>
</hibernate-mapping> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-08-14T15:12:04.477

我在写的时候没有看到你的数据库图。

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping default-cascade="save-update" xmlns="urn:nhibernate-mapping-2.2">
    <class lazy="false" name="Namespace.Customer, Namespace" table="Customer">
        <id name="Id" type="Int32" unsaved-value="0">
            <column name="customer_id" length="4" sql-type="int" not-null="true" unique="true" index="CustomerPK"/>
            <generator class="native" />
        </id>

        <bag name="AcceptedOffers" inverse="false" lazy="false" cascade="all-delete-orphan">
            <key column="accepted_offer_id"/>
            <one-to-many class="Namespace.AcceptedOffer, Namespace"/>
        </bag>

  </class>
</hibernate-mapping>

<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping default-cascade="save-update" xmlns="urn:nhibernate-mapping-2.2">
    <class lazy="false" name="Namespace.AcceptedOffer, Namespace" table="Accepted_Offer">
        <id name="Id" type="Int32" unsaved-value="0">
            <column name="accepted_offer_id" length="4" sql-type="int" not-null="true" unique="true" />
            <generator class="native" />
        </id>

        <many-to-one name="Plan" class="Namespace.Plan, Namespace" lazy="false" cascade="save-update">
            <column name="plan_id" length="4" sql-type="int" not-null="false"/>
        </many-to-one>

  </class>
</hibernate-mapping> 
```

应该可以解决问题（我只为集合做了示例映射，您必须添加其他属性）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-08-14T13:23:43.993

我将采取的建模方法如下：

Customer 对象包含一个 ICollection <PaymentPlan> PaymentPlans，它表示客户已接受的计划。

将使用包映射到客户的付款计划，该包使用详细信息表来确定哪个客户 ID 映射到哪些付款计划。使用 cascade all-delete-orphan，如果客户被删除，则详细信息中的条目和客户拥有的 PaymentPlans 都将被删除。

PaymentPlan 对象包含一个表示付款计划条款的 PlanTerms 对象。

PlanTerms 将使用多对一映射级联保存更新映射到 PaymentPlan，它只会将相关 PlanTerms 对象的引用插入到 PaymentPlan 中。

使用此模型，您可以独立创建 PlanTerms，然后当您向客户添加新的 PaymentPlan 时，您将创建一个传入相关 PlanTerms 对象的新 PaymentPlan 对象，然后将其添加到相关 Customer 的集合中。最后，您将保存 Customer 并让 nhibernate 级联保存操作。

您最终会得到一个 Customer 对象、一个 PaymentPlan 对象和一个 PlanTerms 对象，其中 Customer（客户表）拥有 PaymentPlans 实例（详细信息表），所有这些实例都遵循特定的 PlanTerms（计划表）。

如果需要，我有一些更具体的映射语法示例，但最好使用您自己的模型完成它，而且我没有足够的数据库表信息来提供任何具体示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-08-14T13:25:49.340

我不知道这是否可能是因为我的 NHibernate 经验有限，但您能否创建一个 BaseDetail 类，该类仅具有 Details 的属性，因为它们直接映射到 Detail 表。

然后创建第二个类，该类继承自具有附加父计划对象的 BaseDetail 类，因此当您只想创建一个详细信息行并将 PlanId 分配给它时，您可以创建一个 BaseDetail 类，但如果您需要填充完整的详细信息记录与父计划对象可以使用继承的细节类。

我不知道这是否有很大的意义，但请告诉我，我会进一步澄清。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-08-14T14:56:01.437

我认为您在这里遇到的问题是您的 AcceptedOffer 对象包含一个 Plan 对象，然后您的 Plan 对象似乎包含一个包含 AcceptedOffer 对象的 AcceptedOffers 集合。与客户相同。我认为，这些对象是彼此的孩子的事实是导致您的问题的原因。

同样，使您的 AcceptedOffer 变得复杂的原因在于它有两个职责：它表示计划中包含的报价，它表示客户接受。这违反了单一职责原则。

您可能必须区分计划下的报价和客户接受的报价。所以这就是我要做的：

1.  创建一个没有状态的单独的 Offer 对象，例如，它没有客户，也没有状态——它只有一个 OfferId 和它所属的计划作为它的属性。
2.  修改您的 Plan 对象以拥有一个 Offers 集合（它不必在其上下文中接受 offer）。
3.  最后，修改 AcceptedOffer 对象，使其包含要约、客户和状态。客户保持不变。

我认为这将充分解决您的 NHibernate 映射和对象保存问题。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-08-14T15:04:57.347

在 NHibernate 中可能（或可能没有）有用的提示：您可以将对象映射到视图，就好像视图是一个表一样。只需将视图名指定为表名即可；只要所有 NOT NULL 字段都包含在视图和映射中，它就可以正常工作。

# sql-server - 您如何测量 SQL 填充因子值

> ID：10919
> 
> 赞同：8
> 
> 时间：2008-08-14T12:07:27.750
> 
> 标签：sql-server, fillfactor

通常，当我在表上创建索引时，我通常`Fill Factor`会根据对如何使用表的有根据的猜测（多次读取或多次写入）来猜测应该是什么。

是否有更科学的方法来确定更准确的`Fill Factor`值？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-08-14T12:16:03.770

您可以尝试运行大量实际操作并查看不同操作的 IO 队列。

有很多变量可以控制它，例如每行的大小以及写入与读取的数量。

基本上：高填充因子 = 更快的读取，低 = 更快的写入。

然而，它并不是那么简单，因为几乎所有的写入都将写入需要首先查找的行的子集。

例如：将填充因子设置为 10%，每次单行更新将花费 10 倍的时间来找到它正在更改的行，即使页面拆分不太可能发生。

通常，您会看到 70%（非常高的写入）到 95%（非常高的读取）的填充因子。

这是一种艺术形式。

我发现考虑填充因子的一种好方法是作为地址簿中的页面 - 将地址打包得越紧，更改它们就越难，但书越薄。[我想我在博客](http://bizvprog.blogspot.com/2008/02/expensive-database-server-1980s-filofax.html)上解释得更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-08-14T12:49:32.597

我倾向于认为，如果您追求性能改进，您的时间最好花在其他地方，调整您的架构，优化您的查询并确保良好的索引覆盖率。*填充因子是您只需要在知道*系统中的其他所有内容都处于最佳状态时才需要担心的事情之一。我不知道有谁能这么说。

# apache-flex - 在 E4X (AS3 - Flex) 中删除/替换节点

> ID：10926
> 
> 赞同：1
> 
> 时间：2008-08-14T12:27:00.003
> 
> 标签：apache-flex, actionscript-3, e4x

我正在应用程序中构建列表/网格控件并在Web 应用程序`Flex`中使用它。`.NET`长话短说，我从序列化对象的 Web 服务中获取 XML。我有一个页面上可以有多少东西的页面限制。我采用了一个数据网格并将其制成页面，跨页面排序，并处理一些基本过滤。

关于分页，我使用在页面上键入的 Dictionary 并存储该页面的 XML。这样，每当用户返回我保存到此字典中的页面时，我都可以从本地内存中获取 XML，而不是访问 web 服务。基本上，我正在缓存从每次调用 web 服务中检索到的数据以获取一页数据。

有几件事可以使我的缓存过期。过滤和排序是主要原因。但是，用户可以通过打开编辑器来编辑网格中的一行数据。他们编辑的数据可能会导致行中显示的数据过时。我可以轻松地访问 Web 服务并获取整个数据页面，但由于页面大小是在运行时设置的，因此我可能会查看大量要检索的记录。

因此，现在让我谈谈我遇到的问题的核心。为了防止取回整个数据页面，我调用了 web 服务，请求完全更新的记录（编辑器处理保存其数据）。

由于我使用的是自定义对象，因此我需要在服务器上将它们序列化为 XML（这已经为我们软件的其他部分处理了）。所有数据都通过 e4x 中的 XML 处理。Dictionary 中的缓存存储为 XMLList。

**现在让我向您展示我的代码...**

```
var idOfReplacee:String = this._WebService.GetSingleModelXml.lastResult.*[0].*[0].@Id;
var xmlToReplace:XMLList = this._DataPages[this._Options.PageIndex].Data.(@Id == idOfReplacee);

if(xmlToReplace.length() > 0)
{
    delete (this._DataPages[this._Options.PageIndex].Data.(@Id == idOfReplacee)[0]);
    this._DataPages[this._Options.PageIndex].Data += this._WebService.GetSingleModelXml.lastResult.*[0].*[0];
} 
```

基本上，我得到了要替换的节点的 id。然后我在缓存的 Data 属性 ( `XMLList`) 中找到它。我确保它存在，因为第二行的过滤器返回`XMLList`.

我遇到的问题是删除行。我无法使该行从列表中删除该节点。删除行之后的行有效。我已将节点添加到列表中。

如何替换或删除该节点（即我从缓存的 .Data 属性中的过滤语句中找到的节点）？？？

希望我所有变量的下划线在发布时都不会被转义！否则`this.&#95 == this`._

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-08-14T19:06:41.337

谢谢你们的答案。

@Theo：我尝试了几种不同的替换方式。由于某种原因，它永远不会出错，但永远不会更新列表。

@Matt：我想出了一个解决方案。问题不是来自您的建议，而是来自删除如何与列表一起使用（至少在这种情况下我是如何拥有它的）。

_DataPages 字典对象的 Data 属性是定义节点的列表（通过之前对另一个 XML 文档的过滤获得）。

```
<Models>
     <Definition Id='1' />
     <Definition Id='2' />
</Models> 
```

我最终做了这个小交易：

```
//gets the index of the node to replace from the same filter
var childIndex:int = (this._DataPages[this._Options.PageIndex].Data.(@Id == idOfReplacee)[0]).childIndex();
//deletes the node from the list
delete this._DataPages[this._Options.PageIndex].Data[childIndex];
//appends the new node from the webservice to the list
this._DataPages[this._Options.PageIndex].Data += this._WebService.GetSingleModelXml.lastResult.*[0].*[0]; 
```

所以基本上我必须在 XMLList 中获取节点的索引，即 Data 属性。从那里我可以使用 delete 关键字将其从列表中删除。+= 将我的新节点添加到列表中。

我非常习惯使用 ActiveX 或 Mozilla XmlDocument 的东西，你称之为“SelectSingleNode”，然后使用“replaceChild”来做这种事情。哦，好吧，至少这是在其他人可以找到的某个论坛中。我不知道当我回答自己的问题时会发生什么。也许这种见解会帮助其他人出现并帮助更好地回答问题！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-08-14T13:58:33.923

也许你可以`replace`改用？

```
var oldNode : XML = this._DataPages[this._Options.PageIndex].Data.(@Id == idOfReplacee)[0];
var newNode : XML = this._WebService.GetSingleModelXml.lastResult.*[0].*[0];    

oldNode.parent.replace(oldNode, newNode); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-04T13:28:44.620

我知道这是一个非常古老的问题，但我没有看到（我认为是）这个问题的最简单解决方案。

Theo 在这里有正确的方向，但是在使用 replace 的方式上存在许多错误（事实上，E4X 中的几乎所有东西都是一个函数）。

我相信这会成功：

```
oldNode.parent().replace(oldNode.childIndex(), newNode); 
```

`replace()`可以在第一个参数中采用多种不同的类型，但 AFAIK，XML 对象不是其中之一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-08-14T13:55:29.920

我没有立即看到问题，所以我只能冒险猜测。`delete`你得到的那一行正在寻找列表*顶层的第一个项目，*它的属性“Id”的值等于`idOfReplacee`. 确保您无需深入研究 XML 结构即可找到匹配的 id。

试试这个：

```
delete (this._DataPages[this._Options.PageIndex].Data..(@Id == idOfReplacee)[0]); 
```

（注意 '.' 之后的额外`Data`）。您可以通过在您发布的代码的第二行设置断点来更轻松地调试它，并确保 XMLList 看起来像您期望的那样。

# .net - 你能为 SVN 推荐一个好的 .NET 基于 Web 的存储库浏览器吗？

> ID：10933
> 
> 赞同：10
> 
> 时间：2008-08-14T12:37:21.013
> 
> 标签：.net, asp.net, svn

我们有一个在 Windows 服务器上运行的 SVN 存储库，我想将内部文档、功能更改、错误等链接到代码更改。

我们发现 WebSVN 非常慢 - 存储库对于它来说太大了（我认为）。

使用它的团队主要使用 C# 进行编码，虽然有些人有其他语言的经验，但我真的很喜欢团队中任何人都可以维护的工具。

我见过的大多数工具都是基于 PHP、Java、Python 等的。团队可以学习的所有语言，但我更喜欢使用我们已经拥有的技能的东西。

你能为 SVN 推荐一个好的基于 Web 的存储库浏览器吗，最好是使用 ASP.NET、[SQL Server](http://en.wikipedia.org/wiki/Microsoft_SQL_Server)并在[IIS](http://en.wikipedia.org/wiki/Internet_Information_Services)上运行的浏览器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-08-14T13:20:05.280

看看[http://warehouseapp.com](http://warehouseapp.com)

它是 Mongrel/Ruby/MySQL 堆栈（应该可以在 Windows 上工作）

> 但我希望避免在服务器上安装 MySQL 和 Ruby。

我知道（我自己也使用 C# 堆栈），但自托管的基于 Web 的 SVN 客户端市场是如此之小，以至于即使提供不同语言的产品也被认为足够好。MySQL 不会咬人，Ruby 的安装几乎是 x-copy 命令。我理解你为什么不想用额外的软件来破坏你的服务器，但是如果可以通过第三方托管你的 SVN 存储库，你会得到一个很好的基于 Web 的界面，而无需维护麻烦。

我正在使用[http://unfuddled.com](http://unfuddled.com)（如果需要，他们也有一些基本的 API 可以连接）。

> **不是提倡重新发明轮子，而是我最初使用svn log --xml** 命令编写了自己的 web SVN 浏览器

这实际上是个好主意。在我的自动构建过程中，我还解析了一些 XML 格式的输出，但是创建我们自己的成熟 SVN 浏览器有点矫枉过正，因为现在您不仅需要维护一个主要项目，还需要维护工具。但话又说回来，我们，程序员，喜欢创建工具，使我们的主要项目的工作更容易。

**ASP.NET SVN 浏览器听起来像是很有前途的开源想法，有人愿意开始工作吗？我会做出贡献的。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-08-14T23:23:26.497

不是提倡重新发明轮子，而是我最初使用

```
svn log --xml 
```

命令，然后只是我使用的任何语言的 XML 解析器。我不使用.Net，但应该不会太难。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-08-15T00:25:34.937

正如 Lubos 已经指出的那样，我使用[Warehouse](http://warehouseapp.com)，并且效果很好。我查看了一个 .NET 版本的点，但我从来没有找到一个。我也曾想通过学习一门新语言来提高自己作为程序员的水平，因此我冒险学习了 Ruby 和[Ruby on Rails](http://en.wikipedia.org/wiki/Ruby_on_Rails)。现在，我同时使用 .NET 和 Ruby 进行编程。不管怎样，我就是这样跑进仓库的。

我在运行 Ubuntu 服务器版、用于 HTTP 服务器的[nginx和](http://nginx.net/)[mongrel cluster](http://mongrel.rubyforge.org/wiki/MongrelCluster)的 Linux 机器上安装了 Warehouse 。我什至从未尝试在 Windows 上安装它，我很高兴我没有。Warehouse 需要 svn-ruby 绑定才能工作，而这个[可怜的家伙](http://forum.activereload.net/forums/8/topics/452)发现了一条艰难的道路。

好吧，我知道您正在寻找一个 .NET 应用程序，但我想我会在 Warehouse 上付出我的两分钱，我希望您不要仅仅因为它不在 .NET 中运行而忽略它。我还想通知你不要在 Windows 上安装 Warehouse，如果你决定试一试的话。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-08-20T22:15:11.330

您的 Subversion 存储库是否托管在 Apache（而不是 svnserve）内部？如果是这样，并且您的需求非常简单，您可以通过 Web 浏览器直接访问存储库。只需获取存储库 URL，将其放入浏览器中，您就会看到一个非常基本的 Web 导航界面（基本上是内置的 Apache 文件夹浏览界面）。它并不漂亮，但它适用于到存储库文件的基本链接，如果这就是你所需要的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T22:08:27.477

这不一定是您问题的答案，但似乎大多数其他答案也提到了相关的解决方案，所以我认为这是值得的。

[http://ifdefined.com/doc_bug_tracker_subversion.html](http://ifdefined.com/doc_bug_tracker_subversion.html)

这是一个名为 BugTracker.NET 的开源项目。它主要是一个问题跟踪器（我们在这里使用得很好），但它确实包括 Subversion 集成以及查看差异的能力。我们还没有实现该部分，但从屏幕截图中看起来相当不错。

它基于 IIS/MSSQL，因此它是一个 Windows 部署友好的解决方案。我发现它很可靠，如果设置起来有点棘手。

It's not a raw repository browser, but close and hits on some of the other qualities you were looking for.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-08-20T22:21:50.613

不是基于网络的，但如果您的团队使用 TortoiseSVN，那里有一个很棒的存储库浏览器。只需右键单击本地结帐并选择 TortoiseSVN / Repo-Browser。

# exception - 如何跟踪 COM 对象异常？

> ID：10935
> 
> 赞同：0
> 
> 时间：2008-08-14T12:41:43.190
> 
> 标签：exception, com, dll, trace

我有一个带有一些**COM 对象的****DLL**。有时，此对象会**崩溃**并在 Windows 事件日志中注册一个错误事件，其中包含大量十六进制信息。我不知道为什么会发生这种崩溃。

 ****那么，如何跟踪那些 COM 对象异常呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-08-14T13:03:10.447

第一步是查找失败代码的十六进制值（EG E_FAIL 0x80004005）。我非常幸运地在 Google 中发布了该值，以了解错误代码的含义。

然后，我只是使用反复试验来尝试隔离代码中失败的位置以及失败的根本原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-08-14T13:40:05.987

如果您只想快速找出错误代码的含义，可以使用 Visual Studio 附带的“错误查找”工具（详情请[点击此处](http://msdn.microsoft.com/en-us/library/akay62ya(VS.80).aspx)）。输入十六进制值，它将为您提供描述该错误代码的字符串。

当然，一旦你知道了这一点，你仍然必须弄清楚它为什么会发生。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-16T19:00:30.167

查找错误 (hresult) 代码的好方法是 HResult Plus 或 welt.exe（Windows 错误查找工具）。

我在 COM 类内部使用日志记录来查看发生了什么。此外，一旦 COM 类被可执行文件加载，您可以将 VS 调试器附加到它并使用断点、监视和所有有趣的东西来调试 COM 代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-08-16T19:55:19.620

COM 对象不会抛出异常。它们返回 HRESULT，其中大部分表示失败。因此，如果您正在寻找异常堆栈跟踪的等价物，那么您就不走运了。您将不得不手动浏览代码并弄清楚发生了什么。****

# c# - 深度克隆的单元测试

> ID：10949
> 
> 赞同：11
> 
> 时间：2008-08-14T12:49:03.440
> 
> 标签：c#, .net, unit-testing

假设我有一个复杂的 .NET 类，其中包含许多数组和其他类对象成员。我需要能够生成该对象的深度克隆——所以我编写了一个 Clone() 方法，并使用简单的 BinaryFormatter 序列化/反序列化来实现它——或者我可能使用其他一些更容易出错的技术进行深度克隆我想确保经过测试。

好的，所以现在（好的，我应该先完成它）我想编写涵盖克隆的测试。该类的所有成员都是私有的，而且我的架构非常好（！），我不需要编写数百个公共属性或其他访问器。该类不是 IComparable 或 IEquatable，因为应用程序不需要它。我的单元测试在生产代码的单独程序集中。

人们采用什么方法来测试克隆的对象是否是好的副本？您是否为该类编写（或在发现需要克隆后*重写*）所有单元测试，以便可以使用*“*原始”对象*或*它的克隆来调用它们？如果部分克隆不够深，您将如何测试 - 因为这只是一种问题，可能会在以后给查找错误带来可怕的后果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-08-14T14:01:59.097

您的测试方法将取决于您提出的解决方案的类型。如果您编写了一些自定义克隆代码并且必须在每种可克隆类型中手动实现，那么您应该真正测试每种类型的克隆。或者，如果您决定采用更通用的路线（上述反射可能适合），您的测试只需要测试克隆系统必须处理的特定场景。

要回答您的具体问题：

> 您是否为该类编写（或在发现需要克隆后重写）所有单元测试，以便可以使用“原始”对象或它的克隆来调用它们？

您应该对可以在原始对象和克隆对象上执行的所有方法进行测试。请注意，设置一个简单的测试设计来支持这一点应该很容易，而无需手动更新每个测试的逻辑。

> 如果部分克隆不够深，您将如何测试 - 因为这只是一种问题，可能会在以后给查找错误带来可怕的后果？

这取决于您选择的克隆方法。如果您必须手动更新可克隆类型，那么您应该测试每种类型是否正在克隆所有（且仅）您期望的成员。然而，如果您正在测试一个克隆框架，我会创建一些测试可克隆类型来测试您需要支持的每个场景。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-23T04:22:25.513

有一个非常明显的解决方案，几乎不需要那么多工作：

1.  将对象序列化为二进制格式。
2.  克隆对象。
3.  将克隆序列化为二进制格式。
4.  比较字节。

假设序列化有效——而且更好，因为你使用它来克隆——这应该很容易维护。事实上，它会完全封装你的类结构的变化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-08-23T12:03:01.513

我喜欢编写在原始对象和克隆对象上使用内置序列化程序之一的单元测试，然后检查序列化表示是否相等（对于二进制格式化程序，我可以只比较字节数组）。这在对象仍然可序列化的情况下非常有效，并且出于性能原因我只是更改为自定义深度克隆。

此外，我喜欢使用类似这样的方式为我的所有克隆实现添加调试模式检查

```
[Conditional("DEBUG")]
public static void DebugAssertValueEquality<T>(T current, T other, bool expected, 
                                               params string[] ignoredFields) {
    if (null == current) 
    { throw new ArgumentNullException("current"); }
    if (null == ignoredFields)
    { ignoredFields = new string[] { }; }

    FieldInfo lastField = null;
    bool test;
    if (object.ReferenceEquals(other, null))
    { Debug.Assert(false == expected, "The other object was null"); return; }
    test = true;
    foreach (FieldInfo fi in current.GetType().GetFields(BindingFlags.Instance)) {
        if (test = false) { break; }
        if (0 <= Array.IndexOf<string>(ignoredFields, fi.Name))
        { continue; }
        lastField = fi;
        object leftValue = fi.GetValue(current);
        object rightValue = fi.GetValue(other);
        if (object.ReferenceEquals(null, leftValue)) {
            if (!object.ReferenceEquals(null, rightValue))
            { test = false; }
        }
        else if (object.ReferenceEquals(null, rightValue))
        { test = false; }
        else {
            if (!leftValue.Equals(rightValue))
            { test = false; }
        }
    }
    Debug.Assert(test == expected, string.Format("field: {0}", lastField));
} 
```

此方法依赖于对任何嵌套成员的 Equals 的准确实现，但在我的情况下，任何可克隆的东西也是 equatable

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-08-14T12:56:06.640

我只需编写一个测试来确定克隆是否正确。如果该类不是密封的，您可以通过扩展它来为它创建一个安全带，然后在子类中公开您的所有内部结构。或者，您可以使用反射 (yech)，或使用 MSTest 的访问器生成器。

您需要克隆您的对象，然后检查您的对象具有的每个属性和变量，并确定它是否被正确复制或正确克隆。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-18T13:04:32.123

我通常会实施`Equals()`以深入比较两个对象。您可能在生产代码中不需要它，但它可能在以后仍然派上用场，并且测试代码更加简洁。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-30T13:03:59.227

这是我前一段时间如何实现的示例，尽管这需要根据场景进行调整。在这种情况下，我们有一个很容易改变的讨厌的对象链，并且克隆被用作一个非常关键的原型实现，所以我不得不一起修补（破解）这个测试。

```
public static class TestDeepClone
    {
        private static readonly List<long> objectIDs = new List<long>();
        private static readonly ObjectIDGenerator objectIdGenerator = new ObjectIDGenerator();

        public static bool DefaultCloneExclusionsCheck(Object obj)
        {
            return
                obj is ValueType ||
                obj is string ||
                obj is Delegate ||
                obj is IEnumerable;
        }

        /// <summary>
        /// Executes various assertions to ensure the validity of a deep copy for any object including its compositions
        /// </summary>
        /// <param name="original">The original object</param>
        /// <param name="copy">The cloned object</param>
        /// <param name="checkExclude">A predicate for any exclusions to be done, i.e not to expect IPolicy items to be cloned</param>
        public static void AssertDeepClone(this Object original, Object copy, Predicate<object> checkExclude)
        {
            bool isKnown;
            if (original == null) return;
            if (copy == null) Assert.Fail("Copy is null while original is not", original, copy);

            var id = objectIdGenerator.GetId(original, out isKnown); //Avoid checking the same object more than once
            if (!objectIDs.Contains(id))
            {
                objectIDs.Add(id);
            }
            else
            {
                return;
            }

            if (!checkExclude(original))
            {
                Assert.That(ReferenceEquals(original, copy) == false);
            }

            Type type = original.GetType();
            PropertyInfo[] propertyInfos = type.GetProperties(BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.Public);
            FieldInfo[] fieldInfos = type.GetFields(BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.Public);

            foreach (PropertyInfo memberInfo in propertyInfos)
            {
                var getmethod = memberInfo.GetGetMethod();
                if (getmethod == null) continue;
                var originalValue = getmethod.Invoke(original, new object[] { });
                var copyValue = getmethod.Invoke(copy, new object[] { });
                if (originalValue == null) continue;
                if (!checkExclude(originalValue))
                {
                    Assert.That(ReferenceEquals(originalValue, copyValue) == false);
                }

                if (originalValue is IEnumerable && !(originalValue is string))
                {
                    var originalValueEnumerable = originalValue as IEnumerable;
                    var copyValueEnumerable = copyValue as IEnumerable;
                    if (copyValueEnumerable == null) Assert.Fail("Copy is null while original is not", new[] { original, copy });
                    int count = 0;
                    List<object> items = copyValueEnumerable.Cast<object>().ToList();
                    foreach (object o in originalValueEnumerable)
                    {
                        AssertDeepClone(o, items[count], checkExclude);
                        count++;
                    }
                }
                else
                {
                    //Recurse over reference types to check deep clone success
                    if (!checkExclude(originalValue))
                    {
                        AssertDeepClone(originalValue, copyValue, checkExclude);
                    }

                    if (originalValue is ValueType && !(originalValue is Guid))
                    {
                        //check value of non reference type
                        Assert.That(originalValue.Equals(copyValue));
                    }
                }

            }

            foreach (FieldInfo fieldInfo in fieldInfos)
            {
                var originalValue = fieldInfo.GetValue(original);
                var copyValue = fieldInfo.GetValue(copy);
                if (originalValue == null) continue;
                if (!checkExclude(originalValue))
                {
                    Assert.That(ReferenceEquals(originalValue, copyValue) == false);
                }

                if (originalValue is IEnumerable && !(originalValue is string))
                {
                    var originalValueEnumerable = originalValue as IEnumerable;
                    var copyValueEnumerable = copyValue as IEnumerable;
                    if (copyValueEnumerable == null) Assert.Fail("Copy is null while original is not", new[] { original, copy });
                    int count = 0;
                    List<object> items = copyValueEnumerable.Cast<object>().ToList();
                    foreach (object o in originalValueEnumerable)
                    {
                        AssertDeepClone(o, items[count], checkExclude);
                        count++;
                    }
                }
                else
                {
                    //Recurse over reference types to check deep clone success
                    if (!checkExclude(originalValue))
                    {
                        AssertDeepClone(originalValue, copyValue, checkExclude);
                    }
                    if (originalValue is ValueType && !(originalValue is Guid))
                    {
                        //check value of non reference type
                        Assert.That(originalValue.Equals(copyValue));
                    }
                }
            }
        }
    } 
```

# java - IKVM 和许可

> ID：10980
> 
> 赞同：10
> 
> 时间：2008-08-14T13:16:37.580
> 
> 标签：java, .net, ikvm, gnu-classpath

我一直在研究 IKVMing Apache 的 FOP 项目以与我们的 .NET 应用程序一起使用。它是一个商业产品，在许可方面，IKVM 遇到了一些棘手的问题，因为它使用了 GNU 类路径。就我所见，没有人能确定这些东西是否可以用于商业产品。有没有人在商业产品中使用过 IKVM 或 IKVM 的产品？这是我到目前为止发现的：

[IKVM 许可证页面](https://web.archive.org/web/20040202014857/http://weblog.ikvm.net:80/story.aspx/license)，其中指出一个 dll 包含来自其他项目的代码，它们的许可证[GPLv2 + Classpath Exception](https://openjdk.java.net/legal/gplv2+ce.html)

[Saxon for .NET](http://saxon.sourceforge.net/)是使用 IKVM 生成的，但在 Apache 许可下发布...

有人有这方面的经验吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-08-19T18:15:58.570

这里有多个问题，因为 ikvm 目前正在从 GNU 类路径系统过渡到 Sun 的 OpenJDK。两者都被许可为 GPL+Exceptions，明确声明仅使用 OpenJDK 库的应用程序不会被视为派生作品。

一般来说，依赖于具有定义规范的组件的应用程序无论如何都不属于 GPL。例如，链接到公共 POSIX API 不会触发 Linux 应用程序中的 GPL 依赖，尽管内核是 GPL。类似的原则（细节可能很棘手）通常适用于用 FOSS/GPL 实现替换 Sun 的 Java。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-12T21:10:30.540

在注意到这个问题后，只需快速更新一下，供任何浏览的人使用。

IKVM 似乎已经更新为使用 OpenJDK 而不是 GNU Classpath，事实上 IKVM.net 已经从他们的许可页面中删除了评论。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-08-15T09:24:51.977

我不是律师，但只要您不进行任何更改并声称代码是您的，所有提到的许可证都可以用于商业产品。

我认为如果你不想冒险，你应该咨询律师。

# c++ - 如何防止在堆上创建对象？

> ID：10985
> 
> 赞同：30
> 
> 时间：2008-08-14T13:19:08.073
> 
> 标签：c++, stack, heap-memory

有谁知道我可以如何在独立于平台的 C++ 代码中阻止在堆上创建对象？也就是说，对于“Foo”类，我想阻止用户这样做：

```
Foo *ptr = new Foo; 
```

并且只允许他们这样做：

```
Foo myfooObject; 
```

有没有人有任何想法？

干杯，

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-08-14T16:36:41.233

[尼克的回答](https://stackoverflow.com/questions/10985/how-to-prevent-an-object-being-created-on-the-heap#11003)是一个很好的起点，但不完整，因为您实际上需要重载：

```
private:
    void* operator new(size_t);          // standard new
    void* operator new(size_t, void*);   // placement new
    void* operator new[](size_t);        // array new
    void* operator new[](size_t, void*); // placement array new 
```

（良好的编码习惯建议您还应该重载 delete 和 delete[] 运算符——我会的，但因为它们不会被调用，所以实际上没有*必要*。）

[Pauldoo](https://stackoverflow.com/questions/10985/how-to-prevent-an-object-being-created-on-the-heap#11018)也是正确的，它不能在 Foo 上进行聚合，尽管它确实可以从 Foo 继承。你可以做一些模板元编程魔法来帮助防止这种情况，但它不会对“邪恶的用户”免疫，因此可能不值得复杂化。应该如何使用它的文档，以及确保正确使用它的代码审查，是唯一约 100% 的方法。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-08-14T13:31:05.587

您可以为 Foo 重载 new 并将其设为私有。这意味着编译器会呻吟……除非您从 Foo 中在堆上创建 Foo 的实例。要抓住这种情况，您可以简单地不编写 Foo 的新方法，然后链接器就会抱怨未定义的符号。

```
class Foo {
private:
  void* operator new(size_t size);
}; 
```

PS。是的，我知道这很容易绕过。我真的不推荐它——我认为这是个坏主意——我只是在回答这个问题！;-)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-08-14T13:37:17.680

我不知道如何可靠和便携地做到这一点..但是..

如果对象在堆栈上，那么您可以在构造函数中断言“this”的值总是接近堆栈指针。如果是这种情况，对象很有可能会在堆栈上。

我相信并非所有平台都以相同的方向实现其堆栈，因此您可能希望在应用程序开始验证堆栈增长方式时进行一次性测试。或者做一些软糖：

```
FooClass::FooClass() {
    char dummy;
    ptrdiff_t displacement = &dummy - reinterpret_cast<char*>(this);
    if (displacement > 10000 || displacement < -10000) {
        throw "Not on the stack - maybe..";
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-08-14T13:39:54.787

@缺口

这可以通过创建一个派生自或聚合 Foo 的类来规避。我认为我的建议（虽然不健全）仍然适用于派生类和聚合类。

例如：

```
struct MyStruct {
    Foo m_foo;
};

MyStruct* p = new MyStruct(); 
```

在这里，我在堆上创建了一个 'Foo' 的实例，绕过了 Foo 的隐藏 new 运算符。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-05-26T22:34:20.093

因为调试头可以覆盖 operator new 签名，所以最好使用 ... 签名作为一个完整的补救措施：

```
private:
void* operator new(size_t, ...) = delete;
void* operator new[](size_t, ...) = delete; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-08-14T13:28:17.243

您可以在 Foo 类中声明一个名为“operator new”的函数，该函数将阻止对正常形式的 new 的访问。

这是你想要的那种行为吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-08-14T13:41:58.543

您可以将其声明为接口并更直接地从您自己的代码中控制实现类。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-20T17:52:31.733

这可以通过将构造函数设为私有并提供静态成员来在堆栈中创建对象来防止

```
Class Foo
{
    private:
        Foo();
        Foo(Foo& );
    public:
        static Foo GenerateInstance() { 
            Foo a ; return a; 
        }
} 
```

这将使对象的创建始终在堆栈中。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-08-14T13:35:29.087

不确定这是否提供任何编译时机会，但您是否考虑过为您的类重载“新”运算符？

# php - 使用 PHP/Apache 上传文件夹的正确权限是什么？

> ID：10990
> 
> 赞同：56
> 
> 时间：2008-08-14T13:22:25.743
> 
> 标签：php, apache, upload

很抱歉这个基本问题 - 我是一名 .NET 开发人员，对 LAMP 设置没有太多经验。

我有一个允许上传到特定文件夹的 PHP 站点。有人告诉我，此文件夹需要由网络服务器用户拥有才能使上传过程正常工作，因此我创建了该文件夹，然后将权限设置为：

```
chown apache:apache -R uploads/
chmod 755 -R uploads/ 
```

现在唯一的问题是FTP用户根本无法修改上传的文件。

是否有权限设置允许我仍然上传文件，然后以网络服务器用户以外的用户身份修改它们？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-08-14T13:32:55.473

您可以创建一个以 apache 用户和 FTP 用户为成员的新组，然后对上传文件夹 775 设置权限。这应该使 apache 和 FTP 用户都能够写入文件夹中的文件，但保留其他所有人从修改它们。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-08-14T13:45:04.903

如果您真的想这样做，我会选择 Ryan 的回答。

一般来说，在 *nix 环境中，您总是希望尽可能少地放弃权限。

10 次中有 9 次，755 是理想的权限 - 因为唯一能够修改文件的用户将是网络服务器。如果您确实需要更改此设置，请与您的组中的 ftp 用户一起将其更改为 775。

由于您自己承认您是 php 新手，因此这里有一个有助于提高上传服务安全性的链接： [`move_uploaded_file`](http://www.php.net/move_uploaded_file)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-12T15:17:52.710

我会支持创建一个有权上传的 ftp 组的想法。但是，我认为没有必要给予 775 许可。7 代表读、写、执行。通常您希望允许某些组进行读写，但根据具体情况，可能不需要执行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-08-14T13:43:36.653

我将补充一点，如果您使用的是 SELinux，您需要确保类型上下文是 tmp_t 您可以使用 chcon 实用程序来完成此操作

> chcon -t tmp_t 上传

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-27T06:11:53.790

重要的是`apache`用户和组应该有最小`read`的访问权限，在某些情况下应该有访问`execute`权限。对于其余部分，您可以授予`0`访问权限。

这是最安全的设置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-11T02:51:20.793

还记得`CHOWN`或`chgrp`您的网站文件夹。尝试 `myusername# chown -R myusername:_www uploads`

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-06-07T03:26:42.747

根据来自 的回答`@Ryan Ahearn`，以下是我在`Ubuntu`16.04 创建一个`front`仅对 nginx 的 web dir 具有权限的用户的操作`/var/www/html`。

**脚步：**

```
* 前置步骤：
    *服务器的基本准备，
    * 创建用户'dev'
        这将是“/var/www/html”的所有者，
    *
    * 安装 nginx，
    *
*
* 创建用户'front'
    sudo useradd -d /home/front -s /bin/bash front
    须藤密码前面

    # 创建主文件夹，如果不存在，
    sudo mkdir /home/front
    # 设置新主文件夹的所有者，
    sudo chown -R front:front /home/front

    # 切换到用户，
    苏前

    # 复制 .​​bashrc，如果不存在，
    cp /etc/skel/.bashrc ~front/
    cp /etc/skel/.profile ~front/

    # 启用颜色，
    vi ~front/.bashrc
    # 取消注释以“force_color_prompt”开头的行，

    # 退出用户
    出口
*
* 添加到组“开发”，
    sudo usermod -a -G dev 前端
*更改网络目录的所有者，
    sudo chown -R dev:dev /var/www
* 更改网络目录的权限，
    chmod 775 $(查找 /var/www/html -type d)
    chmod 664 $(查找 /var/www/html -type f)
*
* 重新登录为 'front'
    使组生效，
*
* 测试
*
* 行
*

```

# visual-studio - 分布式环境中的 MS Team Foundation Server - 提示需要技巧

> ID：10999
> 
> 赞同：5
> 
> 时间：2008-08-14T13:27:40.523
> 
> 标签：visual-studio, tfs

是否有人在地理分布的团队中使用 Team Foundation Server？我们在英国，尝试与澳大利亚的一个团队合作，我们发现这非常艰难。

我们主要的两个问题是：

1.  事情正在向我们检查，而我们没有要求获取最新信息。
2.  即使使用代理，大多数事情也需要一段时间才能发生。

许多像这样令人讨厌的小事情正在硬化我们的动脉，阻止我们交付代码，坦率地说，它们正在创造一种类似于将金色糖浆推上沙丘的用户体验。

有没有*人*每天都以这种方式使用 TFS 并取得（相对）成功？

如果是这样，您是否有任何值得了解的提示、提示、技巧或陷阱？

PS 升级到 CruiseControl.NET 不是一种选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-08-14T13:48:02.523

绝对升级到 TFS 2008 和 Visual Studio 2008，因为它在各个方面都是 Team System 的“v2”版本。修复了许多中小型问题。

至于“随机签出的东西”，这几乎*总是*由于 Visual Studio 决定代表您编辑文件。尝试从 Team Explorer 获取最新信息，在 Visual Studio 中没有打开任何内容，然后查看该行为是否仍然存在。我敢打赌不会！

多个 TFS 服务器是个坏主意。确保您的代理配置正确，因为它会缓存重复的 GET。也就是说，TFS 是一个服务器连接模型，所以它总是比真正的“离线”源代码控制系统慢一点。

此外，如果您可以编辑您的问题以包含更具体的投诉或详细信息，那将有所帮助 - 现在它非常模糊，所以我不能很好地回答。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-08-14T14:30:59.553

我们将 TFS 与一个有点分散的团队一起使用——它们离我们不太远，但通过一个缓慢且不可靠的 VPN 连接。

对于您的第一个问题，结帐时获取最新信息不是默认行为。（这里有一个[解释](http://blogs.msdn.com/buckh/archive/2005/08/20/454140.aspx)）不过，有一个[插件](http://blogs.microsoft.co.il/blogs/srlteam/archive/2007/03/24/TFS-GetLatest-version-on-check_2D00_out-Add_2D00_In.aspx)可以为你做这件事。

以下是适用于我们的工作流程：

1.  获取最新信息
2.  构建并验证没有任何问题
3.  工作（待更改）
4.  再次获取最新信息
5.  处理合并冲突
6.  构建并验证没有任何问题
7.  报到

[编辑] 好的，看起来你改写了这部分问题。是的，Jeff 是对的，VS 决定“为您”检查一些文件，例如 sln 和 proj 文件。它还会自动检查您编辑的任何源文件（这就是您想要的，对吗？尽管您可以在工具 > 选项 > 源代码控制中更改该设置）

代理显然需要一段时间才能加速（我们不使用它）但是一旦它缓存了大部分树，它应该很快。你能做一些监控并找到瓶颈吗？

除了获取最新的结账信息和速度之外，还有什么给您带来麻烦的吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-08-14T13:39:12.793

据我了解，您可以在不同位置拥有多个 TFS 应用程序服务器。它们要么都可以与同一个 SQL Server 通信，要么您可以使用 SQL Server 镜像。拥有自己的本地 TFS 服务器可能会加快您的开发时间。