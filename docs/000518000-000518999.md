# StackOverflow 问答 000518000-000518999

# javascript - JavaScript 是按引用传递还是按值传递语言？

> ID：518000
> 
> 赞同：1607
> 
> 时间：2009-02-05T21:23:56.303
> 
> 标签：javascript, pass-by-reference, pass-by-value

原始类型（数字、字符串等）按值传递，但对象是未知的，因为它们都可以按值传递（如果我们认为持有对象的变量实际上是对对象的引用) 和通过引用传递（当我们认为对象的变量包含对象本身时）。

尽管最后并不重要，但我想知道呈现通过约定的参数的正确方法是什么。是否有 JavaScript 规范的摘录，它定义了关于这个的语义应该是什么？

* * *

## 回答 #1

> 赞同：1831
> 
> 时间：2010-09-03T17:17:22.143

这在 JavaScript 中很有趣。考虑这个例子：

```
function changeStuff(a, b, c)
{
  a = a * 10;
  b.item = "changed";
  c = {item: "changed"};
}

var num = 10;
var obj1 = {item: "unchanged"};
var obj2 = {item: "unchanged"};

changeStuff(num, obj1, obj2);

console.log(num);
console.log(obj1.item);
console.log(obj2.item);
```

这将产生输出：

```
10
changed
unchanged 
```

*   如果`obj1`根本不是引用，那么更改对函数外部`obj1.item`没有影响。`obj1`
*   如果这个论点是一个适当的参考，那么一切都会改变。`num`会`100`，`obj2.item`会读`"changed"`。相反，`num`留下`10`并`obj2.item`保持`"unchanged`“。

相反，情况是传入的项目是按值传递的。但是按值传递的项目*本身就是*一个引用。从技术上讲，这称为[共享呼叫](http://en.wikipedia.org/wiki/Evaluation_strategy#Call_by_sharing)。

实际上，这意味着如果您更改参数本身（如`num`and `obj2`），这不会影响输入参数的项目。但是，如果您更改参数的*内部*结构，它将传播回来（与 一样`obj1`）。

* * *

## 回答 #2

> 赞同：557
> 
> 时间：2011-03-15T16:38:23.030

它总是按值传递，但对于对象，变量的值是一个引用。因此，当您传递一个对象并更改其*成员*时，这些更改会在函数之外持续存在。这使它*看起来*像通过引用传递。但是如果你真的改变了对象变量的值，你会发现改变不会持续，证明它真的是按值传递的。

例子：

```
function changeObject(x) {
  x = { member: "bar" };
  console.log("in changeObject: " + x.member);
}

function changeMember(x) {
  x.member = "bar";
  console.log("in changeMember: " + x.member);
}

var x = { member: "foo" };

console.log("before changeObject: " + x.member);
changeObject(x);
console.log("after changeObject: " + x.member); /* change did not persist */

console.log("before changeMember: " + x.member);
changeMember(x);
console.log("after changeMember: " + x.member); /* change persists */
```

输出：

```
before changeObject: foo
in changeObject: bar
after changeObject: foo

before changeMember: foo
in changeMember: bar
after changeMember: bar 
```

* * *

## 回答 #3

> 赞同：164
> 
> 时间：2009-02-05T21:37:34.670

变量不“持有”对象；它有一个参考。您可以将该引用分配给另一个变量，现在两者都引用同一个对象。它总是按值传递（即使该值是引用......）。

没有办法改变作为参数传递的变量所持有的值，如果 JavaScript 支持通过引用传递，这将是可能的。

* * *

## 回答 #4

> 赞同：134
> 
> 时间：2014-08-04T11:06:56.887

我的两分钱……这就是我理解的方式。（如果我错了，请随时纠正我）

是时候扔掉你所知道的关于按值/引用传递的一切了。

**因为在 JavaScript 中，它是通过值传递还是通过引用传递或其他方式都无关紧要。重要的是突变与传递给函数的参数的分配。**

好的，让我尽力解释我的意思。假设您有几个对象。

```
var object1 = {};
var object2 = {}; 
```

我们所做的是“赋值”...我们已经将 2 个单独的空对象分配给变量“object1”和“object2”。

现在，假设我们更喜欢 object1……所以，我们“分配”了一个新变量。

```
var favoriteObject = object1; 
```

接下来，无论出于何种原因，我们决定我们更喜欢对象 2。所以，我们做了一点重新分配。

```
favoriteObject = object2; 
```

object1 或 object2 没有发生任何事情。我们根本没有更改任何数据。我们所做的只是重新分配我们最喜欢的对象。重要的是要知道 object2 和 favoriteObject 都分配给了同一个对象。我们可以通过这些变量中的任何一个来更改该对象。

```
object2.name = 'Fred';
console.log(favoriteObject.name) // Logs Fred
favoriteObject.name = 'Joe';
console.log(object2.name); // Logs Joe 
```

好的，现在让我们看看像字符串这样的原语

```
var string1 = 'Hello world';
var string2 = 'Goodbye world'; 
```

再次，我们选择一个最喜欢的。

```
var favoriteString = string1; 
```

我们的 favoriteString 和 string1 变量都分配给了“Hello world”。现在，如果我们想改变我们的 favoriteString 怎么办？？？会发生什么？？？

```
favoriteString = 'Hello everyone';
console.log(favoriteString); // Logs 'Hello everyone'
console.log(string1); // Logs 'Hello world' 
```

哦哦....发生了什么事。我们无法通过更改 favoriteString 来更改 string1... 为什么？因为我们没有*改变*我们的字符串*对象*。我们所做的只是将 favoriteString*变量*“重新分配”到一个新字符串。这实质上将它与 string1 断开了连接。在前面的例子中，当我们重命名我们的对象时，我们没有分配任何东西。（好吧，不是*变量本身*，......但是，我们确实将 name 属性分配给了一个新字符串。）相反，我们改变了保持 2 个变量和底层对象之间连接的对象。（即使我们想要修改或*改变*字符串对象*本身*，我们也做不到，因为字符串在 JavaScript 中实际上是不可变的。）

现在，关于函数和传递参数......当你调用一个函数并传递一个参数时，你实际上所做的是对一个新变量的“赋值”，它的工作方式与你使用等号 (=) 符号。

举这些例子。

```
var myString = 'hello';

// Assign to a new variable (just like when you pass to a function)
var param1 = myString;
param1 = 'world'; // Re assignment

console.log(myString); // Logs 'hello'
console.log(param1);   // Logs 'world' 
```

现在，同样的事情，但有一个功能

```
function myFunc(param1) {
    param1 = 'world';

    console.log(param1);   // Logs 'world'
}

var myString = 'hello';
// Calls myFunc and assigns param1 to myString just like param1 = myString
myFunc(myString);

console.log(myString); // logs 'hello' 
```

好的，现在让我们举几个使用对象的例子......首先，没有函数。

```
var myObject = {
    firstName: 'Joe',
    lastName: 'Smith'
};

// Assign to a new variable (just like when you pass to a function)
var otherObj = myObject;

// Let's mutate our object
otherObj.firstName = 'Sue'; // I guess Joe decided to be a girl

console.log(myObject.firstName); // Logs 'Sue'
console.log(otherObj.firstName); // Logs 'Sue'

// Now, let's reassign the variable
otherObj = {
    firstName: 'Jack',
    lastName: 'Frost'
};

// Now, otherObj and myObject are assigned to 2 very different objects
// And mutating one object has no influence on the other
console.log(myObject.firstName); // Logs 'Sue'
console.log(otherObj.firstName); // Logs 'Jack'; 
```

现在，同样的事情，但有一个函数调用

```
function myFunc(otherObj) {

    // Let's mutate our object
    otherObj.firstName = 'Sue';
    console.log(otherObj.firstName); // Logs 'Sue'

    // Now let's re-assign
    otherObj = {
        firstName: 'Jack',
        lastName: 'Frost'
    };
    console.log(otherObj.firstName); // Logs 'Jack'

    // Again, otherObj and myObject are assigned to 2 very different objects
    // And mutating one object doesn't magically mutate the other
}

var myObject = {
    firstName: 'Joe',
    lastName: 'Smith'
};

// Calls myFunc and assigns otherObj to myObject just like otherObj = myObject
myFunc(myObject);

console.log(myObject.firstName); // Logs 'Sue', just like before 
```

好的，如果您通读了整篇文章，也许您现在对 JavaScript 中的函数调用如何工作有了更好的理解。某些东西是通过引用传递还是通过值传递并不重要……重要的是赋值与变异。

每次将变量传递给函数时，您都在“分配”参数变量的名称，就像使用等号 (=) 一样。

永远记住，等号 (=) 表示赋值。*永远记住，在 JavaScript 中将*参数传递给函数也意味着赋值。它们是相同的，并且 2 个变量以完全相同的方式连接（也就是说它们不是，除非您计算它们被分配给同一个对象）。

“修改变量”影响不同变量的唯一时间是当底层对象发生突变时（在这种情况下，您没有修改变量，而是修改了对象本身。

区分对象和基元是没有意义的，因为它的工作方式与您没有函数并且只是使用等号分配给新变量的方式完全相同。

唯一的问题是当您传递给函数的变量名称与函数参数的名称相同时。发生这种情况时，您必须将函数内部的参数视为函数私有的全新变量（因为它是）

```
function myFunc(myString) {
    // myString is private and does not affect the outer variable
    myString = 'hello';
}

var myString = 'test';
myString = myString; // Does nothing, myString is still 'test';

myFunc(myString);
console.log(myString); // Logs 'test' 
```

* * *

## 回答 #5

> 赞同：84
> 
> 时间：2015-09-26T04:06:20.917

这些短语/概念最初是在创建 JS 之前很久就定义的，它们不能准确地描述 javascript 的语义。我认为尝试将它们应用于 JS 会导致更多的混乱。

所以不要沉迷于“按引用/值传递”。

考虑以下：

1.  变量是*指向*值的指针。
2.  重新分配一个变量只是将该指针指向一个新值。
3.  重新分配变量永远不会影响指向同一对象的其他变量，因为每个变量都有自己的指针。

所以如果我必须给它一个名字，我会说**“pass-by-pointer”** ——我们不处理 JS 中的指针，但底层引擎会处理。

```
// code
var obj = {
    name: 'Fred',
    num: 1
};

// illustration
               'Fred'
              /
             /
(obj) ---- {}
             \
              \
               1 
```

```
// code
obj.name = 'George';

// illustration
                 'Fred'

(obj) ---- {} ----- 'George'
             \
              \
               1 
```

```
// code
obj = {};

// illustration
                 'Fred'

(obj)      {} ----- 'George'
  |          \
  |           \
 { }            1 
```

```
// code
var obj = {
    text: 'Hello world!'
};

/* function parameters get their own pointer to 
 * the arguments that are passed in, just like any other variable */
someFunc(obj);

// illustration
(caller scope)        (someFunc scope)
           \             /
            \           /
             \         /
              \       /
               \     /
                 { }
                  |
                  |
                  |
            'Hello world' 
```

最后的一些评论：

*   短语“按值/引用传递”仅用于描述语言的*行为*，不一定是实际的底层实现。由于这种抽象，对于一个体面的解释至关重要的关键细节丢失了，这不可避免地导致当前的情况，即单个术语在没有额外信息的情况下无法充分描述实际行为。
*   很容易认为*原语*是由特殊规则强制执行的，而*对象*不是，但原语只是指针链的末端。
*   作为最后一个示例，请考虑为什么清除数组的常见尝试无法按预期工作。

```
var a = [1,2];
var b = a;

a = [];
console.log(b); // [1,2]
// doesn't work because `b` is still pointing at the original array 
```

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2011-06-02T23:04:31.037

通过提供对外部对象的引用，将函数外部的对象传递给函数。

当您使用该引用来操作其对象时，外部的对象就会受到影响。但是，如果在函数内部您决定将引用指向其他对象，则根本不会影响外部对象，因为您所做的只是将引用重新指向其他对象。

* * *

## 回答 #7

> 赞同：26
> 
> 时间：2015-02-13T11:00:24.953

可以这样想：它总是按值传递。但是，对象的值不是对象本身，而是对该对象的引用。

这是一个示例，传递一个数字（原始类型）

```
function changePrimitive(val) {
    // At this point there are two '10's in memory.
    // Changing one won't affect the other
    val = val * 10;
}
var x = 10;
changePrimitive(x);
// x === 10 
```

对一个对象重复此操作会产生不同的结果：

```
function changeObject(obj) {
    // At this point there are two references (x and obj) in memory,
    // but these both point to the same object.
    // changing the object will change the underlying object that
    // x and obj both hold a reference to.
    obj.val = obj.val * 10;
}
var x = { val: 10 };
changeObject(x);
// x === { val: 100 } 
```

再举一个例子：

```
function changeObject(obj) {
    // Again there are two references (x and obj) in memory,
    // these both point to the same object.
    // now we create a completely new object and assign it.
    // obj's reference now points to the new object.
    // x's reference doesn't change.
    obj = { val: 100 };
}
var x = { val: 10 };
changeObject(x);
// x === { val: 10} 
```

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2011-05-12T22:20:25.530

关于按值和按引用进行复制、传递和比较的非常详细的解释在*“JavaScript：权威指南”*一书的[这一章](http://docstore.mik.ua/orelly/webprog/jscript/ch11_02.htm)中。

 *> 在我们离开通过引用操作对象和数组的主题之前，我们需要澄清一点命名法。
> 
> 短语“通过引用传递”可以有多种含义。对于某些读者来说，该短语指的是一种函数调用技术，它允许函数为其参数分配新值，并使这些修改后的值在函数外部可见。这不是本书中使用该术语的方式。
> 
> 在这里，我们的意思是对对象或数组的引用——而不是对象本身——被传递给函数。函数可以使用引用来修改对象或数组元素的属性。但是，如果函数用对新对象或数组的引用覆盖引用，则该修改在函数外部不可见。
> 
> 熟悉该术语其他含义的读者可能更愿意说对象和数组是按值传递的，但传递的值实际上是引用而不是对象本身。

* * *

## 回答 #9

> 赞同：22
> 
> 时间：2009-02-05T21:49:37.233

JavaScript 总是*按值传递*；一切都是价值类型。

对象是值，对象的成员函数本身就是值（请记住，函数是 JavaScript 中的一等对象）。此外，关于 JavaScript 中的一切都是*对象*的概念；这是错误的。字符串、符号、数字、布尔值、空值和未定义值都是*原语*。

有时他们可以利用从其基本原型继承的一些成员函数和属性，但这只是为了方便。这并不意味着它们本身就是对象。请尝试以下方法以供参考：

```
x = "test";
console.log(x.foo);
x.foo = 12;
console.log(x.foo);
```

在两者中`console.log`，您都会发现值是`undefined`。

* * *

## 回答 #10

> 赞同：18
> 
> 时间：2015-12-30T02:20:13.410

在 JavaScript 中，值的类型*仅控制该值是由***value-copy**还是由**reference-copy**分配。

*原始值始终由 value-copy 分配/传递*：

*   `null`
*   `undefined`
*   细绳
*   数字
*   布尔值
*   符号在`ES6`

*复合值始终由引用副本分配/传递*

*   对象
*   数组
*   功能

例如

```
var a = 2;
var b = a; // `b` is always a copy of the value in `a`
b++;
a; // 2
b; // 3

var c = [1,2,3];
var d = c; // `d` is a reference to the shared `[1,2,3]` value
d.push( 4 );
c; // [1,2,3,4]
d; // [1,2,3,4] 
```

在上面的代码片段中，因为`2`是一个标量原语，`a`持有该值的一个初始副本，`b`并被分配了该值的另一​​个副本。更改时`b`，您绝不会更改`a`.

但两者`c`和`d`都是对相同共享值的单独引用`[1,2,3]`，这是一个复合值。重要的是要注意，既不“拥有”该值，`c`也`d`不再“拥有”该`[1,2,3]`值——两者都只是对该值的同等对等引用。因此，当使用任一引用来修改 ( `.push(4)`) 实际共享`array`值本身时，它只会影响一个共享值，并且两个引用都将引用新修改的值`[1,2,3,4]`。

```
var a = [1,2,3];
var b = a;
a; // [1,2,3]
b; // [1,2,3]

// later
b = [4,5,6];
a; // [1,2,3]
b; // [4,5,6] 
```

当我们进行赋值`b = [4,5,6]`时，我们完全没有做任何事情来影响`a`仍在引用 ( `[1,2,3]`) 的位置。要做到这一点，`b`必须是指向`a`而不是引用的指针`array`——但 JS 中不存在这样的能力！

```
function foo(x) {
    x.push( 4 );
    x; // [1,2,3,4]

    // later
    x = [4,5,6];
    x.push( 7 );
    x; // [4,5,6,7]
}

var a = [1,2,3];

foo( a );

a; // [1,2,3,4]  not  [4,5,6,7] 
```

当我们传入参数时，它会将引用`a`的副本分配给。并且是指向相同值的单独引用。现在，在函数内部，我们可以使用该引用来改变值本身（）。但是当我们进行赋值时，这绝不会影响初始引用指向的位置——仍然指向（现在修改的）值。`a``x``x``a``[1,2,3]``push(4)``x = [4,5,6]``a``[1,2,3,4]`

要通过值复制有效地传递复合值（如`array`），您需要手动制作它的副本，以便传递的引用不会仍然指向原始值。例如：

```
foo( a.slice() ); 
```

可以通过引用复制传递的复合值（对象、数组等）

```
function foo(wrapper) {
    wrapper.a = 42;
}

var obj = {
    a: 2
};

foo( obj );

obj.a; // 42 
```

在这里，`obj`充当标量原始属性的包装器`a`。当传递给 时`foo(..)`，引用的副本`obj`被传入并设置为`wrapper`参数。我们现在可以使用`wrapper`引用来访问共享对象，并更新其属性。函数完成后，`obj.a`会看到更新后的值`42`。

[资源](https://github.com/getify/You-Dont-Know-JS/blob/master/types%20%26%20grammar/ch2.md)

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2019-11-14T00:48:46.863

好吧，它是关于“性能”和“速度”以及编程语言中的简单单词“内存管理”。

在 javascript 中，我们可以将值放在两层中：**type1** -`objects`和**type2** - 所有其他类型的值，例如`string`& `boolean`& 等

如果您将内存想象为以下正方形，其中每个正方形中只能保存一个 type2-value：

[![在此处输入图像描述](https://i.stack.imgur.com/wFWOs.png)](https://i.stack.imgur.com/wFWOs.png)

每个 type2-value（绿色）是一个**正方形**，而 type1-value（蓝色）是**它们的一组**：

[![在此处输入图像描述](https://i.stack.imgur.com/vwu2v.png)](https://i.stack.imgur.com/vwu2v.png)

关键是，如果你想指示一个 type2-value，地址是简单的，但是如果你想对 type1-value 做同样的事情，那就不容易了！：

[![在此处输入图像描述](https://i.stack.imgur.com/ZISOH.png)](https://i.stack.imgur.com/ZISOH.png)

在一个更复杂的故事中：

[![在此处输入图像描述](https://i.stack.imgur.com/GIEvC.png)](https://i.stack.imgur.com/GIEvC.png)

所以这里的**参考**可以拯救我们： [![在此处输入图像描述](https://i.stack.imgur.com/orhtH.png)](https://i.stack.imgur.com/orhtH.png)

虽然这里的绿色箭头是一个典型变量，紫色是一个对象变量，所以**因为绿色箭头（典型变量）只有一个任务**（并且表示典型值），我们不需要将它的值与它所以我们将绿色箭头与它的值一起移动到任何地方以及所有分配、函数等中......

但是我们不能用紫色箭头做同样的事情，我们可能想在这里移动“约翰”单元格或许多其他事情......，所以紫色箭头会粘在它的位置，只有分配给它的典型箭头会移动...

一个非常令人困惑的情况是您无法意识到引用的变量是如何变化的，让我们看一个非常好的示例：

```
let arr = [1, 2, 3, 4, 5]; //arr is an object now and a purple arrow is indicating it
let obj2 = arr; // now, obj2 is another purple arrow that is indicating the value of arr obj
let obj3 = ['a', 'b', 'c'];
obj2.push(6); // first pic below - making a new hand for the blue circle to point the 6
//obj2 = [1, 2, 3, 4, 5, 6]
//arr = [1, 2, 3, 4, 5, 6]
//we changed the blue circle object value (type1-value) and due to arr and obj2 are indicating that so both of them changed
obj2 = obj3; //next pic below - changing the direction of obj2 array from blue circle to orange circle so obj2 is no more [1,2,3,4,5,6] and it's no more about changing anything in it but we completely changed its direction and now obj2 is pointing to obj3
//obj2 = ['a', 'b', 'c'];
//obj3 = ['a', 'b', 'c']; 
```

[![在此处输入图像描述](https://i.stack.imgur.com/fELHn.png)](https://i.stack.imgur.com/fELHn.png) [![在此处输入图像描述](https://i.stack.imgur.com/y9kuk.png)](https://i.stack.imgur.com/y9kuk.png)

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2018-09-25T17:31:53.923

这是对按值传递和按引用传递 (JavaScript) 的更多解释。在这个概念中，他们谈论的是通过引用传递变量和通过引用传递变量。

**按值传递（原始类型）**

```
var a = 3;
var b = a;

console.log(a); // a = 3
console.log(b); // b = 3

a=4;
console.log(a); // a = 4
console.log(b); // b = 3 
```

*   适用于 JavaScript 中的所有原始类型（字符串、数字、布尔值、未定义和空值）。
*   a 被分配了一个内存（比如 0x001），b 在内存中创建了一个值的副本（比如 0x002）。
*   因此更改变量的值不会影响另一个变量，因为它们都位于两个不同的位置。

* * *

**通过引用传递（对象）**

```
var c = { "name" : "john" };
var d = c;

console.log(c); // { "name" : "john" }
console.log(d); // { "name" : "john" }

c.name = "doe";

console.log(c); // { "name" : "doe" }
console.log(d); // { "name" : "doe" } 
```

*   JavaScript 引擎将对象分配给变量`c`，它指向一些内存，比如 (0x012)。
*   当 d=c 时，在这一步中`d`指向同一个位置（0x012）。
*   更改两个变量的任何更改值的值。
*   函数是对象

* * *

**特殊情况，按引用传递（对象）**

```
c = {"name" : "jane"};
console.log(c); // { "name" : "jane" }
console.log(d); // { "name" : "doe" } 
```

*   equal(=) 运算符设置新的内存空间或地址

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2017-08-10T12:43:08.317

> 分享我对 JavaScript 引用的了解

在 JavaScript 中，当将对象分配给变量时，分配给变量的值是对该对象的引用：

```
var a = {
  a: 1,
  b: 2,
  c: 3
};
var b = a;

// b.c is referencing to a.c value
console.log(b.c) // Output: 3
// Changing value of b.c
b.c = 4
// Also changes the value of a.c
console.log(a.c) // Output: 4
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2016-12-23T18:43:29.903

语义！！设置具体的定义必然会使一些答案和评论不兼容，因为即使使用相同的单词和短语，它们也不会描述相同的事物，但克服混淆是至关重要的（尤其是对于新程序员而言）。

首先，似乎不是每个人都掌握了多个抽象级别。学习过第 4 代或第 5 代语言的新程序员可能难以围绕汇编或 C 程序员熟悉的概念而不是指针指向指针的指针。引用传递不仅仅意味着使用函数参数变量更改引用对象的能力。

**变量**：符号的组合概念，它引用内存中特定位置的值。这个术语通常过于繁重，无法单独用于讨论细节。

**Symbol** : 用于引用变量的文本字符串（即变量的名称）。

**值**：存储在内存中并使用变量符号引用的特定位。

**内存位置**：存储变量值的位置。（位置本身由一个数字表示，与存储在该位置的值不同。）

**函数参数**：函数定义中声明的变量，用于引用传递给函数的变量。

**函数参数**：函数外部的变量，由调用者传递给函数。

**对象变量**：其基本基础值不是“对象”本身的变量，而是它的值是指向存储对象实际数据的内存中另一个位置的指针（内存位置值）。在大多数高代语言中，“指针”方面通过在各种上下文中的自动取消引用有效地隐藏了。

**原始变量**：其值为实际值的变量。即使这个概念也可以通过各种语言的自动装箱和类似对象的上下文来复杂化，但一般的想法是变量的值是由变量的符号表示的实际值，而不是指向另一个内存位置的指针。

*函数实参和形参不是一回事。此外，变量的值不是变量的对象（正如很多人已经指出的那样，但显然被忽略了）。这些区别对于正确理解至关重要。*

**值传递或共享调用（对象）**：函数参数的值被复制到另一个由函数的参数符号引用的内存位置（不管它是在堆栈上还是在堆上）。换句话说，函数参数收到了传递参数值的副本......并且（关键）参数的值永远不会被调用函数更新/更改/更改。请记住，对象变量的值不是对象本身，而是指向对象的指针，因此按值传递对象变量会将指针复制到函数参数变量。函数参数的值指向内存中完全相同的对象。对象数据本身可以通过函数参数直接更改，但函数参数的值永远不会更新，因此它将继续指向*相同的*在整个函数调用过程中，甚至在函数调用之后（即使其对象的数据被更改或函数参数完全分配了不同的对象）。仅仅因为引用的对象可以通过函数参数变量进行更新，就得出函数参数是通过引用传递的结论是不正确的。

**调用/传递引用**：函数参数的值可以/将由相应的函数参数直接更新。如果有帮助，函数参数将成为参数的有效“别名”——它们有效地引用相同内存位置的相同值。如果函数参数是对象变量，则更改对象数据的能力与按值传递的情况没有什么不同，因为函数参数仍将指向与参数相同的对象。但是在对象变量的情况下，如果函数参数被设置为一个完全不同的对象，那么参数也将同样指向不同的对象——这在按值传递的情况下不会发生。

JavaScript 不通过引用传递。如果您仔细阅读，您会发现所有相反的意见都误解了按值传递的含义，并且错误地得出结论，通过函数参数更新对象数据的能力与“按值传递”同义。

**对象克隆/复制**：创建一个新对象并复制原始对象的数据。这可以是深拷贝或浅拷贝，但重点是创建了一个新对象。创建对象的副本是与传递值不同的概念。一些语言区分类对象和结构（或类似的），并且对于传递不同类型的变量可能有不同的行为。但是 JavaScript 在传递对象变量时不会自动执行类似的操作。但是没有自动对象克隆并不能转化为传递引用。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2020-07-26T15:32:34.107

*观察：如果观察者无法检查引擎的底层内存，则无法确定是否复制了不可变值或传递了引用。*

JavaScript 或多或少与底层内存模型无关。没有*参考*²这样的东西。JavaScript 有*值*。两个变量可以保持相同的*值*（或更准确地说：两个*环境记录*可以*绑定*相同的值）。唯一可以改变的值类型是通过抽象 [[Get]] 和 [[Set]] 操作的对象。如果您忘记了计算机和内存，这就是描述 JavaScript 行为所需的全部内容，并且它可以让您理解规范。

```
 let a = { prop: 1 };
 let b = a; // a and b hold the same value
 a.prop = "test"; // The object gets mutated, can be observed through both a and b
 b = { prop: 2 }; // b holds now a different value 
```

现在您可能会问自己，两个变量如何在计算机上保持相同的值。然后，您可能会查看 JavaScript 引擎的源代码，您很可能会发现编写引擎所用语言的程序员会调用参考的东西。

所以实际上你可以说 JavaScript 是“按值传递”，而值是可以共享的，也可以说 JavaScript 是“按引用传递”，这对于低级语言的程序员来说可能是一个有用的逻辑抽象，或者您可以将这种行为称为“通过共享调用”。

由于 JavaScript 中没有引用之类的东西，所有这些都没有错，也没有什么意义。因此，我不认为答案对搜索特别有用。

²说明书中的“*参考*”一词并非传统意义上的参考。它是一个对象和属性名称的容器，它是一个中间值（例如，`a.b`计算结果为`Reference { value = a, name = "b" }`）。术语*参考*有时也出现在规范中不相关的部分。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2018-07-25T15:47:13.283

## JavaScript 通过值传递原始类型，通过引用传递对象类型

> 现在，人们喜欢无休止地争论“通过引用传递”是否是描述 Java 等的正确方式。实际上做。重点是：
> 
> 1.  传递对象不会复制对象。
> 2.  传递给函数的对象可以使其成员被函数修改。
> 3.  传递给函数的原始值不能被函数修改。制作了一份副本。
> 
> 在我的书中，这被称为通过引用传递。

— [Brian Bi](https://www.quora.com/profile/Brian-Bi) -[哪些编程语言是通过引用传递的？](https://www.quora.com/Which-programming-languages-are-pass-by-reference#)

* * *

# 更新

这是对此的反驳：

[JavaScript 中没有可用的“通过引用传递”。](https://stackoverflow.com/a/7744623/5535245)

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2014-09-16T09:19:53.963

我理解这个的简单方法......

*   调用函数时，您传递的是参数变量的内容（引用或值），而不是变量本身。

    ```
    var var1 = 13;
    var var2 = { prop: 2 };

    //13 and var2's content (reference) are being passed here
    foo(var1, var2); 
    ```

*   在函数内部，参数变量`inVar1`和`inVar2`接收传递的内容。

    ```
    function foo(inVar1, inVar2){
        //changing contents of inVar1 and inVar2 won't affect variables outside
        inVar1 = 20;
        inVar2 = { prop: 7 };
    } 
    ```

*   由于`inVar2`收到 的引用`{ prop: 2 }`，您可以更改对象属性的值。

    ```
    function foo(inVar1, inVar2){
        inVar2.prop = 7; 
    } 
    ```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2014-11-01T12:43:24.403

在 JavaScript 中向函数传递参数类似于在 C 中通过指针值传递参数：

```
/*
The following C program demonstrates how arguments
to JavaScript functions are passed in a way analogous
to pass-by-pointer-value in C. The original JavaScript
test case by @Shog9 follows with the translation of
the code into C. This should make things clear to
those transitioning from C to JavaScript.

function changeStuff(num, obj1, obj2)
{
    num = num * 10;
    obj1.item = "changed";
    obj2 = {item: "changed"};
}

var num = 10;
var obj1 = {item: "unchanged"};
var obj2 = {item: "unchanged"};
changeStuff(num, obj1, obj2);
console.log(num);
console.log(obj1.item);    
console.log(obj2.item);

This produces the output:

10
changed
unchanged
*/

#include <stdio.h>
#include <stdlib.h>

struct obj {
    char *item;
};

void changeStuff(int *num, struct obj *obj1, struct obj *obj2)
{
    // make pointer point to a new memory location
    // holding the new integer value
    int *old_num = num;
    num = malloc(sizeof(int));
    *num = *old_num * 10;
    // make property of structure pointed to by pointer
    // point to the new value
    obj1->item = "changed";
    // make pointer point to a new memory location
    // holding the new structure value
    obj2 = malloc(sizeof(struct obj));
    obj2->item = "changed";
    free(num); // end of scope
    free(obj2); // end of scope
}

int num = 10;
struct obj obj1 = { "unchanged" };
struct obj obj2 = { "unchanged" };

int main()
{
    // pass pointers by value: the pointers
    // will be copied into the argument list
    // of the called function and the copied
    // pointers will point to the same values
    // as the original pointers
    changeStuff(&num, &obj1, &obj2);
    printf("%d\n", num);
    puts(obj1.item);
    puts(obj2.item);
    return 0;
} 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2021-11-05T11:13:32.993

一切都是按值传递的。

基本类型按值传递（即，将实际变量值的新副本传递给函数）。

复杂类型（对象）作为“指向对象的指针”传递。所以你传递的实际东西是一个按值传递的指针（它是一个地址，一个数值，就像其他任何东西一样）。显然，如果您尝试在函数内部修改对象的属性，即使在该函数之外，修改也会反映出来。那是因为您正在通过指向该属性的唯一副本的指针访问该属性。

这里的混淆出现在“通过值传递指针”和“通过引用传递对象”。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2019-04-20T06:06:32.653

MDN 文档清楚地解释了它，而不是太冗长：

> 函数调用的参数是函数的*参数*。参数*按值*传递给函数。如果函数更改了参数的值，则此更改不会在全局或调用函数中反映出来。但是，对象引用也是值，并且它们很特殊：如果函数更改了引用对象的属性，则该更改在函数外部可见，（...）

来源：[https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions#Description](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions#Description)

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2017-07-28T13:17:37.877

对于编程语言律师，我已经阅读了 ECMAScript 5.1 的以下部分（比最新版本更容易阅读），并在 ECMAScript 邮件列表中[询问它。](https://esdiscuss.org/topic/are-the-values-of-objects-the-references-to-them)

**TL;DR** : 一切都是按值传递的，但对象的属性是引用，并且标准中令人毛骨悚然地缺乏对象的定义。

# 参数列表的构建

第 11.2.4 节“参数列表”在生成仅包含 1 个参数的参数列表时说如下：

> 产生式 ArgumentList : AssignmentExpression 的评估如下：
> 
> 1.  令 ref 为评估 AssignmentExpression 的结果。
> 2.  设 arg 为 GetValue(ref)。
> 3.  返回一个唯一项为 arg 的列表。

该部分还列举了参数列表具有 0 或 >1 个参数的情况。

因此，一切都是通过引用传递的。

# 对象属性的访问

第 11.2.1 节“属性访问器”

> 产生式 MemberExpression : MemberExpression [ Expression ] 的评估如下：
> 
> 1.  让 baseReference 成为评估 MemberExpression 的结果。
> 2.  让 baseValue 为 GetValue(baseReference)。
> 3.  让propertyNameReference 成为计算Expression 的结果。
> 4.  让 propertyNameValue 为 GetValue(propertyNameReference)。
> 5.  调用 CheckObjectCoercible(baseValue)。
> 6.  让 propertyNameString 为 ToString(propertyNameValue)。
> 7.  如果正在评估的语法产生包含在严格模式代码中，则让 strict 为真，否则让 strict 为假。
> 8.  **返回一个 Reference 类型的值，**其基值为 baseValue，其引用名称为 propertyNameString，其严格模式标志为 strict。

因此，对象的属性始终可以作为参考。

# 参考资料

在第 8.7 节“引用规范类型”中有描述，引用不是语言中的真实类型——它们仅用于描述删除、typeof 和赋值运算符的行为。

# “对象”的定义

在 5.1 版本中定义“对象是属性的集合”。因此，我们可以推断，对象的值就是集合，但是关于集合的值是什么，规范中没有定义，需要花点[功夫](https://stackoverflow.com/questions/45388408/where-is-the-mutability-of-objects-defined-in-ecmascript/45407589#45407589)去理解。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2014-05-17T01:01:14.920

我发现的最简洁的解释是在[AirBNB 风格指南](https://github.com/airbnb/javascript#types)中：

*   **Primitives**：当你访问一个基本类型时，你直接处理它的值

    *   细绳
    *   数字
    *   布尔值
    *   无效的
    *   不明确的

例如：

```
var foo = 1,
    bar = foo;

bar = 9;

console.log(foo, bar); // => 1, 9 
```

*   **复杂**：当您访问复杂类型时，您处理对其值的引用

    *   目的
    *   大批
    *   功能

例如：

```
var foo = [1, 2],
    bar = foo;

bar[0] = 9;

console.log(foo[0], bar[0]); // => 9, 9 
```

即有效的原始类型通过值传递，复杂类型通过引用传递。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-10-29T14:50:30.530

我已经多次阅读这些答案，但直到我了解了Barbara Liskov 所称的[“通过共享呼叫”的技术定义时才真正明白](https://en.wikipedia.org/wiki/Evaluation_strategy#Call_by_sharing)

> 共享调用的语义不同于引用调用，因为调用者看不到函数内函数参数的赋值（与引用语义不同）[需要引用]，因此例如，如果传递了变量，则不可能在调用者的范围内模拟对该变量的赋值。但是，由于该函数可以访问与调用者相同的对象（不进行复制），因此如果对象是可变的，则对这些对象的突变对调用者是可见的，这可能看起来与按值调用不同语义。函数中可变对象的突变对调用者是可见的，因为该对象没有被复制或克隆——它是共享的。

也就是说，如果您访问参数值本身，参数引用是可以更改的。另一方面，对参数的赋值将在评估后消失，并且函数调用者无法访问。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-10-11T10:38:08.690

如果您想要像其他语言一样的（正常）函数参数行为（传递值的副本），那么只需在传递给函数之前克隆对象：

```
function run()
{
    var test = [];
    test.push(1);

    console.log('before: '+test); // 1

    changeVariable(_.clone(test)); // (Note: I am using lodash _.clone() function)

    console.log('after: '+test); // 1 
}

function changeVariable(test2) {
  var test1 = test2;
  test1.push(2); 
  console.log('inside func:', test1);  // inside func: [1,2]
}   

run(); 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2016-10-19T12:07:22.367

在低级语言中，如果要通过引用传递变量，则必须在创建函数时使用特定的语法：

```
int myAge = 14;
increaseAgeByRef(myAge);
function increaseAgeByRef(int &age) {
  *age = *age + 1;
} 
```

是对`&age`的引用`myAge`，但如果您想要该值，则必须转换引用，使用`*age`.

JavaScript 是一种高级语言，可以为您进行这种转换。

因此，尽管对象是通过引用传递的，但语言会将引用参数转换为值。您不需要`&`在函数定义上使用 , 来通过引用传递它，也不需要`*`在函数体上使用 , 将引用转换为值，JavaScript 会为您完成。

这就是为什么当您尝试更改函数内的对象时，通过替换它的值（即`age = {value:5}`），更改不会持续，但如果您更改它的属性（即`age.value = 5`），它会持续。

[学到更多](https://blog.penjee.com/passing-by-value-vs-by-reference-java-graphical/)

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2012-05-05T14:32:23.390

我发现[Underscore.js 库的](http://documentcloud.github.com/underscore)[extend 方法](http://documentcloud.github.com/underscore/#extend)在我想将对象作为参数传递时非常有用，该参数可以被修改或完全替换。

```
function replaceOrModify(aObj) {
  if (modify) {

    aObj.setNewValue('foo');

  } else {

   var newObj = new MyObject();
   // _.extend(destination, *sources) 
   _.extend(newObj, aObj);
  }
} 
```

* * *

## 回答 #27

> 赞同：-2
> 
> 时间：2015-01-09T04:54:36.033

我会说这是通过副本-

考虑参数和变量对象是在函数调用开始时创建的执行上下文期间创建的对象 - 传递给函数的实际值/引用只是存储在这个参数+变量对象中。

简单来说，对于原始类型，值在函数调用开始时被复制，对于对象类型，引用被复制。

* * *

## 回答 #28

> 赞同：-3
> 
> 时间：2013-02-25T12:33:32.737

1.  基元（数字、布尔值等）按值传递。
    *   字符串是不可变的，所以对它们来说并不重要。
2.  对象按引用传递（引用按值传递）。

* * *

## 回答 #29

> 赞同：-3
> 
> 时间：2014-10-28T13:45:26.683

1.  原始类型变量（如字符串、数字）始终作为按值传递。
2.  Array 和 Object 基于这两个条件作为按引用传递或按值传递传递。

    *   如果您使用新对象或数组更改该对象或数组的值，那么它是按值传递的。

        `object1 = {item: "car"}; array1=[1,2,3];`

    在这里，您将新对象或数组分配给旧对象。您没有更改旧对象的属性值。因此它是按值传递的。

    *   如果您要更改对象或数组的属性值，则它是通过引用传递的。

        `object1.key1= "car"; array1[0]=9;`

    在这里，您正在更改旧对象的属性值。您没有将新对象或数组分配给旧对象。因此它是通过引用传递的。

**代码**

```
 function passVar(object1, object2, number1) {

        object1.key1= "laptop";
        object2 = {
            key2: "computer"
        };
        number1 = number1 + 1;
    }

    var object1 = {
        key1: "car"
    };
    var object2 = {
        key2: "bike"
    };
    var number1 = 10;

    passVar(object1, object2, number1);
    console.log(object1.key1);
    console.log(object2.key2);
    console.log(number1);

Output: -
    laptop
    bike
    10 
```

* * *

## 回答 #30

> 赞同：-3
> 
> 时间：2009-02-05T22:02:47.427

确定某事物是否“通过引用传递”的一种简单方法是您是否可以编写“交换”函数。例如，在 C 中，您可以执行以下操作：

```
void swap(int *i, int *j)
{
    int t;
    t = *i;
    *i = *j;
    *j = t;
} 
```

如果你不能在 JavaScript 中做同样的事情，它就不是“通过引用传递”。

* * *

## 回答 #31

> 赞同：-4
> 
> 时间：2009-02-05T21:36:56.293

[这里](https://developer.mozilla.org/en-US/docs/Talk:JavaScript/Guide/Obsolete_Pages/Defining_Functions)有一些关于在 JavaScript 中使用“通过引用”一词的讨论，但要回答您的问题：

> 对象通过引用自动传递，无需特别声明

（来自上面提到的文章。）

* * *

## 回答 #32

> 赞同：-5
> 
> 时间：2013-04-27T12:36:40.437

函数内部的简单值不会改变函数外部的值（它们通过值传递），而复杂的值会（它们通过引用传递）。

```
function willNotChange(x) {

    x = 1;
}

var x = 1000;

willNotChange(x);

document.write('After function call, x = ' + x + '<br>'); // Still 1000

function willChange(y) {

    y.num = 2;
}

var y = {num: 2000};

willChange(y);
document.write('After function call y.num = ' + y.num + '<br>'); // Now 2, not 2000 
```

* * *

## 回答 #33

> 赞同：-6
> 
> 时间：2009-08-21T15:30:52.340

基元按值传递，对象按引用传递。这与 C、Visual Basic 或 Delphi 等其他语言完全不同。我不能确切地说它们如何处理对象和原语，但我知道 Visual Basic 和 Delphi 可以（并且应该）指定它。

PHP 从版本 5 开始做了类似的事情：所有对象都通过引用传递，但所有原语*都*可以通过引用传递，如果前面有一个 & 符号。否则，原语按值传递。

所以在 JavaScript 中，如果我通过参数将对象 X 传递给函数，它仍然是 X。如果您要更改函数*内部*的数据（或任何其他对象，但这并不重要），那么新值也可以在功能。

# sql-server - SQL Server 2000 中是否有 DDL 审计

> ID：518005
> 
> 赞同：1
> 
> 时间：2009-02-05T21:24:36.363
> 
> 标签：sql-server, sql-server-2000, auditing, ddl-trigger

如果没有，有没有办法判断触发器何时被禁用/启用？

**跟进：**

这是一个相当有趣的诊断案例。我只是从外围参与进来，做诊断的人不是数据库人。

无论如何，他有一个触发器，可以将数据从一个表移动到另一个表。他做了一个比较，并不是所有的数据都进入了第二张表。我说，我是 SQL Server 的批评者，但我相信他们的触发器会在同一个事务中触发。他说，但有些数据成功了……如果它只是被禁用，什么都不应该成功。真的。所以我说也许有人在启用和禁用触发器。因此问题。

但真正发生的是有人永久禁用触发器并将代码复制到设置为在特定时间运行的存储过程中。

正确的取证测试应该是查看第二个表的依赖关系，看看还有什么在使用它。这将显示肿瘤sproc......（我一直在看很多[房子](http://www.fox.com/house/)重播，你能说出来吗）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T21:31:40.203

没有审计，尽管有一家名为 Lumigent 的公司提供产品“审计数据库”，该产品将为 SQL Server 进行 DDL 审计（除其他外）。

您可以在 sysobjects 表中查找 crdate，它会告诉您对象的创建时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T11:27:13.870

您的问题看起来与 Randy Volters 在 Simple-Talk 中所写的问题非常相似

[http://www.simple-talk.com/sql/database-administration/dml-trigger-status-alerts/](http://www.simple-talk.com/sql/database-administration/dml-trigger-status-alerts/)

我怀疑它会有所帮助

# reporting-services - 如何控制报告服务的目标框架 (SSRS) 向下钻取

> ID：518010
> 
> 赞同：1
> 
> 时间：2009-02-05T21:25:31.277
> 
> 标签：reporting-services, reportingservices-2005

我正在使用带有 Web 报表查看器控件的 SQL 2005 报表服务 (SSRS)。它在网页的 IFRAME 内显示报告。如果我通过将 URL 操作附加到图表元素来实现向下钻取功能，则导航将仅发生在 IFRAME 内。我知道如何在普通的 HTML 页面上设置导航的目标框架。但是在报告定义（RDL）中我找不到任何属性来选择目标框架。任何解决方案或解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-23T14:17:41.637

嗯，它显然没有发布我的最后回复。您可以尝试将 rc:LinkTarget 查询字符串参数添加到 IFRAME src。我在 IFRAME 中显示的一些图表上使用了“&rc:LinkTarget=_blank”，它们正确打开了完整的报告。

[http://msdn.microsoft.com/en-us/magazine/cc188712.aspx](http://msdn.microsoft.com/en-us/magazine/cc188712.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T22:15:26.650

我不相信 RDL 内置了该选项。尝试将其添加为连接项，看看他们是否会将其添加到 SQL Server 的未来版本中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-23T15:17:17.367

如果您覆盖 HTML Render 方法并传递一些 DeviceInfo 参数，则可以完成此操作。

看看[http://msdn.microsoft.com/en-us/library/ms155395.aspx](http://msdn.microsoft.com/en-us/library/ms155395.aspx)

有一个 LinkTarget 属性可以处理这个问题。

# sql - 从不同的表中检索列名？

> ID：518012
> 
> 赞同：0
> 
> 时间：2009-02-05T21:25:48.157
> 
> 标签：sql, sql-server, pivot

我有一个“datadump”表，其中包含一堆混合的与性能相关的数据。就像是：

```
MachID  TestDate  MachType  Value1   Value2    ... 
00001   01/01/09  Server    15        48       
00001   01/02/09  Server    16        99       
19999   01/01/09  Switch    32        4.9880   
19999   01/02/09  Switch    32        5.8109 
```

诀窍是“值”列*对于*不同类型的机器意味着不同的东西。所以我们有一个“xRef”表，如下所示：

```
MachType       Column   Description
Server         Value1   Users Connected
Server         Value2   % CPU _total
Switch         Value1   Number of Ports
Switch         Value2   packets/ms 
... 
```

我知道，奇怪的结构，但我没有做到，也无法改变它。

我想以某种方式“内部连接”这些，以便我可以根据数据类型查询适当的列标题。服务器是这样的：

```
MachID  TestDate  MachType  Users Connected     % CPU _total    Total RAM
00001   01/01/09  Server    15                  48              4096
00001   01/02/09  Server    16                  99              4096 
```

这对于开关：

```
MachID  TestDate  MachType  Number of Ports   packets/ms  Total Cumulative kb
19999   01/01/09  Switch    32                4.9880      1024547
19999   01/02/09  Switch    32                5.8109      1029450 
```

有没有办法在不对每种类型进行单独的硬编码查询的情况下做到这一点？

**注意**：我一次只需要查询一种*类型*的对象。如果有帮助，我很可能只会查看单个 MachID 特定日期之间的所有结果。这是 MS SQL 2000。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T22:29:14.613

这会将它们一起完成 - 如果您希望将它们全部拆分，您可以根据需要进行修改。

```
DECLARE @template AS varchar(max)
DECLARE @sql AS varchar(max)
DECLARE @column_list AS varchar(max)
SELECT  @column_list = COALESCE(@column_list + ', ', '')
        + QUOTENAME([Description])
FROM    xRef

SET @template = ';
WITH    up
          AS (
              SELECT    MachID
                       ,TestDate
                       ,MachType
                       ,[COLUMN]
                       ,[Value]
              FROM      datadump UNPIVOT ( [Value] FOR [Column] IN ([Value1], [Value2]) ) AS unpvt
             )
             ,ready AS (
    SELECT  machID
           ,TestDate
           ,up.MachType
           ,[Description]
           ,up.[Value]
    FROM    up
    INNER JOIN xRef
            ON xRef.machType = up.MachType
               AND xRef.[Column] = up.[Column]
)
SELECT * FROM ready
PIVOT (SUM([Value]) FOR [Description] IN ({@column_list})) AS pvt
'

machID TestDate                MachType Users Connected                         % CPU _total                            Number of Ports                         packets/ms
------ ----------------------- -------- --------------------------------------- --------------------------------------- --------------------------------------- ---------------------------------------
00001  2009-01-01 00:00:00.000 Server   15.000000000000000                      48.000000000000000                      NULL                                    NULL
00001  2009-01-02 00:00:00.000 Server   16.000000000000000                      99.000000000000000                      NULL                                    NULL
19999  2009-01-01 00:00:00.000 Switch   NULL                                    NULL                                    32.000000000000000                      4.988000000000000
19999  2009-01-02 00:00:00.000 Switch   NULL                                    NULL                                    32.000000000000000                      5.810900000000000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T00:46:14.117

动态 sql 选项将是（作为查询写出，而不是写入 proc）：

```
declare @machtype varchar(40) --stored proc parameter?
set @machtype = 'Switch' --or 'Server'

declare @sql nvarchar(4000)

set @sql = 'select
    MachID,
    TestDate,
    MachType,
    Value1 as ''' + (select [Description] from dbo.xref where machtype = @machtype and [Column] = 'Value1') + ''',
    Value2 as ''' + (select [Description] from dbo.xref where machtype = @machtype and [Column] = 'Value2') + ''',
    Value3 as ''' + (select [Description] from dbo.xref where machtype = @machtype and [Column] = 'Value3') + '''
from 
    dbo.datadump
where
    machtype = ''' + @machtype + ''''

exec sp_executesql @sql 
```

如果你觉得这对你来说太难看了，那么将获取列名的逻辑包装在一个函数中会整理它：

```
create function dbo.ColNameForDataDump(
    @machtype varchar(40),
    @column varchar(40)
)
RETURNS varchar(40)
as
begin

    declare @col_desc varchar(40)
    select
        @col_desc = [description]
    from
        dbo.xref
    where
        machtype = @machtype
        and [column] = @column

    return @col_desc
end 
```

然后您的动态 SQL 将看起来更像：

```
declare @machtype varchar(40) --stored proc parameter?
set @machtype = 'Switch' --or 'Server'

declare @sql nvarchar(4000)

set @sql = 'select
    MachID,
    TestDate,
    MachType,
    Value1 as ''' + dbo.ColNameForDataDump(@machtype, 'Value1') + ''',
    Value2 as ''' + dbo.ColNameForDataDump(@machtype, 'Value2') + ''',
    Value3 as ''' + dbo.ColNameForDataDump(@machtype, 'Value3') + '''
from 
    dbo.datadump
where
    machtype = ''' + @machtype + ''''

exec sp_executesql @sql 
```

最后是对上面代码的传递点/评论：您提到您在 SQL Server 2000 上，因此请确保当您必须编写一些动态 sql 以将其定义为 nvarchar 并使用 sp_executesql 调用它...从而否定一些不得不去动态的性能痛苦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T21:29:19.490

创建一个表，存储该单个查询类型的每个值的标题名称。

然后，创建一个存储过程并使用动态 SQL 填写从该表中提取的列名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T21:47:36.770

由于您无法更改数据模型，我建议将表示代码放入应用程序的表示层。有一个表格，根据请求的结果为您提供要使用的列标题，然后从那里开始。

# vb.net - 如何将表单设置为具有透明背景

> ID：518020
> 
> 赞同：6
> 
> 时间：2009-02-05T21:26:43.897
> 
> 标签：vb.net, winforms

我正在努力让我的表单在 vb.net 中具有透明背景

目前以我设置的新形式

```
Me.SetStyle(ControlStyles.SupportsTransparentBackColor, true) 
```

但是表单仍然显示为具有默认的灰色背景

有人可以帮忙吗？？

编辑：我需要表单上的控件可见，所以我不认为将不透明度设置为 0 会起作用

编辑：我尝试了透明度密钥解决方案，但它不起作用。我有一个黑色背景的圆形图像。OnPaint 我将 img 像素的透明度键设置为 0,0，然后给我留下圆形图像（我想要的）它隐藏了黑色背景，但我仍然保留了表单的默认灰色矩形。

下面是我的代码 -

```
Public Sub New()

    Me.SetStyle(ControlStyles.SupportsTransparentBackColor, True)
    Me.BackColor = Color.Transparent
    ' This call is required by the Windows Form Designer.
    InitializeComponent()

    ' Add any initialization after the InitializeComponent() call.
    Me.Timer1.Start()
End Sub

Private Sub frmWoll_Paint(ByVal sender As Object, ByVal e As System.Windows.Forms.PaintEventArgs) Handles Me.Paint

    Dim img As Bitmap = CType(Me.BackgroundImage, Bitmap)

    img.MakeTransparent(img.GetPixel(2, 2))
    Me.TransparencyKey = img.GetPixel(2, 2)
End Sub 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-06T08:19:00.083

使用 TransparencyKey 实现透明形式。

例如。

```
TransparencyKey = Color.Red
Button1.BackColor = Color.Red 
```

现在运行表单，您会发现 button1 中有一个孔。

因此，使用这种方法，您可以在油漆中创建一个蒙版图像，该部分必须是透明的，并将该图像应用到表格中，瞧，表格现在是透明的。

编辑：抱歉回复晚了。

**以下是您修改的代码以满足您的要求**

```
Public Sub New()

    Me.SetStyle(ControlStyles.SupportsTransparentBackColor, True)
    Me.BackColor = Color.Transparent

    ' This call is required by the Windows Form Designer.
    InitializeComponent()
    ' Add any initialization after the InitializeComponent() call.
    Dim img As Bitmap = CType(Me.BackgroundImage, Bitmap)

    'img.MakeTransparent(img.GetPixel(2, 2))
    Me.FormBorderStyle = Windows.Forms.FormBorderStyle.None
    Me.TransparencyKey = img.GetPixel(2, 2)
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T18:26:01.163

设置表单的 TransparencyKey 颜色属性与表单的背景颜色属性相同

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T21:28:15.000

您可以使用几种方法。

*   使用表格 TransparencyKey
*   覆盖 OnPaintBackground (WM_ERASEBKGND)
*   覆盖 WndProc 并处理绘制消息（WM_NCPAINT、WM_PAINT 等）

我建议覆盖窗口过程以获得最佳结果。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-05T21:32:45.757

```
Me.Opacity = 0 
```

请注意：

1.  这是针对整个表单，而不仅仅是背景。有一些变通方法可以使某些部分更加不透明。
2.  它只是一种伪透明，它可以对背后的内容进行快照。它足够聪明，知道何时移动表单，但不知道何时移动表单顶部的其他透明对象。

# python - arr.__len__() 是在 Python 中获取数组长度的首选方法吗？

> ID：518021
> 
> 赞同：752
> 
> 时间：2009-02-05T21:26:47.217
> 
> 标签：python, arrays, methods

在[Python](http://en.wikipedia.org/wiki/Python_%28programming_language%29)中，以下是获取元素数量的唯一方法吗？

```
arr.__len__() 
```

如果是这样，为什么会有奇怪的语法？

* * *

## 回答 #1

> 赞同：1251
> 
> 时间：2009-02-05T21:29:48.100

```
my_list = [1,2,3,4,5]
len(my_list)
# 5 
```

同样适用于元组：

```
my_tuple = (1,2,3,4,5)
len(my_tuple)
# 5 
```

还有字符串，它们实际上只是字符数组：

```
my_string = 'hello world'
len(my_string)
# 11 
```

这样做是[有意](http://effbot.org/pyfaq/why-does-python-use-methods-for-some-functionality-e-g-list-index-but-functions-for-other-e-g-len-list.htm)的，因此列表、元组和其他容器类型或可迭代对象并不都需要显式地实现公共`.length()`方法，而是您可以检查`len()`任何实现“魔术”`__len__()`方法的东西。

当然，这似乎是多余的，但长度检查实现可能会有很大差异，即使在同一种语言中也是如此。一种集合类型使用`.length()`方法而另一种类型使用`.length`属性而另一种使用`.count()`. 拥有一个语言级别的关键字统一了所有这些类型的入口点。因此，即使您可能不认为是元素列表的对象仍然可以进行长度检查。这包括字符串、队列、树等。

的函数性质`len()`也很适合于函数式编程风格。

```
lengths = map(len, list_of_containers) 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-02-05T21:34:00.153

您获取任何有意义的长度（列表、字典、元组、字符串……）的方法是调用`len`它。

```
l = [1,2,3,4]
s = 'abcde'
len(l) #returns 4
len(s) #returns 5 
```

“奇怪”语法的原因是内部 python 转换`len(object)`为`object.__len__()`. 这适用于任何对象。因此，如果您正在定义某个类并且它具有长度是有意义的，只需在其上定义一个`__len__()`方法，然后就可以调用`len`这些实例。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-02-05T21:30:05.823

只需使用`len(arr)`：

```
>>> import array
>>> arr = array.array('i')
>>> arr.append('2')
>>> arr.__len__()
1
>>> len(arr)
1 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-02-05T21:32:43.447

获取任何 python 对象长度的首选方法是将其作为参数传递给`len`函数。在内部，python 将尝试调用`__len__`传递的对象的特殊方法。

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2009-02-06T09:15:37.007

Python 使用[鸭子类型](http://en.wikipedia.org/wiki/Duck_typing)：它不关心对象*是*什么，只要它有适合手头情况的接口即可。当您在对象上调用内置函数 len() 时，实际上是在调用其内部的 __len__ 方法。自定义对象可以实现此接口，并且 len() 将返回答案，即使该对象在概念上不是一个序列。

有关接口的完整列表，请查看此处：[http ://docs.python.org/reference/datamodel.html#basic-customization](http://docs.python.org/reference/datamodel.html#basic-customization)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-10-20T01:10:57.347

您可以`len(arr)` 按照先前答案中的建议使用来获取数组的长度。如果您想要二维数组的尺寸，您可以使用`arr.shape`返回高度和宽度

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-04-12T11:20:13.477

`len(list_name)`函数将列表作为参数并调用列表的`__len__()`函数。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-02-18T10:43:08.967

就像其他人说的那样，Python 建议用户使用`len()`而不是保持一致性。`__len__()`但是，还有其他一些好处：

对于某些内置类型，如`list`,等`str`，`bytearray`Cython 的实现`len()`采取了捷径。它直接返回`ob_size`C 结构中的 ，这比调用`__len__()`.

如果您对这些细节感兴趣，可以阅读 Luciano Ramalho 的《Fluent Python》一书。里面有很多有趣的细节，可以帮助你更深入地理解 Python。

# sql - 邮政编码到城市/州，反之亦然？

> ID：518026
> 
> 赞同：5
> 
> 时间：2009-02-05T21:28:17.153
> 
> 标签：sql, sql-server, zipcode

我是 SQL 和关系数据库的新手，我有一个我想象的常见问题。

我正在制作一个网站，当每个用户提交帖子时，他们必须提供邮政编码或城市/州的位置。

处理此问题的最佳做法是什么？我是否只是简单地创建一个邮政编码和城市和州表并对其进行查询，或者是否有现成的解决方案来处理这个问题？

如果它有所作为，我正在使用 SQL Server 2005。

我需要能够检索给定城市/州的邮政编码，或者我需要能够吐出给定邮政编码的城市州。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-05T21:31:41.717

你有几个选择。您可以从某人那里购买一个[批量邮政编码库](http://www.zip-code-database.org/)，该库将按州列出邮政编码、城市、县等，或者您可以付费让某人访问将在更细粒度级别上执行相同功能[的 Web 服务。](http://codebump.com/zipcode/)

最好的选择是使用邮政编码库选项，因为它比 Web 服务花费更少，并且会提供更好的性能。你如何查询或预处理这个库取决于你。您提到了 SQL Server，因此您可能需要 State、Zipcode 和 City 表，并包括它们之间的相关关系。您还需要为跨越多个邮政编码的城市或具有多个城市的邮政编码提供规定 - 但这些问题都不是不可克服的。

至于处理用户输入的不确定性，您可以考虑寻求[地址验证 Web 服务](http://www.serviceobjects.com/products/address/address-validation-(us)?zut=ggl3001)的帮助，尽管其中大多数需要完整的送货地址才能进行验证。

编辑：看起来有一个[SourceForge 项目提供免费的邮政编码数据](http://sourceforge.net/projects/zips/)，包括纬度/经度数据等。不确定它的正确性或最新性。

编辑 2：粗略浏览了 SourceForge 项目的网站后，看起来这是一个死项目。如果您使用此数据，则需要为数据库中不存在的邮政编码/城市提供一些余量。购买的批量库通常附带某种更新保证或更新定价计划等，并且可能更可靠。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T21:37:56.087

有一个与 CityState 表相关的 ZipCode 表。一些邮政编码有多个与之关联的城市，因此您可能需要让界面让用户从他们想要的城市中进行选择，或者让他们覆盖默认值。

我使用[ZipInfo.com](http://www.zipinfo.com/products/products.htm)的付费服务，因为我需要额外的信息，例如纬度/经度、邮编类型和县。随着新邮政编码的添加或与其他邮政编码的合并，邮政编码每年也会发​​生数次变化，因此您需要每年更新几次数据以保持一致。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T21:38:36.883

根据您正在构建的内容的详细信息，Yelp 有一个免费的[社区 API](http://www.yelp.com/developers/documentation/neighborhood_api#getNeighborhoodsByLocation)，它可能能够为您提供所需的内容。请务必检查他们的使用条款和其他东西，以确保您遵守规定。

我知道这不是以数据库为中心的答案，但是您正在做的事情可能无法在数据库本身中得到最好的处理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T21:45:31.813

有许多免费的地理编码网络服务，您可以在其中从城邦获取 zip，反之亦然。看看 GeoNames 网络服务。您可以执行检查数据库之类的操作，然后如果您要查找的内容不存在，请从 Web 服务中获取并添加它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T21:57:30.930

如果查找的原因是用户的方便，这里有一种不需要许可任何第三方数据库的替代方法：

只要邮政编码匹配，只需从您现有的名称/地址表中查找城市/州。如果有人以前输入过该邮政编码，那么您会从该条目中找到城市和州。如果不存在先前的条目，则最坏的情况是用户必须进入城市和州。

此解决方案假定您的需要是为了方便用户。如果您更关心城市、州、邮政编码的准确验证，那么您最好许可经过验证的数据库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T21:37:01.457

我的理解是，[USPS Web API](http://www.usps.com/webtools/address.htm)可以免费使用，但需要取决于许多因素的许可，包括将使用它的程序的性质以及您需要数据的原因。

如果您有资格使用它，这可能是您所需信息的最准确来源。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-05T21:38:41.330

不确定我是否理解这个问题。您是否需要允许两者之一，然后再返回两者？

即使有可以购买的邮编/城市数据库，您也必须小心，因为有些城市跨越多个邮编，因此您不能总是朝那个方向“计算”。相反方向的类似问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-05T21:39:53.587

您可以购买和导入一些并不昂贵的库。您对它们的问题将是您将需要持续的维护成本（不是很多）。邮政编码一直在变化，这意味着在 6 个月左右，您的数据将稍微过时。您可能想查看与谷歌地图等服务的接口。在这里，我们使用混合方法。我们花这笔钱每 6 个月更新一次数据，如果邮政编码不在表格中，我们会根据谷歌地图对其进行验证，以确保输入的信息仍然有效并且尚未输入进入我们的系统。如果有效，我们更新系统，否则我们让用户知道出错了。

另一种选择是 ping USPS 网站。我相信他们有一个按邮政编码的城市/州查找页面。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-28T18:47:11.047

对于美国各州表，您可以使用以下查询，假设您在表中有`StateId`并且您有自动增量。`StateName``States``StateId`

此查询有 50 个美国州...

```
INSERT INTO States
        ( StateName )
        VALUES
( 'Alabama'),
( 'Alaska'),
( 'Arizona'),
( 'Arkansas'),
( 'California'),
( 'Colorado'),
( 'Connecticut'),
( 'Delaware'),
( 'District of Columbia'),
( 'Florida'),
( 'Georgia'),
( 'Hawaii'),
( 'Idaho'),
( 'Illinois'),
( 'Indiana'),
( 'Iowa'),
( 'Kansas'),
( 'Kentucky'),
( 'Louisiana'),
( 'Maine'),
( 'Maryland'),
( 'Massachusetts'),
( 'Michigan'),
( 'Minnesota'),
( 'Mississippi'),
( 'Missouri'),
( 'Montana'),
( 'Nebraska'),
( 'Nevada'),
( 'New Hampshire'),
( 'New Jersey'),
( 'New Mexico'),
( 'New York'),
( 'North Carolina'),
( 'North Dakota'),
( 'Ohio'),
( 'Oklahoma'),
( 'Oregon'),
( 'Pennsylvania'),
( 'Puerto Rico'),
( 'Rhode Island'),
( 'South Carolina'),
( 'South Dakota'),
( 'Tennessee'),
( 'Texas'),
( 'Utah'),
( 'Vermont'),
( 'Virginia'),
( 'Washington'),
( 'West Virginia'),
( 'Wisconsin'),
( 'Wyoming'); 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-02-05T21:42:25.610

我得到了那个节拍。这是一个免费的（压缩的，csv）：

[托管在 maphacks.com](http://mappinghacks.com/data/zipcode.zip)

标题是 zip,city,state,latitude,longitude,timezone,dst

现在，您的潜在损失是您没有为更新付费（最终可能会咬到您，但他们会尽量保持更新）

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2014-03-20T21:22:49.460

我想添加这个网站。

[http://www.unitedstateszipcodes.org/zip-code-database/](http://www.unitedstateszipcodes.org/zip-code-database/)

如果您用于个人/教育（截至 2014 年 3 月 20 日），您可以免费下载数据。

# c++ - 在 C++ 中，创建一个在调用类的任何其他函数时始终运行的函数

> ID：518028
> 
> 赞同：3
> 
> 时间：2009-02-05T21:28:32.660
> 
> 标签：c++, syntax

C++ 有很多我不知道的东西。

有没有办法在一个类中创建一个函数，每当调用该类的任何其他函数时都会调用该函数？（就像使函数附加到函数的第一个执行路径）

我知道这很棘手，但我很好奇。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-05T21:40:28.610

是的，有一些额外的代码，一些间接和另一个类，并使用 -> 而不是 . 操作员。

```
// The class for which calling any method should call PreMethod first.
class DogImplementation
{
public:
   void PreMethod();
   void Bark();
private:
   DogImplementation(); // constructor private so can only be created via smart-pointer.
   friend class Dog; // can access constructor.
};

// A 'smart-pointer' that wraps a DogImplementation to give you
// more control.
class Dog
{
public:
   DogImplementation* operator -> ()
   {
       _impl.PreMethod();
       return &_impl;
   }
private:
   DogImplementation _impl;
};

// Example usage of the smart pointer. Use -> instead of .
void UseDog()
{
  Dog dog;
  dog->Bark();    // will call DogImplementation::PreMethod, then DogImplementation::Bark
} 
```

嗯.. 大致沿着这些路线的东西可以开发成我认为可以让你做你想做的事情的解决方案。我在那里勾画的内容可能无法编译，但只是为了给你一个起点。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-05T21:39:30.017

是的。:-)

*   将对象包装在智能指针中
*   从智能指针的解引用运算符中自动调用对象的特殊函数（以便在客户端解引用智能指针时调用特殊函数）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-05T22:30:51.393

您可以从此类模板派生：

```
namespace detail {
struct const_tag;
struct nonconst_tag;

/* T is incomplete yet when pre_call is instantiated. 
 * so delay lookup of ::impl until call to operator-> 
 * happened and this delay_lookup is instantiated */
template<typename U, typename>
struct delay_lookup; 

template<typename U>
struct delay_lookup<U, nonconst_tag>
{
    typedef typename U::template get_impl<
        typename U::derived_type>::type impl_type;
    impl_type* u;
    delay_lookup(impl_type* u):u(u) { }
    impl_type* operator->() { return u; }
};

template<typename U>
struct delay_lookup<U, const_tag> {
    typedef typename U::template get_impl<
        typename U::derived_type>::type const impl_type;
    impl_type* u;
    delay_lookup(impl_type* u):u(u) { }
    impl_type* operator->() { return u; }
};

} // detail::

template<typename T>
struct pre_call {
private:
    friend class detail::delay_lookup<pre_call, detail::const_tag>;
    friend class detail::delay_lookup<pre_call, detail::nonconst_tag>;
    typedef T derived_type;

    /* pre_call is the friend of T, and only it
     * is allowed to access T::impl */
    template<typename U> struct get_impl {
        typedef typename U::impl type;
    };

protected:
    typedef boost::function<void(T const&)> fun_type;
    fun_type pre;

    template<typename Fun>
    pre_call(Fun pre):pre(pre) { }

public:
    /* two operator->: one for const and one for nonconst objects */
    detail::delay_lookup<pre_call, detail::nonconst_tag> operator->() { 
        pre(*get_derived()); 
        return detail::delay_lookup<pre_call, 
            detail::nonconst_tag>(&get_derived()->d);
    }

    detail::delay_lookup<pre_call, detail::const_tag> operator->() const { 
        pre(*get_derived()); 
        return detail::delay_lookup<pre_call, 
            detail::const_tag>(&get_derived()->d);
    }

private:
    T * get_derived() { 
        return static_cast<T *>(this); 
    }

    T const* get_derived() const { 
        return static_cast<T const*>(this); 
    }
}; 
```

并像这样使用它：

```
struct foo : pre_call<foo> {
private:
    /* stuff can be defined inline within the class */
    struct impl { 
        void some() const {
            std::cout << "some!" << std::endl;
        }

        void stuff()  {
            std::cout << "stuff!" << std::endl;
        }
    };

    void pre() const { 
        std::cout << "pre!" << std::endl;
    }

    friend struct pre_call<foo>;
    impl d;

public:
    foo():pre_call<foo>(&foo::pre) { }    
};

int main() {
    foo f;
    f->some();
    f->stuff();
    // f.some(); // forbidden now!
} 
```

以前我也有一个称为 post 函数的版本。但我放弃了它。它需要额外的工作。但是，我仍然*不*建议您执行此“自动调用功能”的事情。因为人们很容易忘记使用 operator-> 语法而只使用点 - 突然没有调用 pre 函数

**更新**：上面的版本解决了这个问题，所以人们不能再不小心用点调用函数了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-05T21:32:39.407

没有“自动”的方法可以做到这一点。您需要在每个类方法中添加对函数的调用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-05T21:32:55.973

如果没有一些疯狂的代码注入，这是不可能的。但是，您当然可以手动调用该函数。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-05T21:32:58.610

简短的回答：不。

长答案：C++ 标准中没有这样的东西。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-05T21:53:40.940

如果我没记错的话，这是所谓的[Aspect Oriented Programming](http://en.wikipedia.org/wiki/Aspect-oriented_programming)的一个特性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-05T21:36:32.207

正如其他人所说，没有“自动”的方法可以做到这一点。如在，C++ 标准没有定义一种方法来做到这一点。

但是，如果您打算将方法调用放在每个方法的开头，我建议您改为存储并调用方法指针。这将允许您动态修改正在调用的方法，包括通过一些仔细编程并将方法设置为 null 的方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-05T21:50:34.377

我不确定你的限制是什么，所以我不知道这是否有帮助。如果您的对象是单例，您可以粘贴所有在调用中为每个函数调用调用的代码以获取单例。

缺点是你所有的其他函数调用都变得丑陋。而且您可能无法使对象成为单例。

# asp.net - 在 asp.net 中获取项目网页名称作为枚举

> ID：518031
> 
> 赞同：2
> 
> 时间：2009-02-05T21:28:53.283
> 
> 标签：asp.net, visual-studio

我知道在标记视图中，Visual Studio 将为您提供项目中所有页面名称的枚举（添加一个元素并在指定 ImageUrl 属性时查看您从 Intellisense 获得的内容）。

我的问题是：我如何获得该枚举？

如果这不可能，那么在 asp.net 中获取页面名称的最佳方法是什么，而不必在所有地方硬编码字符串？例如，我希望能够做这样的事情：

Response.Redirect(PageNames.Default);

（其中 PageNames 是某种枚举）

这可能吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T23:13:11.777

这里有一个建议...

手动或通过读取[站点导航](http://msdn.microsoft.com/en-us/library/ms178418.aspx)文件定义一个包含所需页面的类：

```
static class PageNames
{
    public static string Default = "~/Default.aspx";
    public static string Contact = "~/Contact.aspx";
    public static string About = "~/About.aspx";
} 
```

您可以通过调用属性名称来使用该类：

```
Response.Redirect(PageNames.Default); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T23:35:11.110

另一种选择，我已经看过但还没有尝试过（可能下周）：
[http ://blog.devarchive.net/2008/01/auto-generate-strong-typed-navigation.html](http://blog.devarchive.net/2008/01/auto-generate-strong-typed-navigation.html)

看起来很酷，使用 T4 模板生成强类型导航层次结构。

# ruby-on-rails - 为什么这个关联的创建调用不起作用？

> ID：518037
> 
> 赞同：1
> 
> 时间：2009-02-05T21:29:32.690
> 
> 标签：ruby-on-rails, controller, associations, method-chaining

我有一个包含许多项目的用户模型。评级属于用户和项目。

在数据库中，我将 rating.user_id 设置为不为 NULL。

当我创建一个项目时，我想这样做：

```
 def create
    current_user.items.create(params[:item]).ratings.create(params[:rating]
    redirect_to items_path
  end 
```

但是，这与 SQL 错误“user_id 不能为零”有关

所以我将create方法重写为

```
 def create
    current_user.items.create(params[:item]).ratings.create(params[:rating].merge({:user_id => current_user}))
    redirect_to items_path
  end 
```

效果很好。

但是，我曾认为将创建方法链接到当前用户的接收器会填充评级的 user_id。有谁知道为什么不？

TIA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T21:50:57.450

如果可能，我建议您在数据库中对此进行规范化。也许从评级表中取出 user_id 属性，如果您在模型中需要它，使用 :through 方法通过连接获取它

```
class Rating
    has_many :items
    has_one :user, :through=>:items 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T21:54:58.020

如果您创建并保存了该项目，然后对该项目进行评级，它不会将用户传递给评级，对吗？您只需将其称为@rating.item.user，对吗？

当您这样考虑时，您不会期望通过 current_user 创建的项目将用户信息传递给评级。

让我想知道您是否真的需要用户 has_many 评级关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T21:43:46.077

因为 Item 有很多 Ratings 并且该关联不知道用户 ID。鉴于关联链 Item 将具有用户 ID，因为它属于用户。并且 Rating 会有一个项目 id，因为它属于一个项目。但是，除非您告诉它，否则 Item to Rating 关联对用户一无所知。

# vb6 - VB6中的远程调试

> ID：518042
> 
> 赞同：9
> 
> 时间：2009-02-05T21:31:20.547
> 
> 标签：vb6, clickonce, regfreecom

是否可以远程调试在 VB6 之外启动的进程？

该应用程序是一个 VB6 应用程序，具有相当多的 dll/ocx 资源。我正在尝试使用无注册 COM 设置 VB6 应用程序的 ClickOnce 部署，但在执行时出现错误。

我对 VB6 重定向 COM 注册方式的理解可能意味着这是不可能的，但我认为有人可能有更好的主意。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-05T23:01:34.220

为了支持 Darryl 建议[Windbg](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)的回答- 这是 Microsoft 人员[2006 年](http://blogs.msdn.com/marklon/archive/2006/01/28/518616.aspx)关于将 Windbg 与 VB6 结合使用的[博客文章，以及另一位 Microsoft 人员 2004 年](http://mtaulty.com/communityserver/blogs/mike_taultys_blog/archive/2004/08/03/4656.aspx)关于 Windbg的简要介绍的博客文章。

编辑：只是为了让它完全清楚。Windbg 是来自 Microsoft 的免费独立调试器。将您的 VB6 EXE、DLL 和 OCX 编译为带有符号的本机代码（创建 PDB 文件），您将能够调试 ClickOnce 应用程序。

博客的关键摘录：

> 如果您对服务器计算机的访问权限有限，则可以使用 WinDbg 的远程调试工具。以通常的方式将 WinDbg 的副本附加到进程，然后将其转入调试服务器（查看 WinDbg 帮助中的 .server）。然后，您可以从 WinDbg 的“文件”菜单远程连接到它。除了服务器机房风扇没有噪音之外，它就像在那里一样。调试远程时，您的 WinDbg 副本只是一个非常智能的终端，因此所有扩展、符号等都必须在远程服务器上。您为任何 DLL、VB6 或 .NET 设置完全相同的方式。
> 
> 在您的组件加载之前，您的组件的符号不会加载，因此您必须让服务器运行至少那么长时间。如果你想在那个时候停止调试器，你可以在你的 VB 代码中提前中断，但是如果你这样做了，请记住它会在每次通过代码时停止。假设您让它运行然后闯入。如果您使用“x MyModule！*”列出模块的加载符号，那么您将看到您的所有函数以及捆绑在那里的许多符号。VB 毫不掩饰地添加了接口和符号，但您通常不需要担心这些。可能看起来很奇怪的一件事是所有类/方法语法都使用 C++ 双冒号约定而不是友好的小点。
> 
> 从这里，您可以以通常的方式（bp 等）设置断点并逐步执行代码。您也可以使用 F9 打开 VB 源代码模块并在其中设置断点，尽管 VB 文件扩展名不在源文件类型下拉列表中。单步执行代码是有启发性的，但如果您以前没有看过 VB 为您生成的代码，可能会有点令人担忧。您将逐步浏览汇编程序，其中有很多 COM goo。Hresults 得到了很多检查。您可能需要经常参考源代码来确定您的位置，因为需要一些练习才能知道源代码的样子。变体尤其具有挑战性，因为 VB 在那里为您做了很多工作，看起来像一个简单的等式可能会导致大量代码。
> 
> 通过这种方式获取数据并不容易。当您查看局部变量（dv 是命令）时，您可能会看到变量被简单地列为 eclipsed，这意味着内存在函数生命周期内也被用于其他用途，或者名称在此上下文中不是唯一的. 枚举仅显示为整数或长整数，对象显示为指针。事实上，它们总是如此，但 VB IDE 对您隐藏了这一点。VB 字符串实际上是 COM BSTR（以及相应的 Unicode），而字节数组实际上是 char 数组。您可能会惊讶地发现 VB 字符串是 Unicode，因为 VB 似乎只支持 ANSI。那是因为 Ruby 表单引擎只是 ANSI。
> 
> 您将无法获取 Err、App 或 Printer 对象，因为您需要通过许多内部且完全未记录的结构来获取它们。即使您可以到达那里，它们也只是没有您在 VB 中使用的访问器函数的原始数据。如果您需要查看这些字段中的任何一个，最好的办法是在源代码中嵌入调试代码，以将它们的值复制到您可以获得的位置。
> 
> 如果需要，您可以进入 VB 运行时，但如果您尝试调试应用程序，它可能不会很有启发性。如果这样做，您会注意到 VB 的内部结构受 COM 的影响很大。影响实际上是两个方面的，因为一些 COM 想法最初来自 VB。
> 
> 运行代码时您可能会看到异常。空引用异常（即取消引用空指针）并不少见或任何需要担心的事情。它们将显示为地址为 0 或几乎为 0 的第一次机会 C000005 异常。如果有对象设置为空，运行时有时会这样做，但这是安全的，因为唯一可能的值是 null 或有效值。如果您的代码在集合中进行查找并且值不存在，您也会看到异常。因为异常现在非常昂贵，所以如果可以的话，您可能希望避免这样做。您通常会看到的另一个例外是 c000008f。如果您查看该数字，您会发现它是一个浮点不精确结果异常。
> 
> 调试 VB 组件中的挂起和崩溃的方式与任何其他非托管组件的调试方式非常相似，但由于上述编译，它会稍微困难一些。如果您必须尝试以这种方式调试 VB 代码，我强烈建议您从“Hello world”应用程序开始，然后逐步进行。VB 可能是一种易于编码的语言，但所有的东西使它成为一种糟糕的调试语言。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T22:13:53.253

我相信在 VB6 中调试时，它不会附加到正在运行的二进制文件，而是在它自己的进程中解释代码。这就是为什么任务管理器和 Win32 API 在调试时将 VB6.exe 显示为正在运行的应用程序的原因。

正如您所说，VB6 有时会短路对 COM 库的调用，因此并非总是可以拦截这些调用。

您可能不得不求助于智能日志记录（即记录您遇到错误的点周围的变量值，以期找到它发生的代码行和/或相关变量的状态.)

祝你好运

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-05T22:20:45.907

你试过[windbg](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)吗？只要确保你有项目的 pdb 文件。

# asp.net - 从 asp:Table 控件获取 innerHTML

> ID：518058
> 
> 赞同：2
> 
> 时间：2009-02-05T21:32:58.970
> 
> 标签：asp.net, printing, controls, markup

我想通过单击按钮捕获“asp:Table 控件的内部HTML。即 webforms 页面有一个在运行时动态填充的 asp:Table 控件。我需要一个快速/脏打印按钮来打印理想情况下，我只想有一种简单的方法来获取渲染表的标记以喷射到一个新的通用非显示表单，它所做的只是在其页面上的任何标记上执行 Javascript 打印命令. 有什么想法吗？也欢迎替代品。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-09-21T13:57:22.920

如果您的按钮出现，请将其设置`innerHTML`为 JavaScript 的隐藏字段。`OnClientClick`您可以在服务器端事件中获取隐藏字段值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-17T21:56:18.683

I would suggest you use the `@media print` CSS media type to do this.

For example, say your site has a left hand column with an id of `#leftNav`. The following will hide that div when the use goes to Print the page:

```
<style type="text/css">

@media print
{
    #leftNav
    {
        display: none;
    }
}

</style> 
```

In doing this, you can customize the look and feel of a printed page just like you would a standard browser page.

# opengl - 调试 OpenGL 的最佳方法是什么？

> ID：518063
> 
> 赞同：64
> 
> 时间：2009-02-05T21:36:27.213
> 
> 标签：opengl, debugging

我发现很多时候，OpenGL 会通过不绘制任何东西来告诉你它失败了。我试图通过检查转换矩阵堆栈等找到调试 OpenGL 程序的方法。调试 OpenGL 的最佳方法是什么？如果代码看起来和感觉顶点都在正确的位置，你怎么能确定它们是正确的？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-05T21:56:34.523

没有直接的答案。这一切都取决于你试图理解什么。由于 OpenGL 是一个状态机，有时它不会做你期望的事情，因为没有设置所需的状态或类似的事情。

通常，使用 glTrace / glIntercept（查看 OpenGL 调用跟踪）、gDebugger（可视化纹理、着色器、OGL 状态等）和纸/铅笔 :) 之类的工具。有时它有助于了解您如何设置相机以及它正在寻找的位置，正在剪辑的内容等。我个人比前两种方法更依赖于最后。但是，当我可以争辩说深度是错误的时，查看轨迹会有所帮助。gDebugger 也是唯一可以有效用于分析和优化 OpenGL 应用程序的工具*。*

除了这个工具之外，大多数时候人们会出错并且使用任何工具都无法理解的数学。在 OpenGL.org 新闻组上发布代码特定评论，您将永远不会失望。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-04-23T05:59:08.310

> 调试 OpenGL 的最佳方法是什么？

*不考虑其他和外部工具（其他答案已经这样做了）。*

那么一般的方式就是广泛调用[`glGetError()`](https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glGetError.xhtml)。然而，更好的选择是使用[调试输出](https://www.khronos.org/opengl/wiki/Debug_Output)（[KHR_debug](https://www.khronos.org/registry/OpenGL/extensions/KHR/KHR_debug.txt)，[ARB_debug_output](https://www.khronos.org/registry/OpenGL/extensions/ARB/ARB_debug_output.txt)）。这为您提供了为不同严重级别的消息设置回调的功能。

为了使用调试输出，*必须*`WGL/GLX_DEBUG_CONTEXT_BIT`使用标志创建上下文。[使用 GLFW 可以使用`GLFW_OPENGL_DEBUG_CONTEXT`窗口提示](http://www.glfw.org/docs/latest/window_guide.html)进行设置。

```
glfwWindowHint(GLFW_OPENGL_DEBUG_CONTEXT, GL_TRUE); 
```

请注意，如果上下文不是调试上下文，则不能保证接收所有甚至任何消息。

可以通过检查来检测您是否有调试上下文`GL_CONTEXT_FLAGS`：

```
GLint flags;
glGetIntegerv(GL_CONTEXT_FLAGS, &flags);

if (flags & GL_CONTEXT_FLAG_DEBUG_BIT)
    // It's a debug context 
```

然后，您将继续并指定一个回调：

```
void debugMessage(GLenum source, GLenum type, GLuint id, GLenum severity, GLsizei length,
                  const GLchar *message, const void *userParam)
{
    // Print, log, whatever based on the enums and message
} 
```

枚举的每个可能值[都可以在这里看到](https://www.khronos.org/opengl/wiki/Debug_Output)。特别记得检查严重性，因为有些消息可能只是通知而不是错误。

您现在可以提前注册回调。

```
glEnable(GL_DEBUG_OUTPUT);
glEnable(GL_DEBUG_OUTPUT_SYNCHRONOUS);
glDebugMessageCallback(debugMessage, NULL);

glDebugMessageControl(GL_DONT_CARE, GL_DONT_CARE, GL_DONT_CARE, 0, NULL, GL_TRUE); 
```

您甚至可以使用[`glDebugMessageInsert()`](https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glDebugMessageInsert.xhtml).

```
glDebugMessageInsert(GL_DEBUG_SOURCE_APPLICATION, GL_DEBUG_TYPE_ERROR, 0,
                     GL_DEBUG_SEVERITY_NOTIFICATION, -1, "Vary dangerous error"); 
```

* * *

当涉及到着色器和程序时，您总是想要检查`GL_COMPILE_STATUS`，`GL_LINK_STATUS`并且`GL_VALIDATE_STATUS`. 如果其中任何一个反映有问题，那么另外总是检查[`glGetShaderInfoLog()`](https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glGetShaderInfoLog.xhtml)/ [`glGetProgramInfoLog()`](https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glGetProgramInfoLog.xhtml)。

```
GLint linkStatus;
glGetProgramiv(program, GL_LINK_STATUS, &linkStatus);

if (!linkStatus)
{
    GLchar *infoLog = new GLchar[infoLogLength + 1];
    glGetProgramInfoLog(program, infoLogLength * sizeof(GLchar), NULL, infoLog); 

    ...

    delete[] infoLog;
} 
```

*返回的字符串`glGetProgramInfoLog()`将以空值结尾。*

* * *

您还可以更极端一些，并在调试版本中使用一些调试宏。因此使用`glIs*()`函数来检查预期类型是否也是实际类型。

```
assert(glIsProgram(program) == GL_TRUE);
glUseProgram(program); 
```

* * *

如果调试输出不可用而您只想使用`glGetError()`，那么您当然可以这样做。

```
GLenum err;
while ((err = glGetError()) != GL_NO_ERROR)
    printf("OpenGL Error: %u\n", err); 
```

由于数字错误代码没有那么有用，我们可以通过将数字错误代码映射到消息来使其更具人类可读性。

```
const char* glGetErrorString(GLenum error)
{
    switch (error)
    {
    case GL_NO_ERROR:          return "No Error";
    case GL_INVALID_ENUM:      return "Invalid Enum";
    case GL_INVALID_VALUE:     return "Invalid Value";
    case GL_INVALID_OPERATION: return "Invalid Operation";
    case GL_INVALID_FRAMEBUFFER_OPERATION: return "Invalid Framebuffer Operation";
    case GL_OUT_OF_MEMORY:     return "Out of Memory";
    case GL_STACK_UNDERFLOW:   return "Stack Underflow";
    case GL_STACK_OVERFLOW:    return "Stack Overflow";
    case GL_CONTEXT_LOST:      return "Context Lost";
    default:                   return "Unknown Error";
    }
} 
```

然后像这样检查它：

```
printf("OpenGL Error: [%u] %s\n", err, glGetErrorString(err)); 
```

这仍然不是很有帮助，或者说更直观，就好像你在`glGetError()`这里和那里撒了一些一样。然后定位哪个记录了错误可能很麻烦。

宏再次来拯救。

```
void _glCheckErrors(const char *filename, int line)
{
    GLenum err;
    while ((err = glGetError()) != GL_NO_ERROR)
        printf("OpenGL Error: %s (%d) [%u] %s\n", filename, line, err, glGetErrorString(err));
} 
```

现在简单地定义一个这样的宏：

```
#define glCheckErrors() _glCheckErrors(__FILE__, __LINE__) 
```

瞧，现在您可以调用`glCheckErrors()`所需的所有内容，如果出现错误，它会告诉您检测到的确切文件和行。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-05T21:56:55.927

[GLIntercept](https://github.com/dtrebilco/glintercept/)是您最好的选择。从他们的网页：

*   使用记录单个帧的选项将所有 OpenGL 函数调用保存为文本或 XML 格式。
*   免费相机。环绕发送到显卡的几何图形并启用/禁用线框/背面剔除/查看平截头体渲染
*   保存和跟踪显示列表。在渲染调用前后保存 OpenGL 帧缓冲区（颜色/深度/模板）。还可以保存前后图像的“差异”。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-02-16T23:30:56.793

Apitrace 是 Valve 的一些人提供的一个相对较新的工具，但它非常好用！试一试：[https ://github.com/apitrace/apitrace](https://github.com/apitrace/apitrace)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-12-02T03:02:34.467

我发现你可以`glGetError`在每一行代码之后检查你的嫌疑人是否会出错，但是在这样做之后，代码看起来不是很干净，但它可以工作。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-09T13:12:49.637

对于 Mac 上的用户，OpenGL 调试器中的 buit 也很棒。它使您可以检查缓冲区、状态并帮助发现性能问题。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-09-16T22:26:44.483

gDebugger 是一款出色的免费工具，但不再受支持。然而，AMD 已经开始了它的开发，这个调试器现在被称为[CodeXL](https://github.com/GPUOpen-Tools/CodeXL)。它既可作为独立应用程序使用，也可作为 Visual Studio 插件使用 - 适用于 NVidia 和 AMD GPU 上的原生 C++ 应用程序或使用 OpenGL 绑定的 Java/Python 应用程序。这是一个地狱般的工具。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-09T13:04:33.013

还有免费的 glslDevil： http: [//www.vis.uni-stuttgart.de/glsldevil/](http://www.vis.uni-stuttgart.de/glsldevil/)

它允许您广泛地调试 glsl 着色器。它还显示失败的 OpenGL 调用。

但是，它缺少检查纹理和屏幕外缓冲区的功能。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-09-02T11:09:28.293

如果您有 NVidia 卡，[Nsight是一个很好的调试工具。](http://www.nvidia.com/object/nsight.html)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-11-12T19:58:06.830

**动态更新窗口标题**对我来说很方便。

示例（使用 GLFW，C++11）：

```
glfwSetWindowTitle(window, ("Now Time is " + to_string(glfwGetTime())).c_str()); 
```

# php - php htmlspecialchars() 从一种形式到另一种形式

> ID：518082
> 
> 赞同：0
> 
> 时间：2009-02-05T21:41:01.060
> 
> 标签：php, htmlspecialchars

为什么每次提交表单后 htmlspecialchars() 不能连续编码字符？看看下面的例子：

```
<?php $_POST['txt'] = htmlspecialchars($_POST['txt']); ?>
<form method="post">
<input name="txt" value="<?=$_POST['txt'] ?>" />
<input type="submit" name="save" value="test" />
</form> 
```

您可以在[http://verticalcms.com/htmlspecialchars.php](http://verticalcms.com/htmlspecialchars.php)运行时看到它。

现在执行以下操作

```
1) Type & into the text field
2) Hit the test button once
3) When the page completes post back, hit the test button again
4) When the page completes post back, view the page source code 
```

在输入框中，值为&

我期待& 放大器；

为什么不是& 放大器；？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T21:55:56.253

这只是 HTML 实体编码。在 HTML 属性中使用“&”时，应该对其进行编码。这就是你正在做的事情。

所以，浏览器读取

```
<input value="&amp;" /> 
```

并将其转换为“具有值'&'的文本框小部件”。

其他特殊字符也是如此：

```
<input value="&quot" /> 
```

会产生一个 " 字符。

当您提交表单时，浏览器会发送这些未编码的值，因此您的 PHP 脚本会像“&”一样接收它，而不是“&”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T21:51:35.250

为方便起见，$_POST 中的值已经经过 html 解码。因此，当您的脚本启动时，以下情况为真：

```
$_POST['txt'] == '&';
htmlspecialchars('&') == '&amp;' 
```

[编辑] 看起来这需要进一步解释

当浏览器将上述表单提交给服务器时，使用一个＆符号作为“txt”的值，它会将以下内容放入请求的正文中：

```
txt=&amp; 
```

该值是编码的，因为浏览器会将多个字段与一个 & 字符连接起来，例如

```
txt=&amp;&user=soulmerge&pass=whatever 
```

为了程序员的方便，PHP 获取传输的值并对其进行解码 - 它使 & 成为 & 现在我虽然这首先是问题的原因 - 猜我弄错了。费迪南德正确回答了实际问题。

# php - 如何将 phpunit 与 Hudson CI 集成？

> ID：518083
> 
> 赞同：15
> 
> 时间：2009-02-05T21:41:54.833
> 
> 标签：php, hudson, phpunit

我们正在考虑从 phpundercontrol 切换到 Hudson（它看起来有一些非常酷的功能！）但我不知道如何让 phpunit 日志显示出来。

我的 phpunit 在 Hudson 中使用 ant 运行良好，并且 --log-xml 将 phpunit.xml 放入该构建的相应 builds/ 文件夹中。但是我不知道如何让它显示在构建中，以便我们可以看到运行的测试以及失败的测试（如果有的话）。

在我弄清楚之后，接下来将是获得覆盖率、指标和 api :)

对于在 HTML 上生成它的任何东西来说，它似乎应该是微不足道的，例如告诉哈德森“对于这个项目，为每个构建显示一个到 'API' 的链接并链接到 builds/$BUILDNUM/api/index.html”。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-09-25T21:21:47.240

我安装了 xUnit 插件，将它指向我的日志文件（来自作业配置），它就像一个魅力。似乎不再需要任何自定义黑客。

[http://wiki.hudson-ci.org/display/HUDSON/xUnit+Plugin](http://wiki.hudson-ci.org/display/HUDSON/xUnit+Plugin)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-03-19T09:54:51.673

最后一个答案是从 2009 年开始，[由于 Oracle](http://jenkins-ci.org/content/jenkins) ，现在[很多人从 Hudson 迁移到 Jenkins](http://wiki.jenkins-ci.org/display/JENKINS/Upgrading+from+Hudson+to+Jenkins)，考虑使用**Jenkins Template for PHP ，为您的**[PHPQATools](http://phpqatools.org/)的所有配置需求提供免费且方便的模板，例如 pdepend、phpmd、phpcs和 phpunit 在一个方便的模板中。

 ***   [http://jenkins-php.org/](http://jenkins-php.org/)
*   [http://edorian.posterous.com/setting-up-jenkins-for-php-projects](http://edorian.posterous.com/setting-up-jenkins-for-php-projects)

Freenode 上还有[IRC 频道 #jenkins-php 以](http://webchat.freenode.net/)获取支持。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-20T10:29:26.690

您还可以使用此 xslt 文件将 phpunit xml 转换为 hudson/junit xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="/">
    <xsl:element name="testsuites">
        <xsl:for-each select="//testsuite[@file]">
             <xsl:copy-of select="." />
        </xsl:for-each>
    </xsl:element>
</xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-06T14:55:45.870

我通常使用 CruiseControl 进行 PHP 测试（使用 CC 的[Phing](http://phing.info)支持，而不是 phpundercontrol）。我只与 Hudson 合作过一点点，但已经让 Hudson 使用 phing 的 phpunit 支持成功地记录了 phpunit 测试。

以下说明假设您将使用 Phing（而不是 Ant）来管理您的 PHP 项目构建，并且您已安装必要的先决条件。它还假设您安装了 PHPUnit 3（尽管 PHPUnit 2.x 也应该可以工作）。

*第 1 步：为 Phing/PHPUnit 设置项目*

首先，您需要确保您的项目可以使用 Phing 进行测试。这是一个运行单元测试并创建与 JUnit 兼容的 XML 输出的示例 Phing build.xml。

```
<?xml version="1.0" ?>
<project name="Test Project" default="test">
    <property name="tests.dir" value="." />
    <property name="reports.dir" value="${tests.dir}/reports" />

    <target name="test" description="Run PHPUnit tests">
        <phpunit haltonerror="true" haltonfailure="true" printsummary="true">
            <batchtest>
                <fileset dir="${tests.dir}">
                    <include name="**/*Test.php" />
                </fileset>
            </batchtest>
            <formatter type="plain" usefile="false" />
            <formatter type="xml" usefile="true" todir="${reports.dir}" outfile="test-results.xml" />
        </phpunit>
    </target>
</project> 
```

*第 2 步：设置 Hudson*

1.  为 Hudson 安装 Phing 插件。请注意，您*可能*需要将 Phing 作为独立包安装（我将其放在 /opt/phing-2.3.3 中）并在 Hudson 配置中配置 PHING_HOME 以指向该目录。您还应该能够使用 PEAR 安装的 Phing；但是，我还没有测试过。
2.  配置 Hudson 以使用 Phing 构建您的项目。
3.  配置 Hudson 以从您的项目中收集 JUnit 测试。我们的结果文件的名称是 test-results.xml。在上面的示例中，您将其配置为从报告/*.xml 收集文件。

*第 3 步：构建！*

那应该这样做。立即尝试构建您的项目。希望它会收集结果。

另请参阅此[Phing 演示文稿](http://www.slideshare.net/hozn/phing-building-with-php)，或此[Phing 演示文稿](http://www.slideshare.net/hozn/putting-phing-to-work-for-you)以了解有关 Phing 和（在较小程度上）PHPUnit 集成的更多信息。

祝你好运！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-29T11:57:33.813

PHPUnit 发出的 XML 格式[（当前）与 Hudson 不兼容，](https://hudson.dev.java.net/issues/show_bug.cgi?id=3007)因为它与其他类似工具生成的 XML 不太一样。这就是您收到“没有任何测试报告包含任何结果”消息的原因。

没有修复 PHPUnit 以生成“更好”的 XML 或改进 Hudson 使其在接受的内容方面更灵活，唯一的解决方案是通过消除 <testuite> 元素的嵌套来修复 XML。我[使用 sed 来更改 PHPUnit XML](http://blog.uncommons.org/2009/03/25/using-phpunit-with-hudson/)，以便 Hudson 可以接受：

```
# Tweak the test result XML to make it acceptable to Hudson.
lines=`wc -l test-results/results.xml|awk '{print $1}'`
end=`expr $lines - 1`
sed -i "$end d;3d" test-results/results.xml 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-25T11:19:47.163

上一篇文章中的 XSLT 转换对我不起作用。应用此转换后，报表的 DOM 结构不会改变。我已经对其进行了修改以解决问题。我的变种是：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:template match="/">
      <xsl:element name="testsuites">
         <xsl:for-each select="//testsuite[@file]/testsuite">
            <xsl:copy-of select="." />
         </xsl:for-each>
      </xsl:element>
   </xsl:template>
</xsl:stylesheet> 
```

这个对我有用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-05T19:47:13.500

如果您想要有关将 PHP 与 Hudson 集成的完整教程，可以查看此链接：

[与 Hudson 的 PHP 持续集成](http://blog.jepamedia.org/2009/10/28/continuous-integration-for-php-with-hudson/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-14T20:44:03.517

上面的答案是有效的，但更简单，不改变你的构建过程：

*   配置您的项目
*   勾选公共 JUnit 报告（参见[http://thinkvitamin.com/images/articles/hudson/hudson_setup.png](http://thinkvitamin.com/images/articles/hudson/hudson_setup.png)），并填写“phpunit.xml 在适当的 builds/ 文件夹中”的位置
*   希望在下一个版本中将包含有关您的测试的趋势和更详细的信息，例如这里[https://hudson.dev.java.net/screenshots/5.png](https://hudson.dev.java.net/screenshots/5.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-30T21:30:41.647

我相信 xslt 可能必须根据使用的 phpunit 版本而有所不同。例如，hoschi 发布的样式表对我来说效果很好，使用 phpunit 版本 3.3.17

但完全有可能 phpunit 已升级为在新版本中发出不同的格式，或者 sir-vestnik 可能正在运行旧版本。

# parameters - 何时使用方法重载 VS“请求”对象

> ID：518087
> 
> 赞同：2
> 
> 时间：2009-02-05T21:42:56.343
> 
> 标签：parameters, methods, overloading, method-signature

确定何时使用方法重载以及何时使用单独的“请求”类的最佳“经验法则”是什么？例如：

```
MakePancakes(int size)
MakePancakes(int size, bool addBlueBerries)
MakePancakes(int size, bool addBlueBerries, ...) 
```

相对于：

```
MakePancakes(PancakeOptions options) 
```

最好坚持一种方式或另一种方式，还是在“必要”时使用？关于何时何地应该使用一个而不是另一个？

## 你如何决定使用哪个，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T22:13:59.417

使用 MakePancakes(PancakeOptions options) 的真正优势在于，您可以更改 PacakeOptions 的属性数量，而无需更改方法实现。当参数的数量可以更改或可选时，它会很有帮助。以这种方式表示配置/属性/选项确实有意义。

但我不认为它可以替代重载方法。

一些经验法则：

*   如果一个方法有超过 5 个参数，那么它可能做的事情不止 1 个。我会审查该方法并尝试将其拆分为更具体的功能。

*   方法的所有属性都是必需的（即不能为空）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T22:03:25.943

在创建请求类型或枚举之前，我自己不需要很多重载（枚举数组似乎是一个非常简单的请求对象）。也许3-4？一些框架方法有 9-10 个重载，我觉得这有点烦人，但我认为这更像是一个风格问题。

# vb.net - VB.Net 序列化程序会在公共成员中执行代码吗？

> ID：518091
> 
> 赞同：0
> 
> 时间：2009-02-05T21:44:24.453
> 
> 标签：vb.net, serialization

我们希望使用二进制格式化程序。到目前为止，在调试中，它似乎没有执行公共属性的 getter。XML 序列化程序的行为方式是否相同？此外，在反序列化过程中，反序列化器会使用设置器在反序列化过程中应用值吗？

到目前为止，我们对 BinaryFormatter 的测试表明它只是直接写入和写入成员变量。它不会遍历任何 getter 或 setter。XML Serializer 是不是也一样？

如果一个公共属性做了一些像 Random().Next 这样愚蠢的事情怎么办？这会被二进制格式化程序序列化吗？似乎使用 XML 序列化器，您需要适当地装饰此成员以使其参与。二进制格式化程序似乎只对成员变量起作用。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T21:50:09.497

您需要一个 getter 和一个 setter，否则该属性将不会被序列化。这样做的原因是序列化程序假定它无法设置该值，因此传输它会很浪费。

你甚至可以有一个空的二传手，它会工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T22:13:45.627

我刚刚使用 XML Serializer 进行了快速测试。回答您的问题：是的，它在序列化期间确实使用了 getter，并且在反序列化期间确实使用了 setter。

**编辑**

在文档中找到了这个：

> 此示例使用二进制格式化程序进行序列化。您需要做的就是创建一个流的实例和您打算使用的格式化程序，然后在格式化程序上调用 Serialize 方法。要序列化的流和对象作为此调用的参数提供。尽管在这个例子中没有明确地展示，一个类的所有成员变量都将被序列化——甚至是标记为私有的变量。在这方面，二进制序列化与 XMLSerializer 类不同，后者只对公共字段进行序列化。有关从二进制序列化中排除成员变量的信息，请参阅选择性序列化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T21:53:40.253

这样想：

假设您正在反序列化具有多个序列化属性的类，并且最后一个属性的设置器具有可以改变另一个属性的值的副作用。更改的属性不再反映您的序列化数据。你真的希望它使用那个设置器吗？

另一方面，如果属性没有后备存储怎么办？也许它是一个复合属性，允许您一次获取和设置所有其他属性的值。可以说这个属性不应该被序列化（或者只有这个属性应该被序列化，这取决于事情的工作方式），但可能还有其他例子。格式化程序如何知道在哪里为此类属性分配值？

那么它是哪一个？我不得不查找它并且无法快速找到权威来源，但看起来 XmlSerializer*确实*使用了 getter 和 setter，而 BinaryFormatter 不*使用*getter 或 setter。

这是有道理的。我的第一点表明您并不*想*使用 getter/setter。我的第二点表明您可能*必须*使用它们。二进制格式化程序可以只获取对象的确切内存表示，因此它会跳过 getter/setter。XmlSerializer 没有这个能力，就得用另一种方法。

您可能应该为自己设置一个快速测试项目，以便您可以看到它的实际效果。

# c# - 使用 SMO 查找最近的备份

> ID：518105
> 
> 赞同：1
> 
> 时间：2009-02-05T21:48:58.953
> 
> 标签：c#, .net, sql-server, smo

有谁知道如何使用 SMO 查找数据库的最新备份？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T22:23:36.457

备份时间存储在表 msdb.dbo.backupset 中。这是一个例程，它接受一个打开的 SQL 连接、数据库名称和一个标志，指示您是想要完整备份还是任何备份，并返回上次备份的时间。

请注意，此表有时会被整理，因此如果已整理，它可能会指示没有备份。

```
 //----------------------------------------------------------------------------------------
    // Function: GetLastBackupTime
    //
    // Input
    //    sqlConnection          - An open SQLConnection to the target SQL Server
    //    DatabaseName           - Name of the database which you are interested in
    //    fullDatabaseBackupOnly - Do you want only the time of the last full backup
    //
    // Output
    //    DateTime               - DateTime.MinValue indicates no backup exists
    //                             otherwise it returns the last backup time
    //---------------------------------------------------------------------------------------

DateTime GetLastBackupTime( SqlConnection sqlConnection, 
                            string        databaseName, 
                            bool          fullDatabaseBackupOnly )
{
    DateTime lastBackupTime = DateTime.MinValue;  

    string sqlTemplate = "SELECT TOP 1 backup_finish_date " +
                         "FROM msdb.dbo.backupset " + 
                         "WHERE database_name='{0}' {1} "
                         "ORDER BY backup_finish_date DESC";

    string sql = String.Format( sqlTemplate,
                                databaseName,
                                (fullDatabaseBackupOnly ) ? " AND type='D' " : "" );

    // open connection
    using (SqlCommand cmd = new SqlCommand(sql, sqlConnection, 
    {
       object retValue = _Command.ExecuteScalar();

       if ( retValue != null ) lastBackupTime = (DateTime)retValue;
    } 

    return lastBackupTime;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-02T16:52:01.357

这是不可能的。

# c# - 如何判断文件是否已完成 FTP 传输？

> ID：518109
> 
> 赞同：4
> 
> 时间：2009-02-05T21:49:25.487
> 
> 标签：c#, file-io, ftp

我们有一个 C# Windows 服务轮询一个等待 FTP 文件发布的文件夹。为了避免在文件仍在写入时使用该文件，我们首先尝试锁定该文件，但是，似乎有在创建 FTP 文件之后但在写入文件之前，我们会锁定文件，因此我们最终打开了一个空文件。

是否有可靠的方法来判断 FTP 是否完整？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-05T21:56:19.593

您可以在上传之前更改文件名，然后在完成后重命名。这样它看起来就像它在完成之前不存在。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-05T21:59:09.757

我见过的一种做法是传输两个文件，一个是实际文件，另一个是我们可以称为 .done 文件的第二个文件。理想情况是，一旦您看到 .done 文件，您就知道应该完成第一个文件。

其他选项包括观察文件是否有修改，并等待一定时间没有修改。当然，这并不是完全的证明。

# 编辑

Kyle 提出了一个很好的观点，即向 .done 文件添加校验和和/或指示第一个文件的大小可以很好地防止边缘情况。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-05T21:54:11.343

我一直是 .filepart 协议的忠实拥护者，因此无论您使用哪种传输协议（ftp、ssh、rsync 等），您都有相同的理解。

这不是您问题的直接答案，但是从长远来看，更通用的解决方案可能对您更好，而不是搜索仅 ftp 的解决方案。

（.filepart：将文件test.txt重命名为test.txt.filepart，完成后，将其重命名为test.txt）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-05T22:01:23.483

使用文件夹观察器来索引内容怎么样？如果文件大小在 5 分钟内没有改变，你几乎可以保证上传已经完成。

超时可能与您的 FTP 服务器的超时有关。

[http://www.codeproject.com/KB/files/MonitorFolderActivity.aspx](http://www.codeproject.com/KB/files/MonitorFolderActivity.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-05T22:02:36.333

我一直使用校验和文件。因此，您发送一个表示文件大小和校验和的校验和文件。当第一个文件中的校验和与文件系统上的实际校验和匹配时，您将知道文件已正确上传。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-05T22:04:41.730

我过去使用的方法是这里其他一些回复的混合。即使用与预期不同的扩展名（例如FILENAME.part）来FTP 文件，然后将其重命名为适当的扩展名作为上传的最后一步。

在服务器上，使用 FileSystemWatcher 查找具有正确扩展名的新文件。FSW 在重命名之前不会看到该文件，并且重命名操作是原子的，因此文件将在重命名时完整且可用。

当然，重命名或移动文件取决于您对上传过程的控制权。

如果您无法控制文件的上传方式，您将无法使用 FSW 知道文件正在上传，然后监控它的大小 - 当它长时间没有变化时，您可以*假设*它是完整的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-05T21:58:40.930

您可能希望查看 System.IO.FileSystemWatcher，而不是轮询。

# windows-mobile - Windows Mobile - 在 CF.NET 中按大小创建与设备无关的位图

> ID：518119
> 
> 赞同：0
> 
> 时间：2009-02-05T21:52:00.460
> 
> 标签：windows-mobile, compact-framework

我一直在与我的渲染（[在 CF.NET 中创建大位图时的 OutOfMemoryException](https://stackoverflow.com/questions/297697/outofmemoryexception-when-creating-a-large-bitmap-in-cf-net)）作斗争，但我仍在寻找解决问题的好方法。

我的引擎创建了一个大位图（比屏幕大小大 2 倍或 3 倍），并将所有内容绘制到该表面。然后我将该图像以偏移量绘制到屏幕上，允许用户非常流畅地滚动。

这在大多数情况下都很好用，但有些用户在创建大位图时会遇到 OutOfMemoryExecptions。我已经完成了我的作业，这似乎是因为我正在创建一个设备相关位图 (DDB)，并且在 Windows Mobile 上，所有 DDB 都被分配给 gwes.exe 进程，以及所有其他应用程序位图。如果那个 gwes.exe 进程占用超过 32M，你就会得到这个异常。

我确实看到设备独立位图（DIB）实际上是在您自己的进程空间中创建的，而不是分配给 gwes.exe。由于在我的过程中达到 32M 之前我还有更多空间，我想我会探索这种可能性。

但我能找到创建 DIB 的唯一方法是从流中创建位图，就像现有文件一样。我想不出任何从头开始创建一个并指定我希望它是 1280x240 和 256 色的方法。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T02:49:33.713

不久前，当我创建从 Pocket PC 打印到蓝牙打印机的自定义报告时，我不得不做类似的事情。我必须生成一张纸大小的位图，然后将其流式传输到打印机，并且所有使用托管对象执行此操作的尝试都会遇到您所看到的内存问题。

我做了什么（对不起，我不能给你这个的直接来源）：

*   定义并创建一个[BITMAPINFOHEADER](http://www.pinvoke.net/default.aspx/Structures/BITMAPINFOHEADER.html)结构
*   在该 BIH 上调用[CreateCompatibleDC](http://CreateCompatibleDC)
*   调用[CreateDIBSection](http://msdn.microsoft.com/en-us/library/aa926298.aspx)
*   调用[SelectObject](http://msdn.microsoft.com/en-us/library/aa932923.aspx)

您现在有一个 HDC，您可以从中调用[Graphics.FromHdc](http://msdn.microsoft.com/en-us/library/20tc8e3b(VS.80).aspx)。

这样您就可以在自己的进程中拥有所有这些（事实上，如果您将其做得足够大，它将来自共享内存并完全避免 32MB 的进程空间）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T22:02:42.747

[这篇文章](http://blog.opennetcf.com/2006/08/22/bitmaps-in-the-compact-framework/)可能会从 Chris Tacke 那里得到很多帮助，尤其是这一部分：

1.  使用流构造函数创建位图将构造一个 DIB（设备独立位图）。
2.  使用宽度/高度构造函数创建位图将构造一个 DDB（设备相关位图）。
3.  DIB 是在应用程序的虚拟地址空间之外分配的。
4.  DDB 由驱动程序分配。这通常意味着它们被分配在 gwes.exe 的虚拟地址空间中。或者，驱动程序可以将这些分配到专用的视频内存中。
5.  使用流构造函数创建位图会产生大量垃圾，因为它将数据从一个缓冲区复制到另一个缓冲区。

**编辑**：[nerdkill 应用程序](http://www.alfray.com/projects/Nerdkill/codeproject_article.html)甚至可能提供更多帮助 :)

# php - 列出活跃的论坛主题

> ID：518122
> 
> 赞同：1
> 
> 时间：2009-02-05T21:53:35.917
> 
> 标签：php, sql

```
$sql = mysql_query("SELECT * FROM posts WHERE post_content = 'thread' ORDER BY post_date DESC LIMIT 65");
 而($row = mysql_fetch_array($sql)){
 回声“
```

*   $row['post_contentID']"; }

我想列出最近发布过帖子的论坛主题。“问题”是它不止一次列出了同一个主题。如果我在一个线程中发布了 5 次，它将显示所有 5 次，我只想让它显示 1 次...当您的英语不是那么宽时，这很难解释...

就像他们在这个网站上一样[https://stackoverflow.com/?sort=active](https://stackoverflow.com/?sort=active)你知道我是否会回答底部的问题，它会显示在顶部，它会显示已在线程中发布的所有帖子。

谢谢彼得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T21:59:56.760

尝试更改为：

```
SELECT * FROM posts
WHERE post_content = 'thread'
GROUP BY post_contentID
ORDER BY MAX(post_date) DESC
LIMIT 65 
```

请注意，我假设“post_contentID”是线程 ID，如果不是，则需要在 GROUP BY 子句中使用线程 ID。

# file - 文件管理：由业务层的数据访问层处理？

> ID：518127
> 
> 赞同：0
> 
> 时间：2009-02-05T21:54:16.133
> 
> 标签：file, data-access-layer, bll

所以，我正在开发这个基于存储库模型的基于 Web 的应用程序，一个想要的 DDD 傻瓜，使用 StructureMap....等等等等。

该应用程序的一方面允许用户上传和管理文件。

应该在哪里、哪一层负责管理这些用户文件的保存/删除？

业务层，还是数据访问层……？

无论出于何种原因，它似乎都不是一个直截了当的答案......

从历史上看，我只是在 GUI 中打了它一巴掌，但努力使程序更正确，并重新思考应该处理这些服务的内容。也许我只是回答了我自己的问题......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-08-04T13:15:31.670

我创建了一个单独的层“存储访问层 (SAL)”....从 DAL 获取文件信息我将其传递给 SAL，SAL 将正确的文件返回给我....所以如果有一天我从网络托管切换到亚马逊网络服务存储 , 我 将 只 改变 SAL 中 的 类 , 插入 DLL 并 准备 去 .... 因为 用户 将 以 与 以前 相同 的 方式 上传 文件 , 所以 UI 不会 改变 ... ... 业务 规则 与 执行 相同之前所以 BLL 没有改变....数据库没有改变，文件信息和以前一样保存，所以 DAL 没有改变......唯一改变的是访问文件的协议......所以只是更改 SAL

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T21:58:46.093

我把我的放在 DAL 中，因为我们考虑了要更新或查询的文件数据，只是通过一个不同的“协议”，即 System.IO。

更具体地说，我创建了一个 FileManager 类来处理所有基础知识，甚至还有几个常量，因此很容易更改开发和生产环境的路径位置，因为它们完全不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T22:02:36.630

Dillie-O - 此外，如果应用程序曾经切换到将文件从 IO 存储到 DB，则 DAL 是一个更合乎逻辑的地方。一些灵活性...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T21:56:53.727

我会把它放在业务层，但如果是我，我最终会就每个用户上传的文件调用 DAL。我会在数据库中跟踪用户上传的每个文件的文件名和位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-08T02:16:38.273

它在 DAL 句号中。

业务逻辑不应该对您的环境有 IO 依赖。

你把它放在业务逻辑中，下次你想使用那个“逻辑”但最终进入一个没有文件 IO 权限的环境时，你会被干杯。

# javascript - 存储将传递给 jQuery 插件的 JSON 数据的最佳实践

> ID：518129
> 
> 赞同：2
> 
> 时间：2009-02-05T21:54:50.033
> 
> 标签：javascript, jquery, json, naming-conventions

如果它只是一个字符串数组，我正在寻找关于 JSON 应该存储在哪里的“最佳实践”。它是否应该存储在 HTML 页面的脚本块中的变量中？是否应该将其存储在 HTML 之外的 JavaScript 文件中以进行分离？还是应该将其存储在插件本身中？

如果它应该是一个外部 js 文件，那么文件的“最佳实践”命名方案是什么？我知道接受的 jQuery 插件名称是 jquery.plugin.js 或 jquery.plugin-min.js （用于缩小文件）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T21:59:38.853

取决于，如果您立即需要 JSON，您可以将其存储在任何地方以执行它：

```
<script> var myJsonObj = { ... }; </script> 
```

如果它有很多数据并且您不需要立即使用数据，您可以随时对名为“data.json”之类的文件进行 ajax 调用。

对于命名插件名称，这真的取决于你，但是我相信 jquery.pluginname.js 是这样做的标准方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T22:59:22.430

我将让 sktrdie 为这样的文件添加扩展名 .json。我在第一次使用 JSON 时遇到的一个问题是 JSON 字符串不是有效的 JavaScript 文件。

例如，如果我调用具有此内容的文件：

```
{
    'foos': 'whatever',
    'bar': false,
    'items': [1,2,3]
} 
```

作为 <script> 标记的 src，我收到此错误：

```
Error: invalid label
Line: 2, Column: 1
Source Code:
 'foos': 'whatever', 
```

在过去，我实际上在 <divs> 或像这样的 span 中隐藏了 JSON 字符串：

```
<div id="jsonStorage" style="display:none">
{'foos': 'whatever','bar': false,'items': [1,2,3]}
</div> 
```

我还为此使用了隐藏的表单字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T07:10:40.117

如果它是插件的一部分，即默认配置，我会将其存储在插件文件本身中。如果它是插件的外部配置，那么它取决于。将它存储在 HTML 中的变量中可能是有意义的，即

```
<script>
var myConfig = {
  "foo" : "bar"
};
</script> 
```

如果您需要由后端代码生成任何 JSON，则尤其如此。

真的，答案是“视情况而定”——你能提供更多细节吗？

# java - 使用 StdCallFunctionMapper 在 JNA 中重命名 DLL 函数

> ID：518131
> 
> 赞同：6
> 
> 时间：2009-02-05T21:55:17.380
> 
> 标签：java, dll, jna

我正在尝试在 Windows 中将 JNA 与 DLL 一起使用，到目前为止，我能够成功调用一个名为`c_aa_find_devices()`. 但是所有功能都以 . 开头，`c_aa`我想将其重命名为`find_devices()`.

从我收集的方法来看，[`StdCallFunctionMapper`](https://jna.dev.java.net/javadoc/com/sun/jna/win32/StdCallFunctionMapper.html)但我找不到如何在示例中使用它的文档（即如何按名称或序号将 DLL 函数映射到包装的 Java 库接口中的所需名称）。关于文档在哪里的任何建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-02-24T20:19:01.177

A complete working example, using a function mapper.

```
import com.sun.jna.Library;
import com.sun.jna.Native;
import com.sun.jna.NativeLibrary;
import com.sun.jna.win32.StdCallFunctionMapper;

import java.io.File;
import java.lang.reflect.Method;
import java.util.HashMap;
import java.util.Map;

public class JnaTest {

    static {
    Map options = new HashMap();
        options.
                put(
                        Library.OPTION_FUNCTION_MAPPER,
                        new StdCallFunctionMapper() {
                            HashMap<String, String> map = new HashMap() {
                                {
                                    put("testMethod", "testMethod@0");
                                }
                            };
                            @Override
                            public String getFunctionName(NativeLibrary library, Method method) {
                                String methodName = method.getName();
                                return map.get(methodName);

                            }
                        }
                );

        File LIB_FILE = new File("test.dll");
        Native.register(NativeLibrary.getInstance(LIB_FILE.getAbsolutePath(), options));

    }

    private static native int testMethod();

    public static void main(String[] args) {
        testMethod(); // call the native method in the loaded dll with the function name testMethod@0
    }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T21:40:41.857

使用 StdCallMapper 不会有好处 - 它应该映射那些嵌入了作为名称一部分嵌入的参数的总字节长度的 werid windows std lib 名称。由于它仅对 std lib 完成（只是猜测，但 99% 你的函数并非如此）。

如果您的 dll 在所有功能上使用一些通用前缀，您只需要使用以下内容：

```
class Mapper implements FunctionMapper{
    public String getFunctionName(NativeLibrary library, Method method) {
       return GenieConnector.FUNCTION_PREFIX + method.getName();
    }
} 
```

`GenieConnector.FUNCTION_PREFIX`那个通用前缀在哪里。请记住，我实施`FunctionMapper`，而不是扩展`StdCallMapper`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T23:27:15.727

从文档中，您需要在对转换名称的 loadLibrary 的原始调用中提供 FunctionMapper。但是，您还需要保留标准调用映射，因此请尝试以下操作：

```
Map options = new HashMap();

options.
    put(
        Library.OPTION_FUNCTION_MAPPER, 
        new StdCallFunctionWrapper() {
            public String getFunctionName(NativeLibrary library, Method method) {
                if (method.getName().equals("findDevices") 
                    method.setName("c_aa_find_devices");
                // do any others
                return super.getFunctionName(library, method);
            }
        }
    );

Native.loadLibrary(..., ..., options); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T15:35:40.097

所有 JNA 文档都位于[主网页](https://github.com/twall/jna)、[JavaDoc 概述](http://java-native-access.github.io/jna/4.2.1/overview-summary.html)和[JavaDocs](http://java-native-access.github.io/jna/4.2.1)本身。

上面的示例是正确的想法，因为您需要调整通用 StdCallFunctionMapper 返回的函数名称（假设您使用的是 stdcall 调用约定）。但是， Method.setName() 不存在，如果存在，您也不想调用它。您需要获取 String 结果并将其中的 Java 函数名称替换为目标本机名称，例如

```
name = super.getFunctionName();
name = name.replace("find_devices", "c_aa_find_devices"); 
```

更一般地说，您可以简单地将“c_aa_”前缀添加到返回的名称（或任何前导下划线之后），因为 stdcall 装饰位于名称的末尾。

# asp.net - 试图自我包含使用 AjaxToolkit ModalPopUpExtender 的弹出窗口

> ID：518138
> 
> 赞同：0
> 
> 时间：2009-02-05T21:57:09.013
> 
> 标签：asp.net, asp.net-ajax, modalpopupextender

我有 3 种不同类型的 ajax 弹出窗口需要存在于我的站点中。我希望我可以简单地为每个控件创建一个用户控件，并将面板和模式弹出扩展器放置在每个控件中，但这似乎不起作用。以前有没有人尝试过这个，或者你有没有关于如何避免不同页面上每个弹出窗口的重复代码的建议？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-05T22:05:13.677

一种选择是将弹出窗口写入 asp.net 用户控件（.ascx 页面）并将其包含在您需要弹出窗口的页面上。在 ascx 页面中有一个公共方法将显示弹出窗口，并在需要时从父页面调用它。如果您在父页面上已经有一个脚本管理器，那么您不能在 ascx 页面中有第二个，但除此之外，不应该有任何东西可以阻止它工作。希望这可以帮助！

编辑：这是我的模态弹出扩展器控件的样子......

```
<cc1:ModalPopupExtender 
    ID="mpeClassroom" 
    BackgroundCssCLass="modalBackground"      
    runat="server"        
    CancelControlID="lbClose"
    OnOkScript="onOk()"
    TargetControlID="Button1" 
    PopupControlID="pnlClassroom">
</cc1:ModalPopupExtender> 
```

在我的页面后面的代码中，我的方法只是调用 mpeClassroom.Show();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T22:17:39.237

啊，我发现了我相信的用户控件的问题。

ModalPopUpExtender 需要设置 TargetID 属性，否则会发生错误。由于它位于 UserControl 中，因此我刚刚创建了一个不执行任何操作的虚拟链接按钮，并将可见属性设置为 false。

```
 <asp:LinkButton ID="lnkBlank" runat="server" Visible="false" />
    <asp:Panel ID="plContainer" style="display: none;" runat="server">
            Hello?
    </asp:Panel>
    <cc1:ModalPopupExtender ID="mpe" runat="server" 
            BehaviorID="test"
            TargetControlID="lnkBlank" 
            PopupControlID="plContainer" /> 
```

显然它不明白这一点，当我将 visible 属性设置为 true 时，它​​就开始工作了。不确定 TargetID 的原因是什么，因为我认为大多数弹出窗口都可以从页面的多个链接中调用。也许我仍然不完全清楚应该如何使用这个控件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-13T09:20:41.673

隐藏链接作为 TrgetControlID 的问题是；当您将其可见性设置为 false 时，服务器也不会呈现它。然后 PopExtender 在页面上找不到控件。

不要将其可见性设置为 false，而是尝试应用带有 display:none 的样式。这应该工作！

# python - 如何在 django 中处理未保存的多对多关系？

> ID：518162
> 
> 赞同：8
> 
> 时间：2009-02-05T22:01:17.837
> 
> 标签：python, django, django-models, many-to-many

我在 django 中有几个模型，它们是多对多连接的。我想*在内存*中创建这些模型的实例，将它们呈现给用户（通过视图模板中的自定义方法调用），如果用户满意，将它们保存到数据库中。

但是，如果我尝试对模型实例执行任何操作（例如调用渲染方法），我会收到一条错误消息，提示我必须先保存实例。文档说这是因为模型处于多对多关系。

如何向用户呈现对象并允许他/她保存或丢弃它们而不会使我的数据库混乱？

（我想我可以关闭事务处理并在整个项目中自己做，但这听起来像是一个潜在的容易出错的措施......）

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T22:34:11.263

我会添加一个字段来指示对象是“草稿”还是“活动”。这样它们就可以在请求、会话等中持续存在，并且 django 停止抱怨。

然后，您可以过滤对象以仅在公共视图中显示“活动”对象，并且仅向创建它们的用户显示“草稿”对象。这也可以扩展为允许“归档”对象（或任何其他有意义的状态）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T07:52:11.263

我认为使用 django 表单可能是答案，如[本](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/)文档中所述（搜索 m2m ...）。

编辑为可能有同样问题的其他人添加一些解释：

假设您有这样的模型：

```
from django.db import models
from django.forms import ModelForm

class Foo(models.Model):
    name = models.CharField(max_length = 30)

class Bar(models.Model):
      foos = models.ManyToManyField(Foo)

  def __unicode__(self):
      return " ".join([x.name for x in foos]) 
```

那么你不能在未保存的 Bar 对象上调用 unicode() 。如果您确实想在保存之前打印出来，您必须这样做：

```
class BarForm(ModelForm):
    class Meta:
        model = Bar

def example():      
    f1 = Foo(name = 'sue')
    f1.save()
    f2 = foo(name = 'wendy')
    f2.save()
    bf = BarForm({'foos' : [f1.id, f2.id]})
    b = bf.save(commit = false)
    # unfortunately, unicode(b) doesn't work before it is saved properly,
    # so we need to do it this way: 
    if(not bf.is_valid()):
        print bf.errors
    else:
        for (key, value) in bf.cleaned_data.items():
            print key + " => " + str(value) 
```

因此，在这种情况下，您必须保存 Foo 对象（您可以在保存这些对象之前使用它们自己的表单对其进行验证），并且在保存具有多对多键的模型之前，您也可以验证它们。所有这些都不需要过早地保存数据并弄乱数据库或处理事务......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-23T14:33:41.637

答案很晚，但是 wagtail 的团队制作了一个单独的 Django 扩展，名为[django-modelcluster](https://github.com/wagtail/django-modelcluster)。这就是他们 CMS 的草稿预览的动力。

它允许你做这样的事情（来自他们的自述文件）：

```
from modelcluster.models import ClusterableModel
from modelcluster.fields import ParentalKey

class Band(ClusterableModel):
    name = models.CharField(max_length=255)

class BandMember(models.Model):
    band = ParentalKey('Band', related_name='members')
    name = models.CharField(max_length=255) 
```

然后可以像这样使用模型：

```
beatles = Band(name='The Beatles')
beatles.members = [
    BandMember(name='John Lennon'),
    BandMember(name='Paul McCartney'),
] 
```

这里，`ParentalKey`是 Django 的替代品`ForeignKey`。同样，他们必须`ParentalManyToManyField`替换 Django 的`ManyToManyField`.

# html - 每页都有页眉的打印友好页面？

> ID：518163
> 
> 赞同：1
> 
> 时间：2009-02-05T22:01:18.053
> 
> 标签：html, css, jakarta-ee, printing

我正在使用显示大量表格数据的 Web 应用程序在 J2EE 环境中工作。我们希望能够打印这些表格，每个页面都显示页眉和页脚。我了解一些浏览器通过 thead,tbody,tfooter 标签支持此功能，但用户仅使用 IE6。一行通常只有一行，但有时可以是两行或三行（也许更多）。

我在这里有什么选择？有没有我不知道的快速简便的方法？我需要一些如何“计算”一组行的高度吗？还是我坚持做一些静态的事情，希望“大部分时间”都能工作？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T22:15:22.143

`THEAD`您在和标签中做对了`TBODY`，但也尝试添加以下 CSS 定义：

```
thead {
    display: table-header-group;
}
tbody {
    display: table-row-group;
} 
```

# html - 静态页面的实用动态创建...（我不是因为我想问这个，而是因为我必须...）

> ID：518168
> 
> 赞同：0
> 
> 时间：2009-02-05T22:01:58.927
> 
> 标签：html, templates, static-pages

有谁知道 ****ahem**** 将静态页面串在一起的实用程序。

**例如：**
假设我写了一个页面的页眉和页脚，我只想更改内容而没有 ****sigh**** 动态生成页面的内容。（IE页面是动态生成的，但最终结果只是一个静态页面被转储到FTP目录中。）

> **如果没有像Tiles**或**服务器端包含**在网络服务器上的东西，我通常不赞成做这种事情 ，但不幸的是我的雇主 __does...__ 他们使用静态页面，我无法改变他们的想法。（C++ 程序员）

我发现与我在这里描述的最接近的是一个名为[cook](http://www.jonrobson.me.uk/?workspace=#tag:[[tiddlywiki%20tools]])的实用程序，它用于*构建* [tiddlywiki](http://www.tiddlywiki.com)。

**对，所以一个可以获取以下目录的实用程序：**

*   静态页面部分
    *   页眉.htm
    *   页脚.htm
*   改变的部分
    *   关于.htm
    *   信息.htm
    *   产品.htm
    *   等.htm

**并将其更改为：**

*   网站建设
    *   about.htm（带有页眉和页脚以及 /Parts that Change/about.htm 的内容）介于两者之间
    *   info.htm（同样的...）
    *   products.htm （同样的...）
    *   etc.htm（同样的...）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T22:16:21.813

听起来像是韦比的[工作](http://webby.rubyforge.org/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T22:07:44.250

听起来你想要的最终结果是需要 N 个文件并将内容拼接到一个静态 HTML 页面中，该页面被上传到我假设的网络服务器。那个听起来是对的吗？

我认为 Dreamweaver 具有该功能，但如果您想要更底层的东西，请使用以下算法：

```
load config file that you use for build parameters
open stream to output file
for each file in source folder 
    load to stream
    write to output stream
close output stream
post file to remote site 
```

编辑页面后，只需让您的客户端运行此处理器即可。请让我知道我是否完全误解了您要完成的工作。

编辑：您也可以尝试在“动态”页面（%HEADER%、%FOOTER% 等）中放置某种令牌，并且当您的处理器遇到该令牌时，将其替换为实际的静态内容。

# c# - 如何优雅地测试 C# 中的溢出情况？

> ID：518178
> 
> 赞同：4
> 
> 时间：2009-02-05T22:04:25.287
> 
> 标签：c#, exception, math, exception-handling

更新：我将保持原样：异常的性能影响（非常罕见）优于检查每个操作的可能性能影响（常见）

* * *

我正在尝试支持“EstimatedRowCount”，在一种情况下，它是两个连接在一起的子游标的产物：

```
estimatedRowCount = left.EstimatedRowCount * right.EstimatedRowCount;
return estimatedRowCount; 
```

当然，如果left和right足够大，这会抛出OverflowException。

在这里，我并不关心estimatedRowCount 是否100% 准确，只要大到足以知道该游标包含大量数据即可。

现在，我正在这样做：

```
// We multiply our rowcount
Int64 estimRowCount = 0;
try
{
    estimRowCount = leftRowCount * rightRowCount;
}
catch (OverflowException)
{
    // Ignore overflow exceptions
    estimRowCount = Int64.MaxValue;
}

return estimRowCount; 
```

有没有更好的方法来测试溢出操作，所以我不必做 try{}catch 来保护？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T22:14:53.783

```
 if (Int64.MaxValue / leftRowCount <= rightRowCount)
{
    estimRowCount = leftRowCount * rightRowCount
}
else
{
    estimRowCount = Int64.MaxValue;
} 
```

 `不知道我是否可以在没有编辑的情况下解释自己。但是，我希望你明白这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T22:24:13.950

这听起来像是['unchecked' 关键字](http://msdn.microsoft.com/en-us/library/a569z7k8.aspx)的一个很好的用例。

要使用，只需将您的作业包装在“未检查”块中：

```
Int64 estimRowCount = 0;
unchecked
{
    estimRowCount = leftRowCount * rightRowCount;
} 
```

然后测试结果是否为负——如果是，则溢出：

```
if (estimRowCount > 0) estimRowCount = Int64.MaxValue; 
```

在这种情况下，您需要确保 leftRowCount 和 rightRowCount 都不能为负数，但考虑到上下文，我认为不会发生这种情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-05T22:13:04.393

您的解决方案似乎很合理。有什么特定的东西要优化吗？该产品是否会如此频繁地导致溢出情况，以至于您担心异常处理会影响性能？

（只是简单的思考，如果 leftRowCount 和 rightRowCount 是 Int32，而不是 Int64，那么您的产品不会溢出您的 Int64 estimRowCount 左值。）

# qa - 什么时候有质量保证部门？

> ID：518180
> 
> 赞同：10
> 
> 时间：2009-02-05T22:04:43.663
> 
> 标签：qa

质量保证 (QA) 部门大约是一群测试人员整天揭穿你的应用程序，为发布开绿灯，处理 Alpha / Beta 程序。以及更多。

但是，如果软件公司没有 QA 部门，现场就会经常出现问题，而且解决问题的成本会更高。然而，大多数公司都是从车库开始的，只有一名员工是你自己，然后发展成为一家软件公司。

你什么时候说要创建这样的部门？与公司的规模、遇到的问题有关吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-05T22:05:58.387

只要你能负担得起。如果没有质量保证部门，您将永远不会拥有比有质量保证部门更可靠的产品。程序员不会成为优秀的 QA 人员，最好有第二个人（或更多人）来审查应用程序的工作方式。

所有优秀的软件公司，以及拥有优秀 IT 部门并创建程序的组织都有质量保证团队。这对软件开发至关重要。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-05T23:13:25.427

作为一家成功的软件公司的前 QA 经理，我会说在你发布你的第一个程序后立即发展它。（之前，如果可能的话）。真的，只要你能负担得起。但是，作为开发人员，您应该在整个开发周期中自己进行大量测试，而不仅仅是在最后。QA 的工作（取决于您阅读的书）是处理大量遗留测试、SMOKE 测试、回归测试、真实世界测试，以及编写自动化测试程序、流程和计划等。

临时测试只是 QA 应该做的一小部分。QA 有两个主要关注领域。1) 软件是否做它应该做的事情，并以客户可用的方式满足要求，以及 2) 软件是否没有做它不应该做的事情。

计划的、程序的和临时的测试是质量保证的基础。我发现如果您只进行一种或另一种类型的测试，您将不会有一个成功的 QA 周期。

我在自己工作时发布了没有 QA 的软件，但我可以告诉你，无论我对其进行多少测试，它*总是更容易出错。*对于软件来说，第二双眼睛是最好的选择。

只要确保你的团队是由 ADD 保持肛门的计算机极客组成的。这样你会得到最好的结果。:) 当他们可以使某人的软件蓬勃发展时感到自豪的人......呵呵......（开玩笑......我认识很多没有 ADD 的 QA 测试人员）......

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-10-08T23:45:50.340

> 质量保证 (QA) 部门大约是一群测试人员整天揭穿你的应用程序

我很困扰您将 QA 视为“一群揭穿您的应用程序的测试人员”，就像 QA 是最终产品的障碍一样。这让我觉得你过去在 QA 方面的经历很糟糕。相反，请尝试查看 QA 为您的公司带来的价值。您希望最终用户能够从一开始就依赖您的产品。如果最终用户发现问题或缺陷，并对您的应用程序或网站感到沮丧，他们就会越来越不信任您的应用程序。QA 应该降低用户对您的应用失去信任的风险。如果 QA 不这样做，那么他们就不会带来任何应用程序必须具备的价值。那时，您需要新的 QA。不仅仅是按钮按钮。与开发人员一样了解应用程序的 QA。

最后一点是开发人员不是 QA。开发人员只应在绝对需要时戴上 QA 帽子。这对于只有 1 或 2 名开发人员的小公司来说是很困难的。所以我同意其他人的观点，他们说尽快进行 QA。在我为一家大型软件开发公司工作的现场，开发人员只有在我们有严格的最后期限需要满足并且 QA 时间非常宝贵时才戴上 QA 帽子。即使他们确实戴上了 QA 帽子，测试过程也会由该开发团队的一位主要 QA 审查，以确保开发人员正在全面有效地测试应用程序。只有在 QA 负责人对已进入开发人员测试的部分的测试级别感到满意之前，QA 负责人才会在该部分签字。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-05T23:28:37.783

扮演魔鬼的拥护者：“QA 部门”是一条红鲱鱼，在许多情况下是一种逃避。

让我们先处理红鲱鱼。“部门”是组织结构的表述，谁向谁汇报；那是次要的。“QA”是一个总称，没有特别的含义。（不相信我？这是一个测试——你不想*“*保证质量”吗？当然不是。每个人都想要那个。）

那么你真正想要的是什么？您想在用户之前了解软件的故障模式。

如果您的软件在该领域存在“问题”，那么，这意味着找出故障模式的工作还没有完成，您*可能*想聘请有能力的人来做这件事。

我碰巧相信开发人员的职位描述至少应该包括其中的一部分。如果我聘请测试人员，我希望他们必须努力寻找失败模式。如果应用程序在测试人员把手放在它的几秒钟内崩溃，开发人员将直接听到它。我想到了“严重缺陷”这个词。

到了警察局。事实是，您不能在事后将质量放入产品中。但是“我们应该雇佣一些测试人员”是许多开发人员的呐喊，他们被抓到当场交出远低于可接受质量水平的代码。（我知道——我就是其中之一。）

因此，如果您确实雇用了具有测试经验的人，恕我直言，正确的做法是让他们与开发人员一起工作。向同一位经理报告。有着同样的使命：首先让它正确。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-05T22:09:55.603

我们是一家只有一个开发人员的小型初创公司。每当我们谈论添加额外资源时，我的第一反应是聘请我一个 QA 人员！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-05T22:10:37.347

我猜你会有机地发展一个 QA 部门：即使你是一个单独的程序员，你也应该做*一些*QA 人所做的工作。

例如，如果一个人将 10% 的时间花在 QA 活动上，那么一旦你有 10 个人，你就可以让一个人专门从事 QA。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-05T22:36:52.303

这取决于。如果你是一家小公司，团队效率不高，而且你的错误率很低，这可能不是你需要解决的最大问题。

如果市场迫使您加快生产速度，开发人员的数量正在增长，并且错误率开始损害您的客户关系，那么您可以考虑通过使其更加正式来修复流程。

在小公司生存的诀窍是只实施流程，当它的价值为自己买单时。如果您雇用人员以提高质量，则必须为自己付出很大的代价，这意味着在此之前，质量必须非常差（并且会损害业务）。

通常，更好的支持流程更为重要，因为即使是最好的 QA 团队也会偶尔让错误出现。如果您处理好修复程序/补丁程序，客户将会对您印象深刻（他们不会注意到错误的显着减少，除非以前的版本都非常糟糕）。

保罗。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-05T22:10:53.243

好吧 - 您需要编写代码测试的程序员以外的其他人。这并不意味着您需要 QA 部门。在许多商店中，业务分析师也会进行更经济的测试，因为您只能在构建的后期进行测试，而不是在需求分析和设计期间进行测试。在一家很小的商店里，你可能甚至不会使用业务分析师这个词，但你知道我的意思——不编码的产品或设计人员。即使在非常大的公司中，这种模式也有其优势。测试小组可以拥有自己的生活。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-13T09:34:41.220

一旦代码库变得如此之大，以至于一个人无法了解所有细节。

这背后的原因是，90% 的回归是因为程序员没有意识到*整个情况*以及他们的代码对系统其余部分的可能副作用。在这种情况下，您甚至不知道您*永远不应该提供 -1 作为年龄参数*或类似的东西。在大多数情况下，界面应该是清晰的并且有错误检查，但在大型代码库中它会滑倒，当你急于赶上最后期限或长时间工作时，注意力会下降。

因此，尽管即使您是*单人秀*，您也应该进行基本测试，但只要代码增长到足以让您（或可能与您合作的任何其他人），就应该使用单元测试和类似的自动化测试工具之类的东西无法在头脑中掌握整个系统。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-05T22:20:16.487

它应该在没有 QA 的情况下工作，但有

*   持续集成软件
*   公司编程（以及分析、设计和……）指南和一些“强迫”程序员遵循的工具
*   时不时地进行一些评论
*   测试阶段，例如团队测试环境、集成（所有应用程序一起）和整合（与集成相同，但带有生产数据的副本）
*   如果需要发布计划组
*   和..好吧..优秀的工匠程序员

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-05T23:19:43.463

我目前正在经营一家车库创业软件公司，现在我用家人和朋友代替问答部门，我打电话给他们或让他们过来喝几杯啤酒并为我试驾我的产品。

到目前为止，这种“走廊”测试效果很好，但我的产品又不是针对技术熟练的用户，如果是的话，我可能会更难找到测试人员。

如果您没有现成的家人和朋友，我建议您在当地的分类广告或 craigslist 中投放广告，应该很难找到一些学生或测试最低工资的人。

至于何时聘请全职 QA 人员，我想说完全取决于公司的财务状况。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-11-03T19:56:13.830

当您有一个两个人的公司雇用测试员时，可能会矫枉过正。尝试花一些时间自己测试。或者请朋友开发者（不在团队中）玩一段时间的应用程序。或者问一个朋友（非开发人员）——就像用户验收测试一样。
当你开始销售软件，当你有 3 个或更多开发人员，当你有两个要做测试的时候雇佣（我的意思是真正测试不是“它在我的机器上启动”，而是“我已经一直试图粉碎它几个小时，但它仍然有效。也许我应该变得**很有**创意？'）。

# .net - 在 .NET 中使用 httpWebRequest 时出现“尝试了太多自动重定向”错误消息

> ID：518181
> 
> 赞同：19
> 
> 时间：2009-02-05T22:04:45.737
> 
> 标签：.net, vb.net, httpwebrequest, webrequest

我正在尝试使用 vb.net 中的 webrequest 类请求类似“ [http://www.google.com/?q=random ”的页面。](http://www.google.com/?q=random)我们在防火墙后面，所以我们必须验证我们的请求。通过添加我的凭据，我已经通过了身份验证部分。但是一旦它起作用，它似乎进入了一个重定向循环。

有没有人有想法，评论，建议为什么会这样？有没有其他人遇到过这个问题？

```
Dim loHttp As HttpWebRequest =  CType(WebRequest.Create(_url), HttpWebRequest)
loHttp.Timeout = 10000
loHttp.Method = "GET"
loHttp.KeepAlive = True
loHttp.AllowAutoRedirect = True
loHttp.PreAuthenticate = True
Dim _cred1 As NetworkCredential = ... //this is setup
//snip out this stuff
loHttp.Credentials = _cc
loWebResponse = loHttp.GetResponse() 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-02-05T22:16:53.483

确保你有一个 cookie 容器设置。

```
CookieContainer cookieContainer = new CookieContainer();
loHttp.CookieContainer = cookieContainer; 
```

您可能没有保存 cookie 并陷入重定向循环。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-01T10:59:03.677

```
loHttp.AllowAutoRedirect = true 
```

而不是这个，你必须使用

```
loHttp.AllowAutoRedirect = False 
```

避免错误错误

> “尝试了太多自动重定向”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T22:32:52.467

我翻译了 Darryl 提供给 VB 的 C# 并将其插入到 getResponse 调用之前。

```
Dim cookieContainer As CookieContainer = New CookieContainer()
loHttp.CookieContainer = cookieContainer
loWebResponse = loHttp.GetResponse() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-04T06:34:43.113

也许，您可以通过从响应中获取位置并使用合适的 cookie 来单独处理每个重定向。

# c# - 个人项目规划

> ID：518186
> 
> 赞同：17
> 
> 时间：2009-02-05T22:06:09.387
> 
> 标签：c#, project-management, xna

我想用 C#/XNA 设计一个 2D 游戏创意。在学校、项目经验不足、资源有限以及其他可能导致我放弃项目的因素之间，我将在开始之前尝试计划一下：

*   在成功的个人项目中，您注意到了哪些关键方面？

*   你是如何（成功地）从项目中获得收入的（除了要求捐款）？（注意：这不是我项目的主要目的，但会很好！）

*   您如何规划非编程方面，例如窗口布局 (UI)、游戏流程和外观？

*   您如何将游戏的抽象概念转化为真正的产品。你在素描和规划中使用什么工具？

*   在有限的资源（艺术天赋和金钱）的情况下，我如何创造一些我需要的艺术资源（除了股票艺术）？还是在我有成品之前我不应该担心这个？

*   最后，您如何打破代码中的障碍（可能是知识、时间或毅力）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-08T17:36:59.990

**在成功的个人项目中，您注意到了哪些关键方面？**

我想这很大程度上取决于你对成功的定义。如果满足以下条件，我认为游戏项目是成功的：

*   很有趣。足够了，我想在我完成后播放它。
*   我在制作的过程中学到了一些东西。
*   我实际上完成了这个项目，其中完成的定义是拥有适合我正在制作的游戏风格的艺术、音频和任何其他资产。
*   它在“现场条件”下工作，而不是简单地在我自己的机器/硬件配置上工作。

就我而言，我认为成功的每一个项目都是我认真规划并致力于完成的项目。这是我迈出的最大一步。一个无聊的周末产生的休闲项目通常不会完成。

**你是如何（成功地）从项目中获得收入的（除了要求捐款）？（注意：这不是我项目的主要目的，但会很好！）**

呵呵。还没处理好这个。但是，这还不足以让我做支持它所需的工作。有人已经提到了 XBLA 为 XNA 项目带来的潜在收入，如果你的项目是那种能很好地转化为控制台的东西，这是一条非常容易获得成功的途径。我已经研究过了，但到目前为止它并不适合我的项目。

**您如何规划非编程方面，例如窗口布局 (UI)、游戏流程和外观？**

笔。还有纸。我画了很多截图作为指导，我通常会考虑一些艺术主题来配合游戏玩法。快速原型在这里也有帮助；从在绘图程序中制作菜单和各种屏幕的模型，到在一次性项目中制作一些简单的交互式内容，应有尽有。

把一切都写下来。我记了很多笔记，众所周知，我的开发机器旁边有一台打开记事本的笔记本电脑，这样我就省去了在代码中使用 alt-tab 键快速输入关于我的内容的麻烦正在做。一些伟大的想法来自尝试让其他事情发挥作用的过程，如果你不把它写下来，它就不会发生。

**您如何将游戏的抽象概念转化为真正的产品。你在素描和规划中使用什么工具？**

尽可能迭代地工作。我讨厌听起来陈词滥调，但整个敏捷模型非常适合游戏。从你的核心“有趣”想法开始，它激发了你首先制作游戏并让它在代码中运行。也许它是你想要构建谜题/关卡的单一机制，或者它更像是你可以在单一环境/关卡/任何东西中捕捉的外观/感觉。无论哪种方式，如果你能得到一个正确运行的例子，它就可以很好地检查这个想法是否真的可行，并且可能会给你一些关于它可以实施的不同方式的想法。这可能看起来有点模糊，但更具体的建议将取决于许多其他因素（您选择的类型、观众、您的具体想法等）。

**在有限的资源（艺术天赋和金钱）的情况下，我如何创造一些我需要的艺术资源（除了股票艺术）？还是在我有成品之前我不应该担心这个？**

Lionhead 的 Peter Molyneux 曾表示，他曾经用 ascii 艺术制作过所有游戏的原型。如果他们对有限级别的图形感到有趣，那么他们值得继续。虽然您可能无法使用某些类型来获得那么简单（并且 ascii 3d 射击游戏本身可能是新颖的......），当然担心完成的艺术，音频或其他资产是可以节省很多的东西之后。最后，如果游戏玩起来很有趣，那么找一个愿意和你合作的艺术家就变得更容易了。在我无法忍受再看自己的艺术作品的原型制作阶段，我曾多次使用受版权保护的资产。在开始分发项目之前，请确保您已经替换了类似的东西......

**最后，您如何打破代码中的障碍（可能是知识、时间或毅力）？**

不知道你到底在想什么，但打破障碍才是编写代码的真正意义所在。您正在为有趣的问题寻找创造性的解决方案。网络是一个很好的一般知识资源，但最终，你自己的时间和毅力会创造一些有趣的东西。

祝你好运。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-05T22:51:13.007

> 在成功的个人项目中，您注意到了哪些关键方面？

1.  不要担心结果如何
2.  为好玩而做
3.  不要计划
4.  从小事做起，不要想大事
5.  实际编写代码而不是在某个或其他类似网站上拖延

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-05T22:33:26.287

1.  如果您希望其他人使用此游戏，请将其设为非个人。找其他人，你可以给他们演示并从中获得反馈。让游戏变得非常非常简单。在开始做一些非常简单的事情之前先构建它。那就简单点吧！

2.  没有把握 ：）

3.  使用笔和纸草图来规划窗口布局和游戏流程。对于外观和感觉，请浏览网页以查找外观精美的网站，您可以从中获取灵感。

4.  使用记事本，并写下最短的清单，以制作最简单的工作演示。只处理你写下的东西，否则你可能会被一些细节带走，最终不会产生任何有用的东西。

5.  艺术是游戏的重要组成部分，没有它就不可能有成品。如何在网上搜索有兴趣为您做这件事的合作者。

6.  如果您在代码中遇到问题，请在 StackOverflow 上寻求帮助！:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-05T23:04:33.980

关键方面：主要是你感到兴奋的事情。制作一款真正让你前进的游戏，你会因为与他人分享成品的愿望而受到激励——你的最终产品的质量也可能会因你的热情而提高。

盈利能力：好吧，既然这是 XNA，那么如果你在 Xbox Live 上发布一个版本，你将获得游戏收入的 70%。游戏的定价为 200、400 或 800 点（大约 2.50 美元至 10 美元）。

UI/可用性：为此，我通常会进行大量的可玩性测试...启动它，看看事物的“感觉”如何，然后在感觉不对时进行调整。我遇到了很多我以前从未真正想过的事情（菜单的淡入/淡出，按键的重复率等等），而游戏测试是我使用过的更有效的方法之一能够识别出这样的问题。如果你有朋友，你也可以请他们给你反馈。

规划工具：说实话，我只是列出了我想要包含在整个游戏概念中的东西，然后随着我越来越多的细节变得越来越细化。当然，某些想法在游戏测试后不可避免地会发生变化，这可能会表明它们并不像你想象的那样有趣。不过，我从未见过对这个过程有任何正式工具的巨大需求，但我要声明，我所有的项目规模都相当小，而且不是专业规模的事业或任何东西。

艺术：这对你来说可能并不总是一个选择，但我在网上有几个有艺术天赋的朋友——我征求了兴趣，并得到了一些志愿者。我提出了赚取任何版税的选项，但他们中的大多数人都对学分中的归属和有机会在世界各地的人们都可以玩的游戏中看到他们的作品感到满意。关于小东西（图标等），库存/免版税艺术在某些情况下也可以完成这项工作，但我不建议依赖它。

Breaking Barriers：不知道这个问题是什么意思，但一般来说，如果我遇到某种不可预见的问题（技术/实施挑战、游戏相关或你有什么），我能够如果我下定决心足够长的时间，要么解决问题，要么想出一个合适的解决方法。你这话还有别的意思吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-05T22:38:16.467

这些文章中给出了一些很棒的想法：

*   [http://www.flatredball.com/frb/docs/index.php?title=Tips_for_Completing_an_Independent_Project](http://www.flatredball.com/frb/docs/index.php?title=Tips_for_Completing_an_Independent_Project)
*   [http://makeitbigingames.com/2006/06/five-realistic-steps-to-starting-a-game-development-company/](http://makeitbigingames.com/2006/06/five-realistic-steps-to-starting-a-game-development-company/)
*   [http://makeitbigingames.com/2006/02/five-foundational-steps-to-surviving-as-a-game-developer/](http://makeitbigingames.com/2006/02/five-foundational-steps-to-surviving-as-a-game-developer/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-06T14:57:13.727

首先 - 我知道大学不倾向于教这个，但你真的必须这样做......让源代码控制继续下去。我建议从这里安装 TortoiseSvn：http: [//tortoisesvn.net/downloads](http://tortoisesvn.net/downloads)

使用 TortoiseSvn（一个 subversion 客户端）——您可以在您的 USB 闪存驱动器上创建一个存储库并随身携带，因此您始终拥有项目文件的副本。更重要的是，您在进行更改时可以更有信心 - 因为它保留了您所做更改的历史记录。因此，如果您破坏了某些东西，您可以恢复到 USB 闪存驱动器上的最新版本……如果您愿意，甚至可以恢复到早期版本。它还提供了显示文件修订之间差异的方法，所有这些都来自资源管理器外壳扩展。

对于个人项目，关键是保持动力。你通过为自己设定可实现的任务来保持动力。以可以达到的目标为目标。始终确保您可以构建您的项目。专注于添加新功能，同时保持旧东西仍然有效，而不是构建可能最终无处可去的巨大设计精美的框架。如果你的代码写得很好，你可以在弄清楚你真正想要构建什么游戏之后进行重构和抽象。

我会提倡某种类型的待办事项列表......类似于在 Joels 网站上找到的电子表格：http: [//www.joelonsoftware.com/articles/fog0000000245.html](http://www.joelonsoftware.com/articles/fog0000000245.html)

如果你想变得花哨，我会建议像 Trac 之类的东西：http: [//trac.edgewall.org/](http://trac.edgewall.org/) Trac 是一个 wiki、待办事项/错误列表和存储库查看器合二为一。如果您让其他人与您一起处理项目，那么与源代码管理和共享 wiki 的协作将变得更加有用。和别人一起工作也很好……你们可以保持彼此的积极性。

Wolf fire 博客最近有一些有趣的设计理念，并在此处引用了一些来源：http: [//blog.wolfire.com/2009/02/design-principles-from-tufte/](http://blog.wolfire.com/2009/02/design-principles-from-tufte/)

至于赚钱，其他人已经涵盖了社区游戏的事情。

艺术资产 - 有几个地方可以找到这些。在 www.gamedev.net 上寻找论坛。Def 在这里查看此博客以获取一些出色的艺术（和游戏设计理念）[http://lostgarden.com/](http://lostgarden.com/)

其他人建议保持工具简单——我同意。当涉及到项目规划、原型制作和设计时，更简单、更容易获得的东西——你使用它们的可能性就越大。只要你在重温某事时能与自己交流……或在协作时与他人交流，它就是一个很好的工具。为自己设定可实现的目标，然后继续努力:-)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T11:25:49.397

**在成功的个人项目中，您注意到了哪些关键方面？** 专注于真正有效的事情。

**你是如何（成功地）从项目中获得收入的（除了要求捐款）？**不是直接的。但是，技能可以让您找到工作。培养技能。

**您如何规划非编程方面，例如窗口布局 (UI)、游戏流程和外观？**

1.  首先构建内部——核心数据模型。如果数据模型有效，那么其他一切都会简单得多。

2.  为模型构建单元测试以绝对确保它始终有效。

3.  根据该模型解决“流量”和其他控制问题。

4.  一旦你有了坚实的基础，以后再构建 GUI。

**您如何将游戏的抽象概念转化为真正的产品？你在素描和规划中使用什么工具？**

我执行以下操作。

1.  我将[Argo UML](http://argouml.tigris.org/)用于技术 UML 图。

2.  我写文件时会考虑到我的最终状态。API 会是什么样子。它将如何工作。作为编写文件的一部分，我澄清了我的想法。

3.  我用单元测试分段编写代码，并无情地重构。

**在有限的资源（艺术天赋和金钱）的情况下，我如何创造一些我需要的艺术资源（除了股票艺术）？还是在我有成品之前我不应该担心这个？**

寻找愿意提供帮助的艺术家。

**最后，您如何打破代码中的障碍（可能是知识、时间或毅力）？**

1.  首先构建内部——核心数据模型。

2.  该技术的尖峰元素与主要开发分开。为每项新技术建立**单独**的概念证明。不要试图将未知技术集成到最终产品中。（我的许多客户都尝试过，但它不起作用。）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-06T11:46:34.113

在我十几岁的时候有过游戏开发经验，我可以建议如下：

*   在开始实施之前，请确保您已准备好故事，或者至少已准备好基本要点。还要确保在开发阶段不要更改游戏的类型。（是的，我知道，这很愚蠢，但可能会发生 ;-)）

*   当我们设法将游戏卖给一家软件公司时，我们实际上获得了一些收入，但是因为我们已经在开发过程中花费了太多，所以我们只是收支平衡（即利润微薄）。所以要小心你事先花的钱

*   从你说的看，你还在上学，所以好好利用这一点。肯定会有一些有艺术天赋的人，很可能是你的朋友。组建团队。这就是我们所做的，一切都可以追溯到 1993 年！那个时候就更难了。我们向我们才华横溢的朋友介绍了 3D-Studio（当时的 v3），有些人甚至介绍了一般的计算机，相信我，在您知道之前，他们已经用它制作了出色的艺术！

*   使用笔和纸来创建故事板（与上面提到的朋友一起更好。决定开发方法。即您将使用哪些库等。阅读有关游戏开发的大量信息。制定项目计划。尽力而为;-)

*   与当时的我们不同，您可以通过网络来帮助您。无论您的代码有什么问题，都可以轻松查找。StackOverflow 那时还不存在！

当然，要确保你在这个过程中玩得开心，否则它会把你活活吃掉！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-06T14:32:19.393

> 在成功的个人项目中，您注意到了哪些关键方面？

去做就对了！

# iphone - 你如何明确地为 CALayer 的 backgroundColor 设置动画？

> ID：518192
> 
> 赞同：34
> 
> 时间：2009-02-05T22:08:22.003
> 
> 标签：iphone, cocoa, macos, core-animation

我正在尝试构建一个 CABasicAnimation 来为核心动画 CALayer 的 backgroundColor 属性设置动画，但我无法弄清楚如何正确包装 CGColorRef 值以传递给动画。例如：

```
CGColorSpaceRef rgbColorspace = CGColorSpaceCreateDeviceRGB();
CGFloat values[4] = {1.0, 0.0, 0.0, 1.0}; 
CGColorRef red = CGColorCreate(rgbColorspace, values); 
CGColorSpaceRelease(rgbColorspace);

CABasicAnimation *selectionAnimation = [CABasicAnimation animationWithKeyPath:@"backgroundColor"];
[selectionAnimation setDuration:0.5f];
[selectionAnimation setToValue:[NSValue valueWithPointer:red]];
[layer addAnimation:selectionAnimation forKey:@"selectionAnimation"]; 
```

我认为似乎对 backgroundColor 属性没有任何作用，因为将其作为包裹在 NSValue 中的指针传递并不是传递它的方式。

backgroundColor 是 CALayer 的动画属性，所以我的问题是：你如何设置这个特定属性的 From 或 To 值（最好以 Mac / iPhone 平台无关的方式）？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-02-06T01:04:41.023

在设置 a 的or属性时，您不需要包装`CGColorRef`s 。只需使用. 为避免编译器警告，您可以将.`toValue``fromValue``CABasicAnimation``CGColorRef``CGColorRef``id`

在我的示例应用程序中，以下代码将背景设置为红色。

```
CABasicAnimation* selectionAnimation = [CABasicAnimation 
    animationWithKeyPath:@"backgroundColor"];
selectionAnimation.toValue = (id)[UIColor redColor].CGColor;
[self.view.layer addAnimation:selectionAnimation
                       forKey:@"selectionAnimation"]; 
```

但是，当动画结束时，背景会恢复到原来的颜色。这是因为`CABasicAnimation`仅在动画运行时影响目标层的表示层。动画结束后，模型层中设置的值返回。因此，您还必须将图层`backgroundColor`属性设置为红色。也许使用`CATransaction`.

您可以通过首先使用隐式动画来省去这个麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-11T08:27:19.150

我一直在努力解决这个问题，直到我通过实验找到了障碍。如果您在 Interface Builder 中更改默认（未指定）的背景颜色，在项目（例如 UILabel）的上下文中，直接或通过动画设置图层的 backgroundColor 属性将无效被放在了IB。所以不要指定背景颜色，上面应该可以工作。

# c++ - 如何使用 OLE-DB 访问 COM/C++ ATL 应用程序中的 dbf 文件？

> ID：518193
> 
> 赞同：1
> 
> 时间：2009-02-05T22:08:32.237
> 
> 标签：c++, com, oledb, atl, dbf

如何在 COM/C++ 应用程序（通过 ATL 创建）中访问 dbf 文件中包含的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T23:16:38.587

我会使用 ADO；这是迄今为止最快的方法，即使处理它的 COM 方面也是如此。[从这里](http://msdn.microsoft.com/en-us/library/ms675532(VS.85).aspx)开始。这比滚动您自己的 Consumer 实现要容易得多，除非您确实需要执行 OLEDB 直接提供的较低级别的访问。

# hibernate - 您可以根据匹配限制订购 hql 结果吗？

> ID：518197
> 
> 赞同：2
> 
> 时间：2009-02-05T22:09:39.067
> 
> 标签：hibernate, hql

我有一个对象*Dog*，其中包含一组*DogMetadata*。

每个 DogMetadata 都有两个值：一个 String（“ *desc* ”）和一个 int（“ *rank* ”）。

对狗的描述有不同的排名，例如：“小”是 5，“毛茸茸”是 2，“友好”是 9，“dalmation”是 11，“mutt”是 22。

**我需要根据它们的任何**desc 值搜索狗（例如，查找“毛茸茸”或“小型”狗）。

此查询返回匹配的狗，但它们没有任何顺序。

```
select distinct Dog as d
left join d.dogMetadata as dMeta
where ( (dMeta.desc = 'furry') OR (dMeta.desc = 'small') ) 
```

如何按任何匹配 DogMetadatas 的总“排名”值对匹配的 Dog 对象列表进行排序？

我整天都在像狗一样工作（尝试“Group By”和“Order By”），但我想我一直在叫错树。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T17:52:49.380

此查询不起作用：

```
select d from Dog as d
left join fetch d.dogMetadata as dMeta
where ( (dMeta.desc = 'furry') OR (dMeta.desc = 'small') )
group by d
order by sum(dMeta.rank) desc 
```

由于这个错误： http://opensource.atlassian.com/projects/hibernate/browse/HHH-1615?focusedCommentId= [24530#action_24530](http://opensource.atlassian.com/projects/hibernate/browse/HHH-1615?focusedCommentId=24530#action_24530)

我只通过请求狗 ID 来解决这个限制：

```
select d.id from Dog as d
left join fetch d.dogMetadata as dMeta
where ( (dMeta.desc = 'furry') OR (dMeta.desc = 'small') )
group by d.id
order by sum(dMeta.rank) desc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T23:34:39.847

只是从我的头顶（没有在 HQL 中实际验证它）

```
from Dog d where d.dogMetadata.desc in ('furry','small','whatever') order by d.dogMetadata.rank 
```

# .net - Control.ResolveUrl 与 Control.ResolveClientUrl 与 VirtualPathUtility.ToAbsolute

> ID：518199
> 
> 赞同：24
> 
> 时间：2009-02-05T22:09:56.523
> 
> 标签：.net, asp.net

在解析以波浪号 (~) 开头的路径时，使用其中一种方法是否有任何好处？

一般来说，更好的做法是，您应该在 html 中发送相对路径还是绝对路径？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-22T16:41:58.810

ResolveUrl 和 ResolveClientUrl 的区别在于 ResolveClientUrl 返回相对于当前页面的路径，ResolveUrl 返回相对于站点根目录的路径：

[http://www.andornot.com/blog/post/ResolveUrl-vs-ResolveClientUrl.aspx](http://www.andornot.com/blog/post/ResolveUrl-vs-ResolveClientUrl.aspx)

我建议使用绝对路径。

**编辑**：Rick Strahl 发表了一篇关于此的好文章

**Edit2**：删除了关于缓存的部分。不会添加到答案中，并且可能不一定准确。

[http://west-wind.com/weblog/posts/132081.aspx](http://west-wind.com/weblog/posts/132081.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-09-04T19:18:50.793

这是另一篇文章，解释了在 ASP.NET 中解析路径的各种方法之间的区别 -

[在 ASP.NET 中解析 URL 的不同方法](http://refactoringaspnet.blogspot.com/2009/09/different-approaches-for-resolving-urls.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-04-13T03:47:52.157

请注意，如果路径中包含查询字符串，则 VirtualPathUtility.ToAbsolute(virtualPath) 将引发异常。

HttpException 消息将类似于“'~/YourVirtualPath/YourPage.aspx?YourQueryStringArg=FooBar' 不是有效的虚拟路径”。

请参阅[Rick Strahl 的 Web 日志：ResolveUrl() without Page](http://www.west-wind.com/Weblog/posts/154812.aspx) 和[MSDN：VirtualPathUtility.ToAbsolute Method (String)](http://msdn.microsoft.com/en-us/library/ms150160.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-08T00:24:55.070

我注意到的另一个区别：

**代码：**

`string value = "~/Docs/Hello & World.aspx";` `Response.Write(HyperLink1.ResolveClientUrl(value) + "<br/>");` `Response.Write(HyperLink1.ResolveUrl(value) + "<br/>");`

**结果：**

文档/Hello%20&%20World.aspx

/Docs/Hello & World.aspx

# c++ - 有没有办法允许 Windows 服务（非托管 c++）在共享网络文件夹上写入文件？

> ID：518206
> 
> 赞同：2
> 
> 时间：2009-02-05T22:11:27.660
> 
> 标签：c++, windows, service, networking

我尝试在“本地系统”中运行该服务：没有用。

我尝试在对网络共享文件夹具有权限的帐户中运行该服务：没有用。

我是否必须为此创建一个独立的应用程序并以对网络共享文件夹具有权限的用户身份启动该应用程序？

谢谢，

网卡

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T06:40:18.973

您应该使用 UNC 路径（如 Scott 建议的那样），并在可以访问网络资源的显式帐户下运行系统；那应该工作。

它*可能*无法在 LocalSystem 下工作，因为这是 Windows 中的一个特殊用户帐户，只能访问本地系统。LocalSystem 在 NT4 中没有网络访问权限，在 2000+ 中它被视为用于网络访问目的的计算机帐户，并受到本地安全策略中的访问限制。有关更多信息，请参阅[此页面](http://msdn.microsoft.com/en-us/library/ms677973(VS.85).aspx)。

简短回答：使用显式帐户运行可以访问 UNC 路径的服务。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T22:22:27.027

您可能可以使用模拟来获取所需的凭据：http: [//msdn.microsoft.com/en-us/library/aa376391 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa376391(VS.85).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T22:34:50.920

在对网络共享文件夹具有权限的帐户中运行该服务**确实**有效。我有一项服务可以做到这一点。

它不一定适用于 Novell Netware 共享或其他“非标准”共享（过去我们遇到了麻烦，但现在 Netware 几乎无关紧要。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T22:45:59.600

您的两种情况都应该有效。“本地系统”是您可以授予共享权限的活动目录中的计算机帐户。我不知道为什么它不适合你。但这是你可以做的。

*   使用常规帐户（它更容易）。
*   将您的应用程序作为控制台应用程序进行测试。
*   调整客户端上的审核以将所有内容记录到安全日志中。它是从本地安全策略应用程序中完成的。并在服务器上做同样的事情（如果可以的话）。

这应该足以定位问题。

**更新1**：回应我认为错误的评论（但也许我是......）。评论所指的服务（没有网络访问权限的服务）称为本地服务帐户（ NT AUTHORITY\LocalService ）。它通常用于应用程序池的标识，但可以用于服务。它与本地系统帐户不同。

[来自 msdn](http://msdn.microsoft.com/en-us/library/ms677973(VS.85).aspx)：

> 当服务在作为域成员的计算机上的 LocalSystem 帐户下运行时，该服务具有授予该计算机帐户或该计算机帐户所属的任何组的任何网络访问权限。

# ant - 如何使用 Ant 将文件复制到现有的 JAR 中？

> ID：518207
> 
> 赞同：21
> 
> 时间：2009-02-05T22:11:40.047
> 
> 标签：ant, jar

我有一个项目需要访问其自己的 JAR 文件中的资源。当我为项目创建 JAR 文件时，我想将一个目录复制到该 JAR 文件中（我猜 ZIP 等效项是将目录“添加”到现有 ZIP 文件中）。我只希望在创建 JAR 之后发生副本（如果我清理并删除 JAR 文件，我显然不希望发生副本）。

目前构建文件如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="foobar" basedir=".." default="jar">

    <!-- project-specific properties -->
    <property name="project.path" value="my/project/dir/foobar" />

    <patternset id="project.include">
        <include name="${project.path}/**" />
    </patternset>
    <patternset id="project.jar.include">
        <include name="${project.path}/**" />
    </patternset>

    <import file="common-tasks.xml" />

    <property name="jar.file" location="${test.dir}/foobar.jar" />    
    <property name="manifest.file" location="misc/foobar.manifest" />
</project> 
```

一些构建任务是从另一个文件 (common-tasks.xml) 调用的，我无法在此处显示。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-05T22:27:12.073

```
<jar update="true">
...
</jar> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-06T09:57:13.397

Jar/Ear Ant 任务是更一般的[Zip 任务的子任务](http://ant.apache.org/manual/Tasks/zip.html)。这意味着您也可以`zipfileset`在您的 Jar 任务中使用：

```
<jar destfile="${jar.file}" basedir="...">
    <zipfileset dir="${project.path}" includes="*.jar" prefix="libs"/>
</jar> 
```

我还看到您定义了一个单独的清单文件以包含在 Jar 中。您还可以使用嵌套`manifest`命令：

```
<jar destfile="@{destfile}" basedir="@{basedir}">
    <manifest>
        <attribute name="Built-By" value="..."/>
        <attribute name="Built-Date" value="..."/>

        <attribute name="Implementation-Title" value="..."/>
        <attribute name="Implementation-Version" value="..."/>
        <attribute name="Implementation-Vendor" value="..."/>
    </manifest>
</jar> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-05T22:22:02.707

一种方法是使用 Ant 任务：

1.  [解压缩](http://ant.apache.org/manual/Tasks/unzip.html)- 爆炸 Jar 是一个临时文件夹
2.  [复制](http://ant.apache.org/manual/Tasks/copy.html)- 将您想要的文件夹复制到临时文件夹，然后
3.  [Jar](http://ant.apache.org/manual/Tasks/jar.html) - 将 'update' 设置为 true，将临时文件夹打包回原始 jar 文件。

Ant[手册](http://ant.apache.org/manual/)有如何做到这一点的示例。

# c# - 好的地址解析器在哪里

> ID：518210
> 
> 赞同：31
> 
> 时间：2009-02-05T22:12:08.827
> 
> 标签：c#, parsing, opensocial, street-address

我正在寻找一个很好的工具，它可以获取完整的邮寄地址，格式化为显示或与邮寄标签一起使用，并将其转换为结构化对象。

例如：

```
// Start with a formatted address in a single string
string f = "18698 E. Main Street\r\nBig Town, AZ, 86011";

// Parse into address
Address addr = new Address(f);

addr.Street; // 18698 E. Main Street
addr.Locality; // Big Town
addr.Region; // AZ
addr.PostalCode; // 86011 
```

现在我可以使用 RegEx 来做到这一点。但棘手的部分是让它足够通用以处理世界上的任何地址！

我相信肯定有什么东西可以做到。

如果有人注意到，这实际上是[opensocial.address](http://code.google.com/apis/opensocial/docs/0.8/reference/#opensocial.Address)对象的格式。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-05T20:08:11.313

Googlemaps API 对此非常有效。例如，假设给定字符串“120 w 45 st nyc”。像这样将它传递给 Googlemaps API：`http://maps.google.com/maps/geo?q=120+w+45+st+nyc`你会得到这个响应：

```
{
  "name": "120 w 45 st nyc",
  "Status": {
    "code": 200,
    "request": "geocode"
  },
  "Placemark": [ {
    "id": "p1",
    "address": "120 W 45th St, New York, NY 10036, USA",
    "AddressDetails": {"Country": {"CountryNameCode": "US","CountryName": "USA","AdministrativeArea": {"AdministrativeAreaName": "NY","Locality": {"LocalityName": "New York","Thoroughfare":{"ThoroughfareName": "120 W 45th St"},"PostalCode": {"PostalCodeNumber": "10036"}}}},"Accuracy": 8},
    "ExtendedData": {
      "LatLonBox": {
        "north": 40.7603883,
        "south": 40.7540931,
        "east": -73.9807141,
        "west": -73.9870093
      }
    },
    "Point": {
      "coordinates": [ -73.9838617, 40.7572407, 0 ]
    }
  } ]
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-03-08T17:17:11.830

如果您正在寻找具有简单解决方案的地址解析器，请尝试以下操作：

[http://usaddress.codeplex.com/](http://usaddress.codeplex.com/)

好：1\. 不需要数据库 2\. 不需要互联网查找 3\. 非常准确

Bad: 1\. 无法确认是否为真实地址 2\. 仅适用于美国地址 3\. 在C#中，使用.NET 3.5 或以上

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-10-13T03:57:50.197

如前所述，这不是一个小问题。除了国际地址之外，最大的问题之一是地址没有标准格式，而且地址无法告诉您它是否格式正确，即它不像信用卡号码那样自我验证.

因此，您必须依靠外部事实来源来确保地址是真实的。这就是地址验证服务发挥作用的地方。根据您的业务需求和应用程序要求，您可能正在查看一次性“批量”清理您的地址列表，或者可能是实时/实时地址验证服务。有许多优秀的供应商（成本各不相同）可以轻松解决这个问题。

我应该提一下，我是 SmartyStreets 的创始人。我们进行[CASS 认证的地址验证](http://www.smartystreets.com/)。我们会将您的未格式化/原始地址转换为经过清理、标准化和验证/确认的地址。根据您列表的大小，成本通常只有几美元，而且周转时间几乎是即时的——通常是几分钟。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-05T22:56:18.567

您可以尝试[Experian 地址验证](https://www.edq.com/address-verification/)。有它的问题，但几乎像宣传的那样有效。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-05T23:23:18.573

由于没有像@duffymo 说的那样简单的解决方案，接下来最好的事情可能是重新考虑设计。如果是用户表单，妥协让用户填写。如果您要追溯解析数据，请使用非常严格的正则表达式根据某些标准（国家/地区为美国）解析地址。然后在剩下的那些上做第二遍，依此类推。我采用了这种方法，这是唯一可靠的方法。

采用通用正则表达式方法的另一个设计问题是它会为错误的地址生成误报。如果您向这些人发送蜗牛邮件，它最终会被退回，您将有更多的工作要做，试图找出哪些邮件返回或继续将邮件发送到错误的地址。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-12T13:50:12.077

我最近尝试了 RecogniContact。它是一个解析美国和欧洲地址的 Windows COM 组件。您可以从网站上对其进行测试。

[http://www.loquisoft.com/index.php?page=8](http://www.loquisoft.com/index.php?page=8)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-01T07:07:55.447

对于加拿大地址，我使用了一个名为[Street Perfect](http://www.streetperfect.com/)的地址。我们必须将`c++`代码封装在一些代码中`.net`以使其可重用于我们的目的，但这相当容易。

# winforms - 防止数据绑定中的属性更改并强制绑定控件显示当前值

> ID：518211
> 
> 赞同：1
> 
> 时间：2009-02-05T22:12:38.763
> 
> 标签：winforms, data-binding, inotifypropertychanged

我有

```
 Public Overrides Property UID() As String
        Get
            Return mUID
        End Get
        Set(ByVal value As String)
            If Me.IsNew Then
                mUID = value
            End If
            OnPropertyChanged("UID")
        End Set
    End Property 
```

该类实现 INotifyPropertyChanged 并且我绑定到 WinForm 控件中的 TextBox 控件。

问题是当用户在文本框中键入一个值时，即使绑定的值仍然与 IsNew 为 false 的事实相同，新值也会显示在文本框中。（我尝试过使用这两种类型的 DataSourceUpdateMode。）

我已阅读[INotifyPropertyChanged 问题](https://stackoverflow.com/questions/480743)，并且我相信 Windows 窗体的工作方式基本相同，因为事件的发起者也不会检测到处理事件。

我可以在 BO 类中做些什么来强制控件响应 INotifyPropertyChanged 事件吗？或者我可以在 BO 类中做些什么来让控件显示正确的值？

我意识到我可以在 GUI 代码中以各种方式处理这个问题，但这不是我的目标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T15:19:43.160

我找到了答案。

首先这是一个问题，Rocky Lhotka 已经注意到了这一点。我使用的解决方案来自他。

首先，他有一个控件，您可以将其放在表单或用户控件上，它可以解决问题。

他还有一些我稍微修改和使用的代码，并将其放在我们的基本表单和用户控件上。

```
Private Sub baseUserControl_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    HookBindings(Me)
End Sub

Private Sub HookBindings(ByVal CNTRL As Control)
    For Each ctl As Control In CNTRL.Controls
        If Not TypeOf ctl Is baseUserControl Then
            For Each b As Binding In ctl.DataBindings
                AddHandler b.BindingComplete, AddressOf ReadBinding
            Next
            HookBindings(ctl)
        End If
    Next
End Sub

Private Sub ReadBinding(ByVal sender As Object, ByVal e As BindingCompleteEventArgs)
    e.Binding.ReadValue()
End Sub 
```

# wpf - 您会将您的 UI 迁移到使用 Windows 7 的功能区吗？

> ID：518212
> 
> 赞同：3
> 
> 时间：2009-02-05T22:12:52.040
> 
> 标签：wpf, winforms, windows-client

很快，Windows 7 将在任何 Windows 程序（如画图或写字板）中使用功能区作为默认界面，而保留默认工具栏和菜单。

您会将您的 UI 迁移到使用 Windows 7 的功能区吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-05T22:23:57.977

Office 中新功能区的主要内容不是不同的外观和感觉。确定哪些元素需要放置在哪里、有多大以及理解为什么需要付出努力和研究。

如果您不准备为自己的应用重复这项工作，那么它可能会失败。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-05T22:15:40.457

去年做过。这可能是一个错误。功能区仅适用于绝对以文档为中心的应用程序。

如果它牺牲了可用性，那么尝试将它撞到一个不需要功能区的应用程序中并不是一个好主意，因为它看起来不错。

我想说设计一个与功能区一起使用的应用程序比传统的菜单/工具栏用户界面要困难得多。您必须认真考虑哪些命令属于一起。如果他们必须一直翻转标签才能获得他们想要的命令，用户会很恼火。

此外，Microsoft 对功能区的工作方式施加了许多限制/限制。这些很难遵守，并且可能导致它们在法律上迫使您更正您的申请（如果可以的话）。这么说，我想我已经看到微软自己使用功能区打破了他们自己的指导方针。也许自从我上次看到他们以来他们已经更新了指南！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-13T08:05:22.137

如果您的软件有清晰、独立的部分，它们都需要自己的一组控件，那么功能区可能会非常有用。本质上，您可以将其用作选项卡式工具栏，并且仅在用户在软件部分之间切换时才让它切换。

对于我目前正在开发的软件，该软件中有一个单独的测量、分析和报告部分。由于我在分析时不需要测量按钮，因此更改整个工具栏非常有意义。功能区只是实现此目的的一种简单方法。

*注意：我们通过更改功能区的选项卡使用户在测量和分析之间切换，因此他们在分析时“意外”看到测量工具栏的情况应该不会发生。

如果您的软件没有像 Word 那样的大量功能，或者软件部分之间有明显的区别，那么最好只使用普通的工具栏。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-05T22:15:10.053

为了跨平台的一致性，不。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-05T23:20:46.943

我在这个答案中输入“不”太用力了，我擦伤了我的手腕

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-05T22:19:27.207

过了一会儿，是的。我认为用户比我们其他开发人员更能接受 MS 的新 UI 功能。在他们在我们的软件中看到它之前，我宁愿等待他们习惯这一点。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-05T23:23:36.093

底线是您使用对您的应用程序有意义的用户界面概念，无论它们是文本框、标签、组合、菜单、工具栏、图像、按钮、列表、树、功能区还是其他一些概念。这一切都是为了使用正确的工具来完成工作 - 只需使用功能区，因为它与将所有组合转换为菜单或将工具栏转换为列表框一样有用。

仅当您的应用程序通过这样做得到改进时才进行更改。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-05T23:26:51.563

除非我认为绝对需要它，否则绝对不需要。根据我的经验，我遇到的大多数用户都不喜欢 Ribbon 控件，因为他们发现很难导航，他们希望他们能恢复旧的菜单/工具栏样式。

当然它看起来不错，并且可以很好地组织，但从长远来看，我认为它不是很多应用程序的必需品。

视觉导航并不总是更好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-05T23:36:34.523

我通常不会在最新版本的产品上使用新功能：它们是错误农场。

# abap - 我应该如何开始学习 SAP？

> ID：518226
> 
> 赞同：53
> 
> 时间：2009-02-05T22:16:00.583
> 
> 标签：abap, hana, sap-fiori, sap-gui, sap-erp

我是一名 MS 开发人员，致力于提供 MS 技术和 SAP 之间的桥接产品。

我已经习惯了 MS 领域，它似乎与 SAP 有着完全不同的理念。这开始成为一个问题——我无法“获得”SAP。

那么，什么是“学习”SAP 的好材料呢？- 了解人们为什么购买它，从业务角度如何使用它，如何从技术角度看待架构，了解它的结构，SAPGUI 中的重要工具是什么，以及*如何*学习如何阅读ABAP？*不寒而栗*

我知道足够的 SAP 来完成我的工作 - 我知道 SAP 中的符文。但这还不够，SAP SDN 和帮助对于大图视图确实不够（它对于小图视图也不是很好，但这是其他地方的另一个讨论）。

提前致谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-06T06:45:24.487

SAP是一头争吵的野兽..一些建议：

*   对于程序员：获得一本不错的 ABAP 编程书籍。大多数概念都非常熟悉，它们为您提供了一个很好的起点，可以更好地理解系统。
*   对于“商业用户”：除了参加昂贵的课程（在我看来主要是浪费时间/金钱）之外，与用户坐下来，让他/她也解释一两个小时他们在做什么。
*   对于“定制者”：这就是事情变得非常困难的地方，因为有无数的步骤和选择以及改变事物的地方。找一个更有经验的人会有所帮助。正如您所指出的，书籍/文章大多不是很有帮助，因为它们通常无法解释概念。

还要记住几件事：

*   SAP“如此之大”，不可能“无所不知”。
*   SAP 是由一些聪明人和一些不那么聪明的人编写的。你无法“摸索”事情可能是由一些非常糟糕的程序员为他不理解的问题构建了一堆愚蠢的解决方案造成的。
*   SAP 因提出自己的语言或重新利用流行语并添加自己的特殊含义而臭名昭著。这增加了魔力和混乱。

刚开始，提出问题，尝试一些事情，不要害怕它的大小。很快你就会变得更好...

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-09T11:20:34.603

首先，SAP 是如此庞大，你永远无法了解它的每一个部分。有如此多的功能性主题和技术，这令人麻木。

课程既可以用于第一次介绍（但这样做的成本很高），也可以用于非常高级的科目（更好）。

SAP 是一个完整的环境。大多数内容的代码都是可用的。因此，检查 SAP 如何完成某事可以/可能/将帮助您了解技术或主题。（顺便说一句，很多评论都是用德语...）系统内事务 se80 在这方面特别有用，因为它向程序显示所有相关数据。

此外，[SDN](http://sdn.sap.com) **是**您的朋友。论坛，操作方法，白皮书......它会帮助你。一些系统内事务 (se83) 将用作编码技术的示例。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-05-31T20:05:01.013

你应该加入[https://open.sap.com](https://open.sap.com)。

这基本上是 SAP 最近制作的免费学习门户。

“想象一下，您可以回到大学学习更多有关在 SAP 生态系统中取得成功的关键主题，并将您的学习与繁忙的工作日程结合起来。

那么，现在您可以： 使用 openSAP。

第一个 openSAP 课程现已开始，更多课程即将推出。

有关 SAP 教育产品的完整概述，请参阅 SAP 培训和认证商店。” SAP Open

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-05T22:23:24.187

SAP 是一个非常封闭的系统。

如果你想学习 SAP，唯一可靠的方法是从 SAP 接受一些非常昂贵的培训。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-23T16:57:19.400

简而言之，这就是我了解 SAP 的方式：

*   在大学做了 4 年的三明治计算机课程——他们甚至没有提到 SAP
*   大学课程的第三年是实习年
*   我在一家最近实施了 SAP 的大型银行的 SAP 部门找到了一份工作
*   前 3 个月，我在英国各地旅行，安装 SAP GUI 软件
*   后来我获得了 SAP Portal 系统的所有权并参与了 SAP BASIS。最重要的是，我了解了每个 SAP 团队都做了什么，这让我发现了我在职业生涯中想要做的事情
*   第 4 年回到大学（当我这样做时，我为大学做了一个项目，我是基于 SAP 做的，所以我与银行的 SAP 部门保持联系，大部分时间都拜访了他们）
*   大学毕业后，我到银行SAP部门全职工作。
*   在那里，我领导 SAP 技术团队部门，该部门是 BASIS、网络和开发的交叉部门。主要是中间件、端到端以及后端技术
*   从那里我进入了 SAP BASIS 团队
*   然后我搬到了另一家使用 Windows 和 MS SQL 的公司（银行主要是 UNIX 和 Oracle），也使用了一些不同的 SAP 模块，不同的使用模型和其他各种相似但不一样的方面，所以我能够移动我的核心技能并增加它
*   我还在那儿，还在学习！

我参加过几门 SAP 和非 SAP 课程。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-06T16:34:01.463

作为一个在 SAP 工作了 14 年的人，我可以告诉你，大多数第三方书籍都很糟糕。最好的书籍来自 SAP America 的出版部门 SAPpress。

学习 SAP 的最佳方法是从合作伙伴那里获得 IDES 访问权限，并开始在事务 SE38 中创建 ABAP 程序。除了编程语言结构不是像 ECLIPSE 这样的开源/免费软件外，这与学习任何其他编程语言没有什么不同。它位于 SAP 的 ABAP 堆栈中。

此外，如果您购买 SAP 培训计划，您将获得一个“S 用户”ID，该 ID 将允许访问 SAP 开发人员网络，这将有助于进一步学习。这很昂贵，但那些认真的人都有一个 S 用户 ID。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T07:07:01.213

我们实际上遇到了同样的问题。我们需要将我们的系统与 SAP 连接起来，而您自己可以找到的任何信息都无济于事。目前唯一可行的方法是找一个有经验的人来免费帮助我们（比如我们的客户，如果他们帮助我们将我们的作品与他们的 SAP 安装互连，他们就会赢得自己的胜利）。

当您清楚地看到您在几天/几周内不会学到很多东西时，教学课程似乎太贵了。由于成本原因，也没有考虑雇用外部 SAP 顾问的另一种选择。

我知道他们已经准备好教新的年轻毕业生 ABAP 和他们的系统。或者至少准备好了，因为他们去年完全停止了工作。

从那里短暂的时间（写论文）我记得他们有广泛的内部门户，带有留言板和各种列表。如果你有朋友在那里工作，你可以让他们发布一个私人广告，要求一些私人课程。另一种选择是接一个说在那里开始工作但一年左右就放弃的学生。这样一来，您就有可能拥有一些知识渊博但又不花钱的人。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-02-28T05:48:21.827

有关 ABAP 和 Webdynpro abap 的一些好的 sap 教程，请参阅 saptechnical.com。

另请参阅 sapfunctional.com 以了解 SAP 的所有重要功能模块，如 MM、SD、FI 等。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-05-13T05:41:05.737

SAP 是一片海洋，众所周知是一滴水。但没有什么能阻止我们了解这一切。

*   **ABAP**：SDN 和 help.sap 中有一些很棒的 wiki，您可以在其中探索 ABAP。我建议您，因为您已经对 obj 进行了更多探索。面向编程，最适合学习 `ABAP Objects`。[它非常有趣和简单，例如 C#/Java 等。在 SDN 中，您可以在此 wiki](https://wiki.sdn.sap.com/wiki/display/ABAP/ABAP+Development+and+Programming)中探索很多内容。ABAP 是一个不错的选择。作为 ABAPer，我们可以解决问题，几乎可以进行增强等，但主要是 COBOLic。我的意思是程序性的，你需要 SAP 系统来学习它，因为没有多少“免费”的在线编译器可用于测试和运行！

*   **其他选项**：正如您之前在 MS 上工作过的那样。建议您看看 MS - SAP Duet。今天的就业市场有很多技术方面的专业人士和较少的流程、职能和管理级别的员工。单击此处了解有关[SAP Microsoft Duet](http://www.duet.com/)的更多信息。Duet Enterprise，SAP+MS联合开发的产品。它将 MS SharePoint 支持的协作和生产力与 SAP 应用程序的业务数据和业务处理功能相结合。

*   **ByD**：另外，如果您有一些 c# 经验，建议您看看 SAP ByDesign SDK。代号：哥白尼。现在作为 ByD Studio 发布。这很神奇，因为关键字、代码和脚本更像 c#。[此链接](http://www.sdn.sap.com/irj/bpx/business-bydesign)中提供了对此的看法。

释放您的编码技能.. 一切顺利..

# batch-file - 是否可以从批处理文件或 cmd 脚本将目录添加到 DLL 搜索路径？

> ID：518228
> 
> 赞同：16
> 
> 时间：2009-02-05T22:16:23.280
> 
> 标签：batch-file, cmd, dll, wsh

MSDN 说函数[SetDllDirectory()](http://msdn.microsoft.com/en-us/library/ms686203.aspx)可用于将目录插入到[DLL Search Path](http://msdn.microsoft.com/en-us/library/ms682586.aspx)中。是否可以从批处理文件或 cmd 脚本访问此功能，也许是通过[cscript](http://technet.microsoft.com/en-us/library/bb490887.aspx)使用？

目的是让我们的开发版本的 dll 在 %WINDIR% 等中预先存在的旧版本之前找到，而无需为此编写程序。

提前感谢您的时间和想法。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-05T22:33:33.777

您可以将 DLL 放在与可执行文件相同的路径中，在 %WINDIR% 之前首先搜索该路径。无法直接从批处理文件中调用 SetDllDirectory。

但是，您可以在 %PATH% 变量中插入 DLL 目录，然后 Windows 会在那里找到 DLL。

```
set PATH=C:\path to your dll;%PATH% 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-05T23:43:00.827

> 目的是让我们的开发版本的 dll 在 %WINDIR% 等中预先存在的旧版本之前找到，而无需为此编写程序。

如果 DLL 与可执行文件不在同一个文件夹中，Windows 将在系统路径中指定的文件夹中搜索文件。所以你需要做的就是把你的文件夹放在路径的开头。

您可以使用以下批处理命令执行此操作：

```
 set PATH=c:\MyDLLFolder;%PATH% 
```

如果您的路径包含空格，则需要使用以下批处理命令：

```
 set PATH="C:\My DLL Folder";%PATH% 
```

但请记住，此路径更改仅对当前控制台会话的 PATH 进行。如果您关闭并重新打开控制台，这些路径更改将丢失。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-08-20T14:42:38.467

为了解决关于 dll 搜索顺序的争议（在@jussij 的答案的评论中），这里的列表来自微软的文档：

**如果`SafeDllSearchMode`启用，搜索顺序如下：**

1.  加载应用程序的目录。
2.  系统目录。使用该`GetSystemDirectory`函数获取该目录的路径。
3.  16 位系统目录。没有函数获取这个目录的路径，但是被搜索了。
4.  Windows 目录。使用该`GetWindowsDirectory`函数获取该目录的路径。
5.  当前目录。
6.  PATH 环境变量中列出的目录。请注意，这不包括 App Paths 注册表项指定的每个应用程序路径。计算 DLL 搜索路径时不使用 App Paths 键。

**如果`SafeDllSearchMode`禁用，则搜索顺序如下：**

1.  加载应用程序的目录。
2.  当前目录。
3.  系统目录。使用该`GetSystemDirectory`函数获取该目录的路径。
4.  16 位系统目录。没有函数获取这个目录的路径，但是被搜索了。
5.  Windows 目录。使用该`GetWindowsDirectory`函数获取该目录的路径。
6.  PATH 环境变量中列出的目录。请注意，这不包括 App Paths 注册表项指定的每个应用程序路径。计算 DLL 搜索路径时不使用 App Paths 键。

请参阅[http://msdn.microsoft.com/en-us/library/windows/desktop/ms682586(v=vs.85).aspx#standard_search_order_for_desktop_applications](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682586(v=vs.85).aspx#standard_search_order_for_desktop_applications)

# c# - C# 问题：我加载 .MDB 文件、对其进行更改并将更改保存回原始文件的最简单方法是什么？

> ID：518239
> 
> 赞同：5
> 
> 时间：2009-02-05T22:19:34.647
> 
> 标签：c#, datatable, dataadapter, ms-jet-ace, oledbconnection

我正在进行的项目即将完成。我正在加载一个 .MDB 文件，在 DataGrid 上显示内容并尝试在 DataGrid 上获取这些更改并将它们保存回 .MDB 文件。我还将创建一个函数，允许我从一个 .MDB 文件中获取表并将其保存到另一个 .MDB 文件中。当然，如果我不知道如何将更改保存回 .MDB 文件，我将无法执行任何操作。

我对谷歌进行了广泛的研究，但我的问题没有答案。我认为自己是这个特定主题的初学者，所以请不要让答案太复杂——我需要最简单的方法来编辑 .MDB 文件！请提供编程示例。

1.  假设我已经与 DataGrid 建立了连接。如何获取 Datagrid 所做的更改？我敢肯定这个回答很简单。
2.  然后我需要知道如何获取这个 Datatable，将它插入到它来自的 Dataset 中，然后获取该 Dataset 并重写 .MDB 文件。（如果有办法只插入已更改的表，我会更喜欢。）

提前谢谢您，如果您需要更多信息，请告诉我。这是我可能要问的关于这个话题的最后一件事……谢天谢地。

**编辑：**

我正在使用的 .mdb 是**Microsoft Access 数据库。**（我什至不知道有多个 .mdb 文件）

我知道我不能通过流写入器或任何东西直接写入 .MDB 文件，但有没有办法可以生成一个已经包含 DataSet 信息的 .MDB 文件？或者是否有一种方法可以将表添加到已加载到 DataGrid 中的 .MDB 文件中。必须有办法！

同样，我需要一种在 C# 中以***编程***方式执行此操作的方法。

**编辑：**

好的，我的项目相当大，但我使用单独的类文件来处理所有数据库连接。我知道我的设计和来源真的很草率，但它完成了工作。我只和我在互联网上找到的例子一样好。

请记住，我只是以另一种形式连接到 DataGrid。让我知道您是否需要 Datagrid 表单中的代码（不过我不知道您为什么需要它）。DatabaseHandling.cs 处理 2 个 .MDB 文件。所以你会在那里看到两个数据集。我最终将使用它从一个数据集中获取表格并将它们放入另一个数据集中。我只需要弄清楚如何将这些值保存到 .MDB 文件中。

有没有办法做到这一点？一定有办法...

**编辑：**

根据我的研究和阅读......我认为答案就在我的眼皮底下。使用“更新（）”命令。现在，虽然这再次确保实际上有一种简单的方法可以做到这一点，但我仍然面临一个问题，即我不知道如何使用这个更新命令。

也许我可以这样设置：

```
Oledb.OledbConnection cn = new Oledb.OledbConnection(); 
cn.ConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Staff.mdb"; 
Oledb.OledbCommand cmd = new Oledb.OledbCommand(cn); 
cmd.CommandText = "INSERT INTO Customers (FirstName, LastName) VALUES (@FirstName, @LastName)"; 
```

我认为可能会这样做，但我不想手动插入任何东西。我想同时做这两个：

*   获取在 Datagrid 上更改的信息并更新我从中获取的 Access 数据库文件 (.mdb)
*   创建一个函数，允许我从另一个 Access 数据库文件 (.mdb) 中获取表，并将它们替换为辅助 Access 数据库文件 (.mdb)。这两个文件将使用完全相同的结构，但其中包含不同的信息。

我希望有人对此提出答案……我的项目已经完成，等待的只是一个简单的答案。

再次提前感谢您。

**编辑：**

好吧……好消息。我已经想出了如何查询 .mdb 文件本身（我认为）。这是代码，它不起作用，因为由于我尝试使用的 sql 命令而出现运行时错误。这将把我带到我的下一个问题。

**DatabaseHandling.cs 新增功能代码：**

```
static public void performSynchronization(string table, string tableTwoLocation)
{
    OleDbCommand cmdCopyTables = new OleDbCommand("INSERT INTO" + table + "SELECT * FROM [MS Access;" + tableTwoLocation + ";].[" + table + "]"); // This query generates runtime error
    cmdCopyTables.Connection = dataconnectionA;
    dataconnectionA.Open();
    cmdCopyTables.ExecuteNonQuery();
    dataconnectionA.Close();
} 
```

如您所见，我实际上已经设法对连接本身执行查询，我相信它是实际的 Access .MDB 文件。正如我所说，我对文件执行的 SQL 查询不起作用，并且在使用时会产生运行时错误。

我试图执行的命令应该从 .MDB 文件中获取一个表并覆盖不同 .MDB 文件的相同类型的表。我在上面尝试的 SQL 命令试图直接从 .mdb 文件中获取一个表，然后直接将其放入另一个表中——这不是我想要做的。我想从 .MDB 文件中获取所有信息——将表放入数据表中，然后将所有数据表添加到数据集（我已经完成）。我想为两个 .MDB 文件执行此操作。一旦我有两个数据集，我想从每个数据集中取出特定的表并将它们添加到每个文件中，如下所示：

*   DataSetA >>>>----- [添加表（覆盖它们）] ----->>>> DataSetB
*   DataSetB >>>>----- [添加表（覆盖它们）] ----->>>> DataSetA

我想把那些数据集拿走，然后把它们放回它们来自的每个 Access .MDB 文件中。基本上保持两个数据库同步。

所以我的问题，修改后，是：

1.  如何创建一个 SQL 查询，通过覆盖现有的同名表将表添加到 .MDB 文件。查询应该能够在运行时动态创建，该数组用我要添加的表名替换变量。
2.  如何获取 Datagrid 对 DataTable 所做的更改并将它们放回 DataTable（或 DataSet），以便我可以将它们发送到 .MDB 文件？

我试图尽可能详细地说明......因为我相信我没有很好地解释我的问题。现在这个问题已经变得太长了。我只是希望我能更好地解释这一点。:[

**编辑：**

感谢下面的用户，我想我几乎找到了解决方法——关键字*about*。下面是我更新的 DatabaseHandling.cs 代码。我收到运行时错误“数据类型不匹配”。考虑到我正在尝试将这些表复制到另一个具有完全相同设置的数据库中，我不知道这怎么可能。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data.OleDb;
using System.Data;
using System.IO;

    namespace LCR_ShepherdStaffupdater_1._0
    {
        public class DatabaseHandling
        {
            static DataTable datatableB = new DataTable();
            static DataTable datatableA = new DataTable();
            public static DataSet datasetA = new DataSet();
            public static DataSet datasetB = new DataSet();
            static OleDbDataAdapter adapterA = new OleDbDataAdapter();
            static OleDbDataAdapter adapterB = new OleDbDataAdapter();
            static string connectionstringA = "Provider=Microsoft.Jet.OLEDB.4.0;" + "Data Source=" + Settings.getfilelocationA();
            static string connectionstringB = "Provider=Microsoft.Jet.OLEDB.4.0;" + "Data Source=" + Settings.getfilelocationB();
            static OleDbConnection dataconnectionB = new OleDbConnection(connectionstringB);
            static OleDbConnection dataconnectionA = new OleDbConnection(connectionstringA);
            static DataTable tableListA;
            static DataTable tableListB;

            static public void addTableA(string table, bool addtoDataSet)
            {
                dataconnectionA.Open();
                datatableA = new DataTable(table);
                try
                {
                    OleDbCommand commandselectA = new OleDbCommand("SELECT * FROM [" + table + "]", dataconnectionA);
                    adapterA.SelectCommand = commandselectA;
                    adapterA.Fill(datatableA);
                }
                catch
                {
                    Logging.updateLog("Error: Tried to get " + table + " from DataSetA. Table doesn't exist!");
                }

                if (addtoDataSet == true)
                {
                    datasetA.Tables.Add(datatableA);
                    Logging.updateLog("Added DataTableA: " + datatableA.TableName.ToString() + " Successfully!");
                }

                dataconnectionA.Close();
            }

            static public void addTableB(string table, bool addtoDataSet)
            {
                dataconnectionB.Open();
                datatableB = new DataTable(table);

                try
                {
                    OleDbCommand commandselectB = new OleDbCommand("SELECT * FROM [" + table + "]", dataconnectionB);
                    adapterB.SelectCommand = commandselectB;
                    adapterB.Fill(datatableB);
                }
                catch
                {
                    Logging.updateLog("Error: Tried to get " + table + " from DataSetB. Table doesn't exist!");
                }

                if (addtoDataSet == true)
                {
                    datasetB.Tables.Add(datatableB);
                    Logging.updateLog("Added DataTableB: " + datatableB.TableName.ToString() + " Successfully!");
                }

                dataconnectionB.Close();
            }

            static public string[] getTablesA(string connectionString)
            {
                dataconnectionA.Open();
                tableListA = dataconnectionA.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, new Object[] { null, null, null, "TABLE" });
                string[] stringTableListA = new string[tableListA.Rows.Count];

                for (int i = 0; i < tableListA.Rows.Count; i++)
                {
                    stringTableListA[i] = tableListA.Rows[i].ItemArray[2].ToString();
                }
                dataconnectionA.Close();
                return stringTableListA;
            }

            static public string[] getTablesB(string connectionString)
            {
                dataconnectionB.Open();
                tableListB = dataconnectionB.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, new Object[] { null, null, null, "TABLE" });
                string[] stringTableListB = new string[tableListB.Rows.Count];

                for (int i = 0; i < tableListB.Rows.Count; i++)
                {
                    stringTableListB[i] = tableListB.Rows[i].ItemArray[2].ToString();
                }
                dataconnectionB.Close();
                return stringTableListB;
            }

            static public void createDataSet()
            {

                string[] tempA = getTablesA(connectionstringA);
                string[] tempB = getTablesB(connectionstringB);
                int percentage = 0;
                int maximum = (tempA.Length + tempB.Length);

                Logging.updateNotice("Loading Tables...");
                for (int i = 0; i < tempA.Length ; i++)
                {
                    if (!datasetA.Tables.Contains(tempA[i]))
                    {
                        addTableA(tempA[i], true);
                        percentage++;
                        Logging.loadStatus(percentage, maximum);
                    }
                    else
                    {
                        datasetA.Tables.Remove(tempA[i]);
                        addTableA(tempA[i], true);
                        percentage++;
                        Logging.loadStatus(percentage, maximum);
                    }
                }

                for (int i = 0; i < tempB.Length ; i++)
                {
                    if (!datasetB.Tables.Contains(tempB[i]))
                    {
                        addTableB(tempB[i], true);
                        percentage++;
                        Logging.loadStatus(percentage, maximum);
                    }
                    else
                    {
                        datasetB.Tables.Remove(tempB[i]);
                        addTableB(tempB[i], true);
                        percentage++;
                        Logging.loadStatus(percentage, maximum);
                    }
                }

            }

            static public DataTable getDataTableA()
            {
                datatableA = datasetA.Tables[Settings.textA];

                return datatableA;
            }
            static public DataTable getDataTableB()
            {
                datatableB = datasetB.Tables[Settings.textB];
                return datatableB;
            }

            static public DataSet getDataSetA()
            {
                return datasetA;
            }

            static public DataSet getDataSetB()
            {
                return datasetB;
            }

            static public void InitiateCopyProcessA()
            {
                DataSet tablesA;
                tablesA = DatabaseHandling.getDataSetA();

                foreach (DataTable table in tablesA.Tables)
                {
                    CopyTable(table, connectionstringB);
                }
            }

            public static void CopyTable(DataTable table, string connectionStringB)
            {
                var connectionB = new OleDbConnection(connectionStringB);
                foreach (DataRow row in table.Rows)
                {
                    InsertRow(row, table.Columns, table.TableName, connectionB);
                }
            }

            public static void InsertRow(DataRow row, DataColumnCollection columns, string table, OleDbConnection connection)
            {
                var columnNames = new List<string>();
                var values = new List<string>();

                for (int i = 0; i < columns.Count; i++)
                {
                    columnNames.Add("[" + columns[i].ColumnName + "]");
                    values.Add("'" + row[i].ToString().Replace("'", "''") + "'");
                }

                string sql = string.Format("INSERT INTO {0} ({1}) VALUES ({2})",
                        table,
                        string.Join(", ", columnNames.ToArray()),
                        string.Join(", ", values.ToArray())
                    );

                ExecuteNonQuery(sql, connection);
            }

            public static void ExecuteNonQuery(string sql, OleDbConnection conn)
            {
                if (conn == null)
                    throw new ArgumentNullException("conn");

                ConnectionState prevState = ConnectionState.Closed;
                var command = new OleDbCommand(sql, conn);
                try
                {
                    prevState = conn.State;
                    if (prevState != ConnectionState.Open)
                        conn.Open();

                    command.ExecuteNonQuery(); // !!! Runtime-Error: Data type mismatch in criteria expression. !!!
                }
                finally
                {
                    if (conn.State != ConnectionState.Closed
                        && prevState != ConnectionState.Open)
                        conn.Close();
                }
            }

            }          
        } 
```

为什么我会收到此错误？两张表完全相同。我究竟做错了什么？最坏的情况，在插入具有不同值的完全相同的结构表之前，如何删除其他 Access .MDB 文件中的表？

伙计，我希望我能弄清楚这一点......

**编辑：**

好吧，我已经走了一段距离。我的问题已经演变成一个新问题，因此值得单独提问。我已经回答了我的问题，因为现在我知道如何直接对我打开的连接执行查询。谢谢你们！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T22:45:40.460

我不确定你已经走了多远，但如果你正在寻找快速拖放操作，你可能想看看创建一个连接的强类型数据集，并使用 DataSources Tool Window 的拖放功能在 Visual Studio 中。

那里肯定有样品，但你会想要的。

1.  创建一个新的数据集
2.  从服务器资源管理器中的数据连接树中拖放
3.  创建一个新表格
4.  从数据源工具中拖动表格
5.  窗体上的窗口。
6.  瞧

**更新：**

首先，我不是 100% 了解您的问题。如果您可以在最好的访问文件之间创建一些链接表，那么您可以使用 sql 语句在文件之间复制数据，例如“INSERT INTO Customers SELECT FirstName, LastName FROM File2.Customers”。如果不是这样，我认为您将不得不循环 DataTables 并使用类似于您上次编辑的 INSERT 语句手动插入记录。至于数据网格，您可能必须通过监视 RowChanged 事件（不确定这是否是确切事件）来跟踪更改的内容，甚至在行更改时执行插入/更新语句。

**更新：**

循环数据表你会做这样的事情。未测试。我刚刚再次更新它以包含 MakeValueDbReady 函数。这也没有经过测试，我不确定我是否正确处理了所有案例甚至所有案例。您真的必须调试 sql 语句并确保它生成正确的值。每个数据库句柄是不同的值。至少以这种方式提取值解析。我还意识到，您应该能够从 DataTable 上的属性中获取它，而不是对 TableName 进行硬编码

```
void CopyTable(DataTable table, string connectionStringB)
{
    var connectionB = new OleDbConnection(connectionStringB);
    foreach(DataRow row in table.Rows)
    {
        InsertRow(row, table.Columns, table.TableName, connectionB);
    }
}

public static void InsertRow(DataRow row, DataColumnCollection columns, string table, OleDbConnection connection)
{
    var columnNames = new List<string>();
    var values = new List<string>();

    // generate the column and value names from the datacolumns    
    for(int i =0;i<columns.Count; i++)
    {
        columnNames.Add("[" + columns[i].ColumnName + "]");
        // datatype mismatch should be fixed by this function
        values.Add(MakeValueDbReady(row[i], columns[i].DataType));
    }

    // create the sql
    string sql = string.Format("INSERT INTO {0} ({1}) VALUES ({2})",
            table,
            string.Join(", ", columnNames.ToArray()),
            string.Join(", ", values.ToArray())
        );

    // debug the accuracy of the sql here and even copy into 
    // a new Query in Access to test
    ExecuteNonQuery(sql, connection);
}

// as the name says we are going to check the datatype and format the value
// in the sql string based on the type that the database is expecting
public string MakeValueDbReady(object value, Type dataType)
{
    if (value == null)
        return null;

    if (dataType == typeof(string))
    {
        return "'" + value.ToString().Replace("'", "''") + "'"
    }
    else if (dataType == typeof(DateTime))
    {
        return "#" + ((DateTime)value).ToString + "#"
    }
    else if (dataType == typeof(bool))
    {
        return ((bool)value) ? "1" : "0";
    }

    return value.ToString();
}

public static void ExecuteNonQuery(string sql, OleDbConnection conn)
{
    if (conn == null)
        throw new ArgumentNullException("conn");

    ConnectionState prevState = ConnectionState.Closed;
    var command = new OleDbCommand(sql, conn);
    try
    {
        // the reason we are checking the prev state is for performance reasons
        // later you might want to open the connection once for the a batch
        // of say 500 rows  or even wrap your connection in a transaction.
        // we don't want to open and close 500 connections
        prevState = conn.State;
        if (prevState != ConnectionState.Open)
            conn.Open();

        command.ExecuteNonQuery();
    }
    finally
    {
        if (conn.State != ConnectionState.Closed
            && prevState != ConnectionState.Open)
            conn.Close();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T04:02:40.087

*要使用对 DataSet*（不是 DataGrid，因为这只是 DataSet 上的 UI）所做的更改来更新原始 MDB 文件，只需使用[DataAdapter.Update](http://msdn.microsoft.com/en-us/library/system.data.common.dataadapter.update.aspx)命令。

将表从 1 移动到另一个有点棘手。如果目标中不存在该表，则需要使用[SQL CREATE 语句](http://msdn.microsoft.com/en-us/library/bb177893.aspx)创建它。然后，[DataAdapter.Fill](http://msdn.microsoft.com/en-us/library/377a8x4t.aspx)从*源*中填充一个 DataSet 。循环遍历每一行并通过调用 DataRow.SetAdded 将其状态设置为[RowAdded](http://msdn.microsoft.com/en-us/library/system.data.datarow.setadded.aspx)。*然后，将其从目标*数据库传回 DataAdapter.Update 。

编辑：[代码在下一个问题上......](https://stackoverflow.com/questions/520506/how-do-i-structure-an-oledbcommand-query-so-that-i-can-take-tables-from-one-acces/520665#520665)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T22:28:27.343

实际上，扩展名为 .mdb 的文件格式不止一种。所以，如果我猜错了，这将是错误的答案。但是，这听起来像是 Microsoft Access 问题。

您不直接写入 MDB 文件。它们被加密和压缩。修改 MDB 文件最简单的方法是通过 Access 加载它并通过提供的方法复制表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T23:02:35.340

您如何连接到数据库（.mdb 文件）？你能发布一些示例代码吗？如果您正确连接到它，那么您针对它运行的任何 SQL 操作都应该自动保存在数据库中。

因此，在连接到数据库后，您可以执行 SQL 来创建表、插入/更新/检索数据等。尝试手动构建 .mdb 文件是不可取的。

这是一个例子：

[http://www.java2s.com/Code/CSharp/Database-ADO.net/Access.htm](http://www.java2s.com/Code/CSharp/Database-ADO.net/Access.htm)

# html - 可以在 HTML/CSS 中使用部分透明度来制作发光/阴影吗？

> ID：518240
> 
> 赞同：1
> 
> 时间：2009-02-05T22:19:39.903
> 
> 标签：html, css, xhtml

好吧，我想这是一个两部分的问题。

首先，我怎样才能使图像具有部分透明度（我认为您可以使用 PNG 来做到这一点，但不知道如何——我有 photoshop 只需要说明？）

其次，如何在使用 CSS 的布局中使用该图像？我想我需要某种“PNG Hack”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T22:28:15.987

1.  创建一个新的 Photoshop 文档
2.  添加新图层并在其上绘制
3.  删除名为*Background的图层*
4.  文件 > 保存为 Web
5.  选择 24 位 PNG 格式。

让它在 IE6 中运行良好将成为问题。您应该使用一个单独的样式表，该样式表仅通过加载背景图像的条件注释加载 ie6，如下所示：

```
filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src="my_trans_image.png", sizingMethod="crop"); 
```

在您的标准样式表中使用它就像任何其他图像一样：

```
background-image: url(/path/to/my_trans_image.png); 
```

加载包含 IE6 特定规则的样式表，如下所示：

```
<!--[if lt IE 7]>
<link rel="stylesheet" href="/css/ie6.css" type="text/css" charset="utf-8" />
<![endif]--> 
```

这只会在 IE 中加载，并且如果版本小于 7。

最后一点：IE6 正在迅速消失。如果您不需要支持 IE6，那么在普通的旧 CSS 中将 PNG 设置为背景图像将在所有现代浏览器中正常工作，而不会出现任何实际问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T22:25:52.280

可能对您不起作用的简单选项：

Webkit 浏览器（Safari、Chrome）可以使用[`-webkit-box-shadow`](http://webkit.org/blog/86/box-shadow/)CSS3 属性。Firefox 和 IE（当然）尚不支持此功能（或具有特定于供应商的等效项）。

您剩下的其他选项很多，并且在 Internet 上广泛覆盖（因为每个人和他的狗都想使用投影）

[http://www.google.com/search?q=how+to+make+a+drop+shadow](http://www.google.com/search?q=how+to+make+a+drop+shadow)

我要补充一件事：在你搞乱透明 PNG hack 之前，你应该考虑有多少用户仍在使用 IE6，以及让尚未升级的人的网站漂亮对你来说有多重要在 8 年内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T00:26:16.233

典型的 IE PNG 修复实际上会导致 IE 在某些情况下崩溃。除非用户调整了注册表设置。除非您想对某些 IE6 用户隐式不友好，否则请尝试将 VML 用于透明 PNG 图像。[raphael.js 库](http://raphaeljs.com/)是实现这一目标的好方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T22:30:57.197

要解决您的第二个问题：如果您不介意使用一点 JavaScript，您可以使用[png 修复](http://homepage.ntlworld.com/bobosola/pnghowto.htm)JavaScript 文件自动将特定于 IE 的过滤器应用于您的图像。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T22:29:19.527

嗯，这就是想法 - 你需要创建透明的 PNG。我通常使用[Paint.NET](http://paint.net/)来处理这类事情，但如果您觉得使用 Photoshop 更舒服，请继续。你所需要的只是在你的图像上有一个透明的背景，然后在上面放置一些半透明的暗像素，这将成为阴影。

您可以通过 background-image 属性使用带有 CSS 的图像。那是：

```
#myDiv
{
    background-image: url('myimage.png');
} 
```

IE6 不支持开箱即用的 PNG 透明度 - 谷歌 IE6 PNG hack 或者只是搜索这个站点。另外，请注意，**即使 IE7 支持 PNG 透明度，它也非常慢**，因此它几乎无法用于阴影等高级效果。您可能希望为 Internet Explorer 提供一些更基本的后备样式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T00:01:43.287

确保您的发光/阴影使用“正常”的混合模式。其他混合模式，如乘法或屏幕，在 Photoshop 中非常棒，但在网络上看起来不像预期的那样。

如果您需要支持 IE6，则需要某种 PNG 修复解决方案。这篇文章列出了几个：[是否有针对 IE6 的 JavaScript PNG 修复程序，允许 CSS 背景定位？](https://stackoverflow.com/questions/86545/is-there-a-javascript-png-fix-for-ie6-that-allows-css-background-positioning/480085)

我个人最喜欢的是：[http ://www.dillerdesign.com/experiment/DD_belatedPNG/](http://www.dillerdesign.com/experiment/DD_belatedPNG/)

# performance - 如何加速一个大多数页面资源已经被浏览器缓存的网站

> ID：518248
> 
> 赞同：1
> 
> 时间：2009-02-05T22:23:01.723
> 
> 标签：performance, web-applications

我想改善网站的页面加载时间。它是一个 Web 应用程序（想想像 Web 邮件之类的东西），用户相对较少会长时间使用该站点。

由于几乎所有页面请求都来自已经使用该站点的用户，因此图像、css 和外部 javascript 资源将在之前的请求期间被浏览器缓存。由于浏览器不需要再次请求这些资源，我是否正确，以下性能提示*不会*给我任何响应速度的改进？：

*   CSS 精灵
*   使用备用域名并行下载图像
*   Javascript 的位置包括在页面的底部

有没有人有任何性能提示可能会提高这种网站的响应时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T22:29:13.690

这是加速 Web 应用程序的好资源： [Yahoo：加速网站的最佳实践](http://developer.yahoo.com/performance/rules.html)

为了从客户端缓存中受益，请确保按照这些做法的说明发送“Expires”和“Cache-Control”标头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T22:57:23.510

您的意思是该网站已经在客户端缓存中，因此在他们一次性下载后，随后的加载时间将可以忽略不计，您如何在那里进行优化？

在这种情况下，我可以提出一些建议。首先，减少对服务器的 HTTP 请求数。这表示：

1.  如果客户想要到达服装 > 男士 > 鞋履，请使用弹出式菜单帮助他们更快地到达那里（当然，除非您想强制使用风景优美的路线）。
2.  在同一个 HTTP 请求中加载所有内容（重复用户一次点击），然后用户 JS 按需隐藏/显示信息。

其次，您可以使用 AJAX，这样客户端就不必在每次从服务器收到响应时重新绘制整个屏幕。

第三，您可以设置较长的缓存过期时间，这样客户端就不会很快检查更新。这将进一步优化已经存在的缓存层。

顺便说一句，即使图像已经被缓存，我仍然认为将它们托管在不同的服务器上会带来更好的性能。原因是浏览器限制了从一个域并行下载的数量，它仍然需要检查图像是当前的还是过期的（使用 HEAD 请求）。因此，将它们托管在多个域上将使这部分任务更快。不过这里可能是错误的，浏览器可能会以不同的方式处理这种特定情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T22:38:30.427

我认为你需要做一些分析。首先确定您希望支持的所有浏览器是否*真的*会缓存您希望它们缓存的内容（如果需要，请在请求期间检查您的网络流量）。一些浏览器有有趣的缓存规则。如果这里有任何问题，请修复它们！

接下来，检查每个请求正在检索的内容。如果您的 HTML/CSS/Javascript 过于冗长，则需要发送更多数据，并为客户端处理更多数据。

查看服务器端、网络端和客户端的时序。查看服务器提供静态文件需要多长时间，以及脚本运行多长时间。查看服务器和客户端之间的往返时间是否相当短（在某些情况下，您可能希望重新定位服务器）。还要确保您的页面在客户端呈现时不会很慢，无论是由于脚本缓慢、内容过多还是呈现复杂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T22:38:55.450

要真正了解您的客户发生了什么，您需要使用 Wireshark（或等效的）来观察发生的传输。这将准确地告诉您该客户端在第一个请求和后续请求中获取了什么，以及哪些请求需要很长时间才能为客户端接收。

# c# - 如何在 VS 类设计器中创建自动实现的属性

> ID：518252
> 
> 赞同：7
> 
> 时间：2009-02-05T22:24:14.887
> 
> 标签：c#, visual-studio

我在 Visual Studio 2008 中使用类设计器，当我向我的类添加属性时，它们是使用一个空的 setter 和一个引发 NotImplementedException 的 getter 创建的。在属性窗口中有一个名为“Auto-Implemented”的选项，它始终是灰色的。有没有办法更改此设置，因此默认情况下新属性将自动实现或以某种方式打开此选项，这样我每次添加新属性时都不必继续编辑代码？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-05T22:43:59.107

AFAIK，你不能。大约一年前我在巴塞罗那问过这个问题——我认为没有任何改变。基本上，据我了解，这是直接完成的（而不是通过可编辑的片段）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-17T18:20:02.143

对于 Visual Studio 2008，您可以安装此“强力玩具”，为您提供另一个选项来选择类设计器菜单“创建自动实现的属性”

[http://modeling.codeplex.com/](http://modeling.codeplex.com/)

我也会等到 Visual Studio 2010……否则太烦人了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T23:19:01.687

您可以创建字段并将其封装（Refactor->Encapsulate field）。
这有助于简单的属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-04T19:38:09.620

您还可以使用片段创建属性`propfull`，然后使用 Tab、Tab。

# grails - 在 Grails 中使用外部 log4j.properties 文件

> ID：518254
> 
> 赞同：6
> 
> 时间：2009-02-05T22:25:21.610
> 
> 标签：grails, log4j

在 Grails 中使用外部 log4j.properties 文件的最佳方式是什么？我想使用传统的 log4j.properties 格式而不是 log4j.groovy 样式的配置。

我也很好奇外部配置是否可以很好地与由`grails war`war 文件创建并放入的 log4j.properties 文件配合使用。如果我从 Config.groovy 中删除 log4j 配置，log4j.properties 是否仍会放入 war 文件中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T18:12:46.633

在 Grails 1 和 2 中，有一个在开箱即用的 webapp 中配置和使用的[日志记录 DSL](http://grails.org/doc/latest/guide/conf.html#logging)，因此您需要`log4j = { ... }`从`grails-app/conf/Config.groovy`

如果您想像在典型的 Java Web 应用程序中那样使用外部配置文件进行日志记录，请`grails-app/conf/spring/resources.groovy`使用以下内容更新该文件。

```
beans = {
    log4jConfigurer(org.springframework.beans.factory.config.MethodInvokingFactoryBean) {
        targetClass = "org.springframework.util.Log4jConfigurer"
        targetMethod = "initLogging"
        arguments = ["classpath:log4j.properties"]
    }
} 
```

请注意，Log4j appender 配置中使用的包名称可能不是您所期望的，因为它会添加一个特定于 Grails 的前缀...

```
WARN grails.app.controllers.org.example.BookController - This is a warn log message from BookController
ERROR grails.app.controllers.org.example.BookController - This is an error log message from BookController 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T01:24:45.817

如果您使用的是 1.0.x 系列：

*   将 War.groovy 从 $GRAILS_HOME/scripts 复制到您的 $APP/scripts
*   注释掉复制的 War.groovy 的第 145 和 154 行
*   将您的 log4j.properties 放入 $APP/grails-app/conf
*   运行 $ grails war，它会提示您选择要运行的 War 脚本，然后选择您的本地脚本（通常是 #1）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T01:00:22.920

查看[Log4J Plugin](http://www.grails.org/Log4j+XML+Plugin)其中状态：

“一些老式的 Java 开发人员更喜欢 log4j.xml，即使配置文件要大得多。这个插件提供了一种方法来禁用默认的 Log4j DSL，并允许使用原始形式的 log4j.xml，或者Groovy MarkupBuilder 风格。”

我自己没有使用过它，所以无法说明它在 WAR 上下文中的可用性。只需 WAR 启动您的应用程序，然后尝试一下。它应该位于 WEB-INF 文件夹下的某个明显位置。如果这不起作用，*[grails 用户列表](http://grails.org/Mailing+lists)*上的*Mingfai*可能会帮助您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-19T08:36:20.483

至少在 1.0.x 系列（未在 1.1 中检查）忘记 Grails 支持并直接依赖 Spring。只需使用 web.xml 中的 log4jConfigLocation 参数即可。更多信息[在这里](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/web/util/Log4jWebConfigurer.html)

# assembly - x86指令“call dword ptr ds:[00923030h]”是什么意思？

> ID：518261
> 
> 赞同：10
> 
> 时间：2009-02-05T22:27:32.883
> 
> 标签：assembly, x86, addressing-mode

下面的 x86 汇编指令有什么作用？

```
call dword ptr ds:[00923030h] 
```

我怀疑这是一个间接调用，但它究竟是如何计算调用地址的呢？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-05T22:38:28.040

**[编辑] 更新**

每当您看到类似于 的内存操作数时`ds:0x00923030`，这就是一种*相对于段的*寻址模式。`ds`被引用的实际地址 tp 位于相对于段寄存器的基地址的线性地址 0x00923030 。

x86 架构中的内存分割有点令人困惑，我认为[Wikipedia](http://en.wikipedia.org/wiki/X86_memory_segmentation)很好地解释了它。

基本上，x86 有许多特殊的*段*寄存器：（`cs`代码*段*）、（`ds`数据*段*）`es`、、、、和（*堆栈*段）。每个内存访问都与某个段寄存器相关联。通常，您不指定段寄存器，并且根据访问内存的方式，使用默认的段寄存器。例如，寄存器用于读取指令。`fs``gs``ss`*`cs`*

 *每个段寄存器都有一定的*基地址*和*限制*。基地址决定了线性地址 0x00000000 对应的物理地址，限制决定了该段允许的最大线性地址。例如，如果基地址为 0x00040000，限制为 0x0000FFFF，则唯一有效的线性地址将是 0x00000000 到 0x0000FFFF，对应的物理地址将是 0x00040000 到 0x0004FFFF。

因此，被调用的子程序所在的物理地址由存储在`ds`段寄存器中的基地址加上 0x00923030 给出。但我们还没有完成——指令中有这个词`ptr`。这增加了一个额外的间接级别，因此子例程的实际目标是*存储*在 location的地址`ds:0x00923030`。

在 AT&T 语法（被 GNU 汇编器接受）中，该指令将编写如下：

```
lcall *ds:0x00923030 
```

有关该指令作用的完整详细信息，请参阅[80386 参考手册](http://pdos.csail.mit.edu/6.828/2008/readings/i386/CALL.htm)。该指令的特定变体是`"CALL r/m16"`（调用近寄存器间接/内存间接）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-06T01:18:37.063

此特定操作码通过位于逻辑地址指向的位置的虚拟地址（此处为 32 位）进行调用`ds:[00923030h]`。
逻辑地址由两部分组成：

1.  一个 16 位的段选择器，在本例中为 ds，它基本上是操作系统管理的（全局/本地）描述符表的索引。这样的选择器还保存在访问时检查的给定段的访问权限信息（当前特权级别，[CPL](http://en.wikipedia.org/wiki/Ring_(computer_security))）
2.  一个 32 位
    的偏移量 最终地址计算如下：从选择器获取的基地址 + 偏移量

请注意，上面的计算表示线性地址，*而不是*物理地址（参见英特尔手册[第 3a 卷](http://www.intel.com/design/processor/manuals/253668.pdf)，图 2.2），然后通过 4KB 分页的标准机制进行转换，即地址由页面目录的索引组成，page表和所选页面的偏移量。但请记住，所有主流操作系统都使用所谓的平面内存模型，这意味着所有段选择器都指向地址 0x00000000，限制设置为 0xFFFFFFFF，这就是您可以在所有段之间进行转换并最终导致的原因（容易）利用缓冲区溢出。

您给出的汇编指令很可能是通过可执行文件的导入地址表（有关更多详细信息，请参阅[这篇](http://msdn.microsoft.com/en-us/magazine/cc301805.aspx)精彩的文章）的调用，即这不太可能是序数子程序调用。
像这样的代码是由编译器发出的，因为从外部 dll 导入的函数的最终虚拟地址在编译时通常是未知的（由于 dll 的变基）。通过使用这样的调用构造，操作系统加载程序可以在逻辑地址指向的地址指针处插入正确的虚拟地址，并且编译器不需要关心最终函数具有哪个地址。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-12-28T04:28:26.200

`call dword ptr ds:[00923030h]`, 表示`call`指针`00923939h`中的某些值`data segment`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T22:41:34.807

IIRC，它获取 DS 寄存器的值（并将其左移 4 位），将给定的立即值相加，从生成的内存位置获取一个 dword 值，该值成为要调用的地址。（编辑：这适用于 16 位实模式，对于保护模式，请参阅其他答案。）

# java - 使用列表获取器的休眠 HQL

> ID：518267
> 
> 赞同：1
> 
> 时间：2009-02-05T22:28:57.233
> 
> 标签：java, hibernate, annotations, hql

我有一个 Hibernate 实体，它的 getter 映射为 @OneToMany：

```
@Entity
class Parent extends BaseParent {

    @OneToMany(cascade = {CascadeType.ALL}, mappedBy = "parent")
    public List<Child> getChildren() {
        return super.children;
    }

    public void setChildren(List<Child> list) {
        super.children = list;
    }
} 
```

当我尝试执行一些 HQL 时，例如：

```
select p 
from Parent p 
left join p.children c
where c.name='foobar' 
```

我得到以下异常：

```
org.springframework.orm.hibernate3.HibernateQueryException: could not resolve property: children of: ....Parent 
```

如果我将 @OneToMany 注释放在受保护的字段上，则查询有效。我怎样才能让它工作，以便可以将注释放在吸气剂上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T04:07:50.217

您可能会遇到与注释中的字段和方法混合相关的问题。例如，如果你的父类 BaseParent 中有一个 @Id 注释，那么 Hibernate 默认会查看字段而不是方法。

所以基本上如果你有这样的事情：

```
public class BaseParent {
    @Id
    private Integer id;

    protected List<Child> children;
}

public class Parent extends BaseParent {
    @ManyToOne
    public List<Child> getChildren() {super.getChildren();} 
} 
```

Hibernate 在确定 @ManyToOne 注释时会遇到问题。此外，这可能可以解释为什么将注释添加到父类中的字段使其工作。

在上面提到的同一页面上（[http://docs.jboss.org/ejb3/app-server/HibernateAnnotations/reference/en/html_single/index.html#d0e253](http://docs.jboss.org/ejb3/app-server/HibernateAnnotations/reference/en/html_single/index.html#d0e253)），还有这一段：

> 根据您是否注释字段或方法，Hibernate 使用的访问类型将是字段或属性。EJB3 规范要求您在将被访问的元素类型上声明注释，即，如果您使用属性访问，则为 getter 方法，如果您使用字段访问，则为字段。**应避免在字段和方法中混合使用 EJB3 注释**。Hibernate 会从@Id 或@EmbeddedId 的位置猜测访问类型。

因此，要让它发挥作用，您可能希望选择其中一个（字段与方法）并保持一致。这样，您就不会遇到这些“奇怪”的休眠问题。

无论如何，希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T00:47:12.117

当您在 @OneToMany 注释中有“mappedBy”属性时，这意味着您将拥有一个**双向**映射。您需要在孩子身上设置“父母”的 get/set 或字段。例子：

```
@Entity
public class Parent {
    @OneToMany(mappedBy="parent")
    public Set<Child> getChildren() {
    ...
}

@Entity
public class Child{
    @ManyToOne
    public Parent getParent() {
    ...
} 
```

见：[http ://www.hibernate.org/hib_docs/annotations/reference/en/html_single/#d0e1177](http://www.hibernate.org/hib_docs/annotations/reference/en/html_single/#d0e1177)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T02:16:38.880

我建议阅读 Hibernate 文档中有关注解的以下部分：

[http://docs.jboss.org/ejb3/app-server/HibernateAnnotations/reference/en/html_single/index.html#d0e253](http://docs.jboss.org/ejb3/app-server/HibernateAnnotations/reference/en/html_single/index.html#d0e253)

在这种情况下，您可能可以在类级别添加 @AccessType("property") 注释，它告诉 Hibernate 扫描此类的 getter。

如果这不起作用，请阅读文档以查看是否有更适合您的特定问题的内容。如果没有看到整个实体层次结构，很难给你一个准确的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T13:06:49.740

是的，我需要 @AccessType("property") 注释。但是第二个答案也是正确的：我现在遇到了关联问题。这是很好的信息，感谢您的帮助！

# bash - cygwin互操作问题

> ID：518268
> 
> 赞同：1
> 
> 时间：2009-02-05T22:29:08.730
> 
> 标签：bash, shell, command-line, interop, cygwin

我不太确定如何搜索以便自己找到答案的几个 Cygwin 问题：

*问：*我跑步的时候

```
which perl 
```

在我的 cygwin 安装中，它不指向我预装的 windows 安装，它指向 cygwin 之一。我怎样才能改变它，使它指向我基于*Windows*的 perl 安装：

```
/cygdrive/c/perl/bin/perl 
```

*问题：*当我查看调用 cygwin 的桌面快捷方式时，它指向 bash：

```
c:\cygwin\bin\bash --login -i 
```

我找不到允许的命令行标志的文档。具体来说，我想找到一个允许我传入预定义用户命令的标志，这样当 cygwin 启动时，该命令会自动调用，而无需我输入。

这是我想定期定制的东西，所以把它放在 .bash_profile 或类似的东西中效率不高。如果可能的话，我希望能够从命令行指定它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T22:35:12.510

第一点的答案是确保本机 win32 perl 出现在路径中的 cygwin 之前。

第二部分的答案是`-c`执行命令行上提供的命令。命令标志与标准 bash 相同，因此`man bash`或任何 bash 文档都会为您提供它们的列表。

顺便说一句，如果您将本机 win32 应用程序与 cygwin 混合和匹配，请查看[UnxUtils。](http://unxutils.sourceforge.net/) 它基于[`msvcrt.dll`](http://msdn.microsoft.com/en-us/library/abx4dbyh(VS.80).aspx)而不是`cygwin.dll`因此程序将与标准 Windows 路径很好地配合使用（例如`C:\foo\bar`，而不是需要 /cygdrive 路径之类的`/cygdrive/c/foo/bar`）。

它不如 Cygwin 全面，但成熟且稳定，并且具有基本 unix 命令（sed 等）的良好横截面。它可以很好地与 windows 命令文件配合使用（您可以进行管道和重定向）并且有一个端口[zsh](http://www.zsh.org/)与它一起运行，因此它也将运行 shell 脚本，尽管 zsh 与 bash 不完全兼容。

# c# - 我可以将 XText 对象更改为具有字符引用和实体解析的字符串吗？

> ID：518281
> 
> 赞同：1
> 
> 时间：2009-02-05T22:31:48.023
> 
> 标签：c#, .net, xml, linq, linq-to-xml

鉴于此 XML：

```
<element>Circles &amp; boxes</element> 
```

我想做的是将元素的字符串值存储为字符串，所有字符引用和实体都解析为其等效的 unicode 字符。所以，对于这个元素，我想要“Circles & Boxes”。

当我这样做时（文本是表示文本节点的 XText 对象）：

```
string textvalue = text.ToString(SaveOptions.DisableFormatting); 
```

我得到“圆圈和盒子”，这不是我想要的。

这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-08T11:10:42.653

如何使用：

```
string textvalue = text.Value; 
```

# javascript - 可以让 IE7 重新加载 DOM 吗？尝试更新链接标签中的 RSS href url

> ID：518283
> 
> 赞同：2
> 
> 时间：2009-02-05T22:32:17.383
> 
> 标签：javascript, jquery

我可以使用这个 jQuery 代码在 Firefox 和 Chrome 中动态更改 DOM 中的 RSS 链接。[http://path.com/feed](http://path.com/feed)通常被一个变量替换，但在这个例子中没有。

```
$('#rssfeed').remove();
$('head').append('<link id="rssfeed" rel="alternate" type="application/rss+xml" href="http://path.com/feed"/>'); 
```

实时书签功能会立即更新。但是，这在 IE7 中不起作用。在 IE7 中我尝试过这种方法，还在 html 中创建了一个并尝试使用 .setAttribute(href,'path.com/feed') 进行更新，并尝试创建一个新的 DOM 元素并将其附加到“<_head>”（否_ 在实际代码中，当然）。

我唯一的“成功”是做一个document.write。最大的问题是页面加载后我无法更改它。

任何人都可以推荐一种替代方法来更改链接元素 href 并让它由 IE7 动态重新加载吗？或者，有没有办法强制浏览器重新解释或重新加载 DOM 而无需进行整页刷新？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-06T17:33:40.257

不幸的是，您的问题的简短回答是“否”和“排序”，因为缺乏浏览器支持更新在 IE 和 Firefox 中修改/添加/删除的提要列表。

首先，为了`HEAD`在 IE 中向文档添加元素（记住这也适用于 CSS），您必须确保指定 jQuery 的元素选择器返回的数组中的第一项（注意使用[eq(index )](http://docs.jquery.com/Selectors/eq)选择器):

```
$('head:eq(0)').append('<link id="rssfeed" rel="alternate" type="application/rss+xml" href="http://path.com/feed" title="Path (RSS)">'); 
```

注意：我发现包含该`TITLE`属性可以更轻松地查看更改。

虽然您可以更改IE 和 Firefox 中的`HREF`属性（通过 DOM），*但两者都*不会更新 RSS 图标菜单。*但是*，您可以**添加**元素，它们将被 RSS 图标菜单识别，但旧条目将保留，因为 Firefox 仅在*添加*s时构建该菜单。`LINK` ****`LINK``LINK`****

 *****有关更多信息，请参阅以下链接：

*   [询问 MetaFilter - Firefox 和 Javascript 问题](http://ask.metafilter.com/54377/Firefox-and-Javascript-issue)
*   [Firefox 错误 380639：动态删除提要/元素 (DOMLinkRemoved) 不会导致提要发现菜单更新](https://bugzilla.mozilla.org/show_bug.cgi?id=380639)
*   [Firefox 错误 396056：对现有元素的 DOM 更改不会触发 RSS 自动发现菜单更新](https://bugzilla.mozilla.org/show_bug.cgi?id=396056)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T14:21:12.377

```
$('#rssfeed').attr('href, 'http://path.com/feed?id=25463456'); 
```

使用随机 id 设置 url 意味着它不应该被缓存，因为它以前从未访问过该 url。这也不应该影响您的提要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T07:04:51.187

如果您使用 innerHTML 完全替换 head 标签的内容（或者甚至在现有链接上使用 outerHTML）怎么办？不确定它是否会起作用（而且我在 Linux 机器上），但它可能值得一试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T14:11:18.350

在 IE 中，这可能有效：

document.write(document.all[0].innerHTML);

# layout - LaTex中的浮动和图片问题

> ID：518284
> 
> 赞同：5
> 
> 时间：2009-02-05T22:32:36.960
> 
> 标签：layout, latex, figure

图片在表头位置： http: [//dl.getdropbox.com/u/175564/%20latex1.png](http://dl.getdropbox.com/u/175564/%20latex1.png)

代码：

```
\begin{figure}
   \subfloat[A gull]{\label{fig:gull}\includegraphics[width=0.15\textwidth]{p1.png}}
   \subfloat[A tiger]{\label{fig:tiger}\includegraphics[width=0.15\textwidth]{p2.png}}
   \caption{Pictures of animals}      
   \label{fig:animals}      
\end{figure} 
```

\begin{document} 之前的代码：

```
\documentclass[12pt,a4paper, notitlepage]{article}
\usepackage[english]{babel}           
\usepackage[latin1]{inputenc}   

\usepackage{amsmath}            
\usepackage{amsfonts}           
\usepackage{amssymb}

\usepackage{graphicx}
\usepackage{amsthm}
\usepackage{fancyhdr}

\usepackage{verbatim}           % by \begin{comment}---\end{comment}
\usepackage{subfig}                
\usepackage{lastpage}

\usepackage{fancyhdr}
\usepackage{float}
\usepackage{subfig}

\floatstyle{ruled}
\newfloat{program}{thp}{lop}   

\floatname{program}{Program}
\cfoot{\ }  
\renewcommand{\headrulewidth}{0pt} 

\renewcommand{\footrulewidth}{0pt}
\title{Applying a} 
```

问题的原因可能是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-05T23:10:44.403

数字*浮动*。

也就是说，TeX 移动它们以适应其排版需求。您可以选择指定您希望 TeX*尝试*使用哪些类型的位置：

```
\begin{figure}[htpb]
   ...
\end{figure} 
```

选项的含义是：

```
h -- here
t -- top
b -- bottom
p -- page (on a page-o-floats)
H -- Absolutely right here (but requires the `float` package) 
```

在选项中使用`!`将告诉 TeX 尽量将其放在源文件中与它相邻的东西附近*。*默认定位是`tbp`，因此除非您要求，否则“这里”甚至不是一个选项。另请注意，选项的顺序无关紧要，因此`[p!bh]`将给出与 相同的结果`[!hbp]`。

所以试试**`\begin{figure}[h!]`**（或者**`\begin{figure}[H]`**如果你已经完成了`\usepackage{float}`）

相同的选项可用于表和您定义的任何其他浮点数。

# c# - 如何在 C# 中使用“使用”捕获异常

> ID：518292
> 
> 赞同：37
> 
> 时间：2009-02-05T22:34:24.697
> 
> 标签：c#, sql, ado.net

鉴于此代码：

```
using (var conn = new SqlConnection("..."))
{
    conn.Open();
    using (var cmd = conn.CreateCommand())
    {
        cmd.CommandText = "...";
        using (var reader = cmd.ExecuteReader())
        {
            while (reader.Read())
            {
                // ...
            }
        }
    }
} 
```

我习惯于为我的数据访问编写 try/catch/finally 块，但是，我正在接触“使用”，这似乎是一种更简单的方法。但是，我试图弄清楚如何捕获可能发生的异常。

你能给我一个例子来说明你如何捕捉异常吗？

**编辑添加：**

我被引导相信“使用”是我的 try/catch/finally 块的替代品。我知道 using 不会捕获异常。那么这是如何替代的呢？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-02-05T22:38:36.950

`using`不是为捕获异常而设计的；它旨在为您提供一种简单的方法来将`try`/包裹`finally`在需要处理的对象周围。如果您需要捕获和处理异常，则需要将其扩展为完整的`try`/ `catch`/或在整个事物周围`finally`放置一个包含`try`/ 。`catch`

* * *

要回答您的编辑（是/ /`using`的替代品？）那么不，不是。大多数情况下，使用一次性资源时，您不会在那里处理异常，因为通常您无能为力。因此，它提供了一种方便的方法来确保清理资源，而不管您尝试做什么工作。`try``catch``finally`

通常，处理一次性资源的代码工作的级别太低，无法确定失败时的正确操作，因此异常会传播给可以决定采取什么操作（例如重试、失败、记录等）的调用者.)。您倾向于将块与一次性资源一起使用的唯一地方`catch`是您是否要转换异常（我假设这就是您的数据访问层正在执行的操作）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-05T22:57:09.937

这...

```
using (var cmd = new SqlCommand("SELECT * FROM Customers"))
{
    cmd.CommandTimeout = 60000;
    ...
} 
```

...对于这个*几乎在*语义上相同（即句法糖）：

```
{
    SqlCommand cmd = new SqlCommand("SELECT * FROM Customers");
    try
    {
        cmd.CommandTimeout = 60000;
        ...
    }
    finally
    {
        if (cmd is IDisposable disposable)
        {
            disposable.Dispose();
        }
    }
} 
```

注意：

*   `cmd`无法重新分配本地，这是 C# 具有“只读本地”（以及 ）的少数情况之一`foreach`。
*   外大括号 ( `{`and `}`) 定义了一个匿名范围（也称为*复合语句*或只是一个“块”），它限制了它的词法范围，`cmd`因此在它被释放后它不能被名称引用（但你仍然*可以*给它取别名，如果你真的很想）。
*   而编译器将执行“正在`IDisposable" check at compile-time (otherwise the` 使用`statement will not compile), a hidden implicit conversion to`IDisposable `is necessary in case the subject (`cmd `) only _explicitly_ implements` IDisposable `instead of via a public`void Dispose()”方法。

因此，当人们告诉您“使用”是 try/catch/finally 的替代品时，他们暗示您应该使用长手形式，但在您的 catch 块中添加：

```
var cmd = new SqlCommand("SELECT * FROM Customers");
try
{
    cmd.CommandTimeout = 60000;
    ...
}
catch (Exception ex)
{
    ...//your stuff here
}
finally
{
    if (cmd != null)
        cmd.Dispose();
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-05T22:42:38.437

将所有 using 语句包装到 try/catch 中。就像其他人所说的那样，使用是为了清理实现 IDisposable 接口的类

```
try
{

 using (var conn = new SqlConnection("..."))
 {
    conn.Open();
    using (var cmd = conn.CreateCommand())
    {
        cmd.CommandText = "...";
        using (var reader = cmd.ExecuteReader())
        {
            while (reader.Read())
            {
                // ...
            }
        }
    }
 }
}
catch(Exception ex)
{
//Handle, log, rethrow exception
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-05T22:39:27.057

如果你想在那里捕获异常，你可能应该回到使用 try/catch/finally。只需将 .Dispose() 调用放在 finally 块中。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-05T22:37:31.867

using 语句与异常无关。使用块只是确保在使用块中的对象退出该块时调用 Dispose。IE：

```
using(SqlConnection conn = new SqlConnection(conStr))
{
   //use conn
}//Dispose is called here on conn. 
```

如果打开连接引发异常（或该块中的任何其他内容），它仍然会冒泡到顶部，并且就像任何其他未经处理的异常一样。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-05T22:49:35.147

您仍然可以像以前一样捕获（或忽略）异常。关键是您不再需要担心处理数据库连接。

即，如果您的应用程序要求您出于其他原因（例如，日志记录）捕获异常，则继续，但如果您只想处理数据库连接，则不再需要这样做：

```
using (SqlConnection conn = new SqlConnection(...))
{
    // do your db work here
    // whatever happens the connection will be safely disposed
} 
```

如果您出于其他原因想要捕获异常，您仍然可以这样做：

```
try
{
    using (SqlConnection conn = new SqlConnection(...))
    {
        // do your db work here
        // whatever happens the connection will be safely disposed
    }
}
catch (Exception ex)
{
    // do your stuff here (eg, logging)
    // nb: the connection will already have been disposed at this point
}
finally
{
    // if you need it
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-08-22T09:38:36.190

将块放入`try catch`块中`using`。它们用于对象配置的隐式`finally`语句将在外部块`catch`语句及其内容之前执行。

# php - 在 PHP 中处理在不同时区存储/显示日期的最佳方法？

> ID：518296
> 
> 赞同：29
> 
> 时间：2009-02-05T22:36:15.173
> 
> 标签：php, mysql, datetime, date, timezone

在过去的几个小时里，我一直在阅读这个主题，我想我已经掌握了它，但我想要一些确认。

**情况**

我希望加利福尼亚州的用户能够发布将存储在 MySQL 中的评论。然后，我希望德克萨斯州的用户能够查看评论，并将发布日期调整为他或她的时区。

**建议的解决方案**

*存储*

1.  在应用程序启动时运行以下命令，以便所有日期函数都使用 UTC 时区：`date_default_timezone_set('UTC');`
2.  `$Date = new DateTime();`以 UTC 获取具有当前日期和时间的 DateTime 对象。
3.  用于`$Date->format()`获取要插入 MySQL 中日期时间类型列的值。

*显示*

1.  从 JavaScript 中获取用户的时区信息并将其存储在 cookie 中。
2.  运行 MySQL SELECT 查询以检索日期时间列值。
3.  `$Date = new DateTime($row['time']);`用存储的 UTC 时间实例化一个 DateTime 对象。
4.  `$Date->setTimezone(new DateTimeZone($userTimezone));`将 UTC 时间调整为用户的时区。
5.  显示使用`$Date->format();`

这就是必须要做的事情的要点吗？我错过了更好的解决方案吗？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-05T23:08:41.443

它还可以变得更简单。既然您使用的是 JavaScript，那么为什么不使用 JavaScript 来调整客户端的时区呢？

1.  将服务器上的所有时间存储为 UTC
2.  将它们作为 UTC 提供给客户
3.  客户端使用 JavaScript 将时间调整为本地时区

这不仅使事情变得更简单，而且还克服了模型的问题。如果我在纽约注册了账户但去澳大利亚旅行，我想查看澳大利亚时区的时间。事实上，使用您使用的 JavaScript 可以轻松调整设置，使设计更加动态。其次，您可以避免存储用户时区的开销。

也就是说，如果您希望您的设计降级到非 JavaScript 浏览器，那么您最好采用完全依赖 HTTP cookie 的服务器端方法（而不是依赖 JS 来获取 cookie）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T22:43:25.893

你做这一切的权利。以 UTC(GMT+0) 存储所有日期，从数据库中检索它们并应用用户的偏移量。

从本质上讲，您已经从头到尾都涵盖了所有内容，实际上没有什么可添加的，我认为您无法优化它超出您已经做的事情。

# asp.net - CSRF 验证令牌：会话 id 安全吗？

> ID：518313
> 
> 赞同：7
> 
> 时间：2009-02-05T22:39:25.013
> 
> 标签：asp.net, security, csrf

在 asp.net 中，我正在实现一个 IHttpModule 来减轻 CSRF 攻击。它向响应 html 中注入一个隐藏的表单参数，其中包含 GET 上的 asp.net SessionID。然后在 POST 上检查以确保隐藏参数的值与当前 SessionID 匹配。据我所知，获取 SessionID 值的唯一方法是从 cookie 中获取，恶意站点无法读取或确定该 cookie。有什么我忽略的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-05T23:03:08.473

这种方法是正确的。您需要确保通过 GET 操作可用的所有操作都是“安全的”（无论如何这是最佳实践），因为您仅将 XSRF 保护应用于 POST。

为了额外的保险，您也可以在 GET 上使用它（通过向所有链接添加 URL 参数，并在每个 GET 请求中检查它），但这很麻烦。

如果您比较偏执，您可以为备用 ID 选择不同的随机数。即使浏览器错误地使您的会话 cookie 可被其他站点上的某些恶意 Javascript 访问，这也会保护您。创建会话时，选择另一个大随机数并将其存储在您的会话中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-05T23:01:46.980

理想情况下，您希望使用会话 ID 以外的其他内容，但基本上就是这样。OWASP 建议使用存储在用户会话中的随机表单元素名称。这样，攻击者甚至无法伪造正确的隐藏字段。

[http://www.owasp.org/index.php/Top_10_2007-A5#Protection](http://www.owasp.org/index.php/Top_10_2007-A5#Protection)

# c# - 在设计器中查看表单时出现错误 - 我该如何避免这种情况？

> ID：518323
> 
> 赞同：2
> 
> 时间：2009-02-05T22:43:46.253
> 
> 标签：c#, .net, winforms, windows-forms-designer

当我在设计器中加载某些表单时，它们会显示错误。这是因为在它们的构造函数中，它们使用从配置文件加载的系统设置。当表单在设计器中加载时，它使用一些随机路径，不出所料，配置文件不存在。

例如。找不到配置文件 C:\Documents and Settings\Rory\Local Settings\Application Data\Microsoft\VisualStudio\8.0\ProjectAssemblies\it3dtcgg01\PrioryShared.dll.config。

有什么方法可以解决这个问题，以便表单在设计器中正确显示？例如：

```
if (!inDesignerMode) 
{ 
    loadSettingsFromConfigFile();
} 
```

更新：好的，我仍然收到此错误。组成是这样的

*   MyForm.cs

    *   我的自定义控件.cs

在 MyCustomControl 的构造函数中，我放了

```
if (!this.DesignMode)
{
    // Get settings from config file   <- this is where the error occurs
} 
```

但正是在那条线上，我仍然在设计器中遇到错误。是什么赋予了？

更新：值得注意的是[这个](http://msdn.microsoft.com/en-us/library/ms996457.aspx#)描述如何调试设计时控件的链接。

[更新：在对象的构造函数 ( MSDN](http://msdn.microsoft.com/en-us/library/ms996457.aspx) ) 中调用时，Control.DesignMode 未设置为 true ！所以这种代码应该放在 onLoad 中。或者，您可以使用这样的[方法](http://devlicious.com/blogs/derik_whittaker/archive/2006/09/25/Determining-if-the-.Net-IDE-is-in-Design-Mode.aspx)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T22:49:02.793

不如简单地把这个逻辑放进去`OnLoad`，然后检查一下`DesignMode`？

```
protected override void OnLoad(System.EventArgs e)
{
    base.OnLoad(e);
    if (!this.DesignMode)
    {
        /* do stuff */
    }        
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T22:49:19.877

您应该将项目包装在 check on 中`this.DesignMode`，该选项设置为`true`在设计器中时设置，或者将它们移动到`OnLoad`或在设计器使用期间不会被调用的其他地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T22:51:53.023

或者，您可以执行以下操作：

```
public bool IsDesignMode
{
   get
      {
         return (System.Diagnostics.Process.GetCurrentProcess().ProcessName == "devenv");
      }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T22:48:54.650

```
Page.DesignMode 
```

这可用于所有页面和用户控件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T10:46:47.227

如果控件当前由设计器使用，当我必须进行一些特殊处理时，这就是我所做的。

```
 public MyControl() {
  InitializeComponent();
  if (LicenseManager.UsageMode != LicenseUsageMode.Designtime)  {
    // Put stuff here that should not be run while in the designer
  }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T02:50:40.877

我一直认为控件使用配置文件是错误的。相反，控件应该具有可设置的属性，如果使用它的表单想要从配置中设置这些属性，那么欢迎这样做。

# asp.net-mvc - Thunderdome MVC - 为什么在 MVC 中使用单一模型？

> ID：518325
> 
> 赞同：8
> 
> 时间：2009-02-05T22:44:00.587
> 
> 标签：asp.net-mvc, controller, model-view-controller, viewdata, fubumvc

当 Jeremy & Chad[发布他们的 FubuMvc 项目](http://codebetter.com/blogs/jeremy.miller/archive/2008/10/23/our-opinions-on-the-asp-net-mvc-introducing-the-thunderdome-principle.aspx)时，他们提到的差异化因素之一是他们的“Thunderdome Principal”：

> “Thunderdome 原则”——所有 Controller 方法都接受一个 ViewModel 对象（或在某些情况下为零个对象）并返回一个 ViewModel 对象（一个对象进入，一个对象离开）。Controller 类永远不会直接暴露给与 HttpContext 相关的任何内容。没有什么比看到人们尝试编写模拟或存根新 IHttpContextWrapper 接口的测试更让我哭泣的了。同样，Controller 方法不返回 ViewResult 对象，并且通常与所有 MVC 基础结构分离。我们很早就采用了这种策略，以使控制器测试在机械上更简单。它确实实现了这个目标，但它也使 Controller 代码非常精简且易于阅读。我们将在 KaizenConf 解释这是如何工作的。

他们*的“一个 ViewModel（或零）”*方法的优势是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-06T16:12:31.690

它的主要好处是它是一种约定，并使我们所有控制器的事情保持一致。它使我们更容易设置可以在集成测试场景中初始化环境的测试“上下文”/夹具。在大多数情况下，Conventions == Rapidity，因为它从您的设计考虑中消除了许多“假设”场景。

由于我们所有的控制器操作都遵循相同的模式，我们可以假设很多事情，它可以加速和简化我们的控制器集成测试工作。

控制器动作有多个参数当然没有错，但是我们发现拥有一个实际的模型对象为我们提供了一些额外的功能，因为模型可以包含简单的逻辑并公开便利属性，这些属性可以简单地处理一些更复杂的方面它自己的状态等——基本上，这是拥有任何丰富模型的论据，并不是 Thunderdome/OMIOMO 模式所独有的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T23:25:01.987

优点是您不依赖控制器方法外部的任何类型的上下文（例如会话状态）。这使得测试它们变得更容易，因为您不必使用模拟“模拟”该上下文，但它也使其不太实用，因为您必须通过参数传递所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T04:25:39.807

Thunderdome 原理的好处是它简化了控制器。因为将 http 值映射到对象的工作是在控制器之外完成的，这意味着控制器只做它们应该做的事情。

# .net - 什么对象应该从数据访问层返回到业务层一个n层系统

> ID：518329
> 
> 赞同：13
> 
> 时间：2009-02-05T22:46:29.583
> 
> 标签：.net, asp.net, design-patterns, architecture, n-tier-architecture

例如，如果您有一个名为 Person（ID、Name 等）的数据库表，数据访问层应该将哪种对象返回给业务层？我在想这样的事情：

```
//data access tier
public class DataAccess{

   public interface IPerson{
      int ID{ get; set; }
      string Name{ get; set; }
   }

   internal class Person : IPerson{
      private int id;
      private string name;

      public int ID{ get{return id; } set{ id=value; } }
      public int Name{ get{retutn name; } set{ name=value; }
   }

   public static IPerson GetPerson(int personId)
   {
      //get person record from db, populate Person object
      return person;  
   }
}

//business tier
public class Person : IPerson{
   private int id;
   private string name;

   public int ID{ get{return id;} set{id=value;} }
   public string Name{ get{return name;} set{name=value;} }

   public void Populate(int personId){
      IPerson temp = DataAccess.GetPerson(personId);
      this.ID = temp.ID;
      this.Name = temp.Name;
   }
} 
```

但这一切似乎有些繁琐？这个问题有更优雅的解决方案吗？我应该将 DataRow 从数据访问层返回到业务层吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-05T23:00:26.030

您无需在数据访问层 (DAL) 中重复类定义。

您可以在单独的程序集中将您的业务实体创建为“哑”容器，例如您的 Person 类可以是：-

```
public class Person
{
    int ID { get; set: }
    string Name { get; set: }
} 
```

然后，您可以为您的 DAL 提供对业务实体层的引用。您的控制器对象，无论它们是在单独的业务逻辑层中还是在您的 UI 层中，都可以调用 DAL，它可以创建一个业务实体，从数据库中填充它并将其返回给您的控制器。

Imar Spaanjaars 的[这篇文章很好地解释了这种模式。](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=476)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-05T23:11:24.760

您的业​​务层肯定不想知道数据行 - 尝试将数据特定类留在数据层中。这减少了耦合，让您可以在以后更改持久层，而无需大规模重新架构。

要解决您的特定问题，您可以：

*   在您的数据层中创建基本数据对象/实体并将它们交给您的业务层以供使用。
*   或者，正如您正在做的那样，创建纯粹作为将数据从数据层传输到更高层中更丰富的业务对象实现的一种方式存在的 DTO（数据传输对象）。您可以将其作为富域模型中存储库模式的一部分来执行。

您可能要考虑的另一件事是 tiers v layers - 它会影响您对这些事情的看法。层通常是物理层，换句话说，它们定义了进程之间的边界。层通常是合乎逻辑的，它们将程序的功能分成松散耦合的单元。在这种情况下，您的目标是图层。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T00:09:44.143

如果您为 DAO 类创建接口并将它们放置在业务层中，则可以从数据访问层引用您的业务层。数据层中的 DAO 类从业务层返回对象。

您的业​​务层引用接口而不是直接引用数据访问对象。通过 IoC 容器（例如 Castle Windsor）的依赖注入将允许您完成此操作。

这种技术称为分离接口，如下所述：

[http://www.martinfowler.com/eaaCatalog/separatedInterface.html](http://www.martinfowler.com/eaaCatalog/separatedInterface.html)

我所见过的对这种技术的最佳解释可以在这篇关于 NHibernate 最佳实践的文章中找到，该文章由 Billy McCafferty 撰写。

[http://www.codeproject.com/KB/architecture/NHibernateBestPractices.aspx](http://www.codeproject.com/KB/architecture/NHibernateBestPractices.aspx)

这篇文章有很多特定于 NHiberbate 的信息，但其中很大一部分只是关于设计松散耦合和易于单元测试的应用程序的可靠信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-07T07:10:24.500

由于每个层都必须与上层松散耦合的规则，将 BL 引用添加到 DAL 并不是一个好主意。它更好地在 DAL 中定义具有接口的数据模型，并在 BL 中制作业务实体形式。根据我的经验，最好在 DAL 中使用存储库并在您的业务实体或业务流程中访问。

# asp.net - 如何控制重复的 Ajax 'post' 提交？

> ID：518330
> 
> 赞同：0
> 
> 时间：2009-02-05T22:46:49.287
> 
> 标签：asp.net, javascript, asp.net-mvc, asp.net-ajax

我不想阻止用户多次单击同一个 ajax 按钮，但我想进行一些控制以防止有人恶意重复单击该按钮，这会导致重复的数据库请求。在 asp.net mvc 中的 jquery .post 上处理此问题的简单方法是什么？如果我延迟时间，体验客户端将被破坏（？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T22:50:21.450

为什么不单击按钮后禁用它，然后在收到服务器的响应后重新启用它？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T23:01:18.103

这不是客户端问题，只能在服务器端处理。如果正在发出 AJAX 请求，那么恶意用户可以通过 HTTP 直接向您的服务器发出 AJAX 请求——即使对于使用[WFtech](http://www.microsoft.com/downloads/details.aspx?FamilyID=b134a806-d50e-4664-8348-da5c17129210&displaylang=en)或[Curl](http://curl.haxx.se/)之类的新手来说，这也是非常简单的。

不是说显而易见的，但如果用户可以多次单击一个按钮，那么对手也可以，并且没有办法真正确定谁是谁。您可以进行某种节流以将其限制为每 y 秒 x 次点击等，但对手也可以限制他的点击率。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T22:55:06.727

在您的 javascript 中设置一个标志，指示待处理的请求，一旦响应到达取消设置标志。

这样，用户可以根据需要多次单击按钮，对服务器只有一个“活动”请求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-05T22:57:36.210

你为什么不跟踪用户按下按钮的次数，每隔一秒或半秒，你运行方法来提交查询以及点击次数（或者如果没有，则不做任何事情点击）。此外，在该方法中，将点击次数重置为 0，以便下一个查询准确无误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T22:50:05.227

在请求完成之前禁用按钮？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-05T22:52:32.693

您可以将按钮放在计时器上，因此一旦按下，它将被禁用 X 秒或直到它收到来自服务器的响应。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-05T23:15:29.620

实际上适用于任何帖子的一种方法是添加客户端生成的随机令牌。当服务器在第一次记录令牌时接收到帖子时，任何带有相同令牌的后续请求都会被忽略。

[我和 Udi Dahan 在 .Net Rocks #367](http://www.dotnetrocks.com/default.aspx?showNum=367)上听说过这个

# javascript - Javascript复选框验证和长度

> ID：518335
> 
> 赞同：0
> 
> 时间：2009-02-05T22:47:52.280
> 
> 标签：javascript, validation, dom

有复选框 1-300。当没有选择任何内容时，此 JS 函数会提醒用户。函数适用于前 290 个元素。例如，选择项目291时，它会提醒未选择任何内容。document.checks.user.length 达到 298，也不知道为什么。有什么建议么？谢谢。

```
function sub_delete() //Submit & Validation for delete 
{  
    alert ( document.checks.user.length); 298?

    for (i = 0; i < document.checks.user.length; i++) //for all check boxes
    {
        if (document.checks.elements[i].name == "user" && document.checks.elements[i].checked == true ) //otherwise elements also looks at radio buttons 
        {
            document.checks.submit();
            return 0;
        }
    }

    //If we get here no delete was (true) selected
    alert ( "Select Data to Delete" );
    return 0; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T22:59:12.553

你看的不是你循环的东西。

```
for (i = 0; i < document.checks.user.length; i++) //for all check boxes
{
    if (document.checks.user[i].name == "user" && document.checks.user[i].checked == true ) //otherwise elements also looks at radio buttons 
    {
            document.checks.submit();
            return 0;
    }
} 
```

试试那个。

对于这么多元素，最好不要每次都重新计算 .length 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T23:00:49.290

您正在迭代 document.checks.user 的元素，但是您正在检查 document.checks.elements[i] 的名称和值（'checked-ness'）。

# java - 从 Java 与 Microsoft 日内瓦服务器对话

> ID：518349
> 
> 赞同：0
> 
> 时间：2009-02-05T22:51:15.083
> 
> 标签：java, geneva-framework

有没有人尝试通过 Java 与 Microsoft Geneva Server 进行交互？

使用通用库的某种组合可以轻松完成吗？如果是这样：需要研究哪些重要的 Java 库/框架？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T02:16:04.343

查看[Mario Szpuszta 的博客，尤其是这篇文章](http://blogs.msdn.com/b/mszcool/archive/2009/01/23/identity-interoperability-geneva-beta-1-sts-with-net-client-and-netbeans-6-5-metro-1-3-wsit-java-client-working-again.aspx)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-05T23:01:09.883

日内瓦看起来像一个元目录。通常，您不会直接访问元目录，而是访问它管理的目录。您可以使用 LDAP 库来执行此操作。

# c# - 在 using 语句中引发异常时，是否仍会调用 Dispose？

> ID：518352
> 
> 赞同：114
> 
> 时间：2009-02-05T22:51:42.243
> 
> 标签：c#, asp.net, using-statement

在下面的示例中，如果在`using`语句中引发异常，连接是否会关闭并释放？

```
using (var conn = new SqlConnection("..."))
{
    conn.Open();
    // stuff happens here and exception is thrown...
} 
```

我知道下面的代码将确保它确实如此，但我很好奇 using 语句是如何做到的。

```
var conn;
try
{
    conn = new SqlConnection("...");
    conn.Open();
    // stuff happens here and exception is thrown...
}
// catch it or let it bubble up
finally
{
    conn.Dispose();
} 
```

### 有关的：

[引发异常时确保关闭 SQL 连接的正确方法是什么？](https://stackoverflow.com/questions/141204/what-is-the-proper-way-to-ensure-a-sql-connection-is-closed-when-an-exception-is)

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2009-02-05T22:54:11.893

是的，`using`将您的代码包装在 try/finally 块中，如果存在，该`finally`部分将在该块中调用。`Dispose()`但是，它不会`Close()`直接调用，因为它只检查`IDisposable`正在实现的接口以及`Dispose()`方法。

也可以看看：

*   [在 IDisposable.Dispose 中拦截异常](https://stackoverflow.com/questions/220234/intercepting-an-exception-inside-idisposable-dispose)
*   [引发异常时确保关闭 SQL 连接的正确方法是什么？](https://stackoverflow.com/questions/141204/what-is-the-proper-way-to-ensure-a-sql-connection-is-closed-when-an-exception-is)
*   [C#“使用”语法](https://stackoverflow.com/questions/149609/c-using-syntax)
*   [C# USING 关键字 - 何时以及何时不使用它？](https://stackoverflow.com/questions/317184/c-using-keyword-when-and-when-not-to-use-it)
*   [“使用”语句与“最终尝试”](https://stackoverflow.com/questions/278902/using-statement-vs-try-finally)
*   [什么是 C# Using 块，我为什么要使用它？](https://stackoverflow.com/questions/212198/what-is-the-c-using-block-and-why-should-i-use-it)
*   [一次性使用图案](https://stackoverflow.com/questions/513672/disposable-using-pattern)
*   [是否结束使用关闭打开的 SQL 连接](https://stackoverflow.com/questions/376068/does-end-using-close-an-open-sql-connection)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-05T22:58:23.710

这就是反射器如何解码您的代码生成的 IL：

```
私人静态无效主要（字符串[] args）
{
    SqlConnection conn = new SqlConnection("...");
    尝试
    {
        conn.Open();
        做东西（）;
    }
    最后
    {
        如果（连接！= null）
        {
            conn.Dispose();
        }
    }
}

```

所以答案是肯定的，如果

```
做东西（）
```

抛出异常。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-05-08T16:28:05.937

Dispose() 在这段代码中没有被调用。

```
class Program {
    static void Main(string[] args) {
        using (SomeClass sc = new SomeClass())
        {
            string str = sc.DoSomething();
            sc.BlowUp();
        }
    }
}

public class SomeClass : IDisposable {
    private System.IO.StreamWriter wtr = null;

    public SomeClass() {
        string path = System.IO.Path.GetTempFileName();
        this.wtr = new System.IO.StreamWriter(path);
        this.wtr.WriteLine("SomeClass()");
    }

    public void BlowUp() {
        this.wtr.WriteLine("BlowUp()");
        throw new Exception("An exception was thrown.");
    }

    public string DoSomething() {
        this.wtr.WriteLine("DoSomething()");
        return "Did something.";
    }

    public void Dispose() {
        this.wtr.WriteLine("Dispose()");
        this.wtr.Dispose();
    }
} 
```

# java - 从jsp el中的对象获取布尔属性

> ID：518354
> 
> 赞同：9
> 
> 时间：2009-02-05T22:51:54.097
> 
> 标签：java, jsp

我在 jsp 页面上下文中有以下对象的实例：

```
Class User{
  private boolean isAdmin;
  public boolean isAdmin(){return isAdmin}
} 
```

如何从 EL 查询 isAdmin 属性？这似乎不起作用：

```
${user.admin} 
```

这也不是：

```
${user.isAdmin} 
```

谢谢！

-摩根

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T16:45:29.110

行。我真笨。否决这个问题，嘲笑我等等。问题出在 isAdmin() 委派给的方法上。该方法中有一个空指针异常。然而，在我的辩护中，我会说我得到的堆栈跟踪有点不清楚，并且让它看起来像是一个 EL 问题，而不是我的代码中的一个简单的空指针。

Vinegar，您对 isAdmin() 即使没有属性也可以工作的保证确实帮助我解决了这个问题。感谢那。

```
javax.el.ELException: java.lang.NullPointerException
        at javax.el.BeanELResolver.getValue(BeanELResolver.java:298)
        at javax.el.CompositeELResolver.getValue(CompositeELResolver.java:175)
        at com.sun.el.parser.AstValue.getValue(AstValue.java:138)
        at com.sun.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:206)
        at org.apache.jasper.runtime.PageContextImpl.evaluateExpression(PageContextImpl.java:1001)
        at org.apache.jsp.WEB_002dINF.jsp.managepermissions_jsp._jspx_meth_c_forEach_1(org.apache.jsp.WEB_002dINF.jsp.managepermissions_jsp:452)
        at org.apache.jsp.WEB_002dINF.jsp.managepermissions_jsp._jspx_meth_c_forEach_0(org.apache.jsp.WEB_002dINF.jsp.managepermissions_jsp:399)
        at org.apache.jsp.WEB_002dINF.jsp.managepermissions_jsp._jspx_meth_form_form_0(org.apache.jsp.WEB_002dINF.jsp.managepermissions_jsp:348)
        at org.apache.jsp.WEB_002dINF.jsp.managepermissions_jsp._jspService(org.apache.jsp.WEB_002dINF.jsp.managepermissions_jsp:197)
        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:109)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:389)
        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:486)
        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:380)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
        at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:502)
        at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:363)
        at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
        at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)
        at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
        at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:417)
        at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:334)
        at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:126)
        at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:240)
        at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:252)
        at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1173)
        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:901)
        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:809)
        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:523)
        at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:463)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:709) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T23:10:06.433

试试这个：

```
${user.Admin} 
```

以防万一大写是问题。有时 EL 会做一些不明显的事情。但是，我通常能够`${user.admin}`在我的 el. 看看我自己的代码，我有很多例子说明在它工作的地方做显而易见的事情。

您的班级是否有以下方法：

```
 public boolean isAdmin(){return isAdmin}

  public void isAdmin(boolean newValue) { ... } 
```

或者你只有吸气剂？如果我的代码，我注意到我没有执行上述操作。我的二传手都以`set`这样的开头：

```
 public boolean isAdmin(){return isAdmin}

  public void setAdmin(boolean newValue) { ... } 
```

而且我可以`${user.admin}`在我的 JSP 中使用明显的小写解决方案。这可能取决于您使用的 EL 处理器。

**注意：** 稍后添加，因为人们仍然对此投反对票，显然从未遇到过发生这种情况的示例。我自己的 JSP 中让我提出这个问题的一个例子是我有一个方法：

```
public int getLANSomething() { ... } 
```

我在 EL 中按如下方式访问它：`${agent.LANSomething}`规则似乎是所有大写字母在`getXXXyyy`哪里`XXX`，您必须使用大写字母在 EL 中访问它。至少对于我使用过的 Tomcat 版本 4-6。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T23:48:37.930

首先，您可能需要一个用于 User 类的 getter。如果这没有帮助，{user.admin} 应该可以工作，所以我会检查你的 JSP 中是否正确引用了 bean。

希望有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T23:54:41.787

简单的。

对我来说，只需将 isStuff 更改为 getStuff 始终有效。

当然，这可能违反某些命名约定、独立宣言、人权等。但它对我有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-21T16:45:33.540

以下是 Intellij（和我）的做法：

```
private boolean isAdmin;

public boolean isAdmin() {
    return isAdmin;
}

public void setAdmin(boolean admin) {
    isAdmin = admin;
} 
```

# c# - 如何从 ASP.NET MVC RC1 中的 ViewResult 获取模型数据？

> ID：518379
> 
> 赞同：26
> 
> 时间：2009-02-05T22:57:52.027
> 
> 标签：c#, asp.net-mvc, unit-testing

给定以下控制器类：

```
public class ProjectController : Controller
{
    public ActionResult List()
    {
        return View(new List<string>());
    }
} 
```

如何在以下单元测试中获取对模型对象的引用？

```
public class ProjectControllerTests
{
    private readonly ProjectController controller;

    public ProjectControllerTests()
    {
        controller = new ProjectController();
    }

    [Fact]
    public void List_Action_Provides_ProjectCollection()
    {
        var result = (ViewResult)controller.List();

        Assert.NotNull(result);
    }
} 
```

我尝试进入控制器操作以查看正在设置哪些内部字段，但没有运气。

我对 ASP.NET MVC 的了解非常有限，但我的猜测是我没有使用正确的上下文设置控制器。

有什么建议么？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-05T23:11:42.450

尝试：

```
result.ViewData.Model 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-05T23:08:22.957

在 Asp.Net Mvc 框架的 Release Candidate 版本中，模型是通过 ViewResult 对象的“模型”属性提供的。这是您的测试的更准确版本：

```
[Fact]
public void List_Action_Provides_ProjectCollection()
{
    //act
    var result = controller.List();

    //assert
    var viewresult = Assert.IsType<ViewResult>(result);
    Assert.NotNull(result.ViewData.Model);
    Assert.IsType<List<string>>(result.ViewData.Model);
} 
```

# javascript - 使用向上和向下的箭头图像重新排序表格行？

> ID：518382
> 
> 赞同：2
> 
> 时间：2009-02-05T22:58:38.360
> 
> 标签：javascript, jquery, web-applications

我想添加小图像箭头，以便在 Javascript（可能是 jQuery）中的表格行上上下移动，并将重新排序的表格（仅顺序）保存在 cookie 中以供进一步使用。一个例子是 - Joomla，在文章区域的管理区域内（但这是用 php 完成的）。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T00:01:44.380

可能可以再重构一点，但我把节省留给你：

```
function swap(a, b, direction){
  var html = a.wrapInner('<tr></tr>').html()
  a.replaceWith(b.wrapInner('<tr></tr>').html())
  b.replaceWith(html)
}
function getParent(cell){ return $(cell).parent('tr') }
$(document).ready(function(){
  $('.upArrow').live('click', function(){
    var parent = getParent(this)
    var prev = parent.prev('tr')
    if(prev.length == 1){ swap(prev, parent); }
  })
  $('.downArrow').live('click', function(){
    var parent = getParent(this)
    var next = parent.next('tr')
    if(next.length == 1){ swap(next, parent) }
  })
}) 
```

假设这张表：

```
<table>
  <tbody>
    <tr><td>1</td><td class="upArrow">up</td><td class="downArrow">down</td></tr>
    <tr><td>2</td><td class="upArrow">up</td><td class="downArrow">down</td></tr>
    <tr><td>3</td><td class="upArrow">up</td><td class="downArrow">down</td></tr>
  </tbody>
</table> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T23:16:55.263

对于 jQuery 部分，您可以考虑修改[此插件](http://www.isocra.com/2008/02/table-drag-and-drop-jquery-plugin/)以使用单击图标而不是拖放。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-23T14:03:12.310

```
function UpperBttn_Pressed(this) {

    var RowIndex = X.parentNode.parentNode.rowIndex;
    var ParentTable = X.parentNode.parentNode.parentElement;
    if (RowIndex != 0 && RowIndex != 1) {
        ParentTable.moveRow(RowIndex, RowIndex - 1);
    }

}
function DownBttn_Pressed(this) {

    var RowIndex = X.parentNode.parentNode.rowIndex;
    var ParentTable = X.parentNode.parentNode.parentElement;
    var NthRow = GetElement("dataTable").rows.length;
    if (RowIndex!=NthRow-1) {
        ParentTable.moveRow(RowIndex, RowIndex + 1);
    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-22T03:27:28.817

这是一个古老的问题，但我找到了它，其中一篇文章让我走上了正确的道路，所以对于在此处搜索的其他人

使用 jQuery

```
function Func(trigger, blnUp){
var trigRow = $("#" + trigger.id).parent().parent();
var prevRow = trigrRow.prev();
var nextRow = trigRow.next();
var trigRowHTML = "";
if(blnUp){
    trigRowHTML = prevRow.html();
    prevRow.html(trig.html());
}else{
    trigRowHTML = nextRow.html();
    nextRow.html(trig.html());
    }
} 
```

桌子需要看起来像

```
<table>
  <tbody>
    <tr><td>1</td><td><a onclick="Func(this, true)">UP</a></td><td><a onclick="Func(this, false)">UP</a></td></tr>
    <tr><td>2</td><td><a onclick="Func(this, true)">UP</a></td><td><a onclick="Func(this, false)">UP</a></td></tr>
    <tr><td>3</td><td><a onclick="Func(this, true)">UP</a></td><td><a onclick="Func(this, false)">UP</a></td></tr>
  </tbody>
</table> 
```

如果您有一个像其他答案一样的表格，您应该能够只删除一个 .parent() 调用，它也会这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-11T21:08:21.753

insertBefore() 和 insertAfter() 工作得很好。在下面的示例中，我在一个表中有几个 A 标记。单击一个向下移动该行，另一个向上移动。如果您将允许移动的行（也许您不想将行移动到页眉行上方或页脚行下方）设置为 _movable 类，那么它们只会在页眉行和页脚行之间移动。

这是 A 标签之一：<a onclick="return moveUp(this);" href="javascript:return 0;">向上</a>

```
函数上移（aEl）{
    var me = $($(aEl).parents('tr').get(0));
    var prev = me.prev('tr');
    if (prev.attr('class') == '_movable') me.insertBefore(prev);
    返回假；
}
函数 moveDown(aEl) {
    var me = $($(aEl).parents('tr').get(0));
    var next = me.next('tr');
    if (next.attr('class') == '_movable') me.insertAfter(next);
    返回假；
}

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T23:38:52.803

您应该可以使用一些简单的 jQuery 选择器来实现，捕获箭头上的点击事件，并使用选择器获取下一个/上一个元素并交换它们。

然后使用选择器获取每行的 id，但是您正在存储它 - 可以在 tr 上识别每行设置 id 以使选择变得容易。示例选择器在[这里](http://docs.jquery.com/Selectors)并将其存储到一个 cookie 中，[这里](http://www.w3schools.com/JS/js_cookies.asp)也是简单的 JS 。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-16T21:06:42.120

```
$('.upArrow').livequery('click', function () {
        var row = $(this).closest('tr');
        var prev = row.prev();
        if (prev.length == 1) {
                row.detach();
                prev.before(row);
        }
    });
    $('.downArrow').livequery('click', function () {
        var row = $(this).closest('tr');
        var next = row.next('tr');
        if (next.length == 1) {
            row.detach();
            next.after(row);
        }
    }); 
```

# java - 是否可以将 X 显示名称传递给 JVM

> ID：518428
> 
> 赞同：0
> 
> 时间：2009-02-05T23:13:20.887
> 
> 标签：java, jvm, x11

是否可以指定 JVM 通过 JVM 在哪个 X 显示器上启动它的窗口？我在想这样的事情

```
java -DISPLAY=THE_DISPLAY_I_WANT:0.1 -jar my.jar 
```

我查看了手册页，但找不到任何东西。

还是我需要将我对 jvm 的调用包装在这样的 shell 脚本中

```
#/bin/sh
export DISPLAY=THE_DISPLAY_I_WANT:0.1
java -jar my.jar 
```

**我不想编写脚本只是为了指定一个可以直接传递给 JVM 的参数。**

PS：不，我不想更改我的环境 DISPLAY 变量我想在我喜欢的任何 DISPLAY 上启动 JVM :)

**更新** 回答问题“为什么我使用第二种解决方案很重要”使用第二种解决方案，如果我想在几个不同的显示器上启动 jvm 会话，我必须为每个会话设置 DISPLAY。

我正在寻找的就像你可以用 Xprograms 做的事情

试试`xterm -display my_display:0.0` 所以我的问题是我可以用 jvm 做这个吗，我在任何地方都看不到它的记录。如果做不到，那么正确的答案应该是**“不，你不能”**，我已经知道替代方案了：）

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T01:23:21.203

鉴于您对答案的限制，您正在寻找的答案是“**无法完成**”

我仍然很好奇为什么第二种解决方案对您不起作用。我意识到这不是你*想做*的，我只是想知道*为什么*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T23:22:17.470

如果您使用的是 sh、bash 或类似的东西，您可以这样做

```
DISPLAY=THE_DISPLAY_I_WANT:0.1 java -jar my.jar 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T00:57:47.340

如果您对您的建议感到满意，

```
java -DISPLAY=THE_DISPLAY_I_WANT:0.1 -jar my.jar

```

那么我不知道你为什么抗拒这些：

```
DISPLAY=THE_DISPLAY_I_WANT:0.1 java -jar my.jar
环境显示=THE_DISPLAY_I_WANT:0.1 java -jar my.jar

```

如果您担心的话，它们不会全局修改环境变量。他们只为新进程（以及它产生的任何其他内容）修改它。其他新进程不会受到影响，已经运行的进程肯定不会受到影响。

如果这不是问题，那么我猜您的意思是在第一个示例中，您不会真正修改`DISPLAY`环境变量，甚至不会修改新的 Java 进程。相反，您将指望当前 JVM 的 X11 层有*其他*方法来确定将其图形输出发送到何处。我想它可以这样工作。也许地球上的所有其他 Java 程序都只是忽略了这种其他方式，并让 JVM 回退到使用环境变量，因为它适用于非 Java 程序。

但为什么这很重要？好像您的程序不会将（未修改的）`DISPLAY`环境变量用于其他用途，是吗？由于它没有用于其他任何用途，因此您也可以将其用于预期目的，不是吗？

# java - 在 REST 调用上从 Java 服务器保持 DCOM 对象处于活动状态

> ID：518435
> 
> 赞同：0
> 
> 时间：2009-02-05T23:17:09.117
> 
> 标签：java, com, rest, ejb, dcom

我正在为我的 Java 服务器实现一个 REST API。通过 API 获得的资源之一实际上是创建一个 C++ DCOM 对象并反映其值。我使用的 Java 到 COM 桥接器是 J-Integra。

问题是我需要为后续的 REST 调用保持该 DCOM 对象处于活动状态，但只要其 Java 引用存在，该对象就处于活动状态 - 最多直到 REST 会话到期。

我怎样才能让 DCOM 对象保持活动状态，直到我不再需要它？到目前为止，我唯一想到的是使用 EJB，然后它将成为启动 DCOM 对象并保存其引用的对象。我不是 EJB 方面的专家，但我认为 a) 它是一种过度杀伤的解决方案 b) EJB 可能会被服务器缓存（钝化？），从而丢失 DCOM 引用。

有什么建议么？

谢谢因巴尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T23:43:09.783

> 我怎样才能让 DCOM 对象保持活动状态，直到我不再需要它？

我想这取决于不再需要该对象意味着什么。你怎么知道什么时候完成？

这些 DCOM 实例适用于整个站点，还是仅适用于特定用户？如果在站点范围内，接收这些请求的资源是否可以保留对该对象的引用？如果没有，也许您需要另一个层来为您管理这些对象。

你为 REST 使用什么框架？

* * *

> 这里有更多信息： DCOM 对象正在异步执行一组任务。因此，Java 服务器对它的主要调用立即返回，而 DCOM 对象继续执行。不幸的是，它是一个相当古老的对象，我无法控制它的实现或接口——我无法改变它。DCOM 对象甚至没有 COM 事件。知道它是否完成的唯一方法是使用特定方法（getStatus）对其进行轮询。我不想从我的 REST API 实现中轮询它，因为这会破坏 REST 概念。我无法提前知道 DCOM 对象运行需要多长时间，所以我不能让会话保持那么长时间。

所以基本上，您想使用 REST 调用来启动操作，但不关心它何时完成或它的状态是什么？如果是这样，您是否可以启动一个将启动 DCOM 操作的 Thread，轮询状态直到操作被认为完成，然后销毁 DCOM 操作？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T23:23:38.537

放置在 COM+ 注册的组件，它保持活动状态。[在此链接](https://stackoverflow.com/questions/503740/how-to-force-process-isolation-for-an-out-of-process-com-server/512327#512327)上查看更多信息。

# visual-studio-2005 - 是什么导致 UMDH 无法提供堆栈跟踪

> ID：518437
> 
> 赞同：3
> 
> 时间：2009-02-05T23:17:46.497
> 
> 标签：visual-studio-2005, umdh

我以前用过 UMDH 十几次，从来没有任何问题。

突然间，我的转储文件中的堆栈跟踪中没有函数名称 - 只是一系列地址。

我已经启用了 ust：

gflags exe_name +ust

我启动 exe_name，然后我做

umdh -p:pid one.txt umdh -p:pid two.txt

我查看了 one.txt 和 two.txt ，但没有任何迹象表明它们来自哪里。当我做差异时

umdh one.txt two.txt > diff.txt

结果没有用。

帮助，我喜欢这个工具。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T19:50:15.783

当您执行以下命令时，UMDH 会执行 PDB 关联：

umdh -d one.txt two.txt -f:outputfile.txt

不是在您最初拍摄快照时。你必须让它为你做差异！

而且，是的……您需要正确设置符号路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T12:17:17.433

UMDH 开关语法在调试工具的最新版本中的某个地方略有改变。也许这就是问题所在。尝试以下 -

umdh -p:pid **-f:**one.txt

umdh -p:pid **-f:**two.txt

umdh **-v -l** one.txt two.txt > diff.txt

（-l 是一个新开关，从 PDB 中提取文件和行号）。再次确保`_NT_SYMBOL_PATH`环境变量包含*您的*PDB 的路径。

文档现在也可以[在线](http://msdn.microsoft.com/en-us/library/cc267868.aspx)获得。

（编辑：）比较中的关键开关 -v 现在出现了......

（编辑：）您没有指定您的操作环境。[众所周知，在](http://www.eggheadcafe.com/software/aspnet/31544565/umdh-stack-traces-incompl.aspx) [VC8](http://www.nynaeve.net/?p=209)上，CRT 的 malloc 是用 FPO 编译的——这是 UMDH 无法克服的。众所周知（参见 Pavel Lebedinsky[的](http://weblogs.asp.net/mdavey/archive/2004/03/09/86569.aspx)评论）UMDH 无法处理某些分配器类型，例如 SysAllocString。如果您确实在使用一些奇异的分配器，您可能想尝试一下[LeakDiag](http://thetweaker.wordpress.com/2009/04/09/native-memory-leaks-part-1-leakdiag/) - 它可以处理更多的分配器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T23:23:37.590

可执行地址和函数名称之间的映射在 PDB 中定义。

确保您的符号路径设置正确，
尤其是当您在与编译代码的机器不同的机器上运行 UMDH 时。

# c# - C# 中的枚举子集或子组

> ID：518442
> 
> 赞同：28
> 
> 时间：2009-02-05T23:19:16.913
> 
> 标签：c#, enums

我有一个现有的枚举，其中包含许多项目。

我也有现有的代码可以用这个枚举做某些事情。

我现在想要一种仅查看子集枚举成员的方法。我正在寻找一种将我的枚举分成组的方法。我需要保留每个成员的 (int) 值，并且如果需要，我需要保留查看所有枚举成员的能力。

我唯一能想到的就是为每个子枚举创建一个新枚举，其中只包含我想要使用相同名称和值的项目。

这可行，但违反了整体不重复原则。

我不指望任何人有更好的选择，但我想我会问，以防万一有人有一个花哨的把戏给我看。

谢谢，一如既往。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-08-11T15:30:08.793

我会选择这个（至少在 VB.NET 中有效）

```
enum MySuperEnumGroup 
{ 
  Group1Item1, 
  Group1Item2, 
  Group1Item3, 

  Group2Item1, 
  Group2Item2, 
  Group2Item3, 

  Group3Item1, 
  Group3Item2, 
  Group3Item3, 
} 

enum MySubEnumGroup 
{
Group2Item1 = MySuperEnumGroup.Group2Item1 
Group3Item1 = MySuperEnumGroup.Group3Item1 
Group3Item3 = MySuperEnumGroup.Group3Item3
} 
```

然后在需要时执行某种 CType。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-05T23:32:57.213

您可以使用枚举定义值，然后通过静态类中的常量引用它们，这样您的开发人员就不会被大枚举所困扰。你可以有：

```
enum MySuperEnumGroup
{
  Group1Item1,
  Group1Item2,
  Group1Item3,

  Group2Item1,
  Group2Item2,
  Group2Item3,

  Group3Item1,
  Group3Item2,
  Group3Item3,
}

static class MySuperEnumGroup_Group1
{
  public const MySuperEnumGroup Item1 = MySuperEnumGroup.Group1Item1;
  public const MySuperEnumGroup Item2 = MySuperEnumGroup.Group1Item2;
  public const MySuperEnumGroup Item3 = MySuperEnumGroup.Group1Item3;
}

static class MySuperEnumGroup_Group2
{
  public const MySuperEnumGroup Item1 = MySuperEnumGroup.Group2Item1;
  public const MySuperEnumGroup Item2 = MySuperEnumGroup.Group2Item2;
  public const MySuperEnumGroup Item3 = MySuperEnumGroup.Group2Item3;
}

//etc. 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-06-07T18:09:54.003

如果枚举没有明确的值，给它们一个并使用标志来定义“分组”：

```
[Flags]
enum MySuperEnumGroup
{
    Group1 = 1 << 0,
    Group2 = 1 << 1,
    Group3 = 1 << 2,

    Group1Item1 = 1 << 10 | Group1,
    Group1Item2 = 1 << 11 | Group1,
    Group1Item3 = 1 << 12 | Group1,

    Group2Item1 = 1 << 13 | Group2,
    Group2Item2 = 1 << 14 | Group2,
    Group2Item3 = 1 << 15 | Group2,

    Group3Item1 = 1 << 16 | Group3,
    Group3Item2 = 1 << 17 | Group3,
    Group3Item3 = 1 << 18 | Group3,
} 
```

然后您可以使用`Enum.GetValues`and`HasFlag`获取给定“分组”的值：

```
var group1 = Enum.GetValues(typeof(MySuperEnumGroup))
                 .Cast<MySuperEnumGroup>()
                 .Where(value => value.HasFlag(MySuperEnumGroup.Group1))
                 .ToArray(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-05T23:35:58.907

这可能会有所帮助：[C# 中的假枚举](http://sanity-free.org/140/creating_fake_enums.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-04T23:19:34.633

最后，我不得不重写大部分代码，但衍生出以下“技巧”：

我丢弃了 C# 枚举并在常规类上使用静态成员。此类被制成单例，并在应用程序启动时初始化。

我的静态成员的构造函数被允许引用另一个静态成员作为“父”。

接下来，我的 init 方法使用反射来遍历每个静态成员并根据几个属性对它们进行索引。这些索引存储在哈希表中，这些哈希表也是单例的成员。

我因此得到：

一个单例对象：

*   具有静态成员，可以在设计时轻松访问。
*   可以在运行时用于查找某些静态成员（基于“组”和其他属性）。

我的 init 方法进行了大量的验证。如果构建了无效（例如重复）的静态成员，则会在应用程序启动时出现运行时错误。

显然是一个相当大的黑客，但我对此很满意。

# sql - 如何设计用于存储和检索搜索统计信息的数据库表结构？

> ID：518443
> 
> 赞同：0
> 
> 时间：2009-02-05T23:19:23.013
> 
> 标签：sql, search, statistics

我正在开发一个具有自定义搜索功能的网站，我想收集有关用户搜索内容的统计信息。

它不是对网站内容的全文搜索，而是对具有以下搜索模式的公司进行搜索：

*   按公司名称
*   按区号
*   通过提供的服务
*   ...

如何设计用于存储搜索统计信息的数据库？
哪些信息最相关，我应该如何查询它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T23:30:00.590

嗯，这取决于不同的搜索模式是如何工作的，但通常我会说一个有 3 列的表可以工作：

```
SearchType    SearchValue    Count 
```

每当有人进行搜索时，假设他们搜索“Company Name: Initech”，首先查询表中是否有 SearchType =“Company Name”（或您给此搜索类型的任何枚举/id 值）的行) 和 SearchValue = "Initech"。如果已经有一行，请通过递增 Count 列来更新该行。如果此搜索还没有一行，则插入一个计数为 1 的新行。

通过这样做，您将有相当大的灵活性在以后查询它。您可以找出每种类型最受欢迎的搜索是什么：

```
... ORDER BY Count DESC WHERE SearchType = 'Some Search Type' 
```

您可以找出最流行的搜索类型：

```
... GROUP BY SearchType ORDER BY SUM(Count) DESC 
```

等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T23:35:58.907

这是一个非常普遍的问题，但这是我要做的：

**选项 1** 如果要严格区分所有三种搜索类型，请为每种类型创建一个表。对于公司名称，您可以简单地存储 CompanyID（假设您的网站正在维护公司列表）和搜索计数。对于区号，存储区号和搜索次数。如果区号不存在，请插入。提供的服务主要取决于您的设置。最通用的方法是存储关键字和搜索计数，如果还没有，则再次插入。

或者，您也可以存储搜索日期信息。例如，您将有一个包含提供服务关键字和唯一 ID 的表。您将拥有另一个表，该表具有该 ID 的 FK 和 SearchDate。这样，您可以随着时间的推移理解数据，同时最大限度地减少存储。

**选项 2** 对所有搜索一视同仁。一个包含关键字列和计数列的表，如果需要，可以合并 SearchDate。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T23:22:04.270

你可能想检查一下：

[http://www.microsoft.com/sqlserver/2005/en/us/express-starter-schemas.aspx](http://www.microsoft.com/sqlserver/2005/en/us/express-starter-schemas.aspx)

# qt - 如何告诉 QTableWidget 结束编辑单元格？

> ID：518447
> 
> 赞同：5
> 
> 时间：2009-02-05T23:20:56.410
> 
> 标签：qt, pyqt

我正在显示一个弹出菜单来选择 QTableWidget 中的一些值。最低的项目是“修改列表”条目，当我选择它时，应该会自动出现一个新窗口，并且 QComboBox 应该消失并且单元格返回到 Qt::DisplayRole 状态。

现在 Qt 有所有这些不错的 API 调用，比如`QTableWidget.edit()`and `QTableWidget.editItem()`，我真正想要的是 a `QTableWidget.endEditing()`，最好不指定单元格的索引，尽管我可以使用这个调用来获得它：

```
table.currentIndex() 
```

…但我不知道我是否可以保证当前单元格始终是正在编辑的单元格。

是否有关闭这类编辑器的 API？

![弹出菜单](https://i.stack.imgur.com/esRER.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-05T23:29:51.587

[QTableWidget](https://doc.qt.io/qt-4.8/qtablewidget.html)从 QWidget 继承了 19 个公共插槽。其中之一是 setDisabled()，它应该禁用该小部件及其所有子部件的输入事件。

我会尝试：

```
table.setDisabled( true );
table.setDisabled( false ); 
```

尽管您说它对您不起作用，但还有另一种方法：如果您不喜欢那样（我相信表格失去焦点），您可以尝试使用[EditTriggers](https://doc.qt.io/qt-4.8/qabstractitemview.html#EditTrigger-enum)。例如：

```
table.setEditTriggers( QAbstractItemView::NoEditTriggers ); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-07-20T19:01:49.737

`table.setCurrentItem(None)`对我有用。（如果您使用某些 cellChanged/itemChanged 插槽函数，请不要忘记阻止信号。）

这与 PyQt 相关。对于 C++，我认为将 None 替换为 NULL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T01:05:50.933

您可以使用 QTableWidget.closePersistentEditor() 关闭编辑器。但是， QAbstractItemView.closeEditor() 可能更接近您想要的，特别是因为您似乎对基于 QModelIndex 的 API 感到满意并且已经在使用自定义编辑器小部件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-01-17T09:18:26.573

就我而言，没有一个选项能正常工作。所以，我想：我需要将按键事件发送到行编辑本身。以下适用于`QTreeView`但可能适用于打开行编辑以编辑单元格的任何其他视图或小部件。

```
QWidget* editingWidget = treeView->findChild<QLineEdit*>();
if(editingWidget)
{
    QKeyEvent keyPressEvent(QEvent::KeyPress, Qt::Key_Return, Qt::NoModifier);
    QApplication::sendEvent(editingWidget, &keyPressEvent);
    QApplication::processEvents(); // see note below
} 
```

就我而言，我想在完成编辑一个项目后直接开始编辑另一个字段。这就是我放在`processEvents`那里的原因，在大多数情况下，您可能可以删除该行。

PS：是的，它是 C++，但应该很容易适应 Python。当我搜索 C++ 解决方案时，我发现了这个线程，所以也许它对其他人也有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-25T20:13:16.433

我不能说列表小部件。但是，我来到这里试图做类似的事情。

我双击一个单元格，并基于该列，调出一个带有列表的子表单，然后当它关闭时，根据所选值移动到下一个适当的列。

我的问题是我可以在单元格中获取值并“选择”下一个适当的单元格，但原始单元格在编辑模式下保持选中状态！

我终于意识到我的双击是选择单元格，即。编辑。

单击即可选择单元格，但不会打开编辑模式。

旁注：永远无法让该子表单真正成为模态，因此我在调用表单中创建了一个循环：当子表单可见时，唯一的代码是 app.processEvents()

# asp.net - ASP.NET 用户配置文件的管理

> ID：518449
> 
> 赞同：1
> 
> 时间：2009-02-05T23:21:28.173
> 
> 标签：asp.net, profile

[存储用户配置文件](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/profile/default.aspx)快速入门提供了一些有关管理 ASP.NET 用户配置文件的信息。在我的情况下，管理员必须能够使用配置文件更改/监控某些属性。是否可以使用默认的 SqlServerProfileProvider 访问和更改另一个用户配置文件中的用户配置文件的属性以及如何？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T23:47:07.233

如果“另一个用户配置文件”是指不是当前用户的用户的配置文件：

```
ProfileCommon userProfile = Profile.GetProfile(USERNAME);
userProfile.Property = "blah"; 
```

# google-ads-api - Google Adwords API 'getKeywordVariations' 无法正常工作

> ID：518460
> 
> 赞同：2
> 
> 时间：2009-02-05T23:26:46.930
> 
> 标签：google-ads-api

我正在尝试使用 google adwords API 的 'GetKeywordVariations' 方法，[此页面上](http://code.google.com/apis/adwords/docs/developer/KeywordToolService.html#getKeywordVariations)的文档。根据文档，它应该返回这些字段，包括 lastMonthSearchVolume。当我尝试这个时，我得到了除 lastMonthSearchVolume 之外的所有字段。有谁知道为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T02:16:03.203

我找到了答案。我使用的是旧版本的 API。更新到最新版本修复了它。

# sql - SQL 列表函数去除精度

> ID：518462
> 
> 赞同：0
> 
> 时间：2009-02-05T23:27:12.793
> 
> 标签：sql, reporting, sybase, sql-function

我正在使用 LIST 函数创建一个 ';' 分隔的值列表。类型是数字 (19,2)。由于某种原因，使用 list 函数时似乎忽略了精度。在此列上执行简单选择时，值看起来不错，即“12.00”。但是，如果我使用 LIST() 我的结果格式为“12.000000”

这是我的 LIST 用法：

```
LIST(case when tblWOService.PricePerVehicle is null then ' ' else CONVERT(decimal(19,2),tblWOService.PricePerVehicle end,';') 
```

CONVERT 不会改变结果。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T23:40:25.733

您是否尝试过显式转换您的空字符串？

```
LIST(
    case when tblWOService.PricePerVehicle is null then CONVERT(decimal(19,2),' ')
        else CONVERT(decimal(19,2),tblWOService.PricePerVehicle) end,';'
) 
```

我在 T-SQL 中遇到了与 CASE 语句类似的数据类型问题。

# drop-down-menu - 可用性：动态下拉菜单填充

> ID：518464
> 
> 赞同：3
> 
> 时间：2009-02-05T23:27:33.683
> 
> 标签：drop-down-menu, usability

我一直认为（但由于某种原因从未实践过）动态生成且仅包含一个项目的下拉菜单应该自动选择该项目。这与我观察到的典型方法相反，在顶部创建一个空白条目并且您仍然必须与菜单交互以进行单个可用选择。

例如，当我登录我的网上银行并选择“查看纸质结单”时。我只有一个帐户，因此该过程的下一步是向我显示一个下拉列表，我必须在其中选择该单个帐户才能继续。在这种情况下，通过实施上述解决方案，只需单击一下即可选择帐户并继续查看它。在这种情况下，更好的是完全消除下拉菜单步骤并直接进入语句。

您能想到自动选择单个项目会产生不良结果的情况吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T00:18:22.223

> 您能想到自动选择单个项目会产生不良结果的情况吗？

是 - 用户可以选择不选择任何选项的任何情况。

在您的银行帐户示例中，预先选择唯一的值是有意义的。但是，如果您有某种形式的用户可以提供自愿信息，他们将需要将该字段留空或以其他方式给出可能的错误答案。

因此，无论预选是否是一个好主意，它实际上应该取决于该下拉列表中数据的性质。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T23:42:35.557

我完全同意，在你描述的情况下。但是有时您希望强制用户主动进行选择——例如，当字段的值在某种程度上是可选的或附加的。

在您的情况下，如果不选择帐户，可能没有有用的方法可以继续，因此自动选择确实有意义。但例如，我正在开发的一个应用程序允许用户指定许多描述性字段（电影元数据，基本上——标题、发行年份、流派等），其中许多是可选的，其中一些是由下拉菜单表示。允许用户将默认选择留空，让他有效地告诉我们“我不想使用此字段”，因此我们将其留空，数据保持干净。

只是一个例子，虽然你是对的——在你的情况下，我可以看出这有多烦人。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T23:49:07.773

如果真的只有一种可能性，您不应该要求用户在选项 A 之间做出决定。（错误的语法来说明这一点）

如果该字段可以留空，则它不是一个只有一个答案的选项。相反，您可以在选项 A“有意义的数据”和选项 B“”之间进行选择。

如果列表有空白选项，但表格不允许该选项为空白，则可以在选项 A 之间进行选择。（错误的语法来说明这一点）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-08T04:00:52.350

**有时您希望用户明确选择一个选项，*即使它是唯一的选项*。**如果该选项是自动选择的，用户甚至可能永远不会意识到它，即使他们可能对结果不满意。

例如，我正在网上银行网站上查看我的储蓄账户。然后我去设置付款。碰巧的是，我不允许从我的储蓄账户付款，所以付款表格会自动选择我唯一的其他账户。如果我没有注意到这一点，那么当我期望使用我的储蓄账户时，我最终会从我的另一个账户付款。如果我知道，我根本不会付款。

也许这有点做作。但是除非您可以确定用户会对（唯一的）选择感到满意，否则您应该确保他们明确选择它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T23:36:40.000

我同意。如果下拉列表中只有一个项目并且需要用户选择某些内容，则默认为单个项目。我想不出这有什么负面影响（但我当然不是 UI 专家）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T23:41:44.340

在这种情况下我喜欢做什么取决于几个因素。

如果下拉列表是必填字段并且由于动态生成而最终只有一项，我会尽量避免将其完全显示为下拉列表。我最终将其显示为不可编辑的文本字段（或者如果没有必要则根本不显示它）。为什么要让它看起来像是一个选择，而实际上它不是？

如果不需要下拉菜单，那么除了单个值之外显示一个空白选项是完全有意义的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T00:38:21.700

如果它是 REQ 并且只有一个记录/值..我会尝试**将控件更改为 Display 字段而不是 Drop Down**。

# java - JSlider问题：左键点击后的位置

> ID：518471
> 
> 赞同：13
> 
> 时间：2009-02-05T23:30:19.840
> 
> 标签：java, swing, user-interface, jslider

每当我单击一个 JSlider 时，它都会在单击方向上定位一个 majorTick，而不是跳到我实际单击的位置。（如果滑块位于点 47 并且我单击 5，它将跳转到 37 而不是 5）。在使用 JSlider 时有什么方法可以改变这一点，还是我必须使用其他数据结构？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-06T00:46:43.570

尽管这看起来很奇怪，但实际上是外观控制了这种行为。看一下`BasicSliderUI`，你需要重写的方法是[`scrollDueToClickInTrack(int)`](http://java.sun.com/j2se/1.5.0/docs/api/javax/swing/plaf/basic/BasicSliderUI.html#scrollDueToClickInTrack(int))。

为了将 的值设置为`JSlider`最接近用户单击轨道的值，您需要在鼠标坐标从`getMousePosition()`到有效轨道值之间进行一些花哨的裤子转换，同时考虑到`Component`,它的方向，大小和刻度之间的距离*等*。幸运的是，`BasicSliderUI`为我们提供了两个方便的函数：[`valueForXPosition(int xPos)`](http://java.sun.com/j2se/1.5.0/docs/api/javax/swing/plaf/basic/BasicSliderUI.html#valueForXPosition(int))和[`valueForYPosition(int yPos)`](http://java.sun.com/j2se/1.5.0/docs/api/javax/swing/plaf/basic/BasicSliderUI.html#valueForYPosition(int))：

```
JSlider slider = new JSlider(JSlider.HORIZONTAL);
slider.setUI(new MetalSliderUI() {
    protected void scrollDueToClickInTrack(int direction) {
        // this is the default behaviour, let's comment that out
        //scrollByBlock(direction);

        int value = slider.getValue(); 

        if (slider.getOrientation() == JSlider.HORIZONTAL) {
            value = this.valueForXPosition(slider.getMousePosition().x);
        } else if (slider.getOrientation() == JSlider.VERTICAL) {
            value = this.valueForYPosition(slider.getMousePosition().y);
        }
        slider.setValue(value);
    }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T20:50:33.083

这个问题有点老了，但我自己也遇到过这个问题。这是我的解决方案：

```
JSlider slider = new JSlider(/* your options here if desired */) {
    {
        MouseListener[] listeners = getMouseListeners();
        for (MouseListener l : listeners)
            removeMouseListener(l); // remove UI-installed TrackListener
        final BasicSliderUI ui = (BasicSliderUI) getUI();
        BasicSliderUI.TrackListener tl = ui.new TrackListener() {
            // this is where we jump to absolute value of click
            @Override public void mouseClicked(MouseEvent e) {
                Point p = e.getPoint();
                int value = ui.valueForXPosition(p.x);

                setValue(value);
            }
            // disable check that will invoke scrollDueToClickInTrack
            @Override public boolean shouldScroll(int dir) {
                return false;
            }
        };
        addMouseListener(tl);
    }
}; 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-02-09T07:49:25.280

此行为源自操作系统。您确定要重新定义它并迷惑用户吗？我不这么认为。;)

# regex - 正则表达式教程

> ID：518473
> 
> 赞同：0
> 
> 时间：2009-02-05T23:31:12.163
> 
> 标签：regex

有没有不用设计器的正则表达式教程？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T23:39:53.423

[我通过本教程](http://www.regular-expressions.info/tutorialcnt.html)学习了 RegEx 的基础知识。 它讨论了幕后发生的事情，不依赖于某个平台。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T23:49:51.360

这是一个很棒的快速入门指南：

[每个程序员都应该知道的关于正则表达式的绝对最低限度](http://immike.net/blog/2007/04/06/the-absolute-bare-minimum-every-programmer-should-know-about-regular-expressions/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T23:33:14.780

查看[Expresso](http://www.ultrapico.com/Expresso.htm)我过去曾使用它来构建我的 RegEx。帮助学习也不错。不是真正的教程，但您可以用它测试正则表达式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T23:36:58.377

[RegEx Buddy](http://www.regexbuddy.com/)虽然本身也不是教程，但对我来说是最好的工具之一。动态突出显示有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T23:41:26.323

[RegexBuddy](http://www.regexbuddy.com/)也很好，如果我可以补充的话。有多种类似的工具可用。一个简单的谷歌搜索“正则表达式工具”揭示了其中的大部分。至于教程，我可以推荐[《精通正则表达式》](http://oreilly.com/catalog/9781565922570/)这本书（我看过第一本，现在可能有更新的版本）

# design-patterns - 枚举和常量

> ID：518475
> 
> 赞同：1
> 
> 时间：2009-02-05T23:32:14.703
> 
> 标签：design-patterns, enums, constants

有没有比将枚举声明为更好的方法

```
public enum DepthNumberSize
{
   Bit1 = 1,
   Bit4 = 4,
   Bit8 = 8,
   Bit16 = 16,
   Bit32 = 32
} 
```

并且每次使用相关数据块的操作执行 switch 语句时，例如：

```
switch(size)
{
    case DepthNumberSize.Bit1:
       buffer[i++] = input[j] & 1;
       buffer[i++] = (input[j] >> 1) & 1;
       // cut
    case DepthNumberSize.Bit8:
       buffer[i++] = input[j++];
       break;
    case DepthNumberSize.Bit16:
       buffer[i++] = input[j] | (input[j] << 8);
       j += 2;
       break;
    // cut
} 
```

?

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T23:49:09.833

你可以这样做：

```
 interface IBitSize
    {
        object DoStuff();
    }

    class Bit1 : IBitSize
    {
        public object DoStuff()
        {
            buffer[i++] = input[j] & 1;
            buffer[i++] = (input[j] >> 1) & 1;
            return something.
        }
    }

    class Bit2 : IBitSize
    {
        public object DoStuff()
        {
           //Do different stuff here.
        }
    } 
```

然后你可以这样称呼它：

```
 IBitSize size = new Bit1();
    size.DoStuff(); 
```

这样您就可以卸下开关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T23:49:31.563

您可以考虑改用类，可能使用工厂方法来返回正确的大小具体类型，例如

```
abstract class BitManipulator
{
    public abstract void Manipulate(
        byte[] buffer, byte[] input, ref int i, ref int j);

    public static BitManipulator Create(int size)
    {
        switch (size)
        {
            case 1: return new Bit1Manipulator();
            case 2: return new Bit2Manipulator();
            // etc.
        }
    }
}

class Bit1Manipulator : BitManipulator
{
    public override void Manipulate(
        byte[] buffer, byte[] input, ref int i, ref int j)
    {
        buffer[i++] = input[j] & 1;
        buffer[i++] = (input[j] >> 1) & 1;
    }
}

// etc. for other classes 
```

然后你就得到了一个 switch 语句，然后所有的逻辑都可以包含在特定于大小的类中，而不是在其余代码中通过 switch 语句乱扔垃圾。当然，对于需要做的每种类型的事情，您都可以使用多种方法。

很难说这是否适合您的应用程序，因为没有很多上下文，但这是可以在这种情况下使用的另一种方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T23:49:24.480

我认为您可能需要澄清一些问题。

但是，您可以通过将枚举转换为字节（枚举的默认类型）来获取枚举的基础值。

```
(byte)DepthNumberSize.Bit8 
```

将返回 8。这会更好，因为您实际上会使用您为枚举提供的自定义值（它们默认为 0、1、2 等）。它甚至可以让你摆脱整个 switch 语句，让你编写一个通用的代码块，使用枚举变量 'size' 的底层值来产生所需的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T23:50:21.127

在一般范式内工作，是的：

```
 Bit1 = 0x00000001,
   Bit2 = 0x00000002,
   Bit3 = 0x00000004,
   Bit4 = 0x00000008,
   Bit5 = 0x00000010 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T23:59:36.817

取决于需要什么，真的。如果确实需要满足任意数量的位，那么最好有一个循环，从源中逐位提取，组装值，然后在读取正确数量的位后将其写入目标. 但是，如果真的只有一组固定的宽度，那么开关和外壳就可以了（无论如何在我看来），因为它可能更清楚发生了什么。使代码比它需要的更通用是没有意义的。

在任何一种情况下，最好将所有这些隐藏在一个函数或其他一些抽象手段后面，以便它可以更容易地重用（“每次”表明这段代码会出现在几个地方)，以及只写在一处的决定结果。

（我要进一步评论的是，如果使用枚举来表示一组固定的位计数，每个枚举数应该有一个任意值，而不是相应的位计数。这更好地表明该名称不以任何方式表示任意位计数，而只是表示支持的位计数之一的标记。）

（另外，当读取 16 位时，其中一个字节可能来自`input[j+1]`.）

# apache-flex - Flex Viewstack 的孩子，如果你看不到他们，他们存在吗？

> ID：518511
> 
> 赞同：4
> 
> 时间：2009-02-05T23:44:47.237
> 
> 标签：apache-flex, actionscript-3, adobe, viewstack

我似乎遇到了一个问题（无法访问空对象引用的属性或方法）将 actionscript 中的事件绑定到当前未显示的 viewstack 层。直到该层第一次可见时才创建这些对象吗？我记得有关创建策略的一些内容，如果是这种情况，我可以强制它在查看该图层之前创建那些子级吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-06T00:02:00.617

是的，没错——默认情况下，ViewStack 子项仅在需要时创建（“延迟实例化”是您在此上下文中听到的短语）。相反，如果您想指示 Flex 预先创建所有 ViewStack 容器的子容器，请考虑使用对 all 通用的**creationPolicy**属性`mx.core.Containers`：

> ContainerCreationPolicy.ALL 的 creationPolicy 意味着导航器容器会立即为每个孩子创建更深的后代，而不是等到该孩子被选中。

```
<mx:ViewStack id="myStack" creationPolicy="all" /> 
```

它在启动时有点慢，因为您正在创建一堆您可能还不需要的子组件，但只要您牢记这种权衡，它可能会在某个时候派上用场。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T23:48:50.300

是的，我自己在处理具有 PureMVC 结构的应用程序时也遇到了同样的问题。我无法为 ViewStack 的子组件创建中介，因为它们是由 Flex 框架懒惰地构建的。

这是我最终找到解决方案的地方：

[http://forums.puremvc.org/index.php?topic=280.0](http://forums.puremvc.org/index.php?topic=280.0)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T23:57:01.097

[在这里](http://livedocs.adobe.com/flex/3/html/help.html?content=layoutperformance_05.html)找到相关文档。似乎这将是您在容器文档中记下的内容。

# c# - 有没有简单的方法来连接两个 BitArray (C# .NET)？

> ID：518513
> 
> 赞同：9
> 
> 时间：2009-02-05T23:45:12.150
> 
> 标签：c#, .net, bitarray

我有

```
var previous = new BitArray(new bool[]{true});
var current = new BitArray(new bool[]{false}); 
```

我想连接它们。我已经尝试过：

```
var next = new BitArray(previous.Count + current.Count);
var index = 0;
for(;index < previous.Count; index++)
    next[index] = previous[index];
var j = 0;
for(;index < next.Count; index++, j++)
    next[index] = current[j];
previous = current; 
```

但这看起来并不是最好的方法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-05T23:56:38.040

不幸的是，您的方法看起来可能和它一样好 - 如果 BitArray 实现了 IEnumerable<T> （而不仅仅是 IEnumerable），那么我们可以使用 LINQ 扩展方法使它更漂亮一些。

如果我是你，我会把它包装成 BitArray 上的扩展方法：

```
public static BitArray Prepend(this BitArray current, BitArray before) {
    var bools = new bool[current.Count + before.Count];
    before.CopyTo(bools, 0);
    current.CopyTo(bools, before.Count);
    return new BitArray(bools);
}

public static BitArray Append(this BitArray current, BitArray after) {
    var bools = new bool[current.Count + after.Count];
    current.CopyTo(bools, 0);
    after.CopyTo(bools, current.Count);
    return new BitArray(bools);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-12T20:27:03.877

`Cast<bool>()`在位数组“变为”之后，可以使用 LINQ 执行此操作`IEnumerable<bool>`：

```
var previous = new BitArray(new bool[] { true });
var current = new BitArray(new bool[] { false });

BitArray newBitArray = 
    new BitArray(previous.Cast<bool>().Concat(current.Cast<bool>()).ToArray()); 
```

我认为这种 LINQ 方法不会很快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T23:56:50.537

该框架没有提供这样做的好方法。您可以创建一个足够大的布尔数组来存储两个位数组。然后使用 BitArray.CopyTo 复制 bool 数组中的每个 BitArray（您可以指定从哪里开始插入元素）。

完成此操作后，使用接受布尔数组的构造函数创建另一个 BitArray。

我知道很多工作，但似乎没有其他方法。但是，它的代码比您当前的方法少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-06T11:20:17.013

这是我的 LINQ 实现，其中不包括必须分配布尔数组的开销：

```
var result = new BitArray(first.Count + second.Count);

var i = 0;
foreach (var value in first.Cast<bool>().Concat(second.Cast<bool>()))
{
    result[i++] = value;
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-07-23T15:51:04.407

如果使用 int32 而不是 bools 会更有效，因为 bitarray 在内部使用 int32。

```
public static BitArray Append(this BitArray current, BitArray after) {
    var ints = new int[(current.Count + after.Count) / 32];
    current.CopyTo(ints, 0);
    after.CopyTo(ints, current.Count / 32);
    return new BitArray(ints);
} 
```

如果有人需要，在 Vb.net 中：

```
<Runtime.CompilerServices.Extension()> _
Public Function Append(ByVal current As BitArray, ByVal after As BitArray) As BitArray
    Dim ints = New Int32((current.Count + after.Count) \ 32 - 1) {}
    current.CopyTo(ints, 0)
    after.CopyTo(ints, current.Count \ 32)
    Return New BitArray(ints)
End Function 
```

# visual-studio - 宏“max”需要 2 个参数，但只有 1 个给定

> ID：518517
> 
> 赞同：6
> 
> 时间：2009-02-05T23:46:21.180
> 
> 标签：visual-studio, visual-c++

```
template <class T>
struct scalar_log_minimum {
public:
    typedef T value_type;
    typedef T result_type;
    static
        result_type initial_value(){
            return std::log(std::numeric_limits<result_type>::max());
    }
    static
        void update(result_type& t, const value_type& x){
            if ( (x>0) && (std::log(x)<t) ) t = std::log(x);
    }
}; 
```

尝试编译上述内容时出现以下错误：

functional_ext.hpp:55:59：宏“max”需要 2 个参数，但只给出 1 个

max 不是宏，对吧？那么这个错误是什么？顺便说一句，我正在使用 Visual Studio 2005

还有什么是 55:59 --- 55 是行号 59？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-05T23:49:34.030

您在某处包含一个作为宏`#define`的头文件。`max`最好的解决方案是找出它在哪里被定义，并尽可能禁止它被定义。或者，您可以`#undef`这样做：

```
#include <evil_header_which_defines_max.h>
#undef max 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-06T00:24:14.787

我发现包含 windows.h 后遇到的许多#defines 非常令人不安（不仅是 max 和 min，而且如果我没记错的话，我还遇到了其他通用词（如 Rectangle）的问题）。因此，我养成了只在绝对必要时才包含 windows.h 的习惯，而从不在头文件中包含。这减少了少量特定于平台的 C++ 文件的痛苦。

不幸的是，一些boost库（我相信thread和asio）确实在它们的头文件中包含了windows.h，我仍然不时遇到这种愚蠢的问题。

对于导致问题的其余情况，我的解决方案是在包含头文件后#undef 有问题的符号。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T03:05:50.653

正如其他人所指出的，包括`windows.h`可能是您的问题。Microsoft 提供了一种方法来“关闭”`windows.h`带有预处理器符号的部分。您可以将这些符号定义为构建的一部分或直接在代码中。

使用预处理器符号有条件地跳过可能被认为是优雅的部分，`windows.h`也可能不被认为是优雅的，但在一般情况下，它比`#undef`.

以下是如何跳过定义`min`或`max`作为宏：

```
#define NOMINMAX
#include <windows.h> 
```

请注意，许多包含文件有时会包含`windows.h`. 在这种情况下，在更全局的级别设置定义可能更方便。

如果您搜索`windows.h`，您可以找到许多其他通常有用的预处理器符号（例如 、 和许多其他`NOOPENFILE`符号`NOKANJI`） 。`NOKERNEL`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-05T23:57:28.787

`max`正如亚当所解释的那样，这是一个被称为进入方式的宏。另一种解决方案（更多是“修补程序”）可能是在函数周围加上括号，以防止它被视为宏调用：

```
return std::log((std::numeric_limits<result_type>::max)()); 
```

# java - 从 Java 访问 MS Analysis Services Cube 的最佳方式

> ID：518527
> 
> 赞同：5
> 
> 时间：2009-02-05T23:49:06.557
> 
> 标签：java, mdx

我想从 Java 客户端针对 MSAS 多维数据集发出 MDX。哪些连接方法已被证明是可靠的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-12T15:44:38.873

FWIW 我使用 olap4j 作为 Java 客户端，针对由 msmdpump.dll 提供的 MSAS 服务器。似乎到目前为止工作正常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-11T02:37:45.883

查看[http://mondrian.pentaho.org/](http://mondrian.pentaho.org/)。这是一个支持 MDX/XMLA 的 OLAP 服务器。我知道您需要的是客户端，但请查看服务器随附的 JSP 示例。一个示例涉及基于 XMLA 的 MDX 查询，我认为这应该让您开始。

# ios - 围绕其中心旋转 UIView 但几次

> ID：518530
> 
> 赞同：16
> 
> 时间：2009-02-05T23:49:14.187
> 
> 标签：ios, objective-c, cocoa-touch, uiview, cgaffinetransform

我试图`UIView`围绕它的中心旋转一些，所以简单的代码类似于（在伪代码中）：

```
[UIView beginAnimations:@"crazyRotate" context:nil];
[UIView setAnimationDuration:1.0];
someview.transform = CGAffineTransformMakeRotation(angle);
[UIView commitAnimations] 
```

现在，如果我将角度设置为 M_PI/2，那么它会很好地旋转。如果我将它设置为 2*M_PI，那么它“什么都不做”。我可以理解矩阵转换为什么都不做的东西（旋转 360 在某种意义上意味着“停留”），但是，我想将它旋转 5 次（想想报纸旋转比例对你产生的影响——我不是善于描述，希望有人理解）。因此，我尝试将设置角度添加到 180 度（M_PI）并添加嵌套的`animatationBlock`. 但我想因为我`someview.transition`再次设置相同的属性（）它会以某种方式忽略它）。我尝试使用角度 M_PI 将动画的重复计数设置为 2，但它似乎只是旋转 180，回到直线位置，然后再次启动旋转。

所以，我有点想法，任何帮助表示赞赏！--t

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-06T00:26:09.710

您可以在 UIView 的 layer 属性上使用以下动画。我已经测试过了。

**Objective-C**

```
UIView *viewToSpin = ...;    
CABasicAnimation* spinAnimation = [CABasicAnimation
                                  animationWithKeyPath:@"transform.rotation"];
spinAnimation.toValue = [NSNumber numberWithFloat:5*2*M_PI];
[viewToSpin.layer addAnimation:spinAnimation forKey:@"spinAnimation"]; 
```

**斯威夫特 5.0**

```
let viewToSpin = UIView() // However you have initialized your view
let spinAnimation = CABasicAnimation.init(keyPath: "transform.rotation")
spinAnimation.toValue = NSNumber(value: 5.0 * 2.0 * Float.pi)
viewToSpin.layer.add(spinAnimation, forKey: "spinAnimation") 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-02-28T23:37:19.447

正如 Brad Larson 指出的那样，您可以使用`CAKeyframeAnimation`. 例如，

```
CAKeyframeAnimation *rotationAnimation;
rotationAnimation = 
   [CAKeyframeAnimation animationWithKeyPath:@"transform.rotation.z"];

rotationAnimation.values = [NSArray arrayWithObjects:
                            [NSNumber numberWithFloat:0.0 * M_PI], 
                            [NSNumber numberWithFloat:0.75 * M_PI], 
                            [NSNumber numberWithFloat:1.5 * M_PI], 
                            [NSNumber numberWithFloat:2.0 * M_PI], nil]; 
rotationAnimation.calculationMode = kCAAnimationPaced;
rotationAnimation.removedOnCompletion = NO;
rotationAnimation.fillMode = kCAFillModeForwards;
rotationAnimation.timingFunction = 
   [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
rotationAnimation.duration = 10.0;

CALayer *layer = [viewToSpin layer];
[layer addAnimation:rotationAnimation forKey:@"rotationAnimation"]; 
```

您可以使用该属性控制整个动画的持续时间，以及使用该`rotationAnimation.duration`属性的加速和减速（以及中间步数的计算）`rotationAnimation.timingFunction`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T13:50:59.027

获得连续旋转效果有点棘手，但我在[这里](https://stackoverflow.com/questions/486609/how-can-i-use-animation-in-cocos2d/493680#493680)描述了一种方法。是的，Core Animation 似乎优化了单位圆内最近结束位置的变换。我在那里描述的方法将几个半旋转动画链接在一起以进行完整旋转，尽管您确实注意到从一个动画到下一个动画的切换中有轻微的卡顿。

也许用这些半旋转值构造的 CAKeyframeAnimation 是正确的方法。然后你还可以控制加速和减速。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-22T15:35:04.643

```
CABasicAnimation* animation = [CABasicAnimation animationWithKeyPath:@"transform.rotation.z"];
animation.fromValue = [NSNumber numberWithFloat:0.0f];
animation.toValue = [NSNumber numberWithFloat: 2*M_PI];
animation.duration = 8.0f;
animation.repeatCount = INFINITY;
[self.myView.layer addAnimation:animation forKey:@"SpinAnimation"]; 
```

# entity-framework - 如何将 ADO.net 实体框架与现有的 SqlConnection 一起使用？

> ID：518535
> 
> 赞同：19
> 
> 时间：2009-02-05T23:50:04.933
> 
> 标签：entity-framework, ado.net, sqlconnection

1.  我有一个使用 SqlConnection 的现有 asp.net 网站。
2.  我添加了 ADO.net 实体框架。
3.  我已成功连接到数据库并创建了 .edmx 文件。
4.  我能够通过实体框架使用自动生成的连接字符串进行连接。

我想使用我在整个站点中用于实体框架连接的现有 SqlConnection 对象。
我不想为要使用 ADO.net Entity Framework 的一个页面使用第二个数据库连接，也不想更改整个站点以使用新的 Entity Framework 连接字符串。

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-06T07:00:40.103

该论坛帖子有答案：

```
MetadataWorkspace workspace = new MetadataWorkspace(
  new string[] { "res://*/" }, 
  new Assembly[] { Assembly.GetExecutingAssembly() });

using (SqlConnection sqlConnection = new SqlConnection(connectionString))
using (EntityConnection entityConnection = new EntityConnection(workspace, sqlConnection))
using (NorthwindEntities context = new NorthwindEntities(entityConnection))
{
  foreach (var product in context.Products)
  {
    Console.WriteLine(product.ProductName);
  }
} 
```

“res://*/”是 EF 连接字符串的一部分，它描述了 xml 映射文件的位置——在这种情况下是当前程序集中的嵌入资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T04:06:30.983

您可以使用生成的接受 EntityConnection 的 ObjectContext的[构造函数来执行此操作。](http://msdn.microsoft.com/en-us/library/bb738714.aspx)当您创建[EntityConnection](http://msdn.microsoft.com/en-us/library/cc679371.aspx)时，您将传入您的 SqlConnection。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T05:54:17.210

安德鲁·彼得斯

谢谢您的回答。

我一直在使用 System.Data.EntityClient.EntityConnection。

它就在我的指尖，但我似乎无法让 MetadataWorkspace 参数工作。

## 这是我找到的最接近的例子（标有答案的帖子）：

[http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/dd7b1c41-e428-4e29-ab83-448d3f529ba4/](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/dd7b1c41-e428-4e29-ab83-448d3f529ba4/)

谢谢你的帮助。

# passwords - 为什么 wget 不接受我的用户名/密码？

> ID：518548
> 
> 赞同：8
> 
> 时间：2009-02-05T23:54:14.643
> 
> 标签：passwords, wget

我都试过了

```
wget --user=myuser --password=mypassword myfile 
```

和

```
wget --ftp-user=myuser --ftp-password=mypassword myfile 
```

但我不断收到错误

```
HTTP request sent, awaiting response... 401 Authorization Required
Authorization failed. 
```

我知道文件在那里，而且我知道用户名/密码是正确的——我可以毫无问题地通过 ftp 进入。对这里发生的事情有任何想法吗？我什至如何判断是否`wget`注意我提供的用户名/密码？（如果我只是不提供该信息，则错误是相同的。）

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-25T07:11:51.843

试试 wget --http-user=username --http-password=password http://....

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T23:58:18.427

您使用的是“ftp://”网址吗？从错误消息看来，您正在请求“http://”URL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-03T15:11:54.450

还有一条评论：

为 ftp 和 http 请求设置`--user` 和`--password`设置用户/密码，这样就更通用了。

就我而言，没有任何效果，除了使用`--ask-password`

我使用的是 https 网址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-03T03:37:53.183

如果您需要在必须转义反斜杠之前添加域名，即“\”前面有另一个“\”，例如“domain\\username”，如果密码有任何需要转义的字符，则添加可能会很有用（我想，还没有测试过）。

```
wget --http-user=domain\\\username --http-password=password http://... 
```

# unix - 查看 UNIX 中各个处理器的 CPU 使用情况

> ID：518557
> 
> 赞同：11
> 
> 时间：2009-02-05T23:56:35.263
> 
> 标签：unix, cpu-usage

我正在尝试诊断我认为与 CPU 使用率有关的服务器问题。

但是，当我登录到该框并运行“顶部”时，我看到 %CPU 为 160 或更高。这是因为这是一个多处理器盒子。

如何查看各个处理器的 CPU 使用率？

我怎样才能实时做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-05T23:58:02.530

运行“顶部”

按 1

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-05T23:58:46.973

我们在这里谈论的是什么 UNIX？

`mpstat`如果您使用的是 Solaris 或 Linux，请尝试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-22T08:42:07.173

mpstat -P 全部 5

它将每 5 秒报告一次单独的 cpu 使用情况

# lua - lua 表构造函数

> ID：518571
> 
> 赞同：4
> 
> 时间：2009-02-06T00:01:26.097
> 
> 标签：lua

你如何制作一个默认表，然后在制作其他表时使用它？

例子

```
--default table
Button = {
 x = 0,
 y = 0,
 w = 10,
 h = 10,
 Texture = "buttonimg.png",
 onClick = function() end
}

newbutton = Button {
 onClick = function()
  print("button 1 pressed")
 end
}

newbutton2 = Button {
 x = 12,
 onClick = function()
  print("button 2 pressed")
 end
} 
```

newbuttons 将 y、w、h 和纹理设置为默认值，但括号中设置的任何内容都会被覆盖

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T12:17:22.943

您可以通过将 Doug 的答案与您的原始场景合并来实现您想要的，如下所示：

```
Button = {
   x = 0,
   y = 0,
   w = 10,
   h = 10,
   Texture = "buttonimg.png",
   onClick = function() end
}
setmetatable(Button,
         { __call = function(self, init)
                       return setmetatable(init or {}, { __index = Button })
                    end })

newbutton = Button {
   onClick = function()
                print("button 1 pressed")
             end
}

newbutton2 = Button {
   x = 12,
   onClick = function()
                print("button 2 pressed")
             end
} 
```

（我实际上对此进行了测试，它有效。）

**编辑**：您可以像这样使它更漂亮和可重复使用：

```
function prototype(class)
   return setmetatable(class, 
             { __call = function(self, init)
                           return setmetatable(init or {},
                                               { __index = class })
                        end })
end

Button = prototype {
   x = 0,
   y = 0,
   w = 10,
   h = 10,
   Texture = "buttonimg.png",
   onClick = function() end
}

... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T04:02:26.343

如果您将新表的元表设置`__index`为指向`Button`它将使用`Button`表中的默认值。

```
--default table
Button = {
 x = 0,
 y = 0,
 w = 10,
 h = 10,
 Texture = "buttonimg.png",
 onClick = function() end
}

function newButton () return setmetatable({},{__index=Button}) end 
```

现在，当您使用它们制作按钮时，`newButton()`它们会使用`Button`表中的默认值。

这种技术可用于类或原型面向对象的编程。[这里](http://lua-users.org/wiki/ObjectOrientedProgramming)有很多例子。

# sql - SQL - 计数（）问题

> ID：518576
> 
> 赞同：2
> 
> 时间：2009-02-06T00:02:51.117
> 
> 标签：sql, sql-server, tsql

我有一张带有费用/信用列的表格：

```
Item | PriceVal | CostVal | CHARGE_CODE
1        5             3         CH
2        8             5         CH
1       -5            -3         CR
3        7             1         CH
4       15            10         CH
1        5             3         CH 
```

我有查询需要获取 NET 价格和成本，但我也对 NET 费用感兴趣。现在我有：

```
SELECT Item, SUM(PriceVal), SUM(CostVal)
FROM Table
GROUP BY Item 
```

如何获得具有值的另一列

```
COUNT(SUM(CHARGE_CODE=CH)-SUM(CHARGE_CODE=CR)) 
```

我不知所措。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T00:06:23.917

count() 将为每个不为空的值计算一个，所以我不认为这正是你想要的。取出计数，然后取出

```
sum(case when charge_code = CH then costval else 0 end) 
- sum(case when charge_code = 'CR' then costval else 0 end) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T00:27:32.347

由于您已经在表格中输入了美元值作为负数，您可以使用简单的公式：

```
select
    Item,
    sum(PriceVal),
    sum(CostVal),
    sum(PriceVal-CostVal)
from Table
group by Item 
```

我认为您不应该减去信用项目，因为它们已经是负数。

如果您确实想要交易的净**计数**：

```
select
    Item,
    sum(PriceVal),
    sum(CostVal),
    sum(case when charge_code = 'CH' then 1 else 0 end) -
        sum(case when charge_code = 'CR' then -1 else 0 end)
from Table
group by Item 
```

或者，如果只有两个收费代码，请替换：

```
sum(case when charge_code = 'CH' then 1 else -1 end) 
```

最后一列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T00:11:01.753

不是 100% 确定你想要什么，但你只能像这样计算某些行：

```
SELECT COUNT(IF(CHARGE_CODE=CH,1,NULL)) ... 
```

并且类似地对某些行的某些值求和，如下所示：

```
SELECT SUM(IF(CHARGE_CODE=CH,PriceVal,0)) ... 
```

# wpf - 为什么我不能在 ComboBox 中选择空值？

> ID：518579
> 
> 赞同：48
> 
> 时间：2009-02-06T00:03:44.203
> 
> 标签：wpf, data-binding, combobox

在 WPF 中，似乎不可能（用鼠标）从 ComboBox 中选择“null”值。**编辑**澄清一下，这是.NET 3.5 SP1。

这是一些代码来说明我的意思。首先，C# 声明：

```
public class Foo
{
    public Bar Bar { get; set; }
}

public class Bar 
{
    public string Name { get; set; }
} 
```

接下来，我的 Window1 XAML：

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <StackPanel>
        <ComboBox x:Name="bars" 
                  DisplayMemberPath="Name" 
                  Height="21" 
                  SelectedItem="{Binding Bar}"
                  />
    </StackPanel>
</Window> 
```

最后，我的 Window1 类：

```
public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();

        bars.ItemsSource = new ObservableCollection<Bar> 
        {
            null, 
            new Bar { Name = "Hello" }, 
            new Bar { Name = "World" } 
        };
        this.DataContext = new Foo();
    }
} 
```

与我一起？我有一个 ComboBox，其项目绑定到 Bar 实例列表，其中一个为空。我已将窗口绑定到 Foo 的一个实例，并且 ComboBox 正在显示其 Bar 属性的值。

当我运行这个应用程序时，ComboBox 以空显示开始，因为 Foo.Bar 默认为空。没关系。如果我使用鼠标将 ComboBox 放下并选择“Hello”项目，那也可以。但是，如果我尝试重新选择列表顶部的空项目，ComboBox 将关闭并返回其先前的“Hello”值！

使用箭头键选择空值按预期工作，并且以编程方式设置它也可以工作。它只是用不起作用的鼠标进行选择。

我知道一个简单的解决方法是拥有一个表示 null 的 Bar 实例并通过 IValueConverter 运行它，但是有人可以解释为什么用鼠标选择 null 在 WPF 的 ComboBox 中不起作用吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2015-04-28T13:50:24.640

好吧，我最近遇到了与*ComboBox的**空*值相同的问题。我已经通过使用两个转换器解决了这个问题：

 *1.  对于*ItemsSource属性：它将集合中的**空*值替换为转换器参数内部传递的任何值：

    ```
    class EnumerableNullReplaceConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            var collection = (IEnumerable)value;

            return
                collection
                .Cast<object>()
                .Select(x => x ?? parameter)
                .ToArray();
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotSupportedException();
        }
    } 
    ```

2.  对于*SelectedValue*属性：此属性与单个值相同，但有两种方式：

    ```
    class NullReplaceConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            return value ?? parameter;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            return value.Equals(parameter) ? null : value;
        }
    } 
    ```

使用示例：

```
<ComboBox 
    ItemsSource="{Binding MyValues, Converter={StaticResource EnumerableNullReplaceConverter}, ConverterParameter='(Empty)'}" 
    SelectedValue="{Binding SelectedMyValue, Converter={StaticResource NullReplaceConverter}, ConverterParameter='(Empty)'}"
    /> 
```

结果：

![在此处输入图像描述](https://i.stack.imgur.com/YsFK8.png)

注意：如果您绑定到*ObservableCollection*，那么您将丢失更改通知。此外，您不希望集合中有多个*空*值。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-12-14T23:12:38.767

**键盘根本没有选择空“项目” - 而是取消选择了前一个项目，并且没有（能够）选择后续项目。** 这就是为什么在用键盘“选择”空项目后，您无法重新选择先前选择的项目（“Hello”）——除非通过鼠标！

*简而言之，您既不能选择也不能取消选择 ComboBox 中的空项。当您认为这样做时，您宁愿取消选择或选择上一个或新项目。*

最好通过为 ComboBox 中的项目添加背景来看到这一点。当您选择“Hello”时，您会注意到 ComboBox 中的彩色背景，但是当您通过键盘取消选择它时，背景颜色会消失。我们知道这不是空项，因为当我们通过鼠标下拉列表时，空项实际上具有背景色！

以下 XAML（根据原始问题中的内容进行了修改）将在项目后面放置一个 LightBlue 背景，以便您可以看到此行为。

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <StackPanel>
        <ComboBox x:Name="bars" Height="21" SelectedItem="{Binding Bar}">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <Grid Background="LightBlue" Width="200" Height="20">
                        <TextBlock Text="{Binding Name}" />
                    </Grid>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>
    </StackPanel>
</Window> 
```

如果您想要进一步验证，您可以处理 ComboBox 上的 SelectionChanged 事件，并看到“选择 null 项”实际上在其 SelectionChangedEventArgs 中给出了一个空的 addedItems 数组，以及“通过用鼠标选择'Hello'来取消选择 null 项”给出 RemovedItems 的空数组.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-04-18T07:39:02.097

我为这个问题找到了一个新的解决方案。“使用 Mahapps”

```
 xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"

  <ComboBox x:Name="bars"  **controls:TextBoxHelper.ClearTextButton="True"**
              DisplayMemberPath="Name" 
              Height="21" 
              SelectedItem="{Binding Bar}"/> 
```

[![在此处输入图像描述](https://i.stack.imgur.com/bJIen.png)](https://i.stack.imgur.com/bJIen.png)

[![在此处输入图像描述](https://i.stack.imgur.com/WgK6R.png)](https://i.stack.imgur.com/WgK6R.png)

您可以使用关闭按钮来清除内容。

谢谢。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-17T08:08:03.387

我知道这个答案不是您所要求的（解释为什么它不适用于鼠标），但我认为前提是有缺陷的：

从我作为程序员和用户（不是 .NET）的角度来看，选择空值是一件坏事。“null”应该是没有值，而不是您选择的东西。

如果您需要明确不选择某些东西的能力，我会建议您提到的解决方法（“-”、“na”或“none”作为值），或者更好

*   用一个复选框包裹组合框，可以取消选中以禁用组合框。从用户的角度和编程的角度来看，这让我觉得它是最简洁的设计。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-07-27T22:52:29.190

我花了一天的时间来解决在组合框中选择空值的问题，最后，是的，最后我在写在这个 url 的文章中找到了解决方案：

[http://remyblok.tweakblogs.net/blog/7237/wpf-combo-box-with-empty-item-using-net-4-dynamic-objects.html](http://remyblok.tweakblogs.net/blog/7237/wpf-combo-box-with-empty-item-using-net-4-dynamic-objects.html)

```
public class ComboBoxEmptyItemConverter : IValueConverter 
{ 
/// <summary> 
/// this object is the empty item in the combobox. A dynamic object that 
/// returns null for all property request. 
/// </summary> 
private class EmptyItem : DynamicObject 
{ 
    public override bool TryGetMember(GetMemberBinder binder, out object result) 
    { 
        // just set the result to null and return true 
        result = null; 
        return true; 
    } 
} 

public object Convert(object value, Type targetType, object parameter, CultureInfo culture) 
{ 
    // assume that the value at least inherits from IEnumerable 
    // otherwise we cannot use it. 
    IEnumerable container = value as IEnumerable; 

    if (container != null) 
    { 
        // everything inherits from object, so we can safely create a generic IEnumerable 
        IEnumerable<object> genericContainer = container.OfType<object>(); 
        // create an array with a single EmptyItem object that serves to show en empty line 
        IEnumerable<object> emptyItem = new object[] { new EmptyItem() }; 
        // use Linq to concatenate the two enumerable 
        return emptyItem.Concat(genericContainer); 
    } 

    return value; 
} 

public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture) 
{ 
    throw new NotImplementedException(); 
} 
```

}

```
 <ComboBox ItemsSource="{Binding  TestObjectCollection, Converter={StaticResource ComboBoxEmptyItemConverter}}" 
      SelectedValue="{Binding SelectedID}" 
      SelectedValuePath="ID" 
      DisplayMemberPath="Name" /> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-06T00:49:06.967

这可能无法完全解决您的答案，但希望它朝着正确的方向发展：

1.  你安装SP1了吗？

[来自 Scott Gu 的博客：](http://weblogs.asp.net/scottgu/archive/2008/05/12/visual-studio-2008-and-net-framework-3-5-service-pack-1-beta.aspx)

> *   NET 3.5 SP1 包括对WPF的多项数据绑定和编辑改进。这些包括：
> *   {{ Binding }} 表达式中的 StringFormat 支持，可轻松格式化绑定值
> *   在从 ItemsControl 派生的控件中支持新的交替行，这使得在行上设置交替属性变得更加容易（例如：交替背景颜色）
> *   **更好地处理和转换可编辑控件中的 null 值支持** 将验证规则应用于整个绑定项的项级验证
> *   MultiSelector 支持处理多选和批量编辑场景
> *   IEditableCollectionView 支持将数据控件连接到数据源并以事务方式启用编辑/添加/删除项目
> *   绑定到 IEnumerable 数据源时的性能改进

对不起，如果我浪费了你的时间，这甚至没有关闭..但我认为问题是继承自：

[强类型数据集的约束](http://blog.evolvedsoftwarestudios.com/2008/03/18/allow-null-values-to-be-returned-from-strongly-typed-datasets/)

[NullValueDataSet 在这里解释](http://blogs.msdn.com/smartclientdata/archive/2005/08/13/NullValueForTypedDataSet.aspx)

但是现在 .Net 3.5 的 SP1 应该已经解决了这个问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T13:32:13.853

尝试 Binding.FallbackValue

来自[我打赌你不知道的关于 WPF 中数据绑定的 6 件事](http://interactiveasp.net/blogs/natesstuff/archive/2009/01/21/6-things-i-bet-you-didn-t-know-about-data-binding-in-wpf.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-09T09:01:14.563

我遇到了同样的问题，我们做了一些工作，比如向集合项添加 value 属性，如下所示：

```
 public class Bar

   {
      public string Name { get; set; }
      public Bar Value
      {
         get { return String.IsNullOrEmpty(Name) ?  null :  this; } // you can define here your criteria for being null
      }
   } 
```

然后在添加项目而不是 null 时，我使用相同的对象：

```
 comboBox1.ItemsSource=  new ObservableCollection<Bar> 
        {
            new Bar(),
            new Bar { Name = "Hello" }, 
            new Bar { Name = "World" } 
        }; 
```

而不是 selecteditem 我将它绑定到 selectedvalue ：

```
<ComboBox Height="23" Margin="25,40,133,0" DisplayMemberPath="Name"
              SelectedValuePath="Value" 
              SelectedValue="{Binding Bar}"
              Name="comboBox1" VerticalAlignment="Top" /> 
```

我知道这不是一个完整的解决方案，只是我使用的一种解决方法

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-17T07:41:47.630

ComboBox 需要一个 DataTemplate 来显示项目，无论它多么简单。DataTemplate 的工作方式如下：从 instance.[path] 中获取值，例如

```
bar1.Car.Color 
```

所以它不能从

```
null.Car.Color 
```

它将抛出一个空引用异常。因此，不会显示空实例。但是 Color - 如果它是一个引用类型 - 允许为空，因为在这种情况下不会有例外。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-17T09:01:44.413

只是一个猜测，但我认为这听起来很合理。

假设组合框使用“ListCollectionView”（lcv 作为它的实例）作为它的项目集合，它应该是。如果你是程序员，你会做什么？

我将同时响应键盘和鼠标。

一旦我得到键盘输入，我就使用

```
lcv.MoveCurrentToNext(); 
```

或者

```
lcv.MoveCurrentToPrevious(); 
```

所以，确定键盘工作正常。

然后我正在研究响应鼠标输入。问题来了。

1.  我想听我的项目的“鼠标点击”事件。但很可能，我的 Item 没有生成，它只是一个占位符。所以当用户点击这个占位符时，我什么也得不到。

2.  如果我成功举办了活动，接下来是什么。我会调用

    lcv.MoveCurrentTo(selectedItem);

我认为此处为 null 的“selectedItem”不是可接受的参数。

无论如何，这只是猜测。尽管我可以，但我没有时间调试它。我有一堆缺陷要修复。祝你好运。:)

# c# - 在 WPF 中调用 Dispatcher 的问题

> ID：518581
> 
> 赞同：2
> 
> 时间：2009-02-06T00:04:29.507
> 
> 标签：c#, wpf, multithreading, dispatcher

我有一些 UI 代码需要从我的后台演示者线程中更新。所以，我做了以下事情：从我的后台线程，我在 UI 中设置我的属性：

```
_ui.ConnectionStatus = "A"; 
```

那么，我的设置如下：

```
public string ConnectionStatus
{
    set
    {
        if (Dispatcher.CheckAccess())
            ConnectionStatusTxt.Content = value;
        else
        {
            Dispatcher.Invoke(DispatcherPriority.Normal, (Action)(() =>
                              {ConnectionStatusTxt.Content = value;}));
        }
    }
} 
```

我收到以下错误：

`The calling thread cannot access this object because a different thread owns it.`

我的理解是`Dispatcher`负责调用不同的线程，所以这个错误让我有点困惑。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T00:49:12.350

Another question: what type is value? is this a string? I could imagine that the error might be that value is in fact a UIElement (maybe a Label?) that you create in which case the exception refers to the value object and not to your user control.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T00:27:52.673

你没有说这个setter在里面执行什么对象，但是看起来这个对象的Dispatcher与ConnectionStatusTxt的dispatcher不一样，即包含setter的对象由与ConnectionStatusTxt控件不同的线程拥有。

尝试在 CheckAccess 和 Invoke 语句中使用 ConnectionStatusTxt.Dispatcher。

# ms-access - ArcGIS MapControl 和 Ms Access 延迟地图重绘？

> ID：518582
> 
> 赞同：2
> 
> 时间：2009-02-06T00:04:47.883
> 
> 标签：ms-access, vba, mapping, gis, arcgis

这涉及将 ESRI MapControls 嵌入到 Access 数据库表单中。

我有两个访问文件，分为前端和后端。我的后端也是一个 PersonalGeoDatabase，ArcGIS 使用它来存储一个要素类，以便在来自嵌入式 ESRI 地图控件上显示。

要素类存储与特定 ProjectID 关联的折线、点和多边形。

从前端，我有嵌入的 mapControl，它加载绑定到后端的 MXD 文件。

我有一个名为 CenterPoint 的 VB 函数，巧合的是，它将地图包络围绕项目的关联要素类（如果存在）居中，并设置所需的查看范围。如果项目的要素类尚不存在，它会将地图以包含所有项目的整个区域为中心，提供总体概览。

所以，如果这一切都说得通，而且我没有失去你……

我最初在 Form_Current 事件中调用了 CenterPoint 子。这很有效，因为它执行了所需的所有功能；但是，当 CenterPoint 函数运行时，表单没有响应，在重新绘制完成之前无法更改到另一个记录。这意味着，如果您希望跳过 10 条记录，则必须跳过 1 条，等待重新绘制，跳转另一个，等待重新绘制，等等。我通过优化 MXD 图像和层，但它仍然是不可接受的。

接下来，我尝试建立几秒钟的延迟，然后通过运行以下命令调用 CenterPoint 子：

```
Private Sub Form_Current()
    Dim s_Start As single
    Dim s_Delay As single
    s_Start = Timer
    Do While Timer < s_Start + s_Delay
        DoEvents
    Loop

CenterPoint

End Sub 
```

这通过使用 DoEvents 调用为我提供了所需的响应能力，这意味着我可以在它第一次尝试重新绘制之前单击多个记录。

不幸的是，它显然缓存了所有 Form_Current 调用，如果我跳过 3 条记录，等待延迟结束，然后观看屏幕，它将连续 3 次重新绘制（即运行 CenterPoint）。

更奇怪的是，它是否偶尔给我一个除以零错误的行：

```
Do While Timer < s_Start + s_Delay 
```

尽管没有分工。

所以，我想我的问题是：

1.  有没有办法只运行一次 form_current 调用？
    *   如果没有，在我调用 CenterPoint 函数之前，有没有办法确保用户在给定时间内停留在当前记录上？
2.  有没有办法将我的小于比较与除以零错误隔离，所以至少，即使它会重新绘制多次，用户也可以快速连续点击记录？

现在，我的工作是将 CenterPoint 子作为表单上按钮的单击事件，这可行，但并不理想。

如果其中任何一个没有意义，或者需要更多信息，请告诉我。

谢谢，斯宾塞

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T15:41:48.507

回答您的问题：
1) Form_ Current 将始终在您切换记录时运行。没有选择。因此，下一个最佳选择是将对 CenterPoint 的调用移至另一个事件。我会使用表单计时器事件，并在每次通过 Form_Current 时重置计时器，当计时器用完时，它会关闭 CenterPoint。

```
Private Sub Form_Current()
    Me.TimerInterval = 10000
End Sub

Private Sub Form_Timer()
    CenterPoint
End Sub 
```

2）如果您使用的是表单计时器事件，您可能不再需要此代码；然而，

```
Private Sub Form_Current()
Dim l_Start As long 
Dim l_Delay As long 
Dim l_endTime As long 'or integers - time is returning the number of seconds 
                      'since midnight, not a real... this may be the source 
                      'of your problem

    l_Delay = 1000 ' I didn't see you set s_Delay any where
    l_Start = Timer
    l_endTime = l_Start + l_Delay 'lets do the calculation only once.

'This might break down if the user switch records just before midnight
'(never ending loop)
'    Do While Timer < l_endTime 
'        DoEvents
'    Loop

    'Instead I would do this
    Do While (Timer <= l_endTime) _
                and (l_start <= timer)
        DoEvents
    Loop

    CenterPoint

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T22:55:47.350

Another possibility would be to keep the call in the OnCurrent event, but use a time flag outside the OnCurrent to determine whether or not to call the subroutine.

```
 Static s_Start As Single
  Dim s_Delay As Single

  If s_Start = 0 Then
     s_Start = Timer
  End If
  If Timer > s_Start + s_Delay
     Call CenterPoint
     s_Start = 0
  End If 
```

Now, that's air code, so I may have a mistake or two in it, but the idea is that you run the code only once the delay has expired. And once it's expired, you set the start time back to 0 so that counter will start over again.

The result is that the call to CenterPoint will happen only on those OnCurrent events that happen after your delay has expired.

# symfony1 - 如何在 Symfony 中格式化外部 URL？

> ID：518592
> 
> 赞同：0
> 
> 时间：2009-02-06T00:12:00.427
> 
> 标签：symfony1, url-routing

我发现有关 Symfony 路由系统的文档很难理解，我需要一些帮助。

我想将我的外部 URL 格式化为如下所示...

我的网站/模块/伊利诺伊州/芝加哥/

通过表格，用户可以按城市、州或城市和州进行搜索。

我认为路由规则类似于： url: module/:state/:city

但是如果只搜索城市或只搜索州呢？Symfony 错误说有一个错误，因为缺少路由参数。

处理这个问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T00:30:13.997

当您在路由中定义参数时，Symfony 要求指定该参数。因此，在您的情况下， :state 和 :city 都必须在 url 中指定。

如果您想让这些参数中的一个或两个成为可选参数，您可以尝试使用 *（未命名通配符）路由语法。看起来像这样：

```
some_route_name:
  url:    /module/*
  param:
    module: module
    action: search 
```

此路由将匹配如下所示的 url：

*   /模块/城市/芝加哥
*   /模块/状态/伊利诺伊州
*   /模块/州/伊利诺伊州/城市/芝加哥
*   /模块/城市/芝加哥/州/伊利诺伊州

我知道这并不理想，因为 'city' 和 'state' 在 url 中。但这是使用 Symfony 的路由系统做你想做的最简单的方法。

然后，在您的控制器中，如果用户未指定城市或州，您将转发到 404：

```
$this->forward404Unless($this->getRequestParameter('city') || $this->getRequestParameter('state')); 
```

如果这还不够好，您还有其他一些选择。如果您使用的是 1.1 或 1.2，则可以对路由对象进行子类化以使其执行您想要的操作。或者您可以使用多个路线来做您想做的事情（一个是 /module/:city_or_state，另一个是 /module/:state/:city）。

# c# - 我怎样才能成为一个更好的 C# 程序员？

> ID：518609
> 
> 赞同：24
> 
> 时间：2009-02-06T00:21:04.090
> 
> 标签：c#, code-complete

当您可以创建类并做一些简单的事情（GUI、阅读文本文件等）时，我该从哪里开始？我已经开始阅读 Code Complete 2nd Edition，它很棒，但更像是一本通用的编程书籍。接下来我应该学习哪些主题？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-02-06T00:25:44.470

我认为，在某些时候，它不再是关于**主题**的。这是关于**做事**。您必须编写代码，并且必须编写很多代码。

人们经常会告诉你在学习一门新语言时找到一些小众问题来尝试解决，这很好，但是如果有一个应用程序或应用程序的功能你真的喜欢使用或非常欣赏，那么尝试构建它（或部分它）你自己。更重要的是，如果您发现自己想知道*嘿，[此应用程序] 是如何做到**的？！***尝试构建它。

您的许多项目可能永远不会在您的桌面之外看到曙光，但是您将拥有的学习、经验和工具将是您可以带到每个后续项目中的东西。

但是，您永远不会知道，其中一个小爱好项目最终可能会为某人解决问题。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-06T00:31:35.737

不要不同意那些说“写东西”的人，但是接下来你应该学习的一个主题是 CLR 的基本原理——所有这些库背后的引擎的工作原理。一个很好的资源是 Richter 的“CLR Via C#”。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-06T00:26:14.143

编写一个桌面 RSS 阅读器。您将接触到许多不同的领域（解析文件、图形应用程序、HTTP、互联网的脆弱性），并且您可能实际上每天都会使用这些结果。选择一个特定的目标或特征来努力将帮助你比抽象的东西更快地学习。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-06T00:54:46.550

到目前为止，我同意大多数答案，但是我认为，如果您想作为开发人员进行改进，则可以通过不单独运行而受益匪浅。试着找一个可以指导你的人。多年来，通过与比我更聪明、更有经验的程序员合作，我在理解的深度上取得了最大的进步。（他们仍然是:-)）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-06T00:34:44.827

学习另一种语言并将学到的知识应用于 C#。

F#、Scala、Haskell - 很多选择:)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-06T00:36:04.683

获取 ReSharper，启用所有建议并了解它们。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-10T00:35:43.100

学习最佳实践和软件工程以及如何将它们应用到 C#。

学习版本控制、TDD、领域驱动开发、持续集成、MVC、MVP、少数模式：外观、工厂、存储库与活动记录等。

学习可以帮助您避免重新发明轮子的工具：验证应用程序块、NHibernate 等。

几天前，我从 CodeBetter 的人那里找到了这本免费的电子书： [link text](http://codebetter.com/blogs/karlseguin/archive/2008/06/24/foundations-of-programming-ebook.aspx "编程基础")

我还没有读完它，但它看起来像一个很好的阅读。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-06T10:16:37.663

尝试阅读 Mono 源代码以了解用 C# 编写的 C# 编译器的外观。你会学到很多关于语言、编译器和计算机体系结构的知识。这是一个有源代码的项目的巨大好处——你可以从中学习。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-06T01:09:59.717

访问[CodePlex.com](http://codeplex.com)和[GitHub.com](http://github.com)并寻找您可以贡献的开源项目。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-06T01:42:34.457

查看stackoverflow的q/a，c#主题。:-D

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-06T01:52:28.553

最好的学习方式是真正陷入困境并构建一些很酷的应用程序、网站等等。跟上各种网站以学习您可能没有遇到过的新东西仍然是一个好主意。

也许建立下一个 facebook 或 google :)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-06T08:30:40.793

还有一个好方法是参与一个有多个成员（可能是朋友）的小项目，这样你就可以互相学习，看看其他人是如何做他们的事情的。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-06T08:56:27.107

*   阅读代码
*   编写代码
*   测试代码
*   阅读书籍（[一些建议](https://stackoverflow.com/questions/477748/what-are-the-best-c-net-books/477751#477751)）、博客等。
*   重复

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-06T10:03:24.803

编写好的单元测试并尝试尽可能高的代码覆盖率

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-06T10:08:19.740

自己写代码，读别人写的代码。但是，不是其他任何人；一个你确信他写出好的、干净、聪明的代码的人。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-06-21T22:35:18.033

*   与更好的程序员一起工作- 获得**工作**
*   从事大型开源项目。

我不同意这里的大多数人的观点，即通过自己构建东西来学习是最好的方法。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-06T00:30:34.460

写代码，很多。而不是那些毛茸茸的小 HelloWorld 类型的程序。

找到一个您感兴趣的真实项目或您已经编写的可以转换为 C# 的项目并执行此操作。只有通过实践（不幸的是，犯了很多错误），我们才能学习。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-06T00:32:06.097

实践，看看开源项目，完全理解它是做什么的以及它是如何做到的，尤其是复杂的库，比如 mocking 框架、ORM 等

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-06-21T22:50:36.223

CLR 通过 C# 一本好书！帮助（仍然帮助）我了解了很多语言你也可以下载c#语言规范书

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-06-21T23:02:40.990

如果您想成为更好的 C#（替换为任何其他语言），请在大型应用程序上工作，这种应用程序具有某些“必须”功能，您知道您还不知道如何实现它们。围绕这些核心“坚果到破解”的所有简单内容也会对您有所帮助.. 习惯于在项目中考虑大型、相互交织的依赖关系总是很好的，这会迫使您思考和布局最终产品的架构前期。

这不是特别与 c# 相关，但如果你想成为一个更好的开发人员，这类项目（隐含包括大量 ((c)lean) 编码和测试等）是最好的学习基础。

如果没有一个客户想“给你机会”用你目前的技能来从事这样的项目，那么继续（或无论如何）开始在开源项目上编码，并留住朋友、同事和类似的地方涉及stackoverflow。

准备好并敞开心扉去犯“错误”（因为你可能会在之后判断它们）......因为只有无数错误才会让你看到它们之间的狭窄/多风路径。

话虽如此，学会不要过度设计或过早变得过于完美主义。会出现错误，考虑到某些影响条件等，错误甚至可能保留在最终产品中，作为工程师/开发人员学会忍受。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2010-02-17T03:47:38.317

建议您**深入阅读 C#**。这是对 C# 的深入探讨，将极大地增强您对该语言的理解。据传作者 Jon Skeet 是这个网站的潜伏者……

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-02-06T02:49:52.730

使用一种新语言，尝试解决一些[Project Euler](http://projecteuler.net/index.php?section=problems)问题。同时提高数学**和**编码**！**

# scrum - 您使用哪种团队决定的惩罚措施来应对每日 Scrums 的迟到？

> ID：518612
> 
> 赞同：2
> 
> 时间：2009-02-06T00:23:04.710
> 
> 标签：scrum

以下是关于 Scrum 的 Wikipedia[文章](http://en.wikipedia.org/wiki/Scrum_(development))对每日 Scrum 的评价：

> 会议准时开始。通常会有团队决定对迟到的惩罚（例如金钱、俯卧撑、在脖子上挂一只橡皮鸡）。

你觉得这是一种很好的做法吗？过去你发现什么自我惩罚有效？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-06T00:28:13.157

当我成为 Scrum Master 时，我们总是准时开始，无论是否每个人都在场。如果人们不成功，他们就会错过——没有机会与团队的其他成员就他们的进步和阻碍进行交流。根据我的经验，这种情况只需要一到两次，并且团队会自我控制——人们知道我们准时开始，准时结束，如果你不在那里，你就会错过——不需要惩罚，一切都完成了受同侪压力。

顺便说一句，每天将您的 scrum 时间设置为相同的时间，并考虑到人们的工作模式，即 - 上午 9:00 并不适合所有人，但 10:00 应该可以，最好是 9:50，跑 10 分钟然后你不要破坏其他人的会议。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-06T00:30:08.080

我认为这是不好的做法。我现在的雇主在周一早上 9 点安排了我们每周的补习（遗憾的是没有每日会议），当人们不准时时，我们就会冲上屋顶。*与其生气和口头惩罚人们，不如把会议安排在人们不太*可能迟到的时间对我来说更有意义。比如正常上班时间后的 20-30 分钟，这样人们就有机会进去，在通勤后让自己平静下来，也许喝杯咖啡，也许检查一下他们的电子邮件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-06T02:11:15.427

[MrTelly 的回答是最明智的，但让我补充一点]

从幼儿园起就没听过“迟到”这个词！

也许每个准时到达的人都应该收到一张金星贴纸，而任何迟到的人都没有得到。大厅里可以展示一个带有每个人的金色星星的海报板，让游客可以很容易地看到谁是好孩子。

严肃地说，职业环境中的惩罚概念是荒谬的。迟到的人会错过部分会议。如果这导致他们的绩效下降或影响项目，他们会因此受到谴责*，*如果问题没有得到纠正，他们最终会被解雇。

如果您像对待孩子一样对待您的开发人员，如果他们表现得像孩子一样，请不要感到惊讶。反之亦然。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T00:27:30.597

这就像一瞥方法论的崩溃。

1分，兰博

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-06T01:09:11.527

在我的书中，“惩罚”人的概念是荒谬的。如果你有一些人不能执行他们被支付执行的任务，我认为你把他们放在一边，找出是什么阻碍了他们。是工作环境，个人问题，还是其他？大多数时候，应该有一些可以做出的改变或指导，以使某人免于失业。如果情况无法解决，则以专业的方式终止此人。但是公开嘲笑某人，像孩子一样对他们大喊大叫，或者强迫他们为自己的错误付出代价？这对建立人没有任何帮助，并且可能会使您面临诉讼。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-06T00:24:49.497

我一般不喜欢它。当你上班迟到时，你的老板应该惩罚你而不是你的同事。这只是一个非常糟糕的主意。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-06T00:26:43.033

当然，一开始是为了证明一个观点，但如果你必须不止一次这样做，或者对惩罚进行长时间的思考，那么你的团队中的人就错了。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-06T00:28:04.340

任何以“惩罚”员工为有效概念的工作环境都可以加息。

不过，奇怪的是，罚款对我来说是罚款。显然，在我看来，这不是惩罚，而是罚款。从理论上讲，我花费了其他人的生产力，所以我可以接受这会花费我一些钱。其他的基本上都是基于羞辱，这是不明智的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-06T00:41:23.673

没有人喜欢这些“惩罚”，但现实情况是，会议可能在下午 2 点举行，人们仍然会迟到。我工作过的每个办公室都遇到过在会议开始 5 分钟后出现的人（而且并不*总是相同的人）的问题。*有时是因为他们在整点前 5 分钟打了“5 分钟”的贪睡。有些人只是不够体贴，无法准时出现，你如何惩罚他们并不重要。有时是因为他们的最后一次会议一直持续到一个小时结束。（为了我自己的利益，我试着在整点前 5 分钟结束自己的会议。）

但是，说了这么多之后，我们每次都将 0.50 美元放入一个罐子里，在迭代结束时，有人会走到面包店买一个馅饼（通常是 5-6 美元）来庆祝迭代的结束。所以，这是一种惩罚，但同时它也给了我们一些甜点。;)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-11-06T07:31:19.073

我们有一个有趣的做法，可以保持心情轻松（对于迟到或任何其他“违规行为”），但仍然可以传达信息。如果有人迟到了会议（我们总是会在没有他们的情况下开始），他们会得到“罚款”。罚款记录在案，当一个人累积 4 次罚款时，他们必须为团队带来午餐。

我们会对其他事情进行罚款，例如在会议期间您的电话响铃（不是静音）等。它可以很好地保持精力充沛，将我们作为一个团队聚集在一起，我们对此大笑，但信息很清楚，有些事情是不可接受。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-06T16:44:52.980

这些惩罚的目的是让人们意识到参加会议很重要。虽然安排在人们可能能够做到的时间是有意义的，但事实是，如果允许的话，有些人总是会迟到。要么他们的时间管理技能很差（在开发人员中并不少见），要么他们认为会议是浪费时间并且以一种不那么微妙的方式反抗。无论哪种方式，他们不仅伤害了自己，而且伤害了团队的其他成员，并且需要某种方式给他们留下深刻印象。

然而，大多数开发商也对上面施加的惩罚感到不满。我的建议是让你的团队，而不是你（作为 scrum 管理员）来决定适当的惩罚。然后，不情愿的参加者对他们的同龄人负责，而不是在权威的支配下。以我的经验，最有效的“惩罚”是那些刺激到足以避免但不困难或羞辱的惩罚；可能会为团队中的其他成员拿一杯咖啡；监控第二天的每日构建；买甜甜圈。

# php - 在同一个 Apache 服务器上运行 PHP 和 Ruby 有什么问题吗？

> ID：518613
> 
> 赞同：12
> 
> 时间：2009-02-06T00:23:53.633
> 
> 标签：php, ruby-on-rails, apache, hosting

我们正试图找出在我们可用的服务器中分发我们的应用程序的最佳方式，这些服务器的数量很少。

假设有足够的 RAM 和 CPU 能力，我们有什么理由不应该在同一个 Apache 服务器中运行`mod_php`和（乘客）？`mod_rails`他们会以某种方式发生冲突或冲突吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-06T00:29:56.413

在同一个 Apache 服务器上运行 mod_php 和 mod_rails 几乎没有风险。

事实上，Passenger 不会影响 Apache，因此它与 Apache 和 mod_php 一起使用实际上是一个不错的选择。从[乘客建筑概述](https://www.phusionpassenger.com/documentation/Design%20and%20Architecture.html#_overview)：

> 应该注意的是，Ruby on Rails 应用程序与 Apache 不在同一地址空间中运行。这将Passenger 与其他应用程序服务器内部网络服务器软件（例如mod_php、mod_perl 和mod_ruby）区分开来。如果 Rails 应用程序崩溃或内存泄漏，它对 Apache 没有影响。事实上，稳定是我们的最高目标之一。乘客经过精心设计和实现，因此 Apache 不应该因为乘客而崩溃。

# javascript - 从 Flash 调用的 JavaScript 代码在哪个线程上执行？

> ID：518618
> 
> 赞同：16
> 
> 时间：2009-02-06T00:25:43.003
> 
> 标签：javascript, flash, actionscript-3, multithreading, actionscript

据我了解，所有 JavaScript 代码都是事件驱动的，并且在单个浏览器线程上执行。

但是，我有一些 JavaScript 函数是从位于同一页面上的 SWF 对象中调用的。此代码是否以与常规 JS 代码相同的方式运行，还是在某个单独的 Flash 线程上运行？

如果它在单独的线程上，我可以使用 setTimeout() 让它在 JS 事件线程上运行吗？例如：

```
function calledFromFlash() {
    setTimeout(doActualWork, 0);
}

function doActualWork() {
    // blah blah blah
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-06T00:30:54.773

它仍然在同一个线程上。但是，出于大多数实际目的，如果您有如此长时间运行的 JavaScript，您担心您的“主要”任务可能会阻止来自 setTimeout 的调用，您应该考虑重新访问您的底层方法。

**赏金更新：**

为了扩展 JavaScript 中更一般的线程问题，有[一个很棒的讨论](https://stackoverflow.com/questions/2734025/is-javascript-guaranteed-to-be-single-threaded)，Bobince 给出了一个非常有启发性的答案。他引用了一些非常有趣的场景，这些场景可能会质疑我们是否真的可以将 JS 视为单线程，他的结论是“不完全”。

我同意评论的结论是，从 JS 运行时内部的角度来看，宇宙是单线程的，但是**由于 JS 沙箱周围的基础设施*不是*单线程的，它可以到达沙箱内部并弄脏以意想不到的方式与状态**。从运行时内部，一些未知实体可以“暂停自然法则”并改变周围的事物。但是运行时没有线程构造来本地处理该场景。

我认为解决这个问题的最重要方法是问在实际场景中多线程是什么意思？通常线程问题归结为诸如同步之类的问题，我们必须假设浏览器供应商已经为我们解决了这些问题，因为 JavaScript 没有原生结构，甚至无法自己尝试处理。如果没有工具来修复它，那么绞尽脑汁是没有好处的；没有互斥锁或锁。

因此，撇开这些灾难性问题不谈，我们可能会遇到一些事情，比如某个值可能会意外地从我们下面被改变。但是编写良好的代码应该可以接受。即使在 Bobince 的示例中，所涉及的所有代码仍然是我们自愿包含在页面中的代码（甚至是我们自己编写的），所以可以肯定的是，如果在您的主调用堆栈表面上“阻塞”时触发该代码可能会令人惊讶。但是再次谈到实际问题，在那种情况下你能对自己做的最糟糕的事情是什么？没什么太严重的。

所以这就是我要说的很长的一段话：我不知道浏览器供应商的任何文档，他们明确地说他们的 JS 实现是否是单线程的，但我质疑这是否重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-17T20:53:35.917

Flash ExternalInterface 调用使用与主应用程序相同的处理线程同步完成。从 Flash 到 JS 的调用被视为与 JS 应用程序中的任何事件绑定相同。

我在[博客](http://labs.tomasino.org/2010/04/01/as3-synchronous-url-xml-loading/)上写过在必要时利用它来发挥你的优势，尽管这通常很麻烦。

这里有一些其他资源指的是这个事实：[链接](http://www.calypso88.com/?p=25) [链接](http://blog.yoz.sk/2010/02/quick-tip-externalinterface-call-is-synchronous/) [链接](http://books.google.com/books?id=Rkm8vNoqlv8C&pg=PA441&lpg=PA441&dq=externalinterface+synchronous&source=bl&ots=ZsRxF7QEMc&sig=V_xCBtdYKNxDpzoTKxjHa7ocZDA&hl=en&sa=X&ei=Vt8VT4fDIoGesQK5svD6Aw&ved=0CDEQ6AEwAg#v=onepage&q=externalinterface%20synchronous&f=false) [链接](http://cookbooks.adobe.com/post_Synchronous_data_calling_with_Flex-7184.html)

我希望这有助于澄清事情。

# php - 在 PHP 中使用 cURL 发送帖子数据的正确方法是什么？

> ID：518623
> 
> 赞同：0
> 
> 时间：2009-02-06T00:26:22.240
> 
> 标签：php, post, curl

在 php 中使用 cURL 在 POST 中发送数据时，您使用将 cURL 选项 CURLOPT_POSTFIELDS 设置为数据

这是一些示例数据 `array('foo'=>'bar','ninja'=>'pirate')`

现在这就是我感到困惑的地方。

我见过的一半示例代码对数组进行了一些预处理，并将数据编码和压缩成格式正确的 url 字符串。

将我们的数据数组转换为：`"foo=bar&ninja=pirate"`，然后将该字符串设置为 CURLOPT_POSTFIELDS 的数据

但是我看到的另一半示例只是将数组直接传递给 CURLOPT_POSTFIELDS ，仅此而已。

令人困惑的部分在于他们都完成了这项工作。鉴于它们都有效，我认为任何一个都不能说是“正确的”。

我可以看到执行字符串方法的唯一优点是您可以在 url 中设置一个没有类似值的参数`"foo=bar&awesome&ninja=pirate"`，而且我不知道您是否可以通过关联数组来做到这一点，因为您无法拥有没有 out 的键一个值（我不认为），但这似乎是在浪费内存，因为您将整个数组复制到一个字符串中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T00:37:54.867

两种方式都可以接受。

问题是; 你宁愿写出代码来“smush the data”还是创建一个数组并让 PHP 来处理它？

如果不确定是否没有理由不选择简单选项，请选择简单选项:) 在这种情况下（据我所知），通过将参数作为数组传递没有什么不能做的，所以将其作为数组传递。

# c# - C#双打显示逗号而不是句号

> ID：518625
> 
> 赞同：10
> 
> 时间：2009-02-06T00:27:15.607
> 
> 标签：c#, currentculture

我和这个帖子里的人几乎有同样的问题：

[转换有句号而不是逗号的浮点数？](https://stackoverflow.com/questions/359298/convert-float-that-has-period-instead-of-comma)

这样我的

```
double x = 234.4;
string y = x.ToString(); 
```

我明白了`y == "234,4"`；

更糟糕的是......`Double.Parse("234.4")`引发异常。

在我被要求使用句号而不是逗号之前，我已经编写了很多代码，所以我希望有**一些方法可以在全局级别更改我的 CultureInfo**。

我可以做的项目中有一些设置吗？

我试过了：

```
 Application.CurrentCulture = CultureInfo.CreateSpecificCulture("en-US");
        Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture("en-US");
        Thread.CurrentThread.CurrentUICulture = new CultureInfo("en-US"); 
```

他们有点工作。它们适用于应用程序的大部分部分，但**驻留在我的 TabControl 选项卡中的所有控件仍然希望使用我的计算机 Localized CultureInfo**。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-06T00:37:10.173

你可以尝试使用

```
double.Parse("...", CultureInfo.InvariantCulture) 
```

和

```
x.ToString(CultureInfo.InvariantCulture) 
```

在您肯定的程序部分中，您需要使用小数点而不是逗号或其他区域设置相关的小数分隔符。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-06T08:10:37.840

感谢 Florin Sabaus 的评论，我找到了解决方案，即放置

```
 Application.CurrentCulture = System.Globalization.CultureInfo.CreateSpecificCulture("en-US"); 
```

在我创建表单之前的 Main() 中。

现在我不必更改所有的 .ToString() 和 Double.Parse() :-) 是的！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T00:44:35.323

试试这个解决方案：http: [//www.codeproject.com/KB/cs/Change_App_Culture.aspx](http://www.codeproject.com/KB/cs/Change_App_Culture.aspx)

# c# - C# 文件创建 - 如何授予 IUSR DELETE？

> ID：518635
> 
> 赞同：0
> 
> 时间：2009-02-06T00:30:24.383
> 
> 标签：c#, security, permissions, ntfs

我有一个用 C# 编写的控制台程序，它在用户 foo 下运行。该程序创建一个文件。在某些情况下，在 IUSR 下运行的 Web 应用程序需要能够删除控制台应用程序创建的文件。

创建文件时，我想将 DELETE（或任何等效项）授予 IUSR。我怎样才能在 C# 中做到这一点？

我找到了[FileIOPermission](http://msdn.microsoft.com/en-us/library/system.security.permissions.fileiopermission(VS.80).aspx)，但我不确定它的用途，但由于您无法指定特定用户，我很确定这就是我现在需要的。

有人对如何做到这一点有很好的指导吗？

[顺便说一句，我意识到在某些圈子中授予对任何文件的 IUSR DELETE 权利是一件相当狡猾的事情，但在这种情况下，所涉及文件的性质意味着我很高兴将这些权利授予 IUSR]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T01:57:19.480

@Sabau：感谢您对答案的修改-它启发了我再试一次，这一次我似乎已经解决了。我编写了一个小测试程序，以便其他人可以看到它是如何完成的。对于我的测试，我完全控制了IUSR，但显然你可以添加/拒绝任何你喜欢的东西。

```
 using System;
using System.Collections.Generic;
using System.Text;
using System.IO;
using System.Security.Permissions;
using System.Security.Principal;
using System.Security.AccessControl;

namespace GrantingFilePermsTests
{
    class Program
    {
    static void Main(string[] args)
    {
        string strFilePath1 = "E:/1.txt";
        string strFilePath2 = "E:/2.txt";

        if (File.Exists(strFilePath1))
        {
        File.Delete(strFilePath1);
        }
        if (File.Exists(strFilePath2))
        {
        File.Delete(strFilePath2);
        }

        File.Create(strFilePath1);
        File.Create(strFilePath2);
        // Get a FileSecurity object that represents the
        // current security settings.
        FileSecurity fSecurity = File.GetAccessControl(strFilePath1);

        // Add the FileSystemAccessRule to the security settings.
        fSecurity.AddAccessRule(new FileSystemAccessRule("IUSR_SOMESERVER",FileSystemRights.FullControl,AccessControlType.Allow));

        // Set the new access settings.
        File.SetAccessControl(strFilePath1, fSecurity);

        }
    }
} 
```

感谢大家的回复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T00:42:59.677

使用 Windows 资源管理器 -> 选择文件所在的目录 -> 右键单击​​ -> 属性 -> 安全选项卡 -> 将“修改”权限授予 IUSR_xxx 用户帐户。

我假设您可以物理访问同时运行控制台应用程序和 Web 应用程序的计算机。

已编辑：对于 ntfs 权限的编程设置，您需要摆弄**System.Security.AccessControl.FileSecurity**类和**File.SetAccessControl**方法。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T00:43:56.807

一个快速的谷歌搜索产生[了用 C# 设置 NTFS 权限](http://weblogs.asp.net/cumpsd/archive/2004/02/08/69403.aspx)

# c# - 在 C# 中将 RichTextFormat 信息转换为 HTML 的最佳解决方案是什么？

> ID：518646
> 
> 赞同：6
> 
> 时间：2009-02-06T00:32:58.717
> 
> 标签：c#, html, rtf

在 C# 中将 RichTextFormat 信息转换为 HTML 的最佳解决方案是什么？

我知道那里有图书馆可以做到这一点，我很想知道你们是否对哪些图书馆更好有任何建议。

谢谢，杰夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T01:34:04.613

我最近使用了一个效果很好的 RTF 到 HTML 转换器，称为 DocFrac。

它可以与 GUI 一起使用来转换文件，但它也是一个 DLL。

我在几分钟内将 400 多个 RTF 文件转换为 HTML，因此性能也很好。我使用了 GUI，所以我没有关于 DLL 的详细信息。但是，根据该站点，DLL 可以与 .NET 一起使用。

[SourceForge 的 DocFrac](http://sourceforge.net/projects/docfrac/)

更新：固定链接，因为 www.docfrac.net 不再存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-23T08:48:45.907

尝试将此库 RTF 用于 HTML .Net。它支持 RTF 到 HTML 和文本到 HTML 的转换方式。完整版不是免费的，但有免费试用版。

此代码可能有用：

```
 SautinSoft.RtfToHtml r = new SautinSoft.RtfToHtml();

        //specify some options
        r.OutputFormat = SautinSoft.RtfToHtml.eOutputFormat.XHTML_10;
        r.Encoding = SautinSoft.RtfToHtml.eEncoding.UTF_8;

        string rtfFile = @"d:\test.rtf";
        string htmlFile = @"d:\test.html";
        string rtfString = null;
        ReadFromFile(rtfFile,ref rtfString);

        int i = r.ConvertStringToFile(rtfString,htmlFile);
        if (i == 0)
        {
            System.Console.WriteLine("Converted successfully!");
            System.Diagnostics.Process.Start(htmlFile);
        }
        else
            System.Console.WriteLine("Converting Error!");
    }

    public static int ReadFromFile(string fileName,ref string fileStr)
    {
        try
        {
            FileInfo fi = new FileInfo(fileName);
            StreamReader strmRead = fi.OpenText();
            fileStr = strmRead.ReadToEnd();
            strmRead.Close();
            return 0;
        }
        catch 
        {
            //error open file
            System.Console.WriteLine("Error in open file");
            return 1;
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-22T10:14:55.817

ScroogeXHTML，一个用于 RTF 到 HTML / XHTML 转换的小型库，可能很有用。但是它只支持 RTF 标准的一个子集。对于带有表格和其他高级布局的报告，还有其他库，例如 Logictran R2Net 转换器。

# debugging - 如何调试 Sybase ASE 中的存储过程？

> ID：518649
> 
> 赞同：6
> 
> 时间：2009-02-06T00:36:48.520
> 
> 标签：debugging, stored-procedures, sap-ase

是否有来自 Sybase 或其他地方的好工具可以让我在 Sybase ASE 中调试存储过程？我需要能够设置断点和观察点。

以前，在 Sybase ASA（不是 ASE）中，我使用 Sybase Central 来执行此操作。有一个 ASE 插件，但我怀疑它会让我调试程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T05:59:53.933

Sybase ASE 带有一个名为 sqldbgr 的命令行调试器。不是最用户友好的选项，但它确实有效。您可以在实用程序指南中找到相关文档。

或者，Embarcadero 生成一个[SQL 调试器](http://www.embarcadero.com/products/debugger)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T08:04:22.650

您可以看看 Sybase Workspace。它是一个支持 Sybase 数据库服务器的数据库工具。它带有调试工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-07T18:35:17.587

我似乎记得 Embarcadero SQL Debugger 用于调试 ASE 中的存储过程。我认为它是 DBArtsian 的插件。查看他们的网站以获取更多信息。

干杯，

凯文

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-12T17:02:22.553

CAST SQL Builder（由 castsoftware.com 提供）有一个调试器，您可以在其中执行所有常见任务、步入、结束、监视变量、从临时表中选择等等。这是一个很棒的工具，不幸的是，对于家庭使用来说，它很贵。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-23T13:11:50.093

Allethrin 提供了完整的答案。

但是为此：
*唉，我需要调试一些现有的过程以确定它们是否会在系统的其他地方实现新功能时中断*
您当然不需要存储过程调试器。只需阅读存储过程代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-19T01:43:05.670

Werysoft 的 SQL 编辑器 QweryBuilder 有一个用于 Sybase ASE 的调试器：[http ://www.werysoft.com/](http://www.werysoft.com/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-29T21:35:07.223

Aqua Fold 的 Aqua Data Studio 具有用于[Sybase ASE](http://www.aquafold.com/aquadatastudio/sybase_sql_debugger.html)和其他（Oracle、DB2 LUW 和 SQL Server）的 SQL 调试器。

此外，Sybase ASE 附带了一个名为 sqldbgr 的命令行 sp 调试器。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-02-09T07:15:00.863

使用 Oracle SQL 开发人员。我目前正在使用此工具通过 JDBC 连接到 Sybase ASE 数据库。这似乎是基于 Eclipse 的，但响应速度非常快，并且还允许您查看函数和过程的源代码。还有一个调试器可用。

要创建新的 Sybase 连接，在“新建/选择数据库连接”窗口中，只需单击 Sybase 选项卡，输入您的主机名/端口/用户名/密码，选择要访问的数据库，就是这样。

而且这个软件是免费的！我喜欢 Oracle 的一件事是他们免费提供了这么多好东西（想想 ADF 的 JDeveloper IDE、JRockit JVM 和 Mission Control，以及这个工具）。

[http://www.oracle.com/technology/products/database/sql_developer/index.html](http://www.oracle.com/technology/products/database/sql_developer/index.html)

# emacs - 年轻人使用 Emacs？

> ID：518669
> 
> 赞同：38
> 
> 时间：2009-02-06T00:45:46.660
> 
> 标签：emacs, ide

我是一名爱上 Emacs 的大学生。我过去使用过 IDE，虽然 Intellisense 之类的功能很难切换到 Emacs，但我现在认为 Emacs 功能更强大，而且 Intellisense 之类的功能可以根据语言的不同模式与各种模式非常匹配（我是不是指 M-/)。我很高兴为我需要的所有东西编写 Elisp 代码，这些代码不是由模式或 Emacs 本身提供的，我喜欢它适应和塑造我的需求的方式。

然而，我确实认为它的主要缺点是它的学习曲线相当陡峭，而且大多数新程序员甚至不会因为许多常见的误解而开始学习它。

所以，我想知道作为 Emacs 用户的年轻人（或者任何在 IDE 出现之前没有开始使用 Emacs 的人）的意见。只是为了让我们确信 Emacs 在我们热爱 Eclipse 的一代中并没有消亡 =)。（也欢迎使用 Jedit 等任何其他高度可扩展的编辑器的用户提出意见）

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-06T00:54:53.290

我选择的“高度可扩展的编辑器”是 vim。10 年前，17 岁时开始使用 vi，我还没有真正回头。我喜欢尽可能远离鼠标。

这些天我很少使用编译语言工作，所以我觉得我在 IDE 中唯一缺少的就是语法补全。不断切换到浏览器来查找各种 PHP 函数的参数顺序有点乏味。

PS：我不想在这里开始一场 vi/Emacs 大战。我怀疑 Emacs 和 vi[m] 用户之间的共同点比任何一个组与 IDE 的共同点要多。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-02-06T02:33:14.073

我今年 62 岁，使用 emacs 已经 21 年了。我能够在紧要关头使用 vim，但我真的更喜欢 emacs。

很久以前（在 1970 年代）我曾经使用过东元，我也喜欢那个。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-06T02:40:41.577

首先，你为什么要在意别人的看法？很明显，Emacs 有一个充满活力的社区，因为有很多扩展和很多人在核心工作。有很多支持。

如果您“担心”其他编辑器更好，那么您应该尝试这些编辑器并自己做出决定。只有你自己知道你喜欢什么。

也就是说，我很年轻（23 岁）并且使用 Emacs。我已经使用了将近 15 年。我尝试过其他编辑器，包括 Vim、Eclipse、Netbeans 和 Textmate。就我而言，这些编辑器都没有 Emacs 好用，所以我觉得我做出了正确的选择。但是，我不能告诉你做出哪个选择。你必须自己弄清楚。

值得注意的是，我对 Emacs 非常“投入”。我维护了很多扩展，并且花了很多时间了解 Emacs 核心......所以如果我切换编辑器，我会浪费很多时间和经验。从理论上讲，这可能会影响我的判断，但我认为不会。Textmate 的工作方式与 Emacs 类似，但功能较少。（我尽量不使用鼠标，所以 eyecandy 和 OS X 的集成对我没有太大帮助。）Netbeans 和 Eclipse 非常适合管理 Java 项目，但在我必须使用 Java 的极少数情况下，我仍然会使用 Emacs更容易使用。我什至发现自己编写 Ant 文件比依赖 Eclipse 的自动构建更接近“我想去的地方”。剩下的就是 Vim，它当然很有特色，但仍然是一个“次要”的 Emacs。Emacs 具有 Vim 的所有特性——如果你想要模态编辑，你可以调用 Viper。使用 Vim 的唯一原因是你已经学过 Vim，受不了 Vim 和 Viper 的键绑定和编辑模型差异。（不，Viper 不是 Vim 克隆。它是带有模态编辑的 Emacs。）

无论如何，JMHO。我认为 Emacs 将在您的整个编程生涯中为您提供良好的服务。（或任何涉及文本的职业。Emacs 非常适合写书……和电子邮件。）

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-06T00:56:22.943

当我年轻的时候，我听说过：一个好的黑客必须精通 4 种编辑器和 4 种语言。

从那时起就一直铭记在心......

我经常使用 vi(m)、(x)emacs、eclipse、sed/awk/perl（是的 .. 它们是文本编辑器）。

恕我直言，掌握一系列工具至关重要。一个人应该每隔一段时间让他的大脑离开舒适区。

我现在发现触手可及有数百个组合键，而且很少将一个组合键键入另一个组合键，这让我感到很惊讶。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-02-06T00:48:14.473

我今年 21 岁，15 岁开始使用 Emacs，最近几年才开始使用 Textmate/E。我个人无法忍受 IDE，觉得它们的阻碍远大于帮助。随时给我一个好的直接文本编辑器。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-02-06T04:34:56.120

我今年 19 岁，去年开始使用 emacs，我很喜欢它。尽管我还不知道如何使用它的“高级”功能，但我对它们的存在感到满意，并且我可以在需要时学习它们。

不过，在我的大学里，使用 Emacs 或 Vi 的学生不应该超过 5 个。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-02-14T17:38:02.180

Fear not, young programmer, and take courage from this [Editor or IDE analysis](http://osteele.com/archives/2004/11/ides). Powerful editors like Emacs will be around as long as there are *language mavens*. And IDE's will continue to serve the *tool mavens*. And each camp will continue to be amazed at how [un]productive the other is. ;-)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-07T09:46:52.043

在有人说服我尝试 emacs 之前，我使用的第一个合适的编辑器是 Brief，然后是一些基于 IDE 的编辑器（在 Windows 上不少于）。然后我做出了决定，我要好好学习那个编辑器，当我需要它来做一些不同的事情时，我会学习如何去做。

选择一个编辑器并坚持使用它的真正好处是一致性。无论您在做什么语言或任务，如果您在您最喜欢的编辑器中，一切都很容易记住。除此之外，可扩展性使通常不在光滑 IDE 上的事情成为可能。

当然，缺点是您的 emacs 会话是一个精心设计的环境。如果我没有加载我的 .emacs，它看起来像是一个陌生的环境。事情几乎但不太像我习惯的那样工作。幸运的是，有了 DVCS 系统，我的完美环境就是一个 git clone 了。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-06T01:10:16.410

嗯，我在大学开始使用 Emacs，我才 30 岁，所以我认为我算作“热爱 Eclipse 的一代”的一部分。

我不是每天都使用它，但 Emacs 肯定在我的工具列表中名列前茅。（而且比 Eclipse 高得多，我可以告诉你。）

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-02-06T02:36:19.293

我是一名 19 岁的大学生，但我在 2-3 年前开始学习 Emacs。我尝试了 vi(m) ，但我无法忍受模态编辑模型。

在我介绍 Emacs 之前，我使用 Gedit 和 nano 来完成我所有的编码工作。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-02-06T03:39:36.623

如果你去大多数研究生院，你会发现坚持使用 emacs 的 UNIX 黑客的份额，所以它肯定存在。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-02-18T09:41:43.853

我是 22 岁的 emacs 用户，每当我不得不离开它在其他 IDE 上做某事时，我都会哭。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-02-13T13:21:34.037

我今年 28 岁，大约一个月前从 vim 切换到 emacs。我在学习 lisp 的同时学习了一点 emacs。我从 vim 切换，因为编译器/调试器/shell 集成对我来说很有意义，而且我喜欢可扩展性/定制的想法。

我有一些与我一起工作的顽固的 eclipse / intellij 人，他们很年轻，并且在考虑进行转换时正在摩擦他们的下巴。缓冲哲学几乎足以卖掉一个厌倦了 IDE 中的选项卡的人。

我不认为这与年龄无关 - 那些正在考虑使用 emacs 的人具有足够的前瞻性，能够意识到它具有足够强大的功能/想法，学习曲线是/可能值得的。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-06T02:11:22.103

我今年 21 岁，我使用 vim。与我一直在使用的其他编程编辑器相比，这是一个真正的进步，我会推荐计算机科学课程中的任何其他人尝试一下。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-06T01:31:20.407

我今年 23 岁，在我们的操作系统课程中，emacs 被教授为“你应该使用的 C 编辑器”。我在课程中使用了它，但已经转向其他更适合我的工作流程和日常开发环境的 IDE。

**编辑**因为我的原始帖子完全没有帮助。

我通过 PuTTY 内部的命令终端使用 emacs，这就是我使用它的程度。作为一名编辑，我并不介意它，并且使用快捷方式足够好，可以提高工作效率。我还没有真正探索过 emacs 编辑器，因为我已经在使用 eclipse 并且非常喜欢它。

现在，我每天都在使用 eclipse，因为它是一种可扩展的语言，我必须使用 Java、ActionScript、JavaScript、PHP、CSS、HTML 甚至 Scheme 来开发它。我还有一个正在完善的自定义 eclipse 扩展，它可以帮助我在全职利基（WordPress 开发）中提高工作效率。Eclipse 提供 FTP 和 SSH 服务，我对接口的熟悉时间比任何其他 IDE 都要久，这就是我使用它的原因。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-02-06T16:29:37.350

我出生于 1970 年*，但大约 6 年前回到（返回）编程领域，从 Visual Basic 6 开始（ay-yi-yi！）。一位同事将他所有的 Perl 硬编码在一个文本编辑器（包括表单）中，这让我大吃一惊，但没有进入。慢慢地，我开始使用不起眼的 MS 记事本来记录……打电话时的笔记，全天打开的任务等等。慢慢地，我开始想要更多。许多其他因素（希望更接近正则表达式，学习 LISP 的旧愿望 [我在 80 年代长大，如果你明白我的意思的话]）引导我通过几个编辑器，最后到 Emacs。

现在，我对 IDE 感到沮丧，因为我无法按自己的意愿进行按键导航和调整。

*好吧，所以我可能不再是一个“年轻人”——但是当我开始使用 Emacs 时，我已经 30 多岁了，并且被认定为这样。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-14T18:07:50.440

I'm a 19 year old college student who uses Emacs - I started using it about a year ago and haven't looked back.

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2010-05-29T05:41:31.707

I am under 30 and I use emacs.

Currently, I has to interface with computer through software speech recognition. Nothing beats emacs because various commands are easy to program for recognition and create aliases.

now, it took me some time to get comfortable with programming in elisp, but I think benefit was worth it. I have tried using eclipse, but there is something about emacs, particularly extensibility, that it's hard to replace.

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2010-05-29T05:48:47.767

Mostly I use **gedit**. Simple and sweet. I'm 20 and always hated IDEs (I got my start with Netbeans in high school).

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-02-06T01:23:13.373

我今年 26 岁，我使用 VIM 进行 C++ 开发已有好几年了。我所有的队友都使用 VIM 或 Emacs（50% 对 50%，我们时不时地大发雷霆），我们的领导也使用 VIM。这是我们在 Solaris 上的最佳选择。然而，对于像 DirectX 这样的大型 MS API，我使用 VS ......有时切换起来很痛苦，但解决这种怪物要容易得多:)

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-02-06T04:13:27.913

我今年 21 岁，现在使用 vim 已经 3 或 4 年了...当我的一位老师告诉我它比 Vim 更好时，我曾经尝试过 emacs...但我更喜欢使用 vim 的工作流程...

上周我尝试使用 emacs，因为我在缩进 html 文件时遇到了问题……但是当我的队友开始谈论组合键或类似的东西时，我失去了我。我的猜测是 vim 或 emacs 是两个很棒的编辑器……它比我知道的大多数 IDE 都要好。

向大家竖起大拇指。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-06T04:25:54.673

我今年 20 岁，去年夏天我开始使用 Emacs，当时我不得不在 linux 上编写 c++ 代码，而 Emacs 是我可以在 openSUSE 上使用的唯一编辑器（Kate 太可怕了，太可怕了！——尤其是我的工作机器有点慢）。然后我被征服了；对于讨厌老鼠的人来说，世界上真的没有比这更好的了。现在我使用 emacs（是的，在 Windows 上......）用于各种事情，包括使用 dired 和玩俄罗斯方块进行文件操作；）

话虽如此，我仍然在 Visual Studio 中编写 c#（偶尔切换到 emacs 以进行主要的重构和样板工作，这在 emacs 中要容易得多 ^100）。如果 emacs 有智能感知（有效），那么我会将文本编辑器转储到 VS Studio 中（不过我仍然会使用 GUI 设计器，没有什么可以替代它）；到目前为止，不得不查找类对我来说在 emacs 中编写 c#.NET 实在是太痛苦了。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-02-06T03:44:20.780

这些天我几乎没有离开我的 VIM，在那些我发现自己被迫进入 IDE 的应用程序上，我很快就记住了原因。我已经习惯了用于选择、替换、折叠等的 VIM 热键，以至于我的工作效率下降了。

和其他人一样，我很少使用编译语言了，所以我设置了运行 Perl/PHP 的快捷方式，粘贴解释器以查找语法错误。在某些情况下，我什至将 VIM 设置为通过相同的界面运行可用的单元测试。alt-tab 返回浏览器（最好在另一台显示器上）并点击“Control-R”进行刷新也很容易，所有这些都无需触摸鼠标。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-02-06T05:13:17.963

Emacs 没问题；它并不能完全完成我喜欢 jEdit 做的所有事情，但我对花时间为我的编辑器编写宏和插件不感兴趣——我喜欢把事情做完。如果我需要我的编辑器做一些不同的事情，我会得到另一个编辑器或安装其他人的插件。

我使用过 jEdit、Visual Studio、notepad++、TextWrangler。我讨厌 VIM。

* * *

讽刺……

我现在全职使用 emacs。在上述答案几个月后，我对 Linux 进行了很多远程登录，而 nano 变得过于狭窄。而且，是的，我花时间为 emacs 编写宏和插件。jEdit 还是不错的，但 emacs 更好。仍然不要使用 vim（还没有？）。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-08-20T15:54:19.193

我现在只使用 emacs 大约 10 年。有一次，我决定转而学习它（和 vi），以便更舒适地直接在服务器上进行编辑。

在语法错误的情况下快速编写代码并且几乎没有危险信号时，使用 IDE 就像在处理带刺的植物时戴上手套：您不必那么小心。（与使用 emacs 进行写作相比，这也就像使用带有自动拼写修复和语法检查的文字处理器一样。）

因此，我主要使用 Eclipse/Xcode/other-required-IDE，除非涉及快速更改、服务器上的直接编辑或其他远程/快速编辑场景。

我没有做的是环顾四周，看看是否有任何好的 emacs 模式允许它像其他 IDE 一样提供快速的编辑帮助（尽管，默认模式确实有很大帮助，无论如何——这不是原始文本编辑，真的）。

最近，当我意识到 Mac OS UI 的大部分都可以使用 emacs 命令时，我也有一个惊喜，就像使用 emacs 命令完成 unix 命令行编辑一样。多么酷啊？

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-02-14T17:49:30.200

I'm 17 and I started using Emacs when I was 14, and VIM when I was 15\. I use Emacs for SLIME and ERC mostly now, preferring GVim for editing files and such.

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-02-14T18:25:28.337

Each time I approached a respected guru type about Emacs, they would warn me away. Most of them didn't like it, either. I took that as a clue.

OTOH, I was interested in TECO a long time ago (now you know my age), and I hear Emacs grew out of that. So, I still wonder...

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-02-14T18:33:31.280

You can have my copies of Eclipse, NetBeans and Visual Studio when you pry them from my cold, dead hands!

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-02-07T12:58:42.953

当我开始攻读学位时，我试图学习如何使用 Emacs，但最终我放弃了。部分原因是我的记忆力很差，与我习惯的键盘快捷键相比，它的键盘快捷键非常规。

我几乎所有的编码都是在 TextMate（被称为 Mac 的 Emacs）中完成的。如果我在命令行环境中，那么 ViM 就可以了。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2011-01-19T09:12:36.207

我在 Windows 中编写 J2me 代码，我的公司不会将我强加于某些 IDE。猜猜看，我回到了我的老朋友 Emacs 身边……

我现在 31 岁，我第一次学习 emacs ca 23。但是，这种情况让我改变了很多 IDE：Netbeans、VS.NET、Eclipse 等。

你知道，Emacs 在某些方面仍然胜过其他 :)

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2016-09-23T17:58:18.467

我今年 27 岁，使用 Emacs。大约 8 年前，我在大学时开始使用它，刚开始使用起来很困难，但在相对较短的时间后我就习惯了，现在我非常喜欢它！和它一起工作很愉快。

* * *

## 回答 #32

> 赞同：-3
> 
> 时间：2009-02-14T18:26:43.950

As a 22 year old Visual Studio user I enjoy poking fun at my e-macs using colleagues. When they see how nifty VS with Visual Assist X is they are instantly envious, and spout things like "but it's on Windows" and "Bill Gates is a moron".

I can with hands on heart say that I write code several times faster than my e-macs wielding counterparts.

# .net - 强制自定义 WPF 控件正确调整大小

> ID：518674
> 
> 赞同：6
> 
> 时间：2009-02-06T00:46:50.870
> 
> 标签：.net, wpf, user-controls, wpf-controls

我编写了一个 WPF 用户控件，其中一部分涉及向画布动态添加元素，从而影响所述画布的高度。画布嵌套在网格中。当我动态添加我的元素时，画布的高度会发生变化，但画布最终会延伸到整个控件的边缘之外，而不是导致控件调整大小并使其自身更高。如何强制控件正确调整大小？我觉得我需要调用或覆盖 Measure 或 Arrange，但我对这两种方法都没有运气 - 可能是因为我使用不正确的参数调用它们，或者可能是因为它们不是要调用的正确方法。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-10T16:29:02.130

您的问题是 Canvas 面板不会调整大小以适应其内容。

您提到了测量和排列。你熟悉 WPF 的两遍布局系统吗？阅读这篇文章了解更多信息：[WPF 的布局系统](http://msdn.microsoft.com/en-us/library/ms745058.aspx)。

本文还介绍了不同面板对布局的作用。每种类型的面板都是不同的。

在 WPF 中，元素首先有机会确定它们的大小。小组可以根据孩子的大小来确定他们的大小，或者他们可以要求固定大小而不管孩子的大小。帆布是后者的一个例子。

元素接下来会被告知它们的大小，并要求他们安排自己和他们的孩子。

Grid 面板类型不仅允许行和列，而且非常擅长根据内容自动调整大小。

StackPanel 类型在它所面向的维度中根本不会自动调整大小，但会在另一个维度中自动调整大小。

画布可以自动调整大小以填充空间，但它永远不允许它的孩子自动调整大小。它在指定的坐标处绘制它的孩子，而不关心它们有多大。

我建议尝试只有一行/列的网格。

或者，您可以创建一个具有更好自动调整大小功能的新 Canvas 类。在测量期间，您需要测量子元素并相应地调整 Canvas 的大小。您可能会发现这样的课程对您很有帮助。

这是一篇关于WPF中[自动布局的文章。](http://msdn.microsoft.com/en-us/library/ms748828.aspx)

如果你想创建一个自定义面板，这里有一个子主题：[自定义面板元素](http://msdn.microsoft.com/en-us/library/ms754152.aspx#Panels_custom_panel_elements)。

编辑：还有一件事：您还可以将子元素的宽度/高度绑定到画布上的 ActualWidth 和 ActualHeight 属性，以便子元素调整其父元素的大小。如有必要，您可以使用转换器设置尺寸比。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-09T11:33:41.693

您是否尝试将所有内容（您的自定义控件内容）包装到 Viewbox 中？例如

```
 <UserControl>
    <Border BorderBrush="Black" BorderThickness="1">
        <Viewbox>
            <Grid>
                <TextBlock Name="txtDefault" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="16" Foreground="Black" Opacity="0.5" Text="Default" />
                <TextBlock Name="txtValue" FontSize="16" Foreground="Black" Visibility="Collapsed" />
                <TextBlock Name="txtKey" Grid.Column="1" FontSize="18" Foreground="Black" Visibility="Collapsed" />
            </Grid>
        </Viewbox>
    </Border>
</UserControl> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T08:49:13.127

您需要覆盖控件的 MeasureOverride 方法并从那里返回所需的大小（画布的大小）。然后父控件将调整自身大小以适应它的子控件（如果可以的话）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-23T18:39:26.637

您可以使用 UniFormGrid 来归档它。将列或行设置为 1，以便您可以获得垂直/水平排列的项目

```
<UniformGrid  Columns="1">
   <Button Content="Content 1"/>
   <Button Content="Content 2"/>
   <Button Content="Content 3"/>
</UniformGrid> 
```

# python - 如何操作列表？

> ID：518679
> 
> 赞同：1
> 
> 时间：2009-02-06T00:48:23.567
> 
> 标签：python, list

在计算机代数系统[Sage](http://www.sagemath.org/)中，我需要将一个列表乘以 2。

我试过代码

```
sage: list = [1, 2, 3];
sage: 2 * list 
```

返回

```
[1, 2, 3, 1, 2, 3] 
```

我怎样才能将每个元素乘以 2？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T02:35:43.990

您想将每个元素乘以 2 吗？那将是：

```
[2*i for i in List] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-11T18:19:49.823

或者：

```
import numpy

numpy.multiply(List, 2) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T14:37:11.547

或者先将列表转换为向量：

```
a = vector([1,2,3])
2*a 
```

返回

```
(2, 4, 6) 
```

向量可用于矩阵乘法，并具有可能有用的方法，例如“.dot_product”。

顺便说一句，在 Sage 或 Python 中将变量称为“列表”可能不是一个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-22T03:39:36.163

在 Sage 中操作列表就像在 Python 中操作它们一样，因为 Sage 是基于 Python 的。因此，阅读 Python 列表，您将学会在 Sage 中使用列表做任何您想做的事情。这里：

[http://docs.python.org/tutorial/datastructures.html](http://docs.python.org/tutorial/datastructures.html)

# algorithm - 图形绘制算法 - 我正在尝试渲染有限状态自动机

> ID：518685
> 
> 赞同：8
> 
> 时间：2009-02-06T00:50:31.253
> 
> 标签：algorithm, graph, finite-automata

我想写一些能画出有限状态自动机的东西。有谁知道与此相关的任何算法？

编辑：我应该提到我知道graphviz。我想构建自己的绘图程序/函数，所以我正在寻找的是一些更理论的东西/算法的伪代码。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-06T01:05:15.263

图形绘制是一个相当复杂的主题，因为不同的图形需要以不同的方式绘制 - 没有一种算法适合所有方法。

我可以建议以下资源：

*   [http://cs.brown.edu/people/rtamassi/papers/gd-tutorial/gd-constraints.pdf](http://cs.brown.edu/people/rtamassi/papers/gd-tutorial/gd-constraints.pdf)

这应该是一个很好的起点，第 15 页提供了许多链接和书籍供您跟进。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-06T01:58:18.123

要开始使用图形绘制算法，请参阅这篇著名的论文：

*   “[绘制有向图的技术](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.34.9450)”（1993 年），作者：Emden R. Gansner、Eleftherios Koutsofios、Stephen C. North、Kiem-phong Vo，*IEEE Transactions on Software Engineering*。

它描述了`dot`一个graphviz绘图程序使用的算法。在链接页面上，您会发现更多参考资料。当您搜索“绘制有向图”时，您还会发现更多论文。

此外，您可能会发现[OpenFst](http://www.openfst.org/)很方便，它是用于有限状态机的通用工具包。它有一个名为*fstdraw*的二进制文件，它将以一种可以读取的格式输出一个有限状态机`dot`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T00:54:21.730

查看[Graphviz](http://www.graphviz.org/)。这是一个开源的图形可视化软件。

编辑：查看链接到使用的一些布局算法的[文档部分。](http://www.graphviz.org/Documentation.php)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-17T05:40:53.047

也许，我回答这个问题有点晚了。无论如何，这是对不同类型的图形和可视化它们的算法的非常全面的参考。

[http://www.cs.brown.edu/~rt/gdhandbook/](http://www.cs.brown.edu/~rt/gdhandbook/)

# ruby-on-rails - Ruby 生态系统（rake、capistrano、mongrel 等？）基础知识

> ID：518686
> 
> 赞同：4
> 
> 时间：2009-02-06T00:50:37.573
> 
> 标签：ruby-on-rails, ruby, development-environment

因此，我正在深入研究 Ruby（和 Rails）和一般的后端 Web 开发，在我看来，有一个巨大的 Ruby 项目生态系统似乎是完全必要的。

我正在考虑像 Rake、Rack、Mongrel、Gems、Capistrano 这样的项目。

除了这些应用程序在其各自项目网站上的文档之外，您能否推荐一个好地方来开始深入了解有关创建良好 Ruby 环境的更多信息？

我有很多关于运行 Mongrel、使用 capistrano 部署的问题，而不是列出我脑海中突然出现的每个问题，是否有一个很好的信息库来解决“Ruby 世界”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T04:43:34.030

Pragmatic Programmers 有一本[Deploying Rails](http://www.pragprog.com/titles/fr_deploy/deploying-rails-applications)的书，其中涵盖了其中的一些内容。我要添加到您列表中的一个工具是[Phusion Passenger](http://www.modrails.com/)（又名 mod_rails）。

另外，请参阅我对[Ethan 的](https://stackoverflow.com/questions/517795/whats-the-best-resource-for-learning-rails-for-a-raw-beginner/519095#519095)Rails 资源问题的回答。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T01:04:43.143

我刚刚发布了一个[类似的问题](https://stackoverflow.com/questions/517795/whats-the-best-resource-for-learning-rails-for-a-raw-beginner)，但它专门针对**Rails**学习资源，而不是 Ruby。

如果你只是在潜水，我建议暂时把 Rails 放在一边，只专注于 Ruby。在开始尝试学习 Rails 之前，请先熟悉 Ruby。

一本很棒的 Ruby 书籍是 David Black 的*Ruby for Rails。*但请注意，那本书中的 Rails 章节已经过时。不过，它值得拥有只是为了 Ruby 章节。

如果您不想买书，请尝试[_why 的 Ruby 凄美指南](http://poignantguide.net/ruby/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T00:56:44.940

我刚刚使用了wiki 上的[Howtos](http://wiki.rubyonrails.org/rails/pages/Howtos)。这些作品中的大多数你一开始不需要学习太多。如果您遵循安装说明和基本教程，您将自然而然地使用它们。

Capistrano 是一个你确实需要深入研究的例子——我最近第一次设置它时阅读了这篇[文章，它对我帮助很大；](http://capify.org/getting-started/from-the-beginning)这真的很容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T04:39:08.267

刚刚推出了一系列新的[**Rails 指南。**](http://guides.rubyonrails.org/)提供对基础知识的非常深入的了解。

我建议专注于 Rake 和 Capistrano。关于 Gems 真的没什么可说的，最基本的它只是一种管理 Ruby 代码包的方法，并且可以在您开始时将其视为一个黑盒子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-26T16:12:27.720

您可能想学习可以帮助您更好地理解 Rails 的简单 Ruby 基础知识，例如 gem、数据库或第三方资源。[我知道 TeamTreehouse](http://teamtreehouse.com)非常擅长围绕 Ruby 生态系统进行教学，而[HackCasts](http://hackcasts.io)非常相似，但成本更低。TeamTreehouse 可以教你一切，从 Rails API 到简单的 SQL 再到 MongoDB 数据库。Hackcast 可以教您如何使用这些技能来创建强大的 Web 应用程序。这真的取决于你的需要。谢谢，希望这有帮助！

# c# - C# 设置重新设置

> ID：518700
> 
> 赞同：1
> 
> 时间：2009-02-06T00:57:11.740
> 
> 标签：c#, settings

如何让我的程序记住用户设置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T01:02:58.280

您可以：

*   将设置写入文件
*   在 VS 中使用 Project->Properties->Settings... 创建设置，然后使用

    Properties.Settings.Default.SettingName = "某事"; // 设置设置

    this.Text = Properties.Settings.Default.SettingName; // 使用设置

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T01:15:34.743

看起来您正在寻找[UserScopedSettingAttribute](http://msdn.microsoft.com/en-us/library/system.configuration.userscopedsettingattribute.aspx)

# c# - Clipboard.GetText 返回 null（空字符串）

> ID：518701
> 
> 赞同：46
> 
> 时间：2009-02-06T00:57:33.503
> 
> 标签：c#, .net

我的剪贴板中填充了文本，但是当我运行时

```
string clipboardData = Clipboard.GetText(System.Windows.Forms.TextDataFormat.Text); 
```

我得到一个空字符串。我玩过各种形式的电话，包括：

```
string clipboardData = Clipboard.GetText();
string clipboardData = Clipboard.GetText(System.Windows.Forms.TextDataFormat.UnicodeText); 
```

但结果相同。

我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-02-06T01:06:36.540

您只能从 STA 线程访问剪贴板。Rick Brewster 在 Paint.NET 中对常规的 Edit->Paste 命令进行了一些重构，从而遇到了这个问题。

代码：

```
IDataObject idat = null;
Exception threadEx = null;
Thread staThread = new Thread(
    delegate ()
    {
        try
        {
            idat = Clipboard.GetDataObject();
        }

        catch (Exception ex) 
        {
            threadEx = ex;            
        }
    });
staThread.SetApartmentState(ApartmentState.STA);
staThread.Start();
staThread.Join();
// at this point either you have clipboard data or an exception 
```

代码来自 Rick。[http://forums.getpaint.net/index.php?/topic/13712-/page__view__findpost__p__226140](http://forums.getpaint.net/index.php?/topic/13712-/page__view__findpost__p__226140)

**更新**：[Jason Heine](https://stackoverflow.com/users/337315/jason-heine)很好地添加了`()`after`delegate`来修复模棱两可的方法错误。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2010-04-06T16:06:37.530

老实说，我不知道什么是 STA 线程，但在简单的项目中，`[STAThread]`在方法之前添加它可能会解决问题`Main`：

```
[STAThread]
static void Main(string[] args)
{ (...) 
```

它对我有用，所以我不质疑这种方法；）

* * *

关于装饰器的更多信息`[STAThread]`在博客文章*[为什么需要 STAThread？](http://blogs.msdn.com/b/jfoscoding/archive/2005/04/07/406341.aspx)*.

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-02-02T01:02:27.760

我已经写了这个类，它可以工作，做同样的事情，只需添加你需要的方法就可以轻松改进

```
 Private Class ClipboardAsync

    Private _GetText As String
    Private Sub _thGetText(ByVal format As Object)
        Try
            If format Is Nothing Then
                _GetText = Clipboard.GetText()
            Else
                _GetText = Clipboard.GetText(DirectCast(format, TextDataFormat))
            End If

        Catch ex As Exception
            _GetText = String.Empty
        End Try
    End Sub
    Public Function GetText() As String
        Dim instance As New ClipboardAsync
        Dim staThread As New Thread(AddressOf instance._thGetText)
        staThread.SetApartmentState(ApartmentState.STA)
        staThread.Start()
        staThread.Join()
        Return instance._GetText
    End Function
    Public Function GetText(ByVal format As TextDataFormat) As String
        Dim instance As New ClipboardAsync
        Dim staThread As New Thread(AddressOf instance._thGetText)
        staThread.SetApartmentState(ApartmentState.STA)
        staThread.Start(format)
        staThread.Join()
        Return instance._GetText
    End Function

    Private _ContainsText As Boolean
    Private Sub _thContainsText(ByVal format As Object)
        Try
            If format Is Nothing Then
                _ContainsText = Clipboard.ContainsText()
            Else
                _ContainsText = Clipboard.ContainsText(DirectCast(format, TextDataFormat))
            End If
        Catch ex As Exception
            _ContainsText = False
        End Try
    End Sub
    Public Function ContainsText() As Boolean
        Dim instance As New ClipboardAsync
        Dim staThread As New Thread(AddressOf instance._thContainsFileDropList)
        staThread.SetApartmentState(ApartmentState.STA)
        staThread.Start()
        staThread.Join()
        Return instance._ContainsText
    End Function
    Public Function ContainsText(ByVal format As Object) As Boolean
        Dim instance As New ClipboardAsync
        Dim staThread As New Thread(AddressOf instance._thContainsFileDropList)
        staThread.SetApartmentState(ApartmentState.STA)
        staThread.Start(format)
        staThread.Join()
        Return instance._ContainsText
    End Function

    Private _ContainsFileDropList As Boolean
    Private Sub _thContainsFileDropList(ByVal format As Object)
        Try
            _ContainsFileDropList = Clipboard.ContainsFileDropList
        Catch ex As Exception
            _ContainsFileDropList = False
        End Try
    End Sub
    Public Function ContainsFileDropList() As Boolean
        Dim instance As New ClipboardAsync
        Dim staThread As New Thread(AddressOf instance._thContainsFileDropList)
        staThread.SetApartmentState(ApartmentState.STA)
        staThread.Start()
        staThread.Join()
        Return instance._ContainsFileDropList
    End Function

    Private _GetFileDropList As Specialized.StringCollection
    Private Sub _thGetFileDropList()
        Try
            _GetFileDropList = Clipboard.GetFileDropList
        Catch ex As Exception
            _GetFileDropList = Nothing
        End Try
    End Sub
    Public Function GetFileDropList() As Specialized.StringCollection
        Dim instance As New ClipboardAsync
        Dim staThread As New Thread(AddressOf instance._thGetFileDropList)
        staThread.SetApartmentState(ApartmentState.STA)
        staThread.Start()
        staThread.Join()
        Return instance._GetFileDropList
    End Function
End Class 
```

这是 CSharp 版本：

```
private class ClipboardAsync
{

private string _GetText;
private void _thGetText(object format)
{
    try {
        if (format == null) {
            _GetText = Clipboard.GetText();
        }
        else {
            _GetText = Clipboard.GetText((TextDataFormat)format);

        }
    }
    catch (Exception ex) {
        //Throw ex 
        _GetText = string.Empty;
    }
}
public string GetText()
{
    ClipboardAsync instance = new ClipboardAsync();
    Thread staThread = new Thread(instance._thGetText);
    staThread.SetApartmentState(ApartmentState.STA);
    staThread.Start();
    staThread.Join();
    return instance._GetText;
}
public string GetText(TextDataFormat format)
{
    ClipboardAsync instance = new ClipboardAsync();
    Thread staThread = new Thread(instance._thGetText);
    staThread.SetApartmentState(ApartmentState.STA);
    staThread.Start(format);
    staThread.Join();
    return instance._GetText;
}

private bool _ContainsText;
private void _thContainsText(object format)
{
    try {
        if (format == null) {
            _ContainsText = Clipboard.ContainsText();
        }
        else {
            _ContainsText = Clipboard.ContainsText((TextDataFormat)format);
        }
    }
    catch (Exception ex) {
        //Throw ex 
        _ContainsText = false;
    }
}
public bool ContainsText()
{
    ClipboardAsync instance = new ClipboardAsync();
    Thread staThread = new Thread(instance._thContainsFileDropList);
    staThread.SetApartmentState(ApartmentState.STA);
    staThread.Start();
    staThread.Join();
    return instance._ContainsText;
}
public bool ContainsText(object format)
{
    ClipboardAsync instance = new ClipboardAsync();
    Thread staThread = new Thread(instance._thContainsFileDropList);
    staThread.SetApartmentState(ApartmentState.STA);
    staThread.Start(format);
    staThread.Join();
    return instance._ContainsText;
}

private bool _ContainsFileDropList;
private void _thContainsFileDropList(object format)
{
    try {
        _ContainsFileDropList = Clipboard.ContainsFileDropList();
    }
    catch (Exception ex) {
        //Throw ex 
        _ContainsFileDropList = false;
    }
}
public bool ContainsFileDropList()
{
    ClipboardAsync instance = new ClipboardAsync();
    Thread staThread = new Thread(instance._thContainsFileDropList);
    staThread.SetApartmentState(ApartmentState.STA);
    staThread.Start();
    staThread.Join();
    return instance._ContainsFileDropList;
}

private Specialized.StringCollection _GetFileDropList;
private void _thGetFileDropList()
{
    try {
        _GetFileDropList = Clipboard.GetFileDropList();
    }
    catch (Exception ex) {
        //Throw ex 
        _GetFileDropList = null;
    }
}
public Specialized.StringCollection GetFileDropList()
{
    ClipboardAsync instance = new ClipboardAsync();
    Thread staThread = new Thread(instance._thGetFileDropList);
    staThread.SetApartmentState(ApartmentState.STA);
    staThread.Start();
    staThread.Join();
    return instance._GetFileDropList;
}
} 
```

您可以简单地使用它：Vb.net：

```
Dim Clipboard2 As New ClipboardAsync
MessageBox.Show (Clipboard2.ContainsText()) 
```

夏普：

```
ClipboardAsync Clipboard2 = new ClipboardAsync();
MessageBox.Show (Clipboard2.ContainsText()); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-12-18T15:35:39.303

BoltBait 的代码不适用于 IDataObject，因为数据对象会在线程外丢失信息。一切正常，如果 IDataObject 仅在线程内部使用，如下所示：

```
IDataObject idat = null;
Exception threadEx = null;
String text = "";
Thread staThread = new Thread(
    delegate ()
    {
        try
        {
            idat = Clipboard.GetDataObject();
            text = idat.GetData(DataFormats.Text)
        }

        catch (Exception ex) 
        {
            threadEx = ex;            
        }
    });
staThread.SetApartmentState(ApartmentState.STA);
staThread.Start();
staThread.Join();
// here you can use text, which contains data from clipboard 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-06-15T17:20:22.510

这是一个线程问题。我们必须获得正确的线程并通过委托执行。

我通过每 500 毫秒运行一次的计时器更新我的属性。这是代码：

```
 public delegate void ClipboarDelegate();

    ClipboarDelegate clipboardDelegate = null;

    void clipboardTimer_Elapsed(object sender, ElapsedEventArgs e)
    {
        if (clipboardDelegate == null)
            clipboardDelegate = ClipboarDelegateMethod;

        //Here we get the right thread, most probably the application thread
        Application.Current.Dispatcher.BeginInvoke(clipboardDelegate);
    }

    public void ClipboarDelegateMethod()
    {
        try
        {
            if (Clipboard.ContainsData(DataFormats.Text))
            {
                //It's important to lock this section
                lock (ClipboardString)
                {
                    ClipboardString = Clipboard.GetData(DataFormats.Text) as string;
                }
            }
        }
        catch
        { }
    } 
```

此外，我使用 ClipboardString 制作了一个适当的 DependencyProperty：

```
 public static readonly DependencyProperty ClipboardStringDP =
        DependencyProperty.Register("ClipboardString",
                                    typeof(string),
                                    typeof(MainWindow),
                                    new UIPropertyMetadata(string.Empty));

    public string ClipboardString
    {
        get { return (string)this.GetValue(ClipboardStringDP); }
        set { this.SetValue(ClipboardStringDP, value); }
    } 
```

这样，假设我的控件或窗口，它可以绑定到我在 XAML 中的 TextBox `x:Name="_this"`：

```
<TextBox Name="ClipBoardTextBox"
         DataContext="{Binding ElementName=_this}"
         Text="{Binding Path=ClipboardString, Mode=OneWay}"/> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T20:11:56.167

由于某种原因，BoltBait 的代码不能很好地工作（即使在 staThread.Join() 之后，idat 仍然为空）。我只是在 staThread 委托中做了 Clipboard.GetText() 而不是 Clipboard.GetDataObject() 并且效果很好。

不过谢谢 - 你的代码片段让我在那里 99% :)

# dynamics-crm - 运行 Microsoft CRM 的服务器无法连接，但网络上的所有其他机器都可以

> ID：518706
> 
> 赞同：1
> 
> 时间：2009-02-06T01:00:14.837
> 
> 标签：dynamics-crm

我有一个烦人的问题。

在网络上的每台机器上，浏览到我们的内部 MS CRM URL 都可以正常工作。但是，如果我登录到实际服务器本身并尝试连接相同的凭据，则不起作用。我收到此错误：

HTTP 错误 401.1 - 未经授权 您无权使用您提供的凭据查看此目录或页面。

我想不通。他们在同一个域上，一切都应该没问题。这是一个大问题，因为服务器上运行的应用程序需要连接到 CRM Web 服务 - 并且失败了。

即使使用基本身份验证，我输入用户名和密码也失败了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T04:02:43.487

您可能会遇到环回安全检查。阅读此知识库文章以了解您是否是，以及如何禁用它以便一切正常：http: [//support.microsoft.com/default.aspx ?scid=kb;en-us;896861](http://support.microsoft.com/default.aspx?scid=kb;en-us;896861)

# java - C++ 与托管中这些指针错误的后果

> ID：518708
> 
> 赞同：0
> 
> 时间：2009-02-06T01:00:53.200
> 
> 标签：java, c++, exception, pointers, managed

我将其设为社区 wiki 是为了更好地理解这些错误与其运行时或编译结果之间的语义差异。另外，我在 Java 上的编码时间太长了，我想在 C++ 中更好地学习指针——所以我需要其他人来做。

**Edit2：**我正在重构这个问题。我试图得出的区别是，在托管代码上，这些错误都通过异常统一处理。但是，C++ 并不是那么简单——我想了解在每种情况下您是否*可能*会遇到错误、段错误、可恢复的行为，或者更糟糕的是传播的*无声错误。*请查看我的新具体示例（是的，我知道答案总是“完全按照编码”；毕竟我是一名程序员。我想知道您经常遇到的有趣细节。）

**Edit3：**在下文中，“类”是指类的一个实例。谢谢

错误 1：指针值为 NULL，即指针 == 0

*   托管代码：在运行时引发 NullPointerException
*   C++：？
*   示例：嗯，呃，你有一个指向*类*的指针，但它被初始化为 0。当你将它发送到函数时会发生什么。IE。C++ 没有留下任何类的指示；它只是公共“占位符”的串联。

错误 2：指针指向内存中的*前一个类*，其值为 NULL 或 == 0

*   托管代码：不允许通过内存模型。所有引用的对象都保留在内存中。没有特殊情况？
*   C++：？
*   示例：您有一个指向*类*的指针，并且该类被删除了。然后将指针作为参数传递给函数。显然，出现的问题取决于函数如何处理指向的类。我的问题是：在 STL 上是否有故障安全处理？一个好的专有库？平均开源代码？

错误 3：指针指向的类不属于正确的类或子类

*   托管代码：引发 ClassCastException。
*   C++：[如果错误则更正]编译器试图通过不允许错误的强制转换来解决这个问题。但是，如果这发生在运行时，我认为是未定义的行为。是否存在类似的类对象不会总是爆炸的情况？
*   示例：您的指针被错误地重新分配，使其值完全等于另一个类。我假设您将这个引用的类传递给的函数只会盲目地获取它引用的任何实例变量的偏移量。因此，它错误地解释了原始二进制文件。在 C++ 中没有办法防止这种情况发生吗？和/或……有没有这种能力被永远利用的情况？

错误 4：指针指向类中间（未对齐）或未初始化的垃圾

*   托管代码：内存模型不允许。
*   C++：相当于案例 3？
*   示例：您实际上经常合法地使用它。例如，您可以直接访问 STL 向量的数组 - 这是指向类的中间。然而，似乎也一样容易“错过”？是否存在一个常见的陷阱，您可能会违背自己的意愿发生这种情况，例如如果加载的库与您链接的库不同（并且是否有防止这种情况发生的机制？）

在此先感谢所有贡献者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T01:12:08.247

其中大多数会导致不可预测的行为。引用 Steve McConnell 的 Code Complete 第 2 版“使用指针本质上是复杂的，正确使用它们需要您对编译器的内存管理方案有很好的理解”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T01:35:20.087

出色地。在 C++ 中，在除 case 2 之外的任何情况下取消引用指针都会产生未定义的行为，因此您不知道会发生什么。然而，对于大多数操作系统，取消引用空指针将导致分段错误。

仅在比较中使用指针对于空指针来说很好，但对于除此之外的任何其他情况和情况 2，都没有精确定义（未指定）。

案例 2 是完美定义的。你可以让你的指针指向一个值为 0 的 int。我不明白为什么这样的事情在 C# 中是非法的。可能我误解了你的情况2

对于案例 3，您必须区分指针是否*已经*指向错误的对象，或者您是否仍在尝试使其指向该对象。C++`dynamic_cast`将检查您指向的对象的类型，如果它不是派生的或与您转换为类型的类型相同，那么它会给您一个空指针。但是还有其他类型的转换不会进行该检查，并且会给您留下无效的指针。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T01:37:03.033

1.  *指针值为 NULL，也就是指针 == 0*未定义的行为。编译器可以做它想做的任何事情，包括每次都不同的事情。在大多数基于 unix 的系统下，这将导致分段错误。
2.  *访问已删除的指针*这是未定义的行为。在某些情况下，根据内存分配和使用的确切模式，如果内存没有被其他用途重用，您可能能够使用已删除的指针，就好像它没有被删除一样。这可能导致很难追踪错误。如果你第二次删除指针，你可能会破坏内存分配系统，导致完全不相关的新闻/删除崩溃
3.  *指向不属于正确类或子类的类的指针*C++ 不进行运行时类型检查。它将尝试将内存位置解释为指针的类型。如果尚未在该位置创建正确类型的对象，则它是未定义的行为，并且可能发生任何事情（包括看起来正常工作）。
4.  *指针指向类中间（未对齐）或未初始化的垃圾*同上，未定义的行为。

总而言之，您不能依赖其中任何一个来做任何有价值的事情。设计您的代码以使其不会发生是很重要的。编译器尽其所能提供帮助，因此在尝试欺骗它时要非常小心（例如，强制转换）。编译器最终会报仇雪恨。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T01:52:17.387

这将是我对您的错误的修订版：

错误 1：空指针/引用

*   托管代码：如果是引用则抛出 NullReferenceException，如果是指针则抛出 AccessViolationException（是的！托管代码中存在指针！）
*   本机代码：在 Windows 上，这会导致“访问冲突”（通常称为 AV）。在 Unix 上，这被称为“段错误”。在 Windows 上，这在理论上可以使用异常处理来捕获

错误 2：指向已释放对象的指针

*   托管代码：通常未定义，但很可能是 AccessViolationException。（请注意，这指的是实际的指针使用情况，而不是托管引用，它总是有效的）
*   本机代码：通常未定义，但可能是访问冲突。

错误 3：

*   托管代码：引发异常
*   本机代码：根据转换的类型，如果是静态转换，则将是编译器错误，或者如果重新解释转换，将是未定义的结果。

错误 4：

*   托管代码：未定义
*   本机代码：未定义

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T01:57:44.753

我将仅添加一些信息。指针会做任何你告诉他们做的事情。如果程序可以访问所述内核，则包括覆盖内核。

以第 3 点为例，这是许多针对内核的攻击中使用的技术。找出内核所在的位置并使用指针来更改信息。我绝不是建议有人尝试这样做，我不容忍使用 Rootkit 或任何其他恶意软件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T02:11:14.587

如果您真的想学习指针，因为您想更好地了解您的计算机，请专注于 C 或汇编。事实上，有一些很棒的微型 C 编译器是用 C 编写的，将它们拆开再组合起来。

C++ 降级为 C（我的意思是它可以编译 C 文件），但是在 C++ 中还有很多事情要处理，而对于 C，您可以只考虑指针的基础知识。

我还强烈建议您编译一个 C 程序并用汇编语言通过它进行跟踪（单步调试）。如果你真的想了解底层系统，了解堆栈帧和调用期间发生的事情是非常关键的。

学习这些东西的其他方法：

*   去审计编译器构造中的一个类。
*   使用 PIC 控制器（机器人或计算器）构建一些有趣的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T01:21:46.167

#1 应该抛出一个段错误。

#2、#3 和 #4 可能会起作用，具体取决于方法尝试执行的操作。请记住，在 C++ 中，类代码只存储一次（并且与实例数据分开，这是对象指针引用的内容），因此可以在随机的内存块上调用类方法。例如，以下打印“-1”（使用 g++ 4 测试）：

```
#include <iostream>

class Foo
{
public:
    int x;
    void foo()
    {
        std::cout << x << std::endl;
    }
};

int main(void)
{
    void* mem = malloc(1024);
    memset(mem, 0xff, 1024);
    Foo* myFoo = (Foo*)mem;
    myFoo->foo();
    return 0;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-06T01:23:57.940

在 Windows 下，错误 1 ​​将导致在您尝试访问您没有读取权限的虚拟内存页面时引发访问冲突的结构化 (win32) 异常。Unix 派生的操作系统具有类似的机制，尽管术语不同。

这是明确定义的（如果通常是不受欢迎的！）行为，并且可以被结构化异常处理程序捕获。通常，托管运行时将依赖于引发此异常的底层操作系统，然后对其进行处理并将其转换为托管异常。这比在跟随它之前检查每个指针访问是否为空要有效得多。

# .net - ASP.NET 基于 URL 设置主题

> ID：518711
> 
> 赞同：3
> 
> 时间：2009-02-06T01:02:07.300
> 
> 标签：.net, asp.net, themes

我有一个网络应用程序，到目前为止，它已经被皮肤（只是基本的颜色和徽标，没什么复杂的）给一个公司，但是现在自从与另一家公司合并后，该网站需要被标记为两个独立的公司（操作正是两者都相同，并且它们共享相同的数据）。最简单的方法是复制 Web 应用程序并托管它的两个实例，但这将是一个维护麻烦，我真的只想为同一个站点设置一个 DNS 别名。

基本上我想根据网站的 URL 更改主题。例如 alpha.company.com -> 主题 A beta.comany.com -> 主题 B。

你会建议如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T01:07:40.377

在您的页面（或基本页面）中，进入 PreInit 处理程序（只有 Page 具有此事件，而不是 MasterPage）并执行以下操作：

```
protected void Page_PreInit(..)
{
    this.Theme = GetThemeByUrl(Request.Url);
}

private string GetThemeByUrl(Uri url)
{
    string host = url.Host; //gets 'subdomain.company.com'
    //determine & return theme name from host
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-17T07:59:53.570

最好的方法是覆盖页面类中的 Theme 属性：

检查这个[ASP.NET 主题和从右到左的语言](http://myounes.blogspot.com/2007/06/aspnet-themes-and-rtl-support.html)

```
public override string Theme
{
    get
    {
        if (!string.IsNullOrEmpty(base.Theme))
        {
            return (CultureInfo.CurrentUICulture.TextInfo.IsRightToLeft ? string.Format("{0}.rtl", base.Theme) : base.Theme);
        }
        return base.Theme;
    }
    set
    {
        base.Theme = value;
    }
} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-02-06T01:06:46.667

在 MasterPage.PreInit 事件中使用：

```
Page.Theme = (Request.RawUrl.Contains("...") ? "yellow": "blue"); 
```

或类似的规定...

希望这会有所帮助，弗洛林。

# regex - 使用正则表达式提取 url 的主机部分的最佳方法是什么？

> ID：518727
> 
> 赞同：0
> 
> 时间：2009-02-06T01:08:22.420
> 
> 标签：regex

我正在从我的 url 中提取主机，并且通过设置最后一个 / 可选而被卡住了。正则表达式需要准备好接收以下内容：

```
http://a.b.com:8080/some/path/file.txt
or
ftp://a.b.com:8080/some/path
or
ftp://user@a.b.com/some/path
or
http://a.b.com
or 
a.b.com/some/path

and return a.b.com 
```

所以...

```
(ftp://|http://)? optionally matches the first part
then it gets hairy...
so... without adding ugly (and wrong) regexp here... just in english
(everything that isn't an '@') //optional
(everything that isn't a '/' up to the first '/' IF it's there) //this is the host group that I want
(everything else that trails) //optional 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T01:13:23.313

你需要使用正则表达式吗？大多数语言都支持解析 URL。例如，Java 有它的 java.net.URL，Python 有它的 urlparse 模块，Ruby 有它的 URI 模块。您可以使用它们来查询给定 URL 的不同部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T02:05:17.563

Jeremy Ruten 的答案很接近，但如果 @ 出现在主机名之后的任何位置，则会失败。我建议：

> （不是'@'的所有内容）//可选

(?:[^@:/]*@)?

如果 @ 出现在域之后，冒号和斜杠会阻止匹配超出域。注意非捕获括号。

> （所有不是 '/' 直到第一个 '/' 如果它在那里）//这是我想要的主机组

([^:/]+)

请注意捕获括号。

> （所有其他跟踪）//可选

由于括号捕获主机名且仅捕获主机名，因此无需继续匹配。

所以，把它们放在一起，你会得到：

/^(?:ftp|https?)://(?:[^@:/]*@)?([^:/]+)/

（请注意，前两个括号分组是非捕获的——希望您的正则表达式库支持这一点。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T01:22:34.450

我已经在 PHP 中对此进行了测试，它适用于您的所有示例：

```
/^(ftp:\/\/|https?:\/\/)?(.+@)?([a-zA-Z0-9\.\-]+).*$/ 
```

# .net - 在 x86 目标模式下生成 XML 序列化程序集

> ID：518729
> 
> 赞同：1
> 
> 时间：2009-02-06T01:09:32.353
> 
> 标签：.net, xml-serialization

通常我在为我的 .Net 代码生成序列化程序集的框上打勾是没有问题的。

但是，我只是将平台目标更改为“x86”而不是“任何 CPU”，以解决在 x64 架构上运行时出现的一些问题。

现在，我收到 Trigger.XMLSerialization.dll 引用 Trigger.dll [version=0.0.0.0culture=neutral] 的错误

对此有已知的解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T04:22:14.023

原来这是 SQL Server CLR 对面向平台的程序集的支持中的一个错误。没有可用的修复:(

见[这里](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=361684&wa=wsignin1.0)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T01:12:31.210

如果`sgen`直接在命令行使用会出错吗？

# sql-server - SQL Server 2005 上的简单全文搜索问题

> ID：518730
> 
> 赞同：1
> 
> 时间：2009-02-06T01:09:34.087
> 
> 标签：sql-server, full-text-search

我只是在我的开发数据库上设置了全文搜索。我在表上设置了一个新的全文索引，并在索引中包含了 2 列。第一列称为“description”，是“varchar(100)”，另一列称为“notes”，是“text”列。

我正在尝试执行这样的简单搜索：

```
select *
from myTable
where freetext(description, 'another') 
```

我确定至少有一行的“描述”列包含“另一个”这个词作为第一个词。但是，搜索产生 0 个结果。搜索其他词似乎工作正常。

此外，当我设置全文索引时，我告诉它自动更新索引并立即构建索引。自从我这样做以来，数据库根本没有改变。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T01:11:28.527

SQL Server 将“另一个”视为停用词（干扰词）。因此，出于所有意图和目的，执行`FULLTEXT`搜索时会忽略它。

请参阅`C:\WINDOWS\system32\noise.eng`（这是它安装在我的系统上的位置）以获取完整的噪音/停用词列表。

# sharepoint - PortalSiteMapProvider

> ID：518747
> 
> 赞同：2
> 
> 时间：2009-02-06T01:13:48.710
> 
> 标签：sharepoint, portalsitemapprovider

每次我实例化一个 PortalSiteMapProvider 实例时，它总是默认为根网站集合。

我希望能够从应用程序页面的不同集合中获取站点地图。

因此，上下文默认为根 Web，因为此应用程序页面位于 _layouts 下，并且不托管在任何网站集下。

如何从应用程序页面获取除根 Web 之外的网站集的实例？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T01:17:18.797

您无法通过 PortalSiteMapProvider 读取另一个网站集的层次结构。例如，如果您在 Site Collection A 中，PSMP 只会遍历 A 的树，而不是 B。您必须在 B 中才能遍历 B。

我实施的一种解决方法是编写一个简单的 Web 服务，该服务在网站集中运行并将路径作为参数。它读取自己的 PSMP 并从层次结构中的该点写入 XML 树。从 SC-A 中运行的代码调用存在于 SC-B 中的 Web 服务非常快，尤其是因为 PSMP 可以如此快速地破坏 B 的结构。

**编辑：**

[以下是在 WSS3/MOSS 中创建 Web 服务的说明](http://msdn.microsoft.com/en-us/library/ms464040.aspx)。

这是一些完全没有功能的代码，可以让您朝着正确的方向前进：

```
//method exposed through the web service
public XmlDocument GetTree(string path)
{
    PortalSiteMapProvider psmp = PortalSiteMapProvider.GlobalNavSiteMapProvider;
    SiteMapNode node = psmp.FindSiteMapNode(path);
    return BuildXmlFromNode(node);
}

private XmlNode BuildXmlFromNode(SiteMapNode node)
{
    XmlDocument xml = new XmlDocument();
    reutrn BuildXmlFromNode(node, xml);
}

//recurses down the sitemapnode children
private XmlNode BuildXmlFromNode(SiteMapNode node, XmlNode xml)
{
    XmlElement element = doc.CreateElement("Node")
    element.SetAttribute("title", node.Title);
    element.SetAttribute("url", node.Url);

    xml.AppendChild(element);

    foreach(SiteMapNode childNode in node.ChildNodes)
    {
        BuildXmlFromNode(childNode, element);
    }

    return xml;
} 
```

**请注意**，如果您没有对递归次数设置限制并且您的站点地图层次结构非常深和/或宽，这可能会产生一个巨大的 xml 文档。谨慎使用！

# sql-server - Sql 2008 恢复备份的数据库失败 - 我还能做什么？

> ID：518748
> 
> 赞同：0
> 
> 时间：2009-02-06T01:14:06.137
> 
> 标签：sql-server, backup

我正在尝试将我们的实时数据库恢复到我们的开发盒中。为此，我在投入生产时，TASKS -> 备份 Db。它创建了一个 4Gig 文件。我把它压缩到 2.2Gig。将其下载到我的开发服务器。

在我的开发服务器上，我创建了一个新的数据库（称为“xxxxx”），然后是任务-> 从文件中恢复数据库。我给它 .bak 文件名，全部覆盖然后继续。

当它达到 40% 时，它会失败。这是屏幕截图：

[替代文字 http://img19.imageshack.us/img19/1/restorefailurejl5.png](http://img19.imageshack.us/img19/1/restorefailurejl5.png)

现在，我可以手动压缩 .mdf 和 .log 文件，压缩它们，下载它们，然后将它们附加到我的开发服务器 sql 实例。实际上，我昨晚做了那个，让这个工作..所以工作。

但我不确定为什么备份/恢复方法不起作用？我已经下载了几次 .bak 文件（以防下载损坏）。我也尝试过几次重新压缩和重新备份实时服务器..但是在大约 5 次下载 2Gig 文件之后，我开始变得脾气暴躁:)

我试过做一个`DBCC CHECKDB('live db name', RESTORE_REBUILD)`，效果很好，然后备份，下载，恢复，失败。

我的实时数据库是 sql2008 x64bit，我的开发盒是 x86（32 位），所以我不确定这是否是一个问题。两台服务器都是*10.0 RTM 版本*。

我不想停止数据库以复制 .mdf/.log 文件（因为我相信在数据库运行时您无法访问它们）..这就是为什么我更喜欢备份/恢复方法。

有什么建议么？

## 更新 1

在我发布这个问题之前，我确实做了一个 DBCC CHECKDB ('xxxxx', RESTORE_REBUILD)。我在最初的帖子中注意到了这一点，我现在只是强调了这一点以供将来参考。

当我有机会停止数据库时，我将在此处发布最终结果（并保存文本输出以防有人询问其他信息）。

## 更新 2

我试图将备份恢复到我创建的虚拟实时数据库。失败（相同的错误消息）。我现在正在运行 DBCC CHECKDB('LiveDB')。就在我这样做之前，我停止了 SQL Server*服务*并手动复制备份了 .mdb 和 .log 文件。

## 更新 3

这是 DBCC CHECKDB ('LiveDb') 的结果

> '地址'的 DBCC 结果 对象'地址'的 101624 页中有 1689363 行 '缩略图'的 DBCC 结果 对象'缩略图'的 30 页中有 1197 行 .. CHECKDB 在数据库中发现 0 个分配错误和 0 个一致性错误' LiveDb' DBCC 执行完成。如果 DBCC 打印错误消息，请联系您的管理员。

嗯 :( 还有什么想法吗？我应该使用 RESTORE_REBUILD 或其他一些神奇的参数再次运行 DBCC 吗？

## 最终更新

好的 - 这太奇怪了。在运行 CHECK DBCC 然后进行另一个完整备份（使用我们一直用于 eons 的相同 sql 脚本）之后，还原现在可以正常工作了！我只是不明白:(

看来我现在可以结束工作了。我只是不明白:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T09:20:14.970

这很重要，您可能会遇到实时数据库的问题。

您最近是否在生产服务器上执行过 DBCC CHECKDB？如果没有，请在下一个可能的维护时段执行此操作。

理想情况下，您应该在进行完整备份之前执行 CHECKDB（尽管并不总是可行），以验证您生成的备份是否属于已确认没有问题的数据库。

请随时提出进一步的问题。如果您需要其他帮助，可以直接与我联系。

干杯，约翰

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T08:14:21.437

我们每天早上都做同样的事情。

```
RESTORE DATABASE Accounts FROM DISK = '\\server\F$\SQL_BACKUP\DB.bak' WITH REPLACE 
```

这对我们来说很好。我不确定 x64 > x32 是否会产生影响，我不知道这些平台之间的数据存储方式不同。我们基本上每天晚上都转储我们的实时数据库，然后我们的 SQL 服务器上的一个进程将它们拾取，另一个进程将它们发送到磁盘备份。

上面的命令将为您创建一个新数据库并导入数据，值得一试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T08:14:41.327

听起来您的生产数据库有一些损坏。在您的生产数据库上运行 DBCC CHECKDB 并查看返回的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T08:16:36.767

实时机器上的还原（到不同的数据库）是否失败？如果是这样，请尝试运行 DBCC CHECKDB。

# javascript - jQuery: $().click(fn) 与 $().bind('click',fn);

> ID：518762
> 
> 赞同：116
> 
> 时间：2009-02-06T01:24:14.603
> 
> 标签：javascript, jquery, event-handling

使用jQuery连接事件处理程序时，使用click方法有什么区别

```
$().click(fn) 
```

与使用绑定方法相比

```
$().bind('click',fn); 
```

除了绑定的可选数据参数。

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-02-06T01:30:37.367

对于它的价值，来自[jQuery 源代码](http://code.google.com/p/jqueryjs/source/browse/trunk/jquery/src/event.js#661)：

```
jQuery.each( ("blur,focus,load,resize,scroll,unload,click,dblclick," +
    "mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave," +
    "change,select,submit,keydown,keypress,keyup,error").split(","), function(i, name){

    // Handle event binding
    jQuery.fn[name] = function(fn){
        return fn ? this.bind(name, fn) : this.trigger(name);
    };
}); 
```

所以不，没有区别-

```
$().click(fn) 
```

来电

```
$().bind('click',fn) 
```

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2009-02-06T07:35:32.980

Matthew 的回答 +1，但我想我应该提一下，您还可以一次性绑定多个事件处理程序`bind`

```
$('#myDiv').bind('mouseover focus', function() {
    $(this).addClass('focus')
}); 
```

这是更清洁的等价于：

```
var myFunc = function() {
    $(this).addClass('focus');
};
$('#myDiv')
    .mouseover(myFunc)
    .focus(myFunc)
; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-06T01:29:06.807

有一个不同之处在于您可以使用您拥有的第二种形式绑定自定义事件。否则，它们似乎是同义词。请参阅：[jQuery 事件文档](http://docs.jquery.com/Events)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-23T19:22:39.543

绑定的 [data] 参数仅在绑定时出现一次。

您还可以将自定义事件指定为绑定的第一个参数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-20T21:07:58.947

我发现 .click() 更合乎逻辑，但我想这就是你的想法。

```
$('#my_button').click(function() { alert('BOOM!'); }); 
```

似乎就像你得到的一样简单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-10T17:05:27.797

如果你有谷歌浏览器，他们的开发者工具有一个事件监听器工具，选择你想要监视它的事件的元素。

你会发现尝试这两种方法会导致相同的结果，所以它们是等价的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-09T15:27:10.537

我更喜欢**.bind() ，因为它与****.live()**的接口一致。它不仅使代码更具可读性，而且更容易更改一行代码以使用一种方法而不是另一种方法。

# ruby-on-rails - 为什么这个 Rails 控制器测试失败了？

> ID：518767
> 
> 赞同：3
> 
> 时间：2009-02-06T01:25:41.510
> 
> 标签：ruby-on-rails, testing, tdd, bdd, shoulda

我试图理解为什么这个测试失败了。（我对测试有点陌生。）我正在使用内置的 Rails 测试框架，并添加了 Shoulda gem。

考试：

```
require 'shoulda'

context "on GET to :new" do

  setup do
    get(:new)
  end

  should_render_template :new
  should_not_set_the_flash

end 
```

失败：

```
1) Failure:
test: on GET to :new should render template :new. (SessionsControllerTest)
[/usr/local/lib/ruby/gems/1.8/gems/thoughtbot-shoulda-2.0.6/lib/shoulda/controller   /macros.rb:220:in `__bind_1233882600_699194'
/usr/local/lib/ruby/gems/1.8/gems/thoughtbot-shoulda-2.0.6/lib/shoulda/context.rb:254:in `call'
/usr/local/lib/ruby/gems/1.8/gems/thoughtbot-shoulda-2.0.6/lib/shoulda/context.rb:254:in `test: on GET to :new should render template :new. '
/usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/testing/setup_and_teardown.rb:94:in `__send__'
/usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/testing/setup_and_teardown.rb:94:in `run']:
expecting <"new"> but rendering with <"">

2 tests, 2 assertions, 1 failures, 0 errors 
```

但是，如果我在控制台上运行它，`app.get '/sessions/new'`它可以正常工作，没有错误。

并且 " `new`" 模板在浏览器中按预期呈现。

我正在使用哈姆尔。也许这会导致问题。我的模板叫做“ `new.html.haml`”。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T05:37:18.493

失败表示没有渲染模板。尝试确保您没有被重定向

```
should_respond_with :success 
```

并断言@response.body 的内容只是为了查看发回的内容

```
# This will fail but should give you some clue about what was sent back.
should "sent something back in the body" do
  assert_match 'boohooo', @response.body
end 
```

你也可以断言一个特定的模板，所以你也可以试一试：

```
should_render_template "new.html.haml" 
```

但是，我不怀疑 HAML 是您的问题的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T22:17:55.253

我在使用 Shoulda、Clearance 和 Rails 2.3.2 时遇到了类似的问题。我想我通过修改 shoulda 和 clear 使用“assert_template”的方式解决了这个问题。显然，Rails 中有一个与此相关的开放错误。

请参阅此线程以获取更多信息和我的更改差异（清除和应该更改一行）。

[http://groups.google.com/group/should/browse_thread/thread/8c0a66c80ff4fd76](http://groups.google.com/group/shoulda/browse_thread/thread/8c0a66c80ff4fd76)

# c# - 在 PropertyGrid 上设置 SelectedTab

> ID：518778
> 
> 赞同：2
> 
> 时间：2009-02-06T01:33:31.277
> 
> 标签：c#, propertygrid

有人知道如何以编程方式在 .Net 框架中的 PropertyGrid 上设置选定的 PropertyTab 吗？SelectedTab 属性不可设置，这是可以理解的，因为文档表明您不应该自己创建 PropertyTabs 的实例。但是，我似乎无法在 PropertyGrid 实例上找到相应的方法来调用或设置属性来更改代码中的选项卡，例如 SelectTab(Type tabType) / int SelectedTabIndex { set; }。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T19:07:04.153

海报丹尼尔几乎拥有它。如果您要将其应用到您自己的 PropertyGrid 子类中，这实际上是有效的：

```
 public int SelectedTabIndex 
    {
        set
        {
            Type pgType = typeof(PropertyGrid);
            BindingFlags flags = BindingFlags.NonPublic | BindingFlags.Instance;

            ToolStripButton[] buttons = (ToolStripButton[]) pgType.GetField("viewTabButtons", flags).GetValue(this);
            pgType.GetMethod("SelectViewTabButton", flags).Invoke(this, new object[] { buttons[value], true });
        }
    } 
```

正如 Daniel 所说，这是一种糟糕的形式，完全不受支持，但只要您不必担心跨域访问权限，它就可以工作。

# c# - Sourcesafe 的外部差异工具

> ID：518781
> 
> 赞同：2
> 
> 时间：2009-02-06T01:34:06.830
> 
> 标签：c#, vb.net, diff, visual-sourcesafe

在[podcast 40](https://blog.stackoverflow.com/2009/02/podcast-40/)中提到的一件事是检查源代码控制中的文件之间的差异，以查看前一天做了什么。

是否有任何好的外部工具——我可以自己打开的东西——可以显示自上次签入以来或在单个项目的给定时间范围内更改的所有内容的差异？

我们目前正在使用 SourceSafe，但希望很快会迁移到 TFS。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T01:54:53.777

这个问题有点误导。术语差异/比较工具通常是指用于比较文件的两个版本的内容或将本地文件的内容与源代码控制存储库中的内容进行比较的工具。

如果您想要一个生成两个日期之间修改的所有文件或特定用户更改的所有文件等的报告的工具，请[查看 VSSReporter](http://www.codeproject.com/KB/applications/VssReporter.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T01:57:01.900

不幸的是，据我所知，没有任何外部工具可以集成到 sourcesafe 中。

根据您提出的问题，您可以做的最好的事情是右键单击您感兴趣的文件夹，转到差异，然后单击递归按钮，然后取消选中“相同文件”复选框。另一种选择是做同样的事情，但搜索日期之间的递归历史。

如果你想看看*你*做了什么，你可以通过查看->搜索->状态搜索来搜索你签出的所有文件，文件签出到<你的用户名>，在当前项目+子项目中搜索。

这在 sourcesafe 中确实很慢，在其他版本控制系统中要快得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T08:11:54.077

单独的差异工具不可用，但您可以在此套件中找到它们

SourceAnyWhere(SAW) - [http://www.dynamsoft.com](http://www.dynamsoft.com)

SourceOffSite (SOS) - [http://www.sourcegear.com](http://www.sourcegear.com)

VSS 远程处理 - [http://www.sourceremoting.com](http://www.sourceremoting.com)

这些套件用于远程访问

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T04:46:05.070

一旦你迁移到 TFS，这会更容易一些，因为 TFS 会跟踪变更集中的内容，所以你的签入都是分组的。浏览变更集列表非常容易，您可以查看任何变更集的详细信息以准确了解更改了哪些文件。从那里，只需右键单击，与以前的版本进行比较，即可查看到底发生了什么变化。我一直在使用这个功能。

此外，类似于 FryGuy 在 VSS 中概述的内容，每个变更集都链接到用户，因此很容易浏览来自特定用户的所有变更集，等等。

与尝试在 VSS 中跟踪此级别的内容相比，这是一个**巨大**的改进。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-03T12:47:55.283

您可以在 sourcesafe 中配置其他差异工具，选项->自定义编辑器。

# python - 列表/数组 - 检查日期

> ID：518782
> 
> 赞同：0
> 
> 时间：2009-02-06T01:35:00.993
> 
> 标签：python, sorting

我正在尝试制作一个检查数组的程序，以确保有四个名称部分相同的文件夹。

所以

对于像 0103（1 月 3 日）这样的日期，应该有 0103-1、0103-2、0103-3 和 0103-4。其他文件夹如 0107-1、0107-2、0107-3、0107-4。我该怎么做呢？我考虑过使用 glob.glob (python) 和通配符来确保只有四个匹配项……但我不喜欢这种方法。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T01:46:44.853

```
import os

def myfunc(date, num):
    for x in range(1, num+1):
        filename = str(date) + "-" + str(x)
        if os.path.exists(filename):
            print(filename+" exists")
        else:
            print(filename+" does not exist")

myfunc('0102', 3); 
```

*0102-1 不存在*

*0102-2 不存在*

*0102-3 不存在*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T05:16:05.837

这是一种在给定字符串数组的情况下查找最大公共前导子字符串的简单方法：

```
>>> arr = ['0102-1', '0102-2', '0102-3']
>>> for i in reversed(range(len(arr[0]))):
...     for s in arr:
...         if not s.startswith(arr[0][:i+1]):
...            break
...     else:
...         break
... else:
...     if i == 0: i = -1
...
>>> arr[0][:i+1]
'0102-'
>>> i
4 
```

# mysql - 按提交总数选择用户

> ID：518790
> 
> 赞同：4
> 
> 时间：2009-02-06T01:39:03.950
> 
> 标签：mysql

我知道这很容易，但它让我发疯......

我有一个用户表、评论表和图片表。

我想要一个基于提交的前 10 名用户的列表（他们的评论和提交的照片的总和）。

就是这样。

让我感到羞耻。

* * *

更新：基于 Ed 的回答。

这是我的设置：

*   用户表（user_id，用户名）
*   图片表（img_id，submitby_id = users.user_id）
*   评论表（id，submitby_id = users.user_id）

最后的查询：

```
 select submittedby_id, sum(total)
from 
    (select submittedby_id, count(img_id) as total from    
          images group by submittedby_id 
     union 
     select submittedby_id, count(id) as total from 
          comments group by submittedby_id
    ) as x
 group by submittedby_id 
 order by sum(total) desc limit 10; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T01:47:43.433

也许是这样的：

```
select username, sum(submissions) 
from 
    (select username, count(picture_id) from    
          pictures group by username 
     union 
     select username, count(comment_id) from 
          comments group by username
    )
 group by username 
 order by sum(submissions) desc limit 10; 
```

从概念上概述：

1.  统计每个表中用户的提交
2.  将它们联合起来，因此每个用户将从子查询中获得 0 到 2 个计数。
3.  再分组一次，将两个计数相加，然后排序，使最高数量在顶部。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T01:46:49.923

当然是伪代码，但你想要这样的东西：

```
select 
  u.userid
, count(commentID) + count(photoID) as totalsubmissions 
from users u
left outer 
    join comments c
    on u.userid = c.userid 
left outer 
    join pictures p 
    on u.userid = p.userid 
group by 
    u.userid 
order by 2 desc 
fetch first 10 rows only 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T05:14:24.170

调整 Ed 的答案：

```
select submittedby_id, sum(submissions) 
from 
    (select submittedby_id, count(img_id) as submissions from    
          images group by submittedby_id 
     union all
     select submittedby_id, count(id) as submissions from 
          comments group by submittedby_id
    ) as x
 group by submittedby_id 
 order by sum(submissions) desc limit 10 
```

我相信你想在这里做一个联合，只是联合可以省略看起来相同的记录（相同的 id 和提交计数）。

# php - 将 CSV 文件动态显示为网页上的 HTML 表格

> ID：518795
> 
> 赞同：31
> 
> 时间：2009-02-06T01:44:20.647
> 
> 标签：php, html, csv

我想在服务器端获取一个 CSV 文件并将其动态显示为 html 表。例如，这个：

```
Name, Age, Sex
"Cantor, Georg", 163, M 
```

应该变成这样：

```
<html><body><table>
<tr> <td>Name</td> <td>Age</td> <td>Sex</td> </tr>
<tr> <td>Cantor, Georg</td> <td>163</td> <td>M</td> </td>
</table></body></html> 
```

欢迎使用任何语言的解决方案。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2009-02-06T02:56:08.567

[之前链接](http://www.codewalkers.com/c/a/File-Manipulation-Code/Simple-CSV-to-HTML-Table/)的解决方案是一段可怕的代码；几乎每一行都包含一个错误。请改用[fgetcsv](http://php.net/fgetcsv)：

```
<?php
echo "<html><body><table>\n\n";
$f = fopen("so-csv.csv", "r");
while (($line = fgetcsv($f)) !== false) {
        echo "<tr>";
        foreach ($line as $cell) {
                echo "<td>" . htmlspecialchars($cell) . "</td>";
        }
        echo "</tr>\n";
}
fclose($f);
echo "\n</table></body></html>"; 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-12-23T06:02:22.663

这是一个使用 php 将 csv 转换为 html 表的简单函数：

```
function jj_readcsv($filename, $header=false) {
$handle = fopen($filename, "r");
echo '<table>';
//display header row if true
if ($header) {
    $csvcontents = fgetcsv($handle);
    echo '<tr>';
    foreach ($csvcontents as $headercolumn) {
        echo "<th>$headercolumn</th>";
    }
    echo '</tr>';
}
// displaying contents
while ($csvcontents = fgetcsv($handle)) {
    echo '<tr>';
    foreach ($csvcontents as $column) {
        echo "<td>$column</td>";
    }
    echo '</tr>';
}
echo '</table>';
fclose($handle);
} 
```

可以像这样调用这个函数`jj_readcsv('image_links.csv',true);`

如果第二个参数为真，则 csv 的第一行将作为标题/标题。

希望这可以帮助某人。请评论此代码中的任何缺陷。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-02-12T13:13:47.690

phihag 的答案将每一行放在一个单元格中，而您要求每个值放在一个单独的单元格中。这似乎做到了：

```
<?php
// Create a table from a csv file 
echo "<html><body><table>\n\n";
$f = fopen("so-csv.csv", "r");
while (($line = fgetcsv($f)) !== false) {
        $row = $line[0];    // We need to get the actual row (it is the first element in a 1-element array)
        $cells = explode(";",$row);
        echo "<tr>";
        foreach ($cells as $cell) {
            echo "<td>" . htmlspecialchars($cell) . "</td>";
        }
        echo "</tr>\n";
}
fclose($f);
echo "\n</table></body></html>";
?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-06-12T07:09:20.040

只是改进了[phihag 的](https://stackoverflow.com/users/35070/phihag)代码，因为如果文件不存在，它会进入无限循环。

```
<?php

$filename = "so-csv.csv";

echo "<html><body><table>\n\n";

if (file_exists($filename)) {
$f = fopen($filename, "r");
while (($line = fgetcsv($f)) !== false) {
        echo "<tr>";
        foreach ($line as $cell) {
                echo "<td>" . htmlspecialchars($cell) . "</td>";
        }
        echo "</tr>\n";
}
fclose($f);
}

else{ echo "<tr><td>No file exists ! </td></tr>" ;}
echo "\n</table></body></html>";
?> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-03-16T19:18:54.943

这是使用一些引导程序更新的工作解决方案。小表、条纹、边框和悬停突出显示

```
function jj_readcsv($filename, $header = false)
{
    $handle = fopen($filename, "r");
    echo '<div class="table-responsive"><table class="table table-sm table-striped table-bordered table-hover">';
    //display header row if true
    if ($header) {
        $csvcontents = fgetcsv($handle);
        echo '<tr>';
        foreach ($csvcontents as $headercolumn) {
            echo "<th>$headercolumn</th>";
        }
        echo '</tr>';
    }
    // displaying contents
    while ($csvcontents = fgetcsv($handle)) {
        echo '<tr>';
        foreach ($csvcontents as $column) {
            echo "<td style='width:1px; white-space:nowrap;'>$column</td>";
        }
        echo '</tr>';
    }
    echo '</table></div>';
    fclose($handle);
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-06T01:50:22.380

如果您用 \ 转义引用的逗号，它会起作用吗？

> 姓名、年龄、性别
> 
> “康托尔\，乔治”，163，M

大多数分隔格式都需要对其分隔符进行转义才能正确解析。

* * *

一个粗略的 Java 示例：

```
import java.util.Iterator;

public class CsvTest {

    public static void main(String[] args) {
        String[] lines = { "Name, Age, Sex", "\"Cantor, Georg\", 163, M" };

        StringBuilder result = new StringBuilder();

        for (String head : iterator(lines[0])) {
            result.append(String.format("<tr>%s</tr>\n", head));
        }

        for (int i=1; i < lines.length; i++) {
            for (String row : iterator(lines[i])) {
                result.append(String.format("<td>%s</td>\n", row));
            }
        }

        System.out.println(String.format("<table>\n%s</table>", result.toString()));
    }

    public static Iterable<String> iterator(final String line) {
        return new Iterable<String>() {
            public Iterator<String> iterator() {
                return new Iterator<String>() {
                    private int position = 0;

                    public boolean hasNext() {
                        return position < line.length();
                    }

                    public String next() {
                        boolean inquote = false;
                        StringBuilder buffer = new StringBuilder();
                        for (; position < line.length(); position++) {
                            char c = line.charAt(position);
                            if (c == '"') {
                                inquote = !inquote;
                            }
                            if (c == ',' && !inquote) {
                                position++;
                                break;
                            } else {
                                buffer.append(c);
                            }
                        }
                        return buffer.toString().trim();
                    }

                    public void remove() {
                        throw new UnsupportedOperationException();
                    }
                };
            }
        };
    }
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-01-10T17:13:01.457

HTML ... 标签本身可以做到这一点，即没有 PHP 或 java。

或查看此帖子以获取上述内容的完整详细信息（包含所有选项..）。

[http://www.linuxquestions.org/questions/programming-9/how-to-show-csv-data-as-html-in-internet-explorer-with-filter-buttons-4175443612/](http://www.linuxquestions.org/questions/programming-9/how-to-show-csv-data-as-html-in-internet-explorer-with-filter-buttons-4175443612/)

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-02-06T05:50:53.770

定义“动态显示”？这意味着该表是通过 javascript 和某种 Ajax-y 更新构建的。如果您只想使用 PHP 构建表，那真的不是我所说的“动态”

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2013-01-21T02:34:45.207

XmlGrid.net 具有将 csv 转换为 html 表的工具。这是链接：http: [//xmlgrid.net/csvToHtml.html](http://xmlgrid.net/csvToHtml.html)

我使用了您的示例数据，并得到了以下 html 表：

```
<table>
<!--Created with XmlGrid Free Online XML Editor (http://xmlgrid.net)-->
<tr>
  <td>Name</td>
  <td> Age</td>
  <td> Sex</td>
</tr>
<tr>
  <td>Cantor, Georg</td>
  <td> 163</td>
  <td> M</td>
</tr>
</table> 
```

# wcf - 通过 Web 服务（WCF、MTOM、WCE？）上传和下载大文件 - Windows Mobile（紧凑型框架）

> ID：518796
> 
> 赞同：2
> 
> 时间：2009-02-06T01:45:03.640
> 
> 标签：wcf, compact-framework, opennetcf, wce

我已经搜索了很多，似乎找不到一个好的稳定解决方案，所以任何帮助将不胜感激。

场景如下： Windows Mobile 设备在 .NET CF 3.5 上运行客户端应用程序（正在使用 OpenNETCF 库） .NET 3.5 上的 Web 应用程序（运行 IIS 的 Web 服务器）在 VS2008、.NET 3.5 中开发 - 所有最新版本

我需要使用 Web 服务或 WCF 或 MTOM 将大文件传入和传出移动设备。（最好分块）。我找到了一些很棒的文章，但似乎无法正常工作，带有 XML 数据的普通 Web 服务会出现内存不足异常，WCE 在 VS2008 中不可用，CF 上的 WCF 没有给我添加“服务参考”，只有“网络参考”，我束手无策。

有人说，不要使用 WSE，它已经过时了，只使用 WCF 但我无法让它在移动应用程序上运行。

我所需要的只是一个从移动设备到 Web 服务器的简单上/下传输机制，我可以稍后查看压缩和可靠性。

任何人都可以通过一些文章和示例代码为我指明正确的方向吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T03:15:53.270

过去，我发现 Web 服务、WCF、MTOM 和 WSE 为大文件传输提供了糟糕的解决方案。尤其是上传。

我最终做的是创建一个客户端/服务器 TCP 连接并通过流发送文件的二进制数据。我在文件数据之前添加了一个标题和 xml 字符串，详细说明了文件数据。就我而言，我需要一定级别的安全性，所以我使用了 System.Net.Security.NegotiateStream。在您的情况下， System.Net.Sockets 命名空间的 TcpClient 和 TcpListener 可能就足够了。CF 3.5 都支持它们。

希望有帮助。

# linux - 有没有办法使用 Perl 在 Linux 或 Solaris 环境中读取其他进程的环境变量？

> ID：518803
> 
> 赞同：9
> 
> 时间：2009-02-06T01:48:39.560
> 
> 标签：linux, perl, solaris, environment-variables, root

在 Perl 中，我需要读取其他进程的环境。

*   该脚本以 root 权限运行。
*   该脚本将在 Linux 和 Solaris 中运行。
*   我想要一个与平台无关的解决方案，至少在 Linux 和 Solaris 之间。在 Linux 中，检查 /env/<proc_id>/environ 可以得到答案。
*   我想避免分叉。我已经有了分叉“/usr/ucb/ps -auxwwwe $pid”的解决方案

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-06T01:58:10.883

在 linux 中，`/proc/<pid>/environ`psuedofiles 似乎包含创建进程时传递的环境变量。如果您有足够的权限，您可以阅读这些内容。

它们似乎没有在启动后跟踪流程环境的变化。

这表明您必须剖析进程内存转储才能获得所需的内容。

棘手。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-11-21T23:51:38.767

GNU 'binutils' 软件包包括一个名为`strings`. 有关更多信息，请参见[http://www.gnu.org/software/binutils/](http://www.gnu.org/software/binutils/)。

`strings /proc/pid/environ`- 打印出一个很好的环境变量列表，就像`env`.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-07T14:02:33.057

对于 Solaris，您可以尝试[CPAN 中的 procfs 模块](http://search.cpan.org/~jnolan/Solaris-Procfs-0.26/Procfs/Procfs.pm)。尽管这个模块看起来还很年轻，但这句话听起来很有希望：

> Brian Farrell 发送了一个非常有用的补丁，它可以处理除当前运行进程之外的进程的 argv 和环境检查。

我想这可能只是初始环境（就像`environ`linux下的文件一样），但这似乎是你想要的？

否则，尽管我看到您说您不想分叉，但一个简单的解决方案可能会启动约 20 行 C 代码来生成一个小程序，该程序只是将 Solaris 上的环境作为 Linux`environ`文件的完全等价物吐出。我已经在 C 中有一些非常相似的东西。如果你有兴趣，我可以发帖。

编辑（在阅读 OpenSolaris pargs.c 之后）：当环境发生变化时，环境缓冲区在 Solaris 下重新分配，因此 psinfo 指针可能无效。对于防弹解决方案，您需要寻找 _environ。这可能比你需要的更麻烦......不过，如果你确实走岔路，这`pargs -e <pid>`可能是 UCB 的一个更好的替代方案。`ps(1)`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-06T03:25:31.923

我首先想到的是使用 GDB 附加到有问题的进程，然后要求 GDB 为您获取环境。您可以使用 GDB shell 中的“显示环境”命令来执行此操作。

看起来有一个 Perl 模块可以为您做到这一点， [Devel::GDB](http://search.cpan.org/perldoc?Devel::GDB)。我还没有尝试过，但它看起来像一个简单的编程问题来创建 Devel::GDB 对象，连接到您要检查的进程，发送“显示环境”命令，然后解析结果。

我不得不说...当解决方案如此复杂时，您可能做错了其他事情。无论如何，为什么您需要随机过程的环境？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T03:31:53.080

如果 ps 可以做到，就像你说的那样，那么你的答案可以在 ps 的源代码中的某处找到。这将避免产生新进程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-27T20:40:49.000

`/proc/[pid]/cwd`在 Linux 上，解析符号链接可能就足够了，请参阅[procfs(5)](http://linux.die.net/man/5/proc)。

# asp.net-mvc - 具有干净 URL 的多个路由参数

> ID：518812
> 
> 赞同：2
> 
> 时间：2009-02-06T01:52:51.923
> 
> 标签：asp.net-mvc, routing

我正在 ASP.NET MVC 中进行 digg 克隆，以帮助更好地自学 ASP.NET MVC。我一直在研究 StackOverflow 在传递诸如排序之类的内容时如何处理路由，我想我认为使用干净 URL 的全部意义在于，您的 URL 末尾没有 ?sort=blah 之类的东西用于 SEO。

是否有推荐的方法在您的 URL 中包含许多可能可选的参数，同时仍然保持它们干净。我有一些想法，我想得到一些反馈。

选项1：

使用通配符（糟糕）

选项 2：

将排序添加到 URL 的开头，因为它具有最大的覆盖范围，并且在查看故事时始终适用。示例（使用 StackOverflow）

而不是 ?sort=featured...

[https://stackoverflow.com/featured/tagged/asp.net-mvc](https://stackoverflow.com/featured/tagged/asp.net-mvc)
[https://stackoverflow.com/new/tagged/c#](https://stackoverflow.com/new/tagged/c#)
[https://stackoverflow.com/tagged/asp.net](https://stackoverflow.com/tagged/asp.net)（某种默认值）

无论如何——我似乎想不出任何其他的方法来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T13:18:54.643

等等，堆栈溢出*确实*使用查询字符串参数进行排序，例如：

[https://stackoverflow.com/questions/518812?sort=oldest#sort-top](https://stackoverflow.com/questions/518812?sort=oldest#sort-top)

/特色是不同的。在这种情况下，您控制的是返回哪些记录，而不仅仅是它们的排序方式。

URL 描述资源。查询字符串参数描述了资源的呈现方式。一般来说：

*   描述返回数据性质的片段应该是 URL 的一部分。
*   描述数据如何呈现的片段应该是查询字符串参数。

拥有查询字符串参数不会损害您的 SEO。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T02:56:54.087

你应该选择最适合你的方法。需要考虑的一些事项：

*   可维护性：您将如何在整个生命周期内维护链接结构。别人会怎样？
*   可读性/调试：你将如何调试链接？自然语言会帮助你吗？（它帮助到我）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T06:43:21.930

假设您有一个名为 StoryController 的控制器，它显示您的所有帖子。你可以让你的路线看起来像这样：

```
routes.MapRoute("FeatureTagged", "feature/tagged/{tag}", new { 
       controller = "Story", action = "ShowFeaturedByTag" });
routes.MapRoute("NewTagged", "new/tagged/{tag}", new { 
       controller = "Story", action = "ShowNewByTag" }); 
```

顺便说一句，已经有一个 ASP.NET MVC 的 digg 克隆。它被称为 Kigg： http: [//www.codeplex.com/Kigg](http://www.codeplex.com/Kigg)，它正在一个名为[DotNetShoutout的网站上运行](http://dotnetshoutout.com/)

# c# - EPS转JPG转换器

> ID：518816
> 
> 赞同：1
> 
> 时间：2009-02-06T01:55:58.487
> 
> 标签：c#, .net, eps

任何人都知道通过 c# 将 EPS 转换为 JPG 文件的好库吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T02:19:53.007

您可以加载一个外部库并通过它运行函数调用 - 它不需要用 C# 编码。

ImageMagick 之类的东西：[http ://www.imagemagick.org/script/index.php](http://www.imagemagick.org/script/index.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T02:00:47.057

我会看一下 Paint.Net 的源[http://getpaint.net](http://getpaint.net) 他们可能会为你准备一些东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T04:04:59.693

Pig 先生提到了 ImageMagick——这也是我的第一个想法。谷歌搜索显示[MagickNet](http://midimick.com/magicknet/)，这是一个 .Net 包装器，可能对您有用。

***编辑****：谷歌报告该链接感染了广告软件——不过，该链接似乎是有效的。*

# javascript - 在图像上拖动一个矩形

> ID：518822
> 
> 赞同：0
> 
> 时间：2009-02-06T01:58:14.347
> 
> 标签：javascript

我希望能够在图像上拖动一个矩形，并检索端点的坐标。是否有一个库可以在拖动矩形时将其可视化？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T02:00:34.717

[jCrop](http://deepliquid.com/projects/Jcrop/demos.php)做的事情与您正在寻找的类似。我认为恰当的术语是“橡皮筋”。

# language-agnostic - Grand Central vs 并行扩展

> ID：518826
> 
> 赞同：7
> 
> 时间：2009-02-06T01:59:02.223
> 
> 标签：language-agnostic, parallel-processing, grand-central-dispatch

有谁知道苹果（Snow Leopard）即将推出的“Grand Central”技术的任何好的网站，以及它与来自微软的并行扩展（和本机并行计算的东西）相比如何？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-08-31T00:52:30.930

Snow Leopard 现已退出 NDA：

[GCD 概念文档](http://developer.apple.com/mac/library/documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html)
[GCD API 参考](http://developer.apple.com/mac/library/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html "API 参考")

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T16:49:28.010

关于 Grand Central，我不能说什么，但如果您正在寻找一个技术/研究小组，其中 MS 的东西需要一些时间，那么我会查看 Cilk [http://supertech.csail.mit.edu/cilk/](http://supertech.csail.mit.edu/cilk/)还有一个由 Cilk Arts 发行的商业版本[http://www.cilk.com/](http://www.cilk.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T14:19:46.797

Grand Central 仍处于 Apple 的 NDA 之下，这就是为什么很难找到有关它的信息，因为任何人发布任何有关它的信息都会违反。

我所知道的有关该技术的唯一可靠信息来源是 ADC 本身 ( [http://developer.apple.com](http://developer.apple.com) )，但您需要付费会员才能访问它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-05T12:15:07.470

也许我错了，但我的印象是，盛大的中央调度是在操作系统级别，而并行扩展更像是一个附加库。因此，如果我正确解释这一点，在 OS X 上运行的所有应用程序都将共享一个线程池，而通过并行扩展，每个运行的应用程序都将拥有自己的线程池。

这表明 Grand Central 调度应该更擅长负载平衡。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T05:55:37.963

我没有在“Grand Central”上看到任何具体内容，但在[GPGPU.org上已经有一些关于 OpenCL 标准的讨论](http://www.gpgpu.org)

# apache-flex - 使用 Flex 在 Canvas 内处理键盘事件的问题

> ID：518833
> 
> 赞同：1
> 
> 时间：2009-02-06T02:01:16.557
> 
> 标签：apache-flex, events, actionscript, keyboard, mxml

出于某种原因，我定义的事件侦听器似乎从不接收任何事件，尽管我相信它应该。这是我正在使用的 MXML 代码的简短描述：

```
WindowedApplication
    VBox (root box)
        MenuBar
        TabNavigator
            VBox (first tab)
                Canvas
            VBox (second tab) 
```

如果我将 KEY_DOWN 事件的侦听器添加到 WindowedApplication 或根 VBox，则处理程序会很好地接收事件。但是，如果我将侦听器添加到 Canvas 或第一个选项卡 VBox，则处理程序似乎永远不会收到任何内容。（我在这里假设只需单击 Canvas 区域即可获得焦点 - 我是否正确？）

我刚刚开始使用 Flex，所以我希望我在某个地方犯了一个愚蠢的初学者错误。我将非常感谢任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T02:11:37.830

您想知道并捕捉从画布发送的 keydown 事件吗？我会说是的，你可能在画布实际上有焦点时遇到了麻烦。此链接可能会有所帮助：

[http://livedocs.adobe.com/flex/3/html/help.html?content=Capturing_User_Input_3.html](http://livedocs.adobe.com/flex/3/html/help.html?content=Capturing_User_Input_3.html)

了解您要达到的目标将有助于为您提供更好的解决方案。为什么您只想在画布上捕捉键盘事件？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T19:27:43.980

同意 Ryan，我要补充一点，在处理一般键盘事件时，我有时会发现它很有帮助，将我的侦听器连接到事件的**捕获**阶段，而不是目标或冒泡阶段（注意第三个参数，false默认情况下）：

```
stage.addEventListener(KeyboardEvent.KEY_DOWN, handleKeyDown, true); 
```

考虑一个休闲游戏的例子，其中箭头键以某种方式控制核心动作（俄罗斯方块，也许——向左旋转，向右旋转），在捕获阶段响应事件意味着可以具有明显的优势。从文档：

> 在捕获阶段，Flex 在显示列表中检查事件的祖先，以查看哪些被注册为事件的侦听器。Flex 从根祖先开始，然后在显示列表中继续向下到目标的直接祖先。在大多数情况下，根祖先是 **Stage**，然后是 SystemManager，然后是 Application 对象。

因此，在这种情况下，您可以确保舞台的侦听器会先于其他任何人收到通知，并且可以做出相应的响应——通过完全终止事件传播（有时您可能想要这样做）或将其转换为更特定于应用程序的自定义事件：

```
private function handleKeyDown(event:KeyboardEvent):void
{
    if (event.keyCode == Keyboard.LEFT)
    {
        dispatchEvent(new Event("rotateLeft"));
    }
    else if (event.keyCode == Keyboard.RIGHT)
    {
        dispatchEvent(new Event("rotateRight"));
    }
    else
    {
        event.stopPropagation();
    }
} 
```

...并防止您在您的应用程序中使用键盘侦听器。

[此处更详细地描述了](http://livedocs.adobe.com/flex/3/html/events_08.html)事件传播阶段。也检查一下 - 那里有很多值得了解的信息。

# .net - 使用 clickonce 部署时不要覆盖 app.config

> ID：518834
> 
> 赞同：3
> 
> 时间：2009-02-06T02:03:16.707
> 
> 标签：.net, deployment, configuration, clickonce, configuration-files

当通过单击更新应用程序时，如何指定我的应用程序不覆盖客户端计算机上的 app.config？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T22:29:58.947

如果我没记错的话，你需要这样的东西

[通过单击一次部署在更新中保留 app.config 变量](https://stackoverflow.com/questions/622764/persisting-app-config-variables-in-updates-via-click-once-deployment)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T17:54:58.643

**背景**
我在问题的评论中询问用户是否在部署后手动编辑其机器上的 app.config 文件。原始海报回应说他们正在这样做。

**回答**
看起来发帖人希望 ClickOnce 最初部署 app.config 文件，然后在未来更新应用程序时*不部署它。*这是对 ClickOnce 的严重误用。我不认为有一个简单的方法可以做到这一点，即使有我也会建议不要这样做。如果将来您想在 app.config 文件中添加新设置怎么办？如果 app.config 不再在他们的机器上更新，用户将如何获得新设置？

我要做的是将连接字符串存储为 UserSettings。这正是用户设置的目的，因用户而异。最重要的是，我可能会为他们提供一个简单的表单来编辑这些设置。让我的所有用户胡乱摆弄他们的安装文件会让我感到紧张。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T02:51:32.103

将您的设置移动到您部署到的每个环境的**不同配置**中，例如：

*app.development.config
app.staging.config
app.production.config*

在您的 app.config 中保留所有这些**通用的设置**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T02:44:11.057

您是否尝试在更新期间保留设置？如果是这样，请查看应用程序和用户设置（在项目的属性中）。它们不会在每次更新期间被覆盖。

# c++ - C++代码在文件中查找所有IP地址

> ID：518835
> 
> 赞同：0
> 
> 时间：2009-02-06T02:03:30.420
> 
> 标签：c++, file, file-io

我需要编写一个程序来扫描文本文件并检索文件中的所有 IP 地址（格式为 256.256.256.256）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T02:08:04.093

[您可以使用Boost::spirit](http://www.boost.org/doc/libs/1_37_0/libs/spirit/classic/index.html)编写 BNF或使用[Boost::regex](http://www.boost.org/doc/libs/1_37_0/libs/regex/doc/html/index.html)创建正则表达式来查找 IP 地址

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T02:08:30.783

也许您应该尝试使用正则表达式？您可以读入文件，可能会逐行扫描，然后在该行上使用正则表达式来提取 IP 地址。

`scanf`如果文件仅包含 IP 地址而没有其他文本，则使用,`"%hhu.%hhu.%hhu.%hhu"`作为格式字符串可能更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T02:46:41.130

这个正则表达式可以解决问题：

```
\b(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b 
```

根据您的特定需求修改此代码：

```
using namespace System::Text::RegularExpressions;
void doTheMatch( String^ inputString, String^ filter )
{
    Console::WriteLine( "original string:  {0}", inputString );
    Console::WriteLine( "attempt to match: {0}", filter );

    Regex^ regex = gcnew Regex( filter );
    Match^ match = regex->Match( inputString );

    if ( ! match->Success )
    {
        Console::WriteLine( 
            "Sorry, no match of {0} in {1}", filter, inputString );
        return;
    }

    for ( ; match->Success; match = match->NextMatch() )
    {
        Console.WriteLine( 
            "The characters {0} match beginning at position {1}",  
            match->ToString(), match->Index );
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T02:09:13.747

它真的必须是C++吗？正则表达式和`grep`你的朋友！

# string - 如何在 PostScript 中获取字符串的高度度量？

> ID：518837
> 
> 赞同：11
> 
> 时间：2009-02-06T02:04:29.747
> 
> 标签：string, fonts, metrics, postscript

您可以使用当前字体获取字符串的宽度，`stringwidth`尽管这实际上会在堆栈上推送偏移坐标，但 y 值似乎总是没用。有没有办法确定字符串的确切高度，可能包括也可能不包括下降线？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-09-13T15:10:37.293

`stringwidth`，正如它所说，不返回字符串的高度。（在我查看的所有情况下，执行后堆栈上的第二个整数`stringwidth`是`0`-- 对于在水平方向上运行的字符串。）`stringwidth`在执行 a 后给出当前点的相对坐标`(string) show`。

PLRM 有这样的说法`stringwidth`：

> 请注意，**stringwidth**返回的宽度定义为当前点的移动。它与字形轮廓的尺寸无关。

那么考虑到字符串的高度有什么用呢？在 PRLM 中阅读的神奇词汇是`charpath`和`pathbbox`。试试这个：

```
%!
/Helvetica findfont 60 scalefont setfont
200 700 4 0 360 arc fill 
200 700 moveto (test test) dup 
true charpath pathbbox 
3 -1 roll sub 2 div neg 3 1 roll sub 2 div exch 
1 0 0 setrgbcolor
200 700 moveto rmoveto show showpage 
```

它计算字符串（以红色打印）的高度，并使用该信息尝试将一个小实心圆（以黑色打印）居中到其边界框的中心：

[![示例 PostScript 可视化](https://i.stack.imgur.com/epfuo.jpg)](https://i.stack.imgur.com/epfuo.jpg)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-08-19T14:08:37.343

我已经在[如何确定 PostScript 中的字符串高度？](https://stackoverflow.com/q/3618194/36272)，但在这里也很有用。

只需添加到**pipitas**答案：

```
/textheight { 
    gsave                                  % save graphic context
    {                            
        100 100 moveto                     % move to some point 
        (HÍpg) true charpath pathbbox      % gets text path bounding box (LLx LLy URx URy)
        exch pop 3 -1 roll pop             % keeps LLy and URy
        exch sub                           % URy - LLy
    }
    stopped                                % did the last block fail?
    {
        pop pop                            % get rid of "stopped" junk
        currentfont /FontMatrix get 3 get  % gets alternative text height
    }
    if
    grestore                               % restore graphic context
} bind def

/jumpTextLine { 
    textheight 1.25 mul                    % gets textheight and adds 1/4
    0 exch neg rmoveto                     % move down only in Y axis
} bind def 
```

该方法要求已经设置了一些字体。它适用于选定的字体 ( `setfont`) 及其大小 ( `scalefont`)。

我使用 (HÍpg) 来获得最大的边界框，使用强调的大写字符和“下线”字符。结果已经足够好了。

另一种方法从**dreamlax**的答案中窃取——某些字体不支持`charpath`运算符。

保存和恢复图形上下文将当前点保持在原位，因此它不会影响文档的“流程”。

希望我有所帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T21:41:45.747

这似乎在大多数情况下都有效：

```
/fontheight { currentfont /FontMatrix get 3 get } bind def
/lineheight { fontheight 1.2 mul } bind def 
```

它不适用于所有`/FontType`s。

# mysql - MySql：作为视图执行时，UNION 没有被执行

> ID：518839
> 
> 赞同：3
> 
> 时间：2009-02-06T02:06:46.123
> 
> 标签：mysql

我正在尝试为我创建的 2 个选择语句的 UNION 创建一个视图。

单独执行时，UNION 工作正常

但问题是当我将它作为视图执行时，只有 UNION 的第一部分被执行。

我正在使用的查询如下

```
SELECT DISTINCT products.pid AS id, 
                products.pname AS name, 
                products.p_desc AS description,
                products.p_uid AS userid,
                products.p_loc AS location,
                products.isaproduct AS whatisit 
           FROM products
UNION

SELECT DISTINCT services.s_id AS id, 
                services.s_name AS name, 
                services.s_desc AS description,
                services.s_uid AS userid,
                services.s_location AS location,
                services.isaservice AS whatisit 
           FROM services
          WHERE services.s_name 
```

当我单独执行时，上述工作正常。但是当我将它用作视图时，它并没有给我服务部分的结果。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-11-13T16:59:03.590

如果您可以为上述每个单独的查询提供结果集，然后还为 UNION 查询提供结果集，我们可能会为您的问题提供更好的答案。我的直觉反应是第二个查询可能会返回一个重复值，并且由于您使用的是 UNION，因此正在删除重复项。如果您使用 UNION ALL，则将返回所有重复的行。例如，如果第一个查询返回该行：

```
1 name1 description1 10 Home Y
2 name2 description2 20 Work Y 
```

第二行返回：

```
1 name1 description1 10 Home Y 
```

结果输出将是：

```
1 name1 description1 10 Home Y
2 name2 description2 20 Work Y 
```

如果要返回所有行：

```
1 name1 description1 10 Home Y
2 name2 description2 20 Work Y
1 name1 description1 10 Home Y 
```

然后，您将使用 UNION ALL 而不是 UNION 语句。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-06T02:15:28.493

我认为您的字段用户 ID 和位置在联合的两个选择中被交换，如果数据类型不同，您会收到错误，如果不是，您会收到错误的结果...是吗？

# mysql - MySQL简单表同步？

> ID：518847
> 
> 赞同：1
> 
> 时间：2009-02-06T02:10:42.513
> 
> 标签：mysql, synchronization, sharding

我正在开发一个网站，一开始会有三个明确的子网站：论坛、新闻和日历。

每个子站点都有自己的数据库，所有这些数据库的共同点是一个用户表，该表需要在每个数据库中，以便可以完成连接。

如何同步所有用户表，以便在哪个数据库中进行更新无关紧要，所有数据库都将具有相同的用户表。

我不担心是否存在短暂的同步延迟（小于 1 分钟），我希望解决方案尽可能简单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T02:12:02.447

为什么子站点需要有自己的数据库？你不能只使用一个数据库，每个应用程序都有单独的表吗？或者，在 PostgreSQL 中，您可以使用模式来达到同样的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T02:31:23.373

虽然我几乎不会赞同这样的架构，但[联合表](http://dev.mysql.com/doc/refman/5.0/en/federated-use.html)可能会做你想做的事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T02:46:48.570

一个应用程序可以登录多个数据库。虽然我提倡 kquinn 的“all in one DB”的答案，但因为连接会起作用，如果你*真的*必须有单独的数据库，至少要从一个数据库访问用户表。跨多个数据库“克隆”一个表充满了危险，这并不好笑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T03:51:01.903

我把问题/解决方案复杂化了。

由于数据库（暂时）将存在于同一台服务器上，因此我可以使用一个非常简单的[View](http://dev.mysql.com/doc/refman/5.1/en/create-view.html)。

# c# - 通过网络在不同设备上的两个项目之间同步对象

> ID：518853
> 
> 赞同：0
> 
> 时间：2009-02-06T02:11:44.460
> 
> 标签：c#, networking, sync

我有两个项目通过无线网络进行通信。我在两者之间的沟通工作正常。

我想在两个程序上维护一些对象的两个相同副本。对象不必相等（在参考意义上），但是对象在查看时必须显示相同的数据。

是否有现有的技术可以做到这一点，还是我必须自己动手......？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T06:24:05.160

如果您可以在两个进程之间进行通信，那么您应该能够序列化任何对象中的更改，并将更改通知其他进程。我担心的一件事是如果两个对象同时更改会发生什么 - 你有两个过时的对象并且它们都不是有效的。

查看此[CodeProject](http://www.codeproject.com/KB/cs/objserial.aspx)教程以获取有关序列化的更多信息。

# visual-studio - 颠覆结构题

> ID：518864
> 
> 赞同：3
> 
> 时间：2009-02-06T02:16:53.873
> 
> 标签：visual-studio, svn, visualsvn

刚刚从视觉工作室转移到颠覆...... 我已经爱上了！有人可以简要解释一下

1.  存储库
2.  分支机构
3.  标签
4.  树干

我需要为每个项目创建一个新的存储库吗？还是新的后备箱？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-06T02:22:43.143

您不需要单独的存储库，但如果您愿意，可以。[我建议在http://svnbook.red-bean.com/](http://svnbook.red-bean.com/)上阅读这本书。获取 pdf 版本或其他任何内容。时间不长，也很好的解释了一些事情。我读了它，发现我很高兴我读了。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-06T02:23:45.620

请记住，subversion 只是一个支持版本控制的精美文件系统。将存储库视为“驱动器根”，如“C：/”。

每个项目都有一个主干、标签和分支目录。您所有的日常工作都在后备箱中进行。实验代码在一个分支中完成，然后在以后合并回主干。标签用于发布软件时。这些**不能**被编辑。当您发布软件时，您会根据当前主干中的内容创建一个具有唯一名称的标签。

我不能说每个项目是否需要一个单独的存储库，这有利有弊。这篇[博文](http://blogs.open.collab.net/svn/2007/04/single_reposito.html)详细介绍了它们：

> 1.  简化管理。一组要部署的钩子。一个要备份的存储库。等等
> 2.  分支/标签的灵活性。将代码全部放在一个存储库中，可以更轻松地创建涉及多个项目的分支或标签。
> 3.  轻松移动代码。也许您想从一个项目中提取一段代码并在另一个项目中使用它，或者将其转换为多个项目的库。在同一存储库中移动代码并保留该过程中代码的历史记录很容易。
> 
> 以下是单存储库方法的一些缺点，多存储库方法的优点。
> 
> 1.  尺寸。处理许多较小的存储库可能比处理一个大存储库更容易。例如，如果您停用一个项目，您只需将存储库存档到媒体并将其从磁盘中删除并释放存储空间。也许您出于某种原因需要转储/加载存储库，例如利用新的 Subversion 功能。如果它是一个较小的存储库，这更容易做到并且影响更小。即使您最终想要对所有存储库执行此操作，如果没有迫切需要一次执行所有存储库，一次执行一个存储库的影响也会较小。
> 2.  全局修订号。尽管这不应该是一个问题，但有些人认为它是一个问题，并且不喜欢看到存储库上的修订号提前，并且不活动的项目在其修订历史记录中有很大的差距。
> 3.  访问控制。虽然 Subversion 的 authz 机制允许您根据需要限制对存储库部分的访问，但在存储库级别执行此操作仍然更容易。如果您有一个只有少数人可以访问的项目，则使用该项目的单个存储库更容易做到这一点。
> 4.  行政灵活性。如果您有多个存储库，那么根据存储库/项目的需要实现不同的钩子脚本会更容易。如果您想要统一的钩子脚本，那么单个存储库可能会更好，但是如果每个项目都想要自己的提交电子邮件样式，那么将这些项目放在单独的存储库中会更容易

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-06T03:54:38.200

我同意，阅读[svnbook](http://svnbook.red-bean.com/)。这是一个很好的资源。

> 我需要为每个项目创建一个新的存储库吗？还是新的后备箱？

Kevin 很好地涵盖了单个/多个存储库的权衡。当我们开始使用 svn 时，我们为所有开发项目使用了一个存储库。它运作良好，并具有提到的所有优点。但是，随着存储库变得越来越大，由于转储文件的大小以及备份期间产生的问题，它变得更加难以管理。项目不能轻易地从存储库中归档也成为一个问题——这当然是可能的，但它需要从存储库中转储和拉出项目。它们不是您无法解决的问题，但需要牢记。

> 1.  存储库
> 2.  分支机构
> 3.  标签
> 4.  树干

分支、标签和主干只是存储库中包含的文件的副本。它允许您在您认为合适的任何时间（通常在发布或功能分支）隔离和检查您的文件。

关于分支、标签和主干要记住的重要一点是它们只是 svn 中的约定。这三个位置之间在功能上没有区别，它们只是一种公认​​的使用模型，如果你有充分的理由，它们可以改变或组织不同。我不建议您以不同的方式组织，但您会发现 svn 非常灵活，因为除了约定之外没有真正的强制组织结构。

根据您决定在存储库中拥有多少项目，您可能会进行不同的组织。

您可以拥有包含项目的子目录：

```
\repo
  \branches
    \...
  \tags
    \...
  \trunk
    \.. 
```

或者您可以让项目包含子目录：

```
\repo
  \Project1
    \branches
    \tags
    \trunk
  \Project2
    \branches
    \tags
    \trunk 
```

svnbook 中涵盖了权衡取舍。如果每个存储库只有一个项目，则通常使用第一种方法，如果存储库中有多个项目，则通常使用第二种方法。

好消息是你可以开始使用 svn，然后找出你喜欢的东西。您应该有某种组织方式，但使用便宜的副本，您可以随时根据情况或工作流程的变化重新排列文件夹。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T04:19:46.790

与 CVS 或 Git 等其他版本控制系统相比，SVN 需要记住的重要一点是，SVN 没有真正的概念、分支或标记。就 SVN 而言，它只是一堆文件夹和文件。因此，虽然您会看到很多人使用分支/标签/主干设置，但这不是必需的，如果您愿意，您可以偏离此设置。

一般来说，“主干”是您保持积极发展的地方。所以这是你做所有提交的地方。您是否结帐主干或使用标签/分支完全取决于您。

正如我使用的那样，分支通常用于您需要对应用程序进行较大更改但不希望它们在主干中，因为您希望能够在不部署其他更改的情况下继续针对主干进行开发。在这种情况下，您可能会有类似

```
\repo
  \trunk
  \branches
    \version_two 
```

在这种情况下，您可以分别在trunk 和version_two 中进行开发，并且假设您的实时站点是对trunk 的检出​​，您不必担心“意外”会因您的其他更改而破坏您的实时站点。当这些更改完成并准备就绪时，您只需随时将它们合并回主干即可。

标签可以与分支类似地使用，而不是检查主干并仅使用'svn up'来更新您的存储库，而不是几个标签，每个标签代表一个版本。所以你的回购可能看起来像

```
/repo
  /trunk
  /branch
    /version_one
    /version_two
  /tags
    /1.0.0
    /1.0.1
    /1.1.0 
```

在这种情况下，一般的想法是，当您准备好进行部署时，您会执行

```
svn copy 
```

将主干复制到标签（在这种情况下，下一个可能是 1.1.1、1.2.0、2.0.0 等）。但是，如何命名标签完全取决于您，并且再次取决于您的项目和要求。使用这条路线而不是执行常规的“svn up”，您将不得不进行 svn 切换。所以你必须部署

```
svn switch https://svn.yourrepo.com/repo/tags/1.1.0 
```

交换机会自动对相应的文件进行更新、添加和删除。

当涉及到多个项目的一个 repo 或每个项目的单独 repo 时，我提倡每个项目一个 repo。它提供了轻松管理对它的访问的额外好处。但最重要的是，这意味着每个项目都有单独的提交历史和单独的日志。这米

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T10:44:45.360

阅读您的标签我看到您开始使用 VisualSVN 而不是旧的 VSS 系统。（您的问题是您停止使用 Visual Studio .. 这使 VisualSVN 成为一个奇怪的选择）。

SourceSafe 和 VSS 之间的主要区别之一是您可以选择不同的工具来访问同一个存储库（并且您可以随时切换，因为它们都共享同一个工作副本）。

例如：

*   [TortoiseSVN](http://tortoisesvn.net/download)用于资源管理器集成。
*   脚本的普通[颠覆客户端](http://subversion.tigris.org/getting.html)。
*   [VisualSVN](http://www.visualsvn.com/)作为 TortoiseSVN 的 Visual Studio 前端
*   [AnkhSVN](http://ankhsvn.net/)作为 Visual Studio 中的真实 SCC (VAPI) 包。

# sharepoint - Sharepoint 文档标题和文档名称的区别

> ID：518865
> 
> 赞同：4
> 
> 时间：2009-02-06T02:17:10.360
> 
> 标签：sharepoint, workflow, document-management, sharepoint-documents

我的一位同事开发了一个自动设置文档标题的工作流程。正如他所说，通过这个工作流程，他可以优化研究和查找类似的东西。但是我认为它可以通过文件的名称来完成。这背后一定有什么故事。有人可以在这里帮助我吗？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-06T02:27:23.663

“标题”是数据库中实体上的一个字段。“名称”是唯一标识文档基础的 SPFile。所以你可以认为 Title 是非常随意的；您可以像更改任何其他属性（描述等）一样更改它，但是如果更改名称，则类似于移动文件。名称在文件夹/网站中必须是唯一的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T02:56:08.787

从[MSDN 上 SPFile 的属性](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfile_properties.aspx)：

*   名称：获取包含扩展名的文件的名称。
*   标题：获取文件的显示名称。

默认情况下，上传文档时，“名称”属性将等于文档的文件名。例如，如果我上传 MyDocument.docx，那么“Name”属性将等于 MyDocument.docx。[name 属性的工作方式与文件名通常相同，如果我在http://myserver.com/MyWeb/default.aspx](http://myserver.com/MyWeb/default.aspx)有一个站点并且该文件存储在一个名为“MyDocuments”的文档库中，那么我将能够在[http://myserver.com/MyWeb/MyDocuments/MyDocument.docx](http://myserver.com/MyWeb/MyDocuments/MyDocument.docx)访问文件。如果我将名称更改为 NewDocument.docx，那么我将在[http://myserver.com/MyWeb/MyDocuments/NewDocument.docx](http://myserver.com/MyWeb/MyDocuments/NewDocument.docx)访问该文件。

“标题”属性只是分配给文档的额外元数据。在上述情况下，有人可能倾向于避免在其文档的文件名中使用空格，但使用标题字段，他们可以自由添加它们。这将增加可读性并且仍然允许任何文件名限制。

对于您的同事，他可能希望避免文件名中的某些字符或格式 - 或者只是简单地不想在用户上重命名它 - 所以他正在修改标题（元数据）而不是文件本身.

# asp.net-mvc - 不使用 UI 帮助程序时在 ASP.NET MVC 中保持状态

> ID：518868
> 
> 赞同：0
> 
> 时间：2009-02-06T02:18:25.553
> 
> 标签：asp.net-mvc

我有一堆表单，可以更轻松地键入整个 html 标签：

但是，当我将模型传递给视图时，它不会显示值。我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T02:30:32.363

您将需要手动注入 ViewData 中的值。帮助器对此进行了封装，但如果您编写的是直接 HTML，那么 ASP.NET MVC 就无法知道如何将值连接到表单元素。

```
<input type="text" id="Name" name="Name"
       value="<%= ViewData.Model.Name %>" /> 
```

# c# - 如何使用 C# 渲染 PDF

> ID：518878
> 
> 赞同：57
> 
> 时间：2009-02-06T02:24:02.563
> 
> 标签：c#, pdf, drawing, rendering

我想使用 C# 以图形方式加载和绘制 pdf 文件。我不需要编辑它们或任何东西，只需以给定的缩放级别渲染它们。

我发现的 pdf 库似乎专注于生成。我该怎么做呢？

谢谢。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2015-01-19T15:34:18.400

谷歌已经开源了它使用 Foxit Software 编写的优秀 PDF 渲染引擎 - [PDFium 。](https://code.google.com/p/pdfium/)

有一个名为[PdfiumViewer](https://github.com/pvginkel/PdfiumViewer)的 C# nuget 包，它提供了一个围绕 PDFium 的 C# 包装器，并允许显示和打印 PDF。

我已经使用过它，并且对渲染的质量印象深刻。

* * *

PDFium 直接与流一起工作，因此不需要将任何数据写入磁盘。

这是我来自 WinForms 应用程序的示例

```
 public void LoadPdf(byte[] pdfBytes)
    {
        var stream = new MemoryStream(pdfBytes);
        LoadPdf(stream)
    }

    public void LoadPdf(Stream stream)
    {
        // Create PDF Document
        var pdfDocument = PdfDocument.Load(stream);

        // Load PDF Document into WinForms Control
        pdfRenderer.Load(pdfDocument);
    } 
```

* * *

编辑：在 WinForm 中获取*pdfRenderer*`PdfiumViewer`控件：将NuGet 包添加到项目中；在 Windows 资源管理器中打开项目包文件夹并将`PdfiumViewer.dll`文件拖到`Toolbox`窗口上；一个名为的控件`PdfRenderer`将可用于添加：

[![将 PdfRenderer 控件添加到 WinForms](https://i.stack.imgur.com/oMDhc.png)](https://i.stack.imgur.com/oMDhc.png)

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-02-17T06:48:38.600

如果 Adob​​e ActiveX 不是您正在寻找的，还有其他一些选择（因为 Acrobat 必须存在于用户计算机上并且您不能自己发布）。

要创建 PDF 预览，请先查看 StackOverflow 上有关该主题的其他一些讨论：

*   [如何预览文件？](https://stackoverflow.com/questions/175528/how-can-i-take-preview-of-documents)
*   [在 Windows 上获取 pdf 的预览 jpeg？](https://stackoverflow.com/questions/502/get-a-preview-jpeg-of-a-pdf-on-windows)
*   [.NET 在 winform 中打开 PDF，无需外部依赖](https://stackoverflow.com/questions/549504/-net-open-pdf-in-winform-without-external-dependencies/)
*   [PDF 预览和查看](https://stackoverflow.com/questions/541891/pdf-previewing-and-viewing/)

在最后两个中，我谈到了一些你可以尝试的事情：

*   您可以获得商业渲染器（[PDFViewForNet](http://www.o2sol.com/pdfview4net/overview.htm)、[PDFRasterizer.NET](http://tallcomponents.com/default.aspx?id=pdfrasterizer2)、[ABCPDF](http://www.websupergoo.com/abcpdf-1.htm)、[ActivePDF](http://www.activepdf.com/)、[XpdfRasterizer](http://www.glyphandcog.com/XpdfRasterizer.html)和其他答案中的其他...）。
    不过大多数都相当昂贵，特别是如果您只关心制作简单的预览/缩略图。

*   除了 Omar Shahine 的代码片段外，还有一篇[CodeProject 文章](http://www.codeproject.com/KB/GDI-plus/pdfthumbnail.aspx)展示了如何使用 Adob​​e ActiveX，但它可能已经过时，很容易被新版本破坏并且其合法性模糊不清（基本上它可以供内部使用，但你可以'不发货，您不能在服务器上使用它来生成 PDF 图像）。

*   您可以查看[SumatraPDF](http://blog.kowalczyk.info/software/sumatrapdf/free-pdf-reader.html)的源代码，这是一个适用于 Windows 的 OpenSource PDF 查看器。

*   还有[Poppler](http://poppler.freedesktop.org/)，一个使用[Xpdf](http://www.foolabs.com/xpdf/)作为渲染引擎的渲染引擎。所有这些都很棒，但它们需要相当多的承诺才能使它们工作并与 .Net 交互，并且它们往往是在 GPL 下分发的。

*   您可能需要考虑使用[GhostScript](http://pages.cs.wisc.edu/~ghost/)作为解释器，因为渲染页面是一个相当简单的过程。
    缺点是您需要重新打包它以将其与您的应用程序一起安装，或者使其成为先决条件（或至少是安装过程的一部分）。
    这不是一个很大的挑战，而且肯定比不得不将其他渲染引擎与 .Net 合作更容易。
    我做了一个小项目，你可以在[Developer Express 论坛上](http://community.devexpress.com/forums/p/55582/188207.aspx#188207)找到它作为附件。
    请注意 GhostScript 的许可证要求。
    如果你不能离开，那么商业软件可能是你唯一的选择。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-17T06:30:03.013

这是我对另一个问题的回答。

首先你需要参考 Adob​​e Reader ActiveX 控件

**Adobe Acrobat 浏览器控件类型库 1.0**

*%programfiles&\Common Files\Adobe\Acrobat\ActiveX\AcroPDF.dll*

然后，您只需将它从工具箱中拖到您的 Windows 窗体中。

并使用一些这样的代码来初始化 ActiveX 控件。

```
private void InitializeAdobe(string filePath)
{
    try
    {
        this.axAcroPDF1.LoadFile(filePath);
        this.axAcroPDF1.src = filePath;
        this.axAcroPDF1.setShowToolbar(false);
        this.axAcroPDF1.setView("FitH");
        this.axAcroPDF1.setLayoutMode("SinglePage");
        this.axAcroPDF1.Show();
    }
    catch (Exception ex)
    {
        throw;
    }
} 
```

确保当您的表单关闭时您处置 ActiveX 控件

```
this.axAcroPDF1.Dispose();
this.axAcroPDF1 = null; 
```

否则 Acrobat 可能会被遗弃。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-04-10T14:26:39.757

`System.Drawing`PdfiumViewer 很棒，但与 WinForms 的耦合相对紧密。出于这个原因，我创建了自己的 PDFium 包装器：[PDFiumSharp](https://github.com/ArgusMagnus/PDFiumSharp)

页面可以呈现为[PDFiumBitmap](https://github.com/ArgusMagnus/PDFiumSharp/wiki/T_PDFiumSharp_PDFiumBitmap)，而 PDFiumBitmap 又可以保存到磁盘或[作为流](https://github.com/ArgusMagnus/PDFiumSharp/wiki/M_PDFiumSharp_PDFiumBitmap_AsBmpStream)公开。这样，任何能够从流中加载 BMP 格式图像的框架都可以使用这个库来显示 pdf 页面。

例如，在 WPF 应用程序中，您可以使用以下方法呈现 pdf 页面：

```
using System.Linq;
using System.Windows;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using PDFiumSharp;

static class PdfRenderer
{
    public static ImageSource RenderPage(string filename, int pageIndex, string password = null, bool withTransparency = true)
    {
        using (var doc = new PdfDocument(filename, password))
        {
            var page = doc.Pages[pageIndex];
            using (var bitmap = new PDFiumBitmap((int)page.Width, (int)page.Height, withTransparency))
            {
                page.Render(bitmap);
                return new BmpBitmapDecoder(bitmap.AsBmpStream(), BitmapCreateOptions.None, BitmapCacheOption.OnLoad).Frames.First();
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T08:41:40.470

ABCpdf 将为您做这些和许多其他事情。

它不仅可以将您的 PDF 呈现为各种格式（例如 JPEG、GIF、PNG、TIFF、JPEG 2000；矢量 EPS、SVG、Flash 和 PostScript），而且还可以在各种颜色空间（例如灰色、 RGB、CMYK）和位深度（例如，每个分量 1、8、16 位）。

这只是它会做的一些事情！

有关更多详细信息，请参阅：

[http://www.websupergoo.com/abcpdf-8.htm](http://www.websupergoo.com/abcpdf-8.htm)

哦，您可以通过免费许可证计划获得免费许可证。

使用 Acrobat 进行 PDF 呈现存在 EULA 问题。如果你想沿着这条路线走，首先要非常仔细地检查合法性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T03:01:01.757

使用 Web 浏览器控件。这需要安装 Adob​​e 阅读器，但很可能您仍然拥有它。将控件的 UrL 设置为文件位置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-30T10:18:19.810

您可以将 NuGet 包 CefSharp.WinForms 添加到您的应用程序，然后将 ChromiumWebBrowser 控件添加到您的表单。在代码中，您可以编写：

```
chromiumWebBrowser1.Load(filePath); 
```

这是我找到的最简单的解决方案，它是完全免费的，并且独立于用户的计算机设置，就像使用默认 WebBrowser 控件时一样。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-19T16:00:00.177

我想在这里提一下 Docotic.Pdf 库。它可以[将 PDF 转换为 C# 和 VB.NET 中的图像](https://bitmiracle.com/pdf-library/convert-pdf-to-image.aspx)。它还可以[渲染和打印PDF文档](https://bitmiracle.com/pdf-library/draw-print-pdf.aspx)。

该库是 100% 管理的，没有外部依赖项。它不依赖于 System.Drawing.dll 或 GDI+。您将在 Windows、Linux、macOS、iOS 和 Android 上获得一致的输出。

我是 Docotic.Pdf 开发人员之一，所以我非常喜欢它。请尝试一下，您可能也会喜欢它。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-02-06T02:32:11.643

ceTe 软件的动态 PDF 查看器可能会满足您的需求。我已经使用了他们的生成器软件并且对它非常满意。

[http://www.dynamicpdf.com/](http://www.dynamicpdf.com/)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-02-06T04:22:24.650

我用过的最简单的库是[Paolo Gios 的](http://www.paologios.com/)库。基本上是

```
Create GiosPDFDocument object
Create TextArea object
Add text, images, etc to TextArea object
Add TextArea object to PDFDocument object
Write to stream 
```

[这](http://www.codeproject.com/KB/graphics/giospdfnetlibrary.aspx)是一个很棒的教程，可以帮助您入门。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2013-02-05T00:43:48.467

这看起来是正确的：[http ://code.google.com/p/lib-pdf/](http://code.google.com/p/lib-pdf/)

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2009-02-06T04:09:19.853

您可以在 Google 上搜索[PDF 查看器组件](http://www.google.com/search?rlz=1C1GGLS_en-USUS295US303&sourceid=chrome&ie=UTF-8&q=pdf+viewer+component)，并找到一些点击率。

但是，如果您真的不需要将它们嵌入到您的应用程序中 - 您可以只需要 Acrobat Reader 或 FoxIt（或捆绑它，如果它符合各自的许可条款）并[掏出](http://partners.adobe.com/public/developer/en/acrobat/PDFOpenParameters.pdf)它。它不是很酷，但它可以免费完成工作。

# c# - 在 JavaScript 中使异步事件同步

> ID：518880
> 
> 赞同：3
> 
> 时间：2009-02-06T02:24:45.633
> 
> 标签：c#, javascript, wpf

我正在使用 WPF 3.5SP1 WebBrowser 控件来显示包含一些 javascript 函数的页面。然后我的程序需要调用一个 javascript 函数，该函数将进行异步调用。我需要一种方法来将该异步调用的结果返回给 C#，以便处理结果。

有没有办法让第一个 javascript 函数休眠，直到发生某些事情（不锁定浏览器）？

**编辑：**我已经在使用回调-第二个函数实际上称为“some-async-function-complete”。它在异步事件完成时被调用。现在我需要一种将结果转换为 C# 的方法。

进一步说明：C#

```
var result = WebBrowser.InvokeScript("myscript") 
```

JavaScript

```
var result;

function myscript()
{
some-async-function();
/* what goes here? */
/* wait until result != null */
return result;
}

function some-async-function-complete(retval)
{
result = retval;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T02:33:42.480

> 有没有办法让第一个 javascript 函数休眠，直到发生某些事情（不锁定浏览器）？

是的 - 您可以按照预期使用异步函数：向它传递一个回调，然后让它做它的事情。您应该能够将 C# 中的回调传递到您的 JS 函数中，然后该函数可以直接将其传递给您的异步函数，或者如果需要后处理，则将其包装在另一个函数中。

* * *

回调实现的示例 - 这适用于 WinForms WebBrowser 控件，我尚未使用 WPF 对其进行测试，但它们应该几乎相同：

```
[System.Runtime.InteropServices.ComVisibleAttribute(true)]
public class Callback
{
   // allows an instance of Callback to look like a function to the script
   // (allows callback() rather than forcing the script to do callback.callMe)
   [System.Runtime.InteropServices.DispId(0)]
   public void callMe(string url)
   {
      // whatever you want to happen once the async process is complete
   }
} 
```

...

```
Callback cb = new Callback();
WebBrowser.InvokeScript("myscript", new object[] { cb }) 
```

...

```
function myscript(callback)
{
   some_async_function(function()
   {
      // script-specific completion code
      if ( callback )
         callback();
   });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T03:57:42.263

请参阅相关问题：[您可以等待 javascript 回调吗？](https://stackoverflow.com/questions/436608/can-you-wait-for-javascript-callback)

引用[我](https://stackoverflow.com/questions/436608/can-you-wait-for-javascript-callback/436755#436755)对该问题的回答中的一句话：

> [JavaScript Strands](http://www.xucia.com/strands-doc/index.html)为 JavaScript 语言添加了协程和协作线程支持，以启用异步事件回调的阻塞功能。

和更多：

> [Narrative JavaScript](http://neilmix.com/narrativejs/doc/index.html)是 JavaScript 语言的一个小扩展，它支持异步事件回调的阻塞功能。这使得异步代码具有令人耳目一新的可读性和可理解性。

尽管在技术上使通常异步代码表现为同步是可行的，但我建议您重新考虑您的设计以采用异步方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T02:36:43.973

如果我正确阅读了这个问题，那么您正在寻找一个回调......例如......

```
function myscript()
{
    some-async-function(
        params, //any params you plan to use
        function(result) {
           //handle the result here
        });
}

function some-async-function(retval,callback)
{
    //assuming this really is an async function such
    //as an ajax call, etc...
    ...

    //work done, use the call back
    callback(retval);

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T02:51:28.920

您可能将您的应用程序视为桌面应用程序。您的 C# 程序没有连接到任何要同步的东西。是时候进入网络模式了。

您最接近的方法是让 javascript 回调调用 ajax 与主机进行另一次交换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T03:15:02.117

> 有没有办法让第一个 javascript 函数休眠，直到发生某些事情（不锁定浏览器）？

以您期望它起作用的方式，不。

AFAIK，需要线程控制或连续循环——第一个在 JavaScript 中不可用，后者将锁定大多数浏览器。

我认为您需要`result`使用 Ajax（来自 ）将 JavaScript 发送到服务器`some-async-function-complete`。然后，将您的 C# 分解为一个部分调用`myscript`和另一个响应和处理`result`。

# php - 用户是否使用 PHP 登录变量

> ID：518883
> 
> 赞同：0
> 
> 时间：2009-02-06T02:26:45.287
> 
> 标签：php, oop, authentication

我已经构建了一个名为 Login 的类，其构造可以将它们登录或不登录......我还有一个名为 isAuthenticated 的静态函数，用于检查用户是否登录......我'一直在搞乱静态函数等，但似乎无法得到我想要的。

理想情况下，这将是我可以轻松去的地方

```
<?php if (Login::isAuthenticated()) { ?>
<a href="/sign-out/">Sign Out</a>
<?php } ?> 
```

到目前为止，这是我的课......完成我的尝试......

```
class Login
 {
    private static $_auth;

    public function __construct($username, $rawPassword) {

        global $db;

        require('edit/users/config.php');

        $hashedPassword = sha1(SALT . $_POST['password']);

        $query = 'SELECT firstname FROM users WHERE user = "' . $db->cleanString($username) . '" AND pass = "' . $db->cleanString($hashedPassword) . '" LIMIT 1';

        $login = $db->query($query);

        if ($login) {

            $_SESSION['username'] = $username;
            self::$_auth = true;

            header('Location: ' . CONFIG_DIR_BASE);

        } else {

            ErrorHandler::addErrorToStack('Your username and/or password did not match one on our system. ');

        }

    }

    public static function isAuthenticated() {

         return self::$_auth;

    }

 } 
```

非常感谢你！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-06T02:52:09.527

由于 HTTP 是无状态的，因此您的类的静态变量 ($_auth) 不会在页面加载之间“存活”，因此如果您试图使变量保持不变，则需要将其存储为[Session 变量](http://no2.php.net/session)。

但是，我强烈建议您**不要**编写自己的 auth 类，除非您*真的很*认真。有许多优秀的 PHP 身份验证脚本可供选择，它们已经解决了[Web 身份验证的所有复杂问题](https://stackoverflow.com/questions/549/the-definitive-guide-to-website-authentication-beta)。

# apache-flex - 在 ActionScript 中从 FMS 获取流的状态

> ID：518890
> 
> 赞同：0
> 
> 时间：2009-02-06T02:31:45.463
> 
> 标签：apache-flex, flash, actionscript, flash-media-server

我正在寻找一种方法来获取从 Flash Media Server 到动作脚本的流状态。我需要知道流是否有来自 flex/ActionScript 的发布者/侦听器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T15:20:54.353

查看 Adob​​e Flash 媒体服务器管理 API。有些调用可能会对您有所帮助，例如 getNetStreams() 和 get NetStreamStats()。您可以尝试编写一个服务器端操作脚本类，该类对管理 API 进行这些调用，然后通过 NetConnection 上的回调将结果推送回您的 Flex 应用程序。

# c - Linux & C：如何在多进程程序中设置文件读取优先级？

> ID：518898
> 
> 赞同：6
> 
> 时间：2009-02-06T02:37:16.263
> 
> 标签：c, linux

这是我正在处理的一项任务，不，我不是在找你给我答案。我只需要有人指出我正确的方向，也许用一两行示例代码。

我需要弄清楚如何在我的程序中设置文件读取操作的优先级。重点：

*   服务器进程收到一条消息并生成一个子进程来处理它
*   child 尝试从消息中打开文件名并开始将文件内容加载到消息队列中
*   可能有几个孩子同时运行，并且初始消息包含优先级，因此某些消息可能会获得更多设备访问权限

我能想到的唯一方法（现在，无论如何）是每次创建消息时增加一个计数器，并在计数器达到该进程分配的优先级的给定值后执行类似 sched_yield 的操作。这很可能是一种可怕的，可怕的方法，但这是我目前所能想到的。分配更多的是关于消息队列，但我们仍然必须具有数据传输优先级。

任何帮助/指导表示赞赏:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T03:47:07.840

让子进程池共享一个信号量。一旦孩子获得信号量，它就可以从资源中读取预定义数量的字节并将其返回给客户端。读取的字节数可以与请求的优先级相关。一旦进程读取了预定义的字节数，就释放信号量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T02:58:56.003

直到最近，Linux 中还没有 IO 优先级。现在有`ionice`。但我怀疑你是否打算在你的作业中使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T02:55:44.480

您确定您的任务是在讨论文件而不是系统 V 消息队列吗？

阅读手册页：

```
 msgctl(2),    msgget(2),    msgrcv(2),    msgsnd(2),   capabilities(7),
   mq_overview(7), svipc(7) 
```

尽管我认为您可以使用文件作为密钥来创建消息队列，以便多个进程通过消息队列进行会合，但 Sys V 消息队列本身并不是文件。

只是想知道，因为您特别提到了“消息队列”，并谈到了“优先级”，这可能会映射到例如的 msgtyp 字段。msgsnd 和 msgrcv，尽管很难用什么信息来判断你给出的任务到底是什么。

# winapi - 在 Windows API 中设置菜单的宽度

> ID：518910
> 
> 赞同：0
> 
> 时间：2009-02-06T02:48:20.050
> 
> 标签：winapi, menu, wxwidgets

我正在 wxWidgets 中创建一个自定义控件，该控件将菜单显示为其中的一部分，并且目前正在 Windows 方面工作。wxWidgets 没有设置菜单宽度的方法。它只是使窗口与最长的字符串一样宽，再加上两边的几个像素。

在 API 中，有一种方法可以获取实际的 Windows API 菜单句柄。除了根据字符串的宽度自行计算之外，Windows API 是否有设置菜单宽度的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T03:01:46.043

使用菜单句柄，可以循环遍历菜单项并调用SetMenuItemInfo，表示要对菜单项进行所有者绘制。执行此操作时，附加菜单的窗口将收到`WM_MEASUREITEM`消息，然后您将通过设置菜单所需的尺寸来响应该消息。在这里你可以设置你的宽度。

当然，这意味着您必须为包含菜单的窗口子类化 Windows 消息处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-11T07:17:25.640

首先，尝试获取菜单的HWND：（1）WM_DRAWITEM（2）获取HDC（3）WindowFromDC()，然后可以任意调整菜单的各个方面。注意：不要将 WM_QUIT WM_CLOSE 发送到菜单，否则您将在毫无头绪的情况下有效地关闭计算机。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-06T13:36:21.550

它与 WM_MEASUREITEM 无关

只需使用内部 win32 菜单消息

（Win32 常见问题解答：news://comp.os.ms-windows.programmer.win32）

# apache-flex - Flex 截断按钮标签

> ID：518917
> 
> 赞同：3
> 
> 时间：2009-02-06T02:51:45.283
> 
> 标签：apache-flex

首先，对于这个问题的任何含糊之处，我深表歉意。在这一点上，我只是想尝试一些新的想法来尝试诊断这个错误。

无论如何，我遇到的问题是使用自定义模块加载器的应用程序。该模块加载器已被编译为 swc，并且模块加载器正在通过其命名空间进行实例化。这一切都很好。我遇到的问题特定于模块中使用的 mx:button 控件。无论出于何种原因，他们的标签都被截断了，例如，Sign In 显示为省略号，作为 Sign ...

经过相当多的鬼混之后，我已经能够确定以下内容：

1.  这个问题似乎只发生在模块内。如果在主 mxml 中使用按钮控件，则标签不会被截断。
2.  其标签被截断的按钮控件没有指定宽度（将其宽度设置为 100% 或特定像素宽度不能解决问题）
3.  按钮控件使用默认填充（通过将左右设置为 5 或任何其他值来弄乱填充也无济于事）。
4.  我们没有使用任何嵌入式字体，所以我也排除了这种可能性。
5.  mx:CheckBox 和 mx:LinkBut​​ton 同样受到此问题的影响，尽管 mx:CheckBox 似乎也不想显示其复选框，它只显示截断的标签。

一个潜在的副作用是将数据提供程序附加到 mx:ComboBox 会导致组合框控件引发绘图错误，但我不完全确定它与上述问题有关。

我在网上寻找答案时确实发现了一件有趣的事情，其中​​提到了 fontContext 及其与 IFlexModuleFactory 的关系。在我们的模块加载器实现中没有关于 fontContext 的规范，所以我不完全确定这是否是问题所在。无论如何，如果有人有任何想法，将不胜感激。另一方面，如果你确切地知道是什么让我感到不适并且可以为我提供答案，我可能会兴奋地弄湿自己。晚了。我累了。我需要我的 Flex 应用程序才能玩得很好。

提前致谢，

——安妮

**编辑：** 为了澄清我在寻找这个问题，我真的只需要知道以下内容：

1.  这个问题可能是由命名空间冲突引起的吗？
2.  如果没有实现 CSS，还有什么可能覆盖标签的默认行为？
3.  有没有人在使用模块加载器的自定义实现时遇到继承丢失的问题？
4.  有没有人在使用或不使用模块加载器的情况下遇到这个问题或类似问题？

我没有与这个问题共享任何代码，只是因为我必须共享整个应用程序，不幸的是，我不能这样做。同样，我不是在寻找最终的解决方案，只是一些事情的建议，如果有人有任何想法的话。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T18:49:57.767

一年来，我自己一直在处理这个问题，断断续续地以各种形式处理这个问题，虽然我还没有弄清楚是什么原因造成的，但显然在某个地方发生了错误测量。

但是，我能够解决它，基本上是通过子类化按钮类型控件（在我的例子中是 Button、LinkBut​​ton、PopUpButton 等）并分配它们的 textField 成员实例的 UITextField 扩展，其 truncateToFit element 在所有情况下都简单地返回 false：

```
public class NonTruncatingUITextField extends UITextField
{
    public function NonTruncatingUITextField ()
    {
        super();
    }

    override public function truncateToFit(s:String = null):Boolean
    {
        return false;
    }
} 
```

自定义组件只是扩展了 Button （或任何其他按钮类型的控件是罪魁祸首——我自己创建了六个左右，每种类型的控件一个），但`NonTruncatingTextField`在指定的地方使用 a 作为其标签由组件用户：

```
public class NonTruncatingButton extends Button
{
    private var _truncateLabel:Boolean;

    public function NonTruncatingButton()
    {
        super();

        this._truncateLabel = true;
    }

    override protected function createChildren():void
    {
        if (!textField)
        {
            if (!_truncateLabel)
                textField = new NonTruncatingUITextField();
            else
                textField = new UITextField();

            textField.styleName = this;

            addChild(DisplayObject(textField));
        }

        super.createChildren();
    }

    [Inspectable]
    public function get truncateLabel():Boolean
    {
        return this._truncateLabel;
    }

    public function set truncateLabel(value:Boolean):void
    {
        this._truncateLabel = value;    
    }   
} 
```

...所以最后，在您的 MXML 代码中，您将引用自定义组件（在这种情况下，我告诉控件永远不要截断其标签）：

```
<components:NonTruncatingButton id="btn" label="Click This" truncateLabel="false" /> 
```

我同意这感觉像是一种变通方法，组件架构应该更优雅地处理所有这些，而且这可能是我们都忽略的东西，但它确实有效；希望它会在您寻找更明确的解决方案时解决您的问题。（虽然就个人而言，我按原样使用它，并且我已经转移到其他事情上——时间最好花在其他地方！）

祝你好运——让我知道结果如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-24T15:05:56.497

我使用了自定义按钮和链接按钮类解决方案，但仍然遇到问题 - 但找到了一个每次都对我有用的解决方法。

创建一个包含您要用于标签的字体的 css 样式。请务必在文本选择下拉菜单下选中“嵌入此字体”。返回并将样式应用于您的按钮（或您的自定义按钮，具体取决于您将听到的声音撞在这面特定的墙上多久），瞧！

或者应该是瞧...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T22:13:34.290

通过将 labelPlacement 设置为“底部”，我已经成功地防止了 Flex 错误的按钮标签截断，如下所示：

```
theButton.labelPlacement = ButtonLabelPlacement.BOTTOM; 
```

设置标签位置似乎无助于防止某些较宽按钮尺寸的截断，但在许多情况下它对我有用。

在您不能使用底部对齐按钮标签的情况下（例如当您的按钮具有水平对齐的图标时），janusz 的方法似乎也有效。这是 janusz 在 ActionScript 而不是 MXML 中的 .text 重新分配技术的一个版本：

```
theButton.addEventListener(FlexEvent.UPDATE_COMPLETE, function (e:FlexEvent):void {
  e.target.mx_internal::getTextField().text = e.target.label;
}); 
```

上述代码需要先导入 mx_internal 和 FlexEvent，如下： import mx.events.FlexEvent; 导入 mx.core.mx_internal；

以下是结果……</p>

之前（尽管有足够的水平空间，但请注意截断）：

[![在此处输入图像描述](https://i.stack.imgur.com/aK4oB.png)](https://i.stack.imgur.com/aK4oB.png)

后：

[![在此处输入图像描述](https://i.stack.imgur.com/ths0h.png)](https://i.stack.imgur.com/ths0h.png)

这种方法的唯一缺点是您丢失了省略号，但就我而言，我认为这是一个受欢迎的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-03T10:57:09.323

我刚刚遇到这个问题并以这种方式解决它：

```
<mx:LinkButton label="Some label"
    updateComplete="event.target.mx_internal::getTextField().text = event.target.label"
/>; 
```

# debugging - 有没有什么有效的方法来提取http请求的多部分范围响应？

> ID：518919
> 
> 赞同：1
> 
> 时间：2009-02-06T02:52:38.637
> 
> 标签：debugging, http, http-headers

我正在用 WinHttp.lib 做一些 http 请求，

while 获取带有 Range 标头的数据，如

"GET someURL\r\n 范围：字节=4096-8191,0-4095",

在这样的响应头之后收到响应数据（根据 RFC2616）：

=================================

--46228a661764c4210

内容类型：文本/纯文本

内容范围：字节 4096-8191/14065

...Rang#1的内容数据

--46228a661764c4210

内容类型：文本/纯文本

内容范围：字节 0-4095/14065

...Rang#2的内容数据

# --46228a661764c4210--

然后，是否有任何有效的方法来提取我完全期望的每个范围的内容数据，而数据作为流接收。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T02:57:08.317

你试过[提琴手](http://www.fiddlertool.com/)吗？

# c# - 如何检索嵌入的 xml 资源？

> ID：518935
> 
> 赞同：5
> 
> 时间：2009-02-06T03:02:31.987
> 
> 标签：c#, asp.net, resources, assemblies

我通过访问 Visual Studio 中的项目属性，然后使用资源 | 在我的类库中添加了一个 XML 文件作为嵌入资源。添加资源 | 添加现有文件...

我尝试使用以下代码访问该文件，但我不断返回一个空引用。有人有想法么？

```
var path = Server.MapPath("~/bin/MyAssembly.dll");
var assembly = Assembly.LoadFile(path);
var stream = assembly.GetManifestResourceStream("MyNamespace.filename.xml"); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T03:25:24.250

我发现在 Visual Studio 中使用项目属性对话框的“资源”选项卡要容易得多。然后，您通过以下方式生成对资源的强类型引用：

```
Properties.Resources.Filename 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T03:09:15.157

[GetManifestResourceStream](http://msdn.microsoft.com/en-us/library/xc4235zt.aspx)的MSDN 页面做了以下说明：

> 如果访问另一个程序集中的私有资源并且调用者没有带有 ReflectionPermissionFlag.MemberAccess 标志的 ReflectionPermission，则此方法返回一个空引用（在 Visual Basic 中为 Nothing）。

您是否在程序集中将该资源标记为“公共”？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T17:22:29.903

我发现这篇文章很好地解释了如何设置它：http: [//www.devx.com/dotnet/Article/10831/1954](http://www.devx.com/dotnet/Article/10831/1954)

在这种情况下可能有帮助的一件事是使用不同的方法来确定嵌入资源的位置。

*   GetEntryAssembly：使用此方法来引用为启动当前进程而运行的可执行文件。条目程序集是为 Windows 窗体应用程序设置的，但对于大多数其他应用程序（例如，Web 项目），GetEntryAssembly 返回“nothing”（或 null，在 C# 中）。
*   GetExecutingAssembly：使用此方法引用执行代码所在的同一程序集。
*   GetCallingAssembly：使用此方法引用包含调用当前方法的代码的程序集。如果您编写通用代码来读取共享程序集中的嵌入式资源，而嵌入式资源位于调用程序集中，则此方法很有用。

我个人更喜欢这种方法而不是使用“资源”选项卡，因为它允许我使用其他工具将资源添加到项目中以包含在编译中。我不必通过这个工具使用 GUI

# java - 在java中存储和访问120,000个单词的最佳方式

> ID：518936
> 
> 赞同：6
> 
> 时间：2009-02-06T03:03:07.367
> 
> 标签：java, storage

我正在编写一个严格读取文本文件（.txt）的java应用程序。这些文件可以包含超过 120,000 个单词。

该应用程序需要存储所有 +120,000 个单词。它需要将它们命名为 word_1、word_2 等。它还需要访问这些词以对它们执行各种方法。

这些方法都与字符串有关。例如，将调用一个方法来说明 word_80 中有多少个字母。将调用另一种方法来说出 word_2200 中的特定字母。

此外，有些方法会比较两个单词。例如，将调用一个方法来比较 word_80 和 word_2200 并需要返回哪个有更多的字母。将调用另一种方法来比较 word_80 和 word_2200，并且需要返回两个词共享的特定字母。

我的问题是：由于我几乎只使用字符串，最好将这些单词存储在一个大的 ArrayList 中吗？几个小的 ArrayList？或者我应该使用许多其他存储可能性之一，如向量、哈希集、链接列表？

我的两个主要问题是 1.) 访问速度，以及 2.) 拥有尽可能多的预建方法供我使用。

提前谢谢你的帮助！！

* * *

哇！感谢大家对我的问题提供如此快速的答复。你所有的建议都对我帮助很大。我正在考虑并考虑您反馈中提供的所有选项。

请原谅我的任何模糊；让我解决你的问题：

1.  问）英语？
    A）文本文件实际上是用英文写的书。在第二语言中出现的单词是罕见的——但并非不可能。我将文本文件中非英语单词的百分比设置为 .0001%

2.  问）家庭作业？
    A）我现在微笑着看着我的问题的措辞。是的，它确实类似于学校作业。但不，这不是家庭作业。

3.  问）重复？
    一）是的。可能每五个左右的词，考虑连词，文章等。

4.  问）访问？
    A）随机和顺序。一种方法当然有可能随机定位一个单词。一种方法同样可能希望在 word_1 和 word_120000 之间按顺序查找匹配的单词。这就引出了最后一个问题……</p>

5.  Q) 遍历整个列表？
    一）是的。

另外，我计划发展这个程序来对单词执行许多其他方法。我再次为我的模糊性道歉。（细节确实使世界变得不同，不是吗？）

干杯!

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-06T03:07:00.917

我会将它们存储在一个大的 ArrayList 中，然后担心（可能不必要的）优化。

天生懒惰，我认为优化不是一个好主意，除非有明显的需要。否则，您只是在浪费本可以更好地花在其他地方的精力。

事实上，如果您可以为您的字数设置一个上限，并且您不需要任何花哨的 List 操作，我会选择一个普通的（本机）字符串对象数组，其中包含一个包含*实际*数字的整数。这可能比基于类的方法更快。

这为您提供了访问各个元素的最快速度，同时仍然保留了执行所有精彩字符串操作的能力。

注意我没有针对 ArrayLists 对原生数组进行基准测试。它们可能和原生数组一样快，所以如果你对我的能力没有我那么盲目相信的话，你应该自己检查一下:-)。

如果它们*确实*同样快（甚至接近），那么额外的好处（例如可扩展性）可能足以证明它们的使用是合理的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T04:14:59.530

只是用一个非常幼稚的基准来确认 pax 假设

```
public static void main(String[] args)
{
    int size = 120000;
    String[] arr = new String[size];
    ArrayList al = new ArrayList(size);
    for (int i = 0; i < size; i++)
    {
        String put = Integer.toHexString(i).toString();
        // System.out.print(put + " ");
        al.add(put);
        arr[i] = put;
    }

    Random rand = new Random();
    Date start = new Date();
    for (int i = 0; i < 10000000; i++)
    {
        int get = rand.nextInt(size);
        String fetch = arr[get];

    }
    Date end = new Date();
    long diff = end.getTime() - start.getTime();
    System.out.println("array access took " + diff + " ms");

    start = new Date();
    for (int i = 0; i < 10000000; i++)
    {
        int get = rand.nextInt(size);
        String fetch = (String) al.get(get);

    }
    end = new Date();
    diff = end.getTime() - start.getTime();
    System.out.println("array list access took " + diff + " ms");
} 
```

和输出：
数组访问花了 578 毫秒
数组列表访问花了 907 毫秒

运行它几次，实际时间似乎有所不同，但通常数组访问快 200 到 400 毫秒，超过 10,000,000 次迭代。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T03:15:45.390

如果您将按顺序访问这些字符串，则 LinkedList 将是最佳选择。

对于随机访问，ArrayLists 具有很好的内存使用/访问速度折衷。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T06:59:38.840

我的看法：

对于非线程程序，Arraylist 总是最快和最简单的。

对于线程程序，java.util.concurrent.ConcurrentHashMap<Integer,String> 或 java.util.concurrent.ConcurrentSkipListMap<Integer,String> 非常棒。也许您稍后希望允许线程以便同时对这个巨大的事物进行多个查询。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-14T21:46:23.303

如果您想要快速遍历和紧凑的大小，请使用 DAWG（有向无环字图）。这种数据结构采用了 trie 的概念，并通过查找和分解常见的后缀和常见的前缀对其进行了改进。

[http://en.wikipedia.org/wiki/Directed_acyclic_word_graph](http://en.wikipedia.org/wiki/Directed_acyclic_word_graph)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T03:05:44.243

使用[哈希表](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Hashtable.html)？这将为您提供最佳的查找速度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T04:39:01.947

ArrayList/Vector 如果顺序很重要（它看起来很重要，因为你正在调用单词“word_xxx”），或者 HashTable/HashMap 如果它不重要。

我将把弄清楚为什么要使用 ArrayList 与 Vector 或 HashTable 与 HashMap 的练习留给您，因为我偷偷怀疑这是您的作业。检查 Javadocs。

您不会从 Collections Framework 类中获得任何可以帮助您的方法，因为它们都没有执行字符串比较操作。除非您只想按字母顺序或其他方式对它们进行排序，否则在这种情况下，您将使用 Collections 框架中的 Tree 实现之一。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-06T06:40:55.087

基数树或帕特里夏树怎么样？

[http://en.wikipedia.org/wiki/Radix_tree](http://en.wikipedia.org/wiki/Radix_tree)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-11T17:31:33.960

与数组或数组列表相比，链表的唯一优势在于是否在任意位置进行插入和删除。我认为这里不是这种情况：您阅读文档并按顺序构建列表。

我认为当原始发布者谈到找到“word_2200”时，他的意思只是文档中的第 2200 个单词，而不是每个单词都有任意标签。如果是这样，那么他所需要的就是对所有单词的索引访问。因此，一个数组或数组列表。如果真的有更复杂的东西，如果一个词可能被标记为“word_2200”而下一个词被标记为“foobar_42”或类似的，那么是的，他需要一个更复杂的结构。

嘿，你想告诉我们你为什么要这样做吗？我很难记得上次我对自己说：“嘿，我想知道我正在阅读的这份文件中的第 1,237 个单词是比第 842 个单词长还是短？”

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-02-06T05:13:14.063

取决于问题是什么 - 速度或内存。

如果是内存，最小的解决方案是编写一个函数 getWord(n)，它每次运行时都会扫描整个文件，并提取单词 n。

现在 - 这不是一个很好的解决方案。一个更好的解决方案是决定你想使用多少内存：假设 1000 个项目。应用程序启动时扫描文件中的单词一次，并存储一系列书签，其中包含单词编号和文件中它所在的位置 - 这样做的方式是使书签或多或少均匀分布文件。

然后，打开文件进行随机访问。函数 getWord(n) 现在查看书签以找到最大的单词 # <= n（请使用二进制搜索），搜索到指定的位置，然后扫描文件，计算单词，找到请求的词。

一个更快的解决方案，使用更多的内存，是为块构建某种缓存 - 基于 getWord() 请求通常在集群中通过。您可以进行调整，以便如果有人要单词#X，但它不在书签中，那么您可以寻找它并将其放入书签中，通过合并最近最少使用的书签来节省内存。

等等。实际上，这取决于问题所在——取决于可能的检索模式。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-02-06T05:05:37.730

我不明白为什么这么多人建议使用 Arraylist 等，因为您没有提到必须遍历整个列表。此外，您似乎希望将它们作为键/值对（“word_348”="pedantic"）进行访问。

为了获得最快的访问速度，我会使用 TreeMap，它会进行二进制搜索以找到您的密钥。它唯一的缺点是它是不同步的，但这对您的应用程序来说不是问题。

[http://java.sun.com/javase/6/docs/api/java/util/TreeMap.html](http://java.sun.com/javase/6/docs/api/java/util/TreeMap.html)

# php - 代码重构类模式

> ID：518938
> 
> 赞同：1
> 
> 时间：2009-02-06T03:05:02.403
> 
> 标签：php, oop, design-patterns

我目前正在尝试为我正在制作的应用程序重构我的代码库，我有一个现有的设置，但它甚至还没有接近灵活，并且一切都依赖于其他一切（例如聚合到每个类）。

因此，在阅读了 PHP 设计模式和无数关于模式以及它们如何与可扩展应用程序相关的文章之后，我为我的新代码库设计了一个 UML 图。

由于我从未使用这些技术制作过应用程序，因此我想知道是否可以就我提议的布局获得一些反馈，以便在开始编码之前消除任何问题。

[代码重构](http://www.asciant.com/Refactor.jpg)

基本上我希望能够支持使用多个数据库（不是同时，而是在每个安装的基础上），我还希望可以选择设置自定义会话处理程序，如果首选数据库（或文件系统， cookie 等，如果愿意），并支持安全区域的首选身份验证方法（开放 ID 或数据库帐户等）。

总之，关于替代模式以及它们如何更好地适应的反馈将不胜感激，或者如果我完全走错了路，我希望现在就知道:)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T13:18:45.550

我觉得很好。如果您不想最终重构，请注意您的接口设置是否正确。

仔细思考界面中真正需要的内容，并且不要忘记您可以扩展界面以创建更复杂的场景。如果您发现自己编写空函数来满足您的界面，那么您的界面设计是错误的。

# msbuild - 从 CruiseControl.NET 调用的 MSBuild 不会获取构建脚本更改

> ID：518941
> 
> 赞同：0
> 
> 时间：2009-02-06T03:05:54.523
> 
> 标签：msbuild, cruisecontrol.net

我们正在使用 CruiseControl.NET，它调用 MSBuild 脚本。在调试构建脚本的同时，我们不断地进行小改动，并通过在 IIS 上运行的 CruiseControl.NET Web 控制台运行构建。一切都只是在一台机器上，因为我们只是在测试。

我注意到我们在 MSBuild 脚本中所做的一些更改没有被采纳。有时他们会通过，有时服务器的几个版本已经过时了。有时重新启动 IIS 服务可以解决问题。有时甚至这都行不通。

有人知道后台发生了什么吗？是否有一些我们必须为 Web 应用程序清除的缓存？它可能在哪里？

编辑：澄清一下，我所有的东西都在一台机器上，因为我仍处于测试阶段。所以我不认为源代码控制应该是一个问题。我的 ccnet.config 只是调用 MSBuild 目标。这是一个简化的示例：

```
<project>
    <tasks>
        <msbuild>
            <executable>$(netFrameworkRoot)\MSBuild.exe</executable>
            <projectFile>C:\MyProject\ProductBuild.proj</projectFile>
            <targets>BuildProject</targets>
        </msbuild>
    </tasks>
</project> 
```

ProductBuild.proj 是一个手动编码的 MSBuild 脚本，可构建许多其他 .NET 解决方案并将安装程序与 vdproj 打包在一起。

当我在 CruiseControl 上运行构建时，对构建脚本所做的更改似乎并不总是生效。我想重新启动 CCNet 服务是最安全的，但我希望不必中断当前正在运行的构建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T15:13:19.250

“通过在 IIS 上运行的 CruiseControl.NET Web 控制台运行构建” 据我所知，Web 控制台不进行任何构建。它会向 ccnet.exe 或 ccservice.exe 发送一条消息，它们一直在运行并在端口 21234 上侦听（除非指定到另一个端口）但是要尝试解决您的问题，您是否有您的构建项目总是得到最新的？您的 MSBuild 文件是否在源代码管理中？你用的是什么源代码控制？您是否正在更改构建服务器上工作区中的 MSBuild 文件？您应该在此处发布您的项目副本，以便我们尝试确定错误？我可以告诉你，就 CruiseCONtrol 而言，IIS 和 Web 缓存与实际编译无关。除非您在谈论您正在构建的项目需要 IIS 吗？

# sqlconnection - SQLConnection 池 - 处理 InvalidOperationExceptions

> ID：518942
> 
> 赞同：0
> 
> 时间：2009-02-06T03:06:21.493
> 
> 标签：sqlconnection, invalidoperationexception, ccr

我正在设计一个高度并发的 CCR 应用程序，在该应用程序中，我必须不阻塞或发送睡眠线程。

我遇到了 SQLConnection 池问题 - 特别是在尝试调用 SqlConnection.Open 时得到 InvalidOperationExceptions

我可能会重试一手牌，但这并不能真正解决问题。

对我来说，理想的解决方案是定期重新检查连接的可用性，而不需要绑定线程

有任何想法吗？

[更新] 这是[另一个论坛上发布的相关问题/解决方案](http://social.msdn.microsoft.com/Forums/en-US/roboticsccr/thread/d75b73b6-7b99-4ffb-a2e0-7aa29f26f1e8/)

该解决方案需要手动管理的连接池。我宁愿有一个更动态的解决方案，即在需要时启动

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T12:00:51.837

哈利，我也遇到过这个问题，也是在使用 CCR 时。我的经验是，将调度程序线程与任何 I/O 上的阻塞完全解耦后，我可以比 SqlConnection 池处理的更快地消耗和处理工作项。一旦达到最大池限制，我就会遇到您所看到的那种错误。

最简单的解决方案是预先分配一些非池化的异步 SqlConnection 对象并将它们发布到某个中心 Port<SqlConnection> 对象。然后，每当您需要执行命令时，请在迭代器中执行以下操作：

```
public IEnumerator<ITask> Execute(SqlCommand someCmd)
{
    // Assume that 'connPort' has been posted with some open
    // connection objects.
    try
    {
        // Wait for a connection to become available and assign
        // it to the command.
        yield return connPort.Receive(item => someCmd.Connection = item);

        // Wait for the async command to complete.
        var iarPort = new Port<IAsyncResult>();
        var iar = someCmd.BeginExecuteNonQuery(iarPort.Post, null);
        yield return iarPort.Receive();

        // Process the response.
        var rc = someCmd.EndExecuteNonQuery(iar);
        // ...
    }
    finally
    {
        // Put the connection back in the 'connPort' pool
        // when we're done.
        if (someCmd.Connection != null)
            connPort.Post(someCmd.Connection);
    }
} 
```

使用 Ccr 的好处在于，将以下功能添加到这段基本代码中是微不足道的。

1.  超时 - 只需进行初始接收（对于可用连接），一个带有超时端口的“选择”。
2.  动态调整池大小。要增加池的大小，只需将新的打开的 SqlConnection 发布到“connPort”。要减小池的大小，请在 connPort 上产生一个接收，然后关闭接收到的连接并将其丢弃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T13:16:21.273

是的，连接保持打开状态并且不在连接池中。在上面的示例中，端口*是*池。

# html - 如何获得选中复选框的结果？

> ID：518958
> 
> 赞同：1
> 
> 时间：2009-02-06T03:23:19.760
> 
> 标签：html, checkbox, variables

我对 HTML 真的很陌生，但我在任何地方都找不到如何从复选框返回变量。我已经弄清楚如何从表单和输入中获取变量，但我不知道如何从复选框中获取它们。基本上，我想要一个复选框，如果选中，将返回值是。如果未选中，则不必返回值，但 no 会很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T03:25:32.517

提交表单时，如果选中了一个复选框，它将包含在提交给服务器的值集合中。如果未选中，它将被省略（好像该复选框不存在）。

在 JavaScript 中，您可以查看复选框是否被`checked`属性选中：

```
//returns true or false
var isChecked = document.getElementById('id_of_checkbox').checked; 
```

在 ASP.NET 中，CheckBox 控件有一个布尔属性 Checked。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T03:28:48.877

为 value 属性分配一些东西。如果回发的表单值中有一个，您应该获得复选框的值。请注意，在您想要是或否的情况下，我已将其设为无线电输入。对于收音机，您需要分配相同的名称，但不同的 id（如果您完全分配了 id）。如果您可以选择多个值或只关心在选择时获取该值，则您需要使用复选框。这些类型的复选框应该有不同的名称。

```
<input type="radio" id="radio_yes" name="radio_btn" value="Yes" /> Yes
<input type="radio" id="radio_no" name="radio_btn" value="No"
       checked="checked" /> No 
```

如果您只想在选中时返回一个值为 yes 的复选框，那么您可以使用复选框。如果不检查，您将不会获得任何价值。

```
<input type="checkbox" id="chk_box" name="chk_box"
       value="Yes" /> Do you want this? 
```

在服务器端，您在表单参数中查找与“radio_btn”（第一个示例）或“chk_box”（第二个示例）键对应的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T03:26:33.780

使用“检查”属性。

```
var checkbox = document.getElementById('checkboxId');
var checked = checkbox.checked; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T03:27:29.877

查看 YourCheckboxName.Checked 的值

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-29T11:18:52.147

如果一个复选框被禁用，即使它被选中，它也会在提交给服务器的值集合中被忽略：

```
 <input type="checkbox" name="checkbox1"> 
  <input type="checkbox" name="checkbox2" checked> 
  <input type="checkbox" name="checkbox3" disabled> 
  <input type="checkbox" name="checkbox4" disabled checked> 
```

看起来像： [HTML 示例代码的结果](https://i.stack.imgur.com/narX1.png)

只有`checkbox2`在提交到服务器的值集合中，如果用户提交表单而不进行任何更改。

# c++ - 为什么这个 auto_ptr 的 dynamic_cast 会失败？

> ID：518959
> 
> 赞同：6
> 
> 时间：2009-02-06T03:24:07.090
> 
> 标签：c++, casting

```
 #include "iostream"

    class A {
        private:
        int a;
        public :

        A(): a(-1) {}
        int getA() {
            return a;
        }

    };

    class A;

    class B : public A {
        private:
        int b;
        public:

        B() : b(-1) {}

        int getB() {
            return b;
        }

    };

    int main() {
        std::auto_ptr<A> a = new A();

        std::auto_ptr<B> b = dynamic_cast<std::auto_ptr<B> > (a);

        return 0;

    } 
```

错误：不能 dynamic_cast `(&a)->std::auto_ptr<_Tp>::get() const

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-06T04:07:53.197

嗯，`std::auto_ptr<B>`不是从`std::auto_ptr<A>`. 但`B`源自`A`. auto_ptr 不知道这一点（它不是那么聪明）。看起来您想使用共享所有权指针。`boost::shared_ptr`是理想的，它还提供了一个dynamic_pointer_cast：

```
boost::shared_ptr<A> a = new A();
boost::shared_ptr<B> b = dynamic_pointer_cast<B> (a); 
```

对于 auto_ptr 来说，这样的事情是行不通的。因为所有权将转移到`b`. 但是如果演员阵容失败， b 就无法获得所有权。目前还不清楚该对我做什么。你可能不得不说，如果演员阵容失败，a 将继续拥有所有权——这听起来会造成严重的麻烦。最好开始使用 shared_ptr。`a`和then都`b`指向同一个对象——但`B`作为 a`shared_ptr<B>`和`a`作为 a`shared_ptr<A>`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T04:08:05.443

动态转换不是那样工作的。`A : public B`并不意味着`auto_ptr<A> : public auto_ptr<B>`。这就是 boost`shared_ptr`提供`shared_dynamic_cast`. 不过，您可以编写`auto_ptr`动态演员表：

```
template<typename R, typename T>
std::auto_ptr<R> auto_ptr_dynamic_cast(std::auto_ptr<T>& in) {
  auto_ptr<R> rv;
  R* p;
  if( p = dynamic_cast<R*>( in.get() ) ) {
      in.release();
      rv = p;
  }
  return rv; 
```

}

请注意这里发生的事情。由于`auto_ptr`s 具有所有权语义，因此成功的向下转换意味着原始类型更普遍的 auto_ptr 不再具有所有权。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T04:07:04.837

原因是 auto_ptr 实际上并不是一个指针。它是一个智能指针，它是一个指针包装器，但实际上不是一个指针。作为模板样式参数传递给 dynamic_cast 的类型必须是真正的指针（或引用）类型。

[http://msdn.microsoft.com/en-us/library/cby9kycs(VS.80).aspx](http://msdn.microsoft.com/en-us/library/cby9kycs(VS.80).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T04:09:03.943

您正在尝试将`A*`(由`a.get()`) 返回到`std::auto_ptr<B>`，并且由于第二个甚至不是指针类型，因此失败。可能您只想将其转换为`B*`：

```
std::auto_ptr<A> a(new A());
std::auto_ptr<B> b(dynamic_cast<B*>(a.get())); 
```

这仍然无法编译，因为`A`并且`B`不是多态类型。`A`需要有一个虚函数才能使类型多态。这将编译，但演员只会 throw `std::bad_cast`，因为它不是真正的`B*`.

即使它是一个`B*`，**如果你尝试使用它，它也会以可怕的方式失败**。`std::auto_ptr`s`a`和will都`b`假定他们拥有该对象并稍后释放它，从而导致各种内存损坏。您可能想`a.release()`在施法成功后使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T04:55:56.470

我认为 c++ 将 RTTI（运行时类型信息）存储在 vtable 中。因此，要将 dynamic_cast<> 与实例对象一起使用，该对象需要具有“vtable”。只有在类中至少有一个函数被声明为“虚拟”时，C++ 才会创建 vtable。

A 类和 B 类没有虚函数。这可能是 dynamic_cast 失败的原因。尝试在基类中声明一个虚拟析构函数。

# django - ModelForm 上的 Django 和字段集

> ID：518966
> 
> 赞同：40
> 
> 时间：2009-02-06T03:26:58.100
> 
> 标签：django, forms, fieldset

我知道您可以在 django 中为管理员助手指定字段集。但是，我找不到任何对 ModelForms 有用的东西。只是一些我不能使用的补丁。我错过了什么吗？有没有一种方法可以实现类似字段集的功能，而无需在模板上的相应标签中手动写出每个字段。

理想情况下，我想遍历一组 BoundFields。但是，在我的 ModelForm 结束时做这样的事情：

```
 fieldsets = []
    fieldsets.append(('Personal Information',
                      [username,password,password2,first_name,last_name,email]),) # add a 2 element tuple of string and list of fields
    fieldsets.append(('Terms &amp; Conditions',
                      [acceptterms,acceptprivacy]),) # add a 2 element tuple of string and list of fields 
```

失败，因为我的数据结构中包含的项目是原始字段，而不是 BoundFields。t 看起来 BoundFields 是动态生成的……这让我很难过。我可以创建我自己的 forms.Form 子类，其中包含字段集的概念（即使是一个不向后兼容的粗略的...这仅适用于我自己的项目），如果是这样，你能指点一下吗？我不想弄乱 django 代码。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-02-08T15:24:56.340

我认为[这个片段](http://www.djangosnippets.org/snippets/1314/)正是你想要的。它为您提供了一个 Form 子类，允许您以声明方式将表单细分为字段集并在模板中遍历它们。

更新：该片段已成为[django-form-utils 的一部分](http://github.com/carljm/django-form-utils)

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-02-06T07:27:44.243

模型表单中的字段集仍处于“设计”阶段。Django trac 中有一张活动量较低的[票](http://code.djangoproject.com/ticket/6630)。

这是我在不久的将来对自己进行研究感兴趣的东西，但是由于我还没有这样做，所以我能提供的最好的就是这些片段：

*   [表单拆分/字段集模板标签](http://www.djangosnippets.org/snippets/1019/)
*   [分段表格](http://www.djangosnippets.org/snippets/798/)
*   [在字段集中拆分的表单](http://www.djangosnippets.org/snippets/663/)

**编辑：**我刚刚再次注意到这个问题，我意识到需要进行编辑以指出 Carl 的项目[django-form-utils](http://bitbucket.org/carljm/django-form-utils/src/)包含一个 BetterForm 类，该类可以包含字段集。如果您喜欢这个项目，请在下面为他的回答给他 +1 :)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-06T22:32:39.440

您可以做的一件事是将逻辑字段集分解为单独的模型表单类。

```
class PersonalInfoForm (forms.ModelForm):
    class Meta:
        model=MyModel
        fields=('field1', 'field2', ...)

class TermsForm (forms.ModelForm):
    class Meta:
        model=MyModel
        fields=('fieldX', 'fieldY', ...) 
```

将它们以不同的变量传递给您的模板并分解表单集：

```
<form ...>
   <fieldset><legend>Personal Information</legend>
       {{ personal_info_form }}
   </fieldset>
   <fieldset><legend>Terms and Conditions</legend>
       {{ terms_form }}
   </fieldset>
</form> 
```

从这个意义上说，您的每个表单类只是实际 HTML 表单的一个片段。

当您在表单上调用 save 时，它​​会引入一些复杂性。您可能想要传递 commit=False 然后合并结果对象。或者完全避免使用 ModelForm.save 并使用“cleaned_data”手动填充模型对象

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-10-08T13:53:05.247

Daniel Greenfelds django-uni-form 使用 Layout 助手类解决了这个问题。我现在正在尝试它，它对我来说看起来很干净。

> [统一助手可以使用布局对象。布局可以由字段集、行、列、HTML 和字段组成](http://github.com/pydanny/django-uni-form)。

我最初选择 Django-uni-form 是因为它符合[第 508 节](http://en.wikipedia.org/wiki/Section_508_Amendment_to_the_Rehabilitation_Act_of_1973)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-06-23T12:47:52.610

你可以使用这个包：`https://pypi.org/project/django-forms-fieldset/`

```
pip install django-forms-fieldset 
```

将 forms_fieldset 添加到您的 INSTALLED_APPS 设置中，如下所示：

```
INSTALLED_APPS = [
    ...
    'forms_fieldset',
] 
```

`fieldsets`在您的表格中添加

```
from django.forms import ModelForm

from .models import Student

class StudentForm(ModelForm):
    fieldsets = [
        ("Student Information", {'fields': [
            ('first_name', 'last_name'),
            ('email', 'adress'),
        ]}),
        ("Parent Information", {'fields': [
            'mother_name',
            'father_name',
        ]}),
    ]
    class Meta:
        model = Student
        fields = '__all__' 
```

在你看来

```
def home(request):
    form = StudentForm()
    if request.method == 'POST':
        form = Form(request.POST, request.FILES)
        #save...
    context = {
        'form': form,
    }
    return render(request, 'home.html', context) 
```

在您的模板中

```
{% load forms_fieldset static %}
<link rel="stylesheet" type="text/css" href="{% static 'forms_fieldset/css/main.css' %}">

<form>
    {{ form|fieldset:'#42945c' }}
</form> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-07T10:02:00.193

这是我为了理解自定义标签（带有链接）而开发的代码。我应用它来创建一个字段集。

免责声明：我鼓励使用上述任何答案，这只是为了学习。

`templatetags/myextras.py`：

```
from django import template
from django.template import Context

register = template.Library()

class FieldsetNode(template.Node):
    """ Fieldset renderer for 'fieldset' tag """
    def __init__(self, nodelist, fieldset_name):
        """ Initialize renderer class
        https://docs.djangoproject.com/en/1.8/howto/custom-template-tags/#writing-the-renderer
        :param nodelist: a list of the template nodes inside a block of 'fieldset'
        :param fieldset_name: the name of the fieldset
        :return: None
        """
        self.nodelist = nodelist
        self.fieldset_name = fieldset_name

    def render(self, context):
        """ Render the inside of a fieldset block based on template file
        https://docs.djangoproject.com/en/1.8/howto/custom-template-tags/#auto-escaping-considerations
        :param context: the previous template context
        :return: HTML string
        """
        t = context.template.engine.get_template('myapp/fieldset.html')
        return t.render(Context({
            'var': self.nodelist.render(context),
            'name': self.fieldset_name,
        }, autoescape=context.autoescape))

@register.tag
def fieldset(parser, token):
    """ Compilation function for fieldset block tag
    Render a form fieldset
    https://docs.djangoproject.com/en/1.8/howto/custom-template-tags/#writing-the-compilation-function
    https://docs.djangoproject.com/en/1.8/howto/custom-template-tags/#parsing-until-another-block-tag
    :param parser: template parser
    :param token: tag name and variables
    :return: HTML string
    """
    try:
        tag_name, fieldset_name = token.split_contents()
    except ValueError:
        raise template.TemplateSyntaxError("%r tag requires a single argument" % token.contents.split()[0])
    if not (fieldset_name[0] == fieldset_name[-1] and fieldset_name[0] in ('"', "'")):
        raise template.TemplateSyntaxError("%r tag's argument should be in quotes" % tag_name)
    nodelist = parser.parse(('endfieldset',))
    parser.delete_first_token()
    return FieldsetNode(nodelist, fieldset_name[1:-1]) 
```

`templates/myapp/fieldset.html`：

```
<div class="fieldset panel panel-default">
    <div class="panel-heading">{{ name }}</div>
    <div class="panel-body">{{ var }}</div>
</div> 
```

`templates/myapp/myform.html`：

```
<form action="{% url 'myapp:myurl' %}" method="post">
    {% csrf_token %}
    {% fieldset 'General' %}
        {{form.myfield1 }}
    {% endfieldset %}
    {# my submit button #}
</form> 
```

# javascript - 引用 Javascript 对象中的键

> ID：518971
> 
> 赞同：2
> 
> 时间：2009-02-06T03:29:13.413
> 
> 标签：javascript, object

```
var foo = { someKey: "someValue" };
var bar = "someKey"; 
```

如何使用 foo 和 bar 获取值“someValue”？好的，PHP 等价物：

```
$foo = array("someKey" => "someValue");
$bar = "someKey";
print $foo[$bar]; // someValue 
```

所以...我正在寻找上面的 JS 等价物，除了我不想使用 JS 数组。请帮忙？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T03:30:46.657

像这样：

> 富[酒吧]

您使用*方括号*来引用字符串键值。

`foo.someKey`等于`foo["someKey"]`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T03:31:09.603

foo[bar] 应该这样做。在 js 中，对象基本上是美化的哈希表。

# apache-flex - 在性能方面，Flex 和 Silverlight 哪个更好？

> ID：518978
> 
> 赞同：7
> 
> 时间：2009-02-06T03:31:57.310
> 
> 标签：apache-flex, silverlight, performance

一般来说，哪个表现更好？它们在处理矢量图形时是什么样子的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-06T04:01:33.973

[Bubblemark](http://bubblemark.com/)是 RIA 的首要基准测试网站。

请注意至少一张比较图像显示在 Flash 中的[绘图效果更好。](http://www.hot-keyboard.com/dk/FvsSL.png)

GUIMark[测试](http://www.craftymind.com/guimark/)非常有趣，初步结果显示 SilverLight 的性能很差。如果您仔细阅读评论，则该解决方案被确定为部分是时间编码问题，部分是由于 SilverLight 呈现文本的主要速度问题。

因此，一个关键问题是文本是否构成了您希望快速渲染的主要部分。

另外——我早在 2003 年就在 Cocoa 中做了一个实时图形引擎，我最终使用了传统的 Quickdraw 渲染，因为当时 Mac OS/X 上 Quartz 图形的高度抗锯齿和花哨的文本渲染太慢了。快速、好看的文字并不容易！

# cocoa - 当我在 2 个 Cocoa 视图中同时播放时，为什么电影会跳动？

> ID：518985
> 
> 赞同：0
> 
> 时间：2009-02-06T03:34:53.090
> 
> 标签：cocoa, quicktime

我有一个有两个视图的 Cocoa 应用程序。这两个视图都是 QTMovieView 的子类。我想在两个视图中播放同一部电影（一个视图是较大视图的较小预览）。现在我正在做：

```
QTMovie *movie = [[QTMovie alloc] initWithFile:path error:nil];  
[largeView setMovie:movie];  
[smallView setMovie:movie]; 
```

当我这样做时，电影很跳动，播放不流畅。如果我只是将电影设置为一个或另一个，它似乎播放得很好。我尝试了多部电影，它们都做同样的事情。有任何想法吗？有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T04:54:06.877

您可能使资源负担过重 - CPU 和/或磁盘 I/O 是您最可能的罪魁祸首。

如果您打开两个 Quicktime 窗口，您可以同时播放电影而不会卡顿吗？您的 CPU 是否已用尽（尤其是在单核机器上）？您可以从第二个来源流式传输并修复口吃吗？如果您没有两个硬盘驱动器，您可以尝试从 USB 硬盘驱动器或闪存驱动器播放其中一部电影。

我不是 quicktime 或 Objective-C 程序员，但我会首先查看镜像内容，而不是打开两个电影实例。也许您可以捕获屏幕的一部分，缩小内容并将其转储到较小的预览窗口。

# sql - 存储过程执行计划——数据操作

> ID：518988
> 
> 赞同：2
> 
> 时间：2009-02-06T03:36:53.320
> 
> 标签：sql, sql-server, stored-procedures, sql-execution-plan

我有一个处理大量数据的存储过程（在这个例子中大约有 5m 行）。性能差异很大。我已经让这个过程在短短 15 分钟内运行，并且看到它运行了长达 4 小时。

为了维护，并且为了验证逻辑和处理是否正确，我们将 SP 分成几个部分：

1.  `TRUNCATE`并填充一个工作表（索引），我们稍后可以使用自动化测试工具进行验证。

2.  将几个表连接在一起（包括其中一些工作表）以生成另一个工作表

重复 1 和/或 2，直到产生最终输出。

我担心的是这是一个单一的 SP，因此在第一次运行时会得到一个执行计划（甚至`WITH RECOMPILE`）。但当时，工作表（Work 模式中的永久表）是空的。

我担心，无论索引方案如何，执行计划都会很差。

我正在考虑拆分 SP 并从其中调用单独的 SP，以便在构建工作表中的数据后，它们可以利用重新评估的执行计划。我还看到了使用 EXEC 运行动态 SQL 的参考，显然也可能得到一个`RECOMPILE`。

我仍在尝试获得`SHOWPLAN`许可，所以我很盲目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T09:17:06.380

您是否能够确定是否存在任何锁定问题？您是否在足够小的事务中运行 SP？

将其分解为子程序应该没有任何好处。

有人应该关心您的生产力，在没有基本优化资源的情况下工作。这表明可能还有其他可能的看不见的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T04:48:51.710

在下面的链接中获取“剖析执行计划”的免费副本，也许您可​​以从中获得一两个提示，这将使您对 SP 背后的真实情况有所了解。

[http://dbalink.wordpress.com/2008/08/08/dissecting-sql-server-execution-plans-free-ebook/](http://dbalink.wordpress.com/2008/08/08/dissecting-sql-server-execution-plans-free-ebook/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T06:30:48.027

您确定您看到的可变性是由“糟糕的”执行计划引起的吗？这可能是一个原因，但可能还有许多其他原因：

*   数据库机器上的“其他”负载
*   使用不同的数据时，可能有“简单”和“硬”数据
*   必须分配更多内存/文件存储的问题
*   ...

您是否尝试过多次使用相同的数据运行 SP？

此外，为了找出导致运行时/可变性的原因，我会尝试进行一些详细的测量以将问题归结为代码的特定部分。（最简单的方法是在 sp 的各个点插入一些日志调用）。然后尝试解释为什么该部分很慢（除了“5M 行;-)）并找出一种方法来加快速度。

目前，我认为在走“拆分 sp”路线之前有几个问题需要回答。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T09:11:36.157

您是对的，在您从整个流程的多次执行中获得“实际”执行计划之前，您很难清楚地了解幕后发生的事情。

也许要考虑一点。您的工作表是物理的临时表吗？如果它们是物理的，您将通过将新数据插入没有索引（即堆）的新表中来获得性能提升，然后您可以在插入所有数据后在其上构建索引。

另外，您的过程的目的是什么。听起来您正在移动相当多的数据，在这种情况下，您可能希望考虑使用分区。您可以相对轻松地将数据输入和输出到主表。

希望我详细说明的内容很清楚，但请随时提出进一步的问题。

干杯，约翰

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-08T22:35:47.017

在某些情况下，我已经看到执行时间/查询计划的这种多样性程度归结为统计数据。我建议在运行进程之前针对您正在使用的表运行一些更新统计信息的测试。这将强制通过 SQL 重新评估执行计划，并且我怀疑会为您提供更一致的结果。此外，您可能会很好地查看执行时间的差异是否与您的 dbas 重新索引作业相关。也许您还可以在每次运行之前收集一些索引健康统计信息。

如果不是，正如其他回答者所建议的那样，您更有可能遇到锁定和/或争用问题。

祝你好运。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T04:40:38.200

我能想到的唯一一件事是，当没有数据时，执行计划会出错，因为使用表扫描而不是索引是错误的，因为当整个表都可以放入内存时，表扫描速度非常快。由于创建执行计划时没有数据，您是否实际观察到或肯定正在发生其他负面影响？

您可以在查询中[强制使用索引](http://msdn.microsoft.com/en-us/library/ms187373.aspx)...

在我看来，你可能走错了路。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T18:02:32.857

这是某种形式的输入或输出，还是您正在创建报告？如果是提要，我建议您更改流程以使用 SSIS，它应该能够非常快速地移动 500 万条记录。

# perl - 如何在不使用 select 的情况下在 Perl 中检查（窥视）STDIN 以获取管道数据？

> ID：518992
> 
> 赞同：10
> 
> 时间：2009-02-06T03:39:35.563
> 
> 标签：perl, pipe, cross-platform, stdin, perl-select

我正在尝试处理没有参数和管道数据传递给 Perl 脚本的可能性。我假设如果没有参数，那么输入将通过 STDIN 进行管道传输。但是，如果用户没有提供任何参数并且没有向脚本传递任何内容，它将尝试获取键盘输入。我的目标是提供错误消息。

不幸的是，`select()`它不能移植到一些非 POSIX 系统。是否有另一种方法可以最大限度地提高便携性？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-06T05:43:44.517

Perl 带有`-t`文件测试操作符，它告诉你一个特定的文件句柄是否对 TTY 开放。所以，你应该能够做到这一点：

```
if ( -t STDIN and not @ARGV ) {
    # We're talking to a terminal, but have no command line arguments.
    # Complain loudly.
}
else {
    # We're either reading from a file or pipe, or we have arguments in
    # @ARGV to process.
} 
```

一个快速的测试表明，在 Windows 上运行 Perl 5.10.0 和 Linux 上运行 Perl 5.8.8，所以它应该可以在最常见的 Perl 环境中移植。

正如其他人所提到的，`select`这不是一个可靠的选择，因为有时您可能正在从进程中读取，但该进程尚未开始写入。

祝一切顺利，

*保罗*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T05:03:09.323

```
use POSIX 'isatty';
if ( ! @ARGV && isatty(*STDIN) ) {
    die "usage: ...";
} 
```

见：[http ://www.opengroup.org/onlinepubs/009695399/functions/isatty.html](http://www.opengroup.org/onlinepubs/009695399/functions/isatty.html)

请注意，无论如何，选择不会有太大帮助，因为如果管道信息还没有准备好，它会产生错误的结果。例子：

```
seq 100000|grep 99999|perl -we'$rin="";vec($rin,fileno(STDIN),1)=1;print 0+select($rin,"","",.01)' 
```

# c# - 基类能否确定派生类是否覆盖了虚拟成员？

> ID：518994
> 
> 赞同：6
> 
> 时间：2009-02-06T03:40:03.893
> 
> 标签：c#, reflection, inheritance, overriding

这是我的课程的简化版本：

```
public abstract class Task
{
    private static object LockObject = new object();

    protected virtual void UpdateSharedData() { }
    protected virtual void UpdateNonSharedData() { }

    public void Method()
    {
       lock(LockObject)
       {
          UpdateSharedData();
       }
       UpdateNonSharedData();
    }
} 
```

我试图从派生类中隐藏锁定代码。但我只想在派生类覆盖 UpdateSharedData 时获得锁；如果不是，我不希望该方法在更新非共享数据之前阻塞并等待所有其他更新共享数据的运行实例。

因此，Method 要做的（看似）显而易见的事情是检查并查看 UpdateSharedData 的当前实例的实现是否覆盖了基类的实现。我很确定如果不使用反射，这是不可能的，而且这样做可能是不可取的。

我已经想到了一些解决方法，但它们都很尴尬：

*   添加派生类的构造函数设置的受保护的布尔属性，并检查该属性以查看是否需要锁定。这在从派生类中隐藏锁定代码方面做得非常糟糕。
*   使 UpdateSharedData 方法成为委托属性，让任何派生类在其构造函数中将该属性设置为私有方法，并且仅在委托不为空时获取锁。这更好，但它仍然有点糟糕。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T03:55:50.117

您可以通过一点反思来进行此检查：

```
bool IsUpdateSharedDataOverridden()
{
    Type t = this.GetType();
    MethodInfo m = subType.GetMethod("UpdateSharedData");

    return m.DeclaringType == t && m.GetBaseDefinition().DeclaringType == typeof(Task);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T03:59:49.267

如果您定义了一个抽象 Task 和一个 IHasSharedData 接口，那么在 Method 中您检查派生的 Task 是否在执行锁定之前实现 IHasSharedData。只有实现接口的类需要等待。我意识到这避免了回答实际问题，但我认为这将是一个比使用反射更清洁的解决方案。希望您能找到一个更好的接口名称，与类的实际功能更接近。

```
public interface IHasSharedData
{
    void UpdateSharedData();
}

public abstract class Task
{
    private static object LockObject = new object();

    protected virtual void UpdateNonSharedData() { }

    public void Method()
    {
         if (this is IHasSharedData)
         {
            lock(LockObject)
            {
                UpdateSharedData();
            }
         }
         UpdateNonSharedData();
    }
}

public class SharedDataTask : Task, IHasSharedData
{
    public void UpdateSharedData()
    {
       ...
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T04:12:53.920

实际上，您在谈论两个不同的对象：

```
public abstract class Task {    
    protected virtual void UpdateNonSharedData() { }

    public virtual void Method()    
    {   
        UpdateNonSharedData();    
    }
}

public abstract class TaskWithSharedData : Task {    
    private static object LockObject = new object();    

    protected virtual void UpdateSharedData() { }

    public overrides void Method()    
    {       
        lock(LockObject)
        {          
            UpdateSharedData();       
        }   
        base.Method();
    }
} 
```

但是，更理想的解决方案将是策略模式。

# c++ - CUDA 编译器 (nvcc) 宏

> ID：518995
> 
> 赞同：15
> 
> 时间：2009-02-06T03:40:16.230
> 
> 标签：c++, cuda, macros, c-preprocessor, nvcc

是否有我可以使用的 CUDA 的#define 编译器 (nvcc) 宏？（如 _WIN32 用于 Windows 等。）

我需要这个用于在 nvcc 和 VC++ 编译器之间通用的头代码。我知道我可以继续定义我自己的并将其作为参数传递给 nvcc 编译器 (-D)，但如果已经定义了它会很棒。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-06T03:53:36.937

```
__CUDACC__ 
```

我不认为这将是微不足道的。检查以下线程

[http://forums.nvidia.com/index.php?showtopic=32369&st=0&p=179913&#entry179913](http://forums.nvidia.com/index.php?showtopic=32369&st=0&p=179913&#entry179913)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-01-19T11:52:54.207

我知道它已经很长时间了，但您可能也会发现它 `__CUDA_ARCH__`很有用。*******`***