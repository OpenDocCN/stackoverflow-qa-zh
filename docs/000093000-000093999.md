# StackOverflow 问答 000093000-000093999

# c# - 字段访问的属性是否仍然延迟加载？

> ID：93018
> 
> 赞同：0
> 
> 时间：2008-09-18T14:26:46.160
> 
> 标签：c#, .net, nhibernate, lazy-loading

我在映射文件中使用 field.camelcase 来设置集合、依赖实体等，并将集合公开为只读数组。我知道访问策略不会影响延迟加载，我只想确认这仍然会被缓存：

```
private ISet<AttributeValue> attributes;
public virtual AttributeValue[] Attributes
        {
            get { return attributes.ToArray(); }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-18T14:59:31.230

访问值只是告诉它如何访问该字段，而 field.camelcase 只是告诉它命名策略。这不会影响延迟加载。延迟值将确定映射中的延迟加载。

请参阅：[https ://nhibernate.info/doc/nhibernate-reference/mapping.html](https://nhibernate.info/doc/nhibernate-reference/mapping.html)

# ide - 非 Visual Studio F# IDE

> ID：93022
> 
> 赞同：22
> 
> 时间：2008-09-18T14:27:09.827
> 
> 标签：ide, f#

有谁知道不涉及我花费 300 美元的 F# 开发 IDE？如果他们发布了 F# VS Express，我会很高兴地转向他们，但是花钱开始使用新语言不在我的预算之内。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-18T14:29:36.293

[http://msdn.microsoft.com/en-us/vsx2008/products/bb933751.aspx](http://msdn.microsoft.com/en-us/vsx2008/products/bb933751.aspx)

Visual Studio Shell - 免费，F# 开箱即用。

（已编辑） [http://blogs.msdn.com/dsyme/archive/2008/04/04/tackling-the-f-productization.aspx](http://blogs.msdn.com/dsyme/archive/2008/04/04/tackling-the-f-productization.aspx)

还有一个关于使用 Shell 的链接等等

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-18T14:30:21.067

看起来[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/Download/#SharpDevelop30) (3.0) 的最新 beta 版本支持 F#。SharpDevelop 是一个开源 IDE，类似于 Visual Studio 的克隆。几年前，当我在某个地方太便宜而无法购买 Visual Studio 时，我使用了它。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-26T17:41:13.027

[Monodevelop](http://monodevelop.com/) / [Xamarin Studio](https://www.xamarin.com/studio)是与 .net 和单声道环境兼容的免费 ide

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-12-28T13:00:17.613

LinqPad 4.0 支持 F#。 [http://www.linqpad.net/Beta.aspx](http://www.linqpad.net/Beta.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-26T18:30:25.230

启动一个 WebsiteSpark 微软程序。它是免费的，三年内您将可以使用最新版本的 Visual Studio Professional。幸好三年前找到了...

[这里](http://www.microsoft.com/web/websitespark/)是链接

这是我公司的描述，只是为了向您展示：

*没有任何客户的自由职业者只是为了学习新东西；）*

# c++ - C 和 C++ 中的静态变量存储在哪里？

> ID：93039
> 
> 赞同：203
> 
> 时间：2008-09-18T14:29:05.937
> 
> 标签：c++, c, compiler-construction

在可执行文件的哪个段（.BSS、.DATA、其他）中存储了静态变量，这样它们就不会发生名称冲突？例如：

```
 foo.c:                         bar.c:
static int foo = 1;            static int foo = 10;
void fooTest() {               void barTest() {
  static int bar = 2;            static int bar = 20;
  foo++;                         foo++;
  bar++;                         bar++;
  printf("%d,%d", foo, bar);     printf("%d, %d", foo, bar);
}                              } 
```

如果我编译这两个文件并将其链接到重复调用 fooTest() 和 barTest 的 main ，则 printf 语句会独立递增。有意义，因为 foo 和 bar 变量是翻译单元的本地变量。

但是存储分配在哪里？

需要明确的是，假设您有一个可以以 ELF 格式输出文件的工具链。因此，我*相信*在可执行文件中**必须**为这些静态变量保留一些空间。
出于讨论目的，假设我们使用 GCC 工具链。

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2008-09-18T15:07:35.283

你的静态变量的去向取决于它们是否是*零初始化的*。*零初始化*静态数据进入[.BSS (Block Started by Symbol)](http://en.wikipedia.org/wiki/.bss)，*非零初始化*数据进入[.DATA](http://en.wikipedia.org/wiki/Data_segment)

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2012-07-28T05:08:36.263

当一个程序被加载到内存中时，它被组织成不同的段。段之一是**DATA 段**。数据段进一步细分为两部分：

*   **初始化数据段：**所有的全局、静态和常量数据都存放在这里。
*   **未初始化数据段（BSS）：**所有未初始化的数据都存储在该段中。

这是解释这个概念的图表：

![在此处输入图像描述](https://i.stack.imgur.com/JQjKp.png)

这是解释这些概念的非常好的链接：[C中的内存管理：堆和堆栈](https://web.archive.org/web/20170829060314/http://www.inf.udec.cl/%7Eleo/teoX.pdf)

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2008-09-20T19:38:30.473

实际上，变量是元组（存储、范围、类型、地址、值）：

```
storage     :   where is it stored, for example data, stack, heap...
scope       :   who can see us, for example global, local...
type        :   what is our type, for example int, int*...
address     :   where are we located
value       :   what is our value 
```

本地范围可能意味着翻译单元（源文件）、函数或块的本地范围，具体取决于其定义的位置。要使变量对多个函数可见，它肯定必须在 DATA 或 BSS 区域中（分别取决于其是否显式初始化）。然后将其范围相应地限定为源文件中的所有函数或函数。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-09-18T14:33:38.453

数据的存储位置将取决于实现。

但是，**静态**的含义是“内部链接”。因此，该符号在编译单元（foo.c、bar.c）*内部*，不能在该编译单元之外引用。因此，不可能有名称冲突。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-09-18T14:43:35.310

在“全局和静态”区域:)

C++中有几个内存区域：

*   堆
*   免费商店
*   堆
*   全局和静态
*   常量

有关您的问题的详细答案，请参见[此处：](http://www.gotw.ca/gotw/009.htm)

> 下面总结了 C++ 程序的主要不同内存区域。请注意，某些名称（例如，“堆”）在草案 [标准] 中并未出现。

```
 Memory Area     Characteristics and Object Lifetimes
     --------------  ------------------------------------------------

     Const Data      The const data area stores string literals and
                     other data whose values are known at compile
                     time.  No objects of class type can exist in
                     this area.  All data in this area is available
                     during the entire lifetime of the program.

                     Further, all of this data is read-only, and the
                     results of trying to modify it are undefined.
                     This is in part because even the underlying
                     storage format is subject to arbitrary
                     optimization by the implementation.  For
                     example, a particular compiler may store string
                     literals in overlapping objects if it wants to.

     Stack           The stack stores automatic variables. Typically
                     allocation is much faster than for dynamic
                     storage (heap or free store) because a memory
                     allocation involves only pointer increment
                     rather than more complex management.  Objects
                     are constructed immediately after memory is
                     allocated and destroyed immediately before
                     memory is deallocated, so there is no
                     opportunity for programmers to directly
                     manipulate allocated but uninitialized stack
                     space (barring willful tampering using explicit
                     dtors and placement new).

     Free Store      The free store is one of the two dynamic memory
                     areas, allocated/freed by new/delete.  Object
                     lifetime can be less than the time the storage
                     is allocated; that is, free store objects can
                     have memory allocated without being immediately
                     initialized, and can be destroyed without the
                     memory being immediately deallocated.  During
                     the period when the storage is allocated but
                     outside the object's lifetime, the storage may
                     be accessed and manipulated through a void* but
                     none of the proto-object's nonstatic members or
                     member functions may be accessed, have their
                     addresses taken, or be otherwise manipulated.

     Heap            The heap is the other dynamic memory area,
                     allocated/freed by malloc/free and their
                     variants.  Note that while the default global
                     new and delete might be implemented in terms of
                     malloc and free by a particular compiler, the
                     heap is not the same as free store and memory
                     allocated in one area cannot be safely
                     deallocated in the other. Memory allocated from
                     the heap can be used for objects of class type
                     by placement-new construction and explicit
                     destruction.  If so used, the notes about free
                     store object lifetime apply similarly here.

     Global/Static   Global or static variables and objects have
                     their storage allocated at program startup, but
                     may not be initialized until after the program
                     has begun executing.  For instance, a static
                     variable in a function is initialized only the
                     first time program execution passes through its
                     definition.  The order of initialization of
                     global variables across translation units is not
                     defined, and special care is needed to manage
                     dependencies between global objects (including
                     class statics).  As always, uninitialized proto-
                     objects' storage may be accessed and manipulated
                     through a void* but no nonstatic members or
                     member functions may be used or referenced
                     outside the object's actual lifetime. 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2015-06-04T10:59:44.690

**如何自己找到它`objdump -Sr`**

要真正了解发生了什么，您必须了解链接器重定位。如果您从未接触过，请考虑[先阅读这篇文章](https://stackoverflow.com/a/30507725/895245)。

让我们分析一个 Linux x86-64 ELF 示例来自己看看：

```
#include <stdio.h>

int f() {
    static int i = 1;
    i++;
    return i;
}

int main() {
    printf("%d\n", f());
    printf("%d\n", f());
    return 0;
} 
```

编译：

```
gcc -ggdb -c main.c 
```

反编译代码：

```
objdump -Sr main.o 
```

*   `-S`反编译混合了原始源代码的代码
*   `-r`显示搬迁信息

在反编译里面`f`我们看到：

```
 static int i = 1;
 i++;
4:  8b 05 00 00 00 00       mov    0x0(%rip),%eax        # a <f+0xa>
        6: R_X86_64_PC32    .data-0x4 
```

并且`.data-0x4`说它将转到该`.data`段的第一个字节。

`-0x4`存在是因为我们使用的是 RIP 相对寻址，因此`%rip`在指令中和`R_X86_64_PC32`.

这是必需的，因为 RIP 指向*以下*指令，该指令开始 4 个字节，之后`00 00 00 00`将被重定位。我已在以下位置更详细地解释了这一点：[https ://stackoverflow.com/a/30515926/895245](https://stackoverflow.com/a/30515926/895245)

然后，如果我们将源代码修改为`i = 1`并进行相同的分析，我们得出的结论是：

*   `static int i = 0`继续`.bss`
*   `static int i = 1`继续`.data`

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-09-18T14:35:36.310

我不相信会有碰撞。在文件级别（外部函数）使用 static 将变量标记为当前编译单元（文件）的本地变量。它在当前文件之外永远不可见，因此不必有一个可以在外部使用的名称。

*在函数内部*使用 static是不同的 - 变量仅对函数可见（无论是否静态），它只是在调用该函数时保留其值。

实际上，静态根据它的位置做了两件不同的事情。然而，在*这两种*情况下，变量的可见性都受到限制，因此您可以在链接时轻松防止命名空间冲突。

话虽如此，我相信它将存储在该`DATA`部分中，该部分往往具有初始化为非零值的变量。当然，这是一个实现细节，而不是标准规定的东西——它只关心*行为，*而不关心事情是如何在幕后完成的。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2018-03-12T11:24:52.410

这是如何（容易理解）：

[![堆栈、堆和静态数据](https://bayanbox.ir/view/581244719208138556/virtual-memory.jpg)](https://bayanbox.ir/view/581244719208138556/virtual-memory.jpg)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-09-18T14:33:42.010

这取决于您使用的平台和编译器。一些编译器直接存储在代码段中。静态变量始终只能由当前翻译单元访问，并且名称不会被导出，因此不会发生名称冲突。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-09-18T20:27:31.567

在编译单元中声明的数据将进入 .BSS 或该文件输出的 .Data。BSS 中的初始化数据，DATA 中未初始化的数据。

静态数据和全局数据之间的区别在于文件中包含符号信息。编译器倾向于包含符号信息，但只标记全局信息。

链接器尊重此信息。静态变量的符号信息要么被丢弃，要么被破坏，以便仍然可以以某种方式引用静态变量（使用调试或符号选项）。在这两种情况下，编译单元都不会受到影响，因为链接器首先解析本地引用。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-10-13T17:43:41.033

我用 objdump 和 gdb 试了一下，结果如下：

```
(gdb) disas fooTest
Dump of assembler code for function fooTest:
   0x000000000040052d <+0>: push   %rbp
   0x000000000040052e <+1>: mov    %rsp,%rbp
   0x0000000000400531 <+4>: mov    0x200b09(%rip),%eax        # 0x601040 <foo>
   0x0000000000400537 <+10>:    add    $0x1,%eax
   0x000000000040053a <+13>:    mov    %eax,0x200b00(%rip)        # 0x601040 <foo>
   0x0000000000400540 <+19>:    mov    0x200afe(%rip),%eax        # 0x601044 <bar.2180>
   0x0000000000400546 <+25>:    add    $0x1,%eax
   0x0000000000400549 <+28>:    mov    %eax,0x200af5(%rip)        # 0x601044 <bar.2180>
   0x000000000040054f <+34>:    mov    0x200aef(%rip),%edx        # 0x601044 <bar.2180>
   0x0000000000400555 <+40>:    mov    0x200ae5(%rip),%eax        # 0x601040 <foo>
   0x000000000040055b <+46>:    mov    %eax,%esi
   0x000000000040055d <+48>:    mov    $0x400654,%edi
   0x0000000000400562 <+53>:    mov    $0x0,%eax
   0x0000000000400567 <+58>:    callq  0x400410 <printf@plt>
   0x000000000040056c <+63>:    pop    %rbp
   0x000000000040056d <+64>:    retq   
End of assembler dump.

(gdb) disas barTest
Dump of assembler code for function barTest:
   0x000000000040056e <+0>: push   %rbp
   0x000000000040056f <+1>: mov    %rsp,%rbp
   0x0000000000400572 <+4>: mov    0x200ad0(%rip),%eax        # 0x601048 <foo>
   0x0000000000400578 <+10>:    add    $0x1,%eax
   0x000000000040057b <+13>:    mov    %eax,0x200ac7(%rip)        # 0x601048 <foo>
   0x0000000000400581 <+19>:    mov    0x200ac5(%rip),%eax        # 0x60104c <bar.2180>
   0x0000000000400587 <+25>:    add    $0x1,%eax
   0x000000000040058a <+28>:    mov    %eax,0x200abc(%rip)        # 0x60104c <bar.2180>
   0x0000000000400590 <+34>:    mov    0x200ab6(%rip),%edx        # 0x60104c <bar.2180>
   0x0000000000400596 <+40>:    mov    0x200aac(%rip),%eax        # 0x601048 <foo>
   0x000000000040059c <+46>:    mov    %eax,%esi
   0x000000000040059e <+48>:    mov    $0x40065c,%edi
   0x00000000004005a3 <+53>:    mov    $0x0,%eax
   0x00000000004005a8 <+58>:    callq  0x400410 <printf@plt>
   0x00000000004005ad <+63>:    pop    %rbp
   0x00000000004005ae <+64>:    retq   
End of assembler dump. 
```

这是 objdump 结果

```
Disassembly of section .data:

0000000000601030 <__data_start>:
    ...

0000000000601038 <__dso_handle>:
    ...

0000000000601040 <foo>:
  601040:   01 00                   add    %eax,(%rax)
    ...

0000000000601044 <bar.2180>:
  601044:   02 00                   add    (%rax),%al
    ...

0000000000601048 <foo>:
  601048:   0a 00                   or     (%rax),%al
    ...

000000000060104c <bar.2180>:
  60104c:   14 00                   adc    $0x0,%al 
```

所以，也就是说，你的四个变量位于数据节事件中，同名，但偏移量不同。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-18T15:00:20.620

如前所述，静态变量存储在数据段或代码段中。
您可以确定它不会在堆栈或堆上分配。
没有冲突的风险，因为`static`关键字将变量的范围定义为文件或函数，如果发生冲突，有一个编译器/链接器会警告您。
一个很好的[例子](http://faq.zanvar.in/storage-of-static-variable/)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-18T14:34:37.827

答案很可能取决于编译器，因此您可能想要编辑您的问题（我的意思是，即使是段的概念也不是 ISO C 或 ISO C++ 强制要求的）。例如，在 Windows 上，可执行文件不带有符号名称。一个“foo”的偏移量为 0x100，另一个可能为 0x2B0，两个翻译单元的代码在编译时都知道“它们的”foo 的偏移量。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-03-20T21:12:06.387

那么这个问题有点太老了，但是因为没有人指出任何有用的信息：检查'mohit12379'的帖子，解释符号表中具有相同名称的静态变量的存储： [http ://www.geekinterview.com/question_details/ 24745](http://www.geekinterview.com/question_details/24745)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T14:38:53.323

它们都将独立存储，但是如果您想向其他开发人员说明，您可能希望将它们包装在命名空间中。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2014-06-30T07:28:31.803

您已经知道它存储在 bss 中（按符号开头的块）也称为未初始化数据段或已初始化数据段。

让我们举一个简单的例子

```
void main(void)
{
static int i;
} 
```

上面的静态变量没有初始化，所以它进入了未初始化的数据段（bss）。

```
void main(void)
{
static int i=10;
} 
```

当然它初始化了 10 所以它进入了初始化的数据段。

# mono - 如何确定我刚刚在 gtk# 中单击的选项卡的页码？

> ID：93044
> 
> 赞同：2
> 
> 时间：2008-09-18T14:29:22.893
> 
> 标签：mono, gtk, gtk#

我有一个带有多个标签的 GTK 笔记本。每个选项卡标签都是一个复合容器，其中包含一个我想用来关闭选项卡的按钮。该按钮具有“单击”信号的处理程序。

调用信号时，我将按钮小部件和“EventArgs”作为参数。

我需要根据按钮小部件确定页码，但 myNotebook.PageNum(buttonWidget) 总是返回-1。我什至尝试过 buttonWidget.Parent ，它是包含小部件的 HBox。

关于我能做什么或我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T16:09:57.380

一种简单的解决方法是在构建按钮时将页码传递给按钮的 Clicked 事件。

```
for (int page = 0; page < n; page++){ 
    int the_page = page;
    NotebookPage p = new NotebookPage ();
    ...
    Button b = new Button ("Close page {0}", the_page);
    b.Clicked += delegate { 
        Console.WriteLine ("Page={0}", the_page); 
    };
} 
```

“the_page”很重要，因为它是一个将被委托捕获的新变量。

# java - Java 6 在 JDK、JVM 或两者中的性能改进了吗？

> ID：93049
> 
> 赞同：3
> 
> 时间：2008-09-18T14:30:01.690
> 
> 标签：java, performance, comparison, benchmarking, versions

我一直想知道 Java SE 6 中吹捧的性能改进——是在编译器还是运行时？换句话说，由 JDK 6 编译的 Java 5 应用程序是否会在 JSE 5 下看到改进（表明改进的编译器优化）？由 JDK 5 编译的 Java 5 应用程序是否会在 JSE 6 下看到改进（表明改进的运行时优化）？

我注意到对于完全相同的代码库，在 JDK 6 下编译所需的时间几乎是在 JDK 5 下编译的两倍；我希望至少有一些额外的时间花在编译器优化上，希望能带来更高性能的 JAR 和 WAR。Sun 的 JDK 信息并没有真正详细说明他们所做的性能改进——我认为 A 列有一点点，B 列有一点点，但我想知道哪个影响更大。有谁知道在 JDK 6 与 JDK 5 上进行的任何基准测试？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T14:40:49.107

从 Java 源代码编译为字节码的 javac 几乎不做任何优化。实际上，优化通常会使代码实际上运行得更慢，因为更难分析以供以后优化。

为 1.5 和 1.6 生成的代码之间唯一显着的区别是，使用 -target 1.6 添加了有关堆栈状态的额外信息，以使验证更容易和更快（Java ME 也这样做）。这只会影响类加载速度。

真正的优化部分是将字节码编译为本机代码的热点编译器。这甚至在某些更新版本上进行了更新。在 Windows 上，只有较慢的客户端 C1 版本的热点默认分布在 JRE 中。服务器 C2 热点运行速度更快（在 java 命令行上使用 -server），但启动速度较慢并且使用更多内存。

库和工具（包括 javac）有时也会完成优化工作。

我不知道您为什么发现 JDK 6 编译代码比 JDK 5 慢。设置是否有一些细微差别？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T14:38:26.400

我没有听说过编译器的改进，但是关于运行时性能改进的大量信息已经发布。

**迁移指南：**

[http://java.sun.com/javase/6/webnotes/adoption/adoptionguide.html](http://java.sun.com/javase/6/webnotes/adoption/adoptionguide.html)

**性能白皮书：**

[https://www.oracle.com/java/technologies/javase/6performance.html](https://www.oracle.com/java/technologies/javase/6performance.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T14:34:12.510

它几乎是 100% 的运行时间。虽然可以将一些基本的编译技巧融入 Java 编译器本身，但我认为 Java 1.5 和 1.6 之间没有任何重大改进。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T14:38:12.390

新的 java 虚拟机有很多新的改进和优化。因此，您将看到性能提升的主要部分是在使用版本 6 jvm 运行 java 时。

使用 Java 6 JDK 编译旧的 Java 代码可能会产生更高效的代码，但主要的改进在于虚拟机，至少我注意到了这一点。

# silverlight - Silverlight 应用程序和 iframe 在同一页面上共存

> ID：93056
> 
> 赞同：1
> 
> 时间：2008-09-18T14:31:12.937
> 
> 标签：silverlight, iframe

这应该很简单...有人可以给我提供一个简单的代码示例，它有一个 aspx 页面，它同时托管一个 silverlight 应用程序（例如一个按钮）和一个 iframe（指向例如 stackoverflow.com）。Silverlight 应用程序和 iframe 可以位于不同的 div 中，也可以位于同一个 div 中。

到目前为止，我尝试过的所有操作都给我留下了一个没有呈现 Silverlight 控件的页面。

编辑：应我的 xaml 外观的要求（另外我应该指出，如果我注释掉 iframe，我的控件呈现得很好。）

```
<UserControl x:Class="SilverlightApplication1.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">   

    <Grid x:Name="LayoutRoot" Background="Pink">
        <Button Content="Click Me!"/>
    </Grid>
</UserControl> 
```

而已。只是为了更好地衡量这里是我的aspx页面......

```
<form id="form1" runat="server">

         <asp:ScriptManager ID="ScriptManager1" runat="server"/>
        <div  style="height:100%;">            
            <asp:Silverlight ID="Silverlight1" runat="server" Source="~/ClientBin/SilverlightApplication1.xap"    MinimumVersion="2.0.30523" Width="400" Height="400" />        
        </div>        

        <iframe src ="http://www.google.com" width="400"/>

    </form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T15:35:23.017

嗯，听起来有点奇怪，一个快速的谷歌给了我[这个顶级结果](http://silverlight.net/forums/p/21584/75457.aspx)，它谈到在同一页面上使用 iframe 和 Silverlight，没有问题。

还可以使用以下代码进行快速测试：

```
<%@ Page Language="C#" AutoEventWireup="true" %>

<%@ Register Assembly="System.Web.Silverlight" Namespace="System.Web.UI.SilverlightControls"
    TagPrefix="asp" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" style="height:100%;">
<head runat="server">
    <title>Test Page</title>
</head>
<body style="height:100%;margin:0;">
    <form id="form1" runat="server" style="height:100%;">
        <asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
        <div  style="height:100%;">
            <asp:Silverlight ID="Xaml1" runat="server" Source="~/ClientBin/Test.xap" MinimumVersion="2.0.30523" Width="400" Height="400" />
        </div>
        <iframe src ="http://www.google.com" width="400"></iframe>
    </form>
</body>
</html> 
```

非常愉快地渲染 Silverlight 和 iframe。

您在尝试时使用了什么代码，但它不起作用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T16:19:33.677

您的 XAML 是什么样的？

它可能类似于 XAML 中用户控件上设置的大小，与 aspx 页面上插件上设置的大小不匹配。在这种情况下，您的按钮可能存在但不在可视区域中......尝试检查事物的大小，确保它们匹配。

您可以做的一个快速测试是更改 XAML 中根元素的背景颜色，并查看页面上是否发生任何事情。

此外，如果您删除 iframe 但保留其他所有内容，silverlight 是否有效？

抱歉，如果这是一个过于简单的建议，但不知道您对 XAML 的经验水平...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T11:07:36.770

有趣的是，我刚刚通过确保按像素指定 iframe 尺寸来解决了这个问题。

# macos - Emacs，切换到另一个框架（Mac OS X）

> ID：93058
> 
> 赞同：31
> 
> 时间：2008-09-18T14:31:31.203
> 
> 标签：macos, emacs

我可以用“Cx o”在窗口之间切换，但是如果我打开了多个框架，我也可以在没有鼠标的情况下在它们之间移动吗？

我刚刚意识到，如果没有这个细节，这个问题可能听起来很脑残：我使用的是 Mac OS X（芬兰语键盘），并且在同一应用程序的窗口之间切换很困难。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-09-18T14:36:56.463

如果您想要一个以 Emacs 为中心的方法，请尝试 Cx 5 o。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-09-09T16:23:47.910

把它放在你的 .emacs 中

(global-set-key "\M-`" '其他框架)

然后你可以用 Command-` 在 emacs 帧之间切换。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-18T14:44:54.480

我使用 Mx next-multiframe-window （当然绑定到一个键）。恕我直言，比 Mx 其他框架（Cx 5 o）更好。

next-multiframe-window 步骤遍历每一帧的窗口。其他框架切换只是通过框架（如 ALT-TAB）

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-02-25T20:45:11.633

我最近[在 SuperUser 上回答了一个类似的问题](https://superuser.com/questions/104456/quickly-navigating-emacs-buffers-on-a-dual-display-setup/111169#111169)。有一个名为 的新包[`framemove.el`](http://www.emacswiki.org/emacs/framemove.el)，它允许您使用箭头键（使用前缀键，如`shift`or `meta`）轻松切换帧。

安装：

```
(require 'framemove)
(framemove-default-keybindings) ;; default prefix is Meta 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T14:37:37.727

从[手册](http://www.gnu.org/software/emacs/manual/html_node/emacs/Frame-Commands.html)中，答案是“Cx 5 o”（但请阅读 and - about variable *focus-follows-mouse*处的细则）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T14:36:05.560

我相信您可以像在应用程序之间切换一样在帧之间切换。

在 Windows 上我使用 Alt-TAB，在 Unix 上我的机器设置为使用 Ctrl-Alt-TAB

# .net - VS内置单元测试

> ID：93060
> 
> 赞同：0
> 
> 时间：2008-09-18T14:31:36.307
> 
> 标签：.net, unit-testing

我正在寻找有关 VS08 中提供的内置单元测试功能的建议。任何人都可以告诉我他们是否知道任何理由不使用此功能而不是任何其他可用的软件包（我对 NUnit 隐约熟悉）？

我计划将单元测试应用于一个较旧的项目，只是为了了解单元测试的技巧和 .NET 3.5 框架中的一些新功能。我喜欢内置功能的外观，因为从我运行的快速演示来看，它似乎非常易于使用，而且我通常发现 Microsoft 文档非常有用。

如果任何熟悉此功能的人能提醒我任何我应该注意的问题或任何避免这种情况转而支持另一个软件包的原因，我将非常感激。

注意：我已经尝试通过这个（优秀的）站点搜索特定于 VS 内置单元测试功能的详细信息。已经[提到](https://stackoverflow.com/questions/709/net-testing-framework-advice)过几次，但我无法完全匹配，但如果在其他地方得到了回答，请接受我的歉意。

谢谢你，埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T14:37:32.610

It looks like the discussion [here](https://stackoverflow.com/questions/92869/nunit-vs-visual-studio-2008s-test-projects-for-unit-testing) can answer your question.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T14:35:56.873

The syntax can be a little clumsy, but if you're only trying to get to grips with unit testing, then there will be no harm in using the built-in stuff

# ruby-on-rails - 版本化的 rails db 和不同

> ID：93063
> 
> 赞同：2
> 
> 时间：2008-09-18T14:31:50.407
> 
> 标签：ruby-on-rails, ruby, database, diff

我想知道是否有一个集成的解决方案来拥有一个带有 Rails 支持的版本化记录的数据库（ala version_fu ar_versioned），谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T21:22:26.977

查看[acts_as_versioned](http://wiki.rubyonrails.org/rails/pages/ActsAsVersioned)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T18:16:57.920

感谢 srboisvert 提到我的叉子。这是更多信息/上下文。为每个版本设置了 updated_attributes 列的值，并列出了从先前版本更改的属性。当您需要显示记录/版本并希望显示更改的值时，这很有用。我需要它来为我们拥有的特定记录实现历史视图，我们希望在历史中显示的每个版本中将任何更改的值涂成红色。这在我上面链接的博客文章中进行了介绍，以及其他一些小的调整。

如果有人进一步调整它，请向我发送拉取请求等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T13:14:58.467

有一个[作为版本化](http://codeintensity.blogspot.com/2008/07/fork-of-actsasversioned-to-provide.html)(ar-versioned) 的分支版本，它在版本化表 (updated-attributes) 中包含一个附加列，该列是已更改内容的哈希。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T16:40:22.877

如您所述，插件支持该功能，Rails 核心不支持该功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T05:39:54.590

我最终使用`acts_as_audited`与`htmldiff`插件一起完成此操作以获得一些漂亮的输出。

请参阅：[区分 ruby​​ 字符串或数组](https://stackoverflow.com/questions/80091/diff-a-ruby-string-or-array/739161#739161)

# c++ - 如何在 C++ 中实现线程安全引用计数

> ID：93073
> 
> 赞同：19
> 
> 时间：2008-09-18T14:33:15.037
> 
> 标签：c++, multithreading, atomic, reference-counting

如何使用 C++ 编程语言在 X86 CPU 上实现**高效且线程安全的引用计数系统？**

我总是遇到**关键操作不是原子**的问题，可用的 X86 互锁操作不足以实现引用计数系统。

以下文章涵盖了该主题，但需要特殊的 CPU 指令：

[http://www.ddj.com/architect/184401888](http://www.ddj.com/architect/184401888)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T14:37:07.697

现在，您可以使用 Boost/TR1 shared_ptr<> 智能指针来保持您的引用计数引用。

效果很好；没有大惊小怪，没有混乱。shared_ptr<> 类负责 refcount 所需的所有锁定。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T14:38:25.523

在 VC++ 中，您可以使用[_InterlockedCompareExchange](http://msdn.microsoft.com/en-us/library/ttk2z1ws.aspx)。

```
do
   read the count
   perform mathematical operation
   interlockedcompareexchange( destination, updated count, old count)
until the interlockedcompareexchange returns the success code. 
```

在其他平台/编译器上，为 MS 的 _InterlockedCompareExchange 公开的 LOCK CMPXCHG 指令使用适当的内在函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T14:38:06.930

严格来说，您需要等到 C++0x 才能使用纯 C++ 编写线程安全代码。

目前，您可以使用 Posix，或者围绕比较和交换和/或互锁递增/递减创建自己的平台独立包装器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T11:04:33.000

Win32 InterlockedIncrementAcquire 和 InterlockedDecrementRelease（如果您想安全并关心可能重新排序的平台，因此您需要同时发出内存屏障）或 InterlockedIncrement 和 InterlockedDecrement（如果您确定将保留 x86），是原子的并且将做这项工作。

也就是说，Boost/TR1 shared_ptr<> 将为您处理所有这些，因此除非您需要自己实现它，否则您可能会尽力坚持下去。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-08T11:38:15.410

请记住，锁定非常昂贵，并且每次您在智能指针之间传递对象时都会发生这种情况 - 即使对象当前由一个线程拥有（智能指针库不知道这一点）。

鉴于此，这里可能有一个适用的经验法则（我很高兴得到纠正！）

如果以下情况适用于您：

*   您有复杂的数据结构，很难为其编写析构函数（或者 STL 样式的值语义在设计上不合适），因此您需要智能指针来为您完成它，并且
*   您正在使用共享这些对象的多个线程，并且
*   您关心性能和正确性

...那么实际的垃圾收集可能是更好的选择。尽管 GC 在性能方面名声不佳，但这都是相对的。我相信它与锁定智能指针相比非常有利。这是 CLR 团队选择真正的 GC 而不是使用引用计数的重要原因。请参阅[这篇文章](http://blogs.msdn.com/brada/articles/371015.aspx)，特别是如果您继续计算引用分配意味着什么的鲜明比较：

**没有参考计数：**

```
a = b; 
```

**参考计数：**

```
if (a != null)
    if (InterlockedDecrement(ref a.m_ref) == 0)
            a.FinalRelease();

if (b != null)
    InterlockedIncrement(ref b.m_ref);

a = b; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T14:47:35.470

如果指令本身不是原子的，那么您需要将更新相应变量的代码部分设为临界区。

**即**，您需要通过使用某种锁定方案来防止其他线程进入该代码段。当然，锁需要是原子的，但是您可以在 pthread_mutex 类中找到原子锁定机制。

效率问题：pthread 库尽可能高效，并且仍然保证互斥锁对于您的操作系统是原子的。

贵吗：可能。但是对于需要保证的一切，都是有代价的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T22:44:28.707

该 ddj 文章中发布的特定代码增加了额外的复杂性，以解决使用智能指针的错误。

具体来说，如果你不能保证智能指针在分配给另一个智能指针时不会改变，那么你做错了，或者一开始做的事情非常不可靠。如果智能指针在分配给另一个智能指针时可以更改，这意味着执行分配的代码不拥有智能指针，这很可疑。

# physics - 斯诺克比赛的物理学

> ID：93085
> 
> 赞同：6
> 
> 时间：2008-09-18T14:34:07.767
> 
> 标签：physics

任何人都可以向我指出有关斯诺克比赛物理的任何信息，如果可能的话，更多关于球碰撞的信息？我想做一个游戏，我需要一些物理方面的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T14:41:49.870

网上有一本书讲的，

Ron Shepard 的“[业余台球运动员的业余物理学](http://web.cecs.pdx.edu/~howe/poolphysics.pdf)”（PDF 链接）

我还没有读过它，但我听说它对游戏开发者有好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T14:43:20.910

Carom3D 是一个伟大的，他们似乎已经掌握了物理学。有关更多信息，请参阅这些链接：

[http://www.jimloy.com/billiard/phys.htm](http://www.jimloy.com/billiard/phys.htm) [http://archive.ncsa.uiuc.edu/Classes/MATH198/townsend/math.html](http://archive.ncsa.uiuc.edu/Classes/MATH198/townsend/math.html) [http://www2.swgc.mun.ca/physics/ physlets/billiards.html](http://www2.swgc.mun.ca/physics/physlets/billiards.html) [http://www.regispetit.com/bil_praa.htm](http://www.regispetit.com/bil_praa.htm)

祝你好运！

# java - 为什么字符串在 Java 和 .NET 中不能是可变的？

> ID：93091
> 
> 赞同：200
> 
> 时间：2008-09-18T14:34:33.083
> 
> 标签：java, .net, string, mutable

为什么他们决定`String`在 Java 和 .NET（以及其他一些语言）中实现不可变？他们为什么不让它可变呢？

* * *

## 回答 #1

> 赞同：212
> 
> 时间：2008-09-18T14:46:15.210

根据[Effective Java](http://www.oracle.com/technetwork/java/effectivejava-136174.html)，第 4 章，第 73 页，第 2 版：

> “这有很多很好的理由：不可变类比可变类更容易设计、实现和使用。它们更不容易出错并且更安全。
> 
> [...]
> 
> "**不可变对象很简单。**一个不可变对象可以只处于一种状态，即创建它的状态。如果您确保所有构造函数都建立类不变量，那么可以保证这些不变量将始终保持正确，并且没有你的努力。
> 
> [...]
> 
> **不可变对象本质上是线程安全的；它们不需要同步。**它们不会被同时访问它们的多个线程破坏。这无疑是实现线程安全的最简单方法。事实上，没有线程可以观察到另一个线程对不可变对象的任何影响。因此， **不可变对象可以自由共享**
> 
> [...]

同一章的其他小点：

> 您不仅可以共享不可变对象，还可以共享它们的内部结构。
> 
> [...]
> 
> 不可变对象为其他对象（无论是可变的还是不可变的）提供了很好的构建块。
> 
> [...]
> 
> 不可变类唯一真正的缺点是它们需要为每个不同的值使用单独的对象。

* * *

## 回答 #2

> 赞同：103
> 
> 时间：2008-09-18T14:38:55.803

至少有两个原因。

**首先 - 安全** [http://www.javafaq.nu/java-article1060.html](http://www.javafaq.nu/java-article1060.html)

> String 不可变的主要原因是安全性。看这个例子：我们有一个带有登录检查的文件打开方法。我们将一个字符串传递给此方法以处理身份验证，这是在将调用传递给操作系统之前所必需的。如果 String 是可变的，则可以在操作系统从程序获取请求之前在身份验证检查之后以某种方式修改其内容，则可以请求任何文件。因此，如果您有权在用户目录中打开文本文件，但是当您设法更改文件名时，您可以请求打开“passwd”文件或任何其他文件。然后可以修改文件并且可以直接登录到操作系统。

**第二 - 内存效率** [http://hikrish.blogspot.com/2006/07/why-string-class-is-immutable.html](http://hikrish.blogspot.com/2006/07/why-string-class-is-immutable.html)

> JVM 内部维护着“字符串池”。为了达到内存效率，JVM 将从池中引用 String 对象。它不会创建新的 String 对象。因此，每当您创建一个新的字符串文字时，JVM 都会在池中检查它是否已经存在。如果池中已经存在，只需提供对同一对象的引用或在池中创建新对象。会有很多引用指向同一个String对象，如果有人改变了值，就会影响所有的引用。所以，sun 决定让它不可变。

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2009-03-21T03:27:53.713

实际上，字符串在java中不可变的原因与安全性没有太大关系。主要原因有以下两个：

## 头部安全：

字符串是极其广泛使用的对象类型。因此，它或多或少地保证在多线程环境中使用。字符串是不可变的，以确保在线程之间共享字符串是安全的。拥有一个不可变的字符串可确保在将字符串从线程 A 传递到另一个线程 B 时，线程 B 不会意外地修改线程 A 的字符串。

这不仅有助于简化已经相当复杂的多线程编程任务，而且还有助于提高多线程应用程序的性能。当可以从多个线程访问可变对象时，必须以某种方式同步对可变对象的访问，以确保一个线程在另一个线程修改对象时不会尝试读取对象的值。对于程序员来说，正确的同步既很难正确完成，而且在运行时代价高昂。不可变对象无法修改，因此不需要同步。

## 表现：

虽然已经提到了字符串实习，但它仅代表 Java 程序的内存效率的一小部分增益。只有字符串文字被实习。这意味着只有*源代码*中相同的字符串才会共享相同的字符串对象。如果您的程序动态创建相同的字符串，它们将在不同的对象中表示。

更重要的是，不可变字符串允许它们共享内部数据。对于许多字符串操作，这意味着不需要复制底层字符数组。例如，假设您要取 String 的前五个字符。在 Java 中，您将调用 myString.substring(0,5)。在这种情况下，substring() 方法所做的只是创建一个新的 String 对象，该对象共享 myString 的底层 char[]，但谁知道它从索引 0 开始，到该 char[] 的索引 5 结束。要将其以图形形式显示，您最终会得到以下内容：

```
 |               myString                  |
 v                                         v
"The quick brown fox jumps over the lazy dog"   <-- shared char[]
 ^   ^
 |   |  myString.substring(0,5) 
```

这使得这种操作非常便宜，并且 O(1) 因为操作既不依赖于原始字符串的长度，也不依赖于我们需要提取的子字符串的长度。这种行为也有一些内存好处，因为许多字符串可以共享它们的底层 char[]。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2008-09-18T14:41:27.920

线程安全和性能。如果无法修改字符串，则在多个线程之间传递引用是安全且快速的。如果字符串是可变的，您将始终必须将字符串的所有字节复制到新实例，或提供同步。每次需要修改字符串时，典型的应用程序都会读取该字符串 100 次。[请参阅关于不变性](http://en.wikipedia.org/wiki/Immutable_object)的维基百科。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-02-06T12:33:01.680

真的应该问，“为什么 X 应该是可变的？” 最好默认为不变性，因为[Fluff 公主](https://stackoverflow.com/questions/93091/why-cant-string-be-not-immutable-in-java-and-net/93216#93216)已经提到了好处。某些东西是可变的应该是一个例外。

不幸的是，当前大多数编程语言都默认为可变性，但希望将来默认更多的是不可变性（请参阅[下一个主流编程语言的愿望清单](http://blog.objectmentor.com/articles/2008/12/29/a-wish-list-for-the-next-mainstream-programming-language)）。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-18T15:01:55.047

`String`不是原始类型，但您通常希望将它与值语义一起使用，即像值一样。

价值是你可以相信不会在你背后改变的东西。如果你写：`String str = someExpr();` 你不希望它改变，除非你用`str`.

`String`由于 an`Object`具有自然的指针语义，因此要获得值语义，它也需要是不可变的。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-03-27T20:47:59.017

哇！我不能相信这里的错误信息。`String`s 是不可变的，没有任何安全性。如果某人已经可以访问正在运行的应用程序中的对象（如果您试图防止有人`String`在您的应用程序中“入侵”a，则必须假设这一点），那么他们肯定会有很多其他可用于黑客攻击的机会。

`String`不变性正在解决线程问题，这是一个非常新颖的想法。嗯...我有一个对象正在被两个不同的线程更改。我该如何解决这个问题？同步访问对象？Naawww ...我们不要让任何人更改对象——这将解决我们所有混乱的并发问题！事实上，让我们让所有对象不可变，然后我们可以从 Java 语言中删除同步结构。

真正的原因（上面其他人指出）是内存优化。在任何应用程序中重复使用相同的字符串文字是很常见的。事实上，它是如此普遍，以至于几十年前，许多编译器都对只存储一个`String`文字实例进行了优化。这种优化的缺点是修改`String`文字的运行时代码会引入问题，因为它正在修改共享它的所有其他代码的实例。例如，应用程序中某处的函数将`String`文字更改`"dog"`为`"cat"`. A`printf("dog")`将导致`"cat"`被写入标准输出。出于这个原因，需要有一种方法来防范试图更改的代码`String`文字（即，使它们不可变）。一些编译器（在操作系统的支持下）会通过将`String`文字放入特殊的只读内存段来完成此操作，如果进行写入尝试，则会导致内存错误。

在 Java 中，这称为实习。这里的 Java 编译器只是遵循编译器几十年来所做的标准内存优化。并且为了解决在运行时修改这些`String`文字的相同问题，Java 只是使`String`类不可变（即，不给您提供允许您更改`String`内容的设置器）。如果没有发生文字`String`的实习， s 就不必是不可变的。`String`

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-09-18T14:41:41.040

一个因素是，如果`String`s 是可变的，则存储`String`s 的对象必须小心存储副本，以免它们的内部数据在没有通知的情况下发生更改。鉴于`String`s 是一种相当原始的类型，例如数字，如果可以将它们视为按值传递，即使它们是通过引用传递（这也有助于节省内存），这很好。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2015-03-06T22:31:31.323

我知道这是一个颠簸，但是... 它们真的是一成不变的吗？考虑以下。

```
public static unsafe void MutableReplaceIndex(string s, char c, int i)
{
    fixed (char* ptr = s)
    {
        *((char*)(ptr + i)) = c;
    }
} 
```

...

```
string s = "abc";
MutableReplaceIndex(s, '1', 0);
MutableReplaceIndex(s, '2', 1);
MutableReplaceIndex(s, '3', 2);
Console.WriteLine(s); // Prints 1 2 3 
```

你甚至可以使它成为一种扩展方法。

```
public static class Extensions
{
    public static unsafe void MutableReplaceIndex(this string s, char c, int i)
    {
        fixed (char* ptr = s)
        {
            *((char*)(ptr + i)) = c;
        }
    }
} 
```

这使得以下工作

```
s.MutableReplaceIndex('1', 0);
s.MutableReplaceIndex('2', 1);
s.MutableReplaceIndex('3', 2); 
```

结论：它们处于编译器已知的不可变状态。当然，上述内容仅适用于 .NET 字符串，因为 Java 没有指针。然而，使用 C# 中的指针，字符串可以完全可变。这不是指针的用途、实际用途或安全使用方式；然而，这是可能的，从而弯曲了整个“可变”规则。您通常不能直接修改字符串的索引，这是唯一的方法。有一种方法可以通过禁止字符串的指针实例或在指向字符串时进行复制来防止这种情况，但都没有这样做，这使得 C# 中的字符串不完全不可变。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-08T06:37:05.137

对于大多数目的，“字符串”是（使用/视为/认为/假设是）一个有意义的**原子单位，** *就像一个数字*。

## 因此，询问为什么字符串的各个字符不可变就像问为什么整数的各个位不可变。

你应该知道为什么。考虑一下。

我不想这么说，但不幸的是，我们正在讨论这个问题，因为我们的语言很烂，我们试图使用一个单词***string***来描述一个复杂的、上下文相关的概念或对象类别。

我们使用“字符串”执行计算和比较，类似于我们使用数字的方式。如果字符串（或整数）是可变的，我们必须编写特殊代码将它们的值锁定为不可变的局部形式，以便可靠地执行任何类型的计算。因此，最好将字符串视为数字标识符，但它可能是数百位长，而不是 16、32 或 64 位长。

当有人说“字符串”时，我们都会想到不同的东西。那些将其简单地视为一组角色而没有特定目的的人当然会感到震惊，因为有人*刚刚决定*他们不应该能够操纵这些角色。但是“字符串”类不仅仅是一个字符数组。这是一个`STRING`，不是一个`char[]`。关于我们称为“字符串”的概念有一些基本假设，通常可以将其描述为有意义的、原子的编码数据单元，如数字。当人们谈论“操纵字符串”时，也许他们真的在谈论操纵**字符**来构建**字符串**，而 StringBuilder 非常适合。

考虑一下如果字符串是可变的会是什么样子。*如果可变*用户名字符串在此函数使用时被另一个线程有意或无意地修改，则以下 API 函数可能会被欺骗返回不同用户的信息：

```
string GetPersonalInfo( string username, string password )
{
    string stored_password = DBQuery.GetPasswordFor( username );
    if (password == stored_password)
    {
        //another thread modifies the mutable 'username' string
        return DBQuery.GetPersonalInfoFor( username );
    }
} 
```

安全不仅仅是“访问控制”，它还涉及“安全”和“保证正确性”。如果一个方法不容易编写并依赖于可靠地执行简单的计算或比较，那么调用它是不安全的，但质疑编程语言本身是安全的。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-10-23T00:05:11.983

不变性与安全性并没有那么紧密的联系。为此，至少在 .NET 中，您可以获得`SecureString`该类。

稍后编辑：在 Java 中，您会发现`GuardedString`类似的实现。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-18T14:45:46.100

这是一个权衡。`String`s 进入`String`池，当您创建多个相同`String`的 s 时，它们共享相同的内存。设计者认为这种节省内存的技术在常见情况下会很好用，因为程序往往会在相同的字符串上磨合很多。

缺点是串联会产生很多额外`String`的 s，这些 s 只是过渡性的，会变成垃圾，实际上会损害内存性能。在这些情况下，您可以使用`StringBuffer`和`StringBuilder`（在 Java 中，`StringBuilder`也在 .NET 中）来保留内存。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-12-16T20:25:03.413

在 C++ 中使用可变字符串的决定会导致很多问题，请参阅 Kelvin Henney 撰写的这篇关于[Mad COW 疾病](http://www.ddj.com/cpp/184403779)的优秀文章。

COW = 写入时复制。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-03-20T14:26:43.000

`String`Java 中的 s 并不是真正不可变的，您可以使用反射和/或类加载来更改它们的值。您不应该依赖该属性来确保安全。例如，请参阅：[Java 中的魔术技巧](http://blogs.atlassian.com/developer/2008/07/magic_trick_in_java.html)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T14:47:08.873

不变性很好。请参阅有效的 Java。如果每次传递字符串时都必须复制它，那么这将是很多容易出错的代码。您还不清楚哪些修改会影响哪些引用。就像 Integer 必须是不可变的才能表现得像 int 一样，String 必须表现得像不可变的那样才能表现得像基元一样。在 C++ 中，按值传递字符串是在源代码中没有明确提及的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-11-01T23:05:04.263

几乎每条规则都有一个例外：

```
using System;
using System.Runtime.InteropServices;

namespace Guess
{
    class Program
    {
        static void Main(string[] args)
        {
            const string str = "ABC";

            Console.WriteLine(str);
            Console.WriteLine(str.GetHashCode());

            var handle = GCHandle.Alloc(str, GCHandleType.Pinned);

            try
            {
                Marshal.WriteInt16(handle.AddrOfPinnedObject(), 4, 'Z');

                Console.WriteLine(str);
                Console.WriteLine(str.GetHashCode());
            }
            finally
            {
                handle.Free();
            }
        }
    }
} 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2008-09-18T14:35:20.463

这主要是出于安全原因。如果您不能相信您`String`的 s 是防篡改的，那么保护系统的安全就会困难得多。

# .net - Windsor Container：在代码与 XML 中注册事物

> ID：93094
> 
> 赞同：4
> 
> 时间：2008-09-18T14:34:47.170
> 
> 标签：.net, inversion-of-control, castle-windsor

从我读过的关于 Windsor/Microkernel 的内容来看，理论上可以使用带有代码的 xml 文件来完成所有可以做的事情。事实上 - 如果我错了，请纠正我 - Windsor 层的主要贡献似乎是为微内核已经可以做的事情添加 xml 配置。

但是，我最近一直在努力寻找如何在代码中实现一些稍微复杂的功能（即[如何分配默认构造函数参数值](https://stackoverflow.com/questions/87812/castle-windsor-how-to-specify-a-constructor-paramter-from-code)）。现在，虽然我将在我的生产版本中使用 xml，但我正在为我的测试注册代码中的组件，这变得非常有问题。他们文档的不幸状态以及我能找到的唯一文章专注于 xml 注册这一事实无济于事。

有谁知道列出如何在代码中注册事物的来源（最好使用 xml 等价物）？撇开它的存在，有没有人知道一个开源/示例项目，其中有显着的非 xml 使用 Castle Windsor/Microkernel？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T14:56:13.593

我一直发现查看单元测试是学习如何使用开源项目的最佳方式。Castle 有一个流畅的界面，可以让你用代码做所有事情。从[WindsorDotNet2Tests](http://svn.castleproject.org:8080/svn/castle/trunk/InversionOfControl/Castle.Windsor.Tests/WindsorDotNet2Tests.cs)测试用例：

```
[Test]
    public void ParentResolverIntercetorShouldNotAffectGenericComponentInterceptor()
    {
        WindsorContainer container = new WindsorContainer();
        container.AddComponent<MyInterceptor>();

        container.Register(
            Component.For<ISpecification>()
                .ImplementedBy<MySpecification>()
                .Interceptors(new InterceptorReference(typeof(MyInterceptor)))
                .Anywhere
            );
        container.AddComponent("repos", typeof(IRepository<>), typeof(TransientRepository<>));

        ISpecification specification = container.Resolve<ISpecification>();
        bool isProxy = specification.Repository.GetType().FullName.Contains("Proxy");
        Assert.IsFalse(isProxy);
    } 
```

更多信息，请查看[ComponentRegistrationTestCase](http://svn.castleproject.org:8080/svn/castle/trunk/InversionOfControl/Castle.MicroKernel.Tests/Registration/ComponentRegistrationTestCase.cs)和[AllTypesTestCase](http://svn.castleproject.org:8080/svn/castle/trunk/InversionOfControl/Castle.MicroKernel.Tests/Registration/AllTypesTestCase.cs)

还有一个 DSL 可以做到这一点，这是我的首选，因为它确实简化了事情并提供了很多简单的可扩展性。DSL 称为 Binsor，您可以在此处阅读更多信息：[http](http://www.ayende.com/Blog/archive/7268.aspx) ://www.ayende.com/Blog/archive/7268.aspx 但同样，infor 的最佳位置是单元测试。这是使用 binsor 的代码示例：

```
for type in AllTypesBased of IController("Company.Web.Controller"):
    component type 
```

这两行将把继承 IController 接口的类型注册到容器中：D

# oop - Is Object-Oriented Modeling different from Object-Oriented Programming?

> ID：93097
> 
> 赞同：2
> 
> 时间：2008-09-18T14:35:03.067
> 
> 标签：oop

What is the difference between Object-Oriented Modeling and Object-Oriented Programming? I overheard a conversation on my subway train this morning and it seems that these things are different. Aren't they?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T15:09:43.530

建模是创建问题的抽象，而编程是这种抽象的实现。

建模可以通过多种方式完成：文本、公式、图表……UML 是建模面向对象概念的一种标准。

编程也可以以不同的方式完成，具体取决于工具、语言等。有一些方法可以直接从建模工具生成程序，通常是从 UML 模型中生成程序。这甚至更进一步，直接“执行”UML 模型。

关于面向对象编程的其他常见混淆也存在——从“这是你拖动和点击的东西”开始，到混合的第三代概念，我称之为“处理对象”到实用模式，并以纯 OOP 结束。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T14:39:56.270

Object-Oriented Modeling refers to the process where you are designing how the code will look like. You will use a modeling language like UML to do Object-Oriented Modeling. Object-Oriented Programming refers to a programming paradigm where you use objects. These objects have been designed during the desing phase using Object-Oriented Modeling techniques, and they are implemented during the construction (programming phase) using a language that supports Object-Oriented programming and based on the model.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T14:38:26.040

I'd say the modeling precludes the programing, where the modeling is the physical design, before the programming is implemented.

[http://en.wikipedia.org/wiki/Object-Oriented_Modeling](http://en.wikipedia.org/wiki/Object-Oriented_Modeling)

[http://en.wikipedia.org/wiki/Object_oriented_programming](http://en.wikipedia.org/wiki/Object_oriented_programming)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T14:40:37.703

I just found this:

> Object-oriented modeling is a formal way of representing something in the real world. It draws from traditional set theory and classification theory. object-oriented modeling is not limited to computer-related elements. One may use object-oriented modeling to represent many different types of things, from organizational structures, to organic materials, to physical buildings.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T14:43:12.067

Object-Oriented Modeling is used to define, usually without any actual code, the classes, methods, and variables. There are many tools out there to help with such modelling. Netbeans is one such package. Netbeans can help you model your code and will even attempt to help you get started after you make your class diagrams.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-19T00:32:12.123

好吧，鉴于代码是一种交流方式，面向对象编程语言中的面向对象编程是一种建模形式。

然而，人们可以使用表达性较差但可能对其他目的更有用的建模语言在更抽象的级别上建模。出于开发软件的目的，与程序没有相对紧密联系的建模主要是针对某些认为它非常重要的人的练习，并且好像它是付费的，但事实并非如此。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T14:47:17.080

我发现这个提取来自 DTMF 网站上关于*面向对象建模的关键概念。*

> 抽象：DENotes 将对象与所有其他类型的对象区分开来的基本特征，从而提供明确定义的概念边界。
> 示例：芝士汉堡 - 好吃又有趣。
> 
> 模块化：将抽象分解为离散单元。
> 示例：芝士汉堡的各种“层”——小圆面包、生菜、番茄酱、蛋黄酱、汉堡、奶酪、洋葱、泡菜等。
> 
> 封装：划分构成其结构和行为的抽象元素的过程；封装用于分离抽象的接口及其实现。
> 示例： • 烹制芝士汉堡： - 炉子可用吗？燃烧器是否工作？成分可用吗？• 吃芝士汉堡： - 制作正确吗？我的盘子是干净的还是恶心的？
> 
> 层次结构：抽象的排序或排序。示例：芝士汉堡实际上是添加了奶酪的汉堡的子类，它是三明治的子类，三明治是 Hierarchal 超类食物的子类。
> 
> 关键元素： 类——状态、行为和/或身份定义的集合 • 属性 • 方法
> 
> 对象：类的实例
> 
> 关联：关系 • 依赖 • 身份 • 聚合 • 组合 • 和其他

# vb.net - Handling the data in an IN clause, with SQL parameters?

> ID：93100
> 
> 赞同：10
> 
> 时间：2008-09-18T14:35:22.973
> 
> 标签：vb.net, sql-server-2008, tsql, sql-injection, language-features

We all know that prepared statements are one of the best way of fending of SQL injection attacks. What is the best way of creating a prepared statement with an "IN" clause. Is there an easy way to do this with an unspecified number of values? Take the following query for example.

```
SELECT ID,Column1,Column2 FROM MyTable WHERE ID IN (1,2,3) 
```

Currently I'm using a loop over my possible values to build up a string such as.

```
SELECT ID,Column1,Column2 FROM MyTable WHERE ID IN (@IDVAL_1,@IDVAL_2,@IDVAL_3) 
```

Is it possible to use just pass an array as the value of the query paramter and use a query as follows?

```
SELECT ID,Column1,Column2 FROM MyTable WHERE ID IN (@IDArray) 
```

In case it's important I'm working with SQL Server 2000, in VB.Net

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T14:49:03.470

给你 - 首先创建以下函数......

```
Create Function [dbo].[SeparateValues]
(
    @data VARCHAR(MAX),
    @delimiter VARCHAR(10) 
) 
    RETURNS @tbldata TABLE(col VARCHAR(10))
As
Begin
    DECLARE @pos INT
    DECLARE @prevpos INT

    SET @pos = 1 
    SET @prevpos = 0

    WHILE @pos > 0 
        BEGIN

        SET @pos = CHARINDEX(@delimiter, @data, @prevpos+1)

        if @pos > 0 
        INSERT INTO @tbldata(col) VALUES(LTRIM(RTRIM(SUBSTRING(@data, @prevpos+1, @pos-@prevpos-1))))

        else

        INSERT INTO @tbldata(col) VALUES(LTRIM(RTRIM(SUBSTRING(@data, @prevpos+1, len(@data)-@prevpos))))

        SET @prevpos = @pos 
    End

    RETURN

END 
```

然后使用以下...

```
Declare @CommaSeparated varchar(50)
Set @CommaSeparated = '112,112,122'
SELECT ID,Column1,Column2 FROM MyTable WHERE ID IN (select col FROM [SeparateValues](@CommaSeparated, ',')) 
```

我认为 sql server 2008 将允许表函数。

**更新**

您将使用以下语法获得一些额外的性能...

```
SELECT ID,Column1,Column2 FROM MyTable
Cross Apply [SeparateValues](@CommaSeparated, ',') s
Where MyTable.id = s.col 
```

因为前面的语法导致 SQL Server 使用“IN”子句运行额外的“排序”命令。另外-在我看来它看起来更好：D！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T14:43:08.213

If you would like to pass an array, you will need a function in sql that can turn that array into a sub-select.

These functions are very common, and most home grown systems take advantage of them.

Most commercial, or rather professional ORM's do ins by doing a bunch of variables, so if you have that working, I think that is the standard method.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T21:47:04.980

您可以使用单列 VALUE 创建一个临时表 TempTable 并插入所有 ID。然后你可以用一个子选择来做：

```
SELECT ID,Column1,Column2 FROM MyTable WHERE ID IN (SELECT VALUE FROM TempTable) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-28T02:18:31.520

使用 digiguru 发布的解决方案。这是一个很好的可重用解决方案，我们也使用相同的技术。新团队成员喜欢它，因为它可以节省时间并保持我们的存储过程一致。该解决方案也适用于 SQL 报告，因为传递给存储过程以创建记录集的参数在 varchar(8000) 中传递。你只要把它挂起来就可以了。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-18T14:46:51.790

在 SQL Server 2008 中，他们终于通过添加新的“表”数据类型来解决这个经典问题。显然，这可以让您传入一个值数组，可以在子选择中使用它来完成与 IN 语句相同的操作。

如果您使用的是 SQL Server 2008，那么您可能会对此进行研究。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-18T14:49:51.723

这是我使用的一种技术

```
ALTER   Procedure GetProductsBySearchString
@SearchString varchar(1000),
as
set nocount on
declare @sqlstring varchar(6000)
select @sqlstring = 'set nocount on
select a.productid, count(a.productid) as SumOf, sum(a.relevence) as CountOf 
 from productkeywords a 
 where rtrim(ltrim(a.term)) in (''' + Replace(@SearchString,' ', ''',''') + ''')
 group by a.productid order by SumOf desc, CountOf desc'

exec(@sqlstring) 
```

# vb6 - 在 VB6 中确定字符是否为字母的最佳方法是什么？

> ID：93105
> 
> 赞同：5
> 
> 时间：2008-09-18T14:35:50.820
> 
> 标签：vb6

需要一个以字符为参数的函数，如果是字母则返回 true。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-18T14:36:02.863

这是[rpetrich](https://stackoverflow.com/users/4007/rpetrich)为[回答](https://stackoverflow.com/questions/61598/code-to-make-a-dhtmled-control-replace-straight-quotes-with-curly-quotes)[Joel Spolsky](https://stackoverflow.com/users/4/joel-spolsky)的问题而发布的代码的一部分。我觉得它需要一个专门针对它解决的问题的帖子。它真的很棒。

```
Private Function IsLetter(ByVal character As String) As Boolean
    IsLetter = UCase$(character) <> LCase$(character)
End Function 
```

你可能会想，“这总是有效吗？” UCase 和 LCase 函数的文档确认它将：

> **UCase 函数**只将小写字母转换为大写； *所有大写字母和非字母字符保持不变*。
> 
> **LCase 函数**只将大写字母转换为小写； *所有小写​​字母和非字母字符保持不变*。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-20T20:11:44.310

Seanyboy 的`IsCharAlphaA` [回答](https://stackoverflow.com/questions/93105/whats-the-best-way-to-determine-if-a-character-is-a-letter-in-vb6/93299#93299)很接近。最好的方法是像这样使用 W 版本：

```
Private Declare Function IsCharAlphaW Lib "user32" (ByVal cChar As Integer) As Long
Public Property Get IsLetter(character As String) As Boolean
    IsLetter = IsCharAlphaW(AscW(character))
End Property 
```

当然，这一切都不重要，因为 VB6 的所有控件都只是 ANSI

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T20:44:22.633

```
Private Function IsLetter(Char As String) As Boolean
    IsLetter = UCase(Char) Like "[ABCDEFGHIJKLMNOPQRSTUVWXYZ]"
End Function 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T14:40:07.907

以下不依赖于晦涩的语言行为有什么问题？

```
Private Function IsLetter(ByVal ch As String) As Boolean
    IsLetter = (ch >= "A" and ch <= "Z") or (ch >= "a" and ch <= "z")
End Function 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-21T19:49:12.050

我相信我们可以在这方面再改进一点。 **rpetrich**的代码可以工作，但也许只能靠运气。API 调用的参数应该是 TCHAR（实际上是 WCHAR）而不是 Long。这也意味着无需摆弄转换为 Long 或使用 &HFFFF 进行屏蔽。顺便说一下，这是 Integer 并且在这里也添加了对 Long 的隐式转换。在这种情况下，也许他的意思是 &HFFFF& ？

最重要的是，最好为此 API 调用显式调用 UnicoWS 包装器，以实现 Win9X 兼容性。可能需要部署 UnicoWS.dll，但至少我们获得了该选项。然后可能是从 VB6 自动重定向的，我没有安装 Win9X 来测试它。

```
Option Explicit

Private Declare Function IsCharAlphaW Lib "unicows" (ByVal WChar As Integer) As Long

Private Function IsLetter(Character As String) As Boolean
    IsLetter = IsCharAlphaW(AscW(Character))
End Function

Private Sub Main()
    MsgBox IsLetter("^")
    MsgBox IsLetter("A")
    MsgBox IsLetter(ChrW$(&H34F))
    MsgBox IsLetter(ChrW$(&HFEF0))
    MsgBox IsLetter(ChrW$(&HFEFC))
End Sub 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T14:55:13.987

环顾四周，想到了以下...

```
Private Declare Function IsCharAlphaA Lib "user32" Alias "IsCharAlphaA" (ByVal cChar As Byte) As Long 
```

我相信 IsCharAlphaA 测试 ANSI 字符集，而 IsCharAlpha 测试 ASCII。我可能错了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T19:34:49.773

```
Private Function IsAlpha(ByVal vChar As String) As Boolean
  Const letters$ = "abcdefghijklmnopqrstuvwxyz"

  If InStr(1, letters, LCase$(vChar)) > 0 Then IsAlpha = True
End Function 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-12T08:34:27.387

我在 VBA 中使用它

```
Function IsLettersOnly(Value As String) As Boolean
   IsLettersOnly = Len(Value) > 0 And Not UCase(Value) Like "*[!A-Z]*"
End Function 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-09-18T14:44:19.427

它并没有完全记录自己。而且可能很慢。这是一个聪明的技巧，但仅此而已。我很想在我的检查中表现得更加明显。要么使用正则表达式，要么编写更明显的测试。

```
public bool IsAlpha(String strToCheck)
{
    Regex objAlphaPattern=new Regex("[^a-zA-Z]");
    return !objAlphaPattern.IsMatch(strToCheck);
}

public bool IsCharAlpha(char chToCheck)
{
    return ((chToCheck=>'a') and (chToCheck<='z')) or ((chToCheck=>'A') and (chToCheck<='Z'))
} 
```

# mysql - MySQL 错误 1153 - 收到的数据包大于“max_allowed_pa cket”字节

> ID：93128
> 
> 赞同：490
> 
> 时间：2008-09-18T14:38:14.993
> 
> 标签：mysql, max-allowed-packet

* * *

## 回答 #1

> 赞同：676
> 
> 时间：2008-09-19T18:10:12.970

You probably have to change it for both the client (you are running to do the import) AND the daemon mysqld that is running and accepting the import.

For the client, you can specify it on the command line:

```
mysql --max_allowed_packet=100M -u root -p database < dump.sql 
```

Also, **change the my.cnf or my.ini file** (usually found in /etc/mysql/) under the mysqld section and set:

```
max_allowed_packet=100M 
```

or you could run these **commands** in a MySQL console connected to that same server:

```
set global net_buffer_length=1000000; 
set global max_allowed_packet=1000000000; 
```

(Use a very large value for the packet size.)

* * *

## 回答 #2

> 赞同：135
> 
> 时间：2009-04-06T18:42:18.277

As michaelpryor said, you have to change it for *both* the client *and* the daemon mysqld server.

His solution for the client command-line is good, but the ini files don't always do the trick, depending on configuration.

So, open a terminal, type mysql to get a mysql prompt, and issue these commands:

```
set global net_buffer_length=1000000; 
set global max_allowed_packet=1000000000; 
```

Keep the mysql prompt open, and run your command-line SQL execution on a second terminal..

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2008-09-18T14:41:20.510

This can be changed in your `my.ini` file (on Windows, located in \Program Files\MySQL\MySQL Server) under the server section, for example:

```
[mysqld]

max_allowed_packet = 10M 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-09-19T20:31:07.670

### Re my.cnf on Mac OS X when using MySQL from the mysql.com dmg package distribution

By default, my.cnf is nowhere to be found.

You need to copy one of `/usr/local/mysql/support-files/my*.cnf` to `/etc/my.cnf` and restart `mysqld`. (Which you can do in the MySQL preference pane if you installed it.)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2013-11-28T19:38:47.747

The fix is to increase the MySQL daemon’s max_allowed_packet. You can do this to a running daemon by logging in as Super and running the following commands.

```
# mysql -u admin -p

mysql> set global net_buffer_length=1000000;
Query OK, 0 rows affected (0.00 sec)

mysql> set global max_allowed_packet=1000000000;
Query OK, 0 rows affected (0.00 sec) 
```

Then to import your dump:

```
gunzip < dump.sql.gz | mysql -u admin -p database 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2014-02-03T10:27:07.583

In etc/my.cnf try changing the max_allowed _packet and net_buffer_length to

```
max_allowed_packet=100000000
net_buffer_length=1000000 
```

if this is not working then try changing to

```
max_allowed_packet=100M
net_buffer_length=100K 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-10-02T19:57:20.670

On CENTOS 6 /etc/my.cnf , under [mysqld] section the correct syntax is:

```
[mysqld]
# added to avoid err "Got a packet bigger than 'max_allowed_packet' bytes"
#
net_buffer_length=1000000 
max_allowed_packet=1000000000
# 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-18T14:41:33.630

Use a `max_allowed_packet` variable issuing a command like

`mysql --max_allowed_packet=32M -u root -p database < dump.sql`

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-04-21T14:55:15.017

Slightly unrelated to your problem, so here's one for Google.

If you didn't mysqldump the SQL, it might be that your SQL is broken.

I just got this error by accidentally having an unclosed string literal in my code. Sloppy fingers happen.

That's a fantastic error message to get for a runaway string, thanks for that MySQL!

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-01-29T06:33:45.670

**Error:**

> ERROR 1153 (08S01) at line 6772: Got a packet bigger than 'max_allowed_packet' bytes Operation failed with exitcode 1

**QUERY:**

```
SET GLOBAL max_allowed_packet=1073741824;
SHOW VARIABLES LIKE 'max_allowed_packet'; 
```

**Max value:**

```
Default Value (MySQL >= 8.0.3)  67108864
Default Value (MySQL <= 8.0.2)  4194304
Minimum Value   1024
Maximum Value   1073741824 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-10-16T07:09:14.957

Sometimes type setting:

```
max_allowed_packet = 16M 
```

in my.ini is not working.

Try to determine the my.ini as follows:

```
set-variable = max_allowed_packet = 32M 
```

or

```
set-variable = max_allowed_packet = 1000000000 
```

Then restart the server:

```
/etc/init.d/mysql restart 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-07-26T03:46:28.273

It is a security risk to have `max_allowed_packet` at higher value, as an attacker can push bigger sized packets and crash the system.

So, Optimum Value of `max_allowed_packet` to be tuned and tested.

It is to better to change when required *(using `set global max_allowed_packet = xxx`)* than to have it as part of *my.ini* or *my.conf*.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-03-03T18:03:20.263

I am working in a shared hosting environment and I have hosted a website based on Drupal. I cannot edit the `my.ini` file or `my.conf` file too.

So, I deleted all the tables which were related to `Cache` and hence I could resolve this issue. Still I am looking for a perfect solution / way to handle this problem.

**Edit** - Deleting the tables created problems for me, coz Drupal was expecting that these tables should be existing. So I emptied the contents of these tables which solved the problem.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-12-28T07:09:14.670

I have resolved my issue by this query

```
SET GLOBAL max_allowed_packet=1073741824; 
```

and check max_allowed_packet with this query

```
SHOW VARIABLES LIKE 'max_allowed_packet'; 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-09-18T19:06:37.627

Set max_allowed_packet to the same (or more) than what it was when you dumped it with mysqldump. If you can't do that, make the dump again with a smaller value.

That is, assuming you dumped it with mysqldump. If you used some other tool, you're on your own.

# c# - 如何设计规则引擎？

> ID：93147
> 
> 赞同：17
> 
> 时间：2008-09-18T14:39:34.663
> 
> 标签：c#, sql-server, rule-engine

我应该在 C# 中创建一个简单的规则引擎。关于我如何继续进行的任何线索？它是一个简约的规则引擎，并将使用 SQL 服务器作为后端。我们是否有任何普遍适用于规则引擎的通用蓝图或设计模式？我可以使用哪种 .Net 技术来设计一种？任何方向都会有所帮助。谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-18T14:44:48.660

如果您使用的是 .NET 3.0 或更高版本，[则可以使用 Windows Workflow Foundation 的规则引擎，](http://blogs.microsoft.co.il/blogs/bursteg/archive/2007/08/09/WF-Rules-Engine-without-Workflow.aspx)而无需实际使用 Workflow。

我在一个项目上做过这个，你可以使用 SQL 或 XML 作为后端，效果很好。您可以使用 Workflow 示例附带的 IDE 并将其放入您自己的应用程序中。太棒了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T14:44:27.523

1.  考虑到有这么多可用的商业和开源资源，我不敢相信你会实现自己的。

2.  我建议将 InRule 视为价格合理的绝佳商业选择，或者将 NxBRE 视为开源空间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-07T06:04:43.210

你也可以试试 [http://rulesengine.codeplex.com/](http://rulesengine.codeplex.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T14:41:35.283

您在寻找什么样的规则引擎？对于造型实践？如果是这样，请查看[StyleCop](http://http://spoiledtechie.com/post/StyleCop-was-just-released!.aspx)。不是答案，但可能已经有适合你的东西了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T14:49:26.763

你有方法说明吗？（即，如果这由课程材料补充，您目前正在学习什么？）如果这是一个相当基本的系统，您可能会成功研究确定性有限[状态机](http://en.wikipedia.org/wiki/Deterministic_finite-state_machine)和[非确定性有限状态机](http://en.wikipedia.org/wiki/Nondeterministic_finite_state_machine)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-28T00:08:38.270

如果您有业务分析师来编写高级规则引擎，那么很好 - 选择前面提到的规则引擎之一或推出您自己的规则引擎（包括工作流）。如果没有，那么只需在代码中编写您的业务逻辑，如果您需要聘请业务分析师并重做系统，那么您将处于一个很好的位置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-01-22T22:27:18.040

如果您想编写类似这样的实现...

```
[TestMethod]
public void GreaterThanRule_WhenGreater_ResultsTrue()
{
    // ARRANGE
    int threshold = 5;
    int actual = 10;

    // ACT
    var integerRule = new IntegerGreaterThanRule();
    integerRule.Initialize(threshold, actual);

    var integerRuleEngine = new RuleEngine<int>();
    integerRuleEngine.Add(integerRule);
    var result = integerRuleEngine.MatchAll();

    // ASSERT
    Assert.IsTrue(result);
} 
```

... 或这个...

```
[TestMethod]
public void GreaterThanRule_WhenGreater_ResultsTrue()
{
    // ARRANGE
    int threshold = 5;
    int actual = 10;

    // ACT
    var integerRule = new IntegerGreaterThanRule(threshold);

    var integerRuleEngine = new RuleEngine<int>();
    integerRuleEngine.ActualValue = actual;
    integerRuleEngine.Add(integerRule);

    // Get the result
    var result = integerRuleEngine.MatchAll();

    // ASSERT
    Assert.IsTrue(result);
} 
```

# sql-server - SQL Server 加入后行数低估

> ID：93150
> 
> 赞同：4
> 
> 时间：2008-09-18T14:39:59.780
> 
> 标签：sql-server, performance

当实际行数为 2000 时，查询优化器估计连接的结果将只有一行。这会导致数据集上的后续连接具有一行的估计结果，而其中一些连接的结果可能很高为 30,000。

计数为 1 时，QO 正在为许多太慢的连接选择循环连接/索引搜索策略。我通过使用 a 限制可能的连接策略来解决这个问题`WITH OPTION (HASH JOIN, MERGE JOIN)`，这将整体执行时间从 60 多分钟提高到 12 秒。但是，我认为由于行数不佳，QO 仍会生成一个不太理想的计划。我不想手动指定连接顺序和详细信息——受此影响的查询太多，不值得。

这是在 Microsoft SQL Server 2000 中，一个将多个表选择连接到主选择的中等查询。

我认为 QO 可能高估了连接中多方的基数，期望表之间的连接列具有较少的共同行。

在连接之前扫描索引的估计行数是准确的，只有在某些连接之后估计的行数太低了。

数据库中所有表的统计信息都是最新的并自动刷新。

早期的错误连接之一是用于所有人共有信息的通用“人员”表和大约 5% 的人所属的专门人员表之间。两个表（和连接列）中的聚集 PK 是一个 INT。数据库高度规范化。

我相信根本问题是某些连接后错误的行数估计，所以我的主要问题是：

*   如何修复 QO 的加入后行数估计？
*   有没有一种方法可以暗示连接将有很多行而不手动指定整个连接顺序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T13:20:04.657

尽管统计数据是最新的，但扫描百分比不足以提供准确的信息。我在每个遇到问题的基表上运行此程序，以通过扫描所有行来更新表上的所有统计信息，而不仅仅是默认百分比。

```
UPDATE STATISTICS <table> WITH FULLSCAN, ALL 
```

查询仍然有很多循环连接，但连接顺序不同，运行时间为 2-3 秒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T14:42:55.077

你不能用一个很好的查询提示来刺激 QO 吗？

# .net - 为整个应用程序设置 CurrentCulture 的简单方法？

> ID：93153
> 
> 赞同：11
> 
> 时间：2008-09-18T14:40:15.210
> 
> 标签：.net, winforms, localization

在 .net 2 winforms 应用程序中，为整个应用程序设置文化的好方法是什么？
为每个新线程设置 CurrentThread.CurrentCulture 是重复且容易出错的。
理想情况下，我想在应用程序启动时设置它并忘记它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T15:08:02.270

.NET 中线程的文化是系统的文化（从单个应用程序/进程来看）。在 .NET 中无法覆盖它，您必须继续为每个新线程设置 CurrentCulture。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T15:33:32.553

您可以通过这种方式设置应用程序当前文化：

```
static void Main()
{
    System.Globalization.CultureInfo cultureInfo = new System.Globalization.CultureInfo("fi-FI");
    Application.CurrentCulture = cultureInfo;
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Application.Run(new Form1());
} 
```

我不确定它是否有帮助，因为我从未用线程测试过它。

编辑：它不起作用。我认为您必须在每个线程中设置当前文化。

# winapi - How to protect yourself against shell DLLs loaded into your process?

> ID：93154
> 
> 赞同：4
> 
> 时间：2008-09-18T14:40:25.193
> 
> 标签：winapi, dll, shell

When you use a standard Windows "file open" dialog using GetOpenFileName(), the shell will load various DLLs that it requires to display the file list, including custom ones.

In my application, I found that the DLL that TortoiseCVS uses to draw overlays on the icons was calling GdiPlusShutdown(), and so some time after displaying a "file open" dialog, the TortoiseCVS DLL would be unloaded, it would shut down GDI+ and my graphics functions would all fail!

It seems quite bad that basically any old DLL could be loaded by my application at any time and start doing random things to its state. The workaround in my case was quite simple - just restart GDI+ if I detect that it's been shut down. However had this happened on a client's machine where I couldn't debug it, it would have been a lot more challenging to figure out what was going on.

Can anybody offer any insight? What could I do to stop this from happening?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T14:48:17.297

我不得不处理戴尔在其机器上放置的垃圾，尤其是 wxVault。我的解决方案是“简单地”修补代码。DEP 有点棘手，但仍然可行。你可以看一下 Microsoft Detours，这是一种更结构化的方式来做同样的事情。您仍然需要加载 DLL，但至少您可以阻止它调用不应调用的函数。

要了解 Windows 为何具有如此糟糕的机制，请阅读 Raymond Chen 的“Old New Thing”博客或书籍。

# .net - Editing Autogenerated DMBL file for WCF Service

> ID：93159
> 
> 赞同：2
> 
> 时间：2008-09-18T14:40:49.577
> 
> 标签：.net, wcf, linq-to-sql, dbml

In our project we have a standard auto-generated designer.cs file, linked to a DBML file, that contains all our object classes that map onto our database tables.

We want to pass these objects directly through a WCF Service and so they need decorating with the [DataContract] and [DataMember] attributes where appropriate. What is the best approach to doing this so the changes won't get wiped out when the designer.cs file is re-generated upon a change to the database scheme or some other change.

Partial classes are an option, but if the property I want to decorate with the DataMember attribute is already defined in the autogenerated designer.cs file then I can't add the same property definition to the partial class as this means the property will have been defined twice.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T19:44:27.833

将 DBML 序列化模式设置为单向将使用所需属性装饰类和一些成员，但是它将忽略一些关联以避免在 SP1 之前存在问题的循环引用。

如果您也想要这些，请查看我的[LINQ to SQL T4 模板](http://damieng.com/blog/2008/09/14/linq-to-sql-template-for-visual-studio-2008)，该模板提供了与 SP1 完全兼容的 DataContract 属性（取消注释 DataClasses.tt 文件中的 data.SerializationMode = DataContractSP1 行）以及让您将 DBML 的任何其他部分自定义为 C# /VB.NET 代码生成过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T15:35:32.797

dbml 文件提供部分类，因此您可以创建一个新的 .cs 文件，定义要扩展的部分类，然后使用所需的属性对其进行装饰。例如，如果您有一个生成的数据上下文，看起来像

```
public partial class MyDataContext : System.Data.Linq.DataContext
{
...
} 
```

您可以在单独的 .cs 文件中定义以下内容：

```
[DataContract]
public partial class MyDataContext
{
...
} 
```

这样，您可以扩展生成的类，而不必担心在重新生成 dbml 文件时它们会被覆盖。

# wcf - 在 WCF 3.0 中获取客户端 IP 地址

> ID：93162
> 
> 赞同：82
> 
> 时间：2008-09-18T14:40:59.247
> 
> 标签：wcf

显然，您可以在 WCF 3.5 中轻松获取客户端 IP 地址，但在 WCF 3.0 中则不行。有谁知道怎么做？

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2008-09-18T15:11:10.533

这在 3.0 中对您没有帮助，但我只能看到人们发现这个问题并感到沮丧，因为他们试图在 3.5 中获取客户端 IP 地址。所以，这里有一些应该可以工作的代码：

```
using System.ServiceModel;
using System.ServiceModel.Channels;

OperationContext context = OperationContext.Current;
MessageProperties prop = context.IncomingMessageProperties;
RemoteEndpointMessageProperty endpoint =
    prop[RemoteEndpointMessageProperty.Name] as RemoteEndpointMessageProperty;
string ip = endpoint.Address; 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-10-09T16:34:44.277

事实证明，只要 (a) 您的服务托管在 Web 服务中（显然）并且 (b) 您启用 AspNetCompatibility 模式，您就可以，如下所示：

```
 <system.serviceModel>
            <!-- this enables WCF services to access ASP.Net http context -->
            <serviceHostingEnvironment aspNetCompatibilityEnabled="true"/>
...
    </system.serviceModel> 
```

然后您可以通过以下方式获取IP地址：

```
HttpContext.Current.Request.UserHostAddress 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-10T08:26:25.010

如果您的目标是 .NET 3.0 SP1，则可以。

```
OperationContext context = OperationContext.Current;
MessageProperties prop = context.IncomingMessageProperties;
RemoteEndpointMessageProperty endpoint = prop[RemoteEndpointMessageProperty.Name] as RemoteEndpointMessageProperty;
string ip = endpoint.Address; 
```

致谢：http: [//blogs.msdn.com/phenning/archive/2007/08/08/remoteendpointmessageproperty-in-wcf-net-3-5.aspx](http://blogs.msdn.com/phenning/archive/2007/08/08/remoteendpointmessageproperty-in-wcf-net-3-5.aspx)

参考：http: [//msdn.microsoft.com/en-us/library/system.servicemodel.channels.remoteendpointmessageproperty.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.remoteendpointmessageproperty.aspx)

# html - HTML中的不间断非空格

> ID：93171
> 
> 赞同：10
> 
> 时间：2008-09-18T14:41:46.110
> 
> 标签：html, css, internet-explorer, line-breaks, pocketpc

我有一个保龄球网络应用程序，它允许逐帧输入非常详细的信息。它允许的一件事是跟踪每个球上击倒了哪些引脚。为了显示这些信息，我让它看起来像一个针架：

```
哦哦
 哦哦
  哦
   ○
```

图像用于表示引脚。所以，对于后排，我有四个*img*标签，然后是一个*br*标签。它工作得很好......主要是。问题出在小型浏览器中，例如 IEMobile。在这种情况下，一个表中可能有 10 或 11 列，并且每列中可能有一个针架，Internet Explorer 将尝试缩小列大小以适应屏幕，我最终会得到类似这：

```
哦哦
  ○
哦哦
 哦
  ○
```

或者

```
哦
哦
哦
 ○
哦
 ○
```

结构是：

```
<tr>
    <td>
        <!-- some whitespace -->
        <div class="..."><img .../><img .../><img .../><img .../><br/>...</div>
        <!-- some whitespace -->
    </td>
</tr> 
```

内部 div 内没有空格。如果您在常规浏览器中查看[此页面，它应该可以正常显示。](http://www.bowlsk.com/games/view-series.html?series=13717)如果您在 IEMobile 中查看它，它不会。

有什么提示或建议吗？也许某种   那实际上并没有添加空格？

* * *

### 跟进/总结

我收到并尝试了几个很好的建议，包括：

*   在服务器上动态生成整个图像。这是一个很好的解决方案，但并不真正满足我的需要（托管在[GAE](https://en.wikipedia.org/wiki/Google_App_Engine)上），而且代码比我想写的要多。这些图像也可以在第一代之后被缓存。
*   使用 CSS 空白声明。它是一个很好的基于标准的解决方案，但在 IEMobile 视图中却惨遭失败。

### 我最终做了什么

**低着头咕哝着什么**

是的，没错，在 div 的顶部有一个透明的 GIF，大小是我需要的宽度。结束代码（简化）如下所示：

```
<table class="game">
    <tr class="analysis leave">
        <!-- ... -->
        <td> <div class="smallpins"><img class="spacer" src="http://seasrc.th.net/gif/cleardot.gif" /><br/><img src="/img/pinsmall.gif"/><img src="/img/nopinsmall.gif"/><img src="/img/nopinsmall.gif"/><img src="/img/nopinsmall.gif"/><br/><img src="/img/pinsmall.gif"/><img src="/img/pinsmall.gif"/><img src="/img/nopinsmall.gif"/><br/><img src="/img/nopinsmall.gif"/><img src="/img/nopinsmall.gif"/><br/><img src="/img/nopinsmall.gif"/></div> </td>
        <!-- ... -->
    </tr>
</table> 
```

和 CSS：

```
div.smallpins {
    background: url(/img/lane.gif) repeat;
    text-align: center;
    padding: 0;
    white-space: nowrap;
}
div.smallpins img {
    width: 1em;
    height: 1em;
}
div.smallpins img.spacer {
    width: 4.5em;
    height: 0px;
}
table.game tr.leave td{
    padding: 0;
    margin: 0;
}
table.game tr.leave .smallpins {
    min-width: 4em;
    white-space: nowrap;
    background: none;
} 
```

PS：不，我不会在我的最终解决方案中盗链别人的明确点:)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-18T14:49:30.427

您可以在包含的 div 中尝试 css "nowrap" 选项。

```
{white-space: nowrap;} 
```

不确定支持的范围有多广。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T14:43:43.373

为什么不为引脚的所有可能结果提供图像？不弄乱浏览器的布局，图像就是图像

动态生成它们，缓存创建的图像以供重用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T14:45:40.373

过去，我通过将整个图像（具有适当的引脚排列）动态创建为单个图像来解决此类问题。如果您使用的是 ASP.NET，那么使用 GDI 调用很容易做到这一点。您只需使用图钉位置动态创建图像，然后将其作为单个图像提供给页面。消除图片中的所有对齐问题（双关语）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T14:53:44.800

最有意义的是更改动态显示的图像：

```
<div id="pin-images">
    <img src="fivepins.jpg" />
    <img src="fourpins.jpg" />
    <img src="threepins.jpg" />
    <img src="twopins.jpg" />
    <img src="onepin.jpg" />
</div> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T14:46:58.373

既然您无论如何都在使用图像，为什么不即时生成代表整个布局的图像呢？您可以使用[GD](http://www.boutell.com/gd/)或[ImageMagick](http://www.imagemagick.org/script/index.php)之类的东西来解决问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T14:55:37.543

在您的 td 标签中添加“nowrap”...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T15:20:25.830

由于您要获得最大的兼容性，因此请考虑生成表示框架的单个图像。

如果您使用的是 PHP，则可以使用 GD 来动态创建代表帧的图像，这些图像基于您将用于在问题中创建 HTML 的相同输入。这样做的最大好处是任何可以显示 PNG 或 GIF 的浏览器都可以显示您的框架。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-31T08:20:47.993

我发现客户端上有一个设置，他们可以将视图选择为 1) *Single Column*、2) *Desktop View*和 3) *Fit Window*。

根据 MSDN，默认应该是*Fit Window*。但我妻子的 IE 手机默认为*Single Column*。*因此，无论如何*，它都会将所有内容包装到一个列中。如果我切换到其他两个选项中的任何一个，它看起来都很好。

好吧，您可以使用元标记进行设置：

```
<meta name="MobileOptimized" content="320"> 
```

将页面宽度设置为 320 像素。但我不知道如何让它去自动。

这在 v4.6 之前的[BlackBerry 上](https://en.wikipedia.org/wiki/BlackBerry)*不起作用*- 除非用户手动更改为桌面视图，否则您会被单列困住。对于 4.6 或更高版本，以下内容应该可以工作，但我尚未对其进行测试：

```
<meta name="viewport" content="width=320"> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T14:44:32.763

您可能需要紧跟在分号后面的实际空格  

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T14:48:02.100

尝试使用与`<div>`同一行的标签`<td>...</td>`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T14:48:45.640

我可能误解了你所追求的，但我认为你可以做我[为地图上的标志](http://woarl.com/board/robMap.html)所做的事情。

绘制地图背景图块，然后告诉每个图像向左浮动并给出一些有趣的边距，以便它们按我想要的方式定位（查看源代码以了解它是如何完成的）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T15:06:16.067

使用单词连接符 U+2060（即`&#x2060;`）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T15:09:56.650

也许这只是您可以使用表格来强制布局的一种情况。这不是最佳的，而且我知道您不应该将表格用于非表格的事物，但您可以这样做。

```
<table>
<tr>
<td><img src="Pin.jpg"></td>
<td>&nbsp;</td>
<td><img src="Pin.jpg"></td>
<td>&nbsp;></td>
<td><img src="Pin.jpg"></td>
<td>&nbsp;</td>
<td><img src="Pin.jpg"></td>
</tr>
<tr>
<td>&nbsp;</td>
<td><img src="Pin.jpg"></td>
<td>&nbsp;</td>
<td><img src="Pin.jpg"></td>
<td>&nbsp;</td>
<td><img src="Pin.jpg"></td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><img src="Pin.jpg"></td>
<td>&nbsp;</td>
<td><img src="Pin.jpg"></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><img src="Pin.jpg"></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</table> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T15:52:31.353

您是否尝试过为列定义宽度？喜欢`<td width="123px">`或`<td style="width:123px">`。也许也适用于 div ？

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T16:10:49.390

您可以将 img 替换为 span 并为每个 span 使用背景图像，具体取决于 CSS 类：

```
<p class="..."><span class="pin"></span><span>&nbsp;</span><span class="pin"></span>...
<p class="..."><span class="pin"></span><span>&nbsp;</span><span class="pin"></span>...
<p class="..."><span class="pin"></span><span>&nbsp;</span><span class="pin"></span>...
<p class="..."><span class="pin"></span><span>&nbsp;</span><span class="pin"></span>... 
```

（我个人认为最好有四行带`p`标签而不是单行`div`带`br`.）

然后在CSS中你可以有这样的东西：

```
p.smallpins {
    margin: 0;
    padding: 0;
    height: 11px;
    font-size: 1px;
}
p.smallpins span {
    width: 11px;
    background-image: url(nopinsmall.gif);
    background-repeat: ...
    background-position: ...
}
p.smallpins span.pin {
    background-image: url(pinsmall.gif);
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-18T18:46:00.623

*   没有任何**[nobr](http://devedge-temp.mozilla.org/library/manuals/1998/htmlguide/tags15.html#1107540)** HTML 标签；不过，我不确定它的支持程度如何。
*   您可以在元素（图像）之间使用 CSS**溢出：可见**和不间断空格，但这些行的 HTML 内容中没有其他空格。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-19T15:28:26.353

**为每一行**的每个可能的排列都有单独的图像。

那只需要 30 张图片 (16+8+4+2)

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2008-09-18T14:49:04.360

如果你这样做会不会更容易？

```
<div id="container">
  <div id="row1">
    <img/><img/><img/><img/>
  </div>
  <div id="row2">
    <img/><img/><img/>
  </div>
  <div id="row3">
    <img/><img/>
  </div>
  <div id="row4">
    <img/>
  </div>
</div> 
```

您的 CSS 将在哪里处理对齐？

```
.container div{
  text-align:center;
} 
```

# java - 在运行时修改 JVM 参数

> ID：93177
> 
> 赞同：0
> 
> 时间：2008-09-18T14:42:21.210
> 
> 标签：java

有人知道是否可以在运行时修改 JVM 设置（例如 -dname=value）？我需要这个小技巧来运行我的 Java 存储过程（oracle 10g）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T14:44:48.317

假设您的意思是系统属性（-D ...；-d 选择数据模型） System.setProperty(...) 可能会做您想做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-28T14:17:14.197

您可以在 java 存储过程中使用 OracleRuntime 类。

```
 int times = 2;
 OracleRuntime.setMaxRunspaceSize(times *OracleRuntime.getMaxRunspaceSize());
 OracleRuntime.setSessionGCThreshold(times *OracleRuntime.getSessionGCThreshold());
 OracleRuntime.setNewspaceSize(times *OracleRuntime.getNewspaceSize());
 OracleRuntime.setMaxMemorySize(times *OracleRuntime.getMaxMemorySize());
 OracleRuntime.setJavaStackSize(times *OracleRuntime.getJavaStackSize());
 OracleRuntime.setThreadStackSize(times *OracleRuntime.getThreadStackSize()); 
```

此示例代码将 oracle jvm 中的内存状态乘以 2。注：导入oracle.aurora.vm.OracleRuntime；将在 oracle jvm 上解决，在“aurora.zip”上找到

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T14:47:18.733

您绝对可以使用 System.setProperty() 在 Java 存储过程中设置系统属性。但是，它们仅对当前的 Oracle 会话可用。

例如，如果您连接到 Oracle，并运行设置系统属性的 Java 存储过程，则断开与 Oracle 的连接。当您下次连接到 Oracle 时，系统属性将不存在。与 Oracle 的每个会话都有自己的伪独立 JVM（即使所有会话都真正共享一个 JVM）。

如果您用于 Oracle 会话的帐户具有足够的权限，您可以运行外部操作系统命令，包括单独的外部 JVM。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T17:43:12.257

您可以使用 System.setProperty() 更改系统属性，但这是否有效取决于该系统属性。某些属性是静态读取的，即在类加载时，而其他属性可能会将值缓存在某些对象字段中。

# svn - Subclipse Get Contents 和 Get Revision 有什么区别？

> ID：93183
> 
> 赞同：5
> 
> 时间：2008-09-18T14:43:04.110
> 
> 标签：svn, version-control, eclipse-plugin, subclipse, revision

使用 Eclipse->Team->Show History 视图时，在文件修订版上使用 Subclipse“获取内容”和“获取修订版”选项有什么区别？

有什么方法可以查看 Subclipse 在幕后发出的 svn 命令吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-18T14:50:37.650

从 Subclipse 手册（帮助 > 帮助内容）：

> **获取内容**
> 
> 使用此选项可使用存储库中的修订内容更新工作副本中选定文件的内容。此选项不会更改本地文件的修订号。
> 
> 此选项仅在为本地工作副本中的单个文件启动资源历史记录时有效。
> 
> **获取修订**
> 
> 使用此选项可将工作副本中的文件替换为存储库中的选定修订版。本地文件的修订号更改为所选修订。
> 
> 此选项仅在为本地工作副本中的单个文件启动资源历史记录时有效。

很不言自明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T15:01:21.960

获取内容只显示文件的内容，而获取修订版替换您的文件版本。

要在控制台视图中查看 subclipse 运行的命令，您应该检查 tools/preferences/team/svn/console 中的“在命令运行时自动显示 SVN 控制台”选项。

# sql-server - 我可以在 SQL Server 2005 任务中自动“生成脚本”吗？

> ID：93208
> 
> 赞同：4
> 
> 时间：2008-09-18T14:45:25.553
> 
> 标签：sql-server, scripting

我想定期自动生成数据库脚本。这可能吗。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T14:53:26.830

要为对象生成脚本，您必须传递最多六个参数：

```
exec proc_genscript 
    @ServerName = 'Server Name', 
    @DBName = 'Database Name', 
    @ObjectName = 'Object Name to generate script for', 
    @ObjectType = 'Object Type', 
    @TableName = 'Parent table name for index and trigger',
    @ScriptFile = 'File name to save the script' 
```

[http://www.databasejournal.com/features/mssql/article.php/2205291](http://www.databasejournal.com/features/mssql/article.php/2205291)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T14:55:34.127

您可能想查看 SQL Server 管理对象 (SMO)。有一些脚本对象可以帮助从数据库对象生成 T-SQL 脚本。Bill Hamilton的[“Programming SQL Server 2005”](https://rads.stackoverflow.com/amzn/click/com/0596004796)是一个很好的参考。第 12 章特别提到了 SMO 实用程序类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T15:05:55.117

您可以使用 CodePlex 中的[数据库发布向导](http://www.codeplex.com/Wiki/View.aspx?ProjectName=sqlhost&title=Database%20Publishing%20Wizard)。它有一个命令行界面。

# ruby-on-rails - 在测试 Rails 模型的设置器时如何模拟参数？

> ID：93214
> 
> 赞同：1
> 
> 时间：2008-09-18T14:45:57.037
> 
> 标签：ruby-on-rails, unit-testing, testing, testing-strategies

鉴于[复杂表单第三部分](http://railscasts.com/episodes/75)的代码，您将如何测试虚拟属性？

```
 def new_task_attributes=(task_attributes)
    task_attributes.each do |attributes|
      tasks.build(attributes)
    end
  end 
```

我目前正在尝试像这样测试它：

```
 def test_adding_task_to_project
    p = Project.new
    params = {"new_tasks_attributes" => [{ "name" => "paint fence"}]}
    p.new_tasks_attributes=(params)
    p.save
    assert p.tasks.length == 1
  end 
```

但我收到以下错误：

> NoMethodError：未定义的方法“stringify_keys！” 对于“new_tasks_attributes”：字符串

任何有关改进此测试的建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T15:04:59.487

看起来 new_task_attributes= 需要一个散列数组，但您正在向它传递一个散列。试试这个：

```
def test_adding_task_to_project
  p = Project.new
  new_tasks_attributes = [{ "name" => "paint fence"}]
  p.new_tasks_attributes = (new_tasks_attributes)
  p.save
  assert p.tasks.length == 1
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T15:11:26.100

我们可以看到整个堆栈跟踪吗？它在哪里认为 String#stringify_keys！被调用？

此外，参数对我来说看起来很奇怪。tasks.build() 是否期待这样的输入：`["new_tasks_attribute", {"name" => "paint fence"}]`？

如果没有，也许您实际上想要 Hash#each_key() 而不是 Hash#each()？

需要更多数据。此外，您可能会考虑将 Ruby 标记与 Rails 标记一起使用。

# email - 如何找出触发 spamassassin 中 TRACKER_ID 规则的原因？

> ID：93222
> 
> 赞同：1
> 
> 时间：2008-09-18T14:46:39.920
> 
> 标签：email, error-reporting, spamassassin, spam-prevention

我最近收到了一封来自我女朋友的电子邮件，称 spamassassin 被标记为垃圾邮件，主要是因为 spamassassin 检测到了一个跟踪器 ID……除了没有。我想知道是什么触发了它，以便我可以报告一个明智的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T14:53:32.587

看看有问题的规则怎么样？谷歌这样说：

> /^[a-z0-9]{6,24}[-_a-z0-9]{12,36}[a-z0-9]{6,24}\s*\z/is
> 
> ...在其当前形式中，将命中（一些，取决于连字符）具有 24 个或更多字符的单词。所以也许熟悉跟踪器 ID 的人可以调整正则表达式，这样大字（比如 30 个字符？）就不会被击中。

网址：[https ://issues.apache.org/SpamAssassin/show_bug.cgi?id=2307](https://issues.apache.org/SpamAssassin/show_bug.cgi?id=2307)

那是2005年，所以它可能已经改变了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T19:59:19.730

[仅供参考，您可以在http://cpansearch.perl.org/src/JMASON/Mail-SpamAssassin-3.2.5/rules/20_body_tests.cf](http://cpansearch.perl.org/src/JMASON/Mail-SpamAssassin-3.2.5/rules/20_body_tests.cf)看到在 SpamAssassin 3.2.5 中分发的 TRACKER_ID 规则

# eclipse - 调试 Eclipse 应用程序问题：重复启动

> ID：93231
> 
> 赞同：0
> 
> 时间：2008-09-18T14:47:13.710
> 
> 标签：eclipse, debugging

我在从 Eclipse 调试 Eclipse 应用程序时遇到问题。当我启动调试配置时，Eclipse 应用程序启动然后反复停止。它显示启动画面，然后消失。这是重启前的最远距离：

```
MyDebugConfiguration [Eclipse Application]  
    org.eclipse.equinox.launcher.Main at localhost:2599 
        Thread [main] (Running) 
        Daemon Thread [Signal Dispatcher] (Running) 
        Daemon Thread [State Data Manager] (Running)    
        Daemon Thread [Framework Event Dispatcher] (Running)    
        Thread [State Saver] (Running)  
        Daemon Thread [Start Level Event Dispatcher] (Running)  
        Thread [Refresh Packages] (Running) 
    C:\MyApp\eclipse\jdk\jre\bin\javaw.exe (Sep 18, 2008 9:38:19 AM) 
```

我正在使用 Eclipse SDK 3.4.0 版。

这是什么原因造成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-18T17:43:55.780

您是否尝试过使用 -clean 选项启动 Eclipse？如果它与配置问题或注册表缓存有关，这可能会解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T20:05:32.490

启动 IDE 时，您的 Eclipse 应用程序是否具有类似于工作区中隐藏的日志文件？您可以在 workspace/.metadata/.log 中找到它

如果您的应用程序在某处有此功能，您可能能够更好地了解 Eclipse 应用程序启动时发生的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T14:06:41.093

我总是将`-console`and添加`-consoleLog`到启动配置中。

第一个将 eclipse 日志转储到控制台，第二个让您可以访问[OSGi 控制台](http://www.ibm.com/developerworks/library/os-ecl-osgiconsole/index.html)。

在这种情况下，我检查所有捆绑包的状态（使用`ss`）。您感兴趣的捆绑包可能尚未启动。这可能是由于：

*   激活器中的异常。
*   捆绑包的未解决依赖项。

如果您还没有通过控制台日志看到错误，那么您尝试在控制台上手动启动捆绑包，使用`start <bundle-number>`. 这`<bundle-number>`是`ss`输出中看到的捆绑包的索​​引。如果启动包有问题，那么堆栈跟踪将有助于追踪真正的问题。

# c++ - 根据一组编码标准检查 C/C++ 源代码的免费工具？

> ID：93260
> 
> 赞同：155
> 
> 时间：2008-09-18T14:50:24.997
> 
> 标签：c++, c, coding-style

看起来很容易找到这样的 Java 工具（[Checkstyle](http://checkstyle.sourceforge.net/)，[JCSC](http://jcsc.sourceforge.net/)），但我似乎找不到 C/C++ 的工具。我不是在寻找类似 lint 的静态代码分析器，我只想检查变量命名、大写、间距、标识、括号放置等编码标准。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-09-18T14:54:15.347

我知道的唯一工具是[Vera](http://bitbucket.org/verateam/vera)。不过，还没有使用它，所以无法评论它的可行性。~~[演示](http://www.inspirel.com/vera/ce/demo.html)看起来很有希望。~~

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-07-28T10:11:57.730

来自 [Google 代码样式指南](https://google.github.io/styleguide/cppguide.html)的Google [c++lint](https://github.com/google/styleguide/tree/gh-pages/cpplint)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-11T16:54:49.970

我相信这在某种程度上可以帮助[cxx checker](https://gna.org/projects/cxxchecker)。另外这个工具似乎还不错[KWStyle](http://public.kitware.com/KWStyle/)它来自开发 Cmake 的人 Kitware。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-18T17:08:54.743

不完全是您所要求的，但我发现让所有人都同意[astyle](http://astyle.sourceforge.net/)可以生成的编码标准然后自动化该过程更容易。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-11-22T23:12:07.617

尝试[nsiqcppstyle](http://code.google.com/p/nsiqcppstyle/)。它是一个基于 Python 的 C/C++ 编码风格检查器。很容易扩展以添加您自己的规则。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-18T15:03:05.170

有一个[清单](http://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis#C.2B.2B)。splint 上还有一个假定的[C++ 前端](http://ostatic.com/splintpp)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T15:02:37.043

我在工作中使用了一个工具，它的[LDRA 工具套件](http://www.ldra.co.uk/testbed.asp)

它用于测试 c/c++ 代码，但它也可以检查编码标准，如 MISRA 等。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-27T10:21:23.963

检查[sourceforge.net](http://sourceforge.net)。`universalindentgui`_

它有许多 C 风格的检查器，您可以自定义检查器。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-15T21:53:42.743

*Hudson*通过同名插件也支持[cppcheck 。](http://sourceforge.net/apps/mediawiki/cppcheck/index.php?title=Main_Page)

 ** * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-08-12T10:46:06.110

检查 Metrix++ [http://metrixplusplus.sourceforge.net/](http://metrixplusplus.sourceforge.net/)。它可能需要一些特定于您需求的扩展。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-07T14:09:32.957

查看 Abraxas 代码检查 [http://www.abxsoft.com/codchk_user.html](http://www.abxsoft.com/codchk_user.html)

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-02-14T20:25:56.520

我目前正在与另一个项目一起编写这样一个工具的项目。我查看了其他静态代码分析工具，并决定我可以做得更好。

不幸的是，如果没有相当深入的代码知识，该项目还没有准备好使用（*阅读：它是地狱般的错误*）。但是，我们的进展相当迅速，并希望在接下来的 8 周内发布测试版。

该项目是开源的——[您可以访问项目页面](http://code.google.com/p/cppanalyse/)，如果您想参与其中，我们希望有更多的外部输入。

我不会让你厌烦细节——你可以[访问项目页面](http://code.google.com/p/cppanalyse/)，但我要说一件事：大多数静态代码分析工具旨在检查你的代码是否有错误，而不是非常关心检查编码指南。我们采用了一种更灵活的方法，允许我们编写插件来检查“房屋规则”以及可能的错误。

如果您想了解更多信息，请随时与我联系。

干杯，

# coff - 在 COFF 文件格式中，重定位信息部分的意义是什么？

> ID：93261
> 
> 赞同：4
> 
> 时间：2008-09-18T14:50:28.617
> 
> 标签：coff

我正在阅读 COFF 文件格式，它通常用于创建可执行文件格式（它也有一些变体）。

在阅读时，我遇到了格式的重定位部分。此重定位部分如何用于创建可执行文件。

如果您向我指出一些对我有帮助的链接，那将非常有用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-06-06T01:48:56.653

实际上，对于 COFF，有两种类型的重定位信息：

1.  COFF 搬迁记录
2.  可执行映像中的重定位部分。

它们有相似但不同的目的。如果可执行映像加载到与其首选地址不同的地址，则可执行文件中的重定位信息标识需要在加载时修复的内容。

COFF 重定位记录标识需要在链接时修复的内容，此时将目标文件中的部分分配给可执行映像中的偏移量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T14:58:46.023

重定位用于将可执行代码放置在进程中自己的内存空间中。例如，如果您尝试加载两个都请求相同基地址（即内存中的相同位置）的 dll，则必须将其中一个 dll 重新定位到另一个地址。 [NTCore](http://www.ntcore.com/)是探索可移植可执行文件 (PE) 文件的有用站点，这就是现在的 COFF。 [这](http://www.cim.mcgill.ca/~franco/OpSys-304-427/lecture-notes/node36.html)是另一个很好地解释搬迁的网站。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-15T19:12:13.503

重定位的一个意外添加使用是在运行时（去）混淆二进制文件，而不需要额外的解包代码。见[这篇论文](http://www.uninformed.org/?v=6&a=3&t=pdf)。

# sql-server - 如何在 SQL Server 中删除外键？

> ID：93264
> 
> 赞同：220
> 
> 时间：2008-09-18T14:50:36.493
> 
> 标签：sql-server, tsql

我通过以下方式创建了一个外键（在 SQL Server 中）：

```
alter table company add CountryID varchar(3);
alter table company add constraint Company_CountryID_FK foreign key(CountryID) 
references Country; 
```

然后我运行这个查询：

```
alter table company drop column CountryID; 
```

我得到这个错误：

> *消息 5074，级别 16，状态 4，第 2 行
> 对象“Company_CountryID_FK”依赖于列“CountryID”。
> 消息 4922，级别 16，状态 9，第 2 行
> ALTER TABLE DROP COLUMN CountryID 失败，因为一个或多个对象访问此列*

我已经尝试过了，但它似乎不起作用：

```
alter table company drop foreign key Company_CountryID_FK; 
alter table company drop column CountryID; 
```

我需要做什么才能删除该`CountryID`列？

谢谢。

* * *

## 回答 #1

> 赞同：337
> 
> 时间：2008-09-18T14:54:18.310

尝试

```
alter table company drop constraint Company_CountryID_FK

alter table company drop column CountryID 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-09-18T14:57:29.363

这将起作用：

```
ALTER TABLE [dbo].[company] DROP CONSTRAINT [Company_CountryID_FK] 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-12-31T12:45:01.363

我想这会对你有所帮助...

```
DECLARE @ConstraintName nvarchar(200)
SELECT 
    @ConstraintName = KCU.CONSTRAINT_NAME
FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS AS RC 
INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS KCU
    ON KCU.CONSTRAINT_CATALOG = RC.CONSTRAINT_CATALOG  
    AND KCU.CONSTRAINT_SCHEMA = RC.CONSTRAINT_SCHEMA 
    AND KCU.CONSTRAINT_NAME = RC.CONSTRAINT_NAME
WHERE
    KCU.TABLE_NAME = 'TABLE_NAME' AND
    KCU.COLUMN_NAME = 'TABLE_COLUMN_NAME'
IF @ConstraintName IS NOT NULL EXEC('alter table TABLE_NAME drop  CONSTRAINT ' + @ConstraintName) 
```

它将根据特定的表和列删除外键约束。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2014-06-13T22:23:54.833

首先检查约束是否存在，然后将其删除。

```
if exists (select 1 from sys.objects where name = 'Company_CountryID_FK' and type='F')
begin
alter table company drop constraint  Company_CountryID_FK
end 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-09-18T14:56:47.417

```
alter table company drop constraint Company_CountryID_FK 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-18T14:56:00.723

我不知道 MSSQL 但它不会是：

```
alter table company drop **constraint** Company_CountryID_FK; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-06-01T17:37:46.770

您也可以右键单击表，选择修改，然后转到属性，右键单击它，然后选择删除主键。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-26T13:34:53.373

您是要删除 FK 约束还是列本身？

要删除约束：

```
alter table company drop constraint Company_CountryID_FK 
```

在删除约束之前，您将无法删除该列。

# css - MSIE 6 中的最小宽度

> ID：93274
> 
> 赞同：6
> 
> 时间：2008-09-18T14:52:26.443
> 
> 标签：css, internet-explorer, internet-explorer-6

在 Internet Explorer 6 中模仿 CSS 属性 min-width的*最终*方法是什么？最好不要尝试吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T14:54:47.497

```
foo { min-width: 100px }      // for everyone
* html foo { width: 100px }   // just for IE 
```

[（或使用条件注释](http://www.quirksmode.org/css/condcom.html)向 IE 提供单独的样式表）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-18T15:21:54.000

您可以使用表达式（如 HBoss 建议的那样），但如果您担心性能，那么最好的方法是在要应用最小宽度的元素内添加一个 shim。

```
<div id="container">
  The "shim" div will hold the container div open to at least 500px!
  You should be able to put it anywhere in the container div.
  <div class="shim">&nbsp;</div>
</div>

#container .shim {
  width: 500px;
  height: 0;
  line-height: 0;
} 
```

这需要一点非语义标记，但它是一个真正的跨浏览器解决方案，并且不需要使用表达式的开销。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T14:59:46.427

[这篇](http://www.cssplay.co.uk/boxes/minwidth.html)关于 CSS Play 的文章，作者 Stu Nicholls，展示了在 IE、所有模式（Quirks 等）甚至 IE/Mac 中实现最小宽度的不同方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T17:09:54.843

在过去的一个月里，我一直在摆弄这里给出的每一个答案。在玩过 Pretaul 的方法（[MSIE 6 中的 Min-width](https://stackoverflow.com/questions/93274/min-width-in-msie-6#93530)）之后，它似乎是 min-width 的最佳替代方案。没有 hack 或任何东西，只需 30 秒即可实现兼容的 CSS 代码。

从谷歌搜索来看，表情似乎是最受欢迎的。无论如何，对我来说，它倾向于随机锁定我的浏览器（IE 和 FF）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T17:52:02.000

我不知道，我在以下方面取得了一些成功：

```
 min-width: 193px;
    width:auto !important; 
    _width: 193px;  /* IE6 hack */ 
```

结合dustin diaz' min-height fast hack &[如何在HTML或CSS中指定表格单元格的绝对最小宽度](https://stackoverflow.com/questions/56658/how-do-i-specify-in-html-or-css-the-absolute-minimum-width-of-a-table-cell)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T14:53:45.520

将您的 css 标签设置为 _Width: 500px 或其他。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T14:56:04.703

这工作得很好......

```
div.container {
    min-width: 760px; 
    width:expression(document.body.clientWidth < 760? "760px": "auto" ); 
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T15:25:42.167

[最小高度快速破解](http://www.dustindiaz.com/min-height-fast-hack/)适用于我（也适用于宽度）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-23T19:44:03.767

shim 示例适用于在容器达到一定大小时强制浏览器显示水平滚动条，但您会注意到容器中的内容仍会随着窗口变小而调整大小。我想这不是尝试在 IE 6 中实现最小宽度时的总体目标。

[不完整的最小宽度技术 http://www.mediafire.com/imgbnc.php/260264acec99b5aba3e77c1c4cdc54e94g.jpg](http://www.mediafire.com/imgbnc.php/260264acec99b5aba3e77c1c4cdc54e94g.jpg)

此外，使用表达式和其他疯狂的 CSS hack 并不是好的做法。它们不安全也不干净。本文解释了 CSS hack 的注意[事项](http://www.digital-web.com/articles/keep_css_simple/)以及为什么应该完全避免它们。

我个人认为scarryjeff 的帖子是在 IE6 中实现真正最小宽度的最佳建议，作为一名经验丰富的 CSS 布局开发人员，我还没有找到适用于此类问题的更好解决方案。

> 这篇关于 CSS Play 的[文章](http://www.cssplay.co.uk/boxes/minwidth.html)，作者 Stu Nicholls，展示了在 IE、所有模式（Quirks 等）甚至 IE/Mac 中实现最小宽度的不同方法。

我提供了一个类似问题的答案，详细说明了如何使用这种技术来正确实现最小宽度。可以在这里查看：

[CSS：两个 50% 的流体列不考虑最小宽度](https://stackoverflow.com/questions/191429/css-two-50-fluid-columns-not-respecting-min-width#230152)

该技术是简单、有效的 CSS，几乎可以在任何情况下使用。应用于上面的垫片示例，它会产生我认为正确的最小宽度功能。

[正确的最小宽度技术 http://www.mediafire.com/imgbnc.php/a67b2820bfbd6a5b588bea23c4c0462f4g.jpg](http://www.mediafire.com/imgbnc.php/a67b2820bfbd6a5b588bea23c4c0462f4g.jpg)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-05T14:39:41.213

单行按钮

```
button{
background-color:#069;
float:left;
min-width:200px;
width:auto !important;
width:200px;
white-space: nowrap} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-09-23T14:02:48.087

使用条件注释来引用和 MSIE 6 特定样式表，然后按如下方式创建 CSS。

兼容的浏览器将使用：

```
min-width: 660px; 
```

然后 MSIE 6 将使用：

```
width: expression((document.body.clientWidth < 659)? "660px" : "auto"); 
```

# ruby-on-rails - ActiveRecord::MultiparameterAssignmentErrors 是什么意思？

> ID：93277
> 
> 赞同：15
> 
> 时间：2008-09-18T14:53:00.810
> 
> 标签：ruby-on-rails, forms, datetime-select, multiparameter

我有一个带有 datetime_select 字段的 rails 表单。当我尝试提交表单时，出现以下异常：

```
ActiveRecord::MultiparameterAssignmentErrors in WidgetsController#update 
1 error(s) on assignment of multiparameter attributes 
```

如果是验证错误，为什么我在页面上看不到错误？

这是在 Rails 2.0.2 中

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T14:57:42.030

事实证明，rails 使用称为多参数分配的东西来传输小部分的日期和时间，当您将参数分配给模型实例时，这些小部分会重新组合。

我的问题是我使用 datetime_select 表单字段作为日期模型字段。当多参数魔法试图在 Date 对象上设置时间时，它显然会窒息。

解决方案是使用`date_select`表单字段而不是`datetime_select`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-02-11T18:08:30.377

超级黑客，但我需要立即为客户项目解决这个问题。它仍然是 Rails 2.3.5 的一个错误。

使用`date_select`or `datetime_select`，如果在`initialize`方法中将其添加到模型中，则可以预先解析传递的表单序列化属性以使其工作：

```
def initialize(attributes={})
  date_hack(attributes, "deliver_date")
  super(attributes)
end

def date_hack(attributes, property)
  keys, values = [], []
  attributes.each_key {|k| keys << k if k =~ /#{property}/ }.sort
  keys.each { |k| values << attributes[k]; attributes.delete(k); }
  attributes[property] = values.join("-")
end 
```

我将它与嵌套的多态模型一起使用。 [这是一个问题，我展示了我正在使用的模型](https://stackoverflow.com/questions/2234077/restfully-destroy-polymorphic-association-in-rails)。所以我需要`accepts_nested_attributes_for`一个日期时间。

这是使用控制台的输入和输出：

```
e = Event.last
=> #<Event id: 1052158304 ...>
e.model_surveys
=> []
e.model_surveys_attributes = [{"survey_id"=>"864743981", "deliver_date(1i)"=>"2010", "deliver_date(2i)"=>"2", "deliver_date(3i)"=>"11"}]
PRE ATTRIBUTES: {"survey_id"=>"864743981", "deliver_date(1i)"=>"2010", "deliver_date(2i)"=>"2", "deliver_date(3i)"=>"11"}
# run date_hack
POST ATTRIBUTES: {"survey_id"=>"864743981", "deliver_date"=>"2010-2-11"}
e.model_surveys
=> [#<ModelSurvey id: 121, ..., deliver_date: "2010-02-11 05:00:00">]
>> e.model_surveys.last.deliver_date.class
=> ActiveSupport::TimeWithZone 
```

否则它要么为空，要么会抛出错误：

`1 error(s) on assignment of multiparameter attributes`

希望有帮助，兰斯

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-02-11T01:46:52.660

这不是 Rails 中的错误，它是多参数属性编写器的预期行为。我敢打赌，数据库中原始发帖人的 Deliver_date 字段是 varchar，而不是 date 或 datetime 类型。ActiveRecord 使用多参数属性的每一部分发送给序列化类型的新方法。数字 1、2、3 等表示构造函数参数位置，“i”告诉 ActiveRecord 在将参数传递给构造函数之前调用 to_i 参数。在这种情况下，它们都是“i”，因为 DateTime.new(year, month, day) 需要三个整数而不是三个字符串。

如果数据库中的 Deliver_date 列不是序列化为 DateTime 的类型，则 ActiveRecord 将抛出 ActiveRecord::MultiparameterAssignmentErrors 异常，因为 String.new(2010,2,11) 不会成功。

来源： [https ://github.com/rails/rails/blob/v3.0.4/activerecord/lib/active_record/base.rb#L1739](https://github.com/rails/rails/blob/v3.0.4/activerecord/lib/active_record/base.rb#L1739)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-09T04:39:34.603

当您尝试为模型属性设置无效日期时，ActiveRecord 会引发 MultiparameterAssignmentErrors 异常。

尝试从 date_select 或 datetime_select 下拉列表中选择 11 月 31 日的日期，您将收到此错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-17T09:50:21.240

像 Zubin 一样，当表单提交月份作为月份名称而不是数字月份字符串（例如，十月而不是 10）时，我已经看到了这个异常。

我遇到的一个用户代理似乎提交了选项标签的内容而不是值属性：

> Mozilla/5.0 (SymbianOS/9.2; U; Series60/3.1 NokiaE66-1/300.21.012; Profile/MIDP-2.0 Configuration/CLDC-1.1) AppleWebKit/413 (KHTML, like Gecko) Safari/413

因此，在从助手生成的选择（来自 date_select 助手）提交多参数日期的情况下，您的参数将具有：

```
"event"=> {
    "start_on(2i)"=>"October",
    "start_on(3i)"=>"19",
    "start_on(1i)"=>"2010"
} 
```

这会产生一个异常：*ActiveRecord::MultiparameterAssignmentErrors: 1 error(s) on assignment of multiparameter attributes*

大多数用户代理会正确提交：

```
"event"=> {
    "start_on(2i)"=>"10",
    "start_on(3i)"=>"19",
    "start_on(1i)"=>"2010"
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-08T20:48:47.403

使用表格填写表单数据时，webrat/cucumber 也会出现此错误。

例如，这不起作用：

```
When I fill in the following:
  | report_from_1i | 2010     |
  | report_from_2i | January  |
  | report_from_3i | 1        |
  | report_to_1i   | 2010     |
  | report_to_2i   | February |
  | report_to_3i   | 1        | 
```

但这确实：

```
When I fill in the following:
  | report_from_1i | 2010 |
  | report_from_2i | 1    |
  | report_from_3i | 1    |
  | report_to_1i   | 2010 |
  | report_to_2i   | 2    |
  | report_to_3i   | 1    | 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-04T13:49:36.170

在我的情况下，ActiveRecord am/pm 插件通过错误导致错误`alias_method_chain`导致`StackLevelTooDeep`异常。

该插件包含在 unobtrusive_date_picker 插件中。

在破解之前对此进行调查。

# php - 如何创建一个快速的 PHP 库？

> ID：93279
> 
> 赞同：1
> 
> 时间：2008-09-18T14:53:15.067
> 
> 标签：php, include

对于我们的在线游戏，我们在文件和文件夹中编写了大量按主题分组的 PHP 类和函数。最后，我们现在将所有后端代码（逻辑和数据库访问层）放在一组我们称为**库**的文件中，并使用*include_once('pathtolib/file.公司'）*。

问题是我们对包含很懒惰，并且大多数包含语句都是在我们的 libs 文件中进行的，因此从每个网页中，每次我们包含任何 libs 文件时，我们实际上是逐个文件加载整个 libs。

这对性能有很大的影响。因此，最好的解决方案是什么？

*   从 libs 文件中删除所有包含语句，只从网页中调用必要的语句？
*   做点别的吗？

服务器使用经典的 LAMP 堆栈 (PHP5)。

编辑：我们混合了简单的函数（遗留原因和大部分代码）和类。所以自动加载是不够的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T14:55:59.570

如果您以面向对象的方式进行编程，则可以使用[自动加载](http://us2.php.net/autoload)功能，该功能会在您调用类时按需从源文件中加载类。

**编辑**：我注意到有人对提到自动加载的两个答案都投了反对票。我们错了吗？__autoload 函数的开销是否太高而无法将其用于性能目的？如果有什么我没有意识到这种技术，我真的很想知道它是什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T15:05:11.670

如果你想获得真正的硬核，请进行一些静态分析，并准确找出何时需要哪些库，并且只包含这些库。

如果您使用`include`and not `include_once`，那么那里也可以节省一些速度。

综上所述，Matt 关于 Zend Optimizer 的回答是正确的。如果您愿意，请尝试免费的高级 PHP 缓存 (APC)，它是一种操作码缓存。它应该在 PECL 存储库中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T15:07:40.400

*   仅在需要时手动管理所有包含
*   将您的 include_path 设置为它必须在的位置，默认值类似于 .:/usr/lib/pear/:/usr/lib/php，仅将它指向它必须在的位置，php.net/set_include_path
*   不要使用自动加载，它很慢并且使 APC 和等效的缓存作业变得更加困难
*   您可以关闭 APC 中的“stat”操作，但每次更新文件时都必须手动清除缓存

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T15:13:44.707

您可以使用 spl_autoload_register() 或 __autoload() 来创建包含类所需文件的任何规则，但是自动加载会引入其自身的性能开销。您需要确保使用 php.ini 设置或 apache 配置将您使用的任何内容添加到所有 gui 页面。

对于具有通用函数的文件，我建议您将它们包装在一个实用程序类中并进行简单的查找和替换，以用 util::function() 替换所有 function() 调用，这样您就可以自动加载这些函数（同样，调用方法而不是全局函数会产生开销）。

本质上，最好的办法是回顾您的代码并通过修复包含问题来偿还您的设计债务。这将为您带来最大的性能优势，并允许您充分利用 eAccelerator、Zend Platform 和 APC 等优化器

这是动态加载内容的示例方法

```
public static function loadClass($class)
{
    if (class_exists($class, false) ||
        interface_exists($class, false))
    {
        return;
    }

    $file = YOUR_LIB_ROOT.str_replace('_', DIRECTORY_SEPARATOR, $class).'.php';

    if (file_exists($file))
    {
        include_once $file;
        if (!class_exists($class, false) &&
            !interface_exists($class, false))
        {
            throw new Exception('File '.$file.' was loaded but class '.$class.' was not found');
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T20:31:56.830

您正在寻找的是[Automap PECL 扩展](http://pecl.php.net/package/automap "自动地图")。

它基本上允许自动加载，只需加载预先计算的地图文件的一小部分开销。如果您知道特定目录只会从某些 PHP 文件中提取，您也可以细分地图文件。

[你可以在这里](http://phk.tekwire.net/joomla/support/doc/automap.htm "这里")阅读更多关于它的信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T15:00:11.993

我使用 php 已经有一段时间了，但在这种情况下 Zend Optimizer 或 Cache 不应该提供帮助吗？php 是否仍然为每个请求再次加载和编译每个包含的文件？

我不确定自动加载是否是答案。如果包含这些文件，则可能在包含它的类中需要它们，因此它们仍然会被自动加载。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T15:06:36.470

使用字节码缓存（最好是 APC），这样 PHP 就不需要在每次页面加载时解析库。[请注意，使用自动加载将抵消使用字节码缓存的好处（您可以在此处](http://pooteeweet.org/blog/538/)阅读有关此内容的更多信息）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T20:00:00.680

使用[分析器](http://www.xdebug.org/docs/profiler)。如果你试图在没有措施的情况下进行优化，你就是在盲目地工作。

# java-me - 用于减少大小的最佳 Java 混淆应用程序

> ID：93290
> 
> 赞同：4
> 
> 时间：2008-09-18T14:54:11.430
> 
> 标签：java-me, mobile, obfuscation

移动开发的一个重要部分，尤其是当您谈论移动游戏时，就是处理应用程序大小的限制。一些设备强制执行自己的尺寸限制，而所有运营商都有自己的尺寸要求，以便在其平台空间中发布应用程序。

我的问题是，是否有一个 java 混淆应用程序比现有的其他 java 混淆应用程序获得更好的大小缩减结果？

我使用 Proguard 是因为它是默认的 Netbeans 混淆器，您可以从中获得相当好的尺寸缩减结果（顺便说一下，Netbeans 6.1 附带的 Proguard 版本是 3.7。有更新的版本可以获得更好的结果，我建议获取最新的）。但是，我对那里还有什么以及他们是否比 Proguard 做得更好感兴趣。

**我的结论：**

我很欣赏这些回应。Carlos，你的回答足以让我相信 Proguard 是当前的发展方向。否则我仍然可以相信，但不要对我目前的设置感到难过。

我也遇到了一些关于 proguard 混淆和在某些手机上运行的问题，但不是太多。我总是能够通过不使用 Proguard 参数“-overloadaggressively”来解决问题。如果您遇到与混淆相关的奇怪行为，请记住一些事情。

再次感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T14:56:09.117

我也更喜欢 ProGuard，因为它的尺寸减小和混淆的广度 - 请参阅[http://proguard.sourceforge.net/](http://proguard.sourceforge.net/)。除了下载速度之外，我不一定有大小限制，但没有发现任何进一步缩小的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T20:34:39.380

当谈到 J2ME 和混淆时，谨慎一点是值得的。Proguard 是最佳选择，因为它已经开发了多年，并且收到了许多错误修正。我记得 2.X 和 3.X 之间的版本转换以及它如何破坏了我（当时）雇主的许多构建。发生这种情况是因为一些能够节省更多大小的更改也在某些手机中以微妙的方式破坏了类文件，而在其他手机和桌面 JVM 上却完全正常。

如今，Proguard 3.11 是混淆器中最安全的选择。如果您不必支持非常旧的手机，4.XX 可能会很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-13T11:57:10.230

奇怪的是，没有人记得 ProGuard 不仅可以缩小和混淆代码，还可以优化。最后一个版本允许指定多个通道进行优化（默认情况下只有一个通道），我可以指定，比如说，9 个通道。

在我反编译我的类后，我几乎认不出它们了，ProGuard 重组了很多方法调用。只需稍微调整一下这个出色的应用程序。所以我认为 ProGuard 是要走的路，只是别忘了稍微调整一下。它也有一个很好的[手册](http://proguard.sourceforge.net/manual/index.html)。

# .net - IIS 中 .NET 代码的堆栈溢出，但 Winforms 中没有

> ID：93294
> 
> 赞同：4
> 
> 时间：2008-09-18T14:54:23.117
> 
> 标签：.net, debugging, iis, stack, windbg

所以我有一个令人讨厌的堆栈溢出，我在过去 8 小时左右一直试图追踪/解决，我正处于我认为我需要建议的地步。

细节：有趣的是，当在我们的常规 winforms 应用程序的上下文中调用时，这段代码运行良好——但我的任务是编写我们软件的基于 Web 的版本，当从在 IIS 上运行的 ASPX 页面。我做的第一件事是附加并尝试通过 Visual Studio 进行正常的 .NET 调试。在异常点，调用堆栈似乎相对较浅（我们的代码大约 11 帧深），我找不到堆栈溢出的常见嫌疑人（错误的递归、自调用构造函数、异常循环）。

所以我放弃了自己去打破windbg和SOS——我知道这对这类事情很有用，尽管我自己的经验有限。经过几个小时的闲逛，我想我有一些有用的数据，但我需要一些帮助来分析它。

首先是一个!dumpstack，我在堆栈溢出即将下降之前被破坏了。

```
0:015> !dumpstack
PDB symbol for mscorwks.dll not loaded
OS Thread Id: 0x1110 (15)
Current frame: ntdll!KiFastSystemCallRet
ChildEBP RetAddr  Caller,Callee
01d265a8 7c827d0b ntdll!NtWaitForSingleObject+0xc
01d265ac 77e61d1e kernel32!WaitForSingleObjectEx+0x88, calling ntdll!NtWaitForSingleObject
01d2661c 79e789c6 mscorwks!LogHelp_NoGuiOnAssert+0x58ca
01d26660 79e7898f mscorwks!LogHelp_NoGuiOnAssert+0x5893, calling mscorwks!LogHelp_NoGuiOnAssert+0x589b
01d26680 79e734c4 mscorwks!LogHelp_NoGuiOnAssert+0x3c8, calling mscorwks+0x17c0
01d26694 79fc1d6b mscorwks!CorExeMain+0x8724, calling kernel32!InterlockedDecrement
01d26698 79ef3892 mscorwks!GetCLRFunction+0x107de, calling mscorwks+0x17c0
01d266b0 79e78944 mscorwks!LogHelp_NoGuiOnAssert+0x5848, calling mscorwks!LogHelp_NoGuiOnAssert+0x584c
01d266c4 7a14de5d mscorwks!CorLaunchApplication+0x2f243, calling mscorwks!LogHelp_NoGuiOnAssert+0x5831
01d266ec 77e61d1e kernel32!WaitForSingleObjectEx+0x88, calling ntdll!NtWaitForSingleObject
01d266f8 77e61d43 kernel32!WaitForSingleObjectEx+0xad, calling kernel32!GetTickCount+0x73
01d26714 7c8279bb ntdll!NtSetEvent+0xc
01d26718 77e62321 kernel32!SetEvent+0x10, calling ntdll!NtSetEvent
01d26748 7a14df79 mscorwks!CorLaunchApplication+0x2f35f, calling mscorwks!CorLaunchApplication+0x2f17c
01d2675c 7a022dde mscorwks!NGenCreateNGenWorker+0x4516b, calling mscorwks!CorLaunchApplication+0x2f347
01d26770 79fbc685 mscorwks!CorExeMain+0x303e, calling mscorwks+0x1bbe
01d26788 79e734c4 mscorwks!LogHelp_NoGuiOnAssert+0x3c8, calling mscorwks+0x17c0
01d2678c 79e734f2 mscorwks!LogHelp_NoGuiOnAssert+0x3f6, calling mscorwks!LogHelp_NoGuiOnAssert+0x380
01d267a8 7a2d259e mscorwks!CreateHistoryReader+0xafd3
01d267b4 7a2e6292 mscorwks!CreateHistoryReader+0x1ecc7, calling mscorwks!CreateHistoryReader+0xaf9d
01d26814 7a064d52 mscorwks!NGenCreateNGenWorker+0x870df, calling mscorwks!CreateHistoryReader+0x1eb43
01d26854 79f91643 mscorwks!ClrCreateManagedInstance+0x46ff, calling mscorwks!ClrCreateManagedInstance+0x4720
01d2688c 79f915c4 mscorwks!ClrCreateManagedInstance+0x4680
01d268b4 79e734c4 mscorwks!LogHelp_NoGuiOnAssert+0x3c8, calling mscorwks+0x17c0
01d268cc 79f04e98 mscorwks!GetCLRFunction+0x21de4, calling mscorwks!GetCLRFunction+0x21e4b
01d26900 79f0815e mscorwks!GetCLRFunction+0x250aa, calling mscorwks!GetCLRFunction+0x21d35
01d2691c 7c858135 ntdll!RtlIpv4StringToAddressExW+0x167b7, calling ntdll!RtlReleaseResource
01d2692c 79f080a7 mscorwks!GetCLRFunction+0x24ff3, calling mscorwks!GetCLRFunction+0x25052
01d26950 7c828752 ntdll!RtlRaiseStatus+0xe0
01d26974 7c828723 ntdll!RtlRaiseStatus+0xb1, calling ntdll!RtlRaiseStatus+0xba
01d26998 7c8315c2 ntdll!RtlSubtreePredecessor+0x208, calling ntdll!RtlRaiseStatus+0x7e
01d26a1c 7c82855e ntdll!KiUserExceptionDispatcher+0xe, calling ntdll!RtlSubtreePredecessor+0x17c
01d26d20 13380333 (MethodDesc 0x10936710 +0x243 ASI.ParadigmPlus.LoadedWindows.WID904.QuestionChangeLogic(ASI.ParadigmPlus.Question, ASI.ParadigmPlus.Question)) ====> Exception Code 0 cxr@1d26a54 exr@1d26000
01d26bd8 77e64590 kernel32!VirtualAllocEx+0x4b, calling kernel32!GetTickCount+0x73
01d26bec 7c829f59 ntdll!RtlFreeHeap+0x142, calling ntdll!CIpow+0x464
01d26bf0 79e78d11 mscorwks!LogHelp_NoGuiOnAssert+0x5c15, calling ntdll!RtlFreeHeap
01d3e86c 103b4064 (MethodDesc 0xf304c90 +0x174 ASI.ParadigmPlus.Window.TrackQuestionChange(ASI.ParadigmPlus.Question, ASI.ParadigmPlus.Answer))
01d3e88c 103b4064 (MethodDesc 0xf304c90 +0x174 ASI.ParadigmPlus.Window.TrackQuestionChange(ASI.ParadigmPlus.Question, ASI.ParadigmPlus.Answer))
01d3e8b0 103b3e6b (MethodDesc 0xebb4b38 +0x23 ASI.CommonLibrary.ASIArrayList3.get_Item(Int32))
01d3e8d4 103b3d70 (MethodDesc 0xf304e98 +0x1b0 ASI.ParadigmPlus.Window.TrackQuestionChange())
01d3e910 0f90febf (MethodDesc 0xf30d250 +0x190f ASI.ParadigmPlus.Data.RemoteDataAccess.GetWindow(Int32))
01d3ec0c 10a2a572 (MethodDesc 0x10935aa0 +0x1f2 ASI.ParadigmPlus.LoadedWindowSets.WSID904.ApplyLayoutChanges()), calling 02259472
01d3ecec 0f90c880 (MethodDesc 0xebb91f8 +0xe8 ASI.ParadigmPlus.Windowset.ApplyLayoutChangesWrap())
01d3ed0c 0f90c880 (MethodDesc 0xebb91f8 +0xe8 ASI.ParadigmPlus.Windowset.ApplyLayoutChangesWrap())
01d3ed54 0f4d2388 (MethodDesc 0x22261a0 +0x5e8 WebConfigurator.NewDefault.ProductSelectedIndexChange(Int32, Int32))
01d3f264 0f4d1d7f (MethodDesc 0x2226180 +0x47 WebConfigurator.NewDefault.btnGo_Click1(System.Object, System.EventArgs)), calling (MethodDesc 0x22261a0 +0 WebConfigurator.NewDefault.ProductSelectedIndexChange(Int32, Int32))
01d3f284 0e810a05 (MethodDesc 0x22260f8 +0x145 WebConfigurator.NewDefault.Page_Load(System.Object, System.EventArgs)), calling (MethodDesc 0x2226180 +0 WebConfigurator.NewDefault.btnGo_Click1(System.Object, System.EventArgs))
01d3f2a8 793ae896 (MethodDesc 0x79256848 +0x52 System.MulticastDelegate.RemoveImpl(System.Delegate))
01d3f2ac 79e7bee8 mscorwks!LogHelp_TerminateOnAssert+0x2bd0, calling mscorwks!LogHelp_TerminateOnAssert+0x2b60
01d3f2c4 66f12980 (MethodDesc 0x66f1bcd0 +0x10 System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr, System.Object, System.Object, System.EventArgs))
01d3f2d0 6628efd2 (MethodDesc 0x66474328 +0x22 System.Web.Util.CalliEventHandlerDelegateProxy.Callback(System.Object, System.EventArgs)), calling (MethodDesc 0x66f1bcd0 +0 System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr, System.Object, System.Object, System.EventArgs))
01d3f2e4 6613cb04 (MethodDesc 0x66468a58 +0x64 System.Web.UI.Control.OnLoad(System.EventArgs))
01d3f2f8 6613cb50 (MethodDesc 0x66468a60 +0x30 System.Web.UI.Control.LoadRecursive())
01d3f30c 6614e12d (MethodDesc 0x66467688 +0x59d System.Web.UI.Page.ProcessRequestMain(Boolean, Boolean))
01d3f4e0 6614c717 (MethodDesc 0x66467430 +0x63 System.Web.UI.Page.AddWrappedFileDependencies(System.Object)), calling (MethodDesc 0x66478de8 +0 System.Web.ResponseDependencyList.AddDependencies(System.String[], System.String, Boolean, System.String))
01d3f504 6614d8c3 (MethodDesc 0x66467650 +0x67 System.Web.UI.Page.ProcessRequest(Boolean, Boolean)), calling (MethodDesc 0x66467688 +0 System.Web.UI.Page.ProcessRequestMain(Boolean, Boolean))
01d3f528 79371311 (MethodDesc 0x7925ac80 +0x25 System.Globalization.CultureInfo.get_UserDefaultUICulture()), calling  (JitHelp: CORINFO_HELP_GETSHARED_GCSTATIC_BASE)
01d3f53c 6614d80f (MethodDesc 0x66467648 +0x57 System.Web.UI.Page.ProcessRequest()), calling (MethodDesc 0x66467650 +0 System.Web.UI.Page.ProcessRequest(Boolean, Boolean))
01d3f560 6615055c (MethodDesc 0x664676f0 +0x184 System.Web.UI.Page.SetIntrinsics(System.Web.HttpContext, Boolean)), calling (MethodDesc 0x664726b0 +0 System.Web.UI.TemplateControl.HookUpAutomaticHandlers())
01d3f578 6614d72f (MethodDesc 0x66467630 +0x13 System.Web.UI.Page.ProcessRequestWithNoAssert(System.Web.HttpContext)), calling (MethodDesc 0x66467648 +0 System.Web.UI.Page.ProcessRequest())
01d3f580 6614d6c2 (MethodDesc 0x66467620 +0x32 System.Web.UI.Page.ProcessRequest(System.Web.HttpContext)), calling (MethodDesc 0x66467630 +0 System.Web.UI.Page.ProcessRequestWithNoAssert(System.Web.HttpContext))
01d3f594 0e810206 (MethodDesc 0x22265a0 +0x1e ASP.newdefault_aspx.ProcessRequest(System.Web.HttpContext)), calling (MethodDesc 0x66467620 +0 System.Web.UI.Page.ProcessRequest(System.Web.HttpContext))
01d3f5a0 65fe6bfb (MethodDesc 0x66470fc0 +0x167 System.Web.HttpApplication+CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()), calling 01dee5da
01d3f5d4 65fe3f51 (MethodDesc 0x6642f090 +0x41 System.Web.HttpApplication.ExecuteStep(IExecutionStep, Boolean ByRef)), calling 01de7d0a
01d3f610 65fe7733 (MethodDesc 0x66470cd0 +0x1b3 System.Web.HttpApplication+ApplicationStepManager.ResumeSteps(System.Exception)), calling (MethodDesc 0x6642f090 +0 System.Web.HttpApplication.ExecuteStep(IExecutionStep, Boolean ByRef))
01d3f64c 7939eef2 (MethodDesc 0x7925eda8 +0x26 System.Runtime.InteropServices.GCHandle.Alloc(System.Object)), calling mscorwks!InstallCustomModule+0x1e8d
01d3f664 65fccbfe (MethodDesc 0x6642ebb0 +0x8e System.Web.HttpApplication.System.Web.IHttpAsyncHandler.BeginProcessRequest(System.Web.HttpContext, System.AsyncCallback, System.Object))
01d3f678 65fd19c5 (MethodDesc 0x6642cde8 +0x1b5 System.Web.HttpRuntime.ProcessRequestInternal(System.Web.HttpWorkerRequest)), calling 01de7cba
01d3f69c 7938111c (MethodDesc 0x79262df0 +0xc System.DateTime.get_UtcNow()), calling mscorwks!GetCLRFunction+0x109f9
01d3f6a4 01c32cbc 01c32cbc, calling 01daa248
01d3f6b4 65fd16b2 (MethodDesc 0x664619e0 +0x62 System.Web.HttpRuntime.ProcessRequestNoDemand(System.Web.HttpWorkerRequest)), calling (MethodDesc 0x6642cde8 +0 System.Web.HttpRuntime.ProcessRequestInternal(System.Web.HttpWorkerRequest))
01d3f6c0 65fcfa6d (MethodDesc 0x6642d4a0 +0xfd System.Web.Hosting.ISAPIRuntime.ProcessRequest(IntPtr, Int32)), calling (MethodDesc 0x664619e0 +0 System.Web.HttpRuntime.ProcessRequestNoDemand(System.Web.HttpWorkerRequest))
01d3f6d8 65fcf9f4 (MethodDesc 0x6642d4a0 +0x84 System.Web.Hosting.ISAPIRuntime.ProcessRequest(IntPtr, Int32)), calling *** ERROR: Symbol file could not be found.  Defaulted to export symbols for \\?\C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\webengine.dll - 
webengine!GetEcb
01d3f710 79f047fd mscorwks!GetCLRFunction+0x21749
01d3f720 01c32cbc 01c32cbc, calling 01daa248
01d3f730 79f047fd mscorwks!GetCLRFunction+0x21749
01d3f75c 79f01621 mscorwks!GetCLRFunction+0x1e56d, calling mscorwks+0x1b86
01d3f770 79ef98cf mscorwks!GetCLRFunction+0x1681b, calling mscorwks!GetCLRFunction+0x1682f
01d3f7d0 79e74f98 mscorwks!LogHelp_NoGuiOnAssert+0x1e9c, calling mscorwks!LogHelp_NoGuiOnAssert+0x1ec1
01d3f7e8 79f0462c mscorwks!GetCLRFunction+0x21578, calling mscorwks!GetCLRFunction+0x215b0
01d3f7f8 01c32cbc 01c32cbc, calling 01daa248
01d3f844 79f044fa mscorwks!GetCLRFunction+0x21446, calling mscorwks!GetCLRFunction+0x21541
01d3f854 01c32cbc 01c32cbc, calling 01daa248
01d3f898 660167e9 (MethodDesc 0x6646f6b0 +0x5 System.Web.RequestQueue.TimerCompletionCallback(System.Object)), calling (MethodDesc 0x6646f698 +0 System.Web.RequestQueue.ScheduleMoreWorkIfNeeded())
01d3f89c 793af6c6 (MethodDesc 0x792672b0 +0x1a System.Threading._TimerCallback.TimerCallback_Context(System.Object))
01d3f8b4 793af647 (MethodDesc 0x7914fc18 +0x5b System.Threading._TimerCallback.PerformTimerCallback(System.Object)), calling (MethodDesc 0x7914e0d8 +0 System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object))
01d3f8b8 793af654 (MethodDesc 0x7914fc18 +0x68 System.Threading._TimerCallback.PerformTimerCallback(System.Object)), calling mscorwks!LogHelp_TerminateOnAssert
01d3f8f8 79e74466 mscorwks!LogHelp_NoGuiOnAssert+0x136a, calling mscorwks+0x1813
01d3f8fc 79e7c709 mscorwks!LogHelp_TerminateOnAssert+0x33f1, calling mscorwks!LogHelp_NoGuiOnAssert+0x1360
01d3f964 7c829f3d ntdll!RtlFreeHeap+0x126, calling ntdll!RtlGetNtGlobalFlags+0x12
01d3f96c 7c829f59 ntdll!RtlFreeHeap+0x142, calling ntdll!CIpow+0x464
01d3f9ac 6a2a9998 webengine!CSharelock::ChangeExclusiveLockToSharedLock+0x2d, calling kernel32!InterlockedCompareExchange
01d3f9b4 6a2ab03b webengine!EcbGetUnicodeServerVariables+0x3d5, calling kernel32!InterlockedIncrement
01d3f9f4 01c32cbc 01c32cbc, calling 01daa248
01d3fa28 01daa295 01daa295, calling mscorwks!GetCLRFunction+0x2119e
01d3fa50 6a2aa63f webengine!CookieAuthConstructTicket+0x232
01d3fa6c 01c32cbc 01c32cbc, calling 01daa248
01d3fa70 6a2aa63f webengine!CookieAuthConstructTicket+0x232
01d3fac8 79e734c4 mscorwks!LogHelp_NoGuiOnAssert+0x3c8, calling mscorwks+0x17c0
01d3facc 79e734f2 mscorwks!LogHelp_NoGuiOnAssert+0x3f6, calling mscorwks!LogHelp_NoGuiOnAssert+0x380
01d3fad8 79f00c03 mscorwks!GetCLRFunction+0x1db4f, calling mscorwks!LogHelp_NoGuiOnAssert+0xf0
01d3fadc 79e71b90 mscorwks+0x1b90, calling mscorwks+0x1813
01d3fae0 79f00c0b mscorwks!GetCLRFunction+0x1db57, calling mscorwks+0x1b86
01d3fb1c 79ef30c3 mscorwks!GetCLRFunction+0x1000f, calling mscorwks!GetCLRFunction+0x10040
01d3fb64 79f00c0b mscorwks!GetCLRFunction+0x1db57, calling mscorwks+0x1b86
01d3fb68 79f02a93 mscorwks!GetCLRFunction+0x1f9df, calling mscorwks!GetCLRFunction+0x1d8e5
01d3fb70 79e71b90 mscorwks+0x1b90, calling mscorwks+0x1813
01d3fb74 79f02aa7 mscorwks!GetCLRFunction+0x1f9f3, calling mscorwks+0x1b86
01d3fb88 79f00e8d mscorwks!GetCLRFunction+0x1ddd9, calling mscorwks+0x18bb
01d3fb8c 79f00f03 mscorwks!GetCLRFunction+0x1de4f, calling mscorwks!GetCLRFunction+0x1dd84
01d3fbc0 79f02978 mscorwks!GetCLRFunction+0x1f8c4, calling mscorwks!GetCLRFunction+0x1de1a
01d3fbfc 79e73220 mscorwks!LogHelp_NoGuiOnAssert+0x124, calling  (JitHelp: CORINFO_HELP_GET_THREAD)
01d3fc08 79ef2884 mscorwks!GetCLRFunction+0xf7d0, calling mscorwks!LogHelp_NoGuiOnAssert+0x118
01d3fc0c 79ef28ab mscorwks!GetCLRFunction+0xf7f7, calling mscorwks+0x17c0
01d3fc24 79e7904f mscorwks!LogHelp_NoGuiOnAssert+0x5f53, calling mscorwks+0x1b95
01d3fc38 79ef31ca mscorwks!GetCLRFunction+0x10116, calling mscorwks!LogHelp_NoGuiOnAssert+0x5f3d
01d3fc3c 79e71b90 mscorwks+0x1b90, calling mscorwks+0x1813
01d3fc40 79ef31d9 mscorwks!GetCLRFunction+0x10125, calling mscorwks+0x1b86
01d3fc90 7c829fb5 ntdll!RtlGetNtGlobalFlags+0x38, calling ntdll!ExpInterlockedPopEntrySListEnd+0x11
01d3fc94 7c827d0b ntdll!NtWaitForSingleObject+0xc
01d3fc98 77e61d1e kernel32!WaitForSingleObjectEx+0x88, calling ntdll!NtWaitForSingleObject
01d3fca4 77e61d43 kernel32!WaitForSingleObjectEx+0xad, calling kernel32!GetTickCount+0x73
01d3fdb4 6a2aa748 webengine!CookieAuthConstructTicket+0x33b, calling webengine!CookieAuthConstructTicket+0x11d
01d3fdc4 6a2aa715 webengine!CookieAuthConstructTicket+0x308
01d3fddc 79f024cf mscorwks!GetCLRFunction+0x1f41b
01d3fdf4 79ef3a3f mscorwks!GetCLRFunction+0x1098b, calling mscorwks+0x17c0
01d3fe28 79f0202a mscorwks!GetCLRFunction+0x1ef76
01d3fe3c 79f021a0 mscorwks!GetCLRFunction+0x1f0ec, calling mscorwks!GetCLRFunction+0x1eef9
01d3fe94 79fc9840 mscorwks!CorExeMain+0x101f9
01d3ffa4 79fc982e mscorwks!CorExeMain+0x101e7, calling mscorwks!LogHelp_NoGuiOnAssert+0x61c0
01d3ffb8 77e64829 kernel32!GetModuleHandleA+0xdf 
```

那里有很多东西，但在我的（诚然有限的）堆栈分析知识中没有任何东西表明循环。我认为下一节可能有一些价值。这是我在同一断点处得到的 !dumpstackobjects ：

```
0:000> ~16e !dumpstackobjects
OS Thread Id: 0x172c (16)
ESP/REG  Object   Name
01d0ee30 0295ef60 ASI.ParadigmPlus.LoadedWindows.WID904
01d0ef68 0295ef60 ASI.ParadigmPlus.LoadedWindows.WID904
01d0ef6c 0295ef60 ASI.ParadigmPlus.LoadedWindows.WID904
01d0ef74 0295ef60 ASI.ParadigmPlus.LoadedWindows.WID904
01d0f280 0295f810 ASI.ParadigmPlus.Question
01d0f284 0295ef60 ASI.ParadigmPlus.LoadedWindows.WID904
01d26cec 02fdb36c ASI.ParadigmPlus.GrilleApp.GA1000
01d26cf0 0295f674 ASI.ParadigmPlus.QuestionList
01d26cf4 0295ef60 ASI.ParadigmPlus.LoadedWindows.WID904
01d26cf8 02fdb36c ASI.ParadigmPlus.GrilleApp.GA1000
01d26cfc 0295f810 ASI.ParadigmPlus.Question
01d26d00 0295f810 ASI.ParadigmPlus.Question
01d26d08 0295f810 ASI.ParadigmPlus.Question
01d26d30 06c3a958 System.String    SP1:SP1
01d26d40 029c232c System.String    TNE:TNE
01d26d50 06c3a958 System.String    SP1:SP1
01d26d54 029c232c System.String    TNE:TNE
01d26d60 029c232c System.String    TNE:TNE
01d26d78 06c3a958 System.String    SP1:SP1
01d26d7c 06c3a958 System.String    SP1:SP1
01d26d84 06c3a958 System.String    SP1:SP1
01d26da4 06c357a0 System.String    SB1:SB1
01d26da8 06c357a0 System.String    SB1:SB1
01d26db0 06c3a958 System.String    SP1:SP1
01d26db4 06ba3d08 System.String    WHT:WHT
01d26db8 06b987c8 System.String    WHT:WHT
01d26dbc 06b8aa10 System.String    WF:WF
01d26dc0 029fab00 System.String    L:L
01d26dc4 06c3a958 System.String    SP1:SP1
01d26dc8 06c4a518 System.String    S000:S000
01d26dd4 06c4a518 System.String    S000:S000
01d26dd8 0296b404 ASI.ParadigmPlus.Question
01d26ddc 0296a00c ASI.ParadigmPlus.Question
01d26de0 02968a90 ASI.ParadigmPlus.Question
01d26de4 02966af8 ASI.ParadigmPlus.Question
01d26de8 06be6e1c ASI.ParadigmPlus.Answer
01d26dec 06c357a0 System.String    SB1:SB1
01d26df0 029fab00 System.String    L:L
01d26df4 0295fa54 ASI.ParadigmPlus.QuestionGroup
01d26df8 02963f80 ASI.ParadigmPlus.QuestionGroup
01d26dfc 029662fc ASI.ParadigmPlus.QuestionGroup
01d26e00 02961cb4 ASI.ParadigmPlus.QuestionGroup
01d26e0c 0295f810 ASI.ParadigmPlus.Question
01d26e10 0295ef60 ASI.ParadigmPlus.LoadedWindows.WID904
01d270d4 06c38ddc ASI.ParadigmPlus.Answer
01d270dc 06c4bc0c ASI.ParadigmPlus.Dimension
01d270e0 06c4b99c ASI.ParadigmPlus.DimensionList
01d27104 029607f8 ASI.ParadigmPlus.Question
01d27108 0295fa80 ASI.ParadigmPlus.QuestionList
01d27118 06c38e74 System.String    5:5
01d2711c 02960564 ASI.ParadigmPlus.Question
01d27120 0295fa80 ASI.ParadigmPlus.QuestionList
01d2781c 029fac84 ASI.ParadigmPlus.Answer
01d27820 02960464 ASI.ParadigmPlus.AnswerList
01d27824 029fcbd8 ASI.ParadigmPlus.Answer
01d27828 02960464 ASI.ParadigmPlus.AnswerList
01d2782c 029fca28 ASI.ParadigmPlus.Answer
01d27830 02960464 ASI.ParadigmPlus.AnswerList
01d27844 029faa84 ASI.ParadigmPlus.Answer
01d2784c 06c38e74 System.String    5:5
01d27850 02960564 ASI.ParadigmPlus.Question
01d27854 0295fa80 ASI.ParadigmPlus.QuestionList
01d27860 06c38e74 System.String    5:5
01d27864 02960564 ASI.ParadigmPlus.Question
01d27868 0295fa80 ASI.ParadigmPlus.QuestionList
01d27870 06c38e74 System.String    5:5
01d27874 02960564 ASI.ParadigmPlus.Question
01d27878 0295fa80 ASI.ParadigmPlus.QuestionList
01d2787c 029faa84 ASI.ParadigmPlus.Answer
01d27880 02960464 ASI.ParadigmPlus.AnswerList
01d27884 029fab84 ASI.ParadigmPlus.Answer
01d27888 02960464 ASI.ParadigmPlus.AnswerList
01d27974 02960e80 ASI.ParadigmPlus.Question
01d27978 0295fa80 ASI.ParadigmPlus.QuestionList
01d27bd0 06c3a8dc ASI.ParadigmPlus.Answer
01d27c08 06c3b924 ASI.ParadigmPlus.Answer
01d27c0c 02960f44 ASI.ParadigmPlus.AnswerList
01d27c10 06c3b860 ASI.ParadigmPlus.Answer
01d27c14 02960f44 ASI.ParadigmPlus.AnswerList
01d27c18 06c3ac90 ASI.ParadigmPlus.Answer
01d27c1c 02960f44 ASI.ParadigmPlus.AnswerList
01d27c20 06c3abcc ASI.ParadigmPlus.Answer
01d27c24 02960f44 ASI.ParadigmPlus.AnswerList
01d27c28 06c3ab08 ASI.ParadigmPlus.Answer
01d27c2c 02960f44 ASI.ParadigmPlus.AnswerList
01d27c30 06c3aa44 ASI.ParadigmPlus.Answer
01d27c34 02960f44 ASI.ParadigmPlus.AnswerList
01d27c38 06c3b4dc ASI.ParadigmPlus.Answer
01d27c3c 02960f44 ASI.ParadigmPlus.AnswerList
01d27c40 06c3a990 ASI.ParadigmPlus.Answer
01d27c44 02960f44 ASI.ParadigmPlus.AnswerList
01d27c48 06c3a8dc ASI.ParadigmPlus.Answer
01d27c4c 02960f44 ASI.ParadigmPlus.AnswerList
01d27c6c 02960e80 ASI.ParadigmPlus.Question
01d27c70 0295fa80 ASI.ParadigmPlus.QuestionList
01d27e04 029628d0 ASI.ParadigmPlus.Question
01d27e08 02961ce0 ASI.ParadigmPlus.QuestionList
01d27e28 029628d0 ASI.ParadigmPlus.Question
01d27e2c 02961ce0 ASI.ParadigmPlus.QuestionList
01d27f14 06b89804 ASI.ParadigmPlus.Answer
01d27f18 02962994 ASI.ParadigmPlus.AnswerList
01d27f1c 029628d0 ASI.ParadigmPlus.Question
01d27f20 02961ce0 ASI.ParadigmPlus.QuestionList
01d27f38 06c38e74 System.String    5:5
01d27f3c 02960564 ASI.ParadigmPlus.Question
01d27f40 0295fa80 ASI.ParadigmPlus.QuestionList
01d27f4c 06c38e74 System.String    5:5
01d27f50 02960564 ASI.ParadigmPlus.Question
01d27f54 0295fa80 ASI.ParadigmPlus.QuestionList
01d27f60 06c38e74 System.String    5:5
01d27f64 02960564 ASI.ParadigmPlus.Question
01d27f68 0295fa80 ASI.ParadigmPlus.QuestionList
01d27f88 06b89964 ASI.ParadigmPlus.Answer
01d27f8c 029628d0 ASI.ParadigmPlus.Question
01d27f90 02961ce0 ASI.ParadigmPlus.QuestionList
01d27fa8 06c4b34c System.String    FDIA:FDIA
01d27fac 0295fd84 ASI.ParadigmPlus.Question
01d27fb0 0295fa80 ASI.ParadigmPlus.QuestionList
01d27fb4 06b896dc ASI.ParadigmPlus.Answer
01d27fb8 02962994 ASI.ParadigmPlus.AnswerList
01d27fbc 029628d0 ASI.ParadigmPlus.Question
01d27fc0 02961ce0 ASI.ParadigmPlus.QuestionList
01d27fc8 029fab00 System.String    L:L
01d27fcc 029603a0 ASI.ParadigmPlus.Question
01d27fd0 0295fa80 ASI.ParadigmPlus.QuestionList
01d27fd4 06b89964 ASI.ParadigmPlus.Answer
01d27fd8 02962994 ASI.ParadigmPlus.AnswerList
01d27fdc 029628d0 ASI.ParadigmPlus.Question
01d27fe0 02961ce0 ASI.ParadigmPlus.QuestionList
01d27fe4 029628d0 ASI.ParadigmPlus.Question
01d27fe8 02961ce0 ASI.ParadigmPlus.QuestionList
01d28610 06b987c8 System.String    WHT:WHT
01d28614 02961dd8 ASI.ParadigmPlus.Question
01d28618 02961ce0 ASI.ParadigmPlus.QuestionList
01d2872c 06ba3d08 System.String    WHT:WHT
01d28730 029621f0 ASI.ParadigmPlus.Question
01d28734 02961ce0 ASI.ParadigmPlus.QuestionList
01d28778 029f1d94 ASI.ParadigmPlus.Answer
01d2877c 02963c14 ASI.ParadigmPlus.AnswerList
01d28780 06c37884 ASI.ParadigmPlus.Answer
01d28784 02963c14 ASI.ParadigmPlus.AnswerList
01d28788 06c379cc ASI.ParadigmPlus.Answer
01d2878c 02963c14 ASI.ParadigmPlus.AnswerList
01d28790 06c36798 ASI.ParadigmPlus.Answer
01d28794 02963c14 ASI.ParadigmPlus.AnswerList
01d28798 06c36510 ASI.ParadigmPlus.Answer
01d2879c 02963c14 ASI.ParadigmPlus.AnswerList
01d287a0 06c36648 ASI.ParadigmPlus.Answer
01d287a4 02963c14 ASI.ParadigmPlus.AnswerList
01d287ac 06c37a78 System.String    Custom Paint
01d287b0 06c379cc ASI.ParadigmPlus.Answer
01d287b8 072eb468 System.Collections.ArrayList+ArrayListEnumeratorSimple
01d287bc 02963c14 ASI.ParadigmPlus.AnswerList
01d289dc 029640b8 ASI.ParadigmPlus.Question
01d289e0 02963fac ASI.ParadigmPlus.QuestionList
01d28a38 029f13f4 System.String    Venting Sidelite Locking System
01d28a3c 029f1390 ASI.ParadigmPlus.Answer
01d28a44 072f0568 System.Collections.ArrayList+ArrayListEnumeratorSimple
01d28a48 0296417c ASI.ParadigmPlus.AnswerList
01d28a60 06c356f4 ASI.ParadigmPlus.Answer
01d28a68 06c4a518 System.String    S000:S000
01d28a6c 0295ffec ASI.ParadigmPlus.Question
01d28a70 0295fa80 ASI.ParadigmPlus.QuestionList
01d28a7c 06c4a518 System.String    S000:S000
01d28a80 0295ffec ASI.ParadigmPlus.Question
01d28a84 0295fa80 ASI.ParadigmPlus.QuestionList
01d28a90 0295f768 System.String    CustItemNumber
01d28a98 06c4b34c System.String    FDIA:FDIA
01d28a9c 0295fd84 ASI.ParadigmPlus.Question
01d28aa0 0295fa80 ASI.ParadigmPlus.QuestionList
01d28aa4 029ecd64 ASI.ParadigmPlus.Answer
01d28aa8 0296417c ASI.ParadigmPlus.AnswerList
01d28aac 029e95ac ASI.ParadigmPlus.Answer
01d28ab0 0296417c ASI.ParadigmPlus.AnswerList
01d28ab8 029f13f4 System.String    Venting Sidelite Locking System
01d28abc 029f1390 ASI.ParadigmPlus.Answer
01d28ac4 072ef574 System.Collections.ArrayList+ArrayListEnumeratorSimple
01d28ac8 0296417c ASI.ParadigmPlus.AnswerList
01d28acc 029f1230 ASI.ParadigmPlus.Answer
01d28ad0 0296417c ASI.ParadigmPlus.AnswerList
01d28f4c 02961798 ASI.ParadigmPlus.Question
01d28f50 0295fa80 ASI.ParadigmPlus.QuestionList
01d2903c 0296466c ASI.ParadigmPlus.Question
01d29040 02963fac ASI.ParadigmPlus.QuestionList
01d290cc 06c07914 System.String    C:C
01d290d0 02964268 ASI.ParadigmPlus.Question
01d290d4 02963fac ASI.ParadigmPlus.QuestionList
01d29144 06c30604 ASI.ParadigmPlus.Answer
01d29148 02964730 ASI.ParadigmPlus.AnswerList
01d2914c 0296466c ASI.ParadigmPlus.Question
01d29150 02963fac ASI.ParadigmPlus.QuestionList
01d29154 06c0f9d8 ASI.ParadigmPlus.Answer
01d29158 0296450c ASI.ParadigmPlus.AnswerList
01d2915c 02964448 ASI.ParadigmPlus.Question
01d29160 02963fac ASI.ParadigmPlus.QuestionList
01d29164 02964268 ASI.ParadigmPlus.Question
01d29168 02963fac ASI.ParadigmPlus.QuestionList
01d2991c 029d6c7c System.String    021022
01d29928 029d6c7c System.String    021022
01d29934 029d6c7c System.String    021022
01d29938 029d5700 ASI.ParadigmPlus.Answer
01d2993c 0296450c ASI.ParadigmPlus.AnswerList
01d29940 029d6bdc ASI.ParadigmPlus.Answer
01d29944 0296450c ASI.ParadigmPlus.AnswerList
01d29948 02964448 ASI.ParadigmPlus.Question
01d2994c 02963fac ASI.ParadigmPlus.QuestionList
01d2f908 06c4b34c System.String    FDIA:FDIA
01d2f90c 0295fd84 ASI.ParadigmPlus.Question
01d2f910 0295fa80 ASI.ParadigmPlus.QuestionList
01d2ffd0 02964c28 ASI.ParadigmPlus.Question
01d2ffd4 02963fac ASI.ParadigmPlus.QuestionList
01d2ffe4 06c32030 System.String    SB:SB
01d2ffe8 02964a54 ASI.ParadigmPlus.Question
01d2ffec 02963fac ASI.ParadigmPlus.QuestionList
01d2fffc 06c3368c ASI.ParadigmPlus.Answer
01d30000 02964b18 ASI.ParadigmPlus.AnswerList
01d30004 02964a54 ASI.ParadigmPlus.Question
01d30008 02963fac ASI.ParadigmPlus.QuestionList
01d3000c 02964a54 ASI.ParadigmPlus.Question
01d30010 02963fac ASI.ParadigmPlus.QuestionList
01d30144 06c32030 System.String    SB:SB
01d30148 02964a54 ASI.ParadigmPlus.Question
01d3014c 02963fac ASI.ParadigmPlus.QuestionList
01d30154 06c31f90 ASI.ParadigmPlus.Answer
01d3015c 06c344d8 System.String    (COM) Lifetime Brass
01d30160 06c34418 ASI.ParadigmPlus.Answer
01d30168 072f16a0 System.Collections.ArrayList+ArrayListEnumeratorSimple
01d3016c 02964b18 ASI.ParadigmPlus.AnswerList
01d30174 06c31f90 ASI.ParadigmPlus.Answer
01d30178 06c34294 ASI.ParadigmPlus.Answer
01d3017c 02964b18 ASI.ParadigmPlus.AnswerList
01d30180 06c33e48 ASI.ParadigmPlus.Answer
01d30184 02964b18 ASI.ParadigmPlus.AnswerList
01d30188 06c32e6c ASI.ParadigmPlus.Answer
01d3018c 02964b18 ASI.ParadigmPlus.AnswerList
01d30190 06c32b78 ASI.ParadigmPlus.Answer
01d30194 02964b18 ASI.ParadigmPlus.AnswerList 
```

^^ 我不得不剪掉上面的一些内容以使这篇文章适合，但想象一下它会继续这样下去^^

请忽略我们自定义代码的详细信息。这一切对我来说似乎都是多余的，但我不是堆栈专家。上面列出的大多数堆栈对象（有 1500 多个）不是函数参数，所以我认为它们不属于那里。这是在堆栈上生成所有这些项目的代码类型的示例（运行大量这样的代码）：

```
gUnitType.Questions("French Door Style").CommonLogicValue = CommonLogicValues.AlwaysDisplay
gUnitType.Questions("French Door Style").ShowAllAnswers()
If Me.NumberOfUnits > 1 Then
    Me.Dimensions("Call Size Height").Answers("6-8 Handicap sill").Visible = False
    Me.Dimensions("Call Size Height").Answers("6-10 Handicap Sill").Visible = False
    Me.Dimensions("Call Size Height").Answers("7-0 Handicap Sill").Visible = False
    Me.Dimensions("Call Size Height").Answers("8-0 Handicap Sill").Visible = False
End If 
```

我也不是 VB 专家（这段代码来自我通常不使用的应用程序的不同部分），但是这样的代码用东西填满堆栈是否正常？如果有人有任何见解，或者甚至可以向我指出一些资源的方向以及有关此类东西的信息，将不胜感激。感谢您的关注！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T16:25:26.607

我想我会在这里发布解决方案，以防其他人遇到它。上面的回复都很有帮助，并指出了为什么我可能会溢出堆栈——但我仍然无法理解的是为什么完全相同的代码在我们的 winforms 应用程序中运行良好。

我最终发现，微软在某个时候将 IIS 线程的堆栈大小从 1MB（如在一般 .NET 上下文中）更改为 256k。这解释了一切，包括一个特别令人沮丧的事实，即使 ASPX 版本在 Visual Studio 开发服务器下也能正常运行。我通过与这个特定客户合作解决了这个问题，以大幅减少上述 QuestionChangeLogic 函数中的代码量（当我查找源代码时，该函数有 > 15,000 行！）。

谢谢你们的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T15:02:01.367

您需要一些适合 CLR 的符号。设置`_NT_SYMBOL_PATH`（在 WinDBG 中，使用文件/符号文件路径），使其包括：

```
SRV*C:\WebSymbols*http://msdl.microsoft.com/download/symbols 
```

这告诉调试器符号引擎它可以将符号从 Microsoft 的在线符号服务器下载到 C:\WebSymbols。如果您希望将它们缓存在其他位置，请选择另一个文件夹。

看起来 Question、QuestionList、Answer 等都是`struct`s - 即值类型 - 所以它们分配在堆栈上而不是堆上。您可能需要创建自己的`class`包装这些类型，以便它们位于堆上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T15:04:41.530

根据堆栈对象转储“ASI.ParadigmPlus.GrilleApp.GA1000”为 96872 字节。您可能想弄清楚该对象的全部内容。那是你堆栈空间的很大一部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-20T09:02:14.200

分析调用堆栈我清楚地看到导致此异常的方法是：

```
ASI.ParadigmPlus.LoadedWindows.WID904.QuestionChangeLogic 
```

这个方法怎么有315个变量？这不是太多了吗？

“！clrstack -a”（在运行“！dso”之后）应该为您提供每个托管帧的更多信息。

# iphone - 新手想为 ipod touch 创建一个 PDF 阅读器 - 最好的方法是什么？

> ID：93297
> 
> 赞同：6
> 
> 时间：2008-09-18T14:55:04.283
> 
> 标签：iphone, pdf, ipod

我想制作一个显示 PDF 的小应用程序，显示具有前一页功能的可缩放单页。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-20T08:58:52.773

Core Graphics API 在 Cocoa 和 Cocoa touch 中几乎相同。阅读[CGPDFDocument](http://developer.apple.com/documentation/GraphicsImaging/Reference/CGPDFDocument/Reference/reference.html)，它应该为您提供渲染 PDF 页面所需的一切。您无需阅读 PDF 规范或使用库直接解析 PDF 文件。您可能会了解更多有关 Core Graphics / Quartz 2D / 等的信息，以了解如何在 Cocoa 应用程序中使用这些功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-20T09:12:29.917

基于逐渐发展的 Apple 拒绝[重复 iPhone 上已有功能](http://www.pcworld.com/article/151026/podcasting_app_rejected_from_the_app_store.html)的应用程序提交的政策，即使作为新手，我也会担心在 iPhone 核心功能集的一部分上花费太多时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T15:17:19.050

这是非常微不足道的。CGPDFDocument 函数将允许您对 PDF 文件做任何您想做的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T15:16:23.983

iPhone 和 iPod touch 已经可以查看 PDF，因为英国的一个电视广告显示正在查看带有 .pdf 附件（游泳课程）的电子邮件。它还可以查看 .doc、.xls 等，因此，如果他正在创建查看器类型的应用程序，那么支持这些应用程序可能是稍后添加的一个不错的功能。

这意味着您需要访问这些设备上的 PDF 框架。如果他是付费开发者，Apple 可以在这里提供支持。将 PDF 同步到设备是真正的困难，因为 iTunes 不支持。我假设您需要编写一个基于网络的同步工具，或者有一个在线云来保存人们的 PDF。

该设备不支持 Flash，因此无法使用 PDF 到 Flash 转换工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-02T23:02:19.727

我发现这个 HTML5 框架应该可以在 iPad [http://bakerframework.com/](http://bakerframework.com/)上运行， 但我还没有测试它。

# c++ - IBM WebSphere MQ 是否支持 Windows 上的 64 位客户端？

> ID：93313
> 
> 赞同：2
> 
> 时间：2008-09-18T14:56:38.383
> 
> 标签：c++, 64-bit, ibm-mq

我正在将 C++ 32 位应用程序移植到 Windows 上的 64 位。该应用程序是 IBM WebSphere MQ 的客户端。它使用 MQ 客户端 API。

现在，随着端口的进展，我正在尝试寻找 64 位客户端。到目前为止，没有运气。

这里有没有人碰巧知道我在哪里可以找到或确认没有？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T05:53:40.997

Websphere MQ 7 for Windows 支持 x86 和 x64，但不支持 Itanium 64 位。它目前仅**正式**支持 Visual C++ 2005 进行开发，但 IBM 通常会定期发布 PTF 以进行容忍，因此在 C++ 2008 支持之前应该不会太久。

如果您对更多详细信息感兴趣，支持和要求声明位于 IBM 网页[http://www-01.ibm.com/support/docview.wss?rs=171&uid=swg27011920上。](http://www-01.ibm.com/support/docview.wss?rs=171&uid=swg27011920)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-27T03:03:33.953

由于这获得了很多意见，让我们提供[WMQ V7 客户端下载](http://www-01.ibm.com/support/docview.wss?rs=171&uid=swg24019253&loc=en_US&cs=utf-8&lang=en)的直接链接。请注意，它在某些版本的 Windows 中支持 64 位 Windows 客户端。

[WMQ v7.0.1 的系统要求页面](http://www-01.ibm.com/support/docview.wss?rs=171&uid=swg27011920)现在将 Visual Studio 2008 列为受支持。

请注意，一些支持代码是 32 位的，因此客户端安装到*Program Files (x86)*目录。

另一张海报引用的 IA94 SupportPac 通过 C++ 实现 JMS API，并且该 SupportPac 支持的环境是 WMQ 客户端环境的子集。如果您不使用 SupportPac，请参阅上面的链接了解系统要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T16:02:03.077

我在 IBM 的站点上找到了这个页面：[IA94: IBM Message Service Client for C/C++](http://www-01.ibm.com/support/docview.wss?uid=swg24007092)。上面有一个[readme.txt 文件](ftp://ftp.software.ibm.com/software/integration/support/supportpacs/individual/ia94.readme.txt)的链接，该文件在“支持的环境”下列出了“Windows 2003 Server x64 版本 - Microsoft Visual C++ .NET 2005 Service Pack1”。

希望有帮助！

# php - 如何使用配置数组初始化 Zend_Form_Element_Select？

> ID：93329
> 
> 赞同：0
> 
> 时间：2008-09-18T14:58:35.133
> 
> 标签：php, html, zend-framework

我试过：

```
$form->addElement(
    'select',
    'salutation',
    array(
        'required' => true,
        'options' => array(
            'Mr.' => 'Mr.',
            'Mrs.' => 'Mrs.',
            'Ms.' => 'Ms.',
        ), 
    )
); 
```

然后我`print_r()`编辑了表格，称呼的选项是空的。有人知道正确的拼写吗？据我所知，没有关于 Zend 元素配置格式的文档。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T16:24:33.227

您应该使用“multiOptions”而不是“options”。

# c# - C# 的 WSDL 生成器

> ID：93335
> 
> 赞同：2
> 
> 时间：2008-09-18T14:59:01.030
> 
> 标签：c#, wcf, wsdl

有谁知道为用 C# 编写的服务合同生成 WSDL 的好工具（即使用 WCF 标记为“[OperationContract]”的一组方法）？我发现的所有工具都以相反的方式工作：从 WSDL 创建代码存根。我不想手动插入 WSDL 文件。我找到了用于 php 和 J2EE 的工具，但没有找到 C#。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T15:02:02.363

[svcutil](http://msdn.microsoft.com/en-us/library/aa702581.aspx)或者只是快速托管它并点击 MEX 点:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T21:30:18.920

最简单的做法是使用基地址设置托管服务，然后从浏览器中点击它，并在末尾附加“?wsdl”。

这是一个指定了基地址的服务配置示例。请注意，这`<configuration><services>`在您的配置中的元素中：

```
 <service name="MyServiceName" behaviorConfiguration="MyServiceBehavior">
    <host>
      <baseAddresses>
        <add baseAddress="http://localhost:9000/MyService"/>
      </baseAddresses>
    </host>
    <endpoint address="net.tcp://localhost:9001/MyService"
              binding="netTcpBinding"
              contract="IMyService"
              bindingConfiguration="MyServiceBinding"/>
  </service> 
```

一旦你得到它托管，只需去`http://localhost:9000/MyService?wsdl`查看 WSDL 定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-23T07:11:16.890

两种方式：

a)**下载 wsdl 文件并执行以下步骤**：

i) 以管理员身份打开 Visual Studio 命令提示符。

ii) 键入以下命令：

wsdl.exe [您的 WSDL 文件的路径]

b)**带端点**：

i) 以管理员身份打开 Visual Studio 命令提示符。

ii) 键入以下命令：wsdl.exe [http://localhost:9000/MyService](http://localhost:9000/MyService)

# random - 创建列表的许多受约束的随机排列

> ID：93353
> 
> 赞同：0
> 
> 时间：2008-09-18T15:00:27.220
> 
> 标签：random, list, permutation

我需要制作一个随机排列列表。元素可以是任何东西，但假定它们是整数 0 到 x-1。我想制作 y 个列表，每个列表都包含 z 个元素。规则是没有列表可以包含两次相同的元素，并且在所有列表中，每个元素的使用次数相同（或尽可能接近）。例如，如果我的元素是 0,1,2,3，y 是 6，z 是 2，那么一种可能的解决方案是：

```
0,3
1,2
3,0
2,1
0,1
2,3

```

每行只有唯一的元素，没有元素被使用超过 3 次。如果 y 为 7，则 2 个元素将被使用 4 次，其余 3 次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T18:12:21.393

这可以改进，但它似乎可以完成这项工作（Python）：

```
import math, random

def get_pool(items, y, z):
    slots = y*z

    use_each_times = slots/len(items)
    exceptions = slots - use_each_times*len(items)

    if (use_each_times > y or
        exceptions > 0 and use_each_times+1 > y):
        raise Exception("Impossible.")

    pool = {}
    for n in items:
        pool[n] = use_each_times

    for n in random.sample(items, exceptions):
        pool[n] += 1

    return pool

def rebalance(ret, pool, z):
    max_item = None
    max_times = None

    for item, times in pool.items():
        if times > max_times:
            max_item = item
            max_times = times

    next, times = max_item, max_times

    candidates = []
    for i in range(len(ret)):
        item = ret[i]

        if next not in item:
            candidates.append( (item, i) )

    swap, swap_index = random.choice(candidates)

    swapi = []
    for i in range(len(swap)):
        if swap[i] not in pool:
            swapi.append( (swap[i], i) )

    which, i = random.choice(swapi)

    pool[next] -= 1
    pool[swap[i]] = 1
    swap[i] = next

    ret[swap_index] = swap

def plist(items, y, z):
    pool = get_pool(items, y, z)

    ret = []
    while len(pool.keys()) > 0:
        while len(pool.keys()) < z:
            rebalance(ret, pool, z)

        selections = random.sample(pool.keys(), z)

        for i in selections:
            pool[i] -= 1
            if pool[i] == 0:
                del pool[i]

        ret.append( selections )

    return ret

print plist([0,1,2,3], 6, 2) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T15:14:54.173

好的，一种近似的方法：

1 - 随机播放您的列表

2 - 取第 y 个元素形成下一行

4 - 只要列表中有数字，就重复 (2)

5 - 如果您没有足够的数字来完成列表，请重新排列原始列表并取走缺失的元素，确保不要重新取走数字。

6 - 只要您需要行，就从步骤 (2) 重新开始

我认为这应该尽可能随机，并且肯定会遵循您的标准。另外，您对重复元素的测试很少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T15:20:09.323

首先，你总是可以在最后对列表进行随机排序，所以我们不用担心做出“随机排列”（困难）；并且只需担心 1) 进行排列（容易）和 2) 将它们随机化（容易）。

如果你想要“真正的”随机组，你必须接受随机化本质上并没有真正考虑到结果“均匀分布”的约束——你可能会得到这一点，或者你可能会得到一系列相似的结果。如果你真的想要均匀分布，首先使集合均匀分布，然后将它们随机化为一组。

你必须均匀地使用集合 x 中的每个元素吗？从规则中不清楚我不能做出以下解释：

请注意以下几点：“在所有列表中，每个元素的使用次数相同（或尽可能接近）”

基于此标准以及 z < x* 的规则，我假设您可以简单地枚举所有列表中的所有项目。因此，您会自动列出枚举到位置 z 的项目的 y 列表。您的示例不像我的版本那样符合上述规则。使用 x={0,1,2,3} y=6 和 z=2 的示例，我得到：0,1 0,1 0,1 0,1 0,1 0,1

现在我没有使用 2 或 3，但你没有说我必须全部使用它们。如果我必须全部使用它们并且我不在乎能够证明我“尽可能接近”甚至使用，我会通过列表枚举所有项目，如下所示：0,1 2 ,3 0,1 2,3 0,1 2,3

最后，假设我确实必须使用所有元素。要计算每个元素可以重复多少次，我只需要 (y*z)/(count of x)。这样，我就不必坐下来担心如何划分列表中的项目。如果有余数，或者结果小于 1，那么我知道我不会得到准确的重复次数，所以在这些情况下，尝试浪费计算能量来使其完美并不重要。我认为最快的结果仍然是像上面那样枚举，并使用这里的计算来说明为什么达到或没有达到完美的结果。可以实现从该计算中提取多少位置将被重复的奇特算法，但是“它太长了，无法容纳在边距中”。

*每个列表具有相同的 z 数量的元素，因此不可能创建 z 大于 x 的列表并且仍然满足任何列表不能包含相同元素两次的规则。因此，该规则要求 z 不能大于 x。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T16:22:11.983

根据评论中的新细节，该解决方案可能只是标准随机排列生成算法的实现。这里对随机排列生成算法进行了冗长的讨论：

[http://www.techuser.net/randpermgen.html](http://www.techuser.net/randpermgen.html)

（来自谷歌搜索：随机排列生成）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-17T18:48:10.107

这适用于 Ruby：

```
# list is the elements to be permuted
# y is the number of results desired
# z is the number of elements per result
# equalizer keeps track of who got used how many times
def constrained_permutations list, y, z
  list.uniq! # Never trust the user. We want no repetitions.
  equalizer = {}
  list.each { |element| equalizer[element] = 0 }

  results = []
  # Do this until we get as many results as desired
  while results.size < y
    pool = []
    puts pool
    least_used = equalizer.each_value.min
    # Find how used the least used element was
    while pool.size < z
      # Do this until we have enough elements in this resultset
      element = nil
      while element.nil?
        # If we run out of "least used elements", then we need to increment
        # our definition of "least used" by 1 and keep going.
        element = list.shuffle.find do |x|
          !pool.include?(x) && equalizer[x] == least_used
        end
        least_used += 1 if element.nil?
      end
      equalizer[element] += 1
      # This element has now been used one more time.
      pool << element
    end
    results << pool
  end
  return results
end 
```

示例用法：

```
constrained_permutations [0,1,2,3,4,5,6], 6, 2
=> [[4, 0], [1, 3], [2, 5], [6, 0], [2, 5], [3, 6]]
constrained_permutations [0,1,2,3,4,5,6], 6, 2
=> [[4, 5], [6, 3], [0, 2], [1, 6], [5, 4], [3, 0]]
enter code here 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-02T00:45:29.043

[http://en.wikipedia.org/wiki/Fisher-Yates_shuffle](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)

# c - Pic18 micro最好的c编译器是什么

> ID：93356
> 
> 赞同：10
> 
> 时间：2008-09-18T15:00:40.573
> 
> 标签：c, embedded, microchip, pic18, mikroc

我们正在开始一个基于微芯片 PIC18F252 的新项目。最好使用的“c”编译器是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T15:19:19.060

1.  [Microchip C18 编译器](http://www.microchip.com/stellent/idcplg?IdcService=SS_GET_PAGE&nodeId=1406&dDocName=en010014&redirects=c18)：确实是最好的和最容易使用的。非常适合专业使用。
2.  [HI-TECH](http://www.microchip.com/stellent/idcplg?IdcService=SS_GET_PAGE&nodeId=1406&dDocName=en542861)：在 Microchip 不工作时使用（用于 PIC16）。
3.  [CCS](http://www.ccsinfo.com/content.php?page=compilers)
4.  源升压

*PS：我自己在PIC18F25XX*和 PIC18F45xx 系列上工作过，所以我对此略知一二。;)

PS2：如果出现编译器错误（它发生在我们身上），Microchip 团队非常被动，新版本很快发布。尝试找到与 Microchip 有联系的当地经销商，然后与他们一起参加活动并获得直接联系。无价。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T05:44:53.697

几年前，我对 Hitech PICC18 编译器和 Microchip C18 编译器进行了广泛的研究。

我认为大多数决定使用 Microchip C18 编译器的人只是因为他们在访问 microchip 网站时看到它并且已经熟悉 MpLab 进行汇编（恕我直言，这是一个糟糕的 IDE）。

HiTech 的解决方案更接近 ANSI C（因此代码更便携）。使用 C18，您添加了各种编译器特定的关键字，并且您被迫更多地管理内存。

1.  您必须指定将变量分配到哪个 ram bank。
2.  为了将 const 字符串分配给程序空间（而不是 ram），您必须使用 rom 关键字。
3.  如果不编辑链接描述文件，则无法分配大于 256 字节的变量。

可以在此处找到更深入的出色比较：[http ://www.xargs.com/pic/picc18-vs-c18.html](http://www.xargs.com/pic/picc18-vs-c18.html)

除了编译器之外，您还需要考虑 IDE。我是 Eclipse 的狂热粉丝，因此我非常喜欢 HiTech 的 HiTide。但是，自从Microchip收购了HiTech……他们似乎不再支持HiTide了。我不认为这是官方的……但根据我在 HiTech 支持方面的经验……他们不再修复错误，这真是太可惜了。

* * *

我也试过他们的专业编译器。我真的很喜欢这个主意。但是，我的项目超出了自动参数块的要求，无法使用它。编译似乎也需要很长时间，但这可能是程序复杂性的原因。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-26T14:52:16.157

tech PICC对我来说一直很可靠，并且已经发展了很多年。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-08-19T17:09:49.273

我没有使用过 Microchip 编译器，但多年来一直在使用 HiTech 的产品。我通常喜欢他们的 PIC16 编译器，但发现他们的 PIC18 编译器相当令人沮丧。虽然我很欣赏不必手动将所有变量放入银行，但 HiTech 编译器使用的规则令人讨厌、奇怪和愚蠢。简要背景：该芯片有 16 个 256 字节的变量库（*并非所有 256 字节在所有库中都可用）和一个库指针。直接访问变量需要选择正确的库；更换银行需要一条指令。

大小范围为 2-255 字节的全局和静态 int 和结构及其数组将按每个模块分配到 psect；每个模块的 psect 必须适合 256 字节的页面。字节数组以及单个字节进入一个“大”psect，其中假定每个字节都可能驻留在不同的页面中。

整个程序中的所有自动变量和参数都必须适合 256 字节的页面（它们在链接时静态分配）。链接器确实覆盖了永远不会同时存在的变量，但它假定对具有特定签名的函数指针的任何调用都可以调用其地址被占用且具有该签名的任何函数。

可以将最多 128 个字节的全局变量和静态变量声明为“near”。这些可以在没有银行切换的情况下访问。不能指定将自动变量或参数放置在“附近”。

HiTech 使用的 bank-switching 规则意味着许多函数，即使它们从不使用自己模块之外的任何变量，也会散布 movlb (switch-bank) 指令。

我不想要“无所不知的代码生成”。我希望能够通过为自定义 psect 定义关键字或宏来添加一些提示以合理地放置事物，允许自动和局部变量与其他变量共享 psect（在指定的银行限制下尽可能覆盖自动变量/参数）。如果编译器供应商真的想变得更好，允许指针接受银行限定符，以便只指向某个 psect 中的事物的指针可以存储在 8 位中。同样，允许函数和函数指针上的银行限定符指定某些间接调用只能与某些函数一起使用。而不是将函数指针设为 24 位或必须努力确保间接调用的函数最终在前 64K 中，在前 64K 中放置一个自动 GOTO，因此函数指针可以是 16 位。或者更好的是，如果函数“类”的不同函数少于 64 个，则使用 8 位指针。

我要求太多了吗？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T15:03:53.840

我们使用[CCS](http://www.ccsinfo.com/content.php?page=compilers)，它非常好。非常慢，但效果很好。无论如何，我没有与其他编译器进行任何比较，因此可能会有更好的选择。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T15:15:25.390

我不喜欢CCS，它太古怪了。

SourceBoost 还不错，而且很便宜，大约 40 英镑。

Microchip C18 编译器是最好的 IMO，但非常昂贵。不过，有一个免费的演示/学生版。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-17T17:23:03.973

我目前使用 CCS 并且讨厌它。它是如此非标准，并且是 C 的一个子集，以至于它很糟糕。我正在考虑尽快切换。我将首先尝试 Microchip C18 编译器，然后我会努力吞咽并获得 HighTech，从查看试用版和示例来看，它看起来非常可靠。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-25T12:21:07.757

使用 sdcc：

[http://sdcc.sourceforge.net/](http://sdcc.sourceforge.net/)

对于非免费（但免费！）PIC 编译器，mikroC 是 gr8！

[http://www.mikroe.com/eng/products/view/7/mikroc-pro-for-pic/](http://www.mikroe.com/eng/products/view/7/mikroc-pro-for-pic/)

高温高压

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-27T12:10:33.470

IAR System 有一个 PIC18 编译器/IDE：[IAR Embedded Workbench for PIC18](http://www.iar.com/ewpic18)。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-27T04:13:32.823

我已经使用 CCS 很多年了。我发现了一些错误，但支持很好，我可以使用 CCS 比使用 C18 或 HiTec 更快、更轻松地开发

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T15:47:24.237

我会坚持你使用 C18 编译器。它非常强大且非常易于使用。这是职业发展的必备品。这实际上取决于您正在从事的项目的规模。

从免费/学生版开始，您将获得使用它的良好感觉。如果您的项目很小，那可能就是您所需要的。我刚刚在 PIC 18F 上完成了一个大型开发项目，我对 C18 编译器非常满意。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-12-25T18:41:27.463

MPLAB C18 - 学生

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-12-18T18:23:12.697

我已经使用 SourceBoost 大约一年了，我并不完全兴奋，但它很好。但是，我刚刚完成了 SourceBoost 7、MCC18 和 Hi-Tech C 之间的代码大小测试。结果非常显着。

对于一个小型示例程序（包括结构、数组、函数指针、结构指针、字符和整数），SB7 套件生成的代码大约是 MCC18 和 HTC 大小的 2/3。我想确定其中有多少是启动和运行时开销，所以我在示例程序中添加了更多随机内容，大小增量显示 SB 仍然是其他大小的 2/3。HTC 比 MCC18 略小，但并不显着。所有优化都在所有环境中启用。

我不喜欢SB的地方是：

*   有限的内嵌汇编器
*   编译和链接速度慢
*   IDE 仅比 MPLAB 稍好一些。

我喜欢它的地方是：

*   好吧，代码大小肯定看起来比竞争对手小。
*   语言的一些扩展（例如参考）。但是，会扼杀便携性。
*   价格。
*   通过论坛的支持实际上是相当不错的。作者经常发帖。
*   自动消除未使用的代码（我认为这个功能会减慢编译和链接的速度）

因为我不喜欢 SB IDE，所以我使用 Source Insight 作为编辑器，它非常棒！SB“make”实用程序也没有希望，所以我使用 GnuWin32 make，这绝对是真正的交易，而且是免费的。

所以总而言之，我对我选择的工具感觉好多了。

无论如何，希望这可以帮助那里的人。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-08-27T16:44:39.407

MPLAB C-18 很好，他们有免费的学生版。它有一个很好的用户界面，它足够简单，不会让用户感到困惑。这是我使用的。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T15:04:27.367

如果您能侥幸成功（我的偏好是），请使用带有 MPLAB 的 PIC18 汇编器。它的优点是免费且相对完善的文档以及它具有不错的硬件/调试器支持的事实。它的小指令集和简单性使其能够轻松快速地进行编码。

如果您设置在 c 上：

CCS 是一个很好用的编译器，有一点问题，而且相当昂贵，但也有很好的调试能力。

如果您已经习惯了使用 Visual Studio 6 编写 c 代码的方法，Microsoft Embedded Studio（或类似的东西）就非常好。再次良好的硬件支持和出色的调试器。

我相信，如果您正在寻找免费的解决方案，您确实可以获得 MPLAB 的 c 编译器，尽管我个人从未使用过，所以我无法通过判断。

# java - 如何根据 Java 中的 URLConnection 对 BufferedReader 设置超时？

> ID：93357
> 
> 赞同：11
> 
> 时间：2008-09-18T15:00:41.510
> 
> 标签：java, url, sockets

**我想阅读 URL 的内容，但不想在 URL 无响应时“挂起”。我使用 URL 创建了一个 BufferedReader ...**

```
URL theURL = new URL(url);
URLConnection urlConn = theURL.openConnection();
urlConn.setDoOutput(true);
BufferedReader urlReader = new BufferedReader(newInputStreamReader(urlConn.getInputStream())); 
```

**...然后开始循环读取内容...**

```
do
    {
    buf = urlReader.readLine();
    if (buf != null)
        {
        resultBuffer.append(buf);
        resultBuffer.append("\n");
        }
    }
while (buf != null); 
```

**...但是如果读取挂起，则应用程序挂起。**

**有没有办法在不将代码磨到套接字级别的情况下，在必要时“超时”读取？**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-18T15:08:51.147

我认为 URLConnection.setReadTimeout 是您正在寻找的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T15:28:58.290

如果你有 java 1.4：

我认为连接超时 ( `URLConnection.setConnectTimeout(int timeout)`) 没有用，因为您正在执行某种流式传输。

---**不要杀死线程**--- 可能会导致未知问题，打开描述符等。

生成一个 java.util.TimerTask，您将在其中检查是否已完成该过程，否则，关闭 BufferedReader 和 URLConnection 的 OutputStream

插入一个布尔标志`isFinished`并在循环结束时将其设置为 true 并在循环之前将其设置为 false

```
TimerTask ft = new TimerTask(){
   public void run(){
     if (!isFinished){
       urlConn.getInputStream().close();
      urlConn.getOutputStream().close();
     }
   }
};

(new Timer()).schedule(ft, timeout); 
```

这可能会导致 ioexception，所以你必须抓住它。例外本身并不是一件坏事。我省略了一些声明（即finals），因此匿名类可以访问您的变量。如果没有，则创建一个维护引用并将其传递给 timertask 的 POJO

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T15:12:22.557

从 Java 1.5 开始，可以通过 URLConnection 类上的 'setReadTimeout(int timeout)' 方法在底层套接字上设置读取超时（以毫秒为单位）。

请注意，还有 'setConnectTimeout(int timeout)' 将对与远程服务器的初始连接执行相同的操作，因此设置它也很重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T22:19:16.000

我最近一直在 JVM 1.4 环境中处理这个问题。常用的答案是使用系统属性 sun.net.client.defaultReadTimeout（读取超时）和/或 sun.net.client.defaultConnectTimeout。这些记录在[Networking Properties](http://java.sun.com/j2se/1.4.2/docs/guide/net/properties.html)中，可以通过 Java 命令行上的 -D 参数或通过 System.setProperty 方法调用进行设置。

假设这些是由实现缓存的，因此您不能将它们从一件事更改为另一件事，因此它们被使用一次，值将被保留。

它们也不适用于 SSL 连接 ala HttpsURLConnection。还有其他方法可以使用自定义 SSLSocketFactory 来处理。

同样，所有这些都适用于 JVM 1.4.x。在 1.5 及更高版本中，您可以在 API 中使用更多方法（如上述其他响应者所述）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-26T06:52:22.697

对于 Java 1.4，您可以使用 Apache 的 SimpleHttpConnectionManager.getConnectionWithTimeout(hostConf,CONNECTION_TIMEOUT)

# apache-flex - 我可以从相同的源代码生成 Flex Web 和 Air 桌面应用程序吗？

> ID：93359
> 
> 赞同：7
> 
> 时间：2008-09-18T15:00:58.683
> 
> 标签：apache-flex, air, adobe, desktop, flexbuilder

我是新来的空气。我有一个现有的 Flex 2 应用程序，我正在考虑将它引入 Flexbuilder 3。我的问题是我可以使用相同的基础应用程序（和源代码）来制作 Air 版本，还是我必须维护单独的代码树: 一个用于 Air 版本，一个用于 Flex/SWF 版本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-22T09:05:32.490

我发现从同一个源创建 Flex 和 AIR 应用程序的最佳方法是对几乎所有代码使用核心库项目，而 Flex 和 AIR 应用程序使用单独的小项目。

有两个关键概念使它非常强大和可维护，不仅允许两个应用程序，而且如果你愿意的话，还允许许多“版本”。

1.  **模块**：- 如果核心应用程序实际上是一个模块（或加载其他模块的模块），您将能够轻松创建存根 Flex 和 AIR 应用程序，这些应用程序基本上用于设置项目属性、跨模块通信的引用类、然后只需使用 ModuleLoader 加载核心应用程序模块。

2.  **工厂对象**：- 当您想在 AIR 桌面应用程序上做一些您不能在 Flex 应用程序中做的事情时，或者在任何情况下您希望某些事情在应用程序之间以不同的方式工作时，工厂对象会创建一个项目特定类是一个很好的方法。例如，您可以调用“保存”函数，对于 AIR，它会保存到文件系统，而对于 Flex，它会调用 Web 服务。

    查看 Todd Prekaski 的优秀 Flex DevNet 文章， 了解如何[使用相同的代码库构建 Flex 和 Adob​​e AIR 应用程序。](http://www.adobe.com/es/devnet/air/flex/articles/flex_air_codebase.html)

一旦您创建了一个将在其中创建主模块的 Flex 库项目，请创建您的 Flex 和 AIR 应用程序项目。在两个应用程序项目的属性中，将库项目 src 目录添加到 Flex Build Path。在项目设置中，您还需要将模块添加到 Flex Modules 部分，设置选项以优化项目。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T15:16:57.880

您不能在同一个 Flex Builder 项目中混合使用 AIR 和 Flex，但可以共享代码。就是这样...

1.  像往常一样创建一个基于 Flex 的项目。
2.  创建第二个基于 AIR 的项目。
3.  在第二个应用程序中，转到项目-> 属性。
4.  选择“Flex 构建路径”选项。
5.  在“源路径”下添加包含您的第一个基于 Flex 的项目的源代码的文件夹。

现在两个项目共享来自 flex 项目的代码。

您需要注意不要在打算在两个应用程序之间共享的代码中使用仅限 AIR 的 API。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T15:02:13.097

你可以使用相同的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-05T23:40:35.360

一种方法是将应用程序的大部分放在库中基于组的组件中。

Flex 和 AIR 应用程序都可以将该组件嵌入到它们的 Window 中。

If you need to have custom code, have your Group component accept an Interface object that has all the methods that are specific to a platform (loadFile, saveFile, etc.). Each application injects an object that implements these methods appropriately.

I've worked on a product that injected a whole local-data access layer (to the SQLite database) and the core application had no idea if it was running in a browser or on the desktop (connected or disconnected).

Cheers

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T08:38:43.730

Create 3 project: Air, Web, and common. from air and web, include common.

[http://simplifiedchaos.com/how-to-compile-both-flex-and-air-application](http://simplifiedchaos.com/how-to-compile-both-flex-and-air-application)

# apache - 我可以使用 Apache 提供 ClickOnce 应用程序吗？

> ID：93361
> 
> 赞同：16
> 
> 时间：2008-09-18T15:01:26.373
> 
> 标签：apache, deployment, clickonce

我们正在 IIS（Internet 信息服务）上内部测试 ClickOnce 部署的应用程序，但我们想知道是否可以使用 Linux 上的 Apache 将其部署到更广泛的 Internet，以便我们可以利用现有的外部网站主机。

如果是这样，除了指定正确的 mime 类型（例如`.application`和）之外，我还需要考虑其他`.deploy`什么吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-18T15:11:29.953

我发现很多人从 2005 年左右开始问同样的问题，但这是第一个谷歌结果——也讨论了 silverlight。

[http://software.clempaul.me.uk/articles/clickonce/](http://software.clempaul.me.uk/articles/clickonce/)

然而，据我所知，您唯一需要担心的就是设置 mime 类型并提供对文件的访问权限。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-19T20:10:39.847

[Paul Clement](http://software.clempaul.me.uk/articles/clickonce/)的文章是我找到的最好的描述。[我还在Apache 文档](http://httpd.apache.org/docs/1.3/howto/htaccess.html#when)中遇到了一个主题，该主题建议将配置放在 httpd.conf 文件而不是 .htaccess 文件中。这是我添加到我的 httpd.conf 文件中的行：

```
AddType application/x-ms-application .application
AddType application/manifest .manifest
AddType application/octet-stream .deploy 
```

# cocoa - OSX 安全框架 NameAndPassword 示例应用程序

> ID：93387
> 
> 赞同：4
> 
> 时间：2008-09-18T15:04:09.410
> 
> 标签：cocoa, macos, sfauthorizationpluginview

我正在调查在 Mac OSX 下使用 SFAuthorizationPluginView 的安全插件，并作为查看 NameAndPassword 示例应用程序的第一步。该应用程序构建正常，但我无法对其进行身份验证。有没有人有任何 SFAuthorizationPluginView 或任何其他示例的经验。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T19:44:57.783

[使用 Xcode 调试授权插件有](http://developer.apple.com/technotes/tn2008/tn2108.html)帮助吗？

# java - JSTL 中的测试属性 标签

> ID：93408
> 
> 赞同：14
> 
> 时间：2008-09-18T15:07:21.260
> 
> 标签：java, jsp, jstl

我在 JSP 中看到了如下代码

```
<c:if test="<%=request.isUserInRole(RoleEnum.USER.getCode())%>">
    <li>user</li>
</c:if> 
```

我的困惑是出现在`test`属性值中的“=”。我的理解是，其中包含的任何内容`<%= %>`都会打印到输出中，但是分配给 test 的值肯定是布尔值，那么为什么会这样呢？

对于奖励积分，有没有办法改变上面的属性值，使其不使用 scriptlet 代码？据推测，这意味着使用 EL 代替。

干杯，唐

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-18T15:42:46.727

该`test`属性寻找的所有东西来确定某事是否为真是字符串“真”（不区分大小写）。例如，以下代码将打印“Hello world！”

```
<c:if test="true">Hello world!</c:if> 
```

代码中的代码`<%= %>`返回一个布尔值，因此它将打印字符串“true”或“false”，这正是`<c:if>`标签要查找的内容。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-05T00:41:47.080

你也可以使用类似的东西

```
<c:if test="${ testObject.testPropert == "testValue" }">...</c:if> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T15:38:02.463

<%= %> 之间的表达式在计算 c:if 标记之前计算。所以，假设 |request.isUserInRole| 返回 |true|，您的示例将首先评估为：

```
<c:if test="true">
    <li>user</li>
</c:if> 
```

然后将执行 c:if 标签。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T15:15:12.970

JSP 标记库中的属性通常可以是静态的或在请求时解析。如果它们在请求时被解析，JSP 将在运行时解析它们的值并将输出传递给标记。这意味着您可以将几乎任何 JSP 代码放入属性中，并且标记将根据产生的输出进行相应的行为。

如果您查看 jstl taglib 文档，您可以看到哪些属性是重用时间，哪些不是。[http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/index.html](http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/index.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T15:37:18.270

<%=%> 本身将被发送到输出，在 JSTL 的上下文中，它将被评估为一个字符串

# emacs - 使用 elisp 将 Emacs 框架最大化到只有一个显示器

> ID：93415
> 
> 赞同：12
> 
> 时间：2008-09-18T15:08:17.573
> 
> 标签：emacs, editor, elisp

我使用[maxframe.el](http://files.emacsblog.org/ryan/elisp/maxframe.el)来最大化我的 Emacs 框架。

它适用于所有三个主要平台，除了我的双头 Mac 设置（Macbook Pro 15 英寸笔记本电脑和 23 英寸显示器）。

当最大化 Emacs 框架时，框架会扩展以填充*两个*显示器的宽度和较大显示器的高度。

显然，我希望框架最大化以仅填充它所在的监视器。如何使用 elisp 检测两个单独显示器的分辨率？

谢谢，雅各布

编辑：正如 Denis 指出的那样，设置 mf-max-width 是一种合理的解决方法。但是（正如我应该提到的）我希望有一个适用于显示器和任何分辨率的解决方案。也许是特定于 Windows 的 w32-send-sys-command 风格的特定于 OSX 的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-19T14:27:40.867

我快速浏览了您提供的参考资料，`maxframe.el`我*认为*您使用的技术与我使用的不同。以下代码片段对您有帮助吗？

```
 (defun toggle-fullscreen ()
  "toggles whether the currently selected frame consumes the entire display or is decorated with a window border"
  (interactive)
  (let ((f (selected-frame)))
    (modify-frame-parameters f `((fullscreen . ,(if (eq nil (frame-parameter f 'fullscreen)) 'fullboth nil)))))) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T15:09:56.620

自定义“mf-max-width”是否有效？它的文档：

```
"*The maximum display width to support.  This helps better support the true
nature of display-pixel-width.  Since multiple monitors will result in a
very large display pixel width, this value is used to set the stop point for
maximizing the frame.  This could also be used to set a fixed frame size
without going over the display dimensions." 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-07-01T10:10:24.300

这种事情是您的窗口管理器的工作，而不是 emacs 的工作。（例如，Xmonad 可以很好地处理全屏 emacs。）

# java - 如何在 Java 中查询对象集合（Criteria/SQL-like）？

> ID：93417
> 
> 赞同：32
> 
> 时间：2008-09-18T15:08:49.337
> 
> 标签：java, sql, collections

假设您有一个包含数百个内存对象的集合，并且您需要查询此 List 以返回与某些 SQL 或 Criteria 之类的查询匹配的对象。例如，您可能有一个 Car 对象列表，并且您希望返回 1960 年代制造的所有汽车，车牌以 AZ 开头，按车型名称排序。

我知道[JoSQL](http://josql.sourceforge.net/)，有没有人使用过这个，或者对其他/本土解决方案有任何经验？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-29T21:02:32.197

正如其他答案中所讨论的，过滤是执行此操作的一种方法。

过滤虽然不可扩展。从表面上看，时间复杂度似乎是 O( *n* )（即，如果集合中的对象数量会增加，则已经无法扩展），但实际上因为需要根据查询对每个对象应用一个*或多个*测试，所以时间复杂度更准确地说，复杂度是 O( *nt* )，其中*t*是应用于每个对象的测试次数。

因此，随着向集合中添加额外的对象*和/或*查询中测试数量的增加，性能会下降。

还有另一种方法可以做到这一点，使用索引和集合论。

一种方法是在存储在您的集合中的对象中**的*****字段*****上构建*索引****，然后您将在查询中对其进行测试。*

 *假设您有一个`Car`对象集合，并且每个`Car`对象都有一个字段`color`。假设您的查询相当于“ `SELECT * FROM cars WHERE Car.color = 'blue'`”。您可以在 上建立一个索引`Car.color`，它基本上看起来像这样：

```
'blue' -> {Car{name=blue_car_1, color='blue'}, Car{name=blue_car_2, color='blue'}}
'red'  -> {Car{name=red_car_1, color='red'}, Car{name=red_car_2, color='red'}} 
```

然后给定一个查询`WHERE Car.color = 'blue'`，可以在 O( *1* ) 时间复杂度内检索蓝色汽车的集合。如果您的查询中有其他测试，您可以测试该*候选集中*的每辆汽车，以检查它是否与您查询中的其余测试相匹配。由于候选集可能远小于整个集合，因此时间复杂度*小于*O( *n* )（在工程意义上，请参见下面的评论）。当将其他对象添加到集合中时，性能不会降低*太多。*但这仍然不完美，请继续阅读。

另一种方法，就是我所说的***常设查询索引***。解释一下：通过传统的迭代和过滤，对集合进行迭代并测试每个对象以查看它是否与查询匹配。所以过滤就像在一个集合上运行一个查询。一个常设查询索引将是另一种方式，其中集合改为在查询上运行，但对于集合中的每个对象仅运行一次，即使该集合可以被查询任意次数。

*常设查询索引*就像使用某种*智能集合*注册查询一样，当对象被添加到集合中或从集合中删除时，该集合将针对已注册的所有常设查询自动测试每个对象。如果一个对象与一个常设查询匹配，则该集合可以将其添加到/从专用于存储与该查询匹配的对象的集合中删除。随后，可以在 O( *1* ) 时间复杂度内检索与任何已注册查询匹配的对象。

以上信息取自[CQEngine（集合查询引擎）](https://github.com/npgall/cqengine)。这基本上是一个 NoSQL 查询引擎，用于使用类似 SQL 的查询从 Java 集合中检索对象，而无需遍历集合的开销。它是围绕上述想法构建的，还有更多。免责声明：我是作者。它是开源的，位于 Maven 中心。*如果您觉得有帮助，请点赞这个答案！*

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-18T15:29:50.050

我在生产应用程序中使用了[Apache Commons JXPath](http://commons.apache.org/jxpath/)。它允许您将 XPath 表达式应用于 Java 中的对象图。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-03-06T16:52:58.750

是的，我知道这是一篇旧帖子，但技术每天都在出现，答案会随着时间而改变。

我认为这是一个用 LambdaJ 解决的好问题。你可以在这里找到它： [http ://code.google.com/p/lambdaj/](http://code.google.com/p/lambdaj/)

这里有一个例子：

**寻找活跃客户//（可迭代版本）**

```
List<Customer> activeCustomers = new ArrayList<Customer>();  
for (Customer customer : customers) {  
  if (customer.isActive()) {  
    activeCusomers.add(customer);  
  }  
} 
```

**LambdaJ 版本**

```
List<Customer> activeCustomers = select(customers, 
                                        having(on(Customer.class).isActive())); 
```

当然，有这种美感对性能有影响（有点……平均2次），但是你能找到更可读的代码吗？

它有很多功能，另一个例子可能是排序：

**排序迭代**

```
List<Person> sortedByAgePersons = new ArrayList<Person>(persons);
Collections.sort(sortedByAgePersons, new Comparator<Person>() {
        public int compare(Person p1, Person p2) {
           return Integer.valueOf(p1.getAge()).compareTo(p2.getAge());
        }
}); 
```

**使用 lambda 排序**

```
List<Person> sortedByAgePersons = sort(persons, on(Person.class).getAge()); 
```

* * *

**更新**：在 java 8 之后，您可以使用开箱即用的 lambda 表达式，例如：

```
List<Customer> activeCustomers = customers.stream()
                                          .filter(Customer::isActive)
                                          .collect(Collectors.toList()); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T16:05:40.930

继续`Comparator`主题，您可能还想看看[Google Collections](http://code.google.com/p/google-collections/) API。特别是，它们有一个名为[Predicate](http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/base/Predicate.html)的接口，它的作用类似于`Comparator`，因为它是一个简单的接口，可以由过滤方法使用，例如[Sets.filter](http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/Sets.html#filter(java.util.Set,%20com.google.common.base.Predicate))。它们包括一大堆复合谓词实现，执行 AND、OR 等。

根据数据集的大小，使用这种方法可能比 SQL 或外部关系数据库方法更有意义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T15:18:30.280

如果你需要一个具体的匹配，你可以让类实现比较器，然后创建一个包含所有散列字段的独立对象，并使用它来返回匹配的索引。当您想在集合中找到多个（可能）对象时，您将不得不求助于像 JoSQL 这样的库（在我使用它的琐碎案例中效果很好）。

一般来说，我倾向于将 Derby 嵌入到我的小型应用程序中，使用 Hibernate 注释来定义我的模型类，并让 Hibernate 处理缓存方案以保持一切快速。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T15:17:33.030

我会使用一个比较器，它需要一系列年份和车牌模式作为输入参数。然后只需遍历您的集合并复制匹配的对象。您最终可能会使用这种方法制作一整套自定义比较器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T15:45:33.303

该`Comparator`选项还不错，特别是如果您使用匿名类（以免在项目中创建冗余类），但最终当您查看比较流程时，它几乎就像您自己循环整个集合一样，准确指定匹配项目的条件：

```
if (Car car : cars) {
    if (1959 < car.getYear() && 1970 > car.getYear() &&
            car.getLicense().startsWith("AZ")) {
        result.add(car);
    }
} 
```

然后是排序......这可能在背后很痛苦，但幸运的是有类`Collections`及其`sort`方法，其中一个接收`Comparator`......

# java - 使用 FileChannel 和 ByteArrays 读取 ASCII 文件

> ID：93423
> 
> 赞同：5
> 
> 时间：2008-09-18T15:09:25.623
> 
> 标签：java, file-io, io, bytearray, filechannel

我有以下代码：

```
 String inputFile = "somefile.txt";
        FileInputStream in = new FileInputStream(inputFile);
        FileChannel ch = in.getChannel();
        ByteBuffer buf = ByteBuffer.allocateDirect(BUFSIZE);  // BUFSIZE = 256

        /* read the file into a buffer, 256 bytes at a time */
        int rd;
        while ( (rd = ch.read( buf )) != -1 ) {
            buf.rewind();
            for ( int i = 0; i < rd/2; i++ ) {
                /* print each character */
                System.out.print(buf.getChar());
            }
            buf.clear();
        } 
```

但是字符会显示在？这与使用 Unicode 字符的 Java 有关吗？我该如何纠正？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T15:39:24.363

您必须知道文件的编码是什么，然后使用该编码将 ByteBuffer 解码为 CharBuffer。假设文件是​​ ASCII：

```
import java.util.*;
import java.io.*;
import java.nio.*;
import java.nio.channels.*;
import java.nio.charset.*;

public class Buffer
{
    public static void main(String args[]) throws Exception
    {
        String inputFile = "somefile";
        FileInputStream in = new FileInputStream(inputFile);
        FileChannel ch = in.getChannel();
        ByteBuffer buf = ByteBuffer.allocateDirect(BUFSIZE);  // BUFSIZE = 256

        Charset cs = Charset.forName("ASCII"); // Or whatever encoding you want

        /* read the file into a buffer, 256 bytes at a time */
        int rd;
        while ( (rd = ch.read( buf )) != -1 ) {
            buf.rewind();
            CharBuffer chbuf = cs.decode(buf);
            for ( int i = 0; i < chbuf.length(); i++ ) {
                /* print each character */
                System.out.print(chbuf.get());
            }
            buf.clear();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T15:27:37.340

buf.getChar() 预计每个字符 2 个字节，但您只存储 1 个字节。使用：

```
 System.out.print((char) buf.get()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T15:27:33.050

将您的打印声明更改为：

```
System.out.print((char)buf.get()); 
```

似乎有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T15:34:20.367

根据 somefile.txt 的编码，一个字符实际上可能不是由两个字节组成。[此页面](http://java.sun.com/docs/books/tutorial/i18n/text/stream.html)提供了有关如何使用正确编码读取流的更多信息。

令人遗憾的是，文件系统不会告诉你文件的编码，因为它不知道。就它而言，它只是一堆字节。您必须找到某种方法将编码传达给程序，以某种方式检测它，或者（如果可能）始终确保编码相同（例如 UTF-8）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T15:21:37.980

您以这种方式读取文件是否有特殊原因？

如果您正在阅读 ASCII 文件，那么您真的应该使用阅读器。

我会这样做：

```
File inputFile = new File("somefile.txt");
BufferedReader reader = new BufferedReader(new FileReader(inputFile)); 
```

然后使用其中一个`readLine`或类似来实际读取数据！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T15:20:40.417

是的，它是 Unicode。

如果你的文件中有 14 个字符，你只会得到 7 个“？”。

解决方案待定。仍然在想。

# rss - 将 RSS 添加到任何网站？

> ID：93439
> 
> 赞同：2
> 
> 时间：2008-09-18T15:11:20.970
> 
> 标签：rss, screen-scraping

是否有任何网站/服务可以让我将 RSS 订阅添加到任何网站？

这是为了我工作的公司。我们有一个显示公司相关新闻的网站。这些新闻由外部机构提供，它们会自动更新到我们的数据库中。我们的网站选择随机/新新闻并显示它们。我们正在考虑在我们的网站上添加“通过 RSS 订阅”按钮。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T15:16:01.643

如果您的数据库中有数据，那么自己创建一个相当简单——这里有一个简单的[教程](http://www.downes.ca/cgi-bin/page.cgi?post=56)。

设置提要后，在页面的 <head> 中输入如下文本：

```
<link rel="alternate" title="RSS Feed" 
    href="http://www.example.com/rss-feed/latest/" type="application/rss+xml" /> 
```

这允许您的用户浏览器“自动发现”提要（例如，RSS 图标出现在 FF 的地址栏中）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T15:19:39.623

这是一篇讨论将生成提要的各种网络爬虫的文章：http: [//www.masternewmedia.org/news/2006/03/09/how_to_create_a_rss.htm](http://www.masternewmedia.org/news/2006/03/09/how_to_create_a_rss.htm)

如果您不想点击，这里是作者讨论的服务：

*   [http://www.feedyes.com/](http://www.feedyes.com/)
*   [http://www.feed43.com/](http://www.feed43.com/)
*   [http://www.feedfire.com/site/index.html](http://www.feedfire.com/site/index.html)

其他答案中建议的其他网络爬虫：

*   [http://page2rss.com/](http://page2rss.com/)
*   [http://www.dapper.net/](http://www.dapper.net/)

但是，您最好从数据库中的信息自己生成提要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T15:13:46.017

你的问题有点难以理解。您是在尝试生成 RSS 供其他人使用，还是在尝试使用其他人的 RSS？

如果您尝试生成您的 RSS 提要供其他人使用，您需要阅读规范：

[http://cyber.law.harvard.edu/rss/rss.html](http://cyber.law.harvard.edu/rss/rss.html)

如果您尝试使用它，该链接也会有所帮助。然后你需要研究一个 XML / RSS 解析器。

如果您可以提供更多详细信息，我可以更新我的答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T15:16:42.330

如果您无法将 RSS 提要添加到现有站点，请参阅[Page2Rss](http://page2rss.com/)作为中间解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T15:17:11.673

[Dapper](http://www.dapper.net/)可能有用吗？您只需要设置新闻提要的哪些位来搜索和瞧，即时 rss，而无需触摸任何代码...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-02T04:40:20.770

实际上，这对于 Yahoo! 来说是非常可行的。管道。假设 1）您的页面小于 200k，2）您的 robots.txt 文件不允许管道，以及 3）您的新闻提要具有唯一 ID，如下所示：

```
<ul id="newsfeed"> 
```

...您可以使用 Fetch Page 模块，将其修剪为仅新闻提要中的项目，循环遍历每个列表项，并使用 Item Builder 模块将相关位作为适当的 RSS 提要进行处理。然后，在文档的开头，您将输入一个 RSS 链接，如下所示：

```
<link rel="alternate" type="application/atom+xml" title="News Feed" href="http://pipes.yahoo.com/your_pipe_id" /> 
```

这当然是完全倒退的，但可以用于快速修复，或者在您无法控制页面正文的情况下。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T15:14:43.923

编写一个将数据库内容公开为 RSS 提要的 web 处理程序。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T15:17:18.847

您要么需要自己动手，要么获得屏幕刮板服务。

创建提要后，您可以使用[Feedburner](http://www.feedburner.com/fb/a/home)之类的工具来传播它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T15:40:07.997

如果您碰巧在使用 ASP.NET，则可能需要查看[ASP.NET RSS Toolkit](http://www.codeplex.com/ASPNETRSSToolkit)。它对于生成和使用提要都很有用。

# encryption - AES（128 或 256）加密是否会扩展数据？如果是这样，多少？

> ID：93451
> 
> 赞同：45
> 
> 时间：2008-09-18T15:12:19.267
> 
> 标签：encryption, compression, aes

我想为软件产品添加 AES 加密，但担心会增加数据的大小。我猜数据的大小确实会增加，然后我必须添加一个压缩算法来补偿。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-09-18T15:14:24.563

AES 不扩展数据。此外，输出通常不可压缩；如果您打算压缩数据，请在加密之前执行此操作。

但是，请注意 AES 加密通常与[padding](https://en.wikipedia.org/wiki/Padding_%28cryptography%29)结合使用，这*会*增加数据的大小（尽管只有几个字节）。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-09-18T15:16:29.037

AES 不扩展数据，除了最后一个块末尾的几个字节填充。

无论如何，生成的数据是不可压缩的，因为它们基本上是随机的——没有基于字典的算法能够有效地压缩它们。最佳做法是先压缩数据，然后再加密。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-18T15:31:47.487

在加密之前压缩数据是很常见的。之后压缩它不起作用，因为 AES 加密数据看起来是随机的（对于任何好的密码，除了任何标头和诸如此类的东西）。

但是，压缩在某些情况下会引入侧信道攻击，因此您必须分析自己的使用情况。最近报告了针对加密 VOIP 的此类攻击：要点是不同的音节在使用 VBR 压缩时会产生比特率的特征变化，因为有些声音比其他声音压缩得更好。因此，一些（或所有）音节可以通过充分的分析来恢复，因为数据是以它生成的速率传输的。解决方法是使用（效率较低的）CBR 压缩，或者使用缓冲区以恒定速率传输，而不管来自编码器的数据速率如何（增加延迟）。

AES 将 16 字节输入块转换为 16 字节输出块。唯一的扩展是将数据四舍五入到整数个块。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-18T15:15:59.960

我相当肯定 AES 加密不会对被加密的数据添加任何内容，因为这会泄露有关状态变量的信息，而这对于密码学来说是一件坏事。

如果您想混合压缩和加密，请按此顺序进行。原因是加密数据（理想情况下）看起来像完全随机的数据，并且压缩算法最终会使数据变得更大，因为它无法实际压缩任何数据以及任何压缩文件格式附带的簿记开销。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T15:16:24.827

如果需要压缩，请在加密之前进行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T15:18:08.520

不会。唯一的变化是少量的填充以将数据与块的大小对齐

但是，如果您正在压缩内容，请注意您应该在加密*之前执行此操作。*加密数据通常应该与随机数据无法区分，这意味着它不会压缩。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T15:23:48.363

@freespace 和其他人：我从我的密码学课程中记得的一件事是，您不应该在加密之前压缩您的数据，因为一些可重复的压缩流块（例如部分标题）可能会更容易破解您的加密。

# c# - 程序集名称和版本

> ID：93455
> 
> 赞同：3
> 
> 时间：2008-09-18T15:12:50.857
> 
> 标签：c#, assemblies, naming-conventions

在组装和发布方面，什么被认为是最佳实践？

我希望能够引用同一个库的多个版本 - 解决方案包含多个项目，这些项目依赖于我们自己构建的 commonutils.dll 库的不同版本。

由于所有依赖项都复制到 bin/debug 或 bin/release 中，因此尽管每个 DLL 文件具有不同的程序集版本号，但那里只能存在一个 commonutils.dll 副本。

我应该在程序集名称中包含版本号以便能够引用库的多个版本还是有其他方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T15:19:48.157

鉴于版本不同，即使它们具有相同的名称，程序集也可以在 GAC（全局程序集缓存）中共存。这就是 .NET Framework 提供的程序集的工作方式。为了使程序集能够被 GAC 注册，必须满足的要求将被签署。

在程序集的名称中添加版本号只会破坏程序集生态系统的整个目的，而且恕我直言很麻烦。要知道给定程序集的哪个版本，我只需打开“属性”窗口并检查版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T15:27:54.220

这就是我一直以来的生活——

这取决于您计划使用 DLL 文件的目的。我将它们分为两大类：

1.  死胡同组件。这些是您真正不打算从任何地方引用的 EXE 文件和 DLL 文件。只需轻轻地命名这些，并确保您在源代码控制中标记了您发布的版本号，以便您可以随时回滚。

2.  引用的程序集。强命名这些，以便您可以让其他程序集引用它的多个版本。使用全名来引用它们 (Assembly.Load)。在其他代码可以引用它的地方保留一份最新和最好版本的副本。

接下来，您可以选择是否复制本地引用。基本上，权衡归结为——你想从你的参考资料中获取补丁/升级吗？获得新功能可能会带来积极的价值，但另一方面，也可能会发生重大变化。我认为，这里的决定应该根据具体情况做出。

在 Visual Studio 中开发时，默认情况下您将使用最新版本进行*编译*，但一旦编译，引用程序集将需要编译时使用的特定版本。

您的最后决定是是否复制本地。基本上，如果您已经有了部署引用程序集的机制，请将其设置为 false。

如果您正在计划一个大型的发布管理系统，您可能需要为此付出更多的思考和关注。对我（小店——两个人）来说，这很好用。我们知道发生了什么，并且不会因为*不得不*以没有意义的方式做事而感到拘束。

到达运行时后，您将 Assembly.Load 任何您想要的内容放入[应用程序域](http://en.wikipedia.org/wiki/Application_Domain)。然后，您可以使用 Assembly.GetType 来达到您想要的类型。如果您的类型存在于多个加载的程序集中（例如在同一项目的多个版本中），您可能会收到[AmbiguousMatchException](http://msdn.microsoft.com/en-us/library/system.reflection.ambiguousmatchexception.aspx)异常。为了解决这个问题，您需要从程序集变量的实例中获取类型，而不是静态的 Assembly.GetType 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T15:24:53.290

为不同的程序集版本赋予不同的名称是最简单的方法，而且肯定有效。

如果您的程序集（commonutils.dll）是强名称（即签名），您可以考虑在 GAC 中安装它（全局程序集缓存 - 您可以在 GAC 中并排安装同一程序集的不同版本），因此调用应用程序会自动从那里获取正确的版本，因为 .NET 类型包含程序集版本信息。

在您的 VS 项目中，您引用了正确版本的库，但您没有将其部署在应用程序文件夹中；您将其安装在 GAC 中（在应用程序设置期间）。

# windows - Windows 计划任务的实用替代方案（小商店）

> ID：93460
> 
> 赞同：23
> 
> 时间：2008-09-18T15:13:48.000
> 
> 标签：windows, scheduling

我在一家很小的商店（2 人）工作，自从几个月前开始工作以来，我们一直依赖 Windows 计划任务。最后，我已经决定我已经对它的一些无能感到受够了悲伤，例如

1.  除了域级别之外，我找不到任何日志（非域管理员的机器管理员无法访问）
2.  作业失败时没有警报机制（例如电子邮件）。

再一次，我们是一家小商店。我希望进行与源代码控制（VSS --> Subversion）类似的调度系统升级。我正在寻找有关系统的建议

1.  能够做上述两件事
2.  已通过社区测试。我很想成为令人兴奋的软件的豚鼠，但工作安排不是我的日常工作。
3.  能够远程管理工作的加分项
4.  免费加分。便宜没关系，但我对通过 7 个 power point 演示进行完整的销售宣传几乎没有兴趣。
5.  除了 .EXE 的（次要）加号（按名称运行程序集、按名称运行 Excel 宏、运行数据库存储过程等）之外，内置运行常见任务的能力。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-18T15:27:51.413

我想你可以看看：

[http://www.visualcron.com/](http://www.visualcron.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T15:23:46.087

考虑 Cygwin 及其版本的“cron”。它满足 #1 到 4 的要求（尽管 #3 没有漂亮的 UI。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-31T13:17:38.267

为在一个非常古老的线程上扬起灰尘而道歉。但我完全不同意这里介绍的内容。

Windows 中的计划任务非常棒（%^#% 负载比我可能添加的编写服务更好）。是的，并非没有限制。但仍然非常强大。我在各种不同的事情上真诚地依赖他们。

如果您甚至对 c# 有*一点*了解，您可以编写自定义“任务”（本质上是一个控制台应用程序）来完成几乎任何事情。如果持久/可访问的日志记录是您所追求的，为什么不[使用 Serilog](https://serilog.net/)或[NLog](http://nlog-project.org/)之类的东西呢？即使在撰写本文时，它也具有非常强大的功能集。这个工具本身，结合一些 c#，可以很容易地解决你的两个问题。

也许我没有抓住重点，但在我看来这并不是一个真正的问题。至少现在不会了……

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T15:26:41.120

如果您正在寻找免费工具，那么流行的 Windows Cron 工具有很多实现，例如[CRONw](http://cronw.sourceforge.net/)。它很容易配置和维护。您可以轻松编写添加自定义 WSH 脚本来发送电子邮件和添加日志条目。

如果您采用商业方式，BMC Control-M 可以说是最好的之一，但我不认为它特别便宜。

您还可以考虑一些即将推出的软件包，例如[JobScheduler](http://jobscheduler.sourceforge.net/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-13T14:41:24.987

很老的问题，但我们使用[Jenkins](https://jenkins.io/)。是的，它的主要目的是用于 CI\CD，但它也是 CRON 的一个非常好的 UI，具有大量的插件和集成。

# sql-server - SQL Server Express DB 处于“恢复中”-如何检测/知道何时恢复

> ID：93462
> 
> 赞同：0
> 
> 时间：2008-09-18T15:13:51.977
> 
> 标签：sql-server, sql-server-2005, sql-server-express

当 SQL Server Express DB 处于“恢复中”时，您无法使用 SQL 身份验证进行连接。

有没有一种简单的方法可以在连接之前确定数据库的状态？（使用.Net）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T15:30:12.233

```
SELECT DATABASEPROPERTYEX ('master', 'STATUS') AS 'Status'; 
```

将“master”替换为您的数据库名称

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-13T01:37:05.673

这是一个诡计的问题。您仍然需要连接到服务器本身，而不是连接到那个特定的数据库，但要指定一个不同的数据库。连接时，您的默认数据库可能是正在恢复的数据库。在这种情况下，您需要在连接时指定不同的数据库，然后发出查询以检查数据库的扩展属性。

不幸的是，这意味着您的 SQL 登录将需要对您将连接到的其他数据库的权限，并且需要权限来查询数据库的扩展属性。

# .net - 跨虚拟站点调用 .NET 对象/dll

> ID：93468
> 
> 赞同：0
> 
> 时间：2008-09-18T15:15:05.593
> 
> 标签：.net

站点 1 具有用于 x 数量的对象和数据调用的 dll。站点 2（一个单独的 .net Web 应用程序）可以调用站点 1 的对象/dll 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T15:18:14.073

这可能更具语义：

您不能调用另一个进程的对象。但是，只要在调用 Web 应用程序中有对该 dll 的引用，您就可以在 dll 中实例化一个类。

如果您对 dll 进行 GAC，则整个机器都可以访问类（而不是对象）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T15:22:47.727

我从未使用过 .NET Remoting，但这不是它可以解决的问题吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T15:28:38.960

我对这种情况的理解是，因为你无法访问 Bin 目录跨站，你需要开发一个 api 或 web 服务。最好的办法是在每台服务器上都有 dll 的本地副本。

# c# - DateTimePicker：选择日期和时间

> ID：93472
> 
> 赞同：155
> 
> 时间：2008-09-18T15:15:37.573
> 
> 标签：c#, .net, winforms, datetimepicker

是否可以使用 DateTimePicker (Winforms) 来选择日期和时间（在下拉列表中）？如何更改选取值的自定义显示？另外，是否可以让用户手动输入日期/时间？

* * *

## 回答 #1

> 赞同：199
> 
> 时间：2008-09-18T15:32:37.500

将格式设置为自定义，然后指定格式：

```
dateTimePicker1.Format = DateTimePickerFormat.Custom;
dateTimePicker1.CustomFormat = "MM/dd/yyyy hh:mm:ss"; 
```

或者无论如何你想布置它。然后您可以直接输入日期/时间。如果您使用 MMM，则需要使用月份的数值输入，除非您自己为此编写一些代码（例如，5 月份的 5 个结果）

不知道一起选择日期和时间的选择器。对我来说听起来像是一个自定义控件。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2015-05-15T12:34:59.887

最好为作业使用两个 DateTimePicker 一个是日期部分的默认值，第二个 DateTimePicker 是时间部分的默认值。如下格式化第二个 DateTimePicker。

```
 timePortionDateTimePicker.Format = DateTimePickerFormat.Time;
      timePortionDateTimePicker.ShowUpDown = true; 
```

捕获它们后，两个应该看起来像这样

![两个日期时间选择器](https://i.stack.imgur.com/x94Oa.jpg)

要从这两个控件中获取 DateTime，请使用以下代码

```
DateTime myDate = datePortionDateTimePicker.Value.Date + 
                    timePortionDateTimePicker.Value.TimeOfDay; 
```

要将 DateTime 分配给这两个控件，请使用以下代码

```
datePortionDateTimePicker.Value  = myDate.Date;  
timePortionDateTimePicker.Value  = myDate.TimeOfDay; 
```

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2008-09-18T15:31:37.300

不幸的是，这是框架中的许多用词不当之一，或者充其量是对 SRP 的违反。

要将 DateTimePicker 用于时间，请将 Format 属性设置为 Time 或 Custom（如果要使用 CustomFormat 属性控制时间格式，请使用 Custom）。然后将 ShowUpDown 属性设置为 true。

尽管用户可以手动设置日期和时间，但他们不能使用 GUI 来设置两者。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-08-20T10:02:46.800

DateTime Picker 可用于选择日期和时间，这就是它被称为“日期和时间选择器”的原因。您可以将“**格式**”属性设置为“**自定义”，并在“自定义****格式**”属性中设置不同格式说明符的组合以表示/选择不同格式的日期/时间。但是，如果您想更改日期，则可以使用弹出日历，而在选择时间的情况下（在同一控件中，您必须使用向上/向下键来更改值。

例如，自定义格式“ **ddddd, MMMM dd, yyyy hh:mm:ss tt** ”将为您提供如下结果：“ **Thursday, August 20, 2009 02:55:23 PM** ”。

您可以使用格式说明符的不同组合来满足您的需要，例如**MMMM**将给出“ **August** ”，而**MM**将给出“ **Aug** ”

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2017-01-10T22:32:56.007

转到Visual Studio 中`Properties`的并设置为. 在输入您的格式下。在我的情况下，我使用`dateTimePicker``Format``Custom``CustomFormat``MMMMdd, yyyy | hh:mm`

[![在此处输入图像描述](https://i.stack.imgur.com/hRxNy.jpg)](https://i.stack.imgur.com/hRxNy.jpg)
[![日期时间选择器属性](https://i.stack.imgur.com/3ATE4.jpg)](https://i.stack.imgur.com/3ATE4.jpg)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T15:35:17.650

你可以让它显示[时间](http://msdn.microsoft.com/en-us/library/ms229631.aspx)。从那你可能必须有两个控件（一个日期，一个时间）来完成你想要的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T15:35:44.857

恐怕 DateTimePicker 控件没有能力做这些事情。这是一个非常基本（而且令人沮丧！）的控制。您最好的选择可能是找到一个可以满足您需求的第三方控件。

对于手动键入日期和时间的选项，您可以使用 TextBox/DateTimePicker 组合构建自定义组件来完成此操作，如果第三方控件不是选项，它可能会工作得相当好。

# asp-classic - IIS 6.0 中的经典 ASP 无法缩放

> ID：93474
> 
> 赞同：1
> 
> 时间：2008-09-18T15:15:45.590
> 
> 标签：asp-classic, iis-6, scalability

IIS 6.0 以串行方式（一次一个）为我的经典 ASP 页面提供服务

仅当 #1 请求结束时，Web 服务器才会处理 #2 请求。

如果 #1 请求需要更长的时间，则 #2 请求将不得不等待 #1 结束才能开始由 IIS 处理。

**这是 IIS 中的错误配置吗？**

操作系统为Windows Server 2003 Standard Edition (Service Pack 2)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T15:21:46.543

是的，IIS 或站点很可能配置为进行服务器端调试，这会导致对站点的所有请求都通过单个线程。

要检查是否是这种情况/将其关闭：

1.  在任何网站或 Web 虚拟目录的属性页面中，单击主目录或虚拟目录选项卡。
2.  在应用程序设置下，单击配置。必须创建应用程序才能使按钮处于活动状态。
3.  单击调试选项卡。
4.  取消选中启用 ASP 服务器端脚本调试复选框。

（以上步骤复制自在 IIS知识库文章中[调试 ASP 应用程序）](http://msdn.microsoft.com/en-us/library/ms525253.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T15:22:32.843

这是否发生在机器上？就像您开始在一台计算机上加载页面，然后另一台计算机被阻止？我在一台计算机上看到了这个，但这只是因为浏览器限制了与服务器的连接

# asp.net - 跨回发保持复选框状态

> ID：93482
> 
> 赞同：3
> 
> 时间：2008-09-18T15:16:23.467
> 
> 标签：asp.net

我有一个 Web 表单，它将 DataGrid 绑定到每个回发时通常不同的数据源。我有一个静态的 CheckBox 列，它总是出现在自动生成的列的左侧。我通过网格上方的水平菜单控件实现了 TabControl 效果，每个菜单项都是包含不同网格的选项卡。

Now I would like to persist the state of these checkboxes for a particular 'tab', when another tab is selected. 在不使用会话变量的情况下，我欢迎任何富有想象力的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T15:24:13.607

我认为最好的办法是为每个“标签”设置不同的网格视图。将 MultiView 控件与每个选项卡的 View 控件和每个 View 中的 gridview 一起使用。在您的菜单的单击事件中更改为正确的视图。只绑定每个 gridview 一次，然后您的复选框将持续存在。

# c# - 如何在 C# VSTO 3 的 word doc 中验证具有给定 ID 的表是否存在

> ID：93506
> 
> 赞同：2
> 
> 时间：2008-09-18T15:19:11.700
> 
> 标签：c#, ms-word, vsto, iqueryable, officedev

我想在 C#（VS 2008）Visual Studio Tools for Office（版本 3）的 word 文档中检查是否存在具有给定 ID 的表。

显然，我可以遍历文档的 Tables 集合并检查每个 ID，但这似乎效率低下；在我完成后，该文档最终将有几十个表，虽然我知道这不是很多，但循环遍历集合似乎很草率。Tables 集合仅由整数 id 索引，而不是由分配给表的字符串 ID 索引，因此我不能只使用索引，并且文档或表集合没有明显的 Exists 方法。

我想过使用 AsQueryable() 将 Tables 集合转换为 IQueryable，但我不知道如何以可以通过 ID 查询它的方式执行此操作。

指向文档或示例代码的指针将不胜感激，或者如果有更好的方法来解决它，我也完全赞成

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T18:01:18.970

我不认为有更好的方法来做到这一点。包括 IQueryable 在内的任何解决方案都可能需要在内部迭代集合，因此不会更快。

无论如何，性能不太可能成为问题，所以我不会担心效率低下。

如果您经常这样做，您可以提供一个包装器，该包装器对表进行一次迭代并生成一个您随后使用的字典。

# xml - xsl:for-each 循环内的计数器

> ID：93511
> 
> 赞同：92
> 
> 时间：2008-09-18T15:19:43.927
> 
> 标签：xml, xslt, loops

如何在 xsl:for-each 循环中获取一个计数器，以反映当前处理的元素数量。
例如我的源 XML 是

```
<books>
    <book>
        <title>The Unbearable Lightness of Being </title>
    </book>
    <book>
        <title>Narcissus and Goldmund</title>
    </book>
    <book>
        <title>Choke</title>
    </book>
</books> 
```

我想要得到的是：

```
<newBooks>
    <newBook>
        <countNo>1</countNo>
        <title>The Unbearable Lightness of Being </title>
    </newBook>
    <newBook>
        <countNo>2</countNo>
        <title>Narcissus and Goldmund</title>
    </newBook>
    <newBook>
        <countNo>3</countNo>
        <title>Choke</title>
    </newBook>
</newBooks> 
```

要修改的 XSLT：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>
    <xsl:template match="/">
        <newBooks>
            <xsl:for-each select="books/book">
                <newBook>
                    <countNo>???</countNo>
                    <title>
                        <xsl:value-of select="title"/>
                    </title>
                </newBook>
            </xsl:for-each>
        </newBooks>
    </xsl:template>
</xsl:stylesheet> 
```

所以问题是用什么代替???。是否有任何标准关键字或者我只是必须声明一个变量并在循环内递增它？

由于问题很长，我可能应该期待一行或一个单词的答案:)

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2008-09-18T15:25:19.063

`position()`. 例如：

```
<countNo><xsl:value-of select="position()" /></countNo> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-18T15:26:27.687

尝试`<xsl:number format="1\. "/><xsl:value-of select="."/><xsl:text>`在 ??? 的位置插入。

注意“1.” - 这是数字格式。更多信息：[这里](http://www.xml.com/pub/a/2002/11/06/tr.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-18T15:28:11.723

尝试：

```
<xsl:value-of select="count(preceding-sibling::*) + 1" /> 
```

**编辑**- 在那里大脑冻结， position() 更直接！

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-11-20T01:05:46.900

您还可以在 Postion() 上运行条件语句，这在许多情况下都非常有用。

例如。

```
 <xsl:if test="(position( )) = 1">
     //Show header only once
    </xsl:if> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-18T15:26:25.627

```
 <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>
    <xsl:template match="/">
        <newBooks>
                <xsl:for-each select="books/book">
                        <newBook>
                                <countNo><xsl:value-of select="position()"/></countNo>
                                <title>
                                        <xsl:value-of select="title"/>
                                </title>
                        </newBook>
                </xsl:for-each>
        </newBooks>
    </xsl:template>
</xsl:stylesheet> 
```

# delphi - 如何使用 Delphi 在 TRichEdit 中添加超链接

> ID：93517
> 
> 赞同：4
> 
> 时间：2008-09-18T15:20:19.620
> 
> 标签：delphi, hyperlink, richedit

如何在 TRichEdit 中添加超链接（使用 Delphi）。

我需要有类似的东西：

“这是我的文字，点击这里做点什么。”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T15:36:23.670

根据[delphi.about.com上的](http://delphi.about.com)[这篇](http://delphi.about.com/od/vclusing/l/aa111803a.htm)文章

> 不幸的是，Delphi 对 RichEdit 控件的实现遗漏了该控件的最新版本（来自 Microsoft）中的许多功能。

您可以添加您自己的功能，如此[处](http://delphi.about.com/od/vclusing/l/aa111803a.htm)所述。

注意：[Delphi 2009](http://www.codegear.com/products/delphi/win32)刚刚发布，因此 TRichEdit 控件可能已更新以支持模式功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T15:58:36.220

如果你真的想要超链接等等，你可以查看 TRichView。[链接文本](http://trichview.com/resources/actions/actiontest.zip)中很好地展示了它的功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-19T18:55:24.080

我不知道是否在 About.com 文章中提到了它，但我认为值得一提的是，TRichEdit 中的超链接仅在 TRichEdit 本身直接放置在表单上（而不是在面板中）时才有效。

[http://www.scalabium.com/faq/dct0146.htm](http://www.scalabium.com/faq/dct0146.htm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T18:45:13.293

The richedit in [Infopower](http://woll2woll.com/InfoPower.html) supports hyperlinks.

# functional-programming - 什么是 Y 组合器？

> ID：93526
> 
> 赞同：423
> 
> 时间：2008-09-18T15:21:02.520
> 
> 标签：functional-programming, computer-science, theory, definition, combinators

Y 组合器是从事物的“功能”方面来看的计算机科学概念。大多数程序员对组合子一无所知，即使他们听说过它们。

*   什么是 Y 组合器？
*   组合器如何工作？
*   它们有什么用？
*   它们在程序语言中有用吗？

* * *

## 回答 #1

> 赞同：304
> 
> 时间：2008-09-18T16:15:48.910

Y-combinator 是一种“函数式”（一种对其他函数进行操作的函数），当您无法从其内部引用该函数时，它可以实现递归。在计算机科学理论中，它**概括了递归**，抽象了它的实现，从而将它与相关函数的实际工作分开。递归函数不需要编译时名称的好处是一种奖励。=)

这适用于支持[lambda 函数](http://en.wikipedia.org/wiki/Lambda_calculus)的语言。lambda基于[表达式](http://en.wikipedia.org/wiki/Expression_(programming))的性质通常意味着它们不能通过名称引用自己。通过声明变量、引用它、然后将 lambda 分配给它来完成自引用循环来解决这个问题是很脆弱的。可以复制 lambda 变量，并重新分配原始变量，这会破坏自引用。

Y-组合器在[静态类型](http://en.wikipedia.org/wiki/Type_system#Type_checking)语言（[过程语言](http://en.wikipedia.org/wiki/Procedural_programming)通常是）中实现并且经常使用很麻烦，因为通常类型限制需要在编译时知道所讨论函数的参数数量。这意味着必须为需要使用的任何参数计数编写 y 组合器。

以下是 C# 中 Y-Combinator 如何使用和工作的示例。

使用 Y 组合器涉及构造递归函数的“不寻常”方式。首先，您必须将您的函数编写为一段代码，该代码调用预先存在的函数，而不是它本身：

```
// Factorial, if func does the same thing as this bit of code...
x == 0 ? 1: x * func(x - 1); 
```

然后你把它变成一个函数，它需要一个函数来调用，并返回一个这样做的函数。这被称为函数，因为它接受一个函数，并用它执行一个操作，从而产生另一个函数。

```
// A function that creates a factorial, but only if you pass in
// a function that does what the inner function is doing.
Func<Func<Double, Double>, Func<Double, Double>> fact =
  (recurs) =>
    (x) =>
      x == 0 ? 1 : x * recurs(x - 1); 
```

现在你有一个函数，它接受一个函数，并返回另一个看起来像阶乘的函数，但它不是调用自身，而是调用传递给外部函数的参数。你如何使它成为阶乘？将内部函数传递给自身。Y-Combinator 通过作为一个具有永久名称的函数来做到这一点，它可以引入递归。

```
// One-argument Y-Combinator.
public static Func<T, TResult> Y<T, TResult>(Func<Func<T, TResult>, Func<T, TResult>> F)
{
  return
    t =>  // A function that...
      F(  // Calls the factorial creator, passing in...
        Y(F)  // The result of this same Y-combinator function call...
              // (Here is where the recursion is introduced.)
        )
      (t); // And passes the argument into the work function.
} 
```

而不是阶乘调用本身，发生的是阶乘调用阶乘生成器（通过对 Y-Combinator 的递归调用返回）。并且根据 t 的当前值，从生成器返回的函数将使用 t - 1 再次调用生成器，或者只返回 1，终止递归。

它既复杂又神秘，但在运行时一切都变了，其工作的关键是“延迟执行”，以及将递归分解为跨越两个函数。内部 F**作为参数传递，****仅在必要时**在下一次迭代中调用。

* * *

## 回答 #2

> 赞同：224
> 
> 时间：2008-09-18T15:23:03.500

如果您准备好阅读全文，[Mike Vanier 有一个*很好的*解释](http://mvanier.livejournal.com/2897.html)。长话短说，它允许您用一种不一定支持本机的语言来实现递归。

* * *

## 回答 #3

> 赞同：111
> 
> 时间：2011-07-15T21:39:20.197

我从[http://www.mail-archive.com/boston-pm@mail.pm.org/msg02716.html](http://www.mail-archive.com/boston-pm@mail.pm.org/msg02716.html)中提取了这个，这是我几年前写的一个解释。

我将在本例中使用 JavaScript，但许多其他语言也可以使用。

我们的目标是能够编写 1 个变量的递归函数，仅使用 1 个变量的函数，不使用赋值，按名称定义事物等。（为什么这是我们的目标是另一个问题，让我们把这个作为挑战'是给定的。）似乎不可能，是吧？例如，让我们实现阶乘。

第一步是说如果我们稍微作弊，我们就可以轻松做到这一点。使用 2 个变量和赋值的函数，我们至少可以避免必须使用赋值来设置递归。

```
// Here's the function that we want to recurse.
X = function (recurse, n) {
  if (0 == n)
    return 1;
  else
    return n * recurse(recurse, n - 1);
};

// This will get X to recurse.
Y = function (builder, n) {
  return builder(builder, n);
};

// Here it is in action.
Y(
  X,
  5
); 
```

现在让我们看看我们是否可以少作弊。好吧，首先我们使用分配，但我们不需要。我们可以只写 X 和 Y 内联。

```
// No assignment this time.
function (builder, n) {
  return builder(builder, n);
}(
  function (recurse, n) {
    if (0 == n)
      return 1;
    else
      return n * recurse(recurse, n - 1);
  },
  5
); 
```

但是我们使用 2 个变量的函数来获得 1 个变量的函数。我们能解决这个问题吗？好吧，一个名叫 Haskell Curry 的聪明人有一个巧妙的技巧，如果你有好的高阶函数，那么你只需要 1 个变量的函数。证明是，您可以通过像这样的纯机械文本转换从 2 个（或更多在一般情况下）变量的函数到 1 个变量：

```
// Original
F = function (i, j) {
  ...
};
F(i,j);

// Transformed
F = function (i) { return function (j) {
  ...
}};
F(i)(j); 
```

其中...保持完全相同。（这个技巧在它的发明者之后被称为“currying”。Haskell 语言也以 Haskell Curry 命名。在无用的琐事下归档。）现在只要在任何地方应用这个转换，我们就得到了我们的最终版本。

```
// The dreaded Y-combinator in action!
function (builder) { return function (n) {
  return builder(builder)(n);
}}(
  function (recurse) { return function (n) {
    if (0 == n)
      return 1;
    else
      return n * recurse(recurse)(n - 1);
  }})(
  5
); 
```

随意尝试。alert() 返回，将其绑定到一个按钮，无论如何。该代码递归地计算阶乘，而不使用 2 个变量的赋值、声明或函数。（但试图追踪它是如何工作的可能会让你头晕目眩。如果没有推导，只需稍微重新格式化就会导致代码肯定会令人困惑和困惑。）

您可以将递归定义阶乘的 4 行替换为您想要的任何其他递归函数。

* * *

## 回答 #4

> 赞同：89
> 
> 时间：2011-07-15T23:05:33.493

我想知道尝试从头开始构建它是否有任何用处。让我们来看看。这是一个基本的递归阶乘函数：

```
function factorial(n) {
    return n == 0 ? 1 : n * factorial(n - 1);
} 
```

让我们重构并创建一个名为`fact`返回匿名阶乘计算函数的新函数，而不是执行计算本身：

```
function fact() {
    return function(n) {
        return n == 0 ? 1 : n * fact()(n - 1);
    };
}

var factorial = fact(); 
```

这有点奇怪，但这并没有什么问题。我们只是在每一步生成一个新的阶乘函数。

这个阶段的递归仍然相当明确。该`fact`函数需要知道它自己的名称。让我们参数化递归调用：

```
function fact(recurse) {
    return function(n) {
        return n == 0 ? 1 : n * recurse(n - 1);
    };
}

function recurser(x) {
    return fact(recurser)(x);
}

var factorial = fact(recurser); 
```

这很好，但`recurser`仍然需要知道它自己的名字。让我们也参数化它：

```
function recurser(f) {
    return fact(function(x) {
        return f(f)(x);
    });
}

var factorial = recurser(recurser); 
```

现在，`recurser(recurser)`让我们创建一个返回其结果的包装函数，而不是直接调用：

```
function Y() {
    return (function(f) {
        return f(f);
    })(recurser);
}

var factorial = Y(); 
```

我们现在可以完全摆脱这个`recurser`名字了；它只是 Y 内部函数的一个参数，可以用函数本身替换：

```
function Y() {
    return (function(f) {
        return f(f);
    })(function(f) {
        return fact(function(x) {
            return f(f)(x);
        });
    });
}

var factorial = Y(); 
```

唯一仍然引用的外部名称是`fact`，但现在应该很清楚，这也很容易参数化，创建完整的通用解决方案：

```
function Y(le) {
    return (function(f) {
        return f(f);
    })(function(f) {
        return le(function(x) {
            return f(f)(x);
        });
    });
}

var factorial = Y(function(recurse) {
    return function(n) {
        return n == 0 ? 1 : n * recurse(n - 1);
    };
}); 
```

* * *

## 回答 #5

> 赞同：52
> 
> 时间：2011-07-16T18:55:25.037

上面的大多数答案都描述了 Y 组合*器是*什么，但没有描述它的*用途*。

[定点组合](http://en.wikipedia.org/wiki/Fixed_point_combinator)器用于表明[lambda 演算](http://en.wikipedia.org/wiki/Lambda_calculus)是[图灵完备](http://en.wikipedia.org/wiki/Turing_completeness)的。这是计算理论中一个非常重要的成果，为[函数式编程](https://en.wikipedia.org/wiki/Functional_programming)提供了理论基础。

学习定点组合器也帮助我真正理解了函数式编程。不过，我在实际编程中从未发现它们有任何用途。

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2015-06-07T10:02:24.057

*对于没有深入接触过函数式编程的程序员，也不想从现在开始，但有点好奇：*

Y 组合子是一个公式，它允许您在函数不能有名称但可以作为参数传递、用作返回值以及在其他函数中定义的情况下实现递归。

它通过将函数作为参数传递给自身来工作，因此它可以调用自身。

它是 lambda 演算的一部分，它实际上是数学，但实际上是一种编程语言，对于计算机科学尤其是函数式编程非常基础。

Y 组合器的日常实用价值是有限的，因为编程语言倾向于让您命名函数。

如果您需要在警察阵容中识别它，它看起来像这样：

> Y = λf.(λx.f (xx)) (λx.f (xx))

由于重复，您通常可以发现它`(λx.f (x x))`。

这些`λ`符号是希腊字母 lambda，它给了 lambda 演算它的名字，并且有很多`(λx.t)`风格术语，因为这就是 lambda 演算的样子。

* * *

## 回答 #7

> 赞同：24
> 
> 时间：2008-09-18T15:27:32.817

[JavaScript](http://blog.jcoglan.com/2008/01/10/deriving-the-y-combinator/)中的 y 组合器：

```
var Y = function(f) {
  return (function(g) {
    return g(g);
  })(function(h) {
    return function() {
      return f(h(h)).apply(null, arguments);
    };
  });
};

var factorial = Y(function(recurse) {
  return function(x) {
    return x == 0 ? 1 : x * recurse(x-1);
  };
});

factorial(5)  // -> 120 
```

**编辑**：我从查看代码中学到了很多东西，但是如果没有一些背景知识，这有点难以接受 - 对此感到抱歉。借助其他答案提供的一些一般知识，您可以开始区分正在发生的事情。

Y 函数是“y 组合器”。现在看一下`var factorial`使用 Y 的行。请注意，您将一个函数传递给它，该函数具有一个参数（在本例中`recurse`为 ），该参数稍后也会在内部函数中使用。参数名称基本上成为内部函数的名称，允许它执行递归调用（因为它`recurse()`在它的定义中使用。）y 组合器执行将其他匿名内部函数与传递给的函数的参数名称相关联的魔力Y。

有关 Y 如何发挥魔力的完整说明，请查看[链接文章](http://blog.jcoglan.com/2008/01/10/deriving-the-y-combinator/)（顺便说一句，不是我写的。）

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2017-10-05T22:16:32.743

## 匿名递归

定点组合器是一个高阶函数`fix`，根据定义满足等价

```
forall f.  fix f  =  f (fix f) 
```

`fix f`表示`x`定点方程的解

```
 x  =  f x 
```

自然数的阶乘可以证明为

```
fact 0 = 1
fact n = n * fact (n - 1) 
```

使用`fix`，可以在没有匿名自引用的情况下推导出对一般/μ-递归函数的任意建设性证明。

```
fact n = (fix fact') n 
```

在哪里

```
fact' rec n = if n == 0
                then 1
                else n * rec (n - 1) 
```

这样

```
 fact 3
=  (fix fact') 3
=  fact' (fix fact') 3
=  if 3 == 0 then 1 else 3 * (fix fact') (3 - 1)
=  3 * (fix fact') 2
=  3 * fact' (fix fact') 2
=  3 * if 2 == 0 then 1 else 2 * (fix fact') (2 - 1)
=  3 * 2 * (fix fact') 1
=  3 * 2 * fact' (fix fact') 1
=  3 * 2 * if 1 == 0 then 1 else 1 * (fix fact') (1 - 1)
=  3 * 2 * 1 * (fix fact') 0
=  3 * 2 * 1 * fact' (fix fact') 0
=  3 * 2 * 1 * if 0 == 0 then 1 else 0 * (fix fact') (0 - 1)
=  3 * 2 * 1 * 1
=  6 
```

这个正式的证明

```
fact 3  =  6 
```

有条不紊地使用定点组合器等价进行*重写*

```
fix fact'  ->  fact' (fix fact') 
```

## Lambda演算

无*类型 lambda 演算*形式主义包括上下文无关文法

```
E ::= v        Variable
   |  λ v. E   Abstraction
   |  E E      Application 
```

其中`v`变量的范围，以及*beta*和*eta 减少*规则

```
(λ x. B) E  ->  B[x := E]                                 Beta
  λ x. E x  ->  E          if x doesn’t occur free in E   Eta 
```

Beta减少用表达式（“argument”）替换`x`抽象（“函数”）主体中变量的所有自由出现。Eta 减少消除了冗余抽象。它有时会从形式主义中省略。一个不适用任何归约规则的*不可归约*表达式是*正常*形式或*规范形式*。`B``E`

 ***```
λ x y. E 
```

是简写

```
λ x. λ y. E 
```

（抽象多元性），

```
E F G 
```

是简写

```
(E F) G 
```

（应用程序左关联性），

```
λ x. x 
```

和

```
λ y. y 
```

是*alpha 等效的*。

抽象和应用是 lambda 演算中仅有的两个“语言原语”，但它们允许对任意复杂的数据和操作进行*编码*。

Church 数字是自然数的编码，类似于 Peano-axiomatic naturals。

```
 0  =  λ f x. x                 No application
   1  =  λ f x. f x               One application
   2  =  λ f x. f (f x)           Twofold
   3  =  λ f x. f (f (f x))       Threefold
    . . .

SUCC  =  λ n f x. f (n f x)       Successor
 ADD  =  λ n m f x. n f (m f x)   Addition
MULT  =  λ n m f x. n (m f) x     Multiplication
    . . . 
```

正式证明

```
1 + 2  =  3 
```

使用 beta 减少的重写规则：

```
 ADD                      1            2
=  (λ n m f x. n f (m f x)) (λ g y. g y) (λ h z. h (h z))
=  (λ m f x. (λ g y. g y) f (m f x)) (λ h z. h (h z))
=  (λ m f x. (λ y. f y) (m f x)) (λ h z. h (h z))
=  (λ m f x. f (m f x)) (λ h z. h (h z))
=  λ f x. f ((λ h z. h (h z)) f x)
=  λ f x. f ((λ z. f (f z)) x)
=  λ f x. f (f (f x))                                       Normal form
=  3 
```

## 组合器

在 lambda 演算中，*组合*子是不包含自由变量的抽象。最简单的：`I`，身份组合器

```
λ x. x 
```

与恒等函数同构

```
id x = x 
```

*这样的组合子是组合子演算*的原始算子，如 SKI 系统。

```
S  =  λ x y z. x z (y z)
K  =  λ x y. x
I  =  λ x. x 
```

Beta 减少不是*强标准化*；并非所有可约表达式，“redexes”，在 beta 约简下都收敛到范式。一个简单的例子是欧米茄`ω`组合器的不同应用

```
λ x. x x 
```

对自己：

```
 (λ x. x x) (λ y. y y)
=  (λ y. y y) (λ y. y y)
. . .
=  _|_                     Bottom 
```

优先减少最左边的子表达式（“头”）。*应用顺序*在替换之前规范化参数，*正常顺序*不会。这两种策略类似于急切求值（例如 C）和惰性求值（例如 Haskell）。

```
 K          (I a)        (ω ω)
=  (λ k l. k) ((λ i. i) a) ((λ x. x x) (λ y. y y)) 
```

在急切的应用阶贝塔减少下发散

```
=  (λ k l. k) a ((λ x. x x) (λ y. y y))
=  (λ l. a) ((λ x. x x) (λ y. y y))
=  (λ l. a) ((λ y. y y) (λ y. y y))
. . .
=  _|_ 
```

因为在*严格*的语义中

```
forall f.  f _|_  =  _|_ 
```

但在惰性正态贝塔归约下收敛

```
=  (λ l. ((λ i. i) a)) ((λ x. x x) (λ y. y y))
=  (λ l. a) ((λ x. x x) (λ y. y y))
=  a 
```

如果表达式具有范式，则正常阶的 beta 归约会找到它。

## 是

*定点组合器*的基本性质`Y`

 *```
λ f. (λ x. f (x x)) (λ x. f (x x)) 
```

是（谁）给的

```
 Y g
=  (λ f. (λ x. f (x x)) (λ x. f (x x))) g
=  (λ x. g (x x)) (λ x. g (x x))           =  Y g
=  g ((λ x. g (x x)) (λ x. g (x x)))       =  g (Y g)
=  g (g ((λ x. g (x x)) (λ x. g (x x))))   =  g (g (Y g))
. . .                                      . . . 
```

等价性

```
Y g  =  g (Y g) 
```

同构于

```
fix f  =  f (fix f) 
```

无类型的 lambda 演算可以对一般/μ-递归函数的任意建设性证明进行编码。

```
 FACT  =  λ n. Y FACT' n
FACT'  =  λ rec n. if n == 0 then 1 else n * rec (n - 1)

   FACT 3
=  (λ n. Y FACT' n) 3
=  Y FACT' 3
=  FACT' (Y FACT') 3
=  if 3 == 0 then 1 else 3 * (Y FACT') (3 - 1)
=  3 * (Y FACT') (3 - 1)
=  3 * FACT' (Y FACT') 2
=  3 * if 2 == 0 then 1 else 2 * (Y FACT') (2 - 1)
=  3 * 2 * (Y FACT') 1
=  3 * 2 * FACT' (Y FACT') 1
=  3 * 2 * if 1 == 0 then 1 else 1 * (Y FACT') (1 - 1)
=  3 * 2 * 1 * (Y FACT') 0
=  3 * 2 * 1 * FACT' (Y FACT') 0
=  3 * 2 * 1 * if 0 == 0 then 1 else 0 * (Y FACT') (0 - 1)
=  3 * 2 * 1 * 1
=  6 
```

（乘法延迟，汇合）

对于 Churchian 无类型 lambda 演算，除了`Y`.

```
 X  =  λ f. (λ x. x x) (λ x. f (x x))
Y'  =  (λ x y. x y x) (λ y x. y (x y x))
 Z  =  λ f. (λ x. f (λ v. x x v)) (λ x. f (λ v. x x v))
 Θ  =  (λ x y. y (x x y)) (λ x y. y (x x y))
  . . . 
```

正常阶 beta 减少使未扩展的无类型 lambda 演算成为图灵完备的重写系统。

在 Haskell 中，定点组合器可以优雅地实现

```
fix :: forall t. (t -> t) -> t
fix f = f (fix f) 
```

在评估所有子表达式之前，Haskell 的惰性规范化为一个有限值。

```
primes :: Integral t => [t]
primes = sieve [2 ..]
   where
      sieve = fix (\ rec (p : ns) ->
                     p : rec [n | n <- ns
                                , n `rem` p /= 0]) 
```

* * *

*   David Turner：*[Church 的论文和函数式编程](https://www.cs.kent.ac.uk/people/staff/dat/miranda/ctfp.pdf)*
*   Alonzo Church：*[初等数论的一个无法解决的问题](https://www.ics.uci.edu/~lopes/teaching/inf212W12/readings/church.pdf)*
*   [Lambda演算](https://en.wikipedia.org/wiki/Lambda_calculus#Definition)
*   [Church-Rosser 定理](https://en.wikipedia.org/wiki/Church%E2%80%93Rosser_theorem)

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2011-07-16T02:19:22.727

其他答案对此提供了非常简洁的答案，但没有一个重要的事实：您不需要以这种复杂的方式以任何实用语言实现定点组合器，这样做没有任何实际目的（除了“看，我知道 Y 组合器是”）。这是一个重要的理论概念，但没有什么实用价值。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2010-12-27T05:28:32.577

这是 Y-Combinator 和 Factorial 函数的 JavaScript 实现（来自 Douglas Crockford 的文章，可在：http: [//javascript.crockford.com/little.html](http://javascript.crockford.com/little.html)获得）。

```
function Y(le) {
    return (function (f) {
        return f(f);
    }(function (f) {
        return le(function (x) {
            return f(f)(x);
        });
    }));
}

var factorial = Y(function (fac) {
    return function (n) {
        return n <= 2 ? n : n * fac(n - 1);
    };
});

var number120 = factorial(5); 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2013-06-05T23:00:54.887

Y-Combinator 是磁通电容器的另一个名称。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2009-07-03T03:05:25.580

我已经在 Clojure 和 Scheme 中为 Y-Combinator 编写了一种“白痴指南”，以帮助自己掌握它。他们受到“小阴谋家”中材料的影响

在方案中： [https ://gist.github.com/z5h/238891](https://gist.github.com/z5h/238891)

或 Clojure： [https ://gist.github.com/z5h/5102747](https://gist.github.com/z5h/5102747)

这两篇教程都是代码中散布着注释，应该剪切和粘贴到你最喜欢的编辑器中。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2017-07-11T13:46:00.537

作为组合器的新手，我发现[Mike Vanier 的文章](http://mvanier.livejournal.com/2897.html)（感谢 Nicholas Mancuso）非常有帮助。我想写一个总结，除了记录我的理解之外，如果它可以帮助其他人，我会很高兴。

### 从*蹩脚*到*不那么蹩脚*

以阶乘为例，我们使用以下`almost-factorial`函数来计算 number 的阶乘`x`：

```
def almost-factorial f x = if iszero x
                           then 1
                           else * x (f (- x 1)) 
```

在上面的伪代码`almost-factorial`中，传入函数`f`和数字`x`（`almost-factorial`被柯里化了，因此可以看作是传入函数`f`并返回一个 1-arity 函数）。

当`almost-factorial`计算`x`的阶乘时，它将阶乘的计算委托`x - 1`给函数`f`并将结果与`x`​​（在这种情况下，它将 (x - 1) 的结果与 x 相乘）累加。

它可以看作是`almost-factorial`接受了一个*糟糕*版本的阶乘函数（它只能计算直到 number `x - 1`）并返回一个*不太糟糕*的阶乘版本（它计算直到 number `x`）。如这种形式：

```
almost-factorial crappy-f = less-crappy-f 
```

如果我们反复将*不那么糟糕*的阶乘传递给`almost-factorial`，我们最终会得到我们想要的阶乘函数`f`。它可以被认为是：

```
almost-factorial f = f 
```

### 固定点

`almost-factorial f = f`意思是函数`f`的**固定点**`almost-factorial`。

这是查看上述函数关系的一种非常有趣的方式，这对我来说是一个惊喜时刻。（如果你还没有，请阅读 Mike 关于定点的帖子）

### 三个功能

概括地说，我们有一个**非递归**函数`fn`（比如我们的几乎阶乘），我们有它**的定点**函数`fr`（比如我们的 f），那么`Y`当你给出 时`Y` `fn`，会`Y`返回 的定点函数`fn`。

所以总而言之（通过假设`fr`只接受一个参数来简化；在递归中`x`退化为`x - 1`, ...）：`x - 2`

*   我们将**核心计算**定义为**`fn`**: `def fn fr x = ...accumulate x with result from (fr (- x 1))`，这是***几乎有用的***函数 - 虽然我们不能`fn`直接在 上使用`x`，但它很快就会有用。这个非递归`fn`使用一个函数`fr`来计算它的结果
*   `fn fr = fr`,**`fr`**是 的不动点`fn`,`fr`是***有用***的函数, 我们可以使用`fr`on`x`来得到我们的结果
*   `Y fn = fr`，**`Y`**返回一个函数的固定点，`Y` **把我们*几乎有用的*函数`fn`变成*有用的* `fr`**

### 派生`Y`（不包括在内）

我将跳过推导`Y`并去理解`Y`。Mike Vainer 的帖子有很多细节。

### 的形式`Y`

`Y`定义为（以*lambda 演算*格式）：

```
Y f = λs.(f (s s)) λs.(f (s s)) 
```

如果我们替换`s`函数左侧的变量，我们得到

```
Y f = λs.(f (s s)) λs.(f (s s))
=> f (λs.(f (s s)) λs.(f (s s)))
=> f (Y f) 
```

所以确实， 的结果`(Y f)`是 的不动点`f`。

### 为什么`(Y f)`有效？

根据 , 的签名`f`，`(Y f)`可以是任何数量的函数，为了简化，让我们假设`(Y f)`只接受一个参数，比如我们的阶乘函数。

```
def fn fr x = accumulate x (fr (- x 1)) 
```

因为`fn fr = fr`，我们继续

```
=> accumulate x (fn fr (- x 1))
=> accumulate x (accumulate (- x 1) (fr (- x 2)))
=> accumulate x (accumulate (- x 1) (accumulate (- x 2) ... (fn fr 1))) 
```

当最内层`(fn fr 1)`是基本情况并且`fn`不在计算中使用时，递归计算终止`fr`。

再看一遍`Y`：

```
fr = Y fn = λs.(fn (s s)) λs.(fn (s s))
=> fn (λs.(fn (s s)) λs.(fn (s s))) 
```

所以

```
fr x = Y fn x = fn (λs.(fn (s s)) λs.(fn (s s))) x 
```

对我来说，这个设置的神奇部分是：

*   `fn`并且`fr`相互依赖：`fr`“包裹”`fn`在里面，每次`fr`都用于计算`x`，它“产生”（“提升”？）`fn`并将计算委托给那个`fn`（传递自身`fr`和`x`）；另一方面，`fn`取决于`fr`和用于`fr`计算较小问题的结果`x-1`。
*   在`fr`用于定义`fn`时（在其操作中`fn`使用时），实际尚未定义。`fr``fr`
*   它`fn`定义了真正的业务逻辑。基于`fn`,`Y`创建`fr`- 特定形式的辅助函数 - 以促进`fn`递归*方式*的计算。

它帮助我目前理解`Y`这种方式，希望它有所帮助。

顺便说一句，我还发现[An Introduction to Functional Programming Through Lambda Calculus](https://rads.stackoverflow.com/amzn/click/com/B00CWR4USM)这本书非常好，我只是其中的一部分，而且我无法`Y`在书中理解这一事实导致我写了这篇文章。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2018-03-22T09:11:58.683

以下是[原始问题的](https://stackoverflow.com/q/93526/8554766)[答案，由 Nicholas Mancuso的答案中提到](https://stackoverflow.com/a/93538/8554766)[的文章](https://mvanier.livejournal.com/2897.html)（完全值得一读）以及其他答案汇编而成 ：

> 什么是 Y 组合器？

Y-combinator 是一个“函数式”（或高阶函数——一个对其他函数进行操作的函数），它接受一个参数，这是一个非递归函数，并返回该函数的一个版本递归的。

* * *

*有点递归=），但更深入的定义：*

组合器——只是一个没有自由变量的 lambda 表达式。
自由变量——是一个不是绑定变量的变量。
绑定变量 — 包含在 lambda 表达式主体内的变量，该变量名称作为其参数之一。

另一种思考方式是，combinator 就是这样一个 lambda 表达式，在其中你可以在任何地方用它的定义替换组合器的名称，并且一切仍然有效（如果组合器会包含对自身的引用，在 lambda 主体内）。

Y-combinator 是一个定点组合器。

函数的不动点是函数域中由函数映射到自身的元素。
也就是说，`c`是函数的一个不动点`f(x)`if`f(c) = c`
这意味着`f(f(...f(c)...)) = fn(c) = c`

> 组合器如何工作？

*下面的示例假设**强+动态**类型：*

**惰性（正常顺序）Y 组合器：**
*此定义适用于具有惰性（也：延迟，按需调用）评估的语言 - 一种评估策略，它将表达式的评估延迟到需要它的值为止。*

```
Y = λf.(λx.f(x x)) (λx.f(x x)) = λf.(λx.(x x)) (λx.f(x x)) 
```

这意味着，对于给定的函数`f`（这是一个非递归函数），可以先通过计算得到对应的递归函数`λx.f(x x)`，然后将这个 lambda 表达式应用于自身。

**严格（应用顺序）Y 组合器：**
*此定义适用于具有严格（也：急切、贪婪）评估的语言——其中表达式一绑定到变量就被评估的评估策略。*

```
Y = λf.(λx.f(λy.((x x) y))) (λx.f(λy.((x x) y))) = λf.(λx.(x x)) (λx.f(λy.((x x) y))) 
```

它本质上与惰性相同，只是有一个额外的`λ`包装器来延迟 lambda 的主体评估。我问[了另一个问题](https://stackoverflow.com/questions/49404583/self-self-call-inside-the-let-statement-in-strict-language)，与这个主题有些相关。

> 它们有什么用？

*~~借用[了 Chris Ammerman 的回答](https://stackoverflow.com/a/94056/8554766)~~*~~*~~：~~* Y-combinator 概括了递归，抽象了它的实现，从而将它与相关函数的实际工作分开。~~

 ~~尽管 Y-combinator 有一些实际应用，但它主要是一个理论概念，对它的理解将扩大您的整体视野，并可能提高您的分析和开发技能。

> 它们在程序语言中有用吗？

*正如[Mike Vanier 所说](https://mvanier.livejournal.com/2897.html)：*可以在许多静态类型语言中定义 Y 组合器，但是（至少在我见过的示例中）这样的定义通常需要一些不明显的类型骇客，因为 Y 组合器本身没有' t 有一个简单的静态类型。这超出了本文的范围，所以我不再赘述

正如[Chris Ammerman 所提到的](https://stackoverflow.com/a/94056/8554766)：大多数过程语言都有静态类型。

所以回答这个问题 - 不是真的。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-09-18T15:24:58.173

定点组合器（或定点运算符）是计算其他函数的不动点的高阶函数。此操作与编程语言理论相关，因为它允许以重写规则的形式实现递归，而无需语言运行时引擎的明确支持。（来源维基百科）

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2011-07-16T03:37:43.623

y-combinator 实现匿名递归。所以而不是

```
function fib( n ){ if( n<=1 ) return n; else return fib(n-1)+fib(n-2) } 
```

你可以做

```
function ( fib, n ){ if( n<=1 ) return n; else return fib(n-1)+fib(n-2) } 
```

当然，y-combinator 仅适用于按名称调用的语言。如果您想在任何普通的按值调用语言中使用它，那么您将需要相关的 z-combinator（y-combinator 将发散/无限循环）。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2017-05-02T16:04:20.340

this-operator 可以简化你的生活：

```
var Y = function(f) {
    return (function(g) {
        return g(g);
    })(function(h) {
        return function() {
            return f.apply(h(h), arguments);
        };
    });
}; 
```

然后你避免额外的功能：

```
var fac = Y(function(n) {
    return n == 0 ? 1 : n * this(n - 1);
}); 
```

最后，您调用`fac(5)`.

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-07-23T21:09:24.280

我认为回答这个问题的最好方法是选择一种语言，比如 JavaScript：

```
function factorial(num)
{
    // If the number is less than 0, reject it.
    if (num < 0) {
        return -1;
    }
    // If the number is 0, its factorial is 1.
    else if (num == 0) {
        return 1;
    }
    // Otherwise, call this recursive procedure again.
    else {
        return (num * factorial(num - 1));
    }
} 
```

现在重写它，使它不使用函数内部的函数名，但仍然递归调用它。

唯一`factorial`应该看到函数名称的地方是调用站点。

提示：不能使用函数名，但可以使用参数名。

解决问题。不要查。一旦你解决了它，你就会明白 y-combinator 解决了什么问题。

# sql - Oracle中的视图和物化视图有什么区别？

> ID：93539
> 
> 赞同：402
> 
> 时间：2008-09-18T15:23:18.070
> 
> 标签：sql, oracle, view, relational-database, materialized-views

Oracle中的视图和物化视图有什么区别？

* * *

## 回答 #1

> 赞同：413
> 
> 时间：2008-09-18T15:25:55.363

物化视图是基于磁盘的，并根据查询定义定期更新。

视图只是虚拟的，每次访问时都会运行查询定义。

* * *

## 回答 #2

> 赞同：373
> 
> 时间：2008-09-18T16:23:58.173

# 意见

**他们在查询视图时**评估基于视图定义的表中的数据。它是您的表的逻辑视图，没有数据存储在其他任何地方。

视图的好处是它**总是会返回最新的数据给你**。视图的**缺点是它的性能**取决于视图所基于的选择语句有多好。如果视图使用的 select 语句连接了许多表，或者使用了基于非索引列的连接，则视图的性能可能会很差。

# 物化视图

它们类似于常规视图，因为它们是数据的逻辑视图（基于 select 语句），但是，**基础查询结果集已保存到 table**。这样做的好处是，当您查询物化视图时，**您正在查询一个表**，该表也可能被索引。

此外，由于所有连接都在实体化视图刷新时解决，因此您只需支付一次连接的费用（或刷新实体化视图的频率），而不是每次从实体化视图中进行选择。此外，启用查询重写后，Oracle 可以优化从您的物化视图源中选择的查询，从而改为从您的物化视图中读取。在您将物化视图创建为聚合表形式或频繁执行查询的副本的情况下，这可以大大加快最终用户应用程序的响应时间。但**不利的一面是，您从物化视图返回的数据仅与上次刷新物化视图时一样是最新的**。

* * *

物化视图可以设置为手动刷新、按设定的时间表刷新，或者*基于数据库检测到来自其中一个基础表的数据变化*。物化视图可以通过与物化视图日志相结合来增量更新，物化视图日志**充当**基础表上的更改数据捕获源。

物化视图最常用于数据仓库/商业智能应用程序中，在这些应用程序中查询具有数百万行的大型事实表会导致查询响应时间缩短，从而导致应用程序无法使用。

* * *

物化视图也有助于保证时刻的一致，类似于[快照隔离](https://en.wikipedia.org/wiki/Snapshot_isolation)。

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2008-09-18T15:28:05.267

视图使用查询从基础表中提取数据。

物化视图是磁盘上包含查询结果集的表。

当使用应用了索引的标准视图不可行或不可取时，物化视图主要用于提高应用程序性能。`ON COMMIT REFRESH`物化视图可以通过触发器或使用选项定期更新。这确实需要一些额外的权限，但这并不复杂。`ON COMMIT REFRESH`至少从 Oracle 10 开始就已经存在。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-05-13T09:44:56.213

**物化视图**- 磁盘上包含查询结果集的表

**非实体化视图**- 从基础表中提取数据的查询

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2008-09-18T15:31:54.087

视图本质上是由给定查询动态填充的类似逻辑表的结构。视图查询的结果不会存储在磁盘上的任何位置，并且每次执行查询时都会重新创建视图。物化视图是存储在数据库中并写入磁盘的实际结构。它们根据创建时定义的参数进行更新。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2017-03-27T18:02:21.120

**视图：**视图只是一个命名查询。它不存储任何东西。当视图上有查询时，它会运行视图定义的查询。实际数据来自表格。

**物化视图：**物理存储数据并定期更新。在查询 MV 时，它会从 MV 中提供数据。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-04T04:05:17.497

添加到迈克麦卡利斯特的相当彻底的答案......

只有当编译器认为视图查询很**简单**时，才能将物化视图设置为通过数据库检测更改来*自动刷新。*如果它被认为太复杂，它将无法设置本质上是内部触发器来跟踪源表中的更改以仅更新 mview 表中更改的行。

 **当您创建物化视图时，您会发现 Oracle 同时创建了 mview**和同名的表**，这会使事情变得混乱。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-11-15T13:58:51.750

物化视图是由选择查询驱动的数据的逻辑视图，但查询的结果将存储在表或磁盘中，查询的定义也将存储在数据库中。

物化视图的性能优于普通视图，因为物化视图的数据将存储在表中，并且表可能会被索引，因此连接速度更快，并且连接是在物化视图刷新时完成的，因此无需每次触发join 语句与视图的情况一样。

其他区别包括在视图的情况下，我们总是获取最新数据，但在物化视图的情况下，我们需要刷新视图以获取最新数据。在物化视图的情况下，我们需要一个额外的触发器或一些自动方法，以便我们可以保持 MV 刷新，这对于数据库中的视图不是必需的。

# .net - 自定义 Winforms 控件中的基线对齐线

> ID：93541
> 
> 赞同：35
> 
> 时间：2008-09-18T15:23:35.837
> 
> 标签：.net, winforms, user-controls, design-time, windows-forms-designer

我有一个带有文本框的自定义用户控件，我想在自定义控件之外公开基线（文本框中的文本）对齐线。我知道您创建了一个设计器（从 ControlDesigner 继承）并覆盖 SnapLines 以访问对齐线，但我想知道如何获取自定义用户控件公开的控件的文本基线。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-06-03T15:42:58.607

作为 Miral 答案的更新.. 对于正在寻找如何做到这一点的新人，这里有一些“缺失的步骤”。:) 上面的 C# 代码几乎可以直接使用，除了更改一些值以引用将被修改的 UserControl。

可能需要的参考资料：
System.Design (@robyaw)

所需用途：

```
using System.Windows.Forms.Design;
using System.Windows.Forms.Design.Behavior;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections; 
```

在您的 UserControl 上，您需要以下属性：

```
[Designer(typeof(MyCustomDesigner))] 
```

然后你需要一个“设计器”类，它将覆盖 SnapLines：

```
private class MyCustomerDesigner : ControlDesigner {
  public override IList SnapLines {
    get {
     /* Code from above */
    IList snapLines = base.SnapLines;

    // *** This will need to be modified to match your user control
    MyControl control = Control as MyControl;
    if (control == null) { return snapLines; }

    // *** This will need to be modified to match the item in your user control
    // This is the control in your UC that you want SnapLines for the entire UC
    IDesigner designer = TypeDescriptor.CreateDesigner(
        control.textBoxValue, typeof(IDesigner));
    if (designer == null) { return snapLines; }

    // *** This will need to be modified to match the item in your user control
    designer.Initialize(control.textBoxValue);

    using (designer)
    {
        ControlDesigner boxDesigner = designer as ControlDesigner;
        if (boxDesigner == null) { return snapLines; }

        foreach (SnapLine line in boxDesigner.SnapLines)
        {
            if (line.SnapLineType == SnapLineType.Baseline)
            {
                // *** This will need to be modified to match the item in your user control
                snapLines.Add(new SnapLine(SnapLineType.Baseline,
                    line.Offset + control.textBoxValue.Top,
                    line.Filter, line.Priority));
                break;
            }
        }
    }

    return snapLines;
}

    }
  }
} 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-12-31T06:36:42.867

我只是有类似的需求，我这样解决了：

```
 public override IList SnapLines
{
    get
    {
        IList snapLines = base.SnapLines;

        MyControl control = Control as MyControl;
        if (control == null) { return snapLines; }

        IDesigner designer = TypeDescriptor.CreateDesigner(
            control.textBoxValue, typeof(IDesigner));
        if (designer == null) { return snapLines; }
        designer.Initialize(control.textBoxValue);

        using (designer)
        {
            ControlDesigner boxDesigner = designer as ControlDesigner;
            if (boxDesigner == null) { return snapLines; }

            foreach (SnapLine line in boxDesigner.SnapLines)
            {
                if (line.SnapLineType == SnapLineType.Baseline)
                {
                    snapLines.Add(new SnapLine(SnapLineType.Baseline,
                        line.Offset + control.textBoxValue.Top,
                        line.Filter, line.Priority));
                    break;
                }
            }
        }

        return snapLines;
    }
} 
```

这样，它实际上为子控件创建了一个临时子设计器，以便找出“真正的”基线对齐线在哪里。

这在测试中似乎表现相当不错，但如果 perf 成为一个问题（并且如果内部文本框没有移动），那么大部分代码都可以提取到 Initialize 方法。

这也假定文本框是 UserControl 的直接子级。如果有其他影响布局的控件，那么偏移量计算会变得有点复杂。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-08-10T16:44:21.177

感谢所有人的帮助。这是一个难以下咽的东西。在每个 UserControl 中都有一个私有子类的想法并不是很受欢迎。

我想出了这个基类来帮忙..

```
[Designer(typeof(UserControlSnapLineDesigner))]
public class UserControlBase : UserControl
{
    protected virtual Control SnapLineControl { get { return null; } }

    private class UserControlSnapLineDesigner : ControlDesigner
    {
        public override IList SnapLines
        {
            get
            {
                IList snapLines = base.SnapLines;

                Control targetControl = (this.Control as UserControlBase).SnapLineControl;

                if (targetControl == null)
                    return snapLines;

                using (ControlDesigner controlDesigner = TypeDescriptor.CreateDesigner(targetControl,
                    typeof(IDesigner)) as ControlDesigner)
                {
                    if (controlDesigner == null)
                        return snapLines;

                    controlDesigner.Initialize(targetControl);

                    foreach (SnapLine line in controlDesigner.SnapLines)
                    {
                        if (line.SnapLineType == SnapLineType.Baseline)
                        {
                            snapLines.Add(new SnapLine(SnapLineType.Baseline, line.Offset + targetControl.Top,
                                line.Filter, line.Priority));
                            break;
                        }
                    }
                }
                return snapLines;
            }
        }
    }
} 
```

接下来，从这个基础派生您的 UserControl：

```
public partial class MyControl : UserControlBase
{
    protected override Control SnapLineControl
    {
        get
        {
            return txtTextBox;
        }
    }

    ...

} 
```

再次感谢您发布此内容。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-11-16T19:10:29.527

VB.Net 版本：
注意：您必须将 更改为`txtDescription`您使用的文本框或其他内部控件名称。并`ctlUserControl`以你的`usercontrol`名义

```
<Designer(GetType(ctlUserControl.MyCustomDesigner))> _
Partial Public Class ctlUserControl
   '... 
   'Your Usercontrol class specific code
   '... 
    Class MyCustomDesigner
        Inherits ControlDesigner
        Public Overloads Overrides ReadOnly Property SnapLines() As IList
            Get
                ' Code from above 

                Dim lines As IList = MyBase.SnapLines

                ' *** This will need to be modified to match your user control
                Dim control__1 As ctlUserControl = TryCast(Me.Control, ctlUserControl)
                If control__1 Is Nothing Then Return lines

                ' *** This will need to be modified to match the item in your user control
                ' This is the control in your UC that you want SnapLines for the entire UC
                Dim designer As IDesigner = TypeDescriptor.CreateDesigner(control__1.txtDescription, GetType(IDesigner))
                If designer Is Nothing Then
                    Return lines
                End If

                ' *** This will need to be modified to match the item in your user control
                designer.Initialize(control__1.txtDescription)

                Using designer
                    Dim boxDesigner As ControlDesigner = TryCast(designer, ControlDesigner)
                    If boxDesigner Is Nothing Then
                        Return lines
                    End If

                    For Each line As SnapLine In boxDesigner.SnapLines
                        If line.SnapLineType = SnapLineType.Baseline Then
                            ' *** This will need to be modified to match the item in your user control
                            lines.Add(New SnapLine(SnapLineType.Baseline, line.Offset + control__1.txtDescription.Top, line.Filter, line.Priority))
                            Exit For
                        End If
                    Next
                End Using

                Return lines
            End Get
        End Property
    End Class

End Class 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T18:00:05.167

你在正确的轨道上。您需要在设计器中覆盖 SnapLines 属性并执行以下操作：

```
Public Overrides ReadOnly Property SnapLines() As System.Collections.IList
    Get
        Dim snapLinesList As ArrayList = TryCast(MyBase.SnapLines, ArrayList)

        Dim offset As Integer
        Dim ctrl As MyControl = TryCast(Me.Control, MyControl)
        If ctrl IsNot Nothing AndAlso ctrl.TextBox1 IsNot Nothing Then
            offset = ctrl.TextBox1.Bottom - 5
        End If

        snapLinesList.Add(New SnapLine(SnapLineType.Baseline, offset, SnapLinePriority.Medium))

        Return snapLinesList

    End Get
End Property 
```

在此示例中，用户控件包含一个文本框。该代码添加了一个新的对齐线，表示文本框的基线。重要的是正确计算偏移量。

# c++ - 如何在 Windows 的 C++ 中检测拨号、宽带或无线 Internet 连接？

> ID：93545
> 
> 赞同：1
> 
> 时间：2008-09-18T15:24:13.807
> 
> 标签：c++, mfc, windows-xp, broadband

我有一个安装程序（只是一个常规的 C++ MFC 程序，不是基于 Windows Installer），它需要根据 Internet 连接的类型设置一些注册表值：宽带、拨号和/或无线。目前，这些信息是通过询问一系列是或否问题来确定的。问题是进行安装的人与拥有和使用计算机的人不同，因此他们并不总是确定这些问题的答案应该是什么。有没有办法以编程方式确定这些信息？该代码是用 C++（和可选的 MFC）编写的，适用于 Windows XP 及更高版本。基于 .NET 的解决方案不是一个选项，因为我不想在我们的安装程序可以运行之前确定是否安装了框架。

澄清一下，问题主要是无线和拨号连接不是“永远在线”，这导致我们的产品需要以不同的方式运行，因为我们的服务器并不总是可用。因此，严格的速度测量解决方案无济于事，尽管有一个与速度相关的设置，因此产品在连接后不会尝试通过拨号连接发送 MB 的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T15:37:53.777

[我不知道如何准确获取您要求的信息，但是...] 也许您可以（为自己）改写您尝试完成的内容？比如，不要问“用户有宽带还是拨号上网”，而是问“用户的互联网连接有多少带宽”——然后你可以尝试在没有任何用户输入的情况下回答改写后的问题（比如通过测量带宽）。

顺便提一句。如果您只询问用户“宽带或拨号”，您可能会遇到一些问题：

*   如果用户有一些你没有预料到的连接类型怎么办？
*   如果用户不知道怎么办（因为只有一根以太网电缆连接到 PPPoE DSL 调制解调器/路由器）？
*   如果用户通过一系列连接（通过拨号连接 VPN，连接到其他有宽带的网络）怎么办？

在这些情况下，询问“能力”而不是“类型”可能更有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-18T20:47:12.673

使用 InternetGetConnectedState API 检索 Internet 连接状态。

我测试了它，它工作正常。

我发现这个文件可以提供帮助：

[http://www.pcausa.com/resources/InetActive.txt](http://www.pcausa.com/resources/InetActive.txt)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T17:10:25.567

关于“互联网连接是否永久？”的问题：

*   最好的方法可能是使应用程序足够强大，以*始终*应对非永久连接:-) 这与拨号和宽带相同......
*   或者，也许您可​​以找出用户的互联网连接已经建立了多长时间，并与系统正常运行时间进行比较？如果连接几乎在计算机运行期间一直在线，则它可能是永久连接。

无论如何，这些启发式方法对于模糊的连接类型可能会失败。

另外，关于不发送大量数据的问题：如果人们有“宽带+低流量限制”的资费，即使带宽允许，也不应该发送大量数据:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T15:27:06.967

最好的办法是获取默认的活动网络连接，确保它是互联网连接（ping google.com 或类似的），然后询问它是什么类型的设备。您应该能够从中确定用户具有什么连接。

我相当有信心这是可能的，但不知道如何去做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T15:45:41.963

我认为你应该做一个快速的连接速度测试。只需下载一些特定大小的文件，时间需要多长时间，您就会知道速度。我同意其他人的观点，不要问他们有什么类型的连接，更重要的是速度。也许明年他们会推出 100mbit 拨号……您是否希望每个人都使用这款令人惊叹的新设备来获得您应用的低带宽版本？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T17:34:04.590

正如您所暗示的那样，我同意 Oliver：您已经具备应对连接丢失的功能，为什么不默认启用它。

宽带连接可能会搞砸：冻结的路由器软件（对我来说经常发生），或油炸的电源适配器，...

# browser - 如何在 HTTP 中对 Content-Disposition 标头的文件名参数进行编码？

> ID：93551
> 
> 赞同：589
> 
> 时间：2008-09-18T15:25:07.003
> 
> 标签：browser, http-headers, specifications

想要强制*下载*资源而不是直接在 Web 浏览器中*呈现*`Content-Disposition`的 Web 应用程序会在表单的 HTTP 响应中发出一个标头：

`Content-Disposition: attachment; filename=*FILENAME*`

该`filename`参数可用于建议浏览器将资源下载到的文件的名称。[然而， RFC 2183](https://www.rfc-editor.org/rfc/rfc2183)（Content-Disposition）在[第 2.3 节](https://www.rfc-editor.org/rfc/rfc2183#section-2.3)（文件名参数）中声明文件名只能使用 US-ASCII 字符：

> 当前 [RFC 2045] 语法将参数值（以及因此的 Content-Disposition 文件名）限制为 US-ASCII。我们认识到允许在文件名中使用任意字符集是非常可取的，但是定义必要的机制超出了本文档的范围。

然而，有经验证据表明，当今大多数流行的 Web 浏览器似乎允许非 US-ASCII 字符（由于缺乏标准）在文件名的编码方案和字符集规范上存在分歧。那么问题来了，如果需要将文件名“naïvefile”（不带引号，第三个字母是 U+00EF）编码到 Content-Disposition 标头中，流行的浏览器采用的各种方案和编码是什么？

对于这个问题，*流行的浏览器*是：

*   谷歌浏览器
*   苹果浏览器
*   Internet Explorer 或边缘
*   火狐
*   歌剧

* * *

## 回答 #1

> 赞同：406
> 
> 时间：2011-07-19T10:34:35.950

我知道这是一个旧帖子，但它仍然非常相关。我发现现代浏览器支持 rfc5987，它允许 utf-8 编码、百分比编码（url 编码）。然后 Naïve file.txt 变为：

```
Content-Disposition: attachment; filename*=UTF-8''Na%C3%AFve%20file.txt 
```

Safari (5) 不支持此功能。相反，您应该使用 Safari 标准将文件名直接写入 utf-8 编码的标头中：

```
Content-Disposition: attachment; filename=Naïve file.txt 
```

IE8 及更早版本也不支持，需要使用 IE 标准的 utf-8 编码，百分比编码：

```
Content-Disposition: attachment; filename=Na%C3%AFve%20file.txt 
```

在 ASP.Net 中，我使用以下代码：

```
string contentDisposition;
if (Request.Browser.Browser == "IE" && (Request.Browser.Version == "7.0" || Request.Browser.Version == "8.0"))
    contentDisposition = "attachment; filename=" + Uri.EscapeDataString(fileName);
else if (Request.Browser.Browser == "Safari")
    contentDisposition = "attachment; filename=" + fileName;
else
    contentDisposition = "attachment; filename*=UTF-8''" + Uri.EscapeDataString(fileName);
Response.AddHeader("Content-Disposition", contentDisposition); 
```

我使用 IE7、IE8、IE9、Chrome 13、Opera 11、FF5、Safari 5 测试了上述内容。

**2013 年 11 月更新**：

这是我目前使用的代码。我仍然要支持IE8，所以我无法摆脱第一部分。事实证明，Android 上的浏览​​器使用内置的 Android 下载管理器，它无法以标准方式可靠地解析文件名。

```
string contentDisposition;
if (Request.Browser.Browser == "IE" && (Request.Browser.Version == "7.0" || Request.Browser.Version == "8.0"))
    contentDisposition = "attachment; filename=" + Uri.EscapeDataString(fileName);
else if (Request.UserAgent != null && Request.UserAgent.ToLowerInvariant().Contains("android")) // android built-in download manager (all browsers on android)
    contentDisposition = "attachment; filename=\"" + MakeAndroidSafeFileName(fileName) + "\"";
else
    contentDisposition = "attachment; filename=\"" + fileName + "\"; filename*=UTF-8''" + Uri.EscapeDataString(fileName);
Response.AddHeader("Content-Disposition", contentDisposition); 
```

以上内容现已在 IE7-11、Chrome 32、Opera 12、FF25、Safari 6 中测试，使用此文件名进行下载：你好abcABCæøåÆØÅäöüïëêîâéíáóúýñ½§!#¤%&()=`@£$€{[]}+´¨ ^~'-_,;.txt

在 IE7 上，它适用于某些字符，但不是全部。但是现在谁在乎IE7？

这是我用来为 Android 生成安全文件名的函数。请注意，我不知道 Android 支持哪些字符，但我已经测试过这些字符确实有效：

```
private static readonly Dictionary<char, char> AndroidAllowedChars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ._-+,@£$€!½§~'=()[]{}0123456789".ToDictionary(c => c);
private string MakeAndroidSafeFileName(string fileName)
{
    char[] newFileName = fileName.ToCharArray();
    for (int i = 0; i < newFileName.Length; i++)
    {
        if (!AndroidAllowedChars.ContainsKey(newFileName[i]))
            newFileName[i] = '_';
    }
    return new string(newFileName);
} 
```

@TomZ：我在 IE7 和 IE8 中进行了测试，结果证明我不需要转义撇号 (')。你有一个失败的例子吗？

@Dave Van den Eynde：根据 RFC6266 将两个文件名组合在一行上，Android 和 IE7+8 除外，我已经更新了代码以反映这一点。感谢您的建议。

@Thilo：不知道 GoodReader 或任何其他非浏览器。使用 Android 方法可能会有一些运气。

@Alex Zhukovskiy：我不知道为什么，但正如[Connect](https://connect.microsoft.com/IE/feedback/details/820435/ie-11-does-not-support-decoding-the-filename-parameter-of-content-disposition-http-header-when-using-mime-encoded-word-syntax-generated-by-an-asp-net-handler "连接")上所讨论的，它似乎不太好用。

* * *

## 回答 #2

> 赞同：178
> 
> 时间：2008-10-19T18:26:36.530

*   没有可互操作的方式在`Content-Disposition`. [浏览器兼容性一团糟](http://greenbytes.de/tech/tc2231/)。

*   在理论上正确使用 UTF-8 的[语法](http://greenbytes.de/tech/webdav/rfc5987.html)`Content-Disposition`非常奇怪：（`filename*=UTF-8''foo%c3%a4`是的，这是一个星号，除了中间的空单引号外没有引号）

*   这个标头有点不太标准（[HTTP/1.1 规范承认它的存在](http://www.w3.org/Protocols/rfc2616/rfc2616-sec19.html#sec19.5.1)，但不要求客户端支持它）。

有一个简单且非常强大的替代方案：**使用包含所需文件名的 URL**。

当最后一个斜杠后面的名称是您想要的名称时，您不需要任何额外的标题！

这个技巧有效：

```
/real_script.php/fake_filename.doc 
```

如果您的服务器支持 URL 重写（例如`mod_rewrite`在 Apache 中），那么您可以完全隐藏脚本部分。

URL 中的字符应为 UTF-8，按字节进行 urlencoded：

```
/mot%C3%B6rhead   # motörhead 
```

* * *

## 回答 #3

> 赞同：102
> 
> 时间：2008-09-18T15:39:58.607

在提议的[RFC 5987](https://www.rfc-editor.org/rfc/rfc5987) “超文本传输​​协议 (HTTP) 标头字段参数的字符集和语言编码”中对此进行了讨论，包括浏览器测试和向后兼容性的链接。

[RFC 2183](https://www.rfc-editor.org/rfc/rfc2183)表明此类标头应根据[RFC 2184](https://www.rfc-editor.org/rfc/rfc2184)进行编码，该标准已被[RFC 2231](https://www.rfc-editor.org/rfc/rfc2231)废弃，由上述 RFC 草案涵盖。

* * *

## 回答 #4

> 赞同：78
> 
> 时间：2014-01-05T12:48:27.443

[RFC 6266](https://www.rfc-editor.org/rfc/rfc6266)描述了“<em>在超文本传输​​协议 (HTTP) 中使用 Content-Disposition 标头字段”。从中引用：

> [6\. 国际化注意事项](https://www.rfc-editor.org/rfc/rfc6266#section-6)
> 
> “<code>filename*”参数（[第 4.3 节](https://www.rfc-editor.org/rfc/rfc6266#section-4.3)）使用 [ [RFC5987](https://www.rfc-editor.org/rfc/rfc5987) ] 中定义的编码，允许服务器传输 ISO-8859-1 字符集之外的字符，并且还可以选择指定使用的语言。

在他们的[示例部分](https://www.rfc-editor.org/rfc/rfc6266#section-5)：

> 此示例与上面的示例相同，但添加了“文件名”参数以与未实现 [RFC 5987](https://www.rfc-editor.org/rfc/rfc5987)的用户代理兼容：
> 
> ```
> Content-Disposition: attachment;
>                      filename="EURO rates";
>                      filename*=utf-8''%e2%82%ac%20rates 
> ```
> 
> 注意：那些不支持[RFC 5987](https://www.rfc-editor.org/rfc/rfc5987)编码的用户代理会忽略出现在“<code>filename”之后的“<code>filename*”。

在[附录 D](https://www.rfc-editor.org/rfc/rfc6266#appendix-D)中还有一长串提高互操作性的建议。它还指向[一个比较实现的站点](http://greenbytes.de/tech/tc2231/)。当前适用于常见文件名的全通测试包括：

*   [attwithisofnplain](http://greenbytes.de/tech/tc2231/#attwithisofnplain)：带双引号且不带编码的纯 ISO-8859-1 文件名。这需要一个全部为 ISO-8859-1 且不包含百分号的文件名，至少不包含在十六进制数字前面。
*   [attfnboth](http://greenbytes.de/tech/tc2231/#attfnboth)：按上述顺序的两个参数。应该适用于大多数浏览器上的大多数文件名，尽管 IE8 将使用“<code>filename”参数。

该[RFC 5987](https://www.rfc-editor.org/rfc/rfc5987)又引用[RFC 2231](https://www.rfc-editor.org/rfc/rfc2231)，它描述了实际格式。2231 主要用于邮件，5987 告诉我们哪些部分也可用于 HTTP 标头。不要将此与`multipart/form-data`HTTP*正文*中使用的 MIME 标头混淆，后者受[RFC 2388](https://www.rfc-editor.org/rfc/rfc2388)（特别是[第 4.4 节](https://www.rfc-editor.org/rfc/rfc2388#section-4.4)）和[HTML 5 草案](http://www.w3.org/TR/html51/forms.html#multipart-form-data)的约束。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-09-18T16:08:16.900

[Jim](https://stackoverflow.com/users/8427/jim)在他的回答中提到的[RFC 草案](http://greenbytes.de/tech/webdav/draft-reschke-rfc2231-in-http-latest.html)链接的以下文档进一步解决了这个问题，在这里绝对值得直接注意：

[HTTP Content-Disposition 标头和 RFC 2231/2047 编码的测试用例](http://greenbytes.de/tech/tc2231/)

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2015-07-10T15:01:51.320

将文件名放在双引号中。为我解决了这个问题。像这样：

```
Content-Disposition: attachment; filename="My Report.doc" 
```

[http://kb.mozillazine.org/Filenames_with_spaces_are_truncated_upon_download](http://kb.mozillazine.org/Filenames_with_spaces_are_truncated_upon_download)

我已经测试了多个选项。浏览器不支持规范并且行为不同，我相信双引号是最好的选择。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2013-04-19T11:29:24.367

我使用以下代码片段进行编码（假设*fileName*包含文件的文件名和扩展名，即：test.txt）：

* * *

PHP：

```
if ( strpos ( $_SERVER [ 'HTTP_USER_AGENT' ], "MSIE" ) > 0 )
{
     header ( 'Content-Disposition: attachment; filename="' . rawurlencode ( $fileName ) . '"' );
}
else
{
     header( 'Content-Disposition: attachment; filename*=UTF-8\'\'' . rawurlencode ( $fileName ) );
} 
```

爪哇：

```
fileName = request.getHeader ( "user-agent" ).contains ( "MSIE" ) ? URLEncoder.encode ( fileName, "utf-8") : MimeUtility.encodeWord ( fileName );
response.setHeader ( "Content-disposition", "attachment; filename=\"" + fileName + "\""); 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2010-07-15T15:08:29.073

在 asp.net mvc2 我使用这样的东西：

```
return File(
    tempFile
    , "application/octet-stream"
    , HttpUtility.UrlPathEncode(fileName)
    ); 
```

我想如果你不使用 mvc(2) 你可以只使用编码文件名

```
HttpUtility.UrlPathEncode(fileName) 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2015-06-25T08:10:39.727

在 ASP.NET Web API 中，我对文件名进行 url 编码：

```
public static class HttpRequestMessageExtensions
{
    public static HttpResponseMessage CreateFileResponse(this HttpRequestMessage request, byte[] data, string filename, string mediaType)
    {
        HttpResponseMessage response = new HttpResponseMessage(HttpStatusCode.OK);
        var stream = new MemoryStream(data);
        stream.Position = 0;

        response.Content = new StreamContent(stream);

        response.Content.Headers.ContentType = 
            new MediaTypeHeaderValue(mediaType);

        // URL-Encode filename
        // Fixes behavior in IE, that filenames with non US-ASCII characters
        // stay correct (not "_utf-8_.......=_=").
        var encodedFilename = HttpUtility.UrlEncode(filename, Encoding.UTF8);

        response.Content.Headers.ContentDisposition =
            new ContentDispositionHeaderValue("attachment") { FileName = encodedFilename };
        return response;
    }
} 
```

![IE 9 未修复](https://i.stack.imgur.com/Fsla4.jpg)
![IE 9 已修复](https://i.stack.imgur.com/50Ako.jpg)

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2016-05-20T12:47:05.260

在 PHP 中，这是为我做的（假设文件名是 UTF8 编码的）：

```
header('Content-Disposition: attachment;'
    . 'filename="' . addslashes(utf8_decode($filename)) . '";'
    . 'filename*=utf-8\'\'' . rawurlencode($filename)); 
```

针对 IE8-11、Firefox 和 Chrome 进行了测试。
如果浏览器可以解释*filename*=utf-8*它将使用 UTF8 版本的文件名，否则它将使用解码的文件名。如果您的文件名包含 ISO-8859-1 中无法表示的字符，您可能需要考虑`iconv`改用。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2015-09-25T12:45:11.930

如果您使用的是 nodejs 后端，则可以使用我在[此处找到的以下代码](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent%23Examples)

```
var fileName = 'my file(2).txt';
var header = "Content-Disposition: attachment; filename*=UTF-8''" 
             + encodeRFC5987ValueChars(fileName);

function encodeRFC5987ValueChars (str) {
    return encodeURIComponent(str).
        // Note that although RFC3986 reserves "!", RFC5987 does not,
        // so we do not need to escape it
        replace(/['()]/g, escape). // i.e., %27 %28 %29
        replace(/\*/g, '%2A').
            // The following are not required for percent-encoding per RFC5987, 
            // so we can allow for a little better readability over the wire: |`^
            replace(/%(?:7C|60|5E)/g, unescape);
} 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2012-05-31T15:48:11.457

我在所有主流浏览器中测试了以下代码，包括旧版 Explorer（通过兼容模式），它在任何地方都运行良好：

```
$filename = $_GET['file']; //this string from $_GET is already decoded
if (strstr($_SERVER['HTTP_USER_AGENT'],"MSIE"))
  $filename = rawurlencode($filename);
header('Content-Disposition: attachment; filename="'.$filename.'"'); 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2015-04-05T15:45:29.043

我最终在我的“download.php”脚本中得到了以下代码（基于[这篇博](http://www.bennadel.com/blog/2591-embedding-foreign-characters-in-your-content-disposition-filename-header.htm)文和[这些测试用例](http://greenbytes.de/tech/tc2231/)）。

```
$il1_filename = utf8_decode($filename);
$to_underscore = "\"\\#*;:|<>/?";
$safe_filename = strtr($il1_filename, $to_underscore, str_repeat("_", strlen($to_underscore)));

header("Content-Disposition: attachment; filename=\"$safe_filename\""
.( $safe_filename === $filename ? "" : "; filename*=UTF-8''".rawurlencode($filename) )); 
```

只要仅使用 iso-latin1 和“安全”字符，这将使用标准的 filename="..." 方式；如果没有，它会添加 filename*=UTF-8'' url-encoded 方式。根据[这个特定的测试用例](http://greenbytes.de/tech/tc2231/#attwithfn2231utf8)，它应该从 MSIE9 开始工作，并在最近的 FF、Chrome、Safari 上工作；在较低的 MSIE 版本上，它应该提供包含 ISO8859-1 版本的文件名的文件名，并在不采用这种编码的字符上带有下划线。

最后说明：最大。在 apache 上，每个标头字段的大小为 8190 字节。UTF-8 每个字符最多可以有四个字节；在 rawurlencode 之后，每个字符 x3 = 12 个字节。效率很低，但理论上应该仍然可以在文件名中包含超过 600 个“微笑”%F0%9F%98%81。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2019-03-13T19:18:16.610

只是一个更新，因为我今天尝试所有这些东西以响应客户问题

*   除了为日语配置的 Safari 之外，我们客户测试的所有浏览器在使用 filename=text.pdf 时效果最佳 - 其中 text 是由 ASP.Net/IIS 在 utf-8 中序列化的客户值，没有 url 编码。出于某种原因，配置为英文的 Safari 会接受并正确保存具有 utf-8 日文名称的文件，但配置为日文的同一浏览器会使用未解释的 utf-8 字符保存文件。测试的所有其他浏览器似乎在文件名 utf-8 编码但没有 url 编码的情况下工作得最好/很好（无论语言配置如何）。
*   我根本找不到一个实现 Rfc5987/8187*的*浏览器。我使用最新的 Chrome、Firefox 构建以及 IE 11 和 Edge 进行了测试。我尝试仅使用 filename*=utf-8''texturlencoded.pdf 设置标题，同时使用 filename=text.pdf 设置它；文件名*=utf-8''texturlencoded.pdf。Rfc5987/8187 的任何一项功能似乎都没有在上述任何一项中得到正确处理。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2019-07-22T13:58:45.870

PHP 框架 Symfony 4`$filenameFallback`在`HeaderUtils::makeDisposition`. 您可以查看此功能以获取详细信息 - 它类似于上面的答案。

使用示例：

```
$filenameFallback = preg_replace('#^.*\.#', md5($filename) . '.', $filename);
$disposition = $response->headers->makeDisposition(ResponseHeaderBag::DISPOSITION_ATTACHMENT, $filename, $filenameFallback);
$response->headers->set('Content-Disposition', $disposition); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-05-23T12:17:58.410

### 经典的 ASP 解决方案

大多数现代浏览器现在都支持传递，但`Filename`就像`UTF-8`我使用的基于[FreeASPUpload.Net的文件上传解决方案一样](http://web.archive.org/web/20140614223449/http://www.freeaspupload.net/) *（站点不再存在，链接指向[archive.org](http://archive.org/web/)）*，它不能作为解析binary 依赖于读取单字节 ASCII 编码的字符串，当您传递 UTF-8 编码的数据直到您获得 ASCII 不支持的字符时，它工作得很好。

但是，我能够找到一种解决方案来获取将二进制文件读取和解析为 UTF-8 的代码。

```
Public Function BytesToString(bytes)    'UTF-8..
  Dim bslen
  Dim i, k , N 
  Dim b , count 
  Dim str

  bslen = LenB(bytes)
  str=""

  i = 0
  Do While i < bslen
    b = AscB(MidB(bytes,i+1,1))

    If (b And &HFC) = &HFC Then
      count = 6
      N = b And &H1
    ElseIf (b And &HF8) = &HF8 Then
      count = 5
      N = b And &H3
    ElseIf (b And &HF0) = &HF0 Then
      count = 4
      N = b And &H7
    ElseIf (b And &HE0) = &HE0 Then
      count = 3
      N = b And &HF
    ElseIf (b And &HC0) = &HC0 Then
      count = 2
      N = b And &H1F
    Else
      count = 1
      str = str & Chr(b)
    End If

    If i + count - 1 > bslen Then
      str = str&"?"
      Exit Do
    End If

    If count>1 then
      For k = 1 To count - 1
        b = AscB(MidB(bytes,i+k+1,1))
        N = N * &H40 + (b And &H3F)
      Next
      str = str & ChrW(N)
    End If
    i = i + count
  Loop

  BytesToString = str
End Function 
```

通过在我自己的代码中实现该功能，我能够使文件名正常工作，这归功于[Pure ASP File Upload](http://aspuploader.com/default.html)。`BytesToString()``include_aspuploader.asp``UTF-8`

* * *

### 有用的链接

*   [ASP Classic 应用程序中的 Multipart/form-data 和 UTF-8](https://stackoverflow.com/a/1715014/692942)

*   [Unicode、UTF、ASCII、ANSI 格式差异](https://stackoverflow.com/a/700221/692942)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-07-30T07:34:31.133

从 .NET 4.5（和 Core 1.0）开始，您可以使用[ContentDispositionHeaderValue](https://docs.microsoft.com/en-us/dotnet/api/system.net.http.headers.contentdispositionheadervalue)为您进行格式化。

```
var fileName = "Naïve file.txt";
var h = new System.Net.Http.Headers.ContentDispositionHeaderValue("attachment");
h.FileNameStar = fileName;
h.FileName = "fallback-ascii-name.txt";

Response.Headers.Add("Content-Disposition", h.ToString()); 
```

`h.ToString()`将导致：

```
attachment; filename*=utf-8''Na%C3%AFve%20file.txt; filename=fallback-ascii-name.txt 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-08-17T22:30:43.460

对于那些需要 JavaScript 编码标头的方法的人，我发现这个函数运行良好：

```
function createContentDispositionHeader(filename:string) {
    const encoded = encodeURIComponent(filename);
    return `attachment; filename*=UTF-8''${encoded}; filename="${encoded}"`;
} 
```

这是基于 Nextcloud 在下载文件时似乎正在做的事情。文件名首先以 UTF-8 编码出现，并且可能为了与某些浏览器兼容，文件名也出现时不带 UTF-8 前缀。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-12-21T10:49:51.597

库类 Unicode 中的 mimeHeaderEncode($string) 方法可以完成这项工作。

drupal/php 中的示例：

```
https://github.com/drupal/core-utility/blob/8.8.x/Unicode.php

/**
   * Encodes MIME/HTTP headers that contain incorrectly encoded characters.
   *
   * For example, Unicode::mimeHeaderEncode('tést.txt') returns
   * "=?UTF-8?B?dMOpc3QudHh0?=".
   *
   * See http://www.rfc-editor.org/rfc/rfc2047.txt for more information.
   *
   * Notes:
   * - Only encode strings that contain non-ASCII characters.
   * - We progressively cut-off a chunk with self::truncateBytes(). This ensures
   *   each chunk starts and ends on a character boundary.
   * - Using \n as the chunk separator may cause problems on some systems and
   *   may have to be changed to \r\n or \r.
   *
   * @param string $string
   *   The header to encode.
   * @param bool $shorten
   *   If TRUE, only return the first chunk of a multi-chunk encoded string.
   *
   * @return string
   *   The mime-encoded header.
   */
  public static function mimeHeaderEncode($string, $shorten = FALSE) {
    if (preg_match('/[^\x20-\x7E]/', $string)) {
      // floor((75 - strlen("=?UTF-8?B??=")) * 0.75);
      $chunk_size = 47;
      $len = strlen($string);
      $output = '';
      while ($len > 0) {
        $chunk = static::truncateBytes($string, $chunk_size);
        $output .= ' =?UTF-8?B?' . base64_encode($chunk) . "?=\n";
        if ($shorten) {
          break;
        }
        $c = strlen($chunk);
        $string = substr($string, $c);
        $len -= $c;
      }
      return trim($output);
    }
    return $string;
  } 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2015-01-27T11:54:13.313

我们在 Web 应用程序中遇到了类似的问题，最终通过从 HTML 读取文件名`<input type="file">`，并将其设置为新 HTML 中的 url 编码形式`<input type="hidden">`。当然，我们必须删除某些浏览器返回的路径，例如“C:\fakepath\”。

当然，这并不能直接回答 OP 的问题，但可能是其他人的解决方案。

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2008-09-18T15:28:29.493

我通常对文件名进行 URL 编码（使用 %xx），它似乎适用于所有浏览器。无论如何，您可能都想做一些测试。

# c++ - POD 类型是否始终对齐？

> ID：93569
> 
> 赞同：3
> 
> 时间：2008-09-18T15:27:16.000
> 
> 标签：c++, c, visual-c++

例如，如果我声明一个长变量，我可以假设它总是在“sizeof(long)”边界上对齐吗？Microsoft Visual C++ 在线帮助这么说，但这是标准行为吗？

更多信息：

一种。可以显式地创建一个未对齐的整数 (*bar)：

> 字符富[5]
> 
> int * bar = (int *)(&foo[1]);

湾。显然，#pragma pack() 只影响结构、类和联合。

C。MSVC 文档指出 POD 类型与其各自的大小对齐（但它始终还是默认情况下，它是标准行为，我不知道）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-18T15:50:56.647

正如其他人所提到的，这不是标准的一部分，而是留给编译器来实现，因为它认为适合所讨论的处理器。例如，VC 可以轻松地为 ARM 处理器实现与 x86 处理器不同的对齐要求。

Microsoft VC 实现了基本所谓的自然对齐，直到由#pragma pack 指令或/Zp 命令行选项指定的大小。这意味着，例如，任何大小小于或等于 8 字节的 POD 类型都将根据其大小进行对齐。任何更大的都将在 8 字节边界上对齐。

如果控制不同处理器和不同编译器的对齐很重要，则可以使用 1 的打包大小并填充结构。

```
#pragma pack(push)
#pragma pack(1)    
struct Example
{
   short data1;     // offset 0
   short padding1;  // offset 2
   long data2;      // offset 4
};
#pragma pack(pop) 
```

在此代码中，`padding1`变量的存在只是为了确保 data2 自然对齐。

回答一个：

是的，这很容易导致数据错位。在 x86 处理器上，这根本不会造成太大的伤害。在其他处理器上，这可能会导致崩溃或执行速度非常慢。例如，Alpha 处理器会抛出一个处理器异常，该异常会被操作系统捕获。然后，操作系统将检查指令，然后执行处理未对齐数据所需的工作。然后继续执行。该`__unaligned`关键字可以在 VC 中用于标记非 x86 程序（即 CE）的未对齐访问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T15:31:11.390

默认情况下，是的。但是，可以通过 pack() #pragma 更改它。

我不相信 C++ 标准在这方面有任何要求，并将其留给实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T16:26:47.293

C 和 C++ 不要求任何类型的对齐。但是 x86 强烈倾向于自然对齐，并且大多数其他 CPU 体系结构都*需要*自然对齐，编译器通常会尽最大努力让 CPU 满意。所以在实践中你不会看到编译器生成未对齐的数据，除非你真的扭曲它的手臂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T15:28:38.167

是的，所有类型总是至少与它们的对齐要求对齐。

不然怎么可能？

但请注意 sizeof() 类型与它的对齐方式不同。

您可以使用以下宏来确定类型的对齐要求：

```
#define ALIGNMENT_OF( t ) offsetof( struct { char x; t test; }, test ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T15:34:17.123

取决于编译器、编译指示和优化级别。使用现代编译器，您还可以选择时间或空间优化，这也可以改变类型的对齐方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T15:37:43.027

一般来说，这是因为读取/写入它会更快。但几乎每个编译器都有一个开关来关闭它。在 gcc 中它的 -malign-???。对于聚合，它们通常根据内部每个元素的对齐要求进行对齐和调整大小。

# java - symbian 应用程序作为后台进程

> ID：93570
> 
> 赞同：4
> 
> 时间：2008-09-18T15:27:16.313
> 
> 标签：java, symbian

是否可以创建在 symbian 智能手机上用作后台进程的 java 应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T16:23:58.330

您可以对其进行近似，但 J2ME（手机上的 java 版本）可能不是执行此操作的正确技术。

*   在手机开机时启动一个 MIDlet（一种用于手机的 Java 应用程序）充其量是很棘手的，除非编写一个小型 Symbian OS C++ 模块来为您启动它。如果您仍然想尝试，请查看 MIDP 规范 ( [http://java.sun.com/javame/reference/apis/jsr118/](http://java.sun.com/javame/reference/apis/jsr118/) ) 中的 PushRegistry 类。内容处理 API 也可能提供一些方法来做到这一点 ( [http://java.sun.com/javame/reference/apis/jsr211](http://java.sun.com/javame/reference/apis/jsr211) )。当你准备放弃时，用 C++ 来做。

*   后台 MIDlet 并不难。手机的“菜单”键将为您完成。以编程方式， Canvas.setCurrent(null) 有很好的工作机会。试图通过提供完全透明的 GUI 并且不处理任何键盘活动来欺骗电话绝对行不通。在 MIDlet 中创建和启动一个单独的线程应该允许您在应用程序管理系统调用 MIDlet.pauseApp() 的重载之后保持运行。

*   真正的问题是 MIDlet 不会有任何进程间通信系统，除非你自己做一个。这样做的常用方法是通过其传输数据的环回套接字连接。不是模拟 IPC 的好方法或有效方法。我认为只能在同一个 MIDlet 套件中共享 RMS 记录（您可以将多个 MIDlet 打包到同一个 .jar 文件中）。通过文件连接创建提供者/消费者数据流的代码更加难看，并且会引发安全问题。

如果没有更多关于你想用它做什么的信息，我的回答是：也许但你可能不应该尝试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T13:14:39.513

[您将在 MIDP 3.0 ( http://jcp.org/en/jsr/detail?id=271](http://jcp.org/en/jsr/detail?id=271) )中获得对后台 MIDlet 的内置 MIDP 支持。但是，不要屏住呼吸等待设备出现 - 可能需要一段时间。（请注意，一些 Symbian OS 设备不仅具有 MIDP - 例如 SE p990，[https://developer.sonyericsson.com/site/global/products/phonegallery/p990/p_p990.jsp](https://developer.sonyericsson.com/site/global/products/phonegallery/p990/p_p990.jsp)）。

正如已经指出的那样，获得有关您尝试实现的产品功能的更多信息可能会有所帮助——通常不止一种给猫剥皮的方法。

# symbian - 从 SymbianOS 上的文件系统插件访问资源文件

> ID：93578
> 
> 赞同：1
> 
> 时间：2008-09-18T15:28:04.610
> 
> 标签：symbian

由于 PlatSec 问题，我无法在文件系统插件中使用资源文件 API：

```
*PlatSec* ERROR - Capability check failed - Can't load filesystemplugin.PXT because it links to bafl.dll which has the following capabilities missing: TCB 
```

我对这个问题的理解是：

文件系统插件是在文件系统进程的上下文中执行的 dll。因此，所有文件系统插件都必须具有`TCB`PlatSec 权限，这反过来意味着它们不能链接到不在`TCB`.

有没有办法解决这个问题（不求助于文本文件或中间服务器）？我怀疑不是——但最好得到一个明确的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T16:29:24.027

Symbian 文件服务器具有以下功能：

```
TCB ProtServ DiskAdmin AllFiles PowerMgmt CommDD 
```

因此，任何加载到文件服务器进程中的 DLL 都必须至少具有这些功能。没有办法解决这个问题，除非像你提到的那样编写一个新的代理进程。

`bafl.dll`然而，你不应该在文件服务器插件中使用还有一个更根本的原因：这个 DLL 提供了与文件服务器客户端 API 接口的实用程序函数。试图从文件管理器服务器中使用它是行不通的；充其量，它会导致文件服务器在尝试连接到自身时死锁。

我建议重新考虑您正在尝试做的事情，并研究内部文件服务器 API 来实现它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T16:34:40.410

在文件服务器插件中使用 RFs/RFile/RDir API 是不安全的，如果您不小心，可能会导致死锁。

Symbian 9.5 将引入应该使用的新 API（RFilePlugin、RFsPlugin 和 RDirPlugin）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T09:05:09.187

有一个与插件通信的适当机制，RPlugin。

不要使用 RFile。我什至不确定它是否会起作用，因为在插件堆栈之前调用的 RFile 函数的初始化中检查了路径。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-18T17:08:47.737

告诉我们您在资源文件中存储的数据类型。

通常进入资源文件的东西在文件服务器插件中没有位置，即使这意味着硬编码一些值。

从技术上讲，您可以使用 RFile.Write() 将数据发送到文件服务器插件，但这不是一个很好的解决方案（在插件中拦截 RFile.Open("invalid file name that only your plugin understands")）。编辑：有人表示使用无效的文件名不会让您将数据发送到插件。嘿，我也不喜欢那个解决方案。为了完整起见，我应该澄清一下。组成一个看起来足够好的文件名以通过您的插件。就像使用没有附加真实驱动器的驱动器号（但文件名解析代码仍将被认为是正确的）。

编写代码来解析插件中的资源文件二进制文件，虽然理论上可行，但也不是一个很好的解决方案。

# c# - 想要写入文件，但可能同时有多个写入者，需要锁定

> ID：93583
> 
> 赞同：6
> 
> 时间：2008-09-18T15:28:21.350
> 
> 标签：c#, .net, asp.net, locking

在 asp.net Web 应用程序中，我想写入文件。该函数将首先从数据库中获取数据，然后写出平面文件。

我能做些什么来确保只发生 1 次写入，并且一旦发生写入，可能想要写入文件的其他线程在写入发生后就不会发生。

我只想在 15 分钟内没有写完的情况下才写完。

我知道有一个 lock 关键字，所以我应该把所有东西都包在一个 lock 中，然后检查它是否在 15 分钟或更长时间内更新，反之亦然？

**更新**

工作流程：

由于这是一个 Web 应用程序，因此多个实例将是查看特定网页的人。我可以使用内置缓存系统，但是如果 asp.net 回收，重建缓存会很昂贵，所以我只想将它写到一个平面文件中。我的另一个选择是创建一个 Windows 服务，但这是我想要的更多管理工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T15:30:33.963

同步您的编写代码以锁定共享对象，以便只有一个线程进入块内。其他人等到当前的退出。

```
lock(this)
{
  // perform the write.
} 
```

更新：我假设你有一个共享对象。如果这些是同一台机器上的不同进程，则您需要像命名互斥锁这样的东西。[看这里的例子](http://msdn.microsoft.com/en-us/library/aa332344(VS.71).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T15:35:20.613

锁定一个对象变量而不是整个实例不是更好吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T15:58:23.540

写入文件的文件 I/O 操作将自动锁定文件。检查文件是否被锁定（通过尝试写入）以及是否不写入。在进行任何写入之前，请检查文件上的时间戳，看看它是否超过 15 分钟。

afaik 如果没有被 Windows/任何东西锁定，你就无法写入文件。

现在剩下的就是查找如何使用 msdn 执行上述操作（抱歉，我懒得全部查找，而且我不太记得 C# 类）。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-04T16:03:30.723

**使用文件系统锁**

像其他人建议的那样，.NET 锁在这种情况下的用途有限。这是代码：

```
FileInfo fi = new FileInfo(path);
if (fi.Exists
    && (DateTime.UtcNow - fi.LastWriteTimeUtc < TimeSpan.FromMinutes(15)) {
  // file is fresh
  return;
}

FileStream fs;
try {
  fs = new FileStream(
    path, FileMode.Create, FileAccess.Write, FileShare.Read);
} catch (IOException) {
  // file is locked
  return;
}

using (fs) {
  // write to file
} 
```

这将跨线程*和*进程工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T15:35:26.497

我不相信.NET 的锁定适用于不同的进程。此外，lock(this) 只会排除在“this”的同一实例上运行该方法的其他线程——因此即使在同一进程中的其他线程也可以在不同的实例上同时运行。

假设您的所有进程都在同一台机器上运行，文件锁定应该这样做。

如果你在不同的机器上，你的里程可能会有所不同——win32声称有文件锁定，可以在网络上工作，但从历史上看，依赖它的应用程序（想想MSAccess）无论如何都会有文件损坏的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T15:38:32.633

```
 // try enter will return false if another thread owns the lock
   if (Monitor.TryEnter(lockObj))
   {
      try
      {
         // check last write time here, return if too soon; otherwise, write
      }
      finally
      {
         Monitor.Exit(lockobj);
      }
   } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-25T10:19:25.030

你们应该考虑使用[Mutex](http://msdn.microsoft.com/en-us/library/system.threading.mutex.aspx)。它可以在多个线程和进程之间进行同步。

# .net - FileStream 在 .NET 中是否延迟加载？

> ID：93590
> 
> 赞同：2
> 
> 时间：2008-09-18T15:29:37.977
> 
> 标签：.net, performance

我有一个关于在 .NET 中使用流从磁盘加载文件的问题。我试图查明一个性能问题，并想确定它是我认为的位置。

```
Dim provider1 As New MD5CryptoServiceProvider
Dim stream1 As FileStream

stream1 = New FileStream(FileName, FileMode.Open, FileAccess.Read, FileShare.Read)
provider1.ComputeHash(stream1) 
```

问：当我创建 FileStream 对象或消费流的对象（在本例中为 MD5 哈希算法）时，是否从磁盘读取字节？

`ComputeHash`与我的本地测试环境相比，我在使用该方法时在我的网络主机上发现了严重的性能问题。我只是想确保性能问题出在散列而不是磁盘访问中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T15:40:19.823

FileStream 只是在文件对象周围公开一个 IO.Stream，并使用缓冲区。它不会在构造函数中读取整个文件（文件可能大于 RAM）。

性能问题最有可能出现在哈希中，您可以执行一些简单的基准测试来证明是因为文件 IO 还是算法本身。

但是您可能会尝试的第一件事是：

```
provider1.ComputeHash(stream1.ToArray()); 
```

这应该使 FileStream 读取整个文件并返回一个字节数组。.ToArray() 可以调用比 ComputeHash 调用的 .Read() 方法更快的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T15:35:53.530

是的，文件的内容将在您运行 ComputeHash 方法时读取，而不是在您打开 FileStream 时读取。

测试性能问题的最佳方法是从文件读取数据到内存流对其进行哈希处理并测量每个步骤的性能。您可以为此使用 System.Diagnostics.Stopwatch 类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T15:37:22.433

当调用者通过调用 Read 或类似方法请求它们时，应从磁盘读取字节。无论如何，硬盘和操作系统都会执行一些预读来改进顺序读取操作，但这肯定很难预测。

您还可以尝试使用某些构造函数重载为 FileStream 提供的缓冲区大小参数。

# autocomplete - 如何使用 IntelliJ 自动完成方法参数？

> ID：93591
> 
> 赞同：54
> 
> 时间：2008-09-18T15:29:38.007
> 
> 标签：autocomplete, intellij-idea

Eclipse 中我真正怀念的一个特性是如何使用当前范围内的变量自动完成方法参数。此功能将使用单个组合键 ( `ctrl`+ `space`) 填充所有方法参数。只要我的变量命名与方法参数类似，我就不会遇到这种自动完成的问题。在 Intellij 中是否有插件或本地方式来完成此任务？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2011-12-13T14:23:46.793

您可能已经知道 IntelliJ IDEA 具有`CTRL`+`P`快捷方式 (Windows) 和`CMD`+ `P`(OX X)，它们会简要说明将哪些参数传递给方法。它非常方便，节省了大量时间，否则这些时间会花费在查找方法声明上。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-09-19T15:10:04.683

[IntelliJ IDEA 9 现在支持](http://blogs.jetbrains.com/idea/2009/09/super-method-completion/)他们所谓的“超级完成”，它与您正在寻找的行为相匹配，并且可以通过他们的早期访问计划获得。

[![替代文字](https://i.stack.imgur.com/V0vwl.png)](https://i.stack.imgur.com/V0vwl.png)
[（来源：[jetbrains.com](https://blogs.jetbrains.com/idea/wp-content/uploads/2009/09/super.png)）]

IntelliJ IDEA 8 不允许您一次自动完成多个参数。您被迫对每个参数使用`Control`- `Shift`-`Space`一次。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-18T15:32:47.360

Control-Shift-Space（完成是基于类型，而不是名称）

更多好处：帮助->默认键盘映射参考

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-04-16T15:32:25.813

还有一个名为“kotlin-fill-class”的 IntelliJ 插件，它将自动填充一些默认值。使用 IntelliJ 2019.1 测试了该插件的最新快照版本，它似乎可以正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-29T07:11:39.233

从这篇文章：[https](https://stackoverflow.com/a/55160515/405749) ://stackoverflow.com/a/55160515/405749 ：

插件[https://plugins.jetbrains.com/plugin/8638-auto-filling-java-call-arguments](https://plugins.jetbrains.com/plugin/8638-auto-filling-java-call-arguments)至少会在按下 alt+enter 时提供智能修复。

我还没有找到完全自动执行此操作的方法，因为它在 Eclipse 中工作。

# java - 你会生成代码吗？如果是这样，您使用什么以及生成什么？

> ID：93595
> 
> 赞同：14
> 
> 时间：2008-09-18T15:30:15.370
> 
> 标签：java, .net, database, code-generation

我使用过 MyGeneration，我喜欢它生成代码，该代码使用 Microsoft 的数据访问应用程序块作为我的数据访问层，并使我的数据库概念与我正在建模的域保持同步。尽管如此，一个周末的学习曲线比预期的要陡峭，以使其富有成效。

我想知道其他人在做什么与代码生成有关。

[http://www.mygenerationsoftware.com](http://www.mygenerationsoftware.com)

[http://www.codesmithtools.com/](http://www.codesmithtools.com/)

其他的？

早在 2000 年左右，我工作的公司使用 Veritas Software 的产品（我相信它是）来对组件进行建模并生成集成组件 (dll) 的代码。我没有太多经验，但似乎代码生成长期以来一直是“圣杯”。实用吗？其他人如何使用它？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T15:35:59.630

T4 是微软的 CodeSmith 杀手！！！！

去看看吧。微软不想破坏他们的合作伙伴，所以他们不会做广告，但这是一件不可忽视的事情，它是免费的，并且安装在 Visual Studio 2008 中。

[www.olegsych.com](http://www.olegsych.com)

[codeplex.com/t4toolbox](http://www.codeplex.com/t4toolbox)

[www.t4editor.net](http://www.t4editor.net)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T15:32:42.103

我已成功使用 LLBLGen 和 nHibernate 生成实体和 DAL 层。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T15:36:58.520

我们使用 Codesmith 并取得了巨大的成功。我现在一直在努力寻找我们可以在哪里实施模板来加速平凡的流程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T16:03:46.130

我经常使用的两个框架。

# 拉格尔

值得一试的是[Ragel](http://research.cs.queensu.ca/~thurston/ragel/)。它用于为状态机生成代码。

您只需在源代码中添加一些简单的标记，然后在 Ragel 上运行生成器，即可为 C、C++、Objective-C、D、Java 和 Ruby 生成代码，并且很容易将其与常规源代码混合。

Ragel 甚至允许您在状态转换等方面执行代码。它使创建文件格式和协议解析器变得容易。

用户 Ragel 的一些值得注意的项目是[Mongrel](http://mongrel.rubyforge.org/)，一个很棒的 ruby​​ Web 服务器。还有[Hpricot](http://code.whytheluckystiff.net/hpricot/)，一个基于 ruby​​ 的 html 解析器，有点受[jQuery](http://jquery.com/)的启发。

Ragel 的另一个重要功能是它如何生成基于[graphviz](http://graphviz.org/)的图表，以可视化您的状态机。下面是取自[Zed Shaw](http://www.zedshaw.com/) 关于 ragel 状态图的[文章的示例。](http://www.zedshaw.com/tips/ragel_state_charts.html)

[![拉格尔状态图](https://i.stack.imgur.com/qo8AT.png)](https://i.stack.imgur.com/qo8AT.png)
[（来源：[zedshaw.com](http://www.zedshaw.com/tips/HelloMachine_small.png)）]

# XMLBeans

[XMLBeans](http://xmlbeans.apache.org/)是一个基于 java 的 xml 绑定。它有一个很棒的工作流程，我经常使用它。

XMLBeans 将描述模型的 xml 模式处理成一组表示该模型的 java 类。您可以以编程方式创建模型，然后将它们与 xml 序列化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T15:31:32.090

我已经使用 CSLA 完成了工作，并使用 codesmith 使用 CSLA 模板生成我的代码。

codesmithtools.com

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T15:32:50.747

如果您的数据库是您的模型，[SubSonic](http://subsonicproject.com)有一个出色的代码生成器，从 v2.1 开始，不再需要 ActiveRecord（您可以使用存储库模式）。它不如其他灵活，但可以在库存模板中进行自定义。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T15:34:29.743

我使用过 CodeSmith 和 MyGeneration，两者都不太热衷，感觉使用起来有些简洁，学习模板语言等。

SubSonic 是我们有时在这里用来生成数据访问层的东西。用于大小合适的项目，它是一个非常棒的节省时间的工具。[咔嚓](http://subsonicproject.com/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T15:55:47.447

我也看到代码生成是有害的，但前提是你使用了 codesmith 和 mygeneration 等 3rd 方工具。我有 2 个存储过程来生成我的域对象和域接口

例子

生成域接口'表名'

然后我只需将其复制并粘贴到 Visual Studio 中。对于我讨厌做的那些任务来说非常棒。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T15:42:57.070

I worked for four years as the main developer in a web agency, as I wrote from ground-up my first two or three websites, I soon realized that it was going to be a very boring task to do it all the times. So I started writing my own web site generator engine.

My starting point was this site [http://www.codegeneration.net/](http://www.codegeneration.net/). I took one of their examples for a simple crud generation and extended to the level that i was generating entire sites with it.

I used xml for the definition of various parts of the website (pages, datalists, joins, tables, form management). The generated web sites were completely detached from the generator, so the generated website could also be modified by hand.

Here is their article [http://www.codegeneration.net/tiki-read_article.php?articleId=19](http://www.codegeneration.net/tiki-read_article.php?articleId=19).

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-28T20:54:34.753

亚音太棒了！！查询能力很容易掌握，存储过程的实现真的很棒。我可以继续下去。它让您立即高效工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-28T21:02:39.507

我主要在 C# 中编写代码，当我需要代码生成时，我在 XLST 中进行，当源代码可以简单地转换为 XML 或 ruby​​ 脚本时，它更复杂。

如果代码生成部分需要多个开发人员频繁修改，CodeSmith 工作得很好（并且比 XSLT 或新开发人员的 ruby​​ 更容易学习）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T16:19:47.620

我已经使用 Castor 完成了几次一次性的代码生成，以创建基于 XSD 的 Java 源代码。最新的用途是为 Open Travel Association 实现创建 Java 类。OTA Schema 非常复杂，手工操作会很麻烦。考虑到架构的复杂性，Castor 做得很好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-11-18T22:21:32.013

Outsystems 的[敏捷平台](http://www.outsystems.com/agile-platform)可用于生成开源的、有据可查的 C# 和 Java 应用程序。因为它还具有与部署、管理和更改相关的多项功能，所以大多数人最终不仅使用它来生成代码，还使用它来管理 Web 应用程序的整个生命周期。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-11-18T22:26:52.340

一段时间以来，我一直在使用自制的脚本/模板语言进行代码生成。（我使用这种语言主要是为了找到我的小宠物项目的用途）

最近，我创建了一些 SQL*PLUS 脚本来创建数据库访问代码（我们没有 Hibernate...）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T15:31:11.297

我用过 CodeSmith。很有帮助。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-18T15:33:14.503

我喜欢使用 [SubSonic](http://www.codeplex.com/subsonic)。我认为开源是代码生成的方式，因为修改模板和核心非常容易，因为它们总是有错误或者你想做的一两件事不是内置的。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-18T15:33:27.453

我已经在向量数学库中使用代码生成来生成 swizzle 函数。我为此使用了一个自定义的 PERL 脚本。我看过的所有 FLOSS 生成器似乎都不适合创建 swizzle 函数

我通常使用 C++ 模板，而不是代码生成。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-18T15:34:34.203

我主要使用[LLBLGen Pro](http://llblgen.com)来生成代码。它提供了多种用于生成的模式，您可以提供自己的模式，就像 CodeSmith 一样。客户支持非常好。

本质上，我使用 LLBLGen 生成我的业务对象和 DAL 并保持它们是最新的。代码模板有一些部分，您可以在其中添加自己的逻辑，这些逻辑在重新生成期间不会被清除。绝对值得一看。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-18T15:35:53.467

我们使用 linq 和 XML 文字 (VB) 自定义构建代码生成。我们还没有找到将解决方案分解为模板的方法；然而，这两种技术使这项任务变得如此微不足道，我认为我们不会。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-18T15:36:12.343

我认为代码生成是有害的，因为它会在不添加新逻辑或洞察力的情况下使代码库膨胀。理想情况下，应该提高抽象级别，使用数据文件、模板或宏等，以避免生成大量样板代码。它可以帮助您快速完成工作，但从长远来看会损害可维护性。

如果您选择的编程语言通过从某种模板语言生成而变得不那么痛苦，这似乎表明您可以通过使用另一种可能更动态的语言进行更高级别的工作来节省更多时间。YMMV。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-18T15:39:24.863

LLBLGen Pro 是一款出色的工具，可让您编写与数据库无关的解决方案。掌握基本功能真的很快。高级功能并没有太大的挑战性。我强烈建议您检查一下。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-18T16:40:34.530

[蟒蛇](http://www.python.org/)。

我使用了 MyGeneration，它使用 C# 编写代码模板。但是，我开始使用 Python，我发现我可以用这种语言编写生成其他代码的代码，比用 C# 编写的代码**更快**。随后，我使用 Python 编写了生成 C#、TSQL 和 VB 的代码。

通常，生成其他代码的代码往往更难遵循其本质。Python 更简洁的语法通过使其比 C# 中的等价物更具可读性和可维护性而大有帮助。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-09-19T13:04:56.653

.net 的 codesmith

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-19T13:08:18.577

我编写了一个实用程序，您可以在其中指定一个表，它会生成一个 Oracle 触发器，记录对该表的所有更改。使日志记录变得非常简单。

还有一个我写的生成一个 Delphi 类，该类对你给它的任何数据库表进行建模，但我认为这样做是一种[代码味道](http://c2.com/cgi/wiki?CodeSmell)，所以我很少使用它。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-19T13:12:20.003

在公司，我们编写了自己的代码来生成我们的大部分实体/dalc/业务类和相关的存储过程，因为它只需要一点时间，而且我们有一些特殊要求。尽管我确信我们可以使用现有的生成器实现相同的目标，但这是一个有趣的小项目。

Codesmith 得到了很多人的推荐，而且它似乎确实是一个不错的选择。就我个人而言，我对代码生成器所需要的只是让修改模板变得容易。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-09-19T13:27:38.250

[MyGeneration](http://sourceforge.net/projects/mygeneration/)一路走来！

> MyGeneration 是一个非常灵活的基于模板的代码生成器，用 Microsoft.NET 编写。MyGeneration 擅长为 ORM 架构生成代码。您的数据库中的元数据可通过 MyMeta API 提供给模板。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-09-19T13:30:46.090

我使用 myEclipse 中的休眠工具从我的数据模型生成域模型和 DAO 代码。它似乎工作得很好（如果你在 DAO 中编写自定义方法会出现一些问题，这些似乎在覆盖时会丢失），但通常它似乎工作得很好——尤其是与 Spring 结合使用。

# html - 列表项中的浮动 div (ul, li)

> ID：93625
> 
> 赞同：1
> 
> 时间：2008-09-18T15:33:59.090
> 
> 标签：html, css, css-float

我有一个`<div>`每个都有两个 s的列表，`<li>`我想将它们一个并排浮动，我希望`<li>`占据整个可用空间。我该怎么做？

```
<html>
    <head>
        <title></title>
        <style type="text/css">
            body {
            }
            ul {
            }
            li {
            }
            .a {
            }
            .b {
            }
        </style>
    </head>
    <body>
        <ul>
            <li>
                <div class="a">
                    content
                </div>
                <div class="b">
                    content
                </div>
            </li>
        </ul>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T15:36:19.707

```
 *{ margin: 0; padding: 0;}
 li{  width: 100%: display: block; } 
 li:after{ clear: both; } 
 div.a{ width: 49%;  float: left; }
 div.b{ width: 49%;  float: left; } 
```

应该做的伎俩。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T15:38:14.103

对于 div，您只需要向左浮动，而 li，您要清楚。所以：

```
li
{
    clear: left;
}
.a
{
    float: left;
}
.b
{
    float: left;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-24T17:56:32.730

我看到这是一篇旧帖子，但如果有人遇到同样的问题，请考虑一下：

```
<div>A block-level section in a document</div>
<span>An inline section in a document</span> 
```

您可以使用**span**代替**div**

要获得除另一个或水平的**div**，您必须使用 . **css**但如果你使用**span**它自然会。将以下代码复制并粘贴到**html**中，看看我在说什么：

```
<ul>
  <li>
      <div style="background-color:red">red</div>
      <div style="background-color:blue">blue</div>
  </li>
  <li>
      <span style="background-color:red">red</span>
      <span style="background-color:blue">blue</span>
  </li>
</ul> 
```

此外，至少对于 Microsoft`<li><div></div></li>`不会进行验证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T15:36:05.387

无需检查以确保，这应该可以工作

```
 LI { width: 100%; }
.a { float: left; }
.b { float: right; } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T15:39:01.230

```
li { width: 100%;}
.a { float: left;}
.b { float: left;} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T16:15:26.557

我假设占据整个空间意味着 100% 的宽度。我还假设您不希望将样式应用于列表，这就是我在此示例中删除它的原因。这也是无黑客攻击的。你不需要清除任何东西，只要你的列表项有一个宽度和溢出：隐藏的属性/值对。

```
ul,
li {
    width: 100%;
    list-style-type: none;
    margin: 0;
    padding: 0;
}
li {
    overflow: hidden;
}
li div.a,
li div.b {
    float: left;
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-18T15:36:02.860

```
li{width:100%;}
.a{}
.b{float: left;} 
```

根据我对 CSS 的了解，这应该符合要求

# php - CakePHP 视图包括其他视图

> ID：93632
> 
> 赞同：15
> 
> 时间：2008-09-18T15:34:39.413
> 
> 标签：php, templates, cakephp

我有一个 CakePHP 应用程序，它会在某些时候显示一个带有产品媒体（图片或视频）的视图，我想知道是否有另一个视图会威胁视频或威胁图片，具体取决于标志。我想将这些“小视图”用于其他几个目的，所以它应该“像”一个蛋糕组件，以便重用。

你们建议在蛋糕约定中使用什么（而不是使用原始`include('')`命令）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T17:37:26.810

为了在此处获取信息以防有人偶然发现此问题，请务必注意，解决方案因 CakePHP 版本而异。

## 对于 CakePHP 1.1

`$this->renderElement('display', array('flag' => 'value'));`

在您看来，然后`/app/views/elements/`您可以创建一个名为 的文件`display.thtml`，其中`$flag`将包含您传递给它的任何值。

## 对于 CakePHP 1.2

`$this->element('display', array('flag' => 'value'));`

在您看来，然后`/app/views/elements/`您可以创建一个名为 的文件`display.ctp`，其中`$flag`将包含您传递给它的任何值。

* * *

在这两个版本中，元素都可以访问视图可以访问的所有数据+您传递给它的任何值。此外，正如有人指出的那样，`requestAction()`这也是一种选择，但如果在不使用缓存的情况下完成，可能会严重影响性能，因为它必须完成正常操作的所有步骤。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-28T11:57:50.363

在您的控制器中（在此示例中为帖子控制器）。

```
function something() {
    return $this->Post->find('all');
} 
```

在您的元素目录 (app/views/element) 中创建一个名为 posts.ctp 的文件。

在posts.ctp中：

```
$posts = $this->requestAction('posts/something'); 
foreach($posts as $post): 
    echo $post['Post']['title']; 
endforeach; 
```

那么在你看来：

```
<?php echo $this->element('posts'); ?> 
```

这主要取自这里的 CakePHP 书： [Creating Reusable Elements with requestAction](http://bakery.cakephp.org/articles/view/creating-reusable-elements-with-requestaction)

我确实相信使用 requestAction 非常昂贵，因此您需要研究缓存。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-07-23T09:13:30.930

只需使用：

```
<?php include('/<other_view>.ctp'); ?> 
```

在 .ctp 中，您的操作结束。

例如，构建一个归档函数

```
function archived() {
  // do some stuff
  // you can even hook the index() function
  $myscope = array("archived = 1");
  $this->index($myscope);
  // coming back, so the archived view will be launched
  $this->set("is_archived", true); // e.g. use this in your index.ctp for customization
} 
```

可能调整您的索引操作：

```
function index($scope = array()) {
  // ...
  $this->set(items, $this->paginate($scope));
} 
```

您的 archive.ctp 将是：

```
<?php include('/index.ctp'); ?> 
```

控制器操作和视图代码的理想重用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-19T15:56:16.667

**对于 CakePHP 2.x**

Cake 2.x 的新功能是扩展给定视图的能力。因此，虽然元素非常适合拥有少量可重用代码，但扩展视图允许您重用整个视图。

有关更多/更好的信息，请参阅手册

[http://book.cakephp.org/2.0/en/views.html#extending-views](http://book.cakephp.org/2.0/en/views.html#extending-views)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T17:42:10.513

如果您希望元素可以访问调用视图可以访问的相同数据，则元素可以工作。

如果您希望嵌入式视图能够访问其自己的数据集，您可能需要使用类似[`requestAction()`](http://book.cakephp.org/2.0/en/controllers.html#Controller::requestAction). 这允许您嵌入一个完整的视图，否则它将是独立的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T05:47:10.960

> 我想将这些“小视图”用于其他几个目的，所以它应该“像”一个蛋糕组件，以便重用。

这是通过“助手”完成的，如此[处所述](http://book.cakephp.org/2.0/en/views/helpers.html)。但我不确定这真的是你想要的。“[元素](http://book.cakephp.org/2.0/en/views.html#elements)”的建议似乎也是正确的。这在很大程度上取决于您要完成的工作。我的两分钱...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-09T12:28:05.270

在 CakePHP 3.x 中，您可以简单地使用：

```
$this->render('view') 
```

这将从与父视图相同的目录呈现视图。

# wpf - 如何确定窗口的 WPF SelectedItem

> ID：93638
> 
> 赞同：1
> 
> 时间：2008-09-18T15:35:23.047
> 
> 标签：wpf, selecteditem

我有一个 WPF 应用程序，在一个窗口中有许多基于列表的控件，它们都绑定到不同的 CollectionView。

在窗口级别有没有办法为当前基于焦点列表的控件获取当前选定的项目？我知道我可以通过寻找焦点元素来使用一些相当简单的代码来做到这一点，但是 WPF 是否支持将其作为一个开箱即用的概念？

像 Window.CurrentSelectedDataItem 这样的东西会很棒。我正在研究将其用作集中命令管理的一种方式，以根据当前选定的数据项启用禁用命令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T18:02:02.837

我认为没有像您指定的属性，但作为替代方案，您可以在 Window 类中为 ListBox.SelectionChanged 事件注册 ClassHandler：

```
EventManager.RegisterClassHandler(typeof(ListBox), ListBox.SelectionChanged,
    new SelectionChangedEventHandler(this.OnListBoxSelectionChanged)); 
```

每当您的应用程序中任何 ListBox 中的选择发生更改时，都会调用此方法。您可以使用 sender 参数来确定是哪个 ListBox 更改了其选择，并在需要时缓存此值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-30T16:13:51.120

我还没有尝试过，但是您可以尝试使用带有转换器的 MultiBinding 来获得正确的项目：

```
<MultiBinding Converter="{StaticResource coalesce}">
    <MultiBinding.Bindings>
        <MultiBinding Converter="{StaticResource nullIfFalse}">
            <MultiBinding.Bindings>
                 <Binding ElementName="List1" Path="HasFocus" />
                 <Binding ElementName="List1" Path="SelectedItem" /> 
```

`nullIfFalse`返回第二个参数，如果第一个为真，否则为空。`coalesce`返回第一个非空元素。

# html - 下载加速器如何工作？

> ID：93642
> 
> 赞同：18
> 
> 时间：2008-09-18T15:35:46.713
> 
> 标签：html, download, accelerator

我们要求所有下载请求都必须具有有效的登录名（非 http），并且我们会为每次下载生成交易票据。如果您要访问其中一个下载链接并尝试“重播”交易，我们会使用 HTTP 代码转发您以获取新的交易票。这适用于大多数用户。然而，有一小部分正在使用下载加速器，它们只是尝试多次重播交易票。

因此，为了确定我们是否想要甚至*可以*支持下载加速器，我们试图了解它们是如何工作的。

与提供静态文件的 Web 服务器建立第二个、第三个甚至第四个并发连接如何加快下载过程？

加速器程序有什么作用？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-18T15:43:51.407

您将在[wikipedia](http://en.wikipedia.org/wiki/Download_accelerator)上获得有关下载加速器的更全面的概述。

## 加速是多方面的

### 第一的

托管/加速下载的一个实质性好处是相关工具会记住传输的开始/停止偏移量，并使用“部分”和“范围”标头来请求文件的部分而不是全部。

这意味着如果某些东西在事务中死掉（即：TCP Time-out），它只会重新连接它停止的地方，而您不必从头开始。

因此，如果您有断断续续的连接，则总传输时间会大大减少。

### 第二

下载加速器喜欢使用相同的开始-范围-停止机制将单个传输分成几个大小相等的较小段，并并行执行它们，这大大缩短了慢速网络上的传输时间。

有一个烦人的东西叫做带宽延迟产品，其中两端的 TCP 缓冲区的大小与 ping 时间一起做一些数学运算，以获得实际体验的速度，这实际上意味着大的 ping 时间会限制你的速度，不管如何所有临时连接都有许多兆比特/秒。

但是，此限制似乎是“每个连接”，因此到单个服务器的多个 TCP 连接可以帮助减轻高延迟 ping 时间对性能的影响。

因此，住在附近的人不太可能需要进行分段转移，但住在远方的人更有可能从疯狂的分段中受益。

### 第三

在某些情况下，可能会找到提供相同资源的多个服务器，有时单个 DNS 地址循环到多个 IP 地址，或者服务器是某种镜像网络的一部分。下载管理器/加速器可以检测到这一点，并在多个服务器上应用分段传输技术，从而允许下载器获得更多的集体带宽。

## 支持

支持第一种加速是我个人建议的“最低”支持。主要是因为它使用户的生活变得轻松，并且由于用户不必重复获取相同的内容，它减少了您必须提供的聚合数据传输量。

为了促进这一点，它建议您计算他们已经转移了多少并且在他们看起来“完成”之前不要使票过期（同时将流量绑定到使用票的第一个 IP），或者给定的“合理”时间下载它已经过去了。即：在要求他们获得新票之前给他们一个宽限期。

支持第二和第三给你加分，而且用户普遍希望至少第二，主要是因为国际客户不喜欢仅仅因为更长的ping时间而被视为二等客户，并且客观上并没有消耗更多任何重要的带宽。最糟糕的情况是它们可能会导致您的总吞吐量不适合您的服务运行方式。

简单地通过限制单张票的并发传输数量来提供第一种好处而不允许第二种好处是相当直截了当的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T15:39:59.260

我相信这个想法是许多服务器限制或平均分配跨连接的带宽。通过拥有多个连接，您正在欺骗该系统并获得超过“公平”带宽份额。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T15:40:17.670

这都是关于[利特尔定律的](http://en.wikipedia.org/wiki/Little%27s_law)。具体来说，到 Web 服务器的每个流都会看到一定量的 TCP 延迟，因此只会携带这么多的数据。增加 TCP 窗口大小和实施选择性确认等技巧会有所帮助，但实施效果不佳，通常会导致比解决方案更多的问题。

拥有多个流意味着随着全局吞吐量整体增加，每个流看到的延迟不太重要。

即使使用单线程，下载加速器的另一个关键优势是它通常比使用内置下载工具的 Web 浏览器要好。例如，如果网络浏览器决定死掉，下载工具将继续运行。并且下载工具可能支持内置浏览器不支持的暂停/恢复等功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T16:26:12.193

我的理解是，下载加速器使用的一种方法是打开许多并行 TCP 连接——每个 TCP 连接只能走这么快，并且通常在服务器端受到限制。

TCP 是这样实现的，如果发生超时，超时时间会增加。这在防止网络过载方面非常有效，但代价是单个 TCP 连接的速度。

下载加速器可以通过打开数十个 TCP 连接并将速度慢的连接降低到某个阈值以下，然后打开新连接来替换慢速连接来解决这个问题。

虽然对单个用户有效，但我认为这通常是不好的礼仪。

您看到下载加速器尝试使用相同的交易票重新进行身份验证 - 我建议忽略这些请求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T15:39:59.213

来自：[http ://askville.amazon.com/download-accelerator-protocol-work-advantages-benefits-application-area-scope-plz-suggest-URLs/AnswerViewer.do?requestId=9337813](http://askville.amazon.com/download-accelerator-protocol-work-advantages-benefits-application-area-scope-plz-suggest-URLs/AnswerViewer.do?requestId=9337813)

Quote: 加速下载最常见的方式是打开并行下载。许多服务器限制了一个连接的带宽，因此并行打开更多连接会提高速率。这通过指定一个下载应该开始的偏移量来工作，该偏移量支持 HTTP 和 FTP。

当然，这种加速方式是相当“不合群”的。实施带宽的限制是为了能够为更多的客户端提供服务，因此使用这种技术会降低能够下载的对等点的最大数量。这就是为什么许多服务器限制并行连接数量（由 IP 识别）的原因，例如，许多 FTP 服务器会这样做，因此如果您下载文件并尝试使用浏览器继续浏览，就会遇到问题。从技术上讲，这是两个并行连接。

另一种提高下载速率的技术是点对点网络，其中使用不同来源（例如受上传端的异步 DSL 限制）进行下载。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T15:40:41.850

大多数下载“加速器”实际上根本没有加速任何东西。他们擅长做的是拥塞网络流量，重击您的服务器，并破坏您所看到的自定义脚本。基本上它的工作原理是，它不是发出一个请求并从头到尾下载文件，而是发出四个请求……第一个从 0-25% 下载，第二个从 25-50% 下载，依此类推，它使它们同时发生。唯一有帮助的特殊情况是，如果他们的 ISP 或防火墙进行某种流量整形，使得单个下载速度被限制为低于其总下载速度。

就个人而言，如果它给您带来任何麻烦，我会说只是通知不支持下载加速器，并让用户正常下载它们，或者只使用单线程。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T15:41:58.820

他们一般不会。

为了回答您的问题的实质，假设服务器对每个连接的下载进行速率限制，因此同时下载多个块将使用户能够充分利用其端的可用带宽。

# .net - 将笔画应用于 WPF 中的文本块

> ID：93650
> 
> 赞同：71
> 
> 时间：2008-09-18T15:36:21.300
> 
> 标签：.net, wpf, xaml

如何在 WPF 中的 xaml 中将描边（文本周围的轮廓）应用于文本块？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-03-27T09:50:07.820

下面是我更惯用的 WPF，全功能对此的看法。它几乎支持您所期望的一切，包括：

*   所有与字体相关的属性，包括拉伸和样式
*   文本对齐（左、右、居中、对齐）
*   文字环绕
*   文本修剪
*   文字装饰（下划线、删除线等）

这是一个简单的例子，说明它可以实现什么：

```
<local:OutlinedTextBlock FontFamily="Verdana" FontSize="20pt" FontWeight="ExtraBold" TextWrapping="Wrap" StrokeThickness="1" Stroke="{StaticResource TextStroke}" Fill="{StaticResource TextFill}">
    Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit
</local:OutlinedTextBlock> 
```

结果是：

![在此处输入图像描述](https://i.stack.imgur.com/gyDYX.png)

这是控件的代码：

```
using System;
using System.ComponentModel;
using System.Globalization;
using System.Windows;
using System.Windows.Documents;
using System.Windows.Markup;
using System.Windows.Media;

[ContentProperty("Text")]
public class OutlinedTextBlock : FrameworkElement
{
    public static readonly DependencyProperty FillProperty = DependencyProperty.Register(
        "Fill",
        typeof(Brush),
        typeof(OutlinedTextBlock),
        new FrameworkPropertyMetadata(Brushes.Black, FrameworkPropertyMetadataOptions.AffectsRender));

    public static readonly DependencyProperty StrokeProperty = DependencyProperty.Register(
        "Stroke",
        typeof(Brush),
        typeof(OutlinedTextBlock),
        new FrameworkPropertyMetadata(Brushes.Black, FrameworkPropertyMetadataOptions.AffectsRender));

    public static readonly DependencyProperty StrokeThicknessProperty = DependencyProperty.Register(
        "StrokeThickness",
        typeof(double),
        typeof(OutlinedTextBlock),
        new FrameworkPropertyMetadata(1d, FrameworkPropertyMetadataOptions.AffectsRender));

    public static readonly DependencyProperty FontFamilyProperty = TextElement.FontFamilyProperty.AddOwner(
        typeof(OutlinedTextBlock),
        new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty FontSizeProperty = TextElement.FontSizeProperty.AddOwner(
        typeof(OutlinedTextBlock),
        new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty FontStretchProperty = TextElement.FontStretchProperty.AddOwner(
        typeof(OutlinedTextBlock),
        new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty FontStyleProperty = TextElement.FontStyleProperty.AddOwner(
        typeof(OutlinedTextBlock),
        new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty FontWeightProperty = TextElement.FontWeightProperty.AddOwner(
        typeof(OutlinedTextBlock),
        new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty TextProperty = DependencyProperty.Register(
        "Text",
        typeof(string),
        typeof(OutlinedTextBlock),
        new FrameworkPropertyMetadata(OnFormattedTextInvalidated));

    public static readonly DependencyProperty TextAlignmentProperty = DependencyProperty.Register(
        "TextAlignment",
        typeof(TextAlignment),
        typeof(OutlinedTextBlock),
        new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty TextDecorationsProperty = DependencyProperty.Register(
        "TextDecorations",
        typeof(TextDecorationCollection),
        typeof(OutlinedTextBlock),
        new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty TextTrimmingProperty = DependencyProperty.Register(
        "TextTrimming",
        typeof(TextTrimming),
        typeof(OutlinedTextBlock),
        new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty TextWrappingProperty = DependencyProperty.Register(
        "TextWrapping",
        typeof(TextWrapping),
        typeof(OutlinedTextBlock),
        new FrameworkPropertyMetadata(TextWrapping.NoWrap, OnFormattedTextUpdated));

    private FormattedText formattedText;
    private Geometry textGeometry;

    public OutlinedTextBlock()
    {
        this.TextDecorations = new TextDecorationCollection();
    }

    public Brush Fill
    {
        get { return (Brush)GetValue(FillProperty); }
        set { SetValue(FillProperty, value); }
    }

    public FontFamily FontFamily
    {
        get { return (FontFamily)GetValue(FontFamilyProperty); }
        set { SetValue(FontFamilyProperty, value); }
    }

    [TypeConverter(typeof(FontSizeConverter))]
    public double FontSize
    {
        get { return (double)GetValue(FontSizeProperty); }
        set { SetValue(FontSizeProperty, value); }
    }

    public FontStretch FontStretch
    {
        get { return (FontStretch)GetValue(FontStretchProperty); }
        set { SetValue(FontStretchProperty, value); }
    }

    public FontStyle FontStyle
    {
        get { return (FontStyle)GetValue(FontStyleProperty); }
        set { SetValue(FontStyleProperty, value); }
    }

    public FontWeight FontWeight
    {
        get { return (FontWeight)GetValue(FontWeightProperty); }
        set { SetValue(FontWeightProperty, value); }
    }

    public Brush Stroke
    {
        get { return (Brush)GetValue(StrokeProperty); }
        set { SetValue(StrokeProperty, value); }
    }

    public double StrokeThickness
    {
        get { return (double)GetValue(StrokeThicknessProperty); }
        set { SetValue(StrokeThicknessProperty, value); }
    }

    public string Text
    {
        get { return (string)GetValue(TextProperty); }
        set { SetValue(TextProperty, value); }
    }

    public TextAlignment TextAlignment
    {
        get { return (TextAlignment)GetValue(TextAlignmentProperty); }
        set { SetValue(TextAlignmentProperty, value); }
    }

    public TextDecorationCollection TextDecorations
    {
        get { return (TextDecorationCollection)this.GetValue(TextDecorationsProperty); }
        set { this.SetValue(TextDecorationsProperty, value); }
    }

    public TextTrimming TextTrimming
    {
        get { return (TextTrimming)GetValue(TextTrimmingProperty); }
        set { SetValue(TextTrimmingProperty, value); }
    }

    public TextWrapping TextWrapping
    {
        get { return (TextWrapping)GetValue(TextWrappingProperty); }
        set { SetValue(TextWrappingProperty, value); }
    }

    protected override void OnRender(DrawingContext drawingContext)
    {
        this.EnsureGeometry();

        drawingContext.DrawGeometry(this.Fill, new Pen(this.Stroke, this.StrokeThickness), this.textGeometry);
    }

    protected override Size MeasureOverride(Size availableSize)
    {
        this.EnsureFormattedText();

        // constrain the formatted text according to the available size
        // the Math.Min call is important - without this constraint (which seems arbitrary, but is the maximum allowable text width), things blow up when availableSize is infinite in both directions
        // the Math.Max call is to ensure we don't hit zero, which will cause MaxTextHeight to throw
        this.formattedText.MaxTextWidth = Math.Min(3579139, availableSize.Width);
        this.formattedText.MaxTextHeight = Math.Max(0.0001d, availableSize.Height);

        // return the desired size
        return new Size(this.formattedText.Width, this.formattedText.Height);
    }

    protected override Size ArrangeOverride(Size finalSize)
    {
        this.EnsureFormattedText();

        // update the formatted text with the final size
        this.formattedText.MaxTextWidth = finalSize.Width;
        this.formattedText.MaxTextHeight = finalSize.Height;

        // need to re-generate the geometry now that the dimensions have changed
        this.textGeometry = null;

        return finalSize;
    }

    private static void OnFormattedTextInvalidated(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)
    {
        var outlinedTextBlock = (OutlinedTextBlock)dependencyObject;
        outlinedTextBlock.formattedText = null;
        outlinedTextBlock.textGeometry = null;

        outlinedTextBlock.InvalidateMeasure();
        outlinedTextBlock.InvalidateVisual();
    }

    private static void OnFormattedTextUpdated(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)
    {
        var outlinedTextBlock = (OutlinedTextBlock)dependencyObject;
        outlinedTextBlock.UpdateFormattedText();
        outlinedTextBlock.textGeometry = null;

        outlinedTextBlock.InvalidateMeasure();
        outlinedTextBlock.InvalidateVisual();
    }

    private void EnsureFormattedText()
    {
        if (this.formattedText != null || this.Text == null)
        {
            return;
        }

        this.formattedText = new FormattedText(
            this.Text,
            CultureInfo.CurrentUICulture,
            this.FlowDirection,
            new Typeface(this.FontFamily, this.FontStyle, this.FontWeight, FontStretches.Normal),
            this.FontSize,
            Brushes.Black);

        this.UpdateFormattedText();
    }

    private void UpdateFormattedText()
    {
        if (this.formattedText == null)
        {
            return;
        }

        this.formattedText.MaxLineCount = this.TextWrapping == TextWrapping.NoWrap ? 1 : int.MaxValue;
        this.formattedText.TextAlignment = this.TextAlignment;
        this.formattedText.Trimming = this.TextTrimming;

        this.formattedText.SetFontSize(this.FontSize);
        this.formattedText.SetFontStyle(this.FontStyle);
        this.formattedText.SetFontWeight(this.FontWeight);
        this.formattedText.SetFontFamily(this.FontFamily);
        this.formattedText.SetFontStretch(this.FontStretch);
        this.formattedText.SetTextDecorations(this.TextDecorations);
    }

    private void EnsureGeometry()
    {
        if (this.textGeometry != null)
        {
            return;
        }

        this.EnsureFormattedText();
        this.textGeometry = this.formattedText.BuildGeometry(new Point(0, 0));
    }
} 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2016-02-08T04:48:50.237

我用几个修复修改了投票最多的答案，包括：

*   修复使用 UseLayoutRounding 时显示单行文本的问题。

*   大纲将显示在文本之外，而不是在边框的中间。

*   笔只创建一次，而不是在每次渲染时创建。

*   修复了文本设置为空时不会崩溃的问题。

*   修复，以便轮廓使用适当的圆帽。

```
using System;
using System.ComponentModel;
using System.Globalization;
using System.Windows;
using System.Windows.Documents;
using System.Windows.Markup;
using System.Windows.Media;

[ContentProperty("Text")]
public class OutlinedTextBlock : FrameworkElement
{
    private void UpdatePen() {
        _Pen = new Pen(Stroke, StrokeThickness) {
            DashCap = PenLineCap.Round,
            EndLineCap = PenLineCap.Round,
            LineJoin = PenLineJoin.Round,
            StartLineCap = PenLineCap.Round
        };

        InvalidateVisual();
    }

    public static readonly DependencyProperty FillProperty = DependencyProperty.Register(
      "Fill",
      typeof(Brush),
      typeof(OutlinedTextBlock),
      new FrameworkPropertyMetadata(Brushes.Black, FrameworkPropertyMetadataOptions.AffectsRender));

    public static readonly DependencyProperty StrokeProperty = DependencyProperty.Register(
      "Stroke",
      typeof(Brush),
      typeof(OutlinedTextBlock),
      new FrameworkPropertyMetadata(Brushes.Black, FrameworkPropertyMetadataOptions.AffectsRender, StrokePropertyChangedCallback));

    private static void StrokePropertyChangedCallback(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs dependencyPropertyChangedEventArgs) {
        (dependencyObject as OutlinedTextBlock)?.UpdatePen();
    }

    public static readonly DependencyProperty StrokeThicknessProperty = DependencyProperty.Register(
      "StrokeThickness",
      typeof(double),
      typeof(OutlinedTextBlock),
      new FrameworkPropertyMetadata(1d, FrameworkPropertyMetadataOptions.AffectsRender, StrokePropertyChangedCallback));

    public static readonly DependencyProperty FontFamilyProperty = TextElement.FontFamilyProperty.AddOwner(
      typeof(OutlinedTextBlock),
      new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty FontSizeProperty = TextElement.FontSizeProperty.AddOwner(
      typeof(OutlinedTextBlock),
      new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty FontStretchProperty = TextElement.FontStretchProperty.AddOwner(
      typeof(OutlinedTextBlock),
      new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty FontStyleProperty = TextElement.FontStyleProperty.AddOwner(
      typeof(OutlinedTextBlock),
      new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty FontWeightProperty = TextElement.FontWeightProperty.AddOwner(
      typeof(OutlinedTextBlock),
      new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty TextProperty = DependencyProperty.Register(
      "Text",
      typeof(string),
      typeof(OutlinedTextBlock),
      new FrameworkPropertyMetadata(OnFormattedTextInvalidated));

    public static readonly DependencyProperty TextAlignmentProperty = DependencyProperty.Register(
      "TextAlignment",
      typeof(TextAlignment),
      typeof(OutlinedTextBlock),
      new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty TextDecorationsProperty = DependencyProperty.Register(
      "TextDecorations",
      typeof(TextDecorationCollection),
      typeof(OutlinedTextBlock),
      new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty TextTrimmingProperty = DependencyProperty.Register(
      "TextTrimming",
      typeof(TextTrimming),
      typeof(OutlinedTextBlock),
      new FrameworkPropertyMetadata(OnFormattedTextUpdated));

    public static readonly DependencyProperty TextWrappingProperty = DependencyProperty.Register(
      "TextWrapping",
      typeof(TextWrapping),
      typeof(OutlinedTextBlock),
      new FrameworkPropertyMetadata(TextWrapping.NoWrap, OnFormattedTextUpdated));

    private FormattedText _FormattedText;
    private Geometry _TextGeometry;
    private Pen _Pen;

    public Brush Fill
    {
        get { return (Brush)GetValue(FillProperty); }
        set { SetValue(FillProperty, value); }
    }

    public FontFamily FontFamily
    {
        get { return (FontFamily)GetValue(FontFamilyProperty); }
        set { SetValue(FontFamilyProperty, value); }
    }

    [TypeConverter(typeof(FontSizeConverter))]
    public double FontSize
    {
        get { return (double)GetValue(FontSizeProperty); }
        set { SetValue(FontSizeProperty, value); }
    }

    public FontStretch FontStretch
    {
        get { return (FontStretch)GetValue(FontStretchProperty); }
        set { SetValue(FontStretchProperty, value); }
    }

    public FontStyle FontStyle
    {
        get { return (FontStyle)GetValue(FontStyleProperty); }
        set { SetValue(FontStyleProperty, value); }
    }

    public FontWeight FontWeight
    {
        get { return (FontWeight)GetValue(FontWeightProperty); }
        set { SetValue(FontWeightProperty, value); }
    }

    public Brush Stroke
    {
        get { return (Brush)GetValue(StrokeProperty); }
        set { SetValue(StrokeProperty, value); }
    }

    public double StrokeThickness
    {
        get { return (double)GetValue(StrokeThicknessProperty); }
        set { SetValue(StrokeThicknessProperty, value); }
    }

    public string Text
    {
        get { return (string)GetValue(TextProperty); }
        set { SetValue(TextProperty, value); }
    }

    public TextAlignment TextAlignment
    {
        get { return (TextAlignment)GetValue(TextAlignmentProperty); }
        set { SetValue(TextAlignmentProperty, value); }
    }

    public TextDecorationCollection TextDecorations
    {
        get { return (TextDecorationCollection)GetValue(TextDecorationsProperty); }
        set { SetValue(TextDecorationsProperty, value); }
    }

    public TextTrimming TextTrimming
    {
        get { return (TextTrimming)GetValue(TextTrimmingProperty); }
        set { SetValue(TextTrimmingProperty, value); }
    }

    public TextWrapping TextWrapping
    {
        get { return (TextWrapping)GetValue(TextWrappingProperty); }
        set { SetValue(TextWrappingProperty, value); }
    }

    public OutlinedTextBlock() {
        UpdatePen();
        TextDecorations = new TextDecorationCollection();
    }

    protected override void OnRender(DrawingContext drawingContext) {
        EnsureGeometry();

        drawingContext.DrawGeometry(null, _Pen, _TextGeometry);
        drawingContext.DrawGeometry(Fill, null, _TextGeometry);
    }

    protected override Size MeasureOverride(Size availableSize) {
        EnsureFormattedText();

        // constrain the formatted text according to the available size

        double w = availableSize.Width;
        double h = availableSize.Height;

        // the Math.Min call is important - without this constraint (which seems arbitrary, but is the maximum allowable text width), things blow up when availableSize is infinite in both directions
        // the Math.Max call is to ensure we don't hit zero, which will cause MaxTextHeight to throw
        _FormattedText.MaxTextWidth = Math.Min(3579139, w);
        _FormattedText.MaxTextHeight = Math.Max(0.0001d, h);

        // return the desired size
        return new Size(Math.Ceiling(_FormattedText.Width), Math.Ceiling(_FormattedText.Height));
    }

    protected override Size ArrangeOverride(Size finalSize) {
        EnsureFormattedText();

        // update the formatted text with the final size
        _FormattedText.MaxTextWidth = finalSize.Width;
        _FormattedText.MaxTextHeight = Math.Max(0.0001d, finalSize.Height);

        // need to re-generate the geometry now that the dimensions have changed
        _TextGeometry = null;

        return finalSize;
    }

    private static void OnFormattedTextInvalidated(DependencyObject dependencyObject,
      DependencyPropertyChangedEventArgs e) {
        var outlinedTextBlock = (OutlinedTextBlock)dependencyObject;
        outlinedTextBlock._FormattedText = null;
        outlinedTextBlock._TextGeometry = null;

        outlinedTextBlock.InvalidateMeasure();
        outlinedTextBlock.InvalidateVisual();
    }

    private static void OnFormattedTextUpdated(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e) {
        var outlinedTextBlock = (OutlinedTextBlock)dependencyObject;
        outlinedTextBlock.UpdateFormattedText();
        outlinedTextBlock._TextGeometry = null;

        outlinedTextBlock.InvalidateMeasure();
        outlinedTextBlock.InvalidateVisual();
    }

    private void EnsureFormattedText() {
        if (_FormattedText != null) {
            return;
        }

        _FormattedText = new FormattedText(
          Text ?? "",
          CultureInfo.CurrentUICulture,
          FlowDirection,
          new Typeface(FontFamily, FontStyle, FontWeight, FontStretch),
          FontSize,
          Brushes.Black);

        UpdateFormattedText();
    }

    private void UpdateFormattedText() {
        if (_FormattedText == null) {
            return;
        }

        _FormattedText.MaxLineCount = TextWrapping == TextWrapping.NoWrap ? 1 : int.MaxValue;
        _FormattedText.TextAlignment = TextAlignment;
        _FormattedText.Trimming = TextTrimming;

        _FormattedText.SetFontSize(FontSize);
        _FormattedText.SetFontStyle(FontStyle);
        _FormattedText.SetFontWeight(FontWeight);
        _FormattedText.SetFontFamily(FontFamily);
        _FormattedText.SetFontStretch(FontStretch);
        _FormattedText.SetTextDecorations(TextDecorations);
    }

    private void EnsureGeometry() {
        if (_TextGeometry != null) {
            return;
        }

        EnsureFormattedText();
        _TextGeometry = _FormattedText.BuildGeometry(new Point(0, 0));
    }
} 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2008-09-18T22:41:25.847

找到了。显然不是那么容易做到，WPF 中没有内置的 Stroke 文本（如果你问我，这是一个很大的缺失功能）。首先创建自定义类：

```
using System;
using System.Windows.Media;
using System.Globalization;
using System.Windows;
using System.Windows.Markup;

namespace CustomXaml
{

public class OutlinedText : FrameworkElement, IAddChild
{
    #region Private Fields

    private Geometry _textGeometry;

    #endregion

    #region Private Methods

    /// <summary>
    /// Invoked when a dependency property has changed. Generate a new FormattedText object to display.
    /// </summary>
    /// <param name="d">OutlineText object whose property was updated.</param>
    /// <param name="e">Event arguments for the dependency property.</param>
    private static void OnOutlineTextInvalidated(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        ((OutlinedText)d).CreateText();
    }

    #endregion

    #region FrameworkElement Overrides

    /// <summary>
    /// OnRender override draws the geometry of the text and optional highlight.
    /// </summary>
    /// <param name="drawingContext">Drawing context of the OutlineText control.</param>
    protected override void OnRender(DrawingContext drawingContext)
    {
        CreateText();
        // Draw the outline based on the properties that are set.
        drawingContext.DrawGeometry(Fill, new Pen(Stroke, StrokeThickness), _textGeometry);

    }

    /// <summary>
    /// Create the outline geometry based on the formatted text.
    /// </summary>
    public void CreateText()
    {
        FontStyle fontStyle = FontStyles.Normal;
        FontWeight fontWeight = FontWeights.Medium;

        if (Bold == true) fontWeight = FontWeights.Bold;
        if (Italic == true) fontStyle = FontStyles.Italic;

        // Create the formatted text based on the properties set.
        FormattedText formattedText = new FormattedText(
            Text,
            CultureInfo.GetCultureInfo("en-us"),                
            FlowDirection.LeftToRight,
            new Typeface(Font, fontStyle, fontWeight, FontStretches.Normal),                
            FontSize,
            Brushes.Black // This brush does not matter since we use the geometry of the text. 
            );

        // Build the geometry object that represents the text.
        _textGeometry = formattedText.BuildGeometry(new Point(0, 0));

        //set the size of the custome control based on the size of the text
        this.MinWidth = formattedText.Width;
        this.MinHeight = formattedText.Height;

    }

    #endregion

    #region DependencyProperties

    /// <summary>
    /// Specifies whether the font should display Bold font weight.
    /// </summary>
    public bool Bold
    {
        get
        {
            return (bool)GetValue(BoldProperty);
        }

        set
        {
            SetValue(BoldProperty, value);
        }
    }

    /// <summary>
    /// Identifies the Bold dependency property.
    /// </summary>
    public static readonly DependencyProperty BoldProperty = DependencyProperty.Register(
        "Bold",
        typeof(bool),
        typeof(OutlinedText),
        new FrameworkPropertyMetadata(
            false,
            FrameworkPropertyMetadataOptions.AffectsRender,
            new PropertyChangedCallback(OnOutlineTextInvalidated),
            null
            )
        );

    /// <summary>
    /// Specifies the brush to use for the fill of the formatted text.
    /// </summary>
    public Brush Fill
    {
        get
        {
            return (Brush)GetValue(FillProperty);
        }

        set
        {
            SetValue(FillProperty, value);
        }
    }

    /// <summary>
    /// Identifies the Fill dependency property.
    /// </summary>
    public static readonly DependencyProperty FillProperty = DependencyProperty.Register(
        "Fill",
        typeof(Brush),
        typeof(OutlinedText),
        new FrameworkPropertyMetadata(
            new SolidColorBrush(Colors.LightSteelBlue),
            FrameworkPropertyMetadataOptions.AffectsRender,
            new PropertyChangedCallback(OnOutlineTextInvalidated),
            null
            )
        );

    /// <summary>
    /// The font to use for the displayed formatted text.
    /// </summary>
    public FontFamily Font
    {
        get
        {
            return (FontFamily)GetValue(FontProperty);
        }

        set
        {
            SetValue(FontProperty, value);
        }
    }

    /// <summary>
    /// Identifies the Font dependency property.
    /// </summary>
    public static readonly DependencyProperty FontProperty = DependencyProperty.Register(
        "Font",
        typeof(FontFamily),
        typeof(OutlinedText),
        new FrameworkPropertyMetadata(
            new FontFamily("Arial"),
            FrameworkPropertyMetadataOptions.AffectsRender,
            new PropertyChangedCallback(OnOutlineTextInvalidated),
            null
            )
        );

    /// <summary>
    /// The current font size.
    /// </summary>
    public double FontSize
    {
        get
        {
            return (double)GetValue(FontSizeProperty);
        }

        set
        {
            SetValue(FontSizeProperty, value);
        }
    }

    /// <summary>
    /// Identifies the FontSize dependency property.
    /// </summary>
    public static readonly DependencyProperty FontSizeProperty = DependencyProperty.Register(
        "FontSize",
        typeof(double),
        typeof(OutlinedText),
        new FrameworkPropertyMetadata(
             (double)48.0,
             FrameworkPropertyMetadataOptions.AffectsRender,
             new PropertyChangedCallback(OnOutlineTextInvalidated),
             null
             )
        );

    /// <summary>
    /// Specifies whether the font should display Italic font style.
    /// </summary>
    public bool Italic
    {
        get
        {
            return (bool)GetValue(ItalicProperty);
        }

        set
        {
            SetValue(ItalicProperty, value);
        }
    }

    /// <summary>
    /// Identifies the Italic dependency property.
    /// </summary>
    public static readonly DependencyProperty ItalicProperty = DependencyProperty.Register(
        "Italic",
        typeof(bool),
        typeof(OutlinedText),
        new FrameworkPropertyMetadata(
             false,
             FrameworkPropertyMetadataOptions.AffectsRender,
             new PropertyChangedCallback(OnOutlineTextInvalidated),
             null
             )
        );

    /// <summary>
    /// Specifies the brush to use for the stroke and optional hightlight of the formatted text.
    /// </summary>
    public Brush Stroke
    {
        get
        {
            return (Brush)GetValue(StrokeProperty);
        }

        set
        {
            SetValue(StrokeProperty, value);
        }
    }

    /// <summary>
    /// Identifies the Stroke dependency property.
    /// </summary>
    public static readonly DependencyProperty StrokeProperty = DependencyProperty.Register(
        "Stroke",
        typeof(Brush),
        typeof(OutlinedText),
        new FrameworkPropertyMetadata(
             new SolidColorBrush(Colors.Teal),
             FrameworkPropertyMetadataOptions.AffectsRender,
             new PropertyChangedCallback(OnOutlineTextInvalidated),
             null
             )
        );

    /// <summary>
    ///     The stroke thickness of the font.
    /// </summary>
    public ushort StrokeThickness
    {
        get
        {
            return (ushort)GetValue(StrokeThicknessProperty);
        }

        set
        {
            SetValue(StrokeThicknessProperty, value);
        }
    }

    /// <summary>
    /// Identifies the StrokeThickness dependency property.
    /// </summary>
    public static readonly DependencyProperty StrokeThicknessProperty = DependencyProperty.Register(
        "StrokeThickness",
        typeof(ushort),
        typeof(OutlinedText),
        new FrameworkPropertyMetadata(
             (ushort)0,
             FrameworkPropertyMetadataOptions.AffectsRender,
             new PropertyChangedCallback(OnOutlineTextInvalidated),
             null
             )
        );

    /// <summary>
    /// Specifies the text string to display.
    /// </summary>
    public string Text
    {
        get
        {
            return (string)GetValue(TextProperty);
        }

        set
        {
            SetValue(TextProperty, value);
        }
    }

    /// <summary>
    /// Identifies the Text dependency property.
    /// </summary>
    public static readonly DependencyProperty TextProperty = DependencyProperty.Register(
        "Text",
        typeof(string),
        typeof(OutlinedText),
        new FrameworkPropertyMetadata(
             "",
             FrameworkPropertyMetadataOptions.AffectsRender,
             new PropertyChangedCallback(OnOutlineTextInvalidated),
             null
             )
        );

    public void AddChild(Object value)
    {

    }

    public void AddText(string value)
    {
        Text = value;
    }

    #endregion
}
} 
```

您可以在您的 xaml 中引用它。

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:customControls="clr-namespace:CustomXaml;assembly=CustomXaml">
    <Grid>
        <customControls:OutlinedText x:Name="TextContent" Fill="#ffffffff" FontSize="28"     
Bold="True" Stroke="Black" StrokeThickness="1" Text="Back" Margin="10,0,10,0" 
HorizontalAlignment="Center" VerticalAlignment="Center" Height="Auto" Width="Auto" />
    </Grid>
</Page> 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2018-04-03T17:33:27.497

我修改[了@Javier G. 答案](https://stackoverflow.com/a/35262509/5508373)

*   笔划位置可以是：中心、外侧或内侧，默认为外侧。

*   填充可以是透明的。

中心：

[![在此处输入图像描述](https://i.stack.imgur.com/gdROq.png)](https://i.stack.imgur.com/gdROq.png)

外部：

[![在此处输入图像描述](https://i.stack.imgur.com/q9mrL.png)](https://i.stack.imgur.com/q9mrL.png)

里面：

[![在此处输入图像描述](https://i.stack.imgur.com/7zJfq.png)](https://i.stack.imgur.com/7zJfq.png)

代码：

```
using System;
using System.ComponentModel;
using System.Globalization;
using System.Windows;
using System.Windows.Documents;
using System.Windows.Markup;
using System.Windows.Media;

namespace WpfApp2
{
    public enum StrokePosition
    {
        Center,
        Outside,
        Inside
    }

    [ContentProperty("Text")]
    public class OutlinedTextBlock : FrameworkElement
    {
        private void UpdatePen()
        {
            _Pen = new Pen(Stroke, StrokeThickness)
            {
                DashCap = PenLineCap.Round,
                EndLineCap = PenLineCap.Round,
                LineJoin = PenLineJoin.Round,
                StartLineCap = PenLineCap.Round
            };

            if (StrokePosition == StrokePosition.Outside || StrokePosition == StrokePosition.Inside)
            {
                _Pen.Thickness = StrokeThickness * 2;
            }

            InvalidateVisual();
        }

        public StrokePosition StrokePosition
        {
            get { return (StrokePosition)GetValue(StrokePositionProperty); }
            set { SetValue(StrokePositionProperty, value); }
        }

        public static readonly DependencyProperty StrokePositionProperty =
            DependencyProperty.Register("StrokePosition", 
                typeof(StrokePosition),
                typeof(OutlinedTextBlock),
                new FrameworkPropertyMetadata(StrokePosition.Outside, FrameworkPropertyMetadataOptions.AffectsRender));

        public static readonly DependencyProperty FillProperty = DependencyProperty.Register(
          "Fill",
          typeof(Brush),
          typeof(OutlinedTextBlock),
          new FrameworkPropertyMetadata(Brushes.Black, FrameworkPropertyMetadataOptions.AffectsRender));

        public static readonly DependencyProperty StrokeProperty = DependencyProperty.Register(
          "Stroke",
          typeof(Brush),
          typeof(OutlinedTextBlock),
          new FrameworkPropertyMetadata(Brushes.Black, FrameworkPropertyMetadataOptions.AffectsRender));

        public static readonly DependencyProperty StrokeThicknessProperty = DependencyProperty.Register(
          "StrokeThickness",
          typeof(double),
          typeof(OutlinedTextBlock),
          new FrameworkPropertyMetadata(1d, FrameworkPropertyMetadataOptions.AffectsRender));

        public static readonly DependencyProperty FontFamilyProperty = TextElement.FontFamilyProperty.AddOwner(
          typeof(OutlinedTextBlock),
          new FrameworkPropertyMetadata(OnFormattedTextUpdated));

        public static readonly DependencyProperty FontSizeProperty = TextElement.FontSizeProperty.AddOwner(
          typeof(OutlinedTextBlock),
          new FrameworkPropertyMetadata(OnFormattedTextUpdated));

        public static readonly DependencyProperty FontStretchProperty = TextElement.FontStretchProperty.AddOwner(
          typeof(OutlinedTextBlock),
          new FrameworkPropertyMetadata(OnFormattedTextUpdated));

        public static readonly DependencyProperty FontStyleProperty = TextElement.FontStyleProperty.AddOwner(
          typeof(OutlinedTextBlock),
          new FrameworkPropertyMetadata(OnFormattedTextUpdated));

        public static readonly DependencyProperty FontWeightProperty = TextElement.FontWeightProperty.AddOwner(
          typeof(OutlinedTextBlock),
          new FrameworkPropertyMetadata(OnFormattedTextUpdated));

        public static readonly DependencyProperty TextProperty = DependencyProperty.Register(
          "Text",
          typeof(string),
          typeof(OutlinedTextBlock),
          new FrameworkPropertyMetadata(OnFormattedTextInvalidated));

        public static readonly DependencyProperty TextAlignmentProperty = DependencyProperty.Register(
          "TextAlignment",
          typeof(TextAlignment),
          typeof(OutlinedTextBlock),
          new FrameworkPropertyMetadata(OnFormattedTextUpdated));

        public static readonly DependencyProperty TextDecorationsProperty = DependencyProperty.Register(
          "TextDecorations",
          typeof(TextDecorationCollection),
          typeof(OutlinedTextBlock),
          new FrameworkPropertyMetadata(OnFormattedTextUpdated));

        public static readonly DependencyProperty TextTrimmingProperty = DependencyProperty.Register(
          "TextTrimming",
          typeof(TextTrimming),
          typeof(OutlinedTextBlock),
          new FrameworkPropertyMetadata(OnFormattedTextUpdated));

        public static readonly DependencyProperty TextWrappingProperty = DependencyProperty.Register(
          "TextWrapping",
          typeof(TextWrapping),
          typeof(OutlinedTextBlock),
          new FrameworkPropertyMetadata(TextWrapping.NoWrap, OnFormattedTextUpdated));

        private FormattedText _FormattedText;
        private Geometry _TextGeometry;
        private Pen _Pen;
        private PathGeometry _clipGeometry;

        public Brush Fill
        {
            get { return (Brush)GetValue(FillProperty); }
            set { SetValue(FillProperty, value); }
        }

        public FontFamily FontFamily
        {
            get { return (FontFamily)GetValue(FontFamilyProperty); }
            set { SetValue(FontFamilyProperty, value); }
        }

        [TypeConverter(typeof(FontSizeConverter))]
        public double FontSize
        {
            get { return (double)GetValue(FontSizeProperty); }
            set { SetValue(FontSizeProperty, value); }
        }

        public FontStretch FontStretch
        {
            get { return (FontStretch)GetValue(FontStretchProperty); }
            set { SetValue(FontStretchProperty, value); }
        }

        public FontStyle FontStyle
        {
            get { return (FontStyle)GetValue(FontStyleProperty); }
            set { SetValue(FontStyleProperty, value); }
        }

        public FontWeight FontWeight
        {
            get { return (FontWeight)GetValue(FontWeightProperty); }
            set { SetValue(FontWeightProperty, value); }
        }

        public Brush Stroke
        {
            get { return (Brush)GetValue(StrokeProperty); }
            set { SetValue(StrokeProperty, value); }
        }

        public double StrokeThickness
        {
            get { return (double)GetValue(StrokeThicknessProperty); }
            set { SetValue(StrokeThicknessProperty, value); }
        }

        public string Text
        {
            get { return (string)GetValue(TextProperty); }
            set { SetValue(TextProperty, value); }
        }

        public TextAlignment TextAlignment
        {
            get { return (TextAlignment)GetValue(TextAlignmentProperty); }
            set { SetValue(TextAlignmentProperty, value); }
        }

        public TextDecorationCollection TextDecorations
        {
            get { return (TextDecorationCollection)GetValue(TextDecorationsProperty); }
            set { SetValue(TextDecorationsProperty, value); }
        }

        public TextTrimming TextTrimming
        {
            get { return (TextTrimming)GetValue(TextTrimmingProperty); }
            set { SetValue(TextTrimmingProperty, value); }
        }

        public TextWrapping TextWrapping
        {
            get { return (TextWrapping)GetValue(TextWrappingProperty); }
            set { SetValue(TextWrappingProperty, value); }
        }

        public OutlinedTextBlock()
        {
            UpdatePen();
            TextDecorations = new TextDecorationCollection();
        }

        protected override void OnRender(DrawingContext drawingContext)
        {
            EnsureGeometry();

            drawingContext.DrawGeometry(Fill, null, _TextGeometry);

            if (StrokePosition == StrokePosition.Outside)
            {
                drawingContext.PushClip(_clipGeometry);
            }
            else if (StrokePosition == StrokePosition.Inside)
            {
                drawingContext.PushClip(_TextGeometry);
            }

            drawingContext.DrawGeometry(null, _Pen, _TextGeometry);

            if (StrokePosition == StrokePosition.Outside || StrokePosition == StrokePosition.Inside)
            {
                drawingContext.Pop();
            }
        }

        protected override Size MeasureOverride(Size availableSize)
        {
            EnsureFormattedText();

            // constrain the formatted text according to the available size

            double w = availableSize.Width;
            double h = availableSize.Height;

            // the Math.Min call is important - without this constraint (which seems arbitrary, but is the maximum allowable text width), things blow up when availableSize is infinite in both directions
            // the Math.Max call is to ensure we don't hit zero, which will cause MaxTextHeight to throw
            _FormattedText.MaxTextWidth = Math.Min(3579139, w);
            _FormattedText.MaxTextHeight = Math.Max(0.0001d, h);

            // return the desired size
            return new Size(Math.Ceiling(_FormattedText.Width), Math.Ceiling(_FormattedText.Height));
        }

        protected override Size ArrangeOverride(Size finalSize)
        {
            EnsureFormattedText();

            // update the formatted text with the final size
            _FormattedText.MaxTextWidth = finalSize.Width;
            _FormattedText.MaxTextHeight = Math.Max(0.0001d, finalSize.Height);

            // need to re-generate the geometry now that the dimensions have changed
            _TextGeometry = null;
            UpdatePen();

            return finalSize;
        }

        private static void OnFormattedTextInvalidated(DependencyObject dependencyObject,
          DependencyPropertyChangedEventArgs e)
        {
            var outlinedTextBlock = (OutlinedTextBlock)dependencyObject;
            outlinedTextBlock._FormattedText = null;
            outlinedTextBlock._TextGeometry = null;

            outlinedTextBlock.InvalidateMeasure();
            outlinedTextBlock.InvalidateVisual();
        }

        private static void OnFormattedTextUpdated(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)
        {
            var outlinedTextBlock = (OutlinedTextBlock)dependencyObject;
            outlinedTextBlock.UpdateFormattedText();
            outlinedTextBlock._TextGeometry = null;

            outlinedTextBlock.InvalidateMeasure();
            outlinedTextBlock.InvalidateVisual();
        }

        private void EnsureFormattedText()
        {
            if (_FormattedText != null)
            {
                return;
            }

            _FormattedText = new FormattedText(
              Text ?? "",
              CultureInfo.CurrentUICulture,
              FlowDirection,
              new Typeface(FontFamily, FontStyle, FontWeight, FontStretch),
              FontSize,
              Brushes.Black);

            UpdateFormattedText();
        }

        private void UpdateFormattedText()
        {
            if (_FormattedText == null)
            {
                return;
            }

            _FormattedText.MaxLineCount = TextWrapping == TextWrapping.NoWrap ? 1 : int.MaxValue;
            _FormattedText.TextAlignment = TextAlignment;
            _FormattedText.Trimming = TextTrimming;

            _FormattedText.SetFontSize(FontSize);
            _FormattedText.SetFontStyle(FontStyle);
            _FormattedText.SetFontWeight(FontWeight);
            _FormattedText.SetFontFamily(FontFamily);
            _FormattedText.SetFontStretch(FontStretch);
            _FormattedText.SetTextDecorations(TextDecorations);
        }

        private void EnsureGeometry()
        {
            if (_TextGeometry != null)
            {
                return;
            }

            EnsureFormattedText();
            _TextGeometry = _FormattedText.BuildGeometry(new Point(0, 0));

            if (StrokePosition == StrokePosition.Outside)
            {
                var boundsGeo = new RectangleGeometry(new Rect(0, 0, ActualWidth, ActualHeight));
                _clipGeometry = Geometry.Combine(boundsGeo, _TextGeometry, GeometryCombineMode.Exclude, null);
            }           
        }
    }
} 
```

用法：

```
<Grid Margin="12" Background="Bisque">
    <local:OutlinedTextBlock Stroke="Red" 
                             ClipToBounds="False"
                             FontSize="56" 
                             Fill="Transparent"
                             StrokePosition="Inside"
                             StrokeThickness="1" Text=" abc">
    </local:OutlinedTextBlock>
</Grid> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-18T17:40:59.657

你应该用 Border 包裹 TextBlock .. 像这样：

```
 <Border BorderBrush="Purple" BorderThickness="2">
        <TextBlock>My fancy TextBlock</TextBlock>
    </Border> 
```

如果您问如何在实际字母（而不是整个 TextBlock）周围放置笔触，您可能希望使用 Glow 的 BitmapEffect 并将 Glow 上的参数设置为您想要的笔触颜色等. 否则你可能不得不创建一些自定义的东西。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-15T16:57:49.313

[MSDN 上的“如何：创建大纲文本”](https://msdn.microsoft.com/en-us/library/ms745816.aspx)包含您需要的所有信息。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-07-04T11:09:44.787

如前所述，将文本转换为路径

```
FormattedText t = new FormattedText
(
    "abcxyz",
    CultureInfo.GetCultureInfo("en-us"),
    FlowDirection.LeftToRight,
    new Typeface(
    new FontFamily("Arial"),
    new FontStyle(),
    new FontWeight(),
    new FontStretch()),
    20,
    Brushes.Transparent
);

Geometry g = t.BuildGeometry(new System.Windows.Point(0, 0));

Path p = new Path();
p.Fill = Brushes.White;
p.Stroke = Brushes.Black;
p.StrokeThickness = 1;
p.Data = g; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-07-02T14:22:48.527

另一种选择是使用常规文本块，但对其应用自定义效果。

结合这个[着色器教程](https://www.codeproject.com/Articles/994276/Shader-Effects-in-WPF-The-basics)和[Prewitt 边缘检测过滤器](https://en.wikipedia.org/wiki/Prewitt_operator)，我设法在文本周围获得了不错的轮廓效果。虽然它具有使用 GPU 渲染并**适用于任何 UIElement**的优势，但我想说@Kent Boogaart 的答案看起来要好一些，而且 EdgeResponse 很挑剔——我不得不经常使用它来获得一个漂亮的轮廓.

XAML 中的最终结果：

```
<Grid>
    <Grid.Resources>
        <local:EdgeDetectionEffect x:Key="OutlineEffect"
            x:Shared="false"
            EdgeResponse=".44"
            ActualHeight="{Binding RelativeSource={RelativeSource AncestorType=TextBlock}, Path=ActualHeight}"
            ActualWidth="{Binding RelativeSource={RelativeSource AncestorType=TextBlock}, Path=ActualWidth}"/>
    </Grid.Resources>
    <TextBlock Text="The Crazy Brown Fox Jumped Over the Lazy Dog."
        FontWeight="Bold"
        FontSize="25"
        Foreground="Yellow"
        Effect="{StaticResource OutlineEffect}"/>
</Grid> 
```

为了创建自定义效果，我首先创建了 EdgeDetectionColorEffect.fx (hdld) 文件——这是 GPU 用来过滤图像的代码。我使用以下命令在 Visual Studio 命令提示符中编译它：

fxc /T ps_2_0 /E main /Focc.ps EdgeDetectionColorEffect.fx

```
sampler2D Input : register(s0);
float ActualWidth : register(c0);
float ActualHeight : register(c1);
float4 OutlineColor : register(c2);
float EdgeDetectionResponse : register(c3);

float4 GetNeighborPixel(float2 pixelPoint, float xOffset, float yOffset)
{
    float2 NeighborPoint = {pixelPoint.x + xOffset, pixelPoint.y + yOffset};
    return tex2D(Input, NeighborPoint);
}

// pixel locations:
// 00 01 02
// 10 11 12
// 20 21 22
float main(float2 pixelPoint : TEXCOORD) : COLOR
{

     float wo = 1 / ActualWidth; //WidthOffset
     float ho = 1 / ActualHeight; //HeightOffset

    float4 c00 = GetNeighborPixel(pixelPoint, -wo, -ho); // color of the pixel up and to the left of me.
    float4 c01 = GetNeighborPixel(pixelPoint,  00, -ho);        
    float4 c02 = GetNeighborPixel(pixelPoint,  wo, -ho);
    float4 c10 = GetNeighborPixel(pixelPoint, -wo,   0);
    float4 c11 = tex2D(Input, pixelPoint); // this is the current pixel
    float4 c12 = GetNeighborPixel(pixelPoint,  wo,   0);
    float4 c20 = GetNeighborPixel(pixelPoint, -wo,  ho);
    float4 c21 = GetNeighborPixel(pixelPoint,   0,  ho);
    float4 c22 = GetNeighborPixel(pixelPoint,  wo,  ho);

    float t00 = c00.r + c00.g + c00.b; //total of color channels
    float t01 = c01.r + c01.g + c01.b;
    float t02 = c02.r + c02.g + c02.b;
    float t10 = c10.r + c10.g + c10.b;
    float t11 = c11.r + c11.g + c11.b;
    float t12 = c12.r + c12.g + c12.b;
    float t20 = c20.r + c20.g + c20.b;
    float t21 = c21.r + c21.g + c21.b;
    float t22 = c22.r + c22.g + c22.b;

    //Prewitt - convolve the 9 pixels with:
    //       01 01 01        01 00 -1
    // Gy =  00 00 00   Gx = 01 00 -1
    //       -1 -1 -1        01 00 -1

    float gy = 0.0;  float gx = 0.0;
    gy += t00;       gx += t00;
    gy += t01;       gx += t10;
    gy += t02;       gx += t20;
    gy -= t20;       gx -= t02;
    gy -= t21;       gx -= t12;
    gy -= t22;       gx -= t22;

    if((gy*gy + gx*gx) > EdgeDetectionResponse)
    {
        return OutlineColor;
    }

    return c11;
} 
```

这是 wpf 效果类：

```
public class EdgeDetectionEffect : ShaderEffect
{
    private static PixelShader _shader = new PixelShader { UriSource = new Uri("path to your compiled shader probably called cc.ps", UriKind.Absolute) };

public EdgeDetectionEffect()
{
    PixelShader = _shader;
    UpdateShaderValue(InputProperty);
    UpdateShaderValue(ActualHeightProperty);
    UpdateShaderValue(ActualWidthProperty);
    UpdateShaderValue(OutlineColorProperty);
    UpdateShaderValue(EdgeResponseProperty);
}

public Brush Input
{
     get => (Brush)GetValue(InputProperty);
     set => SetValue(InputProperty, value);
}
public static readonly DependencyProperty InputProperty = 
    ShaderEffect.RegisterPixelShaderSamplerProperty(nameof(Input), 
    typeof(EdgeDetectionEffect), 0);

public double ActualWidth
{
     get => (double)GetValue(ActualWidthProperty);
     set => SetValue(ActualWidthProperty, value);
}
public static readonly DependencyProperty ActualWidthProperty =
    DependencyProperty.Register(nameof(ActualWidth), typeof(double), typeof(EdgeDetectionEffect),
    new UIPropertyMetadata(1.0, PixelShaderConstantCallback(0)));

public double ActualHeight
{
     get => (double)GetValue(ActualHeightProperty);
     set => SetValue(ActualHeightProperty, value);
}
public static readonly DependencyProperty ActualHeightProperty =
    DependencyProperty.Register(nameof(ActualHeight), typeof(double), typeof(EdgeDetectionEffect),
    new UIPropertyMetadata(1.0, PixelShaderConstantCallback(1)));

public Color OutlineColor
{
     get => (Color)GetValue(OutlineColorProperty);
     set => SetValue(OutlineColorProperty, value);
}
public static readonly DependencyProperty OutlineColorProperty=
    DependencyProperty.Register(nameof(OutlineColor), typeof(Color), typeof(EdgeDetectionEffect),
    new UIPropertyMetadata(Colors.Black, PixelShaderConstantCallback(2)));

public double EdgeResponse
{
     get => (double)GetValue(EdgeResponseProperty);
     set => SetValue(EdgeResponseProperty, value);
}
public static readonly DependencyProperty EdgeResponseProperty =
    DependencyProperty.Register(nameof(EdgeResponse), typeof(double), typeof(EdgeDetectionEffect),
    new UIPropertyMetadata(4.0, PixelShaderConstantCallback(3)));
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T16:35:51.577

在 Blend 中，您可以将 TextBlock 转换为 Path，然后使用普通的 Stroke 属性。但是我假设您想要一些可以使动态...

否则我会认为它必须是某种位图效果或特殊画笔。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-04-10T20:47:37.513

我也试图实现与此类似的东西。这里提到的类很棒，但并不是我想要的，因为只有当文本足够大时它才真正看起来正确。我试图显示的文本大约是 10 到 11 号字体大小，而且笔画非常大，字母混合在一起。

澄清一下，这个文本应该覆盖在用户定义的图片上，它可以有不同的颜色，我想确保这个文本会显示出来。

我不知道这是否是最佳实践，但这至少实现了我想要的外观（基于[这篇文章](http://msdn.microsoft.com/en-us/library/ms748273%28v=vs.110%29.aspx%29%3a)）：

```
<Style x:Key="OutlinedTextBlockOuter" TargetType="TextBlock">
    <Setter Property="Foreground" Value="Black" />
    <Setter Property="FontSize" Value="10"/>
    <Setter Property="Effect">
        <Setter.Value>
            <BlurEffect Radius="3.0"/>
        </Setter.Value>
    </Setter>
</Style>
<Style x:Key="OutlinedTextBlockInner" TargetType="TextBlock">
    <Setter Property="Foreground" Value="White" />
    <Setter Property="FontSize" Value="10"/>
</Style> 
```

然后对于实际的 TextBlocks，我组合了两个 Outer 样式的 TextBlock，因为一个太轻了，一个 Inner 样式的 TextBlock：

```
<Grid Margin="5">
    <TextBlock Style="{StaticResource OutlinedTextBlockOuter}" Text="This is outlined text using BlurEffect"/>
    <TextBlock Style="{StaticResource OutlinedTextBlockOuter}" Text="This is outlined text using BlurEffect"/>
    <TextBlock Style="{StaticResource OutlinedTextBlockInner}" Text="This is outlined text using BlurEffect"/>
</Grid> 
```

或者，您可以使用 DropShadowEffect，仅使用两个文本框看起来还不错（尽管添加更多具有不同方向和降低不透明度的 DropShadowEffect 可能看起来更好）：

```
<Grid Margin="5">
    <TextBlock  Text="This is my outlined text using the DropShadowEffect" FontSize="10" Foreground="White">
        <TextBlock.Effect>
            <DropShadowEffect ShadowDepth="1" BlurRadius="2" Opacity="0.75" Direction="315"/>
        </TextBlock.Effect>
    </TextBlock>
    <TextBlock  Text="This is my outlined text using the DropShadowEffect" FontSize="10" Foreground="White">
        <TextBlock.Effect>
            <DropShadowEffect ShadowDepth="1" BlurRadius="2" Opacity="0.75" Direction="135"/>
        </TextBlock.Effect>
    </TextBlock>
</Grid> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-09-09T08:09:13.527

如果适用于任何人，这里有一个仅使用 XAML 的简单解决方案。我不确定它的性能是好是坏，但在我看来，它看起来比上面的任何其他解决方案都要好。我按照这个 Old School 示例将其包装在`ContentControl`样式（和模板）中:) [http://oldschooldotnet.blogspot.co.il/2009/02/fancy-fonts-in-xaml-silverlight-and-wpf.html](http://oldschooldotnet.blogspot.co.il/2009/02/fancy-fonts-in-xaml-silverlight-and-wpf.html)

```
<Style x:Key="OutlinedText" TargetType="{x:Type ContentControl}">
    <!-- Some Style Setters -->
    <Setter Property="Content" Value="Outlined Text"/>
    <Setter Property="Padding" Value="0"/>
    <!-- Border Brush Must be equal '0' because TextBlock that emulate the stroke will using the BorderBrush as to define 'Stroke' color-->
    <Setter Property="BorderThickness" Value="0"/>
    <!-- Border Brush define 'Stroke' Color-->
    <Setter Property="BorderBrush" Value="White"/>
    <Setter Property="Foreground" Value="Black"/>
    <Setter Property="FontSize" Value="24"/>
    <Setter Property="FontFamily" Value="Seoge UI Bold"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ContentControl}">
                <Canvas Width="{Binding ActualWidth, ElementName=FillText}" Height="{Binding ActualHeight, ElementName=FillText}">
                    <Canvas.Resources>
                        <!-- Style to ease the duplication of Text Blocks that emulate the stroke: Binding to one element (or to template) is the first part of the Trick -->
                        <Style x:Key="OutlinedTextStrokeTextBlock_Style" TargetType="{x:Type TextBlock}">
                            <Setter Property="Text" Value="{Binding Text, ElementName=FillText}"/>
                            <Setter Property="FontSize" Value="{Binding FontSize, ElementName=FillText}"/>
                            <Setter Property="FontFamily" Value="{Binding FontFamily, ElementName=FillText}"/>
                            <Setter Property="FontStyle" Value="{Binding FontStyle, ElementName=FillText}"/>
                            <Setter Property="FontWeight" Value="{Binding FontWeight, ElementName=FillText}"/>
                            <Setter Property="Padding" Value="{Binding TextAlignment, ElementName=Padding}"/>
                            <Setter Property="TextAlignment" Value="{Binding TextAlignment, ElementName=FillText}"/>
                            <Setter Property="VerticalAlignment" Value="{Binding VerticalAlignment, ElementName=FillText}"/>
                        </Style>
                    </Canvas.Resources>
                    <!-- Offseting the Text block will create the outline, the margin is the Stroke Width-->
                    <TextBlock Foreground="{TemplateBinding BorderBrush}" Margin="-1,0,0,0" Style="{DynamicResource OutlinedTextStrokeTextBlock_Style}"/>
                    <TextBlock Foreground="{TemplateBinding BorderBrush}" Margin="0,-1,0,0" Style="{DynamicResource OutlinedTextStrokeTextBlock_Style}"/>
                    <TextBlock Foreground="{TemplateBinding BorderBrush}" Margin="0,0,-1,0" Style="{DynamicResource OutlinedTextStrokeTextBlock_Style}"/>
                    <TextBlock Foreground="{TemplateBinding BorderBrush}" Margin="0,0,0,-1" Style="{DynamicResource OutlinedTextStrokeTextBlock_Style}"/>
                    <!-- Base TextBlock Will be the Fill -->
                    <TextBlock x:Name="FillText" Text="{TemplateBinding Content}" FontSize="{TemplateBinding FontSize}" FontFamily="{TemplateBinding FontFamily}"
                               FontStyle="{TemplateBinding FontStyle}" FontWeight="{TemplateBinding FontWeight}" Padding="0" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" 
                               TextAlignment="{TemplateBinding HorizontalContentAlignment}"
                               Style="{DynamicResource TbMediaOverlay_Style}"/>
                </Canvas>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-02-08T03:15:00.407

我必须将它添加到 MeasureOverride 以便在使用布局舍入时显示单行文本。当文本换行时它工作正常。

```
// return the desired size
return new Size(Math.Ceiling(_FormattedText.Width), Math.Ceiling(_FormattedText.Height)); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T16:39:16.450

<TextBlock> 本身没有装饰属性。我会将它放在带有 <Rectangle> 的 <Canvas> 上，并在那里应用笔画。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-02-05T23:47:47.773

可以只使用标签。它有更多你可以玩的属性。例子：

```
 <Style x:Key="LeftBorderLabel" TargetType="{x:Type Label}">
            <Setter Property="Margin"  Value="0" />
            <Setter Property="BorderThickness" Value="1,0,0,0" />
            <Setter Property="BorderBrush" Value="Blue" />
  </Style> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-07-22T20:09:23.147

这对我帮助很大！以防万一将来有人需要它，这是 VB 版本（将 StrokeThickness 设为双精度并添加了 Underline 属性）：

```
Imports System
Imports System.Windows.Media
Imports System.Globalization
Imports System.Windows
Imports System.Windows.Markup

Namespace CustomXaml

    Public Class OutlinedText
        Inherits FrameworkElement
        Implements IAddChild

        Private _textGeometry As Geometry

        Private Shared Sub OnOutlineTextInvalidated(d As DependencyObject, e As DependencyPropertyChangedEventArgs)
            DirectCast(d, OutlinedText).CreateText()
        End Sub

        Protected Overrides Sub OnRender(drawingContext As System.Windows.Media.DrawingContext)
            CreateText()
            drawingContext.DrawGeometry(Fill, New Pen(Stroke, StrokeThickness), _textGeometry)
        End Sub

        Public Sub CreateText()
            Dim fontStyle = FontStyles.Normal
            Dim fontWeight = FontWeights.Medium
            Dim fontDecoration = New TextDecorationCollection()

            If Bold Then fontWeight = FontWeights.Bold
            If Italic Then fontStyle = FontStyles.Italic
            If Underline Then fontDecoration.Add(TextDecorations.Underline)

            Dim formattedText = New FormattedText( _
                                Text, _
                                CultureInfo.GetCultureInfo("en-us"), _
                                FlowDirection.LeftToRight, _
                                New Typeface(Font, fontStyle, fontWeight, FontStretches.Normal), _
                                FontSize, _
                                Brushes.Black _
                                )
            formattedText.SetTextDecorations(fontDecoration)

            _textGeometry = formattedText.BuildGeometry(New Point(0, 0))

            Me.MinWidth = formattedText.Width
            Me.MinHeight = formattedText.Height
        End Sub

        Public Property Bold As Boolean
            Get
                Return CType(GetValue(BoldProperty), Boolean)
            End Get
            Set(value As Boolean)
                SetValue(BoldProperty, value)
            End Set
        End Property

        Public Shared ReadOnly BoldProperty As DependencyProperty = DependencyProperty.Register( _
            "Bold", _
            GetType(Boolean), _
            GetType(OutlinedText), _
            New FrameworkPropertyMetadata( _
                False, _
                FrameworkPropertyMetadataOptions.AffectsRender, _
                New PropertyChangedCallback(AddressOf OnOutlineTextInvalidated), _
                Nothing _
            ) _
        )

        Public Property Underline As Boolean
            Get
                Return CType(GetValue(UnderlineProperty), Boolean)
            End Get
            Set(value As Boolean)
                SetValue(UnderlineProperty, value)
            End Set
        End Property

        Public Shared ReadOnly UnderlineProperty As DependencyProperty = DependencyProperty.Register( _
            "Underline", _
            GetType(Boolean), _
            GetType(OutlinedText), _
            New FrameworkPropertyMetadata( _
                False, _
                FrameworkPropertyMetadataOptions.AffectsRender, _
                New PropertyChangedCallback(AddressOf OnOutlineTextInvalidated), _
                Nothing _
            ) _
        )

        Public Property Fill As Brush
            Get
                Return CType(GetValue(FillProperty), Brush)
            End Get
            Set(value As Brush)
                SetValue(FillProperty, value)
            End Set
        End Property

        Public Shared ReadOnly FillProperty As DependencyProperty = DependencyProperty.Register( _
            "Fill", _
            GetType(Brush), _
            GetType(OutlinedText), _
            New FrameworkPropertyMetadata( _
                New SolidColorBrush(Colors.LightSteelBlue), _
                FrameworkPropertyMetadataOptions.AffectsRender, _
                New PropertyChangedCallback(AddressOf OnOutlineTextInvalidated), _
                Nothing _
            ) _
        )

        Public Property Font As FontFamily
            Get
                Return CType(GetValue(FontProperty), FontFamily)
            End Get
            Set(value As FontFamily)
                SetValue(FontProperty, value)
            End Set
        End Property

        Public Shared ReadOnly FontProperty As DependencyProperty = DependencyProperty.Register( _
            "Font", _
            GetType(FontFamily), _
            GetType(OutlinedText), _
            New FrameworkPropertyMetadata( _
                New FontFamily("Arial"), _
                FrameworkPropertyMetadataOptions.AffectsRender, _
                New PropertyChangedCallback(AddressOf OnOutlineTextInvalidated), _
                Nothing _
            ) _
        )

        Public Property FontSize As Double
            Get
                Return CType(GetValue(FontSizeProperty), Double)
            End Get
            Set(value As Double)
                SetValue(FontSizeProperty, value)
            End Set
        End Property

        Public Shared ReadOnly FontSizeProperty As DependencyProperty = DependencyProperty.Register( _
            "FontSize", _
            GetType(Double), _
            GetType(OutlinedText), _
            New FrameworkPropertyMetadata( _
                CDbl(48.0), _
                FrameworkPropertyMetadataOptions.AffectsRender, _
                New PropertyChangedCallback(AddressOf OnOutlineTextInvalidated), _
                Nothing _
            ) _
        )

        Public Property Italic As Boolean
            Get
                Return CType(GetValue(ItalicProperty), Boolean)
            End Get
            Set(value As Boolean)
                SetValue(ItalicProperty, value)
            End Set
        End Property

        Public Shared ReadOnly ItalicProperty As DependencyProperty = DependencyProperty.Register( _
            "Italic", _
            GetType(Boolean), _
            GetType(OutlinedText), _
            New FrameworkPropertyMetadata( _
                False, _
                FrameworkPropertyMetadataOptions.AffectsRender, _
                New PropertyChangedCallback(AddressOf OnOutlineTextInvalidated), _
                Nothing _
            ) _
        )

        Public Property Stroke As Brush
            Get
                Return CType(GetValue(StrokeProperty), Brush)
            End Get
            Set(value As Brush)
                SetValue(StrokeProperty, value)
            End Set
        End Property

        Public Shared ReadOnly StrokeProperty As DependencyProperty = DependencyProperty.Register( _
            "Stroke", _
            GetType(Brush), _
            GetType(OutlinedText), _
            New FrameworkPropertyMetadata( _
                New SolidColorBrush(Colors.Teal), _
                FrameworkPropertyMetadataOptions.AffectsRender, _
                New PropertyChangedCallback(AddressOf OnOutlineTextInvalidated), _
                Nothing _
            ) _
        )

        Public Property StrokeThickness As Double
            Get
                Return CType(GetValue(StrokeThicknessProperty), Double)
            End Get
            Set(value As Double)
                SetValue(StrokeThicknessProperty, value)
            End Set
        End Property

        Public Shared ReadOnly StrokeThicknessProperty As DependencyProperty = DependencyProperty.Register( _
            "StrokeThickness", _
            GetType(Double), _
            GetType(OutlinedText), _
            New FrameworkPropertyMetadata( _
                CDbl(0), _
                FrameworkPropertyMetadataOptions.AffectsRender, _
                New PropertyChangedCallback(AddressOf OnOutlineTextInvalidated), _
                Nothing _
            ) _
        )

        Public Property Text As String
            Get
                Return CType(GetValue(TextProperty), String)
            End Get
            Set(value As String)
                SetValue(TextProperty, value)
            End Set
        End Property

        Public Shared ReadOnly TextProperty As DependencyProperty = DependencyProperty.Register( _
            "Text", _
            GetType(String), _
            GetType(OutlinedText), _
            New FrameworkPropertyMetadata( _
                "", _
                FrameworkPropertyMetadataOptions.AffectsRender, _
                New PropertyChangedCallback(AddressOf OnOutlineTextInvalidated), _
                Nothing _
            ) _
        )

        Public Sub AddChild(value As Object) Implements System.Windows.Markup.IAddChild.AddChild

        End Sub

        Public Sub AddText(text As String) Implements System.Windows.Markup.IAddChild.AddText
            Me.Text = text
        End Sub
    End Class
End Namespace 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-06-01T22:56:19.317

对 Kent Boogaart 的代码稍作修改，虽然很棒，但缺少一个小细节。这可能有点不准确，因为它只会测量填充而不是描边，但添加几`OnRender()` `Viewbox`行将能够掌握如何处理它（尽管与 一样`TextBox`，不在预览中）。

```
protected override void OnRender(DrawingContext drawingContext)
{
    this.EnsureGeometry();

    this.Width = this.formattedText.Width;
    this.Height = this.formattedText.Height;

    drawingContext.DrawGeometry(this.Fill, new Pen(this.Stroke, this.StrokeThickness), this.textGeometry);
} 
```

我将它与两层文本一起使用，因此笔画似乎只在外面，如下所示。这显然不会立即起作用，因为它指的是特定的图像和字体。

```
<Viewbox Stretch="UniformToFill" Margin="0" Grid.Column="1">
    <bd:OutlinedText x:Name="LevelTitleStroke" Text="Level" FontSize="80pt" FontFamily="/fonts/papercuts-2.ttf#Paper Cuts 2" Grid.Row="1" TextAlignment="Center" IsHitTestVisible="False" StrokeThickness="15">
        <bd:OutlinedText.Stroke>
            <ImageBrush ImageSource="/WpfApplication1;component/GrungeMaps/03DarkBlue.jpg" Stretch="None" />
        </bd:OutlinedText.Stroke>
    </bd:OutlinedText>
</Viewbox>
<Viewbox Stretch="UniformToFill" Margin="0" Grid.Column="1">
    <bd:OutlinedText x:Name="LevelTitleFill" Text="Level" FontSize="80pt" FontFamily="/fonts/papercuts-2.ttf#Paper Cuts 2" Grid.Row="1" TextAlignment="Center" IsHitTestVisible="False">
        <bd:OutlinedText.Fill>
            <ImageBrush ImageSource="/WpfApplication1;component/GrungeMaps/03Red.jpg" Stretch="None" />
        </bd:OutlinedText.Fill>
    </bd:OutlinedText>
</Viewbox> 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-07-18T17:30:20.600

我在自定义控件中使用了 Kent 的解决方案。当对 text 属性使用模板绑定时，它会导致 null 异常。

我不得不像这样修改 MeasureOverride 函数：

```
 protected override Size MeasureOverride(Size availableSize)
    {
        this.EnsureFormattedText();

        if (this.formattedText == null)
        {
            this.formattedText = new FormattedText(
                                (this.Text == null) ? "" : this.Text,
                                CultureInfo.CurrentUICulture,
                                this.FlowDirection,
                                new Typeface(this.FontFamily, this.FontStyle, this.FontWeight, FontStretches.Normal),
                                this.FontSize,
                                Brushes.Black);
        }

        // constrain the formatted text according to the available size
        // the Math.Min call is important - without this constraint (which seems arbitrary, but is the maximum allowable text width), things blow up when availableSize is infinite in both directions
        this.formattedText.MaxTextWidth = Math.Min(3579139, availableSize.Width);
        this.formattedText.MaxTextHeight = availableSize.Height;

        // return the desired size
        return new Size(this.formattedText.Width, this.formattedText.Height);
    } 
```

应该注意的是，我没有对此进行彻底的测试。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-09-26T00:11:11.987

由于我有另一个答案，我会发布它以供记录。我认为它不那么优雅，不使用`Geometry`, `Path`and `FormattedText`，虽然更简单，而且（如果你知道我想知道）渲染速度可能更快？它基本上有 8 次相同的文本，但在所有基本方向上都发生了变化。

这是我的 UserControl 的代码：

```
/// <summary>
/// User Control to display a Text with an outline
/// </summary>
public partial class OutlinedText : UserControl, INotifyPropertyChanged
{

    #region DependencyProperties

    /// <summary>
    /// The Text to render
    /// </summary>
    public string Text
    {
        get { return (string)GetValue(TextProperty); }
        set { SetValue(TextProperty, value); }
    }

    // Using a DependencyProperty as the backing store for Text.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty TextProperty =
        DependencyProperty.Register("Text", typeof(string), typeof(OutlinedText), new PropertyMetadata(""));

    /// <summary>
    /// The size (thickness) of the Stroke
    /// </summary>
    public int StrokeSize
    {
        get { return (int)GetValue(StrokeSizeProperty); }
        set { SetValue(StrokeSizeProperty, value); }
    }

    // Using a DependencyProperty as the backing store for StrokeSize.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty StrokeSizeProperty =
        DependencyProperty.Register("StrokeSize", typeof(int), typeof(OutlinedText), new PropertyMetadata(1));

    /// <summary>
    /// The Color of the Stroke
    /// </summary>
    public Brush StrokeColor
    {
        get { return (Brush)GetValue(StrokeColorProperty); }
        set { SetValue(StrokeColorProperty, value); }
    }

    // Using a DependencyProperty as the backing store for StrokeColor.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty StrokeColorProperty =
        DependencyProperty.Register("StrokeColor", typeof(Brush), typeof(OutlinedText), new PropertyMetadata(Brushes.Black));

    #endregion

    #region ctor
    public OutlinedText()
    {
        InitializeComponent();
        this.DataContext = this;
    } 
    #endregion

    public event PropertyChangedEventHandler PropertyChanged;
    protected virtual void OnPropertyChanged(string propertyName)
    {
        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
    }
} 
```

在 XAML 方面：

```
<UserControl x:Class="NAMESPACE.OutlinedText"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         xmlns:local="clr-namespace:NAMESPACE"
         mc:Ignorable="d" 
         d:DesignHeight="450" d:DesignWidth="800">
<UserControl.Resources>
    <ResourceDictionary>
        <local:IntegerInverterConverter x:Key="IntegerInverterConverterKey"/>
    </ResourceDictionary>
</UserControl.Resources>
<Grid>
    <!--Bottom Right ⬊ -->
    <TextBlock Foreground="{Binding StrokeColor}"
               FontSize="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontSize}"
               FontWeight="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontWeight}"
               FontFamily="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontFamily}"
               RenderTransformOrigin="0.5, 0.5"
               Text="{Binding Text}" >
        <TextBlock.RenderTransform>
            <TranslateTransform X="{Binding StrokeSize}" Y="{Binding StrokeSize}"/>
        </TextBlock.RenderTransform>
    </TextBlock>
    <!--Top Left ⬉ -->
    <TextBlock Foreground="{Binding StrokeColor}"                           
               FontSize="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontSize}"
               FontWeight="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontWeight}"
               FontFamily="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontFamily}"
               RenderTransformOrigin="0.5, 0.5"
               Text="{Binding Text}" >
        <TextBlock.RenderTransform>
            <TranslateTransform X="{Binding StrokeSize, Converter={StaticResource IntegerInverterConverterKey}}" Y="{Binding StrokeSize, Converter={StaticResource IntegerInverterConverterKey}}"/>
        </TextBlock.RenderTransform>
    </TextBlock>
    <!--Bottom Left ⬋ -->
    <TextBlock Foreground="{Binding StrokeColor}"                       
               FontSize="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontSize}"
               FontWeight="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontWeight}"
               FontFamily="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontFamily}"
               RenderTransformOrigin="0.5, 0.5"
               Text="{Binding Text}" >
        <TextBlock.RenderTransform>
            <TranslateTransform X="{Binding StrokeSize, Converter={StaticResource IntegerInverterConverterKey}}" Y="{Binding StrokeSize}"/>
        </TextBlock.RenderTransform>
    </TextBlock>
    <!--Top Right ⬈ -->
    <TextBlock Foreground="{Binding StrokeColor}"                           
               FontSize="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontSize}"
               FontWeight="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontWeight}"
               FontFamily="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontFamily}"
               RenderTransformOrigin="0.5, 0.5"
               Text="{Binding Text}" >
        <TextBlock.RenderTransform>
            <TranslateTransform X="{Binding StrokeSize}" Y="{Binding StrokeSize, Converter={StaticResource IntegerInverterConverterKey}}"/>
        </TextBlock.RenderTransform>
    </TextBlock>
    <!--Top ⬆ -->
    <TextBlock Foreground="{Binding StrokeColor}"                           
               FontSize="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontSize}"
               FontWeight="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontWeight}"
               FontFamily="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontFamily}"
               RenderTransformOrigin="0.5, 0.5"
               Text="{Binding Text}" >
        <TextBlock.RenderTransform>
            <TranslateTransform X="0" Y="{Binding StrokeSize, Converter={StaticResource IntegerInverterConverterKey}}"/>
        </TextBlock.RenderTransform>
    </TextBlock>
    <!--Bottom ⬇ -->
    <TextBlock Foreground="{Binding StrokeColor}"                           
               FontSize="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontSize}"
               FontWeight="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontWeight}"
               FontFamily="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontFamily}"
               RenderTransformOrigin="0.5, 0.5"
               Text="{Binding Text}" >
        <TextBlock.RenderTransform>
            <TranslateTransform X="0" Y="{Binding StrokeSize}"/>
        </TextBlock.RenderTransform>
    </TextBlock>
    <!--Right ➡ -->
    <TextBlock Foreground="{Binding StrokeColor}"                           
               FontSize="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontSize}"
               FontWeight="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontWeight}"
               FontFamily="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontFamily}"
               RenderTransformOrigin="0.5, 0.5"
               Text="{Binding Text}" >
        <TextBlock.RenderTransform>
            <TranslateTransform X="{Binding StrokeSize}" Y="0"/>
        </TextBlock.RenderTransform>
    </TextBlock>
    <!--Left ⬅ -->
    <TextBlock Foreground="{Binding StrokeColor}"
               FontSize="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontSize}"
               FontWeight="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontWeight}"
               FontFamily="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontFamily}"
               RenderTransformOrigin="0.5, 0.5"
               Text="{Binding Text}" >
        <TextBlock.RenderTransform>
            <TranslateTransform X="{Binding StrokeSize, Converter={StaticResource IntegerInverterConverterKey}}" Y="0"/>
        </TextBlock.RenderTransform>
    </TextBlock>
    <TextBlock Foreground="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=Foreground}"
               FontSize="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontSize}"
               FontWeight="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontWeight}"                       
               FontFamily="{Binding RelativeSource={RelativeSource AncestorType=UserControl},Path=FontFamily}"
               Text="{Binding Text}" />
</Grid> 
```

这里使用的转换器是一个简单的 *(-1) 整数，以避免使用另一个属性。

用法 ：

```
<local:OutlinedText Margin="WHATEVER" HorizontalAlignment="WHATEVER" VerticalAlignment="WHATEVER"
                                Text="Your Text" StrokeColor="WhiteSmoke" StrokeSize="2" FontSize="20" FontWeight="Bold"
                                Foreground="Magenta"/> 
```

# sql-server - 将形式为“GUID1，GUID2，GUID3 ...”的字符串插入到 TSQL 中的 IN 语句中

> ID：93653
> 
> 赞同：2
> 
> 时间：2008-09-18T15:36:33.857
> 
> 标签：sql-server, tsql, stored-procedures, guid

我的数据库中有一个存储过程，看起来像这样

```
ALTER PROCEDURE [dbo].[GetCountingAnalysisResults] 
    @RespondentFilters varchar
AS
BEGIN

@RespondentFilters = '''8ec94bed-fed6-4627-8d45-21619331d82a, 114c61f2-8935-4755-b4e9-4a598a51cc7f'''

DECLARE @SQL nvarchar(600)

SET @SQL = 
   'SELECT *
    FROM Answer
    WHERE Answer.RespondentId IN ('+@RespondentFilters+'''))
    GROUP BY ChosenOptionId'

exec sp_executesql @SQL

END 
```

它编译并执行，但不知怎的，它并没有给我很好的结果，就像 IN 语句不起作用一样。请，如果有人知道这个问题的解决方案，请帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T15:59:11.663

您绝对应该考虑将 GUID 列表拆分为一个表并加入该表。您应该能够在线找到大量用于将输入字符串拆分为表的表值函数的示例。

否则，您的存储过程很容易受到 SQL 注入的攻击。考虑@RespondentFilters 的以下值：

```
@RespondentFilters = '''''); SELECT * FROM User; /*' 
```

您的查询将更安全地解析（即验证）参数值并加入：

```
SELECT *
FROM Answer
WHERE Answer.RespondentId IN (SELECT [Item] FROM dbo.ParseList(@RespondentFilters))
GROUP BY ChosenOptionId 
```

或者

```
SELECT *
FROM Answer
INNER JOIN dbo.ParseList(@RespondentFilters) Filter ON Filter.Item = Answer.RespondentId
GROUP BY ChosenOptionId 
```

它的效率也稍高一些，因为您不处理动态 SQL（sp_executesql 将缓存查询计划，但我不确定它是否会准确地将您的查询识别为*参数化*查询，因为它在IN 子句）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T15:45:07.097

You need single quotes around each GUID in the list

```
@RespondentFilters = '''8ec94bed-fed6-4627-8d45-21619331d82a'', ''114c61f2-8935-4755-b4e9-4a598a51cc7f''' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T15:41:02.737

It looks like you don't have closing quotes around your @RespondentFilters

```
'8ec94bed-fed6-4627-8d45-21619331d82a, 114c61f2-8935-4755-b4e9-4a598a51cc7f'
```

Since GUIDs do a string compare, that's not going to work.

Your best bet is to use some code to split the list out into multiple values.

Something like this:

```
 -- This would be the input parameter of the stored procedure, if you want to do it that way, or a UDF
declare @string varchar(500)
set @string = 'ABC,DEF,GHIJK,LMNOPQRS,T,UV,WXY,Z'

declare @pos int
declare @piece varchar(500)

-- Need to tack a delimiter onto the end of the input string if one doesn't exist
if right(rtrim(@string),1)  ','
 set @string = @string  + ','

set @pos =  patindex('%,%' , @string)
while @pos  0
begin
 set @piece = left(@string, @pos - 1)

 -- You have a piece of data, so insert it, print it, do whatever you want to with it.
 print cast(@piece as varchar(500))

 set @string = stuff(@string, 1, @pos, '')
 set @pos =  patindex('%,%' , @string)
end 
```

Code stolen from [Raymond Lewallen](http://codebetter.com/blogs/raymond.lewallen/archive/2005/10/26/133774.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T15:44:26.177

I think you need quotes inside the string too. Try:

```
@RespondentFilters = '''8ec94bed-fed6-4627-8d45-21619331d82a'',''114c61f2-8935-4755-b4e9-4a598a51cc7f''' 
```

You could also consider parsing the @RespondentFilters into a temporary table.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-20T12:37:09.160

为您的答案加油。他们都帮了大忙。我已经通过编写一个拆分函数来解决这个问题，它工作正常。这比我本可以做的有点开销，但你知道，截止日期就在拐角处:)

# c# - SQLite 是否有 .NET/C# 包装器？

> ID：93654
> 
> 赞同：270
> 
> 时间：2008-09-18T15:36:48.053
> 
> 标签：c#, .net, database, sqlite

我有点想在 C#.Net 中使用 SQLite，但我似乎找不到合适的库。有吗？官方的？除了使用包装器之外，还有其他使用 SQLite 的方法吗？

* * *

## 回答 #1

> 赞同：329
> 
> 时间：2008-09-18T15:38:08.190

来自[https://system.data.sqlite.org](https://system.data.sqlite.org/)：

> System.Data.SQLite 是 SQLite 的 ADO.NET 适配器。
> 
> System.Data.SQLite 由 Robert Simpson 创立。Robert 仍然拥有此存储库的提交权限，但不再是活跃的贡献者。开发和维护工作现在主要由 SQLite 开发团队执行。SQLite 团队致力于长期支持 System.Data.SQLite。

“System.Data.SQLite 是最初的 SQLite 数据库引擎和一个完整的 ADO.NET 2.0 提供程序，所有这些都集成到一个混合模式程序集中。它是原始 sqlite3.dll 的完整替代品（您甚至可以将其重命名为sqlite3.dll)。与普通的混合程序集不同，它不依赖于 .NET 运行时的链接器，因此它可以独立于 .NET 进行分发。”

它甚至支持单声道。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-09-18T15:39:05.630

以下是我能找到的：

*   [托管sqlite](http://code.google.com/p/managed-sqlite/)
*   SQLite.NET 包装器
*   [System.Data.SQLite](http://system.data.sqlite.org/)

资料来源：

*   [sqlite.org](http://www.sqlite.org/cvstrac/wiki?p=SqliteWrappers)
*   其他海报

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-08-07T15:15:10.810

现在还有这个选项：[http](http://code.google.com/p/csharp-sqlite/) ://code.google.com/p/csharp-sqlite/ - SQLite 到 C# 的完整端口。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2011-03-21T08:28:16.217

sqlite.org 的人已经接管了 ADO.NET 提供程序的开发：

从[他们的主页](http://system.data.sqlite.org/index.html/doc/trunk/www/index.wiki)：

> 这是用于 SQLite 的流行 ADO.NET 4.0 适配器的一个分支，称为 System.Data.SQLite。System.Data.SQLite 的创始人罗伯特·辛普森（Robert Simpson）知道这个分叉，并表示同意，并在新的 Fossil 存储库上拥有提交权限。SQLite 开发团队打算继续维护 System.Data.SQLite。
> 
> 历史版本以及原始支持论坛仍可在 [http://sqlite.phxsoftware.com](http://sqlite.phxsoftware.com)上找到，尽管自 2010 年 4 月以来此版本没有更新。

完整的功能列表可以[在他们的 wiki 上](http://system.data.sqlite.org/index.html/doc/trunk/www/features.wiki)找到。亮点包括

*   ADO.NET 2.0 支持
*   完整的实体框架支持
*   完全单声道支持
*   Visual Studio 2005/2008 设计时支持
*   紧凑的框架，C/C++ 支持

已发布的 DLL 可以直接从[该站点](http://system.data.sqlite.org/index.html/doc/trunk/www/downloads.wiki)下载。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-25T14:06:14.127

我肯定会选择**System.Data.SQLite**（如前所述：[http](http://sqlite.phxsoftware.com/) ://sqlite.phxsoftware.com/ ）

它与 ADO.NET (System.Data.*) 一致，并被编译为单个 DLL。没有 sqlite3.dll - 因为 SQLite 的 C 代码嵌入在 System.Data.SQLite.dll 中。一点托管的 C++ 魔法。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-10-24T01:14:30.843

[sqlite-net](https://github.com/praeclarum/sqlite-net)是一个开源的最小库，允许 .NET 和 Mono 应用程序将数据存储在[SQLite 3 数据库](http://www.sqlite.org)中。更多信息请[参见 wiki 页面](https://github.com/praeclarum/sqlite-net/wiki)。

它是用 C# 编写的，旨在与您的项目一起简单地编译。它最初是为在 iPhone 上与 MonoTouch 一起工作而设计的，但已经成长为可以在所有平台上工作（Mono for Android、.NET、Silverlight、WP7、WinRT、Azure 等）。

它以[Nuget 包](http://www.nuget.org/packages?q=sqlite)的形式提供，截至 2014年，它是第二大最受欢迎的 SQLite 包，下载量超过 60,000。

sqlite-net 被设计为一个快速方便的数据库层。它的设计遵循以下目标：

*   很容易与现有项目和 MonoTouch 项目集成。
*   SQLite 上的瘦包装器，应该快速高效。（库不应成为查询的性能瓶颈。）
*   用于安全执行 CRUD 操作和查询（使用参数）并以强类型方式检索这些查询结果的非常简单的方法。
*   与您的数据模型一起工作，而不会强迫您更改您的类。（包含一个小的反射驱动 ORM 层。）
*   除了 sqlite2 库的编译形式之外，还有 0 个依赖项。

非目标包括：

*   **不是**ADO.NET 实现。这不是一个完整的 SQLite 驱动程序。如果需要，请使用 System.Data.SQLite。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-07-25T22:34:39.940

Mono 带有一个包装器。[https://github.com/mono/mono/tree/master/mcs/class/Mono.Data.Sqlite/Mono.Data.Sqlite_2.0](https://github.com/mono/mono/tree/master/mcs/class/Mono.Data.Sqlite/Mono.Data.Sqlite_2.0)提供了包装实际 SQLite dll 的代码（[http://www.sqlite. org/sqlite-shell-win32-x86-3071300.zip](http://www.sqlite.org/sqlite-shell-win32-x86-3071300.zip)以 .net 友好的方式在下载页面[http://www.sqlite.org/download.html/上找到。](http://www.sqlite.org/download.html/)它适用于 Linux 或 Windows。

这似乎是所有世界中最薄的，最大限度地减少了您对第三方库的依赖。如果我必须从头开始做这个项目，我会这样做。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-04-25T00:48:04.563

# Microsoft.Data.Sqlite

Microsoft 现在提供**Microsoft.Data.Sqlite**作为 .NET 的第一方 SQLite 解决方案，它作为 ASP.NET Core 的一部分提供。许可证是[Apache 许可证，版本 2.0](http://www.apache.org/licenses/LICENSE-2.0)。

*   [NuGet 包](https://www.nuget.org/packages/Microsoft.Data.SQLite/)
*   [GitHub 上的源代码库](https://github.com/aspnet/Microsoft.Data.Sqlite)

**免责声明：我自己还没有真正尝试过使用它，但是这里的 Microsoft Docs 上提供了一些文档，[用于](https://docs.microsoft.com/en-us/ef/core/providers/sqlite/)将它与 .NET Core 和 UWP 一起使用。*

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-02-25T07:56:53.023

对于像我这样不需要或不想要 ADO.NET 的人，那些需要运行更接近 SQLite 的代码，但仍兼容`netstandard`（.net 框架、.net 核心等）的人，我构建了一个100% 免费的开源项目**SQLNado**（代表“Not ADO”）在 github 上可用：

[https://github.com/smourier/SQLNado](https://github.com/smourier/SQLNado)

[它在https://www.nuget.org/packages/SqlNado](https://www.nuget.org/packages/SqlNado)作为 nuget 提供，但也作为单个 .cs 文件提供，因此在任何 C# 项目类型中使用都非常实用。

它在使用 SQL 命令时支持所有 SQLite 功能，并且还通过 .NET 支持大多数 SQLite 功能：

*   自动类到表映射（Save、Delete、Load、LoadAll、LoadByPrimaryKey、LoadByForeignKey 等）
*   在类和现有表之间自动同步模式（表、列）
*   专为线程安全操作而设计
*   支持 Where 和 OrderBy LINQ/IQueryable .NET 表达式（该领域的工作仍在进行中），还支持排序规则
*   暴露给 .NET 的 SQLite 数据库架构（表、列等）
*   SQLite 自定义函数可以用 .NET 编写
*   SQLite 增量 BLOB I/O 公开为 .NET Stream 以避免高内存消耗
*   SQLite 排序规则支持，包括使用 .NET 代码添加自定义排序规则的可能性
*   SQLite 扩展 (.dll) 加载支持
*   SQLite 全文搜索引擎 (FTS3) 支持，包括使用 .NET 代码添加自定义 FTS3 标记器的可能性（例如本地化停用词）。我不相信任何其他 .NET 包装器会这样做。
*   自动支持 Windows 'winsqlite3.dll'（仅在最近的 Windows 版本上）以**避免传送任何二进制依赖**文件。这也适用于 Azure Web 应用程序！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-08T10:58:27.243

Monotouch 1.2 版包括对 System.Data 的支持。您可以在此处找到更多详细信息：http: [//monotouch.net/Documentation/System.Data](http://monotouch.net/Documentation/System.Data)

但基本上它允许您将通常的 ADO .NET 模式与 sqlite 一起使用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-12-17T11:19:24.750

[http://www.devart.com/dotconnect/sqlite/](http://www.devart.com/dotconnect/sqlite/)

dotConnect for SQLite 是 SQLite 的增强型数据提供程序，它建立在 ADO.NET 技术之上，为开发基于 SQLite 的数据库应用程序提供完整的解决方案。作为 Devart 数据库应用程序开发框架的一部分，dotConnect for SQLite 提供了与 SQLite 数据库的高性能本机连接以及许多创新的开发工具和技术。

dotConnect for SQLite 引入了设计应用程序架构的新方法，提高了生产力，并利用了数据库应用程序实施。

我用的是标准版，效果很好：）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-01-24T20:33:08.830

sqlite 库提供的函数的准系统包装器。最新版本支持sqlite库3.7.10提供的功能

[SQLiteWrapper 项目](http://sourceforge.net/projects/sqlitewrap/)

# java - 在 Java 中去除无效的 XML 字符

> ID：93655
> 
> 赞同：29
> 
> 时间：2008-09-18T15:36:56.290
> 
> 标签：java, xml

我有一个 XML 文件，它是数据库的输出。我正在使用 Java SAX 解析器来解析 XML 并以不同的格式输出它。XML 包含一些无效字符，解析器抛出错误，例如“无效的 Unicode 字符 (0x5)”

除了逐行预处理文件并替换它们之外，有没有一种很好的方法可以去除所有这些字符？到目前为止，我遇到了 3 个不同的无效字符（0x5、0x6 和 0x7）。这是一个约 4gb 的数据库转储，我们将对其进行多次处理，因此每次我们获得新的转储以在其上运行预处理器时都必须额外等待 30 分钟，这将是一件痛苦的事情，这不是我第一次遇到这个问题。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-03-09T14:04:11.257

我使用了 Xalan`org.apache.xml.utils.XMLChar`类：

```
public static String stripInvalidXmlCharacters(String input) {
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < input.length(); i++) {
        char c = input.charAt(i);
        if (XMLChar.isValid(c)) {
            sb.append(c);
        }
    }

    return sb.toString();
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-18T16:00:43.503

我没有亲自使用过，但是 Atlassian 制作了一个命令行 XML 清理器，它可能适合您的需求（它主要是为 JIRA 制作的，但 XML 是 XML）：

> 下载[atlassian-xml-cleaner-0.1.jar](http://repository.atlassian.com/atlassian-xml-cleaner/jars/atlassian-xml-cleaner-0.1.jar)
> 
> 打开一个 DOS 控制台或 shell，并在您的计算机上找到 XML 或 ZIP 备份文件，这里假定名为 data.xml
> 
> 运行：java -jar atlassian-xml-cleaner-0.1.jar data.xml > data-clean.xml
> 
> 这会将 data.xml 的副本写入 data-clean.xml，并删除无效字符。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-10-11T13:32:55.967

我使用以下似乎对 JDK6 可以正常工作的正则表达式：

```
Pattern INVALID_XML_CHARS = Pattern.compile("[^\\u0009\\u000A\\u000D\\u0020-\\uD7FF\\uE000-\\uFFFD\uD800\uDC00-\uDBFF\uDFFF]");
...
INVALID_XML_CHARS.matcher(stringToCleanup).replaceAll(""); 
```

在 JDK7 中，可以使用`\x{10000}-\x{10FFFF}`BMP 之外的最后一个范围的`\uD800\uDC00-\uDBFF\uDFFF`表示法，而不是不那么容易理解的表示法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-11-15T06:23:08.410

在将澳大利亚出口关税的内容解析为 XML 文档时，我遇到了类似的问题。我不能使用此处建议的解决方案，例如： - 使用从命令行调用的外部工具（jar）。- 要求澳大利亚海关清理源文件。

目前解决这个问题的唯一方法是逐个字符地遍历源文件的整个内容，并测试每个字符是否不属于 0x00 到 0x1F 的 ascii 范围。可以做到，但我想知道是否有更好的方法将 Java 方法用于 String 类型。

编辑我找到了一个可能对其他人有用的解决方案：使用 Java 方法 String#ReplaceAll 替换或删除 XML 文档中的任何不需要的字符。

示例代码（我删除了一些必要的语句以避免混乱）：

```
BufferedReader reader = null;
...
String line = reader.readLine().replaceAll("[\\x00-\\x1F]", ""); 
```

在此示例中，我删除（即替换为空字符串）范围为 0x00 到 0x1F （含）的不可打印字符。您可以更改方法#replaceAll() 中的第二个参数，以将字符替换为您的应用程序所需的字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T16:03:40.047

是否有可能您的无效字符仅存在于值中而不是标签本身，即 XML 理论上符合架构但值没有被正确清理？如果是这样，那么重写 InputStream 以创建一个 CleansingInputStream 用它们的 XML 等效字符替换您的无效字符呢？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T16:05:11.527

您的问题与 XML 无关：它与字符编码有关。归根结底，每个字符串，无论是 XML 还是其他字符串，都由字节组成，并且您无法知道这些字节代表什么字符，除非您被告知该字符串具有什么字符编码。例如，如果供应商告诉你它是 UTF-8 而实际上是别的东西，你肯定会遇到问题。在最好的情况下，一切正常，但有些字节被翻译成“错误”的字符。在最坏的情况下，您会遇到与您遇到的错误类似的错误。

实际上，您的问题更糟：您的字符串包含不代表任何字符编码中的字符的字节序列。没有文本处理工具可以帮助您，更不用说 XML 解析器了。这需要字节级的清理。

# javascript - 我可以在 asp.net MVC 中实现的任何 Yahoo YUI 验证框架？

> ID：93664
> 
> 赞同：3
> 
> 时间：2008-09-18T15:37:36.083
> 
> 标签：javascript, asp.net-mvc, model-view-controller, validation, yui

有人看过我可以在 asp.net MVC 中实现的[Yahoo YUI](https://yuilibrary.com/)验证框架吗？我看过一个[jQuery](https://jquery.com/)，但我想和 YUI 一起工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T18:44:12.750

It's not quite as spiffy (IMO) as jQuery, but here's a [yazaar validation framework](http://yazaar.org/examples/extras/jc21/validate.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T20:43:13.090

值得注意的是，微软已经宣布他们将与 Visual Studio 一起发布[JQuery](https://jquery.com/)，并且将与 MVC 框架进行更多的集成。这可能会也可能不会影响您使用[YUI](https://yuilibrary.com/)的决定。

更多细节在这里：

[http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T01:49:13.530

我最近发现[了 indputEx](http://javascript.neyric.com/inputex/)。希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T01:49:59.097

你可以试试谷歌代码上的[yui-form-validator ......](http://code.google.com/p/yui-form-validator/)

它看起来很有希望满足您的需求。

# 7zip - 7-Zip 命令行开关

> ID：93672
> 
> 赞同：6
> 
> 时间：2008-09-18T15:38:26.380
> 
> 标签：7zip

是否有一个 7-Zip 命令行开关可以防止文件名在添加到存档时回显到屏幕上？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T15:42:34.217

Not built in, but if you add

```
<7z command here> 2>&1 NUL 
```

to the end of your command-line, it will redirect all the output into the null device and stops it echoing to the screen. This is the MS-DOS equivalent of

```
2>&1 /dev/null 
```

in Linux and Unix systems.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-20T18:01:56.640

7-Zip 对此没有开关。如果您使用 PowerShell 调用 7-Zip，您可以使用`Out-Null`. 例如，

```
C:\PS>my-create-7zip-function | out-null 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T15:41:17.027

If it doesn't have one, you can still redirect the output using `>` into a file, then deleting the file afterwards. If you are on *nix, you can redirect into `/dev/null`.

## Edit

In MS-DOS and `cmd.exe` you can redirect into NUL, instead of a file. Thanks to [agnul](https://stackoverflow.com/users/6069/agnul) for this hint.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T15:43:04.090

AFAIK, there is not a switch for that, but you could hide the output redirecting it to a file, for example (DOS batch):

```
7z.exe ... normal parameters > DumpFile.txt 
```

This way all the output ends in DumpFile.txt and not on the screen.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T04:25:58.080

为避免文件名在屏幕上回显并仅显示确认信息，请执行以下操作：

```
...\right_path\7z a output.zip folder_to_be_compressed | findstr /b /r /c:"\<Everything is Ok" /c:"\<Scanning" /c:"\<Creating archive" 
```

# javascript - 你会在你的应用程序中嵌入哪个 Javascript 引擎？

> ID：93692
> 
> 赞同：64
> 
> 时间：2008-09-18T15:40:08.077
> 
> 标签：javascript, c++, embed

我想将 Javascript 嵌入到我的爱好游戏引擎中。现在我们已经推出了第 5 代 Javascript 引擎（速度非常快），我很好奇您会选择在 C++ 框架中嵌入什么引擎（包括嵌入它的实际易用性）？

^(*注意：为了清楚起见，我对 DOM 脚本或在浏览器中编写 Javascript 不感兴趣。*)

这是迄今为止的链接汇编和线程中的一些提示

*   [蜘蛛猴](http://www.mozilla.org/js/spidermonkey/)
*   [tracemonkey](http://wiki.mozilla.org/JavaScript:TraceMonkey)（注意：向后兼容蜘蛛猴）：
*   [V8](http://code.google.com/p/v8/)
*   [松鼠鱼](http://trac.webkit.org/wiki/SquirrelFish)

只是为了记录，我喜欢 Lua 并且已经在游戏引擎中嵌入了大约 5 次。

然而现在这是一个业余项目，我认为大多数 Web 开发人员都知道 Javascript，因为它的 ECMA、Flash 和 Flex 开发人员，一个使用 Javascript 和 XML 编写脚本的游戏引擎会更加用户友好，并迎合更大的用户需求。用户群（到目前为止还没有机会将他们的技能用于游戏的用户群）比使用 Lua 的用户群（周围有很多这样的人！）。

另外为了记录，我将在这个上使用 V8，主要是因为我喜欢它的 C++ 风格。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-10T04:17:14.297

我已经尝试过 SpiderMonkey 和 V8。有了 SpiderMonkey，我什么都做不了。我什至无法编译 mozilla.org 上的示例。

V8 开箱即用，我很快就获得了一些基本的 C++ <-> Javascript 交互。有一些使用 V8 的人的谷歌列表，我发现我的大部分问题已经在那里得到了解答。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-18T15:41:22.037

[Mozilla 的 SpiderMonkey](https://developer.mozilla.org/en-US/docs/Mozilla/Projects/SpiderMonkey)相当简单且文档齐全。它是一个 C API，但用 C++ 包装它很简单。它可以编译为线程安全的，这对游戏很有用，因为您可能希望将主逻辑放在一个线程中，将用户界面逻辑放在第二个线程中。

[Google 的 V8](http://code.google.com/p/v8/)可能是一个不错的选择，因为您使用的是 C++，但我还没有这方面的经验。根据[文档](http://code.google.com/p/v8/source/browse/trunk/include/v8.h)（感谢[Daniel James](https://stackoverflow.com/questions/93692/which-javascript-engine-would-you-embed-in-an-application#97195)），V8 不是线程安全的，尽管将来可能会改变。

还有[WebKit 的 SquirrelFish](http://trac.webkit.org/wiki/SquirrelFish)，但我之前看的时候找不到它的独立版本。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-18T17:26:14.263

Java Script 真的是适合您游戏的语言吗？许多游戏都使用[Lua](http://www.lua.org/)编程语言编写脚本。它易于集成，体积非常小，几乎可以在每个平台上编译，而且易于学习。

这有点离题，但跳出框框思考对于正确处理事情可能很重要。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-18T21:29:55.957

我相信 v8 目前仅适用于 x86、x64 和 arm 处理器。这可能是一个缺点。

关于线程安全，来自[include/v8.h](http://code.google.com/p/v8/source/browse/trunk/include/v8.h)：

```
 * Multiple threads in V8 are allowed, but only one thread at a time
 * is allowed to use V8\.  The definition of 'using V8' includes
 * accessing handles or holding onto object pointers obtained from V8
 * handles.  It is up to the user of V8 to ensure (perhaps with
 * locking) that this constraint is not violated. 
```

您可以在源文件中阅读更多内容（它看起来像 doxygen 文档，但他们似乎没有将它放在任何地方）。

**更新：**该评论已被删除，可能是一段时间前。看起来 v8 现在有一个`Isolate`代表引擎实例的对象。单个`Isolate`实例一次只能在单个线程中使用，但其他`Isolate`实例可以同时在其他线程中使用。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-11-30T05:21:30.637

当谈到脚本引擎和 c++ 时，您还可以考虑[chaiscript](http://www.chaiscript.com)。它接近 ecma 脚本（~Javascript）并且很容易嵌入到 c++ 中。

来自网页的卖家：

> ...另一方面，ChaiScript 的设计从一开始就考虑到了与 C++ 的集成。... ChaiScript 没有元编译器，没有库依赖项，没有构建系统要求，也没有任何类型的遗留包袱。At 可以与您向其公开的任何 C++ 函数无缝协作。它不必明确告知任何类型，它是以功能为中心的。
> 
> 使用 ChaiScript，您可以通过将三行代码添加到程序中来开始编写应用程序脚本，而根本不需要修改构建步骤。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-19T02:30:00.620

当 V8 首次出现时出现的[基准](http://news.cnet.com/8301-1001_3-10030888-92.html)显示 V8 比其他引擎快 1000%（或其他），这在很大程度上偏向于支持擅长递归的引擎。如果您的代码使用大量递归，那么 V8 可能会在速度方面为您提供显着优势。对于“现实世界”（至少目前）网络内容，SquirrelFish Extreme 目前似乎是毫无疑问的赢家（有关我自己的非正式测试结果，请参阅[我关于该主题的博客文章）。](http://andrew.hedges.name/blog/2008/09/11/v8-neither-all-that-nor-a-bag-of-chips)

正如其他人所指出的，易于集成和文档质量可能胜过纯粹的速度。如果您不发货，这并不意味着杰克！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-18T15:52:13.147

我会等待 TraceMonkey，SpiderMonkey 的下一个进化版本问世。更快更好的设计。（使用从 Adob​​e Flash 捐赠的代码）。

Tracemonkey 以在运行时根据实际使用情况积极优化结构来加快重复动作而自豪，这对于游戏增强来说非常方便。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-07-08T12:02:24.927

尝试 Javascript .NET：

[http://javascriptdotnet.codeplex.com/](http://javascriptdotnet.codeplex.com/)

它实现了谷歌 V8。您可以使用它直接从 .NET 代码编译和运行 Javascript，并提供 CLI 对象以供 Javascript 代码使用。就性能而言，V8 可能是有史以来最好的引擎，它从 Javascript 生成本机代码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T15:57:07.490

您可能还想查看 Google 的[V8](http://code.google.com/p/v8/)。不过，它很新。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T21:43:52.960

我会密切关注 v8，因为它正在尖叫快速的 JavaScript 引擎，我相信随着它的成熟，它会开发跨平台支持。

# javascript - 使用 JQuery 捕获 CTRL+S 的最佳跨浏览器方法？

> ID：93695
> 
> 赞同：172
> 
> 时间：2008-09-18T15:40:23.253
> 
> 标签：javascript, jquery

我的用户希望能够点击`Ctrl`+`S`来保存表单。是否有一种很好的跨浏览器方式来捕获`Ctrl`+`S`组合键并提交我的表单？

应用程序是基于 Drupal 构建的，因此可以使用 jQuery。

* * *

## 回答 #1

> 赞同：266
> 
> 时间：2013-01-06T09:44:24.490

这对我有用（使用 jquery）重载`Ctrl`+ `S`，`Ctrl`+`F`和`Ctrl`+ `G`：

```
$(window).bind('keydown', function(event) {
    if (event.ctrlKey || event.metaKey) {
        switch (String.fromCharCode(event.which).toLowerCase()) {
        case 's':
            event.preventDefault();
            alert('ctrl-s');
            break;
        case 'f':
            event.preventDefault();
            alert('ctrl-f');
            break;
        case 'g':
            event.preventDefault();
            alert('ctrl-g');
            break;
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2008-09-18T15:54:32.940

```
$(window).keypress(function(event) {
    if (!(event.which == 115 && event.ctrlKey) && !(event.which == 19)) return true;
    alert("Ctrl-S pressed");
    event.preventDefault();
    return false;
}); 
```

不同浏览器的键码可能不同，因此您可能需要检查的不仅仅是 115。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2008-09-18T16:03:09.940

您可以使用[快捷方式库](http://www.openjs.com/scripts/events/keyboard_shortcuts/#)来处理浏览器特定的内容。

```
shortcut.add("Ctrl+S",function() {
    alert("Hi there!");
}); 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2013-01-17T18:21:53.673

这个 jQuery 解决方案适用于我在 Chrome 和 Firefox 中的`Ctrl`+`S`和`Cmd`+ `S`。

```
$(document).keydown(function(e) {

    var key = undefined;
    var possible = [ e.key, e.keyIdentifier, e.keyCode, e.which ];

    while (key === undefined && possible.length > 0)
    {
        key = possible.pop();
    }

    if (key && (key == '115' || key == '83' ) && (e.ctrlKey || e.metaKey) && !(e.altKey))
    {
        e.preventDefault();
        alert("Ctrl-s pressed");
        return false;
    }
    return true;
}); 
```

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2012-04-23T00:55:09.770

这个在 Chrome 上为我工作...由于某种原因为我`event.which`返回了一个大写 S（83），不知道为什么（不管大写锁定状态）所以我使用`fromCharCode`并且`toLowerCase`只是为了安全起见

```
$(document).keydown(function(event) {

    //19 for Mac Command+S
    if (!( String.fromCharCode(event.which).toLowerCase() == 's' && event.ctrlKey) && !(event.which == 19)) return true;

    alert("Ctrl-s pressed");

    event.preventDefault();
    return false;
}); 
```

如果有人知道为什么我得到**83**而不是**115**，我会很高兴听到，如果有人在其他浏览器上测试它，我会很高兴听到它是否有效

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-03-20T16:26:00.417

我结合了几个选项来支持 FireFox、IE 和 Chrome。我也更新了它以更好地支持 mac

```
// simply disables save event for chrome
$(window).keypress(function (event) {
    if (!(event.which == 115 && (navigator.platform.match("Mac") ? event.metaKey : event.ctrlKey)) && !(event.which == 19)) return true;
    event.preventDefault();
    return false;
});

// used to process the cmd+s and ctrl+s events
$(document).keydown(function (event) {
     if (event.which == 83 && (navigator.platform.match("Mac") ? event.metaKey : event.ctrlKey)) {
        event.preventDefault();
        save(event);
        return false;
     }
}); 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2017-05-14T16:18:42.030

```
$(document).keydown(function(e) {
    if ((e.key == 's' || e.key == 'S' ) && (e.ctrlKey || e.metaKey))
    {
        e.preventDefault();
        alert("Ctrl-s pressed");
        return false;
    }
    return true;
}); 
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
Try pressing ctrl+s somewhere.
```

这是@AlanBellows 答案的最新版本，替换`which`为`key`. 它也适用于 Chrome 的大写键故障（如果您按`Ctrl`+`S`它发送大写 S 而不是 s）。适用于所有现代浏览器。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-18T17:35:13.087

老实说，我希望 Web 应用程序不要覆盖我的默认快捷键。 `Ctrl`+`S`已经在浏览器中做了一些事情。根据我正在查看的网站突然改变这种情况是破坏性的和令人沮丧的，更不用说经常出现错误了。我有网站劫持`Ctrl`+`Tab`因为它看起来与`Ctrl`+相同`I`，既破坏了我在网站上的工作，又阻止了我像往常一样切换标签。

如果需要快捷键，请使用`accesskey`属性。请不要破坏现有的浏览器功能。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-11-05T17:53:11.943

@Eevee：随着浏览器成为功能越来越丰富的家，并开始取代桌面应用程序，放弃使用键盘快捷键不会成为一种选择。Gmail 丰富而直观的键盘命令集有助于我放弃 Outlook。Todoist、谷歌阅读器和谷歌日历中的键盘快捷键都让我每天的生活变得更加轻松。

开发人员绝对应该小心不要覆盖在浏览器中已经有意义的击键。例如，我正在输入的 WMD 文本框莫名其妙地将`Ctrl`+解释`Del`为“Blockquote”而不是“向前删除单词”。我很好奇网站开发人员是否可以使用“浏览器安全”快捷方式的标准列表，并且浏览器将承诺在未来的版本中远离。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-10T04:08:02.177

我喜欢[这个小插件](http://code.google.com/p/js-hotkeys/)。不过，它需要更多的跨浏览器友好性。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-11-03T07:20:28.237

对艾伦·贝洛斯的回答： !(e.altKey) 为`AltGr`打字时使用的用户添加（例如波兰）。没有这个按`AltGr`+将给出与+`S`相同的结果`Ctrl``S`

```
$(document).keydown(function(e) {
if ((e.which == '115' || e.which == '83' ) && (e.ctrlKey || e.metaKey) && !(e.altKey))
{
    e.preventDefault();
    alert("Ctrl-s pressed");
    return false;
}
return true; }); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-07-29T19:36:26.620

例子：

```
shortcut.add("Ctrl+c",function() {
    alert('Ok...');
}
,{
    'type':'keydown',
    'propagate':false,
    'target':document
}); 
```

用法

```
<script type="text/javascript" src="js/shortcut.js"></script> 
```

下载链接：[http ://www.openjs.com/scripts/events/keyboard_shortcuts/#](http://www.openjs.com/scripts/events/keyboard_shortcuts/#)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-01-06T15:21:52.113

这应该有效（改编自[https://stackoverflow.com/a/8285722/388902](https://stackoverflow.com/a/8285722/388902)）。

```
var ctrl_down = false;
var ctrl_key = 17;
var s_key = 83;

$(document).keydown(function(e) {
    if (e.keyCode == ctrl_key) ctrl_down = true;
}).keyup(function(e) {
    if (e.keyCode == ctrl_key) ctrl_down = false;
});

$(document).keydown(function(e) {
    if (ctrl_down && (e.keyCode == s_key)) {
        alert('Ctrl-s pressed');
        // Your code
        return false;
    }
}); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-07-01T00:05:25.960

**我在IE**上解决了我的问题，使用`alert("With a message")`防止默认行为：

```
window.addEventListener("keydown", function (e) {
    if(e.ctrlKey || e.metaKey){
        e.preventDefault(); //Good browsers
        if (navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') > 0) { //hack for ie
            alert("Please, use the print button located on the top bar");
            return;
        }
    }
}); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-07-07T14:44:27.470

我制作的这个插件可能会有所帮助。

[插入](https://codepen.io/dhruvsinghal/pen/ZyjMJQ?editors=0011)

您可以使用此插件，您必须提供要像这样运行的关键代码和功能

```
simulatorControl([17,83], function(){
 console.log('You have pressed Ctrl+Z');
}); 
```

在代码中，我展示了如何执行 for `Ctrl`+ `S`。您将在链接上获得详细文档。插件位于 Codepen 上我的笔的 JavaScript 代码部分。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-03-13T13:57:17.240

这是我的解决方案，它比这里的其他建议更容易阅读，可以轻松包含其他组合键，并且已经在 IE、Chrome 和 Firefox 上进行了测试：

```
$(window).keydown(function(evt) {
  var key = String.fromCharCode(evt.keyCode).toLowerCase();
  switch(key) {
    case "s":
      if(evt.ctrlKey || evt.metaKey) {
        fnToRun();
        evt.preventDefault(true);
        return false;
      }
      break;
  }
  return true;
}); 
```

# .net - PHP var_dump 的 .NET 等价物是什么？

> ID：93699
> 
> 赞同：15
> 
> 时间：2008-09-18T15:40:47.327
> 
> 标签：.net, reflection

我记得不久前看到反射命名空间中可能有一些方法可以递归地`ToString()`在对象的所有属性上运行并很好地格式化它以供显示。

是的，我知道我想要的一切都可以通过调试器访问，但我想知道是否有人知道该命令？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T15:54:49.290

我认为您正在寻找的是/被称为 ObjectDumper。它使用反射来迭代并输出对象的所有不同属性。我是在学习 LINQ 时第一次听说它的，Linq in Action 一书中的大多数示例都使用它。

虽然微软似乎没有将它包含在 Linq 的最终版本中，但代码仍然存在。我做了一个快速的谷歌搜索，这里有一个链接：

[ObjectDumper 源代码](http://objectdumper.codeplex.com/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T15:50:05.447

可以在此处找到转储对象及其属性的示例代码：

[http://www.developer.com/net/csharp/article.php/3713886](http://www.developer.com/net/csharp/article.php/3713886)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-12-08T06:47:52.993

你可以自己写。例如，使用 Newtonsoft 的 JSON.net 库将其序列化为 json 并将该 json 写入控制台。这是一个例子：

```
using Newtonsoft.Json;

static class Pretty
{
    public static void Print<T> (T x)
    {
        string json = JsonConvert.SerializeObject(x, Formatting.Indented);
        Console.WriteLine(json);
    }
} 
```

用法：

```
Pretty.Print(whatever); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T15:47:58.790

我当然可以看到这种东西的用途，但是在 .Net 中，您不会大多只是获得类型名称（字符串、数组等）的列表吗？大多数内置插件都没有预先编写“有用的” ToString() 重载，是吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T16:48:34.667

这是一个包含代码转储程序的链接和一个演示项目，向您展示如何使用它。[在这里下载](http://www.codeguru.com/csharp/csharp/cs_syntax/reflection/article.php/c5885)。

# cluster-analysis - 如何可视化用户集群？

> ID：93705
> 
> 赞同：3
> 
> 时间：2008-09-18T15:41:25.593
> 
> 标签：cluster-analysis, data-visualization

我有一个用户相互交互的应用程序。我想可视化这些交互，以便确定是否存在用户集群（其中交互更频繁）。

我为每个用户分配了一个 2D 点（每个坐标都在 0 和 1 之间）。我的想法是，两个用户的点在交互时会靠得更近，这是一种“吸引力”，我只是一遍又一遍地浏览我的交互日志。

当然，我需要一种“排斥力”来将用户也分开，否则他们将全部坍塌成一个点。

首先，我尝试监控每个 XY 坐标的最低和最高，并将它们的位置归一化，但这没有奏效，少数交互次数很少的用户停留在边缘，其余的都崩溃到中间。

有谁知道我应该使用什么方程来移动这些点，既可以用于用户交互时的“吸引力”，也可以使用“排斥”力来阻止它们全部坍缩成一个点？

编辑：在回答一个问题时，我应该指出我正在处理大约 100 万用户，以及大约 1000 万用户之间的交互。如果有人可以推荐一个可以为我做到这一点的工具，我会全力以赴:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T05:17:47.000

过去，当我尝试过这种事情时，我使用弹簧模型将链接的节点拉到一起，例如：`dx = -k*(x-l)`. `dx`是位置的变化，`x`是当前位置，`l`是所需的分离，`k`是你调整的弹簧系数，直到你在弹簧强度和稳定性之间取得很好的平衡，它会小于 0.1。`l > 0`确保一切都不会在中间结束。

In addition to that, a general "repulsive" force between all nodes will spread them out, something like: `dx = k / x^2`. This will be larger the closer two nodes are, tweak `k` to get a reasonable effect.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T15:53:42.693

我可以推荐一些可能性：首先，尝试对交互进行对数缩放或通过 sigmoidal 函数运行它们以压缩范围。这将为您提供更平滑的间距视觉分布。

独立于这个缩放问题：看看 graphviz 中的一些渲染策略，特别是“neato”和“fdp”程序。从手册页：

> ```
>  neato  draws  undirected graphs using ``spring'' models (see Kamada and
>   Kawai, Information Processing Letters 31:1, April 1989).   Input files
>   must  be  formatted  in the dot attributed graph language.  By default,
>   the output  of  neato  is  the  input  graph  with  layout coordinates
>   appended.
> 
>   fdp  draws  undirected  graphs using a ``spring'' model. It relies on a
>   force-directed approach in the spirit of Fruchterman and Reingold  (cf.
>   Software-Practice & Experience 21(11), 1991, pp. 1129-1164). 
> ```

最后，考虑一种缩放策略、吸引力和某种阻力系数而不是排斥力。实际上，将事物移近*，*然后可能再移远，可能只会让您产生循环行为。

考虑一个模型，在这个模型中，一切最终*都会*崩溃，但速度很慢。然后运行直到满足某些条件（一个节点穿过布局区域的中心或类似的）。

阻力或动量可以被编码为对运动的基本阻力，并相当于限制运动；它可以被不同地应用（事情可以根据它们走了多远，它们在空间中的位置，有多少其他节点靠近等等）。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T17:11:16.460

The spring model is the traditional way to do this: make an attractive force between each node based on the interaction, and a repulsive force between all nodes based on the inverse square of their distance. Then solve, minimizing the energy. You may need some fairly high powered programming to get an efficient solution to this if you have more than a few nodes. Make sure the start positions are random, and run the program several times: a case like this almost always has several local energy minima in it, and you want to make sure you've got a good one.

Also, unless you have only a few nodes, I would do this in 3D. An extra dimension of freedom allows for better solutions, and you should be able to visualize clusters in 3D as well if not better than 2D.

# asp.net - 如何禁用浏览器回发警告对话框

> ID：93708
> 
> 赞同：1
> 
> 时间：2008-09-18T15:42:10.537
> 
> 标签：asp.net, javascript, internet-explorer-7

我有一个专门在 IE7（内部网站）上运行的 asp.net 应用程序。

当用户需要输入数据时，我会弹出一个带有表单的子窗口。当表单关闭时，它会调用 javascript:window.opener.location.reload(true) 以便新数据将显示在主页上。

问题是浏览器抱怨它必须重新发布页面。有什么办法可以关闭这个功能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T15:47:14.237

不，但有一个解决方案。在有人将数据发布到页面后立即使用 302 重定向通常被认为是很好的设计。这可以防止该弹出窗口发生。请允许我详细说明。

1）用户填写表单并通过POST提交数据。

2）后端接收数据并对其进行操作。

3) 后端不会将内容返回给用户，而是在处理完页面后立即发出 302 重定向（如果需要，可能会将用户重定向回完全相同的 url）

4) 用户将看到的页面是您告诉他们的浏览器重定向到的页面。他们将使用标准 GET 请求加载重定向页面。如果他们尝试刷新页面，它将不会重新发布数据。问题解决了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T15:45:32.913

这是 ASP.NET 通常的“回发”方式的问题。如果您需要在没有此警告的情况下重新加载页面，则该页面必须来自 GET，而不是 POST。你可以自己做一个 Response.Redirect("...") 。但这会破坏视图状态的使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T15:46:12.163

asp.net mvc 修复了这个问题，这不仅仅是 ie7 的问题，而是大多数浏览器的安全功能。除了您可以使用 js 更新主表单中的内容而不是重新加载整个页面之外，我所知道的没有修复

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T15:46:29.933

我不相信有办法做到这一点。相反，为什么不将父窗口定向到页面而不重新加载。

javascript:window.opener.location='你的网址'

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T15:47:03.970

这是因为 window.opener 中的页面来自 POST 请求 也许你可以使用 javascript:window.opener.location = window.opener.location; 如果可以在没有 POST 的情况下获取数据，则只执行 GET 请求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T15:51:19.797

AFAIK，而不是通过您的脚本。

你可以试试：

```
window.opener.location = '#'; 
```

它应该绕过浏览器重新发布。并且，您可以根据需要调整哈希名称。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-03T05:35:05.500

如果您从 page1 移动到 page2，并且想要禁用浏览器返回到 page 1，则在 page1 的顶部添加以下内容。

```
<script>
if(window.history.forward(1) != null)
                 window.history.forward(1);
</script> 
```

# python - 从 Python 输出 XML 的最简单的非内存密集型方法是什么？

> ID：93710
> 
> 赞同：16
> 
> 时间：2008-09-18T15:42:19.163
> 
> 标签：python, xml, streaming

基本上，类似于 System.Xml.XmlWriter - 一种不会产生太多内存开销的流式 XML 编写器。这样就排除了 xml.dom 和 xml.dom.minidom。建议？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-18T16:22:28.067

我想你会发现 xml.sax.saxutils 中的 XMLGenerator 是最接近你想要的东西。

```
进口时间
从 xml.sax.saxutils 导入 XMLGenerator
从 xml.sax.xmlreader 导入 AttributesNSImpl

LOG_LEVELS = ['调试'，'警告'，'错误']

类 xml_logger：
    def __init__（自我，输出，编码）：
        """
        设置一个记录器对象，它接受 SAX 事件和输出
        XML 日志文件
        """
        logger = XMLGenerator（输出，编码）
        logger.startDocument()
        attrs = AttributesNSImpl({}, {})
        logger.startElementNS((None, u'log'), u'log', attrs)
        self._logger = 记录器
        self._output = 输出
        self._encoding = 编码
        返回

    def write_entry(self, level, msg):
        """
        将日志条目写入记录器
        level - 条目的级别
        msg - 条目的文本。必须是 Unicode 对象
        """
        #注意：在实际应用中，我会使用 ISO 8601 作为日期
        为简单起见，此处使用 #asctime
        现在 = time.asctime(time.localtime())
        attr_vals = {
            （无，你的日期'）：现在，
            （无，u'level'）：LOG_LEVELS[level]，
            }
        attr_qnames = {
            (无, u'date'): u'date',
            (无, u'level'): u'level',
            }
        attrs = AttributesNSImpl(attr_vals, attr_qnames)
        self._logger.startElementNS((None, u'entry'), u'entry', attrs)
        self._logger.characters（味精）
        self._logger.endElementNS((None, u'entry'), u'entry')
        返回

    def 关闭（自我）：
        """
        清理记录器对象
        """
        self._logger.endElementNS((None, u'log'), u'log')
        self._logger.endDocument()
        返回

如果 __name__ == "__main__":
    #测试一下
    导入系统
    xl = xml_logger(sys.stdout, 'utf-8')
    xl.write_entry(2, u"原版日志条目")
    xl.close()   

```

您可能想查看我从[http://www.xml.com/pub/a/2003/03/12/py-xml.html](http://www.xml.com/pub/a/2003/03/12/py-xml.html)获得的文章的其余部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T15:54:07.933

我想我有你的毒药：

[http://sourceforge.net/projects/xmlite](http://sourceforge.net/projects/xmlite)

干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T16:08:21.720

几年前我`MarkupWriter`从[4suite使用过](http://4suite.org/index.xhtml)

> ```
> General-purpose utility class for generating XML (may eventually be
> expanded to produce more output types)
> 
> Sample usage:
> 
> from Ft.Xml import MarkupWriter
> writer = MarkupWriter(indent=u"yes")
> writer.startDocument()
> writer.startElement(u'xsa')
> writer.startElement(u'vendor')
> #Element with simple text (#PCDATA) content
> writer.simpleElement(u'name', content=u'Centigrade systems')
> #Note writer.text(content) still works
> writer.simpleElement(u'email', content=u"info@centigrade.bogus")
> writer.endElement(u'vendor')
> #Element with an attribute
> writer.startElement(u'product', attributes={u'id': u"100\u00B0"})
> #Note writer.attribute(name, value, namespace=None) still works
> writer.simpleElement(u'name', content=u"100\u00B0 Server")
> #XML fragment
> writer.xmlFragment('<version>1.0</version><last-release>20030401</last-release>')
> #Empty element
> writer.simpleElement(u'changes')
> writer.endElement(u'product')
> writer.endElement(u'xsa')
> writer.endDocument()
> 
> Note on the difference between 4Suite writers and printers
> Writer  - module that exposes a broad public API for building output
>           bit by bit
> Printer - module that simply takes a DOM and creates output from it
>           as a whole, within one API invokation 
> ```

最近我听到很多关于[lxml](http://codespeak.net/lxml/)的伟大之处，但我没有第一手经验，而且我在使用[gnosis](http://freshmeat.net/projects/gnosisxml/)时获得了一些乐趣。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-18T15:57:23.837

我总是用[lxml](http://codespeak.net/lxml/)取得好成绩。安装起来很痛苦，因为它主要是[libxml2](http://xmlsoft.org/)的包装器，但是`lxml.etree` 树对象有一个`.write()`方法可以接收一个类似文件的对象来流式传输。

```
from lxml.etree import XML

tree = XML('<root><a><b/></a></root>')
tree.write(your_file_object) 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-09-18T22:17:07.310

对 ElementTree 的第二次投票（cElementTree 是一个更快的 C 实现，例如 cPickle 与 pickle）。这里有一些简短的示例代码，您可以查看它以了解它是如何工作的：[http](http://effbot.org/zone/element-index.htm) ://effbot.org/zone/element-index.htm （这是 Fredrik Lundh，他首先编写了该模块. 太好了，它被 2.5 起草到标准库中 :-) )

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2008-09-18T15:55:24.780

**xml.etree.cElementTree**，自 2.5 起包含在 CPython 的默认分发中。读取和写入 XML 速度极快。

# c# - 带有调整大小框架但没有标题栏的 Windows 窗体？

> ID：93716
> 
> 赞同：8
> 
> 时间：2008-09-18T15:42:45.917
> 
> 标签：c#, winforms, visual-studio, resize, titlebar

如何从 Windows 窗体中隐藏标题栏但仍有调整大小的框架？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T15:43:22.110

设置 FormBorderStyle = None 将删除标题栏（在设计和运行时） - 并且还会删除您调整表单大小的能力。

如果你需要一个边框，你可以设置：

```
ControlBox = false
Text = "" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T17:08:58.050

将窗体的 ControlBox 属性设置为 False，将 Text 属性设置为空字符串。表单将打开，没有可感知的（用户）标题栏，但他们将能够调整表单的大小。

# interface - UML aggregation when interfaces are used

> ID：93720
> 
> 赞同：1
> 
> 时间：2008-09-18T15:43:13.777
> 
> 标签：interface, uml, aggregate

**How do I represent an aggregation relation between two classes in UML, such that each class has a link to the other class's interface, not the implementing class?**

E.g. I have a class Foo that implements iFoo, and Bar that implements iBar. Foo should have a member variable of type iBar, and Bar should have a member variable of type iFoo.

If I create an aggregation between the two implementing classes, then the member will be of the type of the implementing class, not the superclass. And aggregations between interfaces are invalid in UML (and don't make much sense).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T04:20:10.447

接口不可实例化，因此 Bar 不能具有 iFoo 类型的属性，而 Foo 不能具有 iBar 类型的属性。

你说你不想要 Bar 和 Foo 之间的关联。因此，您可以创建一个新类 (FooEx) 并让该类实现 iFoo。然后 Bar 可以与 FooEx 而不是 Foo 建立关联。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T16:05:49.510

你能不能没有 Foo（实现）聚合 iBar（接口）？在我看来，这似乎是描述这种关系的正确方式。

所以是这样的：

```
-----------------      -----------------
| <<interface>> |      | <<interface>> |
|     iFoo      |<>  <>|     iBar      |
-----------------  \/  -----------------
        ^          /\          ^
        |         /  \         |
-----------------/    \-----------------
|      Foo      |      |      Bar      |
-----------------      ----------------- 
```

# eclipse - How can I import eclipse JDT classes in a project

> ID：93728
> 
> 赞同：4
> 
> 时间：2008-09-18T15:44:23.900
> 
> 标签：eclipse, eclipse-jdt

I want to do the following imports in a class.

```
import org.eclipse.jdt.core.dom.*;  
import org.eclipse.jdt.core.compiler.CharOperation;  
import org.eclipse.jdt.core.compiler.IProblem;  
import org.eclipse.jdt.internal.compiler.ClassFile;  
import org.eclipse.jdt.internal.compiler.CompilationResult;  
import org.eclipse.jdt.internal.compiler.Compiler;    
import org.eclipse.jdt.internal.compiler.DefaultErrorHandlingPolicies;  
import org.eclipse.jdt.internal.compiler.ICompilerRequestor;  
import org.eclipse.jdt.internal.compiler.classfmt.ClassFileReader;  
import org.eclipse.jdt.internal.compiler.classfmt.ClassFormatException;  
import org.eclipse.jdt.internal.compiler.env.ICompilationUnit;  
import org.eclipse.jdt.internal.compiler.env.INameEnvironment;  
import org.eclipse.jdt.internal.compiler.env.NameEnvironmentAnswer;  
import org.eclipse.jdt.internal.compiler.impl.CompilerOptions;  
import org.eclipse.jdt.internal.compiler.problem.DefaultProblemFactory;  
import org.eclipse.jface.text.Document;  
import org.eclipse.jface.text.BadLocationException;  
import org.eclipse.text.edits.TextEdit; 
```

How can I import the JDT within Eclipse? Cheers.

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-18T18:29:41.117

我想我找到了一种更简单的方法来做到这一点：

*   在包资源管理器中右键单击您的项目；
*   选择“构建路径...”；
*   选择“配置构建路径”；
*   选择库选项卡；
*   单击“添加变量...”按钮；
*   在列表框中，选择“ECLIPSE_HOME”条目，然后单击“扩展”按钮；
*   在列表框中，打开“plugins”文件夹条目，向下滚动，然后按住 shift 键单击文件夹*下方*文件列表中的所有 org.eclipse.jdt.* JAR 文件；
*   单击确定，直到您完全退出。

那应该这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T15:53:02.867

Unless I'm misunderstanding you, you just need to include the JDT JAR files on your classpath; they're all available in your Eclipse plugins directory. So for your project, right-click on the project's name in the Package Explorer, go to the Build Path... submenu, and choose Configure Build Path. Then in the Libraries tab, use the "Add External JARs" button to add each of the relevant JAR files from the Eclipse plugins directory.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T00:32:07.767

如果您正在为 Eclipse 编写插件，那么您实际上不应该尝试实例化`internal`包。根据此[API 参与规则](http://www.eclipse.org/articles/article.php?file=Article-API-Use/index.html)

> 坚持使用官方记录的 API。仅参考组件的已发布 API Javadoc 中记录的包。永远不要引用属于另一个名称中包含“内部”的组件的包——这些永远不是 API。永远不要引用没有发布 API Javadoc 的包——这些也不是 API。

对于其他人，将包名称添加到`Import-Package`清单中的条目中。

JDT 中有扩展点，但是如果您想做的事情不在这些范围之内，那么恐怕您就不走运了。

如果您只是想在代码中使用编译器，而不依赖于 JDK（即在 JRE 上），那么我会考虑使用更独立的基于 Java 的 Java 编译器，例如[Janino](http://www.janino.net/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T19:47:51.927

如果您需要这些类，您可能已经在一个插件项目中。您应该能够通过在 Eclipse 抱怨导入的行上应用快速修复“修复项目设置...”(Ctrl+1) 来导入这些类。这会将所需的插件添加到 META-INF 目录中的 MANIFEST.MF 文件（在您的情况下为 org.eclipse.jdt.core 和 org.eclipse.jface.text）。您也可以在 MANIFEST.MF 文件中手动添加它们。如果您的项目不是插件项目（并且您没有 MANIFEST.MF 文件），您可以先右键单击项目 -> PDE 工具 -> 将项目转换为插件项目来转换它。如果您以正常方式（“配置构建路径”）将依赖项添加到插件项目，则类加载在运行时将无法正常工作（尽管它会编译）。

# c# - 在 ASP.Net C# 中获取 Accordian 选定索引

> ID：93743
> 
> 赞同：0
> 
> 时间：2008-09-18T15:46:13.757
> 
> 标签：c#, .net, asp.net, webforms

我正在使用 c# 开发一个 ASP.Net 应用程序。我被手风琴的问题困住了。

我的手风琴正确地显示了来自数据源的数据，在这种情况下是一些文本，然后是图像列表。在每个手风琴内容上都有要显示的图像，然后是添加另一个图像的按钮。

此按钮链接到包含添加表单的另一个页面。从这里我可以添加一张图片，它会将我转发回显示手风琴的页面，并在正确的部分添加一张新图片。

**现在问题是我想重新打开以前打开的部分。**

我尝试了几种不同的方法，但都没有奏效。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-18T16:32:13.787

如果您要重定向到另一个页面，则必须通过查询字符串将当前打开的部分传递给它，然后当新页面将您发送回来时，它会向您发送相同的值，以便您知道要打开哪个.

另一种快速的方法是将其弹出到会话中，然后从该会话中读取。但我会推荐查询字符串路由，它的开销较小。

# c# - Most common C# bitwise operations on enums

> ID：93744
> 
> 赞同：212
> 
> 时间：2008-09-18T15:46:20.073
> 
> 标签：c#, .net, enums, bit-manipulation, flags

For the life of me, I can't remember how to set, delete, toggle or test a bit in a bitfield. Either I'm unsure or I mix them up because I rarely need these. So a "bit-cheat-sheet" would be nice to have.

For example:

```
flags = flags | FlagsEnum.Bit4;  // Set bit 4. 
```

or

```
if ((flags & FlagsEnum.Bit4)) == FlagsEnum.Bit4) // Is there a less verbose way? 
```

Can you give examples of all the other common operations, preferably in C# syntax using a [Flags] enum?

* * *

## 回答 #1

> 赞同：296
> 
> 时间：2009-01-06T16:31:05.010

**我对这些扩展做了更多的工作——[你可以在这里找到代码](http://hugoware.net:4000/blog/enumeration-extensions-2-0)**

我写了一些扩展我经常使用的 System.Enum 的扩展方法......我并不是说它们是防弹的，但它们有帮助......*评论已删除......*

```
namespace Enum.Extensions {

    public static class EnumerationExtensions {

        public static bool Has<T>(this System.Enum type, T value) {
            try {
                return (((int)(object)type & (int)(object)value) == (int)(object)value);
            } 
            catch {
                return false;
            }
        }

        public static bool Is<T>(this System.Enum type, T value) {
            try {
                return (int)(object)type == (int)(object)value;
            }
            catch {
                return false;
            }    
        }

        public static T Add<T>(this System.Enum type, T value) {
            try {
                return (T)(object)(((int)(object)type | (int)(object)value));
            }
            catch(Exception ex) {
                throw new ArgumentException(
                    string.Format(
                        "Could not append value from enumerated type '{0}'.",
                        typeof(T).Name
                        ), ex);
            }    
        }

        public static T Remove<T>(this System.Enum type, T value) {
            try {
                return (T)(object)(((int)(object)type & ~(int)(object)value));
            }
            catch (Exception ex) {
                throw new ArgumentException(
                    string.Format(
                        "Could not remove value from enumerated type '{0}'.",
                        typeof(T).Name
                        ), ex);
            }  
        }

    }
} 
```

然后像下面这样使用它们

```
SomeType value = SomeType.Grapes;
bool isGrapes = value.Is(SomeType.Grapes); //true
bool hasGrapes = value.Has(SomeType.Grapes); //true

value = value.Add(SomeType.Oranges);
value = value.Add(SomeType.Apples);
value = value.Remove(SomeType.Grapes);

bool hasOranges = value.Has(SomeType.Oranges); //true
bool isApples = value.Is(SomeType.Apples); //false
bool hasGrapes = value.Has(SomeType.Grapes); //false 
```

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2011-05-30T17:48:11.910

在 .NET 4 中，您现在可以编写：

```
flags.HasFlag(FlagsEnum.Bit4) 
```

* * *

## 回答 #3

> 赞同：97
> 
> 时间：2008-09-18T15:50:16.257

The idiom is to use the bitwise or-equal operator to set bits:

```
flags |= 0x04; 
```

To clear a bit, the idiom is to use bitwise and with negation:

```
flags &= ~0x04; 
```

Sometimes you have an offset that identifies your bit, and then the idiom is to use these combined with left-shift:

```
flags |= 1 << offset;
flags &= ~(1 << offset); 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2011-08-24T19:51:30.633

@Drew

Note that except in the simplest of cases, the Enum.HasFlag carries a heavy performance penalty in comparison to writing out the code manually. Consider the following code:

```
[Flags]
public enum TestFlags
{
    One = 1,
    Two = 2,
    Three = 4,
    Four = 8,
    Five = 16,
    Six = 32,
    Seven = 64,
    Eight = 128,
    Nine = 256,
    Ten = 512
}

class Program
{
    static void Main(string[] args)
    {
        TestFlags f = TestFlags.Five; /* or any other enum */
        bool result = false;

        Stopwatch s = Stopwatch.StartNew();
        for (int i = 0; i < 10000000; i++)
        {
            result |= f.HasFlag(TestFlags.Three);
        }
        s.Stop();
        Console.WriteLine(s.ElapsedMilliseconds); // *4793 ms*

        s.Restart();
        for (int i = 0; i < 10000000; i++)
        {
            result |= (f & TestFlags.Three) != 0;
        }
        s.Stop();
        Console.WriteLine(s.ElapsedMilliseconds); // *27 ms*        

        Console.ReadLine();
    }
} 
```

Over 10 million iterations, the HasFlags extension method takes a whopping 4793 ms, compared to the 27 ms for the standard bitwise implementation.

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2017-06-14T17:27:58.080

不幸的是，.NET 的内置标志枚举操作非常有限。大多数时候，用户都需要弄清楚按位运算逻辑。

在 .NET 4 中，`HasFlag`添加了`Enum`有助于简化用户代码的方法，但不幸的是它存在许多问题。

1.  `HasFlag`不是类型安全的，因为它接受任何类型的枚举值参数，而不仅仅是给定的枚举类型。
2.  `HasFlag`关于它是否检查值是否具有枚举值参数提供的所有或任何标志是模棱两可的。顺便说一句。
3.  `HasFlag`相当慢，因为它需要装箱，这会导致分配，从而导致更多的垃圾收集。

部分由于 .NET 对标志枚举的有限支持，我编写了 OSS 库[Enums.NET](https://github.com/TylerBrinkley/Enums.NET "枚举.NET")，它解决了这些问题，并使处理标志枚举变得更加容易。

下面是它提供的一些操作以及仅使用 .NET 框架的等效实现。

# 组合标志

**。网**             `flags | otherFlags`

**枚举.NET** `flags.CombineFlags(otherFlags)`

* * *

# 删除标志

**。网**             `flags & ~otherFlags`

**枚举.NET** `flags.RemoveFlags(otherFlags)`

* * *

# 通用标志

**。网**             `flags & otherFlags`

**枚举.NET** `flags.CommonFlags(otherFlags)`

* * *

# 切换标志

**。网**             `flags ^ otherFlags`

**枚举.NET** `flags.ToggleFlags(otherFlags)`

* * *

# 拥有所有标志

**.NET**             `(flags & otherFlags) == otherFlags`或`flags.HasFlag(otherFlags)`

**枚举.NET** `flags.HasAllFlags(otherFlags)`

* * *

# 有任何标志

**。网**             `(flags & otherFlags) != 0`

**枚举.NET** `flags.HasAnyFlags(otherFlags)`

* * *

# 获取标志

**。网**

```
Enumerable.Range(0, 64)
  .Where(bit => ((flags.GetTypeCode() == TypeCode.UInt64 ? (long)(ulong)flags : Convert.ToInt64(flags)) & (1L << bit)) != 0)
  .Select(bit => Enum.ToObject(flags.GetType(), 1L << bit))` 
```

**枚举.NET** `flags.GetFlags()`

* * *

我正在尝试将这些改进整合到 .NET Core 中，甚至可能最终整合到完整的 .NET Framework 中。[你可以在这里](https://github.com/dotnet/corefx/issues/15453 "GitHub/corefx#15453")查看我的建议。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-18T15:57:25.867

C++ 语法，假设位 0 是 LSB，假设标志是无符号长的：

检查是否设置：

```
flags & (1UL << (bit to test# - 1)) 
```

检查是否未设置：

```
invert test !(flag & (...)) 
```

放：

```
flag |= (1UL << (bit to set# - 1)) 
```

清除：

```
flag &= ~(1UL << (bit to clear# - 1)) 
```

切换：

```
flag ^= (1UL << (bit to set# - 1)) 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-03-03T20:19:52.867

为了获得最佳性能和零垃圾，请使用以下命令：

```
using System;
using T = MyNamespace.MyFlags;

namespace MyNamespace
{
    [Flags]
    public enum MyFlags
    {
        None = 0,
        Flag1 = 1,
        Flag2 = 2
    }

    static class MyFlagsEx
    {
        public static bool Has(this T type, T value)
        {
            return (type & value) == value;
        }

        public static bool Is(this T type, T value)
        {
            return type == value;
        }

        public static T Add(this T type, T value)
        {
            return type | value;
        }

        public static T Remove(this T type, T value)
        {
            return type & ~value;
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-03-09T22:09:36.517

这是受到在 Delphi 中使用 Sets 作为索引器的启发，早在以下情况下：

```
/// Example of using a Boolean indexed property
/// to manipulate a [Flags] enum:

public class BindingFlagsIndexer
{
  BindingFlags flags = BindingFlags.Default;

  public BindingFlagsIndexer()
  {
  }

  public BindingFlagsIndexer( BindingFlags value )
  {
     this.flags = value;
  }

  public bool this[BindingFlags index]
  {
    get
    {
      return (this.flags & index) == index;
    }
    set( bool value )
    {
      if( value )
        this.flags |= index;
      else
        this.flags &= ~index;
    }
  }

  public BindingFlags Value 
  {
    get
    { 
      return flags;
    } 
    set( BindingFlags value ) 
    {
      this.flags = value;
    }
  }

  public static implicit operator BindingFlags( BindingFlagsIndexer src )
  {
     return src != null ? src.Value : BindingFlags.Default;
  }

  public static implicit operator BindingFlagsIndexer( BindingFlags src )
  {
     return new BindingFlagsIndexer( src );
  }

}

public static class Class1
{
  public static void Example()
  {
    BindingFlagsIndexer myFlags = new BindingFlagsIndexer();

    // Sets the flag(s) passed as the indexer:

    myFlags[BindingFlags.ExactBinding] = true;

    // Indexer can specify multiple flags at once:

    myFlags[BindingFlags.Instance | BindingFlags.Static] = true;

    // Get boolean indicating if specified flag(s) are set:

    bool flatten = myFlags[BindingFlags.FlattenHierarchy];

    // use | to test if multiple flags are set:

    bool isProtected = ! myFlags[BindingFlags.Public | BindingFlags.NonPublic];

  }
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-18T16:00:01.803

要测试一下，您将执行以下操作：（假设标志是 32 位数字）

测试位：

```
if((flags & 0x08) == 0x08)
```

（如果设置了第 4 位，则为真）切换回（1 - 0 或 0 - 1）：

```
flags = flags ^ 0x08;
```

将位 4 重置为零：

```
flags = flags & 0xFFFFFF7F;
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-07-15T18:26:14.330

# 按位 ( `Flags`) 枚举指南

旧的，但想试一试备忘单，即使是为了我自己的参考：

| 手术 | 句法 | 例子 |
| --- | --- | --- |
| **上** | `&#124;=` | `e &#124;= E.A` |
| **离开** | `&=`+`~` | `e &= ~E.A` |
| **切换** | `^=` | `e ^= E.A` |
| **测试**（.NET API） | `.HasFlag` | `e.HasFlag(E.A)` |
| **测试**（按位） | （见例子） | `(e & E.A) == E.A` |

### 例子

```
[Flags]
enum E {
    A = 0b1,
    B = 0b10,
    C = 0b100
}

E e = E.A;        // Assign (e = A)
e |= E.B | E.C;   // Add    (e = A, B, C)
e &= ~E.A & ~E.B; // Remove (e = C) -- alt syntax: &= ~(E.A | E.B)
e ^= E.A | E.C;   // Toggle (e = A)
e.HasFlag(E.A);   // Test   (returns true)

// Testing multiple flags using bit operations:
bool hasAandB = ( e & (E.A | E.B) ) == (E.A | E.B); 
```

### 奖励：定义一个`Flags`枚举

通常，我们使用这样的整数：

```
[Flags]
enum E {
    A = 1,
    B = 2,
    C = 4,
    // etc. 
```

但是当我们接近更大的数字时，计算下一个值并不容易：

```
 // ...
  W = 4194304,
  X = 8388608,
  // .. 
```

但是，有两种选择：二进制和十六进制文字。

对于**Binary**，只需`0`在前一个值的末尾附加 a ：

```
[Flags]
enum E {
    A = 0b1,
    B = 0b10,
    C = 0b100,
    // ...
    W = 0b100_0000_0000_0000_0000_0000,
    X = 0b1000_0000_0000_0000_0000_0000, 
```

**Hexidecimal**也有一个方便的模式，可能看起来不那么难看：循环 1、2、4、8，在每次完整迭代后添加一个零。

```
[Flags]
enum E {
    A = 0x1,
    B = 0x2,
    C = 0x4,
    D = 0x8,
    E = 0x10, // 16
    E = 0x20, // 32, etc.
    // ...
    W = 0x400000,
    X = 0x800000, 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T15:50:04.230

C++ operations are: & | ^ ~ (for and, or, xor and not bitwise operations). Also of interest are >> and <<, which are bitshift operations.

So, to test for a bit being set in a flag, you would use: if (flags & 8) //tests bit 4 has been set

# javascript - Close mootools Rokbox through Javascript

> ID：93767
> 
> 赞同：0
> 
> 时间：2008-09-18T15:48:38.367
> 
> 标签：javascript, mootools

I am using the mootools based Rokbox plugin, on one of my sites, and I can't figure out how to close it with javascript.

I triggered the click event on the close button, but that did not work.

I found the code in the rokbox source that is used to add the click listener

```
this.closeButton.addEvent('click',function(e){new Event(e).stop();self.swtch=false;self.close(e)}); 
```

but since it is minified i cannot find what "this" refers to

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T17:08:49.127

`this`可能是指 rokbox 实例；我认为您无需担心，您对在单击事件上运行的代码感兴趣。突出的部分如下所示：

```
self.swtch=false;
self.close(e); 
```

`self`最有可能再次引用 rokbox 实例，所以假设你用类似的东西实例化它

```
var rokbox = new RokBox(...); 
```

你应该可以打电话

```
rokbox.close(); 
```

并让它关闭。我没有看过 rokbox 的源代码，所以不能保证，也不太确定它的`swtch=false`作用，所以你可能需要尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-23T08:51:05.533

对于当前的 rokbox 和 mootools 1.12，命令是

```
window.parent.rokbox.close(null) 
```

它花了很长时间才想出这个。顺便说一句，这是从加载到 rokbox 的页面中关闭 rokbox，例如通过单击常规按钮而不是“x”。此外，为了添加 Aeon 所写的内容，rokbox 是自动创建的，因此无需实例化它。

# c# - 在 C++（win32 应用程序）中使用 C# 类时出现 EEFileLoadException

> ID：93770
> 
> 赞同：29
> 
> 时间：2008-09-18T15:49:31.923
> 
> 标签：c#, managed-c++

出于部署原因，我尝试使用 IJW 在 C++ 中包装 C# 程序集，而不是使用 COM Callable Wrapper。

我在其他项目上做过，但在这个项目上，我得到了一个 EEFileLoadException。任何帮助，将不胜感激！

托管 C++ 包装代码（在 DLL 中）：

```
extern "C" __declspec(dllexport) IMyObject* CreateMyObject(void)
{
    //this class references c# in the constructor
    return new CMyWrapper( );
}

extern "C" __declspec(dllexport)  void DeleteMyObject(IMyObject* pConfigFile)
{
    delete pConfigFile;
}

extern "C" __declspec(dllexport) void TestFunction(void)
{
    ::MessageBox(NULL, _T("My Message Box"), _T("Test"), MB_OK);
} 
```

测试代码（这是一个EXE）：

```
typedef void* (*CreateObjectPtr)();
typedef void (*TestFunctionPtr)();

int _tmain testwrapper(int argc, TCHAR* argv[], TCHAR* envp[])
{
    HMODULE hModule = ::LoadLibrary(_T("MyWrapper"));
    _ASSERT(hModule != NULL);

    PVOID pFunc1 = ::GetProcAddress(hModule, "TestFunction");
    _ASSERT(pFunc1 != NULL);
    TestFunctionPtr pTest = (TestFunctionPtr)pFunc1;

    PVOID pFunc2 = ::GetProcAddress(hModule, "CreateMyObject");
    _ASSERT(pFunc2 != NULL);
    CreateObjectPtr pCreateObjectFunc = (CreateObjectPtr)pFunc2;

    (*pTest)();  //this successfully pops up a message box
    (*pCreateObjectFunc)();  //this tosses an EEFileLoadException

    return 0;
} 
```

值得一提的是，事件日志报告以下内容：.NET 运行时版本 2.0.50727.143 - 致命执行引擎错误 (79F97075) (80131506)

不幸的是，微软没有关于该错误的信息。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-09-18T20:36:41.560

问题在于 DLL 所在的位置。

*   c:\dlls\managed.dll
*   c:\dlls\wrapper.dll
*   c:\exe\my.exe

我通过将 managed.dll 复制到 c:\exe 中确认了这一点，并且没有问题。显然，CLR 不会在非托管 DLL 的路径中查找托管 DLL，而只会在可执行文件所在的位置查找它。（或在 GAC 中）。

由于不值得讨论的原因，这是我需要的结构，这意味着我需要让 CLR 帮助定位托管 dll。请参见下面的代码：

组装解析器.h：

```
/// <summary>
/// Summary for AssemblyResolver
/// </summary>
public ref class AssemblyResolver
{
public:

static Assembly^ MyResolveEventHandler( Object^ sender, ResolveEventArgs^ args )
{
    Console::WriteLine( "Resolving..." );

    Assembly^ thisAssembly = Assembly::GetExecutingAssembly();
    String^ thisPath = thisAssembly->Location;
    String^ directory = Path::GetDirectoryName(thisPath);
    String^ pathToManagedAssembly = Path::Combine(directory, "managed.dll");

    Assembly^ newAssembly = Assembly::LoadFile(pathToManagedAssembly);
    return newAssembly;
}

}; 
```

包装器.cpp：

```
#include "AssemblyResolver.h"

extern "C" __declspec(dllexport) IMyObject* CreateMyObject(void)
{
    try
    {
        AppDomain^ currentDomain = AppDomain::CurrentDomain;
        currentDomain->AssemblyResolve += gcnew ResolveEventHandler( AssemblyResolver::MyResolveEventHandler );

        return new CMyWrapper( );
    }
    catch(System::Exception^ e)
    {
        System::Console::WriteLine(e->Message);

        return NULL;
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-18T16:44:00.840

第一个问题是确保调试器类型设置为混合。然后你会得到有用的例外。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-07-30T11:53:20.650

对于使用混合模式 dll（您的 EXE）的本机应用程序，请将 **“调试器类型”更改为“混合”模式。（转到项目属性 -> 配置属性 -> 调试）

还有其他一些要点（可能与您无关），但根据我的经验，它们可能会导致问题。- 在 Windows 8（具有更严格的安全性）上，请尝试以管理员身份启动您的 VS。- 确保对于 x86 配置，您使用的是 x86 二进制文件。- 注意 StrongName 验证，如果您在托管 C++ 中使用的 C# 程序集已签名，请考虑对混合模式 dll 进行签名。

希望这会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-20T12:35:12.323

万一其他人偶然发现了这个问题，并且您使用的是动态程序集名称：请确保您正在剥离程序集名称，它可能包含您可能不使用的版本、文化和其他内容。

即，您的 MyResolveEventHandler 应采用以下形式：

```
static Assembly^ MyResolveEventHandler( Object^ sender, ResolveEventArgs^ args )
{
    Console::WriteLine( "Resolving..." );

    String^ assemblyName = args->Name;

    // Strip irrelevant information, such as assembly, version etc.
    // Example: "Acme.Foobar, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"
    if( assemblyName->Contains(",") ) 
    {
        assemblyName = assemblyName->Substring(0, assemblyName->IndexOf(","));
    }

    Assembly^ thisAssembly = Assembly::GetExecutingAssembly();
    String^ thisPath = thisAssembly->Location;
    String^ directory = Path::GetDirectoryName(thisPath);
    String^ pathToManagedAssembly = Path::Combine(directory, assemblyName );

    Assembly^ newAssembly = Assembly::LoadFile(pathToManagedAssembly);
    return newAssembly;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-10-24T16:47:50.547

在调试 ASP.NET MVC 应用程序期间，iisexpress.exe 抛出了很多 C++ EEFileLoadException。调用堆栈和 C++ 异常本身对帮助我解决问题并没有太大帮助。

在直接查看 C++ 异常中给出的指针地址后，我最终发现了一个库字符串，它指向不再使用的旧版本。这又是由于我的 web.config 文件中的一个过期条目：

```
<runtime>
<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
<dependentAssembly>
    <assemblyIdentity name="Microsoft.Owin.Security.OAuth" publicKeyToken="31bf3856ad364e35" />
    <bindingRedirect oldVersion="0.0.0.0-3.0.1.0" newVersion="3.0.1.0" />
  </dependentAssembly> </assemblyBinding> </runtime> 
```

我已通过 NuGet 将各种 Microsoft.Own 安全库升级到版本 4.0.30319，但配置中的这一行指示服务器将调用重定向到版本 3.0.1.0，现在不再是我项目的一部分。更新配置解决了我的问题。

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2011-01-11T22:25:39.547

当您在使用 C++ 托管 dll 的调试器 C++ 本机项目中运行时，您可能会遇到此异常。当 VS2010 捕获它并且您的应用程序在某些链异常之后将被中止时，您可以尝试在异常过滤器 (Menu|Debug|Excpetion) 中禁用所有 C++ 异常。您仍会在输出中看到此异常，但您的应用程序不会中止

# security - 为什么欢迎屏幕中缺少我以编程方式创建的用户？

> ID：93771
> 
> 赞同：1
> 
> 时间：2008-09-18T15:49:32.873
> 
> 标签：security, winapi

[我有一个使用Microsoft 建议的](http://support.microsoft.com/kb/119671win32)[NetUserAdd()](http://msdn.microsoft.com/en-us/library/aa370649(VS.85).aspx) API创建 Windows 用户帐户的程序。用户创建成功，我可以以该用户身份登录。

但是，在 Windows XP 上，欢迎屏幕中缺少新创建的用户。如果我禁用欢迎屏幕，我可以通过直接输入用户名以新用户身份登录。

我创建的帐户的什么属性导致它从欢迎屏幕中被忽略？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T15:53:49.807

您可以做的一件事是将用户名作为值添加到注册表项：HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList

使用用户名（作为 REG_DWORD）和值 1 来显示用户，使用 0 来隐藏。

# ruby-on-rails - ActiveRecord 模式与域对象或数据映射器模式有何不同？

> ID：93773
> 
> 赞同：9
> 
> 时间：2008-09-18T15:49:42.593
> 
> 标签：ruby-on-rails, activerecord, datamapper

我在看[DataMapper](http://datamapper.org/)，乍一看似乎使用 ActiveRecord ORM 模式。其他人说它使用 DataMapper 和/或域对象模式。

这些模式有什么区别？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-18T16:17:07.567

两种模式的主要区别在于：

*   在 ActiveRecord 中，您有一个域对象，它既知道所有业务逻辑，也知道如何在数据库中保存/更新自身，user.getLinkToProfile() 和 User::find(1)，User::save(user)

*   在 DataMapper 模式中，您有一个包含所有业务逻辑的域对象，例如 user.getLinkToProfile() （或类似的东西），但对相关数据库*一无所知*，除此之外，您还有一个负责的映射器对象用于保存、更新、选择等数据库中的用户对象，这些对象将具有 UserMapper::find(1)、UserMapper.save(user)

DataMapper 可能比 ActiveRecord 更复杂，但是使用 ActiveRecord 异步开发域模型和数据库要容易得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T16:20:41.863

活动记录非常重，数据映射器和域对象将这些关注点分开，因此您有一组更明确的代码为您的“域”或“实体”对象执行各个方面。

我个人更喜欢，不是你问的，分离到域对象，数据映射器，可能使用组装模式甚至数据传输模式来确保清楚地分离数据库和应用程序上层之间的数据发生的事情.

...优雅而简单的分离总是有帮助的。

# mysql - MySQL 触发器和存储过程复制

> ID：93790
> 
> 赞同：2
> 
> 时间：2008-09-18T15:50:30.093
> 
> 标签：mysql, stored-procedures, triggers

好的，我正在运行一个具有单个主设备和多个从设备的设置。所有写入都通过主服务器并被复制到严格用于读取的从服务器。

现在我有一个由插入触发器调用的存储过程（不是函数）。根据 MySQL 文档，对于复制触发器，记录对触发器的调用，而存储过程实际记录存储过程的结果。

所以我的问题是，当我的触发器被触发时，它是否会复制触发器和触发器调用的过程的结果（导致过程有效地运行两次）？或者它会简单地复制触发器，让从属设备自己重新运行存储过程？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T16:13:24.970

在 MySQL 5.0（和基于语句的二进制日志记录的 MySQL 5.1）中，仅记录调用查询，因此在您的情况下，将记录 INSERT。

在从机上，将执行 INSERT，然后触发器将在从机上重新运行。所以触发器需要存在于slave上，假设它存在，那么它将以与master完全相同的方式执行。

在 MySQL 5.1 中，有基于行的二进制日志记录，它将仅记录正在更改的行，因此触发器不会在从属设备上重新触发，但所有更改的行仍将被传播。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T19:00:48.560

除了哈里森的出色回答：

*   假设数据库是同步的（架构、数据、相同版本）开始，它应该可以工作
*   如果不是，则可能是您在查询或触发器中使用了非确定性的东西。修复它。
*   无论您如何使用复制，您都需要进行监控以检查从属设备是否始终同步。如果没有任何监控，它们会（微妙地）变得不同步，而您不会注意到。MySQL 没有用于检查或修复它的自动内置功能。

# php - 那里有很多 PRADO 的用户吗？

> ID：93791
> 
> 赞同：3
> 
> 时间：2008-09-18T15:50:30.593
> 
> 标签：php, model-view-controller, frameworks, prado

在发表了[一些评论](https://stackoverflow.com/questions/75882/what-in-your-mind-is-the-best-php-mvc-framework#89095)之后，我受到启发，想要获得一些关于 PHP MVC 框架[PRADO](http://pradosoft.com/)的反馈。我已经使用它一年多了，我非常喜欢使用它，但是我注意到在整个 Stack Overflow 中，当[symfony](http://www.symfony-project.org/)或[CakePHP](http://cakephp.org/)被谈论为潜在的候选人时，它似乎并没有被提及为一个框架。

现在有人使用 PRADO 使用 Stack Overflow 吗？如果是这样，你如何找到它？过去有没有人使用过它但留下了它，如果有，为什么？任何人都可以评估它与 Cake 或 symfony 的优缺点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T15:54:05.857

我玩过 PRADO 一些，但我觉得如果我将被迫进入 post-back-hell，我还不如在它最初构建的平台上进行 - .NET，除此之外PRADO 在博客等中相对“未提及”。但我不知道为什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-12-30T20:18:36.267

我发现活动控件非常漂亮。它使做各种 ajaxy 的事情变得非常容易。不幸的是，当您需要做一些稍微不同的事情时，它会非常混乱并且很难弄清楚发生了什么。我觉得我经常得到一些简单而出色的工作，然后一个小的额外要求将要求我将整个事情拆开并提出一个更复杂的解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-08-19T15:36:08.050

第一次研究 PRADO 时，我用了大约 10 天时间，不断对自己说：“这个框架太棒了！”。几个月后，我开始着手一个客户选择使用 PRADO 的大项目……地狱开始了……只要我们继续使用 PRADO 的基础组件，一切都很完美，开发也很快。但是一旦客户想要一个开箱即用的东西，我们实际上花费的时间是使用另一个框架完成的时间的 2 到 3 倍。而且我不是在谈论大型定制。PRADO 框架强制应用程序具有特定的结构和工作流程。如果该逻辑不适合您，请查看另一个框架。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-07-09T15:01:35.217

普拉多现在死了。文档也很差。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T18:25:34.497

我认为 Prado 从未真正流行起来，因为它是一个事件驱动的框架，有点难以理解。特别是对于许多来自程序背景的 PHP 开发人员而言。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T20:38:58.933

如果我没有遇到过 QCodo，那么 PRADO 将是我的框架选择。我喜欢事件驱动的方法——QCodo 更适合我。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-07T20:30:46.013

自 4 年以来，我们一直在使用 PRADO 框架。我们正在使用包含超过 6000 万条记录的 Oracle 和 MySql 数据库开发用于电子政务的大型（+4000 个程序）网络应用程序。作为开发的基础设施，我们使用 SVN+TRAC+ 我们自己的项目控制工具和 phpEdit w/tortoiseSVN 作为客户端工具。目前我们正在考虑改用 Yii。

# c# - Infragistics WebTextEdit - Setting value in Javascript function

> ID：93799
> 
> 赞同：0
> 
> 时间：2008-09-18T15:51:02.247
> 
> 标签：c#, asp.net, javascript, infragistics

I'm currently using the Infragistics component set for .Net 2.0, Visual Studio 2005 and C#. I have the following chunk of javascript code (text and other variables are declared elsewhere):

> ***alert(box[select].value);
> 
> text.value(box[select].value);
> 
> alert(text.value);***

'text' is an Infragistics webTextEdit, while box is just a standard listbox. The two alerts seem to be working fine. Before I set the value, the listBox's selected value might be 'hello', and the alert box which pops up after I've assigned this value to 'text' is also 'hello'.

However, the value shown in the box on my form never appears to get updated. Anybody have some suggestions as to where I'm going wrong, gotchas in how Infragistics handles this kind of thing or anything else? I'm aware there may not be enough info here to diagnose the problem.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T00:48:28.787

除非我误解了这个问题，如果`text`是 Infragistics WebTextEdit 的一个实例，你应该能够做到：

```
text.setValue(box[select].value) 
```

或者 if`text`是底层输入控件，但 'id' 是它的 ID，

```
var edit = igedit_getById(id)
edit.setValue(box[select].value) 
```

有关更多信息，请参阅[WebTextEdit CSOM](http://help.infragistics.com/Help/NetAdvantage/NET/2008.1/CLR2.0/html/WebTextEdit_Object_CSOM.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T16:44:56.517

value 属性仅在服务器端可用。在客户端使用它不会做任何事情。设置它必须在服务器端完成，或者您需要制作有趣的 javascript 来处理控件实际呈现在浏览器中的元素的文本。

[http://help.infragistics.com/Help/NetAdvantage/NET/2007.3/CLR2.0/html/Infragistics2.WebUI.WebDataInput.v7.3~Infragistics.WebUI.WebDataInput.WebTextEdit~Value.html](http://help.infragistics.com/Help/NetAdvantage/NET/2007.3/CLR2.0/html/Infragistics2.WebUI.WebDataInput.v7.3~Infragistics.WebUI.WebDataInput.WebTextEdit~Value.html)

# sql - How can I maintain consistent DB schema accross 18 databases (sql server)?

> ID：93804
> 
> 赞同：2
> 
> 时间：2008-09-18T15:51:17.470
> 
> 标签：sql, sql-server, database, schema

We have 18 databases that should have identical schemas, but don't. In certain scenarios, a table was added to one, but not the rest. Or, certain stored procedures were required in a handful of databases, but not the others. Or, our DBA forgot to run a script to add views on all of the databases.

What is the best way to keep database schemas in sync?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T15:52:11.870

[SQL Compare](http://www.red-gate.com/products/SQL_Compare/index.htm) by Red Gate is a great tool for this.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T15:53:59.760

For legacy fixes/cleanup, there are tools, like [SQLCompare](http://www.red-gate.com/products/SQL_Compare/index.htm?gclid=CMvQrZjZ5ZUCFQZqswodnQ8Tfg), that can generate scripts to sync databases.

For .NET shops running SQL Server, there is also the [Visual Studio Database Edition](http://msdn.microsoft.com/en-us/vsts2008/db/default.aspx), which can create change scripts for schema changes that can be checked into source control, and automatically built using your CI/build process.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T17:18:59.507

[SQLCompare](http://www.red-gate.com/products/SQL_Compare/index.htm?gclid=CMvQrZjZ5ZUCFQZqswodnQ8Tfg) is the best tool that I have used for finding differences between databases and getting them synced.

To keep the databases synced up, you need to have several things in place:

1) You need policies about who can make changes to production. Generally this should only be the DBA (DBA team for larger orgs) and 1 or 2 backaps. The backups should only make changes when the DBA is out, or in an emergency. The backups should NOT be deploying on a regular basis. Set Database rights according to this policy.

2) A process and tools to manage deployment requests. Ideally you will have a development environment, a test environment, and a production environment. Developers should do initial development in the dev environment, and have changes pushed to test and production as appropriate. You will need some way of letting the DBA know when to push changes. I would NOT recommend a process where you holler to the next cube. Large orgs may have a change control committee and changes only get made once a month. Smaller companies may just have the developer request testing, and after testing is passed a request for deployment to production. One smaller company I worked for used [Problem Tracker](http://www.problemtracker.com/) for these requests.

Use whatever works in your situation and budget, just have a process, and have tools that work for that process.

3) You said that sometimes objects only need to go to a handful of databases. With only 18 databases, probably on one server, I would recommend making each Databse match objects exactly. Only 5 DBs need usp_DoSomething? So what? Put it in every databse. This will be much easier to manage. We did it this way on a 6 server system with around 250-300 DBs. There were exceptions, but they were grouped. Databases on server C got this extra set of objects. Databases on Server L got this other set.

4) You said that sometimes the DBA forgets to deploy change scripts to all the DBs. This tells me that s/he needs tools for deploying changes. S/He is probably taking a SQL script, opening it in in Query Analyzer or Manegement Studio (or whatever you use) and manually going to each database and executing the SQL. This is not a good long term (or short term) solution. [Red Gate](http://www.red-gate.com/) (makers of SQLCompare above) have many great tools. [MultiScript](http://www.red-gate.com/products/SQL_Multi_Script/features.htm) looks like it may work for deployment purposes. I worked with a DBA that wrote is own tool in SQL Server 2000 using O-SQl. It would take an SQL file and execute it on each database on the server. He had to execute it on each server, but it beat executing on each DB. I also helped write a VB.net tool that would do the same thing, except it would also go through a list of server, so it only had to be executed once.

5) Source Control. My current team doesn't use source control, and I don't have enough time to tell you how many problems this causes. If you don't have some kind of source control system, get one.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T15:56:00.987

I haven't got enough reputation to comment on the above answer but the pro version of SQL Compare has a scriptable API. Given that you have to replicate stuff to all of these databases you could use this to make an automated job to either generate the change scripts or to validate that the databases are all in sync. It's also not much more expensive than the standard version.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T15:59:53.223

Aside from using database comparison tools, with 18 databases you should have a DBA, so enforce a policy that only the DBA can change tables at the database level by restricting access to CREATE and ALTER to the DBA only. On both your test and live databases. The dev database shouldn't have this, of course! Make the developers who have been creating or altering the schemas willy-nilly go via the DBA.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T17:47:22.357

Create a single source-controlled DDL/SQL script for each release and **only** use it to update the databases. The diff tools can be useful but mainly for checking that you haven't made a mistake and getting out of trouble when the policies fail. Combine the DDL, SQL, and stored procedure scripts into a single script so that it's not easy to "forget" to run one of the scripts.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-19T12:00:09.450

We have got a tool called DB Schema Difftective that can compare and sync database schemas. With our other tool, DB MultiRun you can easily deploy generated (sync) scripts to multiple db servers (project based).

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-03T20:00:25.840

I realize this post is old, but TurnKey is correct. If you are a developer working in a team environment, the best way to maintain a database schema for a large application, is to make updates to a Master Schema in what ever source safe you use. Simply write your own Scripting class and your Database will be perfect every time.

# c# - WinForm - 使用单像素边框绘制调整大小的框架

> ID：93811
> 
> 赞同：1
> 
> 时间：2008-09-18T15:52:01.090
> 
> 标签：c#, winforms, resize, border

在具有调整大小框架的 Windows 窗体中，框架边框以凸起的 3-D 外观绘制。我希望它以我选择的颜色绘制一个平坦的单像素边框。

这是否可能无需所有者绘制整个表格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T16:27:19.397

你可以尝试这样的事情：

```
Point lastPoint = Point.Empty;
Panel leftResizer = new Panel();
leftResizer.Cursor = System.Windows.Forms.Cursors.SizeWE;
leftResizer.Dock = System.Windows.Forms.DockStyle.Left;
leftResizer.Size = new System.Drawing.Size(1, 100);
leftResizer.MouseDown += delegate(object sender, MouseEventArgs e) { 
  lastPoint = leftResizer.PointToScreen(e.Location); 
  leftResizer.Capture = true;
}
leftResizer.MouseMove += delegate(object sender, MouseEventArgs e) {
  if (lastPoint != Point.Empty) {
    Point newPoint = leftResizer.PointToScreen(e.Location);
    Location = new Point(Location.X + (newPoint.X - lastPoint.X), Location.Y);
    Width = Math.Max(MinimumSize.Width, Width - (newPoint.X - lastPoint.X));
    lastPoint = newPoint;
  }
}
leftResizer.MouseUp += delegate (object sender, MouseEventArgs e) { 
  lastPoint = Point.Empty;
  leftResizer.Capture = false;
}

form.BorderStyle = BorderStyle.None;
form.Add(leftResizer); 
```

# communication - Do you chat online for work purposes?

> ID：93816
> 
> 赞同：6
> 
> 时间：2008-09-18T15:52:23.820
> 
> 标签：communication, chat, collaboration, instant-messaging

I've worked with folks who are chatting online with their peers, constantly batting around ideas. I've also worked with folks who adamantly refuse and think it's a waste of time.

Are online live chatting forums of particular use to you? Why or why not? Internal to your company, or external and world-wide? Does your employer encourage or discourage their use?

Update: I see some people are voting this question down, yet so far all the answers have been positive, if with some reservations. If someone has a strong negative opinion (I hate online chatting and think it should be banned etc.) I'd really like to hear why.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T15:55:09.320

如果您有远程办公人员，不在线聊天将是您的死亡。

没有聊天，就没有互动。

没有互动，就没有解决问题。

如果没有解决问题，代码就会很糟糕。

聊天部分确实浪费了很多时间，我经常希望我能把它们拉出来，只写 WriteSomeCode，但是，是的，权衡场景。

使用在线对话还有一个额外的好处，那就是它不会/必须/成为中断。如果你在做某事，你可以忽略它们，直到你完成，他们只需要处理它。在现实生活中，你有一张会说话的脸来尝试摆脱。（这里很酷的一点是你可以忽略它们**，**它们仍然会被听到，吃你的蛋糕并吃掉它！）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T16:13:17.997

我在最近工作的三个地方都使用过 IM。目前我所在的大楼非常大，步行到我的经理办公室需要几分钟。然后是我们在家工作的日子（每周 1-2 天）。出于某些目的，电子邮件并不能解决问题，而电话对于某些任务来说可能过于破坏性和无所不包。

当我从事咨询工作时，我会将我的 IM 联系信息提供给我的客户。大约 25% 的人会用它来联系我，直到今天我仍然与他们保持联系，这为未来的工作开辟了可能性！使用 IM 的客户觉得他们与我的联系更好，因为他们可以看到我何时在线并可以交谈。

我仍然通过 IM 与老同事保持联系，这也让我可以快速访问他们的知识库。

我对在工作场所使用 IM 的建议是：

*   使用支持多种协议（MSN、Yahoo、AIM、Jaber 等）的客户端
*   为您所在的每个网络设置和使用个人帐户（即不要使用与您的工作直接相关的帐户）
*   确保您的 IM 客户端记录您所有对话的历史记录
*   随时待命，但尽量减少私人谈话
*   将您的 IM 信息免费提供给朋友、客户和同事
*   添加适当的组（即朋友、家人、工作）和过滤器以减少不希望的干扰，同时在需要时仍然可用
*   不要觉得你**必须**回应每个聊天请求。让它设置，直到你准备好处理它

我使用的另一个技巧是使用文本转语音软件，以便当聊天消息进入时允许读取。当我在家（或在办公室远离计算机）时，系统会自动允许读取消息（我将其比作响铃的电话）以引起我的注意。但是，我不必为了知道信息是什么而停止我正在做的事情**。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T15:55:12.533

我曾经。我发现它是与以前共事的人聊天的好资源。在我们的业务中，我发现我们倾向于建立很多网络，并且使用这种集体知识非常棒。当然，我的公司关闭了它，所以他们输了。

我知道某家大银行有一个内部 AIM 设置，以便他们可以互相 IM。这令人耳目一新，很有用。他们还允许一些外部访问。谈论获取 IM 的价值！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T15:55:34.670

是的，绝对是，我通过 MSN/Yahoo/Skype/.../ 与我的大多数员工和雇主一起工作，这使工作更容易，因为我可以雇用更好的人，而无需付钱让他们搬到我这里。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T17:49:54.893

我们的整个业务部门都在远程办公。只有我们第一年需要在办公室，所以我们的企业 IM 解决方案对于保持联系和完成任务至关重要。这是我的经理如何让我知道我正在从事的项目，我是否需要将我的时间计费给另一个客户，或者我是否需要反复思考。所以是的，我愿意。任何人都可以上车吗？一点都不。您必须在 Intranet 上才能访问该系统，并且它对任何和所有外部人员都是关闭的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T15:54:40.897

When I need to collaborate with someone in another office, it's great ... when I'm deep in thought, I have to turn it off (just like e-mail).

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T18:06:03.933

在过去 8 年左右的四份专业工作中，我只在一个不允许任何类型的即时消息传递的地方工作。所有其他公司至少有某种类型的 Intranet 即时通讯设置。

我认为在当今的商业环境中，IM 几乎是必要的。我不太会即时通讯，但很高兴有它可用。特别是当我只需要快速回答一个问题时——比如“这个文件在哪里？” 然后***就***在我面前弹出一个指向文件的链接。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-26T07:25:24.163

是的。这里实际上是需要的。但只有MSN。我们使用它与团队进行与开发/任务相关的沟通......这也有助于最大限度地减少噪音，因为我目前工作的这家公司很大，其中 90% 是开发人员，所以必须完全保持沉默......

但是如果我对团队的其他成员有问题，我更喜欢亲自问，因为我发现在聊天时很难解释一些事情......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T16:06:27.637

似乎我没有什么可以真正添加到尚未编写的内容中。

我广泛使用它，尤其是当远程人员参与开发时。没有它，您的实时通信就会消失。这是唯一可行的沟通方式，不会像电话或类似性质的东西那样干扰。众所周知，我们不能在开发过程中一直坐在电话上，因此聊天是实时交流的下一个最佳选择。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T19:18:34.570

我在工作中使用 IRC——这几乎是我们所有远程交互的人（在家工作、不同办公室和客户站点）能够快速获得问题帮助的要求。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T17:42:56.750

我个人不喜欢。我认为电子邮件可以让你花一点时间来撰写你的想法。

IM 似乎对其他人有用。什么都行！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-09-22T03:25:57.307

我在上一份工作中不得不使用它，因为我的同事住在英国，而我的老板在加利福尼亚工作，而我在亚特兰大。它用于快速提问和“只要你有机会回答”类型的事情。我可以在打电话时弹出一个即时消息，他们会收到一条自动消息告诉他们。使用网络摄像头和电话以及共享桌面以查看代码、数据等的能力进行了更长的讨论。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T15:56:25.290

这取决于团体动态和个人喜好。就个人而言，我很喜欢我的工作组，他们使用聊天来交流彼此的想法并排除故障，而无需四处走动。如果您地理分散，这几乎是必需品。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T15:56:51.950

我发现在许多情况下在线聊天非常宝贵，但通常不是即时消息。由于我在工作中使用了许多开源技术，因此我倾向于加入各自的 IRC 频道，既可以在那里提问，有时也可以在我知道答案的情况下帮助其他人。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T15:57:39.813

这可能取决于工作环境。作为一名自雇顾问，我总是在聊天——这是我与世界的主要交流方式，还有用于更正式类型交流的电子邮件。

能够与他人交谈会产生协同作用，但也会导致分心。一个好的经理可以分辨出来。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-18T15:59:20.090

在我上一个工作场所，我们广泛使用 IM 进行协作。在我现在的工作场所并没有那么多。事实上，我在 6 个月内从来没有在这里这样做过。但我确实在网上四处寻找答案，有时我也在论坛上发布了查询。IM 是一个很好的工具，但它也是一个时间槽。另外，不要低估失去的焦点。如果有人不断向您询问如何建立与 Oracle 数据库的连接，则特别难以专注于正确实施该算法。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-18T15:59:50.213

我每周有 2 到 3 天在家工作。我主要使用 MSN 与我的同事保持联系。快速提出简短的问题非常有用。如果我们发现自己在输入整个对话，我们通常会同意通过电话继续对话。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-18T16:01:54.950

当 IM 取代面对面聊天时，我使用 IM 与其他办公室的同事交流。不过，我在工作时关闭了所有通讯应用程序中的通知，因为它们会分散我的注意力。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-18T16:02:22.343

我从加利福尼亚远程办公到科罗拉多，从来没有使用过聊天。我们确实有每天的 SCRUM 会议和不断的电子邮件线程。当我第一次开始远程工作时，我们确实尝试过，但它似乎打扰了几个同事，所以我们停止使用它，那是 4 年前，我可能应该再试一次。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-04-09T15:47:37.570

我公司不允许。即使我们在家里运行 IM 服务器（所以我们不会浪费时间与朋友聊天）。我试图说服他们，我发现知道某人是否在他们的办公桌前真的很有用。电话做得不太好，因为如果你不接电话，它会重定向到一个秘书，如果你每 5 分钟检查一次是否有人​​回来，他会很生气......

所以我在手机上运行了一个 IM 客户端，这样我至少可以整天和几个人聊天。（如果我的妻子给我发消息而不是打电话给我，就更少打扰别人，如果我需要也更容易忽略）。

# .net - .NET Framework 快速构建目录的方法

> ID：93821
> 
> 赞同：1
> 
> 时间：2008-09-18T15:53:27.763
> 
> 标签：.net, powershell

有没有像 Powershell 中的 Join-Path 函数那样快速加入路径的方法？例如，我有一个路径“C:\foo”和一个子目录“bar”的两个部分。Join-Path 将加入这些并处理反斜杠分隔符。.NET 中是否有内置方法，还是我需要自己处理？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T15:54:54.797

这是你的朋友：http: [//msdn.microsoft.com/en-us/library/system.io.path.combine.aspx](http://msdn.microsoft.com/en-us/library/system.io.path.combine.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T15:54:18.260

System.IO.Path.Combine 是您正在寻找的。Path 类有很多有用的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T15:54:35.950

*Path.Combine*是要走的路。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T15:56:10.673

[System.IO.Path.Combine](http://msdn.microsoft.com/en-us/library/system.io.path.combine.aspx)

# c# - 如何从 .NET 客户端应用程序加载 URL

> ID：93832
> 
> 赞同：2
> 
> 时间：2008-09-18T15:54:09.837
> 
> 标签：c#, .net, windows, client

在 Windows 上使用 C# 和 .NET 框架从胖客户端应用程序打开 URL 的首选方法是什么？我希望它使用默认浏览器。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T15:57:41.263

以下代码肯定有效：

```
Process.Start("http://www.yoururl.com/Blah.aspx"); 
```

它会打开默认浏览器（从技术上讲，是处理 HTTP URI 的默认程序）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T15:56:38.223

我会使用[Process.Start 方法](https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.process.start#System_Diagnostics_Process_Start_System_String_)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T15:57:04.807

```
private void launchURL_Click(object sender, System.EventArgs e){
 string targetURL = "http://stackoverflow.com";
 System.Diagnostics.Process.Start(targetURL);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T15:57:20.657

```
System.Diagnostics.Process.Start("http://www.stackoverflow.com"); 
```

# multithreading - 什么时候多线程不是一个好主意？

> ID：93834
> 
> 赞同：33
> 
> 时间：2008-09-18T15:54:28.493
> 
> 标签：multithreading, language-agnostic

我最近正在开发一个通过以太网和串行发送和接收消息的应用程序。然后我的任务是**添加**对 DIO 离散的监控。我通过，

> “没有理由中断参与消息处理的主线程，我将创建 ***另一个***监视 DIO 的线程。”

然而，这个决定被证明是**糟糕的**。有时主线程会在发送和接收串行消息之间中断。这种中断会打乱时间，唉，消息会丢失（永远）。

我找到了另一种*无需使用其他线程*即可监视 DIO 的方法，并且以太网和串行通信已恢复到正确的功能。

然而，整个惨败让我思考。***他们是否有关于何时不*****使用多线程的一般准则和/或是否有人有更多使用多线程不是一个好主意的情况示例？**

 ***编辑：根据您的评论并在网上搜索信息后，我撰写了一篇题为[多线程何时不是好主意的博客文章？](http://www.codingwithoutcomments.com/2008/09/21/when-is-multi-threading-not-a-good-idea/)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T16:08:51.407

1.  在单处理器机器和桌面应用程序上，您使用多线程，因此您不会冻结应用程序，但实际上没有别的。
2.  在单处理器服务器和基于 Web 的应用程序上，不需要多线程，因为 Web 服务器处理大部分。
3.  在多处理器机器和桌面应用程序上，建议您使用多线程和并行编程。创建与处理器一样多的线程。
4.  在多处理器服务器和基于 Web 的应用程序上，不再需要多线程，因为 Web 服务器会处理它。

总的来说，如果您使用多个线程而不是解冻桌面应用程序和任何其他通用答案，*如果*您有一个单核机器，由于线程相互中断，您将使应用程序变慢。

为什么？因为硬件开关。硬件在线程之间切换总共需要时间。在多核机器上，继续为每个内核使用 1 个线程，您会看到大幅提升。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-18T16:10:12.823

套用一句老话：程序员遇到了问题。他想，“我知道，我会用线。” 现在程序员有两个问题。（通常归因于 JWZ，但它似乎早于他使用它谈论正则表达式。）

一个好的经验法则是“不要使用线程，除非有非常令人信服的理由使用线程。” 多个线程正在自找麻烦。尝试找到一种不使用多线程的好方法来解决问题，并且只有在避免使用线程与使用线程的额外努力一样麻烦时才回退到使用线程。此外，如果您在多核/多 CPU 机器上运行，请考虑切换到多线程，单线程版本的性能测试表明您*需要*额外内核的性能。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-10T05:48:48.147

如果出现以下情况，多线程是个坏主意：

*   多个线程访问和更新同一个资源（设置变量，写入文件），而你不懂[线程安全](http://en.wikipedia.org/wiki/Thread_safety)。

*   多个线程相互交互，您不了解[互斥锁](http://en.wikipedia.org/wiki/Mutex)和类似的线程管理工具。

*   您的程序使用静态变量（线程通常默认共享它们）。

*   您尚未调试并发问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-18T16:00:17.573

实际上，多线程是不可扩展的，并且很难调试，所以如果可以避免的话，在任何情况下都不应该使用它。在少数情况下它是强制性的：当多 CPU 上的性能很重要时，或者当您处理有很多客户端需要很长时间才能响应的服务器时。

在任何其他情况下，您可以使用队列 + cron 作业等替代方案。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T16:40:00.007

您可能想查看 Dan Kegel 的“ [C10K 问题](http://www.kegel.com/c10k.html)”网页，了解如何处理多个数据源/接收器。

基本上最好使用最少的线程，这在套接字中可以在大多数操作系统的 w/某些事件系统中完成（或在 Windows 中使用 IOCP 异步完成）。

当您遇到操作系统和/或库不提供以非阻塞方式执行通信的方法的情况时，最好使用线程池来处理它们，同时向同一个事件循环报告。

布局示例图：

```
Per CPU [*] EVENTLOOP   ------ Handles nonblocking I/O using OS/library utilities
                       |                        \___  Threadpool for various blocking events
                       Threadpool for handling the I/O messages that would take long 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-08T18:15:08.013

多线程是不好的，除了在单一情况下它是好的。这个案例是

1.  工作受 CPU 限制，或部分工作受 CPU 限制
2.  这项工作是可并行的。

如果缺少这些条件中的一个或两个，多线程将不会是一个成功的策略。

如果工作不受 CPU 限制，那么您等待的不是线程完成工作，而是等待一些外部事件，例如网络活动，以便进程完成其工作。使用线程，会有额外的线程间上下文切换成本、同步成本（互斥锁等）以及线程抢占的不规则性。最常用的替代方案是异步 IO，其中单个线程监听多个 io 端口，并针对现在恰好准备好的任何一个进行操作，一次一个。如果这些慢通道碰巧同时都准备好了，那么您似乎会经历减速，但实际上这很少是真的。当每个通道被清空时，单独处理每个端口的成本通常与在多个线程上同步状态的成本相当或更好。

许多任务可能受计算限制，但使用多线程方法仍然不切实际，因为进程必须在整个状态上同步。这样的程序不能从多线程中受益，因为不能同时执行任何工作。幸运的是，大多数需要大量 CPU 的程序都可以并行化到一定程度。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T16:04:06.490

如果您需要保证精确的物理时序（如您的示例中），多线程不是一个好主意。其他缺点包括线程之间的密集数据交换。如果您不太关心它们的相对速度/优先级/时序，我会说多线程非常适合真正的并行任务。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-18T16:10:39.797

我最近编写的一个*必须*使用多线程（尽管不是无限数量的线程）的应用程序是一个我必须通过两个协议在多个方向上进行通信的应用程序，另外还要监视第三个资源的更改。两个协议库都需要一个线程来运行各自的事件循环，当考虑到这些时，很容易为资源监控创建第三个循环。除了事件循环的要求之外，通过线路的消息还有严格的时序要求，一个循环不能冒阻塞另一个循环的风险，使用多核 CPU (SPARC) 可以进一步缓解这种情况。

关于是否应将每个消息处理视为从线程池中分配给线程的工作的进一步讨论，但最终这是一个不值得工作的扩展。

总而言之，如果可能，仅当您可以将工作划分为定义明确的作业（或一系列作业）时才应考虑线程，这样语义相对容易记录和实现，并且您可以在您使用并且需要交互的线程数。最佳应用的系统几乎是消息传递系统。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T16:01:25.340

原则上每次调用者在队列中等待都没有开销。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T16:23:19.640

我想说多线程通常用于：

1.  允许在后台处理数据，同时 GUI 保持响应
2.  将非常大的数据分析拆分到多个处理单元上，以便您更快地获得结果。
3.  当您从某些硬件接收数据并需要将其连续添加到缓冲区时，而其他一些元素决定如何处理它（写入磁盘，在 GUI 上显示等）。

因此，如果您没有解决其中一个问题，那么添加线程不太可能让您的生活更轻松。事实上，这几乎肯定会让事情变得更难，因为正如其他人所提到的那样；调试多线程应用程序比单线程解决方案要多得多。

安全性可能是避免使用多个线程（通过多个进程）的一个原因。有关多进程安全功能的示例，请参阅[Google chrome 。](http://blog.chromium.org/2008/09/multi-process-architecture.html)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T17:52:34.217

使用线程的更多可能原因：

1.  您的平台缺少异步 I/O 操作，例如 Windows ME（没有完成端口或重叠 I/O，移植使用它们的 XP 应用程序时很痛苦。） Java 1.3 和更早版本。
2.  可以挂起的第三方库函数，例如，如果远程服务器关闭，并且库没有提供取消操作的方法并且您无法修改它。

在密集处理期间保持 GUI 响应并不总是需要额外的线程。单个回调函数通常就足够了。

如果以上都不适用，并且出于某种原因我仍然想要并行性，我更愿意尽可能启动一个独立的进程。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-08T18:17:51.363

多线程是可扩展的，并且允许您的 UI 在后台执行非常复杂的事情时保持其响应性。我不明白其他响应在哪里获取他们关于多线程的信息。

当你不应该多线程是你的问题的误导性问题。您的问题是：为什么我的应用程序的多线程导致串行/以太网通信失败？

该问题的答案将取决于实现，这应该在另一个问题中讨论。我知道一个事实，您可以在多线程应用程序中同时进行以太网和串行通信以及许多其他任务，而不会导致任何数据丢失。

不使用多线程的一个原因是：

1.  有一个任务，并且该任务不会干扰任何用户界面。

使用多线程的原因是：

1.  为用户提供卓越的响应能力
2.  同时执行多个任务以减少整体执行时间
3.  使用更多当前的多核 CPU，以及未来的多核。

多线程编程的三种基本方法可以轻松实现线程安全 - 您只需要使用一种即可成功：

1.  线程之间传递的线程安全数据类型。
2.  Thread Safe Methods in the threaded object to modify data passed between.
3.  PostMessage capabilities to communicate between threads.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T16:01:55.667

进程是否并行？性能是一个真正的问题吗？是否像在 Web 服务器上一样有多个执行“线程”？我不认为有一个有限的答案。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-08T17:56:27.607

线程问题的一个常见来源是用于同步数据的常用方法。让线程共享状态然后在所有适当的位置实现锁定是设计和调试复杂性的主要来源。获得锁定权以平衡稳定性、性能和可扩展性始终是一个难以解决的问题。即使是最有经验的专家也经常出错。处理线程的替代技术可以减轻这种复杂性。[Clojure](http://clojure.org/concurrent_programming)编程语言实现了几种有趣的并发处理技术。

# java - Java中的位操作和输出

> ID：93839
> 
> 赞同：5
> 
> 时间：2008-09-18T15:54:46.263
> 
> 标签：java, bit-manipulation

如果您有二进制字符串（字面意思是仅包含 1 和 0 的字符串对象），您将如何将它们作为位输出到文件中？

这是我正在研究的文本压缩器；它仍然困扰着我，最终让它工作会很好。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T15:59:31.913

最简单的方法是简单地取 8 个连续字符，将它们转换为一个字节并输出该字节。如果您可以识别流的结尾，则在末尾用零填充，或者在文件的开头添加带有长度（以位为单位）的标头。

内部循环看起来像：

```
 byte[] buffer = new byte[ ( string.length + 7 ) / 8 ];
for ( int i = 0; i < buffer.length; ++i ) {
   byte current = 0;
   for ( int j = 7; j >= 0; --j )
       if ( string[ i * 8 + j ] == '1' )
           current |= 1 << j;
   output( current );
} 
```

您需要进行一些调整，但这是一般的想法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T16:52:44.593

如果你幸运的话，java.math.BigInteger 可以为你做所有事情。

```
String s = "11001010001010101110101001001110";
byte[] bytes = (new java.math.BigInteger(s, 2)).toByteArray(); 
```

这确实取决于您想要的字节顺序（大端）和右对齐（如果位数不是 8 的倍数），但之后修改数组可能比自己进行字符转换更简单.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T16:06:43.427

```
public class BitOutputStream extends FilterOutputStream
{
    private int buffer   = 0;
    private int bitCount = 0;

    public BitOutputStream(OutputStream out)
    {
        super(out);
    }

    public void writeBits(int value, int numBits) throws IOException
    {
        while(numBits>0)
        {
            numBits--;
            int mix = ((value&1)<<bitCount++);
            buffer|=mix;
            value>>=1;
            if(bitCount==8)
                align8();
        }
    }

    @Override
    public void close() throws IOException
    {
        align8(); /* Flush any remaining partial bytes */
        super.close();
    }

    public void align8() throws IOException
    {
        if(bitCount > 0)
        {
            bitCount=0;
            write(buffer);
            buffer=0;
        }
    }
} 
```

进而...

```
if (nextChar == '0')
{
    bos.writeBits(0, 1);
}
else
{
    bos.writeBits(1, 1);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T16:02:48.240

假设 String 有 8 位的倍数，（否则您可以填充它），利用 Java 在 Integer.valueOf 方法中的内置解析来执行以下操作：

```
String s = "11001010001010101110101001001110";
byte[] data = new byte[s.length() / 8];
for (int i = 0; i < data.length; i++) {
    data[i] = (byte) Integer.parseInt(s.substring(i * 8, (i + 1) * 8), 2);
} 
```

然后你应该能够`FileOutputStream`非常简单地将字节写入。

另一方面，如果您寻求效率，您应该考虑不使用字符串来存储开始的位，而是直接在压缩器中构建字节。

# user-interface - 如何允许其他人创建相互交互的 Java、.NET、Ruby、PHP、Perl Web 用户界面组件？

> ID：93846
> 
> 赞同：0
> 
> 时间：2008-09-18T15:55:10.443
> 
> 标签：user-interface, integration, components

如何允许其他人创建相互交互的 Java、.NET、Ruby、PHP、Perl Web 用户界面组件？

例如，一个用 .NET 编写的 web ui 组件选择一个客户，而另一个用 Java、Ruby 或 PHP 编写的 web 用户界面组件能够刷新显示来自不同系统的选定客户的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T15:56:28.193

查找称为 WebServices、SOAP 和 XML-RPC 的东西。应该让你顺利上路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T16:05:40.620

使用 Web 服务来包装您希望跨接口共享的公共代码/库。所有列出的平台都对 Web 服务提供了不错的支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T16:08:32.047

实际上，.Net 可以在本地运行所有这些语言，因为它可以在 MSIL 中转换所有这些语言，前提是您安装了正确的编译器。

为此，您可以使用 Visual Studio 并使用各种语言创建项目。导入您的代码并对其进行调整以适应 .net 库。一个认为这是很多工作，但如果你别无选择，没有很多其他的选择:-(

无论如何，最好将自己限制在 1 或 2 种语言中，否则维护将成为一场噩梦。

# asp.net - 如何在审计触发器中使用 system_user 但仍使用连接池？

> ID：93848
> 
> 赞同：2
> 
> 时间：2008-09-18T15:55:19.957
> 
> 标签：asp.net, sql, sql-server, connection, pool

我想做以下两件事：

1.  在我的数据库表上使用审计触发器来识别哪个用户更新了什么；
2.  使用连接池来提高性能

对于#1，我在数据库触发器中使用“system_user”来识别进行更改的用户，但这阻止了我执行需要通用连接字符串的#2。

有没有办法让我在这两个世界中都得到最好的？

ASP.NET/SQL Server 2005

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T17:45:41.300

将 Web 应用程序中的用户存储在数据库中，并让触发器关闭存储的数据。让 Web 应用程序处理将所有日志记录信息写入数据库可能会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T16:39:47.963

抱歉不行。仅从数据库连接识别用户和在用户之间共享数据库连接是互斥的。

# ruby-on-rails - 如何在 Rails 中修复/调试'expected x.rb to define X.rb'

> ID：93853
> 
> 赞同：22
> 
> 时间：2008-09-18T15:55:46.930
> 
> 标签：ruby-on-rails, ruby

我已经看到这个问题在许多不同的情况下出现，并希望获得在 StackOverflow 上修复/调试它的最佳实践。

举一个现实世界的例子，这是我今天早上想到的：

```
expected announcement.rb to define Announcement 
```

该课程在开发、测试*和*生产控制台中运行良好，但在生产 Mongrel 中失败。这是课程：

```
class Announcement < ActiveRecord::Base
  has_attachment :content_type => 'audio/mp3', :storage => :s3
end 
```

我想在答案中解决的问题不是解决这个特定问题，而是如何正确调试以让 Rails 给你一个有意义的错误，正如预期的 x.rb 来定义 X.rb' 通常是一个红鲱鱼。 .

**编辑（到目前为止，有 3 个很好的回应，每个都有部分解决方案**）

**调试：**

1.  来自 Joe Van Dyk：尝试通过导致错误的环境/实例上的控制台访问模型（在上述情况下：脚本/控制台生产，然后输入“公告”。

2.  来自 Otto：尝试通过初始化程序设置一个最小插件集，例如：config.plugins = [ :exception_notification, :ssl_requirement, :all ] 然后一次重新启用一个。

**具体原因：**

1.  来自 Ian Terrell：如果您使用的是 attachment_fu，请确保您安装了正确的图像处理器。即使您没有附加图像， attachment_fu 也会需要它。

2.  来自 Otto：确保您没有命名与内置 Rails 类冲突的模型，例如：Request。

3.  来自 Josh Lewis：确保您的应用程序（或 Gem 列表）中没有重复的类或模块名称。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T16:36:57.907

这是一个棘手的问题。

通常对我有用的是在生产服务器上运行“脚本/控制台生产”，然后输入：

`Announcement`

这通常会给你一个更好的错误信息。但你说你已经试过了？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-10T16:46:38.143

我也遇到了这个错误。

简而言之，我的 lib 文件夹中的 rb 文件不在与我的模块命名约定匹配的文件夹结构中。这导致 ActiveSupport 自动加载器使用错误的模块来查看是否定义了我的类常量。

具体来说，我定义了以下类

```
module Foo
  class Bar
  end
end 
```

在 /lib/bar.rb 的根目录中

这导致自动加载器询问模块 Object 是否定义了 Bar 而不是模块 Foo。

将我的 rb 文件移动到 /lib/foo/bar.rb 解决了这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T17:40:18.160

我以前遇到过这种情况，`AttachmentFu`应该归咎于插件。我相信在我的情况下，这是由于`AttachmentFu`期望的图像处理器与可用的图像处理器不同，或者还安装了不受支持的版本。当我明确地将`:with => :rmagick`（或类似的——我使用 RMagick）添加到`has_attachment`方法调用*中时，即使是非图像附件，问题也得到了解决。* 显然，请确保您的生产环境安装了所有正确的 gem（或将它们冻结到您的应用程序中）和支持软件 (ImageMagick)。YMMV。

至于没有让 Rails 和 AttachmentFu 吸收并隐藏真正的错误——我们在完全弄清楚之前修复了它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-25T03:19:15.120

由于这仍然是谷歌的最高结果，我想我会分享为我解决问题的方法：

我在 lib 文件夹中有一个与我的应用程序同名的模块。所以，我的模块名称有冲突，但我也有文件夹名称的冲突（虽然不确定后者是否真的有所作为）。

因此，对于 OP，请确保您的应用程序（或 Gem 列表）中的某处没有重复的类或模块名称。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-24T02:07:30.083

对我来说，原因是我的类定义中存在循环依赖，而问题只出现在 Rails 中使用自动测试。就我而言，我不需要循环依赖，所以我只是删除了它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T21:04:54.987

您可以尝试禁用所有插件并将它们一一添加。

在`environment.rb`Initalizer 部分中，添加如下一行：

```
config.plugins = [ :exception_notification, :ssl_requirement, :all ] 
```

从运行您的应用程序的最低设置开始，然后将它们一一添加。当我定义一个恰好映射到现有文件名的模型时，我通常会收到此错误。例如，一个 Request 模型，但 Rails 已经有一个 request.rb 被首先加载。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-29T09:21:41.420

我有一段时间遇到这个问题，在我的情况下，这个错误总是出现在这个 S3 错误之前：

> （AWS::S3::Operation Aborted）“当前正在针对此资源进行有冲突的条件操作。请重试。”

反复创建同一个存储桶时，通常会出现此问题。（来源[AWS 开发者论坛](http://developer.amazonwebservices.com/connect/message.jspa?messageID=103933#103933)）

这是因为我使用`attachment_fu to`了创建存储桶并且我已经取消了包含命令的行`Bucket.create(@@bucket_name)`（`lib/technoweenie/attachment_fu/backends/s3_backends.rb`靠近第 152 行）。

一旦评论或删除命令`Bucket.create(@@bucket_name)`，问题就消失了。

我希望这有帮助。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-05T15:26:33.577

在使用 STI 时更改类名对我来说是这样的：

*   类别从“EDBeneficiary”更改为“EdBeneficiary”
*   现有记录的“类型”列中存储了“EDBeneficiary”，因此当 Rails 尝试加载它们时，会引发异常。

修复：运行迁移以更新“类型”列中的值以匹配新类名。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-06-17T18:57:00.793

就我而言，我在开发控制台中收到此错误，但我可以在 irb 中加载该类

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-07-13T02:11:36.863

抱歉，这不是一个明确的答案，而是另一种可能在某些特定情况下有效的方法：

我刚刚在使用 Ruby 1.8.7 和 Merb 1.0.15 调试站点时遇到了这个问题。似乎有问题的类（我们称之为 SomeClass）超出了范围，但是当 some_class.rb 文件被自动加载时，它需要的其他文件（some_class/base.rb 等）没有被 require 机制加载。可能是需求中的错误？

如果我之前需要 some_class 文件，例如 environment.rb 的结尾，它似乎可以防止对象超出范围。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-22T08:45:18.247

由于控制器定义位于未命名为控制器的文件中，因此出现此错误。例如，您有一个 Comment 模型，并在 comment.rb 文件中定义控制器而不是 comments_controller.rb

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-11-07T23:05:18.983

我在使用 rails 1.2.3 版时遇到了这个问题。我只能用 mongrel 重现这个问题，使用控制台环境访问并没有提供任何有用的信息。就我而言，我解决了使 RAILS_ROOT/html 文件夹可被 mongrel 写入，然后重新启动 Web 服务器的问题，正如一些用户在此处报告的那样：

[http://www.ruby-forum.com/topic/77708](http://www.ruby-forum.com/topic/77708)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-10-01T12:59:30.193

当我为我的应用程序从 1.1.6 升级到 1.2.6 和 2.0.5 时，我遇到了这个错误。简而言之，旧插件导致了这个错误。这些插件已经过时并且不再更新（甚至没有回购！）。删除它们后，该应用程序在 1.2.6 和 2.0.5 上运行。但是我没有检查插件的详细源代码。

# .net - HRESULT：0x80131040：定位程序集的清单定义与程序集引用不匹配

> ID：93879
> 
> 赞同：73
> 
> 时间：2008-09-18T15:58:05.410
> 
> 标签：.net, nunit, ncover

找到的程序集的清单定义与程序集引用不匹配

通过 ncover 运行 nunit 时得到这个。任何想法？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-09-18T19:17:05.340

这是程序集之间的不匹配：从程序集引用的 DLL 没有预期的方法签名。

清理解决方案，重建所有内容，然后重试。

另外，如果这是对 GAC 中某些内容的引用，请小心；可能是某个地方指向了不正确的版本。确保（通过每个引用的属性）选择了正确的版本或将特定版本设置为 false。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-09-10T17:40:41.317

我最近遇到了这个问题，我在有问题的 dll 上运行了“depends.exe”。它向我展示了 dll 是在 x86 中编译的，而一些依赖项是在 x64 中编译的。

如果您仍然遇到问题，我建议您使用depends.exe。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-10-08T06:03:32.623

In my case for a wcf rest services project I had to add a runtime section to the web.config where there the requested dll was:

```
 <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="DotNetOpenAuth.Core" publicKeyToken="2780ccd10d57b246" />
        <bindingRedirect oldVersion="0.0.0.0-4.1.0.0" newVersion="4.1.0.0" />
      </dependentAssembly>
.
.
.
  <runtime> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-08-30T05:48:41.180

通过删除所有运行时部分解决了我的问题

```
<runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <dependentAssembly>
                <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35"/>
                <bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="3.0.0.0"/>
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35"/>
                <bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="3.0.0.0"/>
            </dependentAssembly>
        </assemblyBinding>
    </runtime> 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-07-30T15:53:39.193

当测试环境的其中一个 DLL 的版本与开发环境不匹配时，通常会发生这种情况。

**清理并构建您的解决方案，并将您的所有 DLL 带到发生错误的环境中，应该修复它**

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-06-08T08:26:44.193

只需删除 bin 文件夹，然后项目将重新创建所有内容，它现在就可以工作了。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-11-06T18:17:07.557

I ran into similar problems when accessing the project files from different computers via a shared folder. In my case clean + reabuild did not help. Had to delete the bin and objects folders from the output directory.

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-02-02T13:19:38.910

就我而言，我在调试时收到了这条消息：

```
"Error while calling service <ServiceName> Could not load file or assembly 'RestSharp, 
Version=105.2.3.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. 
The located assembly's manifest definition does not match the assembly reference.
(Exception from HRESULT: 0x80131040)" 
```

**原因**

在我的项目中，我有 2 个使用 RestSharp 的内部组件，但两个组件都有不同版本的 RestSharp（一个带有 version `105.2.3.0`，另一个带有 version `106.2.1.0`）。

**解决方案**

要么将其中一个组件升级到更新版本，要么将另一个组件降级。就我而言，在 NuGet 包管理器中降级和更新组件对我来说更安全`106.2.1.0`。`105.2.3.0`所以两个组件具有相同的版本。

重建，它没有问题。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-12-04T12:51:01.050

在我的特殊情况下，我是`CreateObject`在 VBScript 中完成的。在我的情况下，原因是 GAC 中的程序集版本比我编译的版本旧。（试图解决一个较早的问题，我在 GAC 中安装了程序集）。

因此，如果您正在使用 COM 可见类，请确保在向 RegASM 注册新程序集之前从 GAC 中删除旧版本的程序集。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-12-09T11:48:27.560

就我而言，这是因为 WebGrease 而发生的。我将它更新到最新版本（使用 NuGet），但它与依赖项冲突。我在 web.config 中手动添加了以下代码，它起到了作用。

```
<dependentAssembly>
    <assemblyIdentity name="WebGrease" culture="neutral" publicKeyToken="31bf3856ad364e35" />
    <bindingRedirect oldVersion="0.0.0.0-1.6.5135.21930" newVersion="1.6.5135.21930" />
</dependentAssembly> 
```

请注意，我的解决方案仅在错误与 WebGrease 相关时才有效。错误代码将保持不变。此外，您需要相应地更改 oldVersion 和 newVersion 中的版本。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-01-13T23:43:46.377

我在一个 web api 项目中遇到了这个问题。

Api 项目使用的是版本 3 的库的 nuget 包。其中一个引用的程序集说 X 使用的是版本 2 的同一 nuget 包的旧版本。

每当构建引用的程序集或重建引用 X 的任何其他项目时，api 项目的程序集都会更新为较低版本。并得到这个程序集参考错误。

重建工作，但就我而言，我想要一个长期的解决方案。

我使程序集引用了相同版本的 nuget 包。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-03-02T12:24:42.287

我遇到了找不到 PayPal 程序集的问题，这是因为我将解决方案命名为 PayPal。我相信这不会是任何人的答案，但我想我还是会分享它：[C# ASP.NET MVC PayPal not find assembly](https://stackoverflow.com/questions/35701635/c-sharp-asp-net-mvc-paypal-not-finding-assembly)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-01-29T10:46:27.973

这里只是另一个案例。在第一次将 XML 文件反序列化为 VS2010/.NET 4 下的对象时，我从 Managed Debugging Assistant 遇到了这个错误。包含对象类的 DLL 是在构建后事件中生成的（通常是 Microsoft 风格的东西）。在同一解决方案中的多个项目中工作得非常好，在另一个项目中这样做时出现了问题。错误文字：

> 检测到 BindingFailure 消息：显示名称为 MyProjectName.XmlSerializers 的程序集未能加载到 ID 为 1 的 AppDomain 的“LoadFrom”绑定上下文中。失败的原因是：System.IO.FileLoadException：无法加载文件或程序集MyProjectName.XmlSerializers、Version=1.0.0.0、Culture=neutral、PublicKeyToken=null' 或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）

由于这里的一些答案表明平台不匹配，我注意到 3 个项目和解决方案选择了“混合平台”配置，并且 3 个项目是为 x86 而不是 AnyCPU 编译的。我没有特定于平台的代码（尽管一些供应商提供的 DLL 依赖于一些 x86 库）。我将所有出现的 x86 替换为 AnyCPU：

```
for a in $( egrep '(x86|AnyCPU)' */*.csproj *.sln -l  ) ; do echo $a ; sed -i 's/x86/AnyCPU/' $a ; done 
```

然后项目将构建，但所有运行或调试代码的选项都将显示为灰色。重新启动 VS 无济于事。

为了以防万一，我用 git 恢复了对 x86 库的引用，但为我编译的所有代码保留了 AnyCPU。

对于Winform[应用程序，F5 或开始调试按钮显示为灰色？](https://stackoverflow.com/questions/22398767/f5-or-start-debugging-button-is-greyed-out-for-winform-application)我卸载并重新加载了启动项目（这也是最初出现问题的项目）。

在那之后，一切都恢复原状：程序可以正常工作，没有最初的错误。

请参阅[http://www.catb.org/jargon/html/R/rain-dance.html](http://www.catb.org/jargon/html/R/rain-dance.html)、[http://www.catb.org/jargon/html/V/voodoo-programming.html](http://www.catb.org/jargon/html/V/voodoo-programming.html)或[http://www .catb.org/jargon/html/I/incanation.html](http://www.catb.org/jargon/html/I/incantation.html)和那里的链接。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-01-16T13:36:11.300

如果您在尝试向 Visual Studio 添加组件时遇到此错误，`Microsoft.VisualStudio.TemplateWizardInterface`--（在尝试安装奇怪的开发工具之后）

考虑这个解决方案（由 larocha 提供（谢谢，无论你是谁））：

1.  在文本编辑器中打开 C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe.config
2.  找到这个字符串：“ `Microsoft.VisualStudio.TemplateWizardInterfac`e”
3.  注释掉该元素，使其看起来像这样：

`<dependentAssembly>
<!-- assemblyIdentity name="Microsoft.VisualStudio.TemplateWizardInterface" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" / -->
<bindingRedirect oldVersion="0.0.0.0-8.9.9.9" newVersion="9.0.0.0" />
</dependentAssembly>`

来源：[http ://webclientguidance.codeplex.com/workitem/15444](http://webclientguidance.codeplex.com/workitem/15444)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-02-18T00:12:41.850

当我更新 web.config 而不更新所有引用的 dll 时，这发生在我身上。

使用适当的 diff 过滤器（注意 Meld 的默认目录比较过滤器忽略二进制文件）差异被识别，文件被复制并且一切正常。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-09-12T14:42:23.917

在 Designer 中工作时出现此错误。我一直在 VS 2012 中进行开发，但在过去的几天里“升级”到了 2017 年。解决方案是关闭并重新打开 VS。

这可能与我在[其他地方](https://developercommunity.visualstudio.com/content/problem/28126/unable-to-add-reference-in-visual-studio-2017-refe.html)看到的一个错误有关，参考管理器不起作用？在这种情况下，尝试在解决方案资源管理器中添加引用时会遇到以下错误消息：

> “对 COM 组件的调用已返回错误 HRESULT E_FAIL。”

我的解决方法是关闭解决方案，在 VS2012 中重新打开，添加引用，关闭 2012 并重新打开 2017。可笑的是，2017 应该已经发布了如此明显的错误。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-12-01T15:04:09.717

我的 WPF 项目引用了 3 个自定义 dll。我更新了其中一个，删除了引用并添加了对新 dll 的引用。它还在参考的属性中显示了正确的版本号。它正在重建而没有错误。

但是当应用程序运行时，出现“定位程序集的清单..”失败，提到旧版本。

在搜索了几个小时的解决方案并阅读了几个这样的线程后，我想起了其他 dll。其他 dll 之一是引用旧版本，这就是发生故障的原因。在我的 WPF 项目中重建第二个 dll 并重新创建两个引用后，失败就消失了。

**不要忘记检查您的其他 dll！**

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2022-01-25T17:52:55.693

对我来说，问题出在应用程序文件版本中，它是 3.3.1，我正在将新版本构建为 20.0.1，当将版本重置为相同的值时，它可以正常工作。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-03-10T10:39:00.707

我只是从项目中删除 settings.lic 文件并开始工作！

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-05-03T09:42:23.203

只需检查您的 webconfig 文件并删除此代码：-

```
<dependentAssembly>
    <assemblyIdentity name="itextsharp" publicKeyToken="8354ae6d2174ddca" culture="neutral" />
    <bindingRedirect oldVersion="0.0.0.0-5.5.13.0" newVersion="5.5.13.0" />
  </dependentAssembly> 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-11-25T06:55:37.463

I tested All the solutions above but didn't work out for me, after consideration all situations found out the problem is somewhere else, it was so awkward.
I have two different branches for the same project on different folders, the problem was from the other branch.
I updated nuget packages (for the mentioned package on error page) on both branches and the problem solved!

# asp.net - 如何将 asp.net 会话显式设置为仅在关闭浏览器或显式登录时过期？

> ID：93888
> 
> 赞同：6
> 
> 时间：2008-09-18T15:59:26.190
> 
> 标签：asp.net, session

默认情况下，会话到期时间似乎是 20 分钟。

更新：我不希望会话在浏览器关闭之前过期。

Update2：这是我的场景。用户登录网站。在现场播放。离开电脑去洗澡（>20 分钟；））。回到电脑前，*应该*可以玩了。他关闭浏览器，这会删除会话 cookie。下次他从新的浏览器实例访问该站点时，他需要再次登录。

在 PHP 中，我可以将 php.ini 中的 session.cookie_lifetime 设置为零来实现这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T16:48:29.643

如果您想将会话延长到 20 分钟以上，您可以使用 IIS 管理员更改默认设置，或者您可以在 web.config 文件中进行设置。例如，在 web.config 中将超时设置为 60 分钟：

```
<configuration>
  <system.web>
    <sessionState timeout="60" />
    ... other elements omitted ...
  </system.web>
  ... other elements omitted ....
</configuration> 
```

您可以使用以下代码对特定用户执行相同操作：

```
Session.Timeout = 60 
```

无论您选择哪种方法，您都可以将超时更改为您认为合理的任何值，以允许您的用户做其他事情并仍然保持他们的会话。

当然也有缺点：对于用户来说，可能存在让他们的浏览器无人看管并且在其他人开始使用它时仍然登录的安全问题。对您来说，服务器上的内存使用问题 - 会话持续时间越长，您将在任何时候使用的内存越多。这是否重要取决于服务器上的负载。

如果您不想猜测合理的延长超时时间，则需要使用已经建议的其他技术之一，需要在浏览器中运行一些 JavaScript 定期 ping 服务器和/或在页面卸载时放弃会话（当然，前提是用户不会访问您网站上的其他页面）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T16:10:57.080

您可以设置一个较短的会话超时（例如 5 分钟），然后让页面定期轮询服务器，方法是使用 Javascript 每 2 分钟触发一次 XmlHttpRequest，或者使用隐藏的 iframe 指向一个页面，该页面每2分钟。

一旦浏览器关闭，会话很快就会超时，因为没有什么可以让它保持活动状态。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T16:16:34.383

这不是一个新问题，如果您想捕获会话可以结束的所有方式，则必须处理几种情况，以下是其中一些的一般示例：

1.  浏览器实例或选项卡已关闭。
2.  用户使用相同的浏览器实例或选项卡离开您的网站。
3.  用户失去与互联网的连接（这可能包括用户计算机断电或任何其他方式）。
4.  用户离开计算机（或以其他方式停止与您的站点交互）。
5.  服务器断电/重新启动。

前两项必须由客户端向服务器发送信息来处理，通常您会使用 javascript 导航到快速使会话过期的注销页面。

第三项和第四项通常通过设置会话状态超时（可以是任意时间）来处理。您使用的时间量取决于找到一个允许用户使用您的站点而不会压倒服务器的值。一个非常粗略的经验法则可能是 30 分钟正负 10 分钟。但是，适当的值可能必须是另一篇文章的主题。

第五个项目是根据您存储会话的方式来处理的。以状态存储的会话将无法在重新启动后继续存在，因为它们位于计算机的内存中。存储在 db 或 cookie 中的会话将在重新启动后继续存在。你可以按照你认为合适的方式处理它。

根据我之前出现此问题的有限经验，已确定只需将会话超时设置为可接受的值即可。然而它是可以做到的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T16:01:22.517

这是默认设置。当您有会话时，它会将会话存储在“会话 Cookie”中，当浏览器关闭时会自动删除该会话。

如果您想在 2 个浏览器会话之间进行会话，则必须将 Cookie.Expired 设置为功能中的日期。

因为您谈论的会话是由服务器存储的，而不是由客户端存储的，所以您无法为所欲为。

但考虑不使用 ASP.NET 服务器端会话，而只依赖 cookie。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T16:07:20.273

不幸的是，由于网络的明确性质以及网站服务器和用户浏览器之间没有永久链接的事实，无法判断用户何时关闭了浏览器。您可以实现一些事件和 JavaScript（例如 onunload），您可以使用这些事件和 JavaScript 将调用返回到服务器，这反过来又可以“杀死”一个会话 -`Session.Abandon();`

您可以在 web.config 中设置会话的超时长度，记住此超时基于用户浏览器上次调用服务器后的时间。

未添加浏览器超时。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T16:04:01.870

如果您在窗口关闭时不以某种方式在客户端和服务器之间进行通信，则无法明确清除会话，因此我希望在接收窗口时发送一个特殊的 URI 请求来清除会话关闭消息。

我的 Javascript 不足以为您提供执行此操作的实际说明；对不起 ：（

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T16:05:57.187

您不能，因为您无法控制 html 客户端的响应方式。

实际上为什么你需要这样做？只要没有人可以拿起会话再次使用，它就会在 20 分钟后过期。如果资源确实很重要，请设置更积极的会话到期时间（大多数托管公司都这样做，这非常烦人）或在会话中使用更少的对象。尽量避免使用任何类型的对象，而只存储用于检索它们的密钥，这是一个非常重要的设计，因为它可以帮助您在变大时将会话扩展到状态服务器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T16:44:15.380

如果我误读了您的问题的意图，请纠正我，但基本问题似乎不是关于如何在用户关闭浏览器时强制会话结束，而是更多关于如何防止会话在浏览器关闭之前结束。

我认为这个问题的真正答案是重新评估你正在使用会话做什么。如果您使用它们来维护状态，我同意您可能不走运的其他回答。

但是，首选方法是使用与浏览器会话具有相同范围的持久状态机制，例如在浏览器关闭时过期的 cookie。如果该 cookie 自上次请求以来已过期，则该 cookie 可能包含足够的信息来重新启动服务器上的会话。结合相对较短（5-10 分钟）的会话超时，我认为这可以让您在服务器资源使用和不让用户不断“重新启动”站点之间取得最佳平衡。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T09:33:22.270

哦，你已经重写了这个问题。

只要javascript还活着，那是绝对可行的。使用任何定时 ajax 都可以。使用 ajax + timer 插件检查原型库[http://www.prototypejs.org](http://www.prototypejs.org) PeriodicalExecutor 或 jQuery。设置一个虚拟页面，您的执行程序会不时调用该页面，因此您的会话始终处于活动状态，除非他注销（同时杀死 ajax 计时器）或关闭浏览器（这意味着执行程序无论如何都会被杀死）

# eclipse - 无法将服务器添加到移动的工作区

> ID：93900
> 
> 赞同：44
> 
> 时间：2008-09-18T16:00:54.017
> 
> 标签：eclipse, tomcat, jakarta-ee, workspace

我从网上下载了这个工作区，并尝试从全新安装的 Eclipse Ganymede 的 tomcat 服务器上运行它。这个特定的项目带有自己的工作区。

当我选择 Tomcat v6.0 时，我收到一条消息

> 无法使用所选类型创建服务器

不过，可以使用较旧的 tomcat 版本。

我想我必须重新创建一些配置设置。问题是哪一个？这似乎是一些奇怪的错误，因为创建一个新的动态 Web 项目让我可以为它们两个配置 tomcat

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-03-31T16:58:38.550

我有类似的问题，但我的解决方案更简单一些。该问题是由重命名服务器定义引用的原始文件夹引起的。

转到 Window/Preferences/Server/Runtime Environments，删除损坏的引用。然后，单击“添加”以创建新引用，选择适当的 tomcat 版本，单击下一步，您将看到不正确的路径引用。修理它。继续。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-10T09:37:32.330

我在带有 Ganymede 和 Tomcat6 的 Ubuntu 8.10 上遇到了同样的问题。这似乎是 Eclipse 的某种错误。如果您尝试创建一个服务器，但它失败了，您将无法创建另一个 tomcat6 服务器。要更正此问题，请执行以下操作：

*   关闭日食
*   转到 {workspace-directory}/.metadata/.plugins/org.eclipse.core.runtime/.settings 目录并删除一个名为 org.eclipse.wst.server.core.prefs 的文件。
*   开始日食
*   在服务器选项卡中添加您的 tomcat6 服务器

科富

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-03T01:58:13.050

@id 感谢您的解决方案，但 org.eclipse.jst.server.tomcat.core.prefs 中也隐藏了一些东西

所以为了解决问题

*   关闭日食
*   转到 {workspace-directory}/.metadata/.plugins/org.eclipse.core.runtime/.settings
*   删除文件 org.eclipse.wst.server.core.prefs 和**org.eclipse.jst.server.tomcat.core.prefs**

**雄猫 5.5**

我为了能够使用你需要有一个可写的 catalina.policy 文件的 tomcat5.5 服务器，如中所述

*   [http://dev.eclipse.org/newslists/news.eclipse.webtools/msg16795.html](http://dev.eclipse.org/newslists/news.eclipse.webtools/msg16795.html) (= 在目录 "{$tomcat.home}/conf" (chmod -vR a+ rw {$tomcat.home}/conf/*)。更具体地说，在文件“catalina.policy”上。之后，可以在Eclipse服务器中添加Tomcat服务器）
*   （死链接）[http://webui.sourcelabs.com/eclipse/issues/239179](http://webui.sourcelabs.com/eclipse/issues/239179) 并让tomcat5.5在进入eclipse之前停止并在之后启动。

**雄猫 6**

为了能够使用 tomcat6 服务器，正确的解决方案是拥有一个 tomcat6 服务器的用户实例，如

*   /usr/share/doc/tomcat6-common/RUNNING.txt.gz
*   [RUNNING.txt](http://tomcat.apache.org/tomcat-4.1-doc/RUNNING.txt)（在 WEB 上）

我的配置是 Debian/Sid，Eclipse 3.4.1。木卫三

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-18T02:39:41.410

错误视图确实是关键。那里有很多细节——如有必要，右键单击条目并将其内容复制到您喜欢的文本编辑器中。例如，可能出现的一个问题是，如果您已经有一个服务器配置，并且其中一个配置 XML 文件无法解析，则无法添加该服务器。这件事今晚发生在我身上——我的`<Context>`元素中有一个换行符，所以它是`<C`(linebreak) `ontext>`。这阻止了 Eclipse 重新创建服务器配置。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-04T18:20:37.020

我终于让我使用默认的 Ubuntu 8.10 tomcat。（eclipse 上的调试命令行是一件很棒的事情）首先我必须创建几个符号链接，然后将权限更改为文件。（您可能需要三思而后行根据您的配置更改权限，但如果 eclipse 无法读取它抛出的文件和异常并且 gui 不会让您继续）

```
sudo ln -s /etc/tomcat6 /usr/share/tomcat6/conf
sudo ln -s  /etc/tomcat6/policy.d/03catalina.policy /usr/share/tomcat6/conf/catalina.policy
sudo chmod a+r /usr/share/tomcat6/conf/tomcat-users.xml 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T16:07:55.763

哼它可能很棘手。带来“服务器”视图。如果您的项目已经部署，请将其从服务器中删除以清除您的项目和服务器之间的绑定。

或者您可以在项目资源管理器中右键单击您的项目，然后选择服务器上的调试。如果您还没有这样做，Eclipse 应该会要求您创建一个服务器运行时，在这里您可以指定 Tomcat 6 并指定服务器安装的位置。

您还可以查看“问题”视图以查看导入的项目中的任何问题，例如 JDK 等...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-02T15:04:35.280

查看错误视图。如果您尝试设置一次但失败了，Eclipse 似乎会在稍后允许您创建一个新的之前再次尝试并查看那里。如果您已删除该文件夹或不再存在该文件夹，则需要替换它以便继续操作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-12T15:19:22.113

我发现使用 Tomcat 6 的唯一方法是将 Tomcat 目录的所有权更改为我的用户。似乎拥有 r/w 权限是不够的。

顺便说一句，删除 org.eclipse.wst.server.core.prefs 会删除您的工作区配置。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-12-15T07:56:38.153

在我进入 tomcat6 配置目录并将所有权添加给我的用户之前，我遇到了同样的问题：

> cd /usr/share/tomcat6/conf
> 
> chown root:myusername ./*
> 
> chmod 777 ./*

您可以选择一些更好的 chmod 以确保安全，777 只是一个快速的残酷修复。我从 tar 中提取了 Eclipse 3.5 (Galileo) + Fedora 12 + Tomcat 6（这就是 Eclipse 无法访问它的原因）。Eclipse 一直在抱怨“无法使用所选类型创建服务器”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T16:05:33.380

什么版本的 Eclipse？欧罗巴？木卫三？

你说的工作区是什么意思？Eclipse 工作区不是您部署的东西，它包含您的项目。

您将需要生成一个 WAR 文件（或包含 WAR 文件的文件的文件夹），一个项目通常会包含一个 ANT 或 Maven 构建脚本来执行此操作，或者如果项目使用 Eclipse 的动态 Web 项目类型，则可能有某处的“生成WAR”选项。如果没有更多细节，我将无能为力。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T17:07:36.603

将新的动态 Web 项目添加到工作区似乎“解锁”了该功能。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-15T15:42:06.713

将所有权更改为我的用户对我有用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-03T22:03:06.247

就我而言，这是损坏的 Tomcat 配置文件。Eclipse 日志说：

```
org.eclipse.core.runtime.CoreException: 
Could not load the Tomcat server configuration at 
C:\Program Files\Apache Software Foundation\apache-tomcat-6.0.14\conf. 
The configuration may be corrupt or incomplete. 
```

得到了一个新的 Tomcat 发行版，删除了旧的发行版，现在一切都很好。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-15T02:36:31.230

终于在我的系统上解决了这个问题。

1）摆脱了apt-gotten tomcats

2) 从 tomcat.apache.org 的 bins 中安装了一个典型的 tomcat

3）摆脱了我的openjdk

4）安装了sun jdk（apt-get）

5）在eclipse中删除了我的web项目

6) 注意到添加 Web 项目时您可以设置“目标运行时” - 我尝试将其设置为 Tomcat 6，它让我知道有问题

也许以上都不重要，但这可能是重要的：

7) KICKER：窗口 -> 首选项 -> 服务器 - 运行时环境。在这里删除了所有糟糕的运行时环境，并添加了我新安装的 tomcat 的路径。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-02-09T14:29:21.213

这个问题可能很旧。但我刚刚遇到了这个问题。我的项目未被识别为 Web 项目（Eclipse 中没有地球图标）。

假设您使用 maven 插件，它无法使用命令转换为 web 项目

```
mvn eclipse:eclipse -Dwtpversion=1.5 
```

在包资源管理器中，右键单击项目/配置/转换为 Java Facets 项目/Eclipse 中的动态 Web 项目 Et Voilà

在转换前后检查根目录下的 .project 文件。你会看到新的本质。

```
<natures>
    <nature>org.eclipse.jem.workbench.JavaEMFNature</nature>
    <nature>org.eclipse.wst.common.modulecore.ModuleCoreNature</nature>
    <nature>org.eclipse.jdt.core.javanature</nature>
    <nature>org.eclipse.wst.common.project.facet.core.nature</nature>
    <nature>org.eclipse.wst.jsdt.core.jsNature</nature>
</natures> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-06-18T23:39:02.987

不要删除配置设置文件，只需转到 Preferences -> Server -> Runtime Environments 并删除“被遗忘的”环境......

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-12-22T07:52:10.937

非常感谢这个答案对我有用..

我有类似的问题，但我的解决方案更简单一些。该问题是由重命名服务器定义引用的原始文件夹引起的。

转到 Window/Preferences/Server/Runtime Environments，删除损坏的引用。然后，单击“添加”以创建新引用，选择适当的 tomcat 版本，单击下一步，您将看到不正确的路径引用。修理它。继续。

# java - 如何在沙箱中使用 Rhino for Java 运行 Javascript？

> ID：93911
> 
> 赞同：36
> 
> 时间：2008-09-18T16:01:36.073
> 
> 标签：java, javascript, sandbox, rhino

我们的部分 java 应用程序需要运行由非开发人员编写的 javascript。这些非开发人员正在使用 javascript 进行数据格式化。（主要是简单的逻辑和字符串连接）。

我的问题是如何设置这些脚本的执行以确保脚本错误不会对应用程序的其余部分产生重大负面影响。

*   需要防范无限循环
*   防止产生新线程。
*   限制对服务和环境的访问
    *   文件系统（例如：如果一个心怀不满的脚本编写者决定删除文件）
    *   数据库（同样删除数据库记录）

基本上，我需要将 javascript 范围设置为仅包含他们需要的内容，而不再包含更多内容。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-16T04:45:22.250

为了防止无限循环，您可以在脚本运行时观察指令计数（这仅适用于解释脚本，不适用于编译脚本）。

[Rhino JavaDocs中](http://www-archive.mozilla.org/rhino/apidocs/org/mozilla/javascript/ContextFactory.html)有这个例子可以防止脚本运行超过十秒：

```
 protected void observeInstructionCount(Context cx, int instructionCount)
 {
     MyContext mcx = (MyContext)cx;
     long currentTime = System.currentTimeMillis();
     if (currentTime - mcx.startTime > 10*1000) {
         // More then 10 seconds from Context creation time:
         // it is time to stop the script.
         // Throw Error instance to ensure that script will never
         // get control back through catch or finally.
         throw new Error();
     }
 } 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-17T13:04:14.757

要阻止 Java 类和方法访问，请查看...

[http://codeutopia.net/blog/2009/01/02/sandboxing-rhino-in-java/](http://codeutopia.net/blog/2009/01/02/sandboxing-rhino-in-java/)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-18T16:43:57.737

为了防止无限循环，您需要将它放在一个单独的进程中，以便它可以被杀死。

为了防止创建线程，您需要扩展 SecurityManager（默认实现允许不受信任的代码访问非根线程组）。

Java 安全性确实允许您阻止对文件系统的访问。

对于数据库限制，您也许可以使用标准的 SQL 用户安全性，但这很弱。否则，您需要提供一个 API 来强制执行您的限制。

编辑：我应该指出，JDK6 提供的 Rhino 版本已经完成了安全工作，但不包括编译器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-06T21:25:54.767

我刚刚看到这篇博客文章似乎对沙盒或多或少有用（不仅仅是 Rhino）：

[http://calumleslie.blogspot.com/2008/06/simple-jvm-sandboxing.html](http://calumleslie.blogspot.com/2008/06/simple-jvm-sandboxing.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-15T14:19:47.140

如果您只是在寻找纯 JavaScript 函数，这里有一个基于 JDK 嵌入式 Rhino 库的解决方案，无需导入任何 3rd-party 库：

1.  通过 ScriptEngineManager#getEngineFactories 找出 JavaScript 脚本引擎工厂类名
2.  在新的类加载器中加载脚本引擎工厂类，其中 JavaMembers 或其他相关类将被忽略。
3.  在加载的脚本引擎工厂上调用 #getScriptEngine 并在返回的脚本引擎上调用脚本。

如果给定的脚本包含 Java 脚本，类加载器将尝试加载 JavaMembers 或其他类并触发类未找到异常。这样，恶意脚本将被忽略而不执行。

请阅读 ConfigJSParser.java 和 ConfigJSClassLoader.java 文件了解更多详情：

[https://github.com/webuzz/simpleconfig/tree/master/src/im/webuzz/config](https://github.com/webuzz/simpleconfig/tree/master/src/im/webuzz/config)

* * *

## 回答 #6

> 赞同：-9
> 
> 时间：2008-09-18T16:09:13.777

Javascript 是单线程的，无法访问文件系统，所以我认为您不必担心这些。我不确定是否有办法设置超时以防止无限循环，但你总是可以产生一个执行脚本的（Java）线程，然后在这么长时间后终止线程。

# python - 有哪些 Python GUI API？

> ID：93930
> 
> 赞同：12
> 
> 时间：2008-09-18T16:03:37.817
> 
> 标签：python, user-interface, api

简单的问题：

*   有哪些 Python GUI API 以及任何给定 API 的优势是什么？

我不是在这里寻找一场宗教战争，我只是想很好地处理 Python GUI API 方面的所有内容。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-18T16:04:43.180

[这是一个很好的清单。](http://wiki.python.org/moin/GuiProgramming)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-18T22:37:04.983

我用过 Tkinter 和 wxPython。Tkinter 非常基础，不使用本机小部件。这意味着 Tkinter 应用程序在任何平台上看起来都一样——这听起来很吸引人，但实际上，这意味着它们在任何平台上看起来都很丑：-/ 不过，它很容易使用。我在学习时发现[Thinking in Tkinter](http://www.ferg.org/thinking_in_tkinter/index.html "在 Tkinter 中思考")非常有用，因为我以前从未做过任何 GUI 编程。但是，如果您熟悉框架和布局算法以及按钮和绑定等内容，则可以跳过该步骤。

您可以使用 Tix 增强 Tkinter（但请注意，Tix 不能与 py2exe 配合使用）。还可以查看 Python Megawidgets，它使用 Tkinter 基础构建了一些更高级的控件。

最后，Tkinter 与 shell 配合得很好：您可以启动解释器，执行诸如 'import tkinter' 'tk = tkinter.Tk()' 之类的操作，并以交互方式构建您的 GUI（它会响应）。（不过，我认为如果您使用 IDLE，这将不起作用）

wxPython 的外观要好得多，并且附带了更多的控件。它是跨平台的（虽然在我的 Mac 上看起来有点挑剔）并且在每个平台上都使用本机控件。不过，这有点令人困惑。它还附带一个演示应用程序，展示了它的大部分功能，并提供了一个测试平台供您进行试验。关于 wxPython 的一些具体想法：

*   有三种 (?) 不同的方式来布置小部件。忽略其中两个；只需使用 Sizer。即便如此，您也可以仅使用 BoxSizer 和 GridBagSizer 进行任何布局。
*   所有 wx 小部件都有 ID。你不需要关心 ID 是什么，但在过去（我认为）你确实需要知道，所以一些旧代码会被明确的 ID 分配所淹没。并且大多数演示代码在任何地方都会有 -1 作为 ID 参数（尽管这些方法都有 ID 作为关键字参数，无论如何默认为 -1）。
*   确保您获得了标准的 wxWidgets 文档以及 wxPython Demo——您都需要它们。
*   如果您想将 wxPython 与 py2exe 一起使用，并且希望它在 Windows XP 上看起来不错，则需要在 setup.py 中添加一些技巧。看[这里](http://mail.python.org/pipermail/python-list/2004-June/268126.html "wxPython 和 py2exe 的 Windows XP 清单")

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T16:06:07.593

如果您对 Qt 有经验或兴趣，那么 PyQt 非常好。

[http://www.riverbankcomputing.co.uk/software/pyqt/intro](http://www.riverbankcomputing.co.uk/software/pyqt/intro)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T16:12:15.347

大多数 python GUI API 将封装最常见的 c/c++ GUI API。你有一个用于 gtk 的 python 包装器、一个用于 qt 的 python 包装器、一个用于 .NET 的 python 包装器等。

所以这真的取决于你的需求是什么。如果您正在寻找在 Linux、Mac 和 Windows 上绘制具有原生外观的小部件的最简单方法，请使用 wxPython（WX 小部件的 Python 包装器）。如果跨平台不是您的需求之一，那么其他库可能会更有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T16:25:51.133

我不会发布您的选项列表，而是给出我的拙见：

我爱上了 wxPython。

在 Tcl 时代，我曾在 C++ 和 Tk 中使用过 Qt，但真正让我喜欢 wxPython 的是你使用它获得的演示。在演示中，您可以浏览作为框架一部分的所有不同的小部件框架等，查看源代码并实际查看它在运行时的外观。

我在构建和安装 Linux 版本时遇到了一些问题，但现在我有了它，我一直都在使用它。我已经将 wxPython 用于小型数据分析应用程序，并且我编写了几个与比较测试结果、合并源代码等相关的内部工具。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T16:40:49.567

我发现这个链接很久了：[http](http://www.awaretek.com/toolkits.html) ://www.awaretek.com/toolkits.html 。它建议根据您的标准进行拍摄。对我来说，它一直建议使用 wxPython。无论如何，它会为您提供各种工具包的大量分数。适合我的可能不适合你。但它会告诉你所有的takeits如何根据你的标准进行评分，所以如果你因为某种原因不喜欢顶级工具包，你可以看到哪些最接近你的标准。

QT/GTK/WxWidgets（以前的 wxWindows）似乎是最成熟的跨平台 GUI 工具包之一。唯一的问题是没有安装 Python 的默认安装，因此您可能必须编译库。如果您想要无需安装即可运行的东西，那么请使用 TKInter，因为如前所述，它默认使用 Python 安装。

无论如何，我的标准是易用性为 9，文档/小部件成熟度为 10，安装基础为 10，gui 代码生成器为 5，windows/linux 的本机外观和感觉为 10，最后两个为 1 和 5，我'我对 Mac OSX 不太感兴趣（即使这里有 10 也建议使用 wxpython）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-18T17:21:42.810

[PythonCard](http://pythoncard.sourceforge.net/)真的很容易使用。这就是我推荐的。

这是他们的文章：

> PythonCard 是一个 GUI 构建工具包，用于使用 Python 语言在 Windows、Mac OS X 和 Linux 上构建跨平台桌面应用程序。
> 
> PythonCard 的座右铭是“简单的事情应该是简单的，复杂的事情应该是可能的”。
> 
> 如果您想以最少的工作量和编码快速轻松地开发图形应用程序，PythonCard 非常适合您。Apple 的 HyperCard 是我们的灵感之一；简单，但功能强大。
> 
> PythonCard 使用 wxPython。如果您已经熟悉 wxPython，只需将 PythonCard 视为一种编写 wxPython 程序的更简单方法，其中包含大量示例和工具供您复制和子类化，以及帮助您构建跨平台应用程序的工具。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-18T23:49:41.283

> EasyGUI 与其他 GUI 的不同之处在于 EasyGUI 不是事件驱动的。它允许您以传统的线性方式进行编程，并在需要时为简单的输入和输出设置对话框。如果您还没有学习 GUI 编程的事件驱动范式，EasyGUI 将使您能够立即高效地完成非常基本的任务。稍后，如果您希望过渡到事件驱动的 GUI 范例，您可以使用更强大的 GUI 包来实现，例如 anygui、PythonCard、Tkinter、wxPython 等。

[易贵网站](http://easygui.sourceforge.net/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-08-24T00:13:47.577

WX 在 Mac 上有问题。

我在这里看了一下，因为我想获得一个事件驱动的 GUI API 来在 Python 中做一些事情。作为 MatPlotLib 的一部分，我在我的 mac 上安装了 wx，但它不能正常工作。它不会从键盘输入。我已经在三个不同的 Mac 操作系统上安装了 3 次，虽然第一次可以正常工作，但另外两次我遇到了这个问题。

这个版本我使用的是 Enthought 的发行版，所以不需要安装。当我单独安装它时，有很多依赖安装，所以它是一个试用安装。

从我在这里阅读的内容来看，我会给 Tkinter 一个机会，因为这需要简单且跨平台，但我想我只是与您分享以上内容。我喜欢 Mac OS 有很多不同的原因，但是 python 工具在 Windows（可能还有其他 Linux）上安装起来要容易得多。我只是想我会在这里给出一个Mac的观点。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T16:15:25.400

我喜欢 wxPython 或 Tk。

Tk 带有标准的 Python 发行版，因此您不需要安装任何其他东西。

wxPython (wxWigets) 看起来更强大，看起来更漂亮。它也可以很好地跨平台运行（尽管并不完美，因为它在不同的系统类型上使用了不同的底层图形 API）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-19T14:29:51.253

我更喜欢 PyGTK，因为我是一个 GNOME 人。使用 PyGTK 对我来说感觉很 Python。代码组织感觉一致，文档干净透彻，而且它是一个非常容易习惯的工具包（可能是 Treeviews 除外）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-11-10T20:04:48.070

不存在用于 Python 的易于使用的 GUI 创建器。考虑到像 AutoIt 和 AutoHotkey 这样的小型脚本语言具有出色且非常易于使用的 GUI 制造商，这真是太神奇了。来吧，Python的追随者，你不能做得更好吗？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T19:15:28.247

我已经使用[wxPython](http://www.wxpython.org)几年了，我非常喜欢它。wxPython 最棒的地方在于，在它运行的不同平台上，UI 都感觉是原生的（在 Windows 和 Linux 上表现出色，但在 OS/X 上则不那么好）。

API 缺乏一些一致性，但你很快就会习惯它。

您可以查看[Testuff](http://www.testuff.com)（无耻的插件，因为它是我自己的产品）来了解使用 wxPython 可以做什么（尽管我必须说，付出了相当多的努力）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-22T08:29:01.173

wxPython，我假设 PyGTK 也可以使用 wxGlade 来帮助您设计您将创建的大多数 UI。这是一个很大的优势。在准备好之前，您不必学习如何手动编写 GUI。我直接从 wxGlade 制作了几个 GUI 程序，直到我对 wxPython 的工作方式感到足够熟悉以进行手动编码。

PyQt 有一个类似的图形布局设备，但我从来没有运气好让 PyQt 正确编译。也缺乏说明如何创建最终 Python 代码的教程和文档；我发现的许多文档都提到了 Qt 的 C++ 版本。

Tkinter 适合快速和肮脏的程序，但实际上，如果您使用 wxGlade，使用 wxPython 制作程序可能会更快。至少，您可以使用 wxGlade 向客户端显示程序的可视化表示，而不是花时间手动编写“虚拟”程序。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-09-23T10:35:31.420

有 python 特定的 gui-api，例如 kivy（后继或 pymt）、pygui（基于 pyrex）、pyui 和 nufox，它们无法与更强大的工具包（如 wxpython、pyqt、pygtk 和 tkinter）相比。

它们只是额外的可选工具。

它们唯一的独特之处在于它们是特定于 python 的 api，就像有 prima (perl-specific api) 和 shoes (ruby-specific api) 一样。它有助于我们理解，当 tk 是 api 的基于 tcl 的端口时（而其他是基于 c 和 c++ 的），那么这些 api 是专门为各自的三种脚本语言完成的。

其中，kivy 是最健壮的，而 pygui 的编码被提到非常类似于 python，pyui 最不健壮但值得尝试，所有这些都应该是可移植的，无论 python 或基于 python 的应用程序在哪里。

然后是jpype，它是一个可以与jython和pydev一起使用的工具包，它实际上是在python/jython-interface下定制的java的japi。

# string - Visual Basic 6 中的字符串空间不足

> ID：93932
> 
> 赞同：11
> 
> 时间：2008-09-18T16:03:42.170
> 
> 标签：string, memory, vb6

我们在通过 TCP 套接字来回发送数据的 VB6 应用程序中遇到错误。我们得到一个运行时错误“字符串空间不足”。有没有人看到这个或有任何想法为什么会发生这种情况？似乎我们正在达到一些 VB6 阈值，因此任何其他想法也会有所帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T16:30:06.770

正如其他人指出的那样，VB中的每个字符串连接都会分配一个新字符串，然后复制数据，然后尽可能取消分配原始字符串。在循环中，这可能会导致问题。

要解决此问题，您可以创建一个简单的 StringBuilder 类，如下所示：

```
Option Explicit

Private data As String
Private allocLen As Long
Private currentPos As Long

Public Function Text() As String
  Text = Left(data, currentPos)
End Function

Public Function Length() As Long
  Length = currentPos
End Function

Public Sub Add(s As String)

  Dim newLen As Long
  newLen = Len(s)
  If ((currentPos + newLen) > allocLen) Then
    data = data & Space((currentPos + newLen))
    allocLen = Len(data)
  End If

  Mid(data, currentPos + 1, newLen) = s
  currentPos = currentPos + newLen

End Sub

Private Sub Class_Initialize()
  data = Space(10240)
  allocLen = Len(data)
  currentPos = 1
End Sub 
```

此类将通过强制构建带有空格的字符串然后根据需要覆盖空格来最小化字符串分配的数量。当它发现它没有足够的预初始化空间时，它会重新分配大约两倍的大小。Text 方法将返回实际使用的字符串部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T16:14:44.857

在 MSDN 上找到的文本：

[http://msdn.microsoft.com/en-us/library/aa264524(VS.60).aspx](http://msdn.microsoft.com/en-us/library/aa264524(VS.60).aspx)

> Visual Basic for Applications 参考字符串空间不足（错误 14）
> 
> 细节
> 
> Visual Basic 允许您使用非常大的字符串。但是，其他程序的要求以及您操作字符串的方式可能会导致此错误。此错误有以下原因和解决方法：
> 
> *   要求为评估创建临时字符串的表达式可能会导致此错误。例如，以下代码在某些操作系统上会导致字符串空间不足错误：

```
MyString = "Hello"
For Count = 1 To 100
MyString = MyString & MyString
Next Count 
```

> ```
>  Assign the string to a variable of another name.
> * Your system may have run out of memory, which prevented a string from 
> ```
> 
> 被分配。
> 
> 从内存中删除任何不必要的应用程序以创建更多空间。
> 
> 如需更多信息，请选择相关项目并按 F1。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T16:35:34.823

除了 Jacco 的响应之外，[vbAccelerator](http://www.vbaccelerator.com/home/VB/Code/Techniques/StringBuilder/article.asp)有一个很棒的 String Builder 类，它可以完成很多相同的事情，但更健壮一些。作者还介绍了解决方案，解释了它是如何工作的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T16:19:45.203

假设您在循环中附加数据，请确保它不会被附加到自身，这将非常迅速地消耗内存。

错误含义示例及说明：http: [//msdn.microsoft.com/en-us/library/aa264524.aspx](http://msdn.microsoft.com/en-us/library/aa264524.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T16:33:08.557

听起来您经常附加一个字符串。您可以尝试使用[StringBuilder 类](http://www.vbaccelerator.com/home/VB/Code/Techniques/StringBuilder/article.asp)

此外，您可能有一些陈旧的对象，其中包含未使用的字符串，应该被释放。可能通过记录对象分配/释放来检查循环引用`Class_Initialize/Class_Finalize`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-25T14:35:51.740

2009 年春天的某个时候，Microsoft 进行了 XP 更新，该更新会干扰 Armadillo/Silicon Realms 包装器。引发错误 14，Out of String space 的代码行不合逻辑。过大的字符串没有问题。这是一个简单的任务，我什至将其更改为“foo”，但仍然出现错误 14。我认为错误在 XP 中映射不正确。我们的答案是从 Armadillo 保护项目中删除 copyMem-11 并重新包装 exe。

# java - 您如何在不同的暂存环境中维护 java webapps？

> ID：93944
> 
> 赞同：12
> 
> 时间：2008-09-18T16:05:09.000
> 
> 标签：java, spring, configuration, web-applications

您可能有一组在开发人员机器上使用的属性，这些属性因开发人员而异，另一组用于暂存环境，还有一组用于生产环境。

在 Spring 应用程序中，您可能还希望在本地环境中而不是在生产环境中加载 bean，反之亦然。

你怎么处理这个？您是否使用单独的文件、ant/maven 资源过滤或其他方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T16:22:10.847

我只是把各种属性放在 JNDI 中。这样每个服务器都可以配置，我可以有一个war文件。如果属性列表很大，那么我将在另一台服务器上托管属性（或 XML）文件。我将使用 JNDI 来指定要使用的文件的 URL。

如果您为每个环境创建不同的应用程序文件（war/ear），那么您不会部署您正在测试的同一个 war/ear。

在我的一个应用程序中，我们使用了几个 REST 服务。我只是将根 url 放在 JNDI 中。然后在每个环境中，可以将服务器配置为与该环境的适当 REST 服务进行通信。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T16:10:29.780

我只是为每台机器使用不同的 Spring XML 配置文件，并确保从这些 Spring 配置文件加载的 bean 引用了在机器之间变化的所有配置数据位。

例如，我有一个连接到另一个应用程序的 Java RMI 接口的 web 应用程序。我的应用程序通过在 Spring XML 配置文件中配置的 bean 获取另一个应用程序的 RMI 接口的地址。我的应用程序和另一个应用程序都有开发、测试和生产实例，因此我的应用程序有三个配置文件——一个对应于适合生产实例的配置，一个用于测试实例，一个用于开发实例实例。

然后，我唯一需要明确的是哪个配置文件被部署到哪台机器上。到目前为止，我对创建 Ant 任务的策略没有任何问题，这些任务在生成我的 WAR 文件之前处理将正确的配置文件复制到适当的位置；因此，在上面的示例中，我有三个 Ant 任务，一个生成生产 WAR，一个生成开发 WAR，一个生成测试 WAR。所有三个任务都将正确的配置文件复制到正确的位置，然后调用相同的下一步，即编译应用程序并创建 WAR。

希望这有点道理...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T16:18:19.340

我们使用特定于环境的属性文件，并在构建 jars/wars 时让 ant 构建选择正确的设置。

环境特定的事情也可以通过目录服务 (JNDI) 处理，具体取决于您的应用服务器。我们使用 tomcat，我们的 DataSource 是在 Tomcat 的只读 JNDI 实现中定义的。Spring 使查找变得非常容易。

我们还使用 ant 策略从同一源项目构建不同的站点（不同的内容、安全角色等）。

有一件事给我们的构建策略带来了一些麻烦，那就是在构建运行之前文件和目录通常不存在，因此很难编写真正的集成测试（使用相同的 spring set可以在 IDE 中运行）。您还错过了一些 IDE 检查文件是否存在等的能力。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T17:22:12.620

我使用 Maven 过滤掉项目中 src/main/resources 下的资源。我将它与属性文件结合使用，以在基于 Spring 的项目中引入自定义属性。

对于默认构建，我的主目录中有一个属性文件，然后 Maven 将其用作覆盖（因此可以正确找到我的本地 Tomcat 安装之类的东西）。测试服务器和生产服务器是我的其他配置文件。一个简单`-Pproduction`的就是为我的生产服务器构建一个应用程序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-08T03:55:18.173

使用不同的属性文件并使用 ant replace 过滤器，它将根据构建完成的环境进行替换。请参阅[http://www.devrecipes.com/2009/08/14/environment-specific-configuration-for-java-applications/](http://www.devrecipes.com/2009/08/14/environment-specific-configuration-for-java-applications/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T16:15:34.620

单独的配置文件，存储在源代码控制存储库中并手动更新。通常配置不会在一个版本和下一个版本之间发生根本变化，因此同步（即使是手动）并不是真正的主要问题。

对于生产环境中的高度可扩展系统，我强烈*推荐*一种方案，其中配置文件保存在模板中，作为构建脚本的一部分，这些模板用于呈现“最终”配置文件（所有环境都应该使用相同的过程）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-04T22:05:23.153

我最近也将 Maven 用于实时或临时环境的替代配置。[使用 Maven Profiles 的生产配置](http://www.malethan.com/article/production_cfg_maven_profiles.html)。希望能帮助到你。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T16:08:52.030

我将 Ant 的副本与过滤文件一起使用。在带有变量的配置文件的目录中，我有一个目录，其中包含每个环境的文件。构建脚本知道环境并使用正确的变量文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T16:16:51.153

我有不同的配置文件夹保存目标部署的配置，我使用 ANT 来选择在文件复制阶段使用的一个。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T16:24:33.587

我们针对不同的环境使用不同的蚂蚁目标。我们这样做的方式可能有点不雅，但它确实有效。我们将告诉某些 ant 目标过滤掉不同的资源文件（这是您可以排除某些 bean 被加载的方式），加载不同的数据库属性，并将不同的种子数据加载到数据库中。我们并没有真正的 ant 专家，但我们可以通过单个命令运行具有不同配置的构建。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T16:34:07.027

我见过的一种解决方案是配置登台环境，使其与生产环境相同。这意味着每个环境都有一个具有相同 IP 范围的 VLAN，以及相同 IP 地址上的机器角色（例如，每个环境中的数据库集群 IP 始终为 192.168.1.101）。防火墙将面向外部的地址映射到 Web 服务器，因此通过在您的 PC 上交换主机文件，可以使用相同的 URL - [http://www.myapp.com/webapp/file.jsp](http://www.myapp.com/webapp/file.jsp)将进入暂存或生产，具体取决于您在哪个主机文件上交换了。

我不确定这是一个理想的解决方案，维护起来相当繁琐，但值得注意的是一个有趣的解决方案。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T16:40:27.277

Caleb P 和 JeeBee 可能有您最快的解决方案。此外，您不必设置不同的服务或指向不同机器上的文件。您可以通过使用 ${user.name} 变量或通过在 Ant 或 Maven 的 -D 参数中指定配置文件来指定您的环境。

此外，在此设置中，您可以拥有一个通用属性文件，并为特定环境覆盖属性文件。Ant 和 Maven 都支持这些功能。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-27T08:35:39.123

不要忘记调查 PropertyPlaceholderConfigurer - 这在 JNDI 不可用的环境中特别有用

# linux - 如何以编程方式创建视频？

> ID：93954
> 
> 赞同：8
> 
> 时间：2008-09-18T16:06:00.383
> 
> 标签：linux, video, mpeg

是否有一个免费的库可以从图像序列中创建 MPEG（或任何其他简单的视频格式）？

它也必须在 Linux 上运行，并且最好具有 Python 绑定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T16:08:10.473

我知道有[mencoder](http://www.mplayerhq.hu/design7/news.html)（mplayer 项目的一部分）和[ffmpeg](http://ffmpeg.mplayerhq.hu/)，它们都可以做到这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T17:03:01.667

[ffmpeg](http://ffmpeg.mplayerhq.hu/index.html)是一个很棒的（开源）程序，用于构建各种视频，并将一种类型的视频（在这种情况下为一系列图像）转换为其他类型的视频。

通常它是从命令行使用的，但这实际上只是其内部库的包装器。它可以明确地[在另一个程序中使用](http://ffmpeg.mplayerhq.hu/general.html#SEC22)。

还有一些包装 c api 的[python 绑定](http://code.google.com/p/pyffmpeg/)，尽管这个特定项目似乎没有得到最好的支持（可能还有其他项目在做同样的事情）。

还有[这个链接](http://electron.mit.edu/~gsteele/ffmpeg/)，有人使用 ffmpeg 做与您正在寻找的类似的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T21:48:52.447

[GStreamer](http://gstreamer.freedesktop.org/)是一个流行的选择。它是一个完整的多媒体框架，很像 DirectShow 或 QuickTime，具有可用合法许可的编解码器的优势，并且具有出色的 Python 绑定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T16:09:52.967

在 c++ OpenCV（来自英特尔的开源计算机视觉库）中，您可以创建一个 AVI 文件，然后将帧推入...

但这就像用大炮射击苍蝇。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T16:07:46.370

不是库，但 mplayer 能够将 JPEG 序列编码为任何格式。它运行在 Linux、Windows、BSD 和其他平台上，如果你想将它与 python 一起使用，你可以编写一个 python 脚本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T16:41:20.207

ffmpeg 有一个 API 和[python 绑定](http://pymedia.org/)，似乎是要走的路！

谢谢

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-02T19:08:39.517

**ffmpeg 最小可运行 C 示例**

我在以下位置提供了一个完整的可运行示例：[如何使用 ffmpeg 的 sws_scale() 调整图片大小？](https://stackoverflow.com/questions/12831761/how-to-resize-a-picture-using-ffmpegs-sws-scale/36487785#36487785)

# windows - Windows 任务管理器中的可用页面文件是如何计算的？

> ID：93969
> 
> 赞同：1
> 
> 时间：2008-09-18T16:07:30.897
> 
> 标签：windows, memory, memory-management

在 Vista 任务管理器中，我知道可用的页面文件是这样列出的：
Page File inUse M / available M
在 XP 中它被列为 Commit Charge Limit。

我曾认为：
可用虚拟内存 = 物理内存总计 + 页面文件的总和

但是在我的机器上，我的物理内存 = 2038M，页面文件 = 4096M，可用页面文件 = 6051。这里有 83M 未计算。那是干什么用的。我认为这可能与内核内存有关，但数字似乎不匹配？

到目前为止我发现的信息：

*   有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/aa965225(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa965225(VS.85).aspx)。
*   页面文件大小可以在这里找到：计算机属性，高级，性能设置，高级。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T13:15:04.060

我认为你的猜测是正确的，它必须对内核做一些事情——内核内存也需要一些物理备份。

但是我不得不承认，在尝试验证 try 时，数字仍然不能很好地匹配，并且有大量的内存没有被考虑在内。

我有：

可用虚拟内存 = 4 033 552 KB

物理内存总计 = 2 096 148 KB

页面文件总和 = 2048 MB

内核非分页内存 = 28 264 KB

内核分页内存 = 63 668 KB

# java - Java中如何判断一个字符是否为字母？

> ID：93976
> 
> 赞同：27
> 
> 时间：2008-09-18T16:07:48.790
> 
> 标签：java, unicode

你如何检查一个字符的字符串是否是一个字母 - 包括任何带有重音符号的字母？

我最近必须解决这个问题，所以在最近的 VB6 问题提醒我之后，我会自己回答。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-18T16:10:41.373

Character.isLetter() 比 string.matches() 快得多，因为 string.matches() 每次都会编译一个新的 Pattern。即使缓存模式，我认为 isLetter() 仍然会击败它。

* * *

**编辑：**刚刚再次遇到这个，并认为我会尝试提出一些实际数字。这是我在基准测试中的尝试，检查所有三种方法（`matches()`有和没有缓存`Pattern`, 和`Character.isLetter()`）。我还确保检查了有效和无效字符，以免歪曲。

```
import java.util.regex.*;

class TestLetter {
    private static final Pattern ONE_CHAR_PATTERN = Pattern.compile("\\p{L}");
    private static final int NUM_TESTS = 10000000;

    public static void main(String[] args) {
        long start = System.nanoTime();
        int counter = 0;
        for (int i = 0; i < NUM_TESTS; i++) {
            if (testMatches(Character.toString((char) (i % 128))))
                counter++;
        }
        System.out.println(NUM_TESTS + " tests of Pattern.matches() took " +
                (System.nanoTime()-start) + " ns.");
        System.out.println("There were " + counter + "/" + NUM_TESTS +
                " valid characters");
        /*********************************/
        start = System.nanoTime();
        counter = 0;
        for (int i = 0; i < NUM_TESTS; i++) {
            if (testCharacter(Character.toString((char) (i % 128))))
                counter++;
        }
        System.out.println(NUM_TESTS + " tests of isLetter() took " +
                (System.nanoTime()-start) + " ns.");
        System.out.println("There were " + counter + "/" + NUM_TESTS +
                " valid characters");
        /*********************************/
        start = System.nanoTime();
        counter = 0;
        for (int i = 0; i < NUM_TESTS; i++) {
            if (testMatchesNoCache(Character.toString((char) (i % 128))))
                counter++;
        }
        System.out.println(NUM_TESTS + " tests of String.matches() took " +
                (System.nanoTime()-start) + " ns.");
        System.out.println("There were " + counter + "/" + NUM_TESTS +
                " valid characters");
    }

    private static boolean testMatches(final String c) {
        return ONE_CHAR_PATTERN.matcher(c).matches();
    }
    private static boolean testMatchesNoCache(final String c) {
        return c.matches("\\p{L}");
    }
    private static boolean testCharacter(final String c) {
        return Character.isLetter(c.charAt(0));
    }
} 
```

我的输出：

```
Pattern.matches() 的 10000000 次测试耗时 4325146672 ns。
有 4062500/10000000 个有效字符
isLetter() 的 10000000 次测试耗时 546031201 ns。
有 4062500/10000000 个有效字符
String.matches() 的 10000000 次测试耗时 11900205444 ns。
有 4062500/10000000 个有效字符
```

因此，即使使用缓存的`Pattern`. （并且未缓存的情况比缓存的差近 3 倍。）

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-18T16:08:06.933

只是检查一个字母是否在 AZ 中，因为这不包括带有重音符号的字母或其他字母表中的字母。

我发现您可以将正则表达式类用于“Unicode 字母”或其区分大小写的变体之一：

```
string.matches("\\p{L}"); // Unicode letter
string.matches("\\p{Lu}"); // Unicode upper-case letter 
```

您也可以使用*Character*类执行此操作：

```
Character.isLetter(character); 
```

但如果您需要检查多个字母，那就不太方便了。

# design-patterns - 设计/实现两个（或更多）类与同一对象“具有”关系的正确方法是什么？

> ID：93981
> 
> 赞同：4
> 
> 时间：2008-09-18T16:08:14.543
> 
> 标签：design-patterns, oop

假设我有这样的设计：

对象 GUI 有两个对象：对象 aManager 和对象 bManager，它们从不相互通信。

aManager 和 bManager 都有对象 cManager 作为属性（或者更确切地说是指向 cManager 的指针）。因此，当 aManager 修改其 cManager 时，它也会影响 bManager 的 cManager。

我的问题是设计/实现它的正确方法是什么？

本来想把cManager做成GUI的一个属性，GUI在构造aManager和bManager的时候会传递一个指向cManager的指针。但是恕我直言，GUI与cManager无关，那么GUI为什么要把它作为一个属性呢？

我应该在这里使用特定的设计模式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T16:28:27.803

我将尽可能简单地解释这一点，如果我没有回答您的问题，我深表歉意。

当你真正得到这个问题的答案时，这是你真正思考面向对象的第一步。

在 OO 中，当两个对象都“具有”另一个对象时，两者都引用另一个对象是完全可以接受的。OO 的诀窍是对象有自己的生命，它们是流动的，任何需要它们的人都可以保留对它们的引用。当被许多其他对象使用时，对象必须保持自身“有效”并保持稳定性。（这就是为什么像 String 这样的不可变对象如此出色的原因，它们总是与它们被创建时一样有效）

一个例外是，如果您使用 C++ 进行编码，因为您实际上必须手动释放对象，这意味着所有者可以监控每个对象的生命周期——这使得在 C++ 中的 OO 中“思考”非常困难。

[补充] 由于您指的是指针，我认为您正在使用 C++ 编程，这是不同的。在这种情况下，你是对的。让一位经理“拥有”您的共享对象的生命周期。在所有其他引用消失之前，它不能让该对象死亡。

您还可以使用引用计数。每当有人获得对您的对象的引用时，它就会调用“addReference”或其他东西，只要完成它就会删除引用。如果有人在计数为 1 时调用 removeReference，则对象可以自行清理。这可能与您在 C++ 中实现真正的 OO 样式分配/释放一样接近。虽然它非常容易出错。

我相信有图书馆可以做这种事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T16:33:14.237

我建议只在你的 GUI 对象构造函数中将 cManager 作为参数传递，但不要维护对它的引用（这里是 Java 代码，但你明白了）：

```
public GUI(CManager cManager)
{
    this.aManager = new AManager(cManager);
    this.bManager = new BManager(cManager);
    // don't bother keeping cManager as a field
} 
```

我认为 Singleton 或 Factory 在这里都不合适。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T16:37:36.080

小心使用单例（如果您想要简单的测试，则根本不使用！）

*   [单身人士是病态的骗子](http://googletesting.blogspot.com/2008/08/by-miko-hevery-so-you-join-new-project.html)
*   [所有单身人士都去哪儿了](http://googletesting.blogspot.com/2008/08/where-have-all-singletons-gone.html)
*   [单身人士的根本原因](http://googletesting.blogspot.com/2008/08/root-cause-of-singletons.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T16:10:25.070

您可以根据需要使用工厂模式来请求 aManager 和 bManager 对 cManager 的引用。

[http://msdn.microsoft.com/en-us/library/ms954600.aspx](http://msdn.microsoft.com/en-us/library/ms954600.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T16:13:46.903

您应该考虑将您的 GUI 与您的模型和实现分开。

如果在应用程序范围内只有一个 cManager，你可以让 cManager 成为单例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T16:19:22.710

如果不讨论您想要实现的目标，这很难回答。但是，我想说，按照你的说法，让 GUI 将指针交给 aManager 和 bManager 。

如果您正在尝试创建 GUI 并想知道如何将数据输入和输出，那么我可以推荐这个： [http ://codebetter.com/blogs/jeremy.miller/archive/2007/07/25/the -build-your-own-cab-series-table-of-contents.aspx](http://codebetter.com/blogs/jeremy.miller/archive/2007/07/25/the-build-your-own-cab-series-table-of-contents.aspx)

我认为这主要是为 C# 用户编写的，但也适用于其他语言。我猜这可能比您的第一个 OO 应用程序需要的更高级。我认为您将不得不给自己买一本关于 OO 设计的书，并花一些晚上的时间来阅读它。

作为一个菜鸟，我建议你不要费心在第一次尝试以最完美的正确方式做所有事情，而只是让一些事情起作用。随着时间的推移（并大量阅读），您将了解什么使解决方案在不同标准下比其他解决方案更好。你的问题没有正确答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-04T22:20:06.003

一般来说，在任何时候，任何可变对象都应该有一个明确定义的所有者（一个对象在其整个生命周期中通常会有多个所有者，其中第一个是构造函数，然后将所有权交给调用的代码它，等等）任何其他拥有对该对象的引用的东西都应该将该引用视为对其他人拥有的对象的引用。

有人可能会想，当从 C++ 转到 Java 或 .net 时，“嘿，酷——我不必再担心对象所有权了”，但事实并非如此。可变对象的所有权在基于 GC 的系统中与在非 GC 系统中一样重要。缺乏任何*表达*所有权的方式并不能免除程序员知道谁拥有什么的义务。它只会使履行该义务变得更加困难。

如果 cManager 是可变的，那么 aManager 应该拥有一个，bManager 持有对它的引用，并认为对其目标的任何更改都会影响 aManager 的 cManager，或者 bManager 应该拥有一个（aManager 持有引用等），或者某个其他实体应该拥有一个，aManager 和 bManager 都认为他们的更改影响了该其他实体所拥有的。

即使使用一种不承认任何所有权概念的语言或框架，在处理可变对象时也要始终以这样的方式思考。否则会招致混乱和灾难。

# c# - 如何使用正则表达式拆分字符串以返回值列表？

> ID：93983
> 
> 赞同：1
> 
> 时间：2008-09-18T16:08:21.067
> 
> 标签：c#, regex

如何获取字符串`foo[]=1&foo[]=5&foo[]=2`并返回具有`1,5,2`该顺序值的集合。我正在寻找在 C# 中使用正则表达式的答案。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T16:17:56.190

在 C# 中，您可以使用捕获组

```
 private void RegexTest()
    {
        String input = "foo[]=1&foo[]=5&foo[]=2";
        String pattern = @"foo\[\]=(\d+)";

        Regex regex = new Regex(pattern);

        foreach (Match match in regex.Matches(input))
        {
            Console.Out.WriteLine(match.Groups[1]);
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T16:11:02.027

我不懂C#，但是...

在java中：

```
String[] nums = String.split(yourString, "&?foo[]"); 
```

方法中的第二个参数`String.split()`是一个正则表达式，告诉方法在哪里拆分字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T16:20:26.763

将 Regex.Split() 方法与适当的正则表达式一起使用。这将拆分与正则表达式匹配的部分字符串并将结果作为字符串 [] 返回。

假设您想要查询字符串中的所有值而不检查它们是否是数字，（并且不只是匹配 foo[] 之类的名称），您可以使用："&?[^&=]+="

```
string[] values = Regex.Split(“foo[]=1&foo[]=5&foo[]=2”, "&?[^&=]+="); 
```

顺便说一句，如果您正在使用正则表达式，那么[http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)网站非常棒（我只是一个粉丝）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T16:22:03.857

我会使用这个特殊的模式：

```
string re = @"foo\[\]=(?<value>\d+)"; 
```

所以类似（未测试）：

```
Regex reValues = new Regex(re,RegexOptions.Compiled);
List<integer> values = new List<integer>();

foreach (Match m in reValues.Matches(...putInputStringHere...)
{
   values.Add((int) m.Groups("value").Value);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T16:13:51.490

假设您正在处理数字，此模式应匹配：

```
/=(\d+)&?/ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T16:16:29.313

这应该这样做：

```
using System.Text.RegularExpressions;

Regex.Replace(s, !@"^[0-9]*$”, ""); 
```

其中 s 是您希望在其中提取数字的字符串。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T16:16:30.813

只要确保像这样逃脱＆符号：

```
/=(\d+)\&/ 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T17:23:41.977

这是使用内置 string.Split 函数的替代解决方案：

```
string x = "foo[]=1&foo[]=5&foo[]=2";
string[] separator = new string[2] { "foo[]=", "&" };
string[] vals = x.Split(separator, StringSplitOptions.RemoveEmptyEntries); 
```

# c# - 在 .NET 中防止给定应用程序的多个实例？

> ID：93989
> 
> 赞同：137
> 
> 时间：2008-09-18T16:08:52.530
> 
> 标签：c#, .net

在 .NET 中，防止应用程序的多个实例同时运行的最佳方法是什么？如果没有“最佳”技术，每种解决方案需要考虑哪些注意事项？

* * *

## 回答 #1

> 赞同：164
> 
> 时间：2008-09-18T16:38:19.543

使用互斥锁。上面使用 GetProcessByName 的示例之一有许多警告。这是一篇关于这个主题的好文章：

[http://odetocode.com/Blogs/scott/archive/2004/08/20/401.aspx](http://odetocode.com/Blogs/scott/archive/2004/08/20/401.aspx)

```
[STAThread]
static void Main() 
{
   using(Mutex mutex = new Mutex(false, "Global\\" + appGuid))
   {
      if(!mutex.WaitOne(0, false))
      {
         MessageBox.Show("Instance already running");
         return;
      }

      Application.Run(new Form1());
   }
}

private static string appGuid = "c0a76b5a-12ab-45c5-b9d9-d693faa6e7b9"; 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-09-18T16:16:04.400

```
if (Process.GetProcessesByName(Process.GetCurrentProcess().ProcessName).Length > 1)
{
  AppLog.Write("Application XXXX already running. Only one instance of this application is allowed", AppLog.LogMessageType.Warn);
  return;
} 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2008-09-18T18:26:18.723

这是确保只有一个实例在运行所需的代码。这是使用命名互斥锁的方法。

```
public class Program
{
    static System.Threading.Mutex singleton = new Mutex(true, "My App Name");

    static void Main(string[] args)
    {
        if (!singleton.WaitOne(TimeSpan.Zero, true))
        {
            //there is already another instance running!
            Application.Exit();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-18T16:11:35.067

Hanselman 有[一篇](http://www.hanselman.com/blog/TheWeeklySourceCode31SingleInstanceWinFormsAndMicrosoftVisualBasicdll.aspx)关于使用 Microsoft.VisualBasic 程序集中的 WinFormsApplicationBase 类来执行此操作的帖子。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-09-01T16:25:18.060

1 - 在 program.cs 中创建一个引用 ->

```
using System.Diagnostics; 
```

`void Main()`2 -作为第一行代码放入->

```
 if (Process.GetProcessesByName(Process.GetCurrentProcess().ProcessName).Length >1)
                return; 
```

就是这样。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-18T17:32:22.563

听起来到目前为止已经提出了 3 种基本技术。

1.  从 Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase 类派生并将 IsSingleInstance 属性设置为 true。（我相信这里需要注意的是，这不适用于 WPF 应用程序，不是吗？）
2.  使用命名互斥体并检查它是否已经创建。
3.  获取正在运行的进程列表并比较进程的名称。（这有一个警告，要求您的进程名称相对于给定用户机器上运行的任何其他进程是唯一的。）

我错过了任何警告吗？

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-02-06T09:00:16.837

我在这里尝试了所有解决方案，但在我的 C# .net 4.0 项目中没有任何效果。希望在这里帮助某人解决对我有用的解决方案：

作为主要类变量：

```
private static string appGuid = "WRITE AN UNIQUE GUID HERE";
private static Mutex mutex; 
```

当您需要检查应用程序是否已在运行时：

```
bool mutexCreated;
mutex = new Mutex(true, "Global\\" + appGuid, out mutexCreated);
if (mutexCreated)
    mutex.ReleaseMutex();

if (!mutexCreated)
{
    //App is already running, close this!
    Environment.Exit(0); //i used this because its a console app
} 
```

我只需要在某些条件下关闭其他 istances，这对我的目的很有效

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-08-05T08:47:17.383

在尝试了多种解决方案后，我的问题。我最终在这里使用了**WPF**的示例：[http ://www.c-sharpcorner.com/UploadFile/f9f215/how-to-restrict-the-application-to-just-one-instance/](http://www.c-sharpcorner.com/UploadFile/f9f215/how-to-restrict-the-application-to-just-one-instance/)

```
public partial class App : Application  
{  
    private static Mutex _mutex = null;  

    protected override void OnStartup(StartupEventArgs e)  
    {  
        const string appName = "MyAppName";  
        bool createdNew;  

        _mutex = new Mutex(true, appName, out createdNew);  

        if (!createdNew)  
        {  
            //app is already running! Exiting the application  
            Application.Current.Shutdown();  
        }  

    }          
} 
```

在 App.xaml 中：

```
x:Class="*YourNameSpace*.App"
StartupUri="MainWindow.xaml"
Startup="App_Startup" 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-18T16:22:36.007

在为可执行文件创建项目时使用 Visual Studio 2005 或 2008，在“应用程序”面板内的属性窗口中有一个名为“制作单实例应用程序”的复选框，您可以激活该复选框以在单实例应用程序上转换应用程序.

这是我正在谈论的窗口的捕获： ![在此处输入图像描述](https://i.stack.imgur.com/Wtori.png) 这是一个 Visual Studio 2008 Windows 应用程序项目。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-18T16:10:45.053

[http://en.csharp-online.net/Application_Architecture_in_Windows_Forms_2.0](http://en.csharp-online.net/Application_Architecture_in_Windows_Forms_2.0) —Single-Instance_Detection_and_Management

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-10-31T07:23:00.493

这是 VB.Net 的代码

```
Private Shared Sub Main()
    Using mutex As New Mutex(False, appGuid)
        If Not mutex.WaitOne(0, False) Then
              MessageBox.Show("Instance already running", "ERROR", MessageBoxButtons.OK, MessageBoxIcon.Error)
            Return
        End If

        Application.Run(New Form1())
    End Using
End Sub 
```

这是 C# 的代码

```
private static void Main()
{
    using (Mutex mutex = new Mutex(false, appGuid)) {
        if (!mutex.WaitOne(0, false)) {
            MessageBox.Show("Instance already running", "ERROR", MessageBoxButtons.OK, MessageBoxIcon.Error);
            return;
        }

        Application.Run(new Form1());
    }
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-18T16:11:29.560

本文简单地解释了如何创建一个可以控制其实例数量或仅运行单个实例的 Windows 应用程序。这是业务应用程序非常典型的需求。已经有很多其他可能的解决方案来控制这一点。

[https://web.archive.org/web/20090205153420/http://www.openwinforms.com/single_instance_application.html](https://web.archive.org/web/20090205153420/http://www.openwinforms.com/single_instance_application.html)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-18T19:19:49.890

使用 VB.NET！不完全是 ;）

使用 Microsoft.VisualBasic.ApplicationServices；

VB.Net 的 WindowsFormsApplicationBase 为您提供了一个“SingleInstace”属性，它决定了其他实例并只让一个实例运行。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-04T02:31:30.053

```
[STAThread]
static void Main()                  // args are OK here, of course
{
    bool ok;
    m = new System.Threading.Mutex(true, "YourNameHere", out ok);

    if (! ok)
    {
        MessageBox.Show("Another instance is already running.");
        return;
    }

    Application.Run(new Form1());   // or whatever was there

    GC.KeepAlive(m);                // important!
} 
```

来自：[确保 .NET 应用程序的单个实例](http://www.ai.uga.edu/mc/SingleInstance.html)

和：[单实例应用程序互斥锁](http://www.codeproject.com/KB/cs/SingleInstanceAppMutex.aspx)

与@Smink 和@Imjustpondering 的答案相同，但有所不同：

[Jon Skeet 关于 C# 的常见问题解答，](http://www.yoda.arachsys.com/csharp/faq/)了解[GC.KeepAlive](http://msdn.microsoft.com/en-us/library/system.gc.keepalive.aspx)为何如此重要

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-18T16:11:43.133

[http://www.codeproject.com/KB/cs/SingleInstancingWithIpc.aspx](http://www.codeproject.com/KB/cs/SingleInstancingWithIpc.aspx)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-18T16:11:48.640

您必须使用 System.Diagnostics.Process。

查看： http: [//www.devx.com/tips/Tip/20044](http://www.devx.com/tips/Tip/20044)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-01-28T14:09:48.870

*（注意：这是一个有趣的解决方案！它可以工作，但使用了糟糕的 GDI+ 设计来实现这一点。）*

将图像放入您的应用程序并在启动时加载它。按住它直到应用程序退出。用户将无法启动第二个实例。*（当然互斥锁解决方案要干净得多）*

```
private static Bitmap randomName = new Bitmap("my_image.jpg"); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-01-11T17:59:57.043

简单地使用 a `StreamWriter`，这个怎么样？

```
System.IO.File.StreamWriter OpenFlag = null;   //globally 
```

和

```
try
{
    OpenFlag = new StreamWriter(Path.GetTempPath() + "OpenedIfRunning");
}
catch (System.IO.IOException) //file in use
{
    Environment.Exit(0);
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-18T16:11:58.187

通常它是通过一个命名的 Mutex 完成的（使用 new Mutex("your app name", true ) 并检查返回值），但 Microsoft.VisualBasic.dll 中也有一些支持类[可以为您完成](http://www.hanselman.com/blog/TheWeeklySourceCode31SingleInstanceWinFormsAndMicrosoftVisualBasicdll.aspx)。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-06-18T05:38:16.863

这在纯 C# 中对我有用。try/catch 是在您的循环期间可能退出列表中的进程。

```
using System.Diagnostics;
....
[STAThread]
static void Main()
{
...
        int procCount = 0;
        foreach (Process pp in Process.GetProcesses())
        {
            try
            {
                if (String.Compare(pp.MainModule.FileName, Application.ExecutablePath, true) == 0)
                {
                    procCount++;                        
                    if(procCount > 1) {
                       Application.Exit();
                       return;
                    }
                }
            }
            catch { }
        }
        Application.Run(new Form1());
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-01-11T18:43:53.857

将应用程序限制为单个实例时，请务必考虑安全性：

全文： [https ://blogs.msdn.microsoft.com/oldnewthing/20060620-13/?p=30813](https://blogs.msdn.microsoft.com/oldnewthing/20060620-13/?p=30813)

> 我们使用具有固定名称的命名互斥锁来检测程序的另一个副本是否正在运行。但这也意味着攻击者可以先创建互斥体，从而完全阻止我们的程序运行！如何防止这种类型的拒绝服务攻击？

...

> 如果攻击者运行在与您的程序正在（或将要）运行的相同安全上下文中，那么您无能为力。无论您想出什么“秘密握手”来确定您的程序的另一个副本是否正在运行，攻击者都可以模仿它。由于它在正确的安全上下文中运行，它可以做任何“真实”程序可以做的事情。

...

> 显然，您无法保护自己免受以相同安全权限运行的攻击者的攻击，但您仍然可以保护自己免受以其他安全权限运行的非特权攻击者的攻击。

尝试在互斥体上设置 DACL，这是 .NET 方式： [https ://msdn.microsoft.com/en-us/library/system.security.accesscontrol.mutexsecurity(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.security.accesscontrol.mutexsecurity(v=vs.110).aspx)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-02-11T23:24:27.187

这些答案都不适合我，因为我需要它在 Linux 下使用 monodevelop 工作。这对我很有用：

调用此方法并传递一个唯一 ID

```
 public static void PreventMultipleInstance(string applicationId)
    {
        // Under Windows this is:
        //      C:\Users\SomeUser\AppData\Local\Temp\ 
        // Linux this is:
        //      /tmp/
        var temporaryDirectory = Path.GetTempPath();

        // Application ID (Make sure this guid is different accross your different applications!
        var applicationGuid = applicationId + ".process-lock";

        // file that will serve as our lock
        var fileFulePath = Path.Combine(temporaryDirectory, applicationGuid);

        try
        {
            // Prevents other processes from reading from or writing to this file
            var _InstanceLock = new FileStream(fileFulePath, FileMode.OpenOrCreate, FileAccess.ReadWrite, FileShare.None);
            _InstanceLock.Lock(0, 0);
            MonoApp.Logger.LogToDisk(LogType.Notification, "04ZH-EQP0", "Aquired Lock", fileFulePath);

            // todo investigate why we need a reference to file stream. Without this GC releases the lock!
            System.Timers.Timer t = new System.Timers.Timer()
            {
                Interval = 500000,
                Enabled = true,
            };
            t.Elapsed += (a, b) =>
            {
                try
                {
                    _InstanceLock.Lock(0, 0);
                }
                catch
                {
                    MonoApp.Logger.Log(LogType.Error, "AOI7-QMCT", "Unable to lock file");
                }
            };
            t.Start();

        }
        catch
        {
            // Terminate application because another instance with this ID is running
            Environment.Exit(102534); 
        }
    } 
```***~~******