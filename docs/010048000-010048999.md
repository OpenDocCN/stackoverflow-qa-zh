# StackOverflow 问答 10048000-10048999

# erlang - 了解传递函数的参数数量（erlang）

> ID：10048001
> 
> 赞同：7
> 
> 时间：2012-04-06T19:01:30.033
> 
> 标签：erlang

在 ERLANG 中：假设我们有一个函数 f()，它以 F1 作为输入，其中 F1 是一个函数。有没有办法知道F1的输入参数个数。

我觉得不知何故有一个解决方案，但我不确定。例如：

```
 -module(high).
 -compile(export_all).

 f1() -> 1.
 f2(X) -> X. 
 f3(X, Y) -> {X,Y}. 

 run(F) -> io:format("F ~p ~n", [F]). 
```

那么，函数run/1有没有办法知道传递函数的信息[主要是传递函数的输入参数个数]。

注意：请注意，这是一个理论问题。注意：apply(fun,[arguments]) 的代码是否在开源中可用.. 我猜这可能会帮助我。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-06T19:32:46.923

二郎：fun_info（乐趣，arity）。

例如

```
F = fun(A,B) -> A+B end.
#Fun<erl_eval.12.111823515>
3> erlang:fun_info(F,arity).
{arity,2} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-25T12:47:10.407

您可以使用`module_info/1`来获取有关您的模块的信息。

> `module_info/1`
> 
> call`module_info(Key)`是`Key`一个原子，它返回关于模块的一条信息。
> 
> 允许以下值`Key`：
> 
> ...
> 
> `exports` 返回包含模块中所有导出函数的 {Name,Arity} 元组列表。
> 
> `functions` 返回包含模块中所有函数的 {Name,Arity} 元组列表。

[http://erlang.org/doc/reference_manual/modules.html](http://erlang.org/doc/reference_manual/modules.html)

* * *

```
run(F) -> find_value(F,module_info(exports)).

find_value(Key, List) ->
    case lists:keyfind(Key, 1, List) of
        {Key, Result} -> {Key,Result};
        false -> io:format("There is no function called ~w.~n", [Key])
    end. 
```

# php - 通过 htaccess 文件更改 url

> ID：10048002
> 
> 赞同：-2
> 
> 时间：2012-04-06T19:01:37.873
> 
> 标签：php, .htaccess

我想通过 htaccess 文件从 url 中删除 .php 扩展名。请让我知道我该怎么做？

```
 url:http://domain name/profile.php 
```

我想要这样

```
 url:http://domain name/profile 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T19:03:38.513

您需要阅读它以便能够编写正则表达式并以不同的方式使用 .htaccess，但简单的重写将如下所示：

```
RewriteEngine on

RewriteRule ^profile$ profile.php [L] 
```

如果你想全局删除所有 .php 扩展名但保留文件名，你需要一个看起来像这样的正则表达式：

```
RewriteRule ^([a-zA-Z0-9\-_]+).php$ $1.php [L] 
```

# java - 将 Jetty 与 JAX-RS-Jersey 集成

> ID：10048004
> 
> 赞同：17
> 
> 时间：2012-04-06T19:02:04.450
> 
> 标签：java, servlets, jetty, jersey, jax-rs

在对 web 和 Stackoverflow 进行了详尽的搜索之后，我仍然试图弄清楚如何将 Jersey 提供的 RESTlet 样式接口与 Jetty 集成。

我已经启动并运行了我的 Jetty 服务器，因此 Jersey 似乎也很容易使用，有人知道如何将两者联系在一起吗？任何具体的链接都会有所帮助——我对 servlet 编程也有点陌生。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-06T21:24:01.083

不久前，我使用 Jetty 和 Jersey 创建了一个应用程序。它实际上只是一个标准的 webapp：

网页.xml：

```
<servlet>
    <servlet-name>rest.service</servlet-name>
    <servlet-class>
        com.sun.jersey.spi.spring.container.servlet.SpringServlet</servlet-class>
    <init-param>
        <param-name>com.sun.jersey.config.property.resourceConfigClass</param-name>
        <param-value>com.sun.jersey.api.core.PackagesResourceConfig</param-value>
    </init-param>
    <init-param>
        <param-name>com.sun.jersey.config.property.packages</param-name>
        <param-value>your.package.with.jersey.resources</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>rest.service</servlet-name>
    <url-pattern>/service/*</url-pattern>
</servlet-mapping> 
```

休息资源：

```
package your.package.with.jersey.resources;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.Context;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.SecurityContext;

@Path("login")
public class LoginResource {

    @Context
    private SecurityContext security;

    @GET
    @Produces(MediaType.APPLICATION_XML)
    public String login() {

        String email = security.getUserPrincipal().getName();
        return "ok";
    }
} 
```

码头启动器：

```
public class StartJetty {

    public static void main(String[] args) throws Exception {

        Server server = new Server();
        SocketConnector connector = new SocketConnector();
        // Set some timeout options to make debugging easier.
        connector.setMaxIdleTime(1000 * 60 * 60);
        connector.setSoLingerTime(-1);
        connector.setPort(8080);
        server.setConnectors(new Connector[] { connector });

        WebAppContext bb = new WebAppContext();
        bb.setServer(server);
        bb.setContextPath("/");
        bb.setWar("src/main/webapp");

        server.addHandler(bb);

        try {
            System.out.println(">>> STARTING EMBEDDED JETTY SERVER, PRESS ANY KEY TO STOP");
            server.start();
            while (System.in.available() == 0) {
                Thread.sleep(5000);
            }
            server.stop();
            server.join();
        } catch (Exception e) {
            e.printStackTrace();
            System.exit(100);
        }
    }
} 
```

pom.xml：

```
<!-- Jetty -->
<dependency>
    <groupId>org.mortbay.jetty</groupId>
    <artifactId>jetty</artifactId>
</dependency>
<dependency>
    <groupId>org.mortbay.jetty</groupId>
    <artifactId>jetty-util</artifactId>
</dependency>
<dependency>
    <groupId>org.mortbay.jetty</groupId>
    <artifactId>jetty-management</artifactId>
</dependency>

<!-- Jersey (JAX-RS) -->
<dependency>
    <groupId>com.sun.jersey</groupId>
    <artifactId>jersey-server</artifactId>
</dependency>
<dependency>
    <groupId>com.sun.jersey.contribs</groupId>
    <artifactId>jersey-spring</artifactId>
</dependency>
<dependency>
    <groupId>javax.ws.rs</groupId>
    <artifactId>jsr311-api</artifactId>
</dependency>
<dependency>
    <groupId>com.sun.jersey</groupId>
    <artifactId>jersey-test-framework</artifactId>
    <scope>test</scope>
</dependency>
<dependency>
    <groupId>com.sun.grizzly</groupId>
    <artifactId>grizzly-servlet-webserver</artifactId>
</dependency>

(...)

<plugin>
    <groupId>org.mortbay.jetty</groupId>
    <artifactId>maven-jetty-plugin</artifactId>     
</plugin> 
```

希望这些片段为您指明正确的方向。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-06-01T15:00:14.410

您可能希望查看[Dropwizard](http://www.dropwizard.io)以了解 Jetty、Jersey、Jackson、Logback/Log4j/JUL/CJL 和 JDBI 之间的开箱即用集成，所有这些都很好地使用 Yammer Metrics 进行了检测。

# sql - 在 SQL Server 表上创建触发器

> ID：10048010
> 
> 赞同：0
> 
> 时间：2012-04-06T19:02:30.087
> 
> 标签：sql, triggers

我想在 SQL Server 表上创建触发器。

表有 8 列。其中之一是`email`。IE`peter@msn.com`

我想要的是：当将新行插入表中时，触发器应该更新我的`ISP`列`msn.com`

```
 CREATE TRIGGER TIGUPDATEISP ON SUBS
  FOR INSERT
  AS 
     UPDATE SUBS 
     SET ISP = SELECT RIGHT(EMAIL, LEN(EMAIL) - CHARINDEX('@', EMAIL) FROM INSERTED) 
```

这是`isp`用最后一个值更新我的所有内容。但是，我想根据插入更新一个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T19:04:55.650

如果 ISP 列允许 NULL 值，这将起作用

```
CREATE TRIGGER TIGUPDATEISP ON Subs
   FOR INSERT
AS 
BEGIN

    SET NOCOUNT ON;

    UPDATE SUBS 
        SET ISP = (SELECT RIGHT(EMAIL, LEN(EMAIL) - CHARINDEX('@', EMAIL)) 
        FROM INSERTED
        WHERE SUBS.ID = INSERTED.ID)
    FROM INSERTED
    WHERE SUBS.Id = INSERTED.ID

END 
```

如果 ISP 列不允许 NULLS，这将起作用

```
CREATE TRIGGER TIGUPDATEISP ON Subs
   INSTEAD OF INSERT
AS 
BEGIN

    SET NOCOUNT ON;

    INSERT Subs (EMAIL, Isp)
    SELECT EMAIL, RIGHT(EMAIL, LEN(EMAIL) - CHARINDEX('@', EMAIL)) FROM INSERTED

END 
```

# sql - JPA Query - 位置参数中的 sql 注入 jpa 本机查询

> ID：10048014
> 
> 赞同：5
> 
> 时间：2012-04-06T19:02:39.287
> 
> 标签：sql, hibernate, jpa, sql-injection

正如我在很多文章中所读到的，当我使用 JPA/Hibernate 查询时，最好在我的查询中设置参数，这样可以避免 SQL 注入。喜欢：

```
select user from User user where user.name = :name and user.surname = :surname 
```

我的问题是，在某些情况下，我需要在创建查询时使用本机查询。

我将使用我的实体管理器和`createNativeQuery`. 但在这种情况下，参数将是位置的。喜欢：

```
select * from users where user_name = ? and user_surname = ? 
```

然后在我的查询中，我将使用该方法`setParameter(1, "name")`等。那么这种情况是“sql 注入证明”，就像在参数化查询中一样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T20:04:41.123

如果您不使用字符串操作来构建查询，例如

```
"SELECT foo FROM bar Where id="+myParameter+" more sql ..." 
```

，那么您将不会有任何漏洞。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:11:04.710

目前（如果我错了，请社区纠正我）最新的 PDO 数据库抽象层中不存在漏洞。

但是，在清理和过滤输入的同时测试已知和未知的查询将有助于消除在零日漏洞攻击事件中注入的可能性。

我目前在任何和所有动态创建的查询之前使用过滤输入、字符集期望、存储过程和对其参数的严格要求的组合

# python - Python被正则表达式分割？

> ID：10048017
> 
> 赞同：1
> 
> 时间：2012-04-06T19:02:50.053
> 
> 标签：python, regex, email, split

好的，在 python 中，我从这样的字符串中提取电子邮件：

```
split = re.split(" ", string)
emails = []

pattern = re.compile("^[a-zA-Z0-9_\.-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-\.]+$");

for bit in split:
    result = pattern.match(bit)

    if(result != None):
        emails.append(bit) 
```

只要电子邮件之间有空格，这就是有效的。但情况可能并非总是如此。例如：

`Hello, foo@foo.com`

会返回：

`foo@foo.com`

但是，采用以下字符串：

`I know my best friend mailto:foo@foo.com!`

这将返回`null`。所以问题是：我怎样才能使正则表达式成为分割的分隔符？我想得到

`foo@foo.com`

在所有情况下，无论它旁边的标点符号如何。这在python中可能吗？

*“通过正则表达式拆分”是指如果程序遇到字符串中的模式，它将提取该部分并将其放入列表中。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:15:10.823

我不是正则表达式专家，但我想说您正在寻找[`re.findall`](http://docs.python.org/py3k/library/re.html#re.findall)：

```
>>> email_reg = re.compile(r'[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+')
>>> email_reg.findall('I know my best friend mailto:foo@foo.com!')
['foo@foo.com'] 
```

请注意，`findall`可以处理多个电子邮件地址：

```
>>> email_reg.findall('Text text foo@foo.com, text text, baz@baz.com!')
['foo@foo.com', 'baz@baz.com'] 
```

**编辑：**在 Qtax 的帮助下，正则表达式现在应该会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:15:18.667

使用`re.search`或`re.findall`。您还需要正确转义您的表达式（`.`需要在字符类之外转义，而不是在内部）并删除/替换锚点`^`和`$`（例如用`\b`），例如：

```
r"\b[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+\b" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T19:19:33.983

我在您的正则表达式中看到的问题是您使用`^`哪个匹配字符串的开头和`$`匹配字符串的结尾。如果您删除它，然后使用您的示例测试用例运行它，它将起作用

```
>>> re.findall("[A-Za-z0-9\._-]+@[A-Za-z0-9-]+.[A-Za-z0-9-\.]+","I know my best friend mailto:foo@foo.com!")
['foo@foo.com']
>>> re.findall("[A-Za-z0-9\._-]+@[A-Za-z0-9-]+.[A-Za-z0-9-\.]+","Hello, foo@foo.com")
['foo@foo.com']
>>> 
```

# opengl - OpenGL相机旋转

> ID：10048018
> 
> 赞同：4
> 
> 时间：2012-04-06T19:02:53.770
> 
> 标签：opengl, camera, rotation

在 OpenGL 中，我正在尝试创建一个自由飞行相机。我的问题是 Y 轴上的旋转。相机应始终在 Y 世界轴上旋转，而不是在本地方向上。我尝试了几种矩阵乘法，但都没有结果。和

```
camMatrix = camMatrix  * yrotMatrix 
```

沿局部轴旋转相机。与

```
camMatrix = yrotMatrix * camMatrix 
```

沿世界轴旋转相机，但始终围绕原点旋转。但是，旋转中心应该是相机。有人出主意吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-08T08:42:17.557

3D 编程更棘手的方面之一是正确进行复杂的转换。

在 OpenGL 中，每个点都先用模型/视图矩阵转换，然后再用投影矩阵转换。

模型视图矩阵获取每个点并将其转换为从相机的角度来看它应该位于的位置。投影矩阵转换点的坐标，以便可以轻松地将 X 和 Y 坐标映射到窗口。

要获得正确的模式/视图矩阵，您必须从一个单位矩阵（不改变顶点的矩阵）开始，然后对相机的位置和方向应用变换，然后*以相反的顺序*应用对象的位置和方向。

您需要记住的另一件事是，旋转*始终*围绕以原点 (0,0,0) 为中心的轴。因此，当您为相机应用旋转变换时，您是在*转动*它（就像您转动头部一样）还是*围绕*原点运行（就像地球围绕太阳运行一样）取决于您之前是否应用了平移变换。

因此，如果您想同时旋转和环绕相机，您需要：

1.  应用旋转来定位相机
2.  应用翻译来定位它
3.  应用旋转以围绕原点旋转相机
4.  （可选）应用平移以在其设置的方向上移动相机，以将其移动到围绕 (0,0,0) 以外的点的轨道上。

例如，如果您想将相机指向一个不是 (0,0,0) 的点，并且在设定的距离处绕该点运行，同时还能够俯仰或偏航相机，事情会变得更加复杂。请参阅[此处](http://knobbits.org/webgl/widgets.html)以获取 WebGL 中的示例。寻找`GLViewerBase.prototype.display`。

[红皮书](http://www.glprogramming.com/red/) [更详细地介绍了](http://www.glprogramming.com/red/chapter03.html)变换。

另请注意[gluLookAt](http://www.opengl.org/sdk/docs/man/xhtml/gluLookAt.xml)，您可以使用它来将相机指向*某物*，而无需使用旋转。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T19:22:30.173

`n`与使用矩阵相比，您可能会发现创建一个存储位置和正交法线以及轴并适当旋转它们的相机类更容易，`u`例如：`v`

[https://github.com/sgolodetz/hesperus2/blob/master/Shipwreck/MapEditor/GUI/Camera.java](https://github.com/sgolodetz/hesperus2/blob/master/Shipwreck/MapEditor/GUI/Camera.java)

和

[https://github.com/sgolodetz/hesperus2/blob/master/Shipwreck/MapEditor/Math/MathUtil.java](https://github.com/sgolodetz/hesperus2/blob/master/Shipwreck/MapEditor/Math/MathUtil.java)

然后你写这样的东西：

```
if(m_keysDown[TURN_LEFT])
{
    m_camera.rotate(new Vector3d(0,0,1), deltaAngle);
} 
```

当需要为相机设置视图时，您可以：

```
gl.glLoadIdentity();
glu.gluLookAt(m_position.x, m_position.y, m_position.z,
              m_position.x + m_nVector.x, m_position.y + m_nVector.y, m_position.z + m_nVector.z,
              m_vVector.x, m_vVector.y, m_vVector.z); 
```

如果您想知道如何围绕任意轴旋转`(0,0,1)`，请参阅`MathUtil.rotate_about_axis`上面的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-06T19:13:05.673

如果您不想根据前一帧的相机进行转换，我的建议可能只是丢弃矩阵复合并重新计算每一帧。我认为没有办法用单个矩阵来做你想做的事情，因为它将平移和旋转存储在一起。

我想如果你只想要一个俯仰/偏航相机，只需将这些值存储为两个浮点数，然后基于此重建矩阵。也许类似于伪代码：

```
onFrameUpdate() {
  newPos = camMatrix * (0,0,speed) //move forward along the camera axis
  pitch += mouse_move_x;
  yaw += mouse_move_y;

  camMatrix = identity.translate(newPos)
  camMatrix = rotate(camMatrix, (0,1,0), yaw)
  camMatrix = rotate(camMatrix, (1,0,0), pitch)
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-08T08:52:05.743

> 沿世界轴旋转相机，但始终围绕原点旋转。但是，旋转中心应该是相机。有人出主意吗？

我假设矩阵以这种方式存储在内存中（如果矩阵是线性一维数组，数字表示元素索引）：

```
0   1   2   3    //row 0
4   5   6   7    //row 1
8   9   10  11   //row 2
12  13  14  15   //row 3 
```

**解决方案**：

1.  将相机矩阵的最后一行存储在临时变量中。
2.  将相机矩阵的最后一行设置为 (0, 0, 0, 1)
3.  利用`camMatrix = yrotMatrix * camMatrix`
4.  从临时变量中恢复相机矩阵的最后一行。

# javascript - document.getElementByID 外部还是内联？

> ID：10048025
> 
> 赞同：5
> 
> 时间：2012-04-06T19:03:55.860
> 
> 标签：javascript, jquery, html, dom

我一直在尝试使用`document.getElementByID`从外部 JS 文件中的 HTML 文件中提取信息，但它似乎不起作用。`document.getElementByID`如果它与 HTML 文件内联，或者它可以在外部 JS 文件上正常工作，是否唯一有效？由于其他功能正在工作，因此在 HTML 文档中正确调用了 JS 文件。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-06T19:15:05.500

首先，确保您使用的是`document.getElementById("xxx")`，而不是`document.getElementByID("xxx")`（注意最后的大小写差异）。您的问题指的是`document.getElementByID("xxx")`这可能是这里的问题。

其次，您必须确保在浏览器解析相关 DOM 项之后执行该函数。如果您将`document.getElementById`JS 文件放入该部分中加载并在加载后立即执行的外部 JS 文件中`<head>`，则 DOM 尚未准备好。

你有几个选择：

**1)**将外部 JS 文件`<script>`标签放在正文的末尾，就在`</body>`标签之前。这不仅会更快地加载/显示您的页面，而且会保证在该 JS 文件中的任何内容可以运行之前解析 DOM。

```
<body>
Your HTML here

<script type="text/javascript" src="myscript.js"></script>
</body> 
```

**2）**既然你有 jQuery，把你立即执行的代码放在一个`$(document).ready(fn)`块中，这样 jQuery 会阻止执行，直到 DOM 准备好。如果你这样做，那么你可以把你的代码放在任何地方（`<head>`如果你愿意，包括在这个部分中）。

```
$(document).ready(function() {
    // put your page initialization code here
}); 
```

**3）**将您的代码放在您想要的任何地方，但不要立即执行任何代码。相反，将所有初始化代码放在一个初始化函数中（我们称它为`myPageInit()`您调用的函数：

```
$(document).ready(myPageInit); 
```

**4）**将您的代码放在您想要的任何地方，但不要立即执行任何代码。相反，将所有初始化代码放在一个初始化函数中（让我们称它为`myPageInit()`您在标记之前从脚本调用的`</body>`代码：

```
<script type="text/javascript">myPageInit()</script> 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-06T19:05:43.973

> document.getElementByID 是否仅在与 HTML 文件内联时才有效

不。

> 它可以在外部 JS 文件上正常工作吗？

是的。

您可能`document.getElementById()`在 DOM 准备好之前调用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-07T04:11:44.283

我的建议是这样做：

```
window.onload = function () {
 // document.getElementById() code here
} 
```

然后`document.getElementById()`，直到页面上的每个元素都已完全加载，您才会执行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-06T19:06:03.213

如果您将脚本放入其中，`<head>`则主体尚未加载，因此元素不存在。

要么使用 jQuery 的函数推迟脚本，要么将脚本放在正文的末尾。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-09T06:06:58.273

```
window.onload = function() {
    document.getElementById("demo").innerHTML = "My First JavaScript";
}
```

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>js in ts</title>
    <script src="app.js"></script>
</head>
<body>
   <h2>JavaScript in Body</h2>

   <p id="demo"></p>
</body>
</html>
```

# php - 获取 wordpress 帖子中第一张图片的其他属性

> ID：10048027
> 
> 赞同：0
> 
> 时间：2012-04-06T19:04:00.027
> 
> 标签：php, wordpress

这似乎是从帖子中获取第一张图片的常用功能

```
function get_first_image() {
  global $post, $posts;
  $first_img = '';
  ob_start();
  ob_end_clean();
  $output = preg_match_all('/<img.+src=[\'"]([^\'"]+)[\'"].*>/i', $post->post_content, $matches);
  $first_img = $matches [1] [0];
  if(empty($first_img)){ //Defines a default image
    $first_img = "/images/default.jpg";
  }
  return $first_img;
} 
```

这仅返回 src。我需要扩展它以在一个数组中返回该图像的标题、说明和描述。如何才能做到这一点？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:24:26.520

也许您会在[StackExchange Wordpress](https://wordpress.stackexchange.com/)网站上获得更好的运气。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:10:30.093

制作一个能够为您检索此数据的正则表达式将非常困难。HTML 不是常规语言。如果 Wordpress 网站上的 HTML 格式发生变化，您的代码也不会很有弹性。如果您使用实际的 HTML 解析器，将更容易提取数据。请参阅[如何在 PHP 中解析和处理 HTML/XML？](https://stackoverflow.com/questions/3577641/how-to-parse-and-process-html-with-php)有关在 PHP 中执行此操作的最佳工具的一些指导。

# perl - 网络爬虫文本格式

> ID：10048028
> 
> 赞同：0
> 
> 时间：2012-04-06T19:04:03.447
> 
> 标签：perl, web-crawler, html-tree

我有以下代码来访问 HTML 表。

```
my $table = $tree->look_down(_tag => "table", id => "moduleDetail"); 
```

但是文本没有格式化，因为网页使用表格边框来划分某些文本。所以它出现了这样的情况，“乔丹斯敦的计算数学”，我假设乔丹斯敦在下一个单元格中。这是我正在使用的代码，

```
my @array; 
my $tree = HTML::TreeBuilder->new_from_content($mech->content);  
my $table = $tree->look_down(_tag => "table", id => "moduleDetail");

    for ($table ->look_down(_tag => 'tr')) {

                push(@array,$_->as_text());

    }

    foreach(@array){
           print $_, " ";
                    }
$tree->delete(); 
```

请注意，我尝试使用和数组分隔文本但没有运气？任何指针。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T23:49:17.940

如果调用树上的`objectify_text`方法，访问 HTML 树的文本节点会容易得多。这会将文本节点从简单的字符串更改为`HTML::Element`具有伪标记名称的实例`~text`和一个称为`text`等于文本字符串的属性。这允许该`look_down`方法搜索文本节点。

如果您像这样重新编码，您将获得推送到数组中的每个单独文本节点的值。

```
my $tree = HTML::TreeBuilder->new_from_content($mech->content);  
$tree->objectify_text;

my $table = $tree->look_down(_tag => "table", id => "moduleDetail");

my @text; 

for my $tr ($table->look_down(_tag => '~text')) {
  my $text = $tr->attr('text');
  push @text, $text if $text =~ /\S/;
}

print "$_\n" for @text; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:32:42.157

**使用 HTML::TreeBuilder::XPath**

我建议为此使用 Perl 模块[HTML::TreeBuilder::XPath](http://search.cpan.org/~mirod/HTML-TreeBuilder-XPath-0.14/lib/HTML/TreeBuilder/XPath.pm)。它应该给你你想要的。

从文档中，我相信您的代码使用 XPath 模块看起来像这样

```
my $tree = HTML::TreeBuilder::XPath->new_from_content($mech->content);
my @trArray = $tree->findnodes_as_string( '//table[@id="moduleDetail"]/tr/td');
$tree->delete(); 
```

有关 XPath 的更多信息，请参见[http://www.w3schools.com/xpath/](http://www.w3schools.com/xpath/)。

**使用 HTML::TreeBuilder**

如果您想坚持使用[HTML::TreeBuilder](http://search.cpan.org/~jfearn/HTML-Tree-4.2/lib/HTML/TreeBuilder.pm)，那么您需要执行以下操作

```
my $tree = HTML::TreeBuilder->new_from_content($mech->content);  
my $table = $tree->look_down(_tag => "table", id => "moduleDetail");
for ($table->look_down(_tag => 'td')) {
  push(@array,$_->as_text());   
} 
```

# java - 休眠 enableFetchProfile -> 未知

> ID：10048037
> 
> 赞同：0
> 
> 时间：2012-04-06T19:05:38.157
> 
> 标签：java, hibernate, spring-mvc, hibernate-annotations

我想将 FetchProfile 与我的 DAO 一起用于实体示例。

这是我的实体上的注释：

```
@FetchProfiles({ @FetchProfile(name = "example-profile", fetchOverrides = {
    @FetchProfile.FetchOverride(entity = Example.class, association = "association1", mode = FetchMode.JOIN),
    @FetchProfile.FetchOverride(entity = Example.class, association = "association2", mode = FetchMode.JOIN) }) 
}) 
```

这是我的 DAO：

```
 @Autowired
private SessionFactory sessionFactory;

public Example getExample(Long id) {
    sessionFactory.getCurrentSession().enableFetchProfile("example-profile");
    return (Example) sessionFactory.getCurrentSession().get(Example.class, id);
} 
```

当我调用 getExample 时，我得到了这个异常：

> org.hibernate.UnknownProfileException：未知获取配置文件 [example-profile]

我错过了映射还是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:52:01.947

请确保您的具有此类**@FetchProfiles**的实体由`SessionFactory`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-30T15:40:59.663

修改

```
@Autowired
private SessionFactory sessionFactory;

public Example getExample(Long id) {

    Session session = sessionFactory.getCurrentSession();
    session.enableFetchProfile("example-profile");

    sessionFactory.getCurrentSession().enableFetchProfile("example-profile");
    return (Example) sessionFactory.getCurrentSession().get(Example.class, id);
} 
```

# php - 绘制路径未关闭形状

> ID：10048038
> 
> 赞同：2
> 
> 时间：2012-04-06T19:05:38.993
> 
> 标签：php, pdflib

我正在使用 PDFLib v-8 并尝试使用该路径点生成三角形。我能够生成三角形的两条边而不是完整的一条。虽然我可以再添加一条路径，但在形状不均匀的情况下，我将无法做到这一点，因为没有意识到完整的形状。

有什么可以确定完整的形状并使用 pdflib 中的路径点绘制完整路径吗？

提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T18:27:32.187

您可以使用

```
PDFLib_draw_path($triangle_path, x, y, "close stroke fitmethod=entire "); 
```

在这里，关闭选项将完成形状。

谢谢。

# wpf - 如何使用 Infragistics XamTabControl 在选项卡上放置“收藏夹”图标？

> ID：10048043
> 
> 赞同：0
> 
> 时间：2012-04-06T19:05:52.870
> 
> 标签：wpf, xaml, infragistics

我希望能够允许用户通过切换放置在每个选项卡上的星形图标将模块设置为收藏夹。这可以使用 Infragistics XamTabs 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:31:05.860

您要使用的技术是对选项卡标题进行模板化。您应该创建一个以 TabItemEx 为目标的样式并提供一个 HeaderTemplate。

在我的示例中，我在标题中添加了一个单选按钮和一个图像，它们绑定到我的视图模型中的 IsFavorite 属性，导致在选中单选按钮时图像可见。VisConverter 转换器用于切换图像的可见性属性。

在此处查看更多详细信息和我的示例。 [http://community.infragistics.com/forums/p/67815/344088.aspx#344088](http://community.infragistics.com/forums/p/67815/344088.aspx#344088)

# c - C 64 位左移失败

> ID：10048047
> 
> 赞同：8
> 
> 时间：2012-04-06T19:06:12.973
> 
> 标签：c, 64-bit, bit-shift

我在 C 中有这段代码（仅供学习）：

```
 char x;
    uint64_t total = 0;

    for(x = 20; x < 30; x++){
        total = (((((1 << x) * x) / 64) + 1) * sizeof(uint64_t));
        printf("%d - %llu\n", x, total);        
    } 
```

打印的内容：

```
20 - 2621448
21 - 5505032
22 - 11534344
23 - 24117256
24 - 50331656
25 - 104857608
26 - 218103816
27 - 18446744073625665544
28 - 18446744073575333896
29 - 18446744073508225032 
```

为什么在 x > 26 我有那些奇怪的值？我在 Ubuntu 10.10 64 位上使用 gcc 4.6.1。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-06T19:10:50.247

因为`1`是一个`int`，32位，所以`(1 << 27)*27`溢出。使用`1ull`.

关于您的评论，如果`x`是 a `uint64_t`，那么`1 << x`仍然是 a `int`，但是对于乘法，它将被转换为`uint64_t`，因此不会溢出。但是，如果`x >= 31`,`1 << x`将是未定义的行为（因为结果值不能由带符号的 32 位整数类型表示）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:11:51.473

我猜你的问题是，你用 32 位计算，然后将其分配给 64 位值

除以 64 与不移位 6 位相同

```
char x;
uint64_t one = 1;
uint64_t total = 0;

for(x = 20; x < 30; x++){
    total = ((((one << (x - 6)) * x) + 1) * sizeof(uint64_t));
    printf("%d - %llu\n", x, total);        
} 
```

还没编译

# r - 如何从data.frame中获取每一列作为data.frame（而不是向量）？

> ID：10048051
> 
> 赞同：9
> 
> 时间：2012-04-06T19:06:24.133
> 
> 标签：r, vector, dataframe

通常当你得到一列时，它是一个向量。如何将其保留为具有相同行名和相应列名的 data.frame？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-06T21:43:22.337

而不是用逗号调用所需的列，即 data.frame[,i] 使用 data.frame[i] 将类保留为 data.frame 并保留行名。

```
data.frame[,i] #As a vector
data.frame[i] #As a data.frame 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-06T19:09:40.483

使用参数 drop = FALSE，如下所示：

```
mtcars[, 1, drop = FALSE] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T19:19:06.560

如果在对 data.frame 设置子集时指定一个数字，则会得到一列 data.frame。这与矩阵子集不同，后者需要“缺失”`i`参数来返回整个列（然后将其转换为向量）。

```
# mtcars is a data.frame
mtcars[1]       # first column
str(mtcars[1])  # is still a data.frame
# 'data.frame':   32 obs. of  1 variable:
#  $ mpg: num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
# MTCARS is a matrix
MTCARS <- as.matrix(mtcars)
as.matrix(MTCARS)[1]        # only the first element
# [1] 21
str(as.matrix(MTCARS)[,1])  # the first column, as a vector
 Named num [1:32] 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
 - attr(*, "names")= chr [1:32] "Mazda RX4" "Mazda RX4 Wag" "Datsun 710" ... 
```

# asp.net - asp .net 中的 ldap Novell 身份验证

> ID：10048053
> 
> 赞同：0
> 
> 时间：2012-04-06T19:06:31.413
> 
> 标签：asp.net, asp.net-membership, forms-authentication, novell

我正在尝试使用**Novell LDAP Authentication**开发一个 Web 应用程序。我在我的表单 login.aspx 中添加了**Login 控件**，并以这种方式配置了**web.config ：**

```
<connectionStrings>
    <add connectionString="LDAP://10.0.0.100:389/cn=admin,o=pippo" name="myConnectionString"/>
   </connectionStrings>
    <authentication mode="Forms">
      <forms loginUrl="~/Account/Login.aspx" timeout="2880"/>
    </authentication>
    <membership defaultProvider="MembershipADProvider">
      <providers>
        <add name="MyADMembershipProvider"
         type="System.Web.Security.ActiveDirectoryMembershipProvider, 
         System.Web, Version=2.0.0.0, Culture=neutral, 
         PublicKeyToken=b03f5f7f11d50a3a"
         connectionStringName="myConnectionString"
         port="389"
         useSSL="false"
         connectionProtection="None"
         connectionUsername="cn=admin,o=pippo"
         connectionPassword="admin"
         enableSearchMethods="true" 
         />
      </providers>
    </membership> 
```

但是当我单击登录按钮时，我收到此错误：

**“此提供程序只能针对 Active Directory 和 ADAM 目录。”**

我注意到，如果我输入错误密码，错误消息会更改为：“登录失败：未知用户名或密码错误”。所以我认为应用程序以某种方式与 ldap 服务器连接并与之通信。

现在的问题......我必须选择哪种供应商？或者如何设置 ActiveDirectoryMembershipProvider 以便针对 LDAP Novell 进行登录？

换句话说，如何开发 LDAP 验证码在 Novell 的 LDAP 中查找用户？

提前感谢大家

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T19:13:54.350

您将需要创建一个自定义成员资格提供程序。这里有一个例子：

[http://forums.asp.net/t/970391.aspx/1](http://forums.asp.net/t/970391.aspx/1)

# sql - 查找视图中使用的别名的真实列名？

> ID：10048056
> 
> 赞同：13
> 
> 时间：2012-04-06T19:07:03.440
> 
> 标签：sql, sql-server, tsql

假设我有一个视图，其中一些列名是别名，例如本例中的“surName”：

```
CREATE VIEW myView AS
    SELECT  
            firstName,
            middleName,
            you.lastName surName
    FROM 
            myTable me
            LEFT OUTER JOIN yourTable you
            ON me.code = you.code
GO 
```

我可以使用 INFORMATION_SCHEMA 视图检索有关视图的一些信息。
例如，查询

```
SELECT column_name AS ALIAS, data_type AS TYPE
FROM information_schema.columns 
WHERE table_name = 'myView' 
```

产量：

```
----------------
|别名 |类型 |
 ----------------
|名字 |nchar|
|中间名|nchar|
|姓氏 |nchar|
 ----------------

```

但是，我也想知道实际的列名。理想情况下：

```
--------------------------
|别名 |类型 |真实姓名 |
 --------------------------
|名字 |nchar|名字 |
|中间名|nchar|中间名|
|姓氏|nchar|姓氏|
 --------------------------

```

**如何根据别名确定真正的列名是什么？** 必须有某种方法可以使用 sys 表和/或 INFORMATION_SCHEMA 视图来检索此信息。

* * *

**编辑：** 我可以接近这种可憎的东西，这类似于 Arion 的回答：

```
SELECT
    c.name AS ALIAS,
    ISNULL(type_name(c.system_type_id), t.name) AS DATA_TYPE,
    tablecols.name AS REALNAME
FROM 
    sys.views v
    JOIN sys.columns c ON c.object_id = v.object_id
    LEFT JOIN sys.types t ON c.user_type_id = t.user_type_id
    JOIN sys.sql_dependencies d ON d.object_id = v.object_id 
        AND c.column_id = d.referenced_minor_id
    JOIN sys.columns tablecols ON d.referenced_major_id = tablecols.object_id 
        AND tablecols.column_id = d.referenced_minor_id 
        AND tablecols.column_id = c.column_id
WHERE v.name ='myView' 
```

这产生：

```
--------------------------
|别名 |类型 |真实姓名 |
 --------------------------
|名字 |nchar|名字 |
|中间名|nchar|中间名|
|surName |nchar|代码 |
|姓氏|nchar|姓氏|
 --------------------------

```

但是第三条记录是错误的——任何使用“JOIN”子句创建的视图都会发生这种情况，因为有两列具有相同的“column_id”，但在不同的表中。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-07T12:26:53.723

鉴于这种观点：

```
CREATE VIEW viewTest
AS
SELECT
    books.id,
    books.author,
    Books.title AS Name
FROM
    Books 
```

我可以看到你可以通过这样做得到使用的列和使用的表：

```
SELECT * 
FROM INFORMATION_SCHEMA.VIEW_COLUMN_USAGE AS UsedColumns 
WHERE UsedColumns.VIEW_NAME='viewTest'

SELECT * 
FROM INFORMATION_SCHEMA.VIEW_TABLE_USAGE AS UsedTables 
WHERE UsedTables.VIEW_NAME='viewTest' 
```

这适用于 sql server 2005+。请参阅[此处的参考](http://msdn.microsoft.com/en-us/library/ms190492%28v=sql.90%29.aspx)

**编辑**

给出同样的看法。试试这个查询：

```
SELECT
    c.name AS columnName,
    columnTypes.name as dataType,
    aliases.name as alias
FROM 
sys.views v 
JOIN sys.sql_dependencies d 
    ON d.object_id = v.object_id
JOIN .sys.objects t 
    ON t.object_id = d.referenced_major_id
JOIN sys.columns c 
    ON c.object_id = d.referenced_major_id 
JOIN sys.types AS columnTypes 
    ON c.user_type_id=columnTypes.user_type_id
    AND c.column_id = d.referenced_minor_id
JOIN sys.columns AS aliases
    on c.column_id=aliases.column_id
    AND aliases.object_id = object_id('viewTest')
WHERE
    v.name = 'viewTest'; 
```

它为我返回了这个：

```
columnName  dataType  alias

id          int       id
author      varchar   author
title       varchar   Name 
```

这也在 sql 2005+ 中进行了测试

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-06T19:12:23.937

我认为你不能。

选择查询隐藏了对其执行的实际数据源。因为您可以查询任何内容，即视图、表，甚至链接的远程服务器。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-04-13T14:05:22.587

花了几个小时试图找到这个问题的答案，并反复遇到不起作用的解决方案和似乎最终放弃的海报，我最终偶然发现了一个似乎有效的答案：

[https://social.msdn.microsoft.com/Forums/windowsserver/en-US/afa2ed2b-62de-4a5e-ae70-942e75f887a1/find-out-original-columns-name-when-used-in-a-view- with-alias?forum=transactsql](https://social.msdn.microsoft.com/Forums/windowsserver/en-US/afa2ed2b-62de-4a5e-ae70-942e75f887a1/find-out-original-columns-name-when-used-in-a-view-with-alias?forum=transactsql)

我相信，下面的 SQL 将返回您正在寻找的内容，它确实在做我需要的事情，并且看起来也表现良好。

```
SELECT  name
    , source_database
    , source_schema
    , source_table
    , source_column
    , system_type_name
    , is_identity_column
FROM    sys.dm_exec_describe_first_result_set (N'SELECT * from ViewName', null, 1) 
```

有关该函数的文档`sys.dm_exec_describe_first_result_set`可以在此处找到，它在 SQL Server 2012 及更高版本中可用：

[https://docs.microsoft.com/en-us/sql/relational-databases/system-dynamic-management-views/sys-dm-exec-describe-first-result-set-transact-sql](https://docs.microsoft.com/en-us/sql/relational-databases/system-dynamic-management-views/sys-dm-exec-describe-first-result-set-transact-sql)

完全归功于链接上的海报，我自己没有解决这个问题，但我想在这里发布它，以防它对其他搜索此信息的人有用，因为我发现这个线程比我链接到的那个更容易.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-01T04:13:21.567

不是完美的解决方案；但是，可以高度准确地解析 view_definition，特别是如果代码组织良好且具有一致的别名 'as'。此外，可以在别名后解析逗号“，”。

注意：select 子句中的最后一个字段没有逗号，我无法排除用作注释的项目（例如在视图文本中交错使用--）

我为名为“My_Table”的表编写了以下内容，并相应地查看了名为“vMy_Table”的视图

```
select alias, t.COLUMN_name
from 
(
select VC.COLUMN_NAME, 

case when
ROW_NUMBER () OVER (
partition by C.COLUMN_NAME order by 
CHARINDEX(',',VIEW_DEFINITION,CHARINDEX(C.COLUMN_NAME,VIEW_DEFINITION))- 
CHARINDEX(VC.COLUMN_NAME,VIEW_DEFINITION)

) = 1

then 1
else 0 end
as lenDiff

,C.COLUMN_NAME as alias

 ,CHARINDEX(',',VIEW_DEFINITION,CHARINDEX(C.COLUMN_NAME,VIEW_DEFINITION)) diff1
 , CHARINDEX(VC.COLUMN_NAME,VIEW_DEFINITION) diff2

 from INFORMATION_SCHEMA.VIEW_COLUMN_USAGE VC
inner join INFORMATION_SCHEMA.VIEWS V on V.TABLE_NAME = 'v'+VC.TABLE_Name
inner join information_schema.COLUMNS C on C.TABLE_NAME = 'v'+VC.TABLE_Name
where VC.TABLE_NAME = 'My_Table'
and CHARINDEX(',',VIEW_DEFINITION,CHARINDEX(C.COLUMN_NAME,VIEW_DEFINITION))- 
CHARINDEX(VC.COLUMN_NAME,VIEW_DEFINITION) >0
)
t

where lenDiff = 1 
```

希望这会有所帮助，我期待您的反馈

# python - python中的bip geom图尝试

> ID：10048059
> 
> 赞同：0
> 
> 时间：2012-04-06T19:07:23.970
> 
> 标签：python, networkx

我有 2 天大的时间使用 python 和一般编码，我一直在制作一个 2mode 的随机几何图。为此，我一直在[这里查看networkx 中的代码](https://networkx.lanl.gov/trac/browser/networkx/networkx/generators/geometric.py)

我开始使用以下逻辑

```
import networkx as nx
def my_bipartite_geom_graph(a, b, radius, dim):

G=nx.Graph()
A=nx.Graph()
A.name="a node set"
A.add_nodes_from(range(a)) 
for n in A:
    A.node[n]['pos']=[random.random() for i in range(0,dim)]

B=nx.Graph()
B.name="b node set"
B.add_nodes_from(range(b)) 
for n in B:
    B.node[n]['pos']=[random.random() for i in range(0,dim)]

G=nx.disjoint_union(A,B)

nodesa = A.nodes(data=True)
nodesb = B.nodes(data=True)
while nodesa:
    u,du = nodesa.pop()
    pu = du['pos']
    for v,dv in nodesb:
        pv = dv['pos']
        d = sum(((a-b)**2 for a,b in zip(pu,pv)))
        if d <= radius**2:
            G.add_edge(u,v)
return G 
```

这会返回一个图表，但显然不是我所希望的。任何有关如何更好地解决此问题的指示将不胜感激。

最好的祝愿

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T19:40:04.393

问题是`nx.disjoint_union`重新编号您的节点，以便它们是不同的。这意味着`B[n] != G[n]`。因此，其中的节点标签`B`包含图中`A`的节点`G`。

这是解决它的一种方法：

```
import networkx as nx
def my_bipartite_geom_graph(a, b, radius, dim):

    G=nx.Graph()
    G.add_nodes_from(range(a+b))
    for n in range(a):
        G.node[n]['pos']=[random.random() for i in range(0,dim)]
        G.node[n]['type'] = 'A'

    for n in range(a, a+b):
        G.node[n]['pos']=[random.random() for i in range(0,dim)]
        G.node[n]['type'] = 'B'

    nodesa = [(node, data) for node, data in G.nodes(data=True) if data['type'] == 'A']
    nodesb = [(node, data) for node, data in G.nodes(data=True) if data['type'] == 'B']

    while nodesa:
        u,du = nodesa.pop()
        pu = du['pos']
        for v,dv in nodesb:
            pv = dv['pos']
            d = sum(((a-b)**2 for a,b in zip(pu,pv)))
            if d <= radius**2:
                G.add_edge(u,v)
    return G 
```

# objective-c - 如何打开文件/目录获取信息窗口？

> ID：10048060
> 
> 赞同：6
> 
> 时间：2012-04-06T19:07:40.617
> 
> 标签：objective-c, macos

有没有办法以编程方式在我的应用程序中打开 Finder 的“获取信息”窗口以获取某些路径？

![获取信息窗口](../Images/6d74fd38909432cc3d08ec071a8e4c96.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-09T11:29:37.830

还有一个简单的解决方案，你可以在苹果的“照片搜索”项目中看到。

以下是可用于根据示例显示单个文件的“获取信息”窗口的代码。

```
- (void)infoButtonAction:(NSOutlineView *)sender {
    // Access the row that was clicked on and open that image
    NSInteger row = [sender clickedRow];
    SearchItem *item = [resultsOutlineView itemAtRow:row];
    // Do a "reveal" in finder
    if ([item filePathURL]) {
        NSPasteboard *pboard = [NSPasteboard pasteboardWithUniqueName];
        [pboard declareTypes:[NSArray arrayWithObject:NSStringPboardType] owner:nil];
        [pboard setString:[[item filePathURL] path]  forType:NSStringPboardType];
        NSPerformService(@"Finder/Show Info", pboard);
    }
} 
```

我根据需要显示多个文件的对话框进一步修改了代码，如下所示：

```
NSPasteboard *pboard = [NSPasteboard pasteboardWithUniqueName];
[pboard declareTypes:[NSArray arrayWithObject:NSStringPboardType] owner:nil];

NSMutableArray *fileList = [NSMutableArray new];

//Add as many as file's path in the fileList array
for(FileItem *item in fileItems) {
    [fileList addObject:[[item.filePath filePathURL] path]];
}

[pboard setPropertyList:fileList forType:NSFilenamesPboardType];
NSPerformService(@"Finder/Show Info", pboard); 
```

希望这会有所帮助，仅供参考，这将适用于 Lion 及以后的沙盒应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-26T09:30:20.510

我使用此代码打开一个文件“获取信息”窗口

```
NSPasteboard *pboard = [NSPasteboard pasteboardWithUniqueName];
[pboard declareTypes:[NSArray arrayWithObject:NSStringPboardType] owner:nil];
NSString *path = [selectedDuplicateItem getFileItemPath];
[pboard setString:path forType:NSStringPboardType];
NSPerformService(@"Finder/Show Info", pboard); 
```

但是，有一些错误。例如，如果我的文件路径包含空格，`path = @"/Users/alexanderyolkin/Downloads/DETest/Folder/LICENSE 2"`则 NSPerformService 会打开两个窗口“获取信息” - 用于路径和没有空格的同一文件或用于文件夹。

所以，解决方案是在使用 `[pboard setPropertyList:fileList forType:NSFilenamesPboardType];`

代码是

```
NSPasteboard *pboard = [NSPasteboard pasteboardWithUniqueName];
[pboard declareTypes:[NSArray arrayWithObject:NSStringPboardType] owner:nil];

NSString *path = [selectedDuplicateItem getFileItemPath];
NSMutableArray *fileList = [NSMutableArray new];
[fileList insertObject:path atIndex:0];

[pboard setPropertyList:fileList forType:NSFilenamesPboardType];
NSPerformService(@"Finder/Show Info", pboard); 
```

那是完美的工作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T19:32:35.620

使用一些applescript，这很容易：

```
set macpath to POSIX file "/Users/rross/test.applescript" as alias
tell application "Finder" to open information window of macpath 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T19:33:13.967

AFAIK 没有 API 来获取应用内显示的信息面板。（我欢迎在这一点上进行更正。）想到的最接近的事情是通过 Quick Look API 提供的[预览面板。](https://developer.apple.com/library/mac/#documentation/Quartz/Reference/QLPreviewPanel_Class/Reference/Reference.html)

我认为您需要构建自己的所有信息都可以通过[NSWorkspace](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSWorkspace_Class/Reference/Reference.html)和[NSFileManager](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsfilemanager_Class/Reference/Reference.html)类获得。

# python - 如何腌制一个python函数及其依赖项？

> ID：10048061
> 
> 赞同：22
> 
> 时间：2012-04-06T19:07:50.227
> 
> 标签：python, function, pickle

作为这个问题的后续： [是否有一种简单的方法来腌制 python 函数（或以其他方式序列化其代码）？](https://stackoverflow.com/questions/1253528/is-there-an-easy-way-to-pickle-a-python-function-or-otherwise-serialize-its-cod)

我想从上面的帖子中看到这个项目符号的一个例子：

“如果该函数引用了您需要获取的全局变量（包括导入的模块、其他函数等），您也需要将它们序列化，或者在远程端重新创建它们。我的示例只是给它远程进程的全局命名空间。 "

我有一个简单的测试，我正在使用 marshal 将函数字节码写入文件：

```
def g(self,blah): 
    print blah

def f(self):
    for i in range(1,5):
        print 'some function f'
        g('some string used by g')

data = marshal.dumps(f.func_code)

file = open('/tmp/f2.txt', 'w')
file.write(data) 
```

然后开始一个新的python实例，我这样做：

```
file = open('/tmp/f2.txt', 'r')
code = marshal.loads(file.read())
func2 = types.FunctionType(code, globals(), "some_func_name");
func2('blah') 
```

这导致：

```
NameError: global name 'g' is not defined 
```

这与我为包含 g 所做的不同方法无关。我已经尝试过基本相同的方法将 g 作为 f 发送，但 f 仍然看不到 g。如何让 g 进入全局命名空间，以便 f 在接收过程中使用它？

有人还建议将 pyro 视为如何执行此操作的示例。我已经尝试理解disco项目中的相关代码。我参加了他们的 dPickle 课程并尝试在独立应用程序中重新创建他们的 disco/tests/test_pickle.py 功能，但没有成功。我的实验在使用转储调用进行函数编组时遇到问题。无论如何，也许接下来是火焰兵探索。

总而言之，我所追求的基本功能是能够通过网络发送一个方法，并让所有基本的“工作区”方法随它一起发送（如 g）。

答案更改的示例：

工作函数_writer：

```
import marshal, types

def g(blah): 
    print blah

def f():
    for i in range(1,5):
        print 'some function f'
        g('blah string used by g')

f_data = marshal.dumps(f.func_code)
g_data = marshal.dumps(g.func_code);

f_file = open('/tmp/f.txt', 'w')
f_file.write(f_data)

g_file = open('/tmp/g.txt', 'w')
g_file.write(g_data) 
```

工作函数_reader：

```
import marshal, types

f_file = open('/tmp/f.txt', 'r')
g_file = open('/tmp/g.txt', 'r')

f_code = marshal.loads(f_file.read())
g_code = marshal.loads(g_file.read())

f = types.FunctionType(f_code, globals(), 'f');
g = types.FunctionType(g_code, globals(), 'g');

f() 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-06-03T06:35:41.757

***2020 年 9 月更新：** 请参阅下面@ogrisel 的评论。在我于 2013 年写下这个答案的原始版本后不久，PiCloud 的开发人员就搬到了 Dropbox，尽管七年后很多人仍在使用 cloudpickle 模块。该模块进入了 Apache Spark，并在那里继续得到维护和改进。我正在相应地更新下面的示例和背景文本。*

# 云泡菜

cloudpickle包能够[腌制](https://github.com/cloudpipe/cloudpickle)一个函数、方法、类，甚至是一个 lambda，以及任何依赖项。要尝试一下，`pip install cloudpickle`然后：

```
import cloudpickle

def foo(x):
    return x*3

def bar(z):
    return foo(z)+1

x = cloudpickle.dumps(bar)
del foo
del bar

import pickle

f = pickle.loads(x)
print(f(3))  # displays "10" 
```

换句话说，只需调用`cloudpickle.dump()`或`cloudpickle.dumps()`以与您使用相同的方式`pickle.*`，然后使用本机`pickle.load()`或`pickle.loads()`解冻。

# 背景

PiCcloud.com 发布了`cloud`LGPL 下的 python 包，其他开源项目也很快开始使用它（google for`cloudpickle.py`看到一些）。picloud.com 的人们有动力投入到通用代码酸洗工作上——他们的整个业务都是围绕它建立的。这个想法是，如果您有`cpu_intensive_function()`并且想要在 Amazon 的 EC2 网格上运行它，您只需替换：

```
cpu_intensive_function(some, args) 
```

和：

```
cloud.call(cpu_intensive_function, some, args) 
```

后者用于`cloudpickle`提取任何依赖的代码和数据，将其发送到 EC2，运行它，并在您调用`cloud.result()`.

Picloud 以毫秒为单位计费，它非常便宜，我一直使用它进行蒙特卡罗模拟和金融时间序列分析，当时我需要数百个 CPU 内核，每个内核只需要几秒钟。多年后，我仍然不能说足够多的好话，我什至没有在那里工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-06T19:23:35.617

> 我已经尝试过基本相同的方法将 g 作为 f 发送，但 f 仍然看不到 g。如何让 g 进入全局命名空间，以便 f 在接收过程中使用它？

将其分配给全局名称`g`。（我看到您分配`f`给`func2`而不是分配给`f`。如果您正在使用 执行类似的`g`操作，那么很清楚为什么`f`找不到`g`。请记住，名称解析发生在运行时 -`g`直到您调用时才会查找`f`。）

当然，我猜是因为您没有显示用于执行此操作的代码。

最好创建一个单独的字典，用于您要取消腌制的函数的全局命名空间——一个沙箱。这样，它们的所有全局变量都将与您正在执行此操作的模块分开。所以您可以执行以下操作：

```
sandbox = {}

with open("functions.pickle", "rb") as funcfile:
    while True:
        try:
            code = marshal.load(funcfile)
        except EOFError:
             break
        sandbox[code.co_name] = types.FunctionType(code, sandbox, code.co_name) 
```

在此示例中，我假设您已将所有函数的代码对象一个接一个地放在一个文件中，并且在读取它们时，我获取代码对象的名称并将其用作函数对象名称的基础以及它在沙盒字典中存储的名称。

在 unpickled 函数内部，沙盒字典是它们的`globals()`，所以在内部`f()`，`g`从`sandbox["g"]`. 那么调用`f`将是：`sandbox["f"]("blah")`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-07T00:06:23.620

每个模块都有自己的全局变量，没有通用的全局变量。我们可以将恢复的功能“植入”到某个模块中，并像使用普通模块一样使用它。

- 节省 -

```
import marshal
def f(x):
    return x + 1
def g(x):
    return f(x) ** 2
funcfile = open("functions.pickle", "wb")
marshal.dump(f.func_code, funcfile)
marshal.dump(g.func_code, funcfile)
funcfile.close() 
```

- 恢复 -

```
import marshal
import types
open('sandbox.py', 'w').write('')  # create an empty module 'sandbox'
import sandbox
with open("functions.pickle", "rb") as funcfile:
    while True:
        try:
            code = marshal.load(funcfile)
        except EOFError:
             break
        func = types.FunctionType(code, sandbox.__dict__, code.co_name)
        setattr(sandbox, code.co_name, func)   # or sandbox.f = ... if the name is fixed
assert sandbox.g(3) == 16   # f(3) ** 2
# it is possible import them from other modules
from sandbox import g 
```

* * *

编辑：
您也可以从外部导入一些模块。例如“sys”到“sandbox”命名空间：

```
sandbox.sys = __import__('sys') 
```

或相同：

```
exec 'import sys' in sandbox.__dict__
assert 'sys' in sandbox, 'Verify imported into sandbox' 
```

**如果您不是在 ipython 交互中而是在 python 程序或普通 python 交互中执行，**您的原始代码将起作用！！！****

 **Ipython 使用了一些奇怪的命名空间，它不是 sys.modules 中任何模块的**字典**。普通 python 或任何主程序`sys.modules['__main__'].__dict__`用作 globals()。任何使用的模块`that_module.__dict__`都可以，只有 ipython 交互是一个问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-10-15T18:42:52.230

当被腌制的功能与腌制一起在主模块中时，莳萝（以及其他腌制变体、cloudpickle 等）似乎可以工作。如果您要从另一个模块中提取函数，则在取消提取时必须存在该模块名称。我似乎无法找到解决此限制的方法。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-10-16T21:17:28.653

`__main__`通过导入和使用该模块中可用的方法，您可以更好地处理全局对象。这就是[dill](http://pythonhosted.org/dill/)所做的，以便在 python 中序列化几乎任何东西。基本上，当 dill 序列化一个交互式定义的函数时，它会`__main__`在序列化和反序列化端使用一些名称修饰，从而`__main__`生成一个有效的模块。

```
>>> import dill
>>> 
>>> def bar(x):
...   return foo(x) + x
... 
>>> def foo(x):
...   return x**2
... 
>>> bar(3)
12
>>> 
>>> _bar = dill.loads(dill.dumps(bar))
>>> _bar(3)
12 
```

实际上，dill 将它的类型注册到`pickle`注册表中，所以如果您有一些使用的黑盒代码`pickle`并且您不能真正编辑它，那么只需导入 dill 就可以神奇地使其工作，而无需猴子修补第 3 方代码。

或者，如果您希望将整个解释器会话作为“python 图像”发送，dill 也可以这样做。

```
>>> # continuing from above
>>> dill.dump_session('foobar.pkl')
>>>
>>> ^D
dude@sakurai>$ python
Python 2.7.5 (default, Sep 30 2013, 20:15:49) 
[GCC 4.2.1 (Apple Inc. build 5566)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import dill
>>> dill.load_session('foobar.pkl')
>>> _bar(3)
12 
```

您可以轻松地将图像通过 ssh 发送到另一台计算机，然后从您离开的地方开始，只要存在 pickle 的版本兼容性以及关于 python 更改和正在安装的东西的常见警告。**

# c# - 另一个 .net 自定义 cms

> ID：10048062
> 
> 赞同：0
> 
> 时间：2012-04-06T19:07:57.110
> 
> 标签：c#, content-management-system, domain-driven-design, .net

我正在尝试将用 php 编写的自定义 cms 转换为 .net c#。我正在考虑使用 cms 作为学习项目。我将使用 C#、NHibernate ORM 层、mssql、mvc3 和 jquery。

我知道有很多商业广告或开源 cms，但我仍将花费一些空闲时间尝试学习从事此类项目的新技术。

那么，有没有人愿意分享一些关于创建 cms 域模型、有用链接、想法等的想法。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:53:44.230

一个真正基本的 CMS 包含 3 个元素：

*   一个数据库表来保存你的“页面”。表结构为“名称”和“内容”
*   将类型请求转换`/cms/pagename`为固定控制器的路由，调用的方法`cms`和`pagename`作为参数
*   可嵌入的 html 编辑器

现在，有两种方法可以调用您的“页面”。它是创建模式或查看/编辑模式。

在“创建”模式下，页面被请求但它还没有在数据库中（例如`cms/announcement1`）。在这种模式下，您创建一个由 html 编辑器组成的视图，并在提交时将页面保存到数据库中。

在“查看”模式下，页面被请求并且在数据库中。您执行任何必要的重写（例如，您将表单的内部链接重写为`[cms/pagename]`完全可路由的 http 地址）并呈现内容。

如果用户被授权编辑页面，您还会显示一个“编辑”按钮，然后该按钮调用 html 编辑器，页面已加载并准备好进行编辑。

就是这样。

有大量附加元素（缓存、不同的内置页面类型、嵌入图像、youtube、预格式化文本）等，但所有这些都是可选的，当您已经实现核心时，您可以引入新功能。

一旦我按照上面的结构编写了一个简单的 CMS，它就是一个更大的解决方案的一部分，到目前为止它已经成功部署了数百次。自定义 CMS 的一个优点是它非常简单且易于维护。

# python - 从列表中弹出随机元素的最pythonic方法是什么？

> ID：10048069
> 
> 赞同：109
> 
> 时间：2012-04-06T19:08:55.813
> 
> 标签：python, list, random

假设我有一个`x`长度未知的列表，我想从中随机弹出一个元素，以便该列表之后不包含该元素。最pythonic的方法是什么？

我可以使用, 和,的相当不方便的组合来做到这一点`pop`，并希望看到更短或更好的解决方案：`random.randint``len`

```
import random
x = [1,2,3,4,5,6]
x.pop(random.randint(0,len(x)-1)) 
```

我想要实现的是从列表中连续弹出随机元素。（即，随机弹出一个元素并将其移至字典，随机弹出另一个元素并将其移至另一字典，...）

请注意，我使用的是 Python 2.6，并且没有通过搜索功能找到任何解决方案。

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2012-04-06T19:17:22.770

首先，您似乎在做的事情看起来并不像 Pythonic。你不应该从列表中间删除东西，因为在我知道的所有 Python 实现中，列表都是作为数组实现的，所以这是一个`O(n)`操作。

如果你真的需要这个功能作为算法的一部分，你应该检查一个[`blist`](https://pypi.python.org/pypi/blist)支持从中间有效删除的数据结构。

在纯 Python 中，如果您不需要访问其余元素，您可以做的只是先打乱列表，然后对其进行迭代：

```
lst = [1,2,3]
random.shuffle(lst)
for x in lst:
  # ... 
```

如果你*真的需要*剩余部分（这有点代码味道，恕我直言），至少你现在可以`pop()`从列表的末尾（这很快！）：

```
while lst:
  x = lst.pop()
  # do something with the element 
```

一般来说，如果你使用更实用的风格而不是改变状态（就像你对列表所做的那样），你通常可以更优雅地表达你的程序。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2012-04-06T19:13:22.363

你不会比这更好，但这里有一点改进：

```
x.pop(random.randrange(len(x))) 
```

文档[`random.randrange()`](http://docs.python.org/library/random.html#random.randrange)：

> random.randrange([start], stop[, step])从 .
> 返回一个随机选择的元素`range(start, stop, step)`。这等效于`choice(range(start, stop, step))`，但实际上并不构建范围对象。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-12-30T03:45:01.903

如果其余列表元素的顺序无关紧要，则从列表中删除随机索引处的*单个元素：*

```
import random

L = [1,2,3,4,5,6]
i = random.randrange(len(L)) # get random index
L[i], L[-1] = L[-1], L[i]    # swap with the last element
x = L.pop()                  # pop last element O(1) 
```

交换用于避免从列表中间删除时的 O(n) 行为。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-04-06T19:30:20.063

这是另一种选择：为什么不*先*对列表进行洗牌，然后开始弹出其中的元素，直到没有更多元素为止？像这样：

```
import random

x = [1,2,3,4,5,6]
random.shuffle(x)

while x:
    p = x.pop()
    # do your stuff with p 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2020-11-12T00:12:54.113

尽管许多答案表明使用它`random.shuffle(x)`并且`x.pop()`在大数据上非常缓慢。`10000`启用随机播放时，元素列表所需的时间`6 seconds`。当随机播放被禁用时，速度是`0.2s`

测试了上述所有给定方法后最快的方法原来是由@jfs 编写的

```
import random

L = ['1',2,3,'4'...1000] #you can take mixed or pure list
i = random.randrange(len(L)) # get random index
L[i], L[-1] = L[-1], L[i]    # swap with the last element
x = L.pop()                  # pop last element O(1) 
```

为了支持我的主张，这里是[这个来源的时间复杂度图表](https://wiki.python.org/moin/TimeComplexity) [![在此处输入图像描述](../Images/0140508e21a7b5147fc04303e79070ec.png)](https://i.stack.imgur.com/98kIZ.png)

* * *

## **如果列表中没有重复项，**

您也可以使用集合来实现您的目的。一旦列表被设置为重复项，将被删除。`remove by value`和`remove random`成本`O(1)`，即非常有效。这是我能想到的最干净的方法。

```
L=set([1,2,3,4,5,6...]) #directly input the list to inbuilt function set()
while 1:
    r=L.pop()
    #do something with r , r is random element of initial list L. 
```

与`lists`哪个支持`A+B`选项不同，还`sets`支持`A-B (A minus B)`和。当您想要对数据执行逻辑操作时非常有用。`A+B (A union B)``A.intersection(B,C,D)`

* * *

## 选修的

如果您希望在列表的头部和尾部执行操作时加快速度，请使用 python dequeue（双端队列）来支持我的声明，这里是图像。一张图片就是千言万语。

[![在此处输入图像描述](../Images/b79406ced5e7211acc2c5c4b39bb63c0.png)](https://i.stack.imgur.com/mF3af.png)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-06-18T02:44:18.427

我知道这是一个老问题，但只是为了记录：

如果您（搜索相同问题的人）正在做我认为您正在做的事情，那就是从列表中随机选择 k 个项目（其中 k<=len(yourlist)），但要确保每个项目永远不会被选中不止一次（=无替换采样），您可以像@jf-sebastian 建议的那样使用[random.sample 。](https://docs.python.org/3/library/random.html#random.sample)但是在不了解用例的情况下，我不知道这是否是您所需要的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-04-06T19:14:55.610

一种方法是：

```
x.remove(random.choice(x)) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-10-26T09:19:20.540

虽然没有从列表中弹出，但我在尝试从没有重复的列表中获取 X 个随机项目时在 Google 上遇到了这个问题。这是我最终使用的：

```
items = [1, 2, 3, 4, 5]
items_needed = 2
from random import shuffle
shuffle(items)
for item in items[:items_needed]:
    print(item) 
```

这可能会稍微低效，因为您正在改组整个列表但只使用其中的一小部分，但我不是优化专家，所以我可能是错的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-12-06T23:17:35.763

这个答案来自[@niklas-b](https://stackoverflow.com/users/916657/niklas-b)：

“*您可能想使用类似[pypi.python.org/pypi/blist](http://pypi.python.org/pypi/blist)*的东西”

引用[PYPI 页面](http://pypi.python.org/pypi/blist)：

> ...一种类似列表的类型，具有更好的渐近性能和在小列表上的类似性能
> 
> blist 是 Python 列表的直接替代品，可在修改大型列表时提供更好的性能。blist 包还提供 sortedlist、sortedset、weaksortedlist、weaksortedset、sorteddict 和 btuple 类型。

***有人会假设随机访问/随机运行端的性能降低***，因为它是一种“写入时复制”数据结构。这违反了 Python 列表中的许多用例假设，***因此请谨慎使用***。

但是，如果您的主要用例是使用列表做一些奇怪和不自然的事情（如@OP 给出的强制示例，或者我的 Python 2.6 FIFO queue-with-pass-over 问题），那么这将非常适合该法案.

# javascript - 当您在模式之外单击时，facebox 1.3 不会关闭对话框？

> ID：10048070
> 
> 赞同：1
> 
> 时间：2012-04-06T19:08:58.283
> 
> 标签：javascript, jquery, validation, facebox, frontend

Facebox 1.3 的这个功能与之前的版本不同，如果您在模式窗口之外单击，它会使其淡出。我有一个通过 AJAX 调用加载的表单，并且正在使用 jQuery Validation 插件来阻止它加载。任何想法如何防止这种行为？我更喜欢新版本的外观...

我已将此主题发布到 Google 群组中，但还没有答案，所以我不知道还有什么可以尝试的。任何指针将不胜感激。

Facebox JS 位于：[http ://defunkt.io/facebox/](http://defunkt.io/facebox/)

完全删除覆盖对我没有用......但更重要的是......这是否有效？

```
 $(document).bind('close.facebox', function() {
  $(document).unbind('keydown.facebox')
$('#facebox').fadeOut(function() {
  $('#facebox .content').removeClass().addClass('content')
  $('#facebox .loading').remove()
  $(document).trigger('afterClose.facebox')

  $('#facebox').find('form').each('div.formError').hide(); 
```

//我想在关闭facebox时删除每个div...将它与jQuery Validation Engine一起使用

```
})
hideOverlay()
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-11-28T10:18:02.317

```
$(document).bind('loading.facebox', function() {
    $(document).unbind('keydown.facebox');
    $('#facebox_overlay').unbind('click');
}); 
```

# kml - KML 试图引用 jar 内的 I gif 文件

> ID：10048072
> 
> 赞同：0
> 
> 时间：2012-04-06T19:09:00.493
> 
> 标签：kml

我有一个带有图像 gif 文件的 GroundOverlay。当我在 Eclipse 调试器中时，它会很好地加载图像。

但是当我们构建我们的项目以便将其全部嵌入到一个 jar 文件中时，Google Earh 不再知道如何找到该 gif。gif 文件是否需要在 jar 之外，或者有没有办法引用 jar 内部的文件？

非常感谢你！！！！！！！！！！！！！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T07:45:13.970

您没有提供很多关于如何在 KMZ 中引用该文件的信息。您可能需要查看这篇文章以获取有关如何在 KMZ 中引用文件的更多信息： [https ://developers.google.com/kml/documentation/kmzarchives](https://developers.google.com/kml/documentation/kmzarchives)

# c# - WebSocket 连接创建 IOException

> ID：10048073
> 
> 赞同：0
> 
> 时间：2012-04-06T19:09:04.993
> 
> 标签：c#, javascript, sockets, websocket

我正在经历“似乎”是一个独特的问题。我现在有一个客户端/服务器模型，它从 Windows 表单获取输入并将其推送到我从头开始编写的服务器，从那里，它应该通过 websocket 被拉到网页。

我刚刚克服了握手并有效地建立了联系；但是，我的 onMessage 方法似乎从未受到打击（无论我向它发送文本的时间有多快/多晚），而且它似乎在理论上会触发时，会发生其他事情......

当我从向服务器发送输入的客户端发送文本时，它会传递第一行并等待第二行。服务器接收此输入并将其写入所有连接的“输出”客户端。这意味着包括我的 websocket。这是我迷路的地方。第一行被“写入”（根据服务器），但“onmessage”事件从未发生。如果我向服务器发送第二行，在尝试写入时，服务器会抛出异常，范围为“无法将数据写入传输连接：已建立的连接被主机中的软件中止”。并且客户端触发onclose。

也许有人可以提供一些见解。这是我的 websocket 代码：

```
<!DOCTYPE html>
<meta charset="utf-8" />
<html>
<head>
<script language="javascript" type="text/javascript">
  var wsUri = "ws://localhost:9001";
  var output;

  function init()
  {
    writeToScreen("Starting");
    testWebSocket();
  }

  function testWebSocket()
  {
    websocket = new WebSocket(wsUri);
    websocket.async = false;
    writeToScreen("Instantiated");
    websocket.onopen = function(evt) { onOpen(evt) };
    websocket.onclose = function(evt) { onClose(evt) };
    websocket.onmessage = function(evt) { onMessage(evt) };
    websocket.onerror = function(evt) { onError(evt) };
    writeToScreen("Evented");
    //onOpen(null);
  }

  function onOpen(evt)
  {
      try
      {
        writeToScreen("CONNECTED");
      }
      catch( e )
      {
          writeToScreen(e);
      }
  }

  function onClose(evt)
  {
    writeToScreen("DISCONNECTED");
  }

  function onMessage(evt)
  {
        try
        {
            writeToScreen("Message");
            writeToScreen("<span style=\"color: blue;\">RESPONSE: " + evt.data+"</span>");
        }
        catch( e )
        {
            writeToScreen(e);
        }
  }

  function onError(evt)
  {
    writeToScreen("<span style=\"color: red;\">ERROR:</span> " + evt.data);
  }

  function doSend(message)
  {
    writeToScreen("SENT: " + message); 
    websocket.send(message);
  }

  function writeToScreen(message)
  {
        output = document.getElementById("output");
        var pre = document.createElement("p");
        pre.style.wordWrap = "break-word";
        pre.innerHTML = message;
        output.appendChild(pre);
  }

  window.addEventListener("load", init, false);

</script>
</head>
<body>
<div id="output">
</div>
</body>
</html> 
```

及其对应的输出：

```
Starting

Instantiated

Evented

CONNECTED

DISCONNECTED 
```

这是服务器“写入”方法（来自我编写并继承自的类）：

```
public virtual void WriteLine(String Argument)
{
    if (this.ClientStream == null)
    {
        try
        {
            this.ClientStream = new NetworkStream(this.ClientSocket);
            this.WriteLine(Argument);
            return;
        }
        catch (Exception e)
        {
            throw new Exception("Exception encountered while writting to Client.\n" + e.Message);
        }
    }
    else if (this.OutputWriter == null)
    {
        try
        {
            this.OutputWriter = new StreamWriter(this.ClientStream);
            this.WriteLine(Argument);
            return;
        }
        catch (Exception e)
        {
            throw new Exception("Exception encountered while writting to Client.\n" + e.Message);
        }
    }
    else
    {
        try
        {
            this.OutputWriter.Write(Argument + "\r\n");
            this.OutputWriter.Flush();
            return;
        }
        catch (Exception e)
        {
            throw new Exception("Exception encountered while writting to Client.\n" + e.Message);
        }
    }
} 
```

和服务器“连接”方法（来自我继承的类）：

```
public void Start()
{
    if (this.Server == null)
    {
        throw new Exception("Could not start TelnetServer.Listener, Server is null.");
    }
    else if (this.RunningThread == null)
    {
        this.RunningThread = new Thread(this.Start);
        this.RunningThread.Name = "TelnetServer.Listener:" + this.Port;
        this.RunningThread.Start();
        return;
    }
    else if (this.LocalAddress == null)
    {
        this.LocalAddress = IPAddress.Any;
        this.Start();
        return;
    }
    else if (this.NetworkListener == null)
    {
        this.NetworkListener = new TcpListener(this.LocalAddress, this.Port);
        this.NetworkListener.Start();
        this.Start();
        return;
    }
    else
    {
        this.RunningFlag = true;

        while (this.IsRunning())
        {
            try
            {
                Socket NewSocket = this.NetworkListener.AcceptSocket();
                this.Server.Connect(NewSocket);
                continue;
            }
            catch (Exception e)
            {
                this.Print("Exception encountered while creating new Client.");
                this.Print(e.Message);
                continue;
            }
        }
    }
} 
```

如果需要更多信息，我很乐意详细说明。请注意，当我获得新连接时，我在“最终”类中进行了完整的握手，最终类中的“写入”方法将消息发送到上述写入方法。

再次提前感谢。

[编辑] 添加发送帧；现在它在第一条消息上失败了。if (HeaderFinished && HeaderSent) base.WriteLine("\u0000" + Encoding.UTF8.GetBytes(Argument) + "\uffff"); 否则 base.WriteLine(Argument); [/编辑]

# android - android水平滚动

> ID：10048080
> 
> 赞同：0
> 
> 时间：2012-04-06T19:10:37.750
> 
> 标签：android, scroll, textview

你能帮我修复一个小错误吗？我有一个文本视图，我想在一行中水平滚动它。我已经使用了这段代码，但它不起作用。有人可以帮我吗？

```
<TextView
    android:id="@+id/SpeseHeader_2"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:layout_weight="1"
    android:textColor="#000000"
    android:scrollHorizontally="true"
    android:ellipsize="marquee"
    android:singleLine="true" 
    android:textAppearance="?android:attr/textAppearanceLarge" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:31:43.833

尝试这个：

```
 <TextView  
    android:id="@+id/SpeseHeader_2"
    android:layout_width="fill_parent"  
    android:layout_height="40sp"  
    android:background="#000"  
    android:gravity="center"  
    android:text="horizontial scrollbar test: text1 text2 text3 ... text7 text8"  
    android:singleLine="true"
    android:marqueeRepeatLimit ="marquee_forever"
    android:ems="16"
    android:focusable="true"
    android:focusableInTouchMode="true"
    android:textColor="#FF0000"
    android:ellipsize="marquee"
    android:scrollHorizontally="true"  
    android:scrollbars="horizontal"  
    /> 
```

# rdbms - 如何决定是使用 RDBMS、Doc/Obj ODBMS 还是 Graph？

> ID：10048082
> 
> 赞同：0
> 
> 时间：2012-04-06T19:10:43.460
> 
> 标签：rdbms, database-schema, graph-databases, object-oriented-database

我打算设计的内容基本上可以归结为用户、组织、事件、地址和评论的列表，这些列表可以很容易地在诸如[MySQL](http://www.mysql.com)的 RDBMS 中维护。但是，如果项目启动，我想添加另一个方面，即资源 - 即文件、视频、图像等，它们可以属于用户、组织或事件。这立即引发了一个问题，即是否使用 RDBMS 并通过与前面提到的每个类别相关的表存储对外部文件的引用，或者是否使用 Doc/Obj ODBMS（如[MongoDB](http://www.mongodb.org/)）来存储这些项目。

但我也希望能够将用户、组织和事件联系起来。即用户 A 拥有组织 1 和组织 2。用户 B 拥有组织 3 和组织 4。用户 C 拥有组织 5。组织 1 有一个事件 X，在日期 R 的地址 M 举行，组织 3 也将参加。用户 C 打算参加 Event X。Org 2 在 Addr M 但在 Date T 等也有一个 Event Y。因此，我怀疑像[OrientDB](http://www.orientechnologies.com/orient-db.htm)这样的 Graph DBMS将是最好的解决方案。要么这样，要么我会在 RDBMS 中有很多表，其中有很多连接，可能还有很多查询，或者 Doc/Obj DBMS 中有一个非常奇怪的结构。

我看过[InfoGrid](http://infogrid.org/)，这是一个可以连接到 MySQL 的图形数据库，这可能是给这只猫剥皮的潜在方法。有没有其他人尝试过这样的事情？您对如何实施这样一个需要可扩展的系统有何想法？非常感谢您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:12:45.410

您的描述适用于关系模型。此特定设置的 RDBMS 是正确的方法。

# algorithm - R代码执行使用：系统时间（）

> ID：10048089
> 
> 赞同：2
> 
> 时间：2012-04-06T19:11:15.770
> 
> 标签：algorithm, r, matlab

我有一些从 Matlab 移植到 R 的代码。我想比较它们的性能。

但是，我遇到了一个问题：`system.time()`在 R 中使用，但是对于相同的代码，我得到了不同的结果。这应该发生吗？我如何比较它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T19:15:23.833

如果你也为自己安排 100 米冲刺，你会得到不同的结果！计算机发生了很多事情，这些事情会稍微改变运行代码所需的时间。

解决方案是多次运行代码。R 包`benchmark`是您正在寻找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:20:17.470

正如@Justin 所说，时代总是不同的。尤其是第一次几次，因为垃圾收集系统还没有根据您的特定用途进行调整。在测量之前重新启动 R 可能是个好主意（并关闭其他程序，确保系统此时没有扫描病毒等）......

请注意，如果测量的时间很短（几分之一秒），则相对误差会相当大，因此请尝试调整问题，使其至少花费一秒。

该软件包`benchmark`或`rbenchmark`可以提供帮助。

...但我通常只是围绕问题做一个 for 循环并调整它，直到它需要一秒钟左右 - 然后我也运行它几次。

这是一个例子：

```
f <- function(x, y) {
    sum <- 1
    for (i in seq_along(x)) sum <- x[[i]] + y[[i]] * sum
    sum
}

n <- 10000
x <- 1:n + 0.5
y <- -1:-n + 0.5
system.time(f(x,y)) # 0.02-0.03 secs 

system.time(for(i in 1:100) f(x,y)) # 1.56-1.59 secs 
```

...因此将其调用 100 次可以大大减少相对误差。

# php - PHP - 使用（取消）序列化时添加类似的键

> ID：10048090
> 
> 赞同：0
> 
> 时间：2012-04-06T19:11:18.313
> 
> 标签：php, arrays, serialization

我目前正在使用序列化将数组值存储在数据库中，但问题是当我继续进行反序列化时，它会删除类似的键。

因此，当我将数组序列化为沿这些线的某些内容时

```
a:2:{i:2;s:3:"400";i:2;s:3:"500";} 
```

然后我继续反序列化我得到

```
Array ( [2] => 500 ) 
```

因此，如果有多个具有相同键的值，则只取第二个值。现在有什么办法可以做到，这样当我反序列化它时，我得到

```
Array ( [2] => 400+500 ) or Array ( [2] => 900 ) 
```

本质上，我希望添加类似的键，而不是一个只是重叠另一个。

# c# - C# 项目的设置向导

> ID：10048093
> 
> 赞同：3
> 
> 时间：2012-04-06T19:11:32.800
> 
> 标签：c#, .net, visual-studio, setup-project, setup-wizard

我有一个使用 .NET 4 框架编写的 C# 项目，我使用解决方案中的安装向导创建了一个安装项目，问题是，一旦安装了程序并启动它，就会出现一个对话框程序正在配置，然后启动程序，这是为什么呢？有必要吗？我怎样才能完全防止这种情况出现或发生？

![程序配置的图像](../Images/a3a009a6c8a5ec26015f44510dabd744.png)

**更新** 我安装了我的应用程序并从 Program Files 中创建的 .exe 启动了应用程序，并且没有出现配置窗口并且应用程序正常启动！如何在不显示上面显示的窗口的情况下创建指向此快捷方式的链接？因为我需要放置用户启动文件夹的快捷方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:48:48.887

MSI 文件已启用自动修复。我不认为 VS 可以选择关闭它。

生成的快捷链接实际上并没有链接到它们应该链接到的文件。它们链接到 appdata 中的可执行文件。打开该文件后，它会静默运行安装程序修复检查，并在进行任何修复时打开配置对话框。由于某种原因，安装程序认为与您的程序一起安装的文件正在被删除/损坏。也许是临时文件或配置文件？

[如果是这种情况，这个](https://stackoverflow.com/questions/3865151/msi-auto-repair-issue-work-around)问题中给出的[这个链接](http://blogs.msdn.com/b/mwade/archive/2007/08/20/select-play-select-3-0-select.aspx)应该可以修复它，但如果用户在添加/删除程序中点击修复，它仍然会被激活。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T07:13:03.753

发生这种情况是因为 Windows Installer 检测到丢失的资源。例如，一些已安装的文件被移动/删除/重命名或为另一个用户帐户按用户安装。

这是一篇包含更多详细信息的文章：http: [//setupanddeployment.com/general-installation-problems/preparing-install-popping/](http://setupanddeployment.com/general-installation-problems/preparing-install-popping/)

您可以使用事件查看器来确定导致此问题的资源，就像我提到的文章中解释的那样。

# css - Safari 输入文本忽略顶部填充

> ID：10048102
> 
> 赞同：1
> 
> 时间：2012-04-06T19:12:09.297
> 
> 标签：css, input, textbox, safari

我遇到了一个问题，即在 Safari 中的输入文本框中忽略了填充顶部。在 Chrome、Firefox 和 IE 中不会出现此问题。我创建了一个 JS Fiddle 来显示问题：

[http://jsfiddle.net/Xrpwn/5/](http://jsfiddle.net/Xrpwn/5/)

如果您在 Chrome 中查看此小提琴，您可以看到 padding-top 正确呈现。但是，如果您在 Safari 中查看此小提琴，则会忽略 padding-top，并且光标默认放置在输入的垂直中心。

出于某种原因，默认情况下，Safari 似乎将输入中的文本垂直居中。[在http://opensource.apple.com/source/WebCore/WebCore-514/rendering/RenderTextControlSingleLine.cpp](http://opensource.apple.com/source/WebCore/WebCore-514/rendering/RenderTextControlSingleLine.cpp)查看 RenderTextControlSingleLine 的源代码时，它具有：

```
// For text fields, center the inner text vertically
// Don't do this for search fields, since we don't honor height for them
if (!m_innerBlock) {
currentHeight = innerTextRenderer->height();
if (currentHeight < height())
innerTextRenderer->setLocation(innerTextRenderer->x(), (height() - currentHeight) / 2);
} 
```

我想知道是否有人知道如何使用 CSS 或 jQuery 或类似的东西来覆盖这种行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T19:26:54.670

我不相信您将能够覆盖该行为，但您可以使用类似[http://jsfiddle.net/Xrpwn/7/](http://jsfiddle.net/Xrpwn/7/)（请原谅 slop）和捕获输入的 javascript 事件来模拟相同的效果:focus/blur 添加/删除容器 div 的轮廓。

# java - Java：在 sin(x) 中计算 x

> ID：10048108
> 
> 赞同：3
> 
> 时间：2012-04-06T19:12:23.583
> 
> 标签：java, math, trigonometry

我的问题是关于编程语言 Java 中的角度函数。如果我想得到任何双重的罪，我就用

```
double variable = Math.sin(x); 
```

但是如果**sin(x) = 0.324**（或任何其他随机数）并且我想计算 x 怎么办？我该怎么做？java中是否有任何本机函数，或者我必须实现自己的算法才能返回这个值？

```
getXForValue(0.324);

public double getXForValue(double val){
 // how to calculate ?
 return x;
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-06T19:13:41.307

你所描述的被称为“反正弦”函数。它在 Java 中作为[Math.asin()](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#asin%28double%29)可用。

您可能想阅读[有关三角函数的 wiki](http://en.wikipedia.org/wiki/Inverse_trigonometric_functions)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-06T19:14:47.197

使用[arcsin](http://docs.oracle.com/javase/6/docs/api/java/lang/Math.html#asin%28double%29)函数

```
x = Math.asin(variable) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T19:16:48.717

要在 Java 中计算正弦倒数，您可以使用

```
Math.asin(double a) 
```

它返回一个值的反正弦；返回的角度在 -pi/2 到 pi/2 的范围内。查看 java 文档以获得更多解释

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T19:16:32.430

您可以使用`Math.asin(0.324);`来获取 x 的值。

请阅读[Math.asin()](http://docs.oracle.com/javase/6/docs/api/java/lang/Math.html#asin%28double%29) javadoc 以了解函数返回的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T19:16:48.397

您必须使用反函数或反正弦。它与正弦的关系与除法与乘法的关系相同。

```
5 * x = 10;
10 / 5 = x;

Math.sine(x) = 1;
Math.asine(1) = x; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-30T02:51:20.037

您需要使用这些方法，`Math.toDegrees`并且`Math.asin`，按以下顺序：

```
double x = 1.0; // in this example 1.0 corresp to sin(90)
double dX = Math.toDegrees(Math.asin(x));

System.out.println(dX); 
```

请记住，该`asin()`函数返回一个`double RADIANS`结果。

# networking - 网络启动和系统即将关闭时的 Ubuntu Upstart 事件

> ID：10048111
> 
> 赞同：1
> 
> 时间：2012-04-06T19:12:27.797
> 
> 标签：networking, ubuntu, upstart

我需要以下两个事件的新贵事件名称。

1.  网络已启动并正在运行
2.  当系统即将关闭时

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-18T11:05:24.123

网络启动和运行的事件（即除 之外的任何设备`lo`）：

`start on net-device-up IFACE!=lo`

用于关机/重启的事件（运行级别 0 或 6）：

`start on starting rc RUNLEVEL=[06]`

（更多信息在[新贵食谱](http://upstart.ubuntu.com/cookbook/#shutdown-process)中。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:19:23.957

/etc/network/if-up.d/ 中的任何脚本都将在网络启动时执行。/etc/network/if-down.d/ 中的任何脚本都将在网络关闭时执行。

# iphone - 日期未出现在 UILabel 中

> ID：10048120
> 
> 赞同：1
> 
> 时间：2012-04-06T19:13:13.983
> 
> 标签：iphone, objective-c, ios, xcode

这段代码有什么问题？

```
 NSString *strTest = @"Sun Apr 12 23:29:24 +0000 2009";
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setDateFormat:@"MM/dd/yy"];
    NSDate *createdAtFormatted = [dateFormatter dateFromString:strTest];
    self.createdAt.text = [dateFormatter stringFromDate:createdAtFormatted]; 
```

self.createdAt 是一个 UILabel 并且它保持为空。为什么？

尝试使用 dateWithNaturalLanguageString 时，我得到：

![在此处输入图像描述](../Images/9ad8028f036279449b2c38cf3bce5e21.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:16:33.623

您的日期格式化程序日期格式与字符串中的日期格式不匹配`strTest`。

```
NSString *strTest = @"Sun Apr 12 23:29:24 +0000 2009";
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
NSLocale *loc = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US"]; // so the formatter recognizes english names for months and days
[dateFormatter setLocale:loc];
[loc release]; // remove if using ARC
[dateFormatter setDateFormat:@"EEE MMM d HH:mm:ss ZZZZ yyyy"];
NSDate *createdAtFormatted = [dateFormatter dateFromString:strTest];
NSLog(@"got %@", createdAtFormatted); 
```

可以在[此处](http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns)找到格式化程序说明符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:17:19.380

您正在向 dateFormatter 提供 MM/dd/yy 模式，但您的日期字符串不适合该模式，因此 dateFormatter 返回一个零日期。

# c# - 应用程序无响应

> ID：10048121
> 
> 赞同：0
> 
> 时间：2012-04-06T19:13:14.780
> 
> 标签：c#, .net, winforms

嗨，伙计们，我有一个作为数据库接口的 winform。在某些时候，用户会选择一个包含 30 到 40 个文件的目录。这些文件必须作为原始数据插入数据库。就是这样。然后，原始数据将被中断并修复。完成此操作后，用户可以将固定数据转储到一个 Excel 文件中。当我在 Visual Studio 中以发布或调试模式运行它时，这非常有效。但是，当我尝试在视觉工作室之外（即来自 bin / release 文件）运行它时，它会停止，然后变得无响应。我和用户不介意它是否变慢（大约打印了 6 万条记录）。但是为什么它停止工作。我想出了它停止响应的部分，它似乎没有陷入僵局？任何关于如何改进它的想法都将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T19:30:54.787

您需要在一个单独的线程中完成所有这些处理。我建议使用 BackgroundWorker。

这是有关该课程的信息 - [http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)

这是一个如何使用它的例子 - [http://fernandof.wordpress.com/2007/04/04/implementing-multi-threading-in-winforms-using-the-backgroundworker-class/](http://fernandof.wordpress.com/2007/04/04/implementing-multi-threading-in-winforms-using-the-backgroundworker-class/)

# asp.net-mvc - InRequestScope 为 DelegatingHandlers 配置实体上下文

> ID：10048123
> 
> 赞同：0
> 
> 时间：2012-04-06T19:13:22.587
> 
> 标签：asp.net-mvc, ninject, asp.net-web-api

当我将上下文绑定为`InRequestScope`时，在调用 DelegatingHandler 中的代码时释放上下文（在 Application_Start 中实例化并在控制器初始化之前执行）。如果我使用 InTransientScope，那么它可以工作，但我想要所有内容都有 1 个上下文。基于此答案[here](https://stackoverflow.com/a/4187446/400861)，这是拥有1个上下文的正确方法。

全球.asax

```
static void Configure(HttpConfiguration config)
{
    var kernel = NinjectWebCommon.Bootstrapper.Kernel;
    config.MessageHandlers.Add(new ApiKeyHandler(kernel.Get<IApiService>()));
} 
```

绑定

```
//if i remove InRequestScope here, everything works.
kernel.Bind<EntityDatabaseContext>().ToMethod(context => new EntityDatabaseContext()).InRequestScope();
kernel.Bind<IUnitOfWork>().To<UnitOfWork>().InRequestScope();

//repositories
kernel.Bind<IRepository<Application>>().To<Repository<Application>>().InRequestScope();

//services
kernel.Bind<IApiService>().To<ApiService>().InRequestScope(); 
```

所以每当`SendAsync`在 ApiKeyHandler 中被调用时，上下文就已经被释放了。但是当调用控制器时（在调用 ApiKeyHandler 之后），上下文就可以了。我不太确定发生了什么。如果它不能与 InRequestScope 一起使用，我该如何像链接问题中的答案那样完成它？1 上下文 InTransientScope 和 InRequestScope 中的所有其他内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T03:36:50.423

为您的消息处理程序使用瞬态或单例范围的上下文会限制您为消息处理程序缓存所有实体。例如，如果一个实体被更改/删除或添加一个新实体，您的消息处理程序将永远不会适应该更改。在某些数据永远不会更改的情况下，这可能没问题。

如果您需要对会发生变化的最新数据进行操作，则不能使用这些范围。但这`InRequestScope`意味着您每次使用工厂时都必须创建一个新的服务实例（请参阅[工厂扩展](https://github.com/ninject/ninject.extensions.factory)）。这样您就可以在请求范围内拥有上下文。

# javascript - 在上传之前在页面上预览图像适用于除 IE 之外的所有浏览器

> ID：10048124
> 
> 赞同：0
> 
> 时间：2012-04-06T19:13:24.550
> 
> 标签：javascript, html

我有一个 javascript 函数，可以在单击提交之前显示您要上传的图像。它仅在您选择文件时在页面上显示图像。这适用于除 IE 之外的所有浏览器。这是一个非常简单的javascript函数。任何想法为什么这不会在 IE 中呈现？谢谢你。

这是页面头部的Javascript：

```
 function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#blah')
                    .attr('src', e.target.result)
                    .width(75)
                    .height(75);
            };

            reader.readAsDataURL(input.files[0]);
        }
    } 
```

这是空图像的 HTML。选择文件后，它将显示在 img id="blah" 中。这可以在除 IE 之外的所有浏览器中正确呈现。

```
<div id="question_submit_outside_holder">
    <input type="submit" name="question_reply_upload_image" id="questions_place_inline_image_form_submit_one" value="Place image" />
</div>

<div id="questions_form_image_upload_image_holder">
    <img id="blah" src="" /> <!-- img should be displayed here -->
</div> 
```

**更新**

这就是我将图像附加到帖子的方式。它显示在除 IE 之外的所有浏览器中

```
<script type="text/javascript">
    image = '<img src="http://forum.site.com/.../<?php echo $_SESSION['user_id']; ?>/question_reply_images/<?php echo $image_name; ?>" alt="<?php echo $alt; ?>" />';
    document.getElementById('editor1').innerHTML += image;
    window.location = '#reply_textbox';
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:16:33.170

当然，它在 IE 中不起作用！IE9 及以下不支持 FileReader API，它可以在您发布的代码中启用缩略图预览。

*好消息：IE10 确实支持 FileReader API。* [http://caniuse.com/filereader](http://caniuse.com/filereader)

# .net - 使用控件模板填充所有网格单元

> ID：10048127
> 
> 赞同：1
> 
> 时间：2012-04-06T19:13:44.937
> 
> 标签：.net, wpf, xaml, grid

我想用相同的控件填充所有单元格。我现在拥有的是一个控制模板和一个网格。但是我在 Xaml 中找不到将控件添加到所有单元格的简单方法。

这是我现在拥有的代码：

```
<Window x:Class="AcMidi.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="512" Width="760">
    <Window.Resources>
        <ControlTemplate x:Key="Planet">
            <Button Content="Button"></Button>
        </ControlTemplate>
    </Window.Resources>
    <Grid Height="209" Name="grid1" Width="500">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:44:21.823

你可以使用一个`ItemsControl`

*   将 绑定`ItemsSource`到具有行位置和列位置属性的项目集合，您可以使用两个 for 循环轻松创建这样的集合。
*   使`ItemsPanel`_`Grid`
*   在 中，`ItemContainerStyle`您可以将`Grid.Column`和绑定`Grid.Row`到您的项目的属性。
*   将 设置`ItemTemplate`为您的模板（应该是 a `DataTemplate`，因为您没有模板化控件）。

# c++ - 如果将 int 传递给 C 中的 byte 参数会发生什么？

> ID：10048130
> 
> 赞同：3
> 
> 时间：2012-04-06T19:14:02.853
> 
> 标签：c++, c, int, byte

如果将 int 作为参数传递给接收字节（char）的方法，C/C++ 将如何处理？int 会被截断吗？或者是其他东西？

例如：

```
void method1()
{
    int i = //some int;
    method2(i);
}

void method2(byte b)
{
     //Do something
} 
```

int 如何“转换”为字节（字符）？它会被截断吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T19:19:04.670

如果`byte`代表`char`类型，则行为将取决于`char`您的平台上是签名还是未签名。

如果`char`是无符号的，则原始`int`值减少到取`unsigned char`模范围内`UCHAR_MAX+1`。范围内的值`[0, UCHAR_MAX]`被保留。C 语言规范将此过程描述为

> ... 通过反复加减新类型可以表示的最大值多一的方式转换该值，直到该值在新类型的范围内。

如果`char`type 有符号，则`[SCHAR_MIN, SCHAR_MAX]`保留范围内的值，而此范围外的任何值都以某种实现定义的方式进行转换。（C 语言还明确允许在这种情况下引发实现定义的信号。）即没有通用的答案。请查阅您平台的文档。或者，更好的是，编写不依赖于任何特定转换行为的代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-06T19:16:45.463

只是截断了 AS 位模式（字节通常是无符号字符，但是，您必须检查）

诠释 i = -1;

变成

字节 b = 255; 当字节 = 无符号字符

字节 b = -1; 当字节 = 有符号字符

我 = 0; b = 0;

我 = 1024; b = 0;

我 = 1040; b = 16;

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T19:28:50.107

引用 C++ 2003 标准：

> 第 5.2.2 条第 4 段：调用函数时，每个参数 (8.3.5) 应使用其对应的参数初始化 (8.5, 12.8, 12.1)。

所以，`b`用*初始化*。`i`这意味着什么？

> 8.5/14 被初始化对象的初始值是初始化表达式的（可能转换的）值。如有必要，将使用标准转换（第 4 条）将初始化表达式转换为 ... 目标类型；不考虑用户定义的转换

哦，`i`是*转换*，使用*标准转换*。这意味着什么？在许多其他标准转换中包括：

> 4.7/2 如果目标类型是无符号的，则结果值是与源整数一致的最小无符号整数（模 2 ^n，其中 n 是用于表示无符号类型的位数）。
> 
> 4.7/3 如果目标类型是有符号的，如果它可以在目标类型（和位域宽度）中表示，则值不变；否则，该值是实现定义的。

哦，所以如果`char`是无符号的，则该值将被截断为 char 中的位数（或计算的模 UCHAR_MAX+1，无论您想以哪种方式考虑它。）

如果`char`是有符号的，那么值不变，如果合适的话；否则实现定义。

实际上，在您关心的计算机和编译器上，无论`char`s 是有符号还是无符号，该值总是被截断以适合 8 位。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T19:19:20.787

你不知道 a`byte`是什么，但是如果你传递一个可转换为参数类型的参数，则值将被转换。

如果类型具有不同的取值范围，则存在该值超出参数类型范围的风险，然后它将无法工作。如果在范围内，那就是安全的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T19:26:49.907

这是一个例子：

1）代码：

```
#include <stdio.h>

void
method1 (unsigned char b)
{
  int a = 10;
  printf ("a=%d, b=%d...\n", a, b);
}

void
method2 (unsigned char * b)
{
  int a = 10;
  printf ("a=%d, b=%d...\n", a, *b);
}

int
main (int argc, char *argv[])
{
  int i=3;
  method1 (i);
  method2 (i);
  return 0;
} 
```

2）编译（带有警告）：

```
$ gcc -o x -Wall -pedantic x.c
x.c: In function `main':
x.c:22: warning: passing arg 1 of `method2' makes pointer from integer without a cast 
```

3）执行（崩溃）：

```
$ ./x
a=10, b=3...
Segmentation fault (core dumped) 
```

'希望对您的原始问题和相关问题有所帮助。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-04-06T19:19:03.417

有两种情况需要担心：

```
// Your input "int i" gets truncated
void method2(byte b)
{
  ...

// Your "method2()" stack gets overwritten
void method2(byte * b)
{
  ... 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-04-06T19:19:37.700

它将被转换为一个字节，就像您将它显式转换为`(byte)i`.

不过，您上面的示例代码可能是不同的情况，除非您有`method2`未显示的前向声明。因为`method2`在调用它的时候还没有声明，所以编译器不知道它的第一个参数的类型。在 C 中，函数应该在调用之前声明（或定义）。在这种情况下发生的情况是编译器假设（作为隐式声明）`method2`的第一个参数是 an`int`并`method2`接收一个`int`。正式地说，这会导致未定义的行为，但在大多数架构上，两者`int`和`byte`无论如何都会在相同大小的寄存器中传递，并且它会碰巧起作用。

# ssrs-2008 - SSRS中的排序

> ID：10048131
> 
> 赞同：0
> 
> 时间：2012-04-06T19:14:08.313
> 
> 标签：ssrs-2008, reporting-services, ssrs-tablix

我在 SSRS 中设计了一个表格报告，其中包含“学生姓名”、“季度”和“金额”列。是否可以按升序使用“学生姓名”对报告输出进行排序，然后按降序对“金额”进行排序？

在这里，一个学生将有多个行条目，例如：

```
Student  Amount  
 Jack      63
 Jack      62
 Jack      44
 Jill      54
 Jill      52 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:20:17.397

两种不同的方法可以轻松实现这一点：

1.  在您的查询中。除非您在报告中明确覆盖查询排序，否则查询排序将被保留。因此，这样的事情将在您的查询结束时起作用。

    ```
    ORDER BY Student, Amount DESC 
    ```

2.  在 Tablix 上：在 Tablix 属性中，使用排序窗格添加多个排序级别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:18:20.577

只需在您的查询中执行

```
CREATE TABLE #test
(
 name varchar(10),
 amount int
)

INSERT INTO #test(name, amount) VALUES('Jack', 63)
INSERT INTO #test(name, amount) VALUES('Jack', 62)
INSERT INTO #test(name, amount) VALUES('Jack', 44)
INSERT INTO #test(name, amount) VALUES('Jill', 54)
INSERT INTO #test(name, amount) VALUES('Jill', 52)

SELECT * FROM #test ORDER BY name ASC, amount DESC

DROP TABLE #test 
```

这是适合您的工作模型： [http ://sqlfiddle.com/#!3/3fad2/2](http://sqlfiddle.com/#!3/3fad2/2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-06T14:40:38.780

您还可以转到列标题中文本框的属性进行排序并进行交互式排序。这将使用户能够通过单击列标题对 ASC 或 Desc 进行排序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-30T11:28:53.720

转到 Tablix 属性->选择排序->选择您的列和排序方法。而已。

# ios - 多个动画块不起作用

> ID：10048132
> 
> 赞同：0
> 
> 时间：2012-04-06T19:14:09.623
> 
> 标签：ios, animation, cgaffinetransform

我正在尝试在同一块中翻译和缩放视图。由于某种原因，翻译代码超出了缩放比例并将其设置为 100%。请帮忙。

```
[UIView animateWithDuration:0.5 
                        delay:0.0 
                        options:UIViewAnimationCurveEaseInOut
                     animations:^{                              
                         fullView.transform = CGAffineTransformMakeTranslation(0.0, 425.0);
                         fullView.transform = CGAffineTransformMakeScale(0.8, 0.8); 
                     } completion:^(BOOL finished) { }]; 
```

解决方案 - 使用 CGAffineTransformConcat 将 2 条变换线变为 1 条：

```
fullView.transform = CGAffineTransformConcat(CGAffineTransformMakeTranslation(0.0, 425.0), CGAffineTransformMakeScale(0.8, 0.8)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:18:13.287

`transform`是您正在设置然后重新设置的属性。您需要做的是构造一个`CGAffineTransform`由两个转换组合组成的。 `CGAffineTransformConcat()`应该很好地帮助你。

# javascript - jQuery获取“事件调用”元素

> ID：10048133
> 
> 赞同：1
> 
> 时间：2012-04-06T19:14:20.557
> 
> 标签：javascript, jquery, object, methods, invoke

我的问题是，当单击下面的复选框时 - 调用 check 函数来选中/取消选中所有复选框。但是它们必须相对于调用复选框（带有“onchange”事件的复选框）进行更改。

复选框 HTML 声明：

```
<input type="checkbox" onchange="$('input[type=checkbox][rel=users]').check();"> 
```

示例 JavaScript 代码：

```
$.fn.check = function() {
    $(this).each(function(){
        $(this).attr('checked', checked);
    });
} 
```

我的问题是：我怎样才能得到与“全选”复选框对应的 DOM 对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:16:48.337

**[在 JSFIDDLE 上查看。](http://jsfiddle.net/bryandowning/9pF3d/)**

我喜欢使用 HTML5 数据属性来处理此类内容。使用以下 DOM 结构，您可以使用`data-target`触发复选框上的属性定义目标复选框。目标应该是一个有效的 jQuery 选择器字符串。

**HTML：**

```
<input type="checkbox" id="checkUsers" class="checkAll" data-target="input[type=checkbox][rel=users]">

<label for="checkUsers">Users:</label>

<input type="checkbox" rel="users">
<input type="checkbox" rel="users">
<input type="checkbox" rel="users">
<input type="checkbox" rel="users">
<input type="checkbox" rel="users">

<br><br>

<input type="checkbox" id="checkPlaces" class="checkAll" data-target="input[type=checkbox][rel=places]">

<label for="checkPlaces">Places:</label>

<input type="checkbox" rel="places">
<input type="checkbox" rel="places">
<input type="checkbox" rel="places">
<input type="checkbox" rel="places">
<input type="checkbox" rel="places"> 
```

然后，您将插件设置为使用您定义的目标来触发基于触发复选框的选中属性的检查/取消选中。

**插入：**

```
(function( $ ){

  $.fn.check = function() {  

    // "this" is a jQuery object of the checkbox that was clicked.
    var target = this.data("target");
    $(target).attr("checked", this[0].checked);

    return this; //maintain chainability

  };

})( jQuery ); 
```

这种方法的真正好处是它允许您只需要通过将事件附加到 a`class`而不是. 来管理一个事件处理程序声明`id`。

**事件处理程序声明：**

```
$(function(){

    $(".checkAll").click(function(){
        $(this).check();
    });

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:17:40.073

编辑：`this`将 checkAll 的对象传递给函数。

[**演示**](http://jsfiddle.net/skram/nC6MG/1/)

```
<input type="checkbox" 
   onchange="$('input[type=checkbox][rel=users]').check(this);" /> 
```

请注意，`this`传递为`.check(this)`

在 JS 中：

```
$(document).ready(function() {
    $.fn.check = function(orgEl) {
        $(this).each(function() {
            $(this).attr('checked', orgEl.checked);
        });
    }
}); 
```

## 旧帖子 -

将 checkAll 复选框绑定到处理程序并从内部调用 fxn。见下文，

**HTML**

```
<input type="checkbox" id="checkAll" > 
```

**JS**

```
 $(document).ready (function () {
       $('#checkAll').click (function () {
          //this inside is checkAll checkbox object.
          $('input[type=checkbox][rel=users]').check();
       });
   }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T19:26:54.197

由于您将此绑定到“checkall”复选框，因此您可以内联访问自身。所以你可以将它传递给`.check()`你创建的 jQuery 函数并在那里使用它。看看这个：（请原谅我对您的选择所做的更改，您显然可以使用以前的内容......但我建议使用`:checkbox`而不是`input[type=checkbox]`）

```
<html>
<head>
    <script type="text/javascript" src="jquery-min.js"></script>
    <script type="text/javascript">
        $.fn.check = function (obj) {
            $(this).each(function (){
                this.checked = obj.checked;
            });
        }
    </script>
</head>
<body>
    <input type="checkbox" id="checkall" onclick="$('.check-item').check(this);" /><br />
    <input type="checkbox" class="check-item" /><br />
    <input type="checkbox" class="check-item" /><br />
    <input type="checkbox" class="check-item" /><br />
    <input type="checkbox" class="check-item" /><br />
    <input type="checkbox" class="check-item" /><br />
<body> 
```

# php - 如何在运行时显示代码错误

> ID：10048135
> 
> 赞同：1
> 
> 时间：2012-04-06T19:14:29.620
> 
> 标签：php, apache, error-handling

以前我安装了 php5.1，最近升级到了 php5.3。

在以前的版本中，每当发生错误时，所有语法错误和其他错误都会显示在页面中，并且我很容易调试。

但是现在只要页面中有错误，它就会停止处理并显示空白。

我也尝试添加以下内容：

```
error_reporting(E_ALL & E_STRICT);
ini_set('display_errors', 1); 
```

在页面顶部，但没有工作。有什么建议么？

编辑更多信息：

当我执行 phpinfo() 时，它会显示我的配置文件：c:\php\php.ini。进一步打开和编辑 php.ini 文件我发现：

```
error_reporting = E_ALL
display_errors = On 
```

编辑更多信息：将 error_reporting 更正为 E_ALL | E_STRICT。每当从函数或类中的代码生成错误时，发现它几乎是空白的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T19:29:45.207

> 每当页面出现错误时

什么级别的错误？它是致命的还是不致命的？如果致命 - 则根本不使用您的代码内设置 (`error_reporting()`和)：而是使用 php.ini 设置。`ini_set`

IMO，您提供的信息不足：至少`php.ini`您拥有的价值`error_reporting`和`error_log`需要的指令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:28:32.637

尝试这个。

```
ini_set('display_errors','On'); 
```

# javascript - 钛标签组

> ID：10048142
> 
> 赞同：0
> 
> 时间：2012-04-06T19:15:09.790
> 
> 标签：javascript, appcelerator

我在使用 tabGroups 时遇到问题。我创建了一个新应用程序（这是我的第一个应用程序），当我单击表中的一个选项时，我正在调用：

```
win.open(win,{annimated:true}); 
```

问题是页面顶部没有选项卡可以返回到我所在的位置。所以我需要使用标签组。我的问题是我不确定如何使用它们。当我将上述内容替换为：

```
Ti.UI.currentTab.open(win); 
```

我收到一个未定义 currentTab 的错误。如何启用 tabGroups？我有另一个名为 AppTabGroup.js 的文件，其中包含： var self = Ti.UI.createTabGroup(); 在其中，但我不知道如何使用它。

下面是整个页面，以防我正在做一些偏离基础的事情。

函数 AppWindow(title) { var self = Ti.UI.createWindow({ title:title, backgroundColor:'white' });

```
var data = [

{ title:"Catalog", hasChild:true, test:'ui/CatalogWindow.js', header:'' },
{ title:"Service Calculator", hasChild:true, header:'' }
];

var tableview = Titanium.UI.createTableView({
data:data,
style:Titanium.UI.iPhone.TableViewStyle.GROUPED
});

tableview.addEventListener('click', function(e)
{
    if (e.rowData.test)
    {
        var win = 
    Titanium.UI.createWindow({
        url:e.rowData.test,
        title:e.rowData.title
    });
    win.open(win,{annimated:true});
} 
```

}); self.add(tableview);

```
return self; 
```

};

module.exports = 应用窗口；

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T20:54:32.907

你并不孤单。其他人（包括我自己）对 Ti.UI.currentTab 未定义感到困惑：

[http://developer.appcelerator.com/question/98501/titaniumuicurrenttab-is-null](http://developer.appcelerator.com/question/98501/titaniumuicurrenttab-is-null)

我过去解决此问题的方法是将包含选项卡传递给窗口，以便它可以使用该引用打开另一个窗口。所以在你的例子中， AppTabGroup.js 看起来像：

```
var AppWindow = require('src/AppWindow');

var self = Ti.UI.createTabGroup();

//create app tabs
var appTab = Ti.UI.createTab({
    title : L('app'),
    icon : '/images/app_tab.png',
    window : AppWindow
});
AppWindow.setContainingTab(appTab); 
```

然后在 AppWindow.js 中：

```
exports.setContainingTab = function(tab) {
    containingTab = tab;
}
var win = Titanium.UI.createWindow({
    url:e.rowData.test,
    title:e.rowData.title
});

containingTab.open(win); 
```

# php - 如何使用 PHP 验证正则表达式

> ID：10048147
> 
> 赞同：7
> 
> 时间：2012-04-06T19:15:56.733
> 
> 标签：php, regex, validation

我希望能够验证用户输入的正则表达式，以检查它是否有效。我在 PHP 中发现的第一件事是[`filter_var`](http://php.net/manual/en/function.filter-var.php)带有`FILTER_VALIDATE_REGEXP`常量，但这并没有达到我想要的效果，因为它必须将正则表达式传递给选项，但我没有针对任何东西进行正则表达式，所以基本上它只是检查正则表达式的有效性。

但是您明白了，我如何验证用户输入的正则表达式（与任何内容都不匹配）。

验证示例，简单来说：

```
$user_inputted_regex = $_POST['regex']; // e.g. /([a-z]+)\..*([0-9]{2})/i

if(is_valid_regex($user_inputted_regex))
{
    // The regex was valid
}
else
{
    // The regex was invalid
} 
```

验证示例：

```
/[[0-9]/i              // invalid
//(.*)/                // invalid
/(.*)-(.*)-(.*)/       // valid
/([a-z]+)-([0-9_]+)/i  // valid 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T19:39:50.040

这是一个想法（[演示](http://ideone.com/pXS4d)）：

```
function is_valid_regex($pattern)
{
    return is_int(@preg_match($pattern, ''));
} 
```

> preg_match() 返回模式匹配的次数。这将是 0 次（不匹配）或 1 次，因为 preg_match() 将在第一次匹配后停止搜索。
> 
> 如果发生错误，preg_match() 返回 FALSE。

要了解模式无效的原因，请使用`preg_last_error`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T19:27:47.473

您需要编写自己的函数来验证正则表达式。您可以验证它是否包含非法字符或错误格式，但无法测试它是否是一个工作表达式。为此，您需要创建一个解决方案。

但是你确实意识到确实没有无效的正则表达式这样的东西。正则表达式是基于性能的。它要么匹配，要么不匹配，这取决于测试的主题——即使表达式或其结果看似毫无意义。

换句话说，你只能测试一个正则表达式的有效语法……这几乎可以是任何东西！

# ruby - 如何在 Ruby 中加载具有两列的 CSV 并将其保存在 2 个数组中

> ID：10048149
> 
> 赞同：3
> 
> 时间：2012-04-06T19:16:20.020
> 
> 标签：ruby, arrays, csv

我想加载一个包含两列（每列都有一个名称和一行数字）的 CSV 文件，并且只将两列的数字保存在两个不同的数组中。然后我想对这两列中的数据进行一些计算，使用两个数组来保存每列的数字。

这是我仍然拥有的：

```
require 'csv'
filename = 'file.csv'
csv_data = CSV.read(filename, :col_sep => ";")
csv_data.shift
csv_data.each_with_index { |column, index_c|
  average = 0
  column.each_with_index{ |element, index_e|
    csv_data[index_c][index_e] = element.to_i
  }
}
csv_data = csv_data.transpose 
```

如何拆分`csv_data`两个数组中的列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T21:00:26.817

这应该可以帮助您创建两列数组，而不会浪费存储将整个文件冗余读取到 csv_data 中。

```
require 'csv'
filename = 'file.csv'
arr1 = []
arr2 = []
CSV.foreach(filename, :col_sep => ";", :return_headers => false) do |row|
  arr1 << row[0].to_i
  arr2 << row[1].to_i
end 
```

# c++ - Qt，QFile 写入特定行

> ID：10048150
> 
> 赞同：3
> 
> 时间：2012-04-06T19:16:21.237
> 
> 标签：c++, qt, qfile

我在 Qt 中遇到了另一个问题，我似乎无法弄清楚如何使用`QFile`. 相反，一切都在开始时被擦除。那么根据给定的信息，我将如何写入特定行`QFile`？

这里有两个功能。

1.  第一个函数搜索文件，然后获取两个变量。一个找到下一个空行，一个获取当前 ID 号。
2.  第二个函数应该写。但是我已经寻找了有关我需要什么的文档，我用谷歌搜索了它并尝试了许多搜索都无济于事。

功能一

* * *

```
 QString fileName = "C:\\Users\\Gabe\\SeniorProj\\Students.txt";
    QFile mFile(fileName);
    QTextStream stream(&mFile);
    QString line;

    int x = 1; //this counts how many lines there are inside the text file
    QString currentID;

    if(!mFile.open(QFile::ReadOnly | QFile::Text)){
        qDebug() << "Could not open file for reading";
        return;
    }

    do {
        line = stream.readLine();
        QStringList parts = line.split(";", QString::KeepEmptyParts);

        if (parts.length() == 3) {
            QString id        = parts[0];
            QString firstName = parts[1];
            QString lastName  = parts[2];

            x++; //this counts how many lines there are inside the text file
            currentID = parts[0];//current ID number
        }
    }while (!line.isNull());

    mFile.flush();
    mFile.close();

    Write(x, currentID); //calls function to operate on file

} 
```

上面的函数读取文件，如下所示。

```
1001;James;Bark
1002;Jeremy;Parker
1003;Seinfeld;Parker
1004;Sigfried;FonStein
1005;Rabbun;Hassan
1006;Jenniffer;Jones
1007;Agent;Smith
1008;Mister;Anderson 
```

该函数获得了我认为可能需要的两个信息。我不太熟悉`QFile`和搜索，但我认为我需要这些变量：

```
int x;  //This becomes 9 at the end of the search.
QString currentID; //This becomes 1008 at the end of the search. 
```

所以我将这些变量传递给下一个函数，在函数 1 的末尾。`Write(x, currentID);`

功能二

* * *

```
void StudentAddClass::Write(int currentLine, QString idNum){

    QString fileName = "C:\\Users\\Gabe\\SeniorProj\\Students.txt";
    QFile mFile(fileName);
    QTextStream stream(&mFile);
    QString line;

    if(!mFile.open(QFile::WriteOnly | QFile::Text)){
        qDebug() << "Could not open file for writing";
        return;
    }

    QTextStream out(&mFile);
    out << "HelloWorld";
} 
```

我自己没有尝试解决这个问题，这个函数所做的就是用“HelloWorld”替换文本文件的所有内容。

有谁知道如何在特定行上写，或者至少到文件末尾然后写？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T19:50:27.417

如果要插入文件的行始终是最后一行（如函数 1 建议的那样），您可以尝试在 Write 方法中使用 QIODevice::Append 以追加模式打开文件。

如果要在文件中间插入一行，我想一种简单的方法是使用临时文件（或者，如果可能的话，将这些行加载到 QList 中，插入行并将列表写回文件）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:15:41.663

```
 QString fileName = "student.txt";
    QFile mFile(fileName);

    if(!mFile.open(QFile::Append | QFile::Text)){
        qDebug() << "Could not open file for writing";
        return 0;
    }

    QTextStream out(&mFile);
    out << "The magic number is: " << 4 << "\n";

    mFile.close(); 
```

上面的代码片段将在文件末尾附加文本 "The magic number is: 4" 。

# javascript - Javascript/Chrome：是否可以访问地址栏中输入的内容？

> ID：10048161
> 
> 赞同：0
> 
> 时间：2012-04-06T19:16:52.757
> 
> 标签：javascript, google-chrome, search-engine

出于实验目的，我想在 Google Chrome 中创建一个书签，其功能类似于搜索按钮，能够访问地址栏中的当前内容。例如。我可以在地址栏中输入搜索词并单击书签，它会抓取搜索词并将它们传递给搜索引擎。

我想这样做是因为我使用多个搜索引擎，我不想每次都去不同的搜索引擎。

编辑：如果这不可能，请告诉我，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T19:23:37.040

这取决于浏览器，如果您利用浏览器，那么您可以这样做..

# c# - 出现错误时，如何设置样式？

> ID：10048164
> 
> 赞同：0
> 
> 时间：2012-04-06T19:17:13.380
> 
> 标签：c#, wpf, xaml, data-binding, validation

有时我会看到当绑定出现错误的输入时，控件周围会显示一个红色边框。我该如何修改它或在哪里？如果可能的话，给我举个例子。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:39:02.237

你可以为 TextBox 做这样的事情

```
<Style x:Key="TextBoxWithValidation" TargetType="{x:Type TextBox}" BasedOn="{StaticResource {x:Type TextBox}}">
    <Setter Property="Validation.ErrorTemplate" Value="{StaticResource TextBoxValidationTemplate}"/>
    <Style.Triggers>
        <Trigger Property="Validation.HasError" Value="true">
            <Setter Property="Background" Value="{StaticResource BackgroundValidationBrush}"/>
            <Setter 
                Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Mode=Self},
                Path=(Validation.Errors)[0].ErrorContent)}"
            />
        </Trigger>
    </Style.Triggers>
</Style> 
```

BackgroundValidationBrush 会说粉红色。

请注意，将 ToolTip 绑定到 (Validation.Errors)[0].ErrorContent 的常见解决方案会在没有错误的情况下导致大量调试喷吐（技术术语），因此最好使用这样的转换器：

```
[ValueConversion(typeof(ReadOnlyObservableCollection<ValidationError>), typeof(string))]
public class ValidationErrorsToStringConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter,
        CultureInfo culture)
    {
        var errors = value as ReadOnlyObservableCollection<ValidationError>;

        // If there are no errors then return an empty string. 
        // This prevents debug exception messages that result from the usual Xaml of "Path=(Validation.Errors)[0].ErrorContent".
        // Instead we use "Path=(Validation.Errors), Converter={StaticResource ValidationErrorsConverter}".
        if (errors == null)
        {
            return string.Empty;
        }

        var errors2 = errors.Select(e => e.ErrorContent).OfType<string>().ToArray();

        return errors.Any() ? string.Join("\n", errors2) : string.Empty;
    }
    public object ConvertBack(object value, Type targetType, object parameter,
        CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

我们可以使用

```
<converters:ValidationErrorsToStringConverter x:Key="ValidationErrorsConverter"/>

<!-- Style to be used as the base style for all text boxes -->
<Style x:Key="TextBoxWithValidation" TargetType="{x:Type TextBox}" BasedOn="{StaticResource {x:Type TextBox}}">
    <Setter Property="Validation.ErrorTemplate" Value="{StaticResource TextBoxValidationTemplate}"/>
    <Style.Triggers>
        <Trigger Property="Validation.HasError" Value="true">
            <Setter Property="Background" Value="{StaticResource BackgroundValidationBrush}"/>
            <Setter 
                Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Mode=Self},
                Path=(Validation.Errors),
                Converter={StaticResource ValidationErrorsConverter}}"
            />
        </Trigger>
    </Style.Triggers>
</Style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:20:22.740

我想你在寻找类似的东西

[数据验证](http://blogs.msdn.com/b/wpfsdk/archive/2007/10/02/data-validation-in-3-5.aspx)

可以使用一个片段：

```
<Binding.ValidationRules>
   <DataErrorValidationRule/>
</Binding.ValidationRules> 
```

定义您的验证规则，如果失败，您将在相关控件周围获得一个红色矩形。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T19:22:59.180

[`Validaton.ErrorTemplate`](http://msdn.microsoft.com/en-us/library/system.windows.controls.validation.errortemplate.aspx)以您的`TextBox`风格设置附加属性。（有关示例，请参阅文档）

# c++ - c++ 中的引用计数到底是什么意思？

> ID：10048165
> 
> 赞同：10
> 
> 时间：2012-04-06T19:17:18.560
> 
> 标签：c++, constructor, copy-constructor

究竟什么是引用计数？特别是，对于 C++，它是什么？如果我们不处理它们，我们会面临哪些问题？所有语言都需要引用计数吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T19:26:20.017

**究竟什么是引用计数？特别是，对于 C++，它是什么？**

简单来说，引用计数意味着计算对对象的引用。

通常，C++ 采用**[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)**技术。其中，管理类型对象的释放的能力依赖于类型对象本身。这意味着用户不必显式地管理对象的生命周期及其释放，执行此管理的功能内置于对象本身中。

此功能意味着对象应该存在并保持有效，直到有利益相关者引用该对象，这是通过引用计数来实现的。每次共享（复制）对象时，引用计数（通常是类类型内的成员）都会增加，每次调用析构函数时计数都会减少，当计数达到 0 时，任何人都不会引用该对象并且它标志着其生命周期的结束，因此它被破坏了。

**如果我们不处理它们，我们会面临哪些问题？**

这将意味着不再有 RAII，以及无休止且经常出错的手动资源管理。
简而言之，编程噩梦。

**所有语言都需要引用计数吗？**

语言*不需要*引用计数，但使用该技术为该语言的用户提供了非常简单的使用和更少的努力，因此大多数语言更喜欢使用它来为他们的用户提供这些优势。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:23:51.530

引用计数是一种简单但不完整的垃圾检测方法。

当计数器达到零时，您可以释放该对象。

但是如果没有更多使用的对象相互引用循环，它们将永远不会被释放

考虑 a**引用**b，b**引用**a，但没有其他**引用**a 或 b。a 和 b的**引用**计数仍为 1（= 正在使用中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T19:21:03.373

引用计数垃圾收集是一种强大的内存管理技术，有助于防止对象被意外删除或多次删除。该技术不仅限于 C++ 代码，尽管它的名称与引用变量的 C++ 概念无关。相反，该术语意味着我们维护对一个对象的所有“拥有引用”的计数，并在该计数变为零时删除该对象。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-06T19:24:51.887

引用计数 - 让我们使用一个比喻。

你有一只耳朵。你希望它在某个时候回来。

你得到一群人指着你的耳朵。他们一指，你就数他们。

当数字变为零时 - 它只是你的，你可以随心所欲地使用它。

即把它从等式中取出（将它释放回内存）。

顺便提一句。圆形的东西很难发现。

# asp.net - asp.net datalist 选择每个类别的所有复选框

> ID：10048170
> 
> 赞同：3
> 
> 时间：2012-04-06T19:17:35.190
> 
> 标签：asp.net, checkbox, datalist

我有一个页面，用户可以在 datalist 控件中选择不同的文档文件。使用 on pre-render 事件处理程序根据类别对文档进行分类。基于复选框控件（不是复选框列表）选择文档。到目前为止，一切都很好。我接下来要做的是在每个类别名称旁边放置一个“全选”复选框，该复选框应仅选择该类别下的复选框。这是数据列表控件：

```
<asp:DataList ID="DataList1" runat="server" RepeatDirection="Vertical" OnPreRender="DataList1_PreRender" DataKeyField="docid" EnableViewState="false">
<ItemTemplate>
    <table cellpadding="0" cellspacing="0" id="tbl_data">
        <tr>
            <td>
                <asp:Label ID="lblHeader" runat="server" Font-Bold="True" Font-Underline="True"></asp:Label>
             <asp:Label runat="server" id="lbl_cb_all" visible="false">Select All <input runat="server" id="cb_selectall" type="checkbox" value='<%# Eval("catid") %>' /> </asp:Label>
            </td>
        </tr>

        <tr runat="server" id="tr_data">
            <td>
                <asp:Label ID="lbl_categoryname" runat="server" Text='<%# Eval("categoryname") %>' Visible="false" /> <!-- Hide this; only used in Code Behind -->
                 <input runat="server" id="cb_docid" type="checkbox" value='<%# Eval("docid") %>' />
                  <asp:Hyperlink ID="hpl_docfileencr" Text='<%# Eval("docfileencr") %>' NavigateUrl='<%# "~/PDFEncr/" + DataBinder.Eval(Container.DataItem, "docfileencr") %>' Target="_blank"  runat="server" />
                <br />
            </td>
        </tr>
    </table>
</ItemTemplate> 
```

这是 OnPreRender 代码：

```
protected void DataList1_PreRender(object sender, EventArgs e)
{
    string strTempLabelCategory = "";
    foreach (DataListItem item in DataList1.Items)
    {

        Label lbl_categoryname = item.FindControl("lbl_categoryname") as Label;

        if (strTempLabelCategory.ToUpper() != lbl_categoryname.Text.ToString().ToUpper())
        {
            strTempLabelCategory = lbl_categoryname.Text.ToString().ToUpper();
            Label lblHeader = item.FindControl("lblHeader") as Label;
            lblHeader.Text = strTempLabelCategory.ToUpper();

            Label lbltempdiv = item.FindControl("lbl_cb_all") as Label;
            lbltempdiv.Visible = true;
        }
    }
} 
```

我一直在寻找可以在我的代码中工作但没有运气的东西。而且我对这段代码投入太多，现在无法尝试 Checkboxlist 控件（不确定这是否会有所帮助）。有任何想法吗？我想我可以使用：[http](http://www.dotnetcurry.com/ShowArticle.aspx?ID=77) ://www.dotnetcurry.com/ShowArticle.aspx?ID=77代码，但不知道如何使它工作？如果我能以某种方式使全选复选框与标签绑定，然后查找所有标签，那么链接的代码可能会有所帮助。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:03:52.340

1.  使用 HiddenFields 存储`CatID`和`DocID`
2.  两者都使用 ASP.NET CheckBoxes 而不是 HTML-Inputs
3.  处理 Check-All Checkbox'`CheckedChanged`事件：

* * *

```
protected void CheckAllChanged(Object sender, EventArgs e)
{
    CheckBox checkAll = (CheckBox)sender;
    DataListItem item = (DataListItem)checkAll.NamingContainer;
    HiddenField HiddenCatID = (HiddenField)item.FindControl("HiddenCatID");
    var catCheckBoxes = DataList1.Items.Cast<DataListItem>()
        .Where(li => ((HiddenField)li.FindControl("HiddenCatID")).Value == HiddenCatID.Value)
        .Select(li => li.FindControl("cb_docid"));
    foreach (CheckBox docCheckBox in catCheckBoxes)
    {
        docCheckBox.Checked = checkAll.Checked;
    }
} 
```

在 aspx 上：

```
<asp:CheckBox runat="server" OnCheckedChanged="CheckAllChanged" AutoPostBack="true"  id="cb_selectall" />
<asp:HiddenField ID="HiddenCatID" runat="server" Value='<%# Eval("CatID") %>' />
<asp:HiddenField ID="HiddenDocID" runat="server" Value='<%# Eval("DocID") %>' /> 
```

您还需要`EnableViewState=true`在 DataList 上维护复选框状态并启用选中/取消选中。

* * *

**编辑**：

因为你有问题让它运行，这里有一个完整的工作示例页面。

这是 aspx 上所需的控件（注意 fe `<tr runat="server" id="tr_category">)`：

```
<ItemTemplate>
    <table cellpadding="0" cellspacing="0" id="tbl_data">
        <tr runat="server" id="tr_category">
            <td>
                <asp:Label ID="lblHeader" runat="server" Font-Bold="True" Text='<%# Eval("categoryname") %>' Font-Underline="True"></asp:Label>
                <asp:Label runat="server" ID="lbl_cb_all">Select All
                <asp:CheckBox runat="server"  OnCheckedChanged="CheckAllChanged" AutoPostBack="true"  id="cb_selectall" />
                </asp:Label>
            </td>
        </tr>
        <tr runat="server" id="tr_data">
            <td>
                <asp:HiddenField ID="HiddenCatID" runat="server" Value='<%# Eval("CatID") %>' />
                <asp:CheckBox runat="server" id="cb_docid" />
                <asp:HyperLink ID="hpl_docfileencr" Text='<%# Eval("docfileencr") %>' NavigateUrl='<%# "~/PDFEncr/" + DataBinder.Eval(Container.DataItem, "docfileencr") %>'
                    Target="_blank" runat="server" />
                <br />
            </td>
        </tr>
    </table>
</ItemTemplate> 
```

1.  确保 DataList 仅是数据绑定`if(!IsPostback)`的，否则将不会维护复选框选择：

    ```
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack) BindDataList();
    } 
    ```

2.  我正在使用`ItemDataBound`，而不是`PreRender`哪个对于正确重新加载 ViewState 很重要。我还简化了所有：

    ```
    protected void DataList1_ItemDataBound(Object sender, DataListItemEventArgs e)
    {
        if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType==ListItemType.AlternatingItem)
        {
            var row  = (DataRowView)e.Item.DataItem;
            var view = row.DataView;
            var lastRow = e.Item.ItemIndex == 0 ? null : view[e.Item.ItemIndex-1];
            var tr_category = (System.Web.UI.HtmlControls.HtmlTableRow)e.Item.FindControl("tr_category");
            var sameCategory = lastRow != null && (int)row["catid"] == (int)lastRow["catid"];
            tr_category.Visible = !sameCategory;
        }
    } 
    ```

3.  `CheckAllChanged`保持不变。

即使您选择了一个文档复选框并随后选择了一个类别复选框，这也会按预期工作，这会导致回发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T13:27:56.717

我想我可以通过对蒂姆的代码进行轻微修改来实现这一点。几点：我不得不为数据列表禁用 ViewState，否则，全选触发器不会保持选中框。我不明白为什么。此外，page_load 事件中没有 ispostback 检查，并且每次加载时都会绑定数据列表。我不是那是“最佳的”或不是。我还制作了两组 Asp:RadioButtons：CheckAll 和 CheckNone，而不是复选框。无论如何，这是相关的代码：

```
<asp:DataList ID="DataList1" runat="server" RepeatDirection="Vertical" DataKeyField="docid"
                EnableViewState="false" OnItemDataBound="DataList1_ItemDataBound">
                <ItemTemplate>
                    <table cellpadding="0" cellspacing="0" id="tbl_data">
                        <tr runat="server" id="tr_category">
                            <td>
                                <asp:Label ID="lblHeader" runat="server" Font-Bold="True" Text='<%# Eval("categoryname") %>'
                                    Font-Underline="True"></asp:Label>
                                <asp:Label runat="server" ID="lbl_cb_all">Select: All
                                    <asp:RadioButton runat="server" OnCheckedChanged="CheckAllChanged" AutoPostBack="true"
                                        ID="rb_selectall" GroupName="selectallnone" />
                                    | None
                                    <asp:RadioButton runat="server" OnCheckedChanged="CheckAllChangedNone" AutoPostBack="true"
                                        ID="rb_selectnone" GroupName="selectallnone" />
                                    <asp:HiddenField ID="HiddenCatID" runat="server" Value='<%# Eval("CatID") %>' />
                                    <asp:HiddenField ID="HiddenDocID" runat="server" Value='<%# Eval("docid") %>' />
                                </asp:Label>
                            </td>
                        </tr>
                        <tr runat="server" id="tr_data">
                            <td>
                                <asp:CheckBox runat="server" ID="cb_docid" Value='<%# Eval("docid") %>' />
                                <asp:HyperLink ID="hpl_docfileencr" Text='<%# Eval("docfileencr") %>' NavigateUrl='<%# "~/PDFEncr/" + DataBinder.Eval(Container.DataItem, "docfileencr") %>'
                                    Target="_blank" runat="server" />
                                <br />
                            </td>
                        </tr>
                    </table>
                </ItemTemplate>
            </asp:DataList>

 protected void DataList1_ItemDataBound(Object sender, DataListItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
        var row = (DataRowView)e.Item.DataItem;
        var view = row.DataView;
        var lastRow = e.Item.ItemIndex == 0 ? null : view[e.Item.ItemIndex - 1];
        var tr_category = (System.Web.UI.HtmlControls.HtmlTableRow)e.Item.FindControl("tr_category");
        var sameCategory = lastRow != null && (int)row["catid"] == (int)lastRow["catid"];
        tr_category.Visible = !sameCategory;
    }
}

protected void CheckAllChanged(Object sender, EventArgs e)
{
    RadioButton checkAll = (RadioButton)sender;
    DataListItem item = (DataListItem)checkAll.NamingContainer;
    HiddenField HiddenCatID = (HiddenField)item.FindControl("HiddenCatID");

    var catCheckBoxes = DataList1.Items.Cast<DataListItem>()
        .Where(li => ((HiddenField)li.FindControl("HiddenCatID")).Value == HiddenCatID.Value)
        .Select(li => li.FindControl("cb_docid"))
        .ToList();
    foreach (CheckBox docCheckBox in catCheckBoxes)
    {
       // docCheckBox.Checked = checkAll.Checked;
        docCheckBox.Checked = true;
    }
 }

protected void CheckAllChangedNone(Object sender, EventArgs e)
{
    RadioButton checkAll = (RadioButton)sender;
    DataListItem item = (DataListItem)checkAll.NamingContainer;
    HiddenField HiddenCatID = (HiddenField)item.FindControl("HiddenCatID");

    var catCheckBoxes = DataList1.Items.Cast<DataListItem>()
        .Where(li => ((HiddenField)li.FindControl("HiddenCatID")).Value == HiddenCatID.Value)
        .Select(li => li.FindControl("cb_docid"))
        .ToList();

    foreach (CheckBox docCheckBox in catCheckBoxes)
    {
        docCheckBox.Checked = false;
    }

} 
```

//订单按钮的部分代码如下；注意 HiddenField 的使用

```
 CheckBox cb = li.FindControl("cb_docid") as CheckBox;

        if (cb != null)
        {
            if (cb.Checked)
            {
                HiddenField docid = li.FindControl("HiddenDocID") as HiddenField;
                string dbcmd = @"Insert Into [order_details] (orderid,docid) Values (" + orderid + "," + docid.Value.ToString() + ")"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-17T08:47:19.923

```
 protected void chkAllN_CheckedChanged(object sender, EventArgs e)
    {
        lblSelectedRecord.InnerText = "0";
        /*this Foreach Loop performing for find gridview*/
        foreach (DataListItem dst in dstMulEmpSalInsert.Items)
        {
            GridView grd = (GridView)dst.FindControl("grdMulEmpSalInsert");
            CheckBox chk_All = (CheckBox)grd.HeaderRow.FindControl("chkAllN");

            if (chk_All.Checked == true)
            {
                /*this Foreach Loop performing for find gridview Controls*/
                foreach (GridViewRow gvr in grd.Rows)
                {
                    CheckBox chk_One = (CheckBox)gvr.FindControl("ChkSendOne");

                    chk_One.Checked = true;
                    txt_Salary.ReadOnly = false;
                    lblSelectedRecord.InnerText = (Convert.ToInt32(lblSelectedRecord.InnerText) + 1).ToString();
                }

            }
            else
            {
                /*this Foreach Loop performing for find gridview Controls*/
                foreach (GridViewRow gvr in grd.Rows)
                {
                    CheckBox chk_One = (CheckBox)gvr.FindControl("ChkSendOne");

                    chk_One.Checked = false;

                }

            }
        }

    } 
```

# android - 在您自己的应用程序中显示系统设置片段/活动

> ID：10048172
> 
> 赞同：0
> 
> 时间：2012-04-06T19:17:42.320
> 
> 标签：android

我需要在我自己的 Android 应用程序中显示特定系统应用程序的应用程序设置屏幕。目前我只能将它作为单独的活动启动，并在后台的计时器上检查用户是否执行了操作（强制停止），然后重新启动我的活动。

我现在拥有的：

```
public static void showInstalledAppDetails(Context context, String packageName)
{
    Intent intent = new Intent();
    intent.setAction(Settings.ACTION_APPLICATION_DETAILS_SETTINGS);
    Uri uri = Uri.fromParts("package", packageName, null);
    intent.setData(uri);
    context.startActivity(intent);
} 
```

我想将设置屏幕集成到我自己的应用程序中，我尝试使用 ActivityGroup，然后将系统设置作为子活动启动。操作失败并出现安全异常（缺少 MANAGE_USB 权限）。

有没有办法使这项工作？

谢谢， 斯瓦夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:21:55.100

> 有没有办法使这项工作？

不，对不起。您不能将来自不同流程的多个活动组合到一个 UI 中。

# ruby - 为什么在 Ruby 中 `rescue Exception => e` 是不好的风格？

> ID：10048173
> 
> 赞同：950
> 
> 时间：2012-04-06T19:17:47.960
> 
> 标签：ruby, exception-handling

Ryan Davis 的[Ruby QuickRef](http://www.zenspider.com/ruby/quickref.html#general-tips)说（没有解释）：

> 不要拯救异常。曾经。否则我会刺伤你。

为什么不？什么是正确的做法？

* * *

## 回答 #1

> 赞同：1429
> 
> 时间：2012-04-06T19:38:01.770

**TL;DR**：`StandardError`改为用于一般异常捕获。当原始异常被重新引发时（例如，当救援只记录异常时），救援`Exception`可能是可以的。

* * *

`Exception`是[Ruby 异常层次结构](http://rubylearning.com/images/exception.jpg)的根，所以当你从*所有东西*`rescue Exception`中拯救出来时，包括诸如、和.*`SyntaxError``LoadError``Interrupt`*

 *救援`Interrupt`阻止用户使用`CTRL``C`退出程序。

救援`SignalException`会阻止程序正确响应信号。它将无法杀死，除非`kill -9`.

救援`SyntaxError`意味着`eval`失败的 s 会默默地这样做。

所有这些都可以通过运行这个程序来显示，并尝试`CTRL``C`或`kill`它：

```
loop do
  begin
    sleep 1
    eval "djsakru3924r9eiuorwju3498 += 5u84fior8u8t4ruyf8ihiure"
  rescue Exception
    puts "I refuse to fail or be stopped!"
  end
end 
```

救援`Exception`甚至不是默认设置。正在做

```
begin
  # iceberg!
rescue
  # lifeboats
end 
```

不解救`Exception`，它解救`StandardError`。通常，您应该指定比默认值更具体的内容`StandardError`，但拯救范围会`Exception` *扩大*而不是缩小范围，并且可能会产生灾难性的结果并使寻找错误变得非常困难。

* * *

如果您确实想从中进行救援，`StandardError`并且需要一个带有异常的变量，则可以使用以下形式：

```
begin
  # iceberg!
rescue => e
  # lifeboats
end 
```

这相当于：

```
begin
  # iceberg!
rescue StandardError => e
  # lifeboats
end 
```

* * *

出于记录/报告目的的少数几种可以正常救援的常见情况之一`Exception`，在这种情况下，您应该立即重新引发异常：

```
begin
  # iceberg?
rescue Exception => e
  # do some logging
  raise # not enough lifeboats ;)
end 
```

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2012-04-07T05:30:41.647

*真正的*规则是：不要丢弃异常。您引用的作者的客观性值得怀疑，这可以从它以

> 否则我会刺伤你

当然，请注意信号（默认情况下）会抛出异常，并且通常长时间运行的进程会通过信号终止，因此捕获异常而不终止信号异常将使您的程序很难停止。所以不要这样做：

```
#! /usr/bin/ruby

while true do
  begin
    line = STDIN.gets
    # heavy processing
  rescue Exception => e
    puts "caught exception #{e}! ohnoes!"
  end
end 
```

不，真的，不要这样做。甚至不要运行它以查看它是否有效。

但是，假设您有一个线程服务器，并且您不希望所有异常：

1.  被忽略（默认）
2.  停止服务器（如果你说会发生这种情况`thread.abort_on_exception = true`）。

那么这在您的连接处理线程中是完全可以接受的：

```
begin
  # do stuff
rescue Exception => e
  myLogger.error("uncaught #{e} exception while handling connection: #{e.message}")
    myLogger.error("Stack trace: #{backtrace.map {|l| "  #{l}\n"}.join}")
end 
```

以上适用于 Ruby 的默认异常处理程序的变体，其优点是它也不会杀死您的程序。Rails 在其请求处理程序中执行此操作。

信号异常在主线程中引发。后台线程不会得到它们，所以试图在那里捕捉它们是没有意义的。

这在生产环境中特别有用，您*不*希望程序在出现问题时简单地停止。然后，您可以在日志中获取堆栈转储并添加到您的代码中，以便在调用链的下游以更优雅的方式处理特定异常。

另请注意，还有另一个具有相同效果的 Ruby 习语：

```
a = do_something rescue "something else" 
```

在这一行中，如果`do_something`引发异常，它会被 Ruby 捕获、丢弃并`a`分配`"something else"`。

一般来说，不要这样做，除非在你*知道*你不需要担心的特殊情况下。一个例子：

```
debugger rescue nil 
```

该`debugger`函数是在代码中设置断点的一种相当不错的方法，但如果在调试器和 Rails 之外运行，它会引发异常。现在从理论上讲，您不应该将调试代码留在程序中（pff！没有人这样做！）但是您可能出于某种原因希望将其保留一段时间，但不要持续运行调试器。

笔记：

1.  如果您运行了其他人的程序来捕获信号异常并忽略它们（比如上面的代码），那么：

    *   在 Linux 中，在 shell 中，键入`pgrep ruby`或`ps | grep ruby`，查找有问题的程序的 PID，然后运行`kill -9 <PID>`​​.
    *   在 Windows 中，使用任务管理器 ( `CTRL`- `SHIFT`- `ESC`)，转到“进程”选项卡，找到您的进程，右键单击它并选择“结束进程”。
2.  如果您正在使用其他人的程序，无论出于何种原因，该程序都充满了这些忽略异常块，那么将其放在主线的顶部是一种可能的逃避：

    ```
    %W/INT QUIT TERM/.each { |sig| trap sig,"SYSTEM_DEFAULT" } 
    ```

    这导致程序通过立即终止、绕过异常处理程序来响应正常终止信号， *而不进行清理*。所以它可能会导致数据丢失或类似情况。当心！

3.  如果您需要这样做：

    ```
    begin
      do_something
    rescue Exception => e
      critical_cleanup
      raise
    end 
    ```

    你实际上可以这样做：

    ```
    begin
      do_something
    ensure
      critical_cleanup
    end 
    ```

    在第二种情况下，`critical cleanup`每次都会调用，无论是否抛出异常。

* * *

## 回答 #3

> 赞同：76
> 
> 时间：2016-01-31T23:55:26.607

## TL;博士

不要`rescue Exception => e`（也不要重新提出例外）-否则您*可能会*开车离开桥梁。

* * *

假设你在车里（运行 Ruby）。您最近安装了一个带有无线升级系统（使用 ）的新方向盘`eval`，但您不知道其中一个程序员搞砸了语法。

你在一座桥上，意识到你正在向栏杆走一点，所以你左转。

```
def turn_left
  self.turn left:
end 
```

哎呀！这可能*不太好*™，幸运的是，Ruby 提出了一个`SyntaxError`.

汽车应该立即停下来——对吧？

没有。

```
begin
  #...
  eval self.steering_wheel
  #...
rescue Exception => e
  self.beep
  self.log "Caught #{e}.", :warn
  self.log "Logged Error - Continuing Process.", :info
end 
```

> **哔哔**
> 
> 警告：捕获 SyntaxError 异常。
> 
> 信息：记录的错误 - 继续过程。

你发现有什么不对劲，你猛踩紧急休息时间（`^C`:)`Interrupt`

> **哔哔**
> 
> 警告：捕获中断异常。
> 
> 信息：记录的错误 - 继续过程。

是的 - 这没有多大帮助。你离铁路很近，所以你把车停在公园里（`kill`ing:）`SignalException`。

> **哔哔**
> 
> 警告：捕获 SignalException 异常。
> 
> 信息：记录的错误 - 继续过程。

`kill -9`在最后一秒，你拔出钥匙（在你的汽车后座撞上它前面的座位。一罐半满的可乐洒在报纸上。后面的杂货被压碎了，大部分都裹着蛋黄和牛奶。这辆车需要认真修理和清洁。（数据丢失）

希望你有保险（备份）。哦，是的 - 因为安全气囊没有膨胀，你可能受伤了（被解雇等）。

* * *

可是等等！有~~更多的~~您可能要使用的原因`rescue Exception => e`！

假设你是那辆车，如果汽车超过其安全停止动量，你想确保安全气囊充气。

```
 begin 
    # do driving stuff
 rescue Exception => e
    self.airbags.inflate if self.exceeding_safe_stopping_momentum?
    raise
 end 
```

这是规则的例外：`Exception` **只有在重新引发异常时**才能捕获。所以，一个更好的规则是永远不要吞下`Exception`，并且总是重新提出错误。

但是在像 Ruby 这样的语言中添加救援很容易忘记，并且在重新提出问题之前放置救援语句感觉有点不干。而且您**不想**忘记该`raise`声明。如果你这样做了，祝你好运，试图找到那个错误。

值得庆幸的是，Ruby 非常棒，您只需使用`ensure`关键字即可确保代码运行。`ensure`无论如何，该关键字都会运行代码 - 如果抛出异常，如果没有，唯一的异常是世界结束（或其他不太可能发生的事件）。

```
 begin 
    # do driving stuff
 ensure
    self.airbags.inflate if self.exceeding_safe_stopping_momentum?
 end 
```

繁荣！并且该代码无论如何都应该运行。您应该使用的唯一原因`rescue Exception => e`是如果您需要访问异常，或者您只希望代码在异常上运行。并记得重新提出错误。每次。

注意：正如@Niall 指出的，确保**始终**运行。这很好，因为有时您的程序可能会欺骗您并且不会抛出异常，即使发生问题也是如此。对于关键任务，例如给安全气囊充气，您需要确保它无论如何都会发生。正因为如此，每次停车时检查一下是否抛出异常是一个好主意。尽管在大多数编程环境中给安全气囊充气是一项不常见的任务，但这实际上在大多数清理任务中很常见。

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2012-04-06T19:21:19.510

因为这会捕获所有异常。您的程序不太可能从其中**任何一个**中恢复。

您应该只处理您知道如何从中恢复的异常。如果您没有预料到某种异常，请不要处理它，大声崩溃（将详细信息写入日志），然后诊断日志并修复代码。

吞咽异常是不好的，不要这样做。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-04-06T23:54:05.867

这是规则的一个特定情况，您不应该捕获*任何*您不知道如何处理的异常。如果您不知道如何处理它，最好让系统的其他部分捕获并处理它。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-11-06T22:59:14.063

这篇博文完美地解释了它： [Ruby's Exception vs StandardError: What's the difference?](https://www.honeybadger.io/blog/ruby-exception-vs-standarderror-whats-the-difference/)

> ### 为什么你不应该拯救异常
> 
> 拯救 Exception 的问题在于它实际上拯救了每一个继承自 Exception 的异常。这是....所有这些！
> 
> 这是一个问题，因为 Ruby 内部使用了一些异常。它们与您的应用程序没有任何关系，吞下它们会导致坏事发生。
> 
> 以下是一些大的：
> 
> *   SignalException::Interrupt - 如果你救了这个，你不能通过按 control-c 来退出你的应用程序。
>     
>     
> *   ScriptError::SyntaxError - 吞下语法错误意味着像 puts("Forgot something) 这样的东西会默默地失败。
>     
>     
> *   NoMemoryError - 想知道当您的程序在用完所有 RAM 后继续运行时会发生什么？我也不。
>     
>     
> 
> ```
> begin
>   do_something()
> rescue Exception => e
>   # Don't do this. This will swallow every single exception. Nothing gets past it. 
> end 
> ```
> 
> 我猜你真的不想吞下任何这些系统级异常。您只想捕获所有应用程序级别的错误。异常导致您的代码。
> 
> 幸运的是，有一个简单的方法可以做到这一点。
> 
> ### 救援 StandardError 代替
> 
> 您应该关心的所有异常都继承自 StandardError。这些是我们的老朋友：
> 
> NoMethodError - 当您尝试调用不存在的方法时引发
> 
> TypeError - 由 1 + "" 之类的东西引起
> 
> RuntimeError - 谁能忘记旧的 RuntimeError？
> 
> 要挽救此类错误，您需要挽救 StandardError。你可以通过写这样的东西来做到这一点：
> 
> ```
> begin
>   do_something()
> rescue StandardError => e
>   # Only your app's exceptions are swallowed. Things like SyntaxErrror are left alone. 
> end 
> ```
> 
> 但是 Ruby 使它更易于使用。
> 
> 当您根本没有指定异常类时，ruby 假定您的意思是 StandardError。所以下面的代码和上面的代码是一样的：
> 
> ```
> begin
>   do_something()
> rescue => e
>   # This is the same as rescuing StandardError
> end 
> ```*

# ajax - 上传本地文件内容而不刷新页面

> ID：10048175
> 
> 赞同：0
> 
> 时间：2012-04-06T19:17:59.393
> 
> 标签：ajax, spring-mvc, file-upload, javascript

我的网络流中有一个页面，我想在不刷新页面的情况下上传文件。我尝试为此使用 Ajax 调用，但失败了。我不知道如何将上传文件中的数据发送到服务器端/后端进行进一步处理。我正在使用 Spring MVC 框架，我不想使用 PHP。

谁能建议我可以完成工作的解决方案或一些示例代码？我对 JavaScript 很陌生。

还有一件事是我必须在去服务器端处理上传的文件后返回同一页面并从服务器端返回带有字符串的同一页面。这一切都发生在不刷新当前页面的情况下

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:41:38.377

假设您已经构建了表单并设置了服务器端控制器来处理上传，这个小片段应该让您走上 AJAX-y 无刷新文件上传荣耀之路！

```
//create a new FormData reference
//(note: you could use getElementById or querySelector)
var myForm = document.forms.myUploadForm; 
var fd = new FormData(myForm);

//create and open an XHR
var xhr = new XMLHttpRequest();
xhr.open("POST","http://www.example.url/the/path/to/your/upload/controller");

//set up event listeners (optional)
xhr.onreadystatechange = monitorStatusFunction;
xhr.onprogress = updateProgressBarFunction;

//send the form (w/ no page refresh!)
xhr.send(fd); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T17:12:55.507

我挣扎了很多天，最后我想出了一个可能不是最佳解决方案的解决方案，但我将其发布在这里，以便像我这样的任何人都可以从中获得帮助..

满足我所有的要求

我从我的 jsp 页面打开了一个 jsp 页面作为弹出窗口，从该页面我登陆我的控制器并在服务器端完成我的工作并返回一个字符串，具体取决于上传到同一弹出页面的文件的内容和从弹出我将该字符串转移到我的父页面。

因此，我的工作在没有刷新页面的情况下完成......执行此操作的步骤 1.打开一个弹出窗口，如下所示

> window.open('//要打开的jsp页面的url','//somename','//弹出页面的属性');

2.从弹出窗口登陆你的控制器并返回到同一个jsp页面，其中包含我想要的jsp页面中的字符串。3.将该字符串传递给父页面，如下所示。

> window.open.urparentjspfuntion(valuefromcontroller);

4.在父页面中定义一个功能来做你想做的事.....

我希望这个解决方案可以帮助像我这样的人......

# php - 带有 nodeValue 的 php getElementsByTagName 返回邪恶字符

> ID：10048181
> 
> 赞同：0
> 
> 时间：2012-04-06T19:18:25.877
> 
> 标签：php, getelementsbytagname, nodevalue

我有一些像这样的 utf-8 html：

`<a href="http://example.com">Today&nbsp;11:12&nbsp;AM</a>`

并`getElementsByTagName('a')->item(0)->nodeValue`返回：

`TodayÃ‚Â 11:12Ã‚Â AM`

我在这个 html 中的其他节点没有任何问题。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T19:24:35.560

尝试显式设置 DOMDocument 对象的编码：

```
$dom = new DOMDocument('1.0', 'UTF-8'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T17:14:31.630

源文件是 ASP 和 IIS。

我最终将它用于有问题的角色：

```
str_replace( chr(), chr(), $html); 
```

# c# - 将 DataTable 中的所有记录插入远程数据库

> ID：10048188
> 
> 赞同：0
> 
> 时间：2012-04-06T19:19:19.057
> 
> 标签：c#, mysql

我有一个带有几条记录的 DataTable。我想将所有这些记录插入远程数据库。最简单的方法是什么？我读到大多数人遍历 DataTable 的行并逐条插入记录。我只想与远程服务器建立 1 个连接并进行批量插入。可能吗？我正在使用 C# 和 MySQL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-19T23:38:54.997

尽管 Kemal Taskin 的答案是一个优雅的解决方案，但使用大型 DataTable 的性能却很糟糕。
我尝试插入 37500 条记录，耗时超过 15 分钟。
它似乎一次插入一条记录。
我发现如果我生成一个包含 1000 条记录的 MySQL 插入语句字符串并循环数据直到其完成，我将插入时间减少到 6 秒。这不是批量加载，而是块加载。如果有人能提出更好的解决方案，请告诉我。

```
 public void writeToDBTable(DataTable dt)     
    {

        MySqlConnection conn = new MySqlConnection(globalClass.connString);
        conn.Open();
        String sql = null;
        String sqlStart = "insert into MyTable (run_id, model_id, start_frame,water_year, state_id, obligateCover, DTWoodyCover, perennialGrowth, clonalCover) values ";

        Console.WriteLine("Write to DB - Start. Records to insert  = {0}", dt.Rows.Count);
        int x = 0;            

        foreach (DataRow row in dt.Rows)
        {
            x += 1;
                if (x == 1)
                {
                    sql = String.Format(@"({0},{1},{2},{3},{4},{5},{6},{7},{8})",
                                          row["runId"],
                                          row["modelId"],
                                          row["startFrame"],
                                          row["waterYear"],
                                          row["currentFrame"],
                                          row["obligateCover"],
                                          row["DTWoodyCover"],
                                          row["perennialGrowth"],
                                          row["clonalCover"]
                                          );
                }
                else
                {
                    sql = String.Format(sql + @",({0},{1},{2},{3},{4},{5},{6},{7},{8})",
                                          row["runId"],
                                          row["modelId"],
                                          row["startFrame"],
                                          row["waterYear"],
                                          row["currentFrame"],
                                          row["obligateCover"],
                                          row["DTWoodyCover"],
                                          row["perennialGrowth"],
                                          row["clonalCover"]
                                          );

                }

                if (x == 1000)
                {
                   try
                   {
                       sql = sqlStart + sql;
                       MySqlCommand cmd = new MySqlCommand(sql, conn);
                       cmd.ExecuteNonQuery();
                       Console.WriteLine("Write {0}", x);
                       x = 0;
                   }
                   catch (Exception ex)
                    {
                        Console.WriteLine(sql);
                        Console.WriteLine(ex.ToString());
                    }
                }

        }
        // get any straglers
        if (x > 0)
        {
            try
            {
                sql = sqlStart + sql;
                MySqlCommand cmd = new MySqlCommand(sql, conn);
                cmd.ExecuteNonQuery();
                Console.WriteLine("Write {0}", x);
                x = 0;
            }
            catch (Exception ex)
            {
                Console.WriteLine(sql);
                Console.WriteLine(ex.ToString());
            }

        }

        conn.Close();
        Console.WriteLine("Write to DB - End.");
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T16:56:56.747

我不知道这个答案是否为时已晚:)

你可以这样做：

```
// assume you have a table with one column;
string commandText = "insert into t_test1 (myid) values (@tempid)";

using (MySqlConnection cn = new MySqlConnection(myConnectionString))
{
    cn.Open();

    using (MySqlCommand cmd = new MySqlCommand(commandText, cn))
    {
        cmd.UpdatedRowSource = UpdateRowSource.None;

        cmd.Parameters.Add("?tempid", MySqlDbType.UInt32).SourceColumn = "tempid";

        MySqlDataAdapter da = new MySqlDataAdapter();
        da.InsertCommand = cmd;
        // assume DataTable dt contains one column with name "tempid"
        int records = da.Update(dt);
    }

    cn.Close();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-18T07:38:35.507

对于 Kemal Taşkın 解决方案，RowState 集必须等于 DataRowState.Added。如果不是这种情况，请执行以下操作：

```
foreach (DataRow row in dt.Rows)
    row.SetAdded(); 
```

对于Mr.Black，建议使用sql参数，不要直接使用数据值。

将数据导入 InnoDB 时，请关闭自动提交模式，因为它会为每次插入执行日志刷新到磁盘。要在导入操作期间禁用自动提交，请使用 SET autocommit 和 COMMIT 语句将其括起来：

```
SET autocommit=0;
... SQL import statements ...
COMMIT; 
```

性能测试：在 2 个表中插入 5400 行

*   从 CSV 文件插入：3 秒

    LOAD DATA INFILE 'data.csv' INTO TABLE myTable 由 '\t' 终止；

*   使用 Kemal Taşkın 解决方案插入：32 秒

    MySqlDataAdapter.Update (DataTable)

*   逐行插入（）：41秒

    INSERT INTO 表（列）VALUES（值）；

    INSERT INTO 表（列）VALUES（值）；

    ...

*   在一个查询中插入所有行：143 秒

    INSERT INTO table (columns) VALUES (values), (values), ...;

=> LOAD DATA 是迄今为止性能最高的！

您还可以查看这篇文章： [https ://dev.mysql.com/doc/refman/8.0/en/insert-optimization.html](https://dev.mysql.com/doc/refman/8.0/en/insert-optimization.html)

# assembly - x86 ROR 指令是如何工作的？

> ID：10048190
> 
> 赞同：1
> 
> 时间：2012-04-06T19:19:23.050
> 
> 标签：assembly, x86

我的`EAX`寄存器包含该`xxxxxx9D`值，并且我有以下汇编代码：

```
C0C8 14 --> ROR AL,14 
```

对我来说，这意味着`EAX`32 位值的最后 8 位按位旋转 14 mod 8 = 6 个位置

```
0x9D = b1001 1101 
```

将转化为

```
b0111 0110 = 0x76 
```

但是，OllyDbg 告诉我`EAX = xxxxxxD9`，这意味着 EAX 已按位旋转了 4 位！

我哪里错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T19:31:42.267

您正在尝试将 8 位寄存器旋转 20 个位置。这有点多，旋转 8 会产生相同的值。旋转 9 与旋转 1 相同。等等。因此，处理器将旋转 20 mod 8 = 4 个位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:31:32.780

发布您的完整代码，其中：

```
mov     al,$9d
ror     al,14 
```

正如预期的那样，我得到了 76。

**编辑**如果您轮换 14 美元的位置，您将获得 d9。

# c++ - 用于 C++ 中复杂用户定义类型的 RVO

> ID：10048197
> 
> 赞同：10
> 
> 时间：2012-04-06T19:19:50.250
> 
> 标签：c++, return-value-optimization

在我昨天的一次编程面试中，我必须编写的一个程序最终得到了这样的结果：

```
struct Blob
{
    // basic field containing image blob statistics.
};

std::vector<Blob> find_blobs (const Image& ...)
{
    std::vector<Blob> blobs;
    // ...
    return blobs;
} 
```

我对[返回值优化](http://en.wikipedia.org/wiki/Return_value_optimization)（RVO）很熟悉，所以我刚刚提到返回向量不会导致流行编译器上的副本（最后一行有一个返回语句，并且没有控制路径可以返回另一个对象我写的代码）。

但是，面试官告诉我，由于`Blob`可能是复杂的用户定义类型（UDT），编译器可能无法执行 RVO。他进一步补充说，返回 a`std::vector<Blob*>`会增加编译器执行复制省略的机会。

据我所知，编译器执行 RVO 的能力与返回的对象的类型完全无关，除了不可复制的对象，编译器将（应该？）拒绝代码，即使结果代码无需调用复制构造函数就可以编译。

那么，面试官说的对吗？复杂的返回类型能否阻止编译器应用 RVO？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-06T19:23:32.810

不，使用的类型不应影响优化。

*我看到使用指针的唯一原因是，如果*编译器无法通过 RVO ，它们的复制成本会更低。最流行的编译器不太可能。

# perl - 检查字符串中的字符的 Unicode 值

> ID：10048198
> 
> 赞同：1
> 
> 时间：2012-04-06T19:19:50.660
> 
> 标签：perl, unicode, utf-8

我想用破折号替换变量中某些 Unicode 值的字符。我有两个可能可行的想法，但我不知道如何检查字符的值：

1/ 将变量处理为字符串，检查每个字符的值并将这些字符放入一个新变量中（替换那些无效的字符）

2/使用这些魔法:-)

```
$variable = s/[$char_range]/-/g; 
```

char_range 应该类似于`[0-9]`or `[A-Z]`，但它应该是 utf-8 字符的值。准确地说，我需要从 0x00 到 0x7F 的范围。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:14:54.503

没有 UTF-8 字符之类的东西。只有您编码为 UTF-8 的字符。即使这样，您也不想在 Perl 所知道的神奇范围之外创建范围。你可能会得到比你预期更多的东西。

要获取字符的序数值，请使用`ord`：

```
 use utf8;
 my $code_number = ord '';  # U+1F638

 say sprintf "%#x", $code_number; 
```

但是，我认为这不是您所需要的。听起来您想将 ASCII 范围内的字符替换为`-`. 您可以指定代码范围：

```
 s/[\000-\177]/-/g;  # in octal
 s/[\x00-\x7f]/-/g;  # in hexadecimal 
```

您可以在大括号中指定宽字符序数值：

```
 s/[\x80-\x{10ffff}]/-/g;  # wide characters, replace non-ASCII in this case 
```

当字符具有共同属性时，您可以使用它：

```
 s/\p{ASCII}/-/g; 
```

但是，如果您要逐个字符地替换事物，则可能需要音译：

```
$string =~ tr/\000-\177/-/; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T19:41:00.693

下面的表达式应该用连字符替换任何不是 ASCII 的东西，这是（我认为）你想要做的：

```
s/[\N{U+0080}-\N{U+FFFF}]/-/g 
```

# jquery - 在 IE 中使用 jquery ui 按钮悬停时出现意外的移动样式行为

> ID：10048200
> 
> 赞同：0
> 
> 时间：2012-04-06T19:20:12.923
> 
> 标签：jquery, html, css, internet-explorer, jquery-ui

我正在使用 jquery-ui 和 html5 样板进行一些更改。当我将鼠标悬停在按钮页面上时，页面正在移动。

![在此处输入图像描述](../Images/6b7234fdacb6bf99d01882c5e04351d9.png)

示例页面可以在[这里](http://www.bedavaemlaksitesi.com/mersinemlakrehberi210/kullanicipaneli/login)看到。

我怎样才能防止这种情况？

# sockets - SSL 套接字服务器的连接问题

> ID：10048204
> 
> 赞同：1
> 
> 时间：2012-04-06T19:20:29.640
> 
> 标签：sockets, sslstream

带有 SSLStream 的 Socket 服务器有时会拒绝来自客户端的新连接。

我使用了远程主机名端口，它说`Connecting To host...`

> 无法在端口 6002 上打开与主机的连接：连接失败

我用过`netstat -a`，我看到 TCP 状态为

> TCP 0.0.0.0:6002 主机：0 监听

我也认为该服务也在监听`tcpview`。

我在客户端看到的错误是`connection refused with error code 10061`.

同一个套接字服务器正在接受新连接，并且运行良好，没有任何问题。但一段时间后，上述问题发生了。它是随机的。

当我重新启动套接字时，它工作正常并接受连接，我不想经常这样做。因为这会断开已经连接的客户端。

有人可以帮我解决这个问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:43:41.340

你在哪里运行netstat？在服务器上？

1.  尝试使用目标 IP 地址 127.0.0.1 从本地主机（从服务器本身）连接到套接字
2.  对服务器的网络 IP 做同样的测试。

我的猜测是防火墙阻止了外部访问，或者中间的路由器阻止了连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:27:06.910

它工作了一段时间，然后停止。我能想到的几个选项：

1.  途中的一些防火墙会进行某种节流

2.  您太快地打开和关闭太多连接。在这种情况下，您会耗尽客户端（通常）和/或服务器上的临时端口。如果您执行 netstat -a 您将看到很多处于 TIME_WAIT 状态的套接字，请在客户端和服务器上尝试此操作。这里的解决方案是重用连接（最好）。或者增加临时端口的数量（注册表设置）。但这只会带您到此为止。

3.  您的服务器中有一个错误，它会在一段时间后停止接受新连接。

# python - 如何在这个（简单）python 过程中正确使用递归？

> ID：10048205
> 
> 赞同：1
> 
> 时间：2012-04-06T19:20:41.957
> 
> 标签：python, data-structures, recursion

伙计们，我写了一个函数来测试两个输入（a和b）是否具有相同的数据结构，这样：

```
print same_structure([1, 0, 1], [a, b, c])
#>>> True
#print same_structure([1, [0], 1], [2, 5, 3])
>>> False
#print same_structure([1, [2, [3, [4, 5]]]], ['a', ['b', ['c', ['d', 'e']]]])
>>> True  
#print same_structure([1, [2, [3, [4, 5]]]], ['a', ['b', ['c', ['de']]]])
>>> False 
```

这个函数（在我的实现中）使用递归。我是递归的初学者，我仍然难以递归思考。另外，为了避免欺骗答案，我想使用我自己的（凌乱的）代码，并通过它学习正确使用递归调用（使用此代码行：'same_structure return (a [i], b [e])' ）。有人可以展示如何在下面的代码中正确使用递归吗？提前感谢您的帮助！！！

```
def is_list(p):
return isinstance(p, list)

def same_structure(a,b):
    if not is_list(a) and not is_list(b):
        print '#1'
        return True
    else:
        if is_list(a) and is_list(b):
            print '#2'
            if len(a) != len(b):
                print '#3'
                return False
            if len(a) == len(b):
                print '#4'
                for e in range(len(a)):
                    print 'e = ', e, 'a[e]= ', a[e], 'b[e]=', b[e]
                    return same_structure(a[e], b[e])           
        else:
            return False 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:29:40.217

以下作品：

```
def same_structure(a, b):
    if isinstance(a, list) and isinstance(b, list) and len(a) == len(b):
        return all(same_structure(A, B) for A, B in zip(a, b))
    return (not isinstance(a, list) and not isinstance(b, list)) 
```

编写递归函数时，首先需要提出基本情况，即只返回一个值而不是调用任何递归。这里的基本情况是以下条件之一：

*   `a`是一个列表而`b`不是，反之亦然：返回 False
*   `a`and`b`都是列表，但它们的长度不同：返回 False
*   既不是列表`a`也不`b`是列表：返回 True

如果`a`和`b`都是列表并且它们具有相同的长度，我们现在需要递归地检查这些列表的每个元素。 `zip(a, b)`提供了一种方便的方法来迭代每个列表中的元素，如果`same_structure()`任何两个子元素的结果为 False，我们希望整个函数返回 False。这就是`all()`使用的原因，如果您不熟悉`all()`它与以下循环等效（但更有效）：

```
match = True
for A, B in zip(a, b):
    if not same_structure(A, B):
        match = False
        break
return match 
```

这是您如何在不进行太多更改的情况下重写函数的方法，逻辑实际上与我的解决方案非常相似，但就在`print '#4'`您过早从该循环返回的下方：

```
def same_structure(a,b):
    if not is_list(a) and not is_list(b):
        print '#1'
        return True
    else:
        if is_list(a) and is_list(b):
            print '#2'
            if len(a) != len(b):
                print '#3'
                return False
            if len(a) == len(b):
                print '#4'
                for e in range(len(a)):
                    print 'e = ', e, 'a[e]= ', a[e], 'b[e]=', b[e]
                    if not same_structure(a[e], b[e]):
                        return False
                return True        
        else:
            return False 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T19:52:55.097

试试这个解决方案，它适用于您的所有示例，并且它以递归、函数式编程风格编写，但不使用`zip`,`all`等，仅切片以在每个步骤中减小列表的大小：

```
def same_structure(a, b):
    if a == [] or b == []:
        return a == b
    elif is_list(a[0]) != is_list(b[0]):
        return False
    elif not is_list(a[0]):
        return same_structure(a[1:], b[1:])
    else:
        return same_structure(a[0], b[0]) and same_structure(a[1:], b[1:]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T19:30:43.527

你只是在做第一次递归调用，因为你马上就回来了。

如果我理解您想要做什么，您需要使用子元素调用 same_structure，并检查它的返回值（而不是立即返回）。如果任何调用的结果为假，则返回假，否则，返回真。

# javascript - node-mongodb findOne 行为

> ID：10048206
> 
> 赞同：0
> 
> 时间：2012-04-06T19:20:44.343
> 
> 标签：javascript, node.js, mongodb

我有一个奇怪的问题，我似乎无法解释。鉴于以下情况：

```
Generics.prototype.getCollection= function(collection,callback) {
  this.db.collection(collection, function(error, document_collection) {
    if( error ) callback(error);
    else callback(null, document_collection);
  });
};

Generics.prototype.findById = function(collection, id, callback) {
    this.getCollection(collection,function(error, document_collection) {
      if( error ) callback(error)
      else {
        document_collection.findOne({_id: document_collection.db.bson_serializer.ObjectID.createFromHexString(id)}, function(error, result) {
          if( error ) callback(error)
          else callback(null, result)
        });
      }
    });
};

Generics.prototype.findOne = function(collection, _key, _value, callback) {
    this.getCollection(collection,function(error, document_collection) {
      if( error ) callback(error)
      else {
        document_collection.findOne({_key:_value}, function(error, result) {
          if( error ) callback(error)
          else callback(null, result)
        });
      }
    });
}; 
```

findById 就像一个魅力。但是，findOne 在执行时总是返回 null。我启动了 node-debugger 以找出交易是什么，我发现其中一个传递的变量正在以某种方式被破坏/擦除。_key 似乎总是被删除。_value 然而总是存在的。我尝试将 _key 重命名为其他名称，无论如何，它总是被删除。任何关于可能发生的事情的想法将不胜感激。谢谢！

***更新*** 我只是重构了一下，以允许更灵活的搜索查询，并使其与一个变量一起工作。我还是想知道发生了什么。我觉得这是一些我不太了解的关闭业务。

```
Generics.prototype.findOne = function(collection, searchKeys, callback) {
    this.getCollection(collection,function(error, document_collection) {
      if( error ) callback(error)
      else {
        document_collection.findOne(searchKeys, function(error, result) {
          if( error ) callback(error)
          else callback(null, result)
        });
      }
    });
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:12:43.090

如果您使用 {} 语法，就像您将对象的键传递给 findOne 方法时所做的那样，Javascript 将始终将对象的键视为字符串：

```
{_key:_value} 
```

换句话说，上面的对象基本上被视为：

```
{ '_key': _value } 
```

我认为这不是你想要的。克服这个问题的一种常见方法是创建一个对象并使用 [] 运算符，如下所示：

```
var temp = {};
temp[_key] = _value; // here, the _temp symbol is interpreted as a js variable 
```

# c++ - ostream 尊重运算符 <<

> ID：10048208
> 
> 赞同：3
> 
> 时间：2012-04-06T19:20:52.050
> 
> 标签：c++, operators, cout

为什么这很好用：

```
cout << "foo"; 
```

虽然这没有？

```
(&cout)->operator<<("foo"); 
```

它适用于数值，所以我猜它与覆盖有关。（我正在使用 MS Visual C++ 编译器。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-06T19:27:17.817

`operator<<`仅作为有限数量类型的成员函数实现。对于其他类型，它被实现为全局重载，例如：

```
std::ostream &operator<<(std::ostream &os, T const &t) { 
    // write the data here
} 
```

您使用的语法仅适用于作为成员函数实现的重载，而不是作为全局函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:59:08.583

`cout`有一个重载的成员函数`operator<<(const void *)`。这是最匹配的说法`"foo"`。(`const char*`隐式转换为`const void*`。) 因此，将输出一个指针。

```
// These call std::ostream& operator<<(std::ostream &os, const char * val)    
cout << "foo";
operator<<(cout,"foo");

// This calls cout's member function operator<<(const void * val)
(&cout)->operator<<("foo"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T19:32:42.773

要获得输出`cout << "foo";`，您必须重载运算符`<<`。

# haskell - 管理状态 - SICP 第 3 章

> ID：10048213
> 
> 赞同：11
> 
> 时间：2012-04-06T19:21:08.417
> 
> 标签：haskell, state, sicp, state-monad

我一直在[研究计算机程序的结构和解释，](http://mitpress.mit.edu/sicp/)并在 Haskell 中完成练习。前两章很好（[github 上](https://github.com/chris-taylor/SICP-in-Haskell)的代码），但第 3 章让我更加努力地思考。

首先讨论管理状态，以银行账户为例。他们定义了一个`make-withdraw`函数

```
(define (make-withdraw balance)
    (lambda (amount)
        (if (>= balance amount)
            (begin (set! balance (- balance amount))
                balance)
            "Insufficient funds"))) 
```

这样您就可以执行以下代码：

```
(define w1 (make-withdraw 100))
(define w2 (make-withdraw 100))

(w1 50)
50

(w2 70)
30

(w2 40)
"Insufficient funds"

(w1 40)
10 
```

我不确定如何在 Haskell 中模拟这一点。我首先想到了一个使用 State monad 的简单函数：

```
import Control.Monad.State

type Cash    = Float
type Account = State Cash

withdraw :: Cash -> Account (Either String Cash)
withdraw amount = state makewithdrawal where
    makewithdrawal balance = if balance >= amount
        then (Right amount, balance - amount)
        else (Left "Insufficient funds", balance) 
```

这允许我运行代码

```
ghci> runState (do { withdraw 50; withdraw 40 }) 100
(Left "Insufficient funds",30.0) 
```

但这与方案代码有所不同。理想情况下，我可以运行类似的东西

```
do
  w1 <- makeWithdraw 100
  w2 <- makeWithdraw 100
  x1 <- w1 50
  y1 <- w2 70
  y2 <- w2 40
  x2 <- w1 40
  return [x1,y1,y2,x2]

[Right 50,Right 70,Left "Insufficient funds",Right 40] 
```

但我不确定如何编写函数`makeWithdraw`。有什么建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T19:50:32.687

Scheme 代码偷偷使用了两个状态位：一个是变量和一个 ref-cell 之间的（隐式）`w1`关联`w2`；另一个是存储在参考单元中的（显式）状态。在 Haskell 中有几种不同的方法可以对此进行建模。例如，我们可以使用类似的 ref-cell 技巧`ST`：

```
makeWithdraw :: Float -> ST s (Float -> ST s (Either String Float))
makeWithdraw initialBalance = do
    refBalance <- newSTRef initialBalance
    return $ \amount -> do
        balance <- readSTRef refBalance
        let balance' = balance - amount
        if balance' < 0
            then return (Left "insufficient funds")
            else writeSTRef refBalance balance' >> return (Right balance') 
```

这让我们可以这样做：

```
*Main> :{
*Main| runST $ do
*Main|   w1 <- makeWithdraw 100
*Main|   w2 <- makeWithdraw 100
*Main|   x1 <- w1 50
*Main|   y1 <- w2 70
*Main|   y2 <- w2 40
*Main|   x2 <- w1 40
*Main|   return [x1,y1,y2,x2]
*Main| :}
[Right 50.0,Right 30.0,Left "insufficient funds",Right 10.0] 
```

另一种选择是使状态的两个部分都明确，例如通过将每个帐户与唯一的`Int`id 相关联。

```
type AccountNumber = Int
type Balance = Float
data BankState = BankState
    { nextAccountNumber :: AccountNumber
    , accountBalance :: Map AccountNumber Balance
    } 
```

当然，我们基本上会重新实现 ref-cell 操作：

```
newAccount :: Balance -> State BankState AccountNumber
newAccount balance = do
    next <- gets nextAccountNumber
    modify $ \bs -> bs
        { nextAccountNumber = next + 1
        , accountBalance = insert next balance (accountBalance bs)
        }
    return next

withdraw :: Account -> Balance -> State BankState (Either String Balance)
withdraw account amount = do
    balance <- gets (fromMaybe 0 . lookup account . accountBalance)
    let balance' = balance - amount
    if balance' < 0
        then return (Left "insufficient funds")
        else modify (\bs -> bs { accountBalance = insert account balance' (accountBalance bs) }) >> return (Right balance') 
```

然后让我们写`makeWithdraw`：

```
makeWithDraw :: Balance -> State BankState (Balance -> State BankState (Either String Balance))
makeWithdraw balance = withdraw <$> newAccount balance 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-06T19:49:09.083

好吧，这里有多个独立的、可变的状态：系统中的每个“帐户”都有一个。`State`monad 只允许你拥有一个*状态*。您可以在状态中存储类似的内容，每次`(Int, Map Int Cash)`递增以在地图中获取一个新键，并使用它来存储余额......但这太难看了，不是吗？`Int`

然而，值得庆幸的是，Haskell 有一个用于多个独立、可变状态的 monad [`ST`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Monad-ST.html)：.

```
type Account = ST

makeWithdraw :: Cash -> Account s (Cash -> Account s (Either String Cash))
makeWithdraw amount = do
    cash <- newSTRef amount
    return withdraw
  where
    withdraw balance
        | balance >= amount = do
            modifySTRef cash (subtract amount)
            return $ Right amount
        | otherwise = return $ Left "Insufficient funds" 
```

有了这个，您的代码示例应该可以正常工作；只是申请[`runST`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Monad-ST.html#v%3arunST)，你应该得到你想要的列表。`ST`monad 非常简单：你可以创建和修改s，它的[`STRef`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-STRef.html)行为就像普通的可变变量一样；其实他们的界面和[`IORef`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-IORef.html)s的界面基本一致。

唯一棘手的是额外的`s`类型参数，称为*状态线程*。这用于将每个`STRef`与`ST`它创建的上下文相关联。如果你可以`STRef`从一个`ST`动作中返回一个并将它带到*另一个* `ST`上下文中，那将是非常糟糕的——关键`ST`是你可以在外面作为纯代码运行它的`IO`，但是如果`STRef`s 可以逃脱，那么您将在单子上下文之外拥有不纯的、可变的状态，只需将所有操作包装在`runST`! 因此，每个`ST`和`STRef`都携带相同的`s`类型参数，并且`runST`具有 type `runST :: (forall s. ST s a) -> a`。这会阻止您选择任何特定的值`s`：您的代码必须使用所有可能的值`s`。它从未分配任何特定类型；只是用作保持状态线程隔离的技巧。

# iphone - 运行时错误：不推荐使用 stringWithCString

> ID：10048214
> 
> 赞同：-1
> 
> 时间：2012-04-06T19:21:16.777
> 
> 标签：iphone, objective-c, ios, runtime

我使用了这段代码：

```
const char *propName = property_getName(property);

NSString *propertyName = [NSString stringWithCString:propName]; 
```

编译器给了我“不推荐使用 stringWithCString”。那么，正确的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:22:06.553

正确的方法是`+[NSString stringWithUTF8String:]`

# python - 比较 Django 中的日期和日期时间

> ID：10048216
> 
> 赞同：10
> 
> 时间：2012-04-06T19:21:20.193
> 
> 标签：python, django, django-models

我有一个带有日期时间字段的模型：

```
class MyModel(models.Model):
    created = models.DateTimeField(auto_now = True) 
```

我想获取今天创建的所有记录。

我试过：

```
MyModel.objects.all().filter(created = timezone.now()) 
```

和

```
MyModel.objects.all().filter(created = timezone.now().date()) 
```

但总是得到一个空集。Django 中执行此操作的正确方法是什么？

**编辑：**

看起来很奇怪，但是今天（06.04.2012 23:09:44）创建的记录在数据库中有日期（2012-04-07 04:09:44）。当我尝试在管理面板中对其进行编辑时，它看起来是正确的（06.04.2012 23:09:44）。Django 会以某种方式处理它吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2016-05-31T14:26:42.963

从 2015 年的某个地方开始：

```
YourModel.objects.filter(some_datetime__date=some_date) 
```

即日期时间字段之后的__date。

[https://code.djangoproject.com/ticket/9596](https://code.djangoproject.com/ticket/9596)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-06T19:30:57.703

可能有更合适的解决方案，但快速检查表明这会起作用：

```
from datetime import timedelta

start_date = timezone.now().date()
end_date = start_date + timedelta( days=1 ) 
Entry.objects.filter(created__range=(start_date, end_date)) 
```

我假设时区是一个类似日期时间的对象。

重要的是您要存储精确的时间，精确到毫秒，并将其与仅具有当天准确度的时间进行比较。django/python 不会折腾小时、分钟和秒，而是将它们默认为 0。因此，如果您的记录是在 2011-4-6T06:34:14am 创建的，那么它会比较 2011-4-6T:06:34:14am到 2011-4-6T00:00:00，而不是 2011-4-6（从创建日期开始）到 2011-4-6（从 timezone.now().date() 开始）。有帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T19:39:44.607

试试这个

```
from datetime import datetime
now=datetime.now()
YourModel.objects.filter(datetime_published=datetime(now.year, now.month, now.day)) 
```

# facebook-graph-api - 无法获得 FB 授权以正常工作

> ID：10048218
> 
> 赞同：0
> 
> 时间：2012-04-06T19:21:27.213
> 
> 标签：facebook-graph-api, oauth-2.0

[http://apps.facebook.com/karmabalance/](http://apps.facebook.com/karmabalance/)

我正在尝试在我的 FB 应用程序上进行登录和授权，但它似乎做了一些有趣的事情。基本上我想要的是当用户点击我的应用程序时，我希望 fb 进行检查以确保他们已登录并已批准该应用程序，然后我需要程序检查数据库以查看是否他们已经是数据库中具有用户 FB ID 的记录。如果他们没有记录，我希望程序将用户发送到创建帐户。允许用户输入用户名的页面。如果有记录，我想将用户发送到应用主页。

我以为我让它工作了，但它仍然不正确，我不知道为什么。这是我的代码。我相信还有更好的方法可以做到这一点，我是新手，所以我正在努力解决这一切。任何帮助，将不胜感激。

谢谢

当用户点击我的应用程序时，它会转到这个 index.php 页面。

```
<?php 
require 'config.php';

session_start();

$usercheck = $user_profile['id'];

$result = mysql_query("SELECT FBID FROM PLAYER WHERE (FBID = '$usercheck') ");

if ($facebook->getUser()) 
{ 

    if(mysql_num_rows($result))
    {
        header('location: Home.php');
    } else 
    { ?>
         <p>Please choose a Username for yourself. </p>
            <form action='includes/signup.php' method='post'>
            <fieldset style="width:600px";>
            <label>Username</label>
            <input name='username' type='text' value='<? if ($facebook->getUser()) 
                    {echo'Choose a Username';} ?>' />

            <input name='submit' type='submit' value='submit' />
            </fieldset>
            </form>
     <? }
} else 
  { ?>
   <p>Sign up with Facebook <fb:login-button perms='email'> Connect</fb:login-button>

It only takes a few seconds</p>

<div id='fb-root'></div>

      <script src='http://connect.facebook.net/en_US/all.js'></script>

      <script>

         FB.init({ 

            appId:'334230339967350', cookie:true, 

            status:true, xfbml:true 

         });

         FB.Event.subscribe('auth.login', function(response) {

        window.location.reload(); //will reload your page you are on

      });

      </script>
  <? }

?> 
```

配置文件：

```
<?php 
//Facebook Configuration
require 'facebook-php-sdk/src/facebook.php';

$app_id = "xxxxxxxxxxxx";
$app_secret = "xxxxxxx";
$facebook = new Facebook(array(
        'appId' => $app_id,
        'secret' => $app_secret,
        'cookie' => true
));

// Get User ID
$user = $facebook->getUser();

if ($user) {
  try {
    // Proceed knowing you have a logged in user who's authenticated.
    $user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}

// login or logout url will be needed depending on current user state.
if ($user) {
  $logoutUrl = $facebook->getLogoutUrl();
} else {
  $loginUrl = $facebook->getLoginUrl();
}

//SQL Configuration

 // i start most if not all pages with this depending on what Im using it for.

    $host = 'localhost'; // host name OR IP

    $username = 'security';//username

    $pass = 'blockedout'; //password

    $dbname    = 'Security'; // Database Name

    $conn = mysql_connect($host, $username, $pass) or die(mysql_error());

    if ($conn)

    {

        mysql_select_db($dbname) or die(mysql_error());

    }

    else

    {

       echo 'Connection failed.';

    } // The above code connects to your database or errors if it cannot connect.

// Again this is simple, security is your own priority.

//GLOBAL VALUES??

$usercheck = $user_profile['id'];

$usernamequery = mysql_query("SELECT UserName FROM PLAYER WHERE (FBID = '$usercheck') ");
$username = mysql_fetch_array($usernamequery);

$levelquery = mysql_query("SELECT LevelID FROM PLAYER WHERE (FBID = '$usercheck') ");
$level = mysql_fetch_array($levelquery);

$result = mysql_query("SELECT FBID FROM PLAYER WHERE (FBID = '$usercheck') ");

?> 
```

这是signup.php页面

```
<?

require_once '../config.php';

//here you could add checks for any empty fields using (!($_POST['first_name']))

$first_name = $user_profile['first_name']; // this line will collect our information from the

// field in our form that has the facebook first_name in it.

$last_name = $user_profile['last_name']; // same as above

$email = $user_profile['email']; //same as above

$id = $user_profile['id']; //same as above

$username1 = $_POST['username'];

$query = mysql_query
        ("
        INSERT INTO PLAYER (FirstName, LastName, EMail, FBID, UserName, Status, LevelID, Cash, LifePoints, RespectPoints, ReputationPoints, UpgradePoints, HealthPercent) 
        VALUES ('$first_name', '$last_name', '$email', '$id', '$username1', '1', '1', '25000', '3', '3', '3', '20', '100')
        ") 
        or die(mysql_error());

// The query will insert our fields in to the database as the above line shows, make 

//sure your database table headers are exactly correct otherwise this will not work

// You can now either send an email or if you wanted header to a new page. This is 

//up to you. Tutorials on google will show you how to do this part

if($query){

header('location: ../Home.php');

}else {

echo 'error adding to database';    

}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:32:17.367

您缺少用户的 oauth 令牌。那就是您要拉动的用户的句柄。如果您仍然感到困惑，请告诉我。

# java - 字符串在两个活动之间传递失败

> ID：10048220
> 
> 赞同：0
> 
> 时间：2012-04-06T19:21:45.047
> 
> 标签：java, android, string, http

我在两个活动之间传递了两个字符串，出于某种奇怪的原因，字符串没有被传递。我已经完成了所有正确的协议，但似乎没有任何效果，尽管对代码进行了几个小时的修改，我确信这是一个简单的解决方案，但我不知道，这是怎么回事。

第一类：

```
public class LogIn extends Activity implements OnClickListener {

    Button ok, back, exit;
    TextView result;
    EditText pword;
    String password;
    EditText uname;
    String username;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // Login button clicked
        ok = (Button) findViewById(R.id.btn_login);
        ok.setOnClickListener(this);

        result = (TextView) findViewById(R.id.lbl_result);

    } 
    //create bracket.

    public void postLoginData() {
        uname = (EditText) findViewById(R.id.txt_username);
        uname.getText().toString();

        pword = (EditText) findViewById(R.id.txt_password);
        pword.getText().toString();
        Bundle basket = new Bundle();
        basket.putString("keypass", password);
        basket.putString("keyuname", username);
        Intent a = new Intent(LogIn.this, ChatService.class );
        a.putExtras(basket);
        startActivity(a);

        // Create a new HttpClient and Post Header
        HttpClient httpclient = new DefaultHttpClient();

        /* login.php returns true if username and password is equal to saranga */
        HttpPost httppost = new HttpPost("http://gta5news.com/login.php");

        try {
            // Add user name and password

            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
            nameValuePairs.add(new BasicNameValuePair("username", username));
            nameValuePairs.add(new BasicNameValuePair("password", password));
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

            // Execute HTTP Post Request
            Log.w("HttpPost(Login)", "Execute HTTP Post Request(Login 1)");
            HttpResponse response = httpclient.execute(httppost);

            String str = inputStreamToString(response.getEntity().getContent())
                    .toString();
            Log.w("HttpPost", str);

            if (str.toString().equalsIgnoreCase("true")) {
                Log.w("HttpPost(Login2)", "TRUE");
                result.setText("Login successful");
                Intent login = new Intent(LogIn.this, ChatService.class);
                startActivity(login);

            }else {
                Log.w("HttpPost(Login(3)", "FALSE");
                result.setText(str);
            }

        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private StringBuilder inputStreamToString(InputStream is) {
        String line = "";
        StringBuilder total = new StringBuilder();
        // Wrap a BufferedReader around the InputStream
        BufferedReader rd = new BufferedReader(new InputStreamReader(is));
        // Read response until the end
        try {
            while ((line = rd.readLine()) != null) {
                total.append(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
        // Return full string
        return total;
    }

    public void onClick(View view) {
        if (view == ok) {

            postLoginData();
            InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
            imm.hideSoftInputFromWindow(pword.getWindowToken(), 0);
        }
        // Click end
    }
    // if statement
}

// class ends here 
```

第二类：

```
public class ChatService extends ListActivity {
    /** Called when the activity is first created. */

    BufferedReader in = null;
    String data = null;
    List headlines;
    List links;
    String GotPass;
    String GotUname;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        //get strings
        Bundle gotData = getIntent().getExtras();
        if(gotData !=null) {
        GotPass = gotData.getString("keypass");
        GotUname = gotData.getString("keyuname");

        try {
            //listview method
            ContactsandIm();
        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (URISyntaxException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        try {
            CheckLogin();
        } catch (UnsupportedEncodingException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
    }

    private void CheckLogin() throws UnsupportedEncodingException {
// posts login data from "LogIn" class
        // Create a new HttpClient and Post Header
                HttpClient httpclient = new DefaultHttpClient();

                /* login.php returns true if username and password is equal to saranga */
                HttpPost httppost = new HttpPost("http://gta5news.com/login.php");

                try {
                    // Add user name and password

                    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
                    nameValuePairs.add(new BasicNameValuePair("username", GotUname));
                    nameValuePairs.add(new BasicNameValuePair("password", GotPass));
                    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

                    // Execute HTTP Post Request
                    Log.w("HttpPost(Login)", "Execute HTTP Post Request(ChatService 1)");
                    HttpResponse response = httpclient.execute(httppost);

                    String str = inputStreamToString(response.getEntity().getContent())
                            .toString();
                    Log.w("HttpPost", str);

                    if (str.toString().equalsIgnoreCase("true")) {
                        Log.w("HttpPost(ChatService 2)", "TRUE");
                        // make toast if str.equals("True")
                        Toast.makeText(getApplicationContext(), "Yayayaya, loged in", Toast.LENGTH_LONG );

                    }else {
                        Log.w("HttpPost(ChatService 3", "FALSE");
                        Toast.makeText(getApplicationContext(), "failed", Toast.LENGTH_LONG);
                    }

                } catch (ClientProtocolException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }

            private StringBuilder inputStreamToString(InputStream is) {
                String line = "";
                StringBuilder total = new StringBuilder();
                // Wrap a BufferedReader around the InputStream
                BufferedReader rd = new BufferedReader(new InputStreamReader(is));
                // Read response until the end
                try {
                    while ((line = rd.readLine()) != null) {
                        total.append(line);
                    }
                } catch (IOException e) {
                    e.printStackTrace();
                }
                // Return full string
                return total;
            }

    public void ContactsandIm() throws URISyntaxException,
            ClientProtocolException, IOException {
        headlines = new ArrayList();

        // TODO Auto-generated method stub
        BufferedReader in = null;
        String data = null;

        HttpClient get = new DefaultHttpClient();
        URI website = new URI("http://www.gta5news.com/test.php");
        HttpGet webget = new HttpGet();
        webget.setURI(website);
        HttpResponse response = get.execute(webget);
        Log.w("HttpPost", "Execute HTTP Post Request");
        in = new BufferedReader(new InputStreamReader(response.getEntity()
                .getContent()));
        StringBuffer sb = new StringBuffer("");
        String l ="";
        String nl ="";
        while ((l =in.readLine()) !=null) {
            sb.append(l + nl);  
        }
        in.close();
         data = sb.toString();
         if(data.contains("null"));
         ListView lv = getListView();
         lv.setTextFilterEnabled(true);

        headlines.add(data);

        ArrayAdapter adapter = new ArrayAdapter(this,
                android.R.layout.simple_list_item_1, headlines);

        setListAdapter(adapter);

    }

    // end bracket for "ContactsandIm"

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:36:17.620

试试这个方法。

```
 Intent a = new Intent(context, MyActivity.class);
    a.putExtra("String1", "Hello World");
    context.startActivity(a); 
```

和

```
 Bundle extras = getIntent().getExtras();
    String s1 = extras.getString("String1"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:49:30.887

您应该在 Mainfest.xml 文件中添加两个活动

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T19:54:24.797

检查您是否在清单文件中注册了您的活动。

# jquery-ui - jQuery UI 选项卡上的多个 HTML 元素

> ID：10048221
> 
> 赞同：2
> 
> 时间：2012-04-06T19:21:54.933
> 
> 标签：jquery-ui, jquery-ui-tabs

我正在使用 jQueryUI 选项卡，并且需要向每个选项卡添加 UI 元素，以允许用户编辑有关选项卡的信息或删除选项卡。

我在给定选项卡上使用的标记`<li>`如下所示：

```
<li>
    <div style="background-color:Red;"> <-- Red to see what's happening -->
        <a href="#tabs-1"><span>Tab One</span></a>
        <div style="text-align:right; margin-right:3px;">
            <div><span id="editTab-1">edit</span></div>
            <div><span id="delTab-1">X</span></div>
        </div>            
    </div>
</li> 
```

这就像我在 IE 中所希望的那样呈现

```
 ______________________________
|                          Edit|
|      Tab One                 |
|___________________________X__| 
```

但它不能在 Chrome 或 FireFox 中正确呈现（该选项卡的宽度仅足以容纳“Tab One”文本，而“Edit”/“X”大多位于选项卡“下方”（显然较低的 Z-Index）。

实现我的目标的兼容方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T20:42:01.773

我认为，问题源于选项卡`<li>`和`<a>`内部是浮动元素，正如 jQueryUI CSS 中所设计的那样。

技术部分最好用这句话来概括（来自[http://css.maxdesign.com.au/floatutorial/introduction.htm](http://css.maxdesign.com.au/floatutorial/introduction.htm)）

> 如果未设置宽度，则结果可能无法预测。从理论上讲，具有未定义宽度的浮动元素应该收缩到其中最宽的元素。这可能是一个词、一个句子甚至一个字符——结果可能因浏览器而异。

所以红色`<div>`正在缩小到最宽的元素 - `<a>`. IE 和 Firefox/Chrome 只是行为不同，只是它们对规范的解释。老实说，事实上 Firefox 和 Chrome 是相似的，而 IE 长期以来一直存在[浮动错误](http://www.positioniseverything.net/explorer/floatIndent.html)，我在这里支持 Mozilla/Google，尽管可以理解 IE 在这种情况下似乎表现得更好。

您可以通过简单地在 red 上设置宽度来解决问题`<div>`。然而，标记也可能更清晰一些，例如：

```
<li style="background-color:red;width:150px">
    <a href="#tabs-1">Tab One</a>
    <div id="editTab-1" style="text-align:right;margin-right:3px">edit
        <p id="delTab-1">X</p>
    </div>
</li> 
```

给出相同的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T21:42:12.390

我不确定这是否是你想要的，因为我没有在 IE 中测试过，但这适用于 Chrome 和 FF：

```
<div id="tabs">
    <ul style="cursor:pointer">    
        <li>
            <a href="#tabs-1">
                <div style="float: left; margin-right: 20px;">Tab One</div>
                <div style="float: right; text-align:right;">
                    <div id="editTab-1">edit</div>
                    <div id="delTab-1">X</div>
                </div>  
            </a>
        </li>   
        <li>
            <a href="#tabs-2">
                <div style="float: left; margin-right: 20px;">Tab Two</div>
                <div style="float: right; text-align:right;">
                    <div id="editTab-2">edit</div>
                    <div id="delTab-2">X</div>
                </div>  
            </a>
        </li>   
    </ul>        

    <div id="tabs-1" class="tabPane">Tab One Content</div>  
    <div id="tabs-2" class="tabPane">Tab Two Content</div>    
</div> 
```

***[查看工作中的 jsFiddle](http://jsfiddle.net/WYXAB/1/)***

* * *

如果要动态处理点击，可以使用：

```
var $tabs = $("#tabs").tabs();

$tabs.find("a div[id]").on("click", function() {

    var id = $(this).attr("id"),
        idTab = parseInt(id.substring(id.length - 1)),            
        isEdit = id.indexOf("edit") > -1,
        isDelete = id.indexOf("del") > -1,        
        index = $tabs.tabs('option', 'selected');

    if (index + 1 === idTab) {
        if (isEdit) { 
            console.log("Edit Tab " + (index+1)); 
            //however you want to edit here
        }

        if (isDelete) { 
            console.log("Delete Tab " + (index+1)); 
            $tabs.tabs("remove", index);
        }
    }

}).css("cursor", "pointer");​ 
```

***[查看工作中的 jsFiddle](http://jsfiddle.net/WYXAB/3/)***

# c++ - 准备和执行 QSqlQuery 会改变执行它的方法的逻辑常量吗？

> ID：10048223
> 
> 赞同：3
> 
> 时间：2012-04-06T19:21:55.163
> 
> 标签：c++, constants

我有一个指向 QSqlQuery 的 QScopedPointer，它是一个类的成员变量。

我想在一个 const 方法中初始化、准备和执​​行 QSqlQuery。该方法的 constness 不会让我这样做。有 2 个选项。从方法中删除 const 或将关键字 mutable 添加到成员变量。哪个更好？为什么？

我读到只有当方法/对象的“逻辑常量”不受修改变量的影响时，我才应该使用 mutable。什么是逻辑常数，在我的情况下会被修改吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T12:16:14.523

这真的取决于你班上的其他人。通过在 QSqlQuery 上准备查询，您正在更改其中一个数据成员的状态。因此，该方法不是纯粹的“const”。

你的决定应该是你的类的其余部分如何与 QSqlQuery 成员交互。如果查询的状态与您的对象的状态无关，也就是说，您的其他方法都不会关心 QSqlQuery 数据成员中准备好的查询是否已更改，那么使成员可变是一个不错的选择。如果更改准备好的查询在其他地方有影响，则该方法不应该是 const。

# jdo - DataNucleus JDO 中的每个数据存储继承策略？

> ID：10048226
> 
> 赞同：0
> 
> 时间：2012-04-06T19:22:24.640
> 
> 标签：jdo, datanucleus

我与两个数据存储接口，其中一个是 RDMS，另一个是 LDAP。我想要做的是使用 RDBMS 中的“超类表”和 LDAP 中的“完整表”来保持层次结构。

这样的事情可能吗？也就是说，您可以为 *.orm 文件中的每个数据存储分别指定多个继承策略，还是我被迫使用单一继承策略？

我在 DataNucleus 的文档中找不到此信息，我唯一确定的是您可以将继承元素放在 .orm 文件而不是 .jdo 文件中，但这仍然不能回答我的问题......

层次结构相当简单，由一个抽象类和几个子类组成，如下所示：

```
abstract class Foo implements IFoo
{
  ...
}
class Foo1 extends Foo
{
   ...
}
class Foo2 extends Foo
{
   ...
}
... 
```

我试图在两个 *.orm 文件和 .jdo 文件中配置继承（记住它会被前者覆盖）但我得到一个异常

```
Caused by: org.datanucleus.metadata.InvalidMetaDataException: Class "...Foo1..." has been specified with an inheritance strategy of "superclass-table", yet no superclass exists or none exists with its own table!
at org.datanucleus.metadata.AbstractClassMetaData.validateUserInputForInheritanceMetaData(AbstractClassMetaData.java:903)
at org.datanucleus.metadata.ClassMetaData.populate(ClassMetaData.java:214)
at org.datanucleus.metadata.MetaDataManager$1.run(MetaDataManager.java:2393)
at java.security.AccessController.doPrivileged(Native Method)
at org.datanucleus.metadata.MetaDataManager.populateAbstractClassMetaData(MetaDataManager.java:2387)
at org.datanucleus.metadata.MetaDataManager.populateFileMetaData(MetaDataManager.java:2224)
at org.datanucleus.jdo.metadata.JDOMetaDataManager.loadMetaDataForClass(JDOMetaDataManager.java:741)
at org.datanucleus.jdo.metadata.JDOMetaDataManager.getMetaDataForClassInternal(JDOMetaDataManager.java:353)
at org.datanucleus.jdo.metadata.JDOMetaDataManager$MetaDataRegisterClassListener.registerClass(JDOMetaDataManager.java:184)
at javax.jdo.spi.JDOImplHelper.registerClass(JDOImplHelper.java:376) 
```

然后我尝试从 .jdo 中删除继承元素，但增强器失败并显示以下消息：

```
Class "...Foo1..." has been specified to use an inheritance strategy of "superclass-table", persisting to the table of class ...Foo..., however this class doesnt have a discriminator specified. 
```

各个配置是正确的（对于第一种情况，新表在基类中具有鉴别器，在子类中具有超类表，在第二种情况下仅在基类中具有完整表）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T07:05:12.913

您可以将该信息放在 orm 文件中，是的，这确实回答了您的问题，因为您有一个用于 RDBMS 的 ORM 文件和一个用于 LDAP 的 ORM 文件。所以 package-rdbms.orm 和 package-ldap.orm，然后简单地将持久性属性“javax.jdo.option.Mapping”设置为“rdbms”或“ldap”。简单的

# heroku - heroku 上有哪些熵源？

> ID：10048228
> 
> 赞同：7
> 
> 时间：2012-04-06T19:22:28.650
> 
> 标签：heroku, cryptography, entropy

我想将一个应用程序部署到需要能够生成加密安全随机数的 heroku。我可以使用哪些熵源？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-05T06:08:04.503

您的 Heroku dyno 基本上是一个 Ubuntu 服务器虚拟机，因此您应该可以访问`/dev/random`并`/dev/urandom`像在任何其他基于 Linux 的操作系统上一样访问。

如果您使用的是 Ruby/Rails，那么您可能应该为此使用`SecureRandom`（或`ActiveSupport::SecureRandom`旧版本的 Ruby 和 Rails）。

# sharepoint - SharePoint 2010 母版页上的链接未根据备用访问映射更改

> ID：10048231
> 
> 赞同：1
> 
> 时间：2012-04-06T19:22:33.043
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-designer, sharepoint-api, sharepoint-branding

我们正在 SharePoint 2010 中创建一个自定义品牌母版页。为了使该页面类似于旧版页面，我们实现了一个基于 html 的自定义下拉导航菜单，我们直接在母版页上（由基本的 HTML 元素 UL 和 LI 组成一个带有 CSS 类样式的标签）。

我认为来自页面上基本 HTML 的链接将受制于当前的备用访问映射，但似乎并非如此。[在以 3 个不同 URL（ http://sharepoint2010](http://sharepoint2010)、[http://sharepoint2010.mydomain.com](http://sharepoint2010.mydomain.com)、[https://sharepoint2010.mydomain.com](https://sharepoint2010.mydomain.com) ）打开的测试页面上，来自 WIKI 页面的链接已按预期进行了修改，但是自定义导航菜单中的链接（母版页上的纯 HTML）不会被修改。

我可以看到这在哪里有用......但是有没有一种方法可以让我在 MasterPage 上添加链接，让 SharePoint 首先解析它们，使它们受到备用访问映射转换的影响？我尝试在 SPLinkBut​​ton 控件中放置一个链接，但它没有达到预期的行为。

例如

```
<ul id="navmenu">
  <li><SharePoint:SPLinkButton runat="server" NavigateUrl="http://sharepoint2010">sharepoint link</SharePoint:SPLinkButton></li>
  <li><a href="http://sharepoint2010">sharepoint2010</a></li>
  <li>test</li>
</ul> 
```

当我通过[https://sharepoint2010.mydomain.com](https://sharepoint2010.mydomain.com)访问该页面时，上面的链接仍然是[http://sharepoint2010](http://sharepoint2010)而不是[https://sharepoint2010.mydomain.com](https://sharepoint2010.mydomain.com)

有什么想法吗？

谢谢，

胜利者

编辑（澄清）：我打算使用相对链接作为后备。但就我们所做的而言，如果我们可以保留完整链接并使用 AAM，它将更易于维护。我知道标准的相对链接是可能的。我希望通过提供特定的链接语法或控制框架来确定是否有办法在母版页内容（甚至是从外部服务检索的内容）上使用 AAM。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T19:49:17.627

There is no need to re-insert the host name if your links are on the same domain and you're not using managed paths. Keeping your links relative will ensure that any bindings in IIS and AAM setup in SharePoint will work without any additional work.

Otherwise, I would heavily suggest to use the available ~sitecollection and ~site SPUrl token to retrieve the current site collection url or current web url. You need to wrap it in anything running server side as the expression will be handled ... server side.

eg:

```
<asp:Literal runat="server" Text="<% $SPUrl:~site/press-releases/ %>"/> 
```

Hope it helped

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T17:24:34.677

如果它只是您想要的相对链接，则完全省略 dns 条目（即您正在使用 AAM 切换的 url 的位）并以正斜杠开始 url 以使其相对。如果这不能满足您的需求，Sharepoint 的做法是使用相对 url 令牌。查看 v4.master 中的 tilda 字符，后跟“site”或“sitecollection”，分别表示当前的网站和网站集。复制这个方法。有关更多详细信息，请查看此链接：http: [//msdn.microsoft.com/en-us/library/ms473643.aspx](http://msdn.microsoft.com/en-us/library/ms473643.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-07T16:52:05.583

当您使用 SPLinkBut​​ton 的 NavigateUrl= 属性时，SharePoint 会呈现一个带有 href= 的简单锚点，而不是常规的 PostBack JavaScript 代码。备用访问映射在这里不起作用。

# android - 任何都是为了更容易定位按钮

> ID：10048232
> 
> 赞同：0
> 
> 时间：2012-04-06T19:22:41.613
> 
> 标签：android, xml, button, placement

我正在尝试将按钮放在我可以做的 xml 页面上，但不是在我想要的地方。当我打开按钮然后尝试更改边距时，它会获得按钮，但是当我尝试使它们更大或更小时，它会再次移动它们。如果有一种方法可以让我将按钮拖放到我想要的位置，我正在徘徊。如果我没有很好地解释它，我很抱歉。我真的想不出如何很好地解释它。

谢谢，斯科特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:25:30.360

在创建几乎任何应用程序时，使用相对布局是首选方法。位置是“相对的”，因此您无需定义实际测量值。尝试先玩弄它。

[http://developer.android.com/resources/tutorials/views/hello-relativelayout.html](http://developer.android.com/resources/tutorials/views/hello-relativelayout.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:46:13.377

您可以使用[droiddraw](http://www.droiddraw.org/)拖动按钮或其他小部件来绘制 UI

# mysql - mysql 从多个表中选择别名

> ID：10048233
> 
> 赞同：1
> 
> 时间：2012-04-06T19:22:41.893
> 
> 标签：mysql, sql

我有这 2 个查询，我想将它们组合成一个大查询：

```
SELECT COUNT(*) AS ac, SUM(Views) AS vc FROM tableA 
```

和

```
SELECT COUNT(*) AS mc FROM tableB 
```

找不到有关该主题的任何内容，甚至可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T19:30:34.967

您可以使用三个子查询进行操作：

```
SELECT 
(SELECT COUNT(*) FROM tableA) AS ac,
(SELECT SUM(Views) FROM tableA) AS vc,
(SELECT COUNT(*) FROM tableB) AS mc 
```

*这不是很优雅的解决方案，但应该做你需要的。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:30:32.930

```
SELECT 'tableA' as tablename, COUNT(*) AS count, SUM(Views) AS sum FROM tableA
UNION
SELECT 'tableB' as tablename, COUNT(*) AS count, 0 AS sum FROM tableB 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T19:32:13.187

您可以创建一个返回`SELECT COUNT(*) AS mc FROM tableB`并在表 A 中使用它的函数

```
 CREATE FUNCTION Func1() RETURNS INTEGER
  BEGIN
     DECLARE Temp INTEGER;
     SELECT COUNT(*) INTO Temp FROM tableB;
     RETURN IFNULL(Temp, 0);
  END;

  SELECT COUNT(*) AS ac, SUM(Views) AS vc, Func1() as mc FROM tableA 
```

# dojo - 使用 JsonRestStore 和 ClientFilter 对 Dojo 增强网格进行列排序

> ID：10048234
> 
> 赞同：1
> 
> 时间：2012-04-06T19:22:48.837
> 
> 标签：dojo, grid

我已经定义了一个使用 JsonRestStore 和 ClientFilter 的 Dojo 增强网格。其中一列中的数据具有带有数字值的字符串数据，例如“5201”。我编写了一个格式化程序，通过 parseInt(value) 将字符串字段更改为一个数字，但是当我单击该列进行排序时，这些值没有正确排序，因为似乎排序是基于存储数据而不是格式化的数据。它看起来像是进行排序的 ClientFilter 的 makeComparator 方法。有没有办法为 ClientFilter 定义一个排序比较器？看起来我需要将数据格式化为 ClientFilter 比较器中的数字，而不是网格单元格式化程序。

# php - 跨多个表的更高效的数据库结构

> ID：10048237
> 
> 赞同：4
> 
> 时间：2012-04-06T19:23:06.373
> 
> 标签：php, mysql, database, database-design

我正在建立一个包含多个表的 MySQL 数据库。有几个表的字段名称相似，但目的不一定相同。

例如，有一个`users`表会有一个`name`字段，一个`category`表有一个`name`字段等等。

我之前已经看到这个设置有或没有字段名称的前言，所以在上面的例子中使用`user_name`，`cat_name`等等。

由于这些都在单独的表中，无论有没有这个前言来构建数据库有什么好处吗？我知道当使用连接并通过 PHP 调用数据时，您必须添加一个`SELECT users.name AS username...`以防止字段在使用时相互覆盖`mysql_fetch_array`。但我不确定使用一种方法是否比另一种方法更有效率？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:27:28.473

这取决于您的商店做什么或您的偏好。没有什么前缀可以使这变得更好。就我个人而言，我只是将其保留为名称：`Users.Name`并且所有`Orders.Name`都`Products.Name`包含具有不同对象类型的元组。

归根结底，您希望保持一致。如果您更喜欢 a`cat_`和`user_`前缀，请与您的设计保持一致，并为所有对象类型包含此前缀。对我来说少即是多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:30:04.850

一个缺点是如果有人愚蠢到使用自然连接（你可以猜到我发现这是一种不好的做法，但 mysql 确实允许这样做，所以你需要考虑是否会发生这种情况）你可能最终会加入那些具有相同名称的字段意外地。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T19:27:31.363

这实际上只是一个偏好问题。我个人更喜欢使用 just 的方法`name`。

但是需要注意的一件事是，如果您正在执行任何`SELECT * FROM ...`查询（您不应该这样做；始终明确选择字段），您最终可能会选择错误的数据。

# c# - 使用母版页在网站目录结构中查找每个页面的相对位置？

> ID：10048239
> 
> 赞同：0
> 
> 时间：2012-04-06T19:23:09.923
> 
> 标签：c#, asp.net, .net

我是一个菜鸟 Web 开发人员，在 C#、VS2005 中创建一个站点并使用 .master 文件。

我想让站点中的每个页面都知道它在目录结构中的当前位置，这样我就可以在每个页面上显示适当的导航链接。

我在 .master 文件中编写了以下代码来查找相对于当前页面的目录结构。它在我位于 localhost/mysite 的测试服务器上运行良好，但是当我推送到位于 www.example.coom 的公共站点时，代码会中断。

我发现问题出在“int depth = h-2”行上。如果我将其更改为 h-1，它可以在 mysite.org 上运行。但这是一个丑陋的解决方案。

```
int nUrlSegments = this.Page.Request.Url.Segments.GetLength(0);

string[] thisPageArray = new string[nUrlSegments];

for (int i = 0; i < nUrlSegments; i++)
    thisPageArray[i] = Page.Request.Url.Segments[i].ToString();

int h = 0;
while (!thisPageArray[h].Contains(".aspx"))
    h++;

int depth = h - 2;

string pathToTop = "";

for (int j = 1; j <= depth; j++)
    pathToTop = pathToTop + "../";

string currentpage = thisPageArray[nUrlSegments-1].ToString();
string currentdir = "";

if (nUrlSegments > 1)
    currentdir = thisPageArray[nUrlSegments - 2].ToString(); 
```

找到每个页面在目录结构中的位置的更好方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T20:10:51.283

我的一个非互联网世界的朋友帮我回答了这个问题。作为记录，这是我使用他的建议提出的解决方案：

```
string[] urlArray = Page.AppRelativeVirtualPath.Split('/');

int depth = urlArray.Length-2;

string pathToTop = "";

for (int j = 1; j <= depth; j++) pathToTop = pathToTop + "../";

string currentpage = urlArray[depth+1];   

string currentdir = "";
string backdir = "";
string twobackdir = "";

currentdir = urlArray[depth];
if (depth > 1) backdir = urlArray[depth-1];
if (depth > 2) twobackdir = urlArray[depth - 2]; 
```

# sql - SQL SELECT 语句最大 id

> ID：10048240
> 
> 赞同：0
> 
> 时间：2012-04-06T19:23:22.887
> 
> 标签：sql

我有一个名为 apps 的表，其中包含 id、type 和 group_id。该表有多个具有相同编号的 group_id。我需要获取类型等于 1 的每个 group_id 编号的最大 id。

我的sql技能不是很好。任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T19:25:18.987

```
select group_id, max(id) as max_id
from apps
where type = 1
group by group_id 
```

# jquery - 禁用jQuery中的普通滚轮功能？

> ID：10048243
> 
> 赞同：3
> 
> 时间：2012-04-06T19:23:36.383
> 
> 标签：jquery

使用鼠标滚轮插件，我有：

```
$('html, body').bind("mousewheel", function(objEvent, intDelta){
if (intDelta > 0 && $currentPage != 1){
    $currentPage--;
    $('html, body').animate({scrollTop:$("#page"+$currentPage).offset().top}, 2000);
}
else if (intDelta < 0 && $currentPage != 4){
    $currentPage++;
    $('html, body').animate({scrollTop:$("#page"+$currentPage).offset().top}, 2000);
}
}); 
```

效果很好，但是每当我滚动时，它会在执行动画之前先向上或向下滚动页面。有什么办法可以禁用它吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T19:25:27.947

只需添加一个

```
return false; 
```

在最后一个大括号之前。

```
$('html, body').bind("mousewheel", function(objEvent, intDelta){
if (intDelta > 0 && $currentPage != 1){
    $currentPage--;
    $('html, body').animate({scrollTop:$("#page"+$currentPage).offset().top}, 2000);
}
else if (intDelta < 0 && $currentPage != 4){
    $currentPage++;
    $('html, body').animate({scrollTop:$("#page"+$currentPage).offset().top}, 2000);
}
return false;
}); 
```

顺便说一句，您应该使用 .on() 而不是 .bind()

# python - 如何使用 Python 的 datetime 模块确定当前时间是否在指定范围内？

> ID：10048249
> 
> 赞同：63
> 
> 时间：2012-04-06T19:24:21.827
> 
> 标签：python, python-datetime

`10:30 AM`查看当前时间是否介于 say和之间的最佳方法是什么`4:30 PM`？

我可以想到以下内容，不确定如何正确：

```
from datetime import datetime
nw = datetime.now()
hrs = nw.hour;mins = nw.minute;secs = nw.second;
zero = timedelta(seconds = secs+mins*60+hrs*3600)
st = nw - zero # this take me to 0 hours. 
time1 = st + timedelta(seconds=10*3600+30*60) # this gives 10:30 AM
time2 = st + timedelta(seconds=16*3600+30*60)  # this gives 4:30 PM
if nw>= time1 or nw <= time2:
    print "yes, within the interval" 
```

请让我知道这是否是正确的方法，可以写更好的东西吗？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-04-06T19:28:23.897

我最初的答案非常具体地集中在提出的问题上，并且不适应跨越午夜的时间范围。由于 6 年后这仍然是公认的答案，因此我在下面合并了@rouble 的答案，以支持午夜。

```
from datetime import datetime, time

def is_time_between(begin_time, end_time, check_time=None):
    # If check time is not given, default to current UTC time
    check_time = check_time or datetime.utcnow().time()
    if begin_time < end_time:
        return check_time >= begin_time and check_time <= end_time
    else: # crosses midnight
        return check_time >= begin_time or check_time <= end_time

# Original test case from OP
is_time_between(time(10,30), time(16,30))

# Test case when range crosses midnight
is_time_between(time(22,0), time(4,00)) 
```

我仍然坚持我在下面的原始评论，即这种逻辑的大多数应用程序可能更适合`datetime`那些跨越午夜被反映为日期变化的对象。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2016-08-08T19:16:57.097

上述接受的解决方案不适用于通宵时间，这是：

```
import datetime as dt  
def isNowInTimePeriod(startTime, endTime, nowTime): 
    if startTime < endTime: 
        return nowTime >= startTime and nowTime <= endTime 
    else: 
        #Over midnight: 
        return nowTime >= startTime or nowTime <= endTime 

#normal example: 
isNowInTimePeriod(dt.time(13,45), dt.time(21,30), dt.datetime.now().time())

#over midnight example: 
isNowInTimePeriod(dt.time(20,30), dt.time(1,30), dt.datetime.now().time()) 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2017-01-24T09:33:14.967

这是@rouble回答的小例子：

```
from datetime import datetime

def isNowInTimePeriod(startTime, endTime, nowTime):
    if startTime < endTime:
        return nowTime >= startTime and nowTime <= endTime
    else: #Over midnight
        return nowTime >= startTime or nowTime <= endTime

timeStart = '3:00PM'
timeEnd = '11:00AM'
timeNow = '2:59AM'
timeEnd = datetime.strptime(timeEnd, "%I:%M%p")
timeStart = datetime.strptime(timeStart, "%I:%M%p")
timeNow = datetime.strptime(timeNow, "%I:%M%p")

print(isNowInTimePeriod(timeStart, timeEnd, timeNow)) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-12-06T15:02:27.633

我的 2 美分，它对我有用，而且很容易

```
while True:
    now = datetime.now()
    current_time = now.strftime("%H:%M:%S")
    start = '19:19:00'
    end = '19:19:20'
    if current_time > start and current_time < end:
        print('in')
        print(current_time)
        tempo.sleep(1)
    else:
        print('out')
        print(current_time) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-08T14:04:07.710

看看 py-time-between 包：[https ://pypi.org/project/py-time-between/](https://pypi.org/project/py-time-between/)

测试用例：

```
from datetime import time
from timebetween import is_time_between

def test_is_time_between():
    t, s, e = time(0), time(0), time(0)
    assert is_time_between(t, s, e)

    t, s, e = time(0, 0, 0, 1), time(0), time(0, 0, 0, 2)
    assert is_time_between(t, s, e)

    t, s, e = time(0, 0, 0, 1), time(0, 0, 0, 1), time(0, 0, 0, 2)
    assert is_time_between(t, s, e)

    t, s, e = time(0, 0, 0, 2), time(0, 0, 0, 1), time(0, 0, 0, 2)
    assert is_time_between(t, s, e)

    t, s, e = time(0, 0, 1), time(23, 59, 59), time(0, 0, 2)
    assert is_time_between(t, s, e)

    t, s, e = time(12, 0, 0), time(23, 59, 59), time(0, 0, 0)
    assert is_time_between(t, s, e)

    t, s, e = time(23, 59, 57), time(23, 59, 59), time(23, 59, 57)
    assert is_time_between(t, s, e)

    t, s, e = time(23, 59, 58), time(23, 59, 59), time(23, 59, 57)
    assert not is_time_between(t, s, e)

    t, s, e = time(22), time(22), time(5, 59, 59)
    assert is_time_between(t, s, e) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-09-24T07:45:59.467

可以进一步简化：

```
def isNowInTimePeriod(startTime, endTime, nowTime):
    if startTime < endTime:
        return startTime <= nowTime <= endTime
    else: #Over midnight
        return nowTime >= startTime or nowTime <= endTime 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-17T19:02:03.187

我有一个类似的要求，我希望某个任务在每个工作日的上午 9 点到下午 3:30 之间运行。

```
def somefunction():
    cdate = datetime.datetime.strftime(datetime.datetime.now(), "%d-%m-%Y")
    if (0 <= time.localtime().tm_wday <= 4) and (datetime.datetime.strptime(cdate + " 09:00:00", "%d-%m-%Y %H:%M:%S") <= datetime.datetime.now() <= datetime.datetime.strptime(cdate + " 15:30:00", "%d-%m-%Y %H:%M:%S")):
         << do something >> 
```

### 解释：

`cdate`变量以字符串格式获取当前日期。

该条件检查当前工作日是否 >= 0（星期一）和 <= 4（星期五）。它还检查当前时间`datetime`格式是否 >= 今天的上午 9:00，以及当前时间是否 <= 今天的 15:30。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-06-23T03:31:29.017

可能比所选答案更接近 OP 要求的解决方案。它使用日期时间而不是时间作为要检查的对象。它还使用持续时间而不是时间来指定间隔的结束。

```
from datetime import datetime, time, timedelta

def is_date_within(begin_time, span_time, check_date=None):
    """                                                                                        
    Return True if given check_date is within the interval begining                            
    at begin_time with a duration of span_time.                                                

    Args:                                                                                      
       - begin_time: datetime.time object                                                      
       - span_time: datetime.timedelta object                                                  
       - check_date: datetime.datetime object.                                                 
           If None, default to current UTC date                                                
    """
    check_date = check_date or datetime.utcnow()
    if check_date.time() >= begin_time:
        begin_date = check_date.combine(check_date.date(), begin_time)
    else:
        begin_date = check_date.combine(check_date.date() - timedelta(days=1),
                                        begin_time)
    return begin_date <= check_date <= begin_date + span_time

test_date = datetime(2020, 6, 22, 11, 31)
assert(is_date_within(time(10,30), timedelta(hours=4), test_date) == True)
assert(is_date_within(time(10,30), timedelta(hours=1), test_date) == False)

# Span midnight                                                                                
assert(is_date_within(time(23,30), timedelta(hours=13), test_date) == True)
assert(is_date_within(time(23,30), timedelta(hours=1), test_date) == False) 
```

# asp.net-mvc-3 - 跨 2 个服务层共享方法

> ID：10048253
> 
> 赞同：3
> 
> 时间：2012-04-06T19:24:32.377
> 
> 标签：asp.net-mvc-3, entity-framework, service-layer

我正在使用 MVC3 和实体框架开发应用程序。我有两个具有一个相似性的实体的服务层。

这两个服务是 DurationService 和 FieldService。前者处理 Days 和 daysettings 列表。这些设置包含有关每天时间段的信息（开始时间、结束时间、可能的休息时间列表）。后一个服务处理字段列表和字段设置。这些字段设置用于确定字段可用性。

两个服务都需要检查休息时间是否重叠。我为 DurationService 编写了此代码，但现在注意到 FieldService 需要完全相同的方法。我不想违反 DRY 原则，所以我的问题是，我该如何最好地处理这个问题？

我是否制作了一个两个服务都可以调用的静态类？我是否使用某种继承（即使这种方法是他们将共享的唯一方法）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:57:34.643

看起来建筑正在阻止你做明显正确的事情。不要让这种情况发生。

继承可能不是正确的解决方案。一个静态助手类就可以了。简单的问题需要简单的解决方案。

# c++ - 提升 shared_ptr 运算符 =

> ID：10048256
> 
> 赞同：5
> 
> 时间：2012-04-06T19:24:38.363
> 
> 标签：c++, boost, shared-ptr

这是代码示例

```
class A{
  int i;
public:
  A(int i) : i(i) {}
  void f() { prn(i); }
};

int main()
{
  A* pi = new A(9);
  A* pi2= new A(87);
  boost::shared_ptr<A> spi(pi);
  boost::shared_ptr<A> spi2(pi2);
  spi=spi2;
  spi->f();
  spi2->f();
  pi->f();
  pi2->f();
} 
```

输出：

```
87
87
0
87 
```

问题是为什么输出中是 0？

文档注释：效果：等效于 shared_ptr(r).swap(*this)。

但是如果`shared_ptr`对象只是交换，结果应该是 9。如果第一个对象被删除，应该有 Segmentation fault。

那为什么是0？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T19:33:40.973

仔细注意正在交换的内容：

```
shared_ptr(r).swap(*this)
// ^^^^^^^^^^ 
```

那是一个*由*`r`. 临时对象立即超出范围并死亡，无论这对拥有的资源有什么影响。由于在您的代码`spi`中是 的唯一所有者`*spi`，因此该对象被删除，您随后的访问`pi->f()`只是未定义的行为。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-06T19:32:29.823

`pi`已被删除。访问已删除对象的成员是未定义的行为；您可能会得到 0、其他值或分段错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T19:33:03.223

> 那为什么是0？

所以什么都有！

分配一个新值`spi`将删除它指向的前一个对象。`pi`生成一个不能再使用的悬空指针。调用`pi->f()`是未定义的行为，可以有任何结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T19:33:05.837

`pi`对象在之后被删除`spi = spi2`，谁知道你的运行时为释放的内存做了什么。对我来说，它在 Debug 中打印 -572662307，在 Release 中打印 1315904。

# scala - 如何使用 Scala 的 MurmurHash 实现：scala.util.MurmurHash3？

> ID：10048257
> 
> 赞同：5
> 
> 时间：2012-04-06T19:24:40.703
> 
> 标签：scala, scala-2.9, murmurhash

我正在编写一个 BloomFilter 并想使用 Scala 的默认 MurmurHash3 实现：scala.util.MurmurHash3。我的编译失败，但是出现以下编译错误：

```
[error] /mnt/hgfs/dr/sandbox/dr-commons/src/main/scala/dr/commons/collection/BloomFilter.scala:214: MurmurHash3 is not a member of scala.util
[error]   import scala.util.{MurmurHash3 => MH} 
```

我正在使用 Scala 2.9.1 和 sbt 0.11.2。

MurmurHash3 类是不是默认不在 2.9.1 库中？我认为是因为它在图书馆中被大量使用。据我所知，该课程不是包私有的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T19:43:19.897

它被称为[scala.util.MurmurHash](http://www.scala-lang.org/api/current/index.html#scala.util.MurmurHash)没有 3。但它确实是 Murmurhash 3 算法（参见[源代码中的评论](https://lampsvn.epfl.ch/trac/scala/browser/scala/tags/R_2_9_1_final/src//library/scala/util/MurmurHash.scala#L1)）

**编辑**我刚刚看到 Rex Kerr 是 scala.util.MurmurHash 的作者。我建议你不要接受这个答案（假设它是正确的）；由于[Rex Kerr](https://stackoverflow.com/users/247533/rex-kerr)在 StackOverflow 上，他可能会插话并给你一个更好的...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-02-02T05:10:15.603

我正在使用 scala 2.11 和 spark apache 1.6.2 。它工作正常。使用这些版本，我没有收到任何错误

```
import scala.util.hashing.{ MurmurHash3 => MH3 }
    val data="I am SANTHOSH"
    val sample = MH3.stringHash(data, MH3.stringSeed)
    println(":Hash Value: "+sample) 
```

```
<dependency>
            <groupId>org.apache.spark</groupId>
            <artifactId>spark-core_2.11</artifactId>
            <version>1.6.2</version>
        </dependency>
        <dependency>
            <groupId>org.apache.spark</groupId>
            <artifactId>spark-sql_2.11</artifactId>
            <version>1.6.2</version>
        </dependency>
        <dependency>
            <groupId>org.apache.spark</groupId>
            <artifactId>spark-mllib_2.11</artifactId>
            <version>1.6.2</version>
        </dependency> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-18T17:27:50.607

以下对我有用：

`import scala.util.hashing.MurmurHash3`

# javascript - 必应地图的信息框

> ID：10048259
> 
> 赞同：4
> 
> 时间：2012-04-06T19:24:54.213
> 
> 标签：javascript, web-applications, bing-maps

我目前正在开发一个 bing 地图应用程序，当用户单击图钉时，我似乎无法显示信息框。我一直在关注SDK，它应该几乎完全一样。这是我所拥有的：

```
// ***********************************
// Function creates a single pin
// and returns a reference to the pin

function createMapPin(latLong, sName) {
    var pinImg = "imagespins/Good.png";

var pin = new Microsoft.Maps.Pushpin(latLong, {
    icon: pinImg,
    anchor: new Microsoft.Maps.Point(8, 8),
    draggable: true,
    width: 48,
    height: 48
});

pin.title = sName;

pinInfobox = new Microsoft.Maps.Infobox(pin.getLocation(),
            { title: 'My Pushpin',
                description: 'This pushpin is located at (0,0).',
                visible: false,
                offset: new Microsoft.Maps.Point(0, 15)
            });

// Add handlers for the pushpin events
   Microsoft.Maps.Events.addHandler(pin, 'click', displayInfobox);
// Hide the infobox when the map is moved.
Microsoft.Maps.Events.addHandler(map, 'viewchange', hideInfobox);

map.entities.push(pin);
map.entities.push(pinInfobox);

    return pin;
}

function displayInfobox(e) {
    pinInfobox.setOptions({ visible: true });
}

function hideInfobox(e) {
    pinInfobox.setOptions({ visible: false });
} 
```

引脚成功创建并添加到地图中，当用户单击引脚时，它确实进入了 dispayInfoBox 方法，但消息框似乎没有出现。

任何建议都非常感谢。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T01:29:31.843

您的代码有效，我已经尝试过了，只要您只调用`createMapPin()`一次。但是从您的代码来看，您的意图是`createMapPin()`多次调用，这将导致`infobox`停止像您想象的那样行为。原因是这一行：

```
pinInfobox = new Microsoft.Maps.Infobox(pin.getLocation(),
            { title: 'My Pushpin',
                description: 'This pushpin is located at (0,0).',
                visible: false,
                offset: new Microsoft.Maps.Point(0, 15)
            }); 
```

由于您没有`pinInfobox`通过关键字声明为局部变量`var`，因此它隐式声明为全局变量。我不认为这是你的意图，因为一旦你 `createMapPin()`再次调用`pinInfobox`，因为它是一个全局变量，就会被覆盖。所以实际上，即使你继续创建新的信息框，它也只有一个实例，它只是不断地获得分配的新值。因此，如果您单击图钉，则一个信息框可能会在屏幕外某处弹出，而您看不到它。我相信您的意图是让每个图钉关联一个信息框？为此，您需要将信息框声明为局部变量，如下所示：

```
var pinInfobox = new Microsoft.Maps.Infobox(pin.getLocation(),
        { title: 'My Pushpin',
            description: 'This pushpin is located at (0,0).',
            visible: false,
            offset: new Microsoft.Maps.Point(0, 15)
        }); 
```

您还需要修改事件处理程序以与信息框对象的本地版本进行交互，而不仅仅是单个全局变量。最简单的方法是将事件处理程序声明为函数范围内的匿名函数`createMapPin()`，并使用函数绑定覆盖 this 关键字的含义：

```
Microsoft.Maps.Events.addHandler(pin, 'click', function (e) {
    this.setOptions({ visible: true });
} .bind(pinInfobox));
Microsoft.Maps.Events.addHandler(map, 'viewchange', function(e) {
    this.setOptions({ visible: false });
}.bind(pinInfobox)); 
```

所以这是您更新的代码：

```
function createMapPin(latLong, sName) {
    var pinImg = "imagespins/Good.png";

    var pin = new Microsoft.Maps.Pushpin(latLong, {
        icon: pinImg,
        anchor: new Microsoft.Maps.Point(8, 8),
        draggable: true,
        width: 48,
        height: 48
    });

    pin.title = sName;

    var pinInfobox = new Microsoft.Maps.Infobox(pin.getLocation(),
        {
            title: 'My Pushpin',
            description: 'This pushpin is located at (0,0).',
            visible: false,
            offset: new Microsoft.Maps.Point(0, 15)
        });

    // Add handlers for the pushpin events
    Microsoft.Maps.Events.addHandler(pin, 'click', function(e) {
        this.setOptions({ visible: true });
    }.bind(pinInfobox));
    // Hide the infobox when the map is moved.
    Microsoft.Maps.Events.addHandler(map, 'viewchange', function(e) {
        this.setOptions({ visible: false });
    }.bind(pinInfobox));
    map.entities.push(pin);
    map.entities.push(pinInfobox);
    return pin;
} 
```

# c# - NoSQL - 如何模拟数据库进行单元测试？

> ID：10048260
> 
> 赞同：6
> 
> 时间：2012-04-06T19:25:02.293
> 
> 标签：c#, .net, nosql

我正在研究 NoSQL 数据库并且对单元测试有疑问。对业务逻辑进行单元测试的合适方法是什么？如何模拟 NoSQL 数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:27:13.760

您的业​​务逻辑不应直接接触数据库，而应通过数据库访问层。这使您可以模拟该中间层以进行单元测试。为此，您可以使用依赖注入和模拟。有一些框架可以帮助您完成这两件事，但您也可以手动完成。这是一个例子：

假设我们有一个 DAL：

```
public class DBDataProvider: IDataProvider
{
    public string getData()
    {
         //SQL to get data from actual database.
    }
} 
```

如您所见，这实现了一个接口，用于为您的业务层提供数据。它可能看起来像这样：

```
public Interface IDataProvider
{
     String getData();
} 
```

您的业​​务层可能如下所示：

```
public BusinessClass
{
    private IDataProvider dataProvider;

    public BusinessClass()
    {
        dataProvider = new DBDataProvider();
    }

    public BusinessClass(IDataProvider provider)
    {
        dataProvider = provider;
    }

    public void doBusinessStuff()
    {
        dataProvider.getData(); 
        //Do something with data.
    }

} 
```

因此，现在在您的生产代码中，您将使用默认构造函数创建业务类，这将自动使您的类与数据库连接。但是，请注意，我们可以使用我们指定的 IDataProvider 创建一个 BusinessClass。因此，您可以制作一个“假”数据提供者仅用于测试：

```
public class MockDataProvider: IDataProvider
{
    public string getData()
    {
         //return some expected result that you can control, without doing a DB call.
    }
} 
```

现在在您的测试中，您可以创建一个新的 MockDataProvider，并将其传递给 BusinessClass 的构造函数。您的业​​务类现在将使用您的模拟数据提供程序，而不是真正的数据库。

在这里，我手工完成了所有操作，但它让您了解了它是如何工作的。在现实生活中，您可以使用模拟和依赖注入框架为您编写一堆代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:28:01.423

就像你模拟任何依赖一样。编写一个漂亮、简洁的合约，从中可以抽象出实现细节，然后模拟该合约。通常这是通过将数据访问层用作合同来完成的。
在不深入了解实际实现细节的情况下，假设您在要测试的方法中有一个查询：（注意，我从 ravenDB 示例中复制了此代码，但我对 ravenDB 的了解为 0，因此它甚至可能无法编译）

```
public void SomeMethod()
{
    var name = "Hello";
    var motto = "World";                       
    using (var docStore = new DocumentStore("localhost", 8080).Initialize())
    using (var session = documentStore.OpenSession()){
        session.Store(new Company { Name = name, Motto = motto });;
        session.SaveChanges();
    }
} 
```

这将很难模拟/测试，因为它需要 8080 上 localhost 上的数据库。现在，如果您将此逻辑分离到另一个类中：

```
public class AwesomeDAL
    public virtual void AddCompany(string name, string motto){
        using (var docStore = new DocumentStore("localhost", 8080).Initialize())
        using (var session = documentStore.OpenSession()){
            session.Store(new Company { Name = name, Motto = motto });;
            session.SaveChanges();
        }
} 
```

并允许注入依赖项（AwesomeDal）：

```
public class ClassBeingTested
{
    public AwesomeDal DAL { get; set; }
    public ClassBeingTested() : this(new AwesomeDal()){}
    public ClassBeingTested(AwesomeDal dal)
    {
       this.DAL = dal;
    }

    public void SomeMethod()
    {
        var name = "Hello";
        var motto = "World";                       
        this.DAL.AddCompany(name, motto);
    }
} 
```

您现在可以单独测试 BL 代码。或者你可以模拟数据库异常，或者任何你需要测试的东西，因为你的数据访问层是抽象的，并且它的实现很容易用像[Moq](http://code.google.com/p/moq/)或 RhinoMocks这样的框架来模拟

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:48:48.887

除了已经发布的（正确）答案之外，让我提出一个替代解决方案：使用真正的开发数据库！没有什么比真实的东西更真实的模拟了。如果您直接对其进行测试，至少您知道您的代码将实际运行。

如果您可以轻松地抽象出您的数据库，我建议您这样做。

# perl - /xxx/xxx/xxx 上的模式匹配

> ID：10048265
> 
> 赞同：1
> 
> 时间：2012-04-06T19:25:31.903
> 
> 标签：perl, pattern-matching

我有

```
$w="/fold1/fold2/qwerty.h" 
```

我想剪切 /qwerty.h 并得到 /fold1/fold2

我试过了

```
$w=~s/\/.+\.h\z//; and $w=~s/\/.+?\.h\z//; 
```

但那些删除整个字符串。

```
$w=~s/\/\w+\.h\z//; 
```

有效，但假设我有 qwe\rty.h 而不是 qwerty.h。那再也行不通了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-06T20:56:33.873

使用[File::Basename](http://perldoc.perl.org/File/Basename.html)，标准库中的模块之一：

```
 use File::Basename;
 my $dir = dirname( $path ); 
```

通常，当您知道数据是某种类型时，请尝试将它们视为该类型。在这种情况下，您知道它是一个文件路径，因此不要将其视为一般字符串，而是将其视为文件路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:31:20.497

想想你在做什么；你想在最后删除`/`，所以你的模式应该基于`/`，而不是“任何字符”（`.`）或“单词字符”（`\w`）

```
$w =~ s/\/[^\/]+\.h\z//; 
```

通过避免`/`使用正则表达式分隔符可以更简洁地编写：

```
$w =~ s,/[^/]+\.h\z,,; 
```

也就是说，这`File::Basename`是一种更清洁、更通用的便携式解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T01:24:15.397

```
$w=~s#(.*)/[^/]+#\1# 
```

这也有效，只需找到最后的 / ，然后用最后 / 之前的子字符串替换整个字符串

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T21:15:16.950

如果[`File::Basename`](http://search.cpan.org/perldoc?File%3a%3aBasename)对您不起作用，那么您可以执行以下操作：

```
substr( $w, 0, rindex( $w, '/' )) 
```

我经常使用它，以至于我有几个成语：

```
sub rpos_of {
    return unless 1 + ( my $pos = rindex( $_[0], $_[1] )); 
    return $pos || '0E0';
}
sub before_last { 
    return $_[0] unless my $pos = &rpos_of;
    return substr( $_[0], 0, $pos );
}
sub after_last  { 
    return $_[0] unless my $pos = &rpos_of;
    return substr( $_[0], $pos + length( $_[1] )); 
}
sub break_at_last { 
    return $_[0] unless my $pos = &rpos_of;
    return ( substr( $_[0], 0, $pos )
           , substr( $_[0], $pos + length( $_[1] ))
           );
} 
```

# javascript - 替换字符串值和边界空间（如果存在）

> ID：10048268
> 
> 赞同：0
> 
> 时间：2012-04-06T19:25:44.763
> 
> 标签：javascript, regex, replace

我有一个字符串，并试图通过替换来找出更好的方法（边界空间以及它们是否存在）

同时还替换值而不进行多次传递（即调用`trim_multispace`和`trimed_result`）。

```
var replaceVal = "c";
var strVals = "a b c d e f g h";

var replacedVal = strVals.replace(new RegExp("\\b"+replaceVal+"\\b",""),"");

alert(replacedVal)

var trim_multispace = replacedVal.replace(/ +(?= )/g,'');
var trimed_result = trim_multispace.replace(/^\s+|\s+$/g, '');

alert(trimed_result) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:49:28.597

我不确定我是否正确地理解了你，但这个正则表达式按照你指定的方式工作

```
strVals.replace(new RegExp(replaceVal, 'g'), '')
       .replace(/ +/g, ' ').replace(/^\s+|\s+$/g, ''); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:50:16.090

以下几乎是一步完成的，首先用一个空格替换值和任何周围的空格，然后修剪结果：

```
var replacedVal = strVals.replace(new RegExp("\\s*"+replaceVal+"\\s*", ""), " ").trim(); 
```

# javascript - 没有搜索字段的jQuery选择插件

> ID：10048289
> 
> 赞同：30
> 
> 时间：2012-04-06T19:28:08.503
> 
> 标签：javascript, jquery, jquery-plugins, jquery-chosen

不确定这是否已经在某处被覆盖，但我在文档中找不到它，并且想知道是否可以不使用 jQuery 选择的插件（用于样式选择输入）包含搜索输入框。具体来说，我想使用没有它的标准选择一个。

[http://harvesthq.github.com/chosen/](http://harvesthq.github.com/chosen/)

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-10-29T19:38:19.447

只是一个快速的跟进：我注意到在功能

```
AbstractChosen.prototype.set_default_values 
```

从变量中读取

```
this.options.disable_search 
```

所以你可以禁用搜索字段

```
jQuery('select').chosen( {disable_search: true} ); 
```

不使用固定数量的阈值。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-04-10T17:27:27.937

```
$(".chzn-select").chosen({disable_search_threshold: 3}); 
```

如果 select 的元素个数小于 disable_search_threshold （这里是 2 和更少），则不会显示搜索框。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-04-06T20:04:44.197

好吧，我也尝试了文档但没有运气，所以我终于解决了这个问题

> $('.chzn-search').hide();

在我调用选择后，我执行上述操作。希望这可以帮助

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-12T15:05:45.333

我在样式表中添加了一个类。

```
.chzn-select { display: none } 
```

或者，对于单个元素，我指定元素并附`_chzn`加到目标。

```
#element_chzn .chzn-select { display: none; } 
```

**请注意：** selected 会将元素 id 和类中的连字符转换为下划线，因此`element-id`您需要定位。

```
#element_id_chzn .chzn-select { display: none; } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-10-06T10:15:16.930

选择的较新版本的 jquery 为您提供了在下拉菜单中禁用搜索输入的选项。

```
$(".chzn-select").chosen({
   disable_search: true
}); 
```

旧版本不支持此选项。如果您严格不允许使用比您可以使用的新版本，一些方法

```
$(".chzn-select").chosen({
   disable_search_threshold: 5
}); 
```

如果结果少于 5 个，它将隐藏搜索框，最好与性别类型下拉列表一起使用。还有另一种方法可以解决这个问题，那就是；

```
$(".chzn-select").chosen();
$(".chzn-select").hide(); 
```

初始化后立即调用 hide，不知道为什么这个技巧有效，但它正在做你想做的事！

我建议您使用最新版本，以便您可以访问最新选项。

希望对你有帮助！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-07-05T05:46:25.740

使用此代码禁用它：

```
jQuery('select').chosen( {disable_search: true} ); 
```

并且不要忘记隐藏它，否则它仍然可以在移动设备上运行！

```
.chzn-search{display: none} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-09-19T12:10:45.580

该`disable_search_threshold`选项隐藏了单选下拉菜单的搜索框。传入的数字指定在显示搜索框之前要允许的项目数。如果您不想要搜索框，只需将其设置为比它将包含的项目数量更高的数字。

```
$('#myDropDown').chosen({ disable_search_threshold: 10 }); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-07-15T21:39:38.313

```
$('select').chosen( {disable_search: true} ); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-03-19T11:28:24.180

由于隐藏多个选择的搜索字段的选择设置似乎都不起作用，我将第 577 行中的 selected.jquery.js 破解为：

```
<li class="search-field"><span class="placeholder">' + this.default_text + '</span></li> 
```

（跨度而不是输入字段）。也需要注释掉这一行

```
this.search_field[0].disabled = false; 
```

对我来说工作得很好——即使它不是破解代码的最佳实践。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-28T10:30:12.050

使用仅适用于我的最新版本：

```
$('ul.chosen-choices li.search-field').hide(); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-11-20T09:59:49.590

我用 jQuery('select').chosen( {disable_search: true} ); 但是在 chrome profiler 上，无论如何调用了方法 search_field_scale 并且吃掉了很多性能。

因此，我删除了该方法和对他的所有调用，并在 show_search_field_default 上替换为 this.search_field.css({'width': '100%'}) 并将 style=25px 替换为 style:100% 而不是 this.search_field.css ({ '宽度': '23px' }); result_select 因为“数据占位符”

对我来说工作得很好。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-01-07T10:08:58.523

```
disable_search:true, 
```

[这是所选 jquery 插件的文档](http://harvesthq.github.io/chosen/options.html)

# jakarta-ee - Glassfish 集群中的共享状态

> ID：10048293
> 
> 赞同：1
> 
> 时间：2012-04-06T19:28:41.127
> 
> 标签：jakarta-ee, jboss, glassfish, java-ee-6

我是 Java EE 6 开发的新手，并计划使用 Glassfish 3.1.2 开源版本。我需要在集群中共享一个简单的地图数据结构（需要复制）。我一直在做一些研究，在使用 JBoss AS 时出现了一些策略：

*   JBoss 缓存
*   JBoss 英菲尼斯潘

一种策略是在 Glassfish 中使用 JBoss Infinispan。但是我想知道 Glassfish 是否已经具有处理此类事情的内置机制？

如果我使用带有 Map 的 Singleton bean，该映射会在集群中复制吗？

感谢您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:23:36.083

It depends on what you are trying to do. If you have high availability enabled, then any state in the HTTPSession or Stateful Session Bean is stored in a replica mode.

If you want to store data so that all nodes can potentially nodes can access data, then you can potentially utilize Shoal (http://shoal.javanet), which is the underlying mechanism that GlassFish uses to replicate high availability data.

Yes, you try using JBoss Cache, Infinispan, ehCache, memcached, etc, but the GlassFish team does not test those frameworks with GlassFish. We do test Oracle Coherence.

Good luck and I hope this helps.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T11:46:29.840

JBoss Cache 处于维护模式。我会推荐 Infinispan，它是 JBoss Cache 的继任者。

# java - 访问远程服务器时 MySQL 连接出错

> ID：10048296
> 
> 赞同：3
> 
> 时间：2012-04-06T19:28:57.067
> 
> 标签：java, mysql, remote-access, eofexception

我在**网络服务器中****托管了一个 MySQL 数据库**。我已**授予所有权限**并允许我的 IP从本地计算机**远程连接到该数据库。**它已连接，我能够将数据从数据库检索到我的 Java Swing 应用程序。但是，有时**我会收到此错误消息**，并且**与托管数据库的连接失败。** 错误如下图所示：

 ******```
Apr 7, 2012 12:49:20 AM scm.new_fas txtSearchKeyReleased
SEVERE: null
com.mysql.jdbc.CommunicationsException: Communications link failure due to underlying exception: 

** BEGIN NESTED EXCEPTION ** 

java.io.EOFException
MESSAGE: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.

STACKTRACE:

java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.
    at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:1997)
    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2411)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:2916)
    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1631)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:1723)
    at com.mysql.jdbc.Connection.execSQL(Connection.java:3250)
    at com.mysql.jdbc.Connection.execSQL(Connection.java:3179)
    at com.mysql.jdbc.Statement.executeQuery(Statement.java:1207)
    at scm.DBControl.getResult(DBControl.java:49)
    at scm.new_fas.txtSearchKeyReleased(new_fas.java:1686)
    at scm.new_fas.access$2300(new_fas.java:28)
    at scm.new_fas$23.keyReleased(new_fas.java:1136)
    at java.awt.Component.processKeyEvent(Component.java:5999)
    at javax.swing.JComponent.processKeyEvent(JComponent.java:2794)
    at java.awt.Component.processEvent(Component.java:5815)
    at java.awt.Container.processEvent(Container.java:2058)
    at java.awt.Component.dispatchEventImpl(Component.java:4410)
    at java.awt.Container.dispatchEventImpl(Container.java:2116)
    at java.awt.Component.dispatchEvent(Component.java:4240)
    at java.awt.KeyboardFocusManager.redispatchEvent(KeyboardFocusManager.java:1848)
    at java.awt.DefaultKeyboardFocusManager.dispatchKeyEvent(DefaultKeyboardFocusManager.java:693)
    at java.awt.DefaultKeyboardFocusManager.preDispatchKeyEvent(DefaultKeyboardFocusManager.java:958)
    at java.awt.DefaultKeyboardFocusManager.typeAheadAssertions(DefaultKeyboardFocusManager.java:830)
    at java.awt.DefaultKeyboardFocusManager.dispatchEvent(DefaultKeyboardFocusManager.java:657)
    at java.awt.Component.dispatchEventImpl(Component.java:4282)
    at java.awt.Container.dispatchEventImpl(Container.java:2116)
    at java.awt.Window.dispatchEventImpl(Window.java:2429)
    at java.awt.Component.dispatchEvent(Component.java:4240)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:599)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:273)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:183)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:173)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:168)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:160)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:121)

** END NESTED EXCEPTION **

Last packet sent to the server was 2 ms ago.
    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2622)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:2916)
    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1631)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:1723)
    at com.mysql.jdbc.Connection.execSQL(Connection.java:3250)
    at com.mysql.jdbc.Connection.execSQL(Connection.java:3179)
    at com.mysql.jdbc.Statement.executeQuery(Statement.java:1207)
    at scm.DBControl.getResult(DBControl.java:49)
    at scm.new_fas.txtSearchKeyReleased(new_fas.java:1686)
    at scm.new_fas.access$2300(new_fas.java:28)
    at scm.new_fas$23.keyReleased(new_fas.java:1136)
    at java.awt.Component.processKeyEvent(Component.java:5999)
    at javax.swing.JComponent.processKeyEvent(JComponent.java:2794)
    at java.awt.Component.processEvent(Component.java:5815)
    at java.awt.Container.processEvent(Container.java:2058)
    at java.awt.Component.dispatchEventImpl(Component.java:4410)
    at java.awt.Container.dispatchEventImpl(Container.java:2116)
    at java.awt.Component.dispatchEvent(Component.java:4240)
    at java.awt.KeyboardFocusManager.redispatchEvent(KeyboardFocusManager.java:1848)
    at java.awt.DefaultKeyboardFocusManager.dispatchKeyEvent(DefaultKeyboardFocusManager.java:693)
    at java.awt.DefaultKeyboardFocusManager.preDispatchKeyEvent(DefaultKeyboardFocusManager.java:958)
    at java.awt.DefaultKeyboardFocusManager.typeAheadAssertions(DefaultKeyboardFocusManager.java:830)
    at java.awt.DefaultKeyboardFocusManager.dispatchEvent(DefaultKeyboardFocusManager.java:657)
    at java.awt.Component.dispatchEventImpl(Component.java:4282)
    at java.awt.Container.dispatchEventImpl(Container.java:2116)
    at java.awt.Window.dispatchEventImpl(Window.java:2429)
    at java.awt.Component.dispatchEvent(Component.java:4240)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:599)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:273)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:183)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:173)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:168)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:160)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:121) 
```

有人可以帮我解决这种情况。我不明白怎么了！是服务器还是？非常感谢 ：）

这是我连接数据库的课程：

```
package scm;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class DBControl {

    private static DBControl con;
    private static String severIp = null;
    private static String severPort = null;
    private static String userName = null;
    private static String password = null;
    private static ResultSet rs = null;
    private static Connection cc = null;

    public DBControl() {
    }

    public static synchronized DBControl getInstance() {
        if (con == null) {
            con = new DBControl();
        }
        return con;
    }

    public void setSeverIp(String Ip) {
        severIp = Ip;
    }

    public void setSeverPort(String Port) {
        severPort = Port;
    }

    public void SetUserName(String Name) {
        userName = Name;
    }

    public void setPassword(String passWord) {
        password = passWord;
    }

    public static ResultSet getResult(String url) throws Exception {
        Statement s = cc.createStatement();
        rs = s.executeQuery(url);
        return rs;
    }

    public static Connection getConnection() throws Exception {
//        try {
        Class.forName("com.mysql.jdbc.Driver");
        cc = (Connection) DriverManager.getConnection("jdbc:mysql://" + getSeverIp() + ":" + getSeverPort() + "/anuradha_rr", getUserName(), getPassword());
        return cc;
    }

    public void setResult(String url) throws Exception {
        Class.forName("com.mysql.jdbc.Driver");
        cc = (Connection) DriverManager.getConnection("jdbc:mysql://" + getSeverIp() + ":" + getSeverPort() + "/anuradha_rr", getUserName(), getPassword());
        Statement s = (Statement) cc.createStatement();
        s.executeUpdate(url);
    }

    public static String getSeverIp() {
        return severIp;
    }

    public static String getSeverPort() {
        return severPort;
    }

    public static String getUserName() {
        return userName;
    }

    public static String getPassword() {
        return password;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T19:39:15.157

确保您没有使用死的 jdbc 连接。根据您创建 jdbc 连接的方式，它们可能会处于空闲状态。如果您一遍又一遍地使用相同的连接，请在尝试发出查询之前测试该连接，如果它已被 mysql 关闭，则获取一个新连接。

更新：

您在除 getResult() 之外的任何地方创建一个新连接，这是堆栈跟踪标识错误的来源。您可以像在其他任何地方一样创建新连接，也可以改进 getConnection() 的封装。换句话说，更改 getConnection() 以返回存储在您的类中的静态 Connection，条件是它不为 null 并且仍然有效。否则创建一个新连接并返回它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T21:45:35.700

这是 MySQL 中相当常见的问题，不幸的是，通常仅在应用程序运行一段时间后才会在生产中发生，这与较短的开发周期不同。

MySQL 在不通知其客户端的情况下关闭连接，当您尝试使用超时连接时出现的异常并不明显。例如，您可以定期使用一些简单的 SQL 语句 ping 连接以避免超时。

一般而言，使用连接池（以避免太多用户同时访问数据库的问题）是一种很好的做法，例如 DBCP。DBCP 可以很容易地添加到您的应用程序中，您只需将其设置为准 JDBC 驱动程序。在那里你可以正确地设置东西。

我从我的一个项目中复制了这个 DBCP 配置：

```
 MaxActive=20,
                 MaxWait=60000,
                 TestWhileIdle=true,
                 TimeBetweenEvictionRunsMillis=300000,
                 MinEvictableIdleTimeMillis=300000,
                 TestOnBorrow=true,
                 ValidationQuery='SELECT 1' 
```

**更新：** 作为一个非常简单的解决方案，您可以尝试在访问时捕获异常并在这种情况下打开一个新连接。******

# mysql - 在 MySQL 中仅检索固定数量的行

> ID：10048298
> 
> 赞同：21
> 
> 时间：2012-04-06T19:29:02.513
> 
> 标签：mysql, sql-limit

我正在负载下测试我的数据库设计，我只需要检索固定数量的行（5000）

我可以指定一个 LIMIT 来实现这一点，但似乎查询构建了所有匹配行的结果集，然后只返回限制中指定的行数。是这样实现的吗？

MySQL 是否可以读取一行，读取另一行并在检索到第 5000 个匹配行时基本停止？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-04-06T19:46:31.517

MySQL 的聪明之处在于，如果您`LIMIT 5000`在查询中指定 a，并且可以在不首先生成整个结果集的情况下生成该结果，那么它将不会构建整个结果。

例如，以下查询：

```
SELECT * FROM table ORDER BY column LIMIT 5000 
```

这个查询需要扫描整个`table`，除非有一个索引`column`，在这种情况下，它会做聪明的事情，并使用索引来查找最小的行`column`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-06T19:32:10.857

```
 SELECT * FROM `your_table` LIMIT 0, 5000 
```

这将显示数据库中的前 5000 个结果。

```
 SELECT * FROM `your_table` LIMIT 1001, 5000 
```

这将显示从 1001 到 6000 的记录（从 0 开始计数）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-06T19:33:14.700

此类查询的复杂性为 O(LIMIT)（除非您指定 order by）。

这意味着如果 10000000 行将匹配您的查询，并且您指定的限制等于 5000，那么复杂度将为 O(5000)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-06T19:54:21.687

@Jarosław Gomułka 是对的
如果您将 LIMIT 与 ORDER BY 一起使用，MySQL 会在找到排序结果的前 row_count 行后立即结束排序，而不是对整个结果进行排序。如果使用索引进行排序，则速度非常快。在任何一种情况下，在找到初始行之后，都不需要对结果集的任何剩余部分进行排序，MySQL 也不会这样做。如果该集合未排序，则一旦结果集有足够的行，它就会终止 SELECT 操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T19:48:02.057

查询优化器使用的确切计划取决于您的查询（选择了哪些字段、LIMIT 数量以及是否有 ORDER BY）和您的表（键、索引和表中的行数）。选择未索引的列和/或按非键列排序将产生与选择列和按主键列排序不同的执行计划。后者甚至不会触及表格，而只会处理您的 LIMIT 中指定的行数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-13T19:57:07.720

每个数据库都定义了自己的限制结果集大小的方法，具体取决于您使用的数据库。

虽然 SQL:2008 规范定义了限制 SQL 查询的标准语法，但 MySQL 8 不支持它。

因此，在 MySQL 上，您需要使用该[`LIMIT`](https://vladmihalcea.com/sql-query-limit-top-n-rows/)子句将结果集限制为 Top-N 记录：

```
SELECT
    title
FROM
    post
ORDER BY
    id DESC
LIMIT 50 
```

> 请注意，我们使用的是 ORDER BY 子句，否则无法保证返回结果集中包含的第一条记录。

# c# - 日期尝试使用 dateformat 解析为 dmy

> ID：10048302
> 
> 赞同：0
> 
> 时间：2012-04-06T19:29:41.343
> 
> 标签：c#

如何使以下日期成为有效日期？

```
class Program
{
    static void Main(string[] args)
    {

        DateTime testResult;
        DateTime.TryParse("31/1/2012", out testResult);

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T19:34:16.063

使用这个重载：

[http://msdn.microsoft.com/en-us/library/9h21f14e.aspx](http://msdn.microsoft.com/en-us/library/9h21f14e.aspx)

传递指定 DMY 日期顺序的区域性。

例子：

```
DateTime.TryParse("31/1/2012", new CultureInfo("en-GB"), DateTimeStyles.None, out testResult); 
```

有些人会建议使用 TryParseExact，但这也需要您指定一种文化：

```
DateTime.TryParseExact("31/1/2012", "d/M/yyyy", CultureInfo.InvariantCulture, DatetimeStyles.None, out testResult); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T19:34:46.687

```
DateTime d = DateTime.ParseExact("31/1/2012", "dd/M/yyyy", CultureInfo.InvariantCulture); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T19:36:33.110

我明白了，这是一个英国约会，所以

```
DateTime testResult;
DateTime.TryParse("31/1/2012", 
    CultureInfo.CreateSpecificCulture("en-GB"), DateTimeStyles.None, out testResult); 
```

# php - 使用 jquery、php 和 mysql 自动完成多个文本字段

> ID：10048305
> 
> 赞同：1
> 
> 时间：2012-04-06T19:29:48.063
> 
> 标签：php, jquery, mysql

我有以下 php 代码来自动完成单个文本字段，它有效；然而，我试图让它做的是自动完成字段：app_trn（有效），app_fname，app_lname 与我有相同的标准

```
<?php

if ( !isset($_REQUEST['term']) )
    exit;

$dblink = mysql_connect('localhost', 'root', 'password') or die( mysql_error() );
mysql_select_db('lms');

$rs = mysql_query('select app_trn, app_fname, app_lname from applicant where app_trn like "'. mysql_real_escape_string($_REQUEST['term']) .'%" 
order by app_trn asc limit 0,10', $dblink);

$data = array();
if ( $rs && mysql_num_rows($rs) )
{
    while( $row = mysql_fetch_array($rs, MYSQL_ASSOC) )
    {
        $data[] = array(
            'label' => $row['app_trn'] .', '. $row['app_fname'] .' '. $row['app_lname'] ,
            'value' => $row['app_trn']
        );
    }
}

echo json_encode($data);
flush(); 
```

这是将自动完成链接到文本字段的 jquery 脚本：html 表单中的“app_trn”：

```
<script type="text/javascript"> 
jQuery(document).ready(function(){
$('#app_trn').autocomplete({source:'suggest_zip.php', minLength:2});
}); 
```

# node.js - async.parallel 中的结果为 null

> ID：10048306
> 
> 赞同：0
> 
> 时间：2012-04-06T19:29:49.840
> 
> 标签：node.js, asynchronous, express

嗨，我正在尝试使用 async.parallel，这是我的调用代码。当我去检查控制台时，结果是不确定的。这很简单，所以我知道我一定是在搞砸一些简单的事情。

```
async.parallel([
   function(cb){
      Challenges.find({}, function(err, docs){
         cb(err, docs);
      });
   },
   function(cb){
      Challenges.find({}, function(err, docs){
         cb(err, docs);
      });
   }
], function(results){
   console.log("results "+util.inspect(results)); 

}); 
```

顺便说一句，我在回调之前的每个调用中都记录了文档，以确保我正在取回数据并且能够看到返回的文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:38:48.737

结果回调`async.parallel`有 2 个参数，而不是一个。第一个是`err`。

```
async.parallel([
  function(cb){
    Challenges.find({}, function(err, docs){
      cb(err, docs);
    });
  },
  function(cb){
    Challenges.find({}, function(err, docs){
      cb(err, docs);
    });
  }
], function(err, results){
   console.log("results "+util.inspect(results)); 
}); 
```

# javascript - 如何测试当前浏览器是否支持给定的 tagName

> ID：10048316
> 
> 赞同：0
> 
> 时间：2012-04-06T19:30:37.320
> 
> 标签：javascript

我想做一个函数，效果如下：

```
function supportsElem(tagName) {
   // returns boolean
} 
```

在哪里：

```
supportsElem("div") // true 
supportsElem("randomtext") // false 
```

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:55:42.597

只是一个猜测，因为我从来没有关心过这个。但在我看来，您可以创建元素，然后检查以确保它的行为符合预期。例如，它具有某些属性，或者它的构造函数是正确的（或者至少与不受支持的通用元素不同）。

构造函数检查的示例（未经测试）：

```
// pick a name that'll never be an element 
var generic_element = document.createElement('randomtext');

var tagName_to_check = document.createElement('div');
if (tagName_to_check.constructor === generic_element.constructor) {
    // the browser treats the node as a generic element, rather than
    // (eg) a DivElement
    // so it's probably unsupported
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:56:49.273

试试这个：

```
function testTag(tagname) {
    return document.createElement(tagname) instanceof HTMLUnknownElement;
} 
```

我不知道这个（`HTMLUnknownElement`）会有什么样的浏览器支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T19:56:52.963

这是比它的价值更多的努力。

只需保留所有有效标签的字典（[易于在线查找](http://www.w3schools.com/tags/ref_html_dtd.asp)）。基本上是一个字符串数组

那么它只是

```
var dictionary = ["div", "a", "input", "span", ..., "td"];
var myTag = "div";
dictionary.indexOf(myTag); // if this doesn't return -1, then the tag is valid 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T19:50:57.163

您可以简单地创建元素，然后针对特定于该元素的方法对其进行测试。

# stringtemplate - StringTemplate 导入目录如何使用？

> ID：10048321
> 
> 赞同：0
> 
> 时间：2012-04-06T19:31:04.363
> 
> 标签：stringtemplate, stringtemplate-4

我编写了一个位于 /src 文件夹中的示例 java 文件。

```
public class Main {
  public static void main(String[] args){
    STGroupFile StgFile=new STGroupFile("template.stg");
    StgFile.delimiterStartChar = '$';
    StgFile.delimiterStopChar = '$';
    ST webtemp=StgFile.getInstanceOf("test");
    webtemp.add("x","whyyy");
    System.out.println(webtemp.render());
  }
} 
```

我也有位于 /src 文件夹中的文件 template.stg

```
import "headers/header.stg" 
test(x) ::= << $included(x)$ >> 
```

以及位于 /src/headers 文件夹中的文件 header.stg。

```
included(x) ::= << headers[$x$] >> 
```

结果显然是

```
headers[whyyy] 
```

但是如果我尝试导入整个 headers 目录，使 template.stg 像这样：

```
 import "headers" 
  test(x) ::= << $included(x)$ >> 
```

*   包含的子模板不能使用...

我使用的 StringTemplate 版本是最新的 4.0.5 并且根据链接[http://www.antlr.org/wiki/display/ST4/Differences+between+v3+and+v4](http://www.antlr.org/wiki/display/ST4/Differences+between+v3+and+v4)导入目录是允许的..我甚至在/之前和/或之后使用过/ - 相对/绝对路径，但它不起作用:(请帮忙？谢谢:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T15:32:31.033

你试过`$header/included(x)$`吗？

# android - 尝试更改字符串值以检查它们在我的 Android 应用程序上是否为空

> ID：10048322
> 
> 赞同：-2
> 
> 时间：2012-04-06T19:31:05.943
> 
> 标签：android, json, for-loop, arrays

因此，我从 JSON 对象中获取了一堆字符串值，然后将它们全部打印出来。但是，我想将所有值放在一个字符串数组中并检查它们是否为空，如果是...将值更改为“N/A”，这样它们就不仅仅是空白了。但是，它可以识别哪些字符串是空白的，但是当我在 logcat 中检查它们时，它不会打印空字符串的名称。例如，我知道两个字符串将是空的，但是当我用这个检查它时：

```
System.out.println(nullCheck[i] + "is empty"); 
```

“是空的”在 logcat 中只出现了两次。即使我想更改其中任何一个的值，它仍然不会这样做。它检索所有包含数据的字符串并将它们打印出来。我可能只是忽略了一些非常简单的事情，但我会很感激任何帮助。以下是供参考的完整片段：

```
 String supplieraddress = "";
    String supplierphone = "";
    String supplieremail = "";
    String supplierfax = "";
    String vouchercontact = "";
    String supplierid = "";
    String suppliername = "";
    String servicetype = "";
    String serviceid = "";
    String vouchernotes = "";

    try {
        voucher = reservation.getJSONArray("vouchers").getJSONObject(vouchNumber);

        supplieraddress = voucher.getString("supplieraddress");
        supplierphone = voucher.getString("supplierphone");
        supplieremail = voucher.getString("supplieremail");
        supplierfax = voucher.getString("supplierfax");
        vouchercontact = voucher.getString("vouchercontact");
        supplierid = voucher.getString("supplierid");
        suppliername = voucher.getString("suppliername");
        servicetype = voucher.getString("servicetype");
        serviceid = voucher.getString("serviceid");
        vouchernotes = voucher.getString("vouchernotes");

    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    String[] nullCheck = {supplieraddress, supplierphone, supplieremail, supplierfax, vouchercontact,
            supplierid, suppliername, servicetype, serviceid, vouchernotes}; 

    for(int i = 0; i < nullCheck.length; i++)
    {
        if(nullCheck[i].equals(""))
        {
            System.out.println(nullCheck[i] + "is empty");
            nullCheck[i] = "N/A";
        }

    }

    content.setText(Html.fromHtml(
            "</br><b>Supplier Address </b><br/>" + supplieraddress
            + "<br/><br/><b>Supplier Phone </b><br/>" + supplierphone
            + "<br/><br/><b>Supplier Email </b><br/>" + supplieremail
            + "<br/><br/><b>Supplier Fax </b><br/>" + supplierfax
            + "<br/><br/><b>Voucher Contact </b><br/>" + vouchercontact
            + "<br/><br/><b>Supplier ID </b><br/>" + supplierid
            + "<br/><br/><b>Supplier Name </b><br/>" + suppliername
            + "<br/><br/><b>Service Type </b><br/>" + servicetype
            + "<br/><br/><b>Service ID </b><br/>" + serviceid
            + "<br/><br/><b>Voucher Notes </b><br/>" + vouchernotes
            ));  

} 
```

多谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:42:23.017

在你的**try**块中这样做：

```
String s = voucher.getString("supplieraddress");
supplieraddress = TextUtils.isEmpty(s)? "N/A" : s;
s = voucher.getString("supplierphone");
supplierphone = TextUtils.isEmpty(s)? "N/A" : s;
s = voucher.getString("supplieremail");
supplieremail = TextUtils.isEmpty(s)? "N/A" : s;

// and so on.... 
```

# python - 使用 python 和 gstreamer 将 webm 视频转换为 avi 视频

> ID：10048326
> 
> 赞同：1
> 
> 时间：2012-04-06T19:31:29.733
> 
> 标签：python, gstreamer

我想在 python 中编写一个 gstramer 管道，将 webm 视频转换为 avi 视频。

我制作了管道来显示有效的 webmvideo。如何执行我想要的？我虽然只是在视频队列中添加一个“x264”元素并在音频队列中添加一个“la脚”就足够了。我注意到多路复用器是必要的，我补充说。我得到的是：

`gst.element_link_many(self.queuev, self.video_decoder,colorspace,x264enc) gst.element_link_many(self.queuea, self.audio_decoder, audioconv,lame) gst.element_link_many(avimux,filesink)`

使用音频解码器和视频解码器的特定功能是：

`def demuxer_callback(self, demuxer, pad): if pad.get_property("template").name_template == "video_%02d": qv_pad = self.queuev.get_pad("sink") pad.link(qv_pad) elif pad.get_property("template").name_template == "audio_%02d": qa_pad = self.queuea.get_pad("sink") pad.link(qa_pad)`

我想我必须为avimux 编写类似的代码。我已经这样做了：

```
 def avimux_callback(self, avimux, pad1):
    if pad1.get_property("template").name_template == "video_%02d":
        qv_pad1 = self.queuev.get_pad("sink")
        pad1.link(qv_pad1)
    elif pad1.get_property("template").name_template == "audio_%02d":
        qa_pad1 = self.queuea.get_pad("sink")
        pad1.link(qa_pad1) 
```

但我收到有关文件源的错误，并且脚本不起作用。建议？？谢谢弗兰克Br

# c# - C# 用光标获取图片框中的像素？

> ID：10048331
> 
> 赞同：4
> 
> 时间：2012-04-06T19:31:46.027
> 
> 标签：c#, winforms, bitmap, picturebox, mouse-cursor

如何使用光标在图片框中`x`获取像素？`y`

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-06T19:56:36.350

如果要获取单击像素的颜色：

```
Color pixelColor;

// add the mouse click event handler in designer mode or:
// myPicturebox.MouseClick += new MouseEventHandler(myPicturebox_MouseClick);
private void myPicturebox_MouseClick(object sender, MouseEventArgs e) {
   if (e.Button == MouseButtons.Left) 
      pixelColor = GetColorAt(e.Location);
}

private Color GetColorAt(Point point) {
   return ((Bitmap)myPicturebox.Image).GetPixel(point.X, point.Y);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-06T19:37:30.187

图片框无法获取像素。但它包含的图像可用于创建具有 getpixel 功能的[位图](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx)对象。然而，我要提一下，这不是最快的操作。如果您需要它快速，我会查看 GDI win32 功能。

# c# - 捕获 DirectX 应用程序的视觉输出 - 即使在后台？

> ID：10048333
> 
> 赞同：25
> 
> 时间：2012-04-06T19:31:52.700
> 
> 标签：c#, directx

我需要捕获 DirectX 窗口的视觉输出（如屏幕截图）。目前，我使用[这种方法](http://spazzarama.com//2009/02/07/screencapture-with-direct3d/)。
但是，当窗口在后台时，它会捕获它前面的任何内容。

我看到 DirectX 窗口即使在最小化或在后台呈现，所以这应该是可能的。
但是，怎么做？（它还需要速度快，而且它也需要在 Windows XP 上运行，不幸的是......）

**编辑**：这些天我很忙......别担心，如果它到期，我会把赏金退回。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-11T10:47:24.863

要捕获在后台（或移出屏幕）的 Direct3D 窗口，我相信您有以下选择：

1.  通过您已经发布的链接[或这个更新的示例](http://spazzarama.com/2011/03/14/c-screen-capture-and-overlays-for-direct3d-9-10-and-11-using-api-hooks/)（EasyHook 可能很难设置，但它确实工作得很好）在目标应用程序中注入和挂钩 Direct3D - 您可以随时寻求帮助以使其正常工作. 我已经使用该技术在许多游戏中毫无问题地捕获（最近用于流光溢彩克隆项目）。这种方法的问题是您担心游戏保护会导致禁令，但是 FRAPs 也使用挂钩来实现这一点，所以您的担心可能被夸大了？我猜游戏玩家因屏幕截图而被禁止是一种昂贵的发现方式。

2.  对于 Vista/Win 7 上的窗口应用程序 - 您可以注入和挂钩 DWM 并通过其共享表面发出捕获请求。我已经[在 Vista 上运行](http://spazzarama.com/2009/02/12/screen-capture-with-vista-dwm/)了这个，但还没有完成它在 Windows 7 上的运行，这是一个适用于 Windows 7 [http://www.youtube.com/watch?v=G75WKeXqXkc](http://www.youtube.com/watch?v=G75WKeXqXkc)的示例。这种方法的主要问题是使用了未记录的 API，这可能意味着您的应用程序在 Windows 补丁发布时没有任何警告就中断了 - 您还必须为每个新的主要 Windows 风格重做该技术。这也不能解决您在 Windows XP 中捕获的需要。

3.  同样在 DWM 中，还有一个缩略图 API。这取决于您尝试执行的操作。有一些关于这个 API 的信息以及其他 DWM API 在这里[http://blogs.msdn.com/b/greg_schechter/archive/2006/09/14/753605.aspx](http://blogs.msdn.com/b/greg_schechter/archive/2006/09/14/753605.aspx)

4.  还有其他技术可以在不使用 EasyHook 的情况下拦截 Direct3D 调用，例如用包装器替换各种 DLL。您可以在这里找到各种其他游戏挂钩/拦截技术：http: [//www.gamedeception.net/](http://www.gamedeception.net/)

5.  只需将 Direct3D 应用程序带到前台（我猜这在您的情况下是不受欢迎的） - 这对屏幕外窗口不起作用，除非您也移动窗口。

6.  不幸的是，我能想到的 Windows XP 的唯一解决方案是以某种形式拦截 Direct3D API。

只是在最小化时对 Direct3D 渲染进行说明。在我对这个问题的相当有限的测试中，我发现这取决于应用程序；通常[不建议](http://forums.create.msdn.com/forums/t/53677.aspx)在应用程序最小化时进行渲染（也是此[参考](http://www.toymaker.info/Games/html/direct3d_faq.html#D3DMIN)），但它确实会在后台继续渲染。

**更新**：为第 1 点提供了更多最新注入示例的附加链接。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-10T15:58:31.137

一个快速的谷歌，我发现了这个与 Windows XP 相关的代码项目。我不知道您是否可以将这些知识应用到 Windows Vista 和 7 中？

[http://www.codeproject.com/Articles/5051/Various-methods-for-capturing-the-screen](http://www.codeproject.com/Articles/5051/Various-methods-for-capturing-the-screen)

**编辑：**

我也找到了这篇文章：

[http://www.codeproject.com/Articles/20651/Capturing-Minimized-Window-A-Kid-s-Trick](http://www.codeproject.com/Articles/20651/Capturing-Minimized-Window-A-Kid-s-Trick)

此链接来自评论中的 Justins 博客文章。看来他正在和某人一起做这个（我看到那是你的链接）。

[http://spazzarama.com/2009/02/07/screencapture-with-direct3d/](http://spazzarama.com/2009/02/07/screencapture-with-direct3d/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T21:56:11.193

您说您在项目中使用的链接到的代码（来自 spazzarama）捕获 DirectX 设备的前端缓冲区。您是否尝试过捕获后台缓冲区？从链接站点上的代码开始，您将第 90 行从

```
device.GetFrontBufferData(0, surface); 
```

至

```
Surface backbuffer = device.GetBackBuffer(0, 0, BackBufferType.Mono);
SurfaceLoader.Save("Screenshot.bmp", ImageFileFormat.Bmp, backbuffer); 
```

这还涉及删除链接示例中的第 96-98 行。后缓冲区可能会在没有阻碍窗口的情况下生成。

**编辑**

没关系这一切。我刚刚意识到您链接的示例代码正在使用窗口句柄来定义屏幕区域，而实际上并没有对 DirectX 窗口进行任何操作。您的示例代码无法解决障碍，因为在您访问区域时，您的区域已经在其前面的另一个窗口中绘制。

挽救应用程序的最佳选择可能是在运行代码以捕获图像之前将 DirectX 窗口置于屏幕顶部。您可以使用该`Wind32API` `BringWindowToTop`功能来做到这一点（[http://msdn.microsoft.com/en-us/library/ms632673%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms632673%28VS.85%29.aspx)）。

# java - 从文件中读取并存储为整数

> ID：10048334
> 
> 赞同：-1
> 
> 时间：2012-04-06T19:31:55.707
> 
> 标签：java

我正在尝试从文件中读取数据并将数据存储在三个整数中，红色、绿色和蓝色文件中的数据设置为：

```
255,0,0
0,255,0
0,0,255
0,255, 255 
```

我已经尝试过这样做的方法，但我没有成功任何人都可以帮助这里是迄今为止该方法的副本：

```
private void readColoursFromFile()  {

    int red = 128;
    int green = 128;
    int blue = 128;

    StringBuilder contents = new StringBuilder();
    String filename = "colours.txt";
     try { 
    BufferedReader reader;

   reader = new BufferedReader(new FileReader(filename));
   String str;

   while (( str = reader.readLine()) != null) {

       StringTokenizer tokenizer = new StringTokenizer(str, ",");
       String rcolour = tokenizer.nextToken(); 
       String gcolour = tokenizer.nextToken(); 
       String bcolour = tokenizer.nextToken(); 
       Integer irColour = red;
       Integer igColour = green;
       Integer ibColour = blue;
       rcolour = Integer.toString(irColour);
       gcolour = Integer.toString(ibColour);
       bcolour = Integer.toString(igColour);
     contents.append(str);
       printColourRow(red, green, blue);    
       }
   {
     reader.close();
  }
   } catch (IOException e) {
    System.out.println("error");
    e.printStackTrace();
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:37:05.190

代替

```
 Integer irColour = red;
   Integer igColour = green;
   Integer ibColour = blue;
   rcolour = Integer.toString(irColour);
   gcolour = Integer.toString(ibColour);
   bcolour = Integer.toString(igColour); 
```

和

```
 red = Integer.parseInt(rcolour); 
   green = Integer.parseInt(gcolour); 
   blue = Integer.parseInt(bcolour); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:35:45.927

您正在从此文件中设置`rcolour`、`gcolour`和值，但您没有对它们做任何事情。`bcolour`然后将这些值设置为 128。然后打印颜色行（使用 printColourRow）值 128,128,128。变量`red`,`green`和`blue`在顶部都设置为 128 并且永远不会更改。

你不应该打印出你从文件中读取的内容吗？如：

```
printColourRow(Integer.parseInt(rcolour),
               Integer.parseInt(gcolour),
               Integer.parseInt(bcolour)); 
```

# php - 将值映射到回调数组（array_map 的逆向）

> ID：10048335
> 
> 赞同：1
> 
> 时间：2012-04-06T19:32:06.157
> 
> 标签：php, arrays, closures

我不想让一个回调遍历整个数组（如array_map），而是想知道是否有一个函数可以让一个回调数组过滤一个值。

```
$value = 'foo';

$closures = array(
    function($value) { return $value . 'bar'; }
    function($value) { return $value . 'baz'; }
);

// Something other than a foreach with call_user_func?
// $value = array_callbacks($closures, $value);

// vs
foreach ($closures as $callback)
{
    $value = call_user_func($callback, $value);
}

print $value; // foobarbaz 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T20:17:38.773

我认为你现在的做法是正确的。据我所知，没有“反向数组映射”。

您可以围绕依次调用每个回调的回调创建一个“包装器”函数，并使用 array_map 应用它，但我认为您不会从 foreach 方法中获得任何真正的好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T20:40:24.053

您所描述的在函数式编程中称为“减少”或“折叠”，而不是“映射”，因为您试图按顺序通过值列表处理值，而不是收集应用每个结果的列表元素的原始值。

以下作品：

```
<?
$value = 'foo';

$closures = array(
    function($value) { return $value . 'bar'; },
    function($value) { return $value . 'baz'; }
);

print array_reduce($closures,
                   function ($value, $callback) { return $callback($value); },
                   $value);
?> 
```

但我同意其他海报的使用可能更简单`foreach`。尝试在 PHP 中做函数式的东西是很痛苦的。

# jquery - jQuery：清理处理来自 ajax 的错误状态代码

> ID：10048346
> 
> 赞同：3
> 
> 时间：2012-04-06T19:32:59.653
> 
> 标签：jquery, ajax

我有一个非常简单的 ajax 请求：

```
$.get(url, data)
   .done(function () { })
   .fail(function () { }) 
```

如果在 处有错误`url`，它将返回一个状态码，例如“500”。显然，jQuery 在这一点上考虑了它对`jqxhr`对象的承诺，因为它将执行`.done`而不是`.fail`. 我的问题是双重的：

默认情况下，`.fail`关于 ajax 的触发时间是什么时候，有没有办法改变这个默认值？

其次，对错误请求进行特殊处理的唯一方法似乎是：

```
.done(function (msg, tm, jqxhr) {
   if (jqxhr.status < 200 || jqxhr.status >= 300) performFailure();
}); 
```

有没有更好的方法来查找和处理被认为“不好”的响应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T19:41:04.413

从 jQuery [.get()](http://api.jquery.com/jQuery.get/)文档中：

> 如果带有 jQ​​uery.get() 的请求返回错误代码，*它将静默失败*，除非脚本也调用了全局 .ajaxError() 方法。或者，从 jQuery 1.5 开始，jQuery.get() 返回的 jqXHR 对象的 .error() 方法也可用于错误处理。

（强调我的）

我在错误处理方面做得不多，但听起来您可能需要调用 ajaxError 来消除错误情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:44:41.617

查看 .ajax 函数的文档，它有一个非常好的错误处理程序：http: [//api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)您可能想要使用这个函数而不是 get()。（两者本质上是一样的，你可以从这个页面看到： http: [//api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/)）；

您的代码示例如下：

```
 $.ajax({
       url: url,
       data: data,
       error: /*error function*/,
       success: /*success function*/,
     }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T19:51:42.717

在进一步研究之后，似乎 jQuery 确实使用`.fail()`正确。问题是我的服务器因某些错误而发出 200。换句话说，这不是一个 jQuery 问题。

# sql - UNION 到特定字段

> ID：10048355
> 
> 赞同：5
> 
> 时间：2012-04-06T19:33:24.243
> 
> 标签：sql, union

有人可以帮我更改我的 SQL 查询，这样“UNION”语句将只应用于“首字母缩略词”和“user_pk”字段（而不是“姓氏，名字；姓氏，名字”）？但在“parent”“SELECT”语句中，“acronym”、“surname”和“givename”字段应该仍然存在。

![](../Images/bfa6d82686c12937ae7cd90226afcc5d.png)

```
SELECT acronym, surname, givename
FROM
(
    SELECT acronym, surname, givename from table_1
    UNION
    SELECT user_pk, lastname, firstname  from table_2
) 
```

谢谢你的支持！

亲切的问候，嘘

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-06T21:10:47.377

如果同一个字符串在 Table_1 中作为首字母缩写词出现，在 Table_2 中作为 user_pk 出现，是否可以公平地猜测，如果其中一个名称完全为空，您不想看到它，但如果任一名称字段中的任何一个row 不为空，您宁愿看到两行而不是一行？

在这个假设上工作：

```
SELECT t1.acronym, t1.surname, t1.givename
  FROM table_1 AS t1
 WHERE t1.surname IS NOT NULL OR t1.givename IS NOT NULL
UNION
SELECT t2.user_pk AS acronym, t2.lastname AS surname, t2.firstname AS givename
  FROM table_2 AS t2
 WHERE t2.lastname IS NOT NULL OR t2.firstname IS NOT NULL 
```

* * *

如果这与您想要的不够接近，请从下表中提供所需的输出：

```
Table_1
Acronym          Surname      Givename
Denton Powell     Powell        Denton
Jane Goodall     Goodall
Susan Mitchell                   Susan
Martin Catcall
John Thimble     Thimble          John

Table_2
User_pk        Lastname      Firstname
Denton Powell
Jane Goodall                      Jane
Susan Mitchel   Mitchell
Martin Catcall   CatCall         Marty
John Thimble      Needle         David 
```

还有更多可能的组合，但是当您指定了您想要的组合时，您将已经详细介绍了大多数情况，其他情况应该是显而易见的。

* * *

### 回答主要问题的评论

> 我只想看到一行，因为这个“user_pk”已经存在于 table_1 中（在字段“首字母缩写词”中）。在您的情况下，输出应该是： Denton Powell；鲍威尔；丹顿。table_2 中的行应该被忽略。

再解释一下，这意味着如果表项出现在Table_1中，就使用它；如果 Table_2 中没有匹配的条目，只使用 Table_2 中的条目？

再次，基于该假设，然后您希望将 Table_1 中的数据与“Table_2 与 Table_1 的半连接的补码”合并，这是一种花哨的方式来表达“Table_2 中不存在的行”在 Table_1' 中有一个条目：

```
SELECT t1.acronym, t1.surname, t1.givename
  FROM table_1 AS t1
UNION
SELECT t2.user_pk AS acronym, t2.lastname AS surname, t2.firstname AS givename
  FROM table_2 AS t2
 WHERE t2.user_pk NOT IN (SELECT t1a.acronym FROM table_1 AS t1a); 
```

这失去了名称中的空值条件。如果某个用户在 Table_1 中有一个条目，而姓氏和名字字段中没有任何信息，那么您将看到这些空名称。如果您要应用其他条件，则必须进行一些调整。

顺便说一句，我认为您从未指定“user_pk”是主键（非空且唯一），也没有指定“首字母缩写词”是主键。这些细节可能会有所帮助，并且可以消除回答您问题的人的一些担忧（即使他们没有表达过担忧）。这也让我们放心，你知道你在说什么。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-06T19:37:39.150

```
SELECT acronym as col, surname, givename from table_1
UNION
SELECT user_pk as col, lastname as surname, firstname as givename from table_2 
```

# ruby-on-rails - Rails 为现有资源生成控制器样板？

> ID：10048357
> 
> 赞同：3
> 
> 时间：2012-04-06T19:33:35.360
> 
> 标签：ruby-on-rails, rails-generate

我曾经`generate scaffold`设置基本的 RESTful 操作，但我想扩展这些操作以包括“购买”之类的内容。有没有办法使用命令行来生成样板文件（控制器文件中的存根函数和更新的路由文件？）？

据我所知`generate controller`，擦除或保留现有文件 - 没有合并它们的好方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T19:38:49.210

默认情况下不是。但是，请意识到在 Rails 3 中，自定义生成器并不是很困难。请参阅[创建和自定义 Rails 生成器和模板](http://guides.rubyonrails.org/generators.html)，以及 Bates[在 Rails 3 中生成器](http://railscasts.com/episodes/216-generators-in-rails-3)的截屏视频。

关于你的第二个“问题”，没错——文件要么被替换，要么被覆盖。

# javascript - Javascript 不会抛出新的错误

> ID：10048358
> 
> 赞同：3
> 
> 时间：2012-04-06T19:33:37.143
> 
> 标签：javascript, error-handling, dojo

我有一些代码让我感到困惑。我在网上搜索过，但我找不到这样的东西，虽然我不认为我是第一个 =) 我正在使用 dojo，我不知道这是否与我的问题有关有。问题是 Firebug 不会抛出我希望它抛出的错误。但是，在 Safari 中调试时，抛出错误？？？我一直在做这种事情，由于某种原因，它在这里行不通。

这是代码示例：

```
var formSubmit = function(e) {
    e.preventDefault();

    var f = testForm.domNode,
        map = {};
    for(var i = 0; i < f.elements.length; i++){
        var elem = f.elements[i];
        map[elem.id] = elem.value;
    }

    if (!map.id && !map.field1) {
        ***// -- this error will not be thrown --***
        throw new Error("you must supply some data"); 
    }
}

testForm = new Form({
    encType: "multipart/form-data",
    method: "post",
    onSubmit: formSubmit
}, "testForm"); 
```

任何人都知道为什么这在 Firebug 中不起作用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-06T19:39:52.893

错误可能会被抛出，但抛出错误的函数是从事件处理程序中调用的，因此错误最终会出现在系统事件处理代码中，在那里它要么被捕获（未在你的代码中捕获），要么被忽略。

当你说“它没有被抛出”时，你期待看到什么？您是否有一个`try/catch`希望捕获异常的地方？抛出异常没有任何自己的通用 UI。它抛出异常，然后由一些更高级别的代码来捕获异常并对其进行处理。如果该事件循环中没有更高级别的代码来捕获异常，那么它只会中止该事件处理程序的执行。

# jquery - Iframe 的 Phonegap/Iphone 问题

> ID：10048360
> 
> 赞同：2
> 
> 时间：2012-04-06T19:33:55.223
> 
> 标签：jquery, xcode, cordova

我有一个 jquery 移动应用程序，我试图将它封装在 phonegap 中，除了 iframe 的行为之外，一切都运行良好。在 PhoneGap 之外，该行为按预期工作。

现在我已将项目导入 Xcode/Phonegap

在 ios 模拟器（或手机）上，设备现在会打开一个新的浏览器窗口，而不是像典型的 iframe 一样工作。

我有一个 iframe，它基本上是这样加载的： $('#myiframe').attr("src", 'http://www.myurl.com'); $('#myiframe').load( alert('帧加载');

我听说要在我的 xcode 项目中添加一个 config.xml 文件，但我一直找不到可靠的解决方案。

请帮忙谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T12:54:39.020

您必须在 PhoneGap.plist 中的 ExternalHosts 键下添加 src 域。注意 - 如果您作为 iframe src 放置的域被重定向，您还需要在 ExternalHosts 键中添加该域。例如，在加拿大，www.google.com 会重定向到 www.google.ca，因此您还必须添加该域。另一个例子，phonegap.com 重定向到 www.phonegap.com。此域值必须准确，不支持通配符。

# go - 使用秒表或类似的基准代码

> ID：10048366
> 
> 赞同：5
> 
> 时间：2012-04-06T19:34:44.107
> 
> 标签：go, benchmarking

我正在尝试使用 Go 包“时间”对我的程序中的函数进行基准测试。一直在寻找，人们似乎使用 time.NanoSeconds() - 但我认为这个功能不再在 time 包中？

我需要的是一种简单的方法来启动和停止计时器，并打印出值。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-06T19:58:38.150

在 *_test.go中使用[测试](http://golang.org/pkg/testing/)包的现有功能：

```
func BenchmarkMyFunc(b *testing.B) {
    for i := 0; i < b.N; i++ {
        myBecnhmarkedFunction()
    }
} 
```

并调用`go test -bench RE`（RE 是用于选择工作台的正则表达式，就像`B`它的意思一样`*B*`）通常在包/工具目录中

或者从代码中的任何地方显式地使用[Benchmark](http://golang.org/pkg/testing/#Benchmark)函数。

# c++ - 具有各种构造函数签名的类模板

> ID：10048369
> 
> 赞同：0
> 
> 时间：2012-04-06T19:34:48.980
> 
> 标签：c++, templates, c++11, variadic-templates

如何编写一个模板，它将作为参数类，其构造函数具有互斥签名？

```
class A
{
  A(){};
public:
  int a;
  A(int i) : a(i) {};
};

class B{
  B(){};
public:
  int a,b;
  B(int i,int j) : a(i), b(j) {};
};

template <class T> class C {
public:
  T* _t;
  C(int i[])
  {                       //???
    _t=new T(i[0]);       //if T has T(int) signature
    _t=new T(i[0],i[1]);  //if T has T(int,int) signature
  }
  ~C() {delete _t;}
};

int main()  
{ 
  int Ai[]={1,2};
  C<A> _c(Ai);  // template should work instantiated with A and B
  C<B> _c(Ai);  // 
  return 0;
} 
```

`A`和的签名`B`是固定的（例如不能更改为 int[]）。上下文：我正在考虑一个包装器，它将（专用）容器类型作为模板参数，例如`T=vector<int>`，或`T=map<int,int>`，当需要调用构造函数时会出现问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T19:40:31.477

使用可变模板构造函数：

```
template <typename T> struct C
{
    template <typename ...Args> C(Args &&... args)
    : _t(new T(std::forward<Args>(args)...))
    {
    }

    // ... destructor? Rule of five? Don't use pointers!!!
private:
    T * _t; // ouch!
}; 
```

用法：

```
C<A> x(1);
C<B> y(2, 3); 
```

（真正的程序员当然更喜欢 member `std::unique_ptr<T> _t;`，否则语义不变，但允许您忽略所有注释。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T01:46:04.103

我相信 Kerrek SB 的回答部分正确，但不完整。它失败了，因为它`C<T>`的构造函数过于通用。也就是说，`C<T>`如果你只看它的构造函数声明，它将从任何东西构造。在您选择构造函数并实例化之前，您不会发现其他情况。到那时已经太晚了。

具体例子：

假设`C<T>`有：

```
friend bool operator<(const C&, const C&); 
```

现在你想`C<T>`在 a 中制作密钥`map`：

```
std::map<C<A>, int> m;
// ...
m.erase(m.begin()); 
```

这是一个错误，因为现在有两个`erase`重载如下所示：

```
iterator  erase(const_iterator position);
size_type erase(const key_type& k); 
```

并且`m.begin()`是一个`iterator`. 这`iterator`将同样容易地转换为`const_iterator`和`key_type`（又名`C<A>`）。

现在可以通过调用来解决这个问题：

```
m.erase(m.cbegin()); 
```

反而。但这只是过度泛型构造函数导致的问题的冰山一角。例如任何分支的代码：

```
std::is_constructible<C<A>, any type and any number of them>::value 
```

可能会得到误报，因为上述内容将**始终**返回 true。

修复有点混乱，但非常实用：

```
template<typename T>
struct C
{
    template <class ...Args,
              class = typename std::enable_if
                      <
                         std::is_constructible<T, Args...>::value
                      >::type
             >
    C(Args&& ...args)
        : _t(new T(std::forward<Args>(args)...))
    {
    }
    // ...
}; 
```

即向构造函数添加一个约束，这样如果它不工作就不会被实例化。这是乱七八糟的，丑陋的，无论如何。也许你想用一个宏来装扮它。美好的。但是它使这个类在我上面提到的例子中被**破坏**的地方**工作（以及许多***其他*问题，这些问题往往会在几年的时间里一次一个地报告错误）。

 **除了 Kerrek SB 关于在`unique_ptr<T>`此处使用原始指针的好建议之外，我还想补充一点：

1.  `explicit`至少在实际用例表明它确实需要隐式之前，这个构造函数可能应该是。

2.  考虑将 a`T`而不是（可能是智能的）指针存储到`T`. 除非您实际上试图指向基类以实现运行时多态性，否则您不需要指针语义。

总而言之：警惕过度泛型的代码，以及过度泛型的构造函数的彻头彻尾的偏执狂。**

# php - 下载标题以某种方式插入 18 行空格

> ID：10048372
> 
> 赞同：0
> 
> 时间：2012-04-06T19:35:44.113
> 
> 标签：php, csv, header, download

我正在尝试提供一个动态生成的 csv 文件。出于某种原因，当我获取文件时，数据前面有 18 个空行。我定义的标题和我发送的 csv 数据之间没有任何空格。如果我将数据写入服务器上的文件，它不会得到这些空行。但是，如果我编写文件然后尝试将其提供给用户，则会返回空行。所以我想知道我是否弄乱了标题，或者是否还有另一个我没有想到的问题：

```
function generate_csv($source_type, $include_unpublished = FALSE) {

   // retrieve data from DB
   ....

   // start up headers
   $csv_name = "$source_type-$data_set-csv_" . date('Y-m-d') . '.csv';
   header('Content-Type: text/x-comma-separated-values');
   header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
   header('Cache-Control: private', false); // required for certain browser
   header('Content-Disposition: attachment; filename="' . $csv_name . '"'); 

   // send csv data
   print $csv_data;

} //end function 
```

免责声明：我在[https://drupal.stackexchange.com/questions/27649/extra-empty-rows-when-serving-csv-file](https://drupal.stackexchange.com/questions/27649/extra-empty-rows-when-serving-csv-file)提出了这个问题，但它似乎不是特定于drupal的，并且没有那里有很多想法..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T20:06:55.427

也许这行“挂起”在输出缓冲区中，这是在一段时间前开始的。这样，您可以设置标题而不会出现旧的“已发送标题”错误，但是无论如何刷新缓冲区时，此内容都会发送到浏览器。

尝试

```
ob_clean();
print $csv_data; 
```

[http://php.net/ob-clean](http://php.net/ob-clean)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T19:43:49.133

您包含的文件一定有问题。php 结束标记后的每个空格多于一个换行符`?>`被发送到浏览器。

最好的解决方案是在每个 php 文件中去掉这个结束标签。

其他选项是只删除不必要的新行，或者在提供文件之前缓冲输出并忽略它。

# html - html5本地存储值

> ID：10048376
> 
> 赞同：0
> 
> 时间：2012-04-06T19:35:55.447
> 
> 标签：html, local-storage

假设我有以下存储在本地存储中

```
 var storageObject = {}; 
    storageObject.value = myvalue; 
    storageObject.timestamp = d.getTime(); 
    localStorage.setItem(myref, JSON.stringify(storageObject)); 
```

如何使用 getItem 检索值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T19:38:57.933

简单地：

```
localStorage.getItem(myref); 
```

甚至：

```
localStorage[myref]; 
```

[https://developer.mozilla.org/en/DOM/Storage#localStorage](https://developer.mozilla.org/en/DOM/Storage#localStorage)

编辑以从 JSON 恢复原始对象，简单地`parse`说：

```
var revivedObject = JSON.parse( localStorage.getItem(myref) ); 
// console.log(revivedObject); 
```

# iphone - 将特定符号从 json 转换为普通 utf-8

> ID：10048377
> 
> 赞同：1
> 
> 时间：2012-04-06T19:35:57.833
> 
> 标签：iphone, objective-c, ios, json, nsstring

我从服务器获取 json 字符串。然后我使用 SBJSON 库对其进行解析。但是当我在标签中显示解析结果时，我有这样的符号

```
&#33; 
```

（通常是！）。

那么如何将我的 json 字符串转换为普通字符串呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:40:53.573

使用这个：[https](https://github.com/mwaterfall/MWFeedParser/blob/master/Classes/NSString+HTML.m) ://github.com/mwaterfall/MWFeedParser/blob/master/Classes/NSString+HTML.m （特别是`stringByDecodingHTMLEntities`方法）。

# sql - SQL 查询以获取基于另一列的行 ID

> ID：10048388
> 
> 赞同：0
> 
> 时间：2012-04-06T19:36:40.657
> 
> 标签：sql, sql-server-2008

例如，如果我有一张桌子：

```
DECLARE @tmpTable TABLE
( SectionID INT,
  DetailID INT) 
```

我有以下数据：

```
SectionID    DetailID
1000          -1
1000           0
1000          -1
1100          5000
1100          0
1200          0
1200          0
1300          7000
1300          8000 
```

如何编写 SQL 以获取所有详细 ID 为 0 或 -1 的所有部分 ID。在上面的示例中，SQL 应该返回 1000 和 1200（不是 1100，因为至少 1 项不是 0 或 -1）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T19:44:07.947

```
SELECT DISTINCT SectionID
FROM @tmpTable AS t
WHERE NOT EXISTS
      ( SELECT *
        FROM @tmpTable AS tt
        WHERE tt.SectionID = t.SectionID
          AND tt.DetailID NOT IN (-1, 0)
      ) 
```

我认为这也应该有效，因为`DetailID`它是一个整数，并且您正在检查的值 (`-1`和`0`) 之间没有间隙。它可能会更快，有一个索引`(SectionID, DetailID)`：

```
SELECT SectionID
FROM @tmpTable AS t
GROUP BY SectionID
HAVING MAX(DetailID) <= 0
   AND MIN(DetailID) >= -1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:40:24.683

```
select sectionId from mytable where detailId in (0,-1)
and section id not in (select sectionid from mytable where detail_id > 0) 
```

# asp.net-mvc-3 - MVC3 脚手架存储库中的单例 DbContext 派生对象

> ID：10048389
> 
> 赞同：1
> 
> 时间：2012-04-06T19:36:58.810
> 
> 标签：asp.net-mvc-3, ninject, entity-framework-4.3

我在 MVC4 应用程序和 Ninject.MVC3 中使用 EF 4.3。控制器使用 -Repository 开关进行 MVC 脚手架。MVCScaffolder 使用 EF 创建存储库类（和相应的 IRepository 接口）以进行数据访问，其中 DbContext 派生对象始终作为每个脚手架存储库中的数据成员“更新”。

```
MyContext context = new MyContext(); 
```

搭建控制器的本质是，对于每个控制器，您通常还会获得相应的存储库。

问题：

1）为您拥有控制器的每个域对象都有一个存储库是否有意义？
与只应公开聚合根的存储库模式相比，这似乎违反直觉。

2) 每次实例化存储库对象时生成 DbContext 派生对象的新实例是否有意义，或者在应用程序启动时向 DI 容器注册 DbContext 派生对象的单例实例并解决它是否有意义像这样的单例存储库：

```
Bind<MyContext>().To<MyContext>().InSingletonScope();  //ninject code on app startup

 //resolve context in repositories: 
 MyContext context = ServiceLocator.Current.GetInstance<MyContext>(); 
```

在应用程序的生命周期内将 DbContext 派生对象作为单例保留有什么缺点吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T17:02:15.790

1.  这取决于您的期望。如果您想使用真正的存储库，您将使用聚合根，并且您将自己编写这些存储库（不自动生成），因为这样的存储库始终是特定的。如果您只想要[EF 的通用包装器，](https://stackoverflow.com/questions/5625746/generic-repository-with-ef-4-1-what-is-the-point/5626884#5626884)您将使用您当前的解决方案。吨
2.  通常，对于控制器必须使用多个存储库并且必须协调将所有存储库中的数据保存在一起（工作单元模式）的场景，每个 HTTP 请求都会使用新上下文。[不要使用单例上下文！](https://stackoverflow.com/questions/3653009/entity-framework-and-connection-pooling/3653392#3653392)

# c# - 使用 SQL Server 数据库构建 HTTP REST Web 服务器

> ID：10048395
> 
> 赞同：3
> 
> 时间：2012-04-06T19:37:15.673
> 
> 标签：c#, .net, sql-server

我正在寻找有关如何开始使用 C# 和 SQL Server 数据库构建 http REST 服务器的指导？

是否有推荐的 http web 服务器服务器框架？REST 服务也一样吗？

我应该如何开始？提升常规服务器，然后处理 SQL Server 数据库？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T19:50:59.027

使用 OData。看看[在 30 分钟内为 StackOverflow 创建一个 OData API，包括 XML 和 JSON](http://www.hanselman.com/blog/CreatingAnODataAPIForStackOverflowIncludingXMLAndJSONIn30Minutes.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T20:18:27.857

考虑使用[新的 ASP.NET Web API](http://www.asp.net/web-api/overview)：

> ASP.NET Web API 是一个可以轻松构建 HTTP 服务的框架。. . ASP.NET Web API 是在 .NET Framework 上构建 RESTful 应用程序的理想平台。

它目前处于测试阶段，但与 WCF 不同，它是专门为在 .NET 中构建 RESTful HTTP 服务而构建的。有关更多详细信息，请参阅 SO 问题[WCF vs ASP.NET Web API](https://stackoverflow.com/questions/9348639/wcf-vs-asp-net-web-api)。

有示例和视频教程，其中之一是使用可由 SQL 支持的实体框架模型。这个 SO 问题专门涵盖了该示例：[How to mix Entity Framework with Web API](https://stackoverflow.com/questions/9573944/how-to-mix-entity-framework-with-web-api)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-06T20:41:46.290

我开始评估 .Net 和 python 的 REST 框架。到目前为止，我最喜欢[ServiceStack](http://servicestack.net/) for .Net。它很简单，比 WCF 更容易配置，支持依赖注入，而且速度似乎很快。

当 VS 11 和 .Net 4.5 完全发布时，微软也提供了 Web API。它也可用于构建 REST API，因此值得研究。

我还没有对 Web API 做足够的研究来看看哪个会更好，但这些都是你需要考虑的。

# android - 覆盖 WebSettings cordovaExample.java 会导致 PhoneGap 中的错误

> ID：10048397
> 
> 赞同：3
> 
> 时间：2012-04-06T19:37:21.710
> 
> 标签：android, cordova, android-emulator, web-applications

对于有经验的安卓程序员来说，这应该很容易。不幸的是，我对android sdk一无所知。我正在使用 PhoneGap 打包一个 Web 应用程序，我需要覆盖 cordovaExample.java 中的 WebSettings（现在我正在使用 cordovaExample 作为我的应用程序的模板）。我的代码如下所示：

```
package org.apache.cordova.example;

import android.app.Activity;
import android.os.Bundle;
import org.apache.cordova.*;

public class cordovaExample extends DroidGap
{
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        this.appView.getSettings().setUseWideViewPort(true);
        this.appView.getSettings().setLoadWithOverviewMode(true);
        super.onCreate(savedInstanceState);
        super.loadUrl("file:///android_asset/www/index.html");
    }
} 
```

我可以`ant debug install`毫无问题地运行，但是当我在模拟器中启动应用程序时，会出现以下错误：

```
E/AndroidRuntime(  549): java.lang.RuntimeException: Unable to start activity ComponentInfo{org.apache.cordova.example/org.apache.cordova.example.cordovaExample}: java.lang.NullPointerException
E/AndroidRuntime(  549):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
E/AndroidRuntime(  549):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
E/AndroidRuntime(  549):    at android.app.ActivityThread.access$600(ActivityThread.java:123)
E/AndroidRuntime(  549):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
E/AndroidRuntime(  549):    at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime(  549):    at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime(  549):    at android.app.ActivityThread.main(ActivityThread.java:4424)
E/AndroidRuntime(  549):    at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(  549):    at java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime(  549):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
E/AndroidRuntime(  549):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
E/AndroidRuntime(  549):    at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime(  549): Caused by: java.lang.NullPointerException
E/AndroidRuntime(  549):    at org.apache.cordova.example.cordovaExample.onCreate(cordovaExample.java:12)
E/AndroidRuntime(  549):    at android.app.Activity.performCreate(Activity.java:4465)
E/AndroidRuntime(  549):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
E/AndroidRuntime(  549):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
E/AndroidRuntime(  549):    ... 11 more
W/ActivityManager(   78):   Force finishing activity org.apache.cordova.example/.cordovaExample 
```

无论我为 android sdk 2.1 还是 4.3（在 Mac OS X Lion 上）打包，都会出现错误。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:49:24.877

`appView`为空...`super.onCreate(savedInstanceState);`先调用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T19:49:39.783

该错误表明第 12 行有 NullPointerException：

```
this.appView.getSettings().setUseWideViewPort(true); 
```

要么 this.appView 为 null，要么 appView.getSettings() 返回 null。添加空值检查并查看它是哪一个。一旦你知道它是哪一个，就会更容易找出为什么会有一个空值。

*此外，与问题无关，不确定是否是拼写错误，但您的班级名称是驼峰式的。这样做是违反最佳做法的。将来这样做会使您感到困惑，因为驼峰式命名法仅与实例变量、成员和方法一起使用。类名总是首字母大写，包名总是小写。所以应该是*

```
CordovaExample 
```

*并不是*

```
cordovaExample 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-27T11:01:11.710

当您希望浏览器将视口缩放到设备宽度时，无论设备的像素宽度如何，这都是我的解决方案：

在 super.loadURL(...) 之后添加这些行：

```
super.appView.getSettings().setLoadWithOverviewMode(true);
super.appView.getSettings().setUseWideViewPort(true); 
```

...结合允许缩放的元视口属性。

# java - 选项化 Java getter

> ID：10048403
> 
> 赞同：3
> 
> 时间：2012-04-06T19:37:39.303
> 
> 标签：java, scala, null, option, enrich-my-library

在 Scala 中使用 Java 时，我们必须考虑 null。

例如，HttpServletRequest getter（getAttribute、getHeader 等）都可能返回 null。

我知道我可以在每次调用 HttpServletRequest 方法时手动执行 case/match 或 map 操作，但这有点乏味。此外，像 request.getHeader("Accept-Encoding") 之类的方法调用很麻烦。

我想出了一个丰富的方法来处理这两个问题：

```
class Servlet_Request_Provides_NullSafe_Getters (r: HttpServletRequest) {

  def header(s: String) = Option( r.getHeader(s) )
  def attrib(s: String) = Option( r.getAttribute(s) )
  def remoteHost        = Option( r.getRemoteHost )
  def accepts = header("Accept-Encoding")
}
implicit def request2Option(r: HttpServletRequest) = 
  new Servlet_Request_Provides_NullSafe_Getters(r) 
```

1) 是否有比丰富我的图书馆的另一种/更好的方法来实现相同/相似的效果？
2）如果这是“可行的”方式，那么性能影响/风险是什么？换句话说，是否会被这种模式的明显实用性/便利性烧毁？

对不起，如果这东西很明显，前几天才开始丰富，它看起来真的很有用。只是想确保我在适当的场景中应用模式......

**编辑**
@dhg 指出 Option.apply() 和：

```
def safe[T](v: T) = v match {
  case null => None
  case x => Some(x)
} 
```

是等价的，所以 getter 方法现在使用 Option(f()) 而不是我无关的 safe(f()) 包装器

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T19:44:19.337

正如评论中已经提到的：

```
def safe[T](v: T) = Option(v) 
```

`Option(v)`相当于：

```
v match {
  case null => None
  case x    => Some(x)
} 
```

该`safe`方法也不必要地公开并且是类的一部分。我建议简单地内联它。

> 2）如果这是“可行的”方式，那么性能影响/风险是什么？

一般来说，调整 Java 遗留 API 以供使用`Option`是一个好主意。我经常这样做`EntityManager.find()`可以返回`null`。

Your implicit conversion is also fine. However don't use underscores in class names, Java/Scala naming conventions prefer `CamelCase`.

# asp.net-mvc-3 - TextBoxFor 和 DefaultModelBinder 没有正确格式化/解析 fr-FR

> ID：10048407
> 
> 赞同：0
> 
> 时间：2012-04-06T19:38:13.750
> 
> 标签：asp.net-mvc-3, localization, model-binding

TextBoxFor HTML 助手不尊重 DisplayFormatAttribute 但 EditorFor 对双精度值。同样， DefaultModelBinder 不会将格式正确的双精度与千位分隔符绑定。

我可以使用 EditorFor 显示双重格式的属性，但它不会绑定。我更愿意在文本框中显示属性格式化字符串，并能够发布和绑定它。

有没有人遇到过这个问题并解决了？

在此处添加示例解决方案 - [https://bitbucket.org/chief7/asp.net-mvc-3-localization-issue](https://bitbucket.org/chief7/asp.net-mvc-3-localization-issue)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:11:39.593

我团队的 Scott 发现了 Haack 的以下博客文章。这正是我们的问题。我希望他们能尽快解决这个问题。

[http://haacked.com/archive/2011/03/19/fixing-binding-to-decimals.aspx](http://haacked.com/archive/2011/03/19/fixing-binding-to-decimals.aspx)

我还在 bitbucket.org 上的示例解决方案中实施了修复。

# php - php多个变量合二为一

> ID：10048408
> 
> 赞同：1
> 
> 时间：2012-04-06T19:38:16.397
> 
> 标签：php, variables, mysqli, prepared-statement

所以我有几个使用变量列表的语句，似乎我总是在数据库中添加另一列，所以我想制作一个变量列表并以某种方式包含它，所以我可以在需要时更改它一次，而不是半打。

```
 $stmt = $mysql->prepare("SELECT * FROM table WHERE id =? LIMIT 1");

$stmt -> bind_param('i', $id);

$stmt->execute();

$stmt->bind_result($a, $b, $c, $d, $e, $f, $g);

$stmt->fetch();

$stmt->close(); 
```

但我想做这样的事情：

```
 varList="$a, $b, $c, $d, $e, $f, $g";

    $stmt = $mysql->prepare("SELECT * FROM table WHERE id =? LIMIT 1");

$stmt -> bind_param('i', $id);

$stmt->execute();

$stmt->bind_result($varList);

$stmt->fetch();

$stmt->close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:58:16.947

您可以做的是创建一个数组（对变量的引用），然后用于`call_user_func_array`调用`bind_result`.

例子：

```
$varList = array('a', 'b', 'c', 'd', 'e', 'f', 'g'); // variable names.
$params = array(); // list of params

foreach($varList as $v){
    $params[] = &$$v; // store a reference to the vars in $params
}

call_user_func_array(array($stmt, 'bind_result'), $params); 
```

您可能不需要该`foreach`循环，您也可以这样做：

```
$varList = array(&$a, &$b, &$c, &$d, &$e, &$f, &$g); // variable references

call_user_func_array(array($stmt, 'bind_result'), $varList); 
```

基于这个答案：[https ://stackoverflow.com/a/966717/206403](https://stackoverflow.com/a/966717/206403)

# php - 如何将 $_POST/$_GET 处理代码与 html 表单/url 分离？(PHP-OOP)

> ID：10048411
> 
> 赞同：2
> 
> 时间：2012-04-06T19:38:36.873
> 
> 标签：php, oop, polymorphism, encapsulation, decoupling

在一个类中，我有一个处理方法，它根据可用的 post/get 变量执行操作。这是一个简化的示例：

```
public function handleAll(array $vars) {
    if (isset($vars['var1'])) {
        $this->doThisAction($vars['var1']);
    } else if (isset($vars['var2'])) {
        $this->doAnotherAction($vars['var2']);
    }
} 
```

所以在运行时可以像这样调用该方法`$handler->handleAll($_POST)`。问题是存储在 $vars 数组中的变量必须命名为“var1”和“var2”等。这意味着处理代码与 html 表单元素的名称或获取 urls 中的变量（或者实际上是传入的任何数组）。

允许注入任何变量的数组使该方法变得灵活，这是必要的，因为它也是多态的。类继承此方法并使用它来调用它自己的操作。其结果是，从外部看，处理方法需要什么才能发挥作用并不明显。这意味着必须检查实现以找出它的作用（除非我将代码复制到 phpdoc 中，这将是愚蠢的）。

我不知道如何解决这个问题。将大量的 if/case 语句全部暴露在索引页面上（来自像这样的多个类）会导致代码非常混乱，因此最好将所有这些都封装在一个方法中。此外，将其作为类的方法来负责调用操作其自身状态的操作是有意义的（责任驱动设计）。我考虑过将每个变量作为方法的参数，但对于某些类，参数列表会非常大。这也意味着不能自动调用不同类的许多 handleAll() 方法，因为每次调用都需要显式注入所有参数，从而消除多态方面。

总而言之，我需要保持方法的多态性，但我需要某种方式将处理代码与来自 html 表单或 url 的用户输入解耦。在这样做时，也许还有一种方法可以将接口与实现分开。我很惊讶我已经找不到任何解决方案，这似乎是一个常见问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T23:47:24.703

我不确定您所描述的是否可以避免。

如果您的代码需要特定的参数 - 无论是包含某些值的数组形式还是其他形式 - 该函数将始终取决于正确填充的参数。

如果有`function foo($a, $b, $c)`，我将始终必须填写参数。如果它们来自 POST，那么我需要从 POST 中获取它们。即使函数`array('a' => ..., 'b' => ..., 'c' => ...)`取而代之，也是如此。

但是，如果您想将表单与参数列表分离，您可以使用一个简单的函数将 POST 数组转换为您的处理函数之一所期望的格式。不过，我真的看不出有什么原因，因为如果你不需要，为什么要增加额外的复杂性呢？

如果您希望更好地定义您的处理程序需要什么样的数组，您可以考虑让它需要一个对象。这种方法有时称为[参数对象](http://sourcemaking.com/refactoring/introduce-parameter-object)。

使用参数对象的好处是您可以轻松地在构造函数中设置必需的参数，并将设置器用于可选参数。任何使用您的代码的人都可以查看您对象的界面以查看需要哪些值。

如果您的处理程序使用的值实际上彼此相关，我会考虑创建一个实际的业务逻辑类型对象。使用 POST 中的数据创建它，并将处理值的代码移动到对象中的方法中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T00:19:07.240

解耦和自动化处理方法，也可能是缩小范围的痛苦方法。但是除了为所有事物创建处理程序之外，没有太多选择。但是，我想添加一些东西。允许默认值并支持变化

```
function handlePOST() {    }
function handleGET()  {    }
function handleArr()  {    } 
```

现在，这些函数可以代表它们保存函数的变化。

然而，在内部，除了对所有处理程序进行编码之外，它们并不是更好的方法。但是开关缩短了它们并使用单独的功能进行处理。

```
switch($_POST['var1']) {
    case "value1": callPostValue1(); break;
    default: callPostDefaultHandler(); break;
} 
```

# android - android模拟器是否足以进行调试？

> ID：10048429
> 
> 赞同：0
> 
> 时间：2012-04-06T19:40:31.790
> 
> 标签：android, debugging, dropbox, logcat, ddms

如果我只是在虚拟设备上使用 Logcat 和 DDMS 可以吗，还是我真的需要一部真正的手机来进行调试？我的意思是，Android 毕竟只是在虚拟机（Dalvik）上运行？

我只是使用保管箱，然后直接从我的开发保管箱文件夹安装我的 apk。这有道理吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:48:51.970

您可以在 VM 上进行所有您想要的测试，它可能会捕获 60-80% 的问题。不幸的是，它永远不会给您在真实设备上看到的相同结果。这是由于所有 Android 设备上的碎片和硬件造成的。由于对于大多数开发人员来说购买 100 多部测试手机是不合理的，因此您最好的选择是在您的应用程序中构建一种处理错误的强大方法，否则您将依赖开发人员控制台向您传递不理想的错误。此外，您在使用 3rd 方市场时不会收到任何错误反馈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:48:12.260

我认为你最好在真机上测试你的应用程序，因为在 VM 上找不到一些错误

# c++ - C++ - 映射迭代器访问导致段错误

> ID：10048435
> 
> 赞同：1
> 
> 时间：2012-04-06T19:41:07.263
> 
> 标签：c++, iterator, segmentation-fault

我试图完全重新提出这个问题。情况如下：

```
 class Departure {
    private :
      unsigned int supply;

    public : 
     Departure(int);
     ~Departure();
     int getSupply()  {
       return supply;
     };
};

class Route {
    private :
       Departure* departure;
    public :
       Departure& getDeparture() { 
          return *departure;
        };
};

class Plan {
    private :      
       std::map<Route*, double> quantities;
    public :
       void addRoute(Route& rt)  {
          quantities.insert(std::pair<Route*,double>(&rt,0));
        };

       void createSolution() {  
          std::map<Route*, double>::iterator it;    
          for(it = quantities.begin(); it != quantities.end(); ++it) {      
             it->second = it->first->getDeparture().getSupply();                        
           };
}; 
```

添加路线后 - 我已经检查过，它工作正常，我得到一个段错误，从我的试错到现在位于`it->first->getDeparture().getSupply()`调用中。任何解释为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:34:57.653

我猜（99% 肯定）你正面临一个悬空指针的问题，也就是说，当你调用 createSolution 时，指向 Route 和 Departure 对象的指针不再有效。

解决这个问题的简单方法是不使用指针，而是将 Route 和 Departure 对象存储为值。无论如何，将它们存储为指针并没有太大的好处，考虑到对象是如此之小......

# python - urllib：获取 utf-8 编码的站点源代码

> ID：10048438
> 
> 赞同：2
> 
> 时间：2012-04-06T19:41:43.983
> 
> 标签：python, encoding, urllib2, utf8-decode

我正在尝试获取某个网站的一部分。该脚本有效，但它是一个带有 á、é、í、ó、ú 等口音的网站。

当我使用 urllib 或 urllib2 获取站点时，站点源代码没有以 utf-8 编码，我希望它是这样的，因为 utf-8 支持这些重音符号。

我相信目标站点是用 utf-8 编码的，因为它包含以下元标记：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

我的python脚本：

```
opener = urllib2.build_opener()
opener.addheaders = [('Accept-Charset', 'utf-8')]
url_response = opener.open(url)
deal_html = url_response.read().decode('utf-8') 
```

但是，我不断得到看起来像是没有用 utf-8 编码的结果。

例如：网站上的“Milán” = urllib2 获取后的“Mil\xe1n”

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:56:47.723

您的脚本工作正常。`"\xe1"`字符串是`unicode`解码产生的对象的表示。例如：

```
>>> "Mil\xc3\xa1n".decode('utf-8')
u'Mil\xe1n' 
```

该`"\xc3\xa1"`序列是带有变音符号的字母 a 的[UTF-8](http://en.wikipedia.org/wiki/Utf-8)序列：á。

# windows-phone-7 - WP7 - 从代码中访问示例数据

> ID：10048439
> 
> 赞同：1
> 
> 时间：2012-04-06T19:41:46.963
> 
> 标签：windows-phone-7, datasource, expression-blend, sample-data

在表达式混合中，我在可视化编辑器中创建了一个示例数据源。如果使用列表框，我只需将集合拖到那里，数据就会自动显示。

现在，我有兴趣从代码后面的数据源中检索数据。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:00:44.630

有几种方法可以做到这一点，我会给你最简单的。我有一个与 ListBox 基本相同的 ListPicker：这是我的 ListPicker 标记：[还有一个链接](http://3water.wordpress.com/2010/07/25/listbox-on-wp7/)

```
 <toolkit:ListPicker  Name="lpDrag" Grid.Row="4" Grid.Column="1" Loaded="lptest_Loaded"            SelectedIndex="0">
                <toolkit:ListPicker.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{Binding name}"  />
                        </StackPanel>
                    </DataTemplate>
                </toolkit:ListPicker.ItemTemplate>
                <toolkit:ListPicker.FullModeItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" ></ColumnDefinition>
                                <ColumnDefinition ></ColumnDefinition>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="{Binding name}" FontSize="26" Grid.Column="0" Grid.Row="0"/>
                            <TextBlock Text="{Binding desc}"  TextWrapping="Wrap" FontSize="26" Grid.Column="1" Grid.Row="0"  />

                        </Grid>
                    </DataTemplate>
                </toolkit:ListPicker.FullModeItemTemplate>
            </toolkit:ListPicker> 
```

这是后面的代码：

```
 lpDrag.ItemsSource = //Whatever your datasource is 
```

# jquery - touchmove 防止默认/签名捕获在 Windows 平板电脑上不起作用

> ID：10048441
> 
> 赞同：1
> 
> 时间：2012-04-06T19:41:56.753
> 
> 标签：jquery, html, tablet, tablet-pc

我在这里有一个 Windows 平板电脑，正在为 Web 应用程序进行签名捕获。

在 ipad 和 droid 上你可以使用

```
$("body").on('touchmove', function (event) {
    event.preventDefault();
}); 
```

在您签名时将页面锁定到位。这不适用于 Windows 平板电脑。有任何想法吗？

*刚刚发现它可以通过按`F11`全屏在许多情况下工作。拥有非全屏解决方案仍然很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T20:27:20.750

Internet Explorer 不实现专有的 Apple 触摸事件。您还需要绑定到 MSPointerMove。

有关更多信息和示例，请参阅[IE10 和 Metro 风格应用程序的触控输入。](http://blogs.msdn.com/b/ie/archive/2011/09/20/touch-input-for-ie10-and-metro-style-apps.aspx)

# sql - 库存模式

> ID：10048442
> 
> 赞同：1
> 
> 时间：2012-04-06T19:42:05.543
> 
> 标签：sql, oracle

我在工作中使用 SQL 来收集信息，但没有什么太高级的（还）。

我需要确定库存进货和缺货的模式。

我有一张显示项目、位置、库存和日期的表格。我想看看随着时间的推移，物品/位置缺货和进货的时间是否有规律。该文件包含滚动的三周数据。如果某件商品在三周内持续进货或缺货，那么我需要了解它以进一步研究。

如果库存大于零，则项目/位置有库存。如果库存为零或负数，则项目/位置缺货。

感谢您的任何帮助。

样本数据

```
Item, location, inventory, date
1243, 10,       2,         3/12/2012
1243, 10,       0,         3/13/2012
1243, 10,      -2,         3/14/2012
1243, 10,      -2,         3/15/2012
1243, 10,       4,         3/16/2012 
```

然后附加项目、位置、库存、日期记录。

接受输出建议。我只需要查看商品/位置，以及在三周的数据中它在库存和缺货之间切换的次数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T20:04:01.403

像这样的东西可能是你正在寻找的东西。这将计算每个组合从“有货”到“缺货”的次数，`item`反之亦然`location`。请注意，每个`item`and的第一行`location`不能算作转换，因为我们不知道给定此逻辑的先前状态。

```
SELECT item,
       location,
       SUM( CASE WHEN status = 'In Stock' AND prior_status = 'Out of Stock'
                 THEN 1
                 ELSE 0
             END) moved_to_out_of_stock,
       SUM( CASE WHEN status = 'Out of Stock' AND prior_status = 'In Stock'
                 THEN 1
                 ELSE 0 
              END) moved_to_in_stock
  FROM (SELECT item, 
               location,
               status,
               lag( status ) over (partition by item, location
                                       order by dt) prior_status
          FROM (SELECT item, 
                       location, 
                       (case when inventory <= 0 
                             then 'Out of Stock'
                             else 'In Stock'
                         end) status,
                       dt
                  FROM your_table))
  GROUP BY item, location 
```

这表明在您发布的示例数据中，该项目一次从缺货变为有货，并从有货变为缺货一次。

```
SQL> ed
Wrote file afiedt.buf

  1  with your_table as (
  2    select 1243 item, 10 location, 2 inventory, date '2012-03-12' dt from dual union all
  3    select 1243, 10, 0, date '2012-03-13' from dual union all
  4    select 1243, 10, -2, date '2012-03-14' from dual union all
  5    select 1243, 10, -2, date '2012-03-15' from dual union all
  6    select 1243, 10, 4, date '2012-03-16' from dual
  7  )
  8  SELECT item,
  9         location,
 10         SUM( CASE WHEN status = 'In Stock' AND prior_status = 'Out of Stock'
 11                   THEN 1
 12                   ELSE 0
 13               END) moved_to_out_of_stock,
 14         SUM( CASE WHEN status = 'Out of Stock' AND prior_status = 'In Stock'
 15                   THEN 1
 16                   ELSE 0
 17                END) moved_to_in_stock
 18    FROM (SELECT item,
 19                 location,
 20                 status,
 21                 lag( status ) over (partition by item, location
 22                                         order by dt) prior_status
 23            FROM (SELECT item,
 24                         location,
 25                         (case when inventory <= 0
 26                               then 'Out of Stock'
 27                               else 'In Stock'
 28                           end) status,
 29                         dt
 30                    FROM your_table))
 31*   GROUP BY item, location
SQL> /

      ITEM   LOCATION MOVED_TO_OUT_OF_STOCK MOVED_TO_IN_STOCK
---------- ---------- --------------------- -----------------
      1243         10                     1                 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:04:51.417

```
SELECT Item
      ,location
      ,SUM(CASE WHEN inventory>0 THEN 1 END) AS INSTOCK
      ,SUM(CASE WHEN inventory<=0 THEN 1 END) AS OUTSTOCK
FROM TABLE
GROUP BY Item,location; 
```

# python - 进程不能在python多处理池中停止

> ID：10048447
> 
> 赞同：0
> 
> 时间：2012-04-06T19:42:27.380
> 
> 标签：python, multiprocessing, pool

我有一个使用 python 多处理的程序。我发现在主程序中创建的所有进程都可以完成，但是主程序总是在等待返回值并且不能停止。谁能给我一些关于如何解决这个问题的建议？

代码片段如下：

主程序：

```
workers = multiprocessing.Pool(4)
args = [arg1, arg2, arg3, arg4]
results = workers.map(subfunc, args)
print "we are in main functions " 
```

子函数(*arg)

```
# doing some other jobs
result = {.....} # a large dictionary
print 'done with sub functions'
return result # if I change it to  "return 1", it can finish successfully 
```

我可以看到在 main 中创建的所有进程的输出“使用子函数完成”，但没有输出“我们在 main 函数中”。有人可以帮我解决问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:46:59.453

子进程返回结果后`subfunc`，仍需要将结果拾取并通过进程间通信发送给主进程。所以他们在子进程实际上准备好终止之前打印“完成”。

您可以尝试返回`"fake"`以确保问题出在此，然后考虑如何在流程之间更快地传达结果。例如，根据列表的内容，您可以将内容打包成更紧凑的格式，或者共享内存是一个可行的选择。

# java - 在 JSP MVC 中加载 URL 时如何调用命令？

> ID：10048448
> 
> 赞同：0
> 
> 时间：2012-04-06T19:42:39.093
> 
> 标签：java, model-view-controller, jsp

我正在使用[此处](https://stackoverflow.com/a/3542297/363004)找到的设计模式。它有一个 FrontController、Command -> Service 和 Dao。

如果我在浏览器中加载此 URL（viewprofile 是 jsp 的名称）：

`http://localhost:8080/MyApplication/FrontController/viewprofile`

我不知道如何自动调用`ViewProfileCommand`然后显示用户的详细信息。

目前我拥有它的方式是这样的，为了调用`ViewProfileCommand`我必须将它连接到 URL 上，例如：`http://localhost:8080/MyApplication/FrontController/viewprofile?action=ViewProfile`。

如何将 jsp 映射到命令而不必将其连接到 URL？谢谢

**前端控制器：**

```
package com.secret.bookstore.servlet;

import java.io.IOException;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.secret.bookstore.command.Command;
import com.secret.bookstore.command.CommandFactory;
import com.secret.bookstore.exceptions.CommandCreationException;
import com.sun.net.httpserver.Filter.Chain;

/*
 * Front Controller (Mediator Pattern)
 */
@WebServlet(urlPatterns={"/FrontController"})
public class FrontController extends HttpServlet {

    /**
     * 
     */
    private static final long serialVersionUID = 1L;

    public FrontController(){
        super();
    }

    protected void service(HttpServletRequest request, HttpServletResponse response){
        String action = request.getParameter("action");

        CommandFactory commandFactory = CommandFactory.getInstance();
        Command command = null;
        String view = null;

        view = request.getPathInfo().substring(1);

        if(action != null){
            try {
                command = commandFactory.createCommand(action);
                view = command.execute(request, response);
            } catch(CommandCreationException e) {
                e.printStackTrace();
            }
        }

        forwardToPage(request, response, view);
    }

    /**
     * Forward to server to the supplied page
     */
    private void forwardToPage(HttpServletRequest request, HttpServletResponse response, String view){

        //Get the request dispatcher object and forward the request to the appropriate JSP page...
        if(view.equals(request.getPathInfo().substring(1))){
                RequestDispatcher dispatcher = request.getRequestDispatcher("/WEB-INF/" + view + ".jsp");

                try {
                    dispatcher.forward(request, response);
                } catch (ServletException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
        } else {
            try {
                response.sendRedirect(view);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T01:35:26.677

您已经设计了前端控制器来根据请求参数而不是请求路径信息来确定操作。所以你真的必须提供一个请求参数才能调用一个动作。

链接答案中的前端控制器示例根据请求方法和请求路径信息确定操作，这也是一种更明智的方式。您需要执行相同的操作才能实现能够预处理 GET 请求的功能要求。

基本上：

```
command = commandFactory.createCommand(request.getMethod(), request.getPathInfo()); 
```

或者就像在给定的例子中一样：

```
command = commandFactory.createCommand(request); 
```

# jquery - 使用 jQuery Load 从 asp.net webforms 调用 asp.net mvc

> ID：10048452
> 
> 赞同：0
> 
> 时间：2012-04-06T19:43:15.537
> 
> 标签：jquery, asp.net-mvc-2, webforms, jquery-load

我有两个站点，一个是用 asp.net webforms 编写的，另一个是用 asp.net mvc 2 编写的。我在 webforms 中有一个页面，它使用 jQuery Load 从两个项目中获取数据。

来自asp.net webforms页面的代码：

```
$("#divFeedsPorTagMVC").load('http://localhost:50001/InfoMVC/?tag=java', function (){});

$("#divFeedsPorTagWebForms").load('http://localhost:50000/InfoWebForms.aspx?tag=java', function () {}}); 
```

aspx 页面中的 div：

```
<div id="divFeedsPorTagWebForms" ></div>
<div id="divFeedsPorTagMVC" ></div> 
```

对 WebForms 的 jQuery 调用运行良好，并用我需要的 HTML 填充了“divFeedsPorTagWebForms”。
对 MVC2 的 jQuery 调用进入 InfoMVCController（调试模式）的 Index 函数，显示标签参数被很好地传递，但没有用它应该返回的 HTML 填充“divFeedsPorTagMVC”div。

有什么建议么？
谢谢。

**编辑** 控制器：

```
 public class InfoMVCController : Controller
    {
        private ServicioSORSS.ServicioSORSSClient _srvSORSS = new ServicioSORSSClient();

        //
        // GET: /InfoWebForms/

        public ActionResult Index(string tag)
        {
            return View(_srvSORSS.ObtenerFeedsPorTag(tag));
        }

    } 
```

如果我只是复制 URL 并将其粘贴到 Firefox 的导航栏中，它确实会返回我需要的所有数据！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:03:31.190

您遇到了[Same origin policy](http://en.wikipedia.org/wiki/Same_origin_policy)的问题。您的浏览器不允许加载，因为它来自不同的站点。

查看标准[$.ajax() 函数](http://api.jquery.com/jQuery.ajax/)，并将`jsonp`其用作数据类型。

它会是这样的：

```
$.ajax({
    type: "GET",
    url: "http://localhost:50001/InfoMVC/?tag=java",
    dataType: "jsonp",
    success: function(data){
        $('#divFeedsPorTagMVC').html(data);
    }
}); 
```

# javascript - 将图像附加到富文本编辑器在 IE 中不起作用

> ID：10048455
> 
> 赞同：0
> 
> 时间：2012-04-06T19:43:38.697
> 
> 标签：javascript, html, rich-text-editor

这就是我将图像附加到帖子的方式。它显示在除 IE 之外的所有浏览器中

```
<script type="text/javascript">
image = '<img src="http://forum.site.com/.../<?php echo $_SESSION['user_id']; ?>/question_reply_images/<?php echo $image_name; ?>" alt="<?php echo $alt; ?>" />';
document.getElementById('editor1').innerHTML += '<span style="width:100%; float:left;"' + image + '</span>';
window.location = '#reply_textbox';
</script> 
```

这是一个过程：用户在文本区域中写入文本（使用所见即所得编辑器——CKeditor）然后将选择一个文件并上传它。然后将其附加到文本区域的末尾。这甚至不会显示在 IE 中。图片正在上传，但不会显示在文本区域中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:46:51.780

如果“editor1”是 TEXTAREA，并且您将 IMAGE 标记**放入**其中，则无论如何这都是无效的 HTML。如果这是发生的事情，那么您很幸运该图像显示在任何浏览器中。确保 IMAGE 标记包含在旨在保存此类内容的元素中。

*附加信息*

如果您使用 W3C 验证器，或者搜索 TEXTAREA 的允许子项，您会发现它*不允许*在其中包含 img 或其他标签。除了你的其他问题，你应该对非 IE 浏览器显示图像感到惊讶，而不是因为 IE 没有而感到沮丧。

# c# - 向 ExpandoObject 添加与字符串同名的属性

> ID：10048470
> 
> 赞同：31
> 
> 时间：2012-04-06T19:44:32.753
> 
> 标签：c#, dynamic, expandoobject

有没有办法将属性添加到与字符串值同名的 ExpandoObject？

例如，如果我有：

```
string propName = "ProductNumber";
dynamic obj = new System.Dynamic.ExpandoObject(); 
```

我可以创建属性 ProductNumber，如：

```
obj.ProductNumber = 123; 
```

但是，我可以`obj.ProductNumber`根据字符串创建属性`propName`吗？因此，如果我不知道该属性的名称将是什么高级，我可以根据此输入创建它。如果 ExpandoObject 无法做到这一点，我应该研究 C# 的任何其他领域吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-04-06T19:45:59.517

ExpandoObject 实现`IDictionary<string, object>`：

```
((IDictionary<string, object>)obj)[propName] = propValue 
```

我不知道您是否可以将索引器语法与`dynamic`引用一起使用（即，不使用强制转换），但您当然可以尝试并找出答案。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-04-06T19:46:41.073

投射`ExpandoObject`到一个`IDictionary<string,object>`来做到这一点：

```
string propName = "ProductNumber";
dynamic obj = new System.Dynamic.ExpandoObject();
var dict = (IDictionary<string,object>)obj;
dict[propName] = 123; 
```

# c# - 如何使用多个控件使用相同的 ObjectDataSource，但使用不同的过滤器

> ID：10048472
> 
> 赞同：7
> 
> 时间：2012-04-06T19:44:34.470
> 
> 标签：c#, asp.net, c#-4.0, webforms

我在 ASP.Net WebForms 中进行优化。

就我而言，我有 2 个下拉菜单和一个网格。

我希望下拉列表充当网格的过滤器，每个下拉列表在网格的一列中包含不同的数据列表（用作过滤器）

很好..我让它工作了，但我不能再使用与网格相同的数据源作为下拉菜单，因为我正在对数据源应用过滤器表达式来过滤网格中的内容。

由于它与下拉列表相同的数据源，因此我在下拉列表中获得了一个较小的不同列表。

现在我可以使用多个数据源，每个数据源都使用相同的数据对象，但我在 Sql Profiler 中看到进行了 2 个数据调用，但我真的很想使用同一个，这样我就可以进行一个数据调用。

是否甚至可以为网格过滤单个 ObjectDataSource，同时为另一个控件提供未过滤的数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T05:00:08.707

如果您专注于不必进行多个 SQL 调用，一种选择是使用 LINQ`DataSet`在您的`SelectMethod`. 在语法上可能有一种更优雅的方法（我想不出来），但这应该使用单个`ObjectDataSource`.

如果您的`ObjectDataSource`声明如下所示：

```
<asp:ObjectDataSource ID="myObjectDataSource" runat="server" SelectMethod="myObjectDataSource_Select" OnFiltering="myObjectDataSource_Filtering"> 
```

在您的`SelectMethod`情况下，您可以执行以下操作：

```
public DataSet myObjectDataSource_Select()
{
   string sqlQuery = "SELECT col1, col2, col3 FROM foo";
   SqlDataAdapter da = new SqlDataAdapter(sqlQuery, myConnectionString);
   DataSet ds = new DataSet();
   using (da) {
        da.Fill(ds);
   }

   //Perform your secondary filtering here
   object [] unfilteredQuery= (from r in ds.Tables[0].AsEnumerable()
        select r.Field<string>(“col1”)).ToArray();
   myUnfilteredComboBox.Items.Clear();
   myUnfilteredComboBox.Items.AddRange(unfilteredQuery);

   return ds;    
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T04:48:14.237

你用的是linq吗？如果是，那应该是可能的：

```
// Loading complete data into object
var myCompleteDataSource = (from c in ctx select c).ToList();

// Filtering the already loaded data
var myFilteredDataSource = myCompleteDataSource.Where(o=>o.MyField=="abc").ToList(); 
```

然后只需将数据源设置为您的对象。

这将只从数据库加载一次数据（第`.ToList()`一种方法），并将对象列表过滤到第二个对象中，而无需再次访问数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T16:33:28.343

> 正如您所说，“由于它与下拉列表的数据源相同，因此我在下拉列表中获得了一个较小的不同列表。”

您可以将 保留`Database Information`在**[ViewState](http://msdn.microsoft.com/en-us/library/ms972976.aspx)**中。这样，您可以阻止 `Request to Database`您的客户请求。因此`Reducing the Access time`。

## 例子

```
public DataTable Employees
{
    get
    {
        if (ViewState["Employees"] == null)
        {
            return FollowsDAL.GetAllEmployees();
        }
        return (DataTable)ViewState["Employees"];
    }
    set
    {
        ViewState["Employees"] = value;
    }
} 
```

* * *

## 如何使`ViewState`数据过滤快速？

## 答案是 - 请不要使用`Update Panel`. 我会用`Page Method`.

请检查下面的示例。我`Update Panel`与`Script Manager`. ![在此处输入图像描述](../Images/d94de698711e75128a53deffa4d7dd77.png)

* * *

## 输出

![在此处输入图像描述](../Images/b9135a56ed68020dec360e8b6d9dcc47.png)

要显示 22 个字符的字符串，您可以检查正在接收和发送到服务器的数据量。想象一下

1.  如果您考虑使用更新面板将每个请求发送到数据库并且您的 GridView 在`Update Panel`!!!!!!
2.  如果您对每个请求使用**[ViewState](http://msdn.microsoft.com/en-us/library/ms972976.aspx)**`GridView`数据并在`Update Panel`.

根据我的理解，上述两种技术都是最差的。

* * *

现在我将向您描述**页面方法**

## 更新面板上的页面方法

`Page methods`允许`ASP.NET AJAX`页面直接执行 a `Page’s Static Methods`，使用`JSON (JavaScript Object Notation)`. 代替`posting back and then receiving HTML markup`to `completely replace our UpdatePanel’s contents`，我们可以使用 a`web method`只请求我们感兴趣的信息。

## 示例代码

![在此处输入图像描述](../Images/a4d71a9294855aa8fffd681f7a1fba2e.png) ![在此处输入图像描述](../Images/dd2cc483b0109155012fb34d5a5d9b39.png)

* * *

## 输出

![在此处输入图像描述](../Images/1f5d237f4f6ba9bded36dc3d062842f4.png)

* * *

所以结论是我肯定会使用`ViewState` **BUT** with `Page Methods`.

## ViewState 数据的过滤技术。

```
public static class GetFilteredData
{
    public static DataTable FilterDataTable(this DataTable Dt, 
                                                         string FilterExpression)
    {
        using (DataView Dv = new DataView(Dt))
        {
            Dv.RowFilter = FilterExpression;
            return Dv.ToTable();
        }
    }
} 
```

## 例子

```
DataTableObject.FilterDataTable("Search Expression") 
```

* * *

嗨 vpiTriumph... 我发现代码有所改进。以下是建议的方法。

## C Sharp 中的示例代码

```
private void DsataBaseInteraction()
{
    using (SqlConnection con = new SqlConnection("Your Connection String"))
    {
        using (SqlCommand cmd = new SqlCommand())
        {
            cmd.Connection = con;
            cmd.CommandType = System.Data.CommandType.StoredProcedure;
            cmd.CommandText = "Your Stored Procedure name";
            using (SqlDataReader DR = cmd.ExecuteReader())
            {

            }
        }
    }
} 
```

* * *

@KevinDeus - 我假设`Database`正在使用的是`SQL Server`. 所以下面提到的是我对`Stored Procedure`in的建议`Database`。

```
Create Proc ProcedureName
@UserName Varchar(50),
@Password Varchar(50),
@Email Varchar(50)
As
SET NOCOUNT ON
SET XACT_ABORT ON

Begin Try
    Begin Tran
        Insert into Account (Username,Password, Email)
        Values(@UserName, @Password, @Email)
    Commit Tran 
End Try

Begin Catch
    Rollback Tran
End Catch 
```

* * *

## 参考在**[这里](http://www.eggheadcafe.com/tutorials/asp-net/c67c4daa-83c2-4baa-aea4-2c8855527acb/aspnet-gridview-filtering-with-dropdownlist.aspx)**和**[这里](http://encosia.com/why-aspnet-ajax-updatepanels-are-dangerous)**

# javascript - 如何清除/删除 Knockout.js 中的可观察绑定？

> ID：10048485
> 
> 赞同：115
> 
> 时间：2012-04-06T19:46:42.650
> 
> 标签：javascript, knockout.js

我正在将功能构建到用户可以多次执行的网页上。通过用户的操作，一个对象/模型被创建并使用 ko.applyBindings() 应用到 HTML。

数据绑定的 HTML 是通过 jQuery 模板创建的。

到现在为止还挺好。

当我通过创建第二个对象/模型并调用 ko.applyBindings() 重复此步骤时，我遇到了两个问题：

1.  标记显示先前的对象/模型以及新的对象/模型。
2.  与对象/模型中的属性之一相关的 javascript 错误发生，尽管它仍呈现在标记中。

为了解决这个问题，在第一次通过后，我调用 jQuery 的 .empty() 来删除包含所有数据绑定属性的模板化 HTML，使其不再位于 DOM 中。当用户启动第二次传递的过程时，数据绑定的 HTML 将重新添加到 DOM。

但是就像我说的，当 HTML 重新添加到 DOM 并重新绑定到新的对象/模型时，它仍然包含来自第一个对象/模型的数据，并且我仍然得到没有发生的 JS 错误在第一关。

结论似乎是 Knockout 保留了这些绑定属性，即使标记已从 DOM 中删除。

所以我正在寻找的是一种从 Knockout 中删除这些绑定属性的方法；告诉淘汰赛不再有可观察的模型。有没有办法做到这一点？

**编辑**

基本流程是用户上传文件；然后服务器响应一个 JSON 对象，数据绑定的 HTML 被添加到 DOM，然后 JSON 对象模型被绑定到这个 HTML 使用

```
mn.AccountCreationModel = new AccountViewModel(jsonData.Account);
ko.applyBindings(mn.AccountCreationModel); 
```

一旦用户在模型上做出了一些选择，相同的对象就会被发送回服务器，数据绑定的 HTML 会从 DOM 中删除，然后我就有了以下 JS

```
mn.AccountCreationModel = null; 
```

当用户希望再次这样做时，重复所有这些步骤。

恐怕代码太“参与”了，无法进行 jsFiddle 演示。

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2012-04-06T22:00:20.820

您是否尝试过在 DOM 元素上调用 knockout 的 clean node 方法来处理内存中绑定的对象？

```
var element = $('#elementId')[0]; 
ko.cleanNode(element); 
```

然后使用您的新视图模型再次在该元素上应用剔除绑定将更新您的视图绑定。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-11-19T18:30:47.087

对于我正在处理的一个项目，我编写了一个简单的`ko.unapplyBindings`函数，它接受一个 jQuery 节点和删除布尔值。它首先取消绑定所有 jQuery 事件，因为`ko.cleanNode`方法没有处理这个问题。我已经测试了内存泄漏，它似乎工作得很好。

```
ko.unapplyBindings = function ($node, remove) {
    // unbind events
    $node.find("*").each(function () {
        $(this).unbind();
    });

    // Remove KO subscriptions and references
    if (remove) {
        ko.removeNode($node[0]);
    } else {
        ko.cleanNode($node[0]);
    }
}; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-07-23T07:45:59.930

您可以尝试使用敲除提供的 with 绑定：http: [//knockoutjs.com/documentation/with-binding.html](http://knockoutjs.com/documentation/with-binding.html) 这个想法是使用一次应用绑定，并且每当您的数据更改时，只需更新您的模型。

假设您有一个顶级视图模型 storeViewModel，您的购物车由 cartViewModel 表示，以及该购物车中的项目列表 - 比如说 cartItemsViewModel。

您将顶级模型 - storeViewModel 绑定到整个页面。然后，您可以将页面中负责购物车或购物车项目的部分分开。

让我们假设 cartItemsViewModel 具有以下结构：

```
var actualCartItemsModel = { CartItems: [
  { ItemName: "FirstItem", Price: 12 }, 
  { ItemName: "SecondItem", Price: 10 }
] } 
```

cartItemsViewModel 一开始可以为空。

步骤如下所示：

1.  在 html 中定义绑定。分离 cartItemsViewModel 绑定。

    ```
      <div data-bind="with: cartItemsViewModel">
          <div data-bind="foreach: CartItems">
            <span data-bind="text: ItemName"></span>
            <span data-bind="text: Price"></span>
          </div>
        </div> 

    ```

2.  商店模型来自您的服务器（或以任何其他方式创建）。

    `var storeViewModel = ko.mapping.fromJS(modelFromServer)`

3.  在顶层视图模型上定义空模型。然后可以使用实际数据更新该模型的结构。

    ```
      storeViewModel.cartItemsViewModel = ko.observable();
        storeViewModel.cartViewModel = ko.observable(); 

    ```

4.  绑定顶级视图模型。

    `ko.applyBindings(storeViewModel);`

5.  当 cartItemsViewModel 对象可用时，将其分配给先前定义的占位符。

    `storeViewModel.cartItemsViewModel(actualCartItemsModel);`

如果您想清除购物车物品： `storeViewModel.cartItemsViewModel(null);`

Knockout 将处理 html - 即它会在模型​​不为空时出现，并且 div 的内容（具有“绑定”的那个）将消失。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-01-16T06:14:51.513

每次单击搜索按钮时，我都必须调用 ko.applyBinding，过滤后的数据将从服务器返回，在这种情况下，我无需使用 ko.cleanNode 即可完成以下工作。

我经历过，如果我们用模板替换 foreach，那么它在 collections/observableArray 的情况下应该可以正常工作。

您可能会发现此方案很有用。

```
<ul data-bind="template: { name: 'template', foreach: Events }"></ul>

<script id="template" type="text/html">
    <li><span data-bind="text: Name"></span></li>
</script> 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-01-03T07:47:44.353

与其使用 KO 的内部函数并处理 JQuery 的一揽子事件处理程序删除，一个更好的想法是使用`with`或`template`绑定。当您这样做时，ko 会重新创建 DOM 的该部分，因此它会自动被清理。这也是推荐的方式，请参见此处：[https](https://stackoverflow.com/a/15069509/207661) ://stackoverflow.com/a/15069509/207661 。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-10-22T05:23:55.773

我认为最好始终保持绑定，并简单地更新与之关联的数据。我遇到了这个问题，发现只使用`.resetAll()`我保存数据的数组上的方法调用是最有效的方法。

基本上你可以从一些包含要通过 ViewModel 呈现的数据的全局变量开始：

```
var myLiveData = ko.observableArray(); 
```

我花了一段时间才意识到我不能只制作`myLiveData`一个普通的数组——这`ko.oberservableArray`部分很重要。

然后你可以继续做任何你想做的事`myLiveData`。例如，`$.getJSON`拨打电话：

```
$.getJSON("http://foo.bar/data.json?callback=?", function(data) {
    myLiveData.removeAll();
    /* parse the JSON data however you want, get it into myLiveData, as below */
    myLiveData.push(data[0].foo);
    myLiveData.push(data[4].bar);
}); 
```

完成此操作后，您可以继续使用 ViewModel 像往常一样应用绑定：

```
function MyViewModel() {
    var self = this;
    self.myData = myLiveData;
};
ko.applyBindings(new MyViewModel()); 
```

然后在 HTML 中`myData`像往常一样使用。

这样，您就可以从任何函数中使用 myLiveData。例如，如果您想每隔几秒钟更新一次，只需将该`$.getJSON`行包装在一个函数中并调用`setInterval`它。只要您记得保留`myLiveData.removeAll();`线路，您就永远不需要删除绑定。

除非您的数据真的很大，否则用户甚至无法注意到重置数组和添加最新数据之间的时间。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-05-01T15:44:07.970

我最近遇到了内存泄漏问题，并且`ko.cleanNode(element);`不会为我这样做 -`ko.removeNode(element);`确实如此。[Javascript + Knockout.js 内存泄漏 - 如何确保对象被销毁？](https://stackoverflow.com/questions/23409499/javascript-knockout-js-memory-leak-how-to-make-sure-object-is-being-destroye/23410899#23410899)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-05-12T15:35:55.733

你有没有想过这个：

```
try {
    ko.applyBindings(PersonListViewModel);
}
catch (err) {
    console.log(err.message);
} 
```

我想出了这个是因为在 Knockout 中，我找到了这段代码

```
 var alreadyBound = ko.utils.domData.get(node, boundElementDomDataKey);
    if (!sourceBindings) {
        if (alreadyBound) {
            throw Error("You cannot apply bindings multiple times to the same element.");
        }
        ko.utils.domData.set(node, boundElementDomDataKey, true);
    } 
```

所以对我来说，这并不是一个已经绑定的问题，而是错误没有被捕获和处理......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-03T15:43:14.947

我发现如果视图模型包含许多 div 绑定，最好的清除方法`ko.applyBindings(new someModelView);`是使用：`ko.cleanNode($("body")[0]);`这允许您动态调用新`ko.applyBindings(new someModelView2);`的，而不必担心之前的视图模型仍然被绑定。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-06-23T12:07:53.267

```
 <div id="books">
                <ul data-bind="foreach: booksImReading">
                    <li data-bind="text: name"></li>
                </ul>
            </div>

            var bookModel = {
                booksImReading: [
                    { name: "Effective Akka" }, 
                    { name: "Node.js the Right Way" }]
            };

            ko.applyBindings(bookModel, el);

            var bookModel2 = {
                booksImReading: [
                    { name: "SQL Performance Explained" },
                    { name: "Code Connected" }]
            };

            ko.cleanNode(books);
            ko.applyBindings(bookModel2, books); 
```

# codeigniter - Codeigniter 2.1 switch_uri() 和 i18n 语言库

> ID：10048488
> 
> 赞同：2
> 
> 时间：2012-04-06T19:46:53.470
> 
> 标签：codeigniter, internationalization

我正在使用 Codeigniter 2.1 构建我的应用程序，并且正在使用 i18n 多语言库，一切正常。唯一的问题是我翻译当前页面时，没关系，但是当我更改页面时，它会以默认语言返回。例子：

> myapp.com/en/home
> 
> 点击锚点（switch_uri（'de'））
> 
> myapp.com/de/home
> 
> 现在跟随链接到另一个控制器，它回到默认语言
> 
> myapp.com/en/about

那么如何修复它，当我切换控制器时，语言保持最后选择，而不是默认语言？

提前致谢。:)

编辑：

这些是我更改页面语言的锚点。我想我可能会使用某种 cookie 来保存用户的语言并在每次下一次控制器加载时获取它，但我相信还有更简单和容易的东西。

```
<ul id="languages">
    <li><a href="<?= base_url($this->lang->switch_uri('bg')) ?>" class="lang-bg"></a></li>
    <li><a href="<?= base_url($this->lang->switch_uri('en')) ?>" class="lang-en"></a></li>
</ul> 
```

在主菜单中有我指向其他页面的链接：

```
<li>
    <?= anchor(base_url('about'), 'about') ?>
</li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T18:36:42.270

好的，我可以看到问题出在您使用 base_url() 的链接中。在没有 base_url() 的情况下尝试这样的链接。

```
<?php echo anchor('about/index/', 'About'); ?> 
```

# asp.net-mvc-3 - Autofac 2.5 的属性注入

> ID：10048494
> 
> 赞同：2
> 
> 时间：2012-04-06T19:47:31.287
> 
> 标签：asp.net-mvc-3, autofac

如何在 Autofac 2.5 中启用属性注入，以便自动设置我的公共 ILogger Log 属性？

我正在使用以下方法在 Autofac 2.4 的 MVC3 项目中启用属性注入

```
public class InjectPropertiesByDefaultModule : Autofac.Module
{
    protected override void AttachToComponentRegistration (IComponentRegistry componentRegistry, IComponentRegistration registration)
    {
        registration.Activating += (s, e) =>
        {
            e.Context.InjectProperties (e.Instance);
        };
    }
}

builder.RegisterModule<InjectPropertiesByDefaultModule> (); 
```

但这似乎不再适用于 Autofac 2.5。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T11:57:11.150

您现在可以`PropertiesAutowired`在注册上使用该方法来指示应该执行属性注入。

```
var builder = new ContainerBuilder();
builder.RegisterType<Foo>().PropertiesAutowired(); 
```

要为特定程序集中的所有对象设置此项，您可以将 PropertiesAutowired 与 Autofacs RegisterAssemblyTypes 一起使用：

```
var builder = new ContainerBuilder();
builder.RegisterAssemblyTypes(typeof(Foo).Assembly)
    .PropertiesAutowired(); 
```

# c# - RDLC 报告 Windows 应用程序 (VB.NET) 中的小问题

> ID：10048495
> 
> 赞同：0
> 
> 时间：2012-04-06T19:47:36.693
> 
> 标签：c#, winforms, reporting-services, rdlc, vb.net-2010

我在创建 RDLC 报告时遇到错误，该报告参数 rpP 缺少一个值（请参阅附件图像）。我已经检查了 rpP & rpP 有来自数据库的值。

尽管当我（手动）单击刷新按钮时，它会正确显示所有数据。在调试参数时，rpP 已被赋值。但我不知道为什么它显示此错误。

代码：

```
 For Each drBody As DataRow In ds.Tables(0).Rows
            pName1 = CType(drBody("Name"), String)
            Me.ReportViewer1.LocalReport.Refresh()
            'ReportViewer1.LocalReport.ReportPath = Application.ExecutablePath
            Dim PICpATH As String = CType(drBody("ImagePath"), String)
            Dim passport As String = CType(drBody("PassportNo"), String)
            Dim arrParam(22) As ReportParameter
            arrParam(0) = New ReportParameter("rp", pName1.ToString(), True)
            **arrParam(1) = New ReportParameter("rpP", passport, True)**
            arrParam(2) = New ReportParameter("rpSocIncNo", CType(drBody("SocIncNo"), String), True)
            arrParam(3) = New ReportParameter("rpMartialStstus", CType(drBody("MartialStstus"), String), True)
            arrParam(4) = New ReportParameter("rpChildren", CType(drBody("Children"), String), True)
            arrParam(5) = New ReportParameter("rpChildrenAges", CType(drBody("ChildrenAges"), String), True)
            arrParam(6) = New ReportParameter("rpEmploymentDate", CType(drBody("EmploymentDate"), String), True)
            arrParam(7) = New ReportParameter("rpOccupation_Full", CType(drBody("Occupation_Full"), String), True)
            arrParam(8) = New ReportParameter("rpDepartment", CType(drBody("Department"), String), True)
            arrParam(9) = New ReportParameter("rpPosition", CType(drBody("Position"), String), True)
            arrParam(10) = New ReportParameter("rpJobDescription", CType(drBody("JobDescription"), String), True)
            arrParam(11) = New ReportParameter("rpLandline", CType(drBody("Landline"), String), True)
            arrParam(12) = New ReportParameter("rpMobile", CType(drBody("Mobile"), String), True)
            arrParam(13) = New ReportParameter("rpStreet", CType(drBody("Street"), String), True)
            arrParam(14) = New ReportParameter("rpDistrict", CType(drBody("District"), String), True)
            arrParam(15) = New ReportParameter("rpTown", CType(drBody("Town"), String), True)
            arrParam(16) = New ReportParameter("rpPostalCode", CType(drBody("PostalCode"), String), True)
            arrParam(17) = New ReportParameter("rpInsurance", CType(drBody("Insurance"), String), True)
            arrParam(18) = New ReportParameter("rpStart", CType(drBody("Start"), String), True)
            arrParam(19) = New ReportParameter("rpEndDate", CType(drBody("EndDate"), String), True)
            arrParam(20) = New ReportParameter("rpDisablilities", CType(drBody("Disablilities"), String), True)
            arrParam(21) = New ReportParameter("rpdob", CType(drBody("DoB"), String), True)
            arrParam(22) = New ReportParameter("rpNationality", CType(drBody("Nationality"), String), True)
            Me.ReportViewer1.LocalReport.SetParameters(New ReportParameter() {arrParam(0), arrParam(1), arrParam(2), arrParam(3), arrParam(4), arrParam(5), arrParam(6), arrParam(7), arrParam(8), arrParam(9), arrParam(10), arrParam(11), arrParam(12), arrParam(13), arrParam(14), arrParam(15), arrParam(16), arrParam(17), arrParam(18), arrParam(19), arrParam(20), arrParam(21), arrParam(22)})
        Next
        ReportViewer1.LocalReport.DataSources.Clear()
        ReportViewer1.LocalReport.DataSources.Add(rds)
        Me.ReportViewer1.LocalReport.Refresh() 
```

[http://i.stack.imgur.com/Ebfmv.png](http://i.stack.imgur.com/Ebfmv.png)

另外，我如何导出到 EXCEL 文件或在 Excel 文件中打印。

谢谢

# jquery - ajax jquery 表单验证总是验证错误

> ID：10048497
> 
> 赞同：0
> 
> 时间：2012-04-06T19:47:51.443
> 
> 标签：jquery, ajax, validation

我正在尝试根据数据库值创建一个特殊的邮政编码验证。因此，我正在通过 ajax 检查值：

```
jQuery.validator.addMethod("validate_country_from", function(value, element) 
{
   $.ajax({
      type: "POST",
      url: "ajax.php",
      data: "action=validate_countryzip&direction=1&zip=" + 
         escape(document.getElementById("zip_from").value) + "&country=" + 
         escape(document.getElementById("country_from").value),
      async: false
   }).done(function(msg)
   {
      if(msg == "true")
      {
         return true;
      }
      else
      {
         return false;
      }
   });
}, addressError); 
```

我通过这些规则在规则中分配功能：

```
zip_from: {
   required: true,
   validate_country_from: true
},
country_from: {
   required: true,
   validate_country_from: true
}, 
```

ajax 请求工作正常，它是同步完成的，返回的值也是正确的，但我的验证仍然告诉我这两个字段有错误。

我希望有人能帮帮忙...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:07:14.270

我认为你在那里混合了你的 jQuery AJAX 方法。以前见过`done()`用过，以后`get()`没用过`ajax()`。尝试

```
jQuery.validator.addMethod("validate_country_from", function(value, element) 
{
   $.ajax({
      type: "POST",
      url: "ajax.php",
      data: "action=validate_countryzip&direction=1&zip=" + 
         escape(document.getElementById("zip_from").value) + "&country=" + 
         escape(document.getElementById("country_from").value),
      async: false,
      success: function(msg){
          if(msg == "true")
          {
              return true;
          }
          else
          {
              return false;
          }
      },
      error: function(x, s, e){
          return false;
      }
   });
}, addressError); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T20:39:53.247

谢谢你的回答，但我找到了原因：我的“完成”函数正在向 ajax 请求操作返回一个值，而不是向验证方法返回一个值（匿名代表很棒，但有时真的很混乱）。

正确的版本是这样的：

```
jQuery.validator.addMethod("validate_country_from", function(value, element) 
{
   var test = $.ajax({
      type: "POST",
      url: "ajax.php",
      data: "action=validate_countryzip&direction=1&zip=" + 
         escape(document.getElementById("zip_from").value) + "&country=" + 
         escape(document.getElementById("country_from").value),
      async: false
   }).done(function(msg)
   {
   });

   if(test.responseText == "true")
   {
      return true;
   }
   else
   {
      return false;
   }
}, addressError); 
```

但是，这不是最终解决方案，因为它没有捕获任何错误等等。

# java - 在 Java 中发布 XML 并获取响应代码

> ID：10048502
> 
> 赞同：0
> 
> 时间：2012-04-06T19:48:18.227
> 
> 标签：java, xml, post

我需要将 XML 数据发送到 URL。XML 数据包含在字符串缓冲区中。我需要发布它并获取响应代码。

谁能告诉我该怎么做？

我有一段代码，但 Eclipse 说它已弃用

```
PostMethod postMethod = new PostMethod(URL);
InputStream stream = new StringBufferInputStream(command);
                postMethod.setRequestBody(stream); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:54:02.140

[Javadoc](http://hc.apache.org/httpclient-3.x/apidocs/org/apache/commons/httpclient/methods/EntityEnclosingMethod.html#setRequestBody%28java.io.InputStream%29)说要改用[setRequestEntity(RequestEntity)](http://hc.apache.org/httpclient-3.x/apidocs/org/apache/commons/httpclient/methods/EntityEnclosingMethod.html#setRequestEntity%28org.apache.commons.httpclient.methods.RequestEntity%29)。

# matlab - 使用matlab条件生成随机数

> ID：10048503
> 
> 赞同：0
> 
> 时间：2012-04-06T19:48:21.650
> 
> 标签：matlab, random

我有一个使用 normrnd 生成具有正态分布的正态随机数矩阵的函数。

```
 values(vvvv)= normrnd(0,0.2); 
```

第1轮的输出是：ans =

```
0.0210    0.1445    0.5171   -0.1334    0.0375   -0.0165       Inf   -0.3866   -0.0878   -0.3589 
```

第 2 轮的输出是：ans =

```
0.0667    0.0783    0.0903   -0.0261    0.0367   -0.0952    0.1724   -0.2723       Inf       Inf 
```

第 3 轮的输出是：ans =

```
0.4047   -0.4517    0.4459    0.0675    0.2000   -0.3328   -0.1180   -0.0556    0.0845       Inf 
```

该功能将重复 20 次。

很明显，该函数是完全随机的。我寻求的是添加一个条件。

我需要的是：如果任何条目的值介于 0.2 和 0.3 之间。该值将在下一轮中确定。只有剩余的条目将使用函数 rand 进行更改。

我找到了 rng(sd)，它使用非负整数 sd 为随机数生成器提供种子，以便 rand、randi 和 randn 产生可预测的数字序列。

[如何为伪随机数生成器设置自定义种子](https://stackoverflow.com/questions/4682080/how-to-set-custom-seed-for-pseudo-random-number-generator)

但是如何使矩阵的几个条目只生效！

另一个问题：似乎 rng 不适用于 matlab r2009 如何在不输入概率和统计的复杂性的情况下获得类似的东西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:56:08.660

您可以比实际生成所有这些矩阵更直接地做到这一点，而且通过考虑最终输出的分布，这很容易做到。

由 N(0, .2) 分布的随机变量位于 .2 和 .3 之间的概率是 p ~= .092。

调用矩阵 X 的最终输出的随机变量，在其中执行 n (20) 次。然后要么（a）X 位于 0.2 和 0.3 之间并且你提前停止，要么（b）你在前 n-1 次抽签中没有抽到 0.2 和 0.3 之间的数字，所以你选择了你得到的任何东西第n次抽奖。

(b) 发生的概率就是 b=(1-p)^(n-1)：在 [.2, .3] 之外绘制的独立事件，概率为 1-p，发生 n-1 次。因此 (a) 的概率是 1-b。

如果 (b) 发生了，您只需从中抽取一个数字`normrnd`。如果 (a) 发生了，您需要一个正常变量的值，条件是它在 .2 和 .3 之间。一种方法是找到 .2 和 .3 的 cdf 值，从它们之间的范围均匀绘制，然后使用逆 cdf 取回原始数字。

执行此操作的代码：

```
mu = 0;
sigma = .2;
upper = .3;
lower = .2;
n = 20;
sz = 15;

cdf_upper = normcdf(upper, mu, sigma);
cdf_lower = normcdf(lower, mu, sigma);
p = cdf_upper - cdf_lower;
b = (1-p) ^ (n - 1);

results = zeros(sz, sz);
mask = rand(sz, sz) > b; % mask value 1 means case (a), 0 means case (b)
num_a = sum(mask(:));

cdf_vals = rand(num_a, 1) * p + cdf_lower;
results(mask) = norminv(cdf_vals, mu, sigma);

results(~mask) = normrnd(mu, sigma, sz^2 - num_a, 1); 
```

* * *

如果您出于某种原因想直接模拟这个（这将涉及很多浪费的努力，但显然您不喜欢“统计的复杂性”——顺便说一下，这是概率，而不是统计），你可以生成第一个矩阵，然后仅替换不属于您所需范围的元素。例如：

```
mu = 0;
sigma = .2;
n = 10;
m = 10;
num_runs = 20;
lower = .2;
upper = .3;

result = normrnd(mu, sigma, n, m);
for i = 1 : (num_runs - 1)
    to_replace = (result < lower) | (result > upper);
    result(to_replace) = normrnd(mu, sigma, sum(to_replace(:)), 1);
end 
```

* * *

为了证明这些是相同的，这里是对 1x1 矩阵执行 100,000 次的经验 CDF 图。（也就是说，我运行了这两个函数 100k 次并保存了结果，然后用于`cdfplot`绘制 x 轴上的值与小于 y 轴上获得的值的部分。）

![](../Images/3b12bf34144818bd4765c777b10b33f0.png)

它们是相同的。（实际上，分布同一性的[KS 检验](http://en.wikipedia.org/wiki/K-S_Test)给出的 p 值为 0.71。）但直接的方法是运行速度更快。

# javascript - 在 Javascript 中清除 Var 或 Callback

> ID：10048504
> 
> 赞同：1
> 
> 时间：2012-04-06T19:48:26.097
> 
> 标签：javascript, jquery, callback

抱歉，我不确定我问的问题是否正确。当用户更改日期时，页面上的日期倒计时会更改。如果日期更改不止一次，它会闪烁所有日期更改。我猜它是在某处存储以前的信息。我试过清除变量。

```
var deal_yeax = ''; 
```

就像我在没有运气的情况下在 php 中所做的那样

```
$('#deal_end').focusout(function() {
var deal_end = $("#deal_end").val();
var array = deal_end .split('-');
var deal_montx = array[0];
var deal_dax = array[1];
var deal_yeax = array[2];

    deal_montx = deal_montx - 1;

    $(function(){
    ts = new Date(deal_yeax ,  deal_montx  ,  deal_dax  );
    $(".h").countdown({
    timestamp   : ts,
    callback    : function(days, hours, minutes, seconds){
    message_days = (days);
    var message_hours = (hours);
    $(".message_hours").text(message_hours + " Hours");
    var message_minutes = (minutes);
    $(".message_minutes").text(message_minutes + " Minutes");
    var message_seconds = (seconds);
        // Creat the display
        if ( message_days < 1 && message_hours < 1 ) { $(".message_seconds").text(message_seconds  + " Seconds"); }
        else if ( message_days < 1 && message_hours > 1 ) {  }
        else if ( message_days == 1 ) { $(".message_days").text(message_days + " Day"); }
        else { $(".message_days").text(message_days + " Days"); }

        if ( message_days < 1 && message_hours < 1 && message_minutes < 1 && seconds < 1 ) {
        $(".hide_my_buy_button").fadeOut("fast"); 
        }
    }
});
});
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:37:43.527

每次您从 中“聚焦”时`#deal_end`，您都会将一个`countdown`事件附加到`.h`. 在不确切知道如何`countdown(...)`工作的情况下（如果您提供源代码会很好，这样我们可以提供更多帮助！），解决问题的一种方法可能是使用 JQuery 的`unbind(...)`函数来删除事件上的现有侦听器，然后再添加新的侦听器.

这是一个关于这个问题的例子：

```
<!-- HTML -->
<div>
    <input id="text" />
    <button id="clicker" />
</div>

<!-- Javascript -->
$('#text').focusout(function() {
    var text = this.value;

    // Everytime #text is "focused out", a new event is registered with #clicker.
    $('#clicker').click(function() {
        console.log('Value: ' + text);
    });
}); 
```

...这是解决问题的方法（这只是众多方法中的一种。这种方法可能不是最优雅的，但无论如何。）

```
$('#text').focusout(function() {
    var text = this.value;

    $('#clicker').unbind('click');
    // Everytime #text is "focused out", a new event is registered with #clicker.
    $('#clicker').click(function() {
        console.log('Value: ' + text);
    });
}); 
```

底线：似乎 focusout(...)`countdown`每次触发时都会添加一个新的。这可能是你遇到的问题。

不确定这是否有帮助？让我知道。

PS JSFiddle 与之配套：http: [//jsfiddle.net/PE9eW/](http://jsfiddle.net/PE9eW/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:24:55.987

问题似乎在于您在代码中使用的 .countdown 函数来刷新日期更改。当您为 $(".h") 分配一个新的倒计时对象时，插件或函数可能会为其分配一些事件处理程序或间隔，但是当再次调用它时似乎并没有清除旧的，那就是为什么它会闪烁每个倒计时的所有日期。所以你必须手动完成。我不确定您是使用外部插件还是您自己的函数，但您需要做的是在调用函数时清除分配给您的元素的现有事件或间隔。如果您告诉我您正在使用哪个插件，或者如果它是您自己的函数，可能会显示代码，我会更有帮助。（指 .countdown() ）

# iphone - Cydia SBSettings“释放内存”？

> ID：10048505
> 
> 赞同：0
> 
> 时间：2012-04-06T19:48:36.223
> 
> 标签：iphone, objective-c, ios, ios5, cydia

有谁知道如何将 SBSettings“释放内存”添加到他们的应用程序中？我正在 iOS5 中开发一个应用程序，而 ARC 似乎并没有像我希望的那样频繁地释放内存。

如何使用 Objective-C 在他们的应用程序中编写该功能？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T20:26:02.030

ARC 在应该释放对象时释放它们。这不是释放所有内存的解决方案，因为您分配了太多。我的建议是你改变你的应用程序以提高效率。

# cassandra - Cassandra (Pycassa/CQL) 返回部分匹配

> ID：10048506
> 
> 赞同：4
> 
> 时间：2012-04-06T19:48:45.673
> 
> 标签：cassandra, cql, pycassa

我正在尝试通过 Cassandra 中的列族进行部分搜索，类似于 SQL 查询，例如：SELECT * FROM columnfamily WHERE col = 'val*' 其中 val* 表示至少匹配前三个字符 'val' 的任何值。

我已经阅读了有关 SELECT 函数[的 datastax 文档](http://www.datastax.com/docs/1.0/references/cql/SELECT)，但似乎找不到对部分 WHERE 标准的任何支持。有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-07T16:56:18.043

Cassandra 中没有像这样的通配符支持，但是您可以以这样的方式对数据进行建模，以便获得相同的最终结果。

您将获取要对其执行此查询的列，并将其非规范化为第二个列族。此 CF 将有一个宽行，列名作为`col`您要对其进行通配符查询的值。此 CF 的列值可以是原始 CF 的行键，也可以是原始行的其他表示形式。

然后，您将使用切片来获取您关心的值。例如，如果这是要切片的宽行：

```
 +---------+----------+--------+----------+---------+--------+----------+
 |  RowKey | aardvark | abacus | abacuses | abandon | accent | accident |
 |         +----------+--------+----------+---------+--------+----------+
 |         |          |        |          |         |        |          |
 |         |          |        |          |         |        |          |
 +---------+----------+-----------------------------+--------+----------+ 
```

使用 CQL，您可以使用以下查询*选择以 'aba*' 开头的所有内容：

```
 SELECT 'aba'..'abb' from some_cf where RowKey = some_row_key; 
```

这将为您提供“算盘”、“算盘”和“放弃”的列。

使用此策略需要注意一些事项：

*   在上面的例子中，如果你有相同的 column_name 的东西，你需要有一些方法来区分它们（否则插入宽列族会破坏其他有效值）。您可以做到这一点的一种方法是使用 : 的复合`word`列`some_unique_value`。
*   上述模型只允许字符串末尾的通配符。字符串开头的通配符也可以通过一些修改轻松处理。字符串中间的通配符将更具挑战性。

请记住，Cassandra 并没有为您提供进行临时查询的简单方法。相反，您需要弄清楚您将如何使用数据并相应地为您的 CF 建模。请查看 Ed Anuff 的这篇关于[在 Cassandra 中索引数据的](http://www.anuff.com/2011/02/indexing-in-cassandra.html)博客文章，了解有关此类数据建模的更多信息。

*请注意，用于切片列的 CQL 语法在即将发布的 Cassandra 中发生了变化。

# ios - 需要状态栏中的小活动指示器，类似于 WhatsApp

> ID：10048511
> 
> 赞同：1
> 
> 时间：2012-04-06T19:49:14.030
> 
> 标签：ios

我需要状态栏中显示的小活动指示器（网络进度）。我会将这个添加到视图中。

它就像 WhatsApp 中的那个，他们用它来发送消息，你可以在小气泡中看到它。

我怎样才能提取它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:27:44.317

如前所述，您正在寻找的是 UIActivityIndi​​catorView。活动指示器具有指示器样式的属性。这可以设置为大白、小白或灰色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T08:42:41.637

您正在寻找的`networkActivityIndicatorVisible`是`UIApplication`

从文档：

> 指定`YES`应用程序是否应显示网络活动以及`NO`是否不应显示。默认值为`NO`。状态栏中的旋转指示器显示网络活动。应用程序可以显式隐藏或显示此指示器。

# vb.net - 在 VB.NET 中强制类型别名

> ID：10048518
> 
> 赞同：2
> 
> 时间：2012-04-06T19:49:49.287
> 
> 标签：vb.net, declarative, type-alias

如何在 VB.NET 或 C# 中对类型进行别名处理，以便当别名用作函数中的参数类型时，意外使用未别名类型是错误的？

IE

```
Imports AccessSpecifier = System.String

Module Accessors
    Delegate Function IoOper(ByRef strm As System.IO.Stream) As Action
    Public Function accessMethod(ByRef spec As AccessSpecifier) As IoOper
        ' implementation
        ' ...
    End Function
End Module

Module Main
    Public Sub Main()
        Dim spec As AccessSpecifier = New AccessSpecifier(CType("READ_WRITE", Char()))
        Dim val = Accessors.accessMethod(spec)
        System.Console.WriteLine(val.GetType())
        Dim shouldFail = Accessors.accessMethod("FAIL_ME")
        System.Console.WriteLine(shouldFail.GetType())
    End Sub
End Module 
```

或者也许有更好的方法来解决这个问题？

总的来说，我希望 IDE 强制我知道我在做什么，如果我`Ints`到处乱说意味着`Flag`s，或者`State`s 和`Strings`周围意味着`Name`s，`Property`s 和`Record`s。

帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T23:17:59.297

我从不喜欢 .NET 中的类型别名。它会导致代码不精确，并且无法立即清楚发生了什么。就像在您的示例中一样，当一个人去寻找 AccessSpecifier.vb 文件（或类）时，他们找不到它。

此外，别名仅适用于您的项目，并且仅适用于单个代码文件。因此，您必须在要使用它的所有各种代码文件中定义该别名。

一个更好的（如更容易阅读、更容易维护和更清晰的意图）选项是创建一个类并重载类型转换运算符以自动转换为 String 或从 String 转换。通过这种方式，您保留了使用新类的能力，就好像它是一个字符串一样，但您获得了严格的类型检查。

# php - Google 不喜欢我的 WAMP 服务器。有人有想法么？

> ID：10048519
> 
> 赞同：0
> 
> 时间：2012-04-06T19:49:57.343
> 
> 标签：php, curl, http-post, google-api

好吧，我已经走到了尽头。我已经尝试了几乎所有方法来尝试使其正常工作。我之前在网络主机上进行过 Google OAUTH API 调用，一切正常，但是当我在我的 WAMP 服务器上使用相同的脚本时，谷歌不会回复我的 cURL 帖子。我已经通过发布到我自己的服务器以及有人设置的服务器来测试 cURL 帖子：

[http://www.newburghschools.org/testfolder/dump.php](http://www.newburghschools.org/testfolder/dump.php)

它工作得很好。这是我在让用户允许我的应用程序后使用的脚本：

```
<?

//This script handles the response from google. If the user as authed the app, it will continue the process by formulating another URL request to Google to get the users information. If there was an error, it will simply redirect to index.

include_once($_SERVER['DOCUMENT_ROOT']."/../src/php/google/initialize.php");

if (!isset($_GET['error'])) {
    //No error found, formulate next HTTP post request to get our auth token

    //Set URL and get our data encoded for POST

    $url = "https://accounts.google.com/o/oauth2/token";

    $fields = array(
        'code' => $_GET['code'],
        'client_id' => $google['clientID'],
        'client_secret' => $google['clientSecret'],
        'redirect_uri' => "http://www.dealertec.com/scripts/php/google/reg_response.php",
        'grant_type' => "authorization_code"
    );

    //$data = http_build_query($fields);
    $data = "code=".$fields['code'].'&client_id='.$fields['client_id'].'&client_secret='.$fields['client_secret'].'&redirect_uri='.$fields['redirect_uri'].'&grant_type='.$fields['grant_type'];
    echo $data."<br> /";

    //Begin cURL function

    $ch = curl_init($url);

    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

    $response = curl_exec($ch);
    echo $response;
    curl_close($ch);

    //Decode the JSON and use it to make a request for user information
    print_r($response);
    $response = json_decode($response, true);

    /*if (!isset($response['error'])) {
        //No error in response, procede with final step of acquiring users information

        $apiURL = "https://www.googleapis.com/oauth2/v1/userinfo?access_token=".$response['access_token'];

        $apiCall = curl_init($apiURL);  

        curl_setopt($apiCall, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($apiCall, CURLOPT_HEADER, false);

        $apiResponse = curl_exec($apiCall);
        $apiResponse = json_decode($apiResponse, true);

        var_dump($apiResponse);
    }else{
        echo $response['error'];    
    }*/

}else{
    header("LOCATION: http://www.dealertec.com/");  
}

?> 
```

当我回显应该是谷歌响应时，我得到的只是一个单数“/”。当我在我的虚拟主机上运行相同的脚本时，在更改回 DNS IP 后，它工作正常。我在想 Google 不喜欢我的 WAMP 服务器，甚至不会与之交谈，或者可能是我的 cURL 配置的问题。无法在我的 WAMP 服务器上为 Google API 开发只是一个小烦恼，但如果有人有任何想法，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T23:59:12.057

我`FALSE`从 回来了`curl_exec()`，但这就是我修复它的方法：

```
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); 
```

[http://us3.php.net/manual/en/function.curl-setopt.php](http://us3.php.net/manual/en/function.curl-setopt.php)

希望这可以帮助！

# html - malsup jquery表单在选择更改时提交

> ID：10048520
> 
> 赞同：1
> 
> 时间：2012-04-06T19:50:00.650
> 
> 标签：html, forms, jquery, jquery-forms-plugin

我正在使用 Malsup 出色的表单插件将搜索结果动态加载到同一页面上。

它适用于标准表单提交，但是我的表单中有 2 个选择元素，并且希望在选择更改时更新结果。

我现在的代码是这样的：

```
$(document).ready(function() { 
var options = { 
    target: '#bands-results', 
    beforeSubmit:  showRequest 
}; 

$('#bandsearch').ajaxForm(options);

});     
// Show loading message and submit form 
function showRequest(formData, jqForm, options) { 
$('#bands-results').prepend('<span>Searching</span>');     
    return true; 
} 
```

我还没有看到其他类似的例子。

帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T10:13:37.337

得到它舔这个

```
$(document).ready(function() {

    $("#genre-filter").change(function() {
        $("#band_search").submit();
    });

    // bind to the form's submit event 
    $('#band_search').ajaxForm({
        beforeSubmit: showRequest,
        target: '#band_list',
        success: function() {
            $('#premlim').hide();
        } 
    });

})

    function showRequest(formData, jqForm, options) {     
        return true; 
    } 
```

# cocoa - 如何在 NSTextField 中放置内部阴影？

> ID：10048521
> 
> 赞同：2
> 
> 时间：2012-04-06T19:50:10.297
> 
> 标签：cocoa

我需要在 NSTextField 中为文本添加内阴影，有什么解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T17:45:32.747

NSTextField 是一个 NSView 的子类，它有一个 shadow 字段，如果你创建一个 shadow 对象并将它分配给这个字段，视图会在绘制时自动显示一个阴影

```
 NSShadow* shadow = [[NSShadow alloc] init];
    shadow.shadowBlurRadius = 2; //set how many pixels the shadow has
    shadow.shadowOffset = NSMakeSize(2, -2); //the distance from the text the shadow is dropped
    shadow.shadowColor = [NSColor blackColor];
    self.textfield.shadow = shadow; 
```

这是有效的，因为在 drawRect 上绘制的所有视图都通过使用 [shadow set] 来使用此阴影属性。

在绘制操作期间执行 [shadow set] 会使之后绘制的任何内容都被复制到下面

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-19T13:04:37.007

这是 Swift 4.2 中阴影的代码。由于阴影经常（不总是，但经常！）落在文本的右侧，我在 Swift 代码中稍微调整了示例偏移值，只是为了提供另一个示例。

将阴影附加到的对象视为图形的原点（零点）。如您所料，正 X 值将阴影向右投射；负值在左边。我不确定为什么在这种情况下（[可能与 iOS 与 macOS 与 Y 轴有关的怪癖有关？](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_overview/dq_overview.html)），但 Y 轴被翻转——正 Y 值在对象下方投射阴影；负值在它上面投下阴影。

因此，如果您碰巧正在寻找投射阴影的对象**下方**和**右侧的投影，您希望****x 和 y 的值都为**正值`NSMakeSize`。

**对于斯威夫特 4.2**

```
var shadow: NSShadow = NSShadow()
shadow.shadowBlurRadius = 2  // Amount of blur (in pixels) applied to the shadow.
shadow.shadowOffset = NSMakeSize(4, 4) // the distance from the text the shadow is dropped (positive X = to the right; positive Y = below the text)
shadow.shadowColor = NSColor.black
self.textfield.shadow = shadow 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-27T05:46:54.400

通过将 MMAC 的答案放入扩展中来扩展它，以便您可以在需要时将其作为函数从任何文本字段中调用。

```
extension NSTextField {

    func applyShadow() {
        let shadow: NSShadow = NSShadow()
        shadow.shadowBlurRadius = 2
        shadow.shadowOffset = NSMakeSize(4, 4)
        shadow.shadowColor = NSColor.black
        self.shadow = shadow
    }
}

self.textField.applyShadow() 
```

我将这些扩展的集合保存在一个文件中，可以携带到不同的项目中。

# c# - 如何根据窗口大小调整按钮和单选按钮等 UI 项目的大小？

> ID：10048526
> 
> 赞同：1
> 
> 时间：2012-04-06T19:50:32.613
> 
> 标签：c#, winforms

我有一个包含可调整大小的窗口的 winform 应用程序，但一个要求是窗口中的所有 UI 项目都应根据窗口的大小调整大小。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T19:54:08.930

在控件上设置锚属性。例如，如果您将控件设置为左右锚定*，*则其宽度将随着其父级调整大小而改变。顶部和底部相同。但是请注意，它不会调整大小，例如，控件内的文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:03:08.363

我将举一个名为 Simulator 的 Winform 示例：

```
partial class Simulator
{
    int oldWidth, oldWeight;
    ...
    private void InitializeComponent()
    {
        ... (generated initialization code)
        this.ResizeBegin += new System.EventHandler(Simulator_ResizeBegin);
        this.ResizeEnd += new System.EventHandler(Simulator_ResizeEnd);
    }

    void Simulator_ResizeEnd(object sender, System.EventArgs e)
    {
        this.oldWidth = this.Width;
        this.oldHeight = this.Height;
    }

    void Simulator_ResizeBegin(object sender, System.EventArgs e)
    {
        int wider = this.Width - this.oldWidth;
        int higher = this.Height - this.oldHeight;
        // Change size of UI elements.
    }
} 
```

# java - 公共收藏 缓冲区容量

> ID：10048530
> 
> 赞同：0
> 
> 时间：2012-04-06T19:50:58.803
> 
> 标签：java, apache-commons

我看不到在 apache 的公共空间中获得有界缓冲区的最大容量的方法吗？具体来说，我正在使用[BoundedFifoBuffer](http://commons.apache.org/collections/api/org/apache/commons/collections/BoundedFifoBuffer.html)。你如何查询它的容量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:56:29.190

您必须为构造函数指定大小。如果不指定大小，则为 32。

快速浏览源代码表明，指定大小的大小没有限制（除了必须是的限制`int`）`<= Integer.MAX_VALUE = 2^31-1`。构造函数中唯一的检查是大小为`> 0`. 您可以分配的可用内存量也有实际限制。

不清楚为什么，但确实没有查询缓冲区容量的方法。（大概如果您在添加元素时不知道容量，您应该捕获`BufferOverflowException`以检测何时达到容量。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:53:33.920

你不能。您只能在对象构造时指定它的大小。

# jquery - 如何将项目 Expressjs 与 jQuery-File-Upload 集成？

> ID：10048535
> 
> 赞同：6
> 
> 时间：2012-04-06T19:51:35.527
> 
> 标签：jquery, node.js, file-upload, socket.io, express

jQuery-File-Upload 与 Nodejs 配合得很好，但我发现很难与 Expressjs 集成。有什么建议么？感谢您的关注。

PD：[https ://github.com/blueimp/jQuery-File-Upload](https://github.com/blueimp/jQuery-File-Upload)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-14T08:06:23.833

还有一个 express 中间件：[https ://github.com/aguidrevitch/jquery-file-upload-middleware](https://github.com/aguidrevitch/jquery-file-upload-middleware)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T21:04:28.580

express 通过 Connect 的多部分中间件具有强大的功能，例如，您可以简单地将文件 POST 到特定路径，然后使用[req.files](http://expressjs.com/api.html#req.files)处理已上传的任何内容。

处理文件上传的一个非常简单的选项是通过[jQuery Form Plugin](http://jquery.malsup.com/form/)，如果您使用 Jade 作为模板引擎，您只需要一个具有文件输入的表单，插件应该负责其余的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T03:46:38.767

尝试在你的应用程序中使用[https://github.com/felixge/node-formidable](https://github.com/felixge/node-formidable)，并确保在你的 app.use() 链中没有任何异步项（例如调用数据库的东西），因为它们可能会导致您丢失数据。还要确保它在 app.post() 中，而不是 app.get() 处理程序中。

[https://github.com/nfriedly/picsync-server/blob/master/app.js#L98](https://github.com/nfriedly/picsync-server/blob/master/app.js#L98)有一个粗略但有效的例子，将 express 与强大的一起使用。

# vb6 - 带有参数“00”的 Format$ 在 VB6 中做了什么？

> ID：10048537
> 
> 赞同：4
> 
> 时间：2012-04-06T19:51:45.267
> 
> 标签：vb6

我正在查看带有以下语句的 VB6 -

```
 selected = lstIDS.ListIndex
  NUM_ENTRIES = Format$(selected, "00") 
```

带有“00”参数的格式函数有什么作用？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T20:00:07.300

`Format$(1, "00")`返回`01`。`Format$(1, "000")`会回来`001`等等。该格式参数指定将显示数字的最小位数。在那里，我做到了:-)

# iphone - 一次安装多个图标？

> ID：10048541
> 
> 赞同：0
> 
> 时间：2012-04-06T19:52:26.743
> 
> 标签：iphone, ios

是否可以为应用商店的一次安装创建两个图标（链接到不同的功能）？

例如，在 Android 上，当您安装 Google 地图时，您会获得地图和导航。理想情况下，两个“应用程序”都可以访问相同的数据，但每个图标都将链接到不同的独立功能。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:56:12.043

不是现在（但我可以想象这会发生在路上，如果他们将 PackageMaker 移植到做 iPhone 应用程序）。

用户授权下载和安装一个签名的应用程序，并且只显示一个图标（用于一个包）。

解决此问题的一种方法是拥有两个单独的应用程序，但两个应用程序都调用相同的框架（或库或公共源库），以实现两者之间共有的任何功能。

# r - R：居中 heatmap.2 键（gplots 包）

> ID：10048543
> 
> 赞同：9
> 
> 时间：2012-04-06T19:52:34.017
> 
> 标签：r, heatmap

我想通过 heatmap.2() 命令创建一个热图，其颜色键以 0 为中心（即白色 -> 0，红色 -> 大于 0，蓝色 -> 小于 0），同时保持比例 = “无”，因为我有兴趣绘制实际值的热图。但是，使用以下行时，我的所有热图都没有以零为中心：

```
library(gplots)
outputHeatmap <- heatmap.2(heatmapInputActual, dendrogram="none", Rowv=FALSE,
    Colv=FALSE, col= bluered(256), scale="none", key=TRUE, density.info="none", 
    trace="none", cexRow=0.125, cexCol=0.125, symm=FALSE, symkey=TRUE) 
```

我认为使用命令 symkey=TRUE 会起作用，但事实并非如此。我正在尝试制作热图的变量是（nx 3）数值矩阵。上面描述的 heatmap.2() 命令的一个有问题的输入如下：

```
8.408458  5.661144   0.00000000
4.620846  4.932283  -0.46570468
-4.638912 -3.471838  -0.12146109
-4.822829 -3.946024   0.06403327
3.948832  4.520447  -0.31945941 
```

感谢您的时间。我期待着您的回复。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-08T19:16:52.550

解决方案似乎只是添加`symbreaks`到您的`heatmap.2`. 这是您的数据的完全可重现的示例：

```
library(gplots)
#read your example data
heatmapInputActual <- read.table(textConnection(
"8.408458 5.661144 0.00000000
4.620846 4.932283 -0.46570468
-4.638912 -3.471838 -0.12146109
-4.822829 -3.946024 0.06403327
3.948832 4.520447 -0.31945941
"),as.is=TRUE)
#convert sample data to matrix
heatmapInputActual <- as.matrix(heatmapInputActual)
#just add symbreaks to the end of your code
heatmap.2(heatmapInputActual, dendrogram="none", Rowv=FALSE, Colv=FALSE, 
          col = bluered(256), scale="none", key=TRUE, density.info="none", 
          trace="none", cexRow=0.125, cexCol=0.125, symm=F,symkey=T,symbreaks=T) 
```

![在此处输入图像描述](../Images/300b24bfdbc078c48e6f6ccd5e641e1d.png)

# javascript - 如何使用 jQuery 从 JSON 中读取文件？

> ID：10048546
> 
> 赞同：2
> 
> 时间：2012-04-06T19:52:43.637
> 
> 标签：javascript, jquery, json

我正在尝试使用 jQuery 读取 JSON 文件：

```
 var listOfItems;
       $(function() {
            $.getJSON('myData.json', function(data) {
                listOfItems = data.items;
            });
        }); 
```

这是 myData.json：

```
{
    {"source": "Microsoft", "target": "Amazon", "type": "licensing"},
    {"source": "Microsoft", "target": "HTC", "type": "licensing"},
    {"source": "Samsung", "target": "Apple", "type": "suit"},
    {"source": "Motorola", "target": "Apple", "type": "suit"}
} 
```

但是，Chrome Web 开发人员指出，`listOfItems`此代码后未定义。为什么？我确信 javascript、HTML 和 JSON 文件都位于同一个目录中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:55:05.977

修复 JSON。[jsonlint](http://jsonlint.com/)会告诉你出了什么问题。

JSON 中的属性名称是字符串（与 JavaScript 不同，它们可能是标识符），因此必须用*引号括*起来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:59:09.283

您的主要问题是您使用“{”而不是“[”作为包含数组

你应该有

```
[
    {source: "Microsoft", target: "Amazon", type: "licensing"},
    {source: "Microsoft", target: "HTC", type: "licensing"},
    {source: "Samsung", target: "Apple", type: "suit"},
    {source: "Motorola", target: "Apple", type: "suit"},
] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T20:00:23.920

您`myData.json`的 JSON 无效。

它似乎包含一个对象，该对象本身包含四个对象-但尚未为这些内部对象指定属性名称。

这将是有效的

```
{
    "one"   : { "source":  "Microsoft", "target" : "Amazon", "type" : "licensing" },
    "two"   : { "source" : "Microsoft", "target" : "HTC",    "type" : "licensing" },
    "three" : { "source" : "Samsung",   "target" : "Apple",  "type" : "suit" },
    "four"  : { "source" : "Motorola",  "target" : "Apple",  "type" : "suit" }
} 
```

但是，鉴于您的`listOfItems`，我认为这不是您想要的。您可能需要一个对象数组。

这是通过使用方括号而不是大括号来完成的

```
[
    { "source":  "Microsoft", "target" : "Amazon", "type" : "licensing" },
    { "source" : "Microsoft", "target" : "HTC",    "type" : "licensing" },
    { "source" : "Samsung",   "target" : "Apple",  "type" : "suit" },
    { "source" : "Motorola",  "target" : "Apple",  "type" : "suit" }
] 
```

另外，请注意最后一项的尾随逗号。它在某些浏览器/ javascript 引擎中中断。我不知道 JSON 解析器是否允许。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-07T11:04:48.200

这是一个异步事件。您不能像使用异步事件那样执行变量赋值，您必须执行您在该特定函数中执行的任何操作。否则请确保它是一个同步事件（通过在 JQuery 中设置正确的变量），它将等待操作，在这种情况下，在继续代码之前完成 GET 请求（不推荐）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T19:57:44.957

您可以使用 jQuery.parseJSON() 解析 json；

[http://api.jquery.com/jQuery.parseJSON/](http://api.jquery.com/jQuery.parseJSON/)

传入格式错误的 JSON 字符串可能会导致抛出异常。例如，以下都是格式错误的 JSON 字符串：

```
{test: 1} (test does not have double quotes around it).
{'test': 1} ('test' is using single quotes instead of double quotes). 
```

此外，如果您不传入任何内容，则 parseJSON 将返回空字符串、null 或未定义的“null”。在浏览器提供 JSON.parse 的本机实现的地方，jQuery 使用它来解析字符串。有关 JSON 格式的详细信息，请参阅[http://json.org/](http://json.org/)。

# python - 从 Pylons 中的 json 访问值

> ID：10048547
> 
> 赞同：0
> 
> 时间：2012-04-06T19:52:45.683
> 
> 标签：python, json, dictionary, pylons

在我的控制器中，我得到一个 json 字符串（调用`c.order_history`它看起来像：

```
[
{
    "status": [
        {
            "status": "created",
            "timestamp": "2012-04-06 00:14:10"
        },
        {
            "status": "authed",
            "timestamp": "2012-04-06 00:14:17"
        }
    ],
    "product_info": [
        {
            "id": 3,
            "quantity": 1,
            "created": "2012-04-06 00:14:10",
            "image_id": 13341
        },
        {
            "id": 2,
            "quantity": 1,
            "created": "2012-04-06 00:14:10",
            "image_id": 13323
        },
        {
            "id": 1,
            "quantity": 1,
            "created": "2012-04-06 00:14:10",
            "image_id": 13322
        }
    ],
    "shipping_charge": "0.00",
    "order_number": "0723094747433",
    "shipping_address": {
        "country_code": null,
        "extended_address": "Unit Z",
        "locality": "Las Vagas",
        "company": null,
        "phone": null,
        "postal_code": "31415",
        "full_name": "Boris Karloff",
        "nickname": null,
        "region": "NV",
        "street_address": "123 Random Way"
    },
    "subtotal": "59.00"
} 
```

]

我通过它`json.loads(order_history)`把它变成一个字典，然后尝试提取每个键，这样我就可以得到它们中的后续键/值，例如：

`c.product_info = [{'product_info' : product_info} for product_info in c.order_history]`

它输出整个 json 字符串，但它`product_info`现在刚刚命名。有人可以引导我朝着正确的方向前进，了解我如何访问说、`timestamp`价值`product_info[0]['image_id']`和`shipping_address`价值等吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T20:17:29.943

看起来`c.order_history`将是一个字典列表，只需`product_info`从列表理解中的每个字典中获取键，您将执行以下操作：

```
[{'product_info': order['product_info']} for order in c.order_history] 
```

# java - 如何避免重复相同的数字？

> ID：10048549
> 
> 赞同：0
> 
> 时间：2012-04-06T19:53:20.447
> 
> 标签：java, arrays, function, for-loop

这就是我想要的：
让用户输入任意数量的数字，直到输入非数字（您可能假设数字少于 100）。查找最常输入的数字。（如果有多个，打印所有。）
示例输出：
输入：5
输入：4
输入：9
输入：9
输入：4
输入：1
输入：a
最常见的：4, 9
我明白了在我的代码中，我设法找出哪些是最常见的数字。但是，我不想一遍又一遍地打印出相同的数字；上面的例子： 最常见的： 4, 9, 9, 4
需要做什么？

```
public static void main(String[] args) throws IOException {
    BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
    String[] input = new String[100];
    System.out.print("Input: ");
    input[0] = in.readLine();
    int size = 0;
    for (int i = 1; i < 100 && isNumeric(input[i-1]); i++) {
            System.out.print("Input: ");
            input[i] = in.readLine();
            size = size + 1;
    }
    /*for (int i = 0; i < size; i++) { //testing
        System.out.println(input[i]);
    }*/
    int numOccur;
    int[] occur = new int[size];
    for(int i = 0; i < size; i++) {
        numOccur = 0;
        for (int j = 0; j < size; j++) {
            if(input[i].equals(input[j])) {
                numOccur = numOccur + 1;
            }
        }
        occur[i] = numOccur;
        //System.out.println(numOccur); //testing
    }
    int maxOccur = 0;
    for(int i = 0; i < size; i++) {
        if(occur[i] > maxOccur) {
            maxOccur = occur[i];
        }
    }
    //System.out.println(maxOccur); //testing
    for (int i = 0; i < size && !numFound; i++) {
        if(occur[i] == maxOccur) {
           System.out.println(input[i]);
        }
    }

}

//checks if s is an in, true if it is an int
public static boolean isNumeric (String s) {
    try {
        Integer.parseInt(s);
        return true; //parse was successful
    } catch (NumberFormatException nfe) {
        return false;
    }
} 
```

找到了解决方案！

```
String[] mostCommon = new String[size];
    int numMostCommon = 0;
    boolean numFound = false;
    for (int i = 0; i < size; i++) {
        int isDifferent = 0;
        if (occur[i] == maxOccur) {
            for (int j = 0; j < size; j++) {
                if (!(input[i].equals(mostCommon[j]))) {
                    isDifferent = isDifferent + 1;
                }
            }
            if (isDifferent == size) {
                mostCommon[numMostCommon] = input[i];
                numMostCommon = numMostCommon + 1;
            }
        }
    }
    for (int i = 0; i < numMostCommon - 1; i++) {
        System.out.print("Most common: " + mostCommon[i] + ", ");
    }
    System.out.println(mostCommon[numMostCommon - 1]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:18:11.273

您可以为此使用哈希表来存储频率，因为限制非常小，即小于 100。伪代码如下：
`vector<int> hash(101)`
`cin>>input`
`if(isnumeric(input))`
`hash[input]++`
`else{`
`max=max_element(hash.begin(),hash.end());`
`for(int i=0;i<100;i++)`
`if(hash[i]==max)`
`print i`
`}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:58:38.173

您可以使用[Set](http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html)并存储已打印的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T20:27:40.320

这样的事情呢？

```
public static void main(String[] args) throws IOException {
    BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
    Map<string,int> numberLookup = new HashMap<string,int>();
    Boolean doContinue = true;
    while (doContinue)
    {
        System.out.print("Input: ");
        String input = in.readLine();
        if (isNumeric(input))
        {
            if (!numberLookup.containsKey(input))
                numberLookup.put(input,1);
            else
                numberLookup.put(input, numberLookup.get(input) + 1);
        }
        else
            doContinue = false;
    }

    maxOccur = numberLookup.values().max();
    System.out.print("These numbers were all entered " + maxOccur + " times:");
    Iterator it = numberLookup.entrySet().iterator();
    while (it.hasNext())
    {
        (Map.Entry)it.next();
        System.out.println(pairs.getKey());
    } 
} 
```

抱歉，我是 C# 人，没有 Java 编译器，所以这可能需要一些调整。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T20:08:50.110

```
 Set<Integer> uniqueMaxOccur = new HashSet<Integer>();  
    for (int i = 0; i < size ; i++) {
        if(occur[i] == maxOccur) {
            //System.out.println(input[i]);
            uniqueMaxOccur.add(input[i]);
        }
    } 
```

并显示集合中的值

# android - 如何检查当前可见的活动并从任何地方触发其方法之一？

> ID：10048550
> 
> 赞同：0
> 
> 时间：2012-04-06T19:53:22.677
> 
> 标签：android, android-c2dm

我的应用程序有一个聊天屏幕来发送和接收消息。每当收到消息时，都会出现推送通知并显示最新收到的消息。这一切都很好。

但是当我收到推送通知时，我希望聊天屏幕能够自行刷新。我想这需要知道聊天屏幕当前是否可见。我怎样才能从我的`onReceive()`方法做到这一点`BroadcastReceiver`？

这是一个小伪代码（在我的`BroadcastReceiver`子类中）：

```
public void onReceive(Context context, Intent intent) 
{
    if(currentlyVisibleActivity.getClass() == chatScreenActivity.class())
    {
        ((chatScreenActivity)currentlyVisibleActivity).getMessages();
    }

} 
```

我想知道如何获取 currentVisibleActvity 并使其`call getMessages()`成为 chatScreenActivity。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:10:26.193

我假设您正在计划以下设置？

```
C2DM -> YourBroadcastReceiver -> somehow call #getMessages() 
```

拥有以下组件怎么样：

```
A BroadcastReceiver <for receiving C2DM push notifications>
An IntentService <for executing #getMessages()>
A ContentProvider <for storing the results of #getMessages()>
An Activity <for displaying the contents of ContentProvider> 
```

1.  基本上，C2DM 会触发您的接收器，该接收器调用`#startService`，触发您的`IntentService`.
2.  您的`IntentService`呼叫`#getMessages()`并将消息存储在您的 `ContentProvider`.
3.  每当对 中的数据执行更改时，`ContentProvider`您都会触发`ContentResolver#notifyChange()`.
4.  例如，如果您`Activity`正在显示并使用 a`CursorAdapter`来读取`ContentProvider`它，它将自动刷新。

在这种情况下，发送聊天消息也会在其中存储一行`ContentProvider`- 就像收到的消息一样自动更新 UI。

# knockout.js - KnockoutJS - 可观察对象的可观察数组

> ID：10048553
> 
> 赞同：30
> 
> 时间：2012-04-06T19:53:35.717
> 
> 标签：knockout.js, observable, ko.observablearray

我想显示一个可编辑的项目列表，其中的每个项目都是可编辑的（有点像可编辑的网格，在某种程度上）。我正在使用 KnockoutJS。我不能只使用一个简单的 Observable Array，因为正如文档所述“一个 observableArray 跟踪数组中的哪些对象，而不是这些对象的状态”

因此，我创建了一个可观察对象的 observableArray（使用 utils.arrayMap），并将它们绑定到视图。但是，问题是如果我在屏幕上编辑数据，用户在屏幕上所做的任何数据输入更改似乎都不会生效。见[http://jsfiddle.net/AndyThomas/E7xPM/](http://jsfiddle.net/AndyThomas/E7xPM/)

我究竟做错了什么？

```
<script src="http://cdnjs.cloudflare.com/ajax/libs/knockout/2.0.0/knockout-min.js" type="text/javascript"></script>

<table>
   <tbody data-bind="template: { name:'productListJavascriptTemplate', foreach: products}">
   </tbody>
</table>

<script type="text/html" id="productListJavascriptTemplate">
<tr>
    <td>Name: <input data-bind="value: Name"/></td>
    <td>Name: <span data-bind="text: Name"/></td>
    <td><select data-bind="options: this.viewModel.categories, 
        optionsText: 'Name', optionsValue: 'Id', value: CategoryId,
        optionsCaption: 'Please select...'"></select></td>
    <td>CategoryId: <input data-bind="value: CategoryId"/></td>

</tr>

</script>​

var categoryList= [
{
   Name: "Electronics",
   Id: "1"},
{
   Name: "Groceries",
   Id: "2"}
];

var initialData= [
{
   Name: "Television",
   CategoryId: "1"},
{
   Name: "Melon",
   CategoryId: "2"}
];

var viewModel = {
    products: ko.observableArray(
        ko.utils.arrayMap(initialData, function(product) { 
                                return ko.observable(product); 
        })),
    categories: ko.observableArray(categoryList)       
};

$(function() {
    ko.applyBindings(viewModel);

}); 
```

​</p>

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-06T20:16:37.793

ko.utils.arrayMap 不会将视图模型的属性映射为可观察对象，这就是为什么您看不到它们动态更新的原因。

如果您将 CategoryId 定义为 observable，您将看到它按预期更新：

```
var initialData = [
    {
        Name: "Television",
        CategoryId: ko.observable("1")
    },
    {
        Name: "Melon",
        CategoryId: ko.observable("2")
    }
]; 
```

看到这个更新的jsfiddle：http: [//jsfiddle.net/tuando/E7xPM/5/](http://jsfiddle.net/tuando/E7xPM/5/)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-07T15:39:03.600

为了跟进 Tuan 的回答，我需要根据从 ASP.Net MVC 控制器的服务器方法返回的数据填充我的对象，其中产品列表包含在视图的模型中，以及下拉列表的类别列表框在 ViewBag 中。我使用了以下代码（另请参见[http://www.knockmeout.net/2011/04/utility-functions-in-knockoutjs.html](http://www.knockmeout.net/2011/04/utility-functions-in-knockoutjs.html)）：

```
var initialData = @Html.Raw( new JavaScriptSerializer().Serialize(Model));
var categoryList = @Html.Raw( new JavaScriptSerializer().Serialize(ViewBag.CategoryList));

var ObservableProduct = function(name, description, categoryId) {         
    this.Name = ko.observable(name);         
    this.Description = ko.observable(description);
    this.CategoryId = ko.observable(categoryId);
};  

var viewModel = {
    products: ko.observableArray(ko.utils.arrayMap(initialData, function(product) { 
            return new ObservableProduct(product.Name, product.Description, product.CategoryId); 
        })),
    categories: ko.observableArray(categoryList)       
};

$(function() {
    ko.applyBindings(viewModel);

}); 
```

谢谢，团！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-10T20:17:45.760

我正在使用在调用 ko.utils.arrayMap 时初始化的可写计算 observables

在你的情况下可能是一个矫枉过正，但它可能会帮助其他人。请参阅此 [jsFiddle 示例](http://jsfiddle.net/mitaka/uvLNc/)

```
 // Writeable computed observables
  function Customer(id, firstName, lastName, preferred) {
     var self = this;
     self.id = id;
     self.firstName = firstName;
     self.lastName = lastName;
     // Non-Writeable computed observable
     self.fullName = ko.computed(function() {
        var fn = self.firstName;
        var ln = self.lastName;
        return ln ?  fn + ' ' + ln : fn;
     }, self);
     self.preferred = ko.observable(preferred);
     // Writeable computed observable
     self.isPreferred = ko.computed({
        read: function() {
           var preferredStr = self.preferred() || '';
           var isPreferredComputed = preferredStr.toUpperCase();
           return (isPreferredComputed === 'Y') ?  true : false;
        },
        write: function(value) {
           self.preferred( (!value) ? '' : (value ? 'Y' : ''));            
        },
        owner: self        
    });    
 }
  var mappedData = ko.utils.arrayMap(dataFromServer, function(customer) {
      return new Customer(customer.id, customer.firstName, customer.lastName, customer.preferred);
  }); 
```

# python - wxPython：当在框架内的另一个面板内的面板内时，TextCtrl 永远不会获得焦点

> ID：10048564
> 
> 赞同：1
> 
> 时间：2012-04-06T19:55:01.057
> 
> 标签：python, focus, wxpython

所以我设置了以下代码来演示这个问题：

```
import wx

class testPanel(wx.Panel):
    def __init__(self, parent):
        super(testPanel, self).__init__(parent)
        self.hsizer = wx.BoxSizer(wx.HORIZONTAL)
        self.txt = wx.TextCtrl(self, style=wx.TE_MULTILINE)

        self.hsizer.Add(self.txt, proportion=1,
            flag=wx.EXPAND)
        self.SetSizer(self.hsizer)

        self.hsizer.Fit(self)
        self.Show(True)

class testFrame(wx.Frame):
    def __init__(self, parent):
        super(testFrame, self).__init__(parent)
        self.mainPanel = wx.Panel(self)
        self.vsizer = wx.BoxSizer(wx.VERTICAL)

        self.txt1 = testPanel(self)
        self.txt2 = testPanel(self)

        self.vsizer.Add(self.txt1, proportion=1,
            flag=wx.EXPAND)
        self.vsizer.Add(self.txt2, proportion=1,
            flag=wx.EXPAND)
        self.mainPanel.SetSizer(self.vsizer)

        self.vsizer.Fit(self.mainPanel)

        self.mainSizer = wx.BoxSizer(wx.HORIZONTAL)
        self.mainSizer.Add(self.mainPanel, proportion=1,
            flag=wx.EXPAND)
        self.SetSizer(self.mainSizer)
        self.mainSizer.Fit(self)

        self.Show(True)

app = wx.PySimpleApp()
frame = testFrame(None)
frame.Show(True)
app.MainLoop() 
```

当它运行时，一切都按预期显示，但两个 wx.TextCtrl 永远不会获得焦点。当额外的面板层被移除时，情况并非如此，但我无法避免拥有额外的面板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:05:42.080

采用：

```
self.txt1 = testPanel(self.mainPanel)
self.txt2 = testPanel(self.mainPanel) 
```

他们会得到关注。

在 wxPython 中，当您设计一条带有分支但没有交叉的直线继承时，事情会变得更好。由于您的 testPanel 位于属于 mainPanel 的 sizer 中，因此自然父级不是 Frame（自身）而是 mainPanel，

# javascript - setInterval() 不重复。仅工作 1 次

> ID：10048568
> 
> 赞同：12
> 
> 时间：2012-04-06T19:55:49.440
> 
> 标签：javascript, jquery, css

我正在尝试让 div 的 left 属性自行更改 - 当您将鼠标悬停时每秒更改一次，所以我做了这个：

```
$("div.scroll_left").hover(function(){
    var left_num = $('div.license_video').css("left")
    var left_num1 = parseInt(left_num, 10) - 1;
    var timerID = setInterval(alert(left_num1), 1000);
    //var timerID = setInterval(slideleft(left_num1), 1000);
},function(){
    clearInterval(timerID);
});
//function slideleft(left_num){
    //$('.license_video').css('left', left_num + "%");
//} 
```

从理论上讲，您会认为它会重复，直到您将光标移开以清除间隔。当我将鼠标悬停在它上面时，它会执行一次并且永远不会重复（没有错误）。然后，当我将鼠标悬停时，它会给出错误“未捕获的 ReferenceError：timerID 未定义”

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-06T19:57:34.837

`setInterval`根本不工作。您没有将函数作为第一个参数传递给它。

您正在`alert` **立即**调用并尝试使用它的返回值作为重复的函数。

```
var timerID = setInterval(function () { alert(left_num1) }, 1000); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-06T19:57:42.793

所以你在这里有两个不同的问题：

```
// (1) timerID needs to be defined in a scope accessible to both hover callbacks
var timerID = null;

$("div.scroll_left").hover(function(){
    var left_num = $('div.license_video').css("left")
    var left_num1 = parseInt(left_num, 10) - 1;

    // (2) Pass a *function* to setInterval
    timerID = setInterval(function () {
        alert(left_num1)
    }, 1000);
}, function(){
    clearInterval(timerID);
    timerID = null;
}); 
```

当你写

```
setInterval(alert(left_num1), 1000);
// or
setInterval(slideleft(left_num1), 1000); 
```

您正在将调用`alert()`或`slideleft()`（分别）返回的值传递给`setInterval`. 您*没有*传递函数本身。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-06T19:58:32.957

您正在分配`null`要调用的功能。为什么？因为您调用`alert`并将其返回值分配给 setInterval 参数。

相反，使用匿名函数：

```
setInterval(function() {doStuff();},1000); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-23T17:27:14.660

非常简单；-) ...我喜欢 jquery，无论是哪个版本...你需要纯 JavaScript 发送 pm 我可以提供帮助。

```
umavez = 0;
setInterval(function() {
	if (umavez == 0) {
      for (x=0;x<10;x++) { 
        $('div.test').append('<div>'+x+'</div>');
      }
    }
  umavez = 1;
}, 500);
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<div class="test">Linha:</div>
```

# python - Python：在一组数字中寻找趋势

> ID：10048571
> 
> 赞同：37
> 
> 时间：2012-04-06T19:56:04.917
> 
> 标签：python, math

我在 Python 中有一个数字列表，如下所示：

```
x = [12, 34, 29, 38, 34, 51, 29, 34, 47, 34, 55, 94, 68, 81] 
```

在这些数字中找到趋势的最佳方法是什么？我对预测下一个数字是什么不感兴趣，我只想输出多组数字的趋势，以便比较趋势。

**编辑：**按趋势，我的意思是我想要一个数字表示数字是增加还是减少以及以什么速率。我不是大量的数学，所以可能有一个合适的名字！

**编辑2：**看起来我真正想要的是线性最佳拟合的系数。在 Python 中获得这个的最好方法是什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-06T20:23:54.543

可能你的意思是你想在图表上绘制这些数字并找到一条穿过它们的直线，其中直线和数字之间的总距离最小？这称为线性回归

```
def linreg(X, Y):
    """
    return a,b in solution to y = ax + b such that root mean square distance between trend line and original points is minimized
    """
    N = len(X)
    Sx = Sy = Sxx = Syy = Sxy = 0.0
    for x, y in zip(X, Y):
        Sx = Sx + x
        Sy = Sy + y
        Sxx = Sxx + x*x
        Syy = Syy + y*y
        Sxy = Sxy + x*y
    det = Sxx * N - Sx * Sx
    return (Sxy * N - Sy * Sx)/det, (Sxx * Sy - Sx * Sxy)/det

x = [12, 34, 29, 38, 34, 51, 29, 34, 47, 34, 55, 94, 68, 81]
a,b = linreg(range(len(x)),x)  //your x,y are switched from standard notation 
```

趋势线不太可能通过你的原始点，但它会尽可能接近直线可以获得的原始点。使用此趋势线 (a,b) 的梯度和截距值，您将能够推断出超过数组末尾的线：

```
extrapolatedtrendline=[a*index + b for index in range(20)] //replace 20 with desired trend length 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-04-06T20:33:10.607

Keith 提供的链接或 Riaz 提供的答案可能会帮助您获得 polyfit，但如果可用，始终建议使用库，对于您手中的问题，[numpy](http://docs.scipy.org/doc/numpy-1.3.x/contents.html)提供了一个很棒的多项式拟合函数，称为[polyfit](http://docs.scipy.org/doc/numpy-1.3.x/reference/generated/numpy.polyfit.html)。您可以使用 polyfit 将数据拟合到任何程度的方程。

这是一个使用 numpy 将数据拟合到 y=ax+b 形式的线性方程中的示例

```
>>> data = [12, 34, 29, 38, 34, 51, 29, 34, 47, 34, 55, 94, 68, 81]
>>> x = np.arange(0,len(data))
>>> y=np.array(data)
>>> z = np.polyfit(x,y,1)
>>> print "{0}x + {1}".format(*z)
4.32527472527x + 17.6
>>> 
```

同样，二次拟合将是

```
>>> print "{0}x^2 + {1}x + {2}".format(*z)
0.311126373626x^2 + 0.280631868132x + 25.6892857143
>>> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-06T20:04:57.517

这是获得增加/减少趋势的一种方法：

```
>>> x = [12, 34, 29, 38, 34, 51, 29, 34, 47, 34, 55, 94, 68, 81]
>>> trend = [b - a for a, b in zip(x[::1], x[1::1])]
>>> trend
[22, -5, 9, -4, 17, -22, 5, 13, -13, 21, 39, -26, 13] 
```

在结果列表中`trend`，`trend[0]`可以解释为从`x[0]`到的增加`x[1]`，`trend[1]`将是从`x[1]`到的增加`x[2]`等。负值表示从一个索引到下一个索引的`trend`值减少。`x`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-04-06T19:59:11.890

您可以对数据进行[最小二乘拟合](http://en.wikipedia.org/wiki/Least_squares)。

使用[此页面](http://en.wikipedia.org/wiki/Ordinary_least_squares#Simple_regression_model)中的公式：

```
y = [12, 34, 29, 38, 34, 51, 29, 34, 47, 34, 55, 94, 68, 81]
N = len(y)
x = range(N)
B = (sum(x[i] * y[i] for i in xrange(N)) - 1./N*sum(x)*sum(y)) / (sum(x[i]**2 for i in xrange(N)) - 1./N*sum(x)**2)
A = 1.*sum(y)/N - B * 1.*sum(x)/N
print "%f + %f * x" % (A, B) 
```

打印最佳拟合线的起始值和增量。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-04-06T20:06:02.807

我同意基思的观点，我认为您可能正在寻找线性最小二乘拟合（如果您只想知道数字是普遍增加还是减少，以及以什么速率）。拟合的斜率会告诉您它们增加的速度。如果您想要线性最小二乘拟合的直观表示，请尝试 Wolfram Alpha：

[http://www.wolframalpha.com/input/?i=linear+fit+%5B12%2C+34%2C+29%2C+38%2C+34%2C+51%2C+29%2C+34%2C +47%2C+34%2C+55%2C+94%2C+68%2C+81%5D](http://www.wolframalpha.com/input/?i=linear+fit+%5B12%2C+34%2C+29%2C+38%2C+34%2C+51%2C+29%2C+34%2C+47%2C+34%2C+55%2C+94%2C+68%2C+81%5D)

**更新：** 如果你想在 Python 中实现线性回归，我建议从 Mathworld 的解释开始：

[http://mathworld.wolfram.com/LeastSquaresFitting.html](http://mathworld.wolfram.com/LeastSquaresFitting.html)

这是对算法的一个非常简单的解释，它实际上是自己编写的。特别是，您要密切注意方程 16-21、27 和 28。

尝试自己编写算法，如果你有问题，你应该打开另一个问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-06T22:27:04.093

您可以使用 numpy 找到 OLS 系数：

```
import numpy as np

y = [12, 34, 29, 38, 34, 51, 29, 34, 47, 34, 55, 94, 68, 81]

x = []
x.append(range(len(y)))                 #Time variable
x.append([1 for ele in xrange(len(y))]) #This adds the intercept, use range in Python3

y = np.matrix(y).T
x = np.matrix(x).T

betas = ((x.T*x).I*x.T*y) 
```

结果：

```
>>> betas
matrix([[  4.32527473],  #coefficient on the time variable
        [ 17.6       ]]) #coefficient on the intercept 
```

由于趋势变量的系数为正，因此变量中的观察值会随着时间的推移而增加。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-04-06T20:50:42.900

计算贝塔系数。

```
y = [12, 34, 29, 38, 34, 51, 29, 34, 47, 34, 55, 94, 68, 81]
x = range(1,len(y)+1)

def var(X):
    S = 0.0
    SS = 0.0
    for x in X:
        S += x
        SS += x*x
    xbar = S/float(len(X))
    return (SS - len(X) * xbar * xbar) / (len(X) -1.0)

def cov(X,Y):
    n = len(X)
    xbar = sum(X) / n
    ybar = sum(Y) / n
    return sum([(x-xbar)*(y-ybar) for x,y in zip(X,Y)])/(n-1)

def beta(x,y):
    return cov(x,y)/var(x)

print beta(x,y) #4.34285714286 
```

# asp.net-mvc - 页面和速度之间的 SignalR 持久性？

> ID：10048582
> 
> 赞同：0
> 
> 时间：2012-04-06T19:56:55.043
> 
> 标签：asp.net-mvc, asp.net-mvc-3, signalr

首先是一个简单的问题——我注意到 SignalR 从我在客户端上调用 start() 开始需要大约 3 秒的时间来连接。有没有人遇到过类似的结果？这是正常的吗？

作为对此的扩展，假设建立连接确实需要几秒钟，或者即使不需要，是否可以保持页面之间的连接？例如，我有一个 5 页的 MVC 应用程序，在任何页面上，我希望能够在客户收到一个“新消息”通知时为他们弹出一个通知。如果我在我的母版页中抛出我的弹出代码，它总是可以作为回调使用，但我如何确保我不必在每次页面更改时重新连接？

# sencha-touch - 区域作为按钮煎茶

> ID：10048587
> 
> 赞同：0
> 
> 时间：2012-04-06T19:57:20.333
> 
> 标签：sencha-touch

我有一个图像作为我的背景，我想使用图像的不同区域作为按钮来做不同的事情。！[在此处输入图像描述][1]

假设一个图像中包含四个框。由于它们与图像不是分开的，我无法具体定义那里的属性，但我想将它们用作按钮，每个按钮做不同的工作，是否有可能这样做可能是使用坐标等......请帮助...... .

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:03:20.190

您可以创建四个不可见的按钮，并根据您希望它们占用的区域将它们拉伸。在下面的示例中，有四个不可见的按钮，您可以注释掉 ui:'plain' 来查看它们。

```
 {
            xtype: 'container',
            layout: 'hbox',
            items:[{
                xtype:'button',
                ui: 'plain',
                flex: 1,
                handler:function(){
                    alert('top left')
                }
            },{
                xtype:'button',
               ui: 'plain',
                flex: 1,
                handler:function(){
                    alert('top right')
                }
            }]
        },{

            xtype: 'container',
            layout: 'hbox',
            items:[{
                xtype:'button',
                ui: 'plain',
                flex: 1,
                handler:function(){
                    alert('bottom left')
                }
            },{
                xtype:'button',
                ui: 'plain',
                flex: 1,
                handler:function(){
                    alert('bottom right')
                }
            }]
        } 
```

希望有帮助

# c++ - UI::MainWindow 找不到成员

> ID：10048596
> 
> 赞同：0
> 
> 时间：2012-04-06T19:58:05.247
> 
> 标签：c++, qt

我创建了一个 .ui 文件，其中包含多个名为 houseTable、carTable 和 personTable 的 UI 项表小部件。在我的 cpp 文件中，我尝试引用这些小部件，但出现错误`'class UI::MainWindow' has no member named 'houseTable'`。我很困惑为什么在我的 .ui 文件中我的对象名为“houseTable”时会发生这种情况。

```
//mainwindow.cpp
ui->houseTable->setDescription("All houses:"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:41:04.973

```
#include "ui_calculatorform.h"
class CalculatorForm : public QWidget
{
   ........................
   ...........................
private:
    Ui::CalculatorForm ui;
};

CalculatorForm::CalculatorForm(QWidget *parent)
    : QWidget(parent)
{
    ui.setupUi(this);
} 
```

如果我没记错，这些步骤应该会有所帮助。

# jquery - 为什么在同一元素上的 mouseDown 事件触发后单击事件不触发？

> ID：10048600
> 
> 赞同：4
> 
> 时间：2012-04-06T19:58:32.543
> 
> 标签：jquery, javascript-events

我在同一个元素上有一个 mouseDown 事件和一个 click 事件。当我单击它时，mouseDown 事件会触发（即警告“鼠标按下 P”），但 click 事件不会。但是，如果我注释掉 mouseDown 警报语句，click 事件会显示它的警报。为什么是这样？ [http://jsfiddle.net/A8vhq/](http://jsfiddle.net/A8vhq/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T20:01:58.727

这是因为单击永远不会发生，当出现警告框时，它会中断元素上的 mouseup 事件，从而中断 mouseclick。

用于`console.log('message')`测试您的代码，而不是`alert`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:01:26.130

而不是`alert`, 使用`console.log`它会起作用。

**现场演示：http:** [//jsfiddle.net/A8vhq/1/](http://jsfiddle.net/A8vhq/1/)

* * *

顺便说一句，我对代码进行了一些重构：

```
$('p').on('mousedown', function (e) {
    console.log('Mouse pressed on ' + e.target.nodeName);
});

$('p').on('click', function (e) {
    console.log(e.target.nodeName + ' clicked');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T20:02:58.753

只需替换`alert`为`console.log`或任何其他**非模态**输出方式。

# svg - 用另一个 SVG 形状填充 SVG 形状

> ID：10048606
> 
> 赞同：3
> 
> 时间：2012-04-06T19:58:55.680
> 
> 标签：svg, shape, fill

是否可以使用一个 SVG 形状作为另一个形状的填充？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T21:44:50.643

您想使用[SVG Pattern](http://www.w3.org/TR/SVG/pservers.html#Patterns)。看[这个例子](http://www.w3.org/TR/SVG/images/pservers/pattern01.svg)：

```
<svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <pattern id="TrianglePattern" patternUnits="userSpaceOnUse"
             x="0" y="0" width="100" height="100"
             viewBox="0 0 10 10" >
      <path d="M0,0 L7,0 L3.5,7 z" fill="red" stroke="blue" />
    </pattern> 
  </defs>

  <!-- The ellipse is filled using a triangle pattern paint server
       and stroked with black -->
  <ellipse fill="url(#TrianglePattern)" stroke="black" stroke-width="5"  
           cx="400" cy="200" rx="350" ry="150" />
</svg> 
```

注意：

*   将剪辑绘制的内容`viewBox`。`<pattern>`（如示例中所示，每个三角形的顶部笔划和左上角都略微隐藏。）

*   当 与`viewBox`的大小不同时`width`，`height`您正在有效地缩放图案中图形的大小。（该示例将模式中的 7 个单位宽的三角形放大了 10 倍，因此在 700 个单位宽的椭圆的宽度上只有 7 个（加上填充）可见。）

# python - 如何在 tkinter 列表框中突出显示选择？

> ID：10048609
> 
> 赞同：28
> 
> 时间：2012-04-06T19:59:11.240
> 
> 标签：python, tkinter

我在单选模式下设置了 2 个单独的列表框。当我从 中选择一个项目时`listboxA`，它会突出显示，但是当我从中选择一个项目时`listboxB`，它会突出显示，并且来自 的项目`listboxA`保持活动状态，但未突出显示。我怎样才能保持两者都突出显示？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-04-06T22:39:21.843

简短回答：将`exportselection`每个列表框的属性设置为`False`

Tkinter 起源于 X 窗口系统。X 有一个叫做“选择”的概念，它类似于系统剪贴板（更准确地说，剪贴板是“PRIMARY”选择）。默认情况下，一些 tkinter 小部件将它们的选择导出为 PRIMARY 选择。一个应用程序一次只能有一个 PRIMARY 选择，这就是当您在两个列表框之间单击时突出显示消失的原因。

`exportselection`Tkinter 使您可以使用列表框（以及文本和条目小部件）的配置选项来控制此行为。将其设置为`False`可防止将选择导出到 X 选择，从而允许小部件在不同的小部件获得焦点时保留其选择。

例如：

```
the_listbox = tk.Listbox(..., exportselection=False) 
```

引用[官方 tk 文档](http://tcl.tk/man/tcl8.5/TkCmd/options.htm#M-exportselection)：

> **exportselection** 指定小部件中的选择是否也应该是 X 选择。该值可以具有 Tcl_GetBoolean 接受的任何形式，例如 true、false、0、1、yes 或 no。如果选择已导出，则在小部件中选择会取消选择当前 X 选择，在小部件外部选择会取消选择任何小部件选择，并且小部件将在有选择时响应选择检索请求。默认值通常是小部件导出选择。

# svg - KML 纬度/经度到 SVG 或画布？

> ID：10048611
> 
> 赞同：1
> 
> 时间：2012-04-06T19:59:27.987
> 
> 标签：svg, html5-canvas, kml

有没有办法将纬度/经度坐标转换为 SVG 路径或画布标签路径？我想在网络地图上显示 SVG 中的状态轮廓。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T20:15:17.943

[D3.js](http://d3js.org/)沿着这些思路提供了各种不错的地图相关功能。

参见例如[http://mbostock.github.com/d3/talk/20111116/airports.html](http://mbostock.github.com/d3/talk/20111116/airports.html)

# actionscript-3 - Flash AS3 动态文本不断给出错误 1119

> ID：10048612
> 
> 赞同：0
> 
> 时间：2012-04-06T19:59:28.603
> 
> 标签：actionscript-3, flash, dynamic-text

**所以**我有一个方法接受一个字符串，然后假设将按钮上的动态文本框设置为所述字符串。

```
public function setText(caption:String) {
  this.btext.text = caption;
} 
```

我真的不明白为什么这种方法会产生 1119 错误。
`Access of a possibly undefined property btext through a reference with static type Button.as`

动态文本框的实例名称是`btext`，我尝试删除文本框并创建一个新文本框，但这仍然会产生 1119 错误。我还阅读了另一个堆栈问题，`this['btext'].text = caption;`该问题尝试给了我很多运行时错误。

基本上我做错了什么？
感谢您的任何帮助。

# 编辑

这是我正在使用的代码，我创建了一个按钮实例，将其添加到舞台并使用此代码将其存储在一个数组中。

### 创建按钮的代码

```
this.buttonArray.push(this.addChild(weaponButton)); 
```

### 按钮.as

```
package  {

    import flash.display.MovieClip;
    import flash.filters.*;

    public class Button extends MovieClip {

        public function Button() {

        }

        public function setPosition(xpos:int, ypos:int) {
            this.x = xpos;
            this.y = ypos;
        }

        public function setScale(xScale:Number, yScale:Number) {
            this.scaleX = xScale;
            this.scaleY = yScale;
        }

        public function addDropShadow():Array {
            var dropShadow:DropShadowFilter = new DropShadowFilter(2,45,0, 1,4,4,1,1,true);
            return [dropShadow];
        }

        public function removeDropShadow():Array {
            return null;
        }

        public function setText(caption:String) {
            this.btext.text = caption;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T20:54:41.663

正如您所说， btext 是对象的实例名称。这是我假设 btext 是您在库中创建的对象的地方。
在你的课堂上，你做错了两件事。因此，让我们检查您的方法。

```
public function setText(caption:String) {
  this.btext.text = caption;
} 
```

首先错误的是您使用的是“this”。“this”是对你所在类的当前实例的引用。你说 btext 是所述实例的属性。我假设这不是因为您将 btext 定义为库中的对象。这会给你你得到的属性是未定义的错误。

现在手头的第二个问题是你要问“好的，那我如何在我的课堂上引用 btext”。您需要知道的是，只有添加到显示列表 IE:stage 中的对象才能通过舞台访问对象。
您可以通过 3 种方式做到这一点。
第一种方法是将按钮的引用传递给类并将其存储为类的属性。
第二种方法是将您的课程添加到舞台并在课程中收听 addedToStage 事件。那时您可以访问该对象。

```
MovieClip(root)["btext"].text 
```

前两种方法不是很好的做法，因为 btext 不是类的一部分，一般的经验法则是封装你的类。
要完成这项工作，您可以做的是让您的类将值分配给类中的属性，然后触发一个事件并让该类的父级监听该事件，然后获取该值并分配。

[这里有一些建议阅读](http://www.adobe.com/devnet/actionscript/articles/oop_as3.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:46:52.167

我认为变量 btext 根本不存在，或者它是从 Movieclip 继承的？

# c# - 使用opencv捕获视频

> ID：10048613
> 
> 赞同：1
> 
> 时间：2012-04-06T19:59:34.000
> 
> 标签：c#, opencv

我正在尝试做

```
VideoCapture cap (../video.avi); 
```

出现错误：无法读取电影文件 .../video.avi

我正在使用 Opencv 2.3.1

有什么建议么？多谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:07:23.647

您是在尝试将视频流（例如网络摄像头）保存到磁盘，还是尝试从视频文件中读取？

在第一种情况下，您使用默认设备捕获 `VideoCapture cap (0);`

然后您必须使用 VideoWriter 类将其保存到磁盘。

如果您想从文件中读取，那么您可能没有使用正确的路径。

# asp.net-mvc-3 - 我可以返回列表吗 从我的控制器到我的视图？(MVC3)

> ID：10048615
> 
> 赞同：0
> 
> 时间：2012-04-06T20:00:14.493
> 
> 标签：asp.net-mvc-3, razor

我可以从我的控制器返回列表到我的视图，还是我需要将我的列表包装在另一个类中，只是为了只返回一个类？

如果这是可能的，我该如何遍历列表？我正在尝试这个（Razor），但 Visual Studio 对此并不满意：

```
@model List<QueueItem>
.
.
.
@foreach (item in @Model) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T06:13:27.840

你可以这样做，但我从不将我的域对象直接返回到视图。通常我有一个视图模型，它只包含我在该视图上需要的字段。

鉴于您的情况，我将在视图模型中有此列表：

```
public class MyViewModel
{
     public IEnumerable<QueueItem> QueueItems { get; set; }
} 
```

在您的操作方法中，您将从服务/存储库调用中填充这些项目，然后此视图模型将返回到视图：

```
public ActionResult List()
{
     MyViewModel viewModel = new MyViewModel
     {
          QueueItems = queueItemRepository.GetAllQueueItems()
     };

     return View(viewModel);
} 
```

在您看来，您将遍历这些项目并执行需要完成的操作：

```
@foreach (var item in Model.QueueItems)
{
} 
```

我希望这有帮助。

# ios - iOS 应用程序中的 Facebook 图标/按钮发光

> ID：10048616
> 
> 赞同：3
> 
> 时间：2012-04-06T20:00:17.137
> 
> 标签：ios, facebook, uinavigationbar

有没有人知道/猜测当用户点击图标时 facebook 如何实现图标的发光？（您可以在下面看到我的意思）在我看来，他们至少以编程方式实现了其中的一部分，因为发光实际上溢出在它旁边的图标上。有没有人这样做或有从哪里开始的指示？然而，它似乎并没有从 UINavigationBar 溢出。

![Facebook 图标发光](../Images/fc081e50eb1fe3aec943867eafa9c8e4.png)

PS。我确实知道如何在导航栏上制作图标，只是不确定如何实现发光...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T20:28:14.760

`UIButton`有一个名为 的属性`showsTouchWhenHighlighted`。当您将其设置为 true 时，只要您点击它，它就会发光。

出于某种原因，当您将其用作 a`UIBarButtonItem`或`UIToolbar`a中的自定义视图时，它会位于图标的后面`UINavigationBar`（与您仅设置 的图像相反`UIBarButtonItem`）。

# java - 语句未编译

> ID：10048628
> 
> 赞同：0
> 
> 时间：2012-04-06T20:01:09.193
> 
> 标签：java

我有一个我试图运行和理解的反编译代码的方法。第 5 行无法编译，我收到一条错误消息，提示需要不兼容的类型：java util.Hashmap found: java.lang.String。

```
private void resetFieldModel(HashMap<String, Integer> to_use_map)
{
    this.current_field_model.removeAllElements();
    Set temp_set = to_use_map.keySet();

    for (String s : temp_set)
    {
        this.current_field_model.addElement(s);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T20:02:16.487

您需要对`temp_set`.

```
Set<String> temp_set = to_use_map.keySet(); 
```

### 也可以看看：

*   [Java 泛型教程](http://docs.oracle.com/javase/tutorial/extra/generics/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:07:18.717

您必须遍历`temp_set`which must 的`Set<String>`类型（在您的代码中）。这个想法是每个元素`temp_set`都是类型`String`

# c# - 添加 .where 来检查项目

> ID：10048633
> 
> 赞同：0
> 
> 时间：2012-04-06T20:01:19.510
> 
> 标签：c#, asp.net-mvc, linq

我目前正在根据页面的下拉列表获取类型列表。我的问题是我需要在控制器中检查该项目是否处于活动状态，然后再显示在下拉列表中。

我在控制器中获取列表的当前代码是：

```
viewModel.AvailableSongTypes = viewModel.songTypeId.HasValue
            ? _songTypeService.GetSongTypeItems(viewModel.SongTypeId.ToString())
            : _songTypeService.GetSongTypeItems(); 
```

我想添加

```
.Where(a=>a.IsActive ?? false) 
```

但不知道如何将它添加到我已经拥有的代码行中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:06:05.660

```
viewModel.AvailableSongTypes = viewModel.songTypeId.HasValue 
        ? _songTypeService.GetSongTypeItems(viewModel.SongTypeId.ToString()).Where(a=>a.IsActive ?? false) 
        : _songTypeService.GetSongTypeItems().Where(a=>a.IsActive ?? false); 
```

或者

```
viewModel.AvailableSongTypes = (viewModel.songTypeId.HasValue 
        ? _songTypeService.GetSongTypeItems(viewModel.SongTypeId.ToString())
        : _songTypeService.GetSongTypeItems()).Where(a=>a.IsActive ?? false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:06:25.893

你可以做：

```
viewModel.AvailableSongTypes = viewModel.songTypeId.HasValue
            ? _songTypeService.GetSongTypeItems(viewModel.SongTypeId.ToString()).Where(a => a.IsActive ?? false)
            : _songTypeService.GetSongTypeItems().Where(a => a.IsActive ?? false); 
```

或者最好的一个：

```
viewModel.AvailableSongTypes = (viewModel.songTypeId.HasValue
            ? _songTypeService.GetSongTypeItems(viewModel.SongTypeId.ToString())
            : _songTypeService.GetSongTypeItems()).Where(a => a.IsActive ?? false); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T20:07:52.407

我认为你正在寻找这样的东西（我现在不在一台装有 Visual Studio 的机器上，所以我不能 100% 确定它会编译干净）：

```
Func<SongTypeItem,bool> isActive = i => i.IsActive ?? false;

viewModel.AvailableSongTypes = viewModel.songTypeId.HasValue
  ? _songTypeService.GetSongTypeItems(viewModel.SongTypeId.ToString()).Where(isActive)
  : _songTypeService.GetSongTypeItems().Where(isActive); 
```

您基本上所做的是使用`Where`扩展方法过滤可枚举的“歌曲类型项目”序列。的创建`Func` `isActive`只是为了避免重复我自己——你可以在`Where`调用中直接内联它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T20:33:27.190

谢谢大家的帮助！我能够思考它并重写我的列表是如何制作的，然后我可以添加我的 .where 短语。这就是我将其更改为：

```
viewModel.AvailableSongTypes =
            _songTypeRepository.FindAll().OrderBy(o => o.Description).Where(a => a.IsActive).ToSelectList(
                "SongTypeId", "Description", viewModel.SongTypeId.ToString()); 
```

# mysql - Prestashop 数据库架构

> ID：10048638
> 
> 赞同：2
> 
> 时间：2012-04-06T20:01:37.397
> 
> 标签：mysql, database, prestashop

是否可以在数据库模式中创建特定对象的图形表示，以及与该对象关联的所有链接元数据、视图和存储过程的所有关系？示例：我想在 Prestashop 产品页面上的“数据表”选项卡与数据库模式中的其余元素之间定义逻辑关系。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:03:45.070

是（部分）- 使用 mysql 工作台。它有逆向工程数据库工具

见[mysql dev wb 链接](http://www.mysql.com/products/workbench/)

这将生成表+关系图。不支持存储过程、视图、触发器等（太复杂）。您只需要自己浏览和反转它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T19:03:28.890

是的，您可以在这里找到 PrestaShop 的新物理数据模型：http: [//www.prestashop.com/blog/en/a-new-physical-data-model-available-for-prestashop/](http://www.prestashop.com/blog/en/a-new-physical-data-model-available-for-prestashop/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T23:35:48.047

Prestashop 发行版的 dev 目录中有一个 MySQL 工作台模型（尽管我看到的最后一个与实际发布的数据库模式不同步，尽管这可能是一个开发版本）。我会把它作为我的第一点。不幸的是，它不会显示表之间的所有关系。

进行分析的最快方法之一是拍摄数据库快照，插入特定记录（用户、订单、客户、数据表等），拍摄另一个快照，然后对它们进行比较。

# cron - 来自 cpanel 的 Cron 作业.. 没有成功

> ID：10048641
> 
> 赞同：0
> 
> 时间：2012-04-06T20:01:46.483
> 
> 标签：cron, cpanel, unix

我尝试了很多方法，但最终一无所获。我的简单目标是在一天结束时将变量重置为零。

我将 php 的位置检查为“which php”和“whereis php”

这导致 /usr/bin/php

这是我尝试过的一些事情..

```
/usr/local/bin/php -f /home/USERNAME/public_html/developer3/crons/filename.php

/usr/bin/php -f /home/USERNAME/public_html/developer3/crons/filename.php

php -q /home/USERNAME/public_html/developer3/crons/filaname.php

/usr/bin/wget -O http://subdomain.sitename.com/crons/filename.php 
```

为了快速获得结果，我将时间设置为每分钟执行代码。我可以成功地执行代码

```
http://subdomain.sitename.com/crons/filename.php 
```

请指导我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:16:02.820

如果您系统上 php 的路径是 /usr/bin/php 那么您应该使用 cron 运行的命令应该是

```
/usr/bin/php /full/path/to/php/script.php 
```

您正在运行的脚本是否设计为以这种方式从 php-cli 调用？如果它不是并且在您使用浏览器时可以正常工作，那么您可以使用 curl，如果它安装在您的服务器上

curl -A cron-job [http://subdomain.sitename.com/crons/filename.php](http://subdomain.sitename.com/crons/filename.php)

在任何情况下配置 MAILTO 变量都可能会有所帮助（因为您使用的是 cPanel，它只是您可以填写的相应页面上的一个文本框），以便您收到一封包含 cron 作业输出的电子邮件。将输出通过电子邮件发送给您将帮助您诊断导致脚本在运行时没有达到预期效果的原因。

# jquery - 我如何将 jquery 应用于此 Web 表单？

> ID：10048643
> 
> 赞同：0
> 
> 时间：2012-04-06T20:02:07.753
> 
> 标签：jquery

我刚刚开始使用 Jquery - 发现它非常酷且简单。我有一个小项目，我想将 jquery 应用到其中，但是我的代码变得丑陋且冗长，因此我正在寻求以下方面的帮助：

在加载此表单时，我想隐藏所有小节，然后当您从“**类型**”下拉列表中选择**Flyer时，应出现****Flyer** fieldset 部分。当您从**Type**下拉列表中选择**Banner时，** **Banner** fieldset 部分应该会出现，而所有其他部分都会消失。

 ******现在在**横幅*** *fieldset* * 中，如果您选择“ **Size 1** ”**复选框**，则应该出现 Size 1 - Details 字段集，依此类推。

有人可以向我展示使用 jquery 完成此任务的最干净、最有效的方法吗？

```
<form action="" method="post">
<fieldset name="fs_mainInfo">
                <legend>Main Info</legend>

                <table style="width: 100%">
                    <tr>
                        <td style="width: 255px"><label id="Label1">First Name</label></td>
                        <td><input id="fname" name="fname" type="text" /></td>
                    </tr>
                    <tr>
                        <td style="width: 255px">Last Name</td>
                        <td><input id="lname" name="lname" type="text" /></td>
                    </tr>
                    <tr>
                        <td style="width: 255px"><label id="Label2">Type</label></td>
                        <td><select id="jobType" name="jobType">
                        <option value="Flyer">Flyer</option>
                        <option value="Banner">Banner</option>
                        <option value="Postcard">Postcard</option>
                        </select></td>
                    </tr>
                    <tr>
                        <td style="width: 255px">&nbsp;</td>
                        <td>&nbsp;</td>
                    </tr>
                </table>

            </fieldset>
            <fieldset name="fs_flyer" id="fs_flyer">
                <legend style="color:blue">Flyer</legend>
                <table style="width: 100%">
                    <tr>
                        <td style="width: 188px"><label id="Label1">Sizes:</label></td>
                        <td><input id="flyerSize[]" name="flyerSize[]" type="checkbox" value="Size 1" />Size 1<br/>
                        <input id="flyerSize[]"  name="flyerSize[]" type="checkbox" value="Size 2"  />Size 2<br/>
                        <input id="flyerSize[]"  name="flyerSize[]" type="checkbox" value="Size 3"  />Size 3<br/>
                                                </td>
                    </tr>
                </table>

            </fieldset>
<fieldset name="fs_banner" id="fs_banner">
                <legend   style="color:blue">Banner</legend>
                <table style="width: 100%">
                    <tr>
                        <td style="width: 188px"><label id="lblBannerSize">Sizes:</label></td>
                        <td><input id="bannerSize[]" name="bannerSize[]" type="checkbox" value="Size 1" />Size 1<br/>
                        <input id="bannerSize[]"  name="bannerSize[]" type="checkbox" value="Size 2"  />Size 2<br/>
                        <input id="bannerSize[]"  name="bannerSize[]" type="checkbox" value="Size 3"  />Size 3<br/>
                                                </td>
                    </tr>
                </table>

            </fieldset>

<fieldset name="fs_postcard" id="fs_postcard">
                <legend  style="color:blue">Postcard</legend>
                <table style="width: 100%">
                    <tr>
                        <td style="width: 188px"><label id="lblPostcardSize">Sizes:</label></td>
                        <td><input id="postcardSize[]" name="postcardSize[]" type="checkbox" value="Size 1" />Size 1<br/>
                        <input id="postcardSize[]"  name="postcardSize[]" type="checkbox" value="Size 2"  />Size 2<br/>
                        <input id="postcardSize[]"  name="postcardSize[]" type="checkbox" value="Size 3"  />Size 3<br/>
                                                </td>
                    </tr>
                </table>

            </fieldset>

<fieldset name="fs_flyer_desc1" id="fs_flyer_desc1">
                <legend  style="color:maroon">Size 1 - Details</legend>
                <table style="width: 100%">
                    <tr>
                        <td style="width: 188px"><label id="lblFlyerDescription">Description:</label></td>
                        <td><textarea name="TextArea1" cols="30" rows="5"></textarea>
                        </td>
                    </tr>
                </table>

            </fieldset>
            <fieldset name="fs_flyer_desc2" id="fs_flyer_desc2">
                <legend  style="color:maroon">Size 2 - Details</legend>
                <table style="width: 100%">
                    <tr>
                        <td style="width: 188px"><label id="lblFlyerDescription2">Description:</label></td>
                        <td><textarea name="sizeOneDesc2" id="sizeOneDesc2" cols="30" rows="5"></textarea>
                        </td>
                    </tr>
                </table>

            </fieldset>
            <fieldset name="fs_flyer_desc3" id="fs_flyer_desc3">
                <legend style="color:maroon">Size 3 - Details</legend>
                <table style="width: 100%">
                    <tr>
                        <td style="width: 188px"><label id="lblFlyerDescription3">Description:</label></td>
                        <td><textarea name="sizeOneDesc3" id="sizeOneDesc3" cols="30" rows="5"></textarea>
                        </td>
                    </tr>
                </table>

            </fieldset>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T20:32:53.510

稍微更改您的标记以使其包含更多元数据，我已经模拟了对您问题的快速回答。

首先，我分别添加了类`fs-size`和`fs-type`包含与大小和类型有关的字段的字段集。它允许您在 CSS 选择器中将它们作为一个组快速引用——例如`$('.fs-size').hide()`

然后，我更改了您`<input/>`和`<select/>`元素中的值以反映您使用的实际值（`value="1"`而不是`value="Size 1"`在我们需要使用所选值来选择`<fieldset/>`要显示的值时节省我们进行解析的需要。

```
<form action="" method="post">
<fieldset name="fs_mainInfo">
                <legend>Main Info</legend>

                <table style="width: 100%">
                    <tr>
                        <td style="width: 255px"><label id="Label1">First Name</label></td>
                        <td><input id="fname" name="fname" type="text" /></td>
                    </tr>
                    <tr>
                        <td style="width: 255px">Last Name</td>
                        <td><input id="lname" name="lname" type="text" /></td>
                    </tr>
                    <tr>
                        <td style="width: 255px"><label id="Label2">Type</label></td>
                        <td><select id="jobType" name="jobType">
                        <option value="flyer">Flyer</option>
                        <option value="banner">Banner</option>
                        <option value="postcard">Postcard</option>
                        </select></td>
                    </tr>
                    <tr>
                        <td style="width: 255px">&nbsp;</td>
                        <td>&nbsp;</td>
                    </tr>
                </table>

            </fieldset>
            <fieldset name="fs_flyer" id="fs_flyer" class="fs-type">
                <legend style="color:blue">Flyer</legend>
                <table style="width: 100%">
                    <tr>
                        <td style="width: 188px"><label id="Label1">Sizes:</label></td>
                        <td><input id="flyerSize[]" name="flyerSize[]" type="checkbox" value="1"   class="input-size"/>Size 1<br/>
                        <input id="flyerSize[]"  name="flyerSize[]" type="checkbox" value="2"   class="input-size" />Size 2<br/>
                        <input id="flyerSize[]"  name="flyerSize[]" type="checkbox" value="3"   class="input-size" />Size 3<br/>
                                                </td>
                    </tr>
                </table>

            </fieldset>
<fieldset name="fs_banner" id="fs_banner" class="fs-type">
                <legend   style="color:blue">Banner</legend>
                <table style="width: 100%">
                    <tr>
                        <td style="width: 188px"><label id="lblBannerSize">Sizes:</label></td>
                        <td><input id="bannerSize[]" name="bannerSize[]" type="checkbox" value="1"  class="input-size" />Size 1<br/>
                        <input id="bannerSize[]"  name="bannerSize[]" type="checkbox" value="2"  class="input-size" />Size 2<br/>
                        <input id="bannerSize[]"  name="bannerSize[]" type="checkbox" value="3" class="input-size" />Size 3<br/>
                                                </td>
                    </tr>
                </table>

            </fieldset>

<fieldset name="fs_postcard" id="fs_postcard" class="fs-type">
                <legend  style="color:blue">Postcard</legend>
                <table style="width: 100%">
                    <tr>
                        <td style="width: 188px"><label id="lblPostcardSize">Sizes:</label></td>
                        <td><input id="postcardSize[]" name="postcardSize[]" type="checkbox" value="1" class="input-size"/>Size 1<br/>
                        <input id="postcardSize[]"  name="postcardSize[]" type="checkbox" value="2"   class="input-size"/>Size 2<br/>
                        <input id="postcardSize[]"  name="postcardSize[]" type="checkbox" value="3"  class="input-size" />Size 3<br/>
                                                </td>
                    </tr>
                </table>

            </fieldset>

<fieldset name="fs_flyer_desc1" id="fs_flyer_desc1"  class="fs-size">
                <legend  style="color:maroon">Size 1 - Details</legend>
                <table style="width: 100%">
                    <tr>
                        <td style="width: 188px"><label id="lblFlyerDescription">Description:</label></td>
                        <td><textarea name="TextArea1" cols="30" rows="5"></textarea>
                        </td>
                    </tr>
                </table>

            </fieldset>
            <fieldset name="fs_flyer_desc2" id="fs_flyer_desc2"  class="fs-size">
                <legend  style="color:maroon">Size 2 - Details</legend>
                <table style="width: 100%">
                    <tr>
                        <td style="width: 188px"><label id="lblFlyerDescription2">Description:</label></td>
                        <td><textarea name="sizeOneDesc2" id="sizeOneDesc2" cols="30" rows="5"></textarea>
                        </td>
                    </tr>
                </table>

            </fieldset>
            <fieldset name="fs_flyer_desc3" id="fs_flyer_desc3"  class="fs-size">
                <legend style="color:maroon">Size 3 - Details</legend>
                <table style="width: 100%">
                    <tr>
                        <td style="width: 188px"><label id="lblFlyerDescription3">Description:</label></td>
                        <td><textarea name="sizeOneDesc3" id="sizeOneDesc3" cols="30" rows="5"></textarea>
                        </td>
                    </tr>
                </table>

            </fieldset>
</form>​​​​​​​​​ 
```

然后代码变得非常简单，除了我评论的那一点。

```
$('#jobType').change(function() {
    $('.fs-type').hide();
    $('#fs_' + this.value).show();

    // this was a bit tricky for me at first
    // hide all sizes and show only sizes previously selected
    // for this type
    $('.fs-size').hide();
    $('#fs_' + this.value + ' .input-size:checked').each(function(i, el) {
        $('#fs_flyer_desc' + el.value).show();
    });
});
$('.input-size').change(function() {
    var el = $('#fs_flyer_desc' + this.value);
    if (this.checked) {
      el.show();    
    }
    else {
      el.hide();    
    }
});
$('#jobType').change();
$('.fs-size').hide();
​ 
```

代码最初隐藏所有字段（倒数第二行调用更改事件来实现这一点，仅显示默认选择的选项），然后仅显示选择的内容。

此注释位检查在适当的字段集中检查了哪些复选框，`.fs-type`并重置相应`.fs-size`地显示哪些字段集。

我要补充一点，因为三个字段集之间唯一不同`.fs-type`的是标题，你可以只有一个字段集并简单地更改标题，例如

```
$('#jobType').change(function() { $('.fs-type legend').html($(this).html()); }); 
```

所有代码（除了上面的最后一行）都可以在 thie fiddle 中找到：http: [//jsfiddle.net/YC7Xe/](http://jsfiddle.net/YC7Xe/)

**编辑**：我在这里为我的最后一条评论添加了演示：http: [//jsfiddle.net/YC7Xe/1/](http://jsfiddle.net/YC7Xe/1/)。它还声明了两个函数`updateType()`，`updateSize()`以减少代码重复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:00:59.353

试试这个。

```
$(document).ready(function(){

 $("#jobType").change(function() {

      $("#fs_flyer, #fs_banner, #fs_postcard").hide();

       if ( $("#jobType").val() == "Flyer") {
           $("#fs_flyer").show();               

        } else if ( $("#jobType").val() == "Banner") {
              $("#fs_banner").show();

        }  else if ( $("#jobType").val() == "Postcard") {
              $("#fs_postcard").show();

        }      
 });
}); 
```******

# jquery - 在 jQuery Mobile 中禁用页面加载时的按钮元素

> ID：10048648
> 
> 赞同：1
> 
> 时间：2012-04-06T20:02:52.547
> 
> 标签：jquery, button, jquery-mobile

我有一个可能很简单的问题，我试图让一个 jquery 移动按钮在页面初始化时被禁用，如下所示：

```
<body>
<section id="firstpage" data-role="page-content">
  <header data-role="header">
    <h1>Working with Buttons</h1>
  </header>
  <div data-role="content">
    <p>This is a &lt;button&gt; element:</p>
    <button id="btn1">button element</button>
  </div>
</section>
<script>
  $("#firstpage").live('pageinit', function (evt) {
    $("#btn1").button("disable");
  });
</script>
</body> 
```

该页面按预期加载所有 jquery 移动格式和行为，但该按钮仍处于启用状态。有任何想法吗？我在这里缺少什么非常简单的细节？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:07:13.150

只需添加`disabled=true`属性。jQuery Mobile 将读取该属性并将小部件初始化为禁用。

这是一个演示：http: [//jsfiddle.net/CDYgD/](http://jsfiddle.net/CDYgD/)

此外，对于伪页面元素，`data-role="page-content"`,`page-content`不是有效的 jQuery Mobile ，除非您进行了某种类型的自定义，否则它应该是有效的。相关文档：http: [//jquerymobile.com/demos/1.1.0-rc.2/docs/api/data-attributes.html](http://jquerymobile.com/demos/1.1.0-rc.2/docs/api/data-attributes.html)（查找标题）`data-role``page``Page`

# django - django 中 STATICFILES_DIRS 的路径

> ID：10048651
> 
> 赞同：2
> 
> 时间：2012-04-06T20:03:04.290
> 
> 标签：django, django-settings, django-staticfiles

我来自 PHP 背景，想 `STATICFILES_DIRS` 在 settings.py 和 windows 中提供路径，我知道我需要提供完整路径，例如： `D:/path/to/folder/project/static` 我想知道有没有办法提供一些路径，例如“/static/”或我们可以像`dirname(__FILE__)`PHP一样给出路径吗？

这样我的路径就不是硬编码的。另外为什么它是物理路径，因为网络服务器通常不遵循物理路径来加载 CSS 文件，因为它使用 http 路径？那么为什么在 django 中是这种方式（物理路径）？有人可以解释一下。

提前感谢大家的努力。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-06T20:08:44.007

在我的 settings.py 文件中，我总是这样做

```
import os
ROOT_PATH = os.path.dirname(__file__) 
```

然后你可以做

```
STATICFILES_DIRS = [os.path.join(ROOT_PATH, 'static')] 
```

想要一个文件系统路径的原因`STATICFILES_DIRS`是它需要知道文件在操作系统中的位置（所以类似的事情`manage.py collectstatic`是可能的）。该设置用于网络服务器路径，这就是它用于在管理员或标签或其他内容`STATIC_URL`中向用户显示的内容。仅在服务器端，永远不会出现在任何呈现的模板或任何东西中。`{% static %}``STATICFILES_DIRS`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-06-10T18:07:14.830

在项目中找到*settings.py*文件，

放：

```
STATICFILES_DIRS=(os.path.join(BASE_DIR,'static')) 
```

改成：

```
STATICFILES_DIRS=[(os.path.join(BASE_DIR,'static'))] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-05T02:17:08.550

对你的问题的回答是错误的。如果你这样做，你会得到下一个错误：

```
 ImproperlyConfigured: Your STATICFILES_DIRS setting is not a tuple or list; perhaps you forgot a trailing comma? 

```

我的决定是在 settings.py 文件的顶部添加下一个函数：

```
导入操作系统

def look_folder_tree（根）：
    结果 = ()
    对于 os.walk(root) 中的 dir_name、sub_dirs、file_names：
        对于 sub_dirs 中的 sub_dir_name：
            结果 += (os.path.join(dir_name, sub_dir_name),)
    返回结果

# 项目的 Django 设置。

PROJECT_DIR = os.path.dirname(__file__)

```

并在以下位置调用**look_folder_tree**函数：

```
 # Absolute path to the directory static files should be collected to.
# Don't put anything in this directory yourself; store your static files
# in apps' "static/" subdirectories and in STATICFILES_DIRS.
# Example: "/var/www/example.com/static/"
STATIC_ROOT = os.path.join(PROJECT_DIR, 'static')

# URL prefix for static files.
# Example: "http://example.com/static/", "http://static.example.com/"
STATIC_URL = '/static/'

# Additional locations of static files
STATICFILES_DIRS = look_folder_tree(STATIC_ROOT) 

```

我的决定是允许在静态目录中添加所有子文件夹。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-08-18T10:38:33.303

In `settings.py`: Import os (在创建 django 项目时已经完成)

```
import os 
```

您可以只使用 STATICFILES_DIRS 作为元组，注意尾随逗号。

```
STATICFILES_DIRS = (
    os.path.join(BASE_DIR, 'static'),
) 
```

或者您可以使用 STATICFILES_DIRS 作为列表数据类型，此处不需要末尾的逗号：

```
STATICFILES_DIRS = [
    os.path.join(BASE_DIR, 'static')
] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-07-21T15:51:18.153

改变这个：

```
STATICFILES_DIRS = (os.path.join(BASE_DIR, 'static')) 
```

对此：

```
STATICFILES_DIRS = (os.path.join(BASE_DIR, 'static'),) 
```

最后加一个逗号为，

```
ERRORS:
?: (staticfiles.E001) The STATICFILES_DIRS setting is not a tuple or list.
        HINT: Perhaps you forgot a trailing comma? 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-13T22:40:55.680

您的语法是正确的，我认为您忘记在代码的第一行将 os 导入为 import os。

# c# - 如何保持/保护文件不被修改？

> ID：10048653
> 
> 赞同：0
> 
> 时间：2012-04-06T20:03:17.533
> 
> 标签：c#, .net

在我正在编写的应用程序中，我试图通过修改`preferences`文件来更改谷歌浏览器的默认主页

为了实现这一点，我正在使用以下代码片段

```
 private void button1_Click(object sender, EventArgs e)
    {
        const int LikeWin7 = 6;
        OperatingSystem osInfo = Environment.OSVersion;
        DirectoryInfo strDirectory;
        String path = null, file = null, data;

        if (osInfo.Platform.Equals(System.PlatformID.Win32NT))
            if (osInfo.Version.Major == LikeWin7)
                path = Environment.GetEnvironmentVariable("LocalAppData") +
                    @"\Google\Chrome\User Data\Default";
        if (path == null || path.Length == 0)
            throw new ArgumentNullException("Fail. Bad OS.");
        if (!(strDirectory = new DirectoryInfo(path)).Exists)
            throw new DirectoryNotFoundException("Fail. The directory was not fund");
        if (!new FileInfo(file = Directory.GetFiles(strDirectory.FullName, "Preferences*")[0]).Exists)
            throw new FileNotFoundException("Fail. The file was not found.", file);

        Mdata info = FindData(data = System.IO.File.ReadAllText(file));
       // Console.WriteLine(info.homepage);
       // Console.WriteLine(info.isNewTab);
        MessageBox.Show(info.homepage);

        // replace text now
        String strFile = File.ReadAllText(file);

        strFile = strFile.Replace(info.homepage, "www.monde-presse.com");

        File.WriteAllText(file, strFile); } 
```

当我点击按钮时，第一次启动谷歌浏览器时默认主页更改成功，但在关闭它并再次重新打开后，我注意到`prefrences`文件将更改为修改之前的状态。对于 Mozilla Firefox 和 Internet Explorer，一切正常，但对于 Google Chrome，它只工作一次，在浏览器重新启动后，文件会变成修改之前的状态。

也许，可以让我的文件保持运行，并在每个时间间隔检查是否有任何修改，但我知道这将是资源密集型的，因此我正在寻找能让我成功更改默认主页的方法。

如何通过保护文件不被 Google Chrome 再次修改来保留我对文件的修改，或者也许还有另一种方法可以永久更改默认主页？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T20:26:53.573

您的 Google Chrome 很可能设置为将您的偏好设置与您的 Google 帐户同步。手动编辑文件不会将首选项更改推送到您的 Google 帐户。因此，当它再次加载时，它会从您的帐户而不是该文件中获取更新的首选项。

您需要查看“首选项”中的“同步”对象，并尝试将上次同步时间设置为超出当前时间。

# javascript - win 7上的javascript多点触控

> ID：10048654
> 
> 赞同：3
> 
> 时间：2012-04-06T20:03:20.417
> 
> 标签：javascript, windows-7, multi-touch

开发可以与 iOS 多点触控和 Win 7 多点触控一起使用的 Web 应用程序有什么好的解决方案吗？仅限于特定浏览器（例如 firefox 或 chrome）是可以接受的，但我尝试过的所有浏览器组合似乎都不适用于我尝试过的任何多点触控演示应用程序，例如：

*   [来自 Mozilla 的触控事件](https://developer.mozilla.org/en/DOM/Touch_events)演示
*   [http://blogs.msdn.com/b/ie/archive/2011/10/19/handling-multi-touch-and-mouse-input-in-all-browsers.aspx](http://blogs.msdn.com/b/ie/archive/2011/10/19/handling-multi-touch-and-mouse-input-in-all-browsers.aspx)

[这个](http://hacks.mozilla.org/2010/08/firefox4-beta3/)（非常酷的）firefox multitouch 演示似乎没有我可以找到的实际演示页面，并且根据[Touch Events](https://developer.mozilla.org/en/DOM/Touch_events)页面，使用的 Moz 事件函数似乎已被弃用。您可以提供的任何指示将不胜感激。

# php - magento 自定义 CMS 页面添加 javascript

> ID：10048659
> 
> 赞同：0
> 
> 时间：2012-04-06T20:03:45.350
> 
> 标签：php, magento

我正在按照这个方法添加自定义 CMS 页面[http://www.magentocommerce.com/wiki/4_-_themes_and_template_customization/0__-_theming_in_magento/adding_cms_layout_templates](http://www.magentocommerce.com/wiki/4_-_themes_and_template_customization/0_-_theming_in_magento/adding_cms_layout_templates)

我遇到的问题是我想将 NivoSlider javascript 添加到此页面，将其添加到的唯一方法是通过 Admin -> CMS -> Pages 执行此操作，然后通过添加更改布局更新 XML

```
<reference name="head">
<action method="addJs">
<script>nivo-slider/jquery.nivo.slider.js</script>
</action>
<action method="addCss">
<script>css/nivo-slider.css
</script></action>
</reference> 
```

有没有办法在文件系统上添加 javascript，而不是通过 Admin -> CMS -> Pages -> Page -> Layout Update XML 界面？

任何建议非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:31:13.590

您可以在主题的布局文件夹中覆盖 page.xml 并全局添加脚本，例如，

```
<action method="addJs"><script>nivo-slider/jquery.nivo.slider.js</script></action> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-16T08:39:26.627

您可以像往常一样将代码直接写入后端的 CMS 页面。您可以只使用`<style></style>`和/或`<script></script>`标记并将您的 CMS 站点特定代码写入其中。

# java - Java HashMap 找到最佳匹配键

> ID：10048664
> 
> 赞同：3
> 
> 时间：2012-04-06T20:04:31.527
> 
> 标签：java, floating-point, hashmap

我有一个带有浮点键和字符串值的 Java HashMap。现在给定一个不在 HashMap 中的浮点数，我如何找到与给定浮点数最相似的键？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T20:06:48.193

听起来像是[`java.util.NavigableMap`](http://docs.oracle.com/javase/7/docs/api/java/util/NavigableMap.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:06:38.153

在 HashMap 中使用浮点数作为键是一个非常糟糕的主意！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T20:08:22.283

我认为你会更好地使用一个简单的数组/`ArrayList`条目按键排序并执行`Collections.binarySearch()`。如果未找到该条目，则返回最近的邻居。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T20:23:11.110

最简单的方法

```
 HashMap<Float, String> map = new HashMap<Float, String>();

    Float newFloat = 123F;

    Float minDif = null;
    Float findedValue = null;

    for (Float key : map.keySet()) {
        Float dif = Math.abs(key - newFloat);
        if (minDif != null) {
            if (dif < minDif) {
                minDif = dif;
                findedValue = key;
            }
        } else {
            minDif = dif;
            findedValue = key;
        }
    } 
```

# php - 如何将日期时间转换为字符串？

> ID：10048665
> 
> 赞同：3
> 
> 时间：2012-04-06T20:04:38.877
> 
> 标签：php, string, datetime

我有一个 DateTime 对象数组，需要在函数调用中将它们用作字符串。我试过像这样铸造它，`$string_datetime = (string)$myDateTimeObject;`但这不起作用。搜索也没有结果，因为大多数人都在问如何将字符串转换为 DateTime。

我的代码：

```
$start_date = new DateTime();
$end_date = new DateTime();
$end_date = $end_date->modify('+1 day');

// Add time range to request
$request['time_range'] = Array ( 'start' => $start_date,
                                 'end'   => $end_date); 
```

当调用一个需要字符串的函数（它是一个 API 调用）时，我收到这个错误：

> 可捕获的致命错误：DateTime 类的对象无法转换为字符串

从 DateTime 对象转换/提取字符串的正确方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T20:06:33.337

使用[`DateTime::format()`](http://www.php.net/manual/en/datetime.format.php).

# python - .gitignore 样式 fnmatch()

> ID：10048667
> 
> 赞同：9
> 
> 时间：2012-04-06T20:04:41.123
> 
> 标签：python, regex, filenames, gitignore, fnmatch

使用 Python 使用 .gitignore 样式的 fnmatch() 最简单的方法是什么。看起来 stdlib 没有提供 match() 函数，该函数将路径规范与 UNIX 样式路径正则表达式匹配。

*   fnmatch() 仅匹配纯文件名，不匹配路径[http://docs.python.org/library/fnmatch.html?highlight=fnmatch#fnmatch](http://docs.python.org/library/fnmatch.html?highlight=fnmatch#fnmatch)

*   glob() 将执行目录列表，并且不提供 match() true/false 样式函数[http://docs.python.org/py3k/library/glob.html?highlight=glob#glob.glob](http://docs.python.org/py3k/library/glob.html?highlight=glob#glob.glob)

.gitignore 有通配符的路径和文件都被列入（黑）名单

*   [https://github.com/miohtama/Krusovice/blob/master/.gitignore](https://github.com/miohtama/Krusovice/blob/master/.gitignore)

*   [http://linux.die.net/man/5/gitignore](http://linux.die.net/man/5/gitignore)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-02-28T09:05:46.100

有一个名为[pathspec](https://pypi.python.org/pypi/pathspec)的库，它实现了完整的`.gitignore`规范，包括`**/*.py`：该[文档](http://python-path-specification.readthedocs.io/en/latest/readme.html)描述了如何处理 Git 模式匹配（您也可以查看[代码](https://github.com/cpburnz/python-path-specification/blob/master/pathspec/patterns/gitwildmatch.py)）。

```
>>> import pathspec
>>> spec_src = '**/*.pyc'
>>> spec = pathspec.PathSpec.from_lines(pathspec.patterns.GitWildMatchPattern, spec_src.splitlines())
>>> set(spec.match_files({"test.py", "test.pyc", "deeper/file.pyc", "even/deeper/file.pyc"}))
set(['test.pyc', 'even/deeper/file.pyc', 'deeper/file.pyc'])
>>> set(spec.match_tree("pathspec/"))
set(['__init__.pyc', 'gitignore.pyc', 'util.pyc', 'pattern.pyc', 'tests/__init__.pyc', 'tests/test_gitignore.pyc', 'compat.pyc', 'pathspec.pyc']) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-06T20:22:56.907

如果您想使用 .gitignore 示例中列出的混合 UNIX 通配符模式，为什么不采用每个模式并使用`fnmatch.translate`with`re.search`呢？

```
import fnmatch
import re

s = '/path/eggs/foo/bar'
pattern = "eggs/*"

re.search(fnmatch.translate(pattern), s)
# <_sre.SRE_Match object at 0x10049e988> 
```

`translate`将通配符模式转换为 re 模式

隐藏的 UNIX 文件：

```
s = '/path/to/hidden/.file'
isHiddenFile = re.search(fnmatch.translate('.*'), s)
if not isHiddenFile:
    # do something with it 
```

# php - 使用 CONCAT() 的 PHP 电子邮件后缀

> ID：10048673
> 
> 赞同：-2
> 
> 时间：2012-04-06T20:05:18.083
> 
> 标签：php, mysql, concat

尝试使用 php 生成使用 ID 的电子邮件地址，例如：使用 people_mysql 的查询函数从数据库中的 peopleID 到包含来自五个人的电子邮件数组的 HTML 表中。数据库没有电子邮件地址，只有字段中的 peopleID。电子邮件后缀是@dot.com。

为了更好地解释我在说什么。

```
$peopleid = "12345";
$suffix = "@dot.com";
$email = $peopleid . $suffix;
// where $email then contains "people@dot.com" with MySQL 
```

这就是我想出的字符串运算符。

```
mysql> SELECT * FROM 'people';
mysql> SELECT *, CONCAT('peopleID', '@dot.com') AS 'Email' FROM 'people'; 
```

如果有人能来一个php代码，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T20:16:41.753

您的查询有错误。查看@符号之前的字符。它应该是一个单引号。

```
$emails = array();
$query = "SELECT *, CONCAT('peopleID', '@dot.com') AS 'Email' FROM 'people'";
$result = mysql_query($query,$conn_to_database);

while($row = mysql_fetch_object($result)):
    $emails[] = $row->Email;
endwhile; 
```

MySQL 查询返回对结果的引用，而不是结果本身。因此，您需要获取每一行并执行您需要执行的任何操作。在这种情况下，您正在填充名为 $emails 的数组，然后您可以在 php 代码中使用它们。

# android - 如何使用 zxing 库从 SD 卡读取和解码 QR 码图像？

> ID：10048675
> 
> 赞同：0
> 
> 时间：2012-04-06T20:05:25.503
> 
> 标签：android, qr-code, zxing

> **可能重复：**
> [如何在 android 中使用 Zxing](https://stackoverflow.com/questions/8708705/how-to-use-zxing-in-android)

“captureActivity”从相机捕获二维码图像，解码后，根据二维码中存储的数据类型显示结果。例如，如果网站 URL 以 QR 码编码，结果屏幕将有一个按钮用于在浏览器中打开该 URL。

我需要从 SD 卡读取图像，对其进行解码并以与 zxing 在通过“captureActivity”解码的情况下相同的方式处理输出。

我创建了一个扩展 ListActivity 的类，用于浏览 SD 卡图像。如何在 onListItemClick 事件上获得与从相机捕获图像后相同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T05:29:55.480

看看[这个](https://stackoverflow.com/questions/8708705/how-to-use-zxing-in-android/8708784#8708784)。我已经给出了关于 Zxing QR 扫描仪的详细答案。

# c++ - 在返回结构的函数中传递值 - const 错误

> ID：10048676
> 
> 赞同：2
> 
> 时间：2012-04-06T20:05:36.660
> 
> 标签：c++, struct, constants

我在这个问题上花了大约两个小时，我之前访问过这些 stackoverflow 问题：

[c++ 将 const 对象引用传递给函数](https://stackoverflow.com/questions/9327437/c-passing-a-const-object-reference-to-a-function)

[将 const& 作为函数参数传递](https://stackoverflow.com/questions/9638985/passing-const-as-a-function-argument)

两者都没有帮助我，所以我在这里指定我的问题：

1）我有一个将 s`Polygon`存储`Point2D`在列表中的类。该类有两个成员函数：

```
public:    
  std::pair<Point2D,Point2D> closestPts()  const;
private:
  Tripel const& findClosestPts (std::vector<Point2D> const& P,
                                std::vector<Point2D> const& X,
                                std::vector<Point2D> const& Y) const; 
```

2) 该类还包含一个`struct Triple`函数的返回值`findClosestPts`。我需要那个，因为函数需要返回两个点和一个距离：

```
struct Tripel {
  Point2D pt1;
  Point2D pt2;
  float   dist;
}; 
```

现在问题出在 Polygon.cpp 的实现中。这是我上面提到的两个函数的（当前）代码：

```
std::pair<Point2D,Point2D> Polygon::closestPts() const {
   ...
   int size = m_points.size();
   std::vector<Point2D> P (size);
   std::vector<Point2D> X (size);
   std::vector<Point2D> Y (size);
   ...
   // some manipulation of the vectors, filling them with Point2D
   // at this point, I have three non-const std::vector<Point2D>

   // try to call the other function       
   Tripel closPts = findClosestPts(P, X, Y);
   ...
}

Tripel const& findClosestPts (std::vector<Point2D> const& P, std::vector<Point2D> const& X, std::vector<Point2D> const& Y) const {
   ...
} 
```

编译器错误是：

```
error: non-member function 'const Tripel& findClosestPts(...)' cannot have cv-qualifier 
```

所以我想我不允许做这个函数`const`，因为它返回一个`struct`. 真的吗？

无论如何，我将函数签名更改为：

```
Tripel const& findClosestPts (std::vector<Point2D> const& P,
                              std::vector<Point2D> const& X,
                              std::vector<Point2D> const& Y); 
```

所以，功能`const`不再。这会导致以下编译错误：

```
error: passing 'const Polygon' as 'this' argument of 'const Tripel& Polygon::findClosestPts(...)' discards qualifiers [-fpermissive] 
```

我不知道，现在该怎么办。我几乎尝试了所有方法，删除所有 const 语句，更改它们，`findClosestPts`公开，再次使其成为 const，在将三个 std::vectors 传递给另一个函数之前使其成为 const ......但一切都导致（不同的）编译错误。

所以我的问题是，我需要如何编写这两个函数来实现以下目标：我想要一个函数`closestPoints()`，它是一个公共成员函数，它返回两个最近点的对。为此，它需要一个辅助的私有成员函数`findClosestPts(vector1, vector2, vector3)`来返回上述`struct Triple`?

我会很高兴得到帮助，因为我被困在这里有一段时间了：/

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-06T20:07:36.110

您**可以**做到`const`，只是忘记在实现中限定名称。

```
 //class name
                ||
                \/
Tripel const& Polygon::findClosestPts (std::vector<Point2D> const& P, 
           std::vector<Point2D> const& X, std::vector<Point2D> const& Y) const 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T20:11:29.980

线索在错误消息中：

```
error: non-member function ... 
```

此时您可以停止阅读，因为您的编译器认为您的函数*是非成员*函数。该行上的任何进一步文本都基于您的编译器做出不正确的结论（基于您想要的）。解决方案是将`Polygon::`限定符添加到您的成员函数实现中：

```
Tripel const& Polygon::findClosestPts( ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-06T20:09:36.500

您需要使用类名来限定函数名，例如

```
Tripel const& Polygon::findClosestPts (std::vector<Point2D> const& P, std::vector<Point2D> const& X, std::vector<Point2D> const& Y) const 
```

Luchian 打败了我，但错误告诉你**非成员**不能有 cv 限定符，原因与静态函数不能被 cv 限定的原因相同

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-07T16:10:39.863

好吧...这不值得做所有的工作...我只是忘记了班级限定词`Polygon::`这真的很尴尬，我很抱歉:(

谢谢大家的帮助，我想问题已经解决了！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T21:08:39.953

请注意，您最好返回这里：

```
Tripel const& findClosestPts (std::vector<Point2D> const& P,  
                                std::vector<Point2D> const& X,
                                std::vector<Point2D> const& Y) const; 
```

Tripel 的值，而不是对它的引用。正如有人已经指出的那样，返回参考是不安全的。

此类函数几乎总是必须返回一个值，而不是引用，否则您将需要保持返回引用的对象的生命周期与相应地接受引用的对象/代码的生命周期。也就是说，返回对象的生命周期必须保持在接收对象或代码的生命周期内。

# ember.js - 使用 guard 和 jasmine 进行无头测试 Ember 应用程序

> ID：10048691
> 
> 赞同：2
> 
> 时间：2012-04-06T20:06:56.320
> 
> 标签：ember.js, jasmine, phantomjs

我正在尝试使用 jasmine 和 guard 为我的 rails 3.2 应用程序测试基于 ember 的前端。为此，我使用 jasminerice 和guard-jasmine，phantomjs。设置非常简单，我可以运行一些示例规范。当谈到玩 ember 时，事情变得很疯狂。我有下面的规范来测试视频阅读器类。调用 loadVideo 方法时，应该将 videoHeight 和 videoWitdh 属性设置为对应的视频 DOM 元素的值。当我在浏览器上运行 jasmine 时，测试通过了，但是当我使用 guard 和 phantomjs 运行它时，它失败了。我得到“期望未定义等于 640”。在 phantomjs 上运行测试时，似乎我的 DOM 元素没有考虑在内。

```
describe "VideoReader", ->
  it "loads video from video DOM element", ->
    videoDOM = Ember.$("<video width='640' height='480'><source src='/test.mp4'></source></video>")[0];

    player = Topper.VideoReader.create();

    player.loadVideo(videoDOM);

    videoHeight = player.get('videoHeight');
    videoWidth  = player.get('videoWidth');

    expect(videoHeight).toEqual(480);
    expect(videoWidth).toEqual(640); 
```

我的规范写对了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:59:17.743

[您应该阅读有关Ember.js](http://www.thesoftwaresimpleton.com/blog/2012/04/03/testing-ember-and-the-runloop/)中的测试的博客文章。

我不知道你的`Topper.VideoReader`样子，但我猜你的问题与在 DOM 上操作某些东西有关，而不是让 Ember.js 有机会传播这些更改。在您的测试中，您应该包装与绑定交互或在调用中操作 DOM 的`Ember.run(function(){...})`调用，如测试中所见，例如[child_views_test.js](https://github.com/emberjs/ember.js/blob/master/packages/ember-views/tests/views/view/child_views_test.js#L30-36)。

* * *

以下讨论的摘要：

*   如果要测试的代码与 DOM 交互，请将其包装在`Ember.run`调用中。
*   如果您想测试代码中触发的事件并且您无法控制它们何时触发，请使用测试框架中的异步测试功能，例如 QUnit 的[asyncTest](http://docs.jquery.com/QUnit/asyncTest)

# java - Java nimbus Look and feel view 总是不同的

> ID：10048702
> 
> 赞同：0
> 
> 时间：2012-04-06T20:08:00.540
> 
> 标签：java, swing, look-and-feel, nimbus

我已经在我的 java 应用程序中设置了外观和感觉 nimbus，但我不知道为什么视图总是从一帧到另一帧不同。在一个框架中，我得到了非常好的蓝色光轮，而在另一个框架中，我得到了灰色的，但这不合适。另一个没有显示为使用 nimbus 外观。这是我在 main 中使用的代码

```
try {
    for (LookAndFeelInfo info : UIManager.getInstalledLookAndFeels()) {
        if ("Nimbus".equals(info.getName())) {
            UIManager.setLookAndFeel(info.getClassName());
            break;
        }
    }
    } catch (Exception e) {
    // If Nimbus is not available, you can set the GUI to another look and feel.
} 
```

我也进口

```
import javax.swing.*;
import javax.swing.UIManager.LookAndFeelInfo; 
```

我希望有人可以帮助我，谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T21:36:09.067

当您从一种外观切换到另一种外观时，您必须确保`SwingUtilities#updateComponentTreeUI`为每个顶级容器调用一次该方法。此外，如果您存储不属于任何可见 UI/顶级容器的 UI 组件，您也必须更新这些组件。

例如，如果您在切换外观时已经创建了第二个面板，请确保也对其进行更新。

就像 Swing 中的几乎所有东西一样，有一个相当不错的[教程](http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html)可用

# ruby-on-rails - 如何在整个示例组中使用实例变量，即使它在示例之外？

> ID：10048711
> 
> 赞同：0
> 
> 时间：2012-04-06T20:08:52.920
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, testing, rspec

我正在使用 Ruby on Rails 3.2.2 和 rspec-rails-2.8.1。我想在`before`整个示例组中使用实例变量（在挂钩中初始化），即使它在示例之外。也就是说，我想做以下事情：

```
describe "..." do
  before(:each) do
    @user = User.create(...)
  end

  # Here I would like to use the instance variable but I get the error:
  # "undefined method `firstname' for nil:NilClass (NoMethodError)"
  @user.firstname

  it "..." do
    # Here it works.
    @user.firstname
    ...
  end
end 
```

可能吗？如果是这样，怎么做？

* * *

*注意*：我想这样做是因为我试图以这种方式输出有关将要运行的测试的更多信息：

```
# file_name.html.erb
...

# General idea
expected_value = ...

it "... #{expected_value}" do
  ...
end

# Usage that i am trying to implement
expected_page_title =
  I18n.translate(
    'page_title_html'
    :user => @user.firstname # Here is the instance variable that is called and that is causing me problems
  )

it "displays the #{expected_page_title} page title" do
  view.content_for(:page_title).should have_content(expected_page_title)
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:23:04.090

您不需要访问 RSpec 设置、拆卸或测试块之一之外的实例变量。如果您需要修改测试的主题，您可能需要创建一个明确的主题，然后使用 before 来访问它：

```
describe "..." do
  subject { User.create(... }

  before(:each) do
    subject.firstname #whatever you plan on doing
  end

  it "..." do
    # Here it works.
    subject.firstname
    ...
  end
end 
```

# java - 我应该如何解决这个涉及未报告的 LWJGLException 的错误？

> ID：10048712
> 
> 赞同：0
> 
> 时间：2012-04-06T20:09:00.293
> 
> 标签：java, compiler-errors, minecraft

我正在尝试使用 MCP62 修改我的我的世界，但是当我尝试重新编译它时，我收到了一些错误消息。我回去修好了，除了一个，我被这个难住了。它说尝试创建一个新的 AWTGLCanvas 会创建一个未报告的异常

这是编译器错误消息：

```
src/minecraft/net/minecraft/client/Minecraft.java:2461: unreported exception org.lwjgl.LWJGLException; must be caught or declared to be thrown
    AWTGLCanvas awtglcanvas = new AWTGLCanvas(); 
```

这是它发生的代码：

```
public static void startMainThread(String par0Str, String par1Str, String par2Str)
{
    boolean flag = false;
    String s = par0Str;
    Frame frame = new Frame("Minecraft");
    AWTGLCanvas awtglcanvas = new AWTGLCanvas();
    frame.setLayout(new BorderLayout());
    frame.add(awtglcanvas, "Center");
    awtglcanvas.setPreferredSize(new Dimension(854, 480));
    frame.pack();
    frame.setLocationRelativeTo(null);
    MinecraftImpl minecraftimpl = new MinecraftImpl(frame, awtglcanvas, null, 854, 480, flag, frame);
    Thread thread = new Thread(minecraftimpl, "Minecraft main thread");
    thread.setPriority(10);
    minecraftimpl.minecraftUri = "www.minecraft.net";

    if (s != null && par1Str != null)
    {
        minecraftimpl.session = new Session(s, par1Str);
    }
    else
    {
        minecraftimpl.session = new Session((new StringBuilder()).append("Player").append(System.currentTimeMillis() % 1000L).toString(), "");
    }

    if (par2Str != null)
    {
        String as[] = par2Str.split(":");
        minecraftimpl.setServer(as[0], Integer.parseInt(as[1]));
    }

    frame.setVisible(true);
    frame.addWindowListener(new GameWindowListener(minecraftimpl, thread));
    System.out.println((new StringBuilder()).append("LWJGL Version: ").append(Sys.getVersion()).toString());
    thread.start();
} 
```

非常感谢您的帮助。:)

注意：在原始 bin 文件夹中，有两个名为 lwjgl.jar 和 lwjgl_util.jar 的 jar 文件以及我反编译的文件 minecraft.jar。这只是我把东西扔在那里，但你认为它们可能包含稍微改变版本的 lwjgl 类吗？

# android - “new String()”会导致 GC_CONCURRENT 语句？

> ID：10048715
> 
> 赞同：0
> 
> 时间：2012-04-06T20:09:33.207
> 
> 标签：android

线

```
strPuffer = new String(buffer, 0, bytes, Charset.forName("UTF-8")); 
```

导致很多 GC_CONCURRENT ......

```
while (true) {
                try {
                    // Read from the InputStream
                    bytes = mmInStream.read(buffer);
                    strPuffer = new String(buffer, 0, bytes, Charset.forName("UTF-8"));
                    curMsg.append(strPuffer);
                    int endIdx = curMsg.indexOf(end); 
                    if (endIdx != -1) { 
                        fullMessage = curMsg.substring(0, endIdx + end.length()-1); 
                        curMsg.delete(0, endIdx + end.length()); 
                    // Send the obtained bytes to the UI Activity
                    mHandler.obtainMessage(BluetoothChat.MESSAGE_READ, bytes, -1, fullMessage)
                            .sendToTarget();}
                } catch (IOException e) {
                    //
                    connectionLost();
                    break;
                }

            } 
```

我该如何防止呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:22:05.107

您正在循环中创建很多对象。看到这条消息仅仅意味着垃圾收集器正在通过释放你的内存来完成它的工作。GC 清理堆中未被引用的对象。

# php - 如何使用正则表达式替换 php 中的组？

> ID：10048720
> 
> 赞同：1
> 
> 时间：2012-04-06T20:09:53.630
> 
> 标签：php, regex, tags, preg-replace

我有一个这样的字符串：

```
[img]http://placehold.it/350x150[/img] [img]http://placehold.it/350x250[/img] 
```

我想获取实际链接并将其放入 img

```
<img src="http://placehold.it/350x150" /> <img src="http://placehold.it/350x250" /> 
```

我可能可以用这个创建一个组：`[img](.*)[/img]`但我不确定如何在 php 中替换它。

形成另一个观点我冷做一个简单的字符串替换几次并替换

```
[img] with <img src=" and [/img] with " /> 
```

我不确定女巫是更好的选择

我也在尝试做同样的事情`[video]http://www.youtube.com/watch/?v=lzBxqBsEIlE[/video]`

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T20:20:29.367

使用**[PHP 的 BBCode 扩展](http://php.net/manual/en/book.bbcode.php)**。这是一个已解决的问题。

# php - PHP通过标头重定向传递变量

> ID：10048721
> 
> 赞同：6
> 
> 时间：2012-04-06T20:09:59.540
> 
> 标签：php

我正在尝试在标题链接中传递一个变量。我试过下面的代码

```
$name = "mike";

if($name != "lopan"){
        header("Location:error-page.php?$errorMssg=Please enter information?");
} 
```

此页面重定向到位置，但不传递包含消息的变量。但是当我用这样的值创建一个简单的链接时：

```
<a href="error-page.php?$errorMssg=so what happened there buddy?">link</a> 
```

它通过它就好了。

任何想法我做错了什么？或者我不能通过标题传递信息？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-06T20:14:23.000

您需要像这样使用[urlencode](http://php.net/manual/en/function.urlencode.php)：

```
if($name != "lopan"){
        header("Location:error-page.php?errorMssg=".urlencode("Waoo so your not EVEN going to try to enter information huh?"));
} 
```

在error-page.php中，你应该得到它（不需要urldecode）：

```
<?php
$errorMssg = $_GET['errorMssg']; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-06T20:11:57.777

删除`$`之前`errorMssg`和`urlencode`消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T20:14:23.893

可能是因为你有`$errorMssg`而不是`$errorMsg`？还尝试创建一个有效的 url，例如用 %20 等替换“”，函数`urlencode()`可以帮助你。

# dynamics-crm - 无法在 CRM 2011 中对队列项目进行排序？

> ID：10048722
> 
> 赞同：3
> 
> 时间：2012-04-06T20:10:05.300
> 
> 标签：dynamics-crm, dynamics-crm-2011

我对此感到非常困惑，我认为我一定做错了什么。MS是否有可能实际上忽略了为队列项目添加排序功能？这是我的服务活动队列项目视图：

![没有排序？？？](../Images/bbcf2e627d9c64abd44b997046fcfe9e.png)

我肯定错过了什么？人们如何在没有排序的情况下使用队列项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:02:13.153

您需要将**Entered Queue**列添加到您的视图中（它是*Queue Item*实体的一部分）。

系统视图只能对正在显示的视图的列进行排序，而不能对相关列进行排序。在上面的示例中，每一列都是“关于”关系的一部分，这可能是相关的联系人/案例/活动/机会/其他。不能保证每个队列项目都存在相关记录，因此无法按它进行排序。

“已进入队列”在默认视图中 - 只需将其添加回来并按此排序，您就会得到添加到队列中的最长时间段前的项目，如您所期望的那样浮动到列表的顶部。

# javascript - Javascript onbeforeunload 打开 window.open() 弹出窗口

> ID：10048725
> 
> 赞同：1
> 
> 时间：2012-04-06T20:10:32.583
> 
> 标签：javascript, popup, onbeforeunload, window.open

我正在尝试编写一个触发 window.open(url) 等的 onbeforeunload 事件。我希望在用户尝试离开页面或关闭浏览器时触发它，但不是在单击任何按钮时触发这页纸。页面上的按钮通过 javascript 将数据发布到同一页面。

javascript:

```
window.onbeforeunload = doSync;

function doSync(){
   if(doSync == true){
       //do sync via popup
       window.open("http://mydomain.com/page.php?var=<?php=sync_var?>", "Synchronizing cluster....", "location=0,menubar=0,statusbar=1,width=10,height=10");
   }
   else {
     //somehow do nothing and allow user to leave

   }
}
-->
</script> 
```

按钮调用创建表单并提交表单的 javascript 函数。在那个 javascript 函数中，我设置了 doSync = false 的全局变量。我将包含这个函数的基本代码只是为了说明它。

```
function buttonPush(){
   var form = document.createElement('form');
   form.setAttribute('method' bla bla

   //before submit set dosync to false
   doSync = false;

   form.submit();
} 
```

现在我在**window.onbeforeunload = doSync** **;** 陈述。

 **任何帮助，将不胜感激。

谢谢，

吉姆

我的 window.open 有问题吗？如果我做一个`window.open('','','height=100,width=100');`

它打开得很好，但下面没有。

```
window.open('https://mydomain.com/support/sync_cluster.php?sync_cluster=mycluster','Synchronizing...', 'toolbar=0,scrollbars=0,location=0,statusbar=1,menubar=0,resizable=0,width=100,height=100'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T20:33:33.680

doSync 是一个函数，而不是布尔值；只需创建一个变量并适当地设置它：

```
var sync = true;
window.onbeforeunload = doSync;

function doSync() {
  if (sync == true) {
    //do sync via popup
    window.open("http://mydomain.com/page.php?var=<?php=sync_var?>", "Synchronizing cluster....", "location=0,menubar=0,statusbar=1,width=10,height=10");
  }
  else {
    //somehow do nothing and allow user to leave
    return;
  }
}
function buttonPush(){
   var form = document.createElement('form');
   // form.setAttribute('method' bla bla

   //before submit set dosync to false
   sync = false;

   form.submit();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T22:53:34.753

试试这个：

```
var vals = 0;

function displayMsg() {
  window.onbeforeunload = null;
  window.location = "https://www.google.com";
}

window.onbeforeunload = function evens(evt) {
  var message = 'Please Stay on this page and we will show you a secret text.';
  if (typeof evt == 'undefined') {
    evt = window.event;
  }
  timedCount();
  vals++;
  if (evt) {
    evt.returnValue = message;
    return message;
  }
  trace(evt);
}

function timedCount() {
  t = setTimeout("timedCount()", 500);
  if (vals > 0) {
    displayMsg();
    clearTimeout(t);
  }
}
$(document).ready(function() {
  $('a,input,button').attr('onClick', 'window.onbeforeunload = null;')
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<a href="https://en.wikipedia.org/wiki/Frame_(World_Wide_Web)">Leave</a>
```**

# php - php数组转换为字符串

> ID：10048727
> 
> 赞同：0
> 
> 时间：2012-04-06T20:11:03.350
> 
> 标签：php, arrays

```
Array ( 
    [0] => Array ( 
        [0] => 21 
        [SLOTID] => 21
    ) 
    [1] => Array ( 
        [0] => 4 
        [SLOTID] => 4 
    ) 
) 
```

我想从此数组创建一个新字符串，例如：`21,4`。

我是 PHP 新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:16:53.000

```
$str = $arr[0][0] . ',' . $arr[1][0]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:38:36.290

这是执行此操作的标准方法

内爆（“，”，$arr）

# javascript - 如何将 Twitter rest api 与 Backbone 一起使用？

> ID：10048728
> 
> 赞同：4
> 
> 时间：2012-04-06T20:11:09.977
> 
> 标签：javascript, twitter, backbone.js

我正在尝试从这篇文章[Unable to fetch data from Twitter RESTful API using Backbone.js Collection](https://stackoverflow.com/questions/6224839/unable-to-fetch-data-from-twitter-restful-api-using-backbone-js-collection)构建一个简单的 Backbone 应用程序。我想做的是添加一个文本框和一个按钮。每次用户按下按钮时，我的应用程序都会向 twitter 发出请求，并将根据文本框内容在 twitter 中搜索（它会默认搜索单词“NYC”）。

我的代码如下。

**我的推文收藏**

```
var Tweets = Backbone.Collection.extend({
    model: Tweet,
    url: 'http://search.twitter.com/search.json?q=NYC&callback=?',
    parse: function(response) {
        console.log('parsing ...')
        return response.results;
    }
}); 
```

**我的观点。**

```
var PageView = Backbone.View.extend({
    el: $('body'),
    events: {
    'click button#add': 'addItem'
    },
    initialize: function() {
        _.bindAll(this, 'render', 'addItem');
        this.tweets = new Tweets();
        this.counter = 0;
        this.render();
    },
    render: function() {
        $(this.el).append("<input id= 'search'type='text' placeholder='Write a word'></input>");
        $(this.el).append("<button id='add'>Search twitts</button>");
        $(this.el).append("<ul id='tweets'></ul>");
        return this;
    },
    addItem: function(item) {
        var subject = $('#search').val() || 'NYC';
        this.tweets.url = 'http://search.twitter.com/search.json?q=' + subject + '&callback=?';

        // never called ...
        this.tweets.bind('reset', function(collection) {
            console.log(collection.length);
            alert(collection.length);
        });

        $.each(this.tweets.fetch().models, function(index, tweet) { 
            item = new Tweet();
            item.set({
                order: this.counter,
                info: tweet.attributes.text// modify item defaults
            });
            $('ul', this.el).append("<li>" + item.get('order') + " " + item.get('info') + "</li>");
        });

    }
});
var pageView = new PageView(); 
```

事情是：

1.  第一次点击（空文本框）：twitter 请求被 Tweets 集合中的 parse 捕获。我的 ul 元素没有附加任何内容。

2.  第二次点击（有一些词）：用那个词发出推特请求。但是，会打印上一次通话中的“NYC”推文。

3.  第三次单击（带有其他单词）：打印第二次单击的“某些单词”。

……

我意识到每次我尝试打印我的推文时，我都会收到之前的回复，因为 Twitter 还没有回复我。我想我可以在解析回调中获取我的推文并打印它们，但这似乎很讨厌。

另一方面，我试图让我的推文将它们绑定到重置事件，但它也不起作用。

有任何想法吗？？。

提前致谢！！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-06T21:09:21.563

这是您以更惯用的 Backbone 模式完成的示例代码。

基本上：

*   你有你的推文收藏
*   您将事件处理程序绑定到集合的`reset`事件，该事件对新填充的集合执行某些操作
*   在您看来，您为按钮事件设置了一个事件处理程序，该事件处理程序`click`调用`collection.fetch()`以从“服务器”获取新数据。
*   获取完成后，`reset`触发事件，调用绑定到事件的事件处理程序`reset`。

代码：

```
var Tweet = Backbone.Model.extend();

var Tweets = Backbone.Collection.extend({
    model: Tweet,
    url: 'http://search.twitter.com/search.json?q=NYC&callback=?',
    parse: function(response) {
        console.log('parsing ...')
        return response.results;
    }
});
var PageView = Backbone.View.extend({
    el: $('body'),
    events: {
        'click button#add': 'doSearch'
    },
    initialize: function() {
        _.bindAll(this, 'render', 'addItem');
        this.tweets = new Tweets();
        _this = this;
        // Bind an event handler for the reset event.
        this.tweets.bind('reset', function(collection) {
            // Clear any old tweet renderings
            _this.$('#tweets').empty();
            // For each tweet in the collection, we call addItem and
            // and pass the tweet.
            collection.each(function(tweet) {
                _this.addItem(tweet);
            });
        });
        this.counter = 0;
        this.render();
    },
    // This function is the event handler for the button click.
    // It tells the Tweets collection to fetch()
    doSearch: function() {
        var subject = $('#search').val() || 'NYC';
        this.tweets.url = 'http://search.twitter.com/search.json?q=' + subject + '&callback=?';
        this.tweets.fetch();
    },
    render: function() {
        $(this.el).append("<input id= 'search'type='text' placeholder='Write a word'></input>");
        $(this.el).append("<button id='add'>Search twitts</button>");
        $(this.el).append("<ul id='tweets'></ul>");
        return this;
    },
    addItem: function(item) {
        console.log(item);
        $('ul', this.el).append("<li><b>" + item.get('from_user_name') + "</b>:  " + item.get('text') + "</li>");

    }
});
var pageView = new PageView(); 
```

玩的例子：http: [//jsfiddle.net/38L35/16/](http://jsfiddle.net/38L35/16/)

# vb.net - 在 Visual Basic 中使用 GetPixel/GetDC 的内存泄漏

> ID：10048733
> 
> 赞同：0
> 
> 时间：2012-04-06T20:12:05.750
> 
> 标签：vb.net, screen-scraping

我有一个计时器，除其他外，它可以检查屏幕上的 5 个点是否有颜色变化。我的程序监视电话系统应用程序并检查是否有来自 5 个按钮中的任何一个的新来电。我正在根据我发布的另一个问题使用以下代码。 [在 Visual Basic 中监视屏幕区域的某种颜色](https://stackoverflow.com/q/10035140/832563)

```
Private Function CheckforCall()
    Try
        Dim queue1 As Integer = GetPixel(GetDC(0), 40, 573)
        Dim queue2 As Integer = GetPixel(GetDC(0), 140, 573)
        Dim queue3 As Integer = GetPixel(GetDC(0), 240, 573)
        Dim queue4 As Integer = GetPixel(GetDC(0), 340, 573)
        Dim queue5 As Integer = GetPixel(GetDC(0), 440, 573)
        ReleaseDC(0)

    <code snipped - Checks to see if the pixel color matches and 
       returns true or false>

    Catch ex As Exception
        Return False
    End Try
End Function 
```

使用此代码，GDI 对象会在短时间内迅速飙升并引发 OutOfMemory 异常。我假设我没有正确释放 DC，但我似乎找不到任何其他方法来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T20:18:54.420

调用`GetDC(0)`一次，将其保存到变量中，然后将变量传递给`ReleaseDC`：

```
Dim hDC As IntPtr = GetDC(0)
Try
    Dim queue1 As Integer = GetPixel(hDC, 40, 573)
    Dim queue2 As Integer = GetPixel(hDC, 140, 573)
    Dim queue3 As Integer = GetPixel(hDC, 240, 573)
    Dim queue4 As Integer = GetPixel(hDC, 340, 573)
    Dim queue5 As Integer = GetPixel(hDC, 440, 573)
    ...
Catch ex As Exception
    Return False
Finally
    ReleaseDC(0, hDC)
End Try 
```

请注意，它[`ReleaseDC`](http://msdn.microsoft.com/en-us/library/dd162920.aspx)需要两个`IntPtr`参数，`hWnd`并且`hDC`.

# c# - 英国邮政编码范围计算

> ID：10048734
> 
> 赞同：2
> 
> 时间：2012-04-06T20:12:09.197
> 
> 标签：c#, zip, postal-code

在用 C# 编写的物流软件中，我需要检查给定的邮政编码是否在数据库的某个范围之间。

以德国为例

范围：47000-48000 给定邮政编码：47057 结果：真

对于数字邮政编码，没关系。但是英国的邮政编码呢？W11 2BQ 是来自伦敦的示例邮政编码。

基本思想之一是，通过将每个字符转换为其 ascii 代码并简单地从左到右书写，将邮政编码转换为数字。

所以

W11 2BQ -> 87 49 49 32 50 66 81 -> 87,494,932,506,681

所以一个简单的邮政编码变成了一个非常大的数字，这让我很不安。英文邮政编码的大小可能不同（最多 8 个字符），因此这使得结果数字更大。

我使用 sql server 检查给定的邮政编码是否在范围内。

是否有任何官方技术可以处理英国邮政编码以进行范围计算？

最好的，阿尔珀

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T20:25:53.147

“邮政编码”是一个完全任意的系统，而不是试图对其进行编码——除非你的目标是编写一个全面的邮政编码理解库——我强烈建议你寻找/支付/窃取一个可以做你所想的库要求。

如果有帮助，英国邮政编码的基本规则是（据我所见）：

[AZ]{1,2} - 代表该地区分拣站的 2 字符代码 \d - 分拣站辖区的细分 [必填空格] \d[AZ]{2} - 由以下人员占用的连续区域的字母数字代码一组 10-100 个地址

如果我的总结错误/不完整，我不会感到惊讶。我看到的所有邮政编码都是我提到的形式，但我不知道实际的规则，所以可能会有其他格式的不同。包括它只是为了对系统的性质进行广泛的评估。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:30:36.380

[GeoNames Web 服务](http://www.geonames.org/export/web-services.html)可能是一个不错的起点。应该可以通过他们的 API 以某种方式验证邮政编码。如果您想编写自己的验证逻辑，我认为您也可以导出数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T20:22:53.903

我不认为将邮政编码转换为 ASCII 是一个好主意。原因很明显。如果你有一个像 1210121 这样的 ASCII 转换值（只是一个例子），问题是分开为 (12) (10) (121) 或 (12) (101) (21)。为了这样一点点收获，这似乎是很多工作。

虽然，你不能使用 SQL 吗？

```
 select * from ZIPTable where zipcode IN ('G4543','G3543') 
```

注意：您可以从子查询中获取邮政编码值。

# webgl - 在 Xfvb 中渲染 WebGL

> ID：10048736
> 
> 赞同：5
> 
> 时间：2012-04-06T20:12:26.390
> 
> 标签：webgl, xvfb

我想使用 Xvfb 无头测试 WebGL 代码。有人知道该怎么做吗？

我有 2 台机器 - 都运行 Ubuntu。一个带有 NVidia 卡，一个带有 ATI：

英伟达机器：

```
ipmi:~ $>xvfb-run glxinfo
name of display: :455
display: :455  screen: 0
direct rendering: No (If you want to find out why, try setting LIBGL_DEBUG=verbose)
server glx vendor string: SGI
server glx version string: 1.4
server glx extensions:
    GLX_ARB_multisample, GLX_EXT_visual_info, GLX_EXT_visual_rating, 
    GLX_EXT_import_context, GLX_EXT_texture_from_pixmap, GLX_OML_swap_method, 
    GLX_SGI_make_current_read, GLX_SGIS_multisample, GLX_SGIX_fbconfig, 
    GLX_SGIX_pbuffer, GLX_MESA_copy_sub_buffer, GLX_INTEL_swap_event
client glx vendor string: NVIDIA Corporation
client glx version string: 1.4
...

ipmi:~ $>xvfb-run glxgears
3725 frames in 5.0 seconds = 741.884 FPS
3840 frames in 5.0 seconds = 767.310 FPS
4080 frames in 5.0 seconds = 814.811 FPS
4120 frames in 5.0 seconds = 821.859 FPS 
```

ATI机器：

```
shaka:~ $>xvfb-run glxinfo
name of display: :99
display: :99  screen: 0
direct rendering: Yes
server glx vendor string: SGI
server glx version string: 1.4
server glx extensions:
    GLX_ARB_multisample, GLX_EXT_visual_info, GLX_EXT_visual_rating, 
    GLX_EXT_import_context, GLX_EXT_texture_from_pixmap, GLX_OML_swap_method, 
    GLX_SGI_make_current_read, GLX_SGIS_multisample, GLX_SGIX_fbconfig, 
    GLX_SGIX_pbuffer, GLX_MESA_copy_sub_buffer, GLX_INTEL_swap_event
client glx vendor string: Mesa Project and SGI
client glx version string: 1.4

shaka:~ $>xvfb-run glxgears
4326 frames in 5.0 seconds = 865.095 FPS
4343 frames in 5.0 seconds = 868.540 FPS 
```

即使 shaka 支持使用 Mesa 直接渲染，我也无法获得 WebGL 上下文。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T20:19:23.670

使用现代 X11，您最好忽略`Xvfb`并使用`dummy`显示驱动程序。[有关使用它的信息，请参阅http://www.x.org/wiki/XorgTesting](http://www.x.org/wiki/XorgTesting)上的“附加说明” （您可能会`xorg.conf`在必要的`Device`部分中指定一个自定义）。 [http://www.karlrunge.com/x11vnc/Xdummy](http://www.karlrunge.com/x11vnc/Xdummy)是另一种使用虚拟驱动程序的方法。

# php - 为什么我在这个数组中得到 NULL 值？

> ID：10048739
> 
> 赞同：1
> 
> 时间：2012-04-06T20:13:02.460
> 
> 标签：php, jquery, arrays

我在页面上有选择列表，并且正在遍历所有选择列表。值是“默认”、“Excused Absent”和“Excused Late”。默认基本上是“选择...”。我不想将它传递给服务器或对其进行任何处理，因为它毫无意义。

这是我的 jQuery：

```
 attendSelect.each(function(k, v)
    {
        attendance = $(this).val();

        if(attendance != "default")
        {   
            console.log(attendance == "default");
            students[k] = 
            {
                lesson : $(this).attr('id'),
                student_id : $(this).attr('name'),
                attendance  : attendance
            };
        }    
    }); 
```

这是有效的，因为每次我测试它时它都会打印错误的正确次数，在这种情况下为 3 次。但是，问题出在服务器端（我认为？）。当我打印变量时，我得到 NULL，NULL 表示在 jQuery 中找到默认值的次数。当然，我应该只得到一个没有 NULL 的大小为 3 的数组。

这是用 PHP 打印的：

```
$students = json_decode($_POST['students'], true);
var_dump($students);

array(12) {
  [0]=>
  NULL
  [1]=>
  NULL
  [2]=>
  NULL
  [3]=>
  array(3) {
    ["lesson"]=>
    string(9) "lesson[7]"
    ["student_id"]=>
    string(12) "student[241]"
    ["attendance"]=>
    string(14) "Excused Absent"
  }
  [4]=>
  array(3) {
    ["lesson"]=>
    string(9) "lesson[7]"
    ["student_id"]=>
    string(12) "student[270]"
    ["attendance"]=>
    string(12) "Excused Late"
  }
  [5]=>
  NULL
  [6]=>
  NULL
  [7]=>
  NULL
  [8]=>
  NULL
  [9]=>
  NULL
  [10]=>
  NULL
  [11]=>
  array(3) {
    ["lesson"]=>
    string(9) "lesson[9]"
    ["student_id"]=>
    string(12) "student[317]"
    ["attendance"]=>
    string(14) "Excused Absent"
  }
} 
```

这是我的 AJAX：

```
students = JSON.stringify(students)

    if(attendSelect.length)//protect against submitting on past lessons
    {
        $.post('',  { students : students, cid: cid }, function(response)
        {

            console.log(response);          
        });
    } 
```

我不明白为什么当它甚至没有在 jQuery 中输入 if 语句时我会得到 NULL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:26:05.483

您的问题在这里：

```
students[k] = 
```

相反，您应该使用`.push()`

```
students.push(
        {
            lesson : $(this).attr('id'),
            student_id : $(this).attr('name'),
            attendance  : attendance
        }); 
```

您的`k`值是`attendSelect`您正在处理的索引。当您创建学生数组时，您正在分配这些索引键，而不仅仅是创建一个新数组。Javascript 正在用 NULL 值“填充”缺失的索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:27:54.673

JSON 中的数组不能跳过索引。

`null`您可以使用[`array_filter`](http://php.net/array-filter)（不要将任何内容作为第二个参数传递）过滤掉这些值。

# caching - 停止浏览器对应该保持缓存的图像发出 HTTP 请求 - mod_expires

> ID：10048740
> 
> 赞同：49
> 
> 时间：2012-04-06T20:13:08.610
> 
> 标签：caching, browser, http-headers, mod-expires

在阅读了这里的许多文章和一些问题后，**我终于成功激活了 Apache `mod_expires`，告诉浏览器它必须缓存图像 1 年**。

```
<filesMatch "\.(ico|gif|jpg|png)$">
  ExpiresActive On
  ExpiresDefault "access plus 1 year"
  Header append Cache-Control "public"
</filesMatch> 
```

幸运的是，服务器响应似乎是正确的：

```
HTTP/1.1 200 OK 
Date: Fri, 06 Apr 2012 19:25:30 GMT 
Server: Apache 
Last-Modified: Tue, 26 Jul 2011 18:50:14 GMT 
Accept-Ranges: bytes 
Content-Length: 24884 
Cache-Control: max-age=31536000, public 
Expires: Sat, 06 Apr 2013 19:25:30 GMT
Connection: close
Content-Type: image/jpeg 
```

好吧，我认为这会阻止浏览器下载，甚至会在 1 年内向服务器查询图像。但这部分是正确的：因为如果您关闭并重新打开浏览器，浏览器将不再从服务器**下载图像，****但浏览器仍会向服务器查询每个图像的 HTTP 请求**。

**如何强制浏览器停止对每个图像发出 HTTP 请求？即使这些 HTTP 请求后面没有下载图像，它们仍然是向服务器发出的请求，**这会不必要地增加延迟并减慢页面呈现速度！

我已经告诉浏览器它必须将图像缓存 1 年！为什么浏览器仍然会向服务器查询每个图像（即使它没有下载图像）？！

* * *

查看 FireBug 中的网络图（菜单 FireBug > Net > Images）我可以看到不同的缓存行为（我显然从浏览器缓存完全为空开始，我使用“清除所有历史记录”强制在浏览器上删除缓存）：

*   **当页面第一次加载时，所有图像都被下载**（如果我通过单击浏览器的重新加载页面按钮强制重新加载页面，也会发生同样的事情）。*这是有道理的！*

*   **当我浏览网站并返回同一页面**时，根本没有下载图像，**浏览器甚至不会向服务器**查询任何图像。*这是有道理的，（我想在浏览器关闭时也看到这种行为）！*

*   **当我关闭浏览器并在同一页面上再次打开它时，愚蠢的浏览器无论如何都会对每个图像向服务器发出一次 HTTP 请求：它不会下载图像，但它仍然发出 HTTP 请求，就像浏览器查询关于图像的**服务器（服务器回复 200 OK）。*这是让我恼火的一个！*

如果您有兴趣，我还附上下面的图表：

![在此处输入图像描述](../Images/8cbd7a1f75f00d580dbfaeca1438c177.png)

![在此处输入图像描述](../Images/7a330077b48b4b54c6b51f31a333098b.png)

编辑：刚刚也使用 FireFox 11.0 进行了测试，以确保这不是我的 FireFox 3.6 太旧的问题。同样的事情发生！！！**我还测试了 Google 站点和 Stackoverflow 站点**，它们都发送了，`Cache-Control: max-age=...`但是**一旦浏览器关闭并在同一页面上再次打开，浏览器仍然会为每个图像向服务器发出 HTTP 请求**，服务器响应后浏览器不会下载图像（正如我上面解释的那样），但它仍然发出增加查看页面时间的该死请求。

EDIT2：并按照[此处](http://www.askapache.com/htaccess/apache-speed-last-modified.html)`Last-Modified`的建议删除标题，并不能解决问题，也没有任何区别。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-16T15:21:40.243

您看到的行为是预期的（有关更多详细信息，请参阅[RFC7234](https://www.rfc-editor.org/rfc/rfc7234)），指定的行为：

无论缓存状态如何，所有现代浏览器都会针对显示的每个页面元素向服务器发送 HTTP 请求。这是应 Web 服务（尤其是广告网络）的要求做出的设计决策，以确保 HTTP 服务器能够维护每个元素的每个显示的记录。

如果浏览器没有发出这些请求，服务器将永远不会被通知图像已显示给用户。对于广告网络来说，这将是灾难性的。早期，广告网络通过使用随机生成的名称（例如：'coke_ad_1_98719283719283.gif'）提供相同的广告图像来绕过这个问题。然而，对于 ISP 而言，这种做法导致数据传输量大幅增加，因为他们的每个用户都在重新下载这些相同的广告图像，绕过他们 ISP 运行的任何缓存/代理服务器。

所以达成了休战：浏览器总是会发送 HTTP 请求，即使是未过期的缓存元素。服务器将响应 HTTP 304 状态代码（“未修改”）。这允许服务器记录图像显示给客户端的事实。结果，广告网络*通常*停止使用随机图像名称来绕过网络缓存服务器。

这给了广告网络他们想要的东西——显示的每张图像的记录——它给了 ISP 他们想要的东西——可缓存的图像和静态内容。

这就是为什么您无法阻止浏览器发送对缓存页面元素的 HTTP 请求的原因。

但是，如果您查看与 html5 一起提供的其他可用客户端解决方案，则有一个范围可以防止资源加载

1.  [缓存清单](http://www.html5rocks.com/en/tutorials/appcache/beginner/)（尽管有问题）
2.  [IndexedDB](https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API)（不错的异步功能，允许 blob 存储）
3.  [本地存储](https://developer.mozilla.org/en/docs/Web/API/Window/localStorage)（非异步）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-05-16T14:52:43.237

您使用了错误的工具来分析请求。

我推荐真正有用的 Firefox 插件**Live HTTP 标头**，这样您就可以看到网络上真正发生的事情。

并且可以肯定的是，您可以 ssh/putty 您的服务器并执行类似的操作

```
tail -f /var/log/apache2/access.log 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-02-02T17:43:47.067

“重新加载”和“刷新”是有区别的。只是导航到带有后退和前进按钮的页面通常不会启动新的 HTTP 请求，但特别是按 F5 来“刷新”页面会导致浏览器再次检查其缓存。这取决于浏览器，但似乎是 FF 和 Chrome 的规范（即能够轻松查看其网络流量的浏览器。）按 F6，输入应聚焦 URL 地址栏，然后“转到”它，这应该重新加载页面，但不要仔细检查页面上的资产。

*更新*：澄清前后导航行为。它在浏览器中称为“Back Forward Cache”或**BFCache**。当您使用后退/前进按钮导航时，目的是向您显示与您在自己的时间轴中看到页面时完全相同的页面。使用 back 和 forward 时不会发出服务器请求，即使服务器缓存标头表明特定项目已过期。

如果您在开发人员网络面板中看到 (200 OK BFCache)，则服务器从未被击中 - 甚至询问 if-modified-since。

[http://www.softwareishard.com/blog/firebug/firebug-tip-what-the-heck-is-bfcache/](http://www.softwareishard.com/blog/firebug/firebug-tip-what-the-heck-is-bfcache/)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-04-12T15:32:19.470

如果我使用 F5 或 F5 + Ctrl 强制刷新，则会发送请求。但是，如果我关闭浏览器并再次输入 url，则不会发送任何请求。我测试是否发送请求的方法是在服务器上的开始请求上使用断点，即使没有发送请求，它仍然在 Firebug 中显示为已完成 7 毫秒的等待，因此请注意这一点。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-04-07T22:01:41.010

你在这里描述的并不反映我的经验。如果内容是使用 no-store 指令提供的，或者您进行了显式刷新，那么是的，我希望它返回到原始服务器，否则它应该在浏览器重新启动时被缓存（假设它被允许并且可以写入缓存文件）。

更详细地查看您的瀑布（这很棘手，因为它们有点小且模糊），浏览器似乎正在做它应该做的事情 - 它*有*图像条目 - 但这些只是*从本地缓存*加载而不是从源服务器 - 检查响应中的“日期”标头（为什么您认为它需要毫秒而不是秒？）。这就是为什么它们的颜色不同。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-02-04T00:16:06.437

在自己花费大量时间寻找合理的答案之后，我发现下面的链接最有用，它确实回答了这里提出的问题。

[https://webmasters.stackexchange.com/questions/25342/headers-to-prevent-304-if-modified-since-head-requests](https://webmasters.stackexchange.com/questions/25342/headers-to-prevent-304-if-modified-since-head-requests)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-18T16:15:54.257

您在 Chrome 中看到的不是实际 HTTP 请求的记录，而是资产请求的记录。Chrome 这样做是为了向您显示页面实际上正在请求资产。但是，此视图实际上并不能真正指示请求是否正在发出。如果资产被缓存，Chrome 将永远不会真正创建底层 HTTP 请求。

您还可以通过将鼠标悬停在时间线中的紫色段上来确认这一点。缓存资源将`(from cache)`在工具提示中有一个。

为了查看实际的 HTTP 请求，您需要查看较低的级别。在某些浏览器中，这可以通过插件（如 Live HTTP Headers）来完成。

但实际上，要验证请求实际上并未发出，您需要检查服务器日志或使用调试代理，如 Charles 或 Fiddler。这将在 HTTP 级别上起作用，以确保请求实际上没有发生。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-01T05:05:01.930

如果这是生死攸关的问题（如果您想以这种方式优化页面加载，或者无论如何都想尽可能减少服务器上的负载），那么有一种解决方法。

首次请求图像后，使用 HTML5**本地存储缓存图像。**

*   **[+]**您可以阻止浏览器发送 HTTP 请求，无论用户如何努力（F5、ctrl+F5、简单地重新访问页面等），99% 的 HTTP 请求都会返回 304（未修改）

*   **[-]**您必须为此付出一些额外的努力来支持 javascript。

*   **[-]**图像存储在 base64 中（我们不能存储二进制数据），这就是为什么它们每次都在客户端被解码。这*通常*很快而且没什么大不了的，但它仍然是客户端的一些额外 cpu 使用量，应该牢记在心。

*   **[-]**本地存储是有限的。您可以针对每个域使用约 5mb 的数据（注意：base64 将图像的原始大小增加了约 30%）。

*   **[?]***大多数*浏览器都支持。[http://caniuse.com/#search=localstorage](http://caniuse.com/#search=localstorage)

[例子](https://www.ibm.com/developerworks/community/blogs/bobleah/entry/html5_code_example_store_images_using_localstorage57?lang=en)

[测试](https://www.ibm.com/developerworks/mydeveloperworks/blogs/bobleah/resource/hero-graphic.html?lang=en)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-02-22T17:13:10.757

**缓存验证和 304 响应**

在多种情况下 Internet Explorer 需要检查缓存条目是否有效：

*   缓存的条目没有过期日期，并且是在浏览器会话中首次访问内容

*   缓存的条目有一个过期日期，但它已经过期

*   用户已通过单击刷新按钮或按 F5 请求页面更新

如果缓存条目有最后修改日期，IE 在 GET 请求消息的 If-Modified-Since 标头中发送它：

```
GET /images/logo.gif HTTP/1.1
Accept: */*
Referer: http://www.google.com/
Accept-Encoding: gzip, deflate
If-Modified-Since: Thu, 23 Sep 2004 17:42:04 GMT
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;)
Host: www.google.com 
```

服务器检查 If-Modified-Since 标头并做出相应响应。如果内容自指定的日期/时间以来没有更改，它会回复状态代码 304 和仅包含标题的响应消息：

```
HTTP/1.1 304 Not Modified
Content-Type: text/html
Server: GWS/2.1
Content-Length: 0
Date: Thu, 04 Oct 2004 12:00:00 GMT 
```

响应可以快速下载，因为它不包含任何内容，并导致 IE 从缓存中读取所需的数据。实际上，它就像重定向到本地浏览器缓存。

如果请求的对象自 If-Modified-Since 标头中的日期/时间以来实际上已更改，则服务器以状态代码 200 响应并提供资源的修改版本。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-11-12T23:28:52.333

[这个问题](https://webmasters.stackexchange.com/questions/25342/headers-to-prevent-304-if-modified-since-head-requests)在网站管理员堆栈交换网站上有更好的答案。

更多信息，也引用在上面的链接中，在[httpwatch](http://www.httpwatch.com/httpgallery/caching/#showExample5)

根据这篇文章：

在多种情况下 Internet Explorer 需要检查缓存条目是否有效：

*   缓存的条目没有过期日期，并且是在浏览器会话中首次访问内容
*   缓存的条目有一个过期日期，但它已经过期
*   用户已通过单击刷新按钮或按 F5 请求页面更新

    在此处输入代码

# java - 如何解码以 Base64 编码的 png 图像并在 ImageView 上查看它？

> ID：10048747
> 
> 赞同：5
> 
> 时间：2012-04-06T20:14:04.673
> 
> 标签：java, android, image, png, bytearray

我的 android 设备向服务器请求 png 图像。服务器将图像编码为 Base64 并将其发送到我的设备。之后，我将 Base64 字符串解码为字节数组，并使用 BitmapFactory.decodeByteArray() 制作它的位图图像。当我将图像添加到 ImageView 中时，我看不到图像。

**请参阅下面的代码：**

```
JSONObject params = resultObject.getJSONObject("params");
byte[] decodedImageInBytes = Base64.decode(params.getString("image_one"), Base64.DEFAULT);

Bitmap myImage = BitmapFactory.decodeByteArray(decodedImageInBytes, 0, decodedImageInBytes.length);
ImageView imageViewOne = (ImageView) findViewById(R.id.imageViewOne);
imageViewOne.setImageBitmap(myImage); 
```

***编辑：***

看来我的代码没问题，我的服务器有一些问题。谢谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:30:40.653

我已经为你解码了你的字符串。它不是位图数据。

```
Unknown error type: [2] include(/home/hospitalit/domains/hospitalitymanager.nl/public_html/demo/application//controllers/global/statistic_images/reservation_guest_rank) [<a href='function.include'>function.include</a>]: failed to open stream: No such file or directory<br />
on line 45 in file /home/hospitalit/domains/hospitalitymanager.nl/public_html/demo/application/controllers/api/statistics/index.phpUnknown error type: [2] include() [<a href='function.include'>function.include</a>]: Failed opening '/home/hospitalit/domains/hospitalitymanager.nl/public_html/demo/application//controllers/global/statistic_images/reservation_guest_rank' for inclusion (include_path='.:/usr/local/lib/php')<br />
on line 45 in file /home/hospitalit/domains/hospitalitymanager.nl/public_html/demo/application/controllers/api/statistics/index.php 
```

# asp.net - Ajax.BeginForm 使用 ASP.NET MVC 3 - 什么都没有发生

> ID：10048748
> 
> 赞同：1
> 
> 时间：2012-04-06T20:14:09.620
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, jquery

我需要做的就是创建一个简单的搜索页面，在部分视图中显示结果。我有一个搜索文本框和一个搜索提交按钮。我遵循了我在网上找到的一个教程，该教程似乎非常容易实现，但我在这里遗漏了一些东西。当我单击搜索按钮时，没有任何反应。任何关于我做错或遗漏的想法将不胜感激。

我在主布局页面中包含以下脚本文件

```
 @Script("jquery-1.5.1.min.js")
    @Script("modernizr-1.7.min.js")
    @Script("jquery-ui.min.js")
    @Script("jquery.unobtrusive-ajax.js")
    @Script("jquery.validate.min.js")
    @Script("jquery.validate.unobtrusive.min.js")

    @helper Script(string scriptName)
    {
        <script src="@Url.Content("~/Scripts/" + scriptName)" type="text/javascript">    </script>
    } 
```

主搜索视图称为 AdminMenu。这列在我的项目中名为 Admin 的区域下。

![在此处输入图像描述](../Images/0b8b110314a21da3dafe0373838a1c3e.png)

我的主视图中的以下代码

```
 @using (Ajax.BeginForm("AdminSearch", "AdminMenu", new {area = "Admin"}, new AjaxOptions { HttpMethod = "GET", InsertionMode = InsertionMode.Replace, UpdateTargetId = "searchResults"}))
{
    <input type="text" name="q" />
    <input type="submit" value="Search"/>
}

<div id="searchResults">

</div> 
```

我的部分视图中的代码 _adminSearch

```
<div id="searchResults">
    <div class="entitybox">
        @{
            var grid = new WebGrid(
                Model,
                defaultSort: "Name", canPage: false
                );
        }

        @grid.GetHtml(
            tableStyle: "_tableGrid",
            columns: grid.Columns
                (
                    grid.Column("Name", "Name", item => @Html.ActionLink((string)item.Name, "SelectRecord", new { controller = "Menu", agencyKey = item.Id, name = item.Name }))
                )
           )

    </div>
</div> 
```

控制器代码

```
public class AdminMenuController : Controller
    {

        public ActionResult AdminMenu()
        {
            return View();
        }

        public PartialViewResult AdminSearch(string q)
        {

            Records results = AgencyBusiness.GetAdminSearch(q);
            return PartialView("_adminSearch", results);

        }

    } 
```

单击搜索按钮时，没有任何反应。如果您在控制器类中的 AdminSearch 方法上设置断点，它将永远不会被命中。

在此先感谢您的时间。

![在此处输入图像描述](../Images/7e748b40608b030087c2974cd4511e28.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T20:15:01.283

I solved this issue. Odd thing. I used a shared view to show the current user at the top of the view using the following line.

```
@RenderPage("~/Views/Shared/_LoginBar.cshtml") 
```

The main problem was that @Ajax.BeginForm function did not output any form tags to the browser. By using the following line instead, the form tags appeared in the HTML source and the ajax function worked.

```
@Html.Partial("~/Views/Shared/_LoginBar.cshtml") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:27:06.423

使用 Ajax.BeginForm 时需要包含 MicrosoftAjax.js 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T20:21:51.010

我认为问题在于您的主视图和部分视图中都有一个名为“searchResults”的 div。Ajax 可能会感到困惑。

# xslt - msxsl:node-set() 和 position() 没有一起工作

> ID：10048752
> 
> 赞同：0
> 
> 时间：2012-04-06T20:14:23.103
> 
> 标签：xslt

我有一个包含预处理集 (DoesNotContainChildElement) 的 xsl:variable。我认为 msxsl:node-set() 正在添加一个根元素，因此位置始终为 1。但我需要前 15 个元素。

```
<xsl:variable name="Summary">
<xsl:for-each select="msxsl:node-set($DoesNotContainChildElement)">
  <xsl:if test="position() &lt; 16">
    <xsl:copy-of select="."></xsl:copy-of>
  </xsl:if>
</xsl:for-each> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T10:24:30.500

不，该函数`msxsl:node-set`不添加任何根节点，只是使用 XSLT 1.0 的示例

```
<xsl:variable name="rtf1">
  <item>1</item>
  <item>2</item>
  <item>3</item>
</xsl:variable> 
```

创建[一个结果树片段](http://www.w3.org/TR/xslt#section-Result-Tree-Fragments)，并且“结果树片段被等同于仅包含一个根节点的节点集”。因此，在上面的示例中，我们有一个带有单个根节点的结果树片段，其中包含三个`item`子元素。

应用`msxsl:node-set(rtf1)`扩展函数然后给你一个而不是结果树片段，现在节点集包含一个带有三个子元素`node-set`的根节点。`item`因此，如果您想访问`item`您需要`msxsl:node-set($rtf1)/*`或更一般`msxsl:node-set($rtf1)/node()`地访问所有子节点的元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T07:37:43.470

只有一个变量 $DoesNotContainChildElement，因此 for-each 只会为 position() 产生值 1。
您可以通过运行以下命令来检查：

```
<xsl:for-each select="$x">
    <pos1><xsl:value-of select="position()"/></pos1>
</xsl:for-each>
<xsl:for-each select="$x/*">
    <pos2><xsl:value-of select="position()"/></pos2>
</xsl:for-each> 
```

其中 x 是一个（节点集类型）变量。
结果看起来像

```
<pos1>1</pos1>
<pos2>1</pos2>
<pos2>2</pos2>
<pos2>3</pos2>
<pos2>...</pos2> 
```

在上述第一个 for-each 的情况下，添加`<xsl:copy-of select="."/>`将导致整个变量内容的输出，而对于第二个 for-each，它将导致变量的每个子元素的输出一个接一个。
如果您希望仅输出选定的子元素，则可以使用第二种形式。当您首次应用节点集函数将 rtf 更改为节点集时也是如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-07T01:25:03.617

# javascript - 如何在 jqgrid 编辑表单中捕获 tinyMCE 中的 Ctrl+S 键

> ID：10048756
> 
> 赞同：1
> 
> 时间：2012-04-06T20:15:10.150
> 
> 标签：javascript, jqgrid, tinymce

Ctrl+S 和 Ctrl+Q 键包含在 jqgrid 编辑中，并使用 Oleg 很好的答案添加表单：

```
beforeShowForm: function ($form) {
  var gridIdEncoded = $.jgrid.jqID($form[0].id.substring(8));
  $("#editmod" + gridIdEncoded).bind('keydown.formEvent', function (e) {
    if (e.ctrlKey && e.which === 83) {
      $("#TblGrid_" + gridIdEncoded + "_2 #sData").trigger("click");
      return false;
      }
    if (e.ctrlKey && e.which === 81) {  // ctrl-q
                   $("#TblGrid_" + gridIdEncoded + "_2 #cData").trigger("click");
                   return false;
                   }
} 
```

TinyMCE html 编辑器使用 afterShowForm 事件附加到 jqgrid 表单中的 textarea 元素

```
 $('.htmleditor', formSelector).attr('cols', '50').attr('rows', '15').tinymce({
        theme: "advanced",
        language: "et",
        theme_advanced_buttons2: "",
        theme_advanced_buttons3: "",
        theme_advanced_buttons1: "bold,italic,underline,strikethrough,separator,justifyleft,justifycenter," +
"justifyright,justifyfull,|,bullist,numlist,|,outdent,indent,|,cut ,copy,paste,undo,redo" +
"link,unlink,image,cleanup,code,hr,|,removeformat,formatselect,|,fontselect,fontsizeselect," +
"sub,sup,|,forecolor,backcolor,forecolorpicker,backcolorpicker,charmap,visualaid," +
"anchor,blockquote"
    });
} 
```

之后在 textarea 中按 Ctrl+S 会出现 IE9 标准保存对话框。如何允许 Ctrl+S 在 tinyMCE 中保存 jqgrid 表单？

**更新**

我尝试使用下面的代码从答案中推荐。未捕获 Keydown 事件。

```
afterShowForm: function (formSelector) {
        $('.htmleditor', formSelector).attr('cols', '50').attr('rows', '15').tinymce({
            setup: function (ed) {
                ed.onKeyDown.add(function (ed, e) {
                    // this box happens: alert('setup binding');
                    var gridIdEncoded = $.jgrid.jqID(formSelector[0].id.substring(8));
                    $("#editmod" + gridIdEncoded).bind('keydown.formEvent', function (e) {
                        alert('in keydown'); // this does not happen
                        if (e.ctrlKey && e.which === 83) {
                            $("#TblGrid_" + gridIdEncoded + "_2 #sData").trigger("click");
                            return false;
                        }
                        if (e.ctrlKey && e.which === 81) {  // ctrl-q
                            $("#TblGrid_" + gridIdEncoded + "_2 #cData").trigger("click");
                            return false;
                        }
                    });
                });
            },

            theme: "advanced",
            language: "et",
            theme_advanced_buttons2: "",
            theme_advanced_buttons3: "",
            theme_advanced_buttons1: "bold,italic,underline,strikethrough,separator,justifyleft,justifycenter," +
    "justifyright,justifyfull,|,bullist,numlist,|,outdent,indent,|,cut ,copy,paste,undo,redo" +
    "link,unlink,image,cleanup,code,hr,|,removeformat,formatselect,|,fontselect,fontsizeselect," +
    "sub,sup,|,forecolor,backcolor,forecolorpicker,backcolorpicker,charmap,visualaid," +
    "anchor,blockquote"
        });
    }; 
```

**更新2**

e.未定义。代码

```
$('.htmleditor', formSelector).attr('cols', '50').attr('rows', '15').tinymce({
    setup: function (ed) {
        ed.onKeyDown.add(function (ed, e) {
            var gridIdEncoded = $.jgrid.jqID(formSelector[0].id.substring(8));
            if (e.ctrlKey && e.keyCode === 83) {
                $("#TblGrid_" + gridIdEncoded + "_2 #sData").trigger("click");
                return false;
            }
            if (e.ctrlKey && e.keyCode === 81) {
                $("#TblGrid_" + gridIdEncoded + "_2 #cData").trigger("click");
                return false;
            }
        });
    }, 
```

捕获 ctrl+s 和 ctrl+q。使用下面的代码在 html keydown 事件中定义了许多全局快捷键。如果 tinymce 有焦点，这些将被忽略。如何使它们也起作用。如何在主窗口或其他想法中调用 html.keydown？

```
$(function () {
    $("html").keydown(function (evt) {
        var elem = evt.target || evt.srcElement;
        if (evt.ctrlKey) {
            switch (evt.keyCode) {
                case 68: openWindow('ToodeL'); return false;
                case 69: openWindow('DoklstlG'); return false;
... lot of openWindow calls 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:14:38.283

我自己不使用[tinyMCE ，但](http://www.tinymce.com/)[对演示](http://www.tinymce.com/tryit/full.php)的简短检查表明 tinyMCE 使用`<iframe>`. 如果你需要在`keydown`里面捕获事件，`<iframe>`你应该设置额外的`keydown`事件处理程序。对于演示有

```
<textarea name="content" style="width:100%"></textarea> 
```

`<iframe>`将使用的 id `content_ifr`。因此，您可以尝试查找`<iframe>`方式中构造的 by id，或者只是`iframe`尝试`<span>`在`<textarea>`. 然后你可以`.contentWindow.document`从`<iframe>`元素中获取并`keydown`在`.contentWindow.document`. 有关更多信息，请参阅[答案](https://stackoverflow.com/a/1199092/315935)和[这个](https://stackoverflow.com/a/4289040/315935)。可能像[这里](https://stackoverflow.com/a/2034173/315935)这样的其他更面向tinyMCE的解决方案会更好。因为我自己不使用tinyMCE（见我回答的第一句话），所以我不能推荐你一些具体的方法。

**更新**：在我看来，现在有更直接的方法可以提供 tinyMCE: [onKeyDown](http://www.tinymce.com/wiki.php/API3:event.tinymce.Editor.onKeyDown)。

# c# - Gstreamer：将带有两个接收器的 bin 链接到 playbin2

> ID：10048757
> 
> 赞同：1
> 
> 时间：2012-04-06T20:15:15.083
> 
> 标签：c#, .net, gstreamer

我想读入一个 SDP 文件并将视频流编码为 h.264，将音频流编码为 aac。然后我想将这些流多路复用到一个 avi 流中，然后再到一个文件中。我不提前知道 SDP 文件的内容，所以使用 playbin2 似乎最简单。

所以，我想我可以做这样的事情：

```
 RawToAviMux Bin
                       ______________________________________
                ----- |ghostpad----x264enc
              /       |                   \
playbin2------        |                    avimux--filesink
              \       |                    /
               -------| ghostpad----ffenc_aac
                      |_______________________________________

 setting playbin2's videosink to an instance of RawToAviMux
      and playbin2's audiosink to the same instance of RawToAviMux 
```

但是，我无法让管道进入播放状态。

这是代码：

```
 recorder = new Gst.BasePlugins.PlayBin2();
            recorder.PlayFlags &= ~((Gst.BasePlugins.PlayBin2.PlayFlagsType)(1 << 2));
            recorder.Bus.AddSignalWatch();
            recorder.Bus.EnableSyncMessageEmission();

            RawToAviMuxer aviMuxer = new RawToAviMuxer(fileName);               

            recorder.VideoSink = aviMuxer;
            recorder.AudioSink = aviMuxer;

            recorder.SetState(Gst.State.Ready);
            recorder.Uri = @"file:///" + filePath.Replace('\\', '/');
            recorder.SetState(Gst.State.Paused);
            recorder.SetState(Gst.State.Playing);

            Gst.State currentState;
            Gst.State playingState = Gst.State.Playing;
            Gst.StateChangeReturn stateReturn = recorder.GetState(out currentState, out playingState, Gst.Clock.Second);

            if (stateReturn != Gst.StateChangeReturn.Failure)
                return true;

            return false; 
```

使用 RawToAviMuxer 作为

```
public class RawToAviMuxer : Gst.Bin
{
    bool test = false;

    public RawToAviMuxer(string outputFileName)
        : base("rawToAviMux")
    {
        Gst.Element x264Enc = Gst.ElementFactory.Make("x264enc");
        Gst.Element ffenc_aac = Gst.ElementFactory.Make("ffenc_aac");

        x264Enc["bframes"] = (uint)0;
        x264Enc["b-adapt"] = false;
        x264Enc["bitrate"] = (uint)1024;
        x264Enc["tune"] = 0x4;
        x264Enc["speed-preset"] = 3;
        x264Enc["sliced-threads"] = false;
        x264Enc["profile"] = 0;
        x264Enc["key-int-max"] = (uint)30;

        Gst.GhostPad videoToX264Pad = new Gst.GhostPad("video_sink", x264Enc.GetStaticPad("sink"));
        Gst.GhostPad audioToAACPad = new Gst.GhostPad("audio_sink", ffenc_aac.GetStaticPad("sink"));

        test = this.AddPad(videoToX264Pad);
        test = this.AddPad(audioToAACPad);

        Gst.Element aviMux = Gst.ElementFactory.Make("avimux");
        Gst.Element fileSink = Gst.ElementFactory.Make("filesink");

        test = this.Add(new Gst.Element[]{x264Enc, ffenc_aac, aviMux, fileSink});
        test = x264Enc.Link(aviMux);
        test = ffenc_aac.Link(aviMux);
        test = aviMux.Link(fileSink);

        fileSink["location"] = outputFileName;
    }
} 
```

我已经进入调试器，所有链接都成功了。

**更新**

好的，所以我用 Gst.Parse.Launch 尝试了以下管道：

```
uridecodebin uri=file:///C:/Users/Jonathan/AppData/Local/Temp/192.168.0.215_5000.sdp !
x264enc byte-stream=true bframes=0 b-adapt=0 tune=0x4 speed-preset=3 sliced-threads=false 
profile=0 ! mux. ffenc_aac ! mux. avimux name=mux ! filesink location=C:\Users\Jonathan\Desktop\test.avi 
```

我仍然无法摆脱它的暂停。

我正在使用windows构建，所以我担心这可能有问题吗？

我也无法将消息处理程序附加到总线上，这样我就可以弄清楚发生了什么，这真的开始变得烦人了。

**然而，我确实发现了这个，**

如果我直接通过 udpsrc 元素获取流，并提前知道格式是什么，那么它不适用于仅 rtph264depay 元素。管道中必须有一个 h264parse 元素。这可能是 uridecodebin 不适合我的原因？

**解决** 了我最终做了以下事情：

```
 if (!gst_is_init)
            {                
                Gst.Application.Init();
                gst_is_init = true;
            }

            if(recorder != null)
            {
                recorder.SetState(Gst.State.Null);
                recorder.Dispose();
            }

            string videoDepay, audioDepay, strExtension, strMuxer;

            GetGstElements(stream.VideoCaps, out videoDepay, out strMuxer, out strExtension);
            GetGstElements(stream.AudioCaps, out audioDepay, out strMuxer, out strExtension);

            fileName = Path.ChangeExtension(fileName, strExtension);

            //recorder = new Gst.Pipeline("recordingPipe");
            string pipeString = String.Format("udpsrc port={0} ! {1} {2} ! {3} ! queue ! mux. udpsrc port={4} ! {1} {5} ! {6} ! mux. {7} name=mux ! filesink location={8}",
                portToUse, "application/x-rtp,", stream.VideoCaps, videoDepay, (portToUse + 2), stream.AudioCaps, audioDepay, strMuxer, fileName.Replace("\\", "\\\\"));

            recorder = (Gst.Pipeline)Gst.Parse.Launch(pipeString);                

            recordingFileName = fileName;

                 recorder.SetState(Gst.State.Ready);                
            recorder.SetState(Gst.State.Paused);                
            recorder.SetState(Gst.State.Playing);

            Gst.State currentState;                

            Gst.StateChangeReturn stateReturn = recorder.GetState(out currentState, Gst.Clock.Second);            

            if (stateReturn != Gst.StateChangeReturn.Failure)
                return true;

            return false; 
```

你必须有一个所有流的解析器，管道才能播放。因此，对于传入的 h264 流，我需要使用 rtph264depay ！h264解析。此外，NALU 和字节流必须匹配才能使时序正确。

此外，为了使文件可用，您必须在处理管道之前向下游发送 EOS。

```
 recorder.SendEvent(Gst.Event.NewEos());
                System.Threading.Thread.Sleep(100);
                recorder.SetState(Gst.State.Paused);
                recorder.SetState(Gst.State.Ready);
                recorder.SetState(Gst.State.Null);
                recorder.Dispose(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T08:17:41.390

是的，这行不通。这是你如何做到的。Playbin2 是一个模块化组件，它由一个 uridecodebin 和一个 playinkbin 组成。您可以只使用和 uridecodebin，设置媒体文件 uri，为 pad-added 添加信号处理程序，并将新创建的 pad 连接到 rawtoavimux 组件的 sink-pad。

rawtoavimux 的一种替代方法是使用 encodebin。使用 uridecodebin ！如果一个或多个流的格式已经是正确的格式，encodebin 可以潜在地进行智能转码，这将避免解码和重新编码。

# ragel - 匹配文件的开头或换行符 (Ragel)

> ID：10048759
> 
> 赞同：2
> 
> 时间：2012-04-06T20:15:22.660
> 
> 标签：ragel

我使用 ragel 和 C 作为宿主语言。

我可以简单地用'\n'识别换行符，但我需要识别文件的开头作为替代。

在正则表达式的其他实现中，这可以由`\A`or给出`$`，但`$`保留用于其他目的，`'\A'`映射到其他东西（警报？）并`\A`给出解析器错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T14:33:43.770

我不认为有一个转义序列。但是，您可以通过检查 Ragel 的`ts`变量是否等于 0 来检测它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-10T19:50:54.950

以文本格式您有 3 种选择：

*   旧 mac 到 nr 9 `\n\r`（和 Commodore、Apple II、Microware OS-9）

*   Unices 和新的 Mac OS X `\n`（和 BeOS、AmigaOS、MorphOS、RISC OS、Multics）

*   Windows 使用`\r\n`（和 DOS、OS/2、Symbian、DEC RT-11）

在 Ragel 中定义行尾

```
endline = ( "\r" | "\n" )+ @{ increase_line_number; }; 
```

行的开始正在开始`(any - endline)`

# javascript - 如何在array2中找到不在array1中的元素？

> ID：10048766
> 
> 赞同：0
> 
> 时间：2012-04-06T20:16:28.507
> 
> 标签：javascript, arrays, diff

我有两个数组：

```
var a1 = [ { ID: 2, N:0 }, { ID: 1, N:0 } ];
var a2 = [ { ID: 1, N:0 }, { ID: 2, N:0 }, { ID: 3, N:0 } ]; 
```

我需要获取所有打开`a2`但不在`a1`. 这里的一个元素与另一个元素的区别仅在于属性`ID`，其他属性应该被忽略。而且我不能保证数组中元素的顺序。这意味着此示例的结果应为：

```
var result = [ { ID: 3, N:0 } ]; // result for the example above 
```

我怎样才能有效地做到这一点？（我将比较长度为 500 到 5,000 的数组）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:24:06.713

为了有效地做到这一点，您需要为 a1 中已经存在的项目建立一个索引，以便您可以循环遍历 a2 并将每个项目与索引进行比较，以查看它是否已经被看到。可以使用 javascript 对象作为索引。循环遍历 a1 并将其所有 ID 放入索引中。然后循环遍历 a2 并收集所有 ID 未出现在索引中的项目。

```
function findUniques(testItems, baseItems) {
    var index = {}, i;
    var result = [];

    // put baseItems id values into the index
    for (i = 0; i < baseItems.length; i++) {
        index[baseItems[i].ID] = true;
    }

    // now go through the testItems and collect the items in it 
    // that are not in the index
    for (i = 0; i < testItems.length; i++) {
        if (!(testItems[i].ID in index)) {
            result.push(testItems[i]);
        }
    }
    return(result);
}

var a1 = [ { ID: 2, N:0 }, { ID: 1, N:0 } ];
var a2 = [ { ID: 1, N:0 }, { ID: 2, N:0 }, { ID: 3, N:0 } ];

var result = findUniques(a2, a1);
// [{"ID":3,"N":0}] 
```

工作演示：http: [//jsfiddle.net/jfriend00/uDEtg/](http://jsfiddle.net/jfriend00/uDEtg/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:21:11.087

同样的问题已经发了好几次了，看看这里：

[JavaScript 数组的区别](https://stackoverflow.com/questions/1187518/javascript-array-difference)

然而，大多数解决方案都是通过“本机”javascript 给出的。我有时更喜欢使用 underscore.js，因为我使用backbone.js 构建了很多东西，而下划线是 Backbone 的依赖项。所以我可以使用它很棒的实用程序。您可以考虑将它们加载到：

[http://documentcloud.github.com/underscore/](http://documentcloud.github.com/underscore/)

```
var a1 = [ { ID: 2, N:0 }, { ID: 1, N:0 } ];
var a2 = [ { ID: 1, N:0 }, { ID: 2, N:0 }, { ID: 3, N:0 } ];

var from, to;
if(a1 > a2){
    from = a1
    to = a2
} else {
    from = a2
    to = a1
}

var a3 = _.filter(from, function(obj){
    var compare = _.find(to, function(obj2){ return obj.ID === obj2.ID });
    return compare === undefined
});
console.log(a3); 
```

我首先确定了最长的数组，我这样做是因为我想将尽可能多的对象与较短的列表进行比较。否则我们会“忘记”一些。

然后我只需在 underscore.js 库中使用 filter 和 find 来返回不在较短数组中但在较长数组中的对象。

如果两个数组的长度相等，那也很好，因为这样我们会将所有项目与所有其他项目进行比较。

# javascript - 如何在 jquery / javascript 中打开同一个类中的另一个下拉菜单时关闭下拉菜单？

> ID：10048770
> 
> 赞同：1
> 
> 时间：2012-04-06T20:16:43.577
> 
> 标签：javascript, jquery, jquery-selectors

我创建了一个下拉菜单，其中包含可单击的链接，使用户能够删除消息、阻止评论等帖子。

无论如何，这一切都按预期工作..但是有一些行为我想停止。如果用户单击箭头以显示下拉菜单，它会显示这很好，但是当用户滚动到另一条消息/帖子并再次单击箭头时，两个下拉菜单都保持打开状态。

1.  我希望在打开另一个菜单时关闭当前菜单。因此一次只能打开 1 个菜单。

2.  出于某种原因，当我在页面刷新后第一次单击箭头下拉菜单时，箭头悬停状态会在我滚动时闪烁一次。有没有办法阻止这一切？

这是我当前的代码：

查询：

```
$(".micropostOptions").click(function(e) {

    var $micropostOptions = $(this),
        $postMenu = $micropostOptions.children();

    e.stopPropagation();

        if ($postMenu.hasClass("postMenuActivate")) {
            $postMenu.hide().removeClass("postMenuActivate");
            $micropostOptions.removeClass("postMenuHoverState");
        } else {
            $postMenu.show(10).addClass("postMenuActivate");
            $micropostOptions.addClass('postMenuHoverState');
        };

}); 
```

sCSS：

```
.micropostOptions {
    position:absolute;
    height:17px;
    width:17px  ;
    top:5px;
    right:5px;
    background:white url("/assets/arrow_down_alt1.png") no-repeat;
    background-position:0px 0px;

        &:hover {
            background: url("/assets/arrow_down_alt1_hover.png") no-repeat; 
            background-position:0px 0px;
            cursor:pointer !important;

        }

}

.postMenuActivate {
    display:block;
}

.postMenuHoverState {
    background: url("/assets/arrow_down_alt1_hover.png") no-repeat; 
    background-position:0px 0px;
    cursor:pointer !important;
}

.postMenu {
    position:absolute;
    display:none;
    padding-bottom:20px;
    background-color:white !important;
    border:1px solid $main-background-color;
    height:163px;
    width:170px;
    top:18px;
    right:2px;
    -webkit-box-shadow: 0 10px 6px -6px #777;
    -moz-box-shadow: 0 10px 6px -6px #777;
    box-shadow: 0 10px 6px -6px #777;
    color:gray;
    z-index:3000;

        li {

        font-size:12px;
        height:33px;
        background-color:white !important;

            a span {
                float:left;
                width:160px;
                height:33px;
                line-height:33px;
                padding-left:10px;
                color:gray;

                  &:hover {
                    background-color:#4D90FE !important;
                    color:white;
                    //  #DD4B39,#D14836
                    }
            }

            &:hover {
            background-color:#4D90FE;
            color:white;

            }
        }

        .deletePost {
            //position:relative;
            padding-top:0px !important;
            padding-left:0px !important;
            height:39px;
            width:170px;
            text-align:center;
            padding-bottom:7px;
            border-bottom:1px solid #d9d9d9;

                a {

                    span {
                    float:left;
                    padding-left:0px !important;                            
                        height:46px !important;
                        width:170px !important;
                        line-height:46px;
                    }
                }

                a span:hover {
                    background-color:#DD4B39 !important;
                    color:white;
                //  #DD4B39,#D14836
                }
        }

        .reportAbuse {
            border-top:1px solid #d9d9d9;

                a span:hover {
                    background-color:gray !important;;
                }

        }

} 
```

HTML：

```
 <nav class="micropostOptions">
     <ul class="postMenu">
       <li class="deletePost"><%= link_to content_tag(:span, "Delete post"), m, :method => :delete, :confirm => "Are you sure?", :title => m.content, :class => "message_delete" %>
       </li>
       <li class="disableCommenting"><%= link_to content_tag(:span, "Pause commenting"), "2" %></li>
       <li class="blockCommenter"><%= link_to content_tag(:span, "Block commenter"), "3" %></li>
       <li class="openInNewWindow"><%= link_to content_tag(:span, "Open in new window"), "4" %></li>
       <li class="reportAbuse"><%= link_to content_tag(:span, "Report abuse"), "5" %></li>
     </ul>  
   </nav> 
```

亲切的问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:04:00.860

我无法在演示中复制您的代码，所以我更改了 CSS：

## *[jsFiddle 演示](http://jsfiddle.net/up5yq/)*

```
$('.micropostOptions').on('click',function(){
    var postMenu = $(this).find('.postMenu');

    if( postMenu.is(':hidden') ){
        $('.postMenu').slideUp();
        postMenu.slideDown();
    }else{
        postMenu.slideUp() ;
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:55:51.907

在这里拍摄有点盲目，因为我们只有一个菜单，但这能解决问题吗？

```
$(".micropostOptions").click(function(e) {

    var $micropostOptions = $(this),
        $postMenu = $micropostOptions.children();

    e.stopPropagation();

        if ($postMenu.hasClass("postMenuActivate")) {
            $postMenu.hide().removeClass("postMenuActivate");
            $micropostOptions.removeClass("postMenuHoverState");
        } else {
            $postMenu.show(10).addClass("postMenuActivate");
            $micropostOptions.addClass('postMenuHoverState');
            $(".micropostOptions.postMenuHoverState")  //selects all micropostOptions with the postMenuHoverState class
                .not($micropostOptions)  //removes the current micropostOptions from the selected set
                .removeClass('postMenuHoverState')  //removes the postMenuHoverState class from all micropostOptions (besides teh current one)
                .children()  //gets the child menus of the set
                    .removeClass('postMenuActivate');  //removes postMenuActivate class from children of the active (but not current) micropostOptions

        };

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T20:28:39.140

我认为，您应该查看 jQuery 的 blur() 事件处理程序，以便在元素失去焦点时触发事件：http: [//api.jquery.com/blur/](http://api.jquery.com/blur/)

# nsstring - Cocos2D：在 CCCallFuncND 动作中使用 NSMutableString 时出现 EXC_BAD_ACCESS

> ID：10048775
> 
> 赞同：0
> 
> 时间：2012-04-06T20:17:17.450
> 
> 标签：nsstring, cocos2d-iphone, action, sequence, nsmutablestring

我有一个名为 message 的 NSMutableArray，我在 init 中分配并在 dealloc 中释放。我通常可以毫无问题地在 CCCallFuncND 操作中使用字符串，即使它是数组的索引，例如：

`displayMessagePiece = [CCCallFuncND actionWithTarget:self selector:@selector(displayMessageBoxString : data:) data:[[NSString stringWithFormat:[labelPieces objectAtIndex:i]] retain]];`

但是，如果我使用我的可变字符串，我会遇到一个绿色箭头指向我拥有它的代码行的崩溃，并且它会显示带有一些十六进制的“EXC_BAD_ACCESS”。

这是我尝试使用 NSMutableString 的操作和顺序：

```
id displayMessage = [CCCallFuncND actionWithTarget:self selector:@selector(displayMessageBoxString : data:) data:[[NSString stringWithFormat:[message copy]] retain]];

[self runAction:[CCSequence actions:displayMessage,nil]]; 
```

请注意，我使用 [message copy]，尽管我也尝试过仅使用消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:40:25.737

我闻到不好的做法：

```
NSString* s = [[NSString stringWithFormat:[labelPieces objectAtIndex:i]] retain];
[CCCallFuncND actionWithTarget:self 
                      selector:@selector(displayMessageBoxString:data:)
                          data:s]; 
```

首先，您保留了一个可能会或可能不会释放的字符串。不能保证 displayMessageBoxString 选择器会被调用。例如，运行 call func 操作的节点可能会在调用选择器之前从场景中移除，或者您可能会在调用选择器之前更改整个场景。在这两种情况下，您都会泄漏字符串。

当有 CCCallFuncO 时，也没有理由使用 CCCallFuncND。当您的项目使用 ARC 时，CCCallFuncND 尤其有害。在这种情况下，您必须将对象桥接到 void*，此时 ARC 可能会简单地释放内存，正确地假设非 ARC 代码现在管理对象的内存。自动释放实际上可能也是如此，但我对此不是 100% 确定的。

因此，首要任务是使用 CCCallFuncO 并重新测试您的问题是否消失。还要依赖自动释放，不要保留字符串，因为您无法在所有情况下释放它。

```
NSString* s = [NSString stringWithFormat:[labelPieces objectAtIndex:i]];
[CCCallFuncO actionWithTarget:self 
                     selector:@selector(displayMessageBoxString:)
                       object:s]; 
```

现在，如果您的最低目标是 iOS 4.0，那么您应该真正使用块。如果您同时需要发送者和对象，则尤其如此。该块可以访问本地范围，因此您可以在这种情况下使用最简单的 CCCallBlock 操作：

```
NSString* s = [NSString stringWithFormat:[labelPieces objectAtIndex:i]];
[CCCallBlock actionWithBlock:^void(){
    CCLOG(@"sender is: %@, string is: %@", self, s);
}]; 
```

瞧，所有问题都解决了，并保证不会导致任何内存泄漏。

请注意，您也可以像这样编写没有 void() 的块：

```
[CCCallBlock actionWithBlock:^{
    CCLOG(@"sender is: %@, string is: %@", self, s);
}]; 
```

我个人觉得提醒自己和其他人有关返回类型和参数是很有帮助的，即使没有。

# git - 将功能分支推送到 Origin 是好的做法吗？

> ID：10048776
> 
> 赞同：9
> 
> 时间：2012-04-06T20:17:19.620
> 
> 标签：git, design-patterns

我们最近从 SVN 切换到了 Git，当涉及到最佳实践等方面，我们仍然处于学习过程中。我正在遵循[本指南](http://nvie.com/posts/a-successful-git-branching-model/)作为管理我们的分支和版本的启动板。

该文档表明，功能分支通常是开发人员本地的，这与我在其他地方读到的几乎相同。但是，一些工程师正在研究下一个版本中不会出现的功能。这些功能比我们的发布周期提前了 2 到 3 次迭代。

我从我的工程师那里听到的担忧是，他们担心将这么多代码保留在本地。即使他们的备份流程到位，这仍然是一个问题。我倾向于同意他们的担忧。

所以我的问题是，将没有计划立即发布的分支推送到原点是否是标准的？在某些时候，这些分支被合并到开发分支中，然后从原点中删除。

例如，一位工程师正在处理一个相当大的履行件。我们不希望他的代码被推送到开发分支（总是我们的下一个候选版本）。所以我们为他创建了一个 fulfillment 分支并将其推送到 origin。我链接到的文件和我读过的其他文件都没有明确说明这是好的做法还是坏的做法。

如果这里有更好的做法，请告诉我或确认我的猜测。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-06T20:24:27.927

这取决于。

如果有人正在开发一项功能并希望与其他开发人员共享它，那是完全有意义的。但是，如果这是您独自开发的功能，如果您不需要共享它，为什么还要将其推送到服务器上呢？当功能完成时，它最终会被合并到其他一些分支，比如 master 或 development。

共享需要共享的分支，将其他分支保留在本地。如果不需要，不要弄乱主仓库。此外，当从主存储库中删除分支时，其他开发人员将不得不通过 git remote prune origin 手动清理他们的引用存储库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-05-26T15:33:14.483

对于小型功能，它是可选的。我建议每天推送中大型功能以进行备份。您的公司会不愿意听到您的开发人员在他的 PC 死机时浪费了 2 周的工作。

# git - git submodule add fatal：不是 Git 存储库

> ID：10048783
> 
> 赞同：10
> 
> 时间：2012-04-06T20:18:23.227
> 
> 标签：git, git-submodules

我对 Git 还很陌生，尽我所能找到一些关于这个问题的文档，但无济于事。

这是我的命令：

```
$ git submodule add https://github.com/joliver/EventStore.git externalsource/JOliverEventStore/ 
```

> 致命：不是 git 存储库：../.git/modules/externalsource/JOliverEventStore 无法签出子模块“externalsource/JOliverEventStore”

我在我的 repo 的根目录中，目前没有`/externalsource/JO liverEventStore/`. 错误是在谈论我不知道的目录。

如果我像这样将子模块添加到根目录：

```
$ git submodule add https://github.com/joliver/EventStore.git JOliverEventStore 
```

我没有问题，它会在根目录中创建文件夹。

任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-07T09:36:42.247

它可能取决于您使用的 Git 版本：这个[最近的线程（2012 年 2 月）](http://git.661346.n2.nabble.com/BUG-Fail-to-add-a-module-in-a-subdirectory-if-module-is-already-cloned-td7221426.html)提到了一个错误：

> 从最近开始，一个名为的子模块`<name>`的 git 目录位于超级项目的`.git/modules/<name>`目录中，而工作树包含一个`gitfile`指向那里。
> 
> 当相同的子模块被添加到到目前为止它不存在的分支上时（在 .gitmodules 文件中找不到它），名称不会从路径中初始化，因为它应该。
> 这会导致在找到目录`gitfile`时输入错误的路径`.git/modules/<name>`，因为这很高兴使用 - 现在为空 - 名称。
> 然后它总是只指向一个目录，即使我们在目录层次结构中有更深的路径。

但更一般地说，使用 的`<path>`论点[`git submodule`](http://linux.die.net/man/1/git-submodule)：

> `<path>`是克隆子模块存在于超级项目中的相对位置。
> 
> *   如果`<path>`不存在，则通过从命名 URL 克隆来创建子模块。
> *   如果`<path>`确实存在并且已经是有效的 git 存储库，则将其添加到变更集中而不进行克隆。
>     提供第二种形式是为了便于从头开始创建新的子模块，并假定用户稍后会将子模块推送到给定的 URL。

* * *

[eoinoc](https://stackoverflow.com/users/248220/eoinoc)[在评论](https://stackoverflow.com/questions/10048783/git-submodule-add-fatal-not-a-git-repository/10053363?noredirect=1#comment23748683_10053363)中提到了另一个原因，在问题“ [`git status`returns`fatal: Not a git repository but .git exists and HEAD has proper permissions`](https://stackoverflow.com/q/10144149/6309) ”中有详细说明。

> 我的 repo 的位置已经改变，我需要更新 git 的配置文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-07-23T14:57:43.343

这看起来很愚蠢，但因为我刚刚在那个愚蠢的错误上浪费了 30 分钟......

您的父存储库必须已经创建为 git 存储库。我刚刚创建了父模块，然后我创建了子模块并尝试`git submodule add`进入父模块。但是，父级尚未初始化为 git 存储库。

这导致了与您提到的错误相同的错误（“不是 git 存储库”）。然而，它是不是 git 存储库的父级......愚蠢。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-06-25T16:10:42.473

我浪费了几分钟只是为了一个简单的问题

第一的`git init`

然后安装主题`git submodule add https://github.com/joliver/EventStore.git JOliverEventStore`

# asp.net - IIS 7 欢迎页面未显示

> ID：10048785
> 
> 赞同：2
> 
> 时间：2012-04-06T20:18:36.327
> 
> 标签：asp.net, windows-7, iis-7, webserver

**操作系统：** Windows 7，家庭高级版
我刚刚从 Web 平台安装程序安装了 IIS manager Express，并从控制面板的程序功能中打开了 IIS7 功能。

**Q)**我在玩 IIS 管理器 (inetmgr) 我可以在打字时查看欢迎页面，`localhost`但是在添加一些站点并删除它们之后，我无法看到 IIS 上托管的任何站点，甚至看不到 IIS 的欢迎页面

**注意：**我假设 IIS 已关闭，但它正在运行
***Services.msc 从开始菜单 > 运行*** ![在此处输入图像描述](../Images/3ac391c54301407bc9a5de2a0b06db9e.png)

**进展：**
从“Andrei Drynov”尝试 Update2 后，这里是 sanpshot ![在此处输入图像描述](../Images/238965b6bf15789e2f7cb09ab30d4b1e.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T21:20:32.100

C:\inetpub\wwwroot 中是否有页面 iistart.html？

![在此处输入图像描述](../Images/4ddcfc8719a937bb5d8a6bdef068e716.png)

默认网站是否存在并正在运行？

![在此处输入图像描述](../Images/0483760b15290f32040d8b32f83d3a00.png)

更新：

如果你真的想要那个欢迎页面，你可以卸载然后重新安装 IIS 组件，如默认文档：

![在此处输入图像描述](../Images/2ec05bfee54ff7c6e7e5ef02070b0a02.png)

更新 2：

我能够通过在站点绑定中创建另一个以**site1.com**作为主机名的网站并删除默认网站来重现您的问题。删除那里的主机名，您将能够再次打开欢迎页面：

![在此处输入图像描述](../Images/c159d33619b45728d504500f10d47916.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T21:24:04.220

默认的 IIS 网站是否正在运行？这意味着在IIS可以打开，但网站仍然可以停止...尝试重新启动网站...然后尝试---右键单击网站>管理网站>浏览...

# mysql - 如何在 WAMPserver 上的 MySQL 中添加外键？

> ID：10048791
> 
> 赞同：4
> 
> 时间：2012-04-06T20:19:19.060
> 
> 标签：mysql, wamp, wampserver

我不知道如何指示一列是 WAMPserver 中的外键。我想我可以为此编写 MySQL 查询，但我认为还有一种方法可以使用用户界面（PHPMyAdmin）来做到这一点......？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-06T20:59:10.160

创建外键约束依赖于将存储引擎设置为可以支持它的东西（例如 InnoDB）。在 PHPMyAdmin 中，您可以在“操作”中使用“存储引擎”选项为表设置此项。一旦完成：

1.  确保您已为要为其分配外键的列分配索引。
2.  单击“结构”选项卡上表详细信息下的“关系视图”。
3.  分配您的外键约束并决定 DELETE 和 UPDATE 的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-02T05:45:35.240

您可以通过以下查询为现有表添加外键

```
ALTER TABLE sample.employee
  ADD FOREIGN KEY (dno) 
 REFERENCES sample.department(dnumber) 
```

这里是样本。employee 是您当前的表，示例 .department 是现有表，其值为您的外键 dno 是当前表外键，dnumber 是现有表主键。

# vim - vim autoindent 停止删除缩进

> ID：10048794
> 
> 赞同：0
> 
> 时间：2012-04-06T20:19:40.617
> 
> 标签：vim

我尝试使用具有自动缩进功能的 vim，该功能运行良好。但我觉得很烦人的是，在某些情况下它也会删除缩进，因为它会产生额外的工作。例如，当我有一个缩进的行时，我转到行尾并键入然后 vim 删除行的缩进。如何关闭现有缩进的删除？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T15:04:30.887

你试过：

```
:set noautoindent   
:set noai  #same as above 
```

或者尝试使用智能缩进

```
:set nosmartindent
:set nosi  #same 
```

# python - 使用 re.findall 读取整行

> ID：10048796
> 
> 赞同：0
> 
> 时间：2012-04-06T20:19:41.993
> 
> 标签：python, regex

我想读整行。

例子：

```
TempFile = open('file.tmp', 'r')
for line in TempFile:
    m = re.findall("(?:\d{1,3}\.){3}\d{1,3}", line)
    for x in m:
        print <The whole line, but how?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:22:43.420

整行仍然保存在`line`循环中的变量中，尽管我不确定为什么要为找到的正则表达式的每个匹配项打印整行。

```
TempFile = open('file.tmp', 'r')
for line in TempFile:
    m = re.findall(r"(?:\d{1,3}\.){3}\d{1,3}", line)
    for x in m:
        print line 
```

请注意，我还将您的正则表达式字符串更改为原始字符串文字，以确保反斜杠被正确转义，在这里不会有什么不同，但如果您尝试将单词边界与 匹配，它会有所不同`\b`，例如。

# netty - Netty ZlibEncoder 中的线程

> ID：10048798
> 
> 赞同：1
> 
> 时间：2012-04-06T20:19:46.370
> 
> 标签：netty

我正在为 Netty 创建一个 Snappy 编码器和解码器。我正在查看 ZlibEncoder 以了解它是如何实现的，但注意到 ChannelHandlerContext 是可变的，finished 是 AtomicBoolean，并且 z (ZStream) 有一个同步块。我的问题是为什么？既然为每个通道创建了一个新的 ZlibEncoder，为什么需要这些？

谢谢

戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T07:11:56.450

它是必需的，因为下游事件可以由任何线程触发（例如写入）。上游事件仅由一个线程执行，因此在那里不需要（解码器仅处理上游事件）

# html - CSS：仅在边距内的背景颜色

> ID：10048800
> 
> 赞同：53
> 
> 时间：2012-04-06T20:19:52.127
> 
> 标签：html, css, margin, background-color

我已经搜索了答案，但在任何地方都找不到。我的问题相当简单：我的身体有一个背景颜色，然后是一个很大的边距，现在我想要在边距**内**使用不同的背景颜色。

我如何用 CSS 做到这一点？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-04-06T20:24:22.163

如果您的边距设置在正文上，那么设置 html 标签的背景颜色应该为边距区域着色

```
html { background-color: black; }
body { margin:50px; background-color: white; } 
```

[http://jsfiddle.net/m3zzb/](http://jsfiddle.net/m3zzb/)

或者按照 dmackerman 的建议，将边距设置为 0，但设置您希望边距大小的边框并设置边框颜色

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-06T20:23:16.183

除了使用边距，您可以使用边框吗？无论如何，你应该这样做`<div>`。

像这样的东西？![在此处输入图像描述](../Images/197c6fd62fa58bae6f0fa6d6de16b903.png)

[http://jsfiddle.net/GBTHv/](http://jsfiddle.net/GBTHv/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-10-04T18:08:51.470

我需要类似的东西，并想出了使用：之前（或：之后）伪类：

```
#mydiv {
   background-color: #fbb;
   margin-top: 100px;
   position: relative;
}
#mydiv:before {
   content: "";
   background-color: #bfb;
   top: -100px;
   height: 100px;
   width: 100%;
   position: absolute;
} 
```

[JSFiddle](http://jsfiddle.net/m9kv02gu/1/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T20:21:40.043

这对于盒模型来说是不可能的。但是，您可以使用 css3 的边框图像或一般 css 中的边框颜色的解决方法。

但是我不确定您是否可能在重置时遇到问题。一些浏览器也会为 html 设置边距。有关更多信息，请参阅 Eric Meyers 重置 CSS！

```
html{margin:0;padding:0;} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-13T17:33:06.140

您是否可能希望更改边框外的边距颜色？也许[https://www.w3schools.com/css/css_outline.asp[outline][1]](https://www.w3schools.com/css/css_outline.asp%5Boutline%5D%5B1%5D)大纲会有所帮助？特别

```
outline-color: green; 
```

# c# - 类链接 wcf

> ID：10048801
> 
> 赞同：0
> 
> 时间：2012-04-06T20:19:59.543
> 
> 标签：c#, wcf

我正在尝试将标签添加到组中，因此当我想添加组时，我可以向其添加关联的标签。我试图做的是能够返回按标签过滤的组列表。

```
 List<Group> Groups = new List<Group>();
    List<Tag> tags = new List<Tag>();
    public void AddTagtoGroup(Group group, Tag tag)
    {
        group.GroupName(tag.Add);
        return Groups with tags or tags with groups 
    } 
```

这是组和标签的数据协定：

```
[DataContract(Name = "Group")]
public class Group
{

    public Group() // not sure if this has to have a datamember
    {
        Tags = new List<Tag>();
    }
    [DataMember(Name = "GroupName")]
    public string GroupName { get; set; }
    public List<Tag> Tags { get; set; } // datamember or not?

}
[DataContract(Name = "Tag")]
public class Tag
{
    [DataMember(Name = "TagName")]
    public string TagName { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:50:49.990

我只是对代码有点困惑：`group.GroupName(tag.Add)`. 您是否尝试重置您的群组的群组名称？tag.Add 方法的作用是什么？我原以为您可能希望在您的组中使用 Add 方法将标签添加到当前`List<Tag> Tags`列表中，如下所示：

```
group.Add(tag) 
```

反而。或者，如果您需要首先在`Groups`列表中找到正确的组，您可能更愿意传入 GroupName 并进行搜索，这样您将得到：

```
public void AddTagtoGroup(string groupName, Tag tag)
{
    Group group = FindGroupByName(groupName);
    if (group != null) {
        group.Add(tag);
    }
} 
```

在`FindGroupByName`你将浏览你的`Groups`列表并检查每个人的名字与提供的名字。或者您可以使用组的 HashSet 或字典来加速该部分。然后为你的`Groups`.

回复您的问题：

*   如果需要在客户端调用它，您只需将`Group()`构造函数标记为`DataMember`
*   是的，标签列表需要标记为`DataMember`，我认为，从您的代码中，客户端需要它

您可能需要更具体一点，这是将 a 添加`Tag`到`Group`客户端吗？为了使这一点更清楚，您将在适当`GroupProxy`的情况下使用`TagProxy`。在您的代码中使用它们，它们就是与 WCF 服务对话的那些。然后应该很明显他们需要调用哪些成员/方法并标记合同/服务中的每个成员/方法（您可能还需要考虑将您的合同分离到一个接口，然后将实际实现保留在一个类中（这将成为实现该接口的服务）。

# php - 向模型添加一行

> ID：10048805
> 
> 赞同：0
> 
> 时间：2012-04-06T20:20:38.980
> 
> 标签：php, model, yii

我想填充一个空模型并将模型保存在 blob 字段中以供以后使用。我的问题是我找不到如何向空模型添加另一行。

这有效：

```
$test = LineItem::model();
$test->item_id = '2'; 
```

这不起作用

```
$test->1->item_id = '3'; 
```

或者

```
$test->item_id[1] = '3'; 
```

我曾尝试查看 Yii 文档，但找不到答案。

谢谢

**澄清** 我试图使用真实表的模型创建一个假表。我正在开发一个发票系统，我不想在“关闭”之前将行项目或发票正文信息正确地发送到数据库。相反，我想填充相应的模型，然后将其序列化并存储在 BLOB 字段中。发票完成后，数据将写入表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T20:27:13.287

你应该使用

```
$test = new LineItem; 
```

代替

```
$test = LineItem::model(); 
```

用于 INSERT 查询。并在设置属性后

```
$test->save(); 
```

在每次迭代中也是如此。

# node.js - Nowjs 与 Socket.io

> ID：10048806
> 
> 赞同：7
> 
> 时间：2012-04-06T20:20:40.020
> 
> 标签：node.js, socket.io, nowjs-sockets

我一直在使用 socket.io 和 node.js 并遇到了[Nowjs](http://www.nowjs.com)，似乎这只是包装了 socket.io 并提供了一个更加用户友好的界面。

一旦我注意到 Socket.io 有时会出现连接延迟，特别是在 IE 和 Firefox 中，有时可能需要 2-4 秒才能建立“连接”。

有谁知道单独使用 Nowjs 与 Socket.io 是否有任何性能优势或其他优势？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-08T07:32:04.090

NowJS 支持 clientId 和 session，这将更容易支持多用户实时应用。我认为两者实际上是相同的，如果你对 socket.io 有一些延迟，我真的不认为它会随着 nowJs 消失。

我已经切换到 NowJS，因为它更容易构建你的应用程序（对我来说）。我也遇到了延迟，但我认为这是正常的，因为一切都是异步的，你可以在你的脚本中管理它。

编辑1：

我发现了延迟的原因。似乎当 NowJS 被初始化时，它会执行大量代码来评估您的“现在”构造函数，并将其与从服务器/客户端添加的方法同步。在 socket.io 中你没有这样的延迟，它更快

**更新 ：**

Nowjs 不再处于积极开发中（没有最近的更新，作者可能不会有）。您绝对应该寻找具有更大支持的东西。

[https://github.com/Flotype/now/issues/208](https://github.com/Flotype/now/issues/208)

# python - 如何分发将可执行文件添加到路径的 Python 包？

> ID：10048807
> 
> 赞同：3
> 
> 时间：2012-04-06T20:20:53.287
> 
> 标签：python, linux, egg

我有一堆命令要分发给我的同事。他们希望我将其打包并将其添加到他们的路径 ( `/usr/local/bin`)

我该怎么做？我们已经有一个 Python 存储库。这可能`egg`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T20:49:05.927

我不喜欢回答我自己的问题，但我已经开始研究这个：

[http://docs.python.org/distutils/setupscript.html#installing-additional-files](http://docs.python.org/distutils/setupscript.html#installing-additional-files)

似乎这可能是答案。我会在星期一尝试时更新这个答案。或者，如果有人以前使用过类似的东西，请回答自己！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:34:34.647

一种选择是[构建一个 RPM](https://www.google.com/search?q=build%20rpm)。这通常是将文件安装到预定义位置的一种非常方便的方法。

# ruby-on-rails - 向用户展示 CanCan 能力的要求

> ID：10048809
> 
> 赞同：1
> 
> 时间：2012-04-06T20:20:56.650
> 
> 标签：ruby-on-rails, authorization, cancan

在 Rap Genius 上，您需要一定数量的 Rap IQ 才能获得某些权限（在这方面就像 Stack Overflow）。我通过在我的以下添加这样的行来实现这一点`ability.rb`：

```
can :create, Annotation do |a|
  user.rap_iq >= 500
end 
```

但是，我需要能够将这一事实传达给用户。例如，在我的注释视图中，我可能有类似的东西：

```
<% unless can? :create, @annotation %>
  You need at least <%= CanCan::Ability.iq_required_to(:create, Annotation) %> Rap IQ to create annotations
<% end %> 
```

（显然API是由lol组成的）

我的问题是如何最好地做到这一点——我确信这个问题之前已经解决了（例如，在 Stack Overflow 的案例中！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T17:06:53.403

您可以以某种方式对该需求信息进行建模并将其显示给用户。

我不知道是否已经有办法用 cancan 做到这一点（我还没有在文档中看到它）但是你可以扩展`CanCan::Ability`类来响应`iq_required_to`，比如（它只是一个**概念证明**）：

```
REQUIREMENTS[:annotation][:create] = 500

def iq_required_to(action, subject)
  REQUIREMENTS[subject][action]
end 
```

然后你可以打电话`iq_required_to(:create, :annotation)`

当然，您应该更改您`initialize`的使用此信息：

```
can :create, Annotation do |a|
  user.rap_iq >= iq_required_to(:create, :annotation)
end 
```

# c# - 文件上传返回 null

> ID：10048812
> 
> 赞同：5
> 
> 时间：2012-04-06T20:21:19.723
> 
> 标签：c#, jquery, asp.net, asp.net-mvc, uploadify

我正在使用 Uploadify 在我的 ASP.NET MVC 应用程序中上传一个文件。

控制器：

```
public ActionResult Upload(HttpPostedFileBase file)
        {           
            List<string> validIDs, invalidIDs;
            if (file.ContentLength > 0)
            { //do something
            }
        } 
```

上传代码（在 .ascx 文件中）：

```
$(document).ready(function () {   
    $("#file_upload").uploadify({
        'uploader': '/Scripts/uploadify/uploadify.swf',
        'script': '/XYZ/Upload',
        'cancelImg': '/Scripts/uploadify/cancel.png',
        'fileExt': '*.jpg;*.gif;*.png;*.bmp;*.htm;*.html;*.zip',
        'fileDesc': '*.jpg;*.gif;*.png;*.bmp;*.htm;*.html;*.zip',
        'auto': true,
        'multi': false,
        'sizeLimit': 1048576,   //1 MB
        'buttonText': 'Upload Files'
}
    });
}); 
```

控制器操作中的“文件”始终返回 NULL。我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T20:24:21.657

代替：

```
public ActionResult Upload(HttpPostedFileBase file) 
```

和：

```
public ActionResult Upload(HttpPostedFileBase fileData) 
```

`Uploadify`默认使用`fileData`名称。如果您愿意，可以在设置中更改它：`fileDataName: 'file'`. 看看[下面的帖子](https://stackoverflow.com/a/8019743/29407)。

# android - Android onActivityResult 提前调用

> ID：10048813
> 
> 赞同：8
> 
> 时间：2012-04-06T20:21:25.670
> 
> 标签：android, android-intent, android-activity

我有 2 个活动，每个活动都在单独的应用程序中。Activity1 有一个用户可以单击的按钮，它在其`onClick()`方法中使用意图调用第二个活动：

```
Intent myIntent = getPackageManager().getLaunchIntentForPackage(com.myProject.Activity2);
startActivityForResult(myIntent, 600); 
```

这会正确地从 Activity1 启动 Activity2，但`onActivityResult`会在 Activity2 中`onCreate`调用之前在 Activity1 中调用，而不是在`onBackPressed()`我设置返回意图的位置。

这是`onCreate`Activity2的方法：

```
@Override
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
} 
```

这是`onBackPressed`Activity2 方法的当前版本：

```
@Override
public void onBackPressed() {
    Intent intent = new Intent();
    intent.putExtra("Stuff", someStuff);

    if(getParent()==null){
        setResult(Activity.RESULT_OK, intent);
    }else{
        getParent().setResult(Activity.RESULT_OK, intent);
    }
    finish();
    super.onBackPressed();
} 
```

我的 AndroidManifest.xml 具有以下 Activity2 意图过滤器：

```
<intent-filter>
    <action android:name="android.intent.action.MAIN"/>
    <category android:name="android.intent.category.LAUNCHER"/>
</intent-filter> 
```

我验证了我`launchMode`的是`standard`（而不是`singleTask`等），正如[这里](https://stackoverflow.com/questions/3354955/onactivityresult-called-prematurely)所建议的那样，并且我的请求代码并不像[这里](https://stackoverflow.com/questions/5289726/onactivityresult-not-being-called-when-listactivity-finishes)警告的那样为负。我也试过`android:launchMode="singleTop"`了，但这也是不行的。

我还尝试不调用[此处](https://stackoverflow.com/questions/6742438/onactivityresult-not-called-in-android)提到的 Activity2 `finish()`（也按照[此处](https://stackoverflow.com/questions/6322874/onactivityresult-has-intent-data-as-null-after-an-activity-has-finished)的建议），并再次按照[此处](http://groups.google.com/group/android-developers/browse_thread/thread/b3b2ad819ee40eff#)的建议调用它。`onBackPressed()``super.onBackPressed()`

此外，我尝试注释掉该行`intent.putExtra("Stuff", someStuff);`，因为它似乎给[这个人](https://stackoverflow.com/questions/5019711/android-onactivityresult-not-called-triggered)造成了麻烦。

关于我可能做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-09T15:44:17.620

所以这是解决它的最终解决方案：

我将 Activity1 的意图更改为以下内容：

```
Intent myIntent = new Intent();
myIntent.setClassName("com.myProject", "com.myProject.Activity2");
startActivityForResult(myIntent, 600); 
```

出于某种原因，除了第一个参数给出的包名称之外，Android 还需要第二个参数的完全限定名称。现在它起作用了！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-17T12:30:05.097

如果在启动活动时设置了“singleInstance”标志，就会发生这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T20:59:15.013

不确定你的问题是什么。您在 Activity1 中创建 Intent 的方式很奇怪；该方法不适用于创建在同一应用程序中启动另一个活动的意图。一些开发人员使用 Intent(Context, Class<>) 构造函数。我更喜欢将 Intent(String action) 与仅在我的应用程序中定义的自定义操作字符串一起使用（这更容易正确编码）。

此外，您为 Activity2 指定的意图过滤器通常用于直接从主屏幕启动的活动。

activity2 的 onCreate() 代码在哪里？onBackPressed() 的代码在哪里？你能向我证明 setResult() 是在 Activity2 中的其他代码之前调用的吗？您应该在调试中运行活动。确保 Activity2 正在接收您认为它应该接收的意图，然后逐步跟踪执行的语句，直到 setResult()。*不*应该做的事情是在您了解潜在问题之前在代码中抛出解决方案。

据我所知，Activity1 正在发送一个 Intent，然后调用 onActivityResult。到目前为止，没有任何其他证据可以证明。

# c++ - boost::ptr_map<> 和 _BLOCK_TYPE_IS_VALID(pHead->nBlockUse) 断言失败

> ID：10048816
> 
> 赞同：1
> 
> 时间：2012-04-06T20:21:39.967
> 
> 标签：c++, boost, c++11, direct3d, boost-ptr-container

关于stackoverflow的第一个问题，希望能在这个问题上得到一些帮助。如果您查看以下 EffectManager 类，当一个 effectmanager 实例被释放时，我会在 _BLOCK_TYPE_IS_VALID(pHead->nBlockUse) 上遇到断言失败。

它与尝试释放效果图的内存有关，如果我从不将效果插入到地图中，我不会遇到这个问题。

如果我使用基本 STL 地图，它也可以正常工作，即

```
typedef std::map<std::wstring, ID3DXEffect*> EffectsMap; 
```

* * *

```
class EffectManager
{
public:
    typedef boost::ptr_map<std::wstring, ID3DXEffect> EffectsMap;
    EffectManager();
    ~EffectManager();
    void init();
    ID3DXEffect *loadEffect(LPDIRECT3DDEVICE9 d3ddev, std::wstring effectfile);

private:
    std::shared_ptr<EffectsMap> effects_;
}; 
```

* * *

```
EffectManager::EffectManager() : effects_(NULL)
{
}

EffectManager::~EffectManager()
{
    for(auto it = effects_->begin(); it != effects_->end(); it++){
        it->second->Release();
    }
}

void EffectManager::init()
{
    effects_ = std::shared_ptr<EffectsMap>(new EffectsMap());
}

ID3DXEffect *EffectManager::loadEffect(LPDIRECT3DDEVICE9 d3ddev, std::wstring effectfile)
{
    if(!effects_)
        return NULL;

    ID3DXEffect *effect;
    if(effects_->count(effectfile)){
        effect = effects_->find(effectfile)->second;
    } else {
        D3DXCreateEffectFromFile(d3ddev, effectfile.c_str(), NULL, NULL, D3DXFX_NOT_CLONEABLE, NULL, &effect, NULL);
        effects_->insert(effectfile, effect);
    }

    return effect;
} 
```

# javascript - CSS“建议搜索框”不在位

> ID：10048818
> 
> 赞同：2
> 
> 时间：2012-04-06T20:21:40.073
> 
> 标签：javascript, html, css

我已经为一个网站创建了一个搜索功能，此外我还制作了一个“建议框”，它会根据他们输入的内容下拉。（就像谷歌一样！）

所以我的问题是，盒子会根据窗口大小浮动。如何将其固定到搜索字段的底部？

在此处找到的实时示例：http: [//swissinstruments.com/searchresults.php](http://swissinstruments.com/searchresults.php)（请参阅顶部搜索字段，输入“a”或“c”以获得一些建议。

现在对于我正在使用的一些代码：

意见箱样式

```
.suggestion_list
{
z-index:500;
background: white;
border: 1px solid #80B6E1;
padding: 4px;
float:none;
margin-top:5px;
width:191px;
position:fixed;
}

.suggestion_list ul
{
padding: 0;
margin: 0;
list-style-type: none;
}

.suggestion_list a
{
text-decoration: none;
color: navy;
}

.suggestion_list .selected
{
background: navy;
color: white;
}

.suggestion_list .selected a
{
color: white;
}

#autosuggest
{
display: none;
}

The SEARCH BOX Style
#search-form { float:right; padding:9px 0 0 0;}
#search-form fieldset {
border:none;
border:1px solid #0f58a2;
border-top:none;
background:#126dbe;
padding:0 12px 10px 13px;
 float:right
}
#search-form input.text { width:190px; border:1px solid #d0e0e6; margin-right:3px;     padding:2px 2px 3px 7px;}
#search-form input.submit { background:#007cff; width:59px; text-align:center;     height:23px; line-height:23px; color:#fff; font-size:.77em; text-transform:uppercase;   border:none; cursor:pointer;} 
```

最后是用于定位 div 的 JavaScript 部分。我已将 x 设置为 -164，因为它似乎适用于大多数用户使用的分辨率。但是一旦我收缩或拉伸它，盒子就错位了。

```
/********************************************************
Position the dropdown div below the input text field.
********************************************************/
this.positionDiv = function()
{
    var el = this.elem;
    var x = -164;
    var y = el.offsetHeight;

    //Walk up the DOM and add up all of the offset positions.
    while (el.offsetParent && el.tagName.toUpperCase() != 'BODY')
    {
        x += el.offsetLeft;
        y += el.offsetTop;
        el = el.offsetParent;
    }

    x += el.offsetLeft;
    y += el.offsetTop;

    this.div.style.left = x + 'px';
    this.div.style.top = y + 'px';
}; 
```

有没有办法使用百分比而不是 px？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:34:14.293

您可以使用 CSS 中的嵌套 div 和相对/绝对定位来做到这一点，您实际上并不需要 javascript 来定位下拉菜单。

假设搜索表单没有填充/边距，这样的东西应该是齐平的

```
#suggest_container { position:relative; overflow:visible; }
#autosuggest { position:absolute; top:<height-of-search-form>; left:0px; }

<div id="suggest_container">
    <form id="search-form"></form>
    <div id="autosuggest"></div>
</div> 
```

你也可以一直使用 jquery UI 自动完成小部件，我以前用过很多次，它相当健壮

# c# - 为什么 C# 编译器允许使用 Linq 执行强制转换，但不允许使用括号？

> ID：10048825
> 
> 赞同：3
> 
> 时间：2012-04-06T20:22:28.567
> 
> 标签：c#, linq, generics, casting

我有一个通用类`NamedValue<TValue>`：

```
public class NamedValue<TValue>
{
    public string Name { get; set; }
    public TValue Value { get; set; }
} 
```

我有第二个泛型类，`NamedValueSource<TValue>`其中包含`List<NamedValue<TValue>>`：

```
public class NamedValueSource<TValue>
{
    public List<NamedValue<TValue>> NamedValues { get; set; }

    public NamedValueSource()
    {
        NamedValues = GetNamedValues().Cast<NamedValue<TValue>>().ToList();
    }

    private IEnumerable<NamedValue<bool>> GetNamedValues()
    {
        var yesNamedValue = new NamedValue<bool> { Name = "Yes", Value = true };
        var noNamedValue = new NamedValue<bool> { Name = "Yes", Value = false };
        yield return yesNamedValue;
        yield return noNamedValue;
    }
} 
```

以下测试代码完美运行（断言通过）：

```
public class Tester
{
    public Tester()
    {
        var source = new NamedValueSource<bool>();
        Debug.Assert(source.NamedValues[0].Name == "Yes");
    }
} 
```

现在，这是有趣的部分。如果我尝试在 内执行强制转换`GetNamedValues()`，则代码将无法编译：

```
public class NamedValueSourceFail<TValue>
{
    public List<NamedValue<TValue>> NamedValues { get; set; }

    public NamedValueSourceFail()
    {
        NamedValues = GetNamedValues().ToList();
    }

    private IEnumerable<NamedValue<TValue>> GetNamedValues()
    {
        var yesNamedValue = new NamedValue<bool> { Name = "Yes", Value = true };
        var noNamedValue = new NamedValue<bool> { Name = "Yes", Value = false };
        yield return (NamedValue<TValue>)yesNamedValue; // ERROR: cannot convert type
        yield return (NamedValue<TValue>)noNamedValue; // ERROR: cannot convert type
    }
} 
```

为什么`NamedValueSource<TValue>`编译时`NamedValueSourceFail<TValue>`出错？具体来说，为什么我可以使用 Linq 进行演员阵容，但不能使用好的 ol' parantheses？

**编辑**

如果从已接受答案的评论线程中不完全清楚，我只需`object`要先转换为，然后我将被允许转换为`NamedValue<TValue>`. 这可能是 Linq`Cast`方法在幕后工作的方式。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-06T20:49:08.200

**更新**：这个问题是[我 2012 年 7 月 10 日博客的主题](http://blogs.msdn.com/b/ericlippert/archive/2012/07/10/when-is-a-cast-not-a-cast.aspx)；谢谢你的好问题！

* * *

让我们大大简化您复杂的程序。

```
public static class X
{
    public static V Cast<V>(object o) { return (V)o; }
}

class C<T> {}
class D<U>
{
    public C<U> value;
    public D()
    {
        this.value = X.Cast<C<U>>(new C<bool>());
    }
} 
```

现在你的第二个版本，简化：

```
class C<T> {}
class D<U>
{
    public C<U> value;
    public D()
    {
        this.value = (C<U>)(new C<bool>());
    }
} 
```

好的，现在让我们问一些问题。

> 为什么第二个程序在编译时失败？

因为没有从`C<bool>`to`C<U>`的任意转换`U`。编译器知道这*可能*成功的*唯一*方法是*总是*布尔，因此这个程序几乎肯定是错误的！编译器假定在某些时候这将是 bool 以外的东西。*`U`*`U`**

 **> 那么为什么第一个程序在编译时成功呢？

编译器不知道应将名为“X.Cast”的方法视为类型转换运算符以进行错误检测！就编译器而言，该`Cast`方法是一种方法，它接受一个对象并`V`为提供的任何类型参数返回一个`V`。在编译 D 的 ctor 的主体时，编译器根本不知道某些方法（甚至可能不在此程序中开始）将尝试执行将失败的强制转换，除非`U`碰巧是布尔。

编译器根本没有将第一个版本视为错误的依据，即使它肯定是一个严重错误的程序。您必须等到运行时才能发现您的程序是错误的。

现在让我们制作程序的*第三个*版本：

```
class C<T> {}
class D<U>
{
    public C<U> value;
    public D()
    {
        this.value = (C<U>)(object)(new C<bool>());
    }
} 
```

这在编译时成功，所以让我们问：

> 为什么这会在编译时成功？

与第一个在编译时成功的原因完全相同。当您插入强制转换时，您实际上表示您希望将新构造`C<bool>`的对象视为一个对象，因此对于该表达式的其余分析，该表达式被认为是 object 类型，而不是更具体的 type `C<bool>`。

> 那么为什么`C<U>`在这种情况下投反对票是合法的呢？或者就此而言，`V`在第一种情况下？

将 object 强制转换为是合法的，`V`因为`V`它可能是对象的类型、对象的基类型或对象实现的接口，因此编译器允许转换，因为它认为有很多方法可能成功。

基本上，强制转换`object`为*任何可以转换为`object`*. 例如，您不能`object`转换为指针类型，因为没有指针类型可以转换为`object`. 但其他一切都是公平的游戏。

通过强制转换为`object`first，您正在从编译器的权限中*删除信息*；您是在说“忽略您知道这始终`C<bool>`是为了错误检测的事实。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-06T20:27:32.507

在您的第二个示例中，您尝试转换`NamedValue<bool>`为`NamedValue<TValue>`-- 这不起作用，因为转换必须对任何类型参数有效。您不能转换`NamedValue<bool>`为`NamedValue<int>`or`NamedValue<string>`或`NamedValue<AnythingElseOtherThanBool>`。

一种解决方案是制作`NamedValueSource<TValue>`抽象及其`GetNamedValues()`方法，然后创建一个类`BooleanNamedValueSource : NamedValueSource<bool>`类以在您的测试中使用。

在 linq 情况下，编译器不进行强制转换；转换发生在已经编译的方法中。编译器只知道它正在调用一个接受`IEnumerable<bool>`并返回的方法`IEnumerable<TValue>`。该转换的细节对编译器完全不可见。**

# javascript - 使用带有 onclick 的 target="_blank" 时未打开新窗口

> ID：10048830
> 
> 赞同：3
> 
> 时间：2012-04-06T20:22:50.717
> 
> 标签：javascript, html, onclick, analytics

摘要： 1\. 需要打开一个新窗口来显示来自第三方的调查。
2.不能使用JavaScript打开窗口（目前使用target="_blank"。3.必须使用JavaScript跟踪点击（目前使用onclick）。4.原始窗口不能在点击时改变其内容。

我有一个试图在新窗口中启动第三方调查的 JSP。最初，代码是这样启动新窗口的：

```
<a id="customer_survey_button"  href="#" target="_blank" onclick="recordOutboundLink(this, 'Outbound Links', 'blah.com');openChildWindow('http://www.blah.com/f.asp?etcetera','TAKE SURVEY');return false;"  class="genbut">TAKE SURVEY</a> 
```

它适用于 FF，但不适用于 Chrome。它导致了 Chrome 的安全问题。类似于“不安全的 JavaScript 尝试访问加载一个域的框架（新窗口）”之类的东西，而它的来源是另一个域。我的解决方案是使用 HTML 打开窗口，如下所示：

```
<a id="customer_survey_button"  href="http://www.blah.com/f.asp?etcetera" target="_blank" onclick="recordOutboundLink(this, 'Outbound Links', 'blah.com');return false;"  class="genbut">Take Survey</a> 
```

问题是，这不是在新窗口中打开。在调试过程中，我从上面的代码中删除了 onclick，它确实在新窗口中打开。我不确定JS代码是否有问题......

```
<script type="text/javascript">
<!--
var pageTracker = _gat._getTracker("<%=googleTrackerId%>");
pageTracker._initData();
pageTracker._trackPageview();

function recordOutboundLink(link, category, action) {
  try {    
    pageTracker._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100)
  }catch(err){}
}
// -->
</script> 
```

...或者如果只是在同一个锚标记中使用 target 和 onclick 。有什么想法吗？

我在其他地方进行了研究，在 Stack Overflow 上，我发现了以下结果，但似乎没有一个可以解决这种情况。举些例子）：

这在某种程度上有所帮助，因为我能够测试“return false”的删除。这与“user1223427”的结果相同 - 它在两个不同的窗口中呈现相同的页面。它没有帮助，因为我需要一种非 JavaScript 方式来打开目标 URL（由于提到的安全问题）。 [OnClick 用于谷歌分析和目标 _blank。链接失效了？](https://stackoverflow.com/questions/9379615/onclick-for-google-analytics-and-target-blank-the-link-does-not-work)

这没有帮助，因为我没有使用 JQuery，而且我不了解 JQuery 解决方案与我的情况之间的联系 [选择包含 _blank 的 onclick](https://stackoverflow.com/questions/7595227/select-onclick-that-contains-blank)

这仅适用于让跟踪代码正常工作，而不适用于打开新窗口的问题： [Google Analytics - 下载点击跟踪](https://stackoverflow.com/questions/9278760/google-analytics-download-clicks-tracking)

我认为这个会有一个很好的结果，但它的解决方案是一个 JS 解决方案。 [在 Google Analytics（分析）的新窗口中打开链接时，外部链接跟踪出现错误？](https://stackoverflow.com/questions/4692270/bug-in-external-link-tracking-when-opening-the-link-in-a-new-window-in-google-an)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T20:49:51.693

recordOutboundLink 函数正在打开链接。

```
//This is changing the URL to the href of the link you clicked    
setTimeout('document.location = "' + link.href + '"', 100) 
```

您的第二个示例是从 onclick 事件返回 false 。这将阻止锚标记执行其正常行为。

如果您注释掉 setTimeout 行，并从 onclick 中删除 return false，您应该会看到链接的行为符合您的要求。

您还可以修改 setTimeout 函数以调用 window.open 而不是 document.location

# c# - 以任意角度将球从墙上弹起？

> ID：10048840
> 
> 赞同：2
> 
> 时间：2012-04-06T20:23:23.850
> 
> 标签：c#, vector, xna, physics

我试图让用户画一个桨，然后他们可以用它来击球。但是，我似乎无法让球正确反弹，因为球速度的 x 和 y 分量没有与墙壁对齐。我怎样才能解决这个问题？

[我在这里](https://stackoverflow.com/questions/573084/how-to-calculate-bounce-angle)尝试了 Gareth Rees 给出的建议，但显然我对向量的了解不够，无法遵循它。例如，我不知道你在向量中究竟存储了什么——我知道它是一个带方向的值，但是你是否存储了它之间的 2 个点、斜率、角度？

我真正需要的是给定墙壁的角度以及球击中时的 x 和 y 速度，然后找到新的 x 和 y 速度。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-07T16:42:47.853

Gareth Rees 的公式是正确的，但我发现[这里](http://www.3dkingdoms.com/weekly/weekly.php?a=2)的图片和解释更清楚一些。也就是说，基本公式是：

```
Vnew = -2*(V dot N)*N + V
where
V = Incoming Velocity Vector
N = The Normal Vector of the wall 
```

由于您不熟悉向量符号，因此您需要了解此公式：向量基本上只是 x,y 对，所以`V = (v.x, v.y)`和`N = (n.x, n.y)`。平面最好用平面的法线来描述，即垂直于平面的单位长度矢量。然后是几个公式，`b*V = (b*v.x, b*v.y)`; `V dot N = v.x*n.x+v.y*n.y`，即是一个标量；和`A + B = (a.x+b.x, a.y+b.y)`。最后，要找到基于任意向量的单位向量，它是`N = M/sqrt(M dot M)`。

如果曲面是弯曲的，则在接触点使用法线。

# php - 数组返回 [Object object] 而不是值？

> ID：10048845
> 
> 赞同：1
> 
> 时间：2012-04-06T20:23:54.730
> 
> 标签：php, javascript, arrays, json

> **可能重复：**
> [Json 返回 [object object] 而不是数组](https://stackoverflow.com/questions/7620953/json-returning-object-object-instead-of-array)

我有一个包含子数组的数组，通过 POST 请求拉到 PHP 文件。问题是，我很难找到如何返回数组对象的值，更不用说遍历它了。

**Javascript**

```
$.ajax({
    type: 'POST',
    url: 'php.php',
    data: 'id=testdata',
    dataType: 'json',
    cache: false,
    success: function(result) {
        alert(result[0]); // returns [Object object]
    },
}); 
```

我确信它正确地从 PHP 文件中获取了数组。

这是[PHP 文件](http://adventurelobbies.com/php.php)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T20:33:54.840

在您的情况下，`result`是一个对象数组，`result[0]`第一个对象也是如此。要访问`id`例如，您将使用`result[0]['id']`. 为了遍历对象数组，您可以使用这样的 for 循环，例如：

```
for(var i=0, len = result.length; i<len; i++) {
    //write your code for each object in the results here
    var id = result[i]['id'];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T20:34:20.313

您必须在对象中指定要显示的对象，我的意思是....

```
alert(result[0]['field_name']); 
```

当您使用 PHP 从一个“ **id** ”中获取一些数据时，我可以建议您在查询 mysql 时，使用下一个语法，

```
echo json_encode(mysql_fetch_object(mysql_query('your_query'))); 
```

使用此语法，您将仅获得一个对象，其中包含在查询中提取的所有字段，因此警报将是：

```
alert(result['field_name']); 
```

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T20:30:42.323

您可以像这样迭代它：

```
$.each(result, function () {
    alert(this.name);   // or this.id, this.description, etc.
}); 
```

我建议使用诸如 Firebug 之类的工具，然后这样做`console.log(result);`以获得更具描述性的输出。

# adaboost - AdaBoost 输入和输出？

> ID：10048848
> 
> 赞同：4
> 
> 时间：2012-04-06T20:24:18.803
> 
> 标签：adaboost

我是一个非技术人员，正在尝试实现图像分类。在本文中，我遇到了 ADA Boost 算法，该算法是在视频关键帧的“特征包”步骤之后实现的。有人可以通俗地解释一下 ADA Boost 的作用，它的输入和输出是什么？有人可以指出我的代码相同吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T11:36:56.657

首先，如果您可以链接/命名您所指的论文，那就太好了。

[AdaBoost](https://en.wikipedia.org/wiki/AdaBoost)是一种元分类算法，因为它结合了多个称为弱学习器的分类器。这些弱学习器通常非常简单，例如它们仅基于一个特征对数据进行分类，并且比随机学习器表现稍好。

在图像分类中，AdaBoost 将使用一组图像数据（对应的标签描述每个样本所属的类别）和一组弱学习器作为输入。然后，AdaBoost 将在数据上找到具有最低错误率（即最佳结果）的弱学习器。所有正确分类的数据样本现在被赋予较低的权重，因为它们现在不太重要，而错误分类的样本被赋予更高的权重。AdaBoost 现在将开始新一轮，并根据新加权的数据选择最佳的弱学习器。换句话说，它将找到一个新的弱学习器，该弱学习器更擅长对先前选择的弱学习器无法分类的样本进行分类。

该算法将继续选择这些弱学习器进行指定数量的迭代。输出由一组选定的弱学习器组成。学习到的分类器现在可以根据组中每个弱分类器的多数票对新图像进行分类（通常弱分类器本身也根据其实现的错误率进行加权）。

您可能想看看已经实现 AdaBoost 的软件，例如[WEKA](http://www.cs.waikato.ac.nz/ml/weka/)或面向计算机视觉的[OpenCV](http://opencv.willowgarage.com/wiki/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-04T03:51:53.713

Adaboost 将一堆弱分类器组合起来形成一个强分类器。输出是加法中使用的弱分类器的权重序列，`w_i`以形成单个加权分类器。该算法有许多中间输出，但也许最重要的是权重本身。

虽然最初不是这样设想的，但 Adaboost 相当于在训练集上拟合“前向阶段”模型，在每一步使用弱分类器，使用指数损失函数：`L(y,f(x)) = exp(-y*f(x))`，`f(.)`我们的分类器在哪里。这样看，算法的某些方面就更清楚了。指数损失函数经常用于分类问题，这是有充分理由的。

# jquery - 滚动经过弯道后使 Div 出现

> ID：10048852
> 
> 赞同：0
> 
> 时间：2012-04-06T20:24:28.093
> 
> 标签：jquery

我想复制下面网站中使用的技术，以便在查看器滚动过折叠后，会自动显示一个 div。

[http://www.talentgarden.it/it/#!/home](http://www.talentgarden.it/it/#!/home)

我熟悉使用 jquery 隐藏 div 和使用 scrollTop 函数，但我不确定如何让 jquery 知道用户已通过折叠。

我是一个菜鸟，所以任何帮助表示赞赏。

谢谢，

乔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:34:54.390

他正在使用 ScrollSpy。见[http://davidwalsh.name/mootools-scrollspy](http://davidwalsh.name/mootools-scrollspy)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:33:23.247

这是我使用的代码（从某处获得）

```
var wintop = $(window).scrollTop(), docheight = $(document).height(), winheight = $(window).height();
if  ((wintop/(docheight-winheight)) > scrolltrigger) {...} 
```

其中 scrolltrigger 是操作发生时页面的百分比。因此，如果您希望它在 95% 的页面显示后发生，请让 scrolltrigger = .95

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T20:34:05.507

看来他们正在检查 div 顶部相对于窗口底部的位置。一旦 div 向上滚动超过某个点，就会出现 div。

# python - 用于输入交互式 Python 游戏的输入弹出窗口

> ID：10048853
> 
> 赞同：-2
> 
> 时间：2012-04-06T20:24:45.223
> 
> 标签：python, input, popup, pygame

我是 Python 的新手，需要编写一个简单的游戏，该游戏需要用户在输入屏幕中输入一些值（之后 Python 代码会对该输入执行某些操作）。在这种情况下使用的最佳 API 是什么？我知道 pygame 提供了一个非常好的 GUI，用户可以在上面与屏幕上的对象进行交互，但我不知道这是否是在正式项目中使用的最佳选择。否则，我听说过 Tkinter 和其他各种应用程序，但真的不知道什么是最好的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:51:36.677

```
from Tkinter import *

class MyDialog:

    def __init__(self, parent):

        top = self.top = Toplevel(parent)

        Label(top, text="Value").pack()

        self.e = Entry(top)
        self.e.pack(padx=5)

        b = Button(top, text="OK", command=self.ok)
        b.pack(pady=5)

    def ok(self):

        print "value is", self.e.get()

        self.top.destroy()

root = Tk()
Button(root, text="Hello!").pack()
root.update()

d = MyDialog(root)

root.wait_window(d.top)
root.mainloop() 
```

[酱](http://www.pythonware.com/library/tkinter/introduction/dialog-windows.htm)

# vba - 为什么 If Not IsEmpty 不过滤掉空字符串？

> ID：10048855
> 
> 赞同：8
> 
> 时间：2012-04-06T20:24:56.977
> 
> 标签：vba, if-statement, string

我的`If`情况有什么问题？

```
If Not IsEmpty(Wrkgps_L3) And Not IsEmpty(Wrkgps_L4) Then
    Wrkgps_L3L4 = Wrkgps_L3 & "," & Wrkgps_L4
End If 
```

`Not`条件似乎不起作用。`If`即使两者都是空字符串`Wrkgps_L3`，语句中的代码也会被执行。`Wrkgps_L4`

## 更新：

`Wrkgps_L3`并且`Wrkgps_L4`是包含从函数返回的结果的变量。`IsEmpty(Wrkgps_L3) = False`我注意到了`Wrkgps_L3 = ""`。我不得不重写我的代码

```
If (Wrkgps_L3 <> "") And (Wrkgps_L4 <> "") Then 
```

无论如何，我仍然很想知道为什么`IsEmpty`对变量不起作用`""`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-06T21:06:09.093

在 Visual Basic 中，`Empty`和`""`（一个空字符串）是两个不同的东西。`Empty`是`Variant`变量的未初始化状态，并`IsEmpty`测试`Variant`变量是否具有`Empty`值：

```
Dim x As Variant
If IsEmpty(x) Then
    Debug.Print "x is empty"
End If 
```

正如您所观察到的，您必须`""`在检查`String`变量是否包含空字符串时进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T17:50:33.660

如果变量是字符串，您还可以：

```
If Len(Wrkgps_L3) + Len(Wrkgps_L4) = 0 Then
   ' They're both empty string variables
Else
   ' One or the other contains at least one character
End If 
```

# php - phpunit 和 yii - (PHPUnit/Autoload.php)：无法打开流：

> ID：10048856
> 
> 赞同：3
> 
> 时间：2012-04-06T20:25:22.403
> 
> 标签：php, yii, phpunit

使用 Yii 安装 phpunit 时遇到很多问题。我跑：

```
$ phpunit unit/dbTest.php 
```

但事实证明这个错误：

> PHP 警告：require_once(PHPUnit/Autoload.php)：无法打开流：第 12 行的 /opt/yii-1.1.10.r3566/framework/test/CTestCase.php 中没有此类文件或目录
> 
> (include_path='.:/usr/bin:/usr/share/php:/usr/bin/pear:/usr/share/php/Zend/:/opt/php5.3.10/lib/php/PHPUnit'

关于我的安装的一些细节：

```
$ phpunit --version
PHPUnit 3.4.5 by Sebastian Bergmann.

php --version
PHP 5.3.10 (cli) (built: Apr  6 2012 20:06:37) ( rebuilt didn't help :( )

pear list phpunit/phpunit
....
php    /opt/php5.3.10/lib/php/PHPUnit/Autoload.php 
```

根据该信息，自动加载已安装，并且位于包含路径上。

我不确定我还需要做什么 - 任何人都可以阐明一下吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T11:36:30.643

我希望这对某人有用：

似乎在 ubuntu PEAR 上完成了这项任务，`apt-get`也无济于事。

这就是我解决它的方法

从手动下载`http://pear.phpunit.de/`

```
phpunit/PHPUnit 
```

和

```
phpunit/File_Iterator
PHPUnit_MockObject
phpunit/PHPUnit_Selenium
PHP_CodeCoverage 
```

手动解压缩并正确放入 php lib 或您希望它们去的任何地方。把这个库的头放在你的包含路径上（PHP、PHPlib、PEAR 在我的设置中都在这个根级别。）

该死的，希望能帮助我昨晚花了大约 6 个小时才让它工作的人......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T18:35:54.453

正如 rix 在他的回答中显示的那样，您必须手动下载一些文件。

我按照以下命令在 Ubuntu 10.04 上运行：

```
wget http://pear.phpunit.de/get/PHPUnit-3.6.10.tgz
wget http://pear.phpunit.de/get/File_Iterator-1.3.1.tgz
wget http://pear.phpunit.de/get/PHPUnit_MockObject-1.1.1.tgz
wget http://pear.phpunit.de/get/PHPUnit_Selenium-1.2.6.tgz
wget http://pear.phpunit.de/get/PHP_CodeCoverage-1.1.2.tgz
wget http://pear.phpunit.de/get/PHP_TokenStream-1.1.3.tgz
wget http://pear.phpunit.de/get/Text_Template-1.1.1.tgz
wget http://pear.phpunit.de/get/PHP_Timer-1.0.2.tgz

sudo vi /etc/php5/cli/php.ini 
```

=> 添加 /usr/share/php/PHPUnit/ 到 include_path 指令

```
tar xzf PHPUnit-3.6.10.tgz 
cd PHPUnit-3.6.10/
sudo cp -r PHPUnit/ /usr/share/php/
sudo ln -s /usr/share/php/PHPUnit /usr/bin/PHPUnit

tar xzf File_Iterator-1.3.1.tgz
sudo cp -r File/ /usr/share/php/PHPUnit/

tar xzf PHP_CodeCoverage-1.1.2.tgz
cd PHP_CodeCoverage-1.1.2/
sudo cp -R PHP/ /usr/share/php/PHPUnit/

tar xzf PHP_TokenStream-1.1.3.tgz
cd PHP_TokenStream-1.1.3/PHP/
sudo cp -r Token* /usr/share/php/PHPUnit/PHP/

tar xzf Text_Template-1.1.1.tgz
cd Text_Template-1.1.1/
sudo cp -r Text/ /usr/share/php/PHPUnit/

tar xzf PHP_Timer-1.0.2.tgz 
cd PHP_Timer-1.0.2/
sudo cp -r PHP/Timer* /usr/share/php/PHPUnit/PHP/

tar xzf PHPUnit_MockObject-1.1.1.tgz
cd PHPUnit_MockObject-1.1.1/
sudo cp -r PHPUnit/Framework/MockObject/ /usr/share/php/PHPUnit/Framework/

tar xzf PHPUnit_Selenium-1.2.6.tgz
cd PHPUnit_Selenium-1.2.6/
sudo cp -r PHPUnit/Extensions/* /usr/share/php/PHPUnit/Extensions/ 
```

# mysql - Django过滤器以包含存在某种类型项目的所有标签

> ID：10048860
> 
> 赞同：2
> 
> 时间：2012-04-06T20:25:36.970
> 
> 标签：mysql, django, filter, django-taggit

我正在使用 django-taggit。我正在标记操作项和信息项。我想列出所有有信息项的标签。我最初写道：

```
Tag.objects.filter(info_item__name__isnull=False).annotate(info_item_count=Count('info_item')) 
```

但这是返回一些操作项。我如何重写查询以便过滤标签以附加信息项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T04:52:59.947

假设您的 info_item 模型是 InfoItem，然后尝试

```
from django.contrib.contenttypes.models import ContentType  
Tag.objects.filter(
    taggit_taggeditem_items__content_type=ContentType.objects.get_for_model(InfoItem), 
    info_item__name__isnull=False).annotate(info_item_count=Count('info_item')) 
```

# php - 自定义 php 块中的链接 css？

> ID：10048862
> 
> 赞同：1
> 
> 时间：2012-04-06T20:25:45.250
> 
> 标签：php, css, href

我正在尝试自定义我网站上通过 php 插入的链接。通过 php 插入它们的原因是为了检查用户登录并根据它们的状态编辑日志选项（有问题的链接），因此据我所知，从 php 中删除它们是行不通的。我尝试过内联和外部样式，但是，如果我没记错的话，它在过去也适用于其他东西，但它不适用于这些链接。有人有什么好主意吗？

这是（立即）代码：

```
 $logOptions = $PM_envelope . '&nbsp;&nbsp; <a href="../index.php">home</a> &nbsp; <a href="../profile.php">profile</a> &nbsp; <a href="../settings.php">settings</a> &nbsp; <a href="../logout.php">logout</a>' ; 
```

样式是这样的：

```
 .loginmenulinks a:link {
         color:#09C; 
         text-decoration:none;
         font-family:GeosansLight, sans-serif; 
         font-size:12px;
         } 
```

悬停等也是如此。

我在标题中的 div 中调用它：

```
 <div><?php echo $logOptions; ?></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:37:24.293

为什么世界上“没有办法自定义” PHP 生成的链接的 CSS？PHP 生成 HTML，HTML 和 CSS 在浏览器端。浏览器无法知道什么来自 PHP，什么不是，那么它如何区分这些动态内容呢？

```
<?php echo "<a href=\"#\" class=\"blah\">Text</a>"; ?> 
```

CSS：

```
.blah {color: orange;} 
```

突然，一个橙色的链接出现了。

您是否忘记了可能首先指定任何样式？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:38:01.393

您可以向 a-tag 添加其他类或 id，以获得从外部资源添加样式表的能力。

但是，将这些内容保留在您的 PHP 代码中并不是一个好主意，您应该在应用程序中的视图和逻辑层之间使用一些分离。

此外，您不应使用   但是 css 来获得间距，因为它不打算这样做。

# javascript - jQuery animate（）脉冲（）不起作用

> ID：10048867
> 
> 赞同：0
> 
> 时间：2012-04-06T20:26:18.780
> 
> 标签：javascript, jquery, jquery-animate, pulse

在下面的代码中，`animate()`函数在`click()`起作用。但是，`animate()`或`pulse()`（未注释时） in`mouseenter()`也不起作用。该`pulse()`功能由 Jarrod Overson 提供...

[http://jarrodoverson.com/static/demos/jquery.pulse.html](http://jarrodoverson.com/static/demos/jquery.pulse.html)

```
 sectionTitle = $j(this).find(".sectionTitle");
    sectionTitle.click(function(){
    if($j(this).parent().height() == sections[$j(this).parent().attr("id")]["height"]){
        origHeight = sections[$j(this).parent().attr("id")]["origHeight"];
        $j(this).parent().animate({height:origHeight},"slow");
    }else{
        height = sections[$j(this).parent().attr("id")]["height"];
        $j(this).parent().animate({height:height},"slow");
    }
    })
    sectionTitle.mouseenter(function(){
    var properties = { "color" : '#F00' };
  //    $j(this).pulse(properties, 500, 3);
    $j(this).animate({"background-color":'#F00'},"slow");
    }) 
```

我的代码的一个活生生的例子是here。 [http://fantasticvisions.net/test/me/](http://fantasticvisions.net/test/me/)

这些类`sectionTitle`应用于上述页面上的许多 H2 元素。单击它们将导致内容扩展，使用 jQuery `animate()`。然而，`mouseenter()`失败了。

我在这里想念什么？我已经尝试了许多其他变体，但都没有奏效。该`mouseenter()`事件确实触发了，并且代码被执行（我已经跟踪了这个），但效果似乎从未发生过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:55:42.610

`.animate()`不起作用，因为 jQuery 本身不支持颜色动画。

如果您包含 jQuery UI 或彩色动画插件，这应该可以工作。

# database - 逐行从备忘录框中提取文本

> ID：10048868
> 
> 赞同：3
> 
> 时间：2012-04-06T20:26:30.117
> 
> 标签：database, delphi, paradox

我需要浏览大量存储在备忘录字段中的悖论表中的数据。我需要逐行处理这个数据并处理每一行。

如何告诉 Delphi 逐一获取备忘录字段中的每一行？

我可以使用#13#10 作为分隔符吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T20:33:28.883

假设备忘录字段中的内容使用 #13#10 作为行分隔符，那么我将使用 a`TStringList`和非常有用的[`Text`](http://docwiki.embarcadero.com/Libraries/XE2/en/System.Classes.TStrings.Text)属性将备忘录字段文本拆分为单独的行：

```
var
  StringList: TStringList;
  Line: string;
.....
StringList.Text := MemoFieldText;
for Line in StringList do
  Process(Line); 
```

即使您的备注字段使用 Unix 换行符，此代码也会正确解释备注字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:52:15.420

这取决于在 Paradox 中实际声明该字段的方式。如果它是一个 TMemoField，这很容易：

```
var
  SL: TStringList;
  Line: string;
begin
  SL := TStringList.Create;
  try
    SL.Text := YourMemoField.GetAsString;
    for Line in SL do
     // Process each line of text using `Line`
  finally
    SL.Free;
  end;
end; 
```

如果是 TBlobField，就复杂一点。您需要使用 a 读取备忘录字段`TBlobStream`，并将该流的内容加载到 a 中`TStringList`：

```
// For Delphi versions that support it:
procedure LoadBlobToStringList(const DS: TDataSet; const FieldName: string;
  const SL: TStringList);
var
  Stream: TStream;
begin
  Assert(Assigned(SL), 'Create the stringlist for LoadBlobToStringList!');
  SL.Clear;
  Stream := DS.CreateBlobStream(DS.FieldByName(FieldName), bmRead);
  try
    SL.LoadFromStream(Stream);
  finally
    Stream.Free;
  end;
end;

// For older Delphi versions that do not have TDataSet.CreateBlobStream
procedure LoadBlobToStringList(const DS: TDataSet; const TheField: TField; 
  const SL: TStringList);
var
  BlobStr: TBlobStream;
begin
  Assert(Assigned(SL), 'Create the stringlist for LoadBlobToStringList!');
  SL.Clear;
  BlobStr := TBlobStream.Create(DS.FieldByName(TheField), bmRead);
  try
    SL.LoadFromStream(BlobStr);
  finally
    BlobStr.Free;
  end;
end;

// Use it
var
  SL: TStringList;
  Line: string;
begin
  SL := TStringList.Create;
  LoadBlobToStringList(YourTable, YourMemoFieldName, SL);
  for Line in SL do
    // Process each Line, which will be the individual line in the blob field

  // Alternatively, for earlier Delphi versions that don't support for..in
  // declare an integer variable `i`
  for i := 0 to SL.Count - 1 do
  begin
    Line := SL[i];
    // process line of text using Line
  end;
end; 
```

# python - PyErr_Set* 两次

> ID：10048877
> 
> 赞同：2
> 
> 时间：2012-04-06T20:27:15.583
> 
> 标签：python, c, exception, python-c-extension

调用`PyErr_Set*`覆盖异常是否安全？根据文档，如果出现错误，则使用提供给它的message 参数[`PySequence_Fast`](http://docs.python.org/c-api/sequence.html#PySequence_Fast)引发 a 。引发错误后调用是否安全？`TypeError``const char *``PyErr_SetObject``PySequence_Fast`

例子：

```
static PyObject * myfunc(PyObject * self, PyObject * args) {
    PyObject * pyobj;
    PyObject * pyseq;
    PyObject * message;

    if (!PyArg_ParseTuple(args, "O", &pyobj)) {
        return NULL;
    }

    pyseq = PySequence_Fast(pyobj, "");
    if (pyseq == NULL) {
        message = PyString_FromFormat("argument is a '%s', not a sequence.", pyobj->ob_type->tp_name);
        PyErr_SetObject(PyExc_TypeError, message);
        Py_XDECREF(message);
        return NULL;
    }

    // ...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T16:42:29.677

根据 Python 2.7.2 源代码中的“Python/errors.c”，在设置新异常状态变量之前`PyErr_SetObject()`调用`PyErr_Restore()`which `Py_XDECREF()`s 任何旧异常状态变量。所以是的，覆盖现有异常是安全的。请注意，您完全覆盖了先前的异常。

# java - 适合所有事物的自己的课程

> ID：10048879
> 
> 赞同：1
> 
> 时间：2012-04-06T20:27:37.607
> 
> 标签：java, swing, oop, class

我正在制作一个客户管理软件。有几个 JPanel 上面有很多内容，不断与数据库通信。数据库中是客户数据、产品等。
为了更快地访问数据库数据，首先我将它们全部加载到它自己的 ArrayList 中，例如`ArrayList<Customer>`. 如果用户更改此数据，则必须在类和数据库中更改。
由于 JPanel`View`看起来非常“完整”（挤满了其他 JPanel 和 JTabbedPanes，使用 CardLayout 切换），我认为最好为每个“主” JPanel 创建一个自己的类并将它们全部链接到`View`.
例如 JPanel 的一个自己的类，`Customer`可以查看和编辑所有客户数据，产品等也是如此。

有意义还是不方便？我只想这样做是为了外包代码并使类更清晰，尤其是`View`.
有没有类似设计模式的东西来处理这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T20:41:58.497

所以你的程序由一个单一的类组成，它是 JPanel 的子类，并且包含对你 UI 中使用的所有其他组件的引用？而且您想知道是否应该将该 UI 的某些部分分解为其他类。

总之是的。您始终可以通过将部分代码移出到新类中来将任何类分解为聚合类，并使原始类包含对新类的引用。这称为委托或提取类重构。您可以在 Martin Fowler 的 Refactoring 书中了解此技术。

创建作为整个 UI 一部分的其他 UI，例如 CustomerPanel，是一种很好的思考方式。通过这样做，您还可以解耦 UI 的各个部分。创建这些较小的类以将所有依赖项移动到新类时要小心。如果您想将主 UI 的引用传递回聚合类，那么您可能还没有完全解耦您的类。这应该表明您没有对要提取的类承担足够的责任，或者它们应该共享一些其他依赖项。

基本上规则是如果你提取一个类，它不应该有对包含它的类的引用。参考应该更像是一棵树而不是图表。他们可以共享模型类，但不能在视图之间创建循环。

您可能会觉得这很有趣： [摇摆的 GUI 指南](https://stackoverflow.com/questions/2337323/gui-guidelines-for-swing/2337940#2337940)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:47:43.113

我不确定我是否理解您的意图，但看起来您想要实现分解级别，这将允许您外包某些 UI 组件并重用它们，嗯，基本上实现尽可能低的耦合。除了@chubbard 所说的之外，我建议您研究[MVP](http://en.wikipedia.org/wiki/Model_View_Presenter)模式并在组件之间使用基于事件的交互，而不是引用它们。这可以消除不必要的依赖并带来更多的可重用性。

# asp.net - 使用 BasicHttpBinding 的 WCF 直接身份验证

> ID：10048885
> 
> 赞同：0
> 
> 时间：2012-04-06T20:28:13.143
> 
> 标签：asp.net, wcf, web-services

我正在尝试在我的开发机器中测试一个简单的场景，其中我有一个在 basicHttpbinding 上配置的服务。我正在尝试使用 CustomUserNamePasswordValidator 并将安全级别配置为“TransportWithMessageCredential”

现在，当我使用 Web 客户端（Asp.net 开发服务器上的服务和客户端）测试服务时，服务完全忽略了验证器并简单地返回数据，尽管我从客户端传递了错误的凭据。

是因为我使用的是 VS Development Server 吗？当我们使用 TransportWithMessageCredentials 时，是否强制使用 SSL over HTTP。有没有我不需要使用 Https 的替代方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T23:23:35.623

WCF 不支持任何允许传输不安全凭据的开箱即用配置。

# wordpress - Wordpress：single.php 仅显示最新帖子

> ID：10048887
> 
> 赞同：0
> 
> 时间：2012-04-06T20:28:17.513
> 
> 标签：wordpress, loops, themes

我正在开发一个 wordpress 3.3.1 主题，但我在使用 single.php 文件时遇到了问题。它显示 - 无论您选择什么帖子（&p=111 例如） - 只显示最新帖子的内容。

这是我的循环：

```
 <?php if (have_posts()) : ?>
            <?php while (have_posts()) : the_post(); ?>

            <h1 class="page-title"><?php the_title() ?></h1>

            <?php if (has_post_thumbnail( $post->ID ) ): ?>
            <?php $image = wp_get_attachment_image_src(get_post_thumbnail_id( $post->ID ), 'single-post-thumbnail' ); ?>
            <img src="<?php echo $image[0]; ?>" class="cover" />
            <?php endif; ?>

            <p class="page-text">
                <?php the_content(); ?>     
            </p>

            <?php endwhile; ?>
            <?php endif; ?> 
```

有什么问题？我希望你明白我的问题。谢谢！

编辑：

我最近更新了头文件。当我删除这个循环时，它工作正常：

```
 <ul class="nav-dropdown">
                        <?php
                            $cat_args = array(
                              'orderby' => 'name',
                              'order' => 'ASC',
                              'child_of' => 5,
                              'exclude' => '1,2,3,4,5,6,8,9,10,11,12,13,14'
                            );
                            $categories = get_categories($cat_args); 
                            foreach($categories as $category) {

                                 $post_args = array(
                                  'category' => $category->term_id
                                );
                                $posts = get_posts($post_args);

                                foreach($posts as $post) {
                        ?>
                            <li class="nav-dropdown"><a href="<?php the_permalink(); ?>" class="pagelink"><?php the_title(); ?></a></li>
                        <?php
                                }
                            }
                        ?>
                        </ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T10:35:40.937

我会将标题中的变量名称更改为`$post`Wordpress 为处理单个帖子页面保留的变量名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T12:14:18.957

我不确定，但请将`$post`变量更改为任何其他变量，然后尝试可能会解决您的问题。

因为`$post`是post的全局变量。

# python - # Error: IndentationError: unindent does not match any external indentation level # On First Line of Code

> ID：10048891
> 
> 赞同：-2
> 
> 时间：2012-04-06T20:28:38.380
> 
> 标签：python, indentation, maya

尝试将我的一个脚本导入 Maya 的内存时，我的 python 代码出现错误。

这是代码：

```
import solar_system as ss
import pymel.core as pm
import random 
```

我收到了这个错误：

```
# Error: unindent does not match any outer indentation level
# Traceback (most recent call last):
#   File "<maya console>", line 1, in <module>
#   File "C:/Users/Owner/Documents/maya/2012-x64/prefs/scripts\solar_system.py", line 66
#     '''
#          
# ^
# IndentationError: unindent does not match any outer indentation level # 
```

那么，出于某种原因，它甚至希望 import solar_system 作为 ss 缩进？我真的不明白它要我做什么。有什么帮助吗？请？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:32:28.913

在您的文件`solar_system.py`中，第 66 行似乎存在缩进错误。您可能需要确保没有混合制表符和空格进行缩进。如果您可以发布该文件的前 70 行，我们可以告诉您更多有关其他可能错误的信息。

# asp.net - 过滤诊断性能计数器

> ID：10048894
> 
> 赞同：0
> 
> 时间：2012-04-06T20:29:10.447
> 
> 标签：asp.net, .net, azure, performancecounter, system.diagnostics

我有这个简单的性能计数器设置。问题是这个性能计数器完全没用。它在 60 秒的时间跨度内测量 CPU 使用百分比并记录该数字。我需要做的是以某种方式让它过滤数据，以便它只记录 CPU 利用率高的数字，比如 80%+。我不想用垃圾数据夸大日志。

```
diagnosticMonitorConfiguration.PerformanceCounters.ScheduledTransferPeriod = TimeSpan.FromMinutes(2D);
diagnosticMonitorConfiguration.PerformanceCounters.BufferQuotaInMB = 10;
TimeSpan perfSampleRate = TimeSpan.FromSeconds(60D);

 diagnosticMonitorConfiguration.PerformanceCounters.DataSources.Add(new PerformanceCounterConfiguration()
{
    CounterSpecifier = @"\Processor(_Total)\% Processor Time",
    SampleRate = perfSampleRate
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T01:20:12.330

您所要求的实际上是不可能的。您可以将 CPU 值以每实例每分钟一次的频率传输到表中。但是您需要对 WADPerformanceCountersTable 使用自定义查询，以获取仅超过某个阈值的值。

你想做什么？最终目标？

# python - Python 中的对象表示

> ID：10048898
> 
> 赞同：0
> 
> 时间：2012-04-06T20:30:02.067
> 
> 标签：python, string, object, representation

我想要一个 python 对象的字符串表示。我曾经用著名的泡菜来做，但我想知道它是否存在更好更便宜的东西。我不喜欢使用 repr 和 eval 因为它们不安全。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:34:34.683

YAML 是一种相当不错的序列化数据结构格式。它类似于 JSON，但更是如此。[PyYAML](http://pyyaml.org/wiki/PyYAML)库运行良好。除了让它猜测如何序列化数据结构之外，您还可以获得相当具体的信息。有关示例，请参阅他们的完整文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:35:12.760

用于`repr()`获取字符串表示，并`ast.literal_eval()`恢复对象。

或者只用泡菜。如果您使用的是 Python 2.x，您`import cPickle`可以获得更快的 pickle，但在 Python 3.x 中只有一个 pickle，它是 C 的。

就个人而言，我喜欢将 JSON 用于简单对象；你可以试试看`import json`它是否适合你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T20:34:44.413

通过对象表示，如果您的意思是序列化，那么 pickle 是一种选择。如果您想要更快的实现，请尝试[cPickle](http://docs.python.org/release/2.5/lib/module-cPickle.html)

# java - 字符串到字符数组 Java

> ID：10048899
> 
> 赞同：56
> 
> 时间：2012-04-06T20:30:03.527
> 
> 标签：java, arrays

我对此感到困惑，我需要一些新鲜的眼光，我不确定为什么这段代码会这样做。

```
String string = new String(new char[] {(char) 0x01, (char) 0x02, ... ,(char) 0xFC}); 
```

输出是它应该直到最后一个数字（0xFC）的所有内容，它返回一个-4，我知道它是一个十六进制值，但如果我对十进制值 252 做同样的事情，它也会给我一个负数。我希望这只是一个简单的解决方案，我只是看不到它。

提前谢谢。

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2012-04-06T20:36:47.500

字符串到 char 数组很简单

```
String str = "someString"; 
char[] charArray = str.toCharArray(); 
```

你能解释一下你想要做什么吗？

*** 更新 ***

如果我理解您的新评论，您可以使用字节数组并提供示例。

```
byte[] bytes = ByteBuffer.allocate(4).putInt(1695609641).array();

for (byte b : bytes) {
   System.out.format("0x%x ", b);
} 
```

具有以下输出

0x65 0x10 0xf3 0x29

# c# - 来自 Form.Post 的 NameValueCollection 显示 FIELDS 和 VALUES

> ID：10048900
> 
> 赞同：-1
> 
> 时间：2012-04-06T20:30:06.380
> 
> 标签：c#, asp.net, collections

我需要从 POST 中获取所有字段和值。

我有以下内容，它只返回字段但不返回值。

```
NameValueCollection authForm = Request.Form;
String[] a = authForm.AllKeys;

for (i = 0; i < a.Length; i++)
{
    frm += ("Form: " + a[i] + " : " + "<br>");
}

Response.Write(frm); 
```

我可以在 frm 字符串中添加什么来显示 VALUES ？

**更新：**

我使用的初始代码

```
 NameValueCollection authForm = Request.Form;
    foreach (string key in authForm.AllKeys)
    {
        frm += ("Key: " + key + ", Value: " + authForm[key] + "<br/>");
    } 
```

效果很好。我将尝试下面的新变化。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T20:31:28.270

```
NameValueCollection authForm = Request.Form;
StringBuilder sb = new StringBuilder();
foreach (string key in authForm.AllKeys)
{
    sb.AppendFormat(
        "Key: {0}, Value: {1}<br/>", 
        HttpUtility.HtmlEncode(key), 
        HttpUtility.HtmlEncode(authForm[key])
    );
}
Response.Write(sb.ToString()); 
```

# javascript - jquery/javascript 启用和禁用选择菜单。我究竟做错了什么？

> ID：10048905
> 
> 赞同：0
> 
> 时间：2012-04-06T20:30:42.980
> 
> 标签：javascript, jquery

这是非常标准的东西，我不明白为什么它不起作用。调用启用函数时，我收到警报，但选择字段仍处于禁用状态。有什么想法吗？

```
$(window.document).ready(function() {
    $('#selectmenu1').attr('disabled','true');
    $('#selectmenu2').attr('disabled','true');
    $('#selectmenu3').attr('disabled','true');
});

function enableCoreChange(){
    alert('called');
    $('#selectmenu1').attr('disabled','false');
    $('#selectmenu2').attr('disabled','false');
    $('#selectmenu3').attr('disabled','false');
} 
```

点击事件：

```
<a href="#" onclick="enableCoreChange();">Click here to enable</a> 
```

这让我疯狂！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T20:32:47.893

传递一个布尔值，而不是字符串，作为 的第二个参数`.attr()`。

```
$(function() { // use document ready shorthand
    // combine the selectors to stay DRY
    $('#selectmenu1, #selectmenu2, #selectmenu3').attr('disabled', true);
});

function enableCoreChange() {
    $('#selectmenu1, #selectmenu2, #selectmenu3').attr('disabled', false);
    // alternately:
    $('#selectmenu1, #selectmenu2, #selectmenu3').removeAttr('disabled');
} 
```

还要注意其他一般样式改进。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T20:47:18.167

[HTML：]

```
 <a href="#" id="enable">Click here to enable</a> 
```

[jQuery：]

```
function enableCoreChange(){
    $('#selectmenu1, #selectmenu2, #selectmenu3').prop('disabled', false); 
}

$(document).ready(function(){

    $('#selectmenu1, #selectmenu2, #selectmenu3').prop('disabled', true); 

    $('#enable').on('click',function(e){
        e.preventDefault();
        enableCoreChange();
    });    

}); 
```

***[演示 jsFiddle](http://jsfiddle.net/3WzFx/3/)***

[注意：]
而不是`$('#selectmenu1, #selectmenu2, #selectmenu3')`:*以* `^`选择器开头：

```
$('select[id^="selectmenu"]').prop('disabled', false); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T20:33:40.967

属性“禁用”不需要值（向后兼容性），只要该属性可用，它就会被禁用。

要再次激活它，请使用此功能：

```
function enableCoreChange(){
    alert('called');
    $('#selectmenu1').removeAttr('disabled');
    $('#selectmenu2').removeAttr('disabled');
    $('#selectmenu3').removeAttr('disabled');
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T20:35:04.600

你应该使用`.prop()`而不是`.attr()`

[http://api.jquery.com/prop/](http://api.jquery.com/prop/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T20:35:34.290

这里的问题是您指定的是 string`'false'`而不是 boolean `false`。`removeAttr`为了清楚起见，我个人会使用

```
function enableCoreChange(){
    alert('called');
    $('#selectmenu1').removeAttr('disabled');
    $('#selectmenu2').removeAttr('disabled');
    $('#selectmenu3').removeAttr('disabled');
} 
```

小提琴：http: [//jsfiddle.net/6pznn/](http://jsfiddle.net/6pznn/)

# javascript - 如何在 twitter-bootstrap 流体布局中创建多个可滚动部分

> ID：10048907
> 
> 赞同：4
> 
> 时间：2012-04-06T20:31:22.573
> 
> 标签：javascript, html, css, twitter-bootstrap

我正在为我的网站使用 Twitter 的 Bootstrap 流体布局。我有一个折叠/展开手风琴，在其中一个部分内，我有三列我想分别滚动。这些列当前扩展到其内容的完整高度，但我希望它们扩展到视口（可查看页面）并显示滚动条以到达其余部分（当它尚未全部可见时）。

如果我将列设置为：`overflow: auto;` `height: 500px;`

我不想设置高度；但是，我希望将其设置为适合视口的任何内容。

我知道您可以将 div 的高度设置为 100% 以扩展到视口；但是，它必须取决于包含元素的高度。我不确定如何在 Bootstrap 中处理这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T22:19:16.503

如果您在加载后调整大小，则appart`$('#collapseOne').on('shown', sizing());`无法正确调整大小。

这在桌面上工作得很好。

[http://jsfiddle.net/baptme/MwzvD/17/](http://jsfiddle.net/baptme/MwzvD/17/)

# javascript - 如何更改另一个窗口中的选项卡 Titanium

> ID：10048915
> 
> 赞同：0
> 
> 时间：2012-04-06T20:32:04.413
> 
> 标签：javascript, titanium, appcelerator

在我的应用程序中，我有一个登录屏幕，其中我有 2 个选项卡，登录后我打开另一个窗口，我想更改该窗口中的选项卡 {从前一个窗口中删除这 2 个并添加 4 个新选项卡}我该怎么做钛 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T00:40:40.577

KitchenSink Titanium 演示应用程序中有一个如何执行此操作的示例。如果您转到*Base UI > Tab Groups*，您将看到一个“*添加/删除选项卡*”按钮，它可以按照您的想法进行操作。您可以在此处找到该文件的代码：

[https://github.com/appcelerator/KitchenSink/blob/master/Resources/examples/tab_groups.js](https://github.com/appcelerator/KitchenSink/blob/master/Resources/examples/tab_groups.js)

用于在该文件中添加和删除选项卡的代码本身：

```
if (tabGroup.tabs.length == 5)
{
    var win = Ti.UI.createWindow({title:'New Tab Window',barColor:'#000'});
    var newtab = Titanium.UI.createTab({  
        icon:'../images/tabs/KS_nav_mashup.png',
        title:'New Tab',
        win:win
    });
    tabGroup.addTab(newtab);
}
else
{
    var newtab = tabGroup.tabs[5];
    tabGroup.removeTab(newtab);
} 
```

# python - 重复调用函数的函数？

> ID：10048916
> 
> 赞同：7
> 
> 时间：2012-04-06T20:32:06.223
> 
> 标签：python, iterator, iteration

考虑假设函数`repeatcall`，它接受一个无参数可调用`func`和一个正整数作为参数`n`，并返回一个列表，其成员是通过执行`func()` `n`时间获得的。它支持无限的愚蠢hijinks流，例如：

```
>>> repeatcall(lambda: id(dict()), 5)
[45789920, 45788064, 45807216, 45634816, 45798640]

>>> urandom = lambda: struct.unpack('Q', open('/dev/urandom').read(8))[0]
>>> repeatcall(urandom, 3)
[3199039843823449742, 14990726001693341311L, 11583468019313082272L]

>>> class Counter(itertools.count): __call__ = itertools.count.next
>>> repeatcall(Counter(100, -2), 4)
[100, 98, 96, 94] 
```

我可以发誓我`repeatcall`在 Python 2.x 标准库中的某个地方看到过类似的函数，但我找不到它。如果我没有想到这个，我**在标准库的**哪里可以找到它？

**PS：我知道自己动手是微不足道的，但我讨厌重新发明轮子，尤其是那些已经在标准库中的。我*不是*在问如何自己动手。**

编辑：*更明确地*说我不是在问如何编码`repeatcall`。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-06T20:42:49.597

您已经在标准库文档中看到了这一点，而不是标准库本身。

它`repeatfunc`来自[`itertools`食谱](http://docs.python.org/library/itertools.html#recipes)：

```
def repeatfunc(func, times=None, *args):
    """Repeat calls to func with specified arguments.

    Example:  repeatfunc(random.random)
    """
    if times is None:
        return starmap(func, repeat(args))
    return starmap(func, repeat(args, times)) 
```

它允许参数并且应该（理论上）比列表理解执行得更好，因为`func`只需要查找一次。`repeat`也比`range`您不实际使用计数器时更快。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-07T07:38:33.803

这不存在是有原因的：编写一个在每次调用时不接受参数并返回新内容的函数的惯用方法是将其编码为生成器。

然后，您可以使用列表推导式或生成器表达式任意多次调用它：`[next(gen) for i in xrange(5)]`. 更好的是，`gen`它本身可以是生成器表达式的结果，例如`(id(dict()) for i in (itertools.repeat(None)))`.

因此，**python 对此没有库支持，因为它在语法上支持它。**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-06T20:39:37.810

你的意思是这样的吗？：

```
>> from random import random
>> print [random() for x in range(5)]
[0.015015074309405185,
 0.7877023608913573,
 0.2940706206824023,
 0.7140457069245207,
 0.07868376815555878] 
```

看起来够简洁了吧？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-06T20:39:56.643

为此，您可以使用[apply内置函数](http://docs.python.org/library/functions.html#apply)

```
>>> def repeatcall(func,n):
    [apply(func) for i in range(0,n)]

>>> repeatcall(lambda: id(dict()), 5)
[56422096, 56422240, 56447024, 56447168, 56447312]

>>> import itertools
>>> class Counter(itertools.count): __call__ = itertools.count.next

>>> repeatcall(Counter(100, -2), 4)
[100, 98, 96, 94]
>>> 
```

注意**来自手册 apply() 的使用等同于 function(*args, **keywords)。

所以repeatcall也可以写成

```
>>> def repeatcall(func,n):
    [func() for i in range(0,n)] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-29T16:29:57.000

在这里阅读评论时，我意识到这`iter(foo, expr)`将创建一个无限迭代器的结果，`foo`只要它从不等于`expr`。

对于问题中的示例，`iter(lambda: id(dict()), None)`将创建 dicts 的无限迭代器。

虽然不是这个问题的直接答案，但我发现它很有用，因为在我的用例中我希望它成为有限`zip`表达式的一部分，并且只需要迭代器来继续生成元素。

希望这可以帮助其他偶然发现这个问题的人

# php - MySQL 更新语句无法正常工作

> ID：10048917
> 
> 赞同：1
> 
> 时间：2012-04-06T20:32:16.107
> 
> 标签：php, mysql, sql-update

我正在使用表单更新我的数据库。我让它输出所有内容的值以检查以确保所有内容都正常工作，但是当它将它添加到数据库时，一切都是错误的。如果数量是 20000，它只是将库存中的数量更改为 1。我不明白。我还在学习 MySQL，但这很烦人

```
<?php
if($_SERVER['REQUEST_METHOD'] == 'POST')
{
    require("serverInfo.php");
    for($i = 0; $i < 10; $i++){
        $quantity = $_POST['quantity'.$i];
        $company = $_POST['company'.$i];
        $size = $_POST['cardSize'.$i];

        if(isset($_POST['box'.$i])){
            echo $quantity . "<br / >";
            echo $size . "<br / >";
            echo $company . "<br / >";
            mysql_query("UPDATE `printRun` SET Quantity = '$quantity' AND Size = '$size'  where status='Open' AND Company = '$company'");
        }
    }
    mysql_close($link);
}
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T20:35:58.987

我将为您省去关于回显和更新数据库未过滤表单数据的常规讲座....但是您的`update`语法不正确。试试这个（`AND`列列表中没有）

> UPDATE `printRun`SET 数量='$quantity', size = '$size' where status='Open' AND Company = '$company'

[http://dev.mysql.com/doc/refman/4.1/en/update.html](http://dev.mysql.com/doc/refman/4.1/en/update.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T20:36:00.623

尝试

```
mysql_query("UPDATE `printRun` SET Quantity = '$quantity', Size = '$size'  where status='Open' AND Company = '$company'"); 
```

# hbase - 对 HBase 中的现有表进行 Hive 查询

> ID：10048922
> 
> 赞同：1
> 
> 时间：2012-04-06T20:32:40.687
> 
> 标签：hbase, hive

我已经使用 CREATE EXTERNAL TABLE 命令为 HBase 中的现有表在 HIVE 中创建了表。

我可以通过 HIVE 外壳看到表格

但在通过 HIVE 查询表时，返回“0”记录。通过日志确定 HIVE 正在 HADOOP 而不是 HBase 中执行 MAP-REDUCE 程序

我在配置 Hive 和 HBase 时错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T02:20:38.690

我猜你正在使用 0.9 之前的 Hive 版本。

在 Hive 0.8 及之前的版本中使用 HBase 存储处理程序创建 Hive 表将只允许您访问通过相应 Hive 表插入的 HBase 表中的数据。如果您的 HBase 表中有任何未通过 Hive 表插入的预先存在的数据，您也将无法通过 Hive 表查询它。

从 Hive 0.9 开始，[JIRA 1634](https://issues.apache.org/jira/browse/HIVE-1634)将可用，它允许 Hive 表访问 HBase 表中存在的所有数据，而不管它是如何插入其中的。

我建议您要么获取此补丁，要么升级到 Hive 0.9

# c# - 正确使用 C# 事件处理程序

> ID：10048923
> 
> 赞同：3
> 
> 时间：2012-04-06T20:32:45.590
> 
> 标签：c#, events, event-handling, thread-safety, state-machine

我目前正在构建一个 C# 应用程序，当用户连接到特定的无线网络时，它将自动针对某些网络资源对用户进行身份验证。

目前，我正在使用[托管 Wifi API](http://managedwifi.codeplex.com/)来发现用户何时连接/断开无线网络。我有一个事件处理程序，因此当发生任何这些活动时，会调用我的一个方法来检查无线连接的当前状态。

为了管理应用程序的状态，我有另一个称为“导体”的类，它执行更改应用程序状态所需的操作。例如，当无线网卡连接到正确的网络时，指挥需要将系统状态从“监控”更改为“验证”。如果身份验证成功，指挥者需要将状态更改为“已连接”。断开连接会再次导致“监控”状态，而身份验证错误会导致“错误”状态。这些状态更改（如果用户请求）可能会导致 TrayIcon 通知，因此用户知道他们正在通过身份验证。

我目前的想法涉及让用于检查无线当前状态的方法调用状态管理器中的“身份验证”或“断开连接”方法。但是，我不确定这是否是事件处理程序的适当使用——它是否应该设置一个标志或通过某种形式的 IPC 将消息发送到一个单独的线程，该线程将开始身份验证/断开连接过程？

除了能够请求连接/断开连接的事件处理程序之外，用户还可以通过托盘图标执行它。因此，我需要确保这些后台操作不会阻止托盘与用户的交互。

只有一个组件应该能够随时请求更改系统状态，所以我需要使用互斥锁来防止并发状态更改。然而，我应该如何同步这些组件的其余部分对我来说有点神秘。

我应该阅读的任何建议或文献都会受到欢迎。我没有接受过 C# 语言的正式培训，因此如果我有任何错误陈述，我深表歉意。

编辑：最重要的是，我想验证一个事件将作为一个单独的线程执行，因此它不能阻塞主 UI。另外，我想验证如果我有一个事件处理程序订阅了一个事件，它会串行处理事件，而不是并行处理（所以如果用户在处理第一个连接事件之前连接和断开连接，则不会发生两次状态更改同时发生）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:42:11.060

作为一种选择，替代...

如果我是你，而且你还是要重新开始，我会认真考虑
[Rx Reactive Extensions](http://msdn.microsoft.com/en-us/data/gg577609)

它对事件和基于事件的编程提供了全新的视角，并且对您正在处理的事情有很大帮助（包括同步、处理线程、组合事件、停止、启动等）。

一开始学习可能有点“陡峭的曲线”，但同样，这可能是值得的。

希望这可以帮助，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T21:12:30.017

> 我应该阅读的任何建议或文献都会受到欢迎。我没有接受过 C# 语言的正式培训，因此如果我有任何错误陈述，我深表歉意。

这解释了一些事情。:)
我会阅读线程、事件处理和系统托盘图标/界面的创建。

重要的是要注意以下几点：

*   事件在调用它们的同一线程上处理。如果您希望事件处理不锁定 GUI，那么您需要让按钮将工作移动到不同的线程。
*   当一个事件被触发时，它会将适当的参数传递给其列表中的所有方法。这与调用一个方法然后调用所有其他方法几乎相同（参见 EventFired 示例）。事件的目的不是调用我们已经可以做到的方法，而是调用编译代码时可能不知道的方法（当控件所在的库时，按钮控件上的单击事件将不知道）例如编译）。简而言之，如果您可以调用该方法而不是使用事件，则可以这样做。

    ```
    void EventFired(int arg1, object arg2)
    {
        subscribedMethod1(arg1, arg2);
        SubscribedMethod2(arg1, arg2);
        SubscribedMethod3(arg1, arg2);
        SubscribedMethod4(arg1, arg2);
        SubscribedMethod5(arg1, arg2);
        SubscribedMethod6(arg1, arg2);
        SubscribedMethod7(arg1, arg2);
    } 
    ```

*   如果您想阻止用户界面锁定，请在另一个线程上进行工作。但请记住，用户界面元素（表单、按钮、网格、标签等）只能从它们的主机线程访问。使用 control.Invoke 方法调用其线程上的方法。

*   从界面中删除一个选项并不是防止赛道状况的好方法（用户在一个已经运行的情况下开始连接/断开连接），因为用户界面将在不同的线程上并且可能不同步（这需要时间单独的线程同步）。虽然有很多方法可以解决这个问题，但对于线程新手来说，最简单的方法是对值使用锁定。这样，.NET 将确保一次只有一个线程可以更改设置。您仍然需要更新用户界面，以便用户知道正在发生更新。

您的总体设计听起来不错。您可以使用 2-3 个线程（1 个用于用户界面（托盘图标），1 个用于检查新的网络连接，1 个（可以与连接检查合并）用于检查 Internet 连接。

希望这会有所帮助，如果您需要更多信息（或接受答案），请告诉我们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T20:45:05.193

*对我*来说，您似乎将过度设计该项目。您基本上需要`Commander`在主应用程序中实现一个事件并订阅它们。那是。

如果总是有一个组件可以进行更改并且您可以拥有多个组件，那么使用某种同步机制（如`Mutex`您所指出的）是完全有效的选择。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T20:45:32.537

如果您希望在任何时候最多有一个状态更改挂起，最好让您正在侦听的外部事件的事件处理程序在执行期间保持锁定。这确保了一种简单的编程方式，因为您可以保证您的应用程序的状态不会在您下面改变。在这种特殊情况下，不需要单独的线程。

您需要区分应用程序的当前状态和目标状态。用户指示目标状态（“已连接”、“已断开”）。实际状态可能不同。示例：用户想要断开连接，但实际状态是正在验证。身份验证步骤完成后，状态机必须检查目标状态：

```
targetState == connected => set current state to connected
targetState == disconnected => begin to disconnect and set state to disconnecting 
```

分离实际状态和目标状态允许用户随时改变主意，并且状态机可以引导至所需状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T20:46:35.080

如果不查看应用程序的整个（建议的）结构，很难给出准确的答案。但总的来说，是的，对这类事情使用事件处理程序是可以的——尽管我可能会将实际实现移到单独的方法中，以便您可以更轻松地从其他位置触发它。

关于禁用“连接”按钮的评论对我来说听起来很正确，尽管可以想象你可能还需要其他形式的同步。但是，如果您的应用程序不需要多线程，我会避免仅仅为了它而引入多线程。如果您这样做，请查看已包含在[Task Parallel Library](http://msdn.microsoft.com/en-us/library/dd537609.aspx)中的新 Task API 。他们很好地抽象了很多东西。

关于不要过度思考这个问题的评论也很受欢迎。如果我站在你的立场上，只是从一门新语言开始，我会避免一开始就试图让架构恰到好处。深入研究并使用您已有的认知工具集进行开发。当你探索更多时，你会发现，“哦，废话，这是一个更好的方法。” 然后去那样做。重构是你的朋友。

# drag-and-drop - 如何使用拖放取消放置命令

> ID：10048934
> 
> 赞同：0
> 
> 时间：2012-04-06T20:33:45.700
> 
> 标签：drag-and-drop, silverlight-toolkit, silverlight-5.0

您如何使用最新的 Silverlight Toolkit 拖放框架取消放置事件？我认为这一定很愚蠢，但我似乎无法找到任何有效信息来让我到达正确的地方。

任何指导都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-20T13:00:21.887

在拖动操作中，您可以设置：

```
e.Handled = True
e.cancel = True 
```

您也可以在拖动时设置这些。但是你也可以在 drop 操作中做类似的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T10:11:31.980

1.  `AllowDrop="False"`
2.  在 drop 处理程序中什么也不做

# java - 如何在 Android 中使用 HTTP GET？

> ID：10048940
> 
> 赞同：0
> 
> 时间：2012-04-06T20:34:16.443
> 
> 标签：java, android, http, http-get

> **可能重复：**
> [如何在 android 中执行 Http GET？](https://stackoverflow.com/questions/1162260/how-do-perform-http-get-in-android)

我想在我的 Android 应用程序中使用 Google Products/Shopping API，但我对 HTTP GET 一无所知。我正在阅读[这篇](https://developers.google.com/shopping-search/v1/getting_started#products-feed)文章，它为我提供了所有这些不同的网址供我使用。那么如何通过 HTTP GET 在 Android 中使用 Google Products/Shopping API？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:37:22.680

[首先熟悉HTTP](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol)，然后熟悉[URLConnection](http://docs.oracle.com/javase/6/docs/api/java/net/URLConnection.html)和[Apache HttpClient](http://hc.apache.org/httpcomponents-client-ga/index.html)很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:39:17.707

这是我从服务器获取 JSON 的一些示例代码。它包括通过 HTTP 连接到某些东西的基本代码行。

```
public JSONArray getQuestionsJSONFromUrl(String url, List<NameValuePair> params) {  
    // Making HTTP request
try {
        // defaultHttpClient
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);
        httpPost.setEntity(new UrlEncodedFormEntity(params));

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        is = httpEntity.getContent();

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);
        String jsonData = reader.readLine();
        JSONArray jarr = new JSONArray(jsonData);
        is.close();
        return jarr;
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }
    return null;
} 
```

# php - 什么神奇的东西会扼杀我的 Drupal 会话和 15-45 分钟的活动？

> ID：10048942
> 
> 赞同：1
> 
> 时间：2012-04-06T20:34:26.853
> 
> 标签：php, drupal, drupal-7

我正在使用托管在 LAMP 堆栈上的标准 Drupal 安装。我的 settings.php 有以下设置：

```
ini_set('session.gc_probability', 1);
ini_set('session.gc_divisor', 100);

ini_set('session.gc_maxlifetime', 200000);

ini_set('session.cookie_lifetime', 2000000); 
```

我的 php.ini 文件有：

```
session.gc_probability = 1

session.gc_divisor = 1000

session.gc_maxlifetime = 1440 
```

我还检查了安全模式是否已关闭，以便我的 settings.php 文件能够覆盖主要的 php.ini 变量。此外，由于该人可以在 15 分钟后注销，这让我想知道 php.ini 是否与它有任何关系。我已经梳理了我的代码，它似乎在我的本地主机上运行良好，但是在服务器上却有问题。我还能在哪里检查？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T05:25:15.177

缩小你的问题。cookie过期时间设置错了吗？还是它仍在发送但不再与有效会话匹配？我猜这是drupal中的一个问题。

# ravendb - 使用 RavenDB 检索超过 128 个文档的正确方法

> ID：10048943
> 
> 赞同：27
> 
> 时间：2012-04-06T20:34:28.580
> 
> 标签：ravendb

我知道这个问题的变体已经被问过（甚至是我），但我仍然不明白关于这个的一两件事......

据我了解，这样做可以检索比 128 默认设置更多的文档：

```
session.Advanced.MaxNumberOfRequestsPerSession = int.MaxValue; 
```

而且我了解到 WHERE 子句应该是 ExpressionTree 而不是 Func，因此它被视为 Queryable 而不是 Enumerable。所以我认为这应该有效：

```
public static List<T> GetObjectList<T>(Expression<Func<T, bool>> whereClause)
{
    using (IDocumentSession session = GetRavenSession())
    {
        return session.Query<T>().Where(whereClause).ToList();                
    }
} 
```

但是，这只返回 128 个文档。为什么？

注意，这里是调用上述方法的代码：

```
RavenDataAccessComponent.GetObjectList<Ccm>(x => x.TimeStamp > lastReadTime); 
```

如果我添加 Take(n)，那么我可以得到尽可能多的文档。例如，这将返回 200 个文档：

```
return session.Query<T>().Where(whereClause).Take(200).ToList(); 
```

基于所有这些，似乎检索数千个文档的适当方法是设置 MaxNumberOfRequestsPerSession 并在查询中使用 Take()。是对的吗？如果没有，**应该**怎么做？

对于我的应用程序，我需要检索数千个文档（其中的数据非常少）。我们将这些文档保存在内存中并用作图表的数据源。

** 编辑 **

我尝试在我的 Take() 中使用 int.MaxValue：

```
return session.Query<T>().Where(whereClause).Take(int.MaxValue).ToList(); 
```

然后返回 1024。啊。我如何获得超过 1024？

** 编辑 2 - 显示数据的示例文档 **

```
{
  "Header_ID": 3525880,
  "Sub_ID": "120403261139",
  "TimeStamp": "2012-04-05T15:14:13.9870000",
  "Equipment_ID": "PBG11A-CCM",
  "AverageAbsorber1": "284.451",
  "AverageAbsorber2": "108.442",
  "AverageAbsorber3": "886.523",
  "AverageAbsorber4": "176.773"
} 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-11-27T09:10:30.123

值得注意的是，从 2.5 版本开始，RavenDB 有一个“无限结果 API”来允许流式传输。文档中的示例显示了如何使用它：

```
var query = session.Query<User>("Users/ByActive").Where(x => x.Active);
using (var enumerator = session.Advanced.Stream(query))
{
    while (enumerator.MoveNext())
    {
        User activeUser = enumerator.Current.Document;
    }
} 
```

支持标准 RavenDB 查询、Lucence 查询，还支持异步。

文档可以在[这里](http://ravendb.net/docs/2.5/client-api/advanced/unbounded-results?version=2.5)找到。可以在[此处](http://ayende.com/blog/161249/ravendbs-querying-streaming-unbounded-results)找到 Ayende 的介绍性博客文章。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-04-06T21:02:43.690

默认情况下，该`Take(n)`功能最多只能为您提供 1024。但是，您可以在以下位置更改此默认值`Raven.Server.exe.config`：

```
<add key="Raven/MaxPageSize" value="5000"/> 
```

有关详细信息，请参阅：[http ://ravendb.net/docs/intro/safe-by-default](http://ravendb.net/docs/intro/safe-by-default)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-07-16T20:58:14.273

默认情况下，Take(n) 函数最多只能为您提供 1024。但是，您可以将它与 Skip(n) 配对使用以获取所有

```
 var points = new List<T>();
        var nextGroupOfPoints = new List<T>();
        const int ElementTakeCount = 1024;
        int i = 0;
        int skipResults = 0;

        do
        {
            nextGroupOfPoints = session.Query<T>().Statistics(out stats).Where(whereClause).Skip(i * ElementTakeCount + skipResults).Take(ElementTakeCount).ToList();
            i++;
            skipResults += stats.SkippedResults;

            points = points.Concat(nextGroupOfPoints).ToList();
        }
        while (nextGroupOfPoints.Count == ElementTakeCount);

        return points; 
```

[RavenDB 分页](http://ravendb.net/docs/client-api/querying/paging)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-04-07T00:55:09.800

每个会话的请求数是一个单独的概念，然后是每次调用检索的文档数。会话是短暂的，预计很少有呼叫通过它们发出。

如果您从商店中获得超过 10 个任何东西（甚至少于默认 128 个）供人类消费，那么就出现了问题，或者您的问题需要不同的想法，然后从数据存储中加载卡车装载的文档。

RavenDB 索引非常复杂。关于索引的好文章在[这里](http://ayende.com/blog/89089/ravendb-multi-maps-reduce-indexes)和方面[在这里](http://ravendb.net/docs/client-api/faceted-search)。

如果您需要执行数据聚合，请创建生成聚合数据的 map/reduce 索引，例如：

指数：

```
 from post in docs.Posts
    select new { post.Author, Count = 1 }

    from result in results
    group result by result.Author into g
    select new
    {
       Author = g.Key,
       Count = g.Sum(x=>x.Count)
    } 
```

询问：

```
session.Query<AuthorPostStats>("Posts/ByUser/Count")(x=>x.Author)(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-09T18:40:03.380

您还可以在该方法中使用预定义的索引`Stream`。您可以在索引字段上使用 Where 子句。

```
var query = session.Query<User, MyUserIndex>();
var query = session.Query<User, MyUserIndex>().Where(x => !x.IsDeleted);

using (var enumerator = session.Advanced.Stream<User>(query))
{
    while (enumerator.MoveNext())
    {
        var user = enumerator.Current.Document;
        // do something
    }
} 
```

示例索引：

```
public class MyUserIndex: AbstractIndexCreationTask<User>
{
    public MyUserIndex()
    {
        this.Map = users =>
            from u in users
            select new
            {
                u.IsDeleted,
                u.Username,
            };
    }
} 
```

文档：[什么是索引？](http://ravendb.net/docs/article-page/3.0/Csharp/indexes/what-are-indexes) [会话：查询：如何流式传输查询结果？](http://ravendb.net/docs/article-page/3.0/Csharp/client-api/session/querying/how-to-stream-query-results)

* * *

重要提示：该`Stream`方法不会跟踪对象。如果改变从这个方法获得的对象，`SaveChanges()`将不会察觉到任何改变。

* * *

其他注意事项：如果不指定要使用的索引，可能会出现以下异常。

> InvalidOperationException：StreamQuery 不支持查询动态索引。它被设计用于大型数据集，并且不太可能在 15 秒的索引后返回所有数据集，就像 Query() 一样。

# php - MYSQL查询对不同表中的多个列求和

> ID：10048946
> 
> 赞同：0
> 
> 时间：2012-04-06T20:34:35.693
> 
> 标签：php, mysql, join, where-clause

我有两个具有一对多关系的表（orders、order_lines）。orders 表将有一行，而 order_lines 表将有一行用于附加到订单的每个产品。

订单

```
 +----------+-------------+---------------+
   |order_num | total_order | shipping_total|
   +----------+-------------+---------------+
   | 12345    | 75.00       | 15.00         |
   +----------+-------------+---------------+ 
```

ORDER_LINES

```
 +----------+-------------+-------+
   | order_num| volume      | price |
   +----------+-------------+-------+
   | 12345    |10           |25.00  |
   +----------+-------------+-------+
   | 12345    |20           |25.00  |
   +----------+-------------+-------+
   | 12345    |20           |25.00  |
   +----------+-------------+-------+ 
```

我想总结 ORDERS 表中的 total_order 和 shipping_total 列以及 ORDER_LINES 表中的量和价格列。

查询当前不起作用：

```
SELECT b_orders.bill_country, b_orders.ship_country
    , SUM(volume) AS v, SUM(price) AS pt
    , SUM(shipping_total) AS st, SUM(total_order) AS tot_o 
FROM b_orders 
JOIN b_order_lines 
    ON b_orders.order_num = b_order_lines.order_num 
WHERE DATE(b_orders.order_date) BETWEEN '2012-04-02' AND '2012-04-06' 
    AND ship_country = 'USA' 
    AND b_order_lines.price > 0; 
```

此查询返回错误的值。我有点知道为什么，但不知道如何编写正确的查询...请帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:40:04.927

当您使用聚合函数 line`SUM`时，您需要告诉 SQL Server 哪些列将用于`GROUP BY`进行求和。

因此，如果您将以下内容添加到查询的底部：

```
GROUP BY
  b_orders.bill_country, b_orders.ship_country 
```

这将告诉它为您提供`bill_country, ship_country`数据中每个唯一组合的总和。这是你想要的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:44:58.220

如果 bill_country 和 ship_country 将包含在也具有 SUM 等聚合函数的查询中，则需要对它们进行分组。我怀疑你只需要在最后添加这一行：

```
GROUP BY  b_orders.bill_country, b_orders.ship_country; 
```

如果您不需要查看它们，可以将它们从 SELECT 语句中删除并省略分组；您不必选择列以将它们包含在 WHERE 子句中。

# android - Android 在另一个完成后立即调用 AsyncTask

> ID：10048958
> 
> 赞同：30
> 
> 时间：2012-04-06T20:35:40.300
> 
> 标签：android, android-asynctask

我对 Android AsyncTask 有一些问题。有一个 Activity 包含一些 TextView 一个按钮和一张图片。当用户进入此活动时，我启动一个异步任务以检查用户是否可以从活动中前进（直到任务未完成按钮未激活）。然后我想启动另一个异步任务来获取图片。所以我做了一个内部类：

```
AsyncTask<String, Void, JSONObject>() authTask = new AsyncTask<String, Void, JSONObject>() {
     @Override
     protected JSONObject doInBackground(String... params) {
         //call the rest api
     }
     @Override
     protected void onPostExecute(JSONObject result) {
         // check the result
         // and make another asynctask
         AsyncTask<String, Void, Bitmap> imageTask = new Async.... {
             // get image
         }
         imageTask.execute();
     }
} 
```

我 `authTask.execute();` 从 UI 线程调用。

我对此有一种不好的感觉，尤其是它似乎不起作用（几次都没问题，但突然它“冻结”：没有例外，只是挂起并且进度条在旋转。没有任何反应，按钮也不会激活。）还有另一种获取信息的方法，当它完成后立即开始另一个任务？

UDPATE：我使用 api 级别 10。在 authTask 中，我得到了一些启动 imageTask 所需的信息（一些 id），所以我必须连续调用这些任务。在 api 级别 10 有可能吗？

提前致谢！

兄弟，彼得

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-06T20:48:57.243

您可以使用`getStatus()`检查是否处于`AsyncTask`挂起、正在运行或已完成。以及何时开始您的新任务。如：

```
if(authTask .getStatus() == AsyncTask.Status.PENDING){
    // My AsyncTask has not started yet
}

if(authTask .getStatus() == AsyncTask.Status.RUNNING){
    // My AsyncTask is currently doing work in doInBackground()
}

if(authTask .getStatus() == AsyncTask.Status.FINISHED){
    // START NEW TASK HERE
} 
```

您的应用的示例：

```
btn.setOnClickListener(new View.OnClickListener()
  {
    public void onClick(View v)
      {
        if (authTask != null && authTask.getStatus() == AsyncTask.Status.FINISHED) {
           //START YOUR NEW TASK HERE
        }
        else
        {
          //IGNORE BUTTON CLICK
        }
      }
   }); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-04-06T21:05:32.480

**1：**

您可以在一个`doInBackground()`. 此单个 AsyncTask 实例将由单个`execute()`语句触发。根据所需的 UI 交互，这可能实用也可能不实用。

* * *

**2：**

编辑：正如 kabuku 所指出的，此信息主要用于 HoneyComb+。Pre HoneyComb 我肯定会选择上面的选项**1**。**[executeOnExecutor()](http://developer.android.com/reference/android/os/AsyncTask.html#executeOnExecutor%28java.util.concurrent.Executor,%20Params...%29)**是 api 级别 11+

在最近的版本`execute()`中，默认情况下将发送您的 AsyncTasks (ICS+)。如果要确保发生这种情况，请指定串行执行程序。

在您的情况下，这将是：

```
authTask.executeOnExecutor(AsyncTask.SERIAL_EXECUTOR);
// Image task will only be done AFTER textViewTask is done
imageTask.executeOnExecutor(AsyncTask.SERIAL_EXECUTOR); 
```

对于较新的版本，一个简单的

```
...
// ICS+ and pre honeycomb (I think)
authTask.execute();
// Image task will only be done AFTER textViewTask is done
imageTask.execute();
... 
```

从[**AsycnTask.execute() 文档中：**](http://developer.android.com/reference/android/os/AsyncTask.html#execute%28Params...%29)

> 注意：此函数根据平台版本将任务安排在单个后台线程或线程池的队列中。首次引入时，AsyncTask 在单个后台线程上串行执行。从 DONUT 开始，这被更改为允许多个任务并行运行的线程池。在 HONEYCOMB 之后，计划将其改回单线程，以避免并行执行导致的常见应用程序错误。

* * *

PS：要运行彼此独立的任务，您必须使用`AsyncTask.THREAD_POOL_EXECUTOR`. 这需要一个不同的执行者：

```
// Go parallel! (NOT what you want)
task.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-06T20:41:42.873

嵌套 AsyncTask 并不是一个好的设计。**在doInBackground**中完成所有繁重的工作并简单地发布/更新结果。换句话说，将第二个 AsyncTask 的处理合并到你的第一个中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T20:42:56.580

从您展示的代码来看，生成第二个任务似乎没有意义。只需`doInBackground`在授权后立即让您在第一个任务中获得图像。如果您需要在两者之间更新 UI，您可以在进行中更新。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-10-06T12:55:45.213

```
int count;

 private void attemptConnect() 
 {
   count = 0;
   str_lang = "English";
   str_wait = "Plaese Wait";

   new AllQuestion().execute();

}

private class AllQuestion extends AsyncTask<String, String, String> {
    ProgressDialog pg;

    @Override
    protected void onPreExecute() {
        super.onPreExecute();

        pg = new ProgressDialog(LanguageActivity.this);
        pg.setProgressStyle(ProgressDialog.STYLE_SPINNER);
        pg.setMessage(str_wait);
        pg.setCancelable(false);
        pg.show();
    }

    @Override
    protected String doInBackground(String... strings) {
        try {
            SoapObject soapObject = new SoapObject(AppConstant.NAMESPACE, AppConstant.QUESTION_SOAP_METHOD); 
            soapObject.addProperty("language", str_lang);

            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
            envelope.dotNet = true;
            envelope.setOutputSoapObject(soapObject);

            HttpTransportSE se = new HttpTransportSE(AppConstant.webUrl);
            se.call(AppConstant.QUESTION_SOAP_ACTION, envelope);

            Object responce = envelope.getResponse();
            Log.d("Question List:=>>", "" + responce);

            return responce.toString();
        } catch (Exception e) {
            e.printStackTrace();
            pg.dismiss();
            return null;
        }
    }

    @Override
    protected void onPostExecute(String s) {
        super.onPostExecute(s);

        if (pg.isShowing()) {
            pg.dismiss();
            Log.i(TAG, s);

            if (s != null || !s.equalsIgnoreCase("")) {
                try {
                    JSONArray array = new JSONArray(s);

                    for (int i = 0; i < array.length(); i++) {
                        JSONObject obj = array.getJSONObject(i);

                        String queId = obj.getString(TAG_QID);
                        String que = obj.getString(TAG_QUE);
                        String str_Opt = obj.getString(TAG_OPT);

                        question = new Question(queId, que, str_lang, str_catId, str_Opt, manager.getDateTime());
                        helper.insertQuestion(question);
                    }
                    count++;
                    if (count < 5) {
                        if (count == 1) {
                            str_lang = "German";
                            str_wait = "bitte warte einen Moment";

                                new AllQuestion().execute();
                        }
                        if (count == 2) {
                            str_lang = "Italian";
                            str_wait = "per favore aspetta un momento";

                                new AllQuestion().execute();
                        }
                        if (count == 3) {
                            str_lang = "Chinese";
                            str_wait = "请稍候";

                                new AllQuestion().execute();
                        }
                        if (count == 4) {
                            str_lang = "French";
                            str_wait = "patientez s'il-vous-plait";

                                new AllQuestion().execute();

                    }
                    Log.d("All Question:-", question.toString());

                } catch (JSONException e) {
                    e.printStackTrace();
                }
            }
        }
    }

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-27T04:59:49.927

我有一个想法**在一个异步任务**中制作异步系列：

```
protected Boolean doInBackground(String... params) {
            if(params[0] == "taskA") {
              //do somthing
              params[0] = "taskB";
            }
            if(params[0] == "taskB") {
              //do somthing
              params[0] = "taskC";
            }
            if(params[0] == "taskC") {
              //do somthing
              params[0] = "taskD";
            }
            if(params[0] == "taskD") {
              //do somthing
              return true;
            } 
```

在你的主线程中，只需像这样调用异步任务：

```
ShowMyProgress(); //if you like
new MyAsyncTask().execute("taskA"); 
```

最后，您可以在 onPostExecute 上隐藏您的进度，例如：

```
protected void onPostExecute(final Boolean success) {
        if (success) {
            ....

            HideMyProgress();
        }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-08T13:12:30.193

当我必须在用户登录到应用程序之前从数据库下载某些东西时，我已经解决了这种问题，我解决了这个问题。

要使用`ObservableInteger`你可以这样做

首先声明它

```
private ObservableInteger mObsInt; 
```

然后在你的 onCreate 你将有一个监听器等待 mObsInt 的值改变，在这些值改变之后你可以做任何你想做的事情

```
//Listener
        mObsInt = new ObservableInteger();
        mObsInt.set(0);

        mObsInt.setOnIntegerChangeListener(new OnIntegerChangeListener()
        {
            @Override
            public void onIntegerChanged(int newValue)
            {
                if (mObsInt.get()==1)
                   //Do something if the first asyncTask finishes
                if (mObsInt.get()==2){
                   //Do something if the second asyncTask finishes, in this case i just go to another activity when both asyncTasks finish
                    Intent mainIntent = new Intent().setClass(LoginActivity.this, Principal.class);
                    startActivity(mainIntent);
                    finish();
                }
            }
        }); 
```

那么，它是如何工作的

`ObservableInteger`将寻找变量的变化`mObsInt`，所以让我们说如果`mObsInt`等于 1 它会做某事，如果等于 2 会做另一件事，所以，用 2 解决这个问题`asynctasks`很容易，当其中一个`asynctasks`完成`mObsInt`时等于 1 ，如果其他`asyncTask`完成，那么`mObsInt`将是`mObsInt++`，然后您将等于 2，侦听器将等待值，然后当值与方法`mObsInt`中的 if 语句匹配时执行您想要执行的操作`onCreate`

现在，只需在您的 asynctasks 中放入您的 onPostExecute() 方法这一行

```
mObsInt.set(mObsInt.get()+1); 
```

所以如果第一个异步完成，mObsint == 1，如果第二个完成 mObsInt == 2，然后你在 onCreate 方法中处理你想要做的事情

希望这对你有帮助，它帮助了我

您可以在此文档中获得更多信息：[https ://developer.android.com/reference/android/databinding/ObservableInt.html](https://developer.android.com/reference/android/databinding/ObservableInt.html)

快乐编码！

# css - 延迟加载谷歌字体类型

> ID：10048964
> 
> 赞同：1
> 
> 时间：2012-04-06T20:36:18.733
> 
> 标签：css, fonts

至于[CSS 字体粗细选项](https://stackoverflow.com/questions/10044574/css-font-weight-options)，我正在尝试 ubuntu 字体。

链接到 href=' [http://fonts.googleapis.com/css?family=Ubuntu:500,300,700,400italic,400](http://fonts.googleapis.com/css?family=Ubuntu:500,300,700,400italic,400) '

所有正文字体权重均为 400（正常），但标题为 h2，字体权重 = 300 所有内容加载速度很快，但标题有一点延迟，我不喜欢。我不确定它是如何工作的，我猜 ubuntu-400 在 FF 字体列表中，但它必须从谷歌服务器获取 ubuntu-300。

如果这是真的与否，下载 ttf 源并从我自己的服务器加载它们是否正确和有用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-19T16:13:10.277

如果是 FF 问题，在修复之前您无能为力。一个好的解决方法是使用 JS 预加载器。这样，只有在完全加载时，您的页面才会显得美观而紧凑。[PreLoadMe](http://niklausgerber.com/blog/preloadme-a-lightweight-jquery-website-preloader/)不显眼，可以胜任。

# mobile - Twitter Bootstrap2 100% 高度响应

> ID：10048967
> 
> 赞同：22
> 
> 时间：2012-04-06T20:36:23.763
> 
> 标签：mobile, desktop, twitter-bootstrap, responsive-design

我想用 twitter 的 bootstrap v2 制作一个响应式布局，带有一个列和一个地图。

这个想法是从 maps.google.com 构建一个类似的 UI，但使用带有 bootstrap2 的响应式设计。

我想有一种桌面风格

*   顶部的导航栏
*   1 个左栏（作为侧边栏）
    *   高度：100% 减去 navbarHeight，带有滚动条
    *   宽度：.span3
*   填满屏幕其余部分的内容

然后对于响应式移动设计，我希望具有全高的部分具有取决于内容的高度。

我做了一个草图来更好地解释 ![草图](../Images/a3cbf81439f0827de8f9505413b6ba0b.png)

**编辑：**希望做这样的事情[，](http://layout.jquery-dev.net/demos/example.html)但反应灵敏，而且只有北（导航栏）、西（侧边栏）和中心（内容）

**EDIT2：**我终于用 jquery 做到了，但我想要一个 CSS 解决方案。如果有人问，我会把解决方案作为答案。

**EDIT3：**好的，这是我使用 JQuery 找到的解决方案（我认为使用纯 js 很容易做到）

```
$(window).bind('resize', function() {
    if ( $(window).width() > 980 ) {
        $("#content").height(($(window).height()-40)+"px")
        $("#sidebar").height(($(window).height()-58)+"px")
        $("body").css("padding-top","40px")
    }
    else {
        $("#content").height(($(window).height()-50)+"px")
        $("#sidebar").height(($(window).height()-68)+"px")
        $("body").css("padding-top","0px")            
    }

    $("#sidebar").css("overflow", "auto")
    $("body").css("padding-bottom","0px")
    $(".navbar").css("margin-bottom","0px")
}); 
```

`$(selector).css()`函数和条件`if`可以替换为纯 CSS 和来自 CSS3 的媒体查询[http://twitter.github.com/bootstrap/scaffolding.html#responsive](http://twitter.github.com/bootstrap/scaffolding.html#responsive)

但问题是`$(window).height()`计算运行时间。也许应该用`height:100%`CSS 中的 a 之类的东西来代替它，这样可以解决问题，但我找不到合适的位置来放置那个`100%`高度。

**EDIT4：**在这里我发现它可能是一个纯 CSS 的解决方案！如果我取得进展，我会发布答案！ [http://blog.stevensanderson.com/2011/10/05/full-height-app-layouts-a-css-trick-to-make-it-easier/](http://blog.stevensanderson.com/2011/10/05/full-height-app-layouts-a-css-trick-to-make-it-easier/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T22:42:12.463

从我本周的调查来看（我正在尝试完成同样的事情），从纯 CSS 的角度来看，bootstrap 和 100% 高度的设计似乎是不兼容的（除非你想对 bootstrap 进行更改）。我有兴趣查看您的 jquery 解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:48:45.327

我不确定我是否完全理解您要查找的内容，但请查看具有顶部菜单的[http://reactivewebdesign.net/Chicago/Traffic （添加引导导航栏应该很容易）。](http://reactivewebdesign.net/Chicago/Traffic)

左列跨越 3 列，地图占据 9 列。左侧菜单中还有一个名为“[我在哪里](http://reactivewebdesign.net/Chicago/Directions/WhereAmI)”的链接，它也使用谷歌地图。地图的 CSS 位于页面顶部。如果您希望将地图压缩为三列，只需将 3 & 9 反转为 9 & 3 - 它仍然可以工作。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-08T19:21:59.310

这是我使用 JQuery 找到的解决方案（我认为使用纯 js 很容易做到）

```
$(window).bind('resize', function() {
    if ( $(window).width() > 980 ) {
        $("#content").height(($(window).height()-40)+"px")
        $("#sidebar").height(($(window).height()-58)+"px")
        $("body").css("padding-top","40px")
    }
    else {
        $("#content").height(($(window).height()-50)+"px")
        $("#sidebar").height(($(window).height()-68)+"px")
        $("body").css("padding-top","0px")            
    }

    $("#sidebar").css("overflow", "auto")
    $("body").css("padding-bottom","0px")
    $(".navbar").css("margin-bottom","0px")
}); 
```

`$(selector).css()`函数和条件`if`可以替换为纯 CSS 和来自 CSS3 的媒体查询[http://twitter.github.com/bootstrap/scaffolding.html#responsive](http://twitter.github.com/bootstrap/scaffolding.html#responsive)

但问题是`$(window).height()`计算运行时间。也许应该用`height:100%`CSS 中的 a 之类的东西来代替它，这样可以解决问题，但我找不到合适的位置来放置那个`100%`高度。

# css - 找不到管理员生成器 symfony2 CSS

> ID：10048968
> 
> 赞同：0
> 
> 时间：2012-04-06T20:36:38.363
> 
> 标签：css, symfony, admin-generator

我正在尝试在 Windows 上开始使用 symfony2 的 admingenerator 包：

[http://symfony2admingenerator.org/installation.html](http://symfony2admingenerator.org/installation.html)

我已按照开箱即用、最新、每晚 Windows 版本的说明进行操作。运行 app-dev.php 脚本时，会显示管理界面，但 css 已损坏。

我对 codeigniter 有很好的工作知识，但我只是从 sympfony 开始，希望能得到这方面的提示。由于它是一个未改变的发行版，我希望有一个明显的解决方案。谢谢！

我发现一个帖子遇到了这个问题，建议的解决方案是使用“Assetic Less”。尝试根据稀缺的文档进行相应配置的尝试都是徒劳的。（https://groups.google.com/forum/#!msg/symfony2admingenerator/-d5eyFJ3NjU/44XmT3p2LvUJ）

说明：

无法解析以下 css：cfc4cff__base.css_1.css 而是返回以下错误消息堆栈

> /* [异常] 500 | 内部服务器错误 | Assetic\Exception\FilterException [消息] 运行时出错：cmd /V:ON /E:ON /C ""/var/lib/gems/1.8/gems/compass-0.11.7/bin/compass" "compile " "C:\Users\bion\AppData\Local\Temp" "--boring" "--images-dir" "C:\xampp\htdocs\nightly\app/../web/bundles/admingeneratoractiveadmintheme/images" "--config" "C:\Users\bion\AppData\Local\Temp\ass1F4.tmp" "--sass-dir" "" "--css-dir" "" "C:\Users\bion\AppData \Local\Temp\ass1F5.tmp.scss""
> 
> 错误输出：系统找不到指定的路径。
> 
> 输入：/* Active Admin CSS */ @import "mixins/_all.css.scss";
> 
> // 重置离开！@include 全局重置；
> 
> // 部分 @import "_typography.css.scss"; @import "_header.css.scss"; @import "_forms.css.scss"; @import "组件/_comments.css.scss"; @import "组件/_flash_messages.css.scss"; @import "组件/_date_picker.css.scss"; @import "组件/_tables.css.scss";

和

```
 at n/a
            in C:\xampp\htdocs\nightly\vendor\kriswallsmith\assetic\src\Assetic\Exception\FilterException.php line 40

        at Assetic\Exception\FilterException::fromProcess(object(Process))
            in C:\xampp\htdocs\nightly\vendor\kriswallsmith\assetic\src\Assetic\Filter\CompassFilter.php line 294

        at Assetic\Filter\CompassFilter-&gt;filterLoad(object(FileAsset))
            in C:\xampp\htdocs\nightly\vendor\kriswallsmith\assetic\src\Assetic\Filter\FilterCollection.php line 62

        at Assetic\Filter\FilterCollection-&gt;filterLoad(object(FileAsset))
            in C:\xampp\htdocs\nightly\vendor\kriswallsmith\assetic\src\Assetic\Asset\BaseAsset.php line 83

        at Assetic\Asset\BaseAsset-&gt;doLoad(&#039;/* Active Admin CSS */ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T21:11:36.340

我使用了一种快速而肮脏的解决方案，将 all.css 样式表添加到一个主树枝索引模板中。

# php - 从 PHP 向 Node.js 发送消息

> ID：10048978
> 
> 赞同：22
> 
> 时间：2012-04-06T20:37:40.190
> 
> 标签：php, node.js

如何将消息从 php 发送到 node.js？我有一个运行 php 和 node.js 的 linux 服务器。

当用户完成交易（通过 php）时，我想从 php 向 node.js 发送一条消息。然后节点将通过套接字连接更新客户端。

在不破坏node.js性能的情况下，将少量数据从php发送到node.js的好方法是什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-06T20:44:23.287

该建议似乎是通过 HTTP 接口与节点对话，就像任何其他客户端一样。您可以在 php 中使用 cURL 通过 HTTP 与节点通信

请参阅：[http ://groups.google.com/group/socket_io/browse_thread/thread/74a76896d2b72ccc/216933a076ac2595?pli=1](http://groups.google.com/group/socket_io/browse_thread/thread/74a76896d2b72ccc/216933a076ac2595?pli=1)

特别是，请参阅 Matt Pardee 的这篇文章

> 我遇到了类似的问题，希望让用户了解添加到错误的新注释，以及实际上只能从 PHP 有效发送到我的节点服务器的类似通知。我所做的如下（抱歉，如果这在发送时出现乱码和未格式化，如果是这样，我很乐意将代码粘贴到其他地方）：首先，您需要使用 PHP 中的 cURL。我为我的班级写了一个函数，如下所示：
> 
> ```
> function notifyNode($type, $project_id, $from_user, $data) {
>     $ch = curl_init();
> 
>     curl_setopt($ch, CURLOPT_URL, 'http://127.0.0.1');
> 
>     curl_setopt($ch, CURLOPT_HEADER, 0);
>     curl_setopt($ch, CURLOPT_HTTPHEADER, array('Expect:'));
>     curl_setopt($ch, CURLOPT_PORT, 8001);
>     curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 2);
> 
>     curl_setopt($ch, CURLOPT_POST, true);
> 
>     $pf = array('f' => $type, 'pid' => $project_id, 'user_from' => $from_user, 
>              'data' => array());
> 
>     foreach($data as $k => $v) {
>         $pf['data'][$k] = $v;
>     }
> 
>     curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($pf));
> 
>     curl_exec($ch);
>     curl_close($ch);
> } 
> ```
> 
> 你会注意到我在同一台服务器上发送 cURL 请求，因为 PHP 和 NodeJS 都在那里运行，你的里程可能会有所不同。我将此代码设置为连接到的端口是 8001（这是我的 Node 服务器正在运行的端口，也是 socket.io 服务器连接到的端口）。这会发送一个带有编码后字段的 HTTP POST 请求。这都是非常标准的 cURL 东西。
> 
> 在您的 Node 应用程序中，您可能有以下内容：
> 
> ```
> var server = http.createServer(function(req, res) {});
> server.listen(8001);
> var io = io.listen(server, { transports: ['websocket', 'flashsocket', 'xhr-polling'] });
> 
> ... 
> ```
> 
> 好吧，我们在这里要做的是扩展 http.createServer 部分，以侦听来自本地主机（“127.0.0.1”）的连接。然后 createServer 代码变为：
> 
> ```
> var server = http.createServer(function(req, res) {
>     // Check for notices from PHP
>     if(res.socket.remoteAddress == '127.0.0.1') {
>         if(req.method == 'POST') {
>             // The server is trying to send us an activity message
> 
>             var form = new formidable.IncomingForm();
>             form.parse(req, function(err, fields, files) {
> 
>                 res.writeHead(200, [[ "Content-Type", "text/plain"]
>                         , ["Content-Length", 0]
>                         ]);
>                 res.write('');
>                 res.end();
> 
>                 //sys.puts(sys.inspect({fields: fields}, true, 4));
> 
>                 handleServerNotice(fields);                
>             });
>         }
>     }
> }); 
> ```
> 
> 从那里你可以实现你的 handleServerNotice 功能..
> 
> ```
> function handleServerNotice(data) {
>         ...
> } 
> ```
> 
> 等等等等。我已经有一段时间没有测试过了，事实上，我的节点服务器上的代码块被注释掉了，所以我希望我在这里粘贴的内容有效——总的来说，这个概念得到了证明，我认为它会为你工作。无论如何，只是想确定你知道这已经几个月了，所以我不确定我为什么要评论出来。我编写的代码进行了一些研究——比如在 cURL 中设置 'Expect:' 标头——当它终于奏效时我非常兴奋。如果您需要任何其他帮助，请告诉我。
> 
> 最好的，
> 
> 马特·帕迪

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-05-18T10:49:05.563

有点晚了，但是您可以使用 Redis Pub/Sub 机制以非常简单有效的方式与您的节点客户端通信。您需要做的就是在您的服务器上安装 redis。

在php端，初始化Redis然后发布消息

```
$purchase_info = json_encode(array('user_id' =>$user_id,
         'purchase_information'=>array('item'=>'book','price'=>'2$'));

$this->redis->publish('transaction_completed', $purchase_info); 
```

在 node.js 方面

```
var redis = require('redis');
var purchase_listener = redis.createClient();
purchase_listener.subscribe('transaction_completed');
purchase_listener.on('message', function(channel, message){
    var purchase_data = JSON.parse(message);
    user_id = purchase_data.user_id;
    purchase_info = purchase_data.purchase_information;
    // Process the data
    // And send confirmation to your client via a socket connection
}) 
```

**这是可扩展的吗？**（回应@mohan-singh）

在谈论可扩展性时，您需要考虑您的基础架构的架构和您的特定需求，但这里有一个快速的答案：我一直在高流量实时应用程序上使用这种机制的变体，没有问题，但这是您应该注意的事项：

1.  Redis PUB/SUB 不是一个排队系统，这意味着如果你的节点进程宕机，所有在宕机时发送的消息都会丢失。

2.  如果您有超过 1 个发布者的订阅者，他们都会收到相同的消息并处理它，如果您有多个节点进程侦听同一个 redis db 处理您的实时逻辑，请注意这一点（有简单的方法不过要绕过这个）

这个系统的好处是你不需要在你现有的基础设施中添加任何东西，并且可以立即开始，它非常快，它的行为就像一个 HTTP 服务器。

以下是更多可扩展选项的替代方案：

1.  使用自托管的快速消息队列服务器（ActiveMQ、RabbitMQ、beantalkd ...）服务器来处理 php 和节点之间的消息传递逻辑，这些往往很快，但随着负载的增加，您会损失一些性能，并且必须维护/扩展您的消息服务器，并处理跨区域的重复，这不是一件容易和愉快的事情（取决于您喜欢做什么）。
2.  使用托管消息队列服务器（IronMQ、SQS...）其中一些（IronMQ）非常快，非常适合您的用例，但会给您的代码库带来一些（次要）复杂性。
3.  使用带有集群节点服务器的 Redis 构建消息队列：[https ://davidmarquis.wordpress.com/2013/01/03/reliable-delivery-message-queues-with-redis/](https://davidmarquis.wordpress.com/2013/01/03/reliable-delivery-message-queues-with-redis/)
4.  在 VPN 中使用 HTTP 与节点服务器通信。一旦您看到流量激增，您只需对节点服务器进行负载平衡，并根据需要添加尽可能多的无状态服务器，并将 POST 消息发送到该负载平衡器。

这个冗长编辑的要点是，没有神奇的可扩展解决方案，您需要权衡您的选择，看看哪一个最适合您的用例。在我看来，如果你现在开始构建你的第一个迭代，选择任何你喜欢的选项，编写非常干净的代码，当你开始扩展时，它会很容易改变，这就是我所做的:)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-08-19T21:03:07.987

我发现这样的问题可以简单地通过使用 Express 框架来解决。假设 php 向节点服务器发送 json 消息，服务器回复 ok。

在 app.js 中

```
var app = require('express')();
var http = require('http').Server(app);
var io = require('socket.io')(http);
var bodyParser = require('body-parser')
app.use(bodyParser.json());

app.post('/phpcallback', function(req, res) {
    var content = req.body;
    console.log('message received from php: ' + content.msg);
    //to-do: forward the message to the connected nodes.
    res.end('ok');
});

http.listen(8080, function(){
  var addr = http.address();
  console.log('app listening on ' + addr.address + ':' + addr.port);
}); 
```

在 test.php 中

```
<?php

$data = array("name" => "Robot", "msg" => "Hi guys, I'm a PHP bot !");                                                                    
$data_string = json_encode($data);

$ch = curl_init('http://localhost:8080/phpcallback');                                                                      
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "POST");                                                                     
curl_setopt($ch, CURLOPT_POSTFIELDS, $data_string);                                                                  
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);                                                                      
curl_setopt($ch, CURLOPT_HTTPHEADER, array(                                                                          
    'Content-Type: application/json',                                                                                
    'Content-Length: ' . strlen($data_string))                                                                       
);                                                                                                                   

echo curl_exec($ch)."\n";
curl_close($ch);

?> 
```

在这里，我们还有一个更详细的示例，其中 php 脚本可以向特定聊天室的用户发送消息。

[https://github.com/lteu/chat](https://github.com/lteu/chat)

* * *

我个人对 Redis 方法的印象：繁琐。您需要同时运行 Apache、nodeJS 和 Redis，三台服务器一起运行。而且PubSub机制和socket.io的emit有很大的不同，所以你需要看看它是否和你现有的代码兼容。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-04-17T00:11:08.663

我一直在寻找一种非常简单的方法来让 PHP 向客户端发送 socket.io 消息。

这不需要任何额外的 PHP 库——它只使用套接字。

与其像许多其他解决方案一样尝试连接到 websocket 接口，只需连接到 node.js 服务器并使用它`.on('data')`来接收消息。

然后，`socket.io`可以将其转发给客户。

在 Node.js 中检测来自 PHP 服务器的连接，如下所示：

```
//You might have something like this - just included to show object setup
var app = express();
var server = http.createServer(app);
var io = require('socket.io').listen(server);

server.on("connection", function(s) {
    //If connection is from our server (localhost)
    if(s.remoteAddress == "::ffff:127.0.0.1") {
        s.on('data', function(buf) {
            var js = JSON.parse(buf);
            io.emit(js.msg,js.data); //Send the msg to socket.io clients
        });
    }
}); 
```

这是非常简单的 php 代码——我将它包装在一个函数中——你可能会想出更好的东西。

请注意，这`8080`是我的 Node.js 服务器的端口 - 您可能需要更改。

```
function sio_message($message, $data) {
    $socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
    $result = socket_connect($socket, '127.0.0.1', 8080);
    if(!$result) {
        die('cannot connect '.socket_strerror(socket_last_error()).PHP_EOL);
    }
    $bytes = socket_write($socket, json_encode(Array("msg" => $message, "data" => $data)));
    socket_close($socket);
} 
```

你可以像这样使用它：

`sio_message("chat message","Hello from PHP!");`

您还可以发送转换为 json 并传递给客户端的数组。

`sio_message("DataUpdate",Array("Data1" => "something", "Data2" => "something else"));`

这是一种“信任”您的客户端从服务器获取合法消息的有用方法。

您还可以让 PHP 传递数据库更新，而无需数百个客户端查询数据库。

我希望我能早点找到这个 - 希望这会有所帮助！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-20T16:35:52.477

我们通过使用消息队列来做到这一点。有很多解决方案，例如 radis ( [https://github.com/mranney/node_redis](https://github.com/mranney/node_redis) ) 或 0mq ( [http://zeromq.org/](http://zeromq.org/) )。它允许向订阅者发送消息（例如从 php 到 nodejs）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-09T07:20:16.973

步骤 1\. 获取 PHP Emitter： [https ://github.com/rase-/socket.io-php-emitter](https://github.com/rase-/socket.io-php-emitter)

```
$redis = new \Redis(); // Using the Redis extension provided client
$redis->connect('127.0.0.1', '6379');
$emitter = new SocketIO\Emitter($redis);
$emitter->emit('new question', '<b>h<br/>tml</b>'); 
```

将此添加到您的 index.js 中：

```
var redis = require('socket.io-redis');
io.adapter(redis({ host: 'localhost', port: 6379 }));
io.on('connection', function(socket){
    socket.on('new question', function(msg) {
        io.emit('new question', msg);
    });
}); 
```

将这样的内容添加到您的 index.html

```
socket.on('new question', function(msg) {
    $('body').append( msg );
}); 
```

# wpf - 在 WPF 和 Winforms 之间共享图形

> ID：10048982
> 
> 赞同：0
> 
> 时间：2012-04-06T20:38:38.567
> 
> 标签：wpf, winforms

我有许多我想在 Winforms 项目和 WPF 项目中使用的 png、位图和图标。

我对在 winforms 中使用资源感到满意，并对 WPF 中的资源感到满意。

人们在他们拥有共同资源的情况下都在做什么？我目前的感觉是拥有一个 WPF 资源程序集和一个 Winforms 资源程序集，但我所看到的方法似乎都不流畅。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T13:27:29.497

我有一个同时包含 WPF 和 Winforms 控件的项目。该项目有资源文件夹，其中包含所有图像。比我简单地使用相对路径从磁盘加载它们。
假设您的项目名称是“MyProject”，并且图像路径是项目文件夹内名为“MyImages”的文件夹，并且您的图像名称是“MyImage.bmp”，您可以按如下方式加载它们：

**在 Winforms 中：**

```
new Bitmap(Assembly.GetExecutingAssembly().GetManifestResourceStream("MyProject.MyImages.MyImage.bmp") 
```

**在 WPF 中**

```
 <Image Source="pack://application:,,,/MyProject;Component/MyImages/MyImage.bmp"> 
```

希望能帮助到你...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-31T15:13:52.457

如果构建操作设置为“嵌入式资源”，则 Amittai Shapira 的回答有效。如果您将构建操作设置为“资源”，那么您可以使用：

**赢表格：**

```
Bitmap photo;
var picUri = new Uri(@"pack://application:,,,/MyProject;component/MyImages/MyImage.bmp", UriKind.Absolute);
var resourceInfo = Application.GetResourceStream(picUri);

if (resourceInfo != null)
{
   photo = new Bitmap(resourceInfo.Stream);
} 
```

**WPF：**

```
<Image Source="MyImages/MyImage.bmp"/> 
```

# iphone - 为什么 heightForHeaderInSection 在 iOS 4.3 中不起作用？

> ID：10048983
> 
> 赞同：0
> 
> 时间：2012-04-06T20:38:43.367
> 
> 标签：iphone, cocoa-touch, ipad, uitableview, objective-c-2.0

为什么 heightForHeaderInSection 和 heightForFooterInSection 在 iOS 4.3 中不起作用而在 5.0 中起作用？

```
 -(CGFloat)tableView:(UITableView*)tableView heightForHeaderInSection:(NSInteger)section
  {
     if (section == 0) {
        return 10.0;
     }
     return (tableView.sectionHeaderHeight - 20);
  }

  -(CGFloat)tableView:(UITableView*)tableView heightForFooterInSection:(NSInteger)section
  {
     if (section == ([self.optionsArray count] - 1)) {
        return 15.0;
     }
     return (tableView.sectionFooterHeight - 20);
  } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-06T20:41:51.103

来自 Apple 文档

> 在 iOS 5.0 之前，对于 tableView:viewForHeaderInSection: 返回 nil 视图的部分，表视图会自动将标题的高度调整为 0。在 iOS 5.0 及更高版本中，您必须在此方法中返回每个节标题的实际高度。

# sql - SQL varchar 到位错误

> ID：10048991
> 
> 赞同：0
> 
> 时间：2012-04-06T20:39:47.827
> 
> 标签：sql, bit, varchar

好的，当我尝试执行此过程时出现此错误。问题是我并不想在任何时候转换成一点点。至少不是故意的。我现在有点难过。

```
Declare @AValue varchar(max)
set @AValue = (SELECT Value 
        FROM dbo.Tbl 
        WHERE Name=@FILE 
            AND Value LIKE (CAST(@MODID as varchar(15))+'|%'))
set @AValue = PARSENAME(REPLACE(@AValue, '|', '.'), 1) -- Hack way to parse.

INSERT INTO dbo.Tbl
(
    Name, 
    Value, 
    Type, 
    CDT, 
    UDT, 
    Active, 
    User
)
VALUES 
(
    'Agreement', 
    (CAST(@MODID AS varchar(15)) + '|' + @AValue), 
    'Download', 
    GETDATE(), 
    GETDATE(), 
    1, 
    @USER
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T20:51:39.303

检查表上的触发器，尤其是插入。很多时候，无法解释的错误可能潜伏在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T12:35:01.407

抱歉，找到答案了。我今天回来了，我得到的错误与我第一次提出问题时的错误完全不同。对不起，我忘了写那个错误。

问题是我的 WHERE 子句从数据库中获得了多个返回，因为我已经测试了很多，所以有重复的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:23:53.300

发布错误、CREATE PROCEDURE 语句，以及 - 最重要的是 - 对失败的过程的调用。另外，您使用的是什么版本的 SQL Server？

最有可能的是，存储过程有一个 BIT 类型的参数，并且您正在使用诸如“F”、“-1”之类的值或其他一些无法转换为 BIT 的字符串来调用该过程。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-04-06T20:50:38.677

GetDate 需要先分配给 T-SQL 中的某些内容，然后才能在插入中使用。

尝试这个：

```
DECLARE @CDT DateTime
DECLARE @UDT DateTime
SELECT @CDT = GetDate()
SELECT @UDT = GetDate()

INSERT INTO dbo.Tbl 
( 
    [Name],  
    [Value],  
    [Type],  
    CDT,  
    UDT,  
    Active,  
    User 
) 
VALUES  
( 
    'Agreement',  
    (CAST(@MODID AS varchar(15)) + '|' + @AValue),  
    'Download',  
    @CDT,  
    @UDT,  
    1,  
    @USER 
) 
```

# php - 不知道如何做这个正则表达式

> ID：10048997
> 
> 赞同：1
> 
> 时间：2012-04-06T20:40:05.770
> 
> 标签：php, regex, markdown

在提出以下问题并思考之后，我相信这个正则表达式就是我所需要的。不知道该怎么做。

`![anycharacter](anycharacter)`至`[anycharacter](anycharacter)`

-原始标题和消息-

PHP Markdown Extra - 不允许图像

现在我只是将 css 设置为在允许降价的区域隐藏图像。我想这样做，如果使用降价图像语法，图像将不会显示。我实际上更希望它只是变成一个链接，但简单地禁止它就可以了。我猜想检查一个正则表达式`![text](imagelink)`会起作用，但我对正则表达式不够精通，无法做到这一点，也不知道这是否是最佳选择。

-edit- 现在我正在做一个 preg_replace ， `preg_replace('/!\[/', "[", $text );`但我仍然认为这不是最好的解决方案，因为它会删除 ! 即使有时可能还有另一个原因！[出现。我想我只需要知道如何`![anycharacter](anycharacter)`替换`[anycharacter](anycharacter)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T20:51:11.043

这实际上不是我的代码，它来自[http://core.svn.wordpress.org/tags/1.5.1.3/wp-content/plugins/markdown.php](http://core.svn.wordpress.org/tags/1.5.1.3/wp-content/plugins/markdown.php)但您可以使用它在 _DoImages_reference_callback($matches ) 和 _DoImages_inline_callback($matches) 函数，但这只是一个要点。

```
$text = preg_replace_callback('{
    (               # wrap whole match in $1
      !\[
        (.*?)       # alt text = $2
      \]

      [ ]?              # one optional space
      (?:\n[ ]*)?       # one optional newline followed by spaces

      \[
        (.*?)       # id = $3
      \]

    )
    }xs', 
    '_DoImages_reference_callback', $text);

#
# Next, handle inline images:  ![alt text](url "optional title")
# Don't forget: encode * and _

$text = preg_replace_callback("{
    (               # wrap whole match in $1
      !\\[
        (.*?)       # alt text = $2
      \\]
      \\(           # literal paren
        [ \\t]*
        <?(\S+?)>?  # src url = $3
        [ \\t]*
        (           # $4
          (['\"])   # quote char = $5
          (.*?)     # title = $6
          \\5       # matching quote
          [ \\t]*
        )?          # title is optional
      \\)
    )
    }xs",
    '_DoImages_inline_callback', $text); 
```