# StackOverflow 问答 12031000-12031999

# java - 使用 AsyncTask 更新 UI

> ID：12031002
> 
> 赞同：0
> 
> 时间：2012-08-20T00:16:07.990
> 
> 标签：java, android, android-asynctask

我正在尝试在显示进度条后实现登录，但它显示错误。下面是我正在使用的代码

```
class PostService extends AsyncTask<String, Void, String> {

        @Override
        protected String doInBackground(String... params) {
            String s = UserFunctions.response;
        Log.d(Details.TAG, "checking i response...");
            UserFunctions.basicLogin(email, password);
            Log.d(Details.TAG,
                    s + " " + UserFunctions.basicLogin(email, password));

            return s;
        }

        Intent i;

        @Override
        protected void onPostExecute(String r) {
            // TODO Auto-generated method stub
            super.onPostExecute(UserFunctions.response);
            Log.d(Details.TAG, "Password Point");
            if(UserFunctions.basicLogin(email, password)){
                i = new Intent("com.example.eve_haps.DASHBOARDACTIVITY");
                startActivity(i);
            }else {
                Toast.makeText(MainActivity.this,
                        "Login UnSuccesful. Check email and/or password",
                        Toast.LENGTH_SHORT).show();
            }

        }

    } 
```

但它返回一个错误日志

```
E/AndroidRuntime( 7465): FATAL EXCEPTION: main
E/AndroidRuntime( 7465): java.lang.StringIndexOutOfBoundsException: length=0; regionStart=0; regionLength=17
E/AndroidRuntime( 7465):    at java.lang.String.startEndAndLength(String.java:593)
E/AndroidRuntime( 7465):    at java.lang.String.substring(String.java:1474)
E/AndroidRuntime( 7465):    at com.example.eve_haps.UserFunctions.basicLogin(UserFunctions.java:107)
E/AndroidRuntime( 7465):    at com.example.eve_haps.MainActivity$PostService.onPostExecute(MainActivity.java:105)
E/AndroidRuntime( 7465):    at com.example.eve_haps.MainActivity$PostService.onPostExecute(MainActivity.java:1)
E/AndroidRuntime( 7465):    at android.os.AsyncTask.finish(AsyncTask.java:602)
E/AndroidRuntime( 7465):    at android.os.AsyncTask.access$600(AsyncTask.java:156)
E/AndroidRuntime( 7465):    at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:615)
E/AndroidRuntime( 7465):    at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime( 7465):    at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime( 7465):    at android.app.ActivityThread.main(ActivityThread.java:4424)
E/AndroidRuntime( 7465):    at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime( 7465):    at java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime( 7465):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
E/AndroidRuntime( 7465):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
E/AndroidRuntime( 7465):    at dalvik.system.NativeStart.main(Native Method) 
```

下面是实现登录的代码

```
public static boolean basicLogin(String email, String password) {

        String msg = "Login successful";
        boolean status = false;
        String url;
        String links[] = {
                "..." + "?user=",
                "..." + "?actn=login"
                        + "&user=" };
        auth_link = links[0]+email + "&password=" + password;
        response = Connect.doHTTPGet(auth_link);
//      result = getHttpResponse(url);
        Log.d(Details.TAG, " " + msg.length() + " " + UserFunctions.response.substring(0, 17) + " "+ UserFunctions.response.substring(0, 17).length() );
        if (UserFunctions.response.substring(0, 17).trim().equals(msg)) {
            Log.d(Details.TAG, " " + msg.length() + " " + UserFunctions.response.substring(0, 17));
            status = true;
        } 
        Log.d(Details.TAG, " " + "Connection Test"
                + UserFunctions.response);

        return status; 
```

请问是什么错误。我会回复感谢

# python - 在 Tornado 中禁用静态文件缓存

> ID：12031007
> 
> 赞同：26
> 
> 时间：2012-08-20T00:16:49.987
> 
> 标签：python, caching, tornado, static-files

默认情况下，Tornado`Cache-Control: public`在任何由`StaticFileHandler`. 这怎么能改成`Cache-Control: no-cache`？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-09-18T18:27:42.800

接受的答案不适用于 Chrome。`StaticFileHandler`使用以下子类：

```
class MyStaticFileHandler(tornado.web.StaticFileHandler):
    def set_extra_headers(self, path):
        # Disable cache
        self.set_header('Cache-Control', 'no-store, no-cache, must-revalidate, max-age=0') 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-20T00:40:01.603

查看 tornado/web.py 似乎最简单的方法是继承 StaticFileHandler 并覆盖 set_extra_headers 方法。

```
def set_extra_headers(self, path):
    self.set_header("Cache-control", "no-cache") 
```

# content-management-system - 如何使用项目 ID 和组件 ID 在 CM8.4 中获取文档的主 ID (pid)？

> ID：12031014
> 
> 赞同：0
> 
> 时间：2012-08-20T00:18:02.513
> 
> 标签：content-management-system

我使用 IBM Content Manager 8.4.1，我需要编写一些代码来检索文档。我拥有的信息是从 ICMADMIN（默认）架构下的文档视图中检索的项目 ID 和组件 ID。

下面的块给出了一个使用 DKPidICM 对象生成用于获取工作包的主 ID (pid) 的示例，但我想获取一个文档，并且需要知道有什么不同。

```
DKPidICM pidicm = new DKPidICM();
pidicm.setComponentId(compId);
pidicm.setItemId(itemId);
pidicm.setDatastoreName(datastoreName);
pidicm.setComponentTypeId("204");
pidicm.setVersionNumber("1");
pidicm.setObjectType("WORKPACKAGE");
pidicm.setDatastoreType("ICM");
pidicm.getPrimaryId(); 
```

要检索文档我需要设置什么

*   组件类型 ID
*   对象类型

或者有没有更好的方法一起

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T04:39:04.533

事实证明，组件类型 id 直接基于您要查找的项目类型，因此项目下的系统管理客户端的名称。

我发现确定 componentTypeId 的最直接方法是：

1).查询该项目类型`queryService.setQueryString(**"/itemTypeName"**, CMBBaseConstant.CMB_QS_TYPE_XPATH);`

2).创建对应的DKPidICM`DKPidICM pidicm = new DKPidICM(pidString)`

3).从中获取componentID`pidicm.getComponentTypeId()`

**更完整的示例如下**

```
 CMBQueryService queryService = cmbConnection.getQueryService();
    queryService.setAsynchSearch(false); // synchronous search
    queryService.setMaxResults(1);

    queryService.setQueryString("/itemTypeName", CMBBaseConstant.CMB_QS_TYPE_XPATH);
    queryService.runQuery();

    CMBResultData results = (CMBResultData) queryService.getResults();

    CMBSearchResults searchResults = new CMBSearchResults();
    searchResults.setConnection(cmbConnection);
    searchResults.newResults(results);

    if (searchResults.getCount() > 0) {
        String pidString = searchResults.getItem(0).getPidString();
        DKPidICM pidicm = new DKPidICM(pidString);

        return pidicm.getComponentTypeId(); 
```

# python - 在 Python 中覆盖

> ID：12031018
> 
> 赞同：4
> 
> 时间：2012-08-20T00:18:51.143
> 
> 标签：python

我希望能够做到以下几点

```
class Parent:
    def __init__(self):
        pass
    def Create(self):
        return 'Password'

class Child(Parent):
    def __init__(self):
        self.Create()
    def Create(self):
        return 'The '+self.Create #I want to return 'The Password' 
```

我想从覆盖它的函数中的子类中获取父函数。我不知道该怎么做。

这有点难以解释，如果您无法理解，请发表评论。

编辑：

感谢大家的回答，我几乎认为这是不可能的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T00:20:44.430

[该`super()`功能](http://docs.python.org/library/functions.html#super)适用​​于此类情况。但是，它仅适用于“新式”类，因此您还需要修改`Parent`继承自的定义`object`（无论如何，您应该始终使用“新式”类）。

```
class Parent(object):
    def __init__(self):
        pass
    def Create(self):
        return 'Password'

class Child(Parent):
    def __init__(self):
        self.Create()
    def Create(self):
        return 'The ' + super(Child, self).Create()

print Child().Create() # prints "The Password" 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-20T00:21:48.470

要么显式引用父级，要么（在新式类中）使用[`super()`](http://docs.python.org/library/functions.html#super).

```
class Child(Parent):
   ...
  def Create(self):
    return 'The ' + Parent.Create(self) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T00:21:16.010

[它就像通过super](http://docs.python.org/library/functions.html#super)引用基类一样简单：

```
class Child(Parent):
    def __init__(self):
        self.Create()
    def Create(self):
        return 'The '+ super(Child, self).Create() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T00:21:16.323

使用该`super`函数访问父级`super(Child,self).create()`以从父级调用创建。

# c++ - 跨线程从 QML 调用 QObject 函数

> ID：12031020
> 
> 赞同：10
> 
> 时间：2012-08-20T00:19:37.987
> 
> 标签：c++, multithreading, qt, qml

我正在尝试确定如何从 QML 调用 QObject 插槽或 Q_INVOKABLE 方法来为存在于另一个线程中的 QObject 工作，以及这样做是否安全。

假设有一个 MainThread 和 ThreadA。QObjectA 位于 ThreadA 中。QML 引擎/gui/一切都存在于 MainThread 中。我使用 QObjectA 将 QObjectA 暴露给 QML 引擎

```
declarativeView->setContextProperty("someObj",ObjectA) 
```

现在在 QML 文件中，我调用

```
someObj.someMethod(); 
```

其中 someMethod 是一个插槽或者是 Q_INVOKABLE。我想知道哪个线程实际执行该函数。如果是 MainThread，那将是一件坏事，跨线程调用这样的方法会很危险。但是，如果它由 ThreadA 执行，一切都会好起来的。

基于此文档：[http](http://doc.qt.nokia.com/4.7-snapshot/qtbinding.html) ://doc.qt.nokia.com/4.7-snapshot/qtbinding.html，我假设 QMetaObject::invokeMethod() 用于调用 QObject 函数。该文档（[http://doc.qt.nokia.com/4.7-snapshot/qmetaobject.html#invokeMethod](http://doc.qt.nokia.com/4.7-snapshot/qmetaobject.html#invokeMethod)）表明有不同的连接类型可用，就像 Qt 信号和插槽一样。

我想知道在跨线程从 QML 调用 C++ 方法时，Qt 的 qml 引擎是否会自动选择正确的类型，如果是这样，从 QML 调用存在于其他线程中的对象的方法是一种可接受的做法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-01-26T15:11:41.840

正如前段时间[显而易见](https://stackoverflow.com/questions/46738764/is-there-a-way-to-run-c-from-a-qml-workerscript/46739399#46739399)的那样，QML 似乎无法跨越线程。

因此，需要实现一个位于主线程中的 C++ 端中间对象，以调度对其他线程中对象的调用。

```
QML object -> object in a different thread // doesn't work!!!
QML object -> C++ mediator object -> object in a different thread // WORKS!!! 
```

基本上，“超越”线程必须完全发生在 C++ 中，因此需要一个中介对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T10:31:39.787

我猜 someMethod 将在 ThreadA 中执行，因为该对象位于该线程中。

但通常如果这会产生问题，那么我会做这样的事情。

连接（&threadA，信号（开始（）），someObj，SLOT（someMethod（））；

但是要启动那个 ThreadA，我们还需要一个 CppObject 来链接 QML 和 CPP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-01T09:19:24.983

您可以使用 `this->thread();`或`QThread::currentThreadId();`在插槽内获取插槽正在工作的线程。它将始终是线程，ObjectA 是在其中创建的（如果没有`moveToThread()`）。

Qt-Engine 将`Qt:ConnectionType`通过确定调用和被调用线程来选择正确的。

额外提示：您可以使用[GammaRay](https://github.com/KDAB/GammaRay)或[ThreadSanitizer](https://clang.llvm.org/docs/ThreadSanitizer.html)查看当前跨线程的直接连接。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-21T07:33:39.873

QML 逻辑是事件驱动的，所有调用都是 JavaScript 函数的一部分。JS 函数可能是事件处理程序（例如 UI 事件处理程序），或者如果您将它们包装在 QScript 对象中，则可以在 C++ 代码中的某处调用它们。您也可以在 JavaScript WorkerTherad 中调用它们。这就是为什么只有您可以提供答案的原因， someObj.someMethod() 调用发生在哪里。

# html - 悬停下拉菜单时，CSS菜单链接背景不保留

> ID：12031021
> 
> 赞同：0
> 
> 时间：2012-08-20T00:19:41.077
> 
> 标签：html, css, menu

每当我将鼠标悬停在菜单项上时，它都会打开悬停背景+打开下拉菜单。但是每当我悬停下拉菜单时，背景就会消失？

[示例](http://gyazo.com/20c9ea451a8c2802d80229d5b2bd7af3.png)以及它应该如何看起来像[这样](http://gyazo.com/e25aa288d19264ca019caf16ac8d97c7.png)

查看[实时预览](http://www.justxp.plutohost.net/survive/index.html)

此外，正如您所见，盒子阴影越过它。

代码：我的菜单 html：

```
 <div class="secondheader">

      <div class="container">

               <div class="span12">

                          <ul class="nav6">

                          <li><a href="#">Home</a></li>

                           <li class="dropdown1"><a href="#">Categories</a>
                <ul>
                    <li class="substyle"><a href="#">Buy</a></li>
                    <li class="substyle"><a href="#">Sell</a></li>
                    <li class="substyle"><a href="#">Forums</a></li>
                    <li class="substyle"><a href="#">Contact</a></li>
                    <li class="substyle"><a href="#">item 1</a></li>
                    <li class="substyle"><a href="#">Forums</a></li>
                    <li class="substyle"><a href="#">Contact</a></li>
                    <li class="substyle"><a href="#">item 1</a></li>
                </ul>
            </li>

                          <li><a href="#">Buy</a></li>

                          <li><a href="#">Sell</a></li>

                          <li><a href="#">Forums</a></li>

                          <li><a href="#">Contact</a></li>

                          <li><a href="#">item 1</a></li>

                          <li><a href="#">Forums</a></li>

                          <li><a href="#">Contact</a></li>

                          <li><a href="#">item 1</a></li>

                          </ul>

                          </div>

               </div>

       </div>

</div> 
```

我的 CSS 菜单：

```
.nav6  {
list-style: none;
font-family: 'Dosis', sans-serif;
float: left
font-size: 20px;
margin-top: 13px;
margin-left: -35px;
}
.nav6>li>ul{
display:none;
position:absolute;
background:white;
overflow:hidden;
width: 150px;
background: #fbf2d3;
margin-top: 20px;
margin-left: -3px;
-webkit-box-shadow:  0px 1px 5px 0px #dadada;
box-shadow:  0px 1px 5px 0px #dadada;       
}
.nav6>li:hover>ul {
display:block;
}
.nav6 >li {
display: inline;
margin: 0px;
font-size: 18px;
font-family: 'Dosis', sans-serif;
float: left;
margin-top: 10px;
}
.substyle {
padding: 10px;
}
.substyle:hover {
background: #f54922;
padding: 10px;
-webkit-border-radius: 6px;
border-radius: 6px;
color: #fff;
}
.subsyle a:hover {
color: #fff;
}
.nav6>li>a {
padding-top: 20px;

padding-bottom: 20px;

padding-left: 20px;

padding-right: 20px;

}
.nav6 a{color: #7D7253;}

.nav6 a:hover {
color: #fff;

text-decoration: none;
}
.nav6 > li > a:hover {
background-image: url("../img/hoverbg.png");    
} 
```

问题： > 选择器究竟做了什么？你能用一个简单的例子解释一下吗？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T05:25:29.220

当您悬停在整个 li 上时，您需要添加一个显示悬停图像的类，而不仅仅是子 li。尝试将您的最后一个样式更改为：

```
.nav6 > li > a:hover, .nav6 > li:hover > a {
    background-image: url("../img/hoverbg.png");    
} 
```

此外， > 选择器专门表示父级的“直接子级”。所以如果你有这个：

```
<div>
    <p><span></span></p>
    <span></span>
</div> 
```

然后这将适用于所有跨度：

```
div span {} 
```

这将仅适用于第二个跨度：

```
div > span {} 
```

其中任何一个都将仅适用于第一个跨度：

```
div p span {}
div > p > span {} 
```

在最后一种情况下，您不会使用 > - 仅当您特别需要仅针对直接子级时才使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T00:28:15.457

去[w3schools](http://www.w3schools.com)了解选择器的整体知识，如果有兴趣认真学习，你可以去 [saylor](http://www.saylor.org)进行免费教育。

FYI 认为是`>`So 中的含义，`.nav6>li` 表示“在”nav6 类中的列表

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T06:14:11.737

您只需在此类中进行更改`.nav6 > li > a:hover {}`

并写入这种格式`.nav6 > li:hover a {}`

这将工作正常............

# android - 使用 ImageButton 打开 ContextMenu

> ID：12031023
> 
> 赞同：2
> 
> 时间：2012-08-20T00:19:47.557
> 
> 标签：android

由于某种原因，我无法创建上下文菜单。

我在 onCreate 中有这些行：

```
btnMenu = (ImageButton) findViewById(R.id.btnMenu);

registerForContextMenu(btnMenu); 
```

并添加了方法：

```
@Override
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.mainmenu, menu);
} 
```

我在 res/menu 中有一个名为 mainmenu 的 xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>

<menu xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:id="@+id/new_game"
    android:title="item1"
    />
    <item android:id="@+id/help"
    android:title="item2" 
    />

</menu> 
```

但是当我单击图像按钮时，什么都没有出现。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T00:50:14.337

我试过你的代码，效果很好。请注意，您需要长按视图（在此示例中为按钮），而不是短按。如果要显示上下文菜单以进行短按，请尝试以下操作：

```
Button b = (Button) findViewById(R.id.button1);

registerForContextMenu(b);

b.setOnClickListener(new Button.OnClickListener() {
@Override
public void onClick(View v) {
    v.showContextMenu();
}   
}); 
```

# python - 无法将长 JSON 输出写入文本文件

> ID：12031025
> 
> 赞同：5
> 
> 时间：2012-08-20T00:20:08.627
> 
> 标签：python, json

我有一个长字符串（8,315 个字符）的 JSON，但我似乎无法使用 Python 将其写入 .txt 文件而不被截断。

我将 JSON 写入文本文件，然后通过 FTP 上传，但我系统上的 .txt 文件和 FTP 服务器上的 .txt 文件都被截断。

这是代码：

```
# Upload the results
host = ftputil.FTPHost('ftp.website.com', 'username', 'password')
jsonOutput = json.dumps(full_json)
f = open('C:/Comparison.txt', 'w')
f.write(jsonOutput)
host.upload('C:/Comparison.txt', '/public_html/Comparison.txt')
f.close()
print jsonOutput 
```

控制台中的 JSON 输出有效且完整，但在写入的 .txt 文件中被截断（然后是上传后的 .txt 文件）。

大多数情况下，输出将在`http://www.digikey.com/product-detail/en/A000073/1050-10`完整 URL 实际出现时结束`http://www.digikey.com/product-detail/en/A000073/1050-1041-ND/3476357`（当然，它会切断 JSON 的其余部分）

我不确定这是否有任何区别，但我也尝试`f.write(re.escape(jsonOutput)`了相同的结果。

有人能帮忙吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-20T00:23:24.443

```
with open('C:/Comparison.txt', 'w') as f:
  json.dump(full_json, f) 
```

# c# - 数据上下文执行查询

> ID：12031028
> 
> 赞同：4
> 
> 时间：2012-08-20T00:20:50.437
> 
> 标签：c#, sql, sql-server, linq-to-sql, xquery

```
string query = @"SELECT ColA, ColXML FROM TableT WHERE ColXML.exist('/SuperNode/Node/SubNode[.=({0})]') = 1";
string param = "''value1'',''value2'',''value3''";
string sQ = string.Format(query, param);

A: dbContext.ExecuteQuery(sQ);

B: dbContext.ExecuteQuery(query, param); 
```

A 执行并返回结果，但 B 没有。

这有什么原因吗？此外，参数是否针对常见的`SQL`注入模式进行了验证？

感谢您的任何指点！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T10:33:27.853

[http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.executequery.aspx](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.executequery.aspx)

您正在尝试使用接收参数的 ExecuteQuery 的重载版本。参数必须作为对象数组传递，例如：

```
object[] param = new Object[] { "value1", "value2", "value3" }; 
```

无论如何，您的查询只接收一个参数：

```
string query = @"SELECT ColA, ColXML FROM TableT WHERE ColXML.exist('/SuperNode/Node/SubNode[.=({0})]') = 1"; 
```

您似乎想传递由三个 xml 值组成的单个参数。我不是 XQuery 专家，但您可以试试这个：

```
object[] param = new Object[] { "''value1'', ''value2'', ''value3''" };
string query = @"SELECT ColA, ColXML FROM TableT WHERE ColXML.exist('/SuperNode/Node/SubNode[.=({0})]') = 1"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-27T07:30:55.847

对于像我一样通过谷歌偶然发现的任何人，ExecuteQuery 不会简单地将命令和参数传递给 string.Format，因为这会产生注入漏洞。

它将命令中的 {0}、{1}、... 替换为“@p0”、“@p1”等，然后将您的参数作为参数添加到 sql 命令中。这可以通过在数据上下文中设置 .Log 属性以查看实际执行的命令来确认。

因此，OP 的示例不起作用，因为 f(x) where x = "a,b,c" 仅在我们进行简单的字符串替换时才等效于 f(a,b,c) 。如果 x 是“正确”的 SQL 参数，则它不起作用。

# c# - 删除行时更新其他行的主键列

> ID：12031029
> 
> 赞同：0
> 
> 时间：2012-08-20T00:21:11.363
> 
> 标签：c#, mysql, database

在我的数据库中，有一个表格基本上包含问题及其选项和答案。第一个字段是 ~questionid~ 并且是主键，正如预期的那样（我现在禁用了 AUTOINCREMENT）。我的客户可能想删除一些问题。这给我留下了两个选择：

1.  所有后续问题都向上移动，因此没有空行。此选项意味着这些问题将更改其问题 ID

2.  保持原样，这样会有空行。如果有一个新条目，它应该填充第一个空行。

我该如何实施其中的任何一个？实际上，我更喜欢第二种，但如果有人有不同的意见，欢迎提出。
我正在使用 MySQL 数据库和 C#。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:49:54.797

您正在使用数据库，因此您不必担心这些问题。

SQL 表中没有“空”行的概念（好吧，可以说如果所有列都是 NULL 则该行是空的，但这在这里不相关）。SQL 表中的行本身并不是有序的。

行本身存储在页面上，这些页面可能有也可能没有额外的空间来容纳更多的行。当您想到空行时，这可能就是您所想到的。

删除一行时，数据不会重新排列。页面上只有一些额外的空间，以防以后添加新行。如果您在两个现有行之间添加带有主键的新行，并且页面已满，则数据库将页面“拆分”为两部分。另外两个页面有额外的空间。

然而，重要的一点不是它是如何工作的。您为应用程序使用关系数据库的一个原因是您可以添加和删除行，而不必担心它们的实际物理存储。

如果您有一个包含大量事务（删除和插入）的数据库，那么您可能希望定期重新排列数据以使其更适合页面。但是，通常只有在此类交易量很大时才需要进行此类优化。

不过有一件事。您的应用程序不应依赖于顺序的主键，因此它可以正确处理删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T00:48:31.780

我不确定你是如何实施的。我会这样做，

```
 questions
     question_id - pk
     question

  answers
     answer_id - pk
     answers

  question_answer
      question_id
      answer_id 
```

这将带来更多优势。许多问题会有相同的答案。如果可以删除问题，则从 question_answer 表中删除它们及其答案

# iphone - 将图像添加到 iPhone 导航栏

> ID：12031038
> 
> 赞同：1
> 
> 时间：2012-08-20T00:22:43.820
> 
> 标签：iphone, ios, uinavigationcontroller, uitabbarcontroller, tabbar

我想用自定义图像替换当前的导航栏。我的代码的结构是标签栏控制器控制一堆包含视图的导航控制器（标签栏控制器->导航控制器->视图）。我尝试在我的应用委托中使用此代码

```
@implementation UINavigationBar (UINavigationBarCategory)
- (void)drawRect:(CGRect)rect {
  UIColor *color = [UIColor blackColor];
  UIImage *img  = [UIImage imageNamed: @"nav.png"];
  [img drawInRect:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];
  self.tintColor = color;
}
@end 
```

但它没有用。任何想法为什么？我应该把它放在别的地方吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T00:46:53.383

如果您使用的是 iOS 5，则可以使用 setBackgroundImage: 像这样初始化导航控制器（本例中为 aNavigationController）：

```
[aNavigationController.navigationBar setBackgroundImage:[UIImage imageNamed:@"nav.png"] forBarMetrics:UIBarMetricsDefault]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T01:38:42.887

我不会使用类别。我会将 UINavigationBar 子类化。看到这个：[https ://stackoverflow.com/a/6959354/472344](https://stackoverflow.com/a/6959354/472344)

如果您的目标是 iOS 5 或更高版本，请改用 @BJH 的解决方案。

# javascript - node.js mongojs findOne 回调返回错误为空

> ID：12031041
> 
> 赞同：5
> 
> 时间：2012-08-20T00:23:05.163
> 
> 标签：javascript, node.js, mongodb, callback, mongojs

目前正被这个错误逼上绝路。

我正在使用 mongodb 的 mongojs 包装器运行 node.js 应用程序。我在默认端口上启动了 mongod，然后运行

```
var db = require('mongojs').connect('localhost:27017/my_db');
var users = db.collection('users');    
users.findOne({'fb_id' : fbUserMetadata.id}, function(err, user) {
                console.log(err);
                console.log(user);
                debugger;

    }); 
```

但是 err 和 user 都是'null'。据我所知，即使没有找到任何数据，err 也应该填充某种数据。

如何让回调函数正常工作？原谅新手的问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-20T00:33:19.557

当`findOne`查询没有找到至少一个匹配的文档时，回调的第二个参数（在这种情况下`user`）设置为`null`. 这不是错误，`err`也是`null`。所以你看到的是预期的找不到匹配的响应。

**更新**

请注意，[`findOne`](http://mongodb.github.io/node-mongodb-native/2.0/api/Collection.html#findOne)在 2.0 驱动程序中已弃用，但它的替换也表现出相同的行为：

```
users.find({'fb_id' : fbUserMetadata.id}).limit(1).next(err, doc) {
    // doc is null if a matching document wasn't found
}); 
```

# java - 将任意流连接到标准输入

> ID：12031048
> 
> 赞同：0
> 
> 时间：2012-08-20T00:24:02.087
> 
> 标签：java, unit-testing, stream, pipe

我有一个程序需要处理来自标准输入的数据。我可以像这样在命令行上调用它`java program < input`。我想为其 main() 编写一个适当的单元测试。是否可以将方法的 System.in 与其他流重新关联？

在测试中，我可以读取示例数据，然后以某种方式运行原始程序，并将其标准输入连接到我定义的某个流（来自示例数据）并验证它是否返回了我期望的结果。我考虑使用这些类： [PipedInputStream](http://docs.oracle.com/javase/6/docs/api/java/io/PipedInputStream.html)和 [PipedOutputStream](http://docs.oracle.com/javase/6/docs/api/java/io/PipedOutputStream.html)。但它需要我修改原始程序以在每次测试时从 PipedInputStream 读取。或者我可以将读取的流隔离到一个函数中（例如`parseStream(InputStream)`）并传递一个已经连接到示例数据的 PipedInputStream。

我还可以编写一个 shell 脚本来将我想要的任何内容通过管道传输到它的标准输入中，但是所讨论的方法将是一系列处理步骤的一部分，因此它本身不应该写入标准输出并实际上返回 ArrayList<SomeCompositeType>。SomeCompositeType 包含以结构化方式读取的数据（例如，一些整数、数组、地图等）

那么是否可以使用不同的流调用从 System.in 读取的某些方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T00:32:28.120

见[我的评论](https://stackoverflow.com/questions/12031048/connecting-arbitrary-streams-to-standard-input#comment16058320_12031048)。

您似乎想要的由[`System.setIn`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#setIn(java.io.InputStream)):-)提供

# r - 生成单元格计数随机但行总和始终相同的数据

> ID：12031049
> 
> 赞同：5
> 
> 时间：2012-08-20T00:24:38.670
> 
> 标签：r

我处于需要创建一堆假数据集的情况，其中两个变量的总和与我的真实数据相同，但每个变量的计数是随机的。这是设置：

```
>df
    X.1  X.2
1   145   30
2    55   73 
```

第一行总和为 175，第二行总和为 128。我正在寻找的是一种生成数据帧（或一堆数据帧）的方法，如下所示：

```
>df.2
    X.1  X.2
1   100   75
2    90   38 
```

在 df.2 中，单元格计数发生了变化，但行仍然汇总到同一个表中。实际数据有数百行，但如果有帮助的话，只有两个变量。我试图弄清楚如何做到这一点，`sample()`但没有任何运气。有什么建议么？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T01:59:32.737

也许您正在寻找`r2dtable`？

```
> r2dtable(2, c(175,128), c(190, 113))
[[1]]
     [,1] [,2]
[1,]  108   67
[2,]   82   46

[[2]]
     [,1] [,2]
[1,]  114   61
[2,]   76   52 
```

此外，这是@mnel's answer的一个版本，用于`rmultinom`进行`n`复制然后组合结果。如果您只需要一些复制，这并不重要，但既然`rmultinom`可以做到，我想我会看看它是如何完成的。

```
n <- 10
e <- cbind(X1  = c(100,90,30),X2 = c(75,28,120))
aperm(array(sapply(1:nrow(e), function(i) 
        rmultinom(n, rowSums(e)[i], (e/rowSums(e))[i,])),
      dim=c(ncol(e),n,nrow(e))), c(3,1,2)) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-20T00:44:07.873

您正在从多项分布中抽样，

* * *

# 编辑

允许预先指定的预期细胞计数

*   多项分布可以将每个单元视为泊松分布（具有预期单元计数），以总和为条件。

* * *

# 编辑 2

*   允许任意数量的行/预期的单元格计数
*   `expected`作为预期的细胞计数通过

* * *

请注意，它`rmultinom`返回一个矩阵，其中每列都是多项式样本，因此我使用它`t`来创建单行矩阵

```
replicates <- 10
expected <- data.frame(X1  = c(100,90,30),X2 = c(75,28,120))
##    X1  X2
## 1 100  75
## 2  90  28
## 3  30 120
data_samples <- lapply(seq(replicates), function(i, expected){
   # create a list of expected cell counts (list element = row of expected)
  .list <- lapply(apply(expected,1,list),unlist)
   # sample from these expected cell counts and recombine into a data.frame
   as.data.frame(do.call(rbind,lapply(.list, function(.x) t(rmultinom(n = 1, prob = .x,  size = sum(.x) )))))
   }, expected = expected) 
```

这将创建一个`data.frames`具有适当属性的列表

```
data_samples[[1]]
##    X1  X2
## 1 104  71
## 2  84  34
## 3  19 131

data_samples[[5]]
##   X1  X2
## 1 88  87
## 2 92  26
## 3 27 123 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T00:59:35.387

答案中使用的数据：

```
test <- data.frame(X.1=c(145,55),X.2=c(30,73)) 
```

**使用的版本`sample`：**

```
t(sapply(
        rowSums(test),
        function(x) {
                one <- sample(1:x,1)
                two <- (x - one)
                result <- data.frame(one,two)
                names(result) <- names(test)
                return(result)
                }
         )
) 
```

结果如下所示：

```
 X.1 X.2
[1,] 20  155
[2,] 127 1 
```

或者...

```
 X.1 X.2
[1,] 111 64 
[2,] 94  34 
```

ETC...

**或者：**

只需`jitter`先在其中一个数字上加一点，然后从行总和中减去。

```
t(apply(
        test,
        1,
        function(x) {
                rsum <- sum(x)
                one <- round(jitter(x[1],20,20),0)
                two <- (rsum - one)
                result <- c(one,two)
                names(result) <- names(test)
                return(result)
                }
    )
) 
```

结果示例：

```
 X.1 X.2
[1,] 160  15
[2,]  47  81

     X.1 X.2
[1,] 127  48
[2,]  64  64 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-15T04:57:29.610

如果您的总样本量为 n= .. 说 40 并且单元格数是 4 列数 = 说 2 那么调用应该是：

```
rmultinom(2, size = 40/4, prob = c(0.5,0.5))
     [,1] [,2]
[1,]    6    3
[2,]    4    7 
```

如果您想要一个函数以每行指定的概率提供这种结果，那么：

```
 my_mat_rand <- function(tot, coln, probs){
     rmultinom(coln, size = tot/length(probs), prob = probs) }

> my_mat_rand(tot=40, coln=2, probs  = c(0.5,0.5))
     [,1] [,2]
[1,]   11   10
[2,]    9   10
> my_mat_rand(40, 2, probs  = c(0.5,0.5))
     [,1] [,2]
[1,]    8   13
[2,]   12    7 
```

如果您希望概率也是“随机的”，则使用`runif`指定第一个元素和 1-指定向量`that-value`的第二个元素。`probs`

# excel - Excel：Interior.ColorIndex 为同一索引产生不同的值

> ID：12031051
> 
> 赞同：2
> 
> 时间：2012-08-20T00:24:47.407
> 
> 标签：excel, vba, colors

我想将一系列单元格设置为具有灰色内部。我想要的灰色就在调色板上的黑色和白色之后（顶行，左起第三个）。

我手动将单元格的内部设置为此颜色，然后使用 vba 到 MsgBox ColourIndex。它提出了 19。但是，当我将单元格的 Interior.ColorIndex 属性设置为等于 19 时，单元格不是灰色，而是灰白色/奶油色。

以至于以下代码实际上将单元格（单元格 A1）的颜色从灰色变为奶油色：

```
Dim r As Range
Set r = Range("A1")

Dim n As Integer

n = r.Interior.ColorIndex

r.Interior.ColorIndex = n 
```

谁能解释一下？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:37:34.800

我相信`ColorIndex`只支持[有限数量](http://msdn.microsoft.com/en-us/library/office/cc296089%28v=office.12%29.aspx#xlDiscoveringColorIndex_ColorIndexProperty)的颜色。试试这个：

```
Dim r As Range
Dim n As Long ' The return values are large, so Integer will overflow

Set r = Range("A1")

' The color is 14806254
n = r.Interior.Color
r.Interior.Color = n 
```

或出于您的实际目的：

```
Dim myRange As Range
Dim n As Long

myRange = Range("A1:F1")
n = 14806254

' Color away!
For Each cell In myRange
  cell.Interior.Color = n
Next cell 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T00:37:45.440

您还需要设置主题颜色。

```
Dim r As Range
Set r = Range("A1")

Dim n As Integer

n = r.Interior.ColorIndex

With r.Interior
    .ColorIndex = n
    .ThemeColor = xlThemeColorDark2
End With 
```

# java - 如何从 Java 和 Javascript 生成相同的 cookie（不包含双引号）

> ID：12031053
> 
> 赞同：1
> 
> 时间：2012-08-20T00:25:58.483
> 
> 标签：java, javascript, cookies, urlencode

我尝试使从服务器端（在 Java 中）生成的 cookie 值与从这个[jquery 的 cookie 库](http://code.google.com/p/cookies/)生成的 cookie 值相同，它使用：

```
encodeURIComponent( value ) 
```

对 cookie 值进行编码。

让我们以这个示例字符串为例：

```
a b,c;d*~'"()!± 
```

我在 Java 中使用[此代码](https://stackoverflow.com/a/611117/843699)对 cookie 值进行编码：

```
String result = URLEncoder.encode(str, "UTF-8")
                          .replaceAll("\\+", "%20")
                          .replaceAll("\\%21", "!")
                          .replaceAll("\\%27", "'")
                          .replaceAll("\\%28", "(")
                          .replaceAll("\\%29", ")")
                          .replaceAll("\\%7E", "~"); 
```

然后我将 cookie 添加到响应中：

```
Cookie cookie = new Cookie("testCookieServerSide", encodeValue("a b,c;d*~'\"()!±"));
response.addCookie(cookie); 
```

这*会在值周围添加双引号！*：

```
"a%20b%2Cc%3Bd*~'%22()!%C2%B1" 
```

使用 jquery 库编码相同的值时，我得到相同的值但没有双引号：

```
a%20b%2Cc%3Bd*~'%22()!%C2%B1 
```

是否可以告诉 Java*不*生成双引号？我听说过*cookie.setVersion(0)*或*cookie.setVersion(1)*但这似乎并没有改变任何东西。

在服务器端检索这两个值时，它们在 a 之后是相同的：

```
URLDecoder.decode(cookie.getValue(), "UTF-8"); 
```

...双引号被删除。伟大的。

但是在客户端，*这两个值是不同的*！

```
alert($.cookies.get('testCookieServerSide')); => "a b,c;d*~'"()!±"
alert($.cookies.get('testCookieClientSide')); => a b,c;d*~'"()!± 
```

关于如何生成完全相同的值的任何想法？你如何处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T00:13:10.260

这是我找到的修复：

我没有找到任何方法告诉 Java 停止添加这些双引号，所以我不得不忍受它们。

我修改了我使用的[jquery 的 cookie 库](http://code.google.com/p/cookies/)，而不是像这样解码 cookie 值：

```
value = decodeURIComponent( pair[1] ); 
```

它用：

```
value = decodeURIComponent( pair[1].replace( /^"(.*)"$/, '$1' ) ); 
```

当到达这行代码时，cookie中的值仍然被编码（js库本身在客户端对其进行编码，我在服务器端使用Java对其进行编码，使用上面的代码）。所以值的开头和结尾的双引号，如果没有编码，*必然是Java添加的字符*......在获取值时必须将它们删除。

# python - set_alpha() 用于部分透明表面

> ID：12031057
> 
> 赞同：0
> 
> 时间：2012-08-20T00:27:13.523
> 
> 标签：python, pygame

我正在尝试这样做：

```
surface_with_text = pygame.font(params).render(params) # transparent bg
surface_with_text.set_alpha(100) # make it half transparent
another_surface.blit(surface_with_text) # blit onto image 
```

但是，当然，它默默地失败了 - 我的文字仍然完全不透明......为什么会这样？如何找到解决方法？

当然，我可以将“255 - 100”-transparent another_surface 复制到文本顶部，但这有什么好玩的，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T00:43:52.780

渲染的字体表面已经使用了每像素的 alpha 值（否则，它将具有纯色背景）。

从[`Font.render`文档](http://www.pygame.org/docs/ref/font.html#Font.render)：

> 如果背景是透明的，则将包含一个像素 alpha。

从[`set_alpha`文档](http://www.pygame.org/docs/ref/surface.html#Surface.set_alpha)：

> 此值不同于每个像素的 Surface alpha。如果 Surface 格式包含每像素 alpha，则此 alpha 值将被忽略。

# html - 如何围绕相关子元素扩展 HTML 容器对象

> ID：12031058
> 
> 赞同：1
> 
> 时间：2012-08-20T00:27:47.387
> 
> 标签：html, css, css-position

我有以下内容：

HTML：

```
<div class="banner-success"> 
    <span class="banner-text">
        You were successful! Yay! Some long reason what your success
        implies goes here.
    </span>
</div> 
```

CSS：

```
/*Add future banners to this style, this is generic banner styling*/
.banner-success
{
    background-position: 5px 5px;
    background-repeat: no-repeat;
    min-height: 42px;
    padding-left: 47px;
    margin-bottom: 10px;
}

/*Create a new entry in this section for each banner, with appropriate image and
colors*/
/*----------------------------------------------------------------------*/
.banner-success
{
    color: #004400;
    background-color: #DDF2E4;
    background-image: url("../Images/Success.gif");
}
/*----------------------------------------------------------------------*/

.banner-text
{
    position: relative;
    top: 5px;
} 
```

这允许一个标准横幅，每个横幅都有一个图像和任意文本行，假设图像大小一致。我的问题是 div 的大小就像里面的文本没有被按下一样，所以文本的底线到达了 div 的外面。

有没有办法告诉 div 或任何容器元素，“与你的组成元素一样大，在它们相对于你定位之后”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T03:57:05.827

适用`overflow:hidden`于.banner-success。

我做了一些调整以使文本周围的填充均匀（并替换背景图像，以便您可以看到它在适当的位置工作）：

[http://jsfiddle.net/qTsgL/](http://jsfiddle.net/qTsgL/)

干杯!

# gcc - gcc：双NULL哨兵属性？

> ID：12031059
> 
> 赞同：2
> 
> 时间：2012-08-20T00:27:58.403
> 
> 标签：gcc, attributes, sentinel

我有一个需要双 NULL 终止符的可变参数函数。

*人为的简化示例*

```
void makeLine(char *name, ...) {
    ... accepts (x,y) coordinates until (0,0) is found,
    ... assume that any coordinate except (0,0) is legal
            [i.e. (0,1) or (1,0) should not trigger a stop condition]
} 
```

我想用[来自 gcc的](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html)[*__attribute ((sentinel))__*](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html)对其进行注释。但似乎使用 sentinel 属性，只有一个参数可以要求为 NULL，而不是所需的*sentinel(0,1)* [最后两个要求为 NULL]。

有没有办法让 gcc 强制执行双 NULL，或者......

鉴于 NULL 只能对两个参数之一强制执行，你会用*sentinel(0)*或*sentinel(1)*装饰这个函数吗？为什么？这两个位置中的哪一个更容易捕获错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T13:23:15.257

在缺少任何两个标记的情况下，实现编译错误的唯一方法可能是使用 C99[可变参数宏](http://en.wikipedia.org/wiki/Variadic_macro)：

```
#include <stdio.h>
#include <stdlib.h>
#include <stdarg.h>

#pragma GCC diagnostic error "-Wformat"

void checkSentinel0(char * name, ...) __attribute__ ((sentinel(0)));
void checkSentinel1(char * name, ...) __attribute__ ((sentinel(1)));

void checkSentinel0(char * name, ...) {
    (void)name;
}
void checkSentinel1(char * name, ...) {
    (void)name;
}

#define MY_VARIADIC(name, ...) do {checkSentinel0(name, __VA_ARGS__);\
                                   checkSentinel1(name, __VA_ARGS__);\
                                       myVariadic(name, __VA_ARGS__);}\
                               while(0);

void myVariadic(char * name, ...) {
    // your code messing with coordinates and etc.
    (void)name;
}

int main () {

 MY_VARIADIC("test", 1,2,3,4, NULL, NULL); // Ok

 MY_VARIADIC("test", 1,2,3,4, 14,     15); // not compilable
 MY_VARIADIC("test", 1,2,3,4, NULL,   15); // not compilable
 MY_VARIADIC("test", 1,2,3,4, 15,   NULL); // not compilable

 return 0;
} 
```

因此，如果用户只接触到您的宏`MY_VARIADIC`，那么他/她将在忘记用两个空值终止参数列表的情况下出错。

# php - Mandrill 使用 SwiftMailer 报告？

> ID：12031062
> 
> 赞同：0
> 
> 时间：2012-08-20T00:29:11.850
> 
> 标签：php, swiftmailer

我正在通过 SwiftMailers 脚本连接到 Mandrill 的 SMTP，但我没有在 Mandrill 中看到我通过 Swift 发送的电子邮件的报告。为什么会这样？

这是我连接到 Mandrill 的代码（一切正常并按应有的方式发送邮件）

```
 include_once "../swift_required.php";
    $transport = Swift_SmtpTransport::newInstance('smtp.mandrillapp.com', 465, 'ssl');
    $transport->setUsername('our@email.com');
    $transport->setPassword('api-key-goes-here');
    $swift = Swift_Mailer::newInstance($transport); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T17:55:02.520

您需要设置 SMTP 标头：

```
$message = Swift_Message::newInstance();
$headers = $message->getHeaders();
$headers->addTextHeader('X-MC-Track', 'opens, clicks_htmlonly'); 
```

查看更多，[http://help.mandrill.com/entries/21688056-Using-SMTP-Headers-to-customize-your-messages](http://help.mandrill.com/entries/21688056-Using-SMTP-Headers-to-customize-your-messages)。

# ruby-on-rails - 如果我有一个来自 Charge 的 Stripe 令牌，我如何获得它的 Charge id？

> ID：12031063
> 
> 赞同：6
> 
> 时间：2012-08-20T00:29:37.390
> 
> 标签：ruby-on-rails, ruby, stripe-payments

现在我正在使用我的 Rails 应用程序成功收费，但我想获取有关交易的某些详细信息，例如商品购买的描述和信用卡的最后四位数字，以便在用户的收据页面上显示.

我一直在查看文档，但实际上没有任何内容可以解释如何为应用程序提供令牌并取回 Charge_id，然后我可以使用它来获取有关费用的其他信息的哈希值。

任何帮助都是巨大的。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T00:53:30.403

Stripe 在对费用创建调用的响应中返回费用 ID。如果您使用的是 Ruby 库，则可以执行以下操作来获取 ID：

```
require "stripe"
Stripe.api_key = '<your api key>'
charge = Stripe::Charge.create(
  :amount => 400,
  :currency => "usd",
  :card => "tok_JkdcRcQfyFsoZ2", # obtained with Stripe.js
  :description => "Charge for test@example.com"
) 
```

然后，您可以存储`charge.id`并使用[Charge Retrieve 调用](https://stripe.com/docs/api#retrieve_charge)来查找费用详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-12T19:15:40.070

Stripe 的德克斯特刚刚证实：

> 不幸的是，目前没有办法从令牌中收取费用。

**解决方法**：如果您有令牌的时间戳，则可以使用它来查找费用。

# html - 下载顺序 - 可以设置？

> ID：12031064
> 
> 赞同：3
> 
> 时间：2012-08-20T00:29:43.393
> 
> 标签：html, image

我知道这个问题的答案很可能是不……但我想问。

可以先下载一个img吗？

基本上我有一个占位符 GIF（在下载图像时显示在图像的位置，我希望尽快下载该 GIF。

我能以某种方式快速跟踪一个 img（GIF）的下载吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T00:37:25.877

尝试在所有其他标签之前放置`<img>`带有 gif 的标签并将其隐藏`src``<img>``visibility:hidden`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T00:35:40.073

您可以将该图像包含为数据 URI（如果它不是太大），这样就不会发出单独的网络请求来获取该图像。当然，它会增加实际提供的 HTML 内容的大小。

您还可以通过创建新的图像对象并设置`src`属性来使用 JavaScript 预加载图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T00:43:38.740

您可以尝试在该 gif 之前动态加载您不想加载的所有内容（并且在大小上有些显着）。然后，您可以加载该 gif，并在完成后 - 加载其余内容。

这可以使用 Javascript 来完成。我不确定是否已经有一个库可以帮助您轻松地做到这一点，但这应该不会太难。

我会开始使用类似“在 document.ready 上，加载那个重要的 gif，然后在完成后，加载其余部分”这样的东西：

```
$(document).ready( function() {
    var myImportantImg = $('<img />');
    $(myImportantImg).on('load', function() { 
        // attach myImportantImg somewhere
        // load rest
    });
    $(myImportantImg).attr('src', 'http://url.to/myImg.gif');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T00:54:25.490

从我读到的结合使用[Data URI Scheme](http://en.wikipedia.org/wiki/Data_URI_scheme)和 css 将是一个不错的选择：

```
img.placeholder {
    background: white url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAABlBMVEUAAAD///+l2Z/dAAAAM0lEQVR4nGP4/5/h/1+G/58ZDrAz3D/McH8yw83NDDeNGe4Ug9C9zwz3gVLMDA/A6P9/AFGGFyjOXZtQAAAAAElFTkSuQmCC') no-repeat scroll left top;
} 
```

将上述代码包含在`<style>`文档 - 部分的 -tag 中，`<head>`以确保它与页面一起加载，并使用`placeholder`-class 标记适当的图像：

```
<img src="..." class="placeholder"> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-20T00:43:32.407

您可以有占位符 gif，例如（在 css 中）

```
img{background-image:url(default_image.png)} 
```

但是，没有好的方法可以强制一个图像在另一个图像之前加载。浏览器可以按他们想要的任何顺序加载。

您可以使占位符更有可能首先下载：

*   如果占位符在所有页面上都相同，它可以被缓存，这样在下一页上，它已经被加载了

*   确保占位符图像位于页面的早期（使浏览器更早开始加载，浏览器可能会按照它们在 html 中出现的顺序加载图像）。如果图像不应该在那里显示，只需执行诸如 width="0" 或 visibility: hidden; 之类的操作。

*   将占位符放在服务器可以快速提供服务的位置（避免动态控制文件夹 - 在静态目录中提供，例如在 Apache 的 public/ 文件夹中）

*   使占位符图像变小

*   通过设置缓存头来鼓励缓存，以便图像在很远的将来（例如 1 年）过期，并且浏览器不需要与服务器进行检查。还要确保关闭图像的私有缓存（允许公共服务器缓存）。

数据 URI 并不是那么好。来自**维基百科**：

> *   数据 URI 不会与其包含的文档（例如 CSS 或 HTML 文件）分开缓存，因此每次重新下载包含的文档时都会下载数据。
>     
>     
> *   从同一个文档中多次引用同一个资源（例如嵌入的小图像）会导致嵌入资源的多个副本。相比之下，一个外部资源可以被任意多次引用，但只能下载和解码一次。

如果您在页面的 10 个位置使用占位符图像，您将拥有一个更大的页面。

# iphone - 来自另一个 UITableViewCell 的数据在当前单元格中重复

> ID：12031066
> 
> 赞同：1
> 
> 时间：2012-08-20T00:29:57.887
> 
> 标签：iphone, ios, uitableview

重用我的自定义 UITableViewCell 时，不会为当前单元格重置所有数据。为特定的 UILabel 插入来自重用单元的数据。

我有一个菜肴的表格视图。菜品有评论。我想在 tableviewcell 中显示每道菜的评论。根据有多少评论，我只在每个单元格中制作那么多评论标签。然而，当一个单元格被重用时，错误的评论——来自不同盘子的评论——就会出现。

我正在使用 CoreData，一个 Dish 有很多评论，假设我只想显示前两条评论。

我在 IB 中创建了两个高度和宽度为零的 UILabel，以便它调整每个评论的长度。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath    *)indexPath
{
    DishCell *cell = [tableView dequeueReusableCellWithIdentifier:@"DishCell"];
    [self configureCell:cell atIndexPath:indexPath];
    return cell;
}

- (void)configureCell:(UITableViewCell *)cell atIndexPath:(NSIndexPath *)indexPath
{ ...I put all of the Dishes in a NSFetchedResultsController instance so *dish is a NSManagedObject that has many comments

      NSSet *commentsSet = dish.comments;
      NSSortDescriptor *sortByDate = [[NSSortDescriptor alloc]initWithKey:@"date"  ascending:YES];
      NSArray *commentArray = [commentsSet sortedArrayUsingDescriptors:[NSArray arrayWithObject:sortByDate]];

     if (commentsSet.count< 1) {
        dishCell.comment1label.text = @"";
        dishCell.comment2label.text = @"";
     }else {

    Comment *comment = [commentArray objectAtIndex:0];

    NSString *commenterName = comment.displayName;
    NSString *commentString = comment.commentText;
    NSString *text = [NSString stringWithFormat:@"%@: %@", commenterName, commentString];

    CGSize comment1Size = [text sizeWithFont:[UIFont systemFontOfSize:10.0f] constrainedToSize:CGSizeMake(constraint.width - dishCell.commentBubble.frame.size.width + 4, constraint.height) lineBreakMode:UILineBreakModeWordWrap];

    //Ignore this setFrame - it works
    [dishCell.comment1label setFrame:CGRectMake(32, faveIconYpos - 2 + dishCell.favIcon.frame.size.height, 298 - dishCell.commentBubble.frame.size.width, comment1Size.height + 2)];

    dishCell.text = text;

    if (commentsSet.count > 1) {
        Comment *comment2 = [commentArray objectAtIndex:1];
        [dishCell.comment2label setTextColor:[UIColor whiteColor]];
        [dishCell.comment2label setFont:[UIFont systemFontOfSize:12.0]];

        NSString *text2 = [NSString stringWithFormat:@"%@: %@", comment2.displayName, comment2.commentText];

        CGSize comment2Size = [text2 sizeWithFont:[UIFont systemFontOfSize:10.0f] constrainedToSize:CGSizeMake(constraint.width - dishCell.commentBubble.frame.size.width + 4, constraint.height) lineBreakMode:UILineBreakModeWordWrap];
        [dishCell.comment2label setFrame:CGRectMake(32, faveIconYpos + dishCell.favIcon.frame.size.height + dishCell.testcom.frame.size.height - 2, 298 - dishCell.commentBubble.frame.size.width, comment2Size.height + 2)];
        dishCell.comment2label.text = text2; 
    } 
```

我已经解析了一些代码，但主要的是来自另一个单元格的数据被插入到我的标签中。为什么会这样？

# mysql - MYSQL - 数据库设计 大规模现实世界部署

> ID：12031067
> 
> 赞同：1
> 
> 时间：2012-08-20T00:31:25.547
> 
> 标签：mysql, database-design

我很想听听一些关于 mysql 数据库设计的意见或想法。

基本上，我有一个 tomcat 服务器，它从现场大约 1000 个系统接收不同类型的数据。这些系统中的每一个都是独特的，并且将报告独特的数据。

发送的数据可以分为频繁数据和不频繁数据。不经常发送的数据每天只发送一次，变化不大 - 它基本上只是基于配置的数据。

频繁数据，系统开启时每 2-3 分钟发送一次。并表示系统的当前状态。

这些数据需要为每个系统建立数据库，并且可以在任何给定时间从 php 页面访问。基本上对于该领域的任何系统，PHP 页面都需要能够访问该客户端系统上的所有数据并显示它。换句话说，数据库需要显示系统的状态。

信息本身都是基于文本的，而且有很多。配置数据（变化不大）是键值对，目前大约有 100 个。

我的设计理念是拥有 100 多列，每个系统有 1 行来保存配置数据。但我担心有这么多列，主要是因为如果我将来需要添加列，这不是太面向未来。如果我这样做，我也担心插入速度。这可能会爆发到一个 2000 行 x 200 列的表，每秒访问大约 100 次，所以我需要在我的初始设计中满足这一点。

我还想知道，是否有任何设计理念可以满足基于引擎的频繁更改和很少更改的数据。这是有道理的，因为我想保持插入/更新时间较短，而且我不太关心 php 的 SELECT 时间。

我也很想知道如何拆分数据。即，如果可以以几种不同的方式对频繁更改的数据进行分类，我应该有一堆表，代表数据并在选择时加入它们吗？我对此很担心，因为我可能必须制作一份报告来显示所有系统之间的共同属性（即显示具有特定条件的所有系统）。

我希望我在这里提供了足够的信息，以便有人指出我正确的方向，任何关于此事的帮助都会很棒。或者，如果有人做过类似的事情并且可以提供建议，我将非常感激。谢谢大家:)

~ 丹

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T01:46:52.240

我在评论中发布了一些问题。如果不了解您正在尝试做什么，就很难为您提供有关快速变化的数据的建议。

对于您的配置数据，不要使用包含 100 列的表格。众所周知，宽表在生产中难以处理。相反，请使用包含这些列的四列表：

```
SYSTEM_ID  VARCHAR    System identifier
POSTTIME   DATETIME   The time the information was posted
NAME       VARCHAR    The name of the parameter
VALUE      VARCHAR    The value of the parameter 
```

这些列中的前三列是您的复合主键。

这种设计的优点是它会随着您添加（或减少）配置参数集而增长（或缩小）。它还允许存储历史数据。这意味着可以插入新数据点而不是更新数据点，这样更快。您可以运行每日或每周作业来删除您不再有兴趣保留的历史记录。

（如果您真的不需要历史记录，请***编辑***`INSERT ON DUPLICATE KEY UPDATE`，删除 POSTTIME 列并在发布内容时使用 MySQL 的不错的扩展功能。请参阅[http://dev.mysql.com/doc/refman/5.0/en/insert-on -duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html) )

如果您快速变化的数据在形式（名称/值对）上与您的配置数据相似，您可以使用类似的模式来存储它。

您可能想为这些东西使用 MEMORY 访问方法创建一个“当前数据”表。MEMORY 表的读写速度非常快，因为数据都在 MySQL 服务器的 RAM 中。缺点是 MySQL 崩溃和重启会给你一个空表，之前的内容会丢失。（MySQL 服务器很少崩溃，但当它们崩溃时，它们会丢失 MEMORY 表的内容。）

如果您需要保存历史记录，您可以运行偶尔的作业（每隔几分钟或几小时）将 MEMORY 表的内容复制到磁盘表中。

（***编辑***：您将来可能会考虑将 memcached [http://memcached.org/](http://memcached.org/)添加到您的 Web 应用程序系统中以处理高读取率，而不是为版本 1 构建处理高读取率的数据库设计。这样您可以查看您的整体应用程序设计的哪些部分难以扩展。我希望过去有人说服我这样做，而不是为早期版本过度设计。）

# .net - 在 GridView 中为不同的 SQL 查询显示不同的列

> ID：12031068
> 
> 赞同：1
> 
> 时间：2012-08-20T00:31:42.647
> 
> 标签：.net, c#-4.0, gridview

如果 GridView 绑定到具有 select 语句的 SqlDataSource 控件，如果稍后以编程方式更改该 select 语句以选择一组不同的列，则 GridView 将产生错误，错误是

> “System.Data.DataRowView”不包含名称为 [An Expected Column Name] 的属性

如何不时执行不同的选择语句，返回不同的列并在 GridView 中显示它们的结果？

谢谢

# database-design - 在 Redis 等键/值数据库中对数据进行分组

> ID：12031071
> 
> 赞同：3
> 
> 时间：2012-08-20T00:32:42.583
> 
> 标签：database-design, nosql, redis, methodology

我正在尝试在 Redis 数据库中对类似于 amazon.com 类别（例如，书籍、电影、电子产品等）的数据进行建模。当它们在 HTML 页面上呈现时，顺序对我很重要，以便向用户呈现一致的用户界面。因此，我将类别存储在排序集中：

```
ZADD categories 0 "Books"
ZADD categories 1 "Movies"
ZADD categories 2 "Electronics" 
```

然后，我为每个子类别创建了另一个排序集。

```
ZADD categories:books 0 "Fiction"
ZADD categories:books 1 "Non-Fiction"
ZADD categories:movies 0 "Horror"
[...] 
```

从这里，我想我可以将产品存储在哈希中。

```
HMSET product:1000 category 0 subcategory 0 title "Redis Cookbook"
HMSET product:1001 category 1 subcategory 0 title "Nightmare on Elm Street"
[...] 
```

我对 Redis 和 Key/Value 数据库存储都很陌生，所以我对自己的方法毫无信心。这个模型对我有用吗？有没有我应该注意的更好/替代方法？我担心的一个问题是保持名称“同步”。例如，如果我将顶级类别从“书籍”更改为“文学”（我知道这是个糟糕的例子），那么“参考”书籍的子类别的所有键也*应该*更新。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T11:11:09.383

让我们倒过来回答你的问题。

> > 将产品存储在哈希中

那是一个好主意。通常，您希望将实体存储在哈希图中。

> > 更改类别名称

您应该为每个类别使用一个内部标识符。然后将类别显示名称存储在哈希图中，就像存储产品一样。这种间接方式很有用——因为它允许您存储类别的附加信息。例如，如果您稍后决定为每个类别显示“最受欢迎的产品”，那么这样的模式将很有用。

> > 按类别存储产品

您可以创建一个类似的密钥`category:books:products`，然后存储每个产品的 ID。这可以是列表、集合或排序集 - 取决于您要对数据执行的操作。

1.  如果产品有内在顺序，例如最近添加的产品，那么使用 List 是有意义的。这样，列表中的第一个元素就是最新的产品。
2.  如果您希望按照“下载次数最多”或“浏览次数最多”等标准对产品进行排序，则应使用排序集。
3.  如果类别中的产品之间没有其他关系，请使用 Set。

使用`Set`or`SortedSet`可以让您执行交叉点。当您需要项目的子集时，这些会派上用场，例如“O'Reilly 出版的图书”。为此，您必须维护另一个包含图书 ID 的集合“publisher:preilly”。

> > 存储类别的集合

现在，您建议了 a `SortedSet`，这是一种可能的解决方案。但是，如果类别的顺序不会动态更改，您也可以使用列表。例如，如果您总是想按升序显示类别，列表就足够了。

如果顺序会动态变化，SortedSet 证明是有用的。例如，如果您想根据每个类别中的产品数量来显示类别 - 那么将它们存储在 SortedSet 中是一个好主意。

另外，请记住，您可以使用多个列表或排序集 - 每个集合可以代表不同的用例。假设您不想向海外客户出售书籍。在这种情况下，您可以使用另一个键`categories:overseas`并存储要显示的类别。

# delphi - 处理 Unix 和 DOS 文件

> ID：12031076
> 
> 赞同：2
> 
> 时间：2012-08-20T00:35:05.077
> 
> 标签：delphi

我的应用程序处理文本文件，这些文件有时在 WINdwos 系统和有时在 Linux 上生成。

处理两个行尾的最小努力方法是什么？

也就是说，对于每一行，我都想得到一个去掉行尾的字符串。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T01:17:12.920

`TStringList`可以很好地处理 Windows 和 Linux 行尾。

```
program TestLFs;

{$APPTYPE CONSOLE}
uses
  Classes;

var
  SL: TStringList;
  s: string;
begin
  SL := TStringList.Create;
  try
    SL.LoadFromFile('YourUnixFile.txt');
    for s in SL do
      WriteLn(s);
    SL.LoadFromFile('YourWindowsFile.txt');
    for s in SL do
      WriteLn(s);
  finally
    SL.Free;
  end;
  ReadLn;
end. 
```

# javascript - 简单的 onclick 不提交

> ID：12031080
> 
> 赞同：0
> 
> 时间：2012-08-20T00:37:02.850
> 
> 标签：javascript, django, twitter-bootstrap

我在这个[博客](http://blog.oscarcp.com/?p=163)上发现了这个很棒的代码片段，可以将语言选择器更改为更时尚的东西。（记住 Twitter 引导程序）

它看起来很整洁，但是当我实际单击选择时，**onclick**没有提交任何内容。我还不是 jquery 方面的专家，但是在最新的 1.8.0 版本中是否已经弃用了某些东西，从而阻止了它`onclick`的工作？

```
<form name="setLang{{ lang.1}}" action="/i18n/setlang/" method="POST">{% csrf_token %}
   <input name="next" type="hidden" value="{{ redirect_to }}" />
   <input type="hidden" name="language" value="{{ lang.0 }}" />
   <a href="#" onclick="document.setLang{{ lang.1 }}.submit(); return false;">{{ lang.1 }}</a>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:43:17.493

你不能`document.setLang{{ lang.1 }}`用来获取`form`. 这**不是**DOM 元素的有效名称。JavaScript 将在遇到的第一个空格处中断处理，并抛出错误。

我强烈建议你使用一个有效的`name`值，但如果你真的需要继续使用它，你可以使用`document.getElementsByName("setLang{{ lang.1}}")[0].submit()`.​​​​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T00:45:25.250

您的表单名称中包含空格这一事实意味着您无法以您想要的方式访问 DOM 中的表单项。我会给表单一个不包含空格的 id 并以这种方式访问​​它。

```
<form name="setLang{{ lang.1}}" id="setLang" action="/i18n/setlang/" method="POST">{% csrf_token %}
   <input name="next" type="hidden" value="{{ redirect_to }}" />
   <input type="hidden" name="language" value="{{ lang.0 }}" />
   <a href="#" onclick="document.setLang.submit(); return false;">{{ lang.1 }}</a>
</form> 
```

另外，请参见此处： [使用 javascript 访问 HTML 输入字段 - 输入名称中的空格](https://stackoverflow.com/questions/8038274/accessing-html-input-fields-with-javascript-spaces-in-input-name)

# bash - 使用 Bash 重命名文件，删除前缀和后缀

> ID：12031081
> 
> 赞同：8
> 
> 时间：2012-08-20T00:37:16.110
> 
> 标签：bash, shell, file-rename

我想使用 bash 重命名一堆文件，转换这个文件模式：

```
prefix - name - suffix.txt 
```

进入这个：

```
name.txt 
```

为此，我编写了以下脚本：

```
find . -name "*.txt" | while read f
do
  mv "${f}" "${f/prefix - /}"
done

find . -name "*.txt" | while read f
do
  mv "${f}" "${f/ - suffix/}"
done 
```

它有效，但我想使用单个循环执行重命名。可能吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-20T01:28:25.830

另一种有趣的方法是使用正则表达式：

```
regex='prefix - (.*) - suffix.txt'
for f in *.txt; do
    [[ $f =~ $regex ]] && mv "$f" "${BASH_REMATCH[1]}.txt"
done 
```

* * *

实际上，在这里使用简单的模式 '*.txt' 有两个问题：

1.  它太宽泛了；您可能需要将正则表达式应用于许多不匹配的文件。
2.  如果当前目录中有*很多*文件，命令行可能会溢出。

使用`find`使过程复杂化，但更正确：

```
find . -maxdepth 1 -regex 'prefix - .* - suffix.txt' -print0 | \
  while read -d '' -r; do
   [[ $REPLY =~ $regex ]] && mv "$REPLY" "${BASH_REMATCH[1]}.txt"
  done 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T01:21:05.980

如果您有权访问`GNU sed`，则可以使用一些正则表达式来执行以下操作：

```
for i in *.txt; do mv "$i" "$(echo $i | sed -r 's/([^-]*)\s-\s(.*)\s-\s([^-]*)\.txt/\2.txt/')"; done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T03:17:07.977

如果你已经`emacs`安装了。您可以使用该`dired`功能。

## 在`bash`：

```
# open your dir with emacs
emacs /path/to/your/dir 
```

## 在`emacs`：

*   按标记所有文件。`*``%``Enter`**`\.txt$`**`Enter``txt`
*   按重命名。`%``r``Enter`**`.*- \(.*\) -.*`**`Enter`**`\1.txt`**`Enter`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T01:29:49.137

你可以使用这个：

```
find . -name "*.txt" -print0 | awk -v RS="\0" -v ORS="\0" '{print $0;sub(/^prefix - /,""); sub(/ - suffix.txt$/,".txt"); print $0; }' | xargs -0 -n 2 mv 
```

可以更清楚地写成：

```
find . -name "*.txt" -print0 |
awk -v RS="\0" -v ORS="\0" '{
  print $0;
  sub(/^prefix - /,""); 
  sub(/ - suffix.txt$/,".txt"); 
  print $0;
}' |
xargs -0 -n 2 mv 
```

# python - Python 中的类混淆与 getattr

> ID：12031088
> 
> 赞同：0
> 
> 时间：2012-08-20T00:39:10.910
> 
> 标签：python, class, python-2.7, self, getattr

[此处](https://stackoverflow.com/questions/11838075/when-a-function-in-a-class-returns-a-value-where-is-it-returned-to)提出了类似的问题。然而，这些回答并没有真正帮助我理解程序的某些部分是如何工作的。程序如下：

```
from sys import exit
from random import randint

class Game(object):

    def __init__(self, start):
        self.pie = [ 'pie test']

        self.start = start

    def play(self):
        next_room_name = self.start
        while True:
            print "\n--------"
            room = getattr(self, next_room_name)
            next_room_name = room()

    def rooom(self):
        print "Test worked. good job"
        return "piez"

    def piez(self):
        print "pie room"
        exit(1)

a_game = Game("rooom")
a_game.play() 
```

第一个问题是以下如何工作？

```
def play(self):
        next_room_name = self.start

        while True:
            print "\n--------"
            room = getattr(self, next_room_name)
            next_room_name = room() 
```

我知道以下内容以某种方式生成了房间名称，因此程序可以转到它需要的位置。我只是没有看到它是如何发生的。

我的第二个问题是：

```
self.start = start 
```

我有点理解 self.pie 正在做的事情。但我不确定 self.start = start 应该完成什么。再次感谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T00:47:52.390

假设您有这样的课程：

```
class DummyClass(object):

    awesome = True

    def not_awesome(self):
        self.awesome=False 
```

对此使用 getattr 完全等同于使用点语法，例如

```
dumb = DummyClass()
print getattr(dummy, "awesome") # True
print dummy.awesome # True 
```

您也可以将其与方法一起使用：

```
dumb = DummyClass()
no_more_awesome = getattr(dummy, "not_awesome") # returns the not_awesome method of dummy
print dummy.awesome # True
no_more_awesome()
print dummy.awesome # False 
```

因此，在您发布的代码片段中，`getattr(self, next_room_name)`获取带有名称的方法`next_room_name`并返回要调用的函数（绑定到自身）。您在这里使用变量而不是点语法，因为您事先不知道名称。考虑以下两个片段来获得这一点（与重叠有点混淆......对不起）：

```
dummy = DummyClass()
awesome = "not_awesome"
print dummy.awesome # True
print getattr(dummy, awesome) # string with something like <bound method ... > 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T10:26:58.520

首先：对象初始化。`Game("rooom")`调用时，字符串绑定`"rooom"`到 的参数`start`。`__init__`该语句`this.start = start`只是将字符串存储`"rooom"`在内部对象字典中，可通过`this.start`.

然后`play()`方法被调用：`getattr`在这个上下文中的用法定义了一个名为[Pluggable Selector](https://www.google.it/search?q=pluggable%20selector&sugexp=chrome,mod=6&sourceid=chrome&ie=UTF-8)的模式。换句话说，不是显式说明要调用哪个方法，而是存储方法的名称是一个变量（`next_room_name`在这种情况下）。

要调用的第一个方法是`rooom`因为局部变量`next_room_name`（方法范围的局部变量）在 while 循环之前`play`被初始化。`self.start`

方法调用的返回值用于更新`next_room_name`变量，因此在`rooom`执行后，值变为`"piez"`. 因此，下一个要调用的方法将是`piez`.

最后，当`piez`执行时，调用`exit(1)`，因此解释器终止，不再执行代码。在这种情况下，没有更多代码执行的原因是`sys.exit`引发了一个`SystemExit`异常（参见[文档](http://docs.python.org/library/sys.html#sys.exit)），该异常在任何地方都没有被捕获。

# javascript - 如何在javascript中识别函数的参数名称？

> ID：12031091
> 
> 赞同：10
> 
> 时间：2012-08-20T00:39:50.073
> 
> 标签：javascript, dependency-injection, angularjs

在 AngularJS 中，这两个控制器声明是等价的：

```
function BlahCtrl($scope, $http) { ... }
function BlahCtrl($http, $scope) { ... } 
```

无论它们的顺序如何`$http`，两者`$scope`都是正确的变量。即，命名的变量`$http`将始终传递给`$http`服务的实例。

Angular 是如何知道要传入哪些对象以及以什么顺序传入的？我认为这种反射在 javascript 中是不可能的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-20T01:39:31.073

如果你调用`toString`一个函数，你会得到那个函数的 js 声明：

```
function a(b,c) {}

a.toString();  // "function a(b,c){}" 
```

然后您可以解析字符串以获取参数的顺序。

[对角度源代码](https://github.com/angular/angular.js/blob/master/src/auto/injector.js#L41)的一些调查证实了这一点：

```
if (typeof fn == 'function') {
  if (!($inject = fn.$inject)) {
    $inject = [];
    fnText = fn.toString().replace(STRIP_COMMENTS, '');
    argDecl = fnText.match(FN_ARGS);
    forEach(argDecl[1].split(FN_ARG_SPLIT), function(arg){
      arg.replace(FN_ARG, function(all, underscore, name){
        $inject.push(name);
      });
    });
    fn.$inject = $inject;
  }
} 
```

他们对函数进行字符串化，然后使用正则表达式提取参数并将它们存储在数组中。

[jsFiddle](http://jsfiddle.net/Zzfnf/)展示了这一切是如何工作的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-20T01:16:16.277

虽然我不知道*他们*是如何做到的，但有一种简单的方法可以做到。

JS 中的一切都有`toString()`方法。对于函数，它显示了该特定函数的源代码（对于内置函数，您可能会得到类似的东西`function() { [native code] }`）。

让我们找到包含函数参数的 first`(`和 first 。`)`然后，让我们去掉空格并将参数拆分为`,`. 瞧，我们得到了一组参数名称。

```
function a($scope, $http) { };
function b($http, $scope) { };

function getParameterList(f) {
  var s = f.toString();

  var start = s.indexOf('(');
  var end = s.indexOf(')');

  s = s.substring(start + 1, end);

  return s.replace(/ /g,'').split(',');
} 
```

所以让我们测试一下：

```
var aParams = getParameterList(a);
var bParams = getParameterList(b); 

alert(aParams[0]); // $scope
alert(aParams[1]); // $http 

alert(bParams[0]); // $http
alert(bParams[1]); // $scope 
```

小提琴：http: [//jsfiddle.net/jYPB8/](http://jsfiddle.net/jYPB8/)

但是，请注意，这种行为`toString()`是在中定义的，`Function.prototype`并且可能会被重新定义——在这种情况下，该算法将不起作用。

因此，虽然这可能不是您正在寻找的实际解决方案，但我想向您展示这种反射在 JavaScript 中**是**可能的，而且实际上非常简单：)

# objective-c - 这是 NSThread 在 Objective-C 中可接受的习语吗？

> ID：12031092
> 
> 赞同：0
> 
> 时间：2012-08-20T00:39:57.327
> 
> 标签：objective-c, nsthread, gnustep

我有一个基于代理的小型建模框架，我正在编写它作为项目的一部分。不同的代理都在自己的线程中运行，主管类控制它们的生命周期。所以主管类可以取消这些线程。我知道有一种`isCancelled`方法`NSThread`。使用它，是否可以接受以下成语：

```
#import <Foundation/Foundation.h>
#import "BugThread.h"
#import "Bug.h"

@implementation BugThread

- (id) initWithBug: (Bug*) aBug {

    if((self = [super init])) {
        [bug autorelease];
        bug = [aBug retain];
    }

    return self;
}

- (void) main {

    GSRegisterCurrentThread();

    while(![self isCancelled]) {
        //bug does its stuff
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T00:46:35.183

我会这么说，因为这在[文档](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSThread_Class/Reference/Reference.html#//apple_ref/doc/uid/20000311-SW3)中明确说明：

> 如果您的线程支持取消，它应该定期调用此方法并在返回 YES 时退出。

不过，我建议您看一下`NSOperation`and `NSOperationQueue`。它们旨在在代表您管理实际线程时完全允许这种并发性。请参阅并发编程指南中的[“操作队列”](http://developer.apple.com/library/mac/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationObjects/OperationObjects.html%23//apple_ref/doc/uid/TP40008091-CH101-SW1)。

# php - MySQL 更新正在更改输入变量

> ID：12031094
> 
> 赞同：0
> 
> 时间：2012-08-20T00:40:18.257
> 
> 标签：php, mysql, forms, post

我正在尝试使用输入表单更新 MySQL 表中的几列。我编写的代码基本上是查找 MySQL 表中的所有值，并将它们作为 HTML POST 表单中的值打印回来。然后，用户可以将值更改为任何值，并在 PHP 中处理 POST 数据并更新表。一切似乎都有效，除了一列它采用我输入的值并用其他东西替换它们。例如，当我输入 600 时，它输入为 6.00。如果我输入 500，它将作为 5.00 输入。这是我用来更新列的方法：

```
//$D is the array length of $cash_ID
$i = 0;
while($i < $D){
        if(!mysql_query('UPDATE ' .$tablename_cash. ' SET cash_amnt = "' .$cash_amnt[$i]. '" WHERE ID = ' .$cash_ID[$i]))
                die('Error: ' .mysql_error());
        $i++;
} 
```

我相信我已经弄清楚它为什么会这样做，但我不确定如何解决它。在这个特定的表上，ID 值从 6 开始（一些元素不久前被删除），而所有其他表从 ID = 1 开始。我不确定为什么这会导致问题，因为我的印象是 MySQL只需查找 WHERE 子句给出的行。如果需要，我可以分享我的完整代码。有什么建议么？

# android - as3 Air for Android 下载和保存远程文件

> ID：12031095
> 
> 赞同：3
> 
> 时间：2012-08-20T00:40:21.667
> 
> 标签：android, actionscript-3, flash, filereference

下面的代码使用 as3 Air For Android 从服务器下载 mp3 到您的手机。我想稍后在应用程序中使用这些文件，所以我有以下问题：

**如何使文件保存到 android 应用程序中的特定文件夹，而不是打开一个框供用户选择位置？**

```
import flash.net.FileReference;

/// It can be an mp3,jpg, png, etc... just change the url
/// and the extension name. nice huh?
var yourFileLocation = "http://YourWeb.com/YourSong.mp3";
var yourFileName = "YourSong.mp3";

var daFile:FileReference = new FileReference();
daFile.download(new URLRequest(yourFileLocation), yourFileName); 
```

当它开始、停止和进展时，监控这个进度也很不错，但我认为 eventListener 可能会处理它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T17:06:46.277

以下代码从远程 url 下载 mp3 并创建一个名为**.007**的文件夹（您可以更改名称或添加多个文件夹或不添加文件夹）。然后它保存到该位置。

```
import flash.filesystem.*;
/// Change the line below to point to your mp3 online
var urlString:String = "http://YourWebsite.com/YourSound.mp3";
var urlReq:URLRequest = new URLRequest(urlString);
var urlStream:URLStream = new URLStream();
var fileData:ByteArray = new ByteArray();
urlStream.addEventListener(Event.COMPLETE, loaded);
urlStream.load(urlReq);

function loaded(event:Event):void
{
    urlStream.readBytes(fileData, 0, urlStream.bytesAvailable);
    writeAirFile();
}

function writeAirFile():void
{ 
    // Change the folder path to whatever you want plus name your mp3
    // If the folder or folders does not exist it will create it.
    var file:File = File.userDirectory.resolvePath(".007/Yahoo.mp3");
    var fileStream:FileStream = new FileStream();
    fileStream.open(file, FileMode.WRITE);
    fileStream.writeBytes(fileData, 0, fileData.length);
    fileStream.close();
    trace("The file is written.");
} 
```

**PS 记得在应用程序中使用 Android 授予正确的权限**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T09:43:19.613

## 我到处寻找有关如何下载等的答案...

我个人更喜欢从 Greenshocks AS3 库中下载任何带有 LoaderMax 的文件（由于它是一个轻量级的加载器，它已经包含在我的大多数项目中。

* * *

我没有指定一个本地 URL，而是指定一个远程 URL .. lemme 向您展示一些代码：

```
public function downloadTxtJpgMp3():void
{
    var queue:LoaderMax = new LoaderMax();
    emptyLoader();    //this emptys the loader from previous attempts to load any files

    queue.append( new DataLoader("http://www.70disco.com/lyrics/delegation_you_and_I.txt",{name:"test_txt" ,format:"text", estimatedBytes:4000})  );
    queue.append( new ImageLoader( "http://4.bp.blogspot.com/-WQ3uAvGdPS0/UOB_OPS6rcI/AAAAAAAAKkU/HYaXXHVHTqc/s1600/whatever-dude-whatever.jpg" , {name:"test_img" , estimatedBytes:77000, container:this, alpha:0, scaleMode:"proportionalInside"}) );
    queue.append( new MP3Loader( "http://nocturno.nsk.pt/otherpages/funny/mp3/2001-02/Cebola%20Mol/Cebola%20Mol%20-%20Satright%20No%20Chaser%20II.mp3" , {name:"test_mp3" , repeat:0, autoPlay: false}) );  

    queue.addEventListener(LoaderEvent.COMPLETE, onDownloadComplete);
    queue.load();
} 
```

下面是 COMPLETE 事件的处理程序。您还可以为您命名的 ERROR、FAIL、PROGRESS 等设置处理程序。

```
protected function onDownloadComplete(event:LoaderEvent):void
{
    var objects:Array = event.currentTarget.content ;

    var firstObjectILoaded: String      //txt
    var secondObjectILoaded:Bitmap      //jpg
    var thirdObjectILoaded: Sound       //mp3

    // ContentDisplay is found within greenshock

    firstObjectILoaded = objects[0];
    secondObjectILoaded = ((objects[1] as ContentDisplay).rawContent as Bitmap)
    thirdObjectILoaded = objects[2];

    trace(firstObjectILoaded);
    thirdObjectILoaded.play();
} 
```

请记住，LoaderMax 并不真正关心文件是本地文件还是远程文件，它只是将其加载到内存中。

* * *

从那时起，您可以决定是将其保存为文件还是仅使用它然后丢弃它。

如果要将其保存为文件，方法如下：（下面的 iOs 示例）

```
var str:String = File.applicationDirectory.nativePath;

//in iOs you can save on 4 different folder directories (according to apples rules)
// cache, temp, app support, and user documents (i don't cover this below)

appCache = new File(str +"/\.\./Library/Caches");       //cache folder (in which you put files that you dont care being erased. the iOs might delete those files in case of low memory
appTempData = new File(str +"/\.\./tmp");               //temp folder (just files you temporarily want to store
appData = new File(str +"/\.\./Library/Application\ Support");      //any file your application NEEDS in order to operate, this can't be deleted by the os

var fr:FileStream = new FileStream();

fr.open(
    appTempData     //  appTempData or appCache or appData or userDocs
    .resolvePath("myCache.txt"),FileMode.WRITE); 
fr.writeUTFBytes("works");
fr.close(); 
```

* * *

# php - 使用 Phantom 的网页 HTML

> ID：12031096
> 
> 赞同：2
> 
> 时间：2012-08-20T00:40:23.747
> 
> 标签：php, javascript, node.js, screen-scraping, phantomjs

我正在尝试使用 PhantomJS 加载页面（使用 Javascript 在网页上加载项目）并将页面上的所有 HTML（至少在`<body />`标签内）返回给执行的 PHP 函数`phantomjs httpget.js`。

**问题：**我可以让 phantomjs 返回`document.title`，但要求它`console.log(document.body)`简单会给我一个`[object Object]`. 如何提取页面的 HTML？

*与浏览器相比，使用 phantomjs 加载网页也需要更长的时间*。

**httpget.js**

```
console.log('hello!');
var page = require('webpage').create();
page.open("http://www.asos.com/Men/T-Shirts-Vests/Cat/pgecategory.aspx?cid=7616#parentID=-1&pge=0&pgeSize=900&sort=1",
    function(status){
        console.log('Page title is ' + page.evaluate(function () {
            return document.body;
        }));
        phantom.exit();
    }); 
```

**输出** *（从外壳运行）*

```
hello!
Page title is [object Object] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:58:56.793

`document.body.innerHTML`包含正文的 HTML。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T20:15:33.970

不确定这与 Node.js 有什么关系，因为您似乎直接使用 PhantomJS，而不是 node（或通过 node-phantom 幻像）...

但要回答你的问题，你需要这样做：

```
var html = page.evaluate(function () {
    var root = document.getElementsByTagName("html")[0];
    var html = root ? root.outerHTML : document.body.innerHTML;
    return html
}); 
```

这适用于没有外部 <html> 标记的页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T02:37:53.990

阅读文档，`page.content`获取整个 HTML。

# javascript - Javascript滚动到底部生成重复请求

> ID：12031097
> 
> 赞同：0
> 
> 时间：2012-08-20T00:40:39.090
> 
> 标签：javascript, duplicates

我有以下用于创建一种无限滚动 UI 的 javascript 代码。问题是当我用鼠标滚轮滚动时，它会产生几个请求。

样品[在这里](http://uat.bb10backgrounds.com/jmastest2.html)

```
var canLoad = true;

$(window).scroll(function()
{ 
    if($(window).scrollTop() == $(document).height() - $(window).height() && canLoad)
    {
    canLoad = false;
            $('div#loadmoreajaxloader').show();
        $.ajax({
        url: "/loadmore.html",
        success: function(html)
        {
            if(html)
            {
            var $html = $(html);
            $html.imagesLoaded(function() {
                $('div#loadmoreajaxloader').hide();
                $("#container").masonry('appended', $html, true);
            }).appendTo($("#container"));
            }else
            {
                $('div#loadmoreajaxloader').html('<center>No more backgrounds to show.</center>');
            }
        }
        });
        canLoad = true;
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:44:48.603

您最好的选择是在您的`scroll`函数中使用计时器，并在每次请求之前取消它：

```
var timer;

$(window).scroll(function()
{
    timer && clearTimeout(timer);

    timer = setTimeout(function()
    {
        // Run whatever code you want here...
    }, 300);
}); 
```

这是小提琴：http: [//jsfiddle.net/FcxSL/](http://jsfiddle.net/FcxSL/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T00:49:55.817

我读错了你的问题，

这是你需要做的，确保当你在你的 ajax 内容中给一个 ajaxed div 一个 id 。然后你放一个 if 语句

检查该元素是否存在，如果存在，它将不再执行发布请求，如果它不在 dom 中，它将执行请求。

# ruby-on-rails - Rails gem simple_form - :wrapper_html 出现在编译的 CSS 中

> ID：12031098
> 
> 赞同：1
> 
> 时间：2012-08-20T00:40:41.197
> 
> 标签：ruby-on-rails, simple-form

我设置了以下表单以将 Twitter 引导样式与 simple_form gem 一起使用。但是，正如您在下面看到的，“wrapper_html”命令在编译后的 css 中可见，并且未应用 Twitter 引导样式。有谁知道出了什么问题？

```
<div class="formbox">
<h2>Sign Up To Hang Out With Some Losers<h2>
<%= simple_form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f| %>
  <%= devise_error_messages! %>
  <%= f.input :email, :label => false, :placeholder => 'youremail@example.com', :wrapper_html => { :class => 'paddingmarg'} %>

  <%= f.submit "Get an invite", :wrapper_html => { :class => 'btn.btn-primary', :id => "invitation_button" } %>

  <% end %>
</div> 
```

编译后的 CSS....

```
<input name="commit" type="submit" value="Get an invite" wrapper_html="{:class=&gt;&quot;btn.btn-primary&quot;, :id=&gt;&quot;invitation_button&quot;}"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T01:04:54.540

答案是 submit 不使用 :wrapper_html 因为它不是输入的。

class 和 id 应该像这样直接传递。

```
<%= f.submit "Get an invite", :class => 'btn.btn-primary', :id => "invitation_button"  %> 
```

# php - 如何覆盖位于我的模块文件夹中的备用模板 (.tpl.php) 文件的路径？

> ID：12031103
> 
> 赞同：0
> 
> 时间：2012-08-20T00:42:07.610
> 
> 标签：php, drupal, drupal-7, drupal-modules, drupal-theming

我想为特定页面创建自定义主题。（例如 www.domain.com/roster/%/home）为此，我创建了以下文件并将其放在当前主题（bartik）的模板文件夹中：page--roster--home.tpl.php .

它根据需要覆盖默认主题，但我想将与我的模块相关的所有文件保留在其文件夹中。

我的问题是，我怎样才能将文件放在我的模块文件夹中并且仍然让 Drupal 7 拾取它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T09:51:55.430

使用主题（）

```
return theme('some_theme_function_template', array('aValues' => $someArray)); 
```

然后你需要像这样使用主题钩子：

```
function my_module_name_theme() {
    return array(
        'some_theme_function_template' => array(
            'template' => 'mytheme',
        ),
    );
} 
```

它现在在你模块的根目录中搜索 mytheme.tpl.php。

# python - 每次调用函数时随机化一个函数

> ID：12031104
> 
> 赞同：0
> 
> 时间：2012-08-20T00:42:22.493
> 
> 标签：python, random, python-3.x

每次调用时，如何让 Python 3 从列表中随机选择一个项目？我有两个需要执行此操作的功能。我已经尝试过 item = random.randint() 和 item = random.choice()，但那些只会将其随机化一次然后将其存储到 item 中。

这是两个函数。使用函数 1，我需要在每次调用它时随机化该项目，因此玩家每次都会获得一个随机项目。对于功能 2，我需要玩家和老鼠的攻击在我选择的数字内随机化。所以每当玩家攻击时，它在 10 到 30 之间，而当老鼠攻击时，它在 10 到 15 之间。它必须每回合都这样做。

这可能吗？

功能 1。

```
def chest(sector):
    item = random.choice(items)
    print("You see a chest, you unlock it and inside is '{0}'".format(item))
    print()
    if item in inventory:
        print("You already have a {0}".format(item))
    item_take = input("Do you wish to take the '{0}'?: ".format(item)).lower()
    if item_take == ("yes"):
        inventory.append(item)
        if item == "Armor":
            player["hp"] = 150
        print("The {0} has been added to your inventory!".format(item))
        sector()
    else:
        print("You don't take the '{0}'!".format(item))
        print()
        sector() 
```

功能2。

```
player = dict(
    name = " ",
    att = random.randint(10, 30),
    hp = 100,)

rat = dict(
    name = "Rat",
    att = random.randint(10, 15),
    hp = 20,)

def attack(player, enemy):
    firstAtt = random.randint(1, 2)#Player = 1, Enemy = 2\. Checks to see who goes first.
    if firstAtt == 1:
        while player["hp"] > 0 and enemy["hp"] > 0:
            enemy["hp"] = enemy["hp"] - player["att"]
            print("You have dealt {0} damage to the {1}!".format(player["att"], enemy["name"]))
            if enemy["hp"] <= 0:
                print()
                print("You have killed the {0}".format(enemy["name"]))
                print("You have {0}HP left.".format(player["hp"]))
                break

            player["hp"] = player["hp"] - enemy["att"]
            print("The {0} has dealt {1} damage to you!".format(enemy["name"], enemy["att"]))
            if player["hp"] <= 0:
                print()
                print("The {0} has killed you!".format(enemy["name"]))
                break

    elif firstAtt == 2:
        while player["hp"] > 0 and enemy["hp"] > 0:
            player["hp"] = player["hp"] - enemy["att"]
            print("The {0} has dealt {1} damage to you!".format(enemy["name"], enemy["att"]))
            if player["hp"] <= 0:
                print()
                print("The {0} has killed you!".format(enemy["name"]))
                break

            enemy["hp"] = enemy["hp"] - player["att"]
            print("You have dealt {0} damage to the {1}".format(player["att"], enemy["name"]))
            if enemy["hp"] <= 0:
                print()
                print("You have killed the {0}".format(enemy["name"]))
                print("You have {0}HP left.".format(player["hp"]))
                break 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:46:01.317

`chest()`很好。

对于`attack()`，将`att`元素转为函数，然后酌情调用。

```
 att=lambda: random.randint(...),

 ...

      dmg = player['att']()
       ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T08:16:45.210

除非您尝试完全无类（可能作为课堂作业或作为理解函数式编程或字典的练习），否则这是 Python 类大量清理您的代码的情况。这也有许多连锁反应。例如，在这段代码中，我可以轻松访问最小和最大攻击值，可能会显示在棋盘上的角色标记或攻击对话框中。这是一个准系统示例，您需要对其进行扩展并进一步修改以满足您的需要。就个人而言，我会包含一个“take_damage”函数来处理攻击造成的伤害（这样，如果我想要或在它们自己的函数中执行其他与伤害相关的效果，我可以根据所承受的伤害减少 atk_min 或 atk_max）和每个变量，我都会有另一个“当前”

```
from random import randint
class Character():
    def __init__(self, name, atk_min, atk_max, hp):
        self.name = name
        self.atk_min = atk_min
        self.atk_max = atk_max
        self.hp = hp

    def attack(self):
        return randint(self.atk_min, self.atk_max)

rat = Character('rat', 10, 15, 20)
player = Character('Player', 15, 30, 100) 
```

我知道代码更长，但更容易发现，Future You 会感谢 Current You 2 年后（从一个我让他坐了 2 年的问题上写了近 2,000 行杂乱代码的人那里得到它没有看它。我不得不把它全部扔掉，因为我不再知道它应该做得足够好来智能地改变它）。

# java - 多个线程修改相同的命令属性

> ID：12031106
> 
> 赞同：3
> 
> 时间：2012-08-20T00:42:35.127
> 
> 标签：java, multithreading, thread-safety, threadpool, threadpoolexecutor

**问题陈述：-**

在我下面的程序中，我使用`ThreadPoolExecutor`的是`ArrayBlockingQueue`.

每个线程每次都需要使用一个`UNIQUE ID`并且它必须运行`60 minutes or more`，所以`60 minutes`有可能所有这些`ID's will get finished`我都需要再次重用这些ID。所以我在`ArrayBlockingQueue`这里使用概念。

两种情况：-

1.  如果`command.getDataCriteria()`包含`Previous`，那么每个线程总是需要使用`UNIQUE ID between 1 and 1000`并释放它以再次重用。
2.  否则，如果`command.getDataCriteria()`包含`New`，则每个线程总是需要使用`UNIQUE ID between 2000 and 3000`并释放它以再次重用。

**我目前在以下程序中面临什么问题-**

> 我面临的一个问题是

*   如果`run method`是那么它`command.getDataCriteria()`也会`Previous`进入`else if block(which is for New)`不应该发生的情况，对吗？我也在做一个`.equals check`？为什么会这样？可能是因为许多线程会同时启动并且之前已经修改了命令？

`else if(command.getDataCriteria().equals("New")) {`

如果多线程正在修改它，那么我该如何克服这个问题？无论发生什么问题，它都发生在`run method`. 任何建议都会有很大帮助，因为我长期以来一直坚持这一点。可能我们需要`Synchronize the threads, so that no other thread should modify the command when another thread is trying to execute it.`

```
public synchronized void runNextCommand() {

LinkedList<Integer> availableExistingIds = new LinkedList<Integer>();
LinkedList<Integer> availableNewIds = new LinkedList<Integer>();

executorService = new ThreadPoolExecutor(noOfThreads, noOfThreads, 500L, TimeUnit.MILLISECONDS,
        new ArrayBlockingQueue<Runnable>(noOfThreads), new ThreadPoolExecutor.CallerRunsPolicy());

    // If there are any free threads in the thread pool
    if (!(((ThreadPoolExecutor) executorService).getActiveCount() < noOfThreads))
    return;

    for (int i = 1; i <= 1000; i++) {
    availableExistingIds.add(i);
    }

    for (int n = 2000; n <= 3000; n++) {
    availableNewIds.add(n);
    }

    BlockingQueue<Integer> existIdPool = new ArrayBlockingQueue<Integer>(1000, false, availableExistingIds);
    BlockingQueue<Integer> newIdPool = new ArrayBlockingQueue<Integer>(1001, false, availableNewIds);

    // Running for particular duration of time
    while(System.currentTimeMillis() <= endTime) {
    Command nextCommand = getNextCommandToExecute();
    Task nextCommandExecutorRunnable = new Task(nextCommand, existIdPool, newIdPool);
    executorService.submit(nextCommandExecutorRunnable);
    }

    executorService.shutdown();
    if (!executorService.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS)) {
    executorService.shutdownNow();
    }
} 
```

runnable的实现（真正的单元级命令执行器）

```
private static final class Task implements Runnable {
private Command command;
private DPSclient m_DPSclient = null;
private DPSclient psc = null;
private BlockingQueue<Integer> existPool;
private BlockingQueue<Integer> newPool;
private int existId;
private int newId;
private static Object syncObject = new Object();  

public Task(Command command, BlockingQueue<Integer> pool1, BlockingQueue<Integer> pool2) {
    this.command = command;
    this.existPool = pool1;
    this.newPool = pool2;
}

public void run() {

  synchronized(syncObject) {
    if(command.getDataCriteria().equals("Previous")) {
    try {
        // Getting existing id from the existPool
        existId = existPool.take();
        attributeGetSetMethod(existId);
    } catch (Exception e) {
        getLogger().log(LogLevel.ERROR, e.getLocalizedMessage());
    } finally {
        // And releasing that existing ID for re-use
        existPool.offer(existId);       
    }
} else if(command.getDataCriteria().equals("New")) {
     try {
        // Getting new id from the newPool
        newId = newPool.take();
        attributeGetSetMethod(newId);
    } catch (Exception e) {
        getLogger().log(LogLevel.ERROR, e.getLocalizedMessage());
    } finally {
        // And releasing that new ID for re-use
        newPool.offer(newId);   
    }
    }
}
  }
} 
```

我将感谢您对此的帮助。谢谢

**`getNextCommandToExecute method`更新 -马特建议的代码**

```
// Get the next command to execute based on percentages
    private synchronized Command getNextCommandToExecute() {
    int commandWithMaxNegativeOffset = 0; // To initiate, assume the first one has the max negative offset
    if (totalExecuted != 0) {
        // Manipulate that who has max negative offset from its desired execution
        double executedPercentage = ((double)executedFrequency[commandWithMaxNegativeOffset] / (double)totalExecuted) * 100;
        double offsetOfCommandWithMaxNegative = executedPercentage - commands.get(commandWithMaxNegativeOffset).getExecutionPercentage();

        for (int j=1; j < commands.size(); j++) {
        double executedPercentageOfCurrentCommand = ((double)executedFrequency[j] / (double)totalExecuted) * 100;
        double offsetOfCurrentCommand = executedPercentageOfCurrentCommand - commands.get(j).getExecutionPercentage();

        if (offsetOfCurrentCommand < offsetOfCommandWithMaxNegative) {
            offsetOfCommandWithMaxNegative = offsetOfCurrentCommand;
            commandWithMaxNegativeOffset = j;
        }
        }
    }

    // Next command to execute is the one with max negative offset
    executedFrequency[commandWithMaxNegativeOffset] ++;
    totalExecuted ++;

    // This is for User Logging/No User Logging and Data is Previous/New
    LinkedHashMap<String, Double> dataCriteriaMap = (LinkedHashMap<String, Double>) sortByValue(commands.get(commandWithMaxNegativeOffset).getDataUsageCriteria());
    Set<Map.Entry<String, Double>> entriesData = dataCriteriaMap.entrySet();
    Iterator<Map.Entry<String, Double>> itData = entriesData.iterator();
    Map.Entry<String, Double> firstEntryData = itData.next();
    Map.Entry<String, Double> secondEntryData = itData.next();

    LinkedHashMap<Boolean, Double> userCriteriaMap = (LinkedHashMap<Boolean, Double>) sortByValue(commands.get(commandWithMaxNegativeOffset).getUserLoggingCriteria());
    Set<Map.Entry<Boolean, Double>> entriesUser = userCriteriaMap.entrySet();
    Iterator<Map.Entry<Boolean, Double>> itUser = entriesUser.iterator();
    Map.Entry<Boolean, Double> firstEntryUser = itUser.next();
    Map.Entry<Boolean, Double> secondEntryUser = itUser.next();

    double percent = r.nextDouble() * 100;

    if (percent < secondEntryData.getValue().doubleValue()) {
        commands.get(commandWithMaxNegativeOffset).setDataCriteria(secondEntryData.getKey());
    } else {
        commands.get(commandWithMaxNegativeOffset).setDataCriteria(firstEntryData.getKey());
    }

    if (percent < secondEntryUser.getValue().doubleValue()) {
        commands.get(commandWithMaxNegativeOffset).setUserLogging(secondEntryUser.getKey());
    } else { 
        commands.get(commandWithMaxNegativeOffset).setUserLogging(firstEntryUser.getKey());
    }

    return commands.get(commandWithMaxNegativeOffset);
    } 
```

并且命令已在类的顶部声明为-

```
private static List<Command> commands; 
```

**更新另一种方法：-**

```
private synchronized void attributeGetSetMethod(int id_range) {

        requestlTransaction requestlTransaction = null;
        try {
        GUID_VALUES = new LinkedHashMap<Integer, String>();

        // I am not sure how CAL logging has to be done, it has to be at each attribute level or something else? So that is the reason I left this thing.

        if(!(command.getAttributeIDSet().isEmpty())) {

            requestlTransaction = requestlTransactionFactory.create("DPSLnPTest");
            m_DPSclient = setupDPS(command.getName(), getDPSAttributeKeys(command.getDataCriteria(), command.getUserLogging() , id_range));

            for(String attr: command.getAttributeIDSet()) {

            requestlTransaction.setName("DPSAttributeSet");
            requestlTransaction.setStatus("0");
            //requestlTransaction.addData("IpAddress", ipAddress);

            if(attr.contains("/")) {
                lengthOfString = Integer.parseInt(attr.split("/")[1]);
                attr = attr.split("/")[0];
            }
            DPSAttribute attr1 = new DPSAttribute();
            attr1.setRequestAttributeId(new DPSAttributeId(Integer.parseInt(attr)));
            DPSMetadataMgr mgr = DPSMetadataMgr.getInstance();
            DPSRequestAttributeMetadata metadata = mgr.getRequestAttributeMetadataById(Integer.parseInt(attr));
            int maxOccurs = metadata.getMaxOccurs();
            String dataType = metadata.getAttributeTypeAlias();

            DPSAttributeValue attrValue1 = getRequestAttribute(dataType, lengthOfString);

            if(maxOccurs>1) {
                DPSListAttributeValue listAttrValue = new DPSListAttributeValue();
                List<DPSAttributeValue> list = new ArrayList<DPSAttributeValue>();
                list.add(attrValue1);
                listAttrValue.setList(list);
                attr1.setRequestAttributeValue(listAttrValue);
                m_DPSclient.setDPSAttribute(attr1);
            } else {
                attr1.setRequestAttributeValue(attrValue1);         
                m_DPSclient.setDPSAttribute(attr1);
            }
            }

            List<DPSAttribute> idKeys = m_DPSclient.release(PersistenceEnum.COMMIT, false);

            // Iterating through the keys and storing into HashMap
            Iterator<DPSAttribute> i = idKeys.iterator();
            while (i.hasNext()) {
            DPSAttribute DPSAttribute = (DPSAttribute)(i.next());
            DPSAttributeId id = DPSAttribute.getAttributeId();
            DPSAttributeValue value = DPSAttribute.getRequestAttribute();

            if(id.getId() == DPSLnPConstants.CGUID_ID && (value)!= null) {
                DPSLnPConstants.CGUID_VALUE = ((DPSStringAttributeValue)value).getValue();
                GUID_VALUES.put(DPSLnPConstants.CGUID_ID, DPSLnPConstants.CGUID_VALUE);
            } else if(id.getId() == DPSLnPConstants.SGUID_ID && (value)!= null) {
                DPSLnPConstants.SGUID_VALUE = ((DPSStringAttributeValue)value).getValue();
                GUID_VALUES.put(DPSLnPConstants.SGUID_ID, DPSLnPConstants.SGUID_VALUE);
            } else if(id.getId() == DPSLnPConstants.PGUID_ID && (value)!= null) {
                DPSLnPConstants.PGUID_VALUE = ((DPSStringAttributeValue)value).getValue();
                GUID_VALUES.put(DPSLnPConstants.PGUID_ID, DPSLnPConstants.PGUID_VALUE);
            } else if(id.getId() == DPSLnPConstants.UID_ID && (value)!= null) {
                DPSLnPConstants.UID_VALUE = String.valueOf(((DPSLongAttributeValue)value).getValue());
                GUID_VALUES.put(DPSLnPConstants.UID_ID, DPSLnPConstants.UID_VALUE);
            } else if(id.getId() == DPSLnPConstants.SITE_ID && (value)!= null) {
                DPSLnPConstants.SITEID_VALUE = String.valueOf(((DPSIntAttributeValue)value).getValue());
                GUID_VALUES.put(DPSLnPConstants.SITE_ID, DPSLnPConstants.SITEID_VALUE);
            } else if(id.getId() == DPSLnPConstants.ALOC_ID && (value)!= null) {
                DPSLnPConstants.ALOC_VALUE = ((DPSStringAttributeValue)value).getValue();
                GUID_VALUES.put(DPSLnPConstants.ALOC_ID, DPSLnPConstants.ALOC_VALUE);
            } else if(id.getId() == DPSLnPConstants.ULOC_ID && (value)!= null) {
                DPSLnPConstants.ULOC_VALUE = ((DPSStringAttributeValue)value).getValue();
                GUID_VALUES.put(DPSLnPConstants.ULOC_ID, DPSLnPConstants.ULOC_VALUE);
            } else if(id.getId() == DPSLnPConstants.SLOC_ID && (value)!= null) {
                DPSLnPConstants.SLOC_VALUE = ((DPSStringAttributeValue)value).getValue();
                GUID_VALUES.put(DPSLnPConstants.SLOC_ID, DPSLnPConstants.SLOC_VALUE);
            } else if(id.getId() == DPSLnPConstants.PLOC_ID && (value)!= null) {
                DPSLnPConstants.PLOC_VALUE = ((DPSStringAttributeValue)value).getValue();
                GUID_VALUES.put(DPSLnPConstants.PLOC_ID, DPSLnPConstants.PLOC_VALUE);
            }
            }

            // Storing all the locators, guid in a map corresponding to an ID, then later on insert everything directly into db
            GUID_ID_MAPPING.put(id_range, GUID_VALUES);

            // Sleeping the command for particular milliseconds
            // One thing not sure, I should be sleeping the command here or I should put it above this comment line '// Iterating through the keys'
            Thread.sleep(command.getSleepTime());
        } 

        // for get attributes   
        // And also how CAL logging has to be done here too. And we can use same DPS Smart Client that got created above to get the attributes value?

        if(!(command.getAttributeIDGet().isEmpty())) {

            requestlTransaction.setName("DPSAttributeGet");
            requestlTransaction.setStatus("1");
            psc = setupDPS(command.getName(), getDPSAttributeKeys(command.getDataCriteria(), command.getUserLogging() , id_range));

            for(String attr: command.getAttributeIDGet()) {
            DPSAttribute attribute = new DPSAttribute();
            attribute = psc.getDPSAttribute(new DPSAttributeId(Integer.parseInt(attr)));
            //System.out.println(attribute.getAttributeId()+ " " +attribute.getRequestAttribute());
            }
        }
        } catch(Exception e) {
        getLogger().log(LogLevel.ERROR, e);
        } finally {
        requestlTransaction.completed();
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:31:22.150

从我可以看到是否`command.getDataCriteria()`应该只由一个线程访问，那么它的值不应该由于线程同步问题而改变。假设这一点，我们希望确保没有两个线程获得对象实例的句柄。

您有`synchronized getNextCommandToExecute()`，但没有证据表明`commands`根据您的定义同步您的 Collection `private static List<Command> commands;`。如果上述假设成立，我们希望保证没有两个线程可以`get()`从 Collection 中获得相同的对象实例。

代码中的其他地方是`commands`从哪里访问 Collection 的？

如果`commands.get()`可以正确同步，则返回的实例不应该有任何线程争用。哪个线程得到的是一个对象拥有它。

...*随时告诉我我在叫错树*

**[编辑]**关注您的评论

我很难确定出了什么问题，因为我没有所有代码并且需要做出假设。在我看来，您`synchronized`在许多方法上添加了关键字并期望它能够解决您的问题。我认为最好的方法是尽量减少真正需要同步的代码行，这需要更清楚地了解真正需要同步的内容。

1.  您不想`Command`跨线程共享对对象的引用，因此请确保您的 get() 和 add() 操作`List<Command> commands`是同步的。您可以使用[synchronizedList](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#synchronizedList%28java.util.List%29)或[ConcurrentLinkedQueue](http://docs.oracle.com/javase/6/docs/api/index.html?java/util/concurrent/ConcurrentLinkedQueue.html)

2.  你能让 Command 对象不可变吗？（即没有 setX() 方法）

# asp.net-mvc - 在 MVC 4 应用程序中使用 DotNetOpenAuth 进行 Github 身份验证

> ID：12031107
> 
> 赞同：1
> 
> 时间：2012-08-20T00:42:44.823
> 
> 标签：asp.net-mvc, authentication, github, dotnetopenauth

DotNetOpenAuth 默认带有 Facebook、Twitter、Google、Microsoft 和 Yahoo 授权。如果我想使用 OAuth 添加 Github 授权，我应该从哪里开始。我不知道从哪里开始。尝试了他们的文档，但一无所获。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:59:07.650

编辑：我编写了一个 Github 客户端示例并将其托管在... github 上。我还没有测试它，但它应该是一个很好的起点。[https://github.com/cvlad/GithubOAuthClient/blob/master/GithubClient.cs](https://github.com/cvlad/GithubOAuthClient/blob/master/GithubClient.cs)

如果我猜的话，我会从实现`DotNetOpenAuth.AspNet.Clients.OAuthClient`or开始`OAuth2Client`。它有两种方法：`RequestAuthentication`和`VerifyAuthentication`。

之后，我会使用`Microsoft.Web.WebPages.OAuth.RegisterClient`.

如果我被卡住了，我会检查来源`DotNetOpenAuth.AspNet.Clients.WindowsLiveClient`或任何其他客户。

您还可以检查当前提供程序的实现，您可以在此处找到：[https ://github.com/AArnott/dotnetopenid/tree/master/src/DotNetOpenAuth.AspNet/Clients](https://github.com/AArnott/dotnetopenid/tree/master/src/DotNetOpenAuth.AspNet/Clients)

# algorithm - 用于估计具有异构迭代的时间密集型循环的剩余时间的算法

> ID：12031118
> 
> 赞同：5
> 
> 时间：2012-08-20T00:44:17.990
> 
> 标签：algorithm, time, progress-bar

我有一个指令循环，例如（伪代码）：

```
for i = 1 to 1000000
    // Process the ith input
    doSomething(input[i])
end 
```

这需要很长时间才能完成。我想向用户输出一些进度，更重要的是剩余时间估计，以便他们可以决定是否应该坐在那里玩弄拇指，去喝杯咖啡，去散步，或者去一个一周的假期到欧洲，而算法处理它的数字。

为了简化问题，您可以假设迭代次数会很大（例如，大于 100，因此您可以在每个百分位打印进度）。

一种常见的算法是简单地测量最后一次迭代所用的时间，然后将其乘以剩余的迭代次数并将其作为输出。如果每次迭代在执行所需的时间上可能有很大差异，这就会崩溃。

另一种方法是将自第一次迭代以来经过的时间除以完成的迭代次数，然后将其乘以剩余的迭代次数。如果迭代的持续时间不是均匀分布的，这就会崩溃。例如，如果前几个输入是“困难的”并且在接近输入数组的末尾变得更容易，则算法将高估剩余时间，直到它几乎完成（此时它会略微高估）。

那么，当每次迭代所花费的时间是迭代纵坐标的非直接的、任意的函数（这样简单地分析推导和实现每次迭代的完成时间是不切实际的）时，如何才能更好地估计剩余时间?

我可以想象的两个想法可能是富有成效的研究途径，但目前无法充分探索自己：

*   完成每个过去迭代的时间乘以剩余迭代的指数平均值。
*   用于完成每次迭代的跟踪时间，然后拟合函数并进行外推。

**为什么计算密集型解决方案（如拟合方程）可以：**

首先，对于值得讨论的真正大型任务，运行时间可能以小时或天为单位来衡量。现在复杂的数学运算需要几毫秒，所以增加的负担不会很大——在我上面的例子中，显然`doSomething`需要很长时间才能使做一些数学的成本相形见绌，否则我不会太在意精确估计剩余时间第一名。

其次，例如，可以将迭代分箱成百分位数。然后，估计器不会对“完成的迭代与所用时间”的数据集进行操作，而是对最多具有 100 个数据点的“完成百分比与所用时间”的数据集进行操作。这提供了进一步的复杂性：假设您的任务需要一天或更长时间才能完成。仅估计剩余时间的每一个百分比是完整的，这意味着对估计函数进行 100 次评估。当你已经花了一天的时间，额外的一分半钟来估计剩余时间没什么大不了的，但这已经给了你一个 1 秒的窗口来拟合方程，还有什么不是 - 1 秒是做数学*的很多*时间在现代系统上。因此，我欢迎计算密集型解决方案。

**tl;dr：**如何为非常冗长的任务过度设计一个准确的剩余时间估计函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T04:20:11.933

如果您想获得始终如一的良好预测，那么第二种方法（拟合和外推）可能会做得最好 - 但前提是拟合函数与作为索引函数的处理时间的真实依赖性合理匹配。例如，如果 f(n) 是 O(n^2) 算法，则预测

```
for i = 1 to N
  f(i) 
```

大约需要 k*N^3 时间来解决。因此，将三次拟合到总时间应该提供一个很好的近似值，但拟合二次或指数可能比简单的完成百分比近似更差。同样，如果 f 为 O(2^n)，则任何多项式拟合都会大大低估剩余时间。这一切都假设 N 足够大，以至于真正的 O(n^2) 行为占主导地位。

因此，虽然精心选择的拟合函数应该能够准确预测剩余时间，但通用预测函数不太可能有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T05:33:37.180

除了 Penguino 的算法：您可能想要拟合 log(n) 和 log(f(n))，而不是拟合 n 和 f(n)。只要您的复杂性是多项式的，这将起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T01:07:53.060

我以前做过这样的事情。我发现创建一个非常准确的时间估计的最简单方法是（再次，在 p 代码中）：

```
initTime = getTime()
for i = 0 to maxIter
    doSomething()
    remainTime = convertToHoursMinutes(((getTime - initTime)/i)*maxIter)
next 
```

这样，每次迭代你的“平均”时间就会减少，并且在 30-50 次迭代之后，你的用户可能对剩余时间有一个很好的了解（最终，中心极限定理开始发挥作用）。

# php - while ($row = $result->fetch_object()) 是如何工作的？

> ID：12031119
> 
> 赞同：2
> 
> 时间：2012-08-20T00:44:20.940
> 
> 标签：php, mysql, mysqli

今天早上我在看一个关于 PHP MySQLi 的教程系列，我发现了一些该系列的作者没有解释的代码。我以前看过这段代码，但从来不知道它是如何工作的......

```
while ($row = $result->fetch_object()) {
    // set up a row for each record
    echo "<tr>";
    echo "<td>" . $row->id . "</td>";
    echo "<td>" . $row->firstname . "</td>";
    echo "<td>" . $row->lastname . "</td>";
    echo "<td><a href='records.php?id=" . $row->id . "'>Edit</a></td>";
    echo "<td><a href='delete.php?id=" . $row->id . "'>Delete</a></td>";
    echo "</tr>";
} 
```

我知道它将一个表与 MySQL 查询的 $result 的结果拼凑在一起，但我没有得到的是，while 循环如何在参数内部进行赋值？

我试图回显 $row = $result->fetch_object() 但它没有在屏幕上显示任何内容。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T00:46:27.183

这是一个标准的 fetch 循环，大多数 PHP 数据库 API 使用它从结果资源中检索行。 [`mysqli_result::fetch_object()`](http://php.net/manual/en/mysqli-result.fetch-object.php)将下一行检索到泛型类型的对象中`stdClass`，其属性具有查询返回的列的名称。您可以查看其内容`var_dump($row);`

当结果资源用完行时，它将返回`FALSE`，导致`while`循环终止。这种模式在 PHP 中很常见——一些数据库 API 将提供一种额外的方法来抽象 fetch 循环，只需从单个函数调用返回一个结果数组，但这在大型数据集上可能会导致内存效率低下。有时最好在要使用它们时从数据库中一次检索一行。当您调用`fetch_object()`或调用它的亲戚时，您实际上是在与 MySQL 通信并请求它为 PHP 提供另一行。简单地调用`query()`实际上并不会将任何行发送回 PHP。

在这种情况下，是否使用`fetch_object()`或`fetch_assoc()`（对于关联数组）实际上只是样式问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T00:48:16.630

调试查询不要使用 echo。

使用 var_dump() 或 print_r()

您所做的所有查询都是循环并创建用 sql 表中的数据填充的表行。

这

```
while ($row = $result->fetch_object()) { 
```

只是生成一个变量 $row 设置为 1 条记录的内容（从技术上讲，使用 JOIN 时，它有超过 1 条真正的“记录”，但我怀疑你在这里使用它），然后当你循环遍历时，你正在打印列的值$行->标识。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T00:52:19.757

让我们解开线路中发生的事情；

> 而 ($row = $result->fetch_object()) {

*   `$row = $result->fetch_object()`实际上是一个变量赋值。我怀疑这个`$result`变量是一个mysql资源，它是`[mysql_query][1]`
*   有一个循环，由`while`.
*   在内部，`fetch_object`将遍历 mysql 返回的行，直到没有更多行，此时，`fetch_object`将 return `false`，从而结束循环。
*   `echo`'ed时没有结果的原因`$row = $result->fetch_object()`是，因为它是一个变量赋值，所以没有输出。要调试，您应该尝试`var_dump($result);`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T01:18:07.600

PHP 遵循 C 的语法，赋值运算符的结果是左操作数的值。来自 C 标准：

> 赋值运算符将值存储在左操作数指定的对象中。赋值表达式在赋值后具有左操作数的值，但不是左值。

可以这样想：当你执行 $x == 5 时，结果要么为真，要么为假。当您执行 $x + 5 时，结果是 $x 增加了 5。赋值运算符以类似的方式工作。当您执行 $x = 5 时，结果为 5（$x 的新值）。您可以通过以下方式进行检查：

```
$x = 0;
echo $x = 5;
echo "\n";
echo $x += 100; 
```

这将显示“5”和“105”。

这种语法有点令人困惑，因为我们通常只关心 = 运算符的副作用（将某些内容存储到变量中）而不是其结果（之后的变量值）。不过，这种`while($var = f()) { }`结构相当普遍，因为有时我们需要同时进行赋值并检查结果。构造循环的另一种方法是使用无限循环：`for (;;) { $row = $result->fetch_object(); if(!$row) break; ... }`但这看起来很难看。

当您这样做时没有显示任何内容的原因`$row = $result->fetch_object()`可能是因为所有行都已被检索并且 fetch_object() 返回 false。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-20T00:50:50.280

为了扩展 while 循环的工作原理， fetch_object() 成员函数为结果集中的下一行返回一个对象，如果没有更多行，则返回一个假值。

当没有更多对象时，while 循环将终止，因为

```
$row = $result->fetch_object() 
```

将 $row 设置为一个虚假值，然后由 while 循环评估为

```
while (false) 
```

这将结束 while 循环，而不是尝试获取非对象值的成员。

# c# - 在 GDI+ 中绘制网格具有更好的性能

> ID：12031121
> 
> 赞同：0
> 
> 时间：2012-08-20T00:44:33.373
> 
> 标签：c#, .net, gdi+

我需要绘制一个带有`Graphics`类的网格（只是交叉线），以及像这张图片这样的*透明表示：*

![在此处输入图像描述](../Images/3c6a436be02ab232e409086473d262bc.png)

除了绘制每条线/矩形之外，我不知道任何其他方式。如果领域很宽，性能会很差。有没有更好的方法来绘制这些东西？

这是我当前绘制网格的代码：

```
 private void drawGrid(Graphics pGraphic, int pGridSize)
    {
        int verticalCount = this.mPicScreen.Width / pGridSize + 1;
        int horizontalCount = this.mPicScreen.Height / pGridSize + 1;

        Pen p = new Pen(Color.Gray);

        // Vertical Lines
        for (int i = 0; i < verticalCount; i++)
        {
            pGraphic.DrawLine(p,
                new Point(i * pGridSize, 0),
                new Point(i * pGridSize, this.mPicScreen.Height));
        }

        // Horizontal Lines
        for (int i = 0; i < horizontalCount; i++)
        {
            pGraphic.DrawLine(p,
                new Point(0, i * pGridSize),
                new Point(this.mPicScreen.Width, i * pGridSize));
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T04:12:19.973

有一个更好的方法：只用刷子

如果您需要制作用户定义的网格大小，您可以使用

```
System.Drawing.TextureBrush 
```

如果一个随机的没问题，你会发现

```
System.Drawing.Drawing2D.HatchBrush 
```

已经是网格样式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T03:23:46.133

该控件实际上在绘制过程中闪烁（因为该控件被故意无效）。这不是性能问题，而是实际上因为控件不是`DoubleBuffered`.

这是启用的`DoubleBuffered`代码`Controls`：

```
public static void setDoubleBuffered(System.Windows.Forms.Control c)
{
    if (System.Windows.Forms.SystemInformation.TerminalServerSession)
        return;

    System.Reflection.PropertyInfo aProp =
          typeof(System.Windows.Forms.Control).GetProperty(
                "DoubleBuffered",
                System.Reflection.BindingFlags.NonPublic |
                System.Reflection.BindingFlags.Instance);

    aProp.SetValue(c, true, null);
} 
```

# ssh - 通过 SSH 隧道的 mysqldump

> ID：12031124
> 
> 赞同：7
> 
> 时间：2012-08-20T00:44:56.010
> 
> 标签：ssh, backup, mysqldump, tunneling

我有一个服务器设置如下：

*   `webserver`（网关机器，通过 SSH 从 Internet 访问）
*   `dbserver`（数据库服务器，*无法从网络访问*）

我的目标是通过网络`mysqldump`将备份从`dbserver`我的笔记本电脑中提取出来。到目前为止，这个问题是[这个问题](https://stackoverflow.com/questions/10322352/i-would-like-to-simplify-ssh-tunneling-to-do-a-mysql-dump-and-scp-the-file-to-lo)的副本，*除了*没有安装，*我*`webserver`没有安装它的权利。所以我试图在我的笔记本电脑上使用从我没有 SSH 权限的网关后面的服务器中提取。*`mysqldump``mysqldump`*

 *在讨论[here](https://serverfault.com/questions/134007/how-to-dump-remote-database-without-mysqldump)和[here](https://serverfault.com/questions/36467/temporary-ssh-tunnel-for-backup-purposes)之后，我正在尝试做这样的事情来建立隧道：

```
ssh -f -L 3306:dbserver:3306 user@webserver -N 
```

其次是：

```
mysqldump -P 3306 -h localhost -u dbuser -p db 
```

但是我遇到了[这个人](https://serverfault.com/questions/134007/how-to-dump-remote-database-without-mysqldump)遇到的同样的麻烦，并且不太确定隧道发生了什么或如何修复它（并且在我的笔记本电脑的主机文件中添加一个条目似乎并没有像他那样修复它） .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T07:54:59.530

每天将数据库转储到网关机器，然后从那里获取

```
#!/bin/sh
# Backup the mysql Databases
 for database in $(mysql -u b4ckup -pd1psh1t --host server.database.net -e "show databases" | awk '{print $1}' | grep -v Database)
do
        mysqldump -u user -p password --lock-tables=false --host server.database.net $database > /storage/backups/`date +\%Y-\%m-\%d`-`date +\%A`/server/$database.sql
done 
```*

# python - 索引到 numpy 的 mgrid

> ID：12031128
> 
> 赞同：5
> 
> 时间：2012-08-20T00:45:28.287
> 
> 标签：python, numpy, indexing

我`numpy.mgrid`用来生成“坐标索引数组”

```
y, x = np.mgrid[0:3, 0:2]
print x
array([[0, 1],
       [0, 1],
       [0, 1]]) 
```

在许多情况下，我对这些数组（例如`x[0, :]`）进行一些切片并丢弃其余数据。有时，这些切片比原始数组小得多，计算成本很高（即`np.mgrid[0:512, 0:512, 0:512]`）。numpy 是否提供`[coord[view] for coord in np.mgrid[0:512, 0:512, 0:512]`不生成大型中间数组的等价物？

我意识到该解决方案对于 slice 来说是微不足道的`[0,:]`，但我正在寻找一种通用解决方案来处理索引 numpy 数组的任何有效方法

**编辑**

有些人要求提供具体的例子来说明`view`可能的样子。理想情况下，我希望有一个通用的解决方案来处理索引 ndarray 的任何有效方法。以下是上述 3x2 数组的一些具体示例：

1)`view = (1, slice(None, None, 2))`

2)`view = (np.array([0,1]), np.array([0, 1]))`

3)`view = np.array([[False, False], [False, True], [False, False]])`

我正在寻找类似的功能

```
def mgrid_with_view(array_shape, view)
    ... 
```

这相当于`[o[view] for o in np.indices(array_shape)]`没有不必要的计算或内存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T08:54:23.083

正如 HYRY 所提到的，我相信您要避免的是创建完整的数组。`mgrid`创建一个完整的数组，但是如果您使用：

```
x, y = np.broadcast_arrays(*np.ogrid[0:2,0:3]) 
```

`x`并且`y`不再占用内存`np.arange(0,2)`（和`np.arange(0,3)`），同时表现得好像每个都是一个完整的数组。如果您需要一个大型结果数组，您可能应该单独切片这些数组，然后将它们连接起来。（np.broadcast_arrays 返回数组元组而不是数组）

# javascript - 动态创建并添加foreignGroup到svg的问题是什么

> ID：12031132
> 
> 赞同：0
> 
> 时间：2012-08-20T00:45:42.223
> 
> 标签：javascript, dynamic, svg

当我使用 javascript 使用表单输入元素动态创建**foreignGroup时遇到问题。**我可以在浏览器检查器上看到元素，但它不以某种方式可见。它应该是可见的！

**javascript:**

```
 var forObj = document.createElement("foreignObject");
        forObj.setAttribute("x", "100");
        forObj.setAttribute("y", "100");
        forObj.setAttribute("width", "200");
        forObj.setAttribute("height", "250");
        forObj.setAttribute("background", "red");

    var askInput = document.createElement("input");
        askInput.setAttribute("id", "test");
        askInput.setAttribute("type", "text");
        askInput.setAttribute("width", "300");
        askInput.setAttribute("height", "50");
        askInput.setAttribute("x", "100");
        askInput.setAttribute("y", "100");

        forObj.appendChild(askInput);

        mySvg.appendChild(forObj); 
```

如果我将**svg**中的foreignGroup直接添加到php文件中，它可以工作并且没有任何问题。

这是错误还是什么，或者我错过了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-31T21:08:16.470

这很容易，就像第一条评论说的那样，**使用 document.createElementNS**而不是**document.createElement**，如下所示：

```
var forObj = document.createElementNS("foreignObject");
        forObj.setAttribute("x", "100");
        forObj.setAttribute("y", "100");
        forObj.setAttribute("width", "200");
        forObj.setAttribute("height", "250");
        forObj.setAttribute("background", "red");

    var askInput = document.createElementNS("input");
        askInput.setAttribute("id", "test");
        askInput.setAttribute("type", "text");
        askInput.setAttribute("width", "300");
        askInput.setAttribute("height", "50");
        askInput.setAttribute("x", "100");
        askInput.setAttribute("y", "100");

        forObj.appendChild(askInput);

        mySvg.appendChild(forObj); 
```

# php - Symfony 表单生成器中 $options 的解释和所有选项

> ID：12031141
> 
> 赞同：2
> 
> 时间：2012-08-20T00:47:03.107
> 
> 标签：php, symfony, doctrine-orm

我已经尝试了很多，并且能够找到我可以`$options`在表单构建器数组中使用的各种可用选项。

我知道选择是不同的

1.  字段
2.  实体
3.  收藏

但无法找到这些类别的内容及其解释

```
->add('name','text',array());
->add('user','entity',array());
->add('user','collection',array()); 
```

是否有任何资源可以告诉我在上述情况下可以使用哪些选项

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-20T00:53:56.107

是的，文档本身可在此处获得：[http](http://symfony.com/doc/master/reference/forms/types.html) ://symfony.com/doc/master/reference/forms/types.html 。单击字段类型以了解其选项。

# sql - 小巧玲珑。使用 GO 执行查询

> ID：12031143
> 
> 赞同：9
> 
> 时间：2012-08-20T00:47:07.480
> 
> 标签：sql, dapper

我正在尝试使用 Dapper 运行 SQL 查询：

```
use master
go

if exists (select name from sys.databases where name = N'TestDB')
drop database [TestDB]
go

create database [TestDB] on primary ( 
  name = 'TestDB_Data',
  filename = '$Path\TestDB_Data.mdf',
  size = 40MB,
  maxsize = 2GB,
  filegrowth = 20MB 
)

use [TestDB]
go

create table dbo.Posts
(
  Id int identity not null,
  Body nvarchar (max) null
); 
```

我使用 Dapper 如下：

```
using (SqlConnection connection = new SqlConnection(connectionString)) {
  connection.Open();
  connection.Execute(sqlQuery);
} 
```

但是，使用 GO 时出现错误。

但是，如果我删除 GO 语句，我会在创建 Posts 时收到错误，因为未创建表 TestDB。

有没有办法使用 Dapper 来解决这个问题？

我只能使用 SQL Server SDK 来做到这一点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-21T23:22:14.820

GO 不是 SQL 语句，它只是一个批处理分隔符，实际上您可以将其重命名为您想要的任何名称。

![批处理分隔符](../Images/66ee752cb3782a71e97b41494a81a39f.png)

Management Studio 解决这个问题的方法是解析 SQL。编写一个可以将语句分块的简单解析器很容易。只需拆分“GO”上的字符串并将每个语句发送到 Dapper。

但是，要 100% 正确，您需要一个[复杂的解析器](https://stackoverflow.com/questions/76083/parsing-sql-in-net)。

```
select '
GO ' GO from [GO] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-20T02:09:05.740

Dapper 在这里无法为您提供帮助。相反，我建议您尝试使用 SQL Server 管理对象来执行您提到的大型 SQL 命令。它确实支持 GO 语句。

您可以查看此[博客文章](http://weblogs.asp.net/jgalloway/archive/2006/11/07/Handling-_2200_GO_2200_-Separators-in-SQL-Scripts-_2D00_-the-easy-way.aspx)以获取分步说明。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-02-23T17:44:22.410

我解决了分离处决

```
 using (SqlConnection connection = new SqlConnection(connectionString))
        {
            connection.Open();

            foreach (var item in sqlQuery.Split("GO"))
            {
                conn.Execute(item);
            }
        } 
```

# html - 在 Play2 Scala 模板中声明变量

> ID：12031146
> 
> 赞同：57
> 
> 时间：2012-08-20T00:48:02.733
> 
> 标签：html, scala, templates, playframework, playframework-2.0

如何在 Play2 Scala 模板中声明和初始化要在本地使用的变量？

我有这个：

```
@var title : String = "Home" 
```

在模板顶部声明，但它给了我这个错误：

```
illegal start of simple expression """),_display_(Seq[Any](/*3.2*/var)),format.raw/*3.5*/(""" title : String = "Home" 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-08-20T01:01:30.883

```
@defining("foo") { title=>
  <div>@title</div>
  ...
} 
```

基本上，您必须将要使用它的块包装起来

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2015-08-04T09:11:09.963

实际上，@c4k 的解决方案是有效的（而且非常方便），只要您事后不尝试更改变量的值，不是吗？

您只需将其放在模板的顶部：

```
@yourVariable = {yourValue} 
```

或者，如果它是一个更复杂的表达式，你可以这样做：

```
@yourVariable = @{yourExpression} 
```

你甚至可以使用像这样的列表：

```
@(listFromController: List[MyObject])
@filteredList = @{listFromController.filter(_.color == "red")}

@for(myObject <- filteredList){ ... } 
```

对于给定的示例，这将是

```
@title = {Home}  //this should be at beginning of the template, right after passing in parameters

<h1> Using title @title </h1> 
```

在您所说的评论中，它被输入为 HTML 类型。但是，这仅在您尝试再次覆盖时才有意义`@title`，不是吗？

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2014-01-28T05:37:28.843

scala模板支持这个，你可以在模板中定义变量

```
@import java.math.BigInteger; var i=1; var k=1 
```

如果你想在模板中改变它的值

```
@{k=2} 
```

* * *

例子

```
@(title:String)(implicit session:play.api.mvc.Session)
@import java.math.BigInteger; var i=1; var k=1
^
<div id='LContent_div@i'>
                     ^
  <div id='inner_div_@k'></div>
                     ^
</div> 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-08-20T06:34:27.170

virtualeyes 的解决方案是正确的，但还有其他可能性，您可以像通常使用默认值一样声明视图的参数，在这种情况下，您可以将其用于整个模板 + 您将保留更改它的可能性`controller`：_

```
@(title: String = "Home page")

<h1>Welcome on @title</h1> 
```

控制器：

```
def index = Action{
    Ok(views.html.index("Other title"))
} 
```

请注意，Java 控制器无法识别模板的默认值，因此您每次都需要添加它们：

```
public static Result index(){
    return ok(views.html.index.render("Some default value..."));
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-03-08T19:32:17.513

如果您不想用@defining 包装所有内容，可以这样做：

```
@yourVariable = { yourValue } 
```

@defining 指令在模板中真的不可读...

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-10-17T09:48:08.050

有一个明显的解决方案看起来很干净，有时可能更受欢迎：在模板周围定义一个范围，在其中定义你的变量，然后让范围产生你需要的 html 代码，如下所示：

```
@{
  val title = "Home"

  <h1>Welcome on {title}</h1>
} 
```

这有一些缺点：

*   您正在以`NodeSeq`这种方式将 html 生成为 Scala，这有时可能会受到限制
*   此解决方案存在性能问题：其中的代码`@{`似乎是在运行时编译的，因为为页面生成的 Scala 代码看起来像这样（删除了一些常见的 Twirl 内容）：

生成的代码：

```
...    

Seq[Any](format.raw/*1.1*/("""<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Basic Twirl</title>
    </head>
    <body>

        """),_display_(/*9.10*/{
            val title = "Home"

                <h1>Welcome on {title}</h1>
        }),format.raw/*15.10*/("""

    """),format.raw/*17.5*/("""</body>
</html>"""))
      }
    }
  }

... 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-12-13T16:40:55.637

在旋转模板中，我建议使用定义块，因为

```
@random = @{
     new Random().nextInt
}

<div id="@random"></div>
<div id="@random"></div> 
```

多次使用会导致不同的值！

```
@defining(new Random().nextInt){ random =>
    <div id="@random"></div>
    <div id="@random"></div>
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-07-16T11:41:45.620

对于任何尝试[Govind Singh](https://stackoverflow.com/a/21397683/8433911)答案的人：
我必须将带有变量的导入行放在**参数**列表下，即

```
@(title:String)(implicit session:play.api.mvc.Session)
@import java.math.BigInteger; var i=1; var k=1 
```

作品。

但是将带有变量的导入**放在**导入语句上，即

```
@import java.math.BigInteger; var i=1; var k=1
@(title:String)(implicit session:play.api.mvc.Session) 
```

对我不起作用并导致错误：

```
expected class or object definition 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-10-03T11:45:33.870

```
@isExcel= {@Boolean.valueOf(java.lang.System.getProperty(SettingsProperties.isExcel))} 
```

# jaxb - JAXB (MOXy) 中 XML 的部分映射

> ID：12031148
> 
> 赞同：2
> 
> 时间：2012-08-20T00:48:14.320
> 
> 标签：jaxb, eclipselink, jaxb2, moxy

我只想从下面的 XML 中解**组 trk**及其子元素。但是，我想在编组时创建**gpx**作为根元素

```
<p:gpx creator="" version="1.1" xmlns:p="http://www.topografix.com/GPX/1/1"">
    <p:trk>
        <p:name>Test Track</p:name>
    </p:trk>
</p:gpx> 
```

MOXy 外部元数据定义如下

```
<xml-bindings xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xml-accessor-type="PROPERTY" package-name="Debrief.Wrappers">

    <xml-schema element-form-default="QUALIFIED">
        <xml-ns prefix="p" namespace-uri="http://www.topografix.com/GPX/1/1" />
    </xml-schema>

    <java-types>
        <java-type name="TrackWrapper">
        <xml-root-element name="gpx"/>
            <java-attributes>
                <xml-attribute xml-path="trk/name/text()" java-attribute="name"/>
            </java-attributes>
        </java-type>
    </java-types>
</xml-bindings> 
```

下面的代码

```
Map<String, Object> props = new HashMap<String, Object>();
props.put(JAXBContextProperties.OXM_METADATA_SOURCE, this.getClass().getResourceAsStream("gpx-bindings.xml"));

jaxbContext = JAXBContext.newInstance("Debrief.Wrappers:Debrief.Wrappers.Track", TrackWrapper.class.getClassLoader(), props);
Unmarshaller unmarshaller = jaxbContext.createUnmarshaller();
Object unmarshal = unmarshaller.unmarshal(this.getClass().getResourceAsStream("gpx-data.xml")); 
```

正在抛出这个异常

```
[Exception [EclipseLink-25008] (Eclipse Persistence Services - 2.4.0.v20120608-r11652): org.eclipse.persistence.exceptions.XMLMarshalException
Exception Description: A descriptor with default root element {http://www.topografix.com/GPX/1/1}gpx was not found in the project]
    at org.eclipse.persistence.jaxb.JAXBUnmarshaller.handleXMLMarshalException(JAXBUnmarshaller.java:956)
    at org.eclipse.persistence.jaxb.JAXBUnmarshaller.unmarshal(JAXBUnmarshaller.java:529)
    at org.eclipse.persistence.jaxb.JAXBUnmarshaller.unmarshal(JAXBUnmarshaller.java:149)
    at org.mwc.debrief.core.loaders.GPXLoader.doTheLoad(GPXLoader.java:70)
    at org.mwc.debrief.core.loaders.GPXLoader.main(GPXLoader.java:40)
Caused by: Exception [EclipseLink-25008] (Eclipse Persistence Services - 2.4.0.v20120608-r11652): org.eclipse.persistence.exceptions.XMLMarshalException
Exception Description: A descriptor with default root element {http://www.topografix.com/GPX/1/1}gpx was not found in the project
    at org.eclipse.persistence.exceptions.XMLMarshalException.noDescriptorWithMatchingRootElement(XMLMarshalException.java:143)
    at org.eclipse.persistence.internal.oxm.record.SAXUnmarshallerHandler.startElement(SAXUnmarshallerHandler.java:219)
    at org.eclipse.persistence.internal.oxm.record.XMLStreamReaderReader.parseEvent(XMLStreamReaderReader.java:111)
    at org.eclipse.persistence.internal.oxm.record.XMLStreamReaderReader.parse(XMLStreamReaderReader.java:83)
    at org.eclipse.persistence.internal.oxm.record.XMLStreamReaderReader.parse(XMLStreamReaderReader.java:72)
    at org.eclipse.persistence.internal.oxm.record.SAXUnmarshaller.unmarshal(SAXUnmarshaller.java:794)
    at org.eclipse.persistence.oxm.XMLUnmarshaller.unmarshal(XMLUnmarshaller.java:660)
    at org.eclipse.persistence.jaxb.JAXBUnmarshaller.unmarshal(JAXBUnmarshaller.java:526)
    ... 3 more 
```

不知道我错过了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T18:01:56.600

您需要在元素中设置指定`namespace`属性。`xml-schema`这告诉 MOXy 默认情况下应该将哪个命名空间应用于映射。该`xml-ns`元素用于为命名空间分配前缀。

```
 <xml-schema element-form-default="QUALIFIED" namespace="http://www.topografix.com/GPX/1/1">
        <xml-ns prefix="p" namespace-uri="http://www.topografix.com/GPX/1/1" />
    </xml-schema> 
```

**gpx-bindings.xml**

以下是更正后的外部映射文档的样子：

```
<xml-bindings xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xml-accessor-type="PROPERTY" package-name="Debrief.Wrappers">

    <xml-schema element-form-default="QUALIFIED" namespace="http://www.topografix.com/GPX/1/1">
        <xml-ns prefix="p" namespace-uri="http://www.topografix.com/GPX/1/1" />
    </xml-schema>

    <java-types>
        <java-type name="TrackWrapper">
        <xml-root-element name="gpx"/>
            <java-attributes>
                <xml-attribute xml-path="trk/name/text()" java-attribute="name"/>
            </java-attributes>
        </java-type>
    </java-types>
</xml-bindings> 
```

# python-3.x - 如何使用 python 3.2 安装 MySQLdb

> ID：12031151
> 
> 赞同：4
> 
> 时间：2012-08-20T00:48:40.077
> 
> 标签：python-3.x, mysql-python

我正在尝试使用 python 连接到 mySQL。据我了解，您需要有 MySQLdb，这是一些 python 连接器模块。我的第一个问题是没有正确版本的 mySQLdb。可以在[这里](http://www.lfd.uci.edu/~gohlke/pythonlibs/#mysql-python)找到。然后我应该打开一个命令行窗口并导航到我刚刚下载的文件的路径（解压缩后）并输入`python setup.py build`This 然后给我一个错误，说我需要下载安装工具。安装工具显然在 python 2.6 或 7 之后停止使用。现在我们应该使用我在[此处](http://pypi.python.org/pypi/distribute#installation-instructions)找到的分发作为替代品。我这样做了，现在当我尝试进行构建调用时，它吐了出来

```
Traceback (most recent call last):
  File "setup.py", line 13, in <module>
    from setup_windows import get_config
  File "C:\Program Files\MySQL\MySQL-python-1.2.3\setup_windows.py", line 46
    print """You shouldn't be running this directly; it is used by setip.py."""

Syntax Error: invalid syntax 
```

我需要有人牵着我的手，指导我完成这个设置。我在谷歌上花了 6 个小时试图弄清楚。（我在不止一个地方读到这是一个困难的安装，但非常值得。我希望他们是对的。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-19T22:23:30.323

请注意，您必须已`curl`安装。你可以从[这里](http://curl.haxx.se/download.html)抓住它。
假设`python.exe`命令在您的机器上启动 python3。

脚步：

1.  `distribute_setup.py`从‎ 下载`python-distribute.org/distribute_setup.py`以升级 setuptools。
2.  执行以下命令为本地 python3 升级 setuptools：

    > python.exe 分发设置.py

3.  下载并安装`pymysql`驱动程序：

    > curl -L [https://github.com/PyMySQL/PyMySQL/tarball/pymysql-0.6](https://github.com/PyMySQL/PyMySQL/tarball/pymysql-0.6) | tar xz
    > cd PyMySQL-PyMySQL-7c86923/
    > sudo python3 setup.py install

4.  下载并安装适用于 python3 的 MySQLdb 驱动程序

    > git clone [https://github.com/davispuh/MySQL-for-Python-3.git](https://github.com/davispuh/MySQL-for-Python-3.git)
    > cd MySQL-for-Python-3/
    > python3 setup.py install

5.  通过`python.exe`命令检查打开的python解释器并执行：

    > 导入 pymysql
    > 导入 MySQLdb

如果一切顺利 - 那么两条线都不应该失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T17:11:01.737

我也无法让 MySQLdb 与 Python 3 一起使用，所以我安装了[MySQL/Connector 模块](https://launchpad.net/myconnpy)。它一直像魅力一样工作，而且安装很简单。当时我是一个完整的 Python 新手，所以除非我是天才，否则任何人都可以轻松安装它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T01:29:36.127

在进一步谷歌搜索后，我认为使用 mysqldb 或其他任何方法都不是最好的解决方案。我找到了这个页面：[http](http://wiki.python.org/moin/MySQL) ://wiki.python.org/moin/MySQL 我决定试试 mysql 连接器/python。它看起来很简单，没有疯狂的安装。

# ruby-on-rails - Gemfile 仍在寻找我从 Gemfile 中删除的 gem

> ID：12031160
> 
> 赞同：0
> 
> 时间：2012-08-20T00:49:56.787
> 
> 标签：ruby-on-rails, rubygems, gem, bundler, therubyracer

我对 Ruby on Rails 还很陌生，我仍然在琢磨它是如何工作的。抱歉，如果这是一个简单的问题，但是：

当他们提到在我的 Gemfile 中启用“therubyracer”gem 时，我正在关注关于将我的 Rails 应用程序部署到 EC2 的教程。我一直无法让服务器在我的 Gemfile 中使用这个 gem，所以我删除了它，但它仍在寻找它并出错。

我的问题是为什么？它是否缓存在我需要清除的地方？我运行了“捆绑安装”和“捆绑更新”，它们都对我产生了影响。当我尝试启动“rails server”时也是如此

这是我从终端运行“rails server”时得到的输出。

```
/Users/chris/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/spec_set.rb:90:in `block in materialize': Could not find therubyracer-0.10.1 in any of the sources (Bundler::GemNotFound)
from /Users/chris/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/spec_set.rb:83:in `map!'
from /Users/chris/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/spec_set.rb:83:in `materialize'
from /Users/chris/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/definition.rb:127:in `specs'
from /Users/chris/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/environment.rb:27:in `specs'
from /Users/chris/.rvm/gems/ruby-1.9.3-p194@global/gems/rubygems-bundler-1.0.3/lib/rubygems-bundler/noexec.rb:41:in `candidate?'
from /Users/chris/.rvm/gems/ruby-1.9.3-p194@global/gems/rubygems-bundler-1.0.3/lib/rubygems-bundler/noexec.rb:60:in `setup'
from /Users/chris/.rvm/gems/ruby-1.9.3-p194@global/gems/rubygems-bundler-1.0.3/lib/rubygems-bundler/noexec.rb:75:in `<top (required)>'
from /Users/chris/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require'
from /Users/chris/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'
from /Users/chris/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'
from /Users/chris/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:9:in `<main>' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T00:51:00.983

好吧，愚蠢地我在发布这个关于我面临的确切问题后发现了一个线程。我很确定它与 Twitter Bootstrap 相关。

[当我执行“捆绑更新”时，我从不在我的 gemfile 中的 gem 收到错误。我如何忽略这种依赖关系？](https://stackoverflow.com/questions/9402784/when-i-do-bundle-update-i-get-an-error-from-a-gem-not-in-my-gemfile-how-do-i)

# batch-file - 用于从 FTP 服务器下载最新文件的批处理文件

> ID：12031163
> 
> 赞同：6
> 
> 时间：2012-08-20T00:50:28.393
> 
> 标签：batch-file, ftp

我有一个批处理文件，可以从我的 Web 服务器 FTP 传输 CSV 文件。我只需要下载最新的 CSV 文件。

我怎么做？

这是我到目前为止所拥有的：

```
open 44.44.44.444
username
password

CD /Client/ABCCompany/

get *.csv

quit
close() 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-09-21T10:17:50.210

没有简单的方法来选择带有`ftp.exe`.

*   如果您知道文件的文件名中有今天的时间戳，您可以使用今天的时间戳动态生成脚本。您可以使用`DATE`环境变量，尽管它有一些注意事项。一种更可靠（也更复杂）的方法是使用`wmic os get LocalDateTime`.

    请参阅[如何以适合在文件/文件夹名称中使用的格式在 Windows 命令行上获取当前日期/时间？](https://stackoverflow.com/q/203090/850848)

*   如果您可以按字母顺序确定最新文件，您可以：

    *   运行重定向到文件的`ftp.exe`with命令`ls`
    *   按字母降序对文件进行排序
    *   阅读第一行
    *   `ftp.exe`为第二次运行生成下载脚本。

*   [WinSCP](https://winscp.net/)可以下载最新的文件，使用[命令](https://winscp.net/eng/docs/scriptcommand_get)`-latest`的开关：[`get`](https://winscp.net/eng/docs/scriptcommand_get)

    ```
    winscp.com /command ^
        "open ftp://username:password@ftp.example.com/" ^
        "cd /remote/path" ^
        "get -latest *.csv" ^
        "exit" 
    ```

    另请参阅[使用 WinSCP 下载最新文件](https://winscp.net/eng/docs/script_download_most_recent_file)的指南。

*   WinSCP 还可以下载[在某个时间间隔内](https://winscp.net/eng/docs/file_mask#size_time)创建的文件，例如最近 24 小时（1 天）：

    ```
    winscp.com /command ^
        "open ftp://username:password@ftp.example.com/" ^
        "cd /remote/path" ^
        "get *.csv>=1D" ^
        "exit" 
    ```

    或自某个时间点以来创建的文件，例如下载自午夜以来创建的文件，请使用[`today`关键字](https://winscp.net/eng/docs/file_mask#today)：

    ```
    winscp.com /command ^
        "open ftp://username:password@ftp.example.com/" ^
        "cd /remote/path" ^
        "get *.csv>=today" ^
        "exit" 
    ```

    对于`today`关键字，请确保您拥有最新版本的 WinSCP。

*   `DATE`使用 WinSCP，您可以比使用或更轻松地下载文件名中带有时间戳的文件`wmic os get LocalDateTime`（如上所示）。使用`%TIMESTAMP%`语法：

    ```
    winscp.com /command ^
        "open ftp://username:password@ftp.example.com/" ^
        "cd /remote/path" ^
        "get %%TIMESTAMP#yyyy-mm-dd%%.txt" ^
        "exit" 
    ```

    *（我是WinSCP的作者）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-06T13:57:12.000

您很可能必须分两部分进行转移。第一个发出 DIR 命令，该命令应将最近的文件作为最后一个文件。从 DIR 输出中解析出最后一个文件名后，将该文件名用于后续 GET。

我在 C# 中做了类似的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-07T09:20:42.830

我反复需要从我们的生产环境下载一个备份文件以安装在我们的开发环境中。

在我们的例子中，我想要自动下载的文件的文件名中指定了日期：`backup_2018_08_03_020003_1048387.bak`

`*2018_08_03*`所以我们可以在命令行 ftp 会话中使用 mget 来获取文件。

我们的备份程序每天早上 1 点运行，因此我们每天都有一个可以获取的备份。

当然，如果有一个基于备份文件时间戳获取最新备份文件的脚本会更漂亮更好，以防万一最新备份出现问题或备份文件命名格式更改。该脚本只是一个用于为内部开发目的获取备份的脚本，因此如果它坏了也没什么大不了的。稍后我将对此进行研究，并检查是否可以制定更清洁的解决方案。

我制作了一个批处理脚本，它只要求使用普通的 ftp 命令提示符脚本提供今天的备份文件。

正确设置今天日期的格式很重要。它必须正确匹配文件名中日期的格式。

如果你想使用脚本，你应该用你自己的信息替换变量。您还应该对运行它的目录具有写入权限。

这是我制作的脚本：

```
@Echo Off
Set _FTPServerName=xxx.xxx.xx.xxx
Set _UserName=Username
Set _Password=Password
Set _LocalFolder=C:\Temp
Set _RemoteFolder="/path/"
Set _Filename=*%date:~-4,4%_%date:~-7,2%_%date:~-10,2%*
Set _ScriptFile=ftptempscript
:: Create script
 >"%_ScriptFile%" Echo open %_FTPServerName%
>>"%_ScriptFile%" Echo %_UserName%
>>"%_ScriptFile%" Echo %_Password%
>>"%_ScriptFile%" Echo lcd %_LocalFolder%
>>"%_ScriptFile%" Echo cd %_RemoteFolder%
>>"%_ScriptFile%" Echo binary
>>"%_ScriptFile%" Echo mget -i %_Filename%
>>"%_ScriptFile%" Echo quit
:: Run script
ftp -s:"%_ScriptFile%"
del "%_ScriptFile%" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-18T10:41:11.890

执行此操作的简单方法是将其拆分为两个单独的连接，并在 FTP 位置有一个文本文件，该文件将包含最新文件的名称。

```
open 44.44.44.444
username
password
CD /Client/ABCCompany/
get latestfile.txt
quit
close() 
```

latestfile.txt 将包含您需要下载的最新文件的名称。第二个脚本将从 latestfile.txt 中读取文本并仅提取该文件。

```
for /F "tokens=*" %%A in (latestfile.txt) do [SET FILE = %%A] 
```

您必须将上述行添加到调用辅助 FTP 脚本的批处理文件中。

```
open 44.44.44.444
username
password
CD /Client/ABCCompany/
get %FILE%
quit
close() 
```

# javascript - 两种方法有什么区别？

> ID：12031172
> 
> 赞同：0
> 
> 时间：2012-08-20T00:52:52.620
> 
> 标签：javascript, oop

我可以直接调用 Date 对象的 parse 方法，如下所示：

```
 alert(Date.parse("March 21, 2012")); 
```

但是我不能这样做：

```
 alert(Date.getTime()); // TypeError: Date.getTime is not a function 
```

这就是我让它工作的方式：

```
 alert(new Date().getTime()); // works well 
```

那么为什么我不能像 Date.parse() 那样直接调用 Date.getTime() 呢？

基本问题：我写了一个类，我想直接使用它的一些方法，比如上面的 Date.parse() 。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T00:55:02.290

`getTime`is in `Date.prototype`，在构造`new Date()`对象时使用。

`parse`是`Date`本身，因此被直接调用而不是从构造的对象中调用。

这是[一篇关于 JavaScript 原型的文章，](http://javascriptweblog.wordpress.com/2010/06/07/understanding-javascript-prototypes/)供您阅读。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T00:54:53.777

在面向对象编程中，前者称为*静态*方法，而后者称为*实例*方法。实例方法要求对象的实例已经实例化（因此`new Date()`调用是必要的）。静态方法没有这个要求。

> 基本问题：我写了一个类，我想直接使用它的一些方法，比如上面的 Date.parse() 。

编写完类后，要添加静态方法，您需要执行以下操作：

```
MyClass.myStaticFunction = function() {
    // Contents go here.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T00:59:22.307

正如其他人所指出的，JavaScript 使用原型来定义实例方法。但是，您可以定义静态方法，如下所示。我不是想在`Date`这里定义整个对象，而是展示它的实例和静态函数是如何定义的。

```
// constructor defined here
function Date() {
    // constructor logic here
}

// this is an instance method
DateHack.prototype.getTime = function() {
    return this.time_stamp;
}

// this method is static    
Date.parse = function(value) {
    // do some parsing
    return new Date(args_go_here);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T01:13:12.890

```
function Class() {
    this.foo = function() { return 123; };
}
Class.bar = function() { return 321; };

Class.bar(); // 321

( new Class ).foo(); // 123 
```

# objective-c - {array|dictionary}WithCapacity 应该如何使用？

> ID：12031175
> 
> 赞同：1
> 
> 时间：2012-08-20T00:53:46.787
> 
> 标签：objective-c, ios, nsmutablearray, nsmutabledictionary

当我使用`NSMutableArray`or`NSMutableDictionary`时，如果我知道要放入的元素数或最大元素数，我通常使用`arrayWithCapacity`or创建它们`dictionaryWithCapacity`，但我想知道为数组/字典指定（初始）容量是否真的有帮助?

我不知道它是如何在内部实现的，但我相信当集合中的元素数量达到容量甚至接近容量时，集合可能会扩展其容量，所以如果我创建了一个可变数组容量32，只要我把第32个物体放进去，它就会自己膨胀到另一个容量？或者即使我把第30个物体放进去，它的容量也会扩大，因为它认为会有更多的物体？

因此，如果这些方法真的有帮助，我应该使用类似的方法：

```
 *withCapacity:maxNumberOfElements * 1.5 
```

代替

```
*withCapacity:maxNumberOfElements 
```

所以它对我的对象有足够的容量并且当我放入所有对象时不会扩展？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T00:59:33.833

从性能的角度来看，它很有用。当容量经常扩展时，会在内存中分配一个新数组（通常是当前数组容量的 2 倍），并将旧数组复制到新数组中。随着元素数量的增加，这可能会开始变得昂贵，因此如果您有容量（大致）预先知道的大型数组，建议使用 initWithCapacity。另一方面，如果你分配的东西比需要的大得多，你就是在浪费空间，所以标准的“谨慎使用”警告适用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T01:09:49.820

实际上，除非您创建大量数组/字典（与呈现 UI 页面的频率相比），否则使用`...WithCapacity`. 即使那样，也没有必要担心它，除非你有至少有几百个条目的数组/字典。

就要估计的大小而言，可能比最终大小稍微（5-10%）是理想的，但这部分取决于您是否容易受到存储限制。

但是，如果您确切知道有多少条目，请指定确切的数量（如果您指定了任何内容）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T01:21:54.220

当您计划使用大量元素填充集合时，或者当您知道要加载的元素的确切数量时，这很有用。调整集合的大小需要 CPU 周期，因此不必要地调整大小最终会转化为减少设备使用电池运行的时间。

考虑这个例子：假设你要加载 3000 个元素到一个数组中。如果您为默认数组分配空间，例如 16 个项目，则该数组需要调整 8 次才能达到容纳 3000 个元素所需的大小。每次调整数组大小时，都需要复制在初始位置复制的元素，从而导致 3000+ 次额外的复制操作。当您知道元素的确切数量时，您可以防止复制发生。

此外，您的数组不会为您不打算添加的元素浪费内存：如果您逐个添加 3000 个元素，则数组可能会在内部增长到 4000 个，以期待更多的元素；最后 1000 个元素将被浪费。

总而言之，当您确定确切的目标大小时，您应该使用容量初始化集合。当您从文件或网络连接反序列化数据时，经常会出现这种情况。在您不知道大小的情况下，最好不要猜测，让默认初始化顺其自然。

# xml - Magento - 将购物车下拉插件移动到 top.links. 参考名称=“top.Links”不改变位置

> ID：12031179
> 
> 赞同：0
> 
> 时间：2012-08-20T00:54:28.750
> 
> 标签：xml, magento, themes

我正在使用的购物车下拉插件具有以下 XML，我无法将其移动到顶部链接。

```
<?xml version="1.0"?>
<layout version="0.1.0">
    <default>
        <reference name="head">
            <action method="addCss"  ifconfig="cartdrop/general/enabled"><stylesheet>css/cartdrop.css</stylesheet></action>
            <action method="addJs"  ifconfig="cartdrop/general/enabled"><script>lib/jquery-1.4.2.min.js</script></action>
            <action method="addJs"  ifconfig="cartdrop/general/enabled"><script>lib/cartdrop.js</script></action>
        </reference>

     <reference name="top.container">
            <!--<action method="setTemplate" ifconfig="cartdrop/general/enabled"><template>cartdrop/template/header.phtml</template></action>-->

<block type="core/template" name="cartheader_sidebar" template="cartdrop/cartheader.phtml">         
    <block type="checkout/cart_sidebar" name="cart_sidebar" template="checkout/cart/sidebar.phtml" before="-">
        <action method="addItemRender"><type>simple</type><block>checkout/cart_item_renderer</block><template>checkout/cart/sidebar/default.phtml</template></action>
        <action method="addItemRender"><type>grouped</type><block>checkout/cart_item_renderer_grouped</block><template>checkout/cart/sidebar/default.phtml</template></action>
        <action method="addItemRender"><type>configurable</type><block>checkout/cart_item_renderer_configurable</block><template>checkout/cart/sidebar/default.phtml</template></action>
        <block type="core/text_list" name="cart_sidebar.extra_actions" as="extra_actions"/>
    </block>
</block>

        </reference>
    </default> 
</layout> 
```

我尝试将参考名称更改为`reference name="topLinks"`和`reference name="top.Links"`

我也尝试复制块并将其粘贴到 local.xml 下`<reference name="top.links">` 并将其放入 page.xml 但无济于事。

* * *

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T03:07:56.383

应该是`<reference name="top.links">`属性所说的->引用NAME

不显示的问题是：-看`top.links`->的定义`<block type="page/template_links" name="top.links" as="topLinks"/>` -然后去`Mage/Page/Block/Template/Links.php`

```
class Mage_Page_Block_Template_Links extends Mage_Core_Block_Template
{
    ...

    protected function _construct()
    {
        $this->setTemplate('page/template/links.phtml');
    }

    ...
} 
```

现在我们知道`top.links`从 扩展`core/template`。对于那些从`core/template`需要模板扩展的块（不是很简单），它将显示模板内的所有内容（在您的情况下，模板是`page/template/links.phtml`）

对于模板，为了能够渲染它的子模板，它应该显式调用`getChildHtml`

`<?php echo $this->getChildHtml(); ?>`-> 将渲染它下面的所有孩子

`<?php echo $this->getChildHtml('cartheader_sidebar'); ?>`-> 将使用别名/名称呈现孩子`cartheader_sidebar`

这意味着如果你想`cartheader_sidebar`显示`top.links`，你需要`<?php echo $this->getChildHtml('cartheader_sidebar'); ?>`输入`page/template/links.phtml`

PS：我没有检查你的布局，我认为它已经是正确的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-01T14:05:23.160

布局 XML：

```
 <block class="Magento\Framework\View\Element\Html\Link" name="cart-link" template="Magento_Theme::cart_link.phtml">
            <arguments>
                <argument name="label" xsi:type="string" translate="true">Cart</argument>
                <argument name="path" xsi:type="string" translate="true">#/</argument>
            </arguments>
        </block> 
```

和：

```
 <move element="minicart" destination="cart-link" /> 
```

购物车链接.phtml：

```
 <li>My Cart
 <?php echo $block->getChildHtml('minicart');?>
 </li> 
```

# ruby - 在一个表达式上调用“puts”会改变它的解释方式？

> ID：12031180
> 
> 赞同：4
> 
> 时间：2012-08-20T00:54:33.287
> 
> 标签：ruby

我刚刚遇到了一个问题，即函数返回的值取决于我是否对该结果调用 puts。我想知道这是可以预期的，还是某种解析器错误。

这仅在传递给函数的块使用`do...end`语法而不是内联`{...}`语法时才会发生。这是一个例子：

```
arr = ["a", "b", "c"]
puts i = arr.index { |x| == "b" }
#=> 1 
```

正如预期的那样，但这并不像我预期的那样工作：

```
arr = ["a", "b", "c"]
puts i = arr.index do |x|
  x == "b"
end
#=> #<Enumerator:0xSomeId> 
```

虽然如果我这样做效果很好：

```
arr = ["a", "b", "c"]
i = arr.index do |x|
  x == "b"
end
puts i
#=> 1 
```

看起来它被解释为好像根本没有传递任何块（返回枚举器是`arr.index`使用块调用的预期行为）。这是正常的吗？这种行为是否在任何地方进行了解释/记录？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T01:03:53.090

`do...end``{...}`由于优先级，块与最左边的方法相关联，而块与最右边的方法相关联。在您的第二个示例中，该块与 关联`puts`，这与它无关。

在这种情况下，这似乎是一种奇怪的行为，但正是`do...end`块的这一特性为许多 Ruby [DSL](http://en.wikipedia.org/wiki/Domain-specific_language)提供了干净、可读的语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T02:30:32.300

`{ ... }`比 绑定得更紧密`do ... end`，因此您的`do ... end`块最终会附加到`IO#puts`（忽略它）而不是`Array#index`.

如果你把 then parens 放入`puts() call`你可以看到：

```
puts(i = arr.index do |x| x == 'b' end) 
```

# java - Eclipse 每次运行都会生成真正的 .jar 文件

> ID：12031188
> 
> 赞同：0
> 
> 时间：2012-08-20T00:55:29.033
> 
> 标签：java, eclipse, jar, compilation, extract

我有一个程序可以从自身（内部`.jar`）复制文件到外部，但是每当我尝试从 Eclipse 运行它时，它都会给我一个异常：

```
java.io.FileNotFoundException: <my workspace>\<my project>\bin (Access is denied)
    at java.util.zip.ZipFile.open(Native Method)
    at java.util.zip.ZipFile.<init>(Unknown Source)
    at java.util.jar.JarFile.<init>(Unknown Source)
    at java.util.jar.JarFile.<init>(Unknown Source) 
```

我猜这是因为 Eclipse 不会在`.jar`你每次运行时都生成一个。我可以通过导出可运行的 jar 来完美运行我的程序，但是每次我想测试程序的时候导出都是乏味和痛苦的。

有什么方法可以告诉 Eclipse`.jar`每次运行时都创建一个（我知道它会很慢，但没关系）。或者至少模拟一个 jar 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T01:14:52.800

@Salain 是对的-但是如果您的用例只是在项目之外复制文件，那么忽略它们是否在 jar 中并通过 处理它们不是更容易`YourClass.class.getResourceAsStream("/path/to/file")`吗？

# c# - Metro Stye 应用程序使用文件作为数据源 No Async

> ID：12031190
> 
> 赞同：-1
> 
> 时间：2012-08-20T00:56:06.997
> 
> 标签：c#, json, asynchronous, microsoft-metro

从我的第一个 Metro 应用程序开始，我讨厌这种 Async 废话。

我的 C: 驱动器上有一个 JSON 测试文件。

我想将文件作为没有异步的字符串读取并将其用作我的数据源。

我没有运气.. 已经 6 个小时了，我什至无法加载这些数据。

使用 FileOpenPicker 但它使用 Async 作为 PickSingleFileAsync()

尝试了 IsolatedStorage，但他们都使用 Async

我至少可以使用 Application.DoEvents 之类的东西吗？

:(

我需要这种类型的功能...

```
public string StringfromFile(string path)
{
    using(FileStream fs = File.Open(path, FileMode.Open))using(StreamReader sr = new StreamReader(fs))
    string data = sr.ReadToEnd();
    return data;   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T02:37:10.747

我相信你必须使用异步，但是如果你想同步运行，你可以这样做

```
Task<StorageFile> task = MyAsyncMethodThatGetsTheFile();
task.Wait();
StorageFile file = task.Result; 
```

# php - Wordpress 自定义 Ajax 登录成功返回整个页面 HTML

> ID：12031191
> 
> 赞同：0
> 
> 时间：2012-08-20T00:56:17.070
> 
> 标签：php, jquery, ajax, wordpress, login

我已经按照[本教程](http://wpmu.org/how-to-use-ajax-with-php-on-your-wp-site-without-a-plugin/)创建了一个自定义 ajax 登录，但我遇到了问题。我正在使用这个 jquery 代码来发送 ajax 请求：

```
function ajaxLogin(form) {
    $.ajax({
        type: 'post',
        dataType: 'html',
        url: loginScript.ajaxurl,
        data: "action=cb_register_login_submit&" + $(form).serialize(),
        global: false,
        success: function( msg ){
            //location.reload( true ); // This could be nicer
            handleLoginReturn(msg);
        },
        error: function(er) {
            handleErrorReturn(er);
        }
    });
}

function handleLoginReturn(msg) {
    console.log(msg);
} 
```

和以下 PHP 函数来处理登录过程：

```
<?php

function cb_register_login_submit() {

    $creds = array();
    $creds['user_login'] = $_POST['username'];
    $creds['user_password'] = $_POST['pwd'];

    if ( isset( $_POST['remember'] ) ) {
        $creds['remember'] = true;
    }

    $user = wp_signon( $creds, false );

    if ( is_wp_error( $user ) ) {
        echo 'error';
    } else {
        echo 'success';
    }
    die(0);
}

?> 
```

所以问题是，当我输入错误的登录信息时，实际上我确实得到了通过 ajax 成功回调返回的字符串“error”但是当我输入正确的日志信息时，整个页面的 html（我认为是wordpress 仪表板代码）通过成功回调而不是字符串“成功”返回。事实上，字符串“success”似乎没有在成功回调的任何地方返回。

知道这里有什么问题吗？我假设 wp_signon 函数可能正在返回我不知道的成功数据。任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T06:19:04.047

我找到了解决方案：

我正在使用“登录注销重定向”插件，该插件似乎在成功调用 ajax 时发送了重定向页面 html。我停用了插件，一切正常！

# ios - 属性检查器中未出现动态原型的选项

> ID：12031194
> 
> 赞同：3
> 
> 时间：2012-08-20T00:57:16.670
> 
> 标签：ios, xcode, uitableview

我有一个 UITableView 刚刚添加到我的项目中，并且没有出现让我选择内容（动态原型或静态单元格）的选项。我在其他 iOS 项目中使用过 UITableViews，但由于某种原因，这次没有出现。我正在使用 XCode 4.4.1。

这是它在另一个项目中的外观截图：

![另一个项目的工作示例](../Images/cc81051b8b1e88574ef40f2ef7fafe8f.png)

这是我现在正在工作的项目中没有出现的屏幕截图：

![缺少属性的屏幕截图](../Images/7289acd9a799efd2563db309cd48028a.png)

有谁知道我错过了什么？我无法弄清楚我做了什么不同的事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T02:14:49.863

这些选项仅出现在情节提要中的 TableViews 中。出于某种原因，您无法在 nib 文件中的 UITableView 上编辑这些属性。

# android - PhoneGap 列表自动填充，显示单个帖子

> ID：12031198
> 
> 赞同：0
> 
> 时间：2012-08-20T00:58:05.503
> 
> 标签：android, ios, cordova

我需要有关一个代码背后的逻辑的帮助。

在我的 phonegap 应用程序中，我会自动填充新闻列表。当用户单击特定文章时，我希望它在不同的页面中显示。我只是不知道如何将文章的 id 传递到另一个页面。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T01:03:29.287

您可以使用本地存储。这是一个键/值对关联。

在此站点中了解更多信息：

1.  [http://www.w3schools.com/html5/html5_webstorage.asp](http://www.w3schools.com/html5/html5_webstorage.asp)
2.  [https://developer.mozilla.org/en-US/docs/DOM/Storage](https://developer.mozilla.org/en-US/docs/DOM/Storage)

例子：

```
// In the first page
localStorage.setItem("articleID", articleID);

...
// Then in the other page
var articleID = localStorage.getItem("articleID"); 
```

# javascript - 如何将剪切/粘贴（通过 jsni）方法注册到 RichTextArea？

> ID：12031199
> 
> 赞同：2
> 
> 时间：2012-08-20T00:58:26.460
> 
> 标签：javascript, gwt, dom-events, richtextbox

以下代码用于将属性样式设置为 body 元素并向其注册剪切/粘贴代码，但失败。奇怪的是，在调试的时候，变量`body`不为空，并且属性“style”存在，但框架没有这个孩子。运行工作没有按预期工作，调用时 NPE 被抛出`setBodyContent()`。

```
public class TextAreaExt extends RichTextArea
{
private BodyElement body;

@Override
protected void onLoad()
{
    super.onLoad();
    body = ((FrameElement) getElement().cast())
                .getContentDocument().getBody();
    body.setAttribute("style", "color:gray;");
    registerOnCut(body);
}

public void setBodyContent(String text)
{
    body.setInnerText(text);
}

private native void registerOnCut(BodyElement element) /*-{
    var that = this;
    console.log("registerOnCut");
    element.oncut = $entry(function(event) {
        //invoke method to adjust height based on content
        return false;
    });
    element.onpaste = $entry(function(event) {
        //invoke method to adjust height based on content
        return false;
    });
}-*/;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-02T18:40:44.947

不要调用`onLoad`方法来初始化主体，通过使用`addInitializeHandler`.

```
 this.addInitializeHandler(new InitializeHandler() {

        @Override
        public void onInitialize(InitializeEvent event) {
            body = ((FrameElement)getElement().cast()).getContentDocument().getBody();
            registerOnCut(body);
        }
    }); 
```

# ios - 带有 IOS、node.js、passport 和 google 的 OAuth 2

> ID：12031202
> 
> 赞同：2
> 
> 时间：2012-08-20T00:59:15.177
> 
> 标签：ios, node.js, oauth-2.0

我正在尝试让一个示例 Web 应用程序使用 OAuth 2 来确保接受 IOS 客户端的安全性，但遇到了一些麻烦。

**浏览器客户端**

使用来自我的[node.js/passport](https://github.com/jaredhanson/passport-google-oauth/tree/master/examples/oauth2)示例代码添加了我的 google 客户端 ID + 密码 (https://code.google.com/apis/console)。效果很好——我所要做的就是将重定向 URI 指向我的服务器的授权回调。

**IOS客户端**

使用与上面相同的服务器端代码，以及用于 IOS 的 gtm-oauth2 库，我遇到了一些麻烦。我按照谷歌的说明为已安装的应用程序创建了一个客户端 ID，并修改了服务器以使用它们并将它们添加到 ios 应用程序中。该应用程序能够访问 google 登录页面，但在重定向时会出现错误（这是有道理的，因为我没有更改重定向 uri）。

Google 为我提供了[两个](https://developers.google.com/accounts/docs/OAuth2InstalledApp#choosingredirecturi)重定向 URI 选项：

1.  瓮瓮
2.  本地主机

服务器需要某种排序或重定向，但 IOS 重定向 URI 中的子转换不起作用，并且看起来他们不应该考虑到服务器需要有一个特定的 URI 来进行验证：

```
passport.use(new GoogleStrategy({
    clientID: GOOGLE_CLIENT_ID,
    clientSecret: GOOGLE_CLIENT_SECRET,
    callbackURL: "http://127.0.0.1:3000/auth/google/callback"
  },
  function(accessToken, refreshToken, profile, done) {
    // asynchronous verification, for effect...
    process.nextTick(function () {

      // To keep the example simple, the user's Google profile is returned to
      // represent the logged-in user.  In a typical application, you would want
      // to associate the Google account with a user record in your database,
      // and return that user instead.
      return done(null, profile);
    });
  }
)); 
```

...

```
app.get('/auth/google/callback', 
  passport.authenticate('google', { failureRedirect: '/login' }),
  function(req, res) {
    res.redirect('/');
  });

app.get('/logout', function(req, res){
  req.logout();
  res.redirect('/');
}); 
```

我得到两个不同的错误：

1.  使用适用于浏览器客户端的重定向，以及已安装的/ios 应用程序客户端 ID + 机密 - 重定向错误
2.  使用 ios 客户端 ID + secret + ios + redirect (urn) - 客户端错误

我是否需要将 IOS 重定向 URI 添加到 IOS 客户端，或者在 node.js 服务器中放入某种重定向参数来告诉它有关客户端的信息？还是我缺少一些基本的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T13:59:21.437

~~您在此处尝试实现的目标，即对[已安装的应用程序](https://developers.google.com/accounts/docs/OAuth2InstalledApp)和[Web 服务器应用程序](https://developers.google.com/accounts/docs/OAuth2WebServer)流使用相同的凭据，**将无法正常工作**。谷歌知道他们为哪种类型的应用程序颁发了凭证并强制执行。~~（这是错误的，请参阅评论。）

您的场景的典型方法是在您的服务器上实现*Web 服务器应用程序流*，并通过在 iOS 设备上打开[授权端点 URL](https://developers.google.com/accounts/docs/OAuth2WebServer#formingtheurl)来启动登录，但将 设置`redirect_uri`为您的服务器。这样您就可以在服务器上获取*访问令牌*和*刷新令牌*，并可以从那里调用 Google API。

你的 iOS 客户端和网络服务器之间的通信方式完全独立于其他一切。

# java - Hadoop 流、typedbytes 和/或 rawbytes 中的键、值和记录是如何分隔的

> ID：12031206
> 
> 赞同：3
> 
> 时间：2012-08-20T00:59:34.543
> 
> 标签：java, hadoop, mapreduce, hadoop-streaming, hadoopy

我知道 Hadoop 流中的文本记录由换行符分隔，并且键和值之间有一个可配置的分隔符（默认为制表符）。

1) rawbytes 格式的结构表明不需要记录或键/值分隔符，但有人可以确认是这种情况吗？

2）在typedbytes格式中，key和value是如何分隔的，record是如何分隔的？

3）另外，键是如何以 typedbytes 和 rawbytes 格式排序的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-09T19:45:42.630

1.  正确的
2.  标头中的长度信息使分隔符变得不必要，实际上它们并没有在规范中使用，除了一个例外，255 分隔列表，类型代码 9
3.  未指定排序顺序。根据我的经验，mapreduce 中的默认比较器将它们排序为原始字节，每个字节按数字排序，数组按字典顺序排序。它是可插入的，因此您可以使用自己的 Java 类对其进行更改。

见 [https://hadoop.apache.org/docs/current2/api/org/apache/hadoop/typedbytes/package-summary.html](https://hadoop.apache.org/docs/current2/api/org/apache/hadoop/typedbytes/package-summary.html)

安东尼奥

# netbeans - 在 NetBeans 中，Ivy 依赖项在编译时使用，而不是运行时

> ID：12031210
> 
> 赞同：0
> 
> 时间：2012-08-20T01:00:36.510
> 
> 标签：netbeans, ivy

我是 NetBeans（7.2 版）的新手，我正在尝试将其配置为与使用 Apache Ivy 配置依赖项的项目一起使用。我已经安装了 Ivy 插件，修改了我的 ivy.xml 文件以匹配预期的配置（[compile, runtime, compile-test, runtime-test]。项目构建干净，并且适当的库存在于“Ivy Libraries/运行时”项目树。但是，当我尝试在 NetBeans 中运行应用程序时，在 Ivy 导入的类上出现 NoClassDefFoundError。

我假设，不知何故，我需要明确告诉 NetBeans 在运行时使用 Ivy 库。但我不知道该怎么做。请stackoverflow，你是我唯一的希望。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T01:25:20.943

主要问题是我只是点击了项目上的“运行”按钮。我不确定它试图运行什么类。但是当我选择包含我的 main() 方法的实际类并显式运行该方法时，它起作用了（或者更确切地说，它以一种合理的方式失败了）。

# linux - Git 中的多平台开发和 autocrlf 选项

> ID：12031212
> 
> 赞同：1
> 
> 时间：2012-08-20T01:00:53.980
> 
> 标签：linux, macos, git, github, github-for-mac

我目前正在使用 Git，并且在我的 Windows PC 上一切正常。我将我的 autocrlf 设置为 true，据此这是正确的

[https://help.github.com/articles/dealing-with-line-endings](https://help.github.com/articles/dealing-with-line-endings)

其实我没有抱怨，它似乎工作得很好，时不时有一些警告，但我通常忽略它们。

但这实际上是做什么的呢？这是否会在执行 PULL 时添加 CR/LF，然后在执行推送时将 CRLF 更改为 LF？

所以回购中的“总是”有“只有”LF而不是CRLF的文件？

我即将使用 MAC OS X 和 Linux 在同一个存储库中开始开发，现在这就是我感到困惑的地方，根据 GitHub，它指出对于 Windows，将 Autocrlf 设置为 TRUE。

但是在 Linux / MAC OS X 上，我应该这样做吗？我知道的 Linux 不使用 CRLF。

## 更新

我看到关于 Stack Overflow 的各种评论不认为它是真实的，但当然我使用的是 3 种类型的系统，所以我想这就是为什么在这里推荐它的原因？

也推荐Linux？但它永远不会产生crlf。

所以我想情况是，总是让它保持真实，以防万一？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T01:07:48.370

在 OS X 上也设置`autocrlf`为。`true`它会做正确的事。（事实上​​，你也可以在 Linux 上设置它，它会再次做正确的事情。）

* * *

> 但这实际上是做什么的呢？这是否会在执行 PULL 时添加 CR/LF，然后在执行推送时将 CRLF 更改为 LF？

是的。当文件在本地签出时，它将文件转换为本地本机行尾格式，然后在提交时，它们会自动转换回规范的行尾格式 ( `LF`)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T01:21:23.503

[这](https://stackoverflow.com/questions/2825428/why-should-i-use-core-autocrlf-true-in-git)可能有助于回答您的一些问题。

基本上，只有当您使用的编辑器不能正确处理行尾，或者抱怨很多（如 Visual Studio）时，这才真正重要。

# c# - MVC3 应用程序，基于现有架构

> ID：12031214
> 
> 赞同：1
> 
> 时间：2012-08-20T01:02:00.533
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我有一个实体框架驱动的解决方案，在此之上，我有一个业务层和一个服务层，将方法公开给我的测试控制台应用程序。控制台应用程序不知道我的实体框架。我有一个转换类，它采用实体框架数据对象，并将它们传输到自定义 DTO，它们位于共享库项目中。因此，我的数据库访问层使用共享库，我的其他层也是如此。

现在，我想尝试构建一个 MVC3 应用程序。那么，在我的解决方案中将其构建为一个单独的项目，然后让 MVC 应用程序的控制器部分引用我当前解决方案的服务层是否正确？例如，我的服务层公开了一个名为“GetAllUsers”的方法，该方法返回一个列表。然后我获取该列表，并形成一个模型（MVC 的 M 部分），并将其传递给视图。这看起来可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T02:09:09.300

我不是一个大专家，但我认为这没关系，而且是正确的。根据我创建 MVC 应用程序的经验，将 MVC 应用程序本身与整个解决方案的其他部分（例如数据库、数据库模型或数据库模型类、数据库存储库、业务模型等）分开是正确的。此外，如果您愿意，您可以根据您的服务层直接在 MVC 应用程序项目中创建 ViewModel 类。即再创建一个抽象级别，并且仅将控制器用于将结果发送到查看而不是用于处理您的列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T05:35:25.213

为了呼应 Dima - 您可以考虑再次将您的 DTO 映射到`ViewModel`专门为视图定制的自定义类（否则，您可能会发现自己不得不使用`ViewBag`etc 将其他数据填充到视图中）。

还要确认 MVC 的“M”实际上是系统的整个后端（DAL、BLL、服务层、DTO、实体等）。我们通常删除 asp.net MVC 项目中的 Model 文件夹，因为其他层位于单独的程序集中并被引用/注入。我假设您的 MVC 前端是您系统的“主要”用户界面（即同一团队正在开发 MVC 前端和后端）。

一个有争议的问题是服务层 - 至少有以下 2 个选项。

1.  您可以认为服务层仅适用于“外部”系统消费者，并允许您的控制器直接与您的 BLL 交互，甚至（CQRS 样式）直接与 DAL/存储库进行查询（即服务层 = 暴露的集成接口外观） . （但是您自己的前端 Ajax 调用等应该调用 MVC 控制器方法，而不是服务层 IMO）
2.  采取更传统的严格分层的方式，把服务层当作你的业务层的网关（即你的MVC前端根本不是服务的特殊消费者，必须经过服务层）。

使用选项 1，您可能需要在 Controller 中复制服务问题（安全性、事务边界、日志记录等）。通常控制器无论如何都需要这些问题。

使用选项 2，例如，如果您使用 WCF，您应该尽可能避免额外的网络（和序列化/反序列化）开销。因此，如果您发现可以将 MVC 前端和服务层在进程中部署到同一物理服务器，例如，您可以配置 IoC（或类工厂）以将 WCF 服务合同的实例直接注入您的控制器（即，您仍然通过定义的 WCF 合同通过服务层，但没有开销）。

同样使用选项 2，如果您确实有其他系统在使用您的服务（除了您自己的前端），建议您将界面形式化，例如通过为外部消费者提供额外的外观/映射。否则，每次您为自己的前端向 WCF 服务添加新属性或方法时，您都会违反外部消费者的合同。WCF`MessageContract`对于外部系统接口很有用，因为您可以更好地控制消息格式。

# xml - Zoho API inserRecord 使用 Curl 和 XML，不返回错误且不添加“潜在”

> ID：12031216
> 
> 赞同：1
> 
> 时间：2012-08-20T01:02:10.807
> 
> 标签：xml, curl, zoho

如果不是几周，我已经敲了几天的头。我认为这主要是因为我不熟悉 XML 和 PHP cURL 的这个特殊概念。

并且客户正在使用法语单词，因此当它通过 Zoho 时，口音没有帮助（不同的故事）

无论如何，当我编写 XML 时，我必须输入所有字段还是只输入标记为必要的字段。例如

“机会”有（accountID、ContactID、oppurtunityName、date Due、Mailing 等）作为字段，可以说我不想添加邮件或其他人，其他人还需要在那里吗？

我问这个是因为我刚刚这样做：

```
<?xml version="1.0" encoding="UTF-8" ?>
  <Potentials>
      <row no="1">
          <FL val="ACCOUNTID">accountID is in here</FL>
          <FL val="Potential Name">Potential Name is in here</FL>
          <FL val="Stage">"Perdu"</FL>
          <FL val="Closing Date">01/04/2009</FL>
    </row>
  </Potentials> 
```

并在 php

```
$query = "newFormat=1&authtoken={$authtoken}&scope=crmapi&xmlData={$xmlData->asXML()}";

   $ch = curl_init();
    /* set url to send post request */
    curl_setopt($ch, CURLOPT_URL, $url);
    /* allow redirects */
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
    /* return a response into a variable */
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    /* times out after 30s */
    curl_setopt($ch, CURLOPT_TIMEOUT, 30);
    /* set POST method */
    curl_setopt($ch, CURLOPT_POST, 1);
    /* add POST fields parameters */
    curl_setopt($ch, CURLOPT_POSTFIELDS, $query);// Set the request as a POST FIELD for curl.
    //Execute cUrl session
    $response = curl_exec($ch);
    curl_close($ch);
    echo $response; 
```

并且它曾经返回错误说字段不存在，现在经过几次修复后它什么也不返回并且没有创建“机会”。

任何帮助将不胜感激

谢谢你 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T10:44:37.307

我和你一样遇到了与 Zoho 几乎相同的问题，并且能够通过添加下一个 curl 选项来解决它。希望这对您也有帮助：

```
curl_setopt($ch, CURLOPT_SSL_CIPHER_LIST, 'rsa_rc4_128_sha'); 
```

# django - 无法让 nginx 为收集的静态文件提供服务

> ID：12031217
> 
> 赞同：2
> 
> 时间：2012-08-20T01:02:27.680
> 
> 标签：django, nginx, gunicorn, static-files

我正在尝试让 nginx 与 gunicorn 一起工作。我有一个`/project/static/`静态文件所在的目录。`/project/livestatic/`使用显示的配置将这些文件收集到一个目录`settings.py`中：

```
STATIC_ROOT = '/project/livestatic'
STATIC_URL = '/static/'
STATICFILES_DIRS = (
    '/project/static',
) 
```

我正在使用以下 nginx 配置：

```
worker_processes 1;
user nobody nogroup;
pid /tmp/nginx.pid;
error_log /tmp/nginx.error.log;

events {
    worker_connections 1024;
    accept_mutex off;
}

http {
    include mime.types;
    default_type application/octet-stream;
    access_log /tmp/nginx.access.log combined;
    sendfile on;

    upstream app_server {
        server 127.0.0.1 fail_timeout=0;
    }

    server {
        listen 80 default;
        client_max_body_size 4G;
        server_name domain.org;

        keepalive_timeout 5;

        # path for static files
        location /static/ {
            autoindex on;
            root /var/www/startupsearch_live/livestatic/;
        }

        location / {
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header Host $http_host;
            proxy_redirect off;

            proxy_pass   http://127.0.0.1:8888;
        }
    }
} 
```

在开发服务器（忽略 nginx）下，此配置工作正常，我可以通过以`/static/file.extension`. 但是，当 nginx/gunicorn 开始发挥作用时，这不起作用，并且尝试访问`domain.org/static/`会给出 django 404 页面，这表明 nginx 直接不提供文件。我怎么错了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T02:00:43.773

这个问题在这里被问了很多......

```
location /static/ {
    alias /var/www/startupsearch_live/livestatic/;
} 
```

使用`root`您拥有的方式将请求`/static/foo.jpg`解决`/var/www/startupsearch_live/livestatic/static/foo.jpg`

`alias`不会将位置附加到它。它按原样一对一地映射它。

# java - 一键android下的多个事件

> ID：12031218
> 
> 赞同：1
> 
> 时间：2012-08-20T01:02:41.670
> 
> 标签：java, android, events, button

我有以下代码在单击按钮时创建一个事件。我想知道如何通过按下此按钮来创建多个（比如 5 个）事件。感谢您的任何帮助！

```
@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);

//Button button = (Button)findViewById(R.id.button1);
// button.setOnClickListener(this);
final CheckBox checkBox = (CheckBox) findViewById(R.id.checkBox1);
final CheckBox checkBox2 = (CheckBox) findViewById(R.id.checkBox2);

final Button button = (Button) findViewById(R.id.button1);
button.setOnClickListener(new View.OnClickListener()
{
    public void onClick(View v) {

         if (checkBox.isChecked()) {

             { 

            SimpleDateFormat formatter = new SimpleDateFormat("MMMM dd, yyyy, h:mmaa"); 
            long lnsTime = 0, lneTime = 0;

                    Date dateObject;

                    try{
                    String dob_var = "August 16, 2012, 11:35PM";

                    dateObject = formatter.parse(dob_var);

                    lnsTime = dateObject.getTime();
                    Log.e(null, Long.toString(lnsTime));

                    dob_var = "August 16, 2012, 11:59PM";      

                    dateObject = formatter.parse(dob_var);

                    lneTime = dateObject.getTime();
                    Log.e(null, Long.toString(lneTime));
                    }

                    catch (java.text.ParseException e) 
                        {
                        // TODO Auto-generated catch block
                            e.printStackTrace();
                            Log.i("E11111111111", e.toString());
                        }

                 Intent intent = new Intent(Intent.ACTION_EDIT);

                     intent.setType("vnd.android.cursor.item/event");
                  intent.putExtra("title", "9:00AM Start");
                  intent.putExtra("description", "There will be a 9:00AM start tomorrow.");
                  intent.putExtra("eventLocation", "Chris' house");
                  intent.putExtra("beginTime", lnsTime);
                  intent.putExtra("endTime", lneTime);
                  startActivity(intent);

             }

    } 
```

到目前为止，代码创建的单个事件很好，只是我需要创建多个，最好没有“保存/取消”屏幕。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T04:11:38.183

您可以通过`onClick`在`onClickListener`. 就像您在代码中通过检查 if 所做的那样`checkbox isChecked()`，同样您可以通过实施以下建议来添加更多事件：-

1.  如果`checkbox2 isChecked()`
2.  如果`checkbox`和`checkbox2`两者都满足`isChecked()`条件，
3.  当以上都不满足时，您可以简单地指定另一个条件，即`else`条件。

好吧，通过使用上面提到的代码，您`onClick`可以在同一个按钮单击时指定四个事件。希望这可以帮助..

# java - 线程和枚举优化

> ID：12031219
> 
> 赞同：0
> 
> 时间：2012-08-20T01:03:03.997
> 
> 标签：java, jvm, enumeration

我在枚举中有一个方法，该方法由同时运行的许多线程调用。

因为 JVM 只允许在内存中分配一个枚举实例，所以我猜编译器或 JVM 本身在某处进行了一些优化，以避免线程等待 CPU 访问相同的位置该方法的内存，一遍又一遍地为每个线程执行该方法，造成瓶颈。

当我将线程数从 5 更改为 300（我通过 ScheduledExecutorService 执行它们）时，我发现系统的整体吞吐量没有差异。

是否真的进行了优化或事情与我想象的不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T01:07:26.683

如果所有方法都在访问（即读取）内存，则没有冲突。如果您不更改值，并且您没有在实例或静态变量中保存值，那么您的方法是“线程安全的”，无需同步。

要么你没有完全说明你的问题，要么没有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T01:19:00.017

您可能没有看到吞吐量有任何改善的原因是因为并行执行任务所节省的任何费用都可能被创建所有这些线程的费用所抵消，而无需任何代码或不知道您的程序在做什么，这很难说。请记住，即使使用线程池之类的技术，线程的创建和销毁也不是免费的，因此不能保证仅创建大量线程就可以提高吞吐量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T02:02:49.060

除非内存访问是只读的，即没有线程更新变量的值，否则吞吐量保持不变。如果您仍然相信并发问题，请尝试 JNI。

# xcode - 有没有办法关闭 xcode 4.x ( < 4.3 ) 中未声明方法的警告

> ID：12031222
> 
> 赞同：0
> 
> 时间：2012-08-20T01:03:56.630
> 
> 标签：xcode

我正在与山狮一起做一个项目，我只声明了公共方法，但我的另一个团队成员正在使用 4.2 的雪豹——由于我没有声明“私有方法”，她收到了一百万条警告。在我花时间更新所有 .h 文件之前，我想我会在这里问是否有一个简单的构建设置可以让它不会抱怨......？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T01:54:11.560

在 Xcode 的首选项中，您可以禁用“显示实时问题”并启用“出现错误后继续构建”。

![在此处输入图像描述](../Images/709e033ed21e2582815cf4af6bd1f123.png)

# python - 卷积音频信号

> ID：12031224
> 
> 赞同：1
> 
> 时间：2012-08-20T01:04:26.003
> 
> 标签：python, audio-fingerprinting, audio

我正在尝试为教育目的编写一个音频指纹库。它基于 [用于音乐识别的计算机视觉](http://www.cs.cmu.edu/~yke/musicretrieval/) 。我有几个与论文内容有关的问题。

1.  我知道两个字节代表一个样本，所以我编写了这个类来从 pcm 文件中提取样本。我想知道这是否正确（对不起，如果它太明显:)）。

    ```
    class FingerPrint:

       def __init__(self, pcmFile):
          self.pcmFile = pcmFile
          self.samples = []
          self.init()

       def init(self):
          # Current samples
          currentSamples = []

          # Read pcm file
          with open(self.pcmFile, 'rb') as f:
             byte = f.read(2)
             while byte != '':
               self.samples.append(byte)
               byte = f.read(2)

    fp = FingerPrint('output.pcm') 
    ```

2.  如果上面的代码没问题，那么根据书，接下来要做的就是用低通滤波器对信号进行卷积，并每 8 个样本进行一次。我不明白这些以及为什么必须这样做，如果有人可以帮助我理解，那就太棒了（如果可能的话，用代码）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T01:32:35.753

读取这两个字节后，需要将其转换为 int。您可以使用结构模块。

但我认为你应该使用 NumPy、SciPy：

要读取波形文件，您可以调用`scipy.io.wavfile.read()`

[http://docs.scipy.org/doc/scipy-0.10.0/reference/tutorial/io.html#module-scipy.io.wavfile](http://docs.scipy.org/doc/scipy-0.10.0/reference/tutorial/io.html#module-scipy.io.wavfile)

如果您的文件是原始 PCM 数据，您可以调用`numpy.fromfile()`

[http://docs.scipy.org/doc/numpy/reference/generated/numpy.fromfile.html](http://docs.scipy.org/doc/numpy/reference/generated/numpy.fromfile.html)

例如：

```
data = numpy.fromfile("test.pcm", dtype=np.int16) 
```

要设计低通滤波器，您可以使用 scipy.signal 中的滤波器设计函数：

[http://docs.scipy.org/doc/scipy-0.10.1/reference/signal.html#filter-design](http://docs.scipy.org/doc/scipy-0.10.1/reference/signal.html#filter-design)

要进行卷积，您可以在 scipy.signal 中使用卷积函数：

[http://docs.scipy.org/doc/scipy-0.10.1/reference/signal.html#convolution](http://docs.scipy.org/doc/scipy-0.10.1/reference/signal.html#convolution)

numpy中还有一个convolve函数：

[http://docs.scipy.org/doc/numpy/reference/generated/numpy.convolve.html](http://docs.scipy.org/doc/numpy/reference/generated/numpy.convolve.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T02:41:39.433

听起来您正在使用的算法正在执行过滤和抽取操作，以将数据的采样率降低 8 倍。这导致提供给其他下游函数的样本更少，这可能在计算上很昂贵，但是不需要输入数据的全部带宽。您引用的卷积函数正在使用与所需滤波器形状相对应的脉冲滤波器响应对输入数据执行低通滤波。这些是标准的信号处理操作，您应该能够在任何有关数字信号处理的文本中阅读它们。

# git - 将 Github 项目转向不同的方向

> ID：12031226
> 
> 赞同：1
> 
> 时间：2012-08-20T01:04:44.077
> 
> 标签：git, github

晚上好，

我发现了一个 github 项目，它有一个重要的代码库，可以让我完成 75% 的工作。它相对较新（即它可能会经常更新），我想按照自己的方向发展。

我对 git 还很陌生……有什么简单的方法可以让自己与 github 大师保持同步，同时又偏离了自己的方向？

即，如果我让我的本地主服务器与 github 存储库（git pull --ff-only 上游主服务器）保持同步，并在我自己的分支上工作，是否有一个简单的命令可以轻松地将我的所有提交应用到更新的主服务器分支，将两者分开？

（我敢肯定，对于熟悉 git 的人来说，这是一个相对简单的操作！）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T01:10:04.937

如果您有一个`master`根据远程 master 更新的分支，然后`self`是您自己工作的本地分支，您可以`combined`通过以下方式创建第三个集成两者的分支：

```
git checkout master -b combined
git merge self 
```

这将`combined`基于您的分支创建`master`分支，然后在您的`self`分支中合并，创建一个包含两个分支更改的结果。

或者，如果您希望在自己的工作分支中进行所有上游更改，您可以重复合并`master`到您的分支中。`self`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T01:12:43.563

您想使用 git rebase，它将移动分支上的所有提交，以便它们基于更新的主分支。

在问题中从上游更新 master 后，您可以

git rebase master 我的分支

现在好像 my-branch 是由最新的主提交制成的。

# internet-explorer - 2 个 div 在 Chrome 中溢出，但在 IE 中工作正常

> ID：12031228
> 
> 赞同：0
> 
> 时间：2012-08-20T01:05:21.413
> 
> 标签：internet-explorer, google-chrome, html

我正在为一个学校项目制作网页，没什么特别的。我刚刚在 IE 中完成了我的网站，但是当我尝试在 Chrome 中打开它时，它完全不同，如果有人有想法，我会很乐意提供帮助。

****__****HTML*****____*******

 *****```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
  <head>
    <title>The Corner Shop</title>
    <link rel="stylesheet" type="text/css" href="realstyle.css" />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
   </head>
  <body>
    <div id="menu1">
      <ul id="list-nav">
        <li>HOME</li>
        <li><a href="About us.html">ABOUT US</a></li>
        <li><a href="Menu.html">THE MENU</a></li>
        <li><a href="Gallery.html">THE GALLERY</a></li>
        <li><a href="Contact details.html">CONTACT US</a></li>
      </ul>
    </div> <!-- menu1 -->
    <div id="contentwrap">
      <div id="heading">
        <a href="index.html">
          <img border="0" src="GalleryI/Logo.jpg" width="170" height="150" alt="Logo" />
        </a>
      </div> <!-- heading -->
      <div id="content">
        <br />
        <br />
        <p id="texttitle">"The best burger joint around."</p>
        <p>Prepared and served with a passion.</p>
        <p id="textstuff">Using the freshest and best Australian ingredients, just for you.</p>
        <br />
        <br />
        <br />
        <p> This weeks special:</p>
        <br />
        <br />
        <img border= "5" src="GalleryI/beefburger.jpg" alt="Beef Burger Supreme" height="250" width="250" />
        <p>The Beef Burger Supreme $5.50</p>
      </div> <!-- content -->
    </div> <!-- contentwrap -->
  </body>
</html> 
```

****__****CSS*****____*******

 *****```
body {
  background-image: url("GalleryI/Background3.jpg");
  margin:0;
  padding:0;
}

a:link {
  color: White;
  text-decoration: none;
}

a:visited {
  color: White;
  text-decoration: none;
}

ul#list-nav {
  margin:0;
  margin-top: 0px;
  padding:0;
  list-style:none;
  font-family: Impact, Arial, sans-serif;
  text-transform:uppercase !important;
  font-size: 20px;
  float:left;
  /* text-decoration: bold; */
  white-space: nowrap;
}

ul#list-nav li {
  display:inline;
  color:white;
  position: relative;
  letter-spacing:2px;
  line-height:35px;
  /* margin:right; */
  color:#CD2626;
  padding: 25px 25px 0px 30px;
}

ul#list-nav li a {
  text-decoration:none;
  color:#ffffff;
  /* float:left; */
}

ul#list-nav li a {
  text-align:center;
}

ul#list-nav li a:hover {
  color:#CD2626;
}

#menu1 ul {
  text-align:center;
  width:100%;
  background:#000000;
}

#heading {
  height: 150px;
  width: 780px;
  background-image: url("GalleryI/fast-food-burger1.jpg");
  color: white;
  padding:5px 5px 5px 5px;
  text-align:left;
  margin:0 auto; 
  border: #000 5px solid;
}

#content {
  width: 800px;
  height: 650px;
  background-color: #090909;
  color: white;
  border-top: #000 5px solid;
  border-bottom: #000 5px solid;
  font-size: 18px;
  text-align:center;
  font-family: arial,sans-serif;
  color: #CCC;
  margin:0 auto;
  margin-top: 10px;
}

#contentmenu {
  width: 800px;
  height: 850px;
  background-color: #090909;
  color: white;
  border-top: #000 5px solid;
  border-bottom: #000 5px solid;
  font-size: 18px;
  text-align:center;
  font-family: arial,sans-serif;
  color: #CCC;
  padding:20px 0px 5px 0px;
  margin-top: 10px;
}

#contentwrap {
  text-align:center;
  width:100%;
  opacity:0.9;
  filter:alpha(opacity=90);
  background-color: red;
  margin-top: 0px;
  padding: 10px;
}

#texttitle {
  font-size: 24px;
  color: #CCCCCC;
  font-family: arial,sans-serif;
  font: italic bold;
}

#textstuff {
  font: arial,sans-serif;
  font-size: 18px;
}

#aboutuscontent {
  font: arial,sans-serif;
  font-size: 17px;
  padding: 10px 50px 50px 50px;
  text-align: left;
  margin: 40px;
}

#thing {
  color: red;
  font-size: 24px;
}

#thing2 {
  color: red;
  font-size: 24px;
}

#menutable {
  width: 700px;
  color: white;
  font-family: arial,sans-serif;
} 
```

* * *

其中一些没有意义，因为它影响了我没有链接的其他页面，但基本上问题是，这在 IE 中工作正常，但在`menu1 div`我`contentwrap div`的 Chrome 中，我不知道为什么会这样。谁能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T01:23:33.100

我把你的代码放在 Chrome 中，然后玩了一下。

你可以看到我在[这里做了什么](http://jsfiddle.net/_andrewclarkson/T5tj3/embedded/result/)

好像有一个：

```
float: left; 
```

在你的CSS规则下

```
ul#list-nav 
```

我把它注释掉了。

以防万一：如果您希望其中的元素*向左*浮动，请尝试将规则应用于这些元素。如果您希望它与包装器重叠，请尝试设置 z-index 或将包装器也应用于向左浮动。

非常感谢，祝你好运！**********

# django - 将网站从 Django 1.4 降级到 Django 1.3

> ID：12031230
> 
> 赞同：3
> 
> 时间：2012-08-20T01:05:31.687
> 
> 标签：django

我在 Django 1.4 中开发了一个网站，我想降级到 1.3，因为我有一个与 1.4 不兼容的模块，并且服务器已经安装了 Django 1.3。我该怎么做才能做到这一点？谢谢-

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T12:01:31.693

你为什么不使用virtualenv？

这将允许您使用它自己的 django (1.4) 副本运行此应用程序，而不会影响服务器的其余部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T04:58:01.853

我会仔细阅读1.4 的[发行说明](https://docs.djangoproject.com/en/dev/releases/1.4/)，尤其是向后不兼容的更改，注意 1.4 中的所有新内容并且正在您的项目中使用，并且必须直接进行更改。

然后，如果您有一个测试套件（在这种情况下会很有帮助），请针对 1.3 运行它。如果不是，那么，至少获得最小的覆盖率，基本上 GET 你所有的视图，然后运行 ​​1.3。否则，就像伊格纳西奥说的那样，只需插入并祈祷 :)

# python - 在 Python 中使用 win32com.client 文本到语音/语音识别

> ID：12031231
> 
> 赞同：0
> 
> 时间：2012-08-20T01:05:38.800
> 
> 标签：python, speech-recognition, text-to-speech

因此，我将文本转为语音部分，例如：

```
from win32com.client import constants
import win32com.client
import pythoncom
speaker = win32com.client.Dispatch("SAPI.SpVoice")
speaker.Speak("message") 
```

但我不知道该怎么做是使用上述系统进行语音识别（如果这甚至有语音识别）。更具体地说，文本系统的口头替代

```
variable = string(input("Question")). 
```

我需要用它来制作一个系统来解析我的语音，然后使用现在的关键字来调用不同的函数。确实，我需要相当于这样做的语音识别：

```
WORD_LIST_ONE = ('term', 'term'...)
variable = string(input("Question?"))
if variable in WORD_LIST_ONE:
    function() 
```

所以基本上，我用什么来解析用户语音？另外，如果这个系统不包括语音识别，请指点我做的事情。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T14:42:13.387

看看[https://stackoverflow.com/a/6351055/90236](https://stackoverflow.com/a/6351055/90236)。你没有说你运行的是什么操作系统，但 Windows 7 和 Vista 都带有完整的语音识别引擎。对于 Microsoft 的 Windows 服务器，您可以下载免费的服务器语音引擎，请参阅[http://www.microsoft.com/en-us/download/details.aspx?id=27226](http://www.microsoft.com/en-us/download/details.aspx?id=27226)。

还有一个 Python 模块，我看到人们提到它可能会对您有所帮助。请参阅[http://code.google.com/p/pyspeech/](http://code.google.com/p/pyspeech/)

如果您使用的是 SAPI API，则您正在访问 Microsoft 语音的 C++/COM 接口。请参阅[http://msdn.microsoft.com/en-us/library/ms723627(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ms723627(v=vs.85).aspx)。

如果您可以访问 .NET 接口 (System.Speech)，您可能会发现它更容易。请参阅[http://msdn.microsoft.com/en-us/library/hh361625](http://msdn.microsoft.com/en-us/library/hh361625)和[http://msdn.microsoft.com/en-us/magazine/cc163663.aspx](http://msdn.microsoft.com/en-us/magazine/cc163663.aspx)

# android - Android ViewPager 仅在 Galaxy Nexus 上不填充屏幕

> ID：12031233
> 
> 赞同：0
> 
> 时间：2012-08-20T01:05:49.013
> 
> 标签：android, android-layout, imageview, android-viewpager, android-imageview

我正在尝试创建一个占据整个屏幕的 ViewPager。在 ViewPager 的每个片段中，我都有一个显示半透明图片的 ImageView。

出于某种原因，当我在 Galaxy Nexus (4.0.4) 上尝试我的解决方案时，它会在 ViewPager 的左侧和右侧留下一个边框，如下所示：

![出现 ViewPager 问题的 Galaxy Nexus 屏幕截图](../Images/8eb9340fb5222c07e8eebf95e7dea4ef.png)

我已经在以下设备上尝试过，但没有**出现**这个问题：

*   连结 S (4.1.1)
*   连结一号 (2.3.6)
*   进化版 4G (CM7.2, 2.3.7)
*   安卓模拟器

任何人都可以查看[简化的源代码](https://bitbucket.org/gautamjain/transparencytest/src)并帮助我（特别是如果您有 Galaxy Nexus）？谢谢！

[顺便说一句，这是我自己解决早期问题](https://stackoverflow.com/questions/12013334/how-do-you-create-a-transparent-demo-screen-for-an-android-app)的尝试，对此我无法得到正确的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:57:32.253

我再次检查了我的代码并尝试评论/取消评论部分，看看我是否可以摆脱这个问题。

我将其缩小到我应用于我的活动的自定义样式。在其中，我有以下项目：

```
<item name="android:windowIsFloating">true</item> 
```

删除这个项目解决了这个问题，虽然我仍然不明白为什么。也许与这个问题有关 -[如何在没有 windowIsFloating 的情况下创建透明活动](https://stackoverflow.com/questions/7888263/how-to-create-a-transparent-activity-without-windowisfloating)

在阅读以下问题后，我最初包含了这个项目 - [如何在 Android 上创建一个透明的活动？](https://stackoverflow.com/questions/2176922/how-to-create-transparent-activity-in-android)

无论如何，我希望这可以为其他人节省大量调试时间。

# javascript - 标签不订阅事件

> ID：12031239
> 
> 赞同：0
> 
> 时间：2012-08-20T01:07:36.773
> 
> 标签：javascript, javascript-events

给定以下代码：

```
<!DOCTYPE html> <!-- HTML5 -->
<html>
    <head>
        <meta http-equiv="Expires" content="Fri, Jan 01 1900 00:00:00 GMT">
        <meta http-equiv="Pragma" content="no-cache">
        <meta http-equiv="Cache-Control" content="no-cache">
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
        <meta http-equiv="content-language" content="en">
        <title>Untitled</title>
        <script type='text/javascript'>
            function createTableRow() {
                var tr = document.createElement("tr");
                var strWork = "<tr onmouseover='this.style.cursor=\"pointer\";'";
                strWork += " onmouseout='this.style.cursor=\"auto\";'";
                strWork += " onclick='ShowClick(this);'";
                strWork += " id='TestCell'><td>Test!</td></tr>";
                alert(strWork);
                tr.outerHTML = strWork;
                return tr;
            }

            function BuildTable() {
                var table = document.createElement("table");
                table.appendChild(createTableRow());
                return table;
            }

            function ShowClick(obj) {
                alert(obj.id);
            }
        </script>
    </head>
    <body onload='alert(BuildTable().outerHTML);'>
    &nbsp;
    </body>
</html> 
```

第一个“警报”对话框显示了我希望形成的标记，但是，“onload=alert”行返回结果“<table><tr></tr></table>”。

我究竟做错了什么？为什么这些事件不绑定到 TR 标签？

另外，我想补充一点，我最初使用 javascript 分配了事件，即：

```
tr.onclick = function() { ShowClick(this); }; 
```

但是得到了完全相同的结果...

我真的不明白，我在任何地方都找不到关于这个问题的任何讨论......任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T01:24:24.883

您的 createTableRow 功能已关闭...

您已经创建了“tr”作为对象。然后你放在`"<tr"`下一行。作为`strWork`变量的一部分。您基本上是在重复该任务，这会破坏 DOM。

```
function createTableRow ( ) {
    var tr = document.createElement("tr");
    tr.setAttribute("onmouseover" , "this.style.cursor='pointer';");
    tr.setAttribute("onmouseout" , "this.style.cursor='auto';");
    tr.setAttribute("onclick" , "showClick(this);");
    tr.setAttribute("id" , "TestCell");
    var td = document.createElement("td");
    td.appendChild(document.createTextNode("Test!"));
    tr.appendChild(td);

    return tr;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T02:55:33.273

其他答案有有用的信息，这里有更多。如果你想使用标记来初始化一个 DOM 片段，你最好创建一个父节点并将标记作为它的 innerHTML 插入，例如：

```
function createTableRow() {
  var tBody = document.createElement('tbody');
  var strWork = "<tr onmouseover='this.style.cursor=\"pointer\";'"
              + " onmouseout='this.style.cursor=\"auto\";'"
              + " onclick='ShowClick(this);'"
              + " id='TestCell'><td>Test!</td></tr>";
  tBody.innerHTML = strWork;
  return tBody.firstChild;
} 
```

但这在大多数版本的 IE 中都不起作用，因为您不能使用 innerHTML 或 outerHTML 来创建表格的一部分，尽管您可以使用它来创建整个表格。

此外，（再次在 IE 中），您必须将 tr 元素添加到 tbody 元素，而不是直接添加到表格，因为 tr 不能是表格的子元素，它必须是 tbody 的子元素——人们说 IE 是不符合标准，:-)

最重要的是，根据其他答案，您最好使用纯 DOM 来创建表格，而不是标记。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T01:31:26.737

`NO_MODIFICATION_ALLOWED_ERR`您的代码在 JavaScript 控制台中抛出 a 。[W3C 规范](http://html5.org/specs/dom-parsing.html#outerhtml)有这样的说法：

> [ `element.outerHTML`]`NO_MODIFICATION_ALLOWED_ERR`如果元素的父节点是`Document`节点，则抛出异常。

同样的事情也发生在您的代码中。您在将`tr`'`outerHTML` **附加到另一个节点**（例如`table`）之前设置它。这就是为什么它`outerHTML`不能改变。

最简单的解决方案是不使用`outerHTML`. 试试你原来的方法：

```
function createTableRow() {
  var tr = document.createElement('tr');
  tr.onmouseover = function() {
    this.style.cursor = 'pointer';
  };
  tr.onmouseout = function() {
    this.style.cursor = 'auto';
  };
  tr.onclick = function() {
    ShowClick(this);
  };
  tr.id = 'TestCell';
  tr.innerHTML = '<td>Test!</td>';
  return tr;
} 
```

请注意，当您`alert`（或`console.log`）`table`'s`outerHTML`时，您会看到如下内容：

```
<table><tr id="TestCell"><td>Test!</td></tr></table> 
```

但不要让那个愚弄你。事件处理程序没有显示出来，但那是因为它们直接附加到 DOM 节点，从而绕过了 HTML。请放心，它们可以完美运行。

要亲眼看看，**试试这个现场演示：[jsbin.com/oterit/1/edit](http://jsbin.com/oterit/1/edit)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T01:28:50.683

您缺少实际*将*表格添加到正文的部分，即：

```
document.body.appendChild(table); 
```

无论哪种方式，在浏览器中`outerHTML`创建`tr`和`td`使用`document.createElement`都非常不一致，你最好的选择是使用`table.insertRow`和`row.insertCell`：

```
function createTableRow(table) {
  var tr = table.insertRow(0);
  tr.onmouseover = function () { this.style.cursor = "pointer"; }
  tr.onmouseout = function () { this.style.cursor="auto"; }
  tr.onclick = function () { ShowClick(tr); }
  tr.id = "TestCell";
  var cell = tr.insertCell(0);
  cell.innerHTML = "Test!";
}

function BuildTable() {
  var table = document.createElement("table");
  table.appendChild(createTableRow());
  document.body.appendChild(table); // here's where you add the table to the page
  return table;
} 
```

这是一个[jsfiddle](http://jsfiddle.net/DVhRG/1/)示例。

# php - 使用 Xpath 访问表上的子项

> ID：12031247
> 
> 赞同：0
> 
> 时间：2012-08-20T01:08:15.197
> 
> 标签：php, dom, xpath

我正在尝试使用 XPath 访问 Dom 的特定元素

这是一个例子

```
<table>
<tbody>
    <tr>
        <td>
            <b>1</b> <a href="http://www.url.html">data</a><br>
            <b>2</b> <a href="http://www.url.html">data</a><br>
            <b>3</b> <a href="http://www.url.html">data</a><br>
        </td>
    </tr>
</tbody>
</table> 
```

我想定位“table td”，所以我在 Xpath 中的查询类似于

```
$finder->query('//table/td'); 
```

只有这不会将 td 作为其子子项返回，并且直接访问将使用

```
$finder->query('//tr/td'); 
```

有没有更好的方法来编写查询，它允许我使用第一个示例之类的东西，忽略中间的元素并返回 TD？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T01:28:02.867

> 有没有更好的方法来编写查询，它允许我使用第一个示例之类的东西，忽略中间的元素并返回 TD？

你*可以*写：

```
//table//td 
```

**然而，这真的“更好”吗？**

*在许多情况下，对 XPath伪运算符* 的评估`//`会导致效率显着降低，因为它会导致遍历以上下文节点为根的整个子树。

**只要到想要的节点的路径是静态已知的，`//`用特定的已知路径**替换任何路径可能会更有效，从而避免完整的子树遍历。

**对于提供的 XML 文档，这样的表达式是**：

```
/*/*/tr/td 
```

如果有多个`table`元素，每个元素都是顶部元素的子元素，并且我们只想选择`td`forst 的 s `table`，一个好的、具体的表达式是：

```
/*/table[1]/*/tr/td 
```

**如果我们只想选择同一个文档中`td`的第`table`**一个，一个好方法是：

```
(/*/table[1]/*/tr//td)[1] 
```

**或者，如果我们想选择`td`XML 文档中**的第一个（事先不知道它的结构），那么我们可以这样指定：

```
(//td)[1] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T01:11:18.103

哦，天哪，天哪，有一些不常见的东西。
至于您的第一个 xpath 查询，您可以只返回您想要的，但在标记名之前使用双 //

但是，我不明白为什么你不只是想通过标记名获取 td ......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T01:15:30.503

您正在寻找的是：

```
$finder->query('//table//td'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T01:18:32.187

你也可以这样写：-

```
$finder->query('//td'); 
```

# objective-c - 编写许多小方法是否会对 Objective-C 的性能产生影响？

> ID：12031249
> 
> 赞同：6
> 
> 时间：2012-08-20T01:08:27.357
> 
> 标签：objective-c, performance, dynamic-dispatch

我来自 Ruby，有点采用单一职责原则、封装、松耦合、可测试的小方法等方法论，所以我的代码往往会频繁地从一个方法跳到另一个方法。这就是我习惯在 Ruby 世界中工作的方式。我认为这是最好的工作方式，主要是用于 BDD，因为一旦你开始拥有执行多项操作的“大型”方法，测试就会变得非常困难。

我想知道这种方法在性能上是否存在明显差异？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T01:13:23.030

是的，除非你有一个内联的编译器，否则总会有一些性能影响，但是如果你做动态方法查找（如 Ruby 和 Obj-C），你不能内联，所以会有一些影响。但是，它实际上取决于语言和调用约定。如果你在 Objective-C 中有一个调用，你知道开销将是使用 C 调用约定一次（调用`objc_msg_send`），然后是方法查找，然后是某种跳转（很可能也是 C 调用约定，但可以是任何东西）。但是，您必须记住，除非您正在编写 C 和汇编，否则几乎看不出有任何区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T01:11:35.967

虽然不一定是特定于 Object-C 的，但编译器在非解释或非动态调度语言/运行时中没有内联的太多方法调用会造成性能损失，因为每次调用新函数都需要在堆栈以及设置一个新的堆栈帧，当被调用者返回给调用者时必须清理该堆栈帧。此外，通过引用传递变量的函数可能会导致性能损失，因为函数调用被认为对编译器不透明，从而消除了编译器进行优化的能力......换句话说，编译器无法重新排序读/写操作对作为可修改参数传递给函数的内存地址的函数调用（即指向非`const`对象），因为如果对操作进行重新排序，这些内存地址可能会产生副作用。

我认为，尽管最终您只会在紧密的 CPU 绑定循环中真正注意到这些性能损失。例如，任何进行 OS 系统调用的函数调用实际上都可能导致您的程序丢失其在 OS 调度程序中的时间片或被抢占，这将花费比任何函数调用本身更长的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T01:19:23.840

确实存在一些性能影响。然而，大多数系统的性能主要由 I/O 控制，因此方法调度开销只是性能图的一小部分。如果您正在开发一个方法调度开销很大的应用程序，您可能会考虑使用具有更多调度选项的语言进行编码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T02:37:25.437

Objective-C 中的方法调用相对昂贵（可能至少比 C++ 或 Java 慢 10 倍）。（事实上​​，由于“鸭子类型”等原因，我不知道是否有任何标准的 Objective-C 方法调用是或可以是内联的。）

但在大多数情况下，Objective-C 的性能主要由 UI 操作（以及 IO 操作和网络操作）支配，普通代码的效率无关紧要。只有当您进行一些密集的计算时，才会关注性能。

# firefox - Selenium WebDriver 默认使用什么配置文件？

> ID：12031253
> 
> 赞同：17
> 
> 时间：2012-08-20T01:09:30.210
> 
> 标签：firefox, selenium, selenium-webdriver

Selenium WebDriver（又名 Selenium 2）在哪里获取它在打开 FirefoxDriver 时使用的匿名配置文件？如果它使用 Firefox 的默认值，%appdata%/roaming/mozilla/firefox/profiles，那么如果我要禁用一个 firefox 插件，它也应该为 Selenium WebDriver 禁用，那为什么不呢？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-20T07:33:09.317

我会回答它，支持来自@twall 的评论：在 Selenium 2 WebDriver 中启动 firefox 时，它会启动新的匿名配置文件。

但是，如果您想更改它，您可以[创建新的 Firefox 配置文件](http://girliemangalo.wordpress.com/2009/02/05/creating-firefox-profile-for-your-selenium-rc-tests/)并以某种方式命名它，您知道它是什么 - 例如`SELENIUM`

然后在您的代码中执行以下操作：

```
 ProfilesIni profile = new ProfilesIni();
 FirefoxProfile ffprofile = profile.getProfile("SELENIUM");
 WebDriver driver = new FirefoxDriver(ffprofile); 
```

这样，Firefox 将始终启动该配置文件。在配置文件中，您进行所需的所有设置

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-21T13:31:35.763

您可以为每个 Selenium 网格 2 节点分配一个特定的 firefox 配置文件：

> java -jar selenium-server-standalone-2.37.0.jar **-Dwebdriver.firefox.profile** =my-profile -role node -hub [http://example-server.org:4444/grid/register](http://example-server.org:4444/grid/register)

请注意， webdriver.firefox.profile 的值必须是**firefox 配置文件名称**，而不是位置或文件夹名称

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-30T07:51:45.180

当在测试服务器上运行 webdriver 而没有在机器上创建配置文件的选项时，您可以通过编程方式创建配置文件：

```
private FirefoxProfile GetFirefoxProfile()
{
    FirefoxProfile firefoxProfile = new FirefoxProfile();
    firefoxProfile.SetPreference("network.automatic-ntlm-auth.trusted-uris", "http://localhost");
    return firefoxProfile;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-04T03:09:27.527

获取配置文件没有用，因为它在内部创建了获取的命名配置文件的另一个副本。在以下情况下需要访问原始配置文件：测试覆盖率数据应跨多个调用写入数据存储。

这是通过覆盖 Selenium 的 ProfilesIni 类的可能解决方案

首先使用 firefox -p 创建自定义配置文件，例如“CustomSeleniumProfile”

```
ProfilesIni profileini = new ProfilesIni() {
    @Override
    public FirefoxProfile getProfile(String profileName) {
            File appData = locateAppDataDirectory(Platform.getCurrent());
            Map<String, File> profiles = readProfiles(appData);
            File profileDir = profiles.get(profileName);
            if (profileDir == null)
              return null;
            return new FirefoxProfile(profileDir);
     }
};
FirefoxProfile profile = profileini.getProfile("CustomSeleniumProfile");
//profile.setEnableNativeEvents(false);

driver = new FirefoxDriver(profile);
//ffDriver.manage().deleteAllCookies();
driver.get("http://www.google.com"); 
```

# visual-studio-2010 - Web 配置转换

> ID：12031254
> 
> 赞同：3
> 
> 时间：2012-08-20T01:09:41.753
> 
> 标签：visual-studio-2010, visual-studio, command-line, web-config

这是一种使用独立 Web 配置转换工具的方法，它使用与 Visual Studio 的配置管理器用于实现多个部署环境的相同修改。在此示例中，我正在转换连接字符串以部署到云平台。（对于这个例子来说，优秀的 UhuruCloud。）

我的需要是我试图执行 VS Config 转换，但不需要一键式部署支持。我的云主机提供了一个用于管理部署的插件，因此我无法使用为您运行它的 Visual Studio 的一键式部署程序，而没有确切显示它是如何执行的。但是 VS 很容易创建转换文件，所以我想利用它。

**使用 Visual Studio 创建您的转换模板。**
1.在VS中，选择Build - Configuration Manager - New...，例如命名为UhuruCloud。
2\. 在解决方案资源管理器中，右键单击您的 Web.Config 文件并选择“添加配置转换”
3\. 为转换编辑生成的 Web.UhuruCloud.config。

**使用独立的 Config Transform 独立工具。**[从http://ctt.codeplex.com/Wikipage?ProjectName=ctt](http://ctt.codeplex.com/Wikipage?ProjectName=ctt)
获取该工具该工具 的语法如下：

```
ctt.exe s:source.config t:transform.config d:destination.config 
```

**使用独立的 Config Transform 独立工具。**[从http://ctt.codeplex.com/Wikipage?ProjectName=ctt](http://ctt.codeplex.com/Wikipage?ProjectName=ctt)
获取该工具该工具 的语法如下：

```
ctt.exe s:source.config t:transform.config d:destination.config 
```

这只是最基本的用法。分发中提供了其他很好的示例。对我来说，有一个快速的批处理脚本来简化调用是很方便的。尤其是在试图让路径恰到好处的时候。

```
File: ctt_run.bat
@ECHO off
rem ... Use the Config Transform standalone Tool (CTT),  
rem ... from http://ctt.codeplex.com/Wikipage?ProjectName=ctt
rem ... Basic CTT syntax is "ctt.exe s:source.config t:transf.config d:dest.config"
rem ... Set the (S)ource, (T)ransformTemplate, and (D)estination files here.
SET S=C:\tfs-hill\MvcITunes1\MvcITunes1\Web.config
SET T=C:\tfs-hill\MvcITunes1\MvcITunes1\Web.UhuruCloud.config
SET D=Web.New.config
@ECHO on
C:\Common\ctt.exe s:%S% t:%T% d:%D% 
```

而已。（我的示例编写了转换后的文件 Web.New.config。）
我希望这对尝试执行 VS 配置转换但不需要一键式部署支持的人有所帮助。

# validation - CakePHP :: 自定义验证方法返回什么？

> ID：12031258
> 
> 赞同：0
> 
> 时间：2012-08-20T01:10:34.590
> 
> 标签：validation, cakephp, cakephp-2.0

我有一个自定义验证规则，以确保在字段中设置非零价格。我在该字段中有一个占位符（0.00），以防止用户输入美元符号等内容。然而，当我去验证一个非零条目时，`$this->data[$this->alias]['price']`在我的测试中是“0.00”，但验证正在工作 - 它无效。但是当我输入 1000.00 时，它也是无效的。

我找不到的一件事是从自定义验证字段返回什么/如何使该字段无效。目前，代码为：

```
public function notZeroPrice($check){
    if ($check == '0.00')
        return true;

    return false;
} 
```

文档对两者的结构都不清楚`$check`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T02:39:11.393

如果验证，则返回 true。如果不是，则返回 false。

但是，您的验证方法一开始就有缺陷。`$check`如果你调试它是一个数组，所以你的方法总是会返回 false。其次，您要测试它是否 > 0，而不仅仅是等于 '0.00'。您将比较 2 个字符串，这样也不起作用。

相反，如果值大于 0 (int)，则返回 true。您可以使用`array_shift($check)`;轻松地从数组中获取它的值

```
return array_shift($check) > 0; // or something similar. 
```

你甚至可以逃脱`'rule' => array('comparison', '>', 0),`核心验证。

（我假设价格不为零也意味着不是负价格）

# android - SherlockFragmentActivity setSupportProgressBarIndeterminateVisibility 不起作用

> ID：12031263
> 
> 赞同：3
> 
> 时间：2012-08-20T01:12:31.143
> 
> 标签：android, actionbarsherlock

我正在尝试在其中显示不确定的进度条，`SherlockFragmentActivity` 但我的代码仅显示 ActionBar 而没有`ProgreessBar`其中

这是我在 Android 4.1.1 中运行的代码

```
import com.actionbarsherlock.view.Window;
....
....
public class SowahActivity extends SherlockFragmentActivity{
....
...
...
protected void onCreate(Bundle savedInstanceState) {

        requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);
        setSupportProgressBarIndeterminateVisibility(true);
        super.onCreate(savedInstanceState);
        setContentView(R.layout.my_list_view);
}
...
...
} 
```

是什么让进度对话框没有出现在操作栏中

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T01:18:35.403

您正在尝试在`Activity`创建之前设置进度条。尝试像这样重新排序：

```
requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);
super.onCreate(savedInstanceState);
setContentView(R.layout.my_list_view);
setSupportProgressBarIndeterminateVisibility(true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T03:48:06.277

```
 //This has to be called before setContentView and you must use the
        //class in com.actionbarsherlock.view and NOT android.view
        requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS); 
```

# ruby-on-rails - 使用 shoulda 重构 Rails 模型上的 rspec 测试

> ID：12031265
> 
> 赞同：11
> 
> 时间：2012-08-20T01:13:06.927
> 
> 标签：ruby-on-rails, rspec, refactoring, railstutorial.org, shoulda

在通过回答[关于属性可访问性测试的另一个 StackOverflow 问题](https://stackoverflow.com/a/11849608/567863)（并认为它们非常棒）了解了[shoulda-matchers之后，我决定尝试重构我在](https://github.com/thoughtbot/shoulda-matchers)[Rails 教程](http://ruby.railstutorial.org/)中所做的模型测试，以使它们更加简洁和彻底。[我之所以](https://stackoverflow.com/a/4611017/567863)这样做，是因为模块文档和. 但是，仍有一些事情我不确定，我想知道如何才能使这些测试变得更好。 [`Shoulda::Matchers::ActiveRecord`](http://rubydoc.info/github/thoughtbot/shoulda-matchers/master/frames)[`Shoulda::Matchers::ActiveModel`](http://rubydoc.info/github/thoughtbot/shoulda-matchers/master/frames)

我将使用 Rails 教程中的用户规范作为我的示例，因为它是最详细的，并且涵盖了许多可以改进的领域。以下代码示例已从原始[**user_spec.rb**](https://github.com/railstutorial/sample_app_2nd_ed/blob/master/spec/models/user_spec.rb)更改，并将代码替换到该`describe "micropost associations"`行。该规范针对[**user.rb**](https://github.com/railstutorial/sample_app_2nd_ed/blob/master/app/models/user.rb)模型进行测试，其工厂在 factory.rb 中[**定义**](https://github.com/railstutorial/sample_app_2nd_ed/blob/master/spec/factories.rb)。

**规格/模型/user_spec.rb**

```
# == Schema Information
#
# Table name: users
#
#  id              :integer          not null, primary key
#  name            :string(255)
#  email           :string(255)
#  created_at      :datetime         not null
#  updated_at      :datetime         not null
#  password_digest :string(255)
#  remember_token  :string(255)
#  admin           :boolean          default(FALSE)
#
# Indexes
#
#  index_users_on_email           (email) UNIQUE
#  index_users_on_remember_token  (remember_token)
#

require 'spec_helper'

describe User do

  let(:user) { FactoryGirl.create(:user) }

  subject { user }

  describe "database schema" do
    it { should have_db_column(:id).of_type(:integer)
                              .with_options(null: false) }
    it { should have_db_column(:name).of_type(:string) }
    it { should have_db_column(:email).of_type(:string) }
    it { should have_db_column(:created_at).of_type(:datetime)
                              .with_options(null: false) }
    it { should have_db_column(:updated_at).of_type(:datetime)
                              .with_options(null: false) }
    it { should have_db_column(:password_digest).of_type(:string) }
    it { should have_db_column(:remember_token).of_type(:string) }
    it { should have_db_column(:admin).of_type(:boolean)
                              .with_options(default: false) }
    it { should have_db_index(:email).unique(true) }
    it { should have_db_index(:remember_token) }
  end

  describe "associations" do
    it { should have_many(:microposts).dependent(:destroy) }
    it { should have_many(:relationships).dependent(:destroy) }
    it { should have_many(:followed_users).through(:relationships) }
    it { should have_many(:reverse_relationships).class_name("Relationship")
                         .dependent(:destroy) }
    it { should have_many(:followers).through(:reverse_relationships) }
  end

  describe "model attributes" do
    it { should respond_to(:name) }
    it { should respond_to(:email) }
    it { should respond_to(:password_digest) }
    it { should respond_to(:remember_token) }
    it { should respond_to(:admin) }
    it { should respond_to(:microposts) }
    it { should respond_to(:relationships) }
    it { should respond_to(:followed_users) }
    it { should respond_to(:reverse_relationships) }
    it { should respond_to(:followers) }
  end

  describe "virtual attributes and methods from has_secure_password" do
    it { should respond_to(:password) }
    it { should respond_to(:password_confirmation) }
    it { should respond_to(:authenticate) }
  end

  describe "accessible attributes" do
    it { should_not allow_mass_assignment_of(:password_digest) }
    it { should_not allow_mass_assignment_of(:remember_token) }
    it { should_not allow_mass_assignment_of(:admin) }
  end

  describe "instance methods" do
    it { should respond_to(:feed) }
    it { should respond_to(:following?) }
    it { should respond_to(:follow!) }
    it { should respond_to(:unfollow!) }
  end

  describe "initial state" do
    it { should be_valid }
    it { should_not be_admin }
    its(:remember_token) { should_not be_blank }
    its(:email) { should_not =~ /\p{Upper}/ }
  end

  describe "validations" do
    context "for name" do
      it { should validate_presence_of(:name) }
      it { should_not allow_value(" ").for(:name) }
      it { should ensure_length_of(:name).is_at_most(50) }
    end

    context "for email" do
      it { should validate_presence_of(:email) }
      it { should_not allow_value(" ").for(:email) }
      it { should validate_uniqueness_of(:email).case_insensitive }

      context "when email format is invalid" do
        addresses = %w[user@foo,com user_at_foo.org example.user@foo.]
        addresses.each do |invalid_address|
          it { should_not allow_value(invalid_address).for(:email) }
        end
      end

      context "when email format is valid" do
        addresses = %w[user@foo.COM A_US-ER@f.b.org frst.lst@foo.jp a+b@baz.cn]
        addresses.each do |valid_address|
          it { should allow_value(valid_address).for(:email) }
        end
      end
    end

    context "for password" do
      it { should ensure_length_of(:password).is_at_least(6) }
      it { should_not allow_value(" ").for(:password) }

      context "when password doesn't match confirmation" do
        it { should_not allow_value("mismatch").for(:password) }
      end
    end

    context "for password_confirmation" do
      it { should validate_presence_of(:password_confirmation) }
    end
  end

  # ...
end 
```

关于这些测试的一些具体问题：

1.  是否值得测试数据库模式？[上面提到的 StackOverflow 答案中](https://stackoverflow.com/a/4611017/567863)的一条评论说“我只测试与行为相关的东西，我不考虑列或索引行为的存在。除非有人故意删除它们，否则数据库列不会消失，但是你可以通过代码审查和信任来防止这种情况”，我同意这一点，但是是否有任何正当理由可以测试数据库模式的结构，从而证明 `Shoulda::Matchers::ActiveRecord`模块的存在是合理的？也许只有重要的指标值得测试......？
2.  下的`should have_many`测试是否`"associations"`替换`should respond_to`下相应的测试`"model attributes"`？我无法判断`should have_many`测试是只是在模型文件中查找相关`has_many`声明，还是实际上执行与`should respond_to`.
3.  您是否有任何其他意见/建议可以使这些测试在内容和结构上更简洁/可读/彻底？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T00:34:17.283

1) Shoulda::Matchers::ActiveRecord 模块中包含的不仅仅是列和索引匹配器。我会在[包含的课程](https://github.com/thoughtbot/shoulda-matchers/tree/master/lib/shoulda/matchers/active_record)中挖掘一下，看看你能找到什么。这就是`have_many`,`belong_to`等的来源。不过，作为记录，我认为其中的大部分内容几乎没有价值。

2）是的，诸如`have_many`测试之类的宏比模型是否响应方法要多得多。从[源代码](https://github.com/thoughtbot/shoulda-matchers/blob/master/lib/shoulda/matchers/active_record/association_matcher.rb#L108-120)中，您可以确切地看到它正在测试什么：

```
def matches?(subject)
  @subject = subject
  association_exists? &&
    macro_correct? &&
    foreign_key_exists? &&
    through_association_valid? &&
    dependent_correct? &&
    class_name_correct? &&
    order_correct? &&
    conditions_correct? &&
    join_table_exists? &&
    validate_correct?
end 
```

3) 使测试更具可读性和/或简洁性绝对是一个需要回答的主观问题。每个人都会根据他们的背景和经验给你不同的答案。我个人会摆脱所有`respond_to`测试并用有价值的测试替换它们。当有人查看您的测试时，他们应该能够理解该类的公共 API。当我看到您的对象对“跟随？”之类的内容做出响应时，我可以做出假设，但并不真正知道这意味着什么。需要争论吗？它是否返回布尔值？对象是跟随某物还是某物跟随该对象？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T00:54:11.837

你的问题涉及到几点，我想谈谈其中两个：

答案是主观的，所以我会给你我个人的看法。

**1) 以这种方式测试 ActiveRecord？**
我的回答是肯定的。你可以用真实数据编写复杂的测试，但如果你基本上信任 ActiveRecord，你可以这样做，如果你开始做 tdd，首先通过这些测试，它们可以在这个过程中提供帮助。

**2) 编写模型测试？**
我的回答是肯定的。我所做的是关注控制器并在快乐路径上请求规范，然后对于需要验证等的情况，我为它们编写单元模型测试。事实证明，这对我来说是一个很好的责任分工。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T05:54:46.907

我认为这整件事应该从规范的角度来看。

如果您有一个组件测试级别的规范，它涵盖了给定模型的必要数据库列，那么您应该这样做，否则不应该这样做。

如果没有涵盖，但作为一个负责任的开发人员，你觉得拥有它很重要（你的软件和它的质量特性更好），你必须安排在规范中包含这些信息，然后你可以把这些测试放在测试套件中.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T14:07:21.393

较低的测试级别的要求主要来自您的组织内部（内部文档），客户大多只提供客户需求规范（假设这是测试 V 模型的最高级别）。当您的组织开始设计时，软件会逐步创建较低的测试级别规范。

对于“我们真的需要这个”问题：这取决于很多因素：应用程序的复杂性、安全性与否、要遵循的标准、合同/法律/行业法规等。

一般来说，我会说，对于一个正确的理想应用程序，负责单元测试的需求应该编写单元级规范，测试人员应该根据这个规范实施测试。

对于“have_many 和 respond_to”，恐怕我没有背景信息它们是如何实现的，所以无法回答。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T03:50:38.603

我发现为数据库列的存在编写测试有一些价值。原因如下：

1) 编写它们让我保持在 TDD 的节奏中。
2）迁移通常非常棒，直到它们不是。我知道您不应该编辑现有的迁移，但是当我自己做某事时，我有时还是会这样做。如果其他人正在开发同一个应用程序并更改现有迁移而不是编写新迁移，那么这些测试对我来说很快就会隔离问题。

如果您陷入了太多列名和类型的困扰，您可以执行以下操作来节省自己的输入：

```
describe User do

  describe 'database' do 

    describe 'columns' do 

      %w[reset_password_sent_at remember_created_at current_sign_in_at 
        last_sign_in_at confirmed_at confirmation_sent_at 
        created_at updated_at
        ].each do |column|
        it { should have_db_column(column.to_sym).of_type(:datetime) }
      end
    end

    describe 'indexes' do 

      %w[confirmation_token email reset_password_token
      ].each do |index|
        it { should have_db_index(index.to_sym).unique(true)}
      end
    end
  end  
end 
```

希望有帮助。

# gcc - 是否可以更改任务的 OpenMP 调度程序？

> ID：12031269
> 
> 赞同：2
> 
> 时间：2012-08-20T01:14:08.470
> 
> 标签：gcc, scheduling, openmp, libgomp

我可以提供特定于实现的调度程序吗？如果是这样，是否有一些关于如何做到这一点的文档？

# r - 避免数据框的第一列

> ID：12031270
> 
> 赞同：0
> 
> 时间：2012-08-20T01:14:12.113
> 
> 标签：r, dataframe

我有以下数据框，我想将每个值分配给一个 bin，

```
 title
1                                        MotorolaROID RAZR MAXX 4G Android Phone Black 32GBVerizon Wireless.jpg^HTC EVO 4G 1GB White  Sprint  Smartphone.jpg
2 MotorolaROID RAZR MAXX 4G Android Phone Black 32GBVerizon Wireless.jpg^NEW 4 0 Android 2 3 Unlocked Quad Bands GPS Bluetooth Wifi Smart Cell phone G10.jpg
3                 MotorolaROID RAZR MAXX 4G Android Phone Black 32GBVerizon Wireless.jpg^Motorola Droid X2 Verizon BAD ESN GOOD Condition 100 Functional.jpg
4                                      MotorolaROID RAZR MAXX 4G Android Phone Black 32GBVerizon Wireless.jpg^UNLOCKED Huawei Ideos S7 Tablet Smartphone.jpg
5                          MotorolaROID RAZR MAXX 4G Android Phone Black 32GBVerizon Wireless.jpg^Apple iPhone 4 16GB Black  AT&T  Smartphone  MC318LLA .jpg
6                         MotorolaROID RAZR MAXX 4G Android Phone Black 32GBVerizon Wireless.jpg^Apple iPhone 4 16GB Black  Factory Unlocked  Smartphone.jpg
      column1   column2       column3   column4   column5       column6    column7
1       0.978     0.635        0.973   0.7619048 0.6383881    0.8339921 0.06666667
2       0.343     0.702        0.990   0.2623762 0.6150583    0.9285714 0.04166667
3       0.984     0.675        0.712   0.7056277 0.6770944    0.5612648 0.00000000
4       0.798     0.648        0.931   0.4090909 0.5864263    0.8571429 0.00000000
5       0.898     0.709        0.993   0.5000000 0.6951220    0.9328063 0.05882353
6       0.898     0.709        0.993   0.5000000 0.6951220    0.9328063 0.06250000 
```

当我尝试运行以下行时，我得到一个错误错误`cut.default(newX[, i], ...) : 'x' must be numeric`我知道这是因为我的第一列是标题列。如何通过忽略第一列来执行此操作。

```
df_bin <- apply(df, 2, cut, c(-Inf, seq(0.5, 1, 0.1), Inf), labels=0:7) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T01:22:31.803

通过`-1`计数将其排除在“除第一列之外的所有列”上：

```
 df_bin <- apply(df[,-1], 2, cut, c(-Inf, seq(0.5, 1, 0.1), Inf), labels=0:7) 
```

这里的关键是`df[,-1]`与您的`df`.

# wordpress - 为这个元框制作表格？（wordpress）

> ID：12031272
> 
> 赞同：0
> 
> 时间：2012-08-20T01:14:15.513
> 
> 标签：wordpress, function, wordpress-theming

我一直试图在我的模板中将这个元框信息显示为表格，但它没有成功。

我想做的是用它做一个简单的表格。我需要的只是有人帮助我开始。元框的代码已经完成，但我不知道如何输出它。

```
$prefix = 'anime_';

$anime_box = array(
    'id' => 'anime-meta-box',
    'title' => 'Anime Details',
    'page' => 'post',
    'context' => 'normal',
    'priority' => 'high',
    'fields' => array(
        array(
            'name' => 'Name',
            'desc' => 'Add the name of the Anime in either English or Japanese(Romanji).',
            'id' => $prefix . 'anname',
            'type' => 'text',
            'std' => ''
        ),
        array(
            'name' => 'Genre',
            'desc' => 'Is it a thriller, action/adventure, etc...',
            'id' => $prefix . 'angenre',
            'type' => 'text',
            'std' => ''
        ),
        array(
            'name' => 'Directed by',
            'desc' => 'Name of director(s).',
            'id' => $prefix . 'an_director',
            'type' => 'text',
            'std' => ''
        ),
        array(
            'name' => 'Music by',
            'desc' => 'Name of composer(s)',
            'id' => $prefix . 'anmusic',
            'type' => 'text',
            'std' => ''
        ),
        array(
            'name' => 'Studio',
            'desc' => 'Studio which owns the anime.',
            'id' => $prefix . 'anstudio',
            'type' => 'text',
            'std' => ''
        ),
         array(
            'name' => 'Licensed by',
            'desc' => 'Name of both American and Japanese license holders.',
            'id' => $prefix . 'anlicense',
            'type' => 'text',
            'std' => ''
        ),
        array(
            'name' => 'Network(s)',
            'desc' => 'Networks which air the show in both Japan and the United States.',
            'id' => $prefix . 'annetwork',
            'type' => 'text',
            'std' => ''
        ),
         array(
            'name' => 'Original run',
            'desc' => 'Date of when the anime first aired and when it stopped.',
            'id' => $prefix . 'anrun',
            'type' => 'text',
            'std' => ''
        ),
        array(
            'name' => 'Episodes',
            'desc' => 'Number of episodes.',
            'id' => $prefix . 'anepisodes',
            'type' => 'text',
            'std' => ''
        ),

    )
);

add_action('admin_menu', 'anime_add_box');

// Add meta box
function anime_add_box() {
    global $anime_box;

    add_meta_box($anime_box['id'], $anime_box['title'], 'anime_show_box', $anime_box['page'], $anime_box['context'], $anime_box['priority']);
}

// Callback function to show fields in meta box
function anime_show_box() {
    global $anime_box, $post;

    // Use nonce for verification
    echo '<input type="hidden" name="anime_meta_box_nonce" value="', wp_create_nonce(basename(__FILE__)), '" />';

    echo '<table class="form-table">';

    foreach ($anime_box['fields'] as $field) {
        // get current post meta data
        $meta = get_post_meta($post->ID, $field['id'], true);

        echo '<tr>',
                '<th style="width:20%"><label for="', $field['id'], '"><strong>', $field['name'], ':</strong></label></th>',
                '<td>';
        switch ($field['type']) {
            case 'text':
                echo '<input type="text" name="', $field['id'], '" id="', $field['id'], '" value="', $meta ? $meta : $field['std'], '" size="30" style="width:97%" />',
                    '<br /><small>', $field['desc'],'</small>';
                break;

        }
        echo    '<td>',
            '</tr>';
    }

    echo '</table>';
}

add_action('save_post', 'anime_save_data');

// Save data from meta box
function anime_save_data($post_id) {
    global $anime_box;

    // verify nonce
    if (!wp_verify_nonce($_POST['anime_meta_box_nonce'], basename(__FILE__))) {
        return $post_id;
    }

    // check autosave
    if (defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) {
        return $post_id;
    }

    // check permissions
    if ('page' == $_POST['post_type']) {
        if (!current_user_can('edit_page', $post_id)) {
            return $post_id;
        }
    } elseif (!current_user_can('edit_post', $post_id)) {
        return $post_id;
    }

    foreach ($anime_box['fields'] as $field) {
        $old = get_post_meta($post_id, $field['id'], true);
        $new = $_POST[$field['id']];

        if ($new && $new != $old) {
            update_post_meta($post_id, $field['id'], $new);
        } elseif ('' == $new && $old) {
            delete_post_meta($post_id, $field['id'], $old);
        }
    }
} 
```

我尝试使用

```
<table>
<tr>
<td><?php echo get_post_meta($post->ID, "anname", true); ?></td>
</tr>
</table> 
```

作为一种在一个领域进行测试的方法，但它没有奏效。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T22:00:29.167

我相信您使用的代码应该是正确的，但是，您检索的元数据 ID 似乎缺少您的前缀变量：“anime_”。尝试：

```
<?php echo get_post_meta($post->ID, "anime_anname", true); ?> 
```

# javascript - 如何在 JavaScript 中将多个变量列出到单个变量中？

> ID：12031274
> 
> 赞同：0
> 
> 时间：2012-08-20T01:14:48.643
> 
> 标签：javascript, list, variables

这可能是一个非常基本的问题，但要么网络上没有答案，要么我没有使用正确的术语。我想将两个单独的变量（A 和 B）存储到 1 个主变量中，以便 master = A 然后 B。

因此，如果 A = 3，B = 8，master 将等于 38。任何人都知道如何在 JavaScript 中做到这一点？我不是程序员，但这是我的尝试。

```
var A = 1;
var B = 5;

var master = A, B;

document.write(master); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T01:18:23.087

您似乎在请求字符串连接。如果您想要一个数组，请使用其他答案之一。否则：`var master = A.toString() + B.toString();`请参阅此[JSFiddle](http://jsfiddle.net/METFe/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T01:17:01.987

使用[`array`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array)：

```
var A = 1,
    B = 5;

var master = [A, B];

master[0]; // 1
master[1]; // 5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T01:23:23.620

正如建议的那样，对象和数组都可以。我将提出另一个建议 - 封装；）

```
function Master(a, b) {
    this.first = a;
    this.second = b;

    this.both = function() {
        return a + '' + b;
    }
} 
```

并使用它

```
var a = 3;
var b = 8;

var m = new Master(a, b);

alert(m.first);  // 3
alert(m.second); // 8
alert(m.both()); // 38 (mind the parentheses, this is a function call!) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T01:31:09.717

我知道你说你是新人，所以我可能不应该向你扔数组。然而，对于其他人...

如果您打算获得比几个变量更多的动态，则可能需要投资数组。将它们放入数组中，然后循环遍历数组，将它们作为字符串打印到变量中。

```
var myArray = new Array();

myArray.push(3);
myArray.push(8);

var myString = "";
for(var a = 0; a < myArray.length; a++)
{
    myString += myArray[a].toString();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-30T10:35:24.810

```
let 1st_new = [ [ 123, 'jack', 'white', 'tehran' ];
let 2nd_new= [ 456, 'roz', 'black', 'theran' ] ];

let 1st_list.push("1");
let 2st_list.push("2");

console.log(1st_new);
console.log(2nd_new); 
```

#或者你可以制作thge列表的变量并将其放入“var master”并打印出来。

# bash - 用bash中的字符串替换“模板标签”

> ID：12031276
> 
> 赞同：3
> 
> 时间：2012-08-20T01:15:02.153
> 
> 标签：bash, shell, sed

我有这个：

```
#!/bin/bash

# Open up the document
read -d '' html <<- EOF
<!DOCTYPE html>
<html>
  <head>
    <title>...</title>
    <meta name="...">
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
EOF

#Overwrite the old file with a new one
echo "$html" > index.html

# Convert markdown to HTML
`cat README.md | marked --gfm >> index.html`

# Put the converted markdown into the HTML
read -d '' html <<- EOF
  </body>
</html>
EOF

# Save the file
echo "$html" >> index.html 
```

但我想要的是一个单一的写，而不是基本上，在第一个`EOF`我也有`</html></body>`，在`<body>`标签之间我想`{{CONTENT}}`被替换为`cat README.md | marked --gfm`：

```
read -d '' html <<- EOF
    <!DOCTYPE html>
    <html>
      <head>
        <title>...</title>
        <meta name="...">
        <link rel="stylesheet" type="text/css" href="style.css" />
      </head>
      <body>
      {{CONTENT}}
      </body>
    </html>
    EOF 
```

我一遍又一遍地尝试使用该`sed`命令，但我认为我做错了什么，并且当要搜索的文件内容中有斜杠时，我读到了问题。我怎么能在`sed`这里执行命令？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T02:27:29.623

我认为您可以通过一次调用来做到这一点`cat`，使用命令替换在中间插入自述文件：

```
cat << EOF > index.html
<!DOCTYPE html>
<html>
  <head>
    <title>...</title>
    <meta name="...">
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
  $(marked --gfm < README.md)
  </body>
</html>
EOF 
```

* * *

另一种选择可能是使用`printf`，用简单的格式字符串替换 {{CONTENT}} 占位符。

```
read -d '' -r template <<EOF
<!DOCTYPE html>
<html>
<head>
<title>...</title>
<meta name="...">
<link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
%s
</body>
</html>
EOF

printf "$template" "$(marked --gfm < README.md)" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T01:20:50.400

你不会的。

```
md="$(marked --gfm <README.md)"
> index.html
while read html
do
  echo "${html/{{CONTENT}}/$md}" >> index.html
done <<- EOF 
```

```
 <!DOCTYPE html>
    <html>
      <head>
        <title>...</title>
        <meta name="...">
        <link rel="stylesheet" type="text/css" href="style.css" />
      </head>
      <body>
      {{CONTENT}}
      </body>
    </html>
    EOF 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T06:15:45.513

这可能对您有用（GNU sed）：

```
sed '/<body>/!b;n;s/.*/&/e' - <<\EOF > index.html
<!DOCTYPE html>
<html>
  <head>
    <title>...</title>
    <meta name="...">
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
  marked --gfm < README.md
  </body>
</html>
EOF 
```

# mysql - 在 MySQL 中存储多行数据的最佳方法？

> ID：12031278
> 
> 赞同：5
> 
> 时间：2012-08-20T01:15:10.490
> 
> 标签：mysql, database, arrays, plaintext, formatted-text

我正在考虑在 MySQL（或您的选择）中存储多行数据，例如一首诗。我不知道它可能有多少行，我必须保持它的结构完整，所以当我在网站上向最终用户显示它时，它的格式是正确的。

我可以存储 100 到 100,000 个字符之间的任何位置。除非有人可以帮助我找出更简单的方法，否则我宁愿避免使用纯文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T01:22:30.063

如果您真的担心格式。您还可以使用内容编辑器来创建类似 html 的代码`<br/>`和用于格式化的列表。然后将其作为文本发布到您的 sql 中。

同样，我不确定您是担心将数据输入 mysql，还是担心从 mysql 显示数据（因此，内容编辑器的想法）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T02:08:43.830

如果您以[Markdown](http://en.wikipedia.org/wiki/Markdown)等简单格式存储文本，则可以使用任意数量的可转换库将其呈现为 HTML。

在 MySQL 中存储大量文本并没有错。对于超过 1 KB 的数据，您应该使用`TEXT`高达 64 KB 或`LONG TEXT`更大量的数据。

`VARCHAR`在较新版本的 MySQL 下可以走更长的时间，但这可能不是您想要的。

# matplotlib - matplotlib - 重叠范围的可视化

> ID：12031281
> 
> 赞同：1
> 
> 时间：2012-08-20T01:15:32.580
> 
> 标签：matplotlib, visualization, overlap

我想展示两个值如何在 x 和 y 轴上相互重叠。就我而言，这些是时间序列形式的一些观察数据，但我认为这无关紧要。

我想实现这样的目标： [http](http://druid.if.uj.edu.pl/~pawel/rect3001.png) : //druid.if.uj.edu.pl/~pawel/rect3001.png 在matplotlib中是否有可能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T01:42:35.350

这是一个很好的例子。我从[画廊](https://matplotlib.org/stable/gallery/pie_and_polar_charts/polar_bar.html)稍微改编了它。

```
import numpy as np
import matplotlib.cm as cm
from matplotlib.pyplot import figure, show, rc

# force square figure and square axes looks better for polar, IMO
fig = figure(figsize=(8,8))
ax = fig.add_axes([0.1, 0.1, 0.8, 0.8], polar=False)

N = 20
theta = np.arange(0.0, 2*np.pi, 2*np.pi/N)
radii = 10*np.random.rand(N)
width = np.pi/4*np.random.rand(N)
bars = ax.bar(theta, radii, width=width, bottom=0.0)
for r,bar in zip(radii, bars):
    bar.set_facecolor( cm.jet(r/10.))
    bar.set_alpha(0.5)

show() 
```

![重叠条。](../Images/a659e0ed8b1c9ff2aaca1995f346f489.png)

# visual-c++ - 致命错误 LNK1104

> ID：12031285
> 
> 赞同：6
> 
> 时间：2012-08-20T01:16:31.537
> 
> 标签：visual-c++

当我在 Visual Studio C++ 2008 中编译我的代码时，我收到以下错误：

```
fatal error LNK1104: cannot open file 'C:\Users\...\Documents\Visual Studio         
2008\Projects\...\Debug\....exe 
```

我刚刚从 Visual Studio C++ 中的另一个项目中复制了我的代码，并在 VS C++ 中再次将其粘贴到该项目中。它会导致这个错误吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T01:19:49.040

发生这种情况的原因可能是，例如，可执行文件当前正在由另一个程序执行或打开，或者因为您对该目录没有正确的权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T16:05:15.713

打开 TASK MANAGER 并查看 .exe 的进程是否在关闭后仍在后台运行。如果是，则终止该进程，然后尝试再次运行它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-20T11:20:04.307

如果您打开了预处理器输出，例如在属性 | 中，就会发生这种情况。C/C++ | 预处理器 | 预处理到文件 == YES。创建预处理器输出文件（文件类型为 .i）与创建对象文件（时间为 .obj）是互斥的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-07-05T14:53:25.510

就我而言，这是由项目的“增量链接”选项引起的（Visual Studio 2015）。也许是因为这些文件也是来自同一解决方案的其他项目的依赖项，不确定......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-21T06:30:24.460

我遇到了同样的问题（我并不是说这正是你的情况，但仍然如此）这很奇怪，因为当我稍微更改代码时，一切正常......**我刚刚发现我的防病毒软件阻止了.exe 文件作为可能的威胁**（idk，mb 它不喜欢我的 C++ 程序处理内存的方式）。所以，LNK1104 的来源也可以是杀毒软件。

# python - 让用户向 Django 表单添加字段

> ID：12031301
> 
> 赞同：0
> 
> 时间：2012-08-20T01:19:14.223
> 
> 标签：python, django, django-forms

我正在构建一个表格，允许员工进入城市、行程状态并自动计算他们的里程报销。现在我在 forms.py 中有以下代码：

```
leg1a = forms.CharField(max_length=20, required=False)
leg1b = forms.CharField(max_length=20, required=False)
leg2a = forms.CharField(max_length=20, required=False)
leg2b = forms.CharField(max_length=20, required=False)
leg3a = forms.CharField(max_length=20, required=False)
leg3b = forms.CharField(max_length=20, required=False)
leg4a = forms.CharField(max_length=20, required=False)
leg4b = forms.CharField(max_length=20, required=False)
leg5a = forms.CharField(max_length=20, required=False)
leg5b = forms.CharField(max_length=20, required=False)
leg6a = forms.CharField(max_length=20, required=False)
leg6b = forms.CharField(max_length=20, required=False) 
```

然后我使用一个单独的脚本来计算每条腿的里程，并将总和乘以我们的里程率。它有效，但在形式上很难看；该表单有六对都是可选的字段。我希望有 1 对开始，并且用户可以单击一个选项来添加另一条腿。

我需要以元组形式保存数据，如下所示：`('city, ST','city2, ST')`用于距离计算功能。

这是我目前在表单视图中使用的代码，用于清理数据并将数据发送到里程处理程序：

# 里程距离计算

```
 leg_list = [(leg1a, leg1b), (leg2a, leg2b), (leg3a, leg3b), (leg4a, leg4b), (leg5a, leg5b), (leg6a, leg6b)]

        cleaned_leg_list = []
        #get rid of empty variables
        for leg in leg_list:
            if leg == ('',''):
                pass
            else:
                cleaned_leg_list.append(leg)
        leg_distance = []
        #sends each leg of mileage claim to distance handler
        for leg in cleaned_leg_list:
            pre_leg = main(leg)
            leg_distance.append(pre_leg)
        #sums legs of mileage claim 
        sum_distance = sum(leg_distance) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T02:33:54.313

使用一个表单和一个表单集。表单集处理处理一个表单的多个实例。

[https://docs.djangoproject.com/en/dev/topics/forms/formsets/](https://docs.djangoproject.com/en/dev/topics/forms/formsets/)

或者，您可以查看通过 javascript 克隆表单集，以便在不重新加载视图的情况下动态添加任意数量的区域。

这也是清理代码的好机会 - 在表单定义上放置一个计算腿距离并调用外部脚本的方法。您的视图可以在几行代码中进行汇总！

您甚至可以自己构建 formset 类并在其中添加求和函数，因此您的视图非常简单：`if formset.is_valid(): print formset.sum_leg_distances()`

```
class MyForm(forms.Form):
    start_city = forms.CharField()
    start_state = forms.CharField()
    end_city = forms.CharField()
    end_state = forms.CharField()

MyFormSet = formset_factory(form=MyForm, extra=6)

def my_view(request):
   formset = MyFormSet(request.POST or None)
   if request.POST:
       if formset.is_valid():
           for form in formset.forms:
               form.cleaned_data['start_city'] # here's your leg data.
               # form.calculate_leg_distance()
           # sum([form.calculat_leg_distance() for form in formset])

   return render(request, 'my_template', {'formset': formset})

<form method="post">
   {{ formset.as_p }}
   {{ formset.management_form }}
<input type="submit" />
</form> 
```

# c++ - 在 c++ 中从 long long 转换为 int 和其他方式

> ID：12031302
> 
> 赞同：23
> 
> 时间：2012-08-20T01:19:17.490
> 
> 标签：c++, casting, int, long-integer

如何在 c++ 中从 long long 转换为 int 和其他方式？还有什么是 long long 的属性，尤其是它的最大尺寸，提前谢谢..

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2015-01-23T02:02:51.953

`int`保证至少为 16 位宽。在现代系统上，它最常见的是 32 位（即使在 64 位系统上）。

`long long`，最初在 C++ 中不存在，保证至少为 64 位宽。它几乎总是*64*位宽。

将值从一种整数类型转换为另一种整数类型的常用方法是简单地分配它。任何必要的转换都将隐式完成。例如：

```
int x = 42;
long long y = 9223372036854775807;
y = x; // implicitly converts from int to long long
x = y; // implicitly converts from long long to int 
```

对于窄化转换，目标类型不能代表源类型的所有值，存在溢出风险；`int`可能或可能无法保持该值`9223372036854775807`。在这种情况下，结果是*实现定义的*。最可能的行为是丢弃高位；例如，转换`9223372036854775807`为`int`可能会产生`2147483647`。（这在十六进制中更清楚；值分别是`0x7fffffffffffffff`和`0x7fffffff`。）

如果需要显式转换，可以使用*cast*。C 风格的转换使用括号中的类型名称：

```
(long long)x 
```

或者您可以使用 C++ 风格`static_cast`：

```
static_cast<long long>(x) 
```

这比 C 风格的强制转换更安全，因为它受限于可以操作的类型。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-08-20T01:50:54.427

long long 类型通常为 64 位。

类型 int 可能是 32 位，但不是在所有机器上。

如果您将 int 转换为 long long，您可以这样做

```
my_long_long = (long long) my_int 
```

一切都会好起来的。如果你去另一个方向，比如

```
my_int = (int) my_long_long 
```

而 int 小于 64 位，将无法保存所有信息，因此结果可能不正确。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-20T01:34:08.933

int 的大小只有 2 个字节，而另一个通常大于 int。因此，如果您希望将 long 转换为 int，那么您最终会丢失信息。但在不牺牲信息正确性的情况下，另一种方式是可能的。假设`a`是 long 类型并且`b`是 int 类型。然后 int 到 long 转换：`a=(long)b;`. 对于其他方式：`b=(int)a;`.

# jquery - JQuery无限淡入淡出循环碰撞

> ID：12031308
> 
> 赞同：1
> 
> 时间：2012-08-20T01:20:07.973
> 
> 标签：jquery

我在[http://kaidez.com/javascript-for-loop-creates-jquery-fade/](http://kaidez.com/javascript-for-loop-creates-jquery-fade/)上关注了一个教程，并且正在研究另一个用户发布的关于使循环连续的内容。

我试图使序列连续循环，由于某种原因，我无法弄清楚为什么它适用于 1.5 循环，然后项目开始以不正确的顺序淡入淡出。它在第一个循环中正确淡入淡出，然后第二个循环中的第 4 个项目在后期淡入淡出，然后在那之后一切都关闭了。

**jQuery**

```
(function($){

     var yourFade = 1, // the amount of time in seconds that the elements will fade in AND fade out
     yourDelay = 2, // the amount of time in seconds that there will be a delay between the fade ins and fade outs
     fadeTime = yourFade * 1000, //convert fade seconds to milliseconds (1000)
     delayTime = yourDelay * 1000, // convert delay seconds to milliseconds (2000)
     totalTime = fadeTime + delayTime, //3000 milliseconds...needed for all those delays we talked about
     allElems, // find out exactly how many page elements have the 'toBeFaded' class (4)
     elemNoFade, // Will help us find the last element represent the last element (3)
     i,
     fadingElem;
     allElems = $('.toBeFaded').length

    function fadeit(){
        for (i = 0, allElems = $('.toBeFaded').length, elemNoFade = allElems - 1; i < allElems; i+=1) {

            fadingElem = "#elem" + i;           

            $(fadingElem).delay(totalTime * i).fadeIn(fadeTime).delay(delayTime).fadeOut(fadeTime);
        }
    }
    fadeit();
    setInterval(fadeit,totalTime*allElems);

    })(jQuery); 
```

**CSS**

```
.toBeFaded {
display: none;
position:absolute;
font-size:70px;
color:white;
} 
```

**HTML**

```
<div id="elem0" class="toBeFaded">Message 1</div>
<div id="elem1" class="toBeFaded">Message 2</div>
<div id="elem2" class="toBeFaded">Message 3</div>
<div id="elem3" class="toBeFaded">Message 4</div> 
```

谢谢您的帮助！几个小时以来，我一直在尝试解决这个问题，但没有运气。

# actionscript-3 - actionscript 3 中的流式麦克风和摄像头

> ID：12031310
> 
> 赞同：0
> 
> 时间：2012-08-20T01:20:27.857
> 
> 标签：actionscript-3, streaming

如何使用 actionscript 3 为 MIC（音频）制作实时流媒体？

我关于制作现场广播的问题。

我可以有一个 VPS 来启动我的项目。

# php - 按 Enter 键提交错误 （1 页上的 2 个表格）

> ID：12031311
> 
> 赞同：1
> 
> 时间：2012-08-20T01:20:35.867
> 
> 标签：php, html, ajax, forms, input

我在同一页面上有两种不同的表格。

```
<form action="" method="post" onsubmit="ajax_send('<?print $userid;?>',this.msg.value); return false;">
<input id="msg" autocomplete="off" type="text" name="msg" stlye="width: 80px;" autofocus="autofocus" placeholder="Chat here" />
<input type="submit" />
</form> 
```

和

```
<form action="?page=about&id=0#comments" method="post">
<textarea class="editbox" id="exitbox" placeholder="Write a comment ..." name="newcomment"></textarea>
<input type="submit" id="submit1" name="submit1"></div></div> 
```

现在，当我输入`<input id="msg"..>`内容并按 Enter 时，它会提交第二个表单而不是第一个表单。

我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T01:28:28.720

你的第二个表格没有关闭。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T02:11:01.460

你的第二种形式应该是这样的

```
<form action="?page=about&id=0#comments" method="post">
<textarea class="editbox" id="exitbox" placeholder="Write a comment ..." name="newcomment"></textarea>
<input type="submit" id="submit1" name="submit1"></div></div>
</form> 
```

# c# - 从 .doc MS Word 文件存储数学方程式并恢复它们

> ID：12031318
> 
> 赞同：2
> 
> 时间：2012-08-20T01:21:50.127
> 
> 标签：c#, math, ms-word, .doc

我正在处理包含数学方程式和图像的 Microsoft Word 文件。我需要获取这些`InlineShapes`对象并按**原样**存储它们，然后在需要时恢复它们。

我知道如何`InlineShape`从文件中获取对象，问题是如何存储它们。将它们保存为图像不是一种选择！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T01:36:05.407

```
using System;
using System.Drawing;
using System.IO;
using System.Threading;
using Page = System.Web.UI.Page;
using Microsoft.Office.Interop.Word;
using Microsoft.VisualBasic.Devices;
public partial class ReadIMG : System.Web.UI.Page
{   
    private Application m_word;
    private int m_i;
    protected void Page_Load(object sender, EventArgs e)
    {
        object missing = Type.Missing;
        object FileName = Server.MapPath("~/LectureOrig/Word.docx");
        object readOnly = true;
        m_word = new Application();
        m_word.Documents.Open(ref FileName,
            ref missing, ref readOnly, ref missing, ref missing,
            ref missing, ref missing, ref missing, ref missing,
            ref missing, ref missing, ref missing, ref missing,
            ref missing,ref missing,ref missing);
        try
        {
            for (int i = 1; i <= m_word.ActiveDocument.InlineShapes.Count; i++)
            {
                m_i = i;
               // CopyFromClipboardShape();
                Thread thread = new Thread(CopyFromClipbordInlineShape);
                thread.SetApartmentState(ApartmentState.STA);
                thread.Start();
                thread.Join();
            }
        }
        finally
        {
            object save = false;
            m_word.Quit(ref save, ref missing, ref missing);
            m_word = null;
        }
    }
    protected void CopyFromClipbordInlineShape()
    {   
        InlineShape inlineShape = m_word.ActiveDocument.InlineShapes[m_i];
        inlineShape.Select();
        m_word.Selection.Copy();
        Computer computer = new Computer();
        //Image img = computer.Clipboard.GetImage();
        if (computer.Clipboard.GetDataObject() != null)
        {
            System.Windows.Forms.IDataObject data = computer.Clipboard.GetDataObject();
            if (data.GetDataPresent(System.Windows.Forms.DataFormats.Bitmap))
            {
                Image image = (Image)data.GetData(System.Windows.Forms.DataFormats.Bitmap, true);                
                image.Save(Server.MapPath("~/ImagesGet/image.gif"), System.Drawing.Imaging.ImageFormat.Gif);
                image.Save(Server.MapPath("~/ImagesGet/image.jpg"), System.Drawing.Imaging.ImageFormat.Jpeg);

            }
            else
            {
                LabelMessage.Text="The Data In Clipboard is not as image format";
            }
        }
        else
        {
            LabelMessage.Text="The Clipboard was empty";
        }
    } 
```

[如何从 C# 中的 Doc（Word）文件中提取图像的](http://forums.asp.net/t/1474743.aspx)代码副本？

[将图像从 Word Doc 转换为位图](https://stackoverflow.com/questions/4870267/converting-images-from-word-document-into-bitmap-object)

# jquery - jquery 文本幻灯片效果就像在 google+ 事件中一样

> ID：12031320
> 
> 赞同：0
> 
> 时间：2012-08-20T01:22:13.630
> 
> 标签：jquery, animation, google-plus, jquery-effects

我正在寻找用于 jquery 的文本幻灯片动画插件或一些如何自己完成此操作的提示。我喜欢在自己的项目中使用的动画是这样的：https: [//plus.google.com/events/cq5653ic2pdnqmkiti7tt192n34/111697084657487423167](https://plus.google.com/events/cq5653ic2pdnqmkiti7tt192n34/111697084657487423167) 要查看我所指的动画，请单击蓝色箭头。我正在寻找这个动画，其中的文本看起来脱离了上面文本（或 div 框）的背景。

不知道有没有这样的jquery效果插件？或者你有一些想法如何用 jquery 或 CSS3 转换来实现这样的东西？

非常感谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T02:31:38.423

看起来打开效果是通过动画一些 CSS3 转换属性创建的。在这个例子中：（从我所看到的）

```
-webkit-transform: rotateX(); 
```

据我所知，没有任何 jQuery 插件具有这种*确切的*效果，但[jQuery Transit](http://ricostacruz.com/jquery.transit/)可以让您非常接近地为这些属性设置动画。

我还做了一个演示。[在这里查看。](http://jsfiddle.net/_andrewclarkson/SsBwj/68/)显然，您必须合并一些切换逻辑并使其看起来很漂亮，但看起来效果似乎并不*难*重新创建！

非常感谢！

# php - 通过下拉菜单登录

> ID：12031325
> 
> 赞同：0
> 
> 时间：2012-08-20T01:23:34.313
> 
> 标签：php, html, session, drop-down-menu, login

因此，对于我正在处理的项目，只需在下拉菜单中填写一个选项，然后单击提交（无密码字段）即可登录。

我在该主题上进行的任何搜索都会返回有关制作类似于 twitter 的简洁下拉菜单的信息。当我自己尝试这样做时，发生了服务器错误的严重可憎。

```
<?php

mysql_connect("localhost", "root", "mypassword")or die("cannot connect"); 
mysql_select_db("lunch_punch")or die("cannot select DB");

$myname=$_POST['myname'];

session_register("myname");
header("location:login_success.php");
}
else {
echo "Wrong Username or Password";
}

<?php
session_start();
if(!session_is_registered(myname)){
header("location:home.html");
}
?>

<html>
<body>
Login Successful
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:30:58.627

在这里，我将这个示例/ tut 放在一起，因为我怀疑您正在查看一个非常古老的教程；

它非常简单易懂，涵盖了很多方面，包括使用 PDO 安全地连接到数据库并对其进行查询、会话控制以及使用简单类和访问其方法。希望能帮助到你。

```
<?php 
session_start();

class simpleLogin{
    public $error;

    function __construct($dsn, $user=null, $pass=null){
        $this->dsn = $dsn;
        $this->user = $user;
        $this->pass = $pass;
        //Connect
        $this->connect();
    }

    function connect(){
        try{
            $this->db = new PDO($this->dsn, $this->user, $this->pass);
            $this->db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
            $this->db->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
            $this->db->setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE,PDO::FETCH_ASSOC);
        }catch (Exception $e){
            die('Cannot connect to databse. Details:'.$e->getMessage());
        }
    }

    //Get all users from db for drop down box
    function get_all_users(){
        $sql = "SELECT * FROM users";
        $statement = $this->db->query($sql);
        $statement->execute();
        return $statement->fetchAll();
    }

    /**
     * The main check_login method, this method is called
     *  on each page load to check status of logged in user
     *  or handle form POST login.
     *
     * @return bool
     */
    function check_login(){
        //Logout
        if(isset($_GET['logout'])){$this->logout();}

        //Already Logged in
        if(isset($_SESSION['logged_in']) && $_SESSION['logged_in']===true){return true;}

        //User posted login form
        if($_SERVER['REQUEST_METHOD']=='POST'){
            if(!empty($_POST['myname'])){
                /*
                CREATE  TABLE `lunch_punch`.`users` (
                `id` INT NOT NULL AUTO_INCREMENT ,
                `username` VARCHAR(255) NULL ,
                PRIMARY KEY (`id`) );
                */
                $sql = "SELECT 1 FROM users WHERE username=:username";
                $statement = $this->db->prepare($sql);
                $statement->bindParam(':username', $_POST['myname']);
                $statement->execute();
                $result = $statement->fetch();
                if(!empty($result)){
                    $_SESSION['logged_in']=true;
                    return true;
                }else{
                    return false;
                }
            }else{
                $this->error = 'Please select your name!';
            }
        }
    }

    /**
     * Logout user and then redirect to index
     *
     */
    function logout(){
        session_destroy();
        session_regenerate_id(true);
        exit(header('Location: index.php'));
    }
}

//Start the login class and pass your mysql connection details
$login = new simpleLogin('mysql:host=127.0.0.1;dbname=lunch_punch','root','password');

//Check the login
if($login->check_login() === true){
    //Logged In, wOOt do whatever...
    echo 'You are logged in... <a href="?logout">Logout</a>';
}else{
    //Logged Out, show login form
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Simple Login by Select Box</title>
</head>
<form method="POST" action="">
  <p>Please Login by selecting your name.</p>

  <p><select size="1" name="myname">
      <option value="" selected>-- Select Your Name --</option>
      <?php 
      //Get all users from database and output into the option box
      foreach($login->get_all_users() as $user):?>
      <option value="<?php echo $user['username'];?>"><?php echo $user['username'];?></option>';
      <?php endforeach;?>
     </select>
     <input type="submit" value="Login">
  </p>
  <?php echo ((!empty($login->error))?'<span style="color:red;">'.$login->error.'</span>':null);?>
</form>
<body>
</body>
</html>
<?php } ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T01:57:22.240

`session_register`并且相关函数在 php 5.3 中已弃用，并已在 php 5.4 中删除。因此，如果您使用的是 php 5.4，则此代码将导致致命错误。

您应该改用类似的东西，请参阅[手册](http://www.php.net/manual/en/function.session-start.php)：

```
<?php
session_start();
$myname=$_POST['myname'];
// do some validation on $myname to make sure it is what you expect it to be
$_SESSION['myname'] = $myname; 
```

以及您需要检查要设置的变量的位置：

```
<?php
session_start();
if (isset($_SESSION['myname']))
{
  // the variable is set
} 
```

这些`mysql_*`函数也已弃用，我建议您切换到 PDO 或 mysqli 中的准备好的语句。

# java - 如何在我的 openGL 应用程序中编写一个绘制正方形的测试？

> ID：12031326
> 
> 赞同：1
> 
> 时间：2012-08-20T01:23:35.500
> 
> 标签：java, unit-testing, opengl, bdd

假设这是我的代码：

```
public void render(){
    GL11.glClearColor(0, 0, 1, 1);
    GL11.glClear(GL11.GL_COLOR_BUFFER_BIT | GL11.GL_DEPTH_BUFFER_BIT);
    GL11.glColor3f(.5f, .5f, 1.0f);
    GL11.glBegin(GL11.GL_QUADS);
        GL11.glVertex3f(0,0,0);
        GL11.glVertex3f(50,0,0);
        GL11.glVertex3f(50,50,0);
        GL11.glVertex3f(0,50,0);
    GL11.glEnd();
} 
```

如何编写单元测试以确保将正方形绘制在应在的位置并以正确的颜色绘制？我是否也应该测试诸如屏幕在每一帧上被清除的东西？我在想我会把openGL代码从我的方形代码中抽象出来。换句话说，我将创建一个创建“向量”的类，然后它的渲染函数将绘制到屏幕上，我不会对此进行测试。但是，您应该测试每个公共函数。Sooo 我想它又回到了：我怎么知道在 openGL 屏幕上绘制了什么？

另外，现在我想一想，我不应该每次运行测试时都运行我的应用程序，这可能会带来另一个层次的复杂性......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:37:39.037

测试渲染行为非常困难。单元/集成测试在检查屏幕以查看是否正确时非常糟糕。

我认为你最好的选择是使用 Powermock 之类的东西来拦截静态 OpenGL 调用（我不会在这里费心介绍如何做到这一点，因为他们的网站有大量此类信息）。

但是您可以检查调用并确定是否调用了正确的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T13:25:43.433

当然，您需要将 GL11 库包装在另一个适配器中，然后模拟该适配器。然后你可以证明你的班级传递了正确的坐标和正确的颜色。（或者你可以使用 PowerMock，但老实说，我更喜欢 Mockito 和模拟接口）。

如果你使用向量抽象，你也可以做同样的事情来测试它。GL11 的包装器应该足够小且足够简单，您可以通过检查来验证它是否正确，因为如果没有实际在屏幕上绘图，您将无法对其进行单元测试。如果您在其他地方使用它，我只会创建那个额外的抽象。

至于显示类是“正确的”，并在“正确”的位置绘制正方形，Matt 的正确之处在于测试渲染行为很困难，并且测试美学 IMO 应该只能手动完成。考虑到这一点，如果您不创建矢量抽象，您可以检查坐标之间的距离是否相同，因此它是一个“正方形”，然后收工，因为这有助于您保持测试的灵活性和如果需要，可以轻松更改正方形的大小和颜色。

这些只是选项。自动化测试不能替代至少一次手动测试。如果您正在查看的行为是您每次更改它时总是手动检查的东西，并且它已从任何可能影响行为的事物中抽象出来（因此没有什么可以产生回归错误），请不要太担心为它创建一个单元测试并手动验证它。

# html - 带纹理背景的 CSS 锯齿形边框

> ID：12031328
> 
> 赞同：15
> 
> 时间：2012-08-20T01:23:42.253
> 
> 标签：html, css, css-shapes, zigzag

我一直在研究带有锯齿形边框的标题。一种方法是使用图像来制作锯齿形效果。

**(1) 有没有什么方法可以在不使用图片的情况下，在 CSS 中创建一个实用的跨浏览器之字形边框？**

我还试图在这个标题上放置一个纹理背景，延伸到锯齿形。但是，标题的垂直大小可能会发生变化，我无法将标题实现为单个图像。

如果我尝试为之字形边缘和标题元素添加纹理，则很有可能纹理将不同步。

**(2) 关于实现延伸到曲折而不同步的纹理背景的任何想法？**

我的 [旧] 代码（连同纹理）在[jsFiddle](http://jsfiddle.net/jcygg/)上。

```
body {
  padding: 20px;
}

header {
  width: 240px;
  background-color: #BCED91;
}

header:after {
  content: " ";
  display: block;
  position: relative;
  width: 240px;
  bottom: -15px;
  height: 15px;
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAPCAYAAACWV43jAAAAw0lEQVRIx83RsQ3CMBCF4T83AZKLVOmyBa1HSIlXwKySGaDOBClZAToWQIpETQONyxAS+2J4pe9knd5X9EP7QicPYAsUwBnYaHwqSsd1QGmNv1rjL0AZ3pJTKDTorPGnsUE/tDvg+KsG70D96TiAMKvDbtYDO6Cyxt++LYadKpY8hthNtTaVGHLRJJ3R5mJy0SbVJp9D7FJaSyWXNUk1yGVt0lTyMWK3ZmtLySUnaQy55CZdSi7AHmis8U/+JOGWBji8AaYPVy6VELZvAAAAAElFTkSuQmCC) repeat-x;
}

img {
  margin-top: 50px;
}
```

```
<header>
  <br />
  <br />
  <br />
  <br />
</header>

<img src="http://i.imgur.com/qKsVr.png" />
```

* * *

编辑＃1：

谢谢安娜的代码。我接受并改进了它。

[http://dabblet.com/gist/3401493](http://dabblet.com/gist/3401493)

我认为不可能有一致的背景。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-20T02:21:44.170

如果你打算使用`border-image`，那么它不是一个跨浏览器的解决方案，因为 IE 不支持它。

此外，即使除 IE9 之外的每个当前浏览器版本都支持 CSS 渐变（这将允许您获得[**之字形图案**](http://dabblet.com/gist/3399476)）和`border-image`，上次我检查（那是几个月前，所以最好再次测试），使用渐变`border-image`仅适用于 WebKit。另外，我认为即使在 WebKit 中也不能使用多个渐变（因为您只能设置一个边框图像，一个渐变是一个图像），并且您需要两个渐变用于锯齿形图案。

CSS zig-zag 模式的代码是：

```
background: linear-gradient(#BCED91 49%, transparent 49%),
        linear-gradient(-45deg, white 33%, transparent 33%) 0 50%,
        white linear-gradient(45deg, white 33%, #BCED91 33%) 0 50%;
    background-repeat: repeat-x;
    background-size: 1px 100%, 40px 40px, 40px 40px; 
```

如果你想要一个低于这个的纹理与这个同步，那么你必须确保它以相同的间隔重复（`40px`但你也可以去`20px`）。

* * *

**编辑：关于 polyfill，您可以尝试**[此处](http://css3clickchart.com/#linear-gradient)列出的其中之一：[CSS3 PIE](http://css3pie.com/)或[cssSandpaper](http://www.useragentman.com/blog/csssandpaper-a-css3-javascript-library/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-12-08T10:38:32.057

（在现代浏览器中）您可以使用 SVG 创建简单的绘图，并将它们用作嵌入为[数据 URI](https://developer.mozilla.org/en-US/docs/Web/HTTP/data_URIs)的 CSS 背景图像。

**这是 SVG 的样子：**

```
body {
  background: #888;
}
```

```
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="8px" height="4px">
  <polygon points="0,4 4,0 8,4" fill="#CC0000" />
</svg>
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="8px" height="4px">
  <polygon points="0,0 4,4 8,0" fill="#CC0000" />
</svg>
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="8px" height="4px">
  <polygon points="0,0 4,4 8,0" fill="#FFFFFF" />
</svg>
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="8px" height="4px">
  <polygon points="0,4 4,0 8,4" fill="#FFFFFF" />
</svg>
```

**示例 1：**

```
.zigzag-outside {
  position: relative;
  margin-top: 4px;
  margin-bottom: 4px;
  background-color: #CC0000;
  /* example content */
  padding: 1em;
  font: bold medium sans-serif;
  color: #FFFFFF;
}
.zigzag-outside:before {
  content: "";
  position: absolute;
  top: -4px;
  left: 0;
  right: 0;
  height: 4px;
  /* red up pointing triangle */
  background-image: url("data:image/svg+xml,%3Csvg%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%228px%22%20height%3D%224px%22%3E%3Cpolygon%20points%3D%220%2C4%204%2C0%208%2C4%22%20fill%3D%22%23CC0000%22%2F%3E%3C%2Fsvg%3E");
}
.zigzag-outside:after {
  content: "";
  position: absolute;
  bottom: -4px;
  left: 0;
  right: 0;
  height: 4px;
  /* red down pointing triangle */
  background-image: url("data:image/svg+xml,%3Csvg%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%228px%22%20height%3D%224px%22%3E%3Cpolygon%20points%3D%220%2C0%204%2C4%208%2C0%22%20fill%3D%22%23CC0000%22%2F%3E%3C%2Fsvg%3E");
}
```

```
<div class="zigzag-outside">Example 1</div>
```

**示例 2：**

```
.zigzag-inside {
  position: relative;
  /* example content */
  width: 600px;
  height: 100px;
  background-image: url(http://i.stack.imgur.com/uOVfl.jpg);
}
.zigzag-inside:before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  /* white down pointing triangle */
  background-image: url("data:image/svg+xml,%3Csvg%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%228px%22%20height%3D%224px%22%3E%3Cpolygon%20points%3D%220%2C0%204%2C4%208%2C0%22%20fill%3D%22%23FFFFFF%22%2F%3E%3C%2Fsvg%3E");
}
.zigzag-inside:after {
  content: "";
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 4px;
  /* white up pointing triangle */
  background-image: url("data:image/svg+xml,%3Csvg%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%228px%22%20height%3D%224px%22%3E%3Cpolygon%20points%3D%220%2C4%204%2C0%208%2C4%22%20fill%3D%22%23FFFFFF%22%2F%3E%3C%2Fsvg%3E");
}
```

```
<div class="zigzag-inside"></div>
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-06-21T11:15:59.813

改进的最小 CSS：

```
div {
  background: #1ba1e2;
  position: relative;
}

div:after {
  content: "";
  display: block;
  position: absolute;
  width: 100%;
  height: 30px;
  background: linear-gradient(-45deg, transparent 75%, #1ba1e2 0) 0 50%,
              linear-gradient(45deg, transparent 75%, #1ba1e2 0) 0 50%;
  background-size: 30px 30px;
}

/* Styles just for demo */
h1 {
  color: #fff;
  text-align: center;
  margin: 0;
  padding: 0.5em;
}
```

```
<div>
  <h1>Zig Zag Borders</h1>
</div>
```

如果要删除重复值，可以使用[CSS 变量 AKA 自定义属性](https://developer.mozilla.org/en-US/docs/Web/CSS/--*)。他们在除 IE 之外的任何地方工作。

```
:root {
  --background-color: #1ba1e2;
  --zigzag-item-size: 30px;
}

div {
  background: var(--background-color);
  position: relative;
}

div:after {
  content: "";
  display: block;
  position: absolute;
  width: 100%;
  height: var(--zigzag-item-size);
  background: linear-gradient(-45deg, transparent 75%, var(--background-color) 0) 0 50%,
              linear-gradient(45deg, transparent 75%, var(--background-color) 0) 0 50%;
  background-size: var(--zigzag-item-size) var(--zigzag-item-size);
}

/* Styles just for demo */
h1 {
  color: #fff;
  text-align: center;
  margin: 0;
  padding: 0.5em;
}
```

```
<div>
  <h1>Zig Zag Borders</h1>
</div>
```

### 小记：

我在渐变色标中使用零`0`以避免重复以前的值，因为根据[CSS3 图像规范](https://www.w3.org/TR/css3-images/#color-stop-syntax)，色标位置不能小于前一个。

> 如果色标的位置小于列表中任何色标的指定位置，则将其位置设置为等于其之前任何色标的最大指定位置。

# git - 如何跨多个子模块执行“git status”

> ID：12031329
> 
> 赞同：0
> 
> 时间：2012-08-20T01:23:57.343
> 
> 标签：git, status, git-submodules

我有一个带有几个子模块的 git 存储库。当我`git status`在父模块中执行时，它只显示我在该级别的更改，我需要`cd`进入每个子模块并`git status`在每个模块中单独执行。有没有更好的方法来做到这一点，以便我可以`git status`在顶层执行并查看所有子模块的变化？

我的`git --version`回报：

> git 版本 1.7.9.6 (Apple Git-31.1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T01:32:46.817

```
git submodule foreach --recursive 'git status && echo' 
```

你可以把它变成一个 Git 别名，以避免每次都输入它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-20T01:32:43.537

git 对子模块一无所知。它只是将目录树作为一个完整的存储库。正确安装的 git 副本，当您运行“git status”时，它应该显示对存储库的所有更改。但是如果您的子模块属于不同的存储库，则没有正式的方式来显示所有更改。（也许写一些脚本）

# c - MPI - 语言 C 中的列类型问题

> ID：12031330
> 
> 赞同：0
> 
> 时间：2012-08-20T01:24:03.847
> 
> 标签：c, openmpi

我在从一个进程发送列并由另一个进程接收的通信`MPI_Send`方面存在问题。`MPI_Recv`

为了调试，我在下面向您展示了一个基本示例，其中我使用和初始化了一个 10x10 矩阵（`x0`数组）。对于测试，我只是用 . 初始化 2D 数组值。`x_domain = 4``y_domain = 4``x0[i][j] = i+j`

您能否尝试编译并执行以下测试代码，它只是`rank=2`从`rank=0``nproc=4`

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "mpi.h"

int main(int argc, char *argv[]) 
    {
      /* size of the discretization */

      double** x;
      double** x0;
      int bonk1, bonk2;      
      int i,j,k,l;
      int nproc;
      int ndims; 
      int S=0, E=1, N=2, W=3;
      int NeighBor[4];
      int xcell, ycell, size_tot_x, size_tot_y;
      int *xs,*ys,*xe,*ye;
      int size_x = 4;
      int size_y = 4;
      int me;
      int x_domains=2;
      int y_domains=2;
      int flag = 1;      
      MPI_Comm comm, comm2d;
      int dims[2];
      int periods[2];
      int reorganisation = 0;
      int row;
      MPI_Datatype column_type;
      MPI_Status status;

      size_tot_x=size_x+2*x_domains+2;
      size_tot_y=size_y+2*y_domains+2;

      xcell=(size_x/x_domains);
      ycell=(size_y/y_domains);

      MPI_Init(&argc, &argv);
      comm = MPI_COMM_WORLD;
      MPI_Comm_size(comm,&nproc);
      MPI_Comm_rank(comm,&me);

      x = malloc(size_tot_y*sizeof(double*));
      x0 = malloc(size_tot_y*sizeof(double*));

      for(j=0;j<=size_tot_y-1;j++) {
        x[j] = malloc(size_tot_x*sizeof(double));
        x0[j] = malloc(size_tot_x*sizeof(double));
      }

      xs = malloc(nproc*sizeof(int));
      xe = malloc(nproc*sizeof(int));
      ys = malloc(nproc*sizeof(int));
      ye = malloc(nproc*sizeof(int));

      /* Create 2D cartesian grid */
      periods[0] = 0;
      periods[1] = 0;

      ndims = 2;
      dims[0]=x_domains;
      dims[1]=y_domains;

      MPI_Cart_create(comm, ndims, dims, periods, reorganisation, &comm2d);

      /* Identify neighbors */
      NeighBor[0] = MPI_PROC_NULL;
      NeighBor[1] = MPI_PROC_NULL;
      NeighBor[2] = MPI_PROC_NULL;
      NeighBor[3] = MPI_PROC_NULL;

      /* Left/West and right/Est neigbors */
      MPI_Cart_shift(comm2d,0,1,&NeighBor[W],&NeighBor[E]);
      /* Bottom/South and Upper/North neigbors */
      MPI_Cart_shift(comm2d,1,1,&NeighBor[S],&NeighBor[N]);

      /* coordinates of current cell with me rank */

      xcell=(size_x/x_domains);
      ycell=(size_y/y_domains);

      ys[me]=(y_domains-me%(y_domains)-1)*(ycell+2)+2;
      ye[me]=ys[me]+ycell-1;

      for(i=0;i<=y_domains-1;i++) 
      {xs[i]=2;}

      for(i=0;i<=y_domains-1;i++) 
      {xe[i]=xs[i]+xcell-1;}

      for(i=1;i<=(x_domains-1);i++)
         { for(j=0;j<=(y_domains-1);j++) 
              {
               xs[i*y_domains+j]=xs[(i-1)*y_domains+j]+xcell+2;
               xe[i*y_domains+j]=xs[i*y_domains+j]+xcell-1;
              }
         }

      for(i=0;i<=size_tot_y-1;i++)
          { for(j=0;j<=size_tot_x-1;j++)
            { x0[i][j]= i+j;
        }       
      }

      /*  Create column data type to communicate with South and North neighbors */

      MPI_Type_vector( ycell, 1, size_tot_x, MPI_DOUBLE, &column_type);  
      MPI_Type_commit(&column_type);

       if(me==2) {
       printf("Before Send - Process 2 subarray\n");
                    for(i=ys[me]-1;i<=ye[me]+1;i++)
                    { for(j=xs[me]-1;j<=xe[me]+1;j++)
                      { printf("%f ",x0[i][j]);
                      }
                      printf("\n");
                    }
                    printf("\n");

       MPI_Send(&(x0[ys[2]][xs[2]]), 1, column_type,  0, flag, comm2d );
       }

         if(me==0) {

     MPI_Recv(&(x0[ys[0]][xe[0]]), 1, column_type,  2, flag, comm2d , &status);
     printf("After Receive - Process 0 subarray\n");
                    for(i=ys[me]-1;i<=ye[me]+1;i++)
                    { for(j=xs[me]-1;j<=xe[me]+1;j++)
                      { printf("%f ",x0[i][j]);
                      }
                      printf("\n");
                    }
                    printf("\n");

        MPI_Get_count(&status,column_type,&bonk1);
        MPI_Get_elements(&status,MPI_DOUBLE,&bonk2);
        printf("got %d elements of type column_type\n",bonk1);
        printf("which contained %d elements of type MPI_DOUBLE\n",bonk2);
    printf("\n");

         }

              for(i=0;i<=size_tot_y-1;i++)
           {
            free(x[i]);
            free(x0[i]);
           }     

        free(x);
        free(x0);

        free(xs);
        free(xe);
        free(ys);
        free(ye);

        MPI_Finalize();

        return 0;
    } 
```

`xs[me]`和分别`xe[me]`对应于`x_start[me]`和`x_end[me]`。`rank = me`这对于`ys[me]`和是一样的`ye[me]`。

正如我在前一篇文章中所说，只有列的第一个值由 rank 进程接收`0`。这是这个程序的输出：

```
Before Send - Process 2 subarray
10.000000 11.000000 12.000000 13.000000
11.000000 **12.000000** 13.000000 14.000000
12.000000 **13.000000** 14.000000 15.000000
13.000000 14.000000 15.000000 16.000000

After Receive - Process 0 subarray
6.000000 7.000000 8.000000 9.000000
7.000000 8.000000 **12.000000** 10.000000
8.000000 9.000000 **10.000000** 11.000000
9.000000 10.000000 11.000000 12.000000

got 1 elements of type column_type
which contained 2 elements of type MPI_DOUBLE 
```

* * *

我得到`12.00000`第一个元素，但对于第二个元素，我有`10.00000`而不是`13.00000`.

我定义`column_type`为：

```
MPI_Type_vector( ycell, 1, size_tot_x, MPI_DOUBLE, &column_type); 
MPI_Type_commit(&column_type); 
```

`size_tot_x`等于全局数组的总列数`x0`。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T08:32:43.420

这不是 MPI 问题，而是如何在内存中分配数组的问题。

在分配二维和更高维数组时，基本上有两种“思想流派”。MPI 也遵循的老派使用平面数组 - 行在内存中一个接一个地定位。这就是编译器在内存中布局显式形状数组的方式，例如，`double x[4][4]`将具有以下布局：

```
x[0][0] x[0][1] x[0][2] x[0][3] x[1][0] x[1][1] ... x[3][2] x[3][3] 
```

`x[i][k]`使用这样的布局，之间的距离（元素数量）`x[i+1][k]`正好等于行中元素的数量，即`4`在这种情况下。当您在 MPI 中构造一个块长度为`1`且跨度为的派生向量数据类型`4`时，当用于发送或接收数据时，它将使用同一列中的元素。

这种模型的一个缺点是，当动态分配内存时，必须使用类似的东西`x[4*i+k]`而不是简单的`x[i][k]`.

第二种思想使用指向每一行的指针数组，然后分别分配每一行。这种机制很好，因为它允许构造“锯齿状”数组并允许使用`x[i][k]`语法，但它**不能**保证连续的行在内存中是相邻的，即`x[i]`并且`x[i+1]`可能指向的位置超过`4`元素之间的距离.

您应该做的是将您的逻辑切换为使用平面数组，或者您可以使用混合模型 - 分配一个平面数组`malloc()`，然后创建一个行索引：

```
double** x;
double** x0;

x = malloc(size_tot_y*sizeof(double*));
x0 = malloc(size_tot_y*sizeof(double*));

for(j=0;j<=size_tot_y-1;j++) {
  x[j] = malloc(size_tot_x*sizeof(double));
  x0[j] = malloc(size_tot_x*sizeof(double));
}

...

for(i=0;i<=size_tot_y-1;i++)
{
  free(x[i]);
  free(x0[i]);
}     

free(x);
free(x0); 
```

应该成为

```
double* x_vals;
double** x;
double* x0_vals;
double** x0;

x_vals = malloc(size_tot_x*size_tot_y*sizeof(double));
x0_vals = malloc(size_tot_x*size_tot_y*sizeof(double));

x = malloc(size_tot_y*sizeof(double*));
x0 = malloc(size_tot_y*sizeof(double*));

for(j=0;j<=size_tot_y-1;j++) {
  x[j] = &x_vals[j*size_tot_x];
  x0[j] = &x0_vals[j*size_tot_x];
}

...

free(x);
free(x_vals);
free(x0);
free(x0_vals); 
```

我希望您的代码与我建议的代码之间的差异清晰可见。

# java - 使用 Joda Time 将 Unix 时间戳转换为字符串

> ID：12031333
> 
> 赞同：28
> 
> 时间：2012-08-20T01:24:58.127
> 
> 标签：java, jodatime

尝试将 Unix 时间戳记从数据库转换为日期格式的字符串时。

```
int _startTS = evtResult.getInt("start"); //outputs 1345867200
Long _sLong = new Long(_startTS); //outputs 1345867200
//I've also tried: Long _sLong = new Long(_startTS*1000); //outputs 1542436352
DateTime _startDate = new DateTime(_sLong); //outputs 1970-01-16T08:51:07.200-05:00 
```

时间戳适用于：`Sat, 25 Aug 2012`。我不知道为什么 1970 总是输出所以希望有人能看到我犯的一个愚蠢的错误。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-08-20T01:33:08.017

Unix 时间以秒为单位，Java 时间以毫秒为单位

您需要将其乘以 1000

```
DateTime _startDate = new DateTime(_sLong * 1000L); 
```

你可能想看看这个[答案](https://stackoverflow.com/questions/3371326/java-date-from-unix-timestamp)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-20T01:39:31.297

**Unix**时间戳是从`1970-01-01 00:00:00`.

`DateTime(long instant)`构造函数需要**MILLISECONDS**的数量。

```
long _startTS = ((long) evtResult.getInt( "start" )) * 1000;
DateTime _startDate = new DateTime( _startTS ); 
```

编辑：或使用 getLong(..) 方法`evtResult`来避免演员变长。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-20T01:35:04.600

当你这样做:`_startTS*1000`时，Java 假定你想要一个 int，因为`_startTS`它是一个 int（这就是为什么值为 1542436352）。首先尝试将其转换为长：

```
Long _sLong = new Long(((long)_startTS)*1000); 
```

# javascript - 显示一个 在一个 在另一个窗口中 - 如何实现全帧速率？

> ID：12031335
> 
> 赞同：1
> 
> 时间：2012-08-20T01:25:36.350
> 
> 标签：javascript, html5-video, html5-canvas

我`video`在主窗口的一个元素中播放了一段视频。我想用 JavaScript`cavas`在一个窗口中显示视频。`open()`（原始`video`元素将被隐藏，但仍将负责播放声音。）

我正在这样做。

```
<video id='video' style='display: none;' autoplay>
  <source src="http://media.w3.org/2010/05/sintel/trailer.mp4" type='video/mp4' />
  <source src="http://media.w3.org/2010/05/sintel/trailer.webm" type='video/webm' />
  <source src="http://media.w3.org/2010/05/sintel/trailer.ogv" type='video/ogg' />
</video> 
```

我打开一个新窗口并创建一个`canvas`元素。`timeupdate`然后我在主窗口中为视频的每个事件添加一个回调。当它运行时，我将当前的视频帧复制到画布上。

```
video.addEventListener("play", function() {
  var child = open("/echo/html/", "width=" + video.videoWidth + ",height=" + video.videoHeight);

  child.addEventListener("load", function() {
    var canvas = child.document.createElement("canvas"),
        g2d = canvas.getContext("2d");

    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;

    child.document.body.appendChild(canvas);

    video.addEventListener("timeupdate", function() {
      g2d.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
    });
  });
}); 
```

[你可以在 jsfiddle 上](http://jsfiddle.net/4BVM2/1/)看到这个工作，但它运行不顺畅。似乎`timeupdate`每次帧更改时都不会调用函数。它很少被调用。

如何在外部窗口中以完整质量显示视频？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T08:21:27.457

timeupdate() 是为显示视频运行时间而设计的，实际上可能不是每一帧都运行。

要获得平滑的动画循环，`requestAnimationFrame()`请在消费者端使用循环对其进行动画处理

*   [https://developer.mozilla.org/en-US/docs/DOM/window.requestAnimationFrame](https://developer.mozilla.org/en-US/docs/DOM/window.requestAnimationFrame)

对于每个 requestAnimationFrame 调用，拉取新的视频帧。

# c++ - 为什么异常中没有创建对象？

> ID：12031340
> 
> 赞同：3
> 
> 时间：2012-08-20T01:26:17.877
> 
> 标签：c++

我正在尝试了解我的 C++ 类的异常，但我对这个程序有一些不明白的地方。为什么异常中没有创建对象？为什么只提供类名和参数？

这里：`throw( testing ("testing this message"));`

```
#include <iostream>
#include <string>
#include <stdexcept>

using namespace std;

class testing: public runtime_error
{
public:
  testing(const string &message)
    :runtime_error(message) {}
};

int main()
{
  try {
    throw( testing ("testing this message"));
  }
  catch (runtime_error &exception) {
    cerr << exception.what() << endl;
  }
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T01:30:10.663

您正在创建一个临时`testing`对象。我知道语法看起来有点滑稽，因为它没有命名。你期待看到`testing myObj("Testing this message");`，但你得到的是同样的东西，没有变量名。

在你的构造函数中放置一个断点，`testing`你会发现你真的在创建一个对象。它只是在您创建的范围内没有名称。

您可以在许多地方执行此操作（`throw`s、`return`s 以及作为函数的参数）...

```
return std::vector<int>(); // return an empty vector of ints

func(MyClass(1, 2, 3)); // passing `func` a `MyClass` constructed with the arguments 1, 2, and 3 
```

# jquery - 在计时器上打开 Fancybox

> ID：12031341
> 
> 赞同：2
> 
> 时间：2012-08-20T01:26:33.447
> 
> 标签：jquery, fancybox

我已经为此做了几个小时，然后就放弃了。

我希望 Fancybox 在计时器上触发（说 5 秒后）。我可以让它在页面加载时打开并在几秒钟后关闭。但是，我在网上找到的每个示例都无法开始工作。这是我正在使用的代码

```
 $(document).ready(function() {

    $(".video").fancybox({
        maxWidth    : 560,
        padding     : 9,
        maxHeight   : 315,
        fitToView   : false,
        width       : '100%',
        height      : '100%',
        autoSize    : false,
        closeClick  : false,
        openEffect  : 'fade',
        closeEffect : 'fade',
afterLoad: function(){
   setTimeout( function() {$.fancybox.close(); },5000);
  }
    });
$('#video').trigger('click');
}); 
```

这是html：

```
<a id="video" class="video fancybox.iframe"
href="http://www.youtube.com/embed/aqut-wQ72Yk?autoplay=1&autohide=1&modestbranding=1&showinfo=0">Test</a> 
```

非常感激任何的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T01:47:48.920

我想你几乎在那里：

```
$(document).ready(function() {
    setTimeout(function(){
        $('#video').trigger('click');
        setTimeout(function(){
            $.fancybox.close();
        }, 5000)
    }, 5000);
}); 
```

在 DOM 准备好后，fancybox 应该在 5 秒内打开，然后在 5 秒后它应该关闭。

多一点解释：

DOM 就绪仅意味着 Web 浏览器已将其置于 HTML 的底部。请记住，“就绪”与“已加载”不同，因为即使在浏览器一路读取 HTML 之后，图像和任何额外的 javascript 仍然需要加载。

在第一个 setTimeout() 函数内部，您有`click`触发器，以及另一个`setTimeout`在 5 秒内调用并关闭 fancybox 的函数。

# jquery - 从具有相同类的所有元素中获取文本

> ID：12031342
> 
> 赞同：14
> 
> 时间：2012-08-20T01:26:49.707
> 
> 标签：jquery

[在使用此地图插件](http://newsignature.github.com/)制作显示商店位置的美国地图时，我已经大致确定了它，但想要一种更好的方式来执行一个功能。我在地图下方有一个商店列表，希望将所有商店分组在同一州，并在您将鼠标悬停在该州时在侧边栏中显示商店名称。我有悬停和显示数据的工作，但想要改进。我不只是为每个状态编写一个函数并明确说明要显示的内容，而是想`p.cn`从每个具有相同类的 div 中获取第一个。

```
<div class="texas">
    <p class="cn">Store 1</p>
</div>

<div class="texas">
    <p class="cn">Store 2</p>
</div>

mouseoverState: {
    var texas = $('.texas > p.cn').text();
    $('#mysidebarID').html(texas);
} 
```

这仅显示第一家商店“商店 1”，我无法让它`p.cn`从每个 div.texas 中抓取每个商店并在每个商店`<br>`之后显示它们。

如何从具有相同类的每个元素中获取 html 并将其组合成一个字符串，每个节点由 a 分隔`<br>`？

谢谢 - 如果我需要澄清任何事情，请告诉我。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-20T01:30:32.603

您可以使用该`each()`方法，尝​​试以下方法：

```
var str = "";

$('.texas > p.cn').each(function(){
  str += $(this).text() + "<br>";
})

$('#mysidebarID').html(str); 
```

# wpf - 获得焦点时如何突出显示文本框中的文本

> ID：12031344
> 
> 赞同：1
> 
> 时间：2012-08-20T01:27:06.967
> 
> 标签：wpf, listview, textbox

这似乎是一个简单的问题，但我无法在网上找到答案。我唯一想要的就是在用户进入时在文本框中突出显示内容（本例中为“价格”或“数量”）。现在有必要先双击才能编辑内容。内容获得焦点时应自动选择。我怎样才能做到这一点？

谢谢

```
<Window x:Class="Window1"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  Title="Window1" Height="350" Width="479" Name="Window1">
<Window.Resources>
    <CollectionViewSource x:Key="MasterView" />
    <CollectionViewSource Source="{Binding Source={StaticResource MasterView}, Path='OrderDetails'}" x:Key="DetailView" />
    <CollectionViewSource x:Key="CustomerLookup" />
    <CollectionViewSource x:Key="ProductLookup" />
</Window.Resources>
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="42" />
        <RowDefinition Height="110" />
        <RowDefinition Height="42" />
        <RowDefinition Height="147*" />
    </Grid.RowDefinitions>
    <Grid Grid.Row="1" Name="Grid1">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="146*" />
            <ColumnDefinition Width="346*" />
        </Grid.ColumnDefinitions>
        <StackPanel Name="StackPanel1" >
            <Label Height="28" Name="Label1" Width="Auto" HorizontalContentAlignment="Right">ID:</Label>
            <Label Height="28" Name="Label2" Width="Auto" HorizontalContentAlignment="Right">Customer:</Label>
            <Label Height="28" Name="Label3" Width="Auto" HorizontalContentAlignment="Right">Order Date:</Label>
            <Label Height="28" Name="Label4" Width="Auto" HorizontalContentAlignment="Right">Ship Date:</Label>
        </StackPanel>
        <StackPanel Name="StackPanel2" Grid.Column="1" DataContext="{Binding Source={StaticResource MasterView}}">
            <TextBox Height="23" Name="TextBox1" Width="100" Margin="2" HorizontalAlignment="Left" IsReadOnly="True" 
                     Text="{Binding Path=OrderID, Mode=OneWay}"/>

            <ComboBox Height="23" Name="ComboBox1" Width="177" Margin="2"  HorizontalAlignment="Left" 
                      IsEditable="False"
                      ItemsSource="{Binding Source={StaticResource CustomerLookup}}"
                      SelectedValue="{Binding Path=CustomerID}" 
                      SelectedValuePath="CustomerID" 
                      DisplayMemberPath="Name"/>

            <TextBox Height="23" Name="TextBox3" Width="100" Margin="2" HorizontalAlignment="Left" 
                     Text="{Binding Path=OrderDate}"/>
            <TextBox Height="23" Name="TextBox4" Width="100" Margin="2" HorizontalAlignment="Left" 
                     Text="{Binding Path=ShipDate}"/>

        </StackPanel>
    </Grid>
    <StackPanel Name="StackPanel3" Orientation="Horizontal">
        <Button Height="25" Name="btnAdd" Width="Auto" Margin="3">Add Order</Button>
        <Button Height="25" Name="btnDelete" Width="Auto" Margin="3">Delete Order</Button>
        <Button Height="25" Name="btnPrevious" Width="75" Margin="3">Previous</Button>
        <Button Height="25" Name="btnNext" Width="75" Margin="3">Next</Button>
        <Button Height="25" Name="btnSave" Width="75" Margin="3">Save</Button>
    </StackPanel>
    <StackPanel Name="StackPanel4" Orientation="Horizontal" Grid.Row="2">
        <Button Height="25" Name="btnAddDetail" Width="Auto" Margin="3">Add Detail</Button>
        <Button Height="25" Name="btnDeleteDetail" Width="Auto" Margin="3">Delete Detail</Button>
    </StackPanel>
    <ListView Grid.Row="3" Name="ListView1" 
              IsSynchronizedWithCurrentItem="True"
              ItemsSource="{Binding Source={StaticResource DetailView}}">
        <ListView.ItemContainerStyle>
            <Style TargetType="ListViewItem">
                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                <EventSetter Event="GotFocus" Handler="Item_GotFocus" />
            </Style>
        </ListView.ItemContainerStyle>
        <ListView.View>
            <GridView>
                <GridViewColumn Header="ID" Width="75">
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <Label Content="{Binding Path=OrderDetailID}" 
                                     Margin="-6,0,-6,0"/>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                <GridViewColumn Header="OrderID" Width="75">
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <Label Content="{Binding Path=OrderID}" 
                                     Margin="-6,0,-6,0"/>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                <GridViewColumn Header="Product" Width="150">
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <ComboBox IsEditable="False" 
                              Name="cboProduct"
                              IsSynchronizedWithCurrentItem="False"       
                              ItemsSource="{Binding Source={StaticResource ProductLookup}}"
                              SelectedValue="{Binding Path=ProductID}" 
                              DisplayMemberPath="Name" 
                              SelectedValuePath="ProductID" 
                              Margin="-6,0,-6,0"/>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                <GridViewColumn Header="Quantity" Width="75">
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBox Text="{Binding Path=Quantity}" 
                                     Margin="-6,0,-6,0"/>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                <GridViewColumn Header="Price" Width="75">
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBox Text="{Binding Path=Price}" 
                                     Margin="-6,0,-6,0"/>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
            </GridView>
        </ListView.View>
    </ListView>
   </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T01:43:34.240

您必须使用该`TextBox.SelectAll`属性。您可以在每个文本框或每个窗口的基础上手动连接它，或者您可以更全局地进行连接。 [本文](http://www.intertech.com/Blog/Post/How-to-Select-All-Text-in-a-WPF-Content-on-Focus.aspx)描述了一种在全球范围内执行此操作的方法，而[此答案](https://stackoverflow.com/questions/660554/how-to-automatically-select-all-text-on-focus-in-wpf-textbox)描述了另一种方法。

# vb.net - 如何使用 VB.net 从 Gmail.com POP 服务器获取电子邮件文件夹

> ID：12031346
> 
> 赞同：1
> 
> 时间：2012-08-20T01:27:51.740
> 
> 标签：vb.net, sockets, desktop-application, pop3

我设法：

1.  *使用 Socket 方法 ( TcpClient* ) 和 POP3 命令 ( *USER, PASS, STAT* )连接到 Gmail.com POP 服务器 (pop.gmail.com) 端口 995
2.  *使用 POP3 ( STAT* ) 命令从 Gmail.com POP 服务器成功响应我的 VB.net 应用程序 ( *+OK* )
3.  从我的 Gmail.com 帐户中检索电子邮件列表
4.  使用文本框控件以纯文本格式阅读这些电子邮件。

问题是我从整个帐户中获取所有电子邮件，这意味着：如果收件箱文件夹有 (90) 封电子邮件，已发送文件夹有 (10) 封电子邮件，垃圾文件夹有 (10) 封电子邮件，然后我在我的应用程序中收到 (100) 封电子邮件并且它们没有分类，这意味着您无法分辨其中哪一封来自收件箱，哪一封来自垃圾箱。

所以，我的问题是：

*   有没有办法在我的 VB.net 应用程序中单独检索这些文件夹？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T12:26:32.143

不，至少不是`POP3`。

[`POP3`](http://www.faqs.org/rfcs/rfc1939.html)协议不提供*文件夹*之类的东西。那么，您可能应该使用[`IMAP`](http://www.faqs.org/rfcs/rfc3501.html)协议。

# java - 如何更改 ContextMenu MenuItem 的文本？

> ID：12031351
> 
> 赞同：0
> 
> 时间：2012-08-20T01:28:28.713
> 
> 标签：java, android

如何更改弹出上下文菜单项的文本？我希望上下文菜单有一个标题，并且我想根据底层内容进行设置。上下文菜单弹出查找静态字符串，但我想动态更改标题。我似乎无法处理 MenuItem 对象！

```
Main.java:70: error: int cannot be dereferenced
[javac]             MenuItem mi = R.menu.context_menu.articleTitle;
                                                      ^ 
```

这是调出上​​下文菜单的代码：

```
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenu.ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.context_menu, menu);
    Article a = display.getArticle();
    MenuItem mi = R.menu.context_menu.articleTitle;
    mi.setTitle(a.getTitle());
    mi = R.id.articleURL; // this doesn't work either
    mi.setTitle(a.url);
} 
```

我也试过

```
 MenuItem mi = (MenuItem) findViewById(R.id.articleTitle);
    mi.setTitle(a.getTitle()); 
```

但它给了我一个 NullPointerException。这是菜单资源：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
<group android:id="@+id/contextHeader"
       android:enabled="false"
>
    <item android:id="@+id/articleTitle"
        android:title="Title"
    />
    <item android:id="@+id/articleURL"
        android:title="URL"
    />
</group>
<item android:id="@+id/share"
      android:title="Share"
      android:icon="@android:drawable/ic_menu_share"
/>
<item android:id="@+id/skip"
    android:title="Skip"
    android:icon="@android:drawable/ic_media_next"
/>
</menu> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T01:41:02.367

如果要更改上下文菜单的标题，请在菜单实例上使用 setHeaderTitle()。要以编程方式更改菜单项的文本（标题），请使用 menu.findItem(R.id.menu_item_id_defined_in_your_XML)。之后，您可以更改此 MenuItem 的属性，如标题、图标、showAsAction 等。

```
@Override
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.context_menu, menu);
    //Set a title for the context menu
    menu.setHeaderTitle("Title of menu");

    // Select a menu item then change it's title (text)
    MenuItem mi = (MenuItem) menu.findItem(R.id.new_game);
    mi.setTitle("Text of item");
} 
```

# javascript - javascript 的新功能 - 图片库 - 选中时缩略图会展开为全尺寸

> ID：12031352
> 
> 赞同：0
> 
> 时间：2012-08-20T01:28:30.493
> 
> 标签：javascript, image, thumbnails

[进行中的工作 - 现场](http://parlourdc.com/wp/gallery)

我有一个包含几个子页面的画廊页面。每个子页面的左侧都有一行缩略图。When one of the thumbnails is selected, it will show larger on the right. 这是一个 Wordpress 网站，但有人告诉我 JS 可能是最好的选择。我对JS相当缺乏经验，所以我不确定如何去做。

如何显示缩略图和所选图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T04:52:26.223

有很多 jQuery（[jQuery 非常强大！！](http://jquery.com)）图库插件可以满足您的需求。看看这个很棒的网站[很棒的 jQuery 教程](http://tympanus.net/codrops/category/tutorials/page/6/)，有很多关于如何构建鼓舞人心的图片库的详细教程。

除了 JS/jQuery，你还需要知道如何使用 Html && CSS。

基本思想是在缩略图时显示/隐藏（静态或通过 ajax 动态加载）您的大图像`hover()`。

# python - pyinotify 处理事件的返回值

> ID：12031354
> 
> 赞同：1
> 
> 时间：2012-08-20T01:29:07.673
> 
> 标签：python, pyinotify

我正在尝试从处理的方法返回一个值。我是使用 pyinotify 的新手，代码是：

```
import pyinotify
import time

wm = pyinotify.WatchManager()
mask = pyinotify.IN_OPEN

class EventHandler(pyinotify.ProcessEvent):
    endGame = False
    def process_IN_OPEN(self, event):
        print "Opening:", event.pathname
        endGame = True

handler = EventHandler()
notifier = pyinotify.Notifier(wm, handler)

wdd = wm.add_watch('./file.json', mask, rec=True)
wm.rm_watch(wdd.values())

while not handler.endGame:
    time.sleep(1)

notifier.stop()
print "end game" 
```

但是当我打开 file.json 时，endGame 变量永远不会变为 True。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T07:56:14.243

问题出在您的处理程序中。让我们看一下代码（我将在重要的行中添加注释）：

```
class EventHandler(pyinotify.ProcessEvent):
    endGame = False   # Here class attribute "endGame" is declared

    def process_IN_OPEN(self, event):
        print "Opening:", event.pathname
        endGame = True  # Here !local variable! is defined process_IN_OPEN 
```

因此，您在方法范围内定义新变量`process_IN_OPEN`。如果要引用`EventHandler`实例属性，则需要添加 self ：

```
self.endGame = True 
```

# jquery - 根据车把中键的值向 DOM 添加数据

> ID：12031360
> 
> 赞同：0
> 
> 时间：2012-08-20T01:30:02.803
> 
> 标签：jquery, handlebars.js

我想根据从我的 JSON 中选择的键向 dom 添加数据，即我希望将只有 100,101 的数据添加到 dom

**JSON**

```
var school = {
        "students": {
            "100": {
                "name": "abc",
                "bdate": "02/19/2000"

            },
            "101": {
                "name": "xyz",
                "sdate": "05/22/2001"

            },
            "103": {
                "name": "pqr",
                "sdate": "08/11/2001"

            }
        }

    }; 
```

**HTML**

```
 <div class="container">
       <ul>
       <script id="lst_template" type="text/x-handlebars-template">

          {{#each students}} 

    <li>

           {{name}}
           {{bdate}}            

    </li>

       {{/each}}

     </script>  
    </ul>
</div> 
```

**车把**

```
var studentsSelected = [100,101];
var tmpl = Handlebars.compile($('#lst_template').html());
var container = $('.container ul'); 
```

如何将只有 100 和 101 的数据添加到车把？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T07:41:52.217

没有任何内置功能可以为您执行此操作，因此您可以添加帮助程序或在 JavaScript 中预处理数据，以便您可以使用简单的`{{#each}}`.

助手将非常简单，如下所示：

```
Handlebars.registerHelper('each_from', function(keys, obj, block) {
    var html = '';
    for(i = 0; i < keys.length; ++i)
        html += block.fn(obj[keys[i]]);
    return html;
}); 
```

然后模板会是这样的：

```
{{#each_from want_these students}}
    <li>{{name}} {{bdate}}</li>
{{/each_from}} 
```

并调用模板函数，如：

```
var html = tmpl({
    students:   school.students,
    want_these: ['100', '101']
}); 
```

演示：http: [//jsfiddle.net/ambiguous/JkVWh/](http://jsfiddle.net/ambiguous/JkVWh/)

如果你想预处理你的数据，那么你只需要一个简单的循环：

```
var students = [ ];
for(var i = 0; i < studentsSelected.length; ++i)
    students.push(school.students[studentsSelected[i]]); 
```

然后`{{#each students}}`在模板中简单地`tmpl({ students: students })`调用以获取您的 HTML。

演示：http: [//jsfiddle.net/ambiguous/YQGRs/](http://jsfiddle.net/ambiguous/YQGRs/)

* * *

请注意，您的`school`数据`bdate`在一些和`sdate`另一些中都有，我不知道这是否是故意的，所以我不理会它。

并且不要把你`<script id="lst_template">`的放在里面`<ul>`，你可能会在操作的时候覆盖它`<ul>`，如果你把它放在外面，你会有更好的时间`<ul>`。

# c++ - luabind '尝试使用未注册的类' 返回

> ID：12031366
> 
> 赞同：4
> 
> 时间：2012-08-20T01:31:21.503
> 
> 标签：c++, lua, luabind

我目前正在使用 luabind 绑定一个类（准确地说是 SFML 2.0 中的 sf::Time），并且我不断收到来自 luabind 的异常。这是我的绑定代码：

```
 using namespace luabind;

            module(L, "system")
            [
                class_<sf::Time>("Time")
                    .def(constructor<>())
                    .def("toSeconds", &sf::Time::asSeconds)
                    .def("toMilliseconds", &sf::Time::asMilliseconds)
                    .def("toMicroseconds", &sf::Time::asMicroseconds)
                    .def(self == other<sf::Time>())
                    .def(self < other<sf::Time>())
                    .def(self <= other<sf::Time>())
                    .def(self - other<sf::Time>())
                    .def(self + other<sf::Time>())
                    .def(self * float())
                    .def(self / float())
                    .scope
                    [
                        def("seconds", &sf::seconds),
                        def("milliseconds", &sf::milliseconds),
                        def("microseconds", &sf::microseconds)
                    ],
... 
```

我的lua代码是：

```
local t = system.Time.seconds(10) 
```

sf::seconds 的签名是：

```
sf::Time sf::seconds(float) 
```

我尝试在我自己的返回 sf::Time 的函数中包装对 sf::seconds 的调用，并且我也尝试使用 sf::Time* 作为返回值。无论如何，我不断收到错误消息。

有任何想法吗？

编辑：

我已经测试了这个类本身，我可以使用 system.Time() 在 Lua 中创建它，没问题。所有方法都可以正常工作，但 system.Time.seconds 和其他静态方法不起作用。

# jquery - 如何使动态 HTML 元素可以通过 jQuery 访问？

> ID：12031369
> 
> 赞同：0
> 
> 时间：2012-08-20T01:31:43.430
> 
> 标签：jquery, html, dynamic

我建立了一个表，允许用户添加和删除行。我希望能够使用他们输入到这些行中的信息来进行计算，但似乎无法访问此信息，因为它已被动态添加到页面中。

这是我的添加和删除功能：

```
$("a.deleteRow").live('click', function (){
    $(this).parent().parent().remove();
});

$("a.addRow").live('click', function (){
    $("table.moneyTable tr:last").prev('tr').before("<tr>[Long row formatting]</tr>");
}); 
```

我在页面上还有其他一些动态内容，例如依赖于选择框的各种文本输入框，这些都应该可以访问。不过，他们没有响应我的 jQuery。想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T01:33:27.027

嗯......当前版本的 jQuery 中的委托是使用[.on()](http://api.jquery.com/on/)函数执行的。我们将事件委托给静态父对象；`document`如下所示。

```
$(document).on('click', 'a.deleteRow', function(){
  $(this).parent().parent().remove();
});

$(document).on('click', 'a.addRow', function(){
  $("table.moneyTable tr:last").prev('tr').before("<tr>[Long row formatting]</tr>");
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T01:33:05.657

请试试这个：1.7..以上

接口：`.on` [http ://api.jquery.com/on/](http://api.jquery.com/on/)

此外，如果您想知道原因：[jQuery live 方法有什么问题？](https://stackoverflow.com/questions/11115864/whats-wrong-with-the-jquery-live-method/11115926#11115926)

`delegate`等。人。[jquery绑定事件到动态加载的html元素](https://stackoverflow.com/questions/6400343/jquery-binding-events-to-dynamically-loaded-html-elements)

```
<script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js'></script> 
```

希望它适合您的原因`:)`，下面的帖子中也没有提到另一个好的版本，`document`因此我不会在这里更新它！

```
$("a.deleteRow").on('click', function (){
    $(this).parent().parent().remove();
});

$("a.addRow").on('click', function (){
    $("table.moneyTable tr:last").prev('tr').before("<tr>[Long row formatting]</tr>");
}); 
```

# c - 将 float* 转换为 char*、int* 和 char* 不会产生预期结果

> ID：12031370
> 
> 赞同：1
> 
> 时间：2012-08-20T01:31:50.090
> 
> 标签：c, pointers, casting

据我所知，输出应该像 3.14,3.14,3.14 和 256,256,256 对吗？但这会产生不同的输出。谁能指导我完成这个并告诉我为什么会发生这种情况？

```
 main()
    {
     float a = 3.14;
     int b = 256;
     char *p, *p1;
     p = (char *) &a;
     p1 = (char *) &b;
     printf("\nFLOAT:");
     printf("\nValue of *p=%f",*p);
     printf("\nValue of a=%f",a);
     printf("\nValue of *p=%f",*p);
     printf("\n\nINTEGER:");
     printf("\nValue of *p1=%d",*p1);
     printf("\nValue of b=%d",b);
     printf("\nValue of *p1=%d",*p1);
    }

    Output:
    FLOAT:
    Value of *p=0.000000
    Value of a=3.140000
    Value of *p=3.140001

    INTEGER:
    Value of *p1=0
    Value of b=256
    Value of *p1=0 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T01:41:05.477

表达式`*p`具有类型`char`。格式说明符`%f`需要类型为 的参数`float`。将错误类型的参数传递给可变参数函数，例如`printf`调用未定义的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T02:18:30.093

我得到的答案与您所做的略有不同（http://ideone.com/RG4uq），考虑到具有混合浮点和整数类型的可变参数函数的行为未定义，这并不令人惊讶。

这就是正在发生的事情。假设内存从地址 0x50000000 开始，32 位机器，小端

```
50000000  c3  f5  48  40   (a)
50000004  00  01  00  00   (b)
50000008  00  00  00  50   (p)
5000000c  04  00  00  50   (p1) 
```

a 的类型是 float，b 的类型是 int，p 的类型是 char*，p1 的类型是 char*。

对于整数，您会看到

*   print p1 as an int ==> `*p1`是地址 50000004 处的字节，为 0，所以打印 0。
*   print b as an int ==> 显然`b`是 256，因为它是一个 int。
*   print p1 as an int ==> `*p1`是地址 50000004 处的字节，即 0，因此打印 0（如前所述）。

在小端机器上，您甚至可以尝试打印`p1[1]`为整数，您会看到 1（很有趣，嗯？请参阅[http://ideone.com/daS6d](http://ideone.com/daS6d)）。

对于花车，情况有所不同。在许多处理器上，比如 x86-64，参数是在寄存器中传递的。你打`printf`了三遍。每次将要打印的东西都来自`xmm0`（假设 x86-64）。但是请注意，当您第一次尝试打印`*p`char 时，*没有*传入任何内容`xmm0`（`*p`被传入`%edi`），因此您在其中的任何垃圾都会被打印（可能是 0 或 0.0234892374 或其他）。但接下来你传入一个*真正的*浮点数`xmm0`并打印 3.14。但是当你来第三个 printf 时，你什么也没有传递（因为`*p`是一个字符），所以剩下的`xmm0`? 没错，3.14。也许它可能是别的东西，但很可能它没有改变。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T01:45:17.190

它的行为不符合预期，因为 float* 和 char* 的大小不同。转换它们可能会牺牲您的表达准确性！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T02:07:39.443

`char`简短的回答是，当您将类型传递给`printf`使用格式说明符时，您正在调用未定义的行为，`%f`因此您不应该特别*期待*任何事情。

长答案取决于实现，但接下来是我对您平台上可能发生的事情的观察。当您要求`printf`打印一个`double`值（与`%f`格式说明符一样）时，它会`sizeof(double)`从堆栈中读取下一个字节并将其解释为浮点值并打印它。在第一次`printf`调用中，第一次生成新的堆栈帧时，堆栈上的数据在形成`char`您实际传递的位之后等于零浮点值。在对 的第二次调用中`printf`，会生成一个新的堆栈帧，可能会覆盖第一次调用所做的相同空间。在这种情况下，一个完整的`double`值存在，并按预期打印。当函数返回时，堆栈帧被“销毁”。出于效率的考虑，当函数返回并且内容保留时，堆栈帧通常不会清零。在您对 的第三次调用中`printf`，您再次传递了一个字节，而您要求`printf`将字节解释`sizeof(double)`为浮点值。`printf`从上一次调用到现在的堆栈帧包含从上一次调用`double`传递的值，其中一个字节被新参数中的字节覆盖，从而导致打印值。

如果我将您的第二个`printf`电话更改为：

```
printf("\nValue of a=%f", 1.234); 
```

第三次调用`printf`打印（在我的系统上）：

```
Value of *p=1.234000 
```

这似乎验证了上述逻辑。

总之，您要求`printf`从堆栈中读取比实际传递给函数更多的数据，因此您的结果是未定义的。在您的情况下，读取的数据是先前调用的残余，这解释了您在特定平台上获得的结果。（正如 Ray 指出的那样，传递参数的实际方式可能会有所不同，因为这取决于实现。一些系统会将值传递到寄存器中，但要点保持不变。）

# .htaccess - mod_rewrite：如果文件存在于另一个目录中，则改为提供该文件

> ID：12031374
> 
> 赞同：8
> 
> 时间：2012-08-20T01:32:25.160
> 
> 标签：.htaccess, mod-rewrite

我有一个网站`example.com/test/`。假设该网站的布局如下：

```
example.com
└── test/
    ├── assets/
    │   └─ stylesheet.css
    │
    ├── .htaccess
    └── index.php 
```

`index.php`这是路由器，现在显然很酷。

`example.com/test/stylesheet.css`每当`assets/`用户请求一个像`index.php`. 理想情况下，以下方法会起作用：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond assets/%{REQUEST_FILENAME} -f
RewriteRule ^(.+)$ assets/$1 
```

但由于`%{REQUEST_FILENAME}`是绝对路径，`assets/%{REQUEST_FILENAME}`结果是类似`assets/home/public/test/stylesheet.css`. `%{REQUEST_URI}`也好不到哪里去：它变成了`assets/test/stylesheet.css`. 我也看了[这个问题](https://stackoverflow.com/questions/2320910/mod-rewrite-i-want-to-detect-if-a-file-exists-in-another-directory-and-retrieve)，但答案也没有奏效。

有什么方法可以在不使用 PHP 的情况下做到这一点？（如果没有，我将只使用 PHP 的`readfile`，但我不想担心 LFI 或任何东西。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-20T01:48:07.157

尝试使用`the %{DOCUMENT_ROOT}`和`%{REQUEST_URI}`vars

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{DOCUMENT_ROOT}/assets/%{REQUEST_URI} -f
RewriteRule ^(.+)$ assets/$1 
```

* * *

编辑：我明白了，试试这个：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} ^/([^/]+)/(.+)$
RewriteCond %{DOCUMENT_ROOT}/%1/assets/%2 -f
RewriteRule ^(.*)$ /%1/assets/%2 [L,R] 
```

# django - 在 Django 中发布后默认表单字段为空

> ID：12031379
> 
> 赞同：0
> 
> 时间：2012-08-20T01:32:51.397
> 
> 标签：django

模型：

```
class Comment(models.Model):
    date = models.DateTimeField(default = datetime.datetime.now)
    text = models.TextField() 
```

形式：

```
class CommentForm(forms.ModelForm):
    class Meta:
        model = Comment 
```

在模板中，我只有“文本”字段。当我单击提交按钮时，form.data 中的 QueryDict 仅包含文本，尽管日期字段的默认值。如何正确设置默认值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T01:44:10.467

更新：

我认为这`default=datetime.date.now`表现得像`auto_now_add=True`因为您提到您的模板仅包含该`text`字段。

事实证明，您的情况没有任何不同的处理方式，您必须`date`在表单中显示该字段。

如果你想忽略它，你可以重写`ModelForm.save`方法来自己设置日期，或者在你的模型`save()`定义中添加它。

您应该查看`auto_now_add=True`模型字段定义中的参数，该参数会`datetime.datetime.now()`在第一次保存时自动添加设置日期字段的行为。

```
date = models.DateTimeField(auto_now_add=True) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T13:43:48.760

你应该写

```
default = datetime.datetime.now() 
```

用括号调用函数 ang 获取日期时间。有**auto_now**字段可以更好地做到这一点。[https://docs.djangoproject.com/en/dev/ref/models/fields/#datefield](https://docs.djangoproject.com/en/dev/ref/models/fields/#datefield)

这是从视图中提供初始数据的另一种方式：

`form = CommentForm( initial = { 'date': datetime.datetime.now(), 'text': u'', }`

阅读更多关于[https://docs.djangoproject.com/en/dev/ref/forms/fields/#initial](https://docs.djangoproject.com/en/dev/ref/forms/fields/#initial)

# jsp - JSP和struts2框架中的弹窗显示

> ID：12031380
> 
> 赞同：-2
> 
> 时间：2012-08-20T01:32:54.987
> 
> 标签：jsp, jakarta-ee, struts2

我正在尝试实现一个弹出窗口，显示在 jsp 中选择的列表中的选项描述。我使用的是 struts2 框架。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:13:08.723

您应该必须使用 jQuery 核心或[jQuery UI](http://jqueryui.com/home) API，通过它们您可以使用高级和可主题化的小部件来构建交互式 Web 应用程序。

编辑：

SO Thread -[如何使用 jQuery 生成一个简单的弹出窗口？](https://stackoverflow.com/questions/1328723/how-to-generate-a-simple-popup-using-jquery)

# jquery - 停止具有随机效果的 css3 效果

> ID：12031386
> 
> 赞同：5
> 
> 时间：2012-08-20T01:33:38.070
> 
> 标签：jquery, jquery-ui, jquery-plugins, css-transitions

在[这个演示](http://jsfiddle.net/CfFSY/)中，我在[jq transit](http://ricostacruz.com/jquery.transit/)中使用了一个名为“Rotate 3d”的动画效果。我希望，当您将鼠标悬停在第一个框上时，这些框将开始一个接一个地旋转，直到它们全部变为白色，而当您将鼠标移出容器框时，它们将全部变回黑色。

**问题：**当您将鼠标悬停在第一个盒子上，然后快速连续几次从容器中移出时，就会出现问题。似乎翻转的框失去了旋转顺序，并且在鼠标关闭时没有正确重置为黑色。

**我尝试过的事情：**我尝试过使用 fx 队列，但似乎并没有太大的不同。我还尝试在动画运行时取消绑定鼠标离开，然后在最后一个框的延迟过去后再次绑定它，但这也不起作用。

**我正在寻找的答案：**有几种方法可以回答这个问题。首先是如何在鼠标移出后立即终止这些动画。第二个是每次鼠标移出时如何在第一个框开始订购。第三个答案是确保在框旋转后鼠标移出时所有内容都重置（将其添加到队列中？）

如果您可以将 jsFiddle 包含在解决方案中，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:18:47.547

好吧，经过一段时间的工作，我能够提出一个（可能很糟糕）的解决方案，但至少它大部分都有效。

```
var queue = new Array();

$("#img1").on("hover", function() {
    var delay = 500;
    $("#mainContainer").children('div').each(function(i) {
        var _this = this;
        queue.push(setTimeout(function() {
            animate(_this);
        }, i * delay));
    });
});

function animate(elem) {
    $(elem).css("transition", "500ms all ease-in-out");
    $(elem).css("transform", "perspective(100px) rotate3d(1, 1, 0, 360deg)")
    $(elem).css("background-color", "#fff");
}

function clearQueue() {
    for (index in queue) {
        clearTimeout(queue[index]);
    }        
}

$("#mainContainer").on("mouseleave", function() {
    clearQueue();
    $("#mainContainer").children('div').each(function(i) {
        $(this).css("transition", "0ms all ease-in-out");
        $(this).removeAttr('style');
    });
});
​ 
```

这是[小提琴](http://jsfiddle.net/CfFSY/3/)。

# c# - 如何知道实体框架中数据库的物理大小？

> ID：12031393
> 
> 赞同：1
> 
> 时间：2012-08-20T01:35:35.433
> 
> 标签：c#, database, entity-framework, code-first

`*.mdf`是否可以仅使用实体框架类的方法或属性来知道代码首先创建的数据库物理文件大小（以字节为单位）？如果有可能，那该怎么做？？？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T02:22:36.023

您可以通过 exec 获取数据库大小`sp_spaceused`

```
var ef = new EFContext();
var sqlConn = ef.Database.Connection as SqlConnection;
var cmd = new SqlCommand("sp_spaceused")
{
    CommandType = System.Data.CommandType.StoredProcedure,
    Connection = sqlConn as SqlConnection
};
var adp = new SqlDataAdapter(cmd);
var dataset = new DataSet();
sqlConn.Open();
adp.Fill(dataset);
sqlConn.Close();
//You will get:
//database_name database_size   unallocated space
//performance       1091.00 MB      456.00 MB
//
//reserved  data        index_size  unused
//557056 KB 540680 KB   10472 KB    5904 KB
Console.WriteLine(dataset.Tables[0].Rows[0][1]); 
```

# c++ - C++11：保证来自模板参数的非转换引用

> ID：12031394
> 
> 赞同：2
> 
> 时间：2012-08-20T01:35:41.337
> 
> 标签：c++, c++11, type-conversion

所以我有一个结构 X：

```
struct X
{
    int typecode;
    char* pData;
    int length;
    ...
} 
```

和一长串类型，我们称这个集合为 TS。TS 包括大多数原始类型和几种类类型。

对于 TS 中的每种类型 T，我定义了一个常规函数：

```
void setup(X& x, const T& t); 
```

例如对于 T = 字符串设置如下所示：

```
void setup(X& x, const string& s)
{
    x.typecode = X_STRING;
    x.pData = s.c_str();
    x.length = s.size();
    ...
} 
```

现在我有一个模板函数 convert_to_x：

```
template<class T>
X convert_to_x(const T& t)
{
    X x;
    memset(x, 0, sizeof(x));
    setup(x, t);
    return x;
} 
```

还有一个函数 f，它接受一个 X 数组：

```
void f(X* xs, int num_args); 
```

还有一个可变参数模板函数`g`：

```
template<class... Args)
void g(Args... args)
{
    constexpr num_args = sizeof...(args);

    X xs[] = { convert_to_x(args)... };

    f(xs, num_args);
} 
```

发生的事情是，您可以使用任意数量的参数和类型调用 g，它将参数转换为 X 类型的数组，然后调用 f。

问题是，如果 g 被调用的类型不在 TS 中，但可以转换为 TS 中的类型，则会发生以下情况：

1.  调用转换构造函数来创建临时 t。
2.  `setup`将存储一个指向这个临时的指针。
3.  临时的被破坏了。
4.  f 使用包含悬挂指针的 xs 调用。

我需要一种方法`g`来转换任何可转换为 TS 中的类型但不是 TS 中的类型的参数，并将它们保留在`g`.

实现这一目标的最佳方法是什么？

**更新：**

我刚刚想到的一种可能可行的方法是为`convert`TS 中的每种类型 T 定义一个常规函数，如下所示：

```
T convert(const T& t) { return t; } 
```

然后为 g 定义一个包装器：

```
template<class... Args>
void g2(Args... args)
{
    g(convert(args)...);
} 
```

但我认为这会导致不必要地复制已经在 TS 中且不需要转换的类型。有没有办法使用右值/左值语义来避免这种情况？

**更新 2：**

也许这会起作用：

对于 TS 中的每个 T：

```
const T& convert(const T& t) { return t; }
T convert(const T&& t) { return t; } 
```

然后：

```
template<class... Args>
void g2(Args... args)
{
    g(convert(args)...);
} 
```

是否有任何情况下安装程序可能会收到上述临时文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:00:21.377

您可以为以下内容添加已删除的重载`setup`：

```
void setup(X& x, const string& s) = delete; 
```

由于右值引用比 const 左值引用更容易绑定到临时对象，`setup`因此使用临时对象调用将选择带有右值引用的重载。但是由于这个`setup`重载被删除，实际调用它是非法的。因此，当`g`使用错误类型的参数调用时，该行`X xs[] = { convert_to_x(args)... };`需要`convert_to_args`调用 的已删除版本`setup`，因此实例化失败。反过来，它也会导致 的特定实例化`g`失败。

## 编辑

查看您的更新＃2，这应该可以。由于`convert`已经导致最佳转换为 , 之一`TS`，`g`因此永远不应使用不需要的类型调用。因此，在调用`setup`. 因此，任何临时对象都将成为 的参数`g`，并保证在 的期间内存活`g`。

## 编辑 2

你是对的，这`T convert(const T&& t) { return t; }`可能会导致值被不必要地复制。但这很容易解决：

```
const T& convert(const T& t) { return t; }
const T&& convert(const T&& t) { return std::move(t); } 
```

你不会得到任何值的复制。临时对象的生命周期也是正确的，因为临时对象一直存在到创建它们的完整表达式的末尾：

```
template<class... Args>
void g2(Args... args)
{
    g(convert(args)...);
} //          ^^^^ temporaries created by a conversion here will live until g returns 
```

# asp.net - 使用资源文件的多语言网站的超链接和锚点中没有显示日文字母？

> ID：12031395
> 
> 赞同：0
> 
> 时间：2012-08-20T01:35:50.233
> 
> 标签：asp.net, resx, multilingual

我在母版页中使用过它。

```
<div class="menu_nav">
  <ul>
    <li>
      <asp:HyperLink ID="HyperLink1" runat="server" meta:resourcekey="HyperLink1" NavigateUrl="~/Home.aspx">hello</asp:HyperLink>
    </li>
    <li><a href="AboutUs.aspx"><span>
      <asp:Label ID="lblAboutUs" runat="server" Text="About Us"></asp:Label></span></a>
    </li>
  </ul>
</div> 
```

我已经使用了这段代码：

```
ResourceManager rm;
    CultureInfo ci;
    private void LoadString(CultureInfo ci)
    {

        lblCompanyName.Text = rm.GetString("siteName", ci);
        lblSlogan.Text = rm.GetString("siteSlogan", ci);

        lblAboutUs.Text = rm.GetString("menuAboutUs", ci);
        HyperLink1.Text = rm.GetString("menuHome", ci);}
     if (Session["cultureID"] =="1")
        {

            Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
            rm = new ResourceManager("Resources.Strings",
                     System.Reflection.Assembly.Load("App_GlobalResources"));
            ci = Thread.CurrentThread.CurrentCulture;
            LoadString(ci);}
        else if( Session["cultureID"] =="2")
        {
            Thread.CurrentThread.CurrentCulture = new CultureInfo("ja-JP");
            rm = new ResourceManager("Resources.Strings",
                     System.Reflection.Assembly.Load("App_GlobalResources"));
            ci = Thread.CurrentThread.CurrentCulture;
            LoadString(ci); } 
```

标签中的一切都很好（我使用标签显示网站名称），但是当我在锚点内使用超链接或标签`<a href>`制作菜单时，没有显示日语（英文字母很好）。如果我查看页面源代码（在浏览器中），则会显示日语。问题是来自 resx 的日语数据未在我的页面上呈现。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T11:30:00.350

我已经测试了你的代码，它对我有用。网页中可能有问题。尝试在您的页面部分添加此标签。它将完美地呈现日本字符。

```
<head runat="server">
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <title></title>
</head> 
```

# javascript - 为什么 FireBug 分析器不会停止运行？

> ID：12031398
> 
> 赞同：1
> 
> 时间：2012-08-20T01:36:26.617
> 
> 标签：javascript, profiling, firebug

我在这段代码上运行 FireBug 分析器：

```
function y() {
    for (var i = 0; i < 10000; i++) {
        var x = i;
    }
}
console.profile();
y();
console.profileEnd(); 
```

但是，它不断地说：“分析器正在运行。再次单击“配置文件”以查看其报告。”

当我单击该消息或“个人资料”按钮时，什么也没有发生。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-20T18:08:14.430

显然，这是通过重新启动系统来解决的。我不确定是什么导致它永远工作。

# css - 溢出：隐藏，背景图像：封面、锚点和平板电脑

> ID：12031399
> 
> 赞同：0
> 
> 时间：2012-08-20T01:36:32.913
> 
> 标签：css, ipad, overflow, background-image, sticky-footer

我正在创建一个不垂直滚动的页面。这是问题页面供参考 - [http ://horizo​​nwebtest.zxq.net/knowledgebase/](http://horizonwebtest.zxq.net/knowledgebase/)

除了两件事之外，它运行良好：

1.  在 iPad（可能是其他平板电脑）上查看时，页脚向上推约 10 px，背景图像显示在页脚下方。

2.  更重要的是，在上面的链接页面上，当我单击 div 内的锚点的链接时，它会向上滚动页面，在页脚下方显示空间并部分切断菜单。

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T01:45:41.163

我能够通过执行以下操作来修复它：

1.) 将div`h6`内部设置为`.footer-left.fltlft``margin-top: 20px;`

`padding-top: 20px`2.）从 div 本身中删除

3.)在div`margin-bottom:0;`内的 h5 上设置。`.footer-right.fltlft`

附带说明一下，将垂直文本以行高居中，它会更好地工作，并且有助于防止此类问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T01:58:16.200

请设置您的内容框`central_container`灵活（百分比），以便在任何设备中查看，然后尝试将页脚设置为@mash 的答案。;) ( `margin-bottom:0;`)

# java - 塔防暴民健康

> ID：12031400
> 
> 赞同：-1
> 
> 时间：2012-08-20T01:37:01.027
> 
> 标签：java

我正在开发一款塔防游戏，并且在随着等级的增加而修复更强大的小怪的健康时遇到了一个巨大的问题。我目前将健康设置为 mobSize（我的意思是，健康栏与暴徒的大小成比例）。这显然不适用于更高的级别，因为小怪保持相同的大小并且变得更强大，但我的 draw() 方法可以做到这一点：

```
public void draw(Graphics g) {
    if(inGame) {
        if(Screen.level == 1){
        g.drawImage(Screen.tileset_mob[1], x, y, width, height, null);
        //Health Bar
        g.setColor(new Color(180, 180, 50));
        g.fillRect(x, y -(healthSpace + healthHeight) , width, healthHeight);      

        g.setColor(new Color(255, 0, 0));
        g.fillRect(x, y -(healthSpace + healthHeight) , mobshealth , healthHeight);

        g.setColor(new Color (0, 0, 0));
        g.drawRect(x, y -(healthSpace + healthHeight), mobshealth - 1, healthHeight -1);
        } 
```

这显然只是从健康栏的宽度中删除，它被设置为暴徒的健康状况。我的问题是，我想制作一个更强大的暴徒，随着等级的增加，它会从健康条中带走更少的东西。有什么建议么？太感谢了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T01:40:50.837

逻辑实体的属性应该与其视觉表示无关，而恰恰相反。

换句话说，你不应该关心与绘图或 GUI 相关的任何事情，而是让你的 Mob 类（逻辑类，而不是它的视觉表示）允许某种类型的强度乘数因子可以应用于它的大小属性和然后在它的`getStrength()`方法中返回。视觉表示将简单地反映此方法返回的值。

IE，：

```
// strengthScaleFactor is a double which increases at higher levels
public int getStrength() {
   return (int) (getMobSize() * strengthScaleFactor);
} 
```

暴民力量的视觉表示，“健康栏”，可以计算和使用标准化的力量水平，即上述方法的结果除以返回最大力量的其他方法（`getMaxStrength()`也许？）。

在这里一直想着[MVC](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T01:56:31.437

想想 MVC

```
//Model fields
//HP, MAXHP

//Controller method
float getHPPercent()
{
return HP/HPMax(float);
}

//View

int HPBoxWidthInPixels
Draw()
{
float percent = controller.getHPPercent();
Rect HPBox.x = Math.RoundToInt(HPBoxWidthInPixels *percent);
} 
```

# signalr - 将 SignalR 添加到 MainSite.Master 时出现“Microsoft JScript 运行时错误”

> ID：12031415
> 
> 赞同：0
> 
> 时间：2012-08-20T01:42:49.047
> 
> 标签：signalr

请帮我。我们的 aps.net Web 应用程序使用 SignalR 作为通知程序，它使用集线器并且在一个页面上运行良好，但是当我将这些代码行添加到 MainSite.Master 时：

```
 <script type="text/javascript">
    jQuery(document).ready(function (jQuery) {
        var notifyHub = jQuery.connection.notificationHub;

        jQuery.connection.hub.start();
    });
</script> 
```

Visual Studio 抛出错误消息：

> Microsoft JScript 运行时错误：无法获取属性“传输”的值：对象为空或未定义

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T08:09:50.547

我通过替换解决了我的问题：

```
jQuery.connection.hub.start(); 
```

经过

```
$.connection.hub.start({ transport: ['webSockets', 'serverSentEvents', 'longPolling'] }); 
```

# php - 超级奇怪的 HTML 搞砸了

> ID：12031416
> 
> 赞同：0
> 
> 时间：2012-08-20T01:43:04.227
> 
> 标签：php, sql, css, html

我有一个评论系统，它通过向 SQL 数据库添加一行来工作。不管怎样，这行得通，但是当我回显出评论时，div 变得一团糟。无论如何，这是它所在的页面：http: [//learntc.net/index.php](http://learntc.net/index.php)。

PHP：

```
while($row = mysql_fetch_array($result))
{
    if ($count==1)
    {
      $bg == "33383C" ;
      $count = 0;
    }
    echo "<div style='background-color: $bg; border: 1px soild silver;' class='comment'>";
    echo "<div class='imageAndName'>";
        echo "<img src='". $row["image"] ."' class='cPic'/>";
        echo "<div class='UserLink'><a href='" . $row["page"] . "'>" . $row["username"] . "</a></div>";
    echo "</div>";
    echo "<div class='textStuff'>";
        echo "<div class='post'>" . $row["comment"] . "</div>";
        echo "<div style='color: gray; font-size: 8px'>" . $row["date"] . "</div>";
    echo "</div>";
    echo "</div>";

    $bg = "#282C2F";
    $count = $count + 1;
} 
```

CSS：

```
.comments{
    float: right;
    padding: 10px;
    width: 50%;
    border: 1px solid #454D53;
}
.cPic{
    width: 60px;
    height: 60px;
}
.imageAndName{
    width: 30%;
    overflow: hidden;
    float: left
}
.imageAndName a{
    display: block;
}
.textStuff{
    width: 70%;
    float: right;

}
.post{
    overflow: hidden;
    width: 100%;
}
.comment{
    padding-bottom: 5px;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T01:47:27.297

添加`clear: both`到您的`.comment`风格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T01:50:27.257

问题一：

```
$bg == "33383C" ; 
```

应该

```
$bg = "#33383C"; 
```

我没有看到其他任何东西。由于这个原因，div 可能被搞砸了。

# javascript - JavaScript拆分字符串不起作用

> ID：12031421
> 
> 赞同：2
> 
> 时间：2012-08-20T01:43:33.837
> 
> 标签：javascript, split

我正在尝试拆分字符串，但在执行此操作时遇到问题。

我的字符串是：

```
var EventList = "0x0,0x1,0x1 | 0x0,0xff,0x2 | 0x0,0x1,0x1 | 0x0,0x1,0x1 | 0x0,0xff,0x5 | 0x0,0xff,0x7 | 0x0,0xff,0x3 | 0x0,0xff,0x6"; 
```

我需要能够从字符串中删除所有空格（我正在使用以下代码）

```
EventList = EventList.replace(/\s/g,''); 
```

我他们需要全部更换| with , (comma) (我使用下面的代码)

```
EventList = EventList.replace('|',','); 
```

然后我需要使用 , （逗号）拆分字符串（我正在使用以下代码）

```
EventList = EventList.split(','); 
```

我正在尝试从我的字符串中发出 0x2 警报（我正在使用以下代码）

警报（事件列表 [5]）；

但是，它警告 0x2|0x0 作为字符串而不是 0x2。

我的完整代码如下所示：

```
var EventList = "0x0,0x1,0x1 | 0x0,0xff,0x2 | 0x0,0x1,0x1 | 0x0,0x1,0x1 | 0x0,0xff,0x5 | 0x0,0xff,0x7 | 0x0,0xff,0x3 | 0x0,0xff,0x6";
EventList = EventList.replace(/\s/g,''); // replace any spaces in EventList
EventList = EventList.replace('|',',');  // replace any | with ,
EventList = EventList.split(',');       // Split EventList

alert(EventList[5]); // should alert 0x2 but it alerts 0x2|0x0 
```

有谁知道我哪里出错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T01:46:54.370

如果您使用字符串作为 的第一个参数`.replace()`，它只会转换第一次出现。

```
var EventList = "a|b|c|d";
EventList = EventList.replace('|',',');
alert("a,b|c|d"); // displays "a,b|c|d" 
```

您需要使用带有`/g`全局标志的正则表达式，就像您一开始所做的那样。

```
EventList = EventList.replace(/\|/g,',');  // replace any | with , 
```

(`|`需要在正则表达式中使用`\`反斜杠进行转义，因为它在正则表达式语法中具有特殊含义。)

我做了这个替换，它显示“0x2”，正如你所说的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T01:46:28.480

您需要对管道栏 /|/g 进行全局替换。我相信我过去曾遇到过这种情况 - 默认情况下，在 JS 中替换不是全局的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T01:48:39.873

第二次更换的小错误。应该使用正则表达式替换“|”。见下文：

```
var EventList = "0x0,0x1,0x1 | 0x0,0xff,0x2 | 0x0,0x1,0x1 | 0x0,0x1,0x1 | 0x0,0xff,0x5 | 0x0,0xff,0x7 | 0x0,0xff,0x3 | 0x0,0xff,0x6";
EventList = EventList.replace(/\s/g,''); // replace any spaces in EventList
EventList = EventList.replace(/\|/g,',');  // replace any | with ,
EventList = EventList.split(',');       // Split EventList

alert(EventList[5]); // alerts 0x2 
```

# javascript - javascript 打印变量1 || 变量2

> ID：12031425
> 
> 赞同：-2
> 
> 时间：2012-08-20T01:44:54.237
> 
> 标签：javascript

我有一个具有扩展名的文件：

```
.doc or .docx 
```

我想以这种方式链接它：

```
document.getElementById("file").innerHTML = "View file sent <a href='../folder/filename" +
(what syntax do I need to add here if I wanted to print which extention file is exist on that folder) 
```

在 PHP 中我们可以做到这一点

```
var1 = ".doc";
var2 = ".docx";

var1 ? var1 : var2; 
```

JavaScript 中 this 的等价物是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T01:48:03.460

## JavaScript 中的三级运算符

**JavaScript 中确实**存在三级运算符：

```
var var1=".doc";
var var2=".docx";

alert(var1 ? var1 : var2);​ 
```

证明：http: [//jsfiddle.net/gRMf2/](http://jsfiddle.net/gRMf2/)

它将像这样工作（[jsfiddle](http://jsfiddle.net/gRMf2/1/)）：

```
alert(var1 ? var1 : var2);​ 
```

## 使用未定义的变量

然而，如果`var1`可以是未定义的，你会得到一个错误（证明：[jsfiddle](http://jsfiddle.net/gRMf2/3/)）。在这种情况下，编写这将解决问题（证明：[jsfiddle](http://jsfiddle.net/gRMf2/2/)）：

```
alert(typeof var1 !== 'undefined' ? var1 : var2);​ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T01:48:14.863

在 javascript 中，`var1 || var2`与 php 相同`var1 ? var1 : var2`。

```
document.getElementById("file").innerHTML = "View file sent <a href='../folder/filename" + (var1 || var2); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T01:52:59.713

JavaScript 无法访问文件系统。即使是这样，它也将是最终用户的本地文件系统。您需要检查该文件是否存在于 PHP（或您选择使用的任何服务器端语言）中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T01:49:27.903

我不确定你在这里做什么：

```
var1=".doc";
var2=".docx";

var1? var1 : var2; 
```

这将始终返回“.doc”，因为无论您使用的是 PHP 还是 Javascript，var1 的计算结果始终为 true。

* * *

听起来你可能会追求这样的东西：

```
// this function is from http://stackoverflow.com/a/3646923/1188942
function UrlExists(url)
{
    var http = new XMLHttpRequest();
    http.open('HEAD', url, false);
    http.send();
    return http.status!=404;
}

var ext;
if (UrlExists("http://www.mywebsite.com/folder/file.doc"))
    ext = ".doc";
else
    ext = ".docx"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-20T01:50:50.607

这在 Javascript 中非常相似：

```
var doc = ".doc";
var docx = ".docx";
var ext = doc ? doc : docx;
alert(ext); 
```

# jakarta-ee - 当我将 rtf 模板集成到我的 javaee 动态 Web 应用程序中时，发生

> ID：12031427
> 
> 赞同：0
> 
> 时间：2012-08-20T01:45:15.763
> 
> 标签：jakarta-ee

此错误显示在 IE8 资源管理器中。

**RTFTTemplateServlet：处理 RTF 版本时出错** 未定义名为“vmRTFTemplate”的 beanorg.springframework.beans.factory.NoSuchBeanDefinitionException：在 org.springframework 的 org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanDefinition(DefaultListableBeanFactory.java:355) 中未定义名为“vmRTFTemplate”的 bean .beans.factory.support.AbstractBeanFactory.getMergedBeanDefinition(AbstractBeanFactory.java:800) 在 org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:237) 在 org.springframework.beans.factory.support.AbstractBeanFactory .getBean(AbstractBeanFactory.java:156) 在 org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:642) 在 net.sourceforge.rtf.helper.RTFTemplateBuilder.newRTFTemplate(RTFTemplateBuilder.java:85) 在 net.sourceforge.rtf.helper.RTFTemplateBuilder.newRTFTemplate(RTFTemplateBuilder.java:100) 在 net.sourceforge.rtf.web.servlet.AbstractRTFTemplateServlet.doRequest(AbstractRTFTemplateServlet.java:118) 在 net.sourceforge.rtf.web.servlet.AbstractRTFTemplateServlet。 doGet(AbstractRTFTemplateServlet.java:64) at javax.servlet.http.HttpServlet.service(HttpServlet.java:617) at javax.servlet.http.HttpServlet.service(HttpServlet.java:717) at org.apache.catalina.core .ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290) 在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) 在 org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:78) 在org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:77) 在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) 在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) 在 org.apache.catalina.core.StandardWrapperValve .invoke(StandardWrapperValve.java:233) 在 org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191) 在 org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127) 在 org. org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) 的 org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter. java:298) 在 org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852) 在 org.apache.coyote.http11。Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588) at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489) at java.lang.Thread.run(Thread.java:662)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T01:48:18.733

我猜你没有声明名为“vmRTFTemplate”的spring bean，检查你的spring配置文件。

# java - 带有标题和 toast 的 ListActivity 选择了错误的列表项

> ID：12031432
> 
> 赞同：2
> 
> 时间：2012-08-20T01:46:01.437
> 
> 标签：java, android, xml, header, listactivity

编写一个扩展 ListActivity 的应用程序 Menu.java，我在列表活动的顶部添加了一个 TextView 标题。

标题和列表活动的布局正是我想要的，但是当我点击说 Item1 时，吐司会弹出并说“Item2”被选中。当我点击 Item2...“Item3”被选中。但是当我点击 Item3 时，应用程序崩溃并显示一堆运行时错误。

在我实现标头之前它没有这样做。我已经搜索并搜索了 stackoverflow 和 android 开发网站，但似乎找不到答案。

我已经将标题设置为 false，因此它不可点击。

提前致谢！对不起，如果我错过了一些明显的东西......这里是新手。:P

```
//this is Menu.java

package com.example.mytexts;

import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;
import android.widget.AdapterView.OnItemClickListener;

public class Menu extends ListActivity {

String[] values = new String[] { "Item1", "Item2", "Item3" };

public void onCreate(Bundle biscuits) {
    super.onCreate(biscuits);

    setContentView(R.layout.text_layout);

    ListView lv = getListView();
    LayoutInflater inflater = getLayoutInflater();
    View header = inflater.inflate(R.layout.header,
            (ViewGroup) findViewById(R.id.header__root));
    lv.addHeaderView(header, null, false);

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, values);
    setListAdapter(adapter);
}

protected void onListItemClick(ListView l, View v, int position, long id) {
    super.onListItemClick(l, v, position, id);
    String cheese = (String) getListAdapter().getItem(position);
    Toast.makeText(this, cheese + " selected", Toast.LENGTH_SHORT).show();

    try {
        Class ourClass = Class.forName("com.example.addsubtract." + cheese);
        Intent ourIntent = new Intent(Menu.this, ourClass);
        startActivity(ourIntent);

    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    }
  }
}

//this is header.xml

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/header__root"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:background="@color/black"
android:orientation="vertical" >

<TextView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@color/darkblue"
    android:gravity="center"
    android:padding="10dp"
    android:text="Messages"
    android:textSize="20dp" >
</TextView>

</LinearLayout>

//this is text_layout.xml

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="vertical" >

<ListView
    android:id="@+id/android:list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:scrollbars="none" >
</ListView>

<TextView
    android:id="@+id/android:empty"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Nothing to Display" >
</TextView>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-20T02:12:34.860

位置（由 给出`onListItemClick`）与 ListView 中的项目数（包括页眉（和页脚））相关，而不与适配器相关。

代替：

```
String cheese = (String) getListAdapter().getItem(position); 
```

采用：

```
String cheese = (String) l.getItemAtPosition(position); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T02:06:57.693

尝试使用这个

```
mLV_list.setOnItemClickListener(this); 
```

和

```
public void onItemClick(AdapterView<?> arg0, View arg1, int arg2, long arg3) {

    String element = (String)getListAdapter().getItem(arg2);
    Toast.makeText(this, element+" clicked ", Toast.LENGTH_SHORT).show();
} 
```

# asp.net - 如何为实体框架 DBContext 显式指定连接字符串

> ID：12031435
> 
> 赞同：2
> 
> 时间：2012-08-20T01:46:13.423
> 
> 标签：asp.net, asp.net-mvc, entity-framework

默认情况下， My`BaseDBContext.cs`使用`BaseDBContext`key in `connectionstrings`。

如何明确设置要使用的密钥？即，如果我想用它来`DefaultConnection`代替？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T02:00:28.350

使用[这个](http://msdn.microsoft.com/en-us/library/gg679467%28v=vs.103%29.aspx)`DbContext`类的构造函数

```
public class BaseDBContext : DbContext
{
    public BaseDBContext()
        : base("DefaultConnection")
    {
    }
} 
```

# objective-c - 单元测试 UITextField 上的操作

> ID：12031442
> 
> 赞同：3
> 
> 时间：2012-08-20T01:47:34.407
> 
> 标签：objective-c, cocoa-touch, ocunit, ocmock

我有一个简单的 if 条件，当满足时，添加一个目标以在点击“完成”时放下键盘

```
- (void)addDoneWhenTrue:(UITextField *)input
{
    if (YES)
    {
        [input addTarget:self action:@selector(textFieldFinished:) forControlEvents:UIControlEventEditingDidEndOnExit];
    }
}

- (IBAction)textFieldFinished:(id)sender
{
    [sender resignFirstResponder];
} 
```

我在 iOS5 上使用 OCMock 和 OCUnit。如何创建一个单元测试，允许我传递一个简单的`UITextField`输入并模拟点击它上的完成按钮以验证`resignFirstResponder`是否发生（或不发生）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T04:43:16.333

您不需要嘲笑它，这种目标/行动方法感觉就像是一种真正迂回的方式来获得您想要的东西。只要您的控制器是`UITextField`的委托，`textFieldShouldReturn:`就会在点击 Return（或在本例中为 Done）键时触发。

```
#pragma mark - UITextFieldDelegate

-(void)textFieldShouldReturn:(UITextField *)textField {
    if (someConditionThatDeterminesWhetherKeyboardShouldCollapse) {
        [textField resignFirstResponder];
    }
} 
```

`textFieldShouldReturn:`然后，您可以在满足和不满足条件时测试对控制器的调用。如果需要，您还可以通过调用确保您的视图已加载到测试用例中`loadView`，然后断言文本字段的委托是您的控制器，这将确保视图正确连接。

```
-(void)testDoneShouldCollapseKeyboard {
    [controller loadView];
    expect(controller.textField.delegate).to.beIdenticalTo(controller);

    id mockTextField = [OCMockObject partialMockForObject:controller.textField];
    [[mockTextField expect] resignFirstResponder];
    controller.someConditionThatDeterminesWhetherKeyboardShouldCollapse = YES;

    [controller textFieldShouldReturn:controller.textField];

    [mockTextField verify];

    [[mockTextField reject] resignFirstResponder];
    controller.someConditionThatDeterminesWhetherKeyboardShouldCollapse = NO;

    [controller textFieldShouldReturn:controller.textField];

    [mockTextField verify];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T09:05:42.410

当然，您不需要模拟单击按钮，因为这就是`UIKit`您所关心的。您担心当`textFieldFinished:`调用该方法时会发生正确的事情

**免责声明**

我已经`OCMock`很长时间没有使用了，所以这是一个仅使用文档的示例，因此它很容易有点不正确-希望有人可以纠正`OCMock`所有设置的人。

```
id mock = [OCMockObject mockForClass:[UITextField class]];

[[mock expect] resignFirstResponder];

[sut textFieldFinished:mock]; // sut = system under test - taken from your screen cast ;)

[mock verify]; 
```

# python - 如何使用 python 正则表达式查找特定字符串

> ID：12031451
> 
> 赞同：-1
> 
> 时间：2012-08-20T01:49:04.037
> 
> 标签：python, html, regex

我有这个 HTML：

```
<li class="news_list_bo"><a href="/news_view.php?article_id=2752">URLHunter 프로그램 버퍼오버플로우 취약점 발견!</a>
<ul class="new_liview">
    <li class="img"><a href="/news_view.php?article_id=2752"><img height="45" width="65" src="/image_article/458226972502b655fa1b7b.jpg" /></a></li>                         
    <li class="text"><a href="/news_view.php?article_id=2752">웹페이지를 구성하는 그림파일, 플래쉬파일, 미디어파일들과 같은 구성요소를 사용자에게 보여주는 URLHunter 프로그램에서 버퍼오...</a></li>
</ul> 
```

我正在尝试检索`a`标签中的文本，如下所示：

```
>>> tmp_title = re.findall(r'<a href="/news_view.php?article_id=[0-9]+">(.*?)</a>',tmp_str,re.I|re.DOTALL)' 
```

但是，它什么也没找到：

```
>>> print tmp_title
[] 
```

我怎样才能找到和之间的`<li class="text"><a href="/news_view.php?article_id=2752">`文字`</a></li>`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T02:04:15.403

我建议使用像[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)这样的 HTML 解析器来处理大部分问题，而不是试图让正则表达式来处理所有这些问题。不过，一旦 HTML 被解析，正则表达式可能有助于匹配 URL。

我们可以先构造一个正则表达式来匹配您想要的 URL。您的问题是它`?`在正则表达式中具有特殊含义。如果您需要从字面上匹配 a `?`，则需要对其进行转义。无论如何，这是一个用于匹配所需 URL 的正则表达式：

```
^/news_view\.php\?article_id=[0-9]+$ 
```

当需要查找字符串时，可以先将 HTML 解析成汤：

```
soup = bs4.BeautifulSoup(html) 
```

请参阅[文档中关于`SoupStrainers`](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#parsing-only-part-of-a-document)提高性能的部分。

然后您可以将所有`a`标签与`href`您感兴趣的标签匹配：

```
links = soup.find_all('a', href=NEWS_URL_RE) 
```

然后您可以从链接中获取所有文本：

```
link_texts = [link.get_text() for link in links] 
```

# entity-framework - 如果在维护所有关系的情况下将 EF 与 SQL Server 一起使用，我的 BO 开发人员会获得什么优势？

> ID：12031459
> 
> 赞同：0
> 
> 时间：2012-08-20T01:50:31.063
> 
> 标签：entity-framework

我是一名 DBA。我想知道我的 Business Objects 开发人员在将 EF 与 SQL Server DB 一起使用时会获得哪些优势，SQL Server DB 在需要时使用外键和 Primarkey 进行完全管理。因为这是我们的新项目，我们必须将 EF 与 SQL Server 2008 R2 一起使用。我们计划使用数据库优先方法。如果我在我的数据库中定义所有外键关系，谁能告诉我我的业务对象开发人员会遇到什么不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T01:56:30.467

假设它设置正确，当您的开发人员实际从数据库结构创建他们的对象时，他们将能够相当容易地访问任何相关的表。

它还应该使创建新对象（表中的行）变得容易，因为这样就不可能创建会破坏外键关系的新项目。

在数据库中正确设置任何外键也是一个简单的好习惯；我不确定不这样做有什么好处。

作为必须使用未正确设置的数据源的开发人员，我可以告诉您正确设置的数据库结构对于开发人员来说是一种了不起的体验。

（顺便说一句，作为一名 DBA，您可能想看看 EF。还要看看 LINQ，这是他们将使用的项目之一。特别是，[为什么 LINQ 胜过​​ SQL](http://www.linqpad.net/WhyLINQBeatsSQL.aspx)可能会帮助您获得一个基本的理解，即使你不同意文章标题:)）

# java - 将 Hashtable 中的 Hashtable 拆分为两个单独的 Hashtable

> ID：12031460
> 
> 赞同：0
> 
> 时间：2012-08-20T01:50:40.377
> 
> 标签：java, split, key, hashtable

我是 Java 新手。我一直在使用哈希表来读取具有各种键和值的不同数据。

我在一个哈希表中有一个哈希表，我想将它分成两个哈希表。

```
Hashtable<String, Hashtable<String, Double>> sData; 
```

想分成类似的东西：

```
Hashtable<String, Double> innerData;
Hashtable<String, String> outerData; 
```

我什至不确定这是可能的，因为我正在使用外部 Hashtable 并将值更改为 String，而不是另一个 Hashtable。我想我还是会问

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T01:55:24.947

```
Hashtable<String, Double> innerData;
Hashtable<String, List<String>> outerData; // or use some multimap library

for(String key:sData.keys()){ 
   List<String> outerlist = new List<String>();
   for(String key2:outerData.get(key).keys()){
       outerlist.add(key2);
       innerData.put(key2,outerData.get(key).get(key2))
   }
   outerData.put(key,outerlist)
} 
```

或者如果你想避免交叉哈希数据丢失，你需要新的类

```
Hashtable<Pair<String,String>, Double> innerData;
Hashtable<String, List<Pair<String,String>>> outerData; 
```

其中 Pair 是代表嵌套键的类。你也可以只连接字符串，但如果你想向后工作，这会更麻烦。

# facebook-graph-api - Facebook 评论框在与 Backbone.js 一起使用时消失

> ID：12031465
> 
> 赞同：1
> 
> 时间：2012-08-20T01:51:57.707
> 
> 标签：facebook-graph-api, backbone.js, facebook-javascript-sdk, facebook-comments

我正在尝试在我的 HTML 中嵌入由 Backbone.js 动态生成的 Facebook 评论框我在我的 HTML 文件中的正文之后有以下代码。

```
<script>
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=147738045314917";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
</script> 
```

然后我使用 Backbone 模板动态生成 div 标签。我嵌入了以下 html 标记。

```
<div class="fb-comments" data-href="http://something.com" data-num-posts="2" data-width="470"></div> 
```

问题是评论框由于某种原因并不总是显示。我也在这个页面中使用 Facebook SDK。

我真的不明白这一点，任何帮助都会很棒。非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T23:52:23.307

在将新`XFBML`元素添加到 DOM（或本例中的 HTML5 等效项）后，您希望调用`FB.XFBML.parse`包含元素以转换这些元素。

# php - PHP多维数组到简单数组

> ID：12031467
> 
> 赞同：3
> 
> 时间：2012-08-20T01:52:42.623
> 
> 标签：php, arrays

哪种方法是翻转多维数组的最佳实践

`Array ( [0] => Array ( [id] => 11 ) [1] => Array ( [id] => 14 ) )`

成一个简单的数组？**编辑：** “扁平化”数组（感谢 arxanas 的正确词）

`Array ( [0] => 11 [1] => 14 )`

我看到了一些例子，但除了 foreach 循环、内爆或大函数之外还有更简单的方法吗？当然必须有一个 php 函数来处理这个问题。或不..？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T01:56:42.740

```
$array = array();
$newArray = array();

foreach ( $array as $key => $val )
{
    $temp = array_values($val);
    $newArray[] = $temp[0];
} 
```

在此处查看实际操作：http: [//viper-7.com/sWfSbD](http://viper-7.com/sWfSbD)

* * *

在这里你有它的功能形式：

```
function array_flatten ( $array )
{
    $out = array();

    foreach ( $array as $key => $val )
    {
        $temp = array_values($val);
        $out[] = $temp[0];
    }

    return $out;
} 
```

在此处查看实际操作：http: [//viper-7.com/psvYNO](http://viper-7.com/psvYNO)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T01:55:17.533

如果您有一个不应该是多维数组（具有相同的键和值）并且它具有多个维度深度的多维数组，您可以使用递归来循环遍历它并将每个项目附加到一个新数组中。只要确保不要为此头疼:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T02:24:30.743

您可以使用[array_walk_recursive](http://www.php.net/manual/en/function.array-walk-recursive.php)来展平数组。

```
$ret = array(); 
array_walk_recursive($arr, function($var) use (&$ret) { 
  $ret[] = $var; 
}); 
var_dump($ret); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T10:23:23.130

这是一个例子。（它可能不像 xdazz 那样“优雅”，但它是不使用“use”闭包的替代方案。）这就是数组的开始方式：

**开始**

```
array (size=2)
  0 => 
    array (size=1)
      'woeid' => string '56413072' (length=8)
  1 => 
    array (size=1)
      'woeid' => string '56412936' (length=8) 
```

然后你可能想要这样的东西：

**目标**

```
 array (size=2)
      0 => string '56413072' (length=8)
      1 => string '56412936' (length=8) 
```

您可以使用[array_walk_recursive](http://www.php.net/manual/en/function.array-walk-recursive.php)

**代码**

```
$woeid = array();
array_walk_recursive($result['results']['Result'], function ($item, $key, $woeid) {
     if ($key == 'woeid') {                                       
           $woeid[] = $item;
     }
}, &$woeid); 
```

# mysql - 将mysql语句转换为带有索引的sql server

> ID：12031469
> 
> 赞同：1
> 
> 时间：2012-08-20T01:52:45.253
> 
> 标签：mysql, sql-server, indexing

我已经为此工作了几个小时，并且处于困境中。如果可以的话请帮助我，我将不胜感激...

我正在尝试将一系列 mysql 语句转换为 sql server 2008 express，用于小型 wordpress 数据库迁移项目。我不是 MS SQL 数据库的专家...

我已经转换了大部分语句，但在如何处理 mySQL 语句底部附近的表索引语句方面需要帮助。如何将它们转换为 SQL Server 兼容语句？：

mySQL 语句：

```
DROP TABLE IF EXISTS `wp_pollsip`;
CREATE TABLE IF NOT EXISTS `wp_pollsip` (
  `pollip_id` int(10) NOT NULL AUTO_INCREMENT,
  `pollip_qid` varchar(10) NOT NULL DEFAULT '',
  `pollip_aid` varchar(10) NOT NULL DEFAULT '',
  `pollip_ip` varchar(100) NOT NULL DEFAULT '',
  `pollip_host` varchar(200) NOT NULL DEFAULT '',
  `pollip_timestamp` varchar(20) NOT NULL DEFAULT '0000-00-00 00:00:00',
  `pollip_user` tinytext NOT NULL,
  `pollip_userid` int(10) NOT NULL DEFAULT '0',
  PRIMARY KEY (`pollip_id`),
  KEY `pollip_ip` (`pollip_id`),
  KEY `pollip_qid` (`pollip_qid`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;

-- Dumping data for table .wp_pollsip: ~5 rows (approximately)
DELETE FROM `wp_pollsip`;
/*!40000 ALTER TABLE `wp_pollsip` DISABLE KEYS */;
INSERT INTO `wp_pollsip` (`pollip_id`, `pollip_qid`, `pollip_aid`, `pollip_ip`, `pollip_host`, `pollip_timestamp`, `pollip_user`, `pollip_userid`) VALUES
(1, '1', '1', '11.11.11.11', 'isp-here', '1344836172', 'admin', 1),
(2, '2', '6', '11.11.11.11', 'isp-here', '1344836700', 'admin', 1),
(3, '3', '9', '11.11.11.11', 'isp-here', '1344963379', 'Guest', 0),
(4, '4', '12', '11.11.11.11', 'isp-here', '1345136711', 'admin', 1),
(5, '4', '14', '11.11.11.11', 'isp-here', '1345171584', 'Guest', 0);
/*!40000 ALTER TABLE `wp_pollsip` ENABLE KEYS */;
/*!40014 SET FOREIGN_KEY_CHECKS=1 */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */; 
```

MS SQL，到目前为止：

```
-- Dumping structure for table .wp_pollsip
IF OBJECT_ID('wp_pollsip','U') IS NOT NULL DROP TABLE wp_pollsip;
CREATE TABLE wp_pollsip (
  pollip_id bigint NOT NULL IDENTITY,
  pollip_qid varchar(10) NOT NULL DEFAULT '',
  pollip_aid varchar(10) NOT NULL DEFAULT '',
  pollip_ip varchar(100) NOT NULL DEFAULT '',
  pollip_host varchar(200) NOT NULL DEFAULT '',
  pollip_timestamp varchar(20) NOT NULL DEFAULT '0000-00-00 00:00:00',
  pollip_user char(256) NOT NULL,
  pollip_userid int NOT NULL DEFAULT '0',
  --PRIMARY KEY (pollip_id),
  --KEY pollip_ip (pollip_id),
  --KEY pollip_qid (pollip_qid)
);

-- Dumping data for table .wp_pollsip: ~5 rows (approximately)
DELETE FROM wp_pollsip;
/*!40000 ALTER TABLE wp_pollsip DISABLE KEYS */;
INSERT INTO wp_pollsip (pollip_qid, pollip_aid, pollip_ip, pollip_host, pollip_timestamp, pollip_user, pollip_userid) VALUES
('1', '1', '11.11.11.11', 'isp-here', '1344836172', 'admin', 1),
('2', '6', '11.11.11.11', 'isp-here', '1344836700', 'admin', 1),
('3', '9', '11.11.11.11', 'isp-here', '1344963379', 'Guest', 0),
('4', '12', '11.11.11.11', 'isp-here', '1345136711', 'admin', 1),
('4', '14', '11.11.11.11', 'isp-here', '1345171584', 'Guest', 0);
/*!40000 ALTER TABLE wp_pollsip ENABLE KEYS */; 
```

我希望这是有道理的，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:10:26.553

在 MSSQL 中，您通常显式创建索引，但主键除外：

```
IF OBJECT_ID('wp_pollsip','U') IS NOT NULL DROP TABLE wp_pollsip;

CREATE TABLE wp_pollsip (
  pollip_id bigint NOT NULL IDENTITY primary key,
  pollip_qid varchar(10) NOT NULL DEFAULT '',
  pollip_aid varchar(10) NOT NULL DEFAULT '', 
  pollip_ip varchar(100) NOT NULL DEFAULT '',
  pollip_host varchar(200) NOT NULL DEFAULT '',
  pollip_timestamp varchar(20) NOT NULL DEFAULT '0000-00-00 00:00:00',
  pollip_user char(256) NOT NULL,
  pollip_userid int NOT NULL DEFAULT '0',
);

create index idx_wp_pollsip_gid on wp_pollsip(pollip_gid); 
```

您不需要在 pollip_id 上创建索引，因为它被声明为主键。

# google-maps-api-3 - 试图消除 GMaps V3 侧边栏中的重复标记

> ID：12031471
> 
> 赞同：0
> 
> 时间：2012-08-20T01:53:09.313
> 
> 标签：google-maps-api-3, xml-parsing

我正在使用 google maps v3 API 来显示 XML 文档中的标记，并且我正在使用标记管理器来指定每个缩放级别要显示的标记数量。

这是链接：[http ://www.wrh.noaa.gov/mfr/rec/v2/index_sidebar_zoom.php](http://www.wrh.noaa.gov/mfr/rec/v2/index_sidebar_zoom.php)

这就是问题所在。似乎在加载时，脚本将每个缩放级别的所有标记一起加载，因此即使我只有约 200 个标记，我的标记数组名为“batch”，包含 507 个标记。当我在侧边栏上显示“批处理”时，它会显示一些重复的标记。

所以为了解决这个问题，我尝试使用我找到的 jquery 脚本来消除重复项。但是，当我提醒“批处理”数组的长度，然后提醒新数组的长度（应该没有重复）时，它也显示 507。

那么，关于如何消除重复标记并按字母顺序对它们进行排序以显示在侧边栏上的任何建议？

最后，当我在边栏上工作时放大时，我似乎失去了显示更多标记的功能。关于该功能发生了什么的任何想法？

谢谢你的帮助，

小号

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T04:58:00.330

MarkerManager 显示前 48 个标记 4 次，前 98 个标记显示 3 次，前 150 个标记显示两次。那是你要的吗？

```
 mgr.addMarkers(createMarker(48), 6);
  mgr.addMarkers(createMarker(98), 7);
  mgr.addMarkers(createMarker(150), 8);
  mgr.addMarkers(createMarker(211), 9); 
```

我想你想要的是这样的：

```
 mgr.addMarkers(createMarker(0,48), 6);
  mgr.addMarkers(createMarker(48,98), 7);
  mgr.addMarkers(createMarker(98,150), 8);
  mgr.addMarkers(createMarker(150,211), 9); 
```

并更改您的 createMarker 函数以获取开始和结束编号。

像[这样](http://www.geocodezip.com/wrhnoaa_gov_rec_v2__sidebar_zoomA.html)

# php - 为什么 preg_match_all() 多次创建相同的答案？

> ID：12031475
> 
> 赞同：3
> 
> 时间：2012-08-20T01:54:15.820
> 
> 标签：php, preg-match-all

以下代码从推文中提取 #hashtags 并将它们放入变量 $matches 中。

```
$tweet = "this has a #hashtag a  #badhash-tag and a #goodhash_tag";

preg_match_all("/(#\w+)/", $tweet, $matches);

var_dump( $matches ); 
```

有人可以向我解释为什么以下结果有**2 个相同的数组而不是只有 1 个**吗？

```
array(2) {
  [0]=>
  array(3) {
    [0]=>
    string(8) "#hashtag"
    [1]=>
    string(8) "#badhash"
    [2]=>
    string(13) "#goodhash_tag"
  }
  [1]=>
  array(3) {
    [0]=>
    string(8) "#hashtag"
    [1]=>
    string(8) "#badhash"
    [2]=>
    string(13) "#goodhash_tag"
  }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-20T01:58:17.150

因为你用`()`抓子组。

尝试：

```
preg_match_all("/#\w+/", $tweet, $matches); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T02:02:52.647

为什么要使用 () ，除非您希望它完全这样做。大声笑对不起，结果不是那么友好:(

[http://php.net/manual/en/function.preg-match-all.php](http://php.net/manual/en/function.preg-match-all.php)示例 3

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-10T07:15:06.723

**这很简单 ：**

`()`从你的表达中删除

希望能帮助到你。

# mysqli - 如何将 mysqli 迁移到 pdo

> ID：12031476
> 
> 赞同：0
> 
> 时间：2012-08-20T01:54:35.907
> 
> 标签：mysqli

嗨，我想知道如何迁移 mysqli php 文件以使用 PDO。任何人都可以看看我的代码，看看我是否走在正确的轨道上？

这是我的原始（mysqli）代码：

```
<?php
    // connecting to database
    $conn = new mysqli('xxxxxx', 'xxxxxx', 'password', 'xxxxxx');

    $match_email = 'email';
    $match_passhash = 'passhash';

    if (isset($_POST['email'])) {
        $clean_email = mysqli_real_escape_string($conn, $_POST['email']);
        $match_email = $clean_email;
    }

    if (isset($_POST['passhash'])) {
        $clean_passhash = mysqli_real_escape_string($conn, $_POST['passhash']);
        $match_passhash = sha1($clean_passhash);
    }

    $userquery = "SELECT email, passhash, userlevel, confirmed, blocked FROM useraccounts
                  WHERE email = '$match_email' AND passhash = '$match_passhash'
                  AND userlevel='user' AND confirmed='true' AND blocked='false';";

    $userresult = $conn->query($userquery);
    if ($userresult->num_rows == 1) {
        $_SESSION['authorisation'] = 'knownuser';
        header("Location: userhome.php");
        exit;
    } else {
        $_SESSION['authorisation'] = 'unknownuser';
        header("Location: userlogin.php");
        exit;
    }
?> 
```

这是我将其迁移到 PDO 的尝试：

```
<?php
    // connecting to database
    $dbh = new PDO("mysql:host=xxxxxx; dbname=xxxxxx", "xxxxxx", "password");

    $match_email = 'email';
    $match_passhash = 'passhash';

    if (isset($_POST['email'])) {
        $clean_email = mysqli_real_escape_string($conn, $_POST['email']);
        $match_email = $clean_email;
    }

    if (isset($_POST['passhash'])) {
        $clean_passhash = mysqli_real_escape_string($conn, $_POST['passhash']);
        $match_passhash = sha1($clean_passhash);
    }

    $userquery = "SELECT email, passhash, userlevel, confirmed, blocked FROM useraccounts
                  WHERE email = ':match_email' AND passhash = ':match_passhash' AND
                  userlevel='user' AND confirmed='true' AND blocked='false';";

    $stmt = $dbh->prepare($query);
    $stmt->bindParam(":match_email", $match_email);
$stmt->bindParam(":match_passhash", $match_passhash);
$stmt->execute();

    $userresult = $conn->query($userquery);
    if ($userresult->num_rows == 1) {
        $_SESSION['authorisation'] = 'knownuser';
        header("Location: userhome.php");
        exit;
    } else {
        $_SESSION['authorisation'] = 'unknownuser';
        header("Location: userlogin.php");
        exit;
    }
?> 
```

我也不确定如何计算 PDO 中返回的行数。

如果有人能够帮助我，那就太好了。

一百万提前谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T02:07:17.200

当使用[准备好的语句](http://www.php.net/manual/pdo.prepared-statements.php)和`$stmt->bindValue()`/或`$stmt->bindParam()`您不需要使用 转义值时`mysqli_real_escape_string()`，PDO 将为您执行此操作。

请记住为该值设置正确的数据类型。这是绑定函数中的第三个参数，默认情况下它是一个字符串，所以你的代码很好。我只会使用`bindValue()`而不是`bindParam()`因为您不需要参考。

`$stmt->execute()`将您准备好的语句作为查询运行。另一个`$conn->query()`不适用于准备好的语句。它用于原始查询，就像您以前使用 MySQLi 一样。

运行时`$stmt->execute()`，您的响应将保存在`$stmt`对象中。对于行数使用`$stmt->rowCount()`.

# algorithm - 哪种分类算法可用于文档分类？

> ID：12031477
> 
> 赞同：7
> 
> 时间：2012-08-20T01:54:40.727
> 
> 标签：algorithm, machine-learning, classification, document-classification

**嘿，这是我的问题，**

给定一组文档，我需要将每个文档分配给预定义的类别。

我打算使用 n-gram 方法来表示每个文档的文本内容，然后在我拥有的训练数据上训练一个 SVM 分类器。
如果我错过了理解的东西，请纠正我。

现在的问题是类别应该是动态的。这意味着，我的分类器应该处理具有新类别的新训练数据。

**例如，**如果我训练了一个分类器将给定文档分类为 A 类、B 类或 C 类，然后我得到了 D 类的新训练数据。我应该能够通过向分类器提供“D 类”的新训练数据。

**总而言之，我不想将旧的训练数据（具有 3 个类别）和新的训练数据（具有新的/未见过的类别）结合起来并再次训练我的分类器。我想即时训练我的分类器**

这可以用 SVM 实现吗？如果没有，你能推荐我几种分类算法吗？或任何可以帮助我的书/论文。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T06:22:01.867

[Naive-Bayes](http://en.wikipedia.org/wiki/Naive_Bayes_classifier)是相对快速的增量分类算法。
[KNN](http://en.wikipedia.org/wiki/K-nearest_neighbor_algorithm)本质上也是增量的，甚至更易于实现和理解。

这两种算法都在开源项目[Weka](http://www.cs.waikato.ac.nz/ml/weka/)中实现，作为KNN 的[NaiveBayes](http://weka.sourceforge.net/doc/weka/classifiers/bayes/NaiveBayes.html)和[IBk](http://weka.sourceforge.net/doc/weka/classifiers/lazy/IBk.html)。

然而，从个人经验来看——它们都容易受到大量非信息特征的影响（通常是文本分类的情况），因此通常使用某种特征选择来从这些算法中获得更好的性能，这可能是作为增量实施是有问题的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T02:02:50.660

Edwin Chen 的这篇博文描述了用于聚类的[无限混合模型。](http://blog.echen.me/2012/03/20/infinite-mixture-models-with-nonparametric-bayes-and-the-dirichlet-process/)我认为这种方法支持自动确定集群的数量，但我仍然试图绕开它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T05:28:31.783

符合您的标准的算法类别称为“增量算法”。几乎所有方法都有增量版本。最容易实现的是朴素贝叶斯。

# android - 4.0.4 Facebook SSO - Android 密钥哈希已更改？

> ID：12031479
> 
> 赞同：1
> 
> 时间：2012-08-20T01:55:01.127
> 
> 标签：android, android-4.0-ice-cream-sandwich, facebook-android-sdk

带有 Facebook SDK SSO 的应用程序在 2.2 中运行良好，现在将三星 Galaxy（用于测试的 II 和 III）升级到 4.0.4，现在从 FB SSO SDK 获取：

```
E/fbLogin(8286): invalid_key:Android key mismatch. Your key "<<omitted>>" does not match the allowed keys specified in your application settings. Check your application settings at http://www.facebook.com/developers 
```

所以我去更新了 fb/developers 上的密钥哈希，是的，它又可以正常工作了。

奇怪的是，它使用 2.2 AVD 和 4.0.3 AVD 中的原始值，但在两个 4.0.4 物理设备上，我都遇到了上述错误。

导致这种情况的 4.0.4 有什么不同吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T19:49:32.380

好吧，似乎没有答案。对于遇到这种情况的人，只需将错误消息中的密钥哈希复制到 fb 开发人员站点，就可以了。

# android - 将 TextView 放在屏幕上的不同位置

> ID：12031481
> 
> 赞同：0
> 
> 时间：2012-08-20T01:55:11.663
> 
> 标签：android, canvas, textview, paint

我得到了一个图像列表，当一个人点击一个项目时，它会进入一个活动并使用该图像设置一个 ImageView。

我想要做的是：在每个图像上为 TextView 设置一个位置。如果该人选择图像 A，则 TextView 位于 X 位置。如果 B，位于 Y 位置......我想在该位置的文本上绘画。

我知道如何在图像上绘制文本并将其保存在 SD 卡上，但我不知道如何为每个图像上的 textview 设置位置以及如何获取该位置并在图像上使用它。

可能吗？太复杂？我有大约 10 张图片，每张有 4 个文本视图。

我认为我可以使用 AbsoluteLayout 来做到这一点，但它已被弃用。或者我可以使用很多 TextViews 并将它们设置为 Visible/Gone，但会是很多 TextViews（更容易吗？）。

还有两个问题：1）我的 TextView 有一个自定义样式，是否可以在绘制和保存图像时使用它？

2）我如何在上面换行？当我的文字太大时，它会一直离开屏幕，我如何限制它并将其分成新行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T05:08:07.123

好吧，我能够在不同位置与其他人一起更改图像，因此我在同一位置使用 2 个 TextViews 来处理 9 个图像和 1 个其他 TextView（将前 9 个图像设置为“不可见”）来完成第 10 个图像。

现在可以了。

对不起线程家伙。

# python - 自定义排序 Python 字典

> ID：12031482
> 
> 赞同：16
> 
> 时间：2012-08-20T01:55:13.900
> 
> 标签：python

因此，当我打印它时，我有一个看起来像这样的字典：

```
{'10': -10, 'ZT21': 14, 'WX21': 12, '2': 15, '5': -3, 'UM': -25} 
```

我想以我定义的自定义方式对这些进行排序。假设我希望它（按键）排序的方式是`ZT21, 10, WX21, UM, 5, 2`.

任何人都知道如何以预定义/自定义方式整理字典？我正在做的是从数据库中获取这本字典，它可以包含 20 多个键，所有键都有特定的顺序。始终设置顺序，但有时某些键/值不会在字典中。所以这也可能发生：

```
{'ZT21': 14, 'WX21': 12, '2': 15, '5': -3, 'UM': -25} 
```

排序（按键）是`ZT21, 10, WX21, UM, 5, 2`.

所以在这个例子中 10 不存在，但我需要的排序仍然是相同的，10 将不存在。

有任何想法吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-08-20T02:45:31.520

更新了 Python 3.6+ 的答案

```
>>> d = {'10': -10, 'ZT21': 14, 'WX21': 12, '2': 15, '5': -3, 'UM': -25}
>>> keyorder = ['ZT21', '10', 'WX21', 'UM', '5', '2']
>>> {k: d[k] for k in keyorder if k in d}
{'ZT21': 14, '10': -10, 'WX21': 12, 'UM': -25, '5': -3, '2': 15} 
```

旧版答案：Python 中的字典是无序的（在 Python3.6 之前）。您可以获得所需的结果`list`

```
>>> d = {'10': -10, 'ZT21': 14, 'WX21': 12, '2': 15, '5': -3, 'UM': -25}
>>> keyorder = ['ZT21', '10', 'WX21', 'UM', '5', '2']
>>> sorted(d.items(), key=lambda i:keyorder.index(i[0]))
[('ZT21', 14), ('10', -10), ('WX21', 12), ('UM', -25), ('5', -3), ('2', 15)] 
```

或作为 OrderedDict

```
>>> from collections import OrderedDict
>>> OrderedDict(sorted(d.items(), key=lambda i:keyorder.index(i[0])))
OrderedDict([('ZT21', 14), ('10', -10), ('WX21', 12), ('UM', -25), ('5', -3), ('2', 15)]) 
```

`dict`如果你做了很多这些，使用 a作为 keyorder会更有效

```
>>> keyorder = {k:v for v,k in enumerate(['ZT21', '10', 'WX21', 'UM', '5', '2'])}
>>> OrderedDict(sorted(d.items(), key=lambda i:keyorder.get(i[0])))
OrderedDict([('ZT21', 14), ('10', -10), ('WX21', 12), ('UM', -25), ('5', -3), ('2', 15)]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-07-23T05:14:29.860

您可以使用 OrderedDict 并指定您的自定义顺序对其进行排序。

```
def customsort(dict1 , key_order):
    items = [dict1[k] if k in dict1.keys() else 0 for k in key_order] 
    sorted_dict = OrderedDict()
    for i in range(len(key_order)):
        sorted_dict[key_order[i]] = items[i]
    return sorted_dict
key_order = [ "monday" ,"tuesday" ,"wednesday" ,"thursday" ,"friday" ,"saturday"]
dict1 ={"monday" : 10 , "thursday" :12 , "wednesday" : 34}
sorted_dicti = customsort(dict1,key_order)
print(sorted_dicti) 
```

customsort() 按用户传递的 order(key_order) 对给定的字典(dict1) 进行排序。

```
items = [dict1[k] if k in dict1.keys() else 0 for k in key_order] 
```

它将检查给定的键是否在 dict1 中，如果存在则将 dict1 中指定的值放在 dict1 中，否则将值设置为 0。

```
OrderedDict([('monday', 10), ('tuesday', 0), ('wednesday', 34), ('thursday', 12), ('friday', 0), ('saturday', 0)]) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T01:57:59.947

你不能。改用 a `collections.OrderedDict`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T01:58:18.983

字典本质上是无序的，所以你不能直接对字典进行排序。您可以通过排序`someDict.items()`和传递键函数对键/值对进行排序，就像对其他任何内容进行排序一样，但您将获得排序列表而不是字典。请参阅先前有关字典排序[的问题：Python：例如对列表](https://stackoverflow.com/questions/1217251/python-sorting-a-dictionary-of-lists)进行排序和[字典排序按键长度](https://stackoverflow.com/questions/11753758/dictionary-sorting-by-key-length)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-29T20:17:07.173

我遇到了完全相同的问题，并设计了一个轻量级的通用解决方案：

```
from collections import OrderedDict

def make_custom_sort(orders):
    orders = [{k: -i for (i, k) in enumerate(reversed(order), 1)} for order in orders]
    def process(stuff):
        if isinstance(stuff, dict):
            l = [(k, process(v)) for (k, v) in stuff.items()]
            keys = set(stuff)
            for order in orders:
                if keys.issuperset(order):
                    return OrderedDict(sorted(l, key=lambda x: order.get(x[0], 0)))
            return OrderedDict(sorted(l))
        if isinstance(stuff, list):
            return [process(x) for x in stuff]
        return stuff
    return process 
```

首先，您创建一个自定义顺序排序函数的实例：

```
custom_sort = make_custom_sort([ ['ZT21', '10', 'WX21', 'UM', '5', '2'] ]) 
```

现在，实际排序：

```
result = custom_sort(my_dataset) 
```

丢失的键最终以未指定的顺序被拒绝。请注意，此闭包是递归的。如双括号所示，您可以指定嵌套在结构中的各种字典所需的排序顺序。

GitHub上的项目：[https ://github.com/laowantong/customsort](https://github.com/laowantong/customsort)

# java - 当 ThreadPoolExecutor 的所有任务完成执行那里的作业时插入数据库

> ID：12031484
> 
> 赞同：3
> 
> 时间：2012-08-20T01:55:22.473
> 
> 标签：java, multithreading, executorservice, threadpoolexecutor

**问题定义：-**

我需要在`insert some values into Database`所有任务`ExecutorService`完成后立即执行那里的工作。换句话说，我`insert into database`只能在所有任务都完成执行那里的作业时，因为我需要插入到数据库中的东西，取决于完成那里任务的所有线程。

**那么我如何检查所有任务是否`ExecutorService`已完成执行然后开始插入数据库。**

下面是我使用创建任务的代码`ThreadPoolExecutor`。

```
executorService = new ThreadPoolExecutor(
    noOfThreads, 
    noOfThreads, 
    500L, 
    TimeUnit.MILLISECONDS,
    new ArrayBlockingQueue<Runnable>(noOfThreads), 
    new ThreadPoolExecutor.CallerRunsPolicy()
);

// Running for particular duration of time
while(System.currentTimeMillis() <= endTime) {
    Command newCommand = getNextCommand();
    Task nextRunnable = new Task(newCommand, existId, newId);
    executorService.submit(nextRunnable); // Submit it for execution
}

/* 
    Previously I was inserting into database here, but it was wrong as it might be 
    possible that some threads are still in progress. And If I am inserting right here 
    into database, then some information I will be loosing for sure. So how can I check 
    whether all the tasks have finished executing and then I can insert into database.
*/      
executorService.shutdown();
if (!executorService.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS)) {
    executorService.shutdownNow();
} 
```

我将用于插入的代码如下 -

```
// Inserting into Database when all the task have finished executing, currently I
for (Entry<Integer, LinkedHashMap<Integer, String>> entry : GUID_ID_MAPPING.entrySet()) {
    pstatement = db_connection.prepareStatement(LnPConstants.UPSERT_SQL);
    pstatement.setInt(1, entry.getKey());
    pstatement.setString(2, entry.getValue().get(LnPConstants.CGUID_ID));
    pstatement.setString(3, entry.getValue().get(LnPConstants.PGUID_ID));
    pstatement.executeUpdate();
} 
```

所以我需要在所有任务完成执行后将这个 for 循环放在某个地方。

**更新：-**

所以像这样的东西-

```
executorService.shutdown();
if (!executorService.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS)) {
    executorService.shutdownNow();
}

// Now Insert into Database when all the task have finished executing
for (Entry<Integer, LinkedHashMap<Integer, String>> entry : GUID_ID_MAPPING.entrySet()) {
    pstatement = db_connection.prepareStatement(PDSLnPConstants.UPSERT_SQL);
    pstatement.setInt(1, entry.getKey());
    pstatement.setString(2, entry.getValue().get(PDSLnPConstants.CGUID_ID));
    pstatement.setString(3, entry.getValue().get(PDSLnPConstants.PGUID_ID));
    pstatement.executeUpdate();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T02:24:19.247

你基本上已经有了答案。等待`executorService.awaitTermination`返回，executor 将完成所有任务。

这会忽略可能由于错误而失败的任务。执行此操作并检查错误的另一种方法是执行以下操作，

```
 List<Future> futures = ...
 for(...) {
      futures.add(executor.submit(...));
 }

 for(Future f : futures) {
       //this will throw an exception if an exception
       //occurred executing the task, insert error handling as 
       //appropriate, perhaps calling cancel on tasks that
       //have not yet completed
       f.get();
 }
 //at this point all tasks have completed 
```

另一个要查看的类是[ExecutorCompletionService](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ExecutorCompletionService.html)。ExecutorCompletionService 允许您按照任务实际完成的顺序获取任务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T03:06:58.333

使用 ExecutorCompletionService 似乎是一个很好的用例，你考虑过吗？ [检查 ExecutorCompletionService 的 JavaDoc](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ExecutorCompletionService.html) 你可以做这样的事情

```
//wrap your threadpoolexecutor ECS
ExecutorCompletionService<Boolean> ecs=new ExecutorCompletionService<Boolean>(executorService)
// submit task to ECS
ecs.submit(nextRunnable);
int noOfTasks=0;
// Running for particular duration of time
while(System.currentTimeMillis() <= endTime) {
    Command newCommand = getNextCommand();
    Task nextRunnable = new Task(newCommand, existId, newId);
    ecs.submit(nextRunnable, Boolean.TRUE); // Submit it for execution
    noOfTasks++;
    }
//Now we can use ECS to tell us what tasks are finished
for (int i=0;i<noOfTasks;i++){
 try {    
 //This is blocking call it would block until anyone of the task submitted is completed.
   Boolean result=ecs.take.get();
 // do something if you would like to handle result, you can also design to pass some unique id       instead of Boolean so that you can keep track of what tasks are completed
     }catch(ExecutionException e){//do error handling for task failure here}
     }
  //once you are here you are sure that all tasks are completed, call your database code here, you can wrap whole segment into try catch finally and close ExecutorCompletionservie 
```

# ajax - 更改页面时的 Ajax 请求错误

> ID：12031486
> 
> 赞同：0
> 
> 时间：2012-08-20T01:55:47.697
> 
> 标签：ajax, jquery-mobile, cordova

伙计们。我有一个 juerymobile 多页，我有一个按钮`#page-index`，当单击它时，将向服务器发送一个 ajax 请求，并将页面更改为`#page-column`，它将在 PC 中运行，但是当我在 phonegap 中部署多页时，按钮click 只能运行两次，代码如下：

```
function test()
{
    $.mobile.changePage('#page_column'); 
    $.ajax({
        url: "http://192.168.168.120:8090/fcmobile/getTest",
        dataType: "json"
    }).done(function(data) { 
        alert(data.content);
    });
} 
```

我发现如果我删除`$.mobile.changePage('#page_column');`，ajax 请求可以随时运行。但是当我添加`changePage`代码时，它只能运行两次，第三次，ajax请求甚至无法发送。有人知道原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T06:18:53.153

AJAX 是异步的，所以不需要设置`async`来`false`让它工作。改用事件。

例如：

```
function test () {
    $.ajax({
        'url': "http://192.168.168.120:8090/fcmobile/getTest",
        'dataType': 'json',
        'success': function (json_data) {
            $(document).trigger('test_json_data_loaded');

            console.log(data);
        }
    });
}

$(document).on('test_json_data_loaded', function () {
    $.mobile.changePage('#page_column');
}); 
```

当您设置`async`为 时`false`，您基本上是在这样做，以便每次发出此 AJAX 请求时，用户都必须等到所有数据完全加载后，应用程序/网站才能执行/执行其他任何操作……不好.

# c# - C++/CLI .Net 远程登录库

> ID：12031488
> 
> 赞同：2
> 
> 时间：2012-08-20T01:56:05.610
> 
> 标签：c#, .net, c++-cli, telnet

我正在寻找制作 Mud 作为学习编程和享受它的一种方式。其中一部分显然是通过泥浆用来连接的各种客户端来建立服务器客户端连接。这对那些不知道的人使用 Telnet。我本来打算自己学习做这件事，但我父亲是一名专业程序员，他说学习并没有什么大不了的，使用库可以让我更快地完成它。

所以我的问题是，首先在这里使用库是一个更好的选择，是否有一个很好的免费库，我可以使用它使用 C++/CLI .Net（首选）或 C# .Net（被告知这个更快，但不太精确，所以我更愿意学习 C++ 的精度，有人告诉我学习 C++ 基本上就是学习 C#）？

如果使用图书馆不是最佳选择，是否有任何好的网站或书籍可以找到关于如何从头开始制作的简单描述？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T02:09:29.460

大多数网络库将与 C 及其任何变体一起使用。

C# 将允许您（相对）快速轻松地实现某些东西，但使您免受因使用不太“**安全**”的语言而引起的编程问题。

. **Net**实际上是一个库，它同时提供了 C++ 和 C# 接口。

使用库绝对是最好的选择，因为除非您想在各个方面都降到硬件级别，否则它是必需的。例如，函数 printf() 来自 C/POSIX 库，它实际上填充了字符设备上的缓冲区，然后通过串行接口将其推送到真实终端，或者更可能是虚拟终端，然后推送到您的绘图库。无论您是否知道，每次使用#import 或#include 时，您都在将接口链接到库。对于这些简单的库，编译器已经知道它们在哪里，所以你不必告诉它它们。

简而言之，C# 将让您以抽象和蓬松的方式做事，这可能会在一开始就软化您的学习，但最终会阻止您理解幕后发生的事情（对于许多人来说这没关系）。C++ 会让你的生活变得更加困难，它的编译器可能会给出更多神秘的错误，它不会试图保护你免受自己的伤害，但你可能会学到更多。.Net 只是您父亲建议您使用的库，因为它提供了很多功能，而没有大量依赖项。

# php - 在 PHPUnit 中重用数据集

> ID：12031500
> 
> 赞同：1
> 
> 时间：2012-08-20T01:58:44.500
> 
> 标签：php, unit-testing, zend-framework, phpunit

我有一个具有属性 1、属性 2 和属性 3 的用户对象。我有一个单独的函数来编辑每个属性。因此，我需要测试每个编辑属性功能。因此，我将为成功的属性编辑测试创建 3 个不同的预期数据集。但是，如果我最终添加了第四个属性怎么办？这不会迫使我现在将此属性/值添加到所有其他数据集中吗？我应该只创建 1 个模板数据集文件，然后从文件中提取数据并使用 php 数组数据集吗？这样，如果我添加一个新属性，我就不必修改所有以前的数据集了？

具体例子：

假设我想测试我的编辑电子邮件功能是否正常工作，并且只更改电子邮件。我的设置夹具是：

设置-fixture.xml：

```
<dataset>
    <table name="users">
        <column>id</column>
        <column>email</column>
        <column>password</column>
        <row>
            <value>1</value>
            <value>user1@email.com</value>
            <value>password</value>
        </row>
    </table>
</dataset> 
```

我预期的数据集将是：

编辑电子邮件预期数据集.xml：

```
<dataset>
    <table name="users">
        <column>id</column>
        <column>email</column>
        <column>password</column>
        <row>
            <value>1</value>
            <value>user1-changed-his-email@email.com</value>
            <value>password</value>
        </row>
    </table>
</dataset> 
```

但是，如果我稍后向此用户对象添加另一个名为“notes”的属性，我的设置夹具现在将是：new-setup-fixture.xml：

```
<dataset>
    <table name="users">
        <column>id</column>
        <column>email</column>
        <column>password</column>
        <column>notes</column>
        <row>
            <value>1</value>
            <value>user1@email.com</value>
            <value>password</value>
            <value>notes</value>
        </row>
    </table>
</dataset> 
```

因此，我还必须在编辑电子邮件功能测试中修改我预期的数据集文件，以包含这个新的“notes”属性。

编辑电子邮件预期数据集.xml：

```
<dataset>
    <table name="users">
        <column>id</column>
        <column>email</column>
        <column>password</column>
        <column>notes</column>
        <row>
            <value>1</value>
            <value>user1-changed-his-email@email.com</value>
            <value>password</value>
            <value>notes</value>
        </row>
    </table>
</dataset> 
```

我的问题是，如何避免每次添加额外字段时都必须编辑所有预期的数据集？

# memory-management - 清除和释放内存

> ID：12031502
> 
> 赞同：0
> 
> 时间：2012-08-20T01:59:01.563
> 
> 标签：memory-management, memory-leaks, c#-2.0

我正在使用 C# .Net 开发一个 Windows 应用程序。这实际上是一个安装在 DBMS 中的插件。这个插件的目的是读取 DBMS 中的所有记录（记录是一个对象），匹配提供的条件并将它们作为 XML 文件传输到我的本地文件系统。我的问题与内存的使用有关。一切正常。但是，每次我读取一条记录时，它都会占用内存，并且在一定限制后，由于内存不足，插件停止工作。

我正在处理大约 10k-20k 的记录（对象）。C# 中是否有任何与内存相关的方法可以在将每条记录写入 XML 文件后立即清除它们的内存。我尝试了所有基本的内存处理方法，如 clear()、flush()、gc() 和 finalize()/ 但没有用。

请考虑他：

*   Record 是一个对象，我无法更改它并使用其他有效的数据结构。
*   每次我读取记录时，我都会将它们写入 XML。并一次又一次地重复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T02:06:09.443

C# 是一种垃圾收集语言。因此，要回收对象使用的内存，您需要确保删除对该对象的所有引用，以使其符合收集条件。具体来说，这意味着您应该在完成对它们的任何操作后，从任何持有对它们的引用的数据结构中删除这些对象。

如果您更具体地了解您使用的数据结构类型，我们可能会给出更具体的答案。

# jquery - jquery更改同一表行中标签的更改事件的值

> ID：12031503
> 
> 赞同：2
> 
> 时间：2012-08-20T01:59:25.793
> 
> 标签：jquery, html

我有一张像这样的桌子：

```
<table>
  <tbody>
    <tr>
      <td>
        <input type="text" class="identifier" />
      </td>
      <td class="name">
        Some value
        <input type="hidden" value="Some value" class="hiddenName" />
      </td>
    </tr>

    <tr>
      <td>
        <input type="text" class="identifier" />
      </td>
      <td class="name">
        Some value 2 
        <input type="hidden" value="Some value 2" class="hiddenName" />
      </td>
    </tr>
  </tbody>
</table> 
```

我想要做的是，当具有类标识符的输入的值发生更改时，我想将同一行中类“名称”列中的文本设置为“设置值”，并且隐藏名称值也为改为“设定值”

因此，例如，如果更改了带有类标识符的第二行输入，我希望将标记更改为：

```
<table>
  <tbody>
    <tr>
      <td>
        <input type="text" class="identifier" />
      </td>
      <td class="name">
        Some value
        <input type="hidden value="Some value" class="hiddenName" />
      </td>
    </tr>

    <tr>
      <td>
        <input type="text" class="identifier" />
      </td>
      <td class="name">
        Set value 
        <input type="hidden value="Set value" class="hiddenName" />
      </td>
    </tr>
  </tbody>
</table> 
```

所以我想出的jquery是：

```
$('.identifier').change(function () {

    var row = $(this).parent("tr");
    row.find('.hiddenName').val("Set value");
     row.find('.name').text("Set value");
}); 
```

然而，这根本不起作用。

有谁知道我做错了什么以及如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T02:02:19.263

```
$('.identifier').change(function () {
  var $td = $(this).parent().next(".name");
  $td.text("SetValue");
  $td.find(".hiddenName").val("SetValue");
}); 
```

[小提琴](http://jsfiddle.net/dqvHf/1)。

**编辑**：在您的最后一次更新中，问题是`parent`仅在 DOM 树上向上移动一个级别，并且从`input`to`td`到 to`tr`有两个级别。改用`closest`@undefined 提出的建议，它会继续前进，直到找到匹配项，它应该可以工作，尽管上面的方法更快：

```
$('.identifier').change(function () {
    var row = $(this).closest("tr");
    row.find('.hiddenName').val("Set value");
    row.find('.name').text("Set value");
}); 
```

[小提琴](http://jsfiddle.net/dqvHf/2/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T02:03:15.033

您可以使用该`closest()`方法代替`parent`，还请注意您的代码中存在语法错误：

```
$('.identifier').change(function () {
   var row = $(this).closest("tr");
   row.find('.hiddenName').val("Set value");
   row.find('.name').text("Set value");
   // }  this bracket should be removed
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T02:08:20.700

你可以试试这个：**工作演示** [http://jsfiddle.net/f6WKF/](http://jsfiddle.net/f6WKF/)

```
var row = $(this).parent().parent("tr"); 
```

*并且引号*也有*语法错误*，

 *希望能满足你的需要！`:)`

**代码**

```
$('.identifier').keyup(function() {
    var row = $(this).parent().parent("tr");
    row.find('.hiddenName').val("Set value");
    row.find('.name').text("Set value");
});​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T02:22:34.700

您也可以尝试使用`parents()`代替`parent()`：

```
​$('.identifier').change(function () {   
        var row = $(this).parents("tr");
        row.find('.name').text("Set value");
        row.find('.hiddenName').val("Set value");
 }) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-20T02:26:20.427

您收到错误是因为您的代码中缺少双引号..

类型="隐藏值="

也许这就是问题所在？*

# objective-c - 如何根据主视图更改详细视图

> ID：12031504
> 
> 赞同：0
> 
> 时间：2012-08-20T01:59:28.683
> 
> 标签：objective-c, uisplitviewcontroller, ipad

我正在自学 iOS，目前正专注于在 iPad 上实现我的应用程序。我被一个特定的场景困住了，我可以用很长的路来解决它，但想和更有知识的人一起检查一下，看看是否有其他方法可以解决这个问题。

在 iPad 上使用 splitViewController。

主视图控制器是一个选项卡视图控制器。

tab1 显示一个表格，tab2 显示一个图像列表。

如果主视图在 tab1 上，则根据表中选择的行，在详细视图中显示另一个表。根据在详细视图的表格中选择的行，使用 segue 在详细视图中显示图像视图。

如果主视图在 tab2 上，则图像视图直接显示在详细视图中。

一切正常，除了以下情况：

假设主视图当前显示 tab1，用户选择表中的一行，相应的表显示在详细视图中。用户现在在主视图中选择 tab2。我需要在详细视图中显示一个图像视图（它当前正在显示一个表格），但是 pushViewController 变得非常混乱，我想知道是否还有其他可以更清洁的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T19:12:29.043

您需要在主视图中的 Tab1 和 Tab2 之间导航。在详细视图中单独实现图像查看。对我来说，将 tab1 放在主视图中，将 tab2 放在详细视图中并从选项卡 2 导航到图像视图，这听起来不正确。

# jquery - Rails 和 jQuery：访问图像

> ID：12031506
> 
> 赞同：0
> 
> 时间：2012-08-20T01:59:36.403
> 
> 标签：jquery, ruby-on-rails

我正在尝试使用 jQuery 访问上传到我的 Rails 应用程序的图像，即切换图像等。jQuery 非常简单：

```
$('#a1').change(function() {
  var src = $(this).val();
  $('#t1').html(src ? "<img src='../../images/000/000/"+src+".jpg' />":"");
}); 
```

尝试将 Rails 资产调用与 jQuery 一起使用时，我完全陷入困境。我可以在页面的其他地方调用所需的图像，因此：

```
@a.image.url(:thumb) 
```

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:03:04.347

如果您的图像是由用户上传的，那么它们就不是资产管道意义上的“资产”。您不能使用资产助手为他们服务。继续使用`/images/000/000/etc`以访问它们。

资产是驻留在`app/assets`. 它们不能是动态上传的内容，因为整个目的是为了生产而预编译它们。如果文件在您运行时的“编译”时不可用`rake assets:precompile`，则它不是资产管道的良好候选者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T05:01:31.683

我将自己回答这个问题，以防它对某人有所帮助。我没有使用 jQuery 直接访问图像，而是在 Rails 中为它们分配了 ID，因此：

```
<% @articles_by_page.each do |m| %>
<%= image_tag(m.image.url(:large), :id => 'article1_thumb'+m.issue_id.to_s) %>
<% end %> 
```

随后在 jQuery 中处理了它们的可见性：

```
$('#doc_article1').change(function() {
    var src = $(this).val();
    $('#thumbs1 a').css('display', 'none');
    $('#article1_thumb'+src).css('display', 'block');
}); 
```

可能会帮助某人。

# javascript - MongoDB按嵌套对象值排序

> ID：12031507
> 
> 赞同：25
> 
> 时间：2012-08-20T01:59:58.837
> 
> 标签：javascript, mongodb, node-mongodb-native

我正在尝试根据嵌套对象的值对结果进行排序。使用`node-mongodb-native`，我正在这样做：

```
 this.collection.find({
          "_id": ObjectID(item_id) }, 
        { "items": 1 },
        { sort : { items.date : 1 }
    }, function(err, result) {
        if (err) {
            callback(err);
        } else {
            callback(null, result);
        }
    }); 
```

我收到一个意外的令牌错误`items.date`。

`items`是一个对象数组。有些文档是一个空数组，有些文档包含数据，其中包含一个`date`字段。

谢谢！

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-08-20T02:16:49.380

使用点表示法时，您需要将键值放在引号中，因此您的`sort`对象应如下所示：

```
sort: {
    "items.date" : 1
} 
```

`date`这将按每个文档`items`数组中的最小值升序排序

# ios - 如何在我的应用加载之前从 NSUserDefault 检索值...？

> ID：12031510
> 
> 赞同：0
> 
> 时间：2012-08-20T02:00:40.050
> 
> 标签：ios, cocoa-touch, ios5, nsuserdefaults

我有一个 ViewController，点击一个按钮，标签就会更新。我想要的是，每次打开应用程序时，它都应该保留其旧值。我能够在 NSUserDefault 中写入每个值，但在加载应用程序之前无法在标签上写入值。
示例：
在第一次运行中，标签的值为 5。在第二次运行中，标签应包含相同的值 5，如果我进行了任何更改，则第三次运行时应该存在更改。
谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T02:07:50.140

在您的 AppDelegate 中，启动应用程序后调用的第一个方法是，

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Override point for customization after application launch.
    return YES;
} 
```

对于其他情况，例如您的应用程序使用从非活动状态变为活动状态，

```
- (void)applicationDidBecomeActive:(UIApplication *)application
{
    // Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface.
} 
```

我推荐阅读，[Apple 的 iOS 应用程序生命周期文档](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T02:14:24.390

以下是在 ViewController 加载时如何从标签中检索存储的值`NSUserDefaults`并设置该值的方法：

```
- (void)viewDidLoad
{
    [super viewDidLoad];    
    self.myLabel.text = [[NSUserDefaults standardUserDefaults] objectForKey:@"mySavedValue"];
} 
```

我假设您的按钮已经连接到类似这样的操作，单击时会将值保存到标准用户默认值：

```
- (IBAction)buttonPressed:(id)sender
{
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults setObject:self.myLabel.text forKey:@"mySavedValue"];
    [defaults synchronize];
} 
```

# android-layout - 如何在 Android 的页面加载时使响应式页面适合纵向模式

> ID：12031512
> 
> 赞同：0
> 
> 时间：2012-08-20T02:00:43.780
> 
> 标签：android-layout, responsive-design, landscape-portrait

我正在尝试在 android 平板电脑上为纵向模式进行响应式设计。我得到的问题是它不适合纵向模式的页面。它加载更大尺寸的宽度，然后当我切换到横向时，它会正确适配。然后，当我切换回纵向时，我会得到一个适合页面的缩小版本。这是我的意思[http://playground.fameordie.com](http://playground.fameordie.com)的基本示例。如何使此页面加载以适应纵向模式，保持实际页面的外观？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T02:45:13.153

您需要将以下内容添加到

```
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"> 
```

如果您希望用户能够双击缩放（推荐）然后省略最大比例项目

```
<meta name="viewport" content="width=device-width, initial-scale=1"> 
```

# python - 对一个列表进行操作也会改变另一个列表

> ID：12031516
> 
> 赞同：0
> 
> 时间：2012-08-20T02:01:38.147
> 
> 标签：python, python-2.7

几个月前，我用一种效率极低的算法解决了 Project Euler 的问题 67。今天，我意识到如何才能做得更好，在尝试制作更高效的算法时，我遇到了一些问题。

代码是这样的：

```
r_prev = [59,0,0]
r_load = [73,41,0]
r = [0,0,0]
zero_r = [0,0,0]
rows = 3
while rows != 0:
    position = 0
    for x in r_load:
        try:
            if r_prev[position] > r_prev[position-1]:
                r[position] = r_prev[position] + r_load[position]
            else:
                r[position] = r_prev[position-1] + r_load[position]
        except IndexError:
            r[position] = r_prev[position] + r_load[position]
        position += 1
    print r
    rows -= 1
    r_load = input("Enter next row")
    r_prev = r
    r_prev.append(0)
    zero_r.append(0)
    r = zero_r 
```

它的工作原理是只保留到达某一点的最高路径的总和。此时我正在手动输入它（通过控制台）。当输入第一行时，它按预期执行，但是当输入第二行时，它认为`r_prev`and`r`是同一件事，并且执行的每个操作`r_prev`也会执行 on `r`。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T02:02:51.230

当你这样做时，`r_prev = r`你不是在复制列表。您为同一个列表提供了一个额外的名称。要制作副本，请执行`r_prev = list(r)`.

# wxpython - wxPython：如何从 wx.StaticText 获取 sizer？

> ID：12031522
> 
> 赞同：2
> 
> 时间：2012-08-20T02:02:43.270
> 
> 标签：wxpython, sizer

该小部件是我制作的众多尺寸器之一，但如何获取这些小部件之一的尺寸器，例如在`wx.StaticText`. 首先，我虽然 wx.StaticText 有一个方法`GetSizer()`，因为它派生自`wx.Window`，但它总是返回`None`，有没有办法？

对不起我语言不好。

**编辑 (08/23/2012)** Mike Driscoll 的解决方案：

用于从一些 sizer 中获取，然后用于`self.sizer.GetChildren()`从列表中获取实际的小部件`SizerItemList``GetWindow()`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T14:20:29.747

如果 sizer 有子项，则 GetChildren 会返回一个小部件列表。我已经用 wxPython 2.8 做过很多次了。我不记得有人提到它在 2.9 或 Phoenix 中有所不同，所以我猜它不是。您能告诉我们您使用的是哪个操作系统和 wxPython 版本吗？

如果您想知道如何获取任意大小，您可以尝试 GetContainingSizer 或使用[小部件检查工具](http://wiki.wxpython.org/Widget%20Inspection%20Tool)

编辑（08/22/2012）：这是一个工作示例：

```
import wx

########################################################################
class MyApp(wx.Frame):
    """"""

    #----------------------------------------------------------------------
    def __init__(self):
        """Constructor"""
        wx.Frame.__init__(self, None, title="Example")
        panel = wx.Panel(self)

        lbl = wx.StaticText(panel, label="I'm a label!")
        txt = wx.TextCtrl(panel, value="blah blah")
        btn = wx.Button(panel, label="Clear")
        btn.Bind(wx.EVT_BUTTON, self.onClear)

        self.sizer = wx.BoxSizer(wx.VERTICAL)
        self.sizer.Add(lbl, 0, wx.ALL, 5)
        self.sizer.Add(txt, 0, wx.ALL, 5)
        self.sizer.Add(btn, 0, wx.ALL, 5)

        panel.SetSizer(self.sizer)

    #----------------------------------------------------------------------
    def onClear(self, event):
        """"""
        children = self.sizer.GetChildren()

        for child in children:
            widget = child.GetWindow()
            print widget
            if isinstance(widget, wx.TextCtrl):
                widget.Clear()

if __name__ == "__main__":
    app = wx.App(False)
    frame = MyApp()
    frame.Show()
    app.MainLoop() 
```

# javascript - 是否可以避免使用 SoundManager2 和 SoundCloud JavaScript SDK 将歌曲下载到提供的位置？

> ID：12031527
> 
> 赞同：2
> 
> 时间：2012-08-20T02:02:59.227
> 
> 标签：javascript, soundcloud, soundmanager2

我在一个站点上使用[SoundManager2 JavaScript SDK](http://www.schillmania.com/projects/soundmanager2/doc/)，该站点将同步音频从[SoundCloud](http://soundcloud.com)同时流式传输到多个客户端。当新用户加载页面时，会加载音频，并设置一个位置参数来指定应该从哪里开始播放。

当轨道真的很长（比如 60 分钟）并且当前轨道位置离轨道很远（例如 30 分钟）时，就会出现问题。在这种情况下，播放开始之前需要很长时间，因为轨道必须下载/缓冲到当前位置。有没有办法避免下载我不需要的 30 分钟音频？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:40:08.433

可悲的是没有。我们正在为当前的渐进式下载系统寻找一些替代方案，并希望在几个月内可以公开提供一些东西。

# jquery - 向 CSS 菜单添加延迟（仍然支持非 js 浏览器）

> ID：12031530
> 
> 赞同：1
> 
> 时间：2012-08-20T02:03:15.987
> 
> 标签：jquery, html, css

我有一个三级菜单，适用于 :hover 并且仅使用 css。现在我需要为悬停添加一点延迟（因此将我的 css :hover 更改为 .hover 类并使用 jQuery）。问题是，如果浏览器关闭了 javascript，菜单还会起作用吗？我可以让两个“系统”同时工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T02:10:24.633

`no-js`在`<html>`标签上添加一个类：

```
<html class="no-js"> 
```

然后从 JavaScript 中删除该类：

```
$('html').removeClass('no-js'); 
```

而在 CSS 中，你的目标是禁用 JS 的浏览器，如下所示：

```
.menu.hover { color: red; } // .hover class
.no-js .menu:hover { color: red; } // pseudo :hover JS disabled 
```

# python - pandas read_table() 函数的文本处理可能存在不一致

> ID：12031532
> 
> 赞同：0
> 
> 时间：2012-08-20T02:04:05.690
> 
> 标签：python, pandas

在[上一篇文章](https://stackoverflow.com/questions/12021730/can-pandas-handle-variable-length-whitespace-as-column-delimeters)中，我发现`read_table()`如果使用`read_table('datafile', sep=r'\s*')`构造函数，pandas 函数可以将可变长度的空格作为分隔符处理。虽然这对我的许多文件都非常有用，但尽管非常相似，但它不适用于其他文件。

编辑：我发布了其他尝试时无法复制问题的示例。因此，我发布了[指向 AY907538](https://dl.dropbox.com/u/1803062/AY907538.hmmdomtblout)和[AY942707](https://dl.dropbox.com/u/1803062/AY942707.hmmdomtblout)的原始文件的链接，并留下了我无法解决的错误消息。

```
## filename:AY942707
# this will load with no problem
data = read_table('AY942707.hmmdomtblout', header=None, skiprows=3, sep=r'\s*')

## filename: AY907538
data = read_table('AY907538.hmmdomtblout', header=None, skiprows=3, sep=r'\s*') 
```

这将产生以下错误：

```
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-7-131d10d1fb1d> in <module>()
      2 
      3 #temp = get_dataset('AY907538.hmmdomtblout')
----> 4 data = read_table('AY907538.hmmdomtblout', header=None, skiprows=3, sep=r'\s*')
      5 #data = read_table('AY942707.hmmdomtblout', header=None, skiprows=3, sep=r'\s*')

/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/io/parsers.pyc in read_table(filepath_or_buffer, sep, dialect, header, index_col, names, skiprows, na_values, thousands, comment, parse_dates, keep_date_col, dayfirst, date_parser, nrows, iterator, chunksize, skip_footer, converters, verbose, delimiter, encoding, squeeze)
    282     kwds['encoding'] = None
    283 
--> 284     return _read(TextParser, filepath_or_buffer, kwds)
    285 
    286 @Appender(_read_fwf_doc)

/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/io/parsers.pyc in _read(cls, filepath_or_buffer, kwds)
    189         return parser
    190 
--> 191     return parser.get_chunk()
    192 
    193 @Appender(_read_csv_doc)

/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/io/parsers.pyc in get_chunk(self, rows)
    779             msg = ('Expecting %d columns, got %d in row %d' %
    780                    (col_len, zip_len, row_num))
--> 781             raise ValueError(msg)
    782 
    783         data = dict((k, v) for k, v in izip(self.columns, zipped_content))

ValueError: Expecting 26 columns, got 28 in row 6 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T07:55:49.290

两个文件中的最后一个字段`description of target`包含多个单词。由于空格用作分隔符，`description of target`因此 read_table 不会将其视为单个列。此字段中的每个单词都在不同的列中。在`AY942707`第一`description of target`行中比在所有其他行中包含更多的单词，在 AY907538 中不是这种情况。`read_table`确定第一行的列数，所有后续行的列数应相等或更少。

# javascript - javascript：对具有对象的对象进行排序并读取它们

> ID：12031536
> 
> 赞同：-3
> 
> 时间：2012-08-20T02:05:29.847
> 
> 标签：javascript

此代码如何读取以读取对象，能够读取其中的对象：

```
var book = {
    "main title": "Javascript",
    "sub-title": "Def Guide",
    "for": "all audiences",
    author: {
        firstname: "David",
        surname: "Fatagans"
    }
};

for (propName in book){
    console.log("key: " + propName + " value: " + book[propName]);
    if (typeof book[propName] === "object"){
        for (innerObject in book[propName]){
            console.log("key: " + innerObject + "value: " + book[propName][innerObject])
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T03:03:47.253

一种方法是将代码放入函数中并递归调用它，例如：

```
function printObject(obj) {
  for (var propName in obj) {
    console.log("key: " + propName + " value: " + obj[propName]);

    if (typeof obj[propName] == "object") {
        printObject(obj);
    }
  }
} 
```

上面还将显示对象`[[Prototype]]`链上的可枚举属性。要忽略这些，请使用*hasOwnProperty*测试：

```
 if (obj.hasOwnProperty(propName)) {
    // propName is not inherited
  } 
```

将宿主对象（例如 DOM 元素）传递给函数时要小心，需要对这些对象采取额外的预防措施。

# c# - C# winform CheckListBox 添加分隔符

> ID：12031537
> 
> 赞同：2
> 
> 时间：2012-08-20T02:05:34.307
> 
> 标签：c#, winforms, checklistbox

我有一个关于 WinForms 的 CheckListBox 控件的问题。我想在 List 中添加一个分隔栏，这意味着我不想在此行中显示复选框。那么，这个问题有解决方案吗？

我知道 ListBox 可以在其中添加分隔符，但我还没有找到如何使用 CheckListBox 执行此操作。

谢谢！

# ruby-on-rails - 我的belongs_to，has_one 关系似乎有些问题

> ID：12031538
> 
> 赞同：0
> 
> 时间：2012-08-20T02:05:47.463
> 
> 标签：ruby-on-rails, model

我有一个看起来像这样的数据模型：

A`customer`有`subscription_id`和`setup_id`作为参数。在某些情况下，`customer`只会有一个参数。在其他情况下，它将两者兼有。

目前，如果我通过订阅流程或设置流程创建新客户，`Subscription.last`或者`Setup.last`将反映最近创建的客户（与创建`customer_id`的最后一个客户相同）

但是，我在所有情况下都遇到了问题`Customer.setup_id`或`Custumer.subscription_id`为零。

这是我的代码`subscription.rb`和`setup.rb`：

```
class Subscription < ActiveRecord::Base
  attr_accessible :status, :customer_id
  belongs_to :customer
end

class Setup < ActiveRecord::Base
  attr_accessible :status, :customer_id
  belongs_to :customer
end 
```

并在`customer.rb`：

```
class Customer < ActiveRecord::Base
  attr_accessible :email, :name, :stripe_token, :subscription_id, :setup_id, :phone, :plan
  has_one :subscription
  has_one :setup
end 
```

我不确定我在这里做错了什么，但如果这三个数据模型可以正确地相互通信，我会很高兴的。

**编辑**：两者都`setup`属于`subscription`而`:user`不是不`:customer`好吗？

**编辑 2**：更新 setup.rb 和 subscriptions.rb 的代码以正确反映当前的数据模型。并且`customer.rb`仍然无法识别正确的`setup_id`或`subscription_id`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T12:17:33.230

```
class Subscription < ActiveRecord::Base
  attr_accessible :status, :customer_id
  belongs_to :customer
end

class Setup < ActiveRecord::Base
  attr_accessible :status, :customer_id
  belongs_to :customer
end

class Customer < ActiveRecord::Base
  attr_accessible :email, :name, :stripe_token, :phone, :plan
  has_one :subscription
  has_one :setup
end

customer = Customer.first
customer.subscription # Instance of Subscription that belongs to customer
customer.setup # Instance of Setup that belongs to customer 
```

# c# - 在 C# 中使用 byVal .....有点复杂

> ID：12031540
> 
> 赞同：0
> 
> 时间：2012-08-20T02:06:11.713
> 
> 标签：c#, vb.net

在 VB 中

```
 Protected Overridable ReadOnly Property AuthorizationHeaderValue(ByVal signature As       String) As String
Get
    Return String.Format("{0} {1}:{2}", AuthorizationHeaderSignaturePrefix, APIIdentifier, signature)
End Get
End Property 
```

我在 C# 中有什么：

```
 protected virtual string AuthorizationHeaderValue
    {
        get { return string.Format("{0} {1}:{2}", AuthorizationHeaderSignaturePrefix, APIIdentifier, signature); }
    } 
```

我在 C# 中收到此错误：

> *当前上下文中不存在名称“签名”...*

这对我来说似乎很明显，因为当我转换代码时它会删除 ( `ByVal signature as String`)。

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T02:09:24.940

您的 C# 代码的问题是属性主体需要一个变量*签名*，但您没有定义具有该名称的变量。

C# 不允许属性像 VB.Net 那样具有参数（每个类一个[索引器除外）。](http://msdn.microsoft.com/en-us/library/6x16t2tx.aspx)考虑将其转换为方法。

```
protected virtual string AuthorizationHeaderValue(string signature)
{
    return string.Format("{0} {1}:{2}", AuthorizationHeaderSignaturePrefix, 
          APIIdentifier, signature);
} 
```

# ruby-on-rails - 我在哪里定义符号以便它们可以在另一个模型中访问？

> ID：12031541
> 
> 赞同：1
> 
> 时间：2012-08-20T02:06:31.167
> 
> 标签：ruby-on-rails, devise, ruby-on-rails-3.2, cancan

在这里的优秀系列文章中：[http ://www.tonyamoyal.com/2010/07/28/rails-authentication-with-devise-and-cancan-customizing-devise-controllers/comment-page-2/#comment -908](http://www.tonyamoyal.com/2010/07/28/rails-authentication-with-devise-and-cancan-customizing-devise-controllers/comment-page-2/#comment-908)他解释了一点关于如何使用 devise 进行 auth 和 cancan 获得权限。我有一个看起来简单得多的问题（因此这些文章中省略了它）：

我应该在哪里定义诸如 :super_admin 这样的符号，以便能力类可以访问它们？这些定义应该如何看待？

我很确定这些定义属于 Role 类，但如果是这样，它们在 Ability 类中如何（在范围内）简单地使用 :super_admin ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T02:43:30.717

您可以将符号视为类似于常量的有效字符串。你没有明确定义它们，你只是使用它们——这可能是你感到困惑的地方。此外，由于您“仅使用”符号，因此它们没有范围。如果您输入错误的符号，`:duper_admin`则不会对其进行错误检查，因为 ruby​​ 会很乐意为您创建该符号。

在文章中，作者在一个`roles`表中定义了角色。那么如何将数据库中的角色与您的角色符号（例如 ）进行比较`:super_admin`？通过使用这种方法

```
def role?(role)
  return !!self.roles.find_by_name(role.to_s.camelize)
end 
```

它是这样使用的

```
if user.role? :super_admin
  can :manage, :all
... 
```

该`role?`方法只是将符号转换为字符串，以便可以将其与数据库中的值进行比较。`roles`在表和所使用的符号之间没有进行编程映射。它们只是手动保持同步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T02:10:05.407

符号的要点是 ruby​​ 解释器只为每个符号创建一个副本。如果您写入`:foo`一个 ruby​​ 文件，它将与`:foo`所有其他 ruby​​ 文件中的所有其他文件相同。您不必提前定义或声明符号。

# javascript - 按属性名称选择每个 td，然后为属性值提供“未定义”

> ID：12031542
> 
> 赞同：0
> 
> 时间：2012-08-20T02:06:35.627
> 
> 标签：javascript, jquery, attr

我有一张像这样的 td 表：

```
<td age="123">0</td> 
```

使用 jQuery，下面的 JavaScript

```
$('td[age]').each(function(){
    console.log($('this').attr('age'));
}); 
```

将“未定义”打印到 Chrome 中的控制台。

为什么不打印“123”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T02:09:45.110

你在哪里

```
$('this') 
```

你应该有

```
$(this) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T02:13:28.773

**工作演示** [http://jsfiddle.net/SZSr5​​/](http://jsfiddle.net/SZSr5/)

```
$('td[age]').each(function(){
    alert($(this).html());
});​ 
```

# java - 将数据写入android中的远程文本文件

> ID：12031543
> 
> 赞同：4
> 
> 时间：2012-08-20T02:06:48.877
> 
> 标签：java, android

如何将数据写入 android 中的远程文本文件。我能够读取文本文件的内容，但无法向其中写入数据。我的目标是将文本文件的内容更改为新文件。我使用 xampp 作为远程服务器，因为我家里没有互联网连接。

这是我的代码：

```
package com.example.viewtextfromremote;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.net.URL;
import java.net.URLConnection;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class MainActivity extends Activity implements OnClickListener {
    TextView display;
    Button change, refresh;
    EditText edit;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        display = (TextView) findViewById(R.id.tvDisplay);
        change = (Button) findViewById(R.id.bChange);
        refresh = (Button) findViewById(R.id.bRefresh);
        edit = (EditText) findViewById(R.id.etChange);

        try {
            // Create a URL for the desired page
            URL url = new URL("http://10.0.2.2/name.txt");

            // Read all the text returned by the server
            BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream()));
            String str = in.readLine();
            in.close();
            display.setText(str);
        } catch (IOException e) {
            display.setText("io");
        }

        change.setOnClickListener(this);
        refresh.setOnClickListener(this);

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void onClick(View v) {
        switch (v.getId()) {
        case R.id.bChange:
            try {
                String output = edit.getText().toString();
                URL url = new URL("http://10.0.2.2/name.txt"); 
                URLConnection con = url.openConnection(); 
                con.setDoOutput(true); 
                OutputStreamWriter out = new OutputStreamWriter(con.getOutputStream());
                out.write(output); 
                out.close();
            } catch (Exception e) {
                // TODO: handle exception
            }

            break;
        case R.id.bRefresh:
            try {
                // Create a URL for the desired page
                URL url = new URL("http://10.0.2.2/name.txt");

                // Read all the text returned by the server
                BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream()));
                String str = in.readLine();
                in.close();
                display.setText(str);
            } catch (IOException e) {
                display.setText("io");
            }
            break;

        default:
            break;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T03:15:59.980

这是从android访问php文件的代码

```
 DefaultHttpClient httpClient = new DefaultHttpClient();
HttpPost httpPost = new HttpPost("http://localhost/file.php?value="+output);//output is the variable you used in your program
     httpClient.execute(httpPost); 
```

//把上面的代码放在case R.id.bChange: //也别忘了用try{} catch{}

.php 文件

```
 <?php
  $n="file.txt";
  $f=fopen($n,'w');
  $value=$_GET['value'];
  fwrite($f,$value);
  fclose($f);
  ?> 
```

// 此代码用于将 vlue 写入文件

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T02:55:02.653

你不能写，因为你把它作为一个 URL 打开。最好的方法是使用 php 文件来读取和写入数据。使用 android 你调用那个 php 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T02:56:14.437

您的代码似乎对于编写文件是正确的。您需要一个可以处理 POST 请求的服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T03:30:27.863

You can not directly write into a file which resides on the remote server. For such the requirement you need a middle level component called web-service. You need to create a web service which will work as medium between your application and the server by transferring your data from server and to server. You need to create a web service, your android application is going to call the web-service, which will insert the data into the textfile you want.

# c++ - 将一段 C++ 转换为 Python

> ID：12031548
> 
> 赞同：0
> 
> 时间：2012-08-20T02:07:20.647
> 
> 标签：c++, python

我正在尝试将此 C++ 转换为 Python。我只练习 Python，还没有接触过 C/C++。

```
int phi(const int n)
{
  // Base case
  if ( n < 2 )
    return 0;

  // Lehmer's conjecture
  if ( isprime(n) )
    return n-1;

  // Even number?
  if ( n & 1 == 0 ) {
    int m = n >> 1;
    return !(m & 1) ? phi(m)<<1 : phi(m);
  }

  // For all primes ...
  for ( std::vector<int>::iterator p = primes.begin();
        p != primes.end() && *p <= n;
        ++p )
  {
    int m = *p;
    if ( n % m  ) continue;

    // phi is multiplicative
    int o = n/m;
    int d = binary_gcd(m, o);
    return d==1? phi(m)*phi(o) : phi(m)*phi(o)*d/phi(d);
  }
} 
```

其中大部分很容易转换，只需要查找 C++ 运算符。但是，这一点：

```
 for ( std::vector<int>::iterator p = primes.begin();
        p != primes.end() && *p <= n;
        ++p ) 
```

它在 Python 中是什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T02:14:22.170

```
for p in primes:
  if p > n:
    break
   ... 
```

或者

```
for p in (x for x in primes if x <= n):
   ... 
```

虽然前者会结束得更快。

# django - apache + mod_wsgi + django +askbot

> ID：12031549
> 
> 赞同：0
> 
> 时间：2012-08-20T02:07:26.917
> 
> 标签：django, apache, askbot

> 错误：文件不存在：/home/WorkSpace/fenxiang/site_media/media/photos/3.jpg 真实地址3.jpg在/home/WorkSpace/fenxiang/askbot/upfiles/photos/3.jpg

所有的apalication都运行良好`python manage.py runserver`：

centos6.2 python2.7(/opt/python2.7.2)

**hpptd.conf**

```
<VirtualHost *:80>

    ServerAdmin matt@360yuer.com
    ServerName www.360yuer.com
    DocumentRoot /home/WorkSpace/fenxiang

    WSGIScriptAlias / /home/WorkSpace/fenxiang/apache/fenxiang.wsgi

    Alias /site_media/ /home/WorkSpace/fenxiang/site_media/
    Alias /upfiles/ /home/WorkSpace/fenxiang/askbot/upfiles/

    Alias /static/ /home/WorkSpace/fenxiang/static/ 
    AddType text/html .py

    <Directory  /home/WorkSpace/fenxiang/apache >
       Order allow,deny
        Allow from all
    </Directory>

    <Directory /home/WorkSpace/fenxiang/site_media>
        AllowOverride None
        Options None
        Order deny,allow
        Allow from all
    </Directory>
    <Directory /home/WorkSpace/fenxiang/askbot/upfiles>
                Order deny,allow
                Allow from all
        </Directory>

    <Directory /home/WorkSpace/fenxiang/static>
        Order deny,allow
        Allow from all
    </Directory>

</VirtualHost> 
```

我是新人，不知道怎么解决，目前的问题是找不到/askbot/upfiles/3.jpg，和/static/css中的一些css

**设置.py**

```
 STATICFILES_DIRS = (os.path.join(ASKBOT_ROOT, 'skins'), os.path.join(PROJECT_ROOT, "static"), ASKBOT_EXTRA_SKINS_DIR)
 RECAPTCHA_USE_SSL = True 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:49:19.780

代替：

```
/askbot/upfiles/3.jpg 
```

您应该将 URL 用于：

```
/upfiles/3.jpg 
```

在里面。这就是您设置 Alias 的目的。

至于 CSS 文件，它们实际上是否在目录中：

```
/home/WorkSpace/fenxiang/static/css/ 
```

# c# - SQL Server CE 中的正确日期时间格式？

> ID：12031551
> 
> 赞同：6
> 
> 时间：2012-08-20T02:07:30.290
> 
> 标签：c#, sql, datetime, sql-server-ce

我有一个 C#`DateTime`类，想知道如何在 SQL Server CE 查询中对其进行格式化以将其插入数据库，我希望同时插入日期和时间。目前，当我尝试其变体时，我变得无效格式异常。

我正在使用的当前格式是：`dd/MM/yyyy`，希望做类似的事情`dd/MM/yyyy hh:mm:ss`。

我尝试插入的方式是这样的：

```
 ( ( DateTime )_Value ).ToString( "dd/MM/yyyy hh:mm:ss" ) 
```

显然`hh:mm:ss`不起作用，如果`dd/MM/yyyy`在查询中没有成功执行。

我尝试了几种格式，包括我在谷歌上找到的格式，但到目前为止都没有奏效......

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-20T02:42:58.363

如果您完全担心格式正确，那么已经出现了严重错误。要在任何数据库中正确使用日期时间值，您需要做两件事，而不仅仅是 sqlce：

1.  确保您对列使用日期时间类型（而不是像 varchar 这样的文本类型）
2.  确保您在参数化查询中使用日期时间参数，而不是字符串连接。

如果您这样做，则您不涉及任何格式。完全没有。例子：

```
 void SetDate(int recordID, DateTime timeStamp)
 {
    string SQL = "UPDATE [sometable] SET someDateTimeColumn= @NewTime WHERE ID= @ID";

    using (var cn = new SqlCeConnection("connection string here"))
    using (var cmd = new SqlCeCommand(SQL, cn))
    {
        cmd.Parameters.Add("@NewTime", SqlDbType.DateTime).Value = timeStamp;
        cmd.Parameters.Add("@ID", SqlDbType.Integer).Value = recordID;

        cn.Open();
        cmd.ExecuteNonQuery();
    }
} 
```

从未使用过**字符串**操作将值替换为 sql 查询。这是一个**巨大**的禁忌。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-20T02:25:26.703

尝试以下格式：

```
DateTime.Now.ToString("yyyy-MM-dd hh:mm:ss") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-27T20:46:50.987

伙计，您不需要将字符串转换为日期时间。

使用新 DateTime 的实例并将日期作为参数传递。像这样：

```
using (var ctx = new DBPreparoEntities())
{
    var _client = from p in ctx.Client
                     select new Client
                     {
                         data = new DateTime(2016,08,17),
                         dateconf = null,
                         scod_cli = p.Rua,
                         valorini = 7214.62m,
                     };
    return client.ToList();
} 
```

不要使用：

```
... data = DateTime.Parse("2016/12/10") // or other type convertions. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T02:23:15.953

抱歉，这是在 vb.net 中，但这是我用来从 CE 日期/时间格式转换的方法：

```
Public Shared Function ConvertSqlDateTimeFormat(ByVal s As String) As String
    Dim theDate As New Text.StringBuilder
    Dim sTemp As String = ""
    Dim iIndex As Integer

    If s.Length > 8 Then
        'first we do the time
        iIndex = s.IndexOf(" ", System.StringComparison.OrdinalIgnoreCase)
        If iIndex > 0 Then
            sTemp = s.Substring(iIndex).Trim
            iIndex = sTemp.IndexOf(".", System.StringComparison.OrdinalIgnoreCase)
            If iIndex > 0 Then
                sTemp = sTemp.Substring(0, iIndex)
            End If
        End If

        'next the date
        theDate.Append(s.Substring(4, 2))
        theDate.Append("/")
        theDate.Append(s.Substring(6, 2))
        theDate.Append("/")
        theDate.Append(s.Substring(0, 4))
        theDate.Append(" ")
        theDate.Append(sTemp)
    End If
    Return theDate.ToString
End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-27T15:53:58.223

```
private void button1_Click(object sender, EventArgs e)
{
    var cnn1 ="";//connection string 
    SqlCeConnection cnn = new SqlCeConnection(cnn1);   
    datetime dt4 = DateTime.Today.Date.ToString("yyyyMMdd").trim();//format 
    var qry ="insert into tbl_test(User_Id, DateOfJoin)values (11,'" + dt4 + "')";

    cmd = new SqlCeCommand(qry, cnn);

    try
    {
        dr = cmd.ExecuteReader();
    }
    catch (Exception ex)
    {
        string sr = ex.Message;
        throw;
    }
} 
```

上面的代码对我有用。

![1](../Images/db63acd71bcd377aa513695f737326ef.png)

# php - 如何以 symfony2 形式过滤我的 onetoMany 关系选择框

> ID：12031558
> 
> 赞同：1
> 
> 时间：2012-08-20T02:08:19.140
> 
> 标签：php, symfony, doctrine-orm

我有 OnetoMany 关联

`Product`会有很多`vouchers` 但是一张优惠券只能链接到一种产品。

现在，当我有产品表单时，我就有了选择框，我可以在其中选择多张优惠券。但问题是

如果优惠券以前链接到另一个产品，那么它会被更新。

那么有什么方法/查询可以在我的选择框中看到

1.  当前未与任何产品关联的所有凭证（可以这样做）
2.  现在但我还想展示以前与当前编辑产品相关联的 vocuhers

这是我的代码

```
 ->add('vouchers', 'entity', array(
                'class' => 'AcmeMyBundle:Voucher',
                'query_builder' => function(EntityRepository $er) {
                    return $er->createQueryBuilder('u')
                    ->where('u.product_id = :id')
                                ->setParameter('id', 'NULL')
                    ->orderBy('u.name', 'DESC');
                        },
                'expanded'=> false,
                'multiple' => true
                    )) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:30:56.587

您可以编辑您的查询。我们不知道您的关联是什么样的，但假设您使用的是`vouchers`.

```
//...
->where('u.product_id = :id')
->leftJoin('u.vouchers','v')
->having('COUNT(v.id) = 0')
->groupBy('u.product_id'); 
```

# git - 使用 git 作为同步/备份两个 mac 的手段

> ID：12031562
> 
> 赞同：0
> 
> 时间：2012-08-20T02:08:52.180
> 
> 标签：git, backup, push, sync, pull

这是我的想法（我目前正在测试）：我刚买了一台新的 macbook pro 可以在路上使用，但我现在遇到了一个问题，就是要轻松地将它与我的主 iMac 保持同步。我对 git 非常熟悉，并且认为它比 rsync 等其他实用程序更易于使用和管理，因为我真的可以看到我所做的更改是什么。我知道 git 不是针对并同步这些类型的文件，但我的想法是在两台计算机的根目录上初始化一个 git repo，然后在网络驱动器上创建一个裸目录，就像我的本地 github 一样。然后我可以从两台计算机推送和拉取到这个远程目录，甚至可以设置隧道，这样我就不必在本地网络上进行同步。除了 Git 不针对这类工作之外，还有其他可以预见的问题吗？最初的提交和推送可能会持续很长时间，但我觉得通常在那之后时间不会太糟糕，因为 git 可以很好地跟踪哪些文件发生了变化。为了正确看待它，我在两台机器上初始化了 git repos 并在大约 5 分钟前运行了 git add -A 并且它仍在运行。只是想知道其他人对此的想法是什么，以及以前是否曾尝试过。谢谢，布莱恩 只是想知道其他人对此的想法是什么，以及以前是否曾尝试过。谢谢，布莱恩 只是想知道其他人对此的想法是什么，以及以前是否曾尝试过。谢谢，布莱恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T02:13:47.370

除非您需要版本控制，否则请查看 RSync。 [http://en.wikipedia.org/wiki/Rsync](http://en.wikipedia.org/wiki/Rsync)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T02:22:06.470

如果您可以稍等片刻，这对您来说是完美的选择：[http ://www.kickstarter.com/projects/joeyh/git-annex-assistant-like-dropbox-but-with-your-own](http://www.kickstarter.com/projects/joeyh/git-annex-assistant-like-dropbox-but-with-your-own)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T02:23:17.933

macbook 和 iMac 中的文件不一样。许多系统文件不同，可能使用相同的文件路径。您最终会忽略大量系统文件、临时文件、硬件相关文件。并且您主要处理二进制文件，这些文件不能作为文本文件进行区分。所以所有版本都存储在 git repo 中，而不是 delta 中。你的 git repo 的大小会增长得非常快。

我的建议是让自己熟悉`rsync`，编写同步脚本，并为此设置一个 cron 作业。那么您基本上可以忘记它并随着时间的推移对参数进行小幅更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T04:08:26.757

为什么不直接使用 DropBox 之类的东西呢？

# django - 在具有 ManyToMany 字段的 QuerySet 上输出 values()

> ID：12031563
> 
> 赞同：19
> 
> 时间：2012-08-20T02:09:02.137
> 
> 标签：django, django-queryset, django-orm

我目前正在将 QuerySet 的结果放入我的 js 前端使用的 JSON 字符串中。

目前这很容易使用 .values() 和 simplejson：

```
simplejson.dumps(list(Task.objects.filter(list=mylist).values())) 
```

我现在在我的 Task 对象中添加了一个 ManyToMany 字段，希望将它包含在我的输出中，而不需要为 ManyToMany 关系的每个值重复每个 Task 对象。

如果我只是这样做`Task.objects.filter(list=mylist).values('myManyToManyField', 'someOtherField')` ，输出将为每个值都有一个单独的对象/行`myManyToManyField`

```
[{'myManyToManyField': 1, 'someOtherField': 'valueOne'}, 
{'myManyToManyField': 2, 'someOtherField': 'valueOne'},
{'myManyToManyField': 1, 'someOtherField': 'valueTwo'}] 
```

有没有办法得到这个结果？：

```
[{'myManyToManyField': [1,2], 'someOtherField': 'valueOne'},
{'myManyToManyField': 1, 'someOtherField': 'valueTwo'}] 
```

我现在唯一的解决方案是遍历所有`Task`对象并手动构建输出，根据需要将 ManyToMany 值放入其中。有一个更好的方法吗？如果不是 - 这会非常低效吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-10-21T08:07:04.353

似乎没有其他方法，只能遍历所有`Task`对象。

Django 的文档[警告](https://docs.djangoproject.com/en/1.8/ref/models/querysets/#values)在“ManyToManyField”上使用“values()”。

它不会是

> 效率极低

如果你这样做[多对多字段的所有值：Django](https://stackoverflow.com/questions/12139923/all-the-values-of-the-many-to-many-field-django)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-08-23T09:46:58.447

您可以使用 Django 的序列化程序：

```
import json
from django.core import serializers

json_data = serializers.serialize("json", Task.objects.all()) 
```

如果您只想提取字段，请执行以下操作：

```
data = [i['fields'] for i in json.loads(json_data)] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-10-05T08:48:10.727

```
from django.contrib.postgres.aggregates import ArrayAgg

Task.objects.filter(list=mylist).annotate(arr_field=ArrayAgg('myManyToManyField')).values('arr_field', 'someOtherField') 
```

输出：

```
[{'arr_field': [1,2], 'someOtherField': 'valueOne'},
 {'arr_field': 1, 'someOtherField': 'valueTwo'}] 
```

# iphone - 如何在 +(void)classMethod 中使用 [self performSelector: withObject: afterDelay:] 方法

> ID：12031567
> 
> 赞同：0
> 
> 时间：2012-08-20T02:09:15.507
> 
> 标签：iphone, ios, cocos2d-iphone

我怎样才能使用`[self performSelector: withObject: afterDelay:]`方法`+(void)classMethod`？

我在下面定义了一个精灵：

```
+(void)classMethod
{
   CCSprite * sprite = [CCSprite spriteWithFile:@"sprite.png"];

  //and hope afterDelay3.0second remove this sprite

   [self performSelector:@select(clean:) withObject:sprite afterDelay:3.0];
}

+(void)clean:(CCSprite *)sprite
{
   [sprite removeFromSuperView];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:14:24.803

从技术上讲`self`，是指给`Object`定类的，在您的情况下，您没有创建一个`Object`，因此您将无法`Object`从静态方法调用方法。

**视觉的**

![在此处输入图像描述](../Images/9827311a15eb01fdc0dc8198a5f62294.png)

快速测试表明，如果您的方法被声明为实例级别，那么您将无法从您的类方法中访问它。

在你的情况下，

```
+(void)classMethod
{

} 
```

是一个类方法，但是，

```
[self performSelector:@selector(clean:) withObject:sprite afterDelay:3.0]; 
```

是的实例方法`NSObject`，这就是为什么你不能从你的类方法调用。

## [苹果文档](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/nsobject_Class/Reference/Reference.html)，

```
- (void)performSelector:(SEL)aSelector withObject:(id)anArgument afterDelay:(NSTimeInterval)delay 
```

这意味着您正在从类方法访问实例方法，这是不允许的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T02:16:42.263

我认为您不能`Instance`在其他方法中使用此`Class`方法。

如果你想做一些延迟动作，试试吧`NSTimer timerWithTimeInterval:target:selector:userInfo:repeats:`。

# python - Python中的自我变量与类变量

> ID：12031571
> 
> 赞同：3
> 
> 时间：2012-08-20T02:09:38.980
> 
> 标签：python

您能否在下面的课程中澄清一下周长变量。

我知道这`self.vertices`是针对特定实例的。由于`perimeter`没有用 定义`self`，这是否意味着它是一个类变量？那么它不是对所有实例都通用吗？

将周界编码为 不是正确的方法`self.perimeter`，因此它恰当地声明给每个实例吗？

此代码来自一本书。

### 多边形.py

```
import math
class Point:
    def __init__(self, x, y):
        self.x = x
        self.y = y
    def distance(self, p2):
        return math.sqrt((self.x-p2.x)**2 + (self.y-p2.y)**2)

class Polygon:
    def __init__(self):
        self.vertices = []
    def add_point(self, point):
        self.vertices.append((point))
    def perimeter(self):
        perimeter = 0
        points = self.vertices + [self.vertices[0]]
        for i in range(len(self.vertices)):
            perimeter += points[i].distance(points[i+1])
        return perimeter 
```

```
>>> square = Polygon() 
>>> square.add_point(Point(1,1)) 
>>> square.add_point(Point(1,2)) 
>>> square.add_point(Point(2,2)) 
>>> square.add_point(Point(2,1)) 
>>> square.perimeter() 
4.0 
```

新型

```
import math
class Point:
    def __init__(self, x, y):
        self.x = x
        self.y = y
    def distance(self, p2):
        return math.sqrt((self.x-p2.x)**2 + (self.y-p2.y)**2)

class Polygon:
        def __init__(self):
            self.vertices = []
        def add_point(self, point):
            self.vertices.append((point))
        def perimetermethod(self):
            self.perimeter = 0
            points = self.vertices + [self.vertices[0]]
            for i in range(len(self.vertices)):
                self.perimeter += points[i].distance(points[i+1])
            return self.perimeter

if __name__=='__main__':
    p1 = Polygon()
    p1.add_point(Point(1,1))
    p1.add_point(Point(1,2))
    p1.add_point(Point(2,2))
    p1.add_point(Point(2,1))
    print(p1.perimetermethod()) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T02:32:56.940

分配一个新变量`some_name = ...`总是在最里面的封闭范围内创建变量（除非`global`或`nonlocal`正在发挥作用，但它们在这里不相关）。为对象分配新的属性名称会在该对象上创建属性。

因此`self.foo = 1`分配一个`foo`在当前引用的对象上命名的属性`self`。按照惯例，名称`self`用作方法的第一个参数，该方法接收调用该方法的对象。所以“用 self 定义一个变量”并没有什么特别之处。这只是关于分配给现有对象的属性的普通规则。实例对象本身中存在的任何属性显然必须特定于该实例。

`perimeter = 0`在类的`perimeter`方法内部`Polygon`在最里面的封闭范围内创建一个变量。这就是`perimeter`方法，所以它创建了一个局部变量。局部变量仅在函数调用期间存在，因此它既不是类变量也不是实例变量。除了该特定方法的范围之外，您无法从任何地方访问它（并且它在每次调用时都有一个新的完全独立的值），因此它不能对所有实例都通用。但是您也不能在每个特定实例上访问它的不同值，因此它也不是实例变量。

如果您有`perimeter = 0`一个方法之外的类块本身，那么最里面的封闭范围将是类块。**这**将创建一个“类变量”，它只是类对象的一个​​属性。如果一个属性在一个类上，那么显然它*不能*特定于任何实例，因为只有一个类但可以有任意数量的实例。顺便说一句，这正是类的`__init__`、`add_point`和`perimeter` *方法*的含义`Polygon`；它们在类块中被分配（使用`def`语句），因此它们成为类对象的属性。

* * *

概括：

1.  `self.foo = 1`正在分配给当前引用的对象的属性`self`（这通常是“当前实例”）
2.  `foo = 1` *在类块*中正在创建正在定义的类的类属性
3.  `foo = 1` *在 def 块*中正在创建正在定义的函数的局部变量

但你不应该真的那样记住它。它们只是以下特殊情况：

1.  分配给一个带点的名称就像`foo.bar.baz = 1`是写入一个对象的属性
2.  分配给一个简单的名称，例如`foo = 1`写入最内层封闭范围内的变量

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T02:11:59.440

不，这意味着它是本地的。此外，您不想使用，`self.perimeter`因为它会影响具有相同名称的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T02:11:51.553

在您的代码中，有两件事称为`perimeter`. 一个是`Polygon`类上的方法。另一个是该方法内的局部变量。您的代码中没有类属性。

# android-layout - 一种 IFRAME for Android 应用程序

> ID：12031573
> 
> 赞同：0
> 
> 时间：2012-08-20T02:09:52.203
> 
> 标签：android-layout

有没有适用于 android 的 iframe。

我在底部有一个广告位，广告需要在每个活动页面上可见。

我已经为我的广告制作了一个活动类。广告可以是 mp4 或 png 格式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:11:52.810

尝试使用 WebView：

[http://developer.android.com/reference/android/webkit/WebView.html](http://developer.android.com/reference/android/webkit/WebView.html)

# java - 延迟 JSP 自定义标签的输出？

> ID：12031578
> 
> 赞同：0
> 
> 时间：2012-08-20T02:10:35.510
> 
> 标签：java, jsp, tags

我想延迟自定义标签的输出。

原因是：我想在文档头部添加一个标签，该标签将编译样式和脚本列表以包含在页面中。页面中的后续标签将添加到元素列表中，并且在生成页面主体后将打印该列表。

这是可能的还是有更好的方法来做到这一点。（我不想知道在页面编译期间要添加哪些链接。）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T08:54:56.183

使用[JSPContext](http://docs.oracle.com/javaee/1.4/api/javax/servlet/jsp/JspContext.html) `pushBody()`，`popBody()`您可以对输出顺序进行一些控制。

```
<%
  Writer body = new StringWriter();
  out = pageContext.pushBody(body);
  // following code will write to 'body' and not to client
%>
...
<%
  out = pageContext.popBody();
  // normal output again
%>
...
<% // write the captured output %>
<%= body %> 
```

即使它有效，也可能更好地解决，因为它非常令人困惑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T22:43:47.887

我在各种网站上问过这个问题，但没有得到我想要的答案（尽管有些很有创意，谢谢！）所以我最终自己做了很多研究，以寻找“最好”的方法做这个。这就是我想出的：

我创建了三个自定义标签，因此我的 html 如下所示：

```
<html:page>
    <html:head>
        ...
    </html:head>
    <html:body>
        ...
    </html:body>
</html:page> 
```

页面标记在 doStartTag() 方法中的 REQUEST_SCOPE 中创建一个名为“headercontents”的变量，该变量可以编译我想要放置在文档头部的输出列表。

head 元素只是简单地将其所有正文内容添加到此变量中。

body 元素现在什么都不做，只有一个带有简单 .

正文中的任何元素现在都可以使用“headercontents”变量将信息发布到 html 页面的头部。（因此在头部而不是正文中链接它需要的任何样式表或脚本）。

然后最后在页面标签的 doEndTag() 方法中打印“headercontents”变量的内容，然后打印自身的内容（html:body 标签的内容）。

结果是文档可以根据需要自行加载和重新排列。这仍然是一个初级版本，但我会完善它并在将来的某个时候发布源代码。

# jquery - mvc .net 和 jquery 将其应用于一组动态链接

> ID：12031580
> 
> 赞同：0
> 
> 时间：2012-08-20T02:11:23.217
> 
> 标签：jquery, asp.net-mvc, jquery-ui

所以我有一组动态生成的链接：

```
<a class="link"href="linkto/1" id="1">link 1</a>
<a class="link"href="linkto/2" id="2">link 2</a>
<a class="link"href="linkto/3" id="3">link 3</a> 
```

然后这些链接调用一个返回数据列表并填充 div 的操作（这也是在链接下方动态生成的）

```
<a class="link" href="linkto/1" id="1">link 1</a>
<div class="container" id="1"></div>
<a class="link" href="linkto/2" id="2">link 2</a>
<div class="container" id="2"></div>
<a class="link" href="linkto/3" id="3">link 3</a>
<div class="container" id="3"></div> 
```

这是我的jQuery

```
var url;
        var id;
        $('a.link').click(function () {
            url= $(this).attr('href');
            id = $(this).attr('id');
            $.ajax({
                url: url,
                dataType: 'JSON',
                success: function (data) {
                    var list = '';
                    var listcontainer = $('div.container').attr({ id: id.toString() });
                    $.each(data, function (i, client) {
                        list += '<div class="' + client.Id + '">Name of client = ' + client.Name + '</div>';
                    });
                    $(listcontainer).addClass("box-list-small");
                    $(listcontainer).html(list);
                },
                error: function (data) {
                    console.log('Cant load client list.');
                }
            });
            return false;
        }); 
```

所以我想要实现的是会有一个链接，当它被点击时，它下面的一个框会打开以显示列表。问题是，每次我单击一个链接时，它都会在页面中填充“容器”。那有意义吗？

珍惜时间！

谢谢！！

编辑：修改伪代码。

```
<div class="row">
    <a class="link" href="linkto/1" id="1">link 1</a>
    <a class="someotherlink">someotherlink</a>
  </div>
 <div class="row">
    <div class="container" id="1"></div>
</div>
<div class="row">
    <a class="link" href="linkto/2" id="2">link 2</a>
    <a class="someotherlink">someotherlink</a>
</div>
<div class="row">
    <div class="container" id="2"></div>
</div>
<div class="row">
    <a class="link" href="linkto/3" id="3">link 3</a>
    <a class="someotherlink">someotherlink</a>
</div>
<div class="row">
    <div class="container" id="3"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T02:37:29.200

该行：用类“容器”`var listcontainer = $('div.container').attr({ id: id.toString() });` 查询*每个*div 的 DOM，然后将它们的所有 id 设置为单击链接的 id.. 并将 div 的集合返回到 listcontainer 变量中。然后你调用`.html(list)`它，让它设置所有容器。

你可能想要更像这样的东西：

```
$('a.link').click(function () {
        var el = $(this),
            url= el.attr('href'),
            id = el.attr('id');
        $.ajax({
            url: url,
            dataType: 'JSON',
            success: function (data) {
                var list = '';
                $.each(data, function (i, client) {
                    list += '<div class="' + client.Id + '">Name of client = ' + client.Name + '</div>';
                });
                el.next('.container').addClass("box-list-small").html(list);
            },
            error: function (data) {
                console.log('Cant load client list.');
            }
        });
        return false;
    }); 
```

# database - 如何检查Oracle实例是否使用pfile或spfile启动？

> ID：12031587
> 
> 赞同：14
> 
> 时间：2012-08-20T02:13:02.387
> 
> 标签：database, oracle

有没有可以检查实例是否已使用 pfile 或 spfile 启动的视图？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-20T02:27:32.233

这表明数据库是由`spfile`

```
SQL> show parameter spfile;

NAME    TYPE    VALUE
----    ----   ----------------------------------------------------------
spfile  string /root/apps/oracle/10g/dbs/spfile<DB_NAME>.ora 
```

没有返回值意味着它开始于`pfile`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-13T14:35:49.793

```
SELECT DECODE(value, NULL, 'PFILE', 'SPFILE') "Init File Type" 
   FROM sys.v_$parameter WHERE name = 'spfile'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-04T12:17:29.850

```
select sys_context('USERENV','ORACLE_HOME') from dual; 
```

# ios - XCode 警告：使用'stringWithString'：使用文字是多余的

> ID：12031590
> 
> 赞同：4
> 
> 时间：2012-08-20T02:13:44.557
> 
> 标签：ios, xcode, nsstring, warnings, stringwithstring

我收到以下警告

`Using 'stringWithString': with a literal is redundant`

在使用方法时`usingWithString`

```
[NSString stringWithString:@"Content-Type: content/unknown\r\n\r\n"] 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-20T02:13:44.557

我通过替换解决了这个`[NSString stringWithString:@"Content-Type: content/unknown\r\n\r\n"]`问题`@"Content-Type: content/unknown\r\n\r\n"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-08T03:54:52.877

警告是因为你最好使用 @"" 来初始化一个字符串。例如：

```
 NSString *s1 = @"s1";
 NSString *s3 = [[NSString alloc] initWithString:@"s1"]; 
```

我们可以打印他们的地址：

```
2017-02-08 11:38:46.997201 Test[7484:2245410] s1:0x10009c088 s1
2017-02-08 11:38:46.997290 Test[7484:2245410] s3:0x10009c088 s1 
```

我们可以发现它们指向同一个地址。所以苹果建议使用“@”“”而不是“initWithString”。

# javascript - 在 CoffeeScript 文件上运行 Jasmine 测试时对象未定义错误

> ID：12031599
> 
> 赞同：-4
> 
> 时间：2012-08-20T02:15:06.597
> 
> 标签：javascript, coffeescript, jasmine

我一直在学习咖啡脚本，作为学习它的练习，我决定使用 TDD [Conway 的 Game of Life](http://en.wikipedia.org/wiki/Conway%27s_Game_of_Life)。我选择的第一个测试是创建一个 Cell 并查看它是死的还是活的。为此，我创建了以下咖啡脚本：

```
class Cell 
  @isAlive = false

  constructor: (isAlive) ->
    @isAlive = isAlive

  die: ->
    @isAlive = false 
```

然后我使用以下代码创建一个 Jasmine 测试文件（这是故意失败的测试）：

```
Cell = require '../conway'

describe 'conway', ->
  alive = Cell.isAlive
  cell = null

  beforeEach ->
    cell = new Cell()

 describe '#die', ->
   it 'kills cell', ->
     expect(cell.isAlive).toBeTruthy() 
```

但是，当我在 Jasmine 中运行测试时，出现以下错误：

```
cell is not defined 
```

和堆栈跟踪：

```
1) kills cell
   Message:
     ReferenceError: cell is not defined
   Stacktrace:
     ReferenceError: cell is not defined
    at null.<anonymous> (/Users/gjstocker/cscript/spec/Conway.spec.coffee:17:21)
    at jasmine.Block.execute (/usr/local/lib/node_modules/jasmine-node/lib/jasmine-node/jasmine-2.0.0.rc1.js:1001:15) 
```

当我执行`coffee -c ./spec/Conway.spec.coffee`并查看生成的 JavaScript 文件时，我看到以下内容（第 17 行，第 21 列是错误）：

```
// Generated by CoffeeScript 1.3.3
(function() {
  var Cell;

  Cell = require('../conway');

  describe('conway', function() {
    var alive, cell;
    alive = Cell.isAlive;
    cell = null;
    return beforeEach(function() {
      return cell = new Cell();
    });
  });

  describe('#die', function() {
    return it('kills cell', function() {
      return expect(cell.isAlive).toBeTruthy(); //Error
    });
  });

}).call(this); 
```

我的问题是，据我所知，`cell` *已*定义。我知道我错了（因为[`SELECT is not broken`](http://lingpipe-blog.com/2007/06/27/select-isnt-broken-or-horses-not-zebras/)），但我试图找出我搞砸的地方。我如何用咖啡脚本诊断这个错误并找出我哪里出错了？

我研究了许多coffeescript应用程序中包含的源代码，包括[这个](https://github.com/spaghetticode/game-of-life-coffeescript)，但源代码的格式完全相同，声明相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T03:01:17.287

这是一个缩进问题，[这是您的解决方法](https://gist.github.com/3399818)：

```
Cell = require '../conway'

describe 'conway', ->
  alive = Cell.isAlive
  cell = null

  beforeEach ->
    cell = new Cell()

  describe '#die', ->
    it 'kills cell', ->
      expect(cell.isAlive).toBeTruthy() 
```

如果您查看已编译的 JavaScript，您有一个`describe`块，并且其中有一个块`beforeEach`。但是你的下一个`describe`街区（你*想*在第一个街区里面）实际上*并不*在里面——它在外面。

这是因为第二个缩进`describe`只有一个空格，而不是两个。

# python - Python：将字符串“30DEC05”解析为日期时间

> ID：12031602
> 
> 赞同：0
> 
> 时间：2012-08-20T02:15:45.357
> 
> 标签：python, parsing, datetime, time

我有一个格式为“30DEC05”的字符串，在此示例中表示 2005 年 12 月 30 日。如何将此字符串解析为日期时间？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T02:22:10.283

```
>>> from datetime import datetime
>>> datetime.strptime('30DEC05', '%d%b%y')
datetime.datetime(2005, 12, 30, 0, 0) 
```

注意：`%b`取决于您的语言环境。

# php - PHP 通过命令行传递的参数被截断

> ID：12031604
> 
> 赞同：0
> 
> 时间：2012-08-20T02:16:40.097
> 
> 标签：php, phantomjs

我正在使用 PHP`shell_exec()`通过命令行执行程序，并将 URL 作为参数传递给它。

**问题：**程序似乎只接收到参数的截断版本。PHP传递参数

`http://www.mysite.com/Men/T-Shirts-Vests/Cat/pgecategory.aspx?cid=7616&parentID=-1&pge=0&pgeSize=200&sort=1`

但程序将其接收为

```
http://www.mysite.com/Men/T-Shirts-Vests/Cat/pgecategory.aspx?cid=7616 
```

我怎样才能防止它在之后被截断`&`？

**PHP**

```
 $url = 'http://www.mysite.com/Men/T-Shirts-Vests/Cat/pgecategory.aspx?cid=7616&parentID=-1&pge=0&pgeSize=200&sort=1';
    $script = path('base')."application/phantomjs/httpget.js";
    $output = shell_exec("phantomjs $script $url"); 
```

**httpget.js**

```
// Get URL from command line parameter
var system = require('system');
var url = system.args[1];
console.log(url); 
```

**输出**

`http://www.mysite.com/Men/T-Shirts-Vests/Cat/pgecategory.aspx?cid=7616`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T02:32:03.547

使用[escapeshellarg](http://php.net/manual/en/function.escapeshellarg.php)

```
$url = escapeshellarg($url); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T02:31:58.860

引用你的字符串：

```
$url = 'http://www.mysite.com/Men/T-Shirts-Vests/Cat/pgecategory.aspx?cid=7616&parentID=-1&pge=0&pgeSize=200&sort=1';
$script = path('base')."application/phantomjs/httpget.js";
$output = shell_exec("phantomjs $script \"$url\""); 
```

例如，考虑以下情况：

```
~ $ echo foo&bar
[1] 25361
foo
-bash: bar: command not found
[1]+  Done                    echo foo
~ $ 
```

对比

```
~ $ echo "foo&bar"
foo&bar
~ $ 
```

# javascript - Javascript 在 iframe 中禁用 onload 功能

> ID：12031609
> 
> 赞同：0
> 
> 时间：2012-08-20T02:17:24.043
> 
> 标签：javascript, iframe, onload

我的网页上有一个 iframe，源 url 是我无权访问的远程网页，问题是在 iframe 正文 onload 事件中，有一个 JS 函数：

```
 <body onload="if(top!=self) top.location.href=location.href"> 
```

这样我的网页就会更改为他们的网页网址。无论如何我可以在我的网页上使用javascript来禁用或重写该iframe中的body onload功能吗？我认为这与 iframe onload 事件不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T02:34:09.320

甚至试图打破这一点的唯一方法是使用服务器端代码（PHP、Ruby、Python 等）将他们的页面实质上代理到您控制的 iframe 中。您可以获取他们文档的来源并进行替换以摆脱他们的 onload 事件服务器端。

你想建立一个类似的结构：

```
AppFolder
    index.html
    your_iframe.php 
```

在您的 iframe 中，只需下载 url 的内容并进行替换并回显到浏览器。您仍然需要解决许多问题，例如 iframed 文档中的相对资源路径。

# hibernate - Postgresql CITEXT 数据类型问题 JPA Hibernate

> ID：12031613
> 
> 赞同：12
> 
> 时间：2012-08-20T02:18:22.700
> 
> 标签：hibernate, postgresql, jpa, postgresql-9.1

我在使用 JPA 和 Hibernate 的 PostgreSQL 中使用 CITEXT 数据类型时遇到了困难。CITEXT 应该提供不区分大小写的文本数据类型，但是当与 JPA/Hibernate 一起使用时，它不会以不区分大小写的方式运行。有没有其他人遇到过这个问题或知道解决方法？我已经看到一些关于 JDBC 问题的提及（但非常非常少），但这至少可以追溯到一年前并且不是很清楚。

我在 postgres 9.1 中有一个“昵称”列定义为 citext。我刚刚做了一个测试，看看它是否可以使用命名查询找到一行：

```
create table test(
    nickname citext
)

@NamedQuery(name = "Person.findByNickname", 
            query = "SELECT p 
                     FROM Person p 
                     WHERE p.nickname = :nickname") 
```

在数据库中插入昵称：

```
insert into test values('testNick') 
```

然后运行这段代码：

```
String nickname = "testNick";

Query q = em.createNamedQuery("Person.findByNickname");
q.setParameter("nickname", nickname);
if (q.getResultList().isEmpty()) {
    return (false);
}
return (true); 
```

这将返回“true”（即数据库中已经有一个“testNick”）。

如果我做这个任务

```
String nickname = "testnick"; //(lower case 'N') 
```

并再次运行它返回'false'。

由于该列是 CITEXT，*它应该再次返回“true”*。即不区分大小写的文本。

使用 JPA 和休眠。有人有什么想法吗？

同时，我已将该列改回 varchar 并为小写创建了一个功能索引。我现在必须创建一个本机查询来使用数据库函数进行搜索。想知道是否有一种方法我可以不必这样做来维护数据库抽象。

问候。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-20T02:21:02.523

`citext`提供在数据库中使用的不区分大小写的运算符*，以及其他 citext 值*。

## 发生了什么

`text`猜测一下，您的 JPA 实现在创建参数化语句时明确指定参数的类型。`citext`没有定义`citext = text`运算符，因此 PostgreSQL 将`citext`to转换为`text`并使用区分大小写的`text = text`运算符。实际上，比较`citext`是`text`区分大小写的。

这就是我认为正在发生的事情。给定虚拟数据：

```
regress=# CREATE EXTENSION citext;
regress=# CREATE TABLE citest ( x citext );
regress=# INSERT INTO citest(x) VALUES ('FRED'), ('FrEd');
regress=# SELECT * FROM citest;
  x   
------
 FRED
 FrEd
(2 rows) 
```

... citext 与未知字符串文字的比较将被解释为`citext=citext`不区分大小写：

```
regress=# SELECT * FROM citest WHERE x = 'FRED';
  x   
------
 FRED
 FrEd
(2 rows) 
```

...但是`citext`与显式`text`类型的文字之间的比较会将`citext`参数转换为`text`using`citext`的隐式转换为文本，然后进行`text=text` *区分大小写*的比较：

```
regress=# SELECT * FROM citest WHERE x = 'FRED'::text;
  x   
------
 FRED
(1 row) 
```

或者更确切地说，Hibernate 所做的将更接近于：

```
regress=# PREPARE blah(text) AS SELECT * FROM citest WHERE x = $1;
PREPARE
regress=# EXECUTE blah('FRED');
  x   
------
 FRED
(1 row) 
```

其中类型`text`在绑定参数时指定，因为 Hibernate“知道”字符串是`text`.

换句话说，您需要让 Hibernate 通过 PgJDBC 显式指定`citext`数据类型作为查询的参数类型，结果如下：

```
regress=# PREPARE blah(citext) AS SELECT * FROM citest WHERE x = $1;
PREPARE
regress=# EXECUTE blah('FRED');
  x   
------
 FRED
 FrEd
(2 rows) 
```

注意`citext`准备好的语句的显式类型参数。那将是……有趣的……做，特别是因为 PgJDBC 对类型一无所知`citext`。您必须为使用 PgJDBC 的 Hibernate 编写自定义数据类型处理程序`setObject`；即便如此，您也会在 Java 和 Pg 之间遇到运算符一致性问题（见下文）。

`lower()`IMO 使用传统的区分大小写的类型和,`ILIKE`等会更好。

Hibernate 也有可能依赖于 PgJDBC 告诉它的关于列区分大小写的内容。至少在 9.2-devel PgJDBC 对类型一无所知`citext`，所以当被问到时它总是说“是的，那是区分大小写的”。

## 追踪

如果没有看到 JPA 运行的实际查询，就很难确定发生了什么。尝试设置`log_statement = 'all'`在`postgresql.conf`. 然后`SIGHUP`postmaster，使用`pg_ctl reload`，或者重启 Pg 以使更改生效。

重新运行测试并检查日志。测试您看到的查询`psql`以观察结果。如果您不确定发生了什么，请向他们更新您的问题。如果您更新还包括您的 Hibernate 版本和您的 PgJDBC 版本。

Hibernate 也有可能依赖于 PgJDBC 告诉它的关于列区分大小写的内容。至少在 9.2-devel PgJDBC 对类型一无所知`citext`，所以当被问到时它总是说“是的，那是区分大小写的”。

## 算子一致性困难

**警告**：`citext`一旦文本从数据库中出来，该类型就不会影响 Hibernate 如何处理文本。例如，它不会对`String.equals`方法产生任何影响。您需要告诉*Hibernate*您希望它将文本视为不区分大小写。否则，如果您有一个`text`或`varchar`主/外键，您可能会遇到 Hibernate 要求该键的情况`"FRED"`，它会`"FrEd"`返回，并且非常困惑，因为数据库返回的键不等于 - 根据 Hibernate - 它的一个被要求。如果您在实体`citext`中包含 -backed 字符串`equals`和`hashCode`实现，则会发生类似的怪事。

不幸的是，JPA 似乎没有在`@Column`映射中指定列是否区分大小写的注释属性。Java无论如何都没有不[区分大小写的字符串数据类型的概念](https://softwareengineering.stackexchange.com/questions/89949/what-are-the-pros-and-cons-of-having-a-caseinsensitivestring-type-in-java)，因此即使 JPA 确实指定了它也不会有很多好处。

只要您不使用`citext`for 键或在and中包含`citext`值，您可能会避免过度混淆 Hibernate 。`equals``hashCode`

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-05-18T12:04:37.753

我是为了未来的读者而回答的。问题是 JDBC 自动将 String 参数转换为 varchar，从而强制比较区分大小写。可以通过将 JDBC 连接参数“ **stringtype** ”设置为“ **unspecified** ”来更改此行为。

如果您使用 JPA，请将以下内容放入数据源配置中：

```
<datasource jndi-name="java:jboss/datasources/testDS"
    pool-name="test" enabled="true"
    use-java-context="true" spy="true">
    <connection-url>jdbc:postgresql://localhost:5432/postgres</connection-url>
    <driver>postgresql</driver>
    <connection-property name="stringtype">unspecified</connection-property>
    <security>
        <user-name>postgres</user-name>
        <password>******</password>
    </security>
</datasource> 
```

# jquery - jQuery 发布按钮

> ID：12031615
> 
> 赞同：0
> 
> 时间：2012-08-20T02:18:36.863
> 
> 标签：jquery, ajax

我用 jQuery 创建了一个简单的 ajax 调用，但是每当我按下按钮提交时，我什么都没有返回。这很奇怪。我在 Firebug 上没有看到任何错误。ajax 文件确实存在。我对它有什么问题感到迷茫。

```
<script type="text/javascript" >

$('#post').click( function () {
var user_id = 1;
var receiver = 3;
var message = $('#message').val();
var the_type = $('#hidden').val();
    $.post('ajax_posting.php', 
    {
    user_id : user_id,
    receiver : receiver,    
    the_type : the_type,
        message : message   
    }, 
    function(data){
    $(data).appendTo('#response');}
    )});    

</script>

<form method="post">

    <input type="hidden" id="hidden" value="asdf" />

    <textarea id="message"></textarea>

    <input type="button" id="post"  value="Submit"/>

</form>

<div id="response"></div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T02:23:12.007

您可能会尝试在创建元素之前设置处理程序，以确保在设置处理程序之前加载您的 dom 将其包装在 $(document).ready

您还需要防止表单提交使用`event.preventDefault()`

```
$(document).ready(
    $('#post').click( function (event) {
        var user_id = 1;
        var receiver = 3;
        var message = $('#message').val();
        var the_type = $('#hidden').val();
        $.post('ajax_posting.php', 
            {
                user_id : user_id,
                receiver : receiver,    
                the_type : the_type,
                message : message   
            }, 
            function(data){
                $(data).appendTo('#response');
            }
        );
        event.preventDefault()
    }); 
); 
```

# html - 如何使页面不可滚动？

> ID：12031618
> 
> 赞同：21
> 
> 时间：2012-08-20T02:20:09.193
> 
> 标签：html, css, scroll

我正在处理一个包含垂直下拉菜单的页面。但是，当菜单下拉时，它会将其下方的文本向下推并离开页面。这是意料之中的，但这会启用页面侧面的滚动条。我想知道有没有办法摆脱这个。换句话说，它不应该只是不滚动，甚至不应该提供滚动选项。

谢谢！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-20T02:23:00.393

如果您不希望出现滚动条并且不发生任何滚动，请在`div`包含所述下拉列表的 CSS 中使用

```
overflow: hidden; 
```

不过，这将切断任何“附加内容”；[在这里](http://www.w3schools.com/cssref/tryit.asp?filename=trycss_overflow)看一个例子

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-20T02:22:42.553

`overflow: hidden;`在要隐藏滚动条的元素上使用。

# ios - 为什么我的媒体无法使用 AVFoundation 播放？

> ID：12031621
> 
> 赞同：0
> 
> 时间：2012-08-20T02:21:03.460
> 
> 标签：ios, xcode, avfoundation, media, wma

```
NSString *soundFileURL=[[NSBundle mainBundle]pathForResource:@"noise" ofType:@"wma"];

self.noise=[[AVAudioPlayer alloc]initWithContentsOfURL:[NSURL fileURLWithPath:soundFileURL] error:nil];

[self.noise play]; 
```

然后 main.m 有错误。当我使用大约 1 秒的短媒体时，它会起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T03:53:47.007

因为`AVFoundation`无法播放 Windows Media 音频 (WMA)。将您的“噪音”转换为支持的格式，例如 MP3 或 AAC。

# cross-domain - 解决 CDN 响应问题

> ID：12031622
> 
> 赞同：1
> 
> 时间：2012-08-20T02:21:07.220
> 
> 标签：cross-domain, cdn, google-cdn

在开发网站或访问网站时，我在从各种 CDN 下载文件时遇到问题。例如，我刚刚注册了 Shopify，在 Firefox 中首次加载商店时，它不会从[http://cdn.shopify.com](http://cdn.shopify.com)下载文件。[同样访问 stackoverflow.com 和其他网站，我在下载https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js](https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js)时也遇到了同样的问题，但没有响应。

我今天使用最新的 Firefox 14 和 Chrome 21 遇到了这两个问题。有时只是刷新文件就可以了，然后刷新，有时又没有响应。始终使用 CDN 文件（单独的域）。

我的问题是：

*   这是其他 Web 开发人员熟知的问题吗？
*   是什么导致 CDN 文件请求失败（在服务器之外只是停机或负载不足），是跨域问题吗？
*   除了自己托管文件之外，我们是否可以采取任何预防措施来防止这种情况发生？

# .htaccess - htaccess SetEnvIf true

> ID：12031623
> 
> 赞同：5
> 
> 时间：2012-08-20T02:21:20.737
> 
> 标签：.htaccess

如果我想在评估 RewriteRules 之前设置一个环境变量，[我必须使用`SetEnvIf`而不是`SetEnv`](http://httpd.apache.org/docs/2.2/mod/mod_env.html#setenv). 但是，`SetEnvIf`需要一个条件。事实上，我有：

```
SetEnvIf Request_Method ^ ENV=VALUE 
```

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T03:05:17.963

您可以使用 mod_rewrite 的`E`标志：

```
RewriteRule ^ - [E=ENV:VALUE] 
```

这将保证在应用规则之前（或之后）设置它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-25T12:01:58.003

使用 SetEnvIf 您可以执行以下操作：

```
SetEnvIf ENV  ^(.*)$ ENV=VALUE 
```

# ios - 我应该如何在 iOS 的 Facebook 好友列表中显示我的应用程序图标？

> ID：12031624
> 
> 赞同：0
> 
> 时间：2012-08-20T02:21:25.220
> 
> 标签：ios, xcode, facebook

我是处理将与 Facebook 连接的应用程序的新手。

我想让我的用户使用 Facebook 帐户登录我的应用程序，并能够向他们的 Facebook 朋友发送一些东西，例如礼物。

我想获取用户的朋友列表，使用 FBFriendPickerViewController 很容易。但是，我想要一个效果，如果他们的 Facebook 朋友也在使用我的应用程序，应用程序图标将显示在用户表格单元格的右侧（就像某些电话联系人列表将显示如果联系人有 Whatsapp/Google+）

我一直在搜索网站，但仍然一无所获。

所以我的问题是，是否有任何“官方”方式（使用 Facebook SDK 方法）来显示图标？

或者我一直在想另一种方法是，我先获取朋友列表，然后将其保存，其中包含“朋友”是否正在使用我的应用程序的信息。然后我创建一个自定义朋友选择器视图并检查启用/禁用应用程序图标可见性的条件。

我可以通过使用 GraphAPI 字段或使用外部数据库的方法来获取信息，[为此](https://stackoverflow.com/questions/7956639/replacement-for-old-getappusers-call-to-see-a-users-friends-who-use-my-app)，[this](https://stackoverflow.com/questions/7298172/need-help-getting-list-of-friends-using-the-same-application-in-facebook-using-j) 和[this](https://stackoverflow.com/questions/8475155/how-to-find-facebook-friends-using-the-same-app) .....

有人帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T06:57:09.853

好的，我最终定制了我自己的表格视图...... :)

# php - ajax 请求的智能验证码

> ID：12031628
> 
> 赞同：0
> 
> 时间：2012-08-20T02:21:49.370
> 
> 标签：php, ajax, captcha

我想使用验证码发出安全的 ajax 请求以防止垃圾邮件

我的问题是当页面有 2 个这样的请求时：

按钮 1 - 按钮 2

如果我单击按钮 1 或按钮 1，验证码会发生变化

这段代码也许可以理解我的问题

**索引.HTML**

```
<script>
var code_captcha = 1234; // generated by php
</script>
<inpt type="button" value="Request 1" onclick="ajax_request('send_message.php', captcha = code_captcha);" />
<inpt type="button" value="Request 2" onclick="ajax_request('add_comment.php', captcha = code_captcha);" /> 
```

**send_message.php / add_comment ....**

```
<?
session_start();
$code = $_SESSION["code"];
if ($code == $_POST[code_captcha]){
    echo 'status:ok';
    $_SESSION["code"] = "";
}else{
    echo 'status:error';
}
?> 
```

该行清除验证码**$_SESSION["code"] = "";** .

所以如果我第一次点击请求 100% 我返回一个**ok 状态**

但是如果我第二次单击请求 100% 我会返回**错误**，因为会话已清除

任何想法，并提前感谢

**如果您是 vBulletin 编码员，我认为您在标头中看到了没有垃圾评论、消息等的标记**

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-20T02:31:00.810

我知道这不能解决你的问题

“我想使用验证码发出安全的 ajax 请求以防止垃圾邮件”问题

但是，我想解决您的无垃圾邮件问题。从可用性的角度来看，验证码对用户来说很糟糕。这里的那个人至少拒绝了我 3 次，因为显然，我不是人类。独特而有创意。获取/创建您自己的字符串表，向用户询问计算机无法解决的问题，然后在那里创建答案。

我知道。我知道。这听起来像是更多的工作，但想想你的用户。

# c# - WCF MessageSecurityException：安全时间戳无效，因为它的创建时间

> ID：12031636
> 
> 赞同：2
> 
> 时间：2012-08-20T02:23:01.230
> 
> 标签：c#, .net, wcf

我有一个连接到我们的 WCF 服务以发送数据的应用程序。它使用自定义用户验证来验证用户。

目前，如果客户端时间与我们服务器的时间显着不同（默认为 5 分钟），则此错误将导致连接出错。

我正在尝试捕获此特定错误，以便在服务器端，我可以在它发生时通知某人以及它发生的用户/客户端。

我想这样做是因为允许更大的时钟偏差不会解决我们的问题，客户端的机器时间可能会有很大的变化。我们不控制客户端机器，但是我们可以让他们更新他们的时间。

我试图在 validate 方法中放置一个通用的 try/catch，并且它确实捕获了其他异常（例如，如果身份验证失败 - 我抛出一个 FaultException），它似乎没有捕获时钟偏差问题。我猜这不是抓住这个的正确地方，但我不知道它应该去哪里。

我将实现传递客户端时间作为登录的一部分（正如我在其他地方看到的那样），但是我现在无法做到这一点，并且确实需要一种方法来识别同时具有不正确日期/时间的客户端。

如果有帮助，该服务正在使用：**basicHttpBinding**，其安全模式为：**TransportWithMessageCredential**

# java - Java Swing 已弃用，取而代之的是 JavaFx 2.0

> ID：12031637
> 
> 赞同：7
> 
> 时间：2012-08-20T02:23:02.953
> 
> 标签：java, swing, javafx, java-2d

Oracle 已弃用 Swing 并且 JavaFx 2.0 是它的官方替代品，我是否正确？

这对我来说是有道理的，因为对于 oracle 来说，维持两个竞争 api 的开发几乎是一样的事情似乎有点愚蠢。然而，Oracle 已经在 java 7 swing api 中引入了半透明窗口、形状窗口等增强功能。我认为这可能是出于过渡目的，但如果有人能告诉我当前的“标准”或“最佳实践”选择对于新应用程序 - Swing 还是 javafx 2.0，我将非常感激？另一个悬而未决的问题似乎是 Java 2D 的命运。既然另一个图形引擎 Prism 是 JavaFx 2.0 的基础，那么掌握该 API 是否值得？

非常感谢，马克

# c# - 如何替换字符串中的某些字符？

> ID：12031643
> 
> 赞同：-1
> 
> 时间：2012-08-20T02:23:24.870
> 
> 标签：c#, string, replace

我正在尝试解决问题并需要解决方案（好的-我可能会得到负面的代表）但是这里是：

假设我有以下内容：

```
Actual: A B D E F G H I J K L M N O P Q R S T U V W X Z 
Change: X F S M E P U T V L Q H K I J W A D O R Z B G N 
```

而且，基本上，我想用“更改”列表中的相应字符替换“实际”列表中包含的字符串中的所有字符。如果某些字符不在“实际”列表中，它必须保持不变。

我试图这样做，但是，它不起作用：

```
foreach (var c in charList) {
    if (input.Contains (c.Key)) {
        foreach (var a in charList) {
            decrypted[i] = a.Key;
        }
        i++;
    }
} 
```

我基本上只是得到“N”值..有什么想法吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T04:29:19.390

我的即兴创作：

1.首先创建一个字典

```
 List<char> Actual = "A B D E F G H I J K L M N O P Q R S T U V W X Z".Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries).Select(s => s[0]).ToList();
        List<char> Change = "X F S M E P U T V L Q H K I J W A D O R Z B G N".Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries).Select(s => s[0]).ToList();
        Dictionary<char, char> ReplacemetRules = Actual.ToDictionary(s => s, s => Change[Actual.IndexOf(s)]); 
```

要不就

```
Dictionary<char, char> ReplacemetRules = new Dictionary<char, char>
        {
            {'T','F'},
            {'E','A'},
            {'S','Q'}
        }; 
```

2.假设我们有一个输入字符串：

```
 string input = "TEST"; 
```

然后只需使用：

```
 string output = string.Concat(input.Select(c => ReplacemetRules.ContainsKey(c) ? ReplacemetRules[c] : c))); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T02:34:00.770

看一下这个：

```
 string InputString = "TEST";
        string EncryptedString = string.Empty;
        string IfContains =  "ABDEFGHIJKLMNOPQRSTUVWXZ";
        string ReplaceWith = "XFSMEPUTVLQHKIJWADORZBGN";

        foreach (char InputChar in InputString)
        {
            int IndexToReplace = IfContains.IndexOf(InputChar);

            if (IndexToReplace >= 0)
            {
                EncryptedString = string.Concat(EncryptedString, ReplaceWith[IndexToReplace]);
            }
        } 
```

**更新**：你应该注意案例。执行不区分大小写的搜索将是一个更好的主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-14T03:51:37.690

```
foreach (var c in charList) {
    if (input.Contains (c.Key)) {
        foreach (var a in charList) {
            decrypted[i] = a.Key;
        }

        i++;
    }
} 
```

# joomla - 将 Joomla 2.5 模块加载到另一个模块中

> ID：12031648
> 
> 赞同：1
> 
> 时间：2012-08-20T02:24:46.680
> 
> 标签：joomla, module, position, joomla2.5, loadmodule

我已经看到了[Loading a module in another module in Joomla](https://stackoverflow.com/questions/3770303/loading-a-module-in-another-module-in-joomla)的问题，但那是关于 Joomla 1.5

我对 Joomla 2.5 有完全相同的问题

有官方的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T04:36:51.097

如果您使用的是“自定义 HTML”模块，则标准`{loadposition myPosition}`或`{loadmodule myModuleTypesName}`按预期工作。

你的意思是别的吗？

我还使用以下信息更新了[wiki 文章。](http://docs.joomla.org/How_do_you_put_a_module_inside_an_article%3F "Joomla！ 医生的文章")

### 加载模块

“{loadposition xx}”的替代方案是由同一插件处理的“{loadmodule yyy}”变体。在这种情况下，插件会查找类型与字符串“yyy”匹配的第一个模块。因此，您可以通过在文本中放置 {loadmodule login} 来加载“mod_login”模块。

### 模块中的模块

在 Joomla 中是可能的！2.5+（可能更早）在“自定义 HTML”模块中包含一个模块，因为它们由内容插件以与文章相同的方式处理。您应该记住，在执行此操作时，您可能会遇到格式问题，因为“自定义 HTML”模块的“镶边”将包围包含的模块的“镶边”，可能会对格式或布局产生不良影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-25T13:31:19.027

您可以使用此扩展程序，希望这可以帮助您

[http://www.nonumber.nl/extensions/modulesanywhere](http://www.nonumber.nl/extensions/modulesanywhere)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-16T07:50:04.083

在自定义 HTML 模块中`Options Tab`，我设置`Prepare Content`为“是”，允许加载其他模块和位置。

**Joomla 2.5**

[![](../Images/b40a97d1dcfb0d0c206c995c147e8cc4.png)](https://s3.postimg.org/5vxoaz11f/image.png)

**Joomla 3**

[![](../Images/653ff14d37a18dae66c2afa345732896.png)](https://s15.postimg.org/z4pskhrsb/image.png)

# java - 创建一个树状的java对象层次结构

> ID：12031653
> 
> 赞同：0
> 
> 时间：2012-08-20T02:26:40.017
> 
> 标签：java, android, parsing, rss

我正在尝试为 Android 创建一个漫画应用程序，其中每个章节都有自己的标题、出版日期、描述等。每个章节都属于一个漫画对象。这将是章节的集合，并且将包括标题列表以及漫画本身的标题和作者姓名。数据本身将从不同的网页解析（但这是另一回事）。

我的困惑是关于类声明。（即实现，扩展）

我已经尝试了很多东西，但到目前为止，我的代码包括将章节作为内部类，如下所示：

```
public abstract class Manga implements MangaList {
public String name;
public String author;
public int chapters;

// names of the XML tags
static final String CHANNEL = "channel";
static final String PUB_DATE = "pubDate";
static final  String DESCRIPTION = "description";
static final  String LINK = "link";
static final  String TITLE = "title";
static final  String ITEM = "item";

private final URL feedUrl;

protected Manga(String feedUrl){
    try {
        this.feedUrl = new URL(feedUrl);
    } catch (MalformedURLException e) {
        throw new RuntimeException(e);
    }
}

protected InputStream getInputStream() {
    try {
        return feedUrl.openConnection().getInputStream();
    } catch (IOException e) {
        throw new RuntimeException(e);
    }
}

List<Chapter> Chapter;

public class Chapter implements Comparable<Chapter> {

    final SimpleDateFormat FORMATTER = 
            new SimpleDateFormat("EEE, dd MMM yyyy HH:mm:ss Z");
        private String title;
        private URL link;
        private String description;
        private Date date;

        public String getTitle() {
            return title;
        }

        public void setTitle(String title) {
            this.title = title.trim();
        }
        // getters and setters omitted for brevity 
        public URL getLink() {
            return link;
        }

        public void setLink(String link) {
            try {
                this.link = new URL(link);
            } catch (MalformedURLException e) {
                throw new RuntimeException(e);
            }
        }

        public String getDescription() {
            return description;
        }

        public void setDescription(String description) {
            this.description = description.trim();
        }

        public String getDate() {
            return FORMATTER.format(this.date);
        }

        public void setDate(String date) {
            // pad the date if necessary
            while (!date.endsWith("00")){
                date += "0";
            }
            date = "";
            try {
                this.date = FORMATTER.parse(date.trim());
            } catch (ParseException e) {
                throw new RuntimeException(e);
            }
        }

        public Chapter copy(){
            Chapter copy = new Chapter();
            copy.title = title;
            copy.link = link;
            copy.description = description;
            copy.date = date;
            return copy;
        }

        @Override
        public String toString() {
            StringBuilder sb = new StringBuilder();
            sb.append("Title: ");
            sb.append(title);
            sb.append('\n');
            sb.append("Date: ");
            sb.append(this.getDate());
            sb.append('\n');
            sb.append("Link: ");
            sb.append(link);
            sb.append('\n');
            sb.append("Description: ");
            sb.append(description);
            return sb.toString();
        }

        @Override
        public int hashCode() {
            final int prime = 31;
            int result = 1;
            result = prime * result + ((date == null) ? 0 : date.hashCode());
            result = prime * result
                    + ((description == null) ? 0 : description.hashCode());
            result = prime * result + ((link == null) ? 0 : link.hashCode());
            result = prime * result + ((title == null) ? 0 : title.hashCode());
            return result;
        }

        @Override
        public boolean equals(Object obj) {
            if (this == obj)
                return true;
            if (obj == null)
                return false;
            if (getClass() != obj.getClass())
                return false;
            Chapter other = (Chapter) obj;
            if (date == null) {
                if (other.date != null)
                    return false;
            } else if (!date.equals(other.date))
                return false;
            if (description == null) {
                if (other.description != null)
                    return false;
            } else if (!description.equals(other.description))
                return false;
            if (link == null) {
                if (other.link != null)
                    return false;
            } else if (!link.equals(other.link))
                return false;
            if (title == null) {
                if (other.title != null)
                    return false;
            } else if (!title.equals(other.title))
                return false;
            return true;
        }

        public int compareTo(Chapter another) {
            if (another == null) return 1;
            // sort descending, most recent first
            return another.date.compareTo(date);
        }
} 
```

我的问题是这是否是一种适当的格式，或者是否有一种更简单的方法来创建漫画列表，每个漫画都有自己的章节集？

编辑：我查了一下并决定使用 SQLite 数据库将是一种更简单的方法来跟踪我将解析的大量数据。

这样我可以维护两个数据库。一个用于漫画标题和作者，另一个用于章节和相关信息。相关章节将通过参考 ID 链接到每个表中的漫画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:35:14.327

我绝对认为有一种更简单的方法可以做到这一点；但是，这实际上取决于您的总体目标是什么。如果您尝试将其显示在`list`您可能会考虑使用的 中`ListView`，但如果您只是将数据用于内容，那么您可能会做与您所拥有的类似的事情。最终，您需要弄清楚您将要使用该应用程序做什么，然后您才能找出实现它的最简单方法。但请记住：更容易并不总是更好。尝试从长远角度考虑您的项目，例如谁将维护它，它会增长还是缩小，以及您是否会添加功能。

至于`extends`and`implements`它们分别是`subclasses`和`interfaces`并且有不同的规则，更多信息可以在这里找到：http: [//docs.oracle.com/javase/tutorial/java/concepts/interface.html](http://docs.oracle.com/javase/tutorial/java/concepts/interface.html)

祝你好运！

# java - (Java) 阅读器无缘无故不断删除文本

> ID：12031654
> 
> 赞同：1
> 
> 时间：2012-08-20T02:26:51.680
> 
> 标签：java, file, text, random

我遇到了这个非常烦人的错误。我已经为此工作了好几天，并且进行了大量的研究，但没有成功。基本上，代码在做什么，是读取文件，但似乎在读取文件后删除了文本。而且只有某些行。这是我的阅读器方法：

```
synchronized public static String getValue(String path, String filename, Boolean useColors, String folder){
    try{
        while(!TxtWriter.isResting());
        FileRequest req =  writer.getRelitive(filename, path);
        if(req==null){
            File f = new File(Conquest.FilePaths+"/"+folder, filename);
            if(!f.getParentFile().exists())f.getParentFile().mkdirs();
            if(f.exists()){
                BufferedReader in = new BufferedReader(new FileReader(f));
                String a;
                while((a=in.readLine())!=null){
                    if(a.startsWith("'"+path+"'"+":")){
                        in.close();
                        a=a.substring(path.length()+3);
                        if(useColors)a=colorCoder(a);
                        return a;
                    }
                }
                in.close();
            }else TxtWriter.createFile(filename, folder);
        }else return ((useColors)?colorCoder(req.getMessage()):req.getMessage());
    }catch(Exception e){
        System.err.println("[Conquest/TxtReader] Error reading file "+filename+"!");
        e.printStackTrace();
    }
    return null;
} 
```

这是阅读前的文件：

`'Kingdom':Devonel`

`'Flags':Leader`

我调用方法

```
public String getPlayerKingdom(String p){
    String in = TxtReader.getValue("Kingdom", p+".txt", false, "Citizens");
    return ((in==null)?in:"None");
} 
```

它返回“None”，文件现在只有`'Flags':Leader`，没有别的了。

真正让我感到困惑的是，某些方法有效，而其他方法则无效。即使它们是完全相同的代码，但具有不同的字符串。这个方法在这里是一样的，但它的工作原理和它应该的一样。

```
public int getResource(String kingdom, String name){
    String out = TxtReader.getValue("R-" + name, kingdom + ".txt", false, "Kingdoms");
    if(out==null)return 0;
    return Integer.valueOf(out);
} 
```

如果有人可以提供帮助，我将不胜感激。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T02:35:07.797

这一行看起来不对：

```
return ((in==null)?in:"None"); 
```

不应该反过来吗？

```
return ((in==null)?"None":in); 
```

出于这个原因，我不喜欢三元运算符构造。只需使用 if/else 块并清楚您在做什么。

此外，BufferedReader 不会从文件中删除信息。时期。它只是*读取*信息，没有别的。如果要删除一行，则程序中可能存在另一个错误，可能是在未显示的代码中导致此错误。

但无论错误的来源是什么，您的代码看起来都非常低效且容易出错。为什么每次需要检查匹配项时都尝试重新读取文件？为什么不简单地读取文件一次，然后将信息存储在一个`HashMap<String, String>`?

# c# - 如何在不使用 JavaScript 的情况下在用户的时区显示日期/时间客户端？

> ID：12031661
> 
> 赞同：1
> 
> 时间：2012-08-20T02:28:14.317
> 
> 标签：c#, asp.net-mvc-3, date, utc

假设我有以下内容`DateTime`: `DateTime.UtcNow`，并且我想根据用户的时区在客户端上显示它，并且不会重复到`JavaScript`.

我应该怎么做？我想我应该从某个地方获取当前请求的时区，不知何故，基于用户IP或其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T04:55:49.930

据我所知，使用 IP 地址到物理地址的转换服务是 JavaScript 的唯一“自动”且可靠的替代方案。根据您希望 IP 地址到物理位置转换的准确程度，您可能需要转向付费服务（我在想，如果用户靠近时区边界，您可能会错误地放置它们）。

我还遇到了将 IP 地址范围与国家/地区相匹配的免费可下载数据库。但是这些确实会不时更改，并且可能已过时。我会提供一个链接，但不久前我发现了这个。希望知道这种事情就在那里会有所帮助。

您应该考虑到，您的用户可能希望手动设置他们的首选时区，以防他们旅行但仍希望看到相同的时间（我在工作中遇到的情况）。

请记住，JavaScript 是最简单的解决方案和最可靠的解决方案，所以如果您可以使用它......去吧

**更新：**

我在这里发现了一个类似的问题，几乎涵盖了它[如何在 c# 中获取当前用户时区](https://stackoverflow.com/questions/8194016/how-to-get-current-user-timezone-in-c-sharp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T03:35:40.923

您可以尝试使用类似
[http://www.geobytes.com/iplocator.htm](http://www.geobytes.com/iplocator.htm)

# android - TimePickerDialog 和 Jelly Bean，onTimeSet 在取消时触发

> ID：12031663
> 
> 赞同：3
> 
> 时间：2012-08-20T02:29:13.427
> 
> 标签：android, timepicker, android-4.2-jelly-bean

如果我在 Jelly Bean 中使用 TimePickerDialog，对话框没有取消按钮，无论我做什么（比如尝试返回按钮），onTimeSet 都会触发，所以我无法知道用户是否没有'不想采取行动与否。

我尝试添加 onCancel 和 onDismiss 处理程序，但取消是在 onTimeSet 处理程序之后调用的。

在 ICS、GB 上，有一个可以正常工作的取消按钮。

创建默认应用程序，将 Button 添加到布局

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <Button
        android:id="@+id/Button01"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Show Me" >
    </Button>

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world"
        tools:context=".MainActivity" />

</RelativeLayout> 
```

然后在主代码中有以下内容：

```
package com.example.example;

import android.os.Bundle;
import android.app.Activity;
import android.app.Dialog;
import android.app.TimePickerDialog;
import android.content.DialogInterface;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.TimePicker;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {   
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button button = (Button) findViewById(R.id.Button01);
        button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Dialog d = new TimePickerDialog(MainActivity.this, new TimePickerDialog.OnTimeSetListener() {
                    @Override
                    public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
                        Log.i("Hello", "onTimeSet called");
                    }
                }, 8, 0, false);
                d.setCancelable(true);
                d.setOnCancelListener(new TimePickerDialog.OnCancelListener() {

                    @Override
                    public void onCancel(DialogInterface dialog) {
                        Log.i("Hello", "onCancel called");

                    }
                });

                d.setOnDismissListener(new TimePickerDialog.OnDismissListener() {

                    @Override
                    public void onDismiss(DialogInterface dialog) {
                        Log.i("Hello", "onDismiss called"); 
                    }
                });

                d.show();
            }
        });   
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T21:35:29.953

在[修复错误](https://stackoverflow.com/questions/11444238/jelly-bean-datepickerdialog-is-there-a-way-to-cancel)之前，我建议不要使用 DatePickerDialog 或 TimePickerDialog 使用定制的 AlertDialog 和 TimePicker/DatePicker 小部件；

更改 TimePickerDialog 为；

```
 final TimePicker timePicker = new TimePicker(this);
    timePicker.setIs24HourView(true);
    timePicker.setCurrentHour(20);
    timePicker.setCurrentMinute(15);

    new AlertDialog.Builder(this)
            .setTitle("Test")
            .setPositiveButton(android.R.string.ok, new OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int which) {
                    Log.d("Picker", timePicker.getCurrentHour() + ":"
                            + timePicker.getCurrentMinute());
                }
            })
            .setNegativeButton(android.R.string.cancel,
                    new OnClickListener() {

                        @Override
                        public void onClick(DialogInterface dialog,
                                int which) {
                            Log.d("Picker", "Cancelled!");
                        }
                    }).setView(timePicker).show(); 
```

更改 DatePickerDialog 为；

```
 final DatePicker datePicker = new DatePicker(this);
    datePicker.init(2012, 10, 5, null);
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
        datePicker.setCalendarViewShown(false);
    }

    new AlertDialog.Builder(this)
            .setTitle("Test")
            .setPositiveButton(android.R.string.ok, new OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int which) {
                    Log.d("Picker", datePicker.getYear() + " "
                            + (datePicker.getMonth() + 1) + " "
                            + datePicker.getDayOfMonth());
                }
            })
            .setNegativeButton(android.R.string.cancel,
                    new OnClickListener() {

                        @Override
                        public void onClick(DialogInterface dialog,
                                int which) {
                            Log.d("Picker", "Cancelled!");
                        }
                    }).setView(datePicker).show(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-16T17:42:48.400

根据 Ankur Chaudhary 的精彩[回答](https://stackoverflow.com/a/26034036/905801)，只需执行以下操作：

```
new TimePickerDialog.OnTimeSetListener() {
    @Override
    public void onTimeSet(TimePicker view, int setHour, int setMinute) {  
        if (view.isShown()) {
            // read the time here :)
        }
    }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T00:33:40.610

好的，看起来 DatePicker [here](https://stackoverflow.com/questions/11444238/jelly-bean-datepickerdialog-is-there-a-way-to-cancel)有类似的错误，但我必须在调用 setButton() 之前通过将 Dialog 转换为 AlertDialog 来修改我的代码

```
((AlertDialog) d).setButton(DialogInterface.BUTTON_NEGATIVE, "Cancel", 
                    new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int which) {
                    // Turn on your cancel flag here
                }
            }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T11:58:04.163

尝试使用活动焦点（`Activity.onWindowFocusChanged()`）。它应该在`Dialog`弹出时改变

# iphone - tableview 开头的常量 tableviewcell

> ID：12031671
> 
> 赞同：0
> 
> 时间：2012-08-20T02:30:11.677
> 
> 标签：iphone, ios, uitableview

我想知道是否有任何偷偷摸摸的方法让 a`UITableViewCell`出现在 a 的开头，`UITableView`无论要填充 tableview 的数组包含什么？

我有问题，我想在表格视图的顶部有一个“全选”单元格，但目前在尝试调整我要进入的数组时遇到问题`tableView:cellForRowAtIndexPath:`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:55:03.980

不确定您的最终目标，但根据您的需要，有很多方法比其他方法更容易（偷偷摸摸的方法）。听起来您的项目是相当静态的，因此您可以在显示或更新表格行之前插入它们。

假设您有一个名为 self.items 的数据源，并且您做了一些事情来获取数据。也许在您的应用程序中，您正在根据输入往返于某些数据源，例如排序选择器或来自搜索栏委托。

在加载数据源的区域尝试类似的操作。

```
NSString *myCustomObject = @"Jump To Songs";
self.items = [self getGetMovieList];
[self.items insertObject:myCustomObject atIndex:0];
[self.tableView reloadData]; 
```

另一种简单的方法是将部分添加到您的表格中，并将第一部分作为您的导航项。

注意：您可能需要处理 didSelectRowAtIndexPath 中的操作......

你去吧，不是那么偷偷摸摸，但很简单。好起来

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T02:42:30.627

您可以制作两种类型的`UITableViewCell`，然后返回“全选”一种 if `indexPath.row == 0`。

另一方面，如何`UIView`为“全选”功能创建一个，并将其设置为`tableHeaderView`您的表格视图？

# node.js - 哪个 Node.js 并发 Web 服务器在 Heroku 上最好？

> ID：12031679
> 
> 赞同：0
> 
> 时间：2012-08-20T02:32:00.263
> 
> 标签：node.js, heroku, webserver, concurrent-programming

我刚刚了解了 Heroku，并且非常兴奋地对其进行测试。我很快用 Node.js 语言组装了他们的演示并偶然发现了一个问题。在本地运行应用程序时，apache 基准测试打印大约 3500 个请求/秒，但当它在云上下降到 10 个请求/秒并且不会根据网络延迟增加或降低时。我不敢相信这是他们要求每小时 5 美分的性能，并且高度怀疑我的应用程序不是多线程的。

这是我的 code.js：[http ://pastebin.com/hyM47Ue7](http://pastebin.com/hyM47Ue7)

我需要应用什么配置才能让它在 Heroku 上“运行”（更快）？或者我可以使用哪些其他的 node.js 网络服务器？

我感谢关于这个主题的每一个答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T03:02:56.503

你是对的，网络服务器不是多线程的，除非你为更多的[网络 dynos](http://www.heroku.com/pricing#0-0)付费。我发现 Heroku 对原型设计很方便。根据您时间的货币价值，您可能希望也可能不希望使用它来设置可扩展的服务器，而不是直接使用 EC2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T10:03:21.370

你的小例子不是多线程的。（甚至在您自己的机器上也不需要。）但是您不需要立即为更多的测功机付费，因为您可以在测功机上使用多个内核，请参阅此答案[Running Node.js App with cluster module is meaning in Heroku?](https://stackoverflow.com/questions/11410226/running-node-js-app-with-cluster-module-is-meaningless-in-heroku)

重复这个答案：使用应该增加吞吐量的多个进程的节点解决方案是使用（内置）[集群模块](http://nodejs.org/docs/latest/api/cluster.html#cluster_how_it_works)。

我猜你可以很容易地从 heroku dyno 获得超过 10 req/s 而没有问题，请参阅这个基准，例如：

[http://openhood.com/ruby/node/heroku/sinatra/mongo_mapper/unicorn/express/mongoose/cluster/2011/06/14/benchmark-ruby-versus-node-js/](http://openhood.com/ruby/node/heroku/sinatra/mongo_mapper/unicorn/express/mongoose/cluster/2011/06/14/benchmark-ruby-versus-node-js/)

你用什么来做基准测试？

# javascript - 获取字符串中与正则表达式匹配的所有子字符串

> ID：12031681
> 
> 赞同：5
> 
> 时间：2012-08-20T02:32:09.817
> 
> 标签：javascript, regex

> **可能重复：**
> [如何使用 JavaScript 中的正则表达式匹配多个匹配项，类似于 PHP 的 preg_match_all()？](https://stackoverflow.com/questions/520611/how-can-i-match-multiple-occurrences-with-a-regex-in-javascript-similar-to-phps)

在 Javascript 中，是否可以找到与正则表达式匹配的字符串中所有子字符串的开始和结束索引？

函数签名：

```
function getMatches(theString, theRegex){
    //return the starting and ending indices of match of theRegex inside theString
    //a 2D array should be returned
} 
```

例如：

```
getMatches("cats and rats", /(c|r)ats/); 
```

应该返回数组`[[0, 3], [9, 12]]`，它表示字符串中“cats”和“rats”的开始和结束索引。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-20T02:35:24.250

用于`match`查找与正则表达式匹配的所有子字符串。

```
> "cats and rats".match(/(c|r)ats/g)
> ["cats", "rats"] 
```

现在您可以使用`indexOf`and`length`来查找开始/结束索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T02:39:02.653

```
function getMatches(theString, theRegex){
    return theString.match(theRegex).map(function(el) {
        var index = theString.indexOf(el);
        return [index, index + el.length - 1];
    });
}
getMatches("cats and rats", /(c|r)ats/g); // need to use `g` 
```

# r - 时间顺序（小时）

> ID：12031682
> 
> 赞同：14
> 
> 时间：2012-08-20T02:32:27.853
> 
> 标签：r, datetime, time-series, sequence

我试过：

```
seq(
     from=as.POSIXct("2012-1-1 0", tz="UTC"),
     to=as.POSIXct("2012-1-3 23", tz="UTC"),
     by="hour"
   ) 
```

但我只得到最后一天的 1 小时（0:00:00）而不是 24 小时，实际上一天中的任何一个小时都只有一个小时（0:00:00），我确实想要 2012-1 -4。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-20T02:39:26.230

详细说明时间？

```
seq(
     from=as.POSIXct("2012-1-1 0:00", tz="UTC"),
     to=as.POSIXct("2012-1-3 23:00", tz="UTC"),
     by="hour"
   ) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-20T02:39:18.020

您没有对日期使用标准格式。见`?as.POSIXct`。

试试这个

```
seq(from=as.POSIXct("2012-01-01 00:00:00", tz="UTC"), 
    to=as.POSIXct("2012-01-03 23:00:00", tz="UTC"), by="hour") 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-20T04:19:09.123

您可以指定格式：

```
seq(
     from=as.POSIXct("2012-1-1 0","%Y-%m-%d %H", tz="UTC"),
     to=as.POSIXct("2012-1-3 23", "%Y-%m-%d %H", tz="UTC"),
     by="hour"
   ) 
```

# ios5 - 从核心数据加载大图，10 次后内存使用量激增

> ID：12031687
> 
> 赞同：3
> 
> 时间：2012-08-20T02:33:33.477
> 
> 标签：ios5, core-data

在我的 iOS 应用程序中，我有一个启用了分页的 UIScrollView。每个页面显示一个视图（带有多个子视图）；任何时候只加载 3 个“页面”——当前查看的页面、左侧的页面和右侧的页面。加载是在后台懒惰地完成的。该应用程序正在使用 ARC。

每个页面上的视图主要由一个图像组成，该图像是从 Core Data 中检索出来的。此图像可能很大，因此先加载缩略图，然后将其替换为较大的图像。这个更大的图像实际上是数据存储中实际内容的缩小版本 - 不同的屏幕需要全分辨率版本，但对于这个图像滚动器，它只需要适合页面即可。实际存储的图像可能要大得多（来自相机的照片为 2448x3264）。请注意，Core Data 中的 image 属性设置为允许外部存储，因此在大多数情况下，它不会存储在 SQLite 数据库中。

一切都“工作正常”：滚动条和图像加载速度很快（首先是缩略图，然后是更大的图像），并且滚动速度很快。根据 Instruments 的说法，内存使用情况也很好——直到第 11 张图像加载，此时内存峰值增加了约 5MB；随后加载的图像可能会导致更多的内存峰值（不是每一个，可能每隔一个会导致另一个 ~5MB 峰值）。没有特定的图像导致峰值（我已经更改了加载图像的顺序，它始终是第 11 个）。这段记忆似乎永远不会被释放。

这是在后台加载图像的代码片段：

```
- (void)loadImageWithCardInstanceObjectId:(NSManagedObjectID *)cardInstanceObjectId
                           imageIndex:(NSUInteger)imageIndex
              withInitialImageHandler:(void (^)(UIImage *image))initialImageHandler
                withFinalImageHandler:(void (^)(UIImage *image))finalImageHandler
{
    NSManagedObjectContext *tempMoc = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
    tempMoc.parentContext = [[DataManager sharedInstance] managedObjectContext];

    [tempMoc performBlock:^{
        CardInstance *ci = (CardInstance *)[tempMoc objectWithID:cardInstanceObjectId];
        if (ci.cardInstanceImages.count == 0) {
            // no card images, return the default image
            dispatch_async(dispatch_get_main_queue(), ^{
                initialImageHandler([UIImage imageNamed:@"CardNoImage.png"]);
            });
            return;
        }

        // have card images, pick the one according to the passed in index
        UIImage *thumbnail = [[ci.cardInstanceImages objectAtIndex:imageIndex] thumbnailRepresentation];
        dispatch_async(dispatch_get_main_queue(), ^{
            initialImageHandler(thumbnail);
        });

        // THIS IS THE OFFENDING LINE
        UIImage *fullImage = [[ci.cardInstanceImages objectAtIndex:imageIndex] imageRepresentation];

        CGSize size = fullImage.size;
        CGFloat ratio = 0;
        if (size.width > size.height) {
            ratio = 240.0 / size.width;
        }
        else {
            ratio = 240.0 / size.height;
        }
        CGRect rect = CGRectMake(0.0, 0.0, ceilf(ratio * size.width), ceilf(ratio * size.height));

        // create the image to display
        UIGraphicsBeginImageContextWithOptions(rect.size, YES, 0);
        [fullImage drawInRect:rect];
        UIImage *imageToDisplay = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();

        dispatch_async(dispatch_get_main_queue(), ^{
            finalImageHandler(imageToDisplay);
        });
    }];
} 
```

在工具中，负责分配的库/调用者是 CoreData +[_PFRoutines readExternalReferenceDataFromFile:]。

关于为什么会发生这种内存峰值的任何想法？谢谢

# c# - 如何在 Dapper 中使用 IN

> ID：12031690
> 
> 赞同：6
> 
> 时间：2012-08-20T02:33:52.437
> 
> 标签：c#, dapper

我不确定这是否正确。有一个更好的方法吗：

```
public List<Category> ManyCategories(IEnumerable<int> cats)
{
     string categoriesJoined = string.Join(",", cats);
     using (var conn = new SqlConnection())
     {
          conn.Open();

          //make this a union all
          return _categories = conn.Query<Category>("select Id, ParentId, Name from [Meshplex].[dbo].Category where Id IN (@joined)", new { joined = categoriesJoined }).ToList();
      }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T02:39:54.550

[http://code.google.com/p/dapper-dot-net/#List_Support](http://code.google.com/p/dapper-dot-net/#List_Support)

```
 //string categoriesJoined = string.Join(",", cats);
 using (var conn = new SqlConnection())
 {
      conn.Open();

      //make this a union all
      return _categories = conn.Query<Category>("select Id, ParentId, Name from [Meshplex].[dbo].Category where Id IN @joined", new { joined = cats}).ToList();
  } 
```

# python - 字符串格式化时Python sqlite3操作错误？

> ID：12031694
> 
> 赞同：0
> 
> 时间：2012-08-20T02:34:24.733
> 
> 标签：python, sqlite, string-formatting

我有这个小的装饰器函数，我将在表中找到未知数量的条目：

```
def Deco(func):
     func
     conn = sqlite3.connect('/home/User/vocab_database/vocab.db')
     with conn:
         cur = conn.cursor()
         cur.execute("SELECT name FROM sqlite_master WHERE type='table'")
         total = cur.fetchall()
         print "You have %d tables " % len(total)

       ## this line below, is where I wanted to use a formatted string ##
         cur.execute("SELECT * FROM %s") % total[0]
         entries = cur.fetchall()
         print "You have %d entries" % len(entries) 
```

然后我收到此错误消息：

```
Traceback (most recent call last):
  File "./database_trial.py", line 19, in <module>
    class Vocab:
  File "./database_trial.py", line 25, in Vocab
    @Deco        
  File "./database_trial.py", line 15, in Deco
    cur.execute("SELECT * FROM %s") % total[0]
sqlite3.OperationalError: near "%": syntax error 
```

sqlite3 只接受`?`运算符吗？还是我在搞砸什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T02:54:45.460

您正在尝试替换元数据，所以很遗憾，参数化查询不起作用。您必须在此处使用插值或类似方法，但**请确保该值已被清理；这是一个可能的 SQL 注入向量**。

```
cur.execute("SELECT * FROM %s" % (total[0],)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T02:36:25.020

在该行`cur.execute("SELECT * FROM %s") % total[0]`中，您将`%`运算符应用于`cur.execute`调用结果。我认为您想在通话中进行替换，例如`cur.execute("SELECT * FROM ?", (total[0],))`.

# javascript - 如何测试 jQuery 和某些其他脚本是否已加载？

> ID：12031698
> 
> 赞同：0
> 
> 时间：2012-08-20T02:35:06.387
> 
> 标签：javascript

我知道 document.ready() 但我不想等待外部服务器上的某些内容（例如 Google Analytics）、某些广告服务内容或网站并非绝对需要的任何其他内容。我在有用户评论的网站上看到了这个问题，通常每个外部内容都必须在评论可用之前加载，即使许多 CDN 中的一个迟到了，它也会阻止其他所有内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:28:27.953

I don't think you need to test it as much as you need to defer it. [Here](https://developers.google.com/speed/docs/best-practices/payload#DeferLoadingJS) is a really simple example from Google.

(the following code copied from Google)

```
 // Add a script element as a child of the body
 function downloadJSAtOnload() {
     var element = document.createElement("script");
     element.src = "deferredfunctions.js";
     document.body.appendChild(element);
 }

 // Check for browser support of event handling capability
 if (window.addEventListener)
     window.addEventListener("load", downloadJSAtOnload, false);
 else if (window.attachEvent)
     window.attachEvent("onload", downloadJSAtOnload);
 else window.onload = downloadJSAtOnload; 
```

Essentially, add a new script tag at the documentReady state when you're executing your code already.

# assembly - x86 程序集（masm32）输出乘数产生垃圾字符

> ID：12031703
> 
> 赞同：0
> 
> 时间：2012-08-20T02:35:49.910
> 
> 标签：assembly, x86, masm32

几个月后，我将为此返回组装，但我无法让两个数字相乘并输出结果。这是我的代码：

```
.386
.model flat, stdcall 
option casemap :none 

include \masm32\include\windows.inc 
include \masm32\include\kernel32.inc 
include \masm32\include\masm32.inc 
includelib \masm32\lib\kernel32.lib 
includelib \masm32\lib\masm32.lib

.data 
     sum sdword 0
.code 
start:
mov ecx, 6        
xor eax, eax                  
mov edx, 7               
mul edx                  
push eax
pop sum
lea eax, sum
call StdOut
push 0 
call ExitProcess
end start 
```

它输出类似`P &aeffiini,`.

问题：为什么它会输出那个随机字符串，我该如何解决？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:56:01.380

因为 StdOut 打印 NULL 终止的字符串而不是数字。您需要先将数字转换为字符串。MASM32 有 dwtoa。另外，你的乘法错误。你乘以 eax

```
include masm32rt.inc

.data?
lpBuffer    db 12 dup (?)

.code 
start:
    mov     ecx, 6        
    mov     eax, 7               
    mul     eax    

    push    offset lpBuffer
    push    eax
    call    dwtoa 

    push    offset lpBuffer             
    call    StdOut

    inkey
    push    0 
    call    ExitProcess
end start 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T02:54:29.687

您的输出由`StdOut`函数中的任何内容控制，您没有向我们展示。很有可能（根据您的描述），它采用累加器中的字符*代码*并输出等效字符。

如果是这种情况，您可能需要做的是获取该值`eax`并根据该值确定需要输出哪些字符。然后，呼叫`StdOut`他们每个人。

其伪代码类似于：

```
eax <- value to print
call print_num
exit

print_num:
    compare eax with 0
    branch if not equal, to non_zero

    eax <- hex 30                       ; Number was zero,
    jump to StdOut                      ;   just print single digit 0

non_zero:
    push eax, ebx, ecx                  ; Save registers that we use
    ecx <- 0                            ; Digit count
loop1:
    compare eax with 0                  ; Continue until digits all pushed
    jump if equal, to num_pushed

    increment ecx                       ; Another digit
    ebx <- eax                          ; Work out what it is
    eax <- eax / 10
    eax <- eax * 10
    ebx <- ebx - eax
    push ebx to stack                   ; Then push it,
    jump to loop1                       ;  and carry on

num_pushed:
    pop eax from stack                  ; Get next digit
    eax <- eax + hex 30                 ; Print it out
    call StdOut
    decrement ecx                       ; One less digit to go
    jump if not zero, to num_pushed     ; Continue if more

    pop ecx, ebx, eax from stack        ; Clean up stack and return
    return 
```

如果*不是*这种情况，您只需弄清楚`StdOut`实际做了什么并调整您的代码以满足该功能的要求。

# ios - UIImages 的图像大小，1024 x 1024？

> ID：12031704
> 
> 赞同：5
> 
> 时间：2012-08-20T02:35:54.323
> 
> 标签：ios, xcode, image, image-processing, uiimage

苹果文档状态：

> 您应该避免创建尺寸大于 1024 x 1024 的 UIImage 对象。除了这样的图像会消耗大量内存之外，在 OpenGL ES 中将图像用作纹理或将图像绘制到视图或图层时，您可能会遇到问题。如果您正在执行基于代码的操作，例如通过将图像绘制到支持位图的图形上下文来调整大于 1024 x 1024 像素的图像大小，则此大小限制不适用。实际上，您可能需要以这种方式调整图像的大小（或将其分成几个较小的图像），以便将其绘制到您的视图之一。

我认为这意味着如果我们使用非方形图像，我们应该将它们分成更小的图像？是否有任何具体的文档或解释，或者是否有人有任何经验提示？

谢谢阅读。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T17:06:03.267

在 A5 之前的 iOS 设备上，最大的 OpenGL ES 纹理大小为 2048x2048（Apple 的文档在这方面说它是 1024x1024 是不正确的）。这意味着您不能拥有大于任一维度的图像。较新的 iOS 设备（iPhone 4S、iPad 2、iPad 3）的最大纹理尺寸为 4096x4096。

这并不意味着您必须拥有方形图像，只是图像的宽度或高度不得超过 2048（同样，在较新的设备上为 4096）。如果您尝试这样做，我相信您的图像只会呈现为黑色。

这曾经是所有不受 CATiledLayer 支持的 UIView 的限制，但我相信它们现在会自动平铺足够大的视图。如果您需要处理大于 2048x2048 的图像，则需要将其托管在 CATiledLayer 等中。

不过，内存警告值得关注。图像以未压缩的形式存储在内存中，无论其来源如何，因此您看到的是每张 2048x2048 图像 16,777,216 字节（RGBA 每像素 4 字节）。如果你不小心的话，这可以很快加起来。

# sql - 根据来自其他列的约束将列更新为相同的值

> ID：12031706
> 
> 赞同：-2
> 
> 时间：2012-08-20T02:36:09.540
> 
> 标签：sql, sql-server

我在 SQL Server 上有一个这样的表：

```
code description percentage
123  abc         1
123  oke         0
123  cfd         0
234  kde         2
234  kfc         0
234  kfc         0 
```

如何将每个代码组的所有“0 百分比”记录的描述更新为非零百分比记录？例如我追求的结果是：

```
code description percentage
123  abc         1
123  abc         0
123  abc         0
234  kde         2
234  kde         0
234  kde         0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T02:50:43.983

```
Update T1 set description = T2.Description from YourTable T1 
inner join 
(    select code, description from yourTable group by code, description
    where percentage <> 0 ) T2 on T1.Code = T2.Code
where T1.Code = 0 
```

**已编辑** 这考虑到每个组仅在另一个描述上只有零。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T02:42:01.810

尝试

```
UPDATE Table  
SET description=(SELECT TOP 1 description 
                 FROM Table t
                 WHERE t.code = Table.code AND percentage<>'0') 
WHERE percentage='0' 
```

# php - 无法连接到火鸟数据库 - CakePHP 2.2.1

> ID：12031710
> 
> 赞同：2
> 
> 时间：2012-08-20T02:36:43.580
> 
> 标签：php, cakephp, firebird

我用 CakePHP 1.2.5 版开发了一个网站，到那时一切都很好。但现在，我正在尝试使用 CakePHP 2.2.1 版重新实现我的网站。

但是与数据库（火鸟）的连接不再起作用。

这是我的 cake/app/Config/database.php 文件：

```
class DATABASE_CONFIG {

var $default = array(
    'driver' => 'firebird',
    'persistent' => false,
    'host' => 'localhost',
    'login' => 'SYSDBA',
    'password' => 'masterkey',
    'database' => 'd:\\IBDatabase\\DATA.GDB',
    'port' => '3050',
    'connect' => 'ibase_connect'
);

var $test = array(
    'driver' => 'firebird',
    'persistent' => false,
    'host' => 'localhost',
    'login' => 'SYSDBA',
    'password' => 'masterkey',
    'database' => 'd:\\IBDatabase\\DATA.GDB',
    'prefix' => '',
);
} 
```

这是我得到的错误：

```
Missing Datasource
Error: Datasource class could not be found.

Notice: If you want to customize this error message, create app\View\Errors\missing_datasource.ctp

Stack Trace
CORE\Cake\Model\ConnectionManager.php line 97 → ConnectionManager::loadDataSource(string)
CORE\Cake\Model\Model.php line 3158 → ConnectionManager::getDataSource(string)
CORE\Cake\Model\Model.php line 1092 → Model->setDataSource(string)
CORE\Cake\Model\Model.php line 3180 → Model->setSource(string)
CORE\Cake\Model\Model.php line 1301 → Model->getDataSource()
CORE\Cake\Model\Model.php line 1389 → Model->schema()
CORE\Cake\Controller\Component\PaginatorComponent.php line 354 → Model->hasField(string)
CORE\Cake\Controller\Component\PaginatorComponent.php line 125 → PaginatorComponent->validateSort(Professionals, array, array)
CORE\Cake\Controller\Controller.php line 1082 → PaginatorComponent->paginate(null, array, array)
APP\Controller\ProfessionalsController.php line 12 → Controller->paginate()
[internal function] → ProfessionalsController->index()
CORE\Cake\Controller\Controller.php line 485 → ReflectionMethod->invokeArgs(ProfessionalsController, array)
CORE\Cake\Routing\Dispatcher.php line 186 → Controller->invokeAction(CakeRequest)
CORE\Cake\Routing\Dispatcher.php line 161 → Dispatcher->_invoke(ProfessionalsController, CakeRequest, CakeResponse)
APP\webroot\index.php line 92 → Dispatcher->dispatch(CakeRequest, CakeResponse) 
```

有谁知道我应该怎么做？谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T15:28:08.900

经过大量研究，我发现 Cake 2.x 与 firebird 不兼容。

# android - 手电筒崩溃系统相机应用程序

> ID：12031718
> 
> 赞同：-1
> 
> 时间：2012-08-20T02:38:00.220
> 
> 标签：android, android-widget, camera, flashlight

我正在制作一个手电筒应用程序，目前是它的小部件。我想知道如何模拟三星辅助灯小部件的功能（[http://www.youtube.com/watch?v=PYR9jqo0vvc&feature=player_embedded#!](http://www.youtube.com/watch?v=PYR9jqo0vvc&feature=player_embedded#!)）？

如果我打开灯，相机应用程序将无法工作，但是有了这个小部件，三星让它以某种方式工作。我根本不知道，就我所知，Camera.open() 将相机锁定到进程中，因此相机应用程序无法访问它。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T05:54:00.767

标准的 Android 相机 API 不允许将闪光灯设置为手电筒模式，然后允许其他应用程序使用相机。如果手电筒应用程序不释放相机，则标准相机应用程序无法工作。如果 Flashlight 应用程序确实释放了相机，则闪光灯将关闭。

三星必须使用自定义功能扩展 Android API 以启用/禁用手电筒模式，而无需锁定相机。如果他们愿意，他们可以记录这个额外的功能，但可能添加的 API 只存在于 Galaxy S3 或其他类似的三星设备上；它不允许您编写适用于所有 Android 设备的代码。

# opencv - 安装带有所有依赖项的端口

> ID：12031722
> 
> 赞同：0
> 
> 时间：2012-08-20T02:39:13.093
> 
> 标签：opencv, macports

我一直在尝试使用命令安装端口`sudo port install NAME_OF_PORT`

我在使用此特定端口（OpenCV）时遇到的问题是，它不断向我询问依赖项，并出现如下错误：

```
Error: The following dependencies were not installed: libunwind-headers 
llvm-3.1 llvm_select 
```

有什么方法可以`sudo port install NAME_OF_PORT`只用一个命令来处理它的所有依赖项吗？

非常感谢您的时间，非常感谢任何提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T13:50:11.563

尝试运行`sudo port -v selfupdate`，然后重新运行`sudo port install opencv`。如果这无助于尝试运行`sudo port upgrade outdated`以升级过时的依赖项。

还可以看看我写的这个指南：[Compile OpenCV (2.3.1+) for OS X Lion / Mountain Lion with Xcode](https://stackoverflow.com/questions/8552839/compile-opencv-2-3-1-for-os-x-lion-mountain-lion-with-xcode/8559953#8559953)

# php - 您能否将应用程序设置为仅在客户端使用 Javascript 而在远程服务器上使用 PHP？

> ID：12031724
> 
> 赞同：0
> 
> 时间：2012-08-20T02:39:24.717
> 
> 标签：php, javascript, sql-server-2008, api, extjs4

我们正在规划将驻留在客户端服务器上的防火墙后面的企业应用程序的体系结构。我们想坚持使用 PHP 作为服务器端语言，使用 extjs 作为客户端语言。虽然，我们不希望客户端被要求在他们的 Windows 机器上安装 Apache 等。尽管我想知道我是否可以完成打包应用程序以供客户端下载并且它包含的只是 Javascript 并与我们的单个服务器实例通信以进行服务器端计算，但我对架构有一些想法？我相信这可以通过 API 做到最好。我们的客户在 Windows 服务器上使用 MSQL Server 2008，其中大约 10% 的客户被允许在虚拟机上运行 linux。

这个对吗？非常感谢您的想法和建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T03:14:54.970

对您的问题的简短回答是 - 是的，您可以。

ExtJS 是一个 JavaScript 库。因此，它需要浏览器来运行，而不是服务器。

您可以使用 ExtJ 编写一个完整的应用程序，例如可以在任何 PC 浏览器（或 Chromebook）上下载和运行的应用程序 - 无需任何服务器安装。

如果您希望您的客户下载客户端应用程序 - 没问题（他们只需在浏览器上打开一个索引文件）。但是您同样可以将 javascript 文件放在您的服务器上，并让您的用户访问相应的 url，这样您就可以轻松地更新应用程序的代码，而无需您的客户不断下载更新。您的客户仍然不需要安装任何 apache 或服务器。

ExtJs 允许服务器通信，其性质无关紧要（它可以通过 apache、ASP.net、RubyOnRail 等运行 PHP）。

# php - 我需要一种方法来自动调整 iframe 的大小，无论我看到什么或其他任何地方，它都无法正常工作

> ID：12031727
> 
> 赞同：1
> 
> 时间：2012-08-20T02:39:36.197
> 
> 标签：php, javascript, html, iframe, resize

> **可能重复：**
> [根据内容调整 iframe 的大小](https://stackoverflow.com/questions/153152/resizing-an-iframe-based-on-content)

我想做的是：

使用 div 将表单发布到作为使用 ajax 的替代方法，因为我需要的一些东西不适用于 ajax。我正在使用的 2 个页面的代码如下：

带有表单的页面：

```
<form action="iframe.php" method="post" onsubmit="document.getElementById(\"\")" target="my_iframe">
    <input type="hidden" name="post" value="postdata" />
  <input type="submit" value="Do Stuff!" />
</form>
<!-- when the form is submitted, the server response will appear in this iframe -->
<iframe frameborder="0" name="my_iframe" id="frame" src="iframe.php"></iframe> 
```

iframe 来源：

```
<?php
    if(isset($_POST['post'])){
        var_dump($_POST);
    }
?> 
```

我能做些什么呢？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:43:52.067

穆克曼很高兴再次见到你！您可以使用 iframe 的属性更改 iframe 的大小。然后，您可以使用 JavaScript 或 PHP，具体取决于您确定自动调整大小的内容或方式，为它们提供动态数字。您正在寻找的属性：

```
<iframe height="200" width="200"></iframe> 
```

iframe 属性[http://www.w3schools.com/tags/tag_iframe.asp](http://www.w3schools.com/tags/tag_iframe.asp)

如果您想在点击后显示 iframe，您将需要使用 iframe 的更改源事件。

这是[iFrame src 更改事件检测的入门？](https://stackoverflow.com/questions/2429045/iframe-src-change-event-detection)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T05:14:45.043

从隐藏在 CSS 中的 iframe 开始：

```
#frame {display:none}
.visible {display:block} 
```

然后在提交按钮上是这样的：

```
onclick="$(#frame).addClass('visible');" 
```

但是，无论表单做什么，这都将起作用，因此，如果您进行了验证，则每次单击按钮时框架仍然可见。如果您愿意，您可以在每次按下时打开和关闭它，如下所示：

```
onclick="$(#frame).toggleClass('visible');" 
```

# c# - 如何减少图像旋转质量损失？

> ID：12031728
> 
> 赞同：2
> 
> 时间：2012-08-20T02:39:38.680
> 
> 标签：c#

这是我用于旋转的 Form1 代码及其工作图像，我可以将其旋转 360 度。问题是在旋转图像时会损失很多质量。

我尝试在那里使用一些编解码器，但我不确定如何用我的代码实现它。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Drawing.Drawing2D;
using System.Drawing.Imaging;

namespace AnimatedGifEditor
{
    public partial class Form1 : Form
    {
        ImageCodecInfo[] codecs = ImageCodecInfo.GetImageEncoders();
        ImageCodecInfo ici = null; 
        Image myImage;
        AnimatedGif myGif;
        Bitmap bitmap;

        public Form1()
        {
            InitializeComponent();

            myImage = Image.FromFile(@"D:\fananimation.gif");
            myGif = new AnimatedGif(@"D:\fananimation.gif");
            for (int i = 0; i < myGif.Images.Count; i++)
            {
                pictureBox1.Image = myGif.Images[3].Image;
                bitmap = new Bitmap(pictureBox1.Image);
               // pictureBox1.Image = bitmap;
            }

            trackBar1.Maximum = 360;

        }

        private void Form1_Load(object sender, EventArgs e)
        {

        }

        private Bitmap RotateImage(Bitmap bmp, float angle)
        {
            Bitmap rotatedImage = new Bitmap(bmp.Width, bmp.Height);
            using (Graphics g = Graphics.FromImage(rotatedImage))
            {
                g.TranslateTransform(bmp.Width / 2, bmp.Height / 2); //set the rotation point as the center into the matrix
                g.RotateTransform(angle); //rotate
                g.TranslateTransform(-bmp.Width / 2, -bmp.Height / 2); //restore rotation point into the matrix
                g.DrawImage(bmp, new Point(0, 0)); //draw the image on the new bitmap
            }

            return rotatedImage;
        }

        private void trackBar1_Scroll(object sender, EventArgs e)
        {
            foreach (ImageCodecInfo codec in codecs)
            {
                if (codec.MimeType == "image/jpeg")
                    ici = codec;
            }

            EncoderParameters ep = new EncoderParameters();
            ep.Param[0] = new EncoderParameter(System.Drawing.Imaging.Encoder.Quality, (long)100);

            pictureBox1.Image = RotateImage(bitmap, trackBar1.Value);
        }

    }
} 
```

在表格的顶部，我添加了：

```
ImageCodecInfo[] codecs = ImageCodecInfo.GetImageEncoders();
ImageCodecInfo ici = null; 
```

在我添加的滚动事件中：

```
foreach (ImageCodecInfo codec in codecs)
                {
                    if (codec.MimeType == "image/jpeg")
                        ici = codec;
                }

                EncoderParameters ep = new EncoderParameters();
                ep.Param[0] = new EncoderParameter(System.Drawing.Imaging.Encoder.Quality, (long)100); 
```

但我从不使用这个编码代码。我该怎么做 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T08:50:59.920

在您的内部，您`RotateImage`应该将`Graphics`对象插值模式设置为高质量：

```
g.InterpolationMode = InterpolationMode.HighQualityBicubic; 
```

与您的问题无关的另一件事是您没有正确处理以前的图像。

你应该开始你的`RotateImage`方法：

```
if (rotatedImage != null) rotatedImage.Dispose(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-27T22:29:03.910

虚拟代码：

指定不翻转的 180 度顺时针旋转。

```
public static Image RotateImage(Image image)
        {
            image.RotateFlip(RotateFlipType.Rotate180FlipNone);
            return image;
        } 
```

# c# - 如何从隔离存储中加载图像以用于辅助磁贴

> ID：12031730
> 
> 赞同：1
> 
> 时间：2012-08-20T02:40:54.963
> 
> 标签：c#, windows-phone-7, isolatedstorage, live-tile

我正在尝试使用从 PhotoChooserTask 保存的图像填充辅助平铺背景，但由于某种原因，我无法完成此操作。我参考了很多网站，但我还没有找到正确的实现。我所做的只是调用 PhotoChooserTask，然后在完成的事件中，我将生成的图像保存到隔离的存储中以便稍后加载。这在我的应用程序中与 HubTile 一起使用，但由于某种原因，我无法将图像附加到辅助磁贴。到目前为止，我所拥有的如下：

MainPage.xaml.cs

```
string imageFolder = @"\Shared\ShellContent";
string shareJPEG = "shareImage.jpg";

public MainPage()
    {
        InitializeComponent();

        photoChooserTask = new PhotoChooserTask();
        photoChooserTask.Completed += new EventHandler<PhotoResult>(photoChooserTask_Completed);
    }

public void changePictureMenuItem_Tap(object sender, System.Windows.Input.GestureEventArgs e)
    {     
        try
        {
            photoChooserTask.Show();
        }
        catch (System.InvalidOperationException)
        {
            MessageBox.Show("An error occurred");
        }
    }

    void photoChooserTask_Completed(object sender, PhotoResult e)
    {
        if (e.TaskResult == TaskResult.OK)
        {
              //persist the data in isolated storage
                    using (IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication())
                    {
                        if(!myIsolatedStorage.DirectoryExists(imageFolder))
                        {
                            myIsolatedStorage.CreateDirectory(imageFolder);
                        }

                        if (myIsolatedStorage.FileExists(shareJPEG))
                        {
                            myIsolatedStorage.DeleteFile(shareJPEG);
                        }

                        string filePath = System.IO.Path.Combine(imageFolder, shareJPEG);
                        IsolatedStorageFileStream fileStream = myIsolatedStorage.CreateFile(filePath);

                        BitmapImage bitmap = new BitmapImage();
                        bitmap.SetSource(e.ChosenPhoto);
                        WriteableBitmap wb = new WriteableBitmap(bitmap);

                        // Encode WriteableBitmap object to a JPEG stream. 
                        Extensions.SaveJpeg(wb, fileStream, 173, 173, 0, 100);

                        fileStream.Close();
                    }
        }
    }    

private void CreateLiveTile(TileItem item)
    {
        //IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication();
        var title = item.Title.ToString();
        string tileParameter = "Param=" + item.Title.ToString();

        ShellTile Tile = CheckIfTileExist(tileParameter);  // Check if Tile's title has been used             

        if (Tile == null)
        {   
            //this is not working?             
            background = new Uri(@"isostore:/Shared/ShellContent/shareJPEG.png", UriKind.Absolute);
            //background = new Uri("isostore:/Shared/ShellContent/shareJPEG.png", UriKind.Absolute);

            try
            {
                var LiveTile = new StandardTileData
                {
                    Title = item.TileName,                        
                    BackgroundImage = background,  //not working
                    BackTitle = item.TileName,    
                    BackBackgroundImage = new Uri("/background.png", UriKind.Relative),
                    BackContent = item.Message,
                };

                ShellTile.Create(new Uri("/MainPage.xaml?" + tileParameter, UriKind.Relative), LiveTile);                      
        }
    } 
```

最终，创建了辅助图块，但 BackgroundImage 没有图像。我将如何正确调用隔离存储路径来相应地设置辅助磁贴的 BackgroundImage？或者还有什么我应该做或改变的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:30:41.100

MainPage.xaml.cs

```
string imageFolder = @"\Shared\ShellContent"; 
string shareJPEG = "shareImage.jpg"; 

...

private void CreateLiveTile(TileItem item)  
{   
    var title = item.Title.ToString();  
    string tileParameter = "Param=" + item.Title.ToString();  

    ShellTile Tile = CheckIfTileExist(tileParameter);  // Check if Tile's title has been used               

    if (Tile == null)  
    {        
        string filePath = System.IO.Path.Combine(imageFolder, shareJPEG);                
        background = new Uri(@"isostore" + filePath, UriKind.Absolute);    //this worked

        ...

     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T06:29:37.663

您确定图像已成功保存并且存在吗？您将其保存为 jpeg，但您引用了 png 文件。试试@"\Shared\ShellContent\shareJPEG.png"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-11T09:40:16.140

首先，您应该将图像放在“\Shared\ShellContent”位置。您可以使用 .png 或 .jpg 文件

```
string imageFolder = @"\Shared\ShellContent"; 
string shareJPEG = "shareImage.jpg"; 

...

private void CreateLiveTile(TileItem item)  
{   
    var title = item.Title.ToString();  
    string tileParameter = "Param=" + item.Title.ToString();  

    ShellTile Tile = CheckIfTileExist(tileParameter);

    if (Tile == null)  
    {        
        string filePath = System.IO.Path.Combine(imageFolder, shareJPEG);
        using (var iso = IsolatedStorageFile.GetUserStoreForApplication())
                {
                    if (iso.FileExists(filePath)) // check file exist or not
                        background = new Uri(@"isostore:" + filePath, UriKind.Absolute); 
                } 
        ...

     }
} 
```

# javascript - 如何在大型 php 网站中组织一点 javascript

> ID：12031732
> 
> 赞同：3
> 
> 时间：2012-08-20T02:41:03.060
> 
> 标签：javascript, jquery, html, code-organization

我正在开发一个大型 php mysql CMS。我用包含、对象等组织了我的服务器端代码，做得不错。现在我已经开始用表单验证和图像滑块之类的东西来让前端变得活跃起来，我开始积累一堆小小的 javascript/jquery 函数。其中大部分都在 5 行以下，并且每行仅用于一页。

将所有这些都放入functions.js文件中，将其包含在我的标题中然后在我需要的页面中调用myJavaScriptFunction（）是不好的做法/懒惰吗？如果是这样，什么是更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T02:45:39.077

> 将所有这些都放入functions.js文件中，将其包含在我的标题中然后在我需要的页面中调用myJavaScriptFunction（）是不好的做法/懒惰吗？

这会起作用，但请注意不要在每个页面中加载大量无用的功能。例如，如果您有 30 个与操作 Google Map 相关的 Javascript 函数，而您只有一个页面处理 Google Maps API，如果您在每个页面上都包含这些无用的函数，您将浪费大量时间加载它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T02:50:49.650

如果它们只用在一页上，为什么要把它们放在一个通用文件中。这是权衡利弊的好时机。

优点：

1.  浏览器缓存 javascript 文件，第一页请求稍慢，每下一个稍快。
2.  稍微简单的 HTML，因为 javascript 保存在单独的文件中。
3.  单独的文件，所以语法高亮！

缺点：

1.  每次加载页面时都会加载大量无用的 JavaScript 代码

对我来说，这似乎是你不应该做的事情，但这实际上取决于你的 JavaScript 代码有多大，以及将`<script>`标签放入`head`.

# c# - 在c#中将特定范围从xls文件导入datagridview

> ID：12031744
> 
> 赞同：1
> 
> 时间：2012-08-20T02:44:16.343
> 
> 标签：c#, excel, datagridview, xls

我想将特定范围的 xls 文件导入 datagridview。问题是：范围每次都在变化，因此我需要用户能够选择它。有没有一种优雅的方式来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-02T15:32:56.017

看看这段代码是否适合你。它提示用户打开一个 excel 文件，然后提示他们输入他们希望在 DataGridView 中看到的范围。在他们选择范围后，它将该范围转换为 DataTable 并将 DataTable 设置为源。

我不确定您到底想如何使用它或您想添加到它的任何其他功能，但这应该为您提供一个开始的构建块。

```
 private Excel.Application App;
    private Excel.Range rng = null;
    private void button1_Click_1(object sender, EventArgs e) {
        OpenFileDialog OFD = new OpenFileDialog();
        OFD.Filter = "Excel Worksheets|*.xls;*.xlsx;*.xlsm;*.csv";
        if (OFD.ShowDialog() == System.Windows.Forms.DialogResult.OK) {
            App = new Excel.Application();
            App.Visible = true;
            App.Workbooks.Open(OFD.FileName);
        }
        else { return; }

        try { rng = (Excel.Range)App.InputBox("Please select a range", "Range Selection", Type: 8); }
        catch {  } // user pressed cancel on input box

        if (rng != null) { 
            DataTable dt = ConvertRangeToDataTable();
            if (dt != null) { dataGridView1.DataSource = dt; }
        }
        _Dispose();
    }
    private DataTable ConvertRangeToDataTable() {
        try {
            DataTable dt = new DataTable();
            int ColCount = rng.Columns.Count;
            int RowCount = rng.Rows.Count;

            for (int i = 0; i < ColCount; i++) {
                DataColumn dc = new DataColumn();
                dt.Columns.Add(dc);
            }
            for (int i = 1; i <= RowCount; i++) {
                DataRow dr = dt.NewRow();
                for (int j = 1; j <= ColCount; j++) { dr[j - 1] = rng.Cells[i, j].Value2; }
                dt.Rows.Add(dr);
            }
            return dt;
        }
        catch { return null; }
    }
    private void _Dispose() {
        try { Marshal.ReleaseComObject(rng); }
        catch { }
        finally { rng = null; }
        try { App.Quit(); Marshal.ReleaseComObject(App); }
        catch { }
        finally { App = null; }
    } 
```

# c++ - 自动决定使用哪个类进行数据处理

> ID：12031746
> 
> 赞同：0
> 
> 时间：2012-08-20T02:44:26.757
> 
> 标签：c++, oop

我有一个大项目，我遇到了一个问题，可以简单地表述如下：

我有一个临时创建的类，用于处理和修改一些数据（我们称之为“工人”）。现在我有两个工人和两个相应的数据格式。数据数组可以包含混合数据，如何让我的程序自动决定它应该创建和使用哪个工人类进行数据处理？如何以最好的方式做到这一点？

为了说明这个问题，我编写了与我的项目类似的小示例程序。

```
#include <iostream>
#include <vector>
using namespace std;

const int NInputs = 10;

struct TOutput {
  int i;
};

class TProcess {
  public:
  TProcess( const vector<TInput>& i ){ fInput = i; }

  void Run();

  void GetOutput( TOutput& o ) { o = fOutput; }
  private:
  vector<TInput> fInput;
  TOutput fOutput;
};

#if 0
struct TInput {
  int i;
};
class TWorker{
 public:
  void Init( int i ) { fResult = i; }
  void Add( int i ) { fResult += i; }
  int  Result() { return fResult; } 
 private:
  int fResult;
};
#else
struct TInput {
  int i;
};
class TWorker {
 public:
  void Init( int i ) { fResult = i; }
  void Add( int i ) { fResult ^= i; }
  int  Result() { return fResult; } 
 private:
  int fResult;
};
#endif

void TProcess::Run() {
  TWorker worker;
  worker.Init(0);
  for( int i = 0; i < fInput.size(); ++i )
    worker.Add(fInput[i].i);

  fOutput.i = worker.Result();
}

int main()  {
  vector<TInput> input(NInputs);

  for  ( int i = 0; i < NInputs; i++ ) {
    input[i].i = i;
  }

  TProcess proc(input);
  proc.Run();

  TOutput output;
  proc.GetOutput(output);

  cout << output.i << endl;
} 
```

这个例子很简单，但这并不意味着它可以简单地转换为一个函数——它对应于大项目。因此，不可能：

*   删除已经存在的类或函数（但可以修改它们并创建新的）
*   使工作人员静态或仅创建工作人员的一份副本（每个工作人员在许多复杂的功能和循环中都是临时的）

那么如何修改它，使其变成这样：

```
 // TODO: TProcess declaration

struct TInput1 {
  int i;
};
class TWorker1{
 public:
  void Init( TInput1 i ) { fResult = i; }
  void Add( TInput1 i ) { fResult += i.i; }
  int  Result() { return fResult; } 
 private:
  int fResult;
};
#else
struct TInput2 {
  int i;
};
class TWorker2 {
 public:
  void Init( TInput2 i ) { fResult = i.i; }
  void Add( TInput2 i ) { fResult ^= i.i; }
  int  Result() { return fResult; } 
 private:
  int fResult;
};

void TProcess::Run() { 
  for( int i = 0; i < fInput.size(); ++i ) {
    // TODO: choose and create a worker
    worker.Add(fInput[i].i);
    // TODO: get and save result
  }

  fOutput.i = worker.Result();
}

int main()  {
  vector<TInputBase> input(NInputs);

  // TODO: fill input

  TProcess proc(input);
  proc.Run();

  TOutput output;
  proc.GetOutput(output);

  cout << output.i << endl;
} 
```

我最初的想法是使用基本的类和模板函数，但是没有模板虚函数......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T05:25:12.557

You've got the right idea with the `vector<TInputBase>` declaration in your second example -- you need to have a common base class for all inputs, and similarly for all workers:

```
class TInput {
}

class TInput1 : public TInput { ... }
class TInput2 : public TInput { ... }

class TWorker {
public:
  void Init(TInput *input) = 0;
  void Add(TInput *input) = 0;
  int Result() = 0;
}

class TWorker1 : public TWorker { ... }
class TWorker2 : public TWorker { ... } 
```

Note, however, that this means all workers can only take a `TInput *` as input and you will need to cast to the correct input class inside each worker class.

The simplest way to decide which worker class to use for a given input is to ask the input itself! You can have a virtual function in the input class that creates the right kind of worker:

```
class TInput {
  virtual TWorker *createWorker() = 0;
}

class TInput1 : public TInput {
  TWorker *createWorker() {
    return new TWorker1();
  }
}

class TInput2 : public TInput {
  TWorker *createWorker() {
    return new TWorker2();
  }
} 
```

If this is not possible for some reason, you can use [`typeid`](http://en.wikipedia.org/wiki/Typeid) to determine the type of the input and create a corresponding worker instance.

# jquery - 如何在ajax加载的元素上绑定事件

> ID：12031749
> 
> 赞同：2
> 
> 时间：2012-08-20T02:44:38.590
> 
> 标签：jquery, ajax, events, binding, stoppropagation

我正在尝试通过 ajax 将内容加载到容器（#ajax_content）中。当我点击外部时，我希望能够关闭（隐藏）ajax 加载的内容（#ajax_content 中的所有内容）。但我想绑定里面元素的onClick。

HTML：

```
 <div id="wrapper"> 
      <div id="ajax_content">
      </div>
   </div> 
```

通过 AJAX 加载的 HTML：

```
<button id="super_hello" >Click</button> 
```

加载 ajax 内容后的 HTML 将是

```
 <div id="wrapper"> 
      <div id="ajax_content">
          <button id="super_hello" >Click</button>
      </div>
   </div> 
```

Javascript：

```
$(document).ready(function(){

    $('.ajax_link').click(function(event) {
       event.preventDefault();

       $.get($(this).attr('href'), function(data) {

            $('#ajax_content').html('');
            $('#ajax_content').append(data);

            $('#ajax_content').css({
                visibility: 'visible'
            });

        });

    });

    $('#ajax_content').click(function(event){

         event.stopPropagation();

    });

    $('#wrapper').click(function(){
        $('#ajax_content').hide();
        $('#ajax_content').html('');

        $(this).hide();
    });

});

    $(document).on("click","#super_hello",function(e){
        alert('clicked'); // I can't get this to work
    }); 
```

问题：如果我发表评论

```
$('#ajax_content').click(function(event){

     event.stopPropagation();

}); 
```

该事件被绑定到 super_hello，但随后 ajax_content 内的任何点击都将传播到关闭 ajax_content 的包装器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T04:19:12.790

您可以直接在包装器的单击处理程序中过滤掉内容中的任何单击，例如：

```
$('#wrapper').click(function(e) {
    if (!$(e.target).closest('#ajax_content').length) {
        $('#ajax_content').hide();
        $('#ajax_content').html('');
        $(this).hide();
    }
}); 
```

将检查是否存在具有`#ajax_content`ID 的父元素，包装器没有，但包装器内的内容确实有。

另一方面，只要包装器和内容没有设置特定的大小，很可能内容会填满整个包装器，并且不会在包装器上注册任何点击，请参阅[**FIDDLE**](http://jsfiddle.net/smYwm/1/)

# objective-c - 检测文本字段中的某些字符

> ID：12031751
> 
> 赞同：2
> 
> 时间：2012-08-20T02:45:16.040
> 
> 标签：objective-c, ios, xcode

在文本字段中检测字符的最简单方法是什么？

我希望能够检测到某个字符并将该字符替换为另一个特定字符。

因此，如果我在文本字段中写入...“zyxw”，我希望将其替换为“abcd”。

我是一个新手，真的不知道从哪里开始或如何去做。如果有人有任何方法可以做到这一点，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T02:57:04.903

以下是您如何使用 替换字符串的一部分[`NSRegularExpression`](https://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)，以响应`UITextField`委托调用`textField:shouldChangeCharactersInRange:replacementString:`：

```
- (BOOL) textField:(UITextField *)txt shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)res{
    NSString *string = txt.text; // Suppose it's "Hello, zyxw!";
    NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"zyxw" options:NSRegularExpressionCaseInsensitive error:NULL];
    res = [regex stringByReplacingMatchesInString:string options:0 range:range withTemplate:@"abcd"];
    NSLog(@"%@", res);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T02:53:41.867

对于“新手”，我会指出正则表达式（regex）。

请参阅Apple 提供的有关 Objective-c 的[文档](https://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)。

请参阅有关 Objective-C 正则表达式支持的Stack Exchange[问题/答案。](https://stackoverflow.com/questions/1633331/replacing-in-nsstring-with-wildcards-regular-expressions-cocoa)

有关正则表达式以及它们如何协助模式匹配算法的更多一般信息，[请参见此处](http://www.digitalamit.com/article/regular_expression.phtml)，或参考 Google。

# c# - 为什么我只是*随机*在单个服务器环境中获得“视图状态 MAC 验证失败”？

> ID：12031756
> 
> 赞同：3
> 
> 时间：2012-08-20T02:46:17.713
> 
> 标签：c#, asp.net, exception, viewstate, machinekey

是的，关于这个特定错误有一百万个问题和线索，有许多有据可查的解决方案，我一定会尝试。但首先我想了解我的特定情况/环境的问题。

在我的情况下，这个错误似乎完全是随机的。我会几周都看不到它，然后有一天我会登录我的网站并得到错误。刷新页面，再次登录，没有问题。在事件之间的这段时间里，Web 服务器没有发生什么特别的事情。

这是另一件事，错误显示“如果此应用程序由 Web Farm 或集群托管......”，但事实并非如此。它只是一个单一的 Windows Server 2008。

所以，我知道一般的解决方案是在 web.config 文件中添加一组静态机器密钥 --- 但为什么这似乎是随机发生的，为什么它会发生在我位于单个 Windows Server 2008 上的站点上机器？

我正在使用 ASP.NET 4，我的网站是在 IIS 上运行的 Web 应用程序。

**错误信息：**

```
Validation of viewstate MAC failed. If this application is hosted by a Web Farm or cluster, ensure that <machineKey> configuration specifies the same validationKey and validation algorithm. AutoGenerate cannot be used in a cluster. 
```

**堆栈跟踪：**

```
[ViewStateException: Invalid viewstate. 
    Client IP: ##::##:##:##:##
    Port: ##
    Referer: http://myserver/login.aspx
    Path: /login.aspx
    User-Agent: Opera/9.80 (Windows NT 6.1; WOW64; U; en) Presto/2.10.289 Version/12.01
    ViewState: /wEPDw...6OCX]

[HttpException (0x80004005): Validation of viewstate MAC failed. If this application is hosted by a Web Farm or cluster, ensure that <machineKey> configuration specifies the same validationKey and validation algorithm. AutoGenerate cannot be used in a cluster.]
   System.Web.UI.ViewStateException.ThrowError(Exception inner, String persistedState, String errorPageMessage, Boolean macValidationError) +235
   System.Web.UI.ViewStateException.ThrowMacValidationError(Exception inner, String persistedState) +14
   System.Web.UI.ObjectStateFormatter.Deserialize(String inputString) +274
   System.Web.UI.ObjectStateFormatter.System.Web.UI.IStateFormatter.Deserialize(String serializedState) +4
   System.Web.UI.Util.DeserializeWithAssert(IStateFormatter formatter, String serializedState) +37
   System.Web.UI.HiddenFieldPageStatePersister.Load() +241
   System.Web.UI.Page.LoadPageStateFromPersistenceMedium() +106
   System.Web.UI.Page.LoadAllState() +43
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +8431
   System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +253
   System.Web.UI.Page.ProcessRequest() +78
   System.Web.UI.Page.ProcessRequestWithNoAssert(HttpContext context) +21
   System.Web.UI.Page.ProcessRequest(HttpContext context) +49
   ASP.login_aspx.ProcessRequest(HttpContext context) +4
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +100
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +75 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T07:13:25.347

从您的日志中，我建议您检查一件事 -**如果用户登录/注销，您是否将用户的任何参数与 Viewstate 连接起来？**- 或因任何其他原因而更改，例如因为会话已过期或更改。

此参数在保存的视图状态和当前视图状态之间可能不同，这可能会破坏页面。

例如，这段代码可以做到这一点：

```
ViewStateUserKey = CurrentUserCookie; 
```

或者这个原样：

```
ViewStateUserKey = User.Identity.Name 
```

另请阅读此答案：[https ://stackoverflow.com/a/2551810/159270](https://stackoverflow.com/a/2551810/159270)

这是类似的： [ViewStateUserKey + 共享主机 + ViewStateMac 验证失败](https://stackoverflow.com/questions/10862258/viewstateuserkey-shared-hosting-viewstatemac-validation-failure)

还有一些参考： [http ://www.hanselman.com/blog/ViewStateUserKeyMakesViewStateMoreTamperresistant.aspx](http://www.hanselman.com/blog/ViewStateUserKeyMakesViewStateMoreTamperresistant.aspx)
[http://msdn.microsoft.com/en-us/library/ms972969.aspx](http://msdn.microsoft.com/en-us/library/ms972969.aspx)

*随机错误是任何开发人员的噩梦。*

# excel - 保存在 Excel 中时 Sed 不读取 CSV

> ID：12031757
> 
> 赞同：0
> 
> 时间：2012-08-20T02:46:21.827
> 
> 标签：excel, bash, csv

我正在尝试编写一个 bash 脚本来导入 CSV 文件并将其发送到网络上的某个地方。如果我使用手写的 CSV，即：

```
summary,description
CommaTicket1,"Description, with a comma"
QuoteTicket2,"Description ""with quotes"""
CommaAndQuoteTicke3,"Description, with a commas, ""and quotes"""
DoubleCommaTicket4,"Description, with, another comma"
DoubleQuoteTicket5,"Description ""with"" double ""quoty quotes""" 
```

READ 命令能够很好地读取文件。但是，如果我在 Excel 中创建“相同的文件”（即：具有相同的字段），则 READ 无法正常工作，通常只读取第一个值，仅此而已。

在相对较新的 Bash 脚本中，所以如果有人认为我的代码有问题，我会上传它，但它似乎是 Excel for Mac 保存文件的方式有问题，我想有人可能对此有一些想法。

你们可以贡献的任何东西都将不胜感激。干杯!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T03:18:48.330

默认情况下，Mac 上的 Excel 使用回车符指示新记录，但 bash 使用换行符查找记录。在 Excel for Mac 中保存文件时，请务必将字符编码（保存文件时可用的选项）更改为 DOS 或 Windows 等，其中应弹出回车符和换行符，并且应是“可读的”。

或者，您可以只使用 处理文件`tr`，并将所有 CR 转换为 LF，即

```
tr '\r' '\n' < myfile.csv > newfile.csv 
```

您可以验证这是否确实是问题的一种方法是使用`od`检查文件。使用类似的东西：

```
od -c myfile.csv 
```

并寻找行尾字符。

最后，您还可以调查 bash 的内部`IFS`变量，并将其设置为在其中包含“\r”。见：[http ://tldp.org/LDP/abs/html/internalvariables.html](http://tldp.org/LDP/abs/html/internalvariables.html)

# sql - 如果在锁定行的父级上尝试级联删除，PostgreSQL 会发生什么？

> ID：12031762
> 
> 赞同：6
> 
> 时间：2012-08-20T02:47:50.890
> 
> 标签：sql, postgresql, select, transaction-isolation

我有一个表`foo_bar`和另一个表`spam_eggs`，`fb`外键指向`foo_bar`. `spam_eggs`当删除相关行时，行将被级联`spam_eggs.fb`删除。

我正在使用 PostgreSQL。

在一个事务中，我曾经`SELECT... FOR UPDATE`锁定`spam_eggs`一行。在此事务期间，另一个事务已尝试`DELETE FROM...`与`foo_bar`我的锁定行相关。这会触发错误，还是我锁定的行会导致查询阻塞，直到我的原始更新事务结束？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-20T03:19:12.557

试试看。打开`psql`并进行一些设置：

```
CREATE TABLE foo_bar(id integer primary key);
CREATE TABLE spam_eggs(
     foo_bar_id integer not null references foo_bar(id) on delete cascade
);
INSERT INTO foo_bar (id) VALUES (1),(2),(3),(4);
INSERT INTO spam_eggs(foo_bar_id) VALUES (1),(2),(3),(4); 
```

然后打开另一个 psql 连接。`BEGIN`双方的交易。

1.  在第一个（旧）会话中，运行`SELECT 1 FROM spam_eggs WHERE foo_bar_id = 4 FOR UPDATE;`
2.  在第二个（新）会话中，运行`DELETE FROM foo_bar WHERE id = 4;`

您将看到第二个语句阻塞在第一个语句上。那是因为`DELETE`on`foo_bar`级联到`spam_eggs`并尝试使用外键引用锁定行，以便它可以删除它。那把锁挡在`SELECT ... FOR SHARE`.

一般来说，尝试在所有这些情况下进行测试：

*   tx 是`BEGIN ISOLATION LEVEL READ COMMITTED`和第一个问题`ROLLBACK`
*   tx 是`BEGIN ISOLATION LEVEL READ COMMITTED`和第一个问题`COMMIT`
*   tx 是`BEGIN ISOLATION LEVEL SERIALIZABLE`和第一个问题`ROLLBACK`
*   tx 是`BEGIN ISOLATION LEVEL SERIALIZABLE`和第一个问题`COMMIT`

以确保您知道会发生什么。*如果您在测试之前对预期发生的事情进行推理，这*对您的学习也有好处。

在这种情况下，隔离级别`READ COMMITTED`和`SERIALIZABLE`隔离级别将表现相同。但是，如果您实际上执行了操作`UPDATE`，`SELECT ... FOR UPDATE`那么`COMMIT`它们的行为会有所不同；该`READ COMMITTED`版本将`DELETE`成功，而该`SERIALIZABLE`版本将失败：

```
regress=# BEGIN ISOLATION LEVEL SERIALIZABLE;
regress=# DELETE FROM foo_bar WHERE id = 4;                                                                                                                                                                                                    
ERROR:  could not serialize access due to concurrent update                                                                                                                                                        
CONTEXT:  SQL statement "DELETE FROM ONLY "public"."spam_eggs" WHERE $1 OPERATOR(pg_catalog.=) "foo_bar_id"" 
```

# c# - C# 中的跨线程操作无效错误

> ID：12031764
> 
> 赞同：0
> 
> 时间：2012-08-20T02:48:11.307
> 
> 标签：c#, backgroundworker, multithreading

我对 C# 和所有线程的东西都很陌生，目前我收到“跨线程操作无效错误”。

以下是代码的相关部分：

```
 private LinkedList<string> _statusList = new LinkedList<string>();

    private void ReportToStatus(string message)
    {
        _statusList.AddLast(message);\
        // textStatus is a textbox.
        // And this is the exact line that is giving the error:
        textStatus.Lines = _statusList.ToArray();
    }

    private void RunTest()
    {
        // ...

        // Run the test in the background worker.
        bgwTest.RunWorkerAsync(testCase);
    }

    private void bgwTest_DoWork(object sender, DoWorkEventArgs e)
    {
        TestCase testCase = e.Argument as TestCase;

        // ...

        // Run the test.
        switch (testCase.TestType)
        {
            case "TestA":    TestA(testCase);
                             break;
        }

        e.Result = testCase;
    }

    private void TestA(TestCase testCase)
    {
        // ...

            PrintStatistic(statisticsForCoil, testCase.OutputFile);
        }
    }

    private void PrintStatistic(int[] statistics, string outputFile)
    {
        // ...

        ReportToStatus(result);
    } 
```

我应该如何进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:00:06.527

_statusList 中似乎有问题。您不能从不同的线程写入它，只能读取。

来自[MSDN](http://msdn.microsoft.com/en-us/library/he2s3bh7%28v=vs.100%29.aspx)

> “LinkedList 类不支持链接、拆分、循环或其他可能使列表处于不一致状态的功能。列表在单个线程上保持一致。LinkedList 支持的唯一多线程场景是多线程读取操作。”

此外，您无法从后台线程访问 UI。您需要使用调度程序来调用 UI 线程上的操作。为此，您的代码需要如下所示

**WPF**

```
 Application.Current.Dispatcher.Invoke(new Action(delegate
                                   {
                                        textStatus.Lines = _statusList.ToArray();
                                   })); 
```

**WinForms**

```
 textStatus.Invoke(new Action(delegate
                                   {
                                        textStatus.Lines = _statusList.ToArray();
                                   })); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T14:32:56.117

有一个更新 UI的`BackgroundWorker`专用机制： [BackgroundWorker.ReportProgress](http://msdn.microsoft.com/en-us/library/ka89zff4%28v=vs.100%29.aspx)。例如，在您的代码中，它可能如下所示：

```
private void ReportToStatus(string message)
{
    _statusList.AddLast(message);
    // textStatus is a textbox.
    // And this is the exact line that is giving the error:
    bgwTest.ReportProgress(0, _statusList.ToArray());
}

//Assuming this is the method handling bgwTest's ProgressChanged event
private void bgwTest_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
     textStatus.Lines = (string[])(e.UserState);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T02:52:58.287

您正在尝试从您的后台工作人员更新 UI，这将导致该异常。您可以使用 Dispatcher 来安排更新 - 或者更理想的是使用后台工作人员仅执行“后台”工作，然后在[`RunWorkerCompleted`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.runworkercompleted%28v=vs.100%29.aspx)引发事件时执行 UI 更新。

# javascript - 在鼠标悬停图像上显示 div，在鼠标悬停时隐藏 div：nextSibling 和 previousSibling 不起作用

> ID：12031767
> 
> 赞同：0
> 
> 时间：2012-08-20T02:49:01.290
> 
> 标签：javascript, html, onmouseover, onmouseout, nextsibling

我有以下代码：

```
 <div class="outer-div">
     <img onmouseover="showDiv(this)" src="{{ STATIC_URL }}/images/user_male.png">
     <a onmouseout="hideDiv(this)" href="{% me.some_url %}" style="display: block;">
         <div class="inner-block" onmouseout="hideDiv(elem)">
             <h5>{{ me.title }}</h5>
             <p>{{ me.text }}</p>
             <p>about ? ago</p>
         </div>
     </a>
     <div>
            <p>Comments</p>
            <p>Likes</p>
    </div>
</div>

<script>
function showDiv(elem) {
    elem.style.visibility="hidden";
    elem.nextSibling.style.visibility="visibile";
}

function hideDiv(elem) {
    elem.style.visibility="hidden";
    elem.previousSibling.style.visibility="visibile";
}
</script> 
```

div“inner-block”被定位，所以当你悬停时它直接在图像上方。因此，想法是对弹出链接的“内部块”div 的图像进行 onmouseover，然后在隐藏 div 并再次显示图像的链接上进行 onmouseout。

当我尝试使用 elem.nextSibling 时，我收到 elem.nextSibling 未定义的错误，因此您无法设置可见性。谢谢！或者，有没有其他方法可以做到这一点？谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T03:01:28.140

好的，所以现在我得到了错误`Uncaught ReferenceError: elem is not defined`

请记住，始终修复出现的第一个错误。

好的，我能得到的最接近的是[这个 jsFiddle](http://jsfiddle.net/kUSbj/)。

任何人都可以根据我的答案随意构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T03:17:52.553

我认为你弄错了 nextSibling 和 previousSibling 在同一个父母身上工作，但你`<div class="inner-block" onmouseout="hideDiv(elem)">`没有兄弟姐妹

更多细节： [http ://www.w3schools.com/dom/prop_node_nextsibling.asp](http://www.w3schools.com/dom/prop_node_nextsibling.asp)

我认为你最好设置元素 id 并使用 getElementById 而不是兄弟

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T09:24:51.963

好吧，这是我的尝试：

```
 <div id="outer-div">
        <img id ="img" onmouseover="showDiv()" src="http://www.crunchbase.com/assets/images/resized/0004/1621/41621v6-max-250x250.jpg" style = "visibility:visible;"/>
        <div id="inner-block" onmouseout="hideDiv()" style="visibility:hidden;">
            <a href="http://www.stackoverflow.com" style="display: block;">
                 <div>
                     <h5>{{ me.title }}</h5>
                     <p>{{ me.text }}</p>
                     <p>about ? ago</p>
                 </div>
             </a>
        </div>
         <div>
                <p>Comments</p>
                <p>Likes</p>
        </div>
    </div> 
```

这是javascript：

```
<script>
    function showDiv() {
        document.getElementById("img").style.visibility = "hidden";
        document.getElementById("inner-block").style.visibility = "visible";
    }

    function hideDiv() {
        document.getElementById("inner-block").style.visibility = "hidden";
        document.getElementById("img").style.visibility = "visible";
    }
</script> 
```

几件事：我所做的主要更改不是将函数放在锚标记上，而是将所有内容封装到自己的 div 中。我认为如果你指定一个特定区域，在这种情况下是它周围的 div，这会好很多。如果说您不希望它是链接而是某个部分等，这对未来会更好。

我还使用了 document.getElementById。我很确定它可以用 previousSibling 和 nextSibling 做到这一点（至于为什么有一个未定义的错误仍然让我感到困惑，所以我不得不更多地使用它）但总的来说我认为这是更好的风格。除非你总是想在元素之前获得兄弟姐妹，在元素之后获得兄弟姐妹，否则我更希望你这样做——指定要消失和重新出现的元素更有条理。

现在链接不在图像的正上方。如果你想这样做，我认为你可以使用绝对定位或浮动来让它工作，但我会让你自己尝试。希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T18:10:31.567

好吧，我发现了问题所在。elem.nextSibling 和 elem.previousSibling 都返回文本节点。

所以我最终使用

```
elem.nextSibling.nextSibling 
```

和

```
elem.previousSibling.previousSibling 
```

呜呼！总是调试-

# iphone - 用于检测和阻止 NSLog 调试调用的 Git 预提交钩子

> ID：12031768
> 
> 赞同：0
> 
> 时间：2012-08-20T02:49:08.610
> 
> 标签：iphone, objective-c, git

我将如何创建一个 git pre-commit 钩子来阻止提交

```
NSLog(@"random debug stuff"); 
```

但跳过

```
//NSLog(@"useful to keep around"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T10:08:40.857

看看Marcus Zarra 很久以前发布的[.pch 文件，我在每个项目中都使用它](http://www.cimgf.com/2010/05/02/my-current-prefix-pch-file/)

除其他外，它包含`NSLog`替代调用`DLog`，使用它的好处是它利用内置的预处理器宏在生产`DEUBUG`中禁用`NSLog`

只需将以下代码包含到 YourProject.pch 文件中：

```
#ifdef DEBUG
  #define DLog(...) NSLog(@"%s %@", __PRETTY_FUNCTION__, [NSString stringWithFormat:__VA_ARGS__])
  #define ALog(...) [[NSAssertionHandler currentHandler] handleFailureInFunction:[NSString stringWithCString:__PRETTY_FUNCTION__ encoding:NSUTF8StringEncoding] file:[NSString stringWithCString:__FILE__ encoding:NSUTF8StringEncoding] lineNumber:__LINE__ description:__VA_ARGS__]
#else
  #define DLog(...) do { } while (0)
  #ifndef NS_BLOCK_ASSERTIONS
    #define NS_BLOCK_ASSERTIONS
  #endif
  #define ALog(...) NSLog(@"%s %@", __PRETTY_FUNCTION__, [NSString stringWithFormat:__VA_ARGS__])
#endif

#define ZAssert(condition, ...) do { if (!(condition)) { ALog(__VA_ARGS__); }} while(0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T09:54:14.683

您将需要创建自己的日志系统，您可以在其中指定消息的级别（错误、警告、信息或调试），然后在您不处于调试模式（即`-DDEBUG`未传递给编译器）时忽略调试调用，或者每当设置其他编译器定义时，甚至在运行时使用某些配置设置。

我不清楚 git pre-commit 钩子在这种情况下如何工作，因为您的提交状态与您的应用程序在开发方面处于什么阶段无关。

# java - PDF文档类型说明（如PDF/A-1）

> ID：12031769
> 
> 赞同：4
> 
> 时间：2012-08-20T02:49:33.577
> 
> 标签：java, pdf, netbeans, pdf-generation, jodconverter

我正在开发用于存储法律文件的软件，我认为 PDF 可能是一种理想的工作格式。但是，对于 PDF 文件的实际格式在这方面什么最适合我的需求，我有点困惑。

我对文件有以下要求：

*   将至少存储 7 年（如果不再）
*   不可编辑
*   包含图像和文本（图像最好是 .jpg 格式）

我最初考虑使用 PDF/A-1，但是我发现这种格式似乎不喜欢使用 JPEG 图像，或者至少在使用 JODConverter 时不喜欢。

任何关于哪种格式最能满足这些需求的建议/解释将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T06:31:54.683

对于您描述的要求，PDF/A-1b（是的，最后是**b**！）是理想的格式。*b*是*基本*的——它的要求比 PDF/A-1a （末尾的**a ）要宽松，后者是用于****可访问**的（或**高级**的，正如我所记忆的那样）。

如果您在实施 PDF/A-1a 时没有遇到***任何困难，不妨试试。***但是，根据您的源文档，PDF/A-1a 可能非常难以生成并且几乎不可能生成（因为它需要对文件内容进行附加*标记*以实现辅助功能）。

至于 JPEG：当然 PDF/A-1b 支持 JPEG。它**不允许**使用 JPEG2000*压缩*，因为该算法在定义 PDF/A-1b 标准时已获得专利保护。为此，PDF/A-1b 生成软件必须使用这种类型的压缩和其他方法之一重新压缩对象（但这不会造成很大的实际问题。）

您可能还想查看[**PDF/A 能力中心**(PDFA)](http://www.pdfa.org/competence-centers/pdfa-competence-center/)网站。（披露：我是 PDFA 的成员。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T03:14:48.267

PDF/A-1 是一种很好的长期存储格式（这就是它的意图），因此它会尝试删除外部依赖项。这包括一些东西，比如嵌入字体和禁用外部超链接（这也很有意义，但可能是一个陷阱）。[Adobe 网站](http://www.adobe.com/enterprise/standards/pdfa/)上有一些有用的信息（查看关键规格选项卡）。PDF 听起来是您要求的正确答案。

嵌入的图像应该不是问题。JODReports 可能做错了什么（或者您在下面使用的 OpenOffice/LibreOffice 版本）。您可以尝试切换该底层基础架构 (OO/LO) 的部分，尝试直接从 OpenOffice/LibreOffice GUI 进行试验 - 导出 PDF/A-1 并查看结果或尝试链中的其他一些工具（例如，Docmosis 虽然那是基于类似技术）。

# class - 通过使用具体类而不是接口，编译后的 js 的大小减少了多少

> ID：12031770
> 
> 赞同：5
> 
> 时间：2012-08-20T02:49:48.960
> 
> 标签：class, gwt, size, abstract

我已经为 GWT 阅读了该内容，指定了返回具体实现的方法，例如：

```
public ArrayList<String> getList(); 
```

而不是通常首选的“抽象接口”，例如：

```
public List<String> getList(); 
```

导致 GWT 生成一个较小的已编译 javascript 文件，因为客户端（即 js）代码不必满足接口的所有已知实现（在 的示例中`List`，客户端代码必须能够处理`LinkedList`、`ArrayList`、`Vector`、等），因此它可以通过不编译未使用的实现来优化 js。

我密切相关的问题是：

*   这是真的？（以下问题假设*为*真）
*   是使用接口的每个类还是每个应用程序的优化？IE
*   我看到重构一个类的好处吗？或者
*   一旦所有客户端类都被重构为不使用接口，我是否只会看到好处？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T04:56:24.957

以下假设您使用该接口作为 GWT RPC 服务签名的一部分。我认为如果你在 GWT RPC 服务的签名中不使用接口，使用类而不是接口的影响应该是最小的（例如 GWT 编译器只会编译使用的实现）

> *   这是真的？（以下问题假设为真）

是的，当 GWT 编译器“知道”哪些类可能从服务器发送到客户端时，它的输出会变小。

> *   是使用接口的每个类还是每个应用程序的优化？IE

在 GWT RPC 的情况下，每个应用程序。

> *   我看到重构一个类的好处吗？

是的，如果接口需要包含许多类的代码，则由一个实现替换的接口可以将生成的代码大小减少几 kb。

但是，除了使用实现而不是接口之外，还可以在模块定义文件中定义类的“黑名单”，以明确规避在生成的代码中包含实现：类似于

```
<extend-configuration-property name="rpc.blacklist"
    value="-java.util.ArrayList" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T06:09:00.037

我刚刚根据[webAppCreator](https://developers.google.com/web-toolkit/doc/latest/RefCommandLineTools)生成的示例应用程序进行了测试，但我添加了 3 个简单的服务，它们返回`List<String>`或`ArrayList<String>`，具体取决于构建。

结果是，使用所有服务从编译的 javascript 中`ArrayList<String>` **节省了大约 5Kb**，而不是使用任何混合返回类型。

这证明节省是真实的，并且是针对每个应用程序（而不是针对每个服务）。

它还显示了它节省了*多少（在这种情况下）。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T07:00:07.217

这对于一般的 GWT 编译器来说并不实际。这种方法仅适用于与代码生成一起使用的类。例如，在使用远程过程调用时。有关更多详细信息，请参阅此[问题](https://stackoverflow.com/questions/3059787/gwt-using-listserializable-in-a-rpc-call)。因此，如果您声明一个接口而不是具体类作为返回类型，编译器会在您编译的代码中包含所有可能的实现。这增加了编译时间和生成的代码量。

实际上，可以使用没有 RPC 的 GWT 开发应用程序。在这种情况下，编译后的代码在使用接口时不会膨胀。

# asp.net - 如何以编程方式设置 Elmah 电子邮件的收件人

> ID：12031771
> 
> 赞同：6
> 
> 时间：2012-08-20T02:49:52.890
> 
> 标签：asp.net, asp.net-mvc, elmah

我在这里有这个方法，我想去 e.Mail.To = MAC，但显然它是一个只读属性，这让我完全不知道如何以编程方式设置收件人。基本上我想根据我的部署级别（实时/测试/开发）更改收件人地址，我还想为开发/测试模式处理（）（不发送）电子邮件。

还有另一种方法吗？

```
public static void ErrorMail_Mailing(object sender, ErrorMailEventArgs e)
        {
            if (!GlobalHelper.IsLiveMode)
            {
                e.Mail.Dispose();
            }
            else
            {
                MailAddressCollection MAC = new MailAddressCollection();
                MAC.Add("A");

            } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T06:30:40.703

以下片段将解决您的问题 -

```
public static void ErrorMail_Mailing(object sender, ErrorMailEventArgs e)         
{             
    if (!GlobalHelper.IsLiveMode)             
    {                 
        e.Mail.Dispose();             
    }             
    else         
    {                 
        MailAddressCollection MAC = new MailAddressCollection();                 
        MAC.Add("A@XYZ.COM");              
        MAC.Add("B@XYZ.COM");              

        e.Mail.To.Clear(); // Clears any existing mail addresses if you want to
        e.Mail.To.Add(MAC.ToString()); // To contains A@XYZ.COM & B@XYZ.COM
    } 
} 
```

# c++ - 向用户询问要在数组中搜索的整数

> ID：12031774
> 
> 赞同：0
> 
> 时间：2012-08-20T02:50:32.687
> 
> 标签：c++, data-structures

我正在学习处理数据结构，并且我刚刚编写了一个程序，该程序 Insertion_Sorts 一个整数数组。排序工作得很好，所以没有必要解决它。但我希望为我的用户提供一种在排序数组中搜索特定数字的方法。它不起作用：更具体地说：我已经在 Win7 x64 Ultimate 下的 MS VS 2010 中编译了以下代码，并且在编写“指定要搜索的数字”之后它崩溃了，并且调试器说“访问冲突”。

```
#include "stdafx.h"
#include <stdio.h>
#include <stdlib.h>
#include <conio.h>
#include <vector>
using namespace std;

int swap(int x, int y)
{
if(x != y)
  {
       _asm
      {
        mov eax,x;
        mov ebx, y;
        mov y,eax;
        mov x, ebx;
      }

  }
return 0;
}

int insertion_sort()
{
int or_size = 2;
int i,j,k,h, size, temp;
char answ;
int xx;
char query [20];

printf("Specify array size\n");
scanf_s("%d", &size);
printf(" Now, input all elements of the array \n");

vector<int> Array(size, 0);
if (size > or_size)
    Array.resize(size);

for (int i = 0; i < size; i++)
{
    scanf_s("%d\n", &temp);
    Array[i] = temp;
}

printf ("Your array appears to be as follows: \n");
for (int i = 0; i < size; i++)
    printf("%d  ", Array[i]);

for (i =0; i < size; i++)
    for (j = 0; j < i; j++)
        if (Array[j] > Array[i])
        {
        temp = Array[j];
        Array[j] = Array[i];
        for (k = i ; k > j ; k-- )
                    Array[k] = Array[k - 1] ;

        Array[k + 1] = temp ;
        }
printf ("\n Your Array has been insertion_sorted and should know look like this: \n");
for (int i = 0; i < size; i++)
    printf("%d ", Array[i]);

printf("\n Would you like to search for a specific value? (Yy/Nn) \n");
answ = _getch();
if (answ == 'Y' || answ == 'y')
{
    printf("Specify number to be searched \n");
    scanf_s("%s", query);
    xx = atoi(query);
    printf("Searching for %d ", query);
    for(h = 0; h < sizeof(Array); h++)
        if (Array.at(h) == xx)
            printf("%d\n", h); 
        else
            printf("No such number was found in a sorted array\n");
}    

Array.clear();

return 0;
}

int main()
{
    insertion_sort();
    return 0;
} 
```

PS忽略_asm部分：它有效，但尚未使用:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:22:57.593

`printf("Searching for %d ", query);`由于`query`声明为 的数组`char`，因此不应使用`%d`用于打印带符号整数的说明符，更改`%d`为`%s`或。由于这是 C++，我会使用它。`query``xx``std::cout`

`sizeof(Array)`不做你想让它做的事情。改为使用`Array.size()`。

在 C++ 中，您不必在函数的开头声明所有变量。我相信那是 C89 的旧部分。这意味着您可以像这样声明您的 for 循环`for(int h = 0; h < Array.size(); h++)`。

这是尝试在向量中查找某些内容的一个很好的示例：

```
if(std::find(Array.begin(), Array.end(), xx) != Array.end())
    std::cout << "found" << std::endl;
else
    std::cout << "not found" << std::endl; 
```

您正在混合 C 和 C++ 代码。我建议选择一种语言并仅使用该语言。

# wxpython - 如何在 wxpython 中使用 ObjectListView

> ID：12031775
> 
> 赞同：1
> 
> 时间：2012-08-20T02:50:42.743
> 
> 标签：wxpython, objectlistview

我正在使用 wxpython 来包含 ObjectListView。我试图将它放入 wx.panel，但失败了。下面是图片![在此处输入图像描述](../Images/9a091854a520b09635e3caaedb19c5fe.png)

我很疑惑为什么 ObjectListView 只显示在 16x16 的正方形中？我实现 ObjectListView 的代码：

```
and my code to use it:    
`LeftList = wx.BoxSizer( wx.VERTICAL )    
self.m_panel2 = wx.Panel( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize,          wx.TAB_TRAVERSAL )    
p1 = MyListCtrl(self.m_panel2, -1)    
LeftList.Add( p1, 1, wx.EXPAND |wx.ALL, 5 )    
bSizer12.Add( LeftList, 1, wx.EXPAND, 5 )`

and my code of MyListCtrl is:    
`class MyListCtrl(wx.Panel):    
def __init__(self, parent, id):       
wx.Panel.__init__(self, parent=parent, id=wx.ID_ANY)
self.olv = ObjectListView(self, id, style=wx.LC_REPORT|wx.NO_BORDER)    
self.Layout()    
self.olv.SetColumns(...)  ` 
```

然后结果就是我贴在头部的图片

我的问题是我应该使用什么来包含 wxpython 中的 ObjectListView 以及如何使用它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T14:15:38.263

# html - 使用 HTMLAgilityPack 从表中加载值

> ID：12031778
> 
> 赞同：0
> 
> 时间：2012-08-20T02:51:09.823
> 
> 标签：html, screen-scraping, html-agility-pack

我正在尝试从表中获取值，但对如何正确执行此操作有点困惑。我想从以下页面检索 Strike/Symbol/Bid/Ask：http: [//finance.yahoo.com/q/op?s=MSFT &m=2012-09](http://finance.yahoo.com/q/op?s=MSFT&m=2012-09)

对于我的代码，我尝试了很多东西，但也许我没有正确理解如何使用 Xpath。

```
private void optionchainButton_Click(object sender, EventArgs e)
        {
            string URL = "http://finance.yahoo.com/q/op?s=" + tickerEditBox.Text;
            string HtmlFile = @".\localfile.html";

            using (WebClient client = new WebClient ()) // WebClient class inherits IDisposable
            {
                client.Proxy = null;
                //client.DownloadFile(URL, @".\localfile.html");
                HtmlWeb hw = new HtmlWeb();
                HtmlAgilityPack.HtmlDocument htmlDoc = hw.Load(URL);
                if (htmlDoc.DocumentNode != null)
                {
                    foreach (HtmlNode text in htmlDoc.DocumentNode.SelectNodes("//table/tbody/tr/td/text()"))
                    {
                        Console.WriteLine(text.InnerText);
                    }
                }

            }

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T12:38:06.297

对于 HtmlAgilityPack 的替代方案，请尝试[CsQuery](https://github.com/jamietre/csquery#readme)（在 nuget 上称为“CsQuery”），您可以使用可能更熟悉的 CSS 选择器和 jQuery API，并且可以轻松进行这种解析。以下是我将如何使用 CsQuery：

```
string URL = "http://finance.yahoo.com/q/op?s=MSFT&m=2012-09";

CQ doc = CQ.CreateFromUrl(URL);

// The two tables have a class "yfnc_datamodoutline1", but wrap an inner table 
// too.
// This selector gets the rows of the child table where the actual data lies

var rows = doc.Select(".yfnc_datamodoutline1 table tr");

// Each th header has the class ".yfnc_tablehead1" - figure out which column 
// to use for the four parts you are interested in by finding the appropriate
// header column based on the title, and grabbing it's index

var headers = rows.First().Find(".yfnc_tablehead1");

int strikeIndex = headers.Filter(":contains('Strike')").Index();
int symbolIndex = headers.Filter(":contains('Symbol')").Index();
int bidIndex = headers.Filter(":contains('Bid')").Index();
int askIndex = headers.Filter(":contains('Ask')").Index();

// iterate over all rows, except the header one (the "has" excludes the header 
// row)

foreach (var row in rows.Has("td")) {
    CQ cells = row.Cq().Find("td");

    string output = String.Format("Strike: {0} Symbol: {1} Bid: {2} Ask: {3}",
        cells[strikeIndex].Cq().Text(),
        cells[symbolIndex].Cq().Text(),
        cells[bidIndex].Cq().Text(),
        cells[askIndex].Cq().Text());

     Console.WriteLine(output);
} 
```

如果您熟悉 CSS 和 jQuery，则方法和选择器应该是有意义的，除了`Cq()`最后一个循环中的方法。这只是将一个元素包装为一个`CQ`对象，因此您可以使用 jQuery API 来处理它。`$(row)`这与在 jQuery中包装 DOM 元素的做法完全相同。也就是说，当你迭代一个 jQuery 对象时，你得到的是实际的 DOM 元素，而不是更多的 jQuery 对象，所以如果你想对循环中的每个元素使用 jQuery API，你需要再次将它们包装在 jQuery 中。这就是您在 CsQuery 中的操作方式。jQuery 中的相同循环将被编码为：

```
rows.Has("td").each(function(i,row) {
    var cells = $(row).find("td"); 
    ..
}); 
```

我已经测试了这段代码，它可以工作并返回如下输出：

```
Strike: 20.00 Symbol: MSFT120922C00020000 Bid: N/A Ask: N/A
Strike: 21.00 Symbol: MSFT120922C00021000 Bid: N/A Ask: N/A
Strike: 22.00 Symbol: MSFT120922C00022000 Bid: N/A Ask: N/A
Strike: 23.00 Symbol: MSFT120922C00023000 Bid: N/A Ask: N/A
Strike: 24.00 Symbol: MSFT120922C00024000 Bid: N/A Ask: N/A
Strike: 25.00 Symbol: MSFT120922C00025000 Bid: N/A Ask: N/A 
```

...

# c++ - 如何正确（但有效地）实现“vector::insert”之类的东西？（指针别名）

> ID：12031781
> 
> 赞同：6
> 
> 时间：2012-08-20T02:52:33.537
> 
> 标签：c++, pointer-aliasing

考虑这个假设的实现`vector`：

```
template<class T>  // ignore the allocator
struct vector
{
    typedef T* iterator;
    typedef const T* const_iterator;

    template<class It>
    void insert(iterator where, It begin, It end)
    {
        ...
    }

    ...
} 
```

### 问题

我们在这里面临一个微妙的问题：和
有可能引用同一向量中的项目，*之后*。`begin``end` *`where`*

 *例如，如果用户说：

```
vector<int> items;
for (int i = 0; i < 1000; i++)
    items.push_back(i);
items.insert(items.begin(), items.end() - 2, items.end() - 1); 
```

如果`It`不是指针类型，那么我们很好。
但我们不知道，所以我们必须检查它`[begin, end)`是否引用了向量中已经存在的范围。

但是我们该怎么做呢？根据 C++，如果它们*不*引用同一个数组，那么指针比较将是未定义的！
因此编译器可能会错误地告诉我们这些项目没有别名，而实际上它们确实如此，从而给我们带来了不必要的 O(n) 减速。

### 潜在的解决方案和警告

*一种解决方案是每次都*复制*整个*向量，以包含新项目，然后丢弃旧副本。

 *但在上面的例子中，这非常慢，我们复制 1000 个项目只是为了插入 1 个项目，即使我们显然已经有足够的容量。

### 有没有一种通用的方法来（正确）有效地解决这个问题，即在没有混叠的情况下*不会*遭受 O(n) 减速？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T03:31:57.113

您可以使用谓词`std::less`等，它们保证给出一个总顺序，即使原始指针比较没有。

从标准`[comparisons]/8`：

> 对于更大、更少、greater_equal 和less_equal 模板，任何指针类型的特化都会产生一个总顺序，即使内置运算符<、>、<=、>= 没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T03:43:33.513

> 但是我们该怎么做呢？根据 C++，如果它们*不*引用同一个数组，那么指针比较将是未定义的！

错误的。指针比较是*未指定*的，不是未定义的。来自 C++03 §5.9/2 [expr.rel]：

> [...] 可以比较指向相同类型的对象或函数的指针（在指针转换之后），其结果定义如下：
> 
> [...] -
> 未指定其他指针比较。

因此，在进行昂贵但正确的复制之前测试是否存在重叠是安全的。

有趣的是，C99 与 C++ 的不同之处在于，不相关对象之间的指针比较是未定义的行为。从 C99 §6.5.8/5 开始：

> 比较两个指针时，结果取决于所指向对象在地址空间中的相对位置。[...] 在所有其他情况下，行为是未定义的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T03:57:43.353

实际上，*即使它们是常规迭代器*也是如此。没有什么能阻止任何人做

```
std::vector<int> v; 
// fill v 
v.insert(v.end() - 3, v.begin(), v.end()); 
```

确定它们是否别名对于*任何*迭代器的实现都是一个问题。

但是，您缺少的是*实现*，您不必使用可移植代码。作为实现，你可以做任何你想做的事情。你可以说“好吧，在*我的*实现中，我遵循 x86 并且`<`可以`>`用于任何指针。”。那很好。**

# php - 在 php 函数中使用数据库值

> ID：12031783
> 
> 赞同：0
> 
> 时间：2012-08-20T02:52:56.887
> 
> 标签：php, database, variables

我对 PHP 很陌生，对使用数据库一点也不熟悉，所以如果可以的话，请多多包涵。**我有一个网站，里面有比较表，每个产品**基本上有3 个值：

```
$product + $delivery = 'price' 
```

我熟悉制作一个对变量求和和回显的简单函数，但我想要更具体的东西。

基本上，对于`$product`，我想在页面上设置值，但是对于`$delivery`，我想从某种数据库中提取变量值，所以它看起来像：

```
$15.00 + $delivery_company_one = 'price' 
```

我该怎么做呢？我应该具体研究和学习什么？任何参考将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T02:58:03.603

首先，您应该学习基本的 PHP 语法。你不能说：

```
$var1 + $var2 = $var3; 
```

PHP 不会那样工作。左边的变量赋值给右边的值，但`$var1 + $var2`不是变量，也不是可以定义的东西。

如果您想学习如何从数据库中提取内容，您绝对应该查看`SQL`数据库，可能通过`PDO`. 这意味着你必须学习`OOP`。您可以使用 Google 搜索所有这些内容。**跳过 URL 为 w3schools.com/* 的结果以获得最佳结果。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T02:59:59.443

听起来您可能想要阅读一些 MySQL 教程。MySQL 是一个被广泛使用和支持的数据库，它上手相当简单，但一旦你进步，它就会拥有极其先进和强大的功能。

使用 XAMPP 堆栈快速入门。 [http://www.apachefriends.org/en/xampp.html](http://www.apachefriends.org/en/xampp.html)

从一些 MySQL 教程开始，了解它是如何工作的。 [http://net.tutsplus.com/tutorials/databases/sql-for-beginners/](http://net.tutsplus.com/tutorials/databases/sql-for-beginners/)

尝试通过 PHP 和 PDO 访问它。 [http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-20T02:58:15.507

谷歌搜索返回教程[http://www.phphaven.com/article.php?id=65](http://www.phphaven.com/article.php?id=65)教你如何使用mysqli使用php

不要使用 MYSQL！！！！使用 mysqli

雇我恰恰

# mercurial - 是否可以将 mercurial 存储库更新为 -1？

> ID：12031785
> 
> 赞同：4
> 
> 时间：2012-08-20T02:53:11.387
> 
> 标签：mercurial

我想暂时“清除”我的工作目录（SSD 和驱动器备份的空间需求更少）

具体来说，我想知道我是否可以更新到修订版 -1（以便 mercurial 清除所有不是它自己的东西）。

这可以使用 mercurial 命令完成吗？（如果我也有的话，我会写一个脚本，但与其他人共享命令而不是编写做“正确”事情的脚本是有利的）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T03:03:29.203

如果您运行`hg update null`，它应该删除除`.hg`目录和存储库未跟踪的任何文件之外的所有内容。

如果有未跟踪的文件，您也可以使用`hg purge`. [Purge](http://mercurial.selenic.com/wiki/PurgeExtension)是一个扩展，但它与 mecurial 一起分发，因此您只需启用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T18:55:19.973

如果您有未提交的更改并且不关心保留它们，`hg update -C null`将处理摆脱它们；在此之后您将只剩下`.hg`目录和未跟踪的文件。

# macos - 将代码从雪豹迁移到山狮，使用“x86_64”制作和链接错误

> ID：12031786
> 
> 赞同：1
> 
> 时间：2012-08-20T02:53:13.850
> 
> 标签：macos, linker, x86, osx-lion, x86-64

我有一堆我经常使用的代码，我将它们捆绑为一个库 (.a)。一切都在我运行雪豹的旧 macbookpro 上运行；但是我最近买了一台新笔记本电脑，并升级到了山狮——现在我在构建以前可以运行的程序时遇到了很多麻烦。

目前，我正在尝试重新构建该库，当我运行我的makefile时，我得到了错误

```
g++ -g -I/opt/local/include -L/opt/local/lib -M -MT './obj/TB_Numerical.o' TB_Numerical.cpp -MF obj/TB_Numerical.d
make: *** No rule to make target `/usr/include/c++/4.2.1/i686-apple-darwin10/x86_64/bits/c++config.h', needed by `obj/TB_RecordKeeper.o'.  Stop. 
```

我不熟悉makefile，我只是从一些教程等中拼凑出一些简单的东西......如果发布我的Makefile会有所帮助，请告诉我。

如果有人可以帮助我解决这个特定的错误，那就太好了。此外，如果有一些......像，系统的“新事物”，我需要做才能让一切正常工作......我也很感激任何指示！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T03:28:51.430

I found the solution here: [https://stackoverflow.com/a/5321472/230468](https://stackoverflow.com/a/5321472/230468)

I needed to include system header files **before** application header files...

Why, in the name of anything holy, this error *just* came up after upgrading to mountain lion, an why that particular (seemingly useless) error message was given.... I do not know.

# xslt - 如何根据位置（）跳过xslt中的元素

> ID：12031790
> 
> 赞同：1
> 
> 时间：2012-08-20T02:54:29.043
> 
> 标签：xslt

这是我的xslt：

这个有效，但前提是硬编码“1,2”，

```
<xsl:template match="row[contains('1,2,',concat(position(),','))]" 
```

工作xslt：

```
<xsl:stylesheet version="1.0" exclude-result-prefixes="msxsl" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
    <xsl:output method="xml" indent="yes"/>
    <xsl:param name="positions"/>
    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>
    <xsl:template match="row[contains('1,2,',concat(position(),','))]" name="skiprow"/>
</xsl:stylesheet> 
```

但我想将位置值作为参数传递。但它不起作用。我通过添加一行检查了参数的值，参数是好的。

```
 <xsl:value-of select="$positions"/>
    <xsl:copy>
        <xsl:apply-templates select="@* | node()"/>
    </xsl:copy> 
```

非工作xslt：

```
<xsl:stylesheet version="1.0" exclude-result-prefixes="msxsl" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
    <xsl:output method="xml" indent="yes"/>
    <xsl:param name="positions"/>
    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>
    <xsl:template match="row[contains('$positions',concat(position(),','))]" name="skiprow"/>
</xsl:stylesheet> 
```

样本 Xml：

```
<root>
    <row>
        <column1>7004275</column1>
        <column2>NUVCFDK</column2>
    </row>
    <row>
        <column1>1001459</column1>
        <column2>CAN</column2>
        <column3>12</column3>
        <column4>646.80</column4>
        <column5>23-06-2009</column5>
        <column6>31-12-2009</column6>
        <column7/>
    </row>
    <row>
        <column1>1001461</column1>
        <column2>CAN</column2>
        <column3>1</column3>
        <column4>9.50</column4>
        <column5>23-06-2009</column5>
        <column6>31-12-2009</column6>
        <column7/>
    </row>
</root> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T03:27:01.340

> 非工作xslt：
> 
> ```
>  <xsl:template match="row[contains('$positions',concat(position(),','))]" name="skiprow"/> 
> ```

**在 XSLT 1.0 中，禁止匹配模式包含变量/参数引用。**

**改用**：

```
<xsl:template match="row>
  <xsl:if test=
      "not(contains($vPositions, concat(position(),',')))">
   <xsl:call-template name="identity"/>
  <xsl:if>
</xsl:template> 
```

**完整的变换变为：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="vPositions" select="'1,2,'"/>

 <xsl:template match="node()|@*" name="identity">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="row">
  <xsl:if test=
   "not(contains($vPositions, concat(position(),',')))">
    <xsl:call-template name="identity"/>
  </xsl:if>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<root>
    <row>
        <column1>7004275</column1>
        <column2>NUVCFDK</column2>
    </row>
    <row>
        <column1>1001459</column1>
        <column2>CAN</column2>
        <column3>12</column3>
        <column4>646.80</column4>
        <column5>23-06-2009</column5>
        <column6>31-12-2009</column6>
        <column7/>
    </row>
    <row>
        <column1>1001461</column1>
        <column2>CAN</column2>
        <column3>1</column3>
        <column4>9.50</column4>
        <column5>23-06-2009</column5>
        <column6>31-12-2009</column6>
        <column7/>
    </row>
</root> 
```

**产生了想要的正确结果（第 1 行和第 2 行“已删除”）：**

```
<root>
   <row>
      <column1>1001461</column1>
      <column2>CAN</column2>
      <column3>1</column3>
      <column4>9.50</column4>
      <column5>23-06-2009</column5>
      <column6>31-12-2009</column6>
      <column7/>
   </row>
</root> 
```

**但是请注意，您的条件不够强**- 参数值`"11,13,"`将删除*四行*- 1、11、3 和 13。

**一个好的使用条件是**：

```
not(contains($vPositions, concat(',',position(),','))) 
```

这意味着参数必须以逗号字符开头和结尾。

**这是完整的，更正的转换**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="vPositions" select="',1,2,'"/>

 <xsl:template match="node()|@*" name="identity">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="row">
  <xsl:if test=
   "not(contains($vPositions, concat(',',position(),',')))">
    <xsl:call-template name="identity"/>
  </xsl:if>
 </xsl:template>
</xsl:stylesheet> 
```

# android - Android 4.1 使用 Phonegap 加载外部 html 的问题

> ID：12031791
> 
> 赞同：1
> 
> 时间：2012-08-20T02:54:32.237
> 
> 标签：android, jquery-mobile, cordova, android-4.2-jelly-bean

我有一个使用最新版本的 Phonegap 和 Jquery Mobile 的 Android 应用程序。我在 Android 4.0.1 或更低版本上没有任何问题，但是当我在 Android 4.1 上安装该应用程序时，我遇到了一个问题。在应用程序中有一个部分，我有一个 XMLHttpRequest 来加载外部 HTML。出于某种原因，在 deviceready 上，应用程序给了我一个警报，告诉我应用程序无法加载 HTML。我不知道怎么了。知道有什么问题吗？为什么它只发生在果冻豆上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:45:19.463

@用户1608382，

就像西蒙说的，给我们看看你的代码。

如果您不想向我们展示您的所有代码，只需删除尽可能多的代码，再试一次，看看您是否可以重现问题，并给我们一个仍然存在问题的最小测试用例。`4.1.1`我们中的许多人都有可以测试的实际设备。

DeviceReady 是否允许您访问 logcat？由于该服务仍仅限邀请，因此我无法立即浏览其文档。

另外，请访问[b.android.com](http://b.android.com)上的错误跟踪器并搜索`4.1 webview`

从这些结果可以看出，Android 4.1.x 为 WebView 引入了一些问题，因此希望您的问题已经在其中列出。

# objective-c - Cocoa 框架中的属性副本是什么意思？（如 UITabBar 的 items 属性）

> ID：12031793
> 
> 赞同：1
> 
> 时间：2012-08-20T02:54:46.643
> 
> 标签：objective-c, ios, cocoa, copy

在 UITabBar.h 中，一个属性签名的副本

@property(nonatomic,copy) NSArray *items; // 获取/设置可见

这是一个数组 “复制”是什么意思？复制 NSArray 容器 obj？复制每个 obj NSArray 包含的内容？或者其他的东西。

## 所以有一个测试

```
UITabBar* testBar = [[UITabBar alloc] init];
UITabBarItem* item = [[UITabBarItem alloc] init];
NSArray* array = [[NSArray alloc] initWithObjects:item, nil];

NSLog(@"bar:%p,%d", testBar, testBar.retainCount);
NSLog(@"item:%p,%d", item, item.retainCount);
NSLog(@"array:%p,%d", array, array.retainCount);

testBar.items = array;

NSLog(@"that item:%p,%d", [testBar.items lastObject], [[testBar.items lastObject] retainCount]);
NSLog(@"testBar.items:%p,%d", testBar.items, testBar.items.retainCount); 
```

## 结果

栏：0x96a9750,1

项目：0x96aa230,2

数组：0x96aa280,1

那个项目：0x96aa230,2

testBar.items:0x96aa280,6

为什么容器数组和数组中的 obj 都没有被“复制”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T03:28:31.150

Two things:

*   collection `-copy` is always shallow. It doesn't copy the collections elements (In fact, nothing guarantees that these elements are even copyable – i.e. are conforming to `NSCopying` protocol). This explains why `obj` is not copied – it doesn't get any extra retain.

*   Foundation tries to optimizes its implementation of `-copy` to `-retain` whenever is possible. For example, `-[NSString copy]` is a retain for immutable strings. Since collection copies are shallow, the same optimization works for immutable collections. That's why `array` is not copied but just retained.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T03:05:41.507

在这种情况下没有制作副本的原因`NSArray`是*不可变*的。您不需要复制它来防止对数组进行更改，因为无法进行此类更改；保留相同的不可变数组就足够了。

如果你尝试这个实验`NSMutableArray`，你会得到不同的结果。

# java - 播放音效 (mp3)

> ID：12031795
> 
> 赞同：0
> 
> 时间：2012-08-20T02:54:52.343
> 
> 标签：java, mp3, media-player, jmf, javasound

有谁知道如何在 Java 中播放 mp3 文件？我有一点想要播放的音效。这就是我所拥有的

```
import java.io.*;
import java.media.*;

File mp3Correct;
Player correct;

/* Load mp3 files */
mp3Correct = new File ("C:\\correct.mp3");

/* Create media players */
correct = Manager.createPlayer( mp3Correct.toURI() );  //<--error

/* Play the sound effect */
correct.start(); 
```

这是错误消息：

> 没有找到适合 createPlayer(URI) 的方法
> 
> ```
> method Manager.createPlayer(DataSource) is not applicable
>   (actual argument URI cannot be converted to DataSource by method invocation conversion)
> method Manager.createPlayer(MediaLocator) is not applicable
>   (actual argument URI cannot be converted to MediaLocator by method invocation conversion)
> method Manager.createPlayer(URL) is not applicable
>   (actual argument URI cannot be converted to URL by method invocation conversion) 
> ```

根据Java文档，

> 创建播放器的最简单方法是使用 URI 语法中的定位器。给定一个定位器，createPlayer 将创建一个适合处理由定位器识别的媒体的播放器。

但我不知道我做错了什么。任何人都可以帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:00:53.183

我想你想要`toURL()`。

# android - 将 Android 标准输出和标准错误消息的 FFMPEG 重定向回文本视图控件

> ID：12031800
> 
> 赞同：0
> 
> 时间：2012-08-20T02:56:05.187
> 
> 标签：android, ffmpeg, stdout, stderr, response.redirect

在@rowntreerob 的帮助下，我成功地构建了适用于 Android 库/共享对象的 FFMpeg，以便在 Android 应用程序中使用。

如何捕获由于运行 FFMpeg 命令而发出的 stdout 或 stderr 消息，并在发出 FFMpeg 命令的同一 Android 应用程序中的 TexView 小部件中显示消息？

此外，当 FFMPeg 连接到（Wowza/Flash 媒体服务器）-FMS 时，FMS 会发出 CONNECTING、CONNECTED 和 STREAMING 消息。如何在发出 FFMpeg 命令的应用程序中捕获这些消息并使用 Toast 显示它们。

示例代码真的很有帮助。TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T21:43:27.923

/dev/null 通常获取 dalvik 的控制台输出。

您需要了解文件系统、流、重定向...

尝试[在这里阅读](https://stackoverflow.com/questions/6606366/make-consolehandler-output-appear-in-logcat-output)

# c - 如何在C中复制数组的数组？（字符串数组到另一个字符串数组）

> ID：12031805
> 
> 赞同：2
> 
> 时间：2012-08-20T02:57:04.230
> 
> 标签：c, arrays, string, multidimensional-array

我正在做 Zed Shaw 的*Learn C The Hard Way*课程。在练习 11 中，在额外学分问题 #2 中，他问：

> 1.  使用 i-- 从 argc 开始倒数到 0，使这些循环倒数。您可能需要做一些数学运算才能使数组索引正常工作。
>     
>     
> 2.  使用 while 循环将值从 argv 复制到状态。

我尝试：

```
#include <stdio.h>

int main(int argc, const char *argv[]){

    int i = argc - 1;
    while(i >= 0){
        printf("arg %d: %s\n", i, argv[i]);
        i--;
    }

    char *states[] = {
        "California", "Oregon",
        "Washington", "Texas"
    };

    int num_states = 4;
    i = num_states - 1;
    while( i >= 0){
        printf( "state %d, %s\n", i, states[i]);
        i--;
    }

    i = 0;
    while(i < argc && i < num_states){
        int j = 0;
        while( (states[i][j++] = argv[i][j++]) != '\0' ){
            i++;
        }
        states[i][j] = '\0';
    }

    i = num_states - 1;
    while( i >= 0){
        printf( "state %d, %s\n", i, states[i]);
        i--;
    }

    return 0;
} 
```

我得到一个`Segmentation Fault`. 我知道您不能在 C 中复制数组，它们是 const 指针或类似的东西（或者我读过）。这就是为什么我尝试逐个字符地复制：

```
while(i < argc && i < num_states){
    int j = 0;
    while( (states[i][j++] = argv[i][j++]) != '\0' ){
        i++;
    }
    states[i][j] = '\0';
} 
```

然而它不起作用。我该怎么做？当我编译时，编译器给了我这个警告：

```
$ make ex11
cc -Wall -g    ex11.c   -o ex11
ex11.c: In function ‘main’:
ex11.c:26:28: warning: operation on ‘j’ may be undefined [-Wsequence-point] 
```

我不明白为什么它说这`j`是未定义的。 `valgrind`说：

```
$ valgrind ./ex11 this is a test
==4539== Memcheck, a memory error detector
==4539== Copyright (C) 2002-2012, and GNU GPL'd, by Julian Seward et al.
==4539== Using Valgrind-3.8.0 and LibVEX; rerun with -h for copyright info
==4539== Command: ./ex12 this is a test
==4539== 
arg 4: test
arg 3: a
arg 2: is
arg 1: this
arg 0: ./ex11
state 3, Texas
state 2, Washington
state 1, Oregon
state 0, California
==4539== 
==4539== Process terminating with default action of signal 11 (SIGSEGV)
==4539==  Bad permissions for mapped region at address 0x400720
==4539==    at 0x4005F1: main (ex11.c:26)
==4539== 
==4539== HEAP SUMMARY:
==4539==     in use at exit: 0 bytes in 0 blocks
==4539==   total heap usage: 0 allocs, 0 frees, 0 bytes allocated
==4539== 
==4539== All heap blocks were freed -- no leaks are possible
==4539== 
==4539== For counts of detected and suppressed errors, rerun with: -v
==4539== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 2 from 2)
Segmentation fault 
```

[编辑 1] 为此切换了我的代码

```
int i = 0;
while( i < argc && i < num_states ){
    states[i] = argv[i];
    i++;
} 
```

它确实有效，但编译器给了我一个警告。另外，我在发布这个问题后意识到我以前的问题：

```
while( (states[i][j++] = argv[i][j++]) != '\0' ){
    i++;
} 
```

完全是错误的。因为`j++`每个循环执行两次，并且`i++`应该在外循环中的该循环之外。而且正如下面评论中提到的，我尝试使用数组数组进行的逐字节复制不起作用，因为我实际上有指针数组。

也就是说，有没有办法在没有编译器警告的情况下做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T03:13:57.440

一个问题（导致 SEGV 的问题）是，虽然`states`是 的数组`char *`，但您正在使用一堆字符串文字（它们是`const char *`）对其进行初始化。因此，您至少应该在该行收到警告。当您尝试写入字符串常量（位于只读内存中）时，这会咬您一口。

现在，如果您真的想一次将字符串从一个字节复制`argv`到`states`一个字节（而不仅仅是复制指针——例如`states[i] = argv[i]`），您需要确保它`states[i][j]`是可写的。您可以通过创建`states`一个字符数组数组而不是一个指向字符的指针数组来做到这一点：

```
char  states[][16] = {
    "California", "Oregon",
    "Washington", "Texas"
}; 
```

当然，这些是固定大小的数组，所以你需要担心它们会溢出，但是你已经遇到了 states 数组本身溢出的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-07T22:00:06.420

我自己刚刚完成了那个练习，并且在完成之后对复制进行了更多的研究（正如 Zed 建议的那样）。这就是我所做的，没有问题。

```
 i = 0;
    num_states = NELEMS(states);

    while(i < argc  && i <= num_states) {
            states[i] = argv[i];
            i++;
    } 
```

# linker - '警告：(x86_64) library.a(object.o) object file library.a(object.o) 不包含 x86_64 的体系结构信息。

> ID：12031807
> 
> 赞同：1
> 
> 时间：2012-08-20T02:57:44.360
> 
> 标签：linker, x86, osx-lion

这可能与我的其他问题有关（将[代码从雪豹迁移到山狮，使用 'x86_64' 生成和链接错误](https://stackoverflow.com/questions/12031786/migrating-code-from-snow-leopard-to-mountain-lion-make-and-linking-errors-with)）。我正在尝试使用我在雪豹上制作的库在山狮上构建一个程序，但我一直收到这个错误。我不知道它的**真正**含义，也不知道该怎么做。谁能指出我（最好是正确的）方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T10:47:46.893

我假设您已迁移到新版本的 XCode。您是否清除了旧的 .o 和 .a 并重建它们？

# python - 在 Python 中声明类变量的两种最佳方法

> ID：12031811
> 
> 赞同：1
> 
> 时间：2012-08-20T02:58:29.380
> 
> 标签：python, class

我通常在 Python 中声明要在实例中使用的类变量的方式如下：

```
class MyClass(object):
  def __init__(self):
    self.a_member = 0

my_object = MyClass()
my_object.a_member    # evaluates to 0 
```

但以下也有效。这是不好的做法吗？如果是这样，为什么？

```
class MyClass(object):
  a_member = 0

my_object = MyClass()
my_object.a_member    # also evaluates to 0 
```

第二种方法在 Zope 各处都在使用，但我在其他任何地方都没有见过。这是为什么？

编辑：作为对 sr2222 答案的回应。我知道两者本质上是不同的。但是，如果该类仅用于实例化对象，则两者的工作方式相同。那么使用类变量作为实例变量是不是很糟糕？感觉会是这样，但我无法解释为什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T03:12:35.273

问题是这是*类*本身的属性还是*特定对象*的属性。如果整个类的事物都具有某个属性（可能有一些小例外），那么一定要为该类分配一个属性。如果某些奇怪的对象或子类在此属性上有所不同，则可以根据需要对其进行覆盖。此外，这比为每个对象分配一个基本恒定的属性更节省内存；只有类`__dict__`具有该属性的单个条目，并且`__dict__`每个对象的 可能保持为空（至少对于该特定属性）。

简而言之，您的两个示例都是非常惯用的代码，但它们在机器级别和人类语义级别上的含义有些不同。

* * *

让我解释一下：

```
>>> class MyClass(object):
...       a_member = 'a'
...
>>> o = MyClass()
>>> p = MyClass()
>>> o.a_member
'a'
>>> p.a_member
'a'
>>> o.a_member = 'b'
>>> p.a_member
'a' 
```

在第二行，您正在设置“类属性”。这实际上是名为“MyClass”的对象的属性。它存储为`MyClass.__dict__['a_member'] = 'a'`. 在后面的几行中，您将*object*属性设置`o.a_member`为。这完全等同于`o.__dict__['a_member'] = 'b'`。可以看到，这与单独的字典无关`p.__dict__`。访问`a_member`p 时，在对象字典中找不到它，并推迟到它的类字典：`MyClass.a_member`. 这就是为什么修改 的属性`o`不会影响 的属性`p`，因为它不会影响 的属性`MyClass`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-20T02:59:37.467

第一个是实例属性，第二个是类属性。它们根本不一样。实例属性附加到类型的实际创建对象，而类变量附加到类（类型）本身。

```
>>> class A(object):
...     cls_attr = 'a'
...     def __init__(self, x):
...         self.ins_attr = x
...
>>> a1 = A(1)
>>> a2 = A(2)
>>> a1.cls_attr
'a'
>>> a2.cls_attr
'a'
>>> a1.ins_attr
1
>>> a2.ins_attr
2
>>> a1.__class__.cls_attr = 'b'
>>> a2.cls_attr
'b'
>>> a1.ins_attr = 3
>>> a2.ins_attr
2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T03:28:37.533

I have my answer! I owe to @mjgpy3's reference in the comment to the original post. The difference comes if the value assigned to the class variable is MUTABLE! THEN, the two will be changed together. The members split when a new value replaces the old one

```
>>> class MyClass(object):
...   my_str = 'a'
...   my_list = []
... 
>>> a1, a2 = MyClass(), MyClass()
>>> a1.my_str # This is the CLASS variable.
'a'
>>> a2.my_str # This is the exact same class variable.
'a'
>>> a1.my_str = 'b' # This is a completely new instance variable. Strings are not mutable.
>>> a2.my_str # This is still the old, unchanged class variable.
'a'
>>> a1.my_list.append('w') # We're changing the mutable class variable, but not reassigning it.
>>> a2.my_list # This is the same old class variable, but with a new value.
['w'] 
```

Edit: this is pretty much what bukzor wrote. They get the best answer mark.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T03:15:23.330

即使您从不修改对象的内容，两者也不能互换。我理解它的方式，访问类属性比访问实例属性稍慢，因为解释器本质上必须采取额外的步骤来查找类属性。

### 实例属性

“什么`a.thing`？”

### 类属性

“什么`a.thing`？哦，a没有实例属性`thing`，我去查一下它的类……”

# architecture - 安全隧道

> ID：12031812
> 
> 赞同：-1
> 
> 时间：2012-08-20T02:58:35.567
> 
> 标签：architecture, ssh, vpn, tunnel, tunneling

我想构建一个像以下这样的系统来集中管理设备。该系统将具有以下组件：

1.  云端服务器
2.  位于 NAT 后面的代理，用于管理设备。代理应该能够与云服务器通信。

基本上系统将按以下方式工作：

1.  NAT 后面的设备应该在云服务器上可见。
2.  云服务器应该能够远程管理设备。

所以我们想在 Cloud Server 和 Remote Agent 之间建立隧道，这样我们就可以通过 NAT 来远程管理 NAT 后面的那些设备。我们需要以编程方式在隧道上运行 TCP/UDP/HTTP 协议，并发隧道需要支持 10K 级别。

目前我们调查了SSH隧道和VPN隧道，但仍然不知道如何做。所以问题是：

1.  可以使用什么样的技术来构建上述隧道，以便云服务器可以管理 NAT 后面的设备？
2.  如何以编程方式实现它，现在有可用的库吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T08:36:28.630

Q1：使用 SSH 反向隧道进行 TCP 转发。

Q2：有 Apache SSHd 用于 SSH 服务器，jsch 用于 SSH 客户端。

# php - MySQL WHERE 基于 PHP 变量

> ID：12031814
> 
> 赞同：0
> 
> 时间：2012-08-20T02:59:20.477
> 
> 标签：php, mysql, sql, dynamic

我有一个表格，我收集了一堆基本信息（姓名、电子邮件等），然后将其发布到数据库中。在该表单上，我使用 php 日期函数插入“日”、“月”和“年”数据库列，以便显示表单数据提交的日期。

我想将它输出到一个表中（这样我就可以在不登录数据库的情况下检查它），并且我希望该表默认为当前日期。我认为这样的事情会起作用，但它没有：

```
$query="SELECT * FROM form_data WHERE day='echo date("d");' AND month='echo date("m");' AND year='echo date("Y");'"; 
```

最终，我希望有一些显示表格的日期选择框，这样我就可以选择我想要的任何日期，提交并将相关数据返回到表格中。但第一步只是让表格默认显示今天的当前数据。

如果有人可以提供帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T03:32:28.940

为了使线程完整，我将继续并提出建议`mysqli::prepare`。正如[这里](http://php.net/manual/en/mysqli.prepare.php)所说，它准备查询并返回一个句柄。
防止SQL注入，降低查询解析开销，提高代码可读性。总而言之，使用准备是一个更好的做法。
这就是你的做法：

```
$database = new mysqli('localhost', 'username', 'password', 'database');
if ($stmt = $database->prepare("SELECT * FROM form_data WHERE day=? AND month=? AND year=?")) {
  $stmt->bind_param('sss', date("d"), date("m"), date("Y"));
  $stmt->execute();
  $result = $stmt->get_result();
  $stmt->close();
}
$database->close(); 
```

在上面的代码`$result`中包含从数据库读取的行。

这是 PDO 版本：

```
$stmt = $database->prepare("SELECT * FROM form_data WHERE day=? AND month=? AND year=?")
$stmt->execute(array("".date("d"), "".date("m"), "".date("Y"))); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T03:03:33.103

你不能做 echo date("d"); 在 sql 语句中，否则您将有效地将语句放入语句中。

您必须保存您的回声日期（“d”）；进入一个变量，然后做类似的事情

```
$myDay = date("d");
$myMonth = date("m");
$myYear = date("Y");
$query="SELECT * FROM form_data 
        WHERE day='$myDay' 
        AND month='$myMonth' 
        AND year='$myYear'"; 
```

或使用分离。像射他们一样

```
 $query="SELECT * FROM form_data 
         WHERE day='".date("d")."' 
         AND month='".date("m")."' 
         AND year='".date("Y")."'"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T03:04:35.857

就像是

```
$query="SELECT * FROM form_data WHERE day='" . date("d") . "' AND month='" . date("m") . "' AND year='" . date("Y") . "'"; 
```

应该管用。

调试查询的好方法是将它们作为字符串输出，以查看 PHP 是如何解释它的。

```
echo "SELECT * FROM form_data WHERE day='" . date("d") . "' AND month='" . date("m") . "' AND year='" . date("Y") . "'" 
```

另请注意，此方法受 SQL 注入的影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-18T07:55:31.717

我使用它，它对我有用， `select * from record where date1=CURDATE()` 我希望这是你想要做的

# google-app-engine - Eclipse Juno 4.2 Google 插件未安装：无法完成安装，因为找不到一个或多个必需项目

> ID：12031817
> 
> 赞同：3
> 
> 时间：2012-08-20T02:59:41.990
> 
> 标签：google-app-engine, gwt, eclipse-plugin, eclipse-juno

这是我收到的错误消息：

```
Cannot complete the install because one or more required items could not be found.
  Software being installed: Google App Engine Tools for Android 3.1.0.v201208080121-rel-r42 (com.google.gdt.eclipse.mobile.android.feature.feature.group 3.1.0.v201208080121-rel-r42) 
```

我尝试了很多东西，包括从[这里](https://developers.google.com/eclipse/docs/install-from-zip)手动下载文件，还窥探了 StackOverflow，我尝试将所有插件从手动下载移动到我的 Eclipse 的插件文件夹中。但这对我没有帮助，因为我的观点没有随插件更新，而且我找不到“创建新的 Web 应用程序”选项。我还阅读了一些关于 XML 文件错误的内容，但我找不到它，而且这些内容是针对其他 Eclipse 版本的，所以我不知道它是否适用于我。

我还尝试排除适用于 Android 3.1.0 的 Google App Engine 工具，但它只是说找不到列表中的下一个。

我很乐意提供更多信息。我正在运行 Eclipse Juno 4.2 和 Java 1.7（不过我也安装了 1.6）。我正在使用 Windows 7 电脑。非常感谢你们！我只想编码：[

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-20T16:47:48.970

我没有使用此 URL 为我工作：`http://dl.google.com/eclipse/plugin/4.2`

它适用于这个：`http://dl.google.com/eclipse/plugin/3.8`

我刚改成`4.2`.`3.8`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T13:36:34.967

我遇到了类似的问题，每次下载失败时，我都以**120 kb/s 的速度下载，当我移动到另一个地方并以****400 kb/s 的**最高速度下载插件时，它成功下载，没有发现问题您可能认为问题已经解决逻辑，但我到目前为止达到的希望有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-25T05:35:08.503

我知道这是一个非常古老的问题，但最近我找到了解决问题的方法，因此我将亲自更新答案。出于某种原因，Eclipse Classic 4.2.2 Juno 没有附带一些必需的软件包。在与一些人交谈后，他们建议只需下载[适用于 Java EE 开发人员的 Eclipse IDE，它只](http://www.eclipse.org/downloads/packages/eclipse-ide-java-ee-developers/junosr2)附带了大部分必需的包。从那里开始，它就起作用了！

我的朋友还提到您可以尝试在 Eclipse Classic 上手动下载软件包，但这更麻烦。

希望这可以帮助！

# ruby-on-rails - 在 Rails 应用程序中放置完全杂项代码的位置

> ID：12031824
> 
> 赞同：1
> 
> 时间：2012-08-20T03:01:06.490
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个可与多个 3rd 方 API 配合使用的 rails 应用程序。其中一些 API 受到速率限制，许多 API 的方法可能需要数小时才能完成，您必须不断检查您的请求是否已准备好。因此，我建立了一个排队系统来管理所有的行李。

进入此队列的每个请求都有一个 JSON 字符串，其中详细说明了请求所属的第 3 方 API、哪种方法、哪些参数以及处理响应的回调。我将需要很多回调方法，它们处理截然不同的任务。一些更新第 3 方的服务状态，一些更新客户信息，一些创建另一个排队请求以下载大型 CSV 或解析 CSV，等等。

我不确定将所有这些不相关的回调方法放在哪里。它们种类繁多，并且涉及许多不同的模型，以至于我不确定将它们置于 QueuedRequest 模型下是否正确（尽管这似乎是最简单的，尤其是在测试方面）。我想将它们合并在一个地方（再次使测试更容易），因此试图将它们硬塞到相关模型中（尽管它们通常可能根本与模型无关）是行不通的。

各种实用程序类似乎是最好的地方，但我会把那个文件放在哪里？

**详细信息：** Rails 3.2.6

* * *

**更新：**为了详细说明下面的答案，我最终做的是在 /lib/api.xml 中放置一个实用方法模块。我在 /config/application.rb 中将 /lib/api 添加到我的 autoload_paths 中，并且**未提及**，我创建了一个初始化程序来为我将模块加载到我的应用程序中。

**/lib/api/callbacks.rb**

```
module Callbacks
  extend self
  def some_method
    # magic
  end
end 
```

**/config/application.rb**

```
config.autoload_paths += %W(#{config.root}/lib/api) 
```

**/config/initializers/application.rb**

```
require 'callbacks' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T04:05:11.143

在该`lib`目录下，不要忘记将它添加到您的自动加载路径（如果您的应用程序是线程安全的，则添加到 eagerload 路径！）。创建一个名为的文件夹`api`，然后将这些内容粘贴到命名空间中

例如，`lib/api/stack_overflow.rb`

```
module API
   class StackOverflow
     # schtuff
   end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T03:50:39.063

你总是可以把它扔到 lib 文件夹中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T03:55:21.153

我正在开发一个查询外部 API 并将数据呈现给用户而不实际将其保存到数据库的应用程序。这个过程涉及到各种元素（将 API 密钥和用户 ID 传递给 API，验证请求中的查询参数，解析响应等）与实际的 rails 应用程序没有太大关系（这将主要集中在向用户呈现这些数据），所以我将所有 API 内容拆分到`lib`.

通过这种方式，我可以将其与主应用程序分开测试，从而实现关注点的清晰分离。此外，由于我的库类不是基于 activemodel，因此可以将库分离到自己的 gem 中，并可能用于其他非 Rails 项目。例如，我考虑过为 sinatra 切换轨道，考虑到当前的设置，这很容易做到。

# jquery - 如何使用 jQuery 建立 Django 网站

> ID：12031825
> 
> 赞同：32
> 
> 时间：2012-08-20T03:01:10.177
> 
> 标签：jquery, django

我不知道为什么，但我不知道如何在我的网站上激活 jQuery。所有做教程“在 Django 上启动 jQuery”的网站都开始使用 JQuery 已经在他们的网站上工作。无论如何，我没有下载它并将其放在我的文件夹中的某个地方，而是决定采用欺骗方式并使用谷歌的。因此，在我的基本页面中，我有以下代码

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js">
</script> 
```

一切都很好，直到我不得不添加一些库。如何设置我自己的 jQuery 以便它与我的模板一起使用？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-08-20T03:01:10.177

最后，事实证明这很容易。这就是一个人所要做的：

首先，在您的文件夹应用程序中创建一个名为`static`的文件夹：

```
mySite
---mytemplates
---mySite
---myApp
------static 
```

[然后从他们的网站下载](http://jquery.com/)jQuery 。您单击“下载”，它将带您到包含所有代码的不同页面。左键单击代码并选择“另存为...”。将其保存在`static`文件夹中。

在你的`settings.py`文件中确保它`django.contrib.staticfiles`在下面`INSTALLED_APPS`（默认情况下它在那里）。

最后，在您的基本页面内有

```
<script type="text/javascript" src="{{ STATIC_URL }} /static/jquery-1.8.0.js">
</script> 
//Make sure that the jQuery name is correct. With updates and different versions, 
//the number after 'jquery' will change 
```

现在您可以在整个站点中使用 jQuery！（只要这些页面扩展了您的基本页面。如果他们不这样做，他们将需要在其 html 中的上述代码。）

在我的本地机器上工作时，这对我有用。我还没有尝试实际部署我的网站，所以我希望这仍然有效。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-08-30T15:16:42.790

你也可以随便`pip install django-jquery`，装`jquery`进去`INSTALLED_APPS`。当然，你需要`collectstatic`像往常一样运行之后。:)

这样，`requirements.txt`如果您使用它，您就可以将它放在您的文件中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-03-03T16:11:12.970

您也可以使用 python 包`django-static-jquery`。目前，它带有更新的 jquery 库。

`pip install django-static-jquery=='version'`. 包和安装信息在这里[https://pypi.python.org/pypi/django-static-jquery/](https://pypi.python.org/pypi/django-static-jquery/)

看起来另一个包`django-jquery`有一段时间没有更新了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-21T07:29:36.407

我把我的 jquery 文件和 SaiyanGirl 放在了同一个地方。

在我的设置中，我默认在 INSTALLED_APPS 中有这个：'django.contrib.staticfiles'，

在我的 html 页面的顶部，我有这个：

```
{% load static %}
<!DOCTYPE html> 
```

我的头标签中有这个：
`<script type="text/javascript" src="{% static 'jquery-3.5.0.js' %}"></script>`

这就是我测试它的方式（也在 head 标签中）：

```
<script type="text/javascript"> 
window.onload = function() {
   if (window.jQuery) {
      alert('jQuery is loaded');
   } else {
      alert('jQuery is not loaded');
</script> 
```

# django - Django wsgi 和文件权限

> ID：12031827
> 
> 赞同：0
> 
> 时间：2012-08-20T03:01:16.660
> 
> 标签：django, mod-wsgi

当我通过 runserver 在 localhost 中运行 django 时，我看到 .py 文件被编译为 .pyc。

当我使用 apache 和 mod_wsgi 将所有内容部署到服务器时 - www 用户是否应该对我的应用程序的文件夹具有写入权限？所以它将能够创建 .pyc

当然，拥有写权限不是一个好主意——如果我删除它，会减慢应用程序的速度；还是编译的python代码缓存在内存中？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T03:17:01.903

`.pyc`文件仅用作解释器调用之间的字节码缓存；如果存在，Python 将使用它们，但重新编译代码没有问题。因此，要回答您的问题，您无需授予 WSGI 应用程序对源位置的写入权限。

# unix - #file# 和 file~ 是什么，我怎样才能摆脱它们？

> ID：12031830
> 
> 赞同：31
> 
> 时间：2012-08-20T03:01:33.797
> 
> 标签：unix, emacs

我最初有三个文件：`makefile`、`readme.txt`和`hashtable.c`在我的目录中，我正在用 emacs 编写代码。我注意到一些新文件：`#hashtable.c#`、`#readme.txt#`、`hashtable.c~`和`makefile~` 已创建。我想知道这些文件是什么。这些重要吗？如果不重要，我如何告诉emacs停止制作它们？我也很好奇为什么`readme.txt`没有得到波浪号文件并且`makefile`没有得到一个清晰的文件。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-20T03:03:10.423

带有 的`~`文件是保存文件时自动创建的备份文件。`#`readme.txt是当前正在编辑/正在使用的`#`文件（即自动保存版本）。当您正常退出 emacs 时，这通常会消失（与`~`文件不同）（如果它崩溃或被杀死，＃文件可能会保留）。

您可能会发现有关[emacs 备份文件](http://snarfed.org/gnu_emacs_backup_files)的页面，以及这个 SO 问题：[我如何控制 Emacs 制作备份文件的方式？](https://stackoverflow.com/questions/151945/how-do-i-control-how-emacs-makes-backup-files)

您可以使用以下方法阻止创建备份文件：

```
(setq make-backup-files nil) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-09-12T22:51:42.930

我建议安装[`no-littering`](https://github.com/emacscollective/no-littering). 它会自动将备份文件 ( `file~`) 放入`~/.emacs.d/var/backup/`. 它对自动保存 ( ) 没有任何作用`#file#`，但有一条关于将这些文件放在 README 中的指定目录中的说明：

```
(setq auto-save-file-name-transforms
      `((".*" ,(no-littering-expand-var-file-name "auto-save/") t))) 
```

这些东西实际上都没有阻止 Emacs 创建这些文件，但我假设大多数人确实想要这些文件（以防崩溃），但不希望它们散布在文件系统中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-15T06:44:19.147

对于#files#，您必须`rm "#file#"`从终端执行，因为`rm #file#`它不起作用。对于 ~file 你可以简单地 digit `rm ~file`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-15T08:59:17.810

也许你可以尝试：

`find . -name \\#*\\# | xargs rm`

警告：这将删除那些在子目录中匹配的文件。

# apache-flex - 将多个位图/光栅图像动态组合成一个

> ID：12031832
> 
> 赞同：0
> 
> 时间：2012-08-20T03:01:55.360
> 
> 标签：apache-flex, actionscript, air

我正在创建一个通过相机捕获多张图像的 Air/flex 应用程序。现在我有了图像，我想将少数捕获的图像“粘贴”到另一个图像（我的主图像）上的预定义位置。任何人都可以提供一个例子或指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T13:02:33.053

您可以将此代码粘贴到项目中进行测试，注释会逐步向您展示它是如何工作的。希望这是你需要的！

```
import flash.display.BitmapData;
import flash.geom.Rectangle;
import flash.geom.Point;
import flash.display.Bitmap;

// This rectangle represents your photo: 500x500, pure red.
var myPhoto:BitmapData = new BitmapData (500,500,false,0xff0000)
// This is another photo (green rectangle) as Bitmapdata, also 500x500 px
var somethingToDrawOnTop:BitmapData = new BitmapData (500,500,false, 0x00ff00)
// Select a region of the green picture: a 50x50 region located at 100,100 of the green pic
var regionToCopy:Rectangle = new Rectangle(100,100,50,50)
// Decide where you want the copied green region to end up in the red picture
var destinationForTheCopy:Point = new Point(250,250)
// Copy the pixels
myPhoto.copyPixels(somethingToDrawOnTop, regionToCopy, destinationForTheCopy)

// show the result
var compositBitmap:Bitmap = new Bitmap(myPhoto)
addChild (compositBitmap) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:24:20.167

[BitmapData.copyPixels() 方法](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#copyPixels%28%29)

# javascript - 要弹出的javascript文本字段

> ID：12031840
> 
> 赞同：2
> 
> 时间：2012-08-20T03:03:23.697
> 
> 标签：javascript, html, forms

在这里问了原始问题： [Javascript - text field submits to a popup window](https://stackoverflow.com/questions/12015324/javascript-text-field-submits-to-a-popup-window)

马修很友善地帮助和回答。

我有一个奇怪的问题，主页上的代码不起作用 - 每次都会进入警报。但在其他页面上 - 它似乎工作正常。

测试使用代码：120663A

向下滚动并输入上面的批号

*非常*欢迎任何建议/帮助？

谢谢乔伊

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T03:25:55.657

实际上，您的两个网站都可以工作，但您没有处理大写。在[http://freshomega.com/w/](http://freshomega.com/w/)你的代码说：

```
if ($('input[type=text]').val() == "120663A") { 
```

然后在[http://freshomega.com/w/tester](http://freshomega.com/w/tester)你的代码说：

```
if ($('input[type=text]').val() == "120663a") { 
```

看到不同？如果你直接在第一个输入“120663a”，它不会工作，因为它正在寻找大写字母 A。也许你可以用 .toLowerCase() 或 .toUpperCase() 让它完全忽略大小写？希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T03:58:09.977

尽管您保留`text-transform: uppercase`在两个页面中。当您输入**120663a**时， $('input[type=text]').val() 仅显示**120663a**。

这就是为什么`if ($('input[type=text]').val() == "120663a") {` 在[http://freshomega.com/w/tester](http://freshomega.com/w/tester) 工作并且

`if ($('input[type=text]').val() == "120663A") {`在[http://freshomega.com/w/](http://freshomega.com/w/)中不起作用。我希望这将有所帮助。

您可以在两个页面中测试**120663A**，结果会相反。

为了解决这个问题，我将使用 toUpperCase() 函数将输入文本在两个页面中更改为大写以保持一致性，或者将两者都更改为小写。

例如，

```
if ($('input[type=text]').val().toUpperCase() == "120663A") {
    window.open("http://freshomega.com/w/files/120663A.pdf"); 
```

我希望这会有所帮助。

# php - 使用 JavaScript 剪切 url 的 GET 部分，包括？

> ID：12031846
> 
> 赞同：0
> 
> 时间：2012-08-20T03:04:04.527
> 
> 标签：php, javascript, jquery, ajax, include

我现在尝试了很多事情，但有些事情让我很难过，比如使用 ajax 包含一个处理父文件的 GET 请求的文件。所以不要说包括`file.php`我会包括`file.php?all_gets=all&from=the_parent_file`

父文件`file.php`使用 ajax 调用，它可以工作，但是当我要求它时，`var_dump($_GET)`它会显示为数组 0，即使父框架中有一个`$_GET`。现在，当我尝试包含`file.php?get=somegetvar`然后我`var_dump()`它时，它为我提供了包含页面的 $_GET。我现在的问题是如何使用它`$_GET`从使用 JS 的父文件（包括`file.php`）传输到包含文件，所以“file.php”+gets

这可能吗？我真的很难过 - 这可能是我的解决方案......

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T03:07:52.517

你可以检查

window.location.href ：将返回包括参数在内的整个 url

window.location.search ：将只返回参数

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T03:30:24.347

这是你想要的？

```
<script>
    var getVars = JSON.parse("<?= json_encode($_GET) ?>");

    $.ajax({
        url: "",
        data: getVars,
        //[...]
    });

</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T03:05:24.670

我不确定我是否理解你的问题，但只要离开标题，你就可以使用这个：

```
str = str.replace(/\?.+/, ""); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T03:06:23.467

尝试以下 jquery 插件：

*   **[https://github.com/allmarkedup/jQuery-URL-Parser](https://github.com/allmarkedup/jQuery-URL-Parser)**（推荐）

*   [http://benalman.com/projects/jquery-urlinternal-plugin/](http://benalman.com/projects/jquery-urlinternal-plugin/)

*   [http://benalman.com/projects/jquery-bbq-plugin/](http://benalman.com/projects/jquery-bbq-plugin/)

他们是 url 操作库

# css - 在我重新设计时无法让 iFrame 在 Internet Explorer 中工作

> ID：12031848
> 
> 赞同：1
> 
> 时间：2012-08-20T03:04:22.893
> 
> 标签：css, internet-explorer, google-chrome, html

我正在对我的网站进行一些小的重新设计，并且正在努力使用 iFrame 来显示谷歌地图。iFrame 在 Chrome 中显示没有问题，但在 IE9 中没有。有趣的是，我可以看到它开始加载（有时甚至会看到“地图/卫星/地形”选项在正确加载时显示，但随后框架变为空白。我没有更改创建代码地图，它在我的 Chrome 和 IE 中的网站生产版本上运行良好。它一定是我正在使用的新 DIV 的东西，但我似乎找不到它。要在上下文中查看它，在这里是两个网站：
制作：[http](http://www.findthefishing.com/guidepage.php?guideID=42)
://www.findthefishing.com/guidepage.php?guideID= 42 重新设计：[http ://www.findthefishing.com/guidepage2.php?guideID=42](http://www.findthefishing.com/guidepage2.php?guideID=42)

以下是相关的代码：

```
<div id="guidepagecontent">
<div id="guidepagemapcont">
<div id="guidepagemap">
<iframe width="300" height="300" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com/maps?q=4000+Crandon+Blvd,+Key+Biscayne,+FL&hl=en&z=14&amp;iwloc=A&amp;output=embed"></iframe><br><a href="https://maps.google.com/maps?q=4000+Crandon+Blvd,+Key+Biscayne,+FL&hl=en&z=14" target="_blank"> View Larger Map</a></div>
</div>

#guidepagemapcont {
float: right;
width: 310px;
margin: auto;
position: relative;
}

#guidepagemap {
background-color: #ffffff;
padding:0px 0px 10px 10px; 
font-size: 14px;
text-align:center;
}

#guidepagecontent {
padding: 10px;
font-size: 12px;
background-color: #ffffff;
position: relative;
} 
```

如果有人能给我一些见解，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T09:06:36.890

新页面上的 HTML 有很多问题：

1.  没有声明文档类型
2.  声明了两个 HEAD 部分 - 一个在正确的位置，一个在 BODY 标记内

修复这些和任何其他 HTML 问题可能会解决您的问题。

# opencv - 使用 OpenCV 调整图像大小

> ID：12031849
> 
> 赞同：1
> 
> 时间：2012-08-20T03:04:32.920
> 
> 标签：opencv

我正在尝试使用[http://docs.opencv.org/trunk/modules/contrib/doc/facerec/facerec_tutorial.html](http://docs.opencv.org/trunk/modules/contrib/doc/facerec/facerec_tutorial.html)在 OPencv 中进行面部识别。但是我不断收到此错误：

```
 OpenCV Error: Unsupported format or combination of formats
    (In the Eigenfaces method all input samples (training images) must
    be of equal size! Expected 307200 pixels, but was 4915200 pixels.) 
    in train, file /home/itsy/Desktop/OpenCV-2.4.2/modules/contrib/src/facerec.cpp, line 326 
```

所以我决定使用

```
for(int i=0; i < images().size; i++)
     resize(images[i],images[0],images[0].size(),0,0, INTER_NEAREST ); 
```

其中 images 是 Mat 类型的向量，包含所有加载的图像。但是当我尝试编译它时，它告诉我：

```
facerecognition.cpp:141:27: error: no match for call to ‘(std::vector<cv::Mat>) ()’ 
```

这是 for(..) 所在的行。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T03:08:20.980

由于`images`不是函数，`images().size`因此没有任何意义。你想要`images.size()`，因为`images.size`是一个函数。

# php - 复选框数组只返回一个结果

> ID：12031851
> 
> 赞同：4
> 
> 时间：2012-08-20T03:04:50.787
> 
> 标签：php, html, forms

我已经构建了一个具有复选框输入数组的表单（保存到数组）。但是，当我发布它并检索结果时，它只提供最后一个选择。

```
<input type="checkbox" value="Friendly" name="quest[9]"> Friendly<br>
<input type="checkbox" value="Attentive" name="quest[9]"> Attentive<br>
<input type="checkbox" value="Enthusiastic" name="quest[9]"> Enthusiastic<br>
<input type="checkbox" value="Understanding" name="quest[9]"> Understanding<br>
<input type="checkbox" value="Well Mannered" name="quest[9]"> Well Mannered<br>
<input type="checkbox" value="Efficient" name="quest[9]"> Efficient<br>
<input type="checkbox" value="Genuine" name="quest[9]"> Genuine<br> 
```

例如，假设我选择了“友好”、“高效”和“正版”。

当我将其发布到 PHP 文档并运行时

```
print_r($_POST['quest']); 
```

我只收到

```
Array ( [9] => Genuine ) 
```

回来所以“正版”是我回来的唯一项目。有没有办法解决这个问题？我做错了什么？

这是调查中的第 9 个问题，因此很遗憾无法更改名称。有没有办法将结果组合到用逗号分隔的单个数组中？我总是可以`explode`在 php 方面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T03:10:28.553

您所有的复选框都具有相同的名称，使它们独一无二

```
<input type="checkbox" value="Friendly" name="quest[3]"> Friendly<br>
<input type="checkbox" value="Attentive" name="quest[4]"> Attentive<br>
<input type="checkbox" value="Enthusiastic" name="quest[5]"> Enthusiastic<br>
<input type="checkbox" value="Understanding" name="quest[6]"> Understanding<br>
<input type="checkbox" value="Well Mannered" name="quest[7]"> Well Mannered<br>
<input type="checkbox" value="Efficient" name="quest[8]"> Efficient<br>
<input type="checkbox" value="Genuine" name="quest[9]"> Genuine<br> 
```

或使用空方括号，以便 php 将输入视为数组

```
<input type="checkbox" value="Friendly" name="quest[]"> Friendly<br>
<input type="checkbox" value="Attentive" name="quest[]"> Attentive<br>
<input type="checkbox" value="Enthusiastic" name="quest[]"> Enthusiastic<br>
<input type="checkbox" value="Understanding" name="quest[]"> Understanding<br>
<input type="checkbox" value="Well Mannered" name="quest[]"> Well Mannered<br>
<input type="checkbox" value="Efficient" name="quest[]"> Efficient<br>
<input type="checkbox" value="Genuine" name="quest[]"> Genuine<br> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-16T12:17:58.113

在名称中使用 quest[] 而不是 quest[9]。也在 php 部分使用它来添加多个选择。

```
<?php
$quest = implode(',',$_post['quest']);
print_r($quest);
?> 
```

编码快乐！！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T03:24:06.323

我正在发布一个关于您对上一个评论的新答案：

由于您必须将 quest[9] 作为复选框数组的组织..

您可能想尝试使它成为一个更复杂的数组，每个数组`<input>`都有 `name="quest[9][1]"`，`name="quest[9][2]"`依此类推。

并通过以下方式查找内容

```
print_r($_POST['quest']); 
```

再次

# mysql - 修改查询？

> ID：12031852
> 
> 赞同：-1
> 
> 时间：2012-08-20T03:05:02.087
> 
> 标签：mysql

我想向所有学生展示，即使他们没有注册课程。我将如何修改此查询以显示 null 呢？

```
SELECT a.lastname,
       Count(c.credits) TotalCredits
FROM   students a
       INNER JOIN registration b
               ON a.studentid = b.studentid
       INNER JOIN courses c
               ON b.courseid = c.coursenumber
GROUP  BY a.studentid 
```

查询由 John Woo 完成

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:09:48.963

使用`LEFT`代替`INNER`：

```
SELECT a.lastname,
       Count(c.credits) TotalCredits
FROM   students a
       LEFT JOIN registration b
              ON a.studentid = b.studentid
       LEFT JOIN courses c
              ON b.courseid = c.coursenumber
GROUP  BY a.studentid 
```

# c# - 我正在尝试向滚动条添加百分比，但为什么它在进度时闪烁？

> ID：12031853
> 
> 赞同：1
> 
> 时间：2012-08-20T03:05:05.967
> 
> 标签：c#

这是我正在使用的代码：

```
private void backgroundWorker1_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
            progressBar1.Value = e.ProgressPercentage;
            progressBar1.Refresh();
            int percent = (int)(((double)(progressBar1.Value - progressBar1.Minimum) /
(double)(progressBar1.Maximum - progressBar1.Minimum)) * 100);
            using (Graphics gr = progressBar1.CreateGraphics())
            {
                gr.DrawString(percent.ToString() + "%",
                    SystemFonts.DefaultFont,
                    Brushes.Black,
                    new PointF(progressBar1.Width / 2 - (gr.MeasureString(percent.ToString() + "%",
                        SystemFonts.DefaultFont).Width / 2.0F),
                    progressBar1.Height / 2 - (gr.MeasureString(percent.ToString() + "%",
                        SystemFonts.DefaultFont).Height / 2.0F)));
            }

            listBox1.Items.Add( "Converting File: " + e.UserState.ToString());
            textBox1.Text = e.ProgressPercentage.ToString();
} 
```

虽然它正在处理并向右移动，但百分比是一些闪烁，它不够平滑。

而且当它最终完成这个过程时，百分比消失了，只剩下绿色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T04:12:35.843

我刚刚尝试了您的代码，我看到了您的问题，这是一个好问题。我研究了一下，发现你需要处理进度条的 Paint 事件并在 e.Graphics 上绘图。否则，下次控件绘制自身时，您的绘图将被覆盖。

一般来说，你永远不应该在 CreateGraphics() 上绘图。最好的方法是对进度条进行子类化。

您首先需要做的是创建一个像这样的新类

```
class MyProgressBar : ProgressBar
{
    public MyProgressBar()
    {
        this.SetStyle(ControlStyles.UserPaint | ControlStyles.AllPaintingInWmPaint, true);
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        Rectangle rect = this.ClientRectangle;
        Graphics g = e.Graphics;

        ProgressBarRenderer.DrawHorizontalBar( g, rect );
        rect.Inflate(-3, -3);
        if ( this.Value > 0 )
        {
            Rectangle clip = new Rectangle( rect.X, rect.Y, ( int )Math.Round( ( ( float )this.Value / this.Maximum ) * rect.Width ), rect.Height );
            ProgressBarRenderer.DrawHorizontalChunks(g, clip);
        }

        // assumes this.Maximum == 100
        string text = this.Value.ToString( ) + '%';

        using ( Font f = new Font( FontFamily.GenericMonospace, 10 ) )
        {
            SizeF strLen = g.MeasureString( text, f );
            Point location = new Point( ( int )( ( rect.Width / 2 ) - ( strLen.Width / 2 ) ), ( int )( ( rect.Height / 2 ) - ( strLen.Height / 2 ) ) );
            g.DrawString( text, f, Brushes.Black, location ); 
        }
    }
} 
```

然后转到下面的 InitializeComponent 方法并更新`this.progressBar1 = System.Windows.Forms.ProgressBar();` 为`this.progressBar1 = new MyProgressBar();`

```
#region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.textBox1 = new System.Windows.Forms.TextBox();
            this.listBox1 = new System.Windows.Forms.ListBox();
            this.progressBar1 = new MyProgressBar(); 
```

现在应该可以按您的意愿工作了。然后您的代码将简化为此

```
private void backgroundWorker1_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
            progressBar1.Value = e.ProgressPercentage;

            listBox1.Items.Add( "Converting File: " + e.UserState.ToString());
            textBox1.Text = e.ProgressPercentage.ToString();
} 
```

# python - SQLAlchemy：如何通过对象的 PK 从关系中获取对象？

> ID：12031861
> 
> 赞同：2
> 
> 时间：2012-08-20T03:06:19.330
> 
> 标签：python, sqlalchemy

假设我有这样的一对多关系：

```
class Book(Base):
    __tablename__ = "books"
    id = Column(Integer)
    ...
    library_id = Column(Integer, ForeignKey("libraries.id"))

class Library(Base):
    __tablename__ = "books"
    id = Column(Integer)
    ...
    books = relationship(Book, backref="library") 
```

现在，如果我有一本书的 ID，有没有办法从`Library.books`关系中检索它，“在这个特定的图书馆给我一本 id=10 的书”？就像是：

```
try:
    the_book = some_library.books.by_primary_key(10) 
except SomeException:
    print "The book with id 10 is not found in this particular library" 
```

**我能想到的解决方法（但我宁愿避免使用）：**

```
book = session.query(Book).get(10)
if book and book.library_id != library_id:
    raise SomeException("The book with id 10 is not found in this particular library") 
```

或者

```
book = session.query(Book).filter(Book.id==10).filter(Book.library_id=library.id).one() 
```

原因：想象有几种不同的关系（`scifi_books`等`books_on_loan`）指定不同的主要连接条件——手动查询需要为所有这些条件编写单独的查询，而 SQLAlchemy*已经知道*如何检索该关系的项目。此外，我更愿意一次加载所有书籍（通过访问 library.books）而不是发出单独的查询。

另一种可行但效率低下且不优雅的选择是：

```
for b in library.books:
    if b.id == book_id:
        return b 
```

我目前使用的是：

```
library_books = {b.id:b for b in library.books}
for data in list_of_dicts_containing_book_id:
    if data['id'] in library_books:
        library_books[data['id']].do_something(data)
    else:
        print "Book %s is not in the library" % data['id'] 
```

我只是希望有一种更好的内置方法可以通过他们的 id 从关系中快速检索项目

**UPD：**我在[sqlalchemy 邮件列表](https://groups.google.com/forum/?fromgroups=#!topic/sqlalchemy/mwrXAvfRzxg)中提出了这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T02:33:29.683

SQLAlchemy 的查询对象的`with_parent`方法正是这样做的：

> **with_parent（实例，属性=无）**
> 
> 添加过滤条件，将给定实例与子对象或集合相关联，使用其属性状态以及已建立的 relationship() 配置。

所以在我的例子中，代码看起来像

```
q = session.query(Book)
q = q.with_parent(my_library, "scifi_books")
q = q.filter(Book.id==10).one() 
```

即使`my_library.scifi_books`关系已经加载，这也会发出单独的查询。似乎没有“内置”方法可以通过其 PK 从已加载的关系中检索项目，因此最简单的方法是将关系转换为 dict 并使用它来查找项目：

```
book_lookup = {b.id: b for b in my_library.scifi_books}
book = books_lookup[10] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T04:49:00.687

[请参阅有关使用连接查询的](http://docs.sqlalchemy.org/en/rel_0_7/orm/tutorial.html#querying-with-joins)SQLAlchemy 文档。所以你想要这样的东西（注意这是未经测试的）：

```
query(Book, Library). \
    filter(Book.id==10). \
    filter(Book.library.id==needed_library_id).all() 
```

如果`Book -> Library`引用是标量，您可以使用`has()`：

```
query.filter(Library.books.has(id=10)) 
```

要一次对多本书进行批量查询，您可以使用`in_()`运算符：

```
query(Library).join('books', Book).filter(Book.id.in_([1, 2, 10])).all() 
```

# java - OpenGL ES 球体问题

> ID：12031865
> 
> 赞同：1
> 
> 时间：2012-08-20T03:07:10.383
> 
> 标签：java, android, opengl-es

我一直在关注教程[http://www.learnopengles.com](http://www.learnopengles.com)并学习更多如何使用 OpenGL ES，但我很难让球体出现。

我已经在 Blender 中制作了一个测地线球体，并导入了顶点和绘制顺序，但每当我调用球体时，应用程序就会崩溃。

我将包含一个指向我的完整渲染文件的链接，但我也会指出我认为可能存在问题的一些关键问题：

这里是创建缓冲区的地方。我不确定应用程序是否存在我缓冲球体的方式或球体的绘制顺序点的问题。

```
// Initialize the buffers.
    mCubePositions = ByteBuffer.allocateDirect(cubePositionData.length * mBytesPerFloat)
    .order(ByteOrder.nativeOrder()).asFloatBuffer();                            
    mCubePositions.put(cubePositionData).position(0);

    mSpherePositions = ByteBuffer.allocateDirect(spherePositionData.length * 4).order(ByteOrder.nativeOrder()).asFloatBuffer();
    mSpherePositions.put(spherePositionData).position(0);

    ByteBuffer dlb = ByteBuffer.allocateDirect(sphereDrawOrder.length * 2).order(ByteOrder.nativeOrder());
    drawListBuffer = dlb.asShortBuffer();
    drawListBuffer.put(sphereDrawOrder);
    drawListBuffer.position(0);

    mCubeColors = ByteBuffer.allocateDirect(cubeColorData.length * mBytesPerFloat)
    .order(ByteOrder.nativeOrder()).asFloatBuffer();                            
    mCubeColors.put(cubeColorData).position(0);

    mCubeNormals = ByteBuffer.allocateDirect(cubeNormalData.length * mBytesPerFloat)
    .order(ByteOrder.nativeOrder()).asFloatBuffer();                            
    mCubeNormals.put(cubeNormalData).position(0); 
```

这是绘制球体的类。我没有球体的颜色或法线，所以我只是删除了这些部分。是不是因为这个原因才发飙？

```
private void drawSphere()
{       
    // Pass in the position information
    mSpherePositions.position(0);       
    GLES20.glVertexAttribPointer(mPositionHandle, mPositionDataSize, GLES20.GL_FLOAT, false,
            0, mSpherePositions);        

    GLES20.glEnableVertexAttribArray(mPositionHandle);        

    // Pass in the color information

    // Pass in the normal information

    // This multiplies the view matrix by the model matrix, and stores the result in the MVP matrix
    // (which currently contains model * view).
    Matrix.multiplyMM(mMVPMatrix, 0, mViewMatrix, 0, mModelMatrix, 0);   

    // Pass in the modelview matrix.
    GLES20.glUniformMatrix4fv(mMVMatrixHandle, 1, false, mMVPMatrix, 0);                

    // This multiplies the modelview matrix by the projection matrix, and stores the result in the MVP matrix
    // (which now contains model * view * projection).
    Matrix.multiplyMM(mMVPMatrix, 0, mProjectionMatrix, 0, mMVPMatrix, 0);

    // Pass in the combined matrix.
    GLES20.glUniformMatrix4fv(mMVPMatrixHandle, 1, false, mMVPMatrix, 0);

    // Pass in the light position in eye space.        
    GLES20.glUniform3f(mLightPosHandle, mLightPosInEyeSpace[0], mLightPosInEyeSpace[1], mLightPosInEyeSpace[2]);

    // Draw the sphere.
    GLES20.glDrawElements(GLES20.GL_TRIANGLES, sphereDrawOrder.length,
            GLES20.GL_UNSIGNED_SHORT, drawListBuffer);                              
} 
```

每当它崩溃时，它都会告诉我 //Draw the sphere 之后的代码有问题。由于某种原因，它不喜欢 glDrawElements。

这是完整的渲染脚本供参考： http: [//pastebin.com/Y1WU27hz](http://pastebin.com/Y1WU27hz)

如果您对此有任何见解，我感谢您。

# c - TextMate 2：尝试编译和运行简单的 C 程序时出错

> ID：12031867
> 
> 赞同：3
> 
> 时间：2012-08-20T03:07:17.223
> 
> 标签：c, xcode, gcc, textmate

### 设置

OS X 10.8
Xcode 4.4.1 安装
TextMate 2 -r9283

* * *

### 概括

在安装了 Xcode 4.4 的 10.8 上的 TextMate2 中编译和运行一个简单的 C 程序会给我一个路径错误，然后是编译器错误，然后是链接器错误。

* * *

### 复制步骤

1.  创建一个名为`test.c`TextMate2 的文件并保存到桌面
2.  将此程序粘贴到`test.c`文件中：

    ```
    #include <stdio.h>

    int main(int argc, char const *argv[]) {
        printf("Hello World\n");
        return 0;
    } 
    ```

3.  **运行**类型`command-R`_

 *** * *

### 预期结果

`stdout`运行程序的输出

* * *

### 实际结果

TextMate 输出面板显示了这个 PATH 错误：

```
Can't find “gcc” on PATH.

The current PATH is:

    /usr/bin
    /bin
    /usr/sbin
    /sbin
    /Users/itod/Library/Application Support/TextMate/Managed/Bundles/Bundle Support.tmbundle/Support/shared/bin
Please add the directory containing “gcc” to PATH in TextMate's Shell Variables preferences. 
```

那么这个编译器错误：

```
cc1: error: stdio.h: No such file or directory 
```

那么这个链接器错误：

```
ld: library not found for -lcrt1.10.6.o
collect2: ld returned 1 exit status 
```

* * *

如何修复这些错误并在 OS X 10.8 的 TextMate 2 中成功编译和运行 C 程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T03:08:12.060

要让 TextMate 2 在 OS X 10.8 上构建和运行 C 程序，您必须更新 TextMate 中的几个环境变量。

* * *

### 脚步

1.  启动 TextMate2
2.  转到首选项 ( `⌘,`) > 变量
3.  在下表中输入以下名称/值对，并确保所有三对均已“选中”

* * *

**`PATH`**–`$PATH:/Applications/Xcode.app/Contents/Developer/usr/bin/`

**`C_INCLUDE_PATH`**–`/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.8.sdk/usr/include/`

**`LIBRARY_PATH`**–`/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.8.sdk/usr/lib/`

![在此处输入图像描述](../Images/ba67ca26896f99c61a20affebf8f4ac3.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T05:00:29.413

如果您想正确安装等，请从苹果开发者网站[http://developer.apple.com/downloads](http://developer.apple.com/downloads)`/usr/bin/gcc`获取“Xcode 命令行工具” （使用免费 ADC 帐户免费下载）。它将为所有命令行工具（gcc、ld 等）安装 /usr/bin 二进制文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T05:09:07.810

正如[上面](https://stackoverflow.com/a/12032471/34934)提到的[dajobe](https://stackoverflow.com/users/11177/dajobe)：

> 如果您想正确安装 /usr/bin/gcc 等，请获取“Xcode 命令行工具”

这些也可以通过 Xcode GUI 安装：

**首选项 > 下载 > 组件 > 命令行工具 > 安装**

![在此处输入图像描述](../Images/e90fc52d5d48c542b82b3143ac4c005b.png)**

# solr - 通过查询和许多值排除 Solr

> ID：12031868
> 
> 赞同：1
> 
> 时间：2012-08-20T03:07:25.090
> 
> 标签：solr

我们有制造商零件的 Solr 文档，其中每个零件都可从 100 家供应商处获得。这些供应商存储在每个 Mfg 零件文档中的多字段中。

客户根据零件标题和描述通过关键字搜索我们的零件，其中每个客户都有一个他们不允许查看的供应商的唯一列表。例如：

```
solr docs:
doc_id = 1, mfg_part = abc, suppliers = s1, s2, s3, s4, s5, s6, s7
doc_id = 2, mfg_part = def, suppliers = s4, s5, s6, s7
doc_id = 3, mfg_part = ghi, suppliers = s4
doc_id = 4, mfg_part = jkl, suppliers = s1, s2, s3, s4
doc_id = 5, mfg_part = mno, suppliers = s1, s2, s3, s5

customer A: exclude suppliers: s4, s5, s6, s7
customer B: exclude suppliers: s1, s2, s3, s4

when customer A searches, documents 2 & 3 should not be returned in any
result set
when customer B searches, documents 3 & 4 should not be returned in any
result set 
```

我们的一个想法是重组我们的文档，以便每个供应商制造零件有一个文档，而不是每个制造零件，但结果将是一个 3000 倍大小的索引！！！我们的许多制造零件有 1000 家或更多供应商。目前我们将排除列表推入过滤器查询，但它变得相当

我们已经在 Solr 4 中看到了 Solr“加入”，但由于这是一个每周产生数百万美元的生产站点，我们无法使用 alpha 或 beta 版本的软件。

最后，我们目前在过滤器查询中使用供应商的包含列表，这很有效，但由于包含列表在 1000 中，因此速度非常慢。我们宁愿使用排除列表，但无法确定要使用的查询或模式。

任何想法，任何人？

提前谢谢克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T07:37:59.893

对于 Solr 授权，人们通常使用[ManifoldCF](http://manifoldcf.apache.org/en_US/index.html)。

看看[这里](http://www.slideshare.net/lucenerevolution/wright-nokia-manifoldcfeurocon-2011)。

# haskell - Rank2Types 的目的是什么？

> ID：12031878
> 
> 赞同：119
> 
> 时间：2012-08-20T03:08:15.463
> 
> 标签：haskell, types, polymorphism, higher-rank-types

我不是很精通 Haskell，所以这可能是一个非常简单的问题。

[Rank2Types](https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#ghc-flag--XRank2Types)解决了哪些语言限制？Haskell 中的函数不是已经支持多态参数了吗？

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2012-08-20T07:11:44.567

[除非您直接研究System F](http://en.wikipedia.org/wiki/System_F) ，否则很难理解高级多态性，因为为了简单起见，Haskell 旨在向您隐藏其中的细节。

但基本上，粗略的想法是多态类型并不真正具有`a -> b`它们在 Haskell 中的形式。实际上，它们看起来像这样，总是带有明确的量词：

```
id :: ∀a.a → a
id = Λt.λx:t.x 
```

如果你不知道“∀”符号，读作“for all”；`∀x.dog(x)`意思是“对于所有 x，x 是一条狗。” “Λ”是大写的 lambda，用于抽象类型参数；第二行说的是 id 是一个接受 type`t`的函数，然后返回一个由该类型参数化的函数。

你看，在 System F 中，你不能立即将这样的函数应用于`id`一个值；首先，您需要将 Λ 函数应用于类型，以便获得应用于值的 λ 函数。例如：

```
(Λt.λx:t.x) Int 5 = (λx:Int.x) 5
                  = 5 
```

标准 Haskell（即 Haskell 98 和 2010）通过没有任何这些类型量词、大写 lambda 和类型应用程序为您简化了这一点，但 GHC 在分析程序以进行编译时将它们放在幕后。（我相信这都是编译时的东西，没有运行时开销。）

但是 Haskell 对此的自动处理意味着它假定“∀”永远不会出现在函数（“→”）类型的左侧分支上。 `Rank2Types`并`RankNTypes`关闭这些限制并允许您覆盖 Haskell 关于 where to insert 的默认规则`forall`。

你为什么想做这个？因为完整的、不受限制的 System F 非常强大，它可以做很多很酷的事情。例如，类型隐藏和模块化可以使用更高级别的类型来实现。以以下 rank-1 类型的普通旧函数为例（设置场景）：

```
f :: ∀r.∀a.((a → r) → a → r) → r 
```

要使用`f`，调用者首先必须选择用于`r`and的类型`a`，然后提供结果类型的参数。所以你可以选择`r = Int`和`a = String`：

```
f Int String :: ((String → Int) → String → Int) → Int 
```

但现在将其与以下更高级别的类型进行比较：

```
f' :: ∀r.(∀a.(a → r) → a → r) → r 
```

这种类型的功能如何工作？好吧，要使用它，首先您指定要使用的类型`r`。假设我们选择`Int`：

```
f' Int :: (∀a.(a → Int) → a → Int) → Int 
```

但是现在在`∀a`函数箭头*里面*，所以你不能选择使用什么类型`a`；您必须应用`f' Int`适当类型的 Λ 函数。这意味着gets**的实现`f'`选择使用什么类型`a`，而不是`f'`**. 相反，如果没有更高级别的类型，调用者总是选择类型。

这有什么用？好吧，实际上对于很多事情，但一个想法是，您可以使用它来建模诸如面向对象编程之类的事情，其中​​“对象”将一些隐藏数据与一些处理隐藏数据的方法捆绑在一起。例如，一个具有两种方法的对象——一个返回一个`Int`，另一个返回一个`String`，可以用这种类型实现：

```
myObject :: ∀r.(∀a.(a → Int, a -> String) → a → r) → r 
```

这是如何运作的？该对象被实现为具有一些隐藏类型的内部数据的函数`a`。要实际使用该对象，它的客户端会传入一个“回调”函数，该对象将使用这两种方法调用该函数。例如：

```
myObject String (Λa. λ(length, name):(a → Int, a → String). λobjData:a. name objData) 
```

基本上，我们在这里调用对象的第二种方法，即类型`a → String`为 unknown的方法`a`。好吧，`myObject`客户不知道；但是这些客户端确实从签名中知道，他们将能够对其应用这两个函数中的任何一个，并获得 an`Int`或 a `String`。

对于一个实际的 Haskell 示例，下面是我自学时编写的代码`RankNTypes`。这实现了一个名为的类型，它将某个隐藏类型的值与其类实例`ShowBox`捆绑在一起。`Show`请注意，在底部的示例中，我创建了一个列表，`ShowBox`其中第一个元素由数字组成，第二个元素由字符串组成。由于这些类型是通过使用更高级别的类型来隐藏的，因此这不会违反类型检查。

```
{-# LANGUAGE RankNTypes #-}
{-# LANGUAGE ImpredicativeTypes #-}

type ShowBox = forall b. (forall a. Show a => a -> b) -> b

mkShowBox :: Show a => a -> ShowBox
mkShowBox x = \k -> k x

-- | This is the key function for using a 'ShowBox'.  You pass in
-- a function @k@ that will be applied to the contents of the 
-- ShowBox.  But you don't pick the type of @k@'s argument--the 
-- ShowBox does.  However, it's restricted to picking a type that
-- implements @Show@, so you know that whatever type it picks, you
-- can use the 'show' function.
runShowBox :: forall b. (forall a. Show a => a -> b) -> ShowBox -> b
-- Expanded type:
--
--     runShowBox 
--         :: forall b. (forall a. Show a => a -> b) 
--                   -> (forall b. (forall a. Show a => a -> b) -> b)
--                   -> b
--
runShowBox k box = box k

example :: [ShowBox] 
-- example :: [ShowBox] expands to this:
--
--     example :: [forall b. (forall a. Show a => a -> b) -> b]
--
-- Without the annotation the compiler infers the following, which
-- breaks in the definition of 'result' below:
--
--     example :: forall b. [(forall a. Show a => a -> b) -> b]
--
example = [mkShowBox 5, mkShowBox "foo"]

result :: [String]
result = map (runShowBox show) example 
```

PS：对于阅读本文的任何人，如果想知道`ExistentialTypes`GHC 是如何使用`forall`的，我相信原因是因为它在幕后使用了这种技术。

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2012-08-20T03:14:32.387

> Haskell 中的函数不是已经支持多态参数了吗？

他们这样做了，但只有等级 1。这意味着虽然您可以编写一个在没有此扩展的情况下采用不同类型参数的函数，但您不能编写一个在同一调用中使用其参数作为不同类型的函数。

例如，如果没有此扩展名，则无法键入以下函数，因为`g`在 的定义中与不同的参数类型一起使用`f`：

```
f g = g 1 + g "lala" 
```

请注意，完全可以将多态函数作为参数传递给另一个函数。所以类似的东西`map id ["a","b","c"]`是完全合法的。但是该函数只能将其用作单态。在示例中`map`使用`id`好像它有 type `String -> String`。当然，您也可以传递给定类型的简单单态函数，而不是`id`. 如果没有 rank2types，函数就无法要求其参数必须是多态函数，因此也无法将其用作多态函数。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2014-07-12T21:57:10.160

[Luis Casillas 的回答](https://stackoverflow.com/questions/12031878/what-is-the-purpose-of-rank2types/12033549#12033549)提供了很多关于 2 级类型意味着什么的重要信息，但我将仅扩展他未涵盖的一点。要求参数是多态的不仅允许它与多种类型一起使用；它还限制了该函数可以使用其参数做什么以及它如何产生结果。也就是说，它给调用者*较少*的灵活性。你为什么想这么做？我将从一个简单的例子开始：

假设我们有一个数据类型

```
data Country = BigEnemy | MediumEnemy | PunyEnemy | TradePartner | Ally | BestAlly 
```

我们想写一个函数

```
f g = launchMissilesAt $ g [BigEnemy, MediumEnemy, PunyEnemy] 
```

它采用一个函数，该函数应该选择它给出的列表中的一个元素，并返回一个`IO`向该目标发射导弹的动作。我们可以给出`f`一个简单的类型：

```
f :: ([Country] -> Country) -> IO () 
```

问题是我们可能会意外运行

```
f (\_ -> BestAlly) 
```

然后我们就有大麻烦了！给出`f`等级 1 的多态类型

```
f :: ([a] -> a) -> IO () 
```

根本没有帮助，因为我们`a`在调用时选择了类型`f`，我们只是将其专门用于`Country`并再次使用我们的恶意软件`\_ -> BestAlly`。解决方案是使用等级 2 类型：

```
f :: (forall a . [a] -> a) -> IO () 
```

现在我们传入的函数需要是多态的，所以`\_ -> BestAlly`不会进行类型检查！事实上，返回不在给定列表中的元素的*任何函数*都不会进行类型检查（尽管某些进入无限循环或产生错误并因此永远不会返回的函数会这样做）。

当然，以上是人为设计的，但是这种技术的变体是使`ST`monad 安全的关键。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2016-01-06T00:45:47.627

更高级别的类型并不像其他答案所表明的那样奇特。信不信由你，许多面向对象的语言（包括 Java 和 C#！）都具有它们。（当然，那些社区中没有人以“高级类型”这个听起来很吓人的名字认识他们。）

我要给出的示例是访问者模式的教科书实现，我在日常工作中*一直使用它。*此答案并非旨在介绍访问者模式；这些知识在[其他地方](http://butunclebob.com/ArticleS.UncleBob.IuseVisitor)[很容易](https://stackoverflow.com/questions/255214/when-should-i-use-the-visitor-design-pattern) [获得](https://stackoverflow.com/questions/2604169/could-someone-in-simple-terms-explain-to-me-the-visitor-patterns-purpose-with-e) 。

在这个愚蠢的虚构 HR 应用程序中，我们希望对可能是全职长期员工或临时承包商的员工进行操作。我首选的访问者模式变体（实际上是与 相关的变体`RankNTypes`）参数化了访问者的返回类型。

```
interface IEmployeeVisitor<T>
{
    T Visit(PermanentEmployee e);
    T Visit(Contractor c);
}

class XmlVisitor : IEmployeeVisitor<string> { /* ... */ }
class PaymentCalculator : IEmployeeVisitor<int> { /* ... */ } 
```

关键是许多具有不同返回类型的访问者都可以对相同的数据进行操作。这意味着不能对应该是`IEmployee`什么发表意见。`T`

```
interface IEmployee
{
    T Accept<T>(IEmployeeVisitor<T> v);
}
class PermanentEmployee : IEmployee
{
    // ...
    public T Accept<T>(IEmployeeVisitor<T> v)
    {
        return v.Visit(this);
    }
}
class Contractor : IEmployee
{
    // ...
    public T Accept<T>(IEmployeeVisitor<T> v)
    {
        return v.Visit(this);
    }
} 
```

我想提请您注意这些类型。请注意，它`IEmployeeVisitor`普遍量化了它的返回类型，而在它的方法`IEmployee`内部量化它`Accept`- 也就是说，在更高的等级。从 C# 到 Haskell 的翻译很笨拙：

```
data IEmployeeVisitor r = IEmployeeVisitor {
    visitPermanent :: PermanentEmployee -> r,
    visitContractor :: Contractor -> r
}

newtype IEmployee = IEmployee {
    accept :: forall r. IEmployeeVisitor r -> r
} 
```

所以你有它。当您编写包含泛型方法的类型时，更高级别的类型会出现在 C# 中。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2017-07-27T16:31:31.560

For those familiar with object oriented languages, a higher-rank function is simply a generic function that expects as its argument another generic function.

E.g. in TypeScript you could write:

```
type WithId<T> = T & { id: number }
type Identifier = <T>(obj: T) => WithId<T>
type Identify = <TObj>(obj: TObj, f: Identifier) => WithId<TObj> 
```

See how the generic function type `Identify` demands a generic function of the type `Identifier`? This makes `Identify` a higher-rank function.

# objective-c - 需要一点帮助来理解 Apple 关于 Core Data 的文档

> ID：12031883
> 
> 赞同：1
> 
> 时间：2012-08-20T03:09:41.253
> 
> 标签：objective-c, cocoa-touch, cocoa, core-data

我正在阅读 Apple 的“核心数据片段”文档（https://developer.apple.com/library/mac/#documentation/DataManagement/Conceptual/CoreDataSnippets/Articles/stack.html#//apple_ref/doc/uid/TP40008283 -SW1），我在这部分有点困惑。

```
To create a new managed object context, you need a persistent store coordinator.

NSPersistentStoreCoordinator *psc = <#Get the coordinator#>;
NSManagedObjectContext *newContext = [[NSManagedObjectContext alloc] init];
[newContext setPersistentStoreCoordinator:psc];

If you already have a reference to an existing context, you can ask it for its persistent 
store coordinator. This way you can be sure that the new context is using the same 
coordinator as the existing one (assuming this is your intent):

NSManagedObjectContext *context = <#Get the context#>;
NSPersistentStoreCoordinator *psc = [context persistentStoreCoordinator];
NSManagedObjectContext *newContext = [[NSManagedObjectContext alloc] init];
[newContext setPersistentStoreCoordinator:psc]; 
```

最特别的是 <#Get the coordinator#> 和 <#Get the context#> 部分。这到底是什么意思，在实际应用程序中应该去那里？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:15:52.597

据我了解，托管对象上下文几乎就像一个暂存器，您可以在其中进行更改，然后将该暂存器保存到存储中。几乎每次您想将托管对象放入存储中时，您都需要一个上下文，因此当您要这样做时，请务必创建一个。我对 PSC 不是很熟悉，但从外观上看，您只需要一个，并且可以在多个上下文中使用它。如果您希望在整个应用程序中使用相同的 PSC，那么我想您可以将它放在一个单例中或以某种方式传递它，这样您就不必每次都创建一个新的。

# sql - 按时间间隔访问特定组

> ID：12031885
> 
> 赞同：0
> 
> 时间：2012-08-20T03:09:53.933
> 
> 标签：sql, ms-access

我一直在尝试使查询工作以 15 分钟为单位分组时间间隔。

但是，即使基于此处或其他地方的帖子，我的查询仍会按分钟而不是 15 分钟的间隔返回数据。我正在使用 Access 并想知道这是否是对 Access 的限制，或者我只是错过了一些明显的东西。

任何帮助，将不胜感激！谢谢

```
SELECT DATEADD("n", DATEDIFF("n", 0, [Trade.Date] ) / 15 * 15, 0), [Trade.Value]
FROM Trade 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T05:35:35.607

Grouping requires a `group by` clause. For example:

```
SELECT  DATEADD("n", DATEDIFF("n", 0, [Trade.Date] ) / 15 * 15, 0)
,       avg([Trade.Value])
FROM    Trade
GROUP BY
        DATEADD("n", DATEDIFF("n", 0, [Trade.Date] ) / 15 * 15, 0) 
```

# nopcommerce - 如何在客户设置中添加新设置值

> ID：12031896
> 
> 赞同：0
> 
> 时间：2012-08-20T03:13:21.180
> 
> 标签：nopcommerce

我想在安装 nopcommerce 2.5 后在客户设置页面（/Admin/Setting/CustomerUser）中添加新的设置值。我该怎么办？我得到了 nopcommerce 2.5 源代码。我正在寻找自定义客户设置页面以添加新的方法见价值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T05:29:02.767

您可以将其添加到配置下的 AllSetting 部分（配置->设置->所有设置）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T09:36:11.093

您需要在 CustomerSettingsModel 中添加新属性，例如

```
//Nop.Admin/Models/Setting/

public bool ZipCodeEnbale{get;set} 
```

然后在 CustomerUser.cshtml 中为其添加控件

```
//Nop.Admin/Views/Setting/

<tr>
            <td class="adminTitle">
                @Html.NopLabelFor(model => model.CustomerSettings.ZipCodeEnbale):
            </td>
            <td class="adminData">
                @Html.EditorFor(model => model.CustomerSettings.ZipCodeEnbale)
                @Html.ValidationMessageFor(model => model.CustomerSettings.ZipCodeEnbale)
            </td>
        </tr> 
```

运行应用程序后，您将看到新属性将添加到**CustomerSeeting**选项卡的管理员/客户设置页面下。

注意：如果您在安装 nopcommerec 时将默认值设置为属性，那么您需要在 InstallationService.cs 中的（Nop.Service）中进行一些额外的更改，在 InstallSettings 方法下的 CustomerSettings 中添加新的属性值。例如

```
EngineContext.Current.Resolve<IConfigurationProvider<CustomerSettings>>()
                .SaveSettings(new CustomerSettings()
                {
                    ZipCodeEnbale= true,
                } 
```

# sql-server - freetds-dev 中缺少 libtdsodbc.so - Ubuntu 上的 MSSQL

> ID：12031897
> 
> 赞同：13
> 
> 时间：2012-08-20T03:13:33.433
> 
> 标签：sql-server, tsql, ubuntu, odbc, freetds

我正在尝试通过 ODBC 让 MSSQL 在 Ubuntu 12.04 上运行，并且我已经按照以下步骤操作：

[http://jamesrossiter.wordpress.com/2011/03/08/connecting-to-microsoft-sql-server-using-odbc-from-ubuntu-server/](http://jamesrossiter.wordpress.com/2011/03/08/connecting-to-microsoft-sql-server-using-odbc-from-ubuntu-server/)

但是，这忽略了 odbcinst.ini 中指向的这两个文件：

```
Driver = /usr/lib/odbc/libtdsodbc.so
Setup = /usr/lib/odbc/libtdsS.so 
```

所以，我用谷歌搜索了一下，发现了这个：

[http://ubuntuforums.org/showthread.php?t=433435&page=2](http://ubuntuforums.org/showthread.php?t=433435&page=2)

所以我按照这些说明将 libtdsodbc.so 放在 /usr/lib/odbc/ 中，但我仍然收到此错误：

```
Can't open lib '/usr/lib/odbc/libtdsodbc.so' : file not found, SQL state 01000 in SQLConnect 
```

但...

```
root@ubuntu:/usr/lib/odbc# ls -la
total 552
drwxr-xr-x  2 root root   4096 Aug 19 20:12 .
drwxr-xr-x 62 root root  12288 Aug 19 19:41 ..
-rwxrwxr-x  1 root root 270608 Aug 19 20:00 libtdsodbc.so 
```

我在该文件上尝试了 chmod 775，它解释了权限。仍然没有运气。

有任何想法吗？我难住了。真的很想在我的 Linux 机器上运行它。

编辑：我使用的是 Ubuntu 64 位。我打赌这是问题所在。希望有帮助...

EDIT2：我尝试从这里手动获取 64 位包：

[http://www.ubuntuupdates.org/package/core/precise/main/base/tdsodbc](http://www.ubuntuupdates.org/package/core/precise/main/base/tdsodbc)

然后我看到有一个文件叫这个：

```
/usr/lib/x86_64-linux-gnu/odbc/libtdsodbc.so 
```

哇，也许是 64 位版本，对吧？

所以我将 odbcinst.ini 指向它，但它没有用。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-12T13:11:57.560

```
sudo apt-get install freetds-dev 
```

或者

```
sudo apt-get install tdsodbc 
```

现在查看 32 位：

```
/usr/lib/i386-linux-gnu/odbc/libtdsodbc.so 
```

或 64 位：

```
/usr/lib/x86_64-linux-gnu/odbc/libtdsodbc.so 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T04:05:12.813

我最终在这个 listserv 帖子的帮助下解决了这个问题：

[http://mailman.unixodbc.org/pipermail/unixodbc-support/2008-November/001842.html](http://mailman.unixodbc.org/pipermail/unixodbc-support/2008-November/001842.html)

除了：

```
Driver = TDS 
```

应该：

```
Driver = FreeTDS 
```

我必须手动找到的那个奇怪的 64 位驱动程序也是相关的，忽略 freetds.conf 是要走的路。

好玩的东西。

# c++ - 如何将字符串类型路径传递给 boost::filesystem:path 的构造函数？

> ID：12031898
> 
> 赞同：0
> 
> 时间：2012-08-20T03:13:40.720
> 
> 标签：c++, boost, g++

我有以下使用boost文件系统的类，但在编译时遇到了问题。

```
/// tfs.h file:

#include <boost/filesystem.hpp>
#include <iostream>
#include <string>

using namespace boost;
using namespace std;

class OSxFS
{
  public:
    OSxFS(string _folderPath)
    {
      mFolderPath(_folderPath);
    }

    string ShowStatus()
    {
      try
      {
        filesystem::file_status folderStatus = filesystem::status(mFolderPath);
        cout<<"Folder status: "<<filesystem::is_directory(folderStatus)<<endl;
      }
      catch(filesystem::filesystem_error &e)
      {
        cerr<<"Error! Message: "<<e.what()<<endl;
      }
    }

  private:
    filesystem::path mFolderPath;
} 
```

在 m.cpp 文件中，我使用以下代码调用 OSxFS 类：

```
///m.cpp file 

#include "tfs.h"
#include <iostream>
#include <string>

using namespace std;
using namespace boost;

int main()
{  
  string p = "~/Desktop/";
  OSxFS folderX(p);
  folderX.ShowStatus();
  cout<<"Thank you!"<<endl;
  return 0;
} 
```

但是，当我在 xCode 中通过 g++ 编译它们时收到错误消息：

```
In file included from m.cpp:1:
tfs.h: In constructor ‘OSxFS::OSxFS(std::string)’:
tfs.h:13: error: no match for call to ‘(boost::filesystem::path) (std::string&)’
m.cpp: At global scope:
m.cpp:5: error: expected unqualified-id before ‘using’ 
```

如果我在单个 main.cpp 中实现类 OSxFS 的函数 ShowStatus()，它就可以工作。所以，我想问题是关于如何将字符串变量 _folderPath 传递给类的构造函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T03:16:24.910

您在 . 末尾缺少一个分号`class OSxFS`。此外，您使用不正确的语法来调用`path`. 尝试：

```
OSxFS(string _folderPath) :
    mFolderPath(_folderPath)
{ 
} 
```

`mFolderPath(_folderPath);`在`OSxFS`构造函数的主体中试图`mFolderPath`作为函数调用。

# sql - 从单行中的多列输出多行

> ID：12031908
> 
> 赞同：1
> 
> 时间：2012-08-20T03:15:30.237
> 
> 标签：sql, oracle

我有一个未标准化的表，我无法更改表的结构。该表包含 6 列来保存首选项，即preference_num1...preference_num6。我想从表中提取数据，以便看起来有 6 行，其中一种偏好在一行中。

为了清楚起见，输出应该是 Id,semester_start,year_start,email,preference_num。并且，每一行将分成 6 行。

```
Name                    Null     Type          
----------------------- -------- ------------- 
ID                               number (primary key)
YEAR_START                       NUMBER        
SEMESTER_START                   VARCHAR2(8)   
EMAIL                            VARCHAR2(100) 
PREFERENCE_NUM_1                 VARCHAR2(1)   
PREF_INSTITUTION_NAME_1          VARCHAR2(100) 
PREF_INSTITUTION_CODE_1          VARCHAR2(15)  
PREF_COURSE_TITLE_1              VARCHAR2(100) 
COURSE_CODE_1                    VARCHAR2(15)  
OFFERING_LABLE_1                 VARCHAR2(15)  
PREFERENCE_NUM_2                 VARCHAR2(1)   
PREF_INSTITUTION_NAME_2          VARCHAR2(100) 
PREF_INSTITUTION_CODE_2          VARCHAR2(15)  
PREF_COURSE_TITLE_2              VARCHAR2(100) 
COURSE_CODE_2                    VARCHAR2(15)  
OFFERING_LABLE_2                 VARCHAR2(15)  
PREFERENCE_NUM_3                 VARCHAR2(1)   
PREF_INSTITUTION_NAME_3          VARCHAR2(100) 
PREF_INSTITUTION_CODE_3          VARCHAR2(15)  
PREF_COURSE_TITLE_3              VARCHAR2(100) 
COURSE_CODE_3                    VARCHAR2(15)  
OFFERING_LABLE_3                 VARCHAR2(15)  
PREFERENCE_NUM_4                 VARCHAR2(1)   
PREF_INSTITUTION_NAME_4          VARCHAR2(100) 
PREF_INSTITUTION_CODE_4          VARCHAR2(15)  
PREF_COURSE_TITLE_4              VARCHAR2(100) 
COURSE_CODE_4                    VARCHAR2(15)  
OFFERING_LABLE_4                 VARCHAR2(15)  
PREFERENCE_NUM_5                 VARCHAR2(1)   
PREF_INSTITUTION_NAME_5          VARCHAR2(100) 
PREF_INSTITUTION_CODE_5          VARCHAR2(15)  
PREF_COURSE_TITLE_5              VARCHAR2(100) 
COURSE_CODE_5                    VARCHAR2(15)  
OFFERING_LABLE_5                 VARCHAR2(15)  
PREFERENCE_NUM_6                 VARCHAR2(1)   
PREF_INSTITUTION_NAME_6          VARCHAR2(100) 
PREF_INSTITUTION_CODE_6          VARCHAR2(15)  
PREF_COURSE_TITLE_6              VARCHAR2(100) 
COURSE_CODE_6                    VARCHAR2(15)  
OFFERING_LABLE_6                 VARCHAR2(15)  
DATA_EXTRACTION_DATE             DATE          
OFFER_DATE_1                     DATE          
OFFER_RESPONSE_1                 VARCHAR2(20)  
FINAL_OFFER_RESPONSE_1           VARCHAR2(20)  
OFFER_DATE_2                     DATE          
OFFER_RESPONSE_2                 VARCHAR2(20)  
FINAL_OFFER_RESPONSE_2           VARCHAR2(20)  
OFFER_DATE_3                     DATE          
OFFER_RESPONSE_3                 VARCHAR2(20)  
FINAL_OFFER_RESPONSE_3           VARCHAR2(20)  
OFFER_DATE_4                     DATE          
OFFER_RESPONSE_4                 VARCHAR2(20)  
FINAL_OFFER_RESPONSE_4           VARCHAR2(20)  
OFFER_DATE_5                     DATE          
OFFER_RESPONSE_5                 VARCHAR2(20)  
FINAL_OFFER_RESPONSE_5           VARCHAR2(20)  
OFFER_DATE_6                     DATE          
OFFER_RESPONSE_6                 VARCHAR2(20)  
FINAL_OFFER_RESPONSE_6           VARCHAR2(20) 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T03:36:03.227

如果您搜索 UNPIVOT 技术或“oracle columns to rows”，您可能会找到有关此的更多信息。

执行此操作的一种方法如下，如果您输入一个（索引）id，则效果很好。为了使示例简单，我只得到了 3 个偏好。

这是基本思想。

```
select id, sem_start, year_start, pref_num1 from table_1 where id = input_id
union all 
select id, sem_start, year_start, pref_num2 from table_1 where id = input_id
union all
select id, sem_start, year_start, pref_num3 from table_1 where id = input_id 
```

您应该改用这个查询，这样会更高效，因为我们只通过 id 查询一次。

```
with t1 as
(select * from table_1 where id = id1)
select id, sem_start, year_start, pref_num1 from t1
union all 
select id, sem_start, year_start, pref_num2 from t1
union all
select id, sem_start, year_start, pref_num3 from t1 
```

# linux - 如何签署 Linux/Android 共享库？

> ID：12031909
> 
> 赞同：1
> 
> 时间：2012-08-20T03:15:34.420
> 
> 标签：linux, android-ndk

在 android/Linux 中签署和验证共享库 (.so) 是否有任何现有的解决方案？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T22:42:33.317

假设您正在从已构建和签名的普通 Android 应用程序中验证库，您只需添加一个构建步骤（在 NDK 构建之后但在 Java 构建之前）以生成具有 SHA1 总和的 Java 类（或更强大的哈希函数，如果您愿意的话）项目中的 .so 文件。将生成的 Java 类构建到您的应用程序中，并在运行时进行验证。如果您的 APK 上的签名未被篡改，您可以假设生成的 Java 类中的值是正确的，因此它们必须与库的运行时计算的哈希值匹配。

请注意，如果您正在为多个平台（arm、armv7-a、x86 等）构建，您可能必须在存储的哈希值的几个副本之间进行选择。

# javascript - 使用 Backbone.js 获取和解析的问题

> ID：12031912
> 
> 赞同：0
> 
> 时间：2012-08-20T03:16:07.997
> 
> 标签：javascript, jquery, ajax, backbone.js, underscore.js

我尝试将此服务器：[http](http://cshosting.webfactional.com/api/v1/projects/?format=json) ://cshosting.webfactional.com/api/v1/projects/?format=json 获取 到一个主干.js 集合。然后我尝试 console.log 它，但它不起作用。这对我很重要，请帮助。

新闻：我发现它与 JSONP 有关。将很高兴听到有关此的更多信息。谢谢。

简而言之，这是我的代码的一部分：

```
window.ProjectList = Backbone.Collection.extend({

    model: Project,

    url:"http://cshosting.webfactional.com/api/v1/projects",

    parse: function(response) {
         return response.objects;
  }

}); 
```

另一部分：

```
window.HomeView = Backbone.View.extend({

    initialize:function () {
        this.projectList = new ProjectList();
        this.projectList.fetch({success : function() {console.log(this.projectList);    }});

        this.homeListView = new HomeListView({model: this.projectList});
    }

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:32:01.613

The `this` on the `fetch` callback is not going to refer to your `HomeView` instance. Try using another variable to ensure you are referencing the desired object.

```
initialize:function () {
    var self = this;
    this.projectList = new ProjectList();
    this.projectList.fetch({success : function() {console.log(self.projectList);    }});

    this.homeListView = new HomeListView({model: this.projectList});
} 
```

If that doesn't solve the problem, please describe what happens. Use the webkit inspector's network tab to make sure the correct GET request and response are being called. Make sure your `parse` function is being called and the `response` object is what you expect.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T04:56:08.423

看起来你想要做更多这样的事情：

```
window.Project = Backbone.Model.extend({
url:"http://cshosting.webfactional.com/api/v1/projects/?format=json" 

}); 

window.ProjectList = Backbone.Collection.extend({

model: Project,
url:"http://cshosting.webfactional.com/api/v1/projects/?format=json"

});

window.HomeView = Backbone.View.extend({

initialize:function () {
    _.bindAll(this, 'render');
},

render: function(){
    var self = this;
    console.log(self.collection);
    return this; 
}

});

var project = new Project();
var collection = new ProjectList();
collection.fetch({
        success: function(result_collection, resp) {
            var view = new HomeView ({  collection: result_collection });
            view.render();
        }
 }); 
```

# jquery - 检测用户何时点击文本区域之外但不在元素之外

> ID：12031913
> 
> 赞同：0
> 
> 时间：2012-08-20T03:16:21.803
> 
> 标签：jquery, click

我有一个文本区域和一个提交按钮。当用户在 textarea 之外单击时，将运行一个脚本，如果 textarea 中没有任何内容，它会隐藏提交按钮。但是，如果您在文本区域之外单击，我不希望这样，因为当您单击提交按钮时，它会运行该操作并隐藏该按钮。它不应该。所以我需要检测用户何时在 textarea 的包装 div 之外单击并提交按钮并运行脚本。

```
 <div class="wrapper">
     <textarea class="textarea"></textarea>
     <input type="submit" class="submit" value="submit"/>
 </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:24:06.157

检查事件的“目标”属性，它将告诉您实际单击了哪个元素。然后，您可以执行条件语句以确保提交按钮没有调度事件。

jQuery 文档：[http ://api.jquery.com/event.target/](http://api.jquery.com/event.target/)

Mozilla 文档：[https ://developer.mozilla.org/en-US/docs/DOM/event.target](https://developer.mozilla.org/en-US/docs/DOM/event.target)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T03:30:09.440

Something like this:

```
$(document).ready(function() {
    var $text = $("textarea.textarea"),
        $btn = $("input.submit");
    $(document).click(function(e) {
        if (!$text.is(e.target) && !$btn.is(e.target) && $text.val() == "")
            $btn.hide();
        else
            $btn.show();
    });
}); 
```

That is, bearing in mind that click events bubble up to the document but you can still determine the originally clicked element with `event.target`, on any click event that the document receives test whether the click was somewhere other than the textarea or button, and if so and the textarea is empty hide the button, otherwise show it.

Demo: [http://jsfiddle.net/HpmDF/](http://jsfiddle.net/HpmDF/)

Note that using classes to identify individual controls isn't the best plan, that's what id is for. If there can be more than one textarea and associated button you'll need a different solution.

P.S. Note also that you asked explicitly about "clicks" and that's what I've provided, but you need to allow for the user tabbing out via the keyboard...

# asp.net - DropDownlist 总是返回第一个项目

> ID：12031915
> 
> 赞同：0
> 
> 时间：2012-08-20T03:16:37.157
> 
> 标签：asp.net, drop-down-menu

aspx 页面有一个 UC。在 aspx.cs 中

```
if(!isPostBack){
    UC.DataBind();
 } 
```

这个UC还有一个usercontrol UC1。在 UC.ascx.cs

```
 public void DataBind(){
   UC1.DataBind();
 } 
```

在UC1

```
public void  DataBind(){
   List<Registeration> list = ... VAlues from database;
   dropdownlist1.DataSource = list;
   DropDownList1.DataTextField = 'username';
   DropDownList1.DataValueField = 'username';
   DropDownList1.databind();
}  

public void button1_click(){
    string selectedValue = DropDownList1.SelectedItem.Text;
 } 
```

**问题：字符串 selectedValue 的值总是来自第一项......**

评论：DropDownList 在 updatePanel

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T04:07:21.377

看起来你做的一切都是正确的，但你还需要`isPostBack()`在你的用户控件上添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T03:21:30.823

除了 DataTextField 之外，尝试填充 DropDownLost1.DataValueField。因为它没有被分配，所以它可能对于呈现的 DropDown 中的所有项目都是空的。要检查这一点，您可以查看 FireBug 中呈现的 HTML 以查看显示的内容。

# cocoa - 响应在 NSMenu 中打开最近的点击

> ID：12031918
> 
> 赞同：4
> 
> 时间：2012-08-20T03:17:33.583
> 
> 标签：cocoa, nsmenu

我正在尝试响应用户在我的非基于文档的 Cocoa 应用程序中单击“打开最近”菜单中的项目。我可以通过将文件附加到 IB 中的 IBAction 来处理文件->打开。但是，当用户从“最近”列表中单击某些内容时，我无法弄清楚如何处理。我需要某种代表吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-09T13:06:28.877

'恐怕这有点晚了，但你仍然需要一个答案：

我用它`[NSDocumentController sharedDocumentController]`来做我所有的举重。文档在[这里](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html)。您的项目不必是基于文档的。

在标题中设置一个 NSDocumentController 变量：

```
NSDocumentController *theDocCont; 
```

然后在您的主 AppDelegate 文件中实现类似以下内容：

```
-(void)addToRecent:(NSArray*)URLs
{
    if (!theDocCont) {
        theDocCont = [NSDocumentController sharedDocumentController];
    }
    [URLs enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
        [theDocCont noteNewRecentDocumentURL:obj];
    }];
}

-(void)application:(NSApplication *)sender openFiles:(NSArray *)filenames
{
    [self openItems:filenames addToRecents:NO]; //see later
} 
```

您现在可以通过调用 NSOpenPanel`[self addItems:[myNSOpenPanel URLs] addToRecents:YES];`的完成块来添加到“最近”菜单。

基本上，该`-addToRecent:`方法应该被赋予一个 NSURLs 的 NSArray。然后，它们会被`-noteNewRecentDocumentURL:`.

当应用程序正在运行并且您单击该菜单中的一个项目时，操作系统将寻找实现`-application:openFiles:`（如果它没有找到它，将会有一个 NSAlert，类似于“yourApp 无法打开这种类型的文件” ）。`fileNames`将是 NSURL 的 NSArray。

您可能希望以不同的方式处理 URL 的打开，但我已经展示了我的，因为它突出显示了一个小问题（就像我最初所做的那样）您尝试在调用`-application:openFiles:`. 在我的项目中，我有一个公共方法来处理从应用程序的各个部分调用的 URL 的打开，并且默认情况下将打开的 URL 添加到最近列表中；但我不想重新添加已经来自“打开最近”菜单的项目，因此是`addToRecents:`签名部分的原因。如果你尝试这样做，就会发生崩溃——我想这就像一个无限的反馈循环！

# android - 是否可以以编程方式检测 Android 虚拟按钮？

> ID：12031923
> 
> 赞同：3
> 
> 时间：2012-08-20T03:18:50.263
> 
> 标签：android, button, virtual

Android 似乎正在切断具有虚拟/屏幕按钮的设备的底部 100 像素。是否可以检测当前手机/平板电脑是否正在使用屏幕按钮，以便我可以解决缺少的空间？如果是这样，是否也可以获得按钮的高度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T06:11:32.297

您可以使用 来检查设备是否具有永久（硬件）菜单按钮[`hasPermanentMenuKey()`](http://developer.android.com/reference/android/view/ViewConfiguration.html#hasPermanentMenuKey())。它可以如下使用：

```
boolean hasMenuKey = ViewConfiguration.get(context).hasPermanentMenuKey(); 
```

请注意，此技术仅适用于 API 14+（ICS、JB）。没有任何设备 pre-API-11 有菜单按钮，因此只有 API 11-13 没有检查；请记住，这 3 个 API 级别目前仅占[Android 用户的 2.3%](http://developer.android.com/about/dashboards/index.html)。

或者（虽然不可靠），您可以尝试搜索 D-Pad：

```
boolean hasDpad = getResources().getConfiguration().naviation == Configuration.NAVIGATION_DPAD; 
```

没有办法检查硬件搜索按钮（我也会假设 home/back），如此[处所示](https://groups.google.com/forum/?fromgroups#!topic/android-developers/zzErTdL9tEA%5B1-25%5D)。（也在[此处](https://stackoverflow.com/questions/7269891/check-if-android-device-has-search-hardware-button)；该线程提出了一种替代方法，尽管我不确定它是否适用于您的情况。）

我会提到两件事：虚拟按钮永远不应该覆盖您的内容。它们确实会从设备窗口的高度中减去（由显示器的指标获取），但如果您将`match_parent`其用作高度，它们将永远不会妨碍您的布局。其次，无法获取虚拟按钮栏的准确高度；它可能会在构建之间发生变化。Android API 中也没有本地方式来获取“可用”屏幕空间（底部栏未覆盖的区域）。

**所以**，这是我的建议：

*   忘记检查硬件按钮。你应该只关心你有多少空间，而不是你失去了多少（或者你为什么失去它）。
*   制作[自定义布局类型](http://developer.android.com/guide/topics/ui/custom-components.html)（扩展`ViewGroup`或`LinearLayout`其他）。
*   将现有布局包装在此布局中。
*   您现在可以覆盖 [ `onLayout()`]( [http://developer.android.com/reference/android/widget/LinearLayout.html#onLayout(boolean](http://developer.android.com/reference/android/widget/LinearLayout.html#onLayout(boolean) , int, int, int, int)) 或[`onMeasure()`](http://developer.android.com/reference/android/widget/LinearLayout.html#onMeasure(int,%20int))，并从中获取布局的*确切*高度. （您可能想[以此](https://stackoverflow.com/questions/7423082/authorative-way-to-override-onmeasure)作为参考。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T03:53:30.283

据我记得，底部的虚拟按钮仅适用于 android 版本 3.0 (Honeycomb) 及更高版本。至于身高问题，我从来没有真正研究过。

# python - Python ftplib 没有完全下载

> ID：12031928
> 
> 赞同：0
> 
> 时间：2012-08-20T03:19:17.847
> 
> 标签：python, ftplib

我正在使用 python ftplib 从构建 ftp 服务器下载构建。这些文件大约为 1.5-1.6 GB。我使用批处理文件来运行程序。这样更容易安排下载。问题是，下载的文件似乎不起作用。他们抛出一个兼容性错误（windows）。如果我使用 FileZilla 下载文件，则文件可以正常工作。另外，源文件和下载的文件相差几百B。到底是怎么回事？

```
import ftplib, sys, os

ftp = ftplib.FTP("<server_name")
try:
    ftp.login(user= "<user>", passwd = "<password>")
except:
    sys.stderr.write('Could not login.')

data=[]
ftp.dir(data.append)
builds=[]

trg=0           
trg_bld=""
for i in data:
    if len(i.split(" "))>12:
        if len(i.split(" ")[12].split("_"))>2:
    #this line is to find the version on the server
            if (i.split(" ")[12].split("_")[1]== "3.1.0"):
                if int(i.split(" ")[12].split("_")[2])>trg:
                    trg_bld = i.split(" ")[12]

trg_file = trg_bld
print trg_file
if os.path.isfile(trg_file):
    sys.stderr.write('File already exists.')
    sys.exit(1)
f= open(trg_file, "w")
ftp.retrbinary('RETR '+trg_bld, f.write)
f.close()
ftp.close()
sys.stdout.write("File download successful.") 
```

批处理文件： E: cd E:\Builds python ftp_sch.py​​ pause

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T03:54:23.943

`f= open(trg_file, "w")`->`f= open(trg_file, "wb")`

如果没有`b`标志，Python 认为您正在编写 ASCII 并且它正在更改行尾（因此存在大小差异和损坏的二进制文件）。

# ios - 使用 AirPrint 打印锁定的 pdf 时如何将密码传递给 UIPrintInteractionController？

> ID：12031929
> 
> 赞同：0
> 
> 时间：2012-08-20T03:19:40.397
> 
> 标签：ios, pdf, airprint

我想使用AirPrint在iOS上打印锁定的pdf，我知道密码，我想知道是否有办法将密码传递给`UIPrintInteractionController`我使用它打印的时候？因为我不想`CGPDFDocumentUnlockWithPassword`用来解锁pdf并绘制每一页。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T08:46:38.737

我发现使用 AirPrint 时不需要传递密码。一旦你
解锁了 pdf，使用 CGPDFDocumentUnlockWithPassword。你得到一个 CGPDFDocumentRef，从 UIPrintPageRenderer 声明一个子类。实现 - (void)drawPageAtIndex:(NSInteger)pageIndex inRect:(CGRect)printableRect 以在上下文中呈现每个页面。它可以是这样的

```
- (void)drawPageAtIndex:(NSInteger)pageIndex inRect:(CGRect)printableRect
{
    CGRect pageRect = CGPDFPageGetBoxRect([_item openPage:pageIndex +1], kCGPDFMediaBox);
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetRGBFillColor(context, 1.0,1.0,1.0,1.0);
    CGContextFillRect(context,printableRect);
    CGContextTranslateCTM(context, 0.0, printableRect.size.height);
    CGContextTranslateCTM(context, printableRect.origin.x, printableRect.origin.y);
    CGContextScaleCTM(context, printableRect.size.width/pageRect.size.width, -printableRect.size.height/pageRect.size.height);
    CGContextSaveGState(context);
    CGContextDrawPDFPage(context, [_item openPage:pageIndex + 1]);
    CGContextRestoreGState(context);

} 
```

而且您不需要设置printingItem 或printingItems。因为你可以通过实现来获取页面范围 - (NSInteger)numberOfPages

最后不要忘记将其设置为 UIPrintInteractionController 。

# android - 滚动视图中的android ImageButton在滚动到该位置时具有一些效果

> ID：12031930
> 
> 赞同：1
> 
> 时间：2012-08-20T03:19:42.660
> 
> 标签：android, android-layout, android-view

我正在考虑实现以下功能。

五个 ImageButtons 已添加到滚动视图中。

假设我设置滚动视图可以在视图中显示 3 个 ImagesButton(1,2,3) 。

如何设置中间按钮的效果（2）（可能中间按钮比其他按钮更亮）？

位置是固定的。所以当我在视图中上下滚动时，中间的按钮总是比其他按钮更亮。

如果你们中的任何人知道如何实现它。请告诉我。

提前致谢。

:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T04:46:59.720

如果我正确理解您的问题，您可以在您的情况出现时将按钮的背景动态设置为唯一的布局文件。

# azure - Azure 队列创建最佳实践和规模

> ID：12031931
> 
> 赞同：6
> 
> 时间：2012-08-20T03:20:02.120
> 
> 标签：azure, azure-storage

我正在研究 Windows Azure 上的大规模 Web 性能应用程序（目前是理论上的）架构，并想就“Windows Azure 队列（不是 SB）”以及如何最好地扩展/创建它们来开动脑筋。

我基本上在看 MVC 前端（Web 角色）、Windows Azure 队列（异步消息解耦）、工作角色和黑化的 SQL DB。

我的理解是，我们在 Web Role 上收到一条消息，然后将其传递给队列，Worker Role 将轮询队列 {做工作……例如 SQL DB CRUD 操作}并发回完成消息。

处理 Windows Azure 队列创建以实现规模化以及通过 Web 角色和工作角色来回传递消息的最佳方式是什么？最好有一个队列用于发送工作，例如订单，然后另一个队列用于通知，例如状态消息

我看到很多帖子说您应该在应用程序代码之外创建队列，这是有道理的，但是您如何使用当前的队列限制来扩展它“单个 Windows Azure 队列的可扩展性目标被“限制”在 500 个事务/秒”？

MSDN 有一些关于通过队列扩展的重要资源。

• 角色实例扩展是指添加和删除额外的Web 或工作者角色实例来处理时间点工作负载。这通常包括更改服务配置中的实例计数。增加实例计数将导致 Windows Azure 运行时启动新实例，而减少实例计数又会导致它关闭正在运行的实例。

• 进程（线程）扩展是指通过根据当前工作负载向上和向下调整线程数，在给定角色实例中的处理线程方面保持足够的容量。

简而言之，我正在寻找以下问题的答案：

1.  队列创建最佳实践？
2.  Web 角色（MVC 应用程序）如何跟踪消息，即它是否在传递消息后轮询“通知”队列，在 Web 角色中处理消息相关性以发送回客户端的最佳方法是什么（网络消费者）？
3.  扩展选项是最好的方法，还是我应该在运行时查看队列的动态扩展（如果是这样的话？我认为 SB 队列在这种情况下可能会更好）创建新队列以规避 500 个事务/秒的限制?

如前所述，我的问题目前更具理论性，我想设计和未来证明任何未来的解决方案。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T04:05:22.977

对于如何跟踪响应的问题，我通常会执行以下操作：

1.  Web 角色将包含作业 ID 的消息写入队列。
2.  工人角色完成工作并将结果写入具有分区键的表。
3.  Web 角色正在轮询表的该行。一旦它存在，答案就会回来。

再说一次，如果这是一个用户交互的事情，用户实际上是在等待打开的 HTTP 连接以获取结果，那么最好使用同步通信并跳过队列。

如果我是你，我至少会看看使用 0MQ（ZeroMQ，或其新的 fork Crossroads I/O）之类的东西，它在原始套接字之上为你提供了很好的抽象，这对这类事情很有用. 例如，Web 服务器通过 PUSH 套接字发送消息，工作角色通过 PULL 套接字接收，工作角色通过 PUB 套接字发布响应，而网络角色通过 SUB 套接字接收响应。PUSH/PULL 进行负载平衡，而 PUB/SUB 负责将消息返回给等待的 Web 角色。仅供参考，这正是 Mongrel2 使用的消息传递架构和技术。

就每秒超过 500 次操作而言，您可以创建多个队列并随机向它们喷射消息。（每个工作人员通常会轮询所有这些。）但请记住，单个存储帐户的每秒操作数限制为 5,000，因此在创建 10 个队列后，您需要创建一个新的存储帐户才能获得更有保证的可扩展性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-03T04:57:01.843

我建议您考虑使用这种模式 - 如果您想要一个快速同步（和可扩展）的解决方案。

[![在此处输入图像描述](../Images/f7fe1362e0a61f8caa8d133dd1e6455c.png)](https://i.stack.imgur.com/xi5W6.png)

使用该模式的原因是队列允许您独立扩展 Web 和工作角色。这确实意味着相当多的队列，但这意味着您可以，例如，拥有 2 个 Web 工作人员角色，如果需要，可以从 6 个工作人员角色扩展到 8 个工作人员角色。

我想这可能比轮询 SQL 更快，并且比不使用队列更有弹性。

更多详细信息在这里：[https ://msdn.microsoft.com/en-us/library/dn589781.aspx](https://msdn.microsoft.com/en-us/library/dn589781.aspx)

# mongodb - 上游在读取响应标头时过早关闭连接

> ID：12031935
> 
> 赞同：4
> 
> 时间：2012-08-20T03:21:03.803
> 
> 标签：mongodb, nginx, flask, dotcloud

我正在尝试在 dotcloud（使用 nginx）和 MongoDB 上部署一个 Flask Python 应用程序，并且有一次我正在路由到 Twitter 以进行 OAuth 授权。在尝试路由回我的应用程序时，我得到了标题中描述的 nginx 错误，但不知道为什么。有什么建议么？它在本地主机的开发模式下工作得很好

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-03T19:17:15.653

看看你的 uWSGI 日志，对我来说是在`/var/log/uwsgi`.

我在没有安装插件时遇到了这个问题。就我而言`# apt-get install uwsgi-plugin-python`，成功了，因为我试图执行一个 python 脚本。

没有这个插件`502`会从 nginx 产生一个，在我的 uWSGI 日志中我看到：

`-- unavailable modifier requested: 0 --`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-21T14:35:59.500

当您的上游服务器超时（花费太长时间）时，通常会发生该错误。发生这种情况时，您是否在应用程序日志 ( `/var/log/supervisor/`) 中看到任何内容？还有请求需要多长时间。

我看到一个问题，uWSGI服务器连接外部源，外部源响应时间长，导致uWSGI请求时间长，于是nginx放弃了。

要查找的另一件事是查看您的进程是否内存不足并被杀死，这也可能导致此类错误。

# php - Iphone HTTP 发布到 php 页面

> ID：12031938
> 
> 赞同：1
> 
> 时间：2012-08-20T03:21:28.210
> 
> 标签：php, iphone, post, asihttprequest

我目前正在尝试将数据发布到 php 时代。这是我的iphone代码：

```
ASIFormDataRequest *request = [[ASIFormDataRequest alloc] initWithURL:[NSURL URLWithString:urlString]];
request.timeOutSeconds = 5;
[request setRequestMethod:@"POST"];
[request setPostValue:tmpComment forKey:@"content"];
[request setPostValue:tmpPoint forKey:@"point"];

NSLog(@"comment : %@",tmpComment);// it appears right
NSLog(@"point:%@",tmpPoint);//
request.delegate=self;
[request startAsynchronous]; 
```

我的 php 页面是这样的：

```
print_r($_POST);
echo $_SERVER['REQUEST_METHOD'];
print_r($_GET); 
```

响应字符串如下：

```
Array
(
)
GET
Array
(
) 
```

这里没有发布数据。所以我很困惑为什么请求方法仍然是“GET”而不是“POST”。我应该在某处配置php服务器吗？</p>

非常感谢！~

回答:: 我发现网址应该是“http://myurl/index.php”而不是“http://myurl/”以避免重定向。

感谢 Ayesh K 的帮助和提示~！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:22:21.987

我发现 url 应该是`http://myurl/index.php`而不是`http://myurl/`避免重定向。

# php - PHP MYSQL 数组 foreach 和 insert

> ID：12031941
> 
> 赞同：0
> 
> 时间：2012-08-20T03:21:49.287
> 
> 标签：php, mysql, arrays, foreach

**表1**

```
id | detail
1  | this, that
2  | these, those 
```

**表2**

```
id | visit  | cost
1  | this   | 20
2  | that   | 30
3  | these  | 40
4  | those  | 50 
```

**PHP：**

```
<?php 

$id=$_GET['id'];    
$detail=$_GET['detail'];
$pieces = explode(",", $rows['detail']);

    // $pieces[0]; piece1
    // $pieces[1]; piece2        
    // $pieces[2]; piece2        
    // $pieces[3]; piece3    
    // $pieces[4]; piece4

    foreach($pieces[1] as $test){            

$query="SELECT * FROM tbl1, tbl2 WHERE
  $test = tbl2.cost AND
  tbl1.id='$id'";
    }   

$result=mysql_query($query) or die("error: " . mysql_error());

while($rows=mysql_fetch_array($result)){    
?>
<table>
    <tr>
    <td><input value="<? echo $rows['code'];?>" readonly="readonly"/></td>
    <td><input value="<? echo $rows['cost']; ?>" readonly="readonly"/></td>
    </tr>
  </table>

<?php
}
?> 
```

对于 id=1, 数组 0=>this, 1=>that 所以, `foreach($pieces[1] as $test)`, 它的意思是“那个”

以上有效，但是，当我更改`$pieces[1]`为时`$pieces[0]`，我仍然得到与 对应的结果`$pieces[1]`。而且，当我将其更改为`$pieces[4]`不存在时，我再次得到与`$pieces[1]`.

我在哪里做错了？我怎样才能使这个阵列工作？

根据 tbl1.id=1 piece[0]=>this,piece[1]=>that 我想让它适用于我的桌子。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:38:33.390

$pieces[1]，你在 foreach 循环中使用的变量是一个字符串，而不是一个数组。您应该循环遍历 $pieces 数组，这样：

```
foreach($pieces as $test){ 
```

... 不是

```
foreach($pieces[1] as $test){ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T03:41:12.943

$pieces[1] 不是数组而是数组的一个元素($pieces)，所以最好不要使用循环语句，

```
$query="SELECT * FROM tbl1, tbl2 WHERE
  $pieces[1] = tbl2.cost AND
  tbl1.id='$id'"; 
```

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T03:40:01.017

当你跑

```
$result=mysql_query($query) or die("error: " . mysql_error()); 
```

它将返回 from 查询的结果。但是您的查询是什么？这是您设置 $query 的最后一个字符串，这是您的 for 循环的最后一次迭代。这似乎效率低下，而不是您的预期行为。

假设您想要所有结果（并且不关心查询优化），您可以执行以下操作：

```
foreach($pieces as $test){            
    $query="SELECT * FROM tbl1, tbl2 WHERE
    $test = tbl2.cost AND tbl1.id='$id'";

    $result[]=mysql_query($query) or die("error: " . mysql_error());
}

foreach ($results as $result){
    $rows=array_push(mysql_fetch_array($result));
} 
```

现在，如果您只需要特定部分的详细信息，您甚至不需要 for 循环。

```
// replace 3 with the desired element
$query="SELECT * FROM tbl1, tbl2 WHERE
$pieces[3] = tbl2.cost AND tbl1.id='$id'";

$result=mysql_query($query) or die("error: " . mysql_error());

mysql_fetch_array($result); 
```

# ios - UISearchBar 取消按钮在 UISearchDisplayController 中更改单词“取消”的语言

> ID：12031942
> 
> 赞同：2
> 
> 时间：2012-08-20T03:22:03.937
> 
> 标签：ios, uisearchbar

在 iOS5.0 中使用 arc 我需要将 UISearchDisplayController 的取消按钮中的“取消”一词更改为从用户选择的语言派生的词。由于语言不是基于本地化选择的，所以我不能只使用它。这个词来自一个网络服务。我通过走下面帖子中的子视图找到了一种方法，但是在不假设苹果的视图层次结构的情况下，有没有其他方法可以做到这一点？

[如何在 UISearchDisplayController 的 UISearchBar 中更改“取消”按钮、“无结果”标签的字符串？](https://stackoverflow.com/questions/7238878/how-can-i-change-strings-of-cancel-button-no-results-label-in-uisearchbar-o)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-07-04T03:13:48.027

如果您想在 iOS 系统中根据不同语言本地化“取消”按钮的标题。您可以更改`CFBundleDevelopmentRegion`.`Info.plist`

```
<key>CFBundleDevelopmentRegion</key>
<string>en,ru,zh_CN</string> 
```

或者您可以`Info.plist`使用 Xcode Editor 在文件中选择它们。

![在此处输入图像描述](../Images/8d46d0e52ac67d4ba1cc22741ccf02b5.png)

这是来自 Apple Doc的[语言 ID 。](https://developer.apple.com/library/prerelease/ios/documentation/MacOSX/Conceptual/BPInternational/LanguageandLocaleIDs/LanguageandLocaleIDs.html#//apple_ref/doc/uid/10000171i-CH15-SW6)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T06:12:37.657

看来您可以使用`UIAppearance`协议来实现这一点：

```
[[UIButton appearanceWhenContainedIn:[UISearchBar class], nil]
     setTitle:@"Hello world" forState:UIControlStateNormal]; 
```

我只对 Apple 的“TableSearch”示例项目进行了快速检查，它在那里工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T09:06:47.007

try this

```
[[UIButton appearanceWhenContainedIn:[UISearchBar class], nil] 
                                     setTitle:@"button title" 
                                     forState:UIControlStateNormal]; 
```

if you want to change hint text

```
[[UITextField appearanceWhenContainedIn:[UISearchBar class], nil] 
                                        setPlaceholder:@"text hint"]; 
```

# java - 发生了什么：org.apache.ws.commons.schema.XmlSchemaCollection.read(InputSource)？

> ID：12031947
> 
> 赞同：20
> 
> 时间：2012-08-20T03:23:14.643
> 
> 标签：java, xml, spring, apache, maven

我有一个包含 Spring 3.0.2 和 XmlSchema.jar 1.4.7 的 java 项目

该项目的 pom.xml 包含作为依赖项：

```
 <dependency>
        <groupId>org.apache.ws.commons.schema</groupId>
        <artifactId>XmlSchema</artifactId>
        <version>1.4.7</version>
    </dependency> 
```

该项目编译正常，但在点击上下文页面时报告以下错误：

```
SEVERE: StandardWrapper.Throwable
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'schemaCollection' defined in class path resource [applicationContext-jdeInterfaceService.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: org.apache.ws.commons.schema.XmlSchemaCollection.read(Lorg/xml/sax/InputSource;)Lorg/apache/ws/commons/schema/XmlSchema;
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)
at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)
at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)
at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)
at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)
at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)
at javax.servlet.GenericServlet.init(GenericServlet.java:160)
at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1266)
at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1185)
at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:857)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:136)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.NoSuchMethodError: org.apache.ws.commons.schema.XmlSchemaCollection.read(Lorg/xml/sax/InputSource;)Lorg/apache/ws/commons/schema/XmlSchema;
at org.springframework.xml.xsd.commons.CommonsXsdSchemaCollection.afterPropertiesSet(CommonsXsdSchemaCollection.java:137)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
... 33 more
20/08/2012 12:05:35 PM org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Allocate exception for servlet spring-ws
java.lang.NoSuchMethodError: org.apache.ws.commons.schema.XmlSchemaCollection.read(Lorg/xml/sax/InputSource;)Lorg/apache/ws/commons/schema/XmlSchema;
at org.springframework.xml.xsd.commons.CommonsXsdSchemaCollection.afterPropertiesSet(CommonsXsdSchemaCollection.java:137)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)
at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)
at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)
at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)
at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)
at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)
at javax.servlet.GenericServlet.init(GenericServlet.java:160)
at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1266)
at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1185)
at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:857)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:136)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:662) 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-02-14T06:39:48.913

正确`dependency`的是

```
<dependency>
    <groupId>org.apache.ws.xmlschema</groupId>
    <artifactId>xmlschema-core</artifactId>
    <version>2.0.1</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-20T05:23:04.647

> 请将您的依赖项更改为 2.0.1 或 2.0.2

*旧版 1.4.7 没有定义方法*

```
public XmlSchema read(Source source) {
    if (source instanceof SAXSource) {
        return read(((SAXSource)source).getInputSource());
    } 
```

检查[1.4.x javadoc](http://ws.apache.org/commons/XmlSchema/apidocs/index.html)和[2.x javadoc](http://ws.apache.org/commons/xmlschema20/xmlschema-core/apidocs/index.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-04T12:26:27.307

[检查存储库http://mvnrepository.com/artifact/org.apache.ws.xmlschema/xmlschema-core](http://mvnrepository.com/artifact/org.apache.ws.xmlschema/xmlschema-core)中最新版本的 Apache XmlSchema

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-17T04:52:51.347

首先，您需要从项目类路径中删除**cxf-bundle-xxx.jar**（如果存在）。然后搜索最新**的 xmlschema-core.jar**并添加到您的类路径中。

在我的情况下，我已经从类路径中删除了 cxf-bundle-2.3.1.jar 并在类路径中添加了**xmlschema-core-2.0.1**，这工作正常。

希望它会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-24T05:59:22.093

这些步骤不一定适用于 WebLogic，因为它有自己的实现类。如 Anshul 所示更新依赖项后，您还需要告诉 WebLogic 在 weblogic-application.xml 中首选该包

```
<wls:prefer-application-packages>
    <wls:package-name>org.apache.ws.commons.schema</wls:package-name>
</wls:prefer-application-packages> 
```

# xcode - Cordova 是否替换了 PhoneGap

> ID：12031953
> 
> 赞同：1
> 
> 时间：2012-08-20T03:24:30.417
> 
> 标签：xcode, cordova, cordova-2.0.0

我正在使用 OSX 10.8 和 XCode 4.41。我从 PhoneGap 网站浏览并安装了 Cordova。浏览了 PhoneGap 网站的入门部分。我成功安装了 Cordova 并在 iPhone 模拟器上启动了它。我的问题是我是否只是将我的应用程序（例如：index.html、关联的 js 和 css 文件）添加到 www 文件夹？是否有 phonegap.js 或 .jar 文件，或者我需要添加到应用程序才能编译它的任何其他文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T03:36:52.360

由于法律原因，该名称从 PhoneGap 更改为 Cordova，Adobe 现在拥有 PhoneGap 上的商标。如果您之前使用过 phonegap.js 和 phonegap.jar，那么它们现在是包含版本号的 cordova.js 和 cordoava.jar。

Cordova 将是 Apache 的 src 发行版，PhoneGap 将是 phonegap.com 提供的下游二进制发行版。

# jquery - jQuery XML Parser Loop 在 IE8 中停止在 1228 行

> ID：12031954
> 
> 赞同：0
> 
> 时间：2012-08-20T03:24:30.567
> 
> 标签：jquery, internet-explorer-8, xml-parsing

我有一个 jQuery XML 文件解析器，它是从某个地方获得的，它读取 XML 文件并将内容解析为 HTML 页面中的列表。

```
$(document).ready(function(){
    $("#dvContent").append("<ol></ol>");
    $.ajax({
            type: "GET",
            url: "BookList.xml",
            dataType: "xml",
            success: function(xml){
                $(xml).find('Book').each(function(){
                    var sTitle = $(this).find('Title').text();
                    var sPublisher = $(this).find('Publisher').text();
                    $("<li></li>").html(sTitle + ", " + sPublisher).appendTo("#dvContent ol");
                });
        },
        error: function() {
                alert("An error occurred while processing XML file.");
        }
    });
}); 
```

我的 XML 文件有大约 24000 行，每行 6500 是标签。Chrome 可以在大约 1 秒或更短的时间内遍历所有 6400，但 IE8 似乎限制在 1228 行。

这是 IE8 将这个循环解释为无限并停止它的进程还是其他什么？

提前谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:52:02.760

一遍又一遍地附加到 DOM 对性能不利。你应该追加一次。每次查找要附加的位置也很昂贵。

```
$("<li></li>").html(sTitle + ", " + sPublisher).appendTo("#dvContent ol"); 
```

每次查找 $(this) 也很昂贵，因为它会创建一个新的 jQuery 对象。

```
var sTitle = $(this).find('Title').text();
var sPublisher = $(this).find('Publisher').text(); 
```

所以像这样的东西应该表现得更好一点

```
var outHTML = "";
$(xml).find('Book').each(function(){
    var book = $(this),
        sTitle = book.find('Title').text(),
        sPublisher = book.find('Publisher').text();
    outHTML += "<li>" + sTitle + ", " + sPublisher + "</li>");
});
$("#dvContent ol").append(outHTML); 
```

最后 6400 个项目要添加到页面中，最好以另一种格式显示数据。

# aspnetdb - 使用 SQL Server 标准版（非 Express）和 Visual Studio 2010 为 asp.net MVC 项目创建 aspnetdb

> ID：12031955
> 
> 赞同：1
> 
> 时间：2012-08-20T03:24:44.060
> 
> 标签：aspnetdb

我正在使用 VS 2010、MVC 3.0、SQL Server 标准版（不是 Express）。我正在尝试`aspnetdb`在 MVC 3.0 项目 ( `MusicStore`) 应用程序上创建。

当我单击 WSAT（网站管理工具） - 安全选项卡时，我收到此错误：

> *您选择的数据存储存在问题。这可能是由无效的服务器名称或凭据或权限不足引起的。这也可能是由于未启用角色管理器功能造成的。单击下面的按钮可重定向到您可以选择新数据存储的页面。*
> 
> *以下消息可能有助于诊断问题：无法连接到 SQL Server 数据库。*

任何人都可以请帮忙。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T06:41:51.273

由于您没有安装 SQL Server **Express**，因此您不能使用该连接字符串。和功能**仅**在 SQL Server Express`AttachDbFileName=`中可用。`User Instance`

 **你需要：

1.  对您的实例执行`aspnet_regsql`实用程序（在您的`C:\Windows\Microsoft.NET\Framework\v4.0.30319`目录中 - 适应您的框架版本，`Framework64`如果您在 64 位计算机上运行，​​则可能使用）`SU\SQLSERVER`以在您的服务器上创建 ASP.NET 成员资格数据库

2.  您需要更改连接字符串以转到服务器 - 不使用附件：

    ```
    Data Source=SU\SQLSERVER;database=ASPNETDB;Integrated Security=SSPI; 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T15:23:41.313

我遇到了同样的问题，并通过以下提到的步骤解决了它：-

1.  打开 SQL Server Management Studio，只需尝试登录并查看数据库列表，看看您是否拥有“aspnetdb”。
2.  如果您没有，请打开命令提示符并输入“c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regsql.exe”。
3.  在前两个屏幕上单击 NEXT，然后在第三个屏幕上检查 Server 的值表示服务器名称。此名称应与您登录 Sql Server management Studio 时使用的名称完全相同。如果服务器名称不同，请将其替换为您用于登录的名称。如果您使用 IP 地址登录，即使这样也可以。
4.  保持选中 Windows 身份验证的单选按钮，并且数据库应该是 . 单击 NEXT 两次，然后单击 Finish。
5.  现在，如果您重复第 1 步，您应该能够看到“aspnetdb”。
6.  然后将此代码添加到您的 web.config 文件中。

    ```
    <remove name="LocalSqlServer"/>
    <add name="LocalSqlServer"
         connectionString="data source=[YOUR LOGIN ID FOR SQL SERV MANG STUDIO];
      Initial Catalog=aspnetdb;
      Integrated Security=True;" /> 
    ```

7.  保存它，然后您可以继续使用 ASP.NET 网站管理工具。

    祝一切顺利**

# css - div高度位置不起作用

> ID：12031958
> 
> 赞同：0
> 
> 时间：2012-08-20T03:25:15.157
> 
> 标签：css, html, inheritance

我在为学校做一个项目时遇到问题，我们正在做的是创建 div 部分。在每个 div 部分中，我对它们进行了颜色编码，以便更清楚地看到它们。虽然在我的 leftnav div 中，它不会分支到底部到页脚。JSFIDDLE 在这里- [http://jsfiddle.net/rM8zw/](http://jsfiddle.net/rM8zw/)

如果有人可以帮我解决这个问题并解释我做错了什么？我有三个容器 div，所以我的一些继承可以正常工作。leftnav 和 bodyline 的容器，主站点的容器，BmiddleLeft 和 Right 的容器。提前谢谢大佬。

我试图弄清楚为什么我的#leftnav 不会达到我的身体线的高度，所以它是均匀的。

这是CSS-

```
#container{
    width:980px;
    height:auto !important;
    height:900px;
    min-height:900px;
    padding-top:20px;
    padding-bottom:20px;
    margin: 0 auto; 
    boder: solid 0px;
    overflow:hidden;
}
#holder{
    width:980px;
    height:auto !important;
    height: 800px;
    min-height:800px;
    padding:0;
    margin:0 auto; 
    border: solid 0px;
    overflow:hidden;
    background:#FFF;
}
#header{
    width:980px;
    height:100px;
    border:solid 0px;
    margin:0 auto;
    padding:0;
    background:#FF0000;
}
#navbar{
    width:980px;
    height:40px;
    border:solid 0px;
    margin:0 auto;
    padding:0;
    background:#c0c0c0;
}
#bodycontainer{
     width:980px;
     height:800px;
     min-height:800px;
     height:auto !important;
     overflow:hidden;
}
#leftnav{
     float:left;
     width:200px;
     height:1200px;
     min-height:1200px;
     height:auto !important;
     padding:0;
     overflow:hidden;
}
#bodyline{
     float:right;
     width:780px;
     height:800px;
     min-height:800px;
     height:auto !important;
     background:#00FF40;
     overflow:hidden;
} 
```

继承人我目前使用的 HTML-

```
<div id="container">
    <div id="holder">
    <div id="header">
    </div>
    <div id="navbar">
    </div>
    <div id="bodycontainer">
        <div id="leftnav">
        </div>
        <div id="bodyline">
            <div id="Btop">
            </div>
            <div id="BmiddleCont">
                <div id="BmiddleLeft">
                hello
                <br />
                </div>
                <div id="BmiddleRight">
                </div>
            </div>
            <div id="Bbottom">
            </div>
            <div id="BbottomLast">
            </div>
            </div>
        </div>
    </div>
    <div id="footer">
    </div>
</div> 
```

希望这会好一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T04:22:57.657

如果您设置`min-height`as `inherit`，那么它将上升，直到找到一个值。在这种情况下，最多`#container`，它设置为`900px`。这就是为什么 the `height`of your `#leftnav`is only `900px`。`min-height`覆盖`height`. 此外，如果您`min-height`取出并保留`height: auto`，那么您对 ​​没有任何限制`height`，因此`height`您的`leftnav`成为`height`其内容的 。`0`在这种情况下。

有几种方法可以设置它的`height`. 最简单的一个，因为您明确设置右侧所有元素的高度，将它们相加，然后将结果值明确设置`height`为您的`leftnav`.

如果这些值只是虚拟值并且右侧元素的高度将取决于`height`它们中的内容，那么您有几个选择：

**1.**实际上将`height`你`#leftnav`的设置`height`为它的父级（`#bodycontainer`）。您可以通过将其设置`position`为`absolute`（并且不要忘记`position: relative`在父级上设置）并将其顶部、左侧、底部值设置为 0 来做到这一点。在这种情况下，您还必须将`padding-left`其父级 ( `#bodycontainer`) 设置为相同`#leftnav`的值`width`（`200px`这里）。或设置`left-margin: 200px;`其兄弟 ( `#bodyline`) 以避免必须修改`width`of`#bodycontainer`或将其设置[**`box-sizing`**](https://developer.mozilla.org/en-US/docs/CSS/box-sizing)为`border-box`。-[**演示**](http://jsfiddle.net/thebabydino/rM8zw/2/)

**2.**让它看起来像它一样`height`。

**a)**简单的方法。使用[**`gradient`**](https://developer.mozilla.org/en-US/docs/CSS/linear-gradient)带有颜色停止`background`的父级 ( `#bodycontainer`) - [**DEMO**](http://jsfiddle.net/thebabydino/rM8zw/3/) //[**没有冗余代码的演示**](http://jsfiddle.net/thebabydino/rM8zw/11/)

```
background: linear-gradient(left, #FF00FF 200px, transparent 200px); 
```

请记住两件事：

*   一，您必须添加前缀，因为尚不支持无前缀渐变
*   二，这在IE9或更早版本中不起作用

（*有关更多详细信息，**请参见[caniuse.com](http://caniuse.com/#feat=css-gradients)*）

**b)**最佳兼容性方法（适用于 IE8+）。在父元素上使用[**伪元素**](https://developer.mozilla.org/en-US/docs/CSS/Pseudo-elements)`#bodycontainer`，将其绝对定位，将其`top`和`left`值`bottom`设置为`0`，给它`#leftnav`'s`width`和所需的`background`。- [**DEMO**](http://jsfiddle.net/thebabydino/rM8zw/4/) //[**没有多余代码的演示**](http://jsfiddle.net/thebabydino/rM8zw/12/)

```
#bodycontainer:before {
    position: absolute;
    top: 0; bottom: 0; left: 0;
    width: 200px;
    background: #f0f;
    content:'';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T06:19:15.477

使用 display:table-cell 并删除浮动标签。

```
 #leftnav{
     display:table-cell;
     width:200px;
     height:inherit;
     min-height:inherit;
     height:auto !important;
     background:#FF00FF;
     padding:0;
     overflow:hidden;
      }
    #bodyline{
    display:table-cell;
    width:780px;
    height:800px;
    min-height:800px;
    height:auto !important;
    background:#00FF40;
    overflow:hidden;
} 
```

# jquery - 如何获取父节点

> ID：12031959
> 
> 赞同：-2
> 
> 时间：2012-08-20T03:25:36.750
> 
> 标签：jquery, jquery-ui

嘿家伙只是一个快速的问题。

我正在制作一个可排序的拖放系统，我需要它，当用户将消息拖到删除框时，它将**.remove();** 并且会消失（很好地删除它），但问题是它删除了消息的小元素，如主题，我希望它删除整个 div，例如**“消息”**元素之一。那么如何获取**消息 div的 parentNode**

它确实会刷新消息，因此不必担心消息

我的代码是

```
<div class="message 1" id="1">  // I want to remove this part and only this part
                    <ul id="8">
                        <li class="dragable" id="2">
                            <!-- Dragable -->

                        </li>
                        <li class="checkbox" id="4">
                            <input type="checkbox" name="checkbox" class="checkbox" id="messagecheck1">
                        </li>
                        <li id="3"> 
                            <p> hi</p>
                        </li>
                    </ul>
                </div> 
```

js

```
$(".messageholder").sortable({          
        start: function(event, ui){
            $(ui.item).css("opacity", "0.25");
            draggable_sibling = $(ui.item).prev();
            $(".deletebox").show();
        },

        stop: function(event, ui) {
            $(".deletebox").hide();
            if (dropped) {
                if (draggable_sibling.length == 0)
                    $('.messageholder').prepend(ui.item);

                draggable_sibling.after(ui.item);
                dropped = false;
            }
            $(ui.item).css("opacity", "1.00");
        },
        update: function(event, ui){
            //Use's Xhr to save the position of the message
            var array = [];
            $(".messageholder div").each(function(e){
                 array.push($(this).attr('id'));
            });
            $.ajax({
                type: 'POST',
                url: 'json/save.php',
                data: ("data="+array)                           
            });

        }   

    }); 

        $(".refresh").click(function(){
            checkmessages();        
        });     

        $(".deletebox").droppable({         
                drop:function(event, ui){
                    dropped = true;                 
                    $(event.target.parentNode).closest('div').remove();

                    }               

        });     

        $(".messageholder").disableSelection(); 
```

它们是具有相同类名的多个元素，因此我无法在一行代码中 删除**消息类，我必须单独选择元素并像这样删除它。**

**链接** [http://gruber.co.nz/messages/](http://grubber.co.nz/messages/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:29:28.120

如果您使用的是 jQuery，应该会出现一个快速的谷歌搜索：http `.parent()`: [//api.jquery.com/parent/](http://api.jquery.com/parent/)

**额外的**

`.closest(selector)`如果您需要使用选择器来查找不是直接父级的祖先，您也可以使用：http: [//api.jquery.com/closest/](http://api.jquery.com/closest/)

# javascript - 如何将我自己的按钮连接到 downloadify 库

> ID：12031962
> 
> 赞同：0
> 
> 时间：2012-08-20T03:26:03.547
> 
> 标签：javascript

有谁知道我怎样才能将我自己的按钮连接到下载库而不是使用

```
<div id="downloadify"></div> 
```

我想将它分配给其他一些按钮或元素。所以我可以避免使用它拥有的自定义按钮。

lib 页面中的演示是这样的：

```
<script type="text/javascript">
  Downloadify.create('downloadify',{
    filename: function(){
      return document.getElementById('filename').value;
    },
    data: function(){ 
      return document.getElementById('data').value;
    },
    onComplete: function(){ 
      alert('Your File Has Been Saved!'); 
    },
    onCancel: function(){ 
      alert('You have cancelled the saving of this file.');
    },
    onError: function(){ 
      alert('You must put something in the File Contents or there will be nothing to save!'); 
    },
    transparent: false,
    swf: 'media/downloadify.swf',
    downloadImage: 'images/download.png',
    width: 100,
    height: 30,
    transparent: true,
    append: false
  });
</script> 
```

可以在这里找到：http: [//pixelgraphics.us/downloadify/test.html](http://pixelgraphics.us/downloadify/test.html)

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:32:13.080

You could just specify any id.

```
Downloadify.create( id_or_DOM_element, options ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-08T11:50:30.597

最好的解决方案是“setlio”所说的您将按钮图像设置为透明图像并将您想要的文本或图片放在它下面

# java - 使用 Java Vector 类检查空元素

> ID：12031967
> 
> 赞同：0
> 
> 时间：2012-08-20T03:26:59.963
> 
> 标签：java, vector, null

我正在构建一个堆数据结构，但让我发疯的部分是检查空子值。

我正在使用向量，并且正在将父母与孩子进行比较，但是如果只有一个孩子，则程序会崩溃，因为类似

```
vectorObject.get(i) //i'th element doesn't exist 
```

将返回异常。

我不能用类似的东西检查空元素

```
if (vectorObject.get(i) == null) 
```

因为运行 get() 方法会自动中断程序，所以你如何在没有一些不可读的奇怪黑客攻击的情况下实际检查不存在的元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:59:55.120

你似乎很困惑。我认为您需要重新阅读用于设计堆数据结构的任何参考资料（或阅读[维基百科文章的相关部分](http://en.wikipedia.org/wiki/Binary_heap#Heap_implementation)）。

如果你的父母在，`0`那么你的孩子在`2*(0)+1=1`和`2*(0)+2=2`。在这种情况下，`1 < vectorObject.size()`将为真但`2 < vectorObject.size()`为假，表示有左孩子但没有右孩子。

由于`Vector`（或者`ArrayList`如果您已按照我的建议切换）是从零开始的，您需要检查 if `i < vectorObject.size()`， not `i <= vectorObject.size()`。如果`i < vectorObject.size()`then`i`是合法索引。

***更新：***

有两种方法可以在这里构建逻辑。如果您必须以与二孩情况完全不同的方式处理独生子女案件，那么这可能效果最好：

```
int size = vectorObject.size();
if (2*i+2 < size) { /* Two-child case */ }
else if (2*i+1 < size) { /* One-child case */ }
else { /* No children case */ } 
```

如果您分别处理两个节点，那么嵌套可能会更好：

```
int size = vectorObject.size();
if (2*i+1 < size) {
  // Handle left child
  if (2*i+2 < size) {
    // Handle right child
  }
  else {
    // No right child
  }
}
else { /* No children */ } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T16:29:26.880

尝试/捕捉：

```
try{

yourVector.get(int theElementYouWant);

}

catch(NullPointerException){

//well, I guess that element was null!

} 
```

# ios - 尝试在模态视图中使用 MFMailComposeViewController

> ID：12031970
> 
> 赞同：1
> 
> 时间：2012-08-20T03:27:23.147
> 
> 标签：ios, modalviewcontroller, mfmailcomposeviewcontroller

我已经从基于地图的应用程序中成功实现了一个模态视图控制器，它使用部分卷曲过渡在地图下方显示了一个选项面板。

从这里，我想实现一个按钮，允许用户使用 MFMailComposeViewControl 通过电子邮件与我联系。我已经实现了下面的代码，但是每次我点击按钮并调用 presentModalView 时应用程序都会崩溃。

我知道这个问题一定与试图在另一个之上调用模态视图有关，但我似乎不知道如何解决。

**这是崩溃消息：**

> ***断言失败 -[UIWindowController transition:fromViewController:toViewController:target:didEndSelector:], /SourceCache/UIKit_Sim/UIKit-1914.84/UIWindowController.m:188

```
- (IBAction)sendSupportMail:(id)sender{

    // log this in the debugger 
    NSLog(@"You hit the send support mail button.");

    // dismiss the page curled options view
    [self dismissModalViewControllerAnimated:YES];    

    // check to see if email is available; if so, compose message
    if ([MFMailComposeViewController canSendMail])
    {
        MFMailComposeViewController *mailer = [[MFMailComposeViewController alloc] init];

        mailer.mailComposeDelegate = self;

        [mailer setSubject:@"Subject here"];

        NSArray *toRecipients = [NSArray arrayWithObjects:@"first@mail.com", @"second@mail.com", nil];
        [mailer setToRecipients:toRecipients];

        NSString *emailBody = @"Body Copy";
        [mailer setMessageBody:emailBody isHTML:NO];

         [self presentModalViewController:mailer animated:YES];
        NSLog(@"Present Mailer Called");

        [mailer release];
    }
    else
    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Failure"
                                                        message:@"Your device doesn't support the composer sheet"
                                                       delegate:nil
                                              cancelButtonTitle:@"OK"
                                              otherButtonTitles: nil];
        [alert show];
        [alert release];
    }

} 
```

# qt - 有没有办法在 Qt Creator 中更新 Qt 组件？

> ID：12031971
> 
> 赞同：0
> 
> 时间：2012-08-20T03:27:24.040
> 
> 标签：qt, qt-creator

我正在为 Meego 开发应用程序。Qt Creator 附带的 Qt 组件有一些错误，它们显然已在 Gitorious 的最新版本中修复。所以我想更新我的本地库并获得这些新功能和修复。SDK 维护工具无法做到这一点。有没有办法更新组件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T09:33:12.533

如果你在你的机器上下载并构建它们，然后进入设置，你可以指定你想使用哪个版本的 QMake，然后拉入相关的库和包含它，这样你就可以跳转到最新版本。

# java - 为什么弹簧三元表达式得到反转的结果？

> ID：12031973
> 
> 赞同：0
> 
> 时间：2012-08-20T03:27:34.287
> 
> 标签：java, spring, ternary-operator

我正在通过 Spring in Action 第 3 版这本书学习 Spring。

我正在阅读关于 SpEL 中的三元表达式的部分：

它写道：

> 如果您希望 SpEL 表达式在条件为真时计算为一个值，否则为不同的值怎么办？例如，假设如果歌曲是“铃儿响叮当”，卡尔（前面的乐器演奏家）想弹钢琴，否则他会弹萨克斯管。在这种情况下，您可以使用 SpEL 的三元 (?:) 运算符：

```
 <property name="instrument"
 value="#{songSelector.selectSong()=='Jingle Bells'?piano:saxophone}"/> 
```

> 如您所见，SpEL 的三元运算符的工作方式与 Java 的三元运算符相同。在这种情况下，如果所选歌曲是“Jingle Bells”，则乐器属性将与钢琴豆的参考相关联。否则，它将与 IDis 萨克斯管的 bean 连接。

我使用以下 xml 实现它：

```
<bean id="kenny"
        class="com.springinaction.springidol.Instrumentalist"
        p:song="Jingle Bells">
        <property name="instrument"
            value="#{kenny.song == 'Jingle Bells' ? piano:saxophone}"/>

    </bean>

<bean id="piano"
        class="com.springinaction.springidol.Piano" />
    <bean id="saxophone"
        class="com.springinaction.springidol.Saxophone" /> 
```

输出：

> 演奏铃儿响叮当：嘟嘟嘟

这是不正确的，应该是：

> 演奏铃儿响叮当：PLINK PLINK PINK

我检查了测试是否使用了正确的 xml 并获得了正确的 bean，并且仪器的声音是正确的。（TOOT TOOT TOOT 用于萨克斯管，PLINK PLINK PINK 用于钢琴）

任何想法？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T14:50:29.477

我的猜测是您正在尝试引用尚未设置的属性。即使它是在 XML 中的三元表达式中的引用“之前”设置的，但很可能在评估 SpEL 表达式时，该属性尚未设置。例如，请参阅[Spring setter order 上的这个问题](https://stackoverflow.com/questions/5139301/spring-setter-method-order)。

如果`instrument`在设置之前`song`设置，则您看到的行为是有意义的。

（您可以将日志语句添加到您的设置器以确定经验调用顺序。）

# ios - IOS API to adjust volume of right left stereo channel

> ID：12031975
> 
> 赞同：3
> 
> 时间：2012-08-20T03:28:05.877
> 
> 标签：ios

My iOS app needs to play a video file and adjust the volume of the left and right stereo channels.

How can this be accomplished?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T22:23:58.837

如果您可以将音频与视频分开，您可以使用 AudioUnit 或 AudioQueues 播放音频并修改左/右声道的样本幅度。

但是，这有一些陷阱，将音频与视频同步，如果您允许用户使用控件等在视频中来回跳转，则处理（重新）同步音频。

# asp.net - How to best implement and structure a view in an ASP.NET MVC app to have better caching across page loads?

> ID：12031982
> 
> 赞同：3
> 
> 时间：2012-08-20T03:28:44.907
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, razor

I have a web app with several pages that functions as a data administration console. You can lookup data against our DB, create new entities, edit, delete, etc. It is created in ASP.NET MVC 3 with Razor.

I'm having trouble with my form post data being "lost" (not applied) between visits to the same view.

## Background

The site structure is fairly typical with several views -- one for home, then one for each of the different entities (let's call them Parent, Child)

*   The Home view as a search field were you can search for Parent elements. When you submit the search, the parent entities that match are shown in an HTML table.

![enter image description here](../Images/a9ac241110fb47f84a466a0edee4ed4a.png)

*   In the HTML table, there is actions next to each Parent row, to edit it, or show the children. If you click on `Show Children`, it does another form post to show the children for that parent row. E.g:

![enter image description here](../Images/fa247ccf1048cfb43064ff88dafe2bbc.png)

At first, I tried using multiple forms on the Home view: one for `search`, one for the each of the rows in the `parent` table, and one for each row in the `children` table. However, this caused problems with caching -- when I chose to edit one of the rows (going to the corresponding view to do that), when I got sent back to the Home view, the previous search wasn't still applied so I had to restart my search. I found that if I kept a single form for the entire page, caching worked properly, so as I dived in and out editing entities caching seemed to work (and improved overall usability).

So the code I have is roughly the following (I've edited it a lot to simplify it for this question):

```
@using (Html.BeginForm("Index", "Home", FormMethod.Post ))
{
  <div>
    @Html.TextBoxFor(m => m.SearchTerm )
    <input type="submit" name="SearchSubmit" value="Search" />
  </div>
  <h2>Parents</h2>
  <div>
    @{
      var parents = Tool.Models.ToolsModelService.SearchParents(Model.SearchTerm);
    }
  </div>
  <div>
    <table>
        <thead>
           <tr>
             <th>Parent ID</th>
             <th>Attribute 1</th>
             <th>Attribute 2</th>
             <th>Actions</th>
           </tr>
        </thead>
        <tbody>
          @foreach (var p in parents)
          {
            <tr>
               <td>@p.ID</td>
               <td>@p.Name</td>
               <td>@p.Attrib1</td>
               <td>@p.Attrib2</td>
               <td>
                 <input type="hidden" name="SelectedParent" value="@p.ID.ToString()" />
                 <input type="submit" name="ParentSubmit" value="Edit" />
                 <input type="submit" name="ChildrenSubmit" value="Show Children" />
               </td>
            </tr>
           }
        </tbody>
     </table>
  </div>
  <div>
    <button type="submit" name="ParentSubmit" value="Add">Add New Parent</button>
  </div>
  @if (Model.SelectedParent != null)
  {
    var children = Tool.Models.ToolModelService.GetChildren(Model.SelectedParent);
    if (children != null && children.Count > 0)
    {
      <h2>Children</h2>
      <div>
        <table>
          <thead>
            <tr>
              <th>Child ID</th>
              <th>Name</th>
              <th>Action</th>
             </tr>
           </thead>
           <tbody>
           @foreach (var c in children)
           {
             <tr>
               <td>@c.ID</td>
               <td>@c.Name</td>
               <td>
               @using (Html.BeginForm("Index", "Home", FormMethod.Post))
               {
                  <input type="hidden" name="SelectedChild" value="@c.ID.ToString()" />
                  <input type="submit" name="ChildrenSubmit" value="Edit" />
               }
               </td>    
             </tr>
           }
           </tbody>
         </table>
       </div>
       <div>
         <input type="submit" name="MenuItemSubmit" value="Add">Add new child</button>
       </div>
    }
  }
  else
  {
    <h2>Children</h2>
    <div>
      <p>Select a parent to show children for<p>
    </div>
  } 
```

In the `HomeController.cs`, there is a bunch of code. Here is some of the form handling:

```
...

[Authorize]
public ActionResult Index(HomeModel model)
{
    model = new HomeModel();
    this.LoadState(model);
    return View(model);
}

[ActionName("Index")]
[AcceptVerbs(HttpVerbs.Post)]
[AcceptParameter(Name = "SearchSubmit", Value = "Search")]
public ActionResult Register_Search(HomeModel model)
{
    ActionResult action;
    this.CacheState(model);
    action = this.View(model);
    return action;
}

[ActionName("Index")]
[AcceptVerbs(HttpVerbs.Post)]
[AcceptParameter(Name = "ParentSubmit", Value = "Add")]
public ActionResult Register_ParentAdd(HomeModel model)
{
    this.CacheState(model);
    return this.RedirectToAction("Index", "Parent");
}

...

private void CacheState(HomeModel model)
{
    this.Session[CachedModelKey] = model;
}

private void LoadState(HomeModel model)
{
   if (null != this.Session[CachedModelKey])
   {
       var cachedModel = (HomeModel)this.Session[CachedModelKey];
       model.SearchTerm = cachedModel.SearchTerm;
       model.SelectedRestaurant = cachedModel.SelectedParent;
       model.SelectedMenuItem = cachedModel.SelectedChild;
   }
} 
```

## Problems

I'm having various problems, and I'm positive it's due to me being very new to ASP.NET MVC and how to properly set everything up in my code.

1.  The `parents` table form doesn't work correctly. If I click on `Show children` for anything row, it always shows the children for the first row.

2.  If I search for Parent1, chose it's children, then edit one of the child items (which is on a separate view). I eventually get sent back to the Home view, but the search is no longer applied -- this is what I mean by "caching"; my form post values aren't being persisted across reloads of the view in all cases.

I have to search again for `parent1` which slows the workflow down. I really want to persist the searches so I don't have re-search to bring up the same child list (makes it simpler to keep editing multiple children for same parent)

I'm sure I'm missing something here really straightforward, so would appreciate some help that would solve the above problems, but also any advice on better ways to structure things. If I'm missing any info, let me know and I'll add it.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T11:48:49.003

处理此类页面的一个好方法是使用[Backbone.js](http://backbonejs.org/) 在 Backbone 中，您可以设置绑定到 html 模板的客户端视图。您将模型数据加载到模板中，然后渲染视图。

您可以在主干视图中连接事件，这些事件可以监听主干模型上的更改，然后渲染显示更改的适当视图。

Backbone 有一个学习曲线，但如果你从一个预先构建的示例开始，你就会掌握它的窍门。绝对值得学习，因为它非常适合您的页面。

Rob Conery 在这里做了一个很好的例子...... [http://wekeroad.com/2011/08/11/the-backbonejs-todo-list-sample-refactored-part-1/](http://wekeroad.com/2011/08/11/the-backbonejs-todo-list-sample-refactored-part-1/)

缓存明智我会让您的视图模型对象可序列化，然后使用 System.Runtime.Caching.MemoryCache 针对从您的搜索参数构造的键缓存对象。这将避免不必要的数据库访问。

# facebook-graph-api - Do I need to do something specific if I want my Facebook app to auto-publish on a user stream after the user install/allow the app?

> ID：12031987
> 
> 赞同：0
> 
> 时间：2012-08-20T03:29:17.127
> 
> 标签：facebook-graph-api, facebook-apps

I am wondering if I need to do something in particular if I want my facebook app to auto-publish on a user wall after the user install/allow the app?

Does facebook app auto-publish automatically when someone install/allow?

thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T08:15:10.000

只要您在应用程序设置中激活了“社交发现”，它就会在 Facebook 认为合适时自动发生 - AFAIK 这意味着在这些提要之前，您的应用程序必须拥有稳固的用户群故事开始向新用户展示。

# sql-server - SQL 中的 If、Else 或 Case 语句

> ID：12031989
> 
> 赞同：1
> 
> 时间：2012-08-20T03:29:29.823
> 
> 标签：sql-server, tsql

只有当值大于零时，我才想取行的平均值。但是，我收到以下错误：

> *'列 'Daily.Rad' 在选择列表中无效，因为它不包含在聚合函数或 GROUP BY 中...'*

代码：

```
SELECT Date,
       AVG([Speed]) as [Speed], 

       CASE WHEN [Rad] > 0.0
            THEN AVG([Rad])
            ELSE 0.0
       END AS [Rad], 

       AVG([Pressure]) as [Pressure], 

       FROM Daily 
WHERE MONTH(Date) = MONTH('08/31/2011')  
GROUP BY Date 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:49:09.410

您需要将 CASE 子句放在 AVG 函数中。

```
SELECT Date,
       AVG([Speed]) as [Speed], 
       AVG (
       CASE WHEN [Rad] > 0.0
            THEN [Rad]
            ELSE 0.0
       END) AS [Rad], 

       AVG([Pressure]) as [Pressure], 
        Date
       FROM Daily 
WHERE MONTH(Date) = MONTH('08/31/2011')  
GROUP BY Date 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T06:01:49.250

如果您想要`Rad`所有行的平均值，而忽略负值，其他人已经给出了正确的答案。相反，如果您只需要正值的`Rad`平均值，那么您必须自己计算：

```
SELECT Date,
       AVG([Speed]) as [Speed], 

       SUM(CASE WHEN Rad>0.0 THEN Rad ELSE 0.0 END)
       /SUM(CASE WHEN Rad>0.0 THEN 1 ELSE 0 END) as Rad,

       AVG([Pressure]) as [Pressure], 

       FROM Daily 
WHERE MONTH(Date) = MONTH('08/31/2011')  
GROUP BY Date 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T03:48:35.490

如果您试图从平均值中排除负 Rad 值，那么我认为您想要的是：

```
SELECT Date,
AVG([Speed]) as [Speed], 

AVG(CASE WHEN [Rad] > 0.0
         THEN [Rad]
         ELSE 0.0
END) AS [Rad], 

AVG([Pressure]) as [Pressure] 

FROM Daily 
WHERE MONTH(Date) = MONTH('08/31/2011')  
GROUP BY Date 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T08:24:48.383

这将消除负值并平均其余值。此外，where 子句将导致更好的性能。

```
SELECT Date,
       AVG([Speed]) as [Speed], 

       coalesce(nullif( abs([Rad]), -[Rad]), 0) AS [Rad], 
       -- OR
       coalesce(AVG(CASE WHEN [Rad] > 0 THEN [Rad] END), 0) [Rad]

       AVG([Pressure]) as [Pressure], 

       FROM Daily 
WHERE Date >= dateadd(month, datediff(month,  0, '2011-08-31'), 0)
  AND Date <  dateadd(month, datediff(month, -1, '2011-08-31'), 0)
GROUP BY Date 
```

# git - Heroku 中的 Node.js 应用程序在 Foreman 上工作，但在部署时不工作？

> ID：12031990
> 
> 赞同：2
> 
> 时间：2012-08-20T03:29:39.087
> 
> 标签：git, node.js, heroku, foreman

我成功地让我的应用程序在工头上运行得很好，但是一旦我将它部署到 Heroku，它就会在日志中抛出一个错误：

```
2012-08-20T03:22:48+00:00 heroku[web.1]: Starting process with command `node index.js`
2012-08-20T03:22:49+00:00 app[web.1]: Server has started.
2012-08-20T03:22:49+00:00 heroku[web.1]: Error R11 (Bad bind) -> Process bound to port 15134, should be 52717 (see environment variable PORT)
2012-08-20T03:22:49+00:00 heroku[web.1]: Stopping process with SIGKILL
2012-08-20T03:22:51+00:00 heroku[web.1]: Process exited with status 137
2012-08-20T03:22:51+00:00 heroku[web.1]: State changed from starting to crashed 
```

我试图更改它绑定到的端口，但每次我这样做时都会再次更改端口。我的应用程序中还有其他问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T06:20:32.483

在 Heroku 上，您需要使用环境变量中包含的端口：process.env.PORT

# c# - C# 我需要一个像 DataGridView 一样工作但允许我添加自定义控件的控件

> ID：12031992
> 
> 赞同：1
> 
> 时间：2012-08-20T03:29:57.857
> 
> 标签：c#, datagrid, custom-controls

我有一个应用程序需要在网格中显示 1 到 N 个自定义控件（每行一个控件）并允许用户一次选择一行。

我尝试使用 DataGridView，但它只允许文本、按钮、复选框、组合框、图像和链接。

是否有类似于 DataGridView 的控件允许我插入任意自定义控件？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T03:35:50.223

您可以`custom column`通过扩展`DataGridViewColumn`和`DataGridViewCell`类来创建一个。查看 MSDN 文章 - [How to: Host Controls in Windows Forms DataGridView Cells。](http://msdn.microsoft.com/en-us/library/7tas5c80%28VS.80%29.aspx)

# asp.net - After validating successfully, how to modify input for smarter displaying

> ID：12031998
> 
> 赞同：0
> 
> 时间：2012-08-20T03:31:11.810
> 
> 标签：asp.net, asp.net-webcontrol

My case is that I have a textbox for Age input. I use RegularExpressionValidator control to validate the input, like this:

```
<asp:RegularExpressionValidator ... ValidationExpression="\s*\d+\s*" ... /> 
```

The validation accepts digit inputs which maybe include whitespaces on the beginning or at the end of numbers. So if one user types " 32 " into the textbox, the input is legal. But afterwards I want the text box shows the better form, "32" - throw away all whitespaces.

I know it is possible to process by javascript, however is there a shorter way? or another more powerful validator control?

# java - What is a valid use case for proxying a Spring-based controller?

> ID：12031999
> 
> 赞同：1
> 
> 时间：2012-08-20T03:31:51.553
> 
> 标签：java, spring, spring-mvc, proxy

I was looking at Spring MVC's documentation and I saw a mention about if your controller implemented an interface and was proxied you'd have to put the annotations on your interface or proxy by target class since otherwise the annotations wouldn't be picked up (the proxy wouldn't contain the annotations since it would be another class wrapping your bean via the exposed interface if it wasn't a subclass of the controller class).

However, in my experience controllers are supposed to be the simplest things out there - get the web-based inputs (formatting/creating the "model"), decide on the flow control to execute by delegating to business service layer interfaces/classes (controlling based on the state of the model), and then sending the model to the view layer to compose the resulting view.

Can anyone provide a really good use case of why you'd want to proxy a controller? Service layer methods, sure, but a controller?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T21:17:41.397

您代理控制器的原因是执行[Proxy AOP](http://static.springsource.org/spring/docs/3.0.x/reference/aop.html)。

代理 AOP 过去仅适用于仅代理接口的[动态代理。](http://docs.oracle.com/javase/1.4.2/docs/guide/reflection/proxy.html)但是我认为 Spring 现在支持 CGLIB 代理。

就我个人而言，我通过使用 Spring 也支持的真实编译时 AspectJ 完全避免了基于代理的 AOP。

为什么要对控制器进行 AOP？为了避免样板代码，例如：安全性、输入清理、日志记录（所有这些我都在我的请求控制器上执行）。

**编辑：昨晚我打算增加这个答案，因为我知道你会有后续行动。**

是的，**今天**有请求，您可以使用 servlet 过滤器和拦截器执行大量 AOP，并且我确实在过滤器中拥有大部分横切代码，但与今天的 3.0 相比，当 Spring 首次引入其[AnnotationMethodHandler（~2.5）时，情况并非如此](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/web/servlet/mvc/annotation/AnnotationMethodHandlerAdapter.html)[AnnotationMethodHandler > 3.0](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/web/servlet/mvc/annotation/AnnotationMethodHandlerAdapter.html)（请注意通过设置器添加的过多策略组件）。

您可能想要使用 AOP 的一个真实的*当前*`@PreAuthorize`示例是在您的请求控制器中使用 Springs 安全注释（即），而不必在 XML 文件中放置一个拦截器（参见[这个问题和我的答案](https://stackoverflow.com/questions/10191232/i-dont-know-what-securitycontextholder-strategy-to-use/10194519#10194519)）。或者您可能不需要服务层并且想要使用`@Transaction`.

我在控制器中使用 AOP 的另一个原因是它更具声明性，并且在我直接对方法调用进行单元测试时会起作用（当然我不使用代理，而是使用 AspectJ）。[事实上，我使用类似于 Python 的装饰器的 AspectJ](http://adamgent.com/post/5479576926/the-python-decorator-pattern-for-java-using-aspectj)来声明性地包装带有样板代码的方法。过滤器不知道您注释了什么，因此您无法在此处执行此逻辑。

最后，有些人认为，对于小型 Web 应用程序或仅 REST 应用程序，额外的服务层被高估了，并且活动记录/DAO 加上控制器就足够了（参见 Spring Roo ......它最近才添加了一个服务层）。在这种情况下，如前所述，您通常需要`@Transaction`控制器中的支持。

否则，现代 Java（和/或 AspectJ）确实没有一个好的用例。恕我直言，我不再使用动态代理了。