# StackOverflow 问答 000417000-000417999

# asp.net-mvc - ASP.NET MVC - 将多个查询字符串参数映射到漂亮的 url

> ID：417000
> 
> 赞同：7
> 
> 时间：2009-01-06T15:39:16.283
> 
> 标签：asp.net-mvc, seo, query-string

我对 mvc 的 seo 友好 url 的设计有点卡住了……以以下 url 为例： [http://myapp/venues/resturants.aspx?location=central&orderBy=top-rated](http://myapp/venues/resturants.aspx?location=central&orderBy=top-rated)

使用我的 mvc 应用程序，我将其映射如下： [http://myapp/venues/list/resturants/central/top-rated](http://myapp/venues/list/resturants/central/top-rated)
{controller}/{action}/{category}/{location}/{order}

现在唯一的问题是位置和顺序是可选的......所以应该可以提交如下请求：[http://myapp/venues/list/resturants/top-rated](http://myapp/venues/list/resturants/top-rated)。当请求命中控制器动作时，这被证明是一个问题，位置参数自然而然地获得了“最高评价”。

有什么建议么？我正在考虑使用显式查询字符串来处理多个参数，但这确实是我最后的选择，因为我不想过多地牺牲 SEO。

有没有人遇到过这样的困境？你是怎么处理的？

提前致谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-06T16:18:23.943

单击您的[个人资料链接](https://stackoverflow.com/users/52065/wololo)并查看 Stats、Recent、Response 等的 URL。

例子：

*   [https://stackoverflow.com/users/52065?sort=recent#sort-top](https://stackoverflow.com/users/52065?sort=recent#sort-top)
*   [https://stackoverflow.com/users/52065?sort=stats#sort-top](https://stackoverflow.com/users/52065?sort=stats#sort-top)

没有排序它默认为 stats

*   [https://stackoverflow.com/users/52065](https://stackoverflow.com/users/52065)

**可选参数应该是查询参数**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T15:51:55.010

如果您有多个可选参数，您将始终遇到此问题。要么将它们中的一个或两个设为非可选（并且在查询字符串中的位置比可选的更早），要么使用查询字符串参数表示法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T16:36:22.520

假设 location 和 order 的允许值是唯一的（即当它们进入时，您可以将它们区分开来，或者如果它们只提供一个，您如何知道它是 location 还是 order？），那么您可以只取两个参数并计算出它们在控制器中的内容。

路线：`{controller}/{action}/{param1}/{param2}`

控制器动作：

```
public ActionResult MyAction(string param1, string param2)
{
    string location;
    string order;
    if (!ParseLocation(param1, out location))
    { ParseLocation(param2, out location); }
    // ...
} 
```

不是特别优雅，但确实让您拥有所需的 URL。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T13:40:40.720

好吧，伙计们刚刚发布了一个我迄今为止一直在玩的解决方案。

我使用约束设置了我的路线，如下所示：

```
 routes.MapRoute(
            "VenuesList",                                              
            "venues/list/{category}/{location}/{orderBy}",             
            new { controller = "venues", action = "list", category = "", location = "", orderBy = "" },
            new { location = "central|east|west|south", orderBy = "top-rated|price" }
        );

    routes.MapRoute(
            "VenuesListByLocation",                                              
            "venues/list/{category}/{location}",                           
            new { controller = "venues", action = "list", category = "", location = "" },
            new { location = "central|east|west|south" }
        );

        routes.MapRoute(
            "VenuesListByOrder",                                              
            "venues/list/{category}/{orderBy}",                           
            new { controller = "venues", action = "list", category = "", orderBy = "" },
            new { orderBy = "top-rated|price" }
        );

        routes.MapRoute(
            "VenuesListDefault",                                              
            "venues/list/{category}",                           
            new { controller = "venues", action = "list", category = "" }

        );

        routes.MapRoute(
            "Default",                                              
            "{controller}/{action}/{id}",                           
            new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
        ); 
```

这个想法是，如果验证失败，它将转到列表中的下一个路由......最终达到默认值。

需要更多测试，但到目前为止运行良好......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T15:47:03.477

为什么不在页面中为每个可能的查询字符串参数创建一个属性？

这样，您只需几行代码就可以以任何方式处理它......

# c# - c#可以用于手机和pc的通信吗？

> ID：417003
> 
> 赞同：0
> 
> 时间：2009-01-06T15:40:45.843
> 
> 标签：c#, mobile

作为我学位的一个小项目，我想交流手机和电脑。我有兴趣通过蓝牙交流是否可以在 c# 中这样做？如果可能，请提供我需要的应用程序或硬件列表。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T22:24:21.787

是的，如果它与 Windows 手机或带蓝牙的袖珍电脑一起使用，则可能。您需要一台支持蓝牙的电脑和手机。对于开发人员，您需要下载[windows mobile 6 sdk](http://www.microsoft.com/downloads/details.aspx?familyid=06111A3A-A651-4745-88EF-3D48091A390B&displaylang=en)。

然后开发桌面应用程序和手机应用程序之间的通信，可以使用[32feet.Net](http://inthehand.com/content/32feet.aspx)是开源的。

当您下载并安装它（以及它解压缩到程序文件夹）时，您将拥有您在 Visual Studio 中引用的 dll。您还将获得一些示例应用程序。其中之一是适用于台式机、掌上电脑和智能手机的蓝牙聊天。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T15:48:19.573

如果（如果基于您的问题中缺少信息，这是一个很大的问题）您的意思是“我如何使用 C# 在我的 PC 上编写一个应用程序，它可以与通过[ActiveSync](http://www.microsoft.com/windowsmobile/en-us/help/synchronize/activesync45.mspx)连接到我的 PC的[Windows Mobile](http://www.microsoft.com/windowsmobile/en-us/default.mspx)设备进行通信或[WMDC](http://www.microsoft.com/windowsmobile/en-us/help/synchronize/device-center.mspx) ”那么答案就是[RAPI](http://msdn.microsoft.com/en-us/library/aa458022.aspx)。这里有一个免费的开源托管包装[器](http://opennetcf.com/FreeSoftware/DesktopCommunication/tabid/90/Default.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T09:47:44.300

您可以使用的另一个选项是设置一个 Web 服务，它充当设备和您的机器之间的中介。这样做的一个巨大好处是，您不再受蓝牙距离要求的约束。

当然，如果您正在尝试构建某种接近服务（当项目 x 距离项目 y 3 米时执行 z），那么蓝牙可能是要走的路。

# winapi - 窗口标题中的 Unicode 字符

> ID：417004
> 
> 赞同：2
> 
> 时间：2009-01-06T15:40:48.700
> 
> 标签：winapi, unicode, localization, internationalization

我们在使用西里尔文或日文字符设置窗口标题时遇到问题。我们要么看到问号，要么看到随机垃圾，但看不到我们想要的文本。我们尝试过使用不同的编码，SetWindowText()、SetWindowTextW()、SetWindowTextA() 等等。我们甚至无法通过将字符串文字传递给 SetWindowText() 来使其工作。

我们的 Windows 安装似乎拥有它需要的一切——例如，Internet Explorer 和 Firefox 确实可以正确显示西里尔文和日文字幕。所以我很确定我们没有找到正确的编码/方法组合。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T14:03:26.773

您遇到的问题（猜测）是您的应用程序的顶级框架窗口是一个 ANSI 窗口。在后台，当您创建一个窗口（使用 CreateWindow() 或 CreateWindowEx()）时，必须提供一个窗口类。该窗口类确定窗口的属性，包括默认情况下是否接受 ANSI 消息或 Unicode 消息。反过来，这取决于您（或您的框架）是否通过调用 RegisterClassExA() 或 RegisterClassExW() 注册窗口类。

几乎可以肯定的是，您的顶级窗口类正在使用 RegisterClassExA() 注册。这意味着窗口的默认窗口过程将在处理消息之前将消息中的所有 Unicode 字符串转换为 ANSI，因此到处都是问号和奇数字符。

最简单的解决方案就是让您的应用程序始终使用 Unicode（通常通过定义 _UNICODE 来完成）。另一种方法是找出 RegisterClassEx() 被调用的位置，并将其设为 RegisterClassExW()。这可能会导致其他消息出现 ANSI/Unicode 问题，但它应该（至少在理论上）可以工作。当然，如果这是一个问题，任何一种方式都会破坏 Windows 9X。

如果所有这些听起来都非常复杂，那你没有错……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T17:28:07.080

您必须使用定义的 _UNICODE 编译您的应用程序。否则，所有窗口仍将是 MBCS 而不是 utf-16，因此如果代码页不匹配，则无法显示西里尔文或日文字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T17:28:20.200

`SetWindowText()`? 您是否将应用程序编译为 Unicode？如果不是，则 SetWindowText() 等效于`SetWindowTextA()`，而后者又受限于您当前的系统区域设置（又名“非 Unicode 应用程序的语言”）。

另外，您是如何*创建*窗口的？使用明确的 Unicode 感知 API，例如`CreateWindowExW()`？如果不是，请确保您的程序被编译为 Unicode。

如果您的程序未编译为 Unicode，您可能需要在 CP/Regional Options 中修改“非 Unicode 应用程序的语言”。需要重新启动。或者更简单：使用[MS AppLocale](http://www.microsoft.com/globaldev/tools/apploc.mspx)模拟西里尔系统语言环境

# .net - 我可以在“Delphi 2007 for Win32”中使用 .NET DLL 吗？

> ID：417010
> 
> 赞同：15
> 
> 时间：2009-01-06T15:41:59.383
> 
> 标签：.net, delphi, delphi-2007

是否可以在 Delphi 2007 中为 Win32 使用 .NET DLL？我尝试以与 ActiveX 组件相同的方式导入 DLL，但它似乎不起作用（组件菜单 -> 导入组件 -> 导入 .NET 程序集。

有可能吗？如果可以，步骤是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-06T17:17:38.317

如果您想要关于这样做的 Delphi 特定文章：

[Jim McKeeth 通过 COM 使用 .NET 程序集](http://dn.codegear.com/article/32754)

完成所有步骤后，这非常简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-16T15:31:00.643

Atozed Software 的 CrossTalk 允许在不使用 COM 的情况下使用 Delphi 的 .NET 程序集，无需 DLL 注册，并且可以使用原始程序集而无需修改。

[http://atozed.com/CrossTalk](http://atozed.com/CrossTalk)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T16:07:46.743

你当然可以。你只需要告诉它你的代码的哪些部分应该可以通过这种方式访问​​。您可以通过 ComVisibleAttribute 做到这一点。最快的解决方法是将 [assembly:ComVisible(True)] 放入您的 .dpk 中，从而使所有内容都公开可见。然后您可以使用您尝试导入程序集的方法。

您还可以进行非托管导出，这些导出可以像常规 dll 文件一样调用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-06T16:02:25.147

我认为你不能这样做，直接在同一个应用程序中混合托管和非托管代码。

然而，RemObjects 有一个名为[Hydra](http://www.remobjects.com/hydra.aspx)的框架，它允许您在同一个应用程序中使用 .Net 和 Win32。

# tfs - 如何通知 TFS 构建统计信息？

> ID：417014
> 
> 赞同：1
> 
> 时间：2009-01-06T15:42:50.427
> 
> 标签：tfs, continuous-integration, build-automation

我被告知 TFS 可以接受来自 3rd 方持续集成工具的构建/测试指标数据。有谁知道这是如何工作的或对我有任何好的链接？今天我的 google-fu 似乎很弱，我找不到任何关于此的信息。我们希望在构建结束时运行一个简短的 powershell 脚本或应用程序，并将所有已知指标发送到 TFS，以便它可以显示在某些报告中。我实际上想要（我认为）应该已经在 TFS BUild Server 的数据仓库中有空间的东西，但我将使用 CC.NET。我正在考虑构建名称、结果（通过/失败）、警告数、错误数、时间、单元测试运行、单元测试通过、代码覆盖率、FxCop 结果谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T19:02:01.197

恐怕还没有现成的集成可以做到这一点。[将CC.NET 链接到 TFS](http://www.codeplex.com/TFSCCNetPlugin)的插件可在[CodePlex](http://www.codeplex.com/TFSCCNetPlugin)上获得，但这只是让 CC.NET 使用 TFS 进行版本控制，并且不允许将构建结果发布回 TFS。

要将数据从 CruiseControl.NET 导入 TFS，您有几个选择。您可以编写自己的[自定义 TFS 数据仓库适配器](http://msdn.microsoft.com/en-us/library/bb130342.aspx)，它虽然复杂但最终很灵活，或者您可以结合使用[Team Build API](http://msdn.microsoft.com/en-us/library/cc339575.aspx)和一些 vodoo 将数据推送到 TFS 构建存储，该存储也将被推送到 TFS数据仓库。但是，这在 TFS2008 中会受到限制，因为您只能推送有关构建和单元测试的数据，而不能推送代码覆盖率之类的数据。

也就是说，将数据从 CC.NET 推送到 TFS 是我最初想做的事情。但是在 TFS2008 中，内置的构建系统非常好，以至于我从使用 CC.NET 触发构建切换到使用 TFS 触发和管理构建。这样做的好处是所有的统计数据都是自动处理的（以及 Visual Studio 中的内置 UI）。因为我转移到了 TFS2008，所以我失去了构建 CC.NET 的动力。

如果有人想为 CC.NET 集成贡献一个 TFS 构建结果发布功能，请随时[加入](http://www.codeplex.com/TFSCCNetPlugin)CodePlex 上的项目 - 我很乐意得到任何帮助。

# css - 是否有一种跨浏览器的方式来压缩页面上的文本？

> ID：417017
> 
> 赞同：6
> 
> 时间：2009-01-06T15:43:05.077
> 
> 标签：css, fonts

我正在寻找一种方法来压缩页面上相对较小的文本区域，以模仿使用非标准字体完成的图形按钮。理想情况下，只有字母会被压扁或变薄，单词之间的空间或多或少相同。我知道有一些 CSS 属性可以做这样的事情，但它们更关注字母之间的间距，而不是字母本身的宽度。这些 CSS 方法也不是很友好的跨浏览器。大多数用户群都在使用 IE6，因此对基于 CSS 的方法有很大的限制。

那么，有没有办法控制跨浏览器友好的字符宽度/间距？我知道 jQuery 可以很好地跨浏览器工作，那么这可以通过操纵字母的位置以及可能的宽度来使用 jQuery 来完成吗？这些是一小段文本，一次 5 个单词左右，所以速度是可以稍后处理的。

* * *

编辑：好的，所以，CSS letter-spacing 属性以及 word-spacing 属性将允许我控制字母/单词之间的空间。然而，这会让事情看起来很糟糕。如果这真的是唯一的选择，那么我将不得不让它发挥作用，但我真正想要的是一种压缩字母本身的方法，使字符更薄。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-06T15:47:26.347

也许

```
letter-spacing:-1px 
```

[会有所帮助](http://www.w3schools.com/css/pr_text_letter-spacing.asp)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-06T16:08:31.077

**简短的回答：**我认为没有一个可以满足您要求的跨浏览器示例。

CSS3 规范包含一个[`font-stretch`](http://www.w3.org/TR/css3-fonts/#font-stretch)属性，但遗憾的是，目前几乎没有（如果有的话）支持 CSS3。

我能想到的一些可以**模仿**这种行为的可能方法：

*   使用基于闪存的方法，例如[sIFR](http://www.mikeindustries.com/blog/sifr/)
*   使用基于 javascript/canvas 的方法，例如[Typeface.js](http://typeface.neocracy.org/)。[示例页面](http://typeface.neocracy.org/examples.html)上包含一个字体拉伸示例
*   使用压缩字体（icky-approach，因为这意味着您依赖于客户端可用的字体），例如 Arial Narrow。
*   使用从文本参数生成图像的服务器端脚本

简而言之，这个问题**没有简单而优雅的解决方案**，因为文本和图像操作通常是您在**图形编辑器**中执行的操作。

如果这是不可能的，我绝对建议您查看[Typeface](http://typeface.neocracy.org/)和[sIFR](http://www.mikeindustries.com/blog/sifr/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T16:04:03.597

我认为这种事情可能应该在图形编辑器中完成并输出到轻量级图像（png或类似）。我认为这是将文本的视觉输出控制到这种程度的唯一简单可靠的方法。

**确保在img**标记上重复**alt**属性中的文本以实现可访问性。

 **这种方法在本地化方面存在问题 - 因为您需要为每个区域设置一个版本 - 但这仍然是可行的。

如果您想将此文本与其他文本保持一致 - 例如在段落中间，也会出现问题。但如果这就是正在做的事情，听起来“压扁的文本”可能并不是一个好的 UI。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T16:14:16.010

那么，你想在不压扁它的情况下压扁它吗？

然后尝试调整字体大小。或者字母间距、字间距和字体大小的某种组合。（所有这些在 IE6 中都可以正常工作）。

```
.nav {font-size: 80%;
letter-spacing: -.05em;
word-spacing: .05em; } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T15:49:50.477

你确定你正确地指定了你的文档类型吗？也许您的浏览器正在以怪癖模式解释您的 CSS，从而导致不可预知的行为。

`letter-spacing`如果 jQuery不能正常工作，我认为 jQuery 不会对你有太大帮助。你不能改变单个字母的位置，除非每个字母都在它自己的元素中，比如 a `span`，这看起来很乱。

**编辑：**如果你想缩小字符本身的水平宽度，理论上可以使用`font-stretch: narrower`，例如。但似乎主要浏览器不正确或根本不支持它。显然它是在 CSS2 中，但后来在 CSS2.1 中下降，现在计划用于 CSS3。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T15:52:04.903

这听起来像是一场噩梦。

您可以通过将每个单词放入浮动 DIV 并摆弄每个 DIV 的宽度来捏造整个事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T16:05:45.107

我不得不质疑甚至首先尝试这样做的智慧。只需用可读的东西替换该死的图形；或者你可以用你的文本复制的东西。

您要做的是更改文本的字体。我认为您最好的选择是查看为您的用户群预装的一堆不同字体，并尝试获得最佳字体+大小组合。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T16:19:10.103

您可以使用[WhatTheFont追踪原始字体](http://www.myfonts.com/WhatTheFont/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-03-09T21:46:57.957

接近十年后，`font-stretch`仍然几乎不受支持。但 `transform:scaleX();`会做。[在这里](https://www.w3schools.com/cssref/playit.asp?filename=playcss_transform_scalex)。

# c# - 我可以从 SqlConnection 对象获取对挂起事务的引用吗？

> ID：417024
> 
> 赞同：40
> 
> 时间：2009-01-06T15:44:15.650
> 
> 标签：c#, .net, sql-server, transactions, ado.net

假设有人（除了我）编写以下代码并将其编译成程序集：

```
using (SqlConnection conn = new SqlConnection(connString)) 
{
    conn.Open();
    using (var transaction = conn.BeginTransaction())
    {
        /* Update something in the database */
        /* Then call any registered OnUpdate handlers */
        InvokeOnUpdate(conn);

        transaction.Commit();
    }
} 
```

对 InvokeOnUpdate(IDbConnection conn) 的调用调用了我可以实现和注册的事件处理程序。因此，在这个处理程序中，我将引用 IDbConnection 对象，但不会引用挂起的事务。有什么方法可以让我持有交易吗？在我的 OnUpdate 处理程序中，我想执行类似于以下内容的内容：

```
private void MyOnUpdateHandler(IDbConnection conn) 
{
    var cmd = conn.CreateCommand();
    cmd.CommandText = someSQLString;
    cmd.CommandType = CommandType.Text;

    cmd.ExecuteNonQuery();
} 
```

但是，对 cmd.ExecuteNonQuery() 的调用会引发 InvalidOperationException 抱怨

> “当分配给命令的连接处于挂起的本地事务中时，ExecuteNonQuery 要求命令具有事务。命令的事务属性尚未初始化”。

我可以以任何方式将我的 SqlCommand cmd 加入待处理的事务中吗？我可以从 IDbConnection 对象中检索对待处理事务的引用吗（如果需要，我很乐意使用反射）？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-05T14:56:37.260

如果有人对反射代码感兴趣来完成这个，这里是：

```
 private static readonly PropertyInfo ConnectionInfo = typeof(SqlConnection).GetProperty("InnerConnection", BindingFlags.NonPublic | BindingFlags.Instance);
    private static SqlTransaction GetTransaction(IDbConnection conn) {
        var internalConn = ConnectionInfo.GetValue(conn, null);
        var currentTransactionProperty = internalConn.GetType().GetProperty("CurrentTransaction", BindingFlags.NonPublic | BindingFlags.Instance);
        var currentTransaction = currentTransactionProperty.GetValue(internalConn, null);
        var realTransactionProperty = currentTransaction.GetType().GetProperty("Parent", BindingFlags.NonPublic | BindingFlags.Instance);
        var realTransaction = realTransactionProperty.GetValue(currentTransaction, null);
        return (SqlTransaction) realTransaction;
    } 
```

笔记：

*   类型是内部的，属性是私有的，所以你不能使用动态的
*   内部类型还阻止您像我对第一个 ConnectionInfo 所做的那样声明中间类型。必须在对象上使用 GetType

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-06T16:33:25.990

哇，我一开始是不相信的。我很惊讶`CreateCommand()`在使用本地 SQL Server 事务时没有给出它是事务的命令，并且事务没有在`SqlConnection`对象上公开。实际上在反映`SqlConnection`当前事务时甚至没有存储在该对象中。在下面的编辑中，我给了你一些提示，通过它们的一些内部类来追踪对象。

我知道您不能修改该方法，但您可以在方法栏周围使用 TransactionScope 吗？因此，如果您有：

```
public static void CallingFooBar()
{
   using (var ts=new TransactionScope())
   {
      var foo=new Foo();
      foo.Bar();
      ts.Complete();
   }
} 
```

这将起作用，我使用与您类似的代码进行了测试，一旦我添加了包装器，如果您当然可以这样做，一切都可以正常工作。正如所指出的，如果在其中打开了多个连接，`TransactionScope`您将升级到分布式事务，除非您的系统已为它们配置，否则您将收到错误消息。

在 DTC 中登记也比本地事务慢几倍。

# 编辑

如果你真的想尝试使用反射，SqlConnection 有一个 SqlInternalConnection，它又具有一个 AvailableInternalTransaction 属性，它返回一个 SqlInternalTransaction，它有一个 Parent 属性，它返回你需要的 SqlTransaction。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-22T12:36:03.380

对于任何对 Denis 在 VB.NET 中制作的装饰器类的 C# 版本感兴趣的人，这里是：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Data;

namespace DataAccessLayer
{
    /// <summary>
    /// Decorator for the connection class, exposing additional info like it's transaction.
    /// </summary>
    public class ConnectionWithExtraInfo : IDbConnection
    {
        private IDbConnection connection = null;
        private IDbTransaction transaction = null;

        public IDbConnection Connection
        {
            get { return connection; }
        }

        public IDbTransaction Transaction
        {
            get { return transaction; }
        }

        public ConnectionWithExtraInfo(IDbConnection connection)
        {
            this.connection = connection;
        }

        #region IDbConnection Members

        public IDbTransaction BeginTransaction(IsolationLevel il)
        {
            transaction = connection.BeginTransaction(il);
            return transaction;
        }

        public IDbTransaction BeginTransaction()
        {
            transaction = connection.BeginTransaction();
            return transaction;
        }

        public void ChangeDatabase(string databaseName)
        {
            connection.ChangeDatabase(databaseName);
        }

        public void Close()
        {
            connection.Close();
        }

        public string ConnectionString
        {
            get 
            {
                return connection.ConnectionString; 
            }
            set 
            {
                connection.ConnectionString = value;
            }
        }

        public int ConnectionTimeout
        {
            get { return connection.ConnectionTimeout; }
        }

        public IDbCommand CreateCommand()
        {
            return connection.CreateCommand();
        }

        public string Database
        {
            get { return connection.Database; }
        }

        public void Open()
        {
            connection.Open();
        }

        public ConnectionState State
        {
            get { return connection.State; }
        }

        #endregion

        #region IDisposable Members

        public void Dispose()
        {
            connection.Dispose();
        }

        #endregion
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-06T16:01:07.130

只能使用其构造函数之一为命令对象分配事务对象。您可以采用 .NET 2.0 方法并使用在`System.Transactions`命名空间中定义的 TransactionScope 对象（具有专用程序集）。

```
 using System.Transactions;

    class Foo
    {   
        void Bar()
        {
            using (TransactionScope scope = new TransactionScope())
            {
                // Data access
                // ...
                scope.Complete()
            }
        }
    } 
```

System.Transactions 方法与 SQL Server 2005 一起使用轻量级事务协调器 (LTM)。注意不要在事务范围内使用多个连接对象，否则事务将被提升，因为它被视为分布式。然后，DTC 将处理这个更占用资源的事务版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-20T14:54:45.860

我是简单的大支持者，那么如何在 IDBConnection（DELEGATE PATTERN）上编写一个包装器来公开事务。（对不起 VB.NET 代码，我现在正在用 VB.NET 编写此代码）像这样：

```
 Public class MyConnection
      Implements IDbConnection

      Private itsConnection as IDbConnection
      Private itsTransaction as IDbTransaction

      Public Sub New(ByVal conn as IDbConnection)
         itsConnection = conn
      End Sub

      //...  'All the implementations would look like
      Public Sub Dispose() Implements IDbConnection.Dispose
         itsConnection.Dispose()
      End Sub
      //...

      //     'Except BeginTransaction which would look like
       Public Overridable Function BeginTransaction() As IDbTransaction Implements IDbConnection.BeginTransaction
         itsTransaction = itsConnection.BeginTransaction()
         Return itsTransaction
       End Function  

      // 'Now you can create a property and use it everywhere without any hacks
       Public ReadOnly Property Transaction
          Get
              return itsTransaction
          End Get
       End Property

    End Class 
```

因此，您可以将其实例化为：

```
Dim myConn as new MyConnection(new SqlConnection(...)) 
```

然后您可以随时使用以下方式获取交易：

```
 myConn.Transaction 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2015-07-02T08:22:53.927

如果有人在 .Net 4.5 上遇到此问题，您可以在 .Net 4.5 中`Transaction.Current` 使用`System.Transactions`。

# sql - SQL Reporting Services: Why does my report shrink when it's emailed?

> ID：417032
> 
> 赞同：5
> 
> 时间：2009-01-06T15:46:10.467
> 
> 标签：sql, email, reporting-services

I created a simple report and uploaded it to my report server. It looks correct on the report server, but when I set up an email subscription, the report is much narrower than it is supposed to be.

Here is what the report looks like in the designer. It looks similar when I view it on the report server: [[http://img58.imageshack.us/img58/4893/designqj3.png]](http://img58.imageshack.us/img58/4893/designqj3.png])

Here is what the email looks like: [[http://img58.imageshack.us/img58/9297/emailmy8.png]](http://img58.imageshack.us/img58/9297/emailmy8.png])

Does anyone know why this is happening?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T22:14:48.093

This issue is fixed in SQL Server 2005 SP3 (it is part of cumulitive update package build 3161)

Problem issue described below.

[http://support.microsoft.com/kb/935399](http://support.microsoft.com/kb/935399)

Basically Full Outlook 2007 Client Uses MS Word HTML Rendering Engine (Which Makes Web Archive Report Looked Jacked Up). NOTE: Web Outlook 2007 Client Uses IE HTML Rendering Engine (Which makes Web Archive Report Look Okay).

We have installed the patch on DB housing Reporting Services and it does fix the issue. Emails look all nice and fancy now.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-08T13:39:29.813

I notice that the screenshots show Outlook 2007\. Perhaps you're not aware that Microsoft somewhat hobbled the HTML capabilities of Outlook in 2007, and now it uses the Word HTML engine, and not the more advanced Internet Explorer one? Might this explain the lacklustre appearance?

[http://www.sitepoint.com/blogs/2007/01/10/microsoft-breaks-html-email-rendering-in-outlook/](http://www.sitepoint.com/blogs/2007/01/10/microsoft-breaks-html-email-rendering-in-outlook/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-22T02:07:35.330

> I got around this problem by doing the following:
> 
> 1.  Add a Page Header to the report
> 2.  Add a line to the page header. Set the width of the line to the desired page width.
> 3.  Set the line colour to white (eg to hide the line)
> 
> Hope this helps someone else,

Following on from girlC0d3r's solution, images aren't always guaranteed to be shown in an email.

A better solution to widening the report to prevent the content from wrapping is to have a long unbroken string of characters with no whitespace.

```
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa 
```

By giving the text the same color as the background of the email (e.g. white) they'll widen the report and be invisible to the user.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T15:49:12.707

I don't see anything but my first guess is that the fonts are vastly different. The designer has one font and the email is a flat, no-frills kind of thing with a simple font. Without concrete examples, this is just a guess.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T15:57:28.027

I don't think it's a font thing, because the text is being wrapped a lot, and it looks about the same size.

The images show in my preview, but not in the final post. So, here are links to them.

Report in the designer: [[http://img58.imageshack.us/img58/4893/designqj3.png]](http://img58.imageshack.us/img58/4893/designqj3.png])

Email result: [[http://img58.imageshack.us/img58/9297/emailmy8.png]](http://img58.imageshack.us/img58/9297/emailmy8.png])

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T17:03:52.637

What report output format did you specify for the scheduled job? It seems to me you used HTML, which will autoscale depending on the output browser (HTML adapts).

If having the same layout is important then use PDF as the output format. Then, if the user wants to print the report you know exactly what it will look like and that it will fit nicely on the page.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T17:08:32.203

Can you try a different format? pdf or xls maybe. In my experience web archive looks goofy. Don't know why.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-09T14:07:50.097

Yeah, I'm using HTML. I would prefer to stick with that, because the users can just read it in their mail clients. PDF or XLS would require them to open an attachment.

I know that the HTML resizes itself to fit the browser, and that's a good thing. The problem I would like to fix is the wasted space - in the email client, the HTML shrinks too much.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-05T06:45:37.900

I got around this problem by doing the following:

1.  Add a Page Header to the report
2.  Add a line to the page header. Set the width of the line to the desired page width.
3.  Set the line colour to white (eg to hide the line)

Hope this helps someone else,

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-12-11T15:34:24.597

girlC0d3r is along the right lines (no pun intended), but the line will likely be shrunk along with the rest of the HTML in the email. A workaround I used yesterday was to create an image 1px high by 600px wide (or whatever), the same color as the background, and bring it into the report as an embedded image. Place it above or below the body of your report. This should force the intended width in the final email. I used this technique successfully in a report yesterday.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-12T22:15:19.983

I just ran into this issue myself, exactly as portrayed in the OP's screenshots. The reports were beautifully rendered in nearly every format except for Web Archive. My trouble was the use of a rectangle containing each matrix that did not span the width of the report. Upon stretching it out through the remaining white space, the condensing behavior ceased. Hope that helps someone who doesn't have quick access to an SP upgrade!

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-01-03T17:56:46.170

Where it is not an issue of running on old software that needs a patch...

The reason is the columns are different sizes is because the [MHTML Device Information Settings, 'OutlookCompat'](https://msdn.microsoft.com/en-us/library/ms153991(v=sql.110)) is set to true

When creating an email subscription with MHTML format and open the report in Outlook, A [forum post by Microsoft employee Fanny Liu](https://social.msdn.microsoft.com/Forums/sqlserver/en-US/19d3e4bd-43be-4856-8ee0-bfde5487105f/columns-change-widths-in-a-mhtml-subscription?forum=sqlreportingservices) says

> change the OutlookCompat configuration setting for the MHTML Rendering extension in rsreportserver.config. Set the value to: False.

As I was researching it appeared that this would impact more than just column size. In my instance it was not that big of deal so I decided to leave well enough alone. It is correct in PDF and web, the email I send includes a link back to the report, if the client wants a pretty report they are going to want it in PDF, the email format is not expected to be printable.

# c# - 如何构建“默认地图”数据结构

> ID：417039
> 
> 赞同：6
> 
> 时间：2009-01-06T15:47:04.227
> 
> 标签：c#, .net, algorithm

我有一些我想在代码中建模的配置数据：

```
Key1,  Key2,  Key3,  Value
null,  null,  null,  1
1,     null,  null,  2
9,     null,  null,  21
1,     null,  3,     3
null,  2,     3,     4
1,     2,     3,     5 
```

有了这个配置集，我需要对 bazillion (give or take) {Key1, Key2, Key3} 元组进行查找以获得“有效”值。要使用的有效值基于键/优先级总和，在此示例中：

```
Key1 - Priority 10
Key2 - Priority 7
Key3 - Priority 5 
```

因此，在 Key1=null、Key2=match 和 Key3=match 上具有配置条目的特定查询胜过具有 Key1=match、Key2=null 和 Key3=null 的查询，因为 Key2+Key3 优先级 > Key1 优先级...有道理？！

```
given a key of {1, 2, 3} the value should be 5.
given a key of {3, 2, 3} the value should be 4.
given a key of {8, 10, 11} the value should be 1.
given a key of {1, 10, 11} the value should be 2.
given a key of {9, 2, 3} the value should be 4.
given a key of {8, 2, 3} the value should be 4.
given a key of {9, 3, 3} the value should be 21. 
```

有没有一种简单的方法来建模这种通用的数据结构和查找算法，因为键的 # 和类型是可变的，并且可以动态定义“真值表”（查找的顺序）？泛型而不是 int 的类型将是完美的（浮点数、双精度数、ushorts 等），并且使其易于扩展到 n 个键也很重要！

估计的“配置”表大小：1,000 行，正在查找的估计“数据”：1e14

这给出了关于预期性能类型的想法。

我正在寻找 C# 中的想法或可以轻松转换为 C# 的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T16:10:58.373

编辑：这段代码显然不是必需的，但我还是把它留了下来，因为它很有趣。它基本上将 Key1 视为优先级，然后是 Key2，然后是 Key3 等。我不太了解预期的优先级系统，是的，但是当我这样做时，我会为此添加一个答案。

我建议使用三层字典——每一层都有：

```
Dictionary<int, NextLevel> matches;
NextLevel nonMatch; 
```

因此，在第一级您将查找 Key1 - 如果匹配，则为您提供下一级查找。否则，使用与“不匹配”对应的下一个级别。

这有任何意义吗？这是一些示例代码（包括您提供的示例）。我对实际的实现并不完全满意，但数据结构背后的想法是合理的，我认为：

```
using System;
using System.Collections;
using System.Collections.Generic;

public class Test
{
    static void Main()
    {
        Config config = new Config
        {
            { null,  null,  null,  1 },
            { 1,     null,  null,  2 },
            { 1,     null,  3,     3 },
            { null,  2,     3,     4 },
            { 1,     2,     3,     5 }
        };

        Console.WriteLine(config[1, 2, 3]);
        Console.WriteLine(config[3, 2, 3]);
        Console.WriteLine(config[9, 10, 11]);
        Console.WriteLine(config[1, 10, 11]);
    }
}

// Only implement IEnumerable to allow the collection initializer
// Not really implemented yet - consider how you might want to implement :)
public class Config : IEnumerable
{
    // Aargh - death by generics :)
    private readonly DefaultingMap<int, 
                         DefaultingMap<int, DefaultingMap<int, int>>> map
        = new DefaultingMap<int, DefaultingMap<int, DefaultingMap<int, int>>>();

    public int this[int key1, int key2, int key3]
    {
        get
        {
            return map[key1][key2][key3];
        }
    }

    public void Add(int? key1, int? key2, int? key3, int value)
    {
        map.GetOrAddNew(key1).GetOrAddNew(key2)[key3] = value;
    }

    public IEnumerator GetEnumerator()
    {
        throw new NotSupportedException();
    }
}

internal class DefaultingMap<TKey, TValue>
    where TKey : struct 
    where TValue : new()
{
    private readonly Dictionary<TKey, TValue> mapped = new Dictionary<TKey, TValue>();
    private TValue unmapped = new TValue();

    public TValue GetOrAddNew(TKey? key)
    {
        if (key == null)
        {
            return unmapped;
        }
        TValue ret;
        if (mapped.TryGetValue(key.Value, out ret))
        {
            return ret;
        }
        ret = new TValue();
        mapped[key.Value] = ret;
        return ret;
    }

    public TValue this[TKey key]
    {
        get
        {
            TValue ret;
            if (mapped.TryGetValue(key, out ret))
            {
                return ret;
            }
            return unmapped;
        }
    }

    public TValue this[TKey? key]
    {
        set
        {
            if (key != null)
            {
                mapped[key.Value] = value;
            }
            else
            {
                unmapped = value;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T17:42:57.050

要回答您关于键的数量和类型通用的问题-您不能使键的数量和类型动态*并*使用泛型-泛型都是关于提供*编译时*信息的。当然，您可以使用忽略静态类型并使其成为动态 - 如果您希望我实现它，请告诉我。

会有多少条目，您需要多久查看一次？您可能最好将所有条目保留为一个列表并遍历它们，为每个匹配项提供一定的“分数”（并在您进行时保持最佳匹配及其分数）。这是一个实现，包括您的测试数据-但是根据先前的评论，它使用具有优先级的键（然后对匹配项求和）...

```
using System;
using System.Collections;
using System.Collections.Generic;

public class Test
{
    static void Main()
    {
        Config config = new Config(10, 7, 5)
        {
            { new int?[]{null,  null,  null},  1},
            { new int?[]{1,     null,  null},  2},
            { new int?[]{9,     null,  null},  21},
            { new int?[]{1,     null,  3},     3 },
            { new int?[]{null,  2,     3},     4 },
            { new int?[]{1,     2,     3},     5 }
        };

        Console.WriteLine(config[1, 2, 3]);
        Console.WriteLine(config[3, 2, 3]);
        Console.WriteLine(config[8, 10, 11]);
        Console.WriteLine(config[1, 10, 11]);
        Console.WriteLine(config[9, 2, 3]);
        Console.WriteLine(config[9, 3, 3]);
    }
}

public class Config : IEnumerable
{
    private readonly int[] priorities;
    private readonly List<KeyValuePair<int?[],int>> entries = 
        new List<KeyValuePair<int?[], int>>();

    public Config(params int[] priorities)
    {
        // In production code, copy the array to prevent tampering
        this.priorities = priorities;
    }

    public int this[params int[] keys]
    {
        get
        {
            if (keys.Length != priorities.Length)
            {
                throw new ArgumentException("Invalid entry - wrong number of keys");
            }
            int bestValue = 0;
            int bestScore = -1;
            foreach (KeyValuePair<int?[], int> pair in entries)
            {
                int?[] key = pair.Key;
                int score = 0;
                for (int i=0; i < priorities.Length; i++)
                {
                    if (key[i]==null)
                    {
                        continue;
                    }
                    if (key[i].Value == keys[i])
                    {
                        score += priorities[i];
                    }
                    else
                    {
                        score = -1;
                        break;
                    }
                }
                if (score > bestScore)
                {
                    bestScore = score;
                    bestValue = pair.Value;
                }
            }
            return bestValue;
        }
    }

    public void Add(int?[] keys, int value)
    {
        if (keys.Length != priorities.Length)
        {
            throw new ArgumentException("Invalid entry - wrong number of keys");
        }
        // Again, copy the array in production code
        entries.Add(new KeyValuePair<int?[],int>(keys, value));
    }

    public IEnumerator GetEnumerator()
    {
        throw new NotSupportedException();
    }
} 
```

上面允许可变数量的键，但只允许整数（或空）。老实说，如果你修复了密钥的数量，API 会更容易使用......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T19:15:45.443

另一个解决方案 - 假设条目是空/非空的位模式。每个位模式都有一个字典（即 { 1, null, null } 和 { 9, null, null } 在同一个字典中，但 { 1, 2, 3 } 在不同的字典中。每个字典实际上都有一个分数以及 - 键的非空部分的优先级总和。您最终会得到 2^n 个字典，其中 n 是键中元素的数量。

您以相反的分数顺序对字典进行排序，然后在每个字典中查找给定的键。每个字典都需要忽略键中不在其位模式中的值，这很容易使用 custom 完成`IComparer<int[]>`。

好的，这是实现：

```
------------ Test.cs -----------------
using System;

sealed class Test
{
    static void Main()
    {
        Config config = new Config(10, 7, 5)
        {
            { null, null, null, 1 },
            {null,  null,  null,  1},
            {1,     null,  null,  2},
            {9,     null,  null,  21},
            {1,     null,  3,     3 },
            {null,  2,     3,     4 },
            {1,     2,     3,     5 }
        };

        Console.WriteLine(config[1, 2, 3]);
        Console.WriteLine(config[3, 2, 3]);
        Console.WriteLine(config[8, 10, 11]);
        Console.WriteLine(config[1, 10, 11]);
        Console.WriteLine(config[9, 2, 3]);
        Console.WriteLine(config[9, 3, 3]);
    }
}

--------------- Config.cs -------------------
using System;
using System.Collections;

sealed class Config : IEnumerable
{
    private readonly PartialMatchDictionary<int, int> dictionary;

    public Config(int priority1, int priority2, int priority3)
    {
        dictionary = new PartialMatchDictionary<int, int>(priority1, priority2, priority3);
    }

    public void Add(int? key1, int? key2, int? key3, int value)
    {
        dictionary[new[] { key1, key2, key3 }] = value;
    }

    public int this[int key1, int key2, int key3]
    {
        get
        {
            return dictionary[new[] { key1, key2, key3 }];
        }
    }

    // Just a fake implementation to allow the collection initializer
    public IEnumerator GetEnumerator()
    {
        throw new NotSupportedException();
    }
}

-------------- PartialMatchDictionary.cs -------------------
using System;
using System.Collections.Generic;
using System.Linq;

public sealed class PartialMatchDictionary<TKey, TValue> where TKey : struct
{
    private readonly List<Dictionary<TKey[], TValue>> dictionaries;
    private readonly int keyComponentCount;

    public PartialMatchDictionary(params int[] priorities)
    {
        keyComponentCount = priorities.Length;
        dictionaries = new List<Dictionary<TKey[], TValue>>(1 << keyComponentCount);
        for (int i = 0; i < 1 << keyComponentCount; i++)
        {
            PartialComparer comparer = new PartialComparer(keyComponentCount, i);
            dictionaries.Add(new Dictionary<TKey[], TValue>(comparer));
        }
        dictionaries = dictionaries.OrderByDescending(dict => ((PartialComparer)dict.Comparer).Score(priorities))
                                   .ToList();
    }

    public TValue this[TKey[] key]
    {
        get
        {
            if (key.Length != keyComponentCount)
            {
                throw new ArgumentException("Invalid key component count");
            }
            foreach (Dictionary<TKey[], TValue> dictionary in dictionaries)
            {
                TValue value;
                if (dictionary.TryGetValue(key, out value))
                {
                    return value;
                }
            }
            throw new KeyNotFoundException("No match for this key");
        }
    }

    public TValue this[TKey?[] key]
    {
        set
        {
            if (key.Length != keyComponentCount)
            {
                throw new ArgumentException("Invalid key component count");
            }
            // This could be optimised (a dictionary of dictionaries), but there
            // won't be many additions to the dictionary compared with accesses
            foreach (Dictionary<TKey[], TValue> dictionary in dictionaries)
            {
                PartialComparer comparer = (PartialComparer)dictionary.Comparer;
                if (comparer.IsValidForPartialKey(key))
                {
                    TKey[] maskedKey = key.Select(x => x ?? default(TKey)).ToArray();
                    dictionary[maskedKey] = value;
                    return;
                }
            }
            throw new InvalidOperationException("We should never get here");
        }
    }

    private sealed class PartialComparer : IEqualityComparer<TKey[]>
    {
        private readonly int keyComponentCount;
        private readonly bool[] usedKeyComponents;
        private static readonly EqualityComparer<TKey> Comparer = EqualityComparer<TKey>.Default;

        internal PartialComparer(int keyComponentCount, int usedComponentBits)
        {
            this.keyComponentCount = keyComponentCount;
            usedKeyComponents = new bool[keyComponentCount];
            for (int i = 0; i < keyComponentCount; i++)
            {
                usedKeyComponents[i] = ((usedComponentBits & (1 << i)) != 0);
            }
        }

        internal int Score(int[] priorities)
        {
            return priorities.Where((value, index) => usedKeyComponents[index]).Sum();
        }

        internal bool IsValidForPartialKey(TKey?[] key)
        {
            for (int i = 0; i < keyComponentCount; i++)
            {
                if ((key[i] != null) != usedKeyComponents[i])
                {
                    return false;
                }
            }
            return true;
        }

        public bool Equals(TKey[] x, TKey[] y)
        {
            for (int i = 0; i < keyComponentCount; i++)
            {
                if (!usedKeyComponents[i])
                {
                    continue;
                }
                if (!Comparer.Equals(x[i], y[i]))
                {
                    return false;
                }
            }
            return true;
        }

        public int GetHashCode(TKey[] obj)
        {
            int hash = 23;
            for (int i = 0; i < keyComponentCount; i++)
            {
                if (!usedKeyComponents[i])
                {
                    continue;
                }
                hash = hash * 37 + Comparer.GetHashCode(obj[i]);
            }
            return hash;
        }
    }
} 
```

它为您提供的样本提供了正确的结果。我不知道性能如何 - 它应该是 O(1)，但它可能会进一步优化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T20:06:47.930

我假设规则很少，并且您要根据规则检查大量项目。在这种情况下，可能值得花费内存和前期时间来预先计算一个可以帮助您更快地找到对象的结构。

这种结构的基本思想是一棵树，在深度 i 处，您将遵循规则的第 i 个元素，或者如果在字典中找不到它，则遵循空分支。

为了构建树，我会递归地构建它。从包含其池中所有可能规则的根节点开始。过程：

*   将池中每个规则的当前值定义为给定到达节点所采用的路径的当前规则的分数，或者如果不可能采用该路径，则定义为 -infinity。例如，如果当前节点位于根的“1”分支，则规则 {null, null, null, 1} 的得分为 0，规则 {1, null, null, 2}有10分
*   将池中每个规则的最大值定义为其当前分数，加上其余键的分数。例如，如果当前节点位于根的“1”分支，则规则 {null, 1, 2, 1} 的得分为 12 (0 + 7 + 5)，规则 {1, null, null, 2} 的得分为 10 (10 + 0 + 0)。
*   从池中移除最大值低于池中当前最大值的元素
*   如果只有一个规则，则用该规则制作一片叶子。
*   如果池中有多个规则，并且没有更多的键，那么 ??? （从问题描述中并不清楚。我假设采取最高的）
*   对于当前池中第 (i+1) 个键的每个唯一值和 null，使用当前池从当前节点构造一棵新树。

作为最后的优化检查，我会检查一个节点的所有子节点是否都是叶子，如果它们都包含相同的规则，那么使该节点成为具有该值的叶子。

给出以下规则：

```
null,  null,  null = 1
1,     null,  null = 2
9,     null,  null = 21
1,     null,  3    = 3
null,  2,     3    = 4
1,     2,     3    = 5 
```

示例树：

```
 key1   key2   key3
root:
 |----- 1
 |      |----- 2          = 5
 |      |-----null
 |             |----- 3   = 3
 |             |-----null = 2
 |----- 9
 |      |----- 2
 |      |      |----- 3   = 4
 |      |      |-----null = 21
 |      |-----null        = 21
 |-----null
        |----- 2          = 4
        |-----null        = 1 
```

如果您以这种方式构建树，首先从最高值的键开始，那么您可能会删除许多针对后来键的检查。

编辑以添加代码：

```
class Program
{
    static void Main(string[] args)
    {
        Config config = new Config(10, 7, 5)
        {
            { new int?[]{null,  null,  null},  1},
            { new int?[]{1,     null,  null},  2},
            { new int?[]{9,     null,  null},  21},
            { new int?[]{1,     null,  3},     3 },
            { new int?[]{null,  2,     3},     4 },
            { new int?[]{1,     2,     3},     5 }
        };

        Console.WriteLine("5 == {0}", config[1, 2, 3]);
        Console.WriteLine("4 == {0}", config[3, 2, 3]);
        Console.WriteLine("1 == {0}", config[8, 10, 11]);
        Console.WriteLine("2 == {0}", config[1, 10, 11]);
        Console.WriteLine("4 == {0}", config[9, 2, 3]);
        Console.WriteLine("21 == {0}", config[9, 3, 3]);            
        Console.ReadKey();
    }
}

public class Config : IEnumerable
{
    private readonly int[] priorities;
    private readonly List<KeyValuePair<int?[], int>> rules =
        new List<KeyValuePair<int?[], int>>();
    private DefaultMapNode rootNode = null;

    public Config(params int[] priorities)
    {
        // In production code, copy the array to prevent tampering
        this.priorities = priorities;
    }

    public int this[params int[] keys]
    {
        get
        {
            if (keys.Length != priorities.Length)
            {
                throw new ArgumentException("Invalid entry - wrong number of keys");
            }

            if (rootNode == null)
            {
                rootNode = BuildTree();
                //rootNode.PrintTree(0);
            }

            DefaultMapNode curNode = rootNode;
            for (int i = 0; i < keys.Length; i++)
            {
                // if we're at a leaf, then we're done
                if (curNode.value != null)
                    return (int)curNode.value;

                if (curNode.children.ContainsKey(keys[i]))
                    curNode = curNode.children[keys[i]];
                else
                    curNode = curNode.defaultChild;
            }

            return (int)curNode.value;
        }
    }

    private DefaultMapNode BuildTree()
    {
        return new DefaultMapNode(new int?[]{}, rules, priorities);
    }

    public void Add(int?[] keys, int value)
    {
        if (keys.Length != priorities.Length)
        {
            throw new ArgumentException("Invalid entry - wrong number of keys");
        }
        // Again, copy the array in production code
        rules.Add(new KeyValuePair<int?[], int>(keys, value));

        // reset the tree to know to regenerate it.
        rootNode = null;
    }

    public IEnumerator GetEnumerator()
    {
        throw new NotSupportedException();
    }

}

public class DefaultMapNode
{
    public Dictionary<int, DefaultMapNode> children = new Dictionary<int,DefaultMapNode>();
    public DefaultMapNode defaultChild = null; // done this way to workaround dict not handling null
    public int? value = null;

    public DefaultMapNode(IList<int?> usedValues, IEnumerable<KeyValuePair<int?[], int>> pool, int[] priorities)
    {
        int bestScore = Int32.MinValue;

        // get best current score
        foreach (KeyValuePair<int?[], int> rule in pool)
        {
            int currentScore = GetCurrentScore(usedValues, priorities, rule);
            bestScore = Math.Max(bestScore, currentScore);
        }

        // get pruned pool
        List<KeyValuePair<int?[], int>> prunedPool = new List<KeyValuePair<int?[], int>>();
        foreach (KeyValuePair<int?[], int> rule in pool)
        {
            int maxScore = GetCurrentScore(usedValues, priorities, rule);
            if (maxScore == Int32.MinValue)
                continue;

            for (int i = usedValues.Count; i < rule.Key.Length; i++)
                if (rule.Key[i] != null)
                    maxScore += priorities[i];

            if (maxScore >= bestScore)
                prunedPool.Add(rule);
        }

        // base optimization case, return leaf node
        // base case, always return same answer
        if ((prunedPool.Count == 1) || (usedValues.Count == prunedPool[0].Key.Length))
        {
            value = prunedPool[0].Value;
            return;
        }

        // add null base case
        AddChild(usedValues, priorities, prunedPool, null);
        foreach (KeyValuePair<int?[], int> rule in pool)
        {
            int? branch = rule.Key[usedValues.Count];
            if (branch != null && !children.ContainsKey((int)branch))
            {
                AddChild(usedValues, priorities, prunedPool, branch);
            }
        }

        // if all children are the same, then make a leaf
        int? maybeOnlyValue = null;
        foreach (int v in GetAllValues())
        {
            if (maybeOnlyValue != null && v != maybeOnlyValue)
                return;
            maybeOnlyValue = v;
        }
        if (maybeOnlyValue != null)
            value = maybeOnlyValue;

    }

    private static int GetCurrentScore(IList<int?> usedValues, int[] priorities, KeyValuePair<int?[], int> rule)
    {
        int currentScore = 0;
        for (int i = 0; i < usedValues.Count; i++)
        {
            if (rule.Key[i] != null)
            {
                if (rule.Key[i] == usedValues[i])
                    currentScore += priorities[i];
                else
                    return Int32.MinValue;
            }
        }
        return currentScore;
    }

    private void AddChild(IList<int?> usedValues, int[] priorities, List<KeyValuePair<int?[], int>> prunedPool, Nullable<int> nextValue)
    {
        List<int?> chainedValues = new List<int?>();
        chainedValues.AddRange(usedValues);
        chainedValues.Add(nextValue);            
        DefaultMapNode node = new DefaultMapNode(chainedValues, prunedPool, priorities);
        if (nextValue == null)
            defaultChild = node;
        else
            children[(int)nextValue] = node;
    }

    public IEnumerable<int> GetAllValues()
    {
        foreach (DefaultMapNode child in children.Values)
            foreach (int v in child.GetAllValues())
                yield return v;
        if (defaultChild != null)
            foreach (int v in defaultChild.GetAllValues())
                yield return v;
        if (value != null)
            yield return (int)value;
    }

    public void PrintTree(int depth)
    {
        if (value == null)
            Console.WriteLine();
        else
        {
            Console.WriteLine(" = {0}", (int)value);
            return;
        }

        foreach (KeyValuePair<int, DefaultMapNode> child in children)
        {
            for (int i=0; i<depth; i++)
                Console.Write("    ");
            Console.Write(" {0}  ", child.Key);                
            child.Value.PrintTree(depth + 1);
        }
        for (int i = 0; i < depth; i++)
            Console.Write("    ");
        Console.Write("null");
        defaultChild.PrintTree(depth + 1);
    }
} 
```

# java - Hibernate 中的枚举

> ID：417062
> 
> 赞同：82
> 
> 时间：2009-01-06T15:54:50.543
> 
> 标签：java, hibernate, dao

在 DAO 中拥有一个值来自 Java 枚举的字段通常很有用。一个典型的例子是登录 DAO，您通常有一个字段将用户描述为“NORMAL”或“ADMIN”。在 Hibernate 中，我将使用以下 2 个对象以（半）类型安全的方式表示这种关系：

```
class User {
    String username;
    String passwd;
    UserType type;
}

class UserType {
    private enum Type {ADMIN, NORMAL};
    private String type;

    //Setters/Getters for Hibernate
    public void setType(String type);
    public String getType();

    //Setters/Getters for user
    public void setUserType(UserType.Type t);
    public UserType.Type getUserType();

    public static UserType fromType(UserType.Type t);
} 
```

这可行，但我发现 UserType 类很丑陋，并且需要太多官僚主义来存储几个值。理想情况下，Hibernate 应该直接支持枚举字段，并会创建一个额外的表来存储枚举值。

我的问题是：有没有办法直接映射 Hibernate 中的枚举类？如果不是，我表示枚举的模式是否足够好，或者我错过了什么？人们还使用哪些其他模式？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-01-12T13:16:58.510

使用休眠或 JPA 注释：

```
class User {
   @Enumerated(EnumType.STRING)
   UserType type
} 
```

UserType 只是一个标准的 java 5 枚举。

我无法想象这仅限于注释，但我实际上并不知道如何使用 hbm 文件执行此操作。我猜它可能非常依赖于版本，但我很确定需要休眠 3.2+。

编辑：在 hbm 中是可能的，但有点乱，看看这个[论坛帖子](http://forum.hibernate.org/viewtopic.php?p=2377095)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-06T16:11:02.180

从休眠文档：[http ://www.hibernate.org/272.html](http://www.hibernate.org/272.html)

您可以为每个枚举创建一个新的 typedef，并在属性标签中引用 typedef。

示例映射 - 内联`<type>`标记

```
 <property name='suit'>
    <type name="EnumUserType">
      <param name="enumClassName">com.company.project.Suit</param>
    </type>
  </property> 
```

示例映射 - 使用`<typedef>`

```
 <typedef name="suit" class='EnumUserType'>
      <param name="enumClassName">com.company.project.Suit</param>
  </typedef>

  <class ...>
    <property name='suit' type='suit'/>
  </class> 
```

# c# - WebBrowser 控件：如何覆盖 URL 属性

> ID：417072
> 
> 赞同：0
> 
> 时间：2009-01-06T15:58:36.823
> 
> 标签：c#, .net, printing, webbrowser-control

这有点特别：
我通过 DocumentText 属性将一些字符串形式的 HTML 加载到 WebBrowser 控件中。
现在，当我使用 PDF 打印机（在我的情况下为 Bullzip PDF 打印机）打印页面时，它总是将 URL 作为文档名称，即“about:blank”。
有没有办法通过更改 URL 属性（它是只读的）或通过更改打印行为以使用另一个文本而不是 URL 作为文件名来将其更改为另一个值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T16:48:30.733

尽管我对这个主题的了解有点过时，但我知道有几个选项。

首先是在 Internet 选项中更改计算机设置。无论是手动完成还是通过注册表更改脚本完成，对开发人员来说都很简单，但从部署或兼容性角度显然不是最好的方法。

下一种方法是开发自定义打印模板。这并不好玩，但可能是最专业的方法。尽管我很想在这篇文章中包含有关此方法所需的所有信息，但要涵盖的内容太多了。 [这是一个很好的概述](http://msdn.microsoft.com/en-us/library/aa753280(VS.85).aspx)，祝你好运从那里谷歌搜索。

我在这方面的经验涉及从 .NET 1.1 Winforms 应用程序中使用的 MS WebControl 组件打印到 Web Super Goo PDF 转换器组件。你的旅费可能会改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T16:05:47.573

您可以更改页眉和页脚，以便不打印 URL 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T16:06:29.723

尝试访问`Navigate`一个 URL，然后通过`DWebBrowserEvents::BeforeNavigate`

# php - Eclipse PDT 蚂蚁

> ID：417074
> 
> 赞同：13
> 
> 时间：2009-01-06T15:59:07.757
> 
> 标签：php, eclipse, development-environment, eclipse-pdt

我下载了 Eclipse PDT 2.0 GA 版本（Eclipse 3.4），但是，这个包中似乎没有包含 Ant 工具。如何安装 eclipse Ant 工具（编辑器、可执行文件等）？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-12-21T15:20:09.707

几天前，这让我发疯了。在 Galileo 中，更新过程略有不同，如果你问我，这是不好的前向设计（但我离题了）。以下是您在 Eclipse 3.5 中的操作方法。

帮助 > 安装新软件

从“使用：”下拉列表中选择“Galileo - [http://download.eclipse.org/releases/galileo](http://download.eclipse.org/releases/galileo) ”

然后展开“Programming Languages”并选择“Eclipse Java Development Tools”。

您可以安装不同的插件，但这是标准的 Eclipse 安装。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-06T17:17:29.660

所以我找到了我自己问题的答案。您需要安装 Eclipse Java 开发工具。这些可以在帮助 > 软件更新 > 可用软件中的 Ganymede > Java 开发 > Eclipse Java 开发工具下找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T16:35:05.737

不太确定您在寻找什么，但这里有一个 Eclipse Ant 插件列表：

[http://www.eclipse.org/eclipse/ant/index.php](http://www.eclipse.org/eclipse/ant/index.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T01:13:57.157

谢谢，我刚刚遇到了同样的问题，正如你所说，Java 开发工具包含 Ant。

一旦启动并运行 Ant，您可能会遇到相关问题 - 所有 Ant 文件中的此警告：

> 未检测到文档的语法约束（DTD 或 XML 模式）。

详细信息在[这个 Stack Overflow question](https://stackoverflow.com/questions/363768/disable-dtd-warning-for-ant-scripts-in-eclipse/483260#483260)中，但我使用的简短答案是将这个最小的 DTD 添加到我的构建文件中：

```
<!DOCTYPE project> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-26T19:30:11.310

似乎应该有更好的选择。Ant 是一个独立的工具。您不必为了获得 Ant 而加载所有 Java 工具。

# asp.net - ASP.NET - 如何停止不需要的服务器验证

> ID：417078
> 
> 赞同：2
> 
> 时间：2009-01-06T16:00:21.937
> 
> 标签：asp.net, javascript, validation

我已经使用 ValidatorEnable 在 javascript 中禁用了RequiredFieldValidator。然而，在回发时，由验证器验证的控件仍然被验证......即使我在客户端上禁用了验证器。

我理解为什么会发生这种情况，因为我只禁用了客户端验证......但是有没有一种很好的方法来确定我已经禁用了客户端验证，然后在回发时禁用服务器验证？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T16:29:13.580

当您禁用客户端验证（可能使用 JavaScript？）时，您还可以在隐藏输入中设置值，您可以在页面加载方法中查询该值。通过这种方式，您可以检查隐藏输入的值（通过 Request.Form{] 数组）以在验证事件触发之前禁用服务器端的验证器。

另一种选择是覆盖页面 Validate() 方法以禁用基于在客户端隐藏它们的相同规则的验证器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T16:24:40.110

从您的问题中不清楚，您正在禁用什么。RequiredFieldValidator 同时具有 Enabled 和 EnableClientScript 属性。

如果要在客户端和服务器上禁用验证，则应将 Enabled 设置为 false。

要仅禁用客户端，请将 EnableClientScript 设置为 false。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T17:22:44.970

花生，我刚刚遇到了同样的问题。在客户端，我有 javascript，它根据 UI 中的选择禁用必填字段验证器。但是，服务器端验证仍在触发。

在加载过程中，我添加了一种方法来禁用我的验证器，使用与 javascript 相同的规则。就我而言，这取决于用户选择的单选按钮：

```
this.requiredValidator.Enabled = this.myRadioButton.Checked; 
```

这似乎适用于第二个页面加载，但不是第一个。经过调试，我发现当这条线被触发时，我认为错误的单选按钮被选中。当我检查它以禁用我的验证器时，视图状态/发布数据并未应用于控件。我在加载期间放置它的原因是确保在验证器触发之前禁用它。

因此，解决方案似乎是在 ViewState 之后，但在验证器之前有类似上面的行。

正如palehorse 建议的那样，重载Validate() 方法有效，并允许我确保根据用户的当前选择启用/禁用服务器端验证器。

# open-source - 如何传播我的开源项目的意识？

> ID：417079
> 
> 赞同：11
> 
> 时间：2009-01-06T16:00:51.123
> 
> 标签：open-source

我在 Codeplex 上有几个开源项目（如果有人问，我会链接，但否则，我不是那么无耻 ;)），但我不太确定如何传播这个词或引起人们的注意。有什么吸引用户/贡献者的建议吗？

* * *

也可以看看：

[如何让用户加入您的开源项目](https://stackoverflow.com/questions/317855/how-to-get-users-to-your-open-source-project)

[您如何推广/宣传/宣传您的开源项目？](https://stackoverflow.com/questions/95710/how-do-you-promoteadvertiseevangelize-your-open-source-project)

[如何说服人们为开源项目做出贡献？](https://stackoverflow.com/questions/265417/how-to-persuade-people-to-contribute-to-an-open-source-project)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T16:03:08.123

关于他们的博客。经常发布。如果可以，请在更高级别的项目中使用它们。为其他项目做出贡献以建立您的声誉。对错误/功能请求/等非常敏感。使您的问题跟踪器保持最新。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T17:09:49.177

以下是我的 10 条建议：

1.  [通过论坛、邮件列表、 uservoice.com](http://uservoice.com)、错误跟踪器、IRC（[服务器](http://freenode.net/irc_servers.shtml)/[客户端](http://www.silverex.org/news/)）等与社区互动。通过[博客](http://wordpress.org/)、[推特](http://www.twitter.com)和邮件列表进行交流。

2.  通过快速周转以修复错误、频繁发布以及理想情况下不止一名开发人员，让用户感觉项目得到了积极维护。

3.  在实现更大的功能之前尽早征求用户反馈。

4.  [通过良好的文档](http://www.docbook.org/)、易于安装、低门槛和较少的要求来减少摩擦（例如，不需要最新版本的 .NET 只是因为它很有趣）。

5.  维护开发/稳定版本，让人们相信稳定版本就是稳定版本。

6.  与相关项目集成 - 与相关项目合作以提供更好的端到端体验。与其他开源团队合作最终会让您在他们的网站上获得参考，从而为您带来更多流量。

7.  花一些 SEO /[分析](http://www.google.com/analytics)时间，确保当人们搜索执行 X 的软件包时，你的显示相对较高。还要了解你的听众。

8.  建立一个推荐页面，您可以在其中获得积极的社区反馈。

9.  发现贡献补丁的人并邀请他们加入您的团队。

10.  在适当的地方本地化您的项目。有一些项目专门为开源项目提供翻译（例如[Betawiki](http://translatewiki.net/wiki/Translating:Why_use_Betawiki)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T16:33:37.143

这并不完全是在传播这个词，但它会帮助您的项目获得地位：提供良好的文档——写得好、详细、完整，最重要的是最新的。制作这样的文档是一件费时费力的事情，但它会极大地帮助你的项目，缺乏它会让人们不想使用它们。给定两个项目，一个是经过仔细记录的项目，一个是由语言的自动文档生成器生成的文档，很多人会更喜欢前者，即使它不是那么好。

# c# - C#如何为列表框中的选定项目运行一些代码？

> ID：417087
> 
> 赞同：1
> 
> 时间：2009-01-06T16:03:05.830
> 
> 标签：c#, listbox

我有一个名称列表框，我想单击其中一个名称以使其突出显示，然后单击一个为所选项目运行一些代码的按钮。我如何调用这个选定的项目？

```
 private void btnEcho_Click(object sender, EventArgs e)
    {
         listbox1.SelectedItem......
    } 
```

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T16:09:13.183

列表框不是很直观，因为它包含对象而不是 ListItem 之类的东西，但如果你只想要文本，你可以这样做：

```
string selectedText = listbox1.SelectedItem.ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T16:07:12.967

```
String s = listbox1.SelectedItem.Value.ToString(); 
```

不要忘记进行空检查，因为如果您的列表为空或未选择任何值，这将引发错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T16:19:18.403

`Listbox1.SelectedItem`获取实际选定的项目。然后，您可以从**SelectedItem**进一步调用以获取其他属性/方法，例如`SelectedItem.Text`或`SelectedItem.Value`

如果您想在从列表框中进行选择（而不是按下按钮）时使这一切发生，您可以`SelectedIndexChanged`为 Listbox1 添加一个事件（并且在 ASP.NET 中确保将`AutoPostBack`其设置为 TRUE）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T12:51:27.400

```
string str = listbox1.SelectedValue.ToString(); 
```

在这里，您选择了什么值（名称）。

```
if(str == null || str == string.empty) return; 
```

等等。你想做什么，就可以做什么; 祝你好运

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-06T16:08:49.453

你的问题对我来说不是很清楚。

例如，您有一个包含三个项目的列表框：A、B 和 C。正如您在示例中所做的那样，您有一个单击事件。在该单击事件中，您可以使用 switch 语句来处理每个项目的一些代码：

```
switch (listbox1.SelectedItem)
{
  case "A":
       // Code when select A
       break;
  case "B":
       // Code when select B
       break;
  ... (and so on).
} 
```

代码是一个示例，未经测试。有关详细信息，请参阅开关。

# ruby-on-rails - 在 Rails 中嵌套内容标签

> ID：417097
> 
> 赞同：1
> 
> 时间：2009-01-06T16:05:32.067
> 
> 标签：ruby-on-rails, ruby, forms

嘿。我有一些来自 Agile Web Development 的代码，它在方法调用周围包装了一些 HTML，如下所示：

```
 # from tagged_builder.rb, included as a FormBuilder helper
 def self.create_tagged_field(method_name)
    define_method(method_name) do |label, *args|
      @template.content_tag("p",
        @template.content_tag("label" , 
                              label.to_s.humanize.capitalize, 
                              :for => "#{@object_name}_#{label}") 
                               +
        super)
    end
  end 
```

我想在标签 content_tag 中嵌套一个跨度标签，以便最终输出如下所示：

```
<p><label>Name
        <span class="small">Add your name</span>
    </label>
    <input type="text" name="textfield" id="textfield" /> 
```

我想知道如何包含跨度的内容（比如一个变量，例如“警告”）

我尝试了各种方法，但无济于事。方法调用 ok （如 f.text_field :name 将产生

```
<p><label for="object_name">Name</label></p> 
```

试过这个：

```
 def self.create_tagged_field(method_name)
    define_method(method_name) do |label, warning, *args|
      @template.content_tag("p",
        @template.content_tag("label" , 
                              label.to_s.humanize.capitalize+
                              content_tag("span", warning), 
                              :for => "#{@object_name}_#{label}") 
                               +
        super)
    end
  end 
```

但没有运气。谁能引导我朝着正确的方向前进？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T16:46:05.370

你需要打电话`@template.content_tag`。您那里的代码只是调用 self.content_tag，这显然没有做任何事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T22:36:39.373

只是想发布最终解决方案，更多的是为了骄傲。菜鸟... :0

```
 def self.create_tagged_field(method_name)
    define_method(method_name) do |label, *args|
      # accepts the warning hash from text_field helper
      if (args.first.instance_of? Hash) && (args.first.keys.include? :warning)
        warning = args.first[:warning]
      end
        @template.content_tag("label" , label.to_s.humanize+(@template.content_tag("span", warning, :class =>'small')), 
                              :for => "#{@object_name}_#{label}") +                      
         super
    end
  end 
```

# asp.net - 最大文件扩展名长度

> ID：417103
> 
> 赞同：7
> 
> 时间：2009-01-06T16:06:36.790
> 
> 标签：asp.net, file-io

文件扩展名是否有最大长度？我见过的最长的是 .compiled (8 chars)

**无用的背景**

我正在创建一个 IHttpHandler 来返回特定文件名的图像图标。我只是调用 FileImage.axd?ext=pptx。我正在使用类似于[我的](http://bendewey.wordpress.com/2008/02/22/nativefiletypeviewer-fileiconimageconverter-convert-a-filename-to-the-file-system-icon/)WPF 帖子的 SHGetFileInfo 动态生成文件，然后将它们本地缓存在文件名为“pptx.png”的文件夹中。我想验证长度并修剪它以防止 DoS 类型的攻击，在这种攻击中，有人会尝试为无限数量的垃圾字符生成图像（例如 FileImage.axd?ext=asdfasdfweqrsadfasdfwqe ...）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-06T16:08:27.770

据我所知，没有限制，除了文件名的最大长度。除 FAT16 外，扩展名没有特殊处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T17:09:44.887

我同意 Arkadiy 的观点——现在 DOS 8.3 系统已成为过去（或其他类似的受限系统），因此没有正式的限制。我会说我见过的大多数扩展都在 1-3 范围内；Java 对 .java 使用 4，对 .class 使用 5。您的 8 示例比我记得的要长。如果我在界定范围，我的目标是“无限”；如果这不可行，请允许至少 16 个字符 - 确信实际上 16 个字符对于当前系统来说已经足够了。

# .net - 为什么 .NET GUID 中有破折号？

> ID：417108
> 
> 赞同：63
> 
> 时间：2009-01-06T16:07:14.840
> 
> 标签：.net, guid, uuid

为什么 .NET GUID 中有破折号？GUID 的大多数实现中是否有破折号，或者它只是微软的东西？

签，

741ecf77-9c92-4435-8e6b-85975bd13452

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-01-06T16:13:24.593

[从技术上讲， GUID](http://en.wikipedia.org/wiki/GUID)中没有“破折号” 。GUID 是一个 128 位的值，通常以以下方式存储（此处使用 C# 表示结构）：

```
public struct Guid
{
  public ulong Data1;
  public ushort Data2;
  public ushort Data3;
  public fixed byte Data4[8];
} 
```

破折号位于GUID的*字符串表示形式中。*

破折号是可选的，在 GUID 的字符串表示中不是必需的。

也就是说，[破折号的位置存在历史原因](https://stackoverflow.com/a/3557678/50776)，与 GUID 的生成方式有关，但该历史语义不再适用。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2010-08-24T14:42:09.410

在 UUID（通用唯一标识符）规范的初始版本中，每个数据元素都有一个语义含义：

{ **time_low** } - { **time_mid** } - { **time_high_and_version** } - {  **clock_seq_and_reserved clock_seq_low** } - { **node_id** }

这些元素旨在提供时间（时间位）和空间（主机位）唯一性。

## 版本历史

由于发现 2^1024 随机位的密钥空间中发生冲突的数学概率在天文数字上是不可能的，因此出于安全和隐私原因，UUID 规范的后续版本已逐步淘汰时间和主机数据。

唯一保留任何含义的元素是版本位和保留位。

第 3 版 UUID 派生自 URI 或其他专有名称的 MD5 哈希。

版本 4 是使用随机数据生成的，目前是您在野外看到的最常见的实现。

版本 5 源自 SHA1 哈希。

## 存储格式

由于连字符是在 RFC 中为 UUID 的 ASCII 格式指定的，即使各个部分不再保留其原始含义，如果您需要互操作性，它们仍然是必需的。

UUID 有时也存储为 base64 或 ascii85 编码字符串，以节省空间以通过非二进制安全的传输进行传输，并且不需要遵守 RFC。

```
ASCII：3F2504E0-4F89-11D3-9A0C-0305E82C3301
Base64：7QDBkvCA1+B9K/U0vrQx1A
Ascii85: 5:$Hj:Pf\4RLB9%kU\Lj

```

参考：
[RFC4122](ftp://ftp.rfc-editor.org/in-notes/rfc4122.txt)（UUID 格式的 ABNF 描述见第 3 页）
Wikipedia [GUID](http://en.wikipedia.org/wiki/Globally_unique_identifier) [UUID](http://en.wikipedia.org/wiki/Universally_Unique_Identifier)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-08-24T14:21:13.583

您可以获得各种格式的指南。

假设您使用的是 c#：

```
Guid guid = Guid.NewGuid();

Console.WriteLine(guid.ToString("N")) 
```

63be6f7e4e564f0580229f958f492077

```
Console.WriteLine(guid.ToString("D")) 
```

63be6f7e-4e56-4f05-8022-9f958f492077

```
Console.WriteLine(guid.ToString("B")) 
```

{63be6f7e-4e56-4f05-8022-9f958f492077}

```
Console.WriteLine(guid.ToString("P")) 
```

(63be6f7e-4e56-4f05-8022-9f958f492077)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2010-08-24T14:16:55.997

连字符表示 Guid 的字节结构。

```
typedef struct _GUID 
{  
   DWORD Data1;  
   WORD Data2;  
   WORD Data3;  
   BYTE Data4[8];
} GUID; 
```

为了：

```
(XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXX) 
```

您可能可以在保存之前剥离它们。至少在 .NET 中，Guid 类型的构造函数将从其字符串表示形式初始化 Guid 变量，而不管连字符是否仍然存在或已删除。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-01-06T16:09:51.123

这只是一种方便。

[http://en.wikipedia.org/wiki/GUID](http://en.wikipedia.org/wiki/GUID)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-01-06T16:11:43.537

这是一个分块的例子，就像电话号码、信用卡号码等一样。

[这是一篇关于它的好维基百科文章。](http://en.wikipedia.org/wiki/Chunking_(psychology))

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-06T16:11:43.990

我见过的几乎每一个 guid 的视觉表示都使用虚线格式。对眼睛来说要容易得多。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-06T16:33:53.367

`Guid`.NET 类可以识别一堆不同的格式：破折号作为分隔符、无分隔符、括号作为分隔符、括号作为分隔符、无分隔符等

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-08-24T14:18:43.090

连字符用于分隔每个数字

E93416C5-9377-4A1D-8390-7E57D439C9E7

```
Hex digits  Description
8           Data1
4           Data2
4           Data3
4           Initial two bytes from Data4
12          Remaining six bytes from Data4 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-08-24T14:16:50.193

那只是为了方便。GUID 由 16 个字节组成，以十六进制文本表示形式由 32 个字符组成。没有连字符的 GUID 更难被人类感知，也更难被识别为 GUID，而不是一些随机性质的 16 字节数字。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-08-24T14:18:05.777

如果您想在某处存储 guid，则将其存储为 16 个字节的数组，而不是其文本表示形式。您将节省大量空间，并且不会出现连字符的问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-08-24T14:18:50.000

GUID 实际上只是一个数字。连字符向您展示了各种组件是如何分解的，但实际上并不是数字的一部分。它就像一个 IP 地址——你可以存储一个 32 位的数字，或者你可以存储一个带有点的字符串，它们是等价的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-08-24T14:18:51.650

连字符对值的唯一性或随机性绝对没有影响。它们只是 GUID 定义的保留，并在视觉上将构成 GUID 的数据的四个不同部分分开。

# .net - .NET 强制 COM 对象释放

> ID：417112
> 
> 赞同：1
> 
> 时间：2009-01-06T16:08:12.403
> 
> 标签：.net, asp.net, com

我在 IIS 下有一个 ASP.NET 2.0 应用程序，它具有将一些数据导出到名为 HFM（Oracle Hyperion Financial Management）的软件的功能。为了执行该导出，.net 应用程序使用基于 HFM 客户端提供的 COM 对象的 API（客户端与服务器安装在同一台机器上等）

我的问题是 API 提供了一种连接到 HFM 服务器但不断开连接的方法。
文档说要断开连接，应用程序必须在创建的每个 COM 对象上调用**Marshal.ReleaseComObject()方法。**但是执行了很多复杂的操作，我无法释放所有创建的对象。
所以我的应用程序不会断开连接。

我注意到，当我替换 ASP.NET 应用程序 dll 文件（这似乎重新初始化由 .NET 实例化的对象）时，应用程序会自动断开连接。

我试过几次打电话：

```
GC.Collect();
GC.WaitForPendingFinalizers(); 
```

但问题依然存在。我正在寻找一种方法来确保创建任何对象，甚至释放 COM 对象。我尝试使用**Marshal.FinalReleaseComObject()**，但效果并不好。

当我在该部分放置一个 lock() 时，该部分始终最多有一个用户，因此我什至可以使用核心技术来释放 COM 对象。

有没有办法知道哪个对象或至少是尚未释放的对象的类型？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T17:29:04.970

你能在每个 COM 实例周围放置一个实现**IDisposable的通用包装器类型吗？**

**然后，您可以在Dispose**方法中调用**Marshal.FinalReleaseComObject （或在****Marshal.ReleaseComObject**上循环检查引用计数） ，并且仅通过引用您的包装器类型的**using**语句实例化 COM 对象。

 ****执行此包装器技巧的另一个好处是，您可以使用[CLR 分析器](http://msdn.microsoft.com/en-us/library/ms979205.aspx)检查您的哪些类型实例尚未被释放，从而回答您的最后一个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T19:03:51.490

> 但是执行了很多复杂的操作，我无法释放所有创建的对象。

有你的问题。

你正在寻找一个简单的出路。但是您正在使用 COM。您获得的唯一简单方法是关闭您的进程/应用程序域。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-01T20:56:22.867

在调用 Marshal.ReleaseComObject 或 Marshal.FinalReleaseComObject 后将变量设置为 Null/Nothing 是绝对重要的。

```
Dim cn As ADODB.Connection
cn = New ADODB.Connection
cn.Open(_cnnstr)
cn.Execute(sbDML.ToString)
cn.Close()
System.Runtime.InteropServices.Marshal.FinalReleaseComObject(cn)
cn = Nothing '!!!IMPORTANT!!! - Do not remove, MUST be explicitly called! 
```

此外，我注意到创建另一个方法有助于避免处理本地 COM 对象（放置在堆栈上的变量）的问题。例如，如果您有一个方法可以完成所有操作，请将其包装在另一个方法中，添加对垃圾回收的调用，然后调用包装器。

```
Public Sub MainMethod
    '...
    Marshal.FinalReleaseComObject(foo)
    foo = Nothing '!!!IMPORTANT!!! - Do not remove, MUST be explicitly called!
End Sub

Public Sub WrapperMethod
    Call MainMethod
    GC.Collect()
End Sub 
```

我相信额外的调用，以及为局部变量创建附加堆栈，会强制更快地完全收集对象并导致 COM 对象被完全释放。

我已经遵循这种模式几年了，从那以后我没有遇到任何问题。

# c# - 如何使用 .NET 以编程方式将 MSSQL 服务器别名转换为 IP 地址？

> ID：417121
> 
> 赞同：0
> 
> 时间：2009-01-06T16:09:26.600
> 
> 标签：c#, .net, sql-server, windows

~~Windows 默认安装附带~~MSSQL 客户端有一个 cliconfg 应用程序，用于设置服务器 IP 地址和端口的别名。有时我们在 ConnectionStrings 中使用其中一些别名而不是 IP 地址、端口。如何以编程方式将该别名转换为使用 .NET 的地址？

**更新：**当我们使用 ConnectionString 时，.NET + Windows 会自动执行此转换，但我不知道转换结果（IP 地址）是否写入任何我们可以读取的公共属性中。

**更新：**我发现 cliconfg 将别名存储在 Windows 注册表中。我想知道是否可以从 .NET 访问 Windows 注册表

```
32bit HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\Client\ConnectTo

64bit HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\MSSQLServer\Client\ConnectTo 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T19:40:54.457

我为 32 位版本的 Windows 找到了以下解决方案：

```
using Microsoft.Win32;

static void Main(string[] args)
{
        var Aliases = Registry.LocalMachine.OpenSubKey(
            @"SOFTWARE\Microsoft\MSSQLServer\Client\ConnectTo");
        Aliases.GetValue("Alias");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T15:07:59.013

只要您不需要端口，使用 System.Net.Dns 类获取 IP 地址就相当简单：

```
IPAddress[] ips = Dns.GetHostAddresses("myHostName")
```

# c# - 如何解析大写单词的字符串

> ID：417122
> 
> 赞同：0
> 
> 时间：2009-01-06T16:09:29.967
> 
> 标签：c#, regex

我有这个字符串：`" Mimi loves Toto and Tata hate Mimi so Toto killed Tata"`

我想编写一个只打印以大写字母开头的单词的代码，避免重复

输出应该像

```
Mimi
Toto
Tata 
```

我试图这样做，但我确信它是错误的，即使没有显示错误。

我写的代码：

```
static void Main(string[] args)
        {
            string s = "Memi ate Toto and she killed Tata Memi also hate Biso";
            Console.WriteLine((spliter(s)));
        }

        public static string spliter(string s)
        {

            string x = s;
            Regex exp = new Regex(@"[A-Z]");
            MatchCollection M = exp.Matches(s);

            foreach (Match t in M)
            {

                while (x != null)
                {
                    x = t.Value;  
                }

            }
            return x;
        }

    }
} 
```

## 主意：

如果我将字符串拆分成一个数组，然后应用正则表达式逐字检查它们然后打印结果怎么办？我不知道 - 任何人都可以帮助我使这段代码工作吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-06T16:28:31.007

我根本不知道 C#/.net 正则表达式库，但是这个正则表达式模式可以做到：

```
\b[A-Z][a-z]+ 
```

\b 表示匹配只能从单词的开头开始。如果您想允许单个单词大写，请将 + 更改为 *。

编辑：你想匹配“麦当劳”吗？

```
\b[A-Z][A-Za-z']+ 
```

如果您不想匹配 ' 如果它只出现在字符串的末尾，那么只需执行以下操作：

```
\b[A-Z][A-Za-z']+(?<!') 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-06T16:16:40.763

我不知道我为什么要发布这个......

```
 string[] foo = "Mimi loves Toto and Tata hate Mimi so Toto killed Tata".Split(' ');
            HashSet<string> words = new HashSet<string>();
            foreach (string word in foo)
            {
                if (char.IsUpper(word[0]))
                {
                    words.Add(word);
                }
            }

            foreach (string word in words)
            {
                Console.WriteLine(word);
            } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-06T16:54:37.053

C# 3

```
 string z = "Mimi loves Toto and Tata hate Mimi so Toto killed Tata";
        var wordsWithCapital = z.Split(' ').Where(word => char.IsUpper(word[0])).Distinct();
        MessageBox.Show( string.Join(", ", wordsWithCapital.ToArray()) ); 
```

C# 2

```
 Dictionary<string,int> distinctWords = new Dictionary<string,int>();
        string[] wordsWithInitCaps = z.Split(' ');
        foreach (string wordX in wordsWithInitCaps)
            if (char.IsUpper(wordX[0]))
                if (!distinctWords.ContainsKey(wordX))
                    distinctWords[wordX] = 1;
                else
                    ++distinctWords[wordX];                       

        foreach(string k in distinctWords.Keys)
            MessageBox.Show(k + ": " + distinctWords[k].ToString()); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T16:20:03.877

我建议做一个 string.split 将字符串分成单词，然后只打印 char.IsUpper(word[0]) 为真的单词。

像[这样的东西](https://stackoverflow.com/questions/417122/how-to-parse-string-for-capitalized-words#417298)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-06T16:24:03.200

使用这个正则表达式

**([AZ][az]+)**

解释：

```
[A-Z]    [a-z]+
  |        |
Single   Multiple(+)
  |        |
  C      apital   -> Capital 
```

[在这里](http://demo.1060research.com/ep+name@app_regular_expression_cookbook)尝试正则表达式

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-06T16:50:40.633

由于其他人已经发布了这么多答案，我不觉得我违反了任何家庭作业规则来表明这一点：

```
//set up the string to be searched
string source =
"First The The Quick Red fox jumped oveR A Red Lazy BRown DOg";

//new up a Regex object.
Regex myReg = new Regex(@"(\b[A-Z]\w*)");

//Get the matches, turn then into strings, de-dupe them
IEnumerable<string> results =
    myReg.Matches(source)
    .OfType<Match>()
    .Select(m => m.Value)
    .Distinct();

//print out the strings.
foreach (string s in results)
    Console.WriteLine(s); 
```

*   要学习 Regex 类型，您应该从[这里](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.aspx)开始。
*   要学习 Linq 内存中查询方法，您应该从[这里](http://msdn.microsoft.com/en-us/library/system.linq.enumerable_members.aspx)开始。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T16:25:01.217

解决方案。注意使用内置的字符串拆分器。您可以通过检查第一个字符是否在“A”和“Z”之间来替换顶部的东西。删除我留给您的重复项（如果需要，请使用哈希集）。

```
static void Main(string[] args)
    {
        string test = " Mimi loves Toto and Tata hate Mimi so Toto killed Tata";
        foreach (string j in test.Split(' '))
        {
            if (j.Length > 0)
            {
                if (j.ToUpper()[0] == j[0])
                {
                    Console.WriteLine(j);
                }
            }
        }
        Console.ReadKey(); //Press any key to continue;
    } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-09-06T09:38:57.703

适当的正则表达式：`\b\p{Lu}\p{L}*`

```
var result = 
    Regex.Matches(input, @"\b\p{Lu}\p{L}*")
    .Cast<Match>().Select(m => m.Value); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T03:54:23.430

David B's answer is the best one, he takes into account the word stopper. One vote up.

To add something to his answer:

```
 Func<string,bool,string> CaptureCaps = (source,caseInsensitive) => string.Join(" ", 
                new Regex(@"\b[A-Z]\w*").Matches(source).OfType<Match>().Select(match => match.Value).Distinct(new KeisInsensitiveComparer(caseInsensitive) ).ToArray() );

        MessageBox.Show(CaptureCaps("First The The  Quick Red fox jumped oveR A Red Lazy BRown DOg", false));
        MessageBox.Show(CaptureCaps("Mimi loves Toto. Tata hate Mimi, so Toto killed TaTa. A bad one!", false));

        MessageBox.Show(CaptureCaps("First The The  Quick Red fox jumped oveR A Red Lazy BRown DOg", true));
        MessageBox.Show(CaptureCaps("Mimi loves Toto. Tata hate Mimi, so Toto killed TaTa. A bad one!", true));

class KeisInsensitiveComparer : IEqualityComparer<string>
{
    public KeisInsensitiveComparer() { }

    bool _caseInsensitive;
    public KeisInsensitiveComparer(bool caseInsensitive) { _caseInsensitive = caseInsensitive; }

    // Products are equal if their names and product numbers are equal.
    public bool Equals(string x, string y)
    {

        // Check whether the compared objects reference the same data.
        if (Object.ReferenceEquals(x, y)) return true;

        // Check whether any of the compared objects is null.
        if (Object.ReferenceEquals(x, null) || Object.ReferenceEquals(y, null))
            return false;

        return _caseInsensitive ? x.ToUpper() == y.ToUpper() : x == y;
    }

    // If Equals() returns true for a pair of objects,
    // GetHashCode must return the same value for these objects.

    public int GetHashCode(string s)
    {
        // Check whether the object is null.
        if (Object.ReferenceEquals(s, null)) return 0;

        // Get the hash code for the Name field if it is not null.
        int hashS = s == null ? 0 : _caseInsensitive ? s.ToUpper().GetHashCode() : s.GetHashCode();

        // Get the hash code for the Code field.
        int hashScode = _caseInsensitive ? s.ToUpper().GetHashCode() : s.GetHashCode();

        // Calculate the hash code for the product.
        return hashS ^ hashScode;
    }

} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-09T00:38:02.263

```
 static Regex _capitalizedWordPattern = new Regex(@"\b[A-Z][a-z]*\b", RegexOptions.Compiled | RegexOptions.Multiline);

    public static IEnumerable<string> GetDistinctOnlyCapitalizedWords(string text)
    {
        return _capitalizedWordPattern.Matches(text).Cast<Match>().Select(m => m.Value).Distinct();
    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-06T16:36:35.357

```
string foo = "Mimi loves Toto and Tata hate Mimi so Toto killed Tata";
char[] separators = {' '};
IList<string> capitalizedWords = new List<string>();
string[] words = foo.Split(separators);
foreach (string word in words)
{
    char c = char.Parse(word.Substring(0, 1));

    if (char.IsUpper(c))
    {
        capitalizedWords.Add(word);
    }
}

foreach (string s in capitalizedWords)
{
    Console.WriteLine(s);
} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2010-09-05T21:56:02.140

```
function capitalLetters() {
  var textAreaId = "textAreaId";
  var resultsArray = $(textAreaId).value.match( /\b[A-Z][A-Za-z']+/g );
  displayResults(textAreaId, resultsArray);
} 
```

# wpf - 在我的应用程序中托管一个基本的 XAML 编辑器？

> ID：417128
> 
> 赞同：3
> 
> 时间：2009-01-06T16:11:35.393
> 
> 标签：wpf, reporting-services, reporting

在我们的应用程序中，我们允许安装管理员设计用于在他们从自助服务终端办理登机手续时打印的姓名标签模板（有点像在自助服务终端办理航班登机手续并打印出登机牌）。

例如，模板可能如下所示：

```
[FirstName] [LastName]
[Company]
[PersonImage]
[BarCode] 
```

现在，我们使用 Reporting Services 允许我们的管理员设计名称标签模板（有些人可能想要一张人的照片、打印的条形码、他们的组织名称等）。这可以正常工作，但是 1) Reporting Services 呈现速度很慢，并且 2) 它与我们的应用程序没有很好地集成——他们必须加载 Visual Studio 并在我们的应用程序之外设计名称标签。

XAML 似乎非常适合设计名称标签的模板。几乎任何设计都可以使用该格式处理，我们可以使用 XAML 到 XPS 进行打印。

我看到的问题是如何集成使用可用 XAML 控件子集的可视化设计器。我们真的只需要简单的控件，例如 Canvas、Grid、TextBlock、Image 等支持拖放的控件。 **关于是否可以将 Visual Studio 或 Sparkle 的 XAML 设计器托管到单独的应用程序中，我没有找到太多信息。有人有想法么？** RichTextBox 看起来几乎可以工作，但 FlowDocument 并不是我们真正想要的。我们需要能够拖动项目并绝对定位它们（​​就像在报表设计器中一样）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T01:51:44.330

我不确定您是否可以主持 MS 设计师（尽管我对此表示怀疑），但我认为您可以相当简单地制作自己的迷你编辑器。从 a 开始并以`Canvas`编程方式添加`Label`s、`TextBlock`s 或您想要的任何其他内容（将它们与处理程序连接起来以通过/`Click`移动它们）。您可以很容易地将其渲染为图像以进行打印，或者您提到的 Xaml-Xps。`Canvas.Top``Canvas.Left``Canvas`

查看[Kaxaml](http://kaxaml.com/)作为示例，他已经开发了一个迷你 Xaml 编辑器（它最近更新到 SL2）。那里可能还有其他人。

EDIT 26-Jan-09: also check out Charles Petzold's [XamlCruncher](http://www.charlespetzold.com/blog/2009/01/XamlCruncher-for-Silverlight.html "XamlCruncher") ([example](http://www.charlespetzold.com/silverlight/XamlCruncherSL "example")) - certainly beats loading up Visual Studio - seems like `XamlReader.Load` might be worth trying out?

# asp.net - 通过不同 ContentPlaceHolder 中的控件触发 UpdatePanel 的更新

> ID：417131
> 
> 赞同：15
> 
> 时间：2009-01-06T16:11:46.220
> 
> 标签：asp.net, ajax, updatepanel

我有一个包含两个 ContentPlaceHolders 的页面。一个有一个 DropDown 和另一个带有内容的 UpdatePanel。

当 DropDown 的 selectedItemChanged 事件位于不同的 ContentPlaceholders 中时，如何触发对 UpdatePanel 的更新？

由于 UpdatePanel1 不知道 DropDown1，因此以下操作不起作用：

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional"  ChildrenAsTriggers="true">
    <ContentTemplate>
        Some content that needs to be updated here...
    </ContentTemplate>
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="DropDown1" EventName="SelectedIndexChanged" />
    </Triggers>
</asp:UpdatePanel> 
```

One way is to make an ajax page method that would be called by javascript on the page when DropDown's item is selected. 然后在后面的代码中，在该页面方法中，调用 UpdatePanel1.Update()。

有没有更简单的选择？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-06T19:16:54.537

来自[http://msdn.microsoft.com/en-us/library/system.web.ui.asyncpostbacktrigger.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.asyncpostbacktrigger.aspx)

> AsyncPostBackTrigger 引用的控件必须与作为触发器的更新面板位于同一命名容器中。不支持基于其他命名容器中的控件的触发器。

解决方法是使用触发器引用的控件的 UniqueID。不幸的是，直到控件被添加到它的父级（并且它的父级已经被添加到它的父级，一直到控件树），UniqueID 才被限定。

在您后面的代码中，尝试：

```
UpdatePanel1.Triggers.Add(new AsyncPostBackTrigger()
{
    ControlID = DropDown1.UniqueID,
    EventName = "SelectedIndexChanged", // this may be optional
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T17:08:47.947

在代码隐藏文件中，您应该能够：

```
ScriptManager.RegisterAsyncPostBackControl(dropdown1); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-05T16:41:43.053

`updatePanel1.Update()`您可以通过服务器端的调用方法强制更新任何页面 UpdatePanel 。例如，在更新 updatePanel1 期间 ，两个面板都将被更新`button1.Click`。`updatePanel2.Update()`

# asp.net - 为 CAC 卡配置“Cassini”（ASP.NET 开发服务器）以进行测试 - 如何？

> ID：417132
> 
> 赞同：3
> 
> 时间：2009-01-06T16:12:06.517
> 
> 标签：asp.net, visual-studio-2008, cassini, smartcard, cac

我正在开发一个新网站（ASP.Net、VB 代码隐藏页面、.Net 3.5）来替换“经典 ASP”网站。

有些页面是“公开的”，其余的则需要身份验证——在这种情况下，它是通过键盘读取 DoD 颁发的 CAC 卡来完成的。

现在，对于“生产”，他们配置 IIS，以便它在访问某个目录（在本例中为 /secure）时执行身份验证质询（读取卡并请求 PIN），从而保护该树中的所有页面。

我快到了需要查看卡片上的一些信息的地步了——但是当我“F5”我正在开发的网站时，所有 Request.Clientcertificate 的东西都是空的——没有发生“挑战” Cassini ASP.Net 开发服务器。

我看到了对“配置 IIS 以将 SSL 放在目标目录中”的引用——但我没有在这台开发 PC 上运行 IIS（其他开发人员也不会很快遇到这个问题）。当站点最终被复制到生产环境中时，网络支持人员将执行此操作，但我现在需要测试某些安全功能。

如何配置 VS2008 附带的服务器以读取 CAC 卡并“加载”我需要查询的服务器/会话变量？或者，我可以将任何东西放入 .aspx 或 .aspx.vb 页面本身来模拟或触发安全挑战吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T12:29:17.920

简短的回答。Cassini 不支持这种安全性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-30T17:14:15.757

我希望你现在找到解决方案......但以防万一，我会告诉你我做了类似的开发并且遇到了同样的问题。我发现的唯一“解决方案”是简单地将网站/网页发布到配置为需要客户端证书等的 IIS 的服务器上......

当然，这确实会阻止您使用 Visual Studio 中的“调试”功能，但总有将调试语句注入代码的方法 [eg:如有必要`response.write()`，后跟`response.end()`]...我还构建了一个用于枚举的页面所有可用的字符串`request.clientcertificate()`，甚至后来扩展它以运行提供的正则表达式来搜索整个证书......

希望这些想法被证明是有用的！

# .net - 向数据集添加行

> ID：417133
> 
> 赞同：6
> 
> 时间：2009-01-06T16:12:35.250
> 
> 标签：.net, vb.net

是否可以将行添加到数据集？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-06T16:16:51.780

是的。

```
dim row as DataRow 
row = ds.tables(0).NewRow 
' Add Values to Row here 
ds.tables(0).rows.add(row) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T16:17:15.537

是的，您当然可以向数据集中的数据表添加行。

查看[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/5ycd1034(VS.80).aspx)以获取操作方法。它涵盖了强类型数据集和无类型数据集。

> ## 向类型化数据集添加新记录
> 
> 声明类型化数据集的新实例。在以下示例中，您声明了 CustomersRow 类的新实例，为其分配新行，用数据填充列，并将新行添加到 Customers 表的 Rows 集合中：
> 
> ```
> Dim newCustomersRow As NorthwindDataSet.CustomersRow
> newCustomersRow = NorthwindDataSet1.Customers.NewCustomersRow()
> 
> newCustomersRow.CustomerID = "ALFKI"
> newCustomersRow.CompanyName = "Alfreds Futterkiste"
> 
> NorthwindDataSet1.Customers.Rows.Add(newCustomersRow) 
> ```
> 
> ## 将记录添加到无类型数据集
> 
> 调用 DataTable 的 NewRow 方法来创建一个新的空行。此新行从数据表的 DataColumnCollection 继承其列结构。下面的代码创建一个新行，用数据填充它，并将它添加到表的 Rows 集合中。
> 
> ```
> Dim newCustomersRow As DataRow = DataSet1.Tables("Customers").NewRow()
> 
> newCustomersRow("CustomerID") = "ALFKI"
> newCustomersRow("CompanyName") = "Alfreds Futterkiste"
> 
> DataSet1.Tables("Customers").Rows.Add(newCustomersRow) 
> ```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-06T16:23:27.647

不，但我怀疑你的问题措辞有误。

您可以将行添加到 dataTABLE。数据集由数据表组成（或为空）。

为了将行添加到 DataTable，您首先制作 DataRow，然后将其添加到 DataTable

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T16:17:41.217

您可以将行添加到数据表中，该数据表可以包含在数据集中。在表的“行”集合上调用“添加”函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-01T17:02:36.027

尝试像这样向数据集添加行：

```
NewRow = PreviousYear.Tables(0).Rows.Add
       NewRow(0) = Your Value
       NewRow(1) = Your Value
       NewRow(2) = Your Value
       NewRow(3) = Your Value
       NewRow(4) = Your Value 
```

此代码将添加 1 行 5 列。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-15T18:19:55.307

这些解决方案很好，但是如果您只是使用 ComboBox.SelectedIndex = -1 那么显示将是空白的，您首先不需要“空白”行。

# build-process - 持续集成与夜间构建

> ID：417134
> 
> 赞同：16
> 
> 时间：2009-01-06T16:12:46.670
> 
> 标签：build-process, continuous-integration

阅读[这篇](https://stackoverflow.com/questions/204603/nightly-builds-why-should-i-do-it)文章让我感到疑惑；每晚构建比持续集成更好吗？答案的共识似乎非常偏向于持续集成，这是传福音还是真的没有理由在持续集成是一种选择时使用夜间构建？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-06T16:16:59.047

如果您真的在与所有可用测试进行持续集成，那么每晚构建将是多余的，因为当天检查的最后一件事已经经过测试。

另一方面，如果您的 CI 制度只涉及运行所有可用测试的子集，例如因为您的某些测试需要很长时间才能运行，那么您可以另外使用 nightlies 来运行**所有**测试。这样可以让你及早捕捉到很多 bug，如果你不能及早捕捉它们，你至少可以在一夜之间捕捉它们。

不过，我不知道这在技术上是否仍然是 CI，因为您每次都只是在进行“部分”构建，而忽略了一些测试。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-06T16:27:59.603

在我们的组织中，夜间构建和 CI 构建有两个不同的目的。CI 构建是一个“最新代码”构建，其中单元测试按照您所期望的最后一次签入运行。我们还在 CI 构建上运行了几个代码指标。

然而，对于夜间构建，我们只包含已经通过同行评审过程并被认为可以进行测试的源代码。

这样，每晚构建始终包含“功能准备就绪”以进行测试的构建，而 CI 构建包含功能（在单元测试通过的范围内）可能尚未准备好发送到测试组的功能。

测试组专门从夜间构建中的一个而不是 CI 构建编写新的 CR，尽管这些也可用于非正式的探索性类型测试。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-06T16:16:31.390

是的，如果您有一个想要附加到构建的进程，但它会占用大量资源。例如，在我的团队中，我们在夜间构建期间运行 JTest。我们不能在白天运行它，因为：

1.  它需要很多资源，可能不可用
2.  每次完成需要4个小时

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-06T19:20:37.493

如果您有一个很好的健壮 CI 流程，那么“夜间”仍然有用。

1.  如前所述，“夜间”构建可以进行详尽的测试，也许还可以进行一些高级系统测试。端到端的东西。
2.  “夜间”构建的概念很容易被组织中的每个人理解。如果您无法将 CI 构建与其他组（例如，QA 组在敏捷方面的处理能力与 Dev 组可能不同）进行交流，那么“夜间”是一个强大而简单的概念。
3.  如果您的 nightly 是一组单独的资源，则可以单独管理它并用于切割具有软件完整性的“黄金”图像。例如，开发人员编写代码，一些开发人员无法接触的可信构建系统构建它，QA 测试黄金构建并对其进行签名。在这种情况下，夜间构建功能类似于生产构建系统。

只是一些想法。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-06T16:16:42.917

在我的专业意见中，使用夜间构建的唯一原因是构建过程需要很长时间以致无法在“合理”的时间内完成。

例如，如果您的构建过程需要 5 个小时才能完成，那么确实没有理由在签入时进行构建。

除此之外，在构建失败时尽快知道它是否会覆盖其他问题非常有价值。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-06T17:12:11.307

这取决于每个构建的目的和长度。基本上，您应该确定您想从 CI 中学习什么，并决定是否值得将资源用于运行多个构建。

在我上一份工作中，我们出于几个不同的目的使用了持续集成。

首先，我们使用它来确保存储库以及开发人员始终拥有已编译的代码版本。对于团队成员来说，没有什么比通过注释、取消注释、还原和合并来管理另一个人的破坏性更改更糟糕的了，因为一个人签入了错误的代码。为此，我们有一个无需测试或其他验证即可立即运行的构建，因此我们可以尽快知道代码是否可以安全更新。构建通常需要大约 10 分钟，并且机器在正常工作日可能运行大约 50%。这里没有生成任何文档，只是安静的通过或响亮的故障警报器。

其次，我们想尽快知道有没有违反任何规则。越快发现违规规则，就越容易修复。为此，我们有一台单独的机器来运行代码的完整构建和验证。这台机器在正常工作日每天连续运行 12-14 小时。构建的电子邮件状态已发送出去，描述了损坏的单元测试、代码合规性等。

就自动触发的构建而言，我们停在那里。在此基础上的夜间构建对我们来说似乎有点极端。但我想如果您想每天存档快照构建，您可能需要安排第三次构建，其中包含所需的额外步骤。虽然，我们确实有另一个构建打包并存档了我们的 QA 部署工件，以便快速轻松地部署，但我们只是手动触发了那个。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-07T05:14:54.047

我认为其他帖子涵盖了常见原因，例如构建过程需要“太长时间”或在 CI 构建期间必须只运行一部分测试。但还有一个政治原因。

在某些组织中，官方构建由响应最小的构建/基础架构/发布管理/SCM 团队处理。在这些情况下，您可能会让他们负责夜间构建，然后在开发之外运行 CI 构建。这样可以避免争吵，因为他们的构建仍然是“官方构建”，而您的 CI 构建会为您提供所需的反馈。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-08-27T06:56:07.723

我们有持续集成和夜间构建。它们有两个不同的目的。

我们的持续集成机制在持续集成套件下构建软件并运行单元测试。

我们的夜间构建在版本控制下标记源代码，构建软件，在夜间构建套件下运行单元测试。然后将这里构建的软件用于各种系统测试和压力测试。

我认为夜间构建的主要区别之一是系统测试。

# http - 不同浏览器中 URL 的最大长度是多少？

> ID：417142
> 
> 赞同：5345
> 
> 时间：2009-01-06T16:14:30.410
> 
> 标签：http, url, browser

不同浏览器中 URL 的最大长度是多少？浏览器之间有区别吗？

最大 URL 长度是 HTTP 规范的一部分吗？

* * *

## 回答 #1

> 赞同：5556
> 
> 时间：2009-01-06T16:22:18.443

## 简短的回答 - 2000 个字符的实际限制

如果您将 URL 保持在 2000 个字符以下，它们几乎可以在客户端和服务器软件的任何组合中工作。

如果您针对特定浏览器，请参阅下文了解有关特定限制的更多详细信息。

## 更长的答案 - 首先，标准......

[RFC 2616](http://www.faqs.org/rfcs/rfc2616.html)（超文本传输​​协议 HTTP/1.1）第 3.2.1 节说

> HTTP 协议对 URI 的长度没有任何先验限制。服务器必须能够处理它们所服务的任何资源的 URI，并且如果它们提供可以生成此类 URI 的基于 GET 的表单，则应该能够处理无限长度的 URI。如果 URI 比服务器可以处理的长（参见第 10.4.15 节），服务器应该返回 414（Request-URI Too Long）状态。

该 RFC 已被[RFC7230](https://www.rfc-editor.org/rfc/rfc7230#section-3.1.1)淘汰，这是对 HTTP/1.1 规范的更新。它包含类似的语言，但也继续建议：

> 在实践中发现了对请求行长度的各种特殊限制。建议所有 HTTP 发送方和接收方至少支持 8000 个八位字节的请求行长度。

## ...和现实

这就是*标准*所说的。*实际上*，在[botell.com](https://web.archive.org/web/20190902193246/https://boutell.com/newfaq/misc/urllength.html)上有一篇文章（链接到 Internet 存档备份）讨论了各个浏览器和服务器实现将支持的内容。执行摘要如下：

> 极长的 URL 通常是一个错误。**超过 2,000 个字符的 URL 将无法在最流行的 Web 浏览器中使用。**如果您打算让您的网站为大多数 Internet 用户服务，请不要使用它们。

（注：这是引用自*2006 年*写的一篇文章，但 2015 年 IE 的使用量下降意味着更长的 URL*确实*适用于大多数人。但是，IE 仍然有限制......）

## Internet Explorer 的限制...

[IE8 的最大 URL 长度为 2083 个字符](https://support.microsoft.com/en-us/kb/208427)，似乎[IE9 也有类似的限制](https://stackoverflow.com/questions/3721034/how-long-an-url-can-internet-explorer-9-take)。

我测试过 IE10，地址栏只接受 2083 个字符。您可以*单击*比此更长的 URL，但地址栏仍将仅显示此链接的 2083 个字符。

[IE Internals 博客上](https://blogs.msdn.microsoft.com/ieinternals/2014/08/13/url-length-limits/)有一篇不错的文章，其中介绍了一些背景知识。

有混合报告 IE11 支持更长的 URL - 请参阅下面的评论。鉴于有些人报告了问题，一般建议仍然有效。

## URL 等搜索引擎 < 2048 字符...

请注意，[站点地图协议](http://www.sitemaps.org/protocol.html)允许站点通知搜索引擎有关可用页面的信息，其 URL 中的字符数限制为 2048 个。如果您打算使用站点地图，我们已经为您确定了限制！（请参阅下面[的 Calin-Andrei Burloiu 的回答](https://stackoverflow.com/a/7056886/6521)）

从 2010 年开始，还有一些[关于搜索引擎将抓取和索引的最大 URL 长度](https://web.archive.org/web/20111110004006/http://www.seomofo.com/experiments/title-and-h1-of-this-post-but-for-the-sake-of-keyword-prominence-stuffing-im-going-to-mention-it-again-using-various-synonyms-stemmed-variations-and-of-coursea-big-fat-prominent-font-size-heres-the-stumper-that-stumped-me-what-is-the-max-number-of-chars-in-a-url-that-google-is-willing-to-crawl-and-index-for-whatever-reason-i-thought-i-had-read-somewhere-that-googles-limit-on-urls-was-255-characters-but-that-turned-out-to-be-wrong-so-maybe-i-just-made-that-number-up-the-best-answer-i-could-find-was-this-quote-from-googles-webmaster-trends-analyst-john-mueller-we-can-certainly-crawl-and-index-urls-over-1000-characters-long-but-that-doesnt-mean-that-its-a-good-practice-the-setup-for-this-experiment-is-going-to-be-pretty-simple-im-going-to-edit-the-permalink-of-this-post-to-be-really-really-long-then-im-going-to-see-if-google-indexes-it-i-might-even-see-if-yahoo-and-bing-index-iteven-though-no-one-really-cares-what-those-assholes-are-doing-url-character-limits-unrelated-to-google-the-question-now-is-how-many-characters-should-i-make-the-url-of-this-post-there-are-a-couple-of-sources-ill-reference-to-help-me-make-this-decision-the-first-is-this-quote-from-the-microsoft-support-pages-microsoft-internet-explorer-has-a-maximum-uniform-resource-locator-url-length-of-2083-characters-internet-explorer-also-has-a-maximum-path-length-of-2048-characters-this-limit-applies-to-both-post-request-and-get-request-urls-the-second-source-ill-cite-is-the-http-11-protocol-which-says-the-http-protocol-does-not-place-any-a-priori-limit-on-the-length-of-a-uri-servers-must-be-able-to-handle-the-uri-of-any-resource-they-serve-and-should-be-able-to-handle-uris-of-unbounded-length-if-they-provide-get-based-forms-that-could-generate-such-uris-a-server-should-return-414-request-uri-too-long-status-if-a-uri-is-longer.html)的研究。他们发现限制是 2047 个字符，这似乎与站点地图协议规范有关。但是，他们还发现 Google [SERP](http://en.wikipedia.org/wiki/Search_engine_results_page)工具无法处理超过 1855 个字符的 URL。

## CDN 有限制

CDN 还对 URI 长度施加限制，并`414 Too long request`在达到这些限制时返回 a，例如：

*   [快速](https://docs.fastly.com/en/guides/resource-limits#request-and-header-limits)8Kb
*   [CloudFront](https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/cloudfront-limits.html#limits-general) 8Kb
*   [CloudFlare](https://support.cloudflare.com/hc/en-us/articles/115003014512-4xx-Client-Error#code_414) 16Kb

（感谢 timrs2998 在评论中提供该信息）

## 额外的浏览器综述

我针对配置了非常大的[LimitRequestLine](https://httpd.apache.org/docs/current/mod/core.html#limitrequestline)和[LimitRequestFieldSize](https://httpd.apache.org/docs/current/mod/core.html#limitrequestfieldsize)的 Apache 2.4 服务器测试了以下内容。

```
Browser     Address bar   document.location
                          or anchor tag
------------------------------------------
Chrome          32779           >64k
Android          8192           >64k
Firefox          >64k           >64k
Safari           >64k           >64k
IE11             2047           5120
Edge 16          2047          10240 
```

另请参阅下面的 Matas Vaitkevicius 的[答案](https://stackoverflow.com/questions/417142/what-is-the-maximum-length-of-a-url-in-different-browsers/31250734#31250734)。

## 这些信息是最新的吗？

这是一个流行的问题，由于最初的研究已经有 14 年的历史，我会尽量保持最新：截至**2021 年 1 月**，该建议仍然有效。尽管 IE11 可能接受更长的 URL，但旧版 IE 安装的普遍性加上搜索引擎的限制意味着保持在 2000 个字符以下是最好的一般策略。

* * *

## 回答 #2

> 赞同：196
> 
> 时间：2012-07-18T23:12:29.953

我遇到的最长的 URL 是[数据 URL](http://en.wikipedia.org/wiki/Data_URI_scheme)

来自 Google 图片结果的示例图片 URL（11747 个字符）

```
data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBhQSERIUExQUFRUUFxcXFhQYFBQXGBgYFhkVGBkVFxUXHCYfGBojGRQVHy8gJCcpLCwsFh4xNTAqNSYrLCkBCQoKDgwOGg8PGiokHyQpLDUqKSwsLCksKSwpKSwsLCwpKSkpLCwpLCksKSwpLCkpLCwsLCkpKSwsLCwsLDQsLP/AABEIAM0A9gMBIgACEQEDEQH/xAAcAAACAgMBAQAAAAAAAAAAAAAABQQGAgMHAQj/xABTEAACAAQCBAcLBgsFBwUAAAABAgADBBESIQUGMUEHEyJRYYGRFBYyVHF0lKGxs9IjNEKS0dMXMzVSYmRypMHj8GOTo7LiJENzosLh8RVTgoPD/8QAGQEBAAMBAQAAAAAAAAAAAAAAAAECAwQF/8QAJxEAAgIBAwMEAgMAAAAAAAAAAAECEQMSITEEE0EiUWGBkfAyceH/2gAMAwEAAhEDEQA/AOiaq6q0b0NGzUlMzNTySWMiUSSZaEkkrmbw17z6LxOl9HlfDBqf8wovNpHu0hvACjvPovE6X0eV8MHefReJ0vo8r4YbwQAo7z6LxOl9HlfDB3n0XidL6PK+GG8EAKO8+i8TpfR5Xwwd59F4nS+jyvhhsTaKnX69gzGlUiCc6+FMZsMpTuBYAlj0LnFoxcuCG0ht3n0XidL6PK+GDvPovE6X0eV8MIX0jpQ8pe5SPzeKndmLFl2QuPCpMpnwV1Pg345ZuLc4DbfbG0enlJelp/ZR5EuS3959F4nS+jyvhg7z6LxOl9HlfDDCjrFmosxCSrgMLixsdmRzEb45zQUd59F4nS+jyvhg7z6LxOl9HlfDDeCAFHefReJ0vo8r4YO8+i8TpfR5Xww3ggBR3n0XidL6PK+GDvPovE6X0eV8MN4IAUd59F4nS+jyvhg7z6LxOl9HlfDDeFOsNVMlSmmI1gguRhBJ6zsispaVZWclGLkzzvPovE6X0eV8MHefReJ0vo8r4YR8HOsM6slzZk1sXyhC5KoVRsGQuTe+fRFzhGWpJkQlripIUd59F4nS+jyvhg7z6LxOl9HlfDDeCLFxR3n0XidL6PK+GDvPovE6X0eV8MTarSUuX4TAHm2nsELn1vkA/T8uA/8An1RFommbO8+i8TpfR5Xwwd59F4nS+jyvhiTRabkzckcE82w9hibeJIFPefReJ0vo8r4YO8+i8TpfR5Xww3ggDlfDJoCmk0MppVPIlsahRdJUtDbi5xsSq7LgZdEET+HL8nyvOU93OggC3an/ADCi82ke7SG8KNT/AJhRebSPdpDeACCCCACCCCAKJwqawtIpxKlmzzSF+sbD7Yaal6spTyJeWdt/PvY/pE3zig8LVYe7pSnwZZlP1XzPqMdfoyMC22WFvJHZnjoxwS8qzDG9UpG20J9YNWJVWJfGC5ltiXmB57b4cXjwuI5E2uDdmqlplloFXYP6vCys1slI5lqHmzB4SSlxlf2jsXtjXrjpjuelmMu2xAPNkbwk4M9HiZRS5r5mZdzfezE3Y9OQjFybnpR0RxKOLuy8ukNqTXymeZxTFpT3ACzVKZndfZ64sQaKRwk6qpOpjNVbTJViLb1ORB6M7xp4NdZ2mULrNbE9OxTEdpXIrfpAyjKWftatfhWbz6eMsKzY/emvZ/BcazSySzhJJb81QS3YI0S9Y5RNiSh/SFor2qMs1Lz5sw35ZFvJYAeS1oe6Y0KjSyVADKLgjo3Rjrzyw92LV1aVePa/c5tMVLSyfWKXlOEbCzIwVttiQQG6iQYrmite0s0qpWZKnyrK6lGYMdheWUBxKduwbYhauadaUKqSxvxKmYnQLG69RF+uIPBtO7parmOxLcacWZuRYYc+a149Ho5xz9P3mttjnypwyaCfrFwlyUllJAmTJrghbIbKdmJt+V72tfKGOkq7jNGs3K/FgXZcJa1gWwnMXil8LGglpml1cnkNfOxPhLmrdYuOuLdpScH0WXC4caKxHSbXjbq4QWBSh5TOWUpOM78IW8Dy2o2PPMf/ADGLTpLWWVJYIcTzCL8XLUs1ucgZAeUxTuDOr4rRkx/zS568RiHqTpRWFTOmiZMZpzDAiMxbCAADuA8pG0xwRnUYx+D0elwt4VNq+FXyXGh16ppk0SSWlzDkEmLhueYHZG/SGlicSICtiQW+G0UzT2hGrp0l3lrTy0a5UHFNcAg2YryU2biTFolSYjuSTaZ05MOPZw9t1zT+GaHpYW1VHDubkIV1c6M3ImMCu18gizC4YG9wbeyLFqhrizsJM7Nrch/zug9Iiu11VmemFAurFkyIs6nmYfbGkMjM54juAa+cewk1V00KiQjjeBlzHeIdx0nIc64cvyfK85T3c6CDhy/J8rzlPdzoIAt2p/zCi82ke7SG8KNT/mFF5tI92kN4AIIIIAIIIIA5zwvauNNlJUS1uZV1mAbcBzDdRHYY38GOuizpCU01gJ0sYVufxiDYQd7AZERfZksMCDmDkRHPNYOCWW7mZTM0lib2U5X6Bu6o7YZsc8fay+OGYSxyUtUToM6XiBFyLjaDYjyHdHONddCGkp3mynYFib3dmOYO0sY3UGh9LSrKatmX9KUjntOcStJ6lz6xQtTPmOozwnBLW/OVQXPbEYWsM1LVa+xNOaqtxBRaPmT9X1KZsLzCMyW24yScybeyHHA9plXpWpyRjkMbDeUOYbtuItmrugVpadZK+CosN+XXCHSXBtKM7j5BaRMOZaWxTM7TzdUcE05ZHkR6WLLHsdia/p+w41x0ikmjnO5AGGw6SbWA6YpvBroRxSVDlbNOYuFP/KPqj1xYU1JDlTOZpjLseY5mEdKqeSD1RZqWjWWoVRYe3yxnPEsl6/KojvaMfbg/Nsp2olUEnTpRyxHGvl2FfLleLjVTQqszEAAG5hJpjVBZr8ZLJlvzqbZ88Ytq7MmLhmuXH6TXH1RYHrjnxY82LH2tnWyfx8ozlKMpaiv6o0gqKmpmkXlODLAI2oARfrv6oXaO0BV6KqneSFm0z3xBiQcIzBuAeUBlsi+VE6TQU7OfBXM2tdjuivUWl6ytXEjLJlsMlWWJj2OwsznCMtwEel0WN9Ph7afo4d+f9ObM1OV+RRPqzpqfxZssqnYHiwTy2P03O3CN1t8W7WemEvR8xBsVR7Y5vpnVSr0a/dUh3IBzay4gDnZlXJlPNF/oXl6X0chcEY/CUMygOhIOzMi49cb9biUoasT9PC+DnqUoyxtb0JODSk43Rc1B9IzFBvvubeu0V7g802tLUzqaq5CzGPhbFm3sQ3QRsPRF+1a1IWiYmWzWP0cb4c/0L2v02jXrXweSK04yMEze6mxNufceuPMeOXpa5R6vR5owxPDmWzrjw15J+lVXFKC2w2JFrW5oJZGy47YqWh9Adz8bIEyYSrjGWYEgYTYIdwNt0LNKz6FTKOCdeYSEYTJlmNyuR35g5gWy2xST1S3NIxUVtx+C/T5eUVzTFRLl+G6qL2zYCJU6rEulZgzWOdjmRkMrxR9HFKlsU2Xju1uUSVHlF7DymKVZpdGVfpaVc4ZinyGIPddwc/6Ee6T09Yuq0glKpw/ixn0hgPbzQvH5wyB3RpwZ6tzofBlWZMm4MfWL/wAY6VHHNQtIKk4KTYuSV6cIF/bHYZZuB5I6Yu0ck/5M55w5fk+V5ynu50EHDl+T5XnKe7nQRYoW7U/5hRebSPdpDeFGp/zCi82ke7SG8AEEEEAEEYlxzxlABBBBEALQR5eAGJB7BBBABBBBEALQQXgiQVDhO0TNn0TCVclTdkG1lNwcPSL36oS6k8ItOlOkmovJmSxhJZGCtawBFhkbbiI6QVhbU6uyHNymcdEcq0aJq0uK2Zk4PVqiV3T2tcupkTJNIGnNMUqXwsstAcsbuw3bgLkwy1E0GaWlWWTf+JOZPrhrI0NLS1lvbZck2iaIylNadK2RdR3t8nsEEEULFWnSFM+ffeQD2GMpuhlIAsAo5gBlzXHkjXpCdhqnXebPboNgD2gxPefYZ9sceTaTO7FehFU10YrTHDsJt1C32RSdXp9mYc8XjWqtx0zIsss+wEbL3238m6KBTKUmLjBUre/ST7ILgv53LXO0YHF3ucss4q+l1Cmw2RapGkA6AA8q2Qio6Xzc9Bt5TviIkzqtjdq4v+105uLhZuEb7MLE2/8AjHdtHNeWvkjiuq9F8tKJWzIGud/KyC+2O2UIsijojpx8HL1D9X0UHhy/J8rzlPdzoIOHL8nyvOU93OgjQ5y3an/MKLzaR7tIbwo1P+YUXm0j3aQ3gCp8KdS0vRdSyMUYcVZlYoRedKB5S5jK+fNCXSOsLUFItTK4ppMuotULIqHrCUZCos80DAwcrcXAtvztHRHlgixAI5js7IwSlQAgKoB2gAAHqEAcb1jrp7tR90CWZz0tHMdwmFrtpCRZM7WADLdbbRHaYwaSpNyATzkA9PtzjOAPGin1MyeJkyWhc8TNaoOZJeW9mSWoxb7zkCnI8Xui4GFj6GYknuioF9wMrs/F7I0xSUW7IZUqXWGeJrWayvNWZLVmk2aXNK2/GNxjDDcjixbMb7xP1O0g1qWWJqTVMi7KoT5EyxLCqcJJucTA4t6mwEO//QDcHuifcbDeTl5PkozpdCYGDCdOyIJHyVjbcbSwbdcdE8uOUaVfv0VpjSFGtrgUNUS2G0qYQwYoQQpIswIINwN8N4iV9FxoAxug34cGfQcStHLFpSVlytz9IzhMKypwWWJlPJQBUfKbLU8YHa5Yi5tckZb4j6R1pmJIQ4ysxePJ+bqr8U8xFznEXJ4u5CZjF5IsI0EfGKjtlbtn+6jFtXyds+efKZJ27dsqOpTx7N1+/RSmIpeskwvKPGqWeZNU02BclSXOZGvbGL8WhF9uI2vEGVrTUMFJmqqsoZrzKLjFY4TgRceG1i1+Ms1lFhe8WQaorxvG8fUl+czVIGWG4QphBsSLgXzPOY3HVz+3n/4Pb+Ki/cwrwvwKYxoJuKWjXJxKpuy4WNwDcr9E9EbzGumk4VClmaw8JrXPSbAC/VG0xwMuUzTdVhaod85stxxEsz5kktLCI15SrcTH4zGNhvax6d0zSk/C7tNVENS8gHAlpUtHmDjGZrgnkgXPJswyvnDifoQs2Ljp4zuADK5PQt5ZIGXPGJ0ESCO6J9t4vK9nFR1KcKVlXYiXWp0l1Reah4uU5kTCFHGspnDGoGT5LLyUWj06wzcb2nSrrPWWJBCg4GWXd3+kApcm4ysM7xP0nSS5CY5lTPAXwR8iTnuUcXHONIaVeYZhQnAz48LsCS1gCWZFG4DLYIs8mKm0v38EVItNPrJLngo08PPWYFw/I3HJJKq0o2I6Cb7Lw7Zi6qVwm4yxXtfdsjiOg+TxyDkTVmNMA27TiRhzi/tMdH1a1pWalm5MxTy0/wCpT+bv6I8zqPVLUkd2HZUT5GlFbkTJ3EzACcJkckEEA4XPhWvz3is611AViEm8cxa2Li1VQNoNx4RzbZvt5YtdUVmqWlulmzuAHUkb7g7coqWkKeWXzmYiLliLBcs7WG0xlqS2OpRT3Na4ZUlXxctLn9okWAPRe3ZCCvqklhTNJCKQXa1zcnM2G2NldX3O3krdid2UUjTmluOLAeABl0n84xeKt2c8nsz6C1Nl0tQomSJsqYciQrAsLD6S7Rs5ovKCwA5o+KqKodGDS2ZGGYZWKkeQjOOj6tcLmkaeweYJ6fmzRdrc3GDPtvHSculs6Xw5fk+V5ynu50EUzhA4S5VdQy0Mt5UxZyuRcMpASaDZh0sNoggZ7nYdT/mFF5tI92kR6/TdQKlpEiTLmYZaTCzzTL8MstvAN/AMSNT/AJhRebSPdpEel/KlR5tI95OgSed31/itP6UfuoO76/xWn9KP3UWCCAK/3fX+K0/pR+6g7vr/ABWn9KP3UWCCAK/3fX+K0/pR+6g7vr/Faf0o/dRYIIAr/d9f4rT+lH7qDu+v8Vp/Sj91FgggCv8Ad9f4rT+lH7qDu+v8Vp/Sj91FgggCv931/itP6UfuoO76/wAVp/Sj91FgggCv931/itP6UfuoO76/xWn9KP3UWCCAK+dIV/itP6UfuoS13CBOlXvJp2I2hKh2PqlW9cMtfdYVppABcIZmWInYv0j6wOuOYStYqViAJ8u53YhEWTRbDwutn/swv0zPblC6o4VKt/ASVLHkZj2kj2QrqKVZq4kYXGxgb9ttxiFTycQOQBU2ZeY/YYgskGlNM1E9g05yencOgAbI1Sap9jHLyf1eJiy4yFOPsgSJNJ6NLMsxDZl2Hy7jDvRmqM+fKE2eDIyay3znZHaV5UuWd9uVDLQmjONmiw5KWLeXaF8tob6114lSWNwMKk3PPuvHPknXB1YYXyc/07rQaGR3PT2AxNeXyisoG1wrsLsCdzZiKgNcJh2gHovYeqOoap6ckv8AIEKzTXyVwrBhhzOEjZySOqKPwlavJIrDxUsKjqrBUFgpO0gbBfmhjab3W5pkUorZ7COq0tMnrhICrfwVvn+0d8QahcK9JyESqGUQGFiLgWvYbNufkiVRaPUsCflWO4eCv2xvwcz3FujtFO1ssosFPo3CNkOJFOBlbsiZLpgd1rwsrwioaelWlL+2PY0ETdcZGBR+0PY0EKIs+kdT/mFF5tI92kZpoxlq5s8FSHlS5YXO4wM7Xv04/VGGp/zCi82ke7SG8XMTVd+Ze0/ZBd+Ze0/ZG2CANV35l7T9kF35l7T9kbYIA1XfmXtP2QXfmXtP2RtggDVd+Ze0/ZBd+Ze0/ZG2CANV35l7T9kF35l7T9kbYIA1XfmXtP2QXfmXtP2RtggDVifmXtP2QYn5l7T9kRNJaWEsWGbc3N0mEFRpac30iP2cvXFJSSLxg5FU4SaHumt4uaGwy5ahbbATyiT1xUX0bKkgyp8mXMlm9pgQXHltmLDeIuWmtDGYSxuzHeWN8umKvpCna6WDq6XIzaYrdDKcz5RcjmMUU0zTtyiRdH6O7lzkkGXcG5bYpOV3GWG+x7W3GxhnUPgmJNwkKxEuYDbYckfLI2YjPpiLo1iclFjmyW5UsN9JMW5W3qbEcwiZUUSsmFwVDDlIp2E9MaIqe1MmxjCXTTLE2sADmSPZv5+qNrTwtibCwsOoWHsjyTpEXvfqiBwXvRdMsmSoWxFr4ucnMt1xzzhM0gWlcWubTGw+u/8ACJtJrM8pWkk5LmpP5jZqOrZ1QvKrPmLMfwUuR0k9EcMnUj0scE037lU1So6iRWUj4bAzFS+f0iRn0ZmLVwgU6zJs0XyliQo8pdsgfIYx03VJLVSHCFSCrE2sQdsVzSOvTOWAXjQxQsxGHOXe2Dy74v6pu0iXogqbNOlKWQJqSZbYjblqc1vuGLn6Ilyacy7XXaPCGy/SBshNoLRxLYzfEST2xdaWVlHStlRwTlbtI1UtM3QOke2J8pAvSeeIk2fhuu4WYeQm3qJ9cbUfKJM2VnXcEoDb6Y/ytHkb9dE+QX/iL/lf7I9iSD6F1P8AmFF5tI92kN4Uan/MKLzaR7tIbxczCCCCACCCCACCCCACCCCACCCCACNNXUiWjMdwjdFd1hqiXWXuAuf66orJ0rLRVuhepaYxZjtziSKYAXMFNa1zYdMJtKa70Us4GnYmzylqz7OlRaOa7Ot7bInT7bB64q+nESxuCNljzEbxzQ6k10uYgmoxKkb1IPWDsjnusGn509mEviJUtTYzJhzJ/rdaKqLZdyomaO0gXuv0lyY725mJ3kwweVgBLbeaKlq5UOs+7MrclswLBh/2MWOqqMUdEeKOaS32E+kKs3MRJFbYxhpR7XhUk/OBdIbaxVWGUk4C5QlWGzJtnrv2xWDrZUNbDhHNlf2xYhVo0tkmHJhY9Ytfq2xTaeyTCh2gkQUU92Rqa8ktKabPcNNYsen+Aiy0ur4w7B/XRGjRbDKLJStEsiyFQ6NwQ2krG1ADGdoEEGvTIE7M1bnwttHq7QIjUk3aMsjbKJ1QpIOz/wAZ/wAIU0rWII8Ell+rYr/yMo6oENETXH8Qv/EX/LMgjVrY/wAiv/EHsmQRJU+iNT/mFF5tI92kN4Uan/MKLzaR7tIbxczCCCCACCCCACCCCACCCCACCCCAI2ktIJIlTJsw2SWpZj0DmG8nZ1xQ9FV06oxzZieEz2IZWUKLALcbCM8vth5wiOO5kUnJp0rF0hG4wr03wWhZQYjLliWyqgVsa2uSLckDPLbc9cYZW+DpwJNskzKdZkoq+ak3YZ5gbsorGlqKo5HEy5EhA2fJVppG4g7Fi20RHqjHS6y5aGY27dvJOQHbGG5vSIFIjvSGXNILMpBPSRutHJ6PRGF2lsFLKx8LM7TZgLx12bWGWoxAGwJYXOX6KhRY+XojmWtrsanjVTApCEc9xe/tjSNoidPcgz6cSXuOSDtPSdvrhgKvLtiLpar42QjsAM8+Y2F8vqwpl1eIReBSaR7paqGcV6dXc0SdKV6DInEfzR/HdCGfVYtgsPXGiRk5JEv/ANQzzMRqipxOGG3n540IhOzOJlLo5rgmJpGdtj3RM05RaqJ9kJNG0NgMosFLIirLDKSY3mNUhY3QLGphCgyQFmS+kzFO84Lkj6hb6sOmtzQs0rNw4XIyUi/kG0fVxwIsrGtE+8hel1PYr/bBGjWRMMsp+ZNw9gbP2QRJU+mNT/mFF5tI92kN4Uan/MKLzaR7tIbxczCCCCACCCCACCCCACCCCACCMZkwKCTsGZPMBHL9M8KFUj4pcgcRnZsLM5A2Ne4HVaIbolKyx8J8g9xiYL/IzEc/snkseoNfqip6L00qSprXJIQ2A3ndaPJuvU6rknip6EOpBUykZTfapG7LKKVU6Sm0qEPJJVd6E7M8yG2Z9MUmlI0x3F2dXoaobbixF73sPXEfSFfLqMBluk0SHuwVgVBIKjEwyyN8oV6BoDOQvjIp3QsQcjY58l/orbbeEentEzzTzZVCVlyULTLl+XMxMzcmwyPhZnIgC0ctNbNnb/LeiyS9L8ZMeXxb4EyLS2DMx/NXZbrMUrXKRLIPFpMF7hnd7ta4soW5z3E7umHupFSkuQsmbMCTAobDiF2VxcOrHwgYg61PJlqZha43AsLX3xZNJktbVRWa2eeIKW8HG5G+wTPsAikVWlGa4GQ9f/aGtVrNdjgBINw99hUixUDpBOcKe4jcb75jMEkbjtjoiqVnHOduiOkgnZEyRoy5zhjQ0UP6XReyLWRSFtBoQc0O5OhgAMomU1HhhnJl5RWwQaaitu2QwlSbRmsrbG1RAbGKrAWj1oxw5wDMTOA3wk07Xji2sCfZmCP4w5NGp2mItfopDLdQCSykDywRUpes98KEjNlkMfKZVifrAwRt1sQ8XTk75YHUjTQPbBFgfSup/wAwovNpHu0hvCjU/wCYUXm0j3aQ3ixmEEEEAEEEEAEEEEAER6yvSULu4UdJ9g2mN5jmGuPGPVzFLELkMtoWwyHNe+ZgBjrBryZyTJVKBYgo01mK2vkQoCm5t2RU6PRzISWfFcWwm5C8+Em1weYqIYSKUKBYWAHJXmHP5Y3NLvbCL+zrivJZbFfp9XpSzMa3XI4jiwLYZ4mUc3PD/VWZJqJU2fhunGFUxC+JJdhjI/Sa58kIeEClcUE0qxBDIZgX/wBsmzD2Hqir6P14aRSKktOQOTibJSeYWzYxnkTpJHRhatuTOx6fnKlFPGXKlMNmXLFrW3ix2RQNBz5lLo6peobGzLxcpDbGoIIQdNy+Q6Ir0jXPSFUi8iW0sEZEEXw7iQbndDebo+qqQHnTBLtmqyltZtxLG5yO6MtEmzdZIRWwv4SdFsJdMLANT06BiLfo5AjMi5aKJS6Omzdocrz5ke2LbP1QdzypztuN2LXt5TzwxotD8UAAY2itKowm9TtCSi1WVVzxXPOsZzdXbC46ujp6IsoQ3zjY8sdkWszoq66OZTcE23DbDPR1Q+NFZMiwBN7WB3wyMiMRJOVjY559Fje3qiCRhS4XF12XI+qbRLWTCXV2vExZgAsVc3XmxAW9Sw8R4FWzUVzjLDGUyMWgQYPGlo2PsjVigSjB0J2Rom07WzcjyRumOd0RZxO9rQQKjrI5NNTm98M2ol59Dlh6ngjTrBOvSfs1Tj60tWv1wRcg+ntT/mFF5tI92kN4Uan/ADCi82ke7SG8SZhBBBABBBBABBBBABFA1vlWqybZlFNycuY5b90X+KrrzoZ5qpMlDE8u912YlO4Hnv7YEoqZmDfnEWv0sJY5TLLHSQIrGmdYpiXUypyNzlMI6nYgdkUvSemHxZBAx2G/GOSeYnZFbL0W3TGvKKpwqZl7i7AhSDlaxzYGOe1pdwGK4VXJVGxbnd1mL5onUc4VadczGFyTc2vu6IZay6qqKOYFAxWuOrOJJ2o91V0ZhkJ6uuLEq2hdqNVcbRym3qMDeVSYczEteIoiyvTB7THkoA57hGufMyyjLQrpMqJcqYWCvcEqM72JFtu+Ktl0nZJ4sWuRGlpUM63Qc1GAU4kPgllIbfttcbo1Po6YQMLSzf8AauOgjdGfcj7m3Zn7EBTESsrOLRiou2xRzsxFvYYw0hPmyWImIR+kMwemE1Fp5nntLSWrPiBR5hISWqqbuQNubHfuEXW/BjK4umM9ELMlTFM0j5RgpFrZkgAk7znFmEUDTelpTVEsS2edxIQqEyDzr3ZjkbKMrW23i26PrnYIJoCzGUtYAgXv4Iub3sR5bGJoqT5hyjXijya2XZ7Y1loFj2Y8aXaB22xGaZeBVmUyZEOeyjMtGUx4jzp6jdc3ggVTTDA08y17d0j3WUEeaRe8qcD4wp/wzBFyD6m1P+YUXm0j3aQ3jjOhOGviaanldyYuLlS0xcfa+BFW9uKyvbniZ+Hn9S/eP5USZnWoI5L+Hn9S/eP5UH4ef1L94/lQB1qCOS/h5/Uv3j+VB+Hn9S/eP5UAdagjkv4ef1L94/lQfh5/Uv3j+VAHWo8ZARYxyb8PP6l+8fyoPw8/qX7x/KgDoOldV5M9SrorA7mAI7DHNtIcGcmlq+OC3VjdUOxWHN0b7RI/D1+pfvH8qEmsHDDxzJelsFGQ4++Z3/i4EofvttGGk5eKWR0X7BFK/CaMV+5z/fD7uMn4T/1c8344fdwZayZwZvZamUfozbjri21Y5LdAMcr0JrqJFRNdZJIbavGW38+Dp5od1PCeGVh3MRcH/fX/APziEHyTpi5eS0RtXah0r5BlhSWYpyycIDixPJzBtCl9eBhtxG3+1/0QrbWrlAqjKQRZhMsR0g4cjGbWxrF0z6CSVMBPGFDllZCvPvJN4rFU6hyN4Ym4y6M4rVNwrpLyWkbmN6t3v9dDCbTPCIZkxmEnDls4y/8A0COVwZ3RypeS+mSk9XJyFsIJ9ov0xzuroFxvLa112dKnMRjo3XtsT4pZZQQQvGWtl0qcoX6w61ibMSYsoowGE/KAgjIj6A2XMbYk06Ms8oyjZIoQZFwlwp2hSUcdIcZnyHKM9I6XqJeAy5gmS3ORmAYwwzKO4355c8KH1iuPxeY34/8ATEd9NXlzUKZTBfwvBZSLMMtucbnEdGpaovKRmtcjlW2XGREeu0U3R+t+GWimVeyi54y1znnbDG5td8/xJ/vB8ERRNloZo0WiuNrt/Y/4n+iPF1z/ALL/ABP9MKILCZF9sApQd1+mESa4DfJJ/wDst/0RtbXUW/En+9/0QLEPT1EqSph3mel/7t4Ig6X0+JqOOLteYreHfYrC3g9MeRJFH//Z 
```

* * *

## 回答 #3

> 赞同：189
> 
> 时间：2015-07-06T16:14:46.510

我编写了这个测试，它不断添加`'a'`参数，直到浏览器失败

**C#部分：**

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult ParamTest(string x)
{
    ViewBag.TestLength = 0;
    if (!string.IsNullOrEmpty(x))
    {
        System.IO.File.WriteAllLines("c:/result.txt",
                       new[] {Request.UserAgent, x.Length.ToString()});
        ViewBag.TestLength = x.Length + 1;
    }

    return View();
} 
```

**看法：**

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<script type="text/javascript">
    $(function() {
        var text = "a";
        for (var i = 0; i < parseInt(@ViewBag.TestLength)-1; i++) {
            text += "a";
        }

        document.location.href = "http://localhost:50766/Home/ParamTest?x=" + text;
    });
</script> 
```

**第1部分**

在 Chrome 上我得到：

```
Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36
2046 
```

然后它爆发了：

> HTTP 错误 404.15 - 未找到 请求过滤模块配置为拒绝查询字符串过长的请求。

在 Internet Explorer 8 和 Firefox 上相同

```
Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E)
2046

Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0
2046 
```

**第2部分**

我进入了简单模式，并为 IISExpress和设置[添加了额外的限制](https://stackoverflow.com/questions/11636386/how-to-configure-the-web-config-to-allow-requests-of-any-length) 。`applicationhost.config``web.config``maxQueryStringLength="32768"`

```
Chrome failed with message 'Bad Request - Request Too Long

HTTP Error 400\. The size of the request headers is too long. 
```

在 7744 个字符之后。

```
Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36
7744 
```

**第三部分**

[添加](http://www.iis.net/configreference/system.webserver/security/requestfiltering/requestlimits/headerlimits)

```
<headerLimits>
    <add header="Content-type" sizeLimit="32768" />
</headerLimits> 
```

这根本没有帮助。我最终决定使用 fiddler 从标题中删除引用者。

```
static function OnBeforeRequest(oSession: Session) {
    if (oSession.url.Contains("localhost:50766")) {
        oSession.RequestHeaders.Remove("Referer");
    } 
```

做得很好。

***Chrome：***达到 15613 个字符。（我猜这是 IIS 的 16K 限制）

它再次失败了：

```
<BODY><h2>Bad Request - Request Too Long</h2>
<hr><p>HTTP Error 400\. The size of the request headers is too long.</p>

Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36
15613 
```

***火狐：***

```
Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0
15708 
```

***Internet Explorer 8***因 iexplore.exe 崩溃而失败。

![在此处输入图像描述](https://i.stack.imgur.com/nF4av.png)

2505年后

```
Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E)
2505 
```

***安卓模拟器***

```
Mozilla/5.0 (Linux; Android 5.1; Android SDK built for x86 Build/LKY45) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/39.0.0.0 Mobile Safari/537.36
7377 
```

***互联网浏览器 11***

```
Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C)
4043 
```

***互联网浏览器 10***

```
Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/6.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C)
4043 
```

***互联网浏览器 9***

```
Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)
4043 
```

* * *

## 回答 #4

> 赞同：168
> 
> 时间：2009-01-06T16:18:10.387

*[WWW 常见问题解答：URL 的最大长度是多少？](https://web.archive.org/web/20180308145804/http://www.boutell.com/newfaq/misc/urllength.html)*基于经验测试和研究有自己的答案。简短的回答是超过 2048 个字符会使 Internet Explorer 不开心，因此这是您应该使用的限制。请参阅页面以获得长答案。

* * *

## 回答 #5

> 赞同：105
> 
> 时间：2010-08-05T10:17:22.530

实际上没有通用的最大 URL 长度。最大长度仅取决于客户端浏览器选择支持的内容，差异很大。2,083 限制仅存在于 Internet Explorer（7.0 之前的所有版本）中。Firefox 和 Safari 的最大长度似乎是无限的，尽管 URL 达到大约 65,000 个字符时会出现不稳定。Opera 似乎没有任何最大 URL 长度，并且在极长的长度下也不会受到不稳定的影响。

* * *

## 回答 #6

> 赞同：100
> 
> 时间：2016-06-27T06:49:20.410

在 Apple 平台 (iOS/macOS/tvOS/watchOS) 上，限制可能是**2 GB**长的 URL 方案，如[Swift 源代码中的此评论](https://github.com/apple/swift-corelibs-foundation/blob/b23dc8e249987442811e9e0097c326d7083784ac/CoreFoundation/URL.subproj/CFURLComponents_URIParser.c#L708)所示：

> ```
> // Make sure the URL string isn't too long.
> // We're limiting it to 2GB for backwards compatibility with 32-bit executables using NS/CFURL
> if ( (urlStringLength > 0) && (urlStringLength <= INT_MAX) )
> {
> ... 
> ```

* * *

在 iOS 上，我已经测试并确认即使是 300+ MB 长的 URL 也可以接受。你可以在 Objective-C 中尝试这样长的 URL：

```
NSString *path = [@"a:" stringByPaddingToLength:314572800 withString:@"a" startingAtIndex:0];
NSString *js = [NSString stringWithFormat:@"window.location.href = \"%@\";", path];
[self.webView stringByEvaluatingJavaScriptFromString:js]; 
```

并抓住它是否成功：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    NSLog(@"length: %@", @(request.URL.absoluteString.length));
    return YES;
} 
```

* * *

## 回答 #7

> 赞同：72
> 
> 时间：2009-01-06T16:20:51.303

[URI RFC](https://www.rfc-editor.org/rfc/rfc3986) （其中URL 是一个子集）没有定义最大长度，但是，它确实*建议*URI 的主机名部分（如果适用）的长度不超过 255 个字符：

> URI 生产者应该使用符合 DNS 语法的名称，即使 DNS 的使用不是很明显，并且应该将这些名称的长度限制为不超过 255 个字符。

不过，正如其他帖子中所指出的，某些浏览器对 URL 的长度有实际限制。

* * *

## 回答 #8

> 赞同：56
> 
> 时间：2009-01-06T16:26:32.367

[HTTP 1.1 规范](http://www.ietf.org/rfc/rfc2616.txt)说：

> HTTP 中的 URI 可以以绝对形式表示，也可以相对于某些
> 已知的基本 URI [11] 表示，具体取决于它们的使用上下文。这两种
> 形式的区别在于绝对 URI 总是
> 以方案名称开头，后跟冒号。有关
> URL 语法和语义的明确信息，请参阅“统一资源标识符 (URI)：通用语法和语义”，RFC 2396 [42]（替换 RFC 1738 [4] 和 RFC 1808 [11]）。本规范采用了该规范中“URI-reference”、“absoluteURI”、“relativeURI”、“port”、
> “host”、“abs_path”、“rel_path”和“authority”的
> 定义。
> 
>  **HTTP 协议对URI的长度没有任何先验限制。服务器必须能够处理它们所服务的任何资源的 URI，并且应该能够处理无限长度的 URI，如果它们提供可以生成此类 URI 的基于 GET 的表单。***服务器应该返回 414（请求 URI 太长）如果 URI 长于服务器可以处理的长度，则状态（请参阅第 10.4.15 节）。
> 
> 注意：服务器应该谨慎对待超过 255 字节的 URI 长度，因为一些较旧的客户端或代理实现可能无法正确支持这些长度。

正如@Brian 所提到的，HTTP 客户端（例如浏览器）可能有自己的限制，而 HTTP 服务器将有不同的限制。

* * *

## 回答 #9

> 赞同：48
> 
> 时间：2010-05-26T16:18:39.207

[Microsoft 支持](http://support.microsoft.com/kb/208427/EN-US)说“Internet Explorer 中的最大 URL 长度为 2,083 个字符”。

IE 的 URL 长度比这更长。Firefox 似乎可以很好地处理 >4k 字符。

* * *

## 回答 #10

> 赞同：40
> 
> 时间：2013-01-08T00:38:38.120

在UI Jakob Nielsen 推荐[的 URL 中：](http://www.nngroup.com/articles/url-as-ui/)

> 当用户想要相互推荐网页时，Web 的社交界面依赖于电子邮件，而电子邮件是用户访问新网站的第二常见方式（搜索引擎是最常见的）：确保您网站上的所有 URL站点的长度少于 78 个字符，因此它们不会换行。

这不是最大值，但如果您希望共享 URL，我会认为这是一个实际的最大值。

* * *

## 回答 #11

> 赞同：37
> 
> 时间：2011-08-14T12:50:25.377

[站点地图协议](http://www.sitemaps.org/)是网站管理员向搜索引擎通知其网站上的页面的一种方式（Google 在网站管理员工具中也使用此协议），支持少于 2048 个字符的 URL。因此，如果您打算将此功能用于搜索引擎优化，请考虑到这一点。

* * *

## 回答 #12

> 赞同：20
> 
> 时间：2013-07-23T23:17:02.387

ASP.NET 2 和 SQL Server 报告服务 2005 的限制为 2028。我发现这一点很难，我的动态 URL 生成器不会将某些参数传递给超出该点的报告。这是在 Internet Explorer 8 下。

* * *

## 回答 #13

> 赞同：19
> 
> 时间：2016-05-04T12:23:54.213

为什么 Internet Explorer 的限制只有 2K，而 IIS 的限制是 16K？我不认为这是有道理的。

所以我想开始一个关于 Ajax 请求 URL 大小限制的实验。

我已经设置了我的 Tomcat HTTP 连接器的 maxHttpHeaderSize="1048576"。并准备了一个很长的网址。

然后我发送一个带有长 URL 的请求，如下所示：

```
var url="/ajax/url-length.jsp";
jQuery.ajax(url,{data:{q:"0".repeat(1048000-url.length-4)}}); 
```

jQuery 报告完成。Tomcat 报告请求的 URL 为 1048015 字节。它使用 Chrome 50 和 Internet Explorer 11 进行了测试。

因此，Web 浏览器在发送 Ajax 请求时不会故意截断或限制您的 URL。

* * *

## 回答 #14

> 赞同：16
> 
> 时间：2013-08-28T10:11:17.850

限制请求行指令设置 URL 的最大长度。默认情况下，它设置为 8190，这为您提供了很大的空间。然而其他服务器和一些浏览器，则更多地限制了长度。

由于所有参数都在 URL 行中传递，因此隐藏字段密码中的项目当然也会显示在 URL 中。这两款手机都不应该用于真正的安全措施，充其量只能被视为表面安全。

* * *

## 回答 #15

> 赞同：12
> 
> 时间：2014-12-14T19:56:30.163

看来 Chrome 至少提高了这个限制。我将 20,000 个字符粘贴到小书签中，然后它就接受了。

* * *

## 回答 #16

> 赞同：12
> 
> 时间：2015-01-15T02:54:42.247

我有使用 SharePoint 2007、2010 的经验，在这种情况下，您可以从服务器端创建的 URL 长度是有限的，因此它主要取决于，1）客户端（浏览器、版本和操作系统）和 2）服务器技术、IIS、Apache 等。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2019-09-21T07:09:02.963

根据 HTTP 规范，对 URL 的长度没有限制。将您的网址保持在 2048 个字符以下；这将确保 URL 在所有客户端和服务器配置中都有效。此外，搜索引擎喜欢将 URL 保持在大约 2000 个字符以下。

# soap - 如何编写 WSDL 文件以接受任意 SOAP 标头？

> ID：417145
> 
> 赞同：0
> 
> 时间：2009-01-06T16:14:52.860
> 
> 标签：soap, wsdl

我有一个客户端想要将大量 SOAP 标头字段发送到我的 Web 服务。我唯一需要对这些值做的就是将它们反映回来。

处理这个问题的正确方法是什么？他们希望我在 WSDL 中定义它们中的每一个，但它们非常具体，对任何其他客户都没有任何意义。

我有一些代码可以简单地拦截请求并将标头复制回响应中，但我不知道如何在 WSDL 中处理它。将它们简单地排除在外是否合法？或者说“给我任何东西，我会寄回去”的通用方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-06T17:47:01.923

至少在[WSDL 1.1](http://www.w3.org/TR/wsdl#_soap:header)中，不需要列出 WSDL 文件中的所有标题：

> 没有必要使用soap:header 详尽地列出出现在SOAP 信封中的所有标头。例如，WSDL 的扩展（参见第 2.1.3 节）可能意味着应该将特定的标头添加到实际的有效负载中，并且不需要在此处列出这些标头。

我在 WSDL 2.0 规范中找不到相应的部分，但我认为这不会改变。

# c# - 需要将基于 C++ dll/h/lib/xml/exe 的 SDK“打包”到 COM 中以在 C# 2.0 项目中使用

> ID：417146
> 
> 赞同：1
> 
> 时间：2009-01-06T16:15:30.627
> 
> 标签：c#, c++, com, object

我刚拿到一个由 C++ dll、lib、exe 和各种 .h 文件组成的 SDK。我认为它适用于 C++ 开发人员。他们随文档提供的示例项目都是用 C++ 编写的。我可以使用 Visual Studio 8 (2005) 启动它们并运行它们。他们确实像宣传的那样控制设备。但是，需要使用的项目在 C# .Net 2.0 中，这是不可更改的。

我的老板是一名 C++ 开发人员，他说我需要做的就是将它编译为 COM 对象，然后将 COM 对象导入到我的 C# 解决方案中。我的老板说，将 SDK 作为 COM 对象“包装”起来应该不到一个小时，即使对我来说，即使对 C++ 编译一无所知。

我以前在 C# 解决方案中使用过 COM 对象，所以一旦完成，我就可以从那里继续，没有问题。

但是，我不知道如何从 2 个 .dll 文件、1 个 .exe、1 个 .lib 文件、1 个 .xml 文件和 12 个 .h 文件中创建 COM 对象。是否有资源可以告诉我如何才能实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T16:44:08.400

> 我的老板是一名 C++ 开发人员，他说我需要做的就是将它编译为 COM 对象，然后将 COM 对象导入到我的 C# 解决方案中。

确实如此，**但是**将其编译为 COM 对象是“困难的”（我的意思是您不能这样做），除非它已经实现了 COM API（如果没有，那么您需要先实现 COM API您可以将其构建为 COM 对象）。

有一些书籍（例如*Essential COM*）解释了如何使用 C++ 创建 COM 对象，但这并不重要（对于构建 COM 对象，可能有比*Essential COM*更好的书籍，以及比 C++ 更好/更简单的工具）。

我认为你和/或你的老板有 3 个选择：

1.  要求供应商将它们作为 COM 对象提供给您
2.  设计一个封装 SDK API 的 COM API。创建一个导出此 API 的 COM 项目（使用您选择的语言）。通过调用底层 SDK 方法来实现这些 API。要做到这一点，您可能需要了解 C++ 的人，或者愿意在这个项目上花费比“一个小时”更长的时间。
3.  忘记使用 COM；相反，将 SDK 构建为 DLL，并使用 PInvoke 从 .NET 代码中调用它。

> 我的老板说，将 SDK 作为 COM 对象“包装”起来应该不到一个小时，即使对我来说，即使对 C++ 编译一无所知。

根据你所说的，我不知道有什么办法可以做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T18:43:16.710

告诉你的老板，如果他不到一个小时就可以完成，他当然应该这样做：这样可以更有效地利用你的时间。

我还建议使用 ATL（不使用属性），但如果您没有经验，这可能需要一些时间才能完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T16:36:48.180

> 我的老板说，将 SDK 作为 COM 对象“包装”起来应该不到一个小时，即使对我来说，即使对 C++ 编译一无所知。

这对于经验丰富的 C++/COM 开发人员可能是正确的，但对于初学者则不然。我认为你最好的选择是使用 ATL。看看[MSDN 教程](http://msdn.microsoft.com/en-us/library/599w5e7x(VS.71).aspx)。

并且*不要*使用属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T16:41:44.317

这并不能完全回答您的问题，但是...

一种替代尝试创建 COM 对象的选择是使用 P/Invoke 并仅调用 DLL 中的方法。

[MSDN 论坛上的这个线程](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/8badce0e-9e71-4b7e-977f-c3849e3ebba4/)记录了如何使用 P/Invoke 制作 DLL 来调用。

当然，如果您需要访问整个类（并创建所述对象的实例），这将无济于事。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T16:57:12.087

代码为您编译和运行很好。也就是说，假设您可以在一小时内完成此操作是完全不公平的。

您是否检查过 Visual Studio 实际构建的内容。它可能已经在构建 COM 对象。

调查代码是如何被调用的。我假设您有一个可以运行以测试代码的 .exe。在 VC++ 调试器中逐步执行此操作（它与调试 C# 代码非常相似）并尝试识别与您的文档/期望匹配的任何 API 调用。如果您尝试走 P/Invoke 路线，这些知识将很有帮助。

其他需要考虑的是[SWIG](http://www.swig.org/Doc1.3/CSharp.html)。这通常由 Python 开发人员用来包装 C/C++ 代码并为 C# 提供一些支持。

对于有经验的 C++ 开发人员来说，托管 C++ 路线可能更可取，因为除了最简单的代码之外，您需要了解很多关于内存分配的知识。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T20:33:51.870

我（嗯，真的是我的领导和我）将首先尝试对公司提供的 SDK dll 使用 p/Invoke（通过 System.Runtime.InteropServices 的 DllImport 功能）。我会让你知道情况如何。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-06T16:29:13.983

我认为您真正想要/需要的是 C++/CLI，这样您就可以直接将它们构建到托管程序集中。这个想法是你编写一个非常简单的包装器，看起来像是 C# 和 C++ 之间的一种交叉，然后它会完成其余的工作。

# java - 如何通过环境变量设置 Java 的最小和最大堆大小？

> ID：417152
> 
> 赞同：87
> 
> 时间：2009-01-06T16:16:38.503
> 
> 标签：java, environment-variables, heap-memory

如何通过环境变量设置 Java 的最小和最大堆大小？

我知道在启动 java 时可以设置堆大小，但我想通过我服务器上的环境变量来调整它。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-01-06T16:32:34.243

你不能直接使用环境变量来做到这一点。您需要使用传递给 java 命令的一组“非标准”选项。运行：java -X 了解详情。您正在寻找的选项是 -Xmx 和 -Xms （这是“初始”堆大小，所以可能是您正在寻找的。）

像 Ant 或 Tomcat 这样的一些产品可能带有一个查找 JAVA_OPTS 环境变量的批处理脚本，但它不是 Java 运行时的一部分。如果您使用的是其中一种产品，则可以将变量设置为：

```
set JAVA_OPTS="-Xms128m -Xmx256m" 
```

您也可以使用自己的命令行来采用这种方法，例如：

```
set JAVA_OPTS="-Xms128m -Xmx256m"  
java ${JAVA_OPTS} MyClass 
```

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2013-07-12T11:11:03.783

如果您想要任何`java`进程，而不仅仅是 ant 或 Tomcat，来选择`-Xmx`使用环境变量之类的选项`_JAVA_OPTIONS`。

在 bash 中：`export _JAVA_OPTIONS="-Xmx1g"`

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-10-04T08:18:14.890

实际上，有一种方法可以通过环境变量为 Sun 的 JVM 设置全局默认值。

请参阅[如何设置 java 系统属性，使其在我启动 JVM 时有效，而无需将其添加到命令行参数](https://stackoverflow.com/questions/12577437/how-to-set-a-java-system-property-so-that-it-is-effective-whenever-i-start-jvm-w)。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2019-11-08T02:31:53.800

您可以使用`JAVA_TOOL_OPTIONS`.

例子：

```
export JAVA_TOOL_OPTIONS=-Xmx512m 
```

[在一些评论和另一个答案](https://stackoverflow.com/a/40736904/2041863)中已经提到过。

OP的问题很老了，但由于它是该问题的第一个谷歌结果，我想为了清楚起见我会在这里添加答案。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-01-06T16:21:49.570

你不能使用环境变量来做到这一点。它是通过“非标准”选项完成的。运行：`java -X`了解详情。您正在寻找的选项是`-Xmx`和`-Xms`（这是“初始”堆大小，所以可能是您正在寻找的。）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-06T16:26:52.197

我认为您唯一的选择是将 java 包装在一个脚本中，该脚本将环境变量替换为命令行

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-02-18T15:55:28.260

几点注意事项：

1.  Apache ant 对 JAVA_OPTS 一无所知，而 Tomcat 的启动脚本则知道。对于 Apache ant，使用 ANT_OPTS 来影响运行 /ant/ 的 JVM 的环境，但不会影响 ant 可能启动的东西。

2.  您可以设置的最大堆大小完全取决于环境：对于大多数 32 位系统，您可以请求的最大堆空间量（无论可用内存如何）都在 2GiB 范围内。64 位系统上的最大堆“非常大”。此外，您实际上也受到物理内存的限制，因为堆是由 JVM 管理的，您不希望在磁盘上进行大量交换。

3.  对于服务器环境，您通常希望将 -Xms 和 -Xmx 设置为相同的值：这会将堆的大小固定为某个大小，并且垃圾收集器要做的工作更少，因为堆永远不必重新大小。

# java - Ruby [on Rails] 和 PHP 中等效的 Java Servlet 过滤器？

> ID：417158
> 
> 赞同：1
> 
> 时间：2009-01-06T16:17:01.920
> 
> 标签：java, php, python, ruby-on-rails, servlets

不确定术语是否正确，但是 Ruby 和 PHP 中的 Java Servlet 过滤器是否有粗略的等价物？它们是实际的具体*类*吗？

我假设 Python 中还有许多常见的 Web 应用程序库/框架。那里有等价物吗？

谢谢。

**=== 附录 ===**

[根据Kevin Davis](https://stackoverflow.com/users/49993/kevin-davis)的好建议，我只想快速详细说明 Java Servlet 过滤器是什么。它基本上是一个 HTTP 请求拦截器。可以在请求的原始接收和请求的最终目的地之间配置一系列过滤器。请求参数（以及 cookie、标头等）被传递给链中的第一个过滤器，每个过滤器对它们做一些事情（或不做），然后将它们传递到链上（或不传递。例如，缓存过滤器可能只需返回结果，绕过链的其余部分和端点）。

优势之一是能够在不触及原始端点代码的情况下修改或增强 Web 应用程序。

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T14:09:04.920

> 我假设 Python 中还有许多常见的 Web 应用程序库/框架。那里有等价物吗？

**Django**提供了一个中间件挂钩框架，可用于更改请求/响应处理中的输入/输出。有关更多详细信息，请参阅[中间件文档页面](http://docs.djangoproject.com/en/dev/topics/http/middleware/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T13:07:55.123

在典型的**Apache/PHP**场景中，答案通常是：不，没有自定义过滤器。但是，对于使用 Java Servlet 过滤器解决的问题，有一些解决方案：

*   有多个协作[访问控制模块](http://httpd.apache.org/docs/2.2/howto/auth.html)
*   压缩可以在[php配置中设置](http://php.net/manual/en/zlib.configuration.php#ini.zlib.output-compression)

您可以创建一个[`.htaccess`文件](http://httpd.apache.org/docs/2.2/howto/htaccess.html)来为目录及其子目录设置这些属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T12:56:39.513

[Ruby on Rails 有用](http://api.rubyonrails.com/classes/ActionController/Filters/ClassMethods.html)于此目的的过滤器

一个新特性是[Rack Middleware](http://www.pathf.com/blogs/2009/02/its-only-rack-on-rails-but-i-like-it/)，它类似于 Django 中间件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T13:20:03.327

在 PHP 世界中，[Zend 框架](http://framework.zend.com/)为其前端控制器对象提供了一个插件 API，它允许在预路由和后期调度阶段之间挂钩插件对象。尽管我没有机会使用 Java servlet，但我认为这将与您附录中的描述相匹配。无论如何，这不是内置在 PHP 中的，它的框架依赖于 RoR 或 Django。

# python - 使用 Python 进行跨平台 SWF 播放？

> ID：417159
> 
> 赞同：3
> 
> 时间：2009-01-06T16:17:06.397
> 
> 标签：python, cross-platform, flash, wxpython

我正在寻找使用 Python 在 Windows、OSX 和 Linux 上播放 SWF 文件的不同解决方案。理想情况下，我想将播放器嵌入到 wxPython 框架/窗口中。

我正在调查的一种可能性是 Mozilla XPCOM 框架，因为它被 FireFox 用来在浏览器中加载 Flash 插件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T23:23:16.863

您考虑过[Adob​​e AIR](http://www.onflex.org/ted/2008/02/why-adobe-air.php)吗？

Bruce Eckel 说：[尝试将 Python 的强大功能与 Adob​​e Flash 的润色结合起来创建一个桌面应用程序。](http://www.artima.com/weblogs/viewpost.jsp?thread=208528)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T19:03:16.980

虽然我不知道如何在 wxPython 窗口中嵌入浏览器，但以下代码可能会在紧要关头提供（并且可以跨平台工作，假设您使用的是 Python 2.5 或更高版本）：

```
import webbrowser
webbrowser.open(your_swf_url) 
```

无论如何，最好将此任务委托给浏览器。

# .net - 有 Postsharp 生产经验的人吗？

> ID：417163
> 
> 赞同：24
> 
> 时间：2009-01-06T16:17:38.517
> 
> 标签：.net, asp.net, aop, postsharp

有没有人在生产环境中使用[过 Postsharp AOP 框架？](http://www.postsharp.org/)有什么陷阱吗？为了做一些日志记录等，Postsharp 可以与 Log4Net 结合使用吗？

任何有关将 Postsharp 与 Web 应用程序和/或 Log4Net 一起使用的教程都将受到高度赞赏。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-06T21:23:03.703

我和另一位队友在几个正在生产并且已经使用了几个月的项目中以不同的方式使用 PostSharp。例如，在一种情况下，我使用它来记录方法参数值以防出现异常。PostSharp Laos（包含在 PostSharp 中）是一种易于使用的注入方法调用的方式（例如，在方法进入、退出和异常时），您可以轻松地将日志调用添加到 log4net 注册的记录器。

它增加了构建时间，足以稍微改变我的构建习惯，但对于它提供的好处来说肯定不会太多，IMO。在编写代码时，您可能希望将其从本地构建中排除，这很容易做到，因此您可以继续频繁快速地构建，然后将其包含在构建服务器等中。

这是来自 Gael（PostSharp 创建者）的一个[很好的 PostSharp 教程](http://www.postsharp.org/about/video "PostSharp 视频")......虽然它很旧，但很高兴看到它贯穿始终。在我迄今为止遇到的控制台、winforms、WPF 或 WebApp 中使用它确实没有区别。

我还要说，一旦您弄清楚如何将老挝方面添加到项目中，重复练习就非常容易。您将方面应用到多少程序集/类与 PostSharp 添加到您的构建中的时间之间存在关系。因此，您甚至可以稍微控制构建时间问题。

至于代码，我对 PostSharp 的工作方式印象非常深刻……它从未搞砸过构建、使程序集无效或以其他方式弄乱了代码。我什至在 ASP.NET 应用程序中使用过它，包括代码覆盖率和性能检测（因此它与 MS 的 Assembly 检测工具配合得很好）。

总而言之，我会定义。建议您尝试一下以满足您的 log4net 要求。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T19:49:54.657

我使用 Postsharp，我喜欢它。它为我节省了很多我必须添加的重复代码。

我不需要 log4Net 的任何高级功能，谷歌足以了解它是如何工作的。它只是做这项工作。到目前为止，我还没有看到任何缺点。

对于 Postsharp 来说，网站上的入门指南、博客和浏览源代码就足够了。一个主要缺点是增加了构建时间。我讨厌等待我的电脑工作。在 Visual Studio（在快速 PC 上）中按下 ctrl-shift-b 大约需要 8 秒，以获得 +-60K loc 解决方案，其中 2 个项目使用 postsharp 构建操作。如果可以，请尝试在尽可能少的项目中使用 Postsharp。

当您真的不想使用 postsharp 时，您可以创建一个包含 20 个项目的解决方案，并将 post-build 命令添加到每个项目中。构建时间将足以惹恼团队的其他成员。

就我个人而言，我可能会继续在未来的项目中使用 Postsharp。优点超过了额外的构建时间。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-06T16:31:07.507

我们尝试将 post sharp 用于一两件事，问题是它使构建时间过长。如果你正在使用 CI，并且有一个频繁的签入方法，那么你最好有一个非常好的构建服务器和工作站机器。

显然 .net 4.0 将会有一堆编译器钩子来让像 AOP 这样的事情更容易做。我们的最终结论是等待。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-15T10:39:06.317

我用postSharp，我喜欢它。后期的构建时间很烦人，但它几乎没有能力。在调试模式下，我使用条件 SKIPPOSTSHARP 来消除后锐化。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-05T21:25:34.400

根据[PostSharp 社区调查](http://www.postsharp.org/blog/postsharp-community-survey-2009-results-287)，许多公司在生产中使用 PostSharp。令人沮丧的是他们拒绝被识别:-(。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-05T19:03:59.420

我们确实在生产中使用 PostSharp，用于 3.5 运行时和 Silverlight 运行时。为了加快构建速度，您可以使用 /m: switch for msbuild（谷歌用于 msbuild 的并行构建）。他们还承诺在即将发布的版本中显着加快速度。

# unit-testing - 在单元测试中使用模拟时如何避免重复代码

> ID：417166
> 
> 赞同：8
> 
> 时间：2009-01-06T16:18:01.153
> 
> 标签：unit-testing, dependency-injection, mocking, rhino-mocks

我正在使用依赖注入为我正在测试的类之外的代码提供模拟。我发现自己一遍又一遍地编写了很多相同的代码，因为我需要模拟在我想要测试的方法中使用的 AuthProvider、ConfigurationManager 等。该方法包含分支（if-then-else），因此我有多个测试来测试该方法的所有执行路径。我多次实例化每个模拟（在每种测试方法中一次），但我想知道这是否是错误的方法？此外，我对模拟和预设响应提出了期望，这些响应显然主要是复制粘贴，因为在每个方法中都会调用诸如 AuthProvider.Authenticate() 之类的调用

在每种方法中，我都设置了一个模拟存储库，并在每种方法结束时验证了模拟存储库。我是否应该有某种工厂来创建这些模拟以及设置它们的期望和返回值，如果是这样，如何？

为了实现模拟，我正在使用 RhinoMocks。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T16:28:52.317

“多次实例化每个模拟”不是问题。对象是免费的。

请确保您没有多次定义模拟类。上课很贵。

此外，您在 TestCase 中有一个“setUp”方法，它允许您创建一个供所有测试使用的夹具。是的，它为每个测试重建。不，这不是问题，除非它非常缓慢。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T17:02:59.937

假设您使用的是 NUnit，您可以为您的 Mocks 使用实例变量并在 Setup/Teardown 中重置它们。如果你看到重复的模式，那么就按照你对生产代码所做的事情：重构并提取帮助方法来表达你想要实现的目标（如果根本没有共性，那么生产代码的设计就有问题）。

如果设置中存在重大差异，请考虑为您的生产类编写多个测试类。

最后，想想你的生产类是否太忙了，一些行为应该被提取到一个辅助对象中。

听测试！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T17:55:12.843

这是我的看法..

在这种情况下我不会使用mock ...我会使用工厂方法来返回类的假实现，并使用依赖注入来使用这个实现。这样你可以避免重复并且可以再次重用这个实现n ...再次，这个工厂实现需要正确重构，即没有重复..

模拟，我想应该在您测试一些动态行为时使用......当我对 SUT 执行某些操作时，是否调用了子系统中的方法......然后调用 verify() 来验证此行为。 .. 还有一篇关于 Martin Folwer bliki [Mock Aren't Stubs的好文章](http://martinfowler.com/articles/mocksArentStubs.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T17:10:18.533

您可能希望考虑使用 AAA 测试风格，以便使用通用设置进行多个测试。[这是一个体面的例子。](http://www.lostechies.com/blogs/jimmy_bogard/archive/2008/07/24/arrange-act-assert-and-bdd-specifications.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T18:02:02.160

如果您不对模拟调用设置期望，像 EasyMock 这样的记录和重放框架会失败。但是像 Mockito 这样的框架只是简单地记录所有调用并让您只验证重要的调用。因此，您不必对所有测试中的所有方法都设定期望。

回到您在每个测试方法中实例化 Mocks 的问题，有比使用 setUp() 方法更好的方法。Mockito 提供了一个 @Mock 注释。所以你声明你的变量（作为字段），如：@Mock Repository repositoryMock

只需在 setUp() 中调用 initMocks()。声明的所有模拟对象在您的测试中自动可用，而无需显式创建模拟。

# oracle - 返回 Oracle 参考游标并附加多个结果

> ID：417178
> 
> 赞同：4
> 
> 时间：2009-01-06T16:20:27.637
> 
> 标签：oracle, sys-refcursor

我有这个问题，我希望有人知道答案。我有一个 oracle 存储过程，它接受一个客户 ID 并在 ref_cursor 中返回所有客户的订单。过度简化它，这就是我所拥有的：

```
Orders
- orderId
- siteID

Customers
- siteID
- Name

GetOrder(siteID, outCursor) /* returns all orders for a customer */ 
```

现在，我需要编写另一个过程，它接受客户名称并执行 LIKE 查询以获取所有 custId，然后我需要重用 GetOrder 方法来返回找到的 custId 的所有订单，如下所示：

```
 PROCEDURE GetOrderbyCustName(
      p_name       IN        VARCHAR2,
      curReturn    OUT       sys_refcursor
   )
   IS
      siteid    number;
   BEGIN
      FOR rec in SELECT site_id FROM customers WHERE name LIKE p_name
      LOOP 
      -- This will replace curReturn in each iteration
      -- how do I append instead?
        GetOrder(rec.site_id,
                   curReturn
                  );
      END LOOP;
   END GetOrderbyCustName; 
```

我的问题是，如何在每次迭代中将 GetOrder 的返回附加到 curReturn ？正如它现在所写的那样，它会在循环的每个循环中覆盖它。谢谢！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-06T18:10:29.427

你不能那样做——不能追加或合并游标。只需这样做：

```
PROCEDURE GetOrderbyCustName(
   p_name       IN        VARCHAR2,
   curReturn    OUT       sys_refcursor
)
IS
BEGIN
   OPEN curReturn FOR 
      SELECT o.orderID, o.siteID
      FROM Orders o
      JOIN Customers c ON c.siteID = o.siteID
      WHERE c.name LIKE p_name;
END GetOrderbyCustName; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T16:14:14.933

如果查询很简单，我会说选择托尼的答案。这不仅简单，而且可能比为每个 siteID 执行一个查询执行得更好。

如果它相当复杂，那么重用 GetOrder 过程可能值得付出一些额外的努力，因此您只需维护一个查询。

为此，您需要在循环的每次迭代中实际从 refcursor 中获取数据，并将其放入其他数据结构中。

如果对接口有意义，一种选择是更改 GetOrderbyCustName 以将 PL/SQL 索引表作为其输出参数而不是引用。通过循环在每次迭代时附加到该表。

如果您确实需要返回一个 refcursor，您可以使用嵌套表类型，然后返回查询该嵌套表的游标。像这样的东西（未经测试的代码）：

```
CREATE TYPE number_table_type AS TABLE OF NUMBER;

PROCEDURE GetOrderbyCustName(
      p_name       IN        VARCHAR2,
      curReturn    OUT       sys_refcursor
   )
   IS
      cursor_source_table  number_table_type := number_table_type();
      single_site_cursor  sys_refcursor;
      orderID  NUMBER;
   BEGIN
      FOR rec in SELECT site_id FROM customers WHERE name LIKE p_name
      LOOP 
      -- This will replace curReturn in each iteration
      -- how do I append instead?
        GetOrder(rec.site_id,
                   single_site_cursor
                  );

        -- Fetch all rows from the refcursor and append them to the nested table in memory
        LOOP
          FETCH single_site_cursor INTO orderID;
          EXIT WHEN single_site_cursor%NOTFOUND;
          cursor_source_table.extend();
          cursor_source_table( cursor_source_table.COUNT+1) := orderID;
        END LOOP;
      END LOOP;

      OPEN curReturn FOR
        SELECT * FROM TABLE( cursor_source_table );

   END GetOrderbyCustName; 
```

# ruby-on-rails - Ruby 如何知道在哪里可以找到所需的文件？

> ID：417179
> 
> 赞同：8
> 
> 时间：2009-01-06T16:20:31.693
> 
> 标签：ruby-on-rails, ruby, require

这里还有一个新手问题：

```
require 'tasks/rails' 
```

我在每个 Rails 项目的根路径中的 Rakefile 中看到了这一行。我猜这条线用于要求 vendor/rails/railties/lib/tasks/rails.rb 加载所有 rake 任务：

```
$VERBOSE = nil
# Load Rails rakefile extensions
Dir["#{File.dirname(__FILE__)}/*.rake"].each { |ext| load ext }
# Load any custom rakefile extensions
Dir["#{RAILS_ROOT}/lib/tasks/**/*.rake"].sort.each { |ext| load ext }
Dir["#{RAILS_ROOT}/vendor/plugins/*/**/tasks/**/*.rake"].sort.each { |ext| load ext } 
```

我的问题是为什么只为 require 方法指定了“tasks/rails”，而不是文件的完整路径？

提前致谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-06T17:13:29.370

当你启动你的 Rails 应用程序时，它会运行 config/boot.rb，它会调用[`Rails::Initializer.set_load_path`](http://github.com/rails/rails/tree/master/railties/lib/initializer.rb#L231)并设置`$LOAD_PATH`.

Ruby 使用该目录列表来查找在`require`一行中指定的文件。如果你给它一个绝对路径，`require '/home/lolindrath/ruby/lib.rb'`它会跳过那个搜索。

这大致类似于`#include <stdlib.h>`在 C/C++ 中，它搜索包含路径，您给编译器以查找该头文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T16:27:03.223

我相信因为您的路径是在您的 /config/environment.rb 文件中设置的：

```
require File.join(File.dirname(__FILE__), 'boot') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T17:15:46.200

当然。在 /config/boot.rb（在 environment.rb 中调用）中，RAILS_ROOT 设置如下：

```
RAILS_ROOT = "#{File.dirname(__FILE__)}/.." unless defined?(RAILS_ROOT) 
```

我相信这使您可以从根本上要求事物。无论如何，希望这是答案！

# .net - .NET：缺少所需的配置设置时会抛出哪个异常？

> ID：417187
> 
> 赞同：137
> 
> 时间：2009-01-06T16:23:16.850
> 
> 标签：.net, exception, configuration

这是一个标准场景：

```
if(string.IsNullOrEmpty(Configuration.AppSettings["foobar"]))
   throw new SomeStandardException("Application not configured correctly, bozo."); 
```

问题是，我不完全确定应该是*哪个*例外。`SomeStandardException`

我仔细阅读了 3.5 框架，发现了两个可能的候选者：[`ConfigurationException`](http://msdn.microsoft.com/en-us/library/system.configuration.configurationexception.aspx)和[`ConfigurationErrorsException`](http://msdn.microsoft.com/en-us/library/system.configuration.configurationerrorsexception.aspx).

> ## System.Configuration.ConfigurationException
> 
> 发生配置系统错误时引发的异常。
> 
> ### 评论
> 
> `ConfigurationException`如果应用程序尝试向配置文件读取或写入数据但不成功，则会引发异常。 造成这种情况的一些可能原因可能包括配置文件中的格式错误的 XML、文件权限问题以及具有无效值的配置属性。
> 
> **笔记：**
> 
> `ConfigurationException`维护该对象是为了向后兼容。该`ConfigurationErrorsException` 对象将其替换为配置系统。

这个例外实际上听起来很适合我的需要，但它已被标记为过时，所以，ixnay on atthay。

这给我们带来了彻底令人费解的问题[`ConfigurationErrorsException`](http://msdn.microsoft.com/en-us/library/system.configuration.configurationerrorsexception.aspx)：

> ## System.Configuration.ConfigurationErrorsException
> 
> 当前值不是 EnableSessionState 值之一。

如您所见，它的文档完全没有用。（在本地和在线帮助中都是这样。）对课程本身的检查表明，对于我想要的东西来说，这太过分了。

简而言之，我需要一个标准异常，当应用程序配置设置丢失或包含无效值时应该抛出该异常。您会认为框架中包含了这样一个异常供应用程序使用。（它显然做到了，但它被标记为过时的，并被范围更大的东西所取代*。*）

你们使用什么解决方案（如果有的话），我是否必须接受它并为此推出我自己的例外？

## 编辑附录

有些人问我是否可以提供默认值，然后继续。在某些情况下，是的，在这些情况下，不会抛出异常。但是，对于某些设置，这将不适用。例如：数据库服务器名称和凭据、身份验证服务器以及安装的第三方应用程序的路径。

还值得注意的是，我主要处理的应用程序是以批处理模式运行的控制台应用程序，我希望它抛出一个异常，该异常被 main 方法捕获并在未正确配置时适当记录。（这是我继承的遗留代码，目前只是*假设*一切都很好。）

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-01-06T16:32:38.423

就个人而言，我会使用[InvalidOperationException](http://msdn.microsoft.com/en-us/library/system.invalidoperationexception.aspx)，因为这是对象状态的问题，而不是配置系统的问题。毕竟，您不应该允许这些设置由代码设置而不是配置吗？这里重要的部分不是 app.config 中没有行，而是所需的信息不存在。

对我来说，ConfigurationException（以及它的替代品，ConfigurationErrorsException - 尽管有误导性的 MSDN 文档）是用于保存、读取等配置的错误。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-01-06T16:29:16.120

您的异常抛出不限于框架中的现有异常。如果您决定使用现有的例外情况，则不必完全按照文档进行操作。该文档将描述*框架*如何使用给定的异常，但并不意味着对*您*选择使用/重用现有异常的方式有任何限制。

这是您的应用程序 - 只要您记录它并清楚地指出在缺少配置值的特定情况下将引发的异常，您就可以使用任何您喜欢的异常。如果您确实想要一个非常具体的*缺失*值指示，您可以考虑编写自己的 ConfigurationSettingMissing 异常：

```
[Serializable]
public class ConfigurationMissingException : ConfigurationErrorsException
{} 
```

编辑：在这种情况下编写您自己的异常会带来额外的好处，即保证永远不会混淆异常来自哪里——框架或您的应用程序。该框架永远不会抛出您的自定义异常。

更新：我同意评论，所以我已将子类从 Exception 更改为 ConfigurationErrorsException。我认为在可能的情况下从现有框架异常中子类化自定义异常通常是一个好主意，除非您需要特定于应用程序的异常，否则避免使用 Exception 类。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-01-06T17:23:51.190

正如丹尼尔理查森所说，**ConfigurationErrorsException**是一个可以使用的。一般来说，如果您有处理它们的场景，建议只创建您自己的自定义异常类型。在配置错误（通常是致命的）的情况下，这种情况很少发生，因此重用现有的 ConfigurationErrorsException 类型通常更合适。

在 .NET 2.0 之前，建议使用**System.Configuration.ConfigurationException**。ConfigurationException 在 .NET 2.0 中已过时，原因我一直不清楚，建议改为使用 ConfigurationErrorsException。

我使用辅助方法来引发异常，以便在从 .NET 1.x 迁移到 2.0 或 Microsoft 决定再次更改建议时轻松更改在一个地方引发的异常：

```
if(string.IsNullOrEmpty(Configuration.AppSettings("foobar")))
{
   throw CreateMissingSettingException("foobar");
}

...

private static Exception CreateMissingSettingException(string name)
{
    return new ConfigurationErrorsException(
        String.Format
        (
        CultureInfo.CurrentCulture,
        Properties.Resources.MissingConfigSetting,
        name
        )
        );
} 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-05-05T12:11:24.517

怎么样[`System.Configuration.SettingsPropertyNotFoundException`](https://docs.microsoft.com/pt-br/dotnet/api/system.configuration.settingspropertynotfoundexception?view=netframework-4.7.2)？

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-01-06T17:09:35.587

`ConfigurationErrorsException`是在您描述的情况下抛出的正确异常。MSDN 文档的早期版本`ConfigurationErrorsException`更有意义。

[http://msdn.microsoft.com/en-us/library/system.configuration.configurationerrorsexception(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.configuration.configurationerrorsexception(VS.80).aspx)

较早的MSDN总结和备注是：

*   发生配置系统错误时引发的异常。
*   `ConfigurationErrorsException` 在读取或写入配置信息时发生任何错误时将引发异常。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-01-06T16:33:52.273

ConfigurationElement 类（它是许多与配置相关的类的基类，如 ConfigurationSection）有一个称为 OnRequiredPropertyNotFound 的方法（还有其他帮助方法）。你也许可以打电话给那些。

OnRequiredPropertyNotFound 是这样实现的：

```
protected virtual object OnRequiredPropertyNotFound(string name) {
    throw new ConfigurationErrorsException(SR.GetString("Config_base_required_attribute_missing", new object[] { name }), this.PropertyFileName(name), this.PropertyLineNumber(name)); } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T16:27:03.363

我会把它吸起来并自己动手......但在你这样做之前，是否可以让系统假定此配置设置的默认值？我通常会尝试对可能被运维管理人员遗漏的每个设置执行此操作......（或者我应该说，尽可能多的设置 - 对于某些人来说，让系统做出默认决定显然是不合适的。 ..)

一般来说，自定义异常并不费力......这是一个例子......

```
[Serializable]
public class MyCustomApplicationException : ApplicationException
{
    #region privates
    #endregion privates

    #region properties
    #endregion properties

    public MyCustomApplicationException (string sMessage,
        Exception innerException)
        : base(sMessage, innerException) { }
    public MyCustomApplicationException (string sMessage)
        : base(sMessage) { }
    public MyCustomApplicationException () { }

    #region Serializeable Code
    public MyCustomApplicationException (
       SerializationInfo info, StreamingContext context)
        : base(info, context) { }
    #endregion Serializeable Code
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-08T02:26:49.580

您可以用于配置文件的另一种方法是使用自定义配置部分，而不是`AppSettings`. 这样，您可以指定一个属性`IsRequired`和配置系统将为您处理此检查。如果该属性丢失，它将抛出 a`ConfigurationErrorsException`所以我认为这支持您应该在您的情况下使用该异常的答案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-06T16:36:06.420

我的一般规则是：

1.  如果缺少配置的情况不是很常见，并且我相信我永远不想以与其他异常不同的方式处理这种情况，我只需使用带有适当消息的基本“异常”类：

    throw new Exception("我的信息在这里")

2.  如果我确实想要，或者认为我很可能希望以与大多数其他例外不同的方式处理这种情况，我会按照人们已经在这里提出的建议推出自己的类型。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-01-06T16:36:45.343

我倾向于不同意你问题的前提：

> 简而言之，我需要一个标准异常，当应用程序配置设置丢失或包含无效值时应该抛出该异常。您会认为框架中包含了这样一个异常供应用程序使用。（它显然做到了，但它被标记为过时的，并被范围更大的东西所取代。）

根据关于 System.Exception 的 MSDN 文档（[Exception Class](http://msdn.microsoft.com/en-us/library/system.exception.aspx)，出于性能原因，您真的不应该为用户输入错误抛出异常（其他人在 Stack Overflow 和其他地方已经指出了这一点）。这似乎是有道理的好吧 - 如果用户输入错误，为什么你的函数不能返回 false，然后让应用程序优雅地退出？这似乎更像是一个设计问题，而不是抛出哪个异常的问题。

正如其他人指出的那样，如果您真的**必须**抛出异常 - 无论出于何种原因 - 没有任何理由无法通过继承 System.Exception 来定义您的 Exception 类型。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-01-06T16:28:42.847

您可以尝试继承 XML 异常，或者只是使用它。

# asp.net - 如何重新定位 asp.net ajax ValidatorCalloutExtender

> ID：417214
> 
> 赞同：8
> 
> 时间：2009-01-06T16:30:03.593
> 
> 标签：asp.net, asp.net-ajax

我正在使用 AjaxControlToolkit 版本 3.0.20299.9 中的 ValidatorCalloutExtender。验证发生在设置了 resizable=0 的浏览器窗口中。弹出框主要位于可视窗口之外 - 位于右侧。

它已使用 AjaxControlToolkit 版本 1.0.10618.0 正确定位。它实际上漂浮在文本框上，弹出窗口的右侧就在可视窗口的右侧，边距约为 5px。由于我们升级了 AjaxControlToolkit 的版本，它的呈现方式似乎有所不同。有谁知道我需要做什么才能使弹出窗口正确定位？我一直在玩 .ajax__validatorcallout_* css 类，但我改变的一切似乎真的搞砸了显示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T19:18:11.647

我想出了这个。以为我会为任何感兴趣的人发布答案。AjaxControlToolkit 的两个版本之间的呈现是不同的。为了重新定位 ValidatorCallout 窗口，我发现以下方法效果最好。

您必须覆盖工具包使用您自己的自定义样式生成的所有 .ajax__validatorcallout_* css 类。这很奇怪，但似乎您必须覆盖每种样式才能使其正常工作。我使用 firefox web dev 工具栏来发现正在生成的样式，然后按如下方式覆盖它们。

```
<style>

.CustomValidator {position:relative;margin-left:-80px;}

.CustomValidator div {border:solid 1px Black;background-color:LemonChiffon; position:relative;}

.CustomValidator td {border:solid 1px Black;background-color:LemonChiffon;}

.CustomValidator .ajax__validatorcallout_popup_table {display:none;border:none;background-color:transparent;padding:0px;}

.CustomValidator .ajax__validatorcallout_popup_table_row {vertical-align:top;height:100%;background-color:transparent;padding:0px;}

.CustomValidator .ajax__validatorcallout_callout_cell {width:20px;height:100%;text-align:right;vertical-align:top;border:none;background-color:transparent;padding:0px;}

.CustomValidator .ajax__validatorcallout_callout_table {height:100%;border:none;background-color:transparent;padding:0px;}

.CustomValidator .ajax__validatorcallout_callout_table_row {background-color:transparent;padding:0px;}

.CustomValidator .ajax__validatorcallout_callout_arrow_cell {padding:8px 0px 0px 0px;text-align:right;vertical-align:top;font-size:1px;border:none;background-color:transparent;}

.CustomValidator .ajax__validatorcallout_callout_arrow_cell .ajax__validatorcallout_innerdiv {font-size:1px;position:relative;left:1px;border-bottom:none;border-right:none;border-left:none;width:15px;background-color:transparent;padding:0px;}

.CustomValidator .ajax__validatorcallout_callout_arrow_cell .ajax__validatorcallout_innerdiv div {height:1px;overflow:hidden;border-top:none;border-bottom:none;border-right:none;padding:0px;margin-left:auto;}

.CustomValidator .ajax__validatorcallout_error_message_cell {font-family:Verdana;font-size:10px;padding:5px;border-right:none;border-left:none;width:100%;}

.CustomValidator .ajax__validatorcallout_icon_cell {width:20px;padding:5px;border-right:none;}

.CustomValidator .ajax__validatorcallout_close_button_cell {vertical-align:top;padding:0px;text-align:right;border-left:none;}

.CustomValidator .ajax__validatorcallout_close_button_cell .ajax__validatorcallout_innerdiv {border:none;text-align:center;width:10px;padding:2px;cursor:pointer;}

</style> 
```

注意：我将第一个 .CustomValidator {position:relative;margin-left:-80px;} 行添加到生成的类中。我还打破了 .CustomValidator div、.CustomValidator td 以便我可以添加 position:relative; 到 div 而不是 td。margin-left:-80px 是我需要向左移动所有内容。

然后只需将 CustomValidator CssClass 粘贴到您的 ValidatorCalloutExtender 中：

```
<cc1:ValidatorCalloutExtender ID="ValidatorCalloutExtender1" runat="server" TargetControlID="MyValidatorControl" CssClass="CustomValidator"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T17:26:57.207

所有浏览器都会出现这种情况吗？IE6 以呈现问题而闻名，我强烈建议使用其他东西。IE7、FF、Safari，除了 IE6。

验证器是否放置在外部 div 中？检查外部 div 的 CSS。

# java - 修剪 Log4J 消息

> ID：417216
> 
> 赞同：8
> 
> 时间：2009-01-06T16:30:21.970
> 
> 标签：java, log4j

我有一个附加程序，我只希望显示消息的前 X 个字符（对于本示例，我们将说 5）。

我正在使用 PatternLayout 但我无法正确截断消息。

例如，如果我的日志消息是

> 敏捷的棕色狐狸

我只想看看：

> q

当我在 Pattern 中使用它时

> %.5m

我明白了

> 狐狸

因为这些是最后 5 个字符。

我查看了[PattenLayout](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/PatternLayout.html) javadoc，但找不到任何东西。我知道不想看到整个消息有点奇怪，但对于这个特定的附加程序来说，这是有道理的。我确实将整个消息记录在不同的附加程序中。如果可能，我想避免编写自定义类。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-06T16:55:09.063

默认情况下，从消息的开头进行截断（与 C 中的 printf 不同，它从末尾开始执行）。

正确的模式应该是：

```
%.-5m 
```

编辑：

我刚试过这个，log4j 不喜欢这种模式。但是，如果您可以进行切换，提供的模式将在 LOGBack 中正常工作。如果您无法切换日志记录提供程序，您可以对 log4j 进行一次性修改。有趣的代码出现在 org.apache.log4j.helpers.PatternConverter 的第 75-76 行：

```
if(len > max)
  sbuf.append(s.substring(len-max)); 
```

这应该是：

```
if(len > max)
  sbuf.append(s.substring(0,max)); 
```

您可以简单地进行修改并重新编译 jar 以供您使用，或者您可以将 PatternConverter 子类化以执行正确的截断。这还需要一个新版本的 PatternLayout，其中包含 createPatternParser 方法，您需要在子类中重写该方法以实例化新版本的 PatternConverter。

作为旁注，请注意在您的特定项目中修改开源代码的许可后果。

# asp.net-ajax - DetailView 内部的触发和控制

> ID：417220
> 
> 赞同：0
> 
> 时间：2009-01-06T16:32:22.997
> 
> 标签：asp.net-ajax

我在 TemplateField 中有一个带有 LinkBut​​ton 的 DetailsView 控件。

我将 DetailsView 包装在 UpdatePanel 中，并使用 DetailsView 中的 LinkBut​​ton 设置触发器。但是，我收到错误消息说它找不到 LinkBut​​ton。我试图用谷歌搜索设置在 DetailsView 和 GridView 内的触发器，但我没有遇到任何关于如何做到这一点的帖子。

有谁知道如何使用其中的 LinkBut​​ton 或 DetailsView 作为触发器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T17:07:43.330

我找到了我的答案。基本上在更新面板中将 ChildrenAsTriggers 设置为 true。更新面板内的任何控件都会触发它。

# vba - 使用静态分析使开发更好

> ID：417232
> 
> 赞同：6
> 
> 时间：2009-01-06T16:35:02.927
> 
> 标签：vba, static-analysis

我发现，当我查看 VBA 代码时，大多数错误都是容易分类的错误，例如拼写错误、未将内容设置为`Nothing`、未关闭数据库连接等。

我知道使用“Option Explicit”可以解决其中的一些问题，但我宁愿使用更强大的东西。

VBA 有静态分析工具吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T17:44:10.260

您也许可以从使用[MZ-Tools](http://www.mztools.com/v3/mztools3.aspx)开始。虽然它在静态分析功能领域没有太多功能，但它是免费的，并且确实为管理和编辑代码库提供了一些帮助。

它具有执行某种形式的静态分析的一个功能是：

*   [Review Source Code](http://www.mztools.com/v3/onlinehelp/html_review_source_code.htm) - 极其有限的代码分析版本。它会告诉您是否未使用变量、常量或过程。很好地帮助清理您的代码并摆脱杂乱无章的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-16T22:09:12.040

[项目分析器：VBA Plug v3](http://www.aivosto.com/project/vba.html)
[MZ Tools](http://www.mztools.com/v3/mztools3.aspx)
[VBA Code Profiler](http://www.bandwood.com/_Store/commerce.cgi?product=VBACP&cart_id=431008.15085) *

*   不知道这是否仍然受支持，或者产品的质量如何。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-01T23:39:10.257

积极维护的免费/开源选项是[Rubberduck](http://rubberduckvba.com/)（[在 GitHub 上](https://github.com/rubberduck-vba/Rubberduck)）。它包括几个静态分析器，称为“检查”。他们的网站上有[一份检查清单。](http://rubberduckvba.com/Inspections/List)

# linux - 在 Makefile 安装中将目录移动到适当位置的最佳方法是什么？

> ID：417236
> 
> 赞同：16
> 
> 时间：2009-01-06T16:35:51.193
> 
> 标签：linux, makefile, installation

我目前在我的 Makefile 中使用通常的技术来安装单个文件：

```
install:
    install -D executable ${BIN_DIR} 
```

但是我刚刚遇到了一种情况，我需要将整个目录及其下面的所有文件移动到位。

是`cp -r`最好的方法还是有更多的 linux-y/unix-y 方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-06T17:00:25.217

是的`cp -r`，虽然 -r 是相对较晚的`cp`. 我可以告诉你我们*过去*的做法，并且可以在文件系统等方面巧妙地工作：

让`src`成为您要移动的源目录，并`/path/to/target`成为目标的绝对路径。然后你可以使用：

```
$ tar cf - src | (cd /path/to/target; tar xf -) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T17:01:35.853

我的`install(1)`（Debian）版本有：

```
 -d, --directory
          treat all arguments as directory names; create all components of the specified directories

   -t, --target-directory=DIRECTORY
          copy all SOURCE arguments into DIRECTORY 
```

因此，如果您想在`install(1)`整个 Makefile 中始终如一地使用，您可以这样做：

```
install -d destdir
install srcdir/* -t destdir 
```

`-t`但是不是递归的 - 如果`srcdir`包含目录，那么它们将不会被复制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T17:56:24.777

链接是另一种可行的选择。这将允许您保持多个目录（代表不同版本）可访问。

# c# - 使用 LINQ 过滤列表

> ID：417246
> 
> 赞同：26
> 
> 时间：2009-01-06T16:37:40.380
> 
> 标签：c#, linq, list, linq-to-objects

我有一个从外部应用程序返回的人员列表，我正在本地应用程序中创建一个排除列表，以便我可以选择手动从列表中删除人员。

我有一个我创建的复合键，它对两者都是通用的，我想找到一种使用我的列表从我的列表中删除人员的有效方法

例如

```
class Person
{
    prop string compositeKey { get; set; }
}

class Exclusions
{
    prop string compositeKey { get; set; }
}

List<Person> people = GetFromDB;

List<Exclusions> exclusions = GetFromOtherDB;

List<Person> filteredResults = People - exclustions using the composite key as a comparer 
```

我认为 LINQ 是这样做的理想方式，但是在尝试了连接、扩展方法、使用产量等之后，我仍然遇到了麻烦。

如果这是 SQL，我会使用`not in (?,?,?)`查询。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-01-06T16:46:08.427

看一下[except](http://msdn.microsoft.com/en-us/library/bb336390.aspx)方法，您可以像这样使用它：

```
var resultingList = 
    listOfOriginalItems.Except(listOfItemsToLeaveOut, equalityComparer) 
```

您将需要使用我链接到的重载，它允许您指定自定义 IEqualityComparer。这样，您可以根据复合键指定项目的匹配方式。（但是，如果您已经覆盖了 Equals，则不需要 IEqualityComparer。）

**编辑：** 由于您似乎正在使用两种不同类型的类，因此这是另一种可能更简单的方法。假设一个`List<Person>`被叫`persons`和一个`List<Exclusion>`被叫`exclusions`：

```
var exclusionKeys = 
        exclusions.Select(x => x.compositeKey);
var resultingPersons = 
        persons.Where(x => !exclusionKeys.Contains(x.compositeKey)); 
```

换句话说：从排除项中仅选择键，然后从人员中*选择没有*任何这些键的所有 Person 对象。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-06T16:43:40.197

我只会在 List 类上使用 FindAll 方法。IE：

```
List<Person> filteredResults = 
    people.FindAll(p => return !exclusions.Contains(p)); 
```

不确定语法是否与您的对象完全匹配，但我认为您可以看到我的目标。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-08T12:15:43.247

非常感谢这些家伙。

我设法将其归结为一行：

```
 var results = from p in People 
                where !(from e in exclusions 
                        select e.CompositeKey).Contains(p.CompositeKey) 
                select p; 
```

再次感谢大家。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-05-02T18:43:26.537

```
var thisList = new List<string>{ "a", "b", "c" };
var otherList = new List<string> {"a", "b"};

var theOnesThatDontMatch = thisList
        .Where(item=> otherList.All(otherItem=> item != otherItem))
        .ToList();

var theOnesThatDoMatch = thisList
        .Where(item=> otherList.Any(otherItem=> item == otherItem))
        .ToList();

Console.WriteLine("don't match: {0}", string.Join(",", theOnesThatDontMatch));
Console.WriteLine("do match: {0}", string.Join(",", theOnesThatDoMatch));

//Output:
//don't match: c
//do match: a,b 
```

相应地调整列表类型和 lambda，您可以过滤掉任何内容。

[https://dotnetfiddle.net/6bMCvN](https://dotnetfiddle.net/6bMCvN)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-06T16:44:09.960

您可以使用“Except”扩展方法（参见[http://msdn.microsoft.com/en-us/library/bb337804.aspx](http://msdn.microsoft.com/en-us/library/bb337804.aspx)）

在您的代码中

```
var difference = people.Except(exclusions); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-06T16:41:45.240

我不知道如何在纯 MS LINQ 中做到这一点，所以我编写了自己的扩展方法来做到这一点：

```
public static bool In<T>(this T objToCheck, params T[] values)
{
    if (values == null || values.Length == 0) 
    {
        return false; //early out
    }
    else
    {
        foreach (T t in values)
        {
            if (t.Equals(objToCheck))
                return true;   //RETURN found!
        }

        return false; //nothing found
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T16:57:25.347

我会做这样的事情，但我敢打赌有一个更简单的方法。我认为来自 linqtosql 的 sql 将使用来自不存在的人的选择（从排除列表中选择）

```
static class Program
{
    public class Person
    {
        public string Key { get; set; }
        public Person(string key)
        {
           Key = key;
        }
    }
    public class NotPerson
    {
        public string Key { get; set; }
        public NotPerson(string key)
        {
           Key = key;
        }
    }
    static void Main()
    {

       List<Person> persons = new List<Person>()
       { 
           new Person ("1"),
           new Person ("2"),
           new Person ("3"),
           new Person ("4")
       };

       List<NotPerson> notpersons = new List<NotPerson>()
       { 
           new NotPerson ("3"),
           new NotPerson ("4")
       };

       var filteredResults = from n in persons
                             where !notpersons.Any(y => n.Key == y.Key)
                             select n;

       foreach (var item in filteredResults)
       {
          Console.WriteLine(item.Key);
       }
    }
 } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T17:09:09.847

下面的这个 LINQ 将为左外连接生成 SQL，然后获取在排除列表中找不到匹配项的所有结果。

```
List<Person> filteredResults =from p in people
        join e in exclusions on p.compositeKey equals e.compositeKey into temp
        from t in temp.DefaultIfEmpty()
        where t.compositeKey == null
        select p 
```

让我知道它是否有效！

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-12-17T07:58:17.310

```
 var result = Data.Where(x =>
            {
            bool condition = true;
            double accord = (double)x[Table.Columns.IndexOf(FiltercomboBox.Text)];
            return condition && accord >= double.Parse(FilterLowertextBox.Text) && accord <= double.Parse(FilterUppertextBox.Text); 
        }); 
```

# c++ - C++ 中的简单 UNICODE

> ID：417249
> 
> 赞同：0
> 
> 时间：2009-01-06T16:38:04.387
> 
> 标签：c++, unicode, internationalization

有没有办法让所有字符序列默认为 UNICODE？例如，现在我不得不说：

```
std::wstring wstr(L"rofl"); 
```

相反，我想说

```
std::wstring wstr("rofl"); 
```

谢谢！

视觉 C++ 8.0

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-06T16:41:17.253

不，您必须使用`L""`才能指定宽字符串文字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T16:46:56.367

不，没有这样的事情。许多旨在使用 Unicode 或 ASCII（但不是两者）进行编译的平台都提供了一个宏来允许轻松选择所需的字符类型（经常`_`使用，例如`_("text")`）。如果您的问题正在为这两个选项编译，您可以使用它。否则，它只是一个附加字符。

另外，请记住，`wchar_t`不同平台的确切编码可能会有所不同。有时是 UTF-16，有时是 UTF-32。C++1x 将添加显式编码指定的字符串`u8"string"` `u"string"`和`U"string"`. （我可能对前缀有误，但会有这样的字符串）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T16:47:49.283

我对此感到惊讶： 难道 wstring 没有 wstring(const char *) 构造函数吗？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-06T18:39:32.863

顺便说一句，CString 支持跨宽度构造（例如：CString("text") 将适用于 Unicode 构建，而 CString(L"text") 适用于 MBCS 构建），但在这两种情况下仍会进行转换。这可能会以性能为代价来实现您想要的。

我建议习惯使用 _T("text")，因为这通常是您想要的。

# c# - App.Config 可以从字符串或内存流中加载吗？

> ID：417253
> 
> 赞同：8
> 
> 时间：2009-01-06T16:40:30.060
> 
> 标签：c#, .net, app-config, memorystream

我知道我可以使用以下代码行从其他位置加载 app.config 文件：

```
AppDomain.CurrentDomain.SetData("APP_CONFIG_FILE", ConfigFile); 
```

其中 ConfigFile 是完整路径位置。不过，我想做的是能够加载已为 app.config 加密的文件。理想情况下，我希望能够加载文件、解密文件并将其加载到字符串或内存流中并将其传递给应用程序，就像它是 app.config 一样。我知道我可以从中加载所有值并手动访问它们，但我希望能够使用.NET 的内置功能来访问它们。有没有办法告诉应用程序使用文件以外的配置文件？

另一种选择是打开文件，解密，将其写入临时文件，然后使用上面的代码以这种方式引用它，但如果有更简单的方法，理想情况下，我想找到它，必须避免处理其他文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T22:28:32.397

虽然到目前为止我一直无法得到答案，但我不得不想出一个解决方法。这可能不是最好的解决方案，但它确实有效。基本上我们所做的是加密我们的 app.config 文件，并给它一个新名称。当应用程序启动时，它将获取加密文件，对其进行解密，并将其写入 Windows 临时文件。这样可以确保文件是一个唯一的随机名称，没有人可能会找到，而且我们不必管理这些文件，因为 Windows 会自动为我们删除它。这样每次重新启动我们都可以重新写出一个新文件并使用它。这是任何感兴趣的人的基本代码片段。

第一种方法`LoadFileAppConfig()`将加载文件。在这种情况下，由于它们是服务，我们需要加载执行路径，并将其传递给适当的方法。我们取回解密后的app.config的路径，然后使用`SetData()`方法将其设置为app.config路径。

```
/// <summary>
/// Loads the Local App.Config file, and sets it to be the local app.config file
/// </summary>
/// <param name="p_ConfigFilePath">The path of the config file to load, i.e. \Logs\</param>
public void LoadFileAppConfig(string p_ConfigFilePath)
{
    try
    {
        // The app.config path is the passed in path + Application Name + .config
        m_LocalAppConfigFile = ProcessLocalAppConfig(p_ConfigFilePath + this.ApplicationName + ".config");

        // This sets the service's app.config property
        AppDomain.CurrentDomain.SetData("APP_CONFIG_FILE", m_LocalAppConfigFile);
    }
    catch (Exception ex)
    {
        throw ex;
    }
} 
```

在这种方法中，我们获取文件的路径，将该文件传递给解密并作为字符串返回，然后将该文件写入我们的 Windows 临时文件。

```
public string ProcessLocalAppConfig(string p_ConfigFilePath)
{
    try
    {
        string fileName = Path.GetTempFileName();
        string unencryptedConfig = DecryptConfigData(p_ConfigFilePath);

        FileStream fileStream = new FileStream(fileName, FileMode.Create, FileAccess.Write);
        StreamWriter streamWriter = new StreamWriter(fileStream);

        if (!string.IsNullOrEmpty(unencryptedConfig))
        {
            try
            {
                streamWriter.BaseStream.Seek(0, SeekOrigin.End);
                streamWriter.WriteLine(unencryptedConfig);
            }

            catch (IOException ex)
            {
                Debug.Assert(false, ex.ToString());
            }
            finally
            {
                streamWriter.Close();
            }
            return fileName;
        }
        return null;
    }
    catch (Exception)
    {
        throw;
    }
} 
```

最后一个方法接受加密后的 app.config 的路径，使用我们的解密工具解密文件（确保我们可以解密它，并且它是正确的文件类型），然后将解密的内容作为字符串返回给上面的方法。

```
private string DecryptConfigData(string p_AppConfigFile)
{
    string decryptedData = null;
    TMS.Pearl.SystemFramework.CryptographyManager.CryptographyManager cryptManager = new TMS.Pearl.SystemFramework.CryptographyManager.CryptographyManager();
    try
    {
        //Attempt to load the file.
        if (File.Exists(p_AppConfigFile))
        {
            //Load the file's contents and decrypt them if they are encrypted.
            string rawData = File.ReadAllText(p_AppConfigFile);

            if (!string.IsNullOrEmpty(rawData))
            {
                if (!rawData.Contains("<?xml"))  //assuming that all unencrypted config files will start with an xml tag...
                {
                    decryptedData = cryptManager.Decrypt(rawData);
                }
                else
                {
                    decryptedData = rawData;
                }
            }
        }
    }
    catch (Exception)
    {
        throw;
    }

    return decryptedData;
} 
```

# excel - 更改单元格时提示用户

> ID：417254
> 
> 赞同：0
> 
> 时间：2009-01-06T16:41:03.897
> 
> 标签：excel, spreadsheet

一般来说，我对创建宏和编程很陌生。我有一个包含 38 个选项卡的工作表。31 个选项卡用于一个月中的日期。我想创建一个宏，只要在 N 列中为这 31 个选项卡中的每一个选择“MCO”，它就会向用户提示警告消息。那可能吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T20:42:35.940

可以使用工作簿级别的 SheetSelectionChange 事件。在 VBA 项目的 ThisWorkbook 模块中粘贴以下代码：

```
Option Compare Text
Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)
    Dim SelectedCellsInColN As Range
    ' Make a range of the cells in Target range that intersect with the cells in the N   column
    Set SelectedCellsInColN = Intersect(Target, Target.Parent.Range("N1:N" & CStr(Target.Parent.Rows.Count)))

    If Not SelectedCellsInColN Is Nothing Then
        ' The user has selected a cell in column N
        Dim CurrCell As Range
        For Each CurrCell In SelectedCellsInColN
            ' If the cell's value contains mco (in any case) then prompt the user with a messagebox
            If CurrCell.Value Like "*MCO*" Then
                MsgBox "You've selected MCO"
                ' Exit the sub so we don't keep bugging the user about it...
                Exit Sub
            End If
        Next CurrCell
    End If
End Sub 
```

基本上，代码所做的是查看目标范围以查看是否选择了 N 列中的任何单元格，然后遍历 N 列中选择的任何单元格以查看它们的值是否包含 MCO（您可以摆脱如果您只需要在单元格仅包含“MCO”时出现提示，则为星号），如果是这样，则提示用户并退出。

希望有帮助。

-乔恩

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T16:58:01.670

您是在寻找宏解决方案还是 vba 解决方案。两者是不同的。对于使用宏重新编码器执行步骤的宏，对于 VBA 解决方案，从 Jon 的答案开始

# build-process - VBC + NAnt。编译 WinForm 时出错

> ID：417261
> 
> 赞同：0
> 
> 时间：2009-01-06T16:43:41.990
> 
> 标签：build-process, nant, vbc

首先应该注意的是，我试图避免重写我的所有脚本以使用 msbuild。

我注意到在将 NAnt 与 VBC 任务一起使用并编译 WinForms 应用程序时存在几个问题。主要问题似乎是 VBC 找不到 Sub Main。这很奇怪，因为在 VS 中，没有迹象表明我对 vbc 的调用与 msbuild 对 vbc 的调用之间存在任何差异。

是否有人对此问题的解决方案或强制创建可能/可能不会由 MSBuild/VS 生成的其余部分类的方法有任何见解？

示例构建脚本：

```
<?xml version="1.0" encoding="utf-8" ?>
<project xmlns="http://nant.sf.net/release/0.85/nant.xsd" name="Test" default="build">
    <target name="build">
        <vbc target="winexe" output="C:\Test.exe" main="WindowAppNantTest.My.MyApplication" verbose="true" rootnamespace="WindowAppNantTest">
            <imports>
                <import namespace="Microsoft.VisualBasic"/>
                <import namespace="System.Windows.Forms"/>
            </imports>
            <sources>
                <include name="**/**/*.vb"/>
            </sources>
        </vbc>
    </target>
</project> 
```

错误：[vbc] vbc：错误 BC30420：在“WindowAppNantTest.My.MyApplication”中找不到“Sub Main”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T17:19:32.103

看起来问题来自**main**和**rootnamespace**属性。当您将它们切换为以下内容时会发生什么：

```
<vbc target="winexe" output="C:\Test.exe" main="MyApplication" verbose="true" rootnamespace="WindowAppNantTest.My">
    <imports>
        <import namespace="Microsoft.VisualBasic"/>
        <import namespace="System.Windows.Forms"/>
    </imports>
    <sources>
        <include name="**/**/*.vb"/>
    </sources>
</vbc> 
```

或类似以下内容：

```
<vbc target="winexe" output="C:\Test.exe" main="My.MyApplication" verbose="true" rootnamespace="WindowAppNantTest">
    <imports>
        <import namespace="Microsoft.VisualBasic"/>
        <import namespace="System.Windows.Forms"/>
    </imports>
    <sources>
        <include name="**/**/*.vb"/>
    </sources>
</vbc> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-27T23:13:38.907

我不确定您的意思是不想在 NAnt 中使用 msbuild，还是不想批量切换到 msbuild 脚本。

如果是后者，那么我对您关于同一主题的其他帖子的回复在这里也有效。

您可以使用 NAnt contrib (http://nantcontrib.sourceforge.net/) 并在您的 NAnt 脚本中使用 msbuild。

msbuild 任务的参考是：

[http://nantcontrib.sourceforge.net/release/latest/help/tasks/msbuild.html](http://nantcontrib.sourceforge.net/release/latest/help/tasks/msbuild.html)

和相关的片段：

```
<target name="build" depends="clean">
     <msbuild project="ProjectName.vbproj" />
</target> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T22:15:22.857

您需要做的是在您的 VBC 命令中设置以下内容：

```
<references>
  <include name="System.Windows.Forms.dll"/>
  <indlude name="Microsoft.VisualBasic.dll"/>
</references> 
```

这应该可以解决您的问题。（我猜第二个 dll 是因为我是一名 CS 人）但是编译的语法几乎相同。

在我从事的所有项目中，您总是需要设置引用以包含任何 DLL，无论它们来自 .Net、第 3 方还是您自己的（即项目引用），否则它们将无法正确链接。

试一试，看看会发生什么。

# cocoa-touch - 开发一个基于 NavigationBar 的应用程序，包括一个 Open GL 视图：如何？

> ID：417262
> 
> 赞同：0
> 
> 时间：2009-01-06T16:44:01.833
> 
> 标签：cocoa-touch, opengl-es

我的问题从一个问题开始：

我在 Xcode 中开始了一个项目：一个基于导航栏的项目（带有一个 TableView）。然后我通过 IB 或以编程方式添加了一些视图……效果很好。

然后，我决定编写自己的 ViewClass，继承自 UIView，称为 OpenGlView（基于 XCode 中 Basic OpenGlES 项目提供的视图）及其`OpenGlViewController`（继承自`UIViewController`）。

这工作正常，直到我尝试将视图控制器推入我的导航栏：然后我收到一个**"EXC__ BAD __ACCESS"**。我不明白为什么除了用于显示 OpenGL 内容的视图之外，任何视图都可以...

而且我实际上不知道如何设法开发基于 NavBar 的应用程序，包括显示 OpenGL 内容的视图……知道吗？

（我还尝试将之前添加到 NavigationBar`OpenGlView`的基本的子视图添加为子视图，但我收到了同样的错误）。`UIView`

**在 RootController 中：**

```
OpenGlViewController *glvController;

if (glvController == nil) 
{
    glvController = [[OpenGlViewController alloc] initWithNibName:@"Gl View" bundle:nil];
    glvController.title = @"GL View";
}
[self.navigationController pushViewController:glvController animated:YES]; 
```

**在 OpenGLViewController 中：**

```
- (void)loadView {
OpenGlView * view;
view = [[OpenGlView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame]];
self.view = view;
[view release];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T19:36:00.067

如果它已本地化到您的 OpenGL 视图，则崩溃可能是由于未正确初始化视图内的 OpenGL 项所致。 [请参阅此处](https://stackoverflow.com/questions/260391/why-does-calling-glmatrixmodeglprojection-give-me-excbadaccess-in-an-iphone#266005)了解我对可能类似问题的建议。

# python - “|”是什么意思 在 Django 模板中签名是什么意思？

> ID：417265
> 
> 赞同：8
> 
> 时间：2009-01-06T16:44:18.027
> 
> 标签：python, django, django-templates

我经常看到这样的事情： `something.property|escape`

* * *

`something`是一个对象，`property`是它的字符串属性。`escape`- 我不知道 :)
这是什么意思？以及它使用的最小python版本是什么？

编辑：这个问题被问错了，它说“在 Python 中是什么意思”，所以按位或答案是正确的，但无关紧要，请不要对它们投反对票

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-06T18:27:44.870

管道字符表示您要将左侧的结果发送到右侧定义的过滤器。过滤器将以某种方式修改该值。

“逃生”过滤器只是众多过滤器之一。

内置过滤器列表可以在这里找到： [Django 文档 - 内置过滤器参考](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#built-in-filter-reference)

在 django 模板中 | 字符绝对不是“按位或”运算符。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-06T16:55:04.510

obj.property|escape 是[在模板中应用转义过滤器](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#built-in-filter-reference)的方法，它将 HTML 转义该属性的字符串表示形式。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-06T16:46:54.853

这是一个按位的“或”。如果属性不存在/为空，则表示转义。

# c# - 将 Windows 窗体工具提示锚定到鼠标

> ID：417269
> 
> 赞同：2
> 
> 时间：2009-01-06T16:45:43.093
> 
> 标签：c#, mouse, tooltip, onmousemove

我想在将鼠标悬停在按钮上时显示工具提示，只要鼠标悬停在按钮上，工具提示就应该跟随鼠标。实现这一目标的正确方法是什么？

当我添加一个使用更新的鼠标位置调用 tooltip.Show(...) 的 MouseMove 事件时，它会极度闪烁，并且在鼠标静止时还会重绘工具提示。如果它是 OwnerDraw 工具提示，我可以看到默认的系统工具提示样式与自绘工具提示“战斗”。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T15:32:10.937

事实上，在 .Net 2.0 中，ToolTip 对象已被更改。在 2.0 之前，在 ToolTip 处于活动状态时或在某些其他情况下更改 ToolTip 文本时会出现一些不一致的问题。从 2.0 开始，每次发生可能影响当前活动的 Tooltip 的情况时，Tooltip 都会被隐藏。

虽然这解决了一些问题，但它现在会导致一些事件在例如 SetToolTip() 之后立即被触发，即使这个函数已经在这个事件中被调用，导致 ToolTip 绘制/隐藏的无限循环，直到鼠标移开工具提示区域。

我自己的解决方法是检查 ToolTip 是否已经相同，如果是则省略 Set ToolTip()。（简单地通过上面建议的静态标志省略下一个事件可能会导致问题，因为不能保证之后会有一个新事件，例如，如果鼠标刚刚接触到工具提示区域并已经移开）。

此外，仅使用 OnMouseHover 来显示 Tooltip 会禁用 ToolTip 组件的内部计时器功能，并导致许多不必要的事件，因此浪费处理器时间。ToolTip 组件的 Popup Event 可以很好地用作操作点。

然而，在这种特殊情况下，OnMouse Hover 是跟踪鼠标移动所必需的。无论如何，更改 ToolTip 位置会导致 Tooltip 完全重绘，因此会闪烁。通过检查鼠标位置是否在两个事件之间发生变化，可以减少静止鼠标的这种情况。不幸的是，ToolTip 组件无法更改 ToolTip 的位置，并且总是相对于当前鼠标位置显示。所以让它跟随鼠标的唯一方法是关闭并重绘它。

将 UseFading 和/或 UseAnimation 属性设置为 false 可能有助于进一步减少闪烁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T17:05:39.480

好的，这可能完全是矫枉过正，可能不是最好的解决方案，但我认为这是一个有趣的小技巧。

基本上，我在鼠标的位置绘制一个 ListView。一些代码：

```
ListView v = new ListView();
        public Form1()
        {
            InitializeComponent();
            v.Items.Add("Foo");
            v.Height = 30;
            v.Width = 50;
            this.button1.Controls.Add(v);
            v.MouseMove += new MouseEventHandler(v_MouseMove);
            v.BackColor = SystemColors.Info;

            this.button1.MouseMove += new MouseEventHandler(button1_MouseMove);
        }

        void v_MouseMove(object sender, MouseEventArgs e)
        {
            v.Location = new Point(v.Location.X + e.Location.X, v.Location.Y + e.Location.Y);
        }

        void button1_MouseMove(object sender, MouseEventArgs e)
        {
            v.Location = e.Location;
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T16:51:48.433

我注意到，当使用 OnMouseHover 手动显示工具提示时，在显示工具提示后再次调用 OnMouseMove 一次。作为一个黑客，我忽略了显示工具提示之后的下一个 OnMouseMove 调用（使用标志）。也许正在发生类似的现象？

# .net - .NET 属性：为什么 GetCustomAttributes() 每次都创建一个新的属性实例？

> ID：417275
> 
> 赞同：12
> 
> 时间：2009-01-06T16:47:04.183
> 
> 标签：.net, performance, attributes

所以我在 .NET 中使用了更多的属性，并意识到每次调用 Type.GetCustomAttributes() 都会创建我的属性的一个新实例。这是为什么？我认为属性实例基本上是一个单例每个成员信息，有 1 个实例绑定到类型、PropertyInfo 等...

这是我的测试代码：

```
using System;

namespace AttribTest
{
[AttributeUsage(AttributeTargets.Class)]
class MyAttribAttribute : Attribute
{
    public string Value { get; set; }

    public MyAttribAttribute()
        : base()
    {
        Console.WriteLine("Created MyAttrib instance");
    }
}

[MyAttrib(Value = "SetOnClass")]
class MyClass
{
}

class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine("Getting attributes for MyClass.");
        object[] a = typeof(MyClass).GetCustomAttributes(false);
        ((MyAttribAttribute)a[0]).Value = "a1";

        Console.WriteLine("Getting attributes for MyClass.");
        a = typeof(MyClass).GetCustomAttributes(false);
        Console.WriteLine(((MyAttribAttribute)a[0]).Value);

        Console.ReadKey();
    }
}
} 
```

现在，如果*我*要实现属性，我希望输出是：

```
Created MyAttrib instance
Getting attributes for MyClass.
Getting attributes for MyClass.
a1 
```

“类加载器”（对不起，我有更多的 Java 背景，不是 100% 确定 .net 如何加载其类型）将编译 MyClass，并创建 MyAttribAttribute 的实例，并将它们一起存储在某个地方。（如果这是 Java，可能是堆中的 Perm Gen）然后对 GetCustomAttributes() 的 2 次调用将返回相同的较早创建的实例。

但实际输出是：

```
Getting attributes for MyClass.
Created MyAttrib instance
Getting attributes for MyClass.
Created MyAttrib instance
SetOnClass 
```

所以为什么？似乎为每次调用创建所有这些对象的新实例有点过分，并且不利于性能/内存管理。有没有办法总是一遍又一遍地获得相同的实例？

任何人都有任何想法为什么它是这样设计的？

我完全关心的原因是因为我创建了一个内部保存一些验证信息的自定义属性，所以在属性中我基本上有一个“private bool Validated”，我设置为 true。验证的东西需要一段时间，所以我不想每次都运行它。现在的问题是，因为每次我获得属性时它都会创建一个新的属性实例，所以 Validated 总是“假”。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-06T16:49:02.057

属性不作为对象存储在内存中，它们仅作为元数据存储在程序集中。当您查询它时，它将被构造并返回，并且通常属性是一次性对象，因此运行时保留它们以防万一您再次需要它们可能会浪费大量内存。

简而言之，您需要找到另一种方式来存储您的共享信息。

这是关于属性的[文档。](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/attributes/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-06T16:55:17.147

对象创建很便宜。

如果你有一个像

```
public class MyAttribute : Attribute {
    public virtual string MyText { get; set; }
} 
```

并将其应用于类似的类

```
[MyAttribute(MyText="some text")]
public class MyClass {
} 
```

你找回了一个像

```
var attr =
    typeof(MyClass).GetCustomAttributes(typeof(MyAttribute), false)
    .Cast<MyAttribute>().Single(); 
```

你在它上面设置了一些属性，比如

```
attr.MyText = "not the text we started with"; 
```

下次打电话时会发生*什么*，*会*发生什么

```
Console.WriteLine(
    typeof(MyClass).GetCustomAttributes(typeof(MyAttribute), false)
    .Cast<MyAttribute>().Single().Name
); 
```

?

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T16:51:15.983

这是因为属性保存在元数据中。属性应该用于诸如“用户友好的属性名称”等信息......

# apache-flex - Actionscript：如何确定某些加载内容的类型？

> ID：417276
> 
> 赞同：0
> 
> 时间：2009-01-06T16:47:16.990
> 
> 标签：apache-flex, actionscript-3

我有一种情况，我正在使用 URLLoader 加载一些内容，但内容可能是视频（flv 或 swf）、图像（jpg 或 png 或 gif）或 swf。诀窍是，我需要根据加载的内容类型以不同的方式做出反应，而不必事先知道它是什么类型的内容。

我目前已经炮制了一个精心设计的解决方案（精心设计是指一系列令人困惑的 if 语句和 try...catch 块），包括尝试将其加载到控件中并捕获错误（例如：我将创建一个图像例如，为 ioError 事件添加一个事件侦听器，它已被接收，我认为它不是图像或 swf ......）但它看起来有点像 hack。

是否有任何干净的方法来确定从 URLLoader 加载的内容的类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T17:12:00.467

您可能应该查看标题以确定文件类型。

例如，所有 SWF 文件都应以 0x46、0x57、0x53（“FWS”）或 0x43、0x57、0x53（“CWS”）开头（如果它们被压缩）。

这些将是 URLLoader.data 数组中的字节 0 到 2。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T19:25:45.970

看看：[http](http://code.google.com/p/as3httpclient/wiki/Links) ://code.google.com/p/as3httpclient/wiki/Links以确定响应标头。我将它用于另一个目的并且效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T19:06:04.260

遗憾的是，如果您不使用 AIR，那么（至少在今天）您将无法访问 HTTP 响应（即 URLLoader.httpResponseStatus）标头。因此，您的“炮制”方法（我实际上自己使用过！）可能暂时是合适的，就像之前的海报一样。

不过，Adobe 似乎有一个未解决的问题：

[http://bugs.adobe.com/jira/browse/FP-251](http://bugs.adobe.com/jira/browse/FP-251)

……所以至少是这样的。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T20:27:22.490

也许像

```
switch(your_request.url.split('.')[1]){
  case 'jpg':
  case 'swf':
} 
```

# java - Java中实例方法同步的等价代码

> ID：417285
> 
> 赞同：8
> 
> 时间：2009-01-06T16:50:43.537
> 
> 标签：java, synchronization

在讨论 Java 同步[问题](https://stackoverflow.com/questions/416183/in-java-critical-sections-what-should-i-synchronize-on#416324)时，有人评论说以下代码片段不等效（并且可能编译为不同的字节码）：

```
public synchronized void someMethod() {
  //stuff
} 
```

和

```
public void someMethod() {
  synchronized (this) {
    //stuff
  }
} 
```

它们是等价的吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-06T17:14:46.310

它们在功能上是等效的，尽管我测试的编译器（Java 1.6.0_07 和 Eclipse 3.4）生成不同的字节码。第一个生成：

```
// access flags 33
public synchronized someMethod()V
  RETURN 
```

第二个生成：

```
// access flags 1
public someMethod()V
  ALOAD 0
  DUP
  MONITORENTER
  MONITOREXIT
  RETURN 
```

（感谢[ASM](http://asm.objectweb.org/)的字节码打印）。

因此它们之间的差异持续到字节码级别，并且由 JVM 来使它们的行为相同。但是，它们确实具有相同的功能效果 - 请参阅 Java 语言规范中的[示例](http://web.archive.org/web/20120212170310/http://java.sun.com/docs/books/jls/third_edition/html/classes.html#8.4.3.6)。

应该注意的是，如果该方法在子类中被覆盖，则它不一定是同步的——因此在这方面也没有区别。

我还运行了一个测试来阻止一个线程尝试在每种情况下访问监视器，以比较它们的堆栈跟踪在线程转储中的样子，并且它们都包含有问题的方法，所以那里也没有区别。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-06T16:58:59.760

我最初的评论是这些陈述是相同的。

在这两种情况下，首先发生的事情是调用线程将尝试获取当前对象的（意思是`this`'）监视器。

我不知道不同的字节码，我很高兴听到不同之处。但实际上，它们是 100% 相同的。

**编辑：**我要澄清这一点，因为这里有些人弄错了。考虑：

```
public class A {
    public synchronized void doStuff()
    {
        // do stuff
    }
}

public class B extends A {
    public void doStuff()
    {
        // do stuff
        // THIS IS OVERRIDE!
    }
} 
```

在这种情况下`doStuff()`，B 类仍然会覆盖`doStuff()`A 类，即使它没有同步。

**同步关键字绝不是合同的一部分！**不适用于子类，不适用于接口，不适用于抽象类。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-06T18:09:27.793

我发表了原始评论。我的评论是它们在逻辑上是等价的，但是**编译成不同的字节码**。

当时我没有添加任何其他内容来证明它的合理性，因为实际上没有什么可以证明的——它们只是*编译*成不同的字节码。如果您将方法声明为*synchronized*，则该同步是方法定义的一部分。**方法中的同步块*不是*方法定义的一部分**，而是涉及单独的字节码来获取和释放监视器，如上面的一张海报所示。严格来说，它们是略有不同的东西，尽管**对于*你程序的整体逻辑来说*，它们是等价的**。

这什么时候有关系？好吧，在大多数现代桌面虚拟机上，几乎没有。但例如：

*   VM 原则上可以在一种情况下进行优化，但不能在另一种情况下进行优化
*   有一些 JIT 编译器优化，其中将**方法中的字节码数量作为优化的标准**
*   *没有*JIT 编译器的虚拟机（现在确实很少，但可能在较旧的移动设备上？）每次调用都会有更多的字节码要处理

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T16:58:27.030

是的。在实例方法上使用同步关键字使用“this”作为监视器，在类方法（静态方法）上使用它也使用类的类对象（Foo.class）。

这样，您可以同步整个方法，同时使用同步块样式将其与另一个方法中的代码片段同步。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T16:58:06.703

我看不出任何功能差异 - 两者都在 (this) 上同步它们的整个方法体。评论这些不同的人如何证明他们的说法是正确的？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-20T20:14:47.003

它们在功能上并不完全相同。其他代码可以使用反射来查看您的方法是否具有同步修饰符，但是如果不读取其字节码，则无法判断方法是否包含同步块。

确定方法是否同步的能力偶尔会派上用场。就个人而言，在面向方面的编程中进行同步时，我使用该标志来避免冗余锁定。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-16T09:23:54.553

```
MyObject myObjectA;
MyObject myObjectB;

public void someMethod() {
  synchronized (this) {
    //stuff
  }
}

public void someMethodA() {
  synchronized (myObjectA) {
    //stuff
  }
}

public void someMethodB() {
  synchronized (myObjectB) {
    //stuff
  }
} 
```

在这种情况下：

*   `someMethod`阻止整个班级
*   `someMethodA``myObjectA`仅块
*   `someMethodB``myObjectB`仅块
*   `someMethodA`并且`someMethodB`可以同时调用

# javascript - Flash 中的 JavaScript

> ID：417286
> 
> 赞同：1
> 
> 时间：2009-01-06T16:51:05.937
> 
> 标签：javascript, flash, actionscript

我有一个 java 脚本代码，在通过浏览器运行时可以正常工作，有没有办法我可以在 flash 中使用该代码而无需太多编辑，我希望通过 flash 获取用户的输入并让代码进行计算和显示闪现的结果，有什么线索吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T17:05:39.120

好吧，ActionScript 1 本质上是 javascript，而 2 只是在它之上的一些语法糖。如果您正在创建 Flash 8 或更早版本的电影，那么您应该能够使用 javascript 代码而无需进行太多调整（最好切换到使用类而不是原型）。将其移至 ActionScript 3（用于 Flash 9 或更高版本）将需要更多工作，因为它对类型等更严格，但可能仍然不太困难。

正如其他人所提到的，Flash 中与 UI 相关的内容与 Javascript 完全不同，因为没有 DOM。我假设您所说的方法是用于计算的，与 UI 完全没有关系。如果您的 javascript 方法实际上是在做 UI 的东西，那么将它们移到 Flash 会涉及更多。

另一种可能性是，如果您想将代码保留在 javascript 中（也许这样您可以将其与其他 javascript 内容一起使用），那么您可以创建一个 Flash 电影来接受输入，将其传递给 javascript，然后让 javascript 将结果报告回闪光。查看 Flash [ExternalInterface](http://livedocs.adobe.com/flash/8/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00002200.html#232104)文档（另请参见[此处](http://livedocs.adobe.com/flash/8/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001600.html)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T18:15:55.203

查看[ExternalInterface](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html)，它允许您从 actionscript 调用 javascript 函数，反之亦然。我们在工作中毫无问题地使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T17:08:43.233

语法大致相同，但没有 DOM。相反，您有对象引用。这有点像你在 VB 之类的东西中所做的。变量范围的工作方式也不同。

您不是显示或隐藏 DIVS，也不是转到页面，而是移动到时间线中显示或隐藏不同对象的不同位置。如果你是一个传统的程序员，你需要花点力气去理解它，但它的内部仍然很像 JavaScript。

您可能可以采取很多逻辑并回收它，但是 UI 挂钩需要进行一些更改。

# memory-management - 分析我的程序的低级内存访问的分析

> ID：417292
> 
> 赞同：5
> 
> 时间：2009-01-06T16:52:30.723
> 
> 标签：memory-management

我必须分析几个程序的内存访问。我正在寻找的是一个分析器，它允许我查看我的哪个程序是内存密集型而不是计算密集型。我对访问 L1 数据缓存、L2 和主存的次数非常感兴趣。

它需要适用于 Linux，并且仅适用于命令使用。编程语言是c++。如果我的问题有任何问题，例如我不明白您的意思或我们需要更多数据，请在下方评论。

谢谢你。

**更新解决方案**

我选择了 Crashworks 的答案作为最喜欢的答案，因为它是唯一提供了我正在寻找的东西的答案。但是问题仍然悬而未决，如果您知道更好的解决方案，请回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T16:59:47.137

不可能确定对内存的所有访问，因为它没有多大意义。对内存的访问可能是执行下一条指令（程序驻留在内存中），或者当您的程序读取或写入变量时，因此您的程序几乎**一直在**访问内存。

对您来说更有趣的是跟踪程序的内存使用情况（堆和堆栈）。在这种情况下，您可以使用标准的**top**命令。

您还可以监视系统调用（即写入磁盘或附加/分配共享内存段）。在这种情况下，您应该使用**strace**命令。

一个更完整的控制是通过**gdb**调试器来调试你的程序。它可以让您控制您的程序，例如为变量设置断点，以便在读取或写入程序时中断程序（也许这就是您要寻找的）。另一方面，GDB 可能很难学习，因此 DDD，它是一个 gtk 图形前端，将帮助您开始使用它。

**更新**：您正在寻找的是真正的低级内存访问，它在用户级别不可用（这是操作系统内核的任务）。我不确定甚至 L1 缓存管理是否由 CPU 透明处理并隐藏到内核。很明显，您需要降低到内核级别，因此 KDB，[在此处](http://www.ibm.com/developerworks/linux/library/l-kdbug/)解释o KDBG，[在此处](http://www.mail-archive.com/linux-net@vger.rutgers.edu/msg01318.html)进行解释。

**更新 2**：似乎 Linux 内核确实处理 CPU 缓存，但只处理 L1 缓存。《[Understanding the Linux Virtual Memory Manager](http://www.informit.com/store/product.aspx?isbn=0131453483) 》一书解释了 Linux 内核的内存管理是如何工作的。[本章](http://www.informit.com/articles/article.aspx?p=336868&seqNum=9)解释了 L1 缓存处理的一些内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T03:13:30.510

也许[cachegrind](http://valgrind.org/info/tools.html#cachegrind)（valgrind 套件的一部分）可能是合适的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T09:03:51.550

如果您正在运行 Intel 硬件，那么 VTune for Linux 可能是您可以使用的最好和最全功能的工具。

否则，您可能不得不使用[perfctr](http://sourceforge.net/projects/perfctr/)库直接读取性能计数器 MSR。我自己在 Linux 上没有这方面的经验，但我发现了几篇可能对你有帮助的论文（假设你在 x86 上——如果你正在运行 PPC，请回复，我可以提供更详细的答案）： [http ://ieeexplore.ieee.org/Xplore/login.jsp?url=/iel5/11169/35961/01704008.pdf?temp=x](http://ieeexplore.ieee.org/Xplore/login.jsp?url=/iel5/11169/35961/01704008.pdf?temp=x) [http://www.cise.ufl.edu/~sb3/files/pmc。 pdf](http://www.cise.ufl.edu/~sb3/files/pmc.pdf)

一般来说，这些工具无法准确告诉您缓存未命中发生在哪些行上，因为它们通过轮询计数器来工作。您需要做的是在您感兴趣的每个函数的开头和结尾轮询“l1 缓存未命中”计数器，以查看该函数内部发生了多少未命中，当然您可以分层执行此操作。这可以通过*例如*发明一个类来简化，该类记录进入范围时的开始计时器并计算离开范围时的增量。

VTune 的检测模式会在整个程序中自动为您执行此操作。等效的 AMD 工具是 CodeAnalyst。[Valgrind](http://valgrind.org/)声称是一个开源缓存分析器，但我自己从未使用过它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T16:57:58.747

你需要比 unix 命令`top`提供的更多的东西吗？这以易于阅读的演示格式提供了 linux 程序的 cpu 使用和内存使用。

如果您需要更具体的东西，也许是分析器，软件语言（java/c++/等）将帮助确定哪种分析器最适合您的情况。

# visual-studio - 将项目从 VS2003 迁移到 VS2005 时应该注意什么

> ID：417295
> 
> 赞同：2
> 
> 时间：2009-01-06T16:53:15.043
> 
> 标签：visual-studio, visual-studio-2005, migration, visual-studio-2003

在不久的将来，我会将一些 Web 应用程序从 VS2003 项目迁移到 VS2005 项目。

我应该注意什么？

过去有没有人做过这件事，结果变坏了？

我预计迁移项目需要多长时间？

我知道这不仅仅是一个问题，但请提供您与将项目从 VS2003 迁移到 VS2005 相关的任何经验。

谢谢

***编辑***

我将要迁移的项目类型是用 Visual Basic 编写的 Web 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T18:52:36.380

你绝对必须去VS2005而不是直接去VS2008吗？

尽管 Web 应用程序项目是为 VS2005 实现的，首先使用附加组件，后来使用服务包 IIRC，但升级 VS2003 Web 项目非常不稳定。

我们有十几个运行 ASP.NET 1.1 的生产网站（全部用 VB.NET 编写），并希望继续前进……事实证明这是一场彻头彻尾的噩梦（即使安装了 Web 应用程序项目），我们放弃了我们没有足够的资源来坚持。

然后VS2008出现了，我又去了。

宾果游戏，完全没有问题。项目升级向导刚刚运行，有一些琐碎的代码修复，它就可以正常工作。

大约一个小时从VS2003直接到VS2008。所有站点都运行相同的代码库，升级就像复制文件夹并更改 IIS 管理工具以指定 ASP.NET 2.0 一样简单。

我想你可以猜到我的建议是什么！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T16:58:03.507

请注意网站项目和 Web 应用程序项目之间的区别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T19:07:45.350

我真的会直接去VS2008。如果需要，您可以“限制”您的项目，使其“仅”使用 .NET 2.0。

至于要注意什么——我发现 ASP.NET 1.1 和 ASP.NET 2.0 是非常不同的生物。ASP.NET 1.1 允许您将对象放在网页上，就像在桌面表单应用程序上放置按钮、标签和文本框一样。这在 2.0 中不再适用。当我开始从事我当前的项目时，我有很多自我教育，因为我真的必须学习如何使用 ASP 标签（div、样式表等）布置表示层的东西。代码隐藏仍然相同 - 实际上处理得更好。这一切都取决于您要迁移的 Web 项目类型以及它们最初是如何编写的。

# sql - 为数据仓库设置 Dim 和 Fact 表

> ID：417304
> 
> 赞同：1
> 
> 时间：2009-01-06T16:55:20.280
> 
> 标签：sql, multidimensional-array, data-warehouse

我的任务是为客户创建一个数据仓库。所涉及的表格并没有真正遵循那里的传统示例（产品/订单），所以我需要一些帮助才能开始。客户端本质上是案件的处理中心（类似于法律案件）。每天，都有新的案例被输入到“案例”表下的数据库中。每列都包含一些与案例相关的信息。在处理案例时，将使用与案例相关的事件填充额外的一对多表。这些事件表有很多，示例表可能是：（case-open、case-dept1、case-dept2、case-dept3 等）。这些表中的每一个都有一个映射回“案例”表的 caseid。还涉及一些查找表。

目前，报告需求涉及暴露各个阶段的瓶颈，并且对于流程的某些区域，粒度为小时级别。

我可能在这里问的太多了，但我正在寻找有关如何设置 Dim 和 Fact 表或您可能有的任何其他建议的方向。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T17:07:12.800

事实表是案例事件，它是“无事实的”，因为它没有数值。维度可能是时间、事件类型、案例，可能还有其他一些，具体取决于系统中的其他数据。

您需要将事件表合并到一个事实表中，并标有“事件类型”维度。吞吐量/瓶颈报告正在计算给定案例中特定事件类型组合的事件时间之间的差异。

报告应计算事件事件时间，并可能将它们放入直方图中。您还可以标记某些类型的事件组合并将标签应用于感兴趣的事件。然后可以根据这些事件记录时间，这将允许使用 OLAP 工具对时间进行切片和切块操作。

如果您想对生命周期进程中的某些阶段进行基准测试，您将有一个表格，其中包含案例类型、事件类型 1、事件类型 2、基准时间。

通过一些按摩，您可能能够使用数据挖掘工具包甚至是简单的回归分析来发现案例属性和事件事件时间 (YMMV) 之间的相关性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T17:08:52.720

我建议你看看 Kimball 的书，尤其是[这](https://rads.stackoverflow.com/amzn/click/com/0471200247)本书，它应该有一些例子让你思考你的问题领域的应用程序。

在任何情况下，您都需要确定维度模型是否合适。很有可能使用不同的索引或摘要等来处理 3NF 数据库“企业数据仓库”。

没有看到你当前的模式，真的很难说。听起来你最终会得到几个明星模型，它们有一些一致的尺寸将它们联系在一起。因此，您可能将案例尺寸作为您的一致尺寸之一。来自其他表的事实实际上是既链接到符合标准的维度也链接到适用于事实的任何其他维度的事实表，因此，例如，如果在 case-open 中有一个员工 ID，它将链接到符合员工标准的维度，来自案例开放事实表。这个符合标准的维度可能会从您的几个辅助事实表中链接多次。

Kimball 的建模方法相当简单，可以像食谱一样遵循。您需要首先识别所有事实，将它们分组到事实表中，识别每个事实表上的各个维度，然后根据需要将它们分组到维度表中，并确定每个维度的类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-14T21:16:03.880

与开发的任何其他方面一样，您必须从最终需求（“用户故事”，如果您愿意的话）向后处理问题。仓库最保守的方法是简单地表示事务数据库的副本。从那里，在需求的指导下，可以进行某些优化以增强某些数据访问模式的性能。然而，我认为重要的是，将这些视为优化，而不是假设数据仓库自动必须是每个事实的每个可能维度的复杂爆炸。我的经验是，对于大多数目的，直接表示对于 90% 以上的分析查询来说已经足够甚至是理想的了。对于其余部分，首先考虑索引、索引视图、附加统计信息或其他可以在不影响结构的情况下进行的优化。然后，如果需要聚合或其他冗余结构来提高性能，请考虑将它们分成一个“数据集市”（至少在概念上），它提供原始事实与其冗余之间的分离。最后，如果需求过于流动并且聚合需求过于繁重而无法以这种方式有效运行，那么您可能会考虑数据的大规模爆炸，即星型模式。不过，再次将其限制为数据的最小横截面。如果需求太流动并且聚合需求太重而无法以这种方式有效运行，那么您可能会考虑数据的大规模爆炸，即星型模式。不过，再次将其限制为数据的最小横截面。如果需求太流动并且聚合需求太重而无法以这种方式有效运行，那么您可能会考虑数据的大规模爆炸，即星型模式。不过，再次将其限制为数据的最小横截面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T03:31:24.523

这就是我想出的本质。感谢NXC

## 事实事件

EventID TimeKey CaseID

## 昏暗的事件

EventID 事件描述

## 昏暗的时间

时间键

## 昏暗区域

RegionID RegionDesc

## 案例

CaseID 区域ID

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T16:53:24.133

这可能是在您考虑问题之前选择解决方案的情况。并非所有数据仓库都适合星型模式模型。我没有看到您在这里汇总任何数据。到目前为止，我们有一个无事实的事实表和至少一个快速变化的维度（案例）。

看看我目前所看到的，我认为这个数据库中的中心实体应该是这样的。试图把事件放在中间似乎是不对的。尝试以不同的方式看待它。或许，案例、事件和案例事件要开始。

# sql-server-2005 - SQL Server 2005 中的一个数字可以存储多少位？

> ID：417305
> 
> 赞同：0
> 
> 时间：2009-01-06T16:55:21.670
> 
> 标签：sql-server-2005, oracle, precision, significant-digits

我有一个来自 47306832975095894070.85314746810624532 的 Oracle 数据库的号码。当我将它带入 SQL Server 时，它肯定不会显示那么多数字。它显示为 4.73068329750959E+19，该字段定义为 FLOAT。

我认为这可能包括所有有效数字，但有人问我这个数字是否可以完全按照 Oracle 的方式存储。是否有另一种数据类型可以存储所有数字？SQL Server 2005 中有没有办法以非指数形式显示数字，而是显示所有存储的数字？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T16:57:49.230

使用十进制数据类型。decimal(p,s) - p 是精度值，s 是比例值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T16:58:22.710

使用小数（38,17）代替浮点数。这应该允许您以与 Oracle 中相同的精度存储数字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T17:17:10.097

与[NUMBER](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements001.htm#SQLRF00222) *(p, s)* Oracle 数据类型在 Sql Server 上的等价物是[数字](http://msdn.microsoft.com/en-us/library/ms187746(SQL.90).aspx)*(p, s)*数据类型。请注意，*p*（精度）和*s*（比例）的默认值在两个平台上并不相同。

在 Sql Server 上，[浮点数](http://msdn.microsoft.com/en-us/library/ms173773(SQL.90).aspx)表示一个浮点数，它是一个完全不同的数字的[近似表示](http://blogs.msdn.com/ericlippert/archive/2005/01/10/floating-point-arithmetic-part-one.aspx)。在 Oracle 上，相当于[BINARY_DOUBLE](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements001.htm#i140621)。

# excel - 使用公式的动态超链接

> ID：417309
> 
> 赞同：0
> 
> 时间：2009-01-06T16:57:33.320
> 
> 标签：excel, formula

我需要在 URL 超链接中使用一个 ID，如下例所示：

> [http://www.wotnots.co.uk/property/images/property2402_image1.jpg](http://www.wotnots.co.uk/property/images/property2402_image1.jpg)

这里的 ID 是*2402*。我想将其更改为第一列中的 ID 号，并且每一行都不同。我希望 ID 号码与超链接中的号码相同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T17:09:58.893

我会使用 HYPERLINK 单元格函数来生成链接。例如：

```
Cell A2: 2402
Cell B2: =HYPERLINK("http://www. ... /property" & A2 & "_image1.jpg","Click to see ...") 
```

然后，您可以将公式复制到以下所有行中，对单元格 A2 的引用将更改为相对于当前行。

如有必要，这也可以使用 VBA 代码动态生成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T17:01:02.487

干得好。

`=Concatenate("[http://www.wotnots.co.uk/property/images/property](http://www.wotnots.co.uk/property/images/property)",$A1,"_image1.jpg ")`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T17:03:12.027

试试下面的公式：

```
="http://www.wotnots.co.uk/property/images/property"&A1&"_image1.jpg" 
```

# ruby-on-rails - 脚手架 ActiveRecord：相同数据类型的两列

> ID：417320
> 
> 赞同：25
> 
> 时间：2009-01-06T16:59:52.097
> 
> 标签：ruby-on-rails, ruby, activerecord, scaffolding

另一个基本的 Rails 问题：

我有一个数据库表，它需要包含对特定数据类型的两个不同记录的引用。

假设的例子：我正在制作一个视频游戏数据库。我有一张“公司”的表格。我希望每个“视频游戏”条目只有一个开发人员和一个发行商。

我知道如果我想拥有一家公司，我可以这样做：

```
script/generate Videogame company:references 
```

但我需要拥有两家公司。我宁愿不使用连接表，因为给定的数据类型只能有两个，而且我需要它们是不同的。

看起来答案应该很明显，但我在互联网上的任何地方都找不到。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-01-06T18:37:32.493

只是为了整理一下，在您的迁移中，您现在还可以执行以下操作：

```
create_table :videogames do |t|
  t.belongs_to :developer
  t.belongs_to :publisher
end 
```

由于您调用键 developer_id 和 publisher_id，模型应该是：

```
belongs_to :developer, :class_name => "Company"
belongs_to :publisher, :class_name => "Company" 
```

这不是一个大问题，但我发现随着与额外参数的关联数量的增加，事情变得不太清楚，所以最好尽可能坚持默认值。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-06T17:53:12.520

我不知道如何使用脚本/生成来做到这一点。

无论如何，不​​使用脚本/生成更容易显示基本思想。您需要视频游戏表/模型中的两个字段来保存公司表/模型的外键。

我将向您展示我*认为*代码的样子，但我还没有测试过它，所以我可能是错的。

您的迁移文件具有：

```
create_table :videogames do |t|
  # all your other fields
  t.int :developer_id
  t.int :publisher_id
end 
```

然后在你的模型中：

```
belongs_to :developer, class_name: "Company", foreign_key: "developer_id"
belongs_to :publisher, class_name: "Company", foreign_key: "publisher_id" 
```

您还提到希望这两家公司是不同的，您可以在检查该`developer_id != publisher_id`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T06:42:01.110

如果您想要特定于某个公司类型的任何方法或验证，您可以对公司模型进行子类化。这采用了一种称为单表继承的技术。有关更多信息，请查看这篇文章：[http ://wiki.rubyonrails.org/rails/pages/singletableinheritance](http://wiki.rubyonrails.org/rails/pages/singletableinheritance)

然后，您将拥有：

```
#db/migrate/###_create_companies
class CreateCompanies < ActiveRecord::Migration
  def self.up
    create_table :companies do |t|
      t.string :type  # required so rails know what type of company a record is
      t.timestamps
    end
  end

  def self.down
    drop_table :companies
  end
end

#db/migrate/###_create_videogames
class CreateVideogames < ActiveRecord::Migration
  create_table :videogames do |t|
    t.belongs_to :developer
    t.belongs_to :publisher
  end    

  def self.down
    drop_table :videogames
  end
end

#app/models/company.rb
class Company < ActiveRecord::Base 
  has_many :videogames
  common validations and methods
end

#app/models/developer.rb
class Developer < Company
  developer specific code
end

#app/models/publisher.rb
class Publisher < Company
  publisher specific code
end

#app/models/videogame.rb
class Videogame < ActiveRecord::Base 
  belongs_to :developer, :publisher
end 
```

因此，您可以使用 Company、Developer 和 Publisher 模型。

```
 Company.find(:all)
 Developer.find(:all)
 Publisher.find(:all) 
```

# actionscript-3 - 如何在 AS3 中获取类的别名字符串？

> ID：417334
> 
> 赞同：4
> 
> 时间：2009-01-06T17:05:03.287
> 
> 标签：actionscript-3

```
var alias:String = 'models.User';
registerClassAlias(alias, models.User);

// If I have the alias, then
// I can get the class like this:
var klass:Class = flash.net.getClassByAlias(alias);

// How do I do the reverse
// (get the alias from the class)?
//
// I want to do this, but I can't find a 
// 'getAliasByClass' function.
alias = getAliasByClass(klass); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T20:48:05.677

看看[flash.utils.describeType()](http://livedocs.adobe.com/flex/3/langref/flash/utils/package.html#describeType())

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T10:58:23.963

[getQualifiedClassName](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/utils/package.html#getQualifiedClassName())应该可以解决问题。

```
alias = flash.utils.getQualifiedClassName( klass );
// should return: "models::User" 
```

无论哪种方式，您都可以将类引用或类的实例传递给它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-09T16:03:54.777

如上所述，您可以调用[flash.utils.describeType()](http://livedocs.adobe.com/flex/3/langref/flash/utils/package.html#describeType())并在 Actionscript 对象的类上使用“反射”来查询对象的属性、属性和方法。

例如，以下[ObjectCodec.as](http://www.google.com/codesearch/p?hl=en&sa=N&cd=7&ct=rc#a2tKkY7STZE/trunk/ygg/encoding/amf/type/v3/ObjectCodec.as&q=lang:actionscript%20describeType&exact_package=http://yggsaw.googlecode.com/svn)的代码片段似乎使用“@”检索别名属性：

```
override protected function encodeComplex(o:Object, b:IBinary, context:IContext=null):void
{
        var desc:XML = describeType(o);
        var classAlias:String = desc.@alias;
        //...
} 
```

# svn - 有没有办法将 SourceSafe with HISTORY 迁移到 SVN 中？

> ID：417355
> 
> 赞同：5
> 
> 时间：2009-01-06T17:09:11.157
> 
> 标签：svn, version-control, visual-sourcesafe, visualsvn, visualsvn-server

有没有办法将带有 HISTORY 的 SourceSafe 迁移到 SVN 中？

理想情况下，我想使用 VisualSVN Server，但我真的不想丢失我的 SourceSafe 历史记录。如果我必须，我会的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-06T17:23:38.023

很久以前（似乎）我尝试使用[vss2svn](https://github.com/irontoby/vss2svn)将 SourceSafe DB 迁移到颠覆，但最终放弃了。IIRC有几个问题：

*   您必须确保 SS DB 是一致的（例如，Analyze 没有发现任何问题或能够修复它们）。
*   迁移数据库花了很长时间，因为它很大。
*   最后，由于解析日期的一些问题，迁移失败了。我无法找到问题的原因，但我想这是因为我们使用 DD.MM.YYY 日期格式而不是美国日期格式。

所以最后我们决定保持 SourceSafe DB 不变（只读），只是将当前版本迁移到 subversion。到目前为止，我们不得不返回 SourceSafe 进行检查的情况很少。

希望这可以帮助。

顺便说一句：无论您是使用 VisualSVN Server 还是直接使用 subversion (svnserver) 都没有关系。两种情况下的存储库格式相同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T17:13:08.687

试试[vss2svn](https://github.com/irontoby/vss2svn)脚本。

或者[vss2svn](http://www.codeplex.com/VSS2SVN)项目。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-07T23:28:16.330

我成功地转换了我们讨厌的 VSS 数据库，包括历史。我在这里写了一篇关于这段经历的博客[**。**](http://blog.digitaltools.com/post/2009/02/24/Visual-Source-Safe-to-Subversion-Conversion.aspx) 转换亮点是：

“所有转换工具还要求源 VSS 数据库在转换之前清除损坏。结果证明这比您想象的要困难和耗时。在数据库副本上运行 VSS 分析工具显示数百个损坏并且如果不蓝屏它正在运行的计算机就不会运行完成。

为了解决这个问题，我们通过删除我们不想转换的目录来减少副本数据库。不幸的是，VSS 将在删除过程中报告每个损坏，导致数百个消息框，用户必须无意识地单击这些消息框才能继续该过程。

一旦达到这一点，我们就使用工具 VSS2SVN 来创建导入 Subversion 的转储文件。”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-07T11:03:15.570

我们使用[Polarion SVN Importer](http://www.polarion.com/products/svn/svn_importer.php)将 VSS 迁移到具有完整历史记录的 SVN。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T23:30:57.190

我成功地使用[vss2svn](https://github.com/irontoby/vss2svn)脚本将几个源安全存储库迁移到 SVN。我的建议是，分小块进行——我们有很多小项目和几个中等规模的项目，它们都成功地转移到了 SVN。

我有几个问题：

*   大文件无法写入SVN转储文件格式，我提交了一个补丁让它工作，我想在我完成后有人写得更复杂一点。
*   未正确复制根目录结构。VSS 存储库被组织为 $/client/project。svn 存储库最终被组织为 svn://server/randomdirectory/anotherrandomdirectory/client/project。所以我在导入之前通过编辑转储文件来修复这些问题（我认为它是 find replace "/randomdirectory' with ''.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-17T17:36:24.783

是的，使用[Codeplex 上的 VSS2SVN 项目](http://www.codeplex.com/VSS2SVN)。我已对其进行了更新，以便在迁移到 SVN 时保持历史、评论、作者和日期属性。需要更长的时间，但我不认为这很重要，因为它不是你每天都做的事情。

它还可以选择使用 VSS 中超过特定​​日期的文件更新存储库，因此您可以稍后更新初始转储。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-01-07T22:43:38.873

在我的公司，我反复尝试使用 vss2svn 将（大）SourceSafe 存储库迁移到 Subversion。我什至对代码页支持做了一点贡献（我们的文件名是希腊语）。如果我没记错的话（这发生在去年春天；即 2009 年），我们的主要问题（让我们最终放弃迁移的问题）是在存储库的想要和不需要的部分之间交叉链接/移动的永久删除的文件被阻塞迁移。

我的建议：如果您无法在完全*分析*的存储库中完成此操作，请不要浪费更多时间。只需画一条线并从一个新的颠覆存储库开始。

注意：在 SourceSafe 中永久删除文件会使该文件完全无法恢复，这与 CVS/SVN 类型的源代码控制系统完全不兼容（我想，其他源代码控制系统也是如此）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-07-05T02:12:36.060

我公司开发了一个 Source Safe 到 Subversion 的迁移工具： [http ://www.abstrakti.com/Products/Krepost](http://www.abstrakti.com/Products/Krepost)

当我们不得不迁移客户的存储库时，该工具是在与其他所有工具出现问题后开发的。此外，这是唯一可以将**SourceSafe 标签**导入 SVN 的工具。此外，它能够处理大多数**SourceSafe 存储库损坏**，并为不想花几天时间调试 C# 代码的用户提供轻松的迁移。

如果您有任何问题，请告诉我，我很乐意为您提供帮助。

埃里克。

# reporting-services - MS Reporting Services 2005 - 报告订阅电子邮件仅偶尔工作

> ID：417357
> 
> 赞同：0
> 
> 时间：2009-01-06T17:09:42.700
> 
> 标签：reporting-services

我有一个内部客户，只有大约 30% 的时间从 MS Report Services 2005 收到他的电子邮件报告。它不会被垃圾邮件过滤器捕获。运行报告大约需要 2 分钟。Reporting Services 会在 60 秒后放弃吗？如何开始解决此问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T17:20:40.963

为自己设置订阅。每隔 5 分钟将它邮寄给您，持续几个小时。走着瞧吧...？

# database - 建模数据库中的继承

> ID：417363
> 
> 赞同：5
> 
> 时间：2009-01-06T17:10:54.213
> 
> 标签：database, inheritance

对于数据库作业，我必须为学校建模一个系统。部分要求是为员工、学生和家长建模信息。

在 UML 类图中，我将这三个类建模为人员类型的子类型。这是因为它们都需要地址数据等信息。

我的问题是：如何在数据库（mysql）中对此建模？

到目前为止的想法如下：

1.  创建一个包含每种类型的所有信息的单一人员表，并且根据所存储的类型将有很多空值。*（除非我非常*有说服力地论证了这个案例，否则我怀疑这会与讲师相处得很好）。
2.  一个包含三个外键的人员表，这些外键引用了子类型，但其中两个将为空 - 事实上，我什至不确定这是否有意义或可能？
3.  根据this [wikipage about django](http://code.djangoproject.com/wiki/ModelInheritance)，可以在子类型上实现主键，如下所示：

    ```
    "id" 整数 NOT NULL 主键引用 "supertype" ("id")
    ```

4.  还有一些我没想到的...

所以对于那些以前在数据库中建模继承的人；你是怎么做到的？你推荐什么方法，为什么？

非常欢迎链接到文章/博客文章或以前的问题。

谢谢你的时间！

更新

好的谢谢大家的回答。我已经有一个单独的地址表，所以这不是问题。

干杯，

亚当

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T17:20:46.643

4 桌工作人员、学生、家长和普通人。工作人员、学生和家长都有各自指向 Person 的外键（而不是相反）。

人员具有标识此人的子类是什么的字段（即员工、学生或家长）。

**编辑：**

正如 HLGM 所指出的，地址应该存在于单独的表中，因为任何人都可能有多个地址。（但是 - 我将不同意自己的观点 - 您可能希望故意将地址限制为每人一个，从而限制邮件列表等的选择）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T17:28:43.130

好吧，我认为所有方法都是有效的，并且任何因将其推到一张桌子上而打分的讲师（除非要求明确说您不应该这样做）由于他们自己的个人意见而取消了可行的策略。

我强烈建议您查看有关 NHibernate 的文档，因为它提供了执行上述操作的不同方法。我现在将尝试鹦鹉学舌。

您的选择：

*   1) 一张表，其中包含具有“分隔符”列的所有数据。此栏说明此人是什么样的人。这在简单的场景和（严重的）高性能中是可行的，在这种情况下连接会造成太大的伤害
*   2）每个类的表会导致列重复但会避免再次连接，因此它简单且速度更快（尽管在大多数情况下只有一个 lil 和索引可以缓解这种情况）。
*   3）“适当的”继承。标准化版本。你快到了，但你的钥匙在错误的地方 IMO。您的 Employee 表应该包含一个 PersonId 以便您可以执行以下操作：

    从employee.personId = person.personId 上的员工内部加入人员中选择employee.id, person.name

获取仅在人员表上指定名称的所有员工姓名。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T18:15:13.803

我会去＃3。

你的目标是给讲师留下深刻印象，而不是 PM 或客户。学者们往往不喜欢空值，并且可能（下意识地）惩罚你使用其他方法（依赖于空值）。

而且您不一定需要该 django 扩展名（主键...参考...）您可以为此使用普通的外键。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T17:20:52.350

“那么对于那些以前在数据库中建模继承的人；你是怎么做到的？你推荐什么方法，为什么？”

方法1和3都不错。差异主要在于您的用例是什么。

1）适应性——哪个更容易改变？几个与父表具有 FK 关系的单独表。

2）性能——需要更少的连接？一张单人桌。

大鼠。没有设计可以同时实现这两者。

此外，除了您的单表和 FK-to-parent 之外，还有第三种设计。

三个带有一些公共列的单独表（通常在所有子类表中复制并粘贴超类列）。这是非常灵活且易于使用的。但是，它需要三个表的联合来组装一个整体列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T17:49:55.070

OO 数据库经历了相同的事情并提出了几乎相同的选项。

如果重点是在数据库中对子类进行建模，那么您可能已经在按照我在真正的 OO 数据库中看到的解决方案进行思考（将字段留空）。

如果没有，您可能会考虑创建一个不以这种方式使用继承的系统。

继承应该总是非常谨慎地使用，这可能是一个非常糟糕的情况。

一个好的指导原则是永远不要使用继承，除非您实际上有代码对“父”类的字段执行不同的操作，而不是对“子”类中的相同字段执行不同的操作。如果您的类中的业务代码没有专门引用某个字段，那么该字段绝对不应该导致继承。

但同样，如果你在学校，那可能与他们试图教的内容不符......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T20:09:47.113

出于作业目的的“正确”答案可能是＃3：

```
Person
PersonId Name Address1 Address2 City Country

Student
PersonId StudentId GPA Year ..

Staff
PersonId StaffId Salary ..

Parent
PersonId ParentId ParentType EmergencyContactNumber .. 
```

其中 PersonId 始终是主键，也是最后三个表中的外键。

我喜欢这种方法，因为它可以很容易地代表具有多个角色的同一个人。例如，老师也很可能是父母。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T22:22:46.017

我建议五张表人学生职员家长地址

为什么 - 因为人们可以有多个地址，人们也可以有多个角色，并且您想要为员工提供的信息与您需要为家长或学生存储的信息不同。

此外，您可能希望将 name 存储为 last_name、Middle_name、first_name、Name_suffix（如 jr.），而不仅仅是 name。相信我，您会希望能够搜索 last_name！名称不是唯一的，因此您需要确保拥有唯一的代理主键。

在尝试设计数据库之前，请阅读有关规范化的内容。这是一个开始的来源：http: [//www.deeptraining.com/litwin/dbdesign/FundamentalsOfRelationalDatabaseDesign.aspx](http://www.deeptraining.com/litwin/dbdesign/FundamentalsOfRelationalDatabaseDesign.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-12T17:49:47.230

**超级类型 Person 应该这样创建：**

```
CREATE  TABLE Person(PersonID int primary key, Name varchar ... etc ...) 
```

**所有子类型都应该像这样创建：**

```
CREATE  TABLE IF NOT EXISTS Staffs(StaffId INT NOT NULL ,
  PRIMARY KEY (StaffId) ,  
  CONSTRAINT FK_StaffId FOREIGN KEY (StaffId) REFERENCES Person(PersonId)
  )

CREATE  TABLE IF NOT EXISTS Students(StudentId INT NOT NULL ,
  PRIMARY KEY (StudentId) ,  
  CONSTRAINT FK_StudentId FOREIGN KEY (StudentId) REFERENCES Person(PersonId)
  )

CREATE  TABLE IF NOT EXISTS Parents(PersonID INT NOT NULL ,
  PRIMARY KEY (PersonID ) ,  
  CONSTRAINT FK_PersonID  FOREIGN KEY (PersonID ) REFERENCES Person(PersonId)
  ) 
```

**子类型staff,students,parents中的外键增加了两个条件：**

1.  除非相应的子类型行不会被删除，否则无法删除人员行。比如如果students表中有一个student entry引用Person表，不删除student entry就不能删除person entry，这一点很重要。如果创建了 Student 对象，那么在不删除 Student 对象的情况下，我们无法删除基本 Person 对象。

* * *

1.  所有基本类型都有外键“not null”，以确保每个基本类型都始终存在基本类型。例如，如果您创建 Student 对象，则必须先创建 Person 对象。

# css - 如何在可移动类型 4.2 网站的标题中放置 Flash 动画？

> ID：417364
> 
> 赞同：0
> 
> 时间：2009-01-06T17:11:24.553
> 
> 标签：css, movabletype

我正在创建一个新站点 iai 想要在我的页面标题中添加一个 Flash 动画，我使用的是 Movable Type 4.2。

问题是我不知道我该怎么做，我需要编辑哪个文件，或者我是否可以在可移动类型的 dfashboard 中完成所有工作。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-09T15:48:59.843

这当然可以通过 MT 仪表板来完成。您需要修改当前模板以包含您需要的内容。

在 MT 仪表板中，转到*Design* > *Templates*。这将是您需要检查的一般区域，如果您想完全自定义您的博客，那么您需要非常熟悉该区域。

首先查看*横幅标题*模板模块。

# php - HTML 特殊代码转 ASCII

> ID：417370
> 
> 赞同：0
> 
> 时间：2009-01-06T17:12:19.077
> 
> 标签：php, html, replace, special-characters

嘿，php中是否有任何内置函数或类似的东西可以让我将HTML特殊代码如：<(;)、>(;)、Á(;)和©(;)等...转换为< , >, Á 和 ©

可以说我有价值：

```
$fileName = "Gibt es eine schö(;)ne Offroadstrecke? (;)"; 
```

我想要这个：

```
$fileName = "Gibt es eine schöne Offroadstrecke? "; 
```

有什么简单的方法可以用 php 做到这一点？我想到的第一个是创建一个硬编码替换所有 HTML 的函数，在每个字符串中搜索代码并替换，但最终需要大量代码。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T17:24:07.697

我想你想要[html_entity_decode](http://uk3.php.net/manual/en/function.html-entity-decode.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T17:15:50.083

您是否有理由不能简单地使用正则表达式（或其他工具）来搜索和替换 "(;)" ？

# sql - 如何在 TSQL 中创建一个布尔计算字段并加入该计算字段？

> ID：417371
> 
> 赞同：3
> 
> 时间：2009-01-06T17:12:48.157
> 
> 标签：sql, sql-server, tsql

首先查看此代码。我似乎应该对我有用，但事实并非如此！（惊喜！）

无论如何，这是我首先尝试的：

```
SELECT
Status as status,
Address as ip,
PCName as pc_name,
(Numbers.Phone = 'CPU/' + PCName) as cpu_contact,
(Numbers.Phone = 'PC/' + PCName) as pc_contact,
(Numbers.Phone = 'LOGIN/' + PCName) as login_contact,
FROM IPAddress
WHERE $where  --Generated In code
JOIN Numbers
  ON ('CPU/' + PCName = Numbers.Phone) 
  OR ('PC/' + PCName = Numbers.Phone) 
  OR ('LOGIN/' + PCName = Numbers.Phone) 
```

所以我想要的是一些布尔计算字段并在类似条件下加入。我还希望结果折叠成单行。例如，我认为当前的设置会做这样的事情：

```
status ip  cpu_contact pc_contact login_contact
-----------------------------------------------
foo    bar true        false      false
foo    bar false       true       false
foo    bar false       false      true 
```

显然我宁愿

```
status ip  cpu_contact pc_contact login_contact
-----------------------------------------------
foo    bar true        true       true 
```

有任何想法吗？数据库重新设计不是一种选择。如果是的话，我会这样做:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T17:28:29.480

您可以使用`GROUP BY`and`SUM`折叠行：

```
SELECT
  Status as status, Address as ip, PCName as pc_name,
  cast(sum(case when (Numbers.Phone = 'CPU/' + PCName) then 1 else 0 end) as bit)
    as cpu_contact,
  cast(sum(case when (Numbers.Phone = 'PC/' + PCName) then 1 else 0 end)) as bit)
    as pc_contact,
  cast(sum(case when (Numbers.Phone = 'LOGIN/' + PCName) then 1 else 0 end) as bit)
    as login_contact,
FROM
  IPAddress
    JOIN Numbers ON 
      ('CPU/' + PCName = Numbers.Phone) OR ('PC/' + PCName = Numbers.Phone) OR 
      ('LOGIN/' + PCName = Numbers.Phone)
WHERE
  $where  --Generated In code
GROUP BY
  Status, Address, PCName 
```

由于您在行之间进行逻辑或运算，因此零和为假，而任何大于 0 的值都为真。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T17:27:58.327

您需要使用 Case/When 进行比较。在这种情况下，我将硬编码为 1 或 0，但 T-SQL 会将硬编码的数字转换为 int。如果你想要布尔（位），你需要手动转换它，像这样......

```
Convert(Bit, Case When Numbers.Phone = 'CPU/' + PCName Then 1 Else 0 End) as cpu_contact,
Convert(Bit, Case When Numbers.Phone = 'PC/' + PCName Then 1 Else 0 End) as pc_contact,
Convert(Bit, Case When Numbers.Phone = 'LOGIN/' + PCName Then 1 Else 0 End) as login_contact, 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T17:38:46.810

```
SELECT
Status as status,
Address as ip,
PCName as pc_name,
case when sum(case when Numbers.Phone = 'CPU/' + PCName then 1 end) > 0 then 'true' else 'false' end as cpu_contact,
case when sum(case when Numbers.Phone = 'PC/' + PCName then 1 end) > 0 then 'true' else 'false' end as pc_contact,
case when sum(case when Numbers.Phone = 'LOGIN/' + PCName then 1 end) > 0 then 'true' else 'false' end as login_contact
FROM IPAddress
JOIN Numbers
  ON ('CPU/' + PCName = Numbers.Phone) 
  OR ('PC/' + PCName = Numbers.Phone) 
  OR ('LOGIN/' + PCName = Numbers.Phone)
WHERE -- your condition goes here
group by status, address, pc_name 
```

# php - PHP：将函数应用于多个变量而不使用数组

> ID：417373
> 
> 赞同：0
> 
> 时间：2009-01-06T17:13:04.550
> 
> 标签：php, arrays, list, array-map

我有一个函数（为方便起见，我将只使用 count()），我想将其应用于 4-5 个不同的变量。现在，我正在这样做：

```
$a = count($a);
$b = count($b);
$c = count($c);
$d = count($d); 
```

有没有更好的办法？我知道数组可以使用 array_map 函数，但我希望这些值保留为单独的值，而不是数组内部的值。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T17:17:59.707

我知道您说过您不希望值位于数组中，但是仅创建一个专门用于循环值的数组怎么样？IE：

```
$arr = Array($a, $b, $c, $d);

foreach ($arr as &$var)
{
   $var = count($var);
} 
```

不过，我不确定这是否真的比原来的方式更整洁。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T17:20:34.350

如果你有一堆重复的变量来收集数据，那么你的代码设计得很糟糕，应该只使用一个数组来存储值，而不是几十个变量。所以也许你想要这样的东西：

```
$totals = array("Visa"=>0,"Mastercard"=>0,"Discover"=>0,"AmericanExpress"=>0); 
```

然后你只需添加到你的数组元素（比如从你的 SQL 的 while 循环或你正在做的任何事情）

```
$totals['Visa'] += $row['total']; 
```

但是如果你真的想走这条路，你可以使用给你的工具，如果你想用大批量来做这个，那么数组是一个不错的选择。然后 foreach 数组并使用变量变量，如下所示：

```
$variables = array('a','b','c'...);

foreach ( $variables as $var )
{
    ${$var} = count(${var});
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T18:35:08.690

Ben 和 TravisO 所说的，但使用[array_walk](http://us.php.net/array_walk)来获得更简洁的代码：

> ```
> $arr = Array($a, $b, $c, $d);
> array_walk($arr, count); 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T13:02:21.007

您可以使用 extract 再次获取值。

```
//test data
$a = range(1, rand(4,9));
$b = range(1, rand(4,9));
$c = range(1, rand(4,9));

//the code
$arr = array('a' => $a, 'b' => $b, 'c' => $c);
$arr = array_map('count', $arr);
extract($arr);

//whats the count now then?
echo "a is $a, b is $b and c is $c.\n"; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-06T17:20:56.143

你如何衡量“更好”？您可能会想出一些聪明而简短的东西，但是您所拥有的似乎最容易理解，这是工作 1。我会保持原样，但分配给新变量（例如 $sum_a，.. .)。

# django - Django 模板：启用模板自动转义后，我是否需要将 URL 传递给 URLEncode？

> ID：417375
> 
> 赞同：1
> 
> 时间：2009-01-06T17:13:14.083
> 
> 标签：django, templates, django-templates

我正在运行 Django 主干并启用模板自动转义（默认）。我需要将模板 URL 传递给 URLENCODE 过滤器，还是 Autoescape 会自动处理？Django 文档不清楚。

Django 文档对 Autoescape 这么说：

> *当自动转义生效时，所有变量内容都会在将结果放入输出之前应用 HTML 转义（但在应用任何过滤器之后）。这相当于手动将转义过滤器应用于每个变量。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T20:08:58.487

是的，自动转义仅与 HTML 内容有关。URL 编码是另一回事。

# java - 如何确定 java 中语言环境的字母表是什么？

> ID：417377
> 
> 赞同：6
> 
> 时间：2009-01-06T17:13:44.130
> 
> 标签：java, locale, character-encoding

我想确定给定语言环境的*字母表*是什么，最好基于浏览器的 Accept-Language 标头值。任何人都知道如何做到这一点，如有必要使用图书馆？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-08-19T12:22:18.197

看看 [LocaleData.getExemplarSet][1]

例如对于英语，这将返回 abcdefghijklmnopqrstuvwxyz

[1]： http: [//icu-project.org/apiref/icu4j/com/ibm/icu/util/LocaleData.html#getExemplarSet](http://icu-project.org/apiref/icu4j/com/ibm/icu/util/LocaleData.html#getExemplarSet(com.ibm.icu.util.ULocale) (com.ibm.icu.util.ULocale , int)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T21:04:51.823

如果您只想知道用户区域设置的适当字符集的名称，那么您可以尝试[nio.CharSet](http://java.sun.com/j2se/1.4.2/docs/api/java/nio/charset/Charset.html)类。

如果您真的想使用 Accept-Language 标头，那么[O'Reilly 有一篇](http://docstore.mik.ua/orelly/java-ent/servlet/ch12_05.htm)关于此问题的旧文章介绍了一个非常方便的类，称为[LanguageNegotiator](http://www.koders.com/java/fid8D5A46F3B46419997EC0F11703505C4FF6EB4C74.aspx)。

我认为其中一个会给你一个足够体面的开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T01:04:42.367

这取决于您想要获得的具体程度。一个地方可以查看[IANA 语言注册表](http://www.iana.org/assignments/language-subtag-registry)中的“Suppress-Script”属性。

有些语言有多个可用于书写的“字母表”。例如，阿塞拜疆语可以用拉丁文或阿拉伯文书写。大多数语言，比如英语，几乎都是用一个单一的脚本编写的，所以正确的脚本是不言而喻的，应该在语言代码中“压制”。

因此，查看俄语的条目，您可以看出首选脚本是西里尔文，而对于埃塞俄比亚语，它是阿姆哈拉语。但德语、挪威语和英语并不比“拉丁语”更具体。因此，使用这种方法，您将很难向美国人隐藏变音符号和荆棘，或者向克什米尔作家提供任何剧本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T14:09:26.683

这是用奥胡斯写的英文答案。昨天，我听到一些德国人说“Blödheit, à propos, ist dumm”。然而，其中一个人穿着一件衬衫，上面写着“我知道文字和الْعَرَبيّة之间的区别”。

你对这篇文章的问题的答案是什么？是否允许？这不是英文文本吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T14:14:19.060

Unicode的[国际组件](http://icu-project.org/)在这里可能会有所帮助。具体来说，这[`UScript`](http://icu-project.org/apiref/icu4j/com/ibm/icu/lang/UScript.html)门课看起来很有希望。

出于好奇：你需要它做什么？

# asp.net - 水还是硒？

> ID：417380
> 
> 赞同：149
> 
> 时间：2009-01-06T17:14:34.580
> 
> 标签：asp.net, selenium, automation, automated-tests, watin

我将很快开始为我们的演示文稿编写一些自动化测试。看来大家都推荐[WatiN](http://watin.sourceforge.net/index.html)和[Selenium](http://seleniumhq.org/)。对于 ASP.NET Web 表单的自动化测试，您更喜欢哪个？这些产品中哪个更适合您？

作为旁注，我注意到自 2008 年 3 月以来，WatiN 2.0 一直在 CTP 中，这有什么要担心的吗？

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-01-06T20:21:47.197

只想说，我目前正在努力在 2009 年第一季度的某个地方发布 WatiN 2.0 的 beta 版本。这将是对当前 CTP 2.0 版本的重大升级，并且基本上将为您提供与自动化 FireFox 和 IE 相同的功能1.3.0 版提供了 IE 自动化。

所以不用担心。

希望这有助于您做出选择 Jeroen van Menen Lead dev WatiN

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-07-22T22:41:29.383

如果您希望对一个将继续得到社区改进和支持的框架进行严肃的长期投资，那么 Selenium 可能是您最好的选择。例如，我刚刚在 Matt Raible 的博客上看到了这个信息：

> 截至周五，谷歌有超过 50 个团队每天在内部 Selenium Farm 上运行超过 51K 次测试。这些测试中有 96% 由 Selenium RC 和 Farm 机器正确处理。其他 4% 部分是由于 RC 错误，部分是由于测试错误，但找出原因可能很困难。Selenium 已被用作 Google 内部 Web 应用程序功能测试的主要技术。这就是好消息。

我最近还参加了一次 Selenium 聚会，了解到 Google 正在投入大量资源来改进 Selenium 并将其与 WebDriver 集成，WebDriver 是由 Simon Stewart 开发的自动化测试工具。WebDriver 的主要优势之一是它控制浏览器本身，而不是作为 Javascript 应用程序在浏览器内部运行，这意味着像“同源”问题这样的主要绊脚石将不再是问题。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-03-27T18:38:48.437

我们对两者都进行了测试，并决定使用 WaTiN。正如其他人所指出的，Selenium 确实有一些在 WaTiN 中没有的不错的功能，但是我们遇到了让 Selenium 工作的问题，一旦我们这样做了，它在运行测试时肯定比 WaTiN 慢。如果我没记错的话，我们遇到的设置问题源于 Selenium 有一个单独的应用程序来控制 WaTiN 在其中完成所有操作的实际浏览器。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2012-01-02T17:26:20.653

我一直在尝试它们，这是我最初的想法......

* * *

**等待**

好的

*   快速执行。
*   脚本创建工具是独立的项目；我知道有 2 个：[Wax](http://wax.codeplex.com/ "蜡")（基于 Excel，托管在 CodePlex）和[WatiN 测试记录](http://watintestrecord.sourceforge.net/ "等待测试记录")（托管在 SourceForge）。两者都没有 Selenium IDE 强大。
*   很好的 IE 支持。可以附加和分离到/从正在运行的实例。可以访问本机窗口句柄等（参见下面的脚本示例）。
*   NuGet 打包，易于在 .NET、Visual Studio 风格的环境中运行并保持更新。

坏的

*   谷歌搜索 WatiN (watin xyz) 通常会导致谷歌推荐“watir xyz”。那里没有那么多文档。
*   （文档）很少，令人困惑；例如：乍一看，似乎没有对 CSS 选择器的原生支持。特别是因为有像“WatiNCssSelectorExtensions”这样的扩展库和许多关于替代技术的博客文章（例如将 jQuery/sizzle 注入页面）。在 Stack Overflow 上，我发现了[Jeroen van Menen](https://stackoverflow.com/users/52173/jeroen-van-menen "杰伦·范梅宁")的评论，这表明存在原生支持。至少首席开发人员会花时间在 Stack Overflow 上 :)
*   没有本机 XPath 支持。
*   没有开箱即用的远程执行/基于网格的执行。

脚本示例 (C#)。你不能用 Selenium 做到这一点（至少我不知道）：

```
class IEManager
{
    IE _ie = null;
    object _lock = new object();

    IE GetInstance(string UrlFragment)
    {
        lock (_lock)
        {
            if (_ie == null)
            {
                var instances = new IECollection(true);  //Find all existing IE instances
                var match = instances.FirstOrDefault(ie=>ie.Url.Contains(UrlFragment));
                _ie = match ?? new IE();
                if (match==null)  //we created a new instance, so we should clean it up when done!
                    _ie.AutoClose = true;
            }
        }

        return _ie;
    }
} 
```

* * *

**硒**

*   比 WatiN 慢（特别是因为必须创建一个新进程）。
*   内置 CSS 选择器/XPath 支持。
*   Selenium IDE 很好（不能说很好，但它是同类中最好的！）。
*   感觉比 .NET 更像 Java……但实际上，它与编程语言无关；所有命令都发送到进程外“驱动程序”。驱动程序实际上是浏览器实例的“宿主”进程。所有通信都必须跨进程边界进行序列化输入/输出，这可能解释了与 WatiN 相关的速度问题。
*   解耦过程——“驱动”和“控制”意味着更稳健、更复杂等，但也更容易创建网格/分布式测试环境。如果“分发”机制（即驱动程序和控制之间的通信）跨越 WebSphere 或其他现有的、健壮的消息队列管理器，我会非常喜欢它。
*   开箱即用支持 chrome 和其他浏览器。

尽管如此，我最终还是选择了 WatiN。我主要是写小屏幕抓取应用，想用LINQPad做开发。附加到远程 IE 实例（我自己没有生成的实例）是一大优势。我可以在现有实例中摆弄……然后运行一些脚本……然后再次摆弄等等。这对 Selenium 来说更难，尽管我认为“暂停”可以嵌入到脚本中，在此期间我可以直接用浏览器玩。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2009-03-28T09:08:47.083

最大的不同是 Selenium 支持不同的浏览器（不仅仅是 IE 或 FF，参见[http://seleniumhq.org/about/platforms.html#browsers](http://seleniumhq.org/about/platforms.html#browsers)。

此外，Selenium 有一个远程控制服务器（[http://seleniumhq.org/projects/remote-control/](http://seleniumhq.org/projects/remote-control/)），这意味着您不需要在运行测试代码的同一台机器上运行浏览器。因此，您可以测试您的 Web 应用程序。在不同的操作系统平台上。

一般来说，我会推荐使用 Selenium。几年前我用过WatiN，但我对它的稳定性并不满意（现在它可能已经改进了）。Selenium 对我来说最大的优点是您可以测试 Web 应用程序。在不同的浏览器上。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2011-07-19T15:33:59.500

两者都不。使用海狸鼠。它包裹了硒。更耐用。[https://github.com/featurist/coypu](https://github.com/featurist/coypu)

**更新** Ye Oliver 你是对的。好的，为什么更好？就个人而言，我发现 IE 的 Selenium 驱动程序特别脆弱 - 在 ajax 重网站上驱动 Selenium 进行单元测试时，我再次发现了许多“标准”驱动程序异常。

我有没有提到我想用 C# 编写脚本作为测试项目？是 持续构建部署中的验收测试。

那么 Coypu 处理上述问题。它是 Selenium 的包装器，允许测试夹具，例如，

```
browser.Visit("file:///C:/users/adiel/localstuff.htm")
browser.Select("toyota").From("make");
browser.ClickButton("Search"); 
```

...这将启动（可配置品牌的）浏览器并运行脚本。它适用于作用域区域并且非常可扩展。

GitHub 上有更多示例，正如 Olvier 下面提到的，Adrian 的视频非常棒。我认为这是在 .Net 世界中驱动基于浏览器的测试的最佳方式，并尝试遵循它的 Ruby 同名`capybara`

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2009-01-06T17:19:19.780

两个我都用过，感觉都还可以。我对 Selenium 表示赞同，因为它似乎有更好的 Ajax 支持。我相信 WaTiN 已经成熟了，虽然自从我上次使用它以来，它应该有同样的东西。

最重要的是您喜欢在哪个开发环境中工作？Selenium 和 Watin 有记录器，但 Selenium 在浏览器中，watin 在 Visual Studio 中。+ 和 - 对这两者都适用。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-06-01T14:54:36.747

到目前为止，我们是一家纯粹的微软商店，为企业提供解决方案，并与 WatiN 合作。这在未来可能会改变。

作为最近的消息来源：

Microsoft 在[MSDN 杂志 12/2010](http://msdn.microsoft.com/en-us/magazine/gg490346.aspx "MSDN 杂志 12/2010 中的“使用 SpecFlow 和 WatiN 进行行为驱动开发”")中打印了一个 BDD-Primer，它结合了 SpecFlow 和 WatiN（酷 BDD 行为驱动开发）。它的作者 Brandon Satrom (msft Developer Evangelist) 也在 2010 年 12 月发布了一个[视频网络广播](http://www.ditii.com/2010/12/27/video-webcast-using-asp-net-mvc-with-community-tools/ "diTii.com 上的“通过社区工具使用 ASP.NET MVC”")，详细 1:1 地教授他的上述发现。

[Christian Hassa](http://skillsmatter.com/expert/open-source-dot-net/christian-hassa "克里斯蒂安·哈萨")于 2011 年 4 月发布了一份关于使用 SpecLog、SpecFlow 和 Team Foundation Server（验收测试驱动开发/行为驱动开发）支持 ATDD/BDD的[白皮书](http://www.speclog.net/uploads/ATDD_BDD_SpecLog_SpecFlow_TFS_Whitepaper.pdf "白皮书")，他的团队构建了 SpecFlow。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-01-06T17:23:09.397

我使用 Watin，但没有使用 Selenium。我可以说我在 Watin 上快速启动并运行，几乎没有问题。我想不出我想做的任何事情，我无法用它弄清楚。高温高压

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-06T17:20:18.313

我通常使用 Selenium，主要是因为我喜欢用于 FireFox 的 Selenium IDE 插件来记录我的测试的起点。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-06T17:40:37.570

我推荐[WebAii](http://www.artoftest.com/webaiifxproduct.aspx)，因为这就是我所取得的成功，并且在使用它时我的抱怨很少。我从未尝试过 Selenium，而且我不记得使用 WaTiN 的次数不多，至少没有到可以让它成功工作的地步。我不知道有任何框架可以优雅地处理 Windows 对话框，尽管 WebAii 有一个用于实现您自己的对话框处理程序的接口。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2011-01-21T17:51:48.973

我考虑使用两者。我使用 Selenium 的记录器在 FF 中构建了一些测试。我尝试在 Watin 中做同样的事情，发现**Watin Recorder (2.0.9.1228) 对我们的网站完全没有价值**。它似乎在 IE6 中呈现该站点——使我们的站点实际上无法用于记录。我们不支持 IE6。我找不到任何方法来更改它正在使用的浏览器。我只发现了一台 Watin Recorder。如果有不止一个，或者一个保持最新，请发表评论。

用于 Firefox 的 Selenium Recorder IDE 易于使用，并将测试移植到 C#。这不是很好。尽管阅读了一两篇有解决方法的博客文章，但我无法移植测试套件。因此，对生成的代码进行了一些操作。尽管如此，它仍然可以工作 90%，并且比替代方案要好。

就我的金钱/时间而言，**Selenium 的优势在于易于构建新测试**。IE 没有任何与**Firebug**一样好的开发工具栏，所以我开始在 Firefox 中进行开发，所以在 Firefox 中拥有一个好的工作记录器是一个巨大的好处。

我在这里的结论很像丘吉尔的民主名言：*Selenium 是最糟糕的自动化 UI 测试形式。除了所有其他的。*

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2010-01-08T07:19:50.480

冒着切线的风险，我推荐 Axe/WatiN。Ax 允许“手动”测试人员在不了解基础测试“语言”的情况下在 Excel 中编写测试。它确实需要一个“技术人员”来编写定制的操作（IE。今天我不得不做一个稍微复杂的表查找和交叉引用），但是一旦编写了这些操作就可以由非技术测试人员在测试中使用。

我还听说英国政府网关项目（我相信它有 6K+ 测试自动化测试）最近在一周内将所有测试从 Axe/Winrunner 移植到 Axe/Watin！而且许多测试都非常复杂——我知道几年前我在做这件事......

我目前正在研究 Selenium，因为潜在客户正在使用它。但我确实建议将 Axe 视为“工作马”工具之上的一层。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2010-04-13T22:00:01.077

如果您必须访问 iframe、模态对话框和跨域 iframe，WatiN 是一种方法。Selenium 无法处理引发命令超时异常的 iframe。WatiN 你可以做更多的事情，特别是如果网站使用 IE 特定的东西，比如 ShowModalDialog 等。WatiN 可以很好地处理所有这些。我什至可以进行跨域 iframe 访问。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-01-06T17:20:57.810

如果你需要做 IE 和 FF 测试，你将不得不同时做这两个，但它们只会在演示测试中工作得很好。他们无法检测一个元素是否略微偏离，只是存在这些元素。我不知道有什么东西可以代替人眼进行 UI / 演示测试，尽管您可以做一些事情来帮助它（在每个步骤中截取页面的屏幕截图供用户查看）。

# gtk - 通过 GTK 获取 dpi 设置

> ID：417384
> 
> 赞同：3
> 
> 时间：2009-01-06T17:15:45.997
> 
> 标签：gtk, screen, dpi

使用 GTK，如何查询当前屏幕的 dpi 设置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T10:29:03.777

当前接受的答案是针对 PHPGTK，这对我来说有点奇怪。纯 GDK 库有这个调用：[gdk_screen_get_resolution()](http://library.gnome.org/devel/gdk/stable/GdkScreen.html#gdk-screen-get-resolution)，听起来更合适。自己没用过，不知道是否靠谱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T17:39:30.253

请参阅[GdkScreen](http://gtk.php.net/manual/en/gdk.gdkscreen.php)。您应该能够使用`get_height`and`get_height_mm`或 with `get_width`and来计算它`get_width_mm`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-14T05:40:40.603

屏幕返回的分辨率高度和宽度包括完整的多显示器尺寸（例如，用于渲染多显示器设置的显示缓冲区的组合宽度和长度）。我没有检查 mm（毫米宽/高）调用返回的实际物理尺寸，但如果它报告组合的物理尺寸，那么通过将一个与另一个相除计算出的 dpi 将毫无意义，例如在屏幕上绘制一个可以是使用物理尺测量。

# python - “|”是什么意思 Python中的符号是什么意思？

> ID：417396
> 
> 赞同：11
> 
> 时间：2009-01-06T17:18:20.827
> 
> 标签：python, syntax-rules

[这个问题](https://stackoverflow.com/questions/417265/what-does-sign-mean-in-django)最初问（错误地）什么是“|” 在 Python 中的意思是，当实际问题是关于 Django 时。我想保留三联画对这个问题的精彩回答。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-06T17:28:40.947

在 Python 中，`'|'`运算符默认定义在整数类型和集合类型上。

如果两个操作数是整数，那么它将执行[按位或](http://en.wikipedia.org/wiki/Bitwise_operation#OR)，这是一个数学运算。

如果两个操作数是`set`类型，则`'|'`运算符将返回两个集合的并集。

```
a = set([1,2,3])
b = set([2,3,4])
c = a|b  # = set([1,2,3,4]) 
```

此外，作者可以为自定义类型定义运算符行为，因此如果`something.property`是用户定义的对象，您应该检查该方法的类定义，`__or__()`然后该方法将在您的代码示例中定义行为。

因此，如果不知道这两个操作数的数据类型，就不可能给你一个准确的答案，但*通常*它会是按位或。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T17:20:22.150

按位或

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-31T16:33:02.590

它也可以像在 unix shell 中一样被“欺骗”到管道中，请参见此处[http://code.google.com/p/python-pipeline/](http://code.google.com/p/python-pipeline/)

# log4net - 强制 Log4Net RollingFileAppender 滚动

> ID：417403
> 
> 赞同：4
> 
> 时间：2009-01-06T17:20:25.630
> 
> 标签：log4net, rollingfileappender

根据[Log4Net 文档](http://logging.apache.org/log4net/release/sdk/log4net.Appender.RollingFileAppender.html)，RollingFileAppender 只会在记录消息时滚动日志文件。我需要登录到这个文件，但每天都将它导入另一个数据库。我不能使用数据库附加程序，因为我需要这些文件，并且我必须将数据从日志文件转换到数据库（它不是直接副本）。问题是如果午夜之后没有日志活动，则日志不会滚动。导入器查找前几天的文件（我无法更改此代码），因此如果没有活动且日志未滚动，则导入器找不到该文件。无论如何，是否有强制日志在午夜滚动而没有另一个线程唤醒并强制它滚动？自定义附加程序可以做到这一点吗？如果可能的话，我想避免这种情况。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T22:28:59.000

编写一个 Windows 服务，在午夜之后触发一个事件，该事件使用相同的配置写入一个虚拟日志条目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T22:51:09.503

您必须从“哪些代码路径导致翻转例程？”这个问题来考虑这一点。一旦您知道如何达到该例程，您就可以决定如何触发它。

自定义附加程序可以做到吗？当然，但是在您通过它登录之前，appender 中的任何代码都不会运行，因此您又回到了原点。

至于“无论如何强制日志在午夜滚动而没有另一个线程唤醒并强制它滚动？”的问题，我会说这个问题相当于“是否可以强制日志滚动午夜没有运行任何代码？”。我不是想对此感到好笑，或者侮辱你，我只是想以一种希望为你解答的方式重述这个问题。:-)

解决这个问题的最简单方法是唤醒某些东西并记录以强制文件旋转。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T22:34:00.707

根据[RollingFileAppender 文档](http://logging.apache.org/log4net/release/config-examples.html#rollingfileappender)，您可以将其设置为每天滚动，请参阅以下配置：

```
<appender name="RollingLogFileAppender" type="log4net.Appender.RollingFileAppender">
    <file value="logfile" />
    <appendToFile value="true" />
    <rollingStyle value="Date" />
    <datePattern value="yyyyMMdd" />
    <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
    </layout>
</appender> 
```

# textmate - 在 Textmate 中设置快捷键

> ID：417406
> 
> 赞同：9
> 
> 时间：2009-01-06T17:20:41.277
> 
> 标签：textmate

我正在切换到 textmate 并且有一些我想改变的事情。我已经尝试在谷歌上搜索答案，但没有找到关于如何在全球范围内重新绑定快捷方式的简单解释。

首先，选项卡切换不适用于 Cmd+Shift+{ 和 Cmd+Shift+} 这几乎适用于所有其他应用程序（FF、终端等）

如何绑定这些键来切换标签？

二、我要Ctrl+j/k/l/；要移动光标，是否可以将该命令重新绑定到箭头键？

提前致谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-06T17:34:03.340

是的。对于箭头键，您可以录制宏（Bundles > Macros > Start Recording，[按箭头]，Stop Recording，Save Last Recording。它将使用一个命令`moveLeft:`或类似命令创建一个宏。设置一个等效键，您'重做。

对于选项卡切换，请转到系统偏好设置 > 键盘 > 键盘快捷方式并为名为“下一个文件选项卡”和“上一个文件选项卡”的菜单项添加新的快捷方式。重启TextMate，你就完成了。

# eclipse - 使用 Eclipse 和 CVS 管理依赖项

> ID：417416
> 
> 赞同：2
> 
> 时间：2009-01-06T17:23:00.693
> 
> 标签：eclipse, cvs

我有一些用于 Eclipse 中两个或多个项目所需的 dll 的代码。目前，每个项目都有一份代码副本并单独构建 DLL。我想将 dll 代码分离到一个单独的 eclipse 项目中，以便有一个共同的位置。但我想避免我们必须在一个项目中构建 dll，然后将 dll 复制回其他项目并检查每个项目的 dll 的情况。这将为每个项目创建一个 dll，该 dll 无法追溯到构建它的确切代码。

有没有办法以某种方式将 dll 符号链接到另一个使用 CVS 作为版本控制系统的 eclipse 项目，以便可以判断使用哪个版本的代码来创建 dll？我是否让这太复杂或遗漏了一些明显的东西？

我考虑过 eclipse 包管理器中的工作集，但我必须更多地研究如何将它们与 CVS 一起使用，以避免使其成为下一个检查它并且无法弄清楚为什么他们的项目不会的人的噩梦'编译。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T03:12:31.200

在单独的项目中创建一个新文件夹怎么样。在创建新文件夹的高级部分中，有一个选项可以链接到文件系统上的另一个位置。

或者，您也可以创建一个使用 projectset.psf 文件的容器项目。将 projectset 文件链接到存储库中的不同项目。当您要签出该项目时，请改为签出容器并右键单击 projectset 文件并选择 Import Project Set...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T19:32:43.447

如果您使用一个工作区，您最终会得到三个项目，每个项目都在 CVS 中镜像：一个是 dll，其他是使用 dll 的项目（配置为这些项目对 dll 项目的项目依赖项）。

对于三个项目，我不会以工作集为目标——它们适用于在一个工作区中管理大量项目，对于三个项目，我认为它们矫枉过正。我通常倾向于针对多个工作区而不是工作集。

关于处理这些项目的下一个人：您需要保留一些有关如何设置项目的文档。您可能会说您的 Eclipse 项目文件就是这样做的（因为它们定义了对另一个项目的项目依赖关系），但这是针对机器的 - 人类倾向于喜欢其他通信方式。

如果您担心对 dll 的更改与一个项目不兼容（因为应用这些更改的人不关心另一个项目），请瞄准*构建服务器*。每当版本控制下的某些内容发生更改时，这将构建所有项目和依赖项目，运行所有测试，提供内部版本号并将其打包以供使用。通过这种方式，您可以确保 - 无论您的可交付成果中的什么 - 都可以复制，因为构建服务器无法对代码进行本地（未提交）更改。此外，构建服务器将在最后一次提交时（嗯 - 几分钟后）发出故障信号（损坏的 API 或损坏的测试），并将修复损坏的责任放在造成损坏的人身上。

# oracle - 用于 Oracle 和位置参数的 Microsoft 提供程序

> ID：417426
> 
> 赞同：0
> 
> 时间：2009-01-06T17:26:08.050
> 
> 标签：oracle, ado.net

使用 System.Data.OracleClient 调用 Oracle 存储过程时，有没有办法使用位置参数？

IDataParameter 参数 = dbCommand.CreateParameter( );
参数.Value = "Blah Blah";
参数.Type = OracleType.Varchar;
dbCommand.Parameters.Add(参数);

上面的代码创建一个参数并为其分配“Parameter1”名称。当调用存储过程时，Oracle 给出“错误数量或类型的参数”错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T21:52:01.330

通过从 Oracle (Oracle.DataAccess) 切换到提供程序解决了问题

# c# - 为什么要创建自定义例外？

> ID：417428
> 
> 赞同：56
> 
> 时间：2009-01-06T17:26:40.983
> 
> 标签：c#, .net, exception

为什么我们需要在`.NET?`

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-01-06T17:34:05.507

特定的海关例外允许您为您的 catch 语句隔离不同的错误类型。异常处理的常见构造是这样的：

```
try
{}
catch (Exception ex)
{} 
```

无论类型如何，这都会捕获*所有异常。*但是，如果您有自定义异常，则可以为每种类型设置单独的处理程序：

```
try
{}
catch (CustomException1 ex1)
{
    //handle CustomException1 type errors here
}
catch (CustomException2 ex2)
{
    //handle CustomException2 type errors here
}
catch (Exception ex)
{
    //handle all other types of exceptions here
} 
```

因此，特定异常允许您更好地控制异常处理。不仅自定义异常共享此优势，.NET 系统库中的所有其他异常类型也共享此优势。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-01-06T17:33:48.910

我最近写了一篇关于这个主题的长篇博文：

[http://blogs.msdn.com/jaredpar/archive/2008/10/20/custom-exceptions-when-should-you-create-them.aspx](http://blogs.msdn.com/jaredpar/archive/2008/10/20/custom-exceptions-when-should-you-create-them.aspx)

它的症结在于：仅当满足以下条件之一时才创建自​​定义异常

1.  您实际上希望有人来处理它。
2.  您想要记录有关特定错误的信息

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-01-06T17:28:44.300

所以你也可以自己扔掉它们，然后抓住它们并*确切地*知道它们的含义。

另外：如果您正在构建一个类库/框架/api，那么创建一个 BaseException 通常很有用，您的代码中的其他异常可以继承自该异常。然后，当您的代码引发异常时，使用它的程序员可以快速知道异常的来源。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-06T17:29:21.680

因为它可以使您的意图清晰，并且您还可以使用 IDE 功能跟踪使用情况。假设您有一个名为“FooBar”的自定义后端系统，并且您创建了一个“FooBarDownException”，您可以跟踪此异常的用法以识别您的应用程序包含的任何自定义逻辑，因为 FooBar 已关闭。您可以选择捕获这种特定类型的异常并忽略其他异常，从而避免异常处理程序中的重载和条件逻辑。这实际上只是强类型的另一个版本。这也意味着您可以避免在代码中添加注释，因为异常的*意图是暴露名称*。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-06T17:28:35.860

我不确定为什么“技术上”，但可以说我有一个使用权限的应用程序/网站。如果有人没有正确的权限，抛出 DivideByZero Exception 或 IOException 有点愚蠢。相反，我可以创建我的 AccessDeniedException，这将帮助我稍后进行调试。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-06T17:31:00.833

这与为非 .NET 应用程序创建不同退出代码的原因相同：指定不同的应用程序特定错误。比如……`ConnectionBrokenException`或者嗯`UserSmellsBadException`…………或者什么的。

通过这种方式，您可以确切地知道出了什么问题并采取适当的行动。例如，如果您尝试发送一些数据并且数据传输类抛出一个`ConnectionBrokenException`，您可以弹出一个重新连接对话框并尝试重新连接。`ConnectionTimeoutException`然后，如果超时，重新连接方法会抛出一个错误，您可以再次采取适当的行动。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-03-23T04:24:26.193

另一个原因，当客户端与接口交谈时。由于客户端不知道接口的实现，并且它们可能会抛出不同的异常，因此创建自定义异常以统一抛出的错误是一个好地方。

我写过这个特殊情况：

[http://blog.mikecouturier.com/2010/01/creating-custom-exceptions-in-net-right.html](http://blog.mikecouturier.com/2010/01/creating-custom-exceptions-in-net-right.html)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-06T17:32:38.473

正如乔尔所写：所以你也可以自己扔它们，然后抓住它们并确切地知道它们的含义。

此外，您可以添加有关问题的特定信息，以便让您的异常处理程序更准确地执行操作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-06T17:31:29.350

标准的 .NET 异常并没有涵盖在任何应用程序中可能出错的所有坏事，也不打算这样做。除非您的程序非常简单，否则您可能必须至少创建一些自定义异常。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-06T17:36:17.250

一方面，异常是在库中实现的，而不是在语言中实现的——它们如何在库中创建异常？我很确定您并不是在提倡系统库应该有一套不同的规则。

另一方面，实际上可以使用异常对象树。如果你愿意，你继承的异常可以有特殊的属性——它们可以用于比它们更复杂的事情。我不提倡将它们用作通用数据传输机制或任何东西（尽管它们可能是），但我可以看到有人实现了一个自定义日志记录解决方案，该解决方案需要 Exception 上的特殊属性......

您的自定义异常可能包含一个指示特殊处理的标志（也许有人说您应该重新启动 JVM），它们可能包含有关日志记录级别的信息，一堆东西。

无论如何，我不是在提倡这种东西，我只是说这是可能的。第一段是你真正的答案。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-11T15:58:45.597

如果内置的异常适当地描述了问题/异常，您不应该这样做。我不会创建自己的基类来创建自定义`ArgumentException`或.`ArgumentNullException``InvalidOperationException`

您可以创建自己的异常，并在更高级别描述错误。但是，这通常对从消费者类进行调试没有太大帮助。

如果您自己抛出并捕获异常，则可能需要自定义异常。

# c# - 显示器中继器

> ID：417429
> 
> 赞同：3
> 
> 时间：2009-01-06T17:26:48.923
> 
> 标签：c#, asp.net, repeater

我需要显示如下内容。

## A型

1.  A 类项目 1
2.  类型 A 项目 2
3.  类型 A 项目 3

## B型

1.  B 型项目 1
2.  B 类项目 2
3.  B 型项目 3

## C型

1.  C型项目1
2.  C型项目2
3.  C型项目3

所有数据都来自具有“类型”和“项目名称”列的数据集。现在一个简单的解决方案是为每个“类型”创建一个转发器，并按每个“类型”过滤数据集。但是，我只想使用一个中继器，问题是我需要一些方法来识别每个新部分何时有标题。

```
<div>[Header][Item]</div>

[Header] = <b>Type A</b><br />
[Item] = Type A Item 1 
```

因此，只有每个 Type 的第一项获得标题项，所有其他项都设置为空字符串。

有谁知道任何可以帮助的技巧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T17:43:18.203

不是为每种类型创建一个转发器，嵌套转发器怎么样？

[http://www.codeproject.com/KB/aspnet/AspNetNestedRepeaters.aspx](http://www.codeproject.com/KB/aspnet/AspNetNestedRepeaters.aspx)

试试看。您仍然需要一个以上的中继器，但在这种情况下，您只需要两个，并且您不必为每种类型制作一个（正如您所担心的那样），而是一个用于类型，一个嵌套里面的物品。上面的链接应该为您提供进一步调查的良好起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T17:36:37.467

好的，我只是想出了一个解决方案。虽然它很脏。

我创建了一个全局变量来跟踪标题。该变量是一个字符串列表。OnItemDatabind 我检查标题项是否在全局列表中。

如果该项目不存在，我将其添加到列表中并显示标题。否则，标题项为空。

到目前为止，这有效，但我不知道我对此有何感受。

编辑：我想知道另一个控件是否可以更好地工作......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T17:48:14.637

假设它们按类型排序，您不需要保留整个列表：只需保留当前项目。

查找有关控制/中断报告的更多信息。

# c# - 为什么正则表达式替换方法不起作用？

> ID：417430
> 
> 赞同：1
> 
> 时间：2009-01-06T17:27:09.063
> 
> 标签：c#, regex

在下面的代码中，我想替换字符串中每次出现的`"U.S.A"`with`"united states of America"`和每次出现的`"uk"`with `"united kingdom"`，但它似乎不起作用。我如何解决它？

```
class Program
    {
        static void Main(string[] args)
        {
            string s = "the U.S.A love UK";
            Console.WriteLine(replace(s));
        }

        public static string replace(string s)
        {
            s = Regex.Replace(s, @"^U.S.A", " United state Of America");
            s = Regex.Replace(s, @"^Uk", "United kingdom");
            return s;
        }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T17:30:19.947

好吧，看看你的正则表达式中的搜索模式。

`^`有特定的含义。（就像`.`在这种情况下他们实际上不会失败，但他们没有做你认为的那样）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T17:32:27.523

1.  `.`表达式中的将`U.S.A`匹配*任何*单个字符。我怀疑这就是你的意图。
2.  将`^`您的表达式固定到字符串的开头。你不想要它。
3.  默认情况下，正则表达式区分大小写。如果要`Uk`匹配`UK`，则需要指定不区分大小写的比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T17:34:09.267

为了扩展 anakata 的答案：

在正则表达式中，'^' 字符的意思是“匹配字符串的开头”，所以如果你想替换“USA”，它必须是字符串中的前六个字符，对于 UK 也是如此。从您的 RE 中删除“^”，它应该可以工作。

关于“。”的评论。字符，在正则表达式中，这意味着匹配*任何*字符。如果您希望匹配文字 '.' 你必须像这样“。”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T17:40:20.283

对于简单的替换，您不需要正则表达式：

```
string s = "the U.S.A love UK";
s = s.Replace("U.S.A", "United States of America").Replace("UK", "United Kingdom"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T17:44:09.293

上面已经有足够的正确答案了。所以我要补充一点，更好地理解正则表达式的一个很好的资源是[掌握正则表达式](http://oreilly.com/catalog/9781565922570/)

# asp.net - 使用 ado.net 更新 gridview，然后更改编辑模式

> ID：417432
> 
> 赞同：1
> 
> 时间：2009-01-06T17:28:00.170
> 
> 标签：asp.net, gridview

我只是使用 commandName = "Edit" 将 gridview 置于编辑模式。然后我使用一个特殊的命令（“CallUpdate”），这样我就可以在一个特殊的函数中更新。所有这一切都很好，除了在我调用更新并且页面刷新之后它仍然处于编辑模式。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T01:19:31.450

你有没有尝试设置

```
yourGridView.EditIndex = -1; 
```

然后重新绑定它？

# xml - 如何使用 VBS 在 XML 文件中搜索不同的字符串并将其替换为另一个字符串

> ID：417435
> 
> 赞同：0
> 
> 时间：2009-01-06T17:28:29.077
> 
> 标签：xml, vbscript, replace, find

我有一个包含加密密码的配置 XML 文件。有时我们需要重置此密码，这样做的方法包括从 XML 文件中删除实际上是密码的字符串并保存文件。

该过程还涉及停止和重新启动我可以管理的几个服务，但我还没有找到一种搜索和替换字符串的方法，因为它每次都可能不同。

我想在 VBS 中执行此操作（因为这几乎是我在脚本世界中所熟悉的所有内容），但很高兴考虑以其他方式执行此操作。

我已经查看了替换功能，但我还没有找到将通配符放入搜索条件的方法。我需要能够搜索：

```
<A>randomstuff</A> 
```

并替换为：

```
<A></A> 
```

对于可能熟悉这种情况的人，我正在重置 Websense Enterprise Manager 的密码。

XML 文件似乎是 v1.0：

```
<?xml version="1.0" encoding="UTF-8"?> 
```

谢谢。汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T17:54:03.970

永远不要使用正则表达式来解析 XML。他们远不适合这项任务。您应该寻找的解决方案是如何使用 VBScript 解析 XML，这非常简单。

这是一个示例脚本，它将解析 XML 文件并替换特定密码元素中的文本。

```
Set xml = CreateObject("Msxml2.DOMDocument.6.0")
xml.Load "C:\doc.xml"
Set password = xml.SelectSingleNode("//root/element/password")
password.Text = "Hello, world"
xml.Save "C:\doc.xml" 
```

这是脚本将处理的示例 XML 文件。

```
<root>
    <element>
        <password>Example password</password>
    </element>
</root> 
```

脚本的重要部分是“SelectSingleNode”方法。这使用 XPath 语法在 XML 文档中搜索我们想要的元素。XPath 语法非常简单，可以在网上找到任何数量的参考资料。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T17:36:32.147

也许是一个[正则表达式](http://msdn.microsoft.com/en-us/library/ms974570.aspx)？

我通常不会推荐它们来解析 xml/html 文件，但如果你的 xml 非常具体，你可能会没事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-23T05:39:32.790

或者，如果您在 Windows 机器上，使用单行 powershell 命令可能会更快更容易

```
(Get-Content doc.xml) -replace '<a>.*</a>','<a></a>' | Set-Content doc.xml 
```

然后您可以一路学习 Powershell 以添加到您的简历中！

# linq-to-sql - 跨多个数据库构建数据层的最佳方法是什么？

> ID：417443
> 
> 赞同：3
> 
> 时间：2009-01-06T17:29:27.047
> 
> 标签：linq-to-sql, entity-framework, data-layers

先说一下环境：

我们使用名为 Clearview 的程序来管理与客户的服务关系，包括呼叫中心和现场服务工作。为了更好地支持客户和我们的现场技术人员，我们还开发了一个网站，以提供对 Clearview 服务记录和报告的访问。随着时间的推移，我们需要自定义行为并添加新功能导致越来越多的东西与这个网站及其数据库相关联。

在这一点上，我们正在处理诸如部分在 Clearview 数据库中和部分在网站数据库中定义的公司之类的事情。为了更好地衡量，我们还开始将电话系统的脚本绑定到同一个网站，这也需要与电话系统自己的数据库进行对话。

所有这些都已设置好并正在运行……但我们没有一个*好的*数据层来处理这一切。我们迁移到 Linq to SQL，现在有两个我们可以使用的 DBML，还有一些我在听说过 Linq 之前编写的自定义类，以及一些旧式 ADO 数据集。所以，是的，基本上事情是一团糟。

我想要的是一个数据层，它为我们的应用程序提供单个前端，并在后端将所有内容管理到正确的数据库中。

我听说过实体框架允许从多个源构建类，但事实证明只能有一个数据库。所以问题是，我该如何进行呢？

我目前正在考虑为每个数据库设置 Linq To SQL 类，然后手动编写将这些连接在一起的 Linq 兼容前端。似乎需要做很多工作，并且鉴于 Linq 的限制（例如无法刷新），我不确定这是一个好主意。

我可以用 Entity Framework 做一些效果更好的事情吗？我应该研究其他工具吗？我疯了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T17:43:49.060

实体框架确实提供了一定程度的数据库独立性，因为您可以从一个数据库构建实体模型，然后使用不同的实体连接字符串将其连接到不同的数据库。但是，正如您所说，它仍然只是一个数据库，而且，它仅限于支持实体框架的数据库。许多人这样做，但不是全部。您可以在单个应用程序中使用多个实体模型，以便使用实体框架组合多个数据库。ADO.NET 团队博客上有一些关于此的信息。但是，实体框架对此的支持充其量只是处于早期阶段。

我解决这个问题的方法是抽象我对存储库模式背后的实体框架的使用。对我来说，这样做最直接的好处是使单元测试变得非常简单；我没有尝试模拟我的实体模型，而是简单地替换了一个返回 IQueryables 的模拟存储库。但同样的模式对于组合多个数据源或没有实体框架提供程序的数据源（例如非数据服务感知的 Web 服务）也非常有用。

所以我不会说“不要使用实体框架”。我喜欢它，我自己使用它。鉴于微软最近的消息，我相信它是比 LINQ to SQL 更好的选择。但它本身并不能解决你描述的问题。使用存储库模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T17:50:27.953

如果您想使用 Linq2SQl 或 EF 之类的工具，并且不想管理多个 DBMLS（或在 EF 或其他工具中调用它），您可以在您的网站数据库中创建视图，将其引用回 ClearView 或电话系统的数据库。

这允许您将您的网站与其数据库结构分离。我相信 Linq2Sql 和 EF 可以使用视图作为实体的源。如果他们不能看 nHibernate。

这也将让您拥有从各种数据源中提取的复合实体。在 SQL Server 中更新视图存在一些限制；但是，您可以在视图上定义自己的而不是触发器，然后可以执行实际的插入更新删除语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-28T16:21:45.563

L2S 在我的项目中完美地与视图一起工作。您只需要做一个小技巧： 1\. 在当前数据库中添加一个辅助数据库表作为视图。2\. 在 Designer 中，将主键属性添加到视图上的 id 字段。3\. 只是现在，在原始数据库中添加到您想要的任何其他表的关联。

现在，您可能会看到可用于导航的视图。

# c++ - 管理缓冲区中的 C++ 对象，考虑对齐和内存布局假设

> ID：417446
> 
> 赞同：1
> 
> 时间：2009-01-06T17:29:54.190
> 
> 标签：c++, runtime, compiler-construction

我将对象存储在缓冲区中。现在我知道我不能对对象的内存布局做出假设。

如果我知道对象的总体大小，是否可以创建指向该内存的指针并在其上调用函数？

例如说我有以下课程：

```
[int,int,int,int,char,padding*3bytes,unsigned short int*] 
```

1）如果我知道这个类的大小为 24 并且我知道它在内存中的起始地址，而假设内存布局是不安全的，可以将它转换为指针并调用该对象上的函数来访问这些成员？（c++ 是否通过某种魔法知道成员的正确位置？）

2）如果这不安全/没问题，除了使用构造函数来获取所有参数并一次将每个参数从缓冲区中拉出一个之外，还有其他方法吗？

编辑：更改标题以使其更适合我的要求。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T17:48:41.827

您可以创建一个构造函数来获取所有成员并分配它们，然后使用placement new。

```
class Foo
{
    int a;int b;int c;int d;char e;unsigned short int*f;
public:
    Foo(int A,int B,int C,int D,char E,unsigned short int*F) : a(A), b(B), c(C), d(D), e(E), f(F) {}
};

...
char *buf  = new char[sizeof(Foo)];   //pre-allocated buffer
Foo *f = new (buf) Foo(a,b,c,d,e,f); 
```

这样做的好处是即使 v-table 也能正确生成。但是请注意，如果您使用它进行序列化，则 unsigned short int 指针在反序列化时不会指向任何有用的东西，除非您非常小心地使用某种方法将指针转换为偏移量然后再返回.

指针上的各个方法`this`是静态链接的，并且只是对函数的直接调用，并且`this`是显式参数之前的第一个参数。

成员变量是使用`this`指针的偏移量来引用的。如果一个对象是这样布局的：

```
0: vtable
4: a
8: b
12: c
etc... 
```

`a`将通过取消引用来访问`this + 4 bytes`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T17:36:33.380

非虚函数调用像 C 函数一样直接链接。对象 (this) 指针作为第一个参数传递。调用该函数不需要了解对象布局。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T17:47:34.483

基本上，您建议做的是读取一堆（希望不是随机的）字节，将它们转换为已知对象，然后在该对象上调用类方法。它实际上可能会起作用，因为这些字节最终会出现在该类方法中的“this”指针中。但是你正在真正的机会去处理那些不是编译代码所期望的地方。与 Java 或 C# 不同的是，没有真正的“运行时”来捕获这类问题，所以充其量您会得到核心转储，更糟糕的是，您会得到损坏的内存。

听起来您想要 Java 的序列化/反序列化的 C++ 版本。可能有一个图书馆可以做到这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T18:03:25.667

听起来您不是将对象本身存储在缓冲区中，而是将它们组成的数据存储在缓冲区中。

如果此数据按字段在您的类中定义的顺序存储在内存中（为平台使用适当的填充）**并且**您的类型是[POD](http://www.fnal.gov/docs/working-groups/fpcltf/Pkg/ISOcxx/doc/POD.html)，那么您可以`memcpy` 将缓冲区中的数据指向您的类型的指针（或者可能将其转换为，但要注意，有一些特定于平台的陷阱，它们会强制转换为不同类型的指针）。

如果您的类不是 POD，则不能保证字段的内存布局，并且您不应依赖任何观察到的顺序，因为它允许在每次重新编译时更改。

但是，您可以使用 POD 中的数据初始化非 POD。

至于非虚拟函数所在的地址：它们在编译时静态链接到代码段中的某个位置，该位置对于您的类型的每个实例都是相同的。请注意，不涉及“运行时”。当你写这样的代码时：

```
class Foo{
   int a;
   int b;

public:
   void DoSomething(int x);
};

void Foo::DoSomething(int x){a = x * 2; b = x + a;}

int main(){
    Foo f;
    f.DoSomething(42);
    return 0;
} 
```

编译器生成执行以下操作的代码：

1.  功能`main`：
    1.  `f`在堆栈上为对象“ ”分配 8 个字节
    2.  调用类“ `Foo`”的默认初始化程序（在这种情况下什么都不做）
    3.  将参数值压入`42`堆栈
    4.  将指向对象“ `f`”的指针压入堆栈
    5.  调用函数`Foo_i_DoSomething@4`（实际名称通常更复杂）
    6.  将返回值加载`0`到累加器寄存器中
    7.  返回给调用者
2.  函数`Foo_i_DoSomething@4`（位于代码段的其他位置）
    1.  `x`从堆栈中加载“ ”值（由调用者推送）
    2.  乘以 2
    3.  `this`从堆栈加载“ ”指针（由调用者推送）
    4.  计算对象`a`内字段“”的偏移量`Foo`
    5.  将计算的偏移量添加到`this`指针，在步骤 3 中加载
    6.  将步骤 2 中计算的产品存储到步骤 5 中计算的偏移量
    7.  `x`再次从堆栈中加载“ ”值
    8.  再次从堆栈中加载“ `this`”指针
    9.  再次计算对象`a`内字段“”的偏移量`Foo`
    10.  将计算的偏移量添加到`this`指针，在步骤 8 中加载
    11.  加载“ `a`”存储在偏移量处的值，
    12.  将`a`第 12 步加载的“”值添加到`x`第 7 步中加载的“”值
    13.  再次从堆栈中加载“ `this`”指针
    14.  计算对象`b`内字段“”的偏移量`Foo`
    15.  将计算出的偏移量添加到`this`指针，在步骤 14 中加载
    16.  将步骤 13 中计算的总和存储到步骤 16 中计算的偏移量
    17.  返回给调用者

换句话说，它或多或少与您编写的代码相同（细节，例如 DoSomething 函数的名称和传递`this`指针的方法取决于编译器）：

```
class Foo{
    int a;
    int b;

    friend void Foo_DoSomething(Foo *f, int x);
};

void Foo_DoSomething(Foo *f, int x){
    f->a = x * 2;
    f->b = x + f->a;
}

int main(){
    Foo f;
    Foo_DoSomething(&f, 42);
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-06T18:51:00.533

1.  在这种情况下，已经创建了具有 POD 类型的对象（无论您是否调用 new。分配所需的存储就足够了），您可以访问它的成员，包括调用该对象的函数。但这只有在您准确知道 T 所需的对齐方式、T 的大小（缓冲区可能不小于它）以及 T 的所有成员的对齐方式时才有效。即使对于 pod 类型，编译器也是如果需要，允许在成员之间放置填充字节。对于非 POD 类型，如果您的类型没有虚函数或基类，没有用户定义的构造函数（当然）并且这也适用于基类及其所有非静态成员，那么您可以拥有同样的运气。

2.  对于所有其他类型，所有赌注均已取消。您必须首先使用 POD 读取值，然后使用该数据初始化非 POD 类型。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-06T19:13:11.890

> 我将对象存储在缓冲区中。...如果我知道对象的整体大小，是否可以创建指向该内存的指针并在其上调用函数？

在可以接受使用强制转换的范围内，这是可以接受的：

```
#include <iostream>

namespace {
    class A {
        int i;
        int j;
    public:
        int value()
        {
            return i + j;
        }
    };
}

int main()
{
    char buffer[] = { 1, 2 };
    std::cout << reinterpret_cast<A*>(buffer)->value() << '\n';
} 
```

将对象转换为原始内存然后再转换回来实际上很常见，尤其是在 C 世界中。但是，如果您使用的是类层次结构，则使用指向成员函数的指针会更有意义。

> 说我有以下课程：...
> 
> 如果我知道这个类的大小为 24 并且我知道它在内存中的起始地址......

这就是事情变得困难的地方。对象的大小包括其数据成员（以及来自任何基类的任何数据成员）的大小加上任何填充加上任何函数指针或实现相关信息，减去从某些大小优化（空基类优化）中保存的任何内容。如果结果数为 0 字节，则对象需要在内存中占用至少一个字节。这些东西是语言问题和大多数 CPU 对内存访问的共同要求的组合。 [试图让事情正常工作可能是一个真正的痛苦](http://www.ddj.com/cpp/184402027)。

如果您只是分配一个对象并在原始内存中进行转换，您可以忽略这些问题。但是，如果您将对象的内部结构复制到某种缓冲区，那么它们很快就会抬起头来。上面的代码依赖于一些关于对齐的一般规则（即，我碰巧知道 A 类将具有与 int 相同的对齐限制，因此可以安全地将数组转换为 A；但我不一定能保证如果我将数组的一部分转换为 A 并将部分转换为具有其他数据成员的其他类，则相同）。

哦，在复制对象时，您需要确保正确处理指针。

您可能还对[Google 的 Protocol Buffers](http://code.google.com/p/protobuf/)或[Facebook 的 Thrift](http://incubator.apache.org/thrift/)感兴趣。

* * *

是的，这些问题很困难。而且，是的，一些编程语言将它们扫到了地毯下。 [但是有很多东西被扫到地毯下](http://teddziuba.com/2008/02/the-road-to-hell-is-64-bits-wi.html)：

> 在 Sun 的 HotSpot JVM 中，对象存储与最近的 64 位边界对齐。最重要的是，每个对象在内存中都有一个 2 字头。JVM 的字长通常是平台的本机指针大小。（一个只包含一个 32 位 int 和一个 64 位双精度的对象——96 位数据——将需要）两个字用于对象头，一个字用于 int，两个字用于双精度。那是 5 个字：160 位。由于对齐，这个对象将占用 192 位内存。

这是因为 Sun 依赖于一种相对简单的策略来解决内存对齐问题（在一个虚构的处理器上，可以允许 char 存在于任何内存位置，一个 int 可以存在于任何可被 4 整除的位置，并且可能需要一个 double仅在可被 32 整除的内存位置上分配——但最严格的对齐要求也满足所有其他对齐要求，因此 Sun 正在根据最严格的位置对齐所有内容）。

[内存对齐的另一种策略可以回收一些空间](http://www.monkeyspeak.com/alignment/)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T17:43:26.173

1.  如果该类不包含虚函数（因此类实例没有 vptr），并且如果您对类的成员数据在内存中的布局方式做出**正确**的假设，那么执行您的建议可能会起作用（但是可能不便携）。
2.  是的，另一种方式（更惯用但不是更安全......您仍然需要知道该类如何布置其数据）将使用所谓的“放置运算符 new”和默认构造函数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T17:51:38.047

这取决于您所说的“安全”是什么意思。每当您以这种方式将内存地址转换为点时，您都​​在绕过编译器提供的类型安全功能，并自行承担责任。如果像 Chris 暗示的那样，您对内存布局或编译器实现细节做出了错误的假设，那么您将得到意想不到的结果和松散的可移植性。

由于您担心这种编程风格的“安全性”，因此可能值得您花时间研究可移植和类型安全的方法，例如预先存在的库，或者为此目的编写构造函数或赋值运算符。

# web-services - 股票/财务数据的最佳/最全面的 API

> ID：417453
> 
> 赞同：95
> 
> 时间：2009-01-06T17:32:42.967
> 
> 标签：web-services, api, rest, soap, finance

访问金融市场统计数据和股票报价（最好是实时报价）最推荐的免费/公共 API 是什么？只要它有一些像样的文档，我对它的公开方式（SOAP、REST、一些专有的 XML 设置等）并不太挑剔。

我打算用 PHP 构建一个简单的 Web 仪表板，其中包含一些基本数据（基本上是一个快速、肮脏的主页），但最终可能希望将其发展为一个完整的 Web 应用程序。有什么想法吗？

当我找到一些时，我将在此处发布一个列表（如果您以前使用过它们中的任何一个，请随时发表评论）：

**自由**

*   [opentick](http://www.opentick.com/) ( [soprano](https://stackoverflow.com/users/49485/soprano) ) // 链接失效

**不免费**

*   [XigniteRealTime](http://www.xignite.com/product/global-real-time-stock-quote-data/)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-06T17:40:04.683

Yahoo 的 api 提供了一个 CSV 转储：

示例： http: [//finance.yahoo.com/d/quotes.csv?s=msft &f=price](http://finance.yahoo.com/d/quotes.csv?s=msft&f=price)

我不确定它是否记录在案，但此代码示例应该展示所有功能（即统计类型 [查询字符串中的参数 f]。我相信您可以找到文档（官方或非官方）如果你搜索它。

[http://www.goldb.org/ystockquote.html](http://www.goldb.org/ystockquote.html)

**编辑**

我找到了一些非官方的文档：

[http://ilmusaham.wordpress.com/tag/stock-yahoo-data/](http://ilmusaham.wordpress.com/tag/stock-yahoo-data/)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2010-06-08T05:19:04.667

我通常发现[ProgrammableWeb](http://www.programmableweb.com/category/financial/api)是寻找 API 的好去处。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-02-24T12:39:11.310

Markit On Demand 提供了一组免费的金融 API 供您使用。看起来有一个股票报价 API、一个股票代码/公司搜索和一个图表 API 可用。看看[http://dev.markitondemand.com](http://dev.markitondemand.com)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-06T22:45:28.937

最后我看 - 几年前 - 没有一个简单的选择，“解决方案”（我不同意）是屏幕抓取一些网站。现在可能更容易了，但我仍然会惊讶地看到一些有用的东西。

这里的问题是数据非常有价值（而且非常昂贵），因此虽然定义检索数据的方法很容易，但让交易场所与他们的数据分开几乎是不可能的。一些 MTF（目前）免费提供他们的数据，但我不确定如果不向路透社等其他人支付费用，您将如何获得这些数据。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-06-08T04:58:23.497

我发现这个[问题](https://stackoverflow.com/questions/1763310/yahoo-finance-api)下的链接和提示很有帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-09-26T15:51:03.423

TDAmeritrade 等一些经纪公司拥有 API，可用于从其服务器获取流数据：

[http://www.tdameritrade.com/tradingtools/partnertools/api_dev.html](http://www.tdameritrade.com/tradingtools/partnertools/api_dev.html)

# installation - 安装 Shield 2009 - 创建快捷方式

> ID：417460
> 
> 赞同：1
> 
> 时间：2009-01-06T17:34:58.610
> 
> 标签：installation, installshield, shortcuts

是否可以根据用户输入在 Install Shield 2009 中创建快捷方式？在 essnes 中，仅当用户（运行安装）想要创建快捷方式时（在桌面上）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T00:16:01.763

我们有一个屏幕提示用户创建桌面和快速启动快捷方式。

然后，每个快捷方式都位于单独的组件中，并设置为仅在选中该复选框时才安装。

您还应该将此响应存储在注册表中的某个位置，并在重新配置、升级、修复等期间将其读回。否则，如果复选框默认打开并且该屏幕未显示给用户，则条件将评估为 true (因为默认属性为 true），尽管最初没有安装快捷方式，但如果重新评估组件条件，它将在修复期间创建。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-09T00:00:11.867

我做的事情类似于 Sacha，但我比较懒惰。;-)

我为每个桌面快捷方式创建一个组件（我讨厌*假设*允许在我的桌面上转储快捷方式的软件）；组件中没有文件。然后我将这些组件中的每一个分配给它自己的功能。然后，我可以使用标准功能选择对话框（自动内置并在用户选择自定义安装时使用）让用户选择桌面快捷方式功能。

我没有看到很多软件安装程序提供在功能选择对话框中安装可选快捷方式，但它*让我觉得*这样做很自然。更多技术用户可能会将其视为混合隐喻。

FWIW，我最初是在一个 InstallScript/MSI 项目中这样做的，而我刚刚在一个直接的 MSI 项目中做了完全相同的事情，并且该技术在两者中都可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T18:26:44.653

我使用 installshield 已经有一段时间了，我的公司目前正在使用 WISE 作为安装程序；但是，应该可以按照您的要求进行操作。

在一般安装程序术语中，您需要执行以下操作：

1.  为您的安装程序制作一个屏幕，显示创建快捷方式的选项，该屏幕应该有提示文本和一个复选框。
2.  应该有一种机制将复选框的响应存储在 Installshield 属性中。
3.  在执行阶段，使用响应触发快捷方式的创建。

我不知道 Installshield 2009 的功能是否可以在不编辑脚本本身的情况下完成。

我希望这有帮助。

# text-files - 动态保存文件位置

> ID：417472
> 
> 赞同：2
> 
> 时间：2009-01-06T17:40:15.933
> 
> 标签：text-files

我有一个 asp.net 应用程序，我正在尝试将文本文件保存到随每个客户端更改的文件夹中。如何编写它以将文件保存到更改的文件夹中。例如，一个客户可能是 C:\inetpub\wwwroot\site1\ 另一个可能是 C:\inetpub\wwwroot\site2。相对路径似乎不起作用，我试过 GetCurrentDirectory 但它一直给我错误的目录。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T17:56:43.310

你应该试试 ：

在 *.aspx.cs 文件中：

```
string currentPath = Server.MapPath("~"); 
```

我没有工具可以在这里测试，但我认为代码是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T17:43:34.100

看看`Path.GetDirectoryName(Request.ServerVariables("SCRIPT_NAME"))`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T17:43:38.500

您应该向 web.config 文件添加一个值，该文件设置为保存文件的路径。

然后，在您的代码中，从文档中检索此值，并在保存时使用该路径。

# java - 对 Swing 的撤消管理器隐藏某些操作

> ID：417480
> 
> 赞同：5
> 
> 时间：2009-01-06T17:42:10.327
> 
> 标签：java, swing, undo

我正在尝试编写一个支持某种着色的 JTextPane：当用户键入文本时，我正在运行一些代码，根据某种算法为文本着色。这很好用。

问题是着色操作是在撤消管理器中注册的（带有 EventType.CHANGE 的 DefaultDocumentEvent）。因此，当用户单击撤消时，着色消失。只有在第二个撤消请求时，文本本身才会回滚。

（请注意，着色算法有点慢，因此我无法在插入文本时为其着色）。

如果我试图阻止 CHANGE 事件到达撤消管理器，我会在多次撤消请求后得到一个异常：这是因为文档内容不符合 undoable-edit 对象所期望的内容。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T20:09:15.053

您如何尝试阻止 CHANGE 事件到达撤消管理器？

您不能在 CHANGE 排队后立即向 UndoManager 发送 lastEdit().die() 调用吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T02:38:41.103

我只能假设您是如何进行文本着色的。如果您在 StyledDocuments 更改字符属性方法中执行此操作，您可以获得撤消侦听器并暂时从该操作的文档中注销它，然后一旦颜色更改完成，您就可以重新注册侦听器。

对于您在那里尝试做的事情应该没问题。

希望有帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T15:15:41.417

您可以拦截 CHANGE 编辑并将每个编辑包装在另一个 UndoableEdit 中，该`isSignificant()`方法返回`false`，然后将其添加到 UndoManager。然后每个撤消命令将撤消最近的 INSERT 或 REMOVE 编辑，以及此后发生的每个 CHANGE 编辑。

最终，我想你会发现 JTextPane/StyledDocument/etc 提供的样式机制。对于这种事情来说太有限了。它很慢，占用了太多内存，而且它基于用于跟踪文档词法结构的相同元素树。对于用户应用样式的应用程序（例如文字处理器）来说，这没问题（我猜），但对于必须在用户键入时不断更新样式的语法高亮器来说却不是。

有几个基于 Swing 和类的自定义实现的语法高亮编辑`JTextComponent`器`View`示例`Document`。有些，比如 JEdit，实际上重新实现了整个`javax.swing.text`包，但我认为你不需要走那么远。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-14T06:45:53.607

我刚刚经历过这个问题。这是我的解决方案：

```
private class UndoManagerFix extends UndoManager {

    private static final long serialVersionUID = 5335352180435980549L;

    @Override
    public synchronized void undo() throws CannotUndoException {
        do {
            UndoableEdit edit = editToBeUndone();
            if (edit instanceof AbstractDocument.DefaultDocumentEvent) {
                AbstractDocument.DefaultDocumentEvent event = (AbstractDocument.DefaultDocumentEvent) edit;
                if (event.getType() == EventType.CHANGE) {
                    super.undo();
                    continue;
                }
            }
            break;
        } while (true);

        super.undo();
    }

    @Override
    public synchronized void redo() throws CannotRedoException {
        super.redo();
        int caretPosition = getCaretPosition();

        do {
            UndoableEdit edit = editToBeRedone();
            if (edit instanceof AbstractDocument.DefaultDocumentEvent) {
                AbstractDocument.DefaultDocumentEvent event = (AbstractDocument.DefaultDocumentEvent) edit;
                if (event.getType() == EventType.CHANGE) {
                    super.redo();
                    continue;
                }
            }
            break;
        } while (true);

        setCaretPosition(caretPosition);
    }

} 
```

它是我的自定义 JTextPane 中的一个内部类，因此我可以在重做时修复插入符号的位置。

# c++ - 指针、智能指针还是共享指针？

> ID：417481
> 
> 赞同：126
> 
> 时间：2009-01-06T17:42:24.587
> 
> 标签：c++, pointers

我正在使用普通指针进行编程，但我听说过像 Boost 这样实现智能指针的库。我还看到在 Ogre3D 渲染引擎中有一个共享指针的深度使用。

这三者之间到底有什么区别，我应该坚持只使用其中的一种吗？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2009-01-06T18:29:14.757

Sydius 很好地概述了这些类型：

*   **普通指针**就是这样 - 它们指向内存中某处的某些东西。谁拥有它？只有评论会让你知道。谁释放它？希望楼主在某个时候。
*   **智能指针**是一个涵盖多种类型的总称；我假设您的意思是使用[RAII](http://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)模式的范围指针。它是一个包装指针的堆栈分配对象；当它超出范围时，它会在它包装的指针上调用 delete 。它“拥有”包含的指针，因为它负责在某个时候删除它。它们允许您获取对它们包装的指针的原始引用以传递给其他方法，以及*释放*指针，允许其他人拥有它。复制它们没有意义。
*   **共享指针**是一个堆栈分配的对象，它包装了一个指针，这样您就不必知道谁拥有它。当内存中对象的最后一个共享指针被破坏时，包装的指针也将被删除。

什么时候应该使用它们呢？您将大量使用范围指针或共享指针。您的应用程序中正在运行多少个线程？如果答案是“可能很多”，那么如果在任何地方使用共享指针，可能会成为性能瓶颈。原因是创建/复制/销毁共享指针需要是原子操作，如果您有许多线程正在运行，这可能会影响性能。然而，情况并非总是如此——只有测试才能确定地告诉你。

有一个反对共享指针的论点（我喜欢） - 通过使用它们，您允许程序员忽略谁拥有指针。这可能导致循环引用的棘手情况（Java 会检测到这些，但共享指针不能）或大型代码库中的一般程序员懒惰。

使用作用域指针有两个原因。第一个是简单的异常安全和清理操作——如果你想保证一个对象在面对异常时被清理，并且你不想堆栈分配那个对象，把它放在一个作用域指针中。如果操作成功，您可以随意将其转移到共享指针，但同时使用作用域指针节省开销。

另一种情况是您想要明确的对象所有权。有些团队喜欢这个，有些则不喜欢。例如，数据结构可以返回指向内部对象的指针。在作用域指针下，它将返回一个应被视为弱引用的原始指针或引用——在拥有它的数据结构被破坏后访问该指针是错误的，删除它是错误的。在共享指针下，如果有人仍然持有它的句柄，则拥有对象不能破坏它返回的内部数据 - 这可能会使资源打开的时间比必要的时间长得多，或者根据代码更糟。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-01-06T18:21:32.010

术语“智能指针”*包括*共享指针、自动指针、锁定指针等。您的意思是说自动指针（更模糊地称为“拥有指针”），而不是智能指针。

哑指针 (T*) 从来都不是最好的解决方案。它们使您进行显式内存管理，这很冗长、容易出错，有时几乎是不可能的。但更重要的是，它们不会表明您的意图。

自动指针在销毁时删除指针。对于数组，更喜欢向量和双端队列等封装。对于其他对象，很少需要将它们存储在堆上 - 只需使用本地和对象组合即可。对于自动指针的需求仍然出现在返回堆指针的函数中——例如工厂和多态返回。

当指向它的最后一个共享指针被销毁时，共享指针会删除该指针。当您想要一个不费吹灰之力的开放式存储方案时，这很有用，其中预期寿命和所有权可能会因情况而有很大差异。由于需要保留一个（原子）计数器，它们比自动指针慢一点。有人半开玩笑地说，共享指针适用于无法设计系统的人——请自行判断。

对于共享指针的基本对应物，也请查找弱指针。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-01-06T17:46:01.177

智能指针在超出范围后会自行清理（从而消除对大多数内存泄漏的恐惧）。共享指针是智能指针，它记录指针实例的存在数量，并且仅在计数达到零时才清理内存。一般来说，只使用共享指针（但一定要使用正确的类型——数组有不同的类型）。它们与[RAII](http://en.wikipedia.org/wiki/RAII)有很大关系。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-06T18:23:05.050

为避免内存泄漏，您可以尽可能使用智能指针。C++ 中基本上有 2 种不同类型的智能指针

*   引用计数（例如 boost::shared_ptr / std::tr1:shared_ptr）
*   非引用计数（例如 boost::scoped_ptr / std::auto_ptr）

主要区别在于引用计数的智能指针可以被复制（并在 std:: 容器中使用），而 scoped_ptr 不能。非引用计数指针几乎没有开销或根本没有开销。引用计数总是会引入某种开销。

（我建议避免使用 auto_ptr，如果使用不当会有一些严重的缺陷）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-06T18:06:16.223

为了给 Sydius 的答案添加一点点，智能指针通常会通过捕获许多容易出错的错误来提供更稳定的解决方案。原始指针将具有一些性能优势，并且在某些情况下可以更加灵活。在链接到某些 3rd 方库时，您可能还被迫使用原始指针。

# iis - 更改 IIS 6.0 中的默认区域设置

> ID：417497
> 
> 赞同：8
> 
> 时间：2009-01-06T17:44:24.487
> 
> 标签：iis, localization, iis-6

我有一个由英国托管公司托管的托管 VPS，由于某种原因设置为美国设置。事实上，直到最近，区域设置还是“英语 - 美国”。我已更正了区域设置，但我的应用程序仍在使用错误的日期格式。看：

[http://www.albaassoc.com/events/listevents.aspx](http://www.albaassoc.com/events/listevents.aspx)

默认日期应该是当前日期到日期 + 3 个月，但如您所见，dd 和 MM 字段被交换了。注意：AJAX 日历扩展器手动设置为 dd/MM/yyyy，这就是为什么日历弹出认为我们对 6 月/7 月而不是 1 月感兴趣的原因！

我知道有多种方法可以设置页面或应用程序以使用特定语言环境，但我宁愿采用全局方法。

是否可以重新配置 IIS 以在不同的语言环境中工作，或者如果没有，我可以调整 machine.config 使其成为一次更改吗？

我已经向主机开放了一张票，但我不会屏住呼吸 - 他们不会想要重新安装 IIS ......

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T17:52:41.710

通过[全球化](http://msdn.microsoft.com/en-us/library/hy4kkhe0(VS.71).aspx)元素，您可以为站点（通过 web.config）或整台机器（通过 machine.config）设置文化和 uiculture。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-13T20:59:54.603

我刚刚遇到了类似的问题（Windows Server 2008、IIS 7）。我可以通过编辑 web 配置文件来修复它，但和你一样，我想要一个全局修复。

解决方案在配置面板，区域设置中。我不知道你（你的操作系统是什么），但在 WS2008 下，区域设置下有一个管理选项卡。它允许您将登录用户（您）的设置复制到管理帐户（在这种情况下为网络服务）。重新启动并做对了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-17T14:39:02.297

问题通常是运行 IIS 或您的应用程序所属的应用程序池的用户是安装服务器时创建的系统帐户。因此，他们继承了当时的默认语言环境。

如果您无法在区域和语言选项中修复它，您可以随时尝试直接在注册表中进行编辑（通常的附带条件是，弄乱注册表会严重破坏 Windows）。区域设置都在 HKEY_USERS\{userid}\Control Panel\International 下 - 如果您将每个用户的内容与您在 HKEY_CURRENT_USER\Control Panel\International 下的内容进行比较，那么应该很明显要更改什么。我已经在 Windows 2000 服务器上做了几次，并且运行良好。

另一种选择是在具有正确区域设置的计算机上创建一个新用户，然后将 IIS 和应用程序池都设置为使用该身份运行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-28T10:47:56.057

有点老线程，但我仍然关注一些由现已不复存在的阿兹特克文明编写的经典 ASP 站点，以赞美他们的羽毛之神。

服务器移动阻止了所有日期代码的工作并且牺牲了一只鸡没有帮助，所以这里是 IIS 7 中没有提到的非常简单的解决方案，可能是因为没有其他人像我一样受苦。

1.  转到 IIS 管理器。
2.  选择要应用于所有站点的根服务器节点，或者如果您想单独保留服务器默认设置，请选择您遇到问题的站点节点。
3.  在 IIS 部分，双击 ASP 图标。
4.  将区域设置 ID 设置为所需的区域设置（英国为 2057）。

这应该立即生效。

或者，你可以去买一个 DeLorean，回到过去，杀掉那个认为`FormateDateTime(d, vbLongDate)`生成要在数据库中使用的日期的最佳方法的程序员。或者说服客户给我很多钱来更换整个东西。哪个都好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-22T02:06:06.080

我遇到了一个问题，当我希望日期格式为 dd/mm/yyyy 时，它的格式为 mm/dd/yyyy。我正在使用 Windows Server 2003 和 IIS 6

解决方案是将以下内容添加到任何 Web 配置文件中，然后重新启动服务器，它应该可以正常工作。

```
<globalization requestEncoding="utf-8" responseEncoding="utf-8"  culture="en-GB" /> 
```

# filesystems - ZFS 能否在 OpenSolaris 中镜像整个硬盘驱动器？

> ID：417503
> 
> 赞同：3
> 
> 时间：2009-01-06T17:46:56.323
> 
> 标签：filesystems, opensolaris, zfs

我正在升级一个 OpenSolaris 开发工作站，最近购买了两个 500GB SATA 硬盘驱动器，希望使用主板的功能来镜像驱动器。当配置为通过 BIOS 进行镜像时，OpenSolaris 无法识别驱动器，但在其他情况下它可以很好地看到它们。ZFS 可以镜像整个驱动器吗？如果主驱动器出现故障，镜像是否可以引导？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T16:13:08.837

我很幸运，通过 RSS 提要发布了一篇博文，该博文提到了一个指向正确手册的教程。答案是“是”，但设置不是自动的。如果我正确解释[了文档的这一部分，](http://docs.oracle.com/cd/E23823_01/html/819-5461/ggpco.html#scrolltoc "Oracle Solaris ZFS 管理指南：从 ZFS 根文件系统引导")您可以创建一个镜像并添加从第二个驱动器启动的功能。然后在 grub 中，每个驱动器都会显示为引导选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T18:45:52.693

[ZFS 引导项目常见问题解答](http://opensolaris.org/os/community/zfs/boot/zfsbootFAQ/#mirrorboot)似乎表明这是可能的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T16:25:24.037

您需要一个相当新的 Solaris 版本（从 2007 年末到 2008 年都应该这样做），以便从镜像引导 zfs。不过，我不确定是否要启动 raidz。[在此处](http://www.solarisinternals.com//wiki/index.php?title=Category:ZFS)查看文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T02:53:57.803

zfs 引导在 Sol10u5 左右，从 nv9x 开始在 opensolaris 中。只需使用控制台安装并在询问时选择 ZFS。;)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T17:15:20.500

看一下

[http://www.castro.aus.net/~maurice/opensolaris/zfsbootmirror.html](http://www.castro.aus.net/~maurice/opensolaris/zfsbootmirror.html)

# c# - 使用 ASP.NET 编辑 HTML 元标记

> ID：417510
> 
> 赞同：2
> 
> 时间：2009-01-06T17:49:31.263
> 
> 标签：c#, asp.net, html

### 问题

* * *

我正在尝试构建一个快速简便的 ASP.NET 页面，该页面使用元重定向将用户重定向到新 URL。唯一的麻烦是我还需要传递当前请求的 GET 值。我在使用 HtmlMeta 对象的代码中找到了一种以编程方式执行此操作的方法。但是，我想避免使用后面的代码，而只是将此代码直接放入 ASPX 页面中。

这是我到目前为止所拥有的：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title>Untitled Page</title>
    <meta http-equiv="refresh" content='10;url=http://contact.test.net/main.aspx?<%=Request.QueryString.ToString()%>' />
</head>
</html> 
```

但是，这会吐出以下元标记：

```
<meta http-equiv="refresh" content="10;url=http://contact.test.net/main.aspx?<%=Request.QueryString.ToString()%>" /> 
```

那么有什么方法可以转义属性，以便 ASP.NET 代码实际执行？

### 解决方案 1

* * *

目前，我通过从 HTML 属性中删除引号来解决我的问题。从而使元标记如下：

```
 <meta http-equiv="refresh" content=10;url=http://contact.test.net/main.aspx?<%=Request.QueryString.ToString()%> /> 

```

虽然这解决了这个问题，但我很好奇是否有人知道更正确的方法，我可以逃避 HTML 属性的文字引号。

### 解决方案 2（最终选择的解决方案）

* * *

根据 Scott 非常感谢的建议，我决定继续从后面的代码中执行此操作。对于任何好奇这是如何实现的人：

```
 Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Dim nRef As String = Request.QueryString("n")
        Dim sRef As String = Request.QueryString("s")

        Dim contentAttrBuilder As New StringBuilder("0;http://contact.cableone.net/main.aspx")
        contentAttrBuilder.Append("?n=")
        contentAttrBuilder.Append(nRef)
        contentAttrBuilder.Append("&s=")
        contentAttrBuilder.Append(sRef)

        Dim metaRedirect As New HtmlMeta()
        metaRedirect.HttpEquiv = "refresh"
        metaRedirect.Content = contentAttrBuilder.ToString()

        Me.Header.Controls.Add(metaRedirect)

    End Sub 

```

谢谢，
克里斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T03:41:45.907

也许 head 标签内的这段代码就是你需要的：

```
<%= string.Format("<meta http-equiv='refresh' content='10;url=http://contact.test.net/main.aspx?{0}' />", Request.QueryString.ToString()) %> 
```

**但是**，我不建议您这样做。例如，这个网址：

```
http:/mysite.with.metaredirect?<script>alert('hello!!!')</script> 
```

如果您没有禁用其安全功能，则会在 asp.net 中引发异常，并且您永远不知道是否有人（甚至您自己）会出于其他原因将其关闭。**强烈**建议对查询字符串进行

代码隐藏*按摩*！

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T03:13:12.420

您是否尝试过以编程方式添加整个元标记？
一旦你得到运行服务器端，在 Page_Load() 上动态添加你的新标签，你可以指定它的所有属性。

该过程在这里得到了很好的描述：http:
[//www.howtoadvice.com/SetMetaTags](http://www.howtoadvice.com/SetMetaTags)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T18:07:57.853

删除`runat="server"`属性`<head>`

# .net - 如何跟踪和消除会话滥用？

> ID：417512
> 
> 赞同：5
> 
> 时间：2009-01-06T17:49:56.270
> 
> 标签：.net, asp.net, performance, session, session-state

我很确定过去曾有开发人员严重滥用我们可怜的朋友 ASP.NET 会话状态。Session 很想帮助跟踪请求之间的事情，但只能做这么多！请帮我减轻它的痛苦，让它和我们一起快乐地工作。

有谁知道可以跨多个内存会话监控会话大小的工具？我们目前在负载均衡器上打开了 IP 亲和性，因为会话太大，人们希望将它们保存在内存中。我希望能够监控平均会话大小以及单个会话，哪些应用程序一直在访问它们，以及会话中存储了什么。

现在必须停止这种对会话状态的无情、轻率的滥用。我们可以一起找到答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T21:00:11.987

我想你可以实现类似这个[自定义会话提供程序](http://alpascual.com/blog/al/archive/2008/10/27/zip-compressing-asp-net-session-without-changing-your-code-using-a-session-provider.aspx)并添加一些监控而不是压缩。这当然会使会话对象更大更慢，但它可以为您提供所需的监控。

如果您使用 SQL 作为会话提供程序，您应该能够在 sqlserver 中对其进行监控，但当然 sql server 会使会话处理速度变慢..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T20:15:31.657

我同意 Sessions 被滥用。我目前不知道监控会话大小的工具，但我确实建议在将您的应用程序发布给大众之前进行代码演练。

通过代码演练，您可以轻松识别会话中存储的信息类型、使用方式以及了解其大小。（例如，将整个数据集存储为 Session 变量）

# java - 快速和肮脏与良好的设计

> ID：417515
> 
> 赞同：4
> 
> 时间：2009-01-06T17:51:42.790
> 
> 标签：java, web-applications

当你的经理希望你以一种快速而肮脏的方式实施某事而你只知道它会适得其反时，你会怎么做？

我的经理希望我为客户开发一个 Web 应用程序并尽快完成。这是我们为这个客户构建的第一个 Web 应用程序，我认为正确地做这件事很重要，这样当他们不可避免地要求我们增强它或创建一个新应用程序时，我们就能够在它的基础上进行构建。

我想花一些时间建立一个框架（即使它只是像[Stripes](http://www.stripesframework.org/display/stripes/Home)这样简单的东西），并配置 tomcat 以使用 DBCP。我还认为我们应该使用 css 模板，并至少对应用程序的呈现和设计给予最少的考虑，因为在我看来，没有什么比设计不佳的网页更不专业的了（除非它是一封带有非常糟糕的语法）。

问题不在于我们面临完成这项工作的压力，而更多的是我的经理认为他不能证明为他自己认为不必要的事情加班收费是合理的。他的“尽快完成”的方法已经有几次适得其反——例如，有一次，他告诉我不要设计代码来处理某种错误情况，因为它不太可能发生，然后当它确实发生时是一团糟（我不得不清理）。

那我该怎么办？我真的“又快又脏”吗？如果我花费的时间比他希望的要长，我是否决定最快的方法是做正确的事并处理后果？这里的部分问题是，虽然我过去做过 Web 开发，但它总是在现有的框架内，所以从头开始建立一个框架对我来说是一个学习曲线。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-06T17:57:24.337

请记住，在他看来，长时间计费会降低销售对客户的吸引力。这可能是一个很好的营销方法（即使这是一个可怕的设计决策），现在写得又快又脏，所以客户喜欢它，当他们想要改变时，他可以在未来花费更多时间，因为现在他有客户他的网”。

但我的建议是：环顾四周，他负责，所以按照他的方式去做，否则你只会给自己制造问题。如果你想把事情做好，那就成为老板，或者找另一家相信以正确方式做事的公司。但是，仅仅违背常规只会让你被解雇或和这个家伙一起进狗窝，这就是生活的运作方式。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-06T18:25:31.130

做的又快又脏。这就是他们想要的，这就是他们愿意付出的。拿钱然后交付。

后来，当系统因为那里的完整和完全混乱而无法管理时，客户想要并支付一个强大的、精心设计的解决方案，拿钱并交付它。

看，你得到了两次报酬！

此外，一个废话解决方案最终会导致一些正在进行的手动过程。这些可以收费。你又得到报酬了！

难怪你的经理喜欢这种方法！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T06:54:43.037

尽管存在风险，但我将就此提供**管理观点。**:-)

我与一些团队成员遇到的一个挑战是，他们有时很难看到全局。这显然是开发人员也可以对他们的经理做出的声明——当然，经理（尤其是非技术经理）可能无法理解现在仓促的决定将如何导致以后出现问题。但我要再说一遍，不只是管理者会错过大局。开发人员也可以。

有一次我的团队应该开发一个简单的演示，我有两个人在做。这很可能是一个一次性的演示。我们是否有可能最终保留并详细说明它？当然。这个机会甚至是不错的——也许（在这里只是编一个数字）25% 只是为了争论。将近一个月后，没有交付成果，最后我打电话给 BS。事实证明，开发人员正在“设计”这个东西。将其设置为模块化、可插拔、可测试等。我告诉他们停止，我在一个下午自己编写了演示。“大局”是快速向客户提供概念验证，如果出于某种原因我们决定希望演示演变成实际的生产软件——很好——在最坏的情况下我们会扔掉一个下午' 值得“努力”。那是最坏的情况。不像我能写几百行代码*这么*复杂。

毫无疑问，有时经理会以权宜之计的名义做出糟糕的决定，但仅仅因为我要求我的团队做一些快速而肮脏的事情并不意味着我是短视的。大多数情况下，这意味着在确保工程正确的情况下，快速交付价值更为重要。不幸的是，对于一些开发人员（当然是少数）来说，这个建议本身就是一种亵渎。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-06T18:11:04.467

开始润色简历。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-01T11:33:22.037

让你的老板从他们的错误中吸取教训。

如果您总是努力保护他们免受自己的伤害，那么他们将永远无法从他们的错误决定中吸取教训，而您将始终试图减轻他们的下一个错误决定。

同样重要的是，您不要让他们免受错误决定的影响，例如，悄悄地为您感到内疚的事情安排一个周末。

你可以而且当然应该优雅地做这一切，没有一丝恶意。更好的是，尽早以外交方式讨论每种方法的原因可以创造奇迹。

当然有些人永远学不会;-)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-06T18:10:35.463

如果“第一个 Web 应用程序”是指原型，那么您可能应该快速而肮脏地完成它。您的客户可能希望在他们承诺任何事情之前先看到一些东西。但是，您可以快速做一些事情；不让它变脏。如果您对如何设计和编写 Web 应用程序非常小心，您可能会在发布第一个版本后立即将 Web 应用程序变成一件艺术品。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T23:43:42.483

如果它只是为客户演示，我认为快速而简单的解决方案就足够了，但最终，如果你认为它会适得其反，你作为开发人员的工作就是抗议。[清洁代码](https://rads.stackoverflow.com/amzn/click/com/0132350882)中的鲍勃叔叔很好地说明了这一点：

> “如果你是一名医生，有一个病人要求你停止所有愚蠢的洗手准备手术，因为这太费时间了怎么办？显然病人是老板，但医生绝对应该拒绝服从. 为什么？因为医生比病人更了解疾病和感染的风险。医生顺从病人是不专业的（更不用说犯罪了）。
> 
> 因此，程序员屈从于不了解制造混乱风险的经理的意愿也是不专业的。”

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-06T18:25:31.877

我觉得有时你必须基于正直做出选择，而不是为了权宜之计或仅仅因为你受到老板的压力而屈服。这并不意味着我对你的问题有答案，只是你必须自己决定在这种情况下，对于这个客户，在你的组织中什么是合适的。问你自己：

*   你的老板真正了解客户想要什么？
*   你比你的老板更了解吗？您与客户的关系是否更牢固？
*   快速行动的压力来自哪里？
*   客户是否意识到与“又快又脏”相关的成本/收益？
*   你在什么样的组织机构工作？您是否会认为自己更像是一名顾问（非常接近客户）而不是员工，反之亦然？
*   您的老板（在您的公司或客户）的想法如何？同样，您的想法如何？
*   代码是否真的被丢弃了，或者它是否会在未来真正被使用

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T01:09:09.007

我不会对老板太挑剔。就像很多人说的，他/她和你一样有 POV。您需要通过学习某种快速原型制作工具来适应处理此类需求。我将 Microsoft 平台用于商业和 Web 应用程序（Java 用于科学工具），因此每当有人想查看原型网站时，我都可以使用 ASP.NET 在我的本地开发平台上快速破解一些东西。通常对于一个原型来说，丑陋并不像功能那么重要。如果客户知道某件事是可能的，那么他们将倾向于购买美化（除非它是内部的 - 那么谁在乎它的外观 - 哈！）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-07T07:15:27.830

考虑一下您应该是“专业软件开发人员”这一事实。成为专业团体的成员意味着遵守一些准则和规则。这意味着你不能仅仅因为管理层告诉你就放弃你的原则。

如果你真的相信建立一个框架和使用 CSS 模板对于交付一个质量合适的产品是必要的，那么坚持去做。

想象一下，如果一位建筑工程师被他的经理告知要以一种快速而肮脏的方式进行桥梁设计。即使他知道设计质量差，他还会这样做吗？如果他这样做了，对他个人和建筑工程这个职业会有什么后果？

我认为我们作为软件工程师需要对我们的工作更加自豪，并表现出更多的专业责任。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-07T07:23:35.443

我会将“Q&D”解释为“快速且功能差”。Dirty 很少是快速的，即使对于演示或概念证明也是如此。无论你做什么开始，你都会重构它。只要给它可用的时间，并专注于 YAGNI 和最小足够解决方案。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-06T17:54:07.667

Ruby on Rails。如果这是一个选项。我多次听说这是让 CRUD 站点启动并运行良好的最快方法。

[编辑]

构建自己的框架是一种巨大的浪费时间，你将无法在任何合理的时间内构建一个世界级的框架。不要重新发明轮子。我听过很多程序员说“哦，是的，我可以把它做得更好。” 当然可以，但是您能否在 5 到 10 小时的付费时间内将其构建得与您的公司直接购买它的成本一样好？不太可能。

如果这是你的公司经常做的事情，那么你应该说服你的老板让你找到一个现成的解决方案来解决“快速而肮脏但仍然不错”的问题。这可能意味着现在需要额外的时间，但将来会节省时间。

[/编辑]

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-06T17:59:44.630

这是您需要管理的情况。你的老板认为没有必要实施一个好的设计，因为他认为从长远来看它不会变得更容易。您现在可以说服他，也可以确保他在修改最终需要更长的时间时发现问题。至少你可以引导他思考几个小任务，这样你就可以训练他随着时间的推移进行好的设计。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-06T18:00:28.357

只需进行快速而肮脏的实施。你的工作是将规范变成一个工作程序，而不是分析直接成本和未来收益之间的权衡。我曾与坚持添加大量间接层、包装器、未使用代码等的工程师一起工作，这些没有人为此付费，坚称他们比 PM 更了解。我也是*那*个人（在我毕业后的几年里），它不会让你受欢迎。我不再这样做了。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-06T18:01:34.453

嗯，如果你的老板只愿意资助快速和肮脏的，而你不同意这项任务，那就找另一份工作。听起来你不喜欢做你得到报酬的事情。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-06T18:01:34.983

如果这是您被要求的，我会快速而肮脏，正如 jcollum 建议的那样，Ruby on Rails 可能是一个解决方案。

我要快速解决问题的原因是，如果用户和您的经理有时间框架和预算，并且您可以提供满足这些要求和任何其他要求的稳定解决方案，那么您应该这样做。归根结底，如果您为其他人工作，那是为了满足他们的要求，而不一定是您自己对最佳实践或框架设计的想法。也就是说，如果你能让你的经理和客户相信更多前期投资的长期利益，以获得更好的长期结果，那就去做吧，对你公平竞争。

我的猜测是，一旦您完成了更多的实现，您将能够更好地结合快速和良好。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-06T18:01:47.213

一方面，你不一定了解老板面临的所有因素和压力。也许他/她知道这是“一次性的”，您不会与该客户开展任何业务。

最重要的是，您将获得报酬来实施他们告诉您实施的任何事情。是的，你有责任指出利弊，但最终，这是他们的决定。

但是，为了安全起见，记录一切！如果人们开始玩责备游戏，你至少可以掩饰你的屁股。（可能没有任何好处，但始终保护自己。）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-01-06T18:01:56.887

我的建议是说有一种快速而肮脏的方法可以在 X 天/周/月内满足要求，并且如果有重大的增强或功能，那么迁移到可以处理的更大的东西将需要成本现在需要。

这里要考虑的是 YAGNI 的想法，如果客户除了他们在第一个实现中想要的基础之外不想要任何东西。还有一个问题是您将在第一轮中构建多少框架。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-06T18:09:04.937

如果您负责，我想您会以“正确”的方式进行良好的设计，即使需要更长的时间。但问题是你的经理负责。所以，这听起来像是你应该与你的经理进行的对话。

（巧妙地）提醒他他的方法有时会导致混乱，并建议对项目给予更多关注。建议在这个项目上投入更多精力可能是一个很好的营销决策，因为与该客户的关系可能至关重要。不要陷入争论，只是让自己被听到。至少这可能会让他停下来重新考虑他的决定——也许他可以与客户再次讨论*他们*愿意支付多少。

最后，尊重他的决定，但要确保他确实意识到这是*他的决定*，而你只是在服从命令。这样，如果将来确实出现问题，它最终不会成为您的问题。

如果他不是平易近人的类型，我认为你会坚持以快速而肮脏的方式去做。我会记录这种情况，以尽量减少未来咬屁股的可能性。

# java - 运行 Java 应用程序的新可执行文件，保存会话

> ID：417517
> 
> 赞同：2
> 
> 时间：2009-01-06T17:52:33.350
> 
> 标签：java, user-interface

这是一个相当新手的问题，但是如果您给我一些线索，它将非常有帮助。

我正在运行一个 Java 应用程序（使用 Gui）。每次我退出 Gui 时，会话（我在 Gui 中所做的）都会被保存，下次我启动 Gui 时，保存的会话会被加载。当我将应用程序安装在另一个目录中并运行新安装的应用程序的可执行文件时，会加载旧应用程序的保存会话。为什么会这样？应用程序是相同的版本，并且具有相同的名称，但是我认为当我启动新安装的应用程序的可执行文件时，将启动一个全新的会话（并且与我在另一个应用程序的 gui 中所做的事情无关会被记住）。如果我第二次或第 n 次运行该应用程序，则会保存前一个应用程序，可能是因为有一个选项要保存会话，

我是否必须更改/删除计算机中某处的某些内容才能避免这种情况发生？（我正在使用 Windows 机器尝试这些东西）。

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T18:07:04.303

Java 可以将其程序设置保存在[Preferences](http://java.sun.com/j2se/1.4.2/docs/api/java/util/prefs/Preferences.html)中，而 Preferences 又存储在每个用户的位置，具体取决于用于存储和检索值的设置。在 Windows 框中，这些首选项存储在注册表中的 HKEY_CURRENT_USER/Software/JavaSoft/Prefs 下

这下可能有一个大目录树，使用对象的类路径来区分值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T22:17:03.627

您是否使用 Swing 并且您的应用程序是否在扩展`SingleFrameApplication`（例如，在 NetBeans 中创建的默认 GUI 应用程序）。如果是这样，则保存窗口状态信息 - 取决于平台。要阻止这种情况发生，您需要覆盖`shutdown`类中扩展的方法`SingleFrameApplication`

```
@Override
protected void shutdown() {
    super.shutdown();  // remove this if you don't want the window state saved
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T18:05:53.400

该应用程序可能会将您的首选项保存在您的主目录或 Windows 注册表中，即使用[Preferences API](http://java.sun.com/j2se/1.4.2/docs/guide/lang/preferences.html)。

# .net - .NET web service without proxy class

> ID：417535
> 
> 赞同：2
> 
> 时间：2009-01-06T17:58:45.113
> 
> 标签：.net, web-services, reflection, proxy-classes

I'm trying to create an application that will let me execute a method specified at runtime on an arbitrary webservice (the URL of which I'll also provide at runtime). I've figured out how to use Type.InvokeMember to execute the arbitrary method, but how do I specify the web service to consume without creating a proxy class.

I found [How do I call a webservice without a web reference?](https://stackoverflow.com/questions/125627/how-do-i-call-a-webservice-without-a-web-reference) which will helps me out if I already have the WSDL and only the URL will change, but I'd like to be able to call any webservice and fetch the result.

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T18:10:57.587

For WCF, you need to either have the proxy class, or the interface the service implements, so it's not likely you can do it via WCF (WCF is endlessly extensible, however, so there may be a way.

You can always just spin-up an HttpWebRequest object and make an "old-school" call to the service and parse the results yourself.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T18:09:04.313

You should take a look at Dynamic Proxy for WCF (I'm sorry, but I can seem to find a link to it right now) - it's a library that lets you inspect services at runtime (if they publish their metadata), and also invoke methods (no need for metadata to do that).

Edit: actually, it seems that there is a project on Codeplex to do just that: [SIF](http://www.codeplex.com/SIF)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T18:25:21.520

You should be able to make your call just using [WebRequest](http://msdn.microsoft.com/en-us/library/system.net.webrequest.aspx). You'll have to form the body of the [message](http://www.w3schools.com/SOAP/soap_syntax.asp) yourself, but that's not very hard.

# data-structures - 如何在大数据集中找到唯一条目？

> ID：417549
> 
> 赞同：1
> 
> 时间：2009-01-06T18:03:37.227
> 
> 标签：data-structures

我有1亿行数据，数据是一个不超过15个字符的单词，每行一个单词。这些数据存储在多个文件中。

我的目标是在所有文件中找到唯一的单词。

一种解决方案是将所有单词导入数据库并为该字段添加唯一键。但这对于这个大型数据集来说太慢了。

有没有更快的解决方案？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T18:09:20.443

我不确定是否会有比使用数据库更快的方法。就个人而言，我通常为此使用 UNIX shell 脚本：

```
cat * | sort | uniq 
```

我不知道 100,000,000 个单词会有多快，我也不确定你希望它有多快。（例如，您需要运行它很多次还是只运行一次？如果只运行一次，我会选择 sort 和 uniq 选项，如果可以的话让它运行一夜）。

或者，您可以使用 ruby​​ 或类似语言编写脚本，将单词存储在关联数组中。我怀疑这几乎肯定会比数据库方法慢。

我想如果你真的想要速度，并且你需要经常执行这个任务（或类似的任务），那么你可能想用 C 写一些东西，但对我来说这感觉有点矫枉过正。

本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T23:21:23.497

为此使用数据库是疯狂的。15个字符的1亿条记录适合ram。如果至少有一些重复，只需构建一个 trie。应该能够在现代机器上处理 50MB/秒左右

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T18:08:39.370

如果您必须坚持使用文件结构，那么您需要某种方式来索引文件，然后维护索引。

否则，我建议移动到数据库并迁移对该文件的所有操作以使用数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T18:22:14.240

您可以将单词存储在哈希表中。假设有相当多的重复，O(1) 的搜索时间将是一个很大的性能提升。

1.  读一行。
2.  在哈希表中搜索单词。
3.  如果未找到，请将其添加到表中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T18:26:47.990

如果你有这么多数据，那么它需要在 SQL 服务器中。这就是最初设计 SQL 的原因。如果您继续使用这些文件，您将永远陷入性能问题。

即使这些文件是从外部程序（或通过 FTP）修改的，您也需要创建一个导入过程以在夜间运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T19:08:50.357

如果单个文件中存在大量重复，则逐个文件执行然后合并结果可能会更快。类似于以下内容：

```
{ for n in * ; do sort -u $n ; done } | sort -u 
```

（我假设 GNU bash 和 GNU 排序）

不过，我认为最佳解决方案的选择将在很大程度上取决于重复文件的分布和单独文件的数量，但您尚未与我们共享这些文件。

* * *

鉴于 myhusky 的澄清（大量的骗子，10~20 个文件），我肯定会建议这是一个很好的解决方案。特别是，密集复制**`sort -u`**将比**`sort|uniq`**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T20:34:40.167

您可以节省速度、空间或理智。随便选两个。

正如您所发现的，将其全部放入数据库会牺牲速度和空间。但这很容易。

如果空间是您的主要问题（内存、磁盘空间），则对工作进行分区。从文件中过滤所有 1 个字符行并使用上述解决方案之一（排序、uniq）。对每个文件重复 2 个字符行。等等。每次通过的独特解决方案形成您的解决方案集。

如果您的主要问题是速度，则在创建哈希表（字典等）后准确读取每个文件以查找重复项。根据散列实现，这可能会消耗大量内存（或磁盘）。但它会很快。

如果您需要节省速度和空间，请考虑混合使用这两种技术。但要做好牺牲第三项的准备。

# javascript - jQuery UI 选项卡 - 如何在悬停时选择选项卡

> ID：417550
> 
> 赞同：3
> 
> 时间：2009-01-06T18:03:39.020
> 
> 标签：javascript, jquery, jquery-ui, tabs, jquery-ui-tabs

使用该[`jQuery UI Tabs`](https://jqueryui.com/tabs/)组件，是否可以在悬停时选择新选项卡而不是单击它们？

[我在这里](http://stilbuero.de/jquery/tabs/mouseover.html)找到了一个示例，但这似乎不适用于最新（稳定）版本的 jQuery 和 jQuery UI 选项卡。

最后，其中一位[开发人员提到这将成为 Tabs 3 中的一个选项，该选项](http://markmail.org/message/yymcisfniiyrf6ls#query:jquery%20tabs%20rollover+page:1+mid:w3kazcwusiyxahsz+state:results)已发布，但我在 API 中找不到任何提及。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T18:08:59.930

[demo here](http://ui.jquery.com/demos/tabs#mouseover)它使用 1.6rc4 运行，我认为它与任何其他 ui 版本一样稳定！

# c# - 浮动与双重性能

> ID：417568
> 
> 赞同：94
> 
> 时间：2009-01-06T18:09:05.763
> 
> 标签：c#, .net, clr, performance

我做了一些计时测试，还阅读了一些类似[这篇](http://www.cincomsmalltalk.com/userblogs/buck/blogView?showComments=true&title=Smalltalk+performance+vs.+C%23&entry=3354595110#3354595110)文章（最后评论），看起来在 Release 构建中，float 和 double 值需要相同的处理时间。

这怎么可能？当浮点数与双精度值相比不太精确且更小时，CLR 如何在相同的处理时间内获得双精度值？

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2009-01-06T18:15:38.450

至少在 x86 处理器上，`float`并且`double`每个都将由 FPU 转换为 10 字节实数进行处理。FPU 没有针对它支持的不同浮点类型的单独处理单元。

`float`比 100 年前应用更快的古老建议，`double`当时大多数 CPU 没有内置 FPU（而且很少有人拥有单独的 FPU 芯片），因此大多数浮点操作都是在软件中完成的。在这些机器上（由熔岩坑产生的蒸汽提供动力），*使用*s `float`. 现在，s 唯一真正的好处`float`是它们占用的空间更少（这只有在你拥有数百万个空间时才重要）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-13T09:37:12.697

它取决于**32 位**或**64 位**系统。如果编译为 64 位，double 会更快。在 64 位（机器和操作系统）上编译为 32 位，浮点运算速度提高了 30% 左右：

```
 public static void doubleTest(int loop)
    {
        Console.Write("double: ");
        for (int i = 0; i < loop; i++)
        {
            double a = 1000, b = 45, c = 12000, d = 2, e = 7, f = 1024;
            a = Math.Sin(a);
            b = Math.Asin(b);
            c = Math.Sqrt(c);
            d = d + d - d + d;
            e = e * e + e * e;
            f = f / f / f / f / f;
        }
    }

    public static void floatTest(int loop)
    {
        Console.Write("float: ");
        for (int i = 0; i < loop; i++)
        {
            float a = 1000, b = 45, c = 12000, d = 2, e = 7, f = 1024;
            a = (float) Math.Sin(a);
            b = (float) Math.Asin(b);
            c = (float) Math.Sqrt(c);
            d = d + d - d + d;
            e = e * e + e * e;
            f = f / f / f / f / f;
        }
    }

    static void Main(string[] args)
    {
        DateTime time = DateTime.Now;
        doubleTest(5 * 1000000);
        Console.WriteLine("milliseconds: " + (DateTime.Now - time).TotalMilliseconds);

        time = DateTime.Now;
        floatTest(5 * 1000000);
        Console.WriteLine("milliseconds: " + (DateTime.Now - time).TotalMilliseconds);

        Thread.Sleep(5000);
    } 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-07-05T23:24:17.483

我有一个使用 CUDA 的小项目，我记得 float 也比 double 快。一旦主机和设备之间的流量较低（主机是 CPU 和“正常”RAM，设备是 GPU 和相应的 RAM）。但即使数据一直驻留在设备上，它也会变慢。我想我在某处读到过这种情况最近发生了变化，或者应该随着下一代发生变化，但我不确定。

因此，在这些情况下，GPU 似乎根本无法原生处理双精度，这也可以解释为什么通常使用 GLFloat 而不是 GLDouble。

（正如我所说，这只是我所记得的，只是在 CPU 上搜索 float 与 double 时偶然发现了这一点。）

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-06T18:20:13.463

然而，在某些情况下，浮点数仍然是首选——例如，对于 OpenGL 编码，使用 GLFloat 数据类型（通常直接映射到 16 位浮点数）更为常见，因为它在大多数 GPU 上比 GLDouble 更有效。

# windows-server-2003 - 如何以有限的权限远程查看 Windows 事件日志

> ID：417578
> 
> 赞同：6
> 
> 时间：2009-01-06T18:11:25.043
> 
> 标签：windows-server-2003, event-log

为了调试一些代码，我想查看远程机器的 Windows 事件日志（目标是 Windows2003）。使用 mmc.exe，我可以为远程机器添加事件日志，但前提是我有足够的权限。对于这台远程机器，他们不想给我远程登录的权限（或管理员权限）。是否可以授予我查看事件日志的特定权限而不是其他权限？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-06-08T17:12:00.403

在较新的 Windows 版本（Windows 7、Windows Server 2008...）上，您只需将相应的帐户添加到内置组**Event Log Readers**即可。

来源：Jane Lewis 在 TechNet 上的博客，[授予非管理员权限以阅读 Windows 2003 和 Windows 2008 事件日志](https://blogs.technet.microsoft.com/janelewis/2010/04/30/giving-non-administrators-permission-to-read-event-logs-windows-2003-and-windows-2008/)

如果您需要更细粒度的控制，此来源还描述了一种替代方法。

（OP 要求使用 Windows 2003，这种方法在其中不起作用，但由于不再支持 Windows Server 2003，人们可能会对这种方法感兴趣。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T18:27:38.003

对于安全日志，用户需要“管理审计和安全日志”权限

对于系统和应用程序日志，除非他们在以下注册表项下设置了 RestrictGuestAZccess 值，否则您应该能够以访客身份阅读它们：HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\EventLog\System HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\EventLog \应用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-28T14:34:23.143

Joshua Flanagan 概述了通过修改事件日志[的安全描述符来委派权限的过程。](http://flimflan.com/blog/PermissionsOnTheWindows2003ServerEventLog.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-06T07:31:29.797

一种选择是获取**远程本地管理员组**上的**本地 ID 。**

 ****接下来，从您的系统中，使用新的远程本地 ID**映射到远程服务器上的驱动器。

 ****从 Windows运行**开始菜单创建一个新的 MMC - 通过键入**MMC /a**

添加**EventView 管理单元**

当它提示您输入本地或远程服务器时 - 输入您映射到的服务器的主机名。

提示：Windows 使用已建立的安全连接 - 如果可以的话。因此，地图驱动技巧工作得很好。

请注意：我在 WMI 查询中使用了这个技巧——因此查询永远不会因为超时问题而失败。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-19T10:26:17.440

请将域用户（没有管理员权限）添加到目标服务器上的“事件日志阅读器”组。然后，您可以从源服务器使用标准用户凭据访问和读取目标上的事件日志。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-06T18:19:34.090

如果您可以启用对服务器的 Web 访问，那么您可以使用我不久前发布的[事件日志查看器](http://www.dscoduc.com/post/2008/03/06/Eventlog-Viewer.aspx)页面。这将允许管理员以足够的权限运行网站以查看事件日志，而无需授予您登录帐户...

# python - 如何判断 Expando 子类是否定义了属性？

> ID：417584
> 
> 赞同：0
> 
> 时间：2009-01-06T18:14:01.433
> 
> 标签：python, google-app-engine

我正在创建一个应用程序，我想拥有一组可扩展的属性（每个属性都是 RatingProperty） 我还想验证任何动态属性都属于 RatingProperty 类型。

在 Expando 文档中它说：

> 提示：如果要使用 Property 类验证动态属性值，可以实例化 Property 类并在值上调用其 validate() 方法。

所以如果我想验证一个动态属性，我需要知道类的非动态属性是什么。我怎样才能问我的班级它定义的属性是什么？

我考虑过创建一个类方法，该方法接受一个字符串，如果该字符串位于我创建和维护的属性名称列表中，则返回 true，但这似乎是一种 hack。我已经在 Google 上搜索了提示，但没有任何运气。

谢谢，帕特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T01:51:44.380

经过更多研究（该死的lazyweb！）我找到了一个我认为可以接受的解决方案：

动态属性不能是 db 子类属性类型。因此，必须采取两个不同的步骤。首先，您需要创建属性类的实例并验证您的值：

```
test = db.RatingProperty()
if test.validate(valueToSave):
    #do your thing 
```

接下来您需要检查您要保存的属性是否是已声明的属性：

```
if valueToSaveKey not in myObject.properties():
    #if not save it as desired
    myObject.valueToSaveKey = valueToSave 
```

这里的缺点是您保存的值没有存储为您想要的属性类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-02T16:41:17.270

[http://code.google.com/appengine/docs/python/datastore/modelclass.html#Model_properties](http://code.google.com/appengine/docs/python/datastore/modelclass.html#Model_properties)

db.Model 具有查找实例上所有属性的方法。

该类公开了一个 Property 对象列表： db.Model.properties()

该实例仅公开动态名称：instance.dynamic_properties()

您想要遍历列表并构建 Property 对象，然后运行 ​​p.validate()。

```
for p_name in instance.dynamic_properties():
    p = db.RatingProperty()
    p.validate() # raises BadValueError, etc. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-22T00:45:30.260

其实很简单！

[ExpandoObject](http://msdn.microsoft.com/en-us/library/system.dynamic.expandoobject.aspx)实现`(IDictionary<String, Object>)`，所以你只需要这样做：

```
 dynamic person = new ExpandoObject();
 person.FirstName = "Barack";
 person.LastName = "Obama"

 (((IDictionary<String, Object>)person).Keys  
    => { "FirstName", "LastName" }

 (((IDictionary<String, Object>)person).ContainsKey("FirstName")  
    => true 
```

注意：您需要显式转换为，`(IDictionary<string, object>`因为 ExpandoObject 显式实现了此接口 - 并且实例本身没有`ContainsKey()`or `Keys`。

不要期望此方法适用于所有动态对象 - 只是 ExpandoObject 和实现此接口的任何其他对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T14:07:47.310

我可能误解了你的问题，但是如果你有一个你希望找到的属性列表，为什么不直接使用标准的 db.Model，而不是 Expando？您可以向 Model 类添加其他属性，只要您提供默认值或不要求它们。

# java - Java中的抽象类和方法，继承

> ID：417590
> 
> 赞同：10
> 
> 时间：2009-01-06T18:15:17.967
> 
> 标签：java, inheritance, abstract-class

我有类 B，它继承自类 A。超类 A 是抽象的，包含一个抽象方法。我不想在 B 类中实现抽象方法，因此我也需要将 B 类声明为抽象。声明 B 类抽象，有两件事对我有用（程序编译和运行正确）：

1.）我没有在B类中声明任何抽象方法，即使该类是抽象的。我认为这是可行的，因为该类继承了类 A 的抽象方法，这足以将该类声明为抽象：我们不需要在该类中直接声明任何其他抽象方法。

2.) 我确实在 B 类中声明了与在 A 类中声明的相同的抽象方法。这是某种覆盖（？），与 java 中的覆盖不同（使用相同的标头，但提供不同的实现)，这里我只是再次使用该方法的相同标头。

这两件事都有效，我不确定它们是否都可以，以及其中一些是否比另一个更受欢迎（更正确）。这两种方式是否相同（它们对 Java 是否意味着相同）？

在这里，我给出了一些示例类，以便我的意思对您来说更清楚：

情况1。）：

```
public abstract class A {
    public abstract String giveSum();
}

public abstract class B extends A {

} 
```

案例2）：

```
public abstract class A {
    public abstract String giveSum();
}

public abstract class B extends A {
    public abstract String giveSum();
} 
```

问候

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-06T18:34:29.910

在Java中，`abstract`类注解表示该类不能直接实例化。可以简单地声明一个类，`abstract`因为它永远不应该被实例化（也许它只包含静态方法），或者因为它的子类应该被实例化。

不要求类包含方法（反之亦然**：****包含**一个或多个方法的类必须是.）`abstract``abstract`**`abstract``abstract`**

 **是否应该复制抽象方法定义的问题可能被视为一个风格问题 - 但我很难提出一个支持复制定义的论点（我能提出的唯一论点是在这种情况下）其中类层次结构可能会改变语义或方法的使用，因此您希望在 B 类中提供额外的 javadoc。）

反对重新定义该`abstract`方法的主要论点是重复代码是不好的——它使重构更加麻烦等等（所有经典的“不要重复代码”论点都适用。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-06T18:20:33.980

它们在功能上是相同的，但首选第一个，因为它更短且不奇怪。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T18:21:30.107

选择#1。在子类中重写方法声明是令人困惑的。而且你实际上不需要抽象类中的任何抽象方法，无论父类是否是抽象的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T18:22:55.377

所以，问题是：在java中对抽象类进行子类化并且不想提供实现时，哪个是首选？

> a) 也将子类标记为抽象
> 
> b）也将子类标记为抽象并重新编写标记为抽象的方法签名？

我会选择第一个：

> a) 也将子类标记为抽象。

前者已经有抽象方法声明，重复没有意义。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T19:29:28.037

你是对的，这两种情况是等价的。案例1）更简单，案例2）是代码重复 - 避免它。但这样做可能有一个原因：

如果 A 类中的方法没有返回`String`，但可以说 C，则 B 类可以用更具体的返回类型覆盖它（从 Java 5 开始），比如 D（类扩展 C）：

```
public abstract class A {
  public abstract C giveSum();
}

public abstract class B extends A {
  public abstract D giveSum();
}

public class C {
  ...
}

public class D extends C {
  ...
} 
```

# svn - SVN 最佳实践——团队合作

> ID：417599
> 
> 赞同：99
> 
> 时间：2009-01-06T18:19:01.547
> 
> 标签：svn

我从 SVN 开始。我知道基本命令并了解基本原理。我想知道是否有人对在团队环境中使用 Subversion 有任何提示或最佳实践。

我可以看到在提交代码时添加相当详细的消息的好处，但是我还应该记住其他一些事情吗？

**感谢所有出色的答案 - 他们帮助了很多。**

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-01-06T18:24:43.750

**鼓励频繁提交。** 刚接触版本控制的队友可能会觉得他们需要将代码保留在存储库之外，直到“它工作正常”。教导每个人尽早承诺并经常尽快发现问题。建议您的队友为可能破坏主干的功能创建分支，而不是保留代码直到它工作。这导致...

**建立分支和标记实践。** 除了功能分支之外，还鼓励您的队友使用分支来修复大错误。在工作开始和结束时标记主要错误修复。维护生产/质量保证版本的标签（可能还有分支）。

**制定主干政策并坚持下去。** 一个例子可能是，“trunk 必须始终没有错误地构建”。或“主干必须始终通过所有单元测试”。任何还不能达到主干标准的工作都必须在分支中完成。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2009-01-06T18:26:54.997

**不要通过代码更改提交格式更改**

如果你想重组一个巨大文件的空格（`Control`++ `K`）`D`，很好。将格式更改与实际的逻辑更改分开提交。如果您想在文件中移动函数，也是如此。将移动与实际编辑分开提交。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2009-01-06T18:44:27.393

我一直坚持的关键概念之一是将**相关的代码更改一起提交**。推论是**不要在同一次提交中提交不相关的代码更改**。这意味着不要在一次提交中修复 2 个错误（除非它是相同的修复），并且不要在 2 次提交中的每个提交中提交一半的错误修复。此外，如果我需要向系统的不相关部分添加一些新的增强功能或某些东西，然后我需要进行其他工作，我会单独（并且首先）提交增强功能。这个想法是，任何人可能想自己拥有（或自己回滚）的任何更改都应该是单独的提交。当需要进行合并或回滚损坏的功能时，它将为您省去很多麻烦。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-01-06T22:03:17.477

已经提到了很多，这里还有一些：

1.  如果您在源代码管理中有不需要的文件（例如配置、编译文件等），请将它们添加到**忽略列表中**。通过这种方式，您会注意到您忘记添加的任何文件，因为您总是期望一个空的文件列表显示为 SVN 未知。

2.  添加一个**提交后事件，该事件将向您的开发人员邮件列表**（或特定于该目标的邮件列表）发送一封与已提交更改相关的电子邮件，最好是为其提供补丁。

3.  **与您的错误跟踪器集成，**以便对提交的引用显示在错误/功能请求中，并带有指向差异的链接。[像MantisBT](http://www.mantisbt.org)这样的错误跟踪器支持这一点。

4.  考虑与**持续集成**（例如[CruiseControl.NET](http://sourceforge.net/projects/ccnet)）、用于构建的[NAnt和用于单元测试的](http://nant.sourceforge.net/)[NUnit](http://nunit.org/) /VS 集成。这样，一旦用户签入代码或在预定的时间间隔内代码被编译，单元测试就会运行，并且开发人员会获得该过程的反馈。如果存储库损坏（即未构建），这也会提醒团队的其他成员。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-01-06T18:23:42.240

好吧，基础知识：

*   在开始对版本进行 QA 之前创建标签
*   在有风险的更改之前创建标签（即大重构）
*   为已发布版本创建分支以冻结代码。
*   确保人们在开始编写一段代码之前知道要更新，并在提交之前再次更新。
*   SVN 允许不同用户多次检出同一个文件。确保每个人都解决可能发生的任何冲突。
*   **切勿**为多个用户使用同一个 SVN 帐户。可能会导致可怕的事情。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-01-06T18:51:28.533

人们给出的答案很棒。其中大部分内容都在 svn 用户文档中进行了总结，以[了解 SVN 的最佳实践](http://svn.apache.org/repos/asf/subversion/trunk/doc/user/svn-best-practices.html)。
重复：

1.  设置你的存储库结构（你应该有项目根目录，下面有主干、分支和标签）
2.  选择您的策略重新分支（私有分支、每个里程碑/发布/错误的分支等）并坚持下去——我建议更多分支而不是更少，但不需要私有分支
3.  选择你的策略重新标记——标签越多越好，但最重要的是决定你的标签命名约定
4.  选择您的政策重新承诺主干 - 保持主干尽可能“干净”，它应该可以随时发布

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2012-01-12T10:29:38.693

我想总结一下我坚持的最佳实践：

1.  **不要提交二进制文件**。二进制文件应该有单独的存储库，例如*Nexus*、*Ivy*或*Artifactory*。
2.  应该有**存储库结构**。我个人使用以下存储库结构：

    ```
    /trunk
    /tags
        /builds
            /PA
            /A
            /B
        /releases
            /AR
            /BR
            /RC
            /ST
    /branches
        /experimental
        /maintenance
            /versions
            /platforms
        /releases 
    ```

3.  使用特定的**分支类型**列表。我的清单如下：*experimental*、*maintenance*、*versions*、*platforms*、*releases*。
4.  使用特定**类型的标签**：`PA`(pre-alpha)、`A`(alpha)、`B`(beta)、`AR`(alpha-release)、`BR`(beta-release)、`RC`(release Candidate)、`ST`(stable)。
5.  **尽量减少合并的必要性**。何时可以/鼓励合并，何时不可以合并，应该有规则。
6.  **版本编号**。应该有固定的版本编号方法。通常在诸如软件配置管理计划之类的文档中进行描述，它是高级项目文档的一部分。我个人使用复杂的版本编号方法。根据这种方法，版本具有以下模式：**Nxx**（维护/支持分支）、**NMx**（发布分支） 、 **NxK**（构建）、**NMK**（发布）。
7.  **尽可能频繁地提交**。如果它往往很困难（例如，当为了实现功能甚至编译代码需要进行太多更改时），则应使用实验分支。
8.  **主干应该包含最新的发展**。例如，如果可以选择在哪里开发新的主要版本（**NXX**），则在*中继线*或分支机构中，应始终做出决定以支持*行李箱*。旧版本应该分支到*维护/支持*分支。它假定主要版本之间存在明显区别，并且它们的细节（架构、兼容性）*尽早出现*。
9.  **发布分支上严格的“不要破坏构建”政策**。同时，只要它可能有实验性开发或需要解决合并问题的代码库，它不一定对*主干很严格。*
10.  使用**svn:externals**。它将允许模块化您的项目，建立透明的发布管理程序，分而治之不同的功能。
11.  使用**问题跟踪**。您将能够在提交消息中指出问题参考。
12.  **禁用空提交消息**。可以使用预提交挂钩来完成。
13.  定义**您想要持续集成的分支**。例如，我更喜欢对*主干*、*维护*和*发布*分支使用持续集成。
14.  为不同类型的分支机构建立**持续集成策略。**正如我之前指出的，最严格的“不要破坏构建”规则适用于*发布*分支，而*主干*和*维护*分支有时可能会被破坏。*在主干/维护*和*发布*分支上运行的检查列表之间也存在差异。

您可以以图表的形式找到我的颠覆最佳实践的大纲，该[图表](http://scm.altern.kiev.ua/images/branches_naming_A3.en.jpg)说明了我使用的软件配置管理方法的主要原则。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-01-09T23:12:07.297

我发现非常有用的一件事是[svn:external](http://svnbook.red-bean.com/en/1.0/ch07s03.html)属性，这意味着您可以将其他存储库中的目录引用到您自己的存储库中。它提供了非常好的组织代码和数据的方法。一些例子是：

1.  如果您有一个单独的存储库来编码不同的模块/库，并在您正在使用的模块/库中引用。这意味着您可以为每个可执行文件拥有一个元存储库。如果它是一个仅使用几个模块的小型可执行文件，则无需检出整个树。这样做的一个效果是您可以获得每个模块的 SVN 修订号。
2.  将大型二进制数据（例如库的编译版本）添加到代码存储库通常被认为是一个坏习惯，但它确实很方便。如果您只是将您使用的所有库的所有版本添加到不同的存储库，您可以获得两全其美。您将使用的库版本引用到代码存储库中。检查代码存储库时，您还将获得代码和二进制文件。但是，二进制文件存储在一个大型存储库中，您不需要像源代码那样严格备份，并且源代码存储库保持较小且仅包含文本。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-01-06T18:24:18.557

使用与您的错误跟踪软件的集成。如果您使用[Bugzilla](http://en.wikipedia.org/wiki/Bugzilla)，您可以设置它，如果您的评论以“Bug XXXX”开头，您的 SVN 评论会自动添加为给定错误的评论，包括指向该修订版的 SVN Web 界面的链接。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-06T18:23:18.513

了解 SVN 的分支和合并工具和约定。

与其他团队成员合作的最佳方式是将工作分解为完整的开发功能/修复，然后在一个分支中进行单独的更改。然后在完成/准备好/批准合并时将更改合并回主线分支/主干。

通过这种方式，个人可以朝着一个共同的目标（在同一分支或单独的分支上）工作，而不会与其他更改发生冲突。

您的里程可能会有所不同，这对于两个左右的人来说可能是多余的。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-01-06T18:54:30.120

源代码控制的黄金法则：**尽早签入，经常签入**

有关如何组织存储库的提示：

*   *[您如何组织版本控制存储库？](https://stackoverflow.com/questions/222827/how-do-you-organize-your-version-control-repository)*
*   [SVN 书籍第 5 章。存储库管理](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.planning.html#svn.reposadmin.projects.chooselayout)
*   [存储库布局](http://blogs.open.collab.net/svn/2007/04/subversion_repo.html)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-01-06T21:21:52.333

除了分支政策等。（其中一种尺寸绝对不适合所有人），你应该有很好的提交：

*   如果可能，提交应与*单个*工作相关；一个错误修复，一个新功能——你提交的更改应该有一些“逻辑”
*   提交应该有一个描述性的注释，这将帮助您在浏览存储库历史时找到它。大多数人建议在开头写一个句子来描述整个提交，并在下面写一个更详细的说明
*   如果可能，您应该尽可能将提交绑定到您的错误跟踪系统。Trac，Redmine 等人。让您创建从错误到提交的链接，反之亦然，这非常方便。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-01-06T18:23:56.733

如果您使用与 SVN 良好集成的好工具，它会变得容易得多。这些使您可以轻松查看已更改的内容，然后提交全部或部分更改，并经常将您的工作副本更新到 SVN 中的最新版本。

我推荐[Tortoise SVN](http://tortoisesvn.net/)（如果你使用 Windows）和[Visual SVN](http://www.visualsvn.com/)（如果你使用 VS）。

另请查看是否可以设置它，以便在任何提交更改时收到电子邮件或类似通知（通常还包括提交消息和更改文件的列表）。像[CVSDude](http://cvsdude.com/)这样的服务提供了这一点。我发现在更新我的工作副本之前了解已经进行了更新以及了解该更新中包含的内容是很有帮助的。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-05-05T06:41:52.997

使用[SVN](http://en.wikipedia.org/wiki/Apache_Subversion)的最佳实践：

1.  当您第一次来到办公室并打开您的[Eclipse](http://en.wikipedia.org/wiki/Eclipse_%28software%29)项目时，必须完成的第一步是更新您的项目。

2.  更新后，开始你的工作。完成编码后，请检查它是否正确，您的应用程序是否正常运行，没有任何异常。一旦您确定您的代码工作正常，就该提交代码了。

注意：在提交代码时，不要直接提交。与服务器同步并检查所有需要提交的内容。注意：不要一次提交整个文件夹。因为您可能已经根据您的要求对文件进行了一些更改，或者您可能已经删除了本地系统中的一些文件。但是服务器上的设置不同。因此，单独检查文件并提交代码。

3.  不要直接提交/更新冲突文件。

4.  何时进行覆盖和更新？

    当您非常确定不需要任何本地更改并希望完全更新服务器副本时。请注意，一旦您进行覆盖和更新，您将不会获得任何本地更改。

    注意：不要让项目超过一天不更新。也不要保留代码而不提交很多天。

5.  交流谁都在同一个组件中工作，并讨论他们每天所做的更改。

6.  除非有某种原因，否则不要提交属性和配置文件。因为服务器和云中的设置会有所不同。

7.  不要将目标文件夹提交到 SVN，只需在 SVN 存储库中维护源代码和资源文件夹。

8.  当您丢失代码时，不要惊慌！您可以从 SVN 历史记录中取回较早的副本。

9.  不要将项目签出到磁盘的多个位置。在一个位置检查它并使用它。

* * *

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-06T18:48:38.820

我看到的减少提交失败的一件事是拥有良好的预提交脚本。例如，您可以在提交更改之前运行任何单元测试。这会导致提交速度有点慢，但您可以通过避免踩到某人的脚趾而不得不道歉来节省时间。当然，当您拥有庞大的开发团队和非常频繁的提交时，这将变得更加难以管理。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-01-12T17:29:46.100

与 bug-tracker 和提交策略强制执行集成的示例之一可能是[Trac](http://trac.edgewall.org/)的 svn pre/post-commit 钩子脚本，如果提交消息未引用 bug-tracker 中的任何票证并添加评论到现有基于消息内容的票证（即提交消息可能包含类似“修复#1、#2 和#8”的内容，其中#1、#2、#8 是票证编号）。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-01-06T18:23:21.633

在修复任何合并冲突之前，请咨询您的团队关于他们的更改，或者至少非常仔细地查看差异。要求他们自己检查合并后的代码，以确保他们的添加不会在合并中丢失。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-06T23:23:22.807

SVN 本身就是一个好的开始，其他一些海报就最佳实践提供了一些很好的建议。

我唯一要补充的是，您应该将 SVN 与 CruiseControl 或 TeamCity 连接起来，以推动持续集成过程。这将发送构建电子邮件并让每个人都知道何时有人破坏了构建。

很早就知道谁在遵循你的流程，谁没有。可能会导致一些摩擦，但从长远来看，您的团队会更好。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2012-01-11T15:53:52.030

*   每次提交的精确评论

*   不要破坏（主线）构建！

*   逻辑单元更改后立即提交

*   避免使用 Subversion 作为备份工具

*   尽可能多的分支/合并

.

更多细节可以在*[SVN 最佳实践](https://ducquoc.wordpress.com/2011/06/09/svn-best-practices/)*中找到。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-12-10T10:30:51.417

将此用于评论模板：

[任务/故事 xxx][次要/主要][评论][跟进评论][错误的 URL]

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-06-09T19:02:26.530

## DEV 是否在分支上工作

1.  频繁提交到您的分支
2.  离散/模块化提交到您的分支*（[请参见此处](http://sarah.thesharps.us/2013/05/08/patchsets-for-dinner/)）*
3.  经常更新/合并主干。不要在没有重新定位的情况下*坐在你的分支上*

## 社区干线

1.  应该始终构建/工作
2.  每次提交一个问题*（[再次参见此处](http://sarah.thesharps.us/2013/05/08/patchsets-for-dinner/)）*主要是这样您或其他人可以一次撤消一个问题
3.  **不要**将重构/空白更改与逻辑更改混为一谈。您的队友将很难从提交中提取您*实际所做的事情*

请记住，您的提交越是增量、模块化、离散和简洁，您（或可能其他人）就越容易：

*   逐步退出更改
*   无需筛选大量空白和变量名称更改，就可以直观地了解您的实际操作。
*   当完成的工作与消息长度的比率较低时，提交消息意味着更多。

# c - C makefile直接在iphone上编译OpenGL项目

> ID：417608
> 
> 赞同：1
> 
> 时间：2009-01-06T18:22:09.153
> 
> 标签：c, iphone, opengl, makefile

如果这个问题已经被问过，请指导我；我对尚未找到的主题进行了搜索。

我无法将一个生成文件放在一起，该文件将包含一个或多个 .c OpenGL 项目文件，使用 apple-arm-darwin9 和 OpenGL 框架直接在 iphone 上编译成对象（使用 bash）。出于某种原因，无论我使用框架或 LIBPATH 的任何组合，我都会经常看到抛出异常 - 如果有人能指出我正确的方向，我会顺利进行。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T13:52:43.753

太笼统了，两个不同的问题。

第一，找到正确编译代码的命令（或一系列命令）的问题。

二，编写一个 Makefile 来完成这项工作。

我会帮助你处理后者，但你必须先弄清楚前者（这与 Makefiles 完全无关）......

# asp.net - 寻找关于使用跟踪日志的简单解释

> ID：417611
> 
> 赞同：3
> 
> 时间：2009-01-06T18:22:56.267
> 
> 标签：asp.net, logging, trace

我见过几个使用 Trace 功能来捕获事件并将它们流式传输到日志文件的项目。我一直未能找到一个简单易懂的指南，该指南将向我展示如何配置 Trace 以捕获和写入所述日志文件。有没有人有链接推荐，或者提供一些简单的步骤来遵循？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T19:40:18.637

该`Trace`对象将语句写入任何附加的`TraceListeners`. 您可以构建自己的，但`System.Diagnostics`命名空间中已经定义了一个数字，包括：

*   ConsoleTraceListener（控制台）
*   DefaultTraceListener (Visual Studio / 调试器)
*   DelimitedListTraceListener（TextWriter，特殊格式）
*   EventLogTraceListener（EventLog - 从 System.Diagnostics.EventLog 继承的任何东西）
*   TextWriterTraceListener (TextWriter - 思考文件)

当然，您可以从`TraceListener`写入您想要的任何位置的类继承您自己的。例如，您可以登录到数据库，让它在某些情况下发送电子邮件或页面，或者将语句写回日志平台，如 log4net。

最重要的是，您需要创建所需的任何侦听器的实例，然后将它们添加到 Trace 的类侦听器集合中。您可以根据需要添加任意数量，Trace 将写入所有这些内容。这样，您可以使用作为框架一部分的受良好支持和理解的对象编写一次日志记录代码，并且可以将任何需要的内容附加到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T20:50:35.237

我偶然发现了一篇真正有帮助的[MSDN 文章。](http://msdn.microsoft.com/en-us/library/ms972204.aspx)抱歉，我在发布问题之前没有找到它，但也许其他人可能有同样的问题并且没有找到这个链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T18:43:29.890

看看日志框架。[我们推出了自己的，但现在正在迁移到http://logging.apache.org/log4net/](http://logging.apache.org/log4net/)免费提供的 log4net

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-30T16:32:17.637

我正在寻找一种方法来设置 EventLog 的类别，FormattedEventLogTraceListener 写入（不是消息的类别）。

但我找不到这个类的合适属性。

可以设置这个吗？

# visual-studio - 在 VB 中键入时，如何使智能感知上的 Enter 键与 Visual Studio 中的 C# 中的反应方式相同？

> ID：417625
> 
> 赞同：8
> 
> 时间：2009-01-06T18:25:51.080
> 
> 标签：visual-studio, intellisense

我使用的是 Visual Studio 2008，我习惯了 C#，当 Intellisense 弹出时，我通过按 Enter 选择我想要的内容，它不会跳到下一行。在 VB 中，当我在智能感知上按回车键时，我跳到下一行。有谁知道这个智能感知选项的设置可能在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T18:45:00.560

在 VB 中按空格键或 TAB 键与在 C# 中按 ENTER 所做的相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T18:34:46.897

我知道这并不能真正回答您的问题，但智能感知的设计目的是让您只需按下“下一个”字符即可选择突出显示的项目（例如左括号、句号、分号等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-09T22:27:25.110

我也被 VB 中的这种行为所困扰。这将在下一版本的 Visual Studio 中修复，并使用新的输入键行为设置。 ~~[https://github.com/dotnet/roslyn/pull/11873](https://github.com/dotnet/roslyn/pull/11873)~~ 更正链接：[https ://github.com/dotnet/roslyn/pull/11769](https://github.com/dotnet/roslyn/pull/11769)

# wcf - 以 RESTful 方式从 WCF 服务返回错误的最佳方法是什么？

> ID：417632
> 
> 赞同：36
> 
> 时间：2009-01-06T18:28:28.267
> 
> 标签：wcf, web-services, error-handling, rest

以 RESTful 方式使用 WCF 似乎很棒。我是大枪的忠实粉丝，比如简单性和灵活性，但我也喜欢 Urls 最终的外观。我能说什么，我是程序员。

用于检索和编辑资源的简单 API 与一组几乎同样简单的可能错误响应相匹配，我不禁感到，要保持“纯” RESTful 方法，我可能会当面不屑一顾，或者更具体地说，是我的网络服务消费者的鼻子。我可能是错的，但我可以使用的 Http 错误代码似乎并不多，也没有办法传回自定义错误消息。

为了澄清，我说的是适当的异常错误，而不是预期的错误。我想将问题实际传达给用户，以帮助他们确定需要做些什么来纠正它。

我正在考虑的可能选项...

1.  **只需使用 Http 错误代码**- 这似乎对我能够表达的内容过于严格，并且不允许我提供自定义消息。如果我错了，请（！）纠正我。

2.  **总是返回 Http Success 但返回自定义错误对象**——显然是最灵活的，但肯定不是最 RESTful 的。

如果有人能分享这个特定问题的一些真实世界经验，我将不胜感激。

* * *

### 更新

感谢使用对象`StatusDescription`属性的建议`OutgoingWebResponseContext`。起初它似乎是我可以使用的东西。

我得出的结论是，我上面的第二个选择不适合我。我想坚持 Http 能给我的东西。

但是，我在让它工作时遇到问题。无论我为此属性提供什么值，它都不会在响应中返回。

我的服务方法看起来像这样

```
public MyType GetMyTypes(string criteria)
{
    try
    {
        return GetMyTypes();
    }
    catch (Exception ex)
    {
        OutgoingWebResponseContext response = WebOperationContext.Current.OutgoingResponse;
        response.StatusCode = HttpStatusCode.Forbidden;
        response.StatusDescription = "A Big fat error occurred";
        return null;
    }
} 
```

这是原始响应消息。没有提到自定义消息...

> HTTP/1.1 403 禁止
> 服务器：ASP.NET 开发服务器/9.0.0.0
> 日期：2009 年 1 月 7 日星期三 14:01:20 GMT
> X-AspNet 版本：2.0.50727
> 缓存控制：私有
> 内容长度：0
> 连接：关闭

好像我不需要访问客户端上的正确属性。信息根本没有通过链接发送。

这个`StatusDescription`属性实际上是做什么的？

* * *

### 更新

我从来没有发现如何设置 StatusDescription 属性。我最终根本没有包含任何错误消息，并且只使用了 Http 状态代码。我选择为我的服务公开 Soap 和 Restful 端点，因此客户端可以选择他们更喜欢使用的端点——简单的 Restful 消息或相对丰富的 Soap 消息。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2011-12-30T19:10:20.887

使用 .net 4，抛出一个[`WebFaultException<T>`](http://msdn.microsoft.com/en-us/library/dd989924(v=vs.110).aspx)`(T errorDetail,` [`HttpResponseCode`](http://msdn.microsoft.com/en-us/library/system.net.httpstatuscode(v=vs.110).aspx)`code)`

在这里，您将您的响应类型设置为另一个对象类型，这很有意义，并且您还设置了`ResponseCode`您想要的。

`errorDetail`必须是可序列化的

[http://blogs.msdn.com/b/endpoint/archive/2010/01/21/error-handling-in-wcf-webhttp-services-with-webfaultexception.aspx](http://blogs.msdn.com/b/endpoint/archive/2010/01/21/error-handling-in-wcf-webhttp-services-with-webfaultexception.aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-06T18:31:30.493

发送正确的响应代码，您可以在响应正文中提供自定义错误消息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-16T17:42:43.660

我在上面（在状态描述中）和我的 REST 服务的返回页面的正文中添加了错误代码：

```
OutgoingWebResponseContext response = WebOperationContext.Current.OutgoingResponse;
response.StatusCode = HttpStatusCode.Unauthorized;
response.StatusDescription = "You are not authorized.";
HttpContext.Current.Response.Write("You are not authorized.");
return null; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T18:42:18.553

有关类似问题，请参阅[此线程。](https://stackoverflow.com/questions/140104/how-can-i-return-a-custom-http-status-code-from-a-wcf-rest-method)

简而言之，我相信您可以设置 HTTP 状态代码（为错误代码之一），并在[StatusDescription](http://msdn.microsoft.com/en-us/library/system.servicemodel.web.outgoingwebresponsecontext.statusdescription.aspx)属性中提供您的自定义消息：

```
OutgoingWebResponseContext response = WebOperationContext.Current.OutgoingResponse;
response.StatusCode = System.Net.HttpStatusCode.Forbidden;
response.StatusDescription = "Custom"; 
```

不幸的是，我不太了解这种技术在现实世界中的流行程度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-11T18:41:23.187

这可能是一个缺陷。截至 2011 年 9 月 22 日，产品团队正在审查该问题：

[http://connect.microsoft.com/VisualStudio/feedback/details/690162/wcf-rest-custom-outgoingwebresponsecontext-statusdescription-not-returned-in-response](http://connect.microsoft.com/VisualStudio/feedback/details/690162/wcf-rest-custom-outgoingwebresponsecontext-statusdescription-not-returned-in-response)

# c# - FxCop 警告 CA1006 有什么好的解决方法吗？

> ID：417634
> 
> 赞同：25
> 
> 时间：2009-01-06T18:29:06.847
> 
> 标签：c#, .net, fxcop

我遇到了[FxCop 警告 CA1006](http://msdn.microsoft.com/en-us/library/ms182144.aspx "FxCop 警告 CA1006")、Microsoft.Design “DoNotNestGenericTypesInMemberSignatures”的问题。具体来说，我正在设计一个`ReportCollection<T>`继承自 的类，`ReadOnlyCollection<Report<T>>`其`public`构造函数以 a`IList<Report<T>>`作为参数。

修复此警告的建议不是很有用：

> “要修复违反此规则的行为，请更改设计以删除嵌套类型参数。” 到目前为止，我可以看到有两种方法可以按照建议更改设计：

1.  制作构造函数`internal`。这在我的情况下不起作用。构造函数必须是`public`因为这个集合类需要被程序集外部的代码实例化。
2.  使构造函数采用 a`Report<T>[]`而不是`IList<Report<T>>`. 这是次优的，因为外部代码应该具有使用动态大小的数据结构`List<T>`而不是固定大小的数组的灵活性。

在这一点上，我已经放弃并压制了这个警告。有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-06T18:55:48.463

我会接受 FxCop 的警告，就好像它们是来自一位非常固执的同事的建议。忽略（抑制）它暗示的一些事情是完全可以的。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-11-23T04:09:16.103

我同意，忽略此规则的另一个好时机是当您需要说：

```
Func<IEnumerable<T>> 
```

当然你可以使用非泛型的 IEnumerable，但是任何类型都可以使用，只要它实现了 IEnumerable（非泛型）。泛型的目的（部分）是将允许的类型限制为给定的一组类型。

我认为这个规则非常愚蠢。仅当您嵌套了多个泛型类型时才需要它。一层嵌套非常安全。

顺便说一句，我认为很多 LINQ 函数也嵌套了泛型类型，所以如果 MS 这样做，我们也可以:)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-10-14T11:45:52.940

我同意您可以在以下情况下忽略 CA1006 警告

```
Func<IEnumerable<T>> 
```

您还可以通过使用委托来简化代码并避免使用 CA1006：

```
public delegate IEnumerable<T> ChildrenDel<T>( T parent);

// was: GetDescendants<T>( this T item, Func< T, IEnumerable< T > > children )

public static IEnumerable< T > GetDescendants<T>( this T item, ChildrenDel<T> children )
{
    var stack = new Stack< T >();
    do {
        children( item ).ForEach( stack.Push );

        if( stack.Count == 0 )
            break;

        item = stack.Pop();

        yield return item;
    } while( true );
} 
```

# sql - XML 和 Sql Server 2005

> ID：417639
> 
> 赞同：1
> 
> 时间：2009-01-06T18:30:49.107
> 
> 标签：sql, sql-server, xml, sql-server-2005, xsd

我有一个问题，我想以最好的方式解决。问题是我制作了一个看起来像这样的模式：

打印（”

```
<xs:complexType name="rentACarT">
    <xs:sequence>
        <xs:element name="poslovnice" type="poslovniceT" />
        <xs:element name="korisnici" type="korisniciT" />
    </xs:sequence>
</xs:complexType>

<xs:complexType name="poslovniceT">
    <xs:sequence>
        <xs:element name="poslovnica" type="poslovnicaT" minOccurs="0" maxOccurs="unbounded" />
    </xs:sequence>
</xs:complexType>

<xs:complexType name="poslovnicaT">
    <xs:sequence>
        <xs:element name="naziv" type="xs:string" />
        <xs:element name="adresa" type="adresaT" />
        <xs:element name="grad" type="gradT" />
        <xs:element name="vozila" type="vozilaT" />
        <xs:element name="zaposlenici" type="zaposleniciT" />
        <xs:element name="posudbe" type="posudbeT" />
    </xs:sequence>
    <xs:attribute name="id" type="xs:int" />
</xs:complexType>

<xs:complexType name="vozilaT">
    <xs:sequence>
        <xs:element name="vozilo" type="voziloT" minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
</xs:complexType>

<xs:complexType name="zaposleniciT">
    <xs:sequence>
        <xs:element name="zaposlenik" type="zaposlenikT" minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
</xs:complexType>

<xs:complexType name="korisniciT">
    <xs:sequence>
        <xs:element name="korisnik" type="korisnikT" minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
</xs:complexType>

<xs:complexType name="posudbeT">
    <xs:sequence>
        <xs:element name="posudba" type="posudbaT" minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
</xs:complexType>

<xs:complexType name="posudbaT">
    <xs:sequence>
        <xs:element name="idVozila" type="xs:int" />
        <xs:element name="jmbgZaposlenika" type="jmbgT" />
        <xs:element name="jmbgKorisnika" type="jmbgT" />
        <xs:element name="datumPosudbe" type="xs:date" />
        <xs:element name="ugovoreniDatumPovratka" type="xs:date" />
        <xs:element name="stvarniDatumPovratka" type="xs:date" />
    </xs:sequence>
    <xs:attribute name="id" type="xs:integer" />
</xs:complexType>

<xs:complexType name="voziloT">
    <xs:sequence>
        <xs:element name="registracija" type="xs:string" />
        <xs:element name="modelVozila" type="modelVozilaT" />
        <xs:element name="godinaProizvodnje" type="godinaT" />
        <xs:element name="cijenaPosudbePoDanu" type="xs:double" />
    </xs:sequence>
    <xs:attribute name="id" type="xs:int" />
</xs:complexType>

<xs:complexType name="zaposlenikT">
    <xs:sequence>
        <xs:element name="ime" type="xs:string" />
        <xs:element name="prezime" type="xs:string" />
        <xs:element name="spol" type="spolT" />
        <xs:element name="datumZaposlenja" type="xs:date" />
        <xs:element name="grad" type="xs:double" />
    </xs:sequence>
    <xs:attribute name="jmbg" type="jmbgT" />
</xs:complexType>

<xs:complexType name="korisnikT">
    <xs:sequence>
        <xs:element name="ime" type="xs:string" />
        <xs:element name="prezime" type="xs:string" />
        <xs:element name="spol" type="spolT" />
        <xs:element name="adresa" type="adresaT" />
        <xs:element name="grad" type="gradT" />
        <xs:element name="status" type="statusKorisnikaT" />
    </xs:sequence>
    <xs:attribute name="jmbg" type="jmbgT" />
</xs:complexType>

<xs:complexType name="modelVozilaT">
    <xs:sequence>
        <xs:element name="tipVozila" type="tipVozilaT" />
        <xs:element name="marka" type="xs:string" />
        <xs:element name="model" type="xs:string" />
    </xs:sequence>
</xs:complexType>

<xs:simpleType name="tipVozilaT">
    <xs:restriction base="xs:string">
        <xs:enumeration value="auto" />
        <xs:enumeration value="kombi" />
        <xs:enumeration value="kamion" />
        <xs:enumeration value="limuzina" />
    </xs:restriction>
</xs:simpleType>

<xs:simpleType name="godinaT">
    <xs:restriction base="xs:int">
        <xs:minInclusive value="1980" />
        <xs:maxInclusive value="2050" />
    </xs:restriction>
</xs:simpleType>

<xs:simpleType name="jmbgT">
    <xs:restriction base="xs:string">
        <xs:pattern value="([0-9]){13}" />
    </xs:restriction>
</xs:simpleType>

<xs:simpleType name="spolT">
    <xs:restriction base="xs:string">
        <xs:enumeration value="m" />
        <xs:enumeration value="f" />
    </xs:restriction>
</xs:simpleType>

<xs:simpleType name="statusKorisnikaT">
    <xs:restriction base="xs:string">
        <xs:enumeration value="stalni" />
        <xs:enumeration value="novi" />
    </xs:restriction>
</xs:simpleType>

<xs:complexType name="gradT">
    <xs:sequence>
        <xs:element name="postanskiBroj" type="xs:int" />
        <xs:element name="naziv" type="xs:string" />
    </xs:sequence>
</xs:complexType>

<xs:complexType name="adresaT">
    <xs:sequence>
        <xs:element name="ulica" type="xs:string" />
        <xs:element name="kucniBroj" type="xs:int" />
    </xs:sequence>
</xs:complexType> 
```

");

现在，我不想将整个 xml 文档放在一行中。至少我觉得不好。我想将“poslovnice”（包含多个“poslovnica”）移到一个表中，将“vozila”移到另一个表中……最好将每个“poslovnica”放在 Poslovnica 表中的一行中还是让所有元素“poslovnica”在一排？既然SQL Server不支持唯一的xml数据类型，那么唯一性呢，我看到你可以使用触发器和函数，还有其他方法吗？另外，如果我破坏了xml文档，并且在一个表中有poslovnice而在另一个表中有vozila，如何实现显示vozilo属于poslovnica，我应该在xml中的每个vozilo中放置poslovnica的id还是应该在SQL中引用行服务器？

或者你会推荐其他一些数据库吗？

非常感谢，如果我不够清楚，我很抱歉:(！

米罗斯拉夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T09:57:09.283

那么首先你必须问自己为什么要在数据库中以 XML 格式存储它？这似乎是一个完美的场景，拥有 Poslovnica、Vozilo 和 Zaposlenik 表，并拥有包含哪些员工在哪里租用什么车的信息的中间表。

我根本没有理由将其存储在 xml 中。

# javascript - 如何在 JavaScript 中通过名称将变量作为字符串进行寻址？

> ID：417645
> 
> 赞同：29
> 
> 时间：2009-01-06T18:33:51.267
> 
> 标签：javascript

有没有办法在javascript中将变量名转换为字符串？更具体：

```
var a = 1, b = 2, c = 'hello';
var array = [a, b, c]; 
```

现在，当我遍历数组时，我需要将变量名（而不是它们的值）作为字符串获取 - 这将是“a”或“b”或“c”。我真的需要它是一个字符串，所以它是可写的。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-06T18:36:24.353

使用 Javascript 对象文字：

```
var obj = {
    a: 1,
    b: 2,
    c: 'hello'
}; 
```

然后你可以像这样遍历它：

```
for (var key in obj){
    console.log(key, obj[key]);
} 
```

并像这样访问对象的属性：

```
console.log(obj.a, obj.c); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T18:39:43.520

你可以做的是这样的：

```
var hash = {};
hash.a = 1;
hash.b = 2;
hash.c = 'hello';
for(key in hash) {
    // key would be 'a' and hash[key] would be 1, and so on.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T09:15:45.177

离开三联画的东西（谢谢）......

```
(function(){
    (createSingleton = function(name){  // global
        this[name] = (function(params){
            for(var i in params){
                this[i] = params[i];
                console.log('params[i]: ' + i + ' = ' + params[i]);
            }
            return this;
        })({key: 'val', name: 'param'});
    })('singleton');
    console.log(singleton.key);
})(); 
```

只是认为这是一个很好的小自主模式......希望它有所帮助！谢谢三联画！

# c# - 跟踪使用过的应用程序

> ID：417648
> 
> 赞同：2
> 
> 时间：2009-01-06T18:34:34.217
> 
> 标签：c#, java, process, monitoring, task-tracking

我最近一直在使用[Wakoopa](http://wakoopa.com)，我觉得它很有趣。

我不知道（我有一个想法，但从来没有得到关于它的真实数据）关于我在 SO 上花了多少时间，直到这个：

[替代文字 http://img396.imageshack.us/img396/4699/wakoopaim1.png](http://img396.imageshack.us/img396/4699/wakoopaim1.png)

所以我的编程问题是：

> *如何以编程方式跟踪正在使用的应用程序？*

我最初的想法是使用“tasklist”命令和“netstat”之类的东西，每 15 分钟使用一次池或类似的东西，但我认为这不是他们这样做的方式。

.NET 中是否有一个库（我猜是 C# 中的）来执行此操作？Windows 是否提供这样的某种服务？爪哇呢？

对于如何执行某些编程任务，我通常至少有一些模糊的想法，但对此我一无所知。

wakoopa 应用程序跟踪器也适用于 OSX 和 Linux，但我很清楚它们是三个不同的应用程序，每个平台一个

顺便说一句，你用了多少 SO？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T19:15:15.100

这是一篇文章的链接，其中包含 Process Structure Routines API [Detecting Windows NT/2K process execution](http://www.codeproject.com/KB/threads/procmon.aspx)的来源。我认为 SysInternals 站点有 Process Monitor 的源，但我没有看到任何源。本文应该为您指明 Windows 系统的正确方向。

这是一个可能对 Linux 系统[PROCPS有帮助的链接](http://procps.sourceforge.net/)

这是 java swing top 实用程序[Monitor](http://www.cc.gatech.edu/~yannis/j-orchestra/example_proc_mon.html)的链接它使用 JNI，所以不确定它是否真的适合作为 java 解决方案。

为了回答 SO 问题，我只定期访问该站点。如果我经常访问，我发现我在上面花费了太多时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T19:16:05.893

熟悉 Visual Studio 中的[服务器资源管理器](http://msdn.microsoft.com/en-us/library/cd2cz7yy(VS.71).aspx)——在“进程”下查看。然后阅读[PerformanceCounter](http://msdn.microsoft.com/en-us/library/system.diagnostics.performancecounter.aspx)类。

# biztalk - 将 BizTalk 2006 数据库从 SQL 2000 迁移到 SQL 2005

> ID：417656
> 
> 赞同：0
> 
> 时间：2009-01-06T18:37:38.873
> 
> 标签：biztalk, biztalk-2006

有人有将 BizTalk 2006 服务器从 SQL 2000 服务器迁移到 SQL 2005 服务器的经验吗？我知道就数据库的内容而言，没有任何变化 - 视图、存储的过程等都保持不变。必须迁移计划的作业。除了所有这些......提示，技巧等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-09T08:37:03.827

我将从BizTalk 文档中的“[移动 BizTalk Server 数据库”开始](http://msdn.microsoft.com/en-us/library/aa559835.aspx)

# vb.net - VB.NET 中的井号 (#)

> ID：417657
> 
> 赞同：2
> 
> 时间：2009-01-06T18:38:26.393
> 
> 标签：vb.net

我有这个我正在使用的遗留代码，并且到处都有这样的代码：

```
    #If PRE611 = True 那么
        '做点什么
    ＃别的
        '别的东西
    ＃万一

```

我很确定 PRE611 与版本控制有关，但我想知道 # 符号的具体作用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-06T18:42:44.260

这些是指令，允许您进行条件编译。# 用于指令的符号。

在这种情况下，它将根据“PRE611 = True”的评估编译代码的任何一部分

你可以看到这篇文章的一些例子：http: [//visualbasic.about.com/od/usingvbnet/a/vbdirectives01_2.htm](http://visualbasic.about.com/od/usingvbnet/a/vbdirectives01_2.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T18:43:43.713

这是一个[预处理器指令](http://msdn.microsoft.com/en-us/library/aa691099.aspx)。

它本质上意味着 if`PRE611`被定义为 true（在预处理器中）以编译随后的任何内容。

# tomcat - 如何配置 Tomcat 以提供来自 webapps 外部文件夹的图像？

> ID：417658
> 
> 赞同：72
> 
> 时间：2009-01-06T18:39:02.210
> 
> 标签：tomcat

如何使用 Tomcat 从 webapps 外部的公共文件夹中提供图像文件？我不想在不同的端口上使用第二个 Apache 文件服务器，因为图像文件是同一个应用程序的一部分。而且我不想创建指向 webapps 内公共文件夹的符号链接，因为我的应用程序被部署为一个 war 文件......

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2014-04-07T15:54:16.107

我就是这样做的，对我来说效果很好。*（在 Tomcat 7.x 上完成）*

`<context>`在`tomcat/conf/server.xml`文件中添加一个。

窗口示例：

```
<Context docBase="c:\Documents and Settings\The User\images" path="/project/images" /> 
```

Linux 示例：

```
<Context docBase="/var/project/images" path="/project/images" /> 
```

像这样（在上下文中）：

```
<Server port="8025" shutdown="SHUTDOWN">
 ...
  <Service name="Catalina">
    ...
    <Engine defaultHost="localhost" name="Catalina">
     ...
     <Host appBase="webapps"
      autoDeploy="false" name="localhost" unpackWARs="true"
      xmlNamespaceAware="false" xmlValidation="false">
      ...
      <!--MAGIC LINE GOES HERE-->
       <Context  docBase="/var/project/images" path="/project/images" />

      </Host>
    </Engine>
  </Service>
</Server> 
```

这样，您应该能够在以下位置找到文件（例如`/var/project/images/NameOfImage.jpg`）：

```
http://localhost:8080/project/images/NameOfImage.jpg 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-01-06T18:51:42.527

你可以有一个重定向 servlet。在您的 web.xml 中，您将拥有：

```
<servlet>
    <servlet-name>images</servlet-name>
    <servlet-class>com.example.images.ImageServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>images</servlet-name>
    <url-pattern>/images/*</url-pattern>
</servlet-mapping> 
```

您所有的图像都将在“/images”中，这将被 servlet 拦截。然后它会读入任何文件夹中的相关文件并立即将其送回。例如，假设您的图像文件夹中有一个 gif，c:\Server_Images\smilie.gif。在网页中将是`<img src="http:/example.com/app/images/smilie.gif"...`. 在 servlet 中， [`HttpServletRequest.getPathInfo()`](http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpServletRequest.html#getPathInfo())将产生“/smilie.gif”。servlet 将在文件夹中找到哪个。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-10-01T11:05:27.807

在 Tomcat 7 中，您可以使用“别名”属性。从[文档](http://tomcat.apache.org/tomcat-7.0-doc/config/context.html)：

> 该属性提供了一个外部位置列表，可以从中加载该上下文的资源。别名列表的格式应为“/aliasPath1=docBase1,/aliasPath2=docBase2”，其中 aliasPathN 必须包含前导“/”，而 docBaseN 必须是 .war 文件或目录的绝对路径。将在第一个 docBaseN 中搜索 aliasPathN 是资源的前导路径段的资源。如果没有这样的别名，则将以通常的方式搜索资源。如果上下文未部署，这些外部位置将不会被清空。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-03-15T13:04:05.733

您可以将图像文件夹部署为单独的 web 应用程序，并将该文件夹的位置定义为文件系统中的任何位置。

在引擎名可能是“Catalina”且主机名可能是“localhost”的目录中的 XML 文件中创建一个*Context*元素。`$CATALINA_HOME/conf/[enginename]/[hostname]/`

根据您希望从中查看图像的路径 URL 命名文件，因此如果您的 web 应用程序具有路径“博客”，您可以命名 XML 文件`blog#images.xml`，以便您的图像在以下位置可见`example.com/blog/images/`

XML 文件的内容应该是`<Context docBase="/filesystem/path/to/images"/>`

注意不要取消部署这个 web 应用程序，因为这可能会删除你所有的图像！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-06T19:04:23.577

不要将 Tomcat 配置为重定向请求，而是将 Apache 用作带有[Apache Tomcat 连接器](http://www.howtoforge.com/apache2_tomcat5_mod_jk)的前端，这样 Apache 只提供静态内容，同时向 tomcat 请求动态内容。

使用 JKmount 指令（或其他指令），您可以准确指定将哪些请求发送到 Tomcat。

对静态内容（例如图像）的请求将由 Apache 使用标准虚拟主机配置直接提供服务，而在 JKMount 指令中定义的其他请求将发送给 Tomcat 工作人员。

我认为这个实现会给你最大的灵活性和对整个应用程序的控制。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-15T07:49:51.503

在基于定义 XML 的解决方案都不适合我之后，我发现[这个答案](https://stackoverflow.com/a/1467780/437019)非常有帮助。花了大约一分钟，还有一个小的代码更改：我修改了这一行

`this.basePath = getServletContext().getRealPath(getInitParameter("basePath"));`

进入

`this.basePath = getInitParameter("basePath");`

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-08-26T12:27:39.740

许多年后，我们可以在我们的`webapp-servlet.xml`文件中使用 Spring Web MVC 执行以下操作：

```
<mvc:resources mapping="/static/**" location="/static/" /> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2017-05-21T08:57:31.457

这非常简单直接地从外部 webapps 文件夹中的 tomcat 中提供静态内容。

只需如下编辑 $CATALINA_HOME/config/server.xml 下的 server.xml 并重新启动 tomcat。

```
<Host name="localhost"  appBase="webapps"
            unpackWARs="true" autoDeploy="true">

        **<Context docBase="C:\Ankur\testFiles"  path="/companyLogo" />**

       <Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"
               prefix="localhost_access_log" suffix=".txt"
               pattern="%h %l %u %t &quot;%r&quot; %s %b" />

</Host> 
```

使用两个属性 docBase 和 path 在宿主元素中添加上下文元素。

**1) docBase：**表示硬盘目录 **2) path：**表示您要在其上提供静态内容的 uri。

例如：如果您在 C:\Ankur\testFiles 目录中有 7.png，那么您可以访问 7.png 文件，如下所示：

[http://localhost:8081/companyLogo/7.png](http://localhost:8081/companyLogo/7.png)

有关更多详细信息，请查看[博客](http://ankurjain26.blogspot.com/2017/05/serve-static-resources-from-external.html)

# python - 如何在 Python 2.6 中使用数值 Python

> ID：417664
> 
> 赞同：2
> 
> 时间：2009-01-06T18:41:29.257
> 
> 标签：python, windows, numpy

我被迫升级到 Python 2.6，并且在 Windows 中使用带有 Python 2.6 的Numerical Python ( [NumPy ) 时遇到问题。](http://en.wikipedia.org/wiki/NumPy)我收到以下错误...

```
Traceback (most recent call last):
  File "<pyshell#0>", line 1, in <module>
    from numpy.core.numeric import array,dot,all
  File "C:\svn\svn_urbansim\UrbanSimDev\Builds\working\urbansim\Tools\Python26\lib\site-packages\numpy\__init__.py", line 39, in <module>
    import core
  File "C:\svn\svn_urbansim\UrbanSimDev\Builds\working\urbansim\Tools\Python26\lib\site-packages\numpy\core\__init__.py", line 5, in <module>
    import multiarray
ImportError: Module use of python25.dll conflicts with this version of Python. 
```

现有模块似乎正在尝试使用该`python25.dll`文件。有什么办法可以告诉它在`python26.dll`不修改源代码的情况下使用该文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-06T18:45:16.363

你是怎么安装的？NumPy 目前没有 Python 2.6 二进制文件。

如果你有[LAPACK](http://en.wikipedia.org/wiki/LAPACK) / [ATLAS](http://en.wikipedia.org/wiki/Automatically_Tuned_Linear_Algebra_Software) / [BLAS](http://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms)等和一个开发环境，你应该能够从源代码编译 numpy。否则，如果您需要 NumPy，我认为您将无法在 Windows 上使用 Python 2.5。

NumPy 的下一个版本应该有一个 2.6 的二进制文件，并且很可能在下个月左右发布。

[编辑]：似乎 pygame 开发人员在 Windows 上为 Python 2.6 创建了 NumPy 1.2.1 二进制文件，可[在此处](http://www.mail-archive.com/numpy-discussion@scipy.org/msg14552.html)获得。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T04:23:14.003

[NumPy 1.3.0 现在可用于 Python 2.6](http://sourceforge.net/project/downloading.php?group_id=1369&filename=numpy-1.3.0-win32-superpack-python2.6.exe&a=35708818)。

# apache-flex - 使用 Flex 在后台加载图像

> ID：417665
> 
> 赞同：2
> 
> 时间：2009-01-06T18:41:40.457
> 
> 标签：apache-flex, actionscript-3

在我的 Flex 应用程序中，我调用了一个 Web 服务，它返回几十个“项目”，其中每个项目都有一个关联的图像 url。我根据这些数据创建了一个模型，并将图像组件源属性绑定到 url 字符串。

我想更好地控制这些图像的加载，尤其是它们的加载顺序。我还想预加载不一定绑定到组件的图像。本质上，我想加载用户将首先看到的图像，然后在背景中加载他们稍后可能会看到的图像。

Flex 中是否有一种机制可以用来在后台加载图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T20:37:36.197

将文件放入队列中并一个接一个地加载它们。Flex（框架）不会为您执行此操作，但您可以相对轻松地在 AS3 中编写自己的代码。

我个人为此使用自己的解决方案，但也有很多可用的现有解决方案；最常见的可能是[Bulk Loader](http://code.google.com/p/bulk-loader/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T23:04:53.110

我创建了一种机制来从 XML 文件中读取 URL 列表并在后台或按需加载它们（以先到者为准）。预加载只是加载图像并且对它没有任何作用；它依赖于浏览器缓存来保存该图像，直到 UI 执行“加载”并立即返回它。

GalleryImageItem.status 更多的是用于调试。UI 对预加载器一无所知（也不必与之协调）。

干杯

```
 private var BackgroundLoaderIndex : int = -1;
         private var BackgroundImageLoader : Loader = null;         

         private var GalleryCanvasIndex : int = -1;          
         private var BackgroundGalleryLoadTimer : Timer;

         [ArrayElementType("GalleryImageItem")]
         private var GalleryImageArray : Array =  new Array();

        private function Initialize(event : Event) : void
        {   
            LoadGalleryImageArray();            

            BackgroundGalleryLoadTimer = new Timer(4000);
            BackgroundGalleryLoadTimer.addEventListener(TimerEvent.TIMER, BackgroundGalleryLoad);
            BackgroundGalleryLoadTimer.start();
        }

        private function LoadGalleryImageArray() : void
        {           
            var Galleries : XMLList = PageTextsXML.elements("Gallery").elements("GalleryImage");        

            for (var counter : int = 0; counter 
```

 `* * *` 

```
 package com.santacruzsoftware.lib
    {
        public class GalleryImageItem extends Object
        {
            public static const UNLOADED : int = 1; 
            public static const PRELOADING : int = 2; 
            public static const PRELOADED : int = 3; 
            public static const PRELOAD_FAILED : int = 4; 
            public static const LOADING : int = 5; 
            public static const LOADED : int = 6; 
            public static const LOAD_FAILED : int = 7; 

            private var _resourceName : String;
            private var _detailResourceName : String;
            private var _caption : String;
            private var _status : int;

            public function GalleryImageItem(aResourceName : String = "", aCaption : String = "", aDetail : String = "")
            {
                super();

                _resourceName = aResourceName;
                _caption = aCaption;
                _detailResourceName = aDetail;
                _status = UNLOADED;
            }

            public function get detailResourceName() : String{ return _detailResourceName }
            public function set detailResourceName(value : String) : void { _detailResourceName = value }
            public function get resourceName() : String{ return _resourceName }
            public function set resourceName(value : String) : void { _resourceName = value }
            public function get caption() : String{ return _caption }
            public function set caption(value : String) : void { _caption = value }
            public function get status() : int { return _status }
            public function set status(value : int) : void { _status = value }
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T20:00:59.157

据我所知，没有开箱即用的机制，不，但是您始终可以使用 URLLoader 以某种方式将图像加载到 Timer 上，以检索和存储每个图像的字节，直到您需要他们。根据模型的设置方式（例如，您可以将每个图像作为 ByteArray 存储在 ArrayCollection 中），这应该是一件相对简单的事情。这有帮助吗？

# c# - 为什么使用 tocap() 函数时只有第一个单词大写？

> ID：417677
> 
> 赞同：1
> 
> 时间：2009-01-06T18:46:03.257
> 
> 标签：c#, string

我对每个单词中的第一个字母进行了以下操作，但它仅适用于第一个单词。有人可以解释为什么吗？

```
static void Main(string[] args)
{
    string s = "how u doin the dnt know about medri sho min shan ma baref shu";
    string a = tocap(s);
    Console.WriteLine(a);
}

public static string tocap(string s)
{    
    if (s.Length == 1) return s.ToUpper();
    string s1;
    string s2;

    s1 = s.Substring(0, 1).ToUpper();
    s2 = s.Substring(1).ToLower();

    return s1+s2;
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-06T18:50:07.897

由于没有教授会接受这个解决方案，我觉得让任何在谷歌上搜索的人都知道你可以使用[ToTitleCase](http://msdn.microsoft.com/en-us/library/system.globalization.textinfo.totitlecase.aspx)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-06T19:02:45.453

如果您真正了解自己在做什么，我想您会做得更好：

```
 public static string tocap(string s)
    {

        // This says: "if s length is 1 then returned converted in upper case" 
        // for instance if s = "a" it will return "A". So far the function is ok.
        if (s.Length == 1) return s.ToUpper();

        string s1;
        string s2;

        // This says: "from my string I want the FIRST letter converted to upper case"
        // So from an input like s = "oscar" you're doing this s1 = "O"
        s1 = s.Substring(0, 1).ToUpper();

        // finally here you're saying: "for the rest just give it to me all lower case"
        // so for s= "oscar"; you're getting "scar" ... 
        s2 = s.Substring(1).ToLower();

        // and then return "O" + "scar" that's why it only works for the first 
        // letter.
        return s1+s2;
    } 
```

现在你要做的就是改变你的算法（然后是你的代码）来做你打算做的事情

您可以在找到空格的部分“拆分”您的字符串，或者您可以针对每个字符，当您找到一个空格时，您知道以下字母将是单词的开头不是吗？

试试这个算法 - 伪代码

```
inside_space = false // this flag will tell us if we are inside 
                     // a white space.

for each character in string do

    if( character is white space ) then 
         inside_space = true // you're in an space...
                             // raise your flag.

     else  if( character is not white space AND 
               inside_space == true ) then 

           // this means you're not longer in a space 
           // ( thus the beginning of a word exactly what you want ) 

          character = character.toUper()  // convert the current 
                                          // char to upper case

          inside_space = false;           // turn the flag to false
                                          // so the next won't be uc'ed
     end

     // Here you just add your letter to the string 
     // either white space, upercased letter or any other.

     result =  result + character 

 end // for 
```

想想看。

你会做你想做的事：

*   一个字母一个字母地去

*   如果你在一个空间里，你会放一面旗帜，

*   当您不再在空间中时，您处于单词的开头，要采取的操作是将其转换为大写。

*   其余的你只需将字母附加到结果中。

当您学习编程时，最好在论文中开始执行“算法”，一旦您知道它会按照您的意愿行事，然后将其依次传递给编程语言。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-06T18:48:16.840

学会爱上这种[`string.split()`](http://dotnetperls.com/Content/String-Split-Benchmark.aspx)方法。

比这更多的帮助，我会觉得很脏。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-06T18:52:03.277

尝试使用：

[System.Globalization.TextInfo.ToTitleCase](http://msdn.microsoft.com/en-us/library/system.globalization.textinfo.totitlecase.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T18:48:01.067

您需要以某种方式标记您的初始字符串。你目前甚至没有看过去整个事情的第一个角色。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-06T18:49:50.673

使用 string.Split(' ') 将句子分成一堆单词，而不是使用必须将每个单词大写的代码......然后将它们全部重新组合在一起。

# iphone - 一个 UITableView - 多个数据源，最好的设计模式？

> ID：417678
> 
> 赞同：5
> 
> 时间：2009-01-06T18:46:03.380
> 
> 标签：iphone, cocoa-touch, oop, cocoa-design-patterns

这似乎是一个典型的问题，但我有一个 UITableView 对两个单独的数据源具有相同的行为。设计类层次结构以减少重复和 if/else 条件的最佳方法是什么？视图控制器将对两个数据源做同样的事情，它们只是在它们的数据集中是唯一的。我应该让父控制器设置其数据源/相应的标题吗？

当使用 UISegmentControl 显示具有相同界面但数据源不同的两个视图时，同样的问题也很重要。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-06T19:05:31.830

请注意这里的术语。UITableView 有一个叫做 a 的东西，`dataSource`但你似乎本质上指的是两组不同的数据。

在您建议的情况下，在表`dataSource`（遵守 UITableViewDataSource 协议的对象）中，我将有三个数组。

*   当前查看数组
*   数据集OneArray
*   数据集TwoArray

在 dataSource 方法中，使用 currentViewedArray 作为表数据的来源。

然后，将 currentViewedArray 设置为您要查看的任何数组：

```
self.currentlyViewedArray = self.datasetOneArray;
[theTableView reloadData]; 
```

您可以使用 UISegmentedControl 在两个数组之间切换。

# createobject - 经典 ASP：不支持 Server.CreateObject

> ID：417690
> 
> 赞同：3
> 
> 时间：2009-01-06T18:50:39.783
> 
> 标签：createobject

当我从我的经典 ASP 页面调用 Server.CreateObject() 时，我得到

```
Microsoft VBScript runtime (0x800A01B6)
Object doesn't support this property or method 
```

我已经尝试了以下（单独）：

```
Server.CreateObject("Microsoft.XMLHTTP")
Server.CreateObject("MSXML2.XMLHTTP")
Server.CreateObject("MSXML.DOMDocument") 
```

我知道 ActiveX 对象已安装，因为以下 javascript 调用有效

```
var test = new ActiveXObject("Microsoft.XMLHTTP");
var test = new ActiveXObject("MSXML2.XMLHTTP");
var test = new ActiveXObject("MSXML.DOMDocument"); 
```

我从我的本地主机 IIS 服务器调用它。任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T19:03:13.487

如果您执行以下操作：

```
Dim x: x = Server.CreateObject("My.ProgID.Here") 
```

...VBScript 创建对象，然后尝试访问存储在“x”中的默认属性。由于这些对象都没有定义默认属性（特别是具有 [id(DISPID_VALUE)] 的基于 IDispatch 的属性），因此失败并显示“对象不支持此属性或方法”。

你真正想要的是这样的：

```
Dim x: Set x = Server.CreateObject("My.ProgID.Here") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T18:56:40.567

这个怎么样？

设置 xml = Server.CreateObject("MSXML2.ServerXMLHTTP")

或者下载这个组件并安装在您的网络服务器上？

[http://www.microsoft.com/downloads/details.aspx?FamilyId=3144B72B-B4F2-46DA-B4B6-C5D7485F2B42&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=3144B72B-B4F2-46DA-B4B6-C5D7485F2B42&displaylang=en)

然后重新启动服务器并重试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T19:02:47.717

从浏览器调用它们并不意味着它们已安装在 IIS 中。

# sql-server - sys.dm_exec_query_optimizer_info“超时”记录表示什么？

> ID：417697
> 
> 赞同：1
> 
> 时间：2009-01-06T18:52:12.400
> 
> 标签：sql-server, sql-server-2005, timeout

在调查一些客户端机器失去与 SQL Server 2005 的连接时，我在网上遇到了以下代码行：

选择 * FROM sys.dm_exec_query_optimizer_info WHERE counter = 'timeout'

当我在我们的服务器上运行此查询时 - 我们得到以下结果：

计数器 - 发生 - 值

超时 - 9100 - 1

据我所知，这意味着查询优化器在尝试优化针对我们服务器运行的查询时超时 - 9100 次。但是，我们在 SQL Server 错误日志中没有看到任何超时错误，我们的最终用户也没有报告任何特定于超时的错误。

谁能告诉我这个“发生”的数量是什么意思？这是我们应该关注的问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-09-13T10:45:36.747

此计数器与您的连接问题无关。

SQL Server 不会永远花时间尝试编译最好的计划（[至少不使用跟踪标志](https://dba.stackexchange.com/a/31262/3690)）。

它在优化过程开始时计算两个值。

1.  足够好的计划的成本
2.  花在查询优化上的最长时间（这是以执行的转换任务的数量而不是时钟时间来衡量的）。

如果找到成本低于阈值的计划，则无需继续优化。此外，如果它超过了预算的任务数量，那么优化也将结束，它将返回迄今为止找到的最佳计划。

优化提前完成的原因显示在`StatementOptmEarlyAbortReason`属性中的执行计划中。实际上有三个可能的值。

*   找到足够好的计划
*   超时
*   超出内存限制。

超时将增加您在 中询问的计数器`sys.dm_exec_query_optimizer_info`。

**延伸阅读**

*   [提前终止声明的原因](http://www.scarydba.com/2010/11/18/reason-for-early-termination-of-statement/)
*   [Microsoft SQL Server 2014 查询调优和优化](https://rads.stackoverflow.com/amzn/click/com/0071829423)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T19:16:35.083

出现列将告诉您计数器增加的次数，而值列是该计数器的内部列。

[看这里](http://decipherinfosys.wordpress.com/2008/02/14/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T19:27:53.610

抱歉，[文档](http://technet.microsoft.com/en-us/library/ms175002(SQL.90).aspx)说这只是内部的。

根据另一个链接，我怀疑这是用于内部引擎超时（例如[`SET QUERY_GOVERNOR_COST_LIMIT`](http://technet.microsoft.com/en-us/library/ms176100(SQL.90).aspx)）

客户端超时也不会记录在 SQL 中，因为客户端中止批处理，从而停止 SQL 处理。

请问您有更详细的资料吗？

# c# - 将字节数组转换为字符串时出现“System.OutOfMemoryException”

> ID：417699
> 
> 赞同：2
> 
> 时间：2009-01-06T18:53:09.530
> 
> 标签：c#, .net, optimization

代码片段：

```
//byte[] myByteArray = byte array from database (database BLOB) 
myByteArray = (byte[]) ((dbCommand.Parameters["parameter"].Value));

string myString =System.Text.Encoding.UTF8.GetString(myByteArray);

Xmldocument doc = new Xmldocument();
doc.Load(myString); 
```

=============

我`System.OutOfMemoryException`有时会。

```
string myString = System.Text.Encoding.UTF8.GetString(myByteArray); 
```

将字节数组转换为字符串时出现此错误。

有没有办法让这段代码变得健壮。

我要做的就是将 BLOB 加载到字节数组中，然后将它们转换为字符串并将它们加载到 xmldocument 中以使用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-06T18:59:43.867

如果您有一个包含 XML 文本的字符串，那么您实际上需要[XmlDocument.LoadXML](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.loadxml.aspx)。XmlDocument.Load 将字符串视为 URL。

也就是说，[XmlDocument.Load](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.load.aspx)具有采用 XmlReader、TextReader 或 Stream 的重载。您可以在底层字节数组上创建一个 MemoryStream 并传递它；这避免了字符串转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T18:59:07.490

XmlDocument.Load(String) 尝试从作为参数给出的 URL 加载 XML 文档，即它尝试将您可能巨大的字符串解释为 URL。难怪出事了。

请改用 LoadXml()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T19:17:58.170

听起来您的 blob 太大而无法作为字符串放入内存中。不要忘记 ASCII 值的大小是二进制形式的字符串的两倍。*无论如何，这些值有*多大？

之后你需要对字符串做什么？您展示了将其加载为 XML（尽管正如 Roger 所说，您确实想要 LoadXml），但不是您计划在此之后执行的操作。你能做一些流数据的事情吗？如果是这样，请将字节数组包装在 MemoryStream 中，然后在其上使用 StreamReader。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T19:39:50.653

Strings/StringBuilders 需要连续的内存块，所以 OutOfMemoryException 与堆的碎片密切相关。

话虽如此，您需要对输入进行分块或按照已经建议的方式使用流。

# c++ - Python：类 C++ 流输入

> ID：417703
> 
> 赞同：2
> 
> 时间：2009-01-06T18:55:14.983
> 
> 标签：c++, input, stream, python

是否有一种 Pythonic 的读取方式 - 比如说 - 混合整数和字符输入，而无需一次读取整个输入且无需担心换行符？例如，我有一个包含空格分隔数据的文件，我只知道其中有 x 个整数，然后是 y 个字符，然后是 z 个更多整数。我不想假设任何关于换行符的事情。

我的意思是像 C++ 中的以下内容一样无意识：

...

```
int i, buf;
char cbuf;
vector<int> X, Z;
vector<int> Y;

for (i = 0; i < x; i++) {
    cin >> buf;
    X.push_back(buf);
}

for (i = 0; i < y; i++) {
    cin >> cbuf;
    Y.push_back(cbuf);
}

for (i = 0; i < z; i++) {
    cin >> buf;
    Z.push_back(buf);
} 
```

编辑：我忘了说我希望它在来自控制台的实时输入下表现良好 - 即在获取令牌之前不需要按 ctrl+d 并且该函数应该能够尽快返回它们行已输入。:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-06T20:02:33.727

一个小的生成器函数如何返回一个令牌流并表现得像`cin`：

```
def read_tokens(f):
   for line in f:
       for token in line.split():
           yield token

x = y = z = 5  # for simplicity: 5 ints, 5 char tokens, 5 ints
f = open('data.txt', 'r')
tokens = read_tokens(f)
X = []
for i in xrange(x):
    X.append(int(tokens.next()))
Y = []
for i in xrange(y):
    Y.append(tokens.next())
Z = []
for i in xrange(z):
    Z.append(int(tokens.next())) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T19:24:52.850

如果你不想一次读一整行，你可能想尝试这样的事情：

```
def read_tokens(file):
    while True:
        token = []
        while True:
            c = file.read(1)
            if c not in ['', ' ', '\t', '\n']:
                token.append(c)
            elif c in [' ', '\t', '\n']:
                yield ''.join(token)
                break
            elif c == '':
                yield ''.join(token)
                raise StopIteration 
```

这应该在文件中生成每个以空格分隔的标记，一次读取一个字符。从那里你应该能够将它们转换为它们应该是的任何类型。空格也可以得到更好的处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T19:13:09.193

像这样？

```
>>> data = "1 2 3 4 5 6 abcdefg 9 8 7 6 5 4 3" 
```

例如，我们可能会得到这个`data= someFile.read()`

```
>>> fields= data.split()
>>> x= map(int,fields[:6])
>>> y= fields[6]
>>> z= map(int,fields[7:]) 
```

结果

```
>>> x
[1, 2, 3, 4, 5, 6]
>>> y
'abcdefg'
>>> z
[9, 8, 7, 6, 5, 4, 3] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T21:31:22.440

这个怎么样？建立在 heikogerlach 的优秀作品之上`read_tokens`。

```
def read_tokens(f):
   for line in f:
       for token in line.split():
           yield token 
```

我们可以像下面这样来提取 6 个数字、7 个字符和 6 个数字。

```
fi = read_tokens(data)
x= [ int(fi.next()) for i in xrange(6) ]
y= [ fi.next() for i in xrange(7) ]
z= [ int(fi.next()) for i in xrange(6) ] 
```

# ssis - SSIS 检查就绪标志

> ID：417707
> 
> 赞同：1
> 
> 时间：2009-01-06T18:57:49.583
> 
> 标签：ssis

我需要有关 SSIS 包的帮助。我有一台服务器，它作为日常工作的一部分填充数据库表。然后服务器写入进程状态表，让我知道它完成了。

进程状态表如下所示：

```
Job   | Ready | Downloaded
myJob    True     False 
```

我想创建一个进程来检查 myJob 上的 Ready Flag 是否为 True 并继续进行，或者如果为 False，它将休眠 30 分钟，然后再次尝试并重复最多 5 次。

我发现这篇关于如何做睡眠部分的文章：http: [//blogs.conchango.com/jamiethomson/archive/2006/10/23/SSIS_3A00_-Put-a-package-to-sleep.aspx](http://blogs.conchango.com/jamiethomson/archive/2006/10/23/SSIS_3A00_-Put-a-package-to-sleep.aspx)

我正在考虑使用文件系统任务来访问进程状态表。然后将变量设置为就绪标志的值。然后有一个 For 循环容器，如果为 true 则跳出 for 循环并继续，如果为 false 则运行 sleep 然后运行另一个文件系统任务并将变量设置为 Ready 标志的值。我的主要问题是如何将变量设置为就绪标志的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T02:08:15.173

如果您有一个 For Loop 容器，您可以放置​​一个“ExecuteSql”任务来提取您的状态值（即 false），然后使用“ScriptTask”来存储它或根据需要对其进行操作。然后，您可以继续处理 for 循环容器的内容（这可能是数据流任务或您使用的任何内容）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T16:57:20.120

我能够弄清楚。

我使用了一个内部带有 OLE DB 源和脚本组件的数据流任务。脚本组件读取和处理数据库数据，执行一些基本的 if else 逻辑，并写入系统变量。

*   从脚本组件教程写入变量：“ [http://blogs.conchango.com/jamiethomson/archive/2006/07/18/SSIS_3A00_-But-it-used-to-work-in-DTS-_2800_7_2900_- *2D00* -从数据泵内部捕获一个值到变量.aspx](http://blogs.conchango.com/jamiethomson/archive/2006/07/18/SSIS_3A00_-But-it-used-to-work-in-DTS-_2800_7_2900_-_2D00_-Capture-a-value-from-inside-the-data-pump-into-a-variable.aspx) "

我稍后在 for 循环中使用该系统变量。

# crash - 调试 Solaris 操作系统崩溃

> ID：417724
> 
> 赞同：0
> 
> 时间：2009-01-06T19:05:24.137
> 
> 标签：crash, solaris, opensolaris

我可以访问一个偶尔崩溃的远程 Solaris 终端，我必须请具有物理访问权限的人启动机器，它成功地完成了。我想知道我应该查看哪些工具/文件来找出崩溃的原因，以便我可以进行必要的配置更改并在将来避免它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T19:30:13.027

您可以使用哪些工具取决于您运行的是什么版本的 Solaris 以及实际问题是什么。首先要做的是检查系统控制台（听起来您无权访问）和 /var/adm/messages 文件。该文件使用系统消息进行更新，最新的将出现在最后。

接下来，您可以查找系统核心文件。如果创建了核心文件，它将位于 /var/crash/hostname 中，其中“hostname”是机器的名称。

如果您在 /var/crash/hostname 目录中有一个实际的核心文件，这组命令将为您提供一个很好的字符串来搜索 google：

```
# cd /var/crash/hostname 
```

将“主机名”替换为您机器的主机名。

```
# mdb -k unix.0 vmcore.0 
```

如果您有多个核心文件，请选择最新版本。

```
 > ::status 
```

这应该会给你一个恐慌信息，将它剪切并粘贴到谷歌中，看看你能找到什么。

有关更多核心文件分析，请阅读： [http ://cuddletech.com/blog/pivot/entry.php?id=965](http://cuddletech.com/blog/pivot/entry.php?id=965)

# svn - 如何将单个文件夹从一个 Subversion 存储库移动到另一个存储库？

> ID：417726
> 
> 赞同：158
> 
> 时间：2009-01-06T19:05:46.227
> 
> 标签：svn, repository, directory, move

我在名为“project”的 Subversion 存储库中有一个“docs”文件夹。我得出的结论是，它确实应该保存在名为“project_docs”的单独 Subversion 存储库中。

我想将“docs”文件夹（**及其所有修订版**）移动到“project_docs”存储库。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：184
> 
> 时间：2009-01-06T19:14:49.050

如果您有权访问存储库本身（不是工作副本），您应该能够转储当前存储库，将其过滤为仅包含有关 docs 文件夹的信息，然后将其加载到其他存储库中。

会是这样的：

```
svnadmin dump /svn/old_repos > ./repository.dump
svndumpfilter include path/to/docs --drop-empty-revs --renumber-revs --preserve-revprops < ./repository.dump > ./docs_only.dump
svnadmin load /svn/new_repos < ./docs_only.dump 
```

如果无法访问存储库，您将无法维护修订历史记录，您必须满足于将文件复制到新存储库并提交。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-04-02T09:00:58.310

svndumpfilter 有一个严重的缺陷——如果文件或路径从您要过滤的路径复制到您要过滤的路径，svndumpfilter 将无法填写历史记录并且作业将失败。

如果您遇到此问题，可以使用[svndumpfilter2 。](http://www.dehora.net/journal/2007/04/patched_svndumpfilter2.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-06T19:10:58.917

这在 SVN 文档中进行了讨论。查看关于...的[存储库维护](http://svnbook.red-bean.com/en/1.1/ch05s03.html)部分，`svndumpfilter`它专门描述了如何将项目从中央存储库中转储出来并将它们移动到新的、单独的存储库中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T19:09:40.433

我不相信您可以远程进行（即，没有本地副本）。但这应该有效：`svn export`来自原始服务器的文件夹，然后`svn add`是您的新存储库。

像：

```
$ svn checkout svn://example.net/newrepo .
$ svn export svn://example.com/oldrepo/mydir ./mydir
$ svn add ./mydir; svn commit 
```

编辑：D'oh，这会删除历史。`svnadmin`按照[塞缪尔的描述](https://stackoverflow.com/questions/417726/how-to-move-a-single-folder-from-one-subversion-repository-to-another-repository#417748)使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-10-05T09:18:51.320

备查：

SVN 文档清楚地报告：

如果您计划手动编辑转储文件以删除顶级目录，请确保您的编辑器未设置为自动将行尾字符转换为本机格式（例如，\r\n 到 \n），因为内容将不同意元数据。这将使转储文件无用。

使用 sed 或 Vim 替换顶级目录，但**此目录名称也包含在项目文件中**！！！！这会导致 SVN 加载校验和错误。

因此，当您执行此操作时，请勿使用仅路径名的 sed 进行字符串替换。

将“节点路径：旧路径”替换为“节点路径：新路径”。有关详细信息，请参阅 SVN 书籍第 5 章“存储库管理”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-11-12T13:16:32.773

我尝试使用接受的答案，但我有一个巨大的存储库，我想导出一个小目录，我无法转储整个存储库。

所以，我只导出了我的目录更改的修订（如果您要导出的目录引用了您的存储库中的其他位置，这可能不起作用）。

```
svn log URL_to_docs | awk '/^r/{gsub(/^r/,"",$1);print $1}' > revisions.txt
#tac for revisions in reverse (oldest revision first)
tac revisions.txt | while read line; do svnadmin dump /svn/old_repo -r$line >> ./docs_revisions.dump ; done

#You don't have to filter if you commited only files in your directory docs in your exported revisions
svndumpfilter include path/to/docs --drop-empty-revs --renumber-revs --preserve-revprops < ./docs_revisions.dump > ./docs_only.dump

svnadmin load /svn/new_repos < ./docs_only.dump 
```

您必须替换您的存储库 URL ( `URL_to_docs`)、服务器中的位置 ( `/svn/old_repo`) 和存储库中文档的路径 ( `path/to/docs`)

`docs_only.dump`如果要更改新存储库中 doc 目录的位置，您可以轻松地编辑您的文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-04T01:28:32.180

`svndumpfilter`我在使用任何工具实现类似目标方面都没有取得如此大的成功。

然后我找到[了 svndumpsanitize](https://github.com/dsuni/svndumpsanitizer)。它不是简单地解析转储文件中的修订，而是真正尝试连接所有提及包含文件的修订，或者理智而安全地跳过包含排除文件的修订。它可能是也可能不是您需要（或需要）的工具，但值得一试。

# asp.net - ASP.NET 本地化网站——即时更新

> ID：417729
> 
> 赞同：1
> 
> 时间：2009-01-06T19:07:30.013
> 
> 标签：asp.net, localization

我想我有一个解决方案，但有没有更好的方法，或者这会打破我？

我正在使用全局/本地 resx 文件构建本地化网站。要求非技术用户可以通过 Web 应用程序编辑字符串并添加新语言。

这似乎很容易——我有一个显示字符串的表单，并且更改保存在如下代码片段中：

```
string filename = MapPath("App_GlobalResources/strings.hu.resx");
XmlDocument xDoc = new XmlDocument();
XmlNode xNode;

xDoc.Load(filename);
xNode = xDoc.SelectSingleNode("//root/data[@name='PageTitle']/value");
xNode.InnerText = txtNewTitle.Text;
xDoc.Save(filename); 
```

这会在繁忙的网站上引起问题吗？如果它导致重新编译的瞬间延迟，那没什么大不了的。实际上，这种形式不会经常被大量使用。社区是怎么想的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T19:23:06.223

我以前使用过类似的方法来制作非常基本的“CMS”。该网站没有被大量使用，但它没有给我带来任何问题。

我不认为更改 resx 会导致回收。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T19:28:03.297

我们做了类似的事情，但使用数据库来存储用户修改的值。然后，我们提供了一种回退机制来服务于本地化键的覆盖值。

也就是说，我认为您的方法应该可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T19:37:11.843

您是否考虑过创建 Resource 对象？您需要将设置包装到所有客户端代码都将使用的单个对象中。就像是：

```
public class GuiResources
{
    public string PageTitle
    {
        get return _pageTitle;
    }

    // Fired once when the class is first created.
    void LoadConfiguration()
    {
        // Load settings from config section
        _pageTitle = // Value from config
    }
} 
```

您可以将其设为单例或提供者，这样对象只会加载一次。您也可以明智地查看当前线程以获取文化信息，以便您知道要返回哪种语言。

然后在您的 web.config 文件中，您可以创建一个[自定义部分](http://msdn.microsoft.com/en-us/library/system.configuration.configurationsection.aspx)并设置`restartOnExternalChanges="true"`. 这样，您的应用程序将在制作时进行更改。

# google-analytics - 用于分析流量的免费统计网站

> ID：417731
> 
> 赞同：1
> 
> 时间：2009-01-06T19:08:32.463
> 
> 标签：google-analytics, apache2, web-traffic

我正在寻找像 Google Analytics 或 Clicky 这样在我自己的服务器上运行的程序。我用过awstats，它看起来很旧。它不一定是开源的，但我更喜欢免费的东西。

如果可能的话，它还应该分析我的 Apache 日志。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T19:23:31.510

您可能想评估[Piwik](http://piwik.org/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T19:12:26.743

看看[模拟](http://www.analog.cx/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T19:41:43.503

日志分析器大多已经不再青睐漂亮的 javascript 客户端。

无论如何，这里有一个列表：

[http://counterguide.com/listing/logs.dir.html](http://counterguide.com/listing/logs.dir.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T20:25:30.623

我一直很喜欢[Webalizer](http://www.webalizer.org/)。在我的 Fedora linux 安装中，它总是默认启用，它可以完成我需要的所有分析。我怀疑它自己设置也很简单。

# visual-studio-2008 - 在 TDD 中，在编写空方法之前运行测试有什么好处？

> ID：417735
> 
> 赞同：24
> 
> 时间：2009-01-06T19:09:58.153
> 
> 标签：visual-studio-2008, unit-testing, tdd

我看到很多 TDD 实践者遵循这个周期：

> 1) 编写测试，就好像目标对象和 API 已经存在一样。
> 
> 2）编译解决方案并看到它崩溃。
> 
> 3）编写足够的代码以使其编译。
> 
> 4）运行测试，看看是否失败。
> 
> 5）编写足够的代码以使其通过。
> 
> 6）运行测试并看到它通过
> 
> 7) 重构

第 1 步和第 2 步的优点是什么？对于像 Visual Studio 这样的 IDE，这样做真的很烦人，因为智能感知会到处乱跳，试图猜测不存在的方法和属性。

我通常从第 3 步开始，让我的所有方法都抛出 NotImplementedException，这对我来说似乎很好，但也许我遗漏了一些东西。

**编辑澄清**：这不是为什么我应该在测试通过之前看到测试失败的问题；这将在第 3 步之后介绍，并且完全有道理。我的问题是，为什么在此之前人们会调用 API 中不存在的单元测试方法（因此 VS 会显示红色曲线，或将整个方法名称涂成红色等）并尝试编译。对我来说，VS 告诉我该方法不存在这一事实已经足够好了。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-06T19:14:32.107

然后先写方法名试试。我发现通过首先编写测试和方法，它迫使我真正考虑 API，并且我可以轻松地轻松更改名称，而不必担心已经编写的代码。我的建议是尽量不遵守规则，并监控会发生什么。如果您发现它会导致问题，请切换回来。如果没有，您现在就有了一种新的工作方式。

还请记住，当您第一次学习事物时，通常需要一套清晰的规则来为您提供上下文。当您开始从初学者转向更高级时，您将获得更多上下文并能够进行调整。在我看来，这就是你所在的地方。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-06T19:28:29.893

我是一名 TDD 从业者，我认为您的做法很好。看到测试失败是重要的部分，而不是看到代码无法编译。

试试这个作为修改后的序列：

> **1)在评论**中编写您的测试，就好像目标对象和 API 已经存在一样。
> 
> 2) 编写足够的 API 代码进行编译。
> 
> 3）取消注释您的测试代码。
> 
> 4）运行测试并看到它失败。
> 
> 5）编写足够的代码以使其通过。
> 
> 6）运行测试并看到它通过
> 
> 7) 冲洗并重复...

这样，您仍然可以获得先*思考*测试而不是先实施的好处。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-06T19:42:48.947

带有 JUnit 的 Eclipse（与带有 MSTest 的 Visual Studio 相对）中的工作流是步骤 1-3 最有意义的地方。第 3 步就是使用 Eclipse 的快速修复功能 (Ctrl-1) 根据您刚刚编写的单元测试生成存根代码。

> DontExistYet someObject = new DontExistYet();
> int 结果 = someObject.newMethod("123");
> 断言等于（123，结果）；

第一行的快速修复将自动创建 DontExistYet 类（让您先通过向导来调整它），下一个快速修复将为您创建 newMethod，并根据您的使用方式适当地找出签名。

因此，所有这些自动化使事情变得更容易，然后您就可以继续使用人们提到的其他优势，即能够通过您将如何使用它来指定您的 API。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-06T20:15:40.237

我想每个人都错过了一个关键点——你怎么知道所需的方法还不存在？编写一个调用不应该存在的方法的单元测试，然后观察它失败，验证您的假设是否正确。在编译语言中，它应该无法编译。在非编译语言中，执行失败可能比检查 API 快得多。在大多数语言中，继承和多态性可能会导致出现的方法未在您的 API 心智模型中注册。

在极少数情况下，您可能会发现该方法确实存在（IntelliSense 也可能有助于检测），并且您可能意识到您需要更改所需的方法签名。或者，您甚至可能会发现根本不需要编写该方法（也许您是在上周编写的，但忘记了）。

当然，您可以选择跳过前两个步骤，甚至完全放弃 TDD，但这些步骤确实有目的。尽管如此，我同意这样一种普遍观点，即我们总是可以从对任何“最佳实践”中这些步骤背后的基本原理的更多描述中受益。

编辑：来自贾斯汀标准...

> 或者，如果您在一个开发人员团队中工作并且没有亲自编写您所依赖的代码。我认为这对于大多数开发人员来说是相当常见的情况。

编辑：从森福...

> 如果您在跟踪基类中实现了哪些方法时遇到问题，在我看来，您的继承层次结构太复杂了。我仍然投票给你，因为我同意如果我从单元测试开始，我需要更多时间来验证一个方法是否不存在。

@senfo：继承层次结构中的复杂性肯定会发生，但这是一个明显解决方案的不同问题。即使您现有的代码是完美的，从尝试调用可能不存在的方法的单元测试开始仍然很有价值，只是为了快速向自己证明它不存在。当然，跳过这一步是可以理解的——我可能会在我的测试行为不端的特定情况下回到它（以验证在那种特定情况下我没有调用我刚刚写的以外的东西）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-06T19:14:41.000

看到它中断可确保您没有在测试代码中犯错误并从一开始就构建了一个有效的测试。

*此外，尝试“使用” API 会让您从不同的角度（API用户*的角度）思考它，这几乎总是有益的。*在您尝试编写 API之前*执行此操作很重要（这始终是从 API*设计者*的角度出发）。很难解释使用自己的 API 的价值，但行业术语是[狗食](http://en.wikipedia.org/wiki/Dogfooding)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-06T19:22:52.137

首先编写测试迫使您决定接口

就这些。

但这已经足够了！接口是您必须在其中编码的盒子；忽略它们并开始编码，并且您通常必须在使用它之前重新工作

编辑：我真的应该更仔细地阅读这个问题，OP 正在寻找更具体的答案。就是这样：在 Visual Studio 中省略第 2 步，取而代之的是存根方法/类。当一个人正在使用的工具显然没有必要时，没有理由对遵循这个扩展的配方感到迂腐。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-06T20:54:01.877

我看到很多回答这个问题的人都有 Visual Studio 背景。我自己使用过 VS，并且遇到了您在 TDD 的前两个步骤中指出的相同问题。

如果您使用更强大的代码编辑 IDE，例如 Java（Eclipse、Netbeans、IntelliJ），前两个步骤更有意义。那里提供的快速修复和代码生成工具使得针对不存在的类或方法编写测试是创建该特定类或声明该特定方法的最快方法；您只需按一个按钮，就会为您生成缺少的类或方法。编写方法调用或对象实例化比先创建类或方法，然后使用它们更快。例如，一旦您调用了一个方法，方法名称和参数类型就会给出该方法的签名应该是什么，因此 IDE 很容易创建它们。这真是一个美妙的过程，我不会以任何其他方式编程。

我在这里声明的内容在动态语言中也是如此，传统上您不会在 IDE 中因缺少类或方法而出现任何编译错误。测试将失败，给你红条。

对于 Visual Studio 用户，如果您想分享这种体验，请安装适用于 Visual Studio 的 Resharper 插件。这将提供 Java IDE 中可用的许多相同功能。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-06T19:32:32.587

首先请记住，基本循环是红-绿-重构。因此，代码无法编译根本不是核心 TDD 循环的一部分。话虽如此，正如一些人所指出的那样，根据正在构建的测试来考虑 API 是很有用的，这就是您的前两个步骤往往会发挥作用的地方。如果您按照自己希望的方式编写 API 以简化测试，那么您更有可能成为被测类的快乐消费者。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-06T19:17:59.043

至于 Visual Studio 对 TDD 的支持，我同意智能感知有时会妨碍您，但您实际上可以将 VS 用于 TDD，尽管它仍然有些限制。如果测试方法引用了被测类上不存在的方法，您可以让 VS 通过按 Ctrl-K、Ctrl-M 为您创建一个存根。

不幸的是，这不适用于 VS2008 中的属性，但据我所知，从 VS2010 的注释中可以看出，在下一个版本中这方面有很多改进。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-06T19:25:21.460

这里的危险是您在编写第一个测试时预设了您的 API。一个技巧是在开始编写代码之前考虑第一个测试——也许是写在纸上，或者至少是在 VS 之外。一旦您知道 API 需要的方法，您就可以继续第 3 步，然后（相对于 VS）回溯到第 1 步并编写实际测试。

我承认我通常会在脑海中完成大部分操作，并且也从步骤 (3) 开始。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-06T21:23:09.507

我认为使用像 Resharper 这样的工具将帮助您更好地了解 TDD。它确实对我有用。

这是因为它可以自动生成许多您在编写它们时需要存根的空类/方法。这有助于在您考虑测试应该如何运行以及您正在测试的类/方法应该如何运行时不会中断您的流程。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-07T08:24:10.640

这不是*本书所说的*测试驱动开发。“[*官方”* TDD 流程](http://books.google.com/books?hl=en&id=gFgnde_vwMAC&dq=Test-Driven+Development:+by+example&printsec=frontcover&source=web&ots=enGpnpWtmH&sig=cXfKmqbVRb_1a5fMGGREE0Mil5M&sa=X&oi=book_result&resnum=2&ct=result#PPA1,M1)，如 Beck 的“测试驱动开发：示例”中所述，如下所示：

*   快速添加测试
*   运行所有测试并看到**新**的测试失败
*   做**一点**改变
*   运行测试并看到它们**都成功**
*   重构以消除重复

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-11T18:16:47.330

就我而言，“看到红色曲线” == 编译器失败。请记住，最初的单元测试/TDD 宣言是在没有考虑 IDE 的情况下编写的。好的 IDE 在当时的 Java 世界中非常罕见，正如其他人所指出的那样，动态语言仍然无法确定在编译时不存在方法。

如果您使用的语言/IDE 组合会立即显示编译错误，那么这将被视为编译周期失败。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-06T19:33:11.960

我同意其他受访者的观点，我认为这只是天真地试图不假思索地做“正确的事情”的人。他们在某处听说您应该在编写**任何**代码之前编写测试，他们确实这样做并出于某种原因尝试编译。

这与[另一个问题的答案有关](https://stackoverflow.com/questions/406760/whats-your-most-controversial-programming-opinion#406775)，请先用你的头！这是最好的最佳实践。

# c++ - OS X 相当于 OutputDebugString()？

> ID：417745
> 
> 赞同：14
> 
> 时间：2009-01-06T19:14:11.703
> 
> 标签：c++, macos, cross-platform, macos-carbon

我正在研究将现有的 Windows MFC 控件移植到 OS X/Carbon 的可行性。我的测试台是使用 XCode 3 向导生成的 C++ Carbon 应用程序。

我正在寻找一种将一些跟踪信息转储到调试器或 DbgView 的 OS X 等效项的快速方法。在 Win32 上，我会使用 OutputDebugString() - OS X 上的交易是什么？有没有办法查看从 Carbon 应用程序写入 std::cout 的测试？

谢谢

杰瑞

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-06T19:49:12.770

没有真正的等价物。Xcode 在后台使用 GDB，因此您基本上是在处理它。但是，您可以自己实现它。仅当存在调试器时，下面的代码示例才会将输出输出到标准输出。如果在编译时存在 NDEBUG，您可以通过将其作为宏包装在预处理器指令中并编译出来（或编译成内联 nil 函数）来进一步保护它。应用程序产生的任何输出都将被定向到 Xcode 中的调试控制台。

```
extern "C" {

bool IsDebuggerPresent() {
    int mib[4];
    struct kinfo_proc info;
    size_t size;

    info.kp_proc.p_flag = 0;
    mib[0] = CTL_KERN;
    mib[1] = KERN_PROC;
    mib[2] = KERN_PROC_PID;
    mib[3] = getpid();

    size = sizeof(info);
    sysctl(mib, sizeof(mib) / sizeof(*mib), &info, &size, NULL, 0);

    return ((info.kp_proc.p_flag & P_TRACED) != 0);
}

void OutputDebugString(const char *restrict fmt, ...) {
    if( !IsDebuggerPresent() )
        return;

    va_list args;
    va_start(args, fmt);
    vprintf(fmt, args);
    va_end(args);
}

} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-07T04:36:42.223

首先，Carbon 没有也不会提供 64 位版本。如果 Apple 放弃了 32 位 Mac OS X（可以肯定地认为迟早会发生），您的应用程序将无法运行。使用可可。

也就是说，有几种方法可以进行日志记录：

1.  NSLog

    这是一个 Cocoa 函数，但您也可以在 Carbon 应用程序中使用它。链接到 Foundation 框架，但不包含标题。自己声明：

    ```
    int NSLog(CFStringRef format, ...); 
    ```

    您将传递一个 CFSTR 文字作为格式：

    ```
    NSLog(CFSTR("Count: %u"), count); 
    ```

    NSLog 的优点是您可以使用 %@ 格式化程序打印 CF 属性列表对象（字符串、数据对象、日期、数字、数组和字典）。例如：

    ```
    CFArrayRef array = /*...*/;
    NSLog(CFSTR("Array: %@"), array); 
    ```

2.  printf/fprintf

    旧的 C 标准库备用。`#include <stdio.h>`得到他们。在 GUI 应用程序中并不重要，但您应该使用 stderr 来保持整洁：`fprintf(stderr, "Count: %u\n", count);`

3.  系统日志

    我猜大约和 f?printf 一样古老，但更强大。这是一个实际的*日志系统*，而不仅仅是写入文件。您可以指定诸如优先级之类的内容，允许您在 beta 测试人员的系统上抑制调试日志消息，同时仍然能够在您自己的系统上读取它们。（最终版本根本不应包含日志记录代码。）

4.  asl_log

    Part of Apple System Logger, Apple's more general replacement for syslog. I have [a series of posts about ASL](http://boredzo.org/blog/archives/2008-01-19/next-week-apple-system-logger) on my blog.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-06T20:22:25.840

您可能想研究一下，`syslog`因为它是基于 UNIX 系统的事实上的诊断方法。就像是：

```
#include <syslog.h>

/* Do this early on in your program like at the beginning of main() */
openlog("MYPROGRAM", 0, LOG_USER);

/* Use this to log something */
syslog(LOG_DEBUG, "%s %s", "Hello", "World");

/* Do this somewhere before you exit if you being are pedantic */
closelog(); 
```

谷歌系统日志了解更多信息。您还必须旋转一些位`syslog.conf`以将输出定向到日志或控制台。然后您可以在终端窗口或使用控制台应用程序查看输出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T20:20:33.563

在 Xcode 中，您可以在“控制台”窗口 (Run->Console)中看到`std::cout`/的输出。`std::cerr`

还有 Console.app（在 /Applications/Utilities 中），它记录`std::cerr`从 GUI 应用程序写入的所有输出。

# vb.net - 如何让 NAnt 将新的 VB9 编译器用于 .NET 2.0 应用程序？

> ID：417755
> 
> 赞同：0
> 
> 时间：2009-01-06T19:17:23.897
> 
> 标签：vb.net, visual-studio-2008, compiler-construction, .net-2.0, nant

我如何告诉 NAnt 在创建面向 .NET 2.0 的应用程序时使用与 VS2008 相同的 VB 编译器？

我已将 Web 应用程序切换到 VS2008，并以 .NET 2.0 为目标。一旦我这样做了，我就可以很好地运行 NAnt（0.85rc4、0.85 和 0.86b1）。当我尝试使用一些 VB9 语法时，它仍然可以很好地编译回 VS2008 中的 .NET 2.0 二进制文件，如果您尝试在 VS2005 中执行新语法（在不支持）。

如果有帮助，这里是我正在尝试的简化版本，只是一个简单的匿名委托，在我尝试使用 NAnt 构建 2.0 应用程序而不是 VS2008 之前效果很好。

```
Public Class SomeObject
    Public Name As String
End Class
Private SomeList As List(Of SomeObject) = SomeObject.GetAllSomeObjects()
Public Function FindFirstItemWithSimilarName(ByVal x As String) As SomeObject
    Return SomeList.Find(Function(p As SomeObject) p.Name.Contains(x))
End Function 
```

**编辑：**除非有人能想到不这样做的理由，否则我的构建文件中的当前设置是这样的（因为我确实想要一个 .NET 2.0 应用程序，只是一个由更强大的 VB 编译器生成的应用程序）：

```
<property name="nant.settings.currentframework" value="net-2.0"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-06T19:24:28.763

我想知道您是否必须更改运行 NAnt[的框架。](http://nant.sourceforge.net/faq.html#change-targetframework)

另外，查看[NAntContrib](http://nantcontrib.sourceforge.net/)项目。那有 MSBuild 任务。我们用它来构建我们 2008 年的项目，在那里我们使用你想要的花哨的语法糖，直到 2.0 程序集。我们必须做的一件事是将 C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727 中的 MSBuild.exe 替换为将请求转发到 3.0 MSBuild.exe

这是我们用来替换 2.0 路径中的 MSBuild.exe 的代码。我不记得我在哪里得到这个代码。我试图在网上找到它，但找不到。

将此构建到 MSBuild.exe 并将您的 2.0 替换为这个。

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Text;

namespace MSBuild
{
    public class Program
    {
        public static int Main(string[] args)
        {
            for (int argIndex = 0; argIndex < args.Length; argIndex++)
            {
                if (args[argIndex].Contains(" "))
                {
                    string quotedArg = string.Format("\"{0}\"", args[argIndex]);
                    args[argIndex] = quotedArg;
                }
            }

            string arguments = string.Join(" ", args);

            // HACK: I should probably change
            //       this to automaticlaly 
            //       determine the path

            Process process = Process.Start("C:\\WINDOWS\\Microsoft.NET\\Framework\\v3.5\\MSBuild.exe",arguments);

            process.WaitForExit();

            return process.ExitCode;

        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T20:27:17.937

我对 NAnt 的期望有点过分。因为我使用 NAntContrib 在项目上运行 msbuild，所以我确实想要 NAnt 的 net-3.5 框架。MSBuild 和项目文件负责将项目反向定位到 .NET 2.0。我能够使用我的 VB 匿名委托，将其编译为 3.5，并将生成的 DLL 直接放到只有 .NET 2.0 的机器上，并且运行良好。

只需将项目设置为编译为 .NET 2.0：项目属性 -> 编译 [选项卡] -> 高级编译选项... -> 目标框架（所有配置）：.NET Framework 2.0

...并告诉 NAnt 盲目假设 net-3.5：

```
<property name="nant.settings.currentframework" value="net-3.5"/> 
```

# c# - 关闭 .NET 表单会导致父级最小化

> ID：417762
> 
> 赞同：4
> 
> 时间：2009-01-06T19:21:39.860
> 
> 标签：c#, winforms, showdialog

我有一个问题，当我关闭由打电话`ShowDialog(owner)`。

奇怪的是，这种情况并非每次都会发生。我看不到 owner/parent 参数是如何被清除的，所以我不知道为什么 parent 会消失。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T20:49:23.787

我每次都能重现。

该错误不在 WinForms 中，而是在 windows API 中（我可以使用 C 代码轻松重现它）。

避免三重嵌套对话框，这似乎是主要触发器。

您还可以在 OnClose 中重新聚焦正确的表单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-12T12:23:27.657

在 MdiParent 中......所有子窗体都会自动加载 {Maximize}{Minimize}{CLose} 按钮......

您只需要像在普通窗口中一样使用这些按钮，，，，，......

表格将被最小化，但仍将显示在 MdiParent....

参考：[http ://www.itpian.com/Coding/6412-How-to-minimize-Form-which-is-shown-in-parent-Form.aspx](http://www.itpian.com/Coding/6412-How-to-minimize-Form-which-is-shown-in-parent-Form.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T13:34:57.427

在调用 Close() 之前将焦点设置到窗体的 Mdiparent。为我工作...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T07:41:17.783

尝试使用此代码，我有同样的问题，终于找到了这个解决方案

```
ChildForm childForm = new ChildForm();
childForm.Show(this); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-08T21:54:18.747

不确定你是否破解了这个，但这可能是你处理对话框中事件的方式。确保您已设置对话框表单 AcceptButton 和 CancelButton 属性，然后在其单击事件处理程序中返回结果。

如果您有任何隐藏对话框的代码，您将遇到问题。

# python - 来自 Python 的 XP 中的进程大小

> ID：417763
> 
> 赞同：5
> 
> 时间：2009-01-06T19:22:11.170
> 
> 标签：python, windows-xp

我有一个可以在 Windows XP 下接近 2 GB 进程限制的 python 脚本。在具有 2 GB 物理内存的机器上，这几乎可以锁定机器，即使 Python 脚本以低于正常优先级运行。

Python中有没有办法找出我自己的进程大小？

谢谢，格里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T23:00:19.437

尝试：

```
import win32process
print win32process.GetProcessMemoryInfo(win32process.GetCurrentProcess()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-19T21:55:33.233

通过使用 psutil [https://github.com/giampaolo/psutil](https://github.com/giampaolo/psutil)：

```
>>> import psutil, os
>>> p = psutil.Process(os.getpid())
>>> p.memory_info()
meminfo(rss=6971392, vms=47755264)
>>> p.memory_percent()
0.16821255914801228
>>> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-19T22:34:29.890

与其担心在运行时限制您的进程大小，不如弄清楚您当前存储在内存中的所有数据是否真的需要始终在内存中。

您可能有足够的磁盘空间，只需创建一些临时文件（请参阅[tempfile 模块](http://docs.python.org/library/tempfile.html)），就应该有足够的机会将您不再用于当前计算的任何数据写入磁盘。然后，您可以稍后在/如果您再次需要它时再读回它。这是（简单地说）有多少数据库工作。

虽然磁盘在计算意义上被认为是“慢”的，但它仍然非常快，并且在处理大型数据集时是一个非常有用的工具。而且由于您已经将进程优先级设置为“低于正常”，因此无论如何速度听起来对您来说都不是一个严重的问题，而内存显然是。

# database - Oracle中的临时表与全局临时表有什么区别？

> ID：417764
> 
> 赞同：29
> 
> 时间：2009-01-06T19:22:23.527
> 
> 标签：database, oracle, temp-tables

我听说这两个术语“临时表”和“全局临时表”在类似的上下文中使用得非常相似。

两者有什么区别？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-01-06T19:56:27.153

在 Oracle 中没有任何区别。当您在 Oracle 数据库中创建临时表时，它自动是全局的，您需要包含“全局”关键字。

SQL 标准定义了术语“GLOBAL TEMPORARY TABLE”的解释方式，允许使用 LOCAL 或 GLOBAL 范围。这将允许用户特定表 (LOCAL) 或每个人 (GLOBAL)。Oracle 仅实现 GLOBAL 版本。

您放入 Oracle 临时表的数据特定于您的会话。也就是说，即使有 100 个用户都在使用同一个表，也只有您可以看到您的数据，并且当您断开连接（或提交当前事务时）时，您的数据会从表中删除，具体取决于表设置。

将此与 MS SQL-Server 进行对比，其中临时表是本地的。如果您创建一个，除了您之外没有人知道您的临时表存在。在 Oracle 中，创建临时表允许每个人（以及有权访问您的模式的每个人）查看该表。当您注销会话时，SQL-Server 表将被删除，并且需要为下一个会话重新创建。在 Oracle 中，临时表现在是模式的永久部分，即使数据不是。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-04-30T06:29:43.937

将此与 MS SQL-Server 进行对比，其中临时表是本地的。如果您创建一个，除了您之外没有人知道您的临时表存在。在 Oracle 中，创建临时表允许每个人（以及有权访问您的模式的每个人）查看该表。当您注销会话时，SQL-Server 表将被删除，并且需要为下一个会话重新创建。在 Oracle 中，临时表现在是模式的永久部分，即使数据不是（如果不是，您可以决定是否保留它）。Oracle 只支持全局临时表，使您不必在每个会话中创建表；它“存在”但它是空的，并且每个会话的内容都是唯一的（和私有的）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-07T18:22:40.433

请注意，全局临时表没有与之关联的统计信息，因此请查看是否应设置实例的动态采样级别以确保在解析时对未分析的表进行采样。否则，启发式可能会导致令人讨厌的执行计划。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-02-18T13:57:46.397

只是为了添加关于本地和全局临时表的现有答案，从`Oracle 18c`那里将有真正的[“私人临时表”](https://docs.oracle.com/en/database/oracle/oracle-database/18/newft/new-features.html#GUID-FE892CE2-E0EB-4D5B-9021-9D4D694FD99E)：

> **私有临时表是在事务或会话结束时自动删除的临时数据库对象。**私有临时表存储在内存中，仅对创建它的会话可见。
> 
> **私有临时表将临时表的范围限制在会话或事务中，从而为应用程序编码提供更大的灵活性，从而更容易代码维护和更好的即用型功能。**

[Oracle Live SQL](https://livesql.oracle.com/apex/livesql/file/content_GAD3PVUCHINEPIQK4IKDXALT7.html)演示：18c 私有临时表：

```
-- Private temporary tables must be prefixed as per the database parameter 
-- 'private_temp_table_prefix' 

create private temporary table ORA$PTT_MY_TT ( x int );

-- The table is truly private. 
-- It does not even exist in the the data dictionary, only your session 

-- By default, the moment you commit, the table ceases to exist 
commit;

select * from ORA$PTT_MY_TT;
-- ORA-00942: table or view does not exist

-- This can be changed by specifying that the definition should be preserved 
create private temporary table ORA$PTT_MY_TT ( x int )  
on commit preserve definition;

insert into ORA$PTT_MY_TT  
select rownum from dual  
connect by level <= 30;

commit;

select count(*) from ORA$PTT_MY_TT;
-- 30 
```

**[db<>小提琴演示](https://dbfiddle.uk/?rdbms=oracle_18&fiddle=c8f92614062ad01f52c990c59c0f25eb)**

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T17:39:59.940

此外，当您的每个用户/会话都需要查看不同的数据集时，Oracle（全局）临时表**非常有用。**只需将记录插入到您的全局临时表中，让 Oracle 管理将一个用户的集合与另一个用户的集合以及清理工作保持一致。您不需要使用用户 ID、会话 ID 或其他任何内容来查询它们。

我们发现它们非常方便。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-05T08:22:46.073

没有临时表，只有全局临时表。全局临时表的想法是定义存在并且所有人都可以看到，但数据对于每个会话都是私有的。您还可以配置是在提交时清理数据还是仅在会话结束时清理数据。

# php - 如何将基于页面的 PHP 应用程序转换为 MVC？

> ID：417774
> 
> 赞同：11
> 
> 时间：2009-01-06T19:25:16.140
> 
> 标签：php, model-view-controller, codeigniter, controller

一段时间以来，我一直在为如何使用 MVC 框架重新编码基于页面的 PHP 应用程序而苦苦挣扎。仅作为背景，我不得不将应用程序移至 MVC，因为我的老板正在制作我。不管怎样，我坐下来，打印出目录结构。然后我开始尝试计划如何将这些页面转换为控制器/动作对。有些事情看起来很直接。例如，我有几个页面专门用于添加/编辑/删除用户。这很容易创建一个“用户”控制器，并为添加/编辑/删除添加方法或操作。我遇到的问题是决定何时实际创建控制器而不是仅将某些东西作为动作，因为它并不总是那么明确。例如，登录控制器与用户/登录，或注册控制器与用户/注册。大部头书，

另一个例子是，我有大约 12 个用于创建“计划”的表单页面。在我的脑海中，我认为我需要创建一个“计划”控制器，然后每个旧的页面都会变成一个动作。所以我有一个控制器，有 12 个动作（方法）。对我来说，问题是，尽管所有 12 个页面都是数据输入表单，但最终构成了这个“计划”，这就是它们的共同点。每个页面使用数据库中的不同表，并且彼此之间没有任何共同之处。基本上通过创建一个“计划”控制器，我只是将其用作分组机制；不一定要使用它，因为它们彼此相关。至少在上面的“用户”控制器示例中；这些动作中的每一个都使用相同的“

我想这归结为让自己使用控制器作为层次结构实体而不是对象/动作。似乎很容易以错误的方式使用控制器陷入这个陷阱。有人明白我在说什么吗？希望它不会太混乱。

**编辑**：如果我尝试在每个视图中坚持使用一个控制器；然后，我会将每个请求的代码保持在最低限度。这是最好的方法吗？

**编辑**：从每个人的说法来看，每个视图一个控制器似乎不符合我的最佳利益。我仍然有些担心，因为控制器似乎很快就会变胖，但这是另一个讨论。我还有一些关于何时决定使用控制器而不是动作的问题。一个很好的例子是堆栈**溢出**本身。在页面顶部，您有一个“问题”选项，我们可以假设它会将您带到“问题”控制器。我这样说是因为在右侧您可以选择“提问”，URL 指向“问题/提问”。这是有道理的，你使用问题控制器的 ask 方法。让我感到困惑的是，菜单上有“未回答”选项。看起来这本身就有一个控制器。为什么它不像“问题/未回答”那样只是问题控制器下的一个动作？这就是我变得混乱的地方。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T21:42:21.137

因为你的老板很喜欢流行语，所以告诉他查找“重构”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T08:42:16.563

稍微偏离你的问题的主题......看在上帝的份上，不要忘记你的旧网址。原因是，当您打开新网站及其漂亮 URL 的开关时，搜索引擎持有的所有聚合内容都会慢慢过期，从而降低您的 SEO 统计数据。

> 更新：如果我尝试在每个视图中坚持使用一个控制器...然后我会将每个请求的代码保持在最低限度，但这是最好的方法吗？

如果我理解正确，每个控制器都会产生一页。这可能是一个非常糟糕的主意，我在维护职位上亲身经历过。如果您的内容与 OO 范例不太匹配，则将其归入一个类别：新闻稿、一次性、信息等，并将它们粘贴到仅提供这些视图的控制器中，或者更好的是每个控制器的数量类别留下更细粒度的控制。

我处理的“MVC”框架让一个控制器查看很快就变成了一个令人费解的混乱，有很多黑客和意大利面条代码。

> 我有大约 12 个用于创建“计划”的表单页面。

我不得不做一些类似的事情，而且看起来很愚蠢，拥有一个“planningform”控制器可能是最好的。是的，有多个表格可供输入，但您可以执行简单的操作，例如 $_SESSION['plannerController']['subject|action'][key][value] 来检查表单的每个部分。让每个方法处理多页表单的一部分也可能是一个好处（例如，如果你的老板说他们只需要 12 页中的 6 页，或者如果第 7 部分变得非常复杂并且需要自动完成 ajax 之类的东西怎么办）。

> 分组机制不一定使用它，因为它们之间有一些相关的东西。

我通常喜欢一个类，一个目的范式，但有时尝试这样做是没有意义的。在某些情况下，从教科书OO和其他时候学术BS可能会下地狱。你会发现不符合 OO 模式的东西，所以你可以退后一步，尝试将东西合并到常见的类别中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T02:20:12.170

> 每个控制器有一个视图有什么意义？

再次：

1.  您没有加载超出每个请求所需的代码。你会加载你不需要的库、包、dll吗？当然不是。所以不要创建一个庞大的控制器文件，每个请求只会执行一小部分代码。此外，较小的文件更易于维护 imo，就像较小的方法和模块化代码一样。
2.  控制器和视图之间有明确的 1:1 链接（特别是如果它们共享相同的名称）。这是一个约定。这是清晰和一致的。如果我正在查看视图模板，我确切地知道仅根据文件名加载它的控制器。不涉及任何思考。没有决定。没有妥协。

> 当一切都只是配对匹配时，有什么需要分离关注点？

关注点分离有什么需要？如果要对相关页面（控制器/视图）进行分组，请将它们集中在目录中。

> 我更倾向于编写一个控制器来控制以某种方式相关的多个视图。例如，前面提到的用户的添加/查看/编辑。您希望将类似的功能保持在一起，而不是在许多文件中搜索您想要的代码。在一个地方定义所有方法（针对特定对象）也很方便。使维护更容易。

我会恭敬地不同意。如果我有一个负责添加/查看/编辑用户的视图，那么通过 1:1 约定，我确切地知道负责的控制器。另一方面，使用您对类似功能进行分组的建议，如果我有一个经理控制器和一个用户控制器，哪个包含经理的添加/查看/编辑？用户还是管理员？现在你必须思考或搜索。

> 我使用 PHP 框架开发了一个项目，该框架为每个“操作”创建了一个单独的文件。命名为“对象（动作）”，它变成了一个需要维护的噩梦。

我不是在建议。

> 我已经使用 Django 一段时间了，它将所有模型保存在一个文件中，将所有视图（控制器）保存在一个文件中，并将模板（视图）分开保存。[Django 不是 MVC，但出于这些目的，让我们假装它是]。这使您可以将通用代码组合在一个地方，并且维护变得更加容易。

我现在感觉很恶心。我不了解 Django，我假设单个文件是可选的，但我无法维护一个包含数万行的文件。

> 我唯一的建议是——不要试图根据 MVC 的某些理想来组织你的项目。组织您的项目如何对您和您的领域有意义。

不不不。这是非常危险的建议。设计模式、编码约定和框架是为了一个目的而设计的——最佳实践和一致性。只有大师才能超越常规，并且只有在他/她独自工作的情况下。即使在框架的范围内，我也会不断地争取更高的一致性，以便在编写或维护代码时不必考虑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T09:20:28.920

每个控制器有一个视图有什么意义？当一切都只是配对匹配时，有什么需要分离关注点？

我更倾向于编写一个控制器来控制以某种方式相关的多个视图。例如，前面提到的用户的添加/查看/编辑。您希望将类似的功能保持在一起，而不是在许多文件中搜索您想要的代码。在一个地方定义所有方法（针对特定对象）也很方便。使维护更容易。

我使用 PHP 框架开发了一个项目，该框架为每个“操作”创建了一个单独的文件。命名为“对象（动作）”，它变成了一个需要维护的噩梦。

我已经使用 Django 一段时间了，它将所有模型保存在一个文件中，将所有视图（控制器）保存在一个文件中，并将模板（视图）分开保存。[Django 不是 MVC，但出于这些目的，让我们假装它是]。这使您可以将通用代码组合在一个地方，并且维护变得更加容易。

我唯一的建议是——不要试图根据 MVC 的某些理想来组织你的项目。组织您的项目如何对您和您的领域有意义。提出 MVC 是为了限制复杂性，而不是增加复杂性。

对于您的计划示例，我会将其制成控制器。www.example.com/plan/1 .. /plan/2 等等。这是有道理的，因为这些操作在逻辑上组合在一起以形成某些任务。

在我看来，控制器应该用于管理任务或对象。它的方法应该是完成该任务或修改/使用对象所需的特定操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T05:05:41.740

去年我经历过类似的事情。我将我的大部分静态 PHP 网站页面转换为使用[Kohana PHP 框架](http://kohanaphp.com/)。我将每个网站部分都设置为控制器，其中包含各个页面的视图。主页视图包括页眉和页脚的其他视图。一些视图，例如文章视图，可以被不同的控制器重用。结果是一个与原始网站具有相同页面 URL 的 MVC 站点。

编辑： URL 的格式为 /controller/method?arguments。例如，在我的网站上，/computer/article.php?id=# 的 URL 使用了*计算机*控制器中的*文章*功能。反过来，*计算机控制器使用**文章*模型将数据加载到具有嵌套*段落视图的**文章*视图中。这也说明了即使该站点的先前版本在 URL 中具有带有 .php 扩展名的页面名称，这仍然可以转换为控制器类方法，并且相同的 URL 在基于 MVC 的站点版本中有效。这应该让您了解 Kohana 如何为您的网站工作。

 **** * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T07:34:36.747

> 我还有一些关于何时决定使用控制器而不是动作的问题。一个很好的例子就是这个 stackoverflow 网站。在页面顶部，您有一个“问题”选项，我们可以假设它会将您带到“问题”控制器。我这样说是因为在右侧您可以选择“提出问题”，URL 指向“问题/询问”。因此，您使用问题控制器的 ask 方法是有道理的。

好吧，我们不知道“问”是否是“问题”控制器的动作。该站点可能将“问题/询问”网址路由到不同的控制器，或者“询问”可能是“问题”目录中的控制器。此外，如果您打开“问题/询问”页面，您会注意到表单被发布到“问题/询问/发布”。现在“post”可能是“ask”操作方法的参数，但我猜它是“ask”控制器的“post”操作方法。

谁知道。但请考虑这一点：“问题”页面需要的代码是“提问”页面的数倍。加载“提问”页面时加载“问题”页面代码是否有意义。我认为stackoverflow的家伙会比这更聪明。

> 但让我感到困惑的是，菜单上有“未回答”选项。看起来这本身就有一个控制器。为什么不只是问题控制器下的一个动作？就像“问题/未回答”一样？这就是我变得混乱的地方。

我认为“提问”页面有自己的控制器的另一个原因。“问题”页面与“未回答”页面有更多共同之处。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T20:09:51.543

在采取这样的行动时，您不仅改变了特定网站的实施，而且改变了人们感知它的方式。无论如何，您将不得不进行大量的重新编码，但您具有理解概念并具有如何做到这一点的经验的优势。

我的建议是坐下来，假装您对如何实施该站点一无所知，但要了解与您正在处理的站点类型相关的所有问题——它的要求和它的陷阱。创建一个基于 MVC 的关于如何做网站的概念化，然后尝试尽可能多地重用您拥有的代码。代码重用最终可能不可行，但从好的方面来说，至少您之前已经解决了许多相同的问题，因此实施起来应该不会花很长时间。

不要忘记，您始终可以使用路由来维护合理的 URL 结构，例如使用不同控制器的一系列表单页面，允许您使用不同的控制器、操作和视图，同时仍然可以从相同的布局或模板。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T20:57:44.563

假设您手头有某种测试，涵盖了应用程序的大部分（全部？）功能。

1.  充实您的 C 部分外观的真正基本结构。
2.  忽略 M 和 V 实现此结构，或多或少只是将代码片段从面向页面的文件复制到控制器中
3.  测试一切是否仍按预期工作
4.  遍历每个控制器，提取一个“M”和一个“V”。“M”可能只是一个 Active Record（我知道，这不是一个真正的模型）或一个行表网关或一些可以很快实现的东西。控制器现在应该变得越来越薄
5.  测试一切是否仍按预期工作
6.  现在您已经了解了有关应用程序的所有信息，如果适用，请再次重构以提取域模型。在某些情况下，这可能只是浪费时间（仅限 CRUD/密集型应用程序）
7.  测试一切是否仍按预期工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-08T03:57:02.100

> 如果我理解正确，每个控制器都会产生一页。这可能是一个非常糟糕的主意，我在维护职位上亲身经历过。
> 
> 我处理的“MVC”框架让一个控制器查看很快就变成了一个令人费解的混乱，有很多黑客和意大利面条代码。

这是因为框架、开发人员还是两者兼而有之？维护起来有多难？涉及哪些黑客行为，为什么？

在 php MVC 框架 Zend、CodeIgniter 和 Kohana 中，1 控制器到 1 视图非常适合我。在 ASP.NET 中，虽然不是 MVC，但 1 个 webform/view 映射到 1 个代码隐藏文件。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-12T20:35:44.583

[Nemetral](http://nemetral.net/2008/07/31/a-gentle-introduction-to-mvc-part-1/)的三篇博客文章让我更清楚地了解了整个概念，这些文章 解释了从传统网页脚本演变而来的模式，因此 PHP 逻辑与表示逻辑分离，因此就 MVC 而言，模型如何与视图分离。根据 Nemetral 的说法：

1.  第一步是将迄今为止与 HTML 标记相结合的所有 PHP 代码移动到页面的头部。
2.  第二步是将所有 HTML 标签移动到一个单独的文件中，并通过 PHP 包含访问它。因此，当发出请求时，它会被定向到 PHP 代码（控制器和模型），然后此代码请求 HTML 标记或演示文稿（视图）。

我在我的论文中写了更多关于这个的内容：http: [//kreus-cms.com/kreus/pages/written_work](http://kreus-cms.com/kreus/pages/written_work)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-01-06T21:08:29.863

> 我遇到的最大问题是决定何时实际创建控制器而不是仅将某些东西作为动作，因为它并不总是那么明确。

尽可能为每个视图使用一个控制器。那样：

1.  您没有加载超出每个请求所需的代码
2.  控制器和视图之间有明确的 1:1 链接（特别是如果它们共享相同的名称）。

# sql-server - 在 web 服务中处理 sql 连接的最佳方法是什么？

> ID：417776
> 
> 赞同：1
> 
> 时间：2009-01-06T19:25:42.023
> 
> 标签：sql-server, connection-pooling, sqlconnection

我有一个最多由 10 个客户端调用的 Web 服务。该网络服务由 7 个不同的 asmx 页面组成，每个页面有大约 100-200 个功能。

所有这些函数都针对 MSSQL2005 或 MS SQL2000 数据库工作。一天中的某些时段，来自客户端的流量很大，似乎我在 sql-server 上的连接用完了，导致所有客户端停止。

在每个函数中，我打开一个连接，做一些事情然后关闭连接，有时有事务，有时没有。

在服务器上，我看到它创建了很多连接，我不知道为什么它们不会消失，但即使在功能完成后仍然存在。所以我可以确定我的 10 个客户不时创建超过 80 个连接。有时它们中的一些会消失，有时它们在使用数小时后仍然存在。那里有某种池化吗？

问题 1：是否有另一种方法来处理我应该使用的连接，例如每个 Web 服务全局连接或任何其他方式？

问题 2：如果可以处理每个函数的连接，那么为什么它不关闭服务器上的连接，使打开的连接列表一直越来越大，直到我摆脱连接错误？

这个问题与我的另一个问题有关，但不一样：[奇怪的 SQL2005 问题。“SqlConnection 不支持并行事务”](https://stackoverflow.com/questions/407320/strange-sql2005-problem-sqlconnection-does-not-support-parallel-transactions)

我现在将其范围缩小到“失去连接”错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T21:27:11.293

我同意关于重构的评论，但这不是这里的相关问题。

你绝对应该在每个函数中使用一个连接，听起来你没有正确处理它们。假设数据库操作包含在您正在调用的函数中，您的代码应如下所示：

```
using (SqlConnection connection = <connection code>)
{
  using (SqlCommand command = <command code>)
  {
    // Execute.
  }
} 
```

在服务器端，连接将保持打开状态。默认情况下，SqlConnection 类启用连接池，因此您将看到连接在服务器端打开。

这种行为是正常的，应该是可以预料的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T22:02:02.923

您实际上看到了正在运行的连接池。这在 .Net 2+ 到 SQL 2005 中默认发生（不确定其他版本）。

连接池意味着 .Net 将为您打开一些连接，以便在您下次需要连接时减少开销。CLR 可以只为您提供一个已经打开（并已清理）的连接，这比直接重新连接到数据库要快几百倍。当您调用 connection.Close() 时，您只是将连接交还给池以进行回收。

每个单独的安全上下文连接都存在一个池 - 这意味着使用相同 SQL 安全性建立的所有连接将共享一个池，而如果您使用 Windows 身份验证，则每个连接的单独用户都将拥有自己的池。

您看到问题是因为您达到了 100 个连接 - 池中的默认最大数量（默认最小值为 0）。此时，池将无法提供另一个连接，直到一个连接被回收，因此应用程序将挂起或超时。您需要更改连接字符串以包含更高的最大数量（并且还要考虑减少连接）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T20:04:34.813

那么这就是一个 Web 服务中的 700-1400 个函数？对我来说听起来太大了。是时候重构了。

我不知道页面和网络服务之间的联系是什么。我通常将它们视为 XML 消息传递端点，完全独立于使用它们的客户端。

# c++ - 帮助更正源代码，带有模板

> ID：417788
> 
> 赞同：1
> 
> 时间：2009-01-06T19:30:01.670
> 
> 标签：c++, templates, stl

我尝试编译发布的示例（[C++ Service Providers](https://stackoverflow.com/questions/412165/c-service-providers)）并未能通过 VS8 VC9。我对模板没有什么经验。
有什么建议么？
坦克。

这些是错误：
dictionarystl.cpp(40)：错误 C2663：'std::_Tree<_Traits>::find'：2 个重载对 'this' 指针没有合法转换
dictionarystl.cpp(48)：错误 C2679：二进制'[' : 未找到采用 'const type_info *__w64 ' 类型的右侧操作数的运算符（或没有可接受的转换）

```
#include <typeinfo>
#include <map>
#include <string>
using namespace std;

class SomeClass
{
public:
    virtual ~SomeClass() {} // virtual function to get a v-table
};

struct type_info_less
{
    bool operator() (const std::type_info* lhs, const std::type_info* rhs) const
    {
        return lhs->before(*rhs) != 0;
    }
};

class TypeMap
{
    typedef map <type_info *, void *, type_info_less> TypenameToObject;
    TypenameToObject ObjectMap;

public:
    template <typename T> 
    T *Get () const
    {
        TypenameToObject::const_iterator iType = ObjectMap.find(&typeid(T));
        if (iType == ObjectMap.end())
            return NULL;
        return reinterpret_cast<T *>(iType->second);
    }
    template <typename T> 
    void Set(T *value) 
    {
        ObjectMap[&typeid(T)] = reinterpret_cast<void *>(value);
    }
};

int main()
{
    TypeMap Services;
    Services.Set<SomeClass>(new SomeClass());
    SomeClass *x = Services.Get<SomeClass>();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T19:35:26.980

要编译此代码，请使用以下行：

```
typedef map<type_info *, void *, type_info_less> TypenameToObject; 
```

应该：

```
typedef map<const type_info *, void *, type_info_less> TypenameToObject; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T19:40:39.590

`typedef`将第 33 行更改为：

```
typedef map <const type_info *, void *, type_info_less> TypenameToObject; 
```

这至少会解决你的第二个错误。我无法重现您的第一个错误，但我怀疑这也会解决这个问题。

# logging - cf.net 异常和其他日志记录

> ID：417789
> 
> 赞同：2
> 
> 时间：2009-01-06T19:30:08.627
> 
> 标签：logging, windows-mobile, compact-framework, log4net

我想为在 WM6 Pro 上运行的 cf.net 应用程序添加一些日志记录功能。我正在研究记录异常和一些更敏感的代码部分。我希望将日志存储在本地（即设备上），并将它们可靠地上传到服务器（它们需要排队，我的应用程序偶尔会连接）。

有谁知道 log4net 是否可行，或者我是否必须编写自己的日志系统？有没有人有任何指示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T20:44:54.593

如果为此使用 log4net，请勿使用 UDP appender 选项登录到远程服务器。如果 WM 设备通过 ActiveSync 连接到 PC 并通过 PC 访问网络，则尝试使用 UDP 将导致 ActiveSync 崩溃，需要重新启动 PC 和软重置 WM 设备。由于这个原因，我的演示出现了严重错误（我们失去了一份巨额合同）。

log4net 在其他环境中可能很棒，但我发现它是一个 PITA，在 Windows Mobile 中不值得麻烦。您最好编写自己的简单 Logger 类，该类使用 TextWriter 将信息转储到文本文件（用于本地日志记录）或调用远程服务器上的 web 服务函数。您可以完全控制在哪里写入什么内容，并且您不需要任何 Chainsaw 废话来阅读您的日志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T19:43:59.443

有可能做到这一点。只需编写自定义附加程序来检查服务器是否可用，如果不可用，则将数据存储在 sqlite 中。

[http://karlagius.wordpress.com/2008/01/02/writing-a-custom-appender-for-log4net/](http://karlagius.wordpress.com/2008/01/02/writing-a-custom-appender-for-log4net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T20:24:03.370

SQL CE（精简版）支持复制。您可以在本地存储异常，然后在连接时将本地数据存储与中央服务器同步。[这里](http://msdn.microsoft.com/en-us/library/ms171850.aspx)有一些细节。

# php - 在 PHP (fputcsv) 中捕获文件输出

> ID：417793
> 
> 赞同：2
> 
> 时间：2009-01-06T19:31:18.780
> 
> 标签：php

我正在尝试捕获的输出，`fputcsv()`以便用于`gzwrite()`实际写入制表符分隔的文件。基本上，我正在查询一个数据库，我想将这些行放入一个 gzip 压缩的 CSV 文件中，我宁愿使用而`fputcsv()`不是实际追加`"\t"`和`"\n"`无处不在。我可以通过输出缓冲或类似的东西以某种方式做到这一点吗？

这是我所拥有的基本轮廓：

```
$results = get_data_from_db();
$fp = gzopen($file_name, 'w');
if($fp) {
    foreach ($results as $row) {
        ???//something with gzwrite() ?
    }
    gzclose($fp);
} 
```

谢谢！

编辑：我的理解是`gzwrite()`需要使用它来实际写入文件才能真正被压缩 - 这不正确吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-06T19:54:02.370

正如在[php.net](http://www.php.net/manual/en/function.fputcsv.php#74118)上阅读的那样，您可以尝试这个小技巧：

```
<?php
// output up to 5MB is kept in memory, if it becomes bigger
// it will automatically be written to a temporary file
$csv = fopen('php://temp/maxmemory:'. (5*1024*1024), 'r+');

fputcsv($csv, array('blah','blah'));

rewind($csv);

// put it all in a variable
$output = stream_get_contents($csv);
?> 
```

这实际上是您试图避免的（捕获输出），但是捕获是一个非常强大的工具，为什么不使用它呢？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T19:51:56.103

也许我误解了这个问题，但[`fputcsv()`](http://www.php.net/fputcsv)对文件句柄进行操作，这是 gzopen 返回的，所以你可以这样做：

```
$results = get_data_from_db();
$fp = gzopen($file_name, 'w');
if($fp) {
    foreach ($results as $row) {
        fputcsv($fp, $row);
    }
    gzclose($fp);
} 
```

我已经对此进行了测试，并且效果很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T19:45:42.217

您可以通过编写自己的[流处理程序](http://ca.php.net/manual/en/book.stream.php)来拦截对底层文件的写入来做到这一点。

**编辑：**阅读此页面上的规范[示例 3](http://ca.php.net/manual/en/stream.examples.php)后，您可能会对它感兴趣

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T21:49:14.447

不要忘记，您始终可以手动执行此操作，而无需使用 csv 函数，而无需再做任何工作。我最近必须这样做，所以我可以获取相同的数据，并将 CSV 输出为制表符分隔、逗号分隔或浏览器可以显示的内容。

您需要做的就是使用基本数组和内爆（这是一个基本示例，您需要添加一些变量来支持正确的 HTMl 表输出，例如列头和尾、行头和尾等......但你明白了：

```
switch ( $_GET['mode'] )
{
    case "csv":
        $wrapper = "'";
        $delimiter = ",";
        $nextrow = "\n";
        break;
    case "txt":
        $wrapper = "";
        $delimiter = "\t";
        $nextrow = "\n";
        break;
    case "html":
        $wrapper = "'";
        $delimiter = ",";
        break;
}

$output = array();
$sql = "SELECT * FROM table";
$result = mysql_query($sql);
while ( $row = mysql_fetch_assoc($result) )
{
    $line = array();
    foreach ( $row as $column => $value )
    {
        $line[] = $wrapper . $value . $wrapper;
    }
    $output[] = implode("", $line) . $nextrow;
}

print implode("",$output); 
```

# php - IE 6 将提供的 HTTP_REFERER 替代品？

> ID：417795
> 
> 赞同：2
> 
> 时间：2009-01-06T19:31:47.190
> 
> 标签：php, internet-explorer, http, http-referer

所以 IE（至少 6 个）不会帮助我解决`$_SERVER["HTTP_REFERER"]`我对 PHP 的要求。

但我是 JavaScript 新手，刚刚在弹出窗口中使用了一个小程序来*刷新*调用弹出窗口的页面（即父页面）。在 Firefox、Safari 等中运行良好。

没有安全问题 - 我只想加载在窗口中的用户是调用弹出窗口（用于编辑）的页面的 URL。（而不是弹出窗口的 URL）。

当我链接到弹出窗口时，我是否被迫在 GET 中*发送URL？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T19:37:57.473

您不能依赖任何浏览器发送 HTTP_REFERER。

要刷新父窗口，请执行以下操作：

```
window.opener.location.reload() 
```

在其他情况下，请使用 PHP 会话而不是依赖引用者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T19:50:07.697

IE 有一种解决方法可以在 JavaScript 转换上传递引用者。

见这里： [http ://webbugtrack.blogspot.com/2008/11/bug-421-ie-fails-to-pass-http-referer.html](http://webbugtrack.blogspot.com/2008/11/bug-421-ie-fails-to-pass-http-referer.html)

适用于 IE6、IE7 和 IE8

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T20:13:03.503

为了将来参考，document.referrer 在 javascript 中也能正常工作。但是在这个例子中，你绝对应该使用 gnud 的方法，考虑到 cacount RoBorg 的评论。

# c# - ASP .NET 和 C#

> ID：417797
> 
> 赞同：3
> 
> 时间：2009-01-06T19:32:49.840
> 
> 标签：c#, asp.net

我刚从大学毕业（07 年通过），从那时起一直从事 Windows 窗体项目。

我对 C# 有很好的理解（不是该语言的所有特性，只有我在项目中使用的那些特性）并且对学习 ASP .NET 非常感兴趣

开始学习 ASP .NET 并学习 C# 会更好吗还是我先掌握语言，然后从 ASP .NET 开始

编辑：我说的是 .NET 框架的 3.5 版本

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-06T19:34:36.980

你混淆了一些术语。C# 是一种语言。ASP.NET 是一种使用语言（通常是 C# 或 VB.NET）来创建网页的方法。因此，如果您的两个兴趣是 C# 和 ASP.NET....

在 C# 中执行 ASP.NET。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T19:36:30.563

您可以很容易地同时使用 C# 和 ASP.Net。您可能要考虑学习 ASP.Net MVC，以及/而不是“正常”的 ASP.Net。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T19:36:23.437

当我开始过渡到 VB.Net 时，我是一名纯 VB6 开发人员。我只做过桌面应用程序——在网络世界中没有一件事情。我开始学习 ASP.Net（工作需要它）并决定同时切换到 C#。

重新做了几个我之前用 C# 用 VB6 和 VB.Net 编写的小应用程序，然后继续。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T20:10:02.573

我同意这里大多数人的观点：同时学习 ASP.NET 和 C#。你必须 - 你的代码隐藏将是 VB.NET 或 C# 反正。还可以查看 MVC 和 LINQ。

但是，重要的是，**也要学习符合标准的 HTML**！Visual Studio 中的大多数拖放控件都对 HTML 做了可怕的事情（gridview，我在看着你）。如果您遵循正确的 HTML 标准，您还将了解在开发干净的网站时哪些控件比其他控件更有用（重复）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T19:36:59.237

在处理 ASP.NET 项目时学习 C# 应该没问题。我会建议，如果您已经非常熟悉 Web，您可能会发现使用 ASP.NET MVC 框架更有趣。ASP.NET 对页面生命周期采取了一些自由，试图使网页编程更像桌面应用程序。就个人而言，我认为这使得 ASP.NET 难以使用，但我的背景是 Perl 和 PHP。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T19:52:24.807

当我学习 asp.net 和 C# 时，我同时学习它们，但分别学习它们。我有一本关于 ASP.net with C# 的好书，我也有一本关于 C# 的书。我发现这有帮助。听起来您已经在使用 C#，所以这对您来说应该不是问题。

正如其他人提到的，要考虑的另一件事是 asp.net webforms 与 asp.net MVC。如果您的背景是 winforms，那么 webforms 将是有意义的。如果您的背景是 php 或非事件驱动框架，那么 MVC 可能更有意义。

MVC 是最近每个人都在用 asp.net 谈论的“热门”新事物。然而，实际上还有更多的资源、教程和代码示例用于 web 表单。我相信随着 MVC 退出测试版并得到更多使用，这种情况会发生变化。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T19:59:38.163

就我而言，唯一真正的学习方法是实践。点击官方 ASP.Net 站点并下载教程并完成它们。

请记住，ASP.Net 不是一种语言，而是一种将 HTML 连接到 C#/VB.Net 代码的方法。玩得开心！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T20:01:40.983

由于您已经有一些 C# 经验，我建议您直接进入 ASP.NET 项目。ASP.NET 将在 Web 方面提供学习机会，尽管 Web 表单抽象出很多（可能太多）Web 的工作方式。从 winforms 迁移到 webforms 将帮助您直接进入，但您最终会想要研究 MVC 或其他 Web 框架（可能是 PHP 甚至是经典的 ASP）。

# powershell - PowerShell 中的 INI 文件解析

> ID：417798
> 
> 赞同：17
> 
> 时间：2009-01-06T19:32:50.883
> 
> 标签：powershell

我在 PowerShell 中解析简单（无节）INI 文件。这是我想出的代码，有什么方法可以简化它吗？

```
convertfrom-stringdata -StringData ( `
  get-content .\deploy.ini `
  | foreach-object `
    -Begin { $total = "" }  `
    { $total += "`n" + $_.ToString() } `
    -End { $total } `
).Replace("\", "\\") 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-07T22:52:04.337

在网上搜索这个主题后，我找到了一些解决方案。所有这些都是手动解析文件数据，所以我放弃了尝试制作标准 cmdlet 来完成这项工作。有一些花哨的解决方案[支持](http://www.leeholmes.com/blog/2007/10/02/managing-ini-files-with-powershell/)写作场景。

有更简单的，就我不需要编写支持而言，我选择了以下非常优雅的代码片段：

```
Function Parse-IniFile ($file) {
  $ini = @{}

  # Create a default section if none exist in the file. Like a java prop file.
  $section = "NO_SECTION"
  $ini[$section] = @{}

  switch -regex -file $file {
    "^\[(.+)\]$" {
      $section = $matches[1].Trim()
      $ini[$section] = @{}
    }
    "^\s*([^#].+?)\s*=\s*(.*)" {
      $name,$value = $matches[1..2]
      # skip comments that start with semicolon:
      if (!($name.StartsWith(";"))) {
        $ini[$section][$name] = $value.Trim()
      }
    }
  }
  $ini
} 
```

这是[雅克·拜拉松](http://groups.google.com/group/microsoft.public.windows.powershell/msg/238e432354e9b433)的。

**更新**感谢 Aasmund Eldhuset 和 @msorens 的改进：空白修剪和评论支持。

**更新 2**跳过任何以`name=value` 分号`name` [开头的`;`注释行](https://stackoverflow.com/questions/1378219/do-standard-windows-ini-files-allow-comments/19550081#19550081)。替换`$ini [$section] = @{}`为`$ini[$section] = @{}`。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-11-22T01:03:02.933

唐·琼斯几乎是对的。尝试：

```
ConvertFrom-StringData((Get-Content .\deploy.ini) -join "`n") 
```

`-join`将 Object[] 转换为单个字符串，数组中的每个项目由换行符分隔。`ConvertFrom-StringData`然后将字符串解析为键/值对。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-07-13T14:12:19.980

这实际上是对当前答案的扩展（似乎无法附加评论）。

我搞砸了这个来做整数和小数的基本处理......

```
function Parse-IniFile ($file)
{
  $ini = @{}
  switch -regex -file $file
  {
    #Section.
    "^\[(.+)\]$"
    {
      $section = $matches[1].Trim()
      $ini[$section] = @{}
      continue
    }
    #Int.
    "^\s*([^#].+?)\s*=\s*(\d+)\s*$"
    {
      $name,$value = $matches[1..2]
      $ini[$section][$name] = [int]$value
      continue
    }
    #Decimal.
    "^\s*([^#].+?)\s*=\s*(\d+\.\d+)\s*$"
    {
      $name,$value = $matches[1..2]
      $ini[$section][$name] = [decimal]$value
      continue
    }
    #Everything else.
    "^\s*([^#].+?)\s*=\s*(.*)"
    {
      $name,$value = $matches[1..2]
      $ini[$section][$name] = $value.Trim()
    }
  }
  $ini
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-11-22T05:35:54.433

一种可能性是使用 .NET ini 库。[以妮妮](http://nini.sourceforge.net)为例。

我已将Nini 文档中的[简单示例翻译成下面的 PowerShell。](http://nini.sourceforge.net)您需要将 nini.dll 放入与脚本相同的目录中。

```
$scriptDir = Split-Path -parent $MyInvocation.MyCommand.Definition
Add-Type -path $scriptDir\nini.dll

$source = New-Object Nini.Config.IniConfigSource("e:\scratch\MyApp.ini")

$fileName = $source.Configs["Logging"].Get("File Name")
$columns = $source.Configs["Logging"].GetInt("MessageColumns")
$fileSize = $source.Configs["Logging"].GetLong("MaxFileSize") 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T22:58:56.163

我不确定您的源数据是什么样的，或者您的目标是什么。你到底在解析什么？你可以发布文件的样本吗？照原样，看起来您只是将回车连接到文件的现有行并将 \ 替换为 \。

也不确定您使用的原因，`$_.ToString()`因为`$_`它已经是 Get-Content 输出的字符串对象。

目标是否只是获取包含一堆名称=值对的文件，并将其转换为哈希表？就是`ConvertFrom-StringData`这样，尽管该 cmdlet 仅在 PowerShell v2 的预览版中可用。

如果您的文件看起来像...

```
key1=value1
key2=value2
key3=value3 
```

那么你只需要

```
ConvertFrom-StringData (Get-Content .\deploy.ini) 
```

我不确定我是否理解您为什么要添加额外的回车符。也没有必要使用`-Begin`and`-End`参数，至少从你发布的内容中我可以看出。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-02-23T10:46:45.300

我根据我的需要优化[了这个解决方案](https://stackoverflow.com/a/422529)，在函数中添加了一些东西和一个用于写回 ini 文件的新函数：

1.  我从原始字典（哈希表）中制作了一个有序字典，以便能够保留文件结构
2.  为了能够保留注释和空行，我将它们放在一个特殊的键中。然后可以在使用数据时忽略它们，或者在写入文件时丢弃它们，如下面的函数所示`Set-IniFile`
3.  在`Set-IniFile`使用选项`-PrintNoSection`和`-PreserveNonData`时，可以控制是否应使用 NO_SECTION 以及是否应保留非数据行（不匹配的 key=value 或 [section]。

```
Function Get-IniFile ($file)       # Based on "https://stackoverflow.com/a/422529"
 {
    $ini = [ordered]@{}

    # Create a default section if none exist in the file. Like a java prop file.
    $section = "NO_SECTION"
    $ini[$section] = [ordered]@{}

    switch -regex -file $file 
    {    
        "^\[(.+)\]$" 
        {
            $section = $matches[1].Trim()
            $ini[$section] = [ordered]@{}
        }

        "^\s*(.+?)\s*=\s*(.*)" 
        {
            $name,$value = $matches[1..2]
            $ini[$section][$name] = $value.Trim()
        }

        default
        {
            $ini[$section]["<$("{0:d4}" -f $CommentCount++)>"] = $_
        }
    }

    $ini
}

Function Set-IniFile ($iniObject, $Path, $PrintNoSection=$false, $PreserveNonData=$true)
{                                  # Based on "http://www.out-web.net/?p=109"
    $Content = @()
    ForEach ($Category in $iniObject.Keys)
    {
        if ( ($Category -notlike 'NO_SECTION') -or $PrintNoSection )
        {
            # Put a newline before category as seperator, only if there is none 
            $seperator = if ($Content[$Content.Count - 1] -eq "") {} else { "`n" }

            $Content += $seperator + "[$Category]";
        }

        ForEach ($Key in $iniObject.$Category.Keys)
        {           
            if ( $Key.StartsWith('<') )
            {
                if ($PreserveNonData)
                    {
                        $Content += $iniObject.$Category.$Key
                    }
            }
            else
            {
                $Content += "$Key = " + $iniObject.$Category.$Key
            }
        }
    }

    $Content | Set-Content $Path -Force
}

### EXAMPLE
##
## $iniObj = Get-IniFile 'c:\myfile.ini'
##
## $iniObj.existingCategory1.exisitingKey = 'value0'
## $iniObj['newCategory'] = @{
##   'newKey1' = 'value1';
##   'newKey2' = 'value2'
##   }
## $iniObj.existingCategory1.insert(0, 'keyAtFirstPlace', 'value3')
## $iniObj.remove('existingCategory2')
##
## Set-IniFile $iniObj 'c:\myNewfile.ini' -PreserveNonData $false
## 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-24T14:09:32.367

nini 看起来像一个库...不确定 powershell

PowerShell崩溃

第一步

```
[void][system.reflection.assembly]::loadfrom("nini.dll") (refer add-type now in ps2 ) 
```

在你可以使用它之后

```
$iniwr = new-object nini.config.iniconfigsource("...\ODBCINST.INI") 

$iniwr.Configs et boom 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-18T14:18:51.087

这是我使用 Powershell 解析 INI 文件的解决方案：

配置.ini：

```
[readme]
; This is a sample configuration file
; Comments start with ';', as in php.ini

[asset]
; Allows you to select assets based on custom fields
environnement_field = "Environnement"
environnement_values[] = "production"
decommissioned_field = "Deco"
decommissioned_values[] = "oui"
decommissioned_values[] = "yes"
decommissioned_values[] = "vrai"
decommissioned_values[] = "true"

[form]
second_section[one] = "1 associated"
second_section[two] = "2 associated"
second_section[] = "1 unassociated"
second_section[] = "2 unassociated"
second_section[] = 1
second_section[] = 1.3
second_section[] = 2.2

[second_section]
path = "/usr/local/bin"
URL = "http://www.example.com/~username"
second_section[one] = "1 associated"
second_section[two] = "2 associated"
second_section[three] = 3
second_section[four] = 4.4
second_section[] = "1 unassociated"
second_section[] = "2 unassociated"
second_section[] = 1
second_section[] = 2.2

[third_section]
phpversion[] = "5.0"
phpversion[] = "5.1"
phpversion[] = "5.2"
phpversion[] = "5.3" 
```

my_script.ps1 ：

```
$PSScriptRoot

function Parse-IniFile ($filePath)
{
    $ini = [ordered]@{}
    $count = @{}
    switch -regex -file $filePath
    {
        #Section.
        "^\[(.+)\]$"
        {
            $section = $matches[1].Trim()
            $ini[$section] = [ordered]@{}
            $count[$section] = @{}
            $CommentCount = 0
            continue
        }
        # Comment
        "^(;.*)$"
        {
            $value = $matches[1]
            $CommentCount = $CommentCount + 1
            $name = "Comment" + $CommentCount
            if ($section -eq $null) {
                $section = "header"
                $ini[$section] = [ordered]@{}
            }
            $ini[$section][$name] = $value
            continue
        }

        #Array Int.
        "^\s*([^#][\w\d_-]+?)\[]\s*=\s*(\d+)\s*$"
        {
            $name,$value = $matches[1..2]
            if (!$ini[$section][$name]) {
                $ini[$section][$name] = [ordered]@{}
            }
            if (!$count[$section][$name]) {
                $count[$section][$name] = 0
            }
            $ini[$section][$name].Add($count[$section][$name], [int]$value)
            $count[$section][$name] += 1
            continue
        }
        #Array Decimal
        "^\s*([^#][\w\d_-]+?)\[]\s*=\s*(\d+\.\d+)\s*$"
        {
            $name,$value = $matches[1..2]
            if (!$ini[$section][$name]) {
                $ini[$section][$name] = [ordered]@{}
            }
            if (!$count[$section][$name]) {
                $count[$section][$name] = 0
            }
            $ini[$section][$name].Add($count[$section][$name], [decimal]$value)
            $count[$section][$name] += 1
            continue
        }
        #Array Everything else
        "^\s*([^#][\w\d_-]+?)\[]\s*=\s*(.*)"
        {
            $name,$value = $matches[1..2]
            if (!$ini[$section][$name]) {
                $ini[$section][$name] = [ordered]@{}
            }
            if (!$count[$section][$name]) {
                $count[$section][$name] = 0
            }
            $ini[$section][$name].Add($count[$section][$name], $value.Trim())
            $count[$section][$name] += 1
            continue
        }

        #Array associated Int.
        "^\s*([^#][\w\d_-]+?)\[([\w\d_-]+?)]\s*=\s*(\d+)\s*$"
        {
            $name, $association, $value = $matches[1..3]
            if (!$ini[$section][$name]) {
                $ini[$section][$name] = [ordered]@{}
            }
            $ini[$section][$name].Add($association, [int]$value)
            continue
        }
        #Array associated Decimal
        "^\s*([^#][\w\d_-]+?)\[([\w\d_-]+?)]\s*=\s*(\d+\.\d+)\s*$"
        {
            $name, $association, $value = $matches[1..3]
            if (!$ini[$section][$name]) {
                $ini[$section][$name] = [ordered]@{}
            }
            $ini[$section][$name].Add($association, [decimal]$value)
            continue
        }
        #Array associated Everything else
        "^\s*([^#][\w\d_-]+?)\[([\w\d_-]+?)]\s*=\s*(.*)"
        {
            $name, $association, $value = $matches[1..3]
            if (!$ini[$section][$name]) {
                $ini[$section][$name] = [ordered]@{}
            }
            $ini[$section][$name].Add($association, $value.Trim())
            continue
        }

        #Int.
        "^\s*([^#][\w\d_-]+?)\s*=\s*(\d+)\s*$"
        {
            $name,$value = $matches[1..2]
            $ini[$section][$name] = [int]$value
            continue
        }
        #Decimal.
        "^\s*([^#][\w\d_-]+?)\s*=\s*(\d+\.\d+)\s*$"
        {
            $name,$value = $matches[1..2]
            $ini[$section][$name] = [decimal]$value
            continue
        }
        #Everything else.
        "^\s*([^#][\w\d_-]+?)\s*=\s*(.*)"
        {
            $name,$value = $matches[1..2]
            $ini[$section][$name] = $value.Trim()
            continue
        }
    }

    return $ini
}

function Set-IniFile ($ini, $filePath)
{
    $output = @()
    foreach($section in $ini.Keys)
    {
        # Put a newline before category as seperator, only if there is null 
        $seperator = if ($output[$output.Count - 1] -eq $null) { } else { "`n" }
        $output += $seperator + "[$section]";

        foreach($key in $ini.$section.Keys)
        {
            if ( $key.StartsWith('Comment') )
            {
                $output += $ini.$section.$key
            }
            elseif ($ini.$section.$key -is [System.Collections.Specialized.OrderedDictionary]) {
                foreach($subkey in $ini.$section.$key.Keys) {
                    if ($subkey -is [int]) {
                        $output += "$key[] = " + $ini.$section.$key.$subkey
                    } else {
                        $output += "$key[$subkey] = " + $ini.$section.$key.$subkey
                    }
                }
            }
            else
            {
                $output += "$key = " + $ini.$section.$key
            }
        }
    }

    $output | Set-Content $filePath -Force
}

$ini = Parse-IniFile -filePath ".\config.ini"
Set-IniFile -ini $ini -filePath ".\config_copy.ini"

Write-Host "=first_section"
$ini["first_section"]
Write-Host "=second_section"
$ini["second_section"]
Write-Host "=second_section.second_section"
$ini["second_section"]["second_section"]
Write-Host "=third_section"
$ini["third_section"]
Write-Host "=third_section.phpversion"
$ini["third_section"]["phpversion"] 
```

输出 ：

```
PS C:\Users\itesant> .\my_script.ps1

Name                           Value                                                                                      
----                           -----                                                                                      
=readme
Comment1                       ; This is a sample configuration file                                                      
Comment2                       ; Comments start with ';', as in php.ini                                                   
=asset
Comment1                       ; Allows you to select assets based on custom fields                                       
environnement_field            "Environnement"                                                                            
environnement_values           {0}                                                                                        
decommissioned_field           "Deco"                                                                                     
decommissioned_values          {0, 1, 2, 3}                                                                               
=form
second_section                 {one, two, 0, 1...}                                                                        
=form.second_section
one                            "1 associated"                                                                             
two                            "2 associated"                                                                             
three                          3                                                                                          
four                           4,4                                                                                        
0                              "1 unassociated"                                                                           
1                              "2 unassociated"                                                                           
2                              1                                                                                          
3                              2,2                                                                                        
=second_section
path                           "/usr/local/bin"                                                                           
URL                            "http://www.example.com/~username"                                                         
second_section                 {one, two, three, four...}                                                                 
=second_section.second_section
one                            "1 associated"                                                                             
two                            "2 associated"                                                                             
three                          3                                                                                          
four                           4,4                                                                                        
0                              "1 unassociated"                                                                           
1                              "2 unassociated"                                                                           
2                              1                                                                                          
3                              2,2                                                                                        
=third_section
phpversion                     {0, 1, 2, 3}                                                                               
=third_section.phpversion
0                              "5.0"                                                                                      
1                              "5.1"                                                                                      
2                              "5.2"                                                                                      
3                              "5.3" 
```

你可以在这里看到一些正则表达式：

部分：[https ://regex101.com/r/maYLKE/3](https://regex101.com/r/maYLKE/3)

评论：[https ://regex101.com/r/IE5FJH/2](https://regex101.com/r/IE5FJH/2)

数组整数：[https ://regex101.com/r/AuuOi3/2](https://regex101.com/r/AuuOi3/2)

数组十进制：[https ://regex101.com/r/Erjjym/2](https://regex101.com/r/Erjjym/2)

阵列其他一切：[https ://regex101.com/r/guC1Yd/2](https://regex101.com/r/guC1Yd/2)

数组关联整数：[https ://regex101.com/r/Us56SL/2](https://regex101.com/r/Us56SL/2)

数组关联十进制：[https ://regex101.com/r/MrCZ9n/2](https://regex101.com/r/MrCZ9n/2)

数组相关的一切：[https ://regex101.com/r/TbYcyf/4](https://regex101.com/r/TbYcyf/4)

# c# - 如何将 .tlb 作为资源文件嵌入到 .NET 程序集 DLL 中？

> ID：417803
> 
> 赞同：13
> 
> 时间：2009-01-06T19:35:18.587
> 
> 标签：c#, .net, com, dll, ccw

我们通过 COM (CCW) 在本机 C++ 中使用我们的 .NET 程序集 DLL。每当我制作我的 DLL 的新版本时，我必须将两个文件（.dll 和相应的 .tlb）发送给在他们的代码中使用它的工作人员。

是否可以将 .tlb 文件作为资源嵌入 .NET DLL 文件中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T02:11:45.150

使用 Visual Studio .NET 做到这一点并不简单，但可以做到。在基本层面上，您需要做的是：

1.  生成您的 TLB 文件，例如“YourLibrary.tlb”。

2.  使用文本编辑器（如记事本，或 Visual Studio 中的 File/New/File.../Text File）创建名为“YourLibrary.rc”的 Win32 资源脚本文件。

3.  在脚本文件中，逐字输入以下文本（当然要替换为您的实际 TLB 文件名）：

    1 个类型库“YourLibrary.tlb”

4.  将脚本文件保存到与 TLB 文件相同的文件夹中。

5.  在 Visual Studio 命令提示符中，切换到包含脚本文件的文件夹并使用以下命令对其进行编译：

    rc YourLibrary.rc

    这将在名为“YourLibrary.res”的同一文件夹中生成一个 Win32 资源文件。

6.  在 Visual Studio 中，右键单击解决方案资源管理器中的项目节点（例如“YourLibrary”）并选择属性。

7.  在“应用程序”选项卡上的“资源”下，选择“资源文件”选项并从第 5 步浏览到“YourLibrary.res”文件。

8.  保存并重建项目。

TLB 现在将作为资源嵌入到 DLL 中，以便其他 COM 应用程序可以读取它。

如果稍后重新生成 TLB 文件，则需要重复步骤 5 重新编译资源文件，并重复步骤 8 将新版本嵌入 DLL 中。

综上所述，您可以使用 Build Events 或通过将自定义 MSBuild 目标放入项目文件中来自动化其中的一些，但这是另一回事。

# xslt - 使用 XSLT 处理业务规则？

> ID：417811
> 
> 赞同：0
> 
> 时间：2009-01-06T19:38:49.563
> 
> 标签：xslt, business-logic

我的一位同事提到 XSLT 的一个用途是处理业务规则。他提到有些系统允许用户以某种文本格式编写业务规则，然后程序使用 XSLT 处理文本并在应用程序运行时应用规则。

有人可以为我解释一下这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T20:01:41.543

哎哟。我不建议这样做。

正如第一响应者所说，XSL-T 用于转换 XML。它不是规则引擎。我认为这听起来像是对技术的滥用。

XSL-T 转换编写起来并不直观。如果您的业务规则目标之一是允许业务人员更新和维护规则，那么我无法想象有比 XSL-T 更迟钝和困难的技术来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T20:24:11.110

我想您的同事指的是 BPEL，即[业务流程执行语言](http://en.wikipedia.org/wiki/Business_Process_Execution_Language)。BPEL 是一种基于 XML 的可执行语言，用于描述业务流程。

作为一种 XML 格式，可以使用 XSLT 生成或转换业务规则。但是，我不熟悉 BPEL，所以我不知道有任何系统在做类似的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T22:59:52.120

是的。有点像文本格式称为 Excel，用户倾向于用它做各种复杂的事情。然后，程序员花费大量时间尝试使用他能找到的每一种闪亮的新技术（包括 XSLT）来处理它，最后决定手动编写代码来解决所有不一致的问题。它不是完全自动化的，因为没有一个理智的用户相信程序员第一次就能把它做好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T19:58:37.743

XSLT 代表 XSL 转换。它用于将 XML 文档从一种形式更改为另一种形式。

对于系统，Microsoft BizTalk 在将一个 XML 文档映射到另一个 XML 文档的映射操作中使用 XSLT。在 XSLT 中，用户可以使用 .net 代码进行更复杂的处理。

我相信其他人会有更好的解释，但您可以通过谷歌搜索 XSLT 教程轻松找到更多信息。这是一个巨大的话题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-09T11:47:36.880

应该可以：用 XML 编写规则，案例数据也应该是 XML，然后可以编写通用 XSLT，将案例数据与规则进行比较，并以正确的顺序执行相关规则。

业务用户不需要了解 XSLT，他们只需要知道如何编写规则。

# asp.net-mvc - 当用户在另一个 DropDrownList 中选择取消选项时，更新 ASP.NET MVC 中的 DropDrownList

> ID：417813
> 
> 赞同：3
> 
> 时间：2009-01-06T19:39:54.257
> 
> 标签：asp.net-mvc, ajax

任何知道如何使用取决于用户选择的值来填充组合的人，我必须组合，国家和地区，当用户选择国家时，我需要去数据库并获取国家的地区，任何人都知道该怎么做这个，如果可以使用 AJAX。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T20:55:20.343

您需要使用特定的 Ajax 库吗？

Ajax.Net Control Toolkit 具有为此功能预先构建的[Cascading Dropdown控件。](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/CascadingDropDown/CascadingDropDown.aspx)

* * *

错过了 MVC 部分，在这种情况下 Ajax Control Toolkit 将无法工作。jQuery 可能是最好的选择，因为它使 Ajax 非常容易编码，并且 MS 正式支持它与 MVC 框架一起使用。

如果您在您的网站上创建了一个 RESTful 服务（应该有大量关于如何执行此操作的文档），您可以通过 jQuery 返回一个 json 响应，如下所示：

标记：

```
<select id="opt1">
  <option value='1'>Option 1</option>
  <option value='2'>Option 2</option>
</select>

<select id="opt2" disabled></select> 
```

假设服务将接受 'id' 作为参数并使用此模式返回一个 json 对象，例如：

```
[
  { name: 'option1', value: '1'},
  { name: 'option2', value: '2'}
] 
```

您可以将此 javascript 添加到页面中：

```
$(function() {
  $('select#opt1').change(function(){
    $.getJSON('/data/myservice',{id: this.value},
      function(response) {
        var options = '';
        for (var i = 0; i < response.length; i++) {
          options += "<option value='" + response[i].value + "'>"
                  +  response[i].name + "</option>";
        }
        $('select#opt2').removeAttr('disabled').html(options);
      });
  });
}); 
```

快速解释那里发生的事情；jQuery 代码可能有点像剥洋葱，所以我一次讲一个层次：

`$(function(){})`是 的简写`$(document).ready(function(){})`，因此它会在 ready 事件触发时运行该函数。

`$('select#opt1').change(function(){})`找到`<select>`名为“opt1”并在更改事件触发时运行该函数。

`$.getJSON()`Ajax 是否需要您。JSON 响应以字符串形式返回，并且必须被解析为 JSON 对象，这由 $.getJSON 自动为您完成。第一个字段是服务的 url，第二个是转换为查询字符串的名称/值对，第三个是处理响应的回调函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T21:51:19.140

我会推荐使用 jQuery 和 MVC 的 JsonResult 来实现这个功能。在你的模型中有一些东西可以根据给定的用户输入从数据库中获取新信息。JsonResult 会将其返回给视图，您将使用 jQuery 将相应地填充下拉列表。

[此处](http://www.dev102.com/2008/08/19/jquery-and-the-aspnet-mvc-framework/)提供了一个[使用 jQuery 和 MVC 框架的 JsonResult](http://www.dev102.com/2008/08/19/jquery-and-the-aspnet-mvc-framework/)的非常基本的示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T22:14:43.833

我还推荐 jQuery，如果您异步获取数据，Json 操作很有用。最终的结果将是一个链式组合框设置，有很多关于如何在 jQuery 中执行此操作的示例，[这个带有现场演示和代码相当不错。](http://www.codeassembly.com/Simple-chained-combobox-plugin-for-jQuery/) 希望它会帮助你。

# .net - 需要一个练习建议来帮助我学习和练习 .NET

> ID：417814
> 
> 赞同：3
> 
> 时间：2009-01-06T19:40:11.103
> 
> 标签：.net, .net-2.0, .net-1.1

您对涉及并涵盖 .NET 最重要和主要概念的复杂练习有任何想法吗？（所以我可以在编码和实现的同时学习）

该练习不应该适合初学者，而是适合已经熟悉 .net，但足够复杂以教授 .NET 2 的新功能的人。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T20:06:00.553

我总是发现，当有个人利益时，学习一些东西会更容易；所以我建议尝试写一些对你有用的东西；这是否是跟踪您喜欢玩的板球/高尔夫/其他运动/等的工具。分数，或帮助您提交纳税申报表，或填写大学申请表，甚至只是为了展示您的才能用作投资组合的东西。

我坐下来做的事情（尽管首先有点拖延）是分析程序集以查找看起来可能实现接口但没有实现接口的类（因此类可能有一个被调用`Clone()`但未实现的方法`ICloneable`） - - 你可以做类似的事情 - 甚至可以将它作为 fxCop 规则，并集成到 VS2008 中的代码分析中

或者，您可以在rentacoder 之类的网站上竞标工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T20:46:15.260

一项伟大的练习可以是研究一些高质量的资源。

例如，获取 Log4Net、Paint.NET 或 xacc 的源代码（第一个对读者非常友好），学习、进行一些修改、测试、使用它......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T20:55:03.167

我知道这是关于练习的，但有一些很棒的书可以帮助你提高。

我已经开始[深入阅读 C#，](http://csharpindepth.com/)并听说过有关 [Effective c#（免费章节 pdf）](http://www.informit.com/content/images/0321245660/items/wagner_item6.pdf)和[More Effective c#（免费章节需要注册）](https://web.archive.org/web/1/http://downloads.techrepublic%2ecom%2ecom/abstract.aspx?docid=173139)的好消息。

阅读完这些内容后，也许可以获取启发您的内容并编写小程序来测试该理论。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T20:00:26.633

如果您正在寻找一个范围广泛的项目，该项目将在设计、架构以及数据库和其他技术的基本要素方面对您提出挑战：

1.  基于 ASP.NET 的 CRM 系统。重塑 Salesforce.com。
2.  内容管理系统。重塑 DotNetNuke。
3.  社交网络系统。重塑 Facebook（不要太疯狂，他们有自己的 API！）
4.  博客系统。重塑博客。
5.  知识库。重新发明！(j/k ;)

这些是一些不错的选择，需要在许多方面进行大量思考。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T20:39:24.137

如果您的目标是以与谋生相关的方式学习 .Net，我建议您访问 Monster.com 或 Dice.com，搜索 .Net Developer/Engineer/Programmer 并找到公司正在寻找经验的常用技术. 拿那个清单，建立现实世界的例子。这样，您既可以学习 .Net，又可以使主题与您的职业相关。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T20:25:22.027

我过去使用的一种技术是找到一本经过充分审查的“学习”书，然后做书中的*每一个例子*。我的意思是这本书有很多例子，你可以自己做，而不是简而言之或参考书。即使是微不足道的例子也可能会阐明整个主题。只是从头到尾。我最近在一次旅行中带着一本 Rails 书做了这个，它最终迫使我弄清楚了 RoR。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T19:52:08.990

这可能听起来很傻，但请尝试订阅 asp.netPRO 杂志。有一个 CD 有他们所有的问题，但订阅者可以从他们的网站搜索和下载所有的东西（包括代码）（如果你有时间和耐心的话）。

我这么说的原因是有很多文章的范围很窄，但却是各种功能的好例子。他们曾经运行这些由 3 部分组成的文章系列，这些文章系列将展示特定的东西 - 调查应用程序、博客、相册和管理器。最新一期有一篇关于 ASP.NET 2.0 报告的简短文章。里面有很多好主意。一篇关于如何在 MasterPages 中使用 CSS（2007 年 3 月号）的文章救了我一命——一步一步地描述了发生的事情，我现在对此感到更舒服了

我不以任何方式为他们工作，我意识到这听起来像是商业垃圾邮件，但让我感到震惊的是，上面有他们的过刊目录的 CD 可能有助于阅读。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T20:06:36.883

Microsoft（和专门的第三方）在提供非常适合跟随的视频教程方面无与伦比：

[.NET Framework 2.0 中的泛型](http://www.microsoft.com/uk/msdn/screencasts/screencast/128/Generics-in-NET-Framework-20.aspx)

[旋风 1 - 泛型](http://channel9.msdn.com/Showpost.aspx?postid=390556)

[Whirlwind 2 - 迭代器](http://channel9.msdn.com/ShowPost.aspx?PostID=391143)

[Whirlwind 3 - 部分类型，匿名方法](http://channel9.msdn.com/ShowPost.aspx?PostID=391977)

[Whirlwind 4 - 访问器、静态类、可空类型](http://channel9.msdn.com/ShowPost.aspx?PostID=392487)

[Brian Noyes 谈 .NET 2.0 中的数据绑定](http://www.dnrtv.com/default.aspx?showNum=7)

[Venkat Subramaniam .NET 2.0 语言特性 A 部分](http://www.dnrtv.com/default.aspx?showNum=18)

[Venkat Subramaniam .NET 2.0 语言特性 B 部分](http://www.dnrtv.com/default.aspx?showNum=19)

卡尔·富兰克林摇滚的 Venkat Subramaniam 教程！差不多是两个小时的运动！

# ms-access - Access.Application.CurrentDb 什么都不是？

> ID：417823
> 
> 赞同：0
> 
> 时间：2009-01-06T19:42:38.617
> 
> 标签：ms-access, vba

我不知道如何解释这个：

我收到一个错误：

> 错误“91”（对象或未设置块）

在下面的第二行：

```
Dim rs As DAO.Recordset

Set rs = CurrentDb.OpenRecordset("SELECT * FROM employees") 
```

以下也是导致它的原因：

```
`Set rs = CurrentDb.OpenRecordset("employees")` 
```

在即时窗口中单独执行`?CurrentDb.Name`也会导致错误。

现在，很明显数据库是打开的，因为我正在编辑其中的表单，那么这里是什么导致这个错误呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-08T11:05:02.313

如果您正在使用 ADP 项目，则应使用 CurrentProject 而不是 CurrentDB。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T20:56:57.797

您应该将 .openRecordset 方法分配给 dao.recordset 对象或通用对象（“后期绑定”技术）。尝试这样的事情：

```
dim rs as dao.recordset
set rs = currentDb.openRecordset(your SELECT instruction,...) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T17:33:35.097

尝试创建一个数据库对象并使用它而不是 CurrentDb 引用。例如：

```
Dim db As DAO.Database
Dim rs As DAO.Recordset

Set db = CurrentDb
Set rs = db.OpenRecordset("SELECT * FROM Employees") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-16T11:52:44.660

我怀疑代码不起作用的原因是，根据 M/Soft[链接文本](http://msdn.microsoft.com/en-us/library/aa221178%28office.11%29.aspx)“CurrentDb”是一种返回“**数据库**类型的对象变量”的方法。所以 Forester93 显示的代码应该可以工作。它是我将使用并且已经使用多年的东西。

# c# - 在 c# 中随机重新排列项目列表的最佳方法是什么？

> ID：417831
> 
> 赞同：6
> 
> 时间：2009-01-06T19:45:22.747
> 
> 标签：c#, .net, random

我有一个对象列表，我想在每个请求中随机重新排序它们。这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-06T19:51:55.057

某种[Knuth-Fisher-Yates 洗牌算法](http://en.wikipedia.org/wiki/Knuth_shuffle)怎么样？

```
for (int i = cards.Length - 1; i > 0; i--)
{
    int n = rand.Next(i + 1);
    Swap(ref cards[i], ref cards[n]);
} 
```

代码取自[Coding Horror](http://www.codinghorror.com/blog/archives/001015.html)。这也是关于人们如何经常做错的推荐阅读。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-06T19:55:00.403

看看这个很酷的 Linq 方法：

```
public class Employee
{
    public int Id
    {
        get;
        set;
    }
    public string Name
    {
        get;
        set;
    }
} 
```

填充列表：

```
 List<Employee> list = new List<Employee>();

    list.Add(new Employee { Id = 1, Name = "Davolio Nancy" });
    list.Add(new Employee { Id = 2, Name = "Fuller Andrew" });
    list.Add(new Employee { Id = 3, Name = "Leverling Janet" });
    list.Add(new Employee { Id = 4, Name = "Peacock Margaret" });
    list.Add(new Employee { Id = 5, Name = "Buchanan Steven" });
    list.Add(new Employee { Id = 6, Name = "Suyama Michael" });
    list.Add(new Employee { Id = 7, Name = "King Robert" });
    list.Add(new Employee { Id = 8, Name = "Callahan Laura" });
    list.Add(new Employee { Id = 9, Name = "Dodsworth Anne" }); 
```

然后排序：

```
 list = list.OrderBy(emp => Guid.NewGuid()).ToList(); 
```

[信用](http://www.dailycoding.com/Posts/random_sort_a_list_using_linq.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T19:51:30.957

您可以使用以线性时间运行的[Fisher-Yates 洗牌算法。](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T19:52:37.427

让我告诉你一种**错误**的方法，我承认我以前用过的一种方法，直到这篇博文才看到它的错误：

[http://www.codinghorror.com/blog/archives/001015.html](http://www.codinghorror.com/blog/archives/001015.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T19:48:45.500

我最喜欢的洗牌解决方案是使用 N*log N 排序并将其传递给返回随机结果的排序谓词。它有一个很好的特性，可以用最少的新代码使用构建块来完成，大多数语言即使在最条纹的版本中也很方便。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T19:52:38.550

我将创建一个新列表并用随机选择并从原始列表中删除的项目填充它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T19:55:10.137

[在此处](http://codegator.com/mcook/archive/2007/04/10/random-sorting-in-c.aspx)尝试此代码

它使用 IComparer.Compare

[如果您使用泛型](http://msdn.microsoft.com/en-us/library/ms172194.aspx)执行该功能，这将是一个好习惯

# c# - 使用带有输出参数的 LINQ 和存储过程丢失小数精度和比例

> ID：417835
> 
> 赞同：7
> 
> 时间：2009-01-06T19:45:46.660
> 
> 标签：c#, linq, linq-to-sql

我有一个使用如下输出参数的存储过程：

```
ALTER PROCEDURE [GetAmount] 
( 
@orderID [int], 
@totalcost decimal(18,2) OUTPUT 
) 
SELECT @totalcost = cost 
FROM mytable 
WHERE orderID = @orderID 
```

当我将存储过程拖到设计器上时，designer.cs 文件中的结果代码最终会丢失精度和比例，如下所示：

```
[Parameter(DbType="Decimal")] ref System.Nullable<decimal> totalcost 
```

这是一个问题，因为诸如产品价格和订单总数之类的东西正在四舍五入（即 19.95 变为 20）。

现在，我可以手动更正 .cs 文件，但我必须记住每次进行更新时都要这样做。难道我做错了什么？有没有办法改变我的存储过程，使 LINQ 能够自动检测精度和规模？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T16:17:50.153

> 我可以手动更正 .cs 文件，但是

是的，您需要将此代码移动到部分类文件中，在那里编辑映射的精度，然后从设计器中删除存储过程。

这为您提供了映射到存储过程的代码的手动规范。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T00:15:25.523

您可以使用货币类型而不是 decial(18,2) 类型吗？

# html - 如何右对齐 标签？

> ID：417840
> 
> 赞同：9
> 
> 时间：2009-01-06T19:47:37.437
> 
> 标签：html, css

我有几个`<p>`要右对齐的标签。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-06T19:49:37.777

CSS：

```
p {
    text-align: right;
} 
```

排队：

```
<p style="text-align: right">Some Text</p> 
```

jQuery：

```
$('p').css('text-align', 'right'); 
```

Javascript：

```
var aElements = document.getElementsByTagName('p');
for (var i = 0; i < aElements.length; i++) {
    aElements[i].style.textAlign = 'right';
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-06T19:50:55.060

这取决于。您是否希望整个段落与它所在的任何容器的右侧对齐？或者您是否希望段落的文本与段落的右边距对齐？

如果是第一个，请查看浮动：对；CSS 指令。后者，text-align: right;

# .net - InternalsVisibleTo 不适用于托管 C++

> ID：417842
> 
> 赞同：12
> 
> 时间：2009-01-06T19:47:52.930
> 
> 标签：.net, c++-cli, internalsvisibleto

InternalsVisibleTo 不适用于我的托管 C++ 项目，但适用于我的 C# 项目。任何帮助，将不胜感激。这是一个简化的布局。

项目**A** - C#，有一个我想从**B/C**访问的内部属性。
项目**B** - 托管 C++。参考文献**A。**
项目**C** - C#，引用**A**。

所有项目都使用相同的密钥进行签名。查看使用 ILDASM 或 Reflector 编译的程序集表明它们都已正确签名（当我注释掉内部属性使用时）。

在项目**A 的**AssemblyInfo.cs 中，我有以下 InternalsVisibleTo；

```
[assembly: InternalsVisibleTo( "B, " +
   "PublicKey=00240000048000009400000006020000002400005253413100040000010001007" +
   "50098646D1C04C2A041FAAF801521A769535DE9A04CD3B4DEDCCBF73D1A6456BF4FE5881451" +
   "0E84983C72D0460B8BA85C52A9CACDC4A0785A08E247C335884C2049ECFE6B2C5E20A18FE4B" +
   "9BFF009ADA232E980D220B3C9586C9C5EE29C29AEE8853DB7BB90CF5A4C704F5244E1A1085C" +
   "4306008535049A0EBB00FE47E78DCB" )]

[assembly: InternalsVisibleTo( "C, " +
   "PublicKey=00240000048000009400000006020000002400005253413100040000010001007" +
   "50098646D1C04C2A041FAAF801521A769535DE9A04CD3B4DEDCCBF73D1A6456BF4FE5881451" +
   "0E84983C72D0460B8BA85C52A9CACDC4A0785A08E247C335884C2049ECFE6B2C5E20A18FE4B" +
   "9BFF009ADA232E980D220B3C9586C9C5EE29C29AEE8853DB7BB90CF5A4C704F5244E1A1085C" +
   "4306008535049A0EBB00FE47E78DCB" )] 
```

键是剪切粘贴的，所以我知道它们是正确的。

当我尝试编译时，**A & C**编译正常，但项目**B**失败

```
Error 1 error C3767: 'A::MyClass::MyProperty::get': candidate function(s) not accessible c:\Users\<snip>\CppClass.cpp 201 B 
```

MSDN 文档说这适用于 C++。是否有错误或其他我需要做的事情？

是否有另一种方法可以保护财产，使其只能由我签名的程序集使用？我知道我可以保护我所有的程序集，但是我可以像这样在粒度级别上做到这一点吗？

**编辑**

根据 MSDN 中的评论，我将属性更改为以下，但这仍然不起作用。

```
[assembly: InternalsVisibleTo( "B, " +
   "PublicKey=00240000048000009400000006020000002400005253413100040000010001007" +
   "50098646D1C04C2A041FAAF801521A769535DE9A04CD3B4DEDCCBF73D1A6456BF4FE5881451" +
   "0E84983C72D0460B8BA85C52A9CACDC4A0785A08E247C335884C2049ECFE6B2C5E20A18FE4B" +
   "9BFF009ADA232E980D220B3C9586C9C5EE29C29AEE8853DB7BB90CF5A4C704F5244E1A1085C" +
   "4306008535049A0EBB00FE47E78DCB" ),
InternalsVisibleTo( "C, " +
   "PublicKey=00240000048000009400000006020000002400005253413100040000010001007" +
   "50098646D1C04C2A041FAAF801521A769535DE9A04CD3B4DEDCCBF73D1A6456BF4FE5881451" +
   "0E84983C72D0460B8BA85C52A9CACDC4A0785A08E247C335884C2049ECFE6B2C5E20A18FE4B" +
   "9BFF009ADA232E980D220B3C9586C9C5EE29C29AEE8853DB7BB90CF5A4C704F5244E1A1085C" +
   "4306008535049A0EBB00FE47E78DCB" )] 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-07T15:07:23.040

我找到了答案。C++ 的工作方式与其他语言不同。除了 InternalsVisibleTo 之外，您还必须使用**as_friend**关键字引用程序集**A。**由于 as_friend 不是“添加引用”对话框中的选项，因此您无法添加项目引用，而是需要在每个需要的 CPP 文件中添加引用。

 **```
#using <A.dll> as_friend 
```

然后，您还需要更改程序集搜索路径以包含项目 A 的构建目录。

恕我直言，这是**托管 C++ 作为第二类语言的典型特征**。如果无法进行项目引用，您最终会在构建调试或发布目录中引用程序集。这会破坏依赖关系，并且当您将配置从调试更改为发布时，您可以让它引用正确的 DLL 的唯一方法是使用丑陋的#IFDEF DEBUG 和#using 的相对路径。

[我也对InternalsVisibleToAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)文档中没有提到这一点感到失望。[我需要在C++ 文档](http://msdn.microsoft.com/en-us/library/ms177208.aspx)中四处寻找信息。

**编辑**：[InternalsVisisbleTo](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)的文档已经更新为[Friend Assemblies (C++)](http://msdn.microsoft.com/en-us/library/ms177208.aspx)文档的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-28T12:30:28.897

笔记：

也许有人会帮助不要手动将引用添加到“#using as_friend”包含的库中，因为如果它保留在这样的引用中，它可能不会被编译。

让 .NET 机制在 #using 指令之后自行决定如何处理这个库。

是的，将库添加到 Properties -> C/C++ -> General -> AdditionalUsingDirectories 的列表中。

# sql-server-2005 - ColdFusion 异常帮助：coldfusion.runtime.NoOperaScope 无法转换为 Coldfusion.runtime.ApplicationScope

> ID：417843
> 
> 赞同：3
> 
> 时间：2009-01-06T19:48:32.273
> 
> 标签：sql-server-2005, coldfusion, cfc

我遇到了由以下代码段的 CFINVOKEARGUMENT 行引起的异常原因：

```
<CFOUTPUT query="cfmx.Messages"><CFSILENT>
<CFINVOKE component="com_VUI_RemoveIllegalChars" method="formatString" returnvariable="cfmx.formattedMessage">
   <CFINVOKEARGUMENT name="inString" value="#TTSText#">
</CFINVOKE>
</CFSILENT> 
```

异常的确切文本是：

> 将 Coldfusion.runtime.NoOperScope 类型的对象强制转换为不兼容的类型时出错。这通常表示 Java 中的编程错误，尽管它也可能意味着您尝试以与设计不同的方式使用外来对象。Coldfusion.runtime.NoOperScope 不能转换为 coldfusion.runtime.ApplicationScope

笔记：

*   cfmx.Messages 是在 CFPROCRESULT 中返回的对象，通过 CFDUMP 检查它确实包含预期的数据
*   com_VUI_RemoveIllegalChars 根本没有改变
*   TTSText 是结果集中的有效列
*   我怀疑这可能是 ColdFusion 配置问题

提前感谢任何可以阐明可能导致此问题的原因的人。

编辑：从异常日志中完成转储：

> "Error","jrpp-11","01/06/09","15:11:37",,"coldfusion.runtime.NoOperScope 不能强制转换为coldfusion.runtime.ApplicationScope 包含或处理的文件的具体顺序是：C:\Inetpub\wwwroot\ermsvui\proc_playsitestatus.cfm，行：30" java.lang.ClassCastException：coldfusion.runtime.NoOperScope 不能在 Coldfusion.runtime.RuntimeServiceImpl.getFullTagName(RuntimeServiceImpl. java:625) 在coldfusion.runtime.TemplateProxyFactory.getFullName(TemplateProxyFactory.java:1082) 在coldfusion.runtime.TemplateProxyFactory.resolveName(TemplateProxyFactory.java:184) 在coldfusion.runtime.TemplateProxyFactory.resolveName(TemplateProxyFactory.java:157) 在Coldfusion.runtime.TemplateProxyFactory。在 Coldfusion.tagext.lang.InvokeTag.doEndTag(InvokeTag.java:358) 在 cfproc_playsitestatus2ecfm1824676963.runPage(C:\Inetpub\ wwwroot\ermsvui\proc_playsitestatus.cfm:30) 在coldfusion.runtime.CfJspPage.invoke(CfJspPage.java:192) 在coldfusion.tagext.lang.IncludeTag.doStartTag(IncludeTag.java:366) 在coldfusion.filter.CfincludeFilter.invoke (CfincludeFilter.java:65) 在coldfusion.filter.ApplicationFilter.invoke(ApplicationFilter.java:279) 在coldfusion.filter.RequestMonitorFilter.invoke(RequestMonitorFilter.java:48) 在coldfusion.filter.MonitoringFilter.invoke(MonitoringFilter.java: 40) 在coldfusion.filter.PathFilter.invoke(PathFilter.java:86) 在coldfusion。filter.LicenseFilter.invoke(LicenseFilter.java:27) 在coldfusion.filter.ExceptionFilter.invoke(ExceptionFilter.java:70) 在coldfusion.filter.ClientScopePersistenceFilter.invoke(ClientScopePersistenceFilter.java:28) 在coldfusion.filter.BrowserFilter.invoke (BrowserFilter.java:38) 在coldfusion.filter.NoCacheFilter.invoke(NoCacheFilter.java:46) 在coldfusion.filter.GlobalsFilter.invoke(GlobalsFilter.java:38) 在coldfusion.filter.DatasourceFilter.invoke(DatasourceFilter.java: 22) 在coldfusion.CfmServlet.service(CfmServlet.java:175) 在coldfusion.monitor 在jrun.servlet.FilterChain.doFilter(FilterChain.java:86) 在coldfusion.bootstrap.BootstrapServlet.service(BootstrapServlet.java:89)。在coldfusion.bootstrap 的event.MonitoringServletFilter.doFilter(MonitoringServletFilter.java:42)。BootstrapFilter.doFilter(BootstrapFilter.java:46) 在 jrun.servlet.FilterChain.doFilter(FilterChain.java:94) 在 jrun.servlet.FilterChain.service(FilterChain.java:101) 在 jrun.servlet.ServletInvoker.invoke(ServletInvoker .java:106) 在 jrun.servlet.JRunInvokerChain.invokeNext(JRunInvokerChain.java:42) 在 jrun.servlet.JRunRequestDispatcher.invoke(JRunRequestDispatcher.java:284) 在 jrun.servlet.ServletEngineService.dispatch(ServletEngineService.java:543)在 jrun.servlet.jrpp.JRunProxyService.invokeRunnable(JRunProxyService.java:203) 在 jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java:320) 在 jrunx.scheduler.ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428) ) 在 jrunx 的 jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266)。scheduler.WorkerThread.run(WorkerThread.java:66)

上面的代码片段包含 proc_playsitestatus.cfm 的第 28 - 32 行

编辑：

TTS 文本的值在这种情况下是“测试的消息是”

com_VUI_RemoveIllegalChars 的来源：

```
<CFCOMPONENT displayname="Format a string for use in VoiceXML" hint="returns a string formatted for voiceXML" output="yes">
    <CFFUNCTION name="formatString" access="public" returntype="string" displayname="Format String" hint="Formats String for VoiceXML">
        <cfargument name="inString" type="string" required="true" displayname="input string" hint="pass in the string to be formatted">
        <CFSET v.messageWithoutChars = replace(inString, "<", "", "all")>
        <CFSET v.messageWithoutChars = replace(v.messageWithoutChars, ">", "", "all")>
        <CFSET v.messageWithoutChars = replace(v.messageWithoutChars, "&", "and", "all")>
        <CFSET v.messageWithoutChars = REReplace(v.messageWithoutChars, "\.+", ".", "all")>
        <CFSET v.messageWithoutChars = replace(v.messageWithoutChars, "!", ".", "all")>
        <CFSET v.messageWithoutChars = replace(v.messageWithoutChars, "\", " ", "all")>
        <CFSET v.messageWithoutChars = replace(v.messageWithoutChars, "/", " ", "all")>
        <CFSET v.messageWithoutChars = REReplace(v.messageWithoutChars, "[[:punct:]]{2,}", " ", "all")>
        <cfreturn v.messageWithoutChars>
    </CFFUNCTION>
</CFCOMPONENT> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T20:12:57.387

你确定那条线#？我认为错误在于 CFC 方法本身。你可以检查一下，如果我是对的，请发布 CFC 方法中的行吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T16:04:55.623

ColdFusion 配置中未启用“启用应用程序变量”设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T13:15:39.583

没有`com_VUI_RemoveIllegalChars`组件的内容和`TTSText`变量的值，你就没有给我们很多东西，在这里。你能把那些贴出来吗？（我知道有时你不能出于保密协议/等原因）

# c++ - 如何在 C 或 C++ 中获取/链接外部函数？

> ID：417876
> 
> 赞同：3
> 
> 时间：2009-01-06T19:57:43.330
> 
> 标签：c++, c, shared-libraries

**编辑：** 我想我应该澄清一下，以防万一。我在 AIX Unix 机器上，所以我使用的是 VAC 编译器——没有 gnu 编译器。 **结束编辑**

* * *

我对 C/C++ 很生疏，如果这是一个简单的问题，请原谅我。

我想从我的一些 C 程序中取出常用功能，并将它们放入共享库或共享对象中。如果我在 perl 中执行此操作，我会将我的 subs 放在 perl 模块中，并在需要时使用该模块。

举个例子，假设我有这个功能：

```
int giveInteger()
{
    return 1034;
} 
```

显然这不是一个真实世界的例子，但如果我想分享那个功能，我将如何进行？

我很确定我有两个选择：

1.  将我的共享函数放在一个文件中，并在编译时将其与我的主程序一起编译。如果我对共享函数进行了更改，我将不得不重新编译我的主程序。
2.  将我的共享函数放在一个文件中，并将其编译为共享库（如果我的术语正确的话），并将我的主程序链接到该共享库。我对共享库所做的任何更改（在编译后）都将在运行时集成到我的主程序中，而无需重新编译我的主程序。

我的想法正确吗？

如果是这样，我该如何完成这两种方法中的一种/两种？我进行了很多搜索，似乎找到了如何将自己的程序链接到其他人的共享库的信息，但没有找到如何创建自己的共享函数并以可以在自己的程序中使用它们的方式编译它们的信息.

非常感谢！

布赖恩

* * *

**编辑：**

## 结论

感谢大家的帮助！我想我会在这篇文章中添加对我有用的东西（对于 AIX 上的动态共享库），以便其他人可以受益：

我编译我的共享函数：

```
xlc -c sharedFunctions.c -o sharedFunctions.o 
```

然后使其成为共享对象：

```
xlc -qmkshrobj -qexpfile=exportlist sharedFunctions.o
xlc -G -o libsharedFunctions.so sharedFunctions.o  -bE:exportlist 
```

然后将其链接到另一个程序：

```
xlc -brtl -o mainProgram mainProgram.c  -L. -lsharedFunctions 
```

另一条评论帮助我找到了这个链接，这也有帮助：http: [//publib.boulder.ibm.com/infocenter/comphelp/v7v91/topic/com.ibm.vacpp7a.doc/proguide/ref/compile_library.htm](http://publib.boulder.ibm.com/infocenter/comphelp/v7v91/topic/com.ibm.vacpp7a.doc/proguide/ref/compile_library.htm)

再次感谢所有帮助过我的人！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T20:23:31.327

是的，你是对的。第一个称为*静态库*，而第二个称为*共享库*，因为代码不会在编译时绑定到可执行文件，而是每次加载程序时都会再次绑定。

## 静态库

编译你的库代码如下：

```
gcc -c *.c 
```

告诉程序不要链接目标文件，而只是为每个已编译的`-c`文件留下目标文件。`.c`现在，将它们归档到一个静态库中：

```
ar rcs libmystuff.a *.o 
```

`man ar`将告诉您 rcs 选项的含义。现在，libmystuff.a 是**一个**存档文件（您可以使用一些 zip 文件查看器打开它），其中包含这些目标文件以及每个目标文件的符号索引。您可以将其链接到您的程序：

```
gcc *.c libmystuff.a -o myprogram 
```

现在，您的程序已准备就绪。请注意，静态库在命令中出现的顺序很重要。请参阅我的[链接订单](https://stackoverflow.com/questions/45135/linker-order-gcc#409470)答案。

## 共享库

对于共享库，您将使用

```
gcc -shared -o libmystuff.so *.c 
```

**仅此而已，** libmystuff.so现在是一个**共享**对象文件。如果要将程序链接到它，则必须将其放入文件中列出的目录，或者由切换到 GCC 给出的目录，或者在 LD_LIBRARY_PATH 变量中列出的目录。链接时，您从告诉 gcc 的库名称中删除前缀和后缀。**`/etc/ld.so.conf``-L``lib``.so`**

 **```
gcc -L. -lmystuff *.c -o myprogram 
```

在内部，gcc 只会将您的参数传递给 GNU 链接器。您可以使用该`-###`选项查看它传递的参数：Gcc 将打印给每个子进程的确切参数。

有关链接过程的详细信息（某些事情是如何在内部完成的），请查看我的[Linux GCC 链接器](https://stackoverflow.com/questions/332554/linux-gcc-linker#332572)答案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T20:07:04.573

你有第三种选择。通常，您的 C++ 编译器应该能够链接 C 例程。必要的选项可能因编译器而异，因此 R 是您的好 M，但基本上，您应该能够使用 g++ 进行编译，如下所示：

```
$ g++ -o myapp myapp.cpp myfunc.c giveint.c 
```

...或单独编译

```
$ gcc -c myfunc.c
$ gcc -c giveint.c
$ g++ -c myapp.cpp
$ g++ -o myapp myapp.o myfunc.o 
```

您还需要包括您的功能声明；你在 C++ 中这样做

```
extern "C" {
    int myfunc(int,int);
    int giveInterger(void);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T07:18:16.390

您需要区分重新编译和重新链接。

如果您放入`giveInteger()`一个单独的（存档）库，然后稍后对其进行修改，您将（显然）需要重新编译定义它的源文件，并*重新链接*所有使用它的程序；但您不需要*重新编译*此类程序 [1]。

对于共享库，您需要重新编译并重新链接该库；但您不必重新链接或重新编译任何使用它的程序。

在 AIX 上构建 C++ 共享库曾经很复杂；您需要使用 makeC++SharedLib shell 脚本。但是有了 VAC 5.0 和 6.0，它变得非常容易。我相信您需要做的就是[2]：

```
xlC -G -o shr.o giveInteger.cc
xlC -o myapp main.cc shr.o 
```

[1] 如果您编写正确的 Makefile（这是推荐的做法），所有这一切都会在您键入`make`.

[2] AIX 的某个特性可能会使事情复杂化：默认情况下，共享库被加载到内存中，并“粘”在那里直到随后重新启动。因此，您可以重建 shr.o，重新运行程序，并观察正在执行的库的“旧”版本。为了防止这种情况发生，一种常见的做法是让 shr.o 不可读：

```
chmod 0750 shr.o 
```

# c# - 从文件中获取最佳记录

> ID：417878
> 
> 赞同：1
> 
> 时间：2009-01-06T19:58:31.363
> 
> 标签：c#

我有一个文件，里面有以下文本

```
咪咪,米,70
塔塔,f,60
波波，米，100
搜搜,f,30

```

我做了从文件读取的事情和许多其他的方法和功能，但是我如何才能根据等级获得最好的男性名字和他的等级。

这是我写的代码。希望不要那么长

```
using System;
using System.Collections.Generic;
using System.Text;
using System.IO;

namespace practice_Ex
{
    class Program
    {
        public static int[] ReadFile(string FileName, out string[] Name, out char[] Gender)
        {
            Name = new string[1];
            int[] Mark = new int[1];
            Gender = new char[1];
            if (File.Exists(FileName))
            {
                FileStream Input = new FileStream(FileName, FileMode.Open, FileAccess.Read);
                StreamReader SR = new StreamReader(Input);
                string[] Current;
                int Counter = 0;
                string Str = SR.ReadLine();
                while (Str != null)
                {
                    Current = Str.Split(',');
                    Name[Counter] = Current[0];
                    Mark[Counter] = int.Parse(Current[2]);
                    Gender[Counter] = char.Parse(Current[1].ToUpper());
                    Counter++;
                    Array.Resize(ref Name, Counter + 1);
                    Array.Resize(ref Mark, Counter + 1);
                    Array.Resize(ref Gender, Counter + 1);
                    Str = SR.ReadLine();
                }
            }
            return Mark;
        }

        public static int MostFreq(int[] M, out int Frequency)
        {
            int Counter = 0;
            int Frequent = 0;
            Frequency = 0;
            for (int i = 0; i < M.Length; i++)
            {
                Counter = 0;
                for (int j = 0; j < M.Length; j++)
                    if (M[i] == M[j])
                        Counter++;
                if (Counter > Frequency)
                {
                    Frequency = Counter;
                    Frequent = M[i];
                }
            }
            return Frequent;
        }

        public static int Avg(int[] M)
        {
            int total = 0;
            for (int i = 0; i < M.Length; i++)
                total += M[i];
            return total / M.Length;
        }

        public static int AvgCond(char[] G, int[] M, char S)
        {
            int total = 0;
            int counter = 0;
            for (int i = 0; i < G.Length; i++)
                if (G[i] == S)
                {
                    total += M[i];
                    counter++;
                }
            return total / counter;
        }

        public static int BelowAvg(int[] M, out int AboveAvg)
        {
            int Bcounter = 0;
            AboveAvg = 0;
            for (int i = 0; i < M.Length; i++)
            {
                if (M[i] < Avg(M))
                    Bcounter++;
                else
                    AboveAvg++;
            }
            return Bcounter;
        }

        public static int CheckNames(string[] Name, char C)
        {
            C = char.Parse(C.ToString().ToLower());
            int counter = 0;
            string Str;
            for (int i = 0; i < Name.Length - 1; i++)
            {
                Str = Name[i].ToLower();
                if (Str[0] == C || Str[Str.Length - 1] == C)
                    counter++;
            }
            return counter;
        }

        public static void WriteFile(string FileName, string[] Output)
        {
            FileStream FS = new FileStream(FileName, FileMode.OpenOrCreate, FileAccess.Write);
            StreamWriter SW = new StreamWriter(FS);
            for (int i = 0; i < Output.Length; i++)
                SW.WriteLine(Output[i]);
        }

        static void Main(string[] args)
        {
            int[] Mark;
            char[] Gender;
            string[] Name;
            string[] Output = new string[8];
            int Frequent, Frequency, AvgAll, MaleAvg, FemaleAvg, BelowAverage, AboveAverage, NamesCheck;
            Mark = ReadFile("c:\\IUST1.txt", out Name, out Gender);
            Frequent = MostFreq(Mark, out Frequency);
            AvgAll = Avg(Mark);
            MaleAvg = AvgCond(Gender, Mark, 'M');
            FemaleAvg = AvgCond(Gender, Mark, 'F');
            BelowAverage = BelowAvg(Mark, out AboveAverage);
            NamesCheck = CheckNames(Name, 'T');
            Output [0]= "Frequent Mark = " + Frequent.ToString();
            Output [1]= "Frequency = " + Frequency.ToString();
            Output [2]= "Average Of All = " + AvgAll.ToString();
            Output [3]= "Average Of Males = " + MaleAvg.ToString();
            Output [4]= "Average Of Females = " + FemaleAvg.ToString();
            Output [5]= "Below Average = " + BelowAverage.ToString();
            Output [6]= "Above Average = " + AboveAverage.ToString();
            Output [7]= "Names With \"T\" = " + NamesCheck.ToString();
            WriteFile("c:\\Output.txt", Output);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T20:14:39.520

好吧，我喜欢 LINQ（更新：通过注释排除）进行查询，特别是如果我可以在不缓冲数据的情况下进行查询（这样我就可以有效地处理一个巨大的文件）。例如下面（更新：删除 LINQ）；请注意，迭代器块 ( `yield return`) 的使用使这完全“懒惰”——一次只有一条记录保存在内存中。

这也显示了关注点的分离：一种方法是逐行读取文件；一种方法是把一行解析成一个类型化的数据记录；一种（或多种）方法适用于这些数据记录。

```
using System;
using System.Collections.Generic;
using System.IO;

enum Gender { Male, Female, Unknown }
class Record
{
    public string Name { get; set; }
    public Gender Gender { get; set; }
    public int Score { get; set; }
}
static class Program
{
    static IEnumerable<string> ReadLines(string path)
    {
        using (StreamReader reader = File.OpenText(path))
        {
            string line;
            while ((line = reader.ReadLine()) != null)
            {
                yield return line;
            }
        }
    }
    static IEnumerable<Record> Parse(string path)
    {
        foreach (string line in ReadLines(path))
        {
            string[] segments = line.Split(',');
            Gender gender;
            switch(segments[1]) {
                case "m": gender = Gender.Male; break;
                case "f": gender = Gender.Female; break;
                default: gender = Gender.Unknown; break;
            }
            yield return new Record
            {
                Name = segments[0],
                Gender = gender,
                Score = int.Parse(segments[2])
            };
        }
    }
    static void Main()
    {
        Record best = null;
        foreach (Record record in Parse("data.txt"))
        {
            if (record.Gender != Gender.Male) continue;
            if (best == null || record.Score > best.Score)
            {
                best = record;
            }
        }

        Console.WriteLine("{0}: {1}", best.Name, best.Score);
    }
} 
```

将事物编写为迭代器的优点是您可以轻松地使用流式传输或缓冲 - 例如，您可以执行以下操作：

```
List<Record> data = new List<Record>(Parse("data.txt")); 
```

然后`data`整天操作（假设它不是太大） - 对于多个聚合、变异数据等很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T20:39:51.437

[这个问题](https://stackoverflow.com/questions/384633/select-the-maximal-item-from-collection-by-some-criterion)询问如何通过某个标准找到最大元素。将它与 Marc 的 LINQ 部分结合起来，您就可以离开了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T21:40:20.683

当然，在现实世界中，这些将是数据库中的记录，您将使用一行 SQL 来选择最佳记录，即：

从成绩中选择姓名、分数，其中分数 = MAX（分数）

（当然，如果有不止一个最佳记录，这会返回不止一个记录。）这是使用正确工具完成工作的一个例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-14T12:25:51.403

您的作业可能有不同的要求，但如果您只想从您描述的文件中获得“最佳男性姓名和等级”，一种紧凑的方法是：

```
public String FindRecord()
{
    String[] lines = File.ReadAllLines("MyFile.csv");
    Array.Sort(lines, CompareByBestMaleName);
    return lines[0];
}

int SortByBestMaleName(String a, String b)
{
    String[] ap = a.Split();            
    String[] bp = b.Split();
     // Always rank male higher
    if (ap[1] == "m" && bp[1] == "f") { return 1; }
    if (ap[1] == "f" && bp[1] == "m") { return -1; }
    // Compare by score
    return int.Parse(ap[2]).CompareTo(int.Parse(bp[2]));
} 
```

请注意，这既不快速也不健壮。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T20:02:27.143

我认为最快和最少代码的方法是将 txt 转换为 xml，然后使用 Linq2Xml 从中进行选择。[这是一个链接。](http://www.hookedonlinq.com/LINQtoXML5MinuteOverview.ashx)

编辑：这可能比你想做的更多。另一种选择是创建一个名为 AcademicRecord 的类，该类具有人名性别等属性。然后，当您阅读文件时，将文件中的每一行添加到列表中。然后使用 Sort 谓词对列表进行排序；最高记录将成为列表中的第一个。[这是一个链接。](http://www.codeproject.com/KB/cs/ASPNet_Sorting.aspx)

# distributed - 协调多个服务器之间的任务

> ID：417879
> 
> 赞同：3
> 
> 时间：2009-01-06T19:58:33.203
> 
> 标签：distributed, sysadmin, maintenance

是否有一个实用程序/库可以促进多台服务器之间的任务协调？对我来说，我需要运行计划任务，在服务器之间复制大量数据，并重新启动进程（在集群中不同机器上发生的一系列相关操作）。

我可以使用 cronjobs 和批处理脚本，尽管我不禁想到有一种更强大、更优雅的方式来解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T20:17:52.820

[Capistrano](https://capistranorb.com/)是一种跨服务器自动执行任务的工具，它完全按照您的要求执行。它是用 Ruby 编写的，并使用 SSH 与其他机器通信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T15:26:29.960

如前所述，[Capistrano](https://capistranorb.com/)可用于自动化任务。它最初是为了一致地部署 Rails 应用程序而编写的，但它已成为一个非常强大的系统管理工具。不过，它通常最适合临时命令和应用程序部署。如果您需要使用一致的配置工具管理多个系统，我建议使用[Puppet](http://reductivelabs.com/projects/puppet/)。

我们使用 Puppet 管理 Rails、Django 和基于 PHP 的 web/db/app 服务器的整体系统配置，我们使用 Capistrano 进行应用程序部署和单个命令（例如在配置更改后运行 Puppet）。

# mobile - 移动设备（尤其是手机）的 J2ME 和（开源）小程序签名 - 我能做什么？

> ID：417895
> 
> 赞同：3
> 
> 时间：2009-01-06T20:03:59.183
> 
> 标签：mobile, java-me, open-source, signing, midlet

我刚刚发现了 J2ME，我喜欢它提供的可能性。我目前正在开发一个简单的应用程序，我想在未来的某个时候将它作为一个开源项目发布。

作为我研究 J2ME 和移动设备的一部分，我研究了小程序签名。似乎想要免费创建小程序的人被夹在摇滚和一个糟糕的地方之间。Applet 签名极其昂贵且极其复杂——而且在免费编码时，这笔费用是不合理的。

那里有大量的 J2ME 兼容设备——我认为不得不忽略它们是一种耻辱，只是耐心地等待下一波浪潮（例如 Android）。

我想知道其他人是否对解决此问题的方法有任何想法？

**更新：我发现这篇博客文章为那些感兴趣的人总结了这个问题...... [http://javablog.co.uk/2007/08/09/how-midlet-signing-is-killing-j2me/](http://javablog.co.uk/2007/08/09/how-midlet-signing-is-killing-j2me/)**

**我考虑为想要 VeriSign 证书的开源 J2ME 开发人员建立一个非营利性伞形组织（因为证书可以无限次地签署代码）。我的目标是筹集 500 美元，然后让小组成员分享购买的证书。与 VeriSign 代表进行了快速交谈，他们认为这个想法可行（只要该组织注册为法人实体）。**

**但是，由于手机制造商现在似乎*只*支持UTI 根证书（您只能通过“Java 验证”程序获得）——这可能不像我想象的那么有用……如果有人有的话听到他们的想法会很棒。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T13:58:13.483

恐怕你在打一场你打不赢的仗。使用受限 API 变得越来越难，这并非偶然。正如您在博客条目中所读到的，您提到最大的问题是网络运营商。即使您从 Verisign 或 Thawte 购买证书（顺便说一句更便宜），您的应用程序也不会在网络运营商品牌的手机中运行，因为它们有自己的 CA 规则。

起初，开发人员可以安装他/她自己的证书，但即使这样现在也是不可能的。这条严格的规则是手机制造商（例如诺基亚）强制执行的，适用于所有手机（甚至没有品牌手机）。我相信这也不是偶然的，主要是网络运营商给设备制造商施加的压力。

最后，虽然[MIDP 3.0](http://www.jcp.org/en/jsr/detail?id=271)已经发布多年，但并没有真正产生什么结果。似乎连 Sun 都认为 J2ME 只适用于游戏。

所有这些都在 J2ME 论坛中广泛讨论了很长时间。普遍的共识是，网络运营商不希望市场上的每一部手机都像智能手机一样运行，并且能够运行第三方应用程序。然后，每个人都可以很容易地使用更便宜的基于 Web 的替代方案来代替 SMS 消息传递。如果您是 J2ME 世界的新手，这听起来像是一种阴谋论，但请记住，网络运营商销售的手机带有自己的固件，这些固件甚至可以锁定基本功能（例如通过蓝牙传输照片或使用 MP3 作为铃声）来强制业主使用付费服务！

我不知道这是否会随着智能手机（iPhone、Android、Windows Mobile）的发展势头而改变。请记住，限制也适用于这些平台（尤其是 Symbian，它对开源也非常不友好）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T20:11:51.180

*   您可以创建自签名的签名证书。您的用户必须愿意信任您。
*   您可以指导您的用户如何创建证书并使用它进行自签名。然后用户必须能够信任自己。
*   或多或少有开放的 CA；您必须愿意信任他们并说服您的用户信任他们。

[Java 教程有一个关于已签名小程序的部分](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/signed.html)，将引导您完成这些步骤。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-09T17:07:01.997

我是一名 J2ME 应用程序开发人员，我完全同意您的帖子。签署 MIDlet 的成本对于开源计划来说简直是无法承受的，除非您正在开发简单的游戏，否则您迟早会使用受限 API 来访问套接字或 Location API，仅举其中两个。这是非常令人沮丧的，如果您认为权限策略在各种设备上并不总是受到相同的威胁，那么事情会变得更糟：在某些手机上，您可以告诉操作系统信任整个 MIDlet 并且从不打扰您，其他继续每次您要求使用受限方法时都征求您的同意。太悲剧了！非常感谢您的提议，我认为这对 JavaME 开发人员来说将是一项伟大的成就。

# c# - 为什么我有 LINQ to SQL 时需要存储过程

> ID：417898
> 
> 赞同：13
> 
> 时间：2009-01-06T20:05:23.160
> 
> 标签：c#, .net, linq, linq-to-sql, stored-procedures

我对 Linq to Sql 的理解是它会将我的 Linq 语句转换为等效的 SQL 语句。

所以

```
var products = from p in db.Products
               where p.Category.CategoryName == "Beverages"
               select p 
```

只是变成

```
Select * from Products where CategoryName = 'Beverages' 
```

如果是这样的话，我看不到存储过程有什么用处了。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-06T20:13:11.677

Sprocs 是盒子里的另一个工具。您可能会在 90% 的任务中使用您喜欢的自动调节扳手，但您不能在剥掉的螺母上使用那种闪亮的东西。为此，一个好的 ol' 活动扳手是你最好的朋友。除非您折断螺栓，否则在这种情况下您将无法进行组装。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-06T20:19:22.960

如果这就是你在 sql 中所做的一切，那么你以前不需要存储过程！

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-06T20:13:12.410

安全。

我看过几个“安全最佳实践”指南，它们建议您通过 SP 进行所有数据访问，并且您只授予执行这些 SP 的权限。
如果客户端根本无法执行任何数据库表`select`或`delete`在任何数据库表上，则该客户端被黑客入侵的风险可能会降低。

我从来没有亲自参与过以这种方式工作的项目，这似乎总是在背后带来巨大的痛苦。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-01-06T20:20:18.527

啊，许多争论的主题。

如今，许多人会争辩说，如今 LINQ-to-SQL 等技术生成的 SQL 非常好，以至于性能优势微乎其微。就个人而言，我更喜欢 SQL 专家调整 SQL 性能，而不是一般的编码人员，所以我倾向于不同意。

但是，我对存储过程的主要偏好与性能关系不大，而与安全性和配置管理有关。

我的大部分架构工作都是关于面向服务的解决方案，通过将数据库视为服务，存储过程的使用对它有很大帮助。

原则上，通过存储过程限制对数据库的访问会创建一个定义良好的接口，从而限制攻击面并提高可测试性。允许应用程序直接访问底层数据会大大增加攻击面，降低安全性，并使影响分析变得极其困难。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-06T20:14:18.850

1.  存储过程和 Linq to Sql 解决不同的问题。

2.  Linq to Sql 是 Microsoft SQL Server 特有的。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-07T09:01:31.767

我倾向于使用存储过程有几个原因：

1.  它使安全配置更容易（如其他海报所述）。
2.  它为数据库访问提供了一个明确定义的接口（尽管这方面的责任可以转移到其他领域，例如用 C# 编写的 DAL
3.  我发现，至少在 Oracle 中，查询优化器能够做出更明智的决策，您提供的信息越多。不过，这确实需要针对您的特定场景使用这两种方法进行测试。
4.  根据可用的开发人员，您可能拥有一些非常优秀的 SQL 编码人员，如果他们使用存储过程，他们将更好地生成高效查询。

不利的一面是，如果事情发展迅速，让调用存储过程的代码与数据库保持同步可能会很痛苦。关于产生高效查询的要点可以算作过早优化。**归根结底，在现实**条件下对性能进行基准测试是无可替代的。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-13T23:37:15.187

我可以想到存储过程的几个很好的理由：

*   处理更大的表时，使用 LINQ to SQL 生成高效查询可能很困难。
*   DBA 可以分析和排除存储过程的问题。但是想想当来自不同前端的两个复杂的 LINQ 操作发生冲突时会发生什么。
*   存储过程可以强制数据完整性。拒绝对表的写访问，只允许通过存储过程进行更改。
*   更新存储过程就像在服务器上运行 ALTER PROCEDURE 一样简单。如果部署需要几个月的时间，而脚本需要几分钟，那么您将更加灵活地使用存储过程。

对于由一个人维护的小型应用程序，存储过程可能是多余的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-06T20:08:13.417

如果您在适当的情况下使用存储过程，那么在 SQL Server 方面会有显着的相关性能改进。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-06T20:14:51.237

包含对 LINQ to SQL 的存储过程支持部分是为了与现有系统兼容。这允许开发人员随着时间的推移从基于 sproc 的系统迁移到完全基于 LINQ 的系统，逐个 sproc，而不是强迫开发人员急于一次转换整个系统。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-06T20:15:25.137

就个人而言，我不关心 LINQ。我喜欢数据操作和代码的分离。此外，从 LINQ 语句生成的匿名类型不能传递给 n 层应用程序的其他层，因此需要具体定义类型，或者需要在 UI 中进行 LINQ 调用。盖克！

此外，还有安全问题（LINQ 代码调用 MS SQL Server 的任何用户都需要不受限制地访问数据，因此如果该用户名/密码被泄露，那么数据也是如此）。

最后，LINQ to SQL 仅适用于 MS SQL Server（因为它来自 MS）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-06T20:21:44.890

Sproc 有其用途，就像使用 LINQ 一样。IMO 如果一个操作在多个地方执行多次，那么它是一个很好的“重构”到存储过程的候选者，而不是在不同地方重复的 LINQ 语句。

另外，这可能是对这里很多人的亵渎，有时您**应该**将一些逻辑放入数据库中，然后存储过程就派上用场了。这是一种罕见的情况，但有时业务规则的性质要求它。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-06T20:27:51.677

存储过程在很多情况下都很有用，但一般来说，如果您使用的是 ORM，您应该让 ORM 为您生成 SQL。为什么我们必须为每个表至少维护四个存储过程（插入更新删除和单个选择）。

话虽如此，正如人们指出的那样，使用存储过程有安全优势。您不必授予用户对表的读/写权限，这是对 SQL 注入的良好保护。

当用于检索数据的逻辑相当复杂时，存储过程也很有用。您通常在报告场景中看到更多这一点，在这种情况下，您可能不使用 Linq2Sql 或其他一些 ORM。

在我看来，如果您不生成 SQL 而是在应用程序层中对其进行硬编码，那么应该将其重构为存储过程，是的，任何规则总是有例外，但一般来说。

Linq2Sql 中存储过程的一种用途可能是如果您有多个服务器，并且正在链接到它们，您可以使用存储过程来公开来自其他服务器的数据并对其进行操作。这将从您的应用程序中隐藏多个服务器。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-06T20:28:43.657

有些事情没有存储过程就无法完成。例如，在我之前的工作中，有一个存储过程从一行返回当前值，并在同一个原子操作中递增它，这样没有两个进程都得到相同的值。我不记得为什么这样做而不是使用自动增量，但这是有原因的。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-08-27T14:19:32.150

**原因：要从一个表移动到另一个表的大量数据。**

假设有时您必须将项目从一个表归档到另一个表或执行类似的操作。使用 LINQ 意味着从表 A 中检索一百万行到 DBMS 客户端，然后将它们插入到表 B 中。

*使用存储过程可以很好地工作，成套。*

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-06T20:17:52.773

一段时间以来，很多人在没有他们的情况下也过得很好。如果您可以在没有它们的情况下安全高效地完成工作，请不要对使用纯 L2S 感到内疚。我们很高兴在我的商店里摆脱它们。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-06T21:05:16.500

您当然不需要“存储过程”。但是，如果您的域模型需要一个复杂的聚合实体并且您没有豪华/灵活性来修改您的数据库表以适应您的域模型，那么它们可以派上用场。在这种情况下，使用 Linq-to-SQL 或其他 ORM 可能会导致一组性能非常差的数据库调用来构建您的实体。存储过程可以在这里救援。

当然，我会提倡使用像 TDD/BDD 这样的方法或流程，它可以让您灵活地根据需要修改数据库表，而不会带来太大的痛苦。在我看来，这始终是更容易、更易于维护的路径。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2009-01-06T20:16:14.917

简单的例子：

```
select * from Products where GetCategoryType(CategoryName)=1 
```

GetCategoryType 可以运行得非常快，因为它运行在数据库服务器上。据我所知，没有 Linq to SQL 可以替代它。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2009-03-12T09:09:55.777

我来这个线程很晚。但取决于你与谁交谈，Linq to SQL 要么[死了](http://ayende.com/Blog/archive/2008/10/31/microsoft-kills-linq-to-sql.aspx)，要么[死了](http://codebetter.com/blogs/david.hayden/archive/2008/10/31/linq-to-sql-is-dead-read-between-the-lines.aspx)，要么[充其量是僵尸](http://www.infoq.com/news/2008/11/DLINQ-Future)。

此外，没有一种工具适合所有情况 - 您需要为手头的特定工作选择正确的工具：

*   存储过程使您能够跨多个客户端应用程序实施复杂的业务规则。
*   存储过程可以为您提供出色的安全层。
*   存储过程可以为您提供一个很好的抽象层。
*   [在某些情况下，](https://stackoverflow.com/questions/274411/do-stored-procedures-really-boost-performance-in-ms-sql-net/275010#275010)存储过程可以为您提供更好的缓存。

# unix - 如何进行批量重命名？

> ID：417916
> 
> 赞同：28
> 
> 时间：2009-01-06T20:10:47.530
> 
> 标签：unix, shell, rename

我需要像这样重命名文件名

```
transform.php?dappName=Test&transformer=YAML&v_id=XXXXX 
```

就这个

```
XXXXX.txt 
```

我该怎么做？

我知道我需要多个`mv`命令，因为它们至少有 25000 个文件。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-01-06T20:56:48.000

最简单的解决方案是使用[“mmv”](http://manpages.ubuntu.com/manpages/precise/man1/mmv.1.html)

你可以写：

```
mmv "long_name*.txt" "short_#1.txt" 
```

其中“#1”被第一个通配符匹配的任何内容替换。类似地，#2 被第二个替换，依此类推。

所以你做类似的事情

```
mmv "index*_type*.txt" "t#2_i#1.txt" 
```

将 index1_type9.txt 重命名为 t9_i1.txt

mmv 在许多 Linux 发行版中不是标准的，但在网上很容易找到。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-06T20:30:58.240

如果您使用的是 zsh，您也可以这样做：

```
autoload zmv
zmv 'transform.php?dappName=Test&transformer=YAML&v_id=(*)' '$1.txt' 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-06T20:24:23.823

您编写了一个相当简单的 shell 脚本，其中最棘手的部分是修改名称。

脚本的大纲很简单（此处为 bash 语法）：

```
for i in 'transform.php?dappName=Test&transformer=YAML&v_id='*
do
    mv $i <modified name>
done 
```

修改名称有很多选择。我认为最简单的可能是 awk 单行

```
`echo $i  |  awk -F'=' '{print $4}'` 
```

所以...

```
for i in 'transform.php?dappName=Test&transformer=YAML&v_id='*
do
    mv $i `echo $i |  awk -F'=' '{print $4}'`.txt 
done 
```

### 更新

好的，如下所述，这不一定适用于足够大的文件列表；* 将超出命令行长度限制。所以，然后你使用：

```
$ find . -name 'transform.php?dappName=Test&transformer=YAML&v_id=*' -prune -print |
while read
do
    mv $reply `echo $reply |  awk -F'=' '{print $4}'`.txt 
done 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-06T20:21:30.833

尝试[重命名命令](http://linux.die.net/man/1/rename)

或者您可以将 ls 的结果通过管道传输到 perl 正则表达式中。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-06T20:25:49.717

您可以使用任何您想要转换的名称（perl、sed、awk 等）。我将使用 python 单线：

```
for file in 'transform.php?dappName=Test&transformer=YAML&v_id='*; do 
    mv $file `echo $file | python -c "print raw_input().split('=')[-1]"`.txt;
done 
```

这是完全用 Python 编写的相同脚本：

```
import glob, os
PATTERN="transform.php?dappName=Test&transformer=YAML&v_id=*"

for filename in glob.iglob(PATTERN):
      newname = filename.split('=')[-1] + ".txt"
      print filename, '==>', newname
      os.rename(filename, newname) 
```

旁注：您可以更轻松地保存具有正确名称的页面，同时抓住它们......

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-06T21:11:05.943

```
find -name '*v_id=*' | perl -lne'rename($_, qq($1.txt)) if /v_id=(\S+)/' 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-08-13T04:26:25.877

[vimv](https://github.com/thameera/vimv)允许您使用 Vim 的文本编辑功能重命名多个文件。

输入`vimv`会打开一个列出所有文件的 Vim 窗口，您可以进行模式匹配、视觉选择等来编辑名称。退出 Vim 后，文件将被重命名。

[免责声明：我是该工具的作者]

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-04-12T04:57:47.467

我会使用[ren-regexp](https://github.com/msabramo/ren-regexp)，这是一个 Perl 脚本，可让您非常轻松地批量重命名文件。

```
21:25:11 $ ls
transform.php?dappName=Test&transformer=YAML&v_id=12345

21:25:12 $ ren-regexp 's/transform.php.*v_id=(\d+)/$1.txt/' transform.php*

  transform.php?dappName=Test&transformer=YAML&v_id=12345
1 12345.txt

21:26:33 $ ls
12345.txt 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-10-04T16:49:56.233

这个[重命名器](https://github.com/75lb/renamer)命令会这样做：

```
$ renamer --regex --find 'transform.php?dappName=Test&transformer=YAML&v_id=(\w+)' --replace '$1.txt' * 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-12-24T20:37:23.667

这也应该有效：

prfx='transform.php?dappName=Test&transformer=YAML&v_id='

ls $prfx* | sed s/$prfx// | xargs -Ipsx mv "$prfx"psx psx

* * *

## 回答 #11

> 赞同：-9
> 
> 时间：2009-01-06T21:00:34.403

好的，您需要能够为此运行 Windows 二进制文件。

但是，如果您可以运行[Total Commander](http://www.ghisler.com/)，请执行以下操作：

1.  选择所有带 * 的文件，然后**按 ctrl-M**

2.  在**搜索**字段中，粘贴“transform.php?dappName=Test&transformer=YAML&v_id="

    （**将替换**留空）

3.  按**开始**

没有比这更简单的了。您还可以通过此对话框使用正则表达式重命名，并且您会看到文件将如何重命名的实时预览。

# c# - How to filter the following listboxes in asp.net?

> ID：417944
> 
> 赞同：0
> 
> 时间：2009-01-06T20:16:42.060
> 
> 标签：c#, asp.net, listbox

I have 4 listboxes (lstStates, lstCounties, lstCities, and lstZipcodes). Here are a few constraints:

*   None of the listboxes are disabled.

*   Any listbox can be selected at anytime, meaning there is no specific order the user has to choose.

*   Filtering is forward and backwards. By this, I mean if a user selects a state from lstStates, it will filter lstCounties, lstCities, and lstZipcodes. If a user selects a zipcode from lstZipcodes, it will filter lstCities, lstCounties, and lstStates.

*   The listboxes allow multiple selections.

Each listbox is bound to a datatable to get its initial data. The datatable is retrieved from a sqlserver stored procedure. Each listbox has its own stored procedure, for example, lstStates has one called GetStates which returns one column (State) and the ListBoxes DataValueField and DataTextField are both set to State. Similar to lstStates, lstCities is bound to a datatable which gets one column from a GetCities stored proc which is city.

Another thing I want to point out is that I am connecting an ObjectDataSource to get the datatable.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T20:27:26.750

Already been asked: [What is the most efficient way to filter listboxes based on selections of another in c#?](https://stackoverflow.com/questions/381396/what-is-the-most-efficient-way-to-filter-listboxes-based-on-selections-of-another)

[edit] OK, what you need to do is add an event to each [myListbox]_SelectedIndexChanged event. When the selection is changed you'll need to refresh all the other listboxes based on those selections. I assume that this will need to be handled by the database, since linking States to ZipCodes any other way would be ugly. So presumably your data for States<-->Zips<-->Counties relationships is in your db somewhere.

So you'll need to have procs in your db (or LINQ middle layer) that get States by Zips and so on. On each selection changed event, send the new selection back to the db sproc and then rebind the listbox based on the return data. You should be able to make one sproc for each one that returns all states if no zip is passed in and so on. [/edit]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T20:47:54.603

To clarify, on your initial load of the page, you are loading ALL zipcodes, ALL cities, ALL states and ALL countries?

This seems a bit cumbersome to me. This is the type of requirement I would question. (Granted I don't know that you didn't already question it or that some good answer came from it).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-08T10:53:41.663

ScriptManager.RegisterStartupScript(Page, Page.GetType(), "bab", "CacheItems();", true);

var ddlText, ddlValue, ddl, lblMesg; function CacheItems() { ddlText = new Array(); ddlValue = new Array(); ddl = document.getElementById(""); for (var i = 0; i

# .net-2.0 - 一个 IIS6 .NET 应用程序如何显示为另一个的子站点？

> ID：417951
> 
> 赞同：1
> 
> 时间：2009-01-06T20:18:16.270
> 
> 标签：.net-2.0, iis-6

SiteA.com 和 siteB.com 是 IIS6 上的 .NET 2.0 应用程序。SiteA 使用 SSL。

我可以进行设置以便 siteA.com/train 将人们带到 siteB.com 吗？

有多种方法可以做到这一点吗？如何配置好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T20:26:46.050

转到我的电脑，右键+鼠标+单击并选择管理。转到 IIS/网站并打开您的 sitename.com 网站。导航到目录 sitename.com/train。右键+鼠标+点击火车文件夹并选择“属性”。在“目录”属性下单击“创建”。我想这就是你要找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T20:29:38.303

您不能让站点的子目录指向根目录，也不能有两个具有相同域名的站点实例——www.sitename.com 的 DNS 记录正好指向一个 IP 地址。我认为您最好使用[http://train.sitename.com](http://train.sitename.com)之类的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-02T20:02:17.710

实际上，您可以拥有两个具有相同域的站点实例，一个可以与 www.domain.com 一起使用，而另一个只能在 domain.com 上使用。DNS可以区分这两者。

# c# - C# 字符串比较：CurrentCultureIgnoreCase 和 InvariantCultureIgnoreCase 之间的区别

> ID：417954
> 
> 赞同：39
> 
> 时间：2009-01-06T20:19:02.023
> 
> 标签：c#, string, comparison

在 C# 中进行字符串比较时，执行

```
string test = "testvalue";
test.Equals("TESTVALUE", StringComparison.CurrentCultureIgnoreCase); 
```

和

```
string test = "testvalue";
test.Equals("TESTVALUE", StringComparison.InvariantCultureIgnoreCase); 
```

...无论如何，包含那个额外的参数是否重要？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-06T20:50:38.730

其他帖子给出了很好的建议，但我认为展示一个肯定会有所作为的例子可能会很好：

```
using System;
using System.Globalization;
using System.Threading;

class Test
{
    static void Main()
    {
        CultureInfo turkish = CultureInfo.CreateSpecificCulture("tr");
        Thread.CurrentThread.CurrentCulture = turkish;                

        // In Turkey, "i" does odd things
        string lower = "i";
        string upper = "I";

        // Prints False
        Console.WriteLine(lower.Equals(upper, 
            StringComparison.CurrentCultureIgnoreCase));
        // Prints True
        Console.WriteLine(lower.Equals(upper, 
            StringComparison.InvariantCultureIgnoreCase));
    }
} 
```

（毫无疑问还有很多其他案例——这只是我想到的第一个案例。）

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-06T20:27:24.923

微软为何时使用该`InvariantCulture`属性提供了一些体面的指导：

[MSDN：CultureInfo.InvariantCulture 属性](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.invariantculture.aspx)

> ...应用程序应仅将不变区域性用于需要与区域性无关的结果的过程，例如格式化和解析保存到文件的数据。在其他情况下，它产生的结果可能在语言上不正确或在文化上不合适。
> 
> **安全注意事项**
> 
> 如果将根据字符串比较或大小写更改的结果做出安全决定，则您的应用程序应使用忽略大小写的序数比较，而不是使用 InvariantCulture。[...]
> 
> **字符串操作**
> 
> 如果您的应用程序需要执行不受 CurrentCulture 值影响的区域性敏感字符串操作，则应使用接受 CultureInfo 参数的方法。[...]
> 
> **持久化数据**
> 
> InvariantCulture 属性对于存储不会直接向用户显示的数据很有用。以与区域性无关的格式存储数据可确保已知格式不会更改。当来自不同文化的用户访问数据时，可以根据特定用户进行适当的格式化。[...]

# javascript - 为什么 JS 预加载似乎比常规图像引用要花费更长的时间来加载？

> ID：417958
> 
> 赞同：2
> 
> 时间：2009-01-06T20:20:19.383
> 
> 标签：javascript, prototype

我有一堆图像，我在循环中预加载。其中一张
图片也由 html 加载，因此我很好地了解了
这两种不同方法的执行方式。为了测量，我
在清除缓存后使用 Safari Web Inspector 的网络窗格。

ClownFish图片为280KB，被HTML引用时
加载需要14ms，而JS在预加载中引用的Aurora图片为
116KB，加载需要77ms。

```
var images = ['Aurora', 'ClownFish', 'DewDrop', 'EarthHorizon',  'FlowingRock', 'GentleRapids', 'GoldenPalace'];
images.each(function(elm){
    var path = elm + '.jpg';
    var preload = new Image();
    preload.setAttribute('src',path);
}); 
```

这是设置 Image() 然后将
src 分配给它的所有开销吗？有什么办法可以加快这个速度吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T13:19:19.173

您是否检查过 Firefox 中是否也是这种情况（使用 Firebug）？这些加载时间是检索图像本身需要多长时间？或者从请求开始到加载图像需要多长时间？

如果是后者，它可能与页面上加载 javascript 的位置/时间有关，或者浏览器已经对图像所在的域有太多请求，并且必须等到其中一些请求完成才能预加载图像.

如果您根本不预加载图像，我也很想知道加载时间有多长。如果它们是由 html 加载的，您是否会获得所有图像的低加载时间？如果不是，那么可能是 Web 服务器的问题。

# svn - SVN 仅从标签中导出更改的文件

> ID：417960
> 
> 赞同：6
> 
> 时间：2009-01-06T20:20:33.300
> 
> 标签：svn

有谁知道如何使用 svn 仅导出两个标签中更改的文件？

假设我有标签 1.0，然后在后备箱中修复错误。接下来我准备好发布一个新的补丁，所以我将它标记为 1.1。现在我想导出标签 1.0 和 1.1 之间更改的文件。这可能吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-06T20:30:06.620

svn diff --summarize url/to/tag1.0 url/to/tag1.1

将为您提供在这两个标签之间更改的文件列表。您应该能够在脚本中解析该列表并单独导出每个文件

svn 导出 url/to/file 文件路径

或者

svn cat url/to/file > 文件

如果你使用 TortoiseSVN：

*   打开存储库浏览器，浏览到tag1.0，右键单击，选择“标记进行比较”
*   浏览到tag1.1，右键单击，选择“比较网址”
*   在文件差异对话框中，选择在标签之间更改的所有文件/文件夹 (Ctrl+A)
*   右键单击，选择“导出到...”

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-03-31T05:56:54.123

这是[我](http://twitter.com/_AndrewRussell/status/1171329601)对 TortoiseSVN 的解决方案：

*   打开回购浏览器。
*   右键单击 tag1 并选择“标记以进行比较”
*   右键单击 tag2 并选择“比较 URL”
*   在文件列表中全选 (Ctrl+A)
*   右键单击并“将选择导出到...”
*   输入目标目录并按 OK

最终导出的是您需要在现有导出顶部写入以更新它的所有文件（不要搞乱应用差异）。例如，用于通过 FTP 更新网站。

唯一需要注意的是，它显然不会处理已删除的文件。尽管它至少会告诉您哪些文件需要手动删除。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-06-10T09:19:10.483

1.  使用 TortoiseSVN，右键单击您的工作文件夹并从 TortoiseSVN 菜单中选择“显示日志”。

2.  单击上次发布的修订版（本例中为#85）

3.  Ctrl+单击 HEAD 修订版（或您要发布的任何修订版，即 #178），以便突出显示旧修订版和新修订版。

4.  右键单击任一突出显示的修订，然后选择“比较修订”。这将打开一个对话框窗口，列出所有新的/修改的文件。

5.  从此列表中选择所有文件 (Ctrl+a)，然后右键单击突出显示的文件并选择“将选择导出到...”</p>

资料来源： [http ://www.verysimple.com/blog/2007/09/06/using-tortoisesvn-to-export-only-newmodified-files/](http://www.verysimple.com/blog/2007/09/06/using-tortoisesvn-to-export-only-newmodified-files/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T20:28:43.283

svn diff 可以创建一个差异来表示标签之间的变化。您可以使用补丁实用程序应用该差异。

[http://svnbook.red-bean.com/en/1.0/re09.html](http://svnbook.red-bean.com/en/1.0/re09.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-12T03:39:05.007

我们也需要这样的东西。所以我写了一个小的java工具。

希望它对某人有用：[github svn-diff-export](http://github.com/philipgloyne/svn-diff-export)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-08T14:15:28.763

基于 Stefan 的想法：

```
REV=123456
URL=https://...
BASEDIR=some_dir
svn diff --summarize -c $REV $URL | while read A B; do 
    svn cat -r $REV $B > ${B##*$BASEDIR}
done 
```

# cocoa-touch - 在 iPhone 应用程序中操作文本字段值

> ID：417963
> 
> 赞同：1
> 
> 时间：2009-01-06T20:21:17.823
> 
> 标签：cocoa-touch

如何在 iPhone 应用程序中操作文本字段变量？我想要三个文本字段，仅格式化为数字，并且当我按下不同的按钮时能够操作数据。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T20:49:43.817

UITextField 对象有一个可以读写的 NSString 类型的“文本”属性。保留对文本字段的引用，当按下按钮时，使用新的 NSString 更新字段的文本属性以更改其内容。如果用户不能直接编辑文本字段，您可能希望使用 UILabel 代替，它基本上只是一个不可编辑的文本字段（并且还具有读/写“文本”属性）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T21:13:55.377

您可能还想了解`NSNumberFormatter`允许您将输入格式化为与您的应用程序相关的任何方式（货币值、浮点数等）的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T18:10:35.550

要解决编辑某些文本字段的问题，您可以在按下按钮之前禁用用户交互。

# c# - 根据下拉菜单在gridview中显示结果数？

> ID：417988
> 
> 赞同：1
> 
> 时间：2009-01-06T20:26:17.110
> 
> 标签：c#, asp.net, gridview, datatable

我有一个返回大约 30,000 条记录的数据表。我在 ASP:GridView 控件中显示这些记录。我有一个下拉控件，我希望用户能够在其中选择要在 GridView 中显示的记录数。默认值应该是全部，但它也可以具有诸如 20、50、100 之类的值。我不太确定该怎么做。

如果我没有打开分页怎么办。PageSize 还能用吗？

我对 GridView.PageSize = 1 进行了硬编码，它仍然返回了所有记录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T20:29:18.680

使用 gridview 的 PageSize 属性。[链接](http://www.codeproject.com/KB/grid/GridView_pager.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T20:31:23.310

您可以将下拉列表的值 (20, 50, 100) 添加到查询中，以便仅选择顶部 (20, 50, 100) 记录。

你也要使用分页吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T22:16:51.303

在数据选择中，分页应该总是尽可能早地处理。您不想从数据库检索 30,000 条记录到应用服务器，然后只显示其中的 50 条。

类似于：（用于选择第 3 页，每页 50 个）

```
select top 50 from x where pk not in (select top 100 pk from x) 
```

翻译为：

```
CREATE PROCEDURE sspGetItems (@pageSize int, @pageNum int)
AS
SELECT TOP @pageSize 
FROM x
WHERE pk NOT IN 
(
 SELECT TOP (@pageNum - 1) * @pageSize pk FROM x
) 
```

显然，在排序等方面需要更加小心。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T01:09:12.827

如果您希望 PageSize 有效，您**必须**将 GridView 的 AllowPaging 设置为 true。显然，您必须创建管理事件 PageIndexChanging 的方法。

像这样：

```
protected void myGvw_OnPageIndexChanging(object sender, GridViewPageEventArgs e) 
{
     myGvw.PageIndex = e.NewPageIndex;
     // then recall the method that bind myGvw
} 
```

DropDown 可以将属性 AutoPostBack 设置为 true 并且您必须在他的 OnSelectedIndexChanged 上设置

```
myGvw.PageSize = Convert.ToInt32(myDropDown.SelectedValue) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T20:47:09.657

这就是我要做的。首先，我会在 DataTable 中添加一个列，如果它还没有的话，它将作为一个计数器。然后，将 GridView 绑定到 DataView。这是一些代码来演示我在说什么：

```
 //add column with counter
            table.Columns.Add("counter", typeof(int));
            for (int i = 0; i < table.Rows.Count; i++)
            {
                table.Rows[i]["counter"] = i+1;
            } 
```

然后，从 DataTable 中获取默认视图并设置 RowFilter：

```
 DataView view = table.DefaultView;
            view.RowFilter = "counter <= 100"; //or whatever number the user selected 
```

最后，只需将 GridView 直接绑定到 DataView 即可。

# sharepoint - 跨子站点共享 Sharepoint 列表

> ID：417996
> 
> 赞同：1
> 
> 时间：2009-01-06T20:28:18.743
> 
> 标签：sharepoint, sharepoint-2007

我有一种情况，我想在 Sharepoint 站点的顶层有一个主列表，然后允许子站点查看主列表。我尝试过使用内容类型，要么我很慢，只是无法理解这个概念，要么它似乎不适用。

有人有运气吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T20:55:24.900

这取决于您所说的“查看”主列表的含义。

如果您正在编写代码来访问它，您可以通过获取`SPWeb`顶级站点的对象并使用它的`Lists`属性来做到这一点。

如果您只想在 Web 部件页面上显示它，您可以使用内容查询 Web 部件来实现。

如果您想以某种方式在其他列表中使用它，这是一个更复杂的问题。您绝对可以将查找列设置为指向其他站点中的列表，但我们仅通过自定义站点和列表定义来完成此操作。

此外，如果您想重用主列表中的某些文本或 HTML，并且您正在使用 MOSS，则网站集顶部网站中的可重用内容列表很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T01:30:03.273

我听说一些 Web 部件可以在位于不同站点的列表之间建立关系。但在主站点和子站点之间寻求锐化列表关系是新的。我不确定这种关系是否可以视为跨站点，如果是肯定的，请查看[Sharepoint Cross-site Lookup](http://www.boostsolutions.com/Cross-SiteLookup.html)。否则对我来说，你的要求是一个“涉及的问题”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T17:28:57.857

您还可以使用数据视图 Web 部件来提供来自其他站点的列表数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T07:59:01.710

如果您希望能够有一个查找列，请在更高级别站点的另一个列表中查找。您可以在更高级别的站点创建一个站点列（在站点设置下），它是所谓的主列表的查找字段。然后在子网站的列表中，您可以添加网站栏，然后选择您之前创建的网站栏。

# java - 使用超类的构造函数

> ID：417999
> 
> 赞同：1
> 
> 时间：2009-01-06T20:29:07.150
> 
> 标签：java, inheritance, constructor, super

Java不允许多重继承，这意味着一个类不能从两个没有共同点的类继承，这意味着它们不在同一继承路径上。但是，如果这些类是该类的直接超类的超类，则一个类可以继承自更多类。但是该类间接地从这些类继承，这意味着它不会从这些上层超类中“看到”任何东西，对吧？在考虑构造函数时我很困惑（在构造函数中使用 super() ）。例如，如果我们有以下类：

```
public class A {
    public A() { 
      .... 
    }
}

public class B extends A {
    public B() {
      super();
      ....
    }
}

public class C extends B {
    public C() {
      super();
      ....
   }
} 
```

C 类的构造函数首先使用 super() 调用 B 类的构造函数。发生这种情况时，B 的构造函数本身首先调用 A 的构造函数（使用 super()），但是 C 的构造函数对 A 的构造函数一无所知，对吧？我的意思是，继承仅来自直接超类——继承层次结构中的第一个（最近的）类。这是我的问题——对于 super()，我们仅指直接超类的构造函数，无论继承层次结构中有多少其他类。这不仅适用于构造函数，还适用于任何方法和实例变量。

问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T20:37:51.503

您必须在直接基类中调用*一些*构造函数。这可以是

```
public class A {
     public A() { 
      .... 
     }
    public A(String foo) { 
      .... 
    }
}

public class B extends A {
    public B() {
        super();
        .. or ..
        super("ThisIsAB")
    }
}

public class C extends B {
    public C() {
      super();
      ....
   }
} 
```

因此，对于构造函数，您不能避免构造中间基类，但您可以选择使用哪个构造函数。如果只有 no-args 构造函数，它会通过对 super 的隐式调用为您处理。使用多个构造函数，您有更多选择。

super 可以引用任何基类中的任何非私有变量或方法。所以方法和变量在这方面和构造函数是不一样的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T20:49:57.733

即使您*可以避免*调用中间 ctor，您也不希望这样做，因为这意味着您有未初始化的中间类片段，这些片段可能会被最底层的派生类访问。到可怕的影响。

但我感觉到您正试图在 Java 中欺骗您的方式来进行多重继承。那是一件坏事。相反，您可以通过使用接口以 Java 方式执行此操作

```
class B extends A implements C {
    // ... implement C methods here
} 
```

或通过使用聚合

```
class B extends A {
    private C c;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T20:39:26.867

调用所有父母的构造函数。事实上，C 深知 A 是因为 B 扩展了 A。例如，如果类 A 包含方法 foo()，那么您可以从 C 调用 foo()。

因此，从您的示例中，C 从 B 调用构造函数，它从 A 调用构造函数。此外，A 还从类 Object 扩展。所以Object类中的构造函数也被调用了！

此外，您不需要添加对 super() 的调用。如果没有调用父级的构造函数，则隐式调用 super。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T20:33:20.623

正如您所说，C 的构造函数调用 B 的构造函数，该构造函数调用 A 的构造函数。您可以在 C 对象上调用任何“A”方法，并且 C 对象可以看到 A 中的非私有字段。

即使您在 C 中覆盖 A 的方法“foo”，您也可以使用“super.foo()”获得 A 版本，假设 B 也不会覆盖它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T20:44:17.073

据 C 所知，它在 C 中未覆盖的任何内容都包含在 B 中，即使在幕后 A 可能是实现的地方。

```
public class A {
   public A() {
   }

   public void aMethod() {
   }
}

public class B extends A {
   public B() {
     super();
   }
}

public class C extends B {
   public C() {
     super();
   }

   public void doWork() {
     super.aMethod();
   }
} 
```

所以在这种情况下，A 处理 aMethod() 的实现，即使在 C 的构造函数中调用 super() 直接调用 B 的构造函数，而不是 A 的构造函数。*********************