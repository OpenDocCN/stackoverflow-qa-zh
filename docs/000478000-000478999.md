# StackOverflow 问答 000478000-000478999

# php - PHP 数组 - 删除重复项（时间复杂度）

> ID：478002
> 
> 赞同：12
> 
> 时间：2009-01-25T18:05:36.670
> 
> 标签：php, algorithm, time-complexity

好的，这不是“如何获取所有唯一性”或“如何在 php 中从我的数组中删除重复项”的问题。这是一个关于时间复杂度的问题。

我认为`array_unique`有点 O(n^2 - n) ，这是我的实现：

```
function array_unique2($array) 
{ 
    $to_return = array(); 
    $current_index = 0;

    for ( $i = 0 ; $i < count($array); $i++ ) 
    { 
        $current_is_unique = true; 

        for ( $a = $i+1; $a < count($array); $a++ ) 
        { 
            if ( $array[$i] == $array[$a] ) 
            { 
                $current_is_unique = false; 
                break; 
            } 
        } 
        if ( $current_is_unique ) 
        { 
            $to_return[$current_index] = $array[$i];
        } 

    } 

    return $to_return; 
} 
```

但是，当对此进行基准测试时，`array_unique`我得到了以下结果：

测试 (array_unique2)... 操作耗时 0.52146291732788 秒。

测试 (array_unique)... 操作耗时 0.28323101997375 秒。

这使得 array_unique 快两倍，我的问题是，为什么（两者都有相同的随机数据）？

我的一个朋友写道：

```
function array_unique2($a)
{
    $n = array();
    foreach ($a as $k=>$v)
        if (!in_array($v,$n))
            $n[$k]=$v;
    return $n;
} 
```

这比 php.ini 中内置的快一倍。

我想知道，为什么？

array_unique 和 in_array 的时间复杂度是多少？

**编辑** 我从两个循环中删除了 count($array) 并在函数顶部使用了一个变量，它在 100 000 个元素上获得了 2 秒！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-25T18:40:59.780

虽然我不能说原生的 array_unique 函数，但我可以告诉你，你的朋友算法更快，因为：

1.  他使用单个 foreach 循环，而不是您的双 for() 循环。
2.  Foreach 循环往往比 PHP 中的 for 循环执行得更快。
3.  他使用了一个 if(!) 比较，而您使用了两个 if() 结构
4.  您的朋友调用的唯一附加函数是 in_array，而您调用了 count() 两次。
5.  你做了三个你的朋友不需要的变量声明 ($a, $current_is_unique, $current_index)

虽然这些因素本身都不是很大，但我可以看到累积效应会使您的算法比您的朋友花费更长的时间。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-25T20:14:09.187

的时间复杂度`in_array()`为*O(n)*。要了解这一点，我们将看一下[PHP 源代码](http://www.php.net/get/php-5.2.8.tar.gz/from/a/mirror)。

该`in_array()`功能在`ext/standard/array.c`. 它所做的只是 call `php_search_array()`，其中包含以下循环：

```
while (zend_hash_get_current_data_ex(target_hash, (void **)&entry, &pos) == SUCCESS) {

    // checking the value...

    zend_hash_move_forward_ex(target_hash, &pos);
} 
```

这就是线性特征的来源。

这是算法的整体特征，因为`zend_hash_move_forward_ex()`具有恒定的行为： 看`Zend/zend_hash.c`，我们看到它基本上只是

```
*current = (*current)->pListNext; 
```

* * *

至于 的时间复杂度`array_unique()`：

*   首先，将创建一个数组的副本，这是一个具有*线性*特征的操作
*   然后，`struct bucketindex`将创建一个 C 数组，并将指向我们数组副本的指针放入这些桶中 -再次*线性*特征
*   然后，`bucketindex`-array 将被排序使用快速排序 - *n `log`n*平均
*   最后，排序后的数组将被遍历，并且重复的条目将从我们的数组副本中删除 - 这应该再次是*线性*的，假设从我们的数组中删除是一个常数时间操作

希望这可以帮助 ;）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-25T18:45:16.183

试试这个算法。它利用了键查找比 in_array() 更快的事实：

```
function array_unique_mine($A) {
    $keys = Array();
    $values = Array();
    foreach ($A as $k => $v) {
        if (!array_key_exists($v, $values)) {
            $keys[] = $k;
            $values[$v] = $v;
        }
    }
    return array_combine($keys, $values);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-25T21:55:58.607

[加布里埃尔的](https://stackoverflow.com/users/20178/gabriel1836) [回答](https://stackoverflow.com/questions/478002/php-arrays-remove-duplicates-time-complexity#478032)对为什么您朋友的方法胜过您的方法有一些重要意义。[对Christoph](https://stackoverflow.com/users/48015/christoph) [回答](https://stackoverflow.com/questions/478002/php-arrays-remove-duplicates-time-complexity#478034)后的对话很感兴趣，我决定自己进行一些测试。

另外，我尝试了不同长度的随机字符串，虽然结果不同，但顺序是一样的。为简洁起见，我在此示例中使用了 6 个字符。

请注意，array_unique5 实际上与 native 具有相同的键，2 和 3，但只是以不同的顺序输出。

结果...

```
Testing 10000 array items of data over 1000 iterations:
array_unique6:  1.7561039924622 array ( 9998 => 'b',    9992 => 'a',    9994 => 'f',    9997 => 'e',    9993 => 'c',    9999 => 'd',    )
array_unique4:  1.8798060417175 array ( 0 => 'b',   1 => 'a',   2 => 'f',   3 => 'e',   4 => 'c',   5 => 'd',   )
array_unique5:  7.5023629665375 array ( 10 => 'd',  0 => 'b',   3 => 'e',   2 => 'f',   9 => 'c',   1 => 'a',   )
array_unique3:  11.356487989426 array ( 0 => 'b',   1 => 'a',   2 => 'f',   3 => 'e',   9 => 'c',   10 => 'd',  )
array_unique:   22.535032987595 array ( 0 => 'b',   1 => 'a',   2 => 'f',   3 => 'e',   9 => 'c',   10 => 'd',  )
array_unique2:  62.107122898102 array ( 0 => 'b',   1 => 'a',   2 => 'f',   3 => 'e',   9 => 'c',   10 => 'd',  )
array_unique7:  71.557286024094 array ( 0 => 'b',   1 => 'a',   2 => 'f',   3 => 'e',   9 => 'c',   10 => 'd',  ) 
```

和代码...

```
set_time_limit(0);
define('HASH_TIMES', 1000);

header('Content-Type: text/plain');

$aInput  = array();
for ($i = 0; $i < 10000; $i++) {
    array_push($aInput, chr(rand(97, 102)));
}

function array_unique2($a) {
    $n = array();
    foreach ($a as $k=>$v)
        if (!in_array($v,$n))
            $n[$k]=$v;
    return $n;
}

function array_unique3($aOriginal) {
    $aUnique = array();

    foreach ($aOriginal as $sKey => $sValue) {
        if (!isset($aUnique[$sValue])) {
            $aUnique[$sValue] = $sKey;
        }
    }

    return array_flip($aUnique);
}

function array_unique4($aOriginal) {
    return array_keys(array_flip($aOriginal));
}

function array_unique5($aOriginal) {
    return array_flip(array_flip(array_reverse($aOriginal, true)));
}

function array_unique6($aOriginal) {
    return array_flip(array_flip($aOriginal));
}

function array_unique7($A) {
    $keys = Array();
    $values = Array();
    foreach ($A as $k => $v) {
        if (!array_key_exists($v, $values)) {
            $keys[] = $k;
            $values[$v] = $v;
        }
    }
    return array_combine($keys, $values);
}

function showResults($sMethod, $fTime, $aInput) {
    echo $sMethod . ":\t" . $fTime . "\t" . implode("\t", array_map('trim', explode("\n", var_export(call_user_func($sMethod, $aInput), 1)))) . "\n";
}

echo 'Testing ' . (count($aInput)) . ' array items of data over ' . HASH_TIMES . " iterations:\n";

$fTime = microtime(1);
for ($i = 0; $i < HASH_TIMES; $i++) array_unique($aInput);
$aResults['array_unique'] = microtime(1) - $fTime;

$fTime = microtime(1);
for ($i = 0; $i < HASH_TIMES; $i++) array_unique2($aInput);
$aResults['array_unique2'] = microtime(1) - $fTime;

$fTime = microtime(1);
for ($i = 0; $i < HASH_TIMES; $i++) array_unique3($aInput);
$aResults['array_unique3'] = microtime(1) - $fTime;

$fTime = microtime(1);
for ($i = 0; $i < HASH_TIMES; $i++) array_unique4($aInput);
$aResults['array_unique4'] = microtime(1) - $fTime;

$fTime = microtime(1);
for ($i = 0; $i < HASH_TIMES; $i++) array_unique5($aInput);
$aResults['array_unique5'] = microtime(1) - $fTime;

$fTime = microtime(1);
for ($i = 0; $i < HASH_TIMES; $i++) array_unique6($aInput);
$aResults['array_unique6'] = microtime(1) - $fTime;

$fTime = microtime(1);
for ($i = 0; $i < HASH_TIMES; $i++) array_unique7($aInput);
$aResults['array_unique7'] = microtime(1) - $fTime;

asort($aResults, SORT_NUMERIC);
foreach ($aResults as $sMethod => $fTime) {
    showResults($sMethod, $fTime, $aInput);
} 
```

使用来自评论[的 Christoph](https://stackoverflow.com/users/48015/christoph)数据集的结果：

```
$aInput = array(); for($i = 0; $i < 1000; ++$i) $aInput[$i] = $i; for($i = 500; $i < 700; ++$i) $aInput[10000 + $i] = $i;

Testing 1200 array items of data over 1000 iterations:
array_unique6:  0.83235597610474
array_unique4:  0.84050011634827
array_unique5:  1.1954448223114
array_unique3:  2.2937450408936
array_unique7:  8.4412341117859
array_unique:   15.225166797638
array_unique2:  48.685120105743 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T18:41:49.357

PHP 的数组被实现为哈希表，即它们的性能特征与您对“真实”数组的期望不同。数组的键值对额外存储在链表中以允许快速迭代。

这解释了为什么您的实现与您朋友的相比如此缓慢：对于每个数字索引，您的算法必须进行哈希表查找，而`foreach()`-loop 只会遍历链表。

以下实现使用反向哈希表，可能是人群中最快的（由*joe_mucchiello*提供双重翻转）：

```
function array_unique2($array) {
    return array_flip(array_flip($array));
} 
```

这仅在 的值`$array`是有效键（即整数或字符串）时才有效。

我还使用`foreach()`-loops 重新实现了您的算法。现在，对于小型数据集，它实际上比您朋友的要快，但仍然比通过以下解决方案慢`array_flip()`：

```
function array_unique3($array) {
    $unique_array = array();

    foreach($array as $current_key => $current_value) {
        foreach($unique_array as $old_value) {
            if($current_value === $old_value)
                continue 2;
        }
        $unique_array[$current_key] = $current_value;
    }

    return $unique_array;
} 
```

对于大型数据集，内置版本`array_unique()`将优于除双翻转版本之外的所有其他版本。此外，`in_array()`您朋友使用的版本会比`array_unique3()`.

总结一下：本机代码取胜！

* * *

还有另一个版本，它应该保留键及其顺序：

```
function array_flop($array) {
    $flopped_array = array();

    foreach($array as $key => $value) {
        if(!isset($flopped_array[$value]))
            $flopped_array[$value] = $key;
    }

    return $flopped_array;
}

function array_unique4($array) {
    return array_flip(array_flop($array));
} 
```

这实际上是*enobrev*的`array_unique3()`- 我没有像我应该做的那样彻底检查他的实现......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-25T18:43:03.257

PHP 的执行速度比原始机器代码（最有可能由 执行`array_unique`）慢。

你的第二个示例函数（你朋友写的那个）很有趣。我看不出它会比原生实现更快，除非原生实现是删除元素而不是构建新数组。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-25T20:15:26.907

我承认我不太了解本机代码，但它似乎复制了整个数组，对其进行排序，然后循环遍历它以删除重复项。在这种情况下，您的第二段代码实际上是一种更有效的算法，因为添加到数组的末尾比从中间删除更便宜。

请记住，PHP 开发人员可能有充分的理由这样做。有人想问他们吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-25T20:32:08.700

本机 PHP 函数`array_unique`是[用 C 实现的](http://www.google.com/search?q=cache%3Ahttp%3A%2F%2Fsvn.php.net%2Fphp-src%2Ftrunk%2Fext%2Fstandard%2Farray.c)。因此它比 PHP 快，必须先翻译。更重要的是，PHP 使用了与您不同的算法。正如我所看到的，PHP 首先使用[快速排序](http://en.wikipedia.org/wiki/Quicksort)对元素进行排序，然后在一次运行中删除重复项。

为什么他朋友的实现更快有他自己的？因为它使用更多的内置功能来尝试重新创建它们。

# java - Java 错误或功能？

> ID：478006
> 
> 赞同：2
> 
> 时间：2009-01-25T18:09:29.220
> 
> 标签：java

好的，这是代码，然后讨论如下：

```
public class FlatArrayList {

    private static ArrayList<TestWrapperObject> probModel = new ArrayList<TestWrapperObject>();

    /**
     * @param args
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub

        int [] currentRow = new int[10];

        int counter = 0;

        while (true) {

          for (int i = 0; i < 10; i++) {
            currentRow[i] = probModel.size();
          }

          TestWrapperObject currentWO = new TestWrapperObject(currentRow);

          probModel.add(counter, currentWO);

          TestWrapperObject testWO = probModel.get(counter);
          // System.out.println(testWO);

          counter++;

          if (probModel.size() == 10) break;

       }

       // Output the whole ArrayList    
       for (TestWrapperObject wo:probModel) {
         int [] currentTestRow = wo.getCurrentRow();
       } 
    }
}

public class TestWrapperObject {

    private int [] currentRow;

    public void setCurrentRow(int [] currentRow) {
        this.currentRow = currentRow;
    }

    public int [] getCurrentRow() {
        return this.currentRow;
    }

    public TestWrapperObject(int [] currentRow) {
        this.currentRow = currentRow;
    }

} 
```

上面的代码应该做什么？我想要做的是加载一个数组作为一些包装对象的成员（在我们的例子中是 TestWrapperObject ）。当我退出循环时，probModel ArrayList 具有它应该具有的元素数量，但都具有与最后一个元素相同的值（一个大小为 10 的数组，每个项目等于 9）。循环内部不是这种情况。如果您使用原始 int 值执行相同的“实验”，则一切正常。关于数组作为对象成员，我自己是否遗漏了一些东西？还是我刚刚遇到了一个 Java 错误？我正在使用 Java 6。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-25T18:12:48.840

您只创建了一个`currentRow`数组实例。将其移动到行循环内，它的行为应该更像您的预期。

具体来说，in 的赋值`setCurrentRow`不会创建对象的*副本*，而只是分配引用。因此，您的包装器对象的每个副本都将包含对同一`int[]`数组的引用。更改该数组中的值将使所有其他包含对同一数组实例的引用的包装对象的值似乎发生更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T19:36:29.217

我不想听起来居高临下，但总是试着记住这本优秀的[实用程序员](http://www.pragprog.com/the-pragmatic-programmer)书中的技巧 #26

> 选择没有损坏

很少能找到java bug。牢记这一点通常可以帮助我再次查看我的代码，将其转过来，并摆脱松散的部分，直到我最终发现我错在哪里。当然，我们也非常鼓励尽早寻求帮助 :)

# c# - 如何创建和访问在 C# 中作为参数传递的匿名类的新实例？

> ID：478013
> 
> 赞同：11
> 
> 时间：2009-01-25T18:18:29.920
> 
> 标签：c#, reflection, anonymous-types

我创建了一个函数，它接受一个 SQL 命令并生成输出，然后可以使用该输出来填充类实例列表。代码效果很好。我在这里包含了一个稍微简化的版本，没有异常处理，仅供参考 - 如果您想直接解决问题，请跳过此代码。但是，如果您在这里有建议，我会全力以赴。

```
 public List<T> ReturnList<T>() where T : new()
    {
        List<T> fdList = new List<T>();
        myCommand.CommandText = QueryString;
        SqlDataReader nwReader = myCommand.ExecuteReader();
        Type objectType = typeof (T);
        FieldInfo[] typeFields = objectType.GetFields();
        while (nwReader.Read())
        {
            T obj = new T();
            foreach (FieldInfo info in typeFields)
            {
                for (int i = 0; i < nwReader.FieldCount; i++)
                {
                    if (info.Name == nwReader.GetName(i))
                    {
                        info.SetValue(obj, nwReader[i]);
                        break;
                    }
                }
            }
            fdList.Add(obj);
        }
        nwReader.Close();
        return fdList;
    } 
```

正如我所说，这很好用。但是，出于显而易见的原因，我希望能够使用*匿名类调用类似的函数。*

问题 #1：看来我必须在调用此函数的匿名版本时构造一个匿名类**实例- 对吗？**一个示例调用是：

```
.ReturnList(new { ClientID = 1, FirstName = "", LastName = "", Birthdate = DateTime.Today }); 
```

问题 #2：我的 ReturnList 函数的匿名版本如下。谁能告诉我为什么对 info.SetValue 的调用什么都不做？它不会返回错误或任何内容，但也不会更改目标字段的值。

```
 public List<T> ReturnList<T>(T sample) 
    {
        List<T> fdList = new List<T>();
        myCommand.CommandText = QueryString;
        SqlDataReader nwReader = myCommand.ExecuteReader();
        // Cannot use FieldInfo[] on the type - it finds no fields.
        var properties = TypeDescriptor.GetProperties(sample); 
        while (nwReader.Read())
        {
            // No way to create a constructor so this call creates the object without calling a ctor. Could this be a source of the problem?
            T obj = (T)FormatterServices.GetUninitializedObject(typeof(T)); 
            foreach (PropertyDescriptor info in properties)  
            {
                for (int i = 0; i < nwReader.FieldCount; i++)
                {
                    if (info.Name == nwReader.GetName(i))
                    {
                        // This loop runs fine but there is no change to obj!!
                        info.SetValue(obj, nwReader[i]);
                        break;
                    }
                }
            }
            fdList.Add(obj);
        }
        nwReader.Close();
        return fdList;
    } 
```

有任何想法吗？

**注意：**当我尝试像在上面的函数中那样使用 FieldInfo 数组时，typeFields 数组的元素为零（即使 objectType 显示了字段名称 - 很奇怪）。因此，我改用 TypeDescriptor.GetProperties。

此处适用于使用反射或匿名类的任何其他提示和指导 - 我对 C# 语言的这个特定角落相对较新。

更新：我必须感谢杰森解决这个问题的关键。下面是修改后的代码，它将创建一个匿名类实例列表，从查询中填充每个实例的字段。

```
 public List<T> ReturnList<T>(T sample)
   {
       List<T> fdList = new List<T>();
       myCommand.CommandText = QueryString;
       SqlDataReader nwReader = myCommand.ExecuteReader();
       var properties = TypeDescriptor.GetProperties(sample);
       while (nwReader.Read())
       {
           int objIdx = 0;
           object[] objArray = new object[properties.Count];
           foreach (PropertyDescriptor info in properties) 
               objArray[objIdx++] = nwReader[info.Name];
           fdList.Add((T)Activator.CreateInstance(sample.GetType(), objArray));
       }
       nwReader.Close();
       return fdList;
   } 
```

请注意，查询已经构建，并且在之前调用此对象的方法时已初始化参数。原始代码具有内部/外部循环组合，因此用户可以在其匿名类中拥有与字段不匹配的字段。但是，为了简化设计，我决定不允许这样做，而是采用了 Jason 推荐的 db 字段访问。此外，还要感谢 Dave Markle 帮助我更多地了解使用 Activator.CreateObject() 与 GenUninitializedObject 的权衡。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-25T18:36:42.787

匿名类型封装了一组*只读*属性。这说明

1.  为什么`Type.GetFields`在匿名类型上调用时返回一个空数组：匿名类型没有公共字段。

2.  匿名类型的公共属性是只读的，不能通过调用来设置它们的值`PropertyInfo.SetValue`。如果您调用`PropertyInfo.GetSetMethod`匿名类型的属性，您将收到返回`null`。

事实上，如果你改变

```
var properties = TypeDescriptor.GetProperties(sample);
while (nwReader.Read()) {
    // No way to create a constructor so this call creates the object without calling a ctor. Could this be a source of the problem?
    T obj = (T)FormatterServices.GetUninitializedObject(typeof(T)); 
    foreach (PropertyDescriptor info in properties) {
        for (int i = 0; i < nwReader.FieldCount; i++) {
            if (info.Name == nwReader.GetName(i)) {
                // This loop runs fine but there is no change to obj!!
                info.SetValue(obj, nwReader[i]);
                break;
            }
        }
    }
    fdList.Add(obj);
} 
```

到

```
PropertyInfo[] properties = sample.GetType().GetProperties();
while (nwReader.Read()) {
    // No way to create a constructor so this call creates the object without calling a ctor. Could this be a source of the problem?
    T obj = (T)FormatterServices.GetUninitializedObject(typeof(T));
    foreach (PropertyInfo info in properties) {
        for (int i = 0; i < nwReader.FieldCount; i++) {
            if (info.Name == nwReader.GetName(i)) {
                // This loop will throw an exception as PropertyInfo.GetSetMethod fails
                info.SetValue(obj, nwReader[i], null);
                break;
            }
        }
    }
    fdList.Add(obj);
} 
```

您将收到一个异常通知您找不到属性设置方法。

现在，要解决您的问题，您可以做的是使用`Activator.CreateInstance`. 很抱歉我懒得给你打代码，但下面将演示如何使用它。

```
var car = new { Make = "Honda", Model = "Civic", Year = 2008 };
var anothercar = Activator.CreateInstance(car.GetType(), new object[] { "Ford", "Focus", 2005 }); 
```

因此，正如您所做的那样，只需运行一个循环来填充您需要传递的对象数组，`Activator.CreateInstance`然后`Activator.CreateInstance`在循环完成时调用。属性顺序在这里很重要，因为两个匿名类型是相同的当且仅当它们具有相同数量的具有相同类型和相同名称的相同顺序的属性。

有关更多信息，请参阅有关匿名类型的[MSDN 页面。](http://msdn.microsoft.com/en-us/library/bb397696.aspx)

最后，这确实是一个旁白，与您的问题无关，但以下代码

```
foreach (PropertyDescriptor info in properties) {
    for (int i = 0; i < nwReader.FieldCount; i++) {
        if (info.Name == nwReader.GetName(i)) {
            // This loop runs fine but there is no change to obj!!
            info.SetValue(obj, nwReader[i]);
            break;
        }
    }
} 
```

可以简化为

```
foreach (PropertyDescriptor info in properties) {
            info.SetValue(obj, nwReader[info.Name]);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-04T17:35:01.980

我有同样的问题，我通过创建一个新的 Linq.Expression 来解决它，它将完成真正的工作并将它编译成一个 lambda：这是我的代码，例如：

我想改变那个电话：

```
var customers = query.ToList(r => new
            {
                Id = r.Get<int>("Id"),
                Name = r.Get<string>("Name"),
                Age = r.Get<int>("Age"),
                BirthDate = r.Get<DateTime?>("BirthDate"),
                Bio = r.Get<string>("Bio"),
                AccountBalance = r.Get<decimal?>("AccountBalance"),
            }); 
```

那个电话：

```
var customers = query.ToList(() => new 
        { 
            Id = default(int),
            Name = default(string),
            Age = default(int), 
            BirthDate = default(DateTime?),
            Bio = default(string), 
            AccountBalance = default(decimal?)
        }); 
```

并从新方法中做 DataReader.Get 东西，第一种方法是：

```
public List<T> ToList<T>(FluentSelectQuery query, Func<IDataReader, T> mapper)
    {
        return ToList<T>(mapper, query.ToString(), query.Parameters);
    } 
```

我必须在新方法中构建一个表达式：

```
public List<T> ToList<T>(Expression<Func<T>> type, string sql, params object[] parameters)
        {
            var expression = (NewExpression)type.Body;
            var constructor = expression.Constructor;
            var members = expression.Members.ToList();

            var dataReaderParam = Expression.Parameter(typeof(IDataReader));
            var arguments = members.Select(member => 
                {
                    var memberName = Expression.Constant(member.Name);
                    return Expression.Call(typeof(Utilities), 
                                           "Get", 
                                           new Type[] { ((PropertyInfo)member).PropertyType },  
                                           dataReaderParam, memberName);
                }
            ).ToArray();

            var body = Expression.New(constructor, arguments);

            var mapper = Expression.Lambda<Func<IDataReader, T>>(body, dataReaderParam);

            return ToList<T>(mapper.Compile(), sql, parameters);
        } 
```

这样做，我可以完全避免 Activator.CreateInstance 或 FormatterServices.GetUninitializedObject 的东西，我敢打赌它要快得多；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T18:23:55.167

问题2：

我真的不知道，但我倾向于使用 Activator.CreateObject() 而不是 FormatterServices.GetUninitializedObject()，因为您的对象可能没有正确创建。GetUninitializedObject() 不会像 CreateObject() 那样运行默认构造函数，而且你不一定知道 T 的黑匣子里有什么...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-02-19T09:50:41.567

此方法将一行 sql 查询存储在匿名类型的变量中。您必须将原型传递给该方法。如果在 sql 查询中找不到任何匿名类型的属性，则使用原型值填充。C# 为其匿名类创建构造函数，参数与（只读）属性具有相同的名称。

```
 public static T GetValuesAs<T>(this SqlDataReader Reader, T prototype)
    {
        System.Reflection.ConstructorInfo constructor = prototype.GetType().GetConstructors()[0];
        object[] paramValues = constructor.GetParameters().Select(
            p => { try               { return Reader[p.Name]; }
                   catch (Exception) { return prototype.GetType().GetProperty(p.Name).GetValue(prototype); } }
            ).ToArray();
        return (T)prototype.GetType().GetConstructors()[0].Invoke(paramValues);
    } 
```

# silverlight - 为什么 MediaElement 在 Silverlight 中不起作用？

> ID：478017
> 
> 赞同：2
> 
> 时间：2009-01-25T18:20:39.853
> 
> 标签：silverlight, mediaelement

当我运行我的 Silverlight 应用程序时，此代码根本不播放视频：

```
 <MediaElement
        Source="winvideo-201DataGridPreview.wmv"
        AutoPlay="True"
        AudioStreamIndex="2"
        Margin="10"
        Height="200"
        Width="200"/> 
```

从我能找到的所有 MediaElement 示例中，它似乎是正确的语法等。

有什么我忘记了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T17:55:34.503

我有一个类似的问题。我将 wmv 文件作为现有对象添加到我的 Silverlight 项目中，然后在 wmv 文件的属性上，将其构建操作设置为 Resource。一旦我这样做了，它就会为我播放。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-16T18:38:34.943

引用的媒体文件需要在`ClientBin`文件夹中。对于 Sliver-light 4.0，您不仅可以使用格式，`.wmv`还可以使用`.mp4`格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T18:44:50.430

可能是不受支持的媒体文件的情况。

支持这些（来源： http: [//msdn.microsoft.com/en-us/library/cc189080](http://msdn.microsoft.com/en-us/library/cc189080(VS.95).aspx) (VS.95).aspx ）

MediaElement 对象支持以下格式。无论文件扩展名如何，都支持这些编码。

**视频**

*   WMV1：Windows 媒体视频 7
*   WMV2：Windows 媒体视频 8
*   WMV3：Windows 媒体视频 9
*   WMVA：Windows 媒体视频高级
*   配置文件，非 VC-1
*   WMVC1：Windows 媒体视频高级配置文件，VC-1

**声音的**

*   WMA 7：Windows 媒体音频 7

*   WMA 8：Windows 媒体音频 8

*   WMA 9：Windows 媒体音频 9

*   WMA 10：Windows 媒体音频 10

*   MP3：ISO/MPEG Layer-3

    *   输入：ISO/MPEG Layer-3 数据流

    *   通道配置：单声道、立体声

    *   采样频率：8、11.025、12、16、22.05、24、32、44.1 和 48 kHz

    *   比特率：8-320 kbps，可变比特率

    *   限制：不支持“自由格式模式”（参见 ISO/IEC 11172-3，子条款 2.4.2.3）。

测试您的视频文件是否与 Silverlight 兼容的非常简单（但有点暴力）的方法是将其上传到[http://Silverlight 流媒体](http://streaming.live.com/)，它会告诉您是否可以。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-25T20:31:51.243

Edward，根据您的 XAML 检查：1) WMV 文件采用适当的编码格式，2) WMV 文件位于您的 XAP 文件所在的位置旁边（我实际上会先检查这一点）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T13:50:15.767

我遇到了同样的问题，我没有找到可以正确引用视频文件的正确配置。如果我通过源“vid1.wmv”引用我的视频并将其设置为内容，它会打包到 xap 文件中，但视频不会播放。

正如 TimHeuer 所说，检查视频文件是否与 .xap 文件位于同一位置。

如果我**将视频文件**直接复制到 Web 项目的**ClientBin**中，它就可以工作。这对我来说是解决方案，但我真的很想知道应该如何正确地做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-18T05:05:24.497

这很烦人，但发现如果您右键单击媒体文件和属性并将其设置为“内容”构建操作，它将包含在 XAP 中，然后您使用 /myPic.jpg/wmv 或 /Images/myPic 引用它.jpg/wmv（显然取决于您的项目结构和 vid 或 pic）。希望这可以帮助

# database - 触发插入同一张表

> ID：478019
> 
> 赞同：1
> 
> 时间：2009-01-25T18:22:41.033
> 
> 标签：database, primary-key, triggers, identity

我的数据库中有许多相互关联的表。我有一个表（表一），其中插入了数据并且 id 自动递增。一旦该行有一个 ID，我想将其插入到一个表（表三）中，其中包含来自表单的另一组 ID（此数据也将进入一个表，因此它可以来自该表），同样表格作为进入第一个表的数据来自。

这两个 ID 一起构成了第三个表的主键。

我怎么能这样做，它表明多个 ID 连接到一个 ID 用于其他东西。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T19:48:24.077

您不能通过触发器来做到这一点，因为触发器只能使用您已经插入的数据，而不是当前仅驻留在用户界面中的数据。

通常你如何处理这种情况是你编写一个插入会议的存储过程，返回 id 值（在 SQL Server 中使用 scope_identity()，但我确信其他数据库也有方法返回自动生成的 id ）。然后，您将使用该值与该表所需的其他值一起插入到另一个表中。您当然希望将整个事情包装在事务中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T19:13:21.043

我认为您可能可以在表 1 触发器中执行您所描述的操作（只需将 INSERT 写入表 3），但您必须将表 3 行的附加信息放入表 1 行中，这不是t 很聪明。

我不明白您为什么要这样做，而不是在代码中编写 INSERT，这样阅读它的人就可以看到正在发生的事情。

触发器的问题在于它们很容易在数据库中隐藏业务逻辑。我认为（并且我相信我在这里是大多数人）更容易理解、管理、维护和全面处理所有业务规则都存在于同一一般区域中的应用程序。

有理由使用触发器（例如，用于传播非规范化值），就像使用存储过程有理由一样。我将断言它们在很大程度上与性能关键领域有关。或者应该是。

# codeigniter - 使用 Codeigniter 与 Paypal 集成相关的指南

> ID：478027
> 
> 赞同：12
> 
> 时间：2009-01-25T18:33:54.257
> 
> 标签：codeigniter, paypal

我需要一些与 PayPal 集成相关的指导。它与普通购物车不同。结帐后，该网站提供了一种付款方式。要么是 PayPal，要么是其他一些付款流程。用户提交后，表单将定向到控制器。存在一个数组，其中包含所有项目值。

从这里我如何才能进入 Paypal 网站？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-02-23T16:42:17.150

只是为了让您知道，我们刚刚开源了我们的替代[CodeIgniter PayPal 库](https://github.com/orderly/codeigniter-paypal-ipn "CodeIgniter 贝宝库")，称为 codeigniter-paypal-ipn。（我们在生产中使用这个库。）

它比 PayPal_Lib 执行更多的验证，并且还将订单保存到您的数据库中（使用 CI 活动记录或 Doctrine）。

希望对你有帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T19:04:57.977

有一个使用 CodeIgniter 与 Paypal 集成的现有库：

[http://codeigniter.com/wiki/PayPal_Lib/](http://codeigniter.com/wiki/PayPal_Lib/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-11T07:03:01.613

我在[这里问了同样的问题。](https://stackoverflow.com/questions/1698004/suggestions-for-gateway-please)

而[http://www.phpfour.com/blog/2009/02/php-payment-gateway-library-for-paypal-authorizenet-and-2checkout/](http://www.phpfour.com/blog/2009/02/php-payment-gateway-library-for-paypal-authorizenet-and-2checkout/)是很好的资源。

请看一看。

# c++ - 当我不是从 IDE 启动时，如何使我用 QT4 编写的程序执行？

> ID：478037
> 
> 赞同：0
> 
> 时间：2009-01-25T18:44:50.820
> 
> 标签：c++, qt4

当我从 IDE (VS2008) 运行程序时，它运行良好。当我想从 Windows Commander 启动它时它不起作用，因为它需要未找到的 DLL。使用了调试和发布版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T18:48:17.300

确保 Qt DLL 位于您的`PATH`. 两个简单的解决方案是：

*   将 Qt 的 DLL 复制到您`EXE`的目录。
*   将 Qt 的 DLL 复制到`%WINDOWS%\System32`（例如`C:\WINDOWS\System32`）（**可能不安全，特别是如果您在系统范围内安装其他版本的 Qt**。此外，还需要管理权限）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T18:49:31.480

您应该确保可执行文件（可能是 QT Dll）所需的 DLL 位于 PATH 中或与可执行文件位于同一目录中。您可以使用[depends.exe找到需要哪些dll](http://dependencywalker.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T20:25:04.347

另一种解决方案是将 qt bin 子目录的路径放在 VS tools->options->projects and solutions->VC++ 目录中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-25T22:39:25.183

您可以将它与它需要的所有库静态链接。节省了 DLL 和其他东西的麻烦。不利的一面是，您无法更新已安装 PC 上的 DLL 以获得更新/改进/修复的功能，并且需要重新构建和重新部署。

所以这是否可行取决于你的安装目标是什么——你控制的几台电脑，还是决定下载你程序的每个人+狗？

静态编译库错误（例如安全漏洞）并将其发送给您的客户将是非常糟糕的形式。在安全的公司 Intranet 上执行相同操作可能值得这样做，以便您知道每次安装运行完全相同。

# javascript - 在这个基于 ajax 的多人游戏示例中，如何解决令人震惊/滞后的运动？

> ID：478044
> 
> 赞同：0
> 
> 时间：2009-01-25T18:49:13.073
> 
> 标签：javascript, ajax, html, canvas, lag

编辑：重要的是，由于 html5 元素，必须在 firefox 3+ 中使用示例。

你好呀，

我正在尝试更多地了解 AJAX 在基于浏览器的多人游戏中的潜力。为此，我正在测试使用 AJAX 和航天飞机作为角色的运动。这个航天飞机是用画布（html5）渲染的。

我的第一个版本已经准备好了，你可以在这里测试一下：[ [http://ajax.uptowar.com/test3/][1]](http://ajax.uptowar.com/test3/][1])

源代码：

```
<?php
header('Content-Type: text/html;charset=utf-8');
header("Expires: Sat, 26 Jul 1997 05:00:00 GMT");
header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");
header("Cache-Control: no-store, no-cache, must-revalidate");
header("Cache-Control: post-check=0, pre-check=0", false);
header("Pragma: no-cache");
session_start();
$_SESSION['playerid'] = "";
echo("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n"); ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>ajax test</title>
        <meta http-equiv="pragma" content="no-cache" />
        <meta http-equiv="expires" content="-1" />
        <meta name="robots" content="index, follow" />
        <meta name="audience" content="all" />
        <meta http-equiv="content-language" content="en" />
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <script type="text/javascript">

        //vars
        var presstime = 300; //howlong a button should be hold down for 1 event fire
        var ajaxivtime = 500; //interval at which doAjax is executed, unless a manual request has been send within this time
        var keypressivtime = 50; //interval at which the keypress fire event is fired

        //init vars
        var keysdown = []; //array for what keys are down at a specific moment
        var cobjects = []; //array for all canvas objects
        var oldpress = 0;
        var ajaxrestime = 0;
        var latency = 0;

        //functions
        function isset() {
            var a = arguments;
            var l = a.length;
            var i = 0;
            if (l === 0) { 
                return false;
            }
            while (i != l) {
                if (typeof(a[i]) == 'undefined' || a[i] === null) { 
                    return false; 
                } else {
                    i++;
                }
            }
            return true;
        }

        function keycheck(e) {
            var keynum;
            if (window.event) { //IE
                keynum = e.keyCode;
            }
            else if (e.which) { // Netscape // FireFox // Opera
                keynum = e.which;
            }
            if (keysdown.indexOf(keynum) == -1) {
                keysdown.push(keynum);
            }
            return true;
        }

        function updateLatency(oldLatencyTime) {
            var curtime = new Date();
            curtime = curtime.getTime();
            if (oldLatencyTime !== 0) {
                latency = curtime - oldLatencyTime;
                document.title = "Latency: " + latency + "ms";
            }
            return true;
        }

        function setAjaxResTime() {
            var curtime = new Date();
            ajaxrestime = curtime.getTime();
            return true;
        }

        function getAjaxResTimeDiff() {
            var curtime = new Date();
            curtime = curtime.getTime();
            return curtime - ajaxrestime;
        }

        function setOldPress() {
            var curtime = new Date();
            oldpress = curtime.getTime();
            return true;
        }

        function getPressTimeDiff() {
            var curtime = new Date();
            curtime = curtime.getTime();
            return curtime - oldpress;
        }

        function searchcobjects(canvasid) {
            indexes = cobjects.length - 1;
            i = 0;
            while (i <= indexes) {
                if (cobjects[i][0] == canvasid) {
                    return i;
                }
                i++;
            }
            return -1;
        }

        function getCurX(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return -1;
            }
            return cobjects[key][2];
        }

        function getCurY(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return -1;
            }
            return cobjects[key][3];
        }

        function getTarX(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return -1;
            }
            return cobjects[key][4];
        }

        function getTarY(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return -1;
            }
            return cobjects[key][5];
        }

        function getStepCoords(cur, tar, step) {
            var curX = cur[0];
            var curY = cur[1];
            var tarX = tar[0];
            var tarY = tar[1];
            var xmultiplier;
            var ymultiplier;
            var xdiff;
            var ydiff;
            if ((tarX > curX)&&(tarY == curY)) {
                xmultiplier = 1;
                ymultiplier = 0;
            }
            else if ((tarX < curX)&&(tarY == curY)) {
                xmultiplier = -1;
                ymultiplier = 0;
            }
            else if ((tarY > curY)&&(tarX == curX)) {
                xmultiplier = 0;
                ymultiplier = 1;
            }
            else if ((tarY < curY)&&(tarX == curX)) {
                xmultiplier = 0;
                ymultiplier = -1;
            }
            else if ((tarX > curX)&&(tarY > curY)) {
                xdiff = tarX - curX;
                ydiff = tarY - curY;
                xmultiplier = xdiff / (xdiff + ydiff);
                ymultiplier = ydiff / (xdiff + ydiff);
            }
            else if ((tarX < curX)&&(tarY < curY)) {
                xdiff = curX - tarX;
                ydiff = curY - tarY;
                xmultiplier = -(xdiff / (xdiff + ydiff));
                ymultiplier = -(ydiff / (xdiff + ydiff));
            }
            else if ((tarX > curX)&&(tarY < curY)) {
                xdiff = tarX - curX;
                ydiff = curY - tarY;
                xmultiplier = xdiff / (xdiff + ydiff);
                ymultiplier = -(ydiff / (xdiff + ydiff));
            }
            else if ((tarX < curX)&&(tarY > curY)) {
                xdiff = curX - tarX;
                ydiff = tarY - curY;
                xmultiplier = -(xdiff / (xdiff + ydiff));
                ymultiplier = ydiff / (xdiff + ydiff);
            }
            var newx = curX + Math.round(step * xmultiplier);
            var newy = curY + Math.round(step * ymultiplier);
            return [newx, newy];
        }

        function updateTarX(canvasid, x) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][4] = x;
            }
            return true;
        }

        function updateTarY(canvasid, y) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][5] = y;
            }
            return true;
        }

        function updateCurX(canvasid, x) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][2] = x;
            }
            return true;
        }

        function updateCurY(canvasid, y) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][3] = y;
            }
            return true;
        }

        function updateTarAngle(canvasid, angle) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][8] = angle;
            }
            return true;
        }

        function updateCurAngle(canvasid, angle) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][7] = angle;
            }
            return true;
        }

        function getCurAngle(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return -1;
            }
            return cobjects[key][7];
        }

        function getTarAngle(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return -1;
            }
            return cobjects[key][8];
        }

        function isMoving(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else if (cobjects[key][2] == 1) {
                return true;
            }
            return false;
        }

        function isRotating(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else if (cobjects[key][6] == 1) {
                return true;
            }
            return false;
        }

        function startRotating(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][6] = 1;
            }
            return true;
        }

        function stopRotating(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][6] = 0;
            }
            return true;
        }

        function startMoving(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][3] = 1;
            }
            return true;
        }

        function stopMoving(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][4] = 0;
            }
            return true;
        }

        function drawSprite(ctx, angle, img, centerX, centerY) {
            ctx.save();
            ctx.translate(centerX, centerY);
            ctx.rotate(angle);
            ctx.drawImage(img, -(img.width / 2), -(img.height / 2));
            ctx.restore();
            return true;
        }

        function rotate(ctx, canvas, angle, img) {
            var rotation = Math.PI * angle / 180;
            var max = Math.max(img.width, img.height);
            ctx.clearRect(0, 0, max, max);
            drawSprite(ctx, rotation, img, max / 2, max / 2);
            return true;
        }

        function draw(canvasid, imgfile, angle, left, top) {    
            var canvas = document.createElement('canvas');
            document.body.appendChild(canvas);
            canvas.id = canvasid;
            var ctx = canvas.getContext('2d');
            var img = new Image();
            canvas.appendChild(img);
            img.id = canvas.id + "imgid";
            img.onload = function() {
                var max = Math.max(img.width, img.height);
                canvas.width = canvas.height = max;
                canvas.style.width = canvas.style.height = max + "px";
                canvas.style.position = "absolute";
                canvas.style.left = left + "px";
                canvas.style.top = top + "px";
                drawSprite(ctx, 0, img, max / 2, max / 2);
                if ((isset(angle))&&(angle !== 0)) {
                    rotate(ctx, canvas, angle, img);
                }
            };
            img.src = imgfile;
            return true;
        }

        function execMoving(canvasid) {
            var el = typeof canvasid == 'string' ? document.getElementById(canvasid) : canvasid;
            var curX = getCurX(canvasid);
            var curY = getCurY(canvasid);
            var tarX = getTarX(canvasid);
            var tarY = getTarY(canvasid);

            //calculate how often we have to do this in order to determine delay and step later
            var i = 0;
            var loopdone = false;
            var step = 5;
            var loopcurX = curX;
            var loopcurY = curY;
            var loopcoords;
            var loopxdiff;
            var loopydiff;
            while (!(loopdone)) {
                i++;
                loopcoords = getStepCoords([loopcurX, loopcurY], [tarX, tarY], step);
                loopxdiff = Math.max(tarX, loopcoords[0]) - Math.min(tarX, loopcoords[0]);
                loopydiff = Math.max(tarY, loopcoords[1]) - Math.min(tarY, loopcoords[1]);
                if ((loopxdiff <= step)&&(loopydiff <= step)) {
                    loopdone = true;
                }
                else {
                    loopcurX = loopcoords[0];
                    loopcurY = loopcoords[1];
                }
            }

            var delay = 0;
            step = 0;
            var multiplier = 0;
            var stepextra = 5;
            var time;
            if (presstime > latency) { time = presstime - latency; } else { time = presstime; }
            while (delay < 1) {
                multiplier++;
                step = stepextra * multiplier;
                delay = Math.round((time) / (i / multiplier));
            }
            if (delay > 10) { delay = 10; } //ceil delay

            var coords = getStepCoords([curX, curY], [tarX, tarY], step);
            var xPos = coords[0];
            var yPos = coords[1];
            el.style.left = xPos + 'px';
            el.style.top = yPos + 'px';
            updateCurX(canvasid, xPos);
            updateCurY(canvasid, yPos);
            var xdiff = Math.max(tarX, xPos) - Math.min(tarX, xPos);
            var ydiff = Math.max(tarY, yPos) - Math.min(tarY, yPos);
            if ((xdiff <= step)&&(ydiff <= step)) {
                stopMoving(canvasid);
            }
            else {
                setTimeout(function() { execMoving(canvasid); }, delay);
            }
            return true;
        }

        function execRotation(canvasid) {
            var curAngle = getCurAngle(canvasid);
            var tarAngle = getTarAngle(canvasid);

            //calcAngles
            var tarAngleCalc;
            var curAngleCalc;
            var calcDiff;
            if (tarAngle > 360) { tarAngleCalc = tarAngle - 360; } else if (tarAngle < 0) { tarAngleCalc = tarAngle + 360; } else { tarAngleCalc = tarAngle; }
            if (curAngle > 360) { curAngleCalc = curAngle - 360; } else if (curAngle < 0) { curAngleCalc = curAngle + 360; } else { curAngleCalc = curAngle; }

            //calcDiff
            if ((tarAngleCalc > 180)&&(curAngleCalc < 180)&&(Math.max(tarAngleCalc, curAngleCalc) - Math.min(tarAngleCalc, curAngleCalc) > 180)) {
                tarAngleCalc = tarAngleCalc - 360;
                calcDiff = Math.max(tarAngleCalc, curAngleCalc) - Math.min(tarAngleCalc, curAngleCalc);
            }
            else if ((curAngleCalc > 180)&&(tarAngleCalc < 180)&&(Math.max(tarAngleCalc, curAngleCalc) - Math.min(tarAngleCalc, curAngleCalc) > 180)) {
                curAngleCalc = curAngleCalc - 360;
                calcDiff = Math.max(tarAngleCalc, curAngleCalc) - Math.min(tarAngleCalc, curAngleCalc);
            }
            else {
                calcDiff = Math.max(tarAngleCalc, curAngleCalc) - Math.min(tarAngleCalc, curAngleCalc);
            }

            //calculate rotation speed
            var changeAngle = 0;
            var rotspeed = 0;
            var time;
            if (presstime > latency) { time = presstime - latency; } else { time = presstime; }
            while (rotspeed < 1) {
                changeAngle++;
                rotspeed = Math.round(time / (calcDiff / changeAngle));
            }

            //rotate
            var angle;
            if ((tarAngle > curAngle)&&(tarAngle - curAngle > 180)) {
                angle = curAngle - changeAngle;
            }
            else if (tarAngle > curAngle) {
                angle = curAngle + changeAngle;
            }
            else if ((tarAngle < curAngle)&&(curAngle - tarAngle > 180)) {
                angle = curAngle + changeAngle;
            }
            else if (tarAngle < curAngle) {
                angle = curAngle - changeAngle;
            }
            if (angle > 360) { angle = angle - 360; } else if (angle < 0) { angle = angle + 360; }
            var canvas = document.getElementById(canvasid);
            var ctx = canvas.getContext('2d');
            var img = document.getElementById(canvasid + "imgid");
            rotate(ctx, canvas, angle, img);
            updateCurAngle(canvasid, angle);
            if (getCurAngle(canvasid) != getTarAngle(canvasid)) {
                setTimeout(function() {
                    execRotation(canvasid);
                }, rotspeed);
            }
            else {
                stopRotating(canvasid);
            }
            return true;
        }

        function keydown(e) {
            var keynum;
            if (window.event) { // Internet Explorer
                keynum = window.event.keyCode;
            }
            else if (e.which) { // Netscape, Firefox and Opera
                keynum = e.which;
            }
            if (keysdown.indexOf(keynum) == -1) {
                keysdown.push(keynum);
            }
            return true;
        }

        function keyup(e) {
            var keynum;
            if (window.event) { // Internet Explorer
                keynum = window.event.keyCode;
            }
            else if (e.which) { // Netscape, Firefox and Opera
                keynum = e.which;
            }
            key = keysdown.indexOf(keynum);
            if (key != -1) {
                keysdown.splice(key);
            }
            return true;
        }

        function isDown(keynum) {
            if (keysdown.indexOf(keynum) == -1) {
                return false;
            }
            return true;
        }

        function ajaxHandle1(explode) { //move existing canvas object
            var canvasid = explode[1];
            var x = parseFloat(explode[2]);
            var y = parseFloat(explode[3]);
            if ((getCurX(canvasid) != x)||(getCurY(canvasid) != y)) {
                if (isMoving(canvasid)) {
                    updateTarX(canvasid, x);
                    updateTarY(canvasid, y);
                }
                else {
                    updateTarX(canvasid, x);
                    updateTarY(canvasid, y);
                    startMoving(canvasid);
                    execMoving(canvasid);
                }
            }
            return true;
        }

        function ajaxHandle2(explode) { //create new canvas object
            var canvasid = explode[1];
            var imgfile = explode[2];
            var x = parseFloat(explode[3]);
            var y = parseFloat(explode[4]);
            var angle = parseFloat(explode[5]);
            var rotation = Math.PI * angle / 180;
            draw(canvasid, imgfile, rotation);
            cobjects.push([canvasid, 0, x, y, x, y, 0, angle, angle]); //register canvas object - [canvasid, moving, curX, curY, tarX, tarY, rotating, curAngle, tarAngle]
        }

        function ajaxHandle3(explode) { //rotate existing canvas object
            var canvasid = explode[1];
            var angle = parseFloat(explode[2]);
            if (getCurAngle(canvasid) != angle) { //if the new angle is different
                if (isRotating(canvasid)) {
                    updateTarAngle(canvasid, angle);
                }
                else {
                    updateTarAngle(canvasid, angle);
                    startRotating(canvasid);
                    execRotation(canvasid);
                }
            }
        }

        function handleAjaxResponse(response) {
            var commands = response.split("@");
            var command;
            var explode;
            var type;
            for (var i = 0; i < commands.length; i++) { // loop every handler command to execute it's type of action, commands are separated by an @ character
                command = commands[i];
                explode = command.split("#"); // explode the attributes of this command, separated by an # character
                type = parseFloat(explode[0]);
                if (type == 1) { //move existing canvas object
                    ajaxHandle1(explode);
                }
                else if (type == 2) { //create new canvas object
                    ajaxHandle2(explode);
                }
                else if (type == 3) { //rotate existing canvas object
                    ajaxHandle3(explode);
                }
            }
            return true;
        }

        function doAjax(get) {
            var oldLatencyTime = new Date();
            oldLatencyTime = oldLatencyTime.getTime();
            if (!(isset(get))) {
                get = "";
            }
            if ((getAjaxResTimeDiff() < ajaxivtime)&&(get === "")) {
                return false;
            }
            var xmlHttpReq = false;
            try { // Firefox, Opera 8.0+ and Safari
                xmlHttpReq = new XMLHttpRequest();
            }
            catch (e) { // Internet Explorer
                try {
                    xmlHttpReq = new ActiveXObject("Msxml2.XMLHTTP");
                }
                catch (e) {
                    try {
                        xmlHttpReq = new ActiveXObject("Microsoft.XMLHTTP");
                    }
                    catch (e) {
                        alert("Your browser does not support AJAX. Please use an AJAX compatible browser.");
                        return false;
                    }
                }
            }
            xmlHttpReq.open('GET', 'handler.php' + get, true);
            xmlHttpReq.onreadystatechange = function() {
                if (xmlHttpReq.readyState == 4) {
                    updateLatency(oldLatencyTime);
                    var response = xmlHttpReq.responseText;
                    if ((isset(response))&&(response !== "")) {
                        handleAjaxResponse(response);
                    }
                }
            };
            xmlHttpReq.send(null);
            return true;
        }

        function keyinput() { //keycodes: 87 = w, 68 = d, 65 = a
            if (getPressTimeDiff() > presstime) {
                if ((isDown(87))&&(isDown(68))&&(!(isDown(65)))) {
                    setOldPress();
                    doAjax("?move=f&rotate=r");
                }
                else if ((isDown(87))&&(isDown(65))&&(!(isDown(68)))) {
                    setOldPress();
                    doAjax("?move=f&rotate=l");
                }
                else if ((isDown(87))&&(!(isDown(68)))&&(!(isDown(65)))) {
                    setOldPress();
                    doAjax("?move=f");
                }
                else if ((isDown(68))&&(!(isDown(65)))) {
                    setOldPress();
                    doAjax("?rotate=r");
                }
                else if ((isDown(65))&&(!(isDown(68)))) {
                    setOldPress();
                    doAjax("?rotate=l");
                }
            }
            return true;
        }

        //init intervals
        var iv_ajax = setInterval(function() { doAjax(); }, ajaxivtime); //ajax handler interval
        var iv_keypress = setInterval(function() { keyinput(); }, keypressivtime); //keypress fire interval

        //register event handlers
        document.onkeydown = function(event) { keydown(event); };
        document.onkeyup = function(event) { keyup(event); };
        document.onkeypress = function(event) { keycheck(event); };
        </script>
    </head>
    <body style="background-color: white;"><div style="position: absolute; top: 300px; left: 300px;">W: accelerate.<br />A: rotate left.<br />D: rotate right.</div></body>
</html> 
```

您可能会注意到，即使您的延迟（见标题）低于 50 毫秒，航天飞机也会在移动/旋转时不时“震动”或滞后。因为我想找出导致问题的原因，所以我将整个事情重新制作为客户端版本（没有 ajax）。

你可以在这里查看：[ [http://ajax.uptowar.com/test5/index.php][2]](http://ajax.uptowar.com/test5/index.php][2])

这是客户端重制的来源：

```
<?php
header('Content-Type: text/html;charset=utf-8');
header("Expires: Sat, 26 Jul 1997 05:00:00 GMT");
header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");
header("Cache-Control: no-store, no-cache, must-revalidate");
header("Cache-Control: post-check=0, pre-check=0", false);
header("Pragma: no-cache");
session_start();
$_SESSION['playerid'] = "";
echo("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n"); ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>ajax test</title>
        <meta http-equiv="pragma" content="no-cache" />
        <meta http-equiv="expires" content="-1" />
        <meta name="robots" content="index, follow" />
        <meta name="audience" content="all" />
        <meta http-equiv="content-language" content="en" />
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <script type="text/javascript">     
        //vars
        var keypressivtime = 50; //interval at which keyinput is handled
        var presstime = 150; //howlong a button should be hold down for 1 event fire

        //init
        var cobjects = []; //array for all canvas objects
        var keysdown = []; //array for what keys are down at a specific moment
        var oldpress = 0; //press init
        var latency = 0; //client side

        //functions
        function isset() {
            var a = arguments;
            var l = a.length;
            var i = 0;
            if (l === 0) { 
                return false;
            }
            while (i != l) {
                if (typeof(a[i]) == 'undefined' || a[i] === null) { 
                    return false; 
                } else {
                    i++;
                }
            }
            return true;
        }

        function getStepCoords(cur, tar, step) {
            var curX = cur[0];
            var curY = cur[1];
            var tarX = tar[0];
            var tarY = tar[1];
            var xmultiplier;
            var ymultiplier;
            var xdiff;
            var ydiff;
            if ((tarX > curX)&&(tarY == curY)) {
                xmultiplier = 1;
                ymultiplier = 0;
            }
            else if ((tarX < curX)&&(tarY == curY)) {
                xmultiplier = -1;
                ymultiplier = 0;
            }
            else if ((tarY > curY)&&(tarX == curX)) {
                xmultiplier = 0;
                ymultiplier = 1;
            }
            else if ((tarY < curY)&&(tarX == curX)) {
                xmultiplier = 0;
                ymultiplier = -1;
            }
            else if ((tarX > curX)&&(tarY > curY)) {
                xdiff = tarX - curX;
                ydiff = tarY - curY;
                xmultiplier = xdiff / (xdiff + ydiff);
                ymultiplier = ydiff / (xdiff + ydiff);
            }
            else if ((tarX < curX)&&(tarY < curY)) {
                xdiff = curX - tarX;
                ydiff = curY - tarY;
                xmultiplier = -(xdiff / (xdiff + ydiff));
                ymultiplier = -(ydiff / (xdiff + ydiff));
            }
            else if ((tarX > curX)&&(tarY < curY)) {
                xdiff = tarX - curX;
                ydiff = curY - tarY;
                xmultiplier = xdiff / (xdiff + ydiff);
                ymultiplier = -(ydiff / (xdiff + ydiff));
            }
            else if ((tarX < curX)&&(tarY > curY)) {
                xdiff = curX - tarX;
                ydiff = tarY - curY;
                xmultiplier = -(xdiff / (xdiff + ydiff));
                ymultiplier = ydiff / (xdiff + ydiff);
            }
            var newx = curX + Math.round(step * xmultiplier);
            var newy = curY + Math.round(step * ymultiplier);
            return [newx, newy];
        }

        function drawSprite(ctx, angle, img, centerX, centerY) {
            ctx.save();
            ctx.translate(centerX, centerY);
            ctx.rotate(angle);
            ctx.drawImage(img, -(img.width / 2), -(img.height / 2));
            ctx.restore();
            return true;
        }

        function rotate(ctx, canvas, angle, img) {
            var rotation = Math.PI * angle / 180;
            var max = Math.max(img.width, img.height);
            ctx.clearRect(0, 0, max, max);
            drawSprite(ctx, rotation, img, max / 2, max / 2);
            return true;
        }

        function searchcobjects(canvasid) {
            indexes = cobjects.length - 1;
            i = 0;
            while (i <= indexes) {
                if (cobjects[i][0] == canvasid) {
                    return i;
                }
                i++;
            }
            return -1;
        }

        function isMoving(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else if (cobjects[key][1] == 1) {
                return true;
            }
            return false;
        }

        function isRotating(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else if (cobjects[key][6] == 1) {
                return true;
            }
            return false;
        }

        function startRotating(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][6] = 1;
            }
            return true;
        }

        function stopRotating(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][6] = 0;
            }
            return true;
        }

        function startMoving(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][1] = 1;
            }
            return true;
        }

        function stopMoving(canvasid) {
            var key = searchcobjects(canvasid);
            if (key == -1) {
                return false;
            }
            else {
                cobjects[key][1] = 0;
            }
            return true;
        }

        function stepxy(steppixels, angle) { //steppixels is the total amount of pixels to be shared between x and y depending on the angle
            var xmultiplier;
            if ((angle < 0)||(angle > 360)) {
                return false;
            }
            else if ((angle === 0)||(angle == 360)) {
                xmultiplier = 0;
                ymultiplier = -1;
            }
            else if ((angle > 0)&&(angle < 91)) {
                xmultiplier = angle / 90;
                ymultiplier = -(1 - (angle / 90));
            }
            else if ((angle > 90)&&(angle < 181)) {
                xmultiplier = 1 - ((angle - 90) / 90);
                ymultiplier = (angle - 90) / 90;
            }
            else if ((angle > 180)&&(angle < 271)) {
                xmultiplier = -((angle - 180) / 90);
                ymultiplier = 1 - ((angle - 180) / 90);
            }
            else if ((angle > 270)&&(angle < 361)) {
                xmultiplier = -(1 - ((angle - 270) / 90));
                ymultiplier = -((angle - 270) / 90);
            }
            else {
                return false;
            }
            var xstep = Math.round(steppixels * xmultiplier);
            var ystep = Math.round(steppixels * ymultiplier);
            var arr = [xstep, ystep];
            return arr;
        }

        function getPressTimeDiff() {
            var curtime = new Date();
            curtime = curtime.getTime();
            return curtime - oldpress;
        }

        function setOldPress() {
            var curtime = new Date();
            oldpress = curtime.getTime();
            return true;
        }

        function isDown(keynum) {
            if (keysdown.indexOf(keynum) == -1) {
                return false;
            }
            return true; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T21:00:05.913

I would say that the biggest issue you are running into here is that you have made the movement of the sprite synchronous with an asynchronous operation. Both your draw cycle and your movement actions should be decoupled from the AJAX response. Record all of the movement of the sprite client side and send differences to the server. The server can validate the differences to ensure that the sprite has not moved farther than it should have. If the server and the client disagree about the position of the sprite above some threshold the sprite can be moved to a position that is correct. In general the server and the client should agree that the sprite can have moved from the last known point to the new point.

```
Here is some very crude psudo code to illustrate the concept.

Client:
Packet = {startPoint:{x:1, y:1}, endpoint:{x:5 y:7});
sendPacket(Packet);

Server:
If(abs(Packet.startPoint - Packet.endPoint) > minPoint){
    fixPoint.x = Packet.endPoint.x – minPoint.x;
fixPoint.y = Packet.endPoint.y – minPoint.y;
    Return {moveValid: false, fixPoint: fixPoint}
}else{
    Return (moveValid: true)
} 
```

This will work well in compensating for simple latency and will also detect cheating by the client. If there is extreme latency you will end up with frequent “teleporting” of the sprite especially if the requests start getting processed out of order when the latency is greater that the frequency you are sending requests.

Most online games use sockets directly and can send much lighter packets than HTTP which you are stuck with in JavaScript, so you will need to explore the bounds of the concept to see where the thresholds will land with JavaScript and AJAX.

# java - 我该如何弄清楚这个复杂的递归算法？

> ID：478049
> 
> 赞同：1
> 
> 时间：2009-01-25T18:59:14.363
> 
> 标签：java, recursion, binary

我刚开始学习用 Java 教授的数据结构和算法。到目前为止，我一生中只学过 C++，所以我对使用 java 还是很陌生。

无论如何，我有一个家庭作业问题，我有点坚持：

编写一个递归方法，返回 N 的二进制表示中 1 的数量。如果 N 为奇数，则使用它等于 N/2 + 1 表示中 1 的数量这一事实。

现在我不确定该怎么做。我已经设置了一个函数，它接受一个整数并将其转换为二进制并将其存储在一个字符串中，但其余的我有点迷失了。

如果我能得到一些指导，那真的很有帮助。

这是我到目前为止所拥有的：

```
import java.io.*;
public class Homework1Code {
  static void prtbinary(String Molly, int size){
    if(size <=0){
      return;
    }
  }

  public static void main(String[] args) {
    int i = 38;
    String binstr = Integer.toBinaryString(i);
    System.out.println("The Original Decimal Number is: " + binstr);
    prtbinary(binstr, binstr.length());
  }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-25T19:06:07.360

这不是一个很难解决的问题。你需要做的是停止编写代码，首先在纸上解决问题。然后将您的算法转换为代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-30T16:02:20.123

第一步：想！

很难编写返回类型为 void 的递归方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-25T19:38:31.553

问题是关于做算术，所以将值保留为 int 而不是转换为字符串。

然后有两个事实（对于非负数）：

*   如果 N 是奇数，则 1 的个数与 N/2 中的相同，再加上一个余数；
*   如果 N 是偶数，则个数与 N/2 中的相同。

010101 的 bitCount 是 010101/2 = 01010 的 bitCount 加上 010100 的 1 bitCount 是 010100/2 = 01010 的 bitCount

冲洗并重复直到完成（感应）。

只是不要看 Integer.bitCount 的来源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-25T19:36:07.657

首先，将问题简化为最简单的情况......

# php - 类似于 PHP 中的重载？

> ID：478050
> 
> 赞同：3
> 
> 时间：2009-01-25T19:00:06.450
> 
> 标签：php, oop, overloading

我想完成这样的事情：调用一个方法，说“转”，然后将“转”以不同的方式应用于不同的数据类型，例如，用“螺丝刀”对象/参数调用“转”使用“转螺丝刀” " 方法，使用 "steeringWheel" 对象/参数调用 "turn" 使用 "turnSteeringWheel" 方法等 -- 正在做不同的事情，但它们都称为 "turn"。

我想实现这一点，以便调用代码不必担心所涉及的类型。在此示例中，“转”应该足以“转”“螺丝刀”、“转向轮”或任何可能需要“转”的东西。

在 C++ 中，我会通过重载来做到这一点——C++ 会根据数据类型/签名对事情进行分类——但这在 PHP 中不起作用。

关于我应该从哪里开始的任何建议？switch 语句很明显，但我认为必须有一个（更优雅的）OO 解决方案。不？

TIA

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-25T19:34:13.370

我阅读了 davethegr8 的解决方案，但似乎可以通过更强的类型来做同样的事情：

```
<?php

interface Turnable
{
  public function turn();
}

class Screwdriver implements Turnable
{
  public function turn() {
    print "to turning sir!\n";
  }
}

class SteeringWheel implements Turnable
{
  public function turn() {
    print "to everything, turn, turn turn!\n";
  }
}

function turn(Turnable $object) {
  $object->turn();
}

$driver = new Screwdriver();
turn($driver);

$wheel = new SteeringWheel();
turn($wheel);

$obj = new Object(); // any object that does not implement Turnable
turn($object); // ERROR! 
```

PHP 确实允许您对参数使用类型提示，并且类型提示可以是接口名称而不是类名称。所以你可以肯定，如果`$object`实现了`Turnable`接口，那么它*必须*有`turn()`方法。每个实现的类都`Turnable`可以做自己的事情来完成转弯。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-25T19:08:05.700

我认为这会奏效...

```
function turn($object) {
    if(method_exists($object, 'turn'.ucwords(get_class($object))) {
        $fname = 'turn'.ucwords(get_class($object));
        return $object->$fname();
    }

    return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T19:03:42.387

您需要在此处查看 PHP 手册以获取[说明](http://se2.php.net/overload)

# iphone - TERMINATING_DUE_TO_UNCAUGHT_EXCEPTION错误iPhone SDK开发

> ID：478051
> 
> 赞同：0
> 
> 时间：2009-01-25T19:01:54.107
> 
> 标签：iphone

我有一个由另一个程序员编写的工作程序，我正在尝试添加一些功能以学习 iPhone SDK。我已经完成了我认为是一项相当简单的任务，即使用类似按钮向现有视图添加额外的 UIButton。我已经使用其他 UIButtons 作为模型，看起来这应该是一个简单的任务。

问题是当调用这个子视图的行被执行时，我得到了相当模糊的错误标志`TERMINATING_DUE_TO_UNCAUGHT_EXCEPTION`。在哪里可以找到有关此错误代码的更多信息？在我看来，这是一个非常普遍的错误，并且 Xcode shell 中肯定有某个地方可以让我更详细地了解这意味着什么？

我已经隔离了它发生的线，它似乎发生在第一次引用新视图时。界面生成器中的连接是否有问题？任何建议都会有所帮助，因为我真的觉得我此时正在抓住稻草......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T12:01:53.220

您想在异常发生时捕获它，然后您可以在调试器中跟踪它。调试 Cocoa 应用程序时使用的一组有用的断点是 objc_exception_throw 和 -[NSException raise]。在 iPhone 中，我认为所有异常都通过 objc_exception_throw 传播，但如果您的目标是 Tiger 或更早，您应该在两者上设置断点。

[在http://www.cocoadev.com/index.pl?DebuggingTechniques](http://www.cocoadev.com/index.pl?DebuggingTechniques)有更多的调试技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T19:26:37.333

这可能意味着您在释放内存后使用了一些内存，或者在未初始化的情况下使用了它。通常，当您在此之后查看堆栈时，您会看到的只是执行自动释放的主循环部分，这显然对您没有帮助。

你真的需要很好地理解内存管理在 Objective-C 中是如何工作的，然后看看你的更改。这里没有真正的灵丹妙药。好消息是，随着经验的积累，它会变得更容易。

[这是一篇关于在 Objective-C 中调试](http://cocoawithlove.com/2008/10/debugging-tips-for-objective-c.html)的好文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T21:48:53.707

这是由 Objective-C 运行时生成的异常。点击 CMD-SHIFT-R 调出调试器控制台。您将在窗口底部看到所有 gdb 启动信息，但如果您向上滚动查看堆栈信息，您将看到如下所示的内容：

```
[Session started at 2009-04-09 14:39:27 -0700.]
2009-04-09 14:39:31.246 LearnGLES[10415:20b] *** -[EAGLContext fakeMessage]: unrecognized selector sent to instance 0x528150
2009-04-09 14:39:31.248 LearnGLES[10415:20b] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '*** -[EAGLContext fakeMessage]: unrecognized selector sent to instance 0x528150'
2009-04-09 14:39:31.250 LearnGLES[10415:20b] Stack: (
     2517758219,
     2486509115,
     .... 
```

这只是我通过更改代码以向对象发送不存在的消息而构成的完整示例异常，但是对于您的可能存在很多可能性。任何会在任何 Objective-C 框架中产生运行时异常的东西都可能是罪魁祸首（日期格式化程序的不可解析日期，对象的无效消息等......）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T22:13:36.653

当我发布没有明确分配的东西时，我遇到了类似的问题。就我而言，我有一个背景图像 UIImage *image=[UIImage ...] 并将其设置为我的 UIButton 的背景，然后 [image release]; 你不想做 [image release]：UIButton 现在拥有它，它会在不再需要时释放它。也许你有类似的问题？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T06:09:14.183

您在界面生成器中建立了哪些联系？单击按钮时，您是否正在调用任何方法？在这种情况下，方法签名是什么？您是否对原始代码进行了任何更改，您可能不小心删除了一些重要的代码。如果您发布一些代码会有所帮助。例外是非常通用的。

# php - 通过文本输入为 URL 编码特殊字符的问题

> ID：478065
> 
> 赞同：0
> 
> 时间：2009-01-25T19:12:06.787
> 
> 标签：php, .htaccess, codeigniter, redirect

我正在使用 CodeIgniter 构建一个 PHP 应用程序。它类似于`Let Me Google That For You`您在文本输入框中写一个句子，单击提交，然后您将被带到一个显示结果的 URL。我希望 URL 是人工可编辑的，并且相对简单。我已经绕过 CodeIgniter URL 路由，所以现在我的 URL 看起来像这样：

```
http://website.com/?q=this+is+a+normal+url 
```

现在的问题是当句子包含特殊字符时，例如问号或反斜杠。这两种情况都与我当前的`.htaccess`重写规则相混淆，即使在字符被编码时也会发生这种情况。

```
http://website.com/?q=this+is+a+normal+url? OR
http://website.com/?q=this+is+a+normal+url%3F 
```

起作用的是双重编码。例如，如果我将问号编码为`%253F`（其中 ? 编码为 %3F，% 符号编码为 %25）。此网址正常工作。

```
http://website.com/?q=this+is+a+normal+url%253F 
```

有人知道我可以在这里做什么吗？有没有一种聪明的方法可以对输入进行双重编码？我可以写一个`.htaccess`重写规则来解决这个问题吗？我在这里不知所措。以下是我目前为大家使用的重写规则。

```
RewriteEngine on
RewriteCond %{QUERY_STRING} ^q=(.*)$
RewriteRule ^(.*)$ /index.php/app/create/%{QUERY_STRING}? [L] 
```

**注意**：CodeIgniter 的工作方式是他们有一个`index/application/function/parameter`URL 设置。我现在正在为函数提供完整的查询字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T21:08:40.903

如果您使用的是 Apache 2.2 及更高版本，则可以使用[B 标志](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriteflags)强制对反向引用进行转义：

```
RewriteCond %{QUERY_STRING} ^q=.*
RewriteRule ^ /index.php/app/create/%0? [L,B] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T20:42:18.210

我通常做这样的人类可读的网址

```
$humanReadableUrl= implode("_",preg_split('/\W+/', trim($input), -1, PREG_SPLIT_NO_EMPTY)); 
```

它将删除所有非单词字符并在单词之间添加下划线

# c++ - 如何在 RichEdit 2.0 中自动检测 url？

> ID：478071
> 
> 赞同：0
> 
> 时间：2009-01-25T19:14:34.520
> 
> 标签：c++, winapi, richedit

当我们有一个 RichEdit 控件并向其发送`EM_AUTOURLDETECT`一条 WPARAM 设置为 TRUE 的消息时，它会很好地突出显示检测到的 URL 并发送`EN_LINK`通知。但它只对输入到控件中的文本执行此操作。`SetWindowText`对于使用或加载到控件中的文本，我还没有找到方法`EM_STREAMIN`。请帮忙！谢谢

**更新：** 我从头开始创建了一个测试应用程序，它在那里运行良好。我认为问题可能是我对控件进行了超类化，即创建了一个新的窗口类，并且只使用了原始类的窗口过程。我将尝试对控件进行子类化..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T13:06:52.157

我刚刚打开了一个基本的基于 WTL 对话框的应用程序，其中包含一个riched20 控件，以下工作正常：

```
CRichEditCtrl richedit = GetDlgItem(IDC_RICHEDIT);
richedit.SetAutoURLDetect(TRUE);
richedit.SetWindowText(_T("http://www.stackoverflow.com")); 
```

我有一些旧的 MFC 代码可以做类似的事情，尽管使用 ES_STREAM，它也可以正常工作。

FWIW WTL`CRichEditCtrl`包装器非常薄。 `SetAutoURLDetect`简单地调用`SendMessage`传递它`EM_AUTOURLDETECT`。

我正在编译`_RICHEDIT_VER`设置为`0x0200`FWIW。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T04:32:48.443

您可能只需将文本重写到控件以使其重新解析。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T21:27:57.790

在不知道您尝试使用 SetWindowText 和 EM_STREAMIN 添加到控件的文本格式的情况下，我会猜测并说这可能与控件的文本模式有关。设置控件的内容后，尝试向其发送[EM_GETTEXTMODE](http://msdn.microsoft.com/en-us/library/bb774197(VS.85).aspx)消息并查看是否设置了 TM_PLAINTEXT 位。如果是这种情况，请尝试发送[EM_SETTEXTMODE](http://msdn.microsoft.com/en-us/library/bb774286(VS.85).aspx)消息，然后发送 EM_AUTOURLDETECT。您的代码应如下所示：

```
UINT textmode = (UINT)::SendMessage(handle_to_control, EM_GETTEXTMODE, 0, 0);
if(textmode & TM_PLAINTEXT) {
    textmode &= ~TM_PLAINTEXT;    // Clear the TM_PLAINTEXT bit
    textmode |= TM_RICHTEXT;      // Set the TM_RICHTEXT bit
    if(::SendMessage(handle_to_control, EM_SETTEXTMODE, textmode, 0) != 0) {
        // Failed to set the text mode
    }
}
::SendMessage(handle_to_control, EM_AUTOURLDETECT, TRUE, 0); 
```

# c++ - 在 C++ 中创建文件

> ID：478075
> 
> 赞同：88
> 
> 时间：2009-01-25T19:15:12.333
> 
> 标签：c++, file-io

我想使用 C++ 创建一个文件，但我不知道该怎么做。例如，我想创建一个名为`Hello.txt`.

谁能帮我？

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2009-01-25T19:18:49.020

一种方法是创建 ofstream 类的实例，并使用它来写入您的文件。这是一个网站的链接，其中包含一些示例代码，以及有关大多数 C++ 实现中可用的标准工具的更多信息：

[流参考](http://en.cppreference.com/w/cpp/io/basic_ofstream)

为了完整起见，这里有一些示例代码：

```
// using ofstream constructors.
#include <iostream>
#include <fstream>  

std::ofstream outfile ("test.txt");

outfile << "my text here!" << std::endl;

outfile.close(); 
```

您想使用 std::endl 来结束您的行。另一种方法是使用 '\n' 字符。这两件事是不同的，std::endl 刷新缓冲区并立即写入您的输出，而 '\n' 允许 outfile 将所有输出放入缓冲区并可能稍后再写入。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2017-03-13T15:39:34.613

使用文件流执行此操作。当 a`std::ofstream`关闭时，文件被创建。我更喜欢下面的代码，因为 OP 只要求创建一个文件，而不是在其中写入：

```
#include <fstream>

int main()
{
    std::ofstream { "Hello.txt" };
    // Hello.txt has been created here
} 
```

流在创建后立即被销毁，因此流在析构函数内关闭，因此文件被创建。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-25T19:18:57.940

```
#include <iostream>
#include <fstream>

int main() {
  std::ofstream o("Hello.txt");

  o << "Hello, World\n" << std::endl;

  return 0;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-05-25T08:34:17.987

这是我的解决方案：

```
#include <fstream>

int main()
{
    std::ofstream ("Hello.txt");
    return 0;
} 
```

即使没有ofstream名称也会创建文件（Hello.txt），这与Boiethios先生的回答不同。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-09-29T02:35:05.753

```
#include <iostream>
#include <fstream>
#include <string>
using namespace std;

string filename = "/tmp/filename.txt";

int main() {
  std::ofstream o(filename.c_str());

  o << "Hello, World\n" << std::endl;

  return 0;
} 
```

为了使用文件名的变量而不是常规字符串，这是我必须做的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-04-17T12:27:06.707

> 使用 c 方法`FILE *fp =fopen("filename","mode");` `fclose(fp);` 模式意味着 a 用于附加 r 用于读取，w 用于写入

```
 / / using ofstream constructors.
      #include <iostream>
       #include <fstream>  
      std::string input="some text to write"
     std::ofstream outfile ("test.txt");

    outfile <<input << std::endl;

       outfile.close(); 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2019-03-16T13:14:18.220

```
/*I am working with turbo c++ compiler so namespace std is not used by me.Also i am familiar with turbo.*/

#include<iostream.h>
#include<iomanip.h>
#include<conio.h>
#include<fstream.h> //required while dealing with files
void main ()
{
clrscr();
ofstream fout; //object created **fout**
fout.open("your desired file name + extension");
fout<<"contents to be written inside the file"<<endl;
fout.close();
getch();
} 
```

运行程序后，该文件将在编译器文件夹本身的 bin 文件夹中创建。

# add-in - 如何使用返回范围的 Openoffice calc 加载项？

> ID：478077
> 
> 赞同：2
> 
> 时间：2009-01-25T19:16:11.207
> 
> 标签：add-in, openoffice.org, calc

我正在编写一个返回一系列字符串的 OpenOffice calc 加载项：

```
public String[][] myFunc(int v0, com.sun.star.table.XCellRange v1) 
```

当我尝试在 OpenOffice 中使用该函数并将单元格的值设置为

```
=myFunc(0;A1:B1) 
```

只有 myFunc 返回的第一个值显示为单元格的值。如何使值出现在一系列单元格中，效果如下

```
C1:D1=myFunc(0;A1:B1) 
```

?

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T04:33:10.867

我找到了一个解释这个的链接：

[http://www.openofficetips.com/blog/archives/2004/10/array_formulas.html](http://www.openofficetips.com/blog/archives/2004/10/array_formulas.html)

简而言之，选择单元格 C1，输入公式 =myFunc(0;A1:B1)，然后按 Ctrl-Shift-Enter 而不是 Enter。不过，似乎无法从菜单访问此功能。我不得不承认不是很直观！

:)

# javascript - 访问 iframe 中的表单

> ID：478078
> 
> 赞同：10
> 
> 时间：2009-01-25T19:16:17.387
> 
> 标签：javascript, forms, iframe

我正在尝试访问表单及其元素。表单位于 iframe 中，访问表单的 javascript 代码位于主文档中。

我不确定我应该在问题中添加什么，所以如果我需要添加其他内容，请告诉我。

（表单和主页在同一个域中）

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-25T19:34:31.123

```
var ifr = document.getElementById( yourIframeId );
var ifrDoc = ifr.contentDocument || ifr.contentWindow.document;
var theForm = ifrDoc.getElementById( yourFormId ); 
```

或者您可以在框架中有一些代码将变量设置`parent`到表单中，但我不相信这种方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-25T19:45:29.777

如果您的 iframe 有一个`name`属性，则可以将其用作窗口名称。如果框架名称是“myframe”：

```
myframe.document.getElementById("myform") // gives you the form element 
```

# hash - 散列中“字符”和“八位字节”之间的区别

> ID：478105
> 
> 赞同：8
> 
> 时间：2009-01-25T19:31:42.953
> 
> 标签：hash, character-encoding, character, salt, octal

我看到“八位字节”这个词出现在关于散列随机数的文献中，它似乎是“字符”的同义词，尽管这些词的使用方式*有*一种模式。

这使我相信两者之间存在形式上的区别。如果有人能告诉我它是什么，我将不胜感激。

（请不要讲八进制字符*代码*或八进制（以 8 为基数）数字；我说的是*名词*'octet'，而不是*形容词*）

**编辑**：事实证明，我正在寻找的词是“八位字节”。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-25T19:35:18.500

您可能正在考虑通常与单字节（非 unicode）字符同义的术语**octet 。**在这种情况下，八位字节表示八位。一个字符可以是 8 位或 16 位甚至更多位，但一个八位位组始终是 8 位。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T14:30:57.540

八位字节是 8 位数据，一个字节（尽管字节不一定有 8 位）。字符是文本的最小单位。它们是完全独立的概念，并且可以互换使用它们暴露了对文本编码复杂性的严重无知。不幸的是，这种特殊的无知元素太常见了，C 标准明确定义 char 的大小为 1 字节也无济于事。

特别是，我会非常警惕任何使用“字符”表示“字节”（或“八位字节”）的加密文本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T12:21:05.960

八位字节是一个字节的法语单词，它被称为八位字节，因为它包含八位。该术语主要用于电信，可能是由于法国在 CCITT 等方面的影响很大。

# iphone - 如何在 Xcode 中为代码签名身份字段添加/触发曝光？

> ID：478107
> 
> 赞同：1
> 
> 时间：2009-01-25T19:32:25.403
> 
> 标签：iphone, xcode, code-signing

在 Xcode 中，只有一个项目（即所有其他项目按我期望的方式工作），在 Target Info 窗口中，build 选项卡中，Code Signing Identity 字段标题没有**显示**“Any iPhone OS Device “ 场地。

如何添加或触发其曝光？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T03:13:57.280

啊哈！我只需要再看远一点。在信息窗口的底部是一个小齿轮图标，在该弹出窗口下方是“添加构建设置条件”，一旦添加，就会生成一个包含“任何 iPhone OS 设备”的构建设置弹出窗口。

哇！

（希望这对下一个人有帮助......）

# regex - 在vim，正则表达式中清空文件中的所有方法？

> ID：478114
> 
> 赞同：4
> 
> 时间：2009-01-25T19:35:05.117
> 
> 标签：regex, vim, keyboard-shortcuts

我正在使用 vim 编辑器，我想清空类中的所有方法，例如

```
class A {

     public:
        int getNumber() const {
             return number;
        }

        void setNumber(int num) {
             number = num;
        }

}; 
```

我想要一个可以替换的正则表达式，这样结果就是这样

```
class A {

     public:
        int getNumber() const;

        void setNumber(int num};

}; 
```

我知道我可以使用 %s 进行全局替换，但是我正在寻找方法主体下的所有内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-25T19:55:04.903

由于大括号当然可以嵌套在您的函数中，不幸的是，不可能创建一个可以匹配相应的结束大括号的正则表达式。

幸运的是，VIM 确实有移动到对应（它将向前移动到下一个大括号/括号/等并跳转到相应的打开/关闭一个），使用 %-key（大多数键盘布局上的 shift-5 I相信吗？），所以基本上，站在左大括号之前的空格上， c%;<ESC> 将用分号替换整个正文。

找到一个函数的左大括号是完全不同的事情，我会看看我是否能为你想出一些东西，但是为了让你继续，执行一次，然后继续点击 . （句点）为每个函数再次执行它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T20:17:10.290

我不知道正则表达式可以匹配多行。彼得推荐宏可能是对的。在第一种方法上这样的事情可能会奏效：

```
[ESC]qa$d%i;0[ESC]q 
```

然后在其他方法的第一行，你可以这样做：

```
[ESC]@a 
```

下面是它的工作原理：

*   [ESC] - 退出键让你进入正确的模式
*   qa - 将下一个命令保存为名为“a”的宏
*   $ - 跳到行尾
*   d% - 删除到匹配的括号
*   一世; - 插入分号
*   [ESC] - 退出键让你进入正确的模式
*   q - 停止录制宏

* * *

*   @a - 再次调用宏（在下一个方法的行上）

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T19:44:25.020

我认为这是最好使用录制的宏而不是正则表达式来完成的事情。抱歉，我没有时间为您创建一个案例。要开始，请参阅：

```
:help q 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T02:09:49.080

正如 roe 所说，对所有可能的输入使用正则表达式是不可能的。您需要为您的语言提供完整的解析器。但是下面的正则表达式解决了可能就足够的问题的一个子集，只要您的文本非常规则并遵守一些约束：

*   左大括号是与方法标题在同一行的最后一个字符
*   右大括号的缩进量与开头行相同，位于单独的行中，并且是该行的最后一个字符
*   行以`int`or开头`void`（您可以扩展此列表以包括所有相关类型），忽略前导空格

所以这适用于您的示例输入：

```
:%s/\v((^\s+)(int|void).{-})\s+\{$\_.{-}^\2\}$/\1;/ 
```

*   `\v`：“非常神奇”模式（避免需要反斜杠转义所有内容）
*   `((^\s+)`: (开始捕获\1); 捕获该行的缩进级别
*   `(int|void)`：行中的第一个单词（根据需要添加到此列表中）
*   `.{-})`: 此行上的非贪婪匹配（结束 \1 的捕获）
*   `\s+{$`: 尽可能多的空格，然后是 a `{`，然后是行尾
*   `\_.{-}`：非贪婪匹配所有内容，包括换行符
*   `^\2\}$`：从一行的开头，匹配我们上面捕获的空格数，然后是行尾的大括号

如果您知道方法标题行缩进了多少个空格，则可以将其插入正则表达式中，`(^\s+)`以使其更加安全。

我保证你可以很容易地想到使这个正则表达式失败的可能输入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T08:48:18.073

我会使用 ctags 来构建在头文件中声明和定义的函数列表。该列表将包含内联定义的行，而不是查找该行的正则表达式。

然后以相反的顺序转到函数的定义行，搜索它的左括号，然后应用 ad%。只要函数的注释中没有任何不平衡的括号，它就应该可以正常工作。

顺便说一句，为了不丢失定义，我有一个[:MOVEIMPL 命令](http://code.google.com/p/lh-vim/wiki/lhCpp#Wizards_and_other_high-level_features)将内联函数定义移动到相关的.cpp。

# .net - 支持新的 .Net 应用程序的合理 Windows 版本是什么？

> ID：478120
> 
> 赞同：1
> 
> 时间：2009-01-25T19:37:24.677
> 
> 标签：.net, cross-platform, compatibility

如果我开发一个将在 WinXP 和 Vista 上运行的 .Net 应用程序，以及在 Mono 下的现代 Mac 或 Linux 上运行，那么如果我想要支持它们，我必须开始仔细考虑哪些旧版本的 Windows？例如，Windows 2000 是否运行 .Net，它是否支持任何版本的运行时？通常，较旧的系统也意味着较旧的硬件，我猜这也可能是一个问题。

* * *

**编辑**：阅读乔的回答让我在标题中重新表述了我的问题。如果 Win 2k 与 XP 的共同点已经比 Linux 低，那对我来说就差不多了。但是，我仍然愿意接受更多信息，并将支持更多有用的事实。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-25T21:12:28.023

由于[Mono](http://www.go-mono.com/mono-downloads/download.html)可以在您的所有目标平台（Win 2000+、Linux 和 Mac OSX）上运行，您可以使用它而不是 Microsoft .NET 来开发您的应用程序。这样做还可以减少以后让您的应用程序在非 Windows 平台上运行的痛苦（因为只要您不使用任何特定于平台的库，它就应该可以工作）。

话虽如此，如果您要开发可以在 Mono 下编译的东西，那么了解它的局限性是值得的。

例如，他们完全实现了 C# 2.0，但仅部分支持 C# 3.0。

Mono 也不是用于 Linux 的 .NET，它是跨平台的 CLR 的实现——某些库可能未实现（尽管核心库是）。

查看[维基百科页面](http://en.wikipedia.org/wiki/Mono_(software))和[他们的主页](http://mono-project.com/Main_Page)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T19:42:02.280

该框架的 2.0 版是 Win2k 支持的最后一个版本。我们距离结束对 Win2k 的支持还不到 18 个月。

你想支持win2k，还是需要支持？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T20:10:42.113

请注意， Windows 2000**不**支持 .NET 3.5。请参阅[自述](http://download.microsoft.com/download/9/a/e/9ae0f6cc-7032-408e-9ca7-989f9e4af4ec/dotNetReadMe.htm)文件。

# php - 如何在 PHP 中获取目录大小

> ID：478121
> 
> 赞同：71
> 
> 时间：2009-01-25T19:38:30.243
> 
> 标签：php, filesystems

```
function foldersize($path) {
  $total_size = 0;
  $files = scandir($path);

  foreach($files as $t) {
    if (is_dir(rtrim($path, '/') . '/' . $t)) {
      if ($t<>"." && $t<>"..") {
          $size = foldersize(rtrim($path, '/') . '/' . $t);

          $total_size += $size;
      }
    } else {
      $size = filesize(rtrim($path, '/') . '/' . $t);
      $total_size += $size;
    }
  }
  return $total_size;
}

function format_size($size) {
  $mod = 1024;
  $units = explode(' ','B KB MB GB TB PB');
  for ($i = 0; $size > $mod; $i++) {
    $size /= $mod;
  }

  return round($size, 2) . ' ' . $units[$i];
}

$SIZE_LIMIT = 5368709120; // 5 GB

$sql="select * from users order by id";
$result=mysql_query($sql);

while($row=mysql_fetch_array($result)) {
  $disk_used = foldersize("C:/xampp/htdocs/freehosting/".$row['name']);

  $disk_remaining = $SIZE_LIMIT - $disk_used;
  print 'Name: ' . $row['name'] . '<br>';

  print 'diskspace used: ' . format_size($disk_used) . '<br>';
  print 'diskspace left: ' . format_size($disk_remaining) . '<br><hr>';
} 
```

[php disk_total_space](https://stackoverflow.com/questions/466140/php-disktotalspace#466268)

知道为什么在脚本执行完成之前处理器使用率会飙升至过高或 100% 吗？可以做些什么来优化它吗？还是有任何其他替代方法来检查文件夹和其中的文件夹大小？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2014-01-28T15:19:28.237

```
function GetDirectorySize($path){
    $bytestotal = 0;
    $path = realpath($path);
    if($path!==false && $path!='' && file_exists($path)){
        foreach(new RecursiveIteratorIterator(new RecursiveDirectoryIterator($path, FilesystemIterator::SKIP_DOTS)) as $object){
            $bytestotal += $object->getSize();
        }
    }
    return $bytestotal;
} 
```

与 Janith Chinthana 建议的想法相同。有一些修复：

*   转换`$path`为[真实路径](http://www.php.net/manual/en/function.realpath.php)
*   仅当路径有效且文件夹存在时执行迭代
*   跳过`.`和`..`文件
*   针对性能进行了优化

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-01-25T20:01:46.873

以下是其他[地方提供](http://forums.devshed.com/showpost.php?p=1527717&postcount=4)的其他解决方案：

如果在 Windows 主机上：

```
<?
    $f = 'f:/www/docs';
    $obj = new COM ( 'scripting.filesystemobject' );
    if ( is_object ( $obj ) )
    {
        $ref = $obj->getfolder ( $f );
        echo 'Directory: ' . $f . ' => Size: ' . $ref->size;
        $obj = null;
    }
    else
    {
        echo 'can not create object';
    }
?> 
```

否则，如果在 Linux 主机上：

```
<?
    $f = './path/directory';
    $io = popen ( '/usr/bin/du -sk ' . $f, 'r' );
    $size = fgets ( $io, 4096);
    $size = substr ( $size, 0, strpos ( $size, "\t" ) );
    pclose ( $io );
    echo 'Directory: ' . $f . ' => Size: ' . $size;
?> 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-08-17T11:01:13.937

使用 php[文件大小](http://php.net/manual/en/function.filesize.php)和[RecursiveIteratorIterator](http://php.net/manual/en/class.recursiveiteratoriterator.php)的目录大小。

***这适用于任何具有 php 5 或更高版本的平台。***

```
/**
 * Get the directory size
 * @param  string $directory
 * @return integer
 */
function dirSize($directory) {
    $size = 0;
    foreach(new RecursiveIteratorIterator(new RecursiveDirectoryIterator($directory)) as $file){
        $size+=$file->getSize();
    }
    return $size;
} 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2011-12-01T21:15:29.707

一个纯 php 的例子。

```
<?php
    $units = explode(' ', 'B KB MB GB TB PB');
    $SIZE_LIMIT = 5368709120; // 5 GB
    $disk_used = foldersize("/webData/users/vdbuilder@yahoo.com");

    $disk_remaining = $SIZE_LIMIT - $disk_used;

    echo("<html><body>");
    echo('diskspace used: ' . format_size($disk_used) . '<br>');
    echo( 'diskspace left: ' . format_size($disk_remaining) . '<br><hr>');
    echo("</body></html>");

function foldersize($path) {
    $total_size = 0;
    $files = scandir($path);
    $cleanPath = rtrim($path, '/'). '/';

    foreach($files as $t) {
        if ($t<>"." && $t<>"..") {
            $currentFile = $cleanPath . $t;
            if (is_dir($currentFile)) {
                $size = foldersize($currentFile);
                $total_size += $size;
            }
            else {
                $size = filesize($currentFile);
                $total_size += $size;
            }
        }   
    }

    return $total_size;
}

function format_size($size) {
    global $units;

    $mod = 1024;

    for ($i = 0; $size > $mod; $i++) {
        $size /= $mod;
    }

    $endIndex = strpos($size, ".")+3;

    return substr( $size, 0, $endIndex).' '.$units[$i];
}

?> 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2014-12-03T07:53:15.830

```
function get_dir_size($directory){
    $size = 0;
    $files = glob($directory.'/*');
    foreach($files as $path){
        is_file($path) && $size += filesize($path);
        is_dir($path)  && $size += get_dir_size($path);
    }
    return $size;
} 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2013-09-02T07:57:34.770

感谢 Jonathan Sampson、Adam Pierce 和 Janith Chinthana，我进行了这一检查，以检查获取目录大小的最高效方式。应该在 Windows 和 Linux 主机上工作。

```
static function getTotalSize($dir)
{
    $dir = rtrim(str_replace('\\', '/', $dir), '/');

    if (is_dir($dir) === true) {
        $totalSize = 0;
        $os        = strtoupper(substr(PHP_OS, 0, 3));
        // If on a Unix Host (Linux, Mac OS)
        if ($os !== 'WIN') {
            $io = popen('/usr/bin/du -sb ' . $dir, 'r');
            if ($io !== false) {
                $totalSize = intval(fgets($io, 80));
                pclose($io);
                return $totalSize;
            }
        }
        // If on a Windows Host (WIN32, WINNT, Windows)
        if ($os === 'WIN' && extension_loaded('com_dotnet')) {
            $obj = new \COM('scripting.filesystemobject');
            if (is_object($obj)) {
                $ref       = $obj->getfolder($dir);
                $totalSize = $ref->size;
                $obj       = null;
                return $totalSize;
            }
        }
        // If System calls did't work, use slower PHP 5
        $files = new \RecursiveIteratorIterator(new \RecursiveDirectoryIterator($dir));
        foreach ($files as $file) {
            $totalSize += $file->getSize();
        }
        return $totalSize;
    } else if (is_file($dir) === true) {
        return filesize($dir);
    }
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-06-27T02:18:06.653

我发现这种方法更短且更兼容。由于某种原因，Mac OS X 版本的“du”不支持 -b（或 --bytes）选项，因此它坚持使用更兼容的 -k 选项。

```
$file_directory = './directory/path';
$output = exec('du -sk ' . $file_directory);
$filesize = trim(str_replace($file_directory, '', $output)) * 1024; 
```

返回以字节为单位的 $filesize。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-04-23T14:36:15.063

尽管这篇文章已经有很多答案，但我觉得我必须为 unix 主机添加另一个选项，它只返回目录中所有文件大小的总和（递归）。

如果您查看乔纳森的回答，他会使用该`du`命令。此命令将返回总目录大小，但其他人在此处发布的纯 PHP 解决方案将返回所有文件大小的总和。*巨大差距！*

## 需要注意什么

`du`在新创建的目录上运行时，它可能会返回`4K`而不是`0`. 从相关目录中删除文件后，这甚至可能会变得更加混乱，`du`报告的总目录大小与其中文件大小的总和不对应。为什么？`du`正如 Hermann Ingjaldsson 在[这篇文章](https://unix.stackexchange.com/q/86985/60074)中评论的那样，该命令会根据一些文件设置返回一份报告。

## 解决方案

要形成一个行为类似于此处发布的一些仅 PHP 脚本的解决方案，您可以使用`ls`命令并将其通过管道传递到`awk`如下所示：

```
ls -ltrR /path/to/dir |awk '{print \$5}'|awk 'BEGIN{sum=0} {sum=sum+\$1} END {print sum}' 
```

作为 PHP 函数，您可以使用如下内容：

```
function getDirectorySize( $path )
{
    if( !is_dir( $path ) ) {
        return 0;
    }

    $path   = strval( $path );
    $io     = popen( "ls -ltrR {$path} |awk '{print \$5}'|awk 'BEGIN{sum=0} {sum=sum+\$1} END {print sum}'", 'r' );
    $size   = intval( fgets( $io, 80 ) );
    pclose( $io );

    return $size;
} 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2012-01-31T09:23:02.707

Johnathan Sampson 的 Linux 示例对我来说不是很好。这是一个改进的版本：

```
function getDirSize($path)
{
    $io = popen('/usr/bin/du -sb '.$path, 'r');
    $size = intval(fgets($io,80));
    pclose($io);
    return $size;
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-10-26T06:16:39.713

它工作得很好。

```
 public static function folderSize($dir)
     {
        $size = 0;

        foreach (glob(rtrim($dir, '/') . '/*', GLOB_NOSORT) as $each) {
            $func_name = __FUNCTION__;
            $size += is_file($each) ? filesize($each) : static::$func_name($each);
        }

        return $size;
      } 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-25T19:56:27.553

您可以做几件事来优化脚本 - 但最大的成功将使其受 IO 限制而不是 CPU 限制：

1.  `rtrim($path, '/')`在循环外计算。
2.  进行`if ($t<>"." && $t<>"..")`外部测试 - 它不需要统计路径
3.  每个循环计算`rtrim($path, '/') . '/' . $t`一次 - 在 2) 内并考虑 1)。
4.  计算`explode(' ','B KB MB GB TB PB');`一次而不是每次调用？

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-08-14T17:40:08.093

## PHP 获取目录大小（通过 FTP 访问）

经过努力，这段代码效果很好！！！！我想与社区分享（通过 MundialSYS）

```
function dirFTPSize($ftpStream, $dir) {
    $size = 0;
    $files = ftp_nlist($ftpStream, $dir);

    foreach ($files as $remoteFile) {
        if(preg_match('/.*\/\.\.$/', $remoteFile) || preg_match('/.*\/\.$/', $remoteFile)){
            continue;
        }
        $sizeTemp = ftp_size($ftpStream, $remoteFile);
        if ($sizeTemp > 0) {
            $size += $sizeTemp;
        }elseif($sizeTemp == -1){//directorio
            $size += dirFTPSize($ftpStream, $remoteFile);
        }
    }

    return $size;
}

$hostname = '127.0.0.1'; // or 'ftp.domain.com'
$username = 'username';
$password = 'password';
$startdir = '/public_html'; // absolute path
$files = array();
$ftpStream = ftp_connect($hostname);
$login = ftp_login($ftpStream, $username, $password);
if (!$ftpStream) {
    echo 'Wrong server!';
    exit;
} else if (!$login) {
    echo 'Wrong username/password!';
    exit;
} else {
    $size = dirFTPSize($ftpStream, $startdir);
}

echo number_format(($size / 1024 / 1024), 2, '.', '') . ' MB';

ftp_close($ftpStream); 
```

好代码！费尔南多

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-11-26T13:24:09.010

面向对象的方法：

```
/**
 * Returns a directory size
 *
 * @param string $directory
 *
 * @return int $size directory size in bytes
 *
 */
function dir_size($directory)
{
    $size = 0;
    foreach(new RecursiveIteratorIterator(new RecursiveDirectoryIterator($directory)) as $file)
    {
        $size += $file->getSize();
    }
    return $size;
} 
```

速度与激情的方法：

```
function dir_size2($dir)
{
    $line = exec('du -sh ' . $dir);
    $line = trim(str_replace($dir, '', $line));
    return $line;
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-07-18T23:54:45.003

调整代码以访问主目录和其中的所有子文件夹。这将返回完整的目录大小。

```
function get_dir_size($directory){
    $size = 0;
    $files= glob($directory.'/*');
    foreach($files as $path){
        is_file($path) && $size += filesize($path);

        if (is_dir($path))
        {
            $size += get_dir_size($path);
        }
    }
    return $size;
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-05-16T17:58:05.003

如果您托管在 Linux 上：

```
passthru('du -h -s ' . $DIRECTORY_PATH) 
```

比foreach好

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-08-17T12:06:43.093

关于 Johnathan Sampson 的 Linux 示例，当您对“du”函数的结果执行 intval 时请注意，如果大小>2GB，它将一直显示 2GB。

**代替：**

```
$totalSize = intval(fgets($io, 80)); 
```

**经过：**

```
strtok(fgets($io, 80), " "); 
```

假设您的“du”函数返回用空格分隔的大小，后跟目录/文件名。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-01-21T00:50:39.960

只是另一个使用原生 php 函数的函数。

```
function dirSize($dir)
    {
        $dirSize = 0;
        if(!is_dir($dir)){return false;};
        $files = scandir($dir);if(!$files){return false;}
        $files = array_diff($files, array('.','..'));

        foreach ($files as $file) {
            if(is_dir("$dir/$file")){
                 $dirSize += dirSize("$dir/$file");
            }else{
                $dirSize += filesize("$dir/$file");
            }
        }
        return $dirSize;
    } 
```

注意：[此函数返回文件大小，而不是磁盘大小](https://superuser.com/questions/66825/what-is-the-difference-between-size-and-size-on-disk)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-03-13T14:20:08.317

从 Nate Haugs 的回答演变而来，我为我的项目创建了一个简短的函数：

```
function uf_getDirSize($dir, $unit = 'm')
{
    $dir = trim($dir, '/');
    if (!is_dir($dir)) {
        trigger_error("{$dir} not a folder/dir/path.", E_USER_WARNING);
        return false;
    }
    if (!function_exists('exec')) {
        trigger_error('The function exec() is not available.', E_USER_WARNING);
        return false;
    }
    $output = exec('du -sb ' . $dir);
    $filesize = (int) trim(str_replace($dir, '', $output));
    switch ($unit) {
        case 'g': $filesize = number_format($filesize / 1073741824, 3); break;  // giga
        case 'm': $filesize = number_format($filesize / 1048576, 1);    break;  // mega
        case 'k': $filesize = number_format($filesize / 1024, 0);       break;  // kilo
        case 'b': $filesize = number_format($filesize, 0);              break;  // byte
    }
    return ($filesize + 0);
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-06-13T01:16:50.043

单线解决方案。结果以字节为单位。

```
$size=array_sum(array_map('filesize', glob("{$dir}/*.*"))); 
```

额外的好处：您可以简单地将文件掩码更改为您喜欢的任何内容，并且只计算某些文件（例如通过扩展名）。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-08-04T04:34:05.673

这是找出目录大小的最简单的算法，与您使用的编程语言无关。对于 PHP 特定的实现。转到：[在 PHP 中计算目录大小 | 用算法解释 | 工作代码](https://fullstackgeek.blogspot.com/2019/08/calculate-directory-size-in-php.html)

[![](https://i.stack.imgur.com/ri9Bc.png)](https://i.stack.imgur.com/ri9Bc.png)

# ironpython - IronPython 中的 Pygments

> ID：478122
> 
> 赞同：4
> 
> 时间：2009-01-25T19:38:31.443
> 
> 标签：ironpython, syntax-highlighting

我正在尝试使用 IronPython.Hosting 和 Pygments 为我的博客创建 ASP.NET 语法荧光笔。问题是，Pygments 至少在没有黑客攻击的情况下不能在 IPy 2.0 上运行。

你知道如何让它工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T06:21:08.927

查看这篇文章[Pygments for Windows Live Writer](https://web.archive.org/web/20100109040325/http://devhawk.net/2009/04/05/Pygments+For+Windows+Live+Writer.aspx)。

那里有源代码和其他文件的链接，用于为 IronPython 编译 Pygments。

# sap - 最好的 SAP ERP 基础架构架构是什么？

> ID：478126
> 
> 赞同：2
> 
> 时间：2009-01-25T19:40:34.637
> 
> 标签：sap, infrastructure, sap-erp

我的公司正计划在我们的组织中实施 SAP HR。我们已经运行了其他模块。我们计划向大约 20 万用户提供 ESS/MSS。我们当前的配置是一台带有 Central Instance 的机器和 3 台带有 Dialogue Instances 的机器。数据库位于中央实例机器上。Enterprise Portal + DB 在单独的机器上运行。我们正在考虑将 HR 模块分离到一个单独的数据库中，以免在负载时杀死其他模块。这是一个有效的担忧吗？有没有更好的方法来构建系统？我正在考虑将数据库和中央实例分离到两台不同的机器上。我尝试在 SAP 市场上搜索有关 SAP 基础架构架构的任何建议，但没有任何运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T07:54:23.690

1.  分离 HR 是一个有效的选择。不仅是负载，HR模块也有非常严格的安全需求。这可能会给 QA 和开发系统的系统副本带来一些困难。
2.  将 Central 实例和 DB 分离到不同的机器是一个有效的选项。但我不会这样做（我们正在这样做......）。给以后的操作带来一定的麻烦。比如升级和数据库维护。从中央实例中移除尽可能多的负载更容易。只需将其从登录组中删除即可。所以只剩下消息服务器、入队进程和更新（可选但推荐）进程。

**更新 1：**将数据库与中心实例分开并不罕见。但它确实引入了一些复杂性。我认为，那是不必要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T18:50:19.730

我不太清楚“分离”是什么意思......

我将通过两个单独的 SAP 系统的想法，一个用于 HR，一个（或可能多个其他）用于其余系统。然后可以根据不同的要求对这些系统中的每一个进行调整/保护（人力资源系统许多用户，可能高对话使用；另一个系统可能更“面向批处理”）。

SAP 的总体战略也建议了这一点，几乎每个模块都在其自己的发布时间表上。

关于数据库和应用程序服务器（中央实例？）在不同的机器上.. 这确实很常见，也是最简单的调整措施之一。您可以将 Solaris 上的 AppServer 和 HP-UX 上的 DB 混合搭配得相当“无情”。

# javascript - 在 Ruby on Rails 中旋转图像，类似于 AJAX

> ID：478129
> 
> 赞同：1
> 
> 时间：2009-01-25T19:41:58.193
> 
> 标签：javascript, ruby-on-rails, ajax

我正在一个网站上工作，我想在用户在页面上时循环图像，类似于幻灯片。我四处寻找，但找不到线索。

有没有人用 Rails 和它支持的 Javascript 框架做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-25T20:06:25.227

您可以使用 jquery 循环插件，这是链接： http: [//malsup.com/jquery/cycle/](http://malsup.com/jquery/cycle/)。看起来它会做你想做的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T20:37:09.047

仅供参考，Rails 并不特别依赖于任何 JS 框架，即使它带有开箱即用的原型。

我假设当您说 AJAX 时，您并不是指 AJAX。如果您要使用 AJAX 旋转图像，您将在服务器端生成旋转图像并将其发送到客户端，因为 AJAX = 使用 javascript 执行请求。</pedantic>

话虽如此，您几乎可以使用[在 google](http://www.google.com/search?q=javascript+rotate+image)上找到的任何 JS 图像旋转器。

编辑：哦，你的意思是循环浏览图像，而不是顺时针旋转 90º 等（？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T09:40:16.987

我一直在使用这个非常简单的功能。它不使用任何框架，也不会在幻灯片之间褪色，但它应该可以帮助您入门。

```
function SlideShow( elem_id, hold_time )
{
  this.elem = document.getElementById( elem_id );
  this.slides = [];
  this.num_slides = 0;
  this.cur_slide = 1;
  this.add_slide = function( image )
  {
    this.slides[ this.num_slides++ ] = image;
  }
  var self = this;
  this.next_slide = function()
  {
    if ( self.num_slides > 1 )
    {
      self.elem.src = self.slides[ self.cur_slide++ ].src;
      if ( self.cur_slide == self.num_slides )
        self.cur_slide = 0;
    }
  }
  setInterval( self.next_slide, hold_time )
} 
```

参数是img标签的element_id和每张幻灯片显示的毫秒数。

add_slide 函数接受一个 JavaScript Image 对象。

cur_slide 初始化为 1 的原因是因为我使用第一张图像预加载了 img 标签。

在我的应用程序中，我在 window.onload 方法中创建幻灯片，并安排每个图像在加载时将其自身添加到幻灯片中。

示例（未经测试）：

```
window.onload = function() {
  var slide_show = new SlideShow( "slide_image", 4000 )

  { var img = new Image();
    img.onload = function(){ slide_show.add_slide(img); };
    img.src="/images/slide1.jpg"; }
   ...
   /* Repeated for each image */
} 
```

仅当您不关心幻灯片的顺序时，此方法才有效。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-25T20:25:16.047

我假设您想对图像进行持久更改。我正在开发一个 Rails 应用程序，我们在其中实现了与 snipshot.com 中的功能类似的调整大小、裁剪和旋转功能

在技​​术方面，我们使用 YUI 在用户界面中调整大小和裁剪，并在服务器上使用 RMagick 来处理图像并将结果发送回 UI。YUI 提供开箱即用的图像裁剪小部件。

我们也考虑过在 UI 中做一系列动作，然后将最后一个结果提交给服务器端处理，但这会导致结果不足。

# asp.net - 将 nuint 与 asp.net 网络表单一起使用

> ID：478134
> 
> 赞同：0
> 
> 时间：2009-01-25T19:44:37.110
> 
> 标签：asp.net, webforms, nunit

我有一个现有的 asp.net webforms 应用程序，其所有业务逻辑和 DAL 在 app_code 文件夹中。

使用 nunit 构建测试的最佳方法是什么？将单独的测试项目添加到解决方案中，还是必须将测试放在 app_Code 文件夹中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-26T01:56:05.160

我喜欢 Ayende 在下面博客文章中的建议。我会为测试创建一个单独的项目，但我会尝试在此之后不再添加另一个项目，只是文件夹。

[http://ayende.com/Blog/archive/2008/02/22/The-two-project-solution.aspx](http://ayende.com/Blog/archive/2008/02/22/The-two-project-solution.aspx)

*   MyApp o /Model o /Web o /Services o /Infrastructure
    *   MyApp.Tests

您不必将测试放在 app_code 文件夹中。

# visual-studio - 有没有办法在 Visual Studio 中使代码区域“只读”？

> ID：478135
> 
> 赞同：5
> 
> 时间：2009-01-25T19:45:26.657
> 
> 标签：visual-studio, readonly

每隔一段时间，我就完成了一段代码的修改，我想“锁定”或将代码区域设为“只读”。这样，我可以修改代码的唯一方法是先解锁它。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-25T19:48:35.167

在许多情况下，最简单的方法是使其成为*部分类型*- 即其源代码分布在多个文件中的单个类。然后，您可以使一个文件只读而另一个可写。

要声明部分类型，只需`partial`在声明中使用 contextual 关键字：

```
// MyClass.First.cs:
public partial class MyClass
{
    void Foo()
    {
        Bar();
    }

    void Baz()
    {
    }
}

// MyClass.Second.cs:
public partial class MyClass
{
    void Bar()
    {
        Baz();
    }
} 
```

正如你所看到的，它最终就像源都在同一个文件中一样——你可以毫无问题地从另一个文件中调用在一个文件中声明的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-25T20:24:38.153

将其编译成库 dll，供其他项目参考。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T19:47:23.533

将代码拆分为单独的文件，然后检查到源代码控制系统？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-25T20:25:50.053

鉴于您对部分课程的反驳......我无法在单个文件中知道，缺少文档。其他选择？

*   遗产; 但是基类中的受保护代码（在您控制的程序集中）；继承者只能调用`public`/`protected`成员
*   [postsharp](http://www.postsharp.org/) - 将受保护的逻辑粘贴在外部声明的属性中

但是，这两个仍然需要多个文件（可能还有多个程序集）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-08T21:37:02.007

如果您使用的是版本控制系统，这完全没有必要。因为一旦您将其签入，无论您编辑代码的哪一部分，您都可以随时进行差异化或回滚。哎呀，您可能会不小心清除了所有源代码，但仍然可以将其取回。

由于您想锁定代码的某些部分，我得到了一种非常糟糕的“[代码气味”。](http://en.wikipedia.org/wiki/Code_smell)我猜也许你在一个类中做的太多了，在这种情况下，将它重构为一组适当的类。事实上，在视觉工作室已经存在 10 多年之后，此功能不可用，这应该表明您这样做的愿望可能是设计不佳的结果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-25T20:18:34.607

> 我考虑过这一点，但我更愿意将课程保存在一个文件中。– 丹明

对不起，麦克。作为 SVN 预提交的一点巫术可能会抓住它，但除此之外没有其他解决方案
*// 如果您更改此代码，您将被解雇*

# asp.net - JavaScript window.open() 的奇怪 IE7 行为

> ID：478148
> 
> 赞同：2
> 
> 时间：2009-01-25T19:52:19.917
> 
> 标签：asp.net, javascript, internet-explorer

已知以下代码在三周前可以工作。在此期间，我们安装了 IE 7 和一堆安全补丁。最终的问题是，有谁知道如何恢复旧的行为？

**设想**

我们在网页 1 中有以下 JavaScript 代码（我们称之为 foo.aspx），它是在单击按钮时调用的：

```
window.open("http://Foo/App2/bar.aspx, "_blank", "titlebar,status,width=650,height=600"); 
```

第二个网页 (bar.aspx) 应该在 foo.aspx 之上打开。用户做一些事情，当他们单击按钮时，bar.aspx 使用 JavaScript 通过 window.opener.document 将 bar.aspx 中的一些值写回 foo.aspx 上的字段，分别寻址每个元素并修改其内部文本。然后用户关闭 bar.aspx 并且在他们离开的地方有 foo.aspx，除了现在它在某些字段中具有来自 bar.aspx 的值，并且用户愉快地使用 foo.aspx。这已经工作了两年多。

在过去的两周里，我们应用了一堆安全补丁并升级到 IE 7。现在的行为是这样的：

1.  如果我正在测试并且只是直接导航到 foo.aspx，然后单击按钮 bar.aspx 会打开，然后焦点突然切换回 foo.aspx 并弹出一个对话框，其中显示“您正在查看的网页正在尝试关闭窗口. 你想关闭这个窗口吗？” 如果我选择“否”，那么 foo.aspx 仍然存在，我必须使用 Alt-Tab 才能回到 bar.aspx，然后一切正常。但是，这对用户来说将是一个痛苦。注意：在 foo.aspx 和 bar.aspx 中都没有调用 close() 方法！！！所以我不明白为什么弹出窗口说的是它所说的。

2.  如果我通过应用程序访问 foo.aspx，这意味着它已经以编程方式而不是由用户显式打开，然后 bar.aspx 打开，您可以看到 foo.aspx 在它后面消失（关闭）。然后 bar.aspx 收到 JavaScript 错误，因为 window.opener 不再可用。

场景 #1 不是最优的，但至少是一个有效的解决方法（如果有一些用户培训问题来训练他们点击“否”，然后是 Alt-Tab，在这之前都没有发生。场景 #2 是考虑到 bar.aspx 的全部目的是将这些值写回 foo.aspx，这在极端情况下是非最优的。

**其他注意事项**

1.  现在我们已经安装了 IE 7 和后续的 Active Directory 策略更改，即使在 IE 6 上也会发生这种行为。

2.  foo.aspx 和 bar.aspx 都在 Web 服务器上运行，在同一个网站上，但在不同的虚拟目录中。这些是内部应用程序，只有经过身份验证的用户才能从我们的网络内部访问。

3.  将服务器置于 Intranet 区域（通常位于该区域）或受信任站点中没有任何区别。我在区域和高级设置中都看不到适用于此行为的设置，并且 Intranet 和受信任的站点区域的策略都设置得非常自由，尤其是在脚本行为方面。

4.  我可以在 bar.aspx 及其客户端脚本中进行任何我需要的更改，但仅限于能够更改 foo.aspx 中的按钮单击 JavaScript 代码（该页面由供应商提供，而 bar.aspx是内部开发的）。

5.  我重申，除了通过 window.opener.document 进行更新之外，bar.aspx 没有触及 foo.aspx，当然也没有尝试对其调用 close()。

所以，问题仍然是在 IE 7 中，或者更有可能在安全补丁中，会破坏这个？我们有一家姊妹店在 IE 7 上运行相同的代码，他们没有报告这个问题。所以看起来它必须是环境的东西，现在我一直在想它必须是一个被应用的补丁。我会使用知识库文章、IE 设置、注册表破解、JavaScript 更改或其他任何方法来解决此问题。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-31T23:25:00.353

以编程方式打开一个窗口并将名称设置为_blank，你为什么这样做？我并不是说这与您的问题有关，但这可能不是一个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T20:02:54.077

这可能是一个错字，但示例代码中的 bar.aspx 后面缺少一个 "。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T20:36:50.717

奇怪的是，到目前为止，我要做的第一件事就是修复代码中的一些奇怪的东西。

使用不带协议或服务器名称的绝对路径（例如“/App2/bar.aspx”），因为应用程序位于同一服务器上。

您实际上无法控制 Intranet 区域之外的标题栏或状态栏，因此请从选项列表中删除这些值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-25T22:40:33.230

弹出窗口拦截器是否关闭了弹出窗口？

# machine-learning - 有哪些机器学习基准？

> ID：478158
> 
> 赞同：10
> 
> 时间：2009-01-25T19:57:31.733
> 
> 标签：machine-learning, benchmarking

您知道哪些机器学习基准测试存储库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-10T22:48:35.347

尝试 UCI 机器学习存储库

[http://archive.ics.uci.edu/ml/](http://archive.ics.uci.edu/ml/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-03-17T03:53:42.247

[MLPerf](https://mlperf.org/)似乎是新兴的行业/学术界支持的 ML 基准测试套件。回购在[这里](https://github.com/mlperf)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T11:17:02.167

大多数机器学习系统都是高度特定的，因此，它们之间的基准不太可能有用。

一个能很好地学习如何识别口语（并因此输入语音）的系统，不一定能很好地找到旅行商问题中的最短路径。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-06T06:09:38.030

[这里](http://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/)有一个列表（大多数是UCI）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-03-17T05:25:55.627

如果您正在寻找专门用于 NLP 的机器学习，这是一个精心策划的资源：

[http://nlpprogress.com/](http://nlpprogress.com/)

本质上，它是跟踪自然语言处理 (NLP) 进展的网页 (github repo)，包括最常见 NLP 任务的数据集和当前最先进的技术。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-25T20:02:32.470

我过去使用过[Weka](http://www.cs.waikato.ac.nz/ml/weka/)，它非常好，并且有很多基准测试的东西。

# c++ - 如何在 C++ 中创建高效的二维网格？

> ID：478165
> 
> 赞同：4
> 
> 时间：2009-01-25T20:03:40.643
> 
> 标签：c++, stl, vector

我想创建一个非常易于使用的 2D 网格。网格中的每个单元格都需要能够存储大量数据。理想情况下，我希望能够一次遍历一个网格，并获得任何网格单元的直接邻居。

我的第一个想法是存储一个指向 Cell 邻居（总共 4 个）的指针向量，然后为 leftNeighbour、rightNeighbour 等创建便利函数。在初始化后连接网格。

std::vector 应该是一个动态可调整大小的数组，所以如果我只想硬编码指针的位置（0 == 左，1 == 右等），这让我觉得没有必要。但是，它确实允许以更好的方式遍历单元格的邻居。我必须考虑的另一件事是该单元格是否位于网格边缘的边界上（是否对此进行测试或只是隐式地将网格扩展一个单元格，这样就不会发生这种情况）。

谁能提出一个更好的选择，或者这听起来像一个合理的设计？

谢谢，丹

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-25T20:57:49.287

如果您想要一个四向迭代器，请自己制作：

```
template<typename T, int width, int height>
class Grid {
    public:
        T data[width * height];

        iterator begin() {
            return iterator(data);
        }

        iterator end() {
            return iterator(data + width * height);
        }

        class iterator {
            public:
                iterator(const iterator &other) :
                    ptr(other.ptr)
                {
                }

                iterator &left() const {
                    return iterator(ptr - 1);
                }

                iterator &right() const {
                    return iterator(ptr + 1);
                }

                iterator &up() const {
                    return iterator(ptr - width);
                }

                iterator &down() const {
                    return iterator(ptr + width);
                }

                iterator &operator++() {
                    ++ptr;
                    return *this;
                }

                iterator &operator--() {
                    --ptr;
                    return *this;
                }

                iterator operator++(int) {
                    ++*this;
                    return iterator(ptr + 1);
                }

                iterator operator--(int) {
                    --*this;
                    return iterator(ptr - 1);
                }

                T operator*() const {
                    return *ptr;
                }

            private:
                iterator();
                iterator(T *ptr_) :
                    ptr(ptr_)
                {
                }

                T *ptr;

                friend class Grid;
        };
}; 
```

您可能想检测是否碰到了网格的边缘，除其他外，这将必须实施。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-25T20:18:52.720

我会选择 Boost.MultiArray

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T21:28:48.210

看看[GIL](http://www.boost.org/doc/libs/1_37_0/libs/gil/doc/index.html)，它是一个通用的图像处理库。除其他外，它具有用于迭代图像的 2D 迭代器，并且非常通用，您也可以直接将其用于您的东西。至少值得一看如何实现这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-25T20:28:40.140

我假设您不想要 I-would-think-of-this-first 方法`std::vector<std::vector<T> >`，而是需要允许更复杂结构的方法。

在这种情况下，为什么不创建一个`Node`类（或结构）：

```
template<typename T>
class Node {
    public:
        typedef Node<T> *iterator;
        // and const_iterator

        T data;

        Node(T data_ = T()) :
            data(data_)
        {
        }

        Node<T> *&left() {
            return neighbors[0];
        }

        // etc.

        iterator begin() {
            return neighbors;
        }

        iterator end() {
            return neighbors + 4;
        }

    private:
        Node<T> *neighbors[4];
}; 
```

这是可迭代的（这是您的标准之一）并且不使用动态分配来存储邻居。

# c# - 什么时候可以调用 GC.Collect？

> ID：478167
> 
> 赞同：193
> 
> 时间：2009-01-25T20:04:21.767
> 
> 标签：c#, .net, garbage-collection

一般的建议是你不应该`GC.Collect`从你的代码中调用，但是这条规则的例外是什么？

我只能想到一些非常具体的情况，强制垃圾收集可能是有意义的。

一个浮现在脑海中的例子是一项服务，它每隔一段时间就会醒来，执行一些任务，然后长时间休眠。在这种情况下，强制收集以防止即将空闲的进程占用比需要更多的内存可能是一个好主意。

还有其他可以打电话的情况`GC.Collect`吗？

* * *

## 回答 #1

> 赞同：168
> 
> 时间：2009-01-25T20:09:38.540

如果您有充分的理由相信一组重要的对象（尤其是您怀疑属于第 1 代和第 2 代的对象）现在可以进行垃圾回收，那么就性能影响较小而言，现在是进行垃圾回收的合适时机.

一个很好的例子是，如果您刚刚关闭了一个大表单。您知道所有的 UI 控件现在都可以被垃圾回收，并且在表单关闭时很短的暂停可能不会被用户注意到。

更新 2.7.2018

从 .NET 4.5 开始 - 有`GCLatencyMode.LowLatency`和`GCLatencyMode.SustainedLowLatency`. 进入和离开这两种模式时，建议您使用`GC.Collect(2, GCCollectionMode.Forced)`.

从 .NET 4.6 开始 - 有`GC.TryStartNoGCRegion`方法（用于设置只读值`GCLatencyMode.NoGCRegion`）。这本身可以执行完全阻塞垃圾回收以尝试释放足够的内存，但鉴于我们在一段时间内不允许 GC，我认为在前后执行完全 GC 也是一个好主意。

资料来源：Microsoft 工程师 Ben Watson 的：*编写高性能 .NET 代码*，第 2 版。2018 年。

看：

*   [https://msdn.microsoft.com/en-us/library/system.runtime.gclatencymode(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.runtime.gclatencymode(v=vs.110).aspx)
*   [https://msdn.microsoft.com/en-us/library/dn906204(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/dn906204(v=vs.110).aspx)

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-01-25T20:31:13.677

我`GC.Collect`只在编写粗略的性能/分析器测试台时使用；即我有两个（或更多）代码块要测试 - 例如：

```
GC.Collect(GC.MaxGeneration, GCCollectionMode.Forced);
TestA(); // may allocate lots of transient objects
GC.Collect(GC.MaxGeneration, GCCollectionMode.Forced);
TestB(); // may allocate lots of transient objects
GC.Collect(GC.MaxGeneration, GCCollectionMode.Forced);
... 
```

因此，`TestA()`并`TestB()`以尽可能相似的状态运行 - 即`TestB()`不会因为`TestA`离开它非常接近临界点而受到打击。

一个经典的例子是一个简单的控制台 exe（例如`Main`，一种足以在此处发布的方法），它显示了循环字符串连接和`StringBuilder`.

如果我需要一些精确的东西，那么这将是两个完全独立的测试——但如果我们只想在测试期间最小化（或标准化）GC 以获得对行为的粗略感觉，这通常就足够了。

在生产代码期间？我还没有使用它;-p

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-09-24T15:47:52.027

**最佳做法是在大多数情况下不强制进行垃圾收集。** （我工作过的每个系统都强制进行垃圾收集，有强调的问题，如果解决了就不需要强制垃圾收集，并且大大加快了系统的速度。）

在某些**情况下**，**您**比垃圾收集器更了解内存使用情况。在多用户应用程序或一次响应多个请求的服务中，这不太可能是真的。

但是，在某些**批处理类型的处理**中，您确实比 GC 了解更多。例如，考虑一个应用程序。

*   在命令行上给出文件名列表
*   处理单个文件，然后将结果写入结果文件。
*   在处理文件时，会创建很多相互关联的对象，直到文件处理完成（例如解析树）才能收集这些对象
*   **在已处理的文件之间不保持匹配状态**。

您*可能*能够进行案例（经过仔细的）测试，在处理完每个文件后，您应该强制进行完整的垃圾回收。

另一种情况是每隔几分钟唤醒一次以处理某些项目的服务，并且**在它处于睡眠状态时不保持任何状态**。然后在睡觉前强制收集完整的数据*可能*是值得的。

> 我会考虑强制收集的唯一一次是当我知道最近创建了很多对象并且当前引用的对象很少时。

我宁愿有一个垃圾收集 API，因为我可以给它提示这种类型的事情，而不必强迫我自己进行 GC。

另见“ [Rico Mariani 的表演花絮](http://blogs.msdn.com/ricom/archive/2004/11/29/271829.aspx)”

* * *

这些天我认为上述相同的情况最好使用一个短暂的工作进程来完成每批工作并让操作系统进行资源恢复。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-01-25T20:08:21.837

一种情况是您尝试对使用[Wea​​kReference](http://msdn.microsoft.com/en-us/library/system.weakreference.aspx)的代码进行单元测试。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2011-03-21T21:36:06.860

在大型 24/7 或 24/6 系统中——对消息、RPC 请求作出反应或连续轮询数据库或进程的系统——有一种方法来识别内存泄漏是很有用的。为此，我倾向于向应用程序添加一种机制，以暂时暂停任何处理，然后执行完整的垃圾回收。这会将系统置于静止状态，其中剩余的内存要么是合法的长期存在的内存（缓存、配置等），要么是“泄漏的”（不期望或不希望被植根但实际上是根的对象）。

拥有这种机制可以更轻松地分析内存使用情况，因为报告不会被来自主动处理的噪音所笼罩。

为了确保你得到所有的垃圾，你需要执行两个收集：

```
GC.Collect();
GC.WaitForPendingFinalizers();
GC.Collect(); 
```

因为第一次收集将导致任何具有终结器的对象被终结（但实际上不是垃圾收集这些对象）。第二次 GC 将垃圾收集这些最终对象。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-01-25T20:54:56.920

`GC.Collect()`当你知道垃圾收集器不知道的应用程序的性质时，你可以打电话。

作为作者，通常很容易认为这是可能的或正常的。然而，事实是 GC 相当于一个编写良好且经过测试的专家系统，您很少了解它所不了解的低级代码路径。

我能想到的最好的例子是你可能有一些额外信息的地方是一个在空闲时间和非常繁忙时间之间循环的应用程序。您希望在繁忙时段获得最佳性能，因此希望使用空闲时间进行一些清理。

然而，大多数时候 GC 足够聪明，无论如何都可以做到这一点。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2013-10-17T23:06:55.610

作为内存碎片解决方案。在将大量数据写入内存流（从网络流中读取）时，我遇到了内存异常。数据以 8K 块的形式写入。达到 128M 后，即使有很多可用内存（但它是碎片化的），也会出现异常。调用 GC.Collect() 解决了这个问题。修复后我能够处理超过 1G 的流量。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2017-07-11T17:10:43.470

几乎需要调用 GC.Collect() 的一种情况是通过 Interop 自动化 Microsoft Office。Office 的 COM 对象不喜欢自动释放，可能会导致 Office 产品的实例占用大量内存。我不确定这是一个问题还是设计使然。网上有很多关于这个话题的帖子，所以我不会太详细。

使用 Interop 进行编程时，应手动释放*每个COM 对象，通常通过使用 Marshal.ReleseComObject()。*此外，手动调用垃圾收集可以帮助“清理”一点。完成 Interop 对象后调用以下代码似乎很有帮助：

```
GC.Collect()
GC.WaitForPendingFinalizers()
GC.Collect() 
```

以我个人的经验，结合使用 ReleaseComObject 和手动调用垃圾回收可以*大大*减少 Office 产品，特别是 Excel 的内存使用量。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-01-25T20:08:05.893

看看 Rico Mariani 的这篇文章。当调用 GC.Collect 时，他给出了两条规则（规则 1 是：“不要”）：

[何时调用 GC.Collect()](http://blogs.msdn.com/ricom/archive/2004/11/29/271829.aspx)

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2017-09-08T18:30:31.023

我正在对数组和列表进行一些性能测试：

```
private static int count = 100000000;
private static List<int> GetSomeNumbers_List_int()
{
    var lstNumbers = new List<int>();
    for(var i = 1; i <= count; i++)
    {
        lstNumbers.Add(i);
    }
    return lstNumbers;
}
private static int[] GetSomeNumbers_Array()
{
    var lstNumbers = new int[count];
    for (var i = 1; i <= count; i++)
    {
        lstNumbers[i-1] = i + 1;
    }
    return lstNumbers;
}
private static int[] GetSomeNumbers_Enumerable_Range()
{
    return  Enumerable.Range(1, count).ToArray();
}

static void performance_100_Million()
{
    var sw = new Stopwatch();

    sw.Start();
    var numbers1 = GetSomeNumbers_List_int();
    sw.Stop();
    //numbers1 = null;
    //GC.Collect();
    Console.WriteLine(String.Format("\"List<int>\" took {0} milliseconds", sw.ElapsedMilliseconds));

    sw.Reset();
    sw.Start();
    var numbers2 = GetSomeNumbers_Array();
    sw.Stop();
    //numbers2 = null;
    //GC.Collect();
    Console.WriteLine(String.Format("\"int[]\" took {0} milliseconds", sw.ElapsedMilliseconds));

    sw.Reset();
    sw.Start();
//getting System.OutOfMemoryException in GetSomeNumbers_Enumerable_Range method
    var numbers3 = GetSomeNumbers_Enumerable_Range();
    sw.Stop();
    //numbers3 = null;
    //GC.Collect();

    Console.WriteLine(String.Format("\"int[]\" Enumerable.Range took {0} milliseconds", sw.ElapsedMilliseconds));
} 
```

我进入`OutOfMemoryException`了 GetSomeNumbers_Enumerable_Range 方法，唯一的解决方法是通过以下方式释放内存：

```
numbers = null;
GC.Collect(); 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-25T20:08:52.553

在您的示例中，我认为调用 GC.Collect 不是问题，而是存在设计问题。

如果您打算每隔一段时间（设定时间）醒来，那么您的程序应该设计为单次执行（执行一​​次任务）然后终止。然后，您将程序设置为计划任务以按计划的时间间隔运行。

这样，您就不必担心调用 GC.Collect（如果有的话，您应该*很少*这样做）。

话虽如此，Rico Mariani 有一篇关于这个主题的精彩博文，可以在这里找到：

[http://blogs.msdn.com/ricom/archive/2004/11/29/271829.aspx](http://blogs.msdn.com/ricom/archive/2004/11/29/271829.aspx)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-01-25T20:13:21.967

Scott Holden[关于何时（以及何时不）调用 GC.Collect 的博客条目](http://web.archive.org/web/20190113104236/https://blogs.msdn.microsoft.com/scottholden/2004/12/28/the-perils-of-gc-collect-or-when-to-use-gc-collect/)是特定于[.NET Compact Framework](http://en.wikipedia.org/wiki/.NET_Compact_Framework)的，但这些规则通常适用于所有托管开发。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2013-07-03T20:33:58.200

调用 GC.Collect() 的一个有用的地方是在单元测试中，当您想要验证您没有造成内存泄漏时（例如，如果您正在使用 Wea​​kReferences 或 ConditionalWeakTable、动态生成的代码等）。

例如，我有一些测试，例如：

```
WeakReference w = CodeThatShouldNotMemoryLeak();
Assert.IsTrue(w.IsAlive);
GC.Collect();
GC.WaitForPendingFinalizers();
Assert.IsFalse(w.IsAlive); 
```

可以说使用 Wea​​kReferences 本身就是一个问题，但似乎如果您正在创建一个依赖于此类行为的系统，那么调用 GC.Collect() 是验证此类代码的好方法。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2011-08-18T20:14:32.443

在某些情况下，它比抱歉更安全。

这是一种情况。

可以使用 IL 重写在 C# 中创建**非托管**DLL（因为在某些情况下这是必要的）。

现在假设，例如，DLL 在类级别创建一个字节数组 - 因为许多导出的函数需要访问这些。卸载 DLL 时会发生什么？此时会自动调用垃圾收集器吗？我不知道，但作为**非托管**DLL，完全有可能不调用 GC。如果它不被调用，那将是一个大问题。当 DLL 被卸载时，垃圾收集器也是如此——那么谁将负责收集任何可能的垃圾，他们将如何做呢？最好使用 C# 的垃圾收集器。有一个清理功能（可用于 DLL 客户端），其中类级别变量设置为 null 并调用垃圾收集器。

安全总比后悔好。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2014-02-22T22:58:30.030

你应该尽量避免使用 GC.Collect() 因为它非常昂贵。这是一个例子：

```
 public void ClearFrame(ulong timeStamp)
    {
        if (RecordSet.Count <= 0) return;
        if (Limit == false)
        {
            var seconds = (timeStamp - RecordSet[0].TimeStamp)/1000;
            if (seconds <= _preFramesTime) return;
            Limit = true;
            do
            {
                RecordSet.Remove(RecordSet[0]);
            } while (((timeStamp - RecordSet[0].TimeStamp) / 1000) > _preFramesTime);
        }
        else
        {
            RecordSet.Remove(RecordSet[0]);

        }
        GC.Collect(); // AVOID
    } 
```

**测试结果：CPU 使用率 12%**

当您更改为：

```
 public void ClearFrame(ulong timeStamp)
    {
        if (RecordSet.Count <= 0) return;
        if (Limit == false)
        {
            var seconds = (timeStamp - RecordSet[0].TimeStamp)/1000;
            if (seconds <= _preFramesTime) return;
            Limit = true;
            do
            {
                RecordSet[0].Dispose(); //  Bitmap destroyed!
                RecordSet.Remove(RecordSet[0]);
            } while (((timeStamp - RecordSet[0].TimeStamp) / 1000) > _preFramesTime);
        }
        else
        {
            RecordSet[0].Dispose(); //  Bitmap destroyed!
            RecordSet.Remove(RecordSet[0]);

        }
        //GC.Collect();
    } 
```

**测试结果：CPU 使用率 2-3%**

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-01-25T20:19:45.667

简短的回答是：从不！

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2011-08-05T05:10:42.160

```
using(var stream = new MemoryStream())
{
   bitmap.Save(stream, ImageFormat.Png);
   techObject.Last().Image = Image.FromStream(stream);
   bitmap.Dispose();

   // Without this code, I had an OutOfMemory exception.
   GC.Collect();
   GC.WaitForPendingFinalizers();
   //
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-06-26T07:30:27.420

我对此仍然很不确定。我在应用服务器上工作了 7 年。我们更大的安装使用 24 GB 内存。它高度多线程，所有对 GC.Collect() 的调用都遇到了非常糟糕的性能问题。

许多第三方组件在他们认为现在这样做很聪明时使用了 GC.Collect()。因此，一堆简单的 Excel 报告每分钟多次阻塞所有线程的应用服务器。

我们必须重构所有 3rd 方组件以删除 GC.Collect() 调用，并且在这样做之后一切正常。

但是我也在 Win32 上运行服务器，在这里我在收到 OutOfMemoryException 后开始大量使用 GC.Collect()。

但我对此也很不确定，因为我经常注意到，当我在 32 位上获得 OOM 时，我再次尝试再次运行相同的操作，而无需调用 GC.Collect()，它工作得很好。

我想知道的一件事是 OOM 异常本身......如果我编写了 .Net 框架，但我无法分配内存块，我会使用 GC.Collect()、碎片整理内存 (??)，再试一次，如果我仍然找不到可用的内存块，那么我会抛出 OOM 异常。

或者至少将此行为设置为可配置选项，因为 GC.Collect 存在性能问题。

现在我的应用程序中有很多这样的代码来“解决”这个问题：

```
public static TResult ExecuteOOMAware<T1, T2, TResult>(Func<T1,T2 ,TResult> func, T1 a1, T2 a2)
{

    int oomCounter = 0;
    int maxOOMRetries = 10;
    do
    {
        try
        {
            return func(a1, a2);
        }
        catch (OutOfMemoryException)
        {
            oomCounter++;
            if (maxOOMRetries > 10)
            {
                throw;
            }
            else
            {
                Log.Info("OutOfMemory-Exception caught, Trying to fix. Counter: " + oomCounter.ToString());
                System.Threading.Thread.Sleep(TimeSpan.FromSeconds(oomCounter * 10));
                GC.Collect();
            }
        }
    } while (oomCounter < maxOOMRetries);

    // never gets hitted.
    return default(TResult);
} 
```

（请注意，Thread.Sleep() 行为是一个真正的 App 特定行为，因为我们正在运行一个 ORM 缓存服务，如果 RAM 超过一些预定义的值，该服务需要一些时间来释放所有缓存的对象。所以它等待一个第一次只有几秒钟，每次出现OOM都会增加等待时间。）

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-11-12T01:42:01.833

另一个原因是您在 USB COM 端口上打开了 SerialPort，然后拔下 USB 设备。因为 SerialPort 已打开，该资源在系统注册表中保存对先前连接的端口的引用。系统的注册表将[包含陈旧](https://docs.microsoft.com/en-us/dotnet/api/system.io.ports.serialport.getportnames?redirectedfrom=MSDN&view=netframework-4.8#remarks)的数据，因此可用端口列表将是错误的。因此端口必须关闭。

在端口上调用 SerialPort.Close() 会在对象上调用 Dispose()，但它会一直保留在内存中，直到垃圾收集器实际运行，从而导致注册表在垃圾收集器决定释放资源之前保持陈旧状态。

来自[https://stackoverflow.com/a/58810699/8685342](https://stackoverflow.com/a/58810699/8685342)：

```
try
{
    if (port != null)
        port.Close(); //this will throw an exception if the port was unplugged
}
catch (Exception ex) //of type 'System.IO.IOException'
{
    System.GC.Collect();
    System.GC.WaitForPendingFinalizers();
}

port = null; 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-05-27T02:17:13.947

如果您正在创建大量新`System.Drawing.Bitmap`对象，垃圾收集器不会清除它们。最终 GDI+ 会认为您的内存不足并会抛出“参数无效”异常。`GC.Collect()`每隔一段时间（不要太频繁！）打电话似乎可以解决这个问题。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-25T20:36:08.193

这与问题无关，但对于 .NET (XSLCompiledTranform) 中的 XSLT 转换，您可能别无选择。另一个候选者是 MSHTML 控件。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-08-16T10:46:12.707

如果您使用的 .net 版本低于 4.5，手动收集可能是不可避免的（尤其是在您处理许多“大对象”时）。

此链接描述了原因：

[https://blogs.msdn.microsoft.com/dotnet/2011/10/03/large-object-heap-improvements-in-net-4-5/](https://blogs.msdn.microsoft.com/dotnet/2011/10/03/large-object-heap-improvements-in-net-4-5/)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-01-08T14:13:16.127

调用 GC 的一个很好的理由是在内存很少的小型 ARM 计算机上，例如 Raspberry PI（使用单声道运行）。如果未分配的内存碎片占用了过多的系统 RAM，那么 Linux 操作系统可能会变得不稳定。我有一个应用程序，我必须每秒调用一次 GC（！）以摆脱内存溢出问题。

另一个好的解决方案是在不再需要对象时处理它们。不幸的是，在很多情况下这并不容易。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-12-28T02:06:25.233

由于有小对象堆（SOH）和大对象堆（LOH）

我们可以调用 GC.Collect() 来清除 SOP 中的取消引用对象，并将活着的对象移动到下一代。

在.net4.5中，我们也可以使用[largeobjectheapcompactionmode来压缩LOH](https://msdn.microsoft.com/en-us/library/system.runtime.gcsettings.largeobjectheapcompactionmode(v=vs.110).aspx)

# c++ - 在哪里寻找贡献者？

> ID：478194
> 
> 赞同：2
> 
> 时间：2009-01-25T20:18:20.397
> 
> 标签：c++, mapreduce

我最近遇到了一个不那么典型的编程问题。我在哪里寻找贡献者？我正在扩展一个已经存在的项目 Hypertable，并且我正在寻找一两个人来帮助实施一些东西。我正在处理的项目的扩展是一个 MapReduce 框架，一旦完成，它将完成完全开源的谷歌堆栈替代方案。

您对在哪里寻求帮助有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T20:27:14.917

如果您打算在 OpenSource 许可下提供您的工作（我相信您会这样做，因为 Hypertable 是获得 GPL 许可的），您可能最好在 Hypertable 邮件列表中描述您打算做什么。你最有可能在那里找到感兴趣的人。

我的建议是用一些代码补丁来支持你的意图，以展示你将要做什么——如果这是可行的。让那里的开发人员社区了解自己，并检查他们是否对外部贡献开放，或者他们是否已经在研究您打算提供的内容。

有很多关于如何参与开源项目的资源。寻找那些（也许有人可以在这里提供一个很好的参考），看看他们是否适用于你/这个项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T01:27:21.863

如果我是你，我会做以下事情：

*   写一些文件，描述你想要做什么，为什么要这样做，以及你将如何做。这介于使命陈述和规范之间，它应该包含您所知道的细节，但也应该广泛地描述为什么这是一件好事，以及谁会觉得它有用。
*   获取您目前拥有的所有代码和相关数据，并将其放在可公开访问的地方，例如 GitHub 或 SourceForge。
*   制作一个简单的网页，将代码访问与您编写的任何文本集成在一起。
*   通知您认为会感兴趣的人。这包括邮件列表、类似想法的网站、您在您的领域遇到的人，以及您认为可能会帮助您实现想法的业内私人朋友。如果你能在联系别人之前完成我上面建议的部分或全部准备工作，人们更有可能认真对待你，因为你会散发出一些组织的光环。
*   在您处理事物时，发布过时的更新，这样查看您网页的人就不必怀疑您的事物是否仍在积极开发中。

在互联网上从随机的人那里获得帮助部分是关于营销的，所以即使不是编码，也不要忽视你工作的这方面。从事新事物很有趣，祝你好运。同样正如 DOK 指出的那样，以前已经回答过类似的问题，所以也要检查这些答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T20:27:29.940

首先将您的代码或您的想法上传到一个常见的共享网站，如 google code 或 codeplex，然后打开一个博客以向您的项目添加更新，您需要出售您的想法并且贡献者会出现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-25T20:33:59.960

好吧，我已经是（不常见的）Hypertable 贡献者，并且或多或少地参与了一个项目，但 Hypertable 团队的问题是他们越来越多地参与数据存储本身。所以我想问题应该是如何在项目社区之外找到可能对项目感兴趣的贡献者？我是否注定要通过维护博客等以被动的方式寻找贡献者？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T09:00:35.537

Hypertable 团队确实主要专注于将产品带到 1.0 测试版。它肯定会到达那里。即使是 alpha 版本 Hypertable 的稳定性也相当出色。根据我所见，人们正在放弃 HBase 和 Cassandra 并采用 Hypertable。百度背书是该项目的主要 PR 胜利（听说 DB 大小高达 1PB，遇到和解决的大部分问题都来自 Hadoop）

map-reduce 扩展在 1.0 后的计划中。对此类扩展缺乏兴趣的一个原因是现有的 map-reduce 框架，如 Hadoop（以及方便的包装器，如 Cascading）与 Hypertable（使用各种方式（直接或 Thrift）访问 Hypertable 的 map/reduce 作业）配合得很好）

我为之一，欢迎替代 map-reduce 框架。但它被认为是大量的工作而没有太多的回报。随意证明他们错了:)

# language-agnostic - 如何测试应用程序的正确编码（例如 UTF-8）

> ID：478201
> 
> 赞同：20
> 
> 时间：2009-01-25T20:20:17.227
> 
> 标签：language-agnostic, testing, encoding, utf-8

编码问题是开发过程中最常困扰我的一个话题之一。每个平台都坚持自己的编码，很可能游戏中有一些非 UTF-8 默认值。（我通常在 Linux 上工作，默认为 UTF-8，我的同事大多在德语 Windows 上工作，默认为 ISO-8859-1 或一些类似的 Windows 代码页）

我相信，UTF-8 是开发 i18nable 应用程序的合适标准。然而，根据我的经验，编码错误通常是较晚发现的（即使我位于德国，并且我们有一些特殊字符与 ISO-8859-1 一起提供了一些可检测的差异）。

我相信那些使用完全非 ASCII 字符集的开发人员（或者那些知道使用这种字符集的语言的开发人员）在提供测试数据方面已经取得了领先。但是，我们其他人也必须有一种方法来缓解这种情况。

这里的人们使用什么[技术|工具|激励]？你如何让你的合作开发者关心这些问题？您如何测试合规性？这些测试是手动进行的还是自动进行的？

预先添加一个可能的答案：

我最近发现了[fliptitle.com](http://fliptitle.com)（他们提供了一种简单的方法来获取写成“uʍopǝpısdn”*的奇怪字符），我计划使用它们来提供易于验证的 UTF-8 字符串（因为大多数使用的字符有一些奇怪的二进制编码位置）但肯定必须有更系统的测试、模式或技术来确保 UTF-8 兼容性/使用。

**注意**：即使有一个公认的答案，如果有的话，我想知道更多的技术和模式。如果您有更多想法，请添加更多答案。只选择一个答案来接受并不容易。我选择了正则表达式答案来解决问题的最不期望的角度，尽管也有理由选择其他答案。可惜只能接受一个答案。

谢谢您的意见。

*）对于那些由于字体问题而看不到这些字符的人来说，这是“颠倒的”写成“颠倒的”

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-04-01T18:48:00.973

谢谢你的[翻唱](http://fliptitle.com)！

我也在尝试制定适当的测试计划，以确保应用程序在整个系统中支持 Unicode 字符串。

我是双语的，但使用两种只使用 ISO-8859-1 的语言。因此，我一直在努力确定什么是“现实生活”、“有意义”的方式来测试所有 Unicode 可能性。

我刚遇到这个：

*   [国际测试基础 - 测试非英语和非 ASCII 支持](http://web.archive.org/web/20160306060703/http://www.inter-locale.com/whitepaper/learn/learn-to-test.html)

* * *

# 后续帖子：

在为我的应用程序设计了一些测试之后，我意识到我已经整理了一个可能对其他人有帮助的编码值的小列表。

我在测试中使用了以下国际字符串：

（注意：这里有一些 UTF-8 编码的文本......希望你能在浏览器中看到它）

ユーザー别サイト简简体 中文<br />
크로스크로스
으로 으로 = ∏ g(i) français langue étrangère mañana olé

（UTF-8 外文/非英文文本结束）

然而，在测试过程中的不同点上，我意识到仅了解字符串在以各自的外国字母表呈现时的外观是不够的。我还需要知道正确的 Unicode 代码点编号，以及这些字符串在至少两种编码（UCS-2 和 UTF-8）中的正确十六进制值。

这是等效的代码点编号和十六进制值：

```
str = L"\u30E6\u30FC\u30B6\u30FC\u5225\u30B5\u30A4\u30C8"; // JAPAN 
// Little endian UTF-16/UCS-2: e6 30 fc 30 b6 30 fc 30 25 52 b5 30 a4 30 c8 30 00 00
// Hex of UTF-8: e3 83 a6 e3 83 bc e3 82 b6 e3 83 bc e5 88 a5 e3 82 b5 e3 82 a4 e3 83 88 00 

str = L"\u7B80\u4F53\u4E2D\u6587"; // CHINA 
// Little endian UTF-16/UCS-2: 80 7b 53 4f 2d 4e 87 65 00 00 
// Hex of UTF-8: e7 ae 80 e4 bd 93 e4 b8 ad e6 96 87 00

str = L"\uD06C\uB85C\uC2A4 \uD50C\uB7AB\uD3FC\uC73C\uB85C"; // KOREA 
// Little endian UTF-16/UCS-2: 6c d0 5c b8 a4 c2 20 00 0c d5 ab b7 fc d3 3c c7 5c b8 00 00
// Hex of UTF-8: ed 81 ac eb a1 9c ec 8a a4 20 ed 94 8c eb 9e ab ed 8f bc ec 9c bc eb a1 9c 00 

str = L"\u05DE\u05D3\u05D5\u05E8\u05D9\u05DD \u05DE\u05D1\u05D5\u05E7\u05E9\u05D9\u05DD"; // ISRAEL 
// Little endian UTF-16/UCS-2: de 05 d3 05 d5 05 e8 05 d9 05 dd 05 20 00 de 05 d1 05 d5 05 e7 05 e9 05 d9 05 dd 05 00 00
// Hex of UTF-8: d7 9e d7 93 d7 95 d7 a8 d7 99 d7 9d 20 d7 9e d7 91 d7 95 d7 a7 d7 a9 d7 99 d7 9d 00

str = L"\u0623\u0641\u0636\u0644 \u0627\u0644\u0628\u062D\u0648\u062B"; // EGYPT 
// Little endian UTF-16/UCS-2: 23 06 41 06 36 06 44 06 20 00 27 06 44 06 28 06 2d 06 48 06 2b 06 00 00
// Hex of UTF-8: d8 a3 d9 81 d8 b6 d9 84 20 d8 a7 d9 84 d8 a8 d8 ad d9 88 d8 ab 00 

str = L"\u03A3\u1F72 \u03B3\u03BD\u03C9\u03C1\u03AF\u03B6\u03C9 \u1F00\u03C0\u1F78"; // GREECE 
// Little endian UTF-16/UCS-2: a3 03 72 1f 20 00 b3 03 bd 03 c9 03 c1 03 af 03 b6 03 c9 03 20 00 00
// Hex of UTF-8: ce a3 e1 bd b2 20 ce b3 ce bd cf 89 cf 81 ce af ce b6 cf 89 20 e1 bc 80 cf 80 e1 bd b8 00 

str = L"\u0414\u0435\u0441\u044F\u0442\u0443\u044E \u041C\u0435\u0436\u0434\u0443\u043D\u0430\u0440\u043E\u0434\u043D\u0443\u044E"; // RUSSIA 
// Little endian UTF-16/UCS-2: 14 04 35 04 41 04 4f 04 42 04 43 04 4e 04 20 00 1c 04 35 04 36 04 34 04 43 04 3d 04 30 04 40 04 3e 04 34 04 3d 04 43 04 4e 04 00 00
// Hex of UTF-8: d0 94 d0 b5 d1 81 d1 8f d1 82 d1 83 d1 8e 20 d0 9c d0 b5 d0 b6 d0 b4 d1 83 d0 bd d0 b0 d1 80 d0 be d0 b4 d0 bd d1 83 d1 8e 00

str = L"\u0E41\u0E1C\u0E48\u0E19\u0E14\u0E34\u0E19\u0E2E\u0E31\u0E48\u0E19\u0E40\u0E2A\u0E37\u0E48\u0E2D\u0E21\u0E42\u0E17\u0E23\u0E21\u0E41\u0E2A\u0E19\u0E2A\u0E31\u0E07\u0E40\u0E27\u0E0A"; // THAILAND
// Little endian UTF-16/UCS-2: 41 0e 1c 0e 48 0e 19 0e 14 0e 34 0e 19 0e 2e 0e 31 0e 48 0e 19 0e 40 0e 2a 0e 37 0e 48 0e 2d 0e 21 0e 42 0e 17 0e 23 0e 21 0e 41 0e 2a 0e 19 0e 2a 0e 31 0e 07 0e 40 0e 27 0e 0a 0e 00 00
// Hex of UTF-8: e0 b9 81 e0 b8 9c e0 b9 88 e0 b8 99 e0 b8 94 e0 b8 b4 e0 b8 99 e0 b8 ae e0 b8 b1 e0 b9 88 e0 b8 99 e0 b9 80 e0 b8 aa e0 b8 b7 e0 b9 88 e0 b8 ad e0 b8 a1 e0 b9 82 e0 b8 97 e0 b8 a3 e0 b8 a1 e0 b9 81 e0 b8 aa e0 b8 99 e0 b8 aa e0 b8 b1 e0 b8 87 e0 b9 80 e0 b8 a7 e0 b8 8a 00

str = L"\u222E E\u22C5da = Q,  n \u2192 \u221E, \u2211 f(i) = \u220F g(i)"; // MATHEMATICS 
// Little endian UTF-16/UCS-2: 2e 22 20 00 45 00 c5 22 64 00 61 00 20 00 3d 00 20 00 51 00 2c 00 20 00 20 00 6e 00 20 00 92 21 20 00 1e 22 2c 00 20 00 11 22 20 00 66 00 28 00 69 00 29 00 20 00 3d 00 20 00 0f 22 20 00 67 00 28 00 69 00 29 00 00 00
// Hex of UTF-8: e2 88 ae 20 45 e2 8b 85 64 61 20 3d 20 51 2c 20 20 6e 20 e2 86 92 20 e2 88 9e 2c 20 e2 88 91 20 66 28 69 29 20 3d 20 e2 88 8f 20 67 28 69 29 00 

str = L"fran\u00E7ais langue \u00E9trang\u00E8re"; // FRANCE
// Little endian UTF-16/UCS-2: 66 00 72 00 61 00 6e 00 e7 00 61 00 69 00 73 00 20 00 6c 00 61 00 6e 00 67 00 75 00 65 00 20 00 e9 00 74 00 72 00 61 00 6e 00 67 00 e8 00 72 00 65 00 00 00
// Hex of UTF-8: 66 72 61 6e c3 a7 61 69 73 20 6c 61 6e 67 75 65 20 c3 a9 74 72 61 6e 67 c3 a8 72 65 00

str = L"ma\u00F1ana ol\u00E9"; // SPAIN
// Little endian UTF-16/UCS-2: 6d 00 61 00 f1 00 61 00 6e 00 61 00 20 00 6f 00 6c 00 e9 00 00 00
// Hex of UTF-8: 6d 61 c3 b1 61 6e 61 20 6f 6c c3 a9 00 
```

此外，这里有几张图片显示了在各种编辑器中可能发生的一些常见“错误渲染”，即使底层字节是格式正确的 UTF8。如果您看到这些渲染中的任何一个，这可能意味着您正确地生成了一个 UTF8 字符串，但是您的编辑器/查看器正试图在 UTF8 以外的其他编码下解释它们。

[示例效果图编号。1](https://i.stack.imgur.com/dZlgo.png)

[示例效果图编号。2](https://i.stack.imgur.com/dzHOc.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-25T20:48:19.710

有一个[正则表达式来测试一个字符串是否是有效的 UTF-8](http://www.w3.org/International/questions/qa-forms-utf-8)：

```
$field =~
  m/\A(
     [\x09\x0A\x0D\x20-\x7E]            # ASCII
   | [\xC2-\xDF][\x80-\xBF]             # non-overlong 2-byte
   |  \xE0[\xA0-\xBF][\x80-\xBF]        # excluding overlongs
   | [\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}  # straight 3-byte
   |  \xED[\x80-\x9F][\x80-\xBF]        # excluding surrogates
   |  \xF0[\x90-\xBF][\x80-\xBF]{2}     # planes 1-3
   | [\xF1-\xF3][\x80-\xBF]{3}          # planes 4-15
   |  \xF4[\x80-\x8F][\x80-\xBF]{2}     # plane 16
  )*\z/x; 
```

但这并不能确保文本实际是 UTF-8。

一个例子：字母ö（U+00F6）的字节序列和对应的UTF-8序列是0xC3B6。
因此，当您获得 0xC3B6 作为输入时，您可以说它是有效的 UTF-8。但是你不能肯定地说这封信 ö 已经提交了。
这是因为想象没有使用 UTF-8，而是使用了 ISO 8859-1。序列 0xC3B6 分别代表字符 Ã (0xC3) 和 ¶ (0xB6)。
因此序列 0xC3B6 可以使用 UTF-8 表示 ö 或使用 ISO 8859-1 表示 ö （尽管后者相当不寻常）。

所以最后只是猜测。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-25T21:06:02.437

字符编码的真正麻烦制造者通常是存在多个与编码相关的错误，并且由于其他错误而引入了一些不正确的行为。我已经数不清我看到这种情况发生了多少次了。

与往常一样，目标是在每个地方正确处理它。所以大多数时候简单的单元测试就可以解决问题，它甚至不必是非常复杂的字符集。我仅通过测试我们的国家字符“ø”就发现了所有错误，因为它在 UTF-8 和大多数其他字符集中的映射不同。

当所有部分都正确完成时，聚合工作正常。我知道这听起来微不足道，但是当涉及到字符集问题时，它总是对我有用；）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-25T20:35:16.027

本地化非常困难。

我认为您实际上是在问两个问题。其中之一，如何让每个人都正确地处理 i8n 应用程序，在我看来不是技术问题，而是项目管理问题。如果您希望人们使用通用标准，例如 UTF-8，那么您只需要强制执行即可。工具会有所帮助，但首先需要告诉人们这样做。

除了说 UTF-8 在我看来是要走的路外，很难回答有关工具的问题。这真的取决于你正在做的项目类型。例如，如果它是您正在谈论的 Java 项目，那么正确配置 IDE 以使用 UTF-8 编码文件是一件简单的事情。并确保您的 UTF-8 本地化位于外部资源文件中。

您当然可以做的一件事是进行检查合规性的单元测试。如果您的本地化消息/标签在资源文件中，那么我认为检查它们是否正确 UTF-8 编码很容易。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T04:10:21.077

在 PHP 中，我们使用 mb_ 函数，例如 mb_detect_encoding() 和 mb_convert_encoding()。它们并不完美，但它们让我们达到了 99.9% 的目标。比我们有一些正则表达式来去除有时以某种方式出现的时髦字符。

如果你要走向国际，你肯定想使用 UTF-8。我们还没有找到完美的解决方案，将我们的所有数据转换为 UTF-8，我不确定是否存在。你只需要继续修补它。

# asp.net - 如何在另一个打开的 aspx 页面中设置控件值

> ID：478202
> 
> 赞同：1
> 
> 时间：2009-01-25T20:20:39.393
> 
> 标签：asp.net, javascript

我的问题很简单，但我找不到解决方法:(

当用户单击特定按钮时，我需要打开一个新的 aspx 页面（在新窗口中），以便他能够选择需要返回到原始页面的内容。我能够使用 window.open 打开新页面，但是，我无法将所选值设置回原始页面。

总之，输入字段需要从打开的页面接收字符串值。我已经尝试过`window.opener.getElementById()`，但 ASP.NET 与控件的 Id 混淆，所以我无法在运行时确定输入字段的正确 Id。

有没有更简单的方法可以只使用服务器端代码（打开页面并返回值），而不是使用 JavaScript 和 window.opener（在我看来这很糟糕）？

如果没有，也欢迎任何其他简单的解决方案！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T20:09:14.703

[如果你使用jquery](http://jquery.com)之类的东西，顺便说一下，强烈推荐使用它而不是使用基本的 DOM 函数，你可以试试这个：

```
window.opener.$("[id$=txtValue]").val(valueToSet); 
```

应该执行以下操作：

*   `window.opener.$`如果从开启者窗口查询功能
*   ("[id$=something]") 是一个选择器，它选择所有具有以“txtValue”结尾的“id”属性的元素（这就是让你绕过丑陋的 Id 问题的原因）。
*   .val("some value") 将该输入字段的值设置为“some value”。

我不建议在 javascript 代码中硬编码 asp.net ID。由于某种原因，该 ID在将来的某个时间点*总是会发生变化，您的页面就会中断。*更不用说它是丑陋的:)

此外，虽然 window.opener 解决方案有其缺点，但在服务器端执行此操作通常会导致更糟糕的事情，例如使用 Session 在页面之间传递数据或在哪个页面（父或子）之间首先回发的竞争条件.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T20:24:18.230

也许与其在新窗口中打开单独的页面，不如在当前窗口中显示一个元素并使用 AJAX 控件来确保页面的相关部分都已更新。看看 ASP.NET AJAX PopUp 扩展器，当然还有 UpdatePanel。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T20:25:28.137

为什么控件 ID 会发生变化？您在使用母版页吗？如果是这样，您可以在运行时获取控件 ID，尽管它们与您命名它们的名称不同，但它们始终具有相同的值。

那是最好的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-25T20:28:11.530

您可以`Server.Transfer`在第二个 .aspx 页面（可以是弹出窗口）上使用，将查询字符串和表单变量返回到第一个 .aspx 页面。

```
Server.Transfer("firstPage.aspx", true) 
```

然后在第一页上，检索您想要的控件的值，如下所示：

```
string x = Request.Form["SomeTextbox"].ToString(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-25T21:11:04.643

是的，我正在使用母版页，这就是 ID 更改的原因。
我相信我找到了解决方案。我使用的是控制类属性，而不是 id 或名称，因为类总是相同的。然后，我使用类名来获取 id 并将其在查询字符串中传递到新页面。然后，新页面从查询字符串和 getElementById 中获取 id 以获取控件对象。使用该对象，它能够将其值设置为所需的值。
这不是最简单的解决方案，但对我有用。感谢您的回复。我受够了！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T10:51:19.683

我使用以下方法来实现与您类似的结果：

在主页中，我检查浏览器是否可以显示模态窗口（基本上是 Internet Explorer），如果是，则将新窗口作为模态弹出 - 这使我能够将值直接返回给调用方法，否则我只是弹出一个新窗口并希望：

```
if (window.showModalDialog)
{
    // showModalDialog returns a result, so pass that into the receiving function
    // directly.
    CallbackFunctionName(ShowModal(displayPath));
}
else
{
    // Just use the standard window.open methods.
    ShowWindow(displayPath);
}

function ShowWindow(displayPath)
{
    var remoteWin=window.open(displayPath,"EditContact",
        "resizable=yes,toolbar=0,location=0,directories=0,status=0,menubar=0,scrollbars=yes,copyhistory=0,modal=yes,width="
        + dialogWidth + ",height=" + dialogHeight);
    remoteWin.creator=self;
    remoteWin.focus();
}

function ShowModal(displayPath)
{
    return window.showModalDialog(displayPath, "editContact",
        "center:yes;resizable:no;dialogWidth:" + dialogWidth +
        "px;dialogHeight:" + dialogHeight + "px;");
} 
```

然后，在打开的页面上，我再次检查显示模式窗口的能力，如前所述：

```
if(!window.showModalDialog)
{
    // Call the callback method directly
    window.opener.CallBackFunctionName(resultValue);
}
else
{
    // Return the value back to the caller, who will pass the result along.
    window.returnValue=resultValue;
}
self.close(); 
```

ASP.NET 仅以已知方式混淆控件 ID - 一旦控件已由服务器上的运行时加载，您可以检索`ClientID`将包含控件的运行时 id 的内容 - 您可以将此值写入 JS变量，或者使用一些JS根据控件的其他特性来获取控件的值。

另请注意，从 ASP.NET 框架的第 4 版开始，您可以设置控件[`ClientIdMode`](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode.aspx)以更好地控制 Id 的生成方式。

# vim - 如何在 vim 的映射中使用 +（或 =）键？

> ID：478208
> 
> 赞同：2
> 
> 时间：2009-01-25T20:25:17.497
> 
> 标签：vim

我想重新映射（对于正常模式）`Ctrl`+`a`到`Ctrl`+`=`和`Ctrl`+`x`到`Ctrl`+`-`但它没有用。

有没有另一种写法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T23:28:52.337

我在使用时遇到了问题，因为我的 shell 使用这些来调整我的窗口大小和字体大小。我能够将“+”和“-”映射到命令，因此在正常模式下按下它们会增加和减少值。

```
map + <C-a>
map - <C-x> 
```

那是你想要完成的吗？我不知道这是否对你有用，因为它们可能有我不使用的不同用途。

您也可以使用[mapleader](http://www.vim.org/htmldoc/map.html#%3CLeader%3E)而不是 control 来执行此操作，并且不会弄乱任何默认用途：

```
let mapleader=","
map <Leader>+ <C-a>
map <Leader>- <C-x> 
```

而不是**C-+**和**C--**，您将使用**,+**和**,-**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T21:09:15.583

我不确定`Ctrl`+ `=`，但是对于`Ctrl`+ `-`，请尝试`Ctrl`+`_`代替（用下划线替换连字符）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T05:47:21.900

为我工作。

```
map <C-a> <C-=>
map <C-=> :echo 'ken'<CR>

map <C-x> <C-->
map <C--> :echo 'barbie'<CR> 
```

然后`<C-a>`应该回显`ken`应该`<C-->`回显`barbie`

# c# - wpf 工具提示未显示在用户控件或其子控件上

> ID：478209
> 
> 赞同：5
> 
> 时间：2009-01-25T20:25:25.967
> 
> 标签：c#, wpf, tooltip

我有一个带有用户控件的画布。当工具提示被分配给用户控件或其子控件之一时，该工具提示不会显示（打开事件也不会被触发）。我没有明确禁用它们中的任何一个。

我在应用程序的其他地方放置了很多工具提示，它们都显示出来了，除了我创建的用户控件上的那些。

有任何想法吗？

层次结构大致如下：

```
<Grid>
 <Canvas>
  <UserControl>
   <Canvas>
    <Line/>
    <Rectangle/>
   </Canvas>
  </UserControl>
 </Canvas
</Grid> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T00:39:51.647

如果 Usercontrol 的背景为 x:Null，则鼠标事件将落入底层内容。您可以使用“透明”来确保鼠标事件转到用户控件。

这种行为不是用户控件独有的；这是所有 WPF 的一般行为。在您的示例中，假设您对子元素进行了填充，您应该能够将鼠标悬停在这些元素上，并查看您设置的工具提示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-01T21:20:46.877

我终于弄明白了。在我的画布上，我正在绘制指针线（水平和垂直以在网格上显示我所在的位置以及左侧/底部的值），事实证明，当执行命中测试时，它正在命中这些线并停止. 通过在所有不相关的几何体上将 IsHitTestVisible 设置为 false，我的工具提示现在可以正确显示。

我看到鼠标进入/离开事件的原因是因为在移动光标时，线条会拖到后面 1 帧，因此允许鼠标进入/离开但不能移动。

这解决了我的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T02:38:28.630

我最初在根画布中测试时遇到了这个问题，当背景为空时，我的矩形没有显示工具提示。但是，这并不能解决用户控件的问题。我为用户控件和其中的画布尝试了透明背景，内部画布内的矩形有黑色背景，但没有运气：工具提示不会打开。

我确实尝试在我的根画布上放置一个工具提示，它确实出现了，但没有出现在我的单个子用户控件或其内部画布/子控件上，即使它们有背景/填充集。

此外，放置一个 MouseEnter 事件表明它确实在鼠标进入内部画布时触发，但工具提示不会弹出。

# sendmail - 域密钥、DKIM 和 Sendmail

> ID：478234
> 
> 赞同：1
> 
> 时间：2009-01-25T20:39:04.300
> 
> 标签：sendmail, email-validation, domainkeys

当我在 linux 系统上同时使用 DomainKeys 和 DKIM 时，我是否在同一个端口上运行它们？

DomainKeys：
*/usr/bin/dk-filter -l -p inet：**8891** @localhost -d example.com -s /var/db/domainkeys/default.key.pem -S default*

DKIM:
*/usr/bin/dkim-filter -l -p inet: **8891** @localhost -c simple -d example.com -k /var/db/dkim/mail.key.pem -s mail -S rsa-sha256 - u dkim -m MSA*

还是我做这样的事情：

域密钥：
*/usr/bin/dk-filter -l -p inet：**8892** @localhost -d example.com -s /var/db/domainkeys/mail1.key.pem -S 默认*

DKIM:
*/usr/bin/dkim-filter -l -p inet: **8891** @localhost -c simple -d example.com -k /var/db/dkim/mail2.key.pem -s mail -S rsa-sha256 - u dkim -m MSA*

只是想知道有关 DomainKeys 和 DKIM 的信息告诉您在同一端口上运行它们：
[http ://www.elandsys.com/resources/sendmail/domainkeys.html](http://www.elandsys.com/resources/sendmail/domainkeys.html)
[http://www.elandsys.com/resources/sendmail/dkim .html](http://www.elandsys.com/resources/sendmail/dkim.html)

我想同时运行它们，这是一个坏主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T08:28:25.917

您必须使用两种不同的服务在两个不同的端口上设置它。我在 sendmail 上使用了 dk-filter 和 dkim-filter。

将服务添加到您的 sendmail.mc，重建 sendmail（make -C /etc/mail），从命令行启动服务，然后重新启动 sendmail。

端口 8891 和 8892 将工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-22T01:58:43.070

添加到另一个答案，这是正确的（使用不同的端口）。如果你碰巧使用 CentOS，make 可能默认没有安装，你可以像这样以 root 身份安装：

yum -y install gcc automake autoconf libtool make

这将安装所有必需的依赖项，以便以 root 身份使用 make，因此当您编辑 sendmail.mc 时。

这将重新生成 sendmail.cf，以及重新生成 .db 文件（如果您碰巧也更改了它们）。

关于 dkim-milter 端口的最后一点说明 - 您可以将其设置为任何您想要的，但只需确保它不是其他常用服务的保留端口或默认端口。（不要将其设置为端口 80 等）。我发现让 dkim-milter 使用 sendmail 的教程使用端口 10035，这就是我成功使用的。

# mysql - 在 MySQL 中签名或未签名

> ID：478235
> 
> 赞同：50
> 
> 时间：2009-01-25T20:40:47.917
> 
> 标签：mysql, database-design

我想知道在 MySQL 中使用 UNSIGNED 标志定义一些整数字段有什么积极影响吗？它是否使查询更快或数据库更小？或者如果我担心上限，我应该只打扰它？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-01-25T20:47:41.787

根据MySQL 5.1 手册的[第 10.2 节：](http://dev.mysql.com/doc/refman/5.1/en/numeric-types.html)

> 在非严格模式下，当将超出范围的值分配给整数列时，MySQL 存储表示列数据类型范围的相应端点的值。如果将 256 存储到 TINYINT 或 TINYINT UNSIGNED 列中，MySQL 将分别存储 127 或 255。当为浮点或定点列分配的值超出指定（或默认）精度和小数位数所暗示的范围时，MySQL 存储表示该范围对应端点的值。

因此，只有在您关心上限时才真正需要使用 UNSIGNED。此外，添加 UNSIGNED 不会影响列的大小，只是数字的[表示](http://en.wikipedia.org/wiki/Two%27s_Complement)方式。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-25T21:39:31.450

除非您试图从价值中获得最大收益并且不需要负值，否则这无关紧要。

例如，假设您想存储 0-255。

您可以使用 tinyint，但前提是您将其用作无符号。

我见过的很多数据库，人们不会像这样费心优化并最终得到一些相当大的表，因为他们只是一直使用 INT。

不过，如果您谈论的是 int 与 unsigned int，则根本没有性能影响或空间影响。

从标准的角度来看，我总是使用无符号，并且仅在我知道我需要负值时才使用有符号。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2010-09-24T17:57:56.733

在性能或存储方面，这绝对是一回事。

作为一般规则，使用更适合您的：如果您只需要正值，请将值存储为 UNSIGNED，否则，让它成为默认的 [SIGNED]。

当为 PRIMARY AUTOINCREMENT 列设置 SIGNED 值时会出现一个问题：自动生成的数字的计数从 1（不是最小的负数）开始，并且可能的值将更早结束，因为您将只使用一半的值. 所以在这种情况下（PRIMARY + AUTOINCREMENT 列）最好存储为 UNSIGNED。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-25T21:10:37.187

当列仅包含正数时使用无符号。

它不会影响列上的任何 I/O 性能，因为它仍将占用完全相同的空间量。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-12-12T11:17:09.003

它将提高性能，假设您要搜索数量 < 50o。

没有“unsigned”：流程，由于数量字段是一个“int”并且你有这个字段的索引，MySQL会将范围定义为-2147483648到500，它会根据这个范围得到结果。

带“无符号”：流程，由于数量字段是“无符号”的“整数”，并且您有该字段的索引，因此MySQL将定义范围为0到500，它将根据该范围得到结果。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-03-24T19:03:11.150

在这里，您可以查看 SIGNED 与 UNSIGNED INT 范围的[MySQL 文档](https://dev.mysql.com/doc/refman/5.5/en/integer-types.html)。您会很快注意到 UNSIGNED INT 的下限始终为 0，因此它永远不会是负数。

```
Type    Storage Minimum Value   Maximum Value
        (Bytes) (Signed/Unsigned)   (Signed/Unsigned)
TINYINT     1   -128            127
                0               255
SMALLINT    2   -32768          32767
                0               65535
MEDIUMINT   3   -8388608        8388607
                0               16777215
INT         4   -2147483648     2147483647
                0               4294967295
BIGINT      8   -9223372036854775808    9223372036854775807
                0               18446744073709551615 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-08T08:51:21.800

**警告**，Unsigned Int (UINT) 和实体框架或 ADO.NET 存在问题。它可能涉及 MySql 连接器版本 6 的集成问题。

以我的经验，被EF`UInt`解读为，这可能会引发一些精度问题，因为is not . 任何不熟悉该问题的人都可能会感到头疼。`Long``UInt``Long`

其他担忧：

[EF和Mysql Connector 6的集成问题](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/eecd7c40-1fc3-4dbd-8179-2d39f3e4adb5)

[DBContext 不能使用 UINT](http://forums.asp.net/t/1675821.aspx/1)

[UINT 的 EF 提供程序问题](https://stackoverflow.com/questions/4578708/unsigned-int-mysql-in-c-sharp)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-12T23:18:21.263

我更喜欢使用 UNSIGNED SMALLINT（或 MEDIUMINT）而不是 SIGNED INT。它节省了 2（或 1）[个字节](https://dev.mysql.com/doc/refman/8.0/en/integer-types.html)，这有时可以在大型数据集上提供更好的性能，尤其是索引列。

# java - 在 Windows 中获取用户的组名

> ID：478240
> 
> 赞同：1
> 
> 时间：2009-01-25T20:45:10.717
> 
> 标签：java, windows, usergroups

我正在使用一个 Java 程序，它必须收集可以从用户组派生的信息。

如何从 windows 获取用户的组名？它是在文件中找到的，还是有一些方法/API 来获取它？

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-25T21:14:08.507

此论坛帖子[命名和目录 (JNDI) - JNDI、Active Directory 和组成员资格](http://forums.sun.com/thread.jspa?threadID=581444&messageID=3313188)应该让您走上正轨。

# command-line - 从命令行编译VB6

> ID：478241
> 
> 赞同：6
> 
> 时间：2009-01-25T20:45:45.193
> 
> 标签：command-line, vb6, compilation

任何人都知道如何从命令行编译 vb6 webclass dll？我正在尝试构建一个用于自动构建版本的工具，但它失败并显示“文件'[文件名]'中的编译错误，第 xxxx 行：未定义变量”警报。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-25T21:08:14.460

[已知错误](http://support.microsoft.com/kb/190165)：

> ### 症状
> 
> 当您使用命令行参数编译包含 WebClass 设计器的 Microsoft Visual Basic 项目时，您可能会遇到错误。
> 
> ### 原因
> 
> 当您使用命令行参数 /MAKE 编译应用程序时，如果设计器 (.DSR) 的关联 .DCA 文件与 .DSR 文件不在同一目录中，您可能会在编译过程中遇到错误。.DCA 文件包含编译项目所需的类型库信息。
> 
> ### 解析度
> 
> 使用以下解决方法之一来编译项目而不会出现错误：
> 
> *   在 Visual Basic 中打开项目，然后在项目中进行更改。任何更改，例如输入一个空格然后删除项目中的空格，就足够了。关闭 Visual Basic，并保存更改。这会在 .DSR 文件所在的同一目录中重建应用程序的 .DCA 文件。
> *   在 Visual Basic 集成开发环境 (IDE) 中编译应用程序。这还会为应用程序重建 .DCA 文件。
> 
> ### 地位
> 
> Microsoft 已确认这是本文开头列出的 Microsoft 产品中的错误...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-25T20:53:54.193

听起来您需要 CTRL-F5 并查看编译错误是什么，VB6 将允许您在调试中运行，而仍然存在无法通过编译器的错误，可能需要解决一些问题。这是一个从 bat 文件的命令行编译的示例。

```
set vssdir=c:\_vss\
VB6 /MAKE "%vssdir%Project.vbp" /outdir "%vssdir%testbuild" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T20:54:58.153

代码是否在调试器中构建？
通过运行“vb6.exe /?”查看可用于交换机的帮助。就像是：

```
path_to_vb6_exe /l path_to_my_project_name 
```

应该管用。我在想 /l 而不是 /m，因为它是一个 webclass dll，所以将是 activeX。每当我遇到像您描述的从命令行运行的 VB6 报告的错误时，都是因为代码无法构建。

但是，当从命令行运行时，它确实有一些缺点。我发现如果我在 IDE 中为用户控件设置了自定义选项卡，那么从命令行编译总是会失败。

# iphone - 泄漏 - GeneralBlock-3584

> ID：478242
> 
> 赞同：8
> 
> 时间：2009-01-25T20:46:15.003
> 
> 标签：iphone, cocoa-touch, memory-leaks, instruments

当我尝试使用 Instruments 检查我的 iPhone 应用程序的泄漏时，一切都很好。实际真实设备上的同一应用程序在应用程序启动期间多次显示此泄漏。这是非常不确定的，它发生在系统库中。我试图在没有运气的情况下用谷歌搜索解决方案。有人遇到同样的问题吗？有人知道解决方案吗？

我发现有趣的是，我的每一次代码泄漏迟早都会使应用程序崩溃。这些 GeneralBlock-3584 泄漏使应用程序完全稳定。这可能是 AppStore 拒绝的原因吗？

感谢有关此未记录问题的任何答案（不幸的是，Apple 保持沉默）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-09-10T07:44:18.390

您无需担心，这是 Instruments 的误报。
它与释放已终止线程的资源有关。他们只是闲逛直到下一个线程完成并在先前终止的线程之后清理资源。仪器将此视为“泄漏”，但它是 iOS 上 pthreads 实现的一个功能，在完美的世界中，它的处理方式会有所不同。[在此处](https://devforums.apple.com/message/94542#94542)和[此处](https://devforums.apple.com/message/119239#119239)的 Apple 开发论坛上了解更多信息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-30T23:07:54.553

泄漏检测工具通常会产生误报，尤其是在底层系统库中。

我熟悉这些“泄露”的 GeneralBlock，根据我的经验，它们并没有导致 App Store 拒绝。

IANAASRW **，但我认为你很好。

** 我不是 App Store 评论向导

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T06:50:59.973

Apple 框架存在漏洞。特别是 HTTP 类。您应该提出雷达缺陷报告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-22T20:22:30.277

在运行应用程序的“最初几次”期间，您是否有未进入设置进行初始化的 UserDefaults？

我看到了同样的问题——应用程序在最新的 Xcode/Simulator 上（相对）干净（通常的一对 128 字节 malloc 在那里——但这纯粹是 UIViews 的模拟器问题）。在 iPod Touch 上运行它后，我看到了 GB3584。

但是，在进入设置并更改设置（强制保存*）后，问题就消失了。

*   我正在使用 Apple 的 UserDefaults 示例代码来正确读取这些设置，而无需先进行更改。

所以，它很可能什么都不是。如果您可以确认访问设置清除了它，那么我们就会知道从哪里开始寻找泄漏（或引导 Apple 去哪里寻找）。

# php - 这段代码安全吗？

> ID：478251
> 
> 赞同：6
> 
> 时间：2009-01-25T20:49:27.820
> 
> 标签：php, security, session, login, session-variables

```
<?php
session_start();

include("connect.php");

$timeout = 60 * 30;
$fingerprint = md5($_SERVER['REMOTE_ADDR'] . $_SERVER['HTTP_USER_AGENT']);

if(isset($_POST['userName']))
{
    $user = mysql_real_escape_string($_POST['userName']);
    $password = mysql_real_escape_string($_POST['password']);
    $matchingUser = mysql_query("SELECT * FROM `users` WHERE username='$user' AND password=MD5('$password') LIMIT 1");
    if (mysql_num_rows($matchingUser))
    {
        if($matchingUser['inactive'] == 1)//Checks if the inactive field of the user is set to one
        {
            $error = "Your e-mail Id has not been verified. Check your mail to verify your e-mail Id. However you'll be logged in to site with less privileges.";
            $_SESSION['inactive'] = true;
        }
        $_SESSION['user'] = $user;
        $_SESSION['lastActive'] = time();
        $_SESSION['fingerprint'] = $fingerprint;
    }
    else
    {
        $error = "Invalid user id";
    }
}
if ((isset($_SESSION['lastActive']) && $_SESSION['lastActive']<(time()-$timeout)) || (isset($_SESSION['fingerprint']) && $_SESSION['fingerprint']!=$fingerprint)
     || isset($_GET['logout'])
    )
{
    setcookie(session_name(), '', time()-3600, '/');
    session_destroy();
}
else
{
    session_regenerate_id(); 
    $_SESSION['lastActive'] = time();
    $_SESSION['fingerprint'] = $fingerprint;
}
?> 
```

这只是[http://en.wikibooks.org/wiki/PHP_Programming/User_login_systems的修改版本](http://en.wikibooks.org/wiki/PHP_Programming/User_login_systems)

在这里做什么`setcookie(session_name(), '', time()-3600, '/');`？

这是一个错误：我使用此登录表单：

```
<?php 
   if(!isset($_SESSION['user']))
    {
        if(isset($error)) echo $error;
           echo '<form action="' . $_SERVER["PHP_SELF"] . '" method="post">
        <label>Username: </label>
        <input type="text" name="userName" value="';if(isset($_POST['userName'])) echo $_POST["userName"]; echo '" /><br />
        <label>Password: </label>
        <input type="password" name="password" />
        <input type="submit" value="Login" class="button" />
        <ul class="sidemenu">
        <li><a href="register.php">Register</a></li>
        <li><a href="forgotPassword.php">Forgot Password</a></li>
    </ul>
    </form>';
    }
    else
    {
        echo '<ul class="sidemenu">
        <li>' . $_SESSION['user'] . '</li>
        <li><a href="' . $_SERVER["PHP_SELF"] . '?logout=true">Logout</a></li>
        </ul>';
    }
?> 
```

错误是当我注销时，页面保持不变，即登录表单不显示，但显示相同的注销和用户。当我刷新页面时，它变得正常。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-25T22:01:29.220

当您注销时，首先，您正在*排队*销毁 cookie（它将在发送响应后发生），然后立即渲染您的页面。浏览器在渲染之前没有机会删除 cookie，并且您的`$_SESSION`变量仍然存在。

PHP 文档说`session_destroy`：

> session_destroy() 销毁与当前会话关联的所有数据。它不会取消设置与会话关联的任何全局变量，也不会取消设置会话 cookie。

一个解决方案是，而不是破坏会话和 cookie，只需取消设置会导致身份验证的变量：

```
unset($_SESSION['user']);
unset($_SESSION['lastActive']);
unset($_SESSION['fingerprint']); 
```

请注意：我建议将您的代码拆分为函数。这将使它更有条理和可读性（如果你做对了，可以重用）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-25T22:14:04.920

一些安全说明：

```
if($matchingUser['inactive'] == 1) 
```

最好写成

```
if(!$matchingUser['inactive']) 
```

因为如果数据库模式发生变化（例如，它现在是一个整数来表示某种类型的活动（在我看来，这是一个糟糕的设计：枚举会做得更好））你的代码就会出现问题。

当然，这是一个双重否定，可能不太可读。更好的是：

```
if($matchingUser['isactive']) 
```

甚至：

```
if($matchingUser->isActive()) 
```

假设您创建了一个用户类等。

以防万一，在必要时使用 or （如果包含函数声明，最好是后者`require`）。`require_once``connect.php`

将用户的 ID 存储在会话变量中而不是用户名中。您可能会允许用户稍后更改他的姓名，并且会话数据将无效（至少`['user']`会，无论如何）。通过 ID（主键，唯一）查找数据库记录也比通过用户名（可能是索引，字符串）更快。

30分钟后踢我真的很烦人。您不是我去的唯一站点，我可能会在完成一些工作后重新访问（例如，如果我被要求做某事，或者午休）。

用于`htmlspecialchars`帮助防止 XSS。

这里不需要使用`$_SERVER['PHP_SELF']`：

```
<a href="' . $_SERVER["PHP_SELF"] . '?logout=true"> 
```

简单地写没有它：

```
<a href="?logout=true"> 
```

当用户发布某些内容时，请确保重定向它们（TODO：注意如何）。否则，用户的后退按钮可能会导致重新发布数据（这可能不是您想要的！）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-25T22:46:12.407

`$matchingUser['inactive']`永远不会被设置，因为你没有从你的数据库中获取实际数据`mysql_fetch_assoc()`。

修改版：

```
$matchingUser = mysql_query("SELECT * FROM `users` WHERE username='$user' AND password=MD5('$password') LIMIT 1");
if (mysql_num_rows($matchingUser))
{
    $matchingUserData = mysql_fetch_assoc($matchingUser);
    if($matchingUserData['inactive'] == 1) //Checks if the inactive field of the user is set to one
    {
        $error = "Your e-mail Id has not been verified. Check your mail to verify your e-mail Id. However you'll be logged in to site with less privileges.";
        $_SESSION['inactive'] = true;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-25T20:50:59.393

`$_SERVER['REMOTE_ADDR']`如果用户在代理后面，则可能会发生变化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T21:14:46.710

MD5 是一种非常弱的密码加密方法，有很多方法可以绕过它。它确实有帮助，但是您可以使用 IP 地址进行设置，但 IP 肯定会发生很大变化。

此外，您没有任何东西可以确保有人不会一遍又一遍地访问系统来破解用户的密码。

G人

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-25T21:46:00.627

将盐与 MD5 或 sha1 一起使用。我用来生成密码并在登录时检查密码的内容。

```
function generateHash($plainText, $salt = null)
{
    define('SALT_LENGTH', 9);
    if ($salt === null)
    {
        $salt = substr(md5(uniqid(rand(), true)), 0, SALT_LENGTH);
    return array($salt, sha1($salt . $plainText) );
    }
    else
    {
        $salt = substr($salt, 0, SALT_LENGTH);
    return sha1($salt . $plainText);
    }

} 
```

对于 $plainText ，发送密码变量。

当你想生成一个新的哈希时，它会返回 2 个值。第一个值称为“盐”，第二个值是加密密码。将它们都存储到数据库中。

当有人尝试登录您的站点并且您想要检查时，将他们的密码和 salt 变量发送给该函数，它将返回一个哈希值。然后您可以将其与存储在数据库中的值进行比较，以检查用户输入的密码是否正确。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-25T20:52:56.817

看起来不错。`setcookie(session_name(), '', time()-3600, '/')`本质上是通过将时间设置为当前时间之前来删除 cookie。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-25T20:55:11.103

> setcookie(session_name(), '', time()-3600, '/'); 是什么意思

看起来它通过为它设置一个空字符串并通过设置过去的过期时间来删除旧的会话 cookie。不过，不确定作者为什么同时使用这两种方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-25T20:59:57.520

在这种情况下，您必须确保您的服务器设置正确`mysql_real_escape_string`才能正常工作。在这种情况下，您的代码假设 Magic Quotes 已关闭，而我经常发现许多服务器都启用了它。您可能应该检查是否`get_magic_quotes_gpc()`返回 true 或 false 以查看服务器设置是否自动为您转义字符串。

该代码看起来很安全，但我建议研究一种执行 MySQL 查询的新方法：[PDO](http://us.php.net/manual/en/book.pdo.php)。这允许参数化查询。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-25T21:20:32.533

您可以使用[Nate Abele 描述的这种方法](http://shiflett.org/blog/2007/dec/php-advent-calendar-day-24)来提高用于构建指纹的信息的可靠性。

# windows - 安装颠覆：如何设置服务器？

> ID：478257
> 
> 赞同：3
> 
> 时间：2009-01-25T20:51:21.313
> 
> 标签：windows, svn, installation

我正在尝试以不同于当前安装方式的方式安装 subversion。我们目前有一台托管 SVN 存储库的联网计算机。我们通过 Windows 文件共享功能访问存储库。目前，任何人都可以查看任意数量的工作副本。

有人告诉我，我们可以安装“SVN 服务器版本”，这样可以更好地管理谁在签出文件，而且我们可以切断中间人 Windows 文件共享人员以连接到 SVN。

问题是我只看到一个颠覆服务器下载。似乎这个人告诉我的可以通过更改配置而不是不同的安装来完成。这人说的有道理吗？在我看来，我们已经安装了一个版本的 SVN。

如果听起来我的问题不清楚，那可能是因为我很难理解他的意思。

如果有人有一些见解，我想听听。

提前谢谢，jbu

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-25T21:01:33.820

您可以对其进行设置，以便您可以通过 HTTP 或 Subversion 自己的 SVN 协议进行连接，但除了身份验证/授权之外，您的连接方式并没有太大区别——它当然不会阻止您获取多个工作副本。

如果您在 Windows 上运行服务器，那么[Visual SVN Server](http://www.visualsvn.com/server/)非常好，易于设置和使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-25T21:03:34.500

您需要将 svnserve 作为服务运行。您可以通过运行以下 Windows shell 命令轻松创建服务：

```
sc create svnserve binpath= "
    \"C:\Program Files\Subversion\bin\svnserve.exe\"
    --service --root c:\PATH\TO\YOUR\REPOS" displayname= "Subversion" 
    depend= tcpip start= auto 
```

然后，通过编辑`conf/svnserve.conf`存储库中的文件，您可以启用密码身份验证、允许（或禁止）匿名签出等等。[在TortoiseSVN 文档](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-serversetup-svnserve.html#tsvn-serversetup-svnservice)中有更多关于此的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T12:20:57.643

Assuming you are running on a windows box and not using samba on a linux box you could just install visualsvn server [http://www.visualsvn.com/server/](http://www.visualsvn.com/server/) which will start as up as a service (listening where you specify) for you automatically.

You could either just copy your repository to the default location or change the httpd.conf file in Program files\visualsvn\conf

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T12:33:10.780

你也有[svn1clicksetut](http://svn1clicksetup.tigris.org/)

“该项目的目标是简化在基于 Windows 的计算机上设置 Subversion 存储库的过程。Svn1ClickSetup 引导用户完成安装 Subversion 命令行实用程序和 TortoiseSVN 所需的步骤，以及创建存储库和初始项目。”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T12:32:08.183

You can install Apache2 on windows and add to it the SVN module from SVN web site.

Here is additional httpd.conf strings:

```
LoadModule dav_module modules/mod_dav.so
LoadModule dav_fs_module modules/mod_dav_fs.so

<IfModule dav_module> 
    LoadModule dav_svn_module modules/mod_dav_svn.so
    LoadModule authz_svn_module modules/mod_authz_svn.so
</IfModule>

<Location /svn>
    DAV svn
    SVNListParentPath on
    SVNParentPath "E:\SVN"
    AuthType Basic
    AuthName "Subversion repositories"
    AuthUserFile passwd
    Require valid-user
 </Location> 
```

Before configuration you need to copy all dlls from SVN distro archive to /bin directory of Apache

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T19:24:11.143

您可以下载免费的[BitNami Subversion 安装程序](http://bitnami.org/stack/subversion)，其中包含分步向导。您有适用于 Windows、Mac、Linux 的下载。它将配置 Apache，因此可以通过 DAV 访问存储库，正如海报中提到的那样

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T20:27:00.487

Subversion 服务器只有一个，可以通过不同的方法以不同的方式访问。如果您可以限制访问或多或少安全的网络部分，svnserve 应该可以正常工作；如果您需要更高的安全性，您可以进入 Web 服务器安装。SVN 书至少有一些关于安装一切的细节。

Subversion 团队警告说，网络文件共享通常不是运行 Subversion 的可靠方式，并且可能导致文件损坏。这比在 CVS 中更严重；CVS 基于 RCS 格式的单个文件，并且比 Subversion 存储库更适合手动修复。你几乎肯定想摆脱这种情况。

# c++ - 为什么这个cin读数卡住了？

> ID：478258
> 
> 赞同：3
> 
> 时间：2009-01-25T20:51:41.110
> 
> 标签：c++, cin

我在我的程序中挑出了一个失败，它阻止我为变量赋值`addAntonymAnswer1`。我已经尝试`cin.clear()`在声明之前运行以让事情阅读我的`yes/no`答案，但代码不会响应。

失败的程序位位于内部`void dictionaryMenu(vector <WordInfo> &wordInfoVector)`并读取

```
 cin.clear();

         cout<<">";
         cin>>addAntonymAnswer1;

         // cin reading STUCK, why!? 
```

要到达程序的那个点，用户必须选择添加一个词，然后添加一个同义词。

运行程序的输入是：

```
dictionary.txt
1 cute
2 hello
3 ugly
4 easy
5 difficult
6 tired
7 beautiful
synonyms
1 7
7 1
3 2
antonyms
1 3
3 1 7
4 5
5 4
7 3 
```

* * *

```
#include <iostream>
#include <fstream>
#include <string>

#include <sstream>
#include <vector>

using namespace std;

class WordInfo{

      public:

             WordInfo(){}

             WordInfo(string newWord){
                           word=newWord;                
             }

             ~WordInfo() { }

             int id() const {return myId;}

             void readWords(istream &in)
             {
               in>>myId>>word;     
             }

             vector <int> & getSynonyms () {

                    return mySynonyms;
             }

            vector <int> & getAntonyms() {

                     return myAntonyms;
            }

            string getWord() {
                     return word;
                   }

          void dictionaryMenu (vector <WordInfo> &wordInfoVector){

          cout<<endl<<"Would you like to add a word?"<<endl;   
          cout<<"(yes/no)"<<endl;
          cout<<">";
          string addWordAnswer;
          cin>>addWordAnswer;

          if (addWordAnswer=="yes")
          // case if the guy wants to add a word
          {
          cout<<endl;                  
          cout<<"Please, write the word "<<endl;                  

          string newWord;
          cout<<">";
          cin>>newWord;
          cout<<endl;         

          WordInfo newWordInfo (newWord);

          int newWordId = wordInfoVector.size() +1;

          newWordInfo.myId=newWordId;

          cout<<"The id of "<<newWordInfo.word<<" is "<<newWordInfo.myId<<endl<<endl; 

          wordInfoVector.push_back(newWordInfo);

          cout<<"Would you like to define which words on the existing dictionary are" <<endl 
          <<"synonyms of "<<newWordInfo.word<<"?"<<endl;

          cout<<"(yes/no)"<<endl;

          string addSynonymAnswer, addAntonymAnswer1, addAntonymAnswer2;
          cout<<">";
          cin>>addSynonymAnswer;  

          if (addSynonymAnswer=="yes")
          {

            cout<<endl;
            cout<<"Please write on a single line the ids for the synonyms of "
            <<newWordInfo.word<<endl<<"starting with its id, which is "<<newWordInfo.myId<<endl<<endl;

            cout<<"For example, to define that the synonym of the word 'cute', which has an id 1, is" 
            <<"'beautiful', which has an id 7, you should write: 1 7"<<endl<<endl;

            cout<<"In the case of "<<newWordInfo.word<<" you should start with "<<newWordInfo.myId<<endl;

            cin.clear();
            string lineOfSyns;
            cout<<">";

            cin>>lineOfSyns;

            newWordInfo.pushSynonyms(lineOfSyns, wordInfoVector); 

            cin.clear();     

                 cout<<"Would you like to define which words on the existing dictionary are" <<endl 
                 <<"antonyms of "<<newWordInfo.word<<"?"<<endl; 

                  //##HERE THE CIN READING OF addAntonymAnswer1 FAILS, WHY?

                 cin.clear();
                 cout<<">";
                 cin>>addAntonymAnswer1;

                 // cin reading STUCK, why!?   

                 if (addAntonymAnswer1=="yes"){ }                        

                    else if (addAntonymAnswer1=="no"){
                         // END DICTIONARY MENU
                         }                  
          }
             else if (addSynonymAnswer=="no"){

                cout<<"Would you like to define which words on the existing dictionary are" <<endl 
                 <<"antonyms of "<<newWordInfo.word<<"?"<<endl; 

                 cout<<">";
                 cin>>addAntonymAnswer2;

                 if (addAntonymAnswer2=="yes"){ }                        

                    else if (addAntonymAnswer2=="no"){
                         // END DICTIONARY MENU
                         }  

             }

          } // if addWordAnswer == "no"

          else if (addWordAnswer=="no"){

               // ######RETURN TO MAIN MENU############
               }        

            }

             void pushSynonyms (string synline, vector<WordInfo> &wordInfoVector){

             stringstream synstream(synline);

             vector<int> synsAux;

             // synsAux tiene la línea de sinónimos

             int num;

             while (synstream >> num) {synsAux.push_back(num);}

             int wordInfoVectorIndex;

             int synsAuxCopyIndex;

             if (synsAux.size()>=2){ // takes away the runtime Error

             for (wordInfoVectorIndex=0; wordInfoVectorIndex <wordInfoVector.size(); wordInfoVectorIndex++)
             {

                 if (synsAux[0]==wordInfoVector[wordInfoVectorIndex].id()){

                    // this is the line that's generating a Runtime Error, Why?                                                       
                    for (synsAuxCopyIndex=1; synsAuxCopyIndex<synsAux.size(); synsAuxCopyIndex++){

                    // won't run yet    
                    wordInfoVector[wordInfoVectorIndex].mySynonyms.push_back(synsAux[synsAuxCopyIndex]);      
                        }                                                          
                 }     
             } 

             }// end if size()>=2

            } // end pushSynonyms

             void pushAntonyms (string antline, vector <WordInfo> &wordInfoVector)
             {

             stringstream antstream(antline);

             vector<int> antsAux;

             int num;

             while (antstream >> num) antsAux.push_back(num);

             int wordInfoVectorIndex;

             int antsAuxCopyIndex;   

             if (antsAux.size()>=2){ // takes away the runtime Error             

             for (wordInfoVectorIndex=0; wordInfoVectorIndex <wordInfoVector.size(); wordInfoVectorIndex++)
             {

                 if (antsAux[0]==wordInfoVector[wordInfoVectorIndex].id()){

                    // this is the line that's generating a Runtime Error, Why?                                                       
                    for (antsAuxCopyIndex=1; antsAuxCopyIndex<antsAux.size(); antsAuxCopyIndex++){

                    // won't run yet    
                    wordInfoVector[wordInfoVectorIndex].myAntonyms.push_back(antsAux[antsAuxCopyIndex]);      
                        }                                                          
                 }     
             } 

             }// end if size()>=2

             }

             //--dictionary output function

             void printWords (ostream &out)
             {
                out<<myId<< " "<<word;     
             }

             //--equals operator for String
             bool operator == (const string &aString)const
             {
                           return word ==aString; 

             }

             //--less than operator

             bool operator <(const WordInfo &otherWordInfo) const
             { return word<otherWordInfo.word;}

             //--more than operator

             bool operator > (const WordInfo &otherWordInfo)const
             {return word>otherWordInfo.word;}

             public: 

                  vector<int> mySynonyms;
                  vector <int> myAntonyms;

                   string word;
                   int myId;

      };

      //--Definition of input operator for WordInfo
      istream & operator >>(istream &in, WordInfo &word)
      {
         word.readWords(in); 

      }

      //--Definition of output operator

      ostream & operator <<(ostream &out, WordInfo &word)
      {
            word.printWords(out);  

      }

      int main() {

          string wordFile;
          cout<<"enter name of dictionary file: "<<endl;
          getline (cin,wordFile);

          ifstream inStream (wordFile.data());

          if(!inStream.is_open())
          {
          cerr<<"cannot open "<<wordFile<<endl; 
          exit(1);                      

          }

          vector <WordInfo> wordInfoVector; 

          WordInfo aword;

          while (inStream >>aword && (!(aword=="synonyms")))
          {
              wordInfoVector.push_back(aword);

          }

          inStream.clear();

          vector <int> intVector;
          string synLine; 

          while (getline(inStream, synLine)&&(synLine!=("antonyms"))){

                aword.pushSynonyms(synLine, wordInfoVector);

                }

          int theIndex;

          string antLine;

          while (getline(inStream,antLine)){

                aword.pushAntonyms(antLine, wordInfoVector);
                }      

          cout<<endl<<"the words on the dictionary are: "<<endl;

          int h=0;          
          while (h<wordInfoVector.size()){
                cout<<wordInfoVector[h]<<endl;
                h++;
                }

          aword.dictionaryMenu(wordInfoVector);

          system("PAUSE");

          return 0;
      } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-25T21:25:45.580

`cin.clear()`不清除标准输入。它所做的是清除错误位，例如`eofbit`和`failbit`其他，并将流设置为良好状态。也许您希望它可以清除其中的任何内容？如果用户键入

```
yes no 
```

就在之前，还有你

```
cin >> someStringVariable; 
```

它将读取到`no`并且流仍将包含

```
 no 
```

调用`clear`then 会清除所有处于活动状态的错误位。那么，你的

```
cin>>addAntonymAnswer1; 
```

将读取`no`前一次读取未吃掉的内容，并且该操作立即返回，而不是等待新的输入。你应该做的是做一个`clear`然后忽略，直到下一个换行符。你告诉它它应该最大程度地忽略的字符数量。该金额应该是可能的最高数字：

```
cin.clear();
cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n'); 
```

这样做会使流为空，随后的读取将等待您输入内容。

* * *

如果您有 a`cin >>`后跟 a ，则会出现另一个问题`getline`： cin 将在其读取标记之后留下任何空格（也是换行符），但`getline`在遇到这样的换行符后将停止读取。我看到你`clear`几乎把所有事情都放在了后面。所以我想告诉你什么时候需要，什么时候不需要。当您对多个`cin >>`. 假设您的缓冲区中有：“foo\nbar\n”。然后你做以下阅读

```
cin >> a; // 1
cin >> b; // 2 
```

在第一个之后，您的缓冲区将包含“\nbar\n”。也就是说，换行符仍在。第二个`cin>>`将首先跳过所有空格和换行符，以便它可以应对`\n`在`bar`. 现在，您还可以对多个`getline`调用进行排序：

```
getline(cin, a);
getline(cin, b); 
```

Getline 将丢弃`\n`它在行尾读取的内容，但不会忽略开头的换行符或空格。因此，在第一个 getline 之后，缓冲区包含“bar\n”。第二个 getline 也将正确读取“bar\n”。现在，让我们考虑需要清除/忽略的情况：

```
cin >> a;
getline(cin, b); 
```

第一个会将流保留为“\nbar\n”。然后 getline 将立即看到`\n`开头的 ，并认为它读取的是空行。因此，它将立即继续而不等待任何内容，将流保留为“bar\n”。所以，如果你有一个`getline`after a`cin>>`你应该首先执行 clear/ignore 序列，以清除换行符。但是在`getline`or之间`cin>>`，你不应该这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T20:55:49.197

它“卡住”了，因为它正在等待输入。cin 附加到程序的标准输入句柄，您必须输入一些内容并按 Enter。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T21:39:07.910

`cin >> ...`从标准输入读取，直到找到空白字符。例如，当您输入`8 5`同义词列表时，`8`就会被读入`lineOfSyns`，仅此而已。当程序到达`cin >> addAntonymAnswer1`时，`5`被读入`addAntonymsAnswer1`。您的程序行为异常，因为它期望`yes`或`no`但它得到了`5`.

看看 using`cin.getline()`而不是`>>`. 例如，参见 [本页](http://www.tenouk.com/Module18.html)第 18.2 和 18.3 节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-25T21:42:59.133

在您的程序中，您询问用户：

```
Please write on a single line the ids for the synonyms of test
starting with its id, which is 8

For example, to define that the synonym of the word 'cute', which has an id 1, i
s'beautiful', which has an id 7, you should write: 1 7

In the case of test you should start with 8 
```

然后您尝试在用户键入的行中读取

```
cin>>lineOfSyns; 
```

但是，这只读取到第一个空格。因此，当用户输入的第二个数字仍然在`cin`缓冲区中时

```
cin>>addAntonymAnswer1; 
```

行被执行，以便将数据读入`addAntonymAnswer1`字符串。用户永远没有机会输入“是”或“否”，并且您对这些值的测试失败。

您应该考虑更改为使用`string`重载 for`getline()`进行读取：

```
getline( cin, stringvar); 
```

这可能比 using 更好`cin.getline()`，因为它没有需要的重载`string`- 使用该成员函数，您需要读入一个字符数组，这远不如读入一个`string`.

# resharper - 在 resharper 中的 NBehave 故事输出

> ID：478265
> 
> 赞同：1
> 
> 时间：2009-01-25T20:55:15.330
> 
> 标签：resharper, nbehave

我用 NBehave 写了一堆故事。

现在我已经看到了输出以易于使用的格式显示的示例~~（[请参阅此示例](http://www.codeplex.com/NBehave/Wiki/View.aspx?title=Examples&referringTitle=Home)）~~[Wayback machine link](http://web.archive.org/web/20081212231239/http://www.codeplex.com/NBehave/Wiki/View.aspx?title=Examples&referringTitle=Home)

有没有办法在 resharper 中获得这个输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T13:30:07.833

[这](http://enceradeira.blogspot.com/2009/03/how-to-get-console-output-working-with.html)是 Jörg Jenni 在他的博客上发布的。他展示了如何让 nBehave 输出显示：

> 使用最新版本的 NBehave 0.4 时，您可能会注意到不再有输出写入 ReSharper Testrunner 输出。
> 
> 这是我解决问题的方法。我从以下类派生了规格，一切都很好：
> 
> ```
> public class SpecBaseWithConsoleOutput: SpecBase
> {
>   private EventHandler<EventArgs<MessageEventData>> addedHandler;
>   private EventHandler<EventArgs<Scenario>> scenarioCreatedHandler;   
>   private EventHandler<EventArgs<Story>> storyCreatedHandler;
>   public override void MainSetup()
>   {
>     base.MainSetup();
>     addedHandler = (o, a) => Console.WriteLine(a.EventData.Message);
>     scenarioCreatedHandler = (o, a) => Console.WriteLine(a.EventData.Title);
>     storyCreatedHandler = (o, a) => Console.WriteLine(a.EventData.Title);
>     Story.MessageAdded += addedHandler;
>     Story.ScenarioCreated += scenarioCreatedHandler;
>     Story.StoryCreated += storyCreatedHandler;
>   }
>   public override void MainTeardown()
>   {
>     Story.MessageAdded -= addedHandler;
>     Story.ScenarioCreated -= scenarioCreatedHandler;
>     Story.StoryCreated -= storyCreatedHandler;
>     base.MainTeardown();
>   }
> } 
> ```

# .net - 对象引用的原子性

> ID：478269
> 
> 赞同：0
> 
> 时间：2009-01-25T20:56:21.817
> 
> 标签：.net, multithreading, locking

我刚刚遇到了一个问题 - 在 C# 中跨线程安全地访问对象是可能的。

例如用代码

```
//Somewhere long ago
MyClass myVar = new MyClass("First Instance");

//Then later, happening at the same time
//In thread one
myVar = new MyClass("Second Instance");

//In thread two
myVar.PrintName(); 
```

我不在乎是使用第一个还是第二个实例，但是 myVar 是否可能在某些时候根本无效（例如，指向一个不存在的位置，因为对象引用在使用之前可能只是部分更新了另一个线程）

* * *

关于锁的附带问题：

如果我留下一个锁 - 那么所有未完成的写入都提交到内存吗？

我的问题是如果我在锁中引用一个变量，我知道只有一个线程可以同时访问锁 - 但是我是否会在一个线程中写入变量（并且写入只对缓存进行)，然后在另一个线程中甚至在锁内获取变量的旧值（因为未提交缓存或者我在该线程的缓存中仍然有旧值）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T21:13:56.400

给你的第一个。它几乎可以肯定是安全的，但我还是会锁定它。

至于您的缓存问题，您在谈论什么缓存，我唯一能想到的就是 CPU 缓存，如果我们担心这些缓存是否脏并需要刷新，我们都会遇到很多麻烦。

**编辑：** 从您的评论中，我看到 CPU 缓存就是您所指的。

多核和多处理器硬件确保不会使用缓存中的任何过期数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T11:24:41.127

我知道您的问题是关于 .NET 的，但我无法在那里告诉您答案。但是，在 Java 中，这段代码肯定是不安全的。

风险在于代码重新排序（优化步骤）会在构造函数完成运行之前看到对象引用被更新 - 因此第二个线程可以看到第二个对象的部分构造版本。

在 java 中，您可以通过使对象引用变为 volatile 或将其保护在某种 AtomicReference 后面（当然，或者通过同步）来解决这个问题——其中任何一个都会施加“内存屏障”，从而限制可以按顺序进行的优化确保部分构造的对象永远不可见。

正如我所说，我对 .NET 内存模型了解得不够多，无法知道 .NET 是否会出现同样的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T21:09:13.150

您问题中的代码示例是线程安全的。显然取决于您在该构造函数中执行的操作，但“通常” myVar 引用将是有效的（通常因为您可以执行一些低级别的操作，例如 FormatterServices 等）。将使用构造函数创建一个新对象，并自动返回到正确的线程。对我来说，通过在每个线程上创建新对象来确保代码是线程安全的，这是最好的方法之一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-25T21:47:08.797

我想说，只要你没有明确地取消引用对象，就不会有空引用的威胁。唯一的可能是在初始化 myVar 之前启动线程二。在这个简单的示例中，我认为您不需要锁。至于您的附带问题，您指的是哪个缓存？

# c# - 用户控制的数据源

> ID：478278
> 
> 赞同：10
> 
> 时间：2009-01-25T21:00:48.440
> 
> 标签：c#, .net, winforms, custom-controls

我正在构建一个用户控件。目前它由一个文本框和一个按钮组成 - 作为一种学习体验。这将用作更有用的控制的基础。

我想添加一个数据源、显示成员和 ValueMember。
这是我的数据源代码。它将显示在属性编辑器中，但被禁用并变灰。我错过了什么？

```
 private object MyDataSource;

    [Browsable(true)]
    [TypeConverter("System.Windows.Forms.Design.DataSourceConverter")]
    [System.ComponentModel.Bindable(true)]
    public object DataSource
    {
        get
        {
            return MyDataSource;
        }
        set
        {
            if (MyDataSource != value)
                MyDataSource = value;
        }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-25T22:51:24.207

一个更简单的选择可能是使用属性提供程序：

```
[AttributeProvider(typeof(IListSource))] 
```

您可以尝试使用程序集限定名称吗？并指定编辑器？

```
[TypeConverter("System.Windows.Forms.Design.DataSourceConverter, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")]
[Editor("System.Windows.Forms.Design.DataSourceListEditor, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")] 
```

实际上，您可以通过指定程序集将其缩写为与版本无关：

```
[TypeConverter("System.Windows.Forms.Design.DataSourceConverter, System.Design")]
[Editor("System.Windows.Forms.Design.DataSourceListEditor, System.Design", typeof(UITypeEditor))] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-03-16T14:11:07.543

我将 ComplexBindingProperties 属性添加到我的 Control 类并将 AttributeProvider 添加到我的 DataSource 属性

```
[ComplexBindingProperties("DataSource", "DataMember")]
public partial class SomeListControl : UserControl 
```

...

```
[Category("Data")]
[Description("Indicates the source of data for the control.")]
[RefreshProperties(RefreshProperties.Repaint)]
[AttributeProvider(typeof(IListSource))]
public object DataSource
{
    get { return _ultraGrid.DataSource; }
    set { _ultraGrid.DataSource = value; }
}

[Category("Data")]
[Description("Indicates a sub-list of the data source to show in the control.")]
[Editor("System.Windows.Forms.Design.DataMemberListEditor, System.Design", typeof(UITypeEditor))]    
public string DataMember
{
    get
    {
        return _ultraGrid.DataMember;
    }

    set
    {
        _ultraGrid.DataMember = value;
    }
} 
```

参考：[在 Windows 窗体控件中应用属性](https://docs.microsoft.com/en-us/dotnet/framework/winforms/controls/how-to-apply-attributes-in-windows-forms-controls)

# iis - 如何阻止 Windows Server 2008 进入睡眠状态？

> ID：478283
> 
> 赞同：1
> 
> 时间：2009-01-25T21:04:15.593
> 
> 标签：iis, windows-server-2008

我刚刚将我的服务器 2003 升级到服务器 2008。在我写这篇文章时，我的网站可以在外部访问。如果我早上再试一次，该站点将不会出现。但是，如果我重新登录服务器或从网络上的另一台计算机访问该网站，它就可以正常工作......再次！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-25T21:08:50.823

在控制面板下转到“硬件和声音”->“电源选项”，然后将计算机的睡眠属性设置为从不

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T06:00:27.680

此外，如果您在电源选项面板中将计算机设置为高性能模式，则默认为从不。

# apache - 从 IIS 5.1 迁移到 Apache 2.11，如何将 ISAPI 过滤器移动/翻译到 Apache？

> ID：478286
> 
> 赞同：0
> 
> 时间：2009-01-25T21:06:27.117
> 
> 标签：apache, iis, isapi

也许这甚至不是一个有效的问题，所以任何帮助都会很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-26T12:20:08.130

ISAPI 是一种建立在 IIS 程序接口之上的技术。您不能在 Apache 中使用 ISAPI 过滤器。因此，您必须为这些过滤器（apache 模块）找到合适的类似物。

# c# - 工具提示出现在窗体/窗口后面！(C#/VS 2008)

> ID：478295
> 
> 赞同：3
> 
> 时间：2009-01-25T21:10:40.307
> 
> 标签：c#, .net, winforms, visual-studio-2008

出于某种奇怪的原因，我在 VS 2008 C# winforms 应用程序中的工具提示出现在表单后面！这非常令人沮丧，我不知道我应该做什么。有人遇到过这种情况吗？想法？

（PS - 我正在表单中以编程方式执行工具提示。显示）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T08:51:28.440

您可能需要检查一些事项：

1.  确保工具提示知道它的父窗口是什么。
2.  确保工具提示所属的窗口位于前台（不，这不是显示工具提示的要求，它只是帮助调试。）
3.  尝试将焦点放在工具提示的所有者上。如果这样可以解决问题，那么您的工具提示可能存在所有权问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T21:50:47.070

我在 Windows XP 上看到过这种情况，尤其是在任务栏上。

您确定这是您的应用程序而不是操作系统的问题吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-01T04:08:02.653

这个问题几乎总是由窗口是 TopMost 引起的。尝试使用[`SetWindowPos`](http://msdn.microsoft.com/en-us/library/ms633545(VS.85).aspx)将您的工具提示设置为 HWND_TOPMOST。这个虽然我没试过...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T19:05:41.283

我有一个类似的问题。我有一个用 C++ WTL 编写的用户控件，用于 C# .NET2 应用程序。如果控件仅在窗体上，则控件工具提示可以正常工作，但是如果用户控件位于面板或组中，则工具提示在后面。我尝试更改 WTL 代码以将提示强制到前面，这可行，但会导致其他控件中失去焦点/选择的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-01T09:22:32.160

我已经看到这个问题发生在基于 Windows.Forms 和 Delphi（本机 Windows）的应用程序中，这是由“保持领先”与 Windows API 的交互引起的。

本质上，将表单标记为`TopMost`使其停留在某些窗口之上，而不是其他窗口 - 窗口管理具有两个以上不同的级别。

我发现是这样的：我的应用程序在正常运行时会表现自己，并在顶部显示工具提示。切换到其他应用程序和从其他应用程序切换时会出现问题 - 不知何故，windoww 的“TopMost”将变为“非常超顶级”（非技术术语;-)），工具提示出现在窗口后面。

描述了问题后，我想为您提供一个解决方案 - 但我从未找到一个好的解决方案。叹。

希望附加信息足以让您找到所需的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T02:58:11.260

尝试将您的页面元素放在前面。（右键单击元素，带到前面）。这是否发生在您配置的所有工具提示上？不，我以前没见过

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-29T02:41:56.673

出现在 Windows 任务栏后面的工具提示存在类似（并且已知）的问题。问题是零星的，我从未见过解决方案。如果您偶尔也看到这种行为（我建议您在不同的机器上尝试这种行为），那么它可能是相关的。否则，如果问题在多台机器上是一致的，让我们看看你的代码，因为你可能做错了什么。

# nhibernate - NHibernate - 改变子类型

> ID：478296
> 
> 赞同：7
> 
> 时间：2009-01-25T21:10:51.553
> 
> 标签：nhibernate, class-hierarchy

你如何去改变 NHibernate 中一行的子类型？例如，如果我有一个客户实体和 TierOneCustomer 的子类，我需要将客户更改为 TierOneCustomer，但 TierOneCustomer 应该具有与原始客户实体相同的 ID (PK)。

映射看起来像这样：

```
<class name="Customer" table="SiteCustomer" discriminator-value="C">
  <id name="Id" column="Id" type="Int64">
    <generator class="identity" />
  </id>
  <discriminator column="CustomerType" />
  ... properties snipped ...

  <subclass name="TierOneCustomer" discriminator-value="P">
    ... more properties ...
  </subclass>
</class> 
```

我正在使用每个类层次结构模型一个表，因此使用普通 sql，只需对鉴别器 (CustomerType) 进行 sql 更新并设置与类型相关的适当列。我无法在 NHibernate 中找到解决方案，因此不胜感激。

考虑到这个用例，我也在考虑模型是否正确，但在我走这条路之前，我想首先确保按照上述方式进行操作实际上是可能的。如果没有，我几乎肯定会考虑改变模型。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-25T23:32:22.750

[简短的回答是肯定的，您可以使用本机 SQL](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/querysql.html)更改特定行的鉴别器值。

但是，我不认为 N​​Hibernate 打算以这种方式工作，因为鉴别器通常对 Java 层“不可见”，它的值应该最初根据持久对象的类设置并且永远不会改变。

我建议研究一种更清洁的方法。从对象模型的角度来看，您正在尝试将超类对象转换为其子类类型之一，同时不更改其持久实例的标识，这就是冲突所在（转换后的对象实际上不应该是一样的东西）。两种替代方法是：

*   根据原Customer对象中的信息新建一个TierOneCustomer实例，然后删除原对象。如果您依赖客户的主键进行检索，则需要注意新的 PK。

或者

*   改变你的方法，这样对象类型（鉴别器）就不需要改变了。您可以使用可以随时自由修改的属性，即 Customer.Tier = 1，而不是依靠子类来区分 TierOneCustomer 和 Customer。

以下是 Hibernate 论坛上可能感兴趣的一些相关讨论：

1.  [我们可以更新 Hibernate 中的鉴别器列吗](http://forum.hibernate.org/viewtopic.php?t=946531&highlight=)
2.  [Table-per-Class 问题：判别器和属性](http://forum.hibernate.org/viewtopic.php?p=2378169)
3.  [将持久化实例转换为子类](http://forums.hibernate.org/viewtopic.php?p=2291319&sid=e61f05264d60d0ed3040ed7a76dbad73)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-25T23:56:09.630

你做错了什么。

您要做的是更改对象的类型。你不能在 .NET 或 Java 中做到这一点。这根本没有意义。一个对象只有一种具体类型，从创建对象到销毁对象（尽管有黑魔法），它的具体类型不能更改。为了完成您想要做的事情，但是使用您布置的类层次结构，您必须销毁要变成一级客户对象的客户对象，创建一个新的一级客户对象，并将所有相关属性从客户对象复制到第一层客户对象。这就是你如何在面向对象的语言中使用你的类层次结构来处理对象。

显然，您拥有的类层次结构不适合您。当他们成为一级客户时，您不会破坏现实生活中的客户！所以也不要用对象来做。相反，考虑到您需要实现的场景，提出一个有意义的类层次结构。您的使用场景包括：

*   以前不是一级状态的客户现在成为一级状态。

这意味着您需要一个可以准确捕获此场景的类层次结构。作为提示，您应该更喜欢组合而不是继承。`IsTierOne`这意味着，拥有一个名为 的属性或名为 的属性等可能是一个更好的主意`DiscountStrategy`，具体取决于最有效的方法。

NHibernate（以及 Java 的 Hibernate）的全部目的是使数据库不可见。为了让您能够原生地使用对象，数据库在幕后神奇地使您的对象持久化。NHibernate 将让您在本地使用数据库，但这不是 NHibernate 构建的场景类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-24T23:55:56.440

这真的很晚了，但可能对下一个想要做类似事情的人有用：

虽然其他答案是正确的，即在大多数情况下您*不应该*更改鉴别器，但您*可以*完全在 NH 的范围内（无本机 SQL）进行更改，并巧妙地使用映射属性。这是使用 FluentNH 的要点：

```
public enum CustomerType //not sure it's needed
{
   Customer,
   TierOneCustomer
}

public class Customer
{
   //You should be able to use the Type name instead,
   //but I know this enum-based approach works
   public virtual CustomerType Type 
   { 
      get {return CustomerType.Customer;} 
      set {} //small code smell; setter exists, no error, but it doesn't do anything.
   }
   ...
}

public class TierOneCustomer:Customer
{
   public override CustomerType Type {get {return CustomerType.TierOneCustomer;} set{}}
   ...
}

public class CustomerMap:ClassMap<Customer>
{
   public CustomerMap()
   {
      ...
      DiscriminateSubClassesOnColumn<string>("CustomerType");
      DiscriminatorValue(CustomerType.Customer.ToString());
      //here's the magic; make the discriminator updatable
      //"Not.Insert()" is required to prevent the discriminator column 
      //showing up twice in an insert statement
      Map(x => x.Type).Column("CustomerType").Update().Not.Insert();
   }
}

public class TierOneCustomerMap:SubclassMap<TierOneCustomer>
{
   public CustomerMap()
   {
      //same idea, different discriminator value
      ...
      DiscriminatorValue(CustomerType.TierOneCustomer.ToString());
      ...
   }
} 
```

最终结果是为插入指定了鉴别器值，并用于确定检索时的实例化类型，但是如果保存了具有相同 Id 的不同子类型的记录（就好像该记录是从UI 为新类型），则在现有记录上更新鉴别器值，将该 ID 作为对象属性，以便将来对该类型的检索作为新对象。属性需要设置器，因为无法告知 AFAIK NHibernate 属性是只读的（因此对数据库“只写”）；在 NHibernate 的世界里，如果你向 DB 写了一些东西，你为什么不想要它回来呢？

我最近使用这种模式来允许用户更改“旅行”的基本类型，这实际上是一组管理实际“旅行”（对客户现场设备的单一数字“访问”）日程安排的规则以确保一切正常）。虽然它们都是“旅游时间表”并且需要在列表/队列等中收集，但不同类型的时间表需要非常不同的数据和非常不同的处理，需要与 OP 类似的数据结构。因此，我完全理解 OP 希望以完全不同的方式对待 TierOneCustomer，同时尽量减少对数据层的影响，所以，来吧。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-25T23:38:48.883

如果您是离线执行（例如在数据库升级脚本中），只需使用 SQL 并自己确保一致性。

如果这是您计划在应用程序运行时发生的事情，我认为您的要求是错误的，就像为不同的对象保持相同的指针地址是错误的一样。

如果您保存 ID 并使用它再次访问客户（例如在 URL 中），请考虑创建一个包含此标记的新字段，该标记将作为业务密钥。因为它不是 ID，所以很容易创建一个新的实体实例并复制令牌（您可能需要从旧的令牌中删除该令牌）。

# c++ - 如何编写可以在 Linux 和 Windows 中轻松编译的 C++ 程序？

> ID：478298
> 
> 赞同：16
> 
> 时间：2009-01-25T21:11:22.130
> 
> 标签：c++, c, windows, linux, platform

我正在制作一个 C++ 程序。

我对 C++ 最大的烦恼之一是它所谓的平台独立性。

大家可能都知道，在没有大量神秘错误和特定于平台的包含文件的情况下，在 Windows 中编译 Linux C++ 程序和在 Linux 中编译 Windows 程序几乎是不可能的。

当然你总是可以切换到像 Cygwin 和 wine 这样的仿真，但我问你，真的没有别的办法吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-25T21:18:29.400

该语言本身是跨平台的，但大多数库不是，但是如果您想在使用 C++ 编程时完全跨平台，则应牢记三件事。

首先，您需要开始使用某种跨平台构建系统，例如[SCons](http://www.scons.org/)。其次，您需要确保您使用的所有库都是跨平台的。第三点，我建议使用所有目标平台上都存在的编译器，这里要考虑[gcc](http://gcc.gnu.org/)（C++ 是一个相当复杂的野兽，所有编译器都有自己的特定怪癖）。

我有一些关于图形用户界面的进一步建议给你。其中有几种可供使用，最值得注意的三个是：

*   [GTK+](http://www.gtk.org/)
*   [QT](http://qt.nokia.com/)
*   [wxWidgets](http://www.wxwidgets.org/)

[GTK+](http://www.gtk.org/)和[QT](http://qt.nokia.com/)是两个 API，它们带有自己的小部件集（按钮、列表等），而[wxWidgets](http://www.wxwidgets.org/)更像是当前运行平台本机小部件集的包装 API。这意味着与系统的其他部分相比，前者看起来可能有点不同，而后者看起来就像一个原生程序。

如果你喜欢游戏编程，那么有同样多的 API 可供选择，而且它们都是跨平台的。我所知道的两个最全面的功能是：

*   [SDL](http://www.libsdl.org/)
*   [SFML](http://www.sfml-dev.org/)

两者都包含从图形到输入和音频例程的所有内容，无论是通过插件还是内置的。

此外，如果您觉得 C++ 中的标准库有点缺乏，请查看[Boost](http://www.boost.org/)以获得一些通用的跨平台甜头。

祝你好运。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-25T21:19:55.203

C++ 是跨平台的。您似乎遇到的问题是您正在使用平台相关库。

我假设你真的在谈论 UI 组件——在这种情况下，我建议使用 GTK+、Qt 或 wxWindows 之类的东西——每个都有可以为不同系统编译的 UI 组件。

唯一的解决方案是让您找到和使用与平台无关的库。

而且，顺便说一句，cygwin 和 Wine 都不是仿真的——它们是在各自系统中找到的相同功能的 100% 本机实现。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-26T15:11:44.663

一旦你意识到了陷阱，它实际上并不难。我目前正在编写的所有代码都在 32 位和 64 位 Windows、各种**Linux**以及 Unix（Sun、HP 和 IBM）上编译。显然，这些不是 GUI 产品。此外，我们不使用第三方库，除非我们自己编译它们。

我有一个 .h 文件，其中包含所有特定于编译器的代码。例如，Microsoft 和 gcc 在如何指定 8 位整数上存在分歧。所以在.h中，我有

```
#if defined(_MSC_VER)
   typedef __int8 int8_t;
 #elif defined(__unix)
   typedef char int8_t;
 #endif 
```

还有相当多的代码统一了某些较低级别的函数调用，例如：

```
#if defined(_MSC_VER)
  #define SplitPath(Path__,Drive__,Name__,Ext__) _splitpath(Path__,Drive__,Dir__,Name__,Ext__)
#elif defined(__unix)
  #define SplitPath(Path__,Drive__,Name__,Ext__) UnixSplitPath(Path__,Drive__,Name__,Ext__)
#endif 
```

现在在这种情况下，我相信我必须编写一个 UnixSplitPath() 函数——有时你需要。但大多数时候，您只需要找到正确的替换函数即可。在我的代码中，我将调用 SplitPath()，即使它在任一平台上都不是本机函数；#defines 会帮我解决。训练自己需要一段时间。

信不信由你，我的 .h 文件只有 240 行长。真的没什么。这包括处理字节序问题。

一些较低级别的东西将需要条件编译。例如，在 Windows 中，我使用临界区，但在 Linux 中，我需要使用 pthread_mutex。CriticalSection 被封装在一个类中，这个类有很多条件编译。但是，上层程序完全不知道，无论平台如何，类的功能都完全相同。

我可以告诉你的另一个秘密是：经常在所有平台上构建你的项目（尤其是在开始时）。当您将编译器问题扼杀在萌芽状态时，这会容易得多。不要等到完成开发后再尝试跨平台。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-25T22:31:11.750

坚持使用跨平台的 ANSI C++ 和库，你应该没问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T21:30:31.017

创建一些包含项目中所有特定于平台的代码的低级层。实现这一层的 2 个版本——一个用于 Windows，一个用于 Linux——具有相同的接口，并将它们构建为 2 个库。通过该界面访问项目中所有特定于平台的功能。

该层可以包含用于文件访问、打印、GUI 等的通用类。

使用该层的所有（现在非平台特定的）代码现在可以在 Windows 上编译一次，在 Linux 上编译一次。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-25T21:18:25.970

在 Window 中编译它，然后在 Linux 中再次编译。除非您使用特定于平台的库，否则它应该可以工作。它不像Java，你编译一次就可以在任何地方工作。没有人为 C++ 制作过虚拟机，而且可能永远也不会。您用 C++ 编写的代码可以在任何平台上运行。你只需要先在每个平台上编译它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T09:07:36.567

建议：

*   对整数使用 typedef。或#include <stdint.h>。有些机器认为 int 是 8 个字节，有些是 4 个。（以前是 2 和 4。时代怎么变了。）

*   尽可能使用封装。我最后一个窗口的编译器认为 %lld 是 %I64d"，给出了 vsnprintf() 的错误返回值，close() 和套接字的类似问题等。

*   注意堆栈大小/缓冲区大小限制。我在 Windows 下遇到了 8k UDP 缓冲区限制，以及其他问题。

*   出于某种原因，我的 Window 的 C++ 编译器不接受堆栈外的动态大小分配。例如： void foo(int a) { int b[a]; 注意这些事情。计划如何重新编码。

*   #ifdef 可以成为你最好的朋友。还有你最大的敌人！（同时！）

当然可以。但是要尽早并经常编译和测试！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-26T14:52:04.610

Linux 和 Windows 也有不同的数据模型。见文章：[64 位程序开发中被遗忘的问题](http://www.viva64.com/art-1-2-16511733.html)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-01-26T09:09:26.987

**标准 C++**是在任何平台上都可以无错误编译的代码。尝试在 Windows 上使用**Bloodshed Dev C++**（而不是 VC++/Borland C++）。

由于 Bloodshed Dev C++ 确认了 C++ 标准，因此使用它编译的程序将在大多数情况下在 linux 上编译而不会出错。

# algorithm - 超几何函数的有效评估

> ID：478308
> 
> 赞同：6
> 
> 时间：2009-01-25T21:16:21.683
> 
> 标签：algorithm, math, numerical

有人对评估超几何函数的算法有经验吗？我会对一般参考资料感兴趣，但我会描述我的特殊问题，以防有人处理过它。

我的具体问题是评估 3F2(a, b, 1; c, d; 1) 形式的函数，其中 a、b、c 和 d 都是正实数且 c+d > a+b+1。有很多特殊情况都有封闭式公式，但据我所知，一般没有这样的公式。以零为中心的幂级数收敛于 1，但非常缓慢；连续系数的比率在极限内变为 1。也许像 Aitken 加速这样的东西会有所帮助？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T08:14:45.393

我测试了 Aitken 加速，它似乎对这个问题没有帮助（理查森外推也没有）。这可能意味着 Pade 近似也不起作用。不过我可能做错了什么，所以一定要自己尝试一下。

我可以想到两种方法。

一种是在 z = 0.5 等某个点对序列进行评估，在该点快速收敛以获得初始值，然后通过将超[几何微分方程](http://mathworld.wolfram.com/GeneralizedHypergeometricDifferentialEquation.html)插入 ODE 求解器，向前推进到 z = 1。我不知道这在实践中效果如何；它可能不是，因为 z = 1 是一个奇点（如果我没记错的话）。

[二是使用Meijer G-function](http://mathworld.wolfram.com/MeijerG-Function.html)的3F2定义。定义 Meijer G 函数的轮廓积分可以通过对轮廓段应用高斯或双指数求积来进行数值计算。这不是非常有效，但它应该可以工作，并且应该扩展到相对较高的精度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T23:07:30.180

你想对一个序列求和是否正确，你知道连续项的比率并且它是一个有理函数？

我认为[Gosper 的算法](http://en.wikipedia.org/wiki/Gosper%27s_algorithm)和其他用于证明[超几何身份](http://en.wikipedia.org/wiki/Hypergeometric_identities)（并找到它们）的工具正是这样做的，对吧？（参见 Wilf 和 Zielberger 的[A=B 在线书籍。](http://www.math.upenn.edu/~wilf/AeqB.html)）

# sql - 从 SQL Server 中的表中删除多行

> ID：478327
> 
> 赞同：6
> 
> 时间：2009-01-25T21:25:25.673
> 
> 标签：sql, sql-server

如何从 SQL Server 2000 中删除 150 万行，以及完成此任务需要多长时间。

我不想从表中删除所有记录....我只想删除所有满足 WHERE 条件的记录。

从评论编辑到下面的答案。

“我触发了相同的查询，即使用 Where 子句从 table_name 中删除......是否可以在正在运行的查询中禁用索引，因为查询是从过去 20 小时开始进行的。还请帮助我了解如何禁用索引..”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-25T21:34:32.740

如果（且仅当）您想要删除表中的所有记录，您可以使用 DROP TABLE 或 TRUNCATE TABLE。

DELETE 一次删除一条记录，并在事务日志中为每个删除的行记录一个条目。TRUNCATE TABLE 更快，因为它不在事务日志中记录活动。它从表中删除所有行，但表结构及其列、约束、索引等仍然存在。DROP TABLE 将删除那些。

如果您决定截断，请谨慎使用。这是不可逆的（除非您有备份）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-25T21:36:28.133

创建第二个表，从第一个表中插入您不想删除的所有行。

删除第一个表

将第二个表重命名为第一个

（或上述的变体）

这通常比从大表中删除选定记录更快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-25T22:38:29.740

您可能也想尝试批量删除。我刚刚在我拥有的表上进行了测试，删除操作从 13 秒缩短到了 3 秒。

```
While Exists(Select * From YourTable Where YourCondition = True)
  Delete Top (100000)
  From   YourTable
  Where  YourCondition = True 
```

如果您正在运行 SQL2000，我认为您不能使用 TOP 谓词，但它适用于 SQL2005 及更高版本。如果您使用的是 SQL2000，则可以改用以下语法：

```
Set RowCount 100000
While Exists(Select * From YourTable Where YourCondition = True)
   Delete 
   From YourTable
   Where  YourCondition = True 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-25T21:37:15.103

```
DELETE FROM table WHERE a=b; 
```

删除那么多行时，您可能希望禁用索引，这样它们就不会在每次删除时都得到更新。每次删除都重写索引会显着减慢整个过程。

您需要在开始删除之前禁用这些索引，否则可能已经存在表锁。

```
--Disable Index
ALTER INDEX [IX_MyIndex] ON MyTable.MyColumn DISABLE

--Enable Index
ALTER INDEX [IX_MyIndex] ON MyTable.MyColumn REBUILD 
```

如果要删除表中的所有条目，可以使用 TRUNCATE。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T22:49:39.077

您要从中删除的表是否有多个外键，或者级联删除或触发器？所有这些都会影响性能。

根据您想要做什么和事务完整性，您可以小批量删除内容吗？例如，如果您尝试删除 150 万条记录，即价值 1 年的数据，您可以一次执行 1 周吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-25T21:28:02.347

***从表* **中** **删除***这 150 万行的条件***

 **时间取决于。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-25T21:32:01.137

在 Oracle 上也可以使用

```
truncate table <table> 
```

不确定这是标准 SQL 还是 SQL Server 中可用的。然而，它会**清除整个表**- 但它比“删除”更快（它也会进行提交）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-25T21:36:21.503

TRUNCATE 还将忽略表上的任何引用完整性或触发器。DELETE FROM ... WHERE 将同时尊重两者。时间取决于条件列的索引、硬件和任何额外的系统负载。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-25T21:43:57.120

删除 SQL 与普通 SQL 删除完全相同

从 [您的条件] 的表中删除

但是，如果您担心时间，那么我会假设您的问题比这更深一些。如果您的表有大量非聚集索引，那么在某些情况下，首先删除所有这些索引并在删除后重建可能会更快。这*是*不寻常的，但如果您的直接删除容易受到超时问题的影响，它可能会有所帮助

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-25T23:21:52.710

```
CREATE TABLE new_table as select <data you want to keep> from old_table;

index new_table
grant on new table
add constraints on new_table
etc on new_table

drop table old_table
rename new_table to old_table; 
```

# sql-server - 如何在 Visual Studio 之外打开本地 SQL Server 数据库文件？

> ID：478338
> 
> 赞同：0
> 
> 时间：2009-01-25T21:29:57.990
> 
> 标签：sql-server, database, visual-studio, visual-studio-2008, database-connection

是否可以使用一些外部 SQL 服务器 IDE（如 Quest Toad for SQL 服务器）打开在 Visual Studio 中创建的 .mdf 数据库文件？在 Visual Studio 中创建的数据库与简单的 Access 数据库非常相似，因为它们是单个文件。

看起来像 Toad 这样的外部 IDE 在 MYMACHINE\SQLEXPRESS 下看不到由我的本地主机的 SQL 服务器实例提供的 .mdf - 我假设是因为这些文件仅在 Visual Studio 中使用 SQL 服务器的 .Net 框架提供程序提供，所以我的本地sql server 实例不提供这些文件。是这样吗？有没有办法在 Visual Studio 之外本地访问这些数据库？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T22:51:10.650

您看到的是用户实例。Sql Express 仅根据请求使用特殊的连接字符串加载那些。可以结合使用 Sql Management Studio Express 和 SSETool 来加载实例，这样您就可以管理[更多细节](http://blogs.msdn.com/sqlexpress/archive/2006/11/22/connecting-to-sql-express-user-instances-in-management-studio.aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-25T21:32:13.773

下载[SQL Server 的 TOAD。](http://www.toadsoft.com/get2knowSS/index.html)

您不会将 TOAD 指向 MDF 文件。您将其指向为 MDF 文件提供服务的 SQL Server 应用程序。如果您使用的是 SQL Server Express (2005)，则服务器将默认为 ./SQLEXPRESS，并且您将使用 Windows 身份验证。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-25T22:47:53.213

您可能在使用 sql express 时遇到的问题是它可能不在标准端口上，请在此处查看我的答案，看看是否有帮助：[https ://stackoverflow.com/questions/449607#449656](https://stackoverflow.com/questions/449607#449656)

# performance - 清除文件缓存以重复性能测试

> ID：478340
> 
> 赞同：113
> 
> 时间：2009-01-25T21:30:51.497
> 
> 标签：performance, file, caching, disk

我可以使用哪些工具或技术来删除缓存的文件内容，以防止我的性能结果出现偏差？我相信我需要完全清除或有选择地删除有关文件和目录内容的缓存信息。

我正在开发的应用程序是一个专门的压缩实用程序，预计会做很多工作来读写操作系统最近没有接触过的文件，并且这些文件的磁盘块不太可能被缓存。

当我重复分析用于执行文件处理工作的不同策略的任务时，我希望消除在 IO 时间中看到的可变性。

我主要对 Windows XP 的解决方案感兴趣，因为那是我的主要开发机器，但我也可以使用 linux 进行测试，因此我也对该环境的答案感兴趣。

我尝试[了 SysInternals CacheSet](http://technet.microsoft.com/en-us/sysinternals/bb897561.aspx)，但是单击“清除”不会导致重新读取我刚刚阅读过几次的文件的时间显着增加（冷启动后恢复到计时）。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-03-10T19:22:00.737

使用 SysInternal 的[RAMMap 应用程序](http://technet.microsoft.com/en-us/sysinternals/ff700229.aspx)。

![rammap 空待机](https://i.stack.imgur.com/EuOmF.png)

Empty / Empty Standby List 菜单选项将清除 Windows 文件缓存。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-08-18T19:40:11.170

对于 Windows XP，您应该能够通过使用带有 FILE_FLAG_NO_BUFFERING 选项的 CreateFile 打开文件然后关闭句柄来清除特定文件的缓存。这没有记录，我不知道它是否适用于更高版本的 Windows，但我很久以前在编写测试代码来比较文件压缩库时使用它。我不记得读或写访问是否影响了这个技巧。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-25T21:41:16.530

快速谷歌搜索为 Linux 提供了这些选项

1.  卸载并挂载保存文件的分区
2.  `sync && echo 1 > /proc/sys/vm/drop_caches`

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2017-03-22T09:11:32.543

可以在[此处找到命令行实用程序](https://wj32.org/wp/software/empty-standby-list/)

来源：

> `EmptyStandbyList.exe`是一个适用于 Windows（Vista 及以上）的命令行工具，可以清空：
> 
> *   处理工作集，
> *   修改后的页面列表，
> *   备用列表（优先级 0 到 7），或
> *   仅优先级 0 备用列表。
> 
> 用法：
> 
> ```
> EmptyStandbyList.exe workingsets|modifiedpagelist|standbylist|priority0standbylist 
> ```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-11-07T03:12:08.320

```
 #include <fcntl.h>

int posix_fadvise(int fd, off_t offset, off_t len, int advice); 
```

带有通知选项`POSIX_FADV_DONTNEED`：
指定的数据在不久的将来不会被访问。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-26T01:17:41.743

我发现了一种似乎可行的技术（除了重新启动）：

1.  运行几个[MemAlloc副本](http://www.soft.tahionic.com/download-memalloc/download.html)
2.  对于每一个，分配大块内存几次
3.  使用 Process Explorer 观察系统缓存大小减少到非常低的水平
4.  退出 MemAlloc 程序

虽然它不是选择性的。理想情况下，我希望能够清除用于缓存我不想再缓存的文件磁盘块的特定内存部分。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-11-20T18:51:44.493

为了更好地查看 Windows XP 文件系统缓存 - 请尝试[Tim Murgent 的 ATM](http://www.tmurgent.com/Tools/ATM/Default.aspx) - 它允许您以更详细和准确的视图查看文件系统缓存工作集大小和备用列表大小。对于 Windows XP - 您需要旧版本 1 的 ATM，可在[此处](http://www.tmurgent.com/download/ATM32_01000000.zip)下载，因为[V2](http://www.tmurgent.com/download/ATM_32bit_V2.zip)和[V3](http://www.tmurgent.com/download/ATM_x86_3.0.zip)需要 Server 2003、Vista 或更高版本。

您会观察到，尽管[Sysinternals Cacheset](http://technet.microsoft.com/en-us/sysinternals/bb897561.aspx)会减少“Cache WS Min” - 实际数据仍然以备用列表的形式继续存在，从那里可以使用它，直到它被其他东西替换。然后使用其他工具替换它，例如[Chad Austin的](http://chadaustin.me/2009/04/flushing-disk-cache/)[MemAlloc](http://www.soft.tahionic.com/download-memalloc/)或flushmem 或[Windows Server 2003 Resource Kit Tools](http://www.microsoft.com/downloads/details.aspx?FamilyID=9D467A69-57FF-4AE7-96EE-B18C4790CFFD&displaylang=en)中的 Consume.exe 。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-14T12:10:45.720

由于该问题也针对 Linux 提出，因此[这里](https://serverfault.com/q/43383/112550)有一个相关的答案。

命令行工具[vmtouch](https://hoytech.com/vmtouch/)允许在系统文件缓存中添加和删除文件和目录等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-20T09:25:41.217

有一个 Windows API 调用[https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-setsystemfilecachesize](https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-setsystemfilecachesize)可用于刷新文件系统缓存。它还可以用于将缓存大小限制为非常小的值。看起来非常适合这些类型的测试。

# ruby-on-rails - 现有应用程序中大量模型的 IP 地址记录

> ID：478355
> 
> 赞同：3
> 
> 时间：2009-01-25T21:37:35.633
> 
> 标签：ruby-on-rails, logging, ip-address

我有一个现有的应用程序，它有很多很多模型。我想记录创建它们的用户的 IP 地址，其主要目的是帮助清除垃圾邮件发送者或其他滥用行为的用户（如果我不知道他们使用的 IP 地址，我可以不要阻止它）。我需要随着时间的推移跟踪这些，因为用户可能会从家里、办公室、他们的手机等处访问，我想查看使用模式。标出用户从哪里访问或其他东西也可能很有趣，但目前任何副作用都纯粹是想法。

我们使用基于 cookie 的方法来存储用户会话。

我可以想到两种方法（我会将它们创建为回复，以便人们可以投票）：

1.  为每个模型添加 IP 地址属性，并将其传入
2.  使用观察者或 after_save 回调调用的某种 Logger 模型

想法？有没有更好的方法？这样做的插件？谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-25T21:40:31.977

使用观察者或 after_save 回调调用的某种 Logger 模型

优点：

*   可以通过观察者完成，因此模型甚至不需要知道
*   所有日志记录都发生在一个模型/数据库表中，因此以后可以轻松查询和运行报告

缺点：

*   在不修改每个 Model.create 来传递它的情况下，我怎么能得到 IP 地址？我必须打破 MVC 理论，我愿意这样做，但我真的不知道怎么做

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T00:34:21.970

我会为此使用多态关联，然后您可以将其应用于所有需要跟踪的模型。这样可以最大限度地减少向每个模型添加 IP 地址列的麻烦，并显着减少代码库中的重复数量。然后走观察者路线可能是连接模型的最简单方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T21:39:03.213

为每个模型添加 IP 地址属性，并将其传入

优点：

*   概念上很简单。有一个属性，我可以很容易地看到发布 123 是由用户 222 w/IP 123.123.123.123 上传的

缺点：

*   要求我触摸/重新编码每个模型和每个 Model.create（它使用 Model.create params[:model] 的 rails 习惯用法，所以我只需添加 request.address）。这是很多工作。许多测试将不得不重新编写
*   如果我曾经迁移到 IPv6，这将失败（如果模型期望 IPv4 addys）

# python - Python 和 os.chroot

> ID：478359
> 
> 赞同：2
> 
> 时间：2009-01-25T21:39:22.930
> 
> 标签：python, linux, chroot

我正在用 Python 编写一个网络服务器作为一个爱好项目。该代码针对 *NIX 机器。我是在 Linux 上开发的新手，甚至是 Python 本身的新手。

我担心有人会破坏我用来提供网站的文件夹。最明显的方法是过滤对 /../../etc/passwd 等文档的请求。但是，我担心可能有一些聪明的方法可以爬上我不知道的目录树，因此我的过滤器不会捕获。

我正在考虑使用 os.chroot 添加，以便根目录是网站本身。这是防止这些越狱攻击的安全方法吗？这样做有什么潜在的陷阱会伤害我吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-25T22:02:05.320

是的，有陷阱。安全方面：

1.  如果你以 root 身份运行，总有办法突破。所以首先 chroot()，然后永久删除其他用户的权限。
2.  把不是绝对需要的东西放到 chroot 树中。尤其是没有 suid/sgid 文件、命名管道、unix 域套接字和设备节点。

Python 明智，你的整个模块加载被搞砸了。Python 根本不适合这种情况。如果您的应用程序比较复杂，您*将*遇到模块加载问题。

我认为比 chrooting 更重要的是作为非特权用户运行并简单地使用文件系统权限来阻止该用户阅读任何重要的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-25T23:15:25.327

查看[扭曲](http://twistedmatrix.com)的。`twistd`支持开箱即用的特权脱落和 chroot 操作。此外，它还有一个用于编写网络服务、守护进程和几乎所有东西的完整框架。

# c++ - C++、win32、gdi 打印：DrawEdge 没有达到 DrawText？

> ID：478362
> 
> 赞同：0
> 
> 时间：2009-01-25T21:39:58.080
> 
> 标签：c++, winapi, printing, gdi

我正在尝试使用 DrawEdge 和 DrawText 函数（[http://msdn.microsoft.com/en-us/library/ms534882.aspx](http://msdn.microsoft.com/en-us/library/ms534882.aspx)和[http://msdn.microsoft.com/en-us/library/ms533909.aspx](http://msdn.microsoft.com/en-us/library/ms533909.aspx)）。它们工作得很好，然而，当我试图到达我的纸的底部（距离它大约 35 毫米）时，这条线就停止了绘制。我认为这是我的打印机的限制。但是，当我绘制文本时，我的打印机在那里打印没有问题，甚至更低。DrawEdge 有没有办法在那里画线？还有另一种方法可以做到这一点吗？这是一个错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-29T15:28:37.637

我能想到几个原因：

*   您在绘制边缘时设置了一个剪辑区域，而在绘制文本时设置了不同的剪辑区域。

*   剪切区域已设置，但打印机并未始终剪切文本。一些打印机将打印整个字符，即使它只有一部分在剪辑区域内。您可以使用`GetDeviceCaps`with来检查其文本剪辑能力`TEXTCAPS`。如果是这种情况，剪裁区域底部附近打印的文本可能会显示，但其他类型的图形（如线条）将被剪裁。

*   您误解了页面的可打印区域。这是什么类型的打印机？许多打印机无法在距底边 35 毫米的范围内打印。驱动程序报告的可打印区域是什么？（使用`GetDeviceCaps`和`PHYSICALOFFSETY`来`PHYSICALHEIGHT`确定您可以实际打印的页面的高度。）

祝你好运！

# language-agnostic - 当您无法弄清楚某件事并且没有人要问时，最好的方法是什么？

> ID：478365
> 
> 赞同：5
> 
> 时间：2009-01-25T21:41:10.353
> 
> 标签：language-agnostic

这个问题的第二部分是关键。如果您是少数程序员中的一员，并且在无休止的夜晚敲打着键盘之后，您无法弄清楚一些事情，而您的组织中没有其他人可以问，您会做什么？没有人可以询问更多的是因为要让他们加快速度甚至让他们评估问题都需要很长时间。在这些情况下，您是否与管理层进行了不愉快的对话并告诉他们需要有更多经验的第三方承包商？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-25T22:16:12.250

有时每个人都会遇到一个似乎没有明显出路的问题。

1）问问自己你是否是第一个解决这个问题的人——如果不是，那么很可能会有答案。尝试谷歌，SO等。

2）休息一下，试着做一些别的事情——离开键盘几个小时，想想别的事情能做什么，真是太神奇了。

3）尝试与其他人谈论问题，即使他们不是技术人员 - 有时向非技术人员或非技术人员解释问题的过程可以引导您从不同的角度找到正确的答案或方法。

4）承认这比你想象的要难，否则你会被卡住。一个好老板会帮助你为你和他们的企业取得正确的结果。让他们了解您迄今为止所做的努力以及您做出的结论和决定。

5）如果一切都失败了，请帮助您的老板选择承包商，因为您可能必须维护他们的代码:-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-25T22:52:20.100

我最喜欢的是橡皮鸭调试，在这里解释：http: [//lists.ethernal.org/oldarchives/cantlug-0211/msg00174.html](http://lists.ethernal.org/oldarchives/cantlug-0211/msg00174.html)

> 我们称其为橡皮鸭调试方法。它是这样的：
> 
> 1) 乞讨、借用、偷窃、购买、制造或以其他方式获得橡皮鸭
> （浴缸品种）
> 
> 2) 将橡皮鸭放在桌子上并告诉它你将用它检查一些代码，如果没关系的话。
> 
> 3）向鸭子解释你的代码应该做什么，然后逐行详细解释
> 
> 4）在某个时候，你会告诉鸭子你接下来要做什么，然后意识到这实际上并不是你真正在做什么。鸭子会安静地坐在那里，很高兴知道它在你的路上帮助了你。
> 
> 每次都有效。实际上，如果您没有橡皮鸭，您可以在紧要关头请其他程序员或工程师坐下。
> 
> 安迪

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T22:16:02.810

有时，如果我无法提出解决方案，可能是因为我解决问题的方法走错了路。不去想这个问题对我有很大帮助。休息后回到它可以提供一个新的见解，可能有助于找到解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-25T22:26:50.137

根据问题，有时我会开发一次性应用程序来测试/使用该特定功能/错误/无论项目中存在的所有其他先决条件和依赖项（并且可能会影响结果）。

尝试重新定义问题。有时您可以重新编写您正在编写的软件，这样您就不会遇到您要解决的问题。有时这不是您的解决方案的问题，而是您尝试在其中实现它的软件的状态。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T22:47:03.233

首先我谷歌
如果这没有帮助我尝试将问题分成我可以解决的部分。通常，我在这些部分中获得的洞察力会充分启发我，因此我可以在困难的部分进行新的尝试。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-26T00:18:34.733

我喜欢先开始研究最简单的部分。那么，如果您不知道如何在地图中找到优化的路径算法怎么办？只需从编写洪水填充绘图代码开始。然后做战斗的 AI 套路，毕竟他们也需要完成。然后当你在天气模拟器上工作时，你会意识到你的潜意识在你睡觉的时候一直在研究路径算法的细节。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-25T23:53:41.880

我在整个项目中都面临这种情况，我是[工作中唯一的程序员，负责架构一直到维护](http://moffdub.wordpress.com/2008/04/28/introducing-the-project/)。

我通过积极使用谷歌和编程问答网站来处理它，尽管当时我没有 SO（求助于雅虎！几次回答）。大多数时候，我找不到我真正需要的东西，我不得不动用我的大脑，做一些核心的故障排除来解决大多数问题。

当您完全被困在砖墙后面时，您需要想出让最终用户满意的解决方法。您可能无法通过纯粹的编程力量使一切正常工作。

我同意这里的另一个答案，有时起身离开问题通常会为您提供当您在键盘后面时永远不会发生的洞察力。我经常在开车或洗澡时想到我最聪明的想法。

# visual-studio - 与 Visual Studio 集成的免费分布式源代码控制？

> ID：478368
> 
> 赞同：6
> 
> 时间：2009-01-25T21:42:07.840
> 
> 标签：visual-studio, version-control, dvcs

我希望转向分布式源代码控制，因为我使用多台计算机并且经常离线工作。如果任何分布式源代码控制系统与 Visual Studio 集成，集成效果如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-25T21:45:40.033

我不确定与 VS 的集成，但我使用了出色的 Tortoise Windows Explorer 插件。我们一直使用 Tortoise-CVS 和 SVN，它们既快速又可靠。

他们也为 Mercurial 做了一个 Tortoise-Hg 插件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-24T16:36:54.317

你考虑过使用[Git](http://git-scm.com/)吗？[您可以在github](http://github.com/)上免费托管开源项目。

有关集成，请参阅将[Git 与 Visual Studio](https://stackoverflow.com/questions/507343/using-git-with-visual-studio)一起使用，这表明它是可能的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-25T23:09:43.327

听起来可能很有趣，但我很少使用我的 VS 集成，即使我有一个。

乌龟和命令行很好用，Bzr 和 Hg 有可用的乌龟。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-01T20:57:40.823

[AnkhSVN](http://ankhsvn.open.collab.net/)为我和我的团队很好地完成了这项工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T07:14:44.743

贾里德，

如果您需要分布式和 VStudio 集成，那么您正在谈论[Plastic SCM](http://www.plasticscm.com)

整个 GUI 与 VStudio 2005 及更高版本集成，从 VStudio 6 开始提供 SCC 集成。

它也直接支持从 VStudio 重命名和移动文件。

Plastic SCM 对学生、开源项目是免费的，而且您很可能也可以获得一些个人项目的免费许可证。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-16T20:23:58.247

还有[VisualHG](http://visualhg.codeplex.com/)，TortoiseHG 是 Visual Studio Plaugin。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-01T20:39:27.193

我使用颠覆和tortoisesvn。为了与 VS 集成，我使用了 VisualSVN，它确实要花钱，但它非常便宜并且可以完美运行。Visual Studio 有免费的 subversion 源代码控制提供程序包，我尝试了一些，但 VisualSVN 工作得更好，所以我选择了它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-16T20:35:22.440

我喜欢使用[KilnHG](http://www.fogcreek.com/kiln/)（它是 Mercurial 的在线包装器）——据我所知，它对少数开发人员是免费的。

# python - 如何发送具有相同名称的多个输入字段值？

> ID：478382
> 
> 赞同：13
> 
> 时间：2009-01-25T21:55:12.493
> 
> 标签：python, django, django-forms

我有 m2m 字段，可以说它有名称“关系”，所以我想允许用户发送他想要的尽可能多的关系。我用同名的javascript向html添加新的输入，就像这样

```
<input type='text' name='relations' value='a' />
<input type='text' name='relations' value='b' /> 
```

在cleaned_data 中，我只收到第二个输入（'b'）的值。如何同时接收？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-25T22:11:21.340

我不知道如何用 Forms 做到这一点，但如果你想以原始方式获取值，我会这样做：

```
relations = request.POST.getlist('relations') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T06:38:51.937

您不需要获取所有原始值，您可以通过使用元素名称来获取特定数据，如下所示：

```
relations = request.form.getlist('relations') 
```

这将返回`relations`输入中的值列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-24T20:52:35.840

这会生成一个列表，您可以在 for

```
request.POST.getlist('relations') 
```

# ios - 在 UIWebView 中更改用户代理

> ID：478387
> 
> 赞同：72
> 
> 时间：2009-01-25T21:57:56.390
> 
> 标签：ios, iphone, cocoa-touch, uiwebview

我有一个业务需要能够为嵌入式 UIWebView 自定义 UserAgent。（例如，如果用户使用的是应用程序的一个版本而不是另一个版本，我希望服务器做出不同的响应。）

是否可以像 Windows 应用程序中的嵌入式 IE 浏览器那样自定义现有 UIWebView 控件中的 UserAgent？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-09-02T15:28:59.783

### 现代斯威夫特

以下是 StackOverflow 用户 PassKit 和 Kheldar 对 Swift 3+ 项目的建议：

```
UserDefaults.standard.register(defaults: ["UserAgent" : "Custom Agent"]) 
```

来源：[https ://stackoverflow.com/a/27330998/128579](https://stackoverflow.com/a/27330998/128579)

### 较早的 Objective-C 答案

随着 iOS 5 的变化，我推荐以下方法，最初来自这个 StackOverflow 问题：[UIWebView iOS5 changed user-agent](https://stackoverflow.com/questions/8487581/uiwebview-ios5-changing-user-agent) as pointed in an answer below。在该页面的评论中，它似乎也适用于 4.3 及更早版本。

> 通过在您的应用启动时运行此代码一次来更改“UserAgent”默认值：
> 
> ```
> NSDictionary *dictionary = @{@"UserAgent": @"Your user agent"};
> [[NSUserDefaults standardUserDefaults] registerDefaults:dictionary];
> [[NSUserDefaults standardUserDefaults] synchronize]; 
> ```

如果您需要在 4.3/5.0 之前的 iOS 版本中工作的方法，请参阅这篇文章的先前编辑。请注意，由于进行了广泛的编辑，此页面上的以下评论/其他答案可能没有意义。毕竟，这是一个四年前的问题。;-)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-06-19T08:01:15.780

我也遇到了这个问题，各种方法都试过了。我发现只有这种方法有效（iOS 5.x）： [UIWebView iOS5 changed user-agent](https://stackoverflow.com/questions/8487581/uiwebview-ios5-changing-user-agent)

原理是在用户设置中永久设置用户代理。这行得通；Webview 发送给定的标头。只需两行代码：

```
NSDictionary *dictionary = [NSDictionary dictionaryWithObjectsAndKeys:@"Mozilla/Whatever version 913.6.beta", @"UserAgent", nil];
[[NSUserDefaults standardUserDefaults] registerDefaults:dictionary]; 
```

在可变请求中设置 User-Agent 或 User_Agent，或者通过 swizzling 覆盖 NSHttpRequest 中的 setValue，-我尝试了所有这些并使用 wireshark 控制了结果，但这些似乎都不起作用，因为 Webview 仍然使用用户代理值从用户默认值开始，无论您尝试在 NSHttpRequest 中设置什么。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-17T21:16:39.060

它应该与 Kuso 所写的 NSMutableURLRequest 一起使用。

```
NSMutableURLRequest *urlRequest = [[NSMutableURLRequest alloc] initWithURL: [NSURL URLWithString: @"http://www.google.com/"]];
[urlRequest setValue: @"iPhone" forHTTPHeaderField: @"User-Agent"]; // Or any other User-Agent value. 
```

您必须使用 NSURLConnection 来获取 responseData。将 responseData 设置为您的 UIWebView 并且 webView 应该呈现：

```
[webView loadData:(NSData *)data MIMEType:(NSString *)MIMEType textEncodingName:(NSString *)encodingName baseURL:(NSURL *)baseURL]; 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-12-06T11:10:05.753

在 Swift 中非常简单。只需将以下内容放入您的 App Delegate 中。

```
UserDefaults.standard.register(defaults: ["UserAgent" : "Custom Agent"]) 
```

如果要附加到现有代理字符串，则：

```
let userAgent = UIWebView().stringByEvaluatingJavaScript(from: "navigator.userAgent")! + " Custom Agent"
UserDefaults.standard.register(defaults: ["UserAgent" : userAgent]) 
```

注意：您可能需要卸载并重新安装应用程序以避免附加到现有代理字符串。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-01-05T21:23:14.850

采取一切这就是它为我解决的方法：

```
- (void)viewDidLoad {
    NSURL *url = [NSURL URLWithString: @"http://www.amazon.com"];
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
    [request setValue:@"Foobar/1.0" forHTTPHeaderField:@"User-Agent"];
    [webView loadRequest:request];
} 
```

感谢大家。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-01-12T20:39:31.157

使用 @"User_Agent" 只会导致自定义标头出现在 GET 请求中。

> User_agent: Foobar/1.0\r\n
> User-Agent: Mozilla/5.0 (iPhone; U; CPU iPhone OS 3_1_2 like Mac OS X; en-us) AppleWebKit/528.18 (KHTML, like Gecko) Mobile/7D11\r\n

以上是剖析的 HTTP 数据包中出现的内容，基本上证实了 Sfjava 从该论坛引用的内容。有趣的是，“User-Agent”变成了“User_agent”。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2010-09-21T13:57:24.947

实际上，将任何标头字段添加到 shouldStartLoadWithRequest 中的 NSURLRequest 参数 **似乎**有效，因为请求响应 setValue:ForHTTPHeaderField - 但它实际上**不起作用**- 请求在没有标头的情况下发出。

所以我在 shouldStartLoadWithRequest 中使用了这个解决方法，它只是将给定的请求复制到一个新的可变请求中，然后重新加载它。这实际上会修改发送出去的标头。

```
if ( [request valueForHTTPHeaderField:@"MyUserAgent"] == nil )
{
    NSMutableURLRequest *modRequest = [request mutableCopyWithZone:NULL];
    [modRequest setValue:@"myagent" forHTTPHeaderField:@"MyUserAgent"];
    [webViewArgument loadRequest:modRequest];
    return NO;
} 
```

不幸的是，这仍然不允许覆盖用户代理 http 标头，该标头显然已被 Apple 覆盖。我想要覆盖它，您必须自己管理 NSURLConnection 。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-08-07T17:36:23.637

通过汇集[Louis St-Amour 的答案](https://stackoverflow.com/a/1368399/1580288)和[来自这个问题/答案](https://stackoverflow.com/a/18109860/1580288)`NSUserDefaults+UnRegisterDefaults`的类别，您可以使用以下方法在您的应用程序运行时随时启动和停止用户代理欺骗：

```
#define kUserAgentKey @"UserAgent"

- (void)startSpoofingUserAgent:(NSString *)userAgent {
    [[NSUserDefaults standardUserDefaults] registerDefaults:@{ kUserAgentKey : userAgent }];
}

- (void)stopSpoofingUserAgent {
    [[NSUserDefaults standardUserDefaults] unregisterDefaultForKey:kUserAgentKey];
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-08-05T16:13:58.633

这个解决方案似乎被视为一种非常聪明的方法

[更改-the-headers-for-uiwebkit-http-requests](http://www.icab.de/blog/2010/04/07/changing-the-headers-for-uiwebkit-http-requests/)

它使用 Method Swizzling，您可以在[CocoaDev 页面上了解更多信息](http://www.cocoadev.com/index.pl?MethodSwizzling)

给它看看！

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-05-14T12:10:34.143

我面临同样的问题。我想向用户代理添加一些信息，还需要保留 webview 的原始用户代理。我通过使用下面的代码解决了它：

```
 //get the original user-agent of webview
UIWebView *webView = [[UIWebView alloc] initWithFrame:CGRectZero];
NSString *oldAgent = [webView stringByEvaluatingJavaScriptFromString:@"navigator.userAgent"];
NSLog(@"old agent :%@", oldAgent);

//add my info to the new agent
NSString *newAgent = [oldAgent stringByAppendingString:@" Jiecao/2.4.7 ch_appstore"];
NSLog(@"new agent :%@", newAgent);

//regist the new agent
NSDictionary *dictionnary = [[NSDictionary alloc] initWithObjectsAndKeys:newAgent, @"UserAgent", nil];
[[NSUserDefaults standardUserDefaults] registerDefaults:dictionnary]; 
```

在实例化 webview 之前使用它。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-01-17T12:28:29.637

Try this in the AppDelegate.m

```
+ (void)initialize 

{

    // Set user agent (the only problem is that we can’t modify the User-Agent later in the program)

    // iOS 5.1

    NSDictionary *dictionnary = [[NSDictionary alloc] initWithObjectsAndKeys:@”Mozilla/5.0 (iPad; CPU OS 5_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9B176 Safari/7534.48.3”, @”UserAgent”, nil];

    [[NSUserDefaults standardUserDefaults] registerDefaults:dictionnary];

} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-02-08T12:10:33.147

我发现的唯一问题是仅更改用户代理

```
- (BOOL)application:(UIApplication *)application
        didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    NSDictionary *dictionary = [NSDictionary 
        dictionaryWithObjectsAndKeys:
        @"Mozilla/5.0 (iPod; U; CPU iPhone OS 4_3_3 like Mac OS X; ja-jp) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5", 
        @"UserAgent", nil];
    [[NSUserDefaults standardUserDefaults] registerDefaults:dictionary];
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-01-23T23:36:46.323

Apple 将很快停止接受带有 UIWebView 的应用程序。在下面查找如何更改 WKWebView 中的用户代理。

```
let config = WKWebViewConfiguration()

config.applicationNameForUserAgent = "My iOS app"

webView = WKWebView(frame: <the frame you need>, configuration: config) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-09-11T19:02:50.583

要将自定义内容添加到当前 UserAgent 值，请执行以下操作：

1 - 从新的 WEBVIEW 获取用户代理值

2 - 将自定义内容附加到它

3 - 使用键 UserAgent 将新值保存在字典中

4 - 将字典保存在标准用户默认值中。

请参见下面的示例：

```
NSString *userAgentP1 = [[[UIWebView alloc] init] stringByEvaluatingJavaScriptFromString:@"navigator.userAgent"];
NSString *userAgentP2 = @"My_custom_value";
NSString *userAgent = [NSString stringWithFormat:@"%@ %@", userAgentP1, userAgentP2];
NSDictionary *dictionary = [NSDictionary dictionaryWithObjectsAndKeys:userAgent, @"UserAgent", nil];
[[NSUserDefaults standardUserDefaults] registerDefaults:dictionary]; 
```

# c# - 如何在 .net 中创建 13 个月的基于月球的日历

> ID：478388
> 
> 赞同：6
> 
> 时间：2009-01-25T21:58:15.280
> 
> 标签：c#, .net, calendar, globalization, culture

嗨我想创建一个自定义日历，这个日历将有自定义月份名称和日期名称

它将包含 13 个月，每个 28 天

我需要创建和整个文化还是我可以创建自己的 System.Globalization.Calendar 实现？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-25T22:13:26.170

我对 .NET 不熟悉，但通过谷歌搜索发现了这一点。也许你可以把它作为一个起点。

[.NET 的越南农历](http://www.codeproject.com/KB/dotnet/VnCalendar.aspx)

# algorithm - 在二维网格上模拟膨胀气体的算法

> ID：478401
> 
> 赞同：4
> 
> 时间：2009-01-25T22:07:12.593
> 
> 标签：algorithm, math, fluid, expansion

我有一个简单的程序，它的核心是一个二维浮点数组，据说代表气体浓度，我一直试图想出一个简单的算法来模拟向外膨胀的气体，就像一朵云，最终得到电网各处的气体浓度相同。

例如，给定的状态进程可能是：（为简单起见，使用整数）

起始状态

00000
00000
00900
00000
00000

1 次算法通过后的状态

00000
01110
01110
01110
00000

再过一次应该给出一个 5x5 的网格，所有网格都包含 0.36 (9/25) 的值。
我已经在纸上进行了尝试，但无论我如何尝试，我都无法理解算法来做到这一点。

所以我的问题是，我应该如何着手编写这个算法？我已经尝试了一些方法，应用卷积，尝试依次获取每个网格单元并将其分配给它的邻居，但它们最终都会产生不良影响，例如最终使用的气体比我最初开始时少，或者所有的气体运动都在一个方向上，而不是从中心向外扩展。我真的完全无法理解它，并且非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-25T22:37:47.963

如果你忽略对流，要么是扩散问题，要么是流体动力学/传质问题。如果您从头开始求解，您将从欧拉（固定控制体积）视点的质量和动量守恒方程开始。

这是一个瞬态问题，因此您需要执行积分以将状态从时间 t(n) 推进到 t(n+1)。您显示了一个网格，但没有说明您如何及时解决。您尝试过哪种集成方案？明确的？隐式？曲柄-尼科尔森？如果您不知道，则说明您没有正确解决问题。

关于这个主题，我非常喜欢的一本书是 SW Patankar 的[“数值传热和流体流动”](https://rads.stackoverflow.com/amzn/click/com/0891165223)。现在有点过时了，但我喜欢这种治疗方法。29 年后它仍然很好，但自从我阅读这个主题以来，可能会有更好的文本。我认为对于第一次研究它的人来说这是平易近人的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-25T22:37:14.437

在您给出的示例中，您的第二阶段的核心为 1。通常扩散需要浓度梯度，因此大多数与扩散相关的技术不会在下一次迭代中改变中间的 1（也不会在第一次迭代后达到那种状态，但是一旦你已经得到一个相等值的块）。但正如您帖子上的评论者所说，这不太可能是网络运动的原因。减少气体可能是边缘效应，但也可能是舍入误差的问题 - 将 cpu 设置为平均舍入一半，然后计算气体并不时应用修正。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-25T22:45:55.513

看起来您正在尝试使用 Neumann 边界条件（边缘绝缘）为热方程实现有限差分求解器。有很多关于这种事情的文献。[有限差分法](http://en.wikipedia.org/wiki/Finite_difference_method)的维基百科页面描述了一种简单但稳定的方法，但适用于狄利克雷边界条件（边缘处的恒定密度）。修改边界条件的处理应该不会太困难。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T00:25:58.150

看起来你想要的是一种平滑算法，通常用于 Photoshop 等程序或老式演示效果，比如这个简单的[火焰效果](http://freespace.virgin.net/hugo.elias/models/m_fire.htm)。

无论您使用什么算法，它都可能帮助您对数组进行[双重缓冲。](http://en.wikipedia.org/wiki/Double_buffering)

典型的平滑效果类似于：

```
begin loop forever
    For every x and y
    {
        b2[x,y]  = (b1[x,y] + (b1[x+1,y]+b1[x-1,y]+b1[x,y+1]+b1[x,y-1])/8) / 2
    }
    swap b1 and b2
end loop forever 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T01:46:21.153

请参阅[Tom Forsyth 的 Game Programming Gems 文章](http://home.comcast.net/~tom_forsyth/papers/cellular_automata_for_physical_modelling.html)。看起来它满足您的要求，但如果没有，那么它至少应该给您一些想法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-26T19:55:19.617

为简单起见，这里有一个 1D 解决方案：

初始设置在原点 () 处的浓度为 9，在所有其他正坐标和负坐标处浓度为 0。

初始状态：0 0 0 0 (9) 0 0 0 0

寻找下一个迭代值的算法是从原点开始，并与相邻邻居的平均电流浓度。原点值是一个边界情况，平均是考虑原点值和它的两个邻居同时进行的，即3个值的平均值。所有其他值在 2 个值之间有效平均。

迭代 1 后：0 0 0 3 (3) 3 0 0 0

迭代 2 后：0 0 1.5 1.5 (3) 1.5 1.5 0 0

迭代 3 后：0 .75 .75 2 (2) 2 .75 .75 0

迭代 4 后： .375 .375 1.375 1.375 (2) 1.375 1.375 .375 .375

您在循环中执行这些迭代。每 n 次迭代输出状态。您可以引入一个时间常数来控制多少次迭代代表一秒的时钟时间。这也是整数坐标表示的长度单位的函数。对于给定的硬件系统，您可以根据经验调整此值。您还可以引入稳态容差值来控制程序何时说“所有相邻值都在此容差范围内”或“迭代之间没有值更改超过此容差”，因此算法已达到稳态解。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T03:00:02.067

给定起始浓度的每次迭代的浓度可以通过下式获得：

```
concentration = startingConcentration/(2*iter + 1)**2 
```

iter 是时间迭代。所以对于你的例子。

```
startingConcentration = 9
iter = 0
concentration = 9/(2*0 + 1)**2 = 9

iter = 1
concentration = 9/(2*1 + 1)**2 = 1

iter = 2
concentration = 9/(2*2 + 1)**2 = 9/25 = .35 
```

您可以在每个“时间步长”之后设置数组的值

# visual-studio - Castle ActiveRecord 和 ActiveRecord VS 解决方案模板

> ID：478402
> 
> 赞同：0
> 
> 时间：2009-01-25T22:08:11.720
> 
> 标签：visual-studio, visual-studio-2008, castle-activerecord

您需要做什么或安装什么才能让 ActiveRecord VS 解决方案模板在 Visual Studio 2008 中工作？我已经安装了 Castle Project，但是在 VS2008 中我没有看到任何新的解决方案模板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T23:25:14.670

如果您使用 Castle RC3，则 MSI 安装程序仅包含VS2003 和 VS2005 的[Visual Studio 集成](http://www.castleproject.org/castle/vsintegration.html)。对于 VS2008 集成，请参阅[这篇文章](http://tech.wowkhmer.com/post/2008/11/04/Get-Started-Castle-MonoRail-Project-Template-for-VS2008.aspx)。

# java - 我可以在 Java 运行时添加和删除枚举元素吗

> ID：478403
> 
> 赞同：63
> 
> 时间：2009-01-25T22:08:54.293
> 
> 标签：java, enums

可以在运行时从 Java 中的枚举中添加和删除元素吗？

例如，我可以从文件中读取枚举的标签和构造函数参数吗？

* * *

@saua，这只是一个是否真的可以出于兴趣而做的问题。我希望有一些巧妙的方法来改变正在运行的字节码，也许使用[BCEL](http://bcel.sourceforge.net/)或其他东西。我也跟进了[这个问题](https://stackoverflow.com/questions/481068/when-to-use-enum-or-collection-in-java)，因为我意识到我不完全确定何时应该使用枚举。

如果我希望能够在运行时安全地更改内容，我非常相信正确的答案是使用确保唯一性的集合而不是枚举。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-25T22:29:54.873

不，枚举应该是一个完整的静态枚举。

在编译时，您可能希望从其他某种源文件生成枚举 .java 文件。你甚至可以像这样创建一个 .class 文件。

在某些情况下，您可能需要一组标准值但允许扩展。执行此操作的常用方法是`interface`为接口设置一个`enum`，`interface`为标准值实现一个。当然，`switch`当您只有对`interface`.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-25T22:31:57.380

在幕后，枚举是具有私有构造函数和一堆枚举类型的公共静态最终值的 POJO（参见[此处](http://snipplr.com/view/1655/typesafe-enum-pattern/)的示例）。事实上，在 Java5 之前，以这种方式构建自己的枚举被认为是最佳实践，并且 Java5 引入了`enum`关键字作为速记。请参阅[Enum<T>](http://www.docjar.com/html/api/java/lang/Enum.java.html)的源代码以了解更多信息。

因此，使用由构造函数读取或传递给它的公共静态最终常量数组编写自己的“TypeSafeEnum”应该没有问题。

另外，帮自己一个忙，覆盖`equals`, `hashCode`and `toString`，如果可能的话，创建一个`values`方法

问题是如何使用这样的动态枚举......你不能从文件中读取值“PI = 3.14”来创建`enum MathConstants`然后继续使用`MathConstants.PI`你想要的任何地方......

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-03-15T11:56:07.210

我需要做这样的事情（出于单元测试目的），我遇到了这个 - EnumBuster： [http ://www.javaspecialists.eu/archive/Issue161.html](http://www.javaspecialists.eu/archive/Issue161.html)

它允许添加、删除和恢复枚举值。

**编辑**：我刚刚开始使用它，发现 java 1.5 需要一些细微的变化，我目前坚持：

*   添加数组 copyOf 静态辅助方法（例如采用这些 1.6 版本： http: [//www.docjar.com/html/api/java/util/Arrays.java.html](http://www.docjar.com/html/api/java/util/Arrays.java.html)）
*   将 EnumBuster.undoStack 更改为堆栈`<Memento>`
    *   在 undo() 中，将 undoStack.poll() 更改为 undoStack.isEmpty() ？null : undoStack.pop();
*   对于我迄今为止尝试过的 java 1.5 枚举，字符串 VALUES_FIELD 需要是“ENUM$VALUES”

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-26T00:22:54.507

[我在年轻的职业生涯中](http://moffdub.wordpress.com/2008/04/28/introducing-the-project/)遇到了这个问题。

我采用的方法是在外部保存枚举的值和名称，最终目标是能够编写看起来尽可能接近语言枚举的代码。

我希望我的解决方案看起来像这样：

```
enum HatType
{
    BASEBALL,
    BRIMLESS,
    INDIANA_JONES
}

HatType mine = HatType.BASEBALL;

// prints "BASEBALL"
System.out.println(mine.toString());

// prints true
System.out.println(mine.equals(HatType.BASEBALL)); 
```

我最终得到了这样的结果：

```
// in a file somewhere:
// 1 --> BASEBALL
// 2 --> BRIMLESS
// 3 --> INDIANA_JONES

HatDynamicEnum hats = HatEnumRepository.retrieve();

HatEnumValue mine = hats.valueOf("BASEBALL");

// prints "BASEBALL"
System.out.println(mine.toString());

// prints true
System.out.println(mine.equals(hats.valueOf("BASEBALL")); 
```

由于我的要求是必须可以在运行时将成员添加到枚举中，因此我还实现了该功能：

```
hats.addEnum("BATTING_PRACTICE");

HatEnumRepository.storeEnum(hats);

hats = HatEnumRepository.retrieve();

HatEnumValue justArrived = hats.valueOf("BATTING_PRACTICE");
// file now reads:
// 1 --> BASEBALL
// 2 --> BRIMLESS
// 3 --> INDIANA_JONES
// 4 --> BATTING_PRACTICE 
```

我将其称为动态枚举“模式”，您阅读了有关[原始设计](http://moffdub.wordpress.com/2008/05/09/dynamic-enumerations/)及其[修订版的](http://moffdub.wordpress.com/2009/01/14/dynamic-enumerations-revisited/)信息。

两者的区别在于修改版是在我真正开始摸索OO和DDD之后设计的。我在写名义上的程序 DDD 时设计的第一个，时间压力也不小。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T22:50:45.020

您可以在运行时从源代码加载 Java 类。（使用 JCI、BeanShell 或 JavaCompiler）

这将允许您根据需要更改 Enum 值。

注意：这不会更改引用这些枚举的任何类，因此这在现实中可能不是很有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-01-26T13:30:58.653

一个广泛使用的工作示例是在修改后的 Minecraft 中。[请参阅Github](https://github.com/MinecraftForge/MinecraftForge/blob/1.12.x/src/main/java/net/minecraftforge/common/util/EnumHelper.java#L257-#L430)上的 EnumHelper.addEnum() 方法

但是，请注意，**在极少数情况下**，实际经验表明，添加 Enum 成员可能会导致 JVM 优化器出现一些问题。确切的问题可能因不同的 JVM 而异。但从广义上讲，优化器似乎可能假设 Enum 的某些内部字段，特别是 Enum`.values()`数组的大小，不会改变。见[问题讨论](https://github.com/MinecraftForge/MinecraftForge/issues/3885)。推荐的解决方案是不要`.values()`为优化器创建热点。因此，如果在运行时添加到 Enum 的成员，则应仅在应用程序初始化时才执行一次，然后`.values()`应缓存结果以避免使其成为热点。

优化器的工作方式和它检测热点的方式是模糊的，并且可能在不同的 JVM 和 JVM 的不同构建之间有所不同。如果您不想在生产代码中冒此类问题的风险，请不要在运行时更改 Enums。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-25T23:41:05.837

您可以尝试将属性分配给您尝试创建的 ENUM，并使用加载的属性文件静态构造它。大黑客，但它的工作原理:)

# sql - 使用“相关”子查询进行高效连接

> ID：478410
> 
> 赞同：1
> 
> 时间：2009-01-25T22:13:38.493
> 
> 标签：sql, oracle

给定 Oracle 中的三个表 Dates(date aDate, doUse boolean), Days(rangeId int, day int, qty int) 和 Range(rangeId int, startDate date)

我想加入这些，以便 Range 与来自 aDate = startDate 的日期相结合，其中 doUse = 1 天数中的每一天。

给定一个范围，它可能会做这样的事情

```
SELECT rangeId, aDate, CASE WHEN doUse = 1 THEN qty ELSE 0 END AS qty
FROM (
    SELECT aDate, doUse, SUM(doUse) OVER (ORDER BY aDate) day
    FROM Dates 
    WHERE aDate >= :startDAte
) INNER JOIN (
    SELECT rangeId, day,qty
    FROM Days
    WHERE rangeId = :rangeId
) USING (day)
ORDER BY day ASC 
```

我想要做的是查询 Range 中的所有范围，而不仅仅是一个。

问题是连接值“day”取决于要计算的范围 startDate，这给我制定查询带来了一些麻烦。

请记住，日期表非常大，所以我想避免从表中的第一个日期开始计算天值，而每个范围天数不应超过 100 天左右。

编辑：示例数据

```
Dates                            Days
aDate        doUse               rangeId     day     qty
2008-01-01   1                   1           1       1
2008-01-02   1                   1           2       10
2008-01-03   0                   1           3       8
2008-01-04   1                   2           1       2
2008-01-05   1                   2           2       5

Ranges
rangeId      startDate
1            2008-01-02
2            2008-01-03

Result
rangeId      aDate        qty
1            2008-01-02   1
1            2008-01-03   0
1            2008-01-04   10
1            2008-01-05   8
2            2008-01-03   0
2            2008-01-04   2
2            2008-01-05   5 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-25T23:07:08.683

试试这个：

```
SELECT  rt.rangeId, aDate, CASE WHEN doUse = 1 THEN qty ELSE 0 END AS qty
FROM    (
    SELECT  *
    FROM    (
        SELECT  r.*, t.*, SUM(doUse) OVER (PARTITION BY rangeId ORDER BY aDate) AS span
        FROM    (
            SELECT  r.rangeId, startDate, MAX(day) AS dm
            FROM    Range r, Days d
            WHERE   d.rangeid = r.rangeid
            GROUP BY
                r.rangeId, startDate
            ) r, Dates t
        WHERE   t.adate >= startDate
        ORDER BY
            rangeId, t.adate
        )
    WHERE
        span <= dm
    ) rt, Days d
WHERE   d.rangeId = rt.rangeID
    AND d.day = GREATEST(rt.span, 1) 
```

PS 在我看来，将所有这些都保存`Dates`在数据库中的唯一目的是获得一个带有假期标记的连续日历。

您可以使用以下结构在 Oracle 中生成任意长度的日历：

```
SELECT :startDate + ROWNUM
FROM   dual
CONNECT BY
       1 = 1
WHERE  rownum < :length 
```

并且只保留假期`Dates`。一个简单的连接会告诉你哪些`Dates`是假期，哪些不是。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T22:40:28.767

好的，所以也许我找到了一种方法。像这样：

```
SELECT irangeId, aDate + sum(case when doUse = 1 then 0 else 1) over (partionBy rangeId order by aDate) as aDate, qty
FROM Days INNER JOIN (
    select irangeId, startDate + day - 1 as aDate, qty
    from Range inner join Days using (irangeid)
) USING (aDate) 
```

现在我只需要一种方法来填写缺失的日期......

编辑：不，这种方式意味着我会错过最后日期的doUse值......

# networking - 带宽效率最高的单向同步（服务器到多个客户端）

> ID：478420
> 
> 赞同：0
> 
> 时间：2009-01-25T22:21:40.880
> 
> 标签：networking, synchronization, bandwidth

**将数据列表从一台服务器*单向*同步到多个客户端的最有效带宽的方法是什么？**

我有相当大的数据块（可能是 20,000 个 50 字节的记录），我需要通过 Internet 定期同步到一系列客户端（可能是 10,000 个客户端）。*记录只能在服务器端*添加、删除或更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T23:01:27.400

类似于bittorrent的东西？甚至使用bittorrent。或者也许发明一个围绕 bittorrent 的包装器。

（假设您为服务器而不是其他服务器上的带宽付费......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T23:21:12.117

好的，所以我们现在有了一些详细信息 - 每 3 天可能有 10 GB 的总（未压缩）数据，也就是说每月 100 GB。

如今，这实际上并不是一个相当大的数据块。你想节省谁的带宽——你的，还是你客户的？

数据可能很容易压缩吗？对于原始二进制数据，实现 50% 的压缩并不少见，如果数据恰好有很多重复的模式，那么 80%+ 是可能的。

也就是说，如果您确实需要一个可以转移更改的系统，我的想法是：

1.  确保您有一个明确定义的主键字段 - 使用它作为您的键来识别每条记录
2.  为每条记录记录一个时间戳，以说明它上次更改的时间
3.  让每个客户告诉你它知道的最后一次更改的时间戳，这样你就可以计算增量
4.  确保也可以进行完整下载，以防客户端不同步

# c# - 为什么简单数组和 Linq 会生成 VerificationException：操作可能会破坏运行时

> ID：478422
> 
> 赞同：1
> 
> 时间：2009-01-25T22:23:56.210
> 
> 标签：c#, asp.net, linq, linq-to-objects, medium-trust

C# 中的一个非常简单的 ?: 运算符，结合一个简单的数组和对 Reverse() 的 LINQ（对象）调用显然足以导致异常“System.Security.VerificationException：操作可能破坏运行时”。在以“高”信任运行的 ASP.NET 网站上运行时（请注意，“完整”是默认设置）

这是代码，以及我想出的简单解决方法：

```
protected void Page_Load(object sender, EventArgs e) {
    Repro();
    //Workaround();
}

private IEnumerable<string> Repro() {
    bool test = true;
    string[] widgets = new string[0];
    return test ? widgets : widgets.Reverse();
}

private IEnumerable<string> Workaround() {
    bool test = true;
    string[] widgets = new string[0];
    if (test) {
        return widgets;
    } else {
        return widgets.Reverse();
    }
} 
```

要将信任级别设置为“高”，必须将以下内容添加到 web.config 文件中：

```
<trust level="High" originUrl=""/> 
```

解决方法是与有问题的 ?: 重现问题的运算符等效的功能。我从阅读相关文章的猜测是这是一个 C# 编译器错误。有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T23:26:06.773

此行没有问题：

```
return test ? widgets.AsEnumerable() : widgets.Reverse(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T01:33:40.820

我发现改变表达式的顺序也可以解决这个问题：

```
private IEnumerable<string> Workaround() {
    bool test = true;
    string[] widgets = new string[0];
    return !test ? widgets.Reverse() : widgets;
} 
```

去搞清楚！

# artificial-intelligence - 我需要一个人工智能课程的项目创意。你是否有一个？

> ID：478424
> 
> 赞同：8
> 
> 时间：2009-01-25T22:25:08.800
> 
> 标签：artificial-intelligence

我想向 Stack Overflow 用户请教一个项目的好主意，该项目可以在一个学期内招待一位同学程序员。计算机视觉可能看起来很有趣，尽管我不能说该领域的项目是否可以在 4 个月内实现。你怎么看？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-26T02:46:44.620

有一个故事说，在人工智能研究的早期，当通过机械定理证明器在“硬”逻辑问题上取得重大进展时，一位教授给他的一名研究生分配了一个“简单”的问题，即解决视觉如何提供有意义的输入到大脑。显然，事情比教授预想的要困难得多。所以，不，不是一般意义上的*愿景*。

如果你刚开始接触 AI，有几个方向。经典的 AI 问题 - 逻辑谜题 - 使用机械定理证明器（通常用 Lisp 编写 - 请参阅[此处](https://rads.stackoverflow.com/amzn/click/com/0934613311)了解有关解决逻辑谜题的经典文本）来解决。如果您不想创建自己的，可以选择 Prolog 的副本（本质上是一样的）。

您也可以解决[模式识别](https://rads.stackoverflow.com/amzn/click/com/0387310738)问题，尽管您希望将初始问题保持得非常简单，以避免被细节淹没。我的论文涉及在自由浮动空间中使用[随机过程](https://rads.stackoverflow.com/amzn/click/com/158488651X)进行字母识别，所以我有点偏爱这种方法（尽管不要从随机过程开始，除非你真的喜欢数学）。隔壁就是[神经网络](https://rads.stackoverflow.com/amzn/click/com/0198538642)的子领域。这很受欢迎，因为如果不构建一些有趣的项目，您几乎无法学习 NN。在整个领域（模式处理）中，很酷的事情是您可以解决实际问题而不是玩具拼图。

很多人喜欢[自然语言处理](http://www.amazon.com/s/ref=nb_ss_b?url=search-alias%3Dstripbooks&field-keywords=Natural+Language+Processing&x=0&y=0)，因为它很容易上手，但复杂性几乎是无限的。一个非常明确的问题是构建一个用于处理特定领域语言的 NLP 程序（例如，讨论国际象棋游戏）。这使得很容易看到进度，同时仍然足够复杂以填满一个学期。

希望能给你一些想法！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-25T22:28:49.570

大多数人作为 ANN 的第一个应用程序之一实施的主要软件是字符识别（不一定是手写字符）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-25T22:28:41.367

您可以做一些比一般“视觉”更简单的事情，例如将网络摄像头对准数字温度计并从中读取温度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-25T22:28:56.280

如果不了解更多关于您、您的朋友和项目的信息，就无法判断。我的猜测是“不”。

我会向您指出两个来源。首先是彼得·诺维格的[《人工智能》](https://rads.stackoverflow.com/amzn/click/com/0137903952)；第二个是[“编程集体智能”](https://rads.stackoverflow.com/amzn/click/com/0596529325)。也许他们会激励你。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-02-23T05:13:18.540

编写垃圾邮件过滤器。选择一个有趣的语料库进行训练和过滤（Twitter 消息、Facebook 墙贴、博客评论......？）。有很多方法可以构建分类器、识别训练数据等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-26T03:01:02.207

我一直想做的一件事是改进旧视频游戏的 AI。以《毁灭战士》为例。与您今天看到的相比，人工智能非常简单。您可以尝试改进甚至完全重写视频游戏中敌人角色的 AI。

或者，您可以编写自己的小游戏，专门针对计算机做出令人惊讶的明智决策。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-25T22:55:10.237

我一直认为写一些可以查看帖子（例如，这里的问题）并预测它将获得多少票的东西会很有趣。我最初是在查看博客或文章并预测 reddit 上的投票上升/下降（或者更简单地说是像低、中、高这样的桶）的背景下想到这个想法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-25T23:33:30.953

玩扑克、红桃或类似游戏的程序。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-26T01:14:12.233

让它变得有趣，例如一个游戏 AI，我知道一个国际象棋模拟可能需要一段时间，但也许你可以把它简化一下（只有 3 个棋子，每边 2 个车和一个国王）......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-26T02:49:50.560

图灵测试很有趣。这是关于[LOLBot 如何通过图灵测试的链接](http://notnews.today.com/2008/10/13/turing-test-won-with-artificial-stupidity/)

# amazon-web-services - 如果位置！= 美国，则使用 Amazon MechanicalTurk？

> ID：478426
> 
> 赞同：17
> 
> 时间：2009-01-25T22:26:51.727
> 
> 标签：amazon-web-services, amazon, mechanicalturk

[Amazon Mechanical Turk](https://www.mturk.com/mturk/welcome)是一个大规模-微型外包 API，您可以在其中以相对便宜的方式（例如每张图像 0.10 美元）完成大量简单的小任务（例如“这张图片中有商店”）。

亚马逊似乎认为这项服务主要是美国公司感兴趣的。如果您想使用该服务（作为“请求者”），这会导致困难：例如，如果没有美国银行账户，就没有简单的方法为您的账户注资。

有人可以分享在美国以外使用该服务的经验吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-26T01:51:46.090

由于亚马逊[尚未允许美国境外访问](http://aws.amazon.com/mturk/faqs/#Can_international_Requesters_use_Amazon_Mechanical_Turk_to_get_tasks_completed)，因此您需要：

*   等待亚马逊向美国以外的地区开放，可能要等很久。
*   在美国找一个好朋友为你开一个邮政信箱，然后使用美国在线银行创建一个帐户。如果您不创办公司或其他合法企业，他们也需要向亚马逊提供美国驾照。
*   [使用像HIT-Builder](http://www.hit-builder.com/)这样的第三方提供商，他们可以让你使用他们的美国亚马逊账户在 Mechanical Turk 上发帖。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-12T06:44:34.357

我认为他们最近改变了规则——我在澳大利亚，而就在 6 个月前，我还无法使用 Mechanical Turk。最近发生了变化，现在我可以在该服务上发布工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-08T01:55:24.900

您可能想看看[TurkPrime 实验室](https://www.turkprime.com/labs)，它为非美国研究人员提供此服务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-25T22:49:03.977

您遇到的问题是，要真正向您的帐户添加资金，您需要有一个美国帐单地址。如果你能解决这个问题，那么一切都很好。

# ruby - Ruby 中是否提供变量持久性？

> ID：478434
> 
> 赞同：1
> 
> 时间：2009-01-25T22:33:20.967
> 
> 标签：ruby, arrays, memory

在 Matlab 中，我记得能够声明一个数组并对其进行初始化，并且它在整个 Matlab 会话期间驻留在内存中。我可以复制、修改它并通过测试运行它。这个选项在 Ruby 中可用吗？基本上，我想创建并填充一个由 1200 万个 32 位整数组成的数组。然后我想运行访问该内存的代码。我不想每次调整/调试我的 ruby​​ 代码时都重新初始化该数组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-25T22:43:28.030

如果您使用的是交互式 ruby​​ 控制台（irb），那么您可以声明一个包含您的数据的全局变量。

$my_data = [1,2,3,4,5,6.....12000000]

然后在您选择的文本编辑器中处理您的代码并要求它进入您的 irb 会话。这会让你按照你想要的方式工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-25T23:00:54.640

全局变量是一种方式，但我会说有点麻烦。

这意味着您需要对象的持久性，因为您希望它在代码修改中可用。然后，您需要初始化数据并将其保存在文件中。您有多种可能性，例如[YAML](http://www.yaml.org/) / [JSON](http://json.org/)，或者以二进制但更有效的方式[Marshalling](http://www.ruby-doc.org/core-1.8.7/classes/Marshal.html)。

如果你有一个数据结构，你可以用这个将它保存在 YAML 中

```
require "yaml"

foo = SomeObject.new
File.open("bar.yaml", "w") do |fh|
  YAML.dump(foo, fh)
end 
```

JSON 几乎相同。使用 Marshal.dump 是等效的。

然后你可以在你的代码中有一个读取数据的方法。

```
File.open(fname) do |fh|
  foo = YAML.load(fh)
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T08:24:46.857

我假设对于会话，您的意思是一个开放的 irb（交互式红宝石），但这个建议不限于此。

首先要做的是初始化数据。将数据存储为全局变量还是作为参数传递的本地变量并不重要，因为 ruby​​ 将参数作为引用传递。当您更改处理数据的代码时，您应该使用“load”语句而不是“require”，因为 load 会强制 ruby​​ 再次解析文件。

例如，假设您已在 irb 中初始化数据

```
> data = (1..120).to_a
=> [1, 2, ...] 
```

（请注意，irb 将数组打印到 shell，因此初始化一个大数组会为您提供在屏幕上运行的大量数字。）您的代码在名为 loadable.rb 的文件中使用该数据

```
def some_number(data)
  data[100]
end 
```

现在您可以将该文件加载到 irb 并调用该函数。

```
> require 'loadable'
=> true
> some_number(data)
=> 101 
```

当您将 loadable.rb 中的代码更改为（比如说）返回条目 10 而不是 100，重新加载文件并再次调用该函数时，您将得到不同的 require 和 load 结果。

```
> require 'loadable'
=> false
> some_number(data)
=> 101 
```

使用 require，您会得到旧的（错误的）结果。

```
> load 'loadable.rb'
=> true
> some_number(data)
=> 11 
```

通过负载，您可以获得所需的结果。请注意，您需要使用完整的文件名调用 load，包括“.rb”。

即使没有 irb，您也可以做到这一点，方法是使用一个 ruby​​ 程序来初始化数据，然后在循环中等待其他文件的更改，再次加载它们并调用它们的函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T08:40:57.090

只需创建一个数组并引用它。就那么简单。您应该如何以及在何处创建此数组取决于您的代码。我想说一个常量最有意义，因为数组是常量，而不是变量。

```
THE_ARRAY = [] 
```

将数字添加到`THE_ARRAY`，然后使用它。`THE_ARRAY`是一个指针，所以当你调用它时，Ruby 每次都会从同一个内存位置获取同一个数组。

# objective-c - 如何将 TabBar + Navigation 与 XCode 结合使用

> ID：478448
> 
> 赞同：10
> 
> 时间：2009-01-25T22:43:03.613
> 
> 标签：objective-c, iphone

我正在尝试结合 TabBar + Navigation 应用程序。

我有 5 个标签栏，4 个是内容列表，并深入到详细信息视图。

我尝试遵循本教程：

[http://www.iphonedevforums.com/forum/iphone-sdk-development/124-view-controller-problem.html](http://www.iphonedevforums.com/forum/iphone-sdk-development/124-view-controller-problem.html)

但总是得到一个空白的视图。

这就是我所做的，一个干净的项目：

*   我从一个 TabBar 模板应用程序开始。
*   我放了 5 个标签栏按钮。
*   我创建了一个控制器，例如：

    @interface FirstViewController : UINavigationController {

    }

*   我将主 window.xib 置于树模式并将选定的第一个视图更改为`FirstViewController`
*   我在界面生成器中选择 TabBar 控制器，转到 TabBar 属性并将类更改为导航控制器。
*   选择第一个视图并输入笔尖名称“SecondView”

作为回应，我得到一个空白屏幕。

我必须补充一点，我想从详细信息视图导航，而不是从主窗口导航。

即在主窗口标签栏 1 是人员列表。我选择了一个人，然后想要导航到详细信息窗口。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-09T14:02:47.897

首先，你永远不想继承 UINavigationController 或 UITabBarController。

其次，我不太明白你做了什么，但是在标签栏控制器中创建导航控制器的正确顺序是这样的：

```
// in MyAppDelegate.h
UINavigationController *nc1, *nc2;
FirstTabRootViewController *vc1;
SecondTabRootViewController *vc2;
UITabBarController *tbc;

// in MyAppDelegate.m
nc1 = [[UINavigationController alloc] init];
vc1 = [[FirstTabRootViewController alloc] initWithNibName:nil bundle:nil];
vc1.tabBarItem.title = @"Tab 1";
vc1.tabBarItem.image = [UIImage imageNamed:@"tab1.png"];
vc1.navigationItem.title = "Tab 1 Data";
nc1.viewControllers = [NSArray arrayWithObjects:vc1, nil];

nc2 = [[UINavigationController alloc] init];
vc2 = [[SecondTabRootViewController alloc] initWithNibName:nil bundle:nil];
vc2.tabBarItem.title = @"Tab 2";
vc2.tabBarItem.image = [UIImage imageNamed:@"tab2.png"];
vc2.navigationItem.title = "Tab 2 Data";
nc2.viewControllers = [NSArray arrayWithObjects:vc2, nil];

tbc = [[UITabBarController alloc] init];
tbc.viewControllers = [NSArray arrayWithObjects:nc1, nc2, nil]; 
```

请注意，控制标签栏和导航栏中的文本/图标的是您的视图控制器。为每个选项卡创建一个 UINavigationController 实例；UINavigationController 包含一堆视图控制器（请参阅 viewControllers 属性），其中至少应包含一个项目——该选项卡的根控制器。还要创建一个 UITabBarController 来管理选项卡。

当然，您可以（并且可能应该）使用接口构建器而不是代码来实例化提到的类并设置属性。但重要的是您要了解幕后发生的事情；界面生成器只不过是一种实例化和设置对象的便捷方式。

希望这会有所帮助；如果不是，请完善您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-04T07:02:47.680

执行上述代码后，在启动应用程序时仍然出现空白屏幕。我在哪里写错了。

```
 nc1 = [[UINavigationController alloc] init];
  nc2 = [[UINavigationController alloc] init];
  vc1 = [[FirstRootViewController alloc]initWithNibName:@"FirstRootViewController" bundle:nil];
  vc1.tabBarItem.title = @"Item 1";
  vc1.tabBarItem.image= [UIImage imageNamed:@"home.png"];
  vc1.navigationItem.title = @"Tab1 Data";
  nc1.viewControllers = [NSArray arrayWithObjects:vc1,nil];
  vc2 = [[SecondRootViewController alloc]initWithNibName:@"SecondRootViewController" bundle:nil];
  vc2.tabBarItem.title = @"Item 2";
  vc2.tabBarItem.image= [UIImage imageNamed:@"home.png"];
  vc2.navigationItem.title = @"Tab2 Data";
  nc2.viewControllers = [NSArray arrayWithObjects:vc2,nil];
  tbc = [[UITabBarController alloc]init];
  tbc.viewControllers = [NSArray arrayWithObjects:nc1,nc2,nil];
  [window addSubview:tbc.view];
  [window makeKeyAndVisible]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T19:57:43.173

这是我能够开始工作的[教程。](http://twilloapp.blogspot.com/2009/03/how-to-embed-navigation-controller.html)

我还阅读了有关该主题的官方 SDK 文档： [Combining Tab Bar and Navigation Controllers](http://developer.apple.com/iphone/library/featuredarticles/ViewControllerPGforiPhoneOS/CombiningToolbarandNavigationControllers/CombiningToolbarandNavigationControllers.html#//apple_ref/doc/uid/TP40007457-CH8-SW1)。由于我仍在学习，因此本教程对我的帮助超过了文档。

注意：在本教程中，我认为您不需要继承 UINavigationController，我现在正在尝试这个想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-07T13:28:20.760

我试图用 UITabBarController 和一些 UINavigationController 创建一个 iphone 应用程序，并面临与“mamcx”相同的问题。使用您的示例代码，我可以运行它:) 非常感谢。

这是它对我的工作方式。

```
// YOURS
fourthNavigation = [[UINavigationController alloc ] init ];
fourthViewController = [[[FourthTabRootController alloc] initWithNibName:@"FourthView" bundle:nil] autorelease];
fourthNavigation.tabBarItem.title = @"YOURS";
fourthNavigation.viewControllers = [NSArray arrayWithObjects:fourthViewController, nil];

// Add self-defined UIViewControllers to the tab bar
tabBarController.viewControllers = [NSArray arrayWithObjects:firstNavigation,secondNavigation, thirdNavigation, fourthNavigation, nil];
// Add the tab bar controller's current view as a subview of the window
[window addSubview:tabBarController.view]; 
```

其他 UINavigationControllers “firstNavigation, ...”的创建方式相同。我从连接到我的子类 UIViewController 类的 nib 文件中加载视图元素。您不需要在 IB 中将 NavigationBar 添加到您的视图中，因为 UINavigationController 已经准备好了。所以你只需要在“initWithNibName”中设置标题

```
 // The designated initializer. Override to perform setup that is required before the view is loaded.
  - (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
if (self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil]) {
    // Custom initialization
    self.title = @"YOURS";
}
return self;
} 
```

我希望这会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-25T11:19:46.453

[查看适用于 iOS 的 View Controller Catalog](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/Introduction/Introduction.html)下的“将导航控制器添加到选项卡栏界面”，它将带您逐步了解如何实现这一点

# string - 如何在 Pascal 中使用字符串集？

> ID：478454
> 
> 赞同：1
> 
> 时间：2009-01-25T22:47:41.577
> 
> 标签：string, set, pascal

我正在编写一个小游戏，在其中询问用户的种族和班级。string[5] 有五种可能的种族和 string[9] 的四种可能类别。

我如何将 pascal 编程为 1\. 将五个种族和四个类定义为常量， 2\. 检查用户输入以查看输入是否在可能的种族和类中 - 不使用多个 IF 语句？

任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T20:55:47.137

我会推荐 Steves 解决方案作为起点，但使用枚举类型和集合更进一步......

```
type
    TRace = (rcRace0, rcRace1, rcRace2, rcRace3, rcRace4);

    TCharacterClass = (ccClass0, ccClass1, ccClass2, ccClass3);

    TCharacterClassSet = set of TCharacterClass;

const
    validCombinations : array[TRace] of TCharacterClassSet = (
        [ccClass0, ccClass1, ccClass2, ccClass3],  // race0 can be any class
        [ccClass0, ccClass2],                      // race1 
        [ccClass0, ccClass1, ccClass2],            // race2
        [ccClass0, ccClass3],                      // race3
        [ccClass0]                                 // race4
        ); 
```

您还可以为比赛名称和字符类设置常量：

```
const
    raceNames : array[TRace] of string = (
        'Race 0',
        'Race 1',
        'Race 2',
        'Race 3',
        'Race 4'
        );

    characterClassNames = array[TCharacterClass] of string = (
        'Class 0',
        'Class 1 ',
        'Class 2',
        'Class 3'
        ); 
```

现在，如果您使用组合框进行用户输入并将输入映射到这些枚举类型，则检查组合是否有效很简单：

```
function ValidRaceAndClass( aRace : TRace; aClass : TCharacterClass ) : Boolean;
    begin
    result := aClass in validCombinations[ aRace ];
    end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-25T23:09:44.857

由于您的输入是严格定义的，我的第一个问题是，您必须使用字符串作为用户输入吗？不能不给用户选择吗？说下拉？然后，您可以将每个选择映射到一个枚举。

```
type
  race = (rcRace0, rcRace1, rcRace2 rcRace3, rcRace4);

case race(Input) of  //input is an integer, index of the drop down list for example
  rcRace0 : //perform processing for race 0
  rcRace1 : //perform processing for race 1
  rcRace2 : //perform processing for race 2
  rcRace3 : //perform processing for race 3
  rcRace4 : //perform processing for race 4
end; 
```

上课也一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T12:39:28.360

我发现你应该遵循史蒂夫的解决方案。但是，如果使用字符串是您的方式，您可以使用 TStringList（在 Delphi/可能是 FreePascal 中）。您可以用您的比赛填充它，然后使用 TStringList 的 IndexOf 函数评估玩家的答案。它返回传递的字符串的索引，或者当传递的字符串不在列表中时返回 -1。

无论如何，我强烈推荐史蒂夫的解决方案:)

# security - 需要保护基于 JMS 的服务器进程和数据库的想法

> ID：478455
> 
> 赞同：0
> 
> 时间：2009-01-25T22:47:52.387
> 
> 标签：security, jms

我有一个作为 Eclipse 插件免费分发的工具，这意味着我无法跟踪谁使用它或要求他们注册。

每个客户端工具都通过 JMS 代理与单个共享服务器进程（用 Java 编写）进行通信，并且可以接收消息作为回复。服务器通过 Hibernate 连接到 MySQL 数据库。

目前，该工具发送的唯一消息是数据请求，服务器获取该消息并将表示元素的大量 XML 数据发送给客户端，客户端在 IDE 中显示相应的项目。因此，我认为除了 DoS 攻击之外，对服务器没有什么可做的。

但是，现在我想添加以下功能：用户可以为特定元素（由数字 id 标识）分配评级，并且将向服务器发送一条消息，该服务器会将评级作为事件存储在评级中事件表。当下一个数据请求进入时，每个项目的平均评分将与请求一起发送。

**我的问题是我从未部署过使用这样的公共服务器的工具，即使它被 JMS 代理隐藏了。可以针对我部署哪些攻击，我该如何防御它们？**

存在 DoS 问题，我不知道如何解决。

有注入的可能性，但是我所有的数据都是数字的，我不知道hibernate是如何处理事情的。

存在垃圾邮件或虚拟投票的问题，我真的想不出如何解决这个问题。

我确定还有其他人...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T01:05:47.493

关于虚拟投票，这是不安全的（即它不能用于选举目的！）但它是一个简单的机制：

在服务器上创建一个 GUID，将其存储在适当的表中并发送给客户端。当客户端投票时，它会发回与数据库进行比较的 GUID。如果 GUID 有效，则接受投票并删除 DB 存储的 GUID。

# python - 超过 100 个组的 Python 正则表达式？

> ID：478458
> 
> 赞同：22
> 
> 时间：2009-01-25T22:48:56.240
> 
> 标签：python, regex

有什么办法可以超过 Python 中正则表达式的 100 组限制？另外，有人可以解释为什么有限制。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-25T22:54:05.230

有一个限制，因为要有效地存储完整的状态机需要太多内存。我想说，如果您的 re 中有超过 100 个组，那么 re 本身或您使用它们的方式都有问题。也许您需要拆分输入并处理较小的块或其他东西。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-18T02:37:06.130

我发现最简单的方法是

```
import regex as re 
```

代替

```
import re 
```

正则表达式的默认 _MAXCACHE 是 500 而不是 100 我相信。这是我发现 regex 是比 re 更好的模块的众多原因之一。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-29T11:53:10.470

如果我没记错的话，“新”[正则表达式](http://pypi.python.org/pypi/regex/)模块（目前是第三方，但打算最终替换 stdlib 中的 re 模块）没有这个限制，所以你可以试一试。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-12-02T15:17:13.523

我怀疑您是否真的需要通过下一个命令处理 100 个命名组或在`regexp`替换命令中使用它。这将是非常不切实际的。如果您只需要组来表达丰富的条件，`regexp`您可以使用非分组组。

```
(?:word1|word2)(?:word3|word4) 
```

等复杂的场景，包括嵌套组是可能的。非分组组没​​有限制。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-26T21:58:27.057

我不确定您到底在做什么，但请尝试使用单个组，其中包含很多 OR 子句......所以 (this)|(that) 变为 (this|that)。您可以通过传递一个对匹配的特定单词执行某些操作的函数来对结果进行巧妙的处理：

```
 newContents, num = cregex.subn(lambda m: replacements[m.string[m.start():m.end()]], contents) 
```

如果你真的需要这么多组，你可能必须分阶段进行……一次传递十几个大组，然后在每个组中再传递一次，以获得你想要的所有细节。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-26T04:38:53.803

首先，正如其他人所说，使用 100 个组可能有很好的替代方案。该`re.findall`方法可能是一个有用的起点。如果你真的需要超过 100 个组，我看到的唯一解决方法是修改核心 Python 代码。

只需通过删除以下行`[python-install-dir]/lib/sre_compile.py`来修改函数：`compile()`

```
# in lib/sre_compile.py
if pattern.groups > 100:
    raise AssertionError(
        "sorry, but this version only supports 100 named groups"
        ) 
```

对于更灵活的版本，只需在`sre_compile`模块顶部定义一个常量，并将上面的行与该常量而不是 100 进行比较。

有趣的是，在 (Python 2.5) 源代码中，有一条注释表明 100 个组的限制计划在未来的版本中被删除。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-05-15T11:56:16.550

我发现 Python 3 没有这个限制，而在最新的 2.7 中运行的相同代码显示了这个错误。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-23T05:45:39.520

当我遇到这个问题时，我有一个非常复杂的模式，它实际上由一堆由 OR 连接的高级模式组成，如下所示：

```
pattern_string = u"pattern1|" \
    u"pattern2|" \
    u"patternN"
pattern = re.compile(pattern_string, re.UNICODE)

for match in pattern.finditer(string_to_search):
    pass # Extract data from the groups in the match. 
```

作为一种解决方法，我将模式转换为一个列表，并按如下方式使用该列表：

```
pattern_strings = [
    u"pattern1",
    u"pattern2",
    u"patternN",
]
patterns = [re.compile(pattern_string, re.UNICODE) for pattern_string in pattern_strings]

for pattern in patterns:
    for match in pattern.finditer(string_to_search):
        pass # Extract data from the groups in the match.
    string_to_search = pattern.sub(u"", string_to_search) 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-01-25T23:07:02.817

我会说你可以通过使用非分组括号来减少组的数量，但无论你在做什么，似乎你都想要所有这些分组。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2010-05-25T23:15:50.057

就我而言，我有一个包含 n 个单词的字典，并且想要创建一个匹配所有单词的单个正则表达式。即：如果我的字典是

```
hello
goodbye 
```

我的正则表达式是：`(^|\s)hello($|\s)|(^|\s)goodbye($|\s)`......这是唯一的方法，并且在小型词典上运行良好，但是当你有更多的 50 个单词时，嗯......

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2012-11-19T16:49:41.067

解决这个错误很容易：打开`re`类，你会看到这个常量`_MAXCACHE = 100`。`1000`例如，将值更改为 并进行测试。

# separation-of-concerns - 应用关注点分离

> ID：478469
> 
> 赞同：1
> 
> 时间：2009-01-25T22:53:49.177
> 
> 标签：separation-of-concerns

我想知道你是否认为有必要重构这个类。（关于关注点分离）

```
publi class CSVLIstMapping<T>
{
 void ReadMappingFromAttirbutes();
 void GetDataFromList();
} 
```

ReadMappingFromAttributes - 从类型 T 读取映射并将其存储在类中。有一个要使用的列表的名称和一些 csvMappingColumns，其中包含要设置值的属性的名称和 csvcolumns 的名称。

GetObjectsFromList - 使用 CVSListreader（通过构造函数传入）从所有行获取数据作为 KeyValuePair（Key = csvcolumnName，value = 实际上值），然后使用映射信息（listname 和 csvMappingColumns）将数据设置为物体。

我不能决定这门课是有两个问题还是一个问题。首先我觉得它有两个，并开始重构从行到对象到另一个对象的转换。但在此之后使用该功能感觉很尴尬，因为我首先必须创建一个映射检索器，然后我必须检索行并将其与映射一起传递给“映射器”以从行转换对象

/w

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T23:09:33.077

听起来对我来说有两个问题：解析和映射/绑定。我会把它们分开。CSV 解析应该是一个定义明确的问题。你应该关心的不仅仅是映射。验证呢？如果您解析日期字符串，您不想在将其绑定到对象属性之前确保它有效吗？我觉得你应该。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T23:11:18.673

经验法则：如果它很尴尬，那就错了。

我不得不说我很难理解你在那里写的东西，但我认为你可能需要重构这个类：名称似乎不清楚，任何调用的方法`GetFoo()`都不应该返回 void，它可能可能整个 ReadMappingFromAttribute 应该只是构造函数逻辑。

# sql - SQL全文搜索与“LIKE”

> ID：478472
> 
> 赞同：30
> 
> 时间：2009-01-25T22:56:59.967
> 
> 标签：sql, database, full-text-search

假设我有一个相当简单的应用程序，它允许用户在他们拥有的 DVD 上存储信息（标题、演员、年份、描述等），我希望允许用户通过这些字段中的任何一个搜索他们的收藏（例如“Keanu Reeves”或“矩阵”将是有效的搜索查询）。

使用 SQL 全文搜索与简单地将查询按空格分开并在 SQL 语句中执行一些“LIKE”子句有什么优势？它只是表现得更好，还是实际上会返回更准确的结果？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-25T23:03:50.343

全文搜索可能会更快，因为它将受益于用于查找记录的单词索引，而使用 LIKE 则需要进行全表扫描。

在某些情况下，LIKE 会更准确，因为 LIKE "%The%" AND LIKE "%Matrix" 会选择 "The Matrix" 而不是 "Matrix Reloaded"，而全文搜索将忽略 "The" 并返回两者。也就是说，两者都可能是一个更好的结果。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-25T23:06:43.973

全文索引（即索引）比使用 LIKE（基本上每次都检查每一行）要快得多。但是，如果您知道数据库会很小，则可能没有性能需要使用全文索引。确定这一点的唯一方法是进行一些智能平均和基于该信息的一些测试。

准确性是一个不同的问题。全文索引允许你做几件事（加权、自动匹配吃/吃/吃等），你不可能在任何合理的时间范围内使用 LIKE 实现它。真正的问题是您是否需要这些功能。

如果不阅读全文文档对这些功能的描述，您真的不知道应该如何进行。所以，请阅读！

此外，一些基本测试（在表中插入一堆行，可能使用某种公共字典作为单词来源）将大大有助于您做出决定。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-10-28T12:38:47.990

全文搜索查询要快得多。特别是在处理不同列中的大量数据时。

此外，您将获得特定语言的搜索支持。例如，当存储为“ueber”时，也会发现像“über”中的“ü”这样的德语变音符号。您还可以使用同义词来自动扩展搜索查询，或者替换或替换特定短语。

> 在某些情况下，LIKE 会更准确，因为 LIKE "%The%" AND LIKE "%Matrix" 会选择 "The Matrix" 而不是 "Matrix Reloaded"，而全文搜索将忽略 "The" 并返回两者。也就是说，两者都可能是一个更好的结果。

这是不正确的。全文搜索语法允许您指定搜索的“方式”。例如，通过使用[CONTAINS](http://msdn.microsoft.com/en-us/library/ms187787.aspx)语句，您可以使用精确术语匹配以及模糊匹配、权重等。

因此，如果您有性能问题或想提供更“类似于 Google”的搜索体验，请选择全文搜索引擎。它也很容易配置。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-07-15T16:23:42.240

只是一些注意事项：

1.  如果您的 LIKE 不以 % 开头，LIKE 可以使用 Index Seek。示例：LIKE 'Santa M%' 很好！LIKE '%Maria' 不好！并且可能导致表或索引扫描，因为这不能以标准方式索引。

2.  这个非常重要。全文索引更新是异步的。例如，如果您在一个表上执行 INSERT，然后执行带有全文搜索的 SELECT，您希望新数据出现在该处，您可能不会立即获得数据。根据您的配置，您可能需要等待几秒钟或一天。通常，当您的系统没有很多请求时，会填充全文索引。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-25T23:03:31.187

它会表现得更好，但除非你有很多数据，否则你不会注意到这种差异。SQL 全文搜索索引允许您使用比简单的“LIKE”操作更高级的运算符，但如果您所做的只是对全文索引执行 LIKE 操作，那么您的结果将是相同的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-25T23:05:10.247

想象一下，如果您允许在 DVD 上输入注释/描述。在这种情况下，最好允许按描述进行搜索。在这种情况下，全文搜索会做得更好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-25T23:08:12.160

您可能会得到稍微好一点的结果，或者至少可以更轻松地实现全文索引。但这取决于您希望它如何工作...

我想到的是，如果您正在搜索两个单词，那么您必须使用 LIKE 手动实现（例如）一种方法来加权列表中较高的单词。全文索引应该为您执行此操作，并允许您使用相关语法来影响权重。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-12-20T14:07:03.733

首先，`FullTextSearch`在 SQL Server 中`LIKE`
，您必须创建一个`StopList`并将其分配给您的表

```
CREATE FULLTEXT STOPLIST [MyStopList];
GO
ALTER FULLTEXT INDEX ON dbo.[MyTableName] SET STOPLIST [MyStopList]
GO 
```

其次，使用以下 tSql 脚本：

```
SELECT * FROM dbo.[MyTableName] AS mt
WHERE CONTAINS((mt.ColumnName1,mt.ColumnName2,mt.ColumnName3), N'"*search text s*"') 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-04-21T04:35:38.787

If you do not just search English word, say you search a Chinese word, then how your fts tokenizes words will make your search a big different, as I gave an example here [https://stackoverflow.com/a/31396975/301513](https://stackoverflow.com/a/31396975/301513). But I don't know how sql server tokenizes Chinese words, does it do a good job for that?

# c# - C#浮动错误？0.1 - 0.1 = 1.490116E-08

> ID：478474
> 
> 赞同：0
> 
> 时间：2009-01-25T23:01:25.497
> 
> 标签：c#, floating-point

这是怎么回事？！减法工作正常，直到我达到 0.1 - 0.1。我在 Visual c# 2008 中使用 nonoba.com API。

```
Console.WriteLine("hit! " + Users[targetNum].character.health + " : " + player.character.profile.attackPower);

Users[targetNum].character.health -= player.character.profile.attackPower;

Console.WriteLine("health! " + Users[targetNum].character.health); 
```

输出：

```
hit! 0.1 : 0.1
health! 1.490116E-08 
```

谢谢大家 - 我可能会使用小数类型，因为我通常会添加/减去漂亮的“圆形”数字。现在我会选择：

```
if (Users[targetNum].character.health <= 0.00001) 
```

顺便说一句，我知道这实际上不会成为 c# 中的“错误”——我认为它可能是由于我的代码中的错误或缺乏理解，事实确实如此。

阅读完所有推荐读物后，我将得出结论，我的愚蠢是由于通常使用 ActionScript Number 类型，它可能具有十进制而不是二进制浮点 - 无论如何，它永远不会给出此输出。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-25T23:02:53.560

这对于浮点数学来说似乎很正常......你总是必须检查一个小的增量来解释难以察觉的舍入差异。根据场景，`decimal`可能是您想要的。

基本上，除非你能确定在这两种情况下它是**完全相同**的 0.1（即没有对它们做任何事情），你不可能得到零。一般来说，你会得到几乎为零的东西。有了`decimal`你，你通常会直观地得到更多你期望的东西。

另请参阅 Jon Skeet 的页面：

*   [二进制浮点](http://csharpindepth.com/Articles/General/FloatingPoint.aspx)
*   [十进制浮点数](http://csharpindepth.com/Articles/General/Decimal.aspx)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-25T23:11:14.040

您显然需要阅读[“每个计算机科学家应该知道的关于浮点数的知识”](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)。

我通常不会认为我在这种情况下发现了错误，而是假设我的一个假设需要首先检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T23:48:51.220

如果您总是添加和减去“漂亮的整数”数字，即十分之一或百分之一，那么您可以以整数十分之一为单位跟踪您的命中和健康值。一个类比是一个金融程序，它以整数美分而不是浮点美元来跟踪货币。使用整数避免了浮点数学的所有问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-25T23:12:44.960

浮点数学在任何语言中总是近似的，因为这就是 CPU 的工作方式。如果你关心你的答案的绝对精度——例如，因为你正在处理金钱——那么你不应该使用浮点数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-08T13:19:57.447

有点离题，但这是一个有趣的读物，描述了为什么`cos(x) != cos(y)`即使`x == y`：

[http://www.parashift.com/c++-faq-lite/newbie.html#faq-29.18](http://www.parashift.com/c++-faq-lite/newbie.html#faq-29.18)

# c# - C# OpenFileDialog 非模态可能

> ID：478476
> 
> 赞同：7
> 
> 时间：2009-01-25T23:02:10.160
> 
> 标签：c#, modal-dialog, openfiledialog

是否可以创建/拥有一个非模态的 .net OpenFileDialog 我在主对话框中有一个 UI 元素，它总是需要用户按下。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-25T23:15:25.373

不，[OpenFileDialog](http://msdn.microsoft.com/en-us/library/system.windows.forms.openfiledialog.aspx)和[SaveFileDialog](http://msdn.microsoft.com/en-us/library/system.windows.forms.savefiledialog.aspx)都是从[FileDialog](http://msdn.microsoft.com/en-us/library/system.windows.forms.filedialog.aspx)派生的，它本质上是模态的，所以（据我所知）没有办法创建它们中的任何一个的非模态版本。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-07-23T21:33:39.513

您可以创建一个线程并让该线程托管 OpenFileDialog。示例代码缺少任何类型的同步，但它可以工作。

```
public partial class Form1 : Form
{
    OFDThread ofdThread;

    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        ofdThread = new OFDThread();
        ofdThread.Show();
    }
}

public class OFDThread
{
    private Thread t;
    private DialogResult result;

    public OFDThread()
    {
        t = new Thread(new ParameterizedThreadStart(ShowOFD));
        t.SetApartmentState(ApartmentState.STA);
    }

    public DialogResult DialogResult { get { return this.result; } }

    public void Show()
    {
        t.Start(this);
    }

    private void ShowOFD(object o)
    {
        OpenFileDialog ofd = new OpenFileDialog();
        result = ofd.ShowDialog();
    }
} 
```

使用此代码，您可以添加一些内容以在您的 UI 线程中触发事件（小心调用！）以了解它们何时完成。您可以通过以下方式访问对话框的结果

```
DialogResult a = ofdThread.DialogResult 
```

从您的 UI 线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-22T13:45:21.540

我知道我有点晚了，但您可以创建一个新表单，无边框、透明或超出显示范围，并显示修改该窗口的文件对话框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-28T15:52:18.203

这是一篇旧帖子，但我花了 2 天时间才达到我想在这里展示的结果（带有“上下文”和完整但简化的代码）@Joshua 的答案对我有用（最后当我把 true 设置为 .ConfigureAwait(true) ，请参见第一个代码示例）。也许我可以根据我仍然需要再次阅读的MSDN [Threading Model](https://msdn.microsoft.com/en-us/library/ms741870(v=vs.110).aspx)的长文写更少的行。

我的上下文是 WPF（基本 MVVM），我必须选择一个文件才能编写一些 .CSV 备份（数据网格的）。我需要（成员）函数`ChooseFileFromExtension()`与非阻塞 FileDialog 异步

```
class MainWindowExportToExcelCSV : ICommand
{
    ...
    public async void Execute(object parameter)
    {
        var usr_ctrl = parameter as UserControl;
        MyFileDialog fd = new MyFileDialog();
        const bool WhenIComeBackIStillNeedToAccessUIObjectAndThusINeedToRetrieveMyOriginalUIContext = true;
        string filename = await fd.ChooseFileFromExtension("CSV files (*.csv)|*.csv|All files (*.*)|*.*").ConfigureAwait(
            WhenIComeBackIStillNeedToAccessUIObjectAndThusINeedToRetrieveMyOriginalUIContext);

        Visual visual = (Visual)usr_ctrl.Content;
        for (int i = 0; i < VisualTreeHelper.GetChildrenCount(visual); i++)
        {
            //look for datagrid element
        }
    }
} 
```

和 MyFileDialog 类的代码

```
using Microsoft.Win32;
...

class MyFileDialog
{
    //https://msdn.microsoft.com/en-us/library/ms741870(v=vs.110).aspx
    //Article on Threading Model
    private delegate void OneArgStrDelegate(string str);

    private void MyExternalDialog(string extensions)
    {
        SaveFileDialog fd = new SaveFileDialog();
        fd.Filter = extensions;
        fd.ShowDialog();
        tcs.SetResult(fd.FileName);
    }

    private TaskCompletionSource<string> tcs;

    public Task<string> ChooseFileFromExtension(string file_ext)
    {
        //Cf Puppet Task in Async in C#5.0 by Alex Davies
        tcs = new TaskCompletionSource<string>();

        OneArgStrDelegate fetcher = new OneArgStrDelegate(this.MyExternalDialog);
        fetcher.BeginInvoke(file_ext, null, null);
        return tcs.Task;
    }
} 
```

在另一个线程中`fetcher.BeginInvoke()`（异步）启动`SaveFileDialog` `ShowDialog()`，以便主 UI 线程/窗口（...++）既不会被阻塞也不会被禁用，因为它们本来可以通过简单的直接调用`ShowDialog()`. `TaskCompletionSource<string> tcs`不是 WPF UI 对象，因此可以通过另一个“单个”线程访问它。

这仍然是我需要进一步研究的领域。我觉得没有关于这个主题的“终极”文档/书籍（也许应该再看一下斯蒂芬克利里的书）。至少应使用[c-sharp-asynchronous-call-without-endinvoke 中涵盖的主题来改进此代码](https://stackoverflow.com/questions/7492741)

它适用于命名空间 Microsoft.Win32 的 FileDialog

# c++ - 通过方法接口表达 C++ 参数的用法

> ID：478482
> 
> 赞同：5
> 
> 时间：2009-01-25T23:05:33.693
> 
> 标签：c++, interface, arguments

有没有一种通用的方法来表达 C++ 中参数的用法？我想隐含地告诉我班级的消费者他们传递的参数将如何被班级使用。

例子：

1.  我拥有你的论点（将清理它）
2.  我会在我有生之年参考你的论点（所以你不应该在我还活着的时候删除它）
3.  我只会在构建过程中使用您的论点，并且不会提供参考

有没有一种通用的方法来简单地使用方法声明来表达这些事情？我认为在第一种情况下 std::auto_ptr 是有意义的。在第二种情况下，我通常使用一个指针来避免有人从堆栈中传递一个值，这会使我的引用快速失效，或者是一个 shared_ptr。在第三种情况下，我引用以允许来自堆栈的值。

你如何处理这个问题？这里是否有必要依赖智能指针，或者可以通过某种方式简单地使用裸引用和指针来表达这样的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-25T23:50:43.353

我们的团队与您建议的编码约定类似：

1 - auto_ptr 参数意味着该类将控制对象的内存管理。（我们用的不多。）

2 - shared_ptr 意味着该类可能会长时间使用该参数，特别是可能会将其自己的 shared_ptr 存储到对象中。

3 - 纯引用意味着该参数将仅在调用期间使用。

我们将此视为编码标准。这不是我们为每个电话记录的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-25T23:20:44.240

我不知道是否有一个常见的习惯用法，但我知道我提供此信息的一种可靠方式是在接口标题中添加注释。课程的用户不会总是阅读它们，不会总是记住它们，而且他们会比你眨眼更快地把它们搞砸，但信息会在那里。

现在，话虽如此，我也反对保留对系统其他部分拥有的东西的引用。重组以使您的类拥有所有内容（或在方法调用返回后不保留引用）并不总是实际（或明智），但这是最安全的做事方式，并且任何一种方式都更容易让调用者理解。

保留引用的最大问题是您的调用者永远不会记得他们不允许销毁这些东西，并且您最终会以“使用已删除对象”类型失败而告终。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-25T23:17:17.163

也许我错过了你的问题，但如果你的头文件中的方法原型设置正确，那么就可以了。
“隐式”用户将知道您给定的方法只接受对参数的引用，或者给定的参数是只读的（const）......等等......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-25T23:27:46.583

虽然文档是唯一的答案，但不幸的是它不是一个有用的答案。我一直在做的研究表明，许多客户从未阅读过他们正在使用的方法的文档。

我建议将其放入您的方法名称或参数名称的命名中，因为至少在自动完成窗口中是可见的。这很丑陋，但它可以通过:)

在我自己的工具（用于 Java/Eclipse）中，我有一个标签，允许我在用户需要了解有关参数的重要信息时向用户宣布。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-26T02:07:56.337

我不使用使用 boost 或 STL 的代码，因为我不使用特别支持它们的系统，但我发现以下标准很有用......

我交替使用 const 引用和值参数。（如果值大于寄存器，我使用引用——这只是一种优化。）如果需要，被调用者将按值获取副本，因此可以立即销毁参数。（案例 3。）

我使用 const 指针来指示输入是按引用的，并且被调用者将按引用获取副本。参数的生命周期必须超过被调用者的生命周期。（案例 2。）

我使用非常量指针来指示输入是按引用的，并且如果需要，被调用者将修改指针。在一般情况下，故意未定义参数的寿命。（即案例 2 或 3。）

我自己不使用非常量引用，纯粹是因为在调用点的语法上并不明显，但这只是我个人的倾向。我有我的理由，但这并不意味着其他人必须同意！因此，正如我在 const 案例中所描述的那样，可以有用地使用引用/指针的区别来指示寿命。在这种情况下，也许指针 = 案例 2，引用 = 案例 3。

我通过评论指出案例 1（被调用者取得所有权）；这在我的代码中很少见，我不太担心。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-26T21:07:37.253

我使用以下方法前缀来表示对象所有权。所有权意味着删除的责任。

```
Y.take_ZZZ(x) 
```

调用者将 x 的所有权授予 Y，调用者不得进一步访问 x。（因为 Y 甚至可以立即删除 x）。

```
Y.own_ZZZ(x) 
```

类似于采取；调用者将 x 的所有权授予 Y，但调用者可能会继续引用 x 并期望 Y 不会立即删除 x（至少只要存在 Y 并且假设 Y 将至少存在于调用者知道的整个上下文中）是）。通常 Y 不会删除 x，直到 Y 被销毁（尽管 Y 可能会转移所有权）。

```
Y.know_ZZZ(x) 
```

调用者提供了一个指向 x 的指针/引用（调用者自己可能拥有也可能不拥有 x），但 Y 不拥有 x 的所有权。Y 会期望 x 会一直存在。

```
x = Y.provide_ZZZ() 
```

x 是 Y 拥有的对象。Y 返回对对象的引用 (&)，以便调用者可以“知道”它。对象在需要之前可能最初是空指针，Y 可能在需要之前不会创建对象。无论 x 是否是动态分配的，对调用者都是隐藏的，Y 会做任何需要的事情来返回对要提供的对象实例的引用。只要 Y 存在，x 就会保持实例化。有时我会提供一个相应的方法 Y.done_with_ZZZ(x) 以便调用者可以告诉 Y 它已经完成可以删除 x。

```
x = Y.give_ZZZ() 
```

Y 将 x 让给调用者并且不再引用它。然后调用者将拥有 x 并负责将其删除或将其提供给另一个对象。

```
x = Y.lend_ZZZ() 
```

Y 向调用者提供指向 x 的引用/指针（与 know_ZZZ 相反） Y 保留所有权。（类似于提供，但 Y 不实例化 X，因此它要么有 x 并返回引用（指针），要么没有并返回 null。

```
x = Y.check_out_ZZZ() and Y.check_in_ZZZ(x) 
```

通过结帐，Y 为调用者提供对 x 的独占访问权限，直到调用者将其签入。

```
x = Y.create_ZZZ() 
```

Y 将创建 x 并立即将其交给调用者（工厂函数）。

所有权可以通过使用智能指针进一步加强，但通常我使用这些命名约定而不使用智能指针，除非有更复杂的所有权事务序列，所有权范围不是很本地化，或者对象将被多个对象引用（已知）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-25T23:15:29.993

如果您正在寻找清晰度，文档是处理此问题的一种好方法。当然，这是假设人们关注您的文档。

除了使用具有已知使用模式的现有类之外，您还可以创建自己的类。使用编译器可以从普通参数自动生成的类（当然，使用您将编写的运算符），您可以更准确地指定合同，而不会使传递参数变得更加困难。这有一些缺点（额外的类，更多的层供用户查看和理解，命名职责），但这是一个需要考虑的选项。

如果您处于可以使用 IntelliSense 的环境中，请确保参数描述中包含必要的信息。这可以使您免于任何其他步骤。

# eclipse - 如何在 Eclipse 中使用 ssh 隧道设置颠覆？

> ID：478498
> 
> 赞同：8
> 
> 时间：2009-01-25T23:14:28.137
> 
> 标签：eclipse, svn, ssh, subclipse

我有一个远程服务器，它在非标准 ssh 端口上托管我的 subversion 存储库。我想使用 Eclipse 的 subclipse 插件作为我的客户端来访问 SVN 存储库。我可以使用 svn+specialssh://... 访问存储库，其中 specialssh 是我的 ~/.subversion/config 中的隧道配置文件设置。

在 subclipse 中，我尝试将存储库的 URL 输入为：svn+specialssh:// 但这不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-25T23:32:26.010

首先，我设置了到我的存储库的隧道，该存储库位于我家庭网络的防火墙后面：

```
ssh -L 9000:10.5.128.5:3690 root@<mypublicallyexposedaddress> 
```

10.5.128.5 是我的存储库主机的内部地址。端口 3690 是 svn 监听的地方。

然后在 Eclipse 中，我配置存储库：

```
svn://localhost:9000/gwt 
```

你去吧。这不是唯一的方法。我还使用了一种方法，Eclipse 必须知道它是 ssh，并且插件必须支持它，他们这样做了，但这种方法只是我个人的偏好。

再想一想，你不需要任何复杂的东西。尝试：

```
svn+ssh://host:port/directory 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T11:21:31.867

将 ssh 连接配置添加到您的 ~/.ssh/config 文件中：

```
Host svnserver
    HostName your.real.hostname.here
    Port 1234
    User you 
```

如果您随后在任何 ssh/svn+ssh 配置中指定“svnserver”作为主机名，ssh 应该能够通过简单地读取您的配置文件来解决所有问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-25T23:23:26.530

我以前做的事情是用一个 shell 脚本来包装我对 SSH 的访问，例如：

```
#!ssh1234.sh
ssh -P 1234 $* 
```

我会通过设置`SVN_SSH`环境变量告诉我的 Eclipse svn 插件使用该脚本而不是“ssh”：

```
export SVN_SSH=$HOME/scripts/ssh1234.sh 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-10T18:57:44.100

svn+ssh://host:port/目录

-> 在 Eclipse（flash builder 4.5）之外的 debian 服务器上工作 4 me like charm 感谢 Don Branson

我设置颠覆的方式：

[http://dwaver.files.wordpress.com/2011/08/subversion-notez-v1-0.pdf](http://dwaver.files.wordpress.com/2011/08/subversion-notez-v1-0.pdf)

# delphi - 什么是最好的 GRID 和 TREE 控件？

> ID：478505
> 
> 赞同：4
> 
> 时间：2009-01-25T23:19:29.703
> 
> 标签：delphi

DELPHI win32 最好的 GRID 和 TREE 控件是什么？它也应该是 DB-Aware。我使用过 DBGrid，但它非常有限，并且包含许多新功能 DevExpress 作为令人印象深刻的工具和功能集合，但价格非常高。您选择的 GRID/TREE 是什么，它的优点和缺点，当然还有它的价格标签。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-26T00:18:21.643

您要求最好的并排除第一名；）。

对于树，“最好的”是[http://www.soft-gems.net/index.php?option=com_content&task=view&id=12&Itemid=33](http://www.soft-gems.net/index.php?option=com_content&task=view&id=12&Itemid=33)，因为它是虚拟的，非常灵活且非常快速。但更难使用（即与常规树控件相比）。

这样就可以模拟网格。也是免费的并且有来源。据我所知，它是这个宇宙中所有语言和平台上最好的树控件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-26T09:40:57.407

好吧，我订阅了 DevExpress VCL，虽然初始价格看起来很高，但它物有所值，续订也很合理。网格可以满足您的所有需求（甚至更多），尽管您必须花一些时间学习它，这样您才能了解控制功能的位置。订阅的好处是您可以获得预发布的测试版，并且您可以获得一切，这意味着我已经能够使用我永远不会单独证明的控件，但它们在我的工具包中，所以我可以使用它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-26T07:17:14.730

[TMS Component Pack](http://www.tmssoftware.com/site/tmspack.asp)有很好的 Grid Components 和许多其他的，它是 DevExpress 组件的主要竞争对手

另外，如果您想要一个漂亮、轻便且快速的网格，请查看[NextGrid](http://www.bergsoft.net/component/next-grid/overview.htm)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-26T07:43:53.007

VirtualTreeView 已经在这里提到过。虽然它非常灵活并且我目前正在使用它，但有一些我不喜欢它的地方：

*   它不再由其原作者 Mike Lischke 积极维护，目前尚不清楚是否有其他人负责。
*   它的学习曲线相当陡峭。准备好仔细研究提供的示例应用程序，否则您将无法使用它。它带有在线帮助，但这种帮助甚至比 Delphi 2005 的帮助更差。是的，它确实涵盖了大多数属性、方法和类，但大多数帮助不是很“有用”。（我知道我无权要求免费工具提供良好的在线帮助，但这仍然是一个因素。）
*   我不喜欢虚拟化的实际完成方式。我会做不同的。（不过，我不知道我的方式是否会更好。您的里程可能会有所不同。）
*   感觉塞满了太多的功能。我会喜欢更轻量级的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T03:08:21.613

我在[LMD Innovative的应用程序](http://www.lmdinnovative.com/)[ElTree](http://www.lmdinnovative.com/products/vcl/lmdelpack/desc/screenshots0.php)中使用了将近 10 年。它是他们出色的[ElPack 工具套件的](http://www.lmdinnovative.com/products/vcl/lmdelpack/)一部分。他们最近包含了一个名为[ElXTree](http://www.lmdinnovative.com/products/vcl/lmdelpack/desc/screenshotsn0.php)的版本，其中包含一些附加功能。它们都具有 DB 意识。

不久前我正在考虑切换到 Virtual Treeview。我比较了两者，找不到任何我需要的东西，Virtual Treeview 做了 ElTree 没有。如果您需要，ElTree 也有一个虚拟模式。

ElTree 做的事情与 Virtual Treeview 有点不同。在您决定之前比较两者，或者甚至先尝试它们。您可能会发现自己喜欢一种比另一种更好的工作方式。

ElTree 相对于 Virtual Treeview 的优势：

*   它仍在积极维护中，他们的新闻组有很好的支持。而 Virtual Treeview 现在是开源的，原作者 Mike Lischke 不再积极致力于它。

*   ElPack 已经发布了他们的 Delphi 2009 兼容版本。事实上，他们已经有几个月的时间了。Virtual Treeview 还没有适用于 Delphi 2009 的版本。

ElTree的缺点：

*   它不是免费的，但比 DBGrid 便宜。您可能会发现[其他 ElPack VCL 组件](http://www.lmd.de/mfs/products/lmdelpack.php)（所有 Unicode 启用）也对您的产品有用。

LMD ElPack 7.0 版（适用于 Delphi 2009）是 159 欧元。如果您决定购买，请用欧元支付，因为 ShareIt 收取过高的汇率。

另请参阅[我对 Delphi Active Commercial Components 的回答](https://stackoverflow.com/questions/147795/delphi-active-commercial-components#270943)。

# asp.net-mvc - 有什么方法可以从 LINQ 生成的类成员中获取 size 属性？

> ID：478523
> 
> 赞同：0
> 
> 时间：2009-01-25T23:31:59.100
> 
> 标签：asp.net-mvc, linq

我想避免为所有表单输入元素手动指定 maxlength 属性，而是尽可能使用数据模型中的大小信息：

例如

```
<%= Html.TextBox("Titel", ViewData.Model.Titel, (object)new { @maxlength = "10" })%> 
```

是否有可能“翻译”LINQ 类中的 DbType 属性？

```
[Column(Storage="_Titel", DbType="NVarChar(10)")]
public string Titel 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-25T23:42:51.140

是的，属性可以通过反射获得：

[http://msdn.microsoft.com/en-us/library/aa288454(VS.71).aspx#vcwlkattributestutorialanchor3](http://msdn.microsoft.com/en-us/library/aa288454(VS.71).aspx#vcwlkattributestutorialanchor3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T15:41:41.047

让我带你走上这条路线，希望你能找到剩下的路。我已将数据选择封装到 LINQ 语句中，希望您可以将其换成您需要的数据：

```
var q = from myDatabaseRow in dbContext.TableName
                    select new
                    {
                        myDatabaseRow.FieldName,
                      (ColumnAttribute)TypeDescriptor.GetProperties(myDatabaseRow.GetType())["FieldName"].Attributes[typeof(ColumnAttribute)]

                    }; 
```

这样做是从表中选择一个属性，然后选择一个新的匿名类型。匿名类型中的第二个属性是您在数据模型字段中看到的 ColumnAttribute。然后，您可以使用 .DbType 属性找出最大长度。希望这可以帮助！

# c - 将整数解析为字符串 C

> ID：478528
> 
> 赞同：21
> 
> 时间：2009-01-25T23:38:30.243
> 
> 标签：c, string, parsing, int

如何`string(char* || char[])`在 C 中解析一个整数？在 C 中是否有`Integer.parseInt(String)`与 Java 中的方法等效的方法？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-25T23:41:23.933

如果要将整数转换为字符串，请尝试使用函数`snprintf()`.

如果要将字符串转换为整数，请尝试函数`sscanf()`or`atoi()`或`atol()`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-26T00:11:49.660

要将 int 转换为字符串：

```
int x = -5;
char buffer[50];
sprintf( buffer, "%d", x ); 
```

你也可以为双打：

```
double d = 3.1415;
sprintf( buffer, "%f", d ); 
```

要将字符串转换为 int：

```
int x = atoi("-43"); 
```

有关这些函数的文档，请参阅[http://www.acm.uiuc.edu/webmonkeys/book/c_guide/](http://www.acm.uiuc.edu/webmonkeys/book/c_guide/)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-26T01:34:57.653

听起来你有一个字符串并想将它转换为一个整数，从提到的 来判断`parseInt`，尽管从问题中*不太*清楚......

为此，请使用`strtol`. 这个函数比 稍微复杂一点`atoi`，但作为回报，它提供了更清晰的错误条件指示，因为它可以用第一个字符的地址填充一个指针（调用者提供的）使其混淆。然后调用者可以检查有问题的字符并确定字符串是否有效。`atoi`相比之下，如果它丢失了，它只会返回 0，这并不总是有帮助的——尽管如果你对这种行为感到满意，那么你不妨使用它。

下面的示例使用`strtol`。错误检查非常简单：如果第一个无法识别的字符不是`'\x0'`结束字符串的字符，则认为该字符串不包含有效的 int。

```
int ParseInt(const char *s,int *i)
{
    char *ep;
    long l;

    l=strtol(s,&ep,0);

    if(*ep!=0)
        return 0;

    *i=(int)l;
    return 1;
 } 
```

如果字符串包含一个有效的整数，此函数用整数填充 *i 并返回 1。否则，它返回 0。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-26T01:51:44.840

这在 Steve Summit 的 C 常见问题中进行[了讨论。](http://c-faq.com/lib/itoa.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T23:43:41.793

Java`parseInt()`函数解析字符串以返回整数。等效的 C 函数是`atoi()`. 但是，这似乎与您问题的第一部分不匹配。您想从整数转换为字符串，还是从字符串转换为整数？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-25T23:48:34.077

您还可以查看`atoi()`函数（ascii 到整数）及其亲属，`atol`and`atoll`等。

此外，还有一些函数也可以做相反的事情，即`itoa()`和 co。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T07:01:01.283

您可能想查看[此站点](https://www.securecoding.cert.org/confluence/display/seccode/INT06-C.+Use+strtol()+or+a+related+function+to+convert+a+string+token+to+an+integer "使用 strtol() 或相关函数将字符串标记转换为整数")上的*兼容解决方案*。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-10T19:33:58.467

你可以试试：

```
int intval;
String stringval;
//assign a value to intval here.
stringval = String(intval); 
```

这应该够了吧。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-03-22T07:05:15.657

这不是最佳解决方案。这是我的解决方案，有多个限制，因此如果您的资源有限，根据您的课程/教师指南，这可能非常适合您。

另请注意，这是我自己的项目实现的一小部分，我必须读取操作数和数字，所以我使用了 getchars。否则，如果您只需要整数而不需要其他类型的字符，我喜欢使用这个：

```
int k;
while (scanf("%d", &k) == 1) 
```

这些规则没有特定的“高级”C 概念：没有字符串变量、没有结构、没有指针、没有涵盖的方法，我们被允许的唯一包含是#include

因此，由于没有可用的 atoi() 等简单方法调用或任何可使用的 String 变量，我选择了暴力破解。

1：使用 getchar 读取字符（fgets 被禁止）。如果存在无效字符，则返回 1（退出状态 1）。对于基于 Java 1 11 13 中的 parseInt 的问题是有效的，但 1 11 1a 是无效的，因此对于所有值，如果所有字符都是 0-9 忽略空格，我们都有一个有效的“字符串”。

2：将 char 的 ASCII 值转换为其整数值（例如 48 => 0）

3：使用变量 val 来存储一个 int，这样对于“子字符串”中的每个 char 都有一个对应的整数位。即 "1234" => 1234 将此附加到一个 int 数组并将 val 设置为 0 以供重用。

下面的代码演示了这个算法：

```
int main() {
    int i, c;
    int size = 0;
    int arr[10]; //max number of ints yours may differ
    int val = 0;
    int chars[1200]; //arbitrary size to fit largest "String"
    int len = 0;

    //Part 1: read in valid integer chars from stdin
    while((c = getchar()) != EOF && (c < 58 && c > 47)) {
        chars[len] = c;
        len++;
     }

    //Part 2: Convert atoi manually. concat digits of multi digit integers and  
    //        append to an int[]
    for(i = 0; i < len; i++){
    for(i = 0; i < len; i++){
        if(chars[i] > 47 && chars[i] < 58){
        while((chars[i] > 47 && chars[i] < 58)){
            if(chars[i] == 48)
                c = 0;
            if(chars[i] == 49)
                c = 1;
            if(chars[i] == 50)
                c = 2;
            if(chars[i] == 51)
                c = 3;
            if(chars[i] == 52)
                c = 4;
            if(chars[i] == 53)
                c = 5;
            if(chars[i] == 54)
                c = 6;
            if(chars[i] == 55)
                c = 7;
            if(chars[i] ==56)
                c = 8;
            if(chars[i] == 57)
                 c = 9;
            val = val*10 + c;
            i++;
        }
        arr[size] = val;
        size++;
        if(size > 10) //we have a check to ensure size stays in bounds
           return 1;
        val = 0;
        }
        //Print: We'll make it a clean, organized "toString" representation
        printf("[");
        for(i = 0; i < size-1; i++){
            printf("%d, ", arr[i]); 
        }
        printf("%d]", arr[i];

        return 0; 
```

同样，这是蛮力方法，但在像我这样的情况下，您无法使用人们专业使用的方法概念或各种 C99 工具，这可能就是您正在寻找的。

# c# - 从 C# 调用 F# 代码

> ID：478531
> 
> 赞同：81
> 
> 时间：2009-01-25T23:40:28.913
> 
> 标签：c#, interop, f#

我正在玩 F# 和 C#，并想从 C# 调用 F# 代码。

通过在同一个解决方案中拥有两个项目，并将 C# 代码的引用添加到 F# 项目，我设法让它在 Visual Studio 中以另一种方式工作。完成此操作后，我可以调用 C# 代码，甚至可以在调试时单步执行。

我想要做的是来自 C# 的 F# 代码，而不是来自 F# 的 C# 代码。我在 C# 项目中添加了对 F# 项目的引用，但它没有像以前那样工作。我想知道这是否可以不手动进行。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-01-25T23:54:54.280

下面是从 C# 调用 F# 的工作示例。

正如您所遇到的，我无法通过从“添加参考...项目”选项卡中进行选择来添加参考。相反，我必须手动完成，方法是在“添加引用...浏览”选项卡中浏览到 F# 程序集。

------ F# 模块 -----

```
// First implement a foldl function, with the signature (a->b->a) -> a -> [b] -> a
// Now use your foldl function to implement a map function, with the signature (a->b) -> [a] -> [b]
// Finally use your map function to convert an array of strings to upper case
//
// Test cases are in TestFoldMapUCase.cs
//
// Note: F# provides standard implementations of the fold and map operations, but the 
// exercise here is to build them up from primitive elements...

module FoldMapUCase.Zumbro
#light

let AlwaysTwo =
   2

let rec foldl fn seed vals = 
   match vals with
   | head :: tail -> foldl fn (fn seed head) tail
   | _ -> seed

let map fn vals =
   let gn lst x =
      fn( x ) :: lst
   List.rev (foldl gn [] vals)

let ucase vals =
   map String.uppercase vals 
```

----- 模块的 C# 单元测试 -----

```
// Test cases for FoldMapUCase.fs
//
// For this example, I have written my NUnit test cases in C#.  This requires constructing some F#
// types in order to invoke the F# functions under test.

using System;
using Microsoft.FSharp.Core;
using Microsoft.FSharp.Collections;
using NUnit.Framework;

namespace FoldMapUCase
{
    [TestFixture]
    public class TestFoldMapUCase
    {
        public TestFoldMapUCase()
        {            
        }

        [Test]
        public void CheckAlwaysTwo()
        {
            // simple example to show how to access F# function from C#
            int n = Zumbro.AlwaysTwo;
            Assert.AreEqual(2, n);
        }

        class Helper<T>
        {
            public static List<T> mkList(params T[] ar)
            {
                List<T> foo = List<T>.Nil;
                for (int n = ar.Length - 1; n >= 0; n--)
                    foo = List<T>.Cons(ar[n], foo);
                return foo;
            }
        }

        [Test]
        public void foldl1()
        {
            int seed = 64;
            List<int> values = Helper<int>.mkList( 4, 2, 4 );
            FastFunc<int, FastFunc<int,int>> fn =
                FuncConvert.ToFastFunc( (Converter<int,int,int>) delegate( int a, int b ) { return a/b; } );

            int result = Zumbro.foldl<int, int>( fn, seed, values);
            Assert.AreEqual(2, result);
        }

        [Test]
        public void foldl0()
        {
            string seed = "hi mom";
            List<string> values = Helper<string>.mkList();
            FastFunc<string, FastFunc<string, string>> fn =
                FuncConvert.ToFastFunc((Converter<string, string, string>)delegate(string a, string b) { throw new Exception("should never be invoked"); });

            string result = Zumbro.foldl<string, string>(fn, seed, values);
            Assert.AreEqual(seed, result);
        }

        [Test]
        public void map()
        {
            FastFunc<int, int> fn =
                FuncConvert.ToFastFunc((Converter<int, int>)delegate(int a) { return a*a; });

            List<int> vals = Helper<int>.mkList(1, 2, 3);
            List<int> res = Zumbro.map<int, int>(fn, vals);

            Assert.AreEqual(res.Length, 3);
            Assert.AreEqual(1, res.Head);
            Assert.AreEqual(4, res.Tail.Head);
            Assert.AreEqual(9, res.Tail.Tail.Head);
        }

        [Test]
        public void ucase()
        {
            List<string> vals = Helper<string>.mkList("arnold", "BOB", "crAIg");
            List<string> exp = Helper<string>.mkList( "ARNOLD", "BOB", "CRAIG" );
            List<string> res = Zumbro.ucase(vals);
            Assert.AreEqual(exp.Length, res.Length);
            Assert.AreEqual(exp.Head, res.Head);
            Assert.AreEqual(exp.Tail.Head, res.Tail.Head);
            Assert.AreEqual(exp.Tail.Tail.Head, res.Tail.Tail.Head);
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-26T00:42:24.140

它应该“正常工作”，尽管您可能必须在 C# 的项目到项目引用工作之前构建 F# 项目（我忘记了）。

一个常见的问题来源是命名空间/模块。如果您的 F# 代码不以命名空间声明开头，它会被放入与文件名同名的模块中，因此例如在 C# 中，您的类型可能显示为“Program.Foo”而不仅仅是“Foo”（如果 Foo是 Program.fs 中定义的 F# 类型）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-25T23:49:17.007

从[这个链接](https://web.archive.org/web/20090425153149/http://cs.hubfs.net:80/forums/thread/6967.aspx)他们似乎有许多可能的解决方案，但似乎最简单的一个是评论：

F# 代码：

```
type FCallback = delegate of int*int -> int;;
type FCallback =
  delegate of int * int -> int

let f3 (f:FCallback) a b = f.Invoke(a,b);;
val f3 : FCallback -> int -> int -> int 
```

C#代码：

```
int a = Module1.f3(Module1.f2, 10, 20); // method gets converted to the delegate automatically in C# 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-04-12T15:18:57.383

// 测试.fs :

```
module meGlobal

type meList() = 
    member this.quicksort = function
        | [] -> []  //  if list is empty return list
        | first::rest -> 
            let smaller,larger = List.partition((>=) first) rest
        List.concat[this.quicksort smaller; [first]; this.quicksort larger] 
```

// 测试.cs：

```
List<int> A = new List<int> { 13, 23, 7, 2 };
meGlobal.meList S = new meGlobal.meList();

var cquicksort = Microsoft.FSharp.Core.FSharpFunc<FSharpList<IComparable>,     FSharpList<IComparable>>.ToConverter(S.quicksort);

FSharpList<IComparable> FI = ListModule.OfSeq(A.Cast<IComparable>());
var R = cquicksort(FI); 
```

# sql - 我可以按多列排序并以某种方式保持 MySQL 中列之间的排序相关吗？

> ID：478543
> 
> 赞同：0
> 
> 时间：2009-01-25T23:46:45.593
> 
> 标签：sql, mysql

我知道标题不能很好地解释我的问题（如果有人能想出更好的标题，请编辑它）。这就是我想做的，假设我有下表：

```
id | a  | b  | c 
------------------
1  | 3  | 3  | 3
2  | 20 | 40 | 30
3  | 40 | 30 | 10
4  | 30 | 10 | 15
5  | 10 | 15 | 6
6  | 15 | 6  | 20 
```

这是略微截断的版本，我还有几列要排序，但数据背后的原理和我的问题是一样的。

**我想要的是按以下方式排序数据：**

1.  col a 中值最高的行
2.  col b 中值最高的行
3.  col c 中值最高的行
4.  后面是所有剩余的行，按它们在 col c 中的值排序

因此，结果集如下所示：

```
id | a  | b  | c 
------------------
3  | 40 | 30 | 10
2  | 20 | 40 | 30
6  | 15 | 6  | 20
4  | 30 | 10 | 15
5  | 10 | 15 | 6
1  | 3  | 3  | 3 
```

做一个

```
SELECT id, a, b, c 
FROM table
ORDER BY a DESC, b DESC, c DESC 
```

显然先给了我a，然后是b，最后是c，所以以下**（这不是我需要的）**：

```
id | a  | b  | c 
------------------
3  | 40 | 30 | 10
4  | 30 | 10 | 15
2  | 20 | 40 | 30
6  | 15 | 6  | 20
5  | 10 | 15 | 6
1  | 3  | 3  | 3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T00:03:46.493

我不熟悉 MySQL TSQL 方言，但您必须首先选择具有最高“A”值的行，对具有最高“B”值的行执行 UNION ALL（即没有通过排序区分），执行具有最高“C”值的行的 UNION ALL，然后是 UNION ALL，其余行按“C”排序，不包括已选择的 3 行（按 id）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T01:21:32.717

我刚刚测试了以下似乎可行的方法（但是确实涉及 3 个子查询）：

```
SELECT id, a, b, c
FROM test 
ORDER BY FIELD(a,(SELECT MAX(a) FROM test)) DESC, 
FIELD(b,(SELECT MAX(b) FROM test)) DESC, 
FIELD(c,(SELECT MAX(c) FROM test)) DESC, 
c DESC 
```

# oop - 基本 OCaml OOP 问题

> ID：478546
> 
> 赞同：3
> 
> 时间：2009-01-25T23:47:47.510
> 
> 标签：oop, ocaml

我正在尝试学习 oCaml，但我对以下程序无效的原因有疑问。

```
class myClass2 =
object
 method doSomething = Printf.printf "%s\n" "Doing something"
end;;

class myClass foo =
object
 val dMember = foo
 method doIt = dMember#doSomething
end;;

let mc2 = new myClass2;;
let mc = new myClass mc2;;
mc#doIt;; 
```

我在尝试编译程序时收到的错误是：

```
File "sample.ml", line 6, characters 5-84:
Some type variables are unbound in this type:
  class myClass :
    (< doSomething : 'b; .. > as 'a) ->
    object val dMember : 'a method doIt : 'b end
The method doIt has type 'a where 'a is unbound 
```

我对为什么特别感兴趣：

```
val dMember = foo
method doIt = dMember#doSomething 
```

是无效的。感谢任何（我的意思是*任何）帮助。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-26T05:08:26.537

OCaml 对象的签名中不能有自由类型变量。由于`foo`未完全指定参数的类型，因此您需要`myClass`通过`foo`.

```
class ['a] myClass foo =
object
 val dMember = foo
 method doIt : 'a = dMember#doSomething
end;; 
```

此定义具有类型

```
class ['a] myClass :
  (< doSomething : 'a; .. > as 'b) ->
  object val dMember : 'b method doIt : 'a end 
```

这类似于正常的参数化数据类型，例如`'a tree`（围绕 的括号`'a`只是语法上的一点点）。请注意，这`'a`是 的类型`foo#doSomething`，而不是 的`foo`。

```
# let x = new myClass (new myClass2);; 
val x : unit myClass = <obj>
# x#doIt ;;
Doing something
- : unit = () 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T00:03:43.467

声明类型：

```
class myClass (foo:myClass2) = 
```

# javascript - 滚动到特定位置

> ID：478551
> 
> 赞同：0
> 
> 时间：2009-01-25T23:51:23.507
> 
> 标签：javascript, jquery

我目前有一张我运行的游戏的地图，地图已经[很大了](http://woarl.com/map/turn_26_normal.html)，我想让它可以用 Javascript 滚动到一个位置。如果有帮助，我正在使用 jQuery。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-02-16T17:10:39.247

您可以使用 jQueries`scrollTop()`和`scrollLeft()`函数移动到特定位置。请参阅文档：

[https://api.jquery.com/scrollTop/](https://api.jquery.com/scrollTop/)

[https://api.jquery.com/scrollLeft/](https://api.jquery.com/scrollLeft/)

拨打电话`$(document).ready()`以跳转到指定位置，例如：

```
$(document).ready(function(){
    $("body").scrollLeft(2000);
    $("body").scrollTop(800);
}); 
```

这个问题很老了，我认识它，但我很好奇:) 也许它可以帮助某人。

# .net - 为什么 Vista 报告我的 Windows 帐户不是管理员角色？

> ID：478553
> 
> 赞同：1
> 
> 时间：2009-01-25T23:52:58.090
> 
> 标签：.net, powershell, windows-vista, user-accounts, windows-principal

在 Windows Vista 下，当我检查我当前的用户帐户是否处于**管理员**角色时，我得到否定，如下图所示。

谁能告诉我为什么我不是管理员角色？当我检查我是否处于“调试器用户”角色时，我得到“真”

[![不在管理员角色中](https://farm4.static.flickr.com/3469/3227145316_c92a12d12f_o.png)](http://www.flickr.com/photos/15690844@N08/3227145316/ "在 Flickr 上迷失在法拉盛中的不在管理员角色中")

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-25T23:58:05.787

在 Windows Vista 中，您的帐户没有管理员角色，除非您已通过用户帐户控制提升到该级别。

我的理解是，您实际上有**两个**用户帐户——一个普通级别，一个管理员级别——而 UAC 调解了两者之间的切换。

# linux - C 中的管道损坏——pipe()、fork()、exec() 程序

> ID：478555
> 
> 赞同：1
> 
> 时间：2009-01-25T23:54:01.663
> 
> 标签：linux, exec, fork, pipe

我需要编写一个简单的程序：将有一个 Parent 和一些程序 [children]（通过`execl`Parent 开始）。孩子们以这种方式相互交流：孩子我感知到父母编号 J，父母向 J 发送消息（类似于 - “有消息给你”），J 发送给父母编号 K 等等。

还有一个问题——我的程序（通过`strace`命令测试）试图向孩子发送一条消息，然后出现了损坏的管道错误。

如果有人查看代码并告诉我出了什么问题，我将不胜感激：

这是代码：

```
/**
 * Arbiter zabawy w Losia
 *

 wersja: Alfa 3b
 początek edycji 25.01.2009
 */

#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/wait.h>
#include "err.h"

pid_t pid;
FILE *a;

int main ()
{
    // my N players
    int N;
    N = 10;
    //write -- writing from parent to child 
    //read -- reading from child
    int rurka_write[N+1][2]; 
    int rurka_read[N+1][2];
    //initiation of N players
    int i;
    for(i = 1; i <= N; i++)
    {
        //tworze lacza
        if (pipe(rurka_write[i]) == -1)
            printf("wystapil blad przy rurce %d\n", i);
        if (pipe(rurka_read[i]) == -1)
            printf("wystapil blad przy rurce %d\n", i); 
    }
    for(i = 1; i <= N; i++)
    {
        switch(pid = fork())
        {
            case -1: 
                printf("wystapil blad przy forkowaniu");
            case 0:
                printf("potomek numer %d\n", i);
                if (close(rurka_write[i][1]) == -1)
                    printf("zle zamykanie");
                if (close(rurka_read[i][0]) == -1)
                    printf("zle zamykanie");

                //closing useless descriptors
                int j;
                for(j = 1; j <= N; j++)
                {
                    if (j != i)
                    {
                        close(rurka_read[j][0]);
                        close(rurka_read[j][1]);
                        close(rurka_write[j][0]);
                        close(rurka_write[j][1]);
                    }
                }   

                char str_N[20];
                char str_i[20];
                char str_0[20];
                char str_1[20];

                sprintf(str_N, "%d", N);
                sprintf(str_i, "%d", i);
                sprintf(str_0, "%d", rurka_write[i][0]);
                sprintf(str_1, "%d", rurka_read[i][1]);

                printf("%d Executing execl\n", i);
                execl("./ucz", str_N, str_i, str_0, str_1, NULL);
                printf("execl executed\n");
//              execv("./ucz", str_N, str_i, str_0, str_1, NULL);
                //exit(0);
            default:
                //closing useless pipes
                if (close(rurka_read[i][1]) == -1)
                    printf("zle zamykanie rurki do czytania z potomkna\n");
                if (close(rurka_write[i][0]) == -1)
                    printf("zle zamykanie rurki do pisania do potomka\n");
        } //end of switch

    } //end of for
    //if I am in parent, I'm starting the game
    if (pid != 0)
//  delay(100);
    {
        printf("PLAY\n");
        int l = 1;
        while(l > 0)
        {
            printf("sending to player %d\n", l);
            a = fdopen(rurka_write[l][1], "w");
            printf("sending: Wake up");
            fprintf(a, "Wake up\n");
            printf("flushing");
            fflush(a);
            char k[20];
            printf("reading");
            read(rurka_read[l][0], k, 20);
            l = k;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T18:26:53.287

除了您没有以 a 结束您的案件`break`（正如 strager 所指出的那样）之外，主要问题是语句`l = k;`. 请注意，它`k`是 a`char[20]`并且，当分配给 a 时`int`，您不会将任何内容分配给`k`to `l`。而是`l`包含指向数组的指针（的值）。您将不得不在这里做一些不同的事情来获取数组中的值；究竟是什么取决于`ucz`发回。

修复此问题并自己制作后`ucz`，该程序似乎可以正常工作。当然，也可能是你的`ucz`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T09:40:25.690

关于 ./ucz -- 它需要 4 个参数 -- 1st -- 玩家数量，2nd -- 玩家数量，3rd -- 从父级读取的描述符数， 4th -- 要写入父级的描述符数。

在 exec 之后添加 exit(0)、return(0)、break （或在“case：0”的末尾）没有帮助。

# ruby-on-rails - 在没有 Shell 访问的情况下运行 Rake？

> ID：478559
> 
> 赞同：1
> 
> 时间：2009-01-25T23:57:19.020
> 
> 标签：ruby-on-rails, shell, rake

对于 RoR 安装，有没有办法在`rake`没有 root 访问权限的情况下运行命令？

换句话说，有没有办法在没有 root 访问权限的情况下获取`db:create`和`db:migrate`运行（可能是自动的或其他的）？或者我可以`rake`从 RoR 运行命令`controller`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T00:23:43.177

看一下`rails-2.X.X/lib/tasks/databases.rake`，您可以看到调用来创建、删除和迁移数据库的代码。

初始化环境后，您可以使用`rails`rake 任务文件中的代码来创建、删除和迁移。

我不知道您是否可以在出错之前在控制器级别执行此操作，但您可以随时尝试。您也可以`rails`在环境文件中完成初始化后执行此操作。

`config/environment.rb`

```
...

ActiveRecord::Migration.verbose = false
ActiveRecord::Migrator.migrate(File.join(Rails.root, 'db', 'migrate')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T00:14:09.017

好吧，这有点像鸡蛋问题，您可以在没有创建数据库的情况下启动您的 RoR 实例，但我对此表示怀疑。如果您的托管服务提供商能够托管 RoR 应用程序，那么它们必须有一种方法可以`rake`为您运行或让您以某种方式运行它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T00:18:53.907

由于听起来您在创建数据库时遇到了麻烦，有没有办法从主机控制面板中做到这一点？不过，您将如何迁移数据库？听起来你可能需要看看一个新的主机。我使用 Slicehost 并认为它们很棒:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T04:19:16.150

试试这个代码：

```
require 'rake'
require 'rake/testtask'
require 'rake/rdoctask'
require 'tasks/rails'
Rake::Task["db:version"].invoke 
```

我刚试了一下`./script/console`，效果很好。`require`没有线条就行不通。

我用它从 rake 任务中调用其他 rake 任务（当它不是 pre-req 而是必须在中间发生的事情时）。

请注意，这不会为您提供命令的任何输出。如果您愿意，您可以使用旧的反引号并运行如下命令：

```
output = `rake db:version` 
```

这将启动另一个进程，但我认为这没有问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T14:43:27.187

需要明确的是，您不需要 root 访问权限，您只需要对该计算机的 shell (ssh) 访问权限。

您如何在没有访问权限的情况下部署它？如果您使用的是 capistrano，那么您已经拥有 shell 访问权限，它可以为您运行这些任务。

# c# - C# 如何使用 CSVReader 捕获 CSV 文件中的空行？

> ID：478562
> 
> 赞同：1
> 
> 时间：2009-01-26T00:02:16.857
> 
> 标签：c#, csv

我正在使用 C# 2005 和 CSVreader 类，除了 CSV 文件在末尾包含一个空行之外，一切都运行良好：

例子：

```
1,2,3,4,5
2,3,5,6,7
,,,, 
```

我的程序错误，因为这里没有值，问题是并非所有列都包含一个值，因此下面的 2 行将是有效的。

```
1,2,,4,5
2,,5,6,7 
```

但是包含 ,,,, 的空行不会。最后一个障碍是我不确定会有多少列。

你会如何建议我测试一个空行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T00:56:14.640

这个特殊的 CSVReader 看起来可以很好地处理缺失的字段：

[一个快速的 CSV 阅读器](http://www.codeproject.com/KB/database/CsvReader.aspx)

在调用阅读器之前，您可以使用类似这样的代码来处理空行：

```
csv.MissingFieldAction = MissingFieldAction.ReplaceByNull; 
```

或替换为空字符串：

```
csv.MissingFieldAction = MissingFieldAction.ReplaceByEmpty; 
```

然后，您可以通过在读取空行后对其进行循环来测试它，如果任何列不为空，则处理该行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T00:41:12.877

我过去遇到类似问题的方法是在您的 CSV 阅读器和您正在读取的实际流/字符串之间使用阅读器。使用中间体来消除垃圾并检查额外的行等，以防止读者因某些糟糕的输入而死去。

当然，如果内存不是问题，那么您可以简单地阅读整个字符串，更正一次，然后将其输入您的阅读器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T00:04:54.027

阅读整行并向后工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-26T09:05:10.697

这是很久以前的问题，但问题仍然出现在我身上。如果您在 NuGet() 上使用可用于 .NET C# 的 CSVHelper，则可以使用此代码跳过空白：

```
 SoupToNuts record; //class with same columns found in csv file
 List<SoupToNuts> SoupToNutsList = new List<SoupToNuts>(); 

 while (csv.Read())
 {
      if (!csv.IsRecordEmpty())
      {
          record = csv.GetRecord<SoupToNuts>();
          SoupToNutsList.Add(record);
      }
 } 
```

# linux - linux上的mdfind等价物？

> ID：478563
> 
> 赞同：14
> 
> 时间：2009-01-26T00:03:02.487
> 
> 标签：linux, macos, unix, find

Mac OS X 是一个漂亮的系统，从 mach 内核到 finder 和 Spotlight，说到 Spotlight，当我只需要执行这个命令来获取所有 unix 可执行文件和仅 unix 可执行文件时，它真的让我大吃一惊：

```
mdfind "kMDItemKind == 'Unix Executable'" 
```

惊人的！！！真的！！！

现在，问题是有没有人知道一个等效的 unix 或 linux 命令，它不涉及复杂的查找咒语或不返回误报（比如有人烫发他们所有的图像 rwxrwxrwx ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T21:47:24.547

[Beagle](http://www.beagle-project.org/)、[MetaTracker](http://projects.gnome.org/tracker/)、[Strigi](http://strigi.sourceforge.net/)甚至[Google Desktop](http://desktop.google.com/)都是 Linux 的桌面索引器。默认情况下有什么取决于您的发行版（有些可能根本没有），并且它们都有不同的工具和界面，但前三个支持[Xesam](http://xesam.org/)，因此[xesam-tool](http://xesam.org/people/kamstrup/xesam-tools/xesam-tools-0.6.1.tar.gz)可以提供类似`mdfind`- 的命令行界面。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-28T13:13:50.367

在 Linux 下有 3 种方法可以解决这个问题。

### 1.使用定位工具

您可以使用命令`locate`、`which`和`whereis`来查找与系统上的模式匹配的程序和文件。

### 2\. 可执行文件保存在指定区域

Linux 系统上 90% 的可执行文件都安装在`/usr/bin`, `/usr/sbin`,下`/bin`，或者`/sbin`说什么可执行文件是可用的并不神秘。

### 3.使用查找

使用 find 定位设置了可执行位 (--x--x--x) 的文件。

```
% find . -executable -type f 
```

### 4.使用你的包管理器

您还可以使用您的 Linux 发行版的包管理器（yum、apt 等）来找出为给定包或所有安装的包安装了哪些可执行文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-26T00:17:17.760

并非如此，其他 UNIX 系统都没有在文件系统中内置索引器（BeOS 除外，但它不是 UNIX 系统，而且大多数情况下已经死了）。您可以`locate(1)`在所有 BSD 系统上使用该命令（每日脚本使用 来创建定位数据库`locate.updatedb`），但这只使您能够找到路径名。它不处理诸如关键字和文件类型之类的元数据。

老实说，这是 MacOS X 中最好的事情之一，请忍受它 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-19T15:00:47.437

```
sudo ls -Rla / | grep regexOrNameOfSomethingYouAreLookingFor & 
```

最好将它放在 BG 中，因为它可能需要一段时间。还可以将其聚焦到特定位置或 WD 极大地加速它：

```
sudo ls -Rla ~/Documents/ | grep regexOrNameOfSomethingYouAreLookingFor 
```

# language-agnostic - 递归还是迭代？

> ID：478570
> 
> 赞同：30
> 
> 时间：2009-01-26T00:07:55.347
> 
> 标签：language-agnostic, optimization, recursion, iteration

我喜欢递归。我认为它简化了很多事情。另一个人可能不同意；我认为这也使代码更容易阅读。但是，我注意到递归在 C# 等语言中的使用不像在 LISP 中那样多（顺便说一下，由于递归，这是我最喜欢的语言）。

有谁知道是否有充分的理由不在 C# 等语言中使用递归？它比迭代更昂贵吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-26T00:11:40.003

> 它们比迭代更昂贵吗？

对，他们是。许多 Lisp 变体支持“尾调用优化”的想法，它允许将递归函数调用的许多用途转换为迭代函数调用（这有点简化）。如果不支持尾调用，则递归函数调用将逐渐使用堆栈上的更多内存。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-26T00:13:10.983

> 它们比迭代更昂贵吗？

对，他们是。递归需要在调用和返回的同时创建一个新的堆栈帧，而迭代通常只需要比较和分支，从而大大加快速度；但是，编译器可以对某些递归调用（即尾调用）执行尾调用优化，这允许它们重用堆栈帧，从而大大降低递归调用的成本并有效地将它们转化为迭代。Scheme 实际上要求方案编译器实现尾调用优化。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-26T00:12:49.893

Lisp 和 F# 等函数式语言可以在内部将许多尾递归函数实现为循环，并且能够避免函数调用的堆栈开销。C# 不支持尾递归，但 F# 支持。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-26T01:26:25.017

现代 CPU 的编译器和架构可以通过迭代进行很多优化，而递归则无法做到。例如，处理器进行乐观计算的能力。当处理器找到一个迭代空间时，它知道需要多长时间。从一开始，在开始下一个循环之前，并没有真正需要每次检查。因此，他们将操作流水线化。由于大多数 CPU 可以同时执行多个操作（通过流水线），因此您可以在比递归更短的时间内解决迭代空间问题。即使是尾部优化也是如此，因为 CPU 实际上一次处理大约 4 个循环（以获得 x4 的性能增益）。这种增益将取决于 CPU 的架构。该架构可能是收益的重要组成部分，下一代 CPU 会进一步推动收益。

递归的真正问题是我们的硬件是基于冯诺依曼的（图灵机的可实现变体），而不是 Lisp 机器，虽然有一些专门的 Lisp 硬件，但你不会找到任何带有它的桌面 :)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-26T06:26:15.800

使用递归有很多优点和缺点。毫无疑问，代码的简单性是最大的优点，它也有助于更好的代码可维护性和更少的错误。

递归的最大危险是边缘情况，即算法失控以打破函数堆栈限制。某些语言（其中之一是 Progress 的 ABL 语言）具有允许的最高级别嵌套调用的参数。这些通常很低，并且在混合中添加递归可能会使应用程序突破该限制。

简而言之，递归应该始终在紧密终止情况下实现，否则它可能非常难以调试（因为不可预测性）并且可能导致生产代码中的严重问题。

对于内存和速度的问题，除非这是一个方法本身很短（时间明智）被多次调用，否则性能如何并不重要。

示例：如果您使用递归扫描硬盘驱动器的所有文件和文件夹，那么递归对性能的影响与访问硬盘驱动器并获取文件系统信息所需的时间相比是微不足道的。在这种情况下，递归可能比迭代处理更受欢迎。

另一个例子：如果您扫描树结构的节点，迭代过程可能更有益，因为我们没有过多地涉及函数堆栈，这意味着我们使用的内存更少，并且可能让硬件使用更多的缓存。有关详细信息，请参阅 Robert Gould 的回复。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-01-26T14:19:24.567

如果一个算法可以最自然地以递归形式表示，**并且**如果堆栈深度很小（在 log(N) 范围内，即通常 <20），那么无论如何都要使用递归。（由于迭代而产生的任何性能增益都将是一个很小的常数因素）。

如果存在堆栈变大的危险，并且如果您的语言/编译器/运行时系统不能保证尾调用优化，则应避免使用递归算法。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-26T23:02:12.390

> 有谁知道是否有充分的理由不在 C# 等语言中使用递归？它比迭代更昂贵吗？

是的，因为 C# 不支持[尾递归](http://en.wikipedia.org/wiki/Tail_recursion)。当使用递归对大型集合进行简单迭代时，如果递归太深，很容易得到 StackOverflowException 并导致应用程序崩溃。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-26T21:14:41.873

The choice isn't based solely on the problem to be solved, but also on the language used. In C-style languages (Java, C#, or what have you) my knee-jerk response is to avoid recursion, as it looks completely alien to me (and I just can't *think* recursively), to say nothing of the potential for stack abuse. However, there are some problems for which it makes almost no sense to use anything *other* than recursion - tree traversal being a good example. An iterative solution is completely plausible, but the code would be bigger, buggier, and almost certainly less readable.

However, more dynamic language (such as Lisp or Python) go to great lengths to make recursion a more natural possibility. My personal response is to look for an iterative solution first, no matter what the problem, but varying mileage makes a horse race.

In the end, the best bet is probably to just write it. Chances are good that you'll throw it out once in any case.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-26T21:15:41.373

Scheme is the only Lisp dialect I know of that requires tail-call optimization, and they tend to use recursion a lot. In other Lisp dialects that don't require this (like Common Lisp), I don't see recursion used any more than in any other language.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-26T23:19:34.773

递归比迭代（不可能/更难）并行化

现代 CPU 具有多核，因此如果您设计用于递归，则使用[parallel.for](http://channel9.msdn.com/posts/JeffBarnes/Parallel-Extensions-for-the-NET-Framework-ParallelFX/)（以及此类技术）进行直接优化会变得更加困难。

然而，并行化仍然相当模糊，使用它的人相对较少。

此外，我认为递归算法更容易设计和思考，因为它们同时涉及的代码和变量略少。当没有性能需要时，我通常会使用递归。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-26T20:42:59.020

如果一个问题可以简化为一个迭代，那么我就迭代。

如果问题需要递归（例如树导航），那么我会递归。

话虽如此，我主要使用 C# 制作业务线应用程序 - 我确信科学编程有不同的要求。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-26T00:16:33.677

我认为递归函数必须放在堆栈上 - 每次函数调用自身时，该函数的另一个副本都会进入函数堆栈，依此类推。问题是，在某些时候，堆栈用完了存储函数的空间，所以如果数字变大，递归解决方案可能不起作用。我知道是因为它咬了我的屁股——我对`free()`我的整个链表有一个很棒的递归函数，然后我用我可以制作的最大链表对它进行了测试，但出现了一个错误（我相信这是一个段错误——绝对应该是堆栈溢出:)）。

迭代函数没有这些错误——在机器语言中，它们表示为简单的 'jmp' 或 'je' 等，因此它们永远不会耗尽函数堆栈上的空间，并且实际上更干净。

这是一个完全主观的问题，但如果不是因为递归在您的计算机中内置了限制，我会说这是一个更好的解决方案。一些问题的迭代解决方案看起来很丑，而递归解决方案看起来更干净更好。但这就是生活。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-26T23:17:55.680

我只想说，在 XSLT 中，变量在创建后是只读的。因此，可以使用索引 for 循环完成的事情，例如

```
for(int i=0; i < 3; i++) doIt(i); 
```

实际上是通过递归完成的。相当于

```
public rediculous(i) {
    doIt(i);
    if (i < 3) rediculous(i + 1);
} 
```

我实际上会在这里提供一个 XSLT 示例，但是所有这些输入都会让 Baby Jesus 哭泣。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-26T14:08:30.453

在处理诸如列表或向量之类的固有线性数据结构时，更喜欢迭代构造而不是递归的一个原因是它更好地传达了代码的意图。当迭代足够时不加选择地使用递归时，读者通常需要更多的努力来辨别程序的结构。

# c# - 关于引用/集合/值类型的另一个 C# 问题

> ID：478573
> 
> 赞同：2
> 
> 时间：2009-01-26T00:11:41.907
> 
> 标签：c#, .net, stack, heap-memory

我有以下代码：

```
public class Test
{
    public static void Main()
    {
        List<Person> list = new List<Person>();
        Person person = new Person() { Name="Chris" };
        list.Add(person);

        person = new Person(){ Name="Wilson the cat" };
        list.Add(person);

        Console.WriteLine(list[0].Name);
        Console.WriteLine(list[1].Name);
        Console.ReadLine();
    }
}

public class Person
{
    public string Name {get;set;}   
} 
```

我的问题是第一人称实例去哪里了？CLR 会在某处神奇地创建它的新实例吗？无论如何在列表之外引用它 - 例如，在方法完成后它会去哪里？使用什么方法将对象存储在集合中（这是 4 个问题）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-26T00:27:50.500

```
 List<Person> list = new List<Person>();

    Person person = new Person() { Name="Chris" };
    // your person object lives on the heap. The person variable is just
    // a pointer of that object on the heap. Note that the pointer lives
    // on the stack, and the object it points to lives on the heap.

    list.Add(person);
    // when you add your person to to the list, all it does it pass a
    // copy of the *pointer* to the list's method. List has access to this
    // object through the pointer.

    person = new Person(){ Name="Wilson the cat" };
    // new'ing up a instance of person creates another person object on
    // the heap. Note that this doesn't overwrite our original person created above,
    // because our original person sits in an entirely differently memory 
    // location.

    // We did, however overwrite our pointer variable by assigning it a new
    // location to point at. This doesn't affect the object we put into our
    // list since the list received a copy of our original pointer :)

    list.Add(person);

    Console.WriteLine(list[0].Name);
    // list[0] has a pointer to the first object we created

    Console.WriteLine(list[1].Name);
    // list[1] has a pointer to the second object we created.

    Console.ReadLine();

    // when this methods goes out of scope (i.e. when the stack frame is
    // popped), the pointers will be dropped from memory, and the objects
    // on the heap will no longer have any live references to them, so
    // they'll be eaten by the garbage collector. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T00:17:30.397

1）它在堆上（如果> 84K，则在大对象堆上）

2) 是的，创建了一个新实例。可以通过列表访问它来引用它。

3) 集合可能使用列表，但您不需要知道内部细节，除非您需要特定的速度或空间属性。

# php - 通过 PHP 跨服务器复制 MySQL 结构

> ID：478590
> 
> 赞同：0
> 
> 时间：2009-01-26T00:22:36.567
> 
> 标签：php, mysql

我需要帮助 - 我在不同的服务器上有两个 mysql 数据库和一个 Web 主机，我需要将 Joomla 安装从一个复制到另一个。我遇到的问题是我可以访问数据的唯一方法是通过 php，因为与数据库的直接 odbc 连接被锁定。

我不介意一张一张地做，但不知道如何编写脚本:(

我对 php 的了解有限（因此使用 Joomla），所以如果有人有几分钟的时间给我指出正确的方向，我将不胜感激。

提前致谢，

PG

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T00:33:04.297

你能安装[phpMyAdmin](http://phpmyadmin.net/)吗？如果是这样，它具有可能非常适合此的数据库导出/导入功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T00:36:11.030

看看这个帖子。

[仅使用 php 备份和恢复 mysql 转储的最佳方法是什么？](https://stackoverflow.com/questions/459796/what-would-be-the-best-way-to-backup-and-restore-mysql-dumps-with-just-php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T00:34:59.817

您可以使用[mysqldump](http://dev.mysql.com/doc/refman/5.0/en/mysqldump.html)，但我会按照其他海报的建议先尝试 phpMyAdmin。

# .net - Castle ActiveRecord / NHibernate - 密码加密或散列

> ID：478592
> 
> 赞同：0
> 
> 时间：2009-01-26T00:23:27.843
> 
> 标签：.net, nhibernate, castle-activerecord, password-storage

使用您不想以明文形式存储在数据库中的密码的正确方法是什么？我在 NHibernate / Castle ActiveRecord 中有哪些选择？

**更新：** 我对其他人如何使用 NHibernate / Castle ActiveRecord 处理这个问题很感兴趣。如果 NHibernate 或 Castle ActiveRecord 中内置了任何东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T03:45:53.270

Hash the password. Don't encrypt - it's complex and/or unsafe. There's no conceivable circumstance in which it wouldn't be OK to reset the password based on some other verifiable criterion in an ordinary line-of-business app or Web site. I'm not sure from the question whether or not you're familiar with the principle of hashing a password, so I'll explain from the basics...

When the user selects their password initially, you run a one-way hash algorithm on the text. This produces a signature - an output that will always be produced if you input the same string into the hash algorithm. The key is that you can't get back to the password from the hash (hence one-way). You then store the hash, not the password. When the user comes back they have to type in their password again, you hash this using the same algorithm and compare the resulting value to what's in the DB - if they match, you know the user enterered the same string again, but you still don't know, or need to know, what it is. This is much more secure than solutions based on encyrption where you can always recover the plaintext if you know the key, which by definition has to be known to the server in order to validate the password input.

A simple way of hashing a string in .NET is to use `System.Web.Security.FormsAuthentication.HashPasswordForStoringInConfigFile()`, which despite its lengthy name is a simple function provided for those using ASP.NET Forms Authentication, but just as useful elsewhere. You can specify MD5 or SHA1 as your hash algorithm (or indeed other hash algorithms if supported by future framework versions). I recommend SHA1 because MD5 is known to have weaknesses, but then SHA1 probably does too.

However - there's a flaw in this scheme. If multiple users choose the same password, they will have the same hash. If a hacker gets access to your data, they can run a brute-force attack hashing common strings and comparing these against your stored data. If they get a hit, they've cracked all the accounts using that password. Since users tend to pick crappy passwords and hate being made to pick secure ones they can't remember, this makes a system based on simple password hashes a little brittle.

What you should do is *salt* the hash. This just means prepending or suffixing the original data - the password - with a random string of characters. This salt needs to be as random as it can be and at least a few chars in length (I recommend 5 as a minimum) and preferably of random length. You store the salt (unobfuscated) in a column in the DB alongside the hashed salt + password combination. When the user returns you prepend or suffix the salt to their input in the same way, and then do the hash comparison as before.

This reduces the effectiveness of a brute force attack because every user should have a different hash even if they have the same password. You can safely store the salt in the DB because working out a string from its hash is just as hard when you know some of the string as it is when you know none of it, provided the password itself is longer than the salt and long enough and strong enough to take a long time to crack by brute force (at least 6 chars with at least one case change and a number or non-alphanumeric, I'd say).

If someone has unlimited access to your data for unlimited time, they'll eventually crack the hashed passwords. But eventually could be months or years. And provided you know you've been compromised, you can get everyone's password changed well before it becomes a problem.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T00:45:36.440

最好的方法是使用 UserType。[这是一个](http://ayende.com/Blog/archive/2008/07/31/Entities-dependencies-best-practices.aspx)实现透明密码加密的方法。

我会将此类常见问题复制到[ActiveRecord wiki](http://using.castleproject.org/display/AR/FAQ)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-16T19:27:21.970

我建议不要将 UserType 用于单向散列，除非您有一个计划来防止在后续调用 NullSafeSet() 时不断重新散列散列密码。

相反，我建议您在 Password 属性上使用支持字段，在 setter 中应用哈希方法并设置映射以使用字段访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-16T13:49:15.903

对不起，也许这对你来说已经无关紧要了，但我希望可以帮助别人。

使用 uNhAddins 是我发现的最简单的方法，您只需要关心 HBM 即可。

检查这个[hbm 示例](http://code.google.com/p/unhaddins/source/browse/trunk/uNhAddIns/uNhAddIns.Test/UserTypes/User.hbm.xml)

希望有所帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T00:27:17.570

您应该加密或散列密码。散列更安全一些（当然取决于算法）。因为无法逆转；但是，加密可以更有效，因为您可以使用检索密码选项。使用散列，您必须生成一个新密码..

至于 nHibernate / castle，您应该在业务对象中处理算法，恕我直言，与持久性机制分开。

# c# - 这个从 Java 到 c# 的代码片段是否正确？

> ID：478594
> 
> 赞同：0
> 
> 时间：2009-01-26T00:24:33.893
> 
> 标签：c#, java, regex

我正在尝试将一些 Java 的东西移植到 C#。我只是想知道以下 C# 代码是否等同于原始 Java 源代码。

## 来源：Java 代码

```
private static final Pattern SIMPLE_IDENTIFIER_NAME_PATTERN = 
    Pattern.compile("^[a-zA-Z_][a-zA-Z0-9_]*$");

    private static boolean isValidIdentifier(String s) {
        Matcher m = SIMPLE_IDENTIFIER_NAME_PATTERN.matcher(s);
        return (m.matches() && !reserved.contains(s));
    } 
```

## 目的地：C#代码

```
private static readonly Regex SIMPLE_IDENTIFIER_NAME_PATTERN = 
    new Regex("^[a-zA-Z_][a-zA-Z0-9_]*$", RegexOptions.Compiled);

private static bool IsValidIdentifier(string s)
{
    Match match = SIMPLE_IDENTIFIER_NAME_PATTERN.Match(s);
    return (match.Success && !Reserved.Contains(s));
} 
```

干杯:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T00:27:19.410

根据我的评论，我认为您应该编写一个单元测试（或多个测试）来验证端口是否按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T00:27:16.697

看起来不错，但是为什么不从移植单元测试开始呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T08:30:42.307

您使用 Caret 和 Dollar 表示您希望匹配主题字符串中嵌入的换行符，而不是整个字符串的开头和结尾。如果是这样，那么您绝对应该为您的 Regex 设置 RegexOptions.Multiline 选项。如果您不设置该选项，您的 Caret 和 Dollar 将没有特殊含义。

```
private static readonly Regex SIMPLE_IDENTIFIER_NAME_PATTERN = new Regex("^[a-zA-Z_][a-zA-Z0-9_]*$", RegexOptions.Compiled | RegexOptions.Multiline); 
```

评估编译此 Regex 的必要性也可能是值得的。是否需要重复使用（例如循环使用）？如果不是，那么您的正则表达式实际上将具有较低的性能。

除此之外，您的转换似乎是有效的。正如其他一些人所建议的那样，合理确定的唯一方法是对其进行单元测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T00:38:05.100

请注意，只读类型不是不可变的。这意味着您无法更改指向的正则表达式的引用，但您可以更改正则表达式对象本身。（幸运的是，正则表达式上的合同不会让您更改表达式）

请注意，.Net 正则表达式语法与 *nix 正则表达式语法不同，因此您可能会被咬到那里。根据 MSDN 文档确认你需要你的字符串做什么：

[MSDN 正则表达式语法](http://msdn.microsoft.com/en-us/library/1400241x(VS.85).aspx)

# ms-access - 自动将 Oracle 用户表导出到 MS Access

> ID：478599
> 
> 赞同：2
> 
> 时间：2009-01-26T00:27:20.393
> 
> 标签：ms-access, export

这可能是将一些用户表（DDL 和数据）从 Oracle 数据库自动导出到 Microsoft Access 数据库的简单方法，这意味着无需用户交互。

**更新**：Access 数据库上的链接表会引发用户/密码对话框以连接 oracle，这不是一个有效的选项。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T00:33:52.253

您可以在 MS Access 中设置“指向”实际 Oracle 数据而不是复制它的链接表。这样，数据始终是最新的。

否则，您将需要创建一个计划进程，或者可能在每次打开 MS Access 数据库时通过 VBA 代码执行导入。

就个人而言，我会选择链接表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T12:33:37.883

## Warning

Some notes about the code below:

1.  It doesn't check if the table is already linked first. If it is, you'll get an error you'll have to handle.

2.  **The user name and password are passed as clear text, which is a security risk.** Someone can open up your database code and get all the info they need to connect to your database and potentially do some harm. If this matters to you, you'll need to either compile your Access database to an MDE and distribute that, or find some way of encrypting/decrypting the connect info on the fly.

## Answer

You can use ADOX to link the tables without prompting for user ID and password. First, set a reference to the "**Microsoft ADO Ext. 2.8 for DDL and Security**" libary (Tools\References... in the VBA editor). If you don't see this entry in the list of available references, browse for "msadox.dll" and add it manually. Your version number may be different, depending on your version of Access (I'm using 2003 here).

You can then use code like this to link to an Oracle table:

```
Sub LinkOracleTable(Server, UserID, Password, Schema, TableName)

Dim tbl As New ADOX.Table
Dim cat As New ADOX.Catalog

Set cat.ActiveConnection = CurrentProject.Connection

With tbl
    .Name = TableName

    Set .ParentCatalog = cat
    .Properties("Jet OLEDB:Create Link") = True
    .Properties("Jet OLEDB:Link Provider String") = "ODBC;" & _
        "Driver={Microsoft ODBC For Oracle};" & _
        "Server=" & Server & ";" & _
        "Uid=" & UserID & ";" & _
        "Pwd=" & Password & ";"
    .Properties("Jet OLEDB:Cache Link Name/Password") = True
    .Properties("Jet OLEDB:Remote Table Name") = Schema & "." & TableName
End With

cat.Tables.Append tbl
cat.ActiveConnection.Close

End Sub 
```

You would call the sub like this:

```
LinkOracleTable "TNS Service Name", "UserName", "Password", "MySchema", "MyTable" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T23:38:32.630

Oracle 可以使用 UTL_FILE 写入平面文件。然后，您需要将它们带到 Access 数据库可以上传它们的位置。

Oracle 标准版和企业版包含一个 JVM，因此您可以在其中拥有通过 JDBC 连接到 Access 并以这种方式推送数据的 Java 代码。

还要查找异构连接和数据库链接 [http://www.oracle-base.com/articles/9i/HSGenericConnectivity9i.php](http://www.oracle-base.com/articles/9i/HSGenericConnectivity9i.php) 如果您的 Oracle DB 位于可以处理 ODBC 的服务器上，这可能只是一个选项。

最后，根据前面的评论，您可以将数据推送到单独的模式甚至单独的 Oracle 数据库（例如免费的 Oracle 快速版），并让 Access 数据库/应用程序从那里获取它。

# c# - 如何在 Mono/Windows 上使用 gecko-sharp 嵌入 Gecko？

> ID：478611
> 
> 赞同：7
> 
> 时间：2009-01-26T00:41:34.670
> 
> 标签：c#, .net, mono, gecko

Gecko 是 Firefox 的渲染引擎。使用 gecko-sharp 可以将其嵌入到任何 Mono/GTK# 程序中。有一个名为[GladeSharpBrowser](http://developer.novell.com/wiki/index.php/Glade-Sharp_and_Gecko-Sharp)的示例应用程序可以执行此操作。我可以设法使用修改后的项目文件来构建它，但它正在崩溃。这将帮助您重现问题：

我使用了[SharpDevelop 3.0](http://www.icsharpcode.net/OpenSource/SD/Download/)和一个[教程](http://mono.wikia.com/wiki/Using_Mono_with_SharpDevelop_3.0)来设置我的[Mono 2.2](ftp://ftp.novell.com/pub/mono/archive/2.2/windows-installer/5/mono-2.2-gtksharp-2.12.7-win32-5.exe)安装。我确保它调用 Mono 的 gmcs 以使用 ProcMon 进行编译。设置 SharpDevelop 后，必须修改[BrowserSharp.csproj](http://ifile.it/qlvy67d)以便它与 Mono 一起编译。

还有一条警告信息：

> 发现同一依赖程序集的不同版本之间存在冲突。

这很奇怪，因为所有的程序集都是 Mono 提供的。

当然，还有其他方法，例如 GeckoFX，但我特别感兴趣的是使用 Mono 以独立于平台的方式进行操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T11:50:32.797

Mono.WebBrowser 可能是对您的交叉兼容性问题更好的答案，因为它最终可能独立于引擎。

[http://www.mono-project.com/WebBrowser](http://www.mono-project.com/WebBrowser)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T11:08:30.633

解决问题的第一步是找出它崩溃的原因。根据您的说明构建 BrowserSharp 后（尽管我单独重新创建了 csproj），我运行：

```
mono --debug BrowserSharp.exe
```

使用 --debug 标志，mono 将打印出任何未处理的异常：

```
未处理的异常：System.TypeInitializationException：
Gecko.WebControl 的类型初始化程序引发了异常 --->
System.DllNotFoundException：gtkembedmoz.dll   
   在（包装器托管到本机）Gecko.WebControl:gtk_moz_embed_get_type ()
   ...

```

我在 Mono 发行版中找不到 gtkembedmoz.dll，但它似乎是一个单独的安装。可以在[此处](http://zbowling.com/projects/gtkembedmoz/)找到下载链接，并在此处找到一些旧的但可能有用的[说明](http://www.novell.com/coolsolutions/feature/14918.html)。

我下载了稳定的 GRE 包并将 gtkembedmoz.dll 复制到构建目录中。它仍然崩溃，所以我使用[depends.exe](http://www.dependencywalker.com/)检查了依赖项，这清楚地表明它缺少Gtk+ 库。在安装[gtk-sharp](http://ftp.novell.com/pub/mono/gtk-sharp/)运行时并将丢失的 dll 复制到构建目录后，我设法让它使用 Microsoft .NET 运行时运行。

由于某种原因，它仍然无法使用 Mono。我怀疑 Mono 搜索非托管 DLL 的方式存在一些差异，但我没有对此进行研究。无论您是否使用 Microsoft.NET 的 Mono，您可能都不需要将这些 DLL 复制到构建目录中，只需确保它们已正确安装/配置，以便找到它们。

# c# - 为什么在 C# 中队列会扰乱其元素中的数据？

> ID：478616
> 
> 赞同：3
> 
> 时间：2009-01-26T00:44:54.320
> 
> 标签：c#, multithreading, queue

我对队列的功能完全感到困惑。我正在尝试（并且失败）编写一个小型多线程应用程序来收集和显示 C# 中的数据。
在阅读了[Albahari 的书](http://www.albahari.com/threading/)并使用他描述的消费者/生产者模式之后，我得到了大部分工作，除了我的数据似乎在队列中被打乱了。在排队之前，我的对象中的字段具有以下值

> 时间戳 = 6
> 数据[] ={4936, 9845, 24125, 44861}

出队后的数据看起来像

> 时间戳 = 6
> 数据 [] = {64791、19466、47772、65405}

我不明白为什么数据字段中的值在出队后被更改？我很困惑，所以我想我会把它扔在那里，看看是否有人能指出我正确的方向来解决这个问题，或者让我指向不同的方向继续前进。

* * *

**相关代码**

* * *

**用于数据存储的自定义对象**

相关对象和字段。sensorData 类是一个单独的类，用于存储我的计算。

```
public class sensorData
{
    public const int bufSize = 4;
    public UInt16[] data = new UInt16[4];
    public double TimeStamp = 0; 
    public int timeIndex = 0;
} 
```

以下字段用于设置入队和出队线程之间的队列和信号。

```
EventWaitHandle wh = new AutoResetEvent(false);
Queue<sensorData> dataQ = new Queue<sensorData>();
object locker = new object(); 
```

**入队方法/线程**

这是我的工作线程，它计算四个正弦曲线并将结果排队等待处理。我还将结果写入一个文件，这样我就知道它计算了什么。

```
private void calculateAndEnqueueData(BackgroundWorker worker, DoWorkEventArgs e)
{
    int j = 0;
    double time = 0;
    double dist;
    UInt16[] intDist = new UInt16[sensorData.bufSize];
    UInt16 uint16Dist;

    // Frequencies of the four Sine curves
    double[] myFrequency = { 1, 2, 5, 10 };

    // Creates the output file.
    StreamWriter sw2 = File.CreateText("c:\\tmp\\QueuedDataTest.txt"); 

    // Main loop to calculate my Sine curves
    while (!worker.CancellationPending)
    {
        // Calculate four Sine curves
        for (int i = 0; i < collectedData.numberOfChannels; i++)
        {
            dist = Math.Abs(Math.Sin(2.0 * Math.PI * myFrequency[i] * time);
            uint16Dist = (UInt16)dist;
            intDist[i] = uint16Dist;
        }

        // Bundle the results and Enqueue them
        sensorData dat = new sensorData();
        dat.data = intDist;
        dat.TimeStamp = time;
        dat.timeIndex = j;

        lock (locker) dataQ.Enqueue(dat);
        wh.Set

        // Output results to file.
        sw2.Write(j.ToString() + ", ");
        foreach (UInt16 dd in dat.intData)
        {
            sw2.Write(dd.ToString() + ", ");
        }
        sw2.WriteLine();

        // Increments time and index.
        j++;
        time += 1 / collectedData.signalFrequency;

        Thread.Sleep(2);
    }
    // Clean up
    sw2.Close();
    lock (locker) dataQ.Enqueue(null);
    wh.Set();
    sw2.Close();
} 
```

输出文件**QueuedDataTest.txt中的示例行**

> 6、4936、9845、24125、44861、

**出队数据方法**

此方法从队列中取出元素并将它们写入文件。直到在队列中找到一个空元素，此时作业完成。

```
 private void dequeueDataMethod()
    {
        StreamWriter sw = File.CreateText("C:\\tmp\\DequeueDataTest.txt");

        while (true)
        {
            sensorData data = null;

            // Dequeue available element if any are there.
            lock (locker)
                if (dataQ.Count > 0)
                {
                    data = dataQ.Dequeue();
                    if (data == null)
                    {
                        sw.Close();
                        return;
                    }
                }

            // Check to see if an element was dequeued. If it was write it to file.
            if (data != null)
            {
                sw.Write(data.timeIndex.ToString() + ", ");
                foreach (UInt16 dd in data.data)
                    sw.Write(dd.ToString() + ", ");
                sw.WriteLine();
            }
            else
            {
                wh.WaitOne();
            }
        } 
```

数据出列并写入**DequeueDataTest.txt后的输出结果**

> 6、64791、19466、47772、65405、

* * *

**更新1：**

**当前代码中锁的位置。**

* * *

我已经编辑了代码以锁定将数据写入文件。所以我有锁的代码块如下。

在*CalculateAndEnqueueData()*方法中，我有

```
lock (locker) dataQ.Enqueue(dat);
wh.Set

lock(locker)
{
  sw2.Write(j.ToString() + ", ");
  foreach (UInt16 dd in dat.intData)
  {
     sw2.Write(dd.ToString() + ", ");
  }
  sw2.WriteLine();
} 
```

在*dequeueDataMethod()*我有两个带锁的区域第一个在这里

```
lock(locker) 
    if (dataQ.Count > 0)
    {
       data = dataQ.Dequeue();
       if (data == null)
       {
           sw.Close();
           return;
        }
    } 
```

*我假设为if*块中的代码锁定了储物柜。第二个是我在这里写入文件的地方

```
lock (locker)
{
    sw.Write(data.timeIndex.ToString() + ", ");
    foreach (UInt16 dd in data.intData)
        sw.Write(dd.ToString() + ", ");
    sw.WriteLine();
    if (icnt > 10)
    {
        sw.Close();
        return;
    }
    this.label1.Text = dataQ.Count.ToString();
} 
```

这就是他们的全部。

* * *

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-26T00:52:14.883

问题是由于您正在写入的 StreamWriter 上没有同步。顺序不是顺序的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T01:15:19.737

是因为你`UInt16[] intDist`一遍又一遍地写入同一个数组吗？您不应该为每个`sensorData`对象使用单独的数组吗？（顺便说一句，`sensorData.intData`假设`sensorData.data`在您的示例代码中？）

**澄清：**

中只`intDist`创建了一个数组`calculateAndEnqueueData()`，所以不同`sensorData`的实例都共享同一个数组——如果添加+写入和删除+写入发生在锁步中，这是可以的；否则，某些数据点可能会丢失/重复。

**建议：**

直接填充`sensorData`实例，不使用`intDist`数组，在`calculateAndEnqueueData()`：

```
 // create new sensorData instance
    sensorData dat = new sensorData();
    dat.TimeStamp = time;
    dat.timeIndex = j;

    // Calculate four Sine curves
    for (int i = 0; i < collectedData.numberOfChannels; i++)
    {
        dat.data[i] = (UInt16) Math.Abs(Math.Sin(2.0 * Math.PI * myFrequency[i] * time);
    }

    // enqueue
    lock (locker) dataQ.Enqueue(dat); 
```

# javascript - 用于代码结构的 Javascript 成语

> ID：478632
> 
> 赞同：2
> 
> 时间：2009-01-26T01:17:43.990
> 
> 标签：javascript, idioms

我的 javascript 多次包含在 script 标签中，如下所示：

```
<script src="code.js></script>
<script src="code.js></script>
<script src="code.js></script> 
```

现在我在**code.js**中有这段代码，可以让我的代码只运行一次，而不会覆盖我的命名空间：

```
if(typeof _ow == "undefined" ){
_ow = {};
// code in here will only run once

_ow.Auth = (function(){
})();
_ow.Template = (function(){
})();

} 
```

有没有更好的结构可以让我的代码只运行一次？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T01:22:06.790

```
var _ow = _ow || { Auth: ... }; 
```

如果它已经定义，则不会再次定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T02:58:28.187

您熟悉 Crockford 的[Javascript 模块模式](http://ajaxian.com/archives/a-javascript-module-pattern)吗？

关于如何防止覆盖命名空间的轻微变化：

```
var _ow;
if(!_ow) _ow = {}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T04:18:40.800

虽然你正在做的事情在技术上是可行的，但效率很低，因为即使你的代码只运行一次，它最终也会在某些浏览器上被解析多次（这与通过网络下载文件不同，并且不能被缓存）。

最好确保脚本只包含一次。对于所有重复的功能，您可以在需要时公开要调用的函数。

# streaming - 拆解：适用于 RTSP？

> ID：478637
> 
> 赞同：2
> 
> 时间：2009-01-26T01:21:51.687
> 
> 标签：streaming, video-streaming, rtsp

当用户单击视频 (RTSP) 流会话中的停止按钮时发送 TEARDOWN 是否合适？如果不是那为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T09:43:59.747

我认为是的，没有其他“保证”的方式来告诉服务器停止。Quicktime 和 VLC 都是这样做的，我不知道其他客户端。[从RFC 2326](http://www.ietf.org/rfc/rfc2326.txt)的这个页面可以看出，建议使用 PAUSE 指令，但不是必需的。另外，它是为了暂停，而不是停止，所以是的，TEARDOWN 是正确的方法。

```
 method            direction        object     requirement
  DESCRIBE          C->S             P,S        recommended
  ANNOUNCE          C->S, S->C       P,S        optional
  GET_PARAMETER     C->S, S->C       P,S        optional
  OPTIONS           C->S, S->C       P,S        required
                                                (S->C: optional)
  PAUSE             C->S             P,S        recommended
  PLAY              C->S             P,S        required
  RECORD            C->S             P,S        optional
  REDIRECT          S->C             P,S        optional
  SETUP             C->S             S          required
  SET_PARAMETER     C->S, S->C       P,S        optional
  TEARDOWN          C->S             P,S        required 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-20T04:10:45.967

是的，这是合适的。

服务器应该为特定用户维护一个会话状态，它们不应该假设所有命令都来自同一个 TCP 连接，而是提供一个在第一个 SETUP 回复发送到客户端时创建的 sessionid。其后的所有请求都应包含 sessionid（有例外）。通过发送 TEARDOWN 请求，客户端向服务器指示它可以释放与该用户关联的所有状态。

PAUSE 只会指示服务器停止发送数据包，而不是释放与该会话关联的状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-13T02:55:57.003

rtsp 客户端软件拆除媒体会话的行为有多种实现方式。Realplayer 将在 TEARDOWN 之前发送 PAUSE。Quicktime Player 和 VLC 将在没有暂停的情况下发送 TEARDOWN。我觉得两者都可以接受。

# asp.net - 在 jQuery 中捕获异常

> ID：478639
> 
> 赞同：7
> 
> 时间：2009-01-26T01:23:10.513
> 
> 标签：asp.net, javascript, jquery, ajax, error-handling

我有以下代码：

```
<script type="text/javascript">
    $(document).ready(function() {

        $("#Save").click(function() {

            $.post("url", {
                "data": "data"
            }, function(data) {
                alert(data);
            });

        });

    });
</script> 
```

我正在测试这个脚本，我正在做的测试之一是，我只需关闭 asp.net Web 开发服务器，然后单击按钮。

IE 说“访问被拒绝”错误，我想捕捉这里发生的任何错误，并在这种情况下向用户显示一条友好的消息。

我尝试使用 try/catch 但没有用...

有什么线索吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-26T01:24:26.923

请改用该[`$.ajax()`](http://docs.jquery.com/Ajax/jQuery.ajax)方法。它有一个错误钩子。

[例如](http://www.ibm.com/developerworks/library/x-ajaxjquery.html)：

```
$.ajax({
    url: 'document.xml',
    type: 'GET',
    dataType: 'xml',
    timeout: 1000,
    error: function(){
        alert('Error loading XML document');
    },
    success: function(xml){
        // do something with xml
    }
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-26T02:28:18.573

[这是与FireBug](http://getfirebug.com/)一起跟踪任何 jquery ajax 错误的有用片段。

```
// Displays any ajax errors in the Firebug console instead of hiding them
$(document).ajaxError(function(){
    if (window.console && window.console.error) {
        console.error(arguments);
    }
}); 
```

> 如果您将 Ajax 与 jQuery 一起使用，您可能已经注意到当出现问题时您不会收到任何错误消息。即使您的回调函数中有重大错误，jQuery 也会默默地失败，将所有错误扫到地毯下，让您对刚刚发生的事情一无所知。
> 
> 运行此代码后，您将开始在 Firebug 控制台中收到错误消息（如果您的 Ajax 调用或回调出现任何问题）。错误消息不是最大的，但至少你不必再呆在黑暗中了。

[归功于杰西·斯金纳](http://www.thefutureoftheweb.com/blog/hidden-ajax-errors-in-jquery)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-11T17:18:45.233

好，我猜javascript终于也支持了，像这样

```
try{
     main code...
}catch(err){
     error ocurred...
}finally{
     do this anyway...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T08:26:31.240

像这样在所有 js 代码周围放置一个包装器：

```
 try
           {
       ... js code 
              }
         catch(err)
        {
         alert(err.toString()); 
        } 
```

但是对于 ajax 调用，这可能是行不通的。

# c# - 具有依赖于相同二进制引用的多个项目的解决方案

> ID：478643
> 
> 赞同：2
> 
> 时间：2009-01-26T01:26:27.013
> 
> 标签：c#, binary, dependencies, reference, projects-and-solutions

我有一个包含 10 个项目的解决方案。许多项目依赖于第三方 DLL，称为`foo.dll`.

问题是，当我升级 foo 时，在 Visual Studio 中，当我转到对象浏览器时，它会显示两个版本的`foo.dll`.

如何找出哪个项目引用了旧版本的 foo.dll，以便我可以升级它，以便所有项目中只有一个依赖项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T01:43:30.223

这是你只想做一次的事情。

我给你的建议是买记事本。是的，记事本。

打开每个项目的 .csproj 文件。

XML 中将有一个部分概述正在引用的 DLL，包括路径等。即使它们来自 GAC，.NET 链接器使用的版本等也将包含在文件中. 引用的整行必须完全匹配。

将这些与您知道正确的一个项目进行比较。

在 .NET 中处理引用是其中最糟糕的部分之一。欢迎来到 DLL 地狱 v2.0 :(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T01:43:09.007

听起来您在 GAC 中安装了两个版本的 Foo.dll。查看[gacutil](http://en.wikipedia.org/wiki/Global_Assembly_Cache#Global_Assembly_Cache_Tool)以删除旧的。

如果它只是一个文件引用，那么在每个项目中，打开“引用”并右键单击“Foo”并选择属性。它会在生成的属性窗口中告诉您版本等信息。

通常，解决此类依赖关系的最佳方法是在项目级别（但不是实际解决方案的一部分）有一个名为“依赖关系”的单独文件夹，其中包含这些类型的 DLL。

我还会考虑在您的服务器上进行一些构建自动化（TFS = Team Build、SVN = Cruise Control 等），这将在构建之前将正确版本的程序集复制到 bin 文件夹中。

有很多方法可以使用程序集，很容易混淆各种应用程序正在使用哪一种。值得花一些时间以可应用于所有未来项目的可模板方式解决此问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T02:09:04.680

我理解这个问题，但我不确定你问的是正确的问题。让我解释一下 .NET 如何选择引用的程序集。

*   装配参考可以是浮动的或固定的（右键单击项目参考文件夹中的装配，选择属性，查找“特定版本”）。如果版本是浮动的，.NET 将找到并使用最新的版本。“固定”参考版本是有意义的，这样可以避免您描述的问题（即安装产品的新版本不会破坏您的应用程序）。

*   程序集可以位于全局程序集缓存中，也可以仅位于文件系统中。您应该选择一种方法并在整个项目中始终如一地使用它，这样您至少知道在哪里寻找。

如果你了解了这两个方面，你应该没有问题（好吧，至少你应该知道如果有问题应该怎么做）。如果您固定版本并升级，您必须打开您的 10 个项目并升级参考 - 但您与意外升级隔离。

如果您让您的版本浮动，所有引用将自动选择已安装的最新版本。如果将程序集放在 GAC 中，则不必在搜索路径和文件系统中搜索剩余的部分和 DLL 文件的意外副本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-11T13:52:52.690

我认为最好的答案是在可行的情况下*只有一个项目具有这种依赖性。*它使您可以在一个地方处理它。

如果这意味着项目需要包含一个可笑的围绕 DLL 的包装库，那么这可能不是最好的方法。但至少考虑一下。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-24T18:50:06.313

我有同样的问题。

项目A引用了项目B。项目C引用了项目D，它引用了项目B。这导致项目C有一个对项目B的引用。我摆脱了项目D并清理了项目C（在代码中），但是对项目 B 仍然存在，我猜它是指向项目 D 的 bin 文件夹的二进制引用。

我在 Visual Studio 中更新了 Project B。当我作为启动项目 C 运行时，它抛出了这个错误。

为了解决这个问题，我进入了 Project C 的引用并删除了未使用的引用。

顺便说一句，您的实际问题 - 如何找出有问题的 dll 所在的位置 - 可以更容易地回答如下： 1\. 进入资源管理器（此处为 Window 7 说明），并在整个代码文件夹中搜索 .dll . 2\. 在资源管理器中为 FileVersion 添加列并按此列排序。瞧！

# python - 需要在 python 类中路由实例调用

> ID：478655
> 
> 赞同：1
> 
> 时间：2009-01-26T01:45:01.237
> 
> 标签：python, class, instance

问题是在选择响应者之前需要考虑参数。到目前为止，这是我的尝试。

```
from responders import A, B, C

class RandomResponder(object)
    def init(self, *args, *kwargs):
        self.args = args
        self.kwargs = kwargs

    def __getattr__(self, name):
        # pick a responder based on the args the function was called with
        # I don't know how to do this part
        # for sake of argument lets the args a function was called with lead me to pick responder A
        r = A
        responder = r(*self.args, **self.kwargs)
        return responder.__getattr__(name) 
```

期望的效果是：

```
r = RandomResponder()
r.doSomething(1)
#returns A.doSomething()
r.doSomething(2)
#returns B.doSomething()
r.doSomething(3)
#return C.doSomething()
r.doSomethingElse(1)
#returns A.doSomethingElse()
r.doSomethingElse(2)
#returns B.doSomethingElse()
r.doSomethingElse(3)
#returns C.doSomethingElse() 
```

我不会提前知道响应者 A、B 和 C 包含的所有功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T03:07:59.243

当你这样做时

```
r.doSomething(1) 
```

发生的事情是，按顺序：

*   `r.__getattr__`被调用，并返回一个对象
*   使用参数“1”调用此对象

在`__getattr__`被调用的时候，你无法知道你返回的对象*将*被调用什么参数，或者即使它会被调用......

因此，要获得您想要的行为，`__getattr__`必须返回一个可调用对象，该对象根据调用*它的*参数自行做出决定。例如

```
from responders import A, B, C

class RandomResponder(object):
    def __getattr__(self, name):
        def func(*args, **kwds):
            resp = { 1:A, 2:B, 3:C }[args[0]]    # Decide which responder to use (example)
            return getattr(resp, name)()         # Call the function on the responder
        return func 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T03:09:31.143

试试这个：

```
class RandomResponder(object):
    choices = [A, B, C]

    @classmethod
    def which(cls):
        return random.choice(cls.choices)

    def __getattr__(self, attr):
        return getattr(self.which(), attr) 
```

which() 从选项中随机选择一个选项，**getattr**用于获取属性。

编辑：实际上看起来你想要更像这样的东西。

```
class RandomResponder(object):
    choices = [A, B, C]

    def __getattr__(self, attr):
        # we define a function that actually gets called
        # which takes up the first positional argument,
        # the rest are left to args and kwargs
        def doCall(which, *args, **kwargs):
            # get the attribute of the appropriate one, call with passed args
            return getattr(self.choices[which], attr)(*args, **kwargs)
        return doCall 
```

这可以使用 lambda 来编写，但我会这样写，这样更清楚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T03:02:38.677

关于什么：

```
RandomResponder = [A, B, C]
RandomResponder[0].doSomething()   # returns A.doSomething()
RandomResponder[1].doSomething()   # returns B.doSomething()
RandomResponder[2].doSomething()   # returns C.doSomething()
# etc 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T02:01:44.180

如果您指定`args`（不带星号），它只是一个值列表（字符串）。同样，`kwargs`是匹配键（字符串）到值（字符串）的字典。

[这](http://www.saltycrane.com/blog/2008/01/how-to-use-args-and-kwargs-in-python/)是我在谷歌搜索[args kwargs](http://www.google.com/search?q=args+kwargs)之后发现的第一个结果。

编辑：我实际上不太清楚你在寻找什么，所以这只是一个猜测。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T02:32:02.920

你想这样做吗？

```
from responders import A, B, C

class RandomResponder(object)

    def pickAResponder( self, someName ):
        """Use a simple mapping."""
        return  { 'nameA': A, 'nameB': B, 'nameC': C }[someName]

    def __init__(self, *args, *kwargs):
        self.args = args
        self.kwargs = kwargs

    def __getattr__(self, name):
        """pick a responder based on the args[0]"""
        r = self.pickAResponder(self.args[0])
        responder = r(*self.args, **self.kwargs)
        return responder.__getattr__(name) 
```

您的响应者类（A、B、C）只是对象。您可以使用映射、列表、if 语句以及`pickAResponder`方法中所需的任何 Python 编码来操作类。

# c# - 如何使用 XmlConvert 将转换为对象的值类型转换为字符串？

> ID：478659
> 
> 赞同：6
> 
> 时间：2009-01-26T01:47:18.377
> 
> 标签：c#, xml

我正在寻找与下面的代码等效的东西，但是对于任何值类型，而不必为每种数据类型编码 switch 语句。下面的代码无法编译，因为 XmlConvert.ToString() 没有接受和对象的重载。

```
 int intValue = 10;
        object boxedValue = (object)intValue;
        string xmlValue = XmlConvert.ToString(boxedValue); 
```

换句话说，有没有比这更好的方法：

```
public static string ToXmlString(Type type, object value) {

        switch(Type.GetTypeCode(type)) {
            case TypeCode.Int32:
                return XmlConvert.ToString((int) value);
            case TypeCode.DateTime:
                return XmlConvert.ToString((DateTime) value, XmlDateTimeSerializationMode.Unspecified);
            case TypeCode.Boolean:
                return XmlConvert.ToString((bool) value);

            // TODO:  Add case for all other value types!

            default:
                return value.ToString();
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T02:16:37.000

另一种选择是使用 Reflector 查看然后制作 System.Xml.Linq.XContainer.GetStringValue 的副本（不幸的是它是内部的）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T02:04:44.377

所有值类型本质上都是可序列化的。所以你只需要使用一个 XMLSerializer。这样的事情会做到（根据你的方法）：

```
public static string ToXmlString(Type type, object value)
{
    StringBuilder sb = new StringBuilder();
    System.Xml.XmlWriter writer = System.Xml.XmlWriter.Create(sb);
    System.Xml.Serialization.XmlSerializer serial = 
        new System.Xml.Serialization.XmlSerializer(type);
    serial.Serialize(writer, value);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-04T23:13:08.227

作为我想编写的序列化程序的一部分，我必须进行相反的相反转换（字符串到类型）（出于某种原因，避免使用内置序列化程序）。我正在反序列化，这是唯一谈论它的帖子，所以我正在更新我的答案，而它仍然是新鲜的。

我使用的方法是使用反射来基本上解决我需要做的事情。以下示例中的变量类型是我要转换的类型的 Type 对象，E 是我要转换其内容的 XmlNode，newVar 是我要返回的模板类型 T 的实例。这个片段不假设对 T 有任何约束（这就是为什么没有直接的字符串分配/转换）并假设对象/枚举的处理方式不同（对象和枚举打破了这一点）：

```
MethodInfo convertMethod;

if( Type.GetTypeCode(type) != TypeCode.String )
    convertMethod = typeof(XmlConvert).GetMethod ( "To" + type.Name );
else
    convertMethod = E.InnerText.GetType().GetMethod("Clone");

if( convertMethod == null )
{
    //Error
}
else
{
    if( Type.GetTypeCode (type)!= TypeCode.String )
        newVar = (T)convertMethod.Invoke( null, new object[] { E.InnerText } );
    else
        newVar = (T)convertMethod.Invoke ( E.InnerText, new object[]{} );
} 
```

（字符串需要作为特例处理，因为 ToString() 做了一些完全不同的事情并破坏了一切）。

另一种方式（根据原始帖子）将类似于（未经测试，如果我编写序列化函数将更新）：

```
MethodInfo convertMethod;

if( Type.GetTypeCode(type) != TypeCode.String )
    convertMethod = typeof(XmlConvert).GetMethod ( "ToString", new Type[] {typeof(T)} );
else
    convertMethod = typeof(string).GetMethod("Clone");

if( convertMethod == null )
{
    //Error
}
else
{
    string str;
    if( Type.GetTypeCode (type)!= TypeCode.String )
        str = (string)convertMethod.Invoke( null, new object[] { Value } );
    else
        str = (string)convertMethod.Invoke ( Value, new object[]{} );
} 
```

在这种情况下，转换是从 T 到字符串，并且 Value 包含我们要转换的类型 T。不同之处在于我们要求 ToString，但使用 T 类型的一个参数指定函数。这应该足够唯一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T01:50:33.987

只是把它扔在那里，您是否正在尝试将业务对象转换为 XML？

也许您可能想查看 XmlSerialization。如果您在业务对象上标记一些属性，.Net 将为您完成所有花哨的 XML 内容:)。

另外，你有什么理由要拳击你的价值吗？XmlConvert.ToString() 有 19 个重载，其中许多采用原语。

# javascript - 如何根据类名选择偶数或奇数元素

> ID：478660
> 
> 赞同：1
> 
> 时间：2009-01-26T01:48:27.470
> 
> 标签：javascript, mootools

如果你像这样创建 html 布局

```
<ul>
     <li class='a'></li>
     <li class='b'></li>
     <li class='a'></li>
     <li class='b'></li>
     <li class='a'></li>
     <li class='b'></li>
     <li class='a'></li>
     <li class='b'></li>
</ul> 
```

并尝试使用 'a' 类选择奇数元素 $$('.a:odd') 你会得到空数组，如果你这样做 $$('.a:even') 你会得到所有四个 li 元素与'a'类..真的很奇怪..但我是mootools的新手，也许我做错了什么..

所以我的问题是如何选择一个类的第一个和第三个 li 元素。我知道我可以用这样的功能做到这一点

$$('.a').filter(function(item, index) { return index%2; }

但是对于选择奇数或偶数元素这样的小任务来说太复杂了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T02:04:32.257

问题在于 :odd 和 :even （以及它们的 CSS 表亲 :nth-child(odd) 和 :nth-child(even)）指的是元素作为其父级的子级出现的顺序，而不是作为子级的顺序特定的选择器。

这对我有用（原型，但看起来 MooTools 有类似的语法）：

```
var odd = $$('.a').filter(function(item, index) {
    return index % 2 == 0;
});
var even = $$('.a').filter(function(item, index) {
    return index % 2 == 1;
}); 
```

编辑：看来您已经在问题中涵盖了这一点，请在完全阅读之前回答我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T02:00:46.337

如果你想获得第一个和第三个，你只需要 $$('.a')。

您是否要获得第 1 项和第 5 项？这将类似于 $$('a:nth-child(4n+1))

我假设 mootools 使用[css3 结构伪类](http://www.w3.org/TR/css3-selectors/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T19:14:29.287

:nth-child 伪选择器查看 DOM 元素的[（非零索引）索引](http://www.w3.org/TR/css3-selectors/#structural-pseudos)，而不是在选定（匹配）元素内。MooTools 添加了[':odd'](http://mootools.net/docs/core/Utilities/Selectors#Selector:odd)选择器来选择 'real' 奇数元素，因此索引从 0 开始。

因此，在您的示例中，选择“.a:nth-child(odd)”将返回所有 li.a 元素，因为索引从 1 开始。选择“.a:odd”不会选择任何内容，因为没有“真正的”奇数li.a 元素。

您可能想要的是选择[':nth-of-type'](http://www.w3.org/TR/css3-selectors/#nth-of-type-pseudo)元素。所以选择 '.a:nth-of-type(odd)' 将返回所有奇数的 li.a 元素（第一个和第三个 - 它使用 DOM 元素的索引）。

MooTools 默认不支持 ':nth-of-type' 选择器，但您可以使用 Selectors.Pseudo 类扩展选择器引擎（目前找不到示例）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-26T02:16:24.167

**没眼皮**，所以你说这不是虫子？它应该工作的方式？

# networking - 如果一个站点出于冗余原因有 2 个负载均衡器，DNS 应该指向哪一个？

> ID：478664
> 
> 赞同：4
> 
> 时间：2009-01-26T01:53:04.543
> 
> 标签：networking, dns, load-balancing, infrastructure

如果我在我的 DNS 记录中简单地指向两者，那么 50% 的流量不会也有问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T13:35:08.027

有许多简单的方法可以使用一个 IP 地址提供弹性服务，而无需花费大量资金。

例如，您可以将公共 IP 地址配置到每个代理服务器的环回接口上，然后通过 OSPF 路由协议（或类似协议）将其发布到您的内部路由表中。

如果服务器完全死机，路由将从您的内部路由表中撤消，并且流量会在 30 秒内自动停止流向死机服务器。

*在大多数网络中，这种解决方案不需要任何*成本。如果您的代理运行 Linux 或其他一些 UNIX 变体，则可以使用[Quagga完成 OSPF 路由。](http://www.quagga.net/)

您的内部网络也需要能够使用 OSPF，但大多数 Cisco 或 Juniper 类硬件都是开箱即用的。您*正*计划运行一些相当不错的网络设备来支持这数千个站点，不是吗 ;-) ？

FWIW，我过去曾使用过类似的技术来处理从一个数据中心到另一个数据中心的大规模共享网络托管的故障转移。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T02:00:50.737

您可以在您的 DNS 中同时指向这两者。当其中一个出现故障时，用户的浏览器会发出请求，发现有问题并请求新的 A 记录。第二个 A 记录应该是有效的并且仍在工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T02:17:53.743

有很多方法可以看待这一点。当您开始查看这些类型的东西时，您可能会看到诸如“主动-主动”或“主动-被动”设置之类的术语。

您所描述的是“主动-主动”设置，其中主要和“故障转移”硬件都在满足客户的需求。主动-被动通常意味着有一些手动部分可以从“主动”服务器故障转移到备用“被动”服务器。

任何一种配置都是完全合法的，您问题的正确答案实际上归结为对您个人情况的分析。需要考虑的事项： 1\. 两个硬件是否等效？（即：无论您的客户通过您的基础设施采用哪条路径，他们是否都会拥有相同的体验）。

2.  是否值得一直运行这两个实例的成本？

3.  故障转移期间停机时间有什么影响？（即：你会宕机多久？这样的中断会让你付出多少代价）。

4.  您的维护过程（升级、备份）的元素是否对主动-主动有用？（即：升级负载均衡器后面的服务器上的软件，升级负载均衡器本身等）。在这些场景中，您需要从一对中拉出一个成员，进行升级工作，然后在升级第二个成员时将流量重新路由到升级后的成员。

一般来说，主动-主动的成本更高，但对客户的影响风险最小。因此，“正确”的答案更多地与业务方面有关，而不是技术方面。

现在，如果所有事情都不相同，您可能需要查看以下内容：

1.  每个平衡器上的预先存在的（不是您的应用程序）负载。

2.  每个硬件/容量。

3.  年龄（一个人接近生命的尽头，还是可能很快就会失败？）

4.  位置（如果您说的是多数据中心……地理位置可能会影响性能）。

我知道我没有给你一个“做这个”的答案......但希望我已经提供了一些关于你在得到答案时会考虑的类型的见解。

# iphone - 链接到 WebView 中的资源 - iPhone

> ID：478665
> 
> 赞同：18
> 
> 时间：2009-01-26T01:53:04.790
> 
> 标签：iphone, html, resources, hyperlink, webview

我的 iPhone 应用程序中有一个 webview，我的 Resources 文件夹中也有一些 html 文件。当我的应用程序加载时，我将一个页面从我的资源加载到我的 web 视图中。但是，我需要在我的 webview 中创建指向其他资源（例如，图像或其他 html 文件）的链接。仅仅做一个相对链接是行不通的：

```
<a href="OtherPage.html">Doesn't work</a> 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-09-08T21:02:21.643

显然，根据[iPhone SDK Release Notes for iPhone OS 3.0](http://developer.apple.com/iphone/library/releasenotes/General/RN-iPhoneSDK-3/index.html)有一些问题：

> **问题：** UIWebView 无法在针对 3.0 构建的应用中加载本地资源。
> 
> 使用`[UIWebView loadHTMLString:baseURL:]`时，HTML 字符串不应使用该`file://`方案引用本地资源。取而代之的是，传入`NULL`或 的`file://` URL ，或使用和标记`baseURL:`直接在 HTML 中包含资源 。`<style>``<script>`

很公平。但是传递一个标准问题的`file://`URL`baseURL`并不完全有效。但是...事实证明，如果您`/`将`//`和空格更改为`%20`，您将被设置！（使用`%20`很有意义，但双斜线部分让我感到惊讶。）

假设您已经`NSString *markup`设置好了。这就是你所做的一切。（为了便于阅读，我将代码打包在这里。您可能希望重构/调整以适应口味。）

```
 NSString *resourcePath = [[[[NSBundle mainBundle] resourcePath]
     stringByReplacingOccurrencesOfString:@"/" withString:@"//"]
     stringByReplacingOccurrencesOfString:@" " withString:@"%20"];
 [webView loadHTMLString:markup baseURL:[NSURL URLWithString:
     [NSString stringWithFormat:@"file:/%@//", resourcePath]]]; 
```

只要您的 CSS、JavaScript 和图像仅由文件名引用，这在 iPhone OS 3.0 中应该可以解决`loadHTMLString:baseURL:`问题！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-26T02:12:07.593

加载这些资源时，您需要设置基本 URL。您可以使用以下方法执行此操作：

```
- (void)loadHTMLString:(NSString *)string baseURL:(NSURL *)baseURL 
```

...其中 baseURL 将是您的资源文件夹的文件 URL。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-26T20:48:51.940

我修复了它：我将它用于 BaseURL，就像 August 说的：

```
NSString *path = [[NSBundle mainBundle] bundlePath];
NSURL *baseURL = [NSURL fileURLWithPath:path]; 
```

谢谢！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-26T06:02:24.087

此代码将返回一个字符串，其中包含您的包资源目录中名为“OtherPage.html”的文件的 URL。

```
[[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"OtherPage" ofType:@"html"]] absoluteString] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-26T13:34:53.770

这对我有用。我的 HTML 文件位于项目的子文件夹（不是组）中。我的html页面称为page01，子文件夹是html：

```
NSString *resourcePath = [[NSBundle mainBundle] resourcePath];
NSString *pathToHtml = @"html";
NSURL *baseURL = [[NSURL alloc] initFileURLWithPath:pathToHtml isDirectory:YES];

NSString *html = [NSString stringWithContentsOfFile:[[NSBundle mainBundle]    
                             pathForResource:@"page01" ofType:@"html"                                                               
                             inDirectory:@"html"] 
                         encoding:NSUTF8StringEncoding error:nil];
[webview loadHTMLString:html baseURL:baseURL]; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-26T03:08:17.650

尝试先加载 OtherPage.html。如果你不能，那么它就不存在，并且你错过了将它添加到项目中的某些部分。如果可以，那么可能只是链接中有错字，或者 baseURL 可能不正确，如 August 所述。当我创建一个包含资源文件中图像的 html 文件时，只需使用它就可以正常工作

```
<img src="file.png"> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T02:13:46.950

看看Phonegap是如何做到的。[这是他们关于 iPhone 上本地资源的教程](http://phonegap.pbwiki.com/Building+A+Self-Contained+Application+(iPhone))。第 11 步可能是您忽略的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-26T03:16:12.270

也许它确实与baseurl有关：当我加载资源时，我使用这一行：

```
[webView loadData:htmlData MIMEType:@"text/html" textEncodingName:@"UTF-8" baseURL:[NSURL URLWithString:@""]]; 
```

看到最后，它说baseURL：“”。如果我把它拿出来，它就不起作用（崩溃），但我不知道我的资源的路径。如果有人这样做......？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-12-19T15:10:03.807

对我来说，问题是 js 文件不包含在包中。一定要检查一下。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-15T23:17:45.950

好的，3.5 年后在这里 :) ... 完全尝试了 Michael Gaylord 的上述建议，但它不适用于 5.0、5.1、6.0、6.1 的模拟人生 - 也不适用于运行相同的真实设备。**然而**，这个关于资源捆绑位置的 SO 澄清（[构建输出在哪里？](https://stackoverflow.com/questions/5341496/where-is-build-output-going/5342176#5342176)）帮助它像这样为我工作：

1.  在项目中创建一个 Finder 文件夹（正如迈克尔建议的那样 - 我也没有尝试“组”）
2.  使用 Finder 将您的 html 放入该文件夹
3.  在 Xcode 中使用*文件*->*将文件添加到项目中*
4.  确保项目通过以下方式识别它应该在捆绑包中：

    5.  右键单击*导航器*窗口中的主项目目标，
    6.  确保选择了 TARGETS，*Build Phases*选项卡，
    7.  单击*复制捆绑资源*三角形的东西 |>
    8.  而且 -**这与迈克尔的不同** - 它应该已经显示了您的 html 文件和路径。（也许 XCoders 改进了添加文件 AI :)

所以我所要做的就是复制 - 将迈克尔的代码*逐字*粘贴并更改这一行：

```
 inDirectory:@"html"] 
```

到：

```
 inDirectory:nil] 
```

和***沙赞***！有效 ：）

# c++ - 使用多态档案促进序列化

> ID：478668
> 
> 赞同：10
> 
> 时间：2009-01-26T01:58:45.047
> 
> 标签：c++, serialization, boost

我正在开发一个客户端-服务器应用程序，该应用程序使用 boost::serialization 库来满足其序列化需求。

我需要序列化和反序列化似乎不起作用的多态对象。文档确实说它是受支持的，但没有一个相关示例演示我在这里尝试做的事情。所以，我不太确定。我的问题是可以使用 boost 序列化/反序列化多态对象吗？如果是，我在这里做错了什么？

谢谢！

代码：

```
using namespace std;  

class base {  
  public:
    int data1;  

    friend class boost::serialization::access;  

    void serialize(boost::archive::polymorphic_iarchive & ar, 
                   const unsigned int file_version) {  
        ar & data1;  
    }  

    void serialize(boost::archive::polymorphic_oarchive & ar, 
                   const unsigned int file_version){  
        ar & data1;  
    }  

  public:  
    base() {};  
    base(int _d) : data1(_d) {}  
    virtual void foo() const {std::cout << "base" << std::endl;}  
};  

class derived : public base {  
  public:  
    int data2;  

    friend class boost::serialization::access;  

    void serialize(boost::archive::polymorphic_iarchive & ar, 
                   const unsigned int file_version) {  
        ar & boost::serialization::base_object<base>(*this) & data2;  
    }  

    void serialize(boost::archive::polymorphic_oarchive & ar, 
                   const unsigned int file_version){  
        ar & boost::serialization::base_object<base>(*this) & data2;  
    }  

  public:  
    derived() {};  
    derived(int _b, int _d) : base(_b), data2(_d) {}  
    virtual void foo() const {std::cout << "derived" << std::endl;}  
};  

int main(int argc, char *argv[]) {  
    // client  
    const base *b1 = new derived(1, 2);  

    std::ostringstream oss;  
    boost::archive::polymorphic_text_oarchive oa(oss);  
    oa << *b1;  

    // server  
    base *b2 = new derived(3, 4);  

    std::istringstream iss(oss.str());  
    boost::archive::polymorphic_text_iarchive ia(iss);  
    ia >> *b2;  

    // prints 1, ok  
    cout << b2->data1 << endl;  

    // prints 4, why wasn't the derived class data written?
    cout << (dynamic_cast<derived*>(b2))->data2 << endl;  

    return 0;  
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-26T08:38:25.923

找到了解决办法。我必须使用以下语句导出派生类：

```
BOOST_CLASS_EXPORT(derived); 
```

发布一些可以进行一些更正的东西。

```
using namespace std;  

class base {  
  public:  
    int data1;  

    friend class boost::serialization::access;  

    template<typename Archive>  
    void serialize(Archive & ar, const unsigned int file_version) {  
        ar & data1;  
    }  

  public:  
    base() {};  
    base(int _d) : data1(_d) {}  
    virtual void foo() const {std::cout << "base" << std::endl;}  
};  

class derived : public base {  
  public:  
    int data2;  

    friend class boost::serialization::access;  

    template<typename Archive>  
    void serialize(Archive & ar, const unsigned int file_version) {  
        ar & boost::serialization::base_object<base>(*this);  
        ar & data2;  
    }  

  public:  
    derived() {};  
    derived(int _b, int _d) : base(_b), data2(_d) {}  
    virtual void foo() const {std::cout << "derived" << std::endl;}  
};  

BOOST_CLASS_EXPORT(derived);  

int main(int argc, char *argv[]) {  
    // client  
    // Assign to base type  
    std::unique_ptr<const base> b1(new derived(1, 2));  

    std::ostringstream oss;  
    boost::archive::text_oarchive oa(oss);  
    oa & b1.get();   

    // server  
    // Retrieve derived type from base  
    std::unique_ptr<base> b2;

    std::istringstream iss(oss.str());
    boost::archive::text_iarchive ia(iss);
    {
        base *temp; 
        ia & temp;
        b2.reset(temp);
    }
    cout << b2->data1 << endl;  
    cout << (dynamic_cast<derived*>(b2.get()))->data2 << endl;  

    return 0;  
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T11:57:07.887

只是一些评论...

首先，您可以使用相同的操作使用模板版本进行序列化和反序列化：

```
template<class Archive>
void load(Archive & ar, const unsigned int version)
{
   ...
} 
```

此外，除了宏，您可以“配置”存档以期望那些被识别为指针的类型：

```
ar.register_type(static_cast<your_static_type_here *>(NULL)); 
```

# sql - SQL父/子递归调用或联合？

> ID：478671
> 
> 赞同：5
> 
> 时间：2009-01-26T02:00:54.543
> 
> 标签：sql, sql-server, tsql, sybase

我似乎找不到相关的例子。

我试图返回一个表的子集，对于该表中的每一行，我想检查它有多少个孩子，并将该数字作为结果集的一部分返回。

父表列：PK_ID、Column1、Column2、FK1

对于结果集中的每个 FK1，从 child_table 中选择 count(*)。

最终结果集

3, col1text, col2text, 1(child)
5, col1texta, col2texta, 2(child)
6, col1textb, col2textb, 0(child)
9, col1textc, col2textc, 4(child)

我正在努力寻找在另一个查询中引用结果集中的列的最佳方法，然后再次将它们连接在一起。使用 T-sql

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-26T02:06:16.310

好的，显然，基于对另一个答案的支持，这需要进一步解释。示例（使用 MySQL 完成，因为我很方便，但该原理对任何 SQL 方言都是通用的）：

```
CREATE TABLE Blah (
  ID INT PRIMARY KEY,
  SomeText VARCHAR(30),
  ParentID INT
)

INSERT INTO Blah VALUES (1, 'One', 0);
INSERT INTO Blah VALUES (2, 'Two', 0);
INSERT INTO Blah VALUES (3, 'Three', 1);
INSERT INTO Blah VALUES (4, 'Four', 1);
INSERT INTO Blah VALUES (5, 'Five', 4); 
```

左连接版本：

```
SELECT a.ID, a.SomeText, COUNT(1)
FROM Blah a
JOIN Blah b ON a.ID= b.ParentID
GROUP BY a.ID, a.SomeText 
```

错误的。忽略没有孩子的情况。

**左外连接：**

```
SELECT a.ID, a.SomeText, COUNT(1)
FROM Blah a
LEFT OUTER JOIN Blah b ON a.ID= b.ParentID
GROUP BY a.ID, a.SomeText 
```

错误的原因有些微妙。 `COUNT(1)`计算`NULL`行数`COUNT(b.ID)`，而不计算行数。所以上面是错误的，但这是正确的：

```
SELECT a.ID, a.SomeText, COUNT(b.ID)
FROM Blah a
LEFT OUTER JOIN Blah b ON a.ID= b.ParentID
GROUP BY a.ID, a.SomeText 
```

**相关子查询：**

```
SELECT ID, SomeText, (SELECT COUNT(1) FROM Blah WHERE ParentID= a.ID) ChildCount
FROM Blah a 
```

也正确。

好的，那么使用哪个？计划只能告诉你这么多。[子查询与左连接](http://forums.devshed.com/postgresql-help-21/performance-question-left-join-vs-sub-query-60848.html)的问题是一个古老的问题，如果不进行基准测试就没有明确的答案。所以我们需要一些数据：

```
<?php
ini_set('max_execution_time', 180);

$start = microtime(true);

echo "<pre>\n";

mysql_connect('localhost', 'scratch', 'scratch');
if (mysql_error()) {
    echo mysql_error();
    exit();
}
mysql_select_db('scratch');
if (mysql_error()) {
    echo mysql_error();
    exit();
}

$count = 0;
$limit = 1000000;
$this_level = array(0);
$next_level = array();

while ($count < $limit) {
    foreach ($this_level as $parent) {
        $child_count = rand(0, 3);
        for ($i=0; $i<$child_count; $i++) {
            $count++;
            query("INSERT INTO Blah (ID, SomeText, ParentID) VALUES ($count, 'Text $count', $parent)");
            $next_level[] = $count;
        }
    }
    $this_level = $next_level;
    $next_level = array();
}

$stop = microtime(true);
$duration = $stop - $start;
$inserttime = $duration / $count;

echo "$count users added.\n";
echo "Program ran for $duration seconds.\n";
echo "Insert time $inserttime seconds.\n";
echo "</pre>\n";

function query($query) {
    mysql_query($query);
    if (mysql_error()) {
        echo mysql_error();
        exit();
    }
}
?> 
```

我在这次运行期间内存不足（32M），所以最终只得到了 876,109 条记录，但嘿，它会的。后来，当我测试 Oracle 和 SQL Server 时，我采用完全相同的数据集并将其导入 Oracle XE 和 SQL Server Express 2005。

现在另一位发帖人提出了我在查询周围使用计数包装器的问题。他正确地指出，在这种情况下优化器可能不会执行子查询。MySQL 似乎没有那么聪明。甲骨文是。SQL Server 似乎也是如此。

因此，我将为每个数据库查询组合引用两个数字：第一个包含在 中`SELECT COUNT(1) FROM ( ... )`，第二个是原始的。

**设置：**

*   MySQL 5.0 使用 PremiumSoft Navicat（`LIMIT 10000`查询中）；
*   SQL Server Express 2005 使用 Microsoft SQL Server Management Studio Express；
*   使用 PL/SQL Developer 7 的 Oracle XE（限制为 10,000 行）。

**左外连接：**

```
SELECT a.ID, a.SomeText, COUNT(b.ID)
FROM Blah a
LEFT OUTER JOIN Blah b ON a.ID= b.ParentID
GROUP BY a.ID, a.SomeText 
```

*   **MySQL：** 5.0：51.469s / 49.907s
*   **SQL Server：** 0 ^((1)) / 9s ^((2))
*   **Oracle XE：** 1.297s / 2.656s

(1) 几乎是瞬时的（确认不同的执行路径）
(2) 令人印象深刻的是它返回所有行，而不是 10,000

只是去展示一个真实数据库的价值。此外，删除 SomeText 字段对 MySQL 的性能有重大影响。此外，10000 的限制与 MySQL 没有它之间没有太大区别（性能提高了 4-5 倍）。Oracle 之所以拥有它，是因为 PL/SQL Developer 在内存使用量达到 100M 时大吃一惊。

**相关子查询：**

```
SELECT ID, SomeText, (SELECT COUNT(1) FROM Blah WHERE ParentID= a.ID) ChildCount
FROM Blah a 
```

*   **MySQL：** 8.844s / 11.10s
*   **SQL Server：** 0s / 6s
*   **甲骨文：** 0.046s / 1.563s

所以 MySQL 要好 4 到 5 倍，Oracle 的速度大约是前者的两倍，而 SQL Server 可以说只快一点点。

重点仍然存在：**相关子查询版本在所有情况下都更快。**

相关子查询的另一个优点是它们在语法上更清晰且更易于扩展。我的意思是，如果您想在一堆其他表中进行计数，每个表都可以干净轻松地作为另一个选择项包含在内。例如：想象一下客户对发票的记录，其中这些发票要么未付，要么逾期，要么已付。使用简单的子查询：

```
SELECT id,
  (SELECT COUNT(1) FROM invoices WHERE customer_id = c.id AND status = 'UNPAID') unpaid_invoices,
  (SELECT COUNT(1) FROM invoices WHERE customer_id = c.id AND status = 'OVERDUE') overdue_invoices,
  (SELECT COUNT(1) FROM invoices WHERE customer_id = c.id AND status = 'PAID') paid_invoices
FROM customers c 
```

聚合版本更丑陋。

现在我并不是说子查询总是优于聚合连接，但它们通常足以让您对其进行测试。根据您的数据、该数据的大小和您的 RDBMS 供应商，差异可能非常显着。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T02:06:23.033

我*相信*这就是你想要做的：

```
SELECT P.PK_ID, P.Column1, P.Column2, COUNT(C.PK_ID)
FROM
    Parent P
    LEFT JOIN Child C ON C.PK_ID = P.FK1
GROUP BY
    P.PK_ID, P.Column1, P.Column2 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T04:35:04.777

**解释为什么@cletus 是错误的。**

首先，做研究的道具。

其次，你做错了。

解释：

原始查询：

```
EXPLAIN
SELECT ID, (SELECT COUNT(1) FROM Blah WHERE ParentID= a.ID) as ChildCount
FROM Blah a 
```

结果：

```
    “在 blah a 上进行 Seq 扫描（成本=0.00..145180063607.45 行=2773807 宽度=4）”
    “子计划”
    “ -> 聚合（成本=52339.61..52339.63 行=1 宽度=0）”
    “ -> 对 blah 的 Seq 扫描（成本=0.00..52339.59 行=10 宽度=0）”
    " 过滤器: (parentid = $0)"

```

当你包装在 "select count(1)" 时会发生什么：

```
EXPLAIN SELECT count(1) FROM (
SELECT ID, (SELECT COUNT(1) FROM Blah WHERE ParentID= a.ID) as ChildCount
FROM Blah a) as bar 
```

```
    “聚合（成本=52339.59..52339.60 行=1 宽度=0）”
    “ -> 在 blah a 上进行 Seq 扫描（成本=0.00..45405.07 行=2773807 宽度=0）”

```

注意到区别了吗？

优化器足够聪明，可以看到它不需要执行子查询。所以并不是相关的子查询很快；就是不这样做很快:-)。

不幸的是，它不能对左外连接做同样的事情，因为结果的数量不是由第一次扫描预先确定的。

**第 1 课：** 查询计划告诉你很多。糟糕的实验设计会给你带来麻烦。

**第 1.1 课：**如果您不需要加入，请务必不要。

我创建了一个包含大约 270 万个查询的测试数据集。

左外连接（没有包装器）在我的笔记本电脑上运行了 171,757 毫秒。

相关子查询...完成后我会更新，我在 700K ms 并且它仍在运行。

**第 2 课：**当有人告诉您查看查询计划并声称它显示了算法顺序的差异时……查看查询计划。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-03T05:50:02.723

您是否曾经尝试为 MySQL 的父 ID 添加索引。我很确定执行时间会大大改善。尚未测试，但我会说 MySQL 会遍历所有行来确定计数。这意味着它在这 59 秒内进行了 10 - 400 亿（表中的行数 * 10000）的查找。

假设 SQL Server 和 Oracle 即时创建索引。如果他们这样做，那将只有 1 到 400 万。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-02T06:17:25.210

您的查询都假定输入父子节点的顺序是连续的。如果最后输入了来自第一个节点之一的子节点，并且其 ID 或 PK 较高，则查询不起作用。

# c# - 在 C# 中显示继承的接口实现的最佳方式是什么？

> ID：478684
> 
> 赞同：3
> 
> 时间：2009-01-26T02:12:43.393
> 
> 标签：c#, interface

给定以下接口：

```
interface IFoo
{
    void Foo();
}

interface IBar : IFoo
{
    void Bar();
} 
```

指示给定类实现的最佳方法是什么`IBar`？

### 方法一：

```
class Implementation : IBar { ... } 
```

这看起来更简单、更干净，但并不表示`Implementation`实现`IFoo`.

### 方法 B：

```
class Implementation : IBar, IFoo { ... } 
```

这似乎是最有用的信息，但额外的信息真的有必要吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-26T02:18:52.603

编译器不需要额外的信息，但它可能对您的代码的读者有帮助，因为读者不必知道`IBar`extends `IFoo`。框架中的一个例子是`List<T>`实现`<IList<T>`,`ICollection<T>`和`IEnumerable<T>`, 即使`IList<T>`; 扩展`ICollection<T>`和`IEnumerable<T>`。

**编辑**：我认为，至少对我来说，我列出两者的主要原因是您通常不会想到接口相互继承。当你从一个类派生时，你期望你继承的行为本身可能被继承。如果您有兴趣，请按照类层次结构的派生。使用接口，派生接口是更不寻常的，因此您不太可能查看并且更有可能错过连接。将它们都列出来解决这个问题没有太多痛苦。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-26T02:23:14.810

我个人会选择前者。对于后者，假设您处于这种情况下，您有一堆派生类：

```
class DerivedA : Implementation, IBar, IFoo { ... }
class DerivedB : Implementation, IBar, IFoo { ... }
class DerivedC : Implementation, IBar, IFoo { ... }
class DerivedD : Implementation, IBar, IFoo { ... } 
```

然后您对`Implementation`更改的要求，以便它现在需要实现另一个接口，例如`IBaz`（只要它提供非抽象实现，它就可以在不影响任何派生类的情况下做到这一点），那么您有两个选择：

1.  在没有明确声明新接口信息的情况下保留所有派生类定义，在这种情况下，根据标准，类定义现在是不正确的，如果人们期望始终遵循标准，则可能会产生误导。

2.  去查找所有派生类，以及它们的所有派生类，并修复它们的声明。这需要时间，有点容易出错并且很难完全完成，并且会将您的单个文件更改变成多文件签入。

这些选项都没有吸引力，所以我会选择不会让你处于任何一种情况的选项。只需声明最派生的接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T02:17:22.620

我会选择 A。您会看到需要在类本身中实现哪些方法，IDE 中的导航工具将帮助您完成其余的工作。

B 在进行任何重构时将无法维护（例如，如果替换 IBar 或将其拆分为 2 会发生什么？）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T03:26:33.323

您已经实现的事实`IFoo`意味着`IBar`您甚至不需要指定您的具体实现类实现`IFoo`；CLR 可以推断出这一点，如果您在程序集上使用反射器，您会看到它指定`Implementation`实现这两者`IFoo`，`IBar`即使您使用方法 A。

所以方法A就是这样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T02:20:55.483

我认为方法 A 足够清楚，因为（无论如何在 VS.NET 中）您可以非常快速地确定 IBar 实现了 IFoo。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T02:26:10.543

除了可读性和[VB.NET](http://weblogs.asp.net/cnagel/archive/2004/05/09/128659.aspx)中的差异（参见 Kathleen Dollard 的评论）之外，还有一种情况需要数据绑定（B）。细节已经让我忘记了（除非有人打败我，否则我会编辑......）。

我认为这就是 .NET Framework 集合显式实现其派生接口的原因。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T16:12:39.673

我会选择方法 A 仅仅是因为在类定义的派生列表中列出一个接口意味着您正在该类中提供一个实现。如果您不打算提供 IFoo 的替代实现，那么我不会将它包含在列表中，除非您需要它作为简单的“标记接口”。然而，即便如此，在运行时“is”运算符（返回 true 或 false）或“as”关键字（返回对象或 null）会告诉您是否可以将对象强制转换为 IFoo。

# matlab - MatLab 中的软件包适合初学者吗？

> ID：478686
> 
> 赞同：0
> 
> 时间：2009-01-26T02:15:01.253
> 
> 标签：matlab, modeling

我需要 MatLab 进行 2D 和 3D 建模。

我在 MatLab 方面的经验很少。我应该先学习哪些软件包才能在 MatLab 中学习建模？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T02:23:07.883

你看过[虚拟现实工具箱](http://www.mathworks.com/access/helpdesk/help/toolbox/vr/vr_product_page.html)吗？

# algorithm - 找到给定年份的第 0 天的星期几的最简单算法是什么？

> ID：478694
> 
> 赞同：12
> 
> 时间：2009-01-26T02:21:31.303
> 
> 标签：algorithm, date, calendar

我试图弄清楚给定年份的第 0 天（1 月 1 日）的星期几。

到目前为止，我已经查看了 Wikipedia 页面“[计算星期几](http://en.wikipedia.org/wiki/Calculating_the_day_of_the_week)”，但我想知道如果您只是想找到零天，是否有最简单的算法。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-26T06:39:43.370

这是一个简单的单线。我已经使用 Excel 验证了 1901-2200 年的所有年份，以及使用 Python 的 1582-3000 年的`datetime`.

```
dayOfWeek = (year*365 + trunc((year-1) / 4) - trunc((year-1) / 100) +
             trunc((year-1) / 400)) % 7 
```

这将使星期几为 0 = 星期日，6 = 星期六。这个结果可以很容易地通过在模 7 之前或之后添加一个常数来调整。例如，为了匹配 Python 的 0 = Monday 的约定，在模之前添加 6。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-25T05:42:57.583

```
int dayofweek(y, m, d)      /* 0 = Sunday */
int y, m, d;                /* 1 <= m <= 12,  y > 1752 or so */
{
    static int t[] = {0, 3, 2, 5, 0, 3, 5, 1, 4, 6, 2, 4};
    y -= m < 3;
    return (y + y/4 - y/100 + y/400 + t[m-1] + d) % 7;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-26T02:31:28.600

大多数语言都提供了表示和操作日期的工具......我会依赖这些工具而不是实现一些（可能不完整的）算法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-30T21:54:08.200

```
day = (((year - 1) * 365) + ((year - 1) / 4) - ((year - 1) / 100) + ((year) / 400) + 1) % 7; 
```

给定年份，这将找到 1 月 1 日的星期几，其中星期日是 0，星期六是 6

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-28T22:10:47.130

```
public String DayOfWeek()
{
    int dayofweek;
    int c,y,m,d; 
    int cc,yy;
    String dayString;
    //Im using the guassian algorithm for finding day of the week 
    cc = year/100;
    yy = year - ((year/100)*100);

    c = (cc/4) - 2*cc-1;
    y = 5*yy/4;
    m = 26*(month+1)/10;
    d = day;

    dayofweek = (c+y+m+d)%7;

    switch(dayofweek)
    {
        case 0: dayString = "Sunday";
        break;
        case 1: dayString = "Monday";
        break;
        case 2: dayString = "Tuesday";
        break;
        case 3: dayString = "Wednesday";
        break;
        case 4: dayString = "Thursday";
        break;
        case 5: dayString = "Friday";
        break;
        case 6: dayString = "Saturday";
        break;
        default: dayString = "Sorry Could not compute month :(";   
    }

    return dayString;
} 
```

上面的代码是用 Java 编写的，

不知道为什么会起作用，但我在 Google 搜索的深处发现了该算法，并迅速将其用于我的项目。你在上面看到的是我必须为我在大学 Java 课上做的一个项目编写的方法，所以它是我写的，但算法不是我自己的。

如果时间，这种方法保证 100% 有效，我在整个历史中尝试了多天并查找它们以确认正确的答案是通过这种方法找到的答案。

> 让日期为 DD/MM/CCYY（欧洲格式），其中 DD 是月份中的日期，MM 是月份，CC 是世纪数字，YY 是世纪内的年份。所以威尔玛的生日是 1994 年 6 月 23 日。从世纪 CC 位开始，计算 CC/4 - 2*CC-1 并记住结果。对于本练习中的所有除法，丢弃任何剩余部分，只保留整个部分。因此，在我们的示例中，这是 19/4=4 减去 2*19=38 减去 1，得出负 35。
> 
> 现在，使用年份 YY，计算 5*YY/4。在此示例中，即 5*94 = 470/4 = 117，丢弃余数。将此添加到我们现有的结果中得到 117-35 = 82。
> 
> 使用月份 MM，计算 26*(MM+1)/10。在我们的示例中，这是 26*7 = 182 / 10 = 18，再次丢弃余数。将此添加到我们的运行总数中，得到 82+18 = 100。
> 
> 最后只添加一天DD。这里 100 + 23 = 123。
> 
> 现在将结果除以 7，只保留余数；这里 123(mod 7) = 4。把星期日算为零，星期一 = 1 等等，我们得到 4 = 星期四。很容易，当你知道怎么做的时候:-)
> 
> 该算法归功于高斯。是的，我知道犹太人和穆斯林等人有不同的日历，我也知道各种日历改革，所以这只适用于现代基督教标准化的日期，不要用它来检查基督受难的日子（ -小说？）甚至乔叟的出生。
> 
> 如果你不能像心算一样做到这一点（因此在酒吧赢得啤酒），请随意使用铅笔和纸（或计算器）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-11T09:59:22.430

```
 #!/usr/local/bin/perl 
     use integer
     %day=                 (0=>Sunday,1=>Monday,2=>Tuesday,3=>Wednesday,4=>Thursday,5=>Friday,6=>Saturday);
     print("entered date is");
     $day=30;
     $month=11;
     $year=2680;
     $x=&day_of_week($year,$month,$day);
     if($day>31||$month>12)
{
    print("this date doesn't exist \n");
    exit;
}

    if($year%400 ==0 || ($year%100 != 0 && $year%4 == 0))
{
    if($day>29&&$month==2)
    {
        printf("this date dosen't exist \n");
        exit;
    }
}
   if($month==(4,6,9,11)&&$day>30)
{
        printf("this date dosen't exist \n");
        exit;
}

     sub day_of_week{
my ($year,$month,$day)=@_;
print("yy/mm/dd: $year/$month/$day\n");
my  $a=(14-$month)/12;
my  $y=$year-$a;
my  $m=$month+12*$a-2;
my  $d=($day+$y+$y/4-$y/100+$y/400+31*$m/12)%7;
return $d;
}
if(exists($day{$x}))
{
    print("$day{$x}\n");
}
else
{
    print("invalid date entered\n");
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-23T19:50:21.503

MATLAB 程序：

函数 w = week_day(m,d,cy)

如果 m > 2，则 m = m-2；否则，m = m+10；cy = cy-1；结尾;

c = 修复（cy/100）；y = mod(cy,100);

w = mod(d+fix(m*2.59)+fix(y*1.25)+fix(c*5.25),7);

* * *

诀窍是将 3 月 1 日作为一年的第一天。不管日期是否在闰年。

例子：

```
 w = week_day(01,23,2016)  --->   w = 6 {Sat)    Today
   w = week_day(12,31,1999)  --->   w = 5 {Fri)    
   w = week_day(01,01,2000)  --->   w = 6 {Sat)
   w = week_day(02,28,1900)  --->   w = 3 {Wed)    not leap year
   w = week_day(03,01,1900)  --->   w = 4 {Thu)
   w = week_day(02,29,2000)  --->   w = 2 {Tue)      leap year
   w = week_day(03,01,2000)  --->   w = 3 {Wed) 
```

请参阅 Mathwork 文件交换文件 ID #54784

冯成昌

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-26T02:27:14.833

维基百科页面底部的“计算星期几”给出了您需要的规则。您还可以通过硬编码月份和月份的日期来简化 Zeller 的一致性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-26T02:56:52.870

年份以 28 年为周期重复。将年份除以 28 并返回相应的星期几（星期几值存储在数组/向量中）。这将是*最快*和最简单的算法。但是对于阅读代码的人来说，这个算法根本不清楚。您的选择取决于您想要快速、简单还是“明确正确”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-01-16T13:24:58.093

如果日期是 DD/MM/CCYY，您需要计算给定日期的日期。然后使用给定的公式 [{(CC/4)-2*CC -1}+(YY*5/4)+{(MM+1)*26/10} + DD]= x, x/7=Y其中 Y 是余数，其中 Y 可以是 0、1、2、3、4、5、6。其中 0 可以代表星期日，1 代表星期一，2 代表星期二，3 代表星期三等等。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-01-26T02:33:42.510

您可以始终保留参考日期，然后添加一年中的天数（mod 7）以保持运行记录，但就像 Zach 所说，使用内置函数会更容易。

# .net - 在 .NET 中创建 vista 样式控件

> ID：478709
> 
> 赞同：0
> 
> 时间：2009-01-26T02:36:08.137
> 
> 标签：.net, windows-vista

好的，我想一劳永逸地知道这一点，如何从 .NET 中创建“vista 样式”控件？我正在使用 .NET 3.5 SP1。

我试图生成的最重要的控件是新的增强消息对话框，如下所示：
[alt text http://i.msdn.microsoft.com/Aa511268.Dialogs23a(en-us,MSDN.10).png](http://i.msdn.microsoft.com/Aa511268.Dialogs23a(en-us,MSDN.10).png)

我正在尝试遵循此处制定的指南（[http://msdn.microsoft.com/en-us/library/aa511268.aspx](http://msdn.microsoft.com/en-us/library/aa511268.aspx)），但我发现微软非常擅长制定指南，但不解释如何使用或访问这些。

任何有关如何创建消息对话框的信息以及 vista 新的大量其他控件将不胜感激。如果您尝试生成这些控件之一，我也很想知道 Windows XP 的反应。

我知道一个名为的控件`TaskDialog`，但我不知道如何开始在 .NET 中使用它，据我所知，它不是屏幕截图中使用的控件。

**更新：经过进一步研究，我相信 TaskDialog 可能是我所追求的 - 有人有在 .NET 中运行的代码示例吗？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-26T02:39:43.497

要获得像 UAC 中提供的非常酷的对话框，您需要一些本地调用。www.pinvoke.net 是获取此信息的绝佳资源。

**更新：这些都是[TaskDialog 非常好的例子](http://www.google.com/search?q=taskdialog+vista+example)。**

# nhibernate - NHibernate 查询列表

> ID：478715
> 
> 赞同：0
> 
> 时间：2009-01-26T02:42:31.463
> 
> 标签：nhibernate, hibernate

我有以下代码可以正常工作。但是，我只想返回 eventID = 5; 的行 在哪里可以向此查询添加条件？

```
tx = session.BeginTransaction();

        List<Catergory> Catergories;

        using (tx)
        {
            Catergories = (List<Catergory>)session.CreateCriteria(typeof(Catergory)).AddOrder(Order.Asc("catergoryType")).List<Catergory>();

            tx.Commit();
        }

        return Catergories; 
```

非常感谢任何帮助。

* * *

试过这个，但不断出现以下错误；

```
Catergories = (List<Catergory>)session.CreateCriteria(typeof(Catergory)).Add(Expression.Eq("calEventID",eventID)).AddOrder(Order.Asc("catergoryType")).List<Catergory>(); 
```

> “无法将 'NHibernate.Impl.QueryImpl' 类型的对象转换为 'System.Collections.Generic.List 1[Kanpeki.Domain.Category]'。” 故障详细信息：'null'"`1[Kanpeki.Domain.Catergory]'."
> message = "faultCode:Server.Processing faultString:'Unable to cast object of type 'NHibernate.Impl.QueryImpl' to type 'System.Collections.Generic.List``enter`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T03:12:49.233

将返回类型 List 更改为 IList 并且效果很好。

# iphone - 我使用哪些类来让 iPhone 充当服务器？

> ID：478719
> 
> 赞同：6
> 
> 时间：2009-01-26T02:47:14.853
> 
> 标签：iphone, cocoa-touch, httpserver

我正在寻找一种让用户将内容从 iPhone 下载到计算机的简单方法。我见过其他应用程序实际上将 iPhone 变成了服务器，并为用户提供了一个 IP 地址，以便在他们的计算机上导航。我浏览了一些 Apple 样品，但没有什么与我想要的太相似。

那么，让服务器侦听 TCP 端口 80（更好的是 HTTP 服务器）并发送响应的最简单方法是什么？希望使用 Objective C 类，但如果没有可用的东西，我可以制作一个包装器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T06:08:09.940

[Google Toolbox for Mac](http://code.google.com/p/google-toolbox-for-mac/)有一个名为**GTMHTTPServer**的类。

Deusty Designs 有一个名为[CocoaHTTPServer](http://code.google.com/p/cocoahttpserver/)的项目。

您不能使用端口 80，因为它需要 root 访问权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T08:09:23.080

Cocoa 为客户端网络提供了很多支持，但对服务器端的支持不多。

在最低级别，您可以使用普通的 BSD 套接字。

下一个级别是 CoreFoundation（纯 C，但使用类似 Cocoa 的类型）。相关的 CoreFoundation API 是`CFNetwork`,`CFSocket`和`CFStream`(`CFStream`是可以通过网络获取其源的文件流——它不是 System V 风格的网络流)。

在 Objective-C 中，您可以查看`NSStream`Objective-C 中的`CFStream`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T14:59:59.820

O'Reilly 有一篇关于设置简单服务器的好文章。

[如何编写 Cocoa Web 服务器](http://oreilly.com/pub/a/mac/2006/11/14/how-to-write-a-cocoa-web-server.html)

他使用 NSFileHandle 和 NSSocketPort 来设置监听器并处理请求。他还介绍了直接使用 BSD 套接字的一些细节工作。过去，我对这种方法很幸运。

This was written back in 2006, and I haven't used this on an iPhone project yet, but the classes he uses are pretty common. I would give it a fighting chance of working for an iPhone project.

# c# - 在 C# 中，如何像 google calc 那样实现模数？

> ID：478721
> 
> 赞同：7
> 
> 时间：2009-01-26T02:48:22.607
> 
> 标签：c#, modulo

我有一个代表形状的类。Shape 类有一个名为 Angle 的属性。我希望此属性的设置器自动将值包装到范围 [0,359] 中。

不幸的是，一个简单的`_Angle = value % 360;`只适用于正数。在 C# 中，`-40 % 360 == -40`. Google calc 会[按照我想要的方式进行](http://www.google.com/search?q=-40+mod+360)。该值应为 320。

C# 中最优雅的解决方案是什么？

这是我到目前为止最好的方法：

```
 public double Angle {
        get { return _Angle; } 
        set {
            if ( value >= 0 ) {
                _Angle = value % 360;
            }
            else {
                _Angle = value - (360 * ((int)(value / 360) - 1)); 
            }
        }
    } 
```

**编辑：**

谢谢大家，我现在有：

```
 public double Angle {
        get { return _Angle; } 
        set {
            _Angle = (value % 360) + ((value < 0) ? 360 : 0);
        }
    } 
```

..哪个更好:)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-26T03:04:56.020

尽管这适用于 Java，但 Java 对模数也有相同的行为。（即`-40 % 360 == -40`）。

下面的代码应该从 [0\. 360），无论给定角度，正或负。

```
public class Mod
{
    public static int mod(int a, int b)
    {
        if (a < 0)
            return b + (a % b);
        else
            return a % b;
    }

    public static void main(String[] args)
    {
        System.out.println(mod(40, 360));   // 40
        System.out.println(mod(-40, 360));  // 320
        System.out.println(mod(-400, 360)); // 320
    }
} 
```

请注意，当给定角度超过 -360 时有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T14:13:34.217

虽然您的解决方案适用于您遇到的问题，但算法实际上与 Google 使用的算法不同。如果您使用负除数，情况会有所不同。

```
public double GoogleModulo(double value, double divisor)
{
    long q = (long)Math.Floor(value / divisor);
    return value - q * divisor;
}

Console.WriteLine(GoogleModulo(  40,  360)); //   40
Console.WriteLine(GoogleModulo( -40,  360)); //  320
Console.WriteLine(GoogleModulo(-400,  360)); //  320
Console.WriteLine(GoogleModulo(  40, -360)); // -320 
```

[在此处](http://www.google.com/search?q=40+mod+-360)查看 google 对最后一次计算的响应。

该算法在[wikipedia](http://en.wikipedia.org/wiki/Modulo_operation)上进行了解释，并归因于 Donald Knuth。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-26T03:10:31.343

这应该会给你所需的结果

```
public double Angle {
    get { return _Angle; }
    set { _Angle = value % 360 + (value % 360 < 0 : 360 : 0); }
} 
```

我假设 360 是度数，而您正试图找出角度在 {0, 360} 中的位置。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-06T19:47:45.377

**mod操作非常缓慢。如果可能，用位掩码替换。**

coobird 的代码很不错……但是很慢，因为它正在执行 mod 操作。如果可以将数据缩放到 2 的某个幂范围内，那么您可以通过使用位掩码将速度提高大约一个数量级（至少快 2 或 3 倍）。

C代码：

```
#define BIT_MASK (0xFFFF)
if (a < 0) {
    return b + (a & BIT_MASK);
} else {
    return a & BIT_MASK;
} 
```

随意将#define 设置为运行时。并随意将位掩码调整为您需要的任何二的幂。就像您决定实施的 0xFFFFFFFF 或 2 的幂一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T02:58:10.137

`// go 'round once`

`set { _Angle = (value + 360) % 360 }`

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-26T02:59:07.513

```
(360 * Math.floor(Math.abs(value) / 360) + value) % 360 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-26T03:02:35.120

如果您的值不会超出范围，您可以做一个小循环。

```
while (value < 0) {
  value = value + 360;
}
while (value > 360) {
  value = value - 360;
} 
```

# windows - 为我的机器上的文件计算校验和的最佳方法是什么？

> ID：478722
> 
> 赞同：86
> 
> 时间：2009-01-26T02:48:35.053
> 
> 标签：windows, checksum

我在一台 Windows 机器上，我想在我刚得到的 MySQL 发行版上运行校验和。看起来有要下载的产品、不受支持的 Microsoft 工具以及可能的其他选项。我想知道是否对使用最佳工具达成共识。这可能是一个非常简单的问题，我以前从未运行过校验和例程。

* * *

## 回答 #1

> 赞同：247
> 
> 时间：2015-03-08T04:09:14.753

[**CertUtil**](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/certutil)是一个预安装的Windows 实用程序，可用于生成哈希校验和：

```
CertUtil -hashfile pathToFileToCheck [HashAlgorithm] 
```

*`HashAlgorithm`*选择：MD2 MD4 MD5 SHA1 SHA256 SHA384 SHA512

因此，例如，以下为文件生成 MD5 校验和`C:\TEMP\MyDataFile.img`：

```
CertUtil -hashfile C:\TEMP\MyDataFile.img MD5 
```

要获得类似于 *Nix 系统的输出，您可以添加一些 PS 魔法：

```
$(CertUtil -hashfile C:\TEMP\MyDataFile.img MD5)[1] -replace " ","" 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-26T02:51:28.590

我个人使用[Cygwin](http://www.cygwin.com/)，它将 Linux 实用程序的整个 smörgåsbord 放在我的指尖 --- [OpenSSL](http://www.openssl.org/)[`md5sum`](http://linux.die.net/man/1/md5sum)支持所有加密摘要。或者，您也可以使用 OpenSSL 的[Windows 分发](http://www.slproweb.com/products/Win32OpenSSL.html)版（“轻量级”版本只有 1 MB 安装程序）。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-26T02:51:32.787

任何 MD5 都会产生一个很好的校验和来验证文件。本页底部列出的任何文件都可以正常工作。 [http://en.wikipedia.org/wiki/Md5sum](http://en.wikipedia.org/wiki/Md5sum)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-12-04T15:44:46.570

在 Windows 上：您可以使用 FCIV 实用程序：http: [//support.microsoft.com/kb/841290](http://support.microsoft.com/kb/841290)

在 Unix/Linux 上：您可以使用 md5sum： http: [//linux.about.com/library/cmd/blcmdl1_md5sum.htm](http://linux.about.com/library/cmd/blcmdl1_md5sum.htm)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-02-21T16:47:00.673

校验和标签：[http ://code.kliu.org/hashcheck/](http://code.kliu.org/hashcheck/)

这对我来说在 Windows 上工作了一段时间。它允许轻松复制和粘贴校验和。它具有输入/粘贴来自网页的校验和并很好地显示匹配或不匹配的框。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-26T02:55:10.143

在 MySQL.com 上，MD5 列在您​​可以下载的每个文件旁边。例如，MySQL "Windows Essentials" 5.1 是**528c89c37b3a6f0bd34480000a56c372**。

您可以[下载](http://www.fourmilab.ch/md5/)md5 (md5.exe)，这是一个命令行工具，可以计算您本地拥有的任何文件的 MD5。MD5 就像任何其他[加密散列函数](http://en.wikipedia.org/wiki/Cryptographic_hash_function)一样，这意味着给定的字节数组将始终产生相同的散列。这意味着如果您下载的 MySQL zip 文件（或其他文件）具有与他们在其网站上发布的相同的 MD5，那么您将拥有完全相同的文件。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-12-20T08:05:43.943

当我使用 Windows 时，我发现了方便的 HashTab 3rd 方工具。它在文件属性选项卡之一中显示 MD5、SHA-1 校验和。[http://implbits.com/products/hashtab/](http://implbits.com/products/hashtab/)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-08-08T14:02:43.650

7-Zip 可用于为文件、文件文件夹和文件文件夹树生成哈希值。7-Zip 占用空间小，是一个非常有用的压缩实用程序。 [http://7-zip.org/](http://7-zip.org/)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-12-28T13:35:30.420

在Windows 7中计算当前目录中所有文件的md5

```
for %i in (*) DO CertUtil -hashfile %i MD5 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-08-04T22:21:59.700

[直接从http://www.microsoft.com/en-us/download/confirmation.aspx?id=11533](http://www.microsoft.com/en-us/download/confirmation.aspx?id=11533)下载 fciv.exe

```
shell> fciv.exe [yourfile] 
```

默认情况下会给你md5。

您可以阅读帮助文件`fciv.exe -h`

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-07-06T00:30:57.403

只是为 Windows 用户添加另一个选项，`Get-FileHash`可以使用 PowerShell cmdlet ( [https://technet.microsoft.com/en-us/library/dn520872.aspx](https://technet.microsoft.com/en-us/library/dn520872.aspx) )。

示例用法： `Get-FileHash MyImage.iso -Algorithm MD5`

如果您所追求的只是原始哈希，那么： `(Get-FileHash MyImage.iso -Algorithm MD5).Hash`

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-12-02T22:02:35.817

Powershell 实用程序 Get-FileHash 非常适合我。

[https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.utility/get-filehash](https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.utility/get-filehash)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-02-04T19:54:46.913

适用于 Windows 的最佳实用程序是 HashCheck，它现在位于 GitHub 上。 [https://github.com/gurnec/HashCheck/releases/tag/v2.4.0](https://github.com/gurnec/HashCheck/releases/tag/v2.4.0)

安装哈希检查。现在右键单击文件-> 创建验证文件。它将创建一个包含 MD5 代码的 file.extension.md5 文件。

爱它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-26T18:28:11.600

请注意，仅当您的 install.exe 正确时，上述解决方案才会告诉您安装是否正确（您可以相信它会产生正确的安装。）

您需要每个文件/文件夹的 MD5 总和来测试安装完成后安装的代码是否被弄乱了。

WinMerg 可用于比较两次安装（可能在两台不同的机器上）以查看一个是否已更改或为什么一个已损坏。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-06-08T19:26:35.013

确定 certutil 是最好的方法，但有机会在没有 certutil 命令的情况下访问 windows xp/2003 机器。可以使用具有自己的哈希算法的 makecab 命令 - 这里的[fileinf.bat](https://github.com/npocmaka/batch.scripts/blob/master/hybrids/makecab/fileinf.bat)将输出有关文件的一些信息，包括校验和。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-10-28T20:05:47.727

[散列](http://hashingapp.github.io)是执行 MD5、SHA-1 和 SHA-2 系列的独立应用程序。建立在 OpenSSL 之上。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-04-15T13:37:25.807

我喜欢在 Windows 上使用[HashMyFiles](http://www.nirsoft.net/utils/hash_my_files.html)。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-12-02T00:29:16.287

QuickHash 是一个开源工具，支持**MD5、SHA1、SHA256、SHA512**，可用于**Linux、Windows 和 Apple Mac**。

[https://sourceforge.net/projects/quickhash/](https://sourceforge.net/projects/quickhash/)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-06-24T03:52:06.863

在 HPUX（hp UNIX）中

请在您的 UNIX 机器上安装 md5sum 包，例如，如果有一个名为 a.txt 的文件

```
shell > md5sum a.txt 
```

* * *

## 回答 #20

> 赞同：-4
> 
> 时间：2009-01-26T11:44:48.560

只需使用 win32 Checksum api。MD5 在 Win32 中是本机的。

# javascript - 浏览器“拖放”事件：任何人都可以填空吗？

> ID：478724
> 
> 赞同：7
> 
> 时间：2009-01-26T02:49:50.747
> 
> 标签：javascript, firefox, events, drag-and-drop, safari

到目前为止，我从来没有真正需要使用任何拖动功能，所以让我向您介绍一下我到目前为止的发现：

*   拖动事件是在用户拖动对象时发生的事件。这是“正确的”操作系统拖动，例如：hiliting 一些文本并拖动它，甚至从浏览器外部拖动一些东西。
*   据我所知，在拖动时，不会触发其他浏览器事件。（例如，onmouseover 会被忽略）。唯一有效的事件是拖动事件。
*   在所有现代浏览器中，onDragEnter 和 onDragOver 似乎都可以工作……但 Firefox 缺少“onDragLeave”。
*   对于丢弃，FF 使用“onDragDrop”，而 IE 和其他人使用“onDrop”，而 Safari 似乎不支持它。
*   事件似乎只适用于“可放置”元素，如 textarea 和 text。在其他元素上，只有*一些*事件有效。
*   每个浏览器的各种其他怪癖，我什至不想回顾。
*   关于这些事件的记录很少。

是的，我**必须**使用实际的拖放，并且无法模拟它。

我的问题：

*   **有没有办法在 FF 中检测“ondragleave”或类似的东西？**
*   **有没有办法在 Safari 中检测“ondragdrop”或类似的东西？**
*   **您对拖放有什么要补充的吗？**

这是一个演示拖放事件的快速而肮脏的模板：

```
<script>
    addEvent = function(obj, eventname, fn){
        if (document.addEventListener) obj.addEventListener(eventname, fn, false);
        else obj.attachEvent('on'+eventname, fn);
    }

    window.onload = function(){
        var logger = document.getElementById("logger");
        var log = function(str){ logger.value = str + logger.value; }

        //log a variety of drag events for the textarea
        var obj = document.getElementById("tarea");
        var events = ["dragenter","dragover","dragout","dragleave","dragdrop","drop"];
        for (var i=0; i<events.length; i++){
            (function(event){//create a closure to remove variable scope
                addEvent(obj, event, function(){ log("textarea: " + event + "\n"); });
            })(events[i]);
        }

        //log events on the div
        obj = document.getElementById("div");
        events = ["mouseover","mouseout","mouseup","mousedown","click","dblclick",
                "dragenter","dragover","dragout","dragleave","dragdrop","drop"];
        for (var i=0; i<events.length; i++){
            (function(event){//create a closure to remove variable scope
                addEvent(obj, event, function(){ log("div: " + event + "\n"); });
            })(events[i]);
        }
    }
</script>
Life's a drag when doing cross browser stuff.<br><br>
<div id="div" style="width: 100px; height: 100px; background: green; float: left;">
</div>
<textarea id="tarea" style="width: 100px; height: 100px; float: left; margin: 0px 5px;">
</textarea>

<textarea id="logger" style="width: 200px; height: 400px; float: left;">
</textarea> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-26T06:51:08.917

我找到了一种通过事件委托处理 onDragLeave 的方法。

只需添加一个事件来监视整个文档的“dragover”。当事件源成为您有问题的元素时，设置一个标志，一旦事件源不再是该元素，触发“dragleave”事件。

笔记：

*   需要修改，以便“e.source==obj”实际上是“obj.childOf(e.source)”......因为源元素可能是相关对象的后代。
*   需要事件处理框架根据浏览器确定“源”是什么。

不幸的是，Safari 缺少“ondrop”似乎无法修复……它永远不会被解雇。

如何在 FF 中实现“dragleave”（好吧，所有浏览器）：

```
var setOnDragLeave = function(obj, fn){
    var on=false;
    var dragover = function(e){
        if (on){
            if (e.source!=obj){
                on = false;
                e.eventname = "dragleave";
                fn.call(obj, e);
            }
            return;
        }else{
            if (e.source==obj) on = true;
            return;
        }
    }
    addEvent(document.documentElement, "dragover", dragover);
}
setOnDragLeave(obj, function(e){ logEvent(e); }); 
```

我真诚地希望这个星球上的其他人可以使用它...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T00:29:11.623

不错的文章。我也在 Safari 中寻找相当于 ondrop/ondragdrop 的东西。但是，对于“内部”拖放情况，有一种可能的解决方法，即拖放源和拖放目标在同一个文档中。

IE 支持拖动源元素上的 ondragstart、ondrag 和 ondragend 事件。Safari 3 也会触发这些。Firefox3 会触发 ondrag 和 ondragend，但不会触发 ondragstart（尽管文档建议应该这样做）。无论如何，根据您的情况，您可以使用 ondragend 来检测拖放操作何时完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T20:27:17.573

Firefox 似乎将“dragleave”事件实现为“dragexit”。现在才学这个。它有效。

# c++ - 为什么OO概念接口在C++中不用关键字来表示？

> ID：478725
> 
> 赞同：7
> 
> 时间：2009-01-26T02:51:01.117
> 
> 标签：c++, oop

Java 等语言明确使用*interface*关键字来表示[接口](https://stackoverflow.com/questions/98867/where-did-the-concept-of-interfaces-come-from)。使用过 Java，这个概念对我来说似乎足够有用，可以证明一个关键字来强制执行这个概念。

当然可以使用纯虚拟类并将其标记为接口。但是，这个关键字似乎非常有用，并且与纯虚拟类不同，因此很有用。也许它被包含在 C++ 0x 中？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-26T02:59:40.820

因为 C++ 允许多重继承，并且因为接口是一个抽象类，它的所有成员也是抽象/虚拟的，所以 C++ 不需要它 - 一个类可以简单地“扩展”多个其他类，其中任何一个都可能是纯虚拟的（抽象的）。

另一方面，Java 和 C# 不允许 MI，因为这些语言的设计者认为 MI 产生的问题多于解决的问题。但是一个对象仍然需要“成为”许多事物（OOP 是一种关系），因此接口提供了一种机制，允许一个对象成为许多事物，而无需继承多个实现——保留婴儿，但丢弃洗澡水。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-26T02:53:27.743

这是多余的，因为接口是通过让每个类成员都是纯虚拟（=0）来表示的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-26T18:19:56.220

添加“interface”关键字会增加实现的复杂性，而不会添加任何真正有用的功能；它会重复现有的功能。正如其他人所说，它只是一个纯虚拟类。Java 和 C# 必须有“接口”才能获得 C++ 已有的部分。从哲学上讲，C++ 旨在使程序员能够编写出好的软件，而不是阻止程序员编写出糟糕的软件。根据我的经验，针对 MI 的喧嚣被夸​​大了。白痴滥用它，就像他们滥用一切一样，人们没有指责白痴是白痴，而是指责该工具。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-26T04:04:48.787

因为接口严格地弱于 MI。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-26T18:28:57.217

接口出现在没有多重继承的语言中，部分涵盖了这一点。C++ 已经有多重继承，所以不需要它。

此外，并非所有语言都需要相同。C++ 有它自己的设计和历史，也有它的长处和短处，就像 Java、C# 等等。尝试使所有语言平等是没有用的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-28T00:04:44.010

C++ 的早期 OO 特性长期以来一直被忽视，因为它作为一种多范式语言已经朝着更有趣的方向发展。十多年来的主要焦点一直是模板及其含义，特别是在标准库中。`interface`是的，带有关键字的程序会更具可读性。如果有`override`和`new`修饰符用于与基类方法同名的方法（如 C#），它们也将更容易维护。但是对于现代 C++ 用户和那些为语言设计做出贡献的人来说，这些都不是有趣的问题。OO 特性是足够的，但不是很好，并且在标准库的“较新”（1992 年后）部分中几乎没有使用，这在某些方面可以作为良好风格的指南。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T00:36:39.813

这是[来自 DDJ 的一篇简短文章](http://www.ddj.com/cpp/184410630)，涉及类和接口之间的区别。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T00:42:48.677

实际上，“接口”OO 概念是对象可以执行的操作。

因此，Ruby 或 Python 等语言也有“接口”，尽管它们不需要像在 Java 中那样声明它们。

在 Java 中，接口 OO 概念与这个“接口”关键字相匹配，用于声明一个对象将响应某个契约（多个方法）

C++ 也有这个概念，甚至每个没有实现任何接口的 Java 对象。

# java - 使 JTable 中的单元格可编辑 - 单元格的默认值

> ID：478726
> 
> 赞同：3
> 
> 时间：2009-01-26T02:51:15.347
> 
> 标签：java, jtable

我正在使用 Java，并且正在尝试使 JTable 中的单元格可编辑。我的类实现了 TableModel 并扩展了 AbstractTableModel （这样我就可以使用方法`fireTableCellUpdated(rowIndex, columnIndex))`，并且我已经实现了方法`isCellEditable()`和`setValueAt()`。我将表中的单个单元格表示为类 Cell 的对象。

现在这是我的问题：单元格已经是可编辑的，当我单击它时，光标出现在单元格中，但是，单元格中还出现了一个字符串，如下所示：`Cell@1e63e3d`。我删除了这个字符串并将我想要输入的值放入单元格中，然后单击 Enter 并且它工作正常。但是我希望当我点击那里的单元格时什么都没有出现，一个空字符串，而不是`Cell@1e63e3d`. 而且我不知道如何将此空字符串设置为默认值和位置。

我的 Cell 类存储有关单元格的信息（特征），例如单元格的颜色，以及作为实例变量的值。

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-26T03:38:48.977

你设置了一个[`TableCellRenderer`](http://java.sun.com/javase/6/docs/api/javax/swing/table/TableCellRenderer.html)和[`TableCellEditor`](http://java.sun.com/javase/6/docs/api/javax/swing/table/TableCellEditor.html)你的[`JTable`](http://java.sun.com/javase/6/docs/api/javax/swing/JTable.html)？

**为了显示一个单元格**，`TableCellRenderer`用于呈现一个位置的内容`TableModel`。默认情况下，它将使用该位置的`toString`方法`Object`，这样就可以解释`Cell@1e63e3d`单元格中显示的内容——这是`toString`在您的`Cell`对象上调用该方法的结果。

通过编写自定义单元格渲染器（实现 的类`TableCellRenderer`），您将能够使用该方法返回`Component`要用于显示`Cell`对象的a [`getTableCellRendererComponent`](http://java.sun.com/javase/6/docs/api/javax/swing/table/TableCellRenderer.html#getTableCellRendererComponent(javax.swing.JTable,%20java.lang.Object,%20boolean,%20boolean,%20int,%20int))。在您的情况下，您可能希望`JLabel`实现a 的子类`TableCellRenderer`，并将设置标签的内容以反映您的`Cell`对象的内容。

**至于编辑单元格**，当您要编辑单元格时，会`TableCellEditor`收到`Object`来自的。将返回 a ，用于使用该方法编辑单元格内容（ ）。`TableModel``JTable``TableCellEditor``Component``Object`[`getTableCellEditorComponent`](http://java.sun.com/javase/6/docs/api/javax/swing/table/TableCellEditor.html#getTableCellEditorComponent(javax.swing.JTable,%20java.lang.Object,%20boolean,%20int,%20int))

在您提供的情况下，我认为制作`JTextField`实现`TableCellEditor`接口的 a 将能够为您完成这项工作。当您覆盖 时`getTableCellEditorComponent`，请检查您是否有`Cell`对象的实例（即`object instanceof Cell`），如果是这种情况，请初始化您`JTextField`以包含`Cell`要显示或编辑的对象的内容。

**推荐阅读：**我发现来自 IBM developerWorks[的 Swing 的 JTable 组件](http://www.ibm.com/developerworks/java/library/j-jtable/)文章中的 Rendering cells 对学习如何处理`JTable`s 及其单元渲染和编辑特性很有帮助。特别是，[创建自定义渲染器](http://www.ibm.com/developerworks/java/library/j-jtable/#h1)和[编辑表格单元格](http://www.ibm.com/developerworks/java/library/j-jtable/#h3)部分可能很有趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T03:32:27.213

您是否使用适当[`TableCellEditor`](http://java.sun.com/javase/6/docs/api/javax/swing/table/TableCellEditor.html)的显示组件进行编辑？

```
class MyTableCellEditor
        extends DefaultCellEditor
{
    @Override
    public Component getTableCellEditorComponent(
            JTable table,
            Object value,
            boolean isSelected,
            int row,
            int column)
    {
        final JTextField c = (JTextField) super.getTableCellEditorComponent(
            table,
            ((Cell) value).text, // edit the text field of Cell
            isSelected,
            row,
            column);

        c.selectAll(); // automatically select the whole string in the cell
        return c;
    }
} 
```

除了自定义单元格渲染器之外，您还需要告诉您的表格使用此自定义单元格编辑器。

```
myTable.setDefaultEditor(Cell.class, new MyTableCellEditor()); 
```

# linq-to-sql - NorthwindDataContext - 从哪里得到这个类？

> ID：478757
> 
> 赞同：1
> 
> 时间：2009-01-26T03:07:19.620
> 
> 标签：linq-to-sql

在许多学习 LINQ 的在线教程中，他们使用 NorthwindDataContext。这是从哪里检索/生成的？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-26T03:51:32.417

Northwind 是一个被 AdventureWorks 取代的演示数据库。它可用于 SQL Server 和 MS Access。

当你想使用 Linq to SQL 时，你需要一个 DataContext 来查询。您可以通过向您的解决方案添加一个新的 Linq To Sql 类来创建它。完成此操作后，您将获得设计表面。打开“服务器资源管理器”窗口并连接到您的 Northwind 数据库。将感兴趣的表拖到您的 L2S 设计图面上并保存。这将生成 NorthwindDatacontext 和关联的表类，供您在查询中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T03:23:29.913

当您将数据库拖到 LINQ to SQL 设计图面时，会自动生成此类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-11T01:40:29.370

我认为不必`DataContext`质疑。其他一些类型的数据也可用于查询。 `List`, `ArrayList`, `Collections`（嗯`List`，`ArrayList`也是集合）等也可以得到查询。

# vb.net - 表归档

> ID：478764
> 
> 赞同：0
> 
> 时间：2009-01-26T03:10:01.877
> 
> 标签：vb.net, linq

我可以在 linq 查询中获取表名的代码是：

```
 Dim TY As Type = (From T In DB.Mapping.GetTables()
                       Where T.TableName = tableN
                       Select T.RowType.Type).SingleOrDefault
     Dim Table As ITable = DB.GetTable(TY)
     Dim mq = From t In Table Select t 
```

tableN 从另一种形式获取。我想访问 Table 的 fileld 并在 linq 查询中使用。如何？

例如：

```
Dim mq = From t In Table Select t.Code 
```

请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T04:07:08.063

尝试使用扩展方法：

```
Dim mq = Table.Select( Function(t) t.Code ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T13:14:49.873

Can you do something similar to this?

```
Dim p As System.Reflection.PropertyInfo = Table.GetType().GetProperty("Code")
Dim mq = From t in Table Select p.GetValue(t) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T15:29:33.380

我已将您的最终选择更改为如下所示：

```
Dim mq = From t In Table.OfType<XXX> Select t.Code 
```

您现在唯一需要知道的是该表中的类型。这有帮助吗？

# design-patterns - OOP 和设计模式有什么关系？

> ID：478773
> 
> 赞同：32
> 
> 时间：2009-01-26T03:16:12.767
> 
> 标签：design-patterns, oop

设计模式不是 OOP 原则的扩展吗？为什么这两个概念要分开处理？我们能相信如果知道设计模式的人一定会成为 OOP 专家吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-01-26T03:46:15.797

[设计模式](http://en.wikipedia.org/wiki/Design_pattern)是针对常见编程问题的久经考验的*解决方案。*它不一定是面向对象的编程问题，但这在当今最为常见。

学习编程对很多人来说并不难。这就像玩乐高积木一样：您可以根据需要将一些不同的部件拼凑在一起。有时你会做一些很酷的事情，但大多数时候你会做废话=）。通常，你玩的时间越长，你就越好。

学习设计模式就是学习*构建程序的好方法*。您实际上是在阅读几十年来一直在构建事物的人们的建议。他们将最常见的解决方案提炼成简单易懂的知识花絮，并带有令人难忘的名字。这就像数字时代的学徒：你的长辈正在给你最好的建议。您可以接受它并领先于游戏，或者忽略它并重复他们所有的错误。

**为什么设计模式和 OOP 分开处理？** 因为它们是不同的主题。一般来说，你学习编程，然后学习如何*思考编程*。我希望它是相反的方式，但我没有屏住呼吸。

**了解设计模式的人一定是 OOP 专家吗？**不。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T03:26:38.613

设计模式和面向对象编程*不一定*相关。碰巧有大量的设计模式涉及面向对象编程。

设计模式是一种常用的程序创建方法。为一个领域寻找通用模式语言的方法可以扩展到函数式编程或桥梁构建，或者在建筑中找到它的起点。OO 是一种特定的概念范式，一些编程模式适合它。

这种情况就像一个维恩图 - 方法并不相反，但它们并不相同，并且它们在不同的*逻辑* *级别*上运行。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-25T22:06:17.323

> 设计模式不是 OOP 原则的扩展吗？为什么这两个概念要分开处理？

“设计模式”是关于 OOP 原则的，主要是由于一个历史事故。

我相当肯定 ML 黑客早在 GoF 书之前就在谈论代数数据类型的折叠。这是一个常见问题的可靠解决方案：您想根据某些代数数据类型的内容计算单个值。同样对于`map`，我想。

我认为发现和编码解决方案模板的一般（元？）实践已经很老了——这不是“最佳实践”的本质吗？

我认为将 DP 和 OOP 分开处理的原因是因为尽管它们重叠——人们会认为 OOP 最佳实践与 OOP 原则有关——但它们具有一定的独立性：在非 OO 设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T03:30:29.587

我认为您应该拿起任何设计模式书籍，并阅读介绍。一旦你得到什么是设计模式，你就会回答这个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T03:34:27.723

事实上，设计模式和 OOP 之间并没有任何关系。顾名思义，它们是实现设计的模式（或“配方”）。几乎所有你会使用的语言都有“设计模式”，但碰巧四人组一书专注于 OO 设计模式。

对 OO 设计模式的了解可能是一个积极的指标，但是在采访某人（或试图衡量他们的专业水平）时，我会查看他们熟悉的模式的复杂性，以及对何时/在哪里使用模式。我已经看到开发人员抓住了“金锤”之类的模式，并在不一定适用的地方使用它。

因此，就像一本食谱书并不能使一个人成为大厨一样，OO 设计模式的知识并不一定能使一个人成为 OO 专家。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T03:31:32.893

设计模式是解决 OOP 编程中出现的问题的常用方法。在确定如何处理某种情况时，了解设计模式可以节省一些时间。

一些设计模式允许您做一些原本不可能或复杂的事情，例如[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)，它允许一组类在不知道更改的情况下获得新功能。使用普通的 OOP 技术，可以创建每个类实现的接口或虚拟方法。这违背了 OOP[开放/封闭原则](http://en.wikipedia.org/wiki/Open/closed_principle)。

我不会说知道设计模式的人是 OOP 专家。

程序员一直在使用模式，而从未研究过它们，因为它们在 Java 和 .NET 框架中被广泛使用。大多数 Java IO 名称空间由利用[装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)的类组成。知道这一点不会使某人或多或少成为 OOP 专家，但它可以帮助理解事物。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T06:10:46.330

面向对象编程是一种编程方法或编程概念，它将代码组织成对象和对象之间的关系。设计模式会建议经过验证的成功方法来构造类型/对象以解决程序中的特定场景。

这是一个有限的定义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-05T20:37:12.413

我认为 OOP 原则是一组工具，可以应用设计模式来生成一个好的程序。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-07T11:49:28.770

**设计模式不是 OOP 原则的扩展**：我认为答案应该是否定的

**为什么设计模式和 OOP 分开处理？**

**OOP 原则**- 实际上是关于在设计/定义类时应该遵循哪些约束/主题（业务对象的技术表示）..类的行为方式..应该采取什么措施来删除任何其他类依赖项以使其正常工作.. 还有更多 .. 这就是众所周知的**SOLID 原则**

> 对于那些不知道这一点的人，SOLID 是面向对象设计的前 5 个原则的首字母缩写词：
> 
> *   单一职责原则
> *   开闭原则
> *   里氏替换原则
> *   接口隔离原则
> *   依赖倒置原则

* * *

**设计模式**在哪里- 很大程度上是关于您希望如何在应用程序中定义/维护编码标准..如何以标准方式简化应用程序的执行流程..以便它可以轻松维护..

在下面的示例中......定义了一种设计模式......它是关于每个开发人员应该如何创建一个对象......

```
//Register 
builder.RegisterType<ConsoleOutput>().As<IOutput>();                         
builder.RegisterType<TodayWriter>().As<IDateWriter>();
Container = builder.Build();

//Create instance
var writer1 = Container.Resolve<IOutput>();                
writer1.Write("HelloWorld"); 

var writer2 = Container.Resolve<IDateWriter>();               
writer2.WriteDate(); 
```

> 架构师想要创建一个设计模式，每个开发人员都 **必须**在类的顶部创建一个接口。接口和类必须在工厂中注册以创建实例。因为架构师想要一些统计报告，比如有多少类（业务对象）被注册或创建多少对象来完成一个模块（**现在可以通过**在工厂的“RegisterType”和“Resolve”函数中放置一些代码来轻松实现）..
> 
> 所以，现在可能很清楚设计模式和 OOP 是`very different aspect`

**我们能相信如果知道设计模式的人一定会成为 OOP 专家吗？**- 预计是……但不是强制性的！！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-12-27T15:43:23.827

面向对象编程本身就是一种设计模式。

# java - 您如何使用 Eclipse 确定哪些 JAR 依赖于哪个？

> ID：478788
> 
> 赞同：3
> 
> 时间：2009-01-26T03:30:34.703
> 
> 标签：java, eclipse, jar, dependencies

我正在尝试使用 Eclipse JDT AST 解析类。在包含初始 JAR 并整理出更多依赖项之后，它包含 7 个以上的 JAR，并且我仍然有 NoClassDefFoundError 异常。每当我尝试使用很少或没有文档来测试库时，就会出现这种情况。反复试验似乎是解决此问题的一种非常愚蠢（且令人讨厌）的方法。

有没有办法使用 Eclipse 自动解决这个问题？

* * *

*更新：*后来我发现添加您拥有的所有 JAR，并使用 Ctrl-T（查看/定位类型），可以让您手动定位 JAR。[这就是](http://dev.eclipse.org/newslists/news.eclipse.newcomer/msg21071.html)谷歌迄今为止提供的解决方案。有没有更好的办法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-26T05:00:38.190

如果您参考此 SO 问题[Findunused jars used in an eclipse project](https://stackoverflow.com/questions/248589)，您还可以：

**[ClassPathHelper](http://classpathhelper.sourceforge.net/)**，可以快速关注未解析的类：

![未解决](https://i.stack.imgur.com/szz1W.jpg)

它会自动识别孤立的 jars、阻塞（模糊）的类等等。

唯一的限制是未在类中定义的依赖关系，例如在依赖注入框架配置文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T15:12:39.013

我发现设置一个专门用于浏览 Eclipse 源代码的工作区非常有用。通过这种方式，您可以像使用您自己的插件项目一样使用 PDE 工具，如 Plug-in Spy、捆绑依赖分析、浏览文档等。我[在 Vogella 发现这篇文章是](http://www.vogella.de/articles/EclipseCodeAccess/article.html)一个非常有用的指南。

如果你知道你想要的类是哪个包，你可以通过创建一个新的 OSGi 启动配置来生成依赖的传递闭包，只选择单个包。通过点击`Add Required`按钮，您可以查看使用您感兴趣的捆绑包所需的所有捆绑包。

**编辑**：

*   从您的问题来看，您并不清楚要在其中运行编译器的环境。如果您对在 OSGi 环境之外运行的可嵌入 Java 编译器感兴趣，我可以建议[Janino](http://www.janino.net/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T03:50:38.813

您可以使用依赖分析器，例如： [JarAnalyzer](http://java-source.net/open-source/code-analyzers/jaranalyzer)

这将解析一个充满 Jars 的目录，并为您提供一个 XML 输出依赖关系图，其中有几个工具可以以图形或文本形式显示。

# javascript - 这些天，程序员如何处理 ie6 错误？

> ID：478798
> 
> 赞同：12
> 
> 时间：2009-01-26T03:40:55.947
> 
> 标签：javascript, internet-explorer, browser, internet-explorer-6

我一直在使用 Dean edwards [ie7/8 脚本](http://code.google.com/p/ie7-js/)。不确定这是否是我的实现，但有时我会遇到 ie6 问题，这些问题没有完全解决或[需要特殊处理](http://code.google.com/p/ie7-js/issues/detail?id=114)，这意味着我会回到我开始的地方，关心 ie6。所以，我想知道 ie7/8 是否仍然可行，或者其他一些实践/解决方案是否更好。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-26T05:03:30.553

**更新**：我在我的网站上使用教程扩展了我的答案，这可能比我在这里的答案更有帮助。[Ultimate IE6 Cheatsheet：如何修复 25+ Internet Explorer 6 错误](http://www.virtuosimedia.com/tutorials/ultimate-ie6-cheatsheet-how-to-fix-25-internet-explorer-6-bugs)

以下是我处理 IE6 的方法：

*   我验证了我的 XHTML 和 CSS。
*   我保持我的设计简单，即使是复杂的。
*   我不使用使我的 CSS 无效的技巧。
*   我使用一个处理我的大部分跨浏览器 JavaScript 问题的 JavaScript 框架/库（我喜欢 MooTools，但你会在 jQuery、Prototype、YUI、Dojo 和许多其他方面获得很多选票）。
*   我逐步增强我的页面，以便它们首先在没有 JavaScript 的情况下工作，然后添加所有的花里胡哨。
*   对于一些双边距问题，我使用 display:inline;
*   如果我必须这样做，我会使用单独的样式表，尽管我发现我必须越来越少地这样做。
*   我尽量避免在我的布局中使用透明图像。如果我绝对需要它们，我会使用具有 alpha 透明度的 PNG8，IE6 确实支持它。
*   为了解决最小高度问题，我执行以下操作：

这适用于 IE6，它将高度解释为最小高度：

```
.classNameHere {height:300px;} 
```

这适用于其他一切：

```
div>div .classNameHere {min-height:300px; height:auto;} 
```

顺便说一句，如果您需要用 CSS 隔离 IE6，这是一个很好的方法，因为它不支持子选择器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T03:22:52.160

我尽量不支持IE6

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T05:50:31.020

[YUI 重置](http://developer.yahoo.com/yui/reset/)和[YUI 网格](http://developer.yahoo.com/yui/grids/)让我在支持 IE6 时保持理智。

IE 6 是“A 级”浏览器，这意味着错误和错误优先。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-27T13:42:40.757

我正在使用：

*   "Reset.css" 缩小浏览器默认 CSS 计算样式之间的差异（例如[YUI reset.css](http://yui.yahooapis.com/2.6.0/build/reset/reset-min.css)）
*   将额外的 css 文件放入范围的[条件注释；）（例如 ./ieFix.css）](http://www.quirksmode.org/css/condcom.html)
*   W3C 验证器来判断渲染的差异是由错误的嵌套引起的还是只是 IE ;)
*   如果失败了，jQuery 会有很大帮助；）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T04:35:49.707

我最近对IE6制定了一个政策，基本上，只要不破坏IE6上的网站，就不要花时间在上面。

我不认为 IMHO，IE6 仍然有足够的用途让我的公司继续花钱解决它的小问题。

以下是我公司拥有跟踪数据的几个网站的快速数据示例。这是最近的数据（今天）和大约 1 年前的一些数据的组合，因此 IE6 的百分比比我们现在实际得到的要高，即便如此，除了 3% 的点击量之外，所有点击量都来自 8 个站点中的 1 个包含在数据中。

[alt text http://unkwndesign.com/browerUsage.png](http://unkwndesign.com/browerUsage.png)
**注意 Chrome 是基于 webkit 构建的，但它的数字不包含在 webkit 中，只是为了显示它的增长速度。由于四舍五入，总百分比为 100.5%。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-26T05:17:27.860

老实说，我最近并没有真正处理 IE6 问题。我的设计过程很简单：

*   重置所有内容的边距/填充。我的意思是一切。
*   每隔几分钟测试我的页面布局。轻按一下 F5。
*   如果任何更改破坏了页面，我会停止一切并评估更改。
*   如果无法使用所需的方法，我会研究替代方法，不包括“黑客”。
*   我验证了标记和 css。并且始终使用 XHTML 1.0 Strict。
*   我确保我的网站首先在没有 Javascript 的情况下运行，然后再使用 jQuery。

多年来，这些基本实践使我不必经常处理 IE6 问题。我仍然感到不安的唯一问题是 IE6 对具有透明度的 PNG24 的支持，但 IEPNGFix 会处理这些问题——通常也不会破坏我的布局。

**这可能是一个愚蠢的人的意见：
伟大的开发人员不会找到抱怨，他们会找到解决方案。**

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-27T13:52:56.740

[有条件的评论](http://www.quirksmode.org/css/condcom.html)，耐心，有时还有[ie7-js](http://code.google.com/p/ie7-js/)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-28T01:30:00.423

我同意关于涉及干净代码、条件注释、保持 ie6 快乐但不完美等过程的回复。但这是一个非常谨慎的、一点一点的过程，实际上它仍然非常耗时。这一切都适用于一个浏览器。我不愿意将任何回复打勾，因为所有回复都在谈论我熟悉的现有方法。可能我的问题被回答为“否”:) 因为本质上我是在一个框架之后，这意味着你甚至不必担心 ie6 的细微差别，只需以现代方式编写代码——我认为 ie7/8 的 js 会做但即使在今天，我也意识到最小高度没有被固定！！无论如何感谢您的回复 - 它'

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-26T03:56:48.007

我认为对于您可以或不能忽略的浏览器没有标准。这取决于组织——或者你的初创公司的受众。您编写的任何 JS 都应该“优雅地降级”，但有时要确保真正发生这种情况需要一些技巧。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-29T09:27:24.510

对于 IE 问题，实际上只有一个“解决方案”，即帮助促进其自杀。我发现帮助 IE 自杀的唯一方法是教育我的访客。这可以通过嗅探浏览器来完成，如果检测到 IE，您将显示“帮助升级网络”横幅。

有点像GMail...

我们在[ra-ajax](http://ra-ajax.org)和[stacked](http://stacked.ra-ajax.org)上执行此操作（使用任何版本的 IE 访问该站点）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-29T09:30:29.603

**首先为firefox构建**，nuke或降级设计元素经验告诉你IE6一开始就无法处理，并且不会花费超过客户规范保证的时间

TBH 经验是 IE6 问题的第一预防措施

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-14T07:04:31.203

1.  让它在 Firefox 中运行；
2.  检查它在 IE7 中的外观和工作方式是否相同；
3.  检查它是否可以在 IE6 中运行（因为这已经足够好了）。
4.  如果您不能使用简单的 CSS 进行布局（没有疯狂的相对+绝对定位或浮动：修复后），那么只需使用表格即可；
5.  放入 DOCTYPE 以强制浏览器进入合规（而不是怪癖）模式；
6.  通过最小化包含边界的使用（或通过给其他类似元素提供不可见的边界）和嵌套元素来最小化填充/边距/边框组合，从而最小化盒子模型问题，这只会让你感到悲伤；
7.  不要费心试图让 CSS 菜单在所有浏览器上都可以使用。现在已经不是 2003 年了。只需使用 Javascript（例如 jQuery/superfish）。
8.  仅在链接上使用 :hover。如有必要，使用 display: block 更改它们。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-21T11:42:06.337

1.  在开始之前杀死所有默认样式。
2.  把迪恩爱德华兹的剧本扔给它。
3.  如果问题仍然存在，告诉用户升级。
4.  如果 IE6 很重要，请使用 IE 样式表来删除所有不起作用的部分并用不太复杂的样式替换它们。
5.  jQuery :hover 等到 .hover，input[type=submit] 到 input.submit 等。偶尔也会帮助旧版本的 FF 和 Opera。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-21T11:51:08.793

我昨天决定不再支持它了。有一种[运动开始试图杀死 IE 6](http://ie6.forteller.net/index.php?title=Main_Page)。

多亏了 IE 的条件注释，很容易为这些用户显示消息。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-21T12:09:45.253

我为 Chrome 构建它，然后我为 Firefox 优化大部分时间它只是一些小事，然后我进入 IE 8，然后我进入 IE 7，因为到那时我将消除大多数错误。在 IE 7 之后，我简要地看一下 Opera，一天的工作就结束了。谁再关心 IE 6？

您是否向英特尔制造商抱怨 CPU 不适合您的 comodore？有技术进步，我认为应该杀死 IE 6 最好的方法是告诉用户他必须升级，让网站看起来像垃圾，这是迫使他们切换的唯一方法。有些人最终会问他们的孩子为什么互联网坏了，然后儿子会过来安装所有更新，妈妈或爸爸可以再次开心。

简而言之，我的回答是：根本没有优化是我处理它的方式。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-17T03:26:33.047

通过鼓励用户升级到更好的东西——任何东西。

# ajax - 使用进度条将文件直接上传到 S3

> ID：478799
> 
> 赞同：15
> 
> 时间：2009-01-26T03:40:56.603
> 
> 标签：ajax, file-upload, amazon-s3, progress-bar

关于这个问题，[Upload files directly to Amazon S3 from ASP.NET application](https://stackoverflow.com/questions/117810/upload-files-directly-to-amazon-s3-from-asp-net-application)，有没有办法做到这一点并有一个进度条？

- - 编辑 - -

两天后，直接方法仍然没有运气。发现一件看起来很有希望但不是免费的东西：http: [//www.flajaxian.com/](http://www.flajaxian.com/)

使用 flash 直接上传到带有进度条的 S3。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T05:14:37.783

我也在寻找解决方案。也许这会有所帮助，

> [来自 AWS Dev Commnity](http://developer.amazonwebservices.com/connect/thread.jspa?messageID=91134&#91134) 但是在许多语言（PHP、Java）中，对于大文件，您必须使用流，语言环境将通过这些流一个接一个地获取大文件的块（以便用大量的中央内存填充上传所需的 S3 的 http POST 数据。
> 
> 关于流的好处是，每当读取下一个块以进一步将（在 https 意义上的）数据放入 S3 时，它们都会调用回调。您可以使用此回调来计算和显示客户端 UI 上的进度。
> 
> 请参阅 libcurl 的文档以详细了解这一切是如何工作的。

* * *

更新：看起来有两个简单的选择。

1.  [Flash，通过 FileReference 类](http://developer.amazonwebservices.com/connect/thread.jspa?messageID=96268&#96268)
2.  [使用 Java 小程序](http://developer.amazonwebservices.com/connect/thread.jspa?messageID=61167&#61167)

我个人讨厌使用 3rd 方扩展（Flash、Java）来制作应用程序功能，但我还没有找到其他方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-24T01:15:33.727

如果您不介意缺少浏览器支持，则 html5 javascript 可以让您执行此操作（仅在这篇文章中使用 Firefox 和 Chrome _此处示例：[https ://developer.mozilla.org/en/Using_files_from_web_applications](https://developer.mozilla.org/en/Using_files_from_web_applications)

这并不特定于 AWS，但可能会帮助您更接近。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2010-05-01T12:33:34.837

另一种方法是使用像 Uber Uploader ( [http://uber-uploader.sourceforge.net/](http://uber-uploader.sourceforge.net/) ) 这样的东西，这是一个带有进度条的 perl / php 混合解决方案。您只需将文件上传到您的服务器，然后让您的服务器在后台通过 FTP 将它们发送到最终目的地。这是一个额外的步骤，但它给了您一些时间来进行任何处理/编码等，您可能需要在发送到 S3 之前执行这些操作。

# java - 本地类 Java 的优势

> ID：478804
> 
> 赞同：26
> 
> 时间：2009-01-26T03:46:41.723
> 
> 标签：java, oop, class, local

Java 或任何其他使用此功能的语言中的本地类有什么优势？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-26T05:45:14.697

下面是一个匿名内部类、本地内部类和常规内部类如何出现在程序中的示例。该示例正在查看类中存在的`myMethod`方法和类。为了便于讨论，这些类都将实现接口：`InnerClass``MyClass``Runnable`

```
public class MyClass
{
    public void myMethod()
    {
        // Anonymous inner class        
        Runnable r = new Runnable() {
            public void run() {}
        };

        // Local inner class
        class LocalClass implements Runnable
        {
            public void run() {}
        }
    }

    // ... //

    // Inner class
    class InnerClass implements Runnable
    {
        public void run() {}
    }
} 
```

**匿名内部类**可以用来简单地创建一个实现的类，`Runnable`而无需实际写出类并命名它，正如[krosenvold](https://stackoverflow.com/questions/478804/advantage-of-local-classes-java#478874)在他的帖子中提到的，它在 Java 中被用作“穷人的闭包”。

例如，`Thread`使用匿名内部类启动一个非常非常简单的方法是：

```
new Thread(new Runnable() {
    public void run()
    {
        // do stuff
    }
}).start(); 
```

**本地内部类**可用于创建本地范围内的类——它不能从`myMethod`.

如果有另一个方法并且我们试图创建一个`LocalClass`位于该`myMethod`方法内部的实例，我们将无法这样做：

```
public void anotherMethod()
{
    // LocalClass is out of scope, so it won't be found,
    // therefore can't instantiate.
    new Thread(new LocalClass()).start();
} 
```

内部**类**是内部类所在类的一部分。因此，例如，内部类`InnerClass`可以通过`MyClass.InnerClass`. 当然，这也意味着另外一个方法`MyClass`也可以实例化一个内部类。

```
public void anotherMethod()
{
    // InnerClass is part of this MyClass. Perfectly instantiable.
    new Thread(new InnerClass()).start();
} 
```

关于匿名内部类和本地内部类的另一件事是，它将能够访问`final`在以下声明中声明的变量`myMethod`：

```
public void myMethod()
{
    // Variable to access from anonymous and local inner classes.
    final int myNumber = 42;

    // Anonymous inner class        
    Runnable r = new Runnable() {
        public void run()
        {
            System.out.println(myNumber); // Works
        }
    };

    // Local inner class
    class LocalClass implements Runnable
    {
        public void run()
        {
            System.out.println(myNumber); // Works
        }
    }

    // ... // 
```

那么，有哪些优势呢？使用匿名内部类和本地内部类而不是使用单独的成熟内部类或类将允许前者访问`final`声明它们的方法中的变量，同时，这些类对于方法本身，因此不能从外部类和同一类中的其他方法访问它。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-26T14:22:45.497

使用本地类可以做很多匿名内部类无法做到的事情。

*   因为类型有名字，你可以更有用地添加不在超类型中的成员
*   给定的名称可以使堆栈跟踪更容易跟踪（特别是对于锁定对象）
*   亚型多于一种基本类型
*   在多个地方构造，以及多个构造函数

另一方面，它们使一些极其冗长的语法变得更加混乱。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-26T03:58:33.977

它们允许您从父类中取出逻辑并将其对象化。这会从它不属于的地方删除功能并将其放入自己的类中。但是如果这个新对象只需要很短的时间，只需要一个代码块的持续时间呢？嗯，这就是本地类适合的地方。

# c# - 如何优化此 SQL 查询（来自 C#）

> ID：478805
> 
> 赞同：1
> 
> 时间：2009-01-26T03:47:38.290
> 
> 标签：c#, sql

我是数据库编程的新手，需要帮助优化此查询：

给定表 A、B 和 C，并且我对它们中的每一列感兴趣，如何编写查询以便我可以在 C# 代码中将每个表中的一列放入 3 个不同的数组/列表中？

我目前正在对数据库运行三个不同的查询，但希望在一个查询中完成相同的查询（以节省 2 次访问数据库）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-26T03:59:18.763

使用存储过程，您可以从数据库返回多个结果集，并让数据集填充多个表，然后您可以访问这些表并填充数组/列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T03:59:32.603

您可以执行 3 个不同的 SELECT 语句并在 1 个调用中执行。您将获得 3 个结果集。您如何利用这些结果取决于您使用的数据技术。林克？数据集？数据适配器？数据阅读器？如果您可以提供该信息（甚至可能是示例代码），我可以准确地告诉您如何获得所需的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T05:49:54.080

不确定这是否正是您的想法，但您可以这样做（只要所有三列都是相同的数据类型）：

```
select field1, 'TableA' as TableName from tableA
UNION
select field2, 'TableB' from tableB
UNION
select field3, 'TableC' from tableC 
```

这将为您提供一个包含所有记录的大结果集。然后，您可以使用数据阅读器来读取结果，跟踪前一条记录的 TableName 值是什么，并且每当它发生变化时，您就可以开始将列值放入另一个数组中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T05:56:16.970

走三趟。到目前为止的答案表明你需要从“新到数据库编程”前进多远才能做你想做的事。先掌握最简单的方法。

如果它们是三个巨大的结果，那么我怀疑您正在尝试在 C# 中做一些最好在数据库上的 SQL 中完成而不带回数据的事情。如果没有更多细节，这听起来有点像反模式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T06:04:02.943

@patmortech 如果您不关心重复值或者只能获取唯一值（因为您通过主键或唯一键进行查询），请使用 UNION ALL 而不是 UNION。UNION ALL 的性能要快得多。

SQL 中没有“数组”的含义。有表、行和列。结果集返回一组行和列。你能提供一个你正在寻找的例子吗？（源表和示例数据的 DDL 会很有帮助。）

正如其他人所说，您可以在单个执行语句中向服务器发送多个查询，并通过 ADO.NET 返回多个结果集。您使用 DataReader .NextResult() 命令返回下一个结果集。

有关更多信息，请参见此处： [MSDN](http://msdn.microsoft.com/en-us/library/haa3afyz.aspx)

部分：**使用 NextResult 检索多个结果集**

**这是一些示例代码：**

```
static void RetrieveMultipleResults(SqlConnection connection)
{
    using (connection)
    {
        SqlCommand command = new SqlCommand(
          "SELECT CategoryID, CategoryName FROM dbo.Categories;" +
          "SELECT EmployeeID, LastName FROM dbo.Employees",
          connection);
        connection.Open();

        SqlDataReader reader = command.ExecuteReader();

        while (reader.HasRows)
        {
            Console.WriteLine("\t{0}\t{1}", reader.GetName(0),
                reader.GetName(1));

            while (reader.Read())
            {
                Console.WriteLine("\t{0}\t{1}", reader.GetInt32(0),
                    reader.GetString(1));
            }
            reader.NextResult();
        }
    }
} 
```

# c++ - StringStream 循环失败

> ID：478806
> 
> 赞同：4
> 
> 时间：2009-01-26T03:48:07.150
> 
> 标签：c++

我正在阅读这种格式的文本文件：

> grrr，一些文本，45.4321,54.22134

我只是将我的双值存储在一个字符串变量中。

为什么它只给我字符串的第一个数字？

如果我只使用一个 while 循环和这种新格式的文本文件重新开始：

> 21.34564

它可以正常工作。

问题是，`sLine`与我重新开始时的价值相同。不同的是最有可能导致问题的三个嵌套 for 循环。

这是让我得到我想要的代码：

```
#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <iomanip>
#include <cstdlib>
#include <sstream>

using namespace std;

int main()
{
    string usrFileStr,
    fileStr = "test.txt",  // declaring an obj string literal
    sBuffer,
    sLine,
    str;

    double dValue ;

    int lineCount = 1;
    int nStart;
    istringstream issm;

    fstream inFile;                  // declaring a fstream obj
    // cout is the name of the output stream
    cout << "Enter a file: ";
    cin >> usrFileStr;

    inFile.open( usrFileStr.c_str(), ios::in ); 
    // at this point the file is open and we may parse the contents of it

    while ( getline ( inFile, sBuffer ) && inFile.eof() )
    {
          cout << "Original String From File: " << sBuffer << endl;

          cout << "Modified Str from File: " << fixed << setprecision(2) 
          << dValue << endl;
    }

    fgetc( stdin );
    return 0;
} 
```

所以它就像它应该的那样工作。但是我无法让它在 for 循环中工作，或者当我的文本文件中有多个字段时......

```
With this code, why is it taken off the decimal?

#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <iomanip>
#include <cstdlib>
#include <sstream>
#include <errno.h>

using namespace std;

int main()
{
    string usrFileStr,
    myFileStr = "myFile.txt",  // declaring an obj string literal
    sBuffer, 
    sLine = "";

    istringstream inStream;

    int lineCount = 1;
    int nStart;
    double dValue = 0,
    dValue2 = 0;
    float fvalue;

    fstream inFile;                  // declaring a fstream obj
    // cout is the name of the output stream
    cout << "Enter a file: ";
    cin >> usrFileStr;

    inFile.open( usrFileStr.c_str(), ios::in ); 
    // at this point the file is open and we may parse the contents of it

    if ( !inFile )
    {
         cout << "Not Correct " << endl;
    }

    while ( getline ( inFile, sBuffer ) )
    {
          nStart = -1 ;

          for ( int x = nStart + 1; x < sBuffer.length(); x++ )
          {
              if ( sBuffer[ x ] == ',' )
              {
                   nStart = x;
                   break;
              }

              cout << sBuffer[ x ];
          }

          for ( int x = nStart + 1; x < sBuffer.length(); x++ )
          {

              if ( sBuffer[ x ] == ',' )
              {    
                   nStart = x;
                   break;
              }

              cout << sBuffer[ x ];
          }

          for ( int x = nStart + 1; x < sBuffer.length(); x++ )
          {   

              if ( sBuffer[ x ] == ',' )
              {
                   nStart = x;
                   break;
              }

              sLine = sBuffer[ x ];
              inStream.clear();
              inStream.str( sLine );

              if ( inStream >> dValue )
              cout << setprecision(1) << dValue;

          }

          for ( int x = nStart + 1; x < sBuffer.length(); x++ )
          {
              if ( sBuffer[ x ] == ',' )
              {
                   nStart = x;
                   break;
              }

              sLine = sBuffer[ x ];     
              inStream.clear();
              inStream.str( sLine );

              if ( inStream >> dValue2 )
                  cout << setprecision(1) << dValue2;    
          }

          cout << ") \n";
          lineCount++;
    }

    cout << "There are a Total of: " << lineCount -1 << " line(s) in the file."
    << endl;

    inFile.clear();           // clear the file of any errors
    inFile.close();  // at this point we are done with the file and may close it

    fgetc( stdin );
    return 0;
} 
```

我没有任何其他字符可以在第一个代码中循环，因为我只是读取了一个不错的小双精度值。

在我的第二个代码中，在我想要的那个之前我有很多字符要访问。但无论如何，它仍然与其他字符隔离，并且仍然在它自己的变量中。我很想知道问题出在哪里：/尽管我认为它是 for 循环。

我也试过 atof 但我得到一个小数点应该是'0'。strtod 很难，因为我不需要将数据读入 const char *cPtr

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T04:40:04.300

您的代码有点难以阅读。您可能想考虑一些关于封装并将其分解为函数的观点。

`>>`此外，我会尽量避免读取单个字符，并使用各种函数和方法来读取字段中的数据——您可以使用流提取器读取整个浮点数或整数。

最后，要学习的一项有用技能是如何使用调试器。您可以单步执行代码并检查变量的值。

也就是说，看起来你的问题在这里：

```
 if ( sBuffer[ x ] == ',' )
          {
               nStart = x;
               break;
               }

          **** sLine = sBuffer[ x ];     
          inStream.clear();
          inStream.str( sLine );

          if ( inStream >> dValue2 )
          cout << setprecision(1) << dValue2; 
```

在标有“****”的行上，您将一个字符放入名为“sLine”的变量中。完成此操作后，您将该字符转换为双精度变量 dValue2，然后将其输出。应该很明显为什么这个字符会转换为您想要的数字的第一位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T08:44:57.347

使用***instream>>dvalue***肯定是**正确**的做事方式。但有时正确的事情并不总是最简单或最好的。

我们可以这样做：

```
int
main()
{
  string s = "grrr,some text,45.4321,54.22134";
  double a,b;

  ASSERT_IS( 2, sscanf( s.c_str(), "%*[^,],%*[^,],%lf,%lf", & a, & b ) );

  cout << setprecision(8);
  SHOW(a);
  SHOW(b);
} 
```

或者也许像这样的东西，虽然效率较低，但可能更容易理解......

```
int
main()
{
  string s = "grrr,some text,45.4321,54.22134";
  vector<string> v;

  StringSplit( & v, s, "," );

  cout << setprecision(8);
  SHOW(v);
  SHOW(atof(  v[2].c_str()));
  SHOW(strtod(v[3].c_str(), (char**)NULL));
} 
```

假设：

```
#define SHOW(X)  cout << # X " = " << (X) f << endl

    /* A quick & easy way to print out vectors... */
template<class TYPE>
inline ostream & operator<< ( ostream & theOstream,
                              const vector<TYPE> & theVector )
{
  theOstream << "Vector [" << theVector.size() << "] {"
             << (void*)(& theVector) << "}:" << endl;

  for ( size_t i = 0;  i < theVector.size();  i ++ )
    theOstream << "    [" << i << "]:   \"" << theVector[i] << "\"" << endl;

  return theOstream;
}

inline void
StringSplit( vector<string> * theStringVector,  /* Altered/returned value */
             const  string  & theString,
             const  string  & theDelimiter )
{
  UASSERT( theStringVector, !=, (vector<string> *) NULL );
  UASSERT( theDelimiter.size(), >, 0 );

  size_t  start = 0, end = 0;

  while ( end != string::npos )
  {
    end = theString.find( theDelimiter, start );

      // If at end, use length=maxLength.  Else use length=end-start.
    theStringVector -> push_back( theString.substr( start,
                   (end == string::npos) ? string::npos : end - start ) );

      // If at end, use start=maxSize.  Else use start=end+delimiter.
    start = (   ( end > (string::npos - theDelimiter.size()) )
              ?  string::npos  :  end + theDelimiter.size()     );
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T04:40:06.483

两点：

*   您可能想使用[`sBuffer.find(',')`](http://www.cplusplus.com/reference/string/string/find.html)
*   您设置`sLine`为“，”之前的最后一个字符，这是故意的吗？您只能以这种方式正确解析单个数字。

# javascript - Prototype.js 和关联数组

> ID：478815
> 
> 赞同：1
> 
> 时间：2009-01-26T03:56:01.097
> 
> 标签：javascript, prototypejs

我有以下结构的关联数组（对象）

```
var menu = new Object('Submenu A','Submenu B','Submenu C','Submenu D');
menu['Submenu A']=new Object();
menu['Submenu A']['Option A']= 'foo blah text';
menu['Submenu A']['Option B']= 'blah more text';
menu['Submenu B']['Option A']= 'blah blah';
menu['Submenu B']['Option B']= 'texty text';
...
etc. 
```

这是在 for..in 循环上迭代的，该循环在使用原型时由于使用 toJSON() 和 camelise() 等方法扩展类而中断

我尝试使用 Prototype 的 .each 方法，但是它错误地报告菜单 ['Submenu A'] 未定义，它似乎无法找到它下定义的选项。

在原型中迭代关联数组的正确方法是什么？

进一步澄清（感谢到目前为止的答案）。我正在慢慢地将一个项目迁移到使用原型，但是它有大量的代码还不兼容原型。有问题的代码位于其他几个文件使用的库中。函数调用的代码，initialize_menu 并包含代码

```
for (var i=0; i < menu.length; i++) {
    populate_sub_menu(menu[i])
} 
```

子菜单功能的结构是这样的

```
function populate_sub_menu(subMenu){
    for (var option in menu[subMenu]) {
        html+=menu[subMenu][option]+'html'+subMenu+option;
    }
} 
```

我省略了有关获取 html 元素的代码以及与问题无关的代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-26T05:15:41.327

要创建一个没有属性的新对象，请使用：

```
var menu = new Object(); 
```

Object 构造函数实际上采用一个可选参数。现在让我们看看你有什么：

```
var menu = new Object('Submenu A','Submenu B','Submenu C','Submenu D'); 
```

只有第一个参数 ( `'Submenu A'`) 被使用，而其他参数被简单地忽略。但是，将字符串文字传递给 Object 构造函数会导致`String`返回一个新对象而不是一个`Object`对象。我推测，这可能是 Prototype`each()`正在发挥作用的原因（如果它真的因此而失败）。

您提到“报告菜单 ['SubmenuA'] 未定义时出错”。你的问题有错字吗？您正在设置“子菜单 A”属性，在“A”之前有一个空格，而您报告的错误似乎缺少空格。

您似乎在设置对象属性方面也采取了漫长的路线。使用对象字面量语法会更短，更不容易出错：

```
var menu = {
    "Submenu A": {
        "Option A": "foo blah text",
        "Option B": "blah more text"
    },
    "Submenu B": {
        "Option A": "blah blah",
        "Option B": "texty text"
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T04:24:42.863

你想要原型的[Hash](http://www.prototypejs.org/api/hash)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T04:50:50.067

使用[hasOwnProperty](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Object/hasOwnProperty)方法，该方法只会为您在对象实例上定义的属性返回 true：

```
 for (var option in menu[subMenu]){
    if(menu[subMenu].hasOwnProperty(option)){
      html+=menu[subMenu][option]+'html'+subMenu+option;
    }
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T04:26:41.877

您可以简单地检查当前对象是否属于您正在寻找的类型（或者您试图避免的类型，例如函数）。

# css - YUI grids.css 真的那么灵活吗？

> ID：478825
> 
> 赞同：7
> 
> 时间：2009-01-26T04:10:21.100
> 
> 标签：css, yui, yui-grids

雅虎的 YUI 项目有一些非常棒的、经过良好测试的组件，我刚刚开始将它们集成到我的（固定宽度）站点中。我实际上非常兴奋——我已经有一段时间远离面向消费者的网站创建了，看到过去几年的发展让我很开心。

非常喜欢 YUI 组件和 reset.css - 我认为我使用[Yahoo YUI grids.css](http://developer.yahoo.com/yui/grids/)是不费吹灰之力的。事实上，他们说自己卖得很好：

> “结合页面宽度、模板预设和嵌套网格，可以实现几乎无限数量的复杂页面布局”
> 
> *（来自上面的 grids.css 链接）*

但是，我正在尝试做一些非常简单的 3 列布局，但似乎无法做一些基本的事情——在如何做这些事情的文档中也找不到很好的解释。

例如：

*   我可以更改列之间的排水沟吗？
*   将 1/2、2/3、1/4 类型的布局相互嵌套非常容易，但我可以嵌套`yui-t1`模板吗？
    *   （我确实获得了有限的成功嵌套`yui-t1`选择器，但最终有多个 div 具有相同的 id，这让我相信我做错了什么。

我的网站更多地是“设计驱动”——也就是说，有一个需要制作成页面的 Photoshop 标记。

到目前为止，我的印象是 YUI Grid 适用于更多“内容驱动”的网站，在这些网站中，您可以获得诸如新闻之类的内容，而这些内容不一定必须适合精确的设计。这是一个公平的说法 - 还是我错过了使用 grids.css 的一些魔术？

我是否更适合使用具有固定定位的替代网格？

* * *

[YUI 的替代品](https://stackoverflow.com/questions/348626/is-there-something-similiar-to-yui-grid) - 如另一个 stackoverflow 帖子中所提供

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-06-21T18:16:57.430

此答案由 Nate Koechley 在[YUI 论坛上](http://yuilibrary.com/forum/viewtopic.php?p=1129#p1129)提供- YUI 高级工程师，YUI 团队

> **我建议人们不要直接接触**作为网格骨架的节点。当然，欢迎您，**但正如您所注意到的，这会影响他们的稳定性和行为**。

和

> 我认为**最好将 Grids 的节点保留为未触及的骨架**，**并将您的内容标记放在该结构**中。是的，它有点额外的标记，但我认为它是封装**，因为您的内容可以自由且安全地独立于网格移动**。

我希望**它对**想要使用 YUI 网格的人有用

**更新**

假设这里有一些 yui-grid 标记

```
<div class="yui-g">
    <div class="yui-u first"></div>
    <div class="yui-u"></div>
</div> 
```

你想增加一些额外的利润。正如 Nate 所说，**添加一些额外的标记**

```
<div class="yui-g">
    <div class="yui-u first">
        <div class="specialCss">
            your content goes here
        </div>
    </div>
    <div class="yui-u">

    </div>
</div> 
```

并定义它的边距，填充等......

```
.specialCss {
    margin:10px;
} 
```

**这样你就不会影响 YUI CSS 网格的稳定性和行为**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-26T19:19:15.553

您可以通过覆盖边距属性来更改装订线。您可以通过覆盖 .yui-gb { } 等选择器或您使用的任何布局来全面执行此操作。如果您只想做一组特定的列，您可以添加另一个类并使用它，只需确保您具有比 YUI 规则更多的特异性（或相同且您的规则在 CSS 文件中较低）。

我不认为这些模板是可嵌套的，因为它们被设计成一个快速抛出的东西来做一个完整的页面。

创建网格的方式是专门为满足我们获得的页面大小而设计的，这些大小由我们自己的 UED 指南和我们的广告格式控制。没有什么可以阻止您将框架用作基本框架并覆盖确切的宽度/排水沟等。

免责声明：我为 Y 工作！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T09:01:51.447

听起来您需要对 YUI Grids 的默认设置进行大量自定义，对我来说，这在一定程度上违背了使用它的意义——或者更确切地说，它的灵活性降低了，因此效率降低了。

你看过 Nate Koechley 的演讲了吗？从记忆中，我认为他确实提到了可以更改列之间的排水沟并解释了如何进行自定义。

[http://developer.yahoo.com/yui/grids/](http://developer.yahoo.com/yui/grids/)

基本上，您可以深入研究网格的 CSS 文件并确定列之间的间距设置在哪里，并在您自己的 CSS 文件中进行调整。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-14T21:13:56.137

只是想提一下，在新的 YUI 3 网格中，有一个关于如何指定网格间距的具体示例。

[http://developer.yahoo.com/yui/3/examples/cssgrids/cssgrids-units.html](http://developer.yahoo.com/yui/3/examples/cssgrids/cssgrids-units.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T14:45:49.023

如果您确实研究了 YUI 的替代品，请查看 Blueprint CSS Generator ( [http://kematzy.com/blueprint-generator/](http://kematzy.com/blueprint-generator/) )。这是自定义 CSS 网格（基于[Blueprint CSS](http://www.blueprintcss.org/)）的好方法。

不幸的是，我不知道 YUI 是否有类似的工具。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-10T03:42:56.513

[YUI 3 网格](http://developer.yahoo.com/yui/3/cssgrids/)功能强大。灵活、稳定**、简单**。看一看。

# c# - C# 文件路径重装

> ID：478826
> 
> 赞同：21
> 
> 时间：2009-01-26T04:12:42.700
> 
> 标签：c#, .net, filenames, case-sensitive, filepath

我正在尝试用 C# 编写一个静态成员函数，或者在 .NET Framework 中找到一个将文件路径重新设置为文件系统指定的文件路径的函数。

例子：

```
string filepath = @"C:\temp.txt";
filepath = FileUtility.RecaseFilepath(filepath);

// filepath = C:\Temp.TXT
// Where the real fully qualified filepath in the NTFS volume is C:\Temp.TXT 
```

我已经尝试了下面的以下代码及其许多变体，但它仍然无法正常工作。我知道 Windows 通常不区分大小写，但我需要将这些文件路径传递给 ClearCase，它考虑文件路径大小写，因为它是 Unix 和 Windows 应用程序。

```
public static string GetProperFilePathCapitalization(string filepath)
{
    string result = "";

    try
    {
        result = Path.GetFullPath(filepath);
        DirectoryInfo dir = new DirectoryInfo(Path.GetDirectoryName(result));
        FileInfo[] fi = dir.GetFiles(Path.GetFileName(result));
        if (fi.Length > 0)
        {
            result = fi[0].FullName;
        }
    }
    catch (Exception)
    {
        result = filepath;
    }

    return result;
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-26T09:12:09.740

这是一个非常简单的实现，假设文件和目录都存在并且可以访问：

```
static string GetProperDirectoryCapitalization(DirectoryInfo dirInfo)
{
    DirectoryInfo parentDirInfo = dirInfo.Parent;
    if (null == parentDirInfo)
        return dirInfo.Name;
    return Path.Combine(GetProperDirectoryCapitalization(parentDirInfo),
                        parentDirInfo.GetDirectories(dirInfo.Name)[0].Name);
}

static string GetProperFilePathCapitalization(string filename)
{
    FileInfo fileInfo = new FileInfo(filename);
    DirectoryInfo dirInfo = fileInfo.Directory;
    return Path.Combine(GetProperDirectoryCapitalization(dirInfo),
                        dirInfo.GetFiles(fileInfo.Name)[0].Name);
} 
```

但是有一个错误：相对路径被转换为绝对路径。您上面的原始代码也是如此，所以我假设您确实想要这种行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T12:13:28.423

在我测试的范围内，以下工作正常......唯一的问题是使用的 API 仅在 Vista 中可用。

```
static void Main(string[] args)
{
    using (FileStream fs = File.OpenRead(@"D:\temp\case\mytest.txt"))
    {
        StringBuilder path = new StringBuilder(512);
        GetFinalPathNameByHandle(fs.SafeFileHandle.DangerousGetHandle(), path, path.Capacity, 0);
        Console.WriteLine(path.ToString());
    }
}

[DllImport("kernel32.dll", SetLastError = true)]
static extern int GetFinalPathNameByHandle(IntPtr handle, [In, Out] StringBuilder path, int bufLen, int flags); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T04:53:41.247

您可以搜索您想要获取案例的文件并返回搜索结果（您想要检查存在的文件的大小写，对吗？）。像这样的东西：

```
public static string GetProperFilePathCapitalization(string filepath) {
   string directoryPath = Path.GetDirectoryName(filepath);
   string[] files = Directory.GetFiles(directoryPath, Path.GetFileName(filepath));
   return files[0];
} 
```

这是你要找的吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T07:19:45.880

我有更有效的东西，但是：

1）它似乎不适用于所有情况。（我还没有弄清楚它正确获取大小写的文件和目录的模式，以及不正确获取大小写的文件和目录的模式。）

2) 它是 Windows 特定的。

```
static string GetProperFilePathCapitalization1(string filename)
{
    StringBuilder sb = new StringBuilder(260);
    int length = GetLongPathName(filename, sb, sb.Capacity);

    if (length > sb.Capacity)
    {
        sb.Capacity = length;
        length = GetLongPathName(filename, sb, sb.Capacity);
    }

    if (0 == length)
        throw new Win32Exception("GetLongPathName");

    return sb.ToString();
}

[DllImport("kernel32.dll")]
static extern int GetLongPathName(string path, StringBuilder pszPath, int cchPath); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-07T22:20:04.297

上面@Ants 的答案*绝对*应该被认为是公认的答案。但是，我根据我的目的对其进行了一些重构。该方法被打包为 FileInfo 和 DirectoryInfo 的扩展方法，并返回正确的方法。

```
public static DirectoryInfo GetProperCasedDirectoryInfo(this DirectoryInfo dirInfo)
{
    // Inspired by http://stackoverflow.com/a/479198/244342

    if (!dirInfo.Exists)
    {
        // Will not be able to match filesystem
        return dirInfo;
    }

    DirectoryInfo parentDirInfo = dirInfo.Parent;
    if (parentDirInfo == null)
    {
        return dirInfo;
    }
    else
    {
        return parentDirInfo.GetProperCasedDirectoryInfo().GetDirectories(dirInfo.Name)[0];
    }
}

public static FileInfo GetProperCasedFileInfo(this FileInfo fileInfo)
{
    // Inspired by http://stackoverflow.com/a/479198/244342

    if (!fileInfo.Exists)
    {
        // Will not be able to match filesystem
        return fileInfo;
    }

    return fileInfo.Directory.GetProperCasedDirectoryInfo().GetFiles(fileInfo.Name)[0];
} 
```

我一直在努力解决 FileInfo 的一些大小写不一致问题。为了确保稳健性，我在比较或存储路径时转换为全部大写。为了阐明代码的意图，我还有这些扩展方法：

```
public static string GetPathForKey(this FileInfo File)
{
    return File.FullName.ToUpperInvariant();
}

public static string GetDirectoryForKey(this FileInfo File)
{
    return File.DirectoryName.ToUpperInvariant();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-04T10:29:31.850

您将希望系统为您找到该文件。我通过假装我不知道确切的路径来做到这一点，即进行系统*搜索*：

```
var fileName = Path.GetFileName(filePath);
var dir = Path.GetDirectoryName(filePath);
var filePaths = Directory.GetFiles(dir, fileName, SearchOption.TopDirectoryOnly);
var caseCorrectedFilePath = filePaths.FirstOrDefault(); 
```

所以我们在目录中搜索，过滤确切的文件名并将搜索限制在当前目录（无递归）。

这将返回一个字符串数组，其中包含具有正确大小写的单个文件路径（如果文件存在）或不包含任何内容（如果文件不存在）。

一个警告：您可能需要在输入路径中禁止通配符，因为这种方法接受它们并可能因此找到多个文件。

**编辑**

驱动器号似乎仍然遵循我们提供的大小写。此外，这需要针对 UNC 路径进行测试。

# c# - NHibernate 更新不起作用

> ID：478827
> 
> 赞同：9
> 
> 时间：2009-01-26T04:14:33.570
> 
> 标签：c#, asp.net-mvc, nhibernate, orm

我无法让我的更新工作。测试失败，我没有看到任何更新语句被发送到数据库。有人可以告诉我我做错了什么吗？

这是我的存储库更新过程：

```
public void UpdateProject(Project proj)
{
    Session.Update(proj);
} 
```

这是我正在尝试的单元测试：

```
[Test]
public void Can_Update_A_Project()
{
    var project = _projects[0];
    project.Name = "test project";

    repository.UpdateProject(project);

    var fromDb = repository.GetAProject(_projects[0].ID);
    Assert.AreEqual(project.Name, fromDb.Name);        
} 
```

测试总是失败。我看到正在插入测试数据，并且看到了测试的选择。我没有看到正在执行更新。我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-26T11:02:27.367

有几件事可能正在发生。

1) 更新失败，NHibernate 引发异常，该异常正在某处被吞没——这可能会发生，具体取决于您的配置方式。所以在 VS 中确保所有异常都会导致中断。

2）更新被缓存而不是直接写入数据库 - 您可以使用强制写入数据`Repository.Flush();`

3）您确定 _projects[0] 已从数据库中读取 - 我假设这是在 TestSetup 中发生的？如果不是，NHibernate 将不会意识到这是一个受其“控制”的对象。

顺便说一句-最好在测试本身中读取要更改的数据，然后撤消该更改，将数据库重置为原始状态。这样，您的测试数据库就不会被您的测试改变。

BTW2 - 在上述测试中，如果 project.Name 已经更新过一次，即测试已经成功运行。然后即使更新本身失败，下次测试也会成功。避免这种情况的一种方法 - 将 DateTime 附加到 project.Name，不要将其设置为固定值。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-26T11:36:26.643

Another thing is this: when you save an entity using a session and you load the same entity from the same session using the entity's ID, you will get the same instance that you saved - regardless of whether any inserts or updates have been issued to the database.

That's because of NHibernate's 1st level cache, which is an identity map that belongs to the session.

If you want your test to check what was actually written to the database, you may do it like so:

```
session.Save(someEntity);
session.Flush(); // forces the entity to be inserted
session.Clear(); // clears the session's identity map, thus
                 // detaching someEntity from the session

var loadedEntity = session.Get<EntityType>(someEntity.Id);

// now you may compare the fields of someEntity and loadedEntity
// to verify that they were actually persisted 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-29T02:28:28.337

`ISession.Update`在 NHibernate 中不会提交对数据库的更改。它用于在与用于检索实例的会话不同的会话中更新瞬态实例（有关详细信息，请参见[此处](http://nhforge.org/doc/nh/en/index.html#manipulatingdata-updating)）。刷新会话时会将更改发送到数据库。默认情况下，会话在 FlushOnCommit 模式下运行，这意味着当 NHibernate 事务提交时，对对象的更改将发送到数据库（有关不同刷新模式的详细信息，请参见[此处](http://nhforge.org/doc/nh/en/index.html#manipulatingdata-flushing)）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-17T17:58:24.110

试试这个可能是我错了，但它的作品

```
 公共无效更新项目（项目项目）
 {
    ISessionFactory 会话工厂；

    ISession 会话 = SessionFactory.OpenSession();

    使用 (ITransaction 事务 = session.BeginTransaction())
    {

      会话.更新（项目）；
      事务.Commit();

    }
 }

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-12T17:38:32.603

## `FlushMode`！

我正在维护一个我没有编写的应用程序，并且发现即使您使用事务并调用`txn.Commit()`，如果您的 NHibernate Session 具有**`session.FlushMode = FlushMode.Never`**.

非常容易检测。设置断点并查看`session.FlushMode`. 或者只是在所有 *.cs 文件中搜索 FlushMode。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-02T14:46:54.683

我最近遇到了同样的问题。

1.  插入工作
2.  更新没有

问题是编码中的一个缺陷。如果行发生更改，则检查数据，然后映射新实体，并发送更新，但什么也没发生。

**解决方案：**必须从数据库中查询实际行，然后将 C# 中的更改应用于被拉回的行。现在 NHibernate 知道行已更改，运行保存并且一切正常。

```
 public void SaveChanges()
  {
      _session.Flush();
      _session.Transaction.Commit();
      _session.BeginTransaction();
  } 
```

# c# - C#：将数据写入块是什么？数据队列乱码 [Redux]

> ID：478832
> 
> 赞同：0
> 
> 时间：2009-01-26T04:22:32.103
> 
> 标签：c#

在[这个问题](https://stackoverflow.com/questions/478616/why-in-c-is-queue-scrambling-the-data-in-its-elements)中，我询问了如何在 C# 中使用队列和线程。我发现锁定将数据写入文件的代码解决了我的问题。其中一位[回答者](https://stackoverflow.com/users/20029/zach-scrivena)认为问题在于数据被写入为[“块”](https://stackoverflow.com/questions/478616/why-in-c-is-queue-scrambling-the-data-in-its-elements#478630)。

这是因为数组是引用对象吗？换个方式问

```
int[] a = {1, 2 ,3, 4};
int[] b = int[4];
b=a;
a[1]=5; 
```

b[1]=1 仍然存在吗？我会这么想吗？那么，Zach 将数据“作为一个块”写入是什么意思？

谢谢

阿齐姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T04:50:13.950

b[1] 不再存在，将被垃圾回收。

您创建数组 a。

您创建数组 b。

当你说 b=a 时，你丢弃了对数组 b 的引用。

b[1] 和 a[1] 现在指向同一个数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T05:06:20.877

为了创建一个*我*需要写的副本

```
b=(int[])a.Clone(); 
```

代替

```
b=a; 
```

因为在 C# 中，数组是引用类型。

# c# - 如何使用 GetThemeFont 读取字体数据？

> ID：478835
> 
> 赞同：0
> 
> 时间：2009-01-26T04:25:02.833
> 
> 标签：c#, winapi, msstyles

我正在尝试使用 GetThemeFont 从视觉样式中读取字体数据，但我似乎无法让它返回任何内容。这是我使用它的方式：

```
IntPtr h = OpenThemeData(this.Handle, "Button");
LOGFONT font = new LOGFONT();
int r = GetThemeFont(h, IntPtr.Zero, 1, 1, 210, out font);
CloseThemeData(h); 
```

返回值始终为“-2147023728”，字体始终为空。我放 210（用于 TMT_FONT）的地方，我不太确定在那里用什么。对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T05:18:51.943

-2147023728 是 0x80070490L 的十进制等效值，它是分配给 的值`E_PROP_ID_UNSUPPORTED`。从 GetThemeFont 文档的“备注”部分：

> 如果指定的部分和状态不支持该属性，则可能会返回 E_PROP_ID_UNSUPPORTED。

您传入的部件和状态组合不支持该属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-15T18:18:14.560

请参阅此要点[https://gist.github.com/1219126](https://gist.github.com/1219126)

除了 null 或不受支持的结果之外，您永远不会得到任何东西。此外，如果您尝试在托管应用程序中使用 TMT_FONT (210) 将丢弃一个很好的内存错误并清除堆栈（谁知道是什么原因）。

VisualStyleRenderer.GetFont 和/或 GetThemeFont 的内部本质上存在缺陷。我正在尝试与 MS 的一些人合作解决这个问题，并提供解决方法、更多文档或一些确认这已被破坏。

# c# - 以编程方式创建 PowerPoint 演示文稿

> ID：478838
> 
> 赞同：50
> 
> 时间：2009-01-26T04:27:47.507
> 
> 标签：c#, ms-office, powerpoint

有没有办法以编程方式创建 PowerPoint 演示文稿？如果可能，我想使用 C# 并创建 PowerPoint 2003 演示文稿。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-01-26T04:41:31.660

是的你可以。

您将需要查看 MSDN，它对它有很好的介绍。

我可能会给你一个警告，Microsoft Office 互操作与一个已有 10 多年历史的 API 兼容。因此，有时使用起来非常讨厌。如果你有钱投资一两本好书，我认为这笔钱花得值。

这是您的起点。使用 MSDN [MSDN 网页](http://msdn.microsoft.com)上的搜索功能。它适用于任何 Microsoft C# .NET 风格的东西。

特别是关于您的问题，此链接应该会有所帮助：[Automate PowerPoint from C#](http://support.microsoft.com/kb/303718/)。EDIT LINK NOW DEAD :(。这两个链接非常接近原始知识库文章：

[从 C# 1/2 自动化 Powerpoint](https://code.msdn.microsoft.com/office/CSAutomatePowerPoint-b312d416)

[从 C# 2/2 自动化 Powerpoint](https://code.msdn.microsoft.com/office/How-to-Automate-control-23cd2a8f)

最后，对于不赞成这一点的人：我们有一天都在学习，作为初学者如何做某事绝对是与编程相关的，不管一个人有多新。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-06-18T20:01:37.180

[OpenXML](http://msdn.microsoft.com/en-us/library/bb448854%28v=office.15%29.aspx)看起来像是从 Web 应用程序出发的方式。

正如其他人所说，不建议使用互操作库。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-26T08:12:40.720

您还可以查看[Aspose Slides](http://www.aspose.com/categories/file-format-components/aspose.slides-for-.net-and-java/default.aspx)，这是一个用于 .NET 和 Java 的组件，可以轻松生成 powerpoint 文档。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-26T04:49:24.607

如果您真的不需要与 PowerPoint 兼容的输出，请考虑使用带有 Beamer 包的 LaTeX 等标记语言来生成演示文稿的 PDF，或者以类似于[Slidy](http://www.w3.org/Talks/Tools/Slidy/)的方式使用 HTML 和 javascript 。如果您需要精美的效果，使用 SVG 可能仍然更容易，并且您将获得可以使用免费软件可靠查看的输出的好处。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-26T06:39:15.290

[http://msdn.microsoft.com/hi-in/magazine/cc163471(en-us).aspx](http://msdn.microsoft.com/hi-in/magazine/cc163471(en-us).aspx)

使用此链接。虽然这是在 VB.NET 中，但 C# 支持相同。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-02-17T16:08:33.120

您还可以试用*SlideMight*，这是一种用于将分层数据与 PowerPoint 模板合并的工具。

SlideMight 支持：

*   文本字段、表格和注释中的文本替换
*   图像替换，来自原始数据、文件和 URL
*   嵌套表格中的图像
*   迭代数据以创建幻灯片
*   迭代填充表格，可能跨越多张幻灯片
*   特定单元格值的特殊格式
*   生成幻灯片的超链接

输入数据格式此时只是 JSON。有适用于 Windows 和 Mac OS X 的版本。

更多信息请访问[http://www.SlideMight.com](http://www.SlideMight.com)

**免责声明**：

我是开发 SlideMight 的公司 Delftware Technology 的所有者。我是开发人员之一。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2018-01-05T06:11:09.400

您可以使用*Syncfusion Software Private Limited的**Essential Presentation*产品。本产品可用于

 *1.  创建和操作 PowerPoint 演示文稿
2.  打开、修改和保存现有的 PowerPoint 演示文稿
3.  将 PowerPoint 演示文稿转换为 PDF 或图像

更多信息在[https://help.syncfusion.com/file-formats/presentation/overview](https://help.syncfusion.com/file-formats/presentation/overview)

**免责声明：** 我在 Syncfusion Software Private Limited 工作

# iis-7 - ASP 错误和 IIS 7.0

> ID：478840
> 
> 赞同：1
> 
> 时间：2009-01-26T04:29:29.687
> 
> 标签：iis-7, asp-classic, iis-6, ado

在 IIS 6 中，ASP 错误与行号和问题描述一起显示。例如，

```
{call dbo.spGetCommunityInfo(xx)} 
Microsoft SQL Native Client error '80020005' 
Invalid character value for cast specification 
/communitydetail.asp, line 42 
```

IIS 7 改变了处理 ASP 错误的方式并显示一些不太有用的东西。例如，

```
Internal Server Error
The server encountered an internal error or misconfiguration and was unable to complete your request 
```

有谁知道在 IIS 7 中获取 IIS 6 的行为需要进行哪些配置更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T06:40:22.997

您可以使用 AppCmd 来打开 ScriptErrorSentToBrowser（在 IIS7 默认情况下为 false，在 IIS6 中为 true）。AppCmd 位于 %SystemRoot%\system32\inetsrv 中，您需要以管理员身份运行它：

> appcmd.exe 设置配置 -section:system.webServer/asp -ScriptErrorSentToBrowser:true

# database - 在 linux 中创建小型数据库应用程序的最简单方法

> ID：478841
> 
> 赞同：3
> 
> 时间：2009-01-26T04:30:03.990
> 
> 标签：database, programming-languages, rad

我正在寻找一个非常小的编目应用程序供个人使用（尽管如果我认为其他人会使用它，我会开源它）。我不想要一个 Web 应用程序，因为为此拥有一个应用程序服务器似乎有点过头了——而且我喜欢它是独立的并将其粘贴在 USB 记忆棒上的想法。

我的标准：

*   接口必须易于编程。如果这使得代码更容易，它可以是诅咒风格的。我在 ncurses 方面的经验会暗示其他情况，但我实际上非常喜欢命令行 UI。
*   语言真的不重要。我的粗略偏好顺序（最高优先）：
    *   Python
    *   C
    *   C++
    *   爪哇
    *   我会考虑任何对 Linux 友好的东西
*   我正在考虑使用 sqlite 进行存储，但欢迎提出其他（可嵌入的）建议。

过去有没有人做过这种事情？有什么建议么？要避免的陷阱？

**编辑：**

好吧，看起来 python+sqlite 是早期的赢家。这只是留下了哪个 ui 库的问题。我知道你可以在 python 中免费获得 tkinter - 但它太丑了（我宁愿有一个 curses 界面）。我在 C 中做了一些 GTK，但在 python 中看起来相当不自然。我对 wxwidgets 有过短暂的涉猎，但文档的 IIRC 非常糟糕（我认为他们在某些时候重命名了模块，这有点混乱）。

所以这给我留下了 pyqt4 或某种控制台库。或者也许是 GTK。想法？还是我在注销上述其中一项时过于仓促？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-26T04:33:10.677

我肯定会推荐（或者第二个，如果你已经在考虑的话）- 带有 sqlite3 的 python。它简单、便携且没有大的数据库驱动程序。我为自己的编目目的编写了一个类似的应用程序，它做得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T05:49:10.353

我为 GUI 投票支持 pyqt 或 wx。（其次是 Python+sqlite 投票回答了原始问题。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T05:09:29.217

我第二（或第三）**python**和**sqlite**。

就建议而言：

如果您的野心不大，我建议您构建一个*非常简单*的Web 服务来将您的目录同步到服务器。我过去曾出于类似目的这样做过（很惭愧，几次）。

使用 sqlite，备份实际上可以像上传或下载最新的数据库文件一样简单，具体取决于文件的时间戳。

然后，如果您丢失或损坏了闪存驱动器（在我的情况下被粉碎成碎片），您的目录不会丢失。您可以获得更多的便携性、至少 1 个备份以及一些安心。

# asp.net-ajax - Ajax 纯粹是为了增强体验吗？

> ID：478843
> 
> 赞同：2
> 
> 时间：2009-01-26T04:31:16.813
> 
> 标签：asp.net-ajax

除了增强的用户体验之外，Ajax 调用是否提供任何显着的性能优势？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-26T04:39:25.063

甚至在 Ajax 被创造和普及之前，程序员都竭尽全力（使用 javascript 和内部框架的组合）来使他们的 web 应用程序响应并提供增强的用户体验。

它还提供了显着的性能，而不是重新渲染页面，您的 ajax Web 应用程序仅与服务器通信以获取数据并相应地仅更新屏幕的某些部分。

AJAX 中的第一个 A(Asynchronous) 也说明了一切，只要您的 Web 应用程序促进异步操作（想想自动完成），您的 Web 应用程序在增强用户体验、用户友好性方面已经遥遥领先。尽管并非所有程序员都使用第一个 A（有些只是使事情同步以简化代码）。

出于所有意图和目的，AJAX 提供了出色的用户体验，Stack Overflow 的 Ask Question 就是一个很好的例子，使用 AJAX，它可以先发制人地防止重复发布。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T04:47:20.353

在这种情况下，它是同样的事情。

**因为**有性能优势，所以增强了用户体验。

1）网络浏览器不需要重新绘制整个页面。Firefox 3 对此进行了改进，但是：

2) 用户*认为*您的 Web 应用程序更快，因此，出于所有意图和目的，它确实如此。

只要有必要，我就会使用 Ajax，因为 Web 应用程序的流程和感觉更加流畅。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T06:01:41.903

您是否获得性能取决于您的“ajax”是如何实现的。我说如果您只是将标记从服务器直接推送到客户端而客户端没有做太多处理，它不会更快（至少对于服务器端）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T06:12:04.130

作为增强体验的理想副作用（仅刷新需要的内容），服务器的压力较小。这意味着，服务提供商使用更少的硬件进行管理，并且互联网连接的费用也更少（通过线路传输的比特更少）。

Of course, some might argue, the main and side effects should be the other way around.

# php - 如何查看 PHP 加载的扩展？

> ID：478844
> 
> 赞同：203
> 
> 时间：2009-01-26T04:32:53.597
> 
> 标签：php, php-extension

它必须在 phpinfo() 转储中的某个地方，但我只是不知道在哪里。它应该在“附加模块”部分下吗？别的地方？我试图弄清楚为什么某些扩展似乎没有被加载，但我什至不知道我应该在哪里寻找。

* * *

## 回答 #1

> 赞同：308
> 
> 时间：2009-01-26T05:47:48.717

跑步

```
php -m
```

会给你所有的模块，和

```
php -i
```

将为您提供有关当前配置的更多详细信息。

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2015-09-01T05:18:24.160

运行命令。您将获得已安装的扩展：

```
php -r "print_r(get_loaded_extensions());" 
```

**或运行此命令以获取所有模块的安装和卸载版本**

```
dpkg -l | grep php5 
```

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2014-11-26T16:33:03.783

你想运行：

```
 php -m 
```

在命令行上，

或者如果您有权访问打开的服务器配置文件

```
/etc/php5/apache2/php.ini 
```

看看所有的扩展，

您甚至可以通过像这样在 On 和 Off 之间切换来启用或禁用它们

```
<Extension_name> = <[On | Off]> 
```

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2009-01-26T19:46:31.317

使用[`get_loaded_extensions()`](http://www.php.net/manual/en/function.get-loaded-extensions.php)PHP 函数

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2016-06-03T11:31:27.830

```
 <?php 
      echo "<pre>";
      print_r(get_loaded_extensions());
      echo "<pre/>";
 ?> 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2019-10-25T08:27:18.723

如果您想测试是否加载了特定扩展，您也可以使用该`extension_loaded`功能，请参阅[此处的文档](https://www.php.net/manual/fr/function.extension-loaded.php)

```
php -r "var_dump(extension_loaded('json'));" 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-03-23T04:12:15.760

`get_loaded_extensions()`输出扩展列表。

`phpinfo(INFO_MODULES);` 输出扩展名及其详细信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-26T05:53:57.347

您是否正在寻找特定的扩展名？在您的`phpinfo();`中，只需在您的网络浏览器中点击`Ctrl`+ `F`，输入您要查找的扩展程序的前 3-4 个字母，它应该会显示它是否已加载。

通常`phpinfo()`它不会在一个位置向您显示所有加载的扩展，它为每个加载的扩展都有一个单独的部分，其中显示了它的所有变量、文件路径等，因此如果您的扩展名称没有部分可能意味着它没有加载。

或者，您可以打开您的 php.ini 文件并使用`Ctrl`+`F`方法查找您的扩展名，并查看它是否已被注释掉（通常在行首附近的分号处）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2022-02-09T13:42:45.060

您可以通过此查看 PHP 安装的所有扩展

-Debian/Ubuntu

```
dpkg --get-selections | grep -i php 
```

-RHEL/CentOS

```
yum list installed | grep -i php 
```

-Fedora 22+

```
dnf list installed | grep -i php 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-03-29T22:21:31.657

你问你在 phpinfo() 输出中在哪里看到加载的扩展。

**回答：**

它们作为单独的部分/表格列在底部，并且**仅**在加载时才列出。这是加载扩展 Curl 的示例。

[![在此处输入图像描述](https://i.stack.imgur.com/V1KbW.png)](https://i.stack.imgur.com/V1KbW.png) **...**

**...** [![在此处输入图像描述](https://i.stack.imgur.com/MV6gJ.png)](https://i.stack.imgur.com/MV6gJ.png)

我将它安装在 Linux Debian 上

```
sudo apt-get install php7.4-curl 
```

# xml - 什么时候将 XML over JSON 用于 Ajax？

> ID：478855
> 
> 赞同：12
> 
> 时间：2009-01-26T04:41:16.123
> 
> 标签：xml, ajax

最近，包括我在内的许多程序员都将 X 从 AJAX 中取出，默认使用 JSON 作为协议格式。但是，我正在尝试考虑 XML 更适合作为协议格式的一些地方，其中不包括 SOAP（因为理论上 SOAP 无论如何都可以使用 JSON 完成）。

注意：我喜欢 XML 用于许多其他目的，所以它不是一般的 XML 与 JSON，我特别关心 AJAX 的传输协议。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-26T05:01:16.487

[这个问题与何时更喜欢 JSON 而不是 XML](https://stackoverflow.com/questions/325085/when-to-prefer-json-over-xml)非常相似？

无论如何，我同意那里投票最多的答案：

> 我使用 JSON，除非我需要使用 XML。如果库在您的上下文中可用，那么它更易于理解，并且（因为它需要更少的配置开销）更容易编程以进行读写，并且它们现在非常普遍。
> 
> 当亚马逊第一次将他们的目录公开为一种网络服务时，他们同时提供了 JSON 和 XML。大约 90% 的实施者选择了 JSON。

另一方面，XML 适用于...

*   您需要消息验证
*   您正在使用 XSLT
*   您的消息包含大量标记文本
*   您需要与不支持 JSON 的环境进行互操作
*   您需要属性或命名空间

这也取自上面的问题，本质上是在问这个问题的反面。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T05:14:02.500

为了把东西放在一起，为了更容易查找，而不是规范化数据，我正在反刍 Paolo Bergantino 指出的另一个问题的部分答案，这显示了 XML 的好处：

[当以下任何一种情况为真时，优先使用 XML 而不是 JSON：](https://stackoverflow.com/questions/325085/when-to-prefer-json-over-xml#329683)

 [*   您需要消息验证
*   您正在使用 XSLT 您的消息包含大量标记文本
*   您需要与不支持 JSON 的环境进行互操作](https://stackoverflow.com/questions/325085/when-to-prefer-json-over-xml#329683) 

——罗伯特·罗斯尼

[您需要处理客户端上的数据，并且可以利用 XSL 来实现。XML + XSL 链的运行速度可能比 JSON + JavaScript 更快，尤其是对于大块数据。一个很好的案例是将数据转换为 HTML 片段。](https://stackoverflow.com/questions/325085/when-to-prefer-json-over-xml#325172)

——尤金·拉祖特金

[如果我需要验证输入数据块，我会选择 XML 而不是 JSON，因为 XML 通过 XSD 原生支持这一点。](https://stackoverflow.com/questions/325085/when-to-prefer-json-over-xml#325710)

-低滑翔机

[但是 JSON 都缺少](https://stackoverflow.com/questions/325085/when-to-prefer-json-over-xml#432465)

[](https://stackoverflow.com/questions/325085/when-to-prefer-json-over-xml#432465)

[*   属性](https://stackoverflow.com/questions/325085/when-to-prefer-json-over-xml#432465)
*   [命名空间](https://stackoverflow.com/questions/325085/when-to-prefer-json-over-xml#432465)

-空值

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T04:47:43.910

Ajaxian 写了关于这个主题的文章 - [JSON vs. XML: The Debate](http://ajaxian.com/archives/json-vs-xml-the-debate)

此外，我不确定其重要性，但某些实例可能需要标签上的属性，并且您不能真正将属性放在 JSON 条目上。不过，我可能还差得很远——JSON/XML 不是我最擅长的领域。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T04:56:54.313

如果您要在客户端进行 XSLT 转换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T04:50:22.390

对我来说，我认为在 AJAX 中使用 XML 的最大缺点是您通常必须对其进行解析并以某种方式转换它，而您不必对 JSON 做同样的事情，因为该格式是 JavaScript 原生的. 当您将更大的传输成本添加到解析和转换中时，老实说，我想不出在 AJAX 中使用 XML 而非 JSON 的充分理由，尽管我确实将 XML 用于许多其他事情。

# c# - Wikilinks - 将文本 [[a]] 转换为内部链接

> ID：478857
> 
> 赞同：3
> 
> 时间：2009-01-26T04:41:45.217
> 
> 标签：c#, regex, wikipedia

我需要在我的网站上实现类似于[wikilinks的东西。](http://en.wikipedia.org/wiki/Help:Link#Wikilinks)用户正在输入纯文本，只要有内部链接，就会输入 [[asdf]]。只有前五个示例真正适用于我需要的实现。

你会使用正则表达式，什么表达式会这样做？是否有某个库已经在 C# 中执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T07:29:19.073

在纯正则表达式方面，表达式宁愿是：

```
\[\[([^\]\|\r\n]+?)\|([^\]\|\r\n]+?)\]\]([^\] ]\S*)
\[\[([^\]\|\r\n]+?)\]\]([^\] ]\S*) 
```

通过将`(.+?)` [David 的建议](https://stackoverflow.com/questions/478857#478963)替换为`([^\]\|\r\n]+?)`，您可以确保仅捕获合法的 wiki 链接文本，而无需右方括号或换行符。

`([^\] ]\S+)`最后确保 wiki 链接表达式后面也没有右方括号。

我注意到是否有 C# 库已经实现了这种检测。

但是，要使用正则表达式进行真正的全面检测，您应该使用C# 正则表达式引擎中存在的[**下推自动机**](http://en.wikipedia.org/wiki/Pushdown_automaton)[，如此处所示。](http://blog.stevenlevithan.com/archives/balancing-groups)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T06:13:59.273

我不知道是否有现有的库可以做到这一点，但如果是我，我可能只会使用正则表达式：

*   匹配`\[\[(.+?)\|(.+?)\]\](\S+)`并替换为`<a href="\2">\1\3</a>`
*   匹配`\[\[(.+?)\]\](\S+)`并替换为`<a href="\1">\1\2</a>`

或者类似的东西，无论如何。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-03T14:17:54.987

尽管这是一个古老的问题并且已经回答了，但我想我会将其添加为其他任何人的附录。现有的两个答案完成了所有真正的工作，让我达到了 90%，但对于任何正在寻找代码以直接尝试的人来说，这是最后一点：

```
string html = "Some text with a wiki style [[page2.html|link]]";
html = Regex.Replace(html, @"\[\[([^\]\|\r\n]+?)\|([^\]\|\r\n]+?)\]\]([^\] ]\S*)", @"<a href=""$1"">$2$3</a>");
html = Regex.Replace(html, @"\[\[([^\]\|\r\n]+?)\]\]([^\] ]\S*)", @"<a href=""$1"">$1$2</a>"); 
```

对实际正则表达式的唯一更改是我认为原始答案的替换部分是错误的，因此将 href 设置为显示文本并且链接显示在页面上。因此，我交换了它们。

# c# - 向 Spring.Net 中的递归方法注入建议？

> ID：478858
> 
> 赞同：3
> 
> 时间：2009-01-26T04:42:07.663
> 
> 标签：c#, recursion, aop, spring.net

我正在尝试使用 Spring.NET 对 AOP 的支持来执行依赖注入/控制反转/面向方面的编程（对于大量流行语感到抱歉-也许我会发布一个单独的问题，要求某人澄清区别:)） .

具体来说，我想拦截一个递归方法调用，以便每次调用该方法时，都会调用 AOP 建议/拦截器。

除了第一个方法调用之外，Spring.Net 似乎没有拦截任何东西。我*认为*Spring.Net 每个实例只维护一个拦截器链，并且在第一个方法调用完成之前不再调用任何拦截器。

是否有人有任何关于让每个方法调用（包括递归调用）触发拦截器（建议）的信息？

如果有帮助，我可以提供代码/示例输出。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T13:22:31.373

见[http://forum.springframework.net/showthread.php?t=5331](http://forum.springframework.net/showthread.php?t=5331)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T07:30:02.897

如果您使用的是基于代理的 AOP，那么这将不适用于递归方法调用。针对目标的第一次调用将被代理拦截，您的建议将运行。然后目标上的方法将被调用，随后的调用将留在目标类中，不知道代理。完成这项工作的唯一方法是实际修改您的字节码，以便类本身包含行为。

我实际上没有使用过 Spring.NET（只有 Spring 和 Java），所以不幸的是我不知道 .NET 世界中存在哪些类型的字节码编织选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-09T04:43:44.153

我知道这本身不是 Spring.NET，但看看[PostSharp](http://www.postsharp.org/)。它为您提供了不依赖动态代理的编译时编织，并且可以处理递归方法调用。虽然配置略有不同...

# refactoring - 将 C Callergraphs 与 Doxygen 合并或确定所有调用的联合

> ID：478860
> 
> 赞同：5
> 
> 时间：2009-01-26T04:44:33.167
> 
> 标签：refactoring, code-analysis, doxygen, graphviz, call-graph

我有一组遗留的 C 代码，我正在重构这些代码以将 C 计算代码从 GUI 中分离出来。这由于高度递归的数学核心代码是 K&R 风格的声明而变得复杂。由于函数参数的嵌套使用，我已经放弃了将这些转换为 ANSI 声明的尝试（只是无法消除最后 4 个编译器错误）。

我需要将一些文件移动到纯 DLL 中并确定要公开的最小接口，这将需要编写包装函数来发布类型化接口。

我已经使用 Doxygen @callergraph 标记标记了关键源文件，以便为各个函数生成信息图。除此之外，我想做的是合并这些图表，这样我就可以确定暴露给外界的函数的最窄边界。

原始头文件没有用——它们将所有内容都暴露为无类型的 C 函数。

有数百个函数，所以对生成的调用者图的简单检查是痛苦的。

我正在考虑编写某种 DOT 合并工具 - 设置 DOT_CLEANUP=NO 使 Doxygen 将中间 DOT 文件留在那里，而不是只保留它们生成的 png 文件。

我并不沉迷于这是一个图形解决方案——如果有人可以建议一种替代分析工具（免费或相对便宜）或使用 Doxygen 的 XML 输出来实现相同目标的技术，我会非常高兴。

在文件级别合并的调用者图表确实对客户文档而不是普通列表具有一定的吸引力:-)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-28T21:08:53.980

在你的 Doxyfile 中，设置

```
GENERATE_XML = YES 
```

然后您可以在 XML 文件中找到您的调用图。对于标有调用者图的每个函数，您会`<referencedby>`在输出中找到可以使用的元素。这是我的一个 C 文件的示例：

```
 <memberdef kind="function" id="spfs_8c_1a3"
             prot="public" static="yes" const="no" explicit="no"
             inline="no" virt="non-virtual">
    <type>svn_error_t *</type>
    <definition>svn_error_t * init_apr</definition>
    <argsstring>(apr_pool_t **ppool, int *argc, char const *const **argv)</argsstring>
    <name>init_apr</name>
    <!-- param and description elements clipped for brevity ... -->
    <location file="src/spfs.c" line="26" bodystart="101" bodyend="120"/>
    <referencedby refid="spfs_8c_1a13" compoundref="spfs_8c"
                  startline="45" endline="94">main</referencedby>
  </memberdef> 
```

因此，对于每个 memberdef/referencedby 对，您都有一个调用者-被调用者关系，您可以通过 XSLT 获取它：

```
<?xml version="1.0" encoding="utf-8"?>

<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:output method="text"/>

    <xsl:template match="/">
        <xsl:apply-templates select="//memberdef[@kind eq 'function']"/>
    </xsl:template>

    <xsl:template match="memberdef">
        <xsl:variable name="function-name"
                      select="concat(definition, argsstring)"/>
        <xsl:for-each select="referencedby">
            <xsl:value-of select="concat(./text(), ' calls ', $function-name, '&#xA;')"/>
        </xsl:for-each>
    </xsl:template>

</xsl:stylesheet> 
```

它为每个调用者-被调用者提供了一条线，如下所示：

```
main calls svn_error_t * init_apr(apr_pool_t **ppool, int *argc, char const *const **argv) 
```

您需要调整该 XSLT，然后以跨越最少边的方式对该有向图进行分区。呜呼，一个NP完全问题！幸运的是，有很多关于这个主题的论文，其中一些在这里： http: [//www.sandia.gov/~bahendr/partitioning.html](http://www.sandia.gov/~bahendr/partitioning.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T23:38:50.930

我有类似的要求。编写了一个 perl 脚本，将一组点文件合并为一个点文件。

[https://github.com/bharanis/scripts/blob/master/doxygen_dot_merge.pl](https://github.com/bharanis/scripts/blob/master/doxygen_dot_merge.pl)

合并多个 doxygen 生成的点文件。这对于为一个文件或一堆文件生成调用映射很有用。

1) 该命令将从 doxygen 放置所有 html、dot 和 map 文件的 html 目录外部运行。

2) 此命令假定 doxygen CREATE_SUBDIRS = NO 中使用的平面目录结构

3) doxygen 将源文件名作为输出点文件名的前缀。每个函数生成一个点文件

4）提供要合并的doxygen生成的点文件列表。例如：

```
./doxydotmerge.pl  `ls html/ssd_*_8c*_cgraph.dot  | grep -v test | grep -v buf` 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-16T19:23:40.350

您可以使用 Scientific Toolworks 查看系统范围的调用图。

如果您想自动化分析和切割，您可以考虑使用 DMS 软件再造工具包。它可以计算 C 的完整调用图（完成对函数指针的指向分析），并已在 3500 万行代码的系统中得到证明。它将生成完整的系统 DOT 文件以进行检查；它们非常大，但您可以挑选出要查看的子集。请参阅[流分析和调用图](http://www.semdesigns.com/Products/DMS/FlowAnalysis.html)。

# asp.net - 如何让 Visual Web Developer 使用 IIS，而不是 ASP.NET 开发服务器？

> ID：478870
> 
> 赞同：3
> 
> 时间：2009-01-26T04:51:03.467
> 
> 标签：asp.net, iis

我想确保我的本地与生产环境紧密匹配，这意味着运行 IIS 而不是 Visual Web Developer 快速版附带的 ASP.NET 开发服务器。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T04:59:50.453

在 Visual Studio 中，右键单击项目，选择属性然后选择 Web 并将其更改为使用本地 IIS。VWD 的过程似乎相似，但[您打开的是一个属性节点](http://blogs.msdn.com/webdevelopertips/archive/2008/11/04/tip-20-did-you-know-how-to-change-wap-to-use-an-iis-web-server.aspx)。我现在没有安装 VWD，所以无法检查这种方法是否确实准确，但这篇文章是最近的，所以我认为它是。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-01T17:33:00.603

首先确保您已经安装并配置了 IIS 服务器。检查是否安装了 IIS 服务器：运行->inetmgr 按回车。要了解如何安装和配置 IIS 服务器，请查看以下链接： [http ://chalaki.com/install-iis6-windows-xp-professional-sp3-setup-run-csharp-cgi/425/](http://chalaki.com/install-iis6-windows-xp-professional-sp3-setup-run-csharp-cgi/425/)

要使用带有 IIS 而不是“ASP.NET 开发服务器”的 Visual developer 2008 开发网站，请在“位置”下的新网站窗口中单击“浏览”以查看不同的服务器选项，包括 IIS 服务器。用户可以选择服务器作为 IIS 服务器而不是“文件系统”，那么“位置”选项将是“HTTP”而不是“文件系统”。

在 Visual developer 2008 下的 Properties->Start Option->Server->"Use local IIS server" 选项未显示，即使 IIS 服务器已成功安装和配置。显示的唯一选项是“使用默认服务器”和“使用带有基本 URL 的自定义服务器”。

所以在 Visual developer 2008 中要在 IIS 服务器上运行（如果安装了 IIS 服务器），需要执行以下操作：

新建网站 -> 在位置下点击“浏览” -> 点击“本地 IIS”，然后选择“IIS 虚拟目录”（IIS 虚拟目录是用户在配置 IIS 服务器时创建的目录） -> 打开

在运行/调试时，您在创建网站时选择的服务器，将使用同一台服务器打开网站，即在创建网站时，如果您选择“IIS服务器”，那么网站将通过 IIS 服务器打开。

还有一件事是，在安装 Visual developer 2008 和 IIS 服务器时，如果您在安装 Visual Studio 之后安装了 IIS 服务器，那么您需要在创建新网站之前执行以下操作：

运行->cmd 按回车（然后输入以下命令）-> C:\WINDOWS\Microsoft.NET\Framework\Version aspnet_regiis -i 按回车 3 秒后收到消息“ASP.net 安装成功”。（*大多数情况下版本为 v2.0.50727）

# php - 为什么我必须将 libmysql.dll 复制到 apache/bin 目录才能正确加载 PHP 扩展？

> ID：478873
> 
> 赞同：0
> 
> 时间：2009-01-26T04:54:50.540
> 
> 标签：php, mysql, apache, dll

我在 Windows 机器上。这似乎应该是不必要的，但是当我这样做时，一切都突然起作用了。我的路径有问题吗？我是否需要添加一些内容以避免复制 DLL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T05:40:34.863

我不知道 MySQL 和 apache 的内部结构。

我的想法是这样的。您的应用程序内部正在使用 libmysql.dll。而且似乎路径不正确，因此它在 PATH 环境变量中搜索。apache/bin 将在 PATH 目录中。所以它从这条路径中获取 dll。如果该路径中不存在 dll，我认为它无法加载并因此失败。

编辑：添加了评论中添加的解决方案

1.  尝试重新启动您的机器。我对 mysqlpp 库有同样的问题。路径指向 mysql bin dir 但它仍然找不到 libmysql.dll – Daniel（1 月 26 日 6:55）

2.  Apache 可能使用与您自己不同的凭据运行（如果您将其作为服务运行，几乎可以肯定。）尝试将目录放在*SYSTEM*路径中，而不是*USER*路径中。– moocha (18 小时前)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T06:48:54.647

与任何应用程序一样，Apache 将假定该文件与当前目录路径位于同一目录中（查看[http://en.wikipedia.org/wiki/Working_directory](http://en.wikipedia.org/wiki/Working_directory)）。如果它不存在。当前工作目录通常与 httpd.exe（主可执行文件）所在的目录相同，但如果您执行 C:\Apache2>bin\httpd.exe 之类的操作，它实际上可能会有所不同

在这种情况下，当前工作目录是 C:\Apache2 而不是 C:\Apache2\bin。

如果在那里找不到文件，应用程序自然会遍历 PATH 环境变量。PATH 环境变量是一个分号或逗号分隔的路径列表）来查找文件。

开始 -> 运行 -> 键入“cmd.exe”，然后在命令提示符中键入“echo %PATH%”以查看您拥有的当前路径。

最后，如果找不到文件，它只会出错。

作为提示，您实际上可以使用 Process Monitor 跟踪应用程序尝试加载的文件以及它们从何处加载。[http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)

我之前用这个工具解决了 Apache 和其他应用程序中的加载 DLL 问题。只需简单地为您正在运行的应用程序添加一个过滤器，让它只检测文件读取。

# c++ - 如何更改线程的名称

> ID：478875
> 
> 赞同：9
> 
> 时间：2009-01-26T04:55:29.650
> 
> 标签：c++, multithreading, winapi

我有一个使用“很多”线程的服务器应用程序。不想讨论它真正应该使用多少线程，如果能够在调试器“线程”窗口中看到一些描述性文本来描述每个线程是什么，而不必单击它并从上下文确定它是什么。

它们都具有相同的起始地址，因此通常线程窗口会显示类似“thread_base::start”或类似的内容。我想知道是否有 API 调用或允许我自定义该文本的东西。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-26T05:18:28.653

这是我使用的代码。

这在头文件中。

```
#pragma once

#define MS_VC_EXCEPTION 0x406d1388
#pragma warning(disable: 6312)
#pragma warning(disable: 6322)

typedef struct tagTHREADNAME_INFO
{
    DWORD dwType;        // must be 0x1000
    LPCSTR szName;       // pointer to name (in same addr space)
    DWORD dwThreadID;    // thread ID (-1 caller thread)
    DWORD dwFlags;       // reserved for future use, most be zero
} THREADNAME_INFO;

inline
void SetThreadName(DWORD dwThreadID, LPCSTR szThreadName)
{
#ifdef _DEBUG
    THREADNAME_INFO info;
    info.dwType = 0x1000;
    info.szName = szThreadName;
    info.dwThreadID = dwThreadID;
    info.dwFlags = 0;

    __try
    {
        RaiseException(MS_VC_EXCEPTION, 0, sizeof(info) / sizeof(DWORD), (DWORD *)&info);
    }
    __except (EXCEPTION_CONTINUE_EXECUTION)
    {
    }
#else
    dwThreadID;
    szThreadName;
#endif
} 
```

然后我在线程过程中这样称呼它。

```
SetThreadName(GetCurrentThreadId(), "VideoSource Thread"); 
```

值得注意的是，这是大卫发布链接的确切代码（谢谢！我忘记了从哪里得到它）。我没有删除这篇文章，因为如果 MSDN 决定（再次）重新组织其链接，我希望代码仍然可用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-26T05:04:51.457

使用[SetThreadName](http://msdn.microsoft.com/en-us/library/xcb2z8hs(VS.71).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-18T23:03:29.317

Windows 10 添加了[SetThreadDescription](https://msdn.microsoft.com/en-us/library/windows/desktop/mt774976(v=vs.85).aspx) ()，在那个平台上这将是最好的方法。

# java - 有没有一种简单的方法可以在 Eclipse 中导入黑白配色方案

> ID：478883
> 
> 赞同：6
> 
> 时间：2009-01-26T05:01:04.723
> 
> 标签：java, eclipse, ide

Visual Studio 可以导入、导出颜色设置。

Eclipse有类似的东西吗？

我正在寻找 Eclipse 中最简单的“完美”配色方案。对我来说，这仅仅意味着黑色背景（所以我不会整天盯着明亮的灯泡）。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T06:44:51.177

最简单的方法是更改​​首选项中的所有颜色，然后保存它们，以便其他 eclipse 会话（或其他工作区）重用它们。

![窗口](https://i.stack.imgur.com/WSQU1.jpg)

所以一个好的开始就是去**`preferences->Editors->Text Editors`**。

然后走到下半部分，你应该看到“ `Appearance color options`”，选择“ `Background`”，取消选中“ `System Default`”，你可以选择你想要的颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T07:48:32.093

最简单的方法是找到使用您想要的颜色模式的用户。他可以将他的偏好导出到一个文件中。您可以将此文件导入您的工作区。

当你没有找到这个人时，你必须像 VonC 描述的那样自己创建它。

# yacc - 有没有人用过 MKS Yacc 提供的“选择偏好”？

> ID：478891
> 
> 赞同：1
> 
> 时间：2009-01-26T05:07:07.240
> 
> 标签：yacc

由于我的问题完全没有得到任何答案，[是否有替代 MKS Yacc 支持选择偏好语法或类似的东西？](https://stackoverflow.com/questions/475787/)，我会问更基本的问题：

*   有没有人用过 MKS Yacc 提供的“选择偏好”？

如果有，你是用来做什么的？此外，在规则中的最后一个位置以外的任何地方使用它是否有意义？

我必须照顾一个语法，其中包括以下规则：

```
 TOKEN1 LPAREN non_terminal1 [^EQUAL] TOKEN2 non_terminal2 RPAREN 
```

除非我误解了某些东西，否则嵌入式选择首选项在这种情况下不会提供任何价值。

### 背景

MKS Yacc 支持他们的网站称为“[选择首选项语法](http://www.mkssoftware.com/docs/wp/wp_lyuse.asp)”的符号。它没有说明，但它由方括号中的标记或标记列表和插入符号（可能是可选的）组成，并且它指示特定标记不得遵循此构造，但该标记不计为一部分这条规则：

```
non_terminal1:  TOKEN1 non_terminal2 TOKEN2 [^TOKEN3] 
```

所以，这条规则说 a`TOKEN1`后跟 a`non_terminal2`和 a`TOKEN2`是 a `non_terminal1`，除非下一个标记是 a`TOKEN3`在这种情况下适用其他规则。

（我不清楚括号中的项目是否可以是非终端。我看到的使用符号的代码总是使用一个标记或几个空格分隔的标记，而不是非终端。我也不是明确是否需要插入符号；同样，我看到的所有示例都使用插入符号。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T08:50:05.620

乔纳森。在凌晨 1:30 我不准备自己尝试这样做，但无论这些规则做什么，它们只能是可以用普通 BNF 之类的东西编写的规则的简写。从这个角度来看，似乎“选择偏好”正在做的是让你用一个语法规则表达原本会是几个产生式的东西。

我做了一点挖掘，发现[了这一点](http://www.thinkage.ca/english/products/yay-manual.html#SelectionPreference)，这证实了我的假设：选择首选项的作用是让您显式地插入一个前瞻，以便可以消除原本会发生冲突的规则的歧义。

我的建议是考虑如果将这些规则之一重写为 yacc 或直接 BNF 会是什么样子。我怀疑它会变成类似

```
TOKEN1 LPAREN non_terminal1 MULT TOKEN2 non_terminal2 RPAREN
TOKEN1 LPAREN non_terminal1 DIVIDE TOKEN2 non_terminal2 RPAREN
TOKEN1 LPAREN non_terminal1 ADD TOKEN2 non_terminal2 RPAREN
TOKEN1 LPAREN non_terminal1 SUBTRACT TOKEN2 non_terminal2 RPAREN
TOKEN1 LPAREN non_terminal1 EXP TOKEN2 non_terminal2 RPAREN
TOKEN1 LPAREN non_terminal1 MOD TOKEN2 non_terminal2 RPAREN
... 
```

*因此，总体效果是对除*equal之外的每个运算符采用一个规则，该`[^`符号在各种贝尔实验室语言中很常见，用于类似于集合的补码。

# c++ - 如何使用 POSIX 在 C++ 中执行命令并获取命令的输出？

> ID：478898
> 
> 赞同：550
> 
> 时间：2009-01-26T05:11:03.113
> 
> 标签：c++, process, posix, system, return-value

我正在寻找一种从 C++ 程序中运行命令时获取命令输出的方法。我已经研究过使用该`system()`功能，但这只会执行一个命令。这是我正在寻找的示例：

```
std::string result = system("./some_command"); 
```

我需要运行任意命令并获取其输出。我查看了[boost.org](https://www.boost.org/)，但没有找到任何可以满足我需要的东西。

* * *

## 回答 #1

> 赞同：724
> 
> 时间：2009-01-26T06:12:36.500

```
#include <cstdio>
#include <iostream>
#include <memory>
#include <stdexcept>
#include <string>
#include <array>

std::string exec(const char* cmd) {
    std::array<char, 128> buffer;
    std::string result;
    std::unique_ptr<FILE, decltype(&pclose)> pipe(popen(cmd, "r"), pclose);
    if (!pipe) {
        throw std::runtime_error("popen() failed!");
    }
    while (fgets(buffer.data(), buffer.size(), pipe.get()) != nullptr) {
        result += buffer.data();
    }
    return result;
} 
```

C++11 之前的版本：

```
#include <iostream>
#include <stdexcept>
#include <stdio.h>
#include <string>

std::string exec(const char* cmd) {
    char buffer[128];
    std::string result = "";
    FILE* pipe = popen(cmd, "r");
    if (!pipe) throw std::runtime_error("popen() failed!");
    try {
        while (fgets(buffer, sizeof buffer, pipe) != NULL) {
            result += buffer;
        }
    } catch (...) {
        pclose(pipe);
        throw;
    }
    pclose(pipe);
    return result;
} 
```

将`popen`and`pclose`替换为`_popen`and`_pclose`用于 Windows。

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2012-05-22T12:55:00.513

[使用我的pstreams](http://pstreams.sourceforge.net/)标头可以轻松获取 stdout 和 stderr（以及写入 stdin，此处未显示），它定义了工作方式如下的 iostream 类`popen`：

```
#include <pstream.h>
#include <string>
#include <iostream>

int main()
{
  // run a process and create a streambuf that reads its stdout and stderr
  redi::ipstream proc("./some_command", redi::pstreams::pstdout | redi::pstreams::pstderr);
  std::string line;
  // read child's stdout
  while (std::getline(proc.out(), line))
    std::cout << "stdout: " << line << '\n';
  # if reading stdout stopped at EOF then reset the state:
  if (proc.eof() && proc.fail())
    proc.clear();
  // read child's stderr
  while (std::getline(proc.err(), line))
    std::cout << "stderr: " << line << '\n';
} 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2016-02-26T18:17:56.840

对于 Windows，`popen`也可以，但它会打开一个控制台窗口——它会快速闪过您的 UI 应用程序。如果您想成为专业人士，最好禁用此“闪烁”（特别是如果最终用户可以取消它）。

所以这是我自己的 Windows 版本：

（此代码部分重组自[The Code Project](https://en.wikipedia.org/wiki/Code_Project)和 MSDN 示例中编写的想法。）

```
#include <windows.h>
#include <atlstr.h>
//
// Execute a command and get the results. (Only standard output)
//
CStringA ExecCmd(
    const wchar_t* cmd              // [in] command to execute
)
{
    CStringA strResult;
    HANDLE hPipeRead, hPipeWrite;

    SECURITY_ATTRIBUTES saAttr = {sizeof(SECURITY_ATTRIBUTES)};
    saAttr.bInheritHandle = TRUE; // Pipe handles are inherited by child process.
    saAttr.lpSecurityDescriptor = NULL;

    // Create a pipe to get results from child's stdout.
    if (!CreatePipe(&hPipeRead, &hPipeWrite, &saAttr, 0))
        return strResult;

    STARTUPINFOW si = {sizeof(STARTUPINFOW)};
    si.dwFlags     = STARTF_USESHOWWINDOW | STARTF_USESTDHANDLES;
    si.hStdOutput  = hPipeWrite;
    si.hStdError   = hPipeWrite;
    si.wShowWindow = SW_HIDE; // Prevents cmd window from flashing.
                              // Requires STARTF_USESHOWWINDOW in dwFlags.

    PROCESS_INFORMATION pi = { 0 };

    BOOL fSuccess = CreateProcessW(NULL, (LPWSTR)cmd, NULL, NULL, TRUE, CREATE_NEW_CONSOLE, NULL, NULL, &si, &pi);
    if (! fSuccess)
    {
        CloseHandle(hPipeWrite);
        CloseHandle(hPipeRead);
        return strResult;
    }

    bool bProcessEnded = false;
    for (; !bProcessEnded ;)
    {
        // Give some timeslice (50 ms), so we won't waste 100% CPU.
        bProcessEnded = WaitForSingleObject( pi.hProcess, 50) == WAIT_OBJECT_0;

        // Even if process exited - we continue reading, if
        // there is some data available over pipe.
        for (;;)
        {
            char buf[1024];
            DWORD dwRead = 0;
            DWORD dwAvail = 0;

            if (!::PeekNamedPipe(hPipeRead, NULL, 0, NULL, &dwAvail, NULL))
                break;

            if (!dwAvail) // No data available, return
                break;

            if (!::ReadFile(hPipeRead, buf, min(sizeof(buf) - 1, dwAvail), &dwRead, NULL) || !dwRead)
                // Error, the child process might ended
                break;

            buf[dwRead] = 0;
            strResult += buf;
        }
    } //for

    CloseHandle(hPipeWrite);
    CloseHandle(hPipeRead);
    CloseHandle(pi.hProcess);
    CloseHandle(pi.hThread);
    return strResult;
} //ExecCmd 
```

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2009-01-26T08:21:27.237

我会使用**popen()** *(++waqas)*。

但有时你需要阅读和写作......

似乎没有人再以艰难的方式做事了。

（假设是 Unix/Linux/Mac 环境，或者可能是具有 POSIX 兼容层的 Windows...）

```
enum PIPE_FILE_DESCRIPTERS
{
  READ_FD  = 0,
  WRITE_FD = 1
};

enum CONSTANTS
{
  BUFFER_SIZE = 100
};

int
main()
{
  int       parentToChild[2];
  int       childToParent[2];
  pid_t     pid;
  string    dataReadFromChild;
  char      buffer[BUFFER_SIZE + 1];
  ssize_t   readResult;
  int       status;

  ASSERT_IS(0, pipe(parentToChild));
  ASSERT_IS(0, pipe(childToParent));

  switch (pid = fork())
  {
    case -1:
      FAIL("Fork failed");
      exit(-1);

    case 0: /* Child */
      ASSERT_NOT(-1, dup2(parentToChild[READ_FD], STDIN_FILENO));
      ASSERT_NOT(-1, dup2(childToParent[WRITE_FD], STDOUT_FILENO));
      ASSERT_NOT(-1, dup2(childToParent[WRITE_FD], STDERR_FILENO));
      ASSERT_IS(0, close(parentToChild [WRITE_FD]));
      ASSERT_IS(0, close(childToParent [READ_FD]));

      /*     file, arg0, arg1,  arg2 */
      execlp("ls", "ls", "-al", "--color");

      FAIL("This line should never be reached!!!");
      exit(-1);

    default: /* Parent */
      cout << "Child " << pid << " process running..." << endl;

      ASSERT_IS(0, close(parentToChild [READ_FD]));
      ASSERT_IS(0, close(childToParent [WRITE_FD]));

      while (true)
      {
        switch (readResult = read(childToParent[READ_FD],
                                  buffer, BUFFER_SIZE))
        {
          case 0: /* End-of-File, or non-blocking read. */
            cout << "End of file reached..."         << endl
                 << "Data received was ("
                 << dataReadFromChild.size() << "): " << endl
                 << dataReadFromChild                << endl;

            ASSERT_IS(pid, waitpid(pid, & status, 0));

            cout << endl
                 << "Child exit staus is:  " << WEXITSTATUS(status) << endl
                 << endl;

            exit(0);

          case -1:
            if ((errno == EINTR) || (errno == EAGAIN))
            {
              errno = 0;
              break;
            }
            else
            {
              FAIL("read() failed");
              exit(-1);
            }

          default:
            dataReadFromChild . append(buffer, readResult);
            break;
        }
      } /* while (true) */
  } /* switch (pid = fork())*/
} 
```

* * *

您可能还想使用 select() 和非阻塞读取。

```
fd_set          readfds;
struct timeval  timeout;

timeout.tv_sec  = 0;    /* Seconds */
timeout.tv_usec = 1000; /* Microseconds */

FD_ZERO(&readfds);
FD_SET(childToParent[READ_FD], &readfds);

switch (select (1 + childToParent[READ_FD], &readfds, (fd_set*)NULL, (fd_set*)NULL, & timeout))
{
  case 0: /* Timeout expired */
    break;

  case -1:
    if ((errno == EINTR) || (errno == EAGAIN))
    {
      errno = 0;
      break;
    }
    else
    {
      FAIL("Select() Failed");
      exit(-1);
    }

  case 1:  /* We have input */
    readResult = read(childToParent[READ_FD], buffer, BUFFER_SIZE);
    // However you want to handle it...
    break;

  default:
    FAIL("How did we see input on more than one file descriptor?");
    exit(-1);
} 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2009-01-26T06:06:59.537

两种可能的方法：

1.  我不认为`popen()`它是 C++ 标准的一部分（它是内存中 POSIX 的一部分），但它在我使用过的每个 UNIX 上都可用（而且您似乎针对的是 UNIX，因为您的命令是`./some_command`）。

2.  如果没有`popen()`，您可以使用`system("./some_command >/tmp/some_command.out");`，然后使用正常的 I/O 函数来处理输出文件。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2013-12-16T18:12:10.850

以下可能是一个便携式解决方案。它遵循标准。

```
#include <iostream>
#include <fstream>
#include <string>
#include <cstdlib>
#include <sstream>

std::string ssystem (const char *command) {
    char tmpname [L_tmpnam];
    std::tmpnam ( tmpname );
    std::string scommand = command;
    std::string cmd = scommand + " >> " + tmpname;
    std::system(cmd.c_str());
    std::ifstream file(tmpname, std::ios::in | std::ios::binary );
    std::string result;
    if (file) {
        while (!file.eof()) result.push_back(file.get())
            ;
        file.close();
    }
    remove(tmpname);
    return result;
}

// For Cygwin

int main(int argc, char *argv[])
{
    std::string bash = "FILETWO=/cygdrive/c/*\nfor f in $FILETWO\ndo\necho \"$f\"\ndone ";
    std::string in;
    std::string s = ssystem(bash.c_str());
    std::istringstream iss(s);
    std::string line;
    while (std::getline(iss, line))
    {
        std::cout << "LINE-> " + line + "  length: " << line.length() << std::endl;
    }
    std::cin >> in;
    return 0;
} 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2017-09-21T15:43:07.390

我无法弄清楚为什么[Code::Blocks](http://en.wikipedia.org/wiki/Code::Blocks) /MinGW 中缺少 popen/pclose。所以我改用 CreateProcess() 和 CreatePipe() 解决了这个问题。

这是对我有用的解决方案：

```
//C++11
#include <cstdio>
#include <iostream>
#include <windows.h>
#include <cstdint>
#include <deque>
#include <string>
#include <thread>

using namespace std;

int SystemCapture(
    string         CmdLine,    //Command Line
    string         CmdRunDir,  //set to '.' for current directory
    string&        ListStdOut, //Return List of StdOut
    string&        ListStdErr, //Return List of StdErr
    uint32_t&      RetCode)    //Return Exit Code
{
    int                  Success;
    SECURITY_ATTRIBUTES  security_attributes;
    HANDLE               stdout_rd = INVALID_HANDLE_VALUE;
    HANDLE               stdout_wr = INVALID_HANDLE_VALUE;
    HANDLE               stderr_rd = INVALID_HANDLE_VALUE;
    HANDLE               stderr_wr = INVALID_HANDLE_VALUE;
    PROCESS_INFORMATION  process_info;
    STARTUPINFO          startup_info;
    thread               stdout_thread;
    thread               stderr_thread;

    security_attributes.nLength              = sizeof(SECURITY_ATTRIBUTES);
    security_attributes.bInheritHandle       = TRUE;
    security_attributes.lpSecurityDescriptor = nullptr;

    if (!CreatePipe(&stdout_rd, &stdout_wr, &security_attributes, 0) ||
            !SetHandleInformation(stdout_rd, HANDLE_FLAG_INHERIT, 0)) {
        return -1;
    }

    if (!CreatePipe(&stderr_rd, &stderr_wr, &security_attributes, 0) ||
            !SetHandleInformation(stderr_rd, HANDLE_FLAG_INHERIT, 0)) {
        if (stdout_rd != INVALID_HANDLE_VALUE) CloseHandle(stdout_rd);
        if (stdout_wr != INVALID_HANDLE_VALUE) CloseHandle(stdout_wr);
        return -2;
    }

    ZeroMemory(&process_info, sizeof(PROCESS_INFORMATION));
    ZeroMemory(&startup_info, sizeof(STARTUPINFO));

    startup_info.cb         = sizeof(STARTUPINFO);
    startup_info.hStdInput  = 0;
    startup_info.hStdOutput = stdout_wr;
    startup_info.hStdError  = stderr_wr;

    if(stdout_rd || stderr_rd)
        startup_info.dwFlags |= STARTF_USESTDHANDLES;

    // Make a copy because CreateProcess needs to modify string buffer
    char      CmdLineStr[MAX_PATH];
    strncpy(CmdLineStr, CmdLine.c_str(), MAX_PATH);
    CmdLineStr[MAX_PATH-1] = 0;

    Success = CreateProcess(
        nullptr,
        CmdLineStr,
        nullptr,
        nullptr,
        TRUE,
        0,
        nullptr,
        CmdRunDir.c_str(),
        &startup_info,
        &process_info
    );
    CloseHandle(stdout_wr);
    CloseHandle(stderr_wr);

    if(!Success) {
        CloseHandle(process_info.hProcess);
        CloseHandle(process_info.hThread);
        CloseHandle(stdout_rd);
        CloseHandle(stderr_rd);
        return -4;
    }
    else {
        CloseHandle(process_info.hThread);
    }

    if(stdout_rd) {
        stdout_thread=thread([&]() {
            DWORD  n;
            const size_t bufsize = 1000;
            char         buffer [bufsize];
            for(;;) {
                n = 0;
                int Success = ReadFile(
                    stdout_rd,
                    buffer,
                    (DWORD)bufsize,
                    &n,
                    nullptr
                );
                printf("STDERR: Success:%d n:%d\n", Success, (int)n);
                if(!Success || n == 0)
                    break;
                string s(buffer, n);
                printf("STDOUT:(%s)\n", s.c_str());
                ListStdOut += s;
            }
            printf("STDOUT:BREAK!\n");
        });
    }

    if(stderr_rd) {
        stderr_thread=thread([&]() {
            DWORD        n;
            const size_t bufsize = 1000;
            char         buffer [bufsize];
            for(;;) {
                n = 0;
                int Success = ReadFile(
                    stderr_rd,
                    buffer,
                    (DWORD)bufsize,
                    &n,
                    nullptr
                );
                printf("STDERR: Success:%d n:%d\n", Success, (int)n);
                if(!Success || n == 0)
                    break;
                string s(buffer, n);
                printf("STDERR:(%s)\n", s.c_str());
                ListStdOut += s;
            }
            printf("STDERR:BREAK!\n");
        });
    }

    WaitForSingleObject(process_info.hProcess,    INFINITE);
    if(!GetExitCodeProcess(process_info.hProcess, (DWORD*) &RetCode))
        RetCode = -1;

    CloseHandle(process_info.hProcess);

    if(stdout_thread.joinable())
        stdout_thread.join();

    if(stderr_thread.joinable())
        stderr_thread.join();

    CloseHandle(stdout_rd);
    CloseHandle(stderr_rd);

    return 0;
}

int main()
{
    int            rc;
    uint32_t       RetCode;
    string         ListStdOut;
    string         ListStdErr;

    cout << "STARTING.\n";

    rc = SystemCapture(
        "C:\\Windows\\System32\\ipconfig.exe",    //Command Line
        ".",                                     //CmdRunDir
        ListStdOut,                              //Return List of StdOut
        ListStdErr,                              //Return List of StdErr
        RetCode                                  //Return Exit Code
    );
    if (rc < 0) {
        cout << "ERROR: SystemCapture\n";
    }

    cout << "STDOUT:\n";
    cout << ListStdOut;

    cout << "STDERR:\n";
    cout << ListStdErr;

    cout << "Finished.\n";

    cout << "Press Enter to Continue";
    cin.ignore();

    return 0;
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2019-12-22T19:22:41.707

请注意，您可以通过将输出重定向到文件然后读取它来获取输出

它显示在文档中[`std::system`](https://en.cppreference.com/w/cpp/utility/program/system)

您可以通过调用`WEXITSTATUS`宏来接收退出代码。

```
 int status = std::system("ls -l >test.txt"); // execute the UNIX command "ls -l >test.txt"
    std::cout << std::ifstream("test.txt").rdbuf();
    std::cout << "Exit code: " << WEXITSTATUS(status) << std::endl; 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-11-15T00:45:21.330

假设 POSIX，捕获标准输出的简单代码：

```
#include <sys/wait.h>
#include <unistd.h>
#include <string>
#include <vector>

std::string qx(const std::vector<std::string>& args) {
  int stdout_fds[2];
  pipe(stdout_fds);

  int stderr_fds[2];
  pipe(stderr_fds);

  const pid_t pid = fork();
  if (!pid) {
    close(stdout_fds[0]);
    dup2(stdout_fds[1], 1);
    close(stdout_fds[1]);

    close(stderr_fds[0]);
    dup2(stderr_fds[1], 2);
    close(stderr_fds[1]);

    std::vector<char*> vc(args.size() + 1, 0);
    for (size_t i = 0; i < args.size(); ++i) {
      vc[i] = const_cast<char*>(args[i].c_str());
    }

    execvp(vc[0], &vc[0]);
    exit(0);
  }

  close(stdout_fds[1]);

  std::string out;
  const int buf_size = 4096;
  char buffer[buf_size];
  do {
    const ssize_t r = read(stdout_fds[0], buffer, buf_size);
    if (r > 0) {
      out.append(buffer, r);
    }
  } while (errno == EAGAIN || errno == EINTR);

  close(stdout_fds[0]);

  close(stderr_fds[1]);
  close(stderr_fds[0]);

  int r, status;
  do {
    r = waitpid(pid, &status, 0);
  } while (r == -1 && errno == EINTR);

  return out;
} 
```

欢迎代码贡献以获取更多功能：

[https://github.com/ericcurtin/execxx](https://github.com/ericcurtin/execxx)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-07-05T12:38:07.677

您可以在使用管道运行脚本后获取输出。当我们想要子进程的输出时，我们使用管道。

```
int my_func() {
    char ch;
    FILE *fpipe;
    FILE *copy_fp;
    FILE *tmp;
    char *command = (char *)"/usr/bin/my_script my_arg";
    copy_fp = fopen("/tmp/output_file_path", "w");
    fpipe = (FILE *)popen(command, "r");
    if (fpipe) {
        while ((ch = fgetc(fpipe)) != EOF) {
            fputc(ch, copy_fp);
        }
    }
    else {
        if (copy_fp) {
            fprintf(copy_fp, "Sorry there was an error opening the file");
        }
    }
    pclose(fpipe);
    fclose(copy_fp);
    return 0;
} 
```

所以这是您要运行的脚本。将它与脚本采用的参数一起放入命令变量中（如果没有参数，则什么都没有）。以及要捕获脚本输出的文件，将其放在 copy_fp 中。

因此 popen 运行您的脚本并将输出放入 fpipe 中，然后您可以将其中的所有内容复制到您的输出文件中。

通过这种方式，您可以捕获子进程的输出。

另一个过程是您可以直接将`>`操作符放在命令中。因此，如果我们在运行命令时将所有内容都放在一个文件中，您就不必复制任何内容。

在这种情况下，不需要使用管道。您可以使用 just `system`，它将运行命令并将输出放入该文件中。

```
int my_func(){
    char *command = (char *)"/usr/bin/my_script my_arg > /tmp/my_putput_file";
    system(command);
    printf("everything saved in my_output_file");
    return 0;
} 
```

您可以阅读*[YoLinux 教程：Fork、Exec 和进程控制](http://www.yolinux.com/TUTORIALS/ForkExecProcesses.html)*以获取更多信息。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-08-20T17:45:49.057

[waqas](https://stackoverflow.com/users/58008/waqas)答案的 C++ 流实现：

```
#include <istream>
#include <streambuf>
#include <cstdio>
#include <cstring>
#include <memory>
#include <stdexcept>
#include <string>

class execbuf : public std::streambuf {
    protected:
        std::string output;
        int_type underflow(int_type character) {
            if (gptr() < egptr()) return traits_type::to_int_type(*gptr());
            return traits_type::eof();
        }
    public:
        execbuf(const char* command) {
            std::array<char, 128> buffer;
            std::unique_ptr<FILE, decltype(&pclose)> pipe(popen(command, "r"), pclose);
            if (!pipe) {
                throw std::runtime_error("popen() failed!");
            }
            while (fgets(buffer.data(), buffer.size(), pipe.get()) != nullptr) {
                this->output += buffer.data();
            }
            setg((char*)this->output.data(), (char*)this->output.data(), (char*)(this->output.data() + this->output.size()));
        }
};

class exec : public std::istream {
    protected:
        execbuf buffer;
    public:
        exec(char* command) : std::istream(nullptr), buffer(command, fd) {
            this->rdbuf(&buffer);
        }
}; 
```

此代码通过`stdout`. 如果您只想捕获，`stderr`则像这样传递您的命令：

```
sh -c '<your-command>' 2>&1 > /dev/null 
```

如果你想同时捕获两者`stdout`，`stderr`那么命令应该是这样的：

```
sh -c '<your-command>' 2>&1 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-02-24T00:37:25.373

命令类使用 system("cmd > stdout 2> stderr") 为用户提供标准输出和标准错误，以及退出代码。

测试运行：

```
./a.out 'ls .'
exit code: 0
stdout: HelloWorld
HelloWorld.c
HelloWorld.cpp
HelloWorld.dSYM
a.out
gcc_container.bash
linuxsys
macsys
test.sh

stderr: 
```

```
#include <iostream>
#include <fstream>
#include <sstream>
#include <unistd.h>
using namespace std;

class Command {
    public:
        Command() {
            exit_code_ = -1;
        }

        int GetExitCode() { return exit_code_;}

        string GetStdOutStr() {return stdout_str_;}

        string GetStdErrStr() {return stderr_str_;}

        int Run(const char* cmd) {
            return Run(string(cmd));
        }

        /**
         * @brief run a given command
         * 
         * @param cmd: command string
         * @return int: the exit code of running the command
         */
        int Run(string cmd) {

            // create temp files
            char tmp_dir[] = "/tmp/stdir.XXXXXX";
            mkdtemp(tmp_dir);
            string stdout_file = string(tmp_dir) + "/stdout";
            string stderr_file = string(tmp_dir) + "/stderr";

            // execute the command "cmd > stdout_file 2> stderr_file"
            string cli = cmd + " > " + stdout_file + " 2> " + stderr_file;
            exit_code_ = system(cli.c_str());
            exit_code_ = WEXITSTATUS(exit_code_);
            stdout_str_ = File2Str(stdout_file);
            stderr_str_ = File2Str(stderr_file);

            // rid of the temp files
            remove(stdout_file.c_str());
            remove(stderr_file.c_str());
            remove(tmp_dir);

            return exit_code_;
        }

    private:
        int exit_code_;
        string stderr_str_;
        string stdout_str_;

        /**
         * @brief read a file
         * 
         * @param file_name: file path 
         * @return string the contents of the file.
         */
        string File2Str(string file_name) {
            ifstream file;
            stringstream str_stream;

            file.open(file_name);
            if (file.is_open()) {
                str_stream << file.rdbuf();
                file.close();
            }
            return str_stream.str();
        }
};

int main(int argc, const char* argv[]) {
    Command command;

    command.Run(argv[1]);
    cout << "exit code: " << command.GetExitCode() << endl;
    cout << "stdout: " << command.GetStdOutStr() << endl;
    cout << "stderr: " << command.GetStdErrStr() << endl;
    return  command.GetExitCode();
} 
```

# ruby-on-rails - 在 Rails 中使用嵌套的 insert_html 部分时出错

> ID：478908
> 
> 赞同：0
> 
> 时间：2009-01-26T05:23:34.693
> 
> 标签：ruby-on-rails, nested, rjs, partial-classes

所以我有两个嵌套的部分调用insert_html。基本上每支球队都有多名球员，我有一个添加球员按钮和一个添加球队按钮，每个按钮都使用以下助手调用部分

```
 module TeamsHelper
  def add_team_link(name)
    link_to_function name do |page|
      page.insert_html :bottom, :teams, :partial => 'team', :object => Team.new
    end 
  end

   def add_player_link(name2)
   link_to_function name2 do |page2|
     page2.insert_html :bottom, :players, :partial => 'player', :object => Player.new
    end
   end
 end 
```

如果我只使用一个 insert_html 调用，这很好用，但是当我尝试同时使用这两个调用时，我得到一个 javascript 错误“参数列表后缺少）”并且外部“添加团队”按钮失败。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T20:38:16.800

您可以将 add_player_link 的 link_to_function 放入您为团队渲染的部分中。然后你可以分配你想要插入项目的 Team Div 的唯一 ID：
<%= link_to_function name2 do |page2|
    page2.insert_html :bottom, "players_#{unique_id}", :partial => 'player', :object => Player.new

每个团队 DOM 元素是否都有唯一的 ID？我遇到了问题，我将有两个 id="order" 的 div 并且它破坏了一些东西。就像你有很多“团队”div，里面有很多“玩家”div。尝试给每个人一个唯一的 ID，当你有两个团队时，第二个按钮可能会开始工作。

# .net - .NET MVC：如何从控制器创建表单？

> ID：478910
> 
> 赞同：0
> 
> 时间：2009-01-26T05:29:00.597
> 
> 标签：.net, winforms, model-view-controller, design-patterns

在 .NET 3.5 winforms 中，我创建了一个 MVC。我想把控制器部分放到一个单独的程序集中，这样它就不知道视图了。我的应用在其视图中使用了五种形式。控制器负责在不同时间初始化表单，这意味着控制器具有对视图的引用（我不想这样做）。这意味着控制器无法分离，因为它需要知道正在创建的表单类型，这可能意味着它不是真正的控制器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T08:09:46.730

我使用 IOC 容器来解析视图并通过表单构造函数注入控制器实例，就像这样。

```
public class MainWindowController : WindowController<IMainWindowView>
{
}

public class WindowController<TView> where TView : IView
{
    public WindowController( IViewFactory factory ) {}

    public void ShowWindow() {}
    public void CloseWindow() {}
}

public interface IViewFactory
{
    IView CreateWithController( IWindowController controller ) {}
}

public interface IView {}
public interface IMainWindowView : IView {}

public class MainForm : Form, IMainWindowView
{
    public MainForm( IWindowController windowController )
    {
    }
} 
```

我的 Window Controller 类依赖于视图工厂，它将创建已注册视图的实例（使用容器）。

ViewFactory 使用 IOC 容器创建瞬态视图并将控制器实例注入到构造函数中。

它还具有 ShowWindow 和 CloseWindow 等方法，可以显示和隐藏表单。这允许我使用模拟视图对我的控制器进行单元测试。它还从我的控制器和模型代码中删除了对 Windows 窗体的任何依赖，允许我将来用 WPF 视图替换任何视图。

我将其设置为我的主要应用程序逻辑、视图界面、控制器和模型位于一个主程序集中，而另一个程序集仅包含 Windows 窗体窗体和控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T07:31:39.367

我可以在控制器中声明表单变量。与视图无关。这些是 System.Windows.Forms。当 EXE 启动时，它会初始化控制器 (Program.cs)。在那里，可以创建特定的表单，然后将其分配给控制器上的表单属性。这允许分离控制器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T05:45:05.837

您可以在视图和模型之间使用 Subject-Observer 模式来解耦视图和模型之间的交互。此外，您可以使用 MVP 模式。

# c++ - Silverlight 和 C++ 或 C++ 到 C# 的代码转换正在进行吗？

> ID：478911
> 
> 赞同：2
> 
> 时间：2009-01-26T05:30:15.087
> 
> 标签：c++, silverlight, cross-platform, c++-cli, code-migration

我正在开发一个基于绘图的产品，我想按优先顺序为 iPhone、桌面 OS/X、Windows 平板电脑、基于 Silveright 的浏览器、Windows Mobile 和 Windows 制作版本。

对于 GUI 可移植性，经典的答案是将核心保留在 C++ 中并使用 Cocoa/Objective-C 或 WPF/C# 薄层。

但是，Silverlight 使选择复杂化。

将我的代码迁移到 C++/CLI 并维护双重代码库（使用一些宏来伪造 C++/CLI 上下文关键字以及一些司法搜索和替换 ^ 和 %）我不会有任何问题。

[从到目前为止](https://silverlight.net/forums/p/5329/16244.aspx)我所能找到的情况来看，Silverlight 似乎不太可能支持 C++/CLI。这让我有以下选择：

1.  一次性将 v1.0 C++ 源代码库迁移到 C# 并持续进行并行维护
2.  使用工具（请提供建议！）从 C++ 到 C# 进行实时移植，反之亦然，这非常顺利，可以成为构建过程的一部分。
3.  Silverlight 版本的架构分离，因此 C++ 逻辑保留在服务器上。我对性能影响有点不舒服。

任何人都可以提出替代方案，提供有关 Silverlight 中 C++/CLI 的好消息或推荐移植工具吗？只要端口可靠，我对任何一种语言都足够熟悉，可以将 C++ 或 C# 作为后端的主要语言。

[编辑：查看Tangible Software Solutions](http://www.tangiblesoftwaresolutions.com)提供的产品范围，他们对转换器的注释清楚地表明，将 C# 转换为 C++ 比其他方式更容易。这正如我所料 - 它引发了将我的 C++ 风格限制为最不常见的 OO 分母的有趣想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T06:15:28.007

> Silverlight 版本的架构分离，因此 C++ 逻辑保留在服务器上。我对性能影响有点不舒服。

我会这样做。性能可能没有你想象的那么差。

# java - 卡在 Java 官方教程中的 Card/Deck 练习

> ID：478918
> 
> 赞同：2
> 
> 时间：2009-01-26T05:41:31.133
> 
> 标签：java, oop

我被困在 Java 教程的一部分上，特别是[这个练习](http://java.sun.com/docs/books/tutorial/java/javaOO/QandE/creating-questions.html)。该练习要求您：

> 1- 编写一个类，其实例代表一副纸牌中的一张纸牌。扑克牌有两个不同的属性：点数和花色。请务必保留您的解决方案，因为系统会要求您在 Enum Types 中重写它。
> 
> 提示：您可以使用 assert 语句来检查您的分配。你写：

```
assert(boolean expression to test); 
```

> 如果布尔表达式为假，您将收到一条错误消息。例如，

```
assert toString(ACE) == "Ace"; 
```

> 应该返回true，所以不会有错误信息。
> 
> 2-编写一个类，其实例代表一副完整的纸牌。您还应该保留此解决方案。
> 
> 3- 编写一个小程序来测试你的套牌和卡片类。该程序可以像创建一副卡片并显示其卡片一样简单。

我真的很想做这个练习，但问题是我从来没有玩过纸牌，所以我完全不知道如何创建这个程序以及卡片应该具有什么属性等。我在维基百科上查找了这个但得到了非常有限的知识，我永远无法构建所需的类：[Card.java](http://java.sun.com/docs/books/tutorial/java/javaOO/examples/Card.java)、[Deck.java](http://java.sun.com/docs/books/tutorial/java/javaOO/examples/Deck.java)和程序[DisplayDeck.java](http://java.sun.com/docs/books/tutorial/java/javaOO/examples/DisplayDeck.java)。

对于没有纸牌知识的人来说，什么是一个很好的替代练习，但它将测试与上述练习相同的概念？（可能是静态和实例变量等）

谢谢。

顺便说一句，这**不是**一个家庭作业问题，我正在为一个商业项目学习 Java。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T06:30:01.300

我认为花时间熟悉这个例子是值得的，因为它经常被用来描述编程概念。让我试着为你提炼出扑克牌的描述：

首先，保持[这张牌的图片](http://en.wikipedia.org/wiki/File:Set_of_playing_cards_52.JPG)**（**整张牌）打开以供参考。

垂直向下行，您有 {**黑桃**♠，**方块**◇，**梅花**♣，**红桃**♡} = 4**花色**。

水平穿过列，您有 { **2** , **3** , ..., **10** , **Jack** , **Queen** , **King** , **Ace** } = 13 个**等级**。

一副牌总共有 4 x 13 = 52 张**牌**。

**每张牌都由一对（等级，花色）**标识，例如（A，黑桃♠）和（10，方块◇），我们分别读作“黑桃A”和“方块十”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T06:04:53.347

根据上面的描述，它似乎并不需要知道*如何*打牌，只需要知道它们的外观即可。如上所述，这意味着 Card 类将具有 2 个属性（由 Enums 定义）rank 和 suit，其中 rank 是以下之一：

{ 王牌, 2, 3, 4, 5, 6, 7, 8, 9, 10, 杰克, 王后, 国王 }

西装是以下之一：

{ 黑桃、红心、方块和梅花 }

甲板将只是一个包含所有等级和套件组合的集合结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T06:03:32.320

如果您了解一些基础知识，则练习很简单：

*   一副牌有 52 张牌（如果算上 Jokers，则为 54 张）
*   一副牌包含 4 种花色 - 方块、红心、梅花和黑桃
*   每套套装包含数字卡 (2-10)、杰克、皇后、国王和王牌
*   Ace 通常算为“1”（但特定游戏有很多边缘情况）

所以，一些简单的测试：

`assert(deck.count == 52); assert(deck.suits.count == 4); assert(deck.suits.contains("Diamonds")); assert(deck.suits.contains("Hearts")); assert(deck.suits.contains("Clubs")); assert(deck.suits.contains("Spades")); assert(deck.suits["Diamonds"].contains("Ace")); //repeat for 2-10, Jack, Queen, King`

或类似的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T06:03:49.527

你看过关于[扑克牌](http://en.wikipedia.org/wiki/Playing_card)的维基百科文章吗？这应该包括你需要知道的关于卡片做练习的一切。基本上一张牌有一个从 1 到 13 的数字（等级）和四种花色、黑桃、梅花、红心或方块中的一种（但如果你愿意，你可以称它们为 A、B、C、D）。13x4 在一副牌中有 52 张牌。

# sql-server - 如何将数据库对象从 VS 2008 Web 应用程序项目中 App_Data 文件夹中的本地数据库传输到 SQL Server 2000 数据库？

> ID：478925
> 
> 赞同：0
> 
> 时间：2009-01-26T05:50:10.477
> 
> 标签：sql-server, visual-studio-2008, dts

我们正在开发一个 VS 2008 Web 应用程序项目，在其**App_Data**文件夹中创建了一个本地数据库（mdf 文件）。现在我们改变了计划，决定使用 SQL Server 2000 数据库而不是 App_Data 中的文件数据库。

为此，我想使用 DTS 导入/导出向导将本地数据库对象移动到远程服务器中的 SQL Server 2000 数据库中。但是，我不确定如何在 DTS 向导的**“选择数据源”**屏幕中引用本地 App_Data 数据库。在此屏幕中，我选择哪种类型的**数据源**以及如何引用 App_Data 文件夹中的本地数据库？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T14:53:29.053

这是一个 SQL Server Express 数据库 - 您可以使用 SQL Server 连接到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T15:15:56.323

VS 2008 带有 SQL 发布向导。您可以将对象和数据编写到文件中，然后针对其他服务运行。我认为它位于服务器资源管理器中的鼠标右键单击选项下。

我现在不能更准确，因为 VS 2008 目前正在安装 /：

# asp.net-mvc - 用于 YUI 控件（雅虎用户界面）的 ASP.NET MVC HtmlHelper 扩展？

> ID：478927
> 
> 赞同：4
> 
> 时间：2009-01-26T05:52:48.583
> 
> 标签：asp.net-mvc, yui, html-helper

**有没有人为 MVC 编写过任何[HTMLHelper 类](http://blog.wekeroad.com/blog/aspnet-mvc-preview-using-the-mvc-ui-helpers/)来帮助[Yahoo 的用户界面库](http://developer.yahoo.com/yui/)？**

例如，我编写了一个辅助方法来将“菜单模型”转换为支持[Yahoo Menu Control](http://developer.yahoo.com/yui/examples/menu/topnavfrommarkup_source.html)所需的 HTML 标记。MVC 模式在这里工作得很好，因为很明显，如果我选择切换到不同的菜单实现，我可以只编写一个新的帮助程序而不接触模型。

此代码适用于我，但尚未经过全面测试，欢迎您使用它。

首先，我们需要菜单模型本身的简单数据结构。您可以使用正常的 MVC 约定将其添加到您的页面模型中。例如，我通过`ViewData.Model.MainMenu.MenuOptions`.

```
public class MenuItem

{
    public string Text { get; set; }
    public string Description { get; set; }
    public string RouteURL { get; set; }
    public bool SeparatorBefore { get; set; }

    public List<MenuItem> MenuItems { get; set; }
} 
```

扩展方法。放入您的视图可访问的命名空间。

```
public static class YUIExtensions
    {
        public static string RenderMenu(this HtmlHelper html, string id, List<MenuItem> menuItems)
        {
            // <div id="mnuTopNav" class="yuimenubar yuimenubarnav">
            //    <div class="bd">
            //        <ul class="first-of-type">

            //            <li class="yuimenubaritem first-of-type"><a class="yuimenubaritemlabel" href="#store">Store</a></li>

            //            <li class="yuimenubaritem"><a class="yuimenubaritemlabel" href="#products">Products</a>

            //                <div id="communication" class="yuimenu">
            //                    <div class="bd">
            //                        <ul>
            //                            <li class="yuimenuitem"><a class="yuimenuitemlabel" href="http://360.yahoo.com">360&#176;</a></li>
            //                            <li class="yuimenuitem"><a class="yuimenuitemlabel" href="http://mobile.yahoo.com">Mobile</a></li>
            //                            <li class="yuimenuitem"><a class="yuimenuitemlabel" href="http://www.flickr.com">Flickr Photo Sharing</a></li>
            //                        </ul>
            //                    </div>
            //                </div>     
            //            </li>

            //        </ul>            
            //    </div>
            //</div>   

            int menuId = 0;
            HtmlGenericControl menuControl = CreateControl(html, id, 0, ref menuId, menuItems);

            // render to string
            StringWriter sw = new StringWriter();
            HtmlTextWriter tw = new HtmlTextWriter(sw);
            tw.Indent = 1;
            menuControl.RenderControl(tw);
            return sw.ToString();
        }

        private static HtmlGenericControl CreateControl(HtmlHelper html, string id, int level, ref int menuId, List<MenuItem> currentItems)
        {
            var menu = new HtmlGenericControl("div");
            menu.Attributes["class"] = (level == 0) ? "yuimenubar yuimenubarnav" : "yuimenu";
            menu.Attributes["id"] = id;

            var div_bd = new HtmlGenericControl("div");
            menu.Controls.Add(div_bd);
            div_bd.Attributes["class"] = "bd";

            HtmlGenericControl ul = null;

            int i = 0;
            foreach (var menuItem in currentItems)
            {
                if (ul == null || menuItem.SeparatorBefore)
                {
                    ul = new HtmlGenericControl("ul");
                    div_bd.Controls.Add(ul);

                    if (i == 0)
                    {
                        ul.Attributes["class"] = "first-of-type";
                    }
                }

                var menuItem_li = new HtmlGenericControl("li");
                menuItem_li.Attributes["class"] = (level == 0) ? "yuimenubaritem" : "yuimenuitem";
                if (i == 0)
                {
                    menuItem_li.Attributes["class"] += " first-of-type";
                }
                ul.Controls.Add(menuItem_li);

                var href = new HtmlGenericControl("a");
                href.Attributes["class"] = (level == 0) ? "yuimenubaritemlabel" : "yuimenuitemlabel";
                href.Attributes["href"] = menuItem.RouteURL;
                href.InnerHtml = menuItem.Text;
                menuItem_li.Controls.Add(href);

                if (menuItem.MenuItems != null && menuItem.MenuItems.Count > 0)
                {
                    menuItem_li.Controls.Add(CreateControl(html, id + "_" + (menuId++), level + 1, ref menuId, menuItem.MenuItems));
                }
                i++;
            }

            return menu;
        }
    } 
```

将此代码粘贴到您要在视图中生成菜单的位置（我在母版页中有此代码）：

```
<%= Html.RenderMenu("mnuTopNav", ViewData.Model.MainMenu.MenuOptions) %> 
```

如果你很懒惰，或者不了解 YUI，你也需要这个`<HEAD>`

```
<!-- Combo-handled YUI CSS files: -->
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/combo?2.6.0/build/menu/assets/skins/sam/menu.css">
<!-- Combo-handled YUI JS files: -->
<script type="text/javascript" src="http://yui.yahooapis.com/combo?2.6.0/build/yahoo-dom-event/yahoo-dom-event.js&2.6.0/build/container/container_core-min.js&2.6.0/build/menu/menu-min.js"></script> 
```

[这目前为顶部导航样式导航栏](http://developer.yahoo.com/yui/examples/menu/topnavfrommarkup_source.html)生成标记- 但可以轻松修改。

我希望其他人对其他一些控件也做同样的事情。

似乎是一个开源项目的好候选人——但我没有时间开始。

*欢迎实施咨询！*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T17:57:34.020

昨晚我对此进行了一些思考，想知道这里是否有更多机会使用 YUI 或您想要的任何其他 Javascript/HTML 小部件制作通用 HTMLHelpers。

例如，如果有一个 IMenu 接口和一个用于 ITextBox、ICheckBox、IRichTextEditor、ICarousel 等的接口，就像您的 MenuItem 类一样，那么您可以拥有每个接口的 YUI 实现，一个用于 JQuery，一个用于MooTools 或仅用于直接 HTML/CSS 的工具。

引发这种情况的部分原因是这样的文章的概括：http: [//designingwebinterfaces.com/essential_controls](http://designingwebinterfaces.com/essential_controls)正在将 Web 上的 UI 控件用于富 Web 应用程序。

这些接口将包含所有乍一看很明显的基本内容：Id、Name、Value、List、Style、OnChange、OnClick 等，以及不太明显的内容，如 ValidationRegex、HelpText 等。

这将使您拥有一个将模型对象或模型属性转换为 ITextBox 的层，而不必担心接口的哪个实现将实际处理它。如果出现更好/更快/更酷的新实现，您也可以轻松切换到新的实现。

如果您将诸如 ValidationRegex 之类的东西提供给准系统 HTML 实现并且它无法处理它，您将不得不处理会发生什么，但我认为这是一条值得思考的路径。我还认为，通过继承或重新实现它，将它与现有的 HTMLHelper 命名空间分开实现可能更有意义，但在提出解决方案的这种早期想法阶段，我经常犯错。

YUIAsp.NET 的东西很有趣，但比 ASP.NET MVC 和 Fubu MVC 最近的方向更面向 WebForms 和用户控件。

我对这个想法进行了一些修改，并且对这些可能性非常感兴趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T06:23:48.147

西蒙，

我不确定这对 MVC 问题是否有帮助，但有一个很好的开源项目旨在简化在 .NET 中使用 YUI：

[http://www.yuiasp.net/](http://www.yuiasp.net/)

菜单是它们包含的控件之一。

至少，如果您的工作为已经存在的东西增加了新的维度，那么这可能是一个您可以回馈的项目。

-埃里克

# switch-statement - 用户模式与主管模式

> ID：478929
> 
> 赞同：3
> 
> 时间：2009-01-26T05:54:58.657
> 
> 标签：switch-statement, supervisor-mode

我对类 Unix 机器上的用户模式和主管模式有几个问题。

用户模式和主管模式有什么区别？我知道用户进程无法访问所有内存和硬件并执行所有指令。还有更多吗？

不同模式有什么好处？

从用户模式切换到管理员模式时涉及哪些步骤？

当用户程序进行系统调用时，模式必须从用户模式更改为管理员模式。我在其他地方读到，这是通过使用 int x80 在 x86 机器上实现的。那么模式切换与中断处理有何不同呢？

它与上下文切换有何不同？

在不同的架构中是如何实现监督者模式的？

任何答案或指示将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-26T05:59:54.653

CPU 在物理上不允许访问被确定为“特权”的区域。因为这是在硬件中强制执行的，所以它使您的操作系统能够自我保护。如果没有这种机制，操作系统就不会有“安全性”，因为最晦涩的代码片段可以简单地访问内核内存并读取所有密码。

用户模式到主管模式的切换很昂贵，因为它是上下文切换，并且出于安全目的，必须刷新缓存（否则您可能能够访问您不打算访问的内容）。

至于上下文切换，这本质上涉及切换到内核模式以执行任务。当 CPU 调度程序定时器中断触发时，它会切换到内核模式，选择下一个要执行的任务，然后切换回用户模式并恢复下一个任务。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-26T06:28:22.520

存在两个概念：

*   软件用户/内核模式，在执行系统调用或返回表单系统调用时相互切换，
*   硬件用户/管理员模式，它们在中断时相互切换。

在硬件管理模式下执行的代码很少，主要是低级别的中断例程和启动的最开始。甚至大部分软件内核模式都是在硬件用户模式下执行的。

# cocoa-touch - -[UITableView scrollToRowAtIndexPath:] 滚动，但回到第一行

> ID：478931
> 
> 赞同：4
> 
> 时间：2009-01-26T05:55:24.520
> 
> 标签：cocoa-touch

我在表格视图中有一个带有文本字段的分组表格视图。为了让键盘不隐藏文本字段，在 textFieldShouldBeginEditing 中，我调用了 scrollToRowAtIndexPath 方法并将正在编辑的行的滚动位置设置为 tableview 的顶部。

滚动确实发生了，但只要键盘出现（即 textFieldShouldBeginEditing 返回 YES 时），表格就会滚动回其原始位置并在顶部显示第一部分的第一行。调用 scrollToRowAtIndexPath 后，我没有调用 reloadTable。

***该问题仅发生在第 4 行和第 5 行（bdate 和 zip）password2 按预期工作。***

这是我用来滚动到特定行的代码

```
if(textField == password2){
    indPath = [NSIndexPath indexPathForRow:3 inSection:0];
    [self.tableView scrollToRowAtIndexPath:indPath atScrollPosition:UITableViewScrollPositionTop animated:YES];
    return YES;
}
else if(textField == bdate){
    indPath = [NSIndexPath indexPathForRow:4 inSection:0];
    [self.tableView scrollToRowAtIndexPath:indPath atScrollPosition:UITableViewScrollPositionTop animated:YES];
    return YES;
}
else if(textField == zip){
    indPath = [NSIndexPath indexPathForRow:5 inSection:0];
    [self.tableView scrollToRowAtIndexPath:indPath atScrollPosition:UITableViewScrollPositionTop animated:YES];
    return YES;
} 
```

有人可以告诉我可能出了什么问题吗？任何见解都会有所帮助。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T00:08:19.300

我怀疑正在发生的事情是表格视图是橡皮筋，就像 Safari 中的 web 视图在你跑过它的边界时所做的那样。最可能的原因是，当您弹出键盘时，它位于 table view 的顶部，但 table view 没有物理收缩，因此所有 UITableViewCells 都适合部分遮挡的 UITableView，并且当其中一些滚动关闭时它是橡皮筋，所以它们都在里面。

为了对此进行测试，请尝试减小列表视图的大小，以便在显示键盘时可以看到整个内容，如果错误消失，您需要编写代码，以便在键盘动画进出时动态更改大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-03T13:36:14.800

```
//For iOS 7 
        [self.TableView reloadData];
        NSIndexPath *indexPat = [NSIndexPath indexPathForRow:1 inSection:1];
        [self.TableView scrollToRowAtIndexPath:indexPat atScrollPosition:UITableViewScrollPositionTop animated:YES]; 
```

# sql-server - 查找安装 SQL Server 的路径？

> ID：478940
> 
> 赞同：2
> 
> 时间：2009-01-26T06:02:27.533
> 
> 标签：sql-server

如何通过 SQL 命令获取系统中安装 SQL Server 2005 的路径？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T09:08:47.487

`select filename from master.sys.sysfiles where name = 'master'`

# neural-network - 有哪些学习人工神经网络的好资源？

> ID：478947
> 
> 赞同：110
> 
> 时间：2009-01-26T06:05:05.923
> 
> 标签：neural-network

我对人工神经网络非常感兴趣，但我正在寻找一个起点。

那里有什么资源，什么是好的开始项目？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-01T11:21:01.487

首先，放弃任何认为人工神经网络与大脑有任何关系的观念，只是为了与生物神经元网络有短暂的相似性。学习生物学不会帮助你有效地应用神经网络；学习线性代数、微积分和概率论。您至少应该让自己熟悉函数的基本微分、链式法则、偏导数（梯度、雅可比和 Hessian）的概念，并了解矩阵乘法和对角化。

当你训练一个网络时，你正在做的实际上是优化一个大型的多维函数（最小化你对网络中每个权重的误差度量），因此对非线性数值优化技术的研究可能会证明是有益的。这是一个广泛研究的问题，在神经网络之外拥有大量文献，并且网络上有大量关于数值优化的讲义。首先，大多数人使用简单的[梯度下降](http://en.wikipedia.org/wiki/Gradient_descent)，但这可能比更细微的方法（如

一旦你有了基本的想法，你就可以开始在你的隐藏层中尝试不同的“挤压”功能，添加各种正则化，以及各种调整以加快学习速度。有关“最佳实践”的完整列表，请参阅[本文](http://yann.lecun.com/exdb/publis/pdf/lecun-98b.pdf)。

关于该主题的最佳书籍之一是 Chris Bishop 的[*Neural Networks for Pattern Recognition*](https://rads.stackoverflow.com/amzn/click/com/0198538642)。在这个阶段它已经相当老了，但仍然是一个很好的资源，你经常可以在网上找到用过的副本，价格约为 30 美元。他的新书《[*模式识别与机器学习*](http://research.microsoft.com/en-us/um/people/cmbishop/prml/)》中的神经网络章节也相当全面。要获得一个特别好的以实现为中心的教程，[请参阅 CodeProject.com 上的这个](http://www.codeproject.com/KB/library/NeuralNetRecognition.aspx)教程，它实现了一种称为卷积网络的巧妙网络，它以这样一种方式限制连接性，使其非常擅长学习对视觉模式进行分类。

支持向量机和其他内核方法已经变得非常流行，因为您可以在不知道自己在做什么的情况下应用它们，并且通常会得到可接受的结果。另一方面，神经网络是巨大的优化问题，需要仔细调整，尽管它们仍然适用于许多问题，尤其是计算机视觉等领域的大规模问题。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-26T06:09:44.087

我强烈推荐 Anoop Madhusudanan 在[Code Project](http://www.codeproject.com/KB/recipes/brainnet.aspx)上的这个优秀系列。

他带您了解基础知识，以*易于理解的方式*了解它们的工作原理，并向您展示如何使用他的`brainnet`库来创建自己的库。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-01-26T06:09:06.087

以下是神经网络编程的一些示例。 [http://www.codeproject.com/KB/recipes/neural_dot_net.aspx](http://www.codeproject.com/KB/recipes/neural_dot_net.aspx)

你可以从这里开始阅读：http: [//web.archive.org/web/20071025010456/http ://www.geocities.com/CapeCanaveral/Lab/3765/neural.html](http://web.archive.org/web/20071025010456/http://www.geocities.com/CapeCanaveral/Lab/3765/neural.html)

就我而言，我参观了有关它的课程并阅读了一些文献。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-26T07:02:12.577

如今，神经网络有点破旧。*支持向量机*和*核方法*比反向传播更适合更多类别的问题。神经网络和遗传算法吸引了那些对现代机器学习知之甚少但不是最先进技术的人的想象力。

如果您想了解更多关于 AI 和机器学习的信息，我建议您阅读 Peter Norvig 的《[人工智能：一种现代方法》](https://rads.stackoverflow.com/amzn/click/com/0136042597)。这是对人工智能和许多现代技术的广泛调查。它还回顾了历史和旧技术，并将为您提供更完整的 AI 和机器学习基础知识。

不过，神经网络非常简单。特别是如果您使用遗传算法来确定权重，而不是适当的反向传播。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-06T17:16:03.293

我第二个*dwf*对Chris Bishop的**Neural Networks for Pattern Recognition**的推荐。虽然，它可能不是入门文本。Norvig 或在线教程（在 Matlab 中有代码！）可能是一个更温和的介绍。

一个好的入门项目是 OCR（光学字符识别）。您可以扫描文本页面并通过网络输入每个字符以执行分类。（当然，您必须先训练网络！）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-11-14T15:48:20.850

[Raul Rojas 的书](http://www.inf.fu-berlin.de/inst/ag-ki/rojas_home/pmwiki/pmwiki.php?n=Books.NeuralNetworksBook)是一个很好的开始（它也是免费的）。此外，[Haykin 的书第 3 版](https://rads.stackoverflow.com/amzn/click/com/0131471392)，虽然体积很大，但解释得很好。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-11-16T00:59:37.157

我可以建议从哪里开始。我买了 Kevin Gurney[的 An Introduction to Neural Networks](https://rads.stackoverflow.com/amzn/click/com/1857285034)，它在亚马逊上有很好的评论，并声称是“对认知和计算机科学中最重要的主题之一的高度易懂的介绍”。就个人而言，我不会推荐这本书作为开始。我只能理解其中的 10%，但也许只有我一个人（英语不是我的母语）。我将从这个线程中研究其他选项。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-12-19T12:52:24.043

[http://www.ai-junkie.com/ann/evolved/nnt1.html](http://www.ai-junkie.com/ann/evolved/nnt1.html)是对多层感知器的清晰介绍，虽然没有描述反向传播算法

你也可以看看generation5.org，它提供了很多关于人工智能的文章，还有一些关于神经网络的好文章

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-26T06:53:01.800

如果你不介意花钱，[The Handbook of Brain Theory and Neural Networks](https://rads.stackoverflow.com/amzn/click/com/0262011972)很不错。它包含 287 篇文章，涵盖了许多学科的研究。它从介绍和理论开始，然后重点介绍文章的路径，以最好地涵盖您的兴趣。

对于第一个项目，[Kohonen 地图的](http://en.wikipedia.org/wiki/Self-organizing_map)[分类](http://en.wikipedia.org/wiki/Category_theory)很有趣：在你的音乐收藏中找到隐藏的关系，[构建一个智能机器人](http://robocode.sourceforge.net/)，或者解决[Netflix 的奖项](http://netflixprize.com/)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-26T06:10:29.063

我认为一个好的起点总是[维基百科](http://en.wikipedia.org/wiki/Neural_network)。在那里，您还可以找到一些有用的链接，这些链接指向使用神经网络的文档和项目。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-02T21:38:41.193

在我学习期间使用的两本书：

入门课程：[Igor Aleksander 和 Helen Morton 对神经计算的介绍。](https://rads.stackoverflow.com/amzn/click/com/1850321671)

高级课程：[Robert Hecht-Nielsen 的神经计算](https://rads.stackoverflow.com/amzn/click/com/0201093553)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-25T16:37:21.053

我发现 Fausett 的[《神经网络基础》是](https://rads.stackoverflow.com/amzn/click/com/0133341860)一本简单易懂的入门教科书。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-06-17T19:53:35.017

我发现教科书“计算智能”非常有用。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-06-17T20:00:22.093

[Programming Collective Intelligence](http://oreilly.com/catalog/9780596529321)在搜索和排名算法的背景下讨论了这一点。此外，在[此处](http://kiwitobes.com/PCI_Code.zip)提供的代码（第 4 章）中，书中讨论的概念在 Python 示例中进行了说明。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-03-08T16:29:04.947

我同意其他人的观点，他们说学习生物学不是一个好的起点……因为生物学中有很多不相关的信息。您不需要了解神经元如何工作来重新创建其功能 - 您只需要模拟它的动作。我推荐 Ray Kurzweil 的“How To Create A Mind”——它涉及与计算模型相关的生物学方面，（通过组合多个输入并在达到阈值时触发来创建模拟神经元）但忽略了不相关的东西，例如神经元实际上是如何将 thouse 输入加在一起的。（例如，您只需使用 + 和不等式与阈值进行比较）

我还应该指出，这本书并不是真正关于“创造思维”——它只关注层次模式识别/新皮质。我相信自 1980 年代以来一直在讨论一般主题，因此有很多旧书可能包含相同信息的略微过时的形式。例如，我阅读过旧文档，其中指出视觉系统是一个多层模式识别器。他认为这适用于整个新皮质。此外，对他的“预测”持保留态度——他的硬件估计可能非常准确，但我认为他低估了简单任务的复杂程度（例如：驾驶汽车）。诚然，他已经看到了很多进步（并且是其中的一部分），但我仍然认为他过于乐观了。与人类能够做到的 99.9+% 相比，人工智能汽车能够在 90% 的时间内成功行驶一英里之间存在很大差异。我不认为任何人工智能会真正驱动我至少 20 年......（我不计算需要在实际赛道上“训练”的宝马赛道车，因为它们并没有真正发挥同样的作用游戏）

If you already have a basic idea of what AI is and how it can be modeled, you may be better off skipping to something more technical.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-01-07T02:13:26.390

如果您想快速了解一些神经网络概念在真实模拟器上的应用，可以在[http://grey.colorado.edu/CompCogNeuro/index 找到一本很棒的在线书籍（现为 wiki），名为“计算认知神经科学”。 php/CCNBook/主](http://grey.colorado.edu/CompCogNeuro/index.php/CCNBook/Main)

这本书在学校被用作教科书，带您了解许多不同的大脑区域，从单个神经元一直到高级执行功能。

此外，每个部分都增加了已经为您准备好的家庭作业“项目”。只需下载，按照步骤操作，并模拟本章讨论的所有内容。他们使用的软件 Emergent 有点笨拙，但非常强大：我相信它是 10 多年工作的产物。

上个学期我在本科班上学过，很棒。一步一步引导你完成所有事情

# asp.net - ASP.Net - 可以在网格中编辑多行，然后全部保存？PLUS...单行的部分回发，从数据集中检索新值

> ID：478948
> 
> 赞同：0
> 
> 时间：2009-01-26T06:06:05.857
> 
> 标签：asp.net, asp.net-ajax

我需要在 asp.net 中实现一个网格，其行为几乎与 MS Excel 完全相同。- 可以使用箭头键导航 - 您可以通过简单的输入来编辑当前具有焦点的单元格 - 支持复选框、下拉列表等

一个关键要求是....我需要能够以*某种方式*，在更新一行中的任何单元格后，将该更新后的值传递回服务器，因为使用该更新后的值会发生一个计算过程，该更新值可以更新其他行中的单元格，我需要将当前行中的所有单元格与计算产生的更新值重新绑定。并且...当我这样做时，我想将注意力集中在更新前一个单元格后拥有它的单元格上。没有网格滚动等。

如果您想知道我在说什么，想象一下 Microsoft Excel，但我需要在服务器上执行公式计算并用结果刷新当前行中的所有单元格......并且，不要失去我的焦点当前单元格。

我很乐意为成熟的商业 ASP.Net 网格控件之一支付 1000 美元或任何费用，但从我迄今为止尝试过的那些来看，他们似乎无法做到这一点，至少我没有知识。Aspose Grid - 本来会很好用，除了它完全充满错误 Telerik RadGrid - 一位熟悉该网格的同事正试图弄清楚它，但没有运气 Farpoint Grid - 看起来很有希望，但还没有尝试过

如果有人对如何具体实现这一点有任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T07:21:15.893

您是否尝试过[extjs](http://extjs.com/deploy/dev/examples/grid/edit-grid.html)示例？
它有商业许可证，但您可以免费试用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T11:18:17.537

我设法找到了 Telerik 的类似 Excel 的 RadGrid 的示例 - 如果您对它感兴趣，可以[在此处查看](http://www.telerik.com/community/code-library/aspnet-ajax/grid/excel-like-radgrid.aspx)。祝您实施顺利。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-02T19:32:25.473

您是否考虑过为此使用 jQuery？查看 jQuery 模板和 ajax。

# c# - 如何判断是否连接到互联网

> ID：478952
> 
> 赞同：3
> 
> 时间：2009-01-26T06:08:10.563
> 
> 标签：c#, delphi, delphi-7

**我希望编写一个 Windows 应用程序，当我与互联网断开连接时它会做一些事情**。我正在考虑编写一个非常简单的 C#/Delphi 应用程序，它只是每 20 秒轮询一次，看看我是否仍然连接。

如果我必须投票，我真的很想要一个解决方案，而不是尝试从网上下载网页。我不能假设下载尝试失败意味着“不在线”，因为可能有其他应用程序占用了互联网带宽。另外，我确信不断从特定站点连接/下载会阻止我的 IP。

我确信有一种**方法可以在不下载/连接到远程服务器的情况下判断您是否在线，**但我不确定如何。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-26T06:50:58.340

请注意，连接到 Internet 并没有任何实际意义：如果您连接到 ISP，但主干网已关闭，或者您要访问的所有站点都位于最近关闭电网的国家/地区，该怎么办？有联系并不意味着你可以做你想做的事。
无论如何，如前所述，您可以使用`InternetGetConnectedState`API 来测试您是否配置了有效的 Internet 连接。
例如，以下例程正确地告诉我我有一个 LAN 连接，但未能检测到我的 ZoneAlarm 防火墙设置为阻止“所有 Internet 活动”，这意味着您实际上失去了所有 Internet 连接。

德尔福例程：

```
procedure IsConnected;
var
  dwFlags: DWORD;
begin
  if InternetGetConnectedState(@dwFlags, 0) then
  begin
    if (dwFlags and INTERNET_CONNECTION_MODEM) = INTERNET_CONNECTION_MODEM  then
      ShowMessage('Modem Connection')
    else
    if (dwFlags and INTERNET_CONNECTION_LAN) = INTERNET_CONNECTION_LAN then
      ShowMessage('LAN Connection')
    else
    if (dwFlags and INTERNET_CONNECTION_PROXY) = INTERNET_CONNECTION_PROXY then
      ShowMessage('Connection thru Proxy')
    else
    if (dwFlags and INTERNET_CONNECTION_OFFLINE) = INTERNET_CONNECTION_OFFLINE then
      ShowMessage('Local system in offline mode')
    else
    if (dwFlags and INTERNET_CONNECTION_CONFIGURED) = INTERNET_CONNECTION_CONFIGURED then
      ShowMessage('Valid connection exists, but might or might not be connected')
  end
  else
    ShowMessage('Not Connected. Try to connect and risk of being prompted to dial into another Internet Service Provider.');
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-26T06:12:53.143

调用[`InternetGetConnectedState`](http://msdn.microsoft.com/en-us/library/aa384702(VS.85).aspx)函数。这篇[知识库文章](http://support.microsoft.com/kb/242558)解释了如何做到这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T06:12:48.887

看起来可以使用此处描述的方法来完成：[http ://www.csharphelp.com/archives3/archive499.html](http://www.csharphelp.com/archives3/archive499.html)

# c# - 如何为作为唯一列集的多值组件创建 NHibernate 映射文件？

> ID：478953
> 
> 赞同：2
> 
> 时间：2009-01-26T06:08:13.373
> 
> 标签：c#, nhibernate, hibernate, fluent-nhibernate, mapping

我正在使用 NHibernate 和 Fluent NHibernate 为域对象创建映射文件（尽管我不在乎答案是否使用流利的 NHibernate 或 xml hbm 语法）。而且我在弄清楚如何指定表示域对象中的组件的一组列是唯一的时遇到了麻烦。

这是域对象：

```
public class SpaceLocation
{
        public SpaceCoordinate Coordinates { get; set; }
        public SpaceObject AtLocation { get; set; }
} 
```

这是我遇到问题的组件：

```
public struct SpaceCoordinate
{
        public int x { get; set; }
        public int y { get; set; }
        public int z { get; set; }
} 
```

不要担心`SpaceObject AtLocation`这个问题的目的。

所以我知道如何用 SpaceCoordinate 制作一个组件，但我想制作它，以便不能重复插入同一组坐标。为了做到这一点，我想让组件作为一个整体独一无二。

为了让您了解我正在尝试的方向，我将向您展示我对映射类的了解：

```
public class SpaceLocationMap : ClassMapWithGenerator<SpaceLocation>
    {
        public SpaceLocationMap()
        {

            Component<SpaceCoordinate>(x => x.Coordinates, m => 
            {
                m.Map(x => x.x);
                m.Map(x => x.y);
                m.Map(x => x.z);
            });
        }
    } 
```

这个 Fluent NHibernate 映射的问题在于它没有将唯一约束共同应用于 SpaceCoordinate 的值。请注意，我并不是要单独将每个设置为唯一的，那样限制性太强了。

那么，您将如何使用 hbm 或 fluent 映射文件进行映射呢？

任何帮助将不胜感激，感谢阅读！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T16:15:23.490

m4bwav 在 hbm 映射中是正确的；但是，在您编写问题时，Fluent NHibernate 对此没有支持。我刚刚提交了一个`Unique`向组件映射添加方法的修复程序。

```
Component<SpaceCoordinate>(x => x.Coordinates, m => 
{
  m.Map(x => x.x);
  m.Map(x => x.y);
  m.Map(x => x.z);
}).Unique(); 
```

因此，您需要更新 Fluent NHibernate 的副本。如果由于某种原因您无法做到这一点，您可以使用该`SetAttribute`方法破解它。

```
Component<SpaceCoordinate>(x => x.Coordinates, m => 
{
  m.Map(x => x.x);
  m.Map(x => x.y);
  m.Map(x => x.z);
}).SetAttribute("unique", "true"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T15:32:13.360

我相信答案是这样的：

```
<class name="SpaceLocation" table="SpaceLocation">
    <property name="AtLocation" type="SpaceObject"/>
    <component name="Coordinates" class="SpaceCoordinate" unique="true">
        <property name="x"/>
        <property name="y"/>
        <property name="z"/>
    </component>
</class> 
```

但我还没有检查。现在如何在流利的nhibernate中做到这一点？

# c++ - 常量长度的 C++ 数组成员（初始化）

> ID：478967
> 
> 赞同：19
> 
> 时间：2009-01-26T06:18:15.473
> 
> 标签：c++

我有一个包含数组的类。我希望将此数组设置为常量的长度：

```
// Entities.h
    class Entities
    {
        private:
            const int maxLimit;
            int objects[maxLimit];
            int currentUsage;

        public:
            Entities();

            bool addObject(int identifier);
            void showStructure();
    }; 
```

我遇到的主要问题是构造函数。我想：

```
// Entities.cpp
    Entities::Entities() : maxLimit(50)
    {
        currentUsage = 0;
        cout << "Entities constructed with max of 50" << endl;
    } 
```

本来就足够了……但不是这样。我不知道我是否可以使用初始化列表进行数组初始化。

如何使用const初始化`objects`数组？`maxLimit`我对 C++ 中的类比较陌生，但我有使用 Java 的经验。我主要是在测试这种“恒定性”现象。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-26T06:34:19.577

数组必须具有恒定长度。我的意思是该类的所有对象的长度相同。那是因为编译器必须知道每个对象的大小，并且对于该特定类的所有对象来说它必须是相同的。因此，以下将做到这一点：

```
class Entities
{
    private:
            static const int maxLimit = 50;
            int objects[maxLimit];
            int currentUsage;

    public:
            Entities();

            bool addObject(int identifier);
            void showStructure();
}; 
```

在 cpp 文件中：

```
const int Entities::maxLimit; 
```

我更喜欢为此使用枚举，因为我不必在 cpp 文件中定义静态：

```
class Entities
{
    private:
            enum { maxLimit = 50 };
            int objects[maxLimit];
            int currentUsage;

    public:
            Entities();

            bool addObject(int identifier);
            void showStructure();
}; 
```

如果您想拥有每个对象大小的数组，那么您可以使用动态数组。`vector`是这样的：

```
class Entities
{
    private:
            const int maxLimit;
            std::vector<int> objects;
            int currentUsage;

    public:
            Entities();

            bool addObject(int identifier);
            void showStructure();
};

// Entities.cpp
Entities::Entities(int limit) 
    : maxLimit(limit), objects(limit), currentUsage(0)
{
    cout << "Entities constructed with max of 50" << endl;
} 
```

最好是在初始化列表中做尽可能多的初始化。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-26T06:53:57.430

如果需要在编译时设置数组大小，可以使用模板参数：

```
template<size_t maxLimit>
class Entities
{
    int objects[maxLimit];
    public:
        Entities() {}
        ...
};

Entities<1000> inst; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T06:32:30.860

要动态分配内存，您可能需要使用“new”关键字，例如

对象将被定义为：

```
int * objects; 
```

在构造函数中你会做：

```
objects = new int [maxLimit]; 
```

编辑：

忘了提一下，完成后你需要释放数组，可能在类的析构函数中。

```
delete[] objects; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T06:33:31.497

`const int`s 必须在声明时初始化。如果您在声明时不知道它的价值，您将不得不采用不同的策略。

您需要在构造函数中创建数组，同时在外部保留一个指针。这是你想做的吗？

在你的课上：

```
private:
    int maxLimit;
    int* objects; 
```

在外面：

```
Entities::Entities() : maxLimit(50)
{
    currentUsage = 0;
    cout << "Entities constructed with max of 50" << endl;
    objects = new int[maxLimit];
}

Entities::~Entities()
{
    delete [] objects;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T08:20:10.907

如果所有对象都具有相同的长度，则长度可以是静态的。这使其成为允许作为数组绑定的常量整数表达式：

```
class Entities
{
    private:
        static const int maxLimit = 50;
        int objects[maxLimit];
        int currentUsage;
    //...
}; 
```

请记住 sizeof(Entities) 是一个有效的表达式。每个实体对象都具有相同的大小。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T11:10:22.357

使用 std::vector ，你会得到预期的行为。无需担心指针、副本等

```
#include <vector>

class Entities
{
private:
  const int limit;
  std::vector<int> objects;

public:
  Entities(int a_limit)
    : limit(a_limit), objects(a_limit)
  { }

  void addObject(int identifier)
  {
    if (objects.size() == limit)
      throw whatever;
    objects.push_back(identifier);
  }
}; 
```

# c# - C#中的数字总和

> ID：478968
> 
> 赞同：46
> 
> 时间：2009-01-26T06:18:47.923
> 
> 标签：c#, algorithm, sum-of-digits

计算数字和的最快和最容易阅读的实现是什么？

即给定数字：17463 = 1 + 7 + 4 + 6 + 3 = 21

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-01-26T06:22:20.550

您可以在不使用字符串的情况下进行算术运算：

```
sum = 0;
while (n != 0) {
    sum += n % 10;
    n /= 10;
} 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-01-26T06:49:20.763

我用

```
int result = 17463.ToString().Sum(c => c - '0'); 
```

它仅使用 1 行代码。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-01-26T07:49:35.243

对于整数，Greg Hewgill 有大部分答案，但忘记考虑 n < 0。-1234 的数字总和应该仍然是 10，而不是 -10。

```
n = Math.Abs(n);
sum = 0;
while (n != 0) {
    sum += n % 10;
    n /= 10;
} 
```

如果数字是浮点数，则应采取不同的方法，而chaowman的解决方案在到达小数点时将完全失败。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-26T07:51:57.953

```
int num = 12346;
int sum = 0;
for (int n = num; n > 0; sum += n % 10, n /= 10) ; 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-01-26T06:23:03.110

```
 public static int SumDigits(int value)
 {
     int sum = 0;
     while (value != 0)
     {
         int rem;
         value = Math.DivRem(value, 10, out rem);
         sum += rem;
     }
     return sum;
 } 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-26T07:40:02.737

我喜欢chaowman的回应，但会做一个改变

```
int result = 17463.ToString().Sum(c => Convert.ToInt32(c)); 
```

我什至不确定 c - '0', 语法会起作用吗？（我认为减去两个字符应该得到一个字符？）

我认为它是最易读的版本（使用 sum 这个词与 lambda 表达式相结合，表明您将为每个字符都执行此操作）。但事实上，我认为这不会是最快的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-01-29T13:41:32.187

我想我只是为了完成而发布这个：

如果您需要数字的递归总和，例如：**17463** -> 1 + 7 + 4 + 6 + 3 = **21** -> 2 + 1 = **3**
那么最好的解决方案是

```
int result = input % 9;
return (result == 0 && input > 0) ? 9 : result; 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-01-05T12:12:17.130

```
int n = 17463; int sum = 0;
for (int i = n; i > 0; i = i / 10)
{
sum = sum + i % 10;
}
Console.WriteLine(sum);
Console.ReadLine(); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-05T10:16:42.323

我建议最容易阅读的实现是这样的：

```
public int sum(int number)
{
    int ret = 0;
    foreach (char c in Math.Abs(number).ToString())
        ret += c - '0';
    return ret;
} 
```

这很有效，而且很容易阅读。顺便说一句：Convert.ToInt32('3') 给出 51，而不是 3。 Convert.ToInt32('3' - '0') 给出 3。

我认为最快的实现是 Greg Hewgill 的算术解决方案。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-05-20T17:41:14.917

```
private static int getDigitSum(int ds)
{
    int dssum = 0;            
    while (ds > 0)
    {
        dssum += ds % 10;
        ds /= 10;
        if (dssum > 9)
        {                
            dssum -= 9;
        }
    }
    return dssum;
} 
```

这是为了提供 0-9 之间的数字总和

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-09-02T17:02:05.750

```
public static int SumDigits1(int n)
{
    int sum = 0;
    int rem;
    while (n != 0)
    {           
        n = Math.DivRem(n, 10, out rem);
        sum += rem;
    }
    return sum;
}

public static int SumDigits2(int n)
{
    int sum = 0;
    int rem;
    for (sum = 0; n != 0; sum += rem)   
        n = Math.DivRem(n, 10, out rem);        
    return sum;
}   

public static int SumDigits3(int n)
{
    int sum = 0;    
    while (n != 0)
    {
        sum += n % 10;
        n /= 10;
    }   
    return sum;
} 
```

完整代码在：[https ://dotnetfiddle.net/lwKHyA](https://dotnetfiddle.net/lwKHyA)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-04-15T04:59:14.273

```
int j, k = 1234;
for(j=0;j+=k%10,k/=10;); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-05-19T19:05:19.823

不久前，我必须找到某物的数字总和。我使用了 Muhammad Hasan Khan 的代码，但是它一直将正确的数字作为循环小数返回，即当数字总和为 4 时，我会得到 4.44444444444444 等。因此我对其进行了编辑，每次使用此代码得到正确的数字总和：

```
 double a, n, sumD;
 for (n = a; n > 0; sumD += n % 10, n /= 10);
 int sumI = (int)Math.Floor(sumD); 
```

其中 a 是您想要其数字总和的数字，n 是用于此过程的双精度数，sumD 是双精度数字总和 sumI 是整数数字总和，因此是正确的数字总和。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-05-30T13:17:38.737

```
static int SumOfDigits(int num)
{
    string stringNum = num.ToString();
    int sum = 0;
    for (int i = 0; i < stringNum.Length; i++)
    {
      sum+= int.Parse(Convert.ToString(stringNum[i]));

    }
    return sum;
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-07-05T19:47:08.180

如果要执行特定操作，例如仅添加奇数/偶数，仅添加具有奇数索引/偶数索引的数字，那么以下代码最适合。在此示例中，我从输入数字中添加了奇数。

```
using System;

public class Program
{
    public static void Main()
    {
        Console.WriteLine("Please Input number");
        Console.WriteLine(GetSum(Console.ReadLine()));
    }

    public static int GetSum(string num){
        int summ = 0;
        for(int i=0; i < num.Length; i++){
            int currentNum;
            if(int.TryParse(num[i].ToString(),out currentNum)){
                 if(currentNum % 2 == 1){
                    summ += currentNum;
                }
            }
       } 
       return summ;
    }
} 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2015-08-10T09:46:36.437

最简单和最简单的方法是使用循环来[查找数字总和](http://www.codeforwin.in/2015/06/c-program-to-calculate-sum-of-digits.html)。

```
int sum = 0;
int n = 1234;

while(n > 0)
{
    sum += n%10;
    n /= 10;
} 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2016-09-05T13:25:28.817

```
#include <stdio.h>

int main (void) {

    int sum = 0;
    int n;
    printf("Enter ir num ");
    scanf("%i", &n);

    while (n > 0) {
        sum += n % 10;
        n /= 10;
    }

    printf("Sum of digits is %i\n", sum);

    return 0;
} 
```

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2017-11-10T23:41:00.097

让没有人考虑 Substring 方法感到惊讶。不知道它是否更有效。对于任何知道如何使用此方法的人来说，对于这种情况，它非常直观。

```
string number = "17463";
int sum = 0;
String singleDigit = "";
for (int i = 0; i < number.Length; i++)
{
singleDigit = number.Substring(i, 1);
sum = sum + int.Parse(singleDigit);
}
Console.WriteLine(sum);
Console.ReadLine(); 
```

# java - 精简和/或了解动态 Web 项目中的 Eclipse 文件

> ID：478985
> 
> 赞同：13
> 
> 时间：2009-01-26T06:33:32.213
> 
> 标签：java, eclipse, apache, ant

**位于动态 Web 项目**的 .settings 中的文件是：

```
.settings/
|-- org.eclipse.jdt.core.prefs
|-- org.eclipse.jst.common.project.facet.core.prefs
|-- org.eclipse.jst.j2ee.ejb.annotations.xdoclet.prefs
|-- org.eclipse.wst.common.component
|-- org.eclipse.wst.common.project.facet.core.xml
|-- org.eclipse.wst.jsdt.ui.superType.container
|-- org.eclipse.wst.jsdt.ui.superType.name
`-- org.eclipse.wst.validation.prefs 
```

上面的文件列表几乎是一个全新的动态 Web 项目，只是我使用的是 IvyDE 插件，但我认为它只影响 .classpath 文件。

**如何了解有关这些文件的更多信息？我想知道我是否可以在不丢失重要东西的情况下摆脱它们？**在 Eclipse.org 上查找此信息并不容易，非常欢迎提供链接或解释。

我正在尝试了解有关这些文件的更多信息，因为我想在将 Eclipse 文件签入版本控制之前尽可能地精简它们。

如果它有助于我列出上述文件及其内容：

**org.eclipse.jdt.core.prefs：**

```
#Mon Jan 26 03:01:22 CET 2009
eclipse.preferences.version=1
org.eclipse.jdt.core.compiler.codegen.targetPlatform=1.5
org.eclipse.jdt.core.compiler.compliance=1.5
org.eclipse.jdt.core.compiler.problem.assertIdentifier=error
org.eclipse.jdt.core.compiler.problem.enumIdentifier=error
org.eclipse.jdt.core.compiler.source=1.5 
```

**org.eclipse.jst.common.project.facet.core.prefs：**

```
#Mon Jan 26 03:01:22 CET 2009
classpath.helper/org.eclipse.jdt.launching.JRE_CONTAINER\:\:org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType\:\:java-6-sun-1.6.0.07/owners=jst.java\:5.0
eclipse.preferences.version=1 
```

**org.eclipse.jst.j2ee.ejb.annotations.xdoclet.prefs：**

```
#Mon Jan 26 03:23:25 CET 2009
XDOCLETBUILDERACTIVE=false
XDOCLETHOME=
XDOCLETUSEGLOBAL=false
XDOCLETVERSION=1.2.1
eclipse.preferences.version=1 
```

**org.eclipse.wst.common.component：**

```
<?xml version="1.0" encoding="UTF-8"?>
<project-modules id="moduleCoreId" project-version="1.5.0">
    <wb-module deploy-name="webcookie">
        <wb-resource deploy-path="/" source-path="/src/main/webapp"/>
        <wb-resource deploy-path="/WEB-INF/classes" source-path="/src/main/java"/>
        <wb-resource deploy-path="/WEB-INF/classes" source-path="/src/test/java"/>
        <wb-resource deploy-path="/WEB-INF/classes" source-path="/src/main/resources"/>
        <property name="context-root" value="webcookie"/>
        <property name="java-output-path"/>
    </wb-module>
</project-modules> 
```

**org.eclipse.wst.common.project.facet.core.xml：**

```
<?xml version="1.0" encoding="UTF-8"?>
<faceted-project>
  <fixed facet="jst.java"/>
  <fixed facet="jst.web"/>
  <installed facet="jst.java" version="5.0"/>
  <installed facet="jst.web" version="2.5"/>
</faceted-project> 
```

**org.eclipse.wst.jsdt.ui.superType.container：**

```
org.eclipse.wst.jsdt.l 
```

**org.eclipse.wst.validation.prefs：**

```
#Mon Jan 26 03:31:54 CET 2009
DELEGATES_PREFERENCE=delegateValidatorList
USER_BUILD_PREFERENCE=enabledBuildValidatorListorg.eclipse.jst.j2ee.internal.classpathdep.ClasspathDependencyValidator;org.eclipse.wst.common.componentcore.internal.ModuleCoreValidator;org.eclipse.wst.wsi.ui.internal.WSIMessageValidator;
USER_MANUAL_PREFERENCE=enaunching.baseBrowserLibrary 
```

**org.eclipse.wst.jsdt.ui.superType.name：**

```
Window 
```

**org.eclipse.wst.validation.prefs：**

```
#Mon Jan 26 03:31:54 CET 2009
DELEGATES_PREFERENCE=delegateValidatorList
USER_BUILD_PREFERENCE=enabledBuildValidatorListorg.eclipse.jst.j2ee.internal.classpathdep.ClasspathDependencyValidator;org.eclipse.wst.common.componentcore.internal.ModuleCoreValidator;org.eclipse.wst.wsi.ui.internal.WSIMessageValidator;
USER_MANUAL_PREFERENCE=enabledManualValidatorListorg.eclipse.jst.j2ee.internal.classpathdep.ClasspathDependencyValidator;org.eclipse.wst.common.componentcore.internal.ModuleCoreValidator;org.eclipse.wst.wsi.ui.internal.WSIMessageValidator;
USER_PREFERENCE=overrideGlobalPreferencesfalse
eclipse.preferences.version=1
override=false
suspend=false
vf.version=3 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-26T08:02:17.167

让我们来看看：

*   `org.eclipse.jdt.core.prefs`非常重要并控制你如何编译你的java项目。
*   `org.eclipse.jst.common.project.facet.core.prefs`添加一个**[Facet](http://org.eclipse.wst.common.project.facet.core.xml)**，基本上是一种在 Eclipse 中向项目引入功能的方法，因此一个项目可以有一个或多个方面（即，它可以是 Java 项目和 EJB 项目）。请参阅[此处以获取说明](http://servicemix.apache.org/extending-eclipse-wtp-to-support-jbi.html)（搜索单词“Facet”）
*   `org.eclipse.jst.j2ee.ejb.annotations.xdoclet.prefs`是一种[配置 XDoclet 注释支持的方法](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.jst.ejb.doc.user/topics/txdocletconf.html)
*   `org.eclipse.wst.common.component`与[部署结构](http://dev.eclipse.org/newslists/news.eclipse.webtools/msg17655.html)有关。
*   `org.eclipse.wst.common.project.facet.core.xml`用于[为 J2EE 项目指定目标服务器](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.jst.j2ee.doc.user/topics/tjtargetserver.html)
*   `org.eclipse.wst.validation.prefs`指[Wst 验证](http://www.eclipse.org/webtools/wst/components/validation/ValidationOverview.html)
*   `org.eclipse.wst.jsdt.ui.superType.container/name` [正如这里所解释的](http://dev.eclipse.org/newslists/news.eclipse.webtools.atf/msg00430.html)，是 JSDT 部分的配置：

    > 默认情况下，纯 javascript 文件 (.js) 从对象 Global 继承成员。静态/动态 Web 项目中包含的 HTML 文件从对象 Window 继承成员。
    > 因此，如果您的上下文是一个普通的 javaScript 文件，它将显示只有 Window.window 或 Window.alert(..) 是有效的，因为没有 Window 成员被继承。您真正想要的是从 Window 对象的实例继承此字段 + 方法。
    > **,**
    > JSDT 在项目级别支持可配置的超类型。项目中的每个 .js 或 .html 文件都继承了项目超类型的所有字段和方法。默认情况下，独立 JavaScript 项目的类型为全局，静态/动态 Web 项目的类型为窗口。
    > **,**
    > 您可以从 JavaScript 包含路径属性页面将项目的超级类型从 Object Global 更改为 Object Window 以实现您想要的结果...在 Global Order/SuperType 页面上，在 ECMA 库中将 Super Type 更改为 Window。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T07:42:45.927

您应该使用并信任 MANIFEST.MF 中的“依赖项”选项卡。在使用 Eclipse 插件大约一年之后，我不会尝试找出是否需要哪个 Eclipse 插件依赖项。

当你错过了运行时需要的插件时，你会得到不是很有用的异常，解决方案也不明显。

每次重构代码时都应选择清单操作“查找未使用的依赖项”。当您从头开始生成完整的新插件时，它还有助于检查 eclipse 将创建的类。eclipse 插件没有很好的文档记录，所以我会使用提供的操作，而不是花太多时间来理解它们。

如果你真的想知道使用了哪些插件，当你从头创建插件时，你可以删除一些扩展声明或变量，然后按“查找未使用的依赖项”操作来查看，哪个插件用于调用。***