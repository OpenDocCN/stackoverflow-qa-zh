# StackOverflow 问答 10654000-10654999

# php - phpMyAdmin 视频不显示

> ID：10654010
> 
> 赞同：0
> 
> 时间：2012-05-18T13:57:24.307
> 
> 标签：php, sql, html, phpmyadmin, mamp

## -感谢所有帮助的人。原来这确实是我自己的愚蠢。本地数据库上的表列称为“url”，在网络主机上称为“urls”。为浪费大家的时间道歉！

我正在尝试让网页显示一些视频，这些视频的路径在数据库中。

以下代码在 Localhost 上运行良好（我正在使用 MAMP），但是当我将其上传到网络服务器时，它会显示视频的名称，但我得到“没有找到支持格式和 MIME 类型的视频。 " 在火狐中。Chrome 和 Safari 都在加载时停止。

```
$result=mysql_query("SELECT * FROM videos");

while($row = mysql_fetch_array($result))
{
echo "<video width=\"600\" height=\"350\" controls=\"controls\">";
echo "<source src='".$row['url'].".mp4' type='video/mp4'/>";
echo "<source src='".$row['url'].".theora.ogv' type='video/ogg'/>";
echo "</video>";
echo "<br>" . $row['name'] ."<br/><br/>";
} 
```

我想这可能是显而易见的，但我很难过。

非常感谢任何帮助。

谢谢，罗伯特。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:08:28.117

您可以验证视频是否在数据库中（名称是一回事，文件是否真的存在？）？如果使用上传表单，则必须使用`enctype="multipart/form-data"`. 我假设视频是您尝试请求它们的格式。

在您的帖子中，您说“但是当我将其上传到网络服务器时”，那么问题在于上传，而不是视频的显示？您似乎在说上传有问题，但您的代码是从数据库中检索它的代码。

上传问题或首先显示问题也是如此。

# pointers - 在c中铸造一个结构

> ID：10654015
> 
> 赞同：2
> 
> 时间：2012-05-18T13:57:44.417
> 
> 标签：pointers, casting, struct

我需要一组用户结构。

```
struct user {
    char *username;
};  

struct user users[10]; //Array of user structs

int main(int argc, char **args) {
    int initUsersArray();        
    char *username = "Max";
    addToUsersArrry(username);

}

int addToUsersArrry(username) {
int i;
i = 0;
struct user tmp;    
for(i;i<10;i++) {
    if(users[i] != NULL) 
        if(strcmp(*users[i].username,username)==0)
            return -1;
}
i = 0;
for(i;i<10;i++) {
    if(users[i] = NULL) { 
        users[i]=tmp;
        users[i].username=username;
        return 1;
    }   

}   

}

int initUsersArray() {  
int i;
i=0;
struct user tmp;

for(i;i<10;i++) {
    users[i] = (struct user*) calloc(1,sizeof(tmp));
}
} 
```

我的第一个问题是，如果它是像我一样用 NULL 初始化用户数组的正确方法。第二个问题是，*users[i].username 和其他想要在特定位置获取/设置用户的代码部分不起作用。问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:18:29.417

在这里，我为你修好了。并且不要忘记区分和学习一些东西。不要只是 c/p 它。

```
#include <stdio.h>
#include <stdlib.h>

typedef struct user {
    char *username;
} user;

user *users; //Array of user structs

int addToUsersArray(char *username) {
int i = 0;

for(; i<10; i++) {
    if(users[i].username=='\0') {
        users[i].username = username;
    return 1;
    } else if(strcmp(users[i].username, username) == 0)
    return -1;
}
return -1;
}

void initUsersArray() {  
    users = (user*) calloc(10, sizeof(user)); //10 of them
}

int main(int argc, char** argv) {
    initUsersArray();        
        char *username = "Max";
        addToUsersArray(username);
    username = "Ma1x";
    addToUsersArray(username);
    printf("%s\n",users[0].username);
    printf("%s\n",users[1].username); 
    return 1;
} 
```

# orchardcms - 无法在新的 Orchard v.1.4.1 站点中获得评论

> ID：10654028
> 
> 赞同：0
> 
> 时间：2012-05-18T13:58:11.037
> 
> 标签：orchardcms

我已经使用 Blog recipy 和在 SQL Server 上运行的数据库建立了一个新的 Orchard CMS 站点。

我已启用该站点随附的所有模块，包括评论模块。

评论显示在内容部分列表中。它还显示在博客文章内容类型的部分列表中。

问题是创建新帖子时没有允许新评论部分。查看已发布的帖子时也不会显示评论部分。

有什么很明显的我想念的吗？

**更新：**

App_Data\Logs 目录中有一条错误消息，但我不确定它是否相关：

```
2012-05-18 13:38:37,019 [8] NHibernate.AdoNet.AbstractBatcher - Could not execute query: SELECT top 2 this_.Id as Id11_0_, this_.SerialNumber as SerialNu2_11_0_ FROM     Settings_ShellDescriptorRecord this_ WHERE 1=1
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Settings_ShellDescriptorRecord'.
    at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
    at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
    at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
    at System.Data.SqlClient.SqlDataReader.ConsumeMetaData()
    at System.Data.SqlClient.SqlDataReader.get_MetaData()
    at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
    at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
    at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
    at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
    at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
    at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
    at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader()
    at NHibernate.AdoNet.AbstractBatcher.ExecuteReader(IDbCommand cmd)
2012-05-18 13:38:37,078 [8] NHibernate.Util.ADOExceptionReporter - Invalid object name 'Settings_ShellDescriptorRecord'.
2012-05-18 13:38:37,091 [8] NHibernate.Util.ADOExceptionReporter - Invalid object name 'Settings_ShellDescriptorRecord'. 
```

**更新 2：**

好的，一段时间后我回到这个问题。最初我使用的是 SQL Server 2008R2，但为了排除这种情况，我使用本地数据库设置了几个测试站点。我下载了 Orchard.Web.1.4.1 和 Orchard.Web.1.4.2 的新副本，并使用博客食谱进行设置。1.4.1 系统仍然存在问题。1.4.2 虽然拥有应有的一切。管理菜单中有一个评论选项，博客文章有评论。

不知道 1.4.1 的问题是什么，但 1.4.2 对我有用。

# java - maven 没有用新的内部版本号更新本地 repo 中的 jar

> ID：10654031
> 
> 赞同：0
> 
> 时间：2012-05-18T13:58:20.720
> 
> 标签：java, maven-3

我在我的一个模块的 pom 中添加了内部版本号插件，如下所示：

```
<plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>buildnumber-maven-plugin</artifactId>
        <version>1.0-beta-4</version>
        <executions>
            <execution>
                <phase>validate</phase>        
                <goals>
                    <goal>create</goal>
                </goals>
            </execution>
        </executions>
        <configuration>
            <doCheck>false</doCheck>
            <doUpdate>true</doUpdate>
            <format>${project.version}.{0,number}</format>
            <items>
                <item>buildNumber</item>
            </items>
        </configuration>
    </plugin> 
```

我还尝试将构建的 jar 保存在文件夹中。

```
<plugin>

    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-jar-plugin</artifactId>
    <version>2.3.2</version>
    <configuration>
      <archive>
        <manifest>
          <addDefaultImplementationEntries>true</addDefaultImplementationEntries>
        </manifest>
        <manifestEntries>
          <Implementation-Build>${buildNumber}</Implementation-Build>
        </manifestEntries>
      </archive>
      <outputDirectory>target/${buildNumber}</outputDirectory>
    </configuration>
</plugin> 
```

构建工作正常，jar 在目标内部创建为 target//myjar-.jar （假设版本为 1.0，并且 buildnumber 随着每个构建从 1 开始递增）但是在本地存储库中，jar 存储为 package//myjar- .jar ，即内部版本号没有被添加到那里。有没有办法做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T15:23:45.810

如果我正确理解您的问题，一切似乎都很好（目标目录中的工件、清单等），除了本地存储库中的文件名不是您想要的，对吗？

如果是这样，并且如果我没记错的话，那应该可以。本地/远程存储库中的工件文件名是根据工件名称、版本号、修饰符和限定符以及快照时的时间戳生成的。它与目标目录中的输出文件名无关。

# objective-c - 使用 MGTwitterEngine 在 iPhone 应用程序中关注 Twitter 帐户

> ID：10654043
> 
> 赞同：0
> 
> 时间：2012-05-18T13:59:04.370
> 
> 标签：objective-c, ios

我需要任何可以使用 MGTwitterEngine 关注帐户的源代码。它应该适用于 iOS，请告诉我是否可以使用 oAuth 关注帐户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:15:20.320

可以使用 POST "friendships/create" 方法：

[https://dev.twitter.com/docs/api/1/post/friendships/create](https://dev.twitter.com/docs/api/1/post/friendships/create)

您是否已获得 MGTwitterEngine 身份验证并拥有 _engine 的 init'ed 版本，或者您是否需要此代码？

如果您已经过身份验证，您只需在 MGTwitterEngine 上调用：

*   (NSString *)enableUpdatesFor:(NSString *)用户名；// 友谊/创建（跟随用户名）

...建立友谊。

干杯-JM

# windows - 如何强制释放被其他应用程序占用或已挂起的 COM 端口

> ID：10654047
> 
> 赞同：3
> 
> 时间：2012-05-18T13:59:34.727
> 
> 标签：windows, winapi, usb, serial-port, usbserial

我正在使用 USB 服务器（MyUTN USB 设备服务器 - [http://www.myutn.net/home.html](http://www.myutn.net/home.html)）将我的 Windows 2008 Server 虚拟机连接到 USB 调制解调器。USB 调制解调器带有一个 COM 仿真驱动程序，它在 Win2k8 服务器上创建一个虚拟 COM 端口。MyUTN 还附带了一个模拟 Win2k8 服务器上的 USB 设备的软件。

在 Win2k8 服务器端，我运行一个调制解调器应用程序（一个 NT 服务），它通过虚拟 COM 端口连接到调制解调器（开放端口），并且在用户关闭应用程序之前不会释放它。

应用程序和调制解调器在物理 USB 端口上工作正常，但是当我将它与 MyUTN USB 设备服务器一起使用时，我遇到了一个问题，即如果调制解调器重置或暂时断开连接，端口不会被释放。发生的情况是我的应用程序被调制解调器锁定。即使我要关闭我的应用程序，端口也不会被释放。但是调制解调器正在工作，因为它上面的灯打开并闪烁。解决锁定的唯一方法是物理移除调制解调器并将其重新插入。

我试图解决这个问题，但无济于事，迫切需要在下周一之前解决这个问题。我能想到的一种快速方法是我是否可以以编程方式释放占用的端口。请让我知道是否可以这样做。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T10:44:36.000

MyUTN 支持无法提供答案，但似乎没有解决方案。谢谢。

# android - 模块依赖在 Android 中是如何工作的？

> ID：10654049
> 
> 赞同：4
> 
> 时间：2012-05-18T13:59:43.183
> 
> 标签：android, makefile

[我对 su-binary ( https://github.com/git-core/su-binary](https://github.com/git-core/su-binary) )做了一些小改动，添加了一个目标来设置 SUID。我使用的 Android.mk：http://pastebin.com/N0gMJT4u[在](http://pastebin.com/N0gMJT4u) Android 源代码树的根目录下运行 make 时，一切正常：

```
$ make -j5
[...]
system/core/rootdir/Android.mk:42: warning: ignoring old commands for target `out/target/product/panda/root/init.rc'
echo "Setting SUID/GUID to su-binary"
Setting SUID/GUID to su-binary
Installing busybox
chmod ug+s out/target/product/panda/system/xbin/su
[...] 
```

`mm -B`在外部/su-binary 中运行时：http: [//pastebin.com/8HmUJBA0](http://pastebin.com/8HmUJBA0) 相同的行为`mmm external/su-binary`

根据[https://groups.google.com/forum/#!msg/android-building/dtNZFj5pe1w/PRY2MXADXG4J](https://groups.google.com/forum/#!msg/android-building/dtNZFj5pe1w/PRY2MXADXG4J)

> 除了 Ying Wang 建议的“make name-of-module”之外，您还可以在目录中运行“mm”来构建（和安装）那里定义的所有模块。但是，这只会构建*那些*模块，不会构建任何依赖的*模块*。因此，它仅对跟踪依赖关系的现有树的增量构建有用。

试过了：

```
$ rm out/target/product/panda/system/xbin/su
$ make external/su-binary
[...]
make: Nothing to be done for `external/su-binary'.

$ rm out/target/product/panda/obj/EXECUTABLES/su_intermediates/su
$ make external/su-binary
[...]
make: Nothing to be done for `external/su-binary`. 
```

模块依赖在 Android 中是如何工作的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-19T21:56:29.383

好的，我通过更改 Android.mk 让它运行：

1.  以不同的方式命名`$(SU_BINARY)`目标，即`$(SU_BINARY)-post`. `LOCAL_MODULE`更好，因为以前，它与and`BUILD_EXECUTABLE`组合定义的目标具有相同的名称。
2.  把这个目标放在前面`include $(BUILD_EXECUTABLE)`

看起来像：

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)

LOCAL_MODULE := su
LOCAL_SRC_FILES := su.c db.c activity.cpp

SU_SHARED_LIBRARIES := liblog libsqlite
ifeq ($(PLATFORM_SDK_VERSION),4)
    LOCAL_CFLAGS += -DSU_LEGACY_BUILD
    SU_SHARED_LIBRARIES += libandroid_runtime
else
    SU_SHARED_LIBRARIES += libcutils libbinder libutils
    LOCAL_MODULE_TAGS := eng
endif

LOCAL_C_INCLUDES += external/sqlite/dist

LOCAL_SHARED_LIBRARIES := $(SU_SHARED_LIBRARIES)

LOCAL_MODULE_PATH := $(TARGET_OUT_OPTIONAL_EXECUTABLES)

SU_INSTALL_DIR := $(TARGET_OUT)/xbin
SU_BINARY := $(SU_INSTALL_DIR)/su
# taken from busybox-android
$(SU_BINARY)-post: su
    @echo "Setting SUID/GUID to su-binary..."
    chmod ug+s $(TARGET_OUT_OPTIONAL_EXECUTABLES)/su
    ln -sf $(TARGET_OUT_OPTIONAL_EXECUTABLES)/su $(TARGET_OUT_EXECUTABLES)/su

ALL_DEFAULT_INSTALLED_MODULES += $(SU_BINARY)-post

include $(BUILD_EXECUTABLE) 
```

`ALL_DEFAULT_INSTALLED_MODULES`我认为是在模块安装后很晚才出现的规则。但我必须深入研究它以检查这是否是我想要在这里做的最佳解决方案。

# delphi - 在安装程序中使用 SendNotifyMessage

> ID：10654052
> 
> 赞同：2
> 
> 时间：2012-05-18T13:59:59.550
> 
> 标签：delphi, winapi, inno-setup

在 Inno 安装脚本中，我通过添加一个条目来设置环境变量：

```
Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment. 
```

我希望我的用户能够运行新安装的应用程序而无需重新启动（这通常是在环境中看到上述更改所必需的。）

我计划让安装程序使用 dll 来调用*SendMessageTimeOut*，如此处所述：[Set environment variables from Delphi (Win32)](https://stackoverflow.com/questions/1009180/set-environment-variables-from-delphi-win32)。

Delphi XE2 报告此 API 已弃用。

上面的 StackOverflow 线程建议使用*SendNotifyMessage*来避免长时间等待。我不知道如何构造那个调用。

谁能告诉我语法？它也被弃用了吗？

关于更好的方法的任何建议？

汤姆

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T14:33:58.563

您可能想查看[ChangesEnvironment](http://www.jrsoftware.org/ishelp/index.php?topic=setup_changesenvironment)指令。从文档：

> 当设置为 yes 时，安装程​​序将在安装结束时通知其他正在运行的应用程序（特别是 Windows 资源管理器）它们应该从注册表重新加载其环境变量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T16:17:45.957

这两个函数都没有被弃用。Delphi 说`SendMessageTimeout`已弃用，因为*该声明*已弃用。API函数本身很好。因为你会从不是 Delphi 的东西中调用它，所以 Delphi 关于*它的*声明所说的任何内容都与你无关。

由于您实际上并不关心消息的返回值，因此`SendNotifyMessage`是更好的选择。它根本不会等待响应，而`SendMessageTimeout`会等待一段时间才能得到响应，无论如何你都会忽略它。

但正如 Mirtheil 的回答所指出的那样，您使用的安装程序环境已经提供了一种通知其他程序环境发生变化的方法，因此您应该使用它而不是尝试手动进行。

# javascript - Express.js 文件上传

> ID：10654055
> 
> 赞同：1
> 
> 时间：2012-05-18T14:00:07.227
> 
> 标签：javascript, node.js, express

我对表达还很陌生，并且在使用 express.bodyParser 上传文件时遇到了问题。bodyParser 按预期与 req.body 一起工作，因此它似乎已正确设置。我正在运行节点 0.6.17 并表示 2.5.8。每当我尝试访问 req.files 时，它都是未定义的。有谁知道这个问题的原因是什么？

来自 app.js：

```
app.configure(function(){
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.cookieParser());
  app.use(express.session({secret: "string" }));
  app.use(flash());
  app.use( express.bodyParser() );
  app.use(expressValidator);
  app.use(express.methodOverride());
  app.use(express.static(__dirname + '/public'));
  app.use(app.router);
}); 
```

来自 index.js

```
app.get('/product/add', function(req, res) {
    res.render("add_products", {
      title: "Add Products",
            email: req.session.email || 'Sign In/Up',
      error: req.flash('error') || []
    });
});

app.post('/product/add', function(req, res) {
console.log(req.files) // prints undefined
var errors = generate_error_messages(req, 'product/add') || [];
if (errors.length > 0) {
  var errors_string_array = messages(errors);
  req.flash('error', errors_string_array);
  res.redirect('/product/add');
} else {
  ProductDatabase.save(req, function(err, docs) {
    res.redirect('/');
  });
}
}); 
```

add_products.jade

```
 form(class='form-horizontal', method='post', action='/product/add')
    fieldset
      .control-group
        label(class='control-label', for="title") Product Title
        .controls
          input(type="text", class="input-xlarge", name="title")
      .control-group
        label(class='control-label', for="description") Description
        .controls
          textarea(class="input-xlarge", name="description", rows="5")
      .control-group
        label(class='control-label', for='auction_length') Auction Length
        .controls
          select(name='auction_length')
            option 1 day
            option 2 days
            option 5 days
      .control-group
        label(class='control-label', for="fileInput") Upload Image
        .controls
          input(class='input-file', name='fileInput', type='file')
      .form-actions
        input(type="submit", class="btn btn-primary") Sell Product
        a.btn(href='/') Cancel 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:22:18.393

[连接形式](https://github.com/sdepold/connect-form)怎么 样？根据我的经验，这效果更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T05:30:49.233

你在 add_products.jade 文件中有问题。

第一行表单标签应该有 enctype 属性。应该像，

form(class='form-horizo​​ntal', method='post', action='/product/add',enctype='multipart/form-data')

要发布文件，您应该具有该属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-30T12:23:40.047

对于简单的上传，您只需要这些配置：

```
app.use(express.static(__dirname + '/upload'));
app.use(express.bodyParser({uploadDir:__dirname + '/upload'})); 
```

在玉模板中：

```
form(method='post', action='/upload', enctype='multipart/form-data')
    input(name='file', type='file')
    input(type='submit') 
```

# internationalization - 翻译文件中键值的最佳实践

> ID：10654056
> 
> 赞同：27
> 
> 时间：2012-05-18T14:00:08.057
> 
> 标签：internationalization, translation

通常，翻译方法采用键 > 值映射并使用键将其转换为值。现在我认识到了两种不同的方法来命名你的翻译键，在我的团队中，我们并没有就似乎是最好的方法达成共识。

**方法一：** 使用完整的英文单词或句子：

```
Name => Name
Please enter your email address => Please enter your email address 
```

**方法二：** 使用关键字描述情况：

```
NAME => Name
ENTER_EMAIL => Please enter your email address 
```

我个人更喜欢方法#1，因为它直接显示了消息的含义。如果翻译不存在，您可以退回到密钥，这不会导致任何问题。但是，当翻译频繁更改时，该方法很麻烦，因为所有文件都需要更新。同样对于较长的文本，这些键变得非常大。这可以通过使用类似的键来解决`ENTER_EMAIL`，但是措辞完全脱离了上下文。抽象翻译键的列表会很大，您需要所有键的元数据来解释它们的用法，并且更容易发生冲突。

是否有两全其美的方法或第三种方法？您如何在应用程序中使用翻译键？在我们的例子中，它是一个基于 php 的 web 应用程序，但我认为上面的问题足够笼统地讨论 i18n。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-18T14:44:42.927

这也是 iOS/OSX 开发者面临的一个问题。对他们来说，甚至还有一个[名为方法 1 的标准工具`genstrings`](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/LoadingResources/Strings/Strings.html)。当然，Apple 开发人员不必使用这个工具——我不需要。

虽然您使用方法 1 获得的安全网很好（即，如果您以某种方式忘记本地化字符串，您可以显示密钥），但它有可能导致密钥冲突的缺点。有时，由于语法规则或上下文的差异，需要以两种不同的方式对一段相同的显示文本进行本地化。例如，“E-mail”的法语翻译是“E-mail”，如果它是一个对话框标题，“Envoyer un e-mail”如果它是一个按钮（在法语中，“E-mail”这个词只是一个名词并且不能用作动词，不像英语中它既是名词又是动词）。使用方法 2，您可以使用 EMAIL_TITLE 和 EMAIL_BUTTON 键来解决此问题，并且作为奖励，这将提示翻译人员帮助他们正确翻译。

方法 2 的另一个优点是您可以更改英文文本，而不必担心更新英文和所有本地化的密钥。

所以我推荐方法2！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-31T15:09:26.610

为什么不使用两个世界？我对短字符串使用方法#1，对完整句子的长字符串使用方法#2。我不怕将两者混合在同一个文件中。

例如，如果在新的应用程序版本中修改了用户体验，则在以下字符串中的文本可能会更改：

```
"screen description" = "Tap the plus button to add a new item. Tap an item for more options or to edit its details."; 
```

所以在这里应用方法#2 是有意义的。但是，对于以下示例中的简单字符串，方法 #1 更有用：

```
"Preferences" = "Preferences"; 
```

一般来说，当人们试图将事物标准化时，它通常对我来说似乎是限制性的。就个人而言，我更喜欢一种更“无政府主义”的方法，其中几种方法都是有效的（不仅在方法 #1 与方法 #2 线程中，而且例如当开发人员团队为编码风格而争吵时）。

# c# - Server.UrlEncode & Server.UrlDecode

> ID：10654057
> 
> 赞同：2
> 
> 时间：2012-05-18T14:00:09.407
> 
> 标签：c#, asp.net

我不知道，我们为什么要使用`Server.UrlEncode()`& `Server.UrlDecode()`？！在 QueryString 中，我们在 URL 中看到任何内容，那么我们为什么要对它们进行编码或解码呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T14:08:27.693

> URLEncode 方法将 URL 编码规则（包括转义字符）应用于指定的字符串。
> 
> URLEncode 转换字符如下：
> 
> 空格 ( ) 转换为加号 (+)。
> 
> 非字母数字字符转义为十六进制表示。

另外，我认为您正在谈论`HttpServerUtility.UrlDecode`解码编码字符串并返回原始字符串的方法。

> URL 解码字符串并返回解码后的字符串
> 
> URL 编码确保所有浏览器都能正确传输 URL 字符串中的文本。问号 (?)、与号 (&)、斜线 (/) 和空格等字符可能会被某些浏览器截断或损坏。因此，这些字符必须在标签或查询字符串中编码，其中字符串可以由浏览器在请求字符串中重新发送。
> 
> UrlDecode 是一种在运行时从 ASP.NET 应用程序访问 HttpUtility.UrlDecode 方法的便捷方式。在内部，UrlDecode 使用 HttpUtility.UrlDecode 来解码字符串。

更多信息 ...

[Server.URLEncode](http://msdn.microsoft.com/en-us/library/ms525738(v=vs.90).aspx)

[HttpServerUtility.UrlDecode](http://msdn.microsoft.com/en-us/library/6196h3wt.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T14:08:57.130

[它取自这里](http://msdn.microsoft.com/en-us/library/ms525738%28v=vs.90%29.aspx)

URLEncode 转换字符如下：

> ```
> Spaces ( ) are converted to plus signs (+).
> 
> Non-alphanumeric characters are escaped to their hexadecimal representation. 
> ```

```
<%Response.Write(Server.URLEncode("http://www.microsoft.com")) %> 

produces the following output:

http%3A%2F%2Fwww%2Emicrosoft%2Ecom 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T14:04:16.663

某些字符在 URL 中是不合法的，因此必须对其进行编码。[这](http://dslrphotoforum.com/index.php?topic=211.0)是我发现的第一个非法字符列表。

# ruby - 在 ruby 中获取 attr_accessor/instance 变量

> ID：10654058
> 
> 赞同：8
> 
> 时间：2012-05-18T14:00:09.690
> 
> 标签：ruby, attributes, instance-variables

所以我知道你可以通过调用来获取Ruby中的所有实例变量`#instance_variables`，但是如果它们还没有被设置，那么它们就不会出现。

**例子**

```
class Walrus
  attr_accessor :flippers, :tusks
end

w = Walrus.new
w.instance_variables # => []
w.tusks              # => nil
w.instance_variables # => [:@tusks] 
```

我想立即访问 attr_accessor 定义的所有实例变量。

```
w = Walrus.new
w.instance_variables # => [:@tusks, :@flippers] 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-18T14:04:34.523

好吧，它们还不存在。实例变量在第一次赋值时就出现了。如果您希望它们在一个全新的实例中，然后在构造函数中触摸它们。

```
class Walrus
  attr_accessor :flippers, :tusks

  def initialize
    self.flippers = self.tusks = nil
  end
end

w = Walrus.new
w.instance_variables # => [:@tusks, :@flippers] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T14:16:18.257

好吧，`attr_accessor`创建一对方法，一个 setter 和一个 getter。我不确定是否有内置方法来获取列表，但您可以查看结果对的实例方法：

```
Walrus.instance_methods.find_all do |method|
  method != :== &&
  method != :! &&
  Walrus.instance_methods.include?(:"#{method}=")
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-15T05:23:34.523

使用方法减去 Object 或 Class 中的方法怎么样？返回的数组将包含您定义的属性/方法，以及在 getter/accessor 中定义的实例变量。

```
your_instance_name.methods - Object.methods
your_instance_name.methods - Class.methods 
```

# selenium - Selenium.WebDriver - 当我尝试在 Chrome 中运行测试时出现错误

> ID：10654060
> 
> 赞同：15
> 
> 时间：2012-05-18T14:00:13.170
> 
> 标签：selenium, automated-tests, selenium-chromedriver

当我尝试在 Chrome 中运行测试时出现此错误：

> 初始化方法 AutomationUsingSelenium.SmuladorChrome.MyTestInitialize 抛出异常。OpenQA.Selenium.DriverServiceNotFoundException：OpenQA.Selenium.DriverServiceNotFoundException

原因是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-23T11:45:07.703

最后我解决了我的问题如下：

**1）**我将***chromedriver.exe***复制到**Chrome**目录[链接](http://code.google.com/p/selenium/wiki/ChromeDriver)中，但您可以将它放在任何目录中。我决定把它放在这里。

**2)**`ChromeDriver`我使用指定的//包含 ChromeDriver.exe 的目录的路径初始化了该类的一个新实例

**我的代码：**

```
IWebDriver drive = new ChromeDriver
("C:\\Documents and Settings\\...\\ApplicationData\\Google\\Chrome\\Application"); 
```

它工作得非常完美。谢谢大家。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-08-10T16:03:14.377

将`Selenium.Chrome.WebDriver`NuGet 包安装到项目中，您将不会再次收到错误。

> 在 Visual Studio 中，右键单击项目，单击 Manage NuGet Packages... ，搜索 Selenium.Chrome.WebDriver 并单击安装。

享受硒。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-05-26T12:44:23.553

让我们假设`chromedriver.exe`存在于以下路径中：`G:\Selenium_Csharp\Jar\chromedriver_win32\chromedriver.exe`

要在 Chrome 中执行测试，请将路径设置为包含的目录/文件夹， `chromedriver.exe`而不选择`chromedriver.exe`文件名。

```
driver = new ChromeDriver("G:\\Selenium_Csharp\\Jar\\chromedriver_win32");

driver.Url ="http://www.gmail.com";
driver.Manage().Window.Maximize(); 
```

或者

```
driver = new ChromeDriver(@"G:\Selenium_Csharp\\Jar\\chromedriver_win32");

driver.Url ="http://www.gmail.com";
driver.Manage().Window.Maximize(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-24T22:43:36.933

这是我看到的错误： **OpenQA.Selenium.DriverServiceNotFoundException：chromedriver.exe 文件在当前目录或 PATH 环境变量的目录中不存在。**

我通过在命令中指定“testsettings”参数来运行单元测试来解决这个问题。

例如

```
E:\Development\SampleProject\SampleProject.MvcWebApp\SampleProject.MvcWebApp.JavaScriptUnitTests\JavaScriptUnitTests\bin\Debug>"C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\mstest.exe" /testcontainer:JavaScriptUnitTests.dll /category:"JavaScriptUnitTests" /testsettings:..\..\..\Local.Testsettings /resultsfile:..\..\..\..\..\MsTestResults\SampleProject.MvcWebApp.JavaScript.Tests.trx 
```

我使用“/testsettings:......\Local.Testsettings”，因为 Local.testsettings 文件比我执行此命令的级别高 4 个级别。你应该相应地改变它。

这是 ccnet.config 文件中使用的命令

```
<exec>
    <executable>C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\mstest.exe</executable>
    <baseDirectory>SampleProject.MvcWebApp\SampleProject.MvcWebApp.JavaScriptUnitTests\JavaScriptUnitTests\bin\Debug</baseDirectory>
    <buildArgs>/testcontainer:JavaScriptUnitTests.dll /category:"JavaScriptUnitTests" /testsettings:..\..\..\Local.Testsettings /resultsfile:..\..\..\..\..\MsTestResults\SampleProject.MvcWebApp.JavaScript.Tests.trx</buildArgs>
    <successExitCodes>0</successExitCodes>
</exec> 
```

# javascript - 在网络浏览器中自动点击 swf 按钮（上传）？

> ID：10654063
> 
> 赞同：4
> 
> 时间：2012-05-18T14:00:14.807
> 
> 标签：javascript, jquery, jquery-plugins, uploadify, dom-events

我需要为控制器上传生成自动单击 swf 按钮。

问题是，在加载 html 页面时，我需要自动打开对话框文件...

可以使用 Selenium 网络驱动程序，但我不能使用 Javascript/jQuery

代码：

```
<html>
<head>
<script>
    function simulateClick() {
    var evt = document.createEvent("MouseEvents");
    evt.initMouseEvent("click", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
    var cb = document.getElementById("field-upload");
    cb.dispatchEvent(evt);
}
</script>
</head>

 <body onload="simulateClick();">

   <object type="application/x-shockwave-flash" 
     data="plugins/uploadify/uploadify.swf" id="field-upload"> 
      <param name="quality" value="high">
      <param name="wmode" value="transparent">
      <param name="allowScriptAccess" value="sameDomain">`
   </object>

 </body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T07:02:44.310

无法执行此单击。

# javascript - 谷歌日历 API Javascript 快速添加

> ID：10654064
> 
> 赞同：2
> 
> 时间：2012-05-18T14:00:20.597
> 
> 标签：javascript, html, google-api, google-calendar-api

尝试允许用户使用带有 javascript 的 Google 日历 API v3 进行身份验证和快速添加事件。我没有看到身份验证按钮。我对编码非常缺乏经验。

安慰：

```
Uncaught SyntaxError: Unexpected token } test.html:47
Uncaught TypeError: Cannot read property 'qainput' of undefined test.html:62
onload test.html:62 
```

.html 文件：

```
<html>
  <head>
    <meta charset='utf-8' />
    <style>
      #info {
        border: 0px solid black;
        padding: 0.25em;
        margin: 0.5em 0;
      }
    </style>
    <script type="text/javascript"> 
      var apiKey = 'AIzaSyDcbjOvAT85hCdVrjgUAqylf_QtxE2Gx60';
      var clientId = '202852486259.apps.googleusercontent.com';
      var scopes = 'https://www.googleapis.com/auth/calendar';
      function handleClientLoad() {
        gapi.client.setApiKey(apiKey);
        window.setTimeout(checkAuth,1);
      }

      function checkAuth() {
        gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: true}, handleAuthResult);
      }

      function handleAuthResult(authResult) {
        var authorizeButton = document.getElementById('authorize-button');
        if (authResult) {
          authorizeButton.style.visibility = 'hidden';
          makeApiCall();
        } else {
          authorizeButton.style.visibility = '';
          authorizeButton.onclick = handleAuthClick;
        }
      }

      function handleAuthClick(event) {
        gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: false}, handleAuthResult);
        return false;
      }

      function makeRpcRequest() {
        var qatext = document.qaform.qainput.value;
        var request = gapi.client.calendar.events.quick_add({
          'calendarId': 'primary',
          'text': +qatext+
        });
        request.execute(writeResponse);
      }

      function writeResponse(response) {
        console.log(response);
        var name = response.summary;
        var infoDiv = document.getElementById('info');
        var infoMsg = document.createElement('P');
        infoMsg.appendChild(document.createTextNode(+ name' sucessfully created!'));
        infoDiv.appendChild(infoMsg);
      }
    </script>
    <script src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
  </head>
  <body onload="document.qaform.qainput.focus();">
    <button id="authorize-button" style="visibility: hidden">Authorize to Use QuickAdd</button>
    <form id="qaform">
    <input placeholder='QuickAdd' name='qainput' />
    <button id="rpc" onclick="makeRpcRequest();">Add</button>
    </form>
    <div id="info"></div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T01:50:40.273

几个星期以来，您可能已经找到了答案，但我最近遇到了同样的问题，从您使用的代码基本相同。我根本没有在谷歌控制台的“服务”下激活谷歌日历。如果所有控制台设置不正确，“授权”按钮将保持隐藏状态（默认隐藏）。一旦所有设置正确并且脚本与 api 正确通信，授权按钮就会变得可见，然后您可以添加事件并通过单击按钮编写响应。

# google-app-engine - JPA（AppEngine）中的一对一关系

> ID：10654068
> 
> 赞同：0
> 
> 时间：2012-05-18T14:00:37.290
> 
> 标签：google-app-engine, jpa

在我的个人资料课程中，我有

```
@OneToOne(cascade=CascadeType.PERSIST)
private ProfilePicture profilePic = null; 
```

我更新 profilePic 的方法

```
public Profile updateUserProfilePic(Profile user) {
    EntityManager em = EMF.get().createEntityManager();
    em.getTransaction().begin();

    Profile userx = em.find(Profile.class, user.getEmailAddress());
    userx.setProfilePic( user.getProfilePic() );

    em.getTransaction().commit();
    em.close();
    return userx;
} 
```

调用 updateUserProfilePic 时，它只是在数据存储中添加另一个 profilePic，它不会替换现有的 profilePic。我的实现是否正确？我想更新配置文件的 profilePic。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T05:00:01.543

“瞬态”是指不持久、不分离。

使用该版本的 GAE JPA，如果您希望它重用现有对象，则需要一个分离或托管对象。

使用谷歌插件的 v2 有一个持久性属性，允许合并具有“id”字段集的瞬态对象。

# wcf - WCF net.tcp 通信错误

> ID：10654071
> 
> 赞同：0
> 
> 时间：2012-05-18T14:00:43.950
> 
> 标签：wcf, exception, binding, net.tcp

我使用 net.tcp 绑定创建了一个 WCF 服务，并且能够在我的控制台应用程序中添加对它的服务引用而没有错误。

完成此操作后，我尝试在我的控制台应用程序中自行托管此服务。服务主机被打开，但是当我使用服务引用对象调用服务中的方法时，我得到了这个异常

'无法连接到 net.tcp://localhost/Design_Time_Addresses/MyWCFServiceLibrary/Service2/。连接尝试持续了 00:00:02.0800000 的时间跨度。TCP 错误代码 10061：无法建立连接，因为目标机器主动拒绝它 [::1]:808。

这是我的cs文件代码

```
Main method()

 Service2Client sc2 = new Service2Client();
                Uri baseaddress = new Uri("net.tcp://localhost:8732/Design_Time_Addresses/MyWCFServiceLibrary/Service2/");

                ServiceHost serviceHost = new ServiceHost(typeof(Service2Client), baseaddress);

                serviceHost.Open();

                Console.WriteLine(sc2.GetData(124)); --> exception comes at this point

                Console.ReadLine(); 
```

这是控制台应用程序中的 app.config

```
<system.serviceModel>
    <client>
      <endpoint address="net.tcp://localhost/Design_Time_Addresses/MyWCFServiceLibrary/Service2/"
        binding="netTcpBinding" bindingConfiguration="NetTcpBinding_IService2"
        contract="ServiceReference2.IService2" name="NetTcpBinding_IService2">
        <identity>
          <dns value="localhost" />
        </identity>
      </endpoint>
    </client>
    <bindings>
      <netTcpBinding>
        <binding name="NetTcpBinding_IService2" closeTimeout="00:01:00"
          openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
          transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions"
          hostNameComparisonMode="StrongWildcard" listenBacklog="10" maxBufferPoolSize="524288"
          maxBufferSize="65536" maxConnections="10" maxReceivedMessageSize="65536">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <reliableSession ordered="true" inactivityTimeout="00:10:00"
            enabled="false" />
          <security mode="None">
            <transport clientCredentialType="Windows" protectionLevel="EncryptAndSign" />
            <message clientCredentialType="Windows" />
          </security>
        </binding>
      </netTcpBinding>
    </bindings>
    <!--<client>
      <endpoint address="net.tcp://localhost:8732/Design_Time_Addresses/MyWCFServiceLibrary/Service2/"
        binding="netTcpBinding" bindingConfiguration="NewBinding0" contract="MyWCFServiceLibrary.IService2"
        name="endpointClient" />
      <endpoint address="net.tcp://localhost/Design_Time_Addresses/MyWCFServiceLibrary/Service2/"
        binding="netTcpBinding" bindingConfiguration="NetTcpBinding_IService2"
        contract="ServiceReference2.IService2" name="NetTcpBinding_IService2">
        <identity>
          <dns value="localhost" />
        </identity>
      </endpoint>
    </client>-->
  </system.serviceModel> 
```

环境：VS2010

任何人都可以帮我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:08:03.797

有可能：

1)**防火墙**阻止了请求。一探究竟。

2) 确保

*   **Net.Tcp 侦听器适配器**；
*   **Net.Tcp 端口共享服务**

正在运行（Windows 服务）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T14:52:59.897

您的客户端配置的 URL 为

`net.tcp://localhost/Design_Time_Addresses/MyWCFServiceLibrary/Service2/`

当您的服务开启时

`net.tcp://localhost:8732/Design_Time_Addresses/MyWCFServiceLibrary/Service2/`

控制台应用程序客户端端点元素的 app.config 中缺少端口号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-15T14:21:23.190

可能有多种原因，因为其他答案可以解决问题。但就我而言，安装挂起的 Windows 更新后问题解决了。

# asp.net - ASP.net：将 HTML 和 ASP.net 页面读取为字符串？

> ID：10654073
> 
> 赞同：0
> 
> 时间：2012-05-18T14:00:52.730
> 
> 标签：asp.net, html, parsing

我正在尝试编写一个 aspx 页面，该页面将爬过一个目录并找到其中包含的所有文件。我想我已经放下了那部分。

是否可以在不首先从我正在阅读的 html 和 asp 页面创建 .txt 文件的情况下读取字符串？我不想创建大量新文件，然后最终不得不在以后删除它们。

最终，我正在尝试开发一种工具来搜索整个目录并找到所有具有空 alt 属性或没有 alt 属性的图像标签。我写了一些可以找到标签的jQuery，我还写了搜索目录的部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:12:43.800

如果您的文件系统上有一个文件，您可以简单地读取它 - 如果您知道它是一种文本格式，则需要使用具有正确编码的流来执行此操作。

由于您正在阅读和查询 HTML，我建议使用专门为此任务编写的库 - [HTML Agility Pack](http://htmlagilitypack.codeplex.com/) - 您可以为其提供 HTML 文件的路径，然后查询它以获取所有`img`元素。源代码下载附带示例项目，将向您展示如何完成此任务和其他任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:12:27.700

链接：http: [//msdn.microsoft.com/en-us/library/system.io.streamreader.aspx](http://msdn.microsoft.com/en-us/library/system.io.streamreader.aspx)

示例： [http](http://www.csharp-examples.net/load-text-file-to-string/) ://www.csharp-examples.net/load-text-file-to-string/ （此示例展示了如何使用 .txt 文件，但我相信如果您可以添加任何其他扩展名）

获取所有文件： [http ://www.csharp-examples.net/get-files-from-directory/](http://www.csharp-examples.net/get-files-from-directory/)

编辑：不要忘记编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:18:45.117

当然，为什么不保存到环境变量，不要大惊小怪，不要乱七八糟。所以尝试这样的事情：将一个 html 或 asp 文件拆开并保存到一个变量数组中，我已经向您展示了如何将它们重新组合在一起。让我知道这是否适合您

```
@echo off
setlocal EnableDelayedExpansion EnableExtensions
echo.
set count=0
if exist newfile.html del newfile.html
:: to unassemble
for /f "tokens=*" %%a in (filename.html) do (
    echo %%a
    set /a count=count + 1
    set htmllinenum!count!=%%a
)& set finalcount=!count!
:: to assemble
for /l %%a in (1,1,%finalcount%) do (
    echo !htmllinenum%%a!>>newfile.html
)
notepad newfile.tmp
    set count=0
if exist newfile.asp del newfile.asp
:: to unassemble
for /f "tokens=*" %%a in (filename.asp) do (
    echo %%a
    set /a count=count + 1
    set asplinenum!count!=%%a
)& set finalcount=!count!
:: to assemble
for /l %%a in (1,1,%finalcount%) do (
    echo !asplinenum%%a!>>newfile.asp
)
notepad newfile.asp 
```

# javascript - 两个密码字段的 JQuery 验证

> ID：10654074
> 
> 赞同：0
> 
> 时间：2012-05-18T14:00:54.060
> 
> 标签：javascript, jquery

两个输入的密码应该相同，我想在它们不匹配时显示通知。目标是在键入期间而不是在按下保存按钮后显示通知。

我是 javascript 新手，我也尝试过 functionname function() 表示法。

以下js：

```
function updateError (error) {
if (error == true) {
    $(".error").hide(500);
}else{
 $(".error").show(500);
}
};

function checkSame() {
   var passwordVal = $("input[name=password-check]").val();
   var checkVal = $("input[name=password]").val();
   if (passwordVal == checkVal) {
     return true;
   }
   return false;
};

document.ready(function(){
 $("input[name=password-check]").keyup(function(){updateError(checkSame());});
 $("input[name=password]").keyup(function(){updateError(checkSame());});
}); 
```

和 HTML：

```
 @Html.Password("password") 
 @Html.Password("password-check")     
 <span class="error">Errortext</span> </td></tr> 
```

但它不起作用..谢谢！

编辑：现在我已将 JS 代码更改为：

$("input[name=password-check]").keyup(function(){updateError(checkSame());}); $("input[name=password]").keyup(function(){updateError(checkSame());});

--> 现在它可以工作了，但只有一次，在用户输入匹配的密码后，验证停止工作

解决了，问题是引用：

```
$("input[name='password-check']").keyup(function(){updateError(checkSame());});
$("input[name='password']").keyup(function(){updateError(checkSame());}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:05:29.110

你在做相反的事情

```
if (error == true) {
    $(".error").show(500);
}else{
 $(".error").hide(500);
 } 
```

根据评论编辑：

尝试将名称放在引号内，例如

```
$("input[name='password-check']").keyup(function(){updateError(checkSame());});
$("input[name='password']").keyup(function(){updateError(checkSame());}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:09:46.087

在 checkSame 中，您可能希望使用 indexOf 检查 passwordVal 是否包含 checkVal，因为在键入时，密码还不相等。

```
 if (passwordVal.indexOf(checkVal)>-1 || checkVal.indexOf(passwordVal)>-1  ) {
     return true;
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:15:52.440

正如 int2000 所说，在 keyup 上触发 checkSame 似乎很奇怪，但如果这是你想要的，好的。尝试更改您的 checkSame 函数，如下所示：

```
function checkSame() {
   var passwordVal = $("input[name=password-check]").val();
   var checkVal = $("input[name=password]").val();
   if (passwordVal == checkVal) {
     return false;
   }
   return true;
}; 
```

请记住，您将 checkSame 的结果传递给 updateError，因此如果密码相同，则没有错误。

# visual-c++ - 在 directshow 过滤器中使用回调函数会导致内存泄漏

> ID：10654089
> 
> 赞同：4
> 
> 时间：2012-05-18T14:02:20.483
> 
> 标签：visual-c++, callback, directshow

我正在使用第三方 API，我从回调函数中获取流

```
int OnNewImage(BYTE *pData, int nLen) 
```

当我从控制台运行一个简单的 C++ 示例程序时

```
int continue = 1;

int OnNewImage(BYTE *pData, int nLen)
{
  std::cout << "On new image is called" << std::endl;
  return continue;
}

int main()
{

  // This will block
  int result = DownloadStream(/*params*/...,OnNewImage /*callbackfunction*/);

  return 0;

} 
```

我没有内存泄漏。[内存没有增加]

> 但是当我在directshow过滤器中使用这个回调函数时，它会产生内存泄漏。[内存定期增加]

什么可能导致这种情况？我该如何解决？有任何想法吗？

**更新：**我的 DirectShow 过滤器结构

**我所做的：**

基本上

*   我在“unsigned __stdcall DVRStreamThread(LPVOID pvParam)”函数中获取流，该函数回调 OnNewImage
*   然后我在回调中将帧插入我的队列[OnNewImage]
*   最后在 FillBuffer 我消耗队列中的帧。

它是 h264 流。我可以像这样设置简单的图表

> MySourceFilter ---> H264 解码器 ---> 视频渲染器

**这是我的 FilterSourceCode：**

好吧，我有一个简单的队列，我插入传入的帧然后使用： **SynchronisedQueue**

```
template <typename T>

  class SynchronisedQueue
        {
        public:

        void Enqueue(const T& data)
        {
        boost::unique_lock<boost::mutex> lock(queueMutex);
        dataQueue.push(data);
        conditionVariable.notify_one();
    } 

    T Dequeue()
    {
        boost::unique_lock<boost::mutex> lock(queueMutex);

        while (dataQueue.size()==0) 
        {
            conditionVariable.wait(lock);
        }

        T result=dataQueue.front(); dataQueue.pop();
        return result;
    } 

    int Size()
    {
        boost::unique_lock<boost::mutex> lock(queueMutex);
        int size = dataQueue.size();
        return size;
    } 

private:

    std::queue<T> dataQueue; 
    boost::mutex queueMutex; 
    boost::condition_variable conditionVariable;  

}; 
```

然后我的过滤器：

**DvrSourceFilter** [标题]

```
#define DVRSourceFilterName L"DVRDirectShowFilter"

#include <streams.h>
#include <process.h>
#include <MyDvrApi.h>
#include "SynchronisedQueue.h"

// {F89A85DA-F77C-4d44-893B-CCA43A49E7EF}
DEFINE_GUID(CLSID_DVRSourceFilter, 
0xf89a85da, 0xf77c, 0x4d44, 0x89, 0x3b, 0xcc, 0xa4, 0x3a, 0x49, 0xe7, 0xef);

class DECLSPEC_UUID("34363248-0000-0010-8000-00AA00389B71") Subtype_H264;

class DVRSourceFilter;

using namespace std;

/*
 * **********************
 * DVRPin
 * **********************
 */

class DVRPin : public CSourceStream
{
public: 

    DVRPin(HRESULT *phr, DVRSourceFilter *pFilter);
    ~DVRPin();

    // Override the version that offers exactly one media type
    HRESULT GetMediaType(CMediaType *pMediaType);
    HRESULT DecideBufferSize(IMemAllocator *pAlloc, ALLOCATOR_PROPERTIES *pRequest);
    HRESULT FillBuffer(IMediaSample *pSample);

    static int OnNewImage(void *pUser, BYTE *pData, int nLen, int nCh, int tMts, int nType, void *returnHandle);

    // Setters 
    void SetDvrIp(char* dvrIp);
    void SetDvrPort( int dvrPort);
    void SetDvrUserName( char * userName);
    void SetDvrPassword(char* password);
    void SetStartTime(int startTime);
    void SetMilliSecond(int milliSecond);
    void SetChannelNumber(int channelNumber);
    void SetSize(int width, int height);

    // Getters
    char* GetDvrIp();
    int   GetDvrPort();
    char* GetDvrUserName();
    char* GetDvrPassword();
    int   GetStartTime();
    int   GetMilliSecond();
    int   GetChannelNumber();
    int   GetMode();

public: 

    char* dvrIp;
    int dvrPort;
    char* userName;
    char* password;
    int startTime;
    int milliSecond;
    int channelNumber;

    BITMAPINFOHEADER m_bmpInfo;
    BYTE* m_RGB24Buffer;
    DWORD m_RGB24BufferSize;
    bool streamCompleted;
    int hDecHandle;

    HANDLE m_hDVRStreamThreadHandle;
    unsigned int m_dwThreadID;

    SynchronisedQueue<std::vector<BYTE>> IncomingFramesQueue;

protected: 

    virtual HRESULT OnThreadCreate();
    virtual HRESULT OnThreadDestroy();
    virtual HRESULT DoBufferProcessingLoop();

};

/*
 * **********************
 * DVRSourceFilter
 * *********************
 *
 */

class DVRSourceFilter : public CSource
{

public: 

    DECLARE_IUNKNOWN;

    static CUnknown * WINAPI CreateInstance(IUnknown *pUnk, HRESULT *phr);  
    STDMETHODIMP NonDelegatingQueryInterface(REFIID riid, void **ppv);

    void SetDVRLiveParameters(char* dvrIP, int dvrPort, char* userName, char* password, int channelNumber, int width, int height); 

private: 
    DVRSourceFilter(IUnknown *pUnk, HRESULT *phr);
    ~DVRSourceFilter();

private: 

    DVRPin *m_pPin;
}; 
```

**DvrSourceFilter** [实现]

```
#include "DvrSourceFilter.h"

unsigned __stdcall DVRStreamThread(LPVOID pvParam)
{

    DVRPin* streamReader = (DVRPin*)pvParam;

    int channelBits = 1 << (streamReader->channelNumber - 1);
    streamReader->m_RGB24BufferSize = streamReader->m_bmpInfo.biWidth * streamReader->m_bmpInfo.biHeight * 3;
    streamReader->m_RGB24Buffer = (BYTE*)malloc(streamReader->m_RGB24BufferSize);

    DownloadStream((LPCTSTR)streamReader->dvrIp,  
        streamReader->dvrPort , (LPCTSTR)streamReader->userName , 
        (LPCTSTR)streamReader->password , channelBits, channelBits,
        streamReader->startTime, streamReader->milliSecond, 
        streamReader->OnNewImage, (void*)streamReader);

    streamReader->startTime = -2; // End Of Stream

    return 0;
}

/*
 * ******************
 * DVRPin Class
 * ******************
 */

DVRPin::DVRPin(HRESULT *phr, DVRSourceFilter *pFilter)
: CSourceStream(NAME("DVR Source Bitmap"), phr, pFilter, L"Out")
{

    m_bmpInfo.biSize = sizeof(BITMAPINFOHEADER);
    m_bmpInfo.biCompression = BI_RGB;
    m_bmpInfo.biBitCount = 24;
    m_bmpInfo.biPlanes = 1;
    m_bmpInfo.biClrImportant = 0;
    m_bmpInfo.biClrUsed = 0;
    m_bmpInfo.biXPelsPerMeter = 0;
    m_bmpInfo.biYPelsPerMeter = 0;

    hDecHandle = 0;
    m_RGB24Buffer = NULL;
    m_RGB24BufferSize = 0;
    streamCompleted = false;
    startTime = -1; // Live Stream

    *phr = S_OK;
}

DVRPin::~DVRPin()
{   
}

int DVRPin::OnNewImage(void *pUser, BYTE *pData, int nLen, int nCh, int tMts, int nType, void *returnHandle)
{

    DVRPin* reader = (DVRPin*)pUser;

    if(reader->streamCompleted)
    {
        return false;
    }

    if(pData) 
    {

        std::vector<BYTE> vecFrame(pData, pData + nLen/sizeof(pData[0]));
        reader->IncomingFramesQueue.Enqueue(vecFrame);

    }

    return  !reader->streamCompleted;
}
HRESULT DVRPin::OnThreadCreate() 
{
    m_hDVRStreamThreadHandle = 
        (HANDLE)_beginthreadex(NULL, 0, &DVRStreamThread, (void*)this, 0, &m_dwThreadID);

    return S_OK;
}

HRESULT DVRPin::OnThreadDestroy() {

    streamCompleted = true;
    _endthreadex(0);

    CloseHandle(m_hDVRStreamThreadHandle);

    return S_OK;
}

HRESULT DVRPin::GetMediaType(CMediaType *pMediaType)
{

    CAutoLock cAutoLock(m_pFilter->pStateLock());

    CheckPointer(pMediaType, E_POINTER);

    VIDEOINFOHEADER* pvi = (VIDEOINFOHEADER*)pMediaType->AllocFormatBuffer(sizeof(VIDEOINFOHEADER));
    if (pvi == 0) 
        return(E_OUTOFMEMORY);

    ZeroMemory(pvi, pMediaType->cbFormat);   

    pvi->bmiHeader = m_bmpInfo;
    pvi->bmiHeader.biSizeImage = GetBitmapSize(&pvi->bmiHeader);

    SetRectEmpty(&(pvi->rcSource)); 
    SetRectEmpty(&(pvi->rcTarget)); 

    pMediaType->SetType(&MEDIATYPE_Video);
    pMediaType->SetFormatType(&FORMAT_VideoInfo);
    pMediaType->SetTemporalCompression(FALSE);

    // Work out the GUID for the subtype from the header info.
    const GUID SubTypeGUID = __uuidof(Subtype_H264);//GetBitmapSubtype(&pvi->bmiHeader);
    pMediaType->SetSubtype(&SubTypeGUID);
    pMediaType->SetSampleSize(pvi->bmiHeader.biSizeImage);

    return S_OK;
}

HRESULT DVRPin::DecideBufferSize(IMemAllocator *pAlloc, ALLOCATOR_PROPERTIES *pRequest)
{

    HRESULT hr;
    CAutoLock cAutoLock(m_pFilter->pStateLock());

    CheckPointer(pAlloc, E_POINTER);
    CheckPointer(pRequest, E_POINTER);

    VIDEOINFOHEADER *pvi = (VIDEOINFOHEADER*) m_mt.Format();

    if (pRequest->cBuffers == 0)
    {
        pRequest->cBuffers = 2;
    }
    pRequest->cbBuffer = pvi->bmiHeader.biSizeImage;

    ALLOCATOR_PROPERTIES Actual;
    hr = pAlloc->SetProperties(pRequest, &Actual);
    if (FAILED(hr)) 
    {
        return hr;
    }

    if (Actual.cbBuffer < pRequest->cbBuffer) 
    {
        return E_FAIL;
    }

    return S_OK;
}

HRESULT DVRPin::FillBuffer(IMediaSample *pSample)
{

    if(!streamCompleted) 
    {
        CAutoLock cAutoLock(m_pLock);
        HRESULT hr;

        BYTE* pData = NULL;

        hr = pSample->GetPointer(&pData);
        if(FAILED(hr))
        {
            pSample->Release();
            return hr;
        }

        if(IncomingFramesQueue.Size() <= 0) {
            return S_OK;
        }

        vector<BYTE> data = IncomingFramesQueue.Dequeue();
        int dataSize = (int)data.size();

        if(dataSize <= 0 || dataSize > 1000000) 
        {
            return S_OK;
        }

        memcpy(pData, &data[0], dataSize);

        hr = pSample->SetActualDataLength(dataSize);
        if(FAILED(hr))
        {
            pSample->Release();
            return hr;
        }

        hr = pSample->SetSyncPoint(TRUE);
        if(FAILED(hr))
        {
            pSample->Release();
            return hr;
        }

        pSample->Release();

    }
    return S_OK;
}

HRESULT DVRPin::DoBufferProcessingLoop() {

    Command com;
    REFERENCE_TIME rtNow = 0L;
    REFERENCE_TIME rtAdvise = 0L;

    OnThreadStartPlay();

    do {
        while (!streamCompleted && !CheckRequest(&com)) {
            IncomingFramesQueue.WaitUntilHaveElements();

            IMediaSample *pSample;

            HRESULT hr = GetDeliveryBuffer(&pSample,NULL,NULL,FALSE);
            if (FAILED(hr)) {
                continue;   // go round again. Perhaps the error will go away
                // or the allocator is decommited & we will be asked to
                // exit soon.
            }

            hr = FillBuffer(pSample);

            if (hr == S_OK) {
                Deliver(pSample);
            } else if (hr == S_FALSE) {
                pSample->Release();
                DeliverEndOfStream();
                return S_FALSE;
            } else {

                // Log Error
            }

            pSample->Release();
        }

        if (com == CMD_RUN || com == CMD_PAUSE)
            com = GetRequest(); // throw command away
        else if (com != CMD_STOP) 
        {

            // Log Error

        }
    } while (!streamCompleted && com != CMD_STOP);

    return S_OK;
}

void DVRPin::SetDvrIp( char* dvrIp )
{
    this->dvrIp = dvrIp;
}

void DVRPin::SetDvrPort( int dvrPort )
{
       this->dvrPort = dvrPort;
}

void DVRPin::SetDvrUserName( char * userName )
{
       this->userName = userName;
}

void DVRPin::SetDvrPassword( char* password )
{
        this->password = password;
}

void DVRPin::SetStartTime( int startTime )
{
    this->startTime = startTime;
}

void DVRPin::SetMilliSecond( int milliSecond )
{
    this->milliSecond = milliSecond;
}

void DVRPin::SetSize(int width, int height) {
    m_bmpInfo.biWidth = width;
    m_bmpInfo.biHeight = height;
    m_bmpInfo.biSizeImage = GetBitmapSize(&m_bmpInfo);
}

char* DVRPin::GetDvrIp()
{
    return dvrIp;
}

int DVRPin::GetDvrPort()
{
    return dvrPort;
}

char* DVRPin::GetDvrUserName()
{
    return userName;

}

char* DVRPin::GetDvrPassword()
{
    return password;
}

int DVRPin::GetStartTime()
{
    return startTime;
}

int DVRPin::GetMilliSecond()
{
    return milliSecond;
}

void DVRPin::SetChannelNumber( int channelNumber )
{
    this->channelNumber = channelNumber;
}

int DVRPin::GetChannelNumber()
{
    return channelNumber;
}

/*
 * ****************************
 * DVRSourceFilter Class
 * ***************************
 */

DVRSourceFilter::DVRSourceFilter(IUnknown *pUnk, HRESULT *phr)
: CSource(NAME("DVRSourceBitmap"), pUnk, CLSID_DVRSourceFilter)
{

    // The pin magically adds itself to our pin array.
    m_pPin = new DVRPin(phr, this);

    // Just for test at graph studio
    SetDVRLiveParameters("192.168.3.151", 7000, "admin", "000000", 3, 352, 288);

    if (phr)
    {
        if (m_pPin == NULL)
            *phr = E_OUTOFMEMORY;
        else
            *phr = S_OK;
    }
}

DVRSourceFilter::~DVRSourceFilter()
{
    delete m_pPin;
}

CUnknown * WINAPI DVRSourceFilter::CreateInstance(IUnknown *pUnk, HRESULT *phr)
{
    DVRSourceFilter *pNewFilter = new DVRSourceFilter(pUnk, phr);

    if (phr)
    {
        if (pNewFilter == NULL) 
            *phr = E_OUTOFMEMORY;
        else
            *phr = S_OK;
    }

    return pNewFilter;
}

STDMETHODIMP DVRSourceFilter::NonDelegatingQueryInterface( REFIID riid, void **ppv )
{
    return CSource::NonDelegatingQueryInterface(riid, ppv);
}

void DVRSourceFilter::SetDVRLiveParameters( char* dvrIP, int dvrPort, char* userName, char* password, int channelNumber, int width, int height )
{
    m_pPin->SetDvrIp(dvrIP);
    m_pPin->SetDvrPort(dvrPort);
    m_pPin->SetDvrUserName(userName);
    m_pPin->SetDvrPassword(password);
    m_pPin->SetChannelNumber(channelNumber);
    m_pPin->SetStartTime(-1);// Live Stream
    m_pPin->SetMilliSecond(0);
    m_pPin->SetSize(width, height); 
} 
```

...

为了让directshow Filter简单[了解内存泄漏源]，只需将OnNewImage函数和FillBufferFunction实现为“dummy”，但仍然存在内存泄漏：

```
int DVRPin::OnNewImage(void *pUser, BYTE *pData, int nLen, int nCh, int tMts, int nType, void *returnHandle)
{

    return 1; // for not to end call back
}

HRESULT DVRPin::FillBuffer(IMediaSample *pSample)
{
     pSample->Release();
     return S_OK;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:46:52.547

在 DVRStreamThread 中，您有：

```
streamReader->m_RGB24Buffer = (BYTE*)malloc(streamReader->m_RGB24BufferSize); 
```

但我没有看到任何匹配的呼叫`free()`。当您的 DVRPin 对象被删除时，您必须显式释放其 m_RGB24Buffer 成员指向的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:22:44.747

我看到的第一件事是你的析构函数不是虚拟的。当使用继承时未发生释放时，这可能是导致泄漏的原因。请参阅有关虚拟析构函数必要性的[相关文章。](https://stackoverflow.com/questions/3336499/virtual-desctructor-on-pure-abstract-base-class)

# shell - 需要查看哪些文件在 24 小时内发生了变化并发送电子邮件（Shell 脚本）

> ID：10654091
> 
> 赞同：1
> 
> 时间：2012-05-18T14:02:23.323
> 
> 标签：shell, ssh

我需要一个可以安排为 Cron 作业的 shell 脚本。它将指向一个目录并递归地检查每个 PHP 文件以查看它在过去 24 小时内是否发生了变化，并将其写入日志文件并每晚通过电子邮件将日志文件发送给我们。

因此脚本将执行以下操作：

1.  递归扫描目录以查找 24 小时内更改的所有 php 文件 (home/user/httpdocs)
2.  将它们记录到文件中 (/tmp/diff-2012-05-18.log)
3.  通过电子邮件将日志文件发送到电子邮件地址 -

在我们将其自动化之前，它应该很容易测试。

关于如何以有效方式执行此操作的任何想法，我都有一种方法可以完成其中的一些，但它对服务器征税。-

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:05:01.527

对于修改后的文件部分：

```
find /path/to/dir -iname '*php' -mtime -1 > /tmp/diff-$(date +%Y-%m-%d).log 
```

然后：

```
mail user@example.com < /tmp/diff-$(date +%Y-%m-%d).log 
```

理想的做法是首先创建一个`$OUTPUT`具有正确日期的变量，以防第一个命令花费太长时间并在第二天完成。所以，把它们放在一起：

```
OUTPUT=/tmp/diff-$(date +%Y-%m-%d).log
find /path/to/dir -iname '*php' -mtime -1 > $OUTPUT
mail user@example.com < $OUTPUT 
```

或者，如果您想要更复杂一点并且瞄准一个班轮，您可以使用`tee`将列表保存到文件并同时邮寄（有点）：

```
find /path/to/dir -iname '*php' -mtime -1 | tee /tmp/diff-$(date +%Y-%m-%d).log | mail user@example.com 
```

# javascript - 通配符 - 许多 javascripts？

> ID：10654094
> 
> 赞同：0
> 
> 时间：2012-05-18T14:02:37.307
> 
> 标签：javascript, playframework, greenscript

有没有办法在greenscript中从一个目录加载所有javascript？还是整个结构？

例如

```
#{greenscript.js 'models/*', output: 'all'/} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:39:25.933

目前（Greenscript 1.2.8b）不可能，我不确定这样做是否是一个好习惯。

# javascript - 在 Popcorn.js 中更改提示开始时间？

> ID：10654095
> 
> 赞同：3
> 
> 时间：2012-05-18T14:02:48.820
> 
> 标签：javascript, html5-video, popcornjs

我需要使用 Popcorn.js 更改视频中的提示点。有没有办法通过 Cue() 方法编辑已经发送给爆米花播放器的 Cue 事件的时间？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T16:30:39.053

```
var events = Popcorn.getTrackEvents();
for (var e in events) {
  Popcorn.removeTrackEvent(events[e]._id);
}
Popcorn.cue(newTime, newFunction); 
```

它不完全是编辑事件，但它对我来说很好 - 我需要替换所有内容然后再次播放视频。

还有 getTrackEvent(obj, id) 和 getLastTrackEventId(obj) - 你可以分别处理每个事件（我没有测试过）。

看起来它将在[新版本 1.3中实现](https://webmademovies.lighthouseapp.com/projects/63272/tickets/1084-modify-cue-after-its-been-set)

# .net - 这种情况下需要STA消息循环吗？

> ID：10654098
> 
> 赞同：2
> 
> 时间：2012-05-18T14:02:56.167
> 
> 标签：.net, multithreading, com, sta

我有一些在 .NET 应用程序的线程上创建和运行的 COM 对象。线程被标记为单线程公寓，一切似乎都在工作。我的理解是，如果这些线程尝试从主线程访问 COM 对象，那么这些对象将在 .NET 中自动为我编组和序列化，因此即使在这种情况下，事情也会为我处理，一切安全整洁，尽管可能有点慢。

我的问题是，虽然事情似乎运行良好，但我**并没有**在我正在创建的 STA 线程中发送消息循环。如果可以的话，我宁愿避免消息循环，因为它会导致额外的复杂性（以及可能的效率损失）。

我已经阅读了很多关于为什么需要消息循环的建议（主要来自非常有帮助的 Hans Passant），我的理解是消息循环在线程 A 上提供了一个位置，其他线程 B 可以请求 COM 对象生活在线程 A 上可以被编组和播放。如果这是正确的，那么只要没有其他线程从线程 A 上的 COM 对象请求任何内容，线程 A 在不发送消息循环时是否安全？还是在其他情况下消息循环也可能发挥作用？

我在这里玩火吗？有没有这样的情况，你问你是不是在玩火，而你不是？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-19T00:43:52.393

STA 合约需要抽出一个消息循环。但是，是的，不抽水是有可能逃脱的。有两个主要的事情可能会出错：

*   从另一个单元（包括另一个 STA 线程或 MTA 中的线程）对接口方法进行的任何调用都不会完成。这看起来像您的程序中的死锁，调用根本不会返回。请注意，您可以很好地控制自己的调用，但您不知道 COM 组件在做什么。它很可能会启动一个线程本身。您可以使用 Debug + Windows + Threads 在调试器中看到这一点。确保您在非托管模式下运行调试器，并且您可以考虑您看到的所有线程。顺便说一句，不是特别容易。

*   许多单元线程 COM 组件依靠消息循环来满足自己的需求。它可能是一个无害的定时器，当没有循环时它不会滴答作响。或者它可能会在内部进行编组。使用 Spy++ 并检查您的新 STA 线程是否拥有任何隐藏的窗口，如果您看到一个，肯定是有问题的迹象。诊断只是行为不端的组件。不引发事件是一种常见的不幸。

当您对服务器的内部结构知之甚少时，没有什么可钉在墙上的。一定要测试一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:25:46.540

COM 调用可以在没有消息循环的情况下进行编组。

当您的 STA 线程正在等待某些东西时，它在大多数情况下会自动处理任何挂起的 COM 调用。

[Thread.Join](http://msdn.microsoft.com/en-us/library/95hbf2ta%28v=vs.90%29)的文档说`Blocks the calling thread [...] while continuing to perform standard COM and SendMessage pumping.`

以您的名义调用的许多其他函数（CoWaitForMultipleHandles 等）也会发生同样的情况，例如当您的线程正在等待 IO 时。

# plugins - 是否有任何用于以 wordpress 样式管理项目树的 MODX 插件？分页等？

> ID：10654104
> 
> 赞同：0
> 
> 时间：2012-05-18T14:03:18.570
> 
> 标签：plugins, tree, modx, extras

一些客户抱怨通过项目树管理一个包含大量博客文章的网站是多么的混乱

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T09:07:36.527

您在这里寻找的可能是Shaun McCormick的[文章。](http://modx.com/extras/package/articles/)

它旨在成为一个轻松写博客的工具，并带来一个自定义管理器页面，其中概述了它管理的所有文章，同时将它们从树中排除。它甚至还提供了从 Wordpress 博客或现有资源中导入帖子的选项。如果您不需要评论等博客功能，您可以取消设置它们。您需要 MODX 版本 >= 2.2 才能使用它。

![文章 CMP 截图](../Images/3dac4bfffe3bedc55b79f104bb6c7189.png)

# proxy - 通过代理使用 AppleScript 下载文件

> ID：10654109
> 
> 赞同：0
> 
> 时间：2012-05-18T14:03:33.993
> 
> 标签：proxy, download, applescript

我需要从 AppleScript 下载一个 .png 文件。问题是我在代理服务器后面，所以当我使用时：

1）卷曲，脚本卡住并且永远不会连接。

```
set image to "http://upload.wikimedia.org/wikipedia/commons/6/63/Wikipedia-logo.png"
set thePath to (path to desktop as Unicode text) & "test.png"

do shell script "curl -f " & image & " -o " & the POSIX path of thePath 
```

2) URL Access Script，脚本也卡住了

```
set image to "http://upload.wikimedia.org/wikipedia/commons/6/63/Wikipedia-logo.png"
set thePath to (path to desktop as Unicode text) & "test.png"

tell application "URL Access Scripting"
    download image to file thePath replacing yes
end tell 
```

我知道有一种方法可以在 curl 中指定代理服务器：

```
do shell script "curl -x " & HTTPProxy & ":" & HTTPPort & "-f " ... 
```

但我不知道 HTTProxy 和 HTTPort 的值是什么，因为我的系统使用自动代理发现。即使有这些值，我的脚本也只能在我的代理后面和其他代理后面的其他系统中工作。

因此，我想知道是否有办法告诉 curl 或 URL 访问脚本使用系统代理，或者是否有存储这些代理值的系统变量。

提前致谢

**解决了**

我通过将 HTTPProxy 和 HTTPort 设置为：

```
set HTTPProxy to (do shell script "networksetup -getwebproxy  \"Ethernet\" | grep \"Server:\" | awk -F \": \" '{print $2}'")
set HTTPPort to (do shell script "networksetup -getwebproxy  \"Ethernet\" | grep \"Port:\" | awk -F \": \" '{print $2}'") 
```

我不知道是否有更简洁的方法可以做到这一点，但这似乎可行:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T09:53:26.713

我通过将 HTTPProxy 和 HTTPort 设置为：

```
set HTTPProxy to (do shell script "networksetup -getwebproxy  \"Ethernet\" | grep \"Server:\" | awk -F \": \" '{print $2}'")
set HTTPPort to (do shell script "networksetup -getwebproxy  \"Ethernet\" | grep \"Port:\" | awk -F \": \" '{print $2}'") 
```

我不知道是否有更简洁的方法可以做到这一点，但这似乎可行:)

# javascript - 如何在页面加载事件中调用 JavaScript 函数？

> ID：10654113
> 
> 赞同：1
> 
> 时间：2012-05-18T14:03:46.190
> 
> 标签：javascript, asp.net, event-handling, tinymce

我在页面中调用 JavaScript 函数来加载事件，如下所示：

```
Page.ClientScript.RegisterStartupScript(this.GetType(), "Script12", "Disable();", true); 
```

`Disable()`功能是：

```
function Disable() {
   var ed = tinyMCE.activeEditor;
   ed.getBody().setAttribute('contenteditable', false);
} 
```

但是，当我的页面加载时，它没有按预期工作。我的代码中是否有任何明显的错误？我的`Disable()`功能是否正确实施？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:28:46.220

您可以使用 jQuery 就绪功能。只需在您的页面中包含 jQuery 库 (http://docs.jquery.com/Downloading_jQuery) 的引用并像这样调用。

```
<script src="../jquery-1.7.1.min.js"></script>
<script>
$(function() {
 Disable();
});
</script> 
```

# java - 错误：无法在 intelliJ IDE 中找到或加载主类

> ID：10654120
> 
> 赞同：212
> 
> 时间：2012-05-18T14:04:42.133
> 
> 标签：java, compiler-errors, intellij-idea

我是 Java 的初学者，我正在尝试使用 IntelliJ 运行我的代码，该 IntelliJ 我刚刚安装为带有 JDK 1.7 的 IDE。以下代码甚至无法编译并不断给我错误：

```
Error: Could not find or load main class libTest 
```

## 代码

```
import java.lang.Integer;
import java.lang.String;
import java.lang.System;
import java.util.*;

class book {

    private String name = "trial";
    private int bookCode=1;
    private int issued=0;

     public void Issue(){
         if(issued==0) {
             issued=1;
             System.out.println("You have succesfully issued the book");
         }
         else {
             System.out.println("The book is already issued. Please contact the librarian for further details");
         }
    }

    public int checkCode() {
        return bookCode;
    }

    String readName() {
        return name;
    }

    public void setName(String newName){
        name=newName;
    }

    public void setBookCode(int newCode){
        bookCode=newCode;
    }
}

class library {
    private ArrayList books=new ArrayList();

    public void getList(){
        for(int bk:books){
            String bName=books(bk).readName();
            System.out.println((bk+1)+")  "+bName);
        }
    }
}

public class libTest{
    public static void main(String[] args){
        library newLib= new library();
        System.out.println("code working");
   }
} 
```

我必须在编译器设置中进行任何更改吗？或者是代码。

* * *

## 回答 #1

> 赞同：235
> 
> 时间：2017-08-03T14:17:10.093

这可能会有所帮助：

1）“构建”菜单->“ `Rebuild Project`”。有时 Intellij 不会重写这些类，因为它们已经存在，这样您就可以要求 Intellij 重写所有内容。

2）“运行”菜单->“ `Edit configuration`”->删除配置文件->添加配置文件（如果是Java应用程序，则为“应用程序”），从“主类”下拉菜单中选择您的主类。

3)“构建”菜单->“ `Rebuild Project`”。

* * *

## 回答 #2

> 赞同：199
> 
> 时间：2017-08-28T04:42:17.373

如果上述答案都不适合您，只需关闭您的 IntelliJ IDE 并从项目的根目录中删除 IntelliJ IDE 文件和文件夹：

```
rm -rf .idea *.iml 
```

然后用 IntelliJ 打开项目。它现在必须工作。

* * *

## 回答 #3

> 赞同：87
> 
> 时间：2017-03-22T18:15:13.127

对我来说，解决方案是修复项目设置下的输出目录。在我只使用“目标”作为项目编译器输出之前。相反，我将其更新为具有完整路径，例如 D:\dev\sigplusjava2_68\target [![在此处输入图像描述](../Images/0c576319634a2e67a65efe51ffe203d2.png)](https://i.stack.imgur.com/RE8gj.png)

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2018-10-31T22:28:50.820

我遇到了这个问题，我在阳光下尝试了所有我能想到的和在这个网站上的东西。

从远程分支拉出后，我的 Java 类都没有被拾取。在项目层次结构中，所有类的名称都是红色的 J，而不是蓝色的 C。

最后，我尝试按照本教程进行操作，并尝试了一些未描述的步骤并解决了问题： [https ://www.jetbrains.com/help/idea/creating-and-managing-modules.html](https://www.jetbrains.com/help/idea/creating-and-managing-modules.html)

这是我所做的：

1.  转到文件 | 项目结构，或按 Crtl+Shift+Alt+S
2.  在项目设置部分下选择模块。
3.  在“来源”选项卡中，单击“标记为：”行上的来源。
4.  单击应用按钮。

出于某种原因，当时我所有的课程都有蓝色 C。

对 IntelliJ 和/或 IDE 如何解释这种现象有更好理解的人，但我现在只知道它可以看到所有类，更重要的是主要的类，然后运行。

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2018-06-26T07:55:53.473

使缓存无效并重新启动您的 IntelliJ，它对我有用。

[![文件菜单→无效缓存/重新启动...选项](../Images/b1b466722986d1a3c2a4adfbfb49c839.png)](https://i.stack.imgur.com/Twezi.png)

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2017-04-27T19:54:15.830

显式创建一个`out`文件夹，然后将输出路径设置为`C:\Users\USERNAME\IdeaProjects\PROJECTNAME\out`

[![像这样](../Images/f01985d2da1add60914e51e5b5b3cff2.png)](https://i.stack.imgur.com/ymJNY.png)

似乎对我`out`有用，并且期望 IntelliJ 制作文件夹不会。

* * *

还可以尝试让 IntelliJ 为您提供新的运行配置：

通过单击找到上一个

[![![编辑配置](../Images/fe5b62c5d6b043f5151d472b8627f4b8.png)](https://i.stack.imgur.com/wuxkq.png)

然后删除它

[![在此处输入图像描述](../Images/4813a9dd3d5f8e6f36de87c89629fb07.png)](https://i.stack.imgur.com/Sv89T.png)

并打好。

**现在，（重要步骤）打开包含您的主要方法的类。**这可能是通过单击左侧项目窗格中的类名最简单的方法。

给'er一个`Alt`++ `Shift`，`F10`你应该得到一个

[![这个](../Images/5614bc272ec7cb4f37d5bb2276e77de9.png)](https://i.stack.imgur.com/mlEAZ.png)

现在打`Enter`！！

*达达？？* *（成功了吗？）*

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2020-02-26T11:06:27.790

文件 > 项目结构 > 模块 > 将“src”文件夹标记为源。这应该可以解决问题。还要检查是否选择了最新语言，这样您就不必更改代码或进行任何配置更改。 [![在此处输入图像描述](../Images/8ce5e3b3912f73e883fa6d5f6d2feef0.png)](https://i.stack.imgur.com/mgrTZ.png)

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2017-05-01T18:55:28.310

我知道这是不久前被问到的，但我只是在这个问题上磕磕绊绊，并认为我的发现可能对其他人有所帮助。正如所指出的，错误消息基本上是 out 文件夹的结果。这是因为，当您尝试运行程序时，它首先编译代码，并将编译结果放到 out 位置，然后尝试从 out 位置加载编译后的代码。如果编译后的代码不在预期的位置，您将收到错误消息。

我特别想分享的一点是，有时，即使您的运行配置在配置面板的“启动前”部分中指定了“构建”，代码也不会被编译（构建）。

这什么时候会发生？可能导致这种情况发生的一种情况是，如果您正在使用模块并且您手动删除了模块输出目录。例如，如果我有一个名为“foo”的模块，那么在 out/production 下应该有一个名为 foo 的目录。如果手动删除它，构建系统可能不知道它需要重新构建。

更糟糕的是，如果您选择 Build | 构建模块'foo'，它仍然可能无法重建模块。如果是这种情况，您应该在模块中选择一个文件，例如“bar.java”，然后选择 Build | 重新编译'bar.java'。现在应该恢复 out 目录 out/production/foo。

由于 IntelliJ 通常知道正在发生的任何变化，这让我感到惊讶，并花了我一点时间来弄清楚，所以我想我会分享。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2017-12-18T20:19:36.460

**检查您的类模块**：我遇到了 intellij 的这个问题：我有一个 Maven 多模块项目，问题是我运行的类在配置中不存在该模块，所以我的问题通过设置正确的模块来解决（ “编辑配置”->“使用模块类”）

这可以帮助你吗

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2018-05-27T18:58:12.303

我必须将“src”文件夹标记为“Sources”。重新启动 IntelliJ 并重建项目后，我可以运行该项目而不会出现其他问题（参见[屏幕截图](https://i.stack.imgur.com/86qrp.png)）。编辑：您可以通过文件->项目结构或按 Ctrl+Shift+Alt+S 访问“项目结构”选项卡。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2018-05-14T17:21:21.480

打开模块选项卡（按 Ctrl+Shift+Alt+S）。我在一个项目下有两个模块。删除第二个冗余模块后我已经解决了这个问题（见截图）。[![在此处输入图像描述](../Images/d40571c27cc625b081ec1099ecbd7e0b.png)](https://i.stack.imgur.com/Ru6qF.png)

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2012-05-18T14:26:54.300

当类在默认文件夹中时，即当类没有声明包时，我遇到了这样的问题。

所以我想`package org.me.mypackage;`在类的顶部使用一个包语句（例如）应该修复它。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2020-09-05T03:46:06.090

当我的 Java 类在`src/main/kotlin`. 在我把它移到 之后`src/main/java`，问题就消失了。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2021-04-22T16:39:13.100

在 IntelliJ 中创建项目后，尝试运行以下命令：

```
mvn package 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2019-03-08T21:16:58.140

我已经尝试了这里建议的所有黑客 - 无济于事。最后，我简单地创建了一个新的 Maven 应用程序并手动将 pom.xml 和 java 文件和资源一一复制到其中。现在一切正常。我是 IntelliJ 的新手，完全不为所动，但让它进入不稳定状态是多么容易。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-06-20T01:41:46.513

就我而言，问题似乎与升级 IntelliJ 有关。当我这样做时，我用新 IntelliJ（2017 社区到 2018 社区）的文件覆盖了旧 IntelliJ 中的文件。在那之后，我所有的项目都被打破了。我尝试了这个线程中的所有内容，但没有一个有效。我尝试将 gradle 升级到最新版本（4 到 4.8），但没有成功。唯一对我有用的是删除整个 IntelliJ 文件夹并重新安装它。在那之后，我所有的项目都工作了。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-05-29T16:01:37.750

我从其他地方继承了一堆 .JAVA 文件，但不知道如何让它们在任何 IDE 中工作。最终，我不得不转到 Main.JAVA 文件所在的命令行并运行`javac Main.java`. 这创建了一堆 .CLASS 文件。然后，IDE 能够弄清楚要做什么。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-12-11T17:43:34.810

我已经尝试了这里答案中建议的几乎所有内容，但对我没有任何帮助。

在尝试运行我的应用程序一小时后，我注意到我的项目路径包含非 ASCII 字符（阿拉伯字符）。在我将项目移动到没有非 ASCII 字符的路径后，它执行得很好。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-06-27T07:46:02.397

**使用Scala/SBT**时出现此错误。即使一切设置正确，IntelliJ 也找不到主类。我的解决方案：删除`<user>/.sbt/<version>/plugins/target`文件夹，然后重新启动 IntelliJ。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-01-17T15:53:58.480

您可以在此处检查的另一件事是传递给 JVM 的实际命令，并确保它看起来正常。滚动到运行控制台的顶部，它应该是第一行。

**运行配置 VM 选项字段**中的空格会使应用程序启动命令不正确，并可能**导致此错误消息**

```
-DsomeArgument="arg with space must be quoted" 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2019-03-15T08:10:11.140

[![在此处输入图像描述](../Images/eddb3dad10c34420151ae57bebb87b8d.png)](https://i.stack.imgur.com/eBPH7.png)

modules.xml 内容错误，我不知道我的 IDEA 有什么问题。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2020-03-27T12:21:39.660

我将 IntelliJ 与 Spring 一起使用，我的主类包装在一个 JAR 中。我必须在“运行/调试”配置对话框中标记“包含具有“已提供”范围的依赖项”

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2019-03-08T17:46:43.127

将该目录标记为源目录。通过 Ctrl+Shift+Alt+S 打开

[![在此处输入图像描述](../Images/0169b186e1b1e993515b0dfabd46e620.png)](https://i.stack.imgur.com/Y4mw1.png)

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2019-01-07T17:58:39.270

对我来说 - 我尝试了上面的几个选项，但没有奏效。然后我刚刚重命名了我的 Application 类，这可能迫使 intelliJ 构建一个新的 jar 并且错误消息开始改变。然后我将它重命名回来并且它起作用了。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2020-12-22T17:08:23.867

我正在使用 Kotlin，但我猜测问题是一样的。我会启动一个项目，创建一个文件并将 main 添加到其中，但 IDE 找不到 main。

我尝试了这个列表中的东西，但都没有奏效。我终于在 IntelliJ 的一个页面上提到了我的挫败感，并得到了联系。当然，它适用于 IntelliJ。来回几天后，我注意到突出显示功能不起作用并提到了这一点。结果发现IDE设置有问题。我仍然不知道具体出了什么问题，但我的解决方法是重置 IDE 设置。文件->管理 IDE 设置->恢复默认设置。

在这之后，
感谢 JetBrain 的 Konstantin 对他的耐心支持。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2020-04-29T09:41:05.023

我们在文件/项目结构中。答案可能是：

**指示为“内容根”的文件夹需要代码所在的子文件夹。** 加上找到将代码标记为排除和不标记的按钮。不要与状态为已排除的复选框混淆，而无需说明处于哪个阶段和什么** 是编译器排除还是运行时排除？你注定要测试和抽签。所以没有那个复选框，只有图标和颜色。

作为一个想法，我们需要破解它最初被认为是如何工作的。他们从一开始就没有让它发挥作用，而是开始以过早的编码风格添加东西。已经这么多年了，你不能指望任何改进。但作为治疗方法，我们可以找出一些方法来让它每次都正确。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2021-07-23T13:05:17.100

无效缓存不起作用。

我用虚拟更改编辑了主类 java 文件并运行它。有效。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2019-12-11T16:45:03.947

您可能指定了错误的包，并且包层次结构不正确。往下看

[![在此处输入图像描述](../Images/483d9afa6682621c994ead0239f7770f.png)](https://i.stack.imgur.com/SDcSo.png)

在这种情况下，ide 会突出显示错误的路径。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2019-10-23T10:11:47.537

简单的解决方案是转到命令行中的备份文件夹，即项目的根文件夹。你应该在你的机器上安装了 SBT。

如果你已经安装了 sbt，请运行命令“sbt package”，如果成功，这将重新编译项目，回到 intelliJ 它将工作。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2021-11-21T20:08:03.573

当我转到“编辑配置”->“修改选项”并检查“运行前不构建”选项时遇到了问题，因为我使用 IntelliJ 来解决简短的编程问题，并且我不希望它每次都运行构建时间。

相反，我所做的是分配一个运行构建过程的快捷方式（仅在创建类后第一次），它修复了错误，然后是另一个方便的快捷方式“运行上下文配置”，它成功地运行 main 方法班级目前是重点。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2020-09-03T16:04:11.280

我遇到了同样的问题并通过以下方式解决了它：

*   关闭所有 IDEA 窗口
*   删除`C:/Userz/xx/.IdeaIC2019.3`文件夹
*   重新打开 IDEA

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2019-11-11T02:58:38.207

就我而言，当代码最初位于项目下的 /src 目录下时，应用程序运行良好。后来我在/src之后添加了/main/java目录，然后“找不到或加载主类...”错误发生了。那时您无法将 /src/main/java/YourMain.java 添加到运行配置中。我所做的是删除运行配置，然后右键单击项目->打开模块设置（或单击项目面板后按 F4）->项目设置->模块删除（x）旧内容根和+添加内容根，选择 /src/main/java。重建项目并运行。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2017-10-26T23:48:22.903

详细阐述 Brad Turek 的解决方案... 默认的 IntelliJ Java 项目模板之一需要一个名为 Main 的文件，该文件定义*类 Main*和*main()*方法入口点。如果该方法包含在另一个文件（和类）中，请更改**运行**配置：

[运行配置窗口](https://i.stack.imgur.com/a7R2t.jpg)

1.  在 IntelliJ 中打开项目后，使用**Run:Edit Configurations...** 菜单打开构建配置窗口。
2.  如果**Main 类**的条目未列出包含公开 *main()*条目方法的类的文件的名称，请输入正确的文件名。（图片中的配置有误，所以配置面板里是红色的。）
3.  我的*main()*入口方法在类（和文件）*ScrabbleTest*中。因此，将**Main class:**更改为*ScrabbleTest*可以修复运行时错误。

正如其他人所指出的，您必须使用新配置重新**构建。**我正在使用一个包，但这似乎对 IME 没有影响。希望这可以帮助。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2020-03-06T06:43:02.843

尝试检查您的项目名称和完整的目录名称，看看是否包含任何“**非英语**”单词（如**亚洲单词**），有时这可能是错误的。重命名项目名称或项目路径包含此类单词并重新打开它可能会起作用。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2021-09-12T15:24:20.243

1.  创建项目时选择 maven 作为类型（不要选中 create from archetype 复选框）
2.  在项目资源管理器中，右键单击 src 下 main 下的 java
3.  选择新班级
4.  用 public static void main 完成课程
5.  从运行菜单中选择运行

[![intellij 选项来创建一个新的 java 类](../Images/edb60045e340750d6d252d12896c69b8.png)](https://i.stack.imgur.com/kG0Wq.png)

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2019-01-31T09:11:56.590

如果您有正确设置的主类和模块（如果有），只需重新构建项目（CTRL + F9）并仔细检查（编辑配置）

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2022-01-29T13:31:02.973

尝试了一切，没有运气。最后，对我有用的简单解决方案（在 Mac 上）是：

*   在项目打开时，转到 finder 并将 src 目录移出项目文件夹。IntelliJ 意识到 src 不再存在，并自行更新。
*   在项目仍然打开的情况下，将 src 目录移回原位。IntelliJ 更新其项目配置，此时一切正常。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2021-09-08T18:38:19.907

请确保您的文件扩展名是“.kt”

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2020-04-16T00:32:12.380

就我而言，它有助于删除 build.gradle 行

*编译组：'com.microsoft.sqlserver'，名称：'mssql-jdbc'，版本：'8.2.0.jre11'*

不知道为什么会这样，但是添加指定库后，编译的jar就停止工作了

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2018-03-13T20:53:09.363

在我的情况下，在模块的 build.gradle 中， mainClassName 分配必须声明完全限定的类名，即。在主类的源代码文件中指定为包名。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2021-09-30T07:25:48.960

转到 File-> Invalidate Caches and Restart 。否则删除 rm -rf .idea *.iml 并重新启动 InteliJ

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2020-02-09T23:48:03.063

就我而言，它是一个 maven 项目，我重新导入了***maven***（右键单击***pom.xml***文件并单击***Reimport***），它立即工作。

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2021-05-25T18:00:44.050

如果您使用 gradle，请尝试通过命令行中的命令重建项目：

```
gradle clean build 
```

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2019-10-29T13:45:15.363

就我而言，我配置了（相对）长的 vm 参数。将这些参数（尽可能）转换为环境变量为我解决了这个问题

* * *

## 回答 #45

> 赞同：-1
> 
> 时间：2018-06-07T08:12:18.723

按着这些次序

1.  去跑步
2.  去编辑配置
3.  点击左上角绿色+登录
4.  选择您正在使用的类型，例如“应用程序”
5.  现在输入要运行的类的名称，而不是未命名的
6.  在写 Main 类的地方做同样的事情，就在它的下面。

Yippee ....您的代码将运行:)

* * *

## 回答 #46

> 赞同：-1
> 
> 时间：2020-08-05T17:14:03.833

如果具有**主**方法的类正在扩展/实现另一个类/接口，那么它将找不到主类。更改签名，它应该可以工作。

我有同样的问题尝试了几乎所有来自这个线程的答案，但没有一个有效。然后这对我有用。

# c# - 如何在不停止 Windows 窗体应用程序 C# 中的按钮的情况下连续更新文本框？

> ID：10654121
> 
> 赞同：1
> 
> 时间：2012-05-18T14:04:46.597
> 
> 标签：c#, multithreading, event-handling, multitasking

单击按钮后，我需要不断更新我的文本框，但按钮应按原样执行其剩余任务。

很简单，当点击事件执行时，文本框不应该等待点击事件完成，而是开始不断更新其文本。

示例代码

```
using System.threading;

namespace name
{
    public class sA
    {
        public void th()
        {
           textbox.invoke(new MethodInvoke(()=> textbox.AppendText("hello\n")));
        }

        private void Button1Click(object sender, EventArgs e)
        {
           thread cThread=new thread(th);
           cThread.start();

           while(true)
           {
               // do any thing
           }
        }
    }
} 
```

重要 :: 当它执行事件“Cthread.start();”时 文本框应立即开始更新文本，而单击事件的其余功能（如“while 循环”）应并行执行。

![在此处输入图像描述](../Images/bbb52b888e33e02f19bcd48a97e3efd7.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T01:57:01.673

如果这是在 Windows 窗体内.. 然后`Application.DoEvents();`在循环中的任何位置添加，例如

```
private void Button1Click(object sender, EventArgs e)
{
   thread cThread=new thread(th);
   cThread.start();
   while(true)
   {
     // do any thing   
     textbox.Invalidate();
     Application.DoEvents(); // Releases the current thread back to windows form
                          // NOTE Thread sleep different in Application.DoEvents();
                          //Application.DoEvents() is available only in System.Windows.Forms
   }
} 
```

希望这对你有所帮助，虽然迟到了.. :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T14:07:18.017

您的`while(true)`块也必须发生在另一个线程上。

现在它阻止 UI 线程执行任何更新。

方法 th() 在后台线程上运行，但在 UI 线程再次可用之前，对 Invoke 的调用无法运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T15:14:04.950

如果我正确理解了您的问题，您需要在按钮单击过程在其“while”循环内运行时不断更新 TextBox 的文本。您并没有真正指定从哪里更新文本框，但我会假设它来自“while”循环中的代码。

正如“akatakritos”所说，您在按钮单击中的 while 循环是您的应用程序停止的原因。发生这种情况是因为 while 循环阻塞了用户界面 (UI) 线程。

您应该做的是移动“while”循环中的代码以在不同的线程中运行，并使用按钮单击启动这个新线程。

这是一种方法，也许不是最好的，但它会做你需要的：

创建一个新类：

```
public class ClassWithYourCode
{
    public TextBox TextBoxToUpdate { get; set; }
    Action<string> updateTextBoxDelegate;

    public ClassWithYourCode()
    { }

    public void methodToExecute()
    {
        bool IsDone = false;
        while (!IsDone)
        {
            // write your code here. When you need to update the 
            // textbox, call the function:
            // updateTextBox("message you want to send");
            // Below you can find some example code:

            for (int i = 0; i < 10; i++)
            {
                Thread.Sleep(1000);
                updateTextBox(string.Format("Iteration number: {0}", i));
            }

            // Don't forget to set "IsDone" to "true" so you can exit the while loop!
            IsDone = true;
        }

        updateTextBox("End of method execution!");
    }

    private void updateTextBox(string MessageToShow)
    {
        if (TextBoxToUpdate.InvokeRequired)
        {
            updateTextBoxDelegate = msgToShow => updateTextBox(msgToShow);
            TextBoxToUpdate.Invoke(updateTextBoxDelegate, MessageToShow);
        }
        else
        {
            TextBoxToUpdate.Text += string.Format("{0}{1}", MessageToShow, Environment.NewLine);
        }
    }

} 
```

并且，在您的 button1_Click 方法中，您可以添加以下代码：

```
private void button1_Click(object sender, EventArgs e)
{
    ClassWithYourCode myCode = new ClassWithYourCode();
    myCode.TextBoxToUpdate = textBox1;

    Thread thread = new Thread(myCode.methodToExecute);
    thread.Start();
} 
```

现在，您的“while”循环正在一个新线程中执行，并且每当您需要更新文本框时，您都可以从 UI 线程执行此操作，因为您无法从 UI 线程以外的线程更新 Windows 窗体控件。

# c# - 如何使用键盘事件和定时器？

> ID：10654122
> 
> 赞同：0
> 
> 时间：2012-05-18T14:04:58.517
> 
> 标签：c#

我想要下一个：当你按空格键时 - label1.Text 变为“向上”，几秒钟后（从 1 到 5 随机）label1.Text 将变为“移除手”，然后 KeyUp label1.Text 将变为“向下” . 我知道如何使用KeyUp和KeyDown，但我不明白如何使用定时器？？？

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        private Timer timer = new Timer();

        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Space)
            {
                label1.Text = "Down";
                timer.Interval = 5000;//5 seconds
                timer.Tick += new EventHandler(timer1_Tick);
                timer.Start();
            }
        }

        private void Form1_KeyUp(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Space)
            {
                label1.Text = "Up";
            }
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            label1.Text = "Remove";
            timer.Stop();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:11:24.163

未经测试，但类似这样：

```
 private Timer timer = new Timer();

    private void OnKeyPress(object sender, KeyPressEventArgs e)
    {
        //check key press args for space here

        timer.Interval = 5000;//5 seconds

        timer.Elapsed += new ElapsedEventHandler(timer_Elapsed);

        timer.Start();
    }

    private void timer_Elapsed(object sender, ElapsedEventArgs e)
    {
        label1.Text = "Up";
        timer.Elapsed -= timer_Elapsed;
        timer.Stop();
    } 
```

基本上，interval 属性以毫秒为单位，这是您指定要等待多长时间的地方。然后将事件处理程序添加到 Elapsed 事件。这将在您调用 Start() 方法后经过指定的时间段后触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:45:02.647

`KeyDown`如果用户不放手，将继续触发，因此您可能需要一个变量来仅启动一次计时器。

```
private Random rnd = new Random();
private bool _SpacePressed = false;

public Form1() {
  InitializeComponent();
  this.KeyPreview = true;
  label1.Text = "Down";
  timer1.Tick += new EventHandler(timer1_Tick);    
}

void timer1_Tick(object sender, EventArgs e) {
  timer1.Stop();
  label1.Text = "Remove Hand";
}

protected override void OnKeyDown(KeyEventArgs e) {
  base.OnKeyDown(e);
  if (e.KeyCode == Keys.Space && !_SpacePressed) {
    _SpacePressed = true;
    label1.Text = "Up";
    timer1.Interval = rnd.Next(1, 5) * 1000;
    timer1.Start();
  }
}

protected override void OnKeyUp(KeyEventArgs e) {
  base.OnKeyUp(e);
  if (_SpacePressed) {
    _SpacePressed = false;
    timer1.Stop();
    label1.Text = "Down";
  }
} 
```

# c# - 从代码中选择备份集

> ID：10654128
> 
> 赞同：1
> 
> 时间：2012-05-18T14:05:20.950
> 
> 标签：c#, sql, database-restore

我正在使用 C# 代码还原 SQL 数据库。当我们使用 SQL Server Management Studio 还原备份时，我们可以选择备份集。我们可以使用代码来执行此操作吗？ ![在此处输入图像描述](../Images/7601ddaffc9feaee72879932a050fd50.png)

我使用了以下代码

```
openFileDialog1.ShowDialog();
    string databaseName = "TempDb";
    Restore sqlRestore = new Restore();

    BackupDeviceItem deviceItem = new BackupDeviceItem(openFileDialog1.FileName, DeviceType.File);
    sqlRestore.Devices.Add(deviceItem);
    sqlRestore.Database = databaseName;

    DataConnection dataConnection = new DataConnection();
    ServerConnection connection = new ServerConnection(dataConnection.DataBaseConnection);
    Server sqlServer = new Server(connection);

    Database db = sqlServer.Databases[databaseName];
    sqlRestore.Action = RestoreActionType.Database;
    String dataFileLocation = db.FileGroups[0].Files[0].FileName;
    String logFileLocation = db.LogFiles[0].FileName;
    db = sqlServer.Databases[databaseName];
    sqlServer.ConnectionContext.Disconnect();
    RelocateFile rf = new RelocateFile(databaseName, dataFileLocation);

    sqlRestore.RelocateFiles.Add(new RelocateFile(databaseName, dataFileLocation));
    sqlRestore.RelocateFiles.Add(new RelocateFile(databaseName + "_log", logFileLocation));
    sqlRestore.ReplaceDatabase = true;
    sqlRestore.Complete += new ServerMessageEventHandler(sqlRestore_Complete);
    sqlRestore.PercentCompleteNotification = 10;
    sqlRestore.PercentComplete += new PercentCompleteEventHandler(sqlRestore_PercentComplete);
    sqlRestore.SqlRestore(sqlServer);
    db = sqlServer.Databases[databaseName];
    db.SetOnline();
    sqlServer.Refresh(); 
```

使用上面的代码它只恢复第一组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:09:24.473

看一下[Use all backup sets to restore database with SMO](https://stackoverflow.com/questions/3094609/use-all-backup-sets-to-restore-database-with-smo)，看来

> 重要的字段是恢复对象上的 FileNumber。默认值为 1

您可以使用[Restore.ReadBackupHeader](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.restore.readbackupheader.aspx)方法获取备份集列表。

链接中的VB代码

```
res.Devices.AddDevice("C:\AdventureWorks2012Backup.BAK", DeviceType.File)
dt = res.ReadBackupHeader(srv)

For Each r As DataRow In dt.Rows
   For Each c As DataColumn In dt.Columns
      Console.WriteLine(c.ToString + " = " + r(c).ToString())
   Next
Next 
```

所以一旦你知道你想要哪个备份集，你就可以设置

```
sqlRestore.FileNumber = YOUR_CHOSEN_SET; 
```

# iphone - 在 Objective-C 中执行一系列 SOAP 请求的更好方法

> ID：10654129
> 
> 赞同：0
> 
> 时间：2012-05-18T14:05:24.727
> 
> 标签：iphone, objective-c, ios, soap

我使用以下 hack-job 代码执行一系列 SOAP 请求，这些请求从服务器下载数据以用于应用程序：

按下“更新”按钮时会调用此代码：

```
- (IBAction) update {
    UIAlertView *errorView;

    if([[Reachability reachabilityForInternetConnection] currentReachabilityStatus] == NotReachable) {
        errorView = [[UIAlertView alloc] 
                     initWithTitle: @"Network Error" 
                     message: @"No Network connection availible!" 
                     delegate: self 
                     cancelButtonTitle: @"OK" otherButtonTitles: nil]; 
        [errorView show];
    }
    else
    {
        [appDelegate.categories removeAllObjects];
        [appDelegate.currencies removeAllObjects];
        [appDelegate.projects removeAllObjects];

        HUD = [MBProgressHUD showHUDAddedTo:self.navigationController.view animated:YES];
        HUD.labelText = @"Downloading..";

        [self requestCategories];
    }
} 
```

下面是一个典型的请求，我使用了大约 6 个。

```
// SOAP requests
- (void) requestCategories {
    // Indeterminate mode
    categories = [[NSMutableArray alloc] init];
    xmlBlock = CATEGORY;
    NSString *soapMsg =
    [NSString stringWithFormat:
     @"<?xml version=\"1.0\" encoding=\"utf-8\"?> <soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"> <soap:Body> <Categories xmlns=\"http://tempuri.org/\"> <UID>string</UID> <Username>string</Username> <Password>string</Password> </Categories>      </soap:Body> </soap:Envelope>"
     ];
    //---print it to the Debugger Console for verification---
    NSLog(@"%@", soapMsg);
    NSURL *url = [NSURL URLWithString:
                  @"http://www.$$%$%^^^%$$££.co.uk/%$^£^£^$&£.asmx"];
    NSMutableURLRequest *req = [NSMutableURLRequest requestWithURL:url];
    //---set the headers---
    NSString *msgLength = [NSString stringWithFormat:@"%d",
                           [soapMsg length]];
    [req addValue:@"text/xml; charset=utf-8"
forHTTPHeaderField:@"Content-Type"];
    [req addValue:@"http://tempuri.org/Categories"
forHTTPHeaderField:@"SOAPAction"];
    [req addValue:msgLength forHTTPHeaderField:@"Content-Length"];
    //---set the HTTP method and body---
    [req setHTTPMethod:@"POST"];
    [req setHTTPBody: [soapMsg dataUsingEncoding:NSUTF8StringEncoding]];
    //[activityIndicator startAnimating];
    conn = [[NSURLConnection alloc] initWithRequest:req delegate:self];
    if (conn) {
        webData = [NSMutableData data];
    }

} 
```

下面是我的 NSURLConnection 委托方法（和一个解析方法）：

```
-(void) connection:(NSURLConnection *) connection
didReceiveResponse:(NSURLResponse *) response {
    [webData setLength: 0];
}

-(void) connection:(NSURLConnection *) connection
    didReceiveData:(NSData *) data {
    [webData appendData:data];
}

-(void) connection:(NSURLConnection *) connection
  didFailWithError:(NSError *) error {

}

-(void) connectionDidFinishLoading:(NSURLConnection *) connection {
    NSLog(@"DONE. Received Bytes: %d", [webData length]);
    NSString *theXML = [[NSString alloc]
                        initWithBytes: [webData mutableBytes]
                        length:[webData length]
                        encoding:NSUTF8StringEncoding];
    //---shows the XML---
    NSLog(@"%@", theXML);

    if (xmlBlock == CATEGORY){
        [self parseXML:webData];

        [self requestCurrencies];
    }
    else if (xmlBlock == CURRENCY){
        [self parseXML:webData];

        [self requestNominals];
    }
    else if (xmlBlock == NOMINAL){
        [self parseXML:webData];

        [self requestProjects];
    }
    else if (xmlBlock == PROJECT){
        [self parseXML:webData];

        [self requestRegister];
    }
    else {
        [self parseXML:webData];

        HUD.customView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"37x-Checkmark.png"]];
        HUD.labelText = @"Done!";
        HUD.mode = MBProgressHUDModeCustomView;
        [HUD hide:YES afterDelay:2];
    }

}

- (void) parseXML: (NSMutableData *)localWebData {
    xmlParser = [[NSXMLParser alloc] initWithData: localWebData];
    [xmlParser setDelegate: self];
    [xmlParser setShouldResolveExternalEntities:YES];
    [xmlParser parse];
} 
```

我认为您不需要查看我的 xml 解析委托方法（如果您确实告诉我）。我的问题是，有没有更好的方法在我的应用程序中实现此功能？就像在向用户显示某种进度指示器的同时一个接一个地执行请求一样？

谢谢，

杰克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:10:12.367

使用 NSOperation 队列，即使您的类成为 NSOperation 的子类，您在其中将请求发送到服务，并将您的方法重命名为 main。然后在父类中创建该类的属性并将所有请求添加到操作队列中。最后，为您的 nsopertion 子类的属性使用 keyobserver

# c# - 按点时显示字典键

> ID：10654132
> 
> 赞同：0
> 
> 时间：2012-05-18T14:05:34.170
> 
> 标签：c#, asp.net, linq, dictionary

我有一个包含两列“键”和“值”的表。这本词典持有`<key, value>`。

```
var dic = Context
    .Table
    .Select(mc => new { mc.str_SystemName, mc.str_Value })
    .AsEnumerable()
    .ToDictionary(k => k.str_SystemName, v => v.str_Value); 
```

在 ASP.NET 4 中，可以使用智能感知来显示字典键（我的意思是当你按下 dot 并显示属性时）。

示例： dic.key1 key2 key3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T15:07:06.380

我不相信你可以。Intellisense 将显示所有方法、属性、事件等。除非我弄错了，否则键值在运行时存储在 Dictionary 中。

如果您在编译之前知道列并希望使用智能感知来获取键名，则可以进行枚举并将其用作键值。

IE。`Dictionary myDict<ColumnEnum, Object>;`

然后使用列名进行枚举。

```
Enum ColumnEnum ={id, name, address, etc}; 
```

当您键入“ColumnEnum”时，Intellisense 将显示所有列名。

# linux - 取shell中文件夹路径的最后一部分

> ID：10654135
> 
> 赞同：29
> 
> 时间：2012-05-18T14:06:03.077
> 
> 标签：linux, bash, shell

如果你输入 pwd 你会得到类似的东西：

`/home/username/Desctop/myfolder/`

最后一部分怎么接？`myfolder`路径。

这一定很简单，但我在 shell 中找不到简单的解决方案。我知道如何在 java 中解决这个问题，但在 shell 中却不知道。

谢谢

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-18T14:10:08.547

你是对的 - 这是一个快速命令：

```
basename "$PWD" 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-19T11:36:38.167

使用`basename $(pwd)`的是**两个无用且昂贵的叉子**。

```
echo "${PWD##*/}" 
```

应该在没有昂贵的分叉的情况下完全在 shell 中完成这个技巧（障碍：对于根目录，这是空字符串）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-19T11:33:02.960

在 Linux 中，有一对命令`dirname`和`basename`. `dirname`提取路径的最后部分以外的所有部分，并且`basename`只提取路径的最后部分。

在这种情况下， using`basename`将做你想做的事：

`basename $(pwd)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-18T14:09:01.867

您可以使用`basename`它，前提是最后一部分确实是目录组件（不是文件）：

```
$ basename /home/username/Desctop/myfolder/
myfolder 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T14:09:14.350

要提取路径的最后一部分，请尝试使用`basename`...

```
basename $(pwd); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-05T06:39:22.510

```
function basename {
    shopt -s extglob
    __=${1%%+(/)}
    [[ -z $__ ]] && __=/ || __=${__##*/}
}

basename "$PWD"
echo "$__" 
```

# java - 休眠事务不工作

> ID：10654138
> 
> 赞同：0
> 
> 时间：2012-05-18T14:06:09.343
> 
> 标签：java, hibernate, transactions

我有一个非常奇怪的问题。我编写了一个使用 spring+hibernate 的应用程序。我的休眠配置如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">

    <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="placeholderPrefix" value="${hospital_"/>
        <property name="location" value="hospital.properties"/>
    </bean>

    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">
        <property name="driverClass"                            value="${hospital_hibernate.driverClassName}"/>
        <property name="jdbcUrl"                                value="${hospital_hibernate.url}"/>
        <property name="user"                                   value="${hospital_hibernate.username}"/>
        <property name="password"                               value="${hospital_hibernate.password}"/>
        <!--
        <property name="acquireIncrement"                       value="20"/>
        <property name="acquireRetryAttempts"                   value="30"/>
        <property name="acquireRetryDelay"                      value="1000"/>
        <property name="autoCommitOnClose"                      value="true"/>
        <property name="checkoutTimeout"                    value="10000"/>
        <property name="debugUnreturnedConnectionStackTraces"   value="true"/>
        <property name="idleConnectionTestPeriod"               value="100"/>
        <property name="initialPoolSize"                        value="1"/>
        <property name="maxConnectionAge"                       value="1000"/>
        <property name="maxConnectionAge"                       value="1000000"/>
        <property name="maxIdleTime"                            value="200"/>
        <property name="maxIdleTimeExcessConnections"           value="3600"/>
        <property name="maxPoolSize"                            value="10"/>
        <property name="minPoolSize"                            value="1"/>
        <property name="preferredTestQuery"                     value="select 1"/>
        <property name="testConnectionOnCheckin"                value="false"/>
        <property name="unreturnedConnectionTimeout"            value="1000"/>
        -->
   </bean>

   <bean id="sessionFactory" class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
        <property name="dataSource"     ref="dataSource"/>
        <property name="schemaUpdate"   value="${hospital_schema.update}"/>
        <property name="mappingResources">
            <list>
                <value>com/saman/entity/hbms/Employee.hbm.xml</value>
                <value>com/saman/entity/hbms/Shift.hbm.xml</value>
                <value>com/saman/entity/hbms/Patient.hbm.xml</value>
            </list>
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">${hospital_hibernate.dialect}</prop>
                <prop key="hibernate.show_sql">${hospital_hibernate.showsql}</prop>
                <!--<prop key="hibernate.hbm2ddl.auto">update</prop>-->
                <prop key="hibernate.generate_statistics">true</prop>

                <!--<prop key="hibernate.cache.use_second_level_cache">true</prop>-->
                <!--<prop key="hibernate.cache.use_query_cache">true</prop>-->
                <!--<prop key="hibernate.cache.region.factory_class">net.sf.ehcache.hibernate.SingletonEhCacheRegionFactory</prop>-->
                <!--<prop key="net.sf.ehcache.configurationResourceName">ehcache.xml</prop>-->

                <prop key="hibernate.connection.provider_class">org.hibernate.connection.C3P0ConnectionProvider</prop>
                <prop key="hibernate.use_sql_comments">true</prop>

                <prop key="hibernate.transaction.auto_close_session">true</prop>

            </props>
        </property>
        <property name="eventListeners">
            <map>
                <entry key="merge">
                    <bean class="org.springframework.orm.hibernate3.support.IdTransferringMergeEventListener"/>
                </entry>
            </map>
        </property>
    </bean>

    <bean id="txManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory"/>
        <!--<property name="prepareConnection" value="true"/>-->
        <!--<property name="hibernateManagedSession" value="true"/>-->
    </bean>

</beans> 
```

我还设置了我的 tx:advice 如下：

```
<tx:advice id="txAdvice" transaction-manager="txManager">
    <tx:attributes>
        <tx:method name="get*" propagation="REQUIRED" read-only="true"/>
        <tx:method name="*" rollback-for="java.lang.Throwable"/>
    </tx:attributes>
</tx:advice>

<aop:config>
    <aop:pointcut id="transactionServiceOperation"
                  expression="execution(* com.saman.svc.dalc.IEmployeeDA.*(..))"/>
    <aop:pointcut id="transactionServiceOperation2"
                  expression="execution(* com.saman.svc.dalc.IPatientDA.*(..))" />
    <aop:pointcut id="transactionServiceOperation3"
                  expression="execution(* com.saman.svc.dalc.IShiftDA.*(..))"/>
    <aop:advisor advice-ref="txAdvice" pointcut-ref="transactionServiceOperation"/>
    <aop:advisor advice-ref="txAdvice" pointcut-ref="transactionServiceOperation2"/>
    <aop:advisor advice-ref="txAdvice" pointcut-ref="transactionServiceOperation3"/>
</aop:config> 
```

这里的问题是，当我运行我的应用程序时，对于 10 或 11 数据库访问它工作正常，但在那之后，我的应用程序似乎被锁定并且没有响应。

我真的不知道问题出在哪里。

ps 我在继承IPatientDA、IShiftD 和IEmployeeDA 的patientDA、shiftDA 和employeeDA 类中定义了我的所有DA。

我的通用DA：

```
public class GenericDA<TEntity, TId extends Serializable> extends HibernateDaoSupport implements IGenericDA<TEntity, TId>
{
    private Boolean isDateString = false;
    private Dialect mappingDialect = Dialect.mysql;

    public Boolean isDateString()
    {
        return isDateString;
    }

    public void setDateString(Boolean dateString)
    {
        isDateString = dateString == null ? false : dateString;
    }

    public Dialect getMappingDialect()
    {
        return mappingDialect;
    }

    public Dialect dialect()
    {
        return this.getMappingDialect();
    }

    public void setMappingDialect(Dialect mappingDialect)
    {
        this.mappingDialect = mappingDialect;
    }

    public Class getType()
    {
        Type tClass = null;
        Type type = this.getClass().getGenericSuperclass();
        if (type instanceof ParameterizedType)
        {
            ParameterizedType paramType = (ParameterizedType) type;
            tClass = paramType.getActualTypeArguments()[0];
        }
        return (Class) tClass;
    }

    public String getStringType()
    {
        return this.getType().getName();
    }

    public TEntity get(TId id)
    {
        return (TEntity) this.getSession().get(getType(), id);
    }

    public List<TEntity> get()
    {
        return (List<TEntity>) this.getSession().createCriteria(getType()).list();
    }

    public List<TEntity> get(long from, long size)
    {
        return this.getSession().createCriteria(getType())
                .setFirstResult((int) from)
                .setMaxResults((int) size)
                .list();
    }

    public TEntity insert(TEntity entity)
    {
        this.getSession().save(entity);
        return entity;
    }

    public TEntity update(TEntity entity)
    {
        try
        {
            this.getSession().evict(entity);
            this.getSession().update(entity);
            //this.getSession().flush();
        }
        catch (HibernateException ex)
        {
            this.getSession().evict(entity);
            this.getSession().clear();
//            this.getSession().update(entity);
            throw ex;
        }
        return entity;
    }

    public void delete(TId id)
    {
        this.getSession().delete(get(id));
    }

    public void delete(TEntity entity)
    {
        this.getSession().delete(entity);
    }

    public List<TEntity> get(int from, int size)
    {
        //noinspection unchecked
        return this.getSession().createCriteria(getType())
                .setFirstResult(from)
                .setMaxResults(size)
                .list();
    }

    public long getCount()
    {
        return (Long) this.getSession().createQuery("select count(entity.id) from " + getStringType() + " entity")
                .uniqueResult();
    }

    public Object getProperty(Long id, String property)
    {
        Criteria criteria = this.getSession().createCriteria(getType());
        criteria.add(Restrictions.eq("id", id));
        criteria.setProjection(Projections.property(property));
        criteria.setMaxResults(1);
        return criteria.uniqueResult();
    }

    public org.hibernate.Session prepareFilteredSession(Date effectiveDate)
    {
        org.hibernate.Session session = this.getSession();
        if (effectiveDate != null)
            session.enableFilter("effectiveDate").setParameter("fDate", effectiveDate);

        return session;
    }

    public void DisableFilter(org.hibernate.Session session)
    {
        session.disableFilter("effectiveDate");
    }

    public String getLikeExpression(String filter, String parameter)
    {
        String result = "LIKE";
        if (filter.startsWith("*"))
        {
            if (this.mappingDialect.equals(Dialect.oracle))
                result += " '%' ||";
            else
                result += " '%' +";
        }

        result += " :" + parameter + " ";
        if (filter.endsWith("*"))
        {
            if (this.mappingDialect.equals(Dialect.oracle))
                result += " || '%'";
            else
                result += " + '%'";
        }
        return result;
    }

    public String getLikeParameter(String parameter)
    {
        if (parameter.startsWith("*"))
            parameter = parameter.substring(1);

        if (parameter.endsWith("*"))
            parameter = parameter.substring(0, parameter.length() - 1);

        return parameter;
    }

    public Query setDateParameter(Query query, String name, Date value)
    {
        if (this.isDateString)
            return query.setString(name, String.format("%1$tY-%1$tm-%1$td %tT", value));
        else
            return query.setParameter(name, value);

    }
} 
```

例如，我的 ShiftDA 示例是：

```
public class ShiftDA extends GenericDA<ShiftEntity, Long> implements IShiftDA {

    public void updateNumberOfPatients( int numberOfPatients, Long columnID ){
        try{
            Statement st = this.getSession().connection().createStatement();
            String sql = "UPDATE shift SET CurrentNumberOfPatients='" + numberOfPatients + "' WHERE ShiftId='" + columnID.toString() + "' ";
            st.executeUpdate(sql);

        }catch( Exception e ){
            e.printStackTrace();
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:27:15.603

从这些 C3P0 设置（最小值 = 1 最大值 = 10）和您指定的 10 或 11 个请求来看，我猜测您正在耗尽连接池，因为某些东西没有释放它们。我怀疑这与 tx-manager 有关，它不知道会话的生命何时结束。

另外 - 我会使用公共 DBCP 而不是 C3P0。

你能发布 DA 对象在做什么吗？

# c# - 在提供多个集合的同时初始化通用列表？C＃

> ID：10654143
> 
> 赞同：2
> 
> 时间：2012-05-18T14:06:29.543
> 
> 标签：c#, generics, collections, generic-list

```
var a = new []{"a"};
var b = new []{"b"};
var c = new []{"c"}; 
```

是否可以声明/初始化一个通用列表，在一行中提供上面的三个集合？

```
var l = new List<string>(a); //fine for one
var l2 = new List<string>(new[] { a, b, c }.SelectMany(x => x)); //this will work but its horrible! 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T14:08:15.347

怎么样：

```
var list = a.Concat(b).Concat(c).ToList(); 
```

# 3d - 对中 3D FFT

> ID：10654145
> 
> 赞同：0
> 
> 时间：2012-05-18T14:06:35.013
> 
> 标签：3d, fft, fftw

我还有一个关于将 FFT 结果居中的问题。在这种情况下，在 FFTW 库的 3D 空间中。目前我已经实现了下图所示的概念。它显示了细分的频率空间。每个子立方体 (1-8) 代表整个空间的八分之一。目的是将低频重新定位在这个 2x2x2 立方体的中心，所有八个子立方体相遇的地方。在这个重定位步骤之后，我只需将原点移动到立方体的中心。

![居中 3D 空间 FFT 结果](../Images/287901e5f4700d651572034cf10b41e8.png)

目前它是在前向 fft 之后直接在 ifft 之前完成的，但我不确定这种方法是否正确，因为我在应用过滤器时得到了奇怪的结果。没有过滤，我得到`OUTPUT = INPUT`了预期的结果。

经过几个小时的搜索，我找不到任何以 fft 结果为中心的示例。相应的 2D 方法似乎有效。有没有一种通用的方法来处理它，因为对于低通滤波，我需要中心的低频和边缘的高频（默认情况下 fftw 没有给出）。

问候

狼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T17:53:32.543

FFTW 常见问题解答对此进行了介绍，请参阅[http://www.fftw.org/faq/section3.html#centerorigin](http://www.fftw.org/faq/section3.html#centerorigin)。您需要做的是将每个元素乘以： (-1)^(i+j+k) 其中 i、j 和 k 是元素索引。

# javascript - 一个浏览器可以在localStorage中保存多少数据

> ID：10654148
> 
> 赞同：29
> 
> 时间：2012-05-18T14:06:53.833
> 
> 标签：javascript, html

我正在使用 web sql 和 indexeddb，但作为后备我想使用 btree/localstorage。在给定的浏览器/平台上，我可以在 localStorage 中保存多少数据？

如果没有人知道有没有办法确定 javascript 对象的大小？例如 JSON.stringify 然后乘以字符数？然后我可以编写一个脚本，写入 localStorage 并读取该值是否存在，一旦出现错误或读取停止工作，这就是幻数。

我需要在（ie9、ff、safari、chrome、opera、ipad 上的 safari、androids 默认浏览器、android 上的 dolphin、android 上的 ff、android 上的opera）上对此进行测试。

如果你能帮我弄清楚如何判断 js 字符串的大小（以字节为单位），那么我将运行测试并在此处发布结果。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-05-21T17:52:24.097

感谢您的回答。为了得到准确的答案，我最终写了一个脚本。大致的结果是，您在桌面 webkit、ff 即 opera 上获得至少 5MB 的空间。IE居然让我写了1GB，没错1GB的数据。

奇怪的是，ff 在尝试写入长度为 742 个字符的字符串时崩溃了，但它会写入一个长度为 1133 个字符的字符串，并且缓存已清除，所以我不知道这是怎么回事。

![~1000 个字符对象写入不同的 localStorage[位置]](../Images/6e2e35a7bcad460f51ac08cc7be316d5.png)

![给定的 localStorage 位置可以有多大的字符串？](../Images/c70ff6c45a7fffe5638e21d4e01268aa.png)

这是一个凌乱的脚本，但如果需要，您可以自己运行测试：

```
<!DOCTYPE />
<html>
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        var alphabet = "abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ 123456789 {} +-=*/\'[]<>|&^%$#@!,?.";
        var i = 0;
        var curWord = "";
        var tot = 0;
        localStorage["sameSpot"] = null;
        $("#same").bind("click", function () {
            var write = function () {
                if (!localStorage["sameSpot"])
                    localStorage["sameSpot"] = alphabet[i++];
                else {
                    curWord = alphabet[i++] + localStorage["sameSpot"];
                    localStorage["sameSpot"] = curWord;
                }
                if (i == alphabet.length)
                    i = 0;
                tot++;
                $("#local").html(curWord);
                $("#memory").html(localStorage["sameSpot"]);
                $("p").html("The number of characters written to localStorage[\"sameSpot\"] is: " + tot);
                setTimeout(write, 1);
            };
            write();
        });

        var tot2 = 0;
        var totChars = 0;
        $("#different").bind("click", function () {
            var write = function () {
                var saveObj = {
                    alphabet: alphabet + alphabet + alphabet + alphabet + alphabet + alphabet + alphabet + alphabet + alphabet + alphabet + alphabet + alphabet,
                    date: new Date(),
                    random: Math.random()
                };
                saveObj = JSON.stringify(saveObj);
                totChars += saveObj.length;
                localStorage["t" + tot2] = saveObj;
                $("#local").html(saveObj);
                $("#memory").html(localStorage["t" + tot2]);
                tot2++;
                $("p").html("The number of unique entries made in localStorage[0++] is " + tot2 + " and the total number of characters is: " + totChars + " with an average of " + Math.floor(totChars / tot2) + " characters per record");
                setTimeout(write, 1);
            };
            write();
        });
    });
</script>
<body>
<button id="same">Write Chars To Same Spot</button>
<button id="different">Write Chars To Same Spot</button>
<br />
<p></p>

<textarea rows="50" cols="100" id="memory"></textarea>
<textarea rows="50" cols="100" id="local"></textarea>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-05-18T14:08:39.233

来自维基百科：

> 存储大小 Web 存储提供了更大的存储容量（Mozilla Firefox、[6] Google Chrome 和 Opera 中每个域 5MB，Internet Explorer[7] 中每个存储区域 10MB）与 4KB（大约 1000 倍的空间）可用于 cookie 相比.

window.localStorage （来自[http://msdn.microsoft.com/en-us/library/cc197062(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/cc197062(v=vs.85).aspx)）

> localStorage 属性为域提供持久存储区域。出于性能原因，它允许 Web 应用程序在客户端上存储近 10 MB 的用户数据，例如整个文档或用户的邮箱。

# .net - 如何指定 .NET 程序集的 MajorRevision？

> ID：10654155
> 
> 赞同：3
> 
> 时间：2012-05-18T14:07:25.323
> 
> 标签：.net, versioning

目前，我正在使用`AssemblyVersionAttribute`指定已编译程序集的程序集版本。但是，`AssemblyVersionAttribute`只允许指定 16 位版本[[1]](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyversionattribute%28v=vs.100%29.aspx)。如何指定`MajorRevision`大于零？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:42:34.050

类的`MajorRevision`和`MinorRevision`属性分别由as和属性`Version`计算（尝试在 Reflector 中打开**mscorlib ）。**`Revision``Revision >> 16``Revision & 0xffff`

 **程序集版本控制不支持长度大于 16 位的修订号。此数据存储在程序集二进制文件的 16 位部分中。换句话说，程序集版本仅支持`Version`该类功能的一个子集。您可以在十六进制编辑器中看到这一点：将版本设置为 1.0.0.65534 将在编译后的 DLL 中给出十六进制字节`0100 0000 0000 feff`。尝试在以下两个字节中插入一个值然后检查程序集不会将版本号增加到 16 位以上。**

# android - 充气另一个视图后Android更改textView

> ID：10654158
> 
> 赞同：1
> 
> 时间：2012-05-18T14:07:34.303
> 
> 标签：android, textview, layout-inflater

嗨，我正在尝试在膨胀视图中更改文本视图，但应用程序崩溃。

我要做的是用变量 HomeTeam 和 AwayTeam 中的内容填充文本视图，这些变量不为空，因为当我记录它们时，它们里面有名字。

所以我的问题是如何更改文本视图并替换其内容

这是我试过的

```
for(int t = 0; t < 1; t++){

               resultsDict = jArray.getJSONObject(t);
              String HomeTeam = resultsDict.getString("hometeam");
              String AwayTeam = resultsDict.getString("awayteam");

              Log.v("lc","hometeam" + HomeTeam);
              Log.v("lc","awayteam" + AwayTeam);

           }

           resultsView = LayoutInflater.from(getBaseContext()).inflate(R.layout.resultscell,
                     null);

           TextView homeTeam = (TextView) findViewById(R.id.HomeTeam);
           homeTeam.setText(HomeTeam); 
```

膨胀的视图

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@color/white"
    android:padding="20dp" >

    <TextView
        android:id="@+id/TextView04"
        android:layout_width="20dp"
        android:layout_height="20dp"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:text="-"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/blue" 
        android:textStyle="bold"
      />

    <TextView
        android:id="@+id/HomeScore"
        android:layout_width="20dp"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_toLeftOf="@+id/TextView04"
        android:text="0"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/blue" 
        android:textStyle="bold"
        />

    <TextView
        android:id="@+id/AwayScore"
        android:layout_width="20dp"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_toRightOf="@+id/TextView04"
        android:text="0"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/blue"
        android:textStyle="bold"
        />

    <TextView
        android:id="@+id/AwayTeam"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/AwayScore"
        android:layout_marginLeft="14dp"
        android:layout_toRightOf="@+id/AwayScore"

        android:textAppearance="?android:attr/textAppearanceSmall"
        android:textColor="@color/blue"
        android:textStyle="bold" 
        />

    <TextView
        android:id="@+id/HomeTeam"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/HomeScore"
        android:layout_alignBottom="@+id/HomeScore"
        android:layout_alignParentLeft="true"

        android:textAppearance="?android:attr/textAppearanceSmall"
        android:textColor="@color/blue"
        android:textStyle="bold" 
        />

</RelativeLayout> 
```

这是错误

```
05-18 13:55:57.552: E/AndroidRuntime(3987): java.lang.RuntimeException: Unable to start activity ComponentInfo{co.uk.myApp.MyApp/co.uk.myApp.MyApp.HomeActivity}: java.lang.NullPointerException
05-18 13:55:57.552: E/AndroidRuntime(3987):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1821)
05-18 13:55:57.552: E/AndroidRuntime(3987):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1842)
05-18 13:55:57.552: E/AndroidRuntime(3987):     at android.app.ActivityThread.access$1500(ActivityThread.java:132)
05-18 13:55:57.552: E/AndroidRuntime(3987):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1038)
05-18 13:55:57.552: E/AndroidRuntime(3987):     at android.os.Handler.dispatchMessage(Handler.java:99)
05-18 13:55:57.552: E/AndroidRuntime(3987):     at android.os.Looper.loop(Looper.java:143)
05-18 13:55:57.552: E/AndroidRuntime(3987):     at android.app.ActivityThread.main(ActivityThread.java:4263)
05-18 13:55:57.552: E/AndroidRuntime(3987):     at java.lang.reflect.Method.invokeNative(Native Method)
05-18 13:55:57.552: E/AndroidRuntime(3987):     at java.lang.reflect.Method.invoke(Method.java:507)
05-18 13:55:57.552: E/AndroidRuntime(3987):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
05-18 13:55:57.552: E/AndroidRuntime(3987):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
05-18 13:55:57.552: E/AndroidRuntime(3987):     at dalvik.system.NativeStart.main(Native Method)
05-18 13:55:57.552: E/AndroidRuntime(3987): Caused by: java.lang.NullPointerException
05-18 13:55:57.552: E/AndroidRuntime(3987):     at co.uk.myApp.MyApp.HomeActivity.onCreate(HomeActivity.java:576)
05-18 13:55:57.552: E/AndroidRuntime(3987):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1072)
05-18 13:55:57.552: E/AndroidRuntime(3987):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1785) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-18T14:10:21.430

你需要改变：

```
TextView homeTeam = (TextView) findViewById(R.id.HomeTeam); 
```

对此：

```
TextView homeTeam = (TextView) resultsView.findViewById(R.id.HomeTeam); 
```

为什么？因为*HomeTeam*在您的膨胀视图中可用。因此，您需要在查找子视图时参考您的膨胀视图/视图组

# android - Android：PhoneGap 与 Webview

> ID：10654159
> 
> 赞同：33
> 
> 时间：2012-05-18T14:07:36.503
> 
> 标签：android, cordova, webview

我一直在研究 PhoneGap，现在陷入僵局，需要一些建议。我知道PhoneGap本质上将html5、css、JS网站“转换”为“应用程序”以进行分发，这引出了我的问题：

为什么不能简单地在 Activity 中使用 webview 来做同样的事情并保持应用程序原生？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-18T14:46:23.830

PhoneGap 的优势在于它提供的 API 使您的 HTML/javascript 能够与手机交互（例如相机、加速度计、媒体等）

这些 API 在多种设备（iOS、Android、WinPhone、Blackberry 等）上都是标准的。因此，您可以编写一组 HTML/javascript 并部署到多个平台。

如果您只是创建了一个 WebView，您将没有 PhoneGap API，您需要在您感兴趣的每个平台上构建容器。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-30T20:27:22.773

好问题我也搜索过我，因为我们采用了 Phonegap 解决方案，我认为这对我们来说是错误的方式。

长话短说：如果您编写了一个具有 Web 开发人员技能的 UI，而不是需要了解本地语言并且它可以编译并准备好进行测试，那么这是非常正确的。Web 开发人员的需求更高=> 开发人员价格更便宜。

当客户想要一个**里程碑 1**的伟大创意时，它会向一些公司、自由职业者询问开发价格和时间。如果是**带有 Phonegap 的非常基本的应用程序版本，您将拥有更少的开发成本**（如果您的 Web 开发技能与平台开发技能相同，则关闭），WebView 排在第二位，最后一个是本机的。

客户对使用 Phonegap 的应用程序结果感到满意，并希望获得更多投资者，因此它将进行演示，他们要求更多功能。

**在里程碑 2**中，您将添加一些功能。有些是简单的命令行安装，你明白了，有些不是。也许你会不走运，因为你想要 2 个现有插件和一些附加功能的组合。结论将是：**你必须开发一个插件**. 此时已经是一个非常大的审讯标志了：Phonegap + Phonegap 插件或 WebView。如果您需要 5 个现有插件并且您有一些修改，那么仍然是 Phonegap。但是，如果您只需要 1 个插件，只需要您自己的，那么 Web 视图是正确的方法。还有一些情况使 Phonegap 结构无用。如果您开发 Web 文件和本机代码，Phonegap 下的版本控制系统也存在问题：有些在每次构建时都在重新生成，有些则没有。还是原生平台比较贵。现在开发了所需的功能。客户将为投资者制作演示，其中将通过此新功能看到执行速度。或者在这里他们需要优化，**里程碑3：加速。**

在优化、加速（里程碑 3）时，您将根据需要本机 GUI 来决定。毕竟现在用web开发的GUI你需要扔在栅栏边实现，也许有些部分甚至需要NDK来加速。没有办法在这里与Phonegap很好。但是您已经聘请了 Web 开发人员，或者与该公司签约。现在回到那个公司，可以制作原生代码的开发人员。他们不会从 0 开始，所以他们需要分析代码，重构，你的开发价格至少会上涨 50%，就像你从 0 开始使用 native 一样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T13:41:42.347

好问题，您仍然可以使用 webview，但您将无法访问本机功能，如铃声、相机等，但是，以这种方式完成的应用程序将被视为本机应用程序。

# c# - VBA、MS Access 和外部应用程序

> ID：10654160
> 
> 赞同：4
> 
> 时间：2012-05-18T14:07:44.083
> 
> 标签：c#, ms-access, vba

我有一个 MS Access 数据库，上面有一个按钮，可以运行我编写的工具。该工具有效。Access 数据库有效。运行该工具的 VBA 有效。

但是，从 VBA 运行该工具时会出现问题。尝试加载 XML 配置数据时它总是崩溃。我通过检查我的错误报告工具（控制面板 -> 管理工具 -> 事件查看器）对此进行了测试。我还编写了我的工具的第二个版本，其中包含硬编码的所有 XML 数据。

我想知道发生这种情况是否有已知的原因，以及是否有解决此错误的可行解决方案。硬编码我的所有配置数据并不是一个真正理想的解决方案，因为配置数据需要可修改，而无需重新编译整个项目并推出更新。

信息：

*   MS Access 2010 与 Visual Basic for Applications（使用 Shell 进行应用程序调用）
*   使用引用（IO、Linq、Xml.Linq、Data.OleDb、全球化）具有 XML 配置数据的 C# 应用程序

感谢您提供的任何帮助。

根据请求，这是我用来运行应用程序的代码：

```
Dim hProcess As Long
Dim myPath As String
dim myFile As String

myPath = Environ("ProgramFiles(x86)" & "\mytool\"
myFile = "mytool.exe"

hProcess = Shell( myPath & myFile, vbNormalFocus ) 
```

该应用程序是一个 WinForms 应用程序，它允许用户将 csv 中的列名映射到访问的字段。唯一实际的问题是它尝试加载 XML 配置数据的部分：

```
XDocument xDoc = XDocument.Load(Environment.CurrentDirectory + "\\config.xml"); 
```

同样，如果我将配置数据硬编码到应用程序本身中，那么在运行应用程序时完全没有问题。但是，如果我尝试加载 XML 配置数据，它会在事件查看器中给出一个错误事件，指出加载 XML 文件时存在未处理的异常。如果我在 VBA Shell 调用之外运行应用程序，它运行良好并且可以加载 XML 文件。它只会在尝试从 VBA Shell 加载 XML 时崩溃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:24:35.127

根据我的经验，从 MS Access 执行 .NET 代码似乎会“搞乱”一些 .NET 的“获取当前目录”方法，如果您在没有 Access 的情况下直接运行完全相同的 .NET 应用程序，这些方法都可以正常工作。

如果你想看看我在说什么，在 Visual Studio 中创建一个新的控制台应用程序并粘贴以下代码：

```
using System;
using System.IO;

namespace CurrentDirTest
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine(Environment.CurrentDirectory);
            Console.WriteLine(Directory.GetCurrentDirectory());
            Console.WriteLine(System.Threading.Thread.GetDomain().BaseDirectory);
            Console.WriteLine(AppDomain.CurrentDomain.BaseDirectory);
            Console.ReadLine();
        }
    }
} 
```

当我直接从 Visual Studio 运行它时，它会输出这个（如预期的那样）：

> C:\Dev\Code\CurrentDirTest\CurrentDirTest\bin\Debug
> C:\Dev\Code\CurrentDirTest\CurrentDirTest\bin\Debug
> C:\Dev\Code\CurrentDirTest\CurrentDirTest\bin\Debug\
> C:\Dev\Code\ CurrentDirTest\CurrentDirTest\bin\Debug\

现在将已编译的 .exe 放在您的`Program Files (x86)\mytool\`文件夹中，并尝试从 Access 中调用它，并使用您问题中的 VBA 代码。

当我在我的机器上这样做时，我得到了这个：

> C:\Users\MyUserName\Documents
> C:\Users\MyUserName\Documents
> C:\Program Files (x86)\mytool\
> C:\Program Files (x86)\mytool\

很奇怪，不是吗？从 MS Access 执行应用程序后
`Environment.CurrentDirectory`，两者都会返回我的“文档”文件夹。 我不知道为什么会发生这种情况，但确实如此。 `Directory.GetCurrentDirectory()`

**解决方案：**
如果您在您的机器上得到与我在我的机器上相同的结果，那么您的问题的解决方案很简单：只需使用`System.Threading.Thread.GetDomain().BaseDirectory`or`AppDomain.CurrentDomain.BaseDirectory`获取当前目录。

* * *

*以防万一有人在使用 COM-Interop 时遇到类似问题：当您通过 MS Access 中的 COM-Interop 执行 .NET 程序集时，问题会更加严重。
如果我没记错的话，两者都`System.Threading.Thread.GetDomain().BaseDirectory`对`AppDomain.CurrentDomain.BaseDirectory`我不起作用，因为两者都返回了`msaccess.exe`.
我不得不使用它`this.GetType().Assembly.Location`来获取 .NET 程序集的实际位置。*

# c# - 线程池是否会排队一个定时器的回调函数，有时会同时调度多个线程？

> ID：10654163
> 
> 赞同：2
> 
> 时间：2012-05-18T14:07:57.617
> 
> 标签：c#, multithreading, collections, task-parallel-library, interlocked

在下面的代码中`TimerRecalcStatisticsElapsed`应该只运行一个实例。此回调调用的工作方法按顺序运行，[一次最多运行一个线程](https://stackoverflow.com/q/10607754/328397)。

**问题第 1 部分：**

如果计时器的回调运行一个线程池线程（[而不是在单独的线程上运行回调](https://stackoverflow.com/q/10642850/328397)），那么说线程池可能会排队并推迟线程以供以后执行基于条件（达到 MaxThreads，线程池内部逻辑）是否正确?

**问题第 2 部分：**

假设一个计时器回调可以排队等待除立即执行之外的任何事情，这是否意味着任意数量的线程回调可以同时执行？

**问题第 3 部分**

假设第 2 部分为真，这是否意味着下面的代码可以同时运行多个回调？

我问的原因是因为有*数千个*此类的实例在多 CPU 服务器上运行。我还看到数据损坏与`// Do Work Here`.

*在旁边*

`// Do work here`在内部使用 System.Collections.Dictionary 并编辑 y 的值。它还为串行调用的后续函数删除了一些键。该函数缺少以前在第一次调用中存在的键 (x)。我认为这是因为最终陈述存在竞争条件`obj.cleanupdata()`

```
public class SystemTimerTest
   {

    readonly System.Timers.Timer timerRecalcStatistics;
    readonly System.Diagnostics.Stopwatch stopwatchForRecalcStatistics = new System.Diagnostics.Stopwatch();

    public SystemTimerTest(TimeSpan range, DataOverwriteAction action)
    {
        int recalculateStatisticsEveryXMillseconds = 1000;

        timerRecalcStatistics = new System.Timers.Timer(recalculateStatisticsEveryXMillseconds);
        timerRecalcStatistics.AutoReset = true;
        timerRecalcStatistics.Elapsed += new System.Timers.ElapsedEventHandler(TimerRecalcStatisticsElapsed);
        timerRecalcStatistics.Interval = recalculateStatisticsEveryXMillseconds;
        timerRecalcStatistics.Enabled = true;

        this.maxRange = range;
        this.hashRunningTotalDB = new HashRunningTotalDB(action);
        this.hashesByDate = new HashesByDate(action);
        this.dataOverwriteAction = action;
    }

    private void TimerRecalcStatisticsElapsed(object source, System.Timers.ElapsedEventArgs e)
    {
        stopwatchForRecalcStatistics.Start();
        Console.WriteLine("The TimerRecalcStatisticsElapsed event was raised at {0}", e.SignalTime.ToString("o"));

         // DO WORK HERE

        stopwatchForRecalcStatistics.Stop();
        double timeBuffer  = GetInterval(IntervalTypeEnum.NearestSecond, e.SignalTime) - stopwatchForRecalcStatistics.ElapsedMilliseconds;

        if (timeBuffer > 0)
            timerRecalcStatistics.Interval = timeBuffer;
        else
            timerRecalcStatistics.Interval = 1;

        stopwatchForRecalcStatistics.Reset();         
        timerRecalcStatistics.Enabled = true;
    }
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T14:49:08.060

ad 1) ThreadPool 是否可以推迟回调方法的执行并不重要，因为无论如何回调不能保证在另一个计时器间隔过去之前完成执行（例如，线程可以被线程调度程序挂起，或者回调可能会调用 long-运行功能）。

广告 2）这是 MSDN 关于[Timer](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)类的说法：

> 如果 SynchronizingObject 属性为 null，则在 ThreadPool 线程上引发 Elapsed 事件。如果 Elapsed 事件的处理持续时间超过 Interval，则该事件可能会在另一个 ThreadPool 线程上再次引发。在这种情况下，事件处理程序应该是可重入的。

所以答案是肯定的，回调可以同时在多个线程上执行。

广告 3) 是的。并且您应该避免在回调方法中使用共享资源（timerRecalcStatistics、stopwatchForRecalcStatistics），或者同步对这些共享资源的访问（例如使用锁），或者将适当的对象设置为 Timer 的[SynchronizingObject](http://msdn.microsoft.com/en-us/library/system.timers.timer.synchronizingobject.aspx)属性，或者将 Timer 的 AutoReset 属性设置为 false（并且在计时器回调结束时再次启用计时器）。

**更新**：我认为 Jon Skeet 的[回答](https://stackoverflow.com/a/1841389/1286670)并不能解决您的问题。同样实现你自己的SynchonizingObject 恕我直言，比必要的更复杂（但如果不知道整个问题就很难说）。我希望这个实现应该可以工作（但我没有测试过）：

```
public class MySynchronizeInvoke : ISynchronizeInvoke
{
    private object SyncObject = new Object();
    private delegate object InvokeDelegate(Delegate method, object[] args);

    public IAsyncResult BeginInvoke(Delegate method, object[] args)
    {
        ElapsedEventHandler handler = (ElapsedEventHandler)method;
        InvokeDelegate D = Invoke;
        return D.BeginInvoke(handler, args, CallbackMethod, null);
    }

    private void CallbackMethod(IAsyncResult ar)
    {
        AsyncResult result = ar as AsyncResult;
        if(result != null)
            ((InvokeDelegate)result.AsyncDelegate).EndInvoke(ar);
    }

    public object EndInvoke(IAsyncResult result)
    {
        result.AsyncWaitHandle.WaitOne();
        return null;
    }

    public object Invoke(Delegate method, object[] args)
    {
        lock(SyncObject)
        {
            ElapsedEventHandler handler = (ElapsedEventHandler)method;
            handler(args[0], (ElapsedEventArgs)args[1]);
            return null;
        }
    }

    public bool InvokeRequired
    {
        get { return true; }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T14:45:39.853

从[System.Timers.Timer 的文档中](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)：

> 如果 SynchronizingObject 属性为 null，则在 ThreadPool 线程上引发 Elapsed 事件。如果 Elapsed 事件的处理持续时间超过 Interval，则该事件可能会在另一个 ThreadPool 线程上再次引发。在这种情况下，事件处理程序应该是可重入的。

所以回答你的问题：

1.  是的，它在线程池线程上运行，并且像其他任何东西一样受到线程池填充和延迟的影响。鉴于线程池现在最多有数百个线程，这应该不是问题。如果是这样，你有更大的问题。

2.  假设您没有设置同步对象或以其他方式同步您的回调，是的，多个回调可以重叠。如果你给定时器一个同步对象，它就不会“重叠”事件。

3.  您提供的代码不会以任何方式同步它的回调，所以是的，它可以有多个重叠，同时执行回调的副本。如果您希望类的所有实例彼此同步，您应该使用类似 lock 语句的方法来同步方法，或者如果您希望类的每个单独实例只运行一个回调，则使用计时器的 SynchronizingObject在任何给定时间。

# sql - SQL 日期格式在 diff 机器上被解释为 diff

> ID：10654168
> 
> 赞同：0
> 
> 时间：2012-05-18T14:08:04.053
> 
> 标签：sql, date

User1 和 User2 正在连接到 SQL Server `Moon\SQL2k8R2`（`Valuations`数据库）。两者都执行相同的查询，`nvarchar`以下面列出的格式传递日期。早些时候 user1 正在通过`YYYY-dd-MM`，现在收到一条错误消息

> 消息 242，级别 16，状态 3，第 2 行
> 将 varchar 数据类型转换为 datetime 数据类型导致值超出范围。

```
User    Earlier             Now
User1   YYYY-dd-MM ‘2012-18-05’ YYYY-MM-dd ‘2012-05-18’
User2   Never tried     YYYY-dd-MM ‘2012-18-05’ 
```

用户 1 告诉我们，他们的机器上没有任何变化。

我已经验证了用户 1 和用户 2 设置的键盘、语言和区域设置，它们都具有英国 (dd/mm/YYYY - 18/05/2012) 设置。

我试图解释这种行为发生变化的可能原因，任何输入表示赞赏！

# java - GameLoop 线程偶尔会变慢

> ID：10654171
> 
> 赞同：0
> 
> 时间：2012-05-18T14:08:24.957
> 
> 标签：java, android, multithreading

对于我目前正在为 Android 设备编写的游戏，我有一个名为 RenderView 的类，它是一个线程，可以更新和渲染所有内容。有时，该类会记录消息“游戏线程仅更新更新方法并且不呈现任何内容”。游戏在我的 nexus 上以 30 fps 的速度运行。在整个会议期间，我多次收到该消息。有人可以告诉我如何优化课程，或者我忘记了什么或者这完全正常吗？

这是我的代码：

```
public class RenderView extends SurfaceView implements Runnable {

    public final String classTAG = this.getClass().getSimpleName();
    Game game;
    Bitmap framebuffer;
    Thread gameloop;
    SurfaceHolder holder;
    boolean running;

    int sleepTime;
    int numberOfFramesSkipped;
    long beginTime;
    long endTime;
    long lastTime;
    int differenceTime;
    int framePeriod;
    Canvas canvas;
    int frameCount;
    WSLog gameEngineLog;

    public RenderView(Game game, Bitmap framebuffer) {
        super(game);
        this.game = game;
        this.framebuffer = framebuffer;
        this.holder = getHolder();
        framePeriod = 1000/game.getFramesPerSecond();
        lastTime = System.currentTimeMillis();
        gameEngineLog = game.getGameEngineLog();
    }

    @Override
    public void run() {
        while(running == true) {
            if(holder.getSurface().isValid()) {

                beginTime = System.currentTimeMillis();
                numberOfFramesSkipped = 0;

                game.getCurrentScreen().update();
                game.getCurrentScreen().render(); // Draw out everything to the current virtual screen (the bitmap)
                game.getGraphics().renderFrameBuffer(); // Actually draw everything to the real screen (combine both bitmaps)

                canvas = holder.lockCanvas();
                if(canvas != null) { // Fix for mysterious bug ( FATAL EXCEPTION: Thread)
                    // The viewing area of our virtual screen on our real screen
                    canvas.drawBitmap(framebuffer, null, game.getWSScreen().getGameScreenextendeddst(), null);
                    holder.unlockCanvasAndPost(canvas);
                }
                else {
                    gameEngineLog.e(classTAG, "Surface has not been created or otherwise cannot be edited");
                }

                endTime = System.currentTimeMillis();;
                differenceTime = (int) (endTime - beginTime);
                sleepTime = (int) (framePeriod - differenceTime);

                if(sleepTime > 0) {
                    try {
                        Thread.sleep(sleepTime);
                    } catch (InterruptedException exception) {
                        exception.printStackTrace();
                    }
                }
                else {
                    while(sleepTime < 0 && numberOfFramesSkipped < game.getMaxFrameSkippes()) {
                        gameEngineLog.d(classTAG, "Game thread is only updating the update method and is not rendering anything");
                        try {
                            Thread.sleep(5);
                        } 
                        catch (InterruptedException exception) {
                            exception.printStackTrace();
                        }
                        game.getCurrentScreen().update();
                        sleepTime += framePeriod;
                        numberOfFramesSkipped++;
                    }
                }

             // Frame Per Second Count
                frameCount++;

                if(lastTime + 1000 < System.currentTimeMillis()) {
                    game.getGameEngineLog().d(classTAG, "REAL FPS: " + frameCount);
                    lastTime = System.currentTimeMillis();
                    frameCount = 0;
                }

            }
        }

    }

    public void resume() { 
        running = true;
        gameloop = new Thread(this);
        gameloop.start();         
    }   

    public void pause() { 
        running = false;                        
        while(running == true) {
            try {
                gameloop.join();
                running = false;
            } 
            catch (InterruptedException e) {
            }
        }
        gameloop = null;
    }

} 
```

这是 Graphics 类的代码（getGraphics() 只返回一个图形对象）：

```
public class Graphics {

    public final String classTAG = this.getClass().getSimpleName();
    Game game;
    Canvas frameBuffer;
    Canvas canvasGameScreenextended;
    Canvas canvasGameScreen; // Used for customeScreen
    Bitmap gameScreenextended;
    Bitmap gameScreen;
    Rect gameScreendst;
    Rect gameScreenextendeddst;
    WSLog gameEngineLog;

    Graphics(Game game, Bitmap framebuffer, Bitmap gameScreen) {
        this.game = game;
        // Initialize canvases to render to
        frameBuffer = new Canvas(framebuffer);
        canvasGameScreen = new Canvas(gameScreen);
        // Initialize images to be rendered to our composition
        this.gameScreen = gameScreen;
        // Set up the Log
        gameEngineLog = game.getGameEngineLog();
    }

    public void resetCanvasGameScreenextended() {
        // This method has to be called each time the screen scaling type changes
        canvasGameScreenextended = new Canvas(game.getWSScreen().getGameScreenextended());
        gameScreenextended = game.getWSScreen().getGameScreenextended();
    }

    public Canvas getCanvasGameScreenextended() {
        return canvasGameScreenextended;
    }

    public Canvas getCanvasGameScreen() {
        return canvasGameScreen;
    }

    public void renderFrameBuffer() {
        // Composition
        // First layer (bottom)
        frameBuffer.drawBitmap(gameScreen, null, game.getWSScreen().getGameScreendst(), null);
        // Second layer (top)
        frameBuffer.drawBitmap(gameScreenextended, null, game.getWSScreen().getGameScreenextendeddst(), null);
    }

    public void clearFrameBuffer() {
        canvasGameScreen.drawColor(Color.BLACK);
        //canvasGameScreenextended.drawColor(Color.BLACK);
        gameScreenextended.eraseColor(Color.TRANSPARENT); // Make top layer transparent
    }

} 
```

这是屏幕类的代码（getCurrentScreen() 方法返回一个屏幕对象）：

```
public class Screen {

    public final String classTAG = this.getClass().getSimpleName();
    protected final Game game;
    protected final Graphics graphics;

    protected Screen(Game game) {
        this.game = game;
        this.graphics = game.getGraphics();
        //game.getInput().reset();
    }

    public void update() {

    }

    public void render() {

    }

    /** Initialize all the sensory that should be used within this screen.*/

    public void resume() {

    }

    public void pause() {
        game.getInput().useAccelerometer(false);
        game.getInput().useKeyboard(false);
        game.getInput().useTouchscreen(false);
    }

    public void onDispose() {
        game.getGraphics().clearFrameBuffer();
    }

    public void setScreenResizeType(int screenResizeType) {

    } 
```

Screen 类被扩展，render() 方法被以下方法遮蔽：

```
graphics.getCanvasGameScreen().drawRect(play, red); 
```

有趣的是，当我覆盖 render() 方法并且没有在其中放置任何代码时，记录器会不断触发以下消息：“游戏线程仅更新更新方法并且不渲染任何内容”。这是什么魔法？！

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T15:55:44.633

据我从您更新的帖子中了解到，实际上没有渲染问题。相反，您的代码错误地打印了该消息。

这是因为您检查 `if(sleepTime > 0)`了 ，因此如果渲染速度非常快并且 sleepTime 为零，您会收到该消息。只需将其更改为 `if(sleepTime >= 0)`.

# amazon-ec2 - 如何将实例存储添加到现有 Windows EC2 实例？

> ID：10654174
> 
> 赞同：12
> 
> 时间：2012-05-18T14:08:28.960
> 
> 标签：amazon-ec2

我有一个 Windows 2008 EC2 实例，我在 EBS 引导驱动器上对其进行了一些自定义。

我将实例作为 m1.small（或 m1.large）启动，并且实例存储未显示为附加驱动器。

我读过 ec2-run-instances 命令中的 -b 开关允许您为临时实例存储创建映射。ec2-run-instances 命令创建一个新实例，但是，在我的例子中，该实例已经存在，因此我将它作为 ec2-start-instances 启动，它没有用于临时实例存储的 -b 开关。

有什么方法可以访问我现有的 EBS 启动实例的 m1.small 实例附带的临时实例存储？

更新：现在（2015 年 2 月）Windows 机器似乎在 Z: 驱动器中安装了临时实例存储。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T14:30:39.243

恐怕此功能对[Amazon EC2](http://aws.amazon.com/ec2/)不可用（尚不可用） ，但实际上这是一个非常好的问题 - 用于指代明确的启动时间要求的常见答案，请参见例如[ec2-modify-instance-attribute](http://docs.amazonwebservices.com/AWSEC2/latest/CommandLineReference/ApiReference-cmd-ModifyInstanceAttribute.html)：

> **笔记**
> 
> 如果您想向 Amazon EBS 支持的实例 **添加临时存储，则必须在启动实例时添加临时存储**。有关更多信息，请参阅 Amazon Elastic Compute Cloud 用户指南中的[覆盖 AMI 的块储存设备映射](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html#Using_OverridingAMIBDM)，或 Amazon Elastic Compute Cloud 用户指南中的 [添加默认实例存储](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/InstanceStorage.html#using-instance-storage)。*[强调我的]*

这在过去并不是什么大问题，但鉴于最近引入 64 位普遍性意味着垂直扩展多功能性的显着改进（请参阅[EC2 更新：新中型实例、64 位普遍性、SSH 客户端](http://aws.typepad.com/aws/2012/03/ec2-updates-new-instance-64-bit-bit-ubiquity-ssh-client.html)），这确实突然成为一个话题-您的问题反过来会产生更多问题：

*   相反的情况会发生什么，即当我启动一个具有大量临时存储的足够大的实例并随后将其缩小（并可能再次放大）时？
*   如果以某种方式保留了初始块设备映射，我们是否应该总是从一个大实例开始？（我实际上怀疑情况是否如此。）

This question can only be addressed by the AWS team I guess, so you may want to file a support request or relay the question to the [Amazon Elastic Compute Cloud forum](https://forums.aws.amazon.com/forum.jspa?forumID=30) at least.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-18T21:22:06.403

我认为您要问的（但如果我错了，请纠正我）是“如何向 EC2 实例添加额外的存储？”。

在这种情况下，答案是：

在 AWS 控制台中选择 Volumes 面板并创建所需大小的新卷，确保它与要附加到的实例位于同一可用区。然后选择该新卷，然后单击“附加” - 选择要将其附加到的实例，然后单击“确定”。

现在登录到实例，在计算机管理中选择磁盘管理插件，格式化新的未分配分区，并给它你想要的任何驱动器号。然后它将作为标准 Windows 驱动器显示在资源管理器中。

# jboss - JMS 端点上的 reconnect-forever 不适用于 xa-transactions

> ID：10654175
> 
> 赞同：1
> 
> 时间：2012-05-18T14:08:33.407
> 
> 标签：jboss, jms, mule

我正在使用独立的 Mule 3.2.1 和 JBoss 5.1。这是我的流程：

```
<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns="http://www.mulesoft.org/schema/mule/core"       xmlns:jms="http://www.mulesoft.org/schema/mule/jms" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns:core="http://www.mulesoft.org/schema/mule/core" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:jbossts="http://www.mulesoft.org/schema/mule/jbossts" xmlns:management="http://www.mulesoft.org/schema/mule/management" version="CE-3.2.1" xsi:schemaLocation="
http://www.mulesoft.org/schema/mule/jms     http://www.mulesoft.org/schema/mule/jms/current/mule-jms.xsd 
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd 
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd 
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd 
http://www.mulesoft.org/schema/mule/jbossts http://www.mulesoft.org/schema/mule/jbossts/current/mule-jbossts.xsd 
http://www.mulesoft.org/schema/mule/management http://www.mulesoft.org/schema/mule/management/current/mule-management.xsd ">
<jbossts:transaction-manager/> 
<jms:connector name="JMS" specification="1.1"  numberOfConsumers="1" jndiInitialFactory="org.jnp.interfaces.NamingContextFactory" jndiProviderUrl="jnp://localhost:1099" connectionFactoryJndiName="java:/XAConnectionFactory" maxRedelivery="10" doc:name="JMS">
        <reconnect-forever frequency="5000"/>
</jms:connector>
<flow name="flow" doc:name="flow">
    <jms:inbound-endpoint queue="test1" connector-ref="JMS" doc:name="qt1">
        <xa-transaction action="BEGIN_OR_JOIN" />
    </jms:inbound-endpoint>
    <jms:outbound-endpoint queue="test2" connector-ref="JMS" doc:name="qt2">
        <xa-transaction action="ALWAYS_JOIN"/>
    </jms:outbound-endpoint>
</flow> 
```

当我在 mule 中运行它并关闭 jboss，然后再次打开它时，我的应用程序不会重新连接到 jms。事实上，它甚至没有尝试！如果我从我的流程中删除交易（如下所示），一切都很好。

```
<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns="http://www.mulesoft.org/schema/mule/core"  xmlns:jms="http://www.mulesoft.org/schema/mule/jms"  xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns:core="http://www.mulesoft.org/schema/mule/core" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:jbossts="http://www.mulesoft.org/schema/mule/jbossts" xmlns:management="http://www.mulesoft.org/schema/mule/management" version="CE-3.2.1"  xsi:schemaLocation="
http://www.mulesoft.org/schema/mule/jms http://www.mulesoft.org/schema/mule/jms/current/mule-jms.xsd 
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd 
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd 
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd 
http://www.mulesoft.org/schema/mule/jbossts http://www.mulesoft.org/schema/mule/jbossts/current/mule-jbossts.xsd 
http://www.mulesoft.org/schema/mule/management http://www.mulesoft.org/schema/mule/management/current/mule-management.xsd ">
<jms:connector name="JMS" specification="1.1"  numberOfConsumers="1" jndiInitialFactory="org.jnp.interfaces.NamingContextFactory" jndiProviderUrl="jnp://localhost:1099" connectionFactoryJndiName="java:/XAConnectionFactory" maxRedelivery="10" doc:name="JMS">
        <reconnect-forever frequency="5000"/>
</jms:connector>
<flow name="flow" doc:name="flow">
    <jms:inbound-endpoint queue="test1" connector-ref="JMS" doc:name="qt1">
    </jms:inbound-endpoint>
    <jms:outbound-endpoint queue="test2" connector-ref="JMS" doc:name="qt2">
    </jms:outbound-endpoint>
</flow> 
```

以下是这两种情况的日志片段： [有事务](http://pastebin.com/cifU9SHj)和 [无事务](http://pastebin.com/wJmHnL8Y)。在等待两分钟重新连接后，我停止了 mule。

我的问题是：我应该怎么做才能`reconnect-forever`正常处理交易？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T11:21:29.203

我对 Jboss 和 ActiveMQ 都有同样的问题。问题似乎在[http://www.mulesoft.org/jira/browse/MULE-6028](http://www.mulesoft.org/jira/browse/MULE-6028)中得到解决。我检查了它，似乎重新连接适用于版本 3.3.0-RC3。

# c - Calloc - 内存分配

> ID：10654177
> 
> 赞同：0
> 
> 时间：2012-05-18T14:08:38.023
> 
> 标签：c, memory-management

calloc 分配是否返回连续的内存位置？如果是，如果它不可用，它会做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T14:09:21.453

> calloc 分配是否返回连续的内存位置？

是的。¹

> 如果它不可用怎么办？

返回`NULL`。

请参阅 C99 标准的第 7.20.3.1 节。

* * *

[1.就C程序而言。在虚拟内存系统中，使用的底层物理内存可能不是连续的。]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:10:05.643

是的，C 标准保证 calloc 返回的指针要么是 NULL，要么指向一块连续的内存。

# javascript - 访问远程 MySQL 数据库并使用 javascript 更新表..？

> ID：10654179
> 
> 赞同：1
> 
> 时间：2012-05-18T14:08:43.197
> 
> 标签：javascript

我在网上搜索了一个小时，我找不到一个像样的代码来使用 javascript 更新数据库。谁能给我一个参考好吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:14:02.270

你可以用 Node.js 做到这一点

这是来自 interwebz 的示例博客文章，展示了如何做到这一点：

[http://www.giantflyingsaucer.com/blog/?p=2596](http://www.giantflyingsaucer.com/blog/?p=2596)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:10:47.923

您需要某种服务器端脚本（php、perl、cgi、java 等）。看看这个：[JavaScript 来更新 MySQL？](https://stackoverflow.com/questions/7060556/javascript-to-update-mysql)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T14:18:43.987

JavaScript 本身不能为您查询任何数据库，因为它只能在浏览器上有效工作。要使用 DB，您可以使用 PHP，并使用 ajax 使用 $.ajax 或 $.post 方法进行通信。对此进行简单搜索将为您提供参考。简而言之，您可以使用 ajax 与 PHP 脚本进行通信，该脚本将依次为您查询数据库。

首先你可以看看这个， [http://webcheatsheet.com/php/connect_mysql_database.php](http://webcheatsheet.com/php/connect_mysql_database.php)

要记住的主要事情是 Javascript 只会影响您的浏览器。我希望这有帮助。

问候

# actionscript-3 - 在 Flash CS5 (as3) 中创建图层功能

> ID：10654181
> 
> 赞同：0
> 
> 时间：2012-05-18T14:08:57.283
> 
> 标签：actionscript-3

嗨，我需要在 as3 的帮助下在 Flash CS5 中创建应用程序，用户可以根据自己的要求进行绘制，但可以分层绘制。这个应用程序将为用户提供创建名片、刷子等。任何人都可以帮助我创建图层功能。仅保留此应用程序的图层功能。如果有人可以解决它，请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T15:02:52.173

您可以将每个图层视为一个精灵并使用每个图层的图形对象绘制到这些精灵中，您可以通过更改它们所在容器中精灵的索引来轻松更改图层的顺序。

```
var layer1:Sprite = new Sprite();
container.addChild(layer1);
var layer2:Sprite = new Sprite();
container.addChild(layer2);

layer1.graphics.***  //drawing functions
layer2.graphics.***  //drawing functions

container.setChildIndex(layer1,1);  //change ordering 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:49:58.837

您正在寻找的答案需要大量的开发时间。基本思想是创建一堆精灵并在每个精灵上绘制您需要的形状或图像。去年我就这样构建了一个应用程序，花了几个月的时间才完成。如果您想自己构建它，您应该就如何做事提出更具体的问题。

# entity-framework - 外键和表名的 Code First 约定

> ID：10654184
> 
> 赞同：0
> 
> 时间：2012-05-18T14:09:08.593
> 
> 标签：entity-framework, entity-framework-4, ef-code-first

请接受我对大量文本的道歉，我尽量不要错过可能影响实体框架 4.3.1 我的模型的细节：

```
public class Podcast
{
    public int Id { get; set; }
    public string Title { get; set; }
    public int PodcastStatus_Id { get; set; }
    public int PodcastType_Id { get; set; }

    public virtual PodcastStatus PodcastStatus { get; set; }
    public virtual PodcastType PodcastType { get; set; }
    public virtual ICollection<CategoryLink> CategoryLinks { get; set; }
}

public class PodcastStatus
{
    public int Id { get; set; }
    public string Name { get; set; }

    public virtual ICollection<Podcast> Podcasts { get; set; }
}

public class PodcastType
{
    public int Id { get; set; }
    public string Name { get; set; }

    public virtual ICollection<Podcast> Podcasts { get; set; }
} 
```

语境：

```
public class EcDbContext : DbContext
{
    public DbSet<PodcastType> PodcastTypes { get; set; }
    public DbSet<PodcastStatus> PodcastStatuses { get; set; }
    public DbSet<Podcast> Podcasts { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Podcast>().HasRequired(p => p.PodcastStatus).WithMany(s => s.Podcasts).HasForeignKey(p => p.PodcastStatus_Id);
        modelBuilder.Entity<Podcast>().HasRequired(p => p.PodcastType).WithMany(t => t.Podcasts).HasForeignKey(p => p.PodcastType_Id);

        base.OnModelCreating(modelBuilder);
    }
} 
```

询问：

```
db.Podcasts.Where(p => p.PodcastStatus.SysStatus > 0 && p.Title.Contains(search))
    .OrderBy(p => p.CreatedDate)
    .Skip((page - 1) * PageSize).Take(PageSize) 
```

在这里，我从模型描述中删除了一些列，以免使事情复杂化。我收到以下错误消息：`Invalid object name 'dbo.PodcastStatus'`。该表在数据库中被命名为“PodcastStatuses”。如果我们查看结果 SQL 查询，我们将看到以下文本：

```
 {SELECT TOP (10) 
[Project1].[Id] AS [Id], 
[Project1].[Title] AS [Title], 
[Project1].[CreatedDate] AS [CreatedDate], 
[Project1].[PodcastStatus_Id] AS [PodcastStatus_Id], 
[Project1].[PodcastType_Id] AS [PodcastType_Id], 
[Project1].[PodcastStatus_Id1] AS [PodcastStatus_Id1], 
[Project1].[PodcastType_Id1] AS [PodcastType_Id1]
FROM ( SELECT [Project1].[Id] AS [Id], [Project1].[CastNo] AS [CastNo], [Project1].[Title] AS [Title], [Project1].[OriginalText] AS [OriginalText], [Project1].[TranslateText] AS [TranslateText], [Project1].[CreatedDate] AS [CreatedDate], [Project1].[PodcastStatus_Id] AS [PodcastStatus_Id], [Project1].[PodcastType_Id] AS [PodcastType_Id], [Project1].[ImageFileName] AS [ImageFileName], [Project1].[PodcastStatus_Id1] AS [PodcastStatus_Id1], [Project1].[PodcastType_Id1] AS [PodcastType_Id1], row_number() OVER (ORDER BY [Project1].[CreatedDate] ASC) AS [row_number]
    FROM ( SELECT 
        [Extent1].[Id] AS [Id], 
        [Extent1].[Title] AS [Title], 
        [Extent1].[CreatedDate] AS [CreatedDate], 
        [Extent1].[PodcastStatus_Id] AS [PodcastStatus_Id], 
        [Extent1].[PodcastType_Id] AS [PodcastType_Id], 
        [Extent1].[PodcastStatus_Id1] AS [PodcastStatus_Id1], 
        [Extent1].[PodcastType_Id1] AS [PodcastType_Id1]
        FROM  [dbo].[Podcasts] AS [Extent1]
        INNER JOIN [dbo].[PodcastStatus] AS [Extent2] ON [Extent1].[PodcastStatus_Id] = [Extent2].[Id]
        WHERE ([Extent2].[SysStatus] > 0) AND ((N'' = @p__linq__0) OR ([Extent1].[Title] LIKE @p__linq__1 ESCAPE N'~'))
    )  AS [Project1]
)  AS [Project1]
WHERE [Project1].[row_number] > 0
ORDER BY [Project1].[CreatedDate] ASC} 
```

`PodcastStatus_Id1, PodcastStatus_Id1, [dbo].[PodcastStatus] (and not 'statusES'), [PodcastStatus_Id] = [Extent2].[Id]`

为什么？我不明白我做错了什么......有人可以帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:19:21.083

当 EF 在生成数据库时将名称复数时，这看起来像一个问题 - 我前段时间遇到过这样的事情，但我忘记了哪个 EF 版本。

您可以使用以下命令强制 EF 命名表（尽管您可能需要删除/重新创建数据库）：

```
[Table("PodcastStatus")]
public class PodcastStatus
{
    public int Id { get; set; }
    public string Name { get; set; }

    public virtual ICollection<Podcast> Podcasts { get; set; }
} 
```

# extjs - extjs 4.1 树刷新特定节点

> ID：10654187
> 
> 赞同：1
> 
> 时间：2012-05-18T14:09:16.173
> 
> 标签：extjs, tree, store, extjs4.1

我想刷新树的一个节点。

我尝试了类似的方法来刷新根并且它起作用了：

```
this.getStore('MyTreeStore').load({ params: { id: this.getId().getValue()} }); 
```

但现在我只想刷新一个节点而不是整棵树。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:53:24.293

我发现的最佳回应是：`this.getStore('MyTreeStore').load({ node: someNode});`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-18T15:18:24.657

`this.getStore('t').getAt(0).load(this.getId().getValue())` 仅为传递给`load`（[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Model-static-method-load](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Model-static-method-load)）的记录加载数据

# svn - svnant status 返回错误的结果

> ID：10654193
> 
> 赞同：3
> 
> 时间：2012-05-18T14:09:40.970
> 
> 标签：svn, version-control, ant, subclipse, svnant

我正在使用[svnant](http://subclipse.tigris.org/svnant/svntask.html)并使用[状态](http://subclipse.tigris.org/svnant/svntask.html#status)任务。

当我在我的仓库中使用`tortoisesvn` `status`命令提示符时，我得到以下信息：`windows 7``basedir`

```
M  Build\build.xml
M  Build\otherStuff.txt 
```

但是当我使用[svnant 的](http://subclipse.tigris.org/svnant/svntask.html) [状态](http://subclipse.tigris.org/svnant/svntask.html#status)任务时，我得到：

```
svn.status.textStatusProperty = normal
svn.status.propStatusProperty = normal 
```

我希望它返回这个：

```
svn.status.textStatusProperty = modified
svn.status.propStatusProperty = modified 
```

* * *

当我进入`Build`目录并做同样的事情时，我得到以下内容`tortoisesvn`：

```
M  build.xml
M  otherStuff.txt 
```

以下是[svnant 的](http://subclipse.tigris.org/svnant/svntask.html) [状态](http://subclipse.tigris.org/svnant/svntask.html#status)任务：

```
svn.status.textStatusProperty = unversioned
svn.status.propStatusProperty = non-svn 
```

这真的很奇怪，因为该`Build`目录肯定是版本化的。

* * *

到底是怎么回事？我究竟做错了什么？

**我试图找到一种快速的方法来检查我的本地 svn repo 副本中的修改。我知道[wcversion](http://subclipse.tigris.org/svnant/svntask.html#wcversion)，但该任务执行时间太长。我希望使用其他更快的东西。**

* * *

我的场景代码，场景之间唯一变化的是`path="${basedir}"`. 它更改为指向`basedir`或`Build`目录。这`basedir`是我的回购基地。

```
 <svnSetting
    svnkit="false"
    javahl="false"
    id="svn.settings"/>

    <svn refid="svn.settings">  
        <status 
            path="${basedir}"
            textStatusProperty="testStatus.textStatus" 
            propStatusProperty="testStatus.propStatus" 
        />
    </svn>

    <echo>svn.status.textStatusProperty = ${testStatus.textStatus}</echo>
    <echo>svn.status.propStatusProperty = ${testStatus.propStatus}</echo></echo> 
```

# ms-access - 如何：从允许更新的命令对象打开 ADODB 记录集？

> ID：10654194
> 
> 赞同：4
> 
> 时间：2012-05-18T14:09:44.990
> 
> 标签：ms-access, ado, adodb, recordset

在下面的代码中，我尝试使用 ADODB 从 Command 对象打开记录集，但它告诉我记录集不可更新。我很难做到这一点。

当我尝试将 .Open 方法与 Command.Execute 一起使用时，传递 adOpen{Static|Dynamic}、adLock{Optimistic|Pessimistic}，它给了我以下错误：

> 运行时错误“3001”
> 参数类型错误、超出可接受范围或相互冲突。

```
Dim cmdActionLog As ADODB.Command
Function LogAction(ActionID As Integer, Optional StartedOn As Date, Optional EndedOn As Date, Optional SuccessFlag As Boolean = True)
    Dim rs As ADODB.Recordset
    Set rs = New ADODB.Recordset
    rs.LockType = adLockOptimistic
    rs.CursorType = adOpenStatic
    rs.Open cmdActionLog.Execute(Parameters:=Array(ActionID)), , adOpenStatic, adLockOptimistic
    'Set rs = cmdActionLog.Execute(Parameters:=Array(ActionID))
    If Not rs.EOF Then
        If StartedOn Then rs!LAST_STARTED_ON = StartedOn
        If EndedOn Then rs!LAST_ENDED_ON = StartedOn
        rs!SUCCESS_FLAG = SuccessFlag
        rs.Update
    Else
        Debug.Print "No action exists with that ID!  Something is wrong here."
        Stop
    End If
End Function
Sub PrepareLogConnection()
    Dim prmActionID As ADODB.Parameter
    Set cmdActionLog = New ADODB.Command
    With cmdActionLog
        .CommandType = adCmdText
        .ActiveConnection = CurrentProject.Connection
        .Prepared = True 'Optimize for reuse
        .CommandText = "select * from ACTION_LOG where ACTION_ID = ?"
        .Parameters.Append .CreateParameter("ActionID", adBigInt, adParamInput)
    End With
End Sub
Sub test()
    PrepareLogConnection
    Debug.Print "START: " & Now

    For x = 1 To 10
        LogAction 1, Now() 'Test how long it takes with and without Prepared in PrepareLogConnection
    Next x

    Debug.Print "END: " & Now
End Sub 
```

如何使用 ADO 从命令对象打开可更新记录集？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-03-10T14:55:51.130

为这个答案的迟到道歉，这是为了任何其他遇到这个问题的人的利益，这与我自己的问题完全匹配。

您可以使用 ado 命令作为记录集的源参数，而不是使用 cmd.Execute。此时您可以使用 adLockOptimistic 标志

例如

```
Public Function GetP(id As Long) As ADODB.Recordset
    If cmdPricingXref Is Nothing Then
        Set cmdP = New ADODB.Command
        With cmdP
            .ActiveConnection = cnM
            .CommandText = "SELECT * FROM A_PR where ID =?"
            Set prmId = .CreateParameter("ID", adNumeric, adParamInput, 6)
            .Parameters.Append prmId
            .CommandType = adCmdText
            .CommandTimeout = 30
        End With
    End If
    cmdP.Parameters("ID").value = id

    'Set GetP = cmdP.Execute()
    Set GetP = New ADODB.Recordset
    'use the ado command as the source parameter instead of the 
    'typical sql statement.  do not include the connection parameter
    GetP.Open cmdP, , adOpenStatic, adLockOptimistic 'change these to your suit needs
End Function 
```

我最终在这里找到了... [http://www.vbforums.com/showthread.php?278362-Nonupdatable-Recordset-returned-from-Adodb.command](http://www.vbforums.com/showthread.php?278362-Nonupdatable-Recordset-returned-from-Adodb.command)

# ios - mapViews 标注中的计时器

> ID：10654198
> 
> 赞同：0
> 
> 时间：2012-05-18T14:09:51.920
> 
> 标签：ios, map, timer, callouts

我有多个引脚（2 种引脚）的地图。我他们将计时器作为字幕（自某件事以来经过了多少时间）。问题是我不知道该怎么做。当然计时器应该放在带有 mapView 的 viewController 上。然后可能一些观察者决定使用注释......但是在这个概念中，在哪里删除观察者以及在哪里为观察者设置动作改变......？或者也许有更好的概念？感谢您的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T10:17:41.757

我会制作自己的 MKAnnotation 类。

```
@interface MyAnnotation : NSObject <MKAnnotation> {
    CLLocationCoordinate2D _coordinate;
    NSMutableString * title;
    NSMutableString * subtitle;
    ...
    UIImage * pinImage;
    ...
    NSDate * startTime;
} 
```

此类将具有`NSDate * startTime`as 属性和 refreshTime 方法，它们比较当前时间 ( `[NSDate date]`) 并在字幕中显示经过的时间。

然后你只需要刷新你的地图注释

```
for(MyAnnotation * annotation in [mapView annotations]) {
    if([annotation isKindOfClass:[MyAnnotation class]]) // important cause the user centered blue point is part of your annotation list!
        [annotation refreshTime];
} 
```

现在的问题是：你想什么时候刷新？

例如，您可以使用每 n 秒刷新一次的计时器，或者在 ViewDidAppear 上启动刷新......这取决于您想要做什么！

编辑 ：

如果您想刷新注释选择，也许您可​​以创建自己的 MKAnnotationView 的 AnnotationView 子类。

然后在您的 AnnotationView 中，覆盖`touchesBegan:withEvent:`or`touchesEnded:withEvent:`以发送更新。

我没有测试过，但我很确定它会起作用。

# ios - 检测核心图上的触摸的方法

> ID：10654199
> 
> 赞同：1
> 
> 时间：2012-05-18T14:09:55.950
> 
> 标签：ios, touch, core-plot, detection

我一直在研究coreplot。我已经绘制了一个图表，但我希望以类似于“touchesBegan”“touchesMoved”等的方式检测它的触摸。

我已经看到很多关于所使用方法的非常模糊的东西，例如

```
 "- plotSpace:shouldHandlePointingDeviceDownEvent:atPoint:" 
```

但我和他们无处可去。有小费吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T15:23:57.683

在您的头文件中，添加 CPTPlotSpaceDelegate

```
@interface MyCorePlotView : UIView <CPTPlotDataSource, CPTPlotSpaceDelegate> {
    ...
} 
```

在您的实现文件中添加委托方法

```
-(BOOL)plotSpace:(CPTPlotSpace *)space shouldHandlePointingDeviceDownEvent:(id)event atPoint:(CGPoint)point
{
    // Handle down event
} 
```

当用户点击绘图区域时，您将收到 plotSpace:shouldHandlePointingDeviceDownEvent:，然后您可以采取适当的行动。

在 CPTPlotSpace.h 中查找您可能还想使用的其他委托方法。

# android - ViewPagerIndicator

> ID：10654201
> 
> 赞同：1
> 
> 时间：2012-05-18T14:09:57.467
> 
> 标签：android, viewpagerindicator

我尝试使用 viewpagerindicator 但不知何故控制台错误总是显示：

> E/AndroidRuntime(871): 引起: java.lang.ClassNotFoundException: com.viewpagerindicator.TitlePageIndicator in loader dalvik.system.PathClassLoader

我已将 viewpagerindicator 包含为库。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:22:54.157

*试试这个*：右键单击项目。选择属性。转到 Java Build Path 并确保检查您的库。一旦你确保它被选中，清理项目，然后运行你的项目。这应该可以解决您的问题。

![在此处输入图像描述](../Images/e8cde1095d10318189f2574ba8f0d498.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-12T11:06:07.763

将其包含在 Gradle 构建文件中，有 2 个文件：

build.gradle 位于“app”文件夹中，另一个位于根项目文件夹中。

更新第一个中的“依赖项”部分，如下所示：

```
dependencies {
   /..... other libs
   compile 'com.viewpagerindicator:library:2.4.1@aar'
   /.... other libs
} 
```

并更新第二个中的“allprojects”部分，如下所示：

```
allprojects {
    repositories {
        maven { url "http://dl.bintray.com/populov/maven" }
        jcenter()
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T10:05:08.167

> > 您必须将库添加到项目中。
> > 
> > ### *首先这样做；*
> > 
> > 文件 > 导入 > Android > 现有 Android 代码到工作区
> > 
> > ### *第二个将库添加到您的项目中；*
> > 
> > 项目属性 > Android > 向下滚动并添加所需的库

-

> > > 我不确定，但这个例子可以帮助你；[让 ActionBarSherlock 和 ViewPagerIndicator 玩得很好](http://droidista.blogspot.com/2012/08/making-actionbarsherlock-and.html)
> > > 
> > > 您可能还会遇到这里提到的错误；[Android - SupportMapFragment 与 GoogleMaps API 2.0 给出 IllegalArgumentException](https://stackoverflow.com/questions/14124354/android-supportmapfragment-with-google-map-api-2-0-giving-error/14954117#14954117)
> > > 
> > > 这就是我让我的 ViewPagerIndicator 工作的方式..
> > > 
> > > > ### *祝你好运..！！*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T02:00:11.437

在我将 JDK 切换到 32 位版本之前，我在使用 viewpagerindicator 时遇到了很多问题。

有关更多信息，请参阅[https://stackoverflow.com/a/12831327/1116861](https://stackoverflow.com/a/12831327/1116861)。

# javascript - JQuery - 在事件处理程序中访问对象属性

> ID：10654206
> 
> 赞同：1
> 
> 时间：2012-05-18T14:10:17.670
> 
> 标签：javascript, jquery

我正在尝试使用 jquery 对 div 进行扩展。该扩展名为 NunoEstradaViewer，下面是代码示例：

```
(function ($){

NunoEstradaViwer: {
  settings: {
     total: 0,
     format: "",
     num: 0;
  },
  init: function (el, options) {
   if (!el.length) { return false; }
        this.options = $.extend({}, this.settings, options);
        this.itemIndex =0;
        this.container = el;

        this.total = this.options.total;
        this.format = ".svg";
        this.num = 0;
  },
  generateHtml: function(){
   /*GENERATE SOME HTML*/

  $("#container").scroll(function(){
        this.num++;
        this.nextImage;
  })
  },
  nextImage: function(){

  /*DO SOMETHING*/

  }
}); 
```

我的问题是我需要访问 this.num 的值并在滚动事件的处理函数中调用 this.nextImage 函数，但对象“this”指的是滚动而不是“NunoEstradaViewer”。如何访问这些元素？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:41:58.423

通常我在这种情况下所做的是将对“this”的引用保存在变量中。

```
generateHtml: function(){
    /*GENERATE SOME HTML*/

    var self = this;

    $("#container").scroll(function(){
        self.num++;
        self.nextImage;
    })
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:50:39.883

常见的解决方案是存储对所需上下文的引用：

```
(function () {
    var self;
    self = this;
    $('#container').scroll(function () {
        self.doStuff();
    });
}()); 
```

另一种方法是将上下文传递给函数：

```
(function () {
    $('#container').scroll({context: this, ..more data to pass..}, function (e) {
        e.data.context.doStuff();
    });
    //alternatively, if you're not passing any additional data:
    $('#container').scroll(this, function (e) {
        e.data.doStuff();
    });
}()); 
```

# hive - 执行错误，从 org.apache.hadoop.hive.ql.exec.MapRedTask 返回代码 1

> ID：10654209
> 
> 赞同：9
> 
> 时间：2012-05-18T14:10:31.597
> 
> 标签：hive

我在 HiveQL 中执行条件查询时遇到问题。基本`select * from tablename`语句工作正常。错误是：

```
Total MapReduce jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
java.net.ConnectException: Call to /0.0.0.0:8021 failed on connection exception: java.net.ConnectException: Connection refused
        at org.apache.hadoop.ipc.Client.wrapException(Client.java:1134)
        at org.apache.hadoop.ipc.Client.call(Client.java:1110)
        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:226)
        at org.apache.hadoop.mapred.$Proxy5.getProtocolVersion(Unknown Source)
        at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:398)
        at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:384)
        at org.apache.hadoop.mapred.JobClient.createRPCProxy(JobClient.java:501)
        at org.apache.hadoop.mapred.JobClient.init(JobClient.java:486)
        at org.apache.hadoop.mapred.JobClient.<init>(JobClient.java:469)
        at org.apache.hadoop.hive.ql.exec.ExecDriver.execute(ExecDriver.java:655)
        at org.apache.hadoop.hive.ql.exec.MapRedTask.execute(MapRedTask.java:123)
        at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:130)
        at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)
        at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1063)
        at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:900)
        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:748)
        at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:209)
        at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:286)
        at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:516)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.hadoop.util.RunJar.main(RunJar.java:186)
Caused by: java.net.ConnectException: Connection refused
        at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
        at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:574)
        at org.apache.hadoop.net.SocketIOWithTimeout.connect(
....
Job Submission failed with exception 'java.net.ConnectException(Call to /0.0.0.0:8021 failed on connection exception: java.net.ConnectException: Connection refused)'
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MapRedTask 
```

我从 Eclipse IDE 和 Hive shell 都试过了。输出是一样的。请帮忙！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-09-28T09:01:39.053

这应该可以解决您的问题，因为此属性将`true`默认设置为。

```
set hive.auto.convert.join.noconditionaltask=false 
```

> `hive.auto.convert.join.noconditionaltask`- Hive 是否开启了根据输入文件大小将 common join 转换为 mapjoin 的优化。
> 
> 如果此参数打开，并且 n-way 连接的 n-1 个表/分区的大小之和小于指定大小，则连接直接转换为 mapjoin（没有条件任务）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-30T14:59:05.573

在大多数情况下，此错误是由权限问题引起的，其中运行该命令的 Hive 用户没有对 /user/hive 的访问权限

您需要检查 Hadoop Hive 集群的配置

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-16T00:07:33.737

我注意到在使用 Hive2 时，您需要更改在使用 HiveQL 时指定减速器数量的方式。在 Hive1 上，我使用过：

```
SET mapred.reduce.tasks=1 
```

但是在 Hive2 上，我注意到我需要使用：

```
SET mapreduce.job.reduces=1 
```

我有同样的错误信息，改变它为我解决了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-14T06:54:55.163

对我来说，这是由于没有设置队列。

```
set mapred.job.queue.name=xxxx;
set mapreduce.job.reduces=1; 
```

设置这两个参数对我有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-18T12:53:35.837

这对我有用：

```
SET hive.auto.convert.join=false; 
```

默认情况下，Hive 将简单连接转换为尝试将输入表加载到内存的映射连接。此选项将禁用将输入表加载到内存。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-15T13:31:33.630

我有一个使用 VirtualBox 安装的 cloudera 快速入门映像。我必须执行以下操作才能解决此问题

sudo vi /etc/hive/conf/hive-site.xml 并将 hive.auto.convert.join 属性设置为 false（您需要 root 才能编辑，因此需要 sudo）。

我在 hive-site.xml.xml 中没有 hive.auto.convert.join.noconditionaltask 属性。

# javascript - Javascript Date() 计算年龄不按天计算

> ID：10654211
> 
> 赞同：-1
> 
> 时间：2012-05-18T14:10:35.050
> 
> 标签：javascript

这是我的代码，取自这里：[Calculate age in JavaScript](https://stackoverflow.com/questions/4060004/calculate-age-in-javascript)

```
 var today = new Date();
        birthday_val = $(".datepicker").val().split('/'); // input value
        birthday = new Date(birthday_val[2],birthday_val[1],birthday_val[0]); // birthday date object
        var age = today.getFullYear() - birthday.getFullYear();
        var m = today.getMonth() - birthday.getMonth();
        var d = today.getDay() - birthday.getDay();
        if (m < 0 || (m === 0 && today.getDate() < birthday.getDate()) ) {
            age--;
        } 
```

它计算正确，除了这一天 - 没有考虑到这一点，我不知道为什么。有接盘侠吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:17:56.457

**编辑：**这不是正确的答案，尽管被 OP 标记为如此。

* * *

您正在使用不正确的方法来检索月份中的某一天。

`Date.getDay`返回星期几

`Date.getDate`返回月份中的日期

# javascript - Spring Source Tool Suite (equals Eclipse IDE) javascript "Open Declaration" Not possible

> ID：10654221
> 
> 赞同：3
> 
> 时间：2012-05-18T14:11:23.507
> 
> 标签：javascript, sts-springsourcetoolsuite

我使用 Spring Source Tool Suite 2.9.0 开发 Grails Web 项目（此 IDE 构建在 Eclipse 之上，看起来相同，您甚至可以安装 eclipse 插件）

我在项目文件夹“MyProject”中有一个“JS”子文件夹，其中包含 JavaScript (.js) 文件。

当我尝试通过右键单击调用并选择“打开声明 F3”来打开 javascript 函数的声明时，我收到错误“资源不在 javascript 项目的构建路径上”

有没有办法管理我可以遵循函数调用和定义（我什至会尝试使用 Eclipse 插件）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:36:34.287

您需要确保将 Eclipse 项目特定文件签入 SVN。这些文件告诉 Eclipse 它正在处理什么类型的项目。`classpaths`他们还维护和之类的东西`dependencies`。

这些文件将包括一个`.project`Java`.classpath`项目。如果您没有将这些文件添加到 SVN，那么 Eclipse 在您签出时将不知道如何处理该项目。

# node.js - 错误（“找不到模块'”+请求+“'”）：全新安装，未添加模块

> ID：10654223
> 
> 赞同：0
> 
> 时间：2012-05-18T14:11:31.307
> 
> 标签：node.js, iisnode

我刚刚安装了 Node (0.6.18) 和 IISNode (0.1.19.0) 并运行了一个简单的示例。如果我创建了一个名为

> “ls.js”

内容如下：

```
var fs = require('fs');
var files = fs.readdirSync('.');
for(fn in files){
    console.log(files[fn]);
} 
```

然后从它保存在运行“node ls.js”的目录中，这会给出以下错误：

```
C:\nodetest>node ls.js

module.js:337
    throw new Error("Cannot find module '" + request + "'");
          ^
Error: Cannot find module 'C:\nodetest\ls.js'
    at Function._resolveFilename (module.js:337:11)
    at Function._load (module.js:279:25)
    at Array.0 (module.js:484:10)
    at EventEmitter._tickCallback (node.js:190:38) 
```

关于缺少什么的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:39:35.647

'C:\nodetest\ls.js' 似乎不是 fs 上的正确位置

# sql - SQL Server 2008 超时过期错误

> ID：10654228
> 
> 赞同：0
> 
> 时间：2012-05-18T14:11:49.147
> 
> 标签：sql, sql-server, sql-server-2008, asp-classic

我有一个简单的 sql 调用，例如：-

```
select col1,col2 from table1 
```

有时系统会运行以下内容：-

```
update table1 
set col3 = 'something' 
where col1 ='s1' and col2 ='s2' 
```

这些查询通过我们服务器上运行的各种应用程序运行，并且只发生在一个大约有 100k 行的表上。

我有数百万行的表 - 它不会在它们上超时，但不确定它为什么会在这个上。

这些查询整天运行，没有任何问题，但有时在白天 - 特别是在高峰时段 - 它们因错误而失败 - 超时已过期 -

你能告诉我我可以尝试解决这个错误吗

我需要执行某种类型的锁定吗？

同样，如果用户正在更新评论，然后系统上的其他用户尝试更新表中的同一行 - 它是否会使第二个用户超时，因为该行已被锁定以进行编辑 - 有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T10:12:11.987

我找到了答案——因为它是旧系统中的一个表——以前的用户没有添加主键，认为那里已经有一个虚拟主键，但这是不对的。

因为 sql 需要很长时间才能进行编辑并且会超时。

所以我只是在表中创建了一个复合键，现在它工作正常。

结论 - 如果您要处理更新、删除数据，永远不要有没有主键的表

感谢大家的意见

# visual-studio-2010 - 产品和单元测试：同一个工作区？

> ID：10654229
> 
> 赞同：0
> 
> 时间：2012-05-18T14:11:54.157
> 
> 标签：visual-studio-2010, version-control

很长一段时间以来，我们将单元测试作为一个单独的项目/工作区，有时我们将其附加到产品项目中以动态运行单元测试。

最近我们决定动态运行单元测试的能力对于我们的日常工作非常重要。为了在 Visual Studio 2010 中实现它，我们将产品和单元测试放在同一个 TFS2010 工作区中。

巨大的缺点是产品和单元测试签入是混合的。

是否有任何技巧或更好的方法来避免这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:22:17.547

好吧，在我的项目中，我们在 TFS 下使用相同的工作区进行应用程序代码和单元测试，但是我们有单独的项目用于单元测试，并且没有将它们与主项目解决方案混合。

同样，在 TFS 中，它们存储在单独分支中的单独文件夹下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T07:39:06.750

为什么这会是个问题？单元测试仅与实际的生产代码一起有意义。将其保存在单独的项目、相同的工作区和解决方案文件中。单元测试是关于快速反馈的，混合签入只会使可追溯性更好。

# c# - 无法在计算机上打开 MSDTC 服务。访问被拒绝

> ID：10654230
> 
> 赞同：2
> 
> 时间：2012-05-18T14:12:10.420
> 
> 标签：c#, .net, service, permissions

我正在尝试验证我的用户是否有权控制 MSDTC 服务，以便在关闭时可以启动它。实际上，第一步只是验证它是否已经启动，能够启动它并不重要。该应用程序使用 .Net 4.0，因此在新的安全模型下运行。

以下代码在与具有所需权限的用户一起运行时有效，但在普通用户（非管理员）的 Stop() 方法上失败：

```
 var permission = new ServiceControllerPermission(ServiceControllerPermissionAccess.Control, Environment.MachineName, "MSDTC");
     permission.Demand();  // Is this even considered in .Net 4.0?

     var MSDTC = new ServiceController("MSDTC", Environment.MachineName);
     MSDTC.Stop();   // Crashes with "Access is denied" for an ordinary user.
     MSDTC.WaitForStatus(ServiceControllerStatus.Stopped, TimeSpan.FromSeconds(10));
     MSDTC.Start(); 
```

所以，我的问题是如何验证用户是否具有运行操作所需的权限？一般来说，我如何检查其他资源，如寄存器等？

我环顾四周寻找解决方案，但没有找到任何东西。当然，我已经阅读了有关新安全模型的 MSDN 文档，但没有找到任何我可以在这种情况下使用的东西。

# jquery - 如果在jQuery中的其他功能

> ID：10654231
> 
> 赞同：0
> 
> 时间：2012-05-18T14:12:20.713
> 
> 标签：jquery, function

我的 jquery 中需要类似 if else 函数，但我不知道该怎么做。还是不可能？

```
 if  $(".image1").click(function(){

        $(idnumbers).css("display", "block");
        $(idnumberp).css("display", "none");
        $(idnumber).css("display","block");  
  });

 else if $(".image2").click(function(){
        $(idnumbers2).css("display", "block");
        $(idnumberp).css("display", "none");
        $(idnumber).css("display","block");  

  });

 else $(".image3").click(function(){

        $(idnumbers3).css("display", "block");
        $(idnumberp).css("display", "none");
        $(idnumber).css("display","block");  

   }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:16:16.530

您不需要将事件处理程序放入 if 语句中。通过将事件附加到元素“onClick”侦听器，您已经在处理每个特定情况。

```
$(".image1").click(function(){
    $(idnumbers).css("display", "block");
    $(idnumberp).css("display", "none");
    $(idnumber).css("display","block");  
});

$(".image2").click(function(){
    $(idnumbers2).css("display", "block");
    $(idnumberp).css("display", "none");
    $(idnumber).css("display","block");  
});

$(".image3").click(function(){
    $(idnumbers3).css("display", "block");
    $(idnumberp).css("display", "none");
    $(idnumber).css("display","block");  
}); 
```

这应该可以满足您的需要，而无需额外的 if/else 语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T14:17:53.420

你真的想要这样的东西：

```
function imageClick()
{       
    $(idnumberp).css("display", "none");         
    $(idnumber).css("display","block");     
};

$(".image1").click(function(){ $(idnumbers).css("display", "block"); imageClick(); });
$(".image2").click(function(){ $(idnumbers2).css("display", "block"); imageClick(); });
$(".image3").click(function(){ $(idnumbers3).css("display", "block"); imageClick(); }); 
```

# ruby - RuntimeError: :json 未在 Faraday::Request 上注册

> ID：10654232
> 
> 赞同：13
> 
> 时间：2012-05-18T14:12:24.767
> 
> 标签：ruby, rspec, faraday

我对 ruby​​ 相当陌生，我正在尝试执行规范，但收到此错误：

RuntimeError: :json 未在 Faraday::Request 上注册

我正在尝试使用这个宝石： [https ://github.com/Chicago/windy](https://github.com/Chicago/windy)

Mac OS X 10.7.4 Ruby 1.9.3，使用 RVM

谢谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-20T12:21:46.867

我在升级法拉第时遇到了这个问题。json 请求中间件在 0.8 中从 Faraday 中移除。它现在在`faraday_middleware`宝石​​中。您应该`gem install faraday_middleware`并在创建法拉第对象的文件中要求它。

见[https://github.com/lostisland/faraday_middleware/wiki/Changes-0.8](https://github.com/lostisland/faraday_middleware/wiki/Changes-0.8)

# javascript - 如何使用 Handlebars 解码 HTML 实体

> ID：10654234
> 
> 赞同：24
> 
> 时间：2012-05-18T14:12:30.430
> 
> 标签：javascript, templates, mustache, handlebars.js

我正在构建的应用程序上使用 Handlebars 模板引擎来呈现从服务器获取的数据。

我知道默认情况下它会转义 HTML 值，并且您必须使用三重括号`{{{text}}}`才能`text: <p>Example</p>`将其呈现为 HTML 元素。

问题是，如果我收到的数据（包括 HTML 标签）已经被转义了怎么办？

所以，如果我收到如下数据：

```
text: &lt;p&gt;Example&lt;/p&gt; 
```

如何强制车把翻译它并将其呈现为普通 HTML？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-18T14:18:47.730

您必须先对其进行解码，然后将其传递给带有三重括号的车把。我知道一个用 jQuery 解码 html 实体的小技巧：

```
// encoded is "&lt;p&gt;Example&lt;/p&gt" in your example
var decoded = $('<textarea />').html(encoded).val();
// decoded should now return <p>Example</p> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-11-29T19:10:23.477

**Handlebars 提供帮助器并在Handlebars_helpers.js**下编写如下自定义帮助器

 **```
Handlebars.registerHelper('encodeMyString',function(inputData){
    return new Handlebars.SafeString(inputData);
}); 
```

`.handlebar`并在您的文件或文件中使用此帮助程序，`.hbs`如下所示

```
{{encodeMyString myHTMLData}} 
```

如果没有 Jquery 的帮助，您可以在车把内的任何地方使用它。即使您可以使用帮助器单独传递数据，它将返回带有前置和附加标签的数据。**

# java - Java-将对象数据保存到文件

> ID：10654236
> 
> 赞同：7
> 
> 时间：2012-05-18T14:12:37.723
> 
> 标签：java, class, object, serialization

我已经看过很多不同的帖子，关于您应该以何种方式将对象序列化为文件，并且所有这些帖子在本质上都在如何做到这一点以及最佳实践是什么方面存在冲突。所以这就是我要保存的内容：

```
public class IHandler{
    public double currentLoad;
    public String currentPrice;
    public String configArgs[];
}; 
```

我们可以假设 configArgs 的大小是已知的，我需要制作一个文件，这就是我目前所拥有的。

```
public static void serializeDataOut(IHandler ISH)throws IOException{
    String fileName= "Test.txt";
    FileOutputStream fos = new FileOutputStream(fileName);
        //What do I do here?
    }

  public static IHandler serializeDataIn(){
      //What do I do here?
  } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-18T14:24:38.013

好吧，我假设，您想将对象直接写入文件

```
public static void serializeDataOut(IHandler ish)throws IOException{
    String fileName= "Test.txt";
    FileOutputStream fos = new FileOutputStream(fileName);
    ObjectOutputStream oos = new ObjectOutputStream(fos);
    oos.writeObject(ish);
    oos.close();
}

public static IHandler serializeDataIn(){
   String fileName= "Test.txt";
   FileInputStream fin = new FileInputStream(fileName);
   ObjectInputStream ois = new ObjectInputStream(fin);
   IHandler iHandler= (IHandler) ois.readObject();
   ois.close();
   return iHandler;
} 
```

我只是提供了重要的代码。通过异常处理来实现这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T14:25:07.633

如何序列化对象的示例：

```
public static void writeToFile(File path, Database data)
{
    try(ObjectOutputStream write= new ObjectOutputStream (new FileOutputStream(path)))
    {
        write.writeObject(data);
    }
    catch(NotSerializableException nse)
    {
        //do something
    }
    catch(IOException eio)
    {
        //do something
    }
}

public static Object readFromFile(File path)
{
    Object data = null;

    try(ObjectInputStream inFile = new ObjectInputStream(new FileInputStream(path)))
    {
        data = inFile.readObject();
        return data;
    }
    catch(ClassNotFoundException cnfe)
    {
        //do something
    }
    catch(FileNotFoundException fnfe)
    {
        //do something
    }
    catch(IOException e)
    {
        //do something
    }
    return data;
} 
```

欲了解更多信息[http://docs.oracle.com/javase/tutorial/jndi/objects/serial.html](http://docs.oracle.com/javase/tutorial/jndi/objects/serial.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T16:06:32.093

您可以使用 XMLDecoder/XMLEncoder 将 JavaBean 序列化为 xml。以下是 oracle 的 Javadocs 中关于这两个类的示例：

（XML解码器）

```
 XMLDecoder d = new XMLDecoder(
                      new BufferedInputStream(
                          new FileInputStream("Test.xml")));
   Object result = d.readObject();
   d.close(); 
```

（XML编码器）

```
 XMLEncoder e = new XMLEncoder(
                      new BufferedOutputStream(
                          new FileOutputStream("Test.xml")));
   e.writeObject(new JButton("Hello, world"));
   e.close(); 
```

请注意，您需要添加 getter 和 setter 并使类可序列化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T14:19:51.597

你想将 IHandler 写入 test.txt 文件吗？尝试

```
ObjectOutputStream oos = new ObjectOutputStream(fos);
oos.write(IHandler); 
```

如果您想从该文件中读取 IHandler，则需要执行此操作

```
ObjectInputStream ois = new ObjectInputStream(fos); 
IHandler iHandler = (IHandler) ois.readObject(); 
```

# c# - 更新 MongoDb 集合中文档的字段值

> ID：10654239
> 
> 赞同：0
> 
> 时间：2012-05-18T14:12:52.457
> 
> 标签：c#, mongodb

架构：

```
 /* 0 */
    {
      "_id" : ObjectId("4fb6376ef31dfd11c41c7fd0"),
      "Name" : "A",
      "Val" : "#rt45"
    }

    /* 1 */
    {
      "_id" : ObjectId("4fb655aff31dfd11c41c7fd1"),
      "Name" : "B",
      "Val" : "#gh46"
    }

    /* 2 */
    {
      "_id" : ObjectId("4fb65626f31dfd11c41c7fd2"),
      "Name" : "C",
      "Val" : "#rt67"
    } 
```

我必须将数据插入“名称”并想查询它是否应该检查字段“名称”（这里是 A、B、C）的值是否存在，如果它需要从插入中跳过希望有人可以帮忙，我在c#驱动程序上请分享示例代码提前谢谢。我一直在这个

```
IMongoQuery query = Query.Exists("_id", true);
                var fields = Fields.Include("Name");
                var result = collection.Find(query).SetFields(fields).SetLimit(1).FirstOrDefault(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:39:49.113

[FindAndModify](http://www.mongodb.org/display/DOCS/findAndModify+Command)是 MongoDB 中一次性查询和更新的一种方式。

另一种方法是仅用户更新

```
Collection.Update(Query. ..., Update.Set()) 
```

第二个可以，如果新帖子的所有信息都存在，如果查询没有找到它，也可以创建一个帖子。

如果您尝试逐步编写您正在尝试做的事情的示例（用简单的英语），我也许可以为 C# 编写一个示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T18:46:27.633

您可以先调用 Find 并查看是否已经存在具有相同 Name 值的文档，然后仅在 Find 未返回任何内容时调用 Insert。但是，如果多个进程或线程正在做同样的事情，这将是不安全的。

另一种方法是在 Name 上创建一个唯一索引，然后执行 Insert。如果已存在具有相同名称值的另一个文档，则插入将失败。

# install4j - install4j 安装程序有类似 unzip -t 的东西吗？

> ID：10654243
> 
> 赞同：1
> 
> 时间：2012-05-18T14:13:09.167
> 
> 标签：install4j

我使用 install4j 构建的安装程序将通过更新程序分发到数据中心中的多个（有时是数百个）设备。在我们当前的实现中，这些文件使用 unzip -t “测试”是否损坏。我意识到我们可以比较文件上的 md5sum，但这会增加我们希望在构建过程中避免的额外开销。还有其他建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T09:14:29.153

如果将条件表达式添加`!Boolean.getBoolean("testRun")`到所有屏幕，则可以在命令行模式下使用参数执行安装程序

-J-DtestRun=true -c

然后安装程序将进行试运行，无需对系统进行任何修改。当然，这只适用于兼容的目标系统。

# javascript - Chrome 错误或编码错误？目标页面中的锚点/ID链接不起作用

> ID：10654244
> 
> 赞同：1
> 
> 时间：2012-05-18T14:13:19.553
> 
> 标签：javascript, html, css, google-chrome

**编辑添加：** *有趣的是 - 基于下面人们的评论 - 我尝试在我的主页中设置一个跳转链接 - 效果很好。（http://www.umbc.edu/classof2012/index2.html - 它位于段落文本左上角的 div 中）因此，无论出于何种原因，问题出现在指向单独目标页面的链接中。 .*

我有一个充满照片/标题的页面——点击照片或文本链接后，查看者会被带到一个带有相关简历的新页面。这个想法是他们被直接带到与他们点击的照片相关的生物。这在 Safari 和 Firefox 中运行良好。

在 Chrome 中，链接都将您带到生物页面的顶部，而不是页面内的相关生物。

我在这里想念什么？这应该是一件很简单的事情，对吧？

该页面可以在这里查看：[http ://www.umbc.edu/classof2012/](http://www.umbc.edu/classof2012/)

我试图找到一些关于这是 Chrome 问题的文档，但我没有找到任何确定的东西。我在这里发现了一些似乎涉及类似问题的问题，但没有关于简单的基本锚链接不起作用的问题。可能是我做错了什么，只有 Chrome 正在捕捉，但链接代码看起来很简单，过去一直对我有用 - 除非我错过了一些明显的错误！

如果这是 Chrome 的特性，任何人都可以提出一个适用于所有浏览器的替代解决方案吗？

谢谢！！

编辑添加代码片段...

这是原始页面代码......它继续超出我发布的内容，但它更相似：

```
code here: <!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>UMBC Class of 2012</title>
  <meta name="description" content="UMBC's Class of 2012 Featured Graduates">
    <link rel="shortcut icon" href="../images_new/icon.jpg" />
<meta name="viewport" content="width=device-width,initial-scale=1">

  <!-- CSS Reset -->
  <link rel="stylesheet" href="css/reset.css">

  <!-- Styling for your grid blocks -->
 <link rel="stylesheet" href="css/style.css">

</head>

<body>

  <div id="container">
  <div id="logo_holder">
  <div id="logo">
  <?php include("../include/toputilities_classof.shtml"); ?>
</div>
  </div>
  <div id="text_holder">

<div class="header">
  <img src="images/class_text3.gif" height="70" alt="Class of 2012" border="0"> 
  </div>

    </div>

    <div id="main" role="main">

       <ul id="tiles">

    <li style="background-color:#Fc0;padding:14px;">
    <a href="bios.html"><img src="images/commencement_7.jpg" width="200"></a>
      <p style="color:#333;font-size:13px;font-weight:bold;font-style:italic;padding:0 0px 9px 0px;">UMBC is proud of all of our graduates. On May 18 and 21, the University awards nearly 1,700 bachelor’s, master’s and Ph.D. degrees at its Graduate School and Undergraduate Commencement ceremonies. Meet a few of our exceptional students and discover what the future has in store for the Class of 2012.</p>
<!-- Share Button BEGIN -->
<a rel="nofollow" href="http://www.facebook.com/share.php?u=http://www.umbc.edu/classof2012/" target="_blank" style="text-decoration:none;float:left;margin-right:4px;" title="Share on Facebook" alt="Share on Facebook"><img src="images/facebook.png"/></a>
<a rel="nofollow" href="https://twitter.com/share" class="twitter-share-button" target="_blank" data-count="none" style="text-decoration:none;margin-right:4px;float:left;"title="Share on Twitter" alt="Share on Twitter"><img src="images/twitter.png"/></a>
<a rel="nofollow" href="https://plusone.google.com/_/+1/confirm?hl=en&url=http://www.umbc.edu/classof2012" target="_blank" style="text-decoration:none;margin-right:4px;float:left;" title="Plus One" alt="Plus One"><img src="images/googleplus.png"/></a>

<a href="http://pinterest.com/pin/create/button/?url=http://www.umbc.edu/classof2012&media=http://www.umbc.edu/classof2012/images/commencement_7.jpg&description=UMBC's Class of 2012" target="_blank" style="text-decoration:none;"><img border="0" src="images/pinterest.png" title="Pin It" alt="Pin It"/></a>
<!-- Share Button END -->
    </li>
<li style="background-color:#FFC;">
          <p style="padding-bottom:7px;text-align:center;color:#000;margin-top:0;">    <strong>VALEDICTORIAN</strong></p>
          <a href="bios.html#MCole"><img src="images/student_pics/MaryCole.jpg" width="200" alt="Mary Cole" /></a>
        <p><strong>Mary Elizabeth Cole</strong><br>
        Anthropology &amp; Biological Sciences</p>
        <p><em>Here I am standing at the highest point of Bodiam Castle in East Sussex, England. I loved travelling to cultural sites during my study abroad experience.</em></p>
        <p><a href="bios.html#MCole">Read Bio</a></p>
        <p><a href="http://www.youtube.com/embed/WG4B9e7A5pA" target="_blank"><img src="images/video_icon2.png" height="29" border="0" alt="Watch video &gt;"></a></p>
        </li> 
```

这是目标生物页面上的相关代码：

```
 <div id="main" role="main">

       <ul id="tiles">

          <li style="background-color:#FFC;">
         <div id="MCole" class="pic"> 
         <img src="images/photos/MaryCole.jpg" width="240" alt="Mary Cole, Valedictorian" /></div>
        <h3>Mary Elizabeth Cole</h3>

<p style="color:#333;"><strong>Plans: Ph.D., Biological Anthropology, The Ohio State University</strong><br>

B.A., Cultural Anthropology; B.S., Biological Sciences<br>

<em>Summa Cum Laude</em><br>

Hometown: Hanover, Maryland</p>

<p>Mary Elizabeth Cole, valedictorian of UMBC’s class of 2012, is a true Renaissance scholar. She is a Humanities Scholar double-majoring in cultural anthropology and biology who has shined in both fields. Mary Beth has sought out a range of research opportunities at UMBC, gaining early experience in UMBC’s Ecology and Evolution Lab. This prepared her for more independent research at the National Institutes of Health. She later completed archaeological field and lab work at colonial and prehistoric American Indian sites in southern Maryland. Mary Beth creatively wove together her interests in cultural anthropology and biology through study abroad at the University of Kent in Canterbury, England, where she completed human osteology coursework to prepare for graduate school. She has been awarded a fellowship for the biological anthropology Ph.D. program at The Ohio State University, which focuses on the history and patterns of disease as discerned through skeletal remains. In addition to pursuing an academic career, Mary Beth hopes to assist military and archaeological groups on post-conflict skeletal recovery. Mary Beth has given back to her community by helping with local speech and debate tournaments for home-schooled teens; tutoring students in chemistry, math and SAT preparation; and participating in Scholar Selection Day and other prospective student events at UMBC.</p>

<p><em>"At prospective student events I attended, Dr. Hrabowski promised that as long as we worked hard to pursue our dreams, UMBC would do everything possible to transform our efforts into our successes. Throughout my four years, I have seen this university fulfill and exceed that promise in every way possible. The anthropology department, despite its small size, has recruited some of the most intelligent, insightful and encouraging minds in the country. My mentors there provided the education, guidance and endless recommendations that pointed me towards my dream of becoming a biological anthropologist. The biology department provided the coursework and experience that I needed to secure lab experience at UMBC and then NIH. Without these stepping stones to my NIH internship, I would not have discovered the bone histology that I hope to pursue in my doctoral program.” </em>
</p>

<p><iframe width="530" height="298" src="http://www.youtube.com/embed/WG4B9e7A5pA" frameborder="0" allowfullscreen></iframe>
</p>
        </li>

          <li style="background-color:#FFC;">

       <div class="pic" id="RWardlow"> 
        <<img src="images/photos/RobertWardlow.jpg" width="240" alt="Robert Wardlow, Salutatorian" >
        </div>
        <h3>Robert  Douglass Wardlow II</h3>
<p style="color:#333;"><strong>Plans: M.D./Ph.D., Johns Hopkins University</strong><br>
B.S., Biochemistry & Molecular Biology<br>
<em>Summa Cum Laude</em><br>
Hometown: Cherry Hill, New Jersey</p>

<p>As the salutatorian of the class of 2012, Robert Wardlow’s career at UMBC has been full of accomplishments. A Meyerhoff Scholar, Barry M. Goldwater Scholar, Howard Hughes Medical Institute Scholar and Rhodes Scholarship finalist, he has presented his research at 12 conferences and symposia, earning numerous awards. Robert’s research focuses on chemical signaling of heart cells and the potential of certain stem cells for providing therapeutic benefits for damaged cells. Excellence in scholarship is intimately connected to community service for Robert. He co-founded the student group Men Achieving Leadership, Excellence and Success (MALES) to promote community activism, leadership and academic excellence. Robert’s accomplishments have earned him admission into the Phi Beta Kappa, Phi Kappa Phi and Golden Key International honor societies, and he received the HHMI Gilliam Fellowship for Advanced Study.</p>

<p><em>“UMBC has provided an environment rich in resources that has helped me to develop to a level far beyond what I could have originally expected. I was able to display tremendous personal growth over the course of my time here both academically and socially. Courses were challenging, but the school offered more than enough support in terms of tutoring and advising to help me best deal with the load. I had numerous chances to further my research career by gaining experience in research labs both in the area and around the country. I have made friends here that will hopefully last long in to the future as well as meeting mentors that will continue to guide me in the right direction. UMBC has helped me in all facets of my personal and professional development and I hope that I will be able to give back to the school in some capacity in the future.”&lt;/em></p>

<p><iframe width="530" height="298" src="http://www.youtube.com/embed/BJXAazzRP10" frameborder="0" allowfullscreen></iframe>
</p>
 </li> 
```

如果有人对这里的完整代码有所帮助，我很乐意这样做。当它是一堆重复的元素时，只是不想有这么多的代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T15:34:19.557

试试这个**肮脏**的黑客，

```
var hash = location.hash;
location.hash = '';
location.hash = hash; 
```

在`window load`或`document.ready`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T15:32:55.230

当页面加载时，看起来`li`s 设置为，然后通过 JavaScript`display: none`更改为。`display: list-item`Chrome/IE 很可能会在加载 HTML 后立即尝试跳转到该块，但该块尚未显示。

我猜那是你的问题。这也是一个奇怪的设置，使用绝对定位的块（我认为那是 wookmark 插件？） - 似乎可以使用没有绝对定位的纯 CSS 完成相同的设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-17T11:25:27.983

这个：

```
$( "[href^=#]" ).click(function() {
    location.hash = $(this).attr("href")
}) 
```

为我工作。正如许多其他人提到的，这是 Chrome 中的一个错误。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-18T15:12:38.363

我认为目标代码没有锚

```
<a name="bioName"> 
```

更新

使用 ID 进行良好测试也可以，只是不在您的页面上。也许是内容

# python - 如何通过 Python urllib 将 JSON 数据发送到 Django 应用程序？

> ID：10654249
> 
> 赞同：1
> 
> 时间：2012-05-18T14:13:31.023
> 
> 标签：python, django, urllib

我正在尝试使用 python urllib 将 JSON 数据发送到我的 django Web 应用程序，但没有运气。这是我的代码；

Python应用程序：

```
url = "http://127.0.0.1:8000/web_app"
values = {'name':'Paul','age':12}
jdata = {'data':values}
data = urllib.urlencode(values)
req = urllib2.Request(url, data, {'Content-Type':'application/json'})
try:
   resp = urllib2.urlopen(req)
   the_result = resp.read()
except urllib2.HTTPError, e:
   return "Reques Failed!" 
```

我的 Django 网络应用程序：

```
@csrf_exempt
def web_app(request):
     print "In My webapp"   # This never get printed!
     data = request.POST['data']
     return HttpResponse("Thankyou...") 
```

该请求似乎没有命中 Django`web_app`函数，因为函数中的第一个打印没有执行！

补充：请注意，如果我从 urllib2.request 中的请求中删除数据，那么一切都会按预期工作！

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T15:50:53.537

你的 urlconf 是什么样的？如果它看起来像`'^web_app/$'`并且`APPEND_SLASH=True`在设置中，这是默认的，你需要使用`"http://127.0.0.1:8000/web_app/"`（注意后缀斜杠）。否则，如果没有匹配，Django 会尝试重定向`/web_app`到`/web_app/`，然后抱怨重定向`POST`请求。

此外，`'Content-Type':'application/json'`为 HTTP 请求设置它没有意义，您可以设置它并通过传递 JSON 转储字符串来打破[urllib2 的要求；](http://docs.python.org/library/urllib2.html#urllib2.urlopen)但是你应该`request.body`自己解析而不是使用`request.POST`. `application/json`通常用于指定`Content-Type`响应的。

# joomla - 2.5 中的 Joomla 模板

> ID：10654250
> 
> 赞同：1
> 
> 时间：2012-05-18T14:13:31.537
> 
> 标签：joomla, joomla-extensions, joomla-template

在我的新站点上安装了 joomla 2.5。我正在尝试使用 1.6 模板。它挂起。我们可以在新版本中使用旧模板吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T05:36:55.383

1.6应该不是问题，1.5会是。但是，如果 1.6 具有模板覆盖，则可能会出现问题，因为原始覆盖所基于的核心可能已从 1.6 更改为 2.5。否则 1.6-2.5 在模板方面基本上是相同的（尽管这里和那里可能存在错误）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:53:53.520

答案是否定的，但是您可以手动“转换”它们，但这会有点棘手，这是一个很长的教程[http://www.ostraining.com/blog/joomla/update-a-joomla-15-template/](http://www.ostraining.com/blog/joomla/update-a-joomla-15-template/) 或者，也许您可​​以通过在 2.5 中编写克隆代码来重新发明轮子……

# iphone - 更好的方法 - 为 iPad 应用程序使用数据库或 Web 服务

> ID：10654251
> 
> 赞同：0
> 
> 时间：2012-05-18T14:13:31.803
> 
> 标签：iphone, objective-c, ios, database, ipad

我正在编写一个 ipad 应用程序，我需要知道使用数据库或使用 Web 服务检索数据哪个更好。它的一些数据大约有 50-60 个图像和 50-60 个文本。不是很大。你有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:16:00.070

如果您需要离线访问，或者无法预测您的应用首次启动时用户是否在线，请使用本地数据库。

如果您可以假设用户在使用您的应用程序时会在线，并且更愿意将数据保持在“您的控制之下”并随时更新，请将您的数据保存在服务器上并使用网络服务来访问它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T16:11:51.077

鉴于您的数据量很少，我建议您将应用程序中的内容发送到本地（如果您问我，数据库是多余的：使用平面图像文件和 plist）。还实施一个系统作为您的应用程序的一部分，在线检查文件的较新版本，如果它们存在，它会下载它们并根据需要更新本地 plist。如果您正确设计 plist（plist 包含每个图像和文本片段的条目和版本），您甚至不需要网络服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T15:54:58.560

除了离线访问之外，本地数据库会更快，并且您不会破坏用户的数据限制。

# c# - c#内存泄漏system.timers

> ID：10654253
> 
> 赞同：2
> 
> 时间：2012-05-18T14:13:38.140
> 
> 标签：c#, memory, delegates, timer, memory-leaks

我目前正在编写一个与 I/O 设备交互的程序，并且需要一种每隔 x 秒轮询一次设备的方法，以检查输入/输出连接。为此，我使用了一个按钮，该按钮使用计时器和计时器事件句柄创建了一个线程来进行轮询。但是，我注意到在任务管理器中，随着时间的推移，它正在慢慢消耗更多的内存。下面是一些（我认为）与我的问题相关的代码片段。

创建线程的按钮：

```
private void btnConnect_Click(object sender, EventArgs e)
    {
        new Thread(start).Start();
    } 
```

包含计时器的线程：

```
 public void start()
    {
        timer = new System.Timers.Timer(1000);
        timer.Elapsed += new ElapsedEventHandler(timerElapsed);
        timer.Enabled = true;
    } 
```

ElapsedEventHandler：

```
public void timerElapsed(object sender, ElapsedEventArgs e)
    {
        connect();
    } 
```

最后是方法connect();：

```
public void connect()
    {
        StringBuilder sb = new StringBuilder();
        sb.Append(txtIPseg1.Text + "." + txtIPseg2.Text + "." + txtIPseg3.Text + "." + txtIPseg4.Text);
        int Port = int.Parse(txtPort.Text);
        string address = sb.ToString();

        //send data
        byte[] bData = new byte[71];
        bData[0] = 240;
        bData[1] = 240;
        bData[2] = 0;
        bData[3] = 1;
        bData[68] = 240;
        bData[69] = 240;
        bData[70] = this.CalculateCheckSum(bData);

        try
        {
            byte[] result = this.SendCommandResult(address, Port, bData, 72);
            if (result != null)
            {
                this.Invoke((MethodInvoker)delegate
                {
                    txtOutput1.Text = (result[4] == 0x00 ? "HIGH" : "LOW"); // runs on UI thread
                });
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.ToString());
        }

    } 
```

我很确定泄漏要么来自计时器，要么来自方法 connect(); 中使用的匿名委托，有人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:40:51.200

每次单击按钮时，您都会创建一个新计时器。此外，您没有保留对它的引用，因此它将被垃圾收集器销毁。无需在新线程上启动计时器，因为计时器将在新线程上引发 Elapsed 事件。

```
class Form1 ...
{
    private System.Timers.Timer timer = null;

    public void start()
    {
    if (timer == null)
        {
        timer = new System.Timers.Timer(1000);
        timer.Elapsed += new ElapsedEventHandler(timerElapsed);
        }
    timer.Enabled = true;
    }

    ...
} 
```

就内存泄漏而言，我不会仅仅因为您在应用程序运行时看到内存使用量看似随机波动就认为存在内存泄漏。当您在 .NET 等复杂框架中运行时，这是正常行为。每次计时器触发时，它都会调用您的 connect 方法来创建新对象。这些对象将保留在内存中，直到垃圾收集器开始清理它们。因此，看到内存慢慢上升，然后在几分钟后突然又下降，这并不奇怪。我不会怀疑有问题，除非它在更长的时间内不断失控。

您使用 StringBuilder 类的方式也很奇怪。你在做什么：

```
StringBuilder sb = new StringBuilder();
sb.Append(txtIPseg1.Text + "." + txtIPseg2.Text + "." + txtIPseg3.Text + "." + txtIPseg4.Text);
string address = sb.ToString(); 
```

没有比仅仅这样做更好（实际上它更糟）：

```
string address = txtIPseg1.Text + "." + txtIPseg2.Text + "." + txtIPseg3.Text + "." + txtIPseg4.Text; 
```

如果您正在寻找一种更有效且可能更易于阅读的方法，请尝试类似这样的方法

```
string address = string.Format("{0}.{1}.{2}.{3}", txtIPseg1.Text, txtIPseg2.Text, txtIPseg3.Text, txtIPseg4.Text); 
```

然而，没有什么东西会引起内存泄漏，所以除非你有充分的理由这样想，否则我不会担心。

# templates - 嵌套模板，查找父级

> ID：10654255
> 
> 赞同：3
> 
> 时间：2012-05-18T14:13:46.833
> 
> 标签：templates, nested, meteor

我有一系列嵌套对象。说...商店和物品。

我可能有 10 家商店，每家商店都有相同的 10 件商品，同时显示在屏幕上。

```
<template name='store'>
  {{#each items}}
   {{> item}}
  {{/each}}
</template>

<template name='item'>
  {{name}} {{qty}}
</template> 
```

我遇到的主要问题是尝试使用辅助函数确定 {{qty}} 。这是因为该项目本身没有“数量”，而是取决于它与哪个“商店”相关。所以我需要根据“商店”+“项目”找到数量。

搜索这个的“流星方式”是什么？是在 DOM 中存储一堆数据 -* 属性并通过 Jquery 搜索我的 mongdb _id 项目吗？我不认为 mustache 可以让您弄清楚您来自哪里并访问“父范围的变量”。它不像主干，我可以将父商店视图中的链接添加到子项目视图中。

我对使用会话变量感到不舒服，因为我担心这可能会导致竞争条件（例如 Session.get('current_store_id')）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T19:25:55.953

车把支持`../`路径，这可能会有所帮助：

[http://handlebarsjs.com/#paths](http://handlebarsjs.com/#paths)

# c++ - 获取毫秒部分时间

> ID：10654258
> 
> 赞同：16
> 
> 时间：2012-05-18T14:13:56.340
> 
> 标签：c++

我需要从计时器中获取毫秒

```
 // get timer part
    time_t timer = time(NULL);
    struct tm now = *localtime( &timer );
    char timestamp[256];

    // format date time
    strftime(timestamp, sizeof(timestamp), "%Y-%m-%d_%H.%M.%S", &now); 
```

我想在 C# 中得到这样的：

```
DateTime.Now.ToString("yyyy-MM-dd_HH.mm.ss.ff") 
```

我尝试使用 %f 或 %F 但它确实适用于 C++。如何从 tm 获得 %f 毫秒？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-18T14:29:32.503

```
#include <chrono>

typedef std::chrono::system_clock Clock;

auto now = Clock::now();
auto seconds = std::chrono::time_point_cast<std::chrono::seconds>(now);
auto fraction = now - seconds;
time_t cnow = Clock::to_time_t(now); 
```

然后您可以以秒精度打印出 time_t，然后打印分数代表的任何内容。可能是毫秒、微秒或其他。要专门获得毫秒：

```
auto milliseconds = std::chrono::duration_cast<std::chrono::milliseconds>(fraction);
std::cout << milliseconds.count() << '\n'; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-18T14:25:59.863

有函数gettimeofday()。以毫秒为单位返回时间检查这里：[http ://souptonuts.sourceforge.net/code/gettimeofday.c.html](http://souptonuts.sourceforge.net/code/gettimeofday.c.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-18T15:05:53.773

在 Windows 上使用 Win32 API [SYSTEMTIME 结构](http://msdn.microsoft.com/en-us/library/ms724950%28v=vs.85%29.aspx)会给你毫秒。然后，您应该使用[时间函数](http://msdn.microsoft.com/en-us/library/ms725473%28v=VS.85%29.aspx)来获取时间。像这样：

```
#include <windows.h>

int main()
{
    SYSTEMTIME stime;
    //structure to store system time (in usual time format)
    FILETIME ltime;
    //structure to store local time (local time in 64 bits)
    FILETIME ftTimeStamp;
    char TimeStamp[256];//to store TimeStamp information
    GetSystemTimeAsFileTime(&ftTimeStamp); //Gets the current system time

    FileTimeToLocalFileTime (&ftTimeStamp,&ltime);//convert in local time and store in ltime
    FileTimeToSystemTime(&ltime,&stime);//convert in system time and store in stime

    sprintf(TimeStamp, "%d:%d:%d:%d, %d.%d.%d",stime.wHour,stime.wMinute,stime.wSecond, 
            stime.wMilliseconds, stime.wDay,stime.wMonth,stime.wYear);

    printf(TimeStamp);

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-06-01T22:03:04.067

这是另一个 c++11 答案：

```
#include <iostream>
#include <iomanip>
#include <chrono>
#ifdef WIN32
#define localtime_r(_Time, _Tm) localtime_s(_Tm, _Time)
#endif

int main()
{
    tm localTime;
    std::chrono::system_clock::time_point t = std::chrono::system_clock::now();
    time_t now = std::chrono::system_clock::to_time_t(t);
    localtime_r(&now, &localTime);

    const std::chrono::duration<double> tse = t.time_since_epoch();
    std::chrono::seconds::rep milliseconds = std::chrono::duration_cast<std::chrono::milliseconds>(tse).count() % 1000;

    std::cout << (1900 + localTime.tm_year) << '-'
        << std::setfill('0') << std::setw(2) << (localTime.tm_mon + 1) << '-'
        << std::setfill('0') << std::setw(2) << localTime.tm_mday << ' '
        << std::setfill('0') << std::setw(2) << localTime.tm_hour << ':'
        << std::setfill('0') << std::setw(2) << localTime.tm_min << ':'
        << std::setfill('0') << std::setw(2) << localTime.tm_sec << '.'
        << std::setfill('0') << std::setw(3) << milliseconds
        << std::endl;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-18T14:25:19.040

你可以`boost::posix_time::ptime`上课。它[在那里的参考](http://www.boost.org/doc/libs/1_49_0/doc/html/date_time/posix_time.html#date_time.posix_time.ptime_class)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-18T16:04:20.333

我个人使用这个：[http ://wyw.dcweb.cn/time.htm](http://wyw.dcweb.cn/time.htm)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-28T07:36:06.963

在 MS Visual Studio c/c++ 下包括 sys/timeb.h 并使用 _ftime (_ftime_s)。检索包含 time_t 结构和毫秒的结构 _timeb (_ftime64)，请参阅 MSDN [http://msdn.microsoft.com/en-/library/z54t9z5f.aspx](http://msdn.microsoft.com/en-/library/z54t9z5f.aspx)

```
#include <sys/timeb.h>

struct _timeb timebuffer;
_ftime(&timebuffer);
timebuffer.millitm; //milli seconds
timebuffer.time; //the same like struct time_t 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-27T17:43:35.313

试试这个代码：

```
struct tvTime;

gettimeofday(&tvTime, NULL);

int iTotal_seconds = tvTime.tv_sec;
struct tm *ptm = localtime((const time_t *) & iTotal_seconds);

int iHour = ptm->tm_hour;;
int iMinute = ptm->tm_min;
int iSecond = ptm->tm_sec;
int iMilliSec = tvTime.tv_usec / 1000;
int iMicroSec = tvTime.tv_usec; 
```

# javascript - 将图像拖放到 Chrome 中的 contenteditable 到光标处

> ID：10654262
> 
> 赞同：4
> 
> 时间：2012-05-18T14:14:08.680
> 
> 标签：javascript, google-chrome, drag-and-drop, contenteditable

在 Firefox 中，如果我将图像从桌面拖到 contenteditable 字段中，它将作为 base64 嵌入到突出显示的光标位置。

JSFiddle：http: [//jsfiddle.net/zupa/YrwsS/](http://jsfiddle.net/zupa/YrwsS/)

现在在 Chrome 中，图像由浏览器打开（页面加载，在同一个小提琴中尝试）。

多亏了 HTML5，您可以捕获 drop 事件，并用它捕获图像。但是，如果我停止浏览器的默认行为，我就会不知道用户想要将它放在哪里。

你能建议一个解决方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T21:29:51.190

如果您可以获得放置位置的坐标（我认为这是可能的），您可以按如下方式进行（未经测试）。我假设您将放置位置的坐标相对于视口作为变量`x`，`y`并将放置的图像作为变量`img`：

演示：http: [//jsfiddle.net/KZqNj/](http://jsfiddle.net/KZqNj/)

代码：

```
var range;

// Try the standards-based way first
if (document.caretPositionFromPoint) {
    var pos = document.caretPositionFromPoint(x, y);
    range = document.createRange();
    range.setStart(pos.offsetNode, pos.offset);
    range.collapse();
    range.insertNode(img);
}
// Next, the WebKit way
else if (document.caretRangeFromPoint) {
    range = document.caretRangeFromPoint(x, y);
    range.insertNode(img);
}
// Finally, the IE way
else if (document.body.createTextRange) {
    range = document.body.createTextRange();
    range.moveToPoint(x, y);
    var spanId = "temp_" + ("" + Math.random()).slice(2);
    range.pasteHTML('<span id="' + spanId + '">&nbsp;</span>');
    var span = document.getElementById(spanId);
    span.parentNode.replaceChild(img, span);
} 
```

这将适用于最近的 WebKit、Opera 和 Mozilla 浏览器，尽管只有 Firefox 实现了`document.caretPositionFromPoint()`.

参考：

*   [http://dev.w3.org/csswg/cssom-view/#dom-document-caretpositionfrompoint](http://dev.w3.org/csswg/cssom-view/#dom-document-caretpositionfrompoint)

# php - 模型（参考）在控制器中表现异常

> ID：10654265
> 
> 赞同：0
> 
> 时间：2012-05-18T14:14:17.017
> 
> 标签：php, cakephp, cakephp-2.1, cakephp-model

我对 CakePHP 2.1.1 项目有一个奇怪的问题。
问题是，如果我在 Competition 模型上调用 find()（在下面的代码中），紧随其后我在另一个模型中调用自定义方法，操作将失败并出现以下错误：

```
Error: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'getAddedPlayersIds' at line 1

SQL Query: getAddedPlayersIds 
```

我的 CompetitionsController::view() 代码如下：

```
public function view($id = null) {
        $this->layout = 'competition';
        $this->Competition->id = $id;
        if (!$this->Competition->exists()) {
            throw new NotFoundException(__('Invalid competition'));
        }

        $active = $this->Competition->field('active', array('id' => $id));
        if (!$active) {
        $this->redirect(array('controller' => 'pages', 'action' => 'display', 'competition_inactive'));
        }
            //THIS IS WHERE IT BECOMES STRANGE:
        $competition = $this->Competition->find('first', array('conditions' => array('Competition.id' => $id)));

        $addedPlayersIds = $this->CompetitionsPlayer->getAddedPlayersIds($id);

            //SOME CODE INTENTIONALLY REMOVED HERE!!!       

        $this->set('playerShops', $playerShops);    
        $this->set('messages', $messages);
        $this->set('competition', $this->Competition->read(null, $id));
            //render() IS CALLED FOR A SPECIFIC REASON
        $this->render();
    } 
```

这是该`CompetitionsPlayer::getAddedPlayersIds()`方法的样子：

```
public function getAddedPlayersIds($competitionId = null){
        if(!isset($competitionId)) {
            return false;
        }

        $this->displayField = 'player_id';
        return $this->find('list', array('conditions' => array('competition_id' => $competitionId)));
    } 
```

我最初认为它会以某种方式破坏，因为我将 Model::find() 操作的返回分配给变量名，即“竞争”，但更有趣的是，如果我移动 Competition::find () 在 CompetitionsPlayer::getAddedPlayersIds() 之后调用它有效！
此外，如果我重命名变量，它有时会起作用，有时不会......！？
我仍然无法弄清楚这是什么时候，因为我目前没有时间进一步研究。请注意，根据调试信息，在数据库上执行的查询是：

```
getAddedPlayersIds 
```

这是我正在调用的函数的名称！

正如我所提到的，我已经知道解决方法 - 只需交换两个调用。但是如果第一个是在几秒钟之前并且没有其他方法来实现手头的任务怎么办？
我现在只想知道为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:43:30.687

事实证明，当使用`Model::field()`该函数的实现时，将递归设置为 -1 或 0。CakePHP 的核心代码是：

```
public function field($name, $conditions = null, $order = null) {
//Some code ommited
    if ($this->recursive >= 1) {
        $recursive = -1;
    } else {
        $recursive = $this->recursive;
    }
//Some code ommited
} 
```

因此，正如所解释的，这就是问题所在。我知道这是一种性能优化，但我不确定这是功能还是问题。对我来说，这是一种奇怪的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:37:11.703

这通常发生在它找不到您的模型并且 Cakephp 加载默认模型时，因此没有 getAddedPlayersIds 方法并且蛋糕认为它是一个神奇的查询。

这是我的建议，仔细检查您的文件名和路径。

我可以看到的一个可能的问题是这一行：

`$this->CompetitionsPlayer->getAddedPlayersIds($id);`

不应该是：

`$this->Competition->CompetitionsPlayer->getAddedPlayersIds($id);`

通过模型关联和链接。该模型是如何设置的？有哪些关系？

# java - 使用可视化虚拟机进行分析

> ID：10654270
> 
> 赞同：0
> 
> 时间：2012-05-18T14:14:30.313
> 
> 标签：java, profiling, visualvm

我有一个简单的 java 程序，其中包含不超过 10 个方法调用。我想使用可视虚拟机对其进行分析。请注意，我使用的是 linux。我尝试通过以下命令来做同样的事情。

```
sh visualvm_134/bin/visualvm & java cased/test/MainController 
```

我也尝试了如下命令。

```
java cased/test/MainController & sh visualvm_134/bin/visualvm 
```

但它没有在可视虚拟机中显示我的应用程序“MainController”。谁能告诉我我做错了什么？我是分析和可视化虚拟机的新手。我尝试使用带有 jibble miniwebserver 的可视 VM，它向我展示了合理的分析结果。但是我如何将它与java程序一起使用？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T18:25:57.360

您无法使用 VisualVM 分析应用程序启动。

请改用[NetBeans Profiler](http://profiler.netbeans.org/)，它基于与 VisualVM 相同的引擎，但也允许您对应用程序启动进行分析。

# vbscript - 如何仅将日期附加到具有 txt 扩展名的文件？

> ID：10654272
> 
> 赞同：0
> 
> 时间：2012-05-18T14:14:49.633
> 
> 标签：vbscript

几天后，你们帮我解决了我在以下代码中遇到的错误：

```
Set FSO = CreateObject("Scripting.FileSystemObject") 
Set fldr = FSO.GetFolder("C:\Ebooks\DRY\") 
curYr=Year(Now)
For Each fil In fldr.Files 
    If LCase( Right( fil.Name, 4 ) ) = ".zip" Then 
        zipFilePath = fil.Path 
        temp = file.Name 
        temp = Left( temp, LEN(temp) - 4 ) ' remove the .zip 
        temp = Split( temp, "_" ) ' split base name away from month-day-year 
        temp = (temp(ubound(temp))) ' get just month-day-year 
        temp = Split( temp, "-" ) ' get month day and year separately 
        mn = CINT(temp(0)) ' get the month number 
        dirName = MonthName(mn,True) & temp(2) ' True means get 3 letter abbrev for month 
        objZip.UnPack zipFilePath, "D:\ACS\Current\" 
        FSO.MoveFile zipFilePath, "D:\ACS\" & curYr & "\" & dirName & "\" & fil.Name       
    End If 
Next 
```

该脚本工作正常。所有解压缩的文件都被移动到名为 Current 的文件夹中，而原始 zip 文件被移动到文件夹 ACSCurrentYear。

解压后的文件有 2 个不同的扩展名，pdf 和 txt。

在星期一到星期五之间，代码每天都可以正常工作，我们将 txt 文件的内容提取到数据库中。

但是，在周末，由于txt文件同名，它们被覆盖，从而导致我们丢失数据。pdf 文件不会被覆盖，因为名称始终是唯一的。

我想做的是将当前日期和时间附加到仅具有 txt 扩展名的文件中。

我想我有代码可以做到这一点，但不知道如何将它集成到我上面发布的脚本中。

这是我想整合的一点。

```
strDay = Day(now)
strMonth = Month(now)
strYear = Year(now)

strHour = Hour(now)
strMinute = Minute(now)
strSecond = Second(now)

 datFinal = strYear & "/" & strMonth & "/" & strDay & " " & strHour & ":" & strMinute & ":" & strSecond 
```

'现在，将日期附加到任何带有 txt 扩展名的文件中。

```
 if lcase(FSO.GetExtensionName(fil.Name)) = "txt" then
  fil.Name = "datFinal.txt" 
```

我该如何处理？

更好的是，我可以在我发布的代码中添加一行代码以不允许覆盖 txt 文件吗？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T15:10:45.037

每天在“D:\ACS\Current\”下创建一个新的子文件夹，然后解压缩到该文件夹​​，如

```
date_folder = strYear & strMonth & strDay
FSO.CreateFolder ("D:\ACS\Current\" & date_folder)
objZip.UnPack zipFilePath, "D:\ACS\Current\" & date_folder 
```

或者

解压缩到一个临时文件夹并将那里的文件移动到“D:\ACS\Current\”，同时应用您的逻辑，这样它们就不会相互覆盖。

# backbone.js - Backbone.View 和 Backbone.Model 的实例太多

> ID：10654278
> 
> 赞同：4
> 
> 时间：2012-05-18T14:15:11.287
> 
> 标签：backbone.js, backbone-events, backbone-views

我有一个主视图，负责渲染其他视图…… 这是完整的代码 (1) (2) (3)。

当我第一次加载视图（View1、View2、View3）时，一切正常。
然后，如果我尝试重新加载视图来更改 this.options 显然它似乎没问题。
但我注意到有一些僵尸视图......，
我的意思是内存中以前视图的实例。
我使用这种和平的代码发现了这一点……</p>

```
View1 = Backbone.View.extend({
    initialize: function ()
    {
        this.model.on('change', function () {
            console.log(this.cid);
        }, this); 
    }
}); 
```

看着`cid`我发现每次我重新加载视图时都会生成具有不同 cid 的新视图并保留在内存中.. 示例

```
** first load **:
console.log(this.cid); // cid:12

** Second load **
console.log(this.cid); // cid:12
console.log(this.cid); // cid:13 
```

等等...

我的设计有什么问题？我该如何解决？

* * *

(1) 入口点

```
require([
    "js/mainApp"
    ], function(App){
        App.initialize(data.id);
}); 
```

* * *

(2) 主应用程序

```
define([
    "js/views/taskDetailView"
], function (TaskDetailView) {

    var initialize = function(task_id){

        var vent;

        vent = _.extend({}, Backbone.Events); // The Event Aggregator

        var taskDetailView = new TaskDetailView({
            task_id: task_id,
            vent: vent
        });

        $(".project-content").html(taskDetailView.$el);
    }

    return { 
        initialize: initialize
    };
}); 
```

* * *

(3)

```
define([
    "js/views/view1",
    "js/views/view2",
    "js/views/view3",
    "text!templates/Task/TaskDetailedView.html"
], function (View1, View2, View3, taskDetailedViewTemplate) {

    var TaskDetailView = Backbone.View.extend({

        el: $(".project-content"),

        initialize: function ()
        {
            this.render();
        },

        render: function ()
        {
            var options;
            // render from template and assign this.el to the root of the element
            // e.g .project-content
            this.setElement($(Mustache.render(taskDetailedViewTemplate)));
            this.view1 = new View1(_.extend( {el:this.$("#taskView")} , this.options));
            this.view2 = new View2(_.extend( {el:this.$("#feedView")} , this.options));
            this.view3 = new View3(_.extend( {el:this.$("#followerView")} , this.options));
        }
    });    

    return TaskDetailView;
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T15:08:31.613

您是否忘记实际从 DOM 中删除视图

[http://documentcloud.github.com/backbone/#View-remove](http://documentcloud.github.com/backbone/#View-remove)

仅将另一个视图分配给同一个元素不会删除前一个视图（一个视图可以引用同一个元素）。

**编辑**：

您可能想在重新分配视图之前尝试检查视图是否存在

```
 render: function ()
    {
        var options;
        // render from template and assign this.el to the root of the element
        // e.g .project-content

     if (this.view1 != null) {
       this.view1.remove();
      }

     //the rest of your code 
```

**编辑2**：

我不知道你的 mainApp 是如何被第二次调用的，但也许你可能想尝试让它保持对 TaskDetailsView 的引用

一种尝试方法是在分配新的 TaskDetailsView 之前清理现有的

```
 if (this._taskDetailsView != null) { 
     this._taskDetailsView.cleanUp().remove(); 
    }

 var taskDetailView = new TaskDetailView({
            task_id: task_id,
            vent: vent
  });
    this._taskDetailsView = taskDetailView; 
```

更好的方法可能只是刷新视图的必要部分

```
define([
    "js/views/taskDetailView"
], function (TaskDetailView) {

    var _taskDetailView;
    var initialize = function(task_id){

        var vent;

        vent = _.extend({}, Backbone.Events); // The Event Aggregator

        if (this._taskDetailsView == null) { 
        var taskDetailView = new TaskDetailView({
            task_id: task_id,
            vent: vent
        });
          this._taskDetailsView = taskDetailView;
        } else {
            this._taskDetailsView.refresh({task_id: task_id,
              vent: vent
           });

          }
        $(".project-content").html(taskDetailView.$el);
    }

    return { 
        initialize: initialize
    };
}); 
```

# javascript - 表格：选定的行并循环遍历列 JQuery&JavaScript

> ID：10654279
> 
> 赞同：0
> 
> 时间：2012-05-18T14:15:13.063
> 
> 标签：javascript, jquery

我有两个问题:)

1.  我使用 Jquery 在第一列中选​​择表格行和复选框，我怎样才能使 2 和 7 列不可点击。我的意思是，如果您单击 7 列的单元格，它将不会选择复选框，也不会添加“选定”类。

    ```
    $('#tableID tbody tr')
        .filter(':has(:checkbox:checked)')
        .addClass('selected')
        .end()
        .click(function (event) {
            $(this).toggleClass('selected');
            if (event.target.type !== 'checkbox') {
                $(':checkbox', this).attr('checked', function () {
                    return !this.checked;
                });
            }
        }); 
    ```

2.  我正在使用 JavaScript 添加所有一列值，当表格没有合并单元格时，脚本工作正常。如何使它与合并的单元格一起工作。

```
_________                             _________
|_|_|_|_|                             |   |_|_|
|_|_|_|_|    script working           |___|_|_|     script doesn't work
|_|_|_|_|                             |_|_|_|_|
|_|_|_|_|                             |___|_|_|
```

```
function count() {

    var i;
    var sum=0;
    var table = document.getElementById("tableID");
    for (i=1;i<table.rows.length-1;i++) {
        sum += Number(table.rows[i].cells[3].innerHTML, 10);
    }
    document.getElementById('sum1').innerHTML = sum;
} 
```

第二部分的HTML代码：http: [//jsfiddle.net/f4zH9/](http://jsfiddle.net/f4zH9/)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:48:14.070

对于第一部分，我找到了解决问题的不同方法：

```
$('#tableID tbody tr').each(function() {
    $('td', $(this)).click(function() {
        var index = $(this).index();
        if(index != 1 && index != 6) {
             $(this).parent().toggleClass('selected');
            if (event.target.type !== 'checkbox') {
                $(':checkbox', $(this).parent()).attr('checked', function () {
                    return !this.checked;
                });
            }
        }
    });
});​ 
```

这会将 click 事件绑定到每个单元格，并且当用户单击并检查单元格的索引时，有效地检查您正在单击的列。如果索引是 1 或 6（第 2 或第 7 列），则它什么也不做。这是一个 jsfiddle 来展示它：http: [//jsfiddle.net/cchana/vCVwv/2/](http://jsfiddle.net/cchana/vCVwv/2/)

对于您问题的第二部分，您的 for 循环存在问题，而不是：

```
for (i=1;i<table.rows.length-1;i++) 
```

不要忘记 JavaScript 从 0 开始计数，你应该有

```
for (i=0;i<table.rows.length;i++) 
```

创建了一个 jsfiddle 来展示它：http: [//jsfiddle.net/cchana/WRtZP/](http://jsfiddle.net/cchana/WRtZP/)

# entity-framework - EF4 ObjectStateManager 不报告更改？

> ID：10654280
> 
> 赞同：1
> 
> 时间：2012-05-18T14:15:14.327
> 
> 标签：entity-framework, entity-framework-4, self-tracking-entities, objectstatemanager

我正在尝试使用 EF4（数据库优先）在上下文级别实现更改审计系统。我正在覆盖`SaveChanges`和捕获状态为`Added`、`Deleted`或`Modified`来自上下文的`ObjectStateManager`. 这通常有效，但我遇到了一个问题，即没有一个实体具有这种状态（包括我在代码中更改的实体），但上下文*确实*对数据库进行了更改。我已经查看`Unchanged`了状态为状态的条目列表，而我修改后的实体在该列表中。

我能看到的唯一复杂情况是我正在使用自我跟踪实体（因为这是一个 WCF 服务，通常将这些 STE 发送到客户端进行更改，然后客户端将修改后的 STE 备份以保持更改） . **似乎正在发生的事情是在服务器上检索并直接在那里修改（而不是传递给客户端并使用 STE `ObjectChangeTracker`）的对象没有被标记为`Modified`**. 这是正常/预期的行为吗？如果是这种情况，那么显然上下文正在使用除 之外的*其他*`ObjectStateManager`内容来确定哪些更改要持久保存到数据库，因为*正在进行*更改。

如何检测这些变化并跟踪它们？有谁知道上下文用于跟踪更改的是什么？我一直认为它是`ObjectStateManager`，但似乎并非如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:56:10.347

原来问题出在`saveOptions`. 由于这些选项（默认情况下）包括`DetectChangesBeforeSave`，因此上下文在内部调用`DetectChanges`，它拾取修改并正确设置`ObjectStateEntry`. 通过将其添加到我的审计例程中：

```
if ((options & SaveOptions.DetectChangesBeforeSave) == 
               SaveOptions.DetectChangesBeforeSave)
{
    DetectChanges();

    options ^= SaveOptions.DetectChangesBeforeSave;
} 
```

它现在可以正常工作。

# php - mysql搜索不带空格

> ID：10654283
> 
> 赞同：2
> 
> 时间：2012-05-18T14:15:33.813
> 
> 标签：php, mysql

我的数据库中有一个名称列表，我必须找到我在 url 中传递的名称的 id。

我的问题是我在 url 中传递的名称中没有空格，而保存的记录将在数据库中。当我搜索数据库时，我没有找到任何记录。

例如，数据库记录是“我的名字”，而我将在 url 中传递和搜索的是“我的名字”

```
if(isset($_GET["name"])) $name = $_GET["name"];

SELECT id
FROM table
WHERE name Like '%$name%' 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T14:42:22.117

```
// id don't know the exact syntax, but this is what you are searching for I guess:

// replace spaces with nothin temporarily, then check equal (=) not like (%%) if name is exactly the same (except the spaces)

SELECT id, REPLACE(name, ' ', '') AS tmp FROM table WHERE tmp='%$name%' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T14:22:42.407

显然不是存储或搜索的正确方法，但如果必须，请尝试用空格替换空格，如下所示：

```
SELECT id
FROM table
WHERE REPLACE(`name`,' ','') LIKE '%$name%' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T14:18:44.317

我认为最佳做法是存储另一列，称为 name_nospaces 并在插入 My Name 记录时将 myname 作为计算值插入其中。您还可以创建一个包含 myname 作为列的视图并对其进行查询，但原始表中另一列的优点是可以对其进行索引以便快速检索。

# c++ - 为什么要使用非阻塞或阻塞套接字？

> ID：10654286
> 
> 赞同：44
> 
> 时间：2012-05-18T14:15:48.340
> 
> 标签：c++, sockets, winsock

首先，我必须问哪个州最好？例如实时 MMORPG 服务器。如果我为每个客户端创建一个线程而不是使用非阻塞套接字怎么办？或者如果我使用一个包含所有非阻塞套接字的线程怎么办？你能解释一下优点吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-05-18T14:19:36.623

您的问题值得更长的讨论，但这里有一个简短的答案：

*   使用阻塞套接字意味着在任何一个线程中任何时候都只能有一个套接字处于活动状态（因为它在等待活动时会阻塞）
*   使用阻塞套接字通常比非阻塞套接字更容易（异步编程往往更复杂）
*   如您所述，您可以为每个套接字创建 1 个线程，但与非阻塞解决方案相比，线程有开销并且效率极低；
*   使用非阻塞套接字，您可以处理更多的客户端：它可以在单个进程中扩展到数十万个 - 但代码变得有点复杂

使用非阻塞套接字（在 Windows 上），您有几个选项：

*   轮询
*   基于事件
*   重叠 I/O

重叠 I/O 将为您提供最佳性能（数千个套接字 / 进程），但代价是要成为正确理解和实现的最复杂的模型。

基本上它归结为性能与编程复杂性。

*笔记*

这里有一个更好的解释为什么使用线程/套接字模型是一个坏主意：

在 Windows 中，创建大量线程非常低效，因为调度程序无法正确确定哪些线程应该接收处理器时间，哪些不应该。这与每个线程的内存开销相结合，意味着您将在操作系统级别耗尽内存（因为堆栈空间）和处理器周期（因为管理线程的开销），而在处理套接字连接的容量不足之前很久.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-18T15:25:36.543

我将继续记录在案，除了玩具程序之外的*几乎*任何东西，您当然应该使用非阻塞套接字。

阻塞套接字会导致一个严重的问题：如果另一端的机器（或与它的连接的任何部分）在阻塞调用期间发生故障，您的代码将最终被阻塞，直到 IP 堆栈超时。在典型情况下，大约需要 2 分钟，这对于大多数用途来说是完全不可接受的。中止阻塞调用的唯一方法¹是终止产生它的线程——但终止线程本身几乎总是不可接受的，因为在它之后清理并回收它分配的任何资源基本上是不可能的。非阻塞套接字使得在需要时/如果需要中止调用变得微不足道，*而无需*对进行调用的线程做任何事情。

*如果*您改用多进程模型，则可以使阻塞套接字工作得很好。在这里，您只需为每个连接生成一个全新的进程。该进程使用阻塞套接字，当/如果出现问题时，您只需终止整个进程。操作系统知道如何清理进程中的资源，因此清理不是问题。但是它仍然存在其他潜在问题：1）您几乎需要一个进程监视器来在需要时终止进程，以及 2）产生一个进程通常比仅仅创建一个套接字要昂贵得多。尽管如此，这可能是一个可行的选择，尤其是在以下情况下：

1.  您一次处理少量连接
2.  您通常对每个连接进行大量处理
3.  您只与本地主机打交道，因此您与它们的连接快速且可靠
4.  你更关心优化开发而不是执行

* * *

^(1\. 好吧，从技术上讲不是*唯一*可能的方法，但大多数替代方案都比较难看——更具体地说，我认为当你添加代码找出问题所在，然后解决问题时，你'与只使用非阻塞套接字相比，你可能做了更多的额外工作。)

# ruby-on-rails - state_machine 状态的翻译

> ID：10654291
> 
> 赞同：1
> 
> 时间：2012-05-18T14:16:03.050
> 
> 标签：ruby-on-rails, internationalization

我在 ActiveRecord 中使用[pluginaweek 的 state_machine](https://github.com/pluginaweek/state_machine)进行测试管理。我通过此调用检索所有可能状态的数组：

```
irb(main):013:0> Tester.state_machine.states.map &:name
=> [:candidate, :contract_sent, :contract_received, :contract_wont_return, :active, :retired] 
```

现在，我不想使用 meta_search 构建搜索表单来检索具有特定状态的测试人员。我想使用一个选择：

```
- states = {}; Tester.state_machine.states.map(&:name).each{ |e| states[t(e.to_s)] = e }
= form.input :state_equals, :as => :select, :collection => states 
```

它可以工作，但不是很好，因为我构建了一个新的哈希并翻译了每个元素。此外，翻译必须插入两次，因为我的解决方案不使用[state_machine 的 I18n yaml 结构](https://github.com/pluginaweek/state_machine/issues/114)...

有没有类似的方法

```
Tester.state_machine.states.map(&:human_state_name) 
```

或者

```
Tester.state_machine.human_states_name.map(&:name) 
```

获得翻译状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T12:08:38.670

我找到了解决方案。您可以通过以下方式获得 state_mache 状态的翻译：

```
- states = {}; Tester.state_machine.states.map() { |s| states[s.human_name] = s.name }
= form.input :state_equals, :as => :select, :collection => states 
```

# c# - 从哈希集中获取随机元素？

> ID：10654292
> 
> 赞同：11
> 
> 时间：2012-05-18T14:16:03.487
> 
> 标签：c#, hashset

我使用以下代码将我的文本文件加载到**hashset**中。

```
HashSet<string> hashs = new HashSet<string>(File.ReadLines("textFile.txt")); 
```

想知道是否有任何简单的方法可以从中获取随机线？

让我们假设 textFile.txt 包含 10 行，我想随机化并抓取其中一个现有的行。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-04-11T22:34:58.043

无需每次都枚举整个数组，就可以像接受的那样简单的答案：

```
private static readonly Random     random  = new Random();
private static readonly HashSet<T> hashset = new HashSet<T>();

...

T element = hashset.ElementAt(random.Next(hashset.Count)); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-18T14:31:15.407

```
Random randomizer = new Random();
string[] asArray = hashs.ToArray()
string randomLine = asArray[randomizer.Next(asArray.length)]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-18T14:24:07.357

您可以生成一个介于 0 和集合大小之间的随机数，然后遍历集合，直到找到索引与生成的数字相同的项目。然后选择此项作为随机元素

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-18T14:25:08.217

或者对于任何可枚举的更通用的解决方案

```
public static class RandomExtensions
{
    private static readonly Random rnd = new Random();
    private static readonly object sync = new object();

    public static T RandomElement<T>(this IEnumerable<T> enumerable) {
        if (enumerable == null)
            throw new ArgumentNullException("enumerable");

        var count = enumerable.Count();

        var ndx = 0;
        lock (sync) 
            ndx = rnd.Next(count); // returns non-negative number less than max

        return enumerable.ElementAt(ndx); 
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-06-03T10:27:34.007

如果您计划绘制多个随机值，有效的方法是使用带有整数键的字典来存储信息。

```
HashSet<string> hashs = new HashSet<string>();
Dictionary<int, string> lookup = new Dictionary<int, string>();
foreach (string line in File.ReadLines("textFile.txt")) {
    if (hashs.Add(line)) {
        lookup.Add(lookup.Count, line);
    }
}

int randomInt = new Random().Next(lookup.Count);
string randomLine = lookup[randomInt]; 
```

（在此示例中，您可以使用 List 代替，但使用字典也可以删除单个元素而不影响顺序）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-19T07:40:49.823

从 .Net Framework 3.5 开始，您可以使用 Linq 及其[`Enumerable.First()`](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.first)扩展方法。在不指定任何条件作为参数的情况下，此方法将返回

> 序列的第一个元素。

您应该考虑使用`Enumerable.First()`要求您`HashSet<>`至少包含一个元素。要检查此前提条件，您可以使用`HashSet<>.Count`或通过 Linq[`Enumerable.Any()`](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.any)再次使用而不指定条件。

```
HashSet<T> hashSet = new HashSet<T>();

...

if(hashSet.Any())
{
  T randomElement = hashSet.First()
} 
```

作为上述方法的替代方法，[`Enumerable.FirstOrDefault()`](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.firstordefault)如果您想在`HashSet<T>`为空的情况下检索任何默认值，您可以使用该方法。

```
T randomElement = hashSet.FirstOrDefault(default(T)); 
```

# symfony - Symfony2 表单事件监听器可以访问服务容器吗？如何访问？

> ID：10654294
> 
> 赞同：13
> 
> 时间：2012-05-18T14:16:05.920
> 
> 标签：symfony

根据标题，Symfony2 表单事件监听器可以访问服务容器吗？

这是一个示例事件监听器（用于绑定后事件）：

```
class CustomerTypeSubscriber implements EventSubscriberInterface
{

    public static function getSubscribedEvents()
    {
        return array(FormEvents::POST_BIND => 'onPostBind');
    }

    public function onPostBind(DataEvent $event)
    {
        // Get the entity (Customer type)
        $data = $event->getData();

        // Get current user
        $user = null;    

        // Remove country if address is not provided
        if(!$data->getAddress()) :
            $data->setCountry(null);
        endif;
    }

} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-18T16:13:24.347

您需要访问服务容器做什么？

您可以使用依赖注入将任何服务注入到您的侦听器中（当您将侦听器定义为服务时，对吗？）。

您应该能够执行以下操作：

```
 service.listener:
    class: Path\To\Your\Class
    calls:
      - [ setSomeService, [@someService] ]
    tags:
      - { [Whatever your tags are] } 
```

在你的听众中：

```
private $someService;

public function setSomeService($service) {
    $this->someService = $someService;
} 
```

其中 someService 是您要注入的任何服务的 ID。

如果你愿意，你可以使用@service_container 注入服务容器，但最好只注入你需要的东西，因为我认为让所有容器都知道会让你有点懒惰。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-02T08:17:19.270

我认为表单订阅者的工作方式与常规事件监听器有点不同。

在您的控制器中，您正在实例化您的表单类型，即

```
$form = $this->createForm(new CustomerType(), $customer); 
```

由于容器在您的控制器中可用，您可以将它直接传递给您的表单类型，即

```
$form = $this->createForm(new CustomerType($this->container), $customer); 
```

在我的情况下，我需要安全上下文，所以我的实现（与你原来的 q 相似但略有不同）：

在我的控制器中：

```
$form = $this->createForm(new CustomerType($this->get('security.context')), $customer)); 
```

在我的表单类中：

```
use Symfony\Component\Security\Core\SecurityContext;
class CustomerType extends AbstractType
{
    protected $securityContext;

    public function __construct(SecurityContext $securityContext)
    {
        $this->securityContext = $securityContext;
    }

    public function buildForm(FormBuilder $builder, array $options)
    {
        // Delegate responsibility for creating a particular field to EventSubscriber
        $subscriber = new CustomerAddSpecialFieldSubscriber($builder->getFormFactory(), $this->securityContext);
        $builder->addEventSubscriber($subscriber);
        $builder->add( ... the rest of my fields ... );
    }

    // other standard Form functions
} 
```

在我的表单订阅者中

```
use Symfony\Component\Security\Core\SecurityContext;
CustomerAddSpecialFieldSubscriber
{
    private $factory;

    protected $securityContext;

    public function __construct(FormFactoryInterface $factory, SecurityContext $securityContext)
    {
        $this->factory = $factory;
        $this->securityContext = $securityContext;
    }

    public static function getSubscribedEvents()
    {
        return array(FormEvents::PRE_SET_DATA => 'preSetData');
    }

    public function preSetData(DataEvent $event)
    {
        if (true === $this->securityContext->isGranted('ROLE_ADMIN')) {
            // etc
        }
    }

} 
```

希望能帮助到你。

# c# - 为什么 IEnumerable.Where 方法允许使用可以更改数据的谓词？

> ID：10654300
> 
> 赞同：3
> 
> 时间：2012-05-18T14:16:27.653
> 
> 标签：c#, linq

我正在寻找关于为什么允许编译以下代码行的解释：

```
var results = someCollection.Where(x => x.SomeBooleanProperty = true); 
```

注意使用单个相等运算符（可能开发人员处于 SQL 模式），这是一个很容易犯的错误。这会编译并在评估结果时（例如`someCollection.ToList()`）将整个集合上的标志更改为 true！

如果您正在使用实体框架或任何其他 ORM，那么这可能会被检测为更改。我刚刚在生产代码中遇到了这个问题，但幸运的是它只是在只读屏幕上引起了一个小问题（但完全令人困惑）。试想一下，如果数据实际上是持久的，那么可能会导致可怕的逻辑和数据问题。

只是为了确保我没有发疯并且它确实改变了我编写的测试失败的数据：

```
[Test]
public void Test_because_im_scared()
{
    var falseProperty = new TestModel {BooleanProperty = false};
    var trueProperty = new TestModel {BooleanProperty = true};

    var list = new List<TestModel>{falseProperty, trueProperty};

    var results = list.Where(x => x.BooleanProperty = true);

    Assert.IsFalse(falseProperty.BooleanProperty);
    Assert.IsTrue(trueProperty.BooleanProperty);

    //all fine so far, now evaluate the results
    var evaluatedResults = results.ToList();

    Assert.IsFalse(falseProperty.BooleanProperty);  //test fails here!
    Assert.IsTrue(trueProperty.BooleanProperty);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T14:19:26.780

`=`操作员实际上做了两件事：

*   将左侧的字段/属性设置为右侧的值。
*   返回新分配的值。

这也是为什么这样的陈述有效的原因：

```
object item;
while ((item = getItem()) != null)   
  processItem(item); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T14:20:19.490

```
x => x.SomeBooleanProperty = true 
```

这个 lambda 表示 - 对于 x，分配`true`给`SomeBooleanProperty`。赋值的结果也是值`true`。

如果将其更改为：

```
x => x.SomeBooleanProperty 
```

lambda 表示 - 对于 x 返回 的值`SomeBooleanProperty`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-18T14:19:31.943

它编译是因为它是一个有效的`Func<T, bool>`. 在这种情况下，编译器无法告诉它，它不应该允许这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T14:29:36.577

看起来问题与以下事实有关

```
x => x.BooleanProperty = true 
```

计算结果为真，因此是有效的 where() 谓词

我用整数尝试过，并且能够得到相同的行为。

```
[TestMethod]
public void Test_because_im_scared() {
    var falseProperty = new TestModel { BooleanProperty = false };
    var trueProperty = new TestModel { BooleanProperty = true };

    var list = new List<TestModel> { falseProperty, trueProperty };

    var results = list.Where(x => (x.IntProperty = 17) == 17) ;

    Assert.IsTrue(list.All(itm => itm.IntProperty == 0));

    //all fine so far, now evaluate the results 
    var evaluatedResults = results.ToList();

    Assert.IsTrue(list.All(itm => itm.IntProperty == 0)); // fails here, all 17

}

private class TestModel {
   public bool BooleanProperty { get; set; }
   public int IntProperty { get; set; }
} 
```

AFAIK 这是意外的行为， IEnumerable<> 扩展应该都返回新的枚举并且不改变原来的，但我没有看到任何地方都能保证。

看起来它可以用作伪 foreach() 但我不推荐它：-/

艾伦。

# templates - 我在哪里可以找到 wiki 中使用的信息框模板？

> ID：10654303
> 
> 赞同：1
> 
> 时间：2012-05-18T14:16:45.140
> 
> 标签：templates, mediawiki, wikipedia

在转储中，维基百科中使用的信息框模板位于...

如果它在 templatelinks.sql 中，请帮助我继续并解析 sql .. 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T00:12:19.533

如果要将信息框的参数映射到它们显示的名称，则需要查看信息框的代码。

例如，您提到`birth_date`的[Template:Infobox 科学家](http://en.wikipedia.org/wiki/Template%3aInfobox_scientist)的参数是这样映射的：

```
|label1  = Born
|data1   = {{br separated entries|{{{birth_name|}}}|{{{birth_date|}}}|{{{birth_place|}}}}} 
```

如您所见，映射并不那么容易，因为它使用另一个模板（[Template:br 分隔条目](http://en.wikipedia.org/wiki/Template%3abr_separated_entries)）并与其他参数（`birth_name`和`birth_place`）交互。此外，并非所有信息框都必须遵循此约定（基于[Template:Infobox](http://en.wikipedia.org/wiki/Template%3aInfobox)）。

如果您想从转储中获取模板的文本，它位于`pages-articles`XML 格式的文件中。但是，如果您只想为几个信息框执行此操作，那么使用[API](https://www.mediawiki.org/wiki/API)可能是一个更好的主意，因为转储文件很大并且处理它可能需要相对较长的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T21:39:32.270

转储只是一个转储，它不解释或记录东西。正如 svick 所说，您必须查看模板的代码，该代码位于 Template: 命名空间中。使用完整转储或带有文章、模板等的转储来包含它。

# cuda - 关于CUDA延迟隐藏机制和共享内存的问题

> ID：10654304
> 
> 赞同：0
> 
> 时间：2012-05-18T14:16:46.263
> 
> 标签：cuda, shared-memory

我知道要使 CUDA 程序高效，我们需要启动足够多的线程来隐藏昂贵操作的延迟，例如全局内存读取。例如，当一个线程需要从全局内存中读取时，其他线程将被调度运行，以便读取操作与线程的执行重叠。因此，一个 CUDA 程序的总执行时间只是每个线程执行时间的总和，不包括读取全局内存的时间。但是，如果我们可以把数据放到共享内存中，让线程从共享内存中读取，通常可以让CUDA程序运行的快很多。我的困惑是，由于内存读取的时间是隐藏的，它不应该影响程序的性能。为什么它仍然会对程序的性能产生如此大的影响？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-01-25T06:40:46.427

非常简短的回答是，仅仅使用共享内存的行为不会带来性能提升。

从全局内存读取到共享内存，然后从共享内存读取的行为 - 这是问题中描述的 - 对性能没有任何好处，并且是一个常见的误解（主要是编程指南的错误，它说共享内存比全局更快，因此得出使用它是灵丹妙药的结论）。

共享内存可以帮助提高性能的唯一方法是促进对全局内存的读取或写入的合并（减少内存事务，提高缓存一致性），或者线程之间的数据共享或重用（节省内存带宽），或者作为比线程本地内存存储在 DRAM 中。

[此答案从评论中收集并添加为社区 wiki 条目，以将问题从未回答列表中删除]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-02T12:26:40.130

如果对全局内存的请求过多，最终所有线程将主要等待来自它的数据（或完成写入），因此没有人能够隐藏它的延迟和带宽不足。

共享内存有助于减少对全局内存的读取/写入，这在上述情况下特别有用（这实际上是典型的而不是偶然的）。

> CUDA 程序的总执行时间只是每个线程执行时间的总和

不！这是第一个线程开始和最后一个线程完成之间的时间。

# linux - linux中的unix2dos等价物

> ID：10654306
> 
> 赞同：4
> 
> 时间：2012-05-18T14:16:56.170
> 
> 标签：linux, unix, migration

我计划将使用 C/C++ 编码并在 UNIX 上运行的应用程序迁移到 Linux Suse 11.1。我有一些使用 unix2dos 的地方。我知道翻转是 linux 中 unix2dos 的替代品。请让我知道在 linux 上使用翻转作为 unix2dos 等效项是否有任何风险？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-15T23:18:32.537

CentOS 不再将它包含在默认发行版中，但随时可用。

命令：

```
yum install unix2dos 
```

你也可以安装它的镜像，dos2unix

```
yum install dos2unix 
```

出于某种原因，在发行版上节省 35k 空间非常重要，因此我们可以像这样继续更新线程。

:| 有一个编辑的日子。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T23:43:38.037

我知道的大多数 Linux 发行版都`unix2dos`包括`dos2unix`. `tofrodos`从 Ubuntu 10.04 开始，这些实用程序已从默认安装中删除，但可以通过使用以下命令安装到包中轻松添加。

`sudo aptitude install tofrodos`

迄今为止，Red Hat 和它的非品牌 CentOS 表亲一直都包含这些实用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-16T08:33:39.340

在 Ubuntu 上，dos2unix 位于 Universe 存储库中。sudo apt-get install dos2unix

另请参阅[http://packages.ubuntu.com/cgi-bin/search_packages.pl?keywords=dos2unix&searchon=names&version=all&release=all](http://packages.ubuntu.com/cgi-bin/search_packages.pl?keywords=dos2unix&searchon=names&version=all&release=all)

Linux Mint：http: [//community.linuxmint.com/software/view/dos2unix](http://community.linuxmint.com/software/view/dos2unix)

翻转的风险是您可能会将 Unix 换行符转换为 DOS 换行符，而您的预期恰恰相反。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-18T14:19:08.353

Linux 确实有`unix2dos`和`dos2unix`.

# visual-studio-2010 - SSIS - SQL Server 2005 和 Visual Studio 2010

> ID：10654311
> 
> 赞同：2
> 
> 时间：2012-05-18T14:17:07.357
> 
> 标签：visual-studio-2010, sql-server-2005, ssis

我是 SSIS 的新手，之前曾在 DTS 上工作过。目前，我有一个 ASPX 项目，它使用水晶报表来呈现一些报表。

我正在将来自各种数据源的数据建模到一个 sql 服务器中。作为其中的一部分，我有一个复杂的 Excel 文件，需要映射到 SQL Server 中。

我打算使用 SSIS。现在，我相信 VS2010 没有 SSIS 项目。

有人可以帮我开始吗？我需要为此设置什么环境？我在哪里可以找到 Visual Studio 的插件？

我感谢您的支持。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T15:55:09.353

您是正确的，Microsoft 没有为 VS 2008 以上的任何版本发布 BIDS 升级。但是，为了创建 SSIS 包，您必须使用 SQL 管理工具附带的 VS 版本。所以 SQL 2005 将安装 VS 2005 BIDS。正如[迭戈](https://stackoverflow.com/a/10654425/847990)已经提到的那样。

如果您的计算机上已经安装了 VS 2010，您可能会遇到的问题是，安装较低版本的 VS 往往会使事情在较高版本中停止工作。因此，BIDS 将安装 VS 2005，它有可能会弄乱您的 VS2010 安装。这样做时我得到了不同的结果，但如果确实发生了，你可能只需要重新运行 VS2010 的安装来修复任何搞砸的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T14:19:30.163

[商业智能开发工作室](http://en.wikipedia.org/wiki/Business_Intelligence_Development_Studio)

是唯一可以使用 Visual Studio IDE 编辑 SSIS 的地方

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:23:51.160

如果您的 SSIS 包适用于 SQL Server 2005，则需要使用 BIDS for Visual Studio 2005。如果它们适用于 SQL Server 2008，则 BIDS for Visual Studio 2008 等等

# android - 访问 com.google.android.maps.ItemizedOverlay ？附加源

> ID：10654313
> 
> 赞同：0
> 
> 时间：2012-05-18T14:17:10.480
> 
> 标签：android

我得到了这个错误。

```
05-18 13:15:16.450: E/AndroidRuntime(524):  at com.google.android.maps.ItemizedOverlay.populate(ItemizedOverlay.java:311) 
```

我可以访问此代码以便查看问题所在吗？com.google.android.maps.ItemizedOverlay 在哪里？

我在包资源管理器的 Eclipse 中找到它：

```
Google APIs [Android 2.2] -> maps.jar -> com.google.android.maps -> ItemizedOverlay.class 
```

但随后显示未找到源...您可以通过单击下面的附加源来附加源：

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T15:26:34.687

遗憾的是，mapview 不是开源的，因此您无法访问它（因此，为什么 'android' 和带有 'google APIs' 的 android 是不同的目标平台。前者是开源的，后者添加了封闭源 google APIs比如谷歌地图）。

发布您的代码，以便我们查看。

# jquery-mobile - 防止 JqueryMobile SimpleDialog 缓存

> ID：10654314
> 
> 赞同：0
> 
> 时间：2012-05-18T14:17:12.550
> 
> 标签：jquery-mobile

标题：

```
 <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
    <link rel="stylesheet" href="my.css" />
        <link rel="stylesheet" type="text/css" href="http://dev.jtsage.com/cdn/simpledialog/latest/jquery.mobile.simpledialog.min.css" /> 

    <style>
        /* App custom styles */
    </style>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js">
    </script>
    <script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js">
    </script>
        <script type="text/javascript" src="http://dev.jtsage.com/cdn/simpledialog/latest/jquery.mobile.simpledialog.min.js"></script><script>$.mobile.page.prototype.options.domCache = false;
$('.ui-page').live('pagehide',function(){ $(this).remove(); });</script> 
```

当我使用：

```
 $(document).delegate('#btnComment', 'click', function() {
                $(this).simpledialog({
                    'mode':'blank',
                    'prompt':false,
                    'forceInput':true,
                    'cleanOnClose' : true, //!important..doesnt work
                    'useModal':true,
                    'fullHTML': ''                  })
            }); 
```

我在 fullHTML 中放入的内容都会被缓存。

当用户更改页面时，我重新打开对话框，内容没有更新，它仍然总是显示上一页的旧内容。

我已经尝试了无数的建议，这些建议已经在互联网上可用。没有选择，或者我做错了什么。我真的会就如何正确禁用缓存（我也使用 php 标头说不缓存）或如何正确处理此对话框提供一些建议!!!!!!!!!!!! 重新初始化它肯定会呈现一个新的不？cleanOnClose .. 即使点击取消也不能解决问题，那就是使用 close rel

```
 +'<table style="width:100%"><tr><td style="width:50%"><a id="btnSubmitComment" rel="save" data-role="button" href="javascript:submitCommentForm();" id="simpleclose">Save</a></td><td style="width:50%">'
                        +'<a rel="close" data-role="button" href="#" id="simpleclose">Cancel</a></td></tr></table>' 
```

这也无济于事

```
;$(this).simpledialog('refresh'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T16:33:31.297

```
$.mobile.showPageLoadingMsg();
window.location = uri;

<a data-ajax="false" href="javascript:gotouri(' 
```

# puppet - Puppet：将单个模板放入递归静态目录中

> ID：10654315
> 
> 赞同：1
> 
> 时间：2012-05-18T14:17:15.403
> 
> 标签：puppet

我正在尝试配置一个 Puppet 模块来安装和配置 tftp。

这是我模块中的依赖链（右侧的项目需要左侧的项目）。

pxe::install --> pxe::config --> pxe::config2 --> pxe::service

pxe::config 仅复制静态文件和目录。尤其是，

```
class pxe::config {
  File {
    owner => root,
    group => root,
    require => Class["pxe::install"],
  }

  file { "/var/lib/tftpboot":
    ensure => directory,
    recurse => true,
    purge => false,
    mode => 0755,
    source => "puppet:///modules/pxe/tftpboot",
  } 
```

这样就成功复制了。

问题是我想在这个目录中放置一个模板。这就是 pxe::config2 的用武之地。（我认为将其放入 config2 将允许我需要 pxe::config，并且目录 /var/lib/tftpboot/pxelinux.cfg/ 已经存在。）

```
class pxe::config2 {
  File {
    ensure => present,
    owner => root,
    group => root,
    mode => 0644,
    require => [ Class["pxe::install"], Class["pxe::config"] ],
  }

  file { "/var/lib/tftp/pxelinux.cfg/default":
    content => template("pxe/default.erb"),
  }

} 
```

当我运行代理时，我收到以下错误：

> 错误：/File[/var/lib/tftp/pxelinux.cfg/default]/ensure：从不存在更改为存在失败：无法设置“存在”确保：没有这样的文件或目录 - /var/lib/tftp/pxelinux .cfg/default.puppettmp_5977 在 /etc/puppet/modules/pxe/manifests/config2.pp:14

该错误表明模板的父目录不存在。但是，我在代理运行后进行了检查，发现 /var/lib/tftp/pxelinux.cfg/ 确实存在但为空。

有谁知道我如何递归复制静态目录/var/lib/tftp 和模板/var/lib/tftp/pxelinux.cfg/default？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T14:59:17.507

看起来这可能只是目录名称的拼写错误 - 该文件位于 /var/lib/tftp 目录而不是 /var/lib/tftpboot 目录下。

# sql - 为大型数据集中的每个项目选择最新条目

> ID：10654316
> 
> 赞同：3
> 
> 时间：2012-05-18T14:17:20.227
> 
> 标签：sql, performance, postgresql

所以，我有一个大约有 150 万行的表，看起来有点像这样：

```
name   | time       | data1 | data2  
--------------------------------------
 93-15 | 1337348782 |   11  | 60.791 
 92-02 | 1337348783 |   11  | 62.584 
 92-02 | 1337348056 |   11  | 63.281
 93-15 | 1337348068 |    8  | 65.849
 92-02 | 1337348117 |   11  | 63.271 
 93-15 | 1337348129 |    8  | 65.849 
 92-02 | 1337348176 |   10  | 63.258 
 93-15 | 1337348188 |    8  | 65.849 
 92-02 | 1337348238 |   10  | 63.245 
 93-15 | 1337348248 |    8  | 65.849 
```

...这些对应于需要监控的事物的历史状态更新。现在，我想做的是找到每个单元的当前状态。

在 stackoverflow 上找到类似的问题并不难，并且从结果中推断出来，我想出了这个查询：

```
SELECT * FROM vehicles v
  JOIN ( SELECT  MAX(time) as max, name
    FROM vehicles
    GROUP BY name)
  m_v
ON (v.time = m_v.max AND v.name = m_v.name); 
```

但是看到我大约有 150 万行（并且还在增加），是否有不同的方法可以实现更快的查询？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T14:23:18.337

```
WITH
  sequenced_data
AS
(
  SELECT
    ROW_NUMBER() OVER (PARTITION BY name ORDER BY time DESC) AS sequence_id,
    *
  FROM
    vehicles
)
SELECT
  *
FROM
  sequenced_data
WHERE
  sequence_id = 1 
```

一个覆盖索引`(name, time)`也会有帮助。

**编辑：**关于它如何工作的注释等。

PostgreSQL 具有所谓的窗口或分析功能。这些一般采取的形式`some_function() OVER (PARTITION BY some_fields ORDER BY some_fields)`。

在这种情况下，我使用了`ROW_NUMBER() OVER (PARTITION BY name ORDER BY time DESC)`.

`ROW_NUMBER()`为一组数据创建唯一的行号。 `1 to n`用于`n`记录。

`PARTITION BY name`表示此功能独立应用于不同的名称。每个`name`都是它自己的组/窗口/分区，并且每个组/窗口/分区`ROW_NUMBER()`从头开始的结果`1`。

`ORDER BY time DESC`在应用函数之前，获取一个组/窗口/分区中的所有记录并按`time`字段排序，最高值在前`ROW_NUMBER()`。

因此，对于您的示例数据，您会得到这个......

```
 name  | time       | data1 | data2  | row_number
--------------------------------------------------

 92-02 | 1337348783 |   11  | 62.584 | 1
 92-02 | 1337348238 |   10  | 63.245 | 2
 92-02 | 1337348176 |   10  | 63.258 | 3
 92-02 | 1337348117 |   11  | 63.271 | 4
 92-02 | 1337348056 |   11  | 63.281 | 5

 93-15 | 1337348782 |   11  | 60.791 | 1
 93-15 | 1337348248 |    8  | 65.849 | 2
 93-15 | 1337348188 |    8  | 65.849 | 3
 93-15 | 1337348129 |    8  | 65.849 | 4
 93-15 | 1337348068 |    8  | 65.849 | 5 
```

因为排序是，所以每个组/窗口/分区中`time DESC`的最高值`time`字段`name`将始终具有`row_number`。`1`

通过确保数据处于友好顺序，启用索引`(name, time)`使优化器更容易。这意味着它`ROW_NUMBER()`实际上并未应用于所有记录；一旦找到价值最高的`time`记录并分配`ROW_NUMBER() = 1`，它就知道它可以停止并继续下一个`name`。

# python - Python中的列表-AttributeError：'str'对象没有属性'coeffs'

> ID：10654318
> 
> 赞同：3
> 
> 时间：2012-05-18T14:17:29.947
> 
> 标签：python, arrays, list

我在 python 中的列表有问题。

这是简单的代码：

```
x = [scipy.poly1d([ 1.,  0.,  0.]),2,3,4,5,'foward']
for i in range (len(x)) :
    if x [i] == 'foward':
        print 'check!' 
```

当它运行时它会说：

> return NX.alltrue(self.coeffs == other.coeffs) AttributeError: 'str' 对象没有属性 'coeffs'

但是当我将 x 更改为：

```
 x = [1,2,3,4,5,'foward'] 
```

该程序将运行没有问题。

有人可以向我解释为什么吗？我该怎么办？实际上我有一个修复数据列表（x），它返回像上面一样的属性错误，我不想改变它的格式和它包含的内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T14:26:11.547

```
if isinstance(x[i], basestring) and x[i] == 'forward' 
```

或快速而肮脏的：

```
if str(x[i]) == 'forward' 
```

* * *

您还应该使用`for .. in`循环来遍历列表：

```
for elem in x:
    if isinstance(elem, basestring) and elem == 'forward':
        print 'Check' 
```

如果你也需要`i`：

```
for i, elem in enumerate(x): 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:23:19.917

我猜想给你问题的平等检查是在`scipy.poly1d`. 该类可能通过比较两个“多项式”系数来定义相等检查。由于字符串“forward”没有 coeff 属性，因此会出现错误。

一个简单的解决方法是将 if 语句放在 try/except 块中：

```
try:
   if x[i] == 'forward':
      print 'check'
except AttributeError:
   pass 
```

另一件事——通常在做：

```
for i in range(len(obj)): 
    x=obj[i]
    ... 
```

不是最好的成语。一个更好的成语是：

```
for i,x in enumerate(obj):
    ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T15:35:18.277

如果您只想检查“转发”是否在列表中，您也可以使用

```
if 'foward' in [i for i in x if isinstance(i, basestring)]:
    print 'check' 
```

# ios - GLKit 混合两种纹理

> ID：10654319
> 
> 赞同：3
> 
> 时间：2012-05-18T14:17:32.430
> 
> 标签：ios, opengl-es, glkit

我正在尝试转换 OGL ES 1.1。GLKit 的代码。GLKit 提供了一对纹理槽：

1.  纹理2d0
2.  纹理2d1

每个纹理都有一个环境模式：

1.  GLKTextureEnvModeReplace,
2.  GLKTextureEnvModeModulate,
3.  GLKTextureEnvModeDecal

通常，您将 texture2d1 留空，然后设置 texture2d0。我假设 - 从阅读 Apple 的文档中 - 2d1 用于混合/组合/修改纹理。由于 GLKit “仅仅”位于着色器之上，并且每个着色器都有一对纹理槽是标准的 - “传入”槽表示材质上已有的内容，“修改”槽表示着色器的内容将用作修改材料的参数。

但这似乎不起作用。

我试过了：

```
self.baseEffect.texture2d0.envMode = GLKTextureEnvModeReplace;
self.baseEffect.texture2d0.target = GLKTextureTarget2D;
self.baseEffect.texture2d0.name = [earthTextureDefault name];

self.baseEffect.texture2d1.envMode =  GLKTextureEnvModeModulate;
self.baseEffect.texture2d1.target = GLKTextureTarget2D;
self.baseEffect.texture2d1.enabled = TRUE;
self.baseEffect.texture2d1.name = [textureClouds name]; 
```

...我得到的只是黑色的无纹理。放置到 0 中的任一纹理（1 中没有任何内容）都可以正常工作。第二个纹理是 alpha 到白色的阴影，其中第一个纹理是不透明的，但具有相当丰富的调色板。

我真正想做的是开始有效地应用动态生成/更新的混合。例如：

1.  加载基础纹理
2.  加载第二个纹理
3.  加载在它们之间混合的混合蒙版
4.  ...逐帧更新混合蒙版。无需重新上传前两个纹理

注意：我不想扔掉 GLKit 并为此编写自定义着色器。我想了解 GLKit 是如何工作的——从外观上看，对于像这样的简单事情，维护起来应该比我到处写一堆着色器要容易得多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-05T22:57:24.010

[如文档中所述](https://developer.apple.com/library/ios/documentation/GLkit/Reference/GLKEffectPropertyTexture_ClassRef/Reference/Reference.html#//apple_ref/doc/uid/TP40010917-CH1-SW2)，`GLKTextureEnvModeModulate`将纹理的颜色值相乘，这可能就是您看到黑色的原因。如果您想在没有纹理的情况下覆盖带有 alpha 的纹理，请`GLKTextureEnvAttribDecal`改用。

我没有看到仅使用 GLKit API 来实现动态混合蒙版想法的方法，但您不必完全抛弃它。尝试这样的事情：

1.  加载三个纹理对象：基础纹理、第二个纹理和混合蒙版。
2.  创建一个帧缓冲区对象，其颜色附件是第四个纹理。
3.  使用着色器渲染到纹理 FBO，该着色器使用来自第二个纹理的 RGB 值和来自混合蒙版的 alpha 值填充它。
4.  使用基础纹理`texture0`和 FBO 纹理，`texture1`并将`GLKBaseEffect`主场景渲染到屏幕上。
5.  更新混合蒙版时重复步骤 3-4。

它可能不如在一个渲染过程中完成所有操作的片段着色器效率低，但它应该可以工作。

# mysql - 如何更改数据库上的数据类型

> ID：10654323
> 
> 赞同：0
> 
> 时间：2012-05-18T14:17:48.463
> 
> 标签：mysql, sql, database, apache

我正在使用 Apache 附带的 MySQL。我已将 Excel 电子表格导入 MySQL 并创建了一个数据库。但是，所有数据都存储为 varchar，而其中一些数据显然是数字。如何更改这些特定条目的数据类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:26:53.357

这会将列更改为整数。查看手册以了解您感兴趣的任何其他数据类型，并注意潜在的数据丢失。

```
ALTER TABLE `mydatabase`.`mytable` CHANGE `myfield` `myfield` INT(10) NULL; 
```

或者，根据马库斯的观察：

```
ALTER TABLE `mydatabase`.`mytable` MODIFY `myfield` CHAR(10) ; 
```

# iphone - 附加字符串

> ID：10654325
> 
> 赞同：0
> 
> 时间：2012-05-18T14:17:53.300
> 
> 标签：iphone, ios, ios5, nsstring

我有这段代码来显示特定章节的一些文本，我正在使用核心文本。但我的需要是，当第一章的文本结束时，它想在换行符中显示下一章文本。我显示文本的代码是

```
NSMutableString *combined = [NSMutableString string];

    for(NSUInteger idx = 0; idx < [delegatee.allSelectedVerseEnglish count]; idx++) {
        [combined appendFormat:@"  %d %@", 
         idx + 1, 
         [delegatee.allSelectedVerseEnglish objectAtIndex:idx]];

    }

    self.multiPageView.text =combined; 
```

multipageview 是我通过核心文本呈现文本的视图。所以我需要在“组合”中有第一章文本。所以我想将组合附加到下一章，显示下一章的代码是

```
delegatee.selectedChapter = [NSString stringWithFormat:@"%d",[delegatee.selectedChapter intValue] + 1];
    [delegatee reloadVerses];
    [self resetReadViewToVerse:1]; 
```

组合包含这样的文本...1 haii 这是我的第一句 2 这是我的第二句 3 这是我的第三句 ,,etch etc..so 如果第三句是最后一个文本，那么在 /n 换行中我需要下一章文本..我将此代码放在按钮中以导航到下一章，但在每章结束后我会自动需要它。

是否可以？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:52:26.277

首先，您可能需要准备一种方法来通过章节编号接收经文（以获取您想要显示的下一章的经文）。

在您的`for`循环之间，`self.multiPageView.text =combined;`您应该计算最后一个“页面”中占用的行数，这允许您根据最大“页面”行数计算下一章要填充的行数。

现在，当您同时拥有下一章的经文和要添加的行数时，您可以很容易地附加下一章的行以使用`while`循环填充“页面”。有两个重要的条件需要考虑：

*   可能没有下一章 - 您跳过下一章文本附加，禁用下一章按钮等。
*   最后一个“页面”上没有空行，但有下一章 - 您跳过下一章文本附加，但下一章按钮已启用

生成的代码如下所示：

```
NSMutableString *combined = @"";
NSArray * selectedChapterVersesArray = [delegatee.allVersesForLanguage:kEngLang atChapter:delegatee.selectedChapter];

if (selectedChapterVersesArray != nil && [selectedChapterVersesArray count] > 0)

// prepare the selected chapter text
for(NSUInteger idx = 0; idx < [selectedChapterVersesArray count]; idx++) {
    [combined appendFormat:@"  %d %@ \n", 
     idx + 1, 
     [selectedChapterVersesArray objectAtIndex:idx]];

}

// calculate the lines found to be added from the next chapter - to be implemented !
NSUInteger linesToAddFromNextChapter = [self emptyLinesForMultipageView:self.multipageview withText:combined];

if (delegatee.numberOfChapters > delegatee.selectedChapter)
{
// there's a next chapter
NSArray * nextChapterVersesArray = [delegatee.allVersesForLanguage:kEngLang atChapter:delegatee.selectedChapter+1];

// append the next chapter text
NSUInteger linesAdded = 0;
BOOL nextChapterHasLinesToAdd = [nextChapterVersesArray count] > 0;

while (linesAdded < linesToAddFromNextChapter && nextChapterHasLinesToAdd) {
  // append one line, inc linesAdded, recalculate nextChapterHasLinesToAdd
}
}
}

self.multiPageView.text =combined;
delegatee.selectedChapter = [NSString stringWithFormat:@"%d",[delegatee.selectedChapter intValue] + 1];
[delegatee reloadVerses];
[self resetReadViewToVerse:1]; 
```

请注意，您在格式文字中丢失了换行符`\n`，代码只是草稿，还有一些方法要实现。

# mysql - Rails 3.2 解释了导致文档上传的奇怪问题

> ID：10654329
> 
> 赞同：5
> 
> 时间：2012-05-18T14:17:56.903
> 
> 标签：mysql, ruby-on-rails, amazon-s3, ruby-on-rails-3.2

这是一个奇怪的问题，我在 Google 中找不到任何提及。

我*有时会*在包含将文档上传到 AWS S3 的事务中遇到此异常。

```
Mysql2::Error: Table 'app_name_development.begin' doesn't exist: EXPLAIN BEGIN 
```

通过在环境配置中注释掉这一行来关闭解释可以解决问题：

```
# config.active_record.auto_explain_threshold_in_seconds = 0.5 
```

我正在运行 MySQL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:58:55.807

您的问题是您正在运行旧版本的 rails 并且它没有基于非 CRUD 的修复说明：[https ://github.com/rails/rails/pull/7657](https://github.com/rails/rails/pull/7657)

问题出在 activerecord 本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-22T18:00:13.993

如果您使用的 rails 版本仍然存在错误，您可以通过设置来解决它：

```
config.active_record.auto_explain_threshold_in_seconds = nil 
```

在 config/environments/development.rb 中。

# c# - Windows 服务安全保存密钥

> ID：10654331
> 
> 赞同：0
> 
> 时间：2012-05-18T14:18:09.153
> 
> 标签：c#, windows-services, filesystems, registry

我创建了一个服务，并使其运行为 `LocalSystem`，因为我需要它独立于登录用户运行，并且该服务需要保存从套接字接收的密钥，并将其保存在文件系统或注册表中。保存文件或注册表项的最佳方式在哪里，使标准用户无法读取密钥？

找到了一种方法，使用文件系统在此处保存配置文件：

```
Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) 
```

该服务作为本地系统运行，因此它返回：

```
@"C:\Windows\system32\config\systemprofile\AppData\Roaming\" 
```

并且只有系统或管理员可以访问它。
如果有人有理由不使用这种方式，或者有更好的方法，那也会很有帮助

# java - 无法打开 .java 文件

> ID：10654334
> 
> 赞同：0
> 
> 时间：2012-05-18T14:18:16.380
> 
> 标签：java, android, eclipse, aptana

我正在使用 Aptana studio 3 并安装了“Eclipse Java 开发工具”，但是当我尝试在 Aptana 中打开 .java 文件时，我收到了这条消息，

```
Could not write metadata for 'C:/ .... 
```

但是在包资源管理器中它可以看到文件内部，它有

```
onCreate(Bundle):void 
```

我认为这是该项目为您创建的某种功能。我是android开发的新手，但不是编码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:26:28.770

如果您是 android 开发的新手，我建议您使用 eclipse 和 ADT，这会为 eclipse 添加额外的工具来进行 android 开发。请参阅[此处](http://developer.android.com/sdk/adding-components.html)了解如何操作。

# google-analytics - 我可以查看页面访问者来自哪个 Adwords 广告吗？

> ID：10654337
> 
> 赞同：1
> 
> 时间：2012-05-18T14:18:19.733
> 
> 标签：google-analytics, google-ads-api

我刚刚开始使用 Google Analytics 和 Googe Adwords。

在我的订单页面（每个产品一个）中，我可以看到访问者是如何访问网站的（哪个入口页面、哪个关键词等）。但我还没有设法找出如何查看访问者来自哪个 Google Adwords 广告。

我为我的网站激活了 Google Adwords，但我想找出哪些 Adwords 广告让访问者访问我的订单页面。以及哪些 Adwords 广告使访问者立即返回。

有谁知道该怎么做？或者在哪里可以找到更多信息？:)

/米娅

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:44:24.540

完成此操作的最佳方法是[将 Google AdWords 链接到 Google Analytics](http://support.google.com/adwords/bin/answer.py?hl=en&answer=1704341)。这将打开自动标记功能，然后将点击和费用数据导入 Google Analytics 进行进一步分析。从这里，您可以按广告系列、广告组和/或关键字分析跳出率和转化率。

# c# - 等待线程完成而不阻塞 UI 线程

> ID：10654340
> 
> 赞同：2
> 
> 时间：2012-05-18T14:18:32.423
> 
> 标签：c#, .net, multithreading

我目前正在尝试在测试软件上实现自动保存功能。

“开始”按钮触发 TestThread 进行测试。UI 通过来自 TestThread 的调用进行更新，为测试人员提供有关测试的实时信息。当用户单击“停止”按钮时，会设置一个标志，指示 TestThread 完成当前测试并停止。它还禁用 UI 上的控件并触发 StopThread 以监视 TestThread 的进度。当 TestThread 完成时，StopThread 重新启用 UI 控件。

此时，我需要等待 StopThread 完成，以便可以调用自动保存（导致 Excel 文件生成的 SaveFileDialog）。但是，在“停止”按钮单击处理程序中使用 StopThread.Join() 似乎只会导致程序挂起。这可能是因为 TestThread 需要时间来完成并尝试更新被阻止的 UI 线程。

从 StopThread 调用 save 函数会生成 ThreadStateException，因为我使用 SaveFileDialog（模态形式）并且显然需要将调用线程设置为“单线程单元”。

对此进行搜索似乎指向简单地使用 Thread.Join() 的一般答案。我需要在线程完成之前保持 UI 处于活动状态这一简单事实使得它无法使用。有没有办法从 StopThread 调用 SaveFileDialog 但将其编组到 UI 线程？还有其他建议吗？提前致谢。

工作解决方案：

```
private void btn_Stop_Click(object sender, EventArgs e)
    {
        //Disable UI controls and flag test ending

        Thread StopThread = new Thread(WaitForTestEnd);
        StopThread.Start();        
    }

    private void WaitForTestEnd()
    {
        while (!testStopped) //Flag set at end of TestThread
        {
            Thread.Sleep(50);
        }

        //Re-enable UI

        AutoSave saveMyData = SaveData;
        Invoke(saveMyData);
    }

    private delegate void AutoSave();

    private void SaveData()
    {
        //Generate SaveFileDialog and save.
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T14:21:00.523

完全不要阻挡`StopThread`。而是安排它`StopThread`向主线程发出它已经完成的信号。例如通过使用`Invoke`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:21:15.967

> 有没有办法从 StopThread 调用 SaveFileDialog 但将其编组到 UI 线程？

你为什么不直接使用`Control.Invoke`or `Dispatcher.Invoke`，就像你来自 TestThread 一样？

# objective-c - 在基于视图的应用程序中，拆分视图在纵向模式下崩溃

> ID：10654344
> 
> 赞同：0
> 
> 时间：2012-05-18T14:18:47.693
> 
> 标签：objective-c, uisplitviewcontroller, ipad, landscape-portrait

我正在开发一个基于视图的 iPad 应用程序。它是一个简单的基于视图的应用程序，其中第一个加载的视图包含一个按钮。单击此按钮后，我正在创建一个 SplitViewController，其中包含两个 UINavigationControllers（一个主控和另一个细节），我正在删除当前视图（第一个视图）并将 splitViewController 的视图添加到窗口。Master 包含一个按钮作为栏按钮项（主页按钮），它可以删除 SplitViewController 的视图并将第一个视图添加到窗口。如果我以横向模式启动我的应用程序，它工作正常。但如果我以纵向模式启动我的应用程序并单击主页按钮（在主导航栏上），它不会到达第一个视图并显示以下错误。此错误如果我将方向从纵向更改为横向，也会出现，

```
2012-05-18 19:12:52.796 test_Project[3703:f803] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[UIPopoverController presentPopoverFromRect:inView:permittedArrowDirections:animated:]: Popovers cannot be presented from a view which does not have a window.' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T15:01:57.647

要呈现弹出框，父视图应该具有有效的框架。因此，请尝试检查您是否在添加弹出框后为父视图设置框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T08:35:09.457

最后我得到了我自己的答案。在基于视图的应用程序中，当使用弹出框时，因此当从拆分视图返回到视图时，首先关闭该弹出框（隐藏），然后删除拆分视图。

# jquery - 浮动 div - 未在一行中对齐

> ID：10654347
> 
> 赞同：1
> 
> 时间：2012-05-18T14:18:59.493
> 
> 标签：jquery, html, css

我有浮动 div 的问题。在[此站点上](http://beta.designclub.cz/#index.php/cs/design/15-design/42-bigboy)，您可以看到显示问题的演示。有一个画廊应该在一个宽行中显示所有图像。不幸的是，所有图像都显示在下面。每个幻灯片包装器都是相对定位的，具有给定的高度和宽度，并且也将浮动设置为左侧。它看起来像非常标准的东西，但在这种情况下它对我不起作用:(。

所有代码都与站点捆绑在一起，因此比在此处发布更好的是在网络检查器中查找。但如果有人介意，我可以在这里提供一些代码:)

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:32:21.657

你的问题不在于浮动，这很好，应该是浮动：左。

但是要让所有图像从左到右，你需要一个更宽的父元素，在你的情况下，尝试改变这个：

```
<div class="sGalleryWrapper" style="top: 90px; height: 576px;"></div> 
```

对此：

```
<div class="sGalleryWrapper" style="top: 90px; height: 576px; width: 10000px;"></div> 
```

应该有帮助。10000px 宽度是一个虚构的数字。要查看多少对您来说足够，请计算您尝试对齐的所有 div 的总宽度。

假设它们都是 500px 宽，并且有 10 个。如果您的 div 上没有边距，5001px（添加一个）对您来说应该足够了。如果您有边距，请添加它们。

# python - 为什么 Python 脚本会跳过某些条目而不是其他条目？

> ID：10654351
> 
> 赞同：1
> 
> 时间：2012-05-18T14:19:12.520
> 
> 标签：python

在 Python 列表中，我希望删除的条目仍然存在，并且另一个条目被删除。这是为什么？

这是有问题的代码：

```
def getAdjacent(pos, bounds):
    posibles = [
    [pos[0]-1, pos[1]],
    [pos[0]+1, pos[1]],
    [pos[0], pos[1]-1],
    [pos[0], pos[1]+1]]
    for p in posibles:
        if isOutside(p,bounds):
            posibles.remove(p)
    return posibles

def isOutside(pos, bounds):
    if pos[0] > bounds[0]-1 or pos[0] < 0 or pos[1] < 0 or pos[1] > bounds[1]-1:
        return True
    else:
        return False 
```

以下是反映问题的一些输入和输出：

```
In [13]: bounds = [10, 10]

In [14]: p = [9,0]

In [15]: getAdjacent(p, bounds)
Out[15]: [[8, 0], [9, -1], [9, 1]]

In [16]: isOutside([9, -1], bounds)
Out[16]: True

In [17]: isOutside([9, 1], bounds)
Out[17]: False 
```

现在为什么当 getAdjacent() 删除所有导致 isOutside() 返回 True 的元素时 [9, -1] 仍在 getAdjacent() 中？为什么 [10, 0] 还在那里？这是一个量级的事情吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-18T14:21:36.713

不要从您正在迭代的列表中删除元素：

```
for p in posibles:
    if isOutside(p,bounds):
        posibles.remove(p) 
```

这会混淆迭代并导致跳过条目。我会把它写成

```
possibles = [p for p in possibles if not isOutside(p, bounds)] 
```

# javascript - 测试是否已授予 html5 地理定位权限

> ID：10654352
> 
> 赞同：6
> 
> 时间：2012-05-18T14:19:14.750
> 
> 标签：javascript, html, geolocation

有谁知道是否有办法测试是否已授予先前的 html5 地理定位权限？

我尝试制作一个不请求地理位置的脚本，除非该页面的权限已经获得。不一定非得是 html5；其他框架也可以。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-09-08T10:44:54.610

第一部分实际上回答了您的问题，至少在 Chrome 43+ 和 Firefox 46+ 上（请参阅[https://developer.mozilla.org/en-US/docs/Web/API/Permissions_API](https://developer.mozilla.org/en-US/docs/Web/API/Permissions_API)）：

```
navigator.permissions &&
navigator.permissions.query({name: 'geolocation'}).then(function(PermissionStatus) {
    if('granted' === PermissionStatus.state) {
        navigator.geolocation.getCurrentPosition(function(geoposition) {
            console.log(geoposition) /* You can use this position without prompting the user if the permission had already been granted */
        })
    }
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-24T00:42:59.850

你能做的最好的就是自己跟踪这个......

```
// In chrome you can now do this    
navigator.permissions.query({name: 'geolocation'}).then(function(PermissionStatus){
    console.log(PermissionStatus.state) // prompt, granted, denied
    // even listen for changes
    PermissionStatus.onchange = function(){
        console.log(this.state)
    }
}) 
```

回退方法：

```
// initialization
if( sessionStorage.getItem("geo_access") === null ){
    // just assume it is prompt
    sessionStorage.setItem("geo_access", "prompt");
}

function ask(){
    navigator.geolocation.getCurrentPosition(function(){
        sessionStorage.setItem("geo_access", "granted");

    }, function(err){
        if(err.code == 1){ // PERMISSION_DENIED
            sessionStorage.setItem("geo_access", "denied");
        }
        sessionStorage.setItem("geo_access", "prompt");
    });
};

// Then somewhere
ask(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:40:23.117

根据[Geolocation API 规范](http://dev.w3.org/geo/api/spec-source.html)，没有任何功能。甚至将其保存在浏览器首选项中的选项也不会推送到您的代码中。

如果它真的很重要并且您确实必须意识到这一点，那么您必须为每个常见的浏览器编写一个浏览器插件并要求用户安装它。但我不会怀疑。

# iphone - 在 UITabbar 项之间插入空格/视图/图像

> ID：10654356
> 
> 赞同：6
> 
> 时间：2012-05-18T14:19:21.537
> 
> 标签：iphone, ios, ipad, uitabbar

将应用程序移植到 ipad 和 Landscape 中，选项卡栏看起来有点稀疏，因此有了分离选项卡（其中 6 个）并在它们之间插入图像的想法。

我目前使用`TabBarKit`它，它可以做所有事情，而且做得更多`UITabbar`，但这是我一直坚持的事情。找不到任何插入空白空间的方法，无论是图像还是`UIView`（背景已经是图像）？

到目前为止我所做的是以编程方式添加几个额外的选项卡项并将图像设置为 nil 并删除用户交互。（我在另一个 stackoverflow 线程上找到了这个解决方案，但这不是一个完美的解决方案）。

我知道`UIToolbar`有一个灵活的空间项目，但是当我尝试使用它时，`tab bar item`它引起了一些问题。

因此，如果有人对如何将视图、空白空间等插入标签栏有任何想法，将不胜感激。

**更新**

开始赏金，因为我很好奇这是否可以完成。ipad 横向视图有很多空间，我被要求在中间放置一个图像来分割按钮。

如果应用程序被拒绝，那就更愚弄我了。非常感谢任何示例、示例、建议、建议

图片示例： ![在此处输入图像描述](../Images/7d349f5f36a19079bef0798ad5432813.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T19:15:11.410

我同意上面的答案，这可能不是一个好主意，但从技术上讲，这是可能的。

自定义标签栏的技巧是隐藏默认标签栏并将您自己的自定义视图放置在该空间中。然后，您可以使用按钮、图像以及您想要的任何内容填充该视图。以下是我的处理方式。

我在 AppDelegate 中这样设置了我的 UITabbarController：

```
UITabBarController tabBarController = [[UITabBarController alloc] init];
tabBarController.viewControllers = [NSArray arrayWithObjects:viewController1, 
                                             viewController2, 
                                             viewController3,
                                             nil];
//add the custom tabbarcontroller
CustomTabBar customTabBar = [[CustomTabBar alloc] initWithFrame:CGRectMake(0, self.window.frame.size.height - 60, self.window.frame.size.width, 62)];
    [self.tabBarController.view addSubview:_customTabBar];

tabBarController.tabBar.hidden = YES;
self.window.rootViewController = self.tabBarController; 
```

CustomTabBar 是 UIView 的子类，我在其中放置了自己的自定义按钮。当单击此类中的按钮时，我会进行如下所示的调用：

```
-(void)firstBtnClicked:(id)sender {
    ((UIButton*)sender).enabled = NO;
    AppDelegate *delegate = (AppDelegate*)[UIApplication sharedApplication].delegate;
    delegate.tabBarController.selectedIndex = 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T14:29:08.910

我会劝阻您不要弄乱 Apple 精心设计的标签栏间距。不要这样做 - 你正在以一种糟糕的方式破解本机控件，这将在未来产生后果。此外，您必须在横向和纵向模式下处理不同的间距和逻辑。不要不必要地使事情复杂化，按设计使用它或重新考虑标签栏是否是合适的控件。

引用[Apple 的指南](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/MobileHIG/UIElementGuidelines/UIElementGuidelines.html#//apple_ref/doc/uid/TP40006556-CH13-SW52)：

> 在 iPad 上，在每个方向显示相同的选项卡，以提高应用程序的视觉稳定性。在纵向模式下，推荐的七个选项卡非常适合整个屏幕的宽度。在横向方向中，您应该将相同的选项卡沿屏幕宽度居中。本指南也适用于拆分视图窗格或弹出框内标签栏的使用。例如，如果您在纵向弹出窗口中使用选项卡栏，则可以在横向拆分视图的左窗格中显示相同的选项卡。

# r - 图表第 95 个百分位

> ID：10654358
> 
> 赞同：-3
> 
> 时间：2012-05-18T14:19:27.990
> 
> 标签：r

我有一个可以使用以下方法绘制的时间序列数据：

```
plot(x$numbers, type="l", col="blue") 
```

我喜欢得到第 95 个百分位并将第 95 个百分位添加到此图表中

```
x_percent<-quantile(x$numbers, 0.95) 
```

如何将 x_percent 添加到现有的 x$numbers 图表中？

```
x$numbers<-c(1,2,3,8,10,30)
x$percent<-quantile(x$numbers, 0.95)
plot(x$numbers, type="l") 
```

在这里，我喜欢将 x$percent 添加到图表中，基本上绘制一条垂直线，其值为第 95 个百分位值。安迪的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:41:49.517

好的，你的编辑没有太大帮助，但我猜你想做这样的事情..（见贾斯汀评论）

```
x   <- seq(0,20,length=1000)
y   <- dnorm(x,mean=10, sd=3)
plot(x,y, type="l", lwd=2)
abline(a=1,b=1,v=1,lty=3) 
```

但是你提到时间序列让我觉得你不确定你在策划什么。否则，您将只是`abline`在特定日期标记。

![在此处输入图像描述](../Images/03fe81eb9c0d06d5fdd89f9097f298b0.png)

PS我猜你确实想要x轴另一侧的线

# java - 关于如何创建 java web 服务并部署到 mac web 服务器的简单教程？

> ID：10654361
> 
> 赞同：2
> 
> 时间：2012-05-18T14:19:30.340
> 
> 标签：java, macos, post, deployment, service

我对 java 中的服务（来自 C# 背景）相对较新，并且一直在努力理解这一切。我想知道是否有人可以帮助我

1.  使用单一方法创建一个简单的 Web 服务，该方法接受在 POST 正文中传递的字符串（表示相当大的文本文件的内容）并返回该字符串的转换版本。
2.  将所述服务部署到 mac Web 服务器。

任何简单、易于理解和实用的东西都将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:36:12.667

你可以试试[dropwizard](http://dropwizard.codahale.com/)

您可以按照他们的文档构建一个简单的示例。

它拥有创建简单 REST 服务所需的一切：

Jetty（嵌入式应用程序服务器）Jackson（Java 对象 - Json）Jersey（用于构建 Web 服务的实现）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:29:51.430

希望[Axis 的 Web 服务教程对](http://www.digizol.com/2008/07/web-service-axis-tutorial-client-server.html)您有所帮助。

# windows-phone-7 - Windows 电话 7.1.1 平

> ID：10654366
> 
> 赞同：3
> 
> 时间：2012-05-18T14:19:37.987
> 
> 标签：windows-phone-7, sockets

我正在编写一个应用程序以使用 REST Web 服务连接到第三方应用程序。

我有一个配置页面，要求输入 IP、端口、用户名和密码，目前它只是盲目地假设您输入了正确的详细信息并尝试连接。

我想创建一个测试例程，在设置配置信息时通过并检查以下步骤

1.  IP/主机名是否正确（使用 ping 或其他方式）
2.  端口是否正确
3.  用户名和密码是否正确

然后在屏幕上显示结果，以便如果它无法连接到服务，则更容易确定问题所在。

为了实现第 1 步，我想使用 Ping 或一些不依赖于打开的特定端口的等价物。所以我可以消除不可靠的 DNS 或 IP/主机名中的拼写错误。

我从以前的问题中了解到，在 7.0 中无法进行 ping，但是使用 Mango 已添加了套接字类，现在是否可以，如果可以，如何？如果仍然不可能，是否有其他方法可以实现第 1 步？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T11:41:22.987

对于 1) 和 2)，您绝对可以使用 Mango SDK。Microsoft Research 有一个名为 TestMyNet 的应用程序（在 Marketplace 中搜索或查看此处：[http](http://research.microsoft.com/en-us/projects/testmynet1/) ://research.microsoft.com/en-us/projects/testmynet1/ ），它可以执行此操作以及更多功能。

对于 3) 您可以收听 HTTP 响应（例如拒绝访问错误）。

如果可以的话，我稍后会发布一些 1) 和 2) 的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:14:10.533

我做了更多的挖掘，看起来这对于当前的 7.1.1 sdk 是不可能的，因为套接字实现不支持发送原始数据报。

我找到了一篇关于如何在 C# for Windows .Net 中执行此操作的文章，但 WP7 中不存在套接字选项（据我所知）。

而是为 7.8 sdk 祈祷。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T17:25:33.007

`HTTP HEAD`您可以在提交之前使用 a检查与服务器的连接吗？

就整体性能而言，我只会在请求失败后尝试测试连接（并且取决于 HTTP 响应代码）。

在进行之前添加额外的检查`HTTP POST`只会延迟有效提交的总时间。

# unix - Unix shell中带有自动时间的目录

> ID：10654369
> 
> 赞同：4
> 
> 时间：2012-05-18T14:19:54.937
> 
> 标签：unix, date, time, directory

我想创建脚本，其中新生成的目录自动将当前时间作为名称的一部分。

句法

```
mkdir mydir[min-hour-day-month-year] 
```

因此最近的目录将被命名为

```
mydir101718052012 
```

一小时后创建的目录

```
mydir111718052012 
```

等等。

很抱歉这个简单的问题，我是 unix 新手，我使用 bash

编辑：为什么不遵循正确？我该怎么做 ？

```
newdir = mydir$( date +%Y-%m-%d-%H-%M-%S)
cp new.txt newdir/new1.txt 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T14:22:00.540

如果您的 date 实现支持这些选项，您可以简单地执行以下操作：

```
mkdir mydir$( date +%M%H%d%m%Y ) 
```

请注意，这不会根据您的示例输出在名称中插入连字符。要获得初始描述中的连字符：

```
mkdir mydir$( date +%M-%H-%d-%m-%Y ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T15:34:45.787

我在我的 bash 启动脚本中设置了以下函数：

```
# Date Time Stamp
dts() { date +%Y-%m-%d-%H-%M-%S; }

# Date mkdir
dmkdir() { mkdir $(dts); } 
```

我主要在命令行上使用它们，如果你想在脚本中运行它们，你必须获取启动脚本或在脚本中定义 shell 函数。如果你想在前面加上一个名字（例如`mydir`），你可以很容易地给它一个像这样的参数：

```
# Date mkdir
dmkdir() { mkdir "$@$(dts)"; } 
```

这将被称为：

```
$ dmkdir mydir
$ ls -d mydir*
mydir2012-05-18-11-38-40 
```

这确实意味着如果您的参数列表包含空格，它们将显示在目录名称中，这可能是也可能不是一件好事。

您可以在 shell 函数内部分配一个 shell 变量，这可以在函数外部访问：

```
dmkdir() { newdir="$@$(dts)"; mkdir $newdir; } 
```

像这样使用：

```
$ dmkdir mydir
$ cd $newdir
$ pwd
/tmp/mydir2012-05-18-12-54-32 
```

这非常方便，但是您必须注意以下几点：1）您正在污染您的命名空间——您可能会覆盖一个名为`$newdir`由不同进程创建的 shell 变量 2）很容易忘记哪个变量 dmkdir 将写入，特别是如果你有很多 shell 函数写出变量。一个好的命名约定将对这两个问题有很大帮助。

另一种选择是让 shell 函数回显目录名称：

```
dmkdir() { local newdir="$@$(dts)"; mkdir $newdir && echo $newdir; } 
```

这可以如下调用：

```
newdir="$(dmkdir mydir)" 
```

`local`意味着这`$newdir`在 dmkdir 之外不可用，这是一件好事（TM）。

的使用`&&`意味着只有在目录创建成功时才回显目录的名称。

该`$()`语法允许您加载任何回显到 STDOUT 的内容以加载到变量中，并且单引号确保如果目录名称中有任何空格，它仍然会加载到单个变量中。

这解决了先前解决方案中固有的命名空间污染问题。

# java - 下载 Google Play 主页

> ID：10654370
> 
> 赞同：0
> 
> 时间：2012-05-18T14:19:59.163
> 
> 标签：java, android, html, urlconnection

我正在尝试从新的 Google Play 市场下载一个页面，但似乎得到了奇怪的结果。我使用 url`https://play.google.com/store/apps/details?id=package.name`和以下方法：

```
private static String downloadString(final URL url) throws IOException {
    final HttpsURLConnection conn = (HttpsURLConnection) url
            .openConnection();
    conn.setHostnameVerifier(new HostnameVerifier() {

        @Override
        public boolean verify(final String hostname,
                final SSLSession session) {
            return true;
        }
    });
    conn.setReadTimeout(10000);

    String html;

    try {
        final InputStream is = conn.getInputStream();
        final BufferedInputStream bis = new BufferedInputStream(is);
        final ByteArrayBuffer baf = new ByteArrayBuffer(50);

        int current = 0;
        while ((current = bis.read()) != -1) {
            baf.append((byte) current);
        }

        /* Convert the Bytes read to a String. */
        html = new String(baf.toByteArray());

    } finally {
        conn.disconnect();
    }

    return html;
} 
```

结果不包含描述、变更日志或任何重要的内容，但我的 html 知识不足以理解下载的确切内容。我把下载的源代码[放在这里](http://pastebin.com/n7CMRyv7)给感兴趣的人。它比任何 Google Play 应用程序页面所需的页面小 10 倍。

我的问题是，如何获取原始应用页面的来源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:29:50.617

你从你的方法中得到的可能是正确的。Google 喜欢使用 javascript 加载资源以提高性能，并且所有 Javascript 都是经过编译的，因此它完全不可读。

因此，当您下载页面时，您可能会收到非常少量的 HTML，并且您提到更改日志等不存在？这意味着它们正在使用某种客户端运行时加载，很可能是 javascript。

要下载这个，你需要一个浏览器或库来执行 Javascript、CSS 和布局 HTML。

也许检查像占碑这样的图书馆？我知道 QT 有一个使用 Webkit 的 QWebView 组件，但我不知道这是否会运行 Javascript。

希望至少可以为您指明正确的方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T07:32:18.900

尝试在您的浏览器中安装例如 Firebug 插件或任何其他允许您在访问页面时监控 http 流量的工具。然后您可以查看加载实际数据的调用。您可能可以直接获取这些 URL。

# thread-safety - lib 魔法线程安全吗？

> ID：10654371
> 
> 赞同：2
> 
> 时间：2012-05-18T14:19:59.250
> 
> 标签：thread-safety, libmagic

我一直在四处寻找，试图找到答案。我知道我可以创建多个 libmagic 实例，每个线程一个，这是线程安全的。但是我可以在多个线程之间共享一个实例吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T07:24:04.590

不，您不能在两个或多个线程之间共享 libmagic 句柄/描述符，从这个意义上说，libmagic 不是线程安全的。

# pyqt - PyQt 中带有 QPropertyAnimation 的 QGraphicsObject

> ID：10654373
> 
> 赞同：0
> 
> 时间：2012-05-18T14:20:08.323
> 
> 标签：pyqt, qgraphicsitem

我有一个奇怪的错误，QGraphicsObject 的 QPropertyAnimation 无法正常工作。这是代码，Pyqt v.4.8.6，Qt 4.6。如您所见，没有发出“valueChanged”信号。这是一个错误还是我做错了什么？提前致谢！

```
import sys

from PyQt4.QtGui import *
from PyQt4.QtCore import *

from functools import partial

class GObject(QGraphicsObject): 

    def boundingRect(self): 
        return QRectF(0, 0, 10, 10)

    def paint(self, p, *args): 
        p.drawRect(self.boundingRect()) 

    def animatePos(self, start, end):
        print 'Animating..'
        anim = QPropertyAnimation(self, 'pos')
        anim.setDuration(400)
        anim.setStartValue(start)
        anim.setEndValue(end)
        self.connect(anim, SIGNAL('valueChanged(const QVariant&)'), self.go)
        #self.connect(anim, SIGNAL('stateChanged ( QAbstractAnimation::State, QAbstractAnimation::State )'),self.ttt)
        anim.start( ) #QAbstractAnimation.DeleteWhenStopped)

    def go(self, t):
        print t

class Scene_Chooser(QWidget):
    def __init__(self, parent = None):
        super(Scene_Chooser, self).__init__(parent)

        vbox = QVBoxLayout(self)
        vbox.setContentsMargins(0, 0, 0, 0)
        view = QGraphicsView(self)
        self.scene = QGraphicsScene(self) 
        obj = GObject() 
        self.scene.addItem(obj) 
        view.setScene(self.scene)

        btn = QPushButton('animate', self)
        vbox.addWidget(view)
        vbox.addWidget(btn)
        btn.clicked.connect(partial(obj.animatePos, QPointF(0,0), QPointF(10, 5))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:19:19.183

您没有保留对`anim`对象的任何引用，因此它在发出任何内容之前立即被销毁。

同样在 python 中，您可以更优雅地连接信号：

```
anim.valueChanged.connect(self.go)
self.anim = anim 
```

代替：

```
self.connect(anim, SIGNAL('valueChanged(const QVariant&)'), self.go) 
```

将解决您的问题。

# c# - Dispatcher 的实用性和良好实践

> ID：10654374
> 
> 赞同：3
> 
> 时间：2012-05-18T14:20:08.633
> 
> 标签：c#, .net, multithreading

为了让我的问题保持简单，让我们说我使用线程动态更新字符串中的替换。在我的真实代码中，我需要一个线程。我知道我可以在这个简单的例子中避免它。

所以，我的软件有两个领域。用户选择一个文件，编写一个（某种）正则表达式并在输入句子的同时查看修改结果。我在用户选择文件时启动线程（请参阅 listViewFiles_SelectionChanged 方法）。我的线程的工作是在 DoWork 方法中。

```
public void DoWork()
    {
        while (true)
        {
            FileData fileData = _selectedFile;
            if (fileData != null)
            {
                string name = fileData.FileName;
                string searchRegEx = GenerateRegex(_searchTextBox.Text);
                string replacement = _replaceTextBox.Text;
                name = Regex.Replace(name, searchRegEx, replacement);
                /*
                foreach (var action in _actionCollection)
                {
                    name = action.Rename(name);
                }*/

                _searchSample.Content = fileData.FileName;
                _replaceSample.Content = name;
            }
            Thread.Sleep(1000);
        }
    }

    private void listViewFiles_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        _selectedFile = listViewFiles.SelectedItem as FileData;
        _thread.Start();
    } 
```

当我的线程做他的工作时，我在行字符串 searchRegEx = GenerateRegex(_searchTextBox.Text); 上遇到异常。：调用线程无法访问此对象，因为不同的线程拥有它。我读了很多关于这个异常的内容，但我不明白。

为了解决这个问题，我用 Dispatcher 包围了我的代码。我不明白机制，但它的工作原理。我不知道它是否正确或高效，但它有效。

```
 public void DoWork()
    {
        while (true)
        {
            FileData fileData = _selectedFile;
            if (fileData != null)
            {
                //use Window.Dispatcher
                this.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal,
                    new Action(delegate()
                    {
                        string name = fileData.FileName;
                        string searchRegEx = GenerateRegex(_searchTextBox.Text);
                        string replacement = _replaceTextBox.Text;
                        name = Regex.Replace(name, searchRegEx, replacement);
                        /*
                        foreach (var action in _actionCollection)
                        {
                            name = action.Rename(name);
                        }*/

                        _searchSample.Content = fileData.FileName;
                        _replaceSample.Content = name;
                    }));
            }
            Thread.Sleep(1000);
        }
    }

    private void listViewFiles_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        _selectedFile = listViewFiles.SelectedItem as FileData;
        _thread.Start();
    } 
```

我想知道这段代码是否正确且正确。您会在评论中看到 foreach 指令。我的代码应该做很多工作，我不知道在 delagate 中这样做是否是最好的方法。Dispatcher 的实用性和良好实践？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T15:24:32.803

我认为您的单个帖子中有很多问题，我将尝试解决所有问题：

**从其他线程访问可视化控件**

Winforms 和 WPF 都是基于*只有一个线程可以更改对象状态*这一事实而构建的，当然，该线程与创建对象的线程相同。

你可以想象为什么这很重要：控件是知道如何“渲染”或“绘制”自己的对象。在绘制、调整大小、移动/被拖动时，不能从控件本身的“外部”更改对象的属性。当然，主线程已经忙于进行我提到的转换，所以它保证在主线程上运行的“用户”代码不会改变它。但是，另一个并行运行的线程可能正是这样做的。例如，想象一下，当第二个线程更改文本时，主线程正在渲染一个`TextBox`半单词的文本。例如，这会导致计算文本宽度的问题。

**使用调度程序**

线程调度程序所做的是将您的代码编组到主线程。你看，大多数可视化框架，包括 WinForms 和 WPF，都是基于“应用程序循环”的。这意味着您的应用程序在一个`while(true){}`块内运行。您的代码（例如，`listViewFiles_SelectionChanged`）会在需要时从此循环中调用。管理此调用的对象是`Dispatcher`. 它有一个要运行的东西*队列*，它决定下一个运行。当调度程序调用的代码运行时，应用程序的可视部分不会发生任何其他事情——毕竟，这就是线程正在做的事情，对吧？所以它不能处理用户输入、重新渲染屏幕等。

为您提供了一个接口，该`Dispatcher`接口可以从另一个线程调用，该线程通过将新方法插入到队列中来*发布*要由调度程序调用的新方法。正如您所理解的，它不会立即执行：您在调用主线程的第二个线程上，主线程可能正忙于渲染屏幕、处理输入甚至运行您的代码，例如`listViewFiles_SelectionChanged`. 一旦该循环迭代结束，`Dispatcher`将检查队列。根据您方法的优先级，它可能是下一个要执行的方法，甚至可能会等待更多迭代。

出于这个原因，如果您将您正在执行的所有操作都放在调度程序方法的第二个线程中，那么您实际上是在要求框架在主线程上运行您的第二个线程代码。而且，由于您的线程代码永远运行，主线程将永远忙于运行该代码（`DoWork`）并且将不再能够做任何其他事情。

**调度员良好实践**

因此，综上所述，当您将代码编组到调度程序时，主线程会忙于执行此操作。在忙碌时，您的应用程序变得*无响应*。因为我们一直想要一个响应式应用程序，所以我们必须在主线程上做**尽可能少的**事情，也就是说，无论我们要求 Dispatcher 编组什么。

既然如此，您必须做的只是编组访问 Controls 的**线路**。即使这意味着对 Dispatcher 的多次调用——当然，你会为这些调用付出代价，但它总比在你的代码中停留的时间长于主线程要好。

**使用单线程调度程序**

`Dispatcher`即使您没有第二个线程，它也可以帮助您。如果您需要执行长时间的计算，您可以使用一组标志或 a`enum`来跟踪状态。在该方法中，您调用调度程序传递您自己的方法（具有低优先级）并且它们返回（因此您将计算部分中断）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:52:57.900

问题是，您的代码正在访问 _searchTextBox.Text 和 __replaceTextBox.Text。您使用调度程序的解决方案正在运行，但实际上并没有解决任何问题。该代码将在 UI 线程中执行，但不会在 ListView 选择更改后立即执行。

要使其正常工作，请在没有调度程序的情况下返回您的第一个版本，但将 SearchText 和 ReplaceText 作为线程启动参数传递。这是一些伪代码：

```
var searchText = _searchTextBox.Text;
var replaceText = _replaceTextBox.Text
Thread.Start(() => DoWork(searchText, replaceText)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:48:58.130

您只能在创建 的线程中访问您的控件。在大多数情况下，它是 UI 线程。Windows 窗体就是这种情况，WPF 就是这种情况。调用 Dispatch 只会阻塞您的线程并在 UI 线程中运行其余线程，这会带走将工作卸载到其他线程的大部分好处，当然还会阻止 UI 线程执行其他工作。如上所述，解决方案是将您的 UI 代码与后台工作人员代码分开。在这种情况下，它很简单，因为您只使用来自界面的输入值，您可以从您在 UI 线程中添加项目的队列中获取这些输入值。需要同步对队列的访问以避免竞争条件（lock(queue.Synch)）。这是 Produce-Consumer 设计模式的经典案例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T14:51:04.760

所以，如果我们只看你的代码，我建议只将 ui update/get 代码包装到调用中，因为正如我所说，目前你只是在 UI 线程中调用你的代码，而你的附加线程无用，因为它只是调用和睡眠。

这是一个例子：

```
 private Thread _thread;

    public MainWindow()
    {
        InitializeComponent();

        _thread = new Thread(DoWork);

        _thread.Start();
    }

    private void DoWork()
    {
        while (true)
        {
            var str = (string)Dispatcher.Invoke(new Func<object>(() => NotifyLabel.Content));

            str += "a";

            Dispatcher.Invoke(new Action(() => NotifyLabel.Content = str));

            Thread.Sleep(500);
        }
    } 
```

我建议你阅读[调用](http://msdn.microsoft.com/ru-ru/library/system.windows.threading.dispatcher.invoke.aspx)信息&[有](https://stackoverflow.com/questions/3762576/wpf-backgroundworker-vs-dispatcher)一个关于调度程序/线程的有趣问题

PS：我一般不会审查你的多线程代码，因为如果你在这里使用 mvvm/other 模式可以大大改进

# python - Python：如何定义一个获取字符串列表或字符串的函数

> ID：10654377
> 
> 赞同：3
> 
> 时间：2012-05-18T14:20:22.767
> 
> 标签：python

假设我想向数据库添加一个字符串列表或一个字符串：

```
names = ['Alice', 'Bob', 'Zoe'] 
```

我希望这`add_to_db`两种情况都可以接受

```
add_to_db(names)
add_to_db('John') 
```

这是正确的方法吗：

```
def add_to_db(name_or_names):
    if (...):
        ... # add a single name
    else:
        for name in name_or_names:
            ... # add a single name
    commit_to_db() 
```

我应该在第一个中放入什么`...`，作为它是字符串列表还是字符串的条件（不要忘记字符串也是可迭代的）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T14:36:01.707

我认为您最好的选择是将单个字符串转换为 1 元素列表，然后让函数的其余部分专门处理列表。

```
def add_to_db(name_or_names):
    import types
    if isinstance(name_or_names, types.StringTypes):
        name_or_names = [name_or_names]
    try:
        for name in name_or_names:
            add_name(name)
        commit_to_db()
    except TypeError:
            # we didn't get a string OR a list >:( 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T14:27:55.033

使用关键字参数：

```
def add_to_db(name=None, names=None):
    if name:
        .....
    elif names:
        ....
    else:
        raise ValueError("Invalid arguments")

add_to_db(name='John')
add_to_db(names=['explicit', 'is', 'better']) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T14:36:30.340

测试对象是否是字符串而不是可迭代的可能更容易。这是我以前使用过的一种技术。确保它是一个列表，然后循环遍历它：

```
def add_to_db(name_or_names):
    if isinstance(name_or_names, basestring):
        # str or unicode, convert to list
        name_or_names = [name_or_names]
    for name in name_or_names:
        add_name_to_db() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-10-14T15:39:09.603

您可以声明实例类型，如：

```
from typing import List, Union

def my_fancy_func(l: Union[List [str], str]):
  if not isinstance(l, list):
    print("Error", type(sentence))
  else:
    print("Everything's okay") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T14:25:53.677

您可以测试参数是否具有`__iter__`属性，字符串将失败：

```
if hasattr(arg, '__iter__'):
    print "I am an iterable that is not a string!" 
```

从[这个答案](https://stackoverflow.com/a/1952481/4249)。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-05-18T14:36:09.173

您可以检查参数的类型：

```
>>> type('John')
<type 'str'>
>>> type(['explicit', 'is', 'better'])
<type 'list'> 
```

# python - 矩形的屏幕截图颜色平均

> ID：10654381
> 
> 赞同：9
> 
> 时间：2012-05-18T14:20:45.280
> 
> 标签：python, c, optimization, screenshot, python-imaging-library

我编写了一个快速的 Python 脚本来返回围绕我的屏幕周边的矩形的平均颜色。（这里的最终目标是在我的显示器周围安装[RGB LED 灯条，以便在看电影时产生发光效果 - 像](http://www.sparkfun.com/products/10312)[这样（youtube）](http://www.youtube.com/watch?v=mXBqg3Zeg0k)，但更有趣，因为我自己制作）。

我目前正在使用[autopy](http://pypi.python.org/pypi/autopy/0.51)将屏幕作为位图（“屏幕截图”）获取，获取每个像素值以及 RGB <-> HEX 转换。

简化版：

```
step = 1
width = 5
height = 5

b = autopy.bitmap.capture_screen()

for block in border_block(width, height): # for each rectangle around the perimeter of my screen

    R,G,B = 0,0,0
    count = 0

    for x in xrange(block.x_min, block.x_max, step):
        for y in xrange(block.y_min, block.y_max, step):
            r,g,b = autopy.color.hex_to_rgb(image.get_color(x, y))
            R += r; G += g; B += b
            count += 1

   block.colour = "#{:06x}".format(autopy.color.rgb_to_hex(R/count,G/count,B/count)) 
```

然后我使用`matplotlib`: (这被配置为 5x5 块，step = 1)显示块

![5x5 截图](../Images/9649768057db20c9e2ab1367e4151f42.png)

问题在于执行速度 - 因为这是循环块中的每个像素（2560*1600 分辨率/5 = 320*512 块 = 每块 163,840 像素），以及周边的每个块（16*163,840 = 2,621,440 循环）。总的来说，这需要 2.814 秒才能完成。

如果我增加步长值，它会加快速度，但还不够：（这是在边界周围使用更逼真的 15x10 块）

```
Step    Time (s)
1       1.35099983215
2       0.431000232697
5       0.137000083923
10      0.0980000495911
15      0.095999956131
20      0.0839998722076
50      0.0759999752045 
```

那是因为屏幕截图本身大约需要 0.070 秒 - 这意味着我被限制为 12.8 FPS。

```
>>> timeit.Timer("autopy.bitmap.capture_screen()", "import autopy").timeit(100)/100
0.06874468830306966 
```

**问题：**

*   有没有更快的截屏和平均屏幕区域的方法？

    我不太担心准确性，但希望能够以大约 30 FPS 的速度返回这些值，理想情况下更快（20-30 ms）以允许串行传输开销。请记住我的屏幕分辨率是 2560*1600！

    我听说过[Python Imaging Library (PIL)](http://www.pythonware.com/products/pil/)，但还没有时间研究该`ImageGrab`函数的速度，但它看起来很有希望。

*   我可以直接从 GPU 读取像素值吗？

*   另一个想法 - 检测电影顶部/底部边缘的最佳方法是什么？（如果宽高比是宽屏，屏幕截图顶部/底部有黑条，一些矩形是黑色的）。

* * *

**使用 PIL 的 grab()**：

```
>>> timeit.Timer("ImageGrab.grab()", "from PIL import ImageGrab").timeit(100)/100
0.1099840205312789 
```

* * *

**PIL - 调整大小：**（ChristopheD）

```
>>> timeit.Timer("PIL.ImageGrab.grab().resize((15, 10), PIL.Image.NEAREST)", "import PIL").timeit(100)/100
0.1028043677442085

>>> timeit.Timer("PIL.ImageGrab.grab().resize((15, 10), PIL.Image.ANTIALIAS)", "import PIL").timeit(100)/100
0.3267692217886088 
```

注意：这是对上面获得的结果的改进，但我们仍然限制在 9 FPS 或 3 FPS 与完全抗锯齿。

* * *

**PIL - 最接近然后调整大小：**（Mark Ransom）

```
>>> for step in [1,2,5,10,15,20,50]:
    print step, timeit.Timer("PIL.ImageGrab.grab().resize(("+str(2560/step)+", "+str(1600/step)+"), PIL.Image.NEAREST).resize((15, 10), PIL.Image.ANTIALIAS)", "import PIL.ImageGrab").timeit(100)/100 
```

结果：

```
Step  Time(s)
1     0.333048412226
2     0.16206895716
5     0.117172371393
10    0.102383282629
15    0.101844097599
20    0.101229094581
50    0.100824552193 
```

比`autopy`在顶部手动循环要快得多，但我们仍然限制在 ~9 FPS（“步长”为 10）。

注意：这不包括所需的 RGB 到 HEX 转换

* * *

谁能想出一个更快的方法 - 即截取部分截图？我应该用C写一些东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T14:57:45.980

使用 Python 图像库。从[文档](http://www.pythonware.com/library/pil/handbook/index.htm "PIL 文档")（在图像模块中）：

> **获取颜色**
> 
> im.getcolors() => （计数，颜色）元组列表或无
> 
> im.getcolors(maxcolors) => （计数，颜色）元组列表或无
> 
> （1.1.5 中的新功能）返回 (count, color) 元组的未排序列表，其中 count 是相应颜色在图像中出现的次数。

Image 模块还包含一个crop() 方法，您可以使用该方法将每个矩形插入到getcolors() 中。您可以轻松地从中获取加权平均值。

它应该比在 python 中手动运行循环要快得多。我不确定它是否足够快以实时使用，但您会获得显着的速度提升。您也可以每秒截取几次屏幕截图，因为以 60 fps 和 10 fps 向 LED 发送信号的可能性不大。不要将其视为“限制为 12.8 FPS”，将其视为“只能每 5 帧更新一次 LED”，这应该不会是明显的差异。

编辑：如果您*真的*对这里的进一步优化感兴趣，我想您会发现[在 windows 上使用 python 截屏的最快方法](https://stackoverflow.com/questions/3586046/fastest-way-to-take-a-screenshot-with-python-on-windows)非常有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T16:40:02.577

要加快调整大小操作，您可以分两步完成。对第一个使用 NEAREST 以尽可能快的方式减少像素数量，然后使用 ANTIALIAS 将它们合并到一个有代表性的样本中。它等同于您之前尝试过的步长，使用 PIL 函数完成。

```
PIL.ImageGrab.grab().resize((150, 100), PIL.Image.NEAREST).resize((15, 10), PIL.Image.ANTIALIAS) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T14:45:03.677

一个快速的胜利可能是对`resize`5x5 图像使用操作（在 PIL 中）（您可以使用简单的插值来提高速度）而不是对区域进行平均，例如：

```
myimg = ImageGrab.grab()
resized = myimg.resize((5, 5), Image.NEAREST) 
```

这应该产生与自己进行平均工作大致相同的效果。

虽然不太确定 PIL 的 ImageGrab 的速度（以及它与 的比较`autopy`），但尝试找出它很容易。

# java - 使用 JPA2 进行多个连接

> ID：10654382
> 
> 赞同：0
> 
> 时间：2012-05-18T14:20:48.210
> 
> 标签：java, jpa-2.0

我正在尝试掌握 JPA2 并尝试进行几次连接以获得一个结果。这是我目前尝试过的：

```
CriteriaBuilder cb = getEntityManager().getCriteriaBuilder();
CriteriaQuery<FileCollection> cq = cb.createQuery(getEntityClass()); // getEntityClass() will return FileCollection.class

Root<FileCollection> collectionRoot = cq.from(getEntityClass());
Join<FileCollection, Repository> repositories = collectionRoot.join(FileCollection_.repository);
Join<Repository, Customer> customers = repositories.join(Repository_.customer);

cq.select(collectionRoot);
cq.where(cb.equal(customers.get(Customer_.name), customerName),
    cb.equal(repositories.get(Repository_.name), repositoryName) ,
    cb.equal(collectionRoot.get(FileCollection_.folderName), folderName)
);

return getEntityManager().createQuery(cq).getSingleResult(); 
```

这虽然行不​​通。如果我注释掉 where 调用的第二个和第三个参数，它就可以工作（所以我只提供一个客户名称）。所以我搞错了。我只是不知道是什么！这是我试图以 SQL 表示的查询：

```
SELECT f.*
FROM filecollection f
JOIN repository r ON f.REPOSITORY_ID = r.REPOSITORY_ID
JOIN customer c ON r.CUSTOMER_ID = c.CUSTOMER_ID
WHERE c.NAME = 'X' AND r.NAME = 'Y' AND f.FOLDER_NAME = 'Z'; 
```

任何人都可以帮助我并指出我的错误。同时，我将回到我的 JPA2 书，看看我是否能解决这个问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:36:46.550

我认为应该是这样的：

```
cq.where(cb.and(cb.equal(customers.get(Customer_.name), customerName),
                cb.equal(repositories.get(Repository_.name), repositoryName) ,
                cb.equal(collectionRoot.get(FileCollection_.folderName), folderName)
)); 
```

# c# - WCF - 发布 JSON 对象

> ID：10654383
> 
> 赞同：4
> 
> 时间：2012-05-18T14:20:51.180
> 
> 标签：c#, json, wcf

我正在尝试将 JSON 发布到 WCF 服务。json 对象包含一个数组。我想知道如何正确绑定到我的数据合同。如果有人可以在这里给我指点，我将不胜感激。目前我的购物车对象为空

这是我的服务接口的样子：

```
public interface IService
 {

[OperationContract]
 [WebInvoke(UriTemplate = "/cart", Method = "POST", BodyStyle = WebMessageBodyStyle.Wrapped, RequestFormat = WebMessageFormat.Json,ResponseFormat = WebMessageFormat.Json)]
 Ship GetShipInfo( Cart cart, string Website);
 }

[DataContract]
 public class Cart
 {
 [DataMember]
 public Int32 ProductID { get; set;}
 [DataMember]
 public decimal ItemPrice { get; set; }
 [DataMember]
 public Int16 Qty { get; set; }
 [DataMember]
 public String SizeWidth { get; set; }
 } 
```

我的客户电话如下

客户电话

```
using System;
 using System.Collections.Generic;
 using System.Linq;
 using System.Web;
 using System.Web.UI;
 using System.Web.UI.WebControls;
 using System.Runtime.Serialization.Json;
 using System.Net;
 using System.IO;

public partial class _Default : System.Web.UI.Page
 {
 protected void Page_Load(object sender, EventArgs e)
 {

DataContractJsonSerializer obj = new DataContractJsonSerializer(typeof(string));
 Cart cart = new Cart{ ProductID = 1000, ItemPrice = Convert.ToDecimal(32.50), Qty = 1, SizeWidth = “6M” };
 WebClient Proxy1 = new WebClient();
 Proxy1.Headers["Content-type"] = “application/json”;
 MemoryStream ms = new MemoryStream();
 DataContractJsonSerializer serializerToUplaod = new DataContractJsonSerializer(typeof(Cart));
 serializerToUplaod.WriteObject(ms, cart);

 byte[] data = Proxy1.UploadData(“http://localhost:54897/IphoneService.svc/cart”, “POST”, ms.ToArray());
 Stream stream = new MemoryStream(data);
 obj = new DataContractJsonSerializer(typeof(Ship));
 var Ship = obj.ReadObject(stream) as Ship;

}

public class Ship
 {
 public Decimal SecondDay { get; set; }
 public Decimal NextDay { get; set; }
 }

public class Cart
 {

public Int32 ProductID { get; set; }

public Decimal ItemPrice { get; set; }

public Int16 Qty { get; set; }

public String SizeWidth { get; set; }
 }

} 
```

我的 JSON 看起来像这样

```
{"cart":
[
{"ProductID":2957,
"Qty":1,
"ItemPrice":60,
"SizeWidth":"5M"}
]
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T14:34:10.263

来自 Fiddler 的 WCF REST 方法的原始请求应如下所示：

```
POST http://localhost:54897/IphoneService.svc/cart HTTP 1.1
Content-Type: application/json
Host: localhost

{"cart":{"ProductId":1,"ItemPrice":60,"Qty":1,"SizeWidth":"5M"},"Website":"sample website"} 
```

JSON 中的响应如下所示：

```
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 30

{"SecondDay":5.0, "NextDay":7.0} 
```

# android - Flex 移动 Android 4 网络访问

> ID：10654387
> 
> 赞同：0
> 
> 时间：2012-05-18T14:21:00.937
> 
> 标签：android, apache-flex, networking, mobile

我有一个用 Flex 4 编写的移动 Android 应用程序连接到 facebook。它工作得很好，但知道我有 Android 4 的问题。问题是我的应用程序无法访问互联网。您知道 Android 4 中是否有一些限制或其他可能导致此问题的限制？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T08:25:54.863

The solution is to update to AIR 3.2 . And also the problem is not fixed fot the Android emulator. So after update to AIR 3.2 its work on the device , but not on emulator.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T08:58:47.007

从 Android 4 开始，您不再可以在主线程中进行网络通信。这可能是问题吗？

# select - 使用 selenium 进行选择更改时如何检查插入了哪个字段

> ID：10654392
> 
> 赞同：1
> 
> 时间：2012-05-18T14:21:35.823
> 
> 标签：select, selenium, input, onchange

我需要知道单击选择输入中的选项时如何检查页面中的哪些更改。这是选择输入：

```
<select onchange="showCategory('category', 'carextras', 'company_ad', 'err_category');suggestCategory(document.formular.subject.value, this.value, 'subject-warning');" name="category" id="category"> 
```

单击一个选项，javascript 将根据用户单击的内容创建不同的输入类型（文本、选择和其他）。我需要知道如何获取页面中插入的输入。有人能帮我吗？有人可以给我一个建议吗？谢谢！！！:)

解决了（不好的方式），感谢JacekM，以这种方式：

```
WebElement cat =(new WebDriverWait(d, 1))
                .until(new ExpectedCondition<WebElement>(){
                    @Override
                    public WebElement apply(WebDriver d) {
                        return d.findElement(By.id("categoria"));
                    }}); 
        Select allCategory = new Select(cat);
        File f = new File("ebay1.txt");
        PrintWriter pw = new PrintWriter(f);
        pw.write("Categoria\n\t\tSottocategoria\n\t\t\t\tCampi\n");
        List<WebElement> categorie = allCategory.getOptions(); 
        for(int i=1;i<3;i++){
            pw.append(categorie.get(i).getText()+"\n");
            categorie.get(i).click();
            WebElement subcat =(new WebDriverWait(d, 1))
                    .until(new ExpectedCondition<WebElement>(){
                        @Override
                        public WebElement apply(WebDriver d) {
                            return d.findElement(By.id("sottocategoria"));
                        }}); 
            Select allSubCategory = new Select(subcat);
            List<WebElement> sottocategorie = allSubCategory.getOptions();
            sottocategorie.get(0).click();
            for(int j=1;j<sottocategorie.size();j++){
                List<WebElement> before = d.findElements(By.tagName("input"));
                List<WebElement> before_select = d.findElements(By.tagName("select"));
                List<WebElement> before_textarea = d.findElements(By.tagName("textarea"));
                List<String> before_inv = new ArrayList<String>();
                List<String> after_inv = new ArrayList<String>();
                for(WebElement bef : before){
                    if(bef.isDisplayed()){
                        String id = bef.getAttribute("id");
                        List<WebElement> labels = d.findElements(By.tagName("label"));
                        for(WebElement lab : labels){
                            if(lab.getAttribute("for").equals(id)){
                                before_inv.add(lab.getText());
                            }
                        }
                    }
                }
                for(WebElement bef : before_select){
                    if(bef.isDisplayed()){
                        String id = bef.getAttribute("id");
                        List<WebElement> labels = d.findElements(By.tagName("label"));
                        for(WebElement lab : labels){
                            if(lab.getAttribute("for").equals(id)){
                                before_inv.add(lab.getText());
                            }
                        }
                    }
                }
                for(WebElement bef : before_textarea){
                    if(bef.isDisplayed()){
                        String id = bef.getAttribute("id");
                        List<WebElement> labels = d.findElements(By.tagName("label"));
                        for(WebElement lab : labels){
                            if(lab.getAttribute("for").equals(id)){
                                before_inv.add(lab.getText());
                            }
                        }
                    }
                }

                sottocategorie.get(j).click();
                pw.append("\t\t"+sottocategorie.get(j).getText()+"\n");

                List<WebElement> after = d.findElements(By.tagName("input"));
                List<WebElement> after_select = d.findElements(By.tagName("select"));
                List<WebElement> after_textarea = d.findElements(By.tagName("textarea"));
                for(WebElement aft : after){
                    if(aft.isDisplayed()){
                        String id = aft.getAttribute("id");
                        List<WebElement> labels = d.findElements(By.tagName("label"));
                        for(WebElement lab : labels){
                            if(lab.getAttribute("for").equals(id)){
                                after_inv.add(lab.getText());
                            }
                        }
                    }
                }
                for(WebElement aft : after_select){
                    if(aft.isDisplayed()){
                        String id = aft.getAttribute("id");
                        List<WebElement> labels = d.findElements(By.tagName("label"));
                        for(WebElement lab : labels){
                            if(lab.getAttribute("for").equals(id)){
                                after_inv.add(lab.getText());
                            }
                        }
                    }
                }
                for(WebElement aft : after_textarea){
                    if(aft.isDisplayed()){
                        String id = aft.getAttribute("id");
                        List<WebElement> labels = d.findElements(By.tagName("label"));
                        for(WebElement lab : labels){
                            if(lab.getAttribute("for").equals(id)){
                                after_inv.add(lab.getText());
                            }
                        }
                    }
                }
                List<String> finale = new ArrayList<String>();
                for(String fin : after_inv){
                    if(!before_inv.contains(fin)){
                        finale.add(fin);
                    }
                }
                for(String fin:finale){
                    pw.append("\t\t\t\t"+fin.replace(":", "")+"\n");
                }
                sottocategorie.get(0).click();
            }
        }

        pw.close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:20:16.350

乍一看您提供的页面似乎所有元素都存在于页面上，它们只是使用 style="display:none" 隐藏。因此，您可以检查元素的样式或可见性。

```
String style = element.getAttribute("style");
boolean visible = element.isDisplayed(); 
```

如果手动指定所有元素太困难，您可以尝试

```
List<WebElement> elements = driver.findElement(By.xpath("//some/xpath")).findElements(By.xpath(".//*")); 
```

获取 //some/xpath 下的所有元素并在循环中调用我上面提到的方法。您可以创建一个仅存储布尔值的相同大小的列表 - 通过 element.isDisplayed() 方法获得的结果。然后，您可以将布尔值与元素的当前状态进行比较，以查看其中哪些已更改。

您还可以将所有不可见元素存储在数组中，然后每次单击页面上的某些内容时 - 遍历它们并查看其中哪一个发生了变化。

```
List<WebElement> elements = driver.findElement(By.xpath("//some/xpath")).findElements(By.xpath(".//*"));
List<WebElement> invisibles = new ArrayList<WebElement>();

for (WebElement elem : elements)
{
   if (!elem.isDisplayed())
   {
      invisibles.add(elem)
   }
}

//...

for (WebElement elem : invisibles)
{
   if (elem.isDisplayed())
   {
      //element has appeared
   }
} 
```

这个解决方案的问题是它只会处理页面上出现的元素，而不是消失的元素。

# video-encoding - 通过 vfw 的 XVID 编解码器：创建灰度 8 位视频失败

> ID：10654394
> 
> 赞同：0
> 
> 时间：2012-05-18T14:21:41.963
> 
> 标签：video-encoding, vfw

我编写了一个应用程序，它使用 Windows 视频 (VFW) 从实时摄像机图像中记录 XVID 电影。如果相机设置为彩色，这可以正常工作。当我将它切换到黑白模式（即 8 位灰度）时，函数 AVIStreamSetFormat 返回 AVIERR_BADFORMAT。

摘自我的代码：

```
BITMAPINFO *bmi = image->bitmapInfo();

AVISTREAMINFO info;
::ZeroMemory(&info,sizeof(AVISTREAMINFO));
info.fccType               = streamtypeVIDEO;
info.dwScale               = 1000;
info.dwRate                = int(framesPerSecond * 1000);
info.dwSuggestedBufferSize = image->bufferSize();
SetRect(&info.rcFrame, 0, 0, image->width(), image->height());

AVICOMPRESSOPTIONS options;
::ZeroMemory(&options, sizeof(options))
options.fccType = streamtypeVIDEO;
options.fccHandler = mmioFOURCC('X','V','I','D');
options.dwFlags = AVICOMPRESSF_VALID | AVICOMPRESSF_KEYFRAMES;

info.fccHandler = options.fccHandler;
AVIFileCreateStream(pfile, &pavi, &info);

options.dwKeyFrameEvery = 1;
options.dwQuality = -1;
options.dwInterleaveEvery = 0;

HRESULT result = AVIMakeCompressedStream(&pcompressed, pavi, &options, NULL);

size_t bmisize = bmi->bmiHeader.biSize + bmi->bmiHeader.biClrUsed*sizeof(RGBQUAD);
result = AVIStreamSetFormat(pcompressed, 0, &bmi->bmiHeader, bmisize); 
```

如上所述，此代码适用于 24 位 DIB，但不适用于 8 位索引 DIB。可以毫无问题地显示 8 位 DIB。

有任何想法吗？

干杯亨德里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T08:29:19.767

我做了更多的研究并查看了 xvidcore 源代码，不幸的是，它很清楚不支持 8 位灰度源。vfw/src/codec.c 中的函数 get_colorspace() 只识别 RGB 和 YUV 模式。

divx编解码器的情况可能相同，尽管我没有研究过来源。

所以答案是：选择不同的编解码器或仅限于彩色视频。

# c# - Visual C# 2005 中的问题在 Dataview 中查找并选择要突出显示的行

> ID：10654401
> 
> 赞同：0
> 
> 时间：2012-05-18T14:22:18.980
> 
> 标签：c#, winforms, datatable, visual-studio-2005, dataview

我有一个填充了各种行的数据表，每行都有几列（即 ID、名称、描述..）

我正在尝试实现一个搜索按钮，用户通过组合框选择一列，例如 ID 或名称，并在单击搜索按钮后在文本框中键入他们请求的搜索我想要他们正在查找的行对于在屏幕上选择和突出显示而不将表格作为键，将所有内容保持在表格最初填充的顺序中。另一个注意事项是我希望所有项目仍然可见，所以我不会使用 .rowfilter ，因为它已经在单独的按钮中实现。我已经弄清楚如何通过它的索引来定位该行并相应地更新了代码。只是想知道我如何在所述行上居中屏幕并突出显示它而不会混淆表格的顺序

这是我到目前为止所拥有的：

```
private void buttonSearch_Click(object sender, EventArgs e)
{
    string query = textSearch.Text;
    int intquery = Int32.Parse(query);
    DataTable dt = GetAlarmTable();
    DataView dv = new DataView(dt);
    DataRow[] foundRows;
    switch (comboboxSearch.Text)
    {
         case "ID":
         {

              dv.Sort = "ID"; 
              index = dv.Find(intquery);
              foundRows = dt.Select("ID = '" + intquery + "'");
              break;
          } 
    }
//??? ???

} 
```

如果您有要分享的代码、想法或链接，请告诉我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T17:07:08.410

这是我通常使用的功能。确保您将`SelectionMode`属性`DataGridView`设置为`FullRowSelect`.

```
public static void EnsureGridRowIsSelectedAndVisible(DataGridViewRow row)
{
    if (row == null)
        return;

    row.Selected = true;

    // Center the item in the display
    row.DataGridView.FirstDisplayedScrollingRowIndex = 

        Math.Max(row.Index - Convert.ToInt32(row.DataGridView.DisplayedRowCount(false) / 2), 0);
} 
```

# asp.net - 为什么 Asp.NET WebApi 使用 ExceptionFilter 呈现 IIS 错误页面作为响应？

> ID：10654402
> 
> 赞同：2
> 
> 时间：2012-05-18T14:22:26.250
> 
> 标签：asp.net, asp.net-mvc, asp.net-web-api

我有以下异常过滤器：

```
public class ServiceLayerExceptionFilter : ExceptionFilterAttribute
    {
        public override void OnException(HttpActionExecutedContext context)
        {
            if (context.Result == null)
            {
                context.Result = new HttpResponseMessage();
            }

            context.Result.StatusCode = context.Exception.ConvertToHttpStatus();   
            base.OnException(context);
        }
    } 
```

我的 ConvertToHttpStatus() 只是一个扩展，它查找映射到 HttpStatusCodes 的异常类型的 Dictionary 对象。http 状态码正在正确转换。但是在响应负载中，我得到一个 IIS 错误页面。最好我想让响应为空，或者更好地将异常消息作为 json 传递。有谁知道我为什么返回 IIS 错误页面以及如何返回空内容或有效内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T17:10:19.003

您没有向您创建的 HTTP 响应消息写入任何内容。尝试添加一些内容：

```
public class ServiceLayerExceptionFilter : ExceptionFilterAttribute
{
    public override void OnException(HttpActionExecutedContext context)
    {
        var message = new HttpResponseMessage(HttpStatusCode.InternalServerError);
        message.CreateContent(typeof(Foo), new Foo { Bar = "baz" });
        context.Result = message;
    }
} 
```

# vim - Vim 可以将 BOL 空格显示为特殊字符吗？

> ID：10654416
> 
> 赞同：4
> 
> 时间：2012-05-18T14:23:11.707
> 
> 标签：vim

Sublime（文本编辑器）可以将行首空白显示为特殊字符，例如`--->`：

```
function foo() {
--->if (true) {
--->--->alert(true);
--->}
} 
```

在某些情况下它很有帮助。所以我想让 Vim 做同样的事情。我尝试使用`:set list`，但此选项仅将制表符显示为 `^I`，它不显示空格。有没有办法像在 Sublime 中那样做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T22:32:55.053

您可以突出显示 BOL 空白，这不会像您要求的那样插入特殊字符，但它至少会通过为其分配特定颜色使其突出。

```
:highlight BOLWhitespace guibg=red ctermbg=red
:match BOLWhitespace /^\s\+/ 
```

第一行将创建一个名为 BOLWhitespace 的高亮组，并将其设置为红色（可能想要使用一些更微妙的东西）。第二行将为行首的所有空白激活此突出显示。

也许这是一个可以接受的妥协？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T07:24:25.580

可以使用隐藏功能有效地模拟此类箭头（请参阅 参考资料`:help conceal`）：

```
function! EnableIndentArrows()
    exe 'syntax match NonText ''\%(^\%( \{'.&sw.'}\)*'.
    \   ' \{0,'.(&sw-2).'}\)\@<= '' transparent conceal cchar=┈'
    exe 'syntax match NonText ''\%(^\%( \{'.&sw.'}\)*'.
    \   ' \{'.(&sw-1).'}\)\@<= '' transparent conceal cchar=>'
    set conceallevel=2 concealcursor=nc
endfunction 
```

# mysql - MySQL计算天数

> ID：10654420
> 
> 赞同：0
> 
> 时间：2012-05-18T14:23:20.190
> 
> 标签：mysql, subquery

我有一张桌子，上面有这样的订单：

```
+----------+-------------+------------+
| order_id | customer_id | order_date |
+----------+-------------+------------+
|    404   |     16      | 2006-11-04 |
|    726   |     16      | 2007-11-01 |
|    440   |     16      | 2010-03-15 |
|    515   |     16      | 2011-04-29 |
|    539   |     16      | 2011-11-01 |
|    293   |     89      | 2001-08-28 |
|    156   |     89      | 2002-05-03 |
|    238   |     89      | 2003-09-15 |
|    299   |     28      | 2001-10-26 |
|    314   |     28      | 2004-03-18 |
|    142   |     79      | 2002-01-21 |
|    313   |     12      | 2004-03-11 |
|    388   |     12      | 2005-11-22 |
|    507   |     12      | 2007-03-27 |
|    286   |     14      | 2006-04-17 |
|    200   |     14      | 2008-05-25 |
|    130   |     14      | 2009-06-24 |
|    527   |     19      | 2011-05-14 |
|    298   |     76      | 2001-10-20 |
|    165   |     76      | 2002-07-27 |
|    212   |     11      | 2003-02-17 |
|    412   |     11      | 2006-08-02 |
|    423   |     11      | 2007-03-28 |
|    388   |     10      | 2005-01-07 |
|    390   |     65      | 2006-06-07 |
|    44    |     65      | 2008-01-07 |
|    269   |     16      | 2008-02-25 |
|    413   |     14      | 2007-12-01 |
|    675   |     14      | 2007-09-11 |
|    260   |     14      | 2009-10-20 |
+----------+-------------+------------+ 
```

现在我需要一个查询，它给我一个这样的列表：

```
+-------------+------------+------------+------+
| customer_id |    date1   |    date2   | days |
+-------------+------------+------------+------+
|     16      | 2006-11-04 | 2007-11-01 | 362  |
|     16      | 2007-11-01 | 2010-03-15 | 865  |
|     16      | 2010-03-15 | 2011-04-29 | 410  |
|     16      | 2011-04-29 | 2011-11-01 | 186  |
|     89      | 2001-08-28 | 2002-05-03 | 248  |
|     89      | 2002-05-03 | 2003-09-15 | 500  |
+-------------+------------+------------+------+ 
```

列 days 是每个客户从一个订单到下一个订单的时间跨度（以天为单位）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T17:16:30.890

你可以试试这个，很好的测试...

```
SELECT distinct(c1.customer_id) as 'customer_id', 
```

`(select min(c2.order_date) from tmp2 c2 where c2.customer_id=c1.customer_id) as date1, (select max(c2.order_date) from tmp2 c2 where c2.customer_id=c1.customer_id) as date2, (DATEDIFF( (select max(c40.order_date) from tmp2 c40 where c40.customer_id=c1.customer_id) , (select min(c40.order_date) from tmp2 c40 where c40.customer_id=c1.customer_id) )) as 'days' FROM`tmp2`as c1 WHERE 1`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:38:37.957

你可以尝试这样的事情：

```
SELECT A.customer_id, 
    A.date as date1, 
    B.date as date2, 
    datediff(B.date, A.date) as days
FROM (select @curRowA := @curRowA + 1 AS row_number, 
        customer_id, 
        date from 
        orders 
    ORDER BY customer_id asc, date desc) A
INNER JOIN (select @curRowB := @curRowB + 1 AS row_number, 
            customer_id, 
            date from orders 
    ORDER BY customer_id asc, date desc offset 1) B
ON A.row_number = B.row_number AND A.customer_id = B.customer_id 
```

如您所见，我有一个子查询，它从订单表中选择所有记录，但将 row_number 添加到 A，然后我做同样的事情，但只是向下移动一行（偏移量 1）并创建 B。然后我只是加入 A 和 B你得到结果。

```
A
    row_id, customer, date
    1, 1, d1
    2, 1, d2
    3, 1, d3
    4, 2, d4
    5, 2, d5

B
    row_id, customer, date
    1, 1, d2
    2, 1, d3
    3, 2, d4
    4, 2, d5 
```

当 A 和 B 连接时

```
result
customer, date1, date2
1, d1, d2
1, d2, d3
2, d4, d5 
```

更新：根据 Marc 的评论，最好尝试从相关查询（按客户）中获取 date2，在该查询中选择小于 date 的日期并将结果限制为 1 行。

# java - 从源代码文件的代码中删除注释并打印代码（文件中没有注释）

> ID：10654422
> 
> 赞同：0
> 
> 时间：2012-05-18T14:23:32.400
> 
> 标签：java

**例如，考虑以下文本：**

```
import java.util.*;

/* My program
by           */
public class Program {
   public static void main(String[] args) {
      System.out.println("Hello, world!"); // a println
   }

   public static /* Hello there */ void foo() {
      System.out.println("Goodbye!"); // comment here
   } /* */
} 
```

如果文件包含此文本，则程序应输出以下文本：

```
import java.util.*;

public class Program {
   public static void main(String[] args) {
      System.out.println("Hello, world!");
   }

   public static  void foo() {
      System.out.println("Goodbye!");
   }
} 
```

**好吧，我为它编写了代码并命名了一个名为的函数，该函数`stripComments`接受相关文件的扫描仪输入：**

```
public void stripComments(Scanner input){

    while(input.hasNextLine()){
        boolean flag=false;

        String scan=input.nextLine();
        Scanner line=new Scanner(scan);
        while(line.hasNext()){

            String token=line.next();
            if(token.equals("/*")){
                while(line.hasNext()){

                    if(line.next().equals("\\*")){
                        token=line.next();
                        flag=true;
                        break;
                    }
                }
                if(!flag){
                    while(input.hasNextLine()){
                        scan=input.nextLine();
                        line=new Scanner(scan);

                        while(line.hasNext()){

                            token=line.next();
                            if(token.equals("*\\")){

                                token=line.next();
                                flag=true;
                                break;
                            }
                        }

                    }

                }
            }
            else{
                System.out.print(token+" ");

            }

        }
        System.out.println();

    }

} 
```

但是产生的输出是：

```
import java.util.*; 
```

而已！！！！

谁能指出我哪里出错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:25:42.477

设置`flag`为 true 后，您将在第二个中使用整个输入

```
while(input.hasNextLine()){ 
  //...
} 
```

堵塞。

另外，（一旦你解决了）：一旦你设置了`flag`，你永远不会取消它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:26:05.633

你的代码中没有任何地方是你在寻找的`*/`，这标志着多行注释的结束。结果，一旦注释从第 2 行开始，它就永远不会结束。

此外，对于这个特定任务，我建议一次查看输入一个字符，而不是一次`Scanner`查看一个标记。再加上一个简单的[状态机](http://en.wikipedia.org/wiki/Finite-state_machine)，这可能会导致一个简单而健壮的实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:29:53.973

您应该在整个文件内容上使用 2 个正则表达式（用于 /**/ 和 //），而不是逐行工作。

# ios - iOS 企业开发者计划 - 规则

> ID：10654423
> 
> 赞同：1
> 
> 时间：2012-05-18T14:23:41.507
> 
> 标签：ios, enterprise-distribution

我工作的公司想要分发（在公共链接中）带有内部签名的应用程序。我很确定Apple否认这种事情，但我在官方文档/合同中没有找到任何内容。

有人知道它是如何工作的或写在哪里吗？

问候！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-09T14:24:09.870

我在会员中心找到的。选择您的帐户选项卡，然后在左侧窗格中选择法律协议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:27:42.653

Apple 的页面非常明确：“将您专有的内部 iOS 应用程序分发给您组织的员工或成员。您还可以安全地为员工托管和无线分发或更新内部应用程序，让它们随时随地保持最新状态。 "

对我来说似乎**没有**！

或者直接打电话给苹果。开发人员支持号码是 800 633-2152。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:29:17.130

请参阅问题“[企业 iPhone 应用程序无线分发的安全性 - OTA iOS](https://stackoverflow.com/questions/9108123/security-of-over-the-air-distribution-of-enterprise-iphone-apps-ota-ios) ”以了解通过企业分发的限制（证书是问题）。

有关部署的更多信息可以在这里找到：

*   [http://manuals.info.apple.com/en_US/Enterprise_Deployment_Guide.pdf](http://manuals.info.apple.com/en_US/Enterprise_Deployment_Guide.pdf)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T14:38:30.343

好吧，简短的回答是：不。

您不能将您的应用程序的链接分享给您组织以外的人——这违反了您与 Apple 的协议。但是，我知道有些公司会做那种“测试邀请”。[这是我关于“我们如何通过我们的服务器仅为我们的客户发布我们的 ios 应用程序？”](https://stackoverflow.com/questions/7496648/how-do-we-publish-our-ios-application-for-only-our-customers-via-our-servers)的旧答案？， 看一看。

所以你认为每个版本都有 50 个促销代码和 100 个设备进行内部测试？谢天谢地，不！:)[本文](http://sixtostart.com/onetoread/2012/distributing-3000-copies-of-an-ios-game/)将进一步阐明一家公司如何合法分发 3000 多份副本。IMO 值得一读。

编辑：如果您正在寻找正式的 NO，请搜索 iOS Developer Enterprise Program，其中明确指出，如果您在组织外部共享应用程序，您的帐户可能会被暂停/关闭。

# c# - c#进程立即退出而不运行.exe

> ID：10654424
> 
> 赞同：0
> 
> 时间：2012-05-18T14:23:42.750
> 
> 标签：c#, .net, visual-studio-2010

我正在尝试为不在我们网络上的用户启动 slui.exe，以便他们可以通过我们的带有 ac# 程序的 MAK 密钥验证他们的 Windows 安装，但是当编译为 .exe 时，该过程将立即退出；如果我从 VS 2010 以调试模式运行程序，它将成功运行，或者如果我在安装了 VS2010 的机器上启动 .exe，它也将成功运行。我的代码如下所示：

```
string path = Environment.SystemDirectory;
ProcessStartInfo startInfo = new ProcessStartInfo(path + "\\slui.exe");
startInfo.Arguments = 4;
Process p = new Process();
p.StartInfo = startInfo;
p.Start();
p.WaitForExit(); 
```

我尝试运行进程资源管理器，但当我尝试运行此代码时，它没有显示任何开始的进程。

.net可能有什么东西吗？我在两台机器上都运行 .net 4，所以我认为这不是问题所在。

我真的很困惑为什么这段代码可以在我的开发机器上以调试模式或编译为 .exe 正常工作，但不能在其他机器上工作；我一定在某处缺少依赖项。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:56:38.383

请检查事件日志，如果进程在启动时崩溃，它将在那里列出。您的症状的一个很好的例子是，如果您尝试启动一个不存在依赖项的进程，例如（即 slui.exe 引用 slui.dll 并且找不到它）。

# javascript - 将 XMLHTTPRequest 转换为 $ajax

> ID：10654429
> 
> 赞同：-5
> 
> 时间：2012-05-18T14:24:08.413
> 
> 标签：javascript, xml, jquery, xmlhttprequest

我正在使用以下代码在小工具中获取 Google：

```
<html>
<head>
<title>Browser</title>
</head>
<body onload= "getListCollection()" style="width:900px; height:900px;" >
<div id="listAttributes" style="width:400px; height:400px;" ></div>
<script>

function getListCollection() {
    var url = "https://www.google.co.uk"  
    xmlhttp = new XMLHttpRequest();
    xmlhttp.open('GET',url,true, 'user', 'password');
    xmlhttp.onreadystatechange = function()
    {
        if(xmlhttp.readyState == 4);
        {
            document.getElementById("listAttributes").innerHTML = xmlhttp.responseText
        }
    }
    xmlhttp.send(null);
}
</script>
</body>
</html> 
```

我想知道如何使用 $ajax 做同样的事情？

我查看了不同的示例，但我不知道它们将如何适应这种情况。或者，如果您可以发布一些不错的 $ajax 教程。

当我将其更改为此时，它不起作用：

```
<html>
<head>
<title>Browser</title>
</head>
<body onload= "getListCollection()" style="width:900px; height:900px;" >
<div id="listAttributes" style="width:400px; height:400px;" ></div>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js">

$.ajax({
    url : 'https://www.google.co.uk',
    type : 'GET',
    success : function(data){
        $('#listAttributes').html(data);
    }
});
</script>
</body>
</html> 
```

页面上什么也没有出现。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T14:28:03.183

这是代码的 jQuery 版本：

```
$.ajax({
    url : 'https://www.google.co.uk', //cross-domain? this won't work
    username : 'user',
    password : 'password',
    type : 'GET', //default is GET, but i put it here to clarify
    success : function(data){
        $('#listAttributes').html(data);
    }
}); 
```

有关更多详细信息和设置，请阅读[`jQuery.ajax()`文档](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T14:28:20.293

像这样的东西：

```
$.ajax({
    url : "https://www.google.co.uk",
    type : "get",
    username : "user",
    password : "password",
    success : function(data) {
        document.getElementById("listAttributes").innerHTML = data;
    }
}); 
```

但是，由于您试图访问外部资源（即不是您的域），因此您的代码很可能无法工作。

查看[JQuery Ajax 文档](http://api.jquery.com/jQuery.ajax/)以获取更多详细信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T14:29:21.820

```
$.ajax({
   url: url,
   username: 'user',
   password: 'password'
}).done(function (responseText) {
   document.getElementById('listAttributes').innerHTML = responseText;
   //or
   $("#listAttributes").html(responseText);
}); 
```

默认情况下，`.ajax`将使用 GET 方法并且是异步的，所以我省略了这些设置。如果您不需要用户名/密码，我会使用`$.get()`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-18T14:37:41.157

它真的比纯 JavaScript 版本更简单更短，这里是：

```
function getListCollection() {
    $.ajax({
        url: "https://www.google.co.uk",
        username: "user",
        password: "password",
        success: function(data){
            $('listAttributes').html(data);
        }
    });
} 
```

仅当站点支持跨域来源时才接受该请求。在此处查看[jQuery.ajax() 文档](http://api.jquery.com/jQuery.ajax/)。

# java - 将会话变量传递给 MessageSource

> ID：10654430
> 
> 赞同：0
> 
> 时间：2012-05-18T14:24:10.627
> 
> 标签：java, spring-mvc, properties, messages

我有一个控制器，它显示一个表单并从属性文件加载消息。我扩展`ReloadableResourceBundleMessageSource`并打电话给它`DatabaseMessageSource`。现在，如果数据库中有一条消息，它将得到该消息，如果没有，则默认为 proeprties 文件中的内容。 [链接到示例](https://stackoverflow.com/questions/10623388/override-springmessage-tag-with-database-values/10627332#comment13808290_10627332)

我的数据库查找被称为 like `getCode(companyId, code)`。为了使上面的示例工作，我刚刚通过了一个`1`for `companyId`。

我想将会话中的 companyId 传递给，`DatabaseMessageSource`以便它可以为该特定公司提取正确的消息。有谁知道我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:37:14.617

`HttpSession`您可以随时使用以下方法获取电流：

```
ServletRequestAttributes attr = (ServletRequestAttributes) RequestContextHolder.currentRequestAttributes();
HttpSession session = attr.getRequest().getSession(); 
```

然后从那里获取您的属性。

# marklogic - 如何获取 Marklogic 数据库中的文档总数？

> ID：10654431
> 
> 赞同：2
> 
> 时间：2012-05-18T14:24:15.530
> 
> 标签：marklogic

我在 Marklogic 数据库中有大约 20 个 lacs 文档。我想要我的搜索应用程序中的文档总数进行分页。为了获得我正在使用的总数

```
xdmp:estimate(cts:search(doc(), $query)) 
```

其中 $query 是组合在 中的各种查询的组合`cts:and-query`。但我没有得到正确的总数。当 $query 为空白时，它显示的计数比数据库中的文档总数高得多。当我使用

```
xdmp:estimate(doc()) 
```

它向我显示了正确的总数，但它将是静态总数，不会根据查询而改变。我想要根据响应特定查询返回的结果的总数，这就是为什么我将 $query 作为参数传递但它没有显示正确的总数。`fn:count()`显示正确的总数，但是当文档数量约为 20 lacs 时，`fn:count()`由于`fn:count()`比`xdmp:estimate()`.

请帮助我获取响应用户输入的搜索词返回的正确文档总数。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-18T15:49:56.910

要了解这里发生了什么，请先阅读来自[http://resources.marklogic.com/library/media/inside-marklogic的架构白皮书](http://resources.marklogic.com/library/media/inside-marklogic)

现在试试这个测试用例：

```
xdmp:estimate(doc()),
xdmp:estimate(cts:search(doc(), ())) 
```

第一个表达式将计算数据库中的*文档数。*第二个表达式将计算数据库中*文档片段的数量。*因此，如果结果不同，您可能配置了片段根或片段父级。一些特殊的文档也会产生额外的片段：我认为拼写词典和同义词库文档会这样做。

如果要将估计限制为 XML 文档根，请在可搜索表达式中指定文档根 QName(s)，或者`/*`如果您不关心根元素名称，则使用。

```
xdmp:estimate(cts:search(/*, ())) 
```

您还可以使用 cts:query 参数来指定仅出现在您要计算的文档中的 QName。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T15:11:12.793

我不明白你的问题。您想要数据库中的文档总数还是与您的搜索匹配的文档总数？

`xdmp:estimate`是正确的方法，但它只是一个**ESTIMATE**。如果估计中使用的查询可以从索引中完全解决，那么估计将是 100% 正确的。但是，如果不能从索引中完全解析查询（需要过滤），那么估计值将有一定的偏差。这是因为`xdmp:estimate`只使用索引来给你一个计数。比较。`fn:count(cts:search(doc(), $query))`_ `xdmp:estimate(cts:search(doc(), $query))`如果给定查询的结果显着不同，那么您要么需要打开额外的索引来支持该查询，要么接受差异。

# c# - 如何使用 OLEDB 在 Excel 中获取仅 Excel 工作表名称的列表；过滤掉出现在元数据中的非工作表

> ID：10654433
> 
> 赞同：9
> 
> 时间：2012-05-18T14:24:25.450
> 
> 标签：c#, excel, oledb

我在使用 OLEDB 从 Excel 电子表格中获取工作表名称时遇到问题。问题是当我使用 GetOleDbSchemaTable 时，生成的 DataTable 不仅仅是实际的工作表名称；它有额外的“表格”行，我只能假设 Excel 在内部使用这些行。

例如，如果我有一个名为 myWorksheet 的工作表，下面的代码可能会以包含 myWorksheet$、myWorksheet$PrintTable 和 myWorksheet$_ 的列表结束。只有第一个 myWorksheet$ 记录用于实际工作表。其他的只是我不需要的垃圾。当您在元数据中查看它们时，它们看起来就像常规表，即使是 TABLE 类型。

现在，我只是手动过滤掉了名称中带有“$_”或“$Print”的任何内容，但谁知道其他 Excel 功能可能会使这些额外记录以不同的格式出现。

有谁知道仅获取实际工作表名称而不是这些不是工作表的内部表的最佳方法？元数据中有什么东西可以区分它们吗？

```
 private ArrayList getXlsWorksheetNames(OleDb.OleDbConnection conn)
    {
        ArrayList wsList = new ArrayList();
        DataTable schemaTable;

        try
        {
            conn.Open();
            schemaTable = conn.GetOleDbSchemaTable(OleDb.OleDbSchemaGuid.Tables, null);

            foreach (DataRow row in schemaTable.Rows)
            {
                //form.appendToResultsTxt("Adding worksheet to list: " + Environment.NewLine +
                //    "Name = " + row.Field<string>("TABLE_NAME") + "," + Environment.NewLine +
                //    "Type = " + row.Field<string>("TABLE_TYPE") + "," + Environment.NewLine + Environment.NewLine);
                wsList.Add(row.Field<string>("TABLE_NAME"));
            }
            conn.Close();
        }
        catch (Exception ex)
        {
            if (this.mode == Cps2TxtUtilModes.GUI_MODE)
            {
                this.form.appendToResultsTxt(ex.ToString());
            }
            throw;
        }

        return wsList;
    } 
```

我通读了此链接上的文章，但他们似乎没有做任何与我不同的事情，而且我没有看到任何过滤掉额外的非工作表表，所以微软似乎没有提供正确答案。

[http://support.microsoft.com/kb/318452](http://support.microsoft.com/kb/318452)

而且我还查看了很多 StackOverflow，比如下面链接中的线程，这很有帮助，但不能解决这个问题。

[使用 Excel OleDb 在 SHEET ORDER 中获取工作表名称](https://stackoverflow.com/questions/1164698/using-excel-oledb-to-get-sheet-names-in-sheet-order)

在有人问之前，我还想说我无法控制电子表格中使用的功能，所以我不能只告诉他们“不要打开过滤”或“不要使用打印表格”。

任何想法都非常感谢。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-09-30T14:24:45.377

这个问题很老了，但对于那些现在发现它的人来说，跳过可以像 Jim 发现的那样完成......

```
// skip those that do not end correctly
foreach (DataRow row in schemTable.Rows)
{
    string sheetName = row["TABLE_NAME"].ToString();
    if (!sheetName.EndsWith("$") && !sheetName.EndsWith("$'"))
        continue;
    Console.WriteLine(sheetName);
} 
```

那是想要的，或者以 结尾的，`$`或者以 结尾的`$'`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T15:34:21.450

根据经验，似乎是所有名字以美元符号结尾的人。我遇到过来自客户的场景，其中似乎出现了数据中不存在的额外工作表——这些后来证明是 Excel 中的隐藏工作表！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T18:56:48.097

我想到的第一种方式与 [使用 Excel OleDb 在 SHEET ORDER 链接中获取工作表名称](https://stackoverflow.com/questions/1164698/using-excel-oledb-to-get-sheet-names-in-sheet-order)的链接中列出的 akash88 相同。

您可以采用 akash88 的方法并对其进行一些清理，以便代码更易于阅读。

```
 var wsList = from s in schemaTable
                     where s.Field<string>("TABLE_NAME").Contains("$")
                     select s.Field<string>("TABLE_NAME"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-28T09:58:56.450

您可以测试`EndsWith("$")`而不是`Contains("$")`像下面这样：

```
List<String> lstsheetNames = new List<String>();
String sheetName;
foreach (DataRow row in schemaTable.Rows)
{
    sheetName = row.Field<string>("TABLE_NAME");
    String strTemp = sheetName.Split(' ');

    if(strTemp.Length == 1 && sheetName.EndsWith("$"))
       lstsheetNames.Add(sheetName.Substring(0, sheetName.Length - 1));

    else if(strTemp.Length > 1 && strTemp.GetValue(strTemp.Length - 1).ToString().EndsWith("$'"))
       lstsheetNames.Add(sheetName.Substring(1, sheetName.Length - 3));
} 
```

我在同样的问题中使用了这段代码，它工作正常。

**编辑：**对不起，我没有注意这一点。我现在更改了代码。它可能不是最好或最短的方法，但它可以工作。

# c++ - 在链接之前声明要使用的类成员函数

> ID：10654434
> 
> 赞同：0
> 
> 时间：2012-05-18T14:24:33.827
> 
> 标签：c++, compilation, linker

我想使用一个存在于其他模块中并且可用于链接的类。头文件的大小很大，所以我不想在当前模块中包含头文件。

我正在尝试通过转发声明类

> > 类 foo;
> > int foo::getValue();

这里 getValue() 是我要使用的 foo 的成员函数。

现在，当我编译代码时，在链接为之前出现编译错误

`error: forward declaration of 'struct foo'`

我在这里想念什么？

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T14:26:14.963

您不能转发声明类成员，您需要包含整个标题。

这里正确的做法是减小标头的大小。如果它只包含类定义，则保持原样。如果没有，则有可能将其分解为多个标题。

如果类定义很大，则表明您的设计有缺陷并且可能会被破坏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T16:55:28.357

仅当您不需要了解类的内部结构（即成员和/或大小）时，才可以使用类的前向声明。

这种技术的典型使用涉及类指针或引用：

```
class included_class;

class encapsulating_class
{
  public:
    void some_method(const& included_class_pointer) const;
  private:
    included_class * included_class_pointer;
}; 
```

使用此技术无法尝试以您指示的方式转发声明类内部，并且需要包含类标头。

# oracle - SQL Developer 是否有足够的功能来支持日常 DBA 工作？

> ID：10654436
> 
> 赞同：1
> 
> 时间：2012-05-18T14:24:38.257
> 
> 标签：oracle

SQL Developer 是否有足够的特性来支持 Oracle DBA 的日常工作？与 TOAD 相比，缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:37:34.163

SQL 开发人员可以为开发人员完成这项工作，但仍有一些怪癖。

*   我发现如果安装的文件路径包含空格，则不会显示连接屏幕。（Windows XP，SQL Developer 版本 3.1.07）。
*   我为某人安装了它来进行数据更新，他们得到了“在另一个会话中提交的数据”。这个错误从版本 1 开始就存在，并且可以通过修改设置轻松解决，但不幸的是看到应该是成熟的产品。

它还缺少一些 DBA 用来维护健康的工具，例如：

*   表空间可视化器
*   范围管理
*   固定代码（如果您仍然需要这样做）

我喜欢 Toad 选项来比较数据库模式或查找已命名或包含文本字符串的对象。

您无法击败免费工具，而且是不断添加的工具。Toad 得益于多年的发展。

编辑：它可以分析索引和复制表。谢谢@Phil！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T03:29:32.410

SQL Developer 和 Toad 在 2 个不同的领域中发挥作用。

SQL Developer 是一个开发工具，而 Toad 更像是一个 DBA 的工具（至少它一开始就是这样）。SQL Navigator 相当于 Quest 的 SQL Developer。这两种工具仍然具有跨功能特性。

是的，SQL Developer 还很年轻，它会随着时间的推移添加更多功能。

但就目前而言，Toad 在功能/性能/功能集/可用性等方面更好......

# xml - 在 XSLT 中输出空格

> ID：10654438
> 
> 赞同：2
> 
> 时间：2012-05-18T14:24:49.493
> 
> 标签：xml, xslt

我的 xslt 模板中有以下变量。

```
<xsl:variable name="spaces" select="'&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;'"/> 
```

在模板中，我这样使用变量：

```
<xsl:choose>
   <xsl:when test="InvestmentNone = 'true'">
      <u>X</u>
   </xsl:when>
   <xsl:otherwise>
      <u xml:space="preserve">
         <xsl:value-of select="@spaces" xml:space="preserve"/>
      </u>
   </xsl:otherwise>
</xsl:choose> 
```

所以，基本上，如果“InvestmentNone”为“假”时，我希望空格显示为下划线。问题是在上面的代码中，空格没有出现。但是，如果我删除该行

```
<xsl:value-of select="@spaces" xml:space="preserve"/> 
```

并添加

```
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 
```

直接就位，空格用下划线显示。如何使变量方法起作用？原因是稍后我将使用该变量来填充空格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:55:22.907

为了访问变量，您必须在其名称前加上前缀，`$`而不是`@`：

```
<xsl:variable name="spaces" select="'&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;'"/>
<xsl:value-of select="$spaces"/> 
```

前缀`@`地址属性，并且由于上下文节点中可能没有称为*空格*的属性，因此访问时会得到一个空字符串`@spaces`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T17:23:21.080

除了 Martin 的正确答案之外，我还要指出在样式表中使用 xml:space="preserve" 通常是个坏主意。这意味着您的 xsl:value-of 指令之前和之后的空白文本节点变得重要，就好像它们被包含在 xsl:text 中一样。我不知道为什么这没有在您的 HTML 中添加任何带下划线的空格，尽管一旦浏览器呈现它，它可能只会显示为一个空格。

# android - 从 Web 服务器 Android 应用程序加载启动画面

> ID：10654444
> 
> 赞同：0
> 
> 时间：2012-05-18T14:25:07.873
> 
> 标签：android, android-layout, cordova

是否可以使用来自网络服务器的图像作为斜线屏幕。我想从 url 指定启动画面而不是本地文件。或者是否可以从网络服务器动态下载图像并替换当前的启动画面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:23:30.820

这是使用图像制作飞溅碎石的一些技巧，图像是下载表单服务器。

首先从服务器下载图像，本教程

[http://getablogger.blogspot.com/2008/01/android-download-image-from-server-and.html](http://getablogger.blogspot.com/2008/01/android-download-image-from-server-and.html)

然后在初始屏幕上设置下载的图像

```
public class SplashScreenActivity extends Activity {

 @Override
 public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.splash);

 // Set Image download from server, which is already defined above link.

  /** set time to splash out */
final int welcomeScreenDisplay = 3000;
/** create a thread to show splash up to splash time */
Thread welcomeThread = new Thread() {

int wait = 0;

@Override
public void run() {
try {
super.run();
/**
* use while to get the splash time. Use sleep() to increase
* the wait variable for every 100L.
*/
while (wait < welcomeScreenDisplay) {
sleep(100);
wait += 100;
}
} catch (Exception e) {
System.out.println("EXc=" + e);
} finally {
/**
* Called after splash times up. Do some action after splash
* times up. Here we moved to another main activity class
*/
startActivity(new Intent(SplashScreenActivity.this,
MainScreenActivity.class));
finish();
}
}
};
welcomeThread.start();

}
} 
```

有关从服务器获取图像的更多信息：

[从 URL 加载图像](https://stackoverflow.com/questions/6009092/load-images-from-url)

和

一些用于制作启动画面的代码

[http://www.codeproject.com/Articles/113831/An-Advanced-Splash-Screen-for-Android-App](http://www.codeproject.com/Articles/113831/An-Advanced-Splash-Screen-for-Android-App)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T15:01:09.367

将默认的初始屏幕图像内置到应用程序中，以便在应用程序首次运行时不会延迟显示它。该应用程序的启动速度肯定比您通过移动连接下载图片的速度要快。

在某个时候，在后台线程中下载新图像并将其存储在某个地方，如果它很大，可能在 SD 卡上。

然后显示此图像而不是默认图像。每周重复此操作，因为您每周都需要一个新图像。

或者，最好只是加快启动速度，这样您就根本不需要启动画面了。

# objective-c - NSString 解码非标准百分比

> ID：10654447
> 
> 赞同：0
> 
> 时间：2012-05-18T14:25:09.107
> 
> 标签：objective-c, ios

我正在开发一个 iOS 应用程序，我有一个`UIWebView`女巫调用`JavaScript`函数女巫返回给我一个编码的文本，来解码这个文本我正在使用该`NSString`方法`stringByReplacingPercentEscapesUsingEncoding`，但这种方法的问题是我无法像这样解码特殊字符：`%u2019`。我如何解码这些字符？(%uxxxx) 感谢您的回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:36:50.273

首先感谢每个回答我问题的忙碌人士，但我选择了这个解决方案：

Unicode 字符的非标准编码：`%uxxxx`，其中`xxxx`是表示为四个十六进制数字的 Unicode 值。此行为未被任何指定`RFC`且已被`W3C`. 第三版`ECMA-262`仍然包括一个`escape(string)`使用这种语法的函数，还包括一个对每个八位字节`encodeURI(uri)`进行转换`UTF-8`和百分比编码的函数。

我改变了`JavaScript`函数，女巫使用`escape()`函数用方法对字符串进行编码`encodeURIComponent(uri)`；在Objective C代码中，我使用标准函数来解码我的字符串`- (NSString *)stringByReplacingPercentEscapesUsingEncoding:(NSStringEncoding)encoding`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:27:45.843

这看起来像 UTF8 编码，而不是百分比编码。它是 Unicode 编码之一。我可能错了哪一个。但我认为它是UTF8。

您应该使用 stringWithUTF8String （如果数据已经是 NSString）或 initWithData:encoding: （如果来自 JavaScript 的数据是 NSData）这样的方法对其进行解码

# cordova - PhoneGap 和 Dreamweaver CS6 插件

> ID：10654453
> 
> 赞同：1
> 
> 时间：2012-05-18T14:25:40.230
> 
> 标签：cordova, dreamweaver

我正在玩 Dreamweaver CS6 和 Phonegap 构建功能

你知道是否可以添加 Phonegap 插件，因为它是由 CS6 中的 DW/Phonegap 构建的，与旧版本不同？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T01:57:33.217

我正在尝试为 CS6 Dreamweaver 查找最新的 PhoneGap 插件？由于某种原因，它目前无法正常工作（可能再过 24 小时？）。手动确实有效，但它不会再在 Android 测试设备上运行，因为 Cordova 已从孵化中出来（这似乎不对）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T19:43:07.467

不确定未来，但我不会指望 Adob​​e 在 CS6.5 之前更新它以获得更多功能，这取决于我在移动应用程序和 Dreamweaver 方面的跟踪经验。

无论哪种方式都没什么大不了的——只需压缩文件夹并上传到[http://build.phonegap.com——](http://build.phonegap.com)这基本上就是 DW 正在做的事情。

# networking - 有哪些方法可以在两个无线设备之间同步时间？

> ID：10654457
> 
> 赞同：0
> 
> 时间：2012-05-18T14:25:50.597
> 
> 标签：networking, time, synchronization

我正在为移动应用程序开发做一些初步规划，我需要这些应用程序尽可能地具有最佳时间精度，如果可能的话，可以降至毫秒。有哪些方法可以在两个设备之间同步时间并解决不同的网络错误和延迟 - 如果我要使用网络方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T16:37:58.817

我认为[PTP](http://en.wikipedia.org/wiki/Precision_Time_Protocol#Implementations)是您正在寻找的。它应该提供亚微秒级的精度，并且似乎可以在不同的平台和设备上使用。如果您打算在 Android 上使用它，您可能应该从在其上移植[PTPd](http://en.wikipedia.org/wiki/PTPd)开始。

# javascript - 创建它们后定义的变量是坏/好/可选吗？

> ID：10654460
> 
> 赞同：0
> 
> 时间：2012-05-18T14:25:57.197
> 
> 标签：javascript

阅读许多 javascript 库的代码，我看到许多开发人员在创建变量后就使用它们来设置变量。

```
var i = 0,
var c = 0; 
```

我更喜欢在创建它们之后定义变量。

```
var i,
    c;

i = 0;
c = 0; 
```

但是可能有一个解释为什么会这样或那样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:27:35.017

这纯粹是风格。有些人喜欢将他们的声明与初始化隔离开来，而另一些人则喜欢将它们合二为一。对于 JavaScript 引擎，它们实际上是相同的，因为它`var`在函数实际执行的第一行代码之前处理。（注意这与其他一些语言有什么不同。）也就是说，它完全一样地对待你的两个例子：首先它使用 value创建`i`and ，然后才开始执行函数的逐步代码它设置为 0，然后设置为 0。（这在规范的第[10.4.3](http://es5.github.com/#x10.4.3)节和第[10.5](http://es5.github.com/#x10.5)节中有一些深入的介绍。）`c``undefined``i``c`

对我来说，只要我坚持简单的价值观，我就喜欢把它们合二为一（虽然我以前一直是一个“纯粹主义者”，把它们分开；我年轻的时候做了很多傻事）。但我尽量避免初始化中的复杂逻辑。有时我发现我已经将一半的函数编写为一系列以逗号分隔的语句`var`，并且开始变得难以阅读和维护，所以我倾向于在那个时候将它们拉出来。

另一方面，将它们分开的一个原因是它为您提供了足够的空间来评论它们。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:27:40.830

两者都可以，但是如果您在没有初始化变量的情况下定义变量，并在初始化之前使用它们，那么这是不好的做法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:30:02.070

这是因为他们将使用条件来设置初始值，例如：

```
var i;

... code ...

if(b==something){
    i = somevalue;
}

... code ...

a = i + b; 
```

当 b 不等于某个值时，变量仍然是未定义的。为了防止这在以后的使用中成为问题，它们为变量提供了一个初始化值。

但是如果你在定义后直接设置初始值，就没有什么区别了。就像其他人说的那样，它是为了紧凑和良好的可读性和风格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T14:31:38.837

我认为这是一个偏好问题。我都用过。对于复杂的代码，第二个例子更好，只要编码器使用描述性变量名称。我喜欢将其视为告知读者我将使用这些变量，因此请注意它们。

另一个考虑因素是范围。确保您在正确的范围（全局/类/函数/等）中声明变量。如果您将它们声明得太窄，您会无意中创建两个不同的变量（这可能非常难以调试）。如果您将它们声明得太宽泛，可能会降低程序效率。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T15:02:11.917

你甚至可以使用这种风格：

```
var a = b = 0; 
```

在定义中初始化变量可防止因变量未设置且初始 JavaScript 默认值为`undefined`.

# arcgis - Python ConfigParser 问题

> ID：10654461
> 
> 赞同：0
> 
> 时间：2012-05-17T17:21:41.643
> 
> 标签：arcgis, python

ConfigParser 的配置文件是否必须命名为“Config.ini”才能工作？

我希望名称为“1Config.ini”，以便它出现在文件夹目录的顶部。

这是我目前拥有的

```
config = ConfigParser.ConfigParser()
config.read(Revision[0:Revision.rfind('\\')] + "\1Config.ini")

Type = config.get("myvars", "Type") 
```

但是，当文件和代码命名为“1Config.ini”时，我收到此错误

```
<class 'ConfigParser.NoSectionError'>: No section: 'myvars' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:42:52.257

下面的输出是什么？确保它是有效的文件名。

```
>>> print Revision[0:Revision.rfind('\\')] + "\1Config.ini" 
```

理想情况下使用`os.path.join`而不是连接字符串：

```
import os
filename = os.path.join(Revision[0:Revision.rfind('\\')], "Config.ini")
config.read(filename) 
```

你可能不应该命名你的变量`Type`，因为`type`它是一个内置的函数/模块，它会让人困惑。

```
Type = config.get("myvars", "Type") 
```

不，配置文件可以命名为任何东西：

```
>>> a = ConfigParser.ConfigParser()
>>> a.read("E:/Documents/2012/config.test") # where config.test is the example from the documentation
['E:/Documents/2012/config.test']
>>> a.sections()
['My Section']
>>> a.items(a.sections()[0])
[('foodir', 'frob/whatever'),
 ('dir', 'frob'),
 ('long', 'this value continues\nin the next line')] 
```

# ruby-on-rails - 在 Rails 之外包含用户模型时未定义的方法“设计”

> ID：10654469
> 
> 赞同：3
> 
> 时间：2012-05-18T14:26:25.207
> 
> 标签：ruby-on-rails, ruby, activerecord, devise

我正在开发一个由两部分组成的应用程序：一个 ruby​​ 命令行应用程序和一个用于前端的 Rails 应用程序。

我一直在 Ruby 应用程序中使用 ActiveRecord 和 Rails 模型，方法是通过以下方式单独包含它们：

```
Dir[File.dirname(__FILE__) + '/../../RailsApp/app/models/*.rb'].each do |file|
  filename = File.basename(file, File.extname(file))
  require_relative "../../RailsApp/app/models/" + filename
end 
```

并且通过手动维护两个几乎相同的 Gemfile 文件的依赖关系（我认为这种方法不是最好的）

昨天我将 Devise 添加到 Rails 应用程序中，现在当 ruby​​ 应用程序尝试包含用户模型时，会`undefined method devise for class <xxxxx>`出现消息。

我在我的 ruby​​ 应用程序的 Gemfile 中添加了设计 gem，但错误仍然存​​在。如果我理解正确的话，Devise 是一个 Rails 引擎，这就是为什么它不只是通过需要 gem 来加载的原因。

我读到在另一个应用程序中包含 Rails 模型的更好方法是要求该`environment.rb`文件，但是当我尝试这样做时，ActionMailer 出现错误：

```
undefined method `action_mailer' for #<Rails::Application::Configuration:0xbbb54bc> 
```

我该如何解决设计问题？有没有比我目前用来避免维护两个 gemfile 的更好的方法将 Rails 模型包含在另一个应用程序中？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T16:49:31.747

尽管这种架构在不久的将来必须改变，但我们设法通过在 ruby​​ 应用程序中包含 devise 及其初始化程序来解决这个错误。

```
# FIXME: Dependency needed in Rails but not in the engine.
require 'devise'
require_relative "../../RailsApp/config/initializers/devise.rb"

#Load all the models 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T15:04:19.880

您可以在调用模型之前尝试放置`require 'devise'`，但我不确定这是否可行？

我同意这种通用架构感觉不对。

我会将两个应用程序共有的代码提取到一个单独的库中，然后将该库包含在两个应用程序中。最简单的做法是将自己的库制作成 Gem，然后将其包含在两个 Gemfile 中。公共 gem 将在共享库中指定。制作宝石真的很容易。可以在[http://asciicasts.com/episodes/245-new-gem-with-bundler](http://asciicasts.com/episodes/245-new-gem-with-bundler)（或相关的 Railscast）上找到好的说明。

您的命令行应用程序可能不需要关心 Devise。如果您在两者中都需要一个用户模型，您可以将它包含在共享库中，然后在 Rails 应用程序中添加任何额外的功能（例如设计）。

这有帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T02:14:48.547

您可以将加载模型的时间移到父应用程序初始化步骤中，而不是在您的 gem 加载自身时。

正如您的其他答案所建议的那样，构建一个 shared_code gem。

将您的 shared_code 加载循环移动到初始化文件中（例如 require 'user'）

在 shared_code gemspec 中列出模型的 gem 依赖项（如设计）。

在您的 shared_code gem 中，包含一个生成器以将初始化程序文件安装到使用 shared_code gem 的应用程序中。

然后在父应用程序中使用您的共享代码，

宝石文件：

```
gem 'shared_code' 
```

安慰：

```
rails generate shared_code:install 
```

这是相同的模式设计和其他 gem 用于在父应用程序的初始化序列中的正确时间配置自己。

如果您在 user.rb 文件本身的设计初始化程序上使用 require_relative，则在 shared_code gem 中，您将消除使用 shared_code 的两个不同父应用程序可能需要初始化设计（或应用程序和应用程序的另一个 gem）的可能性你的宝石取决于）不同。

生成器的详细信息：

您可以通过像这样创建生成器来创建 shared_code:install 命令：

lib/generators/shared_code/install_generator.rb

```
module SharedCode
  class InstallGenerator < Rails::Generators::Base
    source_root File.expand_path('../templates', __FILE__)
    def copy_initializer_file
      copy_file "shared_code.rb", "config/initializers/shared_code.rb"
    end
  end
end 
```

将模型加载代码放入 lib/generators/shared_code/templates/shared_code.rb

# jquery - 文本区域中的语音识别

> ID：10654479
> 
> 赞同：1
> 
> 时间：2012-05-18T14:26:57.187
> 
> 标签：jquery, html, webkit, google-chrome-extension, speech-recognition

我想在文本区域附加 webkit 语音识别插件。我目前拥有的：

```
<input type="text" x-webkit-speech /> 
```

这样可行。但是如果我输入这个：

```
<textarea cols="88" rows="6" x-webkit-speech /> 
```

它不起作用。有没有办法做到这一点？也许用 jQuery？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T14:32:28.300

看看[这个页面](http://www.phpied.com/x-webkit-speech-input-and-textareas/)他们已经展示了你是如何做到的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:34:14.710

目前`x-webkit-speech`仅适用于输入。您可以使用一些技巧，因此您的 textarea 似乎具有`x-webkit-speech`. 基本上，您将有一个输入文本并接受该输入并填写文本区域。

# javascript - 图像未显示在跨度中

> ID：10654481
> 
> 赞同：0
> 
> 时间：2012-05-18T14:27:00.880
> 
> 标签：javascript, html

这是我在 html 中的跨度

```
 <span id="spProgress" runat="server"></span> 
```

现在我有 2 个 javascript 函数，一个用于显示加载指示器

```
 function DisablePage()
{
     document.getElementById('<%= spProgress.ClientID %>').innerHTML="<img src='Images/updateProgress.gif' />";
} 
```

隐藏它的另一个功能。

```
function EnablePage()
{
    document.getElementById('<%= spProgress.ClientID %>').innerHTML='';
} 
```

当我单击一个按钮时，它在本地系统上工作得非常好。但是当我把它放在生产服务器上时，图像没有显示。我检查了图像 url，但它非常好。令人惊讶的是，当我单击按钮时，它不会显示，但如果我从我的 Web 应用程序下载文件，然后图像开始正确显示。

这是我的客户端脚本代码供下载

```
function hidePage()
{
    eraseCookie("DStatus");
    EnableMe();
}
function EnableMe()
{      
    var hddCdrDownloadRecordsLimit='<%=this.hddCdrDownloadRecordsLimit.ClientID %>';
    var hddTotalCount='<%=this.hddTotalCount.ClientID %>';

  if((document.getElementById(hddCdrDownloadRecordsLimit).value) < (document.getElementById(hddTotalCount).value))
    {
        DisablePage();
        document.getElementById('<%=this.btnSearch.ClientID %>').disabled=true;
    } 
    else 
    {
       DisablePage();
    } 
var downLoadStatus = readCookie("DStatus");
if (downLoadStatus == "Completed")
{
    EnablePage();
    document.getElementById('<%=this.btnSearch.ClientID %>').disabled=false;
}
else
{
 setTimeout("EnableMe()", 6000);
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:40:13.240

您应该尝试在页面加载时加载图像，将图像标签放在 span 内，然后使用“显示”或“隐藏”该元素。

```
<span id="spProgress" runat="server" style="display:none;"><img src='Images/updateProgress.gif' /></span> 
```

创建一个函数，将 span 元素的样式更改为显示 (display:block) 或隐藏 (display:none)。

希望有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:33:41.223

您是否检查过 html 是否已附加到跨度中？我会使用 CHrome 或 firebug 来检查元素，然后单击新选项卡中的打开 url 以查看它用于图像的完整 url。可能是它在网上有错误的目录，你需要但 ./Images 首先等

# internet-explorer - Internet Explorer 中的嵌套列表问题

> ID：10654482
> 
> 赞同：1
> 
> 时间：2012-05-18T14:27:02.720
> 
> 标签：internet-explorer, list, nested

我有一个布局如下的表单：

1.  姓名：
    电话：
    电子邮件：

2.  姓名：
    电话：
    电子邮件：

我的html是：

```
<ol class="information">
  <li>
    <ul>
      <li>
        <label>Name:</label>
        <input name="Name1" type="text" />
      </li>
      <li>
        <label>Phone:</label>
        <input name="Phone1" type="text" />
      </li>
      <li>
        <label>Email:</label>
        <input name="Email1" type="text" />
      </li>
    </ul>
  </li>
  <li>
    <ul>
      <li>
        <label>Name:</label>
        <input name="Name2" type="text" />
      </li>
      <li>
        <label>Contact Number:</label>
        <input name="Phone2" type="text" />
      </li>
      <li>
        <label>Email:</label>
        <input name="Email2" type="text" />
      </li>
    </ul>
  </li>
</ol> 
```

我的 CSS 是：
ol.information ul { list-style-type:none; 边距：0；填充：0；}

```
ol.information ul label
  {
    display:inline-block;
    width:125px;
  } 
```

在 chrome、firefox、opera 中，它看起来是正确的。在 IE（任何版本）中，数字 1 和 2 后面都有一个回车，如下所示：

1.  姓名：
    电话：
    电子邮件：

2.  姓名：
    电话：
    电子邮件：

知道如何删除 IE 中的多余行吗？

# c++ - 关于 MFC 应用程序的 VS c++ 中的事件处理程序的设计约定

> ID：10654487
> 
> 赞同：0
> 
> 时间：2012-05-18T14:27:32.087
> 
> 标签：c++, visual-studio-2008, mfc, event-handling

我有一个总体设计问题，涉及在 VS c++ 中开发 MFC 应用程序时事件处理程序的放置位置。在 Dialog 类中有事件处理程序会更好吗？或者将事件处理程序放在主应用程序类中是否可以接受？

我问这个是因为我发现自己试图从对话框类调用主类中的函数，然后又试图从主类更新 GUI。我认为将我的大部分代码移到 GUI（对话框）类会更容易。

我想我想知道事件处理和调用不在事件发生的 GUI 内的函数时的约定是什么。

任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T17:15:15.630

面向对象的设计要求您决定哪些对象负责程序的各种元素。

GUI 类应该负责与关联的 GUI 元素的所有交互。在您的情况下，对话框类应该处理来自嵌入在对话框中的元素和菜单的所有消息。

另一个类可能应该处理程序中数据的表示。这可能是应用程序类，也可能是完全独立的类。MFC 使用的 Document/View 架构具有指导意义——应用程序只负责少数记账功能，文档类处理数据表示，视图类负责在窗口中绘制数据。

# asp.net-mvc - 如何安排将我的网站图标缓存在 MVC3 中？

> ID：10654489
> 
> 赞同：2
> 
> 时间：2012-05-18T14:27:35.820
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我在文件夹中放置了一个 .ico 和一个 .png 文件，`/Content/Ico`我的 _layout.cshtml 中有以下内容

```
<!-- Favicon -->
<link rel="shortcut icon" type="image/x-icon" href="/Content/Ico/favicon.ico">
<link rel="icon" type="image/png" href="/Content/Ico/tick-circle.png"> 
```

a）我有什么方法可以指定这些网站图标的缓存时间？我应该在 /Content 文件夹中使用某种 web.config 文件吗？

`"<link href="@Url.Content("~/Content/ ...` b）我的一些代码使用了我应该使用的语法`@Url.Content`吗？`/Content`使用它和只在 href 中指定有什么区别？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T16:59:13.003

[`[OutputCache]`](http://msdn.microsoft.com/en-us/library/system.web.mvc.outputcacheattribute.aspx)a）您可以通过服务器端控制器操作为网站图标提供服务，在该操作中，您可以通过使用属性装饰它来指定它应该被缓存多长时间：

```
[OutputCache(Duration = 3600, Location = OutputCacheLocation.Client)]
public ActionResult Favicon()
{
    var icon = Server.MapPath("~/content/ico/favicon.ico");
    return File(icon, "image/x-icon");
} 
```

接着：

```
<link rel="shortcut icon" type="image/x-icon" href="@Url.Action("Favicon", "SomeController")" /> 
```

b) 始终使用`@Url.Content("~/content/...")`并且从不`/content/...`指定静态文件的相对路径。其原因是 Url.Content 帮助程序说明了虚拟目录名称，即使您将站点部署到 IIS 中的虚拟目录中，您的站点仍将继续工作。如果您像这样对 url 进行硬编码，`/content/...`它将在本地工作，但一旦您在 IIS 中发布，它将不再工作，因为现在正确的位置是`/yourappname/content/...`Url.Content 帮助程序所考虑的。

# php - PHP/MYSQL 导入联系人

> ID：10654490
> 
> 赞同：1
> 
> 时间：2012-05-18T14:27:37.013
> 
> 标签：php, import, contacts

我想从 hotmail、gmail 等导入社交网站的联系人。Openinviter 似乎需要我的主机不授予我的服务器安装权限。有谁知道用于拉入我可以放在目录中的联系人的库或其他文件。或者你自己的教程或指南？或者，任何人都可以建议通过教程或脚本从 csv 或分隔文件导入联系人的方法吗？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:47:13.600

从 CSV 获取数据到 MySQL 是很常见的，所以你可以得到很多示例、准备使用的类和最佳实践，只需用谷歌搜索一下。甚至 MySQL 也有自己的方式通过'LOAD DATA LOCAL INFILE'来做到这一点。

我不知道像 OpenInviter 这样不需要使用文件系统和安装包的任何其他解决方案。：/

# macos - 在 Mac 上使用 KEXT 进行文件 I/O

> ID：10654495
> 
> 赞同：2
> 
> 时间：2012-05-18T14:27:46.247
> 
> 标签：macos, bsd, kernel-extension

观察到有vn_xxx api对文件进行操作，例如vn_rdwr(...)。从网上搜索，似乎不建议使用 vn_rdwr(...) 。

几乎没有相同的查询：

*   这个 vn_xxx api 在 Mac OS X 版本之间是否不兼容？
*   使用它不安全吗？有没有我可以参考的例子来看看 vn_rdwr 是如何使用的？
*   除了将文件 I/O 委托给守护进程之外，还有其他选择吗？

如果有人可以提供评论\建议会很棒吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T09:11:09.070

我相信它`vn_rdwr()`是安全的并且保证是兼容的。

之所以一般不推荐，是因为级别很低。通过使用它，您可以有效地解决任何 FS 文件权限，避免调用通过 KAuth API 注册的回调（例如，聚光灯看不到此类更改）等。在大多数情况下，您应该在用户空间中执行 I/O（例如某些守护程序） .

仅当您确实有充分理由这样做时，才使用 KExt 中的 I/O。如果你有然后使用`vn_rdwr()`.

# apache-flex - 带 SIP 的 Flash Media Gateway 参考

> ID：10654498
> 
> 赞同：1
> 
> 时间：2012-05-18T14:27:58.233
> 
> 标签：apache-flex, sip, flex4.5, flash-media-server

我试图找出 Flash Media Gateway（支持电话集成的 Flash Media Server 的附加组件）是否能够支持 SIP REFER 动词。在我们设置的当前环境中，每当网关接收到 SIP REFER 消息时，呼叫最终都会被挂断，而不会出现任何错误日志。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:55:08.333

我终于收到了来自 Adob​​e 的直接答复：

> 目前，Flash Media Gateway 不支持接收 REFER，并且这些不包含在允许标头中。

# python - 从python字典中删除重复键但对值求和

> ID：10654499
> 
> 赞同：3
> 
> 时间：2012-05-18T14:28:00.423
> 
> 标签：python, duplicates

我有一本python字典

```
d = {tags[0]: value, tags[1]: value, tags[2]: value, tags[3]: value, tags[4]: value} 
```

想象一下这个字典大了 10 倍，它有 50 个键和 50 个值。可以在此标签中找到重复项，但即便如此，值也是必不可少的。我怎样才能简单地修剪它以接收新的字典而不重复键但使用值的总和？

`d = {'cat': 5, 'dog': 9, 'cat': 4, 'parrot': 6, 'cat': 6}`

结果

`d = {'cat': 15, 'dog': 9, 'parrot': 6}`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T14:39:24.760

我想改进 Paul Seeb 的回答：

```
tps = [('cat',5),('dog',9),('cat',4),('parrot',6),('cat',6)]
result = {}
for k, v in tps:
  result[k] = result.get(k, 0) + v 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T14:51:56.290

```
tps = [('cat',5),('dog',9),('cat',4),('parrot',6),('cat',6)]

from collections import defaultdict

dicto = defaultdict(int)

for k,v in tps:
    dicto[k] += v 
```

结果：

```
>>> dicto
defaultdict(<type 'int'>, {'dog': 9, 'parrot': 6, 'cat': 15}) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T14:32:42.650

我假设您可以将它们放在元组对列表中，而不仅仅是对这些事情进行 dict（在 dict 中不能有多个相同的键）。然后它就像

```
tps = [('cat',5),('dog',9),('cat',4),('parrot',6),('cat',6)]
result = {}
for k,v in tps:
    try:
        result[k] += v
    except KeyError:
        result[k] = v

>>> result
{'dog': 9, 'parrot': 6, 'cat': 15} 
```

将我的更改为更明确的 try-except 处理。Alfe's 非常简洁

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-05-30T20:11:23.870

这是使用[Counter](https://docs.python.org/2/library/collections.html#collections.Counter)数据结构的完美情况。让我们看看它在几个熟悉的数据结构上做了什么。让我们从好的旧列表开始。

```
>>> from collections import Counter
>>> list_a = ["A", "A", "B", "C", "C", "A", "D"]
>>> list_b = ["B", "A", "B", "C", "C", "C", "D"]
>>> c1 = Counter(list_a)
>>> c2 = Counter(list_b)
>>> c1
Counter({'A': 3, 'C': 2, 'B': 1, 'D': 1})
>>> c2
Counter({'C': 3, 'B': 2, 'A': 1, 'D': 1})
>>> c1 - c2
Counter({'A': 2})
>>> c1 + c2
Counter({'C': 5, 'A': 4, 'B': 3, 'D': 2})
>>> c_diff = c1 - c2
>>> c_diff.update([77, 77, -99, 0, 0, 0])
>>> c_diff
Counter({0: 3, 'A': 2, 77: 2, -99: 1}) 
```

如您所见，这表现为一个将元素出现次数保持为值的集合。嗯，但是使用字典而不是列表呢？字典本身是一个类似集合的结构，对于值我们不必有数字，那么如何处理呢？让我们来看看。

```
>>> dic1 = {"A":"a", "B":"b"}
>>> cd = Counter(dic1)
>>> cd
Counter({'B': 'b', 'A': 'a'})
>>> cd.update(B='bB123')
>>> cd
Counter({'B': 'bbB123', 'A': 'a'})

>>> dic2 = {"A":[1,2], "B": ("a", 5)}
>>> cd2 = Counter(dic2)
>>> cd2
Counter({'B': ('a', 5), 'A': [1, 2]})
>>> cd2.update(A=[42], B=(2,2))
>>> cd2
Counter({'B': ('a', 5, 2, 2), 'A': [1, 2, 42, 42, 42, 42]})
>>> cd2 = Counter(dic2)
>>> cd2
Counter({'B': ('a', 5), 'A': [1, 2]})
>>> cd2.update(A=[42], B=("new elem",))
>>> cd2
Counter({'B': ('a', 5, 'new elem'), 'A': [1, 2, 42]}) 
```

如您所见，我们添加/更改的值必须是相同类型的，`update`否则会抛出`TypeError`. 至于你的特殊情况，顺其自然

```
>>> d = {'cat': 5, 'dog': 9, 'cat': 4, 'parrot': 6, 'cat': 6}
>>> cd3 = Counter(d)
>>> cd3
Counter({'dog': 9, 'parrot': 6, 'cat': 6})
cd3.update(parrot=123)
cd3
Counter({'parrot': 129, 'dog': 9, 'cat': 6}) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-18T15:12:36.460

我不确定你想要实现什么，但 Counter 类可能对你想要做的事情有所帮助：http: [//docs.python.org/dev/library/collections.html#collections.Counter](http://docs.python.org/dev/library/collections.html#collections.Counter)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-18T14:40:49.657

也许你真正想要的是一个[`tuple`](http://docs.python.org/tutorial/datastructures.html#tuples-and-sequences)键值对。

```
[('dog',1), ('cat',2), ('cat',3)] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-17T16:16:13.463

如果我正确理解您想要删除重复键数据的问题，请在创建字典时使用字典的更新功能。如果密钥重复，它将覆盖数据。

```
tps = [('cat',5),('dog',9),('cat',4),('parrot',6),('cat',6)]
result = {}
for k, v in tps:
    result.update({k:v})
for k in result:
    print "%s: %s" % (k, result[k]) 
```

输出将如下所示： **狗：9 鹦鹉：6 猫：6**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-18T14:37:58.920

此选项提供但通过列表完成，或者最好可以提供洞察力

```
data = []
        for i, j in query.iteritems():
            data.append(int(j))    
        try:
            data.sort()
        except TypeError:
            del data
        data_array = []
        for x in data:
            if x not in data_array:
                data_array.append(x)  
        return data_array 
```

# jsf - InputText 绑定到一个空双字段存在“0.0”

> ID：10654503
> 
> 赞同：3
> 
> 时间：2012-05-18T14:28:04.720
> 
> 标签：jsf, jsf-2, el

有没有办法在不创建新转换器的情况下防止这种情况？

```
<p:inputText value="#{myMB.myDouble}" />

@ManagedBean
@SessionScoped
public class MyMB
    private Double myDouble = null;
.... 
```

当我进入视图时，我想看到空输入字段，而不是“0.0”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T14:30:43.387

如果您使用的是 Tomcat 6.0.16 或更新版本，或者使用相同的 Apache EL 解析器（如 JBoss AS 和 WebSphere AS）的一个分支，就会发生这种情况。您基本上需要告诉 Apache EL 解析器不要通过以下自 Tomcat 6.0.17 起支持的 VM 参数将原语强制为其默认值：

```
-Dorg.apache.el.parser.COERCE_TO_ZERO=false 
```

此问题与 JSF 无关。例如，它不会发生在 Glassfish 上。

# php - Zend 调试器 - Wamp2.2 + Eclipse PHP

> ID：10654505
> 
> 赞同：1
> 
> 时间：2012-05-18T14:28:06.937
> 
> 标签：php, eclipse, apache, zend-framework, wamp

我试图让 zend 调试器与 eclipse 一起工作，以便我可以在我的代码中触发断点。

我已经安装了 wamp 2.2（使用 PHP 5.3.10 - 线程安全）

我已经从 zend 安装了 eclipse 'all in one' 包。

我已经更新了我的 php.ini 以包含

```
zend_extension = "c:/wamp/bin/php/php5.3.10/zend_ext/ZendDebugger.dll"

[Zend]
zend_debugger.allow_hosts="127.0.0.1"
zend_debugger.expose_remotely=always 
```

当我启动我的 php.exe 时，它​​显示

```
Cannot load Zend Debugger - it was build with configuration API220090626,NTS,VC9, whereas running engine is API2200090626,TS,VC9 
```

我读过 ZendDebugger 只能作为非线程安全的，所以我不能只下载一个 ts 版本。我找不到 php 5.3.10 (http://windows.php.net/download/) 的下载链接

但是，当我尝试用 5.3.13 (nts) 替换我的 php 副本时，我的 sqlsrv 扩展不兼容并且我收到错误

```
PHP Startup: Unable to load dynamic library 'c:wamp/bin/php/php5.3.10/ext/php_sqlsrv_53_nts.dll' - %1 is not a valid Win32 application 
```

如果我将 php.ini 更改为不加载 sqlsrv 扩展，我仍然会收到错误消息

```
Failed loading c:/wamp/bin/php/php5.3.10/zend_ext/ZendDebugger.dll 
```

有谁知道我怎样才能使用 Zend Framework、Eclipse、wamp 和 sqlserv 进行调试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-19T16:25:30.107

> 无法加载 Zend 调试器 - 它是使用配置 API220090626、**NTS**、VC9 构建的，而运行引擎是 API2200090626、TS、VC9

NTS 意味着非线程安全，因此您必须使用 PHP 的 NTS 构建......这就是您将 PHP 作为 FCGI 进程运行的方式（与通过 mod_php 的 Apache Thread 相比）。

Zend 通常不再提供或支持任何东西的 TS 构建（自 PHP 5.2 之后），看起来您的设置是为了 TS 构建......

你可以尝试两件事：

使用 PHP 附带的 WAMP 作为 FCGI (NTS) 选项（我知道最新版本的[Wamp-Developer](http://www.devside.net/server/webdeveloper)可以，但它是商业的，也许看看[XAMPP](http://www.apachefriends.org/en/xampp.html)或其他[Wamp](http://en.wikipedia.org/wiki/Comparison_of_WAMPs)是否可以？）

或者代替 ZendDebugger，尝试使用 XDebug。它同时作为 TS 和 NTS 构建。而且我确信您可以使用 Eclipse。

# sql-server - T-SQL 查询更新空值

> ID：10654508
> 
> 赞同：3
> 
> 时间：2012-05-18T14:28:20.860
> 
> 标签：sql-server, tsql, common-table-expression

我在 T-SQL 中有一个非常具体的问题。

如果我能解决我给你的这个示例案例，我想我将能够解决我原来的案例。

将这些数据放在一个表中：

```
DECLARE @Test TABLE
(
    Value INT
    ,Date DATETIME2(7)
);

INSERT INTO @Test
VALUES
(NULL, '2011-01-01 10:00'),
(NULL, '2011-01-01 11:00'),
(2, '2011-01-01 12:00'),
(NULL, '2011-01-01 13:00'),
(3, '2011-01-01 14:00'),
(NULL, '2011-01-01 15:00'),
(NULL, '2011-01-01 16:00'),
(4, '2011-01-01 17:00'),
(NULL, '2011-01-01 18:00'),
(5, '2011-01-01 19:00'),
(6, '2011-01-01 20:00') 
```

我需要选择这个输出：

```
Value   Date
2       2011-01-01 10:00
2       2011-01-01 11:00
2       2011-01-01 12:00
2       2011-01-01 13:00
3       2011-01-01 14:00
3       2011-01-01 15:00
3       2011-01-01 16:00
4       2011-01-01 17:00
4       2011-01-01 18:00
5       2011-01-01 19:00
6       2011-01-01 20:00 
```

给出一些解释。如果某处的值为 NULL，我需要使用前一小时的值进行更新。如果一行中有多个空值，则具有非空值的最接近的较早时间将传播并填充所有这些空值。此外，如果一天的第一个小时为空，那么在这种情况下，具有非空值的当天最早的一小时会像 2 一样向下传播。在您的情况下，您可以假设至少一个值是非空值。

我的目标是用通用表表达式或类似的东西来解决这个问题。如果我尝试使用光标方式，我想我会在很短的时间内找到解决方案，但到目前为止我对 CTE 和递归 CTE 的尝试都失败了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T14:41:09.797

由于您的情况并不总是相同，这有点困难。在您的示例中，前两行需要从较晚日期的第一个值中获取它们的值，在其他情况下，它们需要从以前的日期中获取值。如果您总是需要查看以前的日期，您可以简单地执行以下查询：

```
SELECT  B.Value,
        A.[Date]
FROM @Test A
OUTER APPLY (SELECT TOP 1 *
             FROM @Test
             WHERE [Date] <= A.[Date] AND Value IS NOT NULL
             ORDER BY [Date] DESC) B 
```

但在你的情况下，我认为你需要这个：

```
SELECT  ISNULL(B.Value,C.Value) Value,
        A.[Date]
FROM @Test A
OUTER APPLY (SELECT TOP 1 *
             FROM @Test
             WHERE [Date] <= A.[Date] AND Value IS NOT NULL
             ORDER BY [Date] DESC) B
OUTER APPLY (SELECT TOP 1 *
             FROM @Test
             WHERE Value IS NOT NULL
             ORDER BY [Date]) C 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T14:49:03.533

尝试这个：

```
select 
    t.value, t.date
      ,COALESCE(t.value
               ,(select MAX(tt.value) from @Test tt WHERE t.Date>tt.Date)
               ,(SELECT MIN(ttt.Value) FROM @Test ttt Where ttt.Date IS NOT NULL)
               ) AS UseValue
    from @Test   t 
```

输出：

```
value       date                    UseValue
----------- ----------------------- -----------
NULL        2011-01-01 10:00:00.000 2
NULL        2011-01-01 11:00:00.000 2
2           2011-01-01 12:00:00.000 2
NULL        2011-01-01 13:00:00.000 2
3           2011-01-01 14:00:00.000 3
NULL        2011-01-01 15:00:00.000 3
NULL        2011-01-01 16:00:00.000 3
4           2011-01-01 17:00:00.000 4
NULL        2011-01-01 18:00:00.000 4
5           2011-01-01 19:00:00.000 5
6           2011-01-01 20:00:00.000 6 
```

# java - 询问在客户端到客户端之间传递消息

> ID：10654509
> 
> 赞同：0
> 
> 时间：2012-05-18T14:28:23.520
> 
> 标签：java

嗨，我为客户端和服务器编写了代码，现在我想在 clint 1 到 clint 2 之间传递消息，我没有成功在服务器端执行此操作我想为名称和 id 构造数组，并且在我从客户端发送消息之后我可以选择服务器发送消息的位置或名称请帮我写这个，所以这是克林特的一面

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.Socket;

public class client {

    public static void main(String[] args) {
        Socket socket = null; 
        try {
            socket = new Socket("127.0.0.1", 7777);
            BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            BufferedReader readerFromCommandLine = new BufferedReader(new InputStreamReader(System.in));
            PrintWriter writer = new PrintWriter(socket.getOutputStream());

            while(true) {                               
                System.out.println("Say something:");
                String userInput = readerFromCommandLine.readLine();
                writer.println(userInput);
                writer.flush();

                String input = reader.readLine();               

                System.out.println("Got from server: "+input);

                if (userInput.equalsIgnoreCase("bye")) {
                    break;
                }
            }
        }
        catch(Exception e) {
            System.err.println(e);
            e.printStackTrace();
        }
        finally {
            if (socket != null) {               
                try {
                    socket.close();
                } 
                catch (Exception e) {
                    System.err.println(e);
                    e.printStackTrace();
                }               
            }
        }
    }

} 
```

所以现在我的代码看起来像这样？因为我还不能从一个客户发送到客户二

```
import java.awt.List;
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.ArrayList;

public class server {

    public static void main(String[] args) {
        ArrayList<Channel> my_clients = new ArrayList<Channel>(); 
        ServerSocket ss = null;

        try {
            ss = new ServerSocket(7777);            

            while (true) {
                //wait for a new client call - once got it, get the socket for
                //that channel

                System.out.println("Waiting for an incoming call");
                Socket client = ss.accept();
                Channel my_new_client = new Channel(client); 
                my_clients.add(my_new_client); 
                my_new_client.start();
                //once the call has started read the client data
                for(Channel my_client : my_clients) { 
                    if(my_client.getName() == "Me") { 
                        //my_client.writer("HELLO!"); 

                    }
                }
                //System.out.println("Accepted a new call");                                
                //new Channel(client).start();

            }
        }
        catch(Exception e) {
            System.err.println(e);
            e.printStackTrace();
        }
        finally {
            if (ss != null) {
                try {
                    ss.close();
                }
                catch(Exception e) {
                    System.err.println(e);
                    e.printStackTrace();
                }
            }
        }

    }

     public static class Channel extends Thread {

         private static int clientIndex = 0;
         private int index;

        private Socket socket = null;

        public Channel(Socket socket) {
            clientIndex++;
            index = clientIndex;
            this.socket = socket;
        }

        @Override
        public void run() {

            try {
                BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));
                PrintWriter writer = new PrintWriter(socket.getOutputStream());

                while (true) {  

                    String input = reader.readLine();                   
                    System.out.println("Got from client "+index+": "+input);

                    //bye bye
                    if (input.equalsIgnoreCase("bye")) {
                        break;
                    }
                    writer.println("Gotcha");
                    writer.flush();                         
                }
            }
            catch(Exception e) {
                System.err.println(e);
                e.printStackTrace();
            }
            finally {
                if (socket != null) {
                    try {
                        socket.close();
                    }
                    catch(Exception e) {
                        System.err.println(e);
                        e.printStackTrace();
                    }
                }
            }
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:35:15.570

> > String userInput = readerFromCommandLine.readLine();

BufferedReader.readLine() 在这里是个问题。它会阻塞你的线程，直到收到输入。这意味着通信一次只能朝一个方向进行，并且如果两个客户端都在等待，则可能会完全阻塞。

DataFetcher 可以解决这个问题；您可以使用它在单独的线程中收听

[http://tus.svn.sourceforge.net/viewvc/tus/tjacobs/io/](http://tus.svn.sourceforge.net/viewvc/tus/tjacobs/io/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:41:18.863

你到了一半。

您创建了一个线程服务器，来自客户端的每个连接都会打开一个线程。然后该线程循环并等待消息。

当您将客户端与它们自己的对象/属性及其要写入和读取它们的流连接时，请考虑这些线程。

因此，每次您想要创建他们的线程的客户端连接时，将其添加到某种列表并启动他们的线程。例如：

在班上名列前茅

```
List<Channel> my_clients = new List<Channel>(); 
```

在你的 while 循环中

```
Channel my_new_client = new Channel(client);
my_clients.add(my_new_client);
my_new_client.start(); 
```

然后当你想向某个客户发送消息时。您可以循环所有线程并查找具有某种名称或唯一标识符的线程。例如：

```
for(Channel my_client : my_clients) {
    if(my_client.getName() == "Me") {
        my_client.write("HELLO!");
    }
} 
```

或者您可以同时向所有客户发送消息（广播）：

```
for(Channel my_client : my_clients) {
    my_client.write("HELLO!");
} 
```

记得在客户端断开连接时删除它们！

```
// Can't remember the precise exception correct my if I'm wrong!
catch(SocketException ex) {
     my_clients.remove(this);
} 
```

**请注意，这需要您了解如何验证并知道您的客户端的名称，或者为他们提供一个 UID，当您被指示向他们发送某些内容时，您可以参考该 UID。并且 Channel 类具有纵容的 Write 方法。**

希望有帮助！

# javascript - 如何使用 javascript 突出显示 jqplot 条形图

> ID：10654511
> 
> 赞同：2
> 
> 时间：2012-05-18T14:28:30.977
> 
> 标签：javascript, jquery, charts, jqplot

我有一个已解析的数据表，用于生成带有 jqplot 的条形图。我希望能够在表格行悬停时突出显示特定栏。

突出显示周围的方式很容易 - 只需连接到 jqplotDataHighlight 和 jqplotDataUnhighlight 事件。任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T11:38:51.970

我把它钉牢了。

我已经扩展了位于 jqplot.highight.js 中的 Highlighter 对象，这样我们就可以从库外部突出显示和取消突出显示。

Sill 这可用于任何高光，但应检测渲染器。我没有花时间这样做。

```
$.jqplot.Highlighter.highlightBar = function(plot, serIndex, barId, barXVal, barYVal) {
    //We just use the showTooltip. Simple!
    var neighbor = {
        seriesIndex: serIndex,
        pointIndex: barId,
        data: {
            0: barXVal,
            1: barYVal
        },
        gridData: plot.series[serIndex].gridData[barId],
        points: plot.series[serIndex]._barPoints[barId]
    }
    showTooltip(plot, plot.series[serIndex], neighbor);
    barHighlight(plot, serIndex, barId, neighbor.points);

}

function barHighlight(plot, sidx, pidx, points) {
    var s = plot.series[sidx];
    var canvas = plot.plugins.barRenderer.highlightCanvas;
    canvas._ctx.clearRect(0,0,canvas._ctx.canvas.width, canvas._ctx.canvas.height);
    s._highlightedPoint = pidx;
    plot.plugins.barRenderer.highlightedSeriesIndex = sidx;
    var opts = {fillStyle: s.highlightColors[pidx]};
    s.renderer.shapeRenderer.draw(canvas._ctx, points, opts);
    canvas = null;
}

function barUnhighlight(plot) {
    var canvas = plot.plugins.barRenderer.highlightCanvas;
    canvas._ctx.clearRect(0,0, canvas._ctx.canvas.width, canvas._ctx.canvas.height);
    for (var i=0; i<plot.series.length; i++) {
        plot.series[i]._highlightedPoint = null;
    }
    plot.plugins.barRenderer.highlightedSeriesIndex = null;
    plot.target.trigger('jqplotDataUnhighlight');
    canvas =  null;
}

$.jqplot.Highlighter.clearHighlight = function (plot) {
    barUnighlight(plot);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T13:05:40.047

很高兴你设法自己解决了，Nickolay。

不过，我想提出一种不同的方法。不涉及更改荧光笔脚本的一种。[我对类似问题的回答中](https://stackoverflow.com/a/10434535/613495)介绍了您可以根据需要采用的解决方案。

[直接链接到 jsfiddle 展示我的方法。](http://jsfiddle.net/Boro/5QA8r/)

# c# - 如何在等待事件触发时显示一个表单屏幕

> ID：10654512
> 
> 赞同：2
> 
> 时间：2012-05-18T14:28:31.260
> 
> 标签：c#, events, triggers, gps, handler

我的程序需要帮助。所以我有 com 端口连接（gps 设备），当程序启动时，我希望能够显示 Form2，直到 gps 事件处理程序被触发。同样，当设备开始向我发送数据时，有时设备无法向我提供数据。那个时候我怎么知道我需要再次显示Form2？

这解释起来有点复杂。

这是我到目前为止所做的。因此，当 Form1 加载时，我正在显示一个 Form2 屏幕，基本上说我正在等待信号显示。现在我怎么能把它放在某种循环或类似的东西中，它将总是检查要触发的事件处理程序，同时我正在显示这个表单2。

如果您需要更多解释，请告诉我。

所以这里是代码：

```
private void Form1_Load(object sender, EventArgs e)
{
  //open the com port when loading form
  comport.Open();

  Form2 my_form2 = new Form2();
  my_form2.ShowDialog();
} 
```

这是 GPS 信号的事件处理程序：

```
GPS.PositionReceived += new NmeaInterpreter.PositionReceivedEventHandler(GPS_PositionReceived); 
```

这是GPS功能：

```
private void GPS_PositionReceived(string Lat, string Lon)
{
arrLon = Lon.Split(new char[] { '°', '"' }, StringSplitOptions.RemoveEmptyEntries);
dblLon = double.Parse(arrLon[0]) + double.Parse(arrLon[1], new System.Globalization.NumberFormatInfo()) / 60;
deciLon = arrLon[2] == "E" ? dblLon : -dblLon;

//some more code 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:33:38.533

那么为什么不在事件处理程序触发时关闭表单呢？这就是他们的全部目的。

他们在触发某些事情时运行代码。

有一个等待状态更改的不确定循环是一个坏主意。

```
private void GPS_PositionReceived(string Lat, string Lon)
{
    arrLon = Lon.Split(new char[] { '°', '"' }, StringSplitOptions.RemoveEmptyEntries);
    dblLon = double.Parse(arrLon[0]) + double.Parse(arrLon[1], new System.Globalization.NumberFormatInfo()) / 60;
    deciLon = arrLon[2] == "E" ? dblLon : -dblLon;

    //some more code 

    // LOAD FORM 1
    // CLOSE THIS FORM (FORM 2)
} 
```

# symfony - 检查是否使用 Symfony2 中的正则表达式授予角色？

> ID：10654515
> 
> 赞同：0
> 
> 时间：2012-05-18T14:28:50.510
> 
> 标签：symfony

我的角色类似于`SEND_SMS_100`，`SEND_SMS_200`或者更一般地说`SEND_SMS_X`，其中`X`是一个整数。这是用户在一个月内可以发送的最大小型短信数量。一个用户最多应该有一个这个角色。我在找：

*   `ensure SEND_SMS_X`被授予
*   提取`X`整数

AFAIK 这将不支持基于正则表达式的搜索：

```
$this->get('security.context')->isGranted($roleName); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T16:03:48.120

我认为这是一个糟糕的设计——这不应该是由角色控制的。

您可能应该在您的用户实体上有一个 $smsPerMonth 属性，这样您就可以调用 getSmsPerMonth() 而不是使用许多不同的角色来确定用户可以发送多少条 SMS 消息。

# java - 为什么即使在不兼容的对象版本之间，java 反序列化也会成功？

> ID：10654516
> 
> 赞同：1
> 
> 时间：2012-05-18T14:29:05.570
> 
> 标签：java, serialization, late-binding

在客户端-服务器设置中，我修改了服务器发送的对象的类定义，并预计会在客户端崩溃（客户端 jar 尚未更新以反映这些更改）。

但是，它不会崩溃。

注意：客户端使用对象的方式，可能会避免崩溃。客户端从不强制转换反序列化的对象，也从不使用已删除的字段。该对象仅通过 Jython 从 Python 脚本中使用，它可能在使用对象的字段时采用了一些后期绑定机制（反射？），因此使事情成为可能。这也假设序列化包括类的签名，这是真的（在 ObjectOutputStream 的文档中提到）。

还要注意：我们从不更改 serialVersionUid。

我的推理似乎正确吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T14:35:59.783

仅当您不提供 serialVersionUID 时，序列化才会使用类签名生成版本控制，因为您提供了一个，所以不会使用类签名。

由于它没有改变，它假定两者都是兼容的并执行默认行为

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:32:38.280

好吧，如果您`serialVersionUID`在课堂上使用它，那么您可以自行更改它。

否则，如果有任何更改，java 将依靠反射来引发异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-19T11:53:47.503

只要 serialVersionUID 匹配，删除字段就不是不兼容的更改。请参阅对象序列化规范的对象版本控制章节。

# typo3 - 有 TYPO3 DAM API 指南吗？

> ID：10654519
> 
> 赞同：0
> 
> 时间：2012-05-18T14:29:11.453
> 
> 标签：typo3, dam

我需要编写一个导入工具来获取大量现有图像并在 TYPO3 系统中为它们创建 DAM 记录。

我能找到的唯一与 DAM 相关的手册是前端相关的，根本没有 API。我试图查看代码本身，但其中有太多内容无法找到我正在寻找的内容。

所以基本上我正在寻找一个好的 API 手册/指南（如果有的话）或者一个我需要做的事情的例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T16:00:18.247

不，没有这样的 API，上次当我不得不执行类似的任务时，它是通过自定义扩展完成的。您所需要的只是将记录插入到 tx_dam 表中，并最终使用 mm 表将其与某些类别/类别连接起来。

另一方面，DAM 有自己的`indexing`模块，它允许您为通过 DAM 模块以外的方式上传的文件创建 DAM 记录。也许它不是超级舒服并且需要注意，但是您可以在没有额外编程的情况下做您需要的事情。

# mysql - SQL Server 在 Drop 上抛出错误

> ID：10654525
> 
> 赞同：1
> 
> 时间：2012-05-18T14:29:27.670
> 
> 标签：mysql, sql, sql-server-2008

我正在尝试在 SQL Server 中创建一个数据库，但它不断抛出错误。你能看看剧本，看看我是不是把它搞砸了吗？

```
 drop database if exists cptc;

create database cptc;

use cptc;

drop table if exists staff;

create table staff (
  staffID int not null auto_increment,
  fname varchar(25),
  lname varchar(25),
  title varchar(50),
  phone varchar(10),
  building varchar(10),
  room varchar(10),
  PRIMARY KEY(staffID),
FULLTEXT (fname,lname)  
)ENGINE = MYISAM;

INSERT INTO staff VALUES ('','michael','herrera','doctor','2539703420','B14','122');
INSERT INTO staff VALUES ('','holly','herrera','teacher','2534667896','B35','116');
INSERT INTO staff VALUES ('','jesse','kirsch','professor','2534567890','B12','112');
INSERT INTO staff VALUES ('','mark','wahlberg','professor','5552345678','B01','112');
INSERT INTO staff VALUES ('','philip','spears','technician','2065672345','B12','123');
INSERT INTO staff VALUES ('','andrew','jackson','teacher','2061234567','B32','101');
INSERT INTO staff VALUES ('','annie','smith','mechanic','2533345609','B23','102');
INSERT INTO staff VALUES ('','alfred','hills','teacher','2535821513','B14','103');
INSERT INTO staff VALUES ('','bobby','jones','nurse','5559876056','B10','104');
INSERT INTO staff VALUES ('','tiffany','jones','janitor','2539981265','B02','108'); 
```

更新：我认为我遇到了错误，因为它是 MySQL 而不是 SQL。感谢大家的（非常快速的）答案！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T14:30:50.500

这部分是 MYSQL 不是 SQL Server `ENGINE = MYISAM;`

这是该表在 SQL Server 中的样子（没有全文索引，您首先需要启用全文搜索才能创建全文索引））

```
create table staff (
  staffID int not null identity,
  fname varchar(25),
  lname varchar(25),
  title varchar(50),
  phone varchar(10),
  building varchar(10),
  room varchar(10),
  PRIMARY KEY(staffID) 
) 
```

删除和创建数据库将如下所示

```
USE [master]
GO

IF  EXISTS (SELECT name FROM sys.databases 
WHERE name = N'cptc')
DROP DATABASE cptc
GO

CREATE DATABASE [cptc] 
```

放置表将如下所示

```
IF  EXISTS (SELECT * FROM sys.objects 
WHERE object_id = OBJECT_ID(N'staff') AND type in (N'U'))
DROP TABLE staff
GO 
```

最后，您需要在插入时省略标识列，例如

```
INSERT INTO staff VALUES ('michael','herrera','doctor','2539703420','B14','122'); 
```

如果不省略该列，您将收到以下错误

消息 8101，第 16 层，状态 1，第 1 行

只有在使用列列表并且 IDENTITY_INSERT 为 ON 时，才能为表“staff”中的标识列指定显式值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:32:20.577

*   auto_increment 应该是 identity(1,1)
*   引擎 = MYISAM；不存在你对它有什么期望？
*   FULLTEXT (fname, lname) 不正确。你想要什么，实现全文搜索？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:35:38.133

问题不清楚。您正在创建一个表而不是数据库。如果您提供实际的错误详细信息，将会很有帮助。

顺便说一句，您不应该为服务器自动分配的自动增量列输入任何值。我想这是造成问题的原因。

# c# - 无法分配给方法组

> ID：10654529
> 
> 赞同：1
> 
> 时间：2012-05-18T14:29:49.287
> 
> 标签：c#, methods, ado.net

```
public bool AddArchitecture(DataSet Architecture)
    {
        base.SQL = "sp_InsertArchitecture";
        base.InitializeCommand();
        base.AddParameter("@Architecture_ID",
            SqlDbType.UniqueIdentifier, 16,
            Architecture.Tables.Add("Architecture").Rows.Add("Architecture_ID"));
        base.AddParameter("@Architecture_Name",
            SqlDbType.VarChar, 25,
            Architecture.Tables.Add("Architecture").Rows.Add("Architecture_Name"));
        base.AddParameter("@Architecture_Description",
            SqlDbType.VarChar, 25,
            Architecture.Tables.Add("Architecture").Rows.Add("Architecture_Description"));
        base.AddParameter("@Architecture_Date_Added",
            SqlDbType.DateTime, 8,
            Architecture.Tables.Add("Architecture").Rows.Add("Architecture_Date_Added"));

        **AddArchitecture** = ExecuteStoredProcedure; This is where I get the error.
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T14:31:16.257

您是 VB 程序员，第一次使用 C#，对吧？

我*想*你想要

```
return ExecuteStoredProcedure(); 
```

反而。

# html - 如何将一系列图标和标题居中在同一行（UIWebView）

> ID：10654533
> 
> 赞同：0
> 
> 时间：2012-05-18T14:29:53.807
> 
> 标签：html, css, ios, uiwebview

我目前正在使用 UIWebview 进行一些富文本格式。我想将一系列图标（PNG图像）放在同一行的中心，然后是标题。我在正确设置我的 css 样式以获得预期效果时遇到问题。与Objective C相比，它更像是一个与css相关的问题。

到目前为止，我所做的是：

```
NSString* htmlContentString = [NSString stringWithFormat:
                                   @"<html>"
                                   "<style type=\"text/css\">"
                                   "h1 { font-size: 40px;\
                                         font-family: Wisdom Script;\
                                         text-align: center;\
                                         margin-top:5px;\
                                         margin-bottom:0px;\
                                         background-color: black;\
                                   }"
                                   "body { background-color:transparent;\
                                           font-family:Helvetica;\
                                           font-size:14;\
                                           margin-top:0px;\
                                    }"
                                   "#people { background: yellow\
                                              url('tipnbpeople_icon.png')\
                                              no-repeat left center;\
                                              padding-left: 45 px;\
                                              line-height: 40px;\
                                   }"
                                   "#container {\
                                            width: 300px; \
                                            margin:0px auto;\
                                            border:1px dashed #333;\
                                   }"

                                   "</style>"

                                   "<body>"
                                        "<h1>%@</h1>"
                                        "<div id=\"container\">\
                                            <div id=\"people\">Caption1</div>\
                                            <div id=\"people\">Caption2</div>\
                                            <div id=\"people\">Caption3</div>\
                                        </div>"
                                   "</body></html>"\
                                   , noAccentTipName]; 
```

我得到的结果是一系列图标和标题，但不在同一行。任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T19:01:51.107

允许在`margin:0px auto`页面上居中包含块。这里我设置的宽度是固定的。由于它是固定的，因此内容将尝试适应固定宽度并以多行显示。我需要使用的是对容器 div 使用文本对齐。

这是我最终使用的代码：

```
 NSString* htmlContentString = [NSString stringWithFormat:
                                   @"<html>"
                                   "<style type=\"text/css\">"
                                   "h1 { font-size: 40px;\
                                         font-family: Wisdom Script;\
                                         text-align: center;\
                                         margin-top:15px;\
                                         margin-bottom:0px;\
                                         background-color: transparent;\
                                   }"
                                   "body { background-color:transparent;\
                                           font-family:Helvetica;\
                                           font-size:14;\
                                           margin-top:0px;\
                                    }"
                                   " img {\
                                          width:40px;\
                                          height:35px;\
                                          vertical-align:bottom;\
                                   }"

                                   "#text {\
                                        width:60px\
                                   }"
                                   "#container {\
                                            text-align:center;\
                                   }"
                                   ".insetText {\
                                   color: #020202;\
                                   text-shadow: 0 -1px 0 rgba(0,0,0,0.15),\
                                   0 1px 0 rgba(255,255,255,0.8)}"
                                   "@font-face { font-family: 'Wisdom Script'; \
                                   src: local('WisdomScriptAI'),\
                                   url('wisdom_script.ttf') format('truetype'); }"
                                   "</style>" //end the style section

                                   "<body>" //start content
                                        "<h1 class=\"insetText\">%@</h1>"
                                        "<div id=\"container\" class=\"insetText\">\
                                            <img src=\"tipnbpeople_icon.png\"/>Caption1\
                                            <img src=\"clock_icon.png\"/>Caption2\
                                            <img src=\"chef_icon.png\"/>Captions3</div>"
                                   "</body></html>"\
                                   , noAccentTipName]; 
```

这会在同一行显示 3 个带有相应标题的图标。

# algorithm - 用于合并排序的 PRAM（并行）算法

> ID：10654537
> 
> 赞同：0
> 
> 时间：2012-05-18T14:30:06.593
> 
> 标签：algorithm, mergesort

我正在阅读第三版算法简介中的多线程合并排序。但是，我对以下合并排序算法所需的处理器数量感到困惑：

```
MERGE-SORT(A, p, r)
1 if p < r
2 q = (p+r)/2
3 spawn MERGE-SORT(A, p, q)
4 MERGE-SORT(A, q + 1, r)
5 sync
6 MERGE(A, p, q, r) 
```

MERGE 是标准的合并算法。现在这个算法需要多少处理器？？虽然我假设它应该是 O(N)，但是这本书声称它是 O(log n)，为什么？请注意，我没有对 MERGE 过程进行多线程处理。一个例子的解释将非常有帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:55:52.473

O(log n) 值不是运行算法“需要”的 CPU 数量，而是算法实现的实际“并行度”。因为 MERGE 本身不是并行化的，所以如果 O(n) 处理器，即使您拥有所有可用的处理器，您也不会获得全部好处。

也就是说，归并排序的单线程串行时间复杂度为 O(n log n)。您可以将“n”视为合并的成本，将“log n”视为在合并排序的递归调用中计算的因素，以使数组进入可以合并的阶段。当您并行化递归，但合并仍然是串行的，您保存 O(log n) 因子但 O(n) 因子保留在那里。因此，当您有足够的可用处理器时，并行度的数量级为 O(log n)，但您无法达到 O(n)。

换句话说，即使你有 O(n) 个 CPU 可用，它们中的大多数也会很快空闲，当大型 MERGE 开始发生时，工作的 CPU 越来越少。

# spring-integration - Spring集成队列，有什么方法可以获取当前队列大小？

> ID：10654541
> 
> 赞同：1
> 
> 时间：2012-05-18T14:30:37.433
> 
> 标签：spring-integration

我们有场景需要异步处理来自外部系统的大量消息，目前的设计是每 5 分钟唤醒一次工作以从外部系统提取 msg，然后持久化原始 msg，然后将 msg id 发送到 ExecutorChannel，所以消费者（可能很多）可以从渠道消费。

我们面临的问题是如何处理队列中的消息时系统崩溃，不知何故，每次作业唤醒时，我们都需要查看我们的数据库以找出是否有任何原始消息不在队列中。

最简单的方法是查询当前队列大小并找出队列中的原始味精是否多于味精。所以我的问题是： ExecutorChannel 是否有任何 API 可以找出队列的大小？或任何其他建议？

谢谢杰森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:08:43.050

Spring Integration 本身并不在 ExecutorChannel 中维护队列；消息由底层 Executor 执行。

如果您使用的是专用于通道的 Spring ThreadPoolTask​​Executor，您可以深入到通道的底层 ThreadPoolTask​​Executor 的 ThreadPoolExecutor，并获取其 BlockingQueue (getQueue()) 的句柄并获取它的计数。

但是，您还必须添加活动任务计数。

总计数将是近似值，但因为 ThreadPoolExecutor 没有原子方法来获取排队和活动任务的计数。

# jsf-2 - Websphere 7.0 上的 JSF 2.0 部署异常

> ID：10654543
> 
> 赞同：1
> 
> 时间：2012-05-18T14:30:47.477
> 
> 标签：jsf-2

我正在 RAD 7.5.5 中编写一个项目，UI 是在 Primefaces、JSF 2.0 中开发的。当我尝试在 Websphere 7.0 上部署我的应用程序时，出现以下错误。我试着做一个谷歌，但无法得到任何解决方案，尝试了所有可能的建议。我试图解决这个问题的解决方案。我将应用程序部署为配置战争的耳朵。（尝试只部署战争，但仍然是同样的错误）

（我尝试了所有这些选项的各种组合......我知道我不想留下任何石头...... :(但仍然没有运气）

1.  从 web.xml 中删除`ConfigureListener`并从 WEB-INF/lib 文件夹中删除 jsf-api.jar 和 jsf-impl.jar 并进行部署。
2.  将 Parent 类加载器设置为 PARENT_LAST。
3.  在控制台的 JSP 和 JSF 选项下选择“Sun Reference”选项。
4.  尝试在共享库中添加 jsf-impl.jar 和 jsf-api.jar 并引用已部署的应用程序。
5.  尝试停止服务器做了一个 clean->publish。
6.  尝试配置新配置文件并将应用程序部署到新配置文件。

我以前有这个工作但突然开始发生这种情况......可能是什么问题？

```
 [5/18/12 10:12:25:873 EDT] 00000009 servlet       E com.ibm.ws.webcontainer.servlet.ServletWrapper init SRVE0100E: Uncaught init() exception created by servlet Faces Servlet in application employeedirWeb-ear: java.lang.IllegalStateException: Application was not properly initialized at startup, could not find Factory: javax.faces.context.FacesContextFactory
    at javax.faces.FactoryFinder.getFactory(FactoryFinder.java:270)
    at javax.faces.webapp.FacesServlet.init(FacesServlet.java:164)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.init(ServletWrapper.java:358)
    at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.init(ServletWrapperImpl.java:169)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.initialize(ServletWrapper.java:1809)
    at com.ibm.wsspi.webcontainer.extension.WebExtensionProcessor.createServletWrapper(WebExtensionProcessor.java:98)
    at com.ibm.ws.webcontainer.webapp.WebApp.getServletWrapper(WebApp.java:1038)
    at com.ibm.ws.webcontainer.webapp.WebApp.getServletWrapper(WebApp.java:959)
    at com.ibm.ws.webcontainer.webapp.WebApp.initializeTargetMappings(WebApp.java:638)
    at com.ibm.ws.webcontainer.webapp.WebApp.commonInitializationFinally(WebApp.java:436)
    at com.ibm.ws.webcontainer.webapp.WebAppImpl.initialize(WebAppImpl.java:304)
    at com.ibm.ws.webcontainer.webapp.WebGroupImpl.addWebApplication(WebGroupImpl.java:100)
    at com.ibm.ws.webcontainer.VirtualHostImpl.addWebApplication(VirtualHostImpl.java:166)
    at com.ibm.ws.webcontainer.WSWebContainer.addWebApp(WSWebContainer.java:731)
    at com.ibm.ws.webcontainer.WSWebContainer.addWebApplication(WSWebContainer.java:616)
    at com.ibm.ws.webcontainer.component.WebContainerImpl.install(WebContainerImpl.java:376)
    at com.ibm.ws.webcontainer.component.WebContainerImpl.start(WebContainerImpl.java:668)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:1127)
    at com.ibm.ws.runtime.component.DeployedApplicationImpl.fireDeployedObjectStart(DeployedApplicationImpl.java:1319)
    at com.ibm.ws.runtime.component.DeployedModuleImpl.start(DeployedModuleImpl.java:610)
    at com.ibm.ws.runtime.component.DeployedApplicationImpl.start(DeployedApplicationImpl.java:944)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.startApplication(ApplicationMgrImpl.java:740)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:2051)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:385)
    at com.ibm.ws.runtime.component.CompositionUnitImpl.start(CompositionUnitImpl.java:123)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:328)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.access$300(CompositionUnitMgrImpl.java:113)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl$CUInitializer.run(CompositionUnitMgrImpl.java:895)
    at com.ibm.wsspi.runtime.component.WsComponentImpl$_AsynchInitializer.run(WsComponentImpl.java:349)
    at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1604)

[5/18/12 10:12:25:889 EDT] 00000009 extension     E com.ibm.wsspi.webcontainer.extension.WebExtensionProcessor createServletWrapper Error occured while preparing the servlet for initialization. 
                                 javax.servlet.ServletException: SRVE0207E: Uncaught initialization exception created by servlet
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.init(ServletWrapper.java:434)
    at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.init(ServletWrapperImpl.java:169)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.initialize(ServletWrapper.java:1809)
    at com.ibm.wsspi.webcontainer.extension.WebExtensionProcessor.createServletWrapper(WebExtensionProcessor.java:98)
    at com.ibm.ws.webcontainer.webapp.WebApp.getServletWrapper(WebApp.java:1038)
    at com.ibm.ws.webcontainer.webapp.WebApp.getServletWrapper(WebApp.java:959)
    at com.ibm.ws.webcontainer.webapp.WebApp.initializeTargetMappings(WebApp.java:638)
    at com.ibm.ws.webcontainer.webapp.WebApp.commonInitializationFinally(WebApp.java:436)
    at com.ibm.ws.webcontainer.webapp.WebAppImpl.initialize(WebAppImpl.java:304)
    at com.ibm.ws.webcontainer.webapp.WebGroupImpl.addWebApplication(WebGroupImpl.java:100)
    at com.ibm.ws.webcontainer.VirtualHostImpl.addWebApplication(VirtualHostImpl.java:166)
    at com.ibm.ws.webcontainer.WSWebContainer.addWebApp(WSWebContainer.java:731)
    at com.ibm.ws.webcontainer.WSWebContainer.addWebApplication(WSWebContainer.java:616)
    at com.ibm.ws.webcontainer.component.WebContainerImpl.install(WebContainerImpl.java:376)
    at com.ibm.ws.webcontainer.component.WebContainerImpl.start(WebContainerImpl.java:668)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:1127)
    at com.ibm.ws.runtime.component.DeployedApplicationImpl.fireDeployedObjectStart(DeployedApplicationImpl.java:1319)
    at com.ibm.ws.runtime.component.DeployedModuleImpl.start(DeployedModuleImpl.java:610)
    at com.ibm.ws.runtime.component.DeployedApplicationImpl.start(DeployedApplicationImpl.java:944)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.startApplication(ApplicationMgrImpl.java:740)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:2051)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:385)
    at com.ibm.ws.runtime.component.CompositionUnitImpl.start(CompositionUnitImpl.java:123)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:328)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.access$300(CompositionUnitMgrImpl.java:113)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl$CUInitializer.run(CompositionUnitMgrImpl.java:895)
    at com.ibm.wsspi.runtime.component.WsComponentImpl$_AsynchInitializer.run(WsComponentImpl.java:349)
    at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1604)
Caused by: java.lang.IllegalStateException: Application was not properly initialized at startup, could not find Factory: javax.faces.context.FacesContextFactory
    at javax.faces.FactoryFinder.getFactory(FactoryFinder.java:270)
    at javax.faces.webapp.FacesServlet.init(FacesServlet.java:164)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.init(ServletWrapper.java:358)
    ... 27 more 
```

# java - 如何使用 Java.sql.Connection.setNetworkTimeout？

> ID：10654547
> 
> 赞同：7
> 
> 时间：2012-05-18T14:30:53.683
> 
> 标签：java, sql, networking, timeout

我遇到了 setNetworkTimeout 应该根据[Oracle](http://goo.gl/K5t30)解决的确切问题。一个查询在 socket.read() 中停留了几分钟。

但我不知道这个方法的第一个参数需要是什么。提交 null 会导致 AbstractMethodError 异常，所以......实现是否真的需要某种线程池来设置网络超时？

是否有某种方法可以在不为这种情况运行线程池的情况下达到相同的效果？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T15:43:22.997

似乎文档对此进行了可怕的解释，但是没有查看类背后的任何代码，我的猜测是您应该将 Executor 实例传递给该方法，以便实现可以产生作业/线程以检查状态连接。

由于连接读取会阻塞，为了实现任何类型的超时逻辑，除了读取线程之外，还需要另一个线程来检查连接的状态。

这听起来像是一个设计决定，而不是 JDBC 驱动程序在内部实现逻辑，如何/何时产生线程来处理这个，API 希望您作为客户端传递一个 Executor，该 Executor 将用于检查超时。这样，您作为客户端可以控制检查执行的频率，防止它在您的容器中产生比您喜欢的更多的线程等。

如果您周围还没有 Executor 实例，则可以创建一个默认实例：

```
conn.setNetworkTimeout(Executors.newFixedThreadPool(numThreads), yourTimeout); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-22T13:19:08.050

就 Postgres JDBC 驱动程序（postgresql-42.2.2.jar）而言，setNetworkTimeout 实现不使用 Executor 参数。它只是使用 Socket.setSoTimeout 方法将指定的超时设置为底层套接字的超时。

看起来 java.sql.Connection 接口试图不对实现做出任何假设，并提供了一个执行器，如果实现需要它可以使用它。

# c# - Visual Studio 2010 异常检查扩展

> ID：10654554
> 
> 赞同：0
> 
> 时间：2012-05-18T14:31:19.180
> 
> 标签：c#, visual-studio-2010, visual-studio-extensions

我正在寻找某种方法来使 VS 编辑器突出显示引发异常的方法。我四处寻找一些插件，但没有找到合适的插件。

所以我一直在寻找一些描述如何制作我自己的插件的教程。我发现许多教程展示了如何为文本添加下划线、修改工具提示等，但我还没有找到任何教程来展示如何访问特定方法的文档。

我会很高兴得到任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:38:12.900

您可以使用 IntelliSense 提供的信息：

![在此处输入图像描述](../Images/cfdc4fcddc3d343100ff4d1dfe7ed907.png)

您可以通过对您的方法的 xml 注释向 IntelliSence 提供例外列表：

```
/// <summary>
/// Foos every bar.
/// </summary>
/// <exception cref="System.ArgumentOutOfRangeException"/>
public static void Foo()
{
    throw new ArgumentOutOfRangeException();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:40:50.420

您可以使用 VS 调试器来跟踪代码或使用断点来运行将突出显示行的宏（不确定这是否会正常运行，因为您必须在某些关键点应用它们）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:52:20.007

您还可以设置 VS (Ctrl-Shift-E) 的异常设置以在抛出异常时立即停止。这将停止执行导致异常的方法并将光标放在它上面。

# performance - Hibernate 搜索自动索引

> ID：10654560
> 
> 赞同：0
> 
> 时间：2012-05-18T14:32:21.717
> 
> 标签：performance, search, indexing, hibernate-search

我正在开发一个每天可以满足大约 100,000 次搜索的应用程序。我们可以安全地假设每天数据库中的更新/插入/删除数量大致相同。当前应用程序使用原生 SQL，我们打算将其迁移到 Hibernate 并使用 Hibernate Search。

由于数据库记录不断变化，我们需要启用自动索引。管理层担心自动索引可能导致的性能影响。

不可能有计划的批量索引，因为记录中的更改必须在更改后立即可供搜索。

我已经搜索过某种性能统计信息，但没有找到。

任何已经在 Hibernate Search 工作并面临类似情况的人都可以分享他们的想法吗？

谢谢您的帮助。

问候，

沙杜尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T22:00:50.540

它可能工作正常，但没有基线很难猜测。我每天进行更多搜索的经验，并且经过一些微调后效果很好，但是如果不尝试就不可能知道这是否适用于您的场景。如果正常调优失败并且 NRT 不能足够快地证明，您总是可以对索引进行分片，使用多主配置并插入分布式二级缓存，例如 Infinispan：所有组合架构都可以实现线性可扩展性，前提是您有设置它的时间和合理的硬件。

很难说您需要什么样的硬件，但可以肯定的是，它会比原生 SQL 解决方案更高效。我建议做一个 POC，看看你在单个节点上能走多远；如果您的查询类型非常适合 Lucene，您可能只需要一台服务器。请注意，Lucene 在查询中比在更新中快得多，因此，由于您估计您将拥有相同数量的写入和搜索，因此问题不太可能在于每秒搜索量，而是每秒写入（更新）和总数据（索引）大小。最新的 Hibernate Search 引入了 NRT 索引管理器，它非常适合此类用例。

# tabs - 使用标签栏应用程序与基于视图的应用程序引用网点

> ID：10654566
> 
> 赞同：1
> 
> 时间：2012-05-18T14:32:41.100
> 
> 标签：tabs, interface-builder, label, uilabel

**好的，所以我可以通过将蓝色参考线拖动到“文件所有者”并选择我仅在使用基于视图的应用程序**时在代码中引用的标签，成功地将 Interface Builder 中的 UILabel 链接到我的代码中编写的内容。

**但是，在基于选项卡的应用程序**中使用完全相同的代码和完全相同的过程（因此将界面构建器中的蓝线拖到 FirstView.xib 中的“文件所有者”）是在将 UILabel 连接到“文件的所有者”时显示的唯一选项Owner”是“View”，而不是我在代码中编写的其他选项，例如“titleLabel 或 albumLabel”。

请告诉我我做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:44:51.023

尝试控制拖动（按住 ctrl 键的同时拖动）到 FirstView.h（或等效文件）中的实际变量定义。

我的经验是迁移到 Xcode 4，而故事板是一个更简洁的解决方案。在故事板中连接插座/视图转换比旧的界面构建器要干净得多。

# visual-studio - 在 Visual Studio 2003 中指定 PDB 路径

> ID：10654570
> 
> 赞同：7
> 
> 时间：2012-05-18T14:32:49.513
> 
> 标签：visual-studio, linker, pdb

在 Visual Studio 2003 中，如果我链接的库没有相应的 PDB 文件，我会收到警告：

> foo.lib(bar.obj)：警告 LNK4099：找不到 PDB 'other.pdb'；链接对象好像没有调试信息

如果 PDB 位于其原始构建位置，VS 可以找到它们，以及它们是否位于当前构建目录中，但似乎就是这样。有没有办法可以告诉 Visual Studio 它应该在哪里寻找 PDB？我有一个模糊的概念，即符号服务器可能会工作，但这似乎是很多开销；我只是在寻找类似`link.exe /pdbpath c:\pdbs_are_right_here`添加搜索路径的东西，比如`/I`添加包含路径。或者，除了当前目录和 PDB 写入的原始绝对路径之外，它还搜索其他路径吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-30T19:10:08.487

我相信相应 pdb 的路径嵌入在库本身中，您可以在库的构建开关处将其更改为 c:\pdbs_are_right_here（假设它们确实是您的，而不是第 3 方）。

对于 DLL，这意味着项目属性\链接器\调试\生成程序数据库文件。

对于*静态*库，默认名称在 VS2013 中是统一的（'vc120.pdb'），但我认为这在 VS2015 中发生了变化，并且不知道 VS2003。无论如何，如果您在 VS2013\2012\2010 中工作，您也必须明确覆盖该名称。

# c# - 使用 mkbundle(mono) 编译简单 Winforms 应用程序时出现异常

> ID：10654571
> 
> 赞同：1
> 
> 时间：2012-05-18T14:32:51.540
> 
> 标签：c#, .net, winforms, mono, mkbundle

我试过使用`mkbundle --deps f.exe -o d.exe` 但是抛出异常

我收到以下错误

```
embedding: I:\f.exe
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\System.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\mscorlib.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\Mono.Security.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\System.Configuration.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\System.Xml.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\System.Security.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\System.Windows.Forms.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\System.Drawing.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\Accessibility.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\Mono.WebBrowser.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\Mono.Posix.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\System.Data.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\Mono.Data.Tds.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\System.Transactions.dll
   embedding: C:\PROGRA~2\MONO-2~1.8\lib\mono\4.0\System.EnterpriseServices.dll
Compiling:
as -o temp.o temp.s

Unhandled Exception: System.ComponentModel.Win32Exception: ApplicationName='sh',
 CommandLine='-c "as -o temp.o temp.s "', CurrentDirectory=''
  at System.Diagnostics.Process.Start_noshell (System.Diagnostics.ProcessStartIn
fo startInfo, System.Diagnostics.Process process) [0x00000] in <filename unknown
>:0
  at System.Diagnostics.Process.Start_common (System.Diagnostics.ProcessStartInf
o startInfo, System.Diagnostics.Process process) [0x00000] in <filename unknown>
:0
  at System.Diagnostics.Process.Start (System.Diagnostics.ProcessStartInfo start
Info) [0x00000] in <filename unknown>:0
  at MakeBundle.Execute (System.String cmdLine) [0x00000] in <filename unknown>:
0
  at MakeBundle.GenerateBundles (System.Collections.ArrayList files) [0x00000] i
n <filename unknown>:0
  at MakeBundle.Main (System.String[] args) [0x00000] in <filename unknown>:0
[ERROR] FATAL UNHANDLED EXCEPTION: System.ComponentModel.Win32Exception: Applica
tionName='sh', CommandLine='-c "as -o temp.o temp.s "', CurrentDirectory=''
  at System.Diagnostics.Process.Start_noshell (System.Diagnostics.ProcessStartIn
fo startInfo, System.Diagnostics.Process process) [0x00000] in <filename unknown
>:0
  at System.Diagnostics.Process.Start_common (System.Diagnostics.ProcessStartInf
o startInfo, System.Diagnostics.Process process) [0x00000] in <filename unknown>
:0
  at System.Diagnostics.Process.Start (System.Diagnostics.ProcessStartInfo start
Info) [0x00000] in <filename unknown>:0
  at MakeBundle.Execute (System.String cmdLine) [0x00000] in <filename unknown>:
0
  at MakeBundle.GenerateBundles (System.Collections.ArrayList files) [0x00000] i
n <filename unknown>:0
  at MakeBundle.Main (System.String[] args) [0x00000] in <filename unknown>:0 
```

有人能帮我吗。

```
EDIT: 
```

当我从 Cygwin 直接从 Windows 使用 mkbundle 时发生上述错误，我收到以下错误

```
'as' command not found 
```

从网上我了解到'as'是一个编译器，我在哪里可以得到它，请帮助我，我不是 Linux 爱好者

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:09:59.927

您需要使用来自类 Unix 工具链（例如 Cygwin）的 mkbundle。

您必须在 Cygwin中安装`gcc`,`gcc-mingw`和包。`as`

这是来自 mkbundle 的[手册页](http://linux.die.net/man/1/mkbundle)。

# sql - SQL 日期插入

> ID：10654575
> 
> 赞同：1
> 
> 时间：2012-05-18T14:33:13.330
> 
> 标签：sql, sql-server-2005

我已经运行了一个查询以获得我满意的某些结果，但我现在想插入一段代码，这将迫使用户手动输入结果的日期范围。

到目前为止我的代码是......

```
SELECT     vwREP_GP_ContractProjectPurchaseCostCatID.PACOSTCATID AS COST_CAT_CODE, 
           vwREP_GP_ContractProjectPurchaseCostCatID.PACOSTCATNME AS COST_CAT_NAME, 
           vwREP_GP_ContractProjectPurchaseRpt.COST, 
           vwREP_GP_ContractProjectPurchaseRpt.ITEMDESC AS ITEM, 
           vwREP_GP_ContractProjectPurchaseRpt.CREDITOR, 
           vwREP_GP_ContractProjectPurchaseRpt.DOC_NUM AS DOCUMENT_NUMBER, 
           vwREP_GP_ContractProjectPurchaseRpt.DESCRIPTION, 
           vwREP_GP_ContractProjectPurchaseRpt.DOC_DATE AS DATE,  
           vwREP_GP_ContractProjectPurchaseRpt.PROJECT AS JOB_CODE_STAGE, 
           vwREP_GP_ContractProjectPurchaseRpt.COMPOUNDNAME AS CATEGORY_DESCRIPTION

FROM         vwREP_GP_ContractProjectPurchaseCostCatID INNER JOIN
                      vwREP_GP_ContractProjectPurchaseRpt ON vwREP_GP_ContractProjectPurchaseCostCatID.PACOSTCATID = vwREP_GP_ContractProjectPurchaseRpt.PACOSTCATID

SELECT  CATEGORY_DESCRIPTION, CAST(SUM(COST) AS DECIMAL(12, 2)) AS TOTAL_COST 

FROM    (   
        SELECT COMPOUNDNAME AS CATEGORY_DESCRIPTION, COST  
        FROM   vwREP_GP_ContractProjectPurchaseRpt  
        ) A 
GROUP BY  
        CATEGORY_DESCRIPTION 
```

我正在考虑插入一串代码，例如......

```
SELECT * FROM vwREP_GP_ContractProjectPurchaseRpt
WHERE (DOC_DATE >= @DateFrom) 
AND (DOC_DATE  <= @DateTo) 
```

但我被困在如何让它发挥作用上。

任何建议将不胜感激。

所有工作都在 SQL Server Management Studio 2005 上完成，最终将部署在 MS Visual Studio 上。

抱歉，我在粘贴代码时错过了这个。我这样声明我的变量...

```
DECLARE @DateFrom datetime 
DECLARE @DateTo datetime 
```

那么下面......

```
SELECT * FROM vwREP_GP_ContractProjectPurchaseRpt 
WHERE (DOC_DATE >= @DateFrom)  
AND (DOC_DATE  <= @DateTo) 
```

它所做的只是返回一个空白的结果窗格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T15:03:24.917

由于您没有提供有关您的问题的大量详细信息，因此我将尝试对其进行尝试。

如果您想将某种参数（日期）传递给您的查询，那么您将需要使用存储过程。与此类似的东西：

```
CREATE PROCEDURE [dbo].[sp_test]
(
    @DateFrom   datetime,
    @DateTo     datetime
)
AS

SELECT * 
FROM vwREP_GP_ContractProjectPurchaseRpt
WHERE DOC_DATE >= @DateFrom 
    AND DOC_DATE < DATEADD(DAY, 1, @DateTo) 
```

这将允许您将 DateTo 和 DateFrom 传递给查询。然后，如果您想在发布的第二个查询中使用 WHERE 子句，您将执行以下操作：

```
CREATE PROCEDURE [dbo].[sp_test]
(
    @DateFrom   datetime,
    @DateTo     datetime
)
AS

SELECT  CATEGORY_DESCRIPTION, CAST(SUM(COST) AS DECIMAL(12, 2)) AS TOTAL_COST 
FROM   
(   
    SELECT COMPOUNDNAME AS CATEGORY_DESCRIPTION, COST  
    FROM   vwREP_GP_ContractProjectPurchaseRpt  
    WHERE DOC_DATE >= @DateFrom 
        AND DOC_DATE < DATEADD(DAY, 1, @DateTo)
) A 
GROUP BY CATEGORY_DESCRIPTION 
```

然后，当您去查询结果时，您将执行以下操作：

```
exec dbo.test '5/1/12', '5/30/12' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T15:03:01.710

声明后，变量初始化为`NULL`.

这个条件：

```
WHERE (DOC_DATE >= @DateFrom)  
AND (DOC_DATE  <= @DateTo) 
```

变量设置为 的任何记录都不会保留`NULL`。

为您的变量分配一些值。

# xcode4.2 - 当我点击单元格时如何自动将单元格滚动到可见位置

> ID：10654579
> 
> 赞同：0
> 
> 时间：2012-05-18T14:33:24.223
> 
> 标签：xcode4.2

我有表格视图，其中包含一个自定义的表格视图单元格。该单元格包含 UILabel 和 UIView。最初 UIview 是隐藏的。在点击该单元格后，我只使其可见。为了使自动滚动，我使用 ScrollRecttoVisible 函数。但它不适用于最后几个单元格。有人可以帮我吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:35:43.733

我个人使用atScrollPosition 参数`– scrollToRowAtIndexPath:atScrollPosition:animated:`滚动到给定位置的单元格。`UITableViewScrollPositionMiddle`

# javascript - JS/jQuery 事件在 addEventListener 之后不会触发

> ID：10654580
> 
> 赞同：0
> 
> 时间：2012-05-18T14:33:29.313
> 
> 标签：javascript, jquery, addeventlistener

我正在使用一个脚本，该脚本通过使用 createElement 和 appendChild 添加带有 JS 和 jQuery 的对象来创建这样的 HTML 结构：

```
<div id="divLayer">
    <div id="divBox">
        <!-- stuff -->
        <div id="btnSave" class="button small">Save</div>
    </div>
</div> 
```

元素位置分别为*absolute*、*absolute*和*relative*，显示为*block*、*block*和*inline-block*。我已经定义了一个包含对象属性的数组，如下所示：

```
var objects = {
    divLayer: {
        tag: 'DIV',
        id: 'divLayer',
        parent: 'body'
    },

    divBox: {
        tag: 'DIV',
        id: 'divBox',
        parent: '#divLayer'
    },

    btnSave: {
        tag: 'DIV',
        HTML: 'Save',
        id: 'btnSave',
        parent: '#divBox',
        events: {
            click: function () {
                alert ( 'Clicked' );
            }
        }
    }
} 
```

这是我创建对象并向它们添加侦听器的部分：

```
for ( var config in objects ) {
    var object = document.createElement ( config.tag );

    ...Setup other attributes...

    for ( var event in config.events ) object.addEventListener ( event, config.events [ event ]  );

    $ ( config.parent ).get ( 0 ).appendChild ( object );
} 
```

从图形上看，一切都是正确的。我可以在背景上看到 divLayer，在其上看到 divBox，在框内看到 btnSave，并且每个属性都已正确编译，但是当我单击按钮时，什么也没有发生。如果我将按钮直接放在 divLayer 上，它就可以工作。

我在哪里做错了？

提前谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:00:01.297

除了使用 Array 更安全的 Object 之外，您还试图访问 上的属性`config`，但`config`它只是表示属性名称的字符串。

您需要使用`config`来获取价值。

```
for (var config in objects) {

    var obj = objects[config]; // get the object

    var object = document.createElement(obj.tag);

    object.id = obj.id;  // set the ID

    for (var event in obj.events)
        object.addEventListener(event, obj.events[event]);

    $(obj.parent).get(0).appendChild(object);
} 
```

此外，您遗漏了一些代码，因此我无法判断其他属性是否设置正确。我添加了 ID，现在您的代码可以工作了。

***演示：http:*** [//jsfiddle.net/yBN6V/](http://jsfiddle.net/yBN6V/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:38:37.500

尝试使用 jQuery 本身进行绑定，将事件委托给静态父级：

```
for (var event in config.events) 
    $(document).on(event, object, config.events[event]); 
```

在该示例中，我已将事件绑定到`document`，您应该真正使用页面加载时可用的最接近的非动态元素。

# bash - 处理从通过管道传输到 netcat 的脚本的输入

> ID：10654586
> 
> 赞同：3
> 
> 时间：2012-05-18T14:33:45.070
> 
> 标签：bash, sockets, fifo, netcat

我有一个系统可以处理传入的电子邮件，以将它们发送到我工作的黑匣子应用程序。高级脚本由 inittab 维护以始终运行并运行子脚本以使用此命令执行实际工作：

```
$SCRIPT | nc -l -p $PORT 
```

脚本本身从命名管道读取，在调用之前对数据进行一些解析和处理，`echo`通过 netcat 将数据重新洗牌到 $PORT 上连接的进程。

我需要一些方法来处理来自管道远端的传入数据。当我在应用程序中发出关闭连接的请求时，它会发回一个字符串（我可以将其定义为我想要的任何内容）并等待我的脚本关闭管道。我目前正在努力了解如何添加从另一端读取传入数据的功能；验证它是关闭管道的命令，然后退出脚本。

我的脚本（简而言之）如下所示：

```
while true ; do
  email_input="`cat "$pipe"`"
  if [[ $email_input =~ .*escape_queue.* ]] ; then
    break;
  fi
  echo "`parse`"
done 
```

我对不得不改变程序流程的可能性持开放态度，我只是无法理解如何能够异步读取传入的数据，因为脚本会一直阻塞，`cat $pipe`直到收到要处理的新电子邮件。

如果不清楚，我在 bash 脚本方面处于新手级别，并且总是乐于接受改进建议。

**更新** 我已将脚本调用更改为

```
$SCRIPT | nc -l -p $PORT > $nc_data 
```

并在脚本本身内

```
netcat_response="`cat "$nc_data"`";
if [[ "$netcat_response" =~ "exit" ]] ; then
  cat /dev/null > $nc_data
  break;
fi 
```

此时，一旦有新消息通过管道传输到 fifo，脚本就会终止。这意味着我将始终丢失 1 条消息，因为它被脚本读取然后脚本终止。脚本仍然会阻塞，`cat`直到读取某些内容。在最坏的情况下，这将不得不这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T17:34:38.340

您可以在标准输入的 EOF 一段时间后让 nc 退出。

```
$SCRIPT | nc -l -q 5 -p $PORT > $nc_data 
```

`-q`是在一定秒数后退出的选项。

# java - Java JMenuBar : 垂直 JSeparator

> ID：10654587
> 
> 赞同：3
> 
> 时间：2012-05-18T14:33:54.220
> 
> 标签：java, swing, jmenubar, jtoolbar, jseparator

我正在尝试在我的菜单中添加一个垂直的 JSeparator。但它在我的 MenuItems 之间设置了边距。我希望我的物品保持在左边而不是左 - 中 - 右。

它的外观： ![在此处输入图像描述](../Images/aed7f1b32c05a734b76eb22def3ee335.png) 我想要的： ![在此处输入图像描述](../Images/c12ed330a38f631a69c0500b38e2181b.png)

```
 JMenu settings = new JMenu("Settings");
    image = ImageIO.read(new File(Constants.IMAGES_DIR + File.separator + "settings.png"));
    settings.setHorizontalTextPosition(SwingConstants.CENTER);
    settings.setVerticalTextPosition(SwingConstants.BOTTOM);
    settings.setIcon(new ImageIcon(image));
    add(settings);

    JMenu build = new JMenu("Builder");
    image = ImageIO.read(new File(Constants.IMAGES_DIR + File.separator + "build.png"));
    build.setHorizontalTextPosition(SwingConstants.CENTER);
    build.setVerticalTextPosition(SwingConstants.BOTTOM);
    build.setIcon(new ImageIcon(image));
    add(build);

    add(new JSeparator(JSeparator.VERTICAL));

    JMenu help = new JMenu("Help");
    image = ImageIO.read(new File(Constants.IMAGES_DIR + File.separator + "help.png"));
    help.setHorizontalTextPosition(SwingConstants.CENTER);
    help.setVerticalTextPosition(SwingConstants.BOTTOM);
    help.setIcon(new ImageIcon(image));
    add(help); 
```

希望你明白我想要什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T15:01:34.683

我建议通过使用 JToolBar 而不是 JMenuBar 来做到这一点。但是如果你必须/应该/喜欢使用 JMenuBar 来做这件事，这里有一个例子：

```
public class Test {
    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                JFrame frame = new JFrame();

                JMenuBar bar = new JMenuBar();
                bar.setLayout(new MigLayout());

                JMenu listSth = new JMenu("A");
                listSth.setHorizontalTextPosition(SwingConstants.CENTER);
                listSth.setVerticalTextPosition(SwingConstants.BOTTOM);
                bar.add(listSth);

                JSeparator sep1 = new JSeparator(JSeparator.VERTICAL);
                bar.add(sep1, "growy");
                JMenu module = new JMenu("B");
                module.setHorizontalTextPosition(SwingConstants.CENTER);
                module.setVerticalTextPosition(SwingConstants.BOTTOM);
                bar.add(module);

                JMenu settings = new JMenu("Settings");
                settings.setHorizontalTextPosition(SwingConstants.CENTER);
                settings.setVerticalTextPosition(SwingConstants.BOTTOM);
                bar.add(settings);

                JMenu build = new JMenu("Builder");
                build.setHorizontalTextPosition(SwingConstants.CENTER);
                build.setVerticalTextPosition(SwingConstants.BOTTOM);
                bar.add(build);

                JSeparator sep2 = new JSeparator(JSeparator.VERTICAL);
                bar.add(sep2, "growy");

                JMenu help = new JMenu("Help");
                help.setHorizontalTextPosition(SwingConstants.CENTER);
                help.setVerticalTextPosition(SwingConstants.BOTTOM);
                bar.add(help);

                frame.setJMenuBar(bar);
                frame.pack();
                frame.setSize(400, 300);
                frame.setLocationRelativeTo(null);

                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setVisible(true);
            }
        });
    }
} 
```

简而言之 - 您可以使用 MigLayout 并在您的 JSeparators 上设置“growy”。对此还有许多其他解决方案（使用不同的布局）。

# javascript - jquery 设置隐藏输入值在 IE7 和 IE8 中无法按预期工作

> ID：10654595
> 
> 赞同：9
> 
> 时间：2012-05-18T14:34:21.200
> 
> 标签：javascript, jquery, internet-explorer, html-input

继续采用我的代码与 IE 一起工作...

我有一个隐藏`div`的包含一个表单来编辑一些信息。当用户选择要编辑的项目时，会显示此 div，并使用项目的信息填充字段。divs（简而言之）看起来像这样：

```
<div id="editform">
<form action="" method="post" id="qform" name="qform">
    First param: <input name="field1" id="field1"/> <br/>
    Second param: <input name="field2" id="field2"/> <br/>
    ...

    <input type="hidden" name="qid" id="qid" value=""/>

    <img id="submit" src="..." alt="..." title="..." />
</form> 
```

我使用 jquery 将值设置到字段中。我打开编辑 div 的功能如下所示：

```
function edit_item(item_id) {
    item = get_item(item_id);    //this will return a JS object
    $('#field1').val(item.property1);
    $('#field2').val(item.property2);
    ...
    $('#qid').val(item_id);
    $('#submit').click(function() {
        alert($('#qid').val());
        $('#qform').ajaxSubmit();
    });
} 
```

所有这些在 FF、Opera、Webkit 和 IE 9 中都可以正常工作，但是在 IE7 和 IE8 中，我遇到了一个奇怪的问题。我可以看到函数`item_id`中的设置正确`edit_item`，但是一旦该函数完成，隐藏的输入值 ( `qid`) 就会重置为空字符串。当表单被 ajax 提交时，尽管设置正确，但警报显示该值是一个空字符串。有趣的是，所有其他领域都很好。它在 IE 9 中可以正常工作。

我在这里想念什么？提前谢谢了。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-18T09:11:23.017

这完全是愚蠢的，但是不应该是这样：

```
$('#field1').val(item.property1); 
```

不工作。然而

```
$('#field1').attr("value", item.property1); 
```

工作正常。我把它留在那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-28T12:32:11.667

在纯 JavaScript 中没有 JQuery 的 IE 的解决方案看起来并不太复杂：

```
document.getElementById(id).setAttribute('value', value); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-05T22:35:11.877

除了 Aleks G 的回答之外，我发现**不能**`value`在隐藏元素中隐式定义属性，以便 jQuery和在 IE8 中正常工作。**`.setAttr()``.val()`**

 **有关更多详细信息，请参见此处： [jQuery .val() setter not working？](http://www.codem0nk3y.com/2011/03/jquery-val-setter-not-working/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-13T14:07:09.217

我知道我迟到了，但我使用了以下解决方法，因为在尝试了所有解决方案后它对我不起作用

```
var id=$(this).data('id');
$('#update_entery_div').append(
                "<input type='hidden' name='id' value="+id+" >"
            ); 
```**

# silverlight - 在 Silverlight + Xaml 中制作向导

> ID：10654599
> 
> 赞同：1
> 
> 时间：2012-05-18T14:34:49.670
> 
> 标签：silverlight, xaml, silverlight-4.0

我有一个 Silverlight 应用程序，我试图在 XAML 文件中制作向导的每一步，而不是硬编码的 C#。

问题是我不明白在单击每个屏幕的下一步按钮后我将如何在它们之间切换。

做这个的最好方式是什么？我在互联网上看到了一些关于动态加载 XAML 的教程，但它们似乎都不适用于我：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:46:08.257

使用 ChildWindow 作为父窗口。然后创建多个用户控件，它们将被框在父窗口的内容中。在父窗口的代码隐藏中，将用户控件加载到列表中，并将除第一个之外的所有控件的可见性设置为“已折叠”。当用户按下 Next/Prev 按钮时，从列表中拉出适当的 UserControl（跟踪当前索引）并使其“可见”，同时使当前控件“折叠”。

您的所有导航代码都将在父窗口中，但父窗口不会关心向导步骤本身的内容。

每个 UserControl 都可以在 XAML 中编码为单独的控件，因此您仍然可以将控件与向导导航逻辑分开。

然后，您可以创建一个类类型，该类类型将包含各种向导控件的所有选项。将对对象实例的引用传递给每个控件以供它们更新。当您到达向导结束时，您的选项对象应该保持所有向导步骤的状态，并且父窗口可以将其返回给应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T16:17:24.223

我建议研究[Silverlight Navigation Framework](http://msdn.microsoft.com/en-us/library/cc838245%28v=VS.95%29.aspx)。它允许您使用“url”在“页面”（这是您的 XAML 用户控件）之间导航。它还允许用户使用浏览器中的来回按钮，这可能是您想要允许的，也可能不是。

当您选择新项目、Silverlight、“Silverlight 导航应用程序”时，有一个 VS 2010 模板可以帮助您入门。

# forms - Symfony - 如何添加嵌入表单？

> ID：10654604
> 
> 赞同：0
> 
> 时间：2012-05-18T14:35:03.907
> 
> 标签：forms, symfony1, embed, symfony-1.4

我正在尝试创建一个表单 Houses 并将图像表单嵌入其中。我已经按照教程[http://www.symfony-project.org/more-with-symfony/1_4/en/06-Advanced-Forms](http://www.symfony-project.org/more-with-symfony/1_4/en/06-Advanced-Forms)。

我有以下架构：

```
houses:
  actAs: { Timestampable: ~ }
  columns:
    name: { type: string(255), notnull: true }
    description: { type: string(5000), notnull: true }

images:
  actAs: { Timestampable: ~ }
  columns:
    url: { type: string(255), notnull: true }
    id_house: { type: integer, notnull: true }
    relations:
    houses: { local: id_house, foreign: id, foreignAlias: HousesImg} 
```

和代码：

```
//lib/form/doctrine/ImagesCollectionForm

class ImagesCollectionForm extends sfForm
{
  public function configure()
  {
    if(!$house= $this->getOption('house'))
    {
      throw new InvalidArgumentException('You must provide an house');
    }

    for ($i = 0; $i < $this->getOption('size',2); $i++)
    {
      $images = new images();
      $images->house = $house;

      $form = new imagesForm($images);
      $this->embedForm($i, $form);
    }
  }
}

//lib/form/doctrine/housesForm.class.php

public function configure()
{
  $form = new ImagesCollectionForm(null, array('house' => $this->getObject(),'size'=>2));
  $this->embedForm('images', $form);
} 
```

字段按预期显示。但是，当我按下保存按钮时，我得到一个空白页，并且数据没有保存在数据库中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T20:54:20.397

使用没有在与产品的图像关系中指定别名，因此默认情况下 symfony 查找关系名称

所以你需要改变 $images->house = $house; 到 $images->houses = $house; 或者你可以设置相关的别名

希望这会有所帮助。

# c# - 使用 RegEx 匹配任意长度和字符的子字符串

> ID：10654605
> 
> 赞同：0
> 
> 时间：2012-05-18T14:35:03.883
> 
> 标签：c#, .net, regex, substring

我希望能够使用 c# 中的正则表达式匹配并提取以下字符串中的所有子字符串：

```
"2012-05-15 00:49:02 192.168.100.10 POST /Microsoft-Server-ActiveSync/default.eas User=nikced&DeviceId=ApplDNWGRKZQDTC0&DeviceType=iPhone&Cmd=Ping&Log=V121_Sst8_LdapC0_LdapL0_RpcC31_RpcL50_Hb3540_Erq1_Pk1728465481_S2_ 443 redcloud\nikced 94.234.170.42 Apple-iPhone4C1/902.179 200 0 64 3140491" 
```

由于它是一个日志文件，因此正则表达式应该能够处理任何类似类型的行。

在这种情况下，集合的首选输出应该是：

```
2012-05-15
00:49:02
192.168.100.10
/Microsoft-Server-ActiveSync/default.eas
User=nikced&DeviceId=ApplDNWGRKZQDTC0&DeviceType=iPhone&Cmd=Ping&Log=V121_Sst8_LdapC0_LdapL0_RpcC31_RpcL50_Hb3540_Erq1_Pk1728465481_S2_
443
redcloud\nikced
94.234.170.42
Apple-iPhone4C1/902.179
200
0
64
3140491 
```

感谢使用 C#、.net 和正则表达式将上述子字符串提取到集合中的任何答案（首选 MatchCollection）。所有日志行都遵循相同的格式和模式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T14:38:43.493

令人难以置信的复杂正则表达式传入：

```
logFile.Split(' '); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:45:37.497

您不需要使用正则表达式。您可以简单地使用[String.Split 方法](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)，并指定空格作为分隔符：

```
 string [] substrings = line.Split(new Char [] {' '}); 
```

如果您需要识别每个部分的种类，那么您应该指定您需要查找的内容，并且可以为其创建一个正则表达式。

无论如何，如果您真的想使用正则表达式，请执行以下操作：

```
 Regex re = new Regex (@"(?:(?<s>[^ ]+)(?: |$))*"); 
```

当您调用 Match 方法时，这将为您提供“s”组中的所有捕获。

正如 OP 在评论中指出的那样，分隔符可以是来自单个空间的任何东西，那么可能的分隔符应该包含在表达式的`(?: |$)`and`[^ ]`部分中。即，如果空格和制表符是可能的分隔符，则将该部分替换为`(?: |\t|$)`and `[^ \t]`。如果您需要接受多个这些字符作为分隔符，`+`请在组后添加一个`()`：

```
 (?:(?<s>[^ \t]+)(?: |\t|$)+)* 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T14:40:35.520

这将为您提供一个数组，您可以遍历该数组以检索由空格分隔的所有“行”

```
string[] lines = log.Split(' '); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T15:12:57.923

真的，你只需要把它分解成几个部分。

首先，日期。它会一直是 YYYY-MM-DD 格式吗？有没有可能根据地区/文化设置而有所不同？

```
(?<LogDate>dddd-dd-dd) 
```

接下来，你有时间。一样：

```
(?<LogTime>dd:dd:dd) 
```

接下来，我假设这是实际调用的 Web 方法？不完全确定，因为您还没有真正解释数据的布局方式。但是，我假设它要么是 POST 要么是 GET，所以这就是我们接下来要做的......

```
(?<LogMethod>POST|GET) 
```

只需对您感兴趣的日志行的每个部分执行此操作，您就会被设置。IE：

```
(?<LogDate>dddd-dd-dd) (?<LogTime>dd:dd:dd) (?<LogMethod>POST|GET)... 
```

如果要锚定到行的开头/结尾，请务必分别使用 ^ 和 $。当您获取匹配项时，您可以通过使用命名组（例如`match.Groups["LogMethod"].Value`）索引 Groups 属性来获取每个组的值。祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T15:08:01.387

最快和最明显的方法是使用`String.Split`：

```
string[] substrings = result = line->Split( nullptr, StringSplitOptions::RemoveEmptyEntries ); 
```

但是如果你坚持 a`MatchCollection`那么这会做你想做的

```
MatchCollection ^ substrings = Regex.Matches(line, "\\S+") 
```

# c++ - 如何创建定义固定值类型的策略模板

> ID：10654607
> 
> 赞同：1
> 
> 时间：2012-05-18T14:35:07.377
> 
> 标签：c++, compiler-errors, strategy-pattern

我有一个 Visual Studio 2008 C++03 应用程序，我在其中`FooTraits`向一个类提供策略`Foo`。

```
struct FooTraits
{
    enum { FooVal = 1 };
};

template< typename traits >
class Foo
{
public:
    typedef typename traits::FooVal foo_val; // errors on this line

    void FooDo( UINT matrix[ foo_val ] ) { /*...*/ };
};

typedef Foo< FooTraits > Foot;

int main( int argc, char* argv[] )
{
    Foot f;
    UINT matrix[ Foot::foo_val ] = { /*...*/ };
    f.FooDo( matrix );
    return 0;
} 
```

但是，我得到了一系列编译器错误`typedef`：

```
error C2146: syntax error : missing ';' before identifier 'foo_val'
error C2838: 'FooVal' : illegal qualified name in member declaration
error C4430: missing type specifier - int assumed. Note: C++ does not support default-int 
```

创建定义固定值的策略的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:36:48.223

`FooTraits::FooVal`不是类型。这是枚举的一个可能值。你不能 typedef 不是类型的东西。您需要`decltype(FooTraits::FooVal)`, 或 为枚举命名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:40:04.993

引入的枚举值`enum`本身不是类型。但它`enum`本身就是。因此，在：

```
enum Dummy { FooVal = 1 }; 
```

`Dummy`是类型，不是`FooVal`。您可以`typedef` `Dummy`，即：

```
struct FooTraits
{
    enum Dummy { FooVal = 1 };
};

/* ... */

template< typename traits >
class Foo
{
public:
    typedef typename traits::Dummy dummy;
  }; 
```

但你不能`typedef` `FooVal`，因为它不是一种类型。尝试`typedef` `FooVal`这样做就像尝试这样做：

```
int foo = 42;
typedef FooBar foo; 
```

......当然，这没有任何意义。

这是您的代码，已修复：

```
struct FooTraits
{
    enum { FooVal = 1 };
};

template< typename traits >
class Foo
{
public:
    void FooDo( unsigned matrix[ traits::FooVal] ) { matrix;/*...*/ };
};

typedef Foo< FooTraits > Foot;

int main(  )
{
    Foot f;
    unsigned matrix[ FooTraits::FooVal ] = { /*...*/ };
    f.FooDo( matrix );
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:38:56.803

你不能 typedef`traits::FooVal`因为它不是类型。

使用此语法：

```
static const int foo_val = traits::FooVal; 
```

# web-services - 使用纯 JAX-WS 添加 SOAP 标头对象

> ID：10654608
> 
> 赞同：21
> 
> 时间：2012-05-18T14:35:08.127
> 
> 标签：web-services, soap, jax-ws, paypal, webservice-client

我正在尝试使用**JAX WS为***PayPal Express Checkout API*实现简单的 Web 服务客户端。*PayPal Express Checkout API*提供**WSDL**文件，我可以使用*CXF 的 wsdl2java*实用程序从中生成 Java 类。

 ******由于身份验证的原因，它需要在每个请求中添加**SOAP Header 。**此标头非常简单，应如下所示： [https ://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECSOAPAPIBasics#id09C3I0CF0O6](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECSOAPAPIBasics#id09C3I0CF0O6)

从**WSDL**类生成的包括**ebay.apis.eblbasecomponents.CustomSecurityHeaderType**类，它表示我需要添加到每个请求的标头。

所以问题是：考虑到以下条件，如何将手动创建的**CustomSecurityHeaderType类实例添加到 SOAP 请求的标头：**

1.  我不是很想使用**com.sun.***包中的类，正如这里的回答中提到的：[JAX-WS - 添加 SOAP 标头](https://stackoverflow.com/questions/2322953/jax-ws-adding-soap-headers)（主要是因为不同 JDK 之间可能存在可移植性问题）
2.  我不想手动将该对象编组到*嵌套的* **javax.xml.soap.SOAPElement**实例中，如此处的答案中所述： [如何使用 Java JAX-WS 添加 SOAP 标头](https://stackoverflow.com/questions/830691/how-do-i-add-a-soap-header-using-java-jax-ws)

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-19T15:09:17.600

因此，看起来我在结合来自*SO***的 JAX-WS**和**JAXB**相关答案时找到了可能的答案（如果有这些技术经验的人可以检查以下是否正确，我将不胜感激）：

 *对我来说显而易见的是添加 SOAP 消息处理程序并在其中更改**SOAPMessage**实例的标头：

```
import javax.xml.ws.Binding;
import javax.xml.ws.BindingProvider;
import javax.xml.ws.handler.Handler;
import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBElement;
import javax.xml.bind.Marshaller;
import javax.xml.soap.SOAPHeader;
import ebay.api.paypalapi.ObjectFactory; // class generated by wsdl2java

// following class is generated by wsdl2java utility Service class
final PayPalAPIInterfaceService payPalService = new PayPalAPIInterfaceService();
final PayPalAPIAAInterface expressCheckoutPort = payPalService.getPayPalAPIAA();
final Binding binding = ((BindingProvider) expressCheckoutPort).getBinding();
List<Handler> handlersList = new ArrayList<Handler>();

// now, adding instance of Handler to handlersList which should do our job:
// creating header instance
final CustomSecurityHeaderType headerObj = new CustomSecurityHeaderType();
final UserIdPasswordType credentials = new UserIdPasswordType();
credentials.setUsername("username");
credentials.setPassword("password");
credentials.setSignature("signature");
headerObj.setCredentials(credentials);

// bookmark #1 - please read explanation after code
final ObjectFactory objectFactory = new ObjectFactory();
// creating JAXBElement from headerObj
final JAXBElement<CustomSecurityHeaderType> requesterCredentials = objectFactory.createRequesterCredentials(headerObj);

handlersList.add(new SOAPHandler<SOAPMessageContext>() {
    @Override
    public boolean handleMessage(final SOAPMessageContext context) {        
        try {
            // checking whether handled message is outbound one as per Martin Strauss answer
            final Boolean outbound = (Boolean) context.get("javax.xml.ws.handler.message.outbound");
            if (outbound != null && outbound) {
                // obtaining marshaller which should marshal instance to xml
                final Marshaller marshaller = JAXBContext.newInstance(CustomSecurityHeaderType.class).createMarshaller();
                // adding header because otherwise it's null
                final SOAPHeader soapHeader = context.getMessage().getSOAPPart().getEnvelope().addHeader();
                // marshalling instance (appending) to SOAP header's xml node
                marshaller.marshal(requesterCredentials, soapHeader);
            }
        } catch (final Exception e) {
            throw new RuntimeException(e);
        }
        return true;
    }

    // ... default implementations of other methods go here

});

// as per Jean-Bernard Pellerin's comment setting handlerChain list here, after all handlers were added to list
binding.setHandlerChain(handlersList); 
```

*书签#1*的解释：不应该编组标头对象本身，而是编组表示该对象的**JAXBElement**，否则会出现异常。应该使用从**WSDL生成的****ObjectFactory**类之一来从原始对象创建所需的**JAXBElement实例。**（感谢@skaffman 的回答：[没有由 JAXB 生成的 @XmlRootElement](https://stackoverflow.com/questions/819720/no-xmlrootelement-generated-by-jaxb)）

 ****## 还应该参考`Martin Straus`扩展此答案的答案

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-19T22:06:00.230

这个解决方案效果很好，但有一个问题。处理入站消息时会生成此错误：

```
dic 19, 2012 7:00:55 PM com.sun.xml.messaging.saaj.soap.impl.EnvelopeImpl addHeader
SEVERE: SAAJ0120: no se puede agregar una cabecera si ya hay una
Exception in thread "main" javax.xml.ws.WebServiceException: java.lang.RuntimeException: com.sun.xml.messaging.saaj.SOAPExceptionImpl: Can't add a header when one is already present.
    at com.sun.xml.ws.handler.ClientSOAPHandlerTube.callHandlersOnResponse(ClientSOAPHandlerTube.java:167)
    at com.sun.xml.ws.handler.HandlerTube.processResponse(HandlerTube.java:174)
    at com.sun.xml.ws.api.pipe.Fiber.__doRun(Fiber.java:1074)
    at com.sun.xml.ws.api.pipe.Fiber._doRun(Fiber.java:979)
    at com.sun.xml.ws.api.pipe.Fiber.doRun(Fiber.java:950)
    at com.sun.xml.ws.api.pipe.Fiber.runSync(Fiber.java:825)
    at com.sun.xml.ws.client.Stub.process(Stub.java:443)
    at com.sun.xml.ws.client.sei.SEIStub.doProcess(SEIStub.java:174)
    at com.sun.xml.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:119)
    at com.sun.xml.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:102)
    at com.sun.xml.ws.client.sei.SEIStub.invoke(SEIStub.java:154)
    at $Proxy38.wsRdyCrearTicketDA(Unknown Source)
    at ar.com.fit.fides.remedy.api.ws.ServicioCreacionTickets.crearTicket(ServicioCreacionTickets.java:55)
    at ar.com.fit.fides.remedy.api.ws.ConectorRemedyWS.crearTicket(ConectorRemedyWS.java:43)
    at ar.com.fit.fides.remedy.api.ws.ConectorRemedyWS.main(ConectorRemedyWS.java:90)
Caused by: java.lang.RuntimeException: com.sun.xml.messaging.saaj.SOAPExceptionImpl: Can't add a header when one is already present.
    at ar.com.fit.fides.remedy.api.ws.AuthenticationHandler.handleMessage(AuthenticationHandler.java:50)
    at ar.com.fit.fides.remedy.api.ws.AuthenticationHandler.handleMessage(AuthenticationHandler.java:23)
    at com.sun.xml.ws.handler.HandlerProcessor.callHandleMessageReverse(HandlerProcessor.java:341)
    at com.sun.xml.ws.handler.HandlerProcessor.callHandlersResponse(HandlerProcessor.java:214)
    at com.sun.xml.ws.handler.ClientSOAPHandlerTube.callHandlersOnResponse(ClientSOAPHandlerTube.java:161)
    ... 14 more
Caused by: com.sun.xml.messaging.saaj.SOAPExceptionImpl: Can't add a header when one is already present.
    at com.sun.xml.messaging.saaj.soap.impl.EnvelopeImpl.addHeader(EnvelopeImpl.java:128)
    at com.sun.xml.messaging.saaj.soap.impl.EnvelopeImpl.addHeader(EnvelopeImpl.java:108)
    at ar.com.fit.fides.remedy.api.ws.AuthenticationHandler.handleMessage(AuthenticationHandler.java:45) 
```

所以，解决的办法是检查出站消息是否被处理，像这样：

```
public boolean handleMessage(SOAPMessageContext context) {
    try {
        Boolean outbound = (Boolean) context.get("javax.xml.ws.handler.message.outbound");
        if (outbound != null && outbound) {
            // obtaining marshaller which should marshal instance to xml
            final Marshaller marshaller = JAXBContext.newInstance(AuthenticationInfo.class).createMarshaller();
            // adding header because otherwise it's null
            final SOAPHeader soapHeader = context.getMessage().getSOAPPart().getEnvelope().addHeader();
            // marshalling instance (appending) to SOAP header's xml node
            marshaller.marshal(info, soapHeader);
        }
    } catch (final Exception e) {
        throw new RuntimeException(e);
    }
    return true;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-20T15:24:41.173

我创建了一个使用参数用户和密码作为标题的 Web 服务公开方法，如下所示：

```
@WebService(serviceName="authentication")
public class WSAuthentication {
   String name = null;
   String password = null;

   public WSAuthentication() {
       super();
   }

   public WSAuthentication(String name, String password) {
       this.name = name;
       this.password = password;
   }

   private static String getData(WSAuthentication sec) {
       System.out.println("********************* AUTHENTICATION ********************" + "\n" + 
       "**********USER: " + sec.name + "\n" + 
       "******PASSWORD: " + sec.password + "\n" + 
       "******************************** AUTHENTICATION ****************************");
       return sec.name + " -- " + sec.password;
   }

   @WebMethod(operationName="security", action="authenticate")
   @WebResult(name="answer")
   public String security(@WebParam(header=true, mode=Mode.IN, name="user") String user, @WebParam(header=true, mode=Mode.IN, name="password") String password) {
        WSAuthentication secure = new WSAuthentication(user, password);
        return getData(secure);
     }
} 
```

尝试编译它并测试从 WSDL 类生成。我希望这有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-11T14:04:28.067

我找到了这个答案：

[JAX-WS - 添加 SOAP 标头](https://stackoverflow.com/questions/2322953/jax-ws-adding-soap-headers)

基本上，您将 -XadditionalHeaders 添加到编译器选项中，并且标头中的对象也作为方法的参数出现在您生成的代码中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-11T18:44:15.100

如果您使用的是 maven，并且 jaxws-maven-plugin 您所要做的就是将 xadditionalHeaders 标志添加到 true 并且客户端将使用以标头作为输入的方法生成。

[https://jax-ws-commons.java.net/jaxws-maven-plugin/wsimport-mojo.html#xadditionalHeaders](https://jax-ws-commons.java.net/jaxws-maven-plugin/wsimport-mojo.html#xadditionalHeaders)***********

# sublimetext - Sublime text 2：有没有办法将 .workspace 存储在单独的文件夹中？

> ID：10654609
> 
> 赞同：7
> 
> 时间：2012-05-18T14:35:09.983
> 
> 标签：sublimetext, sublimetext2

对于使用 Sublime Text 2 创建的每个项目，都会在用户决定存储项目文件的同一目录中创建一对文件。例如。对于“ExampleSite”项目，Sublime 创建了 2 个名为 ExampleSite.project 和 ExampleSite.workspace 的文件

是否可以将 .workspace 文件存储在单独的目录中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T16:17:33.957

项目 - 将项目另存为...

并从项目文件夹中删除旧文件

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-16T02:15:24.840

是的。.sublime-project 有“路径”。sublime-workspace 稍微复杂一些。

# javascript - Javascript 的小胡子渲染问题

> ID：10654613
> 
> 赞同：3
> 
> 时间：2012-05-18T14:35:20.903
> 
> 标签：javascript, html, mustache

我刚刚开始使用 Mustache，我遇到了这个渲染问题。我通过渲染函数发送数据：

```
return Mustache.render(html, data); 
```

或者

```
return Mustache.to_html(html, data); 
```

但是当我将它附加到一个像这样的 div 时：

```
$('#jqt').append(html); 
```

它以实际文本形式返回如下结果：

```
<div id="product_search_view">&lt;form class="search-form" &gt;&lt;ul class="rounded"&gt;&lt;li&gt;&lt;input type="text" id="label" name="search" placeholder="Enter what you are looking for"&gt;&lt;/li&gt;&lt;/ul&gt;&lt;a href="#" class="whiteButton submit" id="search-button" &gt;Search&lt;/a&gt;&lt;/form&gt;&lt;ul id="search-results" class="edgetoedge"&gt;&lt;/ul&gt;</div> 
```

我怎样才能让小胡子不放那些字符？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-18T14:42:16.657

好像您将已解析的 HTML 传递给 Mustache。

这是解决转义字符和使用“三重胡须”[的文档的一部分。](https://github.com/defunkt/mustache#escaping)

另外，[这是另一个文档](http://mustache.github.com/mustache.5.html)。阅读标签类型部分并使用`&`防止转义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T15:26:15.030

上次我也遇到了这个奇怪的问题，我从某个地方得到了这个 hacky 解决方案

```
var temp = Mustache.to_html(template, data_sources );

var correct_temp = $('<textarea />').html(temp).val();

$('#my_el').html(correct_temp); 
```

不知道这是不是一个好习惯。

# sql - 删除空行

> ID：10654614
> 
> 赞同：29
> 
> 时间：2012-05-18T14:35:30.543
> 
> 标签：sql, postgresql

我使用 PostgreSQL 数据库，在一张表中我有 datetime 列**edit_user**。有些行是空白的，我想删除这些行。

我试过

```
DELETE FROM table WHERE edit_user=""; 
```

但我得到了错误

> 第 1 行：从表中删除 edit_user="";

另外，我认为列中的空白值可能是**0000-00-00**，但没有。

我应该如何正确执行这个命令？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-05-18T14:36:30.583

```
DELETE FROM table WHERE edit_user IS NULL; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-02-11T14:59:29.170

如果您尝试删除空格，请尝试使用`=''`而不是`is null`。因此，如果您的行包含空格，`is null`则不会捕获这些记录。空白不为空，null 也不是空白。

```
Dec  Hex     Binary    Char-acter Description
0    00  00000000      NUL        null

32  20  00100000      Space       space 
```

所以我推荐：

```
delete  from foo_table  where bar = ''

#or 

delete  from foo_table  where bar = '' or bar is null 

#or even better , 

delete from foo_table where rtrim(ltrim(isnull(bar,'')))=''; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T18:07:09.543

我相信您的问题是您正在使用双引号而不是单引号检查空字符串。尝试更改为：

```
DELETE FROM table WHERE edit_user='' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-31T06:36:40.260

删除表中的空行

**句法：**

```
DELETE FROM table_name 
WHERE column_name IS NULL; 
```

**例子：**

表名：数据--->列名：pkdno

```
DELETE FROM data 
WHERE pkdno IS NULL; 
```

**答：**删除了 5 行。（这样说的）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-10T17:49:34.293

我有另一个解决方案，对我有用：

```
DELETE FROM MySchema.MyTable WHERE TheColumn IS NULL OR TRIM(TheColumn) = ''; 
```

# html - 当我调用 iframe 父页面时，每次 iframe 创建新的 iframe

> ID：10654619
> 
> 赞同：0
> 
> 时间：2012-05-18T14:35:40.060
> 
> 标签：html, jsp, iframe

我有client.jsp页面，我在里面放了iframe

```
<IFRAME SRC="<%=filterPath%>" width="100%" height="1811px"  id="iframe1" marginheight="0" frameborder="0" ></iframe> 
```

在`client.jsp`我有调用其他页面的链接并从该页面我再次使用以下代码重定向到 client.jsp

```
<a href="client.jsp">redirect</a> 
```

当我查看相同的视图源时，我发现了两个 iframe，代码就像

```
<iframe>
   <iframe>

   <iframe>
</iframe> 
```

每次我从其他页面调用 client.jsp 时，它都会创建新的 iframe 我如何摆脱这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:42:09.597

单击重定向时，您需要在主窗口中加载页面，而不是 IFRAME。

您可以使用以下代码实现此目的：

```
<a target="_parent" href="client.jsp">redirect</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:48:38.847

如果您的链接在 iframe 内，并且您将新的 client.jsp 与其他 iframe 一起加载到 iframe 中 - 您将得到这个。还行吧。只需将以下内容放在 iframe 的开头：

```
<base target="_parent" /> 
```

或为每个链接 target="_parent" 指定：

```
<a href="your_href" target="_parent">your link</a> 
```

# wcf - 从 SQL Server 2008 R2 和 SQL Azure 生成用于 WCF 通信的 GUID API 密钥

> ID：10654622
> 
> 赞同：1
> 
> 时间：2012-05-18T14:35:56.177
> 
> 标签：wcf, sql-server-2008, sql-server-2008-r2, guid, azure-sql-database

我有一个描述其他两种商业模式关联的表格。

例子：

```
Construction Table - available constructions |
Reader Table - available readers |
ReaderPlacement Table - reader assigned to specific construction for specific time. 
```

根据我的要求`ReaderPlacement`表必须包含`ApiKey`，对我来说最好的匹配是唯一的`GUID`，以后用于 WCF 通信。

我打算写这样的东西：

```
ApiKey CHAR(36) NOT NULL DEFAULT NewSequentialId() 
```

这是正确的解决方案吗？我读到这`NewSequentialId()`比`NewId()`而且应该是独一无二的。

db 引擎是否会在我使用时保护我的列是唯一的，`NewSequentialId()`或者我必须添加任何约束和额外的检查？

它也必须对 SQL Azure 有效。

干杯，丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:38:58.003

仅仅通过定义一个默认值`newsequentialid()`，并**不能保证**你不会有重复。是 - SQL Server 生成的值极有可能是唯一的。但是该默认约束不会阻止您插入显式值 - 并且这些值可能与现有值发生冲突。

如果您的列`ApiKey`需要始终唯一，则必须添加唯一约束

```
ALTER TABLE dbo.ReaderPlacement
ADD CONSTRAINT UC_ReaderPlacement_ApiKey UNIQUE(ApiKey) 
```

有了这个独特的约束（肯定也适用于 SQL Azure），SQL Server 将阻止插入任何重复项——任何试图这样做的事务都将被终止并显示错误消息。

# css - 如何对表格进行 CSS 样式设置，使单元格最多为屏幕高度的 30%，并在更高时使用滚动条？

> ID：10654625
> 
> 赞同：0
> 
> 时间：2012-05-18T14:36:02.977
> 
> 标签：css, css-tables

如何对表格进行 CSS 样式设置

*   一个单元格最多为屏幕高度的 30%
*   当它高于屏幕高度的 30% 时使用垂直滚动条
*   如果滚动条短于屏幕高度的 30%，则不要使用滚动条
*   适用于 Firefox 和 Chrome

### 编辑

我试过了

```
tr td {
    max-height:30%;
    height:auto !important;
    overflow:scroll;
} 
```

和几个没有运气的变种。高单元格的高度超过屏幕高度的 30%。

### 如果原件太难，另一个问题：

我可以接受任何方式来呈现大单元格的内容，例如，如果大单元格可以通过按钮或其他东西合拢并重新打开，并且滚动条不是绝对必需的，只要单元格高度最多30% 的屏幕；即主要目标是避免一个单元格太高以至于整个屏幕都显示一个单元格的一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:52:28.247

有什么理由它必须是 30% 而不是设定的高度？通过将内容放入 div 中，我能够达到我认为您想要的效果

```
tr td div.box {
   max-height:200px;
   overflow-y:scroll;
} 
```

# django - （ab）使用 Django 表单向导来做我的投标——这甚至可能吗？

> ID：10654628
> 
> 赞同：2
> 
> 时间：2012-05-18T14:36:17.580
> 
> 标签：django, django-forms, django-formwizard

几天来，我一直一头扎进砖墙上，是时候向比我更聪明、更有经验的人寻求建议了。

**背景：**作为我的网络应用程序的一部分，我正在构建一个测验应用程序，用户可以在其中回答由多项选择题组成的测验。这些问题都是用户生成的，所以我同时遇到了几个有趣的问题：

a）我必须动态构建测验问题表单（radioselect 小部件）。由于答案选项和问题文本都是用户生成的（模型“问题”和“答案”），我必须在视图中运行查询，然后将变量传递给表单的 init。这样我就可以填充选项并用问题文本覆盖标签：

**来自forms.py：**

```
#it's not very clean, there's a lot of legacy code in there...
class AnsweredQuestionForm(forms.ModelForm):
    class Meta:
        model = AnsweredQuestion
        widget = {
            'id': forms.TextInput,  # needed for formset that I was using
        }

    question_field = forms.ModelChoiceField(
        empty_label='Gee, this is tough. Can you show me some hints?',
        widget=forms.RadioSelect,
        queryset=Question.objects.all(),
        required=True,
        help_text='',
        error_messages={'required': 'Please pick an answer'},
    )

    def __init__(self, *args, **kwargs):  # I'm using django crispy-forms
        self.helper = FormHelper()
        self.helper.form_method = 'POST'
        self.helper.form_id = ''
        self.helper.form_class = ''
        self.helper.form_action = ''
        self.helper.form_tag = False
        self.helper.help_text_inline = True
        self.helper.render_unmentioned_fields = False
        self.helper.form_error_title = 'Form Errors'
        self.helper.layout = Layout(
            Field('question_field'),
            Field('id', css_class='hidden'),
        )
        self.question = kwargs.pop('question', None)
        super(AnsweredQuestionForm, self).__init__(*args, **kwargs)
        self.fields['question_field'].label = self.question.question_text
        self.fields['question_field'].queryset = self.question.answers.all() 
```

b）这意味着测验问题形式是模型形式（我有一个名为“AnsweredQuestions”的模型，它保存给定答案的实例。还有一个用于测验的模型“TakenQuiz”）。我在用户开始测验时创建了 TakenQuiz 的实例，并在她回答测验问题并保存表单时创建了 AnsweredQuestion 的实例。

**来自模型.py**

```
class AnsweredQuestion(models.Model):
    question = models.ForeignKey(Question, null=True, blank=True)
    given_answer = models.ForeignKey(Answer, null=True, blank=True)
    taken_quiz = models.ForeignKey(TakenQuiz, related_name="answered_questions", null=True, blank=True)
    date = models.DateTimeField(editable=False)
    correct = models.BooleanField(default=False)

    class Meta:
        verbose_name = 'answered question'
        verbose_name_plural = 'answered questions'

    def save(self, *args, **kwargs):
        """ On save, update timestamp."""
        if not self.id:
            self.date = datetime.datetime.now()
        super(AnsweredQuestion, self).save(*args, **kwargs)

    def __unicode__(self):
        return unicode(self.given_answer) 
```

**从views.py（测试视图）：**

```
def take_quiz(request, category_slug, course_slug, module_slug, quiz_number):
    user = request.user
    category = Category.objects.get(slug=category_slug)
    course = Course.objects.get(category=category, slug=course_slug)
    module = Module.objects.get(course=course, slug=module_slug)
    quiz = module.quizzes.get(number=quiz_number)
    quiz_questions = Question.objects.filter(quiz=quiz)
    ...
    else:
        taken_quiz = TakenQuiz()
        aq_form = AnsweredQuestionForm(question=question) 
```

c) 一个测验可以由可变数量的测验问题组成，我只设置了一个最大限制。所以几乎一切都是动态的:(

所以这是我的具体问题：

1.  如果我使用表单向导，如何访问 URL 参数并将它们用于我的查询？（顺便说一句，我讨厌基于类的通用视图）我试图使问题的数量动态化，但还没有弄清楚如何将变量 (len(quiz_questions) 传递给向导...我的网址如下所示，不幸的是，我需要将所有这些都传递给模板上下文或表单的 init：

    **来自 urls.py：**

    ```
    url(r'^(?P<category_slug>[-\w]+)/(?P<course_slug>[-\w]+)/(?P<module_slug>[-\w]+)/(?P<quiz_number>\d+)/$', quiz_wizard, name='quiz_wizard'),
    quiz_wizard = QuizWizard.as_view(named_quiz_forms)
    named_quiz_forms = [('quiz_question_%d' % i, AnsweredQuestionForm) for i in xrange(0, len(quiz_questions))] 
    ```

2.  我是否应该费心尝试弯曲表单向导来做我需要的事情？我花了很多时间在谷歌研究和源代码上，我找到了一些问题的潜在解决方案，但不是全部。尤其是不能同时为所有人...

    **我可能必须至少覆盖所有这些：**

    ```
    class QuizWizard(NamedUrlSessionWizardView):

        def get_form(self, step=None, data=None, files=None):
            form = super(QuizWizard, self).get_form(step, data, files)
            ...
            return form

        def get_form_kwargs(self, step):
            return {}

        def get_form_instance(self, step):
            return self.instance_dict.get(step, None) 
    ```

3.  最后：如果我不能使用表单向导，我应该如何处理测验有什么建议吗？使用 formwizard 对我来说似乎更干净，而不是只为每个测验问题使用视图。该向导的最大优点是在整个测验完成和验证之前，我不必将表单数据保存在某个地方，并且该向导会为我跟踪步骤数和当前步骤。我是一个新手，从头开始编写这种高级的东西并不是很擅长。

**非常感谢您的帮助，任何建议或帮助都非常感谢！！**

# ios - iPad - 隐藏 UIToolbar 后 UIBarButtonItem 消失

> ID：10654629
> 
> 赞同：2
> 
> 时间：2012-05-18T14:36:18.003
> 
> 标签：ios, ipad, uibarbuttonitem, uitoolbar

我正在使用以下方法为我的底部工具栏创建一些自定义 UIBarButtonItems：

```
- (void)initialisePageNoProperties
{
    pageNoTextField = [[UITextField alloc] initWithFrame:CGRectMake(0, 0, 50, 30)];
    [pageNoTextField setDelegate:self];
    pageNoTextField.text = @"0";              
    pageNoTextField.textColor = [UIColor blackColor];
    pageNoTextField.backgroundColor = [UIColor whiteColor];
    pageNoTextField.textAlignment = UITextAlignmentRight;
    pageNoTextField.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;
    pageNoTextField.borderStyle = UITextBorderStyleRoundedRect;
    pageNoTextField.autocorrectionType = UITextAutocorrectionTypeNo; // no auto correction support
    pageNoTextField.keyboardType = UIKeyboardTypeNumberPad;
    pageNoTextField.returnKeyType = UIReturnKeyGo;
    [pageNoTextField setClearsOnBeginEditing:YES];

    pageNoBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:pageNoTextField];
    pageNoBarButtonItem.style = UIBarButtonItemStyleBordered;

    noOfPagesTextField = [[UITextField alloc] initWithFrame:CGRectMake(0, 0, 50, 30)];
    noOfPagesTextField.text = @"0"; 
    noOfPagesTextField.textColor = [UIColor blackColor];
    noOfPagesTextField.backgroundColor = [UIColor clearColor];
    noOfPagesTextField.textAlignment = UITextAlignmentLeft;
    noOfPagesTextField.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;
    noOfPagesTextField.enabled = NO;
    noOfPagesBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:noOfPagesTextField];
} 
```

然后使用以下方法将这些按钮添加到底部工具栏：

```
- (void)configurePageNoDisplay
{
    if(![self.navigationController isToolbarHidden])
    {
        NSMutableArray *items = [[self.navigationController.toolbar items] mutableCopy];
        bool insertIntoArray = ([items count] == 10); // without the page number display the items array will contain 10 items

        if (insertIntoArray)
        {
            [items insertObject:pageNoBarButtonItem atIndex:3];  
        }
        else 
        {
            [items replaceObjectAtIndex:3 withObject:pageNoBarButtonItem];
        }

        if (insertIntoArray)
        {
            [items insertObject:noOfPagesBarButtonItem atIndex:4]; 
        }
        else 
        {
            [items replaceObjectAtIndex:4 withObject:noOfPagesBarButtonItem];
        }

        [self.navigationController.toolbar setItems:items];
        [self SetPageNoDisplay:[pdfViewCtrl GetCurrentPage]];
    }
} 
```

这些按钮的值设置如下：

```
- (void)SetPageNoDisplay:(NSInteger) pageNumber
{
    pageNoTextField.text = [NSString stringWithFormat:@"%d", pageNumber]; 
    noOfPagesTextField.text = [NSString stringWithFormat:@"of %d", [[pdfViewCtrl GetDoc] GetPageCount]];
} 
```

按钮及其包含的字段声明如下：

```
@property (strong, nonatomic) IBOutlet UIBarButtonItem *pageNoBarButtonItem;
@property (strong, nonatomic) IBOutlet UIBarButtonItem *noOfPagesBarButtonItem;
@property (strong, nonatomic) IBOutlet UITextField *pageNoTextField;
@property (strong, nonatomic) IBOutlet UITextField *noOfPagesTextField; 
```

最初它们没有被声明为 IBOutlets - 但我读到了一个建议，这样做会帮助我解决问题 - 不幸的是它没有帮助。

我隐藏/显示底部工具栏以响应用户的双击：

```
- (void)handleDoubleTap:(UITapGestureRecognizer *)gestureRecognizer
{  
    [self.navigationController setNavigationBarHidden:![self.navigationController isNavigationBarHidden] animated:true];
    [self.navigationController setToolbarHidden:![self.navigationController isToolbarHidden] animated:true];
    [self configurePageNoDisplay];
    //[sideBarTab setHidden:![sideBarTab isHidden]];
} 
```

我遇到的问题是，一旦工具栏被隐藏 - 重新显示时按钮不会再次出现。如果我在重新显示工具栏后旋转 iPad，那么按钮会再次出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T04:55:42.477

使用`setToolbarItems`UIViewController 中的方法设置工具栏按钮，这应该可以解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T11:44:55.487

我最终通过采用不同的方法解决了这个问题。我使用了标准的 UIToolbar，而不是导航控制器工具栏。使用 Interface Builder，我能够将一个普通的 UIView 添加到工具栏，然后在 UIView 中添加 2 个 UITextField。这样我就不必担心将文本字段添加到栏按钮项目内部的工具栏的所有代码 - 或者调用代码以在方向更改、隐藏和显示工具栏等时恢复文本字段。它结束了是一种更简单、更强大的方法。

# scala - 用于 REST 轮询的 Akka

> ID：10654631
> 
> 赞同：12
> 
> 时间：2012-05-18T14:36:24.180
> 
> 标签：scala, rest, akka, polling, play2-mini

我正在尝试将大型 Scala + Akka + PlayMini 应用程序与外部 REST API 连接起来。这个想法是定期轮询（基本上每 1 到 10 分钟）一个根 URL，然后爬过子级 URL 以提取数据，然后将其发送到消息队列。

我想出了两种方法来做到这一点：

## 第一种方式

创建参与者的层次结构以匹配 API 的资源路径结构。在谷歌纵横案例中，这意味着，例如

*   演员 'latitude/v1/currentLocation' 投票[https://www.googleapis.com/latitude/v1/currentLocation](https://www.googleapis.com/latitude/v1/currentLocation)
*   演员“纬度/v1/位置”投票[https://www.googleapis.com/latitude/v1/location](https://www.googleapis.com/latitude/v1/location)
*   演员 'latitude/v1/location/1' 投票[https://www.googleapis.com/latitude/v1/location/1](https://www.googleapis.com/latitude/v1/location/1)
*   演员 'latitude/v1/location/2' 投票[https://www.googleapis.com/latitude/v1/location/2](https://www.googleapis.com/latitude/v1/location/2)
*   演员 'latitude/v1/location/3' 投票[https://www.googleapis.com/latitude/v1/location/3](https://www.googleapis.com/latitude/v1/location/3)
*   等等

在这种情况下，每个actor负责定期轮询其关联资源，以及为下一级路径资源创建/删除子actor（即actor'latitude/v1/location'创建actor 1、2、3等它通过对[https://www.googleapis.com/latitude/v1/location](https://www.googleapis.com/latitude/v1/location)的轮询了解的所有位置）。

## 第二种方式

创建一个相同的轮询参与者池，这些参与者接收由路由器负载平衡的轮询请求（包含资源路径），轮询一次 URL，进行一些处理，并安排轮询请求（针对下一级资源和轮询的 URL） . 在谷歌纵横中，这意味着例如：

1 个路由器，n 个轮询参与者。https://www.googleapis.com/latitude/v1/location的初始轮询请求导致[https://www.googleapis.com/latitude/v1/location/1](https://www.googleapis.com/latitude/v1/location)的几个新（立即）轮询请求，[https](https://www.googleapis.com/latitude/v1/location/1) [：/ /www.googleapis.com/latitude/v1/location/2](https://www.googleapis.com/latitude/v1/location/2)等以及对同一资源的一个（延迟）轮询请求，即[https://www.googleapis.com/latitude/v1/location](https://www.googleapis.com/latitude/v1/location)。

我已经实现了这两种解决方案，但无法立即观察到任何相关的性能差异，至少对于我感兴趣的 API 和轮询频率而言没有。我发现第一种方法更容易推理，也许更容易与系统一起使用.scheduler.schedule(...) 比第二种方法（我需要 scheduleOnce(...)）。此外，假设资源嵌套在几个级别并且有些短暂（例如，可以在每次轮询之间添加/删除几个资源），akka 的生命周期管理可以很容易地在第一种情况下杀死整个分支。第二种方法（理论上）应该更快，并且代码更容易编写。

我的问题是：

1.  哪种方法似乎是最好的（在性能、可扩展性、代码复杂性等方面）？
2.  你觉得这两种方法的设计有什么问题吗（尤其是第一种）？
3.  有没有人试图实现类似的东西？它是怎么做的？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T09:59:43.960

为什么不创建一个主轮询器，然后按计划启动异步资源请求？

我不是使用 Akka 的专家，但我试了一下：

遍历要获取的资源列表的轮询器对象：

```
import akka.util.duration._
import akka.actor._
import play.api.Play.current
import play.api.libs.concurrent.Akka

object Poller {
  val poller = Akka.system.actorOf(Props(new Actor {
    def receive = {
      case x: String => Akka.system.actorOf(Props[ActingSpider], name=x.filter(_.isLetterOrDigit)) ! x
    }
  }))

  def start(l: List[String]): List[Cancellable] =
    l.map(Akka.system.scheduler.schedule(3 seconds, 3 seconds, poller, _))

  def stop(c: Cancellable) {c.cancel()}
} 
```

异步读取资源并触发更多异步读取的参与者。如果更友好，您可以按计划安排消息发送，而不是立即调用：

```
import akka.actor.{Props, Actor}
import java.io.File

class ActingSpider extends Actor {
  import context._
  def receive = {
    case name: String => {
      println("reading " + name)
      new File(name) match {
        case f if f.exists() => spider(f)
        case _ => println("File not found")
      }
      context.stop(self)
    }
  }

  def spider(file: File) {
    io.Source.fromFile(file).getLines().foreach(l => {
      val k = actorOf(Props[ActingSpider], name=l.filter(_.isLetterOrDigit))
      k ! l
    })
  }
} 
```

# extjs - 使用 Sencha GXT 3，生成一个包含动态数量的线系列字段的折线图？

> ID：10654632
> 
> 赞同：0
> 
> 时间：2012-05-18T14:36:26.400
> 
> 标签：extjs, gxt, linechart

使用 Sencha GXT 3.0 是否可以生成折线图并使用动态数量的线系列字段填充它，如果可以，推荐的方法是什么？

我知道可以将多个系列字段添加到图表中，但是折线图示例（以及与此相关的其他图表示例）使用扩展的接口，`PropertyAccess<?>`并且该接口指定了静态数量的预期字段（例如 data1()， data2()、data3() 等）。如果要使用接口指定要添加到图表的字段，您如何解释可能需要 n 个字段的图表（即给定图表上的 n 个线系列）。

Sencha 网站上提供的示例：

[http://www.sencha.com/examples/#ExamplePlace:linechart](http://www.sencha.com/examples/#ExamplePlace:linechart)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T10:46:42.267

我遇到了同样的问题。如果每个系列都有一个商店而不是每个图表只有一个商店，那将是一个更好的设计。

我在 metricDataStore 中有一长串指标值。每个度量值都有一个描述。我希望所有具有相同描述的度量值都显示在一个（并且只有一个）系列上。如果值不应该在系列中，我让每个系列的值提供者在 x 和 y 轴上都返回 null。

这对我来说似乎是一个 hack，但它适用于我的使用：

```
 myChart = new Chart<MetricData>();
    myChart.setStore(metricDataStore); 
```

. . .

```
 for (MetricInfo info : metricInfoData) {
        LineSeries<MetricData> series = new LineSeries<MetricData>();
        series.setChart(myChart);
        series.setSmooth(false);
        series.setShownInLegend(true);
        series.setHighlighting(true);
        series.setYAxisPosition(Chart.Position.LEFT);
        series.setYField(new MetricValueProvider(info.getName()));
        series.setXAxisPosition(Chart.Position.BOTTOM);
        series.setXField(new MetricTimeProvider(info.getName()));
        myChart.addSeries(series);
    } 
```

. . .

```
private class MetricTimeProvider extends Object implements ValueProvider<MetricData, Long> {
    private String metricName;

    public MetricTimeProvider(String metricName) {
        this.metricName = metricName;
    }

    @Override
    public Long getValue(MetricData m) {
        if (metricName != null && metricName.equals(m.getLongDesc()))
            return m.getId();
        else
            return null;
    }

    @Override
    public void setValue(MetricData m, Long value) {
    }

    @Override
    public String getPath() {
        return null;
    }
}

private class MetricValueProvider extends Object implements ValueProvider<MetricData, Double> {
    private String metricName;

    public MetricValueProvider(String metricName) {
        this.metricName = metricName;
    }

    @Override
    public Double getValue(MetricData m) {
        if (metricName != null && metricName.equals(m.getLongDesc()))
            return m.getMetricValue();
        else
            return null;
    }

    @Override
    public void setValue(MetricData m, Double value) {
    }

    @Override
    public String getPath() {
        return null;
    }
} 
```

# asp.net - 在 x86（32 位）下编译 ASP.NET 4 Web 项目时，ASP.NET 在哪里查找二进制文件？

> ID：10654639
> 
> 赞同：0
> 
> 时间：2012-05-18T14:36:47.117
> 
> 标签：asp.net, asp.net-mvc, x86, asp.net-mvc-4, asp.net-web-api

我正在我的 64 位开发机器上的 VS 2010 中开发 ASP.NET MVC 4/Web Api 应用程序。我已经安装了 IIS，并且正在 IIS 下运行该项目。因为我需要与第三方组件交互，所以我必须将项目构建配置更改为 x86（我目前处于 Debug 构建中）。

在 IIS 中，我将应用程序配置为使用允许 32 位进程的应用程序池。但是，当我运行我的网站时，我注意到我所做的代码更改没有显示出来。事实证明，正在使用的程序集是在 \bin 文件夹中找到的程序集。更改配置后，编译器的汇编输出到 \bin\x86\debug 文件夹；它看起来不像 IIS 正在寻找那里。

我暂时将配置切换回“Any CPU”，右键单击项目节点，然后选择**Clean**选项。这删除了 ​​\bin 文件夹中的所有陈旧程序集。然后我切换回 x86 配置 - 重新构建项目以进行良好的衡量 - 并尝试再次运行该项目。现在它根本找不到任何程序集。我收到如下错误：

```
Could not load file or assembly 'System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies 
```

System.Web.Providers - 以及所有其余的程序集 - 位于 \bin\x86\debug 中。

*   IIS 应该知道在那里看吗？
*   Visual Studio 是否应该将程序集向上复制两个级别到 \bin 文件夹？

如果是后者，那显然不会发生。感谢您的任何见解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T18:04:28.733

解决方案只是在项目属性的 Build 选项卡中将 Output Path 设置为 bin。:-)

# ios - 根据用户区域设置删除日期格式的年份

> ID：10654645
> 
> 赞同：3
> 
> 时间：2012-05-18T14:37:15.473
> 
> 标签：ios, objective-c, cocoa-touch, localization, nsdateformatter

我想根据用户设备的区域设置显示日期和月份。

这样今天的日期将显示为*5/18*，美国设置和*18.5。*与德国设置。
因为我想处理所有可能的语言环境，所以我不能简单地使用`[dateFormatter setDateFormat:]`and`[dateFormatter setDateStyle:NSDateFormatterShortStyle]`来显示年份。

除了尝试识别字符串中的年份值并将其删除之外，**还有更优雅的方法吗？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-18T14:50:27.137

我自己找到了答案：

```
[self.dateFormatter setDateFormat:[NSDateFormatter dateFormatFromTemplate:@"MM d"
                                                                  options:0 
                                                                   locale:[NSLocale currentLocale]]]; 
```

在苹果文档中查看更多信息[`dateFormatFromTemplate`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/#//apple_ref/occ/clm/NSDateFormatter/dateFormatFromTemplate:options:locale:)

# java - 易于记忆的指南

> ID：10654648
> 
> 赞同：1
> 
> 时间：2012-05-18T14:37:33.640
> 
> 标签：java, guid, uuid

是否存在不会自动生成的 Java UUID 块？我想在我的代码中定义一个易于记忆的 guid，它将作为一个常量。像空的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:40:18.343

我认为您想要的是静态方法`UUID.fromString(String)`，其中字符串是您之前生成的 UUID 字符串。

您还可以使用 David Heffernan 建议的空 GUID，可以是字符串形式，也可以是使用`new UUID(0L, 0L)`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T14:41:20.560

空 GUID

```
00000000-0000-0000-0000-000000000000 
```

可能是你想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:41:26.990

根据您需要 GUID 的用途，您可以`GUID`使用自己选择的值声明一个名为 的常量值。您有责任确保您不会多次使用相同的值

# php - symfony2 + dictionary2@postgresql 设置模式

> ID：10654651
> 
> 赞同：9
> 
> 时间：2012-05-18T14:37:42.017
> 
> 标签：php, postgresql, symfony, doctrine-orm

我想将 symfony2+doctrine2 用于一个新项目。我遇到了 postgresql-schemes 的一个小问题。与 mysql 相比，您可以在 postgres（如其他数据库）中指定不同的方案。例如，我们的 productiv 数据库有大约 200 个方案。

我必须为我当前的学说连接设置一个模式。我怎样才能做到这一点？

几个月前，我在另一个项目中解决了这个问题，该项目仅使用了学说 2。我做了以下事情：

```
$em = Doctrine\ORM\EntityManager::create($connectionOptions, $config);
$em->getConnection()->exec('SET SEARCH_PATH TO foobar'); 
```

但我不知道我应该在 symfony2 中的哪个位置执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T08:09:31.567

您可以尝试实现和使用您自己的 driver_class 并在 PDO DriverOptions 中传递 search_path，例如在您的 symfony 配置中：

```
# Doctrine Configuration
doctrine:
    dbal:
        driver:   pdo_pgsql
        driver_class: YourNamespace\YourBundle\Doctrine\DBAL\Driver\PDOPgSql\Driver
        options:
            search_path: YOUR_SEARCH_PATH 
```

驱动程序可能看起来像这样：

```
namespace YourNamespace\YourBundle\Doctrine\DBAL\Driver\PDOPgSql;

use Doctrine\DBAL\Platforms;

class Driver extends \Doctrine\DBAL\Driver\PDOPgSql\Driver implements \Doctrine\DBAL\Driver
{
    public function connect(array $params, $username = null, $password = null, array $driverOptions = array())
    {
        // ADD SOME ERROR HANDLING WHEN THE SEARCH_PATH IS MISSING...
        $searchPath = $driverOptions['search_path'];
        unset($driverOptions['search_path']);

        $connection = new \Doctrine\DBAL\Driver\PDOConnection(
            $this->_constructPdoDsn($params),
            $username,
            $password,
            $driverOptions
        );

        $connection->exec("SET SEARCH_PATH TO {$searchPath};");

        return $connection;
    }

    /**
     * Constructs the Postgres PDO DSN.
     *
     * @return string The DSN.
     */
    protected function _constructPdoDsn(array $params)
    {
        $dsn = 'pgsql:';
        if (isset($params['host']) && $params['host'] != '') {
            $dsn .= 'host=' . $params['host'] . ' ';
        }
        if (isset($params['port']) && $params['port'] != '') {
            $dsn .= 'port=' . $params['port'] . ' ';
        }
        if (isset($params['dbname'])) {
            $dsn .= 'dbname=' . $params['dbname'] . ' ';
        }

        return $dsn;
    }
} 
```

您需要 _constructPdoDsn 方法，因为它没有在 \Doctrine\DBAL\Driver\PDOPgSql\Driver 中定义为受保护的。这有点“hacky”，因为我们正在使用 PDO DriverOptions，我不确定这是否是一个好方法 - 但它似乎有效。

希望这可以帮助。

最好的祝福，

帕特里克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-06T09:51:05.713

从 Doctrine 2.5 开始，您可以在`@Table`注释中指定模式名称：

```
/**
 * Clerk
 *
 * @Table(schema="schema")
 */
class Clerk { } 
```

唯一的缺点是，symfony 控制台不能这样做，你必须手动指定它。

# wpf - 如何在 WPF 中制作不可本地化的 SplashScreen

> ID：10654653
> 
> 赞同：1
> 
> 时间：2012-05-18T14:37:43.070
> 
> 标签：wpf, exception, localization, internationalization, satellite-assembly

我只是在我的下一个 WPF 应用程序中添加国际化，并[按照此处的说明进行操作](http://msdn.microsoft.com/en-us/library/ms788718.aspx)。

然后我注意到卫星 DLL 中会有相当多的重复，因此将不会在 .csproj 中本地化的图像标记为

```
<Localizable>False</Localizable> 
```

不幸的是，我的其中一个资源在 SplashScreen 中使用，因此：

```
SplashScreen ss = new SplashScreen("Images/splash.png");
ss.Show(false); 
```

这会在执行 Show 调用时引发异常。这是异常输出

```
A first chance exception of type 'System.IO.IOException' occurred in WindowsBase.dll
A first chance exception of type 'System.Reflection.TargetInvocationException' occurred in mscorlib.dll
Step into: Stepping over method without symbols 'System.RuntimeType.CreateInstanceImpl'
A first chance exception of type 'System.Reflection.TargetInvocationException' occurred in mscorlib.dll
Step into: Stepping over method without symbols 'MS.Internal.Xaml.Runtime.ClrObjectRuntime.CreateInstance'
A first chance exception of type 'System.Xaml.XamlObjectWriterException' occurred in System.Xaml.dll
Step into: Stepping over method without symbols 'System.Windows.Markup.WpfXamlLoader.Load'
A first chance exception of type 'System.Windows.Markup.XamlParseException' occurred in PresentationFramework.dll 
```

附加信息：“对与指定绑定约束匹配的“MainWindow”类型的构造函数的调用引发了异常。行号“4”和行位置“9”。

当我删除 False 线时，它再次起作用。

有没有办法加载我想要的资源，它存储在 test.unlocalizable.g.resources 中？

# php - 使用 php 从源代码中提取 css 类和 ID

> ID：10654654
> 
> 赞同：3
> 
> 时间：2012-05-18T14:37:46.880
> 
> 标签：php, css, regex, parsing

我以为这会很简单，但我现在已经为此苦苦挣扎了一段时间。我知道那里有 CSS 解析器类可以实现我想要做的......但我不需要它们所拥有的 95% 的功能，所以它们并不是真正可行的，而且太重了。

我需要做的就是通过正则表达式提取 CSS 文件中使用的任何类和/或 ID 名称。这是我*认为*可行的正则表达式，但没有。

```
[^a-z0-9][\w]*(?=\s) 
```

当针对我的样本运行时：

```
.stuffclass {
 color:#fff;
 background:url('blah.jpg');
}
.newclass{
 color:#fff;
 background:url('blah.jpg');
}
.oldclass {
 color:#fff;
 background:url('blah.jpg');
}
#blah.newclass {
 color:#fff;
 background:url('blah.jpg');
}
.oldclass#blah{
 color:#fff;
 background:url('blah.jpg');
}
.oldclass #blah {
 color:#fff;
 background:url('blah.jpg');
}
.oldclass .newclass {
 text-shadow:1px 1px 0 #fff;
 color:#fff;
 background:url('blah.jpg');
}
.oldclass:hover{
 color:#fff;
 background:url('blah.jpg');
}
.newclass:active {
 text-shadow:1px 1px 0 #000;
} 
```

它确实符合我想要的*大部分*内容，但它也包括大括号并且与 ID 不匹配。连接时我需要分别匹配 ID 和类。所以基本上`#blah.newclass`将是 2 个单独的匹配项：`#blah`AND `.newclass`。

有任何想法吗？

====================

# 最终解决方案

我最终使用 2 个正则表达式首先去除了 and 之间的所有内容`{`，`}`然后根据剩余的输入简单地匹配选择器。

这是一个完整的工作示例：

```
//Grab contents of css file
$file = file_get_contents('css/style.css');

//Strip out everything between { and }
$pattern_one = '/(?<=\{)(.*?)(?=\})/s';

//Match any and all selectors (and pseudos)
$pattern_two = '/[\.|#][\w]([:\w]+?)+/';

//Run the first regex pattern on the input
$stripped = preg_replace($pattern_one, '', $file);

//Variable to hold results
$selectors = array();

//Run the second regex pattern on $stripped input
$matches = preg_match_all($pattern_two, $stripped, $selectors);

//Show the results
print_r(array_unique($selectors[0])); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:43:01.997

```
[^a-z0-9][\w]+(?=\s) 
```

我将您的 * 更改为 + 匹配

它在 RegEXR 中运行良好 - 一个很棒的正则表达式开发工具：[http](http://gskinner.com/RegExr/) ://gskinner.com/RegExr/ （参见窗口右下角下载桌面版本）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-26T05:35:28.470

此版本基于 nealio82，但添加了伪选择器： `[^a-z0-9][\w:-]+(?=\s)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:43:42.570

```
/(?<!:\s)[#.][\w]*/ 
```

像这样的东西？不包括#FFFFFF 颜色的东西......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-21T14:24:11.627

OP 发布的解决方案有效，但它不适用于带有连字符的 CSS 类。因此，我修改了第二种模式以更有效地工作：

```
$pattern_two = '/[\.|#]([A-Za-z0-9_\-])*(\s?)+/'; 
```

# javascript - 为什么我无法将 Facebook SDK 加载到 Firefox 扩展中？

> ID：10654655
> 
> 赞同：1
> 
> 时间：2012-05-18T14:37:54.403
> 
> 标签：javascript, facebook, firefox-addon, facebook-javascript-sdk

我看过这篇文章： [在 Firefox 插件中验证 facebook 用户，](https://stackoverflow.com/questions/9383794/authenticate-a-facebook-user-in-a-firefox-plug-in) 并且在第三条评论中有人说，无法将 facebook sdk 加载到 Firefox 扩展中。但为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T17:57:39.237

Facebook 提供的 JavaScript SDK 依赖于`connect.facebook.com`插入网页的脚本。但是，当您是扩展程序时，您没有网页来加载此脚本 - 您有扩展程序页面。这些扩展页面是特权的，将脚本加载到其中将授予该脚本执行诸如读取用户磁盘驱动器上的文件（或简单地对其进行格式化）之类的操作的权限。即使 Facebook 被认为是受信任的站点，在某个远程服务器上使用脚本执行此操作也是一个相当大的安全风险——它的服务器可能会被黑客入侵，或者流量可能会被拦截和修改。然后，攻击者基本上可以接管用户的计算机。

理论上，为 Facebook SDK 获取非特权上下文是可能的。但是实际上这已经足够复杂了，以至于我怀疑是否有人做过（应用 ID 绑定到特定主机名的事实使情况更加复杂）。

# iphone - 在视图控制器之间移动时动画不会重新启动

> ID：10654661
> 
> 赞同：6
> 
> 时间：2012-05-18T14:38:10.017
> 
> 标签：iphone, objective-c, ios, animation, uiviewcontroller

当我的根视图控制器加载时，我有许多动画会自动启动。这些动画包含在`viewDidLoad`. 当我导航到下一个视图控制器并返回根视图控制器时，所有动画都停止了。当我按下“主页”按钮然后返回视图时会发生相同的行为。

我确定我在这里遗漏了一些非常基本的东西，但如果有任何帮助，我将不胜感激。谢谢。

**编辑 1**：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    [self beeBobbing];
    //animate the butterfly oscillating
    [self butterflyOscillate];

}

-(void) beeBobbing
{
    [UIView animateWithDuration:1.0f delay:0 options:(UIViewAnimationOptionCurveEaseInOut | UIViewAnimationOptionRepeat | UIViewAnimationOptionAutoreverse | UIViewAnimationOptionAllowUserInteraction ) animations:^{
        CGPoint bottomPoint = CGPointMake(215.0, 380.0);
        imgBee.center = bottomPoint;
    } completion:^(BOOL finished) {

    }];

} 
```

**编辑 2**：这种类型的动画在视图之间切换时似乎会重新启动：

```
-(void) animateClouds
{
    [UIView animateWithDuration:30.0f delay:0 options:UIViewAnimationOptionCurveLinear animations:^{
        CGPoint leftScreenCenter = CGPointMake(-420.0, 119.0);
        imgClouds.center = leftScreenCenter;
    } completion:^(BOOL finished) {
        CGPoint rightScreenCenter = CGPointMake(1450.0, 119.0);
        imgClouds.center = rightScreenCenter;
        [UIView animateWithDuration:40.0f delay:0 options: (UIViewAnimationOptionCurveLinear | UIViewAnimationOptionRepeat) animations:^{
            CGPoint leftScreenCenter = CGPointMake(-420.0, 119.0);
            imgClouds.center = leftScreenCenter;
        } completion:^(BOOL finished) {

        }];

    }];

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T14:44:38.933

我想如果你把所有的动画都放进去，`viewWillAppear:`那么它的工作就很好......就是这样...... :)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T14:44:07.147

viewDidLoad 只是在您第一次加载控制器时被调用，如果然后您通过一些推送导航到其他 viewControllers 或更改选项卡，则不会传入 viewDidLoad ...

尝试在方法中启动动画 - (void)viewWillAppear:(BOOL)animated

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T14:44:14.070

您需要将动画添加到`viewWillAppear:`. `viewDidLoad`当控制器初始化时调用一次，并且视图是从 nib 加载或在`-loadView`方法中创建（如果被覆盖）并且在控制器被销毁并再次创建之前不会再次调用。前后导航时触发的方法是`viewWillAppear:` `viewDidAppear` `viewWillDisappear:`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-21T06:10:13.627

我注意到的是，您需要设置要在其中设置动画的视图的位置`viewDidAppear`或`viewWillAppear`

```
imgClouds.frame = set frame here and this is most important
[self beeBobbing]; 
```

# git - 如何使新的本地分支跟踪与创建它的本地分支相同的远程分支？

> ID：10654671
> 
> 赞同：0
> 
> 时间：2012-05-18T14:38:48.413
> 
> 标签：git

**简洁版本：**

我想从本地分支 (A) 创建一个本地分支 (B) 并使其跟踪 (A) 正在跟踪的同一个远程分支。我怎么能在一个命令中做到这一点？有什么办法可以将此行为设置为默认值？

**完整解释：**

我最近从使用 git-svn 转换为“纯”git。我的工作流程有一个方面非常令人沮丧，我正在尝试找出一种方法来恢复该工作流程。这是 git-svn 的情况：

*   创建一个跟踪远程分支 (X) 的新本地分支 (A)
*   做一些工作，做一些本地提交。
*   `git svn rebase`-- A 重新定位到 X 的 HEAD
*   做一些工作，做一些本地提交。
*   有一个分支想法，从（A）创建一个新的本地分支（B）
*   做一些工作，做一些本地提交。
*   `git svn rebase`-- B 重新定位到 X 的 HEAD
*   等等

在纯 git 世界中，我遇到的问题是，虽然 (A) 跟踪远程分支，但 (B) 并没有继承它。我知道我可以通过`git branch --set-upstream (B) (X)`. 我正在寻找的是一种让这种跟踪行为自动继承的方法，所以我不必记住这样做，然后当我`git pull --rebase`在 (B) 上不起作用时感到非常沮丧。

我意识到这样做的“问题”是它可能会失去由（A）制成的（B）的遗产。我只是不在乎那个。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T16:36:56.013

您正在尝试将集中式工作流程应用于分布式系统。你需要考虑在本地做事，而不是集中做事。共享（中央）存储库只是您放置想要与他人共享的内容的地方，或者您检索他们想要共享的内容的地方。

这基本上就是您所要求的。但是，我认为这不是最好的工作流程。请参阅下面的修改版本。

```
Create a new local branch (A) that tracks a remote branch (X)
   git clone <url> my_repo
Do some work, make some local commits.
   work, work work
   git add .
   git commit -m "commit of work"

A is rebased up to the HEAD of X.  We're operating on the same branch 
we want to rebase from the remote, so we can do it all with one command in 
this case.
   git pull --rebase

Do some work, make some local commits.
   work, work work
   git add .
   git commit -m "commit of work"

Have an offshoot idea, make a new local branch (B) from (A)
  git checkout -b idea

Do some work, make some local commits.
   work, work work
   git add .
   git commit -m "commit of work"

B is rebased up to the HEAD of X

   git rebase origin master 
```

但是……整个工作流程都围绕着遥控器作为“真相的来源”。更多的 git 方式，恕我直言，将您的本地视为真相的来源，并使用中央存储库中的共享内容对其进行更新。都是一样的，只是从不同的角度来看。

以下是我如何处理您的工作流程：

创建一个新的本地分支 (A) 来跟踪远程分支 (X) git clone my_repo 做一些工作，做一些本地提交。工作，工作工作 git add 。git commit -m "提交工作"

```
A is rebased up to the HEAD of X.  We use two commands here, but doing
it this way makes it easy for me to view the differences before 
doing the rebase, if I choose.
   git fetch
   git rebase origin/master

Do some work, make some local commits.
   work, work work
   git add .
   git commit -m "commit of work"

Have an offshoot idea, make a new local branch (B) from (A)
  git checkout -b idea

Do some work, make some local commits.
   work, work work
   git add .
   git commit -m "commit of work"

B is rebased up to the HEAD of X

   git fetch
   git rebase origin/master 
```

当然，这两种情况都取决于您在将 origin/master 重新定位到您的想法分支之前没有在本地 master 分支上做额外工作的事实。如果你这样做了，你就不会有你在本地对 master 所做的提交，这样做会更有效：

```
git fetch
git checkout master
git rebase origin/master  --(make sure master is up-to-date locally)
git checkout idea
git rebase master (apply idea on top of the updated local master) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:24:56.227

好吧，最简单的解决方案，但可能是部分解决方案，就是这样做：

```
git checkout -b B <remote>/X
git merge A 
```

如果您在需要 B 之前已经将 A 推回 X，则不需要第二步。基于遥控器检出 B 会自动设置跟踪。

至于一步：

```
function myGitCo () { git checkout -b $1 $3; git merge $2 }   # <smiley> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T12:39:02.610

掸掉 ol' `bash`& `perl`scripting mojo 并制作出这个解决方案，将其放入一个名为`my-new-branch`：

```
#/bin/bash
REMOTETRACKINGBRANCH=`git branch -vvv | perl -ne '/^\*[^\[]*\[[^:\]]+[:\]]+.*$/ && s/^\*[^\[]*\[([^:\]]+)[:\]]+.*$/\1/ && print;'`
if [ -z "$REMOTETRACKINGBRANCH" ];
then
    echo "ERROR: No remote tracking branch." 1>&2
    exit 1
else
    git checkout -b $1 && git branch --set-upstream $1 $REMOTETRACKINGBRANCH
fi 
```

我敢肯定这可能更简短，但我厌倦了与 shell 转义正则表达式并使用 perl 暴力强制它的斗争。

如果有一种更易于解析（并且不太可能随着 git revs 更改）更接近管道的方法来识别远程跟踪分支，那就太好了，但是 AFAICT 配置文件对于该信息具有权威性，并且解析这似乎比解析更痛苦`git branch -vvv`。

# javascript - Javascript 窗口

> ID：10654674
> 
> 赞同：0
> 
> 时间：2012-05-18T14:39:03.087
> 
> 标签：javascript, window.open

我一直在尝试解决这个问题已经有一段时间了：我无法访问窗口的 url，因为它在另一个域上.. 一些解决方案？

```
function login() {
        var cb = window.open(_url, "windowname1", 'width=800, height=600'); 

        var pollTimer   =   window.setInterval(function() { 
            if (cb.document.url.indexOf(REDIRECT) >= 0) {
                window.clearInterval(pollTimer);
                var url =   cb.document.url;
                acToken =   gup(url, 'access_token');
                tokenType = gup(url, 'token_type');
                expiresIn = gup(url, 'expires_in');
                cb.close();

                validateToken(acToken);
            }
        }, 100);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T14:40:49.770

我在 IE9 上遇到了同样的问题，我找到了解决方案：添加 try{} catch{} 并增加 pollTimer 给出的时间：

```
 function login() {
    var cb = window.open(_url, "windowname1", 'width=800, height=600'); 

    var pollTimer   =   window.setInterval(function() { 
        try {
            if (cb.document.url.indexOf(REDIRECT) >= 0) {
                window.clearInterval(pollTimer);
                var url =   cb.document.url;
                acToken =   gup(url, 'access_token');
                tokenType = gup(url, 'token_type');
                expiresIn = gup(url, 'expires_in');
                cb.close();

                validateToken(acToken);
            }
        } catch (e) {
        }
    }, 500);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:47:36.030

你可以控制 _url 的内容吗？

在这种情况下，您可以让它通过 javascript 返回其内容`document.write`，然后通过引用将其包含在您的当前页面中`<script type="text/javascript" src="_url" />`

在此之后，您可以随意通过 DOM 访问 _url 的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:53:14.407

不，没有跨域策略劫持的解决方案。[这里有一些](https://developer.mozilla.org/En/Same_origin_policy_for_JavaScript)来自 Mozilla 开发者的快速概述。

如果您解释与其他域的属性究竟有什么关系，`document.url`也许有人找到了解决方法。

# hibernate - Glassfish 3.1 持久性错误上的 Spring Roo webapp

> ID：10654682
> 
> 赞同：0
> 
> 时间：2012-05-18T14:39:31.353
> 
> 标签：hibernate, jpa, glassfish-3, spring-roo

我最近开始学习 Spring Roo，并生成了一个在 Jetty 上运行良好的 webapp。我现在想将此原型应用程序移至 Glassfish，以便在完成后将其部署到生产环境中。

现在我面临着让持久层与 Glassfish 3.1 一起工作的艰苦战斗。以下是我为 Glassfish 更新的配置文件中的相关片段。任何解决[此错误](http://pastebin.com/Xej2BT3F)的帮助/指针将不胜感激。我确实[在这里](http://forum.springsource.org/showthread.php?58527)遵循了类似的线程但无济于事。[这里](https://jira.springsource.org/browse/ROO-2222)似乎有针对此问题的 Jira，但我不知道如何实施评论中提到的解决方法。

提前致谢。

**持久性.xml**

```
<persistence-unit name="persistenceUnit" transaction-type="JTA">
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <jta-data-source>jdbc/CTUDB</jta-data-source>
        <properties>
            <property name="hibernate.dialect" value="org.hibernate.dialect.OracleDialect"/>
            <!-- value="create" to build a new database on each run; value="update" to modify an existing database; value="create-drop" means the same as "create" but also drops tables when Hibernate closes; value="validate" makes no changes to the database -->
            <property name="hibernate.hbm2ddl.auto" value="update"/>
            <property name="hibernate.ejb.naming_strategy" value="org.hibernate.cfg.ImprovedNamingStrategy"/>
            <property name="hibernate.connection.charSet" value="UTF-8"/>
            <!-- Uncomment the following two properties for JBoss only -->
            <!-- property name="hibernate.validator.apply_to_ddl" value="false" /-->
            <!-- property name="hibernate.validator.autoregister_listeners" value="false" /-->
        </properties>
</persistence-unit> 
```

**web.xml**

```
<persistence-unit-ref>
    <persistence-unit-ref-name>persistence/persistenceUnit</persistence-unit-ref-name>
    <persistence-unit-name>persistenceUnit</persistence-unit-name>
</persistence-unit-ref> 
```

**应用程序上下文.xml**

```
<jee:jndi-lookup id="entityManagerFactory" jndi-name="persistence/persistenceUnit"/>
<tx:jta-transaction-manager/>
<tx:annotation-driven/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T09:12:36.460

你试过这个： http: [//forum.springsource.org/showthread.php](http://forum.springsource.org/showthread.php?113533-Deploying-a-Roo-JPA-2-App-to-GlassFish-3) ?113533-Deploying-a-Roo-JPA-2-App-to-GlassFish-3 ??

干杯!

# bug-tracking - Redmine 在创建错误后添加观察者

> ID：10654685
> 
> 赞同：21
> 
> 时间：2012-05-18T14:39:43.867
> 
> 标签：bug-tracking, redmine

我一直在尝试 Redmine，看看我是否比 mantis 更喜欢它。但是，我想知道是否可以在创建错误后修改错误的观察者。作为项目经理，当我创建 bug 时，我可以选择用户来观看 bug，但是在创建之后，我看不到编辑此列表的方法。Redmine 是否支持修改用户列表查看一个 bug？如果是在哪里？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-18T15:03:17.460

当然，您可以编辑此列表 - 如果您有必要的权限，则问题详细信息页面的右侧应该有观察者列表，其中包含*添加*观察者的链接以打开下拉列表。

# jquery - SignalR 是 jQuery Ajax（或类似）的合适替代品吗

> ID：10654690
> 
> 赞同：22
> 
> 时间：2012-05-18T14:40:07.977
> 
> 标签：jquery, ajax, signalr

根据标题，SignalR 是否适合替代网页中使用的一般 Ajax（例如 jQuery Ajax）更新。

谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-18T14:49:45.193

如果您需要做的只是浏览器发起的由用户操作触发的对服务器的调用，那么您应该只使用 jQuery Ajax。

仅在服务器需要将客户端与任何用户操作异步更新时才使用 SignalR。在您传统上使用计时器和 Ajax 调用反复轮询服务器以查看是否有任何更改的情况下使用它。

在发生两种呼叫的情况下，您可以将 SignalR 用于用户操作和服务器传递的通知，但将它们分开可能仍然更容易/更清洁。

# e-commerce - Websphere Commerce 运费定制

> ID：10654694
> 
> 赞同：0
> 
> 时间：2012-05-18T14:40:32.897
> 
> 标签：e-commerce, websphere, websphere-7, shipping, commerce

我正在尝试以仅在填充文本框字段时应用的方式自定义运费处理。

我很难找到放置解决此问题的代码段的正确位置。

据我了解，我需要扩展一个具有可用运费值且尚未应用其值的类，因此当未填写该字段时，我可以将其更改为零（使该费用无效）。我已经阅读了很多[计算框架](http://publib.boulder.ibm.com/infocenter/wchelp/v7r0m0/topic/com.ibm.commerce.calculationframework.doc/concepts/ccfintro.htm)并调试了很多默认实现，但还没有成功。

有小费吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-29T17:57:00.810

我假设您没有尝试根据用户输入的促销代码设置免费送货促销。我将从 WebSphere Commerce InfoCenter 中的以下文章和文章底部的“相关任务”开始。它描述了用于配置运输计算的数据。

[http://pic.dhe.ibm.com/infocenter/wchelp/v7r0m0/topic/com.ibm.commerce.calculationframework.doc/refs/rcfshipping_example.htm](http://pic.dhe.ibm.com/infocenter/wchelp/v7r0m0/topic/com.ibm.commerce.calculationframework.doc/refs/rcfshipping_example.htm)

如果您仍然想更改代码，那么您可以查看这篇文章：http: [//pic.dhe.ibm.com/infocenter/wchelp/v7r0m0/topic/com.ibm.commerce.developer.doc/tasks /tshcustcharge.htm](http://pic.dhe.ibm.com/infocenter/wchelp/v7r0m0/topic/com.ibm.commerce.developer.doc/tasks/tshcustcharge.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:53:18.187

您是否阅读过 WCS 运费白皮书？此外，您可能想向 IBM 软件支持提出这个问题。他们可能会让您与开发团队联系，并告诉您实现这一点的最佳方式。

# php - PHP Todo CheckList 检查功能

> ID：10654697
> 
> 赞同：1
> 
> 时间：2012-05-18T14:40:40.277
> 
> 标签：php

我需要有关 PHP 待办事项列表的帮助。除了将其从已完成列表移动到仍需执行的列表的复选框之外，我的大部分工作都在工作。这是我到目前为止的代码：

对于编辑屏幕：

```
%% views/header.html %%
        <h1>{{$title}}</h1>
        <div class='inputs'>
        <form action="@@todo/update@@" method="post">
            <input type="hidden" id="id" name="id" value="{{$todo['id']}}" />
            <label for="description">Description:</label>
            <input type="text" id="description" name="description" value="{{$todo    ['description']}}" />
            <label for="done">Done?:</label>
            <input type="checkbox" id="done" name="done" value="1" />
            <input type="submit" value="Update" />
        <form>
    </div>
    <p><a href="@@index@@"><< Back</a></p>
    %% views/footer.html %% 
```

对于 todo.inc 文件：

```
<?php
include_once "include/util.inc";
include_once "models/todo.inc";
function safeParam($arr, $index, $default) {
    if ($arr && isset($arr[$index])) {
        return $arr[$index];
    }
    return $default;
}
function get_view($params) {
    $id = safeParam($params, 0, false);
    if ($id === false) {
        die("No todo id specified");
    }
    $todo = findToDoById($id);
    if (!$todo) {
        die("No todo with id $id found.");
    }
    // @formatter:off
    renderTemplate(
        "views/todo_view.inc",
        array(
            'title' => 'Viewing To Do',
            'todo' => $todo
        )
    );
    // @formatter:on
}
function get_list($params) {
    $todos = findAllCurrentToDos();
    $dones = findAllDoneToDos();
    // @formatter:off
    renderTemplate(
        "views/index.inc",
        array(
            'title' => 'To Do List',
            'todos' => $todos,
            'dones' => $dones
        )
    );
    // @formatter:on
}
function get_edit($params) {
    $id = safeParam($params, 0, false);
    if (!$id) {
        die("No todo specified");
    }
    $todo = findToDoById($id);
    if (!$todo) {
        die("No todo found.");
    }
    // @formatter:off
    renderTemplate(
        "views/todo_edit.inc",
        array(
            'title' => 'Editing To Do',
            'todo' => $todo
        )
    );
    // @formatter:on
}

function post_add($params) {
    if (!isset($_POST['description'])) {
        die("no description given");
    }
    $description = htmlentities($_POST['description']);
    addToDo($description);
    redirectRelative("index");
}

function validate_present($elements) {
    $errors = '';
    foreach ($elements as $element) {
        if (!isset($_POST[$element])) {
            $errors .= "Missing $element\n";
        }
    }
    return $errors;
}

function post_update($params) {
    $errors = validate_present(array('id', 'description', 'done'));
    if ($errors) {
        die($errors);
    }
    $id = $_POST['id'];
    $description = $_POST['description'];
    $done = $_POST['done'];
    updateToDo($id, $description, $done);
    redirectRelative("todo/view/$id");
    }

function get_delete($params) {
    $id = safeParam($params, 0, false);
    if (!$id) {
        die("No todo specified");
    }
    $todo = findToDoById($id);
    if (!$todo) {
        die("No todo found.");
    }
    deleteToDo($id);
    redirectRelative("index");
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T17:27:16.647

您的错误在于这两个功能。

```
function validate_present($elements) {
    $errors = '';
    foreach ($elements as $element) {
        if (!isset($_POST[$element])) {
            $errors .= "Missing $element\n";
        }
    }
    return $errors;
}

function post_update($params) {
    $errors = validate_present(array('id', 'description', 'done'));
    if ($errors) {
        die($errors);
    }
    $id = $_POST['id'];
    $description = $_POST['description'];
    $done = $_POST['done'];
    updateToDo($id, $description, $done);
    redirectRelative("todo/view/$id");
} 
```

您正在尝试验证在调用时是否`done`存在。 显然不能存在，因为当未选中复选框时它不会发送到服务器。甚至不包含该变量，因此它返回缺少该元素（因为它在技术上是）。我会独自离开并更改如下：`validate_present``post_update``done``$_POST``validate_present``post_update`

```
function post_update($params) {
    $errors = validate_present(array('id', 'description'));
    if ($errors) {
        die($errors);
    }
    $id = $_POST['id'];
    $description = $_POST['description'];
    $done = (isset($_POST['done'])? 1 : 0);
    updateToDo($id, $description, $done);
    redirectRelative("todo/view/$id");
} 
```

# winforms - 如何保持视图状态？一个视图应该只有一个 ViewModel 吗？

> ID：10654702
> 
> 赞同：1
> 
> 时间：2012-05-18T14:40:57.710
> 
> 标签：winforms, design-patterns, webforms, mvp

我有两种形式，

1.  一个主窗体，它有一个显示类型列表的网格视图`AaaViewModel`。
2.  单击主窗体中的一行后会弹出一个子窗体。它将显示在主窗体中单击的行中的一些数据和一个网格视图，其中包含`BbbViewModel`与单击的行相关的类型列表。

如何保持主窗体的状态？应该是

```
interface IMainForm { IEnumerable<AaaViewModel> state; ....} 
```

还是应该放在演示者类中？是否应该将另一个 ViewModel 定义`IEnumerable<AaaViewModel>`为主表单？

BTW，应该如何定义子表单的ViewModel？`AaaViewModel`它应该使用两个视图模型`BbbViewModel`吗？还是应该合并。

```
class SubformViewModel
{
     public AaaViewModel Main { get; set; }
     public IEnumerable<BbbViewModel> Sub { get; set; }
} 
```

或者如果我只需要主表单中的几个字段，我不需要在子表单中包含 AaaViewModel？

```
class SubformViewModel
{
     public int Field1 { get; set; }
     public string Field2 { get; set; }
     public IEnumerable<BbbViewModel> Sub { get; set; }
} 
```

# vba - 将 ActiveWindow.SelectedSheets 存储为对象以供稍后参考

> ID：10654703
> 
> 赞同：4
> 
> 时间：2012-05-18T14:40:59.080
> 
> 标签：vba, excel

我正在尝试编写一个宏来创建一个目录，列出用户当前选择的每个工作表的名称，以及打印时开始的页码。我已经从[这个页面](http://msdn.microsoft.com/en-us/library/ff841199.aspx)中获取了代码，并对其进行了如下调整。

但是，当创建新工作表（“内容”）时，它将成为活动的选定工作表，因此我不能再使用 ActiveWindow.SelectedSheets 来引用用户选择的工作表集合。所以我想在创建新工作表之前存储这些信息。我怎样才能做到这一点？

`Worksheets`如您所见，我已尝试将其分配给类型的变量，但这会生成错误消息。（我也试过`Collection`但没有用。）

```
Sub CreateTableOfContents()
    ' Determine if there is already a Table of Contents
    ' Assume it is there, and if it is not, it will raise an error
    ' if the Err system variable is > 0, you know the sheet is not there
    Dim WST As Worksheet
    Dim SelSheets As Worksheets

    Set SelSheets = ActiveWindow.SelectedSheets

    On Error Resume Next
    Set WST = Worksheets("Contents")
    If Not Err = 0 Then
        ' The Table of contents doesn't exist. Add it
        Set WST = Worksheets.Add(Before:=Worksheets("blankMagnitude"))
        WST.Name = "Contents"
    End If
    On Error GoTo 0

    ' Set up the table of contents page
    WST.[A2] = "Table of Contents"
    With WST.[A6]
        .CurrentRegion.Clear
        .Value = "Subject"
    End With
    WST.[B6] = "Page(s)"
    WST.Range("A1:B1").ColumnWidth = Array(36, 12)
    TOCRow = 7
    PageCount = 0

    ' Do a print preview on all sheets so Excel calcs page breaks
    ' The user must manually close the PrintPreview window
    Msg = "Excel needs to do a print preview to calculate the number of pages." & vbCrLf & "Please dismiss the print preview by clicking close."
    MsgBox Msg
    SelSheets.PrintPreview

    ' Loop through each sheet, collecting TOC information
    For Each S In SelSheets
        If S.Visible = -1 Then
            S.Select
            ThisName = ActiveSheet.Name
            HPages = ActiveSheet.HPageBreaks.Count + 1
            VPages = ActiveSheet.VPageBreaks.Count + 1
            ThisPages = HPages * VPages

            ' Enter info about this sheet on TOC
            WST.Select
            Range("A" & TOCRow).Value = ThisName
            Range("B" & TOCRow).NumberFormat = "@"
            If ThisPages = 1 Then
                Range("B" & TOCRow).Value = PageCount + 1 & " "
            Else
                Range("B" & TOCRow).Value = PageCount + 1 & " " ' & - " & PageCount + ThisPages
            End If
        PageCount = PageCount + ThisPages
        TOCRow = TOCRow + 1
        End If
    Next S
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T15:24:09.073

我刚刚修改了你的代码。这是你正在尝试的吗？老实说，你所要做的就是

更改`Dim SelSheets As Worksheets`为`Dim SelSheets`并且您的原始代码会起作用:)

```
Option Explicit

Sub CreateTableOfContents()
    Dim WST As Worksheet, S As Worksheet
    Dim SelSheets
    Dim msg As String
    Dim TOCRow As Long, PageCount As Long, ThisPages As Long
    Dim HPages As Long, VPages As Long

    Set SelSheets = ActiveWindow.SelectedSheets

    On Error Resume Next
    Application.DisplayAlerts = False
    Worksheets("Contents").Delete
    Application.DisplayAlerts = True
    On Error GoTo 0

    Set WST = Worksheets.Add(Before:=Worksheets("blankMagnitude"))

    With WST
        .Name = "Contents"
        .[A2] = "Table of Contents"
        .[A6] = "Subject"
        .[B6] = "Page(s)"
        .Range("A1:B1").ColumnWidth = Array(36, 12)
    End With

    TOCRow = 7: PageCount = 0

    msg = "Excel needs to do a print preview to calculate the number of pages." & vbCrLf & "Please dismiss the print preview by clicking close."

    MsgBox msg

    SelSheets.PrintPreview

    For Each S In SelSheets
        With S
            HPages = .HPageBreaks.Count + 1
            VPages = .VPageBreaks.Count + 1
            ThisPages = HPages * VPages

            WST.Range("A" & TOCRow).Value = .Name
            WST.Range("B" & TOCRow).NumberFormat = "@"

            If ThisPages = 1 Then
                WST.Range("B" & TOCRow).Value = PageCount + 1 & " "
            Else
                WST.Range("B" & TOCRow).Value = PageCount + 1 & " " ' & - " & PageCount + ThisPages
            End If

            PageCount = PageCount + ThisPages
            TOCRow = TOCRow + 1
        End With
    Next S
End Sub 
```

**EDIT**: One important thing. It's always good to use OPTION EXPLICIT :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:56:45.190

```
Dim wks as Worksheet, strName as String

For each wks in SelSheets
     strName = strName & wks.Name & ","
Next

strName = Left(strName, Len(strName) -1)

Dim arrWks() as String
arrWks = Split(strName,",")

End Sub 
```

您将按名称将所有选定的工作表放在 arrWks 中，然后您可以处理这些工作表。您还可以在循环中将每个工作表名称添加到集合中，使其更流畅。

最好尽可能远离 ActiveSheet。通过这种方式，您可以使用计数器循环遍历数组并处理

所以：

```
Dim intCnt as Ingeter
For intCnt = Lbound(arrWks) to UBound(arrWks)
     Worksheets(arrWks(intCnt)).Activate
     .... rest of code .... 
Next 
```

替换

```
For Each S In SelSheets 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T15:00:01.423

您可以存储对每张工作表的引用；

```
function getSheetsSnapshot() as Worksheet()
dim shts() As Worksheet, i As long
redim shts(ActiveWindow.SelectedSheets.Count - 1)
for i = 0 to ActiveWindow.SelectedSheets.Count - 1
    set shts(i) = ActiveWindow.SelectedSheets(i + 1)
next
getSheetsSnapshot = shts
end function 
```

获取并存储它们：

```
dim oldsel() as Worksheet: oldsel = getSheetsSnapshot() 
```

做你的事情，然后参考原来的选择表；

```
for i = 0 to ubound(oldsel)
    msgbox oldsel(i).name
next 
```

# html - HTML5 Web 应用程序能否访问 Windows 7 平板电脑上的摄像头

> ID：10654704
> 
> 赞同：2
> 
> 时间：2012-05-18T14:41:00.453
> 
> 标签：html, windows-7

我有一个 HTML/Javascript Web 应用程序，它使用 PhoneGap 与设备的相机集成。

有什么方法可以在 Windows 7 平板电脑上运行应用程序（例如作为普通网站）并能够与设备上的相机集成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T09:52:10.380

最终，当 getUserMedia API 在更多浏览器中实现时（目前仅在 Opera 和其他浏览器的特殊版本中可用），您将实现，但目前还没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T09:18:25.843

我不相信有办法做到这一点。

我们允许将照片拖入应用程序以支持此功能。这意味着用户按照平板电脑的指示拍摄照片，然后必须拖动/选择适当的照片文件以添加到应用程序中。

# android - Android 多画布.Drawline

> ID：10654705
> 
> 赞同：0
> 
> 时间：2012-05-18T14:41:04.117
> 
> 标签：android

你好所有关于堆栈溢出的第一篇文章！

我试图在画布上绘制多条线，但使用不同的颜色。我的问题是线条颜色始终与数组中的最后一行相同。我以 30Hz 的频率在屏幕上逐渐绘制垂直线，类似于没有任何间距的条形图。我打电话给视图。Invalidate() 让视图 onDraw() 运行并绘制线条。

```
 @Override
    protected void onDraw(Canvas canvas) {
        // TODO Auto-generated method stub
        super.onDraw(canvas);

        if (plotInfo == null)
            return;

        for (int i = 0; i < plotInfo.length; i++) {
            //paintlineinfo = String.valueOf( plotInfo[i].paintOfLine.getColor());
            canvas.drawLine(i, mDisplay.getHeight(), i, mDisplay.getHeight()-plotInfo[i].linePositionY, plotInfo[i].paintOfLine);
        }
    } 
```

我相信我可能会使用 Open GL，但我目前正试图避免使用它，除非有人能指出我正确的方向以获得一篇可能对我有帮助的好文章。

在某些时候，我想让线条有多种颜色。

任何帮助将不胜感激...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:48:16.923

我不知道你从那里得到颜色，试试：

```
@Override
protected void onDraw(Canvas canvas) 
{
    // TODO Auto-generated method stub
    super.onDraw(canvas);

    if (plotInfo == null)
        return;

    Paint paint = new Paint(Paint.ANTI_ALIAS_FLAG);             

    for (int i = 0; i < plotInfo.length; i++) {
        paint.setColor( yourArrayOfColours.get(i) );
        canvas.drawLine(i, mDisplay.getHeight(), i, mDisplay.getHeight()-plotInfo[i].linePositionY, paint);
    }
} 
```

# python - 找不到名为 zlib 的模块

> ID：10654707
> 
> 赞同：5
> 
> 时间：2012-05-18T14:41:11.447
> 
> 标签：python, python-2.6

我下载 python2.6.6 源代码[http://www.python.org/getit/releases/2.6.6/](http://www.python.org/getit/releases/2.6.6/) 之后我运行这些命令 ./configure make

我试图导入 zlib，但它说没有名为 zlib 的模块。如何为它安装 zlib 模块

在我尝试安装 python2.6.8 之后，我得到了同样的错误，没有 zlib。安装时出现以下错误

未能找到构建这些模块所需的位：

```
_bsddb             _curses            _curses_panel   
_hashlib           _sqlite3           _ssl            
_tkinter           bsddb185           bz2             
dbm                dl                 gdbm            
imageop            linuxaudiodev      ossaudiodev     
readline           sunaudiodev        zlib 
```

要查找必要的位，请在 detect_modules() 中的 setup.py 中查找模块名称。

未能构建这些模块：

```
crypt              nis 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-11T03:07:37.740

我尝试了以下这些对我有一些帮助的模块。
您必须编辑 setup.py。
在 setup.py 中找到以下行：

```
lib_dirs = self.compiler.library_dirs + [
   '/lib64', '/usr/lib64',
   '/lib', '/usr/lib',
   ] 
```

**对于 64 位**
添加`/usr/lib/x86_64-linux-gnu`：

```
lib_dirs = self.compiler.library_dirs + [
   '/lib64', '/usr/lib64',
   '/lib', '/usr/lib', '/usr/lib/x86_64-linux-gnu',
   ] 
```

**对于 32 位**
添加`/usr/lib/i386-linux-gnu`：

```
lib_dirs = self.compiler.library_dirs + [
   '/lib64', '/usr/lib64',
   '/lib', '/usr/lib', '/usr/lib/i386-linux-gnu',
   ] 
```

注意`x86_64-linux-gnu`&`i386-linux-gnu`可能位于系统中的其他位置，因此请相应地进行路径。

在此之后，您将只剩下以下模块：

```
_bsddb             bsddb185           dbm             
gdbm               sunaudiodev 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T17:28:05.673

我解决了添加`LDFLAGS=-L/usr/lib/x86_64-linux-gnu`为`configure`参数的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-21T14:18:33.057

我为自己写了一个注释来解决您的问题，可能会有所帮助：[`python installation`](http://cheater.nemoden.com/python-installation/)。

你真的需要`bsddb`和`sunaudiodev`模块吗？您可能不想这样做，因为自 python 2.6 以来两者都已弃用

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-28T04:16:29.033

我遇到了这个确切的问题（也有确切的 python 分布）Dmity 的答案几乎奏效了......但经过几个小时的搜索，我想我找到了问题（假设你使用的是 ubuntu 11.10 - 12.10）

好的，所以对我来说，至少问题源于 Ubuntu 禁用了 SSLv2，所以解决方法相当复杂。基本上，除了将库路径添加到设置文件之外，您还必须在构建之前深入研究源代码并删除对 SSLv2 的所有引用。我按照本教程进行操作，现在我有了一个使用 python-2.6.8 的可用 virtualenv：

[http://ubuntuforums.org/showthread.php?t=1976837](http://ubuntuforums.org/showthread.php?t=1976837)

（不使用这些补丁很容易实现`patch`）希望这有助于解决问题。*呼*

# c# - 如何选择 LineSeries 中的特定点

> ID：10654708
> 
> 赞同：1
> 
> 时间：2012-05-18T14:41:12.590
> 
> 标签：c#, wpf, xaml, toolkit, lineseries

我目前正在尝试使用 wpf 应用程序中的工具包在 lineSeries 中选择一个点。我只是想用鼠标事件来选择它，但我已经用了几个小时了，到目前为止还没有成功。

这是我的 xaml 的摘录

```
<Grid Name="amplitude_envelope" Grid.ColumnSpan="9" Grid.Column="2" Grid.Row="6" Margin="0,0,95,0">
            <chartingToolkit:Chart Title="Amplitude Envelope" Name="chart1"  AllowDrop="True" >

                <chartingToolkit:Chart.Series>

                    <chartingToolkit:LineSeries 
                        Name="my_line"
                        MouseDown="StartDrag"
                        MouseLeave="StopDrag"
                        MouseMove="DragObject"
                        IsSelectionEnabled="True"
                        Title="Envelope"
                        DependentValuePath="Power" IndependentValuePath="Speed" >
                        <chartingToolkit:LineSeries.DependentRangeAxis>
                            <chartingToolkit:LinearAxis
                                    Orientation="Y"
                                    Title="Amplitude (%)"
                                    Minimum="0"
                                    Maximum="1.2"
                                    Interval="0.2"
                                    ShowGridLines="True"/>
                        </chartingToolkit:LineSeries.DependentRangeAxis>
                    </chartingToolkit:LineSeries>
                </chartingToolkit:Chart.Series>

            </chartingToolkit:Chart>
        </Grid> 
```

我的 DragObject 方法看起来像：

```
private void DragObject(object sender, MouseEventArgs e)
    {
        if (my_line.IsMouseCaptured)
        {
            LineSeries line = (LineSeries)sender;
            var dp = line.SelectedItem;
        }
    } 
```

我只是找不到在直接单击某个点时调用 StartDrag 事件应该做什么（到目前为止，我可以在单击线条或图表时执行它......但这不是我想要的)

你对我有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-05-19T10:18:26.010

您可以在 LineSeries.DataPointStyle 中定义您的事件：

```
<chartingToolkit:LineSeries.DataPointStyle>
    <Style>
        <EventSetter Event="Control.MouseDown" Handler="StartDrag"/>          
    </Style>
</chartingToolkit:LineSeries.DataPointStyle> 
```

另外，请记住设置`IsSelectionEnabled`为 False。

参考：[在 WPF LineSeries DataPoint 上添加事件](https://stackoverflow.com/questions/6793412/adding-events-on-wpf-lineseries-datapoint)

# c# - 我的验证器都没有工作

> ID：10654709
> 
> 赞同：0
> 
> 时间：2012-05-18T14:41:13.837
> 
> 标签：c#, javascript, asp.net, visual-studio-2010, validation

我在表单上有一个字段，允许用户输入 0 到 5000 之间的数字

我尝试了 3 种不同的方法，但是对于所有这三种方法，当我输入大于 5000 的数字时，我的表单提交被接受，这是不应该发生的：

方法1：

```
<asp:CustomValidator ControlToValidate="price" runat="server" ID ="inrange" 
                     ErrorMessage="Must not exceed 5k" 
                     OnServerValidate="lessThan5k">
</asp:CustomValidator> 
```

在代码隐藏中使用此代码

```
protected void lessThan5k(object sender, ServerValidateEventArgs e)
{
  if (Convert.ToInt32(price.Value) < 5000)
  {
    e.IsValid = true;
  }
  else
  {
    e.IsValid = false;
  }
} 
```

方法2：

```
<script type="text/javascript">

  var listen = document.getElementById("price");

  listen.addEventListener("input", function () {
    var value = new parseInt(price.Value);
    if (value > 5000) {
      price.setCustomValidity("must not exceed 5000");
    } else {
      price.setCustomValidity("");
    }
  });
</script> 
```

最后但并非最不重要的方法3：

限制表单字段的数字范围的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:51:44.017

使用[RangeValidator](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.rangevalidator.aspx)。将其从工具箱中拖放到您的页面设计中。

设置以下属性：

*   ControlToValidate--> 你的 TextBox Id
*   类型 --> 整数（以便将其视为整数）
*   最小值 --> 0
*   最大值 --> 5000

如果即使值未通过验证，您也不会发布表单，请设置`EnableClientScript = false`，以便仅在服务器端发布和验证。

`RequiredFieldValidator`请记住，如果您不想允许空条目，您还需要使用 a 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:46:21.273

您应该查看`RangeValidator`ASP.NET 中内置的任何其他验证器控件。这是最简单的方法，因为它可以跨浏览器工作。只需将`MinimumValue`、`MaximumValue`、`Type`和设置`Text`为适当的值；您甚至可以允许使用该`EnableClientScript`属性进行客户端验证。

```
<asp:RangeValidator id="inrange"
    ControlToValidate="price"
    MinimumValue="0"
    MaximumValue="5000"
    Type="Integer"
    EnableClientScript="true"
    Text="Must not exceed 5k"
    runat="server"/> 
```

或者，查看在表单提交按钮上挂钩单击事件并执行客户端检查值，然后如果值无效则取消单击。但是，您仍然需要对值执行服务器端验证，因为您不能保证用户会在他们的机器上启用 JavaScript（这意味着他们能够提交无效数据）。

```
function validatePrice(e){
    var value = new parseInt(price.Value);
    if (value > 5000) {
      price.setCustomValidity("must not exceed 5000");
      e.preventDefault();
    } else {
      price.setCustomValidity("");
    }
};

if (window.addEventListener){
    document.getElementById("price").addEventListener("click", validatePrice);
} else if (window.attachEvent){
    document.getElementById("price").attachEvent("click", validatePrice);
} 
```

您的原始 JavaScript 代码挂钩“输入”，而它应该挂钩“点击”事件。此外，您需要知道该代码不适用于 IE9 以下的任何内容......对于那些，您需要使用`attachEvent`而不是`addEventListener`.

纯粹的 HTML5 方法（不一定是跨浏览器）是在输入元素本身上设置属性。

```
<input type="number" min="0" max="5000" step="0.01" placeholder="Price" /> 
```

这将告诉兼容的浏览器在允许提交表单之前执行浏览器端验证。Chrome 支持所有这些属性，Firefox 支持我列出的大部分属性，但 IE 不能很好地支持它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:51:04.413

你要参加哪个活动？

输入可能不是正确的。

要么挂钩到字段上的模糊或偶然事件，要么挂钩表单上的提交事件。

我认为您当前的代码根本不会执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T15:00:43.047

同意saluce！

要在服务器端检查页面是否有效，按钮的单击事件应如下所示：

```
 protected void btnSubmit_Click(object sender, EventArgs e)
    {
        if (Page.IsValid)
        {
            lblResponse.Text = "Page successfully submitted!";
        }
    } 
```

# jquery - 在 droppable 中访问 div id

> ID：10654712
> 
> 赞同：1
> 
> 时间：2012-05-18T14:41:21.013
> 
> 标签：jquery

我可以访问 jQuery 中可放置元素的 div id：

```
$(".all").droppable({ 
    drop: function(event, ui) { 
        // Get the droppable div id here
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:43:19.917

您可以使用`this.id`，或从`ui.helper`：

```
$( ".all" ).droppable({ 
  drop: function(event, ui) { 
    alert( ui.helper.id );
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:43:28.730

`drop`事件里面`$(this)`代表了droppable元素，`ui.draggable`代表了draggable。你可以试试这个。

```
$(".all").droppable({ 
    drop: function(event, ui) { 
        alert(this.id);
    }
}); 
```

# r - 在 R 中，不能使用组合函数中的赋值来设置向量元素的名称

> ID：10654713
> 
> 赞同：9
> 
> 时间：2012-05-18T13:52:51.190
> 
> 标签：r

快速提问。为什么以下在 R 中起作用（正确地将变量值“Hello”分配给向量的第一个元素）：

```
> a <- "Hello"
> b <- c(a, "There")
> b
[1] "Hello" "There" 
```

这有效：

```
> c <- c("Hello"=1, "There"=2)
> c
Hello There 
    1     2 
```

但这不是（使向量元素名称等于“a”而不是“Hello”）：

```
> c <- c(a=1, "There"=2)
> c
    a There 
    1     2 
```

是否可以让 R 认识到我想在语句中使用 a 的值`c <- c(a=1, "There"=2)`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-18T14:49:18.083

我不确定如何`c()`在内部从命名对象创建名称属性。也许它是沿着`list()`and的路线`unlist()`？无论如何，您可以先分配向量的值，然后再分配名称属性，如下所示。

```
a <- "Hello"
b <- c(1, 2)
names(b) = c(a, "There")
b
# Hello There 
#     1     2 
```

然后稍后访问命名元素：

```
b[a] <- 3
b
# Hello There 
#     3     2 
b["Hello"] <- 4
b
# Hello There 
#     4     2
b[1] <- 5
b
# Hello There 
#     5     2 
```

**编辑**

如果您真的想在一行中完成所有操作，则可以使用以下方法：

```
eval(parse(text = paste0("c(",a," = 1, 'there' = 2)")))
# Hello there 
# 1     2 
```

但是，我认为您更喜欢将值和名称分别分配给该`eval(parse())`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-01T16:49:48.270

在命名列表中分配值。然后将其取消列出。例如

lR<-list("a" = 1, "那里" = 2)

v = unlist(lR)

这给出了一个命名向量 v

v

```
a There 
1     2 
```

# javascript - Flowplayer 播放列表应仅在单击播放后开始播放

> ID：10654715
> 
> 赞同：2
> 
> 时间：2012-05-18T14:41:37.890
> 
> 标签：javascript, flowplayer

我正在为我的一个基于音频的网站使用 Flowplayer。现在我正在加载播放列表剪辑并使用以下代码立即播放它们：

```
function load_clips() {
    $.ajax({
        type : 'GET',
        url : 'category_details/playlistXml',
        dataType : "xml",
        success : function(response) {
            old_len = playlist_songs.length;
            $(response).find("song_details").each(function() {
                var song_name = "files/" + $(this).find("song_name").text();
                var song_id = $(this).find("song_id").text();
                var cat_id = $(this).find("category_id").text();
                var album_id = $(this).find("album_id").text();
                var category_id = $(this).find("category_id").text();
                playlist_songs.push({
                    url : song_name,
                    id : song_id,
                    cat_id : cat_id,
                    album_id:album_id,
                    category_id:category_id
                });
            });
            if (old_len == 0) {
                play_clip(0);
            }
  }
    });
} 
```

因此它通过 play 函数传递，并使用以下代码播放剪辑：

```
function play_clip(id) {
    flowplayer().play(playlist_songs[id]);
} 
```

但现在我需要更改此功能，我需要的是，播放列表必须加载到播放器，但只有在单击播放器的播放按钮后才会播放。您可以在以下位置找到我的实现

[http://bit.ly/J6hIrO](http://bit.ly/J6hIrO)

如果有人可以提供一些建议，那将是很大的帮助

# c# - 如何使用 DotNetZip

> ID：10654716
> 
> 赞同：2
> 
> 时间：2012-05-18T14:41:45.723
> 
> 标签：c#, 7zip

我已经[从 codeplex 下载了 DotNetZip](http://dotnetzip.codeplex.com/releases/view/68268)，我完全不知道下一步该做什么。

我想提取`.zip`档案

我知道我使用这样的东西

```
string zipToUnpack = "C1P3SML.zip";
string unpackDirectory = "Extracted Files";
using (ZipFile zip1 = ZipFile.Read(zipToUnpack))
{
    // here, we extract every entry, but we could extract conditionally
    // based on entry name, size, date, checkbox status, etc.  
    foreach (ZipEntry e in zip1)
    {
      e.Extract(unpackDirectory, ExtractExistingFileAction.OverwriteSilently);
    }
} 
```

我的问题是，我要添加什么项目和/或添加什么参考资料？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T14:44:01.600

只需添加对 Ionic.Zip.dll 的引用 - 您确实需要确保为您的目标框架版本（silverlight、WPF 等）使用正确的引用

然后上面的代码应该可以工作假设你导入了 Ionic 命名空间

也不确定“我应该添加什么项目”是什么意思 - 你已经有一个正确的项目，或者这只是一个测试项目，你需要创建一个新项目？如果是这样，任何项目类型都可以 - 但最好的测试是控制台应用程序或表单/wpf 应用程序

# blackberry - 黑莓操作系统版本限制

> ID：10654721
> 
> 赞同：1
> 
> 时间：2012-05-18T14:42:01.307
> 
> 标签：blackberry, java-me, push-notification

是否存在接受黑莓推送或 JSON 解析的操作系统版本限制。例如，BB OS 版本 5.0 及以上或 6.0 及以上。

我有 BB 设备 6.0，我的应用程序在上面运行良好，有人可以告诉我，我的应用程序是否也可以在 OS 5.0 上运行？我的应用程序还包含推送通知、http 连接和 json 解析。

请帮忙！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T00:00:28.190

BIS Push 将以相同的方式工作。OS 6.0 添加了 JSON 解析器，因此如果您的代码依赖于它，您将不得不引入第三方 JSON 解析器并使用它，以便针对 OS5 构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T07:09:50.057

对于 6.0 及更高版本的 SDK 中添加了 JSON API，但对于较低版本，请查看此[链接](http://supportforums.blackberry.com/t5/Java-Development/JSON-library/td-p/573687)，从该链接下载库

# objective-c - ios帮助屏幕半透明覆盖

> ID：10654722
> 
> 赞同：1
> 
> 时间：2012-05-18T14:42:04.737
> 
> 标签：objective-c, ios, uiview, overlay, cgpoint

想知道是否有人可以阐明如何在 ipad 或 iphone 应用程序上创建半透明的帮助屏幕？类似于谷歌应用的东西。

我有一个 splitViewController，我想在 splitViewController 顶部覆盖一个透明的黑色覆盖层，我可以在其中显示有关您可以在 splitViewController 中单击的每个项目的帮助信息。

我按照[http://cocoawithlove.com/2009/04/showing-message-over-iphone-keyboard.html](http://cocoawithlove.com/2009/04/showing-message-over-iphone-keyboard.html)获得了覆盖，但我现在添加了可点击的 UIViews（例如关闭按钮以关闭覆盖）。问题是当我设置 touchesEnded:withEvent 时，我似乎无法将点击从主 LoadingView 转换为 closeButton 以查看实际点击了什么？

查看代码末尾的触摸

==================================================== ===============

```
#import "HelpView.h"
#import <QuartzCore/QuartzCore.h> 
```

//

```
CGPathRef NewPathWithRoundRect(CGRect rect, CGFloat cornerRadius)
{
//
// Create the boundary path
//
CGMutablePathRef path = CGPathCreateMutable();
CGPathMoveToPoint(path, NULL,
    rect.origin.x,
    rect.origin.y + rect.size.height - cornerRadius);

// Top left corner
CGPathAddArcToPoint(path, NULL,
    rect.origin.x,
    rect.origin.y,
    rect.origin.x + rect.size.width,
    rect.origin.y,
    cornerRadius);

// Top right corner
CGPathAddArcToPoint(path, NULL,
    rect.origin.x + rect.size.width,
    rect.origin.y,
    rect.origin.x + rect.size.width,
    rect.origin.y + rect.size.height,
    cornerRadius);

// Bottom right corner
CGPathAddArcToPoint(path, NULL,
    rect.origin.x + rect.size.width,
    rect.origin.y + rect.size.height,
    rect.origin.x,
    rect.origin.y + rect.size.height,
    cornerRadius);

// Bottom left corner
CGPathAddArcToPoint(path, NULL,
    rect.origin.x,
    rect.origin.y + rect.size.height,
    rect.origin.x,
    rect.origin.y,
    cornerRadius);

// Close the path at the rounded rect
CGPathCloseSubpath(path);

return path;
}

@implementation HelpView

@synthesize closeButton = _closeButton;

- (id)loadingViewInView:(UIView *)aSuperview
{

HelpView *loadingView =
    [[HelpView alloc] initWithFrame:[aSuperview bounds]];
if (!loadingView)
{
    return nil;
}

loadingView.opaque = NO;
loadingView.autoresizingMask =
    UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
[aSuperview addSubview:loadingView];

const CGFloat DEFAULT_LABEL_WIDTH = 100.0;
const CGFloat DEFAULT_LABEL_HEIGHT = 40.0;
CGRect labelFrame = CGRectMake(0, 0, DEFAULT_LABEL_WIDTH, DEFAULT_LABEL_HEIGHT);
UILabel *loadingLabel = [[UILabel alloc] initWithFrame:labelFrame];
loadingLabel.text = NSLocalizedString(@"Close", nil);
loadingLabel.textColor = [UIColor whiteColor];
loadingLabel.backgroundColor = [UIColor clearColor];
loadingLabel.textAlignment = UITextAlignmentCenter;
loadingLabel.font = [UIFont boldSystemFontOfSize:[UIFont labelFontSize]];
loadingLabel.autoresizingMask =
    UIViewAutoresizingFlexibleLeftMargin |
    UIViewAutoresizingFlexibleRightMargin |
    UIViewAutoresizingFlexibleTopMargin |
    UIViewAutoresizingFlexibleBottomMargin;

// Background for Close button
CALayer *closeButtonBackground = [CALayer layer];
closeButtonBackground.opacity = 0.3;
closeButtonBackground.borderColor = [UIColor whiteColor].CGColor;
closeButtonBackground.borderWidth = 2.0;
closeButtonBackground.cornerRadius = 5.0;
closeButtonBackground.backgroundColor = [UIColor blackColor].CGColor;

// Finish setting up frame for Close button
labelFrame.origin.x = 0;
labelFrame.origin.y = 0;
loadingLabel.frame = labelFrame;
closeButtonBackground.frame = labelFrame;

CGRect viewRect = CGRectMake(loadingView.frame.size.width -150   ,loadingView.frame.size.height - 85,100,40);
self.closeButton = [[UIView alloc] initWithFrame:viewRect];
self.closeButton.userInteractionEnabled = YES;
self.userInteractionEnabled = NO;
[loadingView addSubview:self.closeButton];
[self.closeButton.layer addSublayer:closeButtonBackground]; 
[self.closeButton addSubview:loadingLabel];

// Set up the fade-in animation
CATransition *animation = [CATransition animation];
[animation setType:kCATransitionFade];
[[aSuperview layer] addAnimation:animation forKey:@"layerAnimation"];

//[loadingView createGestureRecognizer];

return loadingView;
}

- (void)removeView
{
UIView *aSuperview = [self superview];
[super removeFromSuperview];

// Set up the animation
CATransition *animation = [CATransition animation];
[animation setType:kCATransitionFade];

[[aSuperview layer] addAnimation:animation forKey:@"layerAnimation"];
}

- (void)drawRect:(CGRect)rect
{
rect.size.height -= 1;
rect.size.width -= 1;

const CGFloat RECT_PADDING = 0.0;
rect = CGRectInset(rect, RECT_PADDING, RECT_PADDING);

const CGFloat ROUND_RECT_CORNER_RADIUS = 0.0;
CGPathRef roundRectPath = NewPathWithRoundRect(rect, ROUND_RECT_CORNER_RADIUS);

CGContextRef context = UIGraphicsGetCurrentContext();

const CGFloat BACKGROUND_OPACITY = 0.85;
CGContextSetRGBFillColor(context, 0, 0, 0, BACKGROUND_OPACITY);
CGContextAddPath(context, roundRectPath);
CGContextFillPath(context);

const CGFloat STROKE_OPACITY = 0.25;
CGContextSetRGBStrokeColor(context, 1, 1, 1, STROKE_OPACITY);
CGContextAddPath(context, roundRectPath);
CGContextStrokePath(context);

CGPathRelease(roundRectPath);
}

- (void)handleSingleDoubleTap:(UITapGestureRecognizer *)sender {
NSLog(@"");    
CGPoint tapPoint = [sender locationInView:sender.view];
CALayer* layerThatWasTapped = [self.layer hitTest:tapPoint];

CGPoint convertedPoint = [layerThatWasTapped convertPoint:layerThatWasTapped.position toLayer:self.closeButton.layer];
BOOL myBool = [self.closeButton.layer containsPoint:convertedPoint];

[UIView beginAnimations:nil context:NULL];

sender.view.center = tapPoint;

[UIView commitAnimations];
}

- (void) touchesEnded: (NSSet *) touches  withEvent: (UIEvent *) event {
UITouch *touch = [touches anyObject];
CGPoint point = [touch locationInView: self];
CGPoint convertedPoint = [self convertPoint:point toView:[self.closeButton superview]];

if (CGRectContainsPoint(self.closeButton.bounds, convertedPoint)) {
    NSLog (@"YAY!");
}

} // touchesEnded 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T20:04:38.177

用 NSNotifications 解决了这个问题。像这样的东西......它有点静态......应该更加动态。

```
 [[NSNotificationCenter defaultCenter]
   addObserver:self
   selector:@selector(eventHandler:)
   name:@"SomeButtonClicked"
   object:nil ];

-(void)eventHandler: (NSNotification *) notification
{
    NSString *buttonWhichWasClicked = [[notification userInfo]   objectForKey:@"buttonName"];
    NSLog(@" %@", buttonWhichWasClicked);

    if ([buttonWhichWasClicked isEqualToString:@"close"]){
    [self removeView];
    }
     //Tell other buttons to dim/remove themselves as a new one was selected
 }

- (void)removeView
{
//code to remove view
} 
```

# r - 如何将每行两列的最小值和最大值绘制为散点图

> ID：10654723
> 
> 赞同：0
> 
> 时间：2012-05-18T14:42:08.457
> 
> 标签：r, ggplot2, data-manipulation

我有一个看起来像这样的数据框：

```
| id | length_bgn | length_end |
--------------------------------
| 1  |   209      |    215     |
| 2  |   324      |    125     |
| 3  |   167      |    156     |
| .. |   ...      |    ...     |
-------------------------------- 
```

我想制作一个散点图，其中 X 轴上的长度（每行）最小值和 Y 轴上每行的最大值。我努力了：

```
qplot(min(length_bgn, length_end), max(length_bgn, length_end), data=df) 
```

但是，这会绘制两列的最小值与两列的最大值的单个点。我是否使用了错误的功能？或者以某种方式操纵数据框会更好吗？请原谅任何天真，我对 R 和 ggplot2 还是很陌生。

任何帮助将非常感激。

编辑：使用上述代码的示例图：

![示例散点图](../Images/946266c804212ca77e82fe7c011e769a.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T15:11:37.133

**EDIT**

```
library("ggplot2")

df <- read.table(text = " id  length_bgn  length_end 
        1     209          215     
 2     324          125     
 3     167          156     ", header=TRUE)

df$x <- apply(df[,c(2,3)], 1, min)
df$y <- apply(df[,c(2,3)], 1, max)

qplot(x, y, data=df) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T18:41:13.260

@gauden 的解决方案很好（在绘图前进行处理），但如果你真的想`ggplot`为你做这项工作，你可以。[使用`df`@gauden提供的。]

```
qplot(pmin(length_bgn, length_end), pmax(length_bgn, length_end), data=df) 
```

![在此处输入图像描述](../Images/49ffe7dcbe15a59e6e69da5f197f06b8.png)

# vb.net - VB.NET Linq to SQL - 从表中查询

> ID：10654726
> 
> 赞同：-1
> 
> 时间：2012-05-18T14:42:14.793
> 
> 标签：vb.net, linq-to-sql

我从 VB.NET 中的 Linq to SQL 开始，并试图弄清楚如何对数据库进行简单查询。我想以编程方式完成这一切。

我已经使用连接字符串与数据库建立了连接，这工作正常 - 如果数据库存在或不存在，我可以收到一条消息。但是当我想查询一个表时，我错过了我连接到表的部分。我已经用谷歌搜索了很多来找到答案，但是

没运气。谁能指出我正确的方向？

代码：

```
 Dim strContactString, strDBServer, strDBName, strSQLUser, strSQLPW As String

    strDBServer = "MyServer"
    strDBName = "Northwind"
    strSQLUser = "sa"
    strSQLPW = "MyPW"

    strContactString = ""
    strContactString = strContactString & "data source=" & strDBServer & ";"
    strContactString = strContactString & "initial catalog=" & strDBName & ";"
    strContactString = strContactString & "user id=" & strSQLUser & ";"
    strContactString = strContactString & "password=" & strSQLPW & ";"

    Dim MyContext As New DataContext(strContactString)

    'This works:
    If MyContext.DatabaseExists Then
        MsgBox("DB Exists")
    Else
        MsgBox("DB Does Not Exist")
    End If

    'This is the query I want to run (copied from samples I found)
    Dim TEST = From c In MyContext.Customers _
    Select c.ContactName 
```

错误消息：“客户”不是“System.Data.Linq.DataContext”的成员。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:49:45.167

首先，您不应该直接使用 DataContext 。

您将一个新的 dbml 文件添加到您的项目并使用编辑器将其映射到数据库（这意味着将 Visual Studio 连接到您的数据库，然后将所需的表从服务器资源管理器拖动到 dbml 编辑器）。

这将为您生成一个类，例如 NortwindDataContext（您可以从编辑器的属性窗格中控制它）。

然后，您可以使用它来编写查询：

```
Dim context As New DataContext(strContactString)
Dim TEST = From c In context.Customers _
           Select c.ContactName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T15:02:22.683

[http://msdn.microsoft.com/en-us/library/bb399375.aspx](http://msdn.microsoft.com/en-us/library/bb399375.aspx)

*“最佳实践是声明一个强类型的 DataContext，而不是依赖于基本的 DataContext 类和 GetTable 方法。一个强类型的 DataContext 将所有 Table 集合声明为上下文的成员，如下例所示。”*

只要数据库连接正确，这可能是您的问题。

# javascript - jQuery添加表单元素迭代id

> ID：10654732
> 
> 赞同：0
> 
> 时间：2012-05-18T14:42:44.550
> 
> 标签：javascript, jquery

我不关心表单中的内容，只是想在每次单击添加时添加一组新的内容。但是，我将添加一些条件字段。但考虑到这一点，我真的需要迭代 id 吗？克隆事件是处理这个问题的最佳方式吗？

```
<div id="wrapper">
<div id="condition-1">
  <select id="trigger-1" class="trigger">
      <option value="0">Select...</option>
      <option value="1">View Count</option>
      <option value="2">Comment Count</option>
  </select>
  <select id="operator-1" class="operator">
      <option value="0">Select...</option>
      <option value="1">Is Greater Then</option>
      <option value="2">Less Than</option>
  </select>
  <div id="input-1" class="input">
      <input id="number-1"></input>
  </div>
</div> 
```

```
<div id="add-1" class="add">Add more</div> 
```

我一直在挖掘很多 jQuery .clone() 的示例，但无法将任何示例应用于这样的结构。我的目标是每次单击“添加更多”时添加一组新的表单元素。我不在乎它是否克隆了实际内容，只想克隆然后适当地迭代 id。

我尝试使用类似的东西：

```
var cur_num = 1;

var cloned = $("#condition-" + cur_num).clone(true, true).get(0);

++cur_num;

cloned.id = "condition-" + cur_num;                  // Change the div itself.
$(cloned).find("*").each(function(index, element) {   // And all inner elements.
    if(element.id)
    {
        var matches = element.id.match(/(.+)_\d+/);
        if(matches && matches.length >= 2)            // Captures start at [1].
            element.id = matches[1] + "-" + cur_num;
    }
});

$(cloned).appendTo($("#condition-wrapper"));*/ 
```

上面的代码块将克隆并附加我想要的块。但是当它将第一个条件id迭代到#condition-2时，之后的每个块都会出现#condition-2，我不知道如何将condition-1的孩子更改为trigger-2 operator-2。任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T16:18:52.417

尝试这个

```
$(function(){
$('.add').bind('click',function(){

    var $this=$(this),
        $cloned=$this.prev().clone(),
        re=/(\d+)$/,
        counter=1,
        cid=$cloned.attr('id').replace(re,function(n){
            return counter+=parseInt(n);
        });

        $cloned.attr({id:cid})
        .find('[id]')
        .each(function(i,o){
          var iid=$(o).attr('id').replace(re,counter);
          $(o).attr({id:iid});
        })
        .end()
        .insertBefore($this);
});
}) 
```

# java - Java 你需要一个 else if 之后的 else if 吗？另外，你需要投一个扩展类吗？

> ID：10654734
> 
> 赞同：0
> 
> 时间：2012-05-18T14:42:49.703
> 
> 标签：java, casting, if-statement

我有以下代码。为什么这行得通？铸造是必要的吗？

```
static public Food createMeal(Food f)
      throws Exception
  {

    if (f instanceof Bread)
    {
      return (Bread) f;
    }
    else if (f instanceof Meat)
    {
      return (Meat) f;
    }
    else if (f instanceof Milk)
    {
      return (Milk) f;
    }

    throw new Exception("NotAFood!");
  } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T14:44:11.460

不，向下转换是不必要的，实际上是无操作：

1.  检查`instanceof`确保向下转换不会失败；
2.  每个向下转换的引用都会立即`Food`被`return`语句向上转换回。

该函数可以更紧凑地编写，如下所示：

```
 static public Food createMeal(Food f) throws Exception {
    if ((f instanceof Bread) || (f instanceof Meat) || (f instanceof Milk)) {
      return f;
    } else {
      throw new Exception("NotAFood!");
    }
  } 
```

话虽如此，`instanceof`在条件语句中的使用通常是糟糕设计的标志。想象一下添加一个新的`Food`. 现在您必须重新访问`instanceof`以这种方式使用的代码中的每一个地方，并适当地修改它。

更好的设计是在基类中定义一个合适的虚函数，并在派生类中覆盖它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T14:45:03.427

您不需要`else`在这里，因为如果满足先前的条件，那么`return`将简单地转义整个方法：

```
if (f instanceof Bread)
{
  return (Bread) f;
}
if (f instanceof Meat)
{
  return (Meat) f;
}
if (f instanceof Milk)
{
  return (Milk) f;
}

throw new Exception("NotAFood!"); 
```

不，这里不需要向下转换。实际上，您可以编写这样的等效函数：

```
static public Food createMeal(Food f) throws Exception {
    if(f instanceof Bread || f instanceof Meat || f instanceof Milk) {
        return f;
    }
    throw new Exception("NotAFood!");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T14:59:40.813

因此，如果编译，则意味着 Milk、Bread 和 Meat 是 Food 的子类（它们“扩展”了 Food）。我假设是这种情况。如果是这样，那么这就是编译的原因。

现在，这意味着牛奶、面包和肉类可以被视为食物，但在内部它们是不同的（即一个是面包，一个是牛奶，一个是肉类，每个都有自己独特的成员变量在食物之上物品）

在 Java 中，变量 f 接受任何 Food 和 Food 的任何子类。但是，您传递的任何食物（包括肉类、牛奶和面包）都将被视为 Food 对象，而忽略它们是特定种类的 Food。

如果你想准确地找到它们是什么类型的 Food 子类，你可以使用 instanceof 操作符找出并采取行动。然后，您会将它们转换为它们的实际特定类型，以从这些对象调用特定方法。

您的代码：您正在做的只是返回一个实际的食物项目，因此不需要强制转换。默认情况下，Java 将牛奶、面包和肉类视为食物，默认情况下它们可以代替食物项返回。另一方面，如果您想访问 Meat、Bread 或 Milk 对象的特定属性，那么您将需要强制转换。您需要告诉 java 这些 f 不仅仅是食物，而是肉类、面包或牛奶。例如，如果您的 Milk 类有一个 getFatPercent() 方法，那么您需要执行 ((Milk)f).getFatPercent()

假设可以有更多 Food 的子类，您的代码相当于：

```
static public Food createMeal(Food f) throws Exception {
    if(f instanceof Milk || f instanceof Meat || f instanceof Bread)
        return f;
    else
        throw new Exception("Not a valid Food");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T14:44:50.807

不需要铸造。不，你不需要一个 else if 之后的 else。事实上 else 总是可选的

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-03-29T07:53:46.093

请注意，该`else`语句**并不总是可选**的。比如下面的代码没有编译，因为没有`else`语句！编译器感到困惑，因为 check() 方法必须返回 a`boolean`并且认为存在`if`and`else-if`语句都无法执行的情况，因此 check() 永远不会返回 a `boolean`：

```
static boolean check(int x) {
    if (x < 5) {
        return true;
    } else if (x >= 5) {
        return false;
    }
}

public static void main(String[] args) {
    check(5);
} 
```

# javascript - 在javascript中获取与方向相关的屏幕尺寸（iPad）

> ID：10654739
> 
> 赞同：1
> 
> 时间：2012-05-18T14:43:00.527
> 
> 标签：javascript, ipad, dimensions

我正在尝试获取 iPad 上的屏幕尺寸。

$wnd.screen.width $wnd.screen.height

当我处于横向模式时，尺寸返回 768x1024。这不是我所期望的。如何获得 1024x768 的真实尺寸？

注意：我没有改变方向，我从横向模式开始并保持在该模式下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:54:18.990

作为最简单的解决方案，如果宽度小于高度，则交换宽度和高度，以便您始终获得横向模式的分辨率。

```
function getResolution(){
    return {
        width: $wnd.screen.width < $wnd.screen.height
             ? $wnd.screen.height
             : $wnd.scree.width,
        height: $wnd.screen.height > $wnd.screen.width
             ? $wnd.screen.width
             : $wnd.scree.height
    };
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:49:19.483

当你改变方向时，iPad 喜欢用缩放来做有趣的事情。

`<meta viewport>`您可以使用标签解决其中的许多问题，例如：

```
<meta name="viewport" content="user-scalable=no,initial-scale=1.0,
 minimum-scale=1.0,maximum-scale=1.0"> 
```

# java - 如何在 Blackberry 中执行 http get 请求

> ID：10654745
> 
> 赞同：1
> 
> 时间：2012-05-18T14:43:29.203
> 
> 标签：java, json, blackberry

[我必须在 URL http://api.twitter.com/1/users/show.json?screen_name=Kaka](http://api.twitter.com/1/users/show.json?screen_name=Kaka)上做一个 http GET 请求，我会得到一个 JSON 对象，但我不知道我必须怎么做做。

任何人都可以帮助我吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T22:29:27.173

[此 BlackBerry 代码示例展示了您如何执行此操作](http://docs.blackberry.com/en/developers/deliverables/21128/Code_sample_Parse_JSON_data_structure_1319797_11.jsp)

或者，[从另一个相当简单的示例](http://javamadeasy.blogspot.com/2012/01/json-parsing-in-blackberry.html)，使用`org.json.me` [添加到 BlackBerry Java 6.0 的包](http://www.blackberry.com/developers/docs/6.0.0api/org/json/me/package-summary.html)：

```
 HttpConnection conn = null;
  InputStream in = null;
  ByteArrayOutputStream out = null;
  try {
     String url = "http://api.twitter.com/1/users/show.json?screen_name=Kaka";
     conn = (HttpConnection) Connector.open(url, Connector.READ);
     conn.setRequestMethod(HttpConnection.GET);

     int code = conn.getResponseCode();
     if (code == HttpConnection.HTTP_OK) {
        in = conn.openInputStream();
        out = new ByteArrayOutputStream();
        byte[] buffer = new byte[in.available()];
        int len = 0;
        while ((len = in.read(buffer)) > 0) {
           out.write(buffer);
        }
        out.flush();
        String response = new String(out.toByteArray());
        JSONObject resObject = new JSONObject(response);
        String key = resObject.getString("Insert Json Key");

        Vector resultsVector = new Vector();
        JSONArray jsonArray = resObject.getJSONArray("Insert Json Array Key");
        if (jsonArray.length() > 0) {
           for (int i = 0; i < jsonArray.length();i++) {
              Vector elementsVector = new Vector();
              JSONObject jsonObj = jsonArray.getJSONObject(i);
              elementsVector.addElement(jsonObj.getString("Insert Json Array Element Key1"));
              elementsVector.addElement(jsonObj.getString("Insert Json Array Element Key2"));
              resultsVector.addElement(elementsVector);
           }
        }
      }
  } catch (Exception e) {
     Dialog.alert(e.getMessage());
  } finally {
     if (out != null) {
        out.close();
     }
     if (in != null) {
        in.close();
     }
     if (conn != null) {
        conn.close();
     }
  } 
```

显然，在第二个示例中，您必须插入 JSON 数据实际使用的 JSON 键的名称（留作海报练习）。此外，您可能会了解 JSON 对象的结构，如对象和数组等。因此，您将 JSON 数据解压缩为 JSONObjects 和 JSONArrays 的代码可能与上面的代码略有不同，具体取决于您自己的 JSON 数据。

# silverlight - 在使用 Silverlight 的用户机器上将 0 转换为 double 时出错

> ID：10654747
> 
> 赞同：1
> 
> 时间：2012-05-18T14:43:34.993
> 
> 标签：silverlight, double

我有一个 Silverlight 应用程序，它以 XML 字符串的形式从服务器获取数据，将其作为文档打开，然后解析事物。

这适用于所有其他机器，但我们有一个用户的客户端，该用户的机器无法正常运行。她的盒子给了她一个 InvalidCastException，看起来它正在尝试将 0 转换为 Double。

这似乎是一个环境问题，但我无法弄清楚这是什么原因或如何解决它。她的文化设置看起来不错，至少在数字设置方面是这样。

有人遇到过类似的事情，或者有任何下一步的诊断或可能的修复措施吗？我不认为我们可以连接到机器或任何东西上。

相关堆栈跟踪包括在下面：

```
[InvalidCast_FromStringTo]

参数：0，双

调试资源字符串不可用。通常是关键和论点
提供足够的信息来诊断问题。看
http://go.microsoft.com/fwlink/?linkid=106663&Version=5.1.10411.0&File=Microsoft.VisualBasic.dll&Key=InvalidCast_FromStringTo

类型：System.InvalidCastException

在
Microsoft.VisualBasic.CompilerServices.Conversions.ToDouble（字符串
值，NumberFormatInfo 数字格式）

在 MyNamespace.MyLoader.LoadXml（字符串 xml）

```

# sql - 这是一个有效的 SQL 查询吗？

> ID：10654749
> 
> 赞同：0
> 
> 时间：2012-05-18T14:43:46.673
> 
> 标签：sql

这只是一个例子，我正在做类似的事情，它将获取数千条记录。

```
SELECT * FROM 
(SELECT * FROM zoodb) As TblA 
INNER JOIN 
(SELECT animal_ID, Max(checkup_year) AS latest_checkup FROM TblA GROUP BY animal_ID) as TblB 
ON (TblA.animal_ID = TblB.animal_ID) AND (TblA.checkup_year = TblB.latest_checkup) 
```

基本上在这，我想只抓取最近检查年份的记录

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T14:48:04.330

**您的查询无效。**

* * *

但是你可以这样做：

```
SELECT * FROM zoodb z
INNER JOIN (SELECT animal_ID, Max(checkup_year) AS latest_checkup
            FROM zoodb
            GROUP BY animal_ID) aux ON aux.animal_ID = z.animal_ID AND aux.latest_checkup = z.checkup_year 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T15:26:12.927

此外，查询优化器更喜欢内部连接而不是嵌套的选择语句，因此您将获得更多可选的执行计划

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T15:21:17.217

aF. 的回答是正确的，但我想我会提出一个更清楚地表达您的意图的解决方案：

```
select *
from zoodb as TblA
where latest_checkup = (
    select max(latest_checkup)
    from zoodb
    where animal_id = TblA.animal_id); 
```

缺少 [inner join (subselect)] 也意味着如果您将来需要添加额外的约束，它不会变得太乱。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T14:50:56.747

```
SELECT * FROM 
(SELECT * FROM zoodb) As TblA 
.... 
```

不需要这个子查询。在`FROM`外部查询中可以处理它！

```
SELECT * 
FROM zoodb AS TblA
... 
```

其余的看起来不错！

编辑：

正如 aF 指出的那样，您不能从内部连接子查询中引用 TblA（参见 aF 的答案）。

# objective-c - 在objective-c中将CMTime转换为人类可读的时间

> ID：10654750
> 
> 赞同：25
> 
> 时间：2012-05-18T14:43:47.347
> 
> 标签：objective-c, ios, c, cocoa-touch, cmtime

所以我有一个来自视频的 CMTime。如何将其转换为像 Photo App 中的视频持续时间标签一样的漂亮字符串。是否有一些方便的方法来处理这个问题？谢谢。

```
AVURLAsset* videoAsset = [AVURLAsset URLAssetWithURL:url options:nil];
CMTime videoDuration = videoAsset.duration;
float videoDurationSeconds = CMTimeGetSeconds(videoDuration); 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-03-09T11:14:05.630

如果您不需要日期格式，您也可以使用它来获取文本格式的视频持续时间

```
AVURLAsset *videoAVURLAsset = [AVURLAsset assetWithURL:url];
CMTime durationV = videoAVURLAsset.duration;

NSUInteger dTotalSeconds = CMTimeGetSeconds(durationV);

NSUInteger dHours = floor(dTotalSeconds / 3600);
NSUInteger dMinutes = floor(dTotalSeconds % 3600 / 60);
NSUInteger dSeconds = floor(dTotalSeconds % 3600 % 60);

NSString *videoDurationText = [NSString stringWithFormat:@"%i:%02i:%02i",dHours, dMinutes, dSeconds]; 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-05-26T05:21:00.840

总有一个扩展名；）

```
import CoreMedia

extension CMTime {
    var durationText:String {
        let totalSeconds = Int(CMTimeGetSeconds(self))
        let hours:Int = Int(totalSeconds / 3600)
        let minutes:Int = Int(totalSeconds % 3600 / 60)
        let seconds:Int = Int((totalSeconds % 3600) % 60)

        if hours > 0 {
            return String(format: "%i:%02i:%02i", hours, minutes, seconds)
        } else {
            return String(format: "%02i:%02i", minutes, seconds)
        }
    }
} 
```

使用

```
videoPlayer?.addPeriodicTimeObserverForInterval(CMTime(seconds: 1, preferredTimescale: 1), queue: dispatch_get_main_queue()) { time in
    print(time.durationText)
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-07-26T09:57:20.957

你可以使用`CMTimeCopyDescription`，它工作得很好。

```
NSString *timeDesc = (NSString *)CMTimeCopyDescription(NULL, self.player.currentTime);
NSLog(@"Description of currentTime: %@", timeDesc); 
```

**编辑：**好的，我读的太快了，这不是你想要的，但无论如何对调试都有帮助。

**编辑：**正如@bcattle 评论的那样，我建议的实现包含 ARC 的内存泄漏。这里是更正的版本：

```
NSString *timeDesc = (NSString *)CFBridgingRelease(CMTimeCopyDescription(NULL, self.player.currentTime));
NSLog(@"Description of currentTime: %@", timeDesc); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-04-04T19:46:08.247

基于上述问题和评论的结合，这是简洁的：

```
AVURLAsset* videoAsset = [AVURLAsset URLAssetWithURL:url options:nil];
CMTime videoDuration = videoAsset.duration;
float videoDurationSeconds = CMTimeGetSeconds(videoDuration);

NSDate* date = [NSDate dateWithTimeIntervalSince1970:videoDurationSeconds];
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setTimeZone:[NSTimeZone timeZoneWithName:@"UTC"]];
[dateFormatter setDateFormat:@"HH:mm:ss"];  //you can vary the date string. Ex: "mm:ss"
NSString* result = [dateFormatter stringFromDate:date]; 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-11-17T12:45:13.483

Swift 3.0 ios 10 answer based [codingrhythm](https://stackoverflow.com/users/1412093/codingrhythm) answer...

```
extension CMTime {
var durationText:String {
    let totalSeconds = CMTimeGetSeconds(self)
    let hours:Int = Int(totalSeconds / 3600)
    let minutes:Int = Int(totalSeconds.truncatingRemainder(dividingBy: 3600) / 60)
    let seconds:Int = Int(totalSeconds.truncatingRemainder(dividingBy: 60))

    if hours > 0 {
        return String(format: "%i:%02i:%02i", hours, minutes, seconds)
    } else {
        return String(format: "%02i:%02i", minutes, seconds)
    }
  }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-05-17T11:18:59.500

我用于显示视频文件持续时间的简单扩展。

```
import CoreMedia

extension CMTime {
    var stringValue: String {
        let totalSeconds = Int(self.seconds)
        let hours = totalSeconds / 3600
        let minutes = totalSeconds % 3600 / 60
        let seconds = totalSeconds % 3600 % 60
        if hours > 0 {
            return String(format: "%i:%02i:%02i", hours, minutes, seconds)
        } else {
            return String(format: "%02i:%02i", minutes, seconds)
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-01-10T10:32:46.587

### Swift 4.2 扩展

```
extension CMTime {
    var timeString: String {
        let sInt = Int(seconds)
        let s: Int = sInt % 60
        let m: Int = (sInt / 60) % 60
        let h: Int = sInt / 3600
        return String(format: "%02d:%02d:%02d", h, m, s)
    }

    var timeFromNowString: String {
        let d = Date(timeIntervalSinceNow: seconds)
        let dateFormatter = DateFormatter()
        dateFormatter.dateFormat = "mm:ss"
        return dateFormatter.string(from: d)
    }
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-05-18T14:55:13.750

例如，您可以使用 NSDate 及其描述方法。您可以指定所需的任何输出格式。

```
> ` 
// First, create NSDate object using 
NSDate* d = [[NSDate alloc] initWithTimeIntervalSinceNow:seconds]; 
// Then specify output format 
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init]; [dateFormatter setDateFormat:@"HH:mm:ss"]; 
// And get output with 
NSString* result = [dateFormatter stringWithDate:d];` 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-08-05T07:20:40.437

这是从 cmtime 获取秒数的代码

```
NSLog(@"seconds = %f", CMTimeGetSeconds(cmTime)); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-11-14T21:20:46.703

**斯威夫特 3：**

```
let time = kCMTimeZero
let timeString = time.toString() 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-03-02T11:52:54.360

一个最简单的方法（不使用 NSDate 和 NSDateFormatter）来做到这一点： -

> 使用斯威夫特：-

```
 func updateRecordingTimeLabel()
        {

    // Result Output = MM:SS(01:23) 
    let cmTime = videoFileOutput.recordedDuration
                    var durationInSeconds = Int(CMTimeGetSeconds(cmTime))
                    let durationInMinutes = Int(CMTimeGetSeconds(cmTime)/60)
                    var strDuMin = String(durationInMinutes)

                    durationInSeconds = durationInSeconds-(60*durationInMinutes)
                    var strDuSec = String(durationInSeconds)

                    if durationInSeconds < 10
                    {
                        strDuSec = "0"+strDuSec
                    }
                    if durationInMinutes < 10
                    {
                        strDuMin = "0"+strDuMin
                    }
    // Output string
     let str_output = strDuMin+":"+strDuSec
print("Result Output : [\(str_output)]")

} 
```

# magento - 谷歌分析事件跟踪不工作 Magento 1.5.0.1

> ID：10654751
> 
> 赞同：0
> 
> 时间：2012-05-18T14:43:52.153
> 
> 标签：magento, google-analytics, magento-1.5

事件跟踪不适用于我的 Magento 1.5.0.1 CE 安装。我已将代码 app/code/local/Mage/GoogleAnalytics/Block/GA.php 更新为：

```
 <!-- BEGIN GOOGLE ANALYTICS CODE v2 -->
<script type="text/javascript">
//<![CDATA[

var _gaq = _gaq || [];
' . $this->_getPageTrackingCode($accountId) . '
' . $this->_getOrdersTrackingCode() . '
_gaq.push(["_trackPageLoadTime"]);

(function() {
    var ga = document.createElement(\'script\'); ga.type = \'text/javascript\'; ga.async = true;
    ga.src = (\'https:\' == document.location.protocol ? \'https://ssl\' : \'http://www\') + \'.google-analytics.com/ga.js\';
    (document.getElementsByTagName(\'head\')[0] || document.getElementsByTagName(\'body\')[0]).appendChild(ga);
})();

//]]>
</script>
<!-- END GOOGLE ANALYTICS CODE -->'; 
```

然后我在我的主页上添加了一个事件跟踪链接：

```
<a href="/page-to-link-to" onClick="_gaq.push(['_trackEvent', 'Homepage Events', 'Category Headings', 'Event Im Tracking']);">LINK</a> 
```

所以我通过firebug在firefox中测试了这个并且事件不起作用。有人可以帮帮兄弟吗？

代码也被插入到开始标签之后。

这是它的渲染方式：

```
<!-- BEGIN GOOGLE ANALYTICS CODE v2 -->
<script type="text/javascript">
//<![CDATA[
    var _gaq = _gaq || [];

_gaq.push(['_setAccount', 'UA-XXXXXX-X']);
_gaq.push(['_trackPageview']);

(function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
    })();
//]]>
</script>
<!-- END GOOGLE ANALYTICS CODE --> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T15:31:59.730

您可能在 Firebug 中看不到它，因为它执行得非常快。我建议通过代理工具或 Live HTTP Headers 插件进行测试。[请参阅此处推荐的工具。](https://developers.google.com/analytics/resources/articles/gaTrackingTroubleshooting#debuggingTools)

你的语法是正确的。

此外，您可能需要添加一个 500 毫秒左右的 setTimeout() 来延迟点击，这样您就不会遇到浏览器在完成跟踪调用执行之前转到该链接的竞争条件。我在我写的[一篇博客文章](http://www.blastam.com/blog/index.php/2011/04/how-to-track-downloads-in-google-analytics/)中有一个例子：

```
<a href="/page-to-link-to" onclick="var that=this;_gaq.push(['_trackEvent', 'Homepage Events', 'Category Headings', 'Event Im Tracking']);setTimeout(function(){location.href=that.href;},500);return false;">LINK</a> 
```

# ios - 从字典中以随机顺序返回键/元素的最短代码是什么？

> ID：10654754
> 
> 赞同：0
> 
> 时间：2012-05-18T14:44:02.390
> 
> 标签：ios, sorting

我希望以随机、非重复的顺序从字典中访问键/元素。实现这一目标的最短 ios 代码是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T15:06:24.803

一旦你从[规范的方式获得了 NSMutableArray 的 -shuffle 类别，就可以在 Objective C 中随机化一个 NSArray](https://stackoverflow.com/questions/791232/canonical-way-to-randomize-an-nsarray-in-objective-c)。

```
NSMutableArray *suffledKeys = [[dict allKeys] mutableCopy];
[suffledKeys shuffle];
for (id randomKey in shuffledKeys) {
    id randomValue = [dict objectForKey:randomKey];
    // What ever you need to do.
} 
```

希望这可以帮助。

# java - 扩展 BigDecimal 数的比例

> ID：10654761
> 
> 赞同：1
> 
> 时间：2012-05-18T14:44:19.840
> 
> 标签：java, bigdecimal

我有一个 BigDecimal 数字，在某些情况下我想添加 0。当我更改 BigDecimal 的比例时，它只返回我的 BigDecimal 数字的 subNumber

例子 ：

> BigDecimal c = new BigDecimal(0.1721112427968000094313954596298853517869092775632121988466426373478102735617940027951431710952381083564411002004)1 System.out.println(c.setScale(120));

它返回：

```
0.172111242796800012477831387514015659689903259277343750000000000000000000000000000000000000000000000000000000000000000000 
```

如何在我的 BigDecimal 数字的最后返回 0 的相同数字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:49:48.243

您正在失去精度，因为您对 BigDecimal 的论点被截断为双精度。如果您将相同的参数作为字符串传递（在其周围加上引号），则可以克服这个问题

# java - 泛型、复制构造函数、克隆方法

> ID：10654766
> 
> 赞同：3
> 
> 时间：2012-05-18T14:44:39.033
> 
> 标签：java, generics, clone, copy-constructor

我正在尝试创建一个具有复制构造函数的通用容器。即使我已经编码了克隆方法，我也无法使用它。这是我到目前为止所拥有的：

```
public class MyBox<T> 
{
    private List<T> list;

    public MyBox()
    {
        list = new ArrayList<T>();
    }

    public void add(T item )
    {
        list.add(item);
    }

    public MyBox(MyBox<T> other) throws CloneNotSupportedException //this is giving me trouble
    {
        for(T item : other.list)
        {
            list.add((T) item.clone());
        }
    }
} 
```

我怎样才能让我的复制构造函数工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T14:52:52.520

通常您不需要克隆该项目。

```
public MyBox(MyBox<T> other)
{
    list = new ArrayList<T>(other.list);
} 
```

当您将集合 A 中的项目添加到集合 B 时，该项目现在被两个集合 A 和 B 引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T21:29:01.493

不幸的是，在 Java 中，没有通用的方法来克隆对象。一些类有一个公共`clone()`方法，它允许你克隆，但是没有公共的超类或公共`clone()`方法的接口。（事实上​​，因为没有通用接口；类甚至不必调用它`clone()`；它们可以命名它`copy()`或其他名称。）您可以使用反射来查看是否存在公共`clone()`方法，但这可能有点矫枉过正。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:50:35.910

将泛型限制为 Clonable 怎么样，那么肯定会允许克隆项目：

```
public class MyBox<T extends Clonable> {
   ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T14:52:37.930

```
public MyBox(MyBox<T> other) 
{
      this.list = new ArrayList<T>(other.getList()); 
} 
```

但在这种情况下，您必须首先为您的列表添加一个吸气剂。

UPD。这使得浅拷贝。

# java - 哪个更有效，一个方法调用一个值列表或多个调用每个值？

> ID：10654767
> 
> 赞同：0
> 
> 时间：2012-05-18T14:44:40.573
> 
> 标签：java, list, call

我有一个从文件中读取值的方法（读取方法）并从数据访问对象（DAO）类中调用另一个方法，该类将这些值存储到数据库中（存储方法）。我的问题是：我是否应该将读取方法中读取的所有值作为列表传递给存储方法（这会保存数百个方法调用，但是需要在存储中的列表上的读取方法迭代中创建列表？方法），或者我应该对每个值的存储方法进行单独调用（这意味着数百个方法调用，但不需要列表创建和迭代）。从性能和良好实践的角度来看，哪种方法更有效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:55:44.997

数据库资源有限，应尽量减少数据库命中以获得更好的性能。

如果您比较数据库命中和对列表进行操作的成本，则可以忽略不计。

因此，创建一个 List 并尝试进行批处理操作，而不是对每条记录进行一次操作。

较少的数据库交互始终是一种很好的做法，也是高性能的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:57:51.337

要回答关于良好实践的问题，您必须考虑在您的应用程序中使用 DAO 方法。如果您看到它被多次调用，来自单个原点的多个值，那么我认为您应该将 List 传递给该方法。但是，如果您有更多情况下只有一个值调用该方法，那么您应该以该粒度定义它。

其他人关于数据库访问的说法仍然有效。如果您的情况可能，请尝试批量访问多个数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:48:01.327

您应该一次阅读所有这些，`List`并使用 JDBC Batch Update 之类的东西一次或分批存储它们。

但是，一个一个地完成它们绝对是一个禁忌。它会做太多的网络/IO操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T14:51:15.063

唯一可以确定的方法是对各种选项进行计时。但是，由于您在此过程中要访问数据库，因此这很可能占主导地位。减少数据库访问的变体可能是最快的。如果两种变体对数据库的影响相同，那么我希望它们花费相似的时间。调用方法和创建对象比与数据库通信要快几个数量级。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T14:52:03.640

您有多个值，因此必须*有人*迭代这些值。唯一的问题是：谁？

一般而言：一旦您谈论数据库访问（读取和写入）分配列表的开销，迭代它并执行一些方法调用对于*一个*数据库调用的开销来说是可以忽略不计的（我们谈论的是*数百次*调用，而不是*数十亿*次， 正确的？）。在大多数情况下，数据库调用类似于远程过程调用，写入数据库将写入磁盘 - 另一个很棒的性能吸盘。

因此，在大多数情况下，如果您最大限度地减少对数据库的调用，您将获得性能。如果您的数据库访问层知道*完整*的工作，这可以更容易地完成。所以如果你给 DAO 一个列表，它可以做一些事情，比如准备好的语句、批量更新等等。只考虑零碎的东西，就不可能有好的表现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-18T14:53:55.673

访问硬盘是这里最大的开销。如果可以，请从硬盘读取一次。如果没有，请读入缓冲区并在完成后重新填充它。这个操作适合Threading，试试看。

# ios - 更改用户的个人资料图片

> ID：10654768
> 
> 赞同：2
> 
> 时间：2012-05-18T14:44:41.163
> 
> 标签：ios, facebook, facebook-graph-api

有一个问题 - 我可以使用 Facebook Graph Api 在 Facebook 中更改用户的个人资料图片吗？我的 IOS 应用程序需要它。

# node.js - Node.js 邮件解析器模块错误：找不到模块“iconv”

> ID：10654772
> 
> 赞同：4
> 
> 时间：2012-05-18T14:44:54.210
> 
> 标签：node.js, imap

我正在努力学习 node.js，并且正在玩在[这里找到的 imap 和 mailparser 示例代码](https://gist.github.com/1226809)。我根据各自 github 页面上的自述文件中的说明安装了[imap](https://github.com/mscdex/node-imap)和[mailparser ，一切都安装得很好，没有任何错误。](https://github.com/andris9/mailparser)尝试运行示例代码时，我收到以下错误：

`Error: Cannot find module 'iconv'`

安装完模块后，我的项目目录结构如下：

```
~/ProjectDir
    |
    -- node_modules
    |   |
    |   -- imap
    |   |   |
    |   |   -- LICENSE
    |   |   -- README.md
    |   |   -- imap.js
    |   |   -- package.json
    |   -- mailparser
    |   |   |
    |   |   -- lib
    |   |   |   |
    |   |   |   -- datetime.js
    |   |   |   -- mailparser.js
    |   |   |   -- streams.js
    |   |   -- node_modules
    |   |   |   |
    |   |   |   -- iconv
    |   |   |   |   ...
    |   |   |   -- mimelib
    |   |   |   |   ...
    |   |   -- test
    |   |   |   ...
    |   |   -- LICENSE
    |   |   -- README.md
    |   |   -- package.json
    |   |       ...
    |   -- config.json
    |   -- mailFether.js
    |   -- readme.md 
```

因此，基于我为这个问题所做的一些谷歌搜索，我注意到这个“找不到模块”错误似乎是一个相当普遍的错误，但我已经能够看到一个一致的解决方案问题。

这里的问题是文件夹中的嵌套`node_modules`目录`mailparser`吗？该文件夹的内容实际上是否应该在`node_modules`项目根目录的文件夹中？这是项目设置问题还是环境问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-15T11:50:54.133

只需尝试安装 iconv 模块：`npm install iconv`- 并查看此命令的输出，iirc iconv 构建一个二进制文件，在某些情况下这可能会失败，那么我们应该找出它失败的原因 - 但在这种情况下，只有在以下情况下才能提供帮助您提供安装命令的输出。

> 这里的问题是 mailparser 文件夹中嵌套的 node_modules 目录吗？

不，这没关系，这就是 npm 的工作方式。模块的所有依赖项都存储在嵌套的 node_module 文件夹中。

# database - 使用 CUBRID DB 实现分片

> ID：10654779
> 
> 赞同：1
> 
> 时间：2012-05-18T14:45:07.530
> 
> 标签：database, scalability, sharding, cubrid

您知道如何在 Amazon EC2 或任何其他计算机环境上使用 CUBRID 数据库分片。我在他们的网站上找不到任何关于它是如何做的信息。( [http://www.cubrid.org/](http://www.cubrid.org/) )

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T01:47:21.663

我与 CUBRID 项目有关。

CUBRID SHARD，本机数据库分片功能，已经开发完成。它将作为 CUBRID 8.4.2 的一部分发布，CUBRID 8.4.2 将于 2012 年 6 月 8 日在三周内发布。手册和示例将与官方公告一起发布。您可能想订阅[CUBRID 官方博客](http://www.cubrid.org/blog)以接收新闻。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T15:12:18.730

据我了解，分片仍在他们的路线图上。

当前版本仍然是 8.4.1，幻灯片 51 上的[相同演示](http://www.slideshare.net/cubrid/growing-in-the-wild-the-story-by-cubrid-database-developers)显示了他们对未来版本的计划。

# c# - DateTimePicker 日历默认为所选的上个月/年

> ID：10654780
> 
> 赞同：2
> 
> 时间：2012-05-18T14:45:15.820
> 
> 标签：c#, wpf, xaml, mvvm, datetimepicker

什么时候日期时间？我的 DateTimePicker 控件的源更改为 null 并且我想选择另一个日期，日历下拉菜单默认为所选的最后一个月和年份。

我将 DateTimePicker 用于 DOB，因此月份和年份会有很大差异，我宁愿在数据源更改为 null 时将日历重置为当前月份和年份。WPFToolkit 中的 DateTimePicker 执行此操作，但我不想要微调器或它附带的时间选择，并且找不到隐藏它们的方法。

我正在使用 MVVM 设计模式，并希望避免立即进行代码隐藏。

XAML 从视图：

```
<DatePicker Height="25" HorizontalAlignment="Left" Margin="53,47,0,0" 
    Name="dpEventDate" VerticalAlignment="Top" Width="115" 
    SelectedDate="{Binding EventItem.BirthDate, Mode=TwoWay, 
    UpdateSourceTrigger=PropertyChanged}" /> 
```

视图模型中的C#：（事件是我在模型中制作的一个类）

```
private Event _eventItem;

public event PropertyChangedEventHandler PropertyChanged;
public RelayCommand CreateCommand { get; private set; }

public Event EventItem
{
    get { return _eventItem; }
    set { _eventItem = value; OnPropertyChanged("EventItem"); }
}

public MainViewModel()
{
    EventItem = new Event();
    CreateCommand = new RelayCommand(CreateEvent);
}

protected void OnPropertyChanged(string name)
{
    PropertyChangedEventHandler handler = PropertyChanged;

    if (handler != null)
    {
        handler(this, new PropertyChangedEventArgs(name));
    }
} 
```

如果我可以提供更多细节来帮助您帮助我，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:34:40.093

根据 Adam 的建议，这里是视图模型中的代码，它帮助我重置了 DateTimePicker 的日历显示：

```
private Event _eventItem;
private DateTime? _viewDate;

public event PropertyChangedEventHandler PropertyChanged;
public RelayCommand CreateCommand { get; private set; }

public Event EventItem
{
    get { return _eventItem; }
    set { _eventItem = value; OnPropertyChanged("EventItem"); }
}

// Decoy DateTime property
public DateTime? ViewDate
{
    get { return _viewDate; }
    set
    { 
        _viewDate = value;
        EventItem.EventDate = _viewDate; // Update the source

        OnPropertyChanged("ViewDate");
    }
}

public MainViewModel()
{
    EventItem = new Event();
    CreateCommand = new RelayCommand(CreateEvent);
}

private void CreateEvent()
{
    ViewDate = DateTime.Today; // Important for resetting the calendar display
    // Save input and set EventItem to new event for a clean slate
}

protected void OnPropertyChanged(string name)
{
    PropertyChangedEventHandler handler = PropertyChanged;

    if (handler != null)
    {
        handler(this, new PropertyChangedEventArgs(name));
    }

    // Important if you want your DatePicker control to be empty
    if(name.Equals("ViewDate") && DateTime.Today.Equals(ViewDate))
    {
        ViewDate = null;
    }
} 
```

# debugging - 如何从我的内核模式驱动程序中查看 DbgPrint 输出？

> ID：10654782
> 
> 赞同：10
> 
> 时间：2012-05-18T14:45:29.387
> 
> 标签：debugging, windows-xp, driver, kernel

我发现很难从我正在处理的内核模式驱动程序中看到调试输出。

我是驱动程序开发的新手。我正在尝试在 Windows XP 上调试 USB 驱动程序。我已经安装了 DDK，并为我的驱动程序构建了一个“检查模式”版本。我已经安装了驱动程序，如果我使用十六进制编辑器在 windows/drivers 中查看驱动程序的 .sys 文件，我可以看到调试输出字符串的文本。

如果我在 Visual Studio 下运行使用我的驱动程序的应用程序，我的调试输出不会像应用程序自己的调试输出那样出现在输出窗口中。在网上搜索，我发现了许多关于如何显示内核调试输出的不同说法。对于一般的内核调试，人们似乎要么通过 NULL 调制解调器电缆（Crikey，它是 2012 年）进行远程调试，要么使用虚拟机和虚拟 com 端口。这两种方法似乎都需要大量的工作才能看到调试输出。有替代方案吗？

我尝试在“本地”内核调试模式下使用 WinDbg，但它没有显示任何内容。它警告我应该在启用“/debug”的情况下重新启动窗口。我这样做了，但没有帮助。

还有其他想法吗？还是我在要求不可能的事情？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-18T17:55:14.473

DebugView 将显示来自驱动程序的跟踪消息：

[http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)

但是，您确实需要两台机器来完成任何真正的开发工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T17:52:43.430

你查到的信息是正确的。您确实需要 2 台机器来调试内核模式驱动程序。

如果您选择使用 2 台物理机，它们可以通过 USB 连接。NULL 调制解调器（COM 端口）是将调试器连接到虚拟机的常用方法，其中 VM 的 COM 端口被视为主机上的命名管道，因此您实际上并不需要 NULL 调制解调器电缆。

几个链接

[http://msdn.microsoft.com/en-us/library/ff538141.aspx](http://msdn.microsoft.com/en-us/library/ff538141.aspx)

[http://msdn.microsoft.com/en-us/library/ff542279.aspx](http://msdn.microsoft.com/en-us/library/ff542279.aspx)

# batch-file - 从AD批量获取用户名和密码过期

> ID：10654783
> 
> 赞同：0
> 
> 时间：2012-05-18T14:45:32.010
> 
> 标签：batch-file

我目前有一个包含所有 AD 用户的文本文件。使用以下内容，我可以获得 PWD 到期日期的管道列表，但我无法将用户名与到期日期配对以确保准确性。有人可以帮忙吗？警告：需要批处理:(

```
 for /F %%i in (users.txt) do net user %%i /domain | find "Password expires" >> passwordexp.txt 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:26:48.210

您已经拥有所需的所有信息，您只需将其打印出来 :-)

您可以使用括号在 DO 子句中执行多个命令。

您可以使用 SET /P 打印最后没有换行符的信息。

将整个构造括在括号中并将输出定向到文件一次会更有效。

```
@echo off
(
  for /F %%i in (users.txt) do (
    <nul set /p "=%%i: "
    net user %%i /domain | find "Password expires"
  )
)>passwordexp.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T15:04:31.850

好的，我认为这对您有用：

要获取“用户名”，请执行以下操作：

```
 for /f "tokens=1-3*" %%a in ('net user administrator /domain ^| find "User name"') do @echo "%%a %%b" "%%c" & set uname=%%c 
```

要获得“密码过期”，请执行以下操作：

```
 for /f "tokens=1-3*" %%a in ('net user administrator /domain ^| find "Passowrd expires"') do @echo "%%a %%b" "%%c" & set expires=%%c 
```

要显示用户的状态，请执行以下操作：

```
 echo %uname% expires %expires% 
```

这对您想要的有用吗（不要忘记将管理员更改为您的用户名）

# php - 替换 eregi_replace preg_replace

> ID：10654786
> 
> 赞同：-4
> 
> 时间：2012-05-18T14:45:45.113
> 
> 标签：php, preg-replace

> **可能重复：**
> [将 ereg 表达式转换为 preg](https://stackoverflow.com/questions/6270004/converting-ereg-expressions-to-preg)

如何使用此参数转换此函数

eregi_replace("[][,.?&\"#{(_\\@)\=+\,\?.;/:!%*()|}]+", "", $data);

preg_replace？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:49:49.260

你的答案： preg_replace('/[][,.?&\"#{(_\@)\=+\,\?.;/:!%*()|}]+/', "", $数据）

并且请[pre_replace](http://php.net/preg_replace)更多简单的问题，在这些地方不是每个人都像我一样仁慈，可能你没有答案，在询问之前搜索

# bash - 在 bash 中自定义“cd”

> ID：10654793
> 
> 赞同：0
> 
> 时间：2012-05-18T14:46:24.290
> 
> 标签：bash, alias, cd

我只是认为我可以方便地“cd”到我存储一些文件的目录，即。

```
[admin@local /]$ cd /usr/bin/somefile.pl 
```

据我所知，官方的“cd”命令不起作用。

所以我写了这样的东西：

```
main () {
    if [[ "${1}" =~ "(.+/)*(.*){1}" ]] && [ -f "${1}" ] ; then
            `\cd ${1%/*}`
    elif [ -f "${1}" ] ; then
            exit 0
    else ; `\cd ${1}`
    fi
}
main ${1} 
```

我将此 cd.sh 别名为“cd”命令：

```
alias cd='source /somepath/cd.sh' 
```

这不起作用。

我尝试使用`eval "\cd xxx"`而不仅仅是`\cd xxx`;

如何修复我的脚本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T14:51:25.990

重写 感觉是个坏主意`cd`，所以我会建议一个稍微不同的命令，`fcd`：

```
fcd() { cd -- "$(dirname -- "$1")"; }

$ fcd /usr/bin/somefile.pl
$ pwd
/usr/bin 
```

或者使用参数扩展来保存调用`dirname`：

```
fcd { cd -- "${1%/*}"; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:57:34.700

```
cd() {
    DN="$(dirname "$1")"
    if [[ -d "$1" ]]; then
        builtin cd "$1"
    elif [[ -d "$DN" ]]; then
        builtin cd "$DN"
    else
        echo "$* or $DN: No such directories"
        return 1
    fi
    return 0
} 
```

# php - 如何在另一个使用 Javascript .load() 加载的 PHP 页面中运行/执行表单而不刷新父 PHP 页面？

> ID：10654795
> 
> 赞同：-1
> 
> 时间：2012-05-18T14:46:31.087
> 
> 标签：php, javascript, jquery

很抱歉标题很长，但这正是我要找的。

我有一个 PHP 页面（我们称之为父页面），它使用以下代码在一个 div 中加载另一个（子页面）：

```
$("#compose_inputandoptions").load("compose_inputandoptions.php"); 
```

在名为“compose_inputandoptions.php”的子页面中，我有一个这样的表单：

```
<?php>    
echo $_POST['option'];
?>
<form action="" method="post">
    <p>
    <input type="text" name="option" />
    <input type="submit" value="Valider" />
    </p>
</form> 
```

当我提交子页面中的表单
而不刷新父页面时，如何获取子页面中 $_POST['option'] 的值？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:55:03.047

Ajax POST 提交到您的撰写页面并将结果加载到 div 中：

```
$.post("compose_inputandoptions.php",
       {option : "something"},
       function(data) { $('#compose_inputandoptions').html(data);},
       "html"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:49:15.157

> ### [。加载（）](http://api.jquery.com/load/)
> 
> 如果数据作为对象提供，则使用 POST 方法；否则，假定为 GET。

```
$('#compose_inputandoptions')
    .load('compose_inputandoptions.php',{
        option : 'foo'
    }); 
```

* * *

要提交表单并刷新加载的子项，请执行`$.post()`. 在问题中没有提供任何其他详细信息的情况下，我将处理程序附加到`document`父级的处理程序并一般收听表单。

```
$(document).on('submit','form',function(){

    //reload child content
    $.post('compose_inputandoptions.php',{
        option : 'foo'
    },function(html){
        $('#compose_inputandoptions').html();
    });

    return false;
}); 
```

# ldap - LDAP 过滤器布尔表达式最大参数数

> ID：10654796
> 
> 赞同：0
> 
> 时间：2012-05-18T14:46:38.963
> 
> 标签：ldap, ldap-query, tivoli

当我遇到这个限制时，我正在编写一个小测试用例，看看哪个更有效，多个小查询或单个大查询。

查询如下所示：

```
(| (clientid=1) (clientid=2) (clientid=3) ...) 
```

当客户数量超过*2103 时？！*LDAP 服务器抛出错误：

```
error code 1 - Operations Error 
```

据我所知，实际过滤器字符串长度无关紧要 ~69KB（[至少对于 Microsoft AD，长度限制为 10MB](https://stackoverflow.com/a/556711/281252)）。我尝试使用更长的属性名称并得到了同样奇怪的限制：2103 个操作数

1.  有没有人有关于这个限制的更多信息？
2.  这是 LDAP 协议规范中指定的内容还是特定于实现？
3.  是否可配置？

我使用[UnboundID](http://www.unboundid.com/products/ldap-sdk/)和[JNDI](http://www.javaworld.com/javaworld/jw-03-2000/jw-0324-ldap.html) Java 库针对*IBM Tivoli Directory Server V6.2对此进行了测试。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T18:43:25.300

它不能超过 8099 个字符。请参阅[http://www-01.ibm.com/support/docview.wss?uid=swg21295980](http://www-01.ibm.com/support/docview.wss?uid=swg21295980)

此外，您正在做的不是一个好习惯。如果这些条目有共同的属性（例如，国家代码、部门编号、位置等），请尝试使用这些属性为您提供的通用标准检索结果。如果没有，请将您的搜索过滤器分成较小的过滤器，每个过滤器的谓词很少，并执行多个搜索。这取决于您用于执行此操作的编程语言，但请尝试在单独的线程中执行每个搜索以加快数据检索过程。

# vba - 如何使用 VBA 在字符串中列出工作簿中的所有工作表？

> ID：10654797
> 
> 赞同：4
> 
> 时间：2012-05-18T14:46:45.347
> 
> 标签：vba, worksheet

如何使用 VBA 获取活动工作簿中所有工作表（或最多三个）的名称以作为字符串返回？对于上下文，我将在保存工作簿时使用该字符串命名工作簿。我已经想出了如何使用输入对话框等为文件创建保存名称，所以这只是让 VBA 返回类似“[工作表 1 名称] 和 [工作表 2 名称]”的情况。

非常感谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-18T14:51:14.087

```
Option Explicit

Sub namesheets()

Dim wks as Worksheet, strName as String

For each wks in Worksheets
     strName = strName & wks.Name
Next

End Sub 
```

您还可以搜索“Excel vba 循环通过工作簿中的工作表”或类似的内容，并很容易找到答案。

此外，这个问题是在这个网站上以某种形式提出的。见链接...[循环工作表的子集](https://stackoverflow.com/questions/1591442/excel-vba-how-to-loop-through-a-subset-of-worksheets)

# php - 未找到“GET /portfolio”的路线

> ID：10654798
> 
> 赞同：1
> 
> 时间：2012-05-18T14:46:59.003
> 
> 标签：php, symfony

我在 symfony2 中创建了一个非常基本的静态页面，但没有找到路由错误，并且我已经为我的页面定义了路由。

我的控制器

```
#src/IDP/IDPBundle/Controller/PortfolioController.php
<?php
  namespace IDP\IDPBundle\Controller;
  use Symfony\Bundle\FrameworkBundle\Controller\Controller;
  class PortfolioController extends Controller
  {
   public function indexAction()
   {
    return $this->render('IDPIDPBundle:Portfolio:index.twig');
   }
  } 
```

我的 routing.yml 文件

```
#src/IDP/IDPBundle/resources/config/routing.yml
IDPIDPBundle_portfolio:
pattern:  /portfolio
defaults: { _controller: IDPIDPBundle:Portfolio:index }
requirements:
    _method:  GET 
```

我在应用程序中的路由文件

```
#app/config/routing.yml
IDPIDPBundle:
resource: "@IDPIDPBundle/Resources/config/routing.yml"
prefix:   /

# Internal routing configuration to handle ESI
#_internal:
#   resource: "@FrameworkBundle/Resources/config/routing/internal.xml"
#   prefix:   /_internal 
```

当我在浏览器中尝试这个 url 时，symfony 欢迎页面出现

```
 http://project.dev/app_dev.php/ 
```

但是当我尝试

```
http://project.dev/app_dev.php/portfolio 
```

它没有找到路线错误

我在这里做错了什么？

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T13:25:44.793

确保您所做的更改不仅在 Eclipse 的工作空间中受到项目根目录的影响。将您的 Eclipse 工作空间更改为您的项目根目录，然后

```
IDPIDPBundle:
 resource: "@IDPIDPBundle/Resources/config/routing.yml"
 prefix:   /

IDPIDPBundle_portfolio:
 pattern:  /portfolio
 defaults: { _controller: IDPIDPBundle:Portfolio:index }
 requirements:
 _method:  GET 
```

希望它会有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T11:02:14.083

我认为您的代码路由是正确的。但输入的网址不正确。您没有`web`指向`app_dev.php`. 可能这是你的问题。

而不是这个网址 [http://project.dev/app_dev.php/portfolio](http://project.dev/app_dev.php/portfolio)试试下面的网址

```
 http://project.dev/web/app_dev.php/portfolio 
```

希望`project.dev`是您的项目文件夹。

第二件事我注意到你必须真正关心 routing.yml 文件的缩进。

```
IDPIDPBundle:
  resource: "@IDPIDPBundle/Resources/config/routing.yml"
  prefix:   /

IDPIDPBundle_portfolio:
  pattern:  /portfolio
  defaults: { _controller: IDPIDPBundle:Portfolio:index }
  requirements:
     _method:  GET 
```

希望这可以帮助。

# isset - 如何在 $_POST 更新查询中定义 isset($_GET['id']) 语句

> ID：10654799
> 
> 赞同：0
> 
> 时间：2012-05-18T14:47:02.263
> 
> 标签：isset

我从显示表中携带“ID”，并希望将其存储在名为employee_display_id 的变量中。我知道，如果您不创建以下功能...

```
if(sset($_GET['id'])){
  $employee_display_id = $_GET['iod'];
} 
```

并且您继续使用 '$employee_display_id' 变量，您会收到未定义的变量错误。

你如何融入...

```
if(sset($_GET['id'])){
  $employee_display_id = $_GET['iod'];
} 
```

进入...

```
if(isset($_POST['update']))
{
  $updatename          = htmlentities(strip_tags(mysql_real_escape_string($_POST['update_name'])));
  $updateusername      = htmlentities(strip_tags(mysql_real_escape_string($_POST['update_username'])));

  echo $update_query = "UPDATE `employees` SET `name`='$updatename', `username`='$updateusername' WHERE `employee_id`='4'";/* $employee_display_id */
  $update_result = mysql_query($update_query);
}
  else
{
  echo mysql_error();
} 
```

所以我可以在 UPDATE 查询的 WHERE 子句中使用变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T15:23:55.250

您可以使用简写 if 来确定是否在更新命令中设置了变量，但您需要将其设置为某个值，否则查询将无法按预期运行。

我建议检查变量是否在 SQL 之前设置。如果未设置，则不执行查询。

```
if(isset($employee_display_id)){
  echo $update_query = "UPDATE `employees` SET `name`='$updatename', `username`='$updateusername' WHERE `employee_id`=" . $employee_display_id;
  $update_result = mysql_query($update_query);
} else {
  echo "ID not set."
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T15:19:47.203

Nazneen 有一个观点。仔细检查您的变量名称。

另外，你知道 GET 和 POST 之间的区别吗？它们是如何工作的？大概，您想从表中的更新链接更新员工数据？因此，您的链接将类似于[http://example.com/update.php?id=6](http://example.com/update.php?id=6)

那么，在本例中，GET['id'] 将返回 6，然后您可以将其与您的代码一起使用并将其传递给您的 SQL 查询。

例子：

```
if(isset($_POST['update']))
{
    if(isset($_GET['id'])){
        $employee_display_id = $_GET['id'];
    }
    if(isset($_POST['update_name'])){
    $updatename = htmlentities(strip_tags(mysql_real_escape_string($_POST['update_name'])));
    }
    // and so on...
} 
```

这是否回答你的问题？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T15:05:08.710

您正在检查 isset`$_GET['id']`并分配`$_GET['iod']` itz "iod" yu 正在分配。你确定这个变量赋值了吗？？？

# c# - 实体框架无法正常工作（表属性未加载智能）

> ID：10654805
> 
> 赞同：0
> 
> 时间：2012-05-18T14:47:21.193
> 
> 标签：c#, visual-studio-2010, entity-framework

我使用 Ado.net EntityFramework 向导将我的数据库和表添加到项目中。所有必要的 dll 加载。但我看不到/到达我的表的字段（id - name - creationDate 等字段）这是代码；

```
 using CampaignManager.Database;

namespace CampaignManager.CampignController
{
    public class CampignController
    {
        public void UpdateCampaignWithCampaignId(int campaignId, Campaign campaign)
        {
            using (CampaignEntities db = new CampaignEntities())
            {
                //db.CampaignEntities.Where(item => item.)

                //Campaign gettingCampaign = (from entry in db.Campaign where entry. == campaignId select entries);
            }
        }
    .... 
```

这是图片| EntityFramework - 在问号上我看不到我的表格的列名； ![EntityFramework - 我在点后看不到表格的列名 - 在问号上](../Images/3189e025cf8c7108fe33cdf94f9082de.png)

我已经尝试使用 nu-get 管理器添加实体框架。关闭并重新打开视觉工作室等。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:18:30.760

尝试添加 using 语句：

```
using System.Linq;
using System.Linq.Expressions; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T16:23:01.977

您确定 Campaign 是实体集吗？我希望它是 db.Campaigns，而实体是 Campaign，默认情况下？

# iis - 为什么我的 DNN 友好 url 重定向没有生效？

> ID：10654807
> 
> 赞同：2
> 
> 时间：2012-05-18T14:47:25.930
> 
> 标签：iis, dotnetnuke

我已将以下 XML 添加到我的`SiteUrls.config`文件中：

```
 <RewriterRule>
      <SendTo>/pod/</SendTo>
      <LookFor>.*abcdefg</LookFor>
    </RewriterRule> 
```

当我去`http://localhost/abcdefg`它成功将我重定向到`http://localhost/pod`. 我的本地主机是 IIS 7 Web 服务器。

但是，我无法在我们的生产或登台机器上获得相同的确切配置。它保持打开`http://staging.x.com/abcdefg`并给出 404 错误。

究竟需要设置什么才能使其正常工作？我没有注意到我在本地拥有的 IIS 模块与生产/登台系统上的 IIS 模块之间有太大区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:10:05.460

您可能需要安装[修补程序](http://support.microsoft.com/kb/980368)以支持 IIS 7 上的无扩展 URL。

[从汉塞尔曼](http://www.hanselman.com/blog/BackToBasicsDynamicImageGenerationASPNETControllersRoutingIHttpHandlersAndRunAllManagedModulesForAllRequests.aspx)：

> 让[在 IIS6 上工作的无扩展 URL 以前很棘手，](http://haacked.com/archive/2010/12/22/asp-net-mvc-3-extensionless-urls-on-iis-6.aspx)而且很多人都在上面写过。在 IIS6 和 ASP.NET MVC 的早期，您将映射所有内容*。*到托管代码。[在创建无扩展 URL 功能](http://blogs.msdn.com/b/tmarq/archive/2010/06/18/how-to-disable-the-asp-net-v4-0-extensionless-url-feature-on-iis-6-0.aspx)之前，ASP.NET 路由要求将 RAMFARR 设置为 true 。
> 
> 此 KB [http://support.microsoft.com/kb/980368](http://support.microsoft.com/kb/980368)中添加了无扩展 URL 支持，并随 ASP.NET MVC 4 一起提供。如果您有 ASP.NET MVC 4，那么您的开发计算机上就有无扩展 URL。但是您的服务器可能不会。您可能需要安装此修补程序，或打开 RAMMFAR。如果可以避免的话，我宁愿你安装更新而不是打开 RAMMFAR。**Run All Modules 选项实际上是一个通配符映射。**

# cocoa-touch - iOS 在同一 viewController 的视图之间切换

> ID：10654808
> 
> 赞同：0
> 
> 时间：2012-05-18T14:47:32.150
> 
> 标签：cocoa-touch, uiviewcontroller

我在同一个 viewController 上有三个视图，我需要在它们之间切换。最好的方法是什么？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:53:02.280

好吧，我不确定您是否已明确提出问题。我想您想一次显示一个视图。在这种情况下：-

1>您可以水平添加视图`UIScrollView`，其框架大小等于屏幕或您想要的任何区域（宽度应等于屏幕宽度..一次显示 1 个）以及 UIPageControl。

2>另一种方法是使用方法：-

```
 [self.view bringSubViewToFront:yourSubView];

   [self.view sendSubViewToBack:yourSubView ]; 
```

根据您的要求。

3>您可以使用动画在视图之间切换。

```
[UIView animateWithDuration:0.7
                      delay:1.2
                    options: UIViewAnimationCurveEaseOut
                 animations:^{
                 CGRect frame=assignAframeToSwitch;
                     yourView.frame = frame;

                 } 
                 completion:^(BOOL finished){
                     NSLog(@"Done!");
                 }];

                 OR

    _Weak CATransition *transition;
    transition = [CATransition animation];
transition.delegate=self;
    transition.duration = 0.75;
    transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];

    [[viewcontroller layer] addAnimation:transition forKey:@"transition"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:53:19.373

CATransition 是动画过渡的最佳方式

```
CATransition* trans = [CATransition animation];

[trans setType:kCATransitionPush];

[trans setDuration:0.5];

[trans setSubtype:kCATransitionFromBottom];

// code to change the view//

CALayer *layer = rootViewController.view.layer;

[layer addAnimation:trans forKey:@"Transition"]; 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T15:16:10.377

最简单的方法是使用内置的基于块的 UIView 过渡动画。只需查看 UIView 的文档即可。它比 CATransition 方法更简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T14:52:12.720

如果您使用此波纹管代码进行动画转换，然后只需要在按钮单击事件上隐藏和显示视图...

```
CATransition *animation = [CATransition animation];
    [animation setDelegate:self];   
    [animation setType:kCATransitionFromBottom];
    [animation setDuration:1.0];
    [animation setTimingFunction:[CAMediaTimingFunction functionWithName:
                                  kCAMediaTimingFunctionEaseInEaseOut]];
    [[yourViewControllers layer] addAnimation:animation forKey:@"transitionViewAnimation"]; 
```

希望，这对你有帮助.. :)

# php - 检查 PHP 类中的会话变量

> ID：10654809
> 
> 赞同：1
> 
> 时间：2012-05-18T14:47:36.220
> 
> 标签：php, oop, session

在我的索引页面的顶部，使用以下命令设置会话：

```
$_SESSION['language'] = 'english'; 
```

当我回显 $_SESSION['language'] 它回显'english'，但是会话值在 PHP 类中不可读，这是为什么呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:55:31.307

您必须先调用`session_start()`，然后才能访问`$_SESSION`超级全局

[PHP session_start() 文档](http://php.net/manual/en/function.session-start.php)

# jakarta-ee - 避免验证失败后显示空白页面

> ID：10654810
> 
> 赞同：0
> 
> 时间：2012-05-18T14:47:41.117
> 
> 标签：jakarta-ee, glassfish, spnego

*[CentOS 5.3、glassfish 3.1.1、jdk1.6.30 64bit、spnego R7]*

我定义了一个 SPNEGO 过滤器来使用 Kerberos（基本模式）针对 AD 对用户进行身份验证。如果用户提供适当的凭据，则页面内容将发送给用户。但是如果认证不成功，则会向客户端返回一个带有 401 错误的空页面。我在 web.xml 中定义了一个 401 错误页面。

我的问题是：如果 SPNEGO 身份验证（==SPNEGO 过滤器）失败，如何向用户发送任何内容？我必须定义一些 SPNEGO 参数吗？或者如果之前的过滤器没有返回任何内容，我应该添加另一个过滤器来添加“登录失败”的内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T13:42:56.703

我认为 web.xml 中的错误页面设置应该做你想做的，但 SPNEGO 应该发送 403（登录失败）而不是 401（未授权）。我有一个类似的环境，但 SPNEGO 返回状态代码 403，它映射在我的 web.xml 中，如下所示：

```
<error-page>
    <error-code>403</error-code>
    <location>/access-forbidden.xhtml</location>
</error-page> 
```

# css - 无法使用 CSS 将 3 张相邻照片居中

> ID：10654811
> 
> 赞同：0
> 
> 时间：2012-05-18T14:47:41.133
> 
> 标签：css, gallery, photos, centering

我正在使用 javascript 和 css 构建照片库查看器，但我无法将元素居中。我有一张后退箭头照片、照片本身和下一个箭头。这 3 张照片彼此相邻，我需要将这三张照片都居中。任何帮助表示赞赏，而且，我对 css/javascript/html 有点陌生，所以不要对我这么苛刻。谢谢你，盖伊 Z。

（你可以去 guyzyl.org，进入任何画廊，然后点击一张照片来看看我的意思，以及我想要集中的内容）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:00:50.753

这种风格应该有助于：

```
#viewer {
   text-align: center;
   white-space: nowrap;
} 
```

此外，使用 DOCTYPE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:57:38.523

你需要给

```
<div id="viewer"></div> 
```

固定宽度并将其左右边距设置为自动。

CSS 看起来像这样：

```
#viewer{
    width:500px;
    margin-left:auto;
    margin-right:auto;
} 
```

为防止箭头环绕，您需要调整照片的大小以适合查看器的宽度减去箭头的宽度以及它们上的任何填充、边距或边框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T15:03:23.553

刚刚看了你的网站。尝试将下面的 CSS 添加到查看器 div 的样式中

```
margin: auto; 
```

那“应该”将 div 在屏幕上居中。假设浏览器窗口中有足够的空间。

# objective-c - 将对象从无弧编译类传递到弧启用类？

> ID：10654813
> 
> 赞同：2
> 
> 时间：2012-05-18T14:47:47.513
> 
> 标签：objective-c

我在尝试使用 facebook-ios-sdk 修复内存泄漏时遇到了这个问题。将对象从没有弧编译的类传递到启用弧的类时，我该如何处理这种情况？

这是非弧编译 Facebook 库中的代码：（我删除了与问题无关的不必要的东西）如您所见，结果对象没有自动释放或释放。

```
- (void)handleResponseData:(NSData *)data {        
    NSError* error = nil;
    id result = [self parseJsonResponse:data error:&error];
    self.error = error;

    // Call the defined delegate wich is my AppDelegate didLoad method wich is arc enabled
    [_delegate request:self didLoad:result];
}

- (id)parseJsonResponse:(NSData *)data error:(NSError **)error {
    SBJSON *jsonParser = [[SBJSON alloc] init];

    //gets the object wich leaks or gets overreleased
    id result = [jsonParser objectWithString:responseString];
    [jsonParser release];

    return result;
} 
```

现在，如果我尝试将 autorelease 添加到结果对象，当我的 AppDelegate 中的 arc 代码尝试释放对象时，我将面临 NSZombie。但是，如果我留下这样的代码，我将面临内存泄漏，结果对象没有被释放。

我错过了一些基本的东西吗？我无法理解这个？

感谢您的任何建议！克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:54:47.027

`result`返回的 from已经`-parseJsonResponse:...` *自动*释放（参见底部的注释）。

由于`-parseJson`方法的名称不是以 new、alloc、copy 或 mutableCopy 开头，因此编译器假定它返回一个引用计数为 +0 的对象，这意味着如果要保留它，则需要由调用代码保留它周围，​​如果没有被保留，则不需要释放*。*这是一种冗长的说法，即它既不应该泄漏也不应该导致你的 ARC 代码崩溃，正如你在问题中所写的那样。

在 ARC 代码和手动引用计数代码之间传递对象不需要任何特殊处理。您只需要确保方法的名称与它们在非 ARC 代码中的内存管理语义相匹配。在这种情况下，您似乎确实做到了，尽管正如您所说，您没有发布完整的代码。

注意：大概会`objectWithString:`返回一个自动释放的对象。如果不是，它应该（因为它不以 alloc、new、copy、mutableCopy 开头）。

# java - 当我按下按钮时如何在选择中添加项目？

> ID：10654819
> 
> 赞同：2
> 
> 时间：2012-05-18T14:48:00.570
> 
> 标签：java, swing

当我按下按钮时，我想在选择中添加一个项目......

意味着假设当我按下按钮“你好”时，这个按钮的名称应该被添加到我的选择中（假设它的对象是`ch`），所以在`public void actionPerformed(ActionEvent ae)`我写的方法中`ch.add(ae.getActionCommand());`......

当我当时这样做时，“你好”被添加到我的选择中，但是当我从我的项目中注销并再次登录时，它就会消失......

我不知道该怎么办？

实际上，我希望在我的基于**GUI** & **Java**和**DBMS**的项目中使用它......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:44:10.413

考虑使用[Preferences API](http://docs.oracle.com/javase/6/docs/technotes/guides/preferences/overview.html)。它是管理首选项和配置数据的标准机制。

# variables - lua 变量范围

> ID：10654823
> 
> 赞同：5
> 
> 时间：2012-05-18T14:48:10.547
> 
> 标签：variables, scope, lua, global-variables

我知道还有其他类似的主题，但找不到我的问题的直接答案。

假设您有一个函数，例如：

```
function aFunction()
  local aLuaTable = {}
  if (something) then
     aLuaTable = {}
  end
end 
```

对于 if 语句中的 aLuaTable 变量，它仍然是本地的吗？基本上我要问的是，如果我第一次将一个变量定义为本地变量，然后我一次又一次地使用它，它会在程序的余生中保持本地状态，这究竟是如何工作的？

此外，我阅读了 Lua 全局变量的定义：

> 任何不在定义块中的变量都被称为在全局范围内。所有内部范围都可以访问全局范围内的任何内容。

不在定义的块中是什么意思？我的理解是，如果我在任何地方“声明”一个变量，它将始终是全局的，这不正确吗？

对不起，如果问题太简单了，但是来自 Java 和 Objective-c，lua 对我来说很奇怪。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T17:05:44.817

> “任何不在定义块中的变量都被称为在全局范围内。”

这是完全错误的，所以你的困惑是可以理解的。看起来你是从用户 wiki 那里得到的。我刚刚用更正信息更新了页面：

任何未定义的变量`local`都是全局变量。

> 我的理解是，如果我在任何地方“声明”一个变量，它将始终是全局的

如果您不将其定义为`local`，它将是全局的。但是，如果您随后创建`local`具有相同名称的 a，它将优先于全局（即 Lua 在尝试解析变量名称时首先“看到”局部变量）。请参阅本文底部的示例。

> 如果我第一次将一个变量定义为本地变量，然后我一次又一次地使用它，它将在程序的剩余生命周期中保持本地，**这究竟是如何工作的？**

当你的代码被编译时，Lua 会跟踪你定义的任何局部变量，并知道在给定范围内哪些是可用的。每当您读/写一个变量时，如果在范围内有一个具有该名称的局部变量，就会使用它。如果没有，则读/写被转换（在编译时）为表读/写（通过表_ENV）。

```
local x = 10 -- stored in a VM register (a C array)
y = 20       -- translated to _ENV["y"] = 20

x = 20       -- writes to the VM register associated with x
y = 30       -- translated to _ENV["y"] = 30

print(x)     -- reads from the VM register
print(y)     -- translated to print(_ENV["y"]) 
```

局部变量是词法范围的。其他的都进去了`_ENV`。

```
x = 999

do -- create a new scope
    local x = 2
    print(x)      -- uses the local x, so we print 2
    x = 3         -- writing to the same local
    print(_ENV.x) -- explicitly reference the global x our local x is hiding
end

print(x) -- 999 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T15:17:14.120

> 对于 if 语句中的 aLuaTable 变量，还是局部的吧？

我不明白您在这里感到困惑；该规则与 Java 完全相同。该变量仍在范围内，因此它继续存在。

`local`变量相当于在 Java 中定义“堆栈”变量。该变量存在于定义它的块范围内，并且在该块结束时不再存在。

考虑以下 Java 代码：

```
public static void main()
{
  if(...)
  {
    int aVar = 5; //aVar exists.
    if(...)
    {
      aVar = 10; //aVar continues to exist.
    }
  }

  aVar = 20; //compile error: aVar stopped existing at the }
} 
```

“全局”只是任何*非*本地的变量名。考虑与上述等效的 Lua 代码：

```
function MyFuncName()
  if(...) then
    local aVar = 5 --aVar exists and is a local variable.

    if(...) then
      aVar = 10 --Since the most recent declaration of the symbol `aVar` in scope
                --is a `local`, this use of `aVar` refers to the `local` defined above.
    end
  end

  aVar = 20 --The previous `local aVar` is *not in scope*. That scope ended with
            --the above `end`. Therefore, this `aVar` refers to the *global* aVar.
end 
```

Java 中的编译错误是完全有效的 Lua 代码，尽管它可能不是您想要的。

# php - 将可选数量的参数传递给另一个函数

> ID：10654839
> 
> 赞同：1
> 
> 时间：2012-05-18T14:49:25.493
> 
> 标签：php

假设我有一个函数`addUp`，它接受任意数量的十进制参数并返回它们全部相加的结果。

如果我有以下功能：

```
function myTest(){
    $args = func_get_args();
    return addUp($args);
} 
```

如果我`myTest(1,2,3)`显然调用这将不起作用，因为我只传递一个参数`addUp`，那就是一个数组。

有没有办法将传入的所有参数传递`myTest`给`addUp`函数（不编辑`addUp`函数）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T15:01:15.090

你可以使用[call_user_func_array](http://php.net/manual/en/function.call-user-func-array.php)

它使用从数组派生的参数调用一个函数（这是您从中得到的`func_get_args()`）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-18T14:58:14.327

您可以传入一个数组，然后遍历它。

```
$args = array(1, 2, 3, 4);

function myTest($arr){
    $r = 0;
    foreach($arr as $value){
        $r += intval($value);
    }

    return $r;
}

echo myTest($args); 
```

# c# - Entitystate.Modified mvc3 引用对象未保存

> ID：10654842
> 
> 赞同：1
> 
> 时间：2012-05-18T14:49:36.490
> 
> 标签：c#, asp.net-mvc-3, entity-framework

我在保存我的教练对象时遇到问题。除了教练，一切都得到了保存。我查看了对象训练并填写了所有属性。（还有位置和训练器的属性）我没有收到错误，但训练器对象没有被保存。

这是我的代码：

```
 Context db=new Context();

    public void modifieTraining(Training training)
    {
        db.Entry(training.Location).State = EntityState.Modified;
        db.Entry(training.Trainer).State = EntityState.Modified;
        db.Entry(training).State = EntityState.Modified;
        db.SaveChanges();
    } 
```

这是我得到的唯一对象：

```
 @Html.DropDownList("trainer", new SelectList(ViewBag.Trainer, "TrainerId", "Firstname"), "Selecteer een trainer")
  @Html.TextBoxFor(model => model.Location.Address)
  @Html.TextBoxFor(model=>model.Location.City)
  ... 
```

稍后在我的控制器中：

```
 public ActionResult EditTraining(int id, Training training, string trainer)
    {
            if (trainer != null && trainer!="Selecteer een trainer" )
            {
                training.Trainer = repository.getTrainer(Convert.ToInt32(trainer));
            }
            repository.modifieTraining(training);

            return RedirectToAction("Index");
     } 
```

* * *

出于某种奇怪的原因，当我重新启动机器时，一切都很好。但是当我打开 sql server management studio 时。它仍然向我显示 NULL 值。但是当我执行 get 方法时，会显示正确的值。

可能是因为该字段可以为空吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T16:54:52.643

请原谅我的第一个答案。但是我现在发现了问题。问题是我并没有真正修改任何东西。我只是向对象添加了一个培训师，但培训师对象本身没有被修改，所以没有任何改变。

模型是这样的：

```
 public class Training
  {
    [Key]
    public int TrainingId { get; set; }

    public Trainer Trainer{get; set;}
    ....
  } 
```

在模型中添加：

```
 public int? TrainerId{get; set;} 
```

控制器：

```
 public ActionResult EditTraining(int id, Training training, string trainer)
  {
        if (trainer != null && trainer!="Selecteer een trainer" )
        {
            training.Trainer = repository.getTrainer(Convert.ToInt32(trainer));
            trainingDetail.TrainerId = trainingDetail.Trainer.TrainerId;
         }
         repository.modifieTraining(training);
  } 
```

感谢您的所有帮助，并对愚蠢的答案感到抱歉。

# mysql - 使用 long long IN 条件执行 SQL 查询的替代方法

> ID：10654843
> 
> 赞同：2
> 
> 时间：2012-05-18T14:49:44.610
> 
> 标签：mysql

我有一个这样的 SQL 查询：

```
SELECT  DISTINCT `User`.*
FROM    `user` AS `Users`
WHERE   `Users`.`group_id` IN (1,2,3,4,5,6,7,8,9,10........) 
```

我的问题是 IN 条件可能非常长我想问是否有人对没有这个问题的替代方法有一些想法？我的 SHOW CREATE TABLE 用户是

```
CREATE TABLE users (
  id int(10) unsigned NOT NULL AUTO_INCREMENT,
  username char(50) COLLATE utf8_unicode_ci DEFAULT NULL,
  password char(40) COLLATE utf8_unicode_ci DEFAULT NULL,
  first_name varchar(32) COLLATE utf8_unicode_ci DEFAULT NULL,
  last_name varchar(32) COLLATE utf8_unicode_ci DEFAULT NULL,
  email varchar(64) COLLATE utf8_unicode_ci DEFAULT NULL,
  group_id int(10) unsigned NOT NULL,
  PRIMARY KEY (id) ) ENGINE=InnoDB AUTO_INCREMENT=45
  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci 
```

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:06:52.813

不用在查询之间通过 传递值`PHP`，只需在 MySQL 本身中执行（使用`JOIN`）：

```
SELECT  DISTINCT `Users`.*
FROM    (
        SELECT  id
        FROM    your_query
        ) q
JOIN    `user` AS `Users`
ON      `Users`.group_id = q.id 
```

创建索引`user.group_id`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T15:21:05.457

我已经为这样的任务创建了*处理表*，我会截断这些表，然后填充我需要用于后续查询的数据。这主要是在我将数据从一组表移动到另一组表以进行报告的非实时情况下完成的。

基本上我会做类似的事情：

```
# clear out the staging table (or maybe create a temporary table if that makes sense for you)
truncate staging_table

# go fetch all the group_id's needed into this staging table
INSERT INTO staging_table table
SELECT  distinct group_id
FROM ... 

# Now get all the users like so:
SELECT  DISTINCT `User`.*
FROM    `user` AS `Users` 
  JOIN staging_table on `Users`.`group_id` = staging_table.group_id; 
```

*IN LIST*现在消失了，因为基本上所有你想要的 group_id 都在一个表中。

这可能会更慢，因为您将其分解为 2 个查询而不是 1 个。然而，在我的情况下，我所拥有的一些“列表”实际上是十万之多，而 MySQL（至少在当时）会扼杀它们。

几点注意事项：

*   如果这是多个用户可以同时执行此操作的事情，您可能需要使用 TEMPORARY TABLES 来分隔用户。

*   有时当我向工作表添加多个列时，我从向工作表中添加索引中获得了很好的效果。

# javascript - 以 JSON 格式重新加载/刷新页面

> ID：10654849
> 
> 赞同：1
> 
> 时间：2012-05-18T14:49:57.823
> 
> 标签：javascript, ruby-on-rails, json, mobile

我正在将网站转换为移动应用程序，为此我需要以 JSON 格式获取输出。一切正常，但问题是当我添加/编辑它并在表中实际更新但在 JSON 输出中它显示旧值时。

例如

```
 result = App::Web::AddAddress.create_edit(
    :controller => self,
    :client => @client,
    :data => @request_data,
    :language => 'en',
    :create => 1
  )
  if result.success == true
    return view_address_list
  end
   rescue
  return fail_request 
```

我的问题是，如果它成功返回到 view_address_list 旧值（即使它更新数据库中的值）。如果我再次运行 view_address_list，它会显示更新的值，我确定我需要刷新/重新加载该方法。有没有办法在返回成功时重新加载/刷新 view_address_list 方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:33:00.843

我认为一旦你开始开发你的移动应用程序，你的大部分请求将使用 AJAX 发送，你会收到 JSON 响应，你可以在你的应用程序中解析和使用。只要您不缓存此响应，您就会在每个响应中收到新值。如果您使用 jQuery Mobile（一种流行的选择），则尤其如此，它主要基于 AJAX 请求。

处理您的回复的快速（虚假）方式

```
//...
success: function(data) {
  $.each(data, function(i, address) {
    address.content.appendTo('#list');
  });
},
//... 
```

# jquery - jQuery colorbox onclose 更新父级

> ID：10654850
> 
> 赞同：2
> 
> 时间：2012-05-18T14:49:58.120
> 
> 标签：jquery, forms, colorbox

可以帮到大家。

所以我使用 jQuery colorbox 并通过单击链接激活它。在颜色框中有一个带有一些复选框的表单，我想做的是在单击提交时将所选复选框的所有值都放入父级（并随后关闭颜色框）。我不希望父窗口刷新。它应该使用内容自动填充“Colorbox 中的复选框项目”

这是链接[http://tdesigns.net84.net/colorbox/example1/](http://tdesigns.net84.net/colorbox/example1/)

```
Parent code

<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'/>
        <title>ColorBox Examples</title>
        <style>
            body{font:12px/1.2 Verdana, sans-serif; padding:0 10px;}
            a:link, a:visited{text-decoration:none; color:#416CE5; border-bottom:1px solid #416CE5;}
            h2{font-size:13px; margin:15px 0 0 0;}
        </style>
        <link rel="stylesheet" href="colorbox.css" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
        <script src="../colorbox/jquery.colorbox.js"></script>
        <script>
            $(document).ready(function(){
                $(".iframe").colorbox({iframe:true, width:"400px", height:"400px"});                
            });
        </script>
    </head>
    <body>
        <p><a class='iframe' href="../content/ajax.html">Outside Webpage (Iframe)</a></p>
        <p>
            Checkbox Items from Colorbox
        </p>
    </body>
</html>

popup code

<form action="" method="post">
    Choose a country 
    <br /><br />
    <input type="checkbox" name="countryCheckbox[]" value="UK" />UK<br />
    <input type="checkbox" name="countryCheckbox[]" value="USA" />USA<br />
    <input type="checkbox" name="countryCheckbox[]" value="Japan" />Japan<br />
    <input type="checkbox" name="countryCheckbox[]" value="China" />China<br />
    <input type="checkbox" name="countryCheckbox[]" value="Australia" />Australia
    <br /><br />
    <input type="submit" name="formSubmit" value="Submit" />
</form> 
```

如果我能得到一些帮助，我将不胜感激。

提前谢谢了

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T15:36:20.943

您可以通过在`ajax.html`文件中添加以下函数来做到这一点

首先在该文件中加载 jQuery，然后添加此文档准备功能

```
$(document).ready(function(){
        $('#form').submit(function(){

                    $('input:checkbox:checked').each(function(){
                        window.parent.$("#text").text(parent.$("#text").text() + $(this).val()+" ,");

                    });
                    parent.$.colorbox.close();
                    return false;
        });             
    }); 
```

这样做是当用户单击它需要所有选中的复选框`submit button`时`overlay iframe`，将这些值添加到父窗口的文本 div 中，然后关闭颜色框窗口。

`ajax.html`这是文件的修改代码

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<form action="" method="post" id='form'>
    Choose a country 
    <br /><br />
    <input type="checkbox" name="countryCheckbox[]" value="UK" />UK<br />
    <input type="checkbox" name="countryCheckbox[]" value="USA" />USA<br />
    <input type="checkbox" name="countryCheckbox[]" value="Japan" />Japan<br />
    <input type="checkbox" name="countryCheckbox[]" value="China" />China<br />
    <input type="checkbox" name="countryCheckbox[]" value="Australia" />Australia
    <br /><br />
    <input type="submit" name="formSubmit" value="Submit" />
</form>

<script>
    $(document).ready(function(){
        $('#form').submit(function(){

                    $('input:checkbox:checked').each(function(){
                        window.parent.$("#text").text(parent.$("#text").text() + $(this).val()+" ,");

                    });
                    parent.$.colorbox.close();
                    return false;
        });             
    });
</script> 
```

还要在将像这样添加值的段落中添加一个 id

```
<p id="text">
    Checkbox Items from Colorbox: 
</p> 
```

如果您有任何代码，则必须从`localhost`或相同运行代码，`virtualhost`否则将不允许从`child iframe`. 只需将修改后的文件放在您的文件夹中`document root`，然后通过浏览器访问它。让我知道它是否有效。

这是一个工作演示[http://joynag.net/demos/colorbox/](http://joynag.net/demos/colorbox/)

# sencha-touch-2 - 在 Sencha touch2 中如何启用浏览器的滚动条

> ID：10654851
> 
> 赞同：8
> 
> 时间：2012-05-18T14:49:58.650
> 
> 标签：sencha-touch-2

出于某种原因，我喜欢使用浏览器的原生滚动条而不是 sencha 的。

我已经将溢出设置为自动到正文，但直到我在 chrome 工具栏中手动将固定高度设置为“ext-viewport”，例如 2000px，仍然看不到滚动条。

看起来视口总是自动适应屏幕尺寸。是否有任何设置可以禁用此功能并启用浏览器的滚动？

提前致谢。

* * *

**5 月 19 日更新** 这里有一些进展，

1.  In `Ext.viewport.Android`->`doFixSize`将自动使视口适应屏幕大小，将其注释掉，然后设置/检测固定
2.  在`Ext.viewport.Default`，它吞下`touchstart/touchmove`事件，所以滚动条不起作用，通过设置`preventPanning/preventZooming`我`false`可以让滚动条工作。它的滚动速度比 sencha 的滚动条快得多 :)

轮播现在不好用，正在调查中...

* * *

**6月20日更新**

[由于以下错误http://code.google.com/p/android/issues/detail?id=19827](http://code.google.com/p/android/issues/detail?id=19827)，旋转木马不适用于 android 4 中的本机滚动条

使用原生滚动条，只有 touchstart 和第一个 touchmove 事件被调用，随后的 touchmove 和 touchend 会丢失，因此没有 e.preventDefault() 就无法实现轮播。

一种解决方法是监听触摸事件，当事件目标是轮播时，然后调用 e.preventDefault 来禁用本机滚动条....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:45:15.077

试试这个代码

`Ext.viewport.setScrollable(false); Ext.viewport.element.dom.childNodes[0].style.overflow = 'scroll';`

# c# - 通过电子邮件发送带有长名称和重音符号的附件

> ID：10654853
> 
> 赞同：3
> 
> 时间：2012-05-18T14:49:58.923
> 
> 标签：c#, email, encoding, diacritics, email-attachments

我们在发送包含带有长名称和口音的附件的电子邮件时遇到了问题。

大小或类型似乎不会影响结果（我尝试使用 txt 和 pdf，大小为 300kb 和 3833kb）

经过一番搜索，我发现这篇文章[http://social.msdn.microsoft.com/Forums/en-US/dotnetframeworkde/thread/b6c764f7-4697-4394-b45f-128a24306d55](http://social.msdn.microsoft.com/Forums/en-US/dotnetframeworkde/thread/b6c764f7-4697-4394-b45f-128a24306d55)展示了如何解决这个问题。

如果我的名字真的很长（见附件 2 变量名），它会起作用。但在名称稍短的情况下（参见附件 1 变量名称），名称显示为 -=_iso-8859-1_Q_Example,_Example_and_other_

我认为它与 SplitEncodedAttachmentName encodedAttachmentName = encodedAttachmentName.Remove(encodedAttachmentName.Length - encodingtoken.Length, encodingtoken.Length);

这是 vars attach1 的手表 - "=?ISO-8859-1?Q?Example=2c_Example_and_other_Repr=e9senta.txt?="

attach2 - "=?ISO-8859-1?Q?Example=2c_Example_and_other_Repr=e9sentant_Example_Examp?==?ISO-8859-1?Q?le_Example_Example_Example_Example2.txt?="

我似乎无法正确发送附件1..

（我过去确实回答过这个问题 - [MailMessage Attachment 文件名带有重音符号](https://stackoverflow.com/questions/5349887/mailmessage-attachment-filename-with-accents)，但我有一个错误，重构并遇到了这个问题..）

这是我能想到的导致错误的最小代码示例。

```
class Program
{
    static void Main(string[] args)
    {
        Attachment attachment = new Attachment(@"c:\client\temp\Example,_Example_and_other_Représenta.pdf"); //3488kb
        Attachment attachment2 = new Attachment(@"c:\client\temp\Example,_Example_and_other_Représentant_Example_Example_Example_Example_Example_Example.pdf"); //3488kb

        Console.WriteLine(attachment.Name);

        MailMessage mm = new MailMessage();
         mm.From = new MailAddress("toemail");
         mm.To.Add("toemail");
        mm.Subject = "Yo";
        mm.Body = "hello";
        mm.Attachments.Add(CreateAttachment(attachment, attachment.Name)); // =_iso-8859-1_Q_Example,_Example_and_other_
        mm.Attachments.Add(CreateAttachment(attachment2, attachment2.Name));

        SmtpClient smtp = new SmtpClient("SmptServer");
        smtp.Send(mm);
    }

    /// <summary>
    /// This method fixes the name of the attachment to allow accents
    /// </summary>
    /// <remarks>Taken from http://social.msdn.microsoft.com/Forums/en-US/dotnetframeworkde/thread/b6c764f7-4697-4394-b45f-128a24306d55</remarks>
    public static Attachment CreateAttachment(Attachment attachmentFile, string displayName)
    {
        Attachment attachment = attachmentFile;
        attachment.TransferEncoding = TransferEncoding.Base64;

        string tranferEncodingMarker = "Q";
        string encodingMarker = "ISO-8859-1";
        int maxChunkLength = 76;

        attachment.NameEncoding = Encoding.GetEncoding(encodingMarker);

        string encodingtoken = String.Format("=?{0}?{1}?", encodingMarker, tranferEncodingMarker);
        string softbreak = "?=";
        string encodedAttachmentName = encodingtoken;
        encodedAttachmentName = HttpUtility.UrlEncode(displayName, Encoding.Default).Replace("+", " ").Replace("%", "=");

        encodedAttachmentName = SplitEncodedAttachmentName(encodingtoken, softbreak, maxChunkLength, encodedAttachmentName);
        attachment.Name = encodedAttachmentName;

        return attachment;
    }

    private static IEnumerable<string> SplitByLength(string stringToSplit, int length)
    {
        while (stringToSplit.Length > length)
        {
            yield return stringToSplit.Substring(0, length);
            stringToSplit = stringToSplit.Substring(length);
        }

        if (stringToSplit.Length > 0)
        {
            yield return stringToSplit;
        }
    }

    private static string SplitEncodedAttachmentName(string encodingtoken, string softbreak, int maxChunkLength, string encoded)
    {
        int splitLength = maxChunkLength - encodingtoken.Length - (softbreak.Length * 2);
        var parts = SplitByLength(encoded, splitLength);

        string encodedAttachmentName = encodingtoken;

        foreach (var part in parts)
        {
            encodedAttachmentName += part + softbreak + encodingtoken;
        }

        encodedAttachmentName = encodedAttachmentName.Remove(encodedAttachmentName.Length - encodingtoken.Length, encodingtoken.Length);

        return encodedAttachmentName;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T18:04:17.597

原来有一个错误报告 - [https://connect.microsoft.com/VisualStudio/feedback/details/696372/filename-encoding-error-when-encoding-utf-8-and-encoded-name-exceeds-the-单个mime-header-line的长度#details](https://connect.microsoft.com/VisualStudio/feedback/details/696372/filename-encoding-error-when-encoding-utf-8-and-encoded-name-exceeds-the-length-of-a-single-mime-header-line#details)

和一篇 kb 文章，用于解决带有特殊字符的长名称的初始问题。 [http://support.microsoft.com/kb/2402064](http://support.microsoft.com/kb/2402064)

安装kb后，

我变了

mm.Attachments.Add(CreateAttachment(attachment, attachment.Name)); mm.Attachments.Add(CreateAttachment(attachment2, attachment2.Name));

回到应该是 mm.Attachments.Add(attachment); mm.Attachments.Add(附件2);

一切正常..

# android-activity - AndEngine 多活动切换时报错

> ID：10654854
> 
> 赞同：0
> 
> 时间：2012-05-18T14:49:59.143
> 
> 标签：android-activity, nullpointerexception, andengine, splash-screen, onresume

我为我的 andengine 游戏使用启动画面，启动画面后游戏崩溃我发布了错误

```
05-18 19:49:19.939: E/AndroidRuntime(3425): FATAL EXCEPTION: main
05-18 19:49:19.939: E/AndroidRuntime(3425): java.lang.NullPointerException
05-18 19:49:19.939: E/AndroidRuntime(3425): at org.andengine.ui.activity.BaseGameActivity.onResumeGame(BaseGameActivity.java:221)
05-18 19:49:19.939: E/AndroidRuntime(3425): at org.andengine.ui.activity.BaseGameActivity$4.run(BaseGameActivity.java:372)
05-18 19:49:19.939: E/AndroidRuntime(3425): at android.os.Handler.handleCallback(Handler.java:587)
05-18 19:49:19.939: E/AndroidRuntime(3425): at android.os.Handler.dispatchMessage(Handler.java:92)
05-18 19:49:19.939: E/AndroidRuntime(3425): at android.os.Looper.loop(Looper.java:130)
05-18 19:49:19.939: E/AndroidRuntime(3425): at  android.app.ActivityThread.main(ActivityThread.java:3687)
05-18 19:49:19.939: E/AndroidRuntime(3425): at java.lang.reflect.Method.invokeNative(Native Method)
05-18 19:49:19.939: E/AndroidRuntime(3425): at java.lang.reflect.Method.invoke(Method.java:507)
05-18 19:49:19.939: E/AndroidRuntime(3425): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
05-18 19:49:19.939: E/AndroidRuntime(3425): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
05-18 19:49:19.939: E/AndroidRuntime(3425): at dalvik.system.NativeStart.main(Native Method) 
```

供参考这里是我的清单

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="busgame.tilt.basic"
android:versionCode="1"
android:versionName="1.0" >
<uses-permission android:name="android.permission.WAKE_LOCK"/>
<supports-screens
            android:largeScreens="true"
            android:normalScreens="true"
            android:smallScreens="true"
            android:anyDensity="true" />
<uses-sdk android:minSdkVersion="10" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >

    <activity
        android:name=".SplashScreenActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
    android:label="@string/app_name"
    android:name=".Main" 
    android:theme="@android:style/Theme.NoTitleBar">
</activity>

</application>

</manifest> 
```

我很确定我的andengine是最新的
希望你们能帮助
提前谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T17:59:48.253

将此添加到 AndroidManifest.xml 中的所有 Andengine 活动中：

```
android:configChanges="orientation|screenSize" 
```

# c++ - 指针交换怪异

> ID：10654855
> 
> 赞同：0
> 
> 时间：2012-05-18T14:50:02.877
> 
> 标签：c++, pointers

我有以下工作代码，用于红黑树旋转。

```
 void BalancedTree::rotateLeft(Node* & x){
 37   Node* y = x->right;
 38 
 39   x->right = y->left;//slice y's left child
 40   x->right->parent = x;
 41 
 42   y->left = x;//switch x and y's parentship
 43   Node* xp = x->parent;//for some reason, y->parent = x->parent causes logic
     errors.
 44   x->parent = y;
 45   y->parent = xp;
 46   
 47   if (y->parent == nil) root = y;//fix grandparent
 48   else if (y->parent->parent->left == x) y->parent->parent->left = y;
 49   else y->parent->parent->right = y;
 50 } 
```

当第 43 和 45 行被替换为 (keep 44)

```
y->parent = x->parent 
```

或者，只是交换第 44 行和第 45 行，x 的 Node 指针的内容被改变了。我想做的就是：更改Node（由y指向）中的指针（父级），并让它指向x的父级。

节点结构为：

```
struct Node{
  Node* parent;
  Node* left;
  Node* right;
  int value;
}; 
```

我错过了什么吗？指针的基本属性？

编辑：第 313 页 Cormen 的算法简介

```
LEFT-ROTATE(T, x)
1 y = x.right
2 x.right = y.left
3 if y.left != T.nil
4   y.left.p = x
5 y.p = x.p
6 if x.p == T.nil
7   T.root = y
8 elseif x == x.p.left
9    x.p.left = y
10 else x.p.right = y
11 y.left = x
12 x.p = y 
```

EDIT2：这是代码不起作用：

```
 36 void BalancedTree::rotateLeft(Node* & x){
 37   Node* y = x->right;
 38 
 39   x->right = y->left;//slice y's left child
 40   x->right->parent = x;
 41 
 42   y->left = x;//switch x and y's parentship
 43   y->parent = x->parent;
 44   x->parent = y;
 45   
 46   
 47   if (y->parent == nil) root = y;//fix grandparent
 48   else if (y->parent->parent->left == x) y->parent->parent->left = y;
 49   else y->parent->parent->right = y;
 50 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T15:19:20.887

您提供的两个版本的代码确实是等效的。但是，您对该算法的实现与 Cormen 参考中所写的算法几乎没有关系。您的代码应为：

```
void BalancedTree::rotateLeft(Node* & x){
    Node* y = x->right;
    x->right = y->left;
    if (y->left != nil)
        y->left->parent = x;
    y->parent = x->parent;
    if (x->parent == nil)
        root = y;
    else if (x == x->parent->left)
        x->parent->left = y;
    else
        x->parent->right = y;
    y->left = x;
    x->parent = y;
} 
```

# java - Android String 包含两个值

> ID：10654856
> 
> 赞同：0
> 
> 时间：2012-05-18T14:50:03.377
> 
> 标签：java, android, xml, string, http

我从 HTTP 服务器接收 XML 作为字符串：

```
HttpResponse httpResponse = httpClient.execute (httpPost);
return EntityUtils.toString (httpResponse.getEntity ()); 
```

这个字符串似乎有两个值，因为当我尝试记录它的长度时，我在 Logcat 中得到两行：

```
Log.d ("XML", xml.length () + "");

17:30:22.313    19712   DEBUG   XML 161
17:30:22.313    19712   DEBUG   XML 0 
```

当我尝试使用 DOM 解析器解析这个 XML 时，我得到 org.xml.sax.SAXParseException: Unexpected end of document。

[我在这里](http://www.sencha.com/forum/showthread.php?167941-Android-2.3.3.-JSON-bug-%28JSON-string-twice-in-responseText%29)读到了类似的东西。我知道当我用一行代码得到两条 Logcat 行时，不是我做错了什么。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T15:12:48.320

那不应该`xml.length`和不应该`xml).length`吗？

这可以解释 logcat，但不能解释解析失败......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T15:26:15.170

2个左括号，3个右括号，正如另一条评论所说，它不会编译。可能你错误​​地引用了代码。第二个长度，0，可能来自“”。由于 logcat 显示了两个日志，因此您可能有一个 Log.d 行，其中少了一个 )，这两行一起产生了奇怪的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-19T08:04:07.503

以与解析 XML 相同的方法请求 XML，而不是通过方法参数传递 XML 字符串解决了该问题。我使用了完全相同的代码，只是将其移至另一种方法。这似乎是一些奇怪的 Android 或 NetBeans 错误。

# sql-server - 为什么备份到...在 C# 中不起作用

> ID：10654858
> 
> 赞同：0
> 
> 时间：2012-05-18T14:50:08.480
> 
> 标签：sql-server, c#-3.0, sql-server-express

我有一个与 SqlExpress 一起使用的项目，并且所有部分都正常工作，但是使用此语句备份中的错误：

> 在 sysdatabases 中找不到数据库“Verjan”的条目。未找到具有该名称的条目。确保输入的名称正确。BACKUP DATABASE 异常终止。

同时，备份一个程序中的代码

```
execute ('Use master')
Backup Database Sample to Disk = Adress 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:15:00.457

您是否在项目中使用数据库的用户实例？我的意思是如果你有`AttachDbFilename`数据库连接字符串。如果您这样做，那么您将无法执行正常备份，因为*a)*数据库未附加到您的 DBMS 并且*b)*在连接字符串中存在一个宏，该宏`|DataDirectory|`将在运行时解析为 .mdf 文件的实际路径。

这个问题有一个解决方案：[Backup and Restore with User Instances](http://blogs.msdn.com/b/sqlexpress/archive/2007/03/20/backup-and-restore-with-user-instances.aspx)

希望这可以帮助！

# google-apps-script - 需要帮助从谷歌脚本自动在谷歌文档中创建多个段落

> ID：10654859
> 
> 赞同：0
> 
> 时间：2012-05-18T14:50:11.717
> 
> 标签：google-apps-script

我正在尝试创建一个 google 文档，该文档具有从 google 电子表格上的数据自动生成的段落。我发现的大多数信息都显示了如何为每组数据创建一个文档或一个页面，但我需要生成一个段落并让脚本根据需要创建尽可能多的页面。这是我的第一个 google 脚本（而且我一般是脚本新手）所以可能会有一些明显的错误。

到目前为止，这是我的脚本：

```
function scriptListGen() {  

  var mySheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();  
  var firstName = mySheet.getRange("B3").getValue();  
  var lastName = mySheet.getRange("C3").getValue();  
  var dispo1 = "Prescription Left With Dr.";  
  var dispo2 = "Prescription Recieved";  
  var dispo3 = "Prescription Denied";  
  var notes = "Notes:"; 
  var date = "Date:";  
  var content = firstName + " " + lastName + "  " + dispo1 + dispo2 + dispo3 + notes;  

  var templateDocID = ScriptProperties.getProperty("listTemplateDocID");  
  var docID = DocsList.getFileById(templateDocID).makeCopy().getId();  
  var doc = DocumentApp.openById(docID);  
  var body = doc.getActiveSection();  
  body.insertParagraph(1, content);  
  body.insertHorizontalRule(2);  
} 
```

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T15:37:33.827

埃文，我不太清楚你所说的“添加尽可能多的页面”是什么意思。但是假设您的意思是您希望电子表格中的信息根据需要从一页流到下一页，我认为您会想要使用

```
body.appendParagraph  rather than insertParagraph. 
```

这是我正在使用的一些代码，它执行类似的过程。

```
function ReadFromSelectedTab(doc,SelectedTab,lHeading2style,lHeading3style,CatCount)
{
var doctoprocess = UserProperties.getProperty('doctoprocess');
var workbook = SpreadsheetApp.openById(doctoprocess);
var sheets =  workbook.getSheets();
var sheet =  workbook.getSheetByName(SelectedTab);

if (sheet != null) {
// The code below will make the sheet active in the active workbook
workbook.setActiveSheet(workbook.getSheets()[sheet.getIndex()-1]);
var lastRow = workbook.getLastRow();
var lastColumn = workbook.getLastColumn();
var lastACell = workbook.getRange("A"+lastRow);
Logger.log("Last Column: " + lastColumn)
for (var q = 0; q < lastRow; ++q)
     {
var Category = sheet.getRange(q+1,1).getValue();
var Question1 = sheet.getRange(q+1,2).getValue();
var Question2 = sheet.getRange(q+1,3).getValue();

var Column3Heading = sheet.getRange("C1").getValue()
if (Column3Heading = 'ANSWERS')
{
var answers = true;
}
if (Category.length > 0) {
**var head2 = doc.appendParagraph(CatCount +".  " + Category);**

head2.setHeading(DocumentApp.ParagraphHeading.HEADING3); 
          doc.appendParagraph(" ");
       CatCount++;
     }
     if (Question1.length > 0) {
       var quest1 = doc.**appendParagraph**(Question1);
       quest1.setAttributes(lHeading2style);
     }
     if (Question2.length > 0 && q>0) {

       var quest2 = doc.appendParagraph("     " + Question2);
       if ( answers != true)
       {
       quest2.setAttributes(lHeading3style);
       }
       else
       { quest2.setItalic(true).setFontSize(8).setBold(true); }
     }

   }    //  for (var q = 0; q < lastRow; ++q)
}          //  if (sheet != null) 
} 
```

因此代码将遍历我选择的选项卡，然后遍历各个行以提取信息。使用一些预定义的标题样式将信息格式化到文档中。

希望这可以帮助。

# linux - 如何生成文件的部分校验和

> ID：10654860
> 
> 赞同：10
> 
> 时间：2012-05-18T14:50:12.130
> 
> 标签：linux, hash, md5

我如何计算，比如说文件前 1024 个字节的 md5 总和？

但是我尝试过`od -N 1024 | md5sum`，默认情况下 od 输出是八进制格式，这会生成不同的 md5 哈希。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-18T14:54:44.933

`head -c 1024 | md5sum`

应该管用。

完整示例，如评论中所要求：

`head -c 1024 your_file | md5sum`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-08-19T23:02:41.603

假设一个更复杂的情况：您需要获取第一个分区的第二个 1GB 部分。使用 dd 命令：

```
dd bs=1M skip=1024 count=1024 if=/dev/sda1 | md5sum 
```

请注意，我们没有使用`of=`dd 命令的一部分。所以它的输出将被重定向到标准输出，我们通过管道传递给下一个命令。

# c# - 图片来源 UriKind

> ID：10654861
> 
> 赞同：3
> 
> 时间：2012-05-18T14:50:21.177
> 
> 标签：c#, wpf, image, uri

我有一个项目，它的名字是'xx'。我创建了一个具有以下路径的文件夹“images”：xx\bin\Debug\images\

images 只包含一张照片，它的名字是“1.jpg” MainWindow 包含 Image 控件；我将此代码设置为加载图像源，但它不起作用为什么？？：

```
private void Image_MouseDown(object sender, MouseButtonEventArgs e)
{
    Image i = sender as Image; ;
    BitmapImage b = new BitmapImage(new Uri(@"images\1.jpg",UriKind.Relative));
    i.Source=b;
} 
```

如何通过代码加载图像源？提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:55:56.907

您需要添加`1.jpg`到`images`文件夹中的项目[并将 Properties](http://msdn.microsoft.com/en-us/library/0c6xyb66.aspx)`1.jpg`设置为**Resource**。要加载资源，请使用[packURI](http://msdn.microsoft.com/en-us/library/aa970069)约定。

```
private void Image_MouseDown(object sender, MouseButtonEventArgs e)
{
    Image i = sender as Image; ;
    BitmapImage b = new BitmapImage(new Uri(@"pack://application:,,,/" 
         + Assembly.GetExecutingAssembly().GetName().Name 
         + ";component/" 
         + "Images/1.jpg", UriKind.Absolute)); 
    i.Source=b;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T06:22:31.023

尝试这个

```
public void Image_MouseDown(object sender, RoutedEventArgs e)
{
    OpenFileDialog dlg = new OpenFileDialog();
    dlg.InitialDirectory = "c:\\";
    dlg.Filter = "Image files (*.jpg)|*.jpg|All Files (*.*)|*.*";
    dlg.RestoreDirectory = true;
    Nullable<bool> result = dlg.ShowDialog();                        

    if (result == true)
    {
        BitmapImage bitmap = new BitmapImage();
        Image img = sender as Image;
        bitmap.BeginInit();
        bitmap.UriSource = new Uri(dlg.FileName);
        bitmap.EndInit();
        img.Source = bitmap;
    }
} 
```

# python - numpy 非整数网格

> ID：10654862
> 
> 赞同：1
> 
> 时间：2012-05-18T14:50:21.837
> 
> 标签：python, multidimensional-array, numpy, grid, points

我是 numpy 的新手，正在尝试找到一种 Pythonic :) 方法来生成常规的 3D 点网格。

使用 numpy，*ndindex*函数几乎可以满足我的要求，但我认为它只适用于整数。

```
import numpy as np
ind=np.ndindex(2,2,1)
for i in ind:
    print(i)

>>>(0, 0, 0)
(0, 1, 0)
(1, 0, 0)
(1, 1, 0) 
```

我基本上想要同样的东西，但使用浮点数来定义值。

我定义了一个盒子的尺寸和 x、z 和 z 细分的数量。

让我们从创建 x、y 和 z 维线性空间开始。

```
import numpy as np
corner1 = [0.0, 0.0, 0.0]
corner2 = [1.0, 1.0, 1.0]

nx, ny, nz = 5, 3, 7

xspace = np.linspace(corner1[0], corner2[0], nx)
yspace = np.linspace(corner1[1], corner2[1], ny)
zspace = np.linspace(corner1[2], corner2[2], nz) 
```

现在，我应该如何组合这些来给我网格中所有点的数组？感谢您的时间！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T15:26:43.767

我发现您的问题有点令人困惑，因为`ndindex`返回了一个生成器，但您似乎在要求一个 n 维数组。生成器非常简单：

```
>>> list(numpy.broadcast(*numpy.ix_(x, y, z)))
[(0.0, 0.0, 0.0),
 (0.0, 0.0, 1.0),
 (0.0, 0.5, 0.0),
 (0.0, 0.5, 1.0),
 (0.0, 1.0, 0.0),
 (0.0, 1.0, 1.0),
 (1.0, 0.0, 0.0),
 (1.0, 0.0, 1.0),
 (1.0, 0.5, 0.0),
 (1.0, 0.5, 1.0),
 (1.0, 1.0, 0.0),
 (1.0, 1.0, 1.0)] 
```

要将其打包成一个数组，您可以创建一个数组并对其进行整形，记住值三元组是它自己的维度（因此最后是额外`3`的）。

```
>>> numpy.array(list(numpy.broadcast(*numpy.ix_(x, y, z)))).reshape((2, 3, 2, 3))
array([[[[ 0\. ,  0\. ,  0\. ],
         [ 0\. ,  0\. ,  1\. ]],

        [[ 0\. ,  0.5,  0\. ],
         [ 0\. ,  0.5,  1\. ]],

        [[ 0\. ,  1\. ,  0\. ],
         [ 0\. ,  1\. ,  1\. ]]],

       [[[ 1\. ,  0\. ,  0\. ],
         [ 1\. ,  0\. ,  1\. ]],

        [[ 1\. ,  0.5,  0\. ],
         [ 1\. ,  0.5,  1\. ]],

        [[ 1\. ,  1\. ,  0\. ],
         [ 1\. ,  1\. ,  1\. ]]]]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T09:33:09.863

简单地说：

```
xyz = numpy.mgrid[0:3:0.1, 0:2:0.2, 0:1:0.5]
print xyz
array([[[[ 0\. ,  0\. ],
     [ 0\. ,  0\. ],
     [ 0\. ,  0\. ],
     ...,

    [[ 0.1,  0.1],
     [ 0.1,  0.1],
     [ 0.1,  0.1],
     ...,
    [[ 0.2,  0.2],
     [ 0.2,  0.2],
     [ 0.2,  0.2]]
    ...,
    [[ 2.9,  2.9],
     [ 2.9,  2.9],
     [ 2.9,  2.9],
    ...
   [[[ 0\. ,  0\. ],
     [ 0.2,  0.2],
     [ 0.4,  0.4],
     ...,
     [ 0\. ,  0.5],
     [ 0\. ,  0.5],
     [ 0\. ,  0.5]]]]) 
```

# java - flash socket 没有从 Java Server 正确读取

> ID：10654863
> 
> 赞同：3
> 
> 时间：2012-05-18T14:50:22.913
> 
> 标签：java, javascript, flash, sockets

由于 Javascript 本身不具备通过原始套接字进行通信的任何功能，因此我决定使用 Java 小程序 - 如果用户在其浏览器上禁用了 Java 小程序，则可以使用 Flash 套接字桥与 Javascript 集成。我尝试过使用[jsxmlsocket](http://code.google.com/p/jsxmlsocket/)和[haxejssocket](http://haxe.org/doc/js/using_sockets_with_javascript)只是为了面对同样的问题

现在，服务器应用程序是用 Java 编写的，并且可以通过 Java 小程序进行通信。但是在 flash 上，似乎有问题。

flash 收到的第一个文本是对 <policy-file-request/> 的响应，允许访问所有域和端口。这工作正常，因为套接字开始通信

以下是收到数据时运行的 Javascript 代码：

```
socket.onData = function(data) {
    alert(data);
    parse(data);
} 
```

现在，问题来了。发送 <policy-file-request/> 的响应后，又发送了 5 行文本。当然，我会看到 5 个带有发送文本的警报框。情况似乎并非如此。相反，我看到的是 5 个警报，其中包含对 <policy-file-request/> 的响应。似乎正在发送某些内容，导致 OnData 函数似乎在正确的时间触发，但由于某种原因，数据似乎是发送给它的第一行文本。

负责发送数据的 Java 线程：

```
LinkedBlockingQueue<String> outQueue=new LinkedBlockingQueue<String>(1000);
public Thread checkSendLoop=new Thread(){ //this is done to cramp everything in one file. Also more neater
    public void run(){
        try{
            OutputStream out=socket.getOutputStream();
            while (true){
                String mes=outQueue.take();
                mes=mes.replace("\n", "").replace("\r", ""); //for safety
                mes=mes+"\0"; //append
                out.write(mes.getBytes());
                out.flush();
            }
        }
        catch (Exception e){
            System.out.println("FATAL : Data to a client will not be sent anymore."); //probably a socket close threw the exception
            outQueue.clear();
            outQueue=null;
        }
    }
}; 
```

要发送数据，调用发送函数：

```
public void send(String s){
    Queue<String> testQueue = outQueue;
    s=s+" "+getUnixTime();
    if (testQueue!=null){
        System.out.println("SENDING "+nick+" - "+s);
        testQueue.add(s); //just add to the queue , the check loop will make sure that its sent
    }
} 
```

如您所见，所有发送的数据都以空字节或 \0 结尾。也许这是负责任的？

注意：我想在这里强调我熟悉 websockets 以及它们如何“更合适”，所以请不要这么建议。

如前所述，它在 Telnet 和 Java 小程序等其他客户端中运行良好。

更新：不，这不是[这个问题](https://stackoverflow.com/questions/1709467)的重复。`<policy-file-request/>`我的问题与每次`onData`调用只返回响应的脚本有关。过程中没有抛出“错误”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T08:53:30.253

据我所知，这看起来像是某种内部兼容性问题。您的代码看起来不错，这意味着代码与运行它的软件版本之间一定存在某种不兼容，从而导致了问题。

这是一个非常牵强的猜测，但它看起来是这里唯一可能导致该错误的东西

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T14:50:10.433

由于它是网络套接字，我强烈建议您使用 2 "\r" 完成数据。它怎么知道数据流已经完成？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T12:12:34.930

我在尝试构建 Flash Chat 时遇到了同样的问题。

我相信这是一个与 Flash 相关的问题，如果事件处理程序运行时间过长，那么它就会搞砸并一遍又一遍地读取相同的消息。

我正在使用带有外部接口的 Flash XMLSocket 到 Javascript。如果我有一个与从 Flash 同步调用的 javascript 代码相关联的警报，并且我没有立即单击它，我将一遍又一遍地得到相同的响应，即使我*知道*我发送了不同的响应（我的 C# 服务器在调试模式下将所有内容输出到控制台）。

我发现的唯一方法是保证您的事件处理程序执行得非常快（就像将消息添加到 div 一样），或者如果您可以构建一些队列系统，可以将所有消息排队并一个接一个地调用它们同步。

**我不知道问题的根源是什么，**但这至少应该让魔鬼远离。也许长时间“阻塞”事件处理程序是源头？谁知道？Flash 确实需要异步 ExternalInterface（我很清楚那里有一个解决方案，但它需要额外的 JS 代码，我试图保持清洁）。

# javascript - EXTJS生成条形图

> ID：10654869
> 
> 赞同：0
> 
> 时间：2012-05-18T14:50:38.590
> 
> 标签：javascript, extjs, extjs4, extjs-mvc

我正在研究 extjs & 我想从 xml 制作条形图 这是我的 XML

[http://pastebin.ca/2150257](http://pastebin.ca/2150257)

我做了这样的网格

```
columns: [
{text: "Department Performance", flex: 1,dataIndex: 'DepartmentPerformance', sortable: true},
{text : 'Domestic',
columns: [
{text: "YTD", width: 50, dataIndex: 'DomesticYTD', sortable: true},
{text: "MTD", width: 50, dataIndex: 'DomesticMTD', sortable: true},
{text: "Daily", width: 50, dataIndex: 'DomesticDaily', sortable: true}
]},
{text : 'Other',
columns: [
{text: "YTD", width: 50, dataIndex: 'OtherYTD', sortable: true},
{text: "MTD", width: 50, dataIndex: 'OtherMTD', sortable: true},
{text: "Daily", width: 50, dataIndex: 'OtherDaily', sortable: true},
]},
{text : 'Total',
columns: [
{text: "YTD", width: 50, dataIndex: 'TotalYTD', sortable: true},
{text: "MTD", width: 50, dataIndex: 'TotalMTD', sortable: true},
{text: "Daily", width: 50, dataIndex: 'TotalDaily', sortable: true},
]},

{text : 'OEM',
columns: [
{text: "YTD", width: 50, dataIndex: 'OEMYTD', sortable: true},
{text: "MTD", width: 50, dataIndex: 'OEMMTD', sortable: true},
]},

], 
```

＆我想按行制作图表，因为单击行我不知道如何使用侦听器并制作柱形图

就像 X 轴 3 部分国内 & 其他 & 总计 , 在每个部分 YTD,MTD,DAILY & Y 轴仅值 0 到最大值

我尝试了很多但无法按行值创建图表

请帮助..................谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T06:12:19.977

要在网格单击事件上生成图表，我们使用侦听器 selectionchange 事件在选择更改时生成分配给条形图的新商店

```
selectionchange: function (view, selections, options) {
                          //console.log(view, selections, options);
                          record = selections[0];
                          //var v = record.get('Field1');
                          //alert(''+v);
                          //alert(''+index)
                         // alert('hiiii')

                        record = selections[0];

                        myData=[['Domestic',record.get('field1'),record.get('field2'),record.get('field3')],
                                     ['Export',record.get('field4'),record.get('field5'),record.get('field6')],
                                     ['Other',record.get('field7'),record.get('field8'),record.get('field8'),
                                     ]]

                        } 
```

这是示例演示链接......

```
http://dev.sencha.com/deploy/ext-4.1.0-gpl/examples/charts/FormDashboard.html 
```

谢谢...

# javascript - 使用 Javascript 根据现有值更改属性值

> ID：10654872
> 
> 赞同：0
> 
> 时间：2012-05-18T14:50:41.713
> 
> 标签：javascript, html, dom

我用一个例子来说明：我需要用javascript转换下面的html

```
<a href="aaa.kmz"></a>
<a href="eee.kmz"></a>
<a href="rrr.kmz"></a>
... 
```

编码所有 href 值仅更改最后一个字母的地方

```
<a href="aaa.kml"></a>
<a href="eee.kml"></a>
<a href="rrr.kml"></a>
... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T14:58:15.513

获取 a 标签，遍历它们并替换`.kmz`为`.kml`：

```
​var tags = document.getElementsByTagName("a");

for(var i = 0, l = tags.length; i < l; i++) {
    tags[i].href = tags[i].href.replace('.kmz', '.kml');
}​​​​ 
```

工作示例 - [http://jsfiddle.net/Ln4s4/](http://jsfiddle.net/Ln4s4/)

# php - 使用 htmlentities 保留换行符？

> ID：10654874
> 
> 赞同：7
> 
> 时间：2012-05-18T14:50:46.707
> 
> 标签：php

在我正在构建的表单中，我`textareas`将包含大量文本，其中包括换行符，例如：

> 第一句
> 
> 第二句

我通过使用将其发布到我的表单中`htmlentities`，例如：

```
. htmlentities($_POST['textarea']) . 
```

但是，这会在表单发送的电子邮件（**HTML email**）中产生以下内容：

> 第一句 第二句

无论如何要保留换行符`htmlentities`吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-18T14:54:38.867

使用[`nl2br()`](http://php.net/nl2br)which 转换`\n`为`<br />`：

```
. nl2br(htmlentities($_POST['textarea'])) . 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:56:37.353

不，这是不可能的。如果您想在 HTML 文档中换行，那么您必须使用`display: block`（和朋友）元素、换行元素 ( `<br>`) 或`white-space: pre`元素。

您可以使用带有该函数`<br>`的 PHP 生成元素。[`nl2br`](http://php.net/nl2br)

# magento - Magento 和 Google 站点地图 - Cron

> ID：10654875
> 
> 赞同：6
> 
> 时间：2012-05-18T14:50:46.910
> 
> 标签：magento, cron, xml-sitemap

我是 Magento 的新手。我正在尝试配置自动生成的 Google 站点地图。我到处读过如何使用 cPanel 为 Magento 设置 cron 作业，如何从后端配置等等。

我当前的设置：在系统 -> 配置 -> Google 站点地图 -> 生成设置 -> 启用 = YES 下。当然，我已经在 Catalog -> Google Sitemap 上创建了站点地图，我可以毫无问题地手动生成它。

但是，如果我检查文件**/app/code/core/Mage/Sitemap/etc/config.xml**它似乎没有更新（不同的内容 btw config.xml 和后端）。似乎文件系统的最后一次更新是在 2012 年 4 月 20 日而不是今天进行的。（我还运行了 Fluch Magento 和 Storage Cache）

```
<generate>
    <enabled>0</enabled>
    <error_email/>
    <error_email_template>sitemap_generate_error_email_template</error_email_template>
    <error_email_identity>general</error_email_identity>
</generate> 
```

有人可以帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-19T04:14:58.427

在 Magento 和 Cron 设置上，使用 cron.sh 进行触发。我也相信**Trust 但验证**这意味着设置 cron 然后实际查看 cron 作业输出表以正确运行。

进入您的高级系统配置并将 Cron Success History Lifetime 和 Failure Lifetime 都设置为 1440，这样您就可以监控 24 小时的时间跨度。

您现在将能够在时间流中看到索引操作等。在 24 小时的时间跨度内，您的工作成功部分将列出大约 300 个工作。

现在运行这个[cron 日志监视器](http://www.magentocommerce.com/boards/viewreply/351010/)，看看你的 cron 是否真的在运行。当这个人说它是时，我遇到过很多次，但随后尝试验证它并发现它在几次尝试后便便了。

下一个问题是语句*但是如果我检查文件 /app/code/core/Mage/Sitemap/etc/config.xml 它似乎没有更新*。首先，这是一个配置模板，不会更新。启用是在数据库中完成的。您在 System -> Config -> Catalog -> Google Sitemap -> Generation Settings -> Enable = Yes 中检查它应该是设置，一旦保存，保持在 Yes。Magento 参考存储在数据库中的这个设置，而不是 config.xml 来实际运行站点地图生成。

![搜索引擎优化 - 启用自动生成的站点地图](../Images/e577abed590f8f3ecc69037eb7edd452.png)

现在，如果您在 Catalog -> Google Sitemap 下正确创建了站点地图，则实际 sitemap.xml 文件上的日期/时间戳应该开始更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T15:18:45.180

我没有在您的问题中看到它，但是，要使 cron 作业正常工作，您必须为您的 magento 安装设置实际的 cron 作业。尝试先将 cron.php 或 cron.sh 添加到您的 crontab：

示例：cron.sh

```
*/5 * * * *  /bin/sh /absolute/path/to/magento/cron.sh 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T16:41:32.110

毛罗

像这样的 XML 只是默认数据，一旦保存在管理员中，就会进入数据库，这就是从那里开始的所有来源，请参阅`SELECT * FROM core_config_data WHERE path LIKE "sitemap/generate/time";`运行时或`SELECT * FROM core_config_data WHERE path LIKE 'sitemap/%';`已设置的所有选项的总体视图Magento 中的站点地图生成。

正如赛斯所说，你需要有，

`*/5 * * * * /bin/sh /absolute/path/to/magento/cron.sh`

在您的网络用户的 crontab 中

# azure-sql-database - 设置触发器时无法进行 SQL Azure 数据同步

> ID：10654880
> 
> 赞同：1
> 
> 时间：2012-05-18T14:51:13.453
> 
> 标签：azure-sql-database, azure-data-sync

我尝试使用**SQL Azure 数据**同步在 SQL-Azure-DB 和本地 SQL-Server 2008R2 之间进行同步。

我只需要同步一张现在只有 90 行的表。Azure端的表有一个触发器集，但是我本地的sql-server上的表没有这个触发器（因为除了共享一个表，两个数据库没有任何共同点）。

当我尝试同步它失败并出现以下错误：

```
Sync failed with the exception "GetStatus failed with exception:
Sync worker failed, checked by GetStatus method.

Failure details:
An unexpected error occurred when applying batch file C:\Resources\directory\61e9d741c80a47b4ae195f835e62fcda.NTierSyncServiceWorkerRole.LS1\DSS_syncjobmxd24sznwfq5idekfaopaery\a0e8b11a-a08c-4081-b929-e3f80b70f045.batch.
See the inner exception for more details.

Inner exception:
Failed to execute the command 'BulkInsertCommand' for table 'dbo.tblUser';
the transaction was rolled back. Ensure that the command syntax is correct.

Inner exception:
SqlException Error Code: -2146232060 - SqlError Number:512,
Message: Subquery returned more than 1 value.
This is not permitted when the subquery follows =, !=, <, <= , >, >=
or when the subquery is used as an expression.

SqlError Number:3621,
Message: The statement has been terminated. 
For more information, provide tracing id ‘bb8e3787-27c1-4b7e-9a26-6db2ff6724d3’ to customer support. 
```

**当我禁用触发器时，同步工作！**

我的触发器：

```
 CREATE TRIGGER [dbo].[UpdateUsersTable]
    ON [dbo].[tblUser]
    AFTER INSERT AS BEGIN SET NOCOUNT ON;

    INSERT INTO  [dbo].[Users] ([userID], [PartnerOrganizationId])
    VALUES ((select [userID] from inserted), (select [country] from inserted))
    END 
```

作为一种方法，我认为可能是因为我的触发器和同步触发器以错误的顺序开始，所以我尝试了：

```
 exec sp_settriggerorder @triggername = 'tblUser_dss_insert_trigger',
                        @order = 'first',
                        @stmttype = 'insert',
                        @namespace = null

    exec sp_settriggerorder @triggername = 'UpdateUsersTable',
                    @order = 'last',
                    @stmttype = 'insert',
                    @namespace = null
    go 
```

但这并没有改变什么。还是同样的错误。

我是否有机会在启用触发器的情况下同步该表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T17:51:47.910

在您的触发器中，您正在使用导致此问题的 INSERT。

请为 INSERT、UPDATE 和 DELETE 创建单独的触发器。系统确实需要比较插入和删除表之间的行数，以确定触发触发器的操作。为 INSERT/DELETE 设置单独的触发器应该可以解决这个问题。

[类似的讨论在这里](http://social.msdn.microsoft.com/Forums/en/ssdsgetstarted/thread/b7a5bd08-ed82-4af7-90b4-5d3b7749d174)显示了完全相同的问题

**更多信息**

您的触发器有一个错误，并且对于任何多行插入都会失败。它应该是这样的：

```
CREATE TRIGGER [dbo].[UpdateUsersTable]
ON [dbo].[tblUser]
AFTER INSERT AS BEGIN SET NOCOUNT ON;

INSERT INTO  [dbo].[Users] ([userID], [PartnerOrganizationId])
 select [userID], [country] from inserted
END 
```

# php - 对于多暗淡数组 PHP 上的每个逻辑

> ID：10654885
> 
> 赞同：0
> 
> 时间：2012-05-18T14:51:29.150
> 
> 标签：php, multidimensional-array, for-loop

我有一个来自 POST 的多维度数组

```
[key:value key:value[array one {key1:value, key2:value}{key1:value, key2:value}][array two{key1:value, key2:value}...] key:value key:value] 
```

我正在使用嵌套数组生成 xml 条目，并将它们标识如下：

```
foreach ($_POST as $key){
        if (is_array($key)){
               foreach ($key as $key2 => $value){
                   $array_type = substr($key2, 0,2);
                    if ($array_type == 'ec'){
                        $xml .= '<tns:PersonNamesInfoType>';

                    if ($key2 == 'ec_fname'){
                        $xml .= '<GivenName>'.$value.'</GivenName>';
                        //<MidInitial>MidInitial</MidInitial>
                        }
                        else if ($key2 == 'ec_lname'){
                            $xml .= '<FamilyName>'.$value.'</FamilyName>';
                            //</tns:PersonNamesInfoType>
                            }
                        else if ($key2 == 'ec_rel'){
                            $xml .= ' <Relationship>'.$value.' </Relationship>';
                            // <tns:PhoneInfoType>
                            //<tns:PhoneType></tns:PhoneType>
                            }
                        else if ($key2 == 'ec_ophone'){
                            $xml .= '<Number>'.$value.'</Number>';
                            }
                        else {
                            $xml .= '<IsPrimary>'.$value.'</IsPrimary>';
                            }
                            $xml .= '</tns:PersonNamesInfoType>';
                   }
                   else if($array_type == 've') {
                       $xml .= '<tns:AutoInfoType>';

                        foreach ($key as $key2 => $value){

                            if ($key2 == 'veh_year'){
                            $xml .= '<Year>'.$value.'</Year>';
                            }
                            else if ($key2 == 'veh_make'){
                            $xml .= '<Make>'.$value.'</Make>';
                            }
                            else if ($key2 == 'veh_model'){
                            $xml .= '<Model>'.$value.'</Model>';
                            }
                            else if ($key2 == 'veh_plate'){
                            $xml .= '<Plate>'.$value.'</Plate>';
                            }
                            else if ($key2 == 'veh_state'){
                            $xml .= '<tns:StateType>'.$value.'</tns:StateType>';
                            }
                            else {$xml .= '<IsPrimary>'.$value.'</IsPrimary>';}

                }
            $xml .= '</tns:AutoInfoType>';
                   }

            }
    }
} 
```

这会产生不正确的结果

```
<tns:PersonNamesInfoType>
<GivenName>'.$value.'</GivenName>
</tns:PersonNamesInfoType>

<tns:PersonNamesInfoType>
<FamilyName>'.$value.'</FamilyName>
</tns:PersonNamesInfoType>

Instead of:

<tns:PersonNamesInfoType>
<GivenName>'.$value.'</GivenName>
<FamilyName>'.$value.'</FamilyName>
</tns:PersonNamesInfoType> 
```

根据遇到的第一个键值来分离每个数组的数据的更好解决方案是什么

```
1[ec_fname]
1[veh_lname]
2[ec_fname]
2[veh_lname] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:18:49.810

这将满足您的需求，并且更短、更简单且更易于扩展：

```
$personTags = array(
    "ec_fname" => "GivenName",
    "ec_lname" => "FamilyName",
    "ec_rel" => "Relationship",
    "ec_ophone" => "Number"
);

$vehicleTags = array(
    "veh_year" => "Year",
    "veh_make" => "Make",
    "veh_model" => "Model",
    "veh_plate" => "Plate",
    "veh_state" => "StateType"
);

$xml = "";
foreach ($_POST as $key)
{
    if (!is_array($key))
        continue;

    $personNamesInfoTypes = array();
    $autoInfoTypes = array();

    foreach ($key as $key2 => $value)
    {
        $array_type = substr($key2, 0, 2);
        if ($array_type == 'ec')
        {
            if (array_key_exists($key2, $personTags))
                $tag = $personTags[$key2];
            else
                $tag = "IsPrimary";

            $personNamesInfoTypes[] = " <{$tag}>{$value}</{$tag}>";
        }
        else if ($array_type == 've')
        {
            if (array_key_exists($key2, $vehicleTags))
                $tag = $vehicleTags[$key2];
            else
                $tag = "IsPrimary";

            $autoInfoTypes[] = "    <{$tag}>{$value}</{$tag}>";
        }
    }

    if (!empty($personNamesInfoTypes))
        $xml .= "<tns:PersonNamesInfoType>\n". implode("\n", $personNamesInfoTypes) ."\n</tns:PersonNamesInfoTypes>\n";
    if (!empty($autoInfoTypes))
        $xml .= "<tns:AutoInfoType>\n". implode("\n", $autoInfoTypes) ."\n</tns:AutoInfoTypes>\n";
} 
```

* * *

看起来您的循环设置错误（车辆部分有一个 foreach 循环，但人员部分没有一个），并且每次创建子节点时都在创建一个新的父节点。

使用我的解决方案，不是在每次循环迭代时将节点直接添加到字符串中，而是将它们附加到一个数组中，然后在该`$_POST`变量的末尾，这两个数组将一次全部转储到正确的父节点中.

如果您必须向人员部分或车辆部分添加另一个可能的标签，您需要做的就是向`$personTags`or`$vehicleTags`数组添加一个条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T15:02:46.767

您可能会注意您的代码格式。

foreach 内部有一个 foreach 并不是很清楚，它们使用相同的“$key2”和“$value”。我猜你把“}”放在了错误的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T15:03:05.150

您的第二个 if 条件**“类型等于've'”** foreach*在*if*条件*内。

```
else if($array_type == 've') {
$xml .= '<tns:AutoInfoType>';
foreach ($key as $key2 => $value){ 
```

**但是在“类型等于'ec'”**的初始*if条件下*，*foreach*超出了*if条件*，因此会给您带来问题。

 ****```
foreach ($key as $key2 => $value){
$array_type = substr($key2, 0,2);
if ($array_type == 'ec'){ 
```

**我的解决方案**

我提出的解决方案非常简单......只需将 foreach 从第 4 行移动到第 7 行，您的问题就应该得到解决（*因为每个*问题都需要在*if 条件*内）。

```
if ($array_type == 'ec'){
$xml .= '<tns:PersonNamesInfoType>';
foreach ($key as $key2 => $value){ 
```

我已将完整的解决方案附加到我的答案中:)

```
 foreach ($_POST as $key){
    if (is_array($key)){
               $array_type = substr($key2, 0,2);
                if ($array_type == 'ec'){
                    $xml .= '<tns:PersonNamesInfoType>';
                    foreach ($key as $key2 => $value){
                    if ($key2 == 'ec_fname'){
                        $xml .= '<GivenName>'.$value.'</GivenName>';
                        //<MidInitial>MidInitial</MidInitial>
                        }
                        else if ($key2 == 'ec_lname'){
                            $xml .= '<FamilyName>'.$value.'</FamilyName>';
                            //</tns:PersonNamesInfoType>
                            }
                        else if ($key2 == 'ec_rel'){
                            $xml .= ' <Relationship>'.$value.' </Relationship>';
                            // <tns:PhoneInfoType>
                            //<tns:PhoneType></tns:PhoneType>
                            }
                        else if ($key2 == 'ec_ophone'){
                            $xml .= '<Number>'.$value.'</Number>';
                            }
                        else {
                            $xml .= '<IsPrimary>'.$value.'</IsPrimary>';
                            }
                    }
                    $xml .= '</tns:PersonNamesInfoType>';
               }
               else if($array_type == 've') {
                   $xml .= '<tns:AutoInfoType>';

                    foreach ($key as $key2 => $value){

                        if ($key2 == 'veh_year'){
                        $xml .= '<Year>'.$value.'</Year>';
                        }
                        else if ($key2 == 'veh_make'){
                        $xml .= '<Make>'.$value.'</Make>';
                        }
                        else if ($key2 == 'veh_model'){
                        $xml .= '<Model>'.$value.'</Model>';
                        }
                        else if ($key2 == 'veh_plate'){
                        $xml .= '<Plate>'.$value.'</Plate>';
                        }
                        else if ($key2 == 'veh_state'){
                        $xml .= '<tns:StateType>'.$value.'</tns:StateType>';
                        }
                        else {$xml .= '<IsPrimary>'.$value.'</IsPrimary>';}

            }
        $xml .= '</tns:AutoInfoType>';
               }
}
} 
```****

# asp.net-mvc-3 - 没有用户登录功能的网站需要什么样的安全性？

> ID：10654888
> 
> 赞同：0
> 
> 时间：2012-05-18T14:51:44.347
> 
> 标签：asp.net-mvc-3, security, xss, sql-injection

所以我在谷歌上搜索这个问题并找不到任何明确的例子，因为几乎所有相关的故事都是关于用户登录的网站等。

所以我的场景如下，asp.net MVC3网站，没有用户登录，什么都没有。不过，我确实有一些表格，联系方式和一些计算功能。

我使用 Nhibernate，并将我的 Smtp 服务器凭据放在代码本身中，而不是在 web.config 中。我还有一个自定义错误页面，并且发布方法具有 [HttpPost] 属性。

作为最后一个功能，我有一个 AJAX/json get 方法，它可以获取标题列表。（此控制器方法具有 [AcceptVerbs(HttpVerbs.Get)] 属性）。

我是否在这里遗漏了一些大的安全漏洞（sql 注入、跨站点脚本）？

多谢你们

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:58:12.127

从这里开始：[https ://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project](https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:58:09.360

您仍然容易受到 DDoS 和 DoS 攻击，如果您不使用 https，那么您将容易受到 MiM 攻击。

虽然 NHibernate 和 ASP.NET MVC3 应该为您覆盖大部分曲目。如果他们没有适当的表单验证客户端和服务器端并且没有对数据库输入进行清理，我会感到非常惊讶。

你如何管理你的数据？- 你有只为管理员登录吗？

如果是这样，让你保护它，并且为了额外的措施，不要把它放在`/login/`或`/admin/`！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T03:42:14.337

The only types of attacks you would not be vulnerable to would be any type of Authentication Bypass or Privilege Escalation. The rest of the OWASP Top 10 (and SANS top 25 for that matter [http://www.sans.org/top25-software-errors/](http://www.sans.org/top25-software-errors/)) would still be applicable.

Despite the typical SQL Injection and XSS vulnerabilities, there are a number of other "injection" type vulnerabilites, such as OS Command Injection and Path Traversals that you should be aware of. Don't forget you should also be aware of securing your hosting environment (hardening the web server, applicaiton server, and the server itself).

# maven - 将属性文件中的变量传递到 pom.xml 中的 distributionManagement 标记

> ID：10654892
> 
> 赞同：3
> 
> 时间：2012-05-18T14:52:01.240
> 
> 标签：maven, pom.xml

所以我有类似的东西：

```
<plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>properties-maven-plugin</artifactId>
            <version>1.0-alpha-1</version>
            <executions>
                <execution>
                    <phase>initialize</phase>
                    <goals>
                        <goal>read-properties</goal>
                    </goals>
                    <configuration>
                        <files>
                            <file>${user.home}/build.properties</file>
                        </files>
                    </configuration>
                </execution>
            </executions>
        </plugin> 
```

我`distributionManagement`喜欢：

```
<distributionManagement>
    <repository>
        <id>local-repo</id>
        <url>file:///${deploy.dir}/${project.artifactId}</url>
    </repository>
</distributionManagement> 
```

我没有远程存储库，这就是我使用它的原因`file:///`

`${deploy.dir}`是`build.properties`文件中的一个属性，它不会采用该属性的值。为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T18:17:40.533

我建议使用构建配置文件来管理多个分发目标。例如：

```
<profiles>
   <profile>
      <id>repo1</id>
      <distributionManagement>
         <repository>
            <id>repo1-release</id>
            <url>http://.......</url>
         </repository>
      </distributionManagement>
   </profile>

   <profile>
      <id>repo2</id>
      <distributionManagement>
         <repository>
            <id>repo2-release</id>
            <url>http://.......</url>
         </repository>
      </distributionManagement>
   </profile>
   ..
</profiles> 
```

调用部署目标时，您可以通过激活配置文件来选择目标：

```
mvn -Prepo1 clean deploy 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T13:43:47.720

马克的答案可能是要走的路，也是我正在做的事情，以在我们的远程存储库的生产和测试实例之间切换。[根据讨论，我发现](http://maven.40175.n5.nabble.com/Lifecycle-phase-in-which-the-url-for-distributionManagement-snapshotRepository-is-calculated-td5673069.html)听起来您可以加载属性以供以后的插件配置使用，但核心 maven 模型元素`<distributionManagement>`仅在 POM 的初始加载时解释属性。

（移动评论以回答每个 OP 请求。）

# c# - 使用数据属性制作以键值为键的web api序列化字典

> ID：10654898
> 
> 赞同：6
> 
> 时间：2012-05-18T14:52:12.967
> 
> 标签：c#, asp.net, asp.net-mvc-3, json.net, asp.net-web-api

我有一个字典，我正在使用 json.net 序列化程序对其进行序列化，它目前正在生成

```
{"phrases":[{"Key":"my-key1","Value":"blah"},{"Key":"my-key2","Value":"blah2"}]} 
```

但是我希望它输出

```
{"phrases":["my-key1":"blah"},{"my-key2":"blah2"}]} 
```

我的模型看起来像

```
public class Phrases
{
    public Dictionary<string, string> phrases;
} 
```

是否有可以应用于短语模型的数据属性来导致这种情况发生？

我发现了以下内容，但不想[使用 Json.Net 将字符串 Serialize 返回到键值字典中？](https://stackoverflow.com/questions/6862177/serialize-into-a-key-value-dictionary-with-json-net)

更新：

我正在扩展 web api 控制器，如下所示，如果我使用 JsonConvert.SerializeObject() 我确实得到了正确的序列化，但是我会返回一个字符串。

```
public class PhraseController : ApiController
    {
        private IApplicationModel applicationModel;

        public Phrases Get(string id)
        {
            var locale = new CultureInfo(id).LCID;
            var phrases = applicationModel.Phrases.Where(x => x.Locale = locale).ToDictionary(x => x.Name, y => y.Value);

            return new Phrases() { phrases = phrases };
        }

        public PhraseController(IApplicationModel applicationModel)
        {
            this.applicationModel = applicationModel;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T15:45:01.173

我最终设法让它工作。

问题是它仍在使用`DataContractJsonSerializer`. 我在添加之前添加了一行删除格式化程序`JsonNetFormatter`，现在它可以正确序列化。

```
GlobalConfiguration.Configuration.Formatters.Remove(GlobalConfiguration.Configuration.Formatters.JsonFormatter);

GlobalConfiguration.Configuration.Formatters.Add(new JsonNetFormatter(null)); 
```

（我正在使用仍然使用 DataContractJsonSerializer 的 beta 版本）

# join - Doctrine 2 中的自动 JOIN 生成

> ID：10654901
> 
> 赞同：2
> 
> 时间：2012-05-18T14:52:28.380
> 
> 标签：join, doctrine-orm

Doctrine 2 是否支持自动 JOIN 生成？也就是说，假设我有一个与一些产品实体相关联的卖家实体，每个产品实体都有一个类别，做类似的事情

```
$sellers = $entityManager->getRepository('Foo\Bar\Seller')->findBy(array('country' => 'US'), array('populate' => array('Product', 'Product.Category')));
foreach ($sellers as $seller) {
    doStuffWith($seller->product->category);
} 
```

整个事情只需要一个查询，因为 Doctrine 会将产品和类别表加入到卖家表中，并使用结果来预填充关联。这样的事情可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T15:05:23.893

您有两种方法可以自动执行 JOIN：

*   使用急切获取
*   使用 DQL

Eager fetching 意味着每当获取主实体时，Doctrine 2 也会自动获取任何标记为“eager”的关系。这是通过使用`fetch`映射中的属性来完成的（参见[手册：ManyToOne](http://readthedocs.org/docs/doctrine-orm/en/latest/reference/annotations-reference.html?highlight=eager#manytoone)）

使用 DQL，您需要编写一个同时获取主实体和相关实体/实体的查询：

`SELECT m, r FROM My\MainEntity m LEFT JOIN m.relatedEntity r`

Eager fetching 与 DQL 相比的好处在于，通过 Eager fetch，您将基本上自动获得该功能。但是，Eager fetching 的缺点是，如果您实际上不使用相关实体，则可能会导致性能损失。使用 DQL，您始终可以控制获取的内容和时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-06T22:01:54.020

来自[Doctrine Query Language 文档](https://www.doctrine-project.org/projects/doctrine-orm/en/2.7/reference/dql-doctrine-query-language.html)：

> 初学者的一个常见错误是将 DQL 误认为只是某种形式的 SQL，因此试图在查询中使用表名和列名或将任意表连接在一起。您需要将 DQL 视为对象模型的查询语言，而不是关系模式的查询语言。

如果你想使用**对象**（实体），每个都有自己的存储库，你不应该考虑 SQL（或`JOIN`ing 表），因为存储库和**DQL 查询将始终只返回单一类型的 object**。
ORM 的目的是让您将其视为对象（而不是表），而无需考虑持久层的技术实现：考虑关联，而不是`join`s；必要的 SQL 查询会根据需要在后台自动执行，而无需过多考虑过早的优化（Doctrine 对性能并不理想；但有时许多查询可能比一个大的单个连接查询更快）。

如果您从多个 SQL 表（如此多种类型）获取连接数据，那么您的查询结果记录不再代表每个单个/唯一对象，而是每个记录是来自多个表并涉及多个模型的数据的混搭。

如果您进行查询，ORM 应该映射什么实体`SELECT seller.*, product.name, product.price, category.name FROM ..`？
只是映射到*卖方*？缺少属性的*产品？*
应该从 SQL 结果的每条记录映射哪个单个实体，例如：

```
+-----------+-------------+-----------------+---------------+-----------------+
| seller.id | seller.name |  product.name   | product.price |  category.name  |
+-----------+-------------+-----------------+---------------+-----------------+
|        42 | Alan Smith  | Apple MacBook   | 1500$         | Computer&Mobile |
|        42 | Alan Smith  | Apple MacBook   | 1850$         | Computer&Mobile |
|        42 | Alan Smith  | Dell XPS        | 1500$         | Computer&Mobile |
|        34 | Jane Foley  | Clarinet Selmer | 1720$         | Music           |
+-----------+-------------+-----------------+---------------+-----------------+ 
```

?

ORM 无法猜测！

因此，您需要一个自定义映射器来告诉 Doctrine 如何从包含混合数据的 SQL 行中构建实体对象（模型）。
查看[Native SQL 文档](https://www.doctrine-project.org/projects/doctrine-orm/en/2.7/reference/native-sql.html)，了解如何构建自己的`ResultSetMapping`.

# asp.net - SignalR 和加入组

> ID：10654902
> 
> 赞同：7
> 
> 时间：2012-05-18T14:52:32.550
> 
> 标签：asp.net, .net, signalr

我正在为我正在从事的项目寻找 SignalR，它似乎正是我想要的。然而，我仍然有点困惑的是团体和加入。

我将尝试首先描述实现的上下文。因此，现有系统中的用户将希望就给定主题举行会议，然后将创建一个具有给定名称/标识符的房间，然后他们将邀请其他人加入其中，然后它基本上就像一个私人聊天室。

所以我假设的步骤是作为主持人，创建一个房间并加入它，然后发出邀请，要求用户点击它会以某种方式告诉服务器加入哪个房间。

现在我从文档中看到有一个 Join and Disconnect 方法，您可以使用它来将某人加入一个组，但是似乎 Join 除了查询字符串之外没有与之关联的上下文，所以我有点困惑至于触发联接的原因，正如我所期望的那样，它将是客户端上的手动触发方法，传递一些对象，提供有关将它们放入哪个房间的上下文，因为您可能有数百个私人房间。

那么如何为 Join 方法提供一些上下文和断开连接，以便他们知道您请求加入哪个房间，就好像它不是手动触发的一样，您如何设置查询字符串，如果是手动触发，为什么可以您不会发送自定义对象。IE

```
public Task Join()
{
    var groupName = Context.QueryString["some-room-identifier"];
    return Groups.Add(Context.ConnectionId, groupName);
} 
```

对比

```
public Task Join(string groupName)
{
    return Groups.Add(Context.ConnectionId, groupName);
} 
```

那么我是否遗漏了什么，或者有什么方法可以为加入的用户提供上下文，以便第一次将他们放在正确的位置？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T18:31:17.903

我和你有几乎相同的经历，并且在某种程度上工作/战斗过，所以我会分享我所做的。

您需要在某处捕获状态。查看从客户端到服务器往返的 SignalR Hubs wiki [https://github.com/SignalR/SignalR/wiki/Hubs](https://github.com/SignalR/SignalR/wiki/Hubs)。我发现这很有用，因为它告诉您如何在服务器集线器或客户端上设置状态并在另一端检索它。

我得出与您相同的结论，即加入是由某些事件手动触发的。~~我正在使用投票来查看是否有人请求与用户聊天。~~您实际上可以从服务器推送（请参阅[SignalR Join Group From Controller](https://stackoverflow.com/questions/21142889/signalr-join-group-from-controller?rq=1)），这意味着处理添加新聊天消息的控制器操作可以调用集线器的`Join`方法：

```
// join chatroom
public Task Join(dynamic mygroup)
{
var groupName = groupy.GetGroupName(parent.userId, (int)mygroup.userIdTo);
return Groups.Add(Context.ConnectionId, groupName);
} 
```

`Dictionary<string, int[]>`对于我的组名，我使用 Singleton 生成并使用 a （`int[]`用于 userIds）来跟踪名称。

对于客户端状态的东西，我最终制作了一个自定义 JavaScript 对象来管理组名，就像这样......

```
Chat.Chatgroup = function (groupId, userIdTo) {
this.GroupId = groupId; // our group's title / id
this.UserIdTo = userIdTo; // who the other user is
} 
```

然后我在连接后调用signalR方法

```
onechat.getOurGroup(mygroup) // invoke method on server
.done(function (response) {
mygroup = response;
 /* + whatever else you need to do*/ }); 
```

现在您可以在服务器上设置状态并在客户端上保持该状态：

```
public dynamic GetOurGroup(dynamic mygroup)
{
var ourId = groupy.GetGroupName(parent.userId, (int)mygroup.UserIdTo);
mygroup.GroupId = ourId;                    
return mygroup;
} 
```

希望它至少有点帮助！

# google-maps - iFrame 中的谷歌地图 API v3 不起作用 - IE 中的问题

> ID：10654904
> 
> 赞同：0
> 
> 时间：2012-05-18T14:52:35.293
> 
> 标签：google-maps, iframe, google-maps-api-3, internet-explorer-8

我有一个 CMS 网站（托管在 A 服务器上）并且想在其中的一个页面上放置一个谷歌地图。

我所做的是创建一个新的 html 页面（托管在 B 服务器上），它使用 Google API v3 进行映射并添加一些标记。

我们的 CMS 类似于 Wikipedia（我们可以编辑页面），所以我想将 iframe（在来自 A 服务器的页面上）添加到我创建的新 html 页面（位于 B 服务器上）。一切都在 IE、Chrome、FF 中完美加载，我可以在 iFrame 中看到地图加载，地图上有 10-20 个标记。

这是问题所在：在 IE8 中地图被冻结，我无法使用鼠标在地图中导航。我仍然可以加载信息窗口，但是当我拖动它时地图没有移动。

更多细节：

*   如果我将相同的 iFrame 放在不同的主机上（与 CMS 机器不同），一切都会毫无问题 - 但显然我们需要在 CMS 中显示它。
*   如果我在 IE8 上切换兼容模式，它将开始工作：它可以让我使用鼠标并移动/拖动地图。
*   如果我将 iFrame 指向通过 SSL 传递的网络页面，它会正常工作。
*   如果映射是在 v2（而不是 v3）上完成的 - 它似乎也可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T13:48:29.323

如果没有要测试的 url，我们只能进行猜测。

这是一对：

*   由于您提到了 SSL，请确保您通过 SSL 加载 Maps API，并且您的问题当前不是由非 SSL 内容引起的。如果是这种情况，IE 开发人员工具应该在控制台上显示警告。
*   在 iframe 中使用 IE 特定的[X-UA-Compatible 标头/元标记来指定兼容模式。](http://msdn.microsoft.com/en-us/library/cc288325.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-13T04:45:00.550

实际上它在 IE 中工作，但你需要设置宽度和高度。默认情况下 IE 不接受 width:100% 和 height:100% ，你必须这样做：

```
<style type="text/css">
html
{
    height:100%;
}
body
{
    height:100%;
    margin:0;
    padding:0;
}
#google_map
{
    height:100%;
    width:100%;
    height:inherit;
    width:inherit;
}
</style> 
```

Google 地图位于 id="google_map" 的 div 中。

```
<div id="google_map"></div> 
```

# java - Guice 注入器或通用提供程序以某种方式

> ID：10654907
> 
> 赞同：4
> 
> 时间：2012-05-18T14:52:46.320
> 
> 标签：java, generics, dependency-injection, inversion-of-control, guice

我需要有延迟加载逻辑来在我的类中创建映射器。每个映射器都继承自`Mapper<T>`接口。但是通过时间对象的工作，它可以使用多个映射器，具体取决于它处理的输入。

正如我所见，这不是在课堂上注入注射器的好方法，但我怎么能实现延迟加载不这样做呢？我不能使用`Provider<Mapper>`，因为提供者没有选项来确定我当时需要哪个确切的映射器。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T15:14:29.637

这可能不是最好的解决方案，但它可以为您工作。

您可以实现一个允许您提供动态输入的 Provider。然后将该 Provider 注入到需要它们的类中，以便您可以动态创建所需的对象。

[这是Provider JavaDoc](http://google-guice.googlecode.com/git/javadoc/com/google/inject/Provider.html)的一个片段：

> 实现类可能总是选择注入一个 Provider 实例，而不是直接注入一个 T。这可以让您访问多个实例、您希望安全地变异和丢弃的实例、超出范围的实例（例如，使用@SessionScoped 对象中的@RequestScoped 对象）或将延迟初始化的实例。

它可能如下所示。我个人认为将 Injector 注入到提供程序中很好，因为它是注入框架的一部分。目标是将 Injector 排除在您的应用程序代码之外，这当然可以。

```
public class FooProvider implements Provider<Foo>

    @Inject
    private Injector injector;

    private String input;

    public void setInput(String input){
        this.input = input;
    }

    @Override
    public Foo get(){
        if(input.equals("bar")){
            injector.getInstance(Bar.class); // Bar implements Foo
        }
        else{
            injector.getInstance(Baz.class; // Baz implements Foo
        }
    }
} 
```

然后在别处...

```
public class Goo{

    @Inject
    Provider<Foo> fooProvider;

    public Foo goo(String input){
        fooProvider.setInput(input);
        return fooProvider.get();
    }
} 
```

关键是确保每个提供程序实例在每个注入点都是唯一的，我认为这是默认情况下的。由于此提供程序具有可变状态，因此您不能将其抛在您的应用程序中（并且可能在多线程环境中做错事），除非您打算这样做。然后，您将需要采取更多的预防措施。

# visual-studio - 在安装 MSI 之前使用 Visual Studio 2005 MSI/Setup creator 自动备份文件

> ID：10654908
> 
> 赞同：0
> 
> 时间：2012-05-18T14:52:48.293
> 
> 标签：visual-studio, visual-studio-2005, windows-installer

我试图弄清楚是否有任何方法可以备份您要使用在 Visual Studio 2005 msi/setup creator 中创建的 MSI 覆盖的文件和注册表设置。是否可以在不指定将单独备份所有文件的脚本的情况下执行此操作，这将耗费时间创建并可能引入错误/错误。

所以说我有一个文件 C:\myfile.txt 并且我的安装程序将该文件安装到 C:\myfile.txt 并且它已经存在它将在覆盖它之前将它备份到 c:\mybackup\myfile.txt 。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T05:52:53.463

这不可能。然而，Windows Installer 会在每次安装时创建一个系统还原点。从 Vista+ 开始，这还包括文档文件（默认启用）。因此，在 Vista+ 中，您将能够从“*属性*”对话框的“*以前版本*”选项卡访问以前版本的 C:\myfile.txt。

 *安装人员不应该修改用户的文件，因此不做备份。并且在 Windows XP 中也创建了系统还原点，以便您可以将系统还原到安装前的状态。

* * *

在安装过程中，Windows Installer 会自动创建回滚数据。如果安装失败，它会自动将系统恢复到安装开始之前的状态（当然，如果您没有在立即自定义操作中进行系统修改）。*

# ios - 将 BGRA 转换为 ARGB

> ID：10654909
> 
> 赞同：4
> 
> 时间：2012-05-18T14:52:50.367
> 
> 标签：ios, core-graphics, avcapturesession, avcam

我正在阅读有关从 iPhone 相机获取像素数据的[教程](http://www.benjaminloulier.com/articles/ios4-and-direct-access-to-the-camera)。

虽然运行和使用此代码没有问题，但我需要获取相机数据的输出（来自 BGRA）并将其转换为 ARGB，以便我可以将它与外部库一起使用。我该怎么做呢？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-18T19:31:16.567

如果您使用的是 iOS 5.0，则可以使用 Accelerate 框架中的 vImage 使用如下代码（取自 Apple 的[WebCore 源代码](http://www.opensource.apple.com/source/WebCore/WebCore-7534.48.3/platform/graphics/cg/ImageBufferDataCG.cpp)）进行 NEON 优化的颜色组件交换：

```
vImage_Buffer src;
src.height = height;
src.width = width;
src.rowBytes = srcBytesPerRow;
src.data = srcRows;

vImage_Buffer dest;
dest.height = height;
dest.width = width;
dest.rowBytes = destBytesPerRow;
dest.data = destRows;

// Swap pixel channels from BGRA to RGBA.
const uint8_t map[4] = { 2, 1, 0, 3 };
vImagePermuteChannels_ARGB8888(&src, &dest, map, kvImageNoFlags); 
```

其中`width`、`height`和`srcBytesPerRow`是通过 、 和 从像素缓冲区`CVPixelBufferGetWidth()`获得`CVPixelBufferGetHeight()`的`CVPixelBufferGetBytesPerRow()`。`srcRows`将是指向像素缓冲区中字节基地址的指针，并且`destRows`是您分配用于保存输出 RGBA 图像的内存。

这应该比简单地迭代字节和交换颜色分量要快得多。

根据图像大小，更快的解决方案是将帧上传到 OpenGL ES，使用它作为纹理渲染一个简单的矩形，然后使用 glReadPixels() 来下拉 RGBA 值。更好的做法是使用 iOS 5.0 的纹理缓存进行上传和下载，在 iPhone 4 上，720p 帧的这个过程只需要 1-3 毫秒。当然，使用 OpenGL ES 意味着要提取更多的支持代码这个关了。

# javascript - 对大型“选项”数据结构进行微小更改

> ID：10654916
> 
> 赞同：0
> 
> 时间：2012-05-18T14:53:00.597
> 
> 标签：javascript

我将一个大的“选项”对象传递给我在 JavaScript 中实例化的另一组对象。问题是，这些“选项”中的极少数必须从一个对象更改为另一个对象。制作一个完全独立的选项变量，改变许多选项中的一个，感觉很愚蠢。我也不认为我可以只更改同一“选项”对象上的选项，因为所有对象都将引用相同的“选项”。

下面是相关代码。

```
 for (var i = 0; i < invoices.length; i++) {

        var ura_original_column = { "column" : "ura_ppa_original",
                                    "on_update" : [format_ura],
                                    "display" : "URA" };

        if (invoices[i]["type"] == "P") {
            ura_original_column = { "column" : "ura_original",
                                    "on_update" : [format_ura],
                                    "display" : "URA" };
        }

        var options = { template_table  : "template_table",
                        template_total  : "template_total",
                        template_row    : "template_row",
                        template_text   : "template_text",
                        template_select : "template_select",
                        packet_id       : <?val=packet["packet_id"]?>,
                        products        : <?val=json.dumps(products)?>,
                        allow_new_rows  : <?val=json.dumps(packet["status"] not in api.NON_MODIFIABLE_STATUS)?>, 
                        on_table_focus  : on_table_focus,
                        on_row_update   : on_row_update,
                        on_new_row      : on_new_row,
                        columns : [{"column" : "product_code", 
                                    "display" : "Product"},
                                   {"column" : "transaction_type",
                                    "display" : "FFSU/MCOU",
                                    "editor" : "selectedit",
                                    "options" : ["FFSU", "MCOU"]},
                                    ura_original_column,
                                   {"column" : "ura_current",
                                    "display" : "Calculated URA"},
                                   {"column" : "units_current",
                                    "display" : "Current Units",
                                    "on_update" : [format_units],
                                    "show_total" : true},
                                   {"column" : "amount_claimed", 
                                    "display" : "Amt Claimed",
                                    "on_update" : [format_currency],
                                    "show_total" : true},
                                   {"column" : "scripts_current",
                                    "display" : "Scripts",
                                    "on_update" : [format_scripts],
                                    "show_total" : true},
                                   {"column" : "amount_medi_reimbursed", 
                                    "display" : "MEDI Amt", 
                                    "on_update" : [format_currency],
                                    "show_total" : true},
                                   {"column" : "amount_non_medi_reimbursed", 
                                    "display" : "Non-MEDI Amt", 
                                    "on_update" : [format_currency],
                                    "show_total" : true},
                                   {"column" : "amount_total_reimbursed", 
                                    "display" : "Total Amt", 
                                    "on_update" : [format_currency],
                                    "show_total" : true}]}

        var invoice_id = invoices[i]['invoice_id'];
        var transactions = transactions_by_invoice[invoice_id];
        var table = new Table.Table("invoice_" + invoice_id, options, transactions);

        tables.push(table);
    }
}); 
```

因此，在这个巨大的选项结构中，只有“ura_original_column”发生了变化。这可能是最好的方法，但感觉有点像黑客。

有人有更优雅的建议吗？

感谢您花时间查看。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:02:45.407

您可以使用 new[`Object.create`](http://es5.github.com/#x15.2.3.5)创建一个新对象，该对象仅具有不同的选项，但由具有所有其他选项的原型支持。（这是一个 ES5 功能，但您可以创建一个提供主要功能的版本，或者使用“ES5 shim”项目提供的功能，包括您需要的部分；在 ES5 之前的环境中*完全*创建是不可能的`Object.create`，但你不需要全部。）

看起来像这样：

```
var mainOptions = { /* ...bit list of main options... */ };

for (index = 0; index < limit; ++index) {
    theseOptions = Object.create(mainOptions);
    theseOptions.column = "new column name";
    doTheThing(theseOptions);
} 
```

你最终得到的是一个对象，它只有你更改的属性，但如果被要求提供任何其他属性，它将从主选项原型返回值。

这是一个独立的示例：[Live copy](http://jsbin.com/ehepiy) | [来源](http://jsbin.com/ehepiy/edit)

```
(function() {

  // Get a `create` function that acts a bit like
  // `Object.create` even if `Object.create` isn't
  // there
  var objectCreate = (function() {
    if (Object.create) {
      return Object.create;
    }

    function ctor() { }

    return function(proto) {
      var rv, key;

      ctor.prototype = proto;
      rv = new ctor();
      ctor.prototype = undefined;

      return rv;
    };
  })();

  var mainOptions = {
    option1: "Main option 1",
    option2: "Main option 2",
    option3: "Main option 3"
  };

  var index;
  var theseOptions;

  for (index = 0; index < 4; ++index) {
    theseOptions = objectCreate(mainOptions);
    theseOptions.option2 = "Special option 2 for index " + index;

    displayOptions(index, theseOptions);
  }
  display("Options passed to function");

  function displayOptions(index, options) {
    // Do it *later* so we know we weren't just
    // doing it before the object got updated
    setTimeout(function() {
      display("Options for index " + index + ":");
      display(options.option1);
      display(options.option2);
      display(options.option3);
    }, 0);
  }

  function display(msg) {
    var p = document.createElement('p');
    p.innerHTML = String(msg);
    document.body.appendChild(p);
  }
})(); 
```

同样，重要的是要理解`objectCreate`给定的 if`Object.create`不存在**并不是**真正的完整垫片`Object.create`。完成我们想要完成的部分就足够了。

# visual-studio-2010 - CXX0017：错误：在静态库中找不到符号

> ID：10654920
> 
> 赞同：5
> 
> 时间：2012-05-18T14:53:08.117
> 
> 标签：visual-studio-2010, visual-studio, debugging, visual-studio-debugging

当我尝试查看与当前启动项目链接的静态库中的一些变量时，我收到此错误：

```
CXX0017: Error: symbol not found 
```

我试图重建项目/关闭 IDE，但我有同样的错误。我可以使用断点/步骤/其他功能。

你知道为什么会这样吗？也许一些奇怪的编译器标志或其他......

编辑：只有一些变量不能在调试器中查看！通常是局部变量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-07-08T19:46:03.380

我正在使用 Cplex 求解器并且遇到了这个问题，我将以下设置更改为“禁用（/od）”：从属性页 > 配置管理器 > c/c++ > 优化 > 优化，现在它可以工作了:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T15:12:36.653

取自[http://social.msdn.microsoft.com/Forums/en-US/vsdebug/thread/8d1007d4-c85a-44e8-970a-1c2a7b638ce4](http://social.msdn.microsoft.com/Forums/en-US/vsdebug/thread/8d1007d4-c85a-44e8-970a-1c2a7b638ce4)

> 请检查 pdb 文件是否从正确的项目文件夹中正确加载，您可以选择**Debug -> Windows -> Modules**，在 Modules 窗口中，右键单击符号项，选择 Symbol Load Information，从弹出窗口中可以看到是否加载 pdb 文件以及加载 pdb 文件的位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-10T03:10:03.043

我遇到了同样的问题，我正在使用 VS2005。关于在 Projects - propoties - C/C++ Optimization 中将设置更改为 (/od) 并失败。然后，我找到了Souce File并右键单击该文件然后单击propoties，在这个页面中我找到了另一个C/C++ Optimization并选择了/od。它有助于。

# jquery - 如何动画作为另一个动画函数的回调

> ID：10654922
> 
> 赞同：1
> 
> 时间：2012-05-18T14:53:09.773
> 
> 标签：jquery, callback, hover, move

我是初学者级别的 jquery，我设置了这个脚本，但我需要修改它。我想要它，以便在悬停时，箭头向右移动 3px，然后回到左侧原始位置..在鼠标移出之前。

现在它被设置为返回到原来的位置但是......只有在鼠标移开之后。我想在悬停中包含该步骤作为回调。所以它连续向右然后向左移动。悬停和移出的红框效果保持不变。

这是我到目前为止的脚本，但在更改它时遇到了问题。任何帮助都会很棒，这样我就可以学习。

```
<script type="text/javascript">

$(document).ready(function() {
    var $red   = $('#red');
    var $arrow = $('#arrow');
    $('#wording').hover(
      function() {
        $red.animate({'width': 'toggle'});
        $arrow.css('color', 'white').delay(100).animate({'right': '-=3px'}, 'fast');
      }, function() {
        $red.animate({'width': 'toggle'});
        $arrow.css('color', 'red').delay(100).animate({'right': '+=3px'}, 'fast');
     });
});

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:56:25.933

```
$('#wording').on('mouseenter', function() {
  $red.animate({'width': 'toggle'});
  $arrow.css('color', 'white').delay(100).animate({'right': '-=3px'}, 'fast', function(){
    $red.animate({'width': 'toggle'});
    $arrow.css('color', 'red').delay(100).animate({'right': '+=3px'}, 'fast');
  });
}); 
```

回调作为第三个参数传递给`animate`

# c# - 在扩展方法中保留状态

> ID：10654925
> 
> 赞同：11
> 
> 时间：2012-05-18T14:53:21.870
> 
> 标签：c#, dictionary, reference, extension-methods, state

C# 团队之前曾考虑向 C# 添加扩展属性、事件等。

根据埃里克·利珀特：

[http://blogs.msdn.com/b/ericlippert/archive/2009/10/05/why-no-extension-properties.aspx](http://blogs.msdn.com/b/ericlippert/archive/2009/10/05/why-no-extension-properties.aspx)

然而，为了使这些功能有用，它们必须能够使用对象存储某种新的状态。似乎这样做的唯一方法是使用字典并将对象的每个实例与附加状态相关联。

如果可以通过创建我自己的字典（可能还有 get/set 扩展方法）“手动”复制此功能，那将很有用。但是，为了将对象的特定*实例*与某些状态相关联，您需要散列对该对象的实际*引用*。在另一种语言中，您可以通过对其内存位置进行哈希处理来做到这一点，但是在 C# 中，不能保证保持不变，并且使用不安全的代码来完成此功能无论如何都远非理想。

有谁知道是否有可能获得对不会随着对象的内部状态变化而变化的对象的一些可散列引用？显然有一些内部机制可以跟踪单个对象，而不管它们的内存位置如何，但我不确定这是否会暴露给用户代码。

注意：简单地散列对象本身根本不起作用，因为 GetHashCode() 取决于对象的内部状态而不是它是*哪个对象*。

感谢您的任何见解。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-18T14:55:18.537

您正在寻找[ConditionalWeakTable 类](http://msdn.microsoft.com/en-us/library/dd287757.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T15:00:51.733

** 完整答案已编辑 ** 属性保存在字典中，该字典使用对对象的弱引用作为键，并使用字符串-对象对的字典来存储属性及其值。

要设置、获取或删除对象的属性，请在字典中的弱引用中搜索该对象。

可以有两种方法来处理未使用的属性：

*   检查弱引用的 IsAlive，如果为 false，则删除字典中的条目
*   在“可扩展”对象中实现 IDisposable 并调用一个扩展方法来删除正在释放的对象上的属性。

我在示例代码中包含了一个可选的 using 块，以便您可以调试并查看 Dispose 如何调用`RemoveProperties`扩展方法。这当然是可选的，并且该方法将在对象被 GC 时调用。

该想法的工作示例，使用 Wea​​kReference、静态字典和 IDisposable。

```
using System;
using System.Collections.Generic;
using System.Linq;

namespace ConsoleApplication3
{
    class Program
    {
        static void Main(string[] args)
        {
            using (PropertyLessClass plc = new PropertyLessClass())
            {
                plc.SetProperty("age", 25);
                plc.SetProperty("name", "John");
                Console.WriteLine("Age: {0}", plc.GetProperty("age"));
                Console.WriteLine("Name: {0}", plc.GetProperty("name"));
            }
            Console.ReadLine();
        }
    }
}

public class PropertyLessClass : IDisposable
{
    public void Dispose()
    {
        this.DeleteProperties();
    }
}

public static class PropertyStore
{
    private static Dictionary<WeakReference, Dictionary<string, object>> store
        = new Dictionary<WeakReference, Dictionary<string, object>>();

    public static void SetProperty(this object o, string property, object value)
    {
        var key = store.Keys.FirstOrDefault(wr => wr.IsAlive && wr.Target == o);
        if (key == null)
        {
            key = new WeakReference(o);
            store.Add(key, new Dictionary<string, object>());
        }
        store[key][property] = value;
    }

    public static object GetProperty(this object o, string property)
    {
        var key = store.Keys.FirstOrDefault(wr => wr.IsAlive && wr.Target == o);
        if (key == null)
        {
            return null; // or throw Exception
        }
        if (!store[key].ContainsKey(property))
            return null; // or throw Exception
        return store[key][property];
    }

    public static void DeleteProperties(this object o)
    {
        var key = store.Keys.FirstOrDefault(wr => wr.IsAlive && wr.Target == o);
        if (key != null)
        {
            store.Remove(key);
        }
    }
} 
```

# android - 自签名证书“ 不包含 CN 或 DNS subjectAlt”

> ID：10654940
> 
> 赞同：2
> 
> 时间：2012-05-18T14:54:40.113
> 
> 标签：android, https, certificate

我正在一个项目中，我的同事实现了一个 https 服务器，它使用一个自签名服务器，我正在设计一个向它发送 httpposts 的 android 应用程序。他使用 curl 对其进行了测试，没有任何问题。如果相关，我正在使用 Android 3.2。

[按照此处](http://blog.antoine.li/2010/10/22/android-trusting-ssl-certificates/)的本教程，我生成了一个密钥库并将其添加到应用程序中，同时还创建了一个自定义 httpClient。我使用以下代码将 get 请求替换为 post：

```
 private InputStream postHttpConnection(String urlValue,
        JSONObject jsonPost, Context context) {
            InputStream inStream = null;
            URL url;
            try {
                url = new URL(urlValue);
                URLConnection conn = url.openConnection();
                if (!(conn instanceof HttpURLConnection))
                    Log.e("postHttpConnection", "Fail: " + "Not an HTTP connection");
            } catch (MalformedURLException e) {
                Log.e("postHttpConnection", "Fail: " + e);
            } catch (IOException e) {
                Log.e("postHttpConnection", "Fail: " + e);
            }
            try {
                DefaultHttpClient client = new MyHttpClient(context);
                HttpConnectionParams
                        .setConnectionTimeout(client.getParams(), 10000);
                HttpResponse postResponse;
                HttpPost post = new HttpPost(urlValue);
                StringEntity se = new StringEntity(jsonPost.toString());
                post.setEntity(se);
                post.setHeader("Accept", "application/json");
                post.setHeader("Content-type", "application/json");
                postResponse = client.execute(post);
                inStream = postResponse.getEntity().getContent();
            } catch (ClientProtocolException e) {
                Log.e("postHttpConnection", "Fail: " + e);
            } catch (IOException e) {
                Log.e("postHttpConnection", "Fail: " + e);
            }
            return inStream;
        } 
```

当我通过适当的 JSONObject 使用此函数时，我收到以下错误：

```
 E/postHttpConnection(9236): Fail: javax.net.ssl.SSLException: Certificate for <address> doesn't contain CN or DNS subjectAlt 
```

你能告诉我这与什么有关吗？谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T15:03:21.873

问题不在于您的代码，而在于证书。您需要在证书的 SubjectName.CommonName 字段或证书的主题备用名称扩展中指定您的域名（客户端连接的域名）。您需要重新创建证书，并在执行此操作时查看有关如何指定 CommonName 的手册（您需要将其设置为“www.mydomain.com”之类的内容）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-19T03:47:03.517

```
private HttpClient getHttpClient(){
    RegistryBuilder<ConnectionSocketFactory> registryBuilder = RegistryBuilder.<ConnectionSocketFactory> create();
    ConnectionSocketFactory plainSF = new PlainConnectionSocketFactory();
    registryBuilder.register("http", plainSF);
    try {
        KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());
        TrustStrategy anyTrustStrategy = new TrustStrategy() {
            @Override
            public boolean isTrusted(X509Certificate[] x509Certificates, String s) throws CertificateException {
                return true;
            }
        };
        SSLContext sslContext = SSLContexts.custom().useTLS().loadTrustMaterial(trustStore, anyTrustStrategy)
                .build();
        LayeredConnectionSocketFactory sslSF = new SSLConnectionSocketFactory(sslContext,
                SSLConnectionSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);
        registryBuilder.register("https", sslSF);
    } catch (Exception e) {
        throw new RuntimeException(e);
    }
    Registry<ConnectionSocketFactory> registry = registryBuilder.build();
    PoolingHttpClientConnectionManager connManager = new PoolingHttpClientConnectionManager(registry);
    HttpClient httpclient = HttpClientBuilder.create().setConnectionManager(connManager).build();

    return httpclient;
} 
```

也许对你有帮助。附言。httpclient 版本为 4.3.1

# gtk - 为什么 GtkWindow 不触发“绘制”事件？

> ID：10654943
> 
> 赞同：1
> 
> 时间：2012-05-18T14:54:54.763
> 
> 标签：gtk, vala

我正在尝试使用 GTK+ 3.x 获得一个透明窗口。AFAIK 下面的代码应该可以工作，但我的窗口永远不会触发“draw”信号。可能是什么原因？

我的代码：

```
using Gtk;

public class WallpaperWindow : Object {
  private Window  window;

  public static int main (string[] args) {
    Gtk.init (ref args);

    new WallpaperWindow();

    Gtk.main();

    return 0;
  }

  public WallpaperWindow() {
    // Initialize window
    this.window = new Window();
    this.window.resize(200, 200);

    this.window.set_decorated(false);
    this.window.set_border_width(8);

    // Enable transparency

    var screen = this.window.get_screen();
    var visual = screen.get_rgba_visual();

    if(visual != null && screen.is_composited()) {
      message("Composition is enabled, enabling transparency");
      this.window.set_visual(visual);
    } else {
      warning("Composition is not enabled, cannot enable transparency");
    }

    this.window.draw.connect(on_window_draw);

    // Run!
    this.window.show_all();

  }

  // NEVER CALLED
  private bool on_window_draw(Cairo.Context cr) {
    warning("on_window_draw");
    cr.set_source_rgba(0.0, 0.0, 0.0, 0.0);
    cr.set_operator(Cairo.Operator.SOURCE);
    cr.paint();
    cr.set_operator(Cairo.Operator.OVER);

    return true;
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T17:33:06.580

您不会将新创建的 WallpaperWindow 实例分配给变量。Vala 不会被垃圾回收......当一个对象超出范围时，它会*立即*取消引用，如果你不将它分配给一个变量，它会在构造函数调用结束时超出范围。从您的示例生成的 C 如下所示：

```
_tmp0_ = wallpaper_window_new ();
_tmp1_ = _tmp0_;
_g_object_unref0 (_tmp1_);
gtk_main (); 
```

如您所见，在调用 gtk_main 之前，您的新 WallpaperWindow 会被取消引用。如果您将它分配给一个变量（因此它持续过去`gtk_main`），您的示例将按您的预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T11:04:38.307

C 中的转置按预期工作。

```
#include <gtk/gtk.h>

static gboolean
on_window_draw(GtkWidget *window, cairo_t *cr)
{
    g_message("Called!\n");

    cairo_set_source_rgba(cr, 0.0, 0.0, 0.0, 0.0);
    cairo_set_operator(cr, CAIRO_OPERATOR_SOURCE);
    cairo_paint(cr);
    cairo_set_operator(cr, CAIRO_OPERATOR_OVER);

    return TRUE;
}

int main(int argc, char *argv[])
{
    GtkWidget *window;
    GdkScreen *screen;
    GdkVisual *visual;

    gtk_init(&argc, &argv);

    window = gtk_window_new(GTK_WINDOW_TOPLEVEL);
    gtk_window_resize(GTK_WINDOW(window), 200, 200);

    gtk_window_set_decorated(GTK_WINDOW(window), FALSE);

    screen = gtk_window_get_screen(GTK_WINDOW(window));
    visual = gdk_screen_get_rgba_visual(screen);

    if (visual != NULL && gdk_screen_is_composited(screen)) {
        g_message("Composition is enabled, enabling transparency");
        gtk_widget_set_visual(window, visual);
    } else {
        g_message("Composition is not enabled, cannot enable transparency");
    }

    g_signal_connect(window, "draw", G_CALLBACK(on_window_draw), NULL);

    gtk_widget_show_all(GTK_WIDGET(window));

    gtk_main();
    return 0;
} 
```

这就是我得到的：

```
$ gcc $(pkg-config --cflags --libs gtk+-3.0) a.c
$ ./a.out
** Message: Composition is enabled, enabling transparency
** Message: Called!

** Message: Called!

** Message: Called!

** Message: Called! 
```

# java - 如何减去两个 XmlGregorianCalendar 对象来创建一个 Duration 对象？

> ID：10654946
> 
> 赞同：10
> 
> 时间：2012-05-18T14:55:09.100
> 
> 标签：java

我想计算两个`XmlGregorianCalendar`对象之间的时间增量（减法），以创建一个`Duration`对象。

但我还没有找到执行减法的干净方法。你会怎么做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T16:28:39.527

那应该是：

```
DatatypeFactory.newDuration(xgc2.toGregorianCalendar().getTimeInMillis() - xgc1.toGregorianCalendar().getTimeInMillis()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-08-12T11:33:55.180

接受的答案仅以毫秒分辨率给出结果，但 XmlGregorianCalendar 允许无限精度。我们必须解决 µS 分辨率的问题。我通过转换为大十进制并使用 getFractionalSeconds 来做到这一点。见下文

```
 public static BigDecimal convertXMLGregorianToSecondsAndFractionalSeconds(XMLGregorianCalendar xgc){
    long ms = xgc.toGregorianCalendar().getTimeInMillis();
    long secs = ms / 1000l;
    BigDecimal decValue = BigDecimal.valueOf(secs);
    BigDecimal fracSects = xgc.getFractionalSecond();
    decValue = decValue.add(fracSects);
    return decValue;
}

 @Test
public void testSubtraction() throws Exception {
    XMLGregorianCalendar xgc1 =  DatatypeFactory.newInstance().newXMLGregorianCalendar("2015-05-22T16:28:40.317123-04:00");
    XMLGregorianCalendar xgc2 =  DatatypeFactory.newInstance().newXMLGregorianCalendar("2015-05-22T16:28:40.917124-04:00");
    BigDecimal bd1 = MathUtils.convertXMLGregorianToSecondsAndFractionalSeconds(xgc1);
    BigDecimal bd2 = MathUtils.convertXMLGregorianToSecondsAndFractionalSeconds(xgc2);
    BigDecimal result = bd2.subtract(bd1);
    Assert.assertTrue(result.equals(new BigDecimal("0.600001")));
} 
```

# c# - 奇怪的 MVC 站点地图错误仅在现场制作盒上每隔几天出现一次。找到具有相同 URL '/Home.mvc.aspx/Index' 的多个节点

> ID：10654950
> 
> 赞同：1
> 
> 时间：2012-05-18T14:55:24.113
> 
> 标签：c#, asp.net-mvc, model-view-controller, sitemap

所以我有一个 MVC Web 应用程序，它目前在 MVC 3，C# 上。

我使用了 MVC 站点地图，并且每隔一段时间我们就会收到此错误：

```
System.InvalidOperationException: Multiple nodes with the same URL '/Home.mvc.aspx/Index' were found. XmlSiteMapProvider requires that sitemap nodes have unique URLs.
Generated: Fri, 18 May 2012 14:46:20 GMT

System.InvalidOperationException: An error occurred when trying to create a controller of type 'StudentPortal3G.Controllers.HomeController'. Make sure that the controller has a parameterless public constructor. ---> System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---> MvcSiteMap.Core.MvcSiteMapException: An error occured while parsing the SiteMap XML. Check the inner exception for more details. ---> System.InvalidOperationException: Multiple nodes with the same URL '/Home.mvc.aspx/Index' were found. XmlSiteMapProvider requires that sitemap nodes have unique URLs.
   at System.Web.StaticSiteMapProvider.AddNode(SiteMapNode node, SiteMapNode parentNode)
   at MvcSiteMap.Core.MvcSiteMapProvider.AddNode(SiteMapNode node, SiteMapNode parentNode) in D:\Project Files\JCDCHelper\WebApp\MvcSiteMap.Core\MvcSiteMapProvider.cs:line 356
   at MvcSiteMap.Core.MvcSiteMapProvider.AddNode(SiteMapNode node) in D:\Project Files\JCDCHelper\WebApp\MvcSiteMap.Core\MvcSiteMapProvider.cs:line 336
   at MvcSiteMap.Core.MvcSiteMapProvider.BuildSiteMap() in D:\Project Files\JCDCHelper\WebApp\MvcSiteMap.Core\MvcSiteMapProvider.cs:line 264
   --- End of inner exception stack trace ---
   at MvcSiteMap.Core.MvcSiteMapProvider.BuildSiteMap() in D:\Project Files\JCDCHelper\WebApp\MvcSiteMap.Core\MvcSiteMapProvider.cs:line 309
   at MvcSiteMap.Core.MvcSiteMapProvider.GetRootNodeCore() in D:\Project Files\JCDCHelper\WebApp\MvcSiteMap.Core\MvcSiteMapProvider.cs:line 365
   at System.Web.SiteMapProvider.get_RootNode()
   at MvcSiteMap.Core.MvcSiteMapProvider.get_RootNode() in D:\Project Files\JCDCHelper\WebApp\MvcSiteMap.Core\MvcSiteMapProvider.cs:line 120
   at System.Web.SiteMap.get_RootNode()
   at StudentPortal3G.Controllers.BaseController.LoadHeaderInfo() in d:\CC\StudentPortal3G\Source\StudentPortal3G\Controllers\BaseController.cs:line 40
   at JCDCHelper.MVCController.JCDCBaseController..ctor(INetLog passNetLog, IUserMaintBLL passUserMaintBLL) in d:\CC\JCDCHelper.MVCController\Source\JCDCHelper.MVCController\JCDCBaseController.cs:line 47
   at JCDCHelper.MVCController.JCDCBaseController..ctor() in d:\CC\JCDCHelper.MVCController\Source\JCDCHelper.MVCController\JCDCBaseController.cs:line 33
   at StudentPortal3G.Controllers.HomeController..ctor() in d:\CC\StudentPortal3G\Source\StudentPortal3G\Controllers\HomeController.cs:line 35
   --- End of inner exception stack trace ---
   at System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandleInternal& ctor, Boolean& bNeedSecurityCheck)
   at System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache)
   at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean skipVisibilityChecks, Boolean skipCheckThis, Boolean fillCache)
   at System.Activator.CreateInstance(Type type, Boolean nonPublic)
   at System.Web.Mvc.DefaultControllerFactory.DefaultControllerActivator.Create(RequestContext requestContext, Type controllerType)
   --- End of inner exception stack trace ---
   at System.Web.Mvc.DefaultControllerFactory.DefaultControllerActivator.Create(RequestContext requestContext, Type controllerType)
   at System.Web.Mvc.DefaultControllerFactory.CreateController(RequestContext requestContext, String controllerName)
   at System.Web.Mvc.MvcHandler.ProcessRequestInit(HttpContextBase httpContext, IController& controller, IControllerFactory& factory)
   at System.Web.Mvc.MvcHandler.<>c__DisplayClass6.<BeginProcessRequest>b__2()
   at System.Web.Mvc.SecurityUtil.<>c__DisplayClassb`1.<ProcessInApplicationTrust>b__a()
   at System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust[TResult](Func`1 func)
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

但是我*知道*这些节点中没有两个，如果是这样，每次都会发生错误。

以前有人经历过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:35:04.790

我在一个项目上使用 MvcSiteMapProvider，但我不喜欢它。我遇到的问题之一是它不是线程安全的（或者至少这是我的结论）。如果我同时在多个页面上进行第一次加载，我会遇到类似的错误。除了为源代码做出贡献外，我不知道有任何解决方法。我的猜测是 /home 是您的 xml 中的第一个节点，并且当它再次开始运行时它已经加载。

# ajax - 需要在 IE7 中跨域 ajax 发布的解决方法

> ID：10654955
> 
> 赞同：4
> 
> 时间：2012-05-18T14:55:41.080
> 
> 标签：ajax, internet-explorer-7, cors

所以IE7不支持CORS（跨源资源共享）。但是，由于我的应用程序的性质，我必须发布一个跨域 ajax 帖子。有没有办法让它在 IE7 中工作？不幸的是，出于安全原因，我不能使用服务器端代理。也许使用 iFrame？

我忘了提，但我也控制着另一台服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T19:22:12.697

[Easy XDM 库](http://easyxdm.net/wp/)是为解决跨源问题而开发的：

> easyXDM 是一个 Javascript 库，使您作为开发人员能够轻松解决同源策略设置的限制，从而使跨域边界的通信和公开 javascript API 变得容易。

我还没有使用它，但我们可能不得不尝试它来解决一个 Http / HTTPS Ajax 调用问题......

希望有帮助。

其他感兴趣的话题：

*   [在 http 页面上使用 https 的 Ajax](https://stackoverflow.com/questions/1105934/ajax-http-https-problem)
*   [AJAX、子域和 SSL](https://stackoverflow.com/questions/231478/ajax-subdomains-and-ssl)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T17:09:14.530

用老式的方式来做：使用外部域将表单发布到 iframe。您可以在 iframe 上监听 onload 事件以了解它已完成。

另一种选择是使用服务器端代理并从那里发布。

# pdf - Solr pdf 索引 - 只做一些内容

> ID：10654959
> 
> 赞同：0
> 
> 时间：2012-05-18T14:55:58.787
> 
> 标签：pdf, solr

我有一个 pdf 文档，我正在尝试使用 solr 单元对其进行索引。我使用以下命令：

```
 curl "http://localhost:8983/solr/update/extract?   stream.file=/home/Desktop/DOCUMENTS/x.pdf&stream.contentType=application/pdf&literal.id=DOC_N&commit=true" 
```

问题是当我搜索“：”时，我发现它只索引了文本字段中的目录。文档的内容未编入索引。我对 solr 还很陌生，不知道为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T17:57:24.643

也许文档文本大于`<maxFieldLength>`您可以尝试将`<maxFieldLength>`solrconfig.xml 中的内容更改为更高的内容，然后重新索引。

[http://wiki.apache.org/solr/SolrConfigXml#mainIndex_Section](http://wiki.apache.org/solr/SolrConfigXml#mainIndex_Section)

# facebook - 可再生访问令牌的目的是什么？

> ID：10654960
> 
> 赞同：0
> 
> 时间：2012-05-18T14:56:07.723
> 
> 标签：facebook, facebook-graph-api, oauth

随着最近的弃用`offline_access`，Facebook 允许应用程序将短期令牌“扩展”为长期令牌。只要令牌尚未过期，它们也可以“更新”。[1]

`offline_access`如果“扩展”需要明确的用户选择加入（如旧权限），那么从安全/隐私的角度来看，这对我来说是有意义的。但似乎应用程序可以透明地扩展和更新，无需用户操作。例如，iOS 应用程序通过一个简单的 HTTP 请求来执行此操作。[2][3][4]

鉴于此，此功能的目的是什么？它似乎并不比过期令牌更安全/私密，而且对于应用程序来说似乎并不比生命周期令牌更方便（例如 Twitter 和 LinkedIn）。

[1] [https://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)

[2] [https://developers.facebook.com/docs/mobile/ios/build/#extend_token](https://developers.facebook.com/docs/mobile/ios/build/#extend_token)

[3] [https://developers.facebook.com/docs/reference/iossdk/authentication/](https://developers.facebook.com/docs/reference/iossdk/authentication/)

[4] [https://github.com/facebook/facebook-ios-sdk/blob/v1.2/src/Facebook.m#L352-L359](https://github.com/facebook/facebook-ios-sdk/blob/v1.2/src/Facebook.m#L352-L359)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T18:37:15.077

好吧，我阅读[文档](https://developers.facebook.com/roadmap/offline-access-removal/)的方式：

> **场景 4：客户端 OAuth 和通过新端点延长 Access_Token 过期时间**
> 
> 使用下面的新端点，您将能够延长现有的、未过期的、短期用户 access_token 的过期时间。请注意，**端点只能用于扩展短期用户 access_tokens。**如果您传递具有长期过期时间的 access_token，端点将简单地将相同的 access_token 传递回给您，而不会更改或延长过期时间。
> 
> 如果您想**刷新仍然有效的长寿命 access_token，则必须先获取一个新的短寿命用户 access_token**，然后再调用下面的相同端点。返回的 access_token 将有一个新的长寿命到期时间，但是，access_token 本身可能与先前授予的长寿命 access_token 相同也可能不同。

在我看来，你不能无休止地扩展你的令牌。据我了解，目标是防止应用程序拥有大量不使用该应用程序的用户 - 但应用程序仍然可以访问用户数据。因此，FB 希望删除对无人使用的应用程序的用户数据的访问权限。

关于

> 但似乎应用程序可以透明地扩展和更新，无需用户操作。例如，iOS 应用程序通过一个简单的 HTTP 请求来执行此操作。[2][3][4]

仅当用户登录 Facebook 并使用其中使用 facebook 应用程序的 iOS 应用程序时，这才有效。这意味着用户处于活动状态，并且正在使用该应用程序。如果用户在 60 天内不使用它，则该令牌将过期并且不能再自动延长。但这与上面的“场景 4”相矛盾……不知道从中得到什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T14:06:39.313

没有听到任何更好的答案，我最好的猜测是他们确实希望应用程序具有长期访问权限（无需反复询问用户），同时减少受损令牌可能造成的损害（因为它已过期）。

我不确定是否是这种情况，因为我不确定被盗用的令牌在实践中是否真的是一个问题（因为应用程序开发人员仍然可以轻松地撤销被盗用的令牌）。

朋友提到的另一种可能性是，这有助于 Facebook 收集更多关于应用程序使用情况的数据/分析。但我也不确定是否是这种情况，因为似乎令牌可以在没有用户输入或干预的情况下更新。

所以在这一点上，我最好的猜测是稍微提高安全性，同时仍然允许应用程序进行长期访问。

# android - 用户单击时图像 GridView 显示大图像

> ID：10654968
> 
> 赞同：1
> 
> 时间：2012-05-18T14:56:54.153
> 
> 标签：android

我在android中编码图像gridview，我想问你如何在用户单击gridview中的小图像时显示大图像以及如何使gridview能够通过滑动滚动，因为我的画廊有很多图像。

这是我的代码：

```
public class myalbum extends Activity {

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.myalbum);

    GridView gridView = (GridView) findViewById(R.id.gridview);
    gridView.setAdapter(new ImageAdapter(this));

    gridView.setOnItemClickListener(new GridView.OnItemClickListener() 
    {
        public void onItemClick(AdapterView<?> parent, View v, int position, long id) 
        {                
            //Here I want to see Large Image???? How can i do?????
            Toast.makeText(myalbum.this, "" + position, Toast.LENGTH_SHORT).show();
        }
    });        
}

public class ImageAdapter extends BaseAdapter {
    private Context mContext;

    public ImageAdapter(Context c) {
        mContext = c;
    }

    public int getCount() {
        return mThumbIds.length;
    }

    public Object getItem(int position) {
        return null;
    }

    public long getItemId(int position) {
        return 0;
    }

    HashMap<Integer, Matrix> mImageTransforms = new HashMap<Integer,Matrix>();
    Matrix mIdentityMatrix = new Matrix();
    //---returns an ImageView view---
 // create a new ImageView for each item referenced by the Adapter
    public View getView(int position, View convertView, ViewGroup parent) {
        ImageView imageView;
        if (convertView == null) {  // if it's not recycled, initialize some attributes
            imageView = new ImageView(mContext);
            imageView.setLayoutParams(new GridView.LayoutParams(88, 88));
            imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
            imageView.setPadding(2, 2, 2, 2);
        } else {
            imageView = (ImageView) convertView;
        }

        Matrix m = mImageTransforms.get(position);
        if ( null == m ) {
            m = mIdentityMatrix;
        }
        imageView.setImageMatrix(m);
        imageView.setImageResource(mThumbIds[position]);
        return imageView;
    }

    void setImageRotation(int position, int degrees) {
        Matrix m = mImageTransforms.remove(position);        
        if ( degrees != 0 ) {
            if ( null == m ) m = new Matrix();
            m.setRotate(degrees);
            mImageTransforms.put(position, m);
        }
        notifyDataSetChanged();
    }

    private Integer[] mThumbIds = {
            R.drawable.p1, R.drawable.p2,
            R.drawable.p1, R.drawable.p2,
            R.drawable.p1, R.drawable.p2,
            R.drawable.p1, R.drawable.p2,
            R.drawable.p3, R.drawable.p4
    };
  }
} 
```

最好的问候， 维拉克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:14:02.777

实际上，我无法到达您实际想要显示图像的位置。顺便说一句，您需要在 FrameLayout 中添加您的网格视图，之后您可以以编程方式创建布局（背景颜色透明）以相同的方式将 imageView 添加到它并将该布局添加到您的 frameLayout 并在图像上单击您可以设置它可见性为可见，因此它在您的网格视图顶部显示图像，因为您只需在 FB 上查看图像并提供关闭按钮，该按钮将该布局的可见性设置为 Gone。

希望这对您有所帮助。让我知道是否有任何问题..

# javascript - 使用 JS 和 html5 从字符串创建文本文件

> ID：10654971
> 
> 赞同：15
> 
> 时间：2012-05-18T14:57:05.650
> 
> 标签：javascript, html, file, download, createfile

我想从字符串创建一个文本文件。目前我正在使用一个函数，它接受一个数组并将其转换为一个字符串，然后使用该字符串创建一个用户下载的本地文本文件。我试过用这个方法

```
 function createFile(){ //creates a file using the fileLIST list 
    var output= 'Name \t Status\n'+ fileLIST[0][0].name+'\t'+fileLIST[0][1]+'\n';
    var Previous = fileLIST[0];
    for (var i=1; i<fileLIST.length; i++)
        if (fileLIST[i][1] =='none' || fileLIST[i][1] == Previous[1])
            continue
        else {
            Previous = fileLIST[i]
            output = output + fileLIST[i][0].name +'\t'+fileLIST[i][1] + '\n';}

    window.open("data:text/json;charset=utf-8," + escape(output));//should create file
    display();  } 
```

我使用 chrome 作为我的浏览器。我也更喜欢 JS 或 HTML5 答案。

先感谢您

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2015-02-10T01:42:25.707

将您的转换`object`为 JSON 字符串。

```
var json_string = JSON.stringify(object, undefined, 2); 
```

笔记：

1.  如果您已经有一个字符串，请跳过上面的步骤。
2.  如果您不希望它被很好地格式化，请删除`, undefined, 2`.

创建一个下载链接并单击它：

```
var link = document.createElement('a');
link.download = 'data.json';
var blob = new Blob([json_string], {type: 'text/plain'});
link.href = window.URL.createObjectURL(blob);
link.click(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-21T20:00:48.957

BlobBuilder 现在已过时。改用这个：

[https://developer.mozilla.org/en-US/docs/Web/API/Blob#Blob_constructor_example_usage](https://developer.mozilla.org/en-US/docs/Web/API/Blob#Blob_constructor_example_usage)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-22T18:38:41.080

我最终改用了这段代码。它会创建一个链接来下载文件的 url。

```
 window.URL = window.webkitURL || window.URL;
    window.BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder ||       window.MozBlobBuilder;
    file = new WebKitBlobBuilder();
    file.append(output); 
    var a = document.getElementById("downloadFile");
    a.hidden = '';
    a.href = window.URL.createObjectURL(file.getBlob('text/plain'));
    a.download = 'filename.txt';
    a.textContent = 'Download file!';
} 
```

这种方式也减少了网站，使其成为一个较轻的网站，用于慢速连接。我的 html 有一个空的 div，它附加到其中。

```
 <div class ='paginationLIST' id='pagination'></div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T15:20:44.500

我建议您使用 hidden`iframe`而不是`window.open`使其成为“更清洁的方法”

我相信这是[`text/octet-stream`](http://jsfiddle.net/sgQTN/)而不是`text/json`强制下载。据我所知，您不能以这种方式设置文件名。

但是，Chrome（我认为是 18 岁以上）的[标签有一个](http://html5-demos.appspot.com/static/a.download.html)[`download`属性`<a>`](http://html5-demos.appspot.com/static/a.download.html)，您可以指定文件的名称以及`blob:`用于 url。

# stored-procedures - 在 Crystal Reports XI 中，我可以从动态级联参数填充存储的两个过程参数吗？

> ID：10654972
> 
> 赞同：0
> 
> 时间：2012-05-18T14:57:19.307
> 
> 标签：stored-procedures, parameters, crystal-reports

我正在使用 Crystal Reports XI 构建一个报表，该报表调用一个需要参数 @Type_ID 和 @Subtype_ID 的 SQL Server 存储过程。

数据库中还有一个表，它以一对多的关系关联类型和子类型。

我想让报告的参数提示屏幕要求：

*   类型 - 列出的类型之一或 Null。如果为 Null，则屏幕不会询问子类型。

*   子类型 - 与所选类型或 Null 关联的列出的子类型之一。

...并将这两个值分别作为@Type_ID 和@Subtype_ID 传递给存储过程。（如果存储过程得到@Type_ID = Null，它将返回所有类型的记录。如果它得到@Type_ID <> Null 并且@Subtype_ID = Null，它将返回与所选类型关联的所有子类型的记录。）

**有没有办法让我的水晶报表做这一切？**

到目前为止，使用来自[这个答案](https://stackoverflow.com/a/7197014/179)的建议，我在@Subtype_ID 上设置了一个动态级联参数 (DCP)，它以我上面描述的方式请求一个类型，然后是一个子类型，然后将选定的子类型传递给 @Subtype_ID。但是，我还没有弄清楚如何将通过这个 DCP 选择的 Type 传递给 @Type_ID，这样如果 Subtype 为 Null，则存储过程可以返回所有具有所选 Type 的记录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T11:47:31.733

问题是您的过程定义创建了两个参数：`TYPE_ID`和`SUBTYPE_ID`. Crystal Reports 的参数（动态或静态）并非旨在相互交互。

在我看来，您有三个选择：

*   *创建一个包含您想要的单个*提示组的报表（确保提示组创建两个参数）（主报表不需要数据源，顺便说一句）；插入一个使用您的过程的子报表（它将创建两个参数）；将主报告中的参数链接到子报告中的参数；如有必要，您可以在主报表中创建公式（然后将其链接到子报表中的两个参数）以获得额外的逻辑（例如，将“All Type Id”的参数值转换为 NULL）。

*   重构您的过程，使其具有一个`VARCHAR`参数，该参数将接收连接的`TYPE_ID`and `SUBTYPE_ID`。创建一个动态参数，该参数将具有键和描述的连接值（例如 1/3；类型 [1] - 子类型 [3]）。您的过程逻辑将需要解析参数的值以确定 和 的`TYPE_ID`值`SUBTYPE_ID`。您需要创建一个生成键和描述的查询，它们将通过 BusinessView 的各个层公开。

*   放弃该过程以支持命令或“正常”查询。以我的经验，**绝大多数报告都可以在没有存储过程的情况下构建**。结合单个提示组，这将为您提供所需的灵活性。

# jpa - org.apache.openjpa.persistence.ArgumentException 在查询 openJPA 时执行

> ID：10654973
> 
> 赞同：1
> 
> 时间：2012-05-18T14:57:23.713
> 
> 标签：jpa, jpql

假设我有一个与存储在列表中的实体关联的 ID 列表。如果我在 JPQL 中使用 IN 关键字，则将此列表传递给函数，那么我应该获得与在我假设的常规查询语言中使用相同的功能......

但是每当我尝试运行我的代码时，我都会遇到这个异常......我的代码看起来像这样......

```
public void UpdateEntityByPerson(int ID, int[] EntityIDs) {
    // TODO Auto-generated method stub
    List<EntityList> distList = null;//new ArrayList<EntityList>();
    try{        
        Provider prov = emf.find(Provider.class, new Long(ID));
        prov.setDistListPermCollection(null);
        distList = emf.createNamedQuery("getEntityListByListIds").setParameter("listIds", EntityIDs).getResultList();
        prov.setEntityListPermCollection(distList);         
    }
    catch(Exception ex){
        System.out.println("Exception : "+ex);
        ex.printStackTrace();
    }
} 
```

这是我的 JPQL 命名查询...

```
@NamedQuery(name="getEntityistByListIds", query = "SELECT d FROM EntityList d WHERE d.listId in :listIds"), 
```

我在这里做错了什么？我想到的一件事是我有一个整数数组...... EntityID 实际上是长......这可能会导致轻微的 brew-ha-ha！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T16:51:26.007

当 EntityList 中的 listId 属性类型为 long 时，IN 的参数类型必须为 single`Long`或`long`value 或`List<Long>`。因此，在您的以下类型的论点中适用：

```
List<Long> EntityIDs = Arrays.asList(new Long[]{1L, 2L});
Long EntityIDs = 0;
long EntityIDs = 0; 
```

在规范中，它以更一般的形式拼写如下：

> 文字和/或输入参数值必须与 type 中 state_field_path_expression 的抽象模式类型相同。
> 
> 只允许比较相似类型的值。如果一个类型对应于相同的 Java 语言类型，或者如果一个类型是原始 Java 语言类型而另一个是包装的 Java 类类型等价物（例如，在这个意义上，int 和 Integer 是类似的类型），则它们就像另一种类型。此规则有一个例外：比较适用数值提升规则的数值是有效的。除了这种数字情况外，不允许尝试比较非相似类型值的条件表达式。

对我来说，根据规范，`int`当路径指向 long 时，您还可以为 IN 提供参数，但至少 Hibernate 的实现并非如此。

# php - 带有数组的php for循环

> ID：10654975
> 
> 赞同：0
> 
> 时间：2012-05-18T14:57:29.067
> 
> 标签：php, arrays, for-loop

第 1 部分：我需要为一组数组变量创建一个循环

```
for ($cnt=1; $cnt<=$qty; $cnt++) {
      $firstvar.$cnt['Code'] = '02';
      $secondvar.$cnt['Type'] = $somevar;
      $thirdvar.$cnt['Code'] = 'IN';
   } 
```

// 结果为

```
 $firstvar1['Code'] = '02';
      $secondvar1['Type'] = $somevar;
      $thirdvar1['Code'] = 'IN';

      $firstvar2['Code'] = '02';
      $secondvar2['Type'] = $somevar;
      $thirdvar2['Code'] = 'IN';  

//etc. 
```

但是，$cnt 变量的解析似乎与数组冲突。

第 2 部分：然后我需要创建一个变量数组，如下所示：

```
 $lastvar['Thing'] = array( $thirdvar1, $thirdvar2, ... $thirdvar.$qty ); 
```

在这里，使用 for 循环创建一个简单的字符串并将其放入数组中是行不通的。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T15:01:12.980

为什么不直接做所有事情？

```
foreach ($cnt as $c) {
    $firstvar[$c['Code']] = 02;
    $secondvar[$c['Type']] = $somevar;
    $lastvar['Thing'][] = 'IN';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T15:01:19.907

第 1 部分：`$firstvar.$cnt['Code']`应该是`${"firstvar$cnt"}['Code']`（或`${'firstvar'.$cnt}['Code']`）。

第2部分：

```
for ($cnt=1; $cnt<=$qty; $cnt++) {
    $lastvar['Thing'][] = ${'thirdvar'.$qty};
} 
```

第 3 部分：（我的！）
将所有内容放在同一个循环中：

```
for ($cnt=1; $cnt<=$qty; $cnt++) {
  ${'firstvar'.$cnt}['Code']  = 02;
  ${'secondvar'.$cnt}['Type'] = $somevar;
  ${'thirdvar'.$cnt}['Code']  = 'IN';
  $lastvar['Thing'][]         = ${thirdvar$qty}; 
```

}

请记住，如果您使用数组而不是变量名称连接，则此代码会更简洁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T15:06:32.840

```
<?php
$somevar = "testValue";
$qty = 5;
$lastvar['Thing'] = array();
for($cnt=1; $cnt<=$qty; $cnt++) 
{
    ${"firstvar$cnt"} = array('Code' => '02', 'Type' => $someVar, "Code" => "IN");
    $lastvar['Thing'][] = ${"firstvar$cnt"};
}

var_dump($lastvar); 
```

应该管用。

# java - 如何在 Java 中管理堆空间

> ID：10654980
> 
> 赞同：0
> 
> 时间：2012-05-18T14:57:50.943
> 
> 标签：java, heap-memory

我正在尝试递归遍历我的驱动器以搜索一些文件。当文件夹/文件有限时，代码工作正常，但是当我将搜索目标定位到 C 驱动器时，我有很多文件，它会抛出堆内存不足。

**线程“Thread-4”java.lang.OutOfMemoryError 中的异常：Java 堆空间**

1.  请建议我一些好的内存管理技巧，尤其是在我们进行递归调用时。
2.  或者给我更好的方法来遍历目录而不递归。

而且我不想增加最大允许堆空间，因为这就像暂时推迟问题一样。

代码：

```
void iterateDirectory(String somedir) {

        File dir = new File(somedir);
        File[] files = dir.listFiles();
        if (files != null) {
            for (int id = 0; id < files.length; id++) {
                if (files[id].isDirectory() == false) 
                {
                   fsTree.add(files[id].toString()); // taking list of files
                } 
                else 
                {
                    iterateFilesInDirectory(files[id].getAbsolutePath());
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T15:37:44.247

正如我所见，罪魁祸首是这一行：

```
fsTree.add(files[id].toString()); // taking list of files 
```

您似乎将*每个文件*添加到全局数据结构 ( `fsTree`)，然后在那里搜索。

我的赌注是：

A.如果您将递归函数“转换”为迭代函数，它*不会消失。*

B.如果不是附加到全局数据结构并最终搜索，而是在本地进行搜索/匹配，并且仅全局缓存匹配的命中，*它将消失：*

```
void iterateDirectory (String somedir, String search_term) {

    File dir = new File(somedir);
    File[] files = dir.listFiles();
    if (files != null) {
        for (int id = 0; id < files.length; id++) {
            if (files[id].isDirectory() == false) 
            {
               if (/* files[id].isDirectory() MATCHES search_term */)
                 // add to list of matching files:
                 matching_hits.add(files[id].toString());
            } 
            else 
            {
                iterateFilesInDirectory(files[id].getAbsolutePath());
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T15:03:25.273

有两种可能：

1.  您的代码中有无限递归（例如，因为您没有处理`.`和/或不`..`正确）。如果是这种情况，您必须修复代码。
2.  您的代码确实需要比可用空间更多的堆空间。你有两个选择：
    *   减少进程的内存需求（内存分析器可以帮助您了解使用所有堆空间的内容）；
    *   通过指定`-Xmx`JVM 选项来增加堆大小。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-18T15:01:40.363

递归可以做什么是有限制的，即关于堆栈/堆的使用。请记住，无论您可以递归执行什么操作，都可以迭代执行；重写您的代码以使用迭代解决方案。

替代解决方案：有一个接口`java.nio`可用于递归地遍历文件系统的结构。看看[这条小径](http://docs.oracle.com/javase/tutorial/essential/io/walk.html)，然后[`SimpleFileVisitor`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/SimpleFileVisitor.html)。

# c# - 如何通过添加注册表项将用户添加到“从网络访问此计算机”本地策略？

> ID：10654983
> 
> 赞同：3
> 
> 时间：2012-05-18T14:58:03.920
> 
> 标签：c#, .net, wpf, registry

您知道如何在本地政策中添加用户吗？我需要这样的效果

**gpedit.msc -> 计算机配置/Windows 设置/安全设置/本地策略/用户权限分配/“从网络访问这台计算机”**

我想通过添加注册表项或从 cmd 运行命令来做到这一点。如果您有任何提示或互联网资源要分享，我会很高兴。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T15:00:38.150

这是我之前准备的一个。我们使用下面的（冗长，抱歉）包装类来授予“作为服务登录的权利”。对此的呼吁如下：

```
var identity = new WindowsIdentity(logonName);
LsaSecurityWrapper.AddAccountRights(identity.User.AccountDomainSid,
    "SeServiceLogonRight"); 
```

您只需要用您自己的替换“SeServiceLogonRight”。一个快速的谷歌告诉我这应该是“SeNetworkLogonRight”。如果你想在控制台应用程序中使用它，那么你可以快速编译一个。像这样设置你的`Main`方法：

```
static void Main(string[] args)
{
    var identity = new WindowsIdentity(args[0]);
    LsaSecurityWrapper.AddAccountRights(identity.User.AccountDomainSid, args[1]);
} 
```

然后调用为`YourConsoleApp.exe logon right`。这是包装：

```
[StructLayout(LayoutKind.Sequential)]
internal struct LSA_OBJECT_ATTRIBUTES
{
    internal int Length;
    internal IntPtr RootDirectory;
    internal IntPtr ObjectName;
    internal int Attributes;
    internal IntPtr SecurityDescriptor;
    internal IntPtr SecurityQualityOfService;
}

/// 
/// LSA_UNICODE_STRING structure
/// 
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
internal struct LSA_UNICODE_STRING
{
    internal ushort Length;
    internal ushort MaximumLength;
    [MarshalAs(UnmanagedType.LPWStr)] internal string Buffer;
}

/// 
/// Wraps LsaAddAccountRights call.
/// 
public sealed class LsaSecurityWrapper
{
    [DllImport("advapi32", CharSet = CharSet.Unicode, SetLastError = true),
     SuppressUnmanagedCodeSecurityAttribute]
    internal static extern uint LsaOpenPolicy(
        LSA_UNICODE_STRING[] SystemName,
        ref LSA_OBJECT_ATTRIBUTES ObjectAttributes,
        int AccessMask,
        out IntPtr PolicyHandle
        );

    [DllImport("advapi32", CharSet = CharSet.Unicode, SetLastError = true),
     SuppressUnmanagedCodeSecurityAttribute]
    internal static extern uint LsaAddAccountRights(
        LSA_HANDLE PolicyHandle,
        IntPtr pSID,
        LSA_UNICODE_STRING[] UserRights,
        int CountOfRights
        );

    [DllImport("advapi32", CharSet = CharSet.Unicode, SetLastError = true),
     SuppressUnmanagedCodeSecurityAttribute]
    internal static extern uint LsaRemoveAccountRights(
        LSA_HANDLE PolicyHandle,
        IntPtr AccountSid,
        bool AllRights,
        LSA_UNICODE_STRING[] UserRights,
        int CountOfRights
        );

    [DllImport("advapi32")]
    internal static extern int LsaClose(IntPtr PolicyHandle);

    private enum Access : int
    {
        POLICY_READ = 0x20006,
        POLICY_ALL_ACCESS = 0x00F0FFF,
        POLICY_EXECUTE = 0X20801,
        POLICY_WRITE = 0X207F8
    }

    // rights: (http://msdn.microsoft.com/en-us/library/bb545671(VS.85).aspx)
    public static void AddAccountRights(SecurityIdentifier sid, string rights)
    {
        IntPtr lsaHandle;

        LSA_UNICODE_STRING[] system = null;
        LSA_OBJECT_ATTRIBUTES lsaAttr;
        lsaAttr.RootDirectory = IntPtr.Zero;
        lsaAttr.ObjectName = IntPtr.Zero;
        lsaAttr.Attributes = 0;
        lsaAttr.SecurityDescriptor = IntPtr.Zero;
        lsaAttr.SecurityQualityOfService = IntPtr.Zero;
        lsaAttr.Length = Marshal.SizeOf(typeof(LSA_OBJECT_ATTRIBUTES));
        lsaHandle = IntPtr.Zero;

        uint ret = LsaOpenPolicy(system, ref lsaAttr, (int)Access.POLICY_ALL_ACCESS, out lsaHandle);
        if (ret == 0)
        {
            Byte[] buffer = new Byte[sid.BinaryLength];
            sid.GetBinaryForm(buffer, 0);

            IntPtr pSid = Marshal.AllocHGlobal(sid.BinaryLength);
            Marshal.Copy(buffer, 0, pSid, sid.BinaryLength);

            LSA_UNICODE_STRING[] privileges = new LSA_UNICODE_STRING[1];

            LSA_UNICODE_STRING lsaRights = new LSA_UNICODE_STRING();
            lsaRights.Buffer = rights;
            lsaRights.Length = (ushort)(rights.Length * sizeof(char));
            lsaRights.MaximumLength = (ushort)(lsaRights.Length + sizeof(char));

            privileges[0] = lsaRights;

            ret = LsaAddAccountRights(lsaHandle, pSid, privileges, 1);

            LsaClose(lsaHandle);

            Marshal.FreeHGlobal(pSid);

            if (ret != 0)
            {
                throw new Win32Exception("LsaAddAccountRights failed with error code: " + ret);
            }
        }
        else
        {
            throw new Win32Exception("LsaOpenPolicy failed with error code: " + ret);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T15:03:31.300

我怀疑你需要使用 pinvoke 并环绕适当的 Lsa 函数， http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms721786](http://msdn.microsoft.com/en-us/library/windows/desktop/ms721786(v=vs.85).aspx) (v=vs.85).aspx http:// /www.pinvoke.net/default.aspx/advapi32.lsaaddaccountrights

# javascript - 如何获取 JavaScript 字典中的键集合？

> ID：10654992
> 
> 赞同：144
> 
> 时间：2012-05-18T14:58:41.190
> 
> 标签：javascript, dictionary

我有一本字典：

```
var driversCounter = {
    "one":   1,
    "two":   2,
    "three": 3,
    "four":  4,
    "five":  5
} 
```

现在，我需要在下拉列表中显示它。如何获取字典中的键集合？

* * *

## 回答 #1

> 赞同：235
> 
> 时间：2012-05-18T15:00:00.783

在旧版浏览器中使用[`Object.keys()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys)或[*填充它...*](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys#Compatiblity)

```
const keys = Object.keys(driversCounter); 
```

如果你想要*values*，那么[`Object.values()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/Object/values)如果你想要 key*和*value ，你可以使用，通常与这样[`Object.entries()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/entries)配对......`Array.prototype.forEach()`

```
Object.entries(driversCounter).forEach(([key, value]) => {
   console.log(key, value);
}); 
```

* * *

或者，考虑到您的用例，也许这会做到......

```
var selectBox, option, prop;

selectBox = document.getElementById("drivers");

for (prop in driversCounter) {
   option = document.createElement("option");
   option.textContent = prop;
   option.value = driversCounter[prop];
   selectBox.add(option);
} 
```

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2012-05-18T15:00:12.983

一种选择是使用[`Object.keys()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys)：

```
Object.keys(driversCounter) 
```

它适用于现代浏览器（但是，Internet Explorer 仅从[版本 9](https://en.wikipedia.org/wiki/Internet_Explorer_9)开始支持它）。

**[要添加兼容支持，您可以复制MDN](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys)**中提供的代码片段。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-05-18T15:00:41.437

要遍历“字典”（我们在 JavaScript 中将其称为对象），请使用`for in`循环：

```
for(var key in driversCounter) {
    if(driversCounter.hasOwnProperty(key)) {
        // key                 = keys,  left of the ":"
        // driversCounter[key] = value, right of the ":"
    }
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-05-18T15:03:43.890

这将适用于所有 JavaScript 实现：

```
var keys = [];

for (var key in driversCounter) {
    if (driversCounter.hasOwnProperty(key)) {
        keys.push(key);
    }
} 
```

像之前提到的其他人一样，您可以使用`Object.keys`，但它可能不适用于旧引擎。所以你可以使用下面的猴子补丁：

```
if (!Object.keys) {
    Object.keys = function (object) {
        var keys = [];

        for (var key in object) {
            if (object.hasOwnProperty(key)) {
                keys.push(key);
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-05-10T13:18:27.893

只需使用`Object.keys()`：

```
var driversCounter = {
                      "one": 1,
                      "two": 2,
                      "three": 3,
                      "four": 4,
                      "five": 5
                     }
console.log(Object.keys(driversCounter));
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-05-18T15:00:09.457

借助现代 JavaScript 引擎，您可以使用`Object.keys(driversCounter)`.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-05-18T15:00:47.030

对于新浏览器：`Object.keys( MY_DICTIONARY )`将返回一个键数组。否则，您可能想走老路：

```
var keys = []
for(var key in dic) keys.push( key ); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-05-18T15:01:43.870

正如其他人所说，您*可以*使用`Object.keys()`，但谁在乎旧浏览器，对吧？

嗯，我愿意。

试试[这个](http://phpjs.org/functions/array_keys:324)。`array_keys`从 PHPJS 移植*PHP*的便利`array_keys`功能，所以它可以在 JavaScript 中使用。

乍一看，`Object.keys`如果支持，它就会使用，但它处理不太容易的情况。它甚至包括根据您可能正在寻找的值过滤键（可选）以及是否使用严格比较`===`与类型转换比较`==`（可选）的切换。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-08-31T20:16:31.457

如果你可以使用 jQuery 那么

```
var keys = [];
$.each(driversCounter, function(key, value) {
    keys.push(key);
});

console.log(JSON.stringify(keys)); 
```

以下是答案：

```
["one", "two", "three", "four", "five"] 
```

这样您就不必担心浏览器是否支持该`Object.keys`方法。

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2012-05-18T15:10:02.837

另一种方法是使用多维数组：

```
var driversCounter = [
    ["one", 1], 
    ["two", 2], 
    ["three", 3], 
    ["four", 4], 
    ["five", 5]
] 
```

并通过 driverCounter[k][j] 访问该值，在这种情况下 j=0,1。
通过以下方式将其添加到下拉列表中：

```
var dd = document.getElementById('your_dropdown_element');
for(i=0;i<driversCounter.length-1;i++)
{
    dd.options.add(opt);
    opt.text = driversCounter[i][0];
    opt.value = driversCounter[i][1];
} 
```

# ms-access - Docmd.Runsql 更新按组选择最大记录

> ID：10654993
> 
> 赞同：1
> 
> 时间：2012-05-18T14:58:49.537
> 
> 标签：ms-access, group-by

我正在寻找“Group_ID”列中每个组的“Points”列中的最高值。下面的代码更新最高值的值，但不会按组 ID 更新通过 DoCmd.RunSQL 在 VBA 中运行的代码：

```
DoCmd.RunSQL "Update Bos Set Flag = 'x' WHERE Points = (SELECT Max(Points) From Bos)" 
```

添加以下“分组依据”代码后，它会因语法错误而失败：

```
DoCmd.RunSQL "Update Bos Set Flag = 'x' WHERE Points = (SELECT Max(Points) From Group By Group_ID From Bos)" 
```

我确定 group by 不正确，但我不确定下一步。任何帮助，将不胜感激。

# windows-phone-7 - Windows Phone 7 jQuery mobile 水平滚动失败

> ID：10654994
> 
> 赞同：0
> 
> 时间：2012-05-18T14:59:00.780
> 
> 标签：windows-phone-7, jquery-mobile, horizontal-scrolling

我在 Windows Phone 7 上使用 jQuery mobile。我有一个标题和内容。我的问题是，内容的宽度为 100%，这很好，但标题超过 100%，因为我可以滚动 Webbrowser，并且标题右侧有一个黑条。这向我解释了它更大。但我不知道在不滚动的情况下我必须改变什么。

感谢新人

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T16:17:45.877

这可能是视口问题。在您的`<Head>`标签中，尝试添加以下内容：

```
<meta name="viewport" content="width=device-width, initial-scale=1"> 
```

如果可行，请搜索“元视口”以获取有关如何进一步控制用户体验的详细信息。