# StackOverflow 问答 000611000-000611999

# java - Swing 应用程序框架的表单设置存储在哪里？

> ID：611005
> 
> 赞同：0
> 
> 时间：2009-03-04T15:15:05.967
> 
> 标签：java, swing

我想删除它们，因为由于某种原因，我的表格在启动时恢复到错误的尺寸。

我没有在我的用户目录中找到任何东西，但我不确定要查找什么。

我对 Windows 和 Linux 感兴趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T15:24:22.653

从[这里](https://appframework.dev.java.net/nonav/javadoc/AppFramework-1.03/index.html)：

> 会话状态通过 LocalStorage 保存和加载方法存储在本地，相对于用户的主目录。启动方法必须设置 ApplicationContext vendorId 和 applicationId 属性，以确保在所有平台上选择正确的本地目录。例如，在 Windows XP 上，文件名“session.xml”的完整路径名通常是：
> 
> ${userHome}\Application Data\${vendorId}\${applicationId}\session.xml
> 
> 其中 ${userHome} 的值是 Java 系统属性“user.home”的值。在 Solaris 或 Linux 上，该文件是：
> 
> ${userHome}/.${applicationId}/session.xml
> 
> 在 OSX 上：
> 
> ${userHome}/Library/Application Support/${applicationId}/session.xml

# sql - 包含其主键的列的 SQL MAX

> ID：611011
> 
> 赞同：4
> 
> 时间：2009-03-04T15:16:35.823
> 
> 标签：sql, sql-server, tsql, max

### 短的：

从下面的 sql 选择我得到 cart_id 和该购物车中的最大值项目的值。

```
SELECT CartItems.cart_id, MAX(ItemValues.value)
FROM CartItems 
INNER JOIN ItemValues 
ON CartItems.item_id=ItemValues.item_id
GROUP BY CartItems.cart_id 
```

但我还需要该项目的 item_id (ItemValues.item-id)。

### 长：

两个表，CartItems，ItemValues（以及它们各自的 Carts，Items，这里不相关）。
每个购物车可以有多个项目，而每个项目都有一个在 ItemValues 中定义的值。
每件商品都属于一个购物车。
购物车的价值是其购物车中具有最大值的商品的价值。
如何选择购物车 id、max(item-value) 及其对应的 item-id？

例如，购物车 ID A 包含值为 10 的项目 ID X 和值为 90 的项目 ID Y。
使用上面的 sql 选择我得到，

```
一个，90
```

我需要的是

```
一个，是的，90

```

平台：MS SQL

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T15:20:21.943

在`MS SQL`和`Oracle`：

```
SELECT *
FROM
  (
  SELECT ci.*, iv.*, 
        ROW_NUMBER() OVER (PARTITION BY CartItems.cart_id ORDER BY ItemValues.value DESC)
  FROM   CartItems ci
  INNER JOIN ItemValues iv
     ON CartItems.item_id=ItemValues.item_id
  ) s
WHERE rn = 1 
```

在`MySQL`：

```
SELECT
FROM
  (
  SELECT ci.*,
         (
         SELECT id
         FROM ItemValues iv
         WHERE iv.item_id = ci.item_id
         ORDER BY
               value DESC
         LIMIT 1
         ) AS maxitem
  FROM   CartItems ci
  ) iv, ItemValues ivo
WHERE ivo.id = iv.maxitem 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T13:28:18.703

此代码是为 Oracle 编写的，但应该与大多数 SQL 版本兼容：

这将获取 max(high_val) 并返回其密钥。

```
select high_val, my_key
from (select high_val, my_key
      from mytable
      where something = 'avalue'
      order by high_val desc)
where rownum <= 1 
```

这就是说：按high_val降序对something ='avalue'的值排序mytable。只抓住第一行，这将为您提供所选范围内的 max(high_val) 和该表的 my_key。

# database - 一次或在每个数据库操作上打开数据库连接？

> ID：611023
> 
> 赞同：3
> 
> 时间：2009-03-04T15:19:02.307
> 
> 标签：database, ado.net, web, sqlconnection

我目前使用 ASP.NET 创建一个 webportal，它严重依赖于数据库的使用。基本上，来自任何用户的每个（以及几乎每个 :P ）GET 查询都会导致来自网络服务器的对数据库的查询。

现在，我在这方面真的很陌生，而且我非常关心性能。由于我缺乏这方面的经验，我真的不知道会发生什么。

我的问题是，使用 ADO.NET，只保留一个从 Web 服务器到数据库的静态连接，然后在每次查询数据库之前检查此连接服务器端的完整性是否是一个更明智的选择？- 或者，在每次查询之前打开连接然后关闭它会更好吗？

在我看来，第一个选项会更好，因为您可以在每次查询之前节省时间握手等，并且您可以节省数据库和服务器端的内存，因为您只有一个连接，但是这种方法有什么缺点吗？2 个查询是否可能同时发送可能会破坏彼此的完整性或混合返回的数据集？

我已经尝试在这里和网络上到处搜索以找到一些关于此的最佳实践，但没有运气。我得到的最接近的是：[长时间保持数据库连接打开是否安全](https://stackoverflow.com/questions/312702/is-it-safe-to-keep-database-connections-open-for-long-time)，但这似乎更适合您拥有多个数据库用户的分布式系统，而我只有我的网络服务器..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-04T15:23:19.143

您担心性能还为时过早。

无论如何，连接由框架汇集。你应该打开它们，使用它们，并尽快处理它们。

就像是...

```
public object Load()
{
  using (SqlConnection cn = new SqlConnection(connectionString))
  using (SqlCommand cm = new SqlCommand(commandString, cn))
  {
    cn.Open();
    return cm.ExecuteScalar();
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T15:23:05.963

最好让 ADO.NET 处理连接池。如果它认为需要，它将保持连接，但不要使用静态连接对象。那只是闻起来。最好将连接对象传递给需要它的方法，并在`using`块中创建连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T15:23:52.047

完成数据库交互后，您应该始终关闭连接。ADO.NET 具有连接池，它将负责有效的连接重用。每当您打开第二个、第三个和后续连接时，它们都会从池中取出，几乎没有开销。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T15:27:49.197

我会更多地考虑缓存而不是高级连接池。每次获取都需要数据库命中？

如果它是一个门户，您有公共内容和用户特定内容，则使用缓存您可以存储公共项目以及使用损坏的键（使用用户 ID）您可以存储用户特定项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T15:23:56.677

ADO.NET 执行连接池。当您在连接对象上调用 close 时，它​​会将连接保留在池中，从而使下一个连接更快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T15:24:11.857

您绝对不想为每个数据库调用打开一个连接，这将很快导致性能极差。建立数据库连接非常昂贵。

相反，您应该使用的是连接池。该池将管理您的连接，并在可能的情况下尝试重用现有连接。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T15:24:26.070

你最初的预感是正确的。您需要的是[数据库连接池。](http://www.jcorporate.com/expresso/doc/edg/edg_connectionpool.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-04T15:25:23.773

我不知道您的平台，但请查看连接池 - 必须有一个可用的库或实用程序（在基本系统中或作为附加组件，或与数据库驱动程序一起提供），它将提供汇集多个到数据库的活动连接，当您从池中获得一个时，这些连接已准备好并准备好使用。

老实说，我希望池在任何数据库抽象库中默认发生（有一个可用的选项来禁用它）。ADO.NET 似乎做到了这一点。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-03-04T15:25:58.810

真正要问的第一个问题是**为什么**您非常关心性能？您的预期工作量是多少？你试过了吗？

但总的来说，是的，拥有一个打开的连接并保持一段时间比每次都重新打开一个数据库连接更聪明。根据连接类型、网络问题和月相，初始连接可能需要一秒钟或更长时间；如果您的工作量是这样的，您期望每五秒左右一次 GET 多于一次，那么您会更高兴与常设连接。

# sifr - sifr 问题 - 一切都看不见

> ID：611036
> 
> 赞同：0
> 
> 时间：2009-03-04T15:20:56.840
> 
> 标签：sifr, invisible

就我使用`sifr.setup();`每个 h2、h1 等而言，它变得不可见。但我不想那样。

我只希望“选择器”提供替代品并变得不可见和被替换。

我怎样才能防止这种情况？

我还有另一个问题，每种字体都是蓝色的，而且它永远不会从任何地方获得那种颜色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-05T09:44:55.003

听起来您保留了隐藏这些元素的原始 CSS。查看 CSS 文件并删除原始`.sIFR-hasFlash h1`选择器。

你能发布一个颜色问题的例子吗？

# windows-vista - 安装 .Net Framework 1.1 SP1 导致错误“WindowsUpdate_E0434F4D”

> ID：611037
> 
> 赞同：0
> 
> 时间：2009-03-04T15:21:00.913
> 
> 标签：windows-vista, .net-1.1

安装 .Net Framework 1.1 时，无法在 Vista 下安装 SP1。使用 Windows Update 我得到“WindowsUpdate_E0434F4D”，以管理员身份手动执行将导致“SLC542.tmp 已停止工作”。

这不取决于我是否激活了 UAC。

我无法修复框架1.1，只能卸载并重新安装，但问题仍然存在。（对不起，Razzie，但链接不适合我）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T15:30:34.307

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T14:12:28.840

由于我的惠普笔记本电脑上预装了软件，我个人遇到了这个问题。在没有它的情况下重新安装 Windows，然后自己安装 .net（然后安装所有 HP 提供的软件）解决了这个问题。

不要从 HP Tools DVD for Vista 安装 .Net Framework 1.1 with SP1。

# sql-server - SQL Server Management Studio 中的“无法执行脚本”错误

> ID：611038
> 
> 赞同：2
> 
> 时间：2009-03-04T15:21:32.347
> 
> 标签：sql-server, ssms

尝试对 SQL Server 2005 的远程实例执行简单语句时，我经常收到以下错误。我单击执行，窗口挂起几秒钟，然后我收到错误。我单击“确定”，再次单击“执行”，它运行良好。这种情况经常发生，以至于非常烦人。

上周我专门针对本地实例工作，一次没有遇到过这个问题。我整个星期都不在公司领域（商务旅行）。

我的机器是Vista。

是什么导致了这个问题？我该如何解决？

```
标题：Microsoft SQL Server 管理工作室
------------------------------

无法执行脚本。

------------------------------
附加信息：

拒绝访问路径“C:\Users\[chloraphil]\AppData\Local\Temp\tmp873B.tmp”。(mscorlib)

------------------------------
纽扣：

好的
------------------------------

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T15:14:54.907

当我的硬盘死机时问题就消失了:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-01T04:31:26.787

尝试删除错误消息中临时文件夹中的所有文件。忽略其他进程打开的文件上的错误。我在那里有超过 3 GB 的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-16T16:30:03.500

当 .sql 脚本位于 zip 文件中时，我双击它，它在 SQL Server Management Studio 中打开 - 但是当我尝试执行它时 - 它给了我这个错误。

将 .sql 脚本移动/解压缩到存档之外，它将运行。

# xslt - 从菜单/工具栏按钮启动 OpenOffice 过滤器

> ID：611044
> 
> 赞同：0
> 
> 时间：2009-03-04T15:22:28.477
> 
> 标签：xslt, filter, openoffice.org

我已经按照此页面上的说明为 OpenOffice 打包了一个 XSLT 导出过滤器： [http ://wiki.services.openoffice.org/wiki/Filter_extensions](http://wiki.services.openoffice.org/wiki/Filter_extensions)

它工作正常；但为了使用，用户必须选择命令“文件/另存为”，然后选择触发使用过滤器的正确文件扩展名和目标文件名。

我想让用户通过使用菜单项或工具栏按钮来启动过滤器，而无需向他们询问任何内容（目标文件名在转换中定义）。

做到这一点并将其包装在与过滤器相同的扩展名中的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T16:20:38.883

经过多次无果而终的搜索和询问，事实证明最好的技巧是编写一个启动过滤器的宏，并将该宏与一个按钮相关联；宏和按钮可以打包在与过滤器相同的扩展名中。

# asp.net - 我可以否定使用“Eval”的属性中的值吗？

> ID：611049
> 
> 赞同：13
> 
> 时间：2009-03-04T15:23:54.510
> 
> 标签：asp.net, asp.net-3.5

我想将按钮的启用状态设置为值的否定。

所以给定这段代码：

```
<asp:CheckBox ID="DefaultChecked" 
              Checked='<%# Bind("IsDefaultMessage") %>' 
              Enabled="false" 
              runat="server" />

<asp:LinkButton ID="MakeDefaultButton" 
                runat="server" 
                CommandName="MakeDefault' 
                CommandArgument='<%# Bind("ResidentialInfoID") %>' 
                Text="Make Default" /> 
```

如果是，我如何制作 LinkBut​​ton`Enabled`属性？`false``IsDefaultMessage == true`

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-05T11:30:19.213

使用 Eval 而不是 Bind。Bind 用于双向绑定，即您需要能够将数据保存回数据源的情况。

当你使用 Bind 时，编译后的页面实际上会生成使用 Eval 设置值的代码，以及一些读取值以保存的代码。由于 Bind 已替换为生成的代码，因此您不能对 Bind 使用任何额外的逻辑。

```
<asp:CheckBox ID="DefaultChecked" Checked='<%# !(bool)Eval("IsDefaultMessage") %>' Enabled="false" runat="server" />
<asp:LinkButton ID="MakeDefaultButton" runat="server" CommandName="MakeDefault' CommandArgument='<%#Bind("ResidentialInfoID") %>' Text="Make Default"/> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-04T15:33:50.990

如果你可以使用Eval，它只是`Control`类的一个方法。它的特殊之处在于它需要在数据绑定块的上下文中`<%# ... %>`。除此之外，您基本上可以将块视为正则`<%= %>`表达式块：

```
<%# !(bool)Eval("IsDefaultMessage") %> 
```

如果您仍然想绑定它（Eval 不是往返），那么您需要在数据绑定期间来回否定它。但是，如果您可以重新定义控件，则可能不需要这样做。例如，如果一个复选框，而不是将其标记为“不是默认消息”给用户并来回否定它，而是将其标记为“是默认消息”。人为的例子，但你明白了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-14T08:46:08.870

如果有人正在寻找 VB.Net 的选项

```
<asp:CheckBox ID="DefaultChecked" Checked='<%# NOT (Eval("IsDefaultMessage")) %>' Enabled="false" runat="server" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T15:58:38.623

我从未使用过 Bind，但我的理解是它类似于 Databinder.Eval。无论哪种方式，这两种方法都返回对象，因此您需要在评估它之前将其转换为布尔值。

```
<%# !Convert.ToBoolean(Bind("IsDefaultMessage") %> 
```

编辑：看起来这无法完成，在页面上使用 SqlDataSource 可以解决问题。[http://forums.asp.net/t/1009497.aspx](http://forums.asp.net/t/1009497.aspx)。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-04T15:28:46.760

我记得（已经有一段时间了），在`<%#Bind(`. 它就`#Bind(` 在 <%....%> 里面。这意味着你想要：

```
 <%  ! #Bind("IsDefaultMessage") %>' 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-03-28T15:09:47.663

编码

```
Checked='<%# Eval("IsDefaultMessage").ToString().Length() > 4 %>' 
```

如果 IsDefaultMessage 为 false，将返回 true 因为 "False".Length = 5 和 "True".Length = 4

# pki - 国防部通用访问卡 (CAC) 身份验证

> ID：611057
> 
> 赞同：11
> 
> 时间：2009-03-04T15:24:43.650
> 
> 标签：pki, x509certificate2, mod-ssl, cac

我已经弄清楚了在 Apache 中获得基于 DOD CAC 卡的客户端证书身份验证的所有必要步骤，但现在我正在努力从我收到的证书中为用户提取一个好的 GUID。证书上是否有可用的 GUID 在 CAC 卡更新时不会更改？我正在考虑使用看起来像这样的 SSL_CLIENT_S_DN：

/C=US/O=美国政府/OU=DoD/OU=PKI/OU=CONTRACTOR/CN=LAST_NAME.FIRST_NAME.MIDDLE_NAME.0123456789

但是我听说更新CAC卡时末尾的数字会改变。这是真的？是否有更好的信息可用于 GUID？我还想获取用户的电子邮件地址，但在我从证书收到的信息中看不到它。电子邮件地址是否在我没有看到的某些自定义扩展中可用？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-24T22:49:19.347

我们遇到了很多情况，最终这个数字发生了变化。最终，我们被迫使用这样一种流程，即如果用户获得新的 CAC，我们要求用户将该新卡与他们的用户帐户重新关联。这就是现在大多数 DoD 系统的流程，例如 DKO（Defense Knowledge Online）和其他系统。如果我们的数据库中没有提供的 CAC 证书数据，用户必须使用用户名和密码登录系统。如果凭证正确，则该 CAC 的识别信息与系统中的用户帐户相关联。

至少我们是这样做的。

而且，就访问电子邮件地址而言，@harningt 是正确的。这取决于提供给您的证书。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-02-13T13:30:16.867

相信大家到现在都已经找到答案了。但是对于稍后来这篇文章的其他人来说，只需注意几点：

这是 DISA 参考网站：http: [//iase.disa.mil/pki-pke/](http://iase.disa.mil/pki-pke/)

PKI 是基础设施，PKE 为您的计算机/服务器/应用程序启用 PKI 身份验证

这是 PKE 管理员入门指南：

[http://iase.disa.mil/pki-pke/getting_started/Pages/administrators.aspx](http://iase.disa.mil/pki-pke/getting_started/Pages/administrators.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-11-22T17:31:17.650

DOD EDI PIN 不应更改。

我可以给你很多例子，你可以去 DOD411 站点（需要 CAC）查找某人，它会显示他们是承包商时的证书，然后再次显示同一个人，现在作为国防部文职人员（我们看到这很多与新员工）。

我刚刚查找了我们的一位新员工，他们曾在空军中任职，然后是海军的承包商，然后是陆军的承包商，现在以 DA 文职人员的身份为我们工作。

相同的 DOD EDI PIN。

CN（通用名称）可以更改（例如，由婚姻产生），但十位 DOD EDI 不应更改。

至于要根据什么证书进行身份验证，大多数网站都根据电子邮件证书进行身份验证，但有些网站确实使用身份证书。

麦克风

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-17T17:58:39.677

首先，许多启用 PKI 的 DOD 站点应支持通过参与 DOD 的 ECA 计划（Verisign、IdenTrust、ORC）的商业 CA 发行的硬件令牌。这些 ECA 颁发的证书甚至不包括这个“数字”，即 DOD EDI PN。

据我了解，应该做出一些努力来保持特定人的数字稳定。例如，即使我辞掉了在国防部的文职工作并为承包商工作，结婚并改名，辞掉工作并加入海岸警卫队，我的国防部 EDI PN 也应该是相同的。但是，在实践中，我怀疑它是否会这样工作。

即便如此，我可能也不应该拥有对应用程序的相同访问权限。每次我的工作发生变化时，我的 CAC 证书都应该被吊销。如果应用程序只查看证书的通用名称或主题替代名称，它将错过组织中可能影响该主题授权的更改。

基于特定证书（颁发者和序列号）的身份验证对用户来说是一件痛苦的事情，但从安全性和稳健性的角度来看，它确实是有意义的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T19:28:28.203

我听说过使用末尾的数字作为个人的唯一标识符的论点，因为其他信息（姓名、组织等）是与数字相反会随着时间实际发生变化的信息位。但是，我还没有看到官方文件或任何其他权威信息实际上表明这是事实。

只是好奇，是否有文档说明启用 Apache 和 DOD CAC 的分步过程？这就是首先让我想到这个问题的原因:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-23T21:30:53.043

电子邮件地址在主题备用名称字段集中可用。这取决于 CAC 证书，但用于 SSL 登录的证书应该包含它（它也是电子邮件签名证书）。

对于给定的人，主题不太可能经常改变。该数字确实是识别一个人的唯一数字。此编号也将出现在 Windows 登录的主题备用名称中的 UPN 字段中（以 NUMBER@MIL 等形式）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-28T14:16:09.177

您可以从 PIV 中检索所有者 SSN。那不会改变

# c# - 存储用户设置

> ID：611058
> 
> 赞同：2
> 
> 时间：2009-03-04T15:25:13.837
> 
> 标签：c#, .net, windows-vista, windows-xp

Environment.SpecialFolder.CommonApplicationData

*返回XP下所有用户都可写的“C:\Documents and Settings\All Users\Application Data”

*在 Vista 下返回“C:\ProgramData[MyApp]\”，这对于普通用户是不可写的

现在为什么我想要 CommonFolder ？因为，管理员将在管理员帐户下将我的软件数据库安装在 XP（或 vista）上，但是当用户重新登录并运行我的软件时，当前帐户将告诉我的软件查看安装数据库的不同位置：用户目录在文档和设置中......

所以 AllUsers （公共文件夹）对于管理员和普通非管理员用户来说是通用的..

这让我发疯：将我的数据库放在哪里，以便它在 Vista 和 XP 下工作？？？？？？谢谢乔纳森

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T15:33:19.543

特定于用户的设置应存储在用户的应用程序数据文件夹 ( `Environment.SpecialFolder.ApplicationData`) 中，这样如果多个用户登录到机器，他们每个人都会获得自己的设置。在安装时在程序的主文件夹中为程序创建一个默认的用户设置数据库，并在用户第一次运行程序时将其复制到用户的文件夹中（你会知道这是第一次，因为 db 文件不存在然而）。

如果您的设置应该应用到机器上的所有用户，您希望这些设置由管理员设置，并且您希望保护它们不被随意更改。将这些存储在普通用户没有写入权限的地方是一件好事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T15:31:00.607

> Vista 设置为不能从另一个用户的帐户修改从一个用户帐户保存的文件。这会强制隔离一个用户帐户和另一个用户帐户，并保护影响整个系统状态的设置/文件。
> 
> 您的程序确实应该在安装时在 ProgramData 中安装它需要的任何机器范围的状态 - 此文件夹在所有用户帐户之间共享；但是，它是只读类型的 shared 。如果当前用户没有创建这些文件，则需要管理员权限才能修改这些文件，因为它们会影响整个计算机，而不仅仅是当前用户帐户。
> 
> 根据此策略，ProgramData 文件夹的安全性如下：
> 
> 系统：完全控制文件和文件夹管理员：完全控制文件和文件夹创建者/所有者：完全控制文件和文件夹用户：只读文件，但可以创建新文件夹和文件
> 
> 这样做的目的是允许任何用户在 ProgramData 文件夹内的任何位置读取和创建文件夹/文件，但用户只能修改从其用户帐户创建的文件；他们不能修改从另一个用户帐户创建的文件。
> 
> 我知道此策略的唯一例外是 c:\users\public 文件夹，该文件夹旨在允许用户存储文档，并且他们希望成为世界可读/可写的。

从[这里开始。](http://www.vistax64.com/vista-file-management/33105-file-locations-avoid-virtualization.html)看起来其他人也有同样的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T15:35:59.160

你可以使用[IsolatedStorageFile.GetMachineStoreForApplication](http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragefile.getmachinestoreforapplication.aspx)和[IsolatedStorageFile.GetUserStoreForApplication](http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragefile.getuserstoreforapplication.aspx)方法吗？

如果我误解了你的问题，我深表歉意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T15:50:27.050

您是否使用安装程序来运行管理员？如果是这样，您应该能够使用安装程序设置以及适当的程序集/可执行清单，以允许应用程序（无论谁在运行它）具有更新/修改特定于其应用程序的 ProgramData 中的文件的适当权限。

我运行了一个类似的场景（应用程序安装到 Program Files，公共数据存储库安装到 ProgramData，用户配置，将文件存储到 C:\Users）并且清单和[WiX 安装程序](http://wix.sourceforge.net/)中的设置允许它工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T15:57:29.670

> 在哪里放置我的数据库以便它在 Vista 和 XP 下工作

如果此数据库是 SQL Express 数据文件或其他共享资源，则它需要位于服务器进程的帐户可以读取/写入的位置。

> 在 Vista 下返回 "C:\ProgramData[MyApp]\" [*更正错字*]，这对于普通用户是不可写的

不是根据此处 ACL 的快速检查（实际上是 Win2k8）：

```
PS C:\ProgramData> get-acl 。| 选择 - 扩大访问

[...]

文件系统权限：读取并执行、同步
访问控制类型：允许
身份参考：BUILTIN\Users
是否继承：错误
InheritanceFlags : ContainerInherit, ObjectInherit
传播标志：无

文件系统权限：写
访问控制类型：允许
身份参考：BUILTIN\Users
是否继承：错误
InheritanceFlags : 容器继承
传播标志：无

```

请注意 ACE 的最后一点，普通用户确实具有写访问权限，但只能访问文件夹及其包含的文件，*而不是*直接位于 C:\ProgramData 中的文件。

但是，如果用户在 C:\ProgramData 中创建文件夹，则其他用户将没有写入权限。

答：在 ProgramData 下为您的数据库创建文件夹，并在该文件夹上设置 ACL 以授予所有用户对该文件夹中文件的读写访问权限。

# sql-server-2005 - SSRS：找不到执行

> ID：611061
> 
> 赞同：0
> 
> 时间：2009-03-04T15:25:25.100
> 
> 标签：sql-server-2005, reporting-services, windows-sbs

我有一个 Windows SBS 2008 64 位框，上面有 SQL 2005 64 位。SQL 本身运行得非常好——又好又快。

SSRS虽然让我头疼。我正常运行安装，将 Windows 服务配置为在其自己的帐户下运行，并将 Web 服务配置为作为 NT Authority\Network Service 运行。

当我尝试运行报告时（通过 Internet Explorer），我收到以下错误：

> 找不到执行“<guid >”。

查看日志它告诉我在数据库中找不到 NT Authority\Network Service。

我已将用户添加到数据库权限，但我现在想不出还有什么可以尝试的。

我已经在谷歌上搜索了两天，但没有任何具体的结果。我知道它与编程无关，请不要为此投票！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T08:08:49.913

您可能需要向数据库授予 NT Authority\Network Service 权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T12:53:09.237

您正在运行非英语操作系统吗？

由于某些原因，“NT Authority\Network Service”的帐户名称已本地化为其他语言。
可悲的是，许多程序将帐户名硬编码为英文名称，并且在外国版本的 Windows 上运行时找不到网络服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-14T15:10:38.427

不幸的是，这些都不是正确的答案。我必须为机器创建一个 SPN 才能正常工作。

SetSPN –A MSSQLSvc/.:1433

如[本知识库文章 (909801)中所述](http://support.microsoft.com/kb/909801)

# c# - 性能更好 - clone() 还是使用 new 关键字实例化？

> ID：611064
> 
> 赞同：2
> 
> 时间：2009-03-04T15:26:03.427
> 
> 标签：c#, .net

当我们想为某个类创建新对象时，如果我们已经有一个，我们应该使用 clone() 还是使用 new 关键字实例化？

是的，clone() 也会复制所有成员，但我很好奇这无关紧要的情况。

```
ClassType foo = new ClassType();
ClassType bar = new ClassType();  // here, will foo.clone() be better choice? 
```

我在当前的一项任务中需要这个，因为我正在使用通用列表（List `<`T `>`），它有时会变得很大，并且在实际用于 UI 之前会通过“n”层。（它们之间会转换为 Array并返回列表以用于序列化目的）。所以，我只是想提高性能。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T15:29:06.183

`Clone()`无论如何都会做`new`，那何必呢？

无论如何，调用`Clone()`都会产生一个新的引用，并且所有成员都会被复制，所以它肯定会更慢。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-04T15:33:43.473

听起来您正在做过早的优化。配置文件，您通常会惊讶于时间的去向。我怀疑它会在这里，除非您的“克隆”正在使用序列化。

那就是说；`ICloneable.Clone()`值得避免只是因为它定义不明确（深与浅）并且很少支持。在幕后，大多数`Clone()`实现要么只做 a `new(); // now copy properties`，要么使用序列化。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-04T15:35:53.233

克隆的目的是产生一个与原始对象相同的对象（或多或少 - 即深与浅 - 即雷区），与 new 不同的目的只是实例化一个不相关的类实例。

摘要：它们有不同的用途，不可互换。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-04T15:30:22.920

`clone`必须分配一个新对象（即，它在`new`某处调用），所以它不可能表现得更好。换句话说，`new`性能是性能的下限`clone`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-04T15:28:28.167

.clone 肯定更慢。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T15:29:29.053

我想是新的，因为克隆仍然必须在后台新建对象，再加上常规的克隆职责。

和往常一样，如果有疑问，请提供个人资料！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-04T15:30:22.980

这将取决于构造函数中完成了多少工作。Clone() 会将每个成员值从第一个类复制到第二个。您的构造函数做的工作比这多还是少？答案应该告诉你。

# c# - string.Format 和单词“Password”

> ID：611068
> 
> 赞同：1
> 
> 时间：2009-03-04T15:28:12.907
> 
> 标签：c#, string

使用 C#，我需要从几个 AppSettings 构建连接字符串。如果我这样做：

```
Connection = string.Format("Data Source={0};Initial Catalog={1);User Id={2};Password={3};",
  ConfigurationManager.AppSettings.Get("CartServer"),
  ConfigurationManager.AppSettings.Get("CartDatabase"),
  ConfigurationManager.AppSettings.Get("CartUserName"),
  ConfigurationManager.AppSettings.Get("CartPassword")); 
```

我得到一个无效的格式字符串异常。我将其缩小到格式字符串的“Password=”部分（即“Passwork=”有效）。有一个足够简单的解决方法：

```
Connection = string.Format("Data Source={0};Initial Catalog={1);User Id={2};{3}={4};",
  ConfigurationManager.AppSettings.Get("CartServer"),
  ConfigurationManager.AppSettings.Get("CartDatabase"),
  ConfigurationManager.AppSettings.Get("CartUserName"),
  "Password",ConfigurationManager.AppSettings.Get("CartPassword")); // Lame!!! 
```

但是“密码”的真实故事是什么？我检查了 MSDN 和其他一些网站，但都没有找到。哦，如果重要的话，这是一个 WCF 服务。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-04T15:32:14.677

您的问题是格式字符串中的 {1) ；它应该是 {1} （你已经用括号关闭了大括号）

这会导致您的 FormatException，因为您的格式字符串现在无效。为什么你的第二个条目有效但我无法理解。

**编辑：**我同意其他理查德的观点，即您应该考虑使用连接字符串构建器对象。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-04T15:33:18.763

您是否考虑过`DbConnectionStringBuilder`该类（或其子类型之一）？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-04T15:35:10.177

很明显......你的问题是因为：“（”。

你为什么不使用 StringBuider 类，更容易:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T15:57:13.400

我只是用谷歌搜索，我什至不知道“DbConnectionStringBuilder”的存在。哇，你每天都能学到新东西。

此外，对于其他连接字符串，请查看此站点： http: [//www.connectionstrings.com/](http://www.connectionstrings.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T09:35:42.560

为什么 StringBuilder 比 string.Format 更好？

请检查这个[Is String.Format 和 StringBuilder 一样高效](https://stackoverflow.com/questions/6785/is-string-format-as-efficient-as-stringbuilder)，看看为什么......

# c# - LINQ 连接两个表

> ID：611074
> 
> 赞同：9
> 
> 时间：2009-03-04T15:29:32.717
> 
> 标签：c#, linq, linq-to-sql, join

我有两个表 A 和 B。A cols 是 GUID，someintVar，someMoreIntvar B col 是 GUID，someItemNO，SomeItemDesc

现在对于一个 GUID，我在表 A 中只有一行。但是对于同一个 GUID，我可以有多行。现在我想根据 GUID 查询数据库并选择一个类中的值。此类将有一个列表，该列表将包含来自第二个表的不同行。我该怎么做？

现在，根据该 GUID 的第二个表中有多少行，我在结果中得到了许多项目。

```
var itemColl = from p in db.A
               join item in db.B on p.CardID equals item.CardID
               where p.CardID == "some GUID"
               select new 
               {
                   p.CardID,
                   p.secondCol,
                   p.ThirdCol,
                   item.ItemNo // How to add them in a collection or list.
               }; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T15:37:48.300

未嵌套，但是如何重新编写它：

```
var itemColl = from p in db.A
               where p.CardID == "some GUID"
               select new {
                   p.CardID,
                   p.secondCol,
                   p.ThirdCol,
                   Items = db.B.Where(b=>b.CardID==p.CardID)
                      //.Select(b=>b.ItemNo) [see comments]
               } 
```

或者，您也许可以分组...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T15:44:22.510

假设您在 GUID 上的 A 和 B 之间建立了外键关系。（如果您不这样做，您的数据库架构已损坏，需要修复）

```
var itemColl = from p in db.A
               where p.CardID == "some GUID"
               select new 
               {
                   p.CardID,
                   p.secondCol,
                   p.ThirdCol,
                   Items = p.Bs
               } 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-03-04T15:38:34.897

假设这发生在你班级的 NEW 或 LOAD 方法中......这就是我要做的......

```
dim myAItem AS A = (from x in db.As WHERE x.CardID == MyGUIDValue).SelectSingleOrDefault

' Assign Variables Here
Me.AValue1 = myAItem.FromDbValue1

dim itemColl = (from b in db.Bs on b == MyGUIDValue).ToList 

me.ItemList = New List(of MySubClass)
For each bItem as B in itemColl
   dim item as New MySubClass
   'Assign Variables Here, ex: item.Value1 = bItem.MyDbValue1
   me.ItemList.Add(item)
Next 
```

# powershell - Powershell 和自动化

> ID：611075
> 
> 赞同：1
> 
> 时间：2009-03-04T15:29:38.397
> 
> 标签：powershell, automation

我只是想看看使用 Powershell 和 VI-Toolkit 来生成显示 VMware ESX 性能和资源使用情况的报告和图表。到现在为止还挺好。但是我在做图表对象的自动化时遇到了麻烦（使用 OWC11.ChartSpace）。例如，我希望能够根据最大值控制 x 轴和 y 轴。

任何人都有这方面的经验，或者可以向我推荐一些体面的文档？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T15:13:22.410

好的，也许我没有很好地表达这个问题，或者也许没有那么多开发人员在 SO 上使用 PowerShell 和 OWC。无论哪种方式，我都完成了通常的阅读和实验工作，并找到了自己的答案。这里是：

OWC 中的 Chart 对象有一个 Axes 属性 - 并且 Axes 有两个元素 - 1 个用于 Y 轴，1 个用于 X 轴。我的问题是如何访问这些并设置它们。

```
$chartSpace  = New-Object -Com OWC11.ChartSpace.11
$c = $chartSpace.Charts.Add()

([array] $c.Axes[0].HasTitle = "True"
([array] $c.Axes[0].Title.Caption = "My Y-Axis Caption"

([array] $c.Axes[1].HasTitle = "True"
([array] $c.Axes[1].Title.Caption = "Percentage"
([array] $c.Axes[1].Scaling.Maximum = 100 
```

这里的关键是将对象转换为一个数组，这样我就可以访问 X 和 Y 元素。在那之后，这很容易。

它帮助了我，并且可能会帮助其他人。

# .net - 当服务不暴露元数据时如何添加服务引用？

> ID：611083
> 
> 赞同：0
> 
> 时间：2009-03-04T15:31:13.230
> 
> 标签：.net, wcf

[这是这篇关于在同一台机器上运行的两个程序之间传递消息](https://stackoverflow.com/questions/607530/how-do-you-pass-a-message-from-one-program-to-another)的帖子的后续内容。

我正在尝试使用命名管道，但是当我尝试公开元数据时，我收到一个权限问题错误，说 HTTP 无法注册 URL [http://+:/8011/Local/Mex](http://+:/8011/Local/Mex)。我不需要公开 MetaData，因为这是一个非常简单的服务，它只传递一个整数并且只会被另一个程序使用。如果我不公开元数据，如何向消费程序添加服务引用？这是我的配对服务....这是否可行，或者我是否必须通过尝试向机器和 NETSH 注册 HTTP 地址来进行斗争，这可以通过以最小权限运行的用户来完成吗？

```
<service name="WCFNamedPipeTestSever.Service1" >
      <endpoint name="WCFNamedPipeTestSever.Service1"
              address="net.pipe://localhost/service1"
              binding="netNamedPipeBinding"
              contract="WCFNamedPipeTestSever.IService1"            >
      </endpoint>
    </service> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T15:44:49.937

您使用的是 mexHttpBinding 而不是 mexNamedPipeBinding？

# c# - 如何在 C# 中登录网页并检索其内容？

> ID：611092
> 
> 赞同：3
> 
> 时间：2009-03-04T15:34:38.773
> 
> 标签：c#, http, authentication, screen-scraping

如何在 C# 中登录网页并检索其内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T15:37:15.850

这取决于登录所需的内容。您可以使用网络客户端将登录凭据发送到服务器的登录页面（通过所需的任何方法，GET 或 POST），但这不会保留 cookie。有一种[方法](http://couldbedone.blogspot.com/2007/08/webclient-handling-cookies.html)可以让 web 客户端处理 cookie，因此您可以将登录信息发布到服务器，然后使用相同的 web 客户端请求您想要的页面，然后对页面执行任何您想要的操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T15:36:11.640

看看`System.Net.WebClient`，还是为了更高级的要求`System.Net.HttpWebRequest/System.Net.HttpWebResponse`。

至于实际应用这些：您必须研究要抓取的每个页面的 html 源代码，以便准确了解它所期望的 Http 请求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T15:39:27.967

你是什​​么意思“登录”？

如果子文件夹在操作系统级别受到保护，并且当您访问该子文件夹时浏览器弹出登录对话框，您将需要在 HttpWebRequest 上设置 Credentials 属性。

如果网站有自己的基于 cookie 的会员/登录系统，您必须使用 HttpWebRequest 来首先响应登录表单。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-06T19:30:01.720

```
string postData = "userid=ducon";
            postData += "&username=camarche" ;
            byte[] data = Encoding.ASCII.GetBytes(postData);
            WebRequest req = WebRequest.Create(
                URL);
            req.Method = "POST";
            req.ContentType = "application/x-www-form-urlencoded";
            req.ContentLength = data.Length;
            Stream newStream = req.GetRequestStream();
            newStream.Write(data, 0, data.Length);
            newStream.Close();
            StreamReader reader = new StreamReader(req.GetResponse().GetResponseStream(), System.Text.Encoding.GetEncoding("iso-8859-1"));
            string coco = reader.ReadToEnd(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T15:38:03.757

使用[WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient(VS.80).aspx)类。

```
Dim Html As String

Using Client As New System.Net.WebClient()
    Html = Client.DownloadString("http://www.google.com")
End Using 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T23:58:41.287

您可以使用 WebClient 对象中的构建，而不是自己创建请求。

```
WebClient wc = new WebClient();
wc.Credentials = new NetworkCredential("username", "password");
string url = "http://foo.com";          
try
{
    using (Stream stream = wc.OpenRead(new Uri(url)))
    {
        using (StreamReader reader = new StreamReader(stream))
        {
            return reader.ReadToEnd();
             }
    }
}
catch (WebException e)
{
    //Error handeling
} 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-03-04T15:46:00.650

试试这个：

```
public string GetContent(string url)  
{ 
  using (System.Net.WebClient client =new System.Net.WebClient()) 
  { 
  return client.DownloadString(url); 
  } 
} 
```

# c# - 异步进程启动并等待它完成

> ID：611094
> 
> 赞同：36
> 
> 时间：2009-03-04T15:35:17.867
> 
> 标签：c#, .net, multithreading, process

我是.net 中线程模型的新手。你会用什么来：

1.  启动处理文件的进程 (process.StartInfo.FileName = fileName;)
2.  等待用户关闭进程或一段时间后放弃线程
3.  如果用户关闭进程，删除文件

启动进程和等待应该在与主线程不同的线程上完成，因为这个操作不应该影响应用程序。

例子：

我的应用程序生成一个 html 报告。用户可以右键单击某处并说“查看报告”——现在我在一个临时文件中检索报告内容并启动处理 html 文件的进程，即默认浏览器。问题是我无法清理，即删除临时文件。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-03-04T15:43:05.617

“等待必须是异步的” - 我不是想搞笑，但这不是矛盾吗？但是，由于您正在启动`Process`，该`Exited`事件可能会有所帮助：

```
ProcessStartInfo startInfo = null;
Process process = Process.Start(startInfo);
process.EnableRaisingEvents = true;
process.Exited += delegate {/* clean up*/}; 
```

如果你想真正等待（超时等），那么：

```
if(process.WaitForExit(timeout)) {
    // user exited
} else {
    // timeout (perhaps process.Kill();)
} 
```

对于等待异步，也许只是使用不同的线程？

```
ThreadPool.QueueUserWorkItem(delegate {
    Process process = Process.Start(startInfo);
    if(process.WaitForExit(timeout)) {
        // user exited
    } else {
        // timeout
    }
}); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-07-30T00:39:50.850

为这个老问题添加一个高级替代方案。如果您想等待进程退出而不阻塞任何线程并且仍然支持超时，请尝试以下操作：

```
 public static Task<bool> WaitForExitAsync(this Process process, TimeSpan timeout)
    {
        ManualResetEvent processWaitObject = new ManualResetEvent(false);
        processWaitObject.SafeWaitHandle = new SafeWaitHandle(process.Handle, false);

        TaskCompletionSource<bool> tcs = new TaskCompletionSource<bool>();

        RegisteredWaitHandle registeredProcessWaitHandle = null;
        registeredProcessWaitHandle = ThreadPool.RegisterWaitForSingleObject(
            processWaitObject,
            delegate(object state, bool timedOut)
            {
                if (!timedOut)
                {
                    registeredProcessWaitHandle.Unregister(null);
                }

                processWaitObject.Dispose();
                tcs.SetResult(!timedOut);
            },
            null /* state */,
            timeout,
            true /* executeOnlyOnce */);

        return tcs.Task;
    } 
```

同样，与公认的答案相比，这种方法的优势在于您不会阻塞任何线程，从而减少了应用程序的开销。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-04T15:45:30.230

试试下面的代码。

```
public void KickOffProcess(string filePath) {
  var proc = Process.Start(filePath);
  ThreadPool.QueueUserWorkItem(new WaitCallBack(WaitForProc), proc);
}

private void WaitForProc(object obj) {
  var proc = (Process)obj;
  proc.WaitForExit();
  // Do the file deletion here
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T15:46:27.467

我可能不会使用单独的进程来打开文件。相反，我可能会使用后台线程（如果我认为该操作需要很长时间并且可能会阻塞 UI 线程）。

```
private delegate void FileOpenDelegate(string filename);

public void OpenFile(string filename)
{
   FileOpenDelegate fileOpenDelegate = OpenFileAsync;
   AsyncCallback callback = AsyncCompleteMethod;
   fileOpenDelegate.BeginInvoke(filename, callback, state);
}

private void OpenFileAsync(string filename)
{
   // file opening code here, and then do whatever with the file
} 
```

当然，这不是一个好的工作示例（它不返回任何内容），并且我没有展示 UI 是如何更新的（您必须在 UI 级别使用 BeginInvoke，因为后台线程无法更新 UI 线程）。但这种方法通常是我在 .Net 中处理异步操作的方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T15:50:36.020

您可以`Exited`在 Process 类中使用该事件

```
ProcessStartInfo info = new ProcessStartInfo();

info.FileName = "notepad.exe";
Process process = Process.Start(info);

process.Exited += new EventHandler(process_Exited);
Console.Read(); 
```

在那种情况下，您可以处理您提到的操作

# c++ - 写BMP数据得到垃圾

> ID：611095
> 
> 赞同：4
> 
> 时间：2009-03-04T15:35:50.207
> 
> 标签：c++, graphics, bmp, fwrite

我正在努力理解和绘制我自己的 PDF417（二维条码）DLL。无论如何，文件的实际绘图是完美的，并且在 32 位的正确边界内（作为单色结果）。在写入数据时，以下是从指向 bmp 缓冲区的指针的 C++ Visual Studio 内存转储复制的内存转储。在下一行之前，每一行都正确分配为 36 宽。

对帖子中的自动换行感到抱歉，但我的输出旨在与内存转储具有相同的 36 字节宽，以便您可以更好地看到失真。

当前绘图为 273 像素宽 x 12 像素高，单色...

```
00 ab a8 61 d7 18 ed 18 f7 a3 89 1c dd 70 86 f5 f7 1a 20 91 3b c9 27 e7 67 12 1c 68 ae 3c b7 3e 02 eb 00 00
00 ab a8 61 d7 18 ed 18 f7 a3 89 1c dd 70 86 f5 f7 1a 20 91 3b c9 27 e7 67 12 1c 68 ae 3c b7 3e 02 eb 00 00
00 ab a8 61 d7 18 ed 18 f7 a3 89 1c dd 70 86 f5 f7 1a 20 91 3b c9 27 e7 67 12 1c 68 ae 3c b7 3e 02 eb 00 00
00 ab 81 4b ca 07 6b 9c 11 40 9a e6 0c 76 0a fc a3 33 70 bb 30 55 87 e9 c4 10 58 d9 ea 0d 48 3e 02 eb 00 00
00 ab 81 4b ca 07 6b 9c 11 40 9a e6 0c 76 0a fc a3 33 70 bb 30 55 87 e9 c4 10 58 d9 ea 0d 48 3e 02 eb 00 00
00 ab 81 4b ca 07 6b 9c 11 40 9a e6 0c 76 0a fc a3 33 70 bb 30 55 87 e9 c4 10 58 d9 ea 0d 48 3e 02 eb 00 00
00 ab 85 7e d0 29 e8 14 f4 0a 7a 05 3c 37 ba 86 87 04 db b6 09 dc a0 62 fc d1 31 79 bc 5c 0a 8e 02 eb 00 00
00 ab 85 7e d0 29 e8 14 f4 0a 7a 05 3c 37 ba 86 87 04 db b6 09 dc a0 62 fc d1 31 79 bc 5c 0a 8e 02 eb 00 00
00 ab 85 7e d0 29 e8 14 f4 0a 7a 05 3c 37 ba 86 87 04 db b6 09 dc a0 62 fc d1 31 79 bc 5c 0a 8e 02 eb 00 00
00 ab 85 43 c5 30 e2 26 70 4a 1a f3 e4 4d ce 2a 3f 79 cd bc e6 de 73 6f 39 b7 9c db ce 6d 5f be 02 eb 00 00
00 ab 85 43 c5 30 e2 26 70 4a 1a f3 e4 4d ce 2a 3f 79 cd bc e6 de 73 6f 39 b7 9c db ce 6d 5f be 02 eb 00 00
00 ab 85 43 c5 30 e2 26 70 4a 1a f3 e4 4d ce 2a 3f 79 cd bc e6 de 73 6f 39 b7 9c db ce 6d 5f be 02 eb 00 00 
```

这是写入文件的代码——从上面的内存转储时立即逐字逐句

```
FILE *stream; 
if( fopen_s( &stream, cSaveToFile, "w+" ) == 0 ) 
{ 
   fwrite( &bmfh, 1, (UINT)sizeof(BITMAPFILEHEADER), stream ); 
   fwrite( &bmi, 1, (UINT)sizeof(BITMAPINFO), stream ); 
   fwrite( &RGBWhite, 1, (UINT)sizeof(RGBQUAD), stream );
   fwrite( ppvBits, 1, (UINT)bmi.bmiHeader.biSizeImage, stream ); 
   fclose( stream ); 
} 
```

这是实际写入文件的内容。

```
00 ab a8 61 d7 18 ed 18 f7 a3 89 1c dd 70 86 f5 f7 1a 20 91 3b c9 27 e7 67 12 1c 68 ae 3c b7 3e 02 eb 00 00
00 ab a8 61 d7 18 ed 18 f7 a3 89 1c dd 70 86 f5 f7 1a 20 91 3b c9 27 e7 67 12 1c 68 ae 3c b7 3e 02 eb 00 00
00 ab a8 61 d7 18 ed 18 f7 a3 89 1c dd 70 86 f5 f7 1a 20 91 3b c9 27 e7 67 12 1c 68 ae 3c b7 3e 02 eb 00 00
00 ab 81 4b ca 07 6b 9c 11 40 9a e6 0c 76 0d 0a fc a3 33 70 bb 30 55 87 e9 c4 10 58 d9 ea 0d 48 3e 02 eb 00
00 00 ab 81 4b ca 07 6b 9c 11 40 9a e6 0c 76 0d 0a fc a3 33 70 bb 30 55 87 e9 c4 10 58 d9 ea 0d 48 3e 02 eb
00 00 00 ab 81 4b ca 07 6b 9c 11 40 9a e6 0c 76 0d 0a fc a3 33 70 bb 30 55 87 e9 c4 10 58 d9 ea 0d 48 3e 02
eb 00 00 00 ab 85 7e d0 29 e8 14 f4 0d 0a 7a 05 3c 37 ba 86 87 04 db b6 09 dc a0 62 fc d1 31 79 bc 5c 0d 0a
8e 02 eb 00 00 00 ab 85 7e d0 29 e8 14 f4 0d 0a 7a 05 3c 37 ba 86 87 04 db b6 09 dc a0 62 fc d1 31 79 bc 5c
0d 0a 8e 02 eb 00 00 00 ab 85 7e d0 29 e8 14 f4 0d 0a 7a 05 3c 37 ba 86 87 04 db b6 09 dc a0 62 fc d1 31 79
bc 5c 0d 0a 8e 02 eb 00 00 00 ab 85 43 c5 30 e2 26 70 4a 1a f3 e4 4d ce 2a 3f 79 cd bc e6 de 73 6f 39 b7 9c
db ce 6d 5f be 02 eb 00 00 00 ab 85 43 c5 30 e2 26 70 4a 1a f3 e4 4d ce 2a 3f 79 cd bc e6 de 73 6f 39 b7 9c
db ce 6d 5f be 02 eb 00 00 00 ab 85 43 c5 30 e2 26 70 4a 1a f3 e4 4d ce 2a 3f 79 cd bc e6 de 73 6f 39 b7 9c
db ce 6d 5f be 02 eb 00 00 
```

注意从第 4 行读回文件的结果中以“0d”开始的失真，大约第 15 个字节...... 9个字节值...

显然，绘图部分工作正常，因为 12 行的所有内容都在内存中保持正确对齐。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-04T15:39:05.893

您不应该以复合模式（即可写和二进制）打开文件`wb+`吗？

> 请注意以“0d”开始的失真

这是回车 (CR) 的 ASCII 码——在某些操作系统上添加了换行符（其中换行符实际上是 CR/LF 的序列）。一旦您开始以二进制模式写入输出，这应该会消失。

否则，您的代码看起来很整洁。干杯!

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T15:43:42.700

您的`0x0A`( `\n`) 被转换为 DOS 格式`0x0D0A`( `\r\n`)，因为您正在以文本模式写入文件。切换到二进制模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T15:51:00.717

我实际上只是在 java 中做了类似的事情（将 bmp 数据打印到热敏收据打印机）。有几件事想和大家分享：

1.  bmp 图像数据！= 来自 microsoft 的图像格式。MS 位图在任何图像数据之前有大约 54 字节的标头信息。（在我意识到差异之前，我花了一两天的时间来解决这个问题）

2.  bmp 图像数据从左到右、从上到下读取，最高有效位在左侧。

3.  确保条形码图像的位深度为 1。这意味着 1 位 = 1 像素。十六进制的“ab”是二进制的 10101011，这 8 个像素将被相应地填充。

4.  如果您有 36 字节宽的条形码，则条形码分辨率为 288 x 12，而不是 273 x 12。（36 * 8 = 288）。

5.  图像数据的大小应为 432 字节（12 行，每行 36 字节）。

6.  我不知道这意味着什么：

    > 无论如何，文件的实际绘图是完美的，并且在 32 位的正确边界内（作为单色结果）。

单色表示它的一种颜色或另一种颜色。像素（思考位）要么被填充，要么未被填充。

希望这可以帮助

# mysql - 用于存储年份的 MySQL 类型：Smallint 或 Varchar 或 Date？

> ID：611105
> 
> 赞同：22
> 
> 时间：2009-03-04T15:37:58.487
> 
> 标签：mysql, database, database-design, optimization

我将在 MySQL 表中存储一年：将其存储为 smallint 还是 varchar 更好？我认为由于它不是一个完整的日期，日期格式不应该是一个答案，但我也会包括在内。

斯莫林特？变量（4）？日期？别的东西？

例子：

*   2008年

*   1992

*   2053

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-04T15:40:11.193

我会使用[YEAR](http://dev.mysql.com/doc/refman/5.1/en/year.html) (4) 列类型...但前提是预期年份在 1901 和 2155 范围内...否则，请参阅 Gambrinus 的答案。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-04T15:40:38.713

我会选择 small-int - 据我所知 - varchar 会占用更多空间和日期。第二个选项是日期。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-06T02:46:46.530

我自己的经验是使用 Oracle，它没有 YEAR 数据类型，但我一直试图避免仅仅因为元素仅由数字组成而对元素使用数字数据类型。（因此这包括电话号码、社会保险号码、邮政编码，作为其他示例）。

我自己的经验法则是考虑数据的用途。如果您要对其执行数学运算，则将其存储为数字。如果您将执行字符串函数（例如“获取 SSN 的最后四个字符”或“将电话号码显示为 (XXX) XXX-XXXX”），那么它就是一个字符串。

另一个线索是要求将前导零存储为数字的一部分。

此外，尽管通常被称为电话“号码”，但它们经常包含字母以指示分机号码的存在作为后缀。类似地，标准书号可能以“X”结尾作为“校验位”，而国际标准序列号可以以“X”结尾（尽管 ISSN 国际中心反复将其称为 8 位代码[http ://www.issn.org/understanding-the-issn/what-is-an-issn/](http://www.issn.org/understanding-the-issn/what-is-an-issn/)）。

国际环境中的电话号码格式很棘手，当然，符合 E.164 要求国家/地区呼叫代码以“+”为前缀。

# linker - 向量统计库 - 数学内核库

> ID：611109
> 
> 赞同：1
> 
> 时间：2009-03-04T15:39:00.107
> 
> 标签：linker, fortran

谁能解释一下（用简单的英语）如何将向量统计库（包含在数学内核库中）链接到使用适用于 Linux 的英特尔 Fortran 编译器编译的 Fortran 90 源代码？

我的生成文件如下所示：

```
f90comp = ifort
libdir = /home/project/
mklpath = /opt/intel/mkl/10.0.5.025/lib/32/
mklinclude = /opt/intel/mkl/10.0.5.025/include/

exec: AAA.o
  $(f90comp) -o AAA -L$(mklpath) -I$(mklinclude) AAA.o -libmkl_ia32.a -lguide -lpthread

AAA.o: $(libdir)AAA.f90
  $(f90comp) -c -L$(mklpath) -I$(mklinclude) $(libdir)AAA.f90 -libmkl_ia32.a -lguide -lpthread 
```

它产生以下错误：

```
ld: cannot find -libmkl_ia32.a
make: *** Error 1 
```

但是，该文件存在于指定目录 (mklpath) 中。

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T12:19:40.280

该文件是如何真正调用的？链接器的 -l 并不意味着采用真实的文件名。它的意思是取 [x]，而要找到的文件称为 lib[x].{so,a}。

如果你想给出真实的目标文件名，你可以不使用 -l 并使用绝对路径直接附加它，或者使用 -l:[filename]。

但是，我认为为您做这件事的正确方法是`-lmkl_ia32`。原始文件名仅在 lib 不称为 lib[x].{so,a} 时才有用

# perl - 如何在 Perl 5.004 下增强 Perl/TK GUI 的外观？

> ID：611111
> 
> 赞同：8
> 
> 时间：2009-03-04T15:39:11.820
> 
> 标签：perl, user-interface, tk, perltk

我有一个应用程序可以在使用`Perl/TK`GUI 的 Windows、Linux 和 Solaris 上运行。由于限制，我们仅限于 Perl/ *TK*。此外，我们仅限于旧`Perl/Tk`版本，`5.00404`.

我想在这些限制范围内工作，以使 GUI 看起来尽可能漂亮和现代。

是否有任何具有 TK 设计方案（用于按钮、框架、颜色等）的网络资源可以帮助我完成这项工作？

* * *

我也在寻找像我在[这里](http://www.perlmonks.org?node_id=266105)找到的那​​样的现代化建议：

> 如果您发现您的 Tk 应用程序在基于 X 的系统上看起来有点难看，请尝试在脚本顶部添加以下行：
> 
> ```
> $mw->optionAdd("*font", "-*-arial-normal-r-*-*-*-120-*-*-*-*-*-*");
> $mw->optionAdd("*borderWidth", 1); 
> ```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T16:55:51.763

您可以使用[Tk 主题引擎](http://www.tcl.tk/man/tcl8.5/TkCmd/ttk_intro.htm)为您的应用提供更好的外观。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-23T06:43:38.767

尝试使用图像而不是按钮元素，然后您可以拥有任何您喜欢的样式，并且可以烘焙字体。这几乎适用于内容不是动态的任何元素 - 包括窗格上的背景等。授予它更多的工作，但它确实解决了您的问题，特别是如果您的项目组中有一位称职的艺术家。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T19:51:47.023

使用 optionAdd 通过选项数据库调整默认值是一个合理的开始。可以在以下位置找到有关此的线程：

[http://tcl.projectforum.com/tk/221](http://tcl.projectforum.com/tk/221)

从那里下载 griffin.kit，使用 sdx 工具解包并找到 griffin.tcl 以获得一组好的选项设置。

[http://wiki.tcl.tk/3411](http://wiki.tcl.tk/3411)用于 sdx 工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T04:08:12.060

Tk的[Tile](http://tktable.sourceforge.net/tile/index.html)主题引擎使它看起来更漂亮。然而，Perl/Tk 远远落后于 Tk 的发展，无法利用 Tile 和其他进步。

您应该调查[Tkx](http://search.cpan.org/dist/Tkx/Tkx.pm)是否适合您。它与 Perl/Tk 不完全兼容，但 API 非常接近。它是 Perl 和 Tcl/Tk 之间的一座桥梁，因此它可以使用所有现代 Tcl/Tk 功能（如 Tile），同时仍然使用 Perl 编写应用程序逻辑。相当多的 ActiveState 自己的图形实用程序使用 Tkx，结果相当漂亮。[（来源：][[activestate.com](http://docs.activestate.com/activeperl/5.8/images/ppm_gui.png)][）]
[![活动状态 PPM](https://i.stack.imgur.com/PpecO.png)](https://i.stack.imgur.com/PpecO.png)

不过，Perl 5.00404 非常古老。Tkx dist 声称依赖于 Perl≥5.008...我没有足够老的 Perl 来看看它有多准确。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-25T00:13:05.043

由于在 Linux 中 Tk::Entry 和 Tk::Text 的背景是灰色的，我也将使用以下两行。

```
$mw->optionAdd( '*Entry.background',   'snow1' );
$mw->optionAdd( '*Text.background',    'snow1' ); 
```

用您选择的颜色替换“snow1”。您还可以使用颜色的十六进制表示 (RGB)，例如“#ff9696”。

# html - PdfSharp、GDI+ 和 HTML 打印

> ID：611112
> 
> 赞同：2
> 
> 时间：2009-03-04T15:39:14.287
> 
> 标签：html, pdf, gdi+, pdfsharp

我目前有一个“PrintingWebService”，我从 AJAX 页面调用它，其中包含使用 PDF Sharp 和 PDFSharp 的 GDI+ 模式构建高度定制的 PDF 打印输出所需的所有信息，该模式采用 DrawString 和其他基本上像 GDI+ 一样工作的命令他们被 PDF 所吸引。

然后，我将 PDF 文件保存到 Web 服务器上的某个位置，并从 Web 服务返回文件名，然后 AJAX 页面将打开一个包含 pdf 文件的新窗口。

到目前为止，它运行良好，但是，我想要打印出我的 AJAX 页面的一部分，但我还没有提出解决方案。我有一个 TinyMCE 编辑器的 HTML 内容字符串，我想在 PDF 页面的底部显示。

我正在寻找可以用于此目的的某种工具。即使是打印到 GDI+ 的开源代码，我也可以通过获取源代码并将其翻译为使用 PdfSharp 的 GDI+（类名类似于 XGraphics，每个类在 GDI+ 名称前都有 X）来使用。

如果必须，我将限制 TinyMCE 可以生成的 HTML 并编写自己的渲染器，但这将是一个很大的挑战，所以我首先在寻找其他解决方案。

我已经远离了对打印机友好的页面方法，因为我想使用我现有的代码构建一个与现有 WinForms 打印输出几乎相同的页面。使用 PdfSharp，我能够转换除文本区域之外的所有代码（在 WinForms 版本中使用 RichTextBox 和 RTF）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T15:50:38.457

托尼，

我个人使用 WebSupergoo 的 ABCPdf 库取得了很大的成功。您实际上可以将 HTML 直接渲染为 PDF，并且在准确性方面做得相当好。

另一个可以让您灵活地将 HTML 写入 PDF 的免费软件是 iTextSharp。

否则，我认为您将不得不编写一些东西来将 HTML 呈现到 GDI。

无论哪种方式，您都可能需要考虑使用映射到使用 web.config 的 HttpHandler 来生成 PDF 文件。这将允许您将 PDF 呈现为字节流，然后将其直接转储给用户（而不是必须将每个 PDF 收据保存到 Web 服务器）。它还允许您在返回收据的页面中使用 .pdf 扩展名（PurchaseReceipt.pdf 可以映射到 HttpHandler）...使其更加跨浏览器友好。如果您开始从 ASPX 页面抛出 PDF 字节流，旧版本的 Adob​​e / 浏览器将无法正确显示。

希望这可以帮助。

# monitor - 纵向使用宽屏显示器对编码更有效吗？

> ID：611113
> 
> 赞同：33
> 
> 时间：2009-03-04T15:39:20.073
> 
> 标签：monitor, multiple-monitors, widescreen

在不久的将来，我的开发设置将升级，部分交易将是双显示器（耶！）

至少其中一台显示器（可能两者兼有）将是宽屏的。

我听说开发人员在纵向模式下使用第二台显示器，尤其是宽屏显示器。它允许在屏幕上显示更多行（尽管更窄）并且运行起来有点像一页长代码。

有没有人使用它并认为它更有效？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-03-04T15:48:23.843

[![在此处输入图像描述](https://i.stack.imgur.com/xEeHc.jpg)](https://i.stack.imgur.com/xEeHc.jpg)

我实际上有 3 台处于纵向模式的宽屏显示器，是的，这是一种很棒的工作方式。滚动的次数要少得多，您可以一次在屏幕上显示所有调试/输出/参考窗口。

使用两台显示器的问题在于，您通常会在一台主显示器上工作并有输出（或另一台显示器）。如果您确实有两个，请将其设置为使您的主显示器直接在您面前，而另一个（不太常用的）一个在一侧。我发现这是使用双显示器设置的最佳方式，因为它可以减少 RSI 被永久扭曲以查看特定屏幕。

此外，还有[一些程序可用于提供虚拟屏幕分割](http://www.online-tech-tips.com/free-software-downloads/split-or-divide-your-desktop-screen-into-multiple-parts/)，我资助这些程序对于大/宽屏显示器设置非常有用。

**[编辑]** ..是的，您应该编写足够短的函数以适合单个页面，但是根据我的经验，能够随时查看更多函数通常可以使开发更容易:-)

**[edit2]**在宽屏显示器上纵向运行 Visual-Studio 式 IDE 在调试编译错误方面非常棒，因为您有更多可用空间来同时查看代码和错误。我想你可能会争辩说，如果你经常编译，你一次不应该看到那么多错误？...但谁这样编码？;-)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-04T15:48:03.343

既然你不应该编写比屏幕更长的函数，那么让屏幕变得更长有点作弊，不是吗？;)

无论如何，我发现编码时纵向模式并没有更好，只有在纵向模式下我的旧 17 英寸宽屏才能更好地查看/编辑文档。在横向模式下有两个大屏幕，查看文档时可以在一个屏幕上放置两个页面，并且在 IDE 的文本编辑器的两侧打开了许多工具窗口。所以不，纵向模式并不好，除非你有四个来组成一个非常大的屏幕（在 Microsoft 博客上有一张这样设置的照片，但我不记得在哪里）。

但是，有些应用程序的纵向效果更好，例如，如果您必须以大分辨率显示文档，或者如果您有一些监视器（如在网络监视器中）正在运行并希望一次查看更多行。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-04T15:51:12.150

我无法想象这将如何提高生产力。在我看来，向上/向下滚动**总是**比向左/向右滚动更容易。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-04T15:50:13.480

这取决于您使用的 IDE（如果有）。

Microsoft Visual Studio 喜欢通过其“工具箱”和“解决方案资源管理器”占用显示器的大部分宽度，因此我发现它在横向显示器上效果更好。由于它不允许您取消停靠编辑器窗口，因此您甚至无法将代码编辑器拖到处于纵向模式的第二个监视器上。

还要考虑您的客户最有可能如何设置他们的显示器。您可能希望使用相同的设置编写任何 UI 代码，以便您了解应用程序的使用方式。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-04T15:47:39.977

取决于你的显示器有多大。我们有 1 台 28 英寸横向显示器和 2 台 24 英寸纵向显示器，位于大显示器的两侧。

非常适合结对编程！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-04T16:39:05.077

在工作中，我以纵向模式运行我的主显示器（次要是笔记本电脑屏幕）。我很喜欢。我已经厌倦了一次看到更多的代码。我发现它根本不鼓励更长的方法。有时，我遇到的代码有点太宽了，因为 IDE 侧边栏有点拥挤，但我主要使用 Eclipse（Rational Application Developer，但基于 Eclipse），所以快速双击最大化代码窗口，它是很有用。再次双击，我的侧边栏就回来了。

我还发现它对我的电子邮件非常有用。

我强烈推荐它。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-04T16:40:59.020

纵向模式宽屏显示器非常适合编辑代码，谢谢。然而，一些显示器在一维上的视角很差，通常是垂直的，但在纵向模式下会变成水平的。如果一切都没有正确对齐，这可能会使颜色变差或无法使用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-04T15:43:49.627

我从未尝试过，但我想它会很好用。我个人喜欢保持我的行相当短，宽屏幕往往会给我更少的代码行，所以我会尝试一下。

这一切都归结为个人喜好，然而，让你成为最有效率和最适合你的方法就是要走的路。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-04T15:46:07.483

对我来说根本没有效果。我使用 IDE，所以在横向模式下，我有侧边栏来导航代码、导航项目等。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-04T15:50:14.383

这不是愚蠢，而是见仁见智。纵向宽屏非常适合编写代码，代码宽度从来都不是问题，并且能够在屏幕上看到更多代码行总是很好。

将宽屏纵向放置的另一个原因是它与您的其他显示器的高度相匹配，例如，30" 宽屏旁边的 22" 纵向宽屏具有接近相同的高度。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-04T15:51:57.080

这一切都取决于您的喜好。

我的家庭办公室只有一台大显示器。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-04T15:52:40.883

我试过一次。我不喜欢它。我通常有一个 IDE，而 IDE 非常适合宽屏。如果您可以在右侧看到您的功能列表，在左侧看到文件列表等，则可以更快地跳转。

另外，我尽量让我的函数保持小，所以这通常不是问题（我有双 24"）。如果你的函数相当小，并且你有宽屏，你可以并排显示两个文件，这通常更有用. 一些编辑器允许你拆分窗口并滚动到同一个文件的两个不同部分。这也非常有用，比在屏幕上显示 100+ 行要好得多。根据我的设置，我在编辑器上每个屏幕有 60 行. 如果我拆分编辑器，我可以看到 120。如果我在另一台显示器上再做一次，我可以看到 240。这是相当多的代码，通常只对非常不同的部分有用。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-16T06:09:04.133

如果您主要处理文本（就像大多数程序员或其他技术人员所做的那样），甚至是文档，那么纵向模式更有价值。事实上，显示器的总趋势是完全错误的方向：纵横比正在将横向显示器挤压到邮筒，以更好地适应电影的格式。就个人而言，我*从来没有*在我的电脑（笔记本电脑或台式机）上看过电影，而且我现在不打算开始 - 这就是我拥有电视的目的！

实际上，垂直像素是计算中最有价值的资产——尽你所能获得更多——你不会后悔你花了钱！我什至不会购买垂直像素低于 1024-1080 的笔记本电脑，因为这*是以*可读分辨率显示整页 PDF 所需的最低要求，而且（更多）更好。（由于 PDF 占当今在线文档/手册的很大一部分，这是一个非常重要的问题。）您应该只在获得足够的垂直像素*后才考虑宽度。*

我*真正*想要的是一台带有*纵向*屏幕的 15.4 英寸或 16 英寸笔记本电脑——它们应该仍然足够宽，可以将全尺寸键盘装入底座——FlyBook 风格的枢轴臂会很好，但不是必需的。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-16T06:29:58.340

我发现当你首先在纸上打印相关功能的意图时，比直接从屏幕上理解它们更容易理解它们的意图，永远不会失败，为什么？因为您可以一目了然地查看多行代码，无需不断滚动。

与面向纵向模式的显示器相同，您可以轻松了解多个相关功能的意图，无论是重构还是其他。但是不要让纵向屏幕成为编写多行函数的借口。

使用纵向屏幕在stackoverflow上写这个:-)

我一眼就可以很容易地看到很多帖子:-)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-04T15:52:57.967

如果您正在使用打印材料，是的，至于源代码，为什么不全屏显示您的 IDE 并关闭您不需要的任务窗格？

我发现肖像只有在我在网站上工作时才对我有用，能够一次看到整个页面会有所帮助。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-16T06:37:23.207

我会说如果显示器足够大，您不需要纵向模式（24 英寸或更高）来编写代码。

如果显示器比那个小，那么纵向模式更可取。

理想情况下，您将拥有一个 30 英寸（2560 x 1600）的宽屏来处理您的代码，以及在附近舒适地打开的实用程序和附近的第二个较小的监视器来预览结果（我在这里专门谈论网络编码，但它会可能也适用于大多数其他编码 - 屏幕大小与目标受众的屏幕一样）。

30 英寸的屏幕现在真的降价了，所以它可能值得一提。24 英寸的屏幕确实具有在默认字体大小下显着更大文本的优势。除非您移动到 ​​14pt，否则 30" 显示器上的文本可能会有点麻烦。

祝你好运。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2009-03-04T15:47:39.617

我目前有 2 台 19" 显示器。一台保持横向模式，一台保持纵向模式。我发现在纵向屏幕上处理文档或阅读长网页更容易。我也使用此设置进行编码并发现它确实有帮助，但这是一个习得的习惯。大声笑

# c - long long 对齐问题（MSVC vs. GCC）

> ID：611123
> 
> 赞同：1
> 
> 时间：2009-03-04T15:41:47.947
> 
> 标签：c, unit-testing, cross-platform, struct, alignment

我正在编写 C 跨平台库，但最终我的单元测试出现错误，但仅限于 Windows 机器上。我已经跟踪了这个问题，发现它与结构的对齐有关（我正在使用结构数组来保存多个相似对象的数据）。问题是： memset(sizeof(struct)) 和一个一个地设置结构成员会产生不同的字节到字节的结果，因此 memcmp() 返回“不相等”的结果。

这是用于说明的代码：

```
#include <stdio.h>
#include <string.h>

typedef struct {
    long long      a;
    int            b;
} S1;

typedef struct {
    long           a;
    int            b;
} S2;

S1 s1, s2;

int main()
{
    printf("%d %d\n", sizeof(S1), sizeof(S2));

    memset(&s1, 0xFF, sizeof(S1));
    memset(&s2, 0x00, sizeof(S1));

    s1.a = 0LL; s1.b = 0;

    if (0 == memcmp(&s1, &s2, sizeof(S1)))
        printf("Equal\n");
    else
        printf("Not equal\n");

    return 0;
} 
```

此代码与 MSVC 2003 @ Windows 产生以下输出：

```
16 8
Not equal 
```

但是与 GCC 3.3.6 @ Linux 相同的代码可以按预期工作：

```
12 8
Equal 
```

这使我的单元测试非常困难。

我是否正确理解 MSVC 使用最大本机类型（long long）的大小来确定与结构的对齐方式？

有人可以给我建议如何更改我的代码以使其更强大地应对这种奇怪的对齐问题吗？在我的真实代码中，我通过通用指针使用结构数组来执行 memset/memcmp，我通常不知道确切的类型，我只有 sizeof(struct) 值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T03:18:13.860

您的单元测试的期望是错误的。它（或它测试的代码）不应逐字节扫描结构的缓冲区。对于字节精确的数据，代码应该在堆栈或堆上显式创建一个字节缓冲区，并用每个成员的提取来填充它。通过对整数值使用右移操作并通过字节类型（例如（无符号字符））转换结果，可以以与 CPU 字节序无关的方式获得提取。

顺便说一句，你的代码段写过去 s2。你可以通过改变这个来解决这个问题

```
memset(&s2, 0x00, sizeof(S1));

s1.a = 0LL; s1.b = 0;

if (0 == memcmp(&s1, &s2, sizeof(S1))) 
```

对此，

```
memset(&s2, 0x00, sizeof(S2));

s1.a = 0LL; s1.b = 0;

if (0 == memcmp(&s1, &s2, sizeof(S2))) 
```

但结果在技术上是“未定义的”，因为结构中成员的对齐方式是特定于编译器的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T15:49:23.980

海合会手册：

> 请注意，ISO C 标准要求任何给定结构或联合类型的对齐至少是相关结构或联合的所有成员的对齐的最小公倍数的完美倍数。

此外，这通常会引入填充元素（即填充字节以使结构对齐）。您可以将`#pragma`与 的参数一起使用`packed`。请注意，`#pragma`s 不是可移植的工作方式。不幸的是，这也是在您的情况下工作的唯一方法。

参考： [这里](http://gcc.gnu.org/onlinedocs/gcc-3.2/gcc/Type-Attributes.html)是关于结构对齐的 GCC。 [MSDN](http://msdn.microsoft.com/en-us/library/71kf49f1(VS.80).aspx)结构对齐。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T15:44:48.953

我们所做的是使用#pragma 包来指定对象应该有多大：

```
#pragma pack(push, 2)

typedef struct {
    long long      a;
    int            b;
} S1;

typedef struct {
    long           a;
    int            b;
} S2;

#pragma pack(pop) 
```

如果这样做，两个平台上的结构将具有相同的大小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T15:45:26.580

你可以做类似的事情

```
#ifdef _MSC_VER
#pragma pack(push, 16)
#endif

/* your struct defs */

#ifdef _MSC_VER
#pragma pack(pop)
#endif 
```

给出一个编译器指令强制对齐

或者进入项目选项并更改默认结构对齐[在代码生成下]

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T16:21:55.573

请注意，这不是一个“奇怪的”对齐问题。MSVC 选择确保结构在 64 位边界上对齐，因为它具有 64 位成员，因此它在结构的末尾添加一些填充以确保这些对象的数组将正确对齐每个元素。我真的很惊讶 GCC 没有做同样的事情。

我很好奇你的单元测试是做什么的，这会遇到障碍——大多数时候结构成员的对齐是不必要的，除非你需要匹配二进制文件格式或有线协议，或者你真的需要减少结构使用的内存（特别是在嵌入式系统中使用）。在不知道您在测试中尝试做什么的情况下，我认为无法给出一个好的建议。打包结构可能是一种解决方案，但它需要一些成本 - 性能（尤其是在非英特尔平台上）和可移植性（结构打包的设置方式可能因编译器而异）。这些对您来说可能无关紧要，但可能有更好的方法来解决您的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T14:00:16.450

64 位值的结构填充在不同的编译器上是不同的。我已经看到了 gcc 目标之间的差异。

请注意，显式填充到 64 位对齐只会隐藏问题。如果你开始天真地嵌套结构，它会回来，因为编译器仍然会不同意内部结构的自然对齐。

# java - JVM可以提供快照持久化吗？

> ID：611134
> 
> 赞同：14
> 
> 时间：2009-03-04T15:44:19.220
> 
> 标签：java, jvm

是否可以转储正在运行的 JVM 的图像，然后通过将图像加载到 JVM 来恢复以前的状态？我相当肯定答案是否定的，但我很想弄错。

随着 JVM 可用的所有动态语言增加了交互性，能够保存编码会话将有助于节省手动将 VM 恢复到先前会话的时间。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-04T17:12:20.070

[前段时间为此提出了](http://tech.puredanger.com/2008/01/09/strong-mobility-for-java/)一个JSR 323，但被[拒绝了](http://tech.puredanger.com/2008/01/24/jcp-votes-down-jsr-323/)。您可以在这些文章中找到一些链接，了解这背后的研究及其需要采取的措施。它大多被拒绝为一个太不成熟的想法。

我听说至少有一家初创公司（不幸的是不记得名字了）正在通过虚拟机管理程序（可能是 Xen）开发虚拟化技术，该虚拟化技术已经非常接近能够移动 JVM，甚至包括文件系统引用之类的东西和套接字端点。因为他们处于管理程序级别，所以他们可以访问所有这些东西。通过将它和 JVM 挂钩，他们拥有了大部分内容。我认为他们可能已经破产了。

今天你能得到的最接近的东西是[Terracotta](http://terracotta.org)，它允许你集群你的 JVM 堆的一部分，将它存储在一个服务器数组中，它可以被持久化。在 JVM 启动时，您连接到集群并可以继续使用指定为集群的堆的任何部分。实际对象会根据需要进行故障处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T04:15:50.880

目前不可能。通常，在不同的上下文中暂停和重新启动进程的内存映像非常难以实现：您将如何处理开放的操作系统资源？转移到具有不同指令集的机器？数据库连接？

此外，正在运行的 JVM 的图像可能非常大 - 可能比您实际感兴趣的状态子集大得多。所以从性能角度来看，这不是一个好主意。

一个更好的策略是让**代码保持并重新创建应用程序状态**：这对于大多数 JVM 动态语言来说是相对可行的。我在 Clojure 中做了类似的事情，在那里你有一个交互式环境 (REPL)，并且很可能创建和运行一系列操作来重建你想要在另一个 JVM 中的应用程序状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T16:34:49.533

这在我知道的任何 JVM 中目前都是不可能的。如果程序在与环境断开连接的情况下运行，那么在 JVM 中实现这样的事情并不是很困难。然而，许多程序在它们的环境中都有钩子（想想文件句柄、数据库连接），这会使实现这样的事情变得非常麻烦。

# .net - 除了编译之外，MSBuild 脚本中应该包含哪些内容？

> ID：611136
> 
> 赞同：3
> 
> 时间：2009-03-04T15:44:26.630
> 
> 标签：.net, msbuild, cruisecontrol.net

我目前正在尝试设置 CruiseControl.net，所以我想知道如何拆分我的任务。

通常，我想运行单元测试 (xUnit.net)、帮助文件生成 (Sandcastle) 和 FxCop。

现在我只是想知道是否应该在 msbuild 配置（“文档”）中指定一个新目标并使用它来运行 SandCastle，或者它是否属于单独的脚本？此外，msbuild 旨在构建某些东西，所以我猜 ncover、xunit 和 FxCop 不应该是其中的一部分，或者他们应该是吗？

msbuild 的预期范围是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-04T21:39:27.587

将几乎所有内容都放入 MSBuild 脚本中，以便您和其他开发人员可以通过命令行在本地运行相同的步骤。否则，当构建出现问题时，您必须在 CC 服务器上对其进行调试。不是很好的调试体验。此外，您希望在提交**之前**在本地运行构建以确保它有效。

我不会放入 MSBuild 脚本的几件事是：

*   SVN 更新，因为 CC 无论如何都必须这样做，并且在进行本地构建时通常不想更新。（嗯，我**确实**经常打字`svn up && msbuild`，但是太短了，我不需要把它写进脚本。）
*   创建和发布构建报告；这又是 CC 的域，在本地没有用

至于构建您的 MSBuild 文件，您将需要一个“主”构建脚本，您可以使用它来构建所有内容**或**只是一些目标，例如

*   `MSBuild /t:Build`只是逐步构建代码
*   `MSBuild /t:Rebuild`进行干净的重建
*   `MSBuild /t:UnitTest`只运行单元测试
*   `MSBuild`对于最常见的选择，比如说，相当于`t:Build;UnitTest`
*   `MSBuild /t:All`干净地构建代码、文档和设置，运行所有测试，并打包结果

您还可以为流行的变体添加“快捷方式”目标。

拥有一个主构建文件并不意味着所有东西都在这个文件中定义；您可以包含其他 msbuild 文件，和/或递归调用 msbuild 来组织您的构建。例如：

*   主.proj文件应该比较简单；主要是，它应该定义特定于项目的东西，例如要构建的解决方案列表和特定于项目的覆盖
*   让主文件包含一个包含目标和默认属性的 .targets 文件；努力使这个项目保持中立和可重用。
*   如果 .targets 文件变得太大，请将其拆分为单独的文件，例如，一个用于代码，一个用于帮助和文档，一个用于设置和打包。让你的主 .targets 文件包含那些子文件，这样你的 .proj 文件仍然只需要包含一个文件
*   同样，如果需要，您可以拆分主 .proj 文件，例如通过子系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T15:53:05.283

我有一个用于单个项目的构建脚本，我只是在构建套件时将它们从*第二个*构建文件链接起来......例如，我的 protobuf-net 构建文件处理版本控制（SVN），编译（MSBuild + NAnt for mono），测试（NUnit），打包（zip）等。这是你的构建过程；做你需要的；-p 如果我也可以做部署和文档。

这还取决于您的工作方式；如果您使用 CruiseControl，它可能会为您处理大部分工作。对于我自己，我喜欢命令行“构建”步骤。

# mysql - 如何将 SQL_CALC_FOUND_ROWS 和 FOUND_ROWS() 合并到现有的 Web 应用程序中

> ID：611142
> 
> 赞同：0
> 
> 时间：2009-03-04T15:45:48.247
> 
> 标签：mysql

我刚刚阅读了有关 mysql 的 SQL_CALC_FOUND_ROWS 和 FOUND_ROWS() 的信息，它们通过删除 LIMIT 条件来帮助您获得先前执行的查询的总结果大小。现在我想在现有的 Web 应用程序中使用此功能。

我有几种方法，但我不确定哪种方法最好：

1) PHP 是否已经具有使用 FOUND_ROWS() 功能的函数？我正在使用带有 mysqli 的 php 5 和带有 innodb 存储引擎的 mysql 5。

2) 我正在构建的应用程序已经有它自己的数据访问对象，它包装了 mysqli 库。它负责生成经常使用的 CRUD 查询。我是否应该编辑此对象以在所有 SELECT 查询中包含 SQL_CALC_FOUND_ROWS？可能存在哪些并发症？

还有其他想法/反馈吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T15:50:38.113

> 1) PHP 是否已经有使用该`FOUND_ROWS()`特性的函数？我正在使用带有 mysqli 的 php 5 和带有 innodb 存储引擎的 mysql 5。

我以为[`mysql_num_rows`](http://php.net/mysql_num_rows)可以，但是经过一点浏览后，我想我可能是错的。

**更新：**是的，我错了:)

> 2) 我正在构建的应用程序已经有它自己的数据访问对象，它包装了 mysqli 库。它负责生成常用`CRUD`查询。我应该编辑此对象以包含`SQL_CALC_FOUND_ROWS`所有`SELECT`查询吗？可能存在哪些并发症？

`SQL_CALC_FOUND_ROWS``LIMIT`如果您的查询中没有子句，将尝试计算将返回的行数。

这将在一种情况下使用元数据：

1.  当您的表使用`MyISAM`引擎时，**AND**
    *   当您的查询没有`WHERE`子句时。

在其他情况下`SQL_CALC_FOUND_ROWS`，将一一计算行数，从而影响性能。

不要将它附加到每个查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T15:57:53.743

1.) 不，php 没有这样的功能。

2.) 我认为只有在真正需要时才使用 SQL_CALC_FOUND_ROWS 会更好。

# javascript - YUI Editor：如何使用 CSS 来格式化编辑器窗口的内容？

> ID：611147
> 
> 赞同：2
> 
> 时间：2009-03-04T15:46:19.543
> 
> 标签：javascript, ruby-on-rails, yui, richtextbox, yui-editor

我已经实现了[YUI 编辑器](http://developer.yahoo.com/yui/editor/)，并希望应用 CSS 来更改用户在富文本编辑器中正在处理的文本的**外观**。

我正在[为 ruby​​ on rails 使用 yui_editor 插件](http://github.com/larsklevan/yui_editor/tree/master)，但这并不意味着不欢迎通用答案。如果您可以将我指向正确的 API 部分和/或有关如何执行此操作的示例，那甚至可以。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T18:15:09.823

同时，我自己也找到了答案：这可以通过使用`css` *配置属性*（[YUI API](http://developer.yahoo.com/yui/docs/YAHOO.widget.SimpleEditor.html)）来实现。

要使用 rails 上的 yui_editor 插件实现这一点，我必须插入 css 属性，如以下代码片段所示`config/yui_editor.yml`：

```
editor_config_javascript: "
{
  handleSubmit: true,
  autoHeight: false,
  css: 'YADA { FOO: BAR; }',
  collapse: true,
  toolbar: ...
} 
```

就是这样，就像一个魅力。

# asp.net - 将 asp 2.0 页面连接到远程服务器上的 VBscript

> ID：611148
> 
> 赞同：1
> 
> 时间：2009-03-04T15:46:25.470
> 
> 标签：asp.net, asp-classic, vbscript

我正在开发一个网站，我需要让我的 asp 页面连接到远程服务器上的 VB 脚本，向它发送一些变量并返回一个字符串。然后吐出返回的数据。

我在 Java 中做过类似的工作。

谁能指出我正确的方向来帮助我制作一个简单的概念证明？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T16:32:28.277

基本上，您可以使用请求字符串将请求数据发送到远程服务器：

[http://www.example.com/GetMyString.asp?MyVal1=value1&MyVal2=value2](http://www.example.com/GetMyString.asp?MyVal1=value1&MyVal2=value2)

然后在 GetMyString.asp 页面中的远程服务器上使用 Request Object 检索这些值，然后使用 Response.Write 发回字符串结果

```
'<%

value1 = Request["MyVal1"]

value2 = Request["MyVal2"]

newvalue = "The values receievd were: "+ value1+ " and "+ value2

Response.Clear()

Response.Write(newvalue)

Response.End()

%>' 
```

# sql - 如何阻止身份列中出现 13 的倍数

> ID：611152
> 
> 赞同：9
> 
> 时间：2009-03-04T15:46:51.367
> 
> 标签：sql

假设我有下表：

```
Create Table Comments (
    ID Int Identity(1,1) Not Null Primary Key Clustered,
    Comment Text Not Null
) 
```

既然我很迷信，我怎么能阻止 13 的倍数出现在 ID 列中？
即：跳过 13、26、39 等。

非常感谢 MySQL 或 MSSQL 中的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-04T15:50:00.517

每次在序列中出现 13n - 1 时，创建一个触发器以跳到下一个

BradC，这是给你的。在没有任何 SQL Server 知识的情况下，我将在 Oracle 中进行。 [这](http://msdn.microsoft.com/en-us/library/ms189799.aspx)似乎是 SQL Server 中触发器的一个很好的参考

```
CREATE OR REPLACE TRIGGER trigname 
  AFTER INSERT ON Comments
  FOR EACH ROW 
  IF (:new.ID % 13 = 12) THEN
    -- increase the sequence
    SELECT comment_ID_sequence.NEXTVAL FROM dual;
  END IF;   
END; 
```

如果不进行实际测试，这可能行不通，但是通过少量的反复试验，您可以使其正常工作。Oracle 有完全不绑定到表的序列对象，如果需要，您可以整天调整序列，而无需接触表。我不知道这在 SQL Server 中是否属实。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T16:04:08.827

编辑：以前的答案是完全错误的。

你可以这样做：

```
Identity(1, 13) 
```

经测试：

```
for (int i = 1; i < 10000000; i += 13)
{
    if (i % 13 == 0)
    {
        Console.WriteLine(i);
    }
} 
```

以 13 递增，从 1 开始不应该给你 13 的倍数，至少达到 1000 万。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-04T16:28:40.203

身份（7919、4966）

这在 32 位 int 中返回了 432'436 个唯一 ID，并且没有一个是 13 的倍数。

更多对：

17, 1040 - 产生 2'064'889 个值

17, 559 - 产生 3'841'653 个值

[编辑]要测试的小python程序：

```
import sys

def x(start, step):
    count = 0
    i = start
    N = 1 << 31
    while i < N:
        #print i
        if i % 13 == 0:
            break
        i += step
        count += 1
    print i, i/13.0, count

if __name__ == '__main__':
    x(int(sys.argv[1]), int(sys.argv[2])) 
```

我只使用了几个素数，但这并没有真正起作用；使用素数，我只能得到 1-12 个数字的序列。所以我从一个随机对开始并改变第二个数字，直到脚本停止返回。

我不知道这两个数字的数学性质；）有人吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-04T16:08:51.703

在插入时创建触发器。

当插入 13 减去 1 的倍数（12、25、38 等）时，立即插入并删除另一行。

类似的东西（可能需要修改）：

```
CREATE TRIGGER ON [table_name]
AFTER INSERT
AS
    -- Get the last inserted identifier
    DECLARE @LastID INT -- or whatever type is your identity column
    SET @LastID = SELECT ID FROM inserted -- inserted holds the inserted entry

    -- Check if the ID is a multiple of thirteen minus 1
    IF ((@LastID + 1) % 13 = 0) -- not sure it would work, but something like that
    BEGIN
        INSERT INTO [table_name]
        -- dummy values

        DELETE FROM [table_name] WHERE ID = (@LastID + 1)
    END

GO 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T15:48:56.417

```
Create Table Comments (    
    ID Int Identity(2,2) Not Null Primary Key Clustered,    
    Comment Text Not Null
) 
```

# iphone - iPhone 上有哪些 XML 选项？

> ID：611153
> 
> 赞同：3
> 
> 时间：2009-03-04T15:47:15.950
> 
> 标签：iphone, objective-c, xml

我已经在我的应用程序中实现了 NSXMLParser，并且正在审查替代方案。我对 NSXMLParser 的抱怨是它在实现简单文件时很复杂，而且它也不是最简单的东西。

到目前为止，我已经确定：

*   [触摸XML](http://code.google.com/p/touchcode/wiki/TouchXML)
*   [目标-XML](http://www.metaobject.com/blog/2009/01/iphone-xml-performance.html)

还有其他人吗？

你对这些有什么经验？

感谢您的输入！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T16:04:46.953

我们在我们的应用程序中使用[libxml2](http://xmlsoft.org/)，特别是[xmlTextReader](http://xmlsoft.org/xmlreader.html) API。它是一个流阅读器，它允许比 SAX 阅读器更简单的代码（没有回调等），并且不像 DOM 阅读器那样将整个文档树放在内存中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T04:39:30.120

开发人员门户中有一个非常好的示例，称为 XMLPerformance。它告诉您如何使用 libxml2 和 NSXMLParser 有效地解析 xml 文件。

我在我的一个应用程序中使用它并且效果很好。我的 XML 中有大约 600 个项目，但使用示例中提供的方法加载视图几乎不需要 1 秒（不消耗太多内存！）

# sql-server - MS SQL SP - 使用 EXEC 记录集

> ID：611156
> 
> 赞同：0
> 
> 时间：2009-03-04T15:47:43.097
> 
> 标签：sql-server, stored-procedures, exec, recordset

有没有办法处理从另一个 SP 中的 exec 返回的记录集？整个记录集，最好不使用 OUTPUT

IE

MyStoredProcedure @var1 int AS BEGIN

执行另一个SP @var1

-- 对另一个SP返回的记录集做一些事情

结尾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T15:58:16.860

```
CREATE PROC MyStoredProcedure
    @var1 int
AS
BEGIN
DECLARE #temp (
col1 ...
)

INSERT #temp
EXEC anotherSP @var1

-- do something against #temp

END 
```

表变量也适用于 SQL 2005 及更高版本。临时表仅适用于 SQL 2000。

# asp.net - 如何为设计人员提供对 ASP .NET 母版页的轻松编辑？

> ID：611163
> 
> 赞同：3
> 
> 时间：2009-03-04T15:49:06.617
> 
> 标签：asp.net, content-management-system, master-pages

场景：我的所有页面都有一个非常标准的母版页。它包括通常的登录表单和其他要在每个页面上提取的动态列表。网页设计师已经可以修改每个页面的中心内容占位符。但是，母版页的设计和布局仍然在我的项目中，对设计的任何修改都必须在 Visual Studio 中进行，并且重新编译和重新部署项目。

通过 CMS 提供对设计母版页的近乎完全访问权限的最佳方式是什么？我可以识别的一些问题是包含任何动态列表或特定控件，例如登录表单。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T16:11:29.670

除非您想在门户中托管您的内容，否则我不知道这个问题的完美答案。

如果他们设计的位只是页面的外观和感觉，那么这可以由 css 控制，您可以允许他们使用不同的 css 文件创建主题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T19:30:02.527

这确实是一个有趣的问题，并且没有完美的解决方案。我曾在一家电子商务商店工作过这个问题，坦率地说，我只是要求设计师在很多情况下为我提供 html 和 css，然后我会抓取 html 和 css 并将它们添加到我的项目中。是的，这很乏味......

然后我们构建了一个 cms，设计师可以将他们的 html 复制并粘贴到 html 编辑器中，我们会将这些 html 片段存储在数据库中。我的网络应用程序会在运行时从数据库中获取这些内容。这解决了一些问题，但不是全部，因为它没有让他们完全控制网页的设计。

最重要的是，您需要对设计师如何将他们的作品提交给您制定标准。如果你有它，并且你可以依靠 html 和 css，那么你可以考虑围绕它构建一个 CMS。在 RAD 的今天，我发现使用交付给我的 html 和 css 并根据需要简单地将这些片段复制并粘贴到我的母版页和其他页面中更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T19:35:09.777

虽然这不是 CMS 的答案，但您确实可以让设计人员在 Expression Web 中打开母版页。我不会说它是世界上最伟大的工具，但我已经让设计师在 Expression 中完成母版页设计并取得了很好的效果。

然而，有一个痛点。如果打开整个项目，设计人员会将文件背后的代码视为单独的项目，而不是像 Visual Studio 中看到的树视图。

我想您可以通过 CMS 签出母版页以便与 Expression 一起使用，但是没有内置的方法可以做到这一点，我也不知道有第三方工具可以做到这一点。希望 Expression Web 3 能让事情变得更简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T19:35:29.557

如果您有 CMS，最好让其完全控制页面内容。如果有 CMS 无法完成的事情，您可以考虑为 CMS 编写扩展或插件模块，然后您的设计人员可以将这些扩展或插件模块放到 CMS 页面编辑器中的页面上。

如果您的 CMS 不支持插件模块，您可能会尝试强制 CMS 和母版页执行它们不打算执行的操作。

如果上述方法在您的情况下不起作用，请考虑另一种想法：在您的母版页上放置内联框架，以托管在 CMS 中编辑的页面。

希望有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T16:06:59.600

好吧，使用[Web 应用程序项目](http://msdn.microsoft.com/en-us/asp.net/aa336618.aspx)页面在访问之前不会编译（链接是 2005，但它仍然适用）。这意味着实际的 .aspx（和 .ascx 等）页面以原始状态部署。设计人员可以更新服务器上页面的格式，并且下次有人请求该内容时将编译更新。

允许设计人员通过您网站的 UI 下载当前页面并上传替换页面相对简单。但是，它不是很安全（可能永远不应该这样做）。最好允许设计人员通过 Web 访问虚拟目录，以便他们可以使用[Expression Web](http://any-expression.com/expression-web/tutorials/ew-ftp-live.htm)等工具连接到该目录。通过这种方式，设计师可以打开当前网站，编辑页面，并将结果直接推送到生产中（尽管这种想法可能很可怕）。

* * *

当我因为正确答案而被否决时，让我指出一些事情。

网站项目按需编译代码隐藏和页面。如果您需要定期更新代码，这是一个不错的解决方案。

Web 应用程序项目可以配置为可更新。所有代码隐藏和类都编译成一个程序集，所有 aspx、ascx 等页面都按需部署和编译。这意味着设计师可以连接到网站，更新布局和静态内容，并在下一个请求时查看更改。

这是我首选的部署方法。我在野外有一些 Web 应用程序项目，在我的 dll 旁边部署了可更新的 aspx 文件。这个想法是网站的用户可以更改 UI 而无需向我提交更新，这样我就可以为他们重新编译它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T09:59:00.437

有趣的问题，
前段时间我一直在涉足该领域。

当这些网页设计师不在非内部 Photoshop 或 Flash 领域时，他们的知识水平如何？

如果使用 DIY-CMS，也许您可​​以对最易受影响的对象进行模板化，例如制作一个通用的（如您所想的，而不是他们所想的 ;-)）列表和进入设计的方式（如果适用）。

只要你有一个完整的框架设置，通过 CMS 处理设计人员可用的属性，就不需要重新编译......但当然，我可以很容易地看到一个开发人员（阅读：我) 跌跌撞撞地陷入细节完美的鸿沟……

恐怕最简单，也是唯一可管理的路径是标准化设计师如何向您表达他们的需求和愿望......它不会自己编码......

你能提供一些例子吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T03:27:39.447

您是否可以在母版页中放置占位符来代替应该允许设计师编辑的区域？由于母版页只能在 Visual Studio 中编辑，因此它可能是您目前唯一可行的选择。这种方法的一个问题是放置在占位符中的内容不太可能是有效的，因为您可能会将标签在一个占位符中打开而在另一个占位符中关闭。

```
<html>
<head>
<title></title>
<asp:PlaceHolder ID="headerContent" runat="server"></asp:PlaceHolder>
</head>
<body>

<asp:PlaceHolder ID="beforeContent" runat="server"></asp:PlaceHolder>

<asp:PlaceHolder ID="centralContent" runat="server"></asp:PlaceHolder>

<asp:PlaceHolder ID="afterContent" runat="server"></asp:PlaceHolder>

</body>
</html> 
```

我知道它很难看，但它可能会给您所需的控制权（只要您不介意 XHTML 验证器一直警告您）。您放入占位符的内容可能是您的用户控件或文字内容或其他任何内容，但您必须动态加载它。

想法？

编辑：这行不通。PlaceHolder 将呈现`<div>`会搞砸的标签。也许您可以扩展 PlaceHolder 并覆盖它呈现 HTML 的方式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T11:20:03.243

.master 只是一个文本文件。他们可以随意编辑它。他们肯定不会对它做任何事情，需要您重新编译代码才能查看它。这首先是 Master Pages 的一大优势：设计师和其他非程序员可以手动编辑它们而不会破坏任何东西。

让他们访问源代码控制下的文件，让他们发疯。

# c# - 同时突出显示两个子控件

> ID：611174
> 
> 赞同：0
> 
> 时间：2009-03-04T15:50:54.023
> 
> 标签：c#, .net, winforms

我有一个带有两个子控件的 Windows 窗体。我需要使用 c# 同时突出显示两个控件。请告诉我如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-03-25T10:23:53.203

MS TreeView 控件不支持多选，因此如果您必须使用多选，则必须使用 Peter 建议的方法。Infragistics UltraWinTree 控件具有多选功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-26T11:05:11.990

试试这个以突出显示 TreeView 控件中的节点

```
// condition when to highlight
if (treeNode.Text.StartsWith("Important"))
{
   treeNode.BackColor = Color.Yellow;
} 
```

# algorithm - 使用基于整数除法的例程进行计数 - 是否有公式化的方法？

> ID：611180
> 
> 赞同：0
> 
> 时间：2009-03-04T15:51:39.530
> 
> 标签：algorithm, language-agnostic, math, puzzle

考虑一个通过连续除法和余数运算进行计数的例程。

从 64 位除数开始，例程除以常数除数。
如果余数为 0，则例程返回。
否则，通过将余数乘以 2^32 并加上整数商来构造新的被除数。

在代码中：

```
/// ULong - 64 bit, unsigned 
/// UInt  - 32 bit, unsigned 
const UInt Divisor; 
int TrickyCounter( ULong Dividend)
{
    int count = 0;
    Ulong Quotient;
    UInt Remainder;

    do {
        Quotient = Dividend/Divisor;
        Remainder = Dividend%Divisor;
        assert((Quotient >> 32) == 0);
        count = count + 1;
        Dividend = ((ULong)Remainder << 32) + Quotient;
    } while (Remainder != 0);
    return count;
} 
```

对于任意除数，是否有一种最好的非迭代方法来计算必要的股息以获得所需的计数？
对于许多初始股息来说，这似乎很快达到了“断言”条件。一些红利会导致它永远循环吗？

* * *

如果例程返回商而不是计数，我可以计算股息以产生我想要返回的数字吗？

```
Uint TrickyNumber( ULong Dividend, int count)
{
    Ulong Quotient = 0;
    UInt Remainder;

    while (count > 0)
        Quotient = Dividend/Divisor;
        Remainder = Dividend%Divisor;
        assert((Quotient >> 32) == 0);
        count = count - 1;
        Dividend = ((ULong)Remainder << 32) + Quotient;
    } 
    return (UInt)Quotient;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T18:19:04.993

> 一些红利会导致它永远循环吗？

Dividend = 0x1ffffffffL, Divisor = 2 是一个相当明显的例子，整个家族 (Divisor<<32)-1, Divisor 都是不动点。

根据这些，可以找到许多初始被除数和除数的循环组合，我相信还有更多：

```
#include <stdio.h>
#include <stdint.h>
#include <inttypes.h>

size_t tricky_counter( uint64_t dividend, const uint32_t divisor )
{
    const size_t cycle_buffer_size = 1024;
    size_t count = 0;
    uint64_t quotient;
    uint32_t remainder;

    uint64_t pre[cycle_buffer_size];

    do {
        pre[ count % cycle_buffer_size ] = dividend;

        quotient = dividend/divisor;
        remainder = dividend%divisor;

        if ( (quotient >> 32) != 0) {
           printf("quotient: 0x%" PRIx64 "\n", quotient);
        }

        count = count + 1;

        dividend = ((uint64_t)remainder << 32) + quotient;

        for (size_t i = 0; i < count && i<cycle_buffer_size;++i) {
            if (pre[i] == dividend) {
                size_t cycle = 0;

                printf("dividend repeats: \n");

                while (i != count % cycle_buffer_size) {
                    //~ printf("  0x%" PRIx64 " / %" PRId32 " \n", pre[i], divisor);
                    i = (i + 1) % cycle_buffer_size;
                    ++cycle;
                }

                printf("  0x%" PRIx64 " / %" PRId32 "  cycle size %zd \n", dividend, divisor, cycle);

                return 0;
            }
        }

    } while (remainder != 0);

    return count;
}

int main ( void )
{
    for (uint64_t k = 1; k < 256; ++k) 
        for (uint64_t x = 2; x < 1024; ++x) 
            tricky_counter( (x-1 << 32) + 0x01010101L * k, x);    
} 
```

# wcf - 为什么 WCF 如此重要，在什么情况下使用它？

> ID：611183
> 
> 赞同：43
> 
> 时间：2009-03-04T15:52:09.917
> 
> 标签：wcf

我在一定程度上理解它可以帮助应用程序进行通信，而不管它们的位置如何。为什么它很重要？WCF 的实际使用示例是什么？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-03-04T15:59:12.507

WCF 是一种通用通信机制，允许您在两方之间设置通用客户端/主机通信。WCF 的巧妙之处在于它允许您配置服务属性，例如传输 (http/pipes/tcp/Tibco EMS)、安全模型（任何 W3C 标准）、压缩、编码、超时等，而无需更改任何代码. 那是强大的。最重要的是，您可以对其进行配置，以便您可以拥有 C# 服务和 Java（或任何其他语言或其他方式）客户端，只要它们都使用相同的机制进行交谈。

您可以使用 WCF 创建一个标准的 HTTP SOAP Web 服务，并且有一天决定将其切换为使用更快的命名管道进行本地通信。您可以创建通过 TibcoEMS 进行通信的 Web 服务，并在队列级别轻松进行故障转移。您可以创建一个文件流式 Web 服务，将各种图像/视频分发到您的应用程序。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-11-03T06:08:58.530

这里有一些我认为可能有助于理解整个场景的大脑转储。

### 创建 WCF 的原因：背景

现代应用[分布式应用]开发我们使用不同的架构和技术进行通信

IE：

*   COM+
*   .NET 企业服务
*   MSMQ
*   .NET 远程处理
*   网页服务

因为有各种技术。他们都有不同的架构。所以学习所有这些都是棘手和乏味的。

需要专注于每一项技术的开发而不是应用的业务逻辑

因此，微软将这些功能统一为单一的、通用的、通用的面向服务的通信编程模型。WCF 提供了一种使用通用 API 的通用方法，开发人员可以专注于他们的应用程序而不是通信协议。

现在我们称之为 WCF。

![WCF 背景](https://www.codeproject.com/KB/WCF/WCF_Basics/WCF1_small.JPG)

注意：图像收集自 - [http://www.codeproject.com/Articles/255114/Windows-Communication-Foundation-Basics](http://www.codeproject.com/Articles/255114/Windows-Communication-Foundation-Basics)

* * *

### WCF 服务究竟代表什么？

WCF 允许您**异步消息**将一个服务终结点转换为另一个服务终结点。

消息可以很简单

*   单个字符
*   一个字

作为 XML 发送

*   作为二进制数据流的复杂数据结构

Windows Communication Foundation(WCF) 支持多种语言和平台。

WCF 为您的服务提供运行时环境，使您能够将 CLR 类型公开为服务并将其他服务作为 CLR 类型使用。

* * *

一些示例场景包括：

*   用于处理业务交易的安全服务。
*   向其他人提供当前数据的服务，例如交通报告或其他监控服务。
*   允许两个人实时交流或交换数据的聊天服务。
*   一种仪表板应用程序，它轮询一个或多个服务以获取数据并将其以逻辑表示形式呈现。
*   将使用 Windows Workflow Foundation 实现的工作流公开为 WCF 服务。
*   用于轮询服务以获取最新数据馈送的 Silverlight 应用程序。

### 为什么我们应该使用 WCF？

来自代码项目文章，感谢[@Mehta Priya](http://www.codeproject.com/Members/mehtapriya) ，我发现了以下场景来说明这个概念。让我们考虑两个场景：

*   第一个客户端使用**java** App 与我们的服务交互。因此，为了实现互操作性，该客户端希望**XML 格式**的消息和协议为 HTTP。

*   第二个客户端使用 .NET 的性能要好得多，这个客户端需要二进制格式的消息和 TCP 协议。

### 没有 WCF 服务

现在对于规定的场景，如果我们不使用**WCF**，那么会发生什么让我们看看下面的图片：

*   方案 1：

![没有 WCF 的互操作性](https://www.codeproject.com/KB/WCF/815742/image001.gif)

*   场景二：

![没有 WCF 的互操作性](https://www.codeproject.com/KB/WCF/815742/image002.gif)

这是两种不同的技术，具有完全不同的编程模型。所以开发者必须学习不同的技术

因此，将所有技术统一并集中在一个屋檐下。Microsoft 提供了一种称为 WCF 的新编程模型。

### WCF 如何让事情变得简单？

一个人实施一项服务，他/她可以根据需要配置尽可能多的端点来支持所有客户端的需求。

为了支持上述 2 个客户端要求 - 我们将配置 2 个端点 - 我们可以指定要在配置端点中使用的协议和消息格式

![没有 WCF 的互操作性](https://www.codeproject.com/KB/WCF/815742/image003.gif)

## 参考：

1.  WCF：什么，为什么以及何时[https://vishalnayan.wordpress.com/2010/12/31/wcf-what-why-when/](https://vishalnayan.wordpress.com/2010/12/31/wcf-what-why-when/)
2.  为什么我们使用 WCF 服务？[http://www.codeproject.com/Tips/815742/Why-We-Use-WCF-Service-and-Sample-of-WCF-Service](http://www.codeproject.com/Tips/815742/Why-We-Use-WCF-Service-and-Sample-of-WCF-Service)
3.  什么是 Windows Communication Foundation [https://msdn.microsoft.com/en-us/library/ms731082(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/ms731082(v=vs.110).aspx)
4.  Windows 通信基础基础[http://www.codeproject.com/Articles/255114/Windows-Communication-Foundation-Basics](http://www.codeproject.com/Articles/255114/Windows-Communication-Foundation-Basics)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-05T14:24:37.687

到目前为止，几乎没有什么可以添加到响应中，尤其是来自“siz”的响应。

要补充的一点是，WCF 是当前在 .NET 平台上执行 Web 服务的方式。这不是“新”方式，而是当前方式。ASMX Web 服务是陈旧且几乎没有维护的方式。一位微软员工公开表示，只会对 ASMX 平台进行关键的安全修复，因此如果您打算让您的服务在一年多后仍然有用，请不要使用 ASMX。

除了典型的“Web 服务”用例之外，WCF 还处理非典型情况，例如通过命名管道、消息队列等进行的二进制通信。在很大程度上，您编写的支持简单的服务（例如基于 SSL 的 SOAP）也可以支持这些其他协议，无需更改代码。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-05-27T05:18:34.103

为了回答“现实世界”的问题，我刚刚完成了一个调度系统，一个[Visual Basic 6.0](http://en.wikipedia.org/wiki/Visual_Basic#Timeline) /access 警报接收器、一个 WPF/SQL ERP 系统和一个 iPhone 应用程序都共享信息以安排和执行作业。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-04T16:14:55.603

本质上，用例是您希望两个单独的应用程序以某种方式相互通信并且它们的位置未知（可能是同一台机器（但不同的[应用程序域](http://en.wikipedia.org/wiki/Application_Domain)）、同一网络或互联网的另一端）

您可以轻松地将其嵌入到[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)应用程序中。这是一个很好的发现。它也比[.NET Remoting](http://en.wikipedia.org/wiki/.NET_Remoting)容易得多。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-04T16:00:37.307

它优于经典 ASP.NET Web 服务 (.asmx) 的原因有很多。

我想到的其中一些是：

1.  对同一个服务调用具有多个绑定的能力意味着，如果您只是想在网络场内进行通信，则消息不必序列化为 XML 并返回。

2.  当涉及到同一合同的多个版本时，合同的定义方式要宽容得多。

# ruby-on-rails - 如何编写运行 Rails db:migrate 任务的 rake 任务？

> ID：611189
> 
> 赞同：3
> 
> 时间：2009-03-04T15:53:45.827
> 
> 标签：ruby-on-rails, rake

我想在我自己的 rake 任务中运行 db:migrate VERSION=0 然后 db:migrate 。我对如何做到这一点感到困惑。我需要特殊的需求声明吗？我的 rake 任务将驻留在 Rails 应用程序的 lib/tasks 目录中。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T16:05:31.167

编辑：Rake::Task[] 不接受参数，你必须在 ENV 中设置它。此外，您必须重新启用该任务才能多次运行它。

```
ENV['VERSION']= '0'
Rake::Task['db:migrate'].invoke
Rake::Task['db:migrate'].reenable
ENV.delete 'VERSION'
Rake::Task["db:migrate"].invoke 
```

注意：Rake::Task.reenable 需要 Rake 0.8.2 或更高版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T21:11:32.763

您的任务是否仅取决于拥有一个干净的数据库？如果是这种情况，那么您可以这样做：

任务 :my_task => [:environment, 'db:reset']

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T16:06:30.693

签出`rake db:reset`，因为这将完成您正在尝试做的事情。

要查看所有 rake 任务的作用，请运行`rake -T`

# php - 配置 Eclipse 以在工作空间外添加 buildpath 文件夹

> ID：611194
> 
> 赞同：2
> 
> 时间：2009-03-04T15:54:59.957
> 
> 标签：php, eclipse, localhost

我正在Mac上开发PHP。根据其他建议，我已将工作区设置在 MAMP 的 HTDOCS 文件夹中。

不幸的是，这意味着我不能像在生产中那样使用指向“/”的链接。有什么建议么？

相关地，工作区似乎阻止了对工作区外部构建路径的引用，但我想将我的敏感文件保留在基本工作区文件夹之外。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T17:30:19.650

我通常使用“链接”功能：

*   选择要在其中创建链接的文件夹（即根本身）；
*   右键->新建->文件夹
*   点击“高级”按钮
*   检查“链接到文件系统中的文件夹”并浏览htdocs下的文件夹

这应该有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T16:07:50.427

我没有使用 Eclipse 和 PHP 的经验，但对于 Java，您可以在“构建路径”对话框的“库”选项卡中“添加外部类文件夹”。通常，工作区之外的任何东西都称为“外部”，只能通过这些特殊选项访问。

# sharepoint - 为什么我在使用 Sharepoint 产品的 Reporting Services 插件时出现错误？

> ID：611196
> 
> 赞同：1
> 
> 时间：2009-03-04T15:56:12.343
> 
> 标签：sharepoint, reporting-services

### 背景：

我以共享点集成模式部署报告服务，在 MOSS 中安装插件并配置报告服务，一切正常，我使用的是 NTLM 身份验证，因此我将文件中的**RSWindowsNegotiate**替换为**RSWindowsNTLM**`rsreportserver.config`并从授权问题中退出管理集成设置部分，我遇到了授予数据库访问权限的错误，并且还通过使用一些代码行来退出，这些代码行向报告服务服务帐户授予权限以通过我的共享点中的所有 Web 应用程序。

### 问题：

当我添加报表查看器 Web 部件并浏览站点以添加存储在站点文档库中的报表时，出现以下错误：

> 请求失败，HTTP 状态 401：未授权

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-08T07:35:52.683

[当您尝试访问属于 IIS 6.0 应用程序池的网站时，您](http://support.microsoft.com/kb/871179/en-us)可能会收到“HTTP 错误 401.1 - 未经授权：由于凭据无效而拒绝访问”错误消息

> 当您尝试访问配置为仅使用集成 Windows 身份验证的 Microsoft Internet 信息服务 (IIS) 6.0 网站时，系统会提示您输入用户凭据。当您尝试登录时，您会再次收到登录提示。在您尝试登录 3 次后，您会收到以下错误消息：

```
HTTP Error 401.1 - Unauthorized: Access is denied due to invalid credentials. 
```

> ...
> 
> 1.  启动命令提示符。
> 2.  找到并更改到包含 Adsutil.vbs 文件的目录。默认情况下，此目录为 C:\Inetpub\Adminscripts。
> 3.  键入以下命令，然后按 Enter：

```
cscript adsutil.vbs set w3svc/NTAuthenticationProviders "NTLM" 
```

> 4.  若要验证 NtAuthenticationProviders 元数据库属性是否设置为 NTLM，请键入以下命令，然后按 Enter：

```
cscript adsutil.vbs get w3svc/NTAuthenticationProviders 
```

> ```
>  The following text should be returned: 
> ```

```
NTAuthenticationProviders       : (STRING) "NTLM" 
```

# c# - MSSQL 2005 C# 汇编和输出

> ID：611209
> 
> 赞同：0
> 
> 时间：2009-03-04T15:59:49.620
> 
> 标签：c#, sql-server, tsql, assemblies

我在我的程序集中输出变量时遇到问题。

1.  我需要`out string var1`在 C# 函数的参数列表中添加一个吗？我收到一个错误 - 与`var1`未设置有关的内容...
2.  我试过`parameter.Direction = ParameterDirection.Output`
3.  我找不到任何好的例子

编辑：我的程序集 SP 当前返回一个记录集...我希望它输出一些变量，以便我可以在另一个从中调用它的 SP 中使用它们。

IE

```
DECLARE @var1 int
EXEC dbo.MyAssemblySP @var1 OUTPUT
PRINT @var1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T16:05:19.043

不太确定您要做什么，但如果您尝试使用`out`关键字，以下是正确的语法：

```
public void foo(int arg1, out int arg2) {
    arg2 = arg1;
}

public void foo2() {
    int aOutput;
    foo(1, out aOutput);
    Console.WriteLine(aOutput);
} 
```

调用`foo2`将导致控制台写入`1`。

# powershell - 如何控制 Hyper-V VM 控制台中的进程？

> ID：611214
> 
> 赞同：3
> 
> 时间：2009-03-04T16:00:44.857
> 
> 标签：powershell, build-process, automation, hyper-v

我想将 Hyper-V VM 的构建编写为构建过程的一部分。具体来说，我需要能够启动进程，也许也可以将密钥发送到 VM，但只要我可以使用特定的命令行启动进程，我想我会很好。

我已经知道这个有用的库： http: [//www.codeplex.com/PSHyperv](http://www.codeplex.com/PSHyperv)，但它似乎是所有 VM 控制器级别的操作，而不是控制 VM 中的操作系统。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T16:26:42.097

我建议使用[PowerShell Remoting](http://www.microsoft.com/technet/scriptcenter/topics/winpsh/remote.mspx)。

# ruby-on-rails - 为什么启动 [rake db:migrate] 会对 lib/tasks 目录中的 rake 任务运行语法检查？

> ID：611215
> 
> 赞同：1
> 
> 时间：2009-03-04T16:00:56.357
> 
> 标签：ruby-on-rails, rake

我有一个 RubyOnRails 应用程序的 rake 任务文件，它位于 lib/tasks 目录中。运行 [rake db:migrate VERSION=0] 似乎会强制编译器检查 lib/tasks 文件中的语法。如果存在语法错误的文件，则 [rake db:migrate] 不会运行。为什么？那么如果我在 lib/tasks 中有一个坏文件怎么办。这里发生了什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T22:47:39.590

运行时，它会在查找被指示运行的任务之前`rake`加载所有`.rake`文件。`lib/tasks`它加载所有文件，而不是在找到所需任务时停止，因为任务可以在加载顺序的后面被文件覆盖。

您可以通过指定所需的 rakefile 来避免将它们全部加载：

```
rake mytask --rakefile lib/my_task.rake 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T16:03:44.867

当 Rake 运行时，它会自动加载`.rake`您`lib/tasks`文件夹中的所有文件。当它加载这些任务时，如果您有语法错误，它将被捕获。

# gtk - 如何在 Mac OSX Leopard 中安装 Glade

> ID：611217
> 
> 赞同：2
> 
> 时间：2009-03-04T16:01:31.517
> 
> 标签：gtk, osx-leopard, glade

如何在 Mac OSX Leopard 中安装 Glade？我还没有找到任何真正帮助我的指南。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T16:33:34.203

我建议使用[MacPorts 包管理器](http://www.macports.org/)。

他们有[几个](http://www.macports.org/ports.php?by=name&substr=glade)可用于安装 Glade（以及 libglade）的软件包：

*   林间空地 2

*   林间空地 3

*   Glade 3 不稳定

*   libglade

*   libglade2

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-17T15:34:28.840

使用[自制](http://brew.sh)：

```
brew install homebrew/x11/glade 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-05T12:24:01.733

之前尝试：

```
brew update 
```

然后

```
brew install homebrew/x11/glade 
```

# opengl-es - 在 OpenGL ES 中，如何加载具有透明像素的纹理？

> ID：611219
> 
> 赞同：23
> 
> 时间：2009-03-04T16:02:55.367
> 
> 标签：opengl-es

然后正确显示？一个例子是在一个矩形中有一个圆球，同时能够在背景中看到另一个纹理。

编辑：目前，当我加载纹理时，源图像中的透明像素显示为黑色。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-04T16:17:52.227

对于 iPhone 和 N95 这有效：

如果您从原始数据加载纹理，请将内部和源格式设置为 GL_RGBA。

```
glTexImage2D(GL_TEXTURE_2D, 0, 
    GL_RGBA,
    textureWidth,
    textureHeight, 
    0, 
    GL_RGBA,
    GL_UNSIGNED_BYTE,
    pointerToPixels); 
```

并且在渲染时，启用 alpha blend：

```
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
glEnable(GL_BLEND); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-11-04T13:12:41.963

@Virne 提供的答案是正确的，我可以通过一些小的修改将它用于 Android 设备。我使用的`myImage`对象是具有透明度的标准 .png 图像。

我使用这个创建了纹理：

```
GLUtils.texImage2D(GL10.GL_TEXTURE_2D, 0, myImage, 0); 
```

并且（如 Virne），我在渲染时启用了 alpha 混合：

```
gl.glBlendFunc(GL10.GL_SRC_ALPHA, GL10.GL_ONE_MINUS_SRC_ALPHA);
gl.glEnable(GL10.GL_BLEND); 
```

# html - 为什么这些 Div 标签没有正确嵌套？

> ID：611220
> 
> 赞同：0
> 
> 时间：2009-03-04T16:03:04.573
> 
> 标签：html, css

如果有人可以在这里提供任何见解，将不胜感激。我想创建输出，显示不同日期健身课程的预订情况。这个想法是有三个跨，但是需要很多行来覆盖所有的日期。为此，我想使用 CSS 而不是使用表格。

好的，所以我有以下 CSS 定义：

```
.ListSetContainer 
{ 
  background-color:Red;
  border:1px solid #999999;
  text-align:center;
}

.ListSet
{
  margin: 2px 2px 2px 16px;
  float: left;
  clear:none;
}

.ListSet ul 
{
  background-color: #EEEEEE;
  border: 1px solid #999;
  margin: 2px 2px 16px 2px;
  padding: 6px 6px 0px 6px;
} 
```

以及以下 HTML：

```
 <div style="clear:both;">
    <h4>Class Dates, Counts and Participants</h4>
    <div class='ListSetContainer'>
      <div class='ListSet'>
        <ul>...{Class information here...}
        </ul>
      </div>
      <div class='ListSet'>
        <ul>...{Class information here...}
        </ul>
      </div>
      <div class='ListSet'>
        <ul>...{Class information here...}
        </ul>
      </div>
    </div>  -- End of First ListSetContainer

    <div class='ListSetContainer'>
      <div class='ListSet'>
        <ul>...{Class information here...}
        </ul>
      </div>
      <div class='ListSet'>
        <ul>...{Class information here...}
        </ul>
      </div>
    </div>  -- End of Second ListSetContainer
  </div>  -- End of surrounding Div 
```

但不是让三个 div 水平排列，然后是第二行有两个 div，我得到的是：

[链接图像](http://www.bsdi.cc/images/divproblem.png)

一些笔记。首先，请注意 HTML 中的层次结构（ListSetContainer div 包含 ListSet div）不会反映在输出中。其次，ListSetContainer div 只有一个像素高 - 没有显示背景！（我使用红色背景只是为了确保我不会错过它）。整个封闭的 div 只是被压扁，内部的 div 会自行浮出。手动设置高度不起作用，因为带有列表的内部 div 是可变高度（启动时看起来很奇怪）。如果我删除浮动：左；从内部 div 中，它们扩展为屏幕的整个宽度，因此我无法连续获得三个。所以……我很茫然。

再次感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T16:08:19.770

您的 ListSetContainer 需要包含一些非浮动内容，以使其具有高度/宽度。浮动元素会将其从正常的布局层次结构中取出，因此仅包含 ListSets 的容器不包含任何可以正常呈现的内容。向容器添加一个不间断的空间，然后您应该能够设置它的宽度/高度，因为其中会有一些东西可以渲染。

我也会让你的 ListSetContainer 使用`clear: both`。这应该使它开始一个新的 ListSet“行”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T16:10:03.337

用于块`clear:both`。`.ListSetContainer`

但是您仍然可以仅使用一个列表来改进这一点：

```
<style type="text/css">
    .ListSetContainer {
        list-style: none;
        padding: 0;
    }
    .ListSetContainer li {
        width: 33.333%;
        float: left;
    }
    .ListSetContainer li li {
        width: auto;
        float: none;
    }
</style>
<ul class="ListSetContainer">
    <li><ul><li>...{Class information here...}</li></ul></li>
    <li><ul><li>...{Class information here...}</li></ul></li>
    <li><ul><li>...{Class information here...}</li></ul></li>
    <li><ul><li>...{Class information here...}</li></ul></li>
    <li><ul><li>...{Class information here...}</li></ul></li>
</ul> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T16:10:26.443

问题在于您的 ListSet 类需要“display: block;” 添加或“浮动：左；” 删除，如果添加块，则将“显示：块；宽度：100%”添加到 ListSetContainer 类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T16:10:57.843

这是因为`ListSetContainer`没有固定的宽度。我希望它们都适合宽屏显示器的一排。

你可以试试：

```
.ListSetContainer {
    width: 300px;
}

.ListSet {
    clear: none;
    float: left;
    width: 100px;
} 
```

和适当的风格。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T16:29:06.460

您正在呈现带有一组固定列的表格数据 - 每个月一个。听起来像是应该使用什么表。现在是您使用表格的机会，并且不会因此而感到内疚！

现在，如果您不打算使用表格，您应该固定每个元素的大小，而不是每行的元素数。让列数由浏览器窗口的大小决定。

如果做不到这一切，我认为你需要`clear: both`在每一行之间设置一个。

# c# - 在 C# COM 对象上实现 IProvideClassInfo

> ID：611231
> 
> 赞同：1
> 
> 时间：2009-03-04T16:05:31.507
> 
> 标签：c#, com, interop, com-interop, wsh

我正在尝试`IProvideClassInfo`在 C# COM 对象上实现它，以便可以从 Windows 脚本主机 (WSH) 使用它的事件。我设法实现了接口并跟踪对我的`GetClassInfo`方法的调用。但是，连接事件失败并显示`Cannot connect object`.

有没有人设法做到这一点？

这是我的脚本代码（JScript）：

```
function AP\_GetActionsResponse ()
{           
WScript.Echo ("AP\_GetActionsResponse event");
}

// It fails on this 
var obj = WScript.CreateObject ("Promotions.Promotion", "AP_"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T11:44:13.117

好的，我想通了 - 您必须在事件接口上指定 DispId，否则它不起作用。

不需要实现 IProvideClassInfo，但如果你愿意，你可以。

# flash - 如何在具有透明背景的闪光灯中制作具有透明背景的电影

> ID：611243
> 
> 赞同：0
> 
> 时间：2009-03-04T16:08:04.123
> 
> 标签：flash, actionscript, movieclip, mask, movie

我想制作一个像[http://www.multisoft.com/](http://www.multisoft.com/)一样的闪光灯（等待页面加载）。页面右下角的漂亮女士有一个透明的背景。我对闪光灯的背景（不是 wmode 的东西）不感兴趣，但对电影本身的背景不感兴趣。有没有简单的方法可以做到这一点？也许是一个脚本，它从每一帧中获取一种颜色并用它制作一个蒙版？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T17:08:40.780

我不确定你在问什么，但看起来链接网站上的女士只是一个 alpha 通道 flv（非常像[这样](http://www.adobe.com/devnet/flash/articles/talking_head_video_05.html)。）这是在视频的编码过程中完成的，而不是在动作脚本中完成的......是您正在寻找一种程序化的方式来做到这一点？

# c# - 将 UpdatePanel 添加到页面后不再调用 PageMethod

> ID：611245
> 
> 赞同：1
> 
> 时间：2009-03-04T16:08:35.730
> 
> 标签：c#, asp.net, asp.net-ajax, updatepanel, pagemethods

*我在 asp.net 2.0 上使用 asp.net ajax 1.0 版。（我还不能升级到 3.5）*

我有一个 PageMethod 会被 Javascript 调用。在我将 UpdatePanel 添加到页面的另一部分之前，这非常有效。现在，当我在打开调试的情况下运行页面时，页面方法中的断点永远不会被调用。当我在萤火虫中查看调用 PageMethod 的帖子时返回的内容时，我注意到返回了整个 aspx 页面，而不仅仅是调用值。我做了什么？

这是对 PageMethod 的 Javascript 调用：

```
function EndRequestHandler(sender, args) {
    $('#selectedCHK').change(
        function() {
            var chkedInput = $('#selectedCHK');
            var networkRead = chkedInput[0].checked;
            PageMethods.ChangeSelectedNetworkReadFlag(routeNum, 
                                                      networkRead, 
                                                      function(msg) { alert(msg);  });
        }
    );
}
$(document).ready(function() {
    Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler);
} 
```

在每个请求结束时调用 EndRequestHandler 函数的意义在于，ID 为“#selectedCHK”的项目位于更新面板内，并且每次刷新 UpdatePanel 时都需要设置事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T18:38:39.660

尝试在更新面板上将更新模式设置为条件。听起来更新面板正在劫持您的事件。

```
<asp:UpdatePanel ID="upMyPanel" UpdateMode="Conditional" runat="server"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T19:07:21.853

我想通了，这是一个配置问题。具体来说，我需要添加：

```
<httpModules>
    <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
</httpModules> 
```

在 <system.web> 部分内。

我以为我已经正确配置了站点，但我决定逐步阅读[文档](http://www.asp.net/AJAX/documentation/live/ConfiguringASPNETAJAX.aspx)。

# sql - 如何在 Derby 中模拟 UPDATE x SET (col1, col2) = ( SELECT a,b FROM y )？

> ID：611258
> 
> 赞同：2
> 
> 时间：2009-03-04T16:10:57.987
> 
> 标签：sql, sql-update, derby

Derby 不支持这种语法：

```
UPDATE x SET (col1, col2, ...) = ( SELECT a,b,... FROM y ... ) 
```

（见[这个错误](https://issues.apache.org/jira/browse/DERBY-4074)）。除了在 Java 中创建一个循环来执行选择并发送 N 个更新之外，还有其他人有解决方法吗？

**[编辑]**请注意，我有 50 列和一个复杂的条件（与 x 和 EXISTS 等连接）。所以我想避免重复 SELECT 50 次，请:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T19:36:00.583

我也会这样做，是 rbobby siad，但我也是 MSSQL 人。

你有没有尝试过：

```
UPDATE x 
SET (col1)= ( SELECT a FROM y where y.fkfield = x.pkidfield),
(col21)= ( SELECT b FROM y where y.fkfield = x.pkidfield), ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T16:21:59.893

我不确定那是有效的 sql（我更像是一个 MS SQL 人，所以我可能会走得很远）。

通常我会这样做：

```
update Orders
set Orders.Code = OtherOrders.Code,
    Orders.Name = OtherOrders.Name
from Orders inner join Orders as OtherOrders 
    on OtherOrders.OrderId = Orders.OrderId 
```

# c++ - C++ 中的高效字符串连接

> ID：611263
> 
> 赞同：117
> 
> 时间：2009-03-04T16:11:28.373
> 
> 标签：c++, performance, string, concatenation

我听到一些人表达了对 std::string 中“+”运算符的担忧，以及各种加快连接速度的变通方法。这些真的有必要吗？如果是这样，在 C++ 中连接字符串的最佳方法是什么？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-03-04T16:14:01.940

**除非你真的需要效率，否则额外的工作可能不值得。** 只需使用运算符 += 代替，您可能会获得更好的效率。

现在，在免责声明之后，我将回答您的实际问题......

STL 字符串类的效率取决于您使用的 STL 的实现。

您可以通过 c 内置函数手动进行连接， 从而**保证效率**并**更好地控制自己。**

**为什么 operator+ 效率不高：**

看一下这个界面：

```
template <class charT, class traits, class Alloc>
basic_string<charT, traits, Alloc>
operator+(const basic_string<charT, traits, Alloc>& s1,
          const basic_string<charT, traits, Alloc>& s2) 
```

可以看到每个 + 之后都会返回一个新对象。这意味着每次都使用一个新的缓冲区。如果您正在执行大量额外的 + 操作，则效率不高。

**为什么可以提高效率：**

*   您是在保证效率，而不是相信委托人会为您高效地完成工作
*   std::string 类对字符串的最大大小一无所知，也不知道连接它的频率。您可能拥有这些知识，并且可以根据这些信息做事。这将导致更少的重新分配。
*   您将手动控制缓冲区，这样您就可以确保在您不希望发生这种情况时不会将整个字符串复制到新的缓冲区中。
*   您可以将堆栈用于缓冲​​区，而不是更有效的堆。
*   string + 运算符将创建一个新的字符串对象并将其返回，因此使用新的缓冲区。

**实施注意事项：**

*   跟踪字符串长度。
*   保留指向字符串结尾和开头的指针，或者只是开头并使用开头 + 长度作为偏移量来查找字符串的结尾。
*   确保您存储字符串的缓冲区足够大，因此您不需要重新分配数据
*   使用 strcpy 而不是 strcat，这样您就不需要遍历字符串的长度来查找字符串的结尾。

**绳子数据结构：**

如果您需要真正快速的连接，请考虑使用[绳索数据结构](http://www.brianbondy.com/blog/id/90/introducing-the-rope-data-structure)。

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2009-03-04T16:29:49.967

之前保留最后的空间，然后使用带有缓冲区的 append 方法。例如，假设您希望最终的字符串长度为 100 万个字符：

```
std::string s;
s.reserve(1000000);

while (whatever)
{
  s.append(buf,len);
} 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-04T16:22:30.733

我不会担心的。如果您在循环中执行此操作，字符串将始终预先分配内存以最小化重新分配 - 只需`operator+=`在这种情况下使用。如果你手动做，像这样或更长

```
a + " : " + c 
```

然后它正在创建临时文件——即使编译器可以消除一些返回值副本。这是因为在连续调用`operator+`中，它不知道引用参数是引用命名对象还是从子`operator+`调用返回的临时对象。在没有先进行分析之前，我宁愿不担心它。但是，让我们举一个例子来说明这一点。我们首先引入括号以使绑定清晰。为了清楚起见，我将参数直接放在函数声明之后。在此之下，我展示了结果表达式是什么：

```
((a + " : ") + c) 
calls string operator+(string const&, char const*)(a, " : ")
  => (tmp1 + c) 
```

现在，除此之外，`tmp1`第一次调用 operator+ 时返回的是显示的参数。我们假设编译器非常聪明并且优化了返回值副本。所以我们最终得到一个包含`a`and连接的新字符串`" : "`。现在，这发生了：

```
(tmp1 + c)
calls string operator+(string const&, string const&)(tmp1, c)
  => tmp2 == <end result> 
```

将其与以下内容进行比较：

```
std::string f = "hello";
(f + c)
calls string operator+(string const&, string const&)(f, c)
  => tmp1 == <end result> 
```

它对临时字符串和命名字符串使用相同的函数！因此编译器*必须*将参数复制到一个新字符串中并附加到该字符串并从`operator+`. 它不能占用临时内存并附加到该内存。表达式越大，必须完成的字符串副本就越多。

下一个 Visual Studio 和 GCC 将支持 c++1x 的*移动语义*（补充*复制语义*）和右值引用作为实验性添加。这允许确定参数是否引用临时参数。这将使这样的添加速度惊人地快，因为以上所有内容都将在一个没有副本的“添加管道”中结束。

如果事实证明这是一个瓶颈，你仍然可以这样做

```
 std::string(a).append(" : ").append(c) ... 
```

调用将`append`参数附加到`*this`，然后返回对自身的引用。所以没有复制临时文件。或者，`operator+=`可以使用，但您需要丑陋的括号来修复优先级。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-04T16:15:18.613

对于大多数应用程序来说，这无关紧要。只需编写代码，完全不知道 + 运算符的工作原理，只有当它成为明显的瓶颈时，才将事情掌握在自己手中。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-05-22T16:31:38.647

`std::string` `operator+`分配一个新字符串并每次复制两个操作数字符串。重复很多次，它变得昂贵，O(n)。

`std::string` `append`另一方面，`operator+=`每当字符串需要增长时，将容量提高 50%。这显着减少了内存分配和复制操作的数量，O(log n)。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-03-04T16:23:33.447

与 .NET System.Strings 不同，C++ 的 std::strings*是*可变的，因此可以通过简单的连接来构建，就像通过其他方法一样快。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-03-04T16:16:28.690

也许是 std::stringstream ？

但我同意这样的观点，即您可能应该保持它的可维护性和可理解性，然后进行分析以查看您是否真的遇到问题。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-04T17:04:00.807

在*Imperfect C++*中，Matthew Wilson 提出了一个*动态*字符串连接器，它预先计算最终字符串的长度，以便在连接所有部分之前只有一个分配。*我们还可以通过使用表达式模板*来实现静态连接器。

这种想法已在 STLport std::string 实现中实现——由于这种精确的黑客攻击，它不符合标准。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-04T16:20:05.967

对于小字符串来说没关系。如果您有大字符串，最好将它们存储在向量中或作为部分存储在其他集合中。并添加您的算法以使用此类数据集而不是一个大字符串。

我更喜欢 std::ostringstream 进行复杂的连接。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-04T16:22:13.090

与大多数事情一样，不做比做更容易。

如果您想将大字符串输出到 GUI，那么无论您输出到什么，都可能比大字符串更好地处理字符串（例如，在文本编辑器中连接文本 - 通常它们将行分开结构）。

如果要输出到文件，请流式传输数据，而不是创建一个大字符串并输出它。

如果我从慢代码中删除了不必要的串联，我从来没有发现需要使串联更快。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-01-27T16:59:13.807

如果您在结果字符串中预先分配（保留）空间，则可能是最佳性能。

```
template<typename... Args>
std::string concat(Args const&... args)
{
    size_t len = 0;
    for (auto s : {args...})  len += strlen(s);

    std::string result;
    result.reserve(len);    // <--- preallocate result
    for (auto s : {args...})  result += s;
    return result;
} 
```

用法：

```
std::string merged = concat("This ", "is ", "a ", "test!"); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-06-01T19:59:53.197

一个简单的字符数组，封装在一个跟踪数组大小和分配字节数的类中是最快的。

诀窍是在开始时只进行一次大分配。

在

[https://github.com/pedro-vicente/table-string](https://github.com/pedro-vicente/table-string)

# 基准

对于 Visual Studio 2015，x86 调试版本，对 C++ std::string 进行了实质性改进。

```
| API                   | Seconds           
| ----------------------|----| 
| SDS                   | 19 |  
| std::string           | 11 |  
| std::string (reserve) | 9  |  
| table_str_t           | 1  | 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-01-30T15:45:19.687

您可以尝试为每个项目保留内存：

```
namespace {
template<class C>
constexpr auto size(const C& c) -> decltype(c.size()) {
  return static_cast<std::size_t>(c.size());
}

constexpr std::size_t size(const char* string) {
  std::size_t size = 0;
  while (*(string + size) != '\0') {
    ++size;
  }
  return size;
}

template<class T, std::size_t N>
constexpr std::size_t size(const T (&)[N]) noexcept {
  return N;
}
}

template<typename... Args>
std::string concatStrings(Args&&... args) {
  auto s = (size(args) + ...);
  std::string result;
  result.reserve(s);
  return (result.append(std::forward<Args>(args)), ...);
} 
```

# sql-server - SSIS dtexec 什么时候路径名中有空格

> ID：611265
> 
> 赞同：1
> 
> 时间：2009-03-04T16:11:32.460
> 
> 标签：sql-server, ssis

我正在尝试使用 dtexec 运行 SSIS 包

我的包部署到路径名中有空格的文件夹

这导致 dtexec 吐出假人。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T16:12:41.913

尝试将文件路径放在双引号中。

# grails - o.errors.allErrors.each { println it } 保存域对象失败时默认

> ID：611282
> 
> 赞同：5
> 
> 时间：2009-03-04T16:14:25.997
> 
> 标签：grails, groovy, metaprogramming, grails-orm

当使用 Grails/GORM 持久化域对象时，我经常发现自己想知道为什么 save() 调用会失败。

这可以通过添加逻辑轻松解决：

```
if (!o.save()) {
    o.errors.allErrors.each { println it }
} 
```

但是，在我执行 .save() 的任何地方添加它都会添加很多重复的代码。本着 DRY 的精神，我想将 Grails/GORM 配置为自动将任何保存错误打印到控制台（stderr）。那可能吗？如果没有，我如何扩展 GORM 以使其成为可能？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-04T23:52:27.017

解决方案：

```
Object.metaClass.s = {
    def o = delegate.save()
    if (!o) {
        delegate.errors.allErrors.each {
            println it
        }
    }
    o
} 
```

这将添加一个名为 s() 的方法，该方法将调用 save() 并打印任何错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T19:37:17.350

这不是最干净的外观，可能有*更好*、更*规范*的方法来做到这一点。基于查看[here，](http://groovy.codehaus.org/ExpandoMetaClass+-+Methods)我将这段代码放在一起，您可以扩展和使用它：

```
class Book {
   void printTitle(){ println "The Title" }
}

Book.metaClass.customPrintTitle << {-> 
    println "changin ur class"
    printTitle()
}

def b = new Book()

b.customPrintTitle() 
```

# gwt - SmartGWT 实时网格（使用 iBATIS）

> ID：611289
> 
> 赞同：0
> 
> 时间：2009-03-04T16:15:36.257
> 
> 标签：gwt, ibatis, smartclient

我没有找到任何关于如何在 Live Grid 中转换 SmartGWT ListGrid 的文档。我该怎么做？默认情况下，ListGrid 是实时网格吗？如果是这样，我该如何禁用此功能？

最后：我必须为 Grid 提供一个 DataSource。我的应用程序在服务器端使用 iBATIS，使用 GWT-RPC。如何向 Live Grid 提供数据并让它管理要获取的数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T20:19:06.667

您不必更改 ListGrid 上的任何内容，绑定到 ListGrid 的 DataSource 必须发送 startrow 和 endrow 参数，然后您的后端必须返回适当的数据。您可以查看参数是否在 firebug 中发送，如果未发送，只需在 DataSource 上调用 setSendMetaData(true)

我对 iBatis 没有任何了解，所以我无法回答这部分问题

# django - 如何获取 './manage.py syncdb' 以创建其他视图或运行自定义 SQL？

> ID：611292
> 
> 赞同：6
> 
> 时间：2009-03-04T16:16:41.293
> 
> 标签：django, django-models, django-syncdb

有没有办法在 syncdb 为模型创建表之后运行一些自定义 SQL 语句？具体来说，我想创建一些数据库视图。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-04T16:20:30.380

是的，您可以在同步数据库之后捕捉到一些信号。

请参阅文档的[管理信号](http://docs.djangoproject.com/en/dev/ref/signals/#management-signals)。

这就是 contrib.auth 权限表以及 contenttypes 框架表的填充方式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T17:13:42.030

注意：正如评论中提到的，从 Django 1.7 开始不推荐使用此方法。

或者只是创建一个名为 sql/<modelname>.sql 的文件：http: [//docs.djangoproject.com/en/dev/howto/initial-data/#providing-initial-sql-data](http://docs.djangoproject.com/en/dev/howto/initial-data/#providing-initial-sql-data)

# c# - 什么是页面__EVENTARGUMENT？

> ID：611295
> 
> 赞同：13
> 
> 时间：2009-03-04T16:17:47.220
> 
> 标签：c#, .net, asp.net, vb.net, ajax.net

我看到这样的代码：

```
if (this.Request["__EVENTARGUMENT"] == "Flag")
   //DoSomthing... 
```

是什么`__EVENTARGUMENT`意思，是否有一些类似的参数可以访问？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-04T16:22:43.933

它可以通过调用`__doPostBack`页面上的 JavaScript 来设置。

[这篇文章](http://aspalliance.com/articleViewer.aspx?aId=895&pId=-1)更详细地解释了它。

# java - 用Java重写C代码还是使用JNI？

> ID：611296
> 
> 赞同：18
> 
> 时间：2009-03-04T16:17:50.653
> 
> 标签：java, java-native-interface

我目前正在开发一个用 Java 编写的项目。我们有一堆用 C/C++ 编写的算法（至少有几百个）需要合并到我们的项目中。我们的两个选择是使用 JNI 调用这段代码，或者用 Java 重写所有算法。

我知道使用 JNI 的后果，它会引发一系列全新的问题，这就是为什么甚至考虑用 Java 重写所有代码的原因。但是重写它的想法似乎......错误。据我所知，这些算法已经过测试并且可以正常工作，它们只是使用了错误的语言。

在这种情况下，JNI 会让这项任务变得简单吗？还是会比用 Java 重写代码更让人头疼？

* * *

**编辑#1：** 相关问题 - [JNI 的有用性](https://stackoverflow.com/questions/402408/usefulness-of-jni)

* * *

**编辑#2：** 仅供参考 - 我们的 Java 项目并不意味着以任何方式可移植。这可能会消除 JNI 的缺点之一，因为它可能会降低可移植性。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-04T18:51:15.400

简单的答案是，如果代码将被大量调用并且性能很重要，那么将其转换为 Java。

更复杂的答案是：

*   如果库很容易包装在 JNI 中，那么使用 JNI
*   如果您对 C/C++ 代码的测试很容易转换为 Java，那么就去移植

我会做以下事情：

*   采用其中一种算法并将其包装在 JNI 中
*   采用相同的算法并将其转换为 Java
*   看看哪个更痛苦
*   如果速度很重要，那么分析两个版本并查看它们中的哪一个是可以接受的。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-04T16:22:52.887

我认为答案在于调用 java 代码和调用的 C/C++ 代码之间的耦合量以及重写所需的工作量。如果您的 C 代码需要几个整数，进行一些繁琐的计算，然后返回另一个 int。使用 JNI。如果有很多复杂的来回，但算法相当简单，请重写它们。故障线是 JNI 连接。如果这会很复杂，那么您最终可能会编写更多的 JNI 接口代码而不是用于重写的算法代码。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-04T16:22:03.543

如果“算法”封装得很好，也许可以通过 JNI 创建一些自动粘合代码？这将降低出错的风险（手动创建数百个单独的组件听起来很冒险），并使成本与要添加的算法数量或多或少无关。

重写数百个组件听起来很冒险，我绝对建议至少先更仔细地研究 JNI。

算法对项目的其余部分有什么 I/O 要求？如果它们是相当松散耦合的，也许可以将它们作为独立的独立程序运行，作为 Java 的子进程调用并使用例如 stdio 来共享数据？

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-04T22:36:25.033

我想您会发现使用 JNI 并不像在深入研究之前那样令人生畏。有一些重要的权衡和限制，但总的来说，JNI 运行良好，并且相当容易按照您的意图使用。

正如其他人所说，JNI 的最佳案例是：

*   复杂的本机代码（如果该代码已被证明非常可靠，则加分）
*   Java 和本机代码之间的来回最小化（您希望最小化跨 JNI 层的行程）
*   对本机代码的相当简单的调用接口（或者如果您是本机代码需要利用 Java 对象/方法，也可以返回 Java）

对于一组结构合理的本地组件，自动化或伪自动化创建 JNI 层绝对是可能的。如果要包装的组件数量很大，那将是非常值得的。

JNI 的好消息是您应该可以直接构建和测试此接口，例如，您应该能够从 Java 编写利用现有算法行为的测试用例，如果存在问题，它们很可能出现在 JNI层本身而不是算法（鉴于您对本机实现的信心）。

用 Java 重写大量 C/C++ 算法对我来说似乎比使用 JNI 风险更大。当然，如果不知道细节就很难衡量，但我可以想象影响算法实际实现的技术之间存在细微的差异，更不用说纯粹的工程工作和出错的风险了。

最后一个考虑因素是这些算法或相关组件的未来寿命。这组算法或多或少是完整的，还是您继续添加？无论哪种方式，是否有强有力的维护和/或未来发展的理由来支持一种技术而不是另一种？例如，如果其他一切都在 Java 中，所有新算法都将在 Java 中，并且团队中的几乎每个人几乎总是在 Java 中编码，那么从长远来看，用 Java 重新实现开始看起来更具吸引力。

然而，即使这样说，工作胜过一致。对于大量运行良好的原生组件，即使您要长期过渡到 Java，我仍然倾向于从 JNI 开始。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-04T16:23:29.640

我仍然会认真考虑使用 JNI，特别是如果您能够最大限度地减少跨语言接口的数量。

例如，如果有一整套 C 函数都具有相同的输入和输出，但只是对输入执行不同的工作，则将其包装在单个 JNI 包装器中，并使用附加参数指定要使用的特定算法。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-04T16:23:48.407

如果您打算用 Java 编写未来的项目，而不是 C/C++。我现在会咬紧牙关，将代码移植到java。你等待的时间越长，它就会变得越糟。在这种情况下，JNI 听起来很有吸引力，但是当其他人都在有趣的新 Java 项目上时，您将遇到必须有人维护 C++ 代码的问题。

如果这是一个一次性的 Java 项目，那么你为什么要用 Java 编写它？

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-04T19:09:20.053

C 和 Java 之间的桥梁很昂贵，因此如果您必须来回传递大量数据，那么调用 C 而不是 JNI 是没有好处的。

我已经看到 JNA 被列为 JNI 的合理替代方案，以类似反射的方式从 Java 调用 DLL/共享库中的方法要少得多。我还没有尝试过。

您可能需要考虑将 C 代码编译为可以用 Java 解释的 Linux MIPS 二进制文件。相当快，有点难以正确设置。见[http://nestedvm.ibex.org/](http://nestedvm.ibex.org/)

您也可以使用 llvm 后端到 gcc 来编译为低级字节码，然后可以在 Java 中进行解释。这也是 Mac OS X 上的 iPhone SDK afaik 采用的方法。 [http://llvm.org/](http://llvm.org/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-04T17:51:47.540

阅读 Joel 关于“[偿还您的技术债务](http://www.codinghorror.com/blog/archives/001230.html)”的回执，然后立即转换它，而不是在未来几年支付利息然后还清。

也许重新打包的库也可以在更多地方使用。如果它们有用且复杂到足以让您考虑将它们保留在 C 中，那么一旦很好地封装在可重用、易于分发和易于理解的类中，它们一定会有更多用途。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-21T01:50:58.227

我一直处于这种情况。我建议您习惯使用 Java 中可用的多线程数据结构。此时，您将不想再回到您的 C++ 数据结构。

您还将意识到，您可以使用更周到的技术、更好的多态性、适配器模式等更好地重写这些算法。

当您坐在 C/C++ 代码中时，您会想着要坚持下去。您正在考虑您投入的所有爱。几年后，您会意识到，坚持使用它并使用 JNI，您已经创建了一个怪物。每次您遇到进程崩溃时，您都会后悔使用 JNI。修复进程崩溃后，有人会想要修改 C++ 中的算法，而您会想要限制他们。他们会有一个方便的借口，比如“我还不习惯 Java”。

看看 Java 中的不可变数据结构。甚至不要考虑这些旧的 C/C++ 算法的执行速度。我发现我的新代码远远超过了我的任何旧 C/C++ 代码。

编写单元测试。使用 NetBeans。

亲切的问候，

-斯托什

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-04T16:23:33.727

试试 JNI。然后，如果遇到任何问题，您可以重写有问题的问题或使用 Web 服务包装 JNI 调用并将它们部署在不同的盒子或虚拟盒子上。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-04T17:13:47.040

如果这仅适用于 Windows，并且它们已经在 DLL 中，那么可能会使用[JNA 。](https://github.com/twall/jna/#getting_started)（如果通过 JNA 调用函数的性能还不错）

# .net - 如何创建一个没有边框的WPF窗口，只能通过手柄调整大小？

> ID：611298
> 
> 赞同：99
> 
> 时间：2009-03-04T16:17:53.320
> 
> 标签：.net, wpf, window, controltemplate, resizegrip

如果您`ResizeMode="CanResizeWithGrip"`在 WPF 上进行设置，`Window`则右下角会显示调整大小的夹点，如下所示：

![](https://i.stack.imgur.com/kwmCH.png)

如果您也设置`WindowStyle="None"`了，标题栏会消失，但灰色斜边仍然存在，直到您设置`ResizeMode="NoResize"`. 不幸的是，在设置了这种属性组合后，调整大小的夹点也消失了。

我已经通过自定义覆盖了`Window`'s 。我想自己指定窗口的边框，并且我不需要用户能够从所有四个侧面调整窗口的大小，但我确实需要调整大小的手柄。`ControlTemplate``Style`

有人可以详细说明满足所有这些标准的简单方法吗？

1.  **除了**我`Window`在`ControlTemplate`.
2.  **在**右下角有一个有效的调整大小手柄。
3.  **没有**标题栏。

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2009-03-04T16:21:07.947

如果您在`AllowsTransparency`上设置属性`Window`（即使没有设置任何透明度值），边框也会消失，您只能通过夹点调整大小。

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Width="640" Height="480" 
    WindowStyle="None"
    AllowsTransparency="True"
    ResizeMode="CanResizeWithGrip">

    <!-- Content -->

</Window> 
```

结果如下：

> ![](https://i.stack.imgur.com/5qP3U.png)

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2016-03-28T08:50:19.327

我试图创建一个无边框窗口， `WindowStyle="None"`但是当我测试它时，顶部似乎出现了一个白条，经过一些研究，它似乎是“调整边框大小”，这是一张图片（我用黄色标记）：

![挑战](https://i.stack.imgur.com/3hM09.png)

经过互联网的一些研究，以及许多困难的非 xaml 解决方案，我发现的所有解决方案都是 C# 中的代码和大量代码行，我在这里间接找到了解决方案：[Maximum custom window lost drop shadow effect](https://stackoverflow.com/questions/7369115/maximum-custom-window-loses-drop-shadow-effect#)

```
<WindowChrome.WindowChrome>
    <WindowChrome 
        CaptionHeight="0"
        ResizeBorderThickness="5" />
</WindowChrome.WindowChrome> 
```

**注意** *：您需要使用 .NET 4.5 框架，或者如果您使用的是旧版本，请使用 WPFShell，只需引用 shell 并`Shell:WindowChrome.WindowChrome`改用即可。*

我使用了`WindowChrome`Window 的属性，如果你使用它，白色的“调整边框”就会消失，但你需要定义一些属性才能正常工作。

**CaptionHeight：**这是标题区域（标题栏）的高度，允许像普通标题栏一样进行 Aero 捕捉、双击行为。将此设置为 0（零）以使按钮工作。

**ResizeBorderThickness：**这是窗口边缘的厚度，您可以在此处调整窗口大小。我放 5 是因为我喜欢这个数字，而且如果你放 0 就很难调整窗口的大小。

使用此短代码后，结果如下：

![解决方案](https://i.stack.imgur.com/3Etie.png)

`ResizeMode="NoResize"`现在，白色边框在没有使用and的情况下消失了`AllowsTransparency="True"`，并且在窗口中显示了阴影。

稍后我将解释如何使用简单而简短的代码轻松地制作按钮（我没有使用图像作为按钮），我是新手，我认为我可以发布到 codeproject，因为在这里我没有找到这个地方发布教程。

也许还有另一种解决方案（我知道对于像我这样的菜鸟来说有困难和困难的解决方案）但这适用于我的个人项目。

这是完整的代码

```
<Window x:Class="MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:Concursos"
    mc:Ignorable="d"
    Title="Concuros" Height="350" Width="525"
    WindowStyle="None"
    WindowState="Normal" 
    ResizeMode="CanResize"
    >
<WindowChrome.WindowChrome>
    <WindowChrome 
        CaptionHeight="0"
        ResizeBorderThickness="5" />
</WindowChrome.WindowChrome>

    <Grid>

    <Rectangle Fill="#D53736" HorizontalAlignment="Stretch" Height="35" VerticalAlignment="Top" PreviewMouseDown="Rectangle_PreviewMouseDown" />
    <Button x:Name="Btnclose" Content="r" HorizontalAlignment="Right" VerticalAlignment="Top" Width="35" Height="35" Style="{StaticResource TempBTNclose}"/>
    <Button x:Name="Btnmax" Content="2" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,0,35,0" Width="35" Height="35" Style="{StaticResource TempBTNclose}"/>
    <Button x:Name="Btnmin" Content="0" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,0,70,0" Width="35" Height="35" Style="{StaticResource TempBTNclose}"/>

</Grid> 
```

谢谢！

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2014-08-02T12:25:55.050

虽然公认的答案非常正确，但只想指出 AllowTransparency 有一些缺点。它不允许显示子窗口控件，即 WebBrowser，并且它通常会强制软件渲染，这可能会对性能产生负面影响。

不过有更好的解决方法。

当您想要创建一个没有边框且可调整大小并且能够承载 WebBrowser 控件或指向您根本无法访问的 URL 的 Frame 控件的窗口时，所述控件的内容将显示为空。

不过，我找到了解决方法；在窗口中，如果将 WindowStyle 设置为 None，将 ResizeMode 设置为 NoResize（请耐心等待，一旦完成，您仍然可以调整大小）然后确保您有 UNCHECKED AllowsTransparency 您将有一个没有边框的静态大小的窗口并显示浏览器控件。

现在，您可能仍然希望能够调整大小，对吧？好吧，我们可以通过互操作调用来做到这一点：

```
 [DllImport("user32.dll", CharSet = CharSet.Auto)]
    private static extern IntPtr SendMessage(IntPtr hWnd, uint Msg, IntPtr wParam, IntPtr lParam);

    [DllImportAttribute("user32.dll")]
    public static extern bool ReleaseCapture();

    //Attach this to the MouseDown event of your drag control to move the window in place of the title bar
    private void WindowDrag(object sender, MouseButtonEventArgs e) // MouseDown
    {
        ReleaseCapture();
        SendMessage(new WindowInteropHelper(this).Handle,
            0xA1, (IntPtr)0x2, (IntPtr)0);
    }

    //Attach this to the PreviewMousLeftButtonDown event of the grip control in the lower right corner of the form to resize the window
    private void WindowResize(object sender, MouseButtonEventArgs e) //PreviewMousLeftButtonDown
    {
        HwndSource hwndSource = PresentationSource.FromVisual((Visual)sender) as HwndSource;
        SendMessage(hwndSource.Handle, 0x112, (IntPtr)61448, IntPtr.Zero);
    } 
```

瞧，一个没有边框的 WPF 窗口，仍然可以移动和调整大小，而不会失去与 WebBrowser 等控件的兼容性

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-11-26T14:02:58.457

样品在这里：

```
<Style TargetType="Window" x:Key="DialogWindow">
        <Setter Property="AllowsTransparency" Value="True"/>
        <Setter Property="WindowStyle" Value="None"/>
        <Setter Property="ResizeMode" Value="CanResizeWithGrip"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Window}">
                    <Border BorderBrush="Black" BorderThickness="3" CornerRadius="10" Height="{TemplateBinding Height}"
                            Width="{TemplateBinding Width}" Background="Gray">
                        <DockPanel>
                            <Grid DockPanel.Dock="Top">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition Width="50"/>
                                </Grid.ColumnDefinitions>
                                <Label Height="35" Grid.ColumnSpan="2"
                                       x:Name="PART_WindowHeader"                                            
                                       HorizontalAlignment="Stretch" 
                                       VerticalAlignment="Stretch"/>
                                <Button Width="15" Height="15" Content="x" Grid.Column="1" x:Name="PART_CloseButton"/>
                            </Grid>
                            <Border HorizontalAlignment="Stretch" VerticalAlignment="Stretch" 
                                        Background="LightBlue" CornerRadius="0,0,10,10" 
                                        Grid.ColumnSpan="2"
                                        Grid.RowSpan="2">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="20"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="20"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <ResizeGrip Width="10" Height="10" Grid.Column="1" VerticalAlignment="Bottom" Grid.Row="1"/>
                                </Grid>
                            </Border>
                        </DockPanel>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-03-09T15:42:25.897

我很难得到@fernando-aguirre`WindowChrome`用来工作的答案。在我的情况下它不起作用，因为我正在覆盖`OnSourceInitialized`而`MainWindow`不是调用基类方法。

```
protected override void OnSourceInitialized(EventArgs e)
{
    ViewModel.Initialize(this);
    base.OnSourceInitialized(e); // <== Need to call this!
} 
```

这让我难过了很长时间。

# winapi - 使用 CreateIconIndirect 的自定义光标有什么限制吗？

> ID：611301
> 
> 赞同：0
> 
> 时间：2009-03-04T16:19:52.800
> 
> 标签：winapi

我的 Windows 应用程序使用 WIN API`CreateIconIndirect()`函数在运行时创建自定义光标。光标的大小是动态的，有时可能比平均值大得多（图标宽于 300 像素）。

通过远程桌面（和其他类似的第 3 方产品）使用应用程序时，这似乎会导致问题。

可以在 Windows 应用程序中使用的光标图标的大小是否存在某种实际限制（真实的或感知的）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T18:20:43.407

GetSystemMetrics(SM_CXCURSOR) 和 GetSystemMetrics(SM_CYCURSOR) 告诉你最大尺寸

# function - 一个函数/过程/方法应该有多少行代码？

> ID：611304
> 
> 赞同：54
> 
> 时间：2009-03-04T16:20:12.363
> 
> 标签：function, coding-style, refactoring, code-metrics

> **可能重复：**
> [什么时候函数太长？](https://stackoverflow.com/questions/475675/when-is-a-function-too-long)

我最近接到了一项令人羡慕的任务，即审查另一位开发人员编写的糟糕代码并记录不良做法。（当然，这一切都是为了摆脱为开发人员的工作付出的代价，而不是任何利他的理由！）

审查过的代码有几个程序是多行代码 - 最长的将近 600 行。我想到的几个问题是可维护性和可读性。

诀窍是我需要向外行证明为什么这是一种不好的做法，并且如果可能的话，用一本备受推崇的最新参考书来支持它。类比也很好。

有任何想法吗？

**重复：** [什么时候函数太长？](https://stackoverflow.com/questions/475675/when-is-a-function-too-long)
**重复：** [最大函数大小的最佳规则？](https://stackoverflow.com/questions/129599/best-rule-for-maximum-function-size/129647#129647)

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2009-03-04T16:23:36.363

这与代码行无关。正如[史蒂夫·麦康奈尔](http://cc2e.com/)和[鲍勃·马丁](https://rads.stackoverflow.com/amzn/click/com/0132350882)所说（关于编码最佳实践的两个很好的参考资料），一种方法应该做一件事，而且只做一件事。然而，做这件事需要多少行代码，它应该有多少行。如果那个“一件事”可以分解成更小的东西，那么每一个都应该有一个方法。

很好的线索你的方法做的不止一件事：

*   一个方法中的多个缩进级别（表示太多的逻辑分支只做一件事）
*   “段落中断” - 逻辑代码组之间的空白表示该方法正在做不止一件事

仅举几个。Bob Martin 还说要保持在 10 左右。就我个人而言，我通常会尝试为 10 投篮。如果它开始接近 20，那就是一个精神信号，需要更加关注这种方法。但归根结底，代码行数对于几乎任何事情都是一个糟糕的衡量标准。它只是一个有用的指标，可以潜在地指向真正的问题。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-04T16:30:45.817

## 真正的答案

没有具体数字。

## 一个具体的答案

如果您必须向律师或其他人证明一些数字的合理性，请找出适合您商店的典型开发编辑器窗口的最大行数，然后使用它。

## 一般实践

你甚至不应该那样看待它，但任何一个函数都应该没有什么非常复杂的事情发生。

每个工作单元都应该委托给它自己的单元测试的描述性命名方法。 *这样做，您的所有方法最终都会变得很小且可读，而无需计算行数......*

我看到的最大违规者是在 if 语句中间爆炸的 3-4+ 布尔条件。用一个好名字将所有这些包裹在一个布尔值中，然后将任何组成它的部分包裹起来，这些部分本身就很复杂。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-04T16:31:25.877

首先，请注意长度限制与通常的度量标准是完全分开的，即“函数是否只做一件事，并且做得很好？” 如果该问题的答案不是肯定的，那么无论长度如何，该功能都可能不是一个好的功能。

与最大长度特别相关，来自 Code Complete 的引用，通常被认为是关于编码实践主题的最佳书籍之一：

> 有时，复杂的算法会导致更长的例程，在这种情况下，应该允许例程有机地增长到 100-200 行。（一行是源代码的非注释、非空白行。）数十年的证据表明，这种长度的例程并不比较短的例程更容易出错。让嵌套深度、变量数量和其他与复杂性相关的考虑因素决定例程的长度，而不是强加长度限制本身。
> 
> 如果您想编写超过 200 行的例程，请小心。没有一项研究报告降低了成本、降低了错误率，或者两者兼而有之，较大的例程可以区分大小超过 200 行的代码，并且当您传递 200 行代码时，您必然会遇到可理解性的上限。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-04T16:25:39.697

尽可能少。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-04T16:24:11.900

为了补充 Rex 的观点，它也应该尽可能短。鲍勃·马丁说 10 或更少

[Object Mentor - 一个函数应该有多大？](https://web.archive.org/web/20120413071103/http://blog.objectmentor.com/articles/2007/10/29/how-big-should-a-function-be)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-04T16:25:43.707

自从我读到这篇文章已经很多年了，但我认为在*学习 Perl*中，他们建议制作一个程序，而不是你可以一次在屏幕上显示整个内容。我认为这是一个很好的衡量标准。我见过由于重复代码（例如数据库访问和分配属性值）而仍然可读的较长函数，但这些是例外而不是常态。

# php - IIS 上用于 PHP 的 GZip

> ID：611307
> 
> 赞同：1
> 
> 时间：2009-03-04T16:20:37.057
> 
> 标签：php, iis, gzip

如果在 IIS 中启用了 GZip，它只会提高 ASP 页面的性能还是可以设置为压缩 PHP 页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T16:30:45.363

PHP 还内置了对 gzip 压缩的支持。您可以通过调用来初始化它

```
ob_start("ob_gzhandler"); 
```

或者通过激活 php.ini 中的 zlib.output_compression 指令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T16:23:23.603

是的，gzip 只是压缩提供给浏览器的内容，即 html 和图像。

# ms-word - QTextEditor 在 QT Ruby 中返回引号作为问号

> ID：611321
> 
> 赞同：1
> 
> 时间：2009-03-04T16:23:34.243
> 
> 标签：ms-word, text-editor, copy-paste, quotes, qtruby

当我从 Word 文档复制并粘贴到 QT`TextEditor`时，它看起来不错。但是当我尝试使用`toPlainText`or访问文本时`toHTML`，它会返回带有所有引号（双引号和单引号）作为问号的文本。有没有解决的办法？我正在使用 qt4-qtruby 绑定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T16:39:46.653

这是因为 Word 中使用的引号实际上并不是 ASCII 引号字符——它们是某种时髦的 unicode 字符，看起来像引号。

对于 HTML，如果您使用 UTF-8 编码，它应该可以正常工作。对于纯文本，尽管您非常不走运。

这是一个[不错的页面，其中包含更多信息](http://www.cl.cam.ac.uk/~mgk25/ucs/quotes.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T16:31:30.760

我假设您使用的是 QTextEdit。我认为问题与编码有关。尝试将 word 文档保存为纯文本并尝试相同的操作。如果与 word 互操作很重要，我认为您将必须弄清楚如何更改复制粘贴的编码。

**编辑**
请发布您最终使用的任何解决方案。我很感兴趣。

我也是 QT 的新手，这只是我的看法。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T16:47:25.947

当您调用`toPlainText()`它时，它会返回一个`QString`. `QString`是内部 unicode，所以只要数据在`QString`它应该是可以的。如果您从`QString`使用中获取数据，`toAscii()`那么这就是发生错误转换的地方。
如果这个理论是正确的，`toUtf8()`请`toAscii()`在`QString`.

# c++ - 你能从 Ada 调用 C++ 函数吗？

> ID：611323
> 
> 赞同：4
> 
> 时间：2009-03-04T16:23:45.863
> 
> 标签：c++, ada

你能从 Ada 调用 C++ 函数吗？

我想知道是否有一种方法可以直接执行此操作，而无需在 C 中进行实现并编写 C++ 包装器 & 和 Ada 包装器，例如，我想使用 c++ -> Ada 而不是 c++ -> c -> Ada。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T22:59:53.133

我能给你的唯一真正与编译器无关的答案是，它就像在你的系统上从 C 调用 C++ 一样可能。

与 C 非常相似，您必须找出 C++ 例程的名称错位符号，并在 C（在本例中为 Ada）端编写一个绑定到该错位名称的绑定。您可能还必须在 C++ 方面做一些事情，例如声明 C++ 函数 extern。

如果你可以声明你的 C++ 函数 extern "C"，那就很简单了。只需在 C++ 端执行此操作，并在 Ada 端使用 Ada 的标准 C 导入功能。

例子：

在你的 cpp 中：

```
extern "C" int cpp_func (int p1, int p2) {
   ; // Whatever..
} 
```

在您的 .adb 中：

```
function cpp_func (p1, p2 : Interfaces.C.Int) return Interfaces.C.Int;
pragma Import (C, cpp_func); 

...
Result : constant Interfaces.C.Int := cpp_func (1, 2); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T17:44:49.570

Ada 到 C++ 的问题是 C++ 没有定义的 ABI。
每个编译器都可以定义它可以定义的最有效的 ABI。

因此，与其他语言 (Ada) 交互是一件痛苦的事情，因为您需要 Ada 编译器知道 C++ 是用哪个编译器编译的，然后才能生成正确的代码来调用任何 C++ 方法/函数。

另一方面，C ABI 是跨所有编译器的明确定义的标准，因此为任何语言连接提供了一个很好的方便接口。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-10-14T16:04:24.930

您可能对这篇论文感兴趣，它讨论了 Ada 到 C++ 的对象级绑定：

[http://www.adacore.com/uploads/technical-papers/Class_level_interfacing.pdf](http://www.adacore.com/uploads/technical-papers/Class_level_interfacing.pdf)

此外，最新版本的 GNAT 具有强大的自动绑定生成器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T16:37:50.090

这似乎不可能...

来自[这里的信息](http://coding.derkeiler.com/Archive/Ada/comp.lang.ada/2006-05/msg00223.html)

“从 Ada 到 C++ 的直接接口超出了 Ada 的范围（至少 95）”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T17:04:15.703

自 99/00 以来我没有接触过 Ada，所以我的记忆可能有点粗略，但是当我们在 Ada 中开发图形窗口应用程序时，我们需要用 C++（非关键任务）以及我们将两者结合的方式做一些事情是将 c++ 的东西放在 dll 中，然后为该 DLL 创建一个 C 包装器，然后使用指定 c 包装器的 pragma 接口，然后我们可以从该接口调用 dll 中的方法。

我认为这相当于一些三重维护，因为如果方法签名在 c++ dll 中发生更改，则必须在 pragma 接口和 C 包装器中更新它们。

基本上这是一种痛苦。我认为我们必须在 C 包装器中使用 Win32 Lean and Mean 预编译器指令。

无论如何，这是我们三个参与该项目的人都记得的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T17:14:23.840

痛饮也许能做到

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T16:46:05.170

Green Hills Software 也就此发表了一篇很棒的 PDF。
[http://www.ghs.com/download/whitepapers/ada_c++.pdf](http://www.ghs.com/download/whitepapers/ada_c++.pdf)

# javascript - 使用 JavaScript 进行强大的键盘快捷键处理

> ID：611326
> 
> 赞同：5
> 
> 时间：2009-03-04T16:24:11.447
> 
> 标签：javascript, prototypejs

使用 JavaScript 为 Web 应用程序创建全局键盘快捷键处理程序的最可靠方法是什么，即我应该处理哪些事件以及事件处理程序应该附加到什么？

我想要类似于 Gmail 中的系统，它既可以处理单个按键快捷方式，也可以处理带有修饰键的快捷方式，例如 Ctrl + B 等。代码必须在 IE 6 和现代浏览器中工作。

我有可用的原型框架，但没有 jQuery，所以请不要使用 jQuery 特定的答案！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T16:18:45.713

只是想我会再加入一个。我最近发布了一个名为 Mousetrap 的库。[在http://craig.is/killing/mice](http://craig.is/killing/mice)上查看

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T18:05:18.287

LivePipe 控件包中提供的 HotKey 库可与 Prototype 一起使用，并且与 IE 兼容。

[http://livepipe.net/extra/hotkey](http://livepipe.net/extra/hotkey)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-06T09:25:16.277

JimmyP 将此作为评论发布，但它应该作为投票目的的答案。

[http://www.openjs.com/scripts/events/keyboard_shortcuts/](http://www.openjs.com/scripts/events/keyboard_shortcuts/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-04T17:30:28.060

我要做的是将 onKeyUp 事件附加到 document.body。然后，在这个事件处理程序中，我将使用[Element.fire](http://prototypejs.org/api/element/fire)方法来触发一个自定义事件。尽管此步骤是可选的，但它有助于将事件处理程序与要执行的操作分离，并且您可以使用与按钮单击事件相同的自定义事件处理程序。

```
$(document.body).observe("keyup", function() {
    if(/* key + modifier match */) {
        $(document.body).fire("myapp:mycoolevent");
    }
});

$(document.body).observe("myapp:mycoolevent", function() {
    // Handle event.
}); 
```

稍后，要将相同的事件绑定到按钮单击：

```
$(button).observe("click", function() {
    $(document.body).fire("myapp:mycoolevent");
}); 
```

就处理修饰键而言，请查看[此资源](http://www.webreference.com/js/column11/modifierkeys.html)（非常旧，但看起来仍然适用）以获得更多帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-10-18T10:29:36.283

还有一个名为[jwerty](https://keithamus.github.io/jwerty/)的新 JavaScript 库，它易于使用且不依赖于 jQuery。

# .net - 是什么导致 ProcessorArchitecture 锁定到 x86 或 MSIL？

> ID：611328
> 
> 赞同：2
> 
> 时间：2009-03-04T16:24:37.327
> 
> 标签：.net, labview

我有一个使用 COM 调用 LabVIEW 应用程序（构建为 .exe）的 .Net 2.0 应用程序。LabVIEW 应用程序调用我们编写的各种 .Net 程序集。

通常这一切都很好。我有一个 app.config 将 LabVIEW 应用程序重定向到正确文件的正确版本，一切都很愉快。

昨天，LabVIEW 应用程序决定在这台 PC 上找不到我的程序集。Fusion 日志错误表明它需要 x86 版本的程序集，但已经加载了 MSIL 版本。

请注意，我们使用 platform=x86 构建了有问题的程序集。另请注意，相同的构建在 5 台相同（直至硬件）的 PC 上运行良好。

所以我想，嘿，我没有理由强制执行 x86。我从构建中删除了平台规范并构建了一个 MSIL 版本的程序集。

然后 Fusion 出现了同样的错误，但它说它需要 MSIL 版本的程序集，而 x86 版本已经加载。

（我也尝试过使用corflags。）

我们没有在 GAC 中注册我们的程序集，它们都是应用程序本地的，并且在那台 PC 上没有其他程序集副本。

哦，更令人困惑的是：更新我们的数据库后，问题就消失了。它现在可以使用，与我开始使用的构建相同。

有问题的程序集根本不是我们 DB 代码的一部分，它是一个单独的类及其关联的工厂。它使用 DB 代码程序集，但不与数据库直接通信。

是什么让 .Net 中的 ProcessorArchitecture 锁定到 x86 或 MSIL？

你有没有遇到过这种情况，如果有，你做了什么来解决它？

（如果问题再次出现，我将发布确切的 Fusion 日志内容，因为问题消失了，我没有可用的日志。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T19:00:59.750

所以！事实证明，问题与数据库更新有关。有一个表需要一些未设置的静态数据。

任何人都可以告诉我为什么从数据库查询中返回空值会与加载的处理器架构混淆...

# sql-server - 数据库故障转移期间发生 SqlClient.SqlException

> ID：611331
> 
> 赞同：1
> 
> 时间：2009-03-04T16:24:59.807
> 
> 标签：sql-server, sql-server-2005, exception, failover

我在故障转移方案中设置了两个 Microsoft SQL 2005 数据库。应用程序连接字符串具有连接字符串中指定的“故障转移伙伴”。

当前活动的数据库故障转移到从数据库时，有一小段时间用户可以获得SqlClient.SqlException，并显示“现有连接被远程主机强制关闭”消息。

这主要是由于数据库故障转移的速度还是可以采取其他措施来防止这些错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T14:38:05.353

你是对的：这与数据库故障转移需要多长时间有关。

同步镜像故障转移时间线如下所示：

1.  主服务器 A 关闭并关闭所有连接。从现在开始，任何尝试连接到服务器 A 的客户端都将强制关闭其连接。
2.  主服务器 A 确保其日志与辅助服务器 B 完全同步。
3.  服务器 B 的 SQL 服务启动。
4.  服务器 B 的 SQL 服务开始接受连接，此时客户端可以再次连接。

无论您的服务器有多快，连接都会在短时间内（至少一秒钟）爆炸。就像 Steven Lowe 所说，你必须捕获那个异常，等待，然后再试一次。请记住，如果您的应用程序连续发出多个查询作为较大事务的一部分，它会更加复杂 - 您的事务可能会失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T16:31:40.213

警告：“故障转移合作伙伴”选项几年前不可用（或者至少我不知道！）因此以下解决方案可能已过时

我们必须捕获连接丢失异常（几种不同的风格），等待几秒钟，然后再试一次。这需要所有数据库操作的包装器来自动执行等待和重试逻辑——这不是很多工作，但被证明相当方便；我们努力检查错误代码和异常类型，并就我们是否可以安全地重试操作制定决策表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T16:31:31.790

这是由于您的应用程序试图使用连接池中的现有连接。只有在发生此错误后，应用程序池才会被清除，新连接才会使用故障转移框。

# mysql - 如何在 MySQL 中将自动增量格式设置为 0001？

> ID：611340
> 
> 赞同：23
> 
> 时间：2009-03-04T16:26:40.863
> 
> 标签：mysql

如何使 MySQL 以 4 位格式自动递增？

所以不是'1'而是'0001'？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-04T16:32:28.557

尝试将 ZEROFILL 属性添加到该字段。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-04T16:32:34.627

您能否将其保留为整数并在 SQL 中为人类格式化它，例如，用零填充到 4 个字符宽

```
select lpad(idcolumn,4,'0') from mytable; 
```

或者在声明表格时使用 zerofill 并指定所需的宽度：

```
create table tmpfoo (
   mykey int(6) zerofill not null auto_increment, 
   primary key(mykey)
);

insert into tmpfoo values(1),(2);

select * from tmpfoo;
+--------+
| mykey  |
+--------+
| 000001 |
| 000002 |
+--------+ 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-04T16:35:01.343

**MySQL**在整数列上支持 ZEROFILL：

```
mysql> create table foo (the_key int unsigned zerofill not null 
       auto_increment primary key);
Query OK, 0 rows affected (0.21 sec)

mysql> insert into foo SET the_key = Null;
Query OK, 1 row affected (0.00 sec)

...

mysql> insert into foo SET the_key = Null;
Query OK, 1 row affected (0.00 sec)

mysql> select * from foo;
+------------+
| the_key    |
+------------+
| 0000000001 |
| 0000000002 |
| 0000000003 |
| 0000000004 |
| 0000000005 |
| 0000000006 |
| 0000000007 |
| 0000000008 |
+------------+
8 rows in set (0.00 sec) 
```

您可能需要考虑使用 smallint（5 位数字）或修剪/填充。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-04T16:33:19.553

如果您需要零填充格式的 auto_increment 列，我建议您将其显示为这样，而不是尝试以这种方式将其存储在数据库中。

在 PHP 中，您可以使用以下代码来显示或以其他方式使用 id：

```
$padded_id = str_pad($id, 4, '0'); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-04T16:37:36.987

要填充数据库，请将 id 列设置为 ZEROFILL

但如果仅用于显示目的，我建议使用[LPAD](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_lpad) SELECT RIGHT('000000' + yourNum, 6);

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T16:29:07.303

该字段是整数吗？如果是这样，答案是，“为什么？它是一个整数！” ;-)

# ejabberd - ejabberd 节点

> ID：611342
> 
> 赞同：-1
> 
> 时间：2009-03-04T16:27:16.697
> 
> 标签：ejabberd

安装时我使用的是用户：admin ..domain:Admin-PC。我可以启动它。但它说当前节点是：'当前 ejabberd 节点的名称是 ejabberd@localhost'。我认为当前节点应该是 admin@localhost 。我也无法使用用户登录到 Web 界面：admin@Admin-PC

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-02-26T15:01:10.243

Erlang 中的节点名称（给定机器上的 ejabberd，默认 localhost）与 Unix 用户（机器上的管理员）无关。默认为 ejabberd 定义的节点名称只是一个字符串名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T17:21:45.743

默认的 ejabberd 安装使用“ejabberd”作为用户部分，使用“localhost”作为域部分。因此，如果您没有明确更改 /etc/ejabberd/ejabberdctl.cfg，ejabberd 将使用 'ejabberd@localhost' 作为节点的“短名称”。

短名称由 erlang 命令中的选项“-sname”指示。

如果你想改变它，你可以在 ejabberdctl.cfg 中编辑 ERLANG_NODE （默认配置文件在该参数之前有有用的注释）。

为了连接到 Web 管理界面，您需要：

*   注册一个管理员帐户（例如'ejabberdctl register admin mydomain adminpassword'）
*   为该虚拟主机授予该用户的管理员权限（即在 ejabberd.cfg 中，您应该具有类似的内容：{acl, admin, {user, "admin", "mydomain"}}。
*   使用用户名：admin@mydomain 和密码：adminpassword 登录到 Web 管理界面

同样，正如其他人所说，您使用的 linux 帐户与 ejabberd 节点名称或 Web 管理员凭据无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-05T14:21:24.343

ejabberdctl 默认节点名称为“localhost”。您可以通过编辑已安装的 ejabberdctl 的 NODE 变量或使用“--node $nodename”参数调用它来覆盖它。

# ado.net - Informix for .NET 的连接字符串

> ID：611345
> 
> 赞同：2
> 
> 时间：2009-03-04T16:28:21.220
> 
> 标签：ado.net, connection-string, informix

我们正在使用 Informix 数据库，并使用 ODBC 从 .NET 成功连接到它。我们使用的连接字符串是；

```
DRIVER={IBM INFORMIX ODBC RIVER};
UID=username; PWD=password;
DATABASE=our_database;
HOST=devsrv01;
SERVER=devsrv01_tcp;
SERVICE=ids9tcp2;
PROTOCOL=onsoctcp;
CLIENT_LOCALE=en_US.CP1252;
DB_LOCALE=en_US.819; 
```

我们希望从 ODBC 更改并使用 IBM 的 SDK 和库，如其[站点上所述](http://www.ibm.com/developerworks/data/library/techarticle/dm-0510durity/index.html)。

我们使用的代码是；

```
string ConnectionString = "Database=our_database; Server=172.22.0.0:1528; UID=username; Password=password; ";

try
{                               
    IfxConnection conn = new IfxConnection(ConnectionString);
    conn.Open();
}
catch (IfxException ex)
{} 
```

conn.Open() 抛出异常；

错误 [08001] [IBM] SQL30081N 检测到通信错误。正在使用的通信协议：“TCP/IP”。正在使用的通信 API：“SOCKETS”。检测到错误的位置：“172.22.0.0”。检测错误的通信功能：“recv”。协议特定错误代码：“ *”、“* ”、“0”。SQLSTATE=08001

“啊哈！” 你说。只需输入 " `PROTOCOL=onsoctcp;`" 但这会使`IfxConnection(ConnectionString);`命令抛出`ArgumentException`. 如果连接字符串包含任何无效`<field>=<value>`设置，则会引发此异常。如果我放入垃圾=垃圾；它会抛出相同的 ArgumentException，这让我认为它无法识别协议（或 PRO）字段。

（仅供参考）172.22.0.0 是 devsrv01 的 IP，并且不以 0.0 结尾。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T09:43:46.100

我最终发现答案是包括；

```
Persist Security Info=True;Authentication=Server; 
```

不要问我为什么。我只是让它工作。

为所有人 +1 - 感谢您的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T16:30:52.790

你检查了[http://www.connectionstrings.com/](http://www.connectionstrings.com/)吗？它可能会提供一些见解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T20:45:43.723

[IBM Informix .NET Povider Guide 4.10](https://www.ibm.com/support/knowledgecenter/SSGU8G_12.1.0/com.ibm.netpr.doc/netpr.htm)手册使用协议或 PRO 而不是 PROTOCOL。关键字是否区分大小写？符号表明它可能是，但我对 .NET 的了解还不够，无法确定。使用 PROTOCOL 时出现的错误表明它可能区分大小写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T02:35:27.390

假设您想使用 .NET、Informix CSDK（不是 DRDA 之一）和 ADO.NET，最简单的连接方式是使用将数据库添加到 Visual Studio 的数据连接列表（查看 -> 服务器资源管理器，然后单击“连接到数据库”按钮，然后只需填写表格（假设您安装了带有 CSDK 的 Visual Studio 扩展...））。

然后进入项目的属性，进入设置选项卡，添加一个类型为“（连接字符串）”的新设置，并将值设置为：

```
 Database=mydatabase;Password=mypassword;Server=myserver;User ID=myuser" 
```

所以在 app.config 中它看起来像这样：

```
 <add name="MyApplication.Properties.Settings.MyConnectionString"
  connectionString="Database=mydatabase;Password=mypassword;Server=myserver;User ID=myuser"
  providerName="IBM.Data.Informix" /> 
```

还要确保已在主机文件 (C:\Windows\System32\drivers\etc\hosts) 和/或使用位于开始菜单中某处的 Informix 数据库连接工具“inetd32.exe”配置数据库和服务器。 .

此外，如果您愿意，您可以将表等从服务器资源管理器窗口中的数据库拖到 Visual Studio 中打开的 XSD 文件中，让它自动将连接字符串添加到配置中并设置所有内容，为您提供类型化的数据集和它将为您处理 CRUD 层...（尽管您可能会遇到一堆错误，因为 VS 出于某种原因无法使用最新的驱动程序提取 Informix 架构...）

无论如何，您可以使用如下连接字符串：

```
IfxConnection myconnection = new IfxConnection(MyApplication.Properties.Settings.Default.MyConnectionString); 
```

# java - 来自 HttpURLConnection 的意外结果 - 读取远程二进制文件

> ID：611346
> 
> 赞同：1
> 
> 时间：2009-03-04T16:28:34.153
> 
> 标签：java, binary, httpurlconnection

我正在尝试从互联网上读取远程二进制文件（例如图像），如下所示：

```
HttpURLConnection connection = (HttpURLConnection) myUrl.openConnection(); //myUrl - URL object pointing for some location
if(connection.getResponseCode() == 200){
    File temp = File.createTempFile("blabla", fileName); //fileName - string name of file
    FileOutputStream out = new FileOutputStream(temp);
    int fileSize = Integer.parseInt(connection.getHeaderField("content-length"));
    int counter = 0;
    DataInputStream in = new DataInputStream(connection.getInputStream());
    byte ch[] = new byte[1024];
    System.out.println(counter);
    while((counter += in.read(ch)) > 0){
        out.write(ch);
        if(counter == fileSize){
            out.close();
            break;
        }
    }
} 
```

在本地或本地 Web 服务器 (localhost) 中，它可以完美运行。

但。然后 myUrl 是某个远程 Web 服务器上文件的 URL - 它返回意外结果。例如，从给定文件的来源看来，它似乎重复了一些包（我认为是因为以前的包损坏或某些包），并且由于这种重复，生成的文件通常比原始文件大 10%。因此文件已损坏，无法使用图像查看器正确打开。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T16:32:20.990

`read`不一定要读取整个缓冲区（特别是如果它位于流的末尾）。

所以改变你的循环：

```
for (;;) {
    int len = in.read(ch);
    if (len == -1) {
        break;
    }
    out.write(ch, 0, len);
} 
```

也许将该代码放在某处的方法中。

另请注意：

*   在这里使用没有意义`DataInputStream`（尽管`readFully`通常很有用）。
*   始终使用惯用语来关闭资源（例如流）：

    ```
    final Resource resource = acquire();
    try {
        use(resource);
    } finally {
        resource.close();
    } 
    ```

*   可能不会有太大区别，但是 1024 的缓冲区大小有点小。我倾向于任意默认为8192。

# sql-server - 如何在 T-SQL 中重写电话号码？

> ID：611357
> 
> 赞同：3
> 
> 时间：2009-03-04T16:30:54.707
> 
> 标签：sql-server, tsql, sql-server-2008, validation

我有一个关于 T-SQL 的初学者问题。

我们将 Excel 表格导入 SQL Server 2008。太糟糕了，这些 Excel 文件没有按照应有的方式进行格式化。我们希望电话号码看起来像这样：'012345678'，没有前导和尾随空格，内部也没有空格。更糟糕的是，有时该号码使用前缀“0123-2349823”或“0123/2349823”进行编码。

通常我会将 Excel 文件导出为[CSV](http://en.wikipedia.org/wiki/Comma-separated_values)文件，然后启动一些神奇的 Perl 脚本进行清理，然后重新导入 Excel 文件。

知道如何用 T-SQL 做这样的事情还是很有趣的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T16:46:01.940

就像是

```
replace(replace(rtrim(ltrim('0123-2349823')), '-', ''), '/', '') 
```

应该管用。看起来不漂亮。;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T16:46:56.353

我会通过更新来解决这个问题，并为 SQL 使用“替换”和 LTrim/RTrim 函数。

```
Update Table1
set phonenum = Case
        When phonenum like '%-%' Then LTrim(RTrim(Replace(phonenum, '-', '')))
            Else LTrim(RTrim(Replace(phonenum, '/', '')))
        End 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T16:43:16.613

“已清理”仅包含数值

根据电话号码是否包含“-”、“/”，将它们替换为空字符串。

```
create table #t ( tel varchar(30) )

insert  #t select '0123-2349823' 
insert  #t select '0123/2349823'

select  tel,
        replace(tel, 
            case
                when patindex('%-%', tel) > 0 then '-'
                when patindex('%/%', tel) > 0 then '/'
            end, '') as Cleaned
from    #t 
```

# web-applications - Web 可访问性 - 配置为读取“标题”属性时屏幕阅读器的行为

> ID：611358
> 
> 赞同：7
> 
> 时间：2009-03-04T16:30:54.753
> 
> 标签：web-applications, accessibility, w3c, wcag

我被告知如果“标题”属性扩展了控件可见文本中的内容，它应该包括可见文本中的所有信息，因为屏幕阅读器可能会读取标题**而不是**可见文本。为了准确说明这是如何工作的，以下几点是否正确（对于必须的屏幕阅读器）？

1.  如果标签与使用“for”属性的输入字段相关联，并且设置了输入字段的标题属性，则屏幕阅读器将仅读取标题属性并忽略标签文本。

2.  如果一个带有自己文本的控件（例如按钮）同时提供了可见文本和标题属性，则只会读取标题属性。

3.  屏幕阅读器将忽略按钮控件的可见文本，即使开发人员忽略了为该特定控件提供标题属性（最极端的可能性）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T00:21:46.157

1.  标签优先于输入标题属性。如果标签存在，JAWS 会读取它，否则如果标题存在，JAWS 会读取它。

2.  在这种情况下不读取title属性，读取可见文本

3.  不对。

来自[http://www.w3.org/TR/html401/struct/global.html#adef-title](http://www.w3.org/TR/html401/struct/global.html#adef-title)：

> 音频用户代理可以在类似的上下文中说出标题信息。例如，在链接上设置属性允许用户代理（可视和非可视）告诉用户链接资源的性质：

我在这段代码上使用 JAWS 进行了测试：

```
<FORM action="http://somesite.com/prog/adduser" method="post">
 <LABEL for="firstname">First name Label: </LABEL>
          <INPUT title="first name Title" type="text" id="firstname"><BR>
          <INPUT title="Last name Title" type="text" id="lastname"><BR>
 <LABEL for="email">email Label: </LABEL>
          <INPUT type="text" title="Email Title" id="email"><BR>
 <INPUT type="radio" name="sex" value="Male"> Male<BR>
 <INPUT type="radio" name="sex" value="Female"> Female<BR>
 <INPUT title="Send title" type="submit" value="Send"> <INPUT type="reset">
</FORM> 
```

我还应该指出，[Freedom Scientific](http://freedomscientific.com/products/fs/jaws-product-page.asp)有一个[试用下载 (ftp)](ftp://ftp.freedomscientific.com/users/hj/private/WebFiles/JAWS/J10.0.1139.exe)，它可以让您更深入地了解网页对用户的外观。

# javascript - 这行javascript做什么？

> ID：611364
> 
> 赞同：14
> 
> 时间：2009-03-04T16:31:38.450
> 
> 标签：javascript

在查看[jslint 代码约定](http://javascript.crockford.com/code.html)时，我看到了这一行：

```
total = subtotal + (+myInput.value); 
```

第二个“+”的目的是什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-04T16:33:59.520

与熟悉的一元减号 (-x) 相比，一元加号是为了完整性。然而，它有副作用，这里依赖，将 myInput.value 转换为数字，如果它是其他东西，例如字符串：

```
alert(1+'2'); // 12
alert(1+(+'2')); // 3 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-04T16:34:29.550

这就是所谓的“一元+运算符”，它可以作为一种快速方法来强制将变量转换为数字，以便可以在数学运算中使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-04T16:40:00.177

一[元 + 运算符](http://xkr.us/articles/javascript/unary-add/)将事物转换为数字。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-04T16:37:25.457

+ 是像其他人所说的那样将其类型转换为数字。那里需要它，因为表单输入始终是字符串值，并且将字符串添加到另一个变量会将它们连接在一起成为一个新字符串，即使字符串看起来像一个数字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T19:00:13.367

一元加运算符在算术上是一个 noop。但与所有其他纯算术运算符一样，它将其参数转换为 JavaScript 的数字类型，因此可以用作显式强制转换的简写。

JavaScript 中的显式类型转换是通过调用适当的构造函数*而不*使用`new`运算符来完成的。

例如，

```
Number(foo) 
```

将转换`foo`为 number 类型的基元，而`new Number(foo)`会另外为基元创建一个包装器对象，因此等效于

```
Object(Number(foo)) 
```

与此类似的用法`+`是`!!`用于转换为布尔类型。

# perl - 你如何使用 Perl 中的 sed？

> ID：611366
> 
> 赞同：9
> 
> 时间：2009-03-04T16:31:49.433
> 
> 标签：perl, sed

我知道如何使用`sed`with `grep`，但在 Perl 中以下失败。如何`sed`在 Perl 程序中工作？

```
chomp (my @lineNumbers=`grep -n "textToFind" $fileToProcess | sed -n 's/^\([0-9]*\)[:].*/\1/p'`) 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-04T16:34:11.673

建议：使用 Perl 正则表达式和替换，而不是 grep 或 sed。

它的语法大致相同，但功能更强大。最后，它也会比调用额外的 sed 进程更有效。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-04T16:36:27.860

你需要用 grep 或 sed 做的任何事情都可以更容易地在 perl 中本地完成。例如（这大致正确，但可能是错误的）：

```
my @linenumbers;
open FH "<$fileToProcess";
while (<FH>)
{
   next if (!m/textToFind/);
   chomp;
   s/^\([0-9]*\)[:].*/\1/;
   push @lineNumbers, $_;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-04T21:43:13.130

我很惊讶没有人提到[s2p](http://perldoc.perl.org/s2p.html)实用程序，它将 sed “脚本”（你知道，大多数时候是 oneliners）转换为有效的 perl。（还有一个用于 awk 的 a2p 实用程序......）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-04T17:05:51.207

据推测，Larry Wall 编写 Perl 是因为他发现了 sed 和 awk 无法解决的问题。其他答案有这个权利，请改用 Perl 正则表达式。您的代码将具有更少的外部依赖，更多人可以理解（Perl 的用户群比 sed 用户群大得多），并且您的代码将是跨平台的，无需额外工作。

编辑：Paul Tomblin 在他对我的回答的评论中讲述了一个精彩的故事。我把它放在这里是为了增加它的知名度。

“Henry Spencer 用 awk 做了一些了不起的事情，他声称在向 Larry Wall 演示了一些 awk 的东西之后，Larry 说如果他知道的话他就不会打扰 Perl。” ——保罗·汤布林

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-04T18:53:03.087

使用权力卢克：

```
$ echo -e "a\nb\na"|perl -lne'/a/&&print$.'
1
3 
```

`grep`因此，当您想要与这种缓慢且过于复杂的组合相同的想法时，`sed`您可以在 perl 本身中更简单更快地完​​成它：

```
my @linenumbers;
open my $fh, '<', $fileToProcess or die "Can't open $fileToProcess: $!";
while (<$fh>)
{
   /textToFind/ and push @lineNumbers, $.;
}
close $fh; 
```

或与原始解决方案具有相同的内存罪魁祸首

```
my @linenumbers = do {
    open my $fh, '<', $fileToProcess or die "Can't open $fileToProcess: $!";
    my $i;
    map { ( ++$i ) x /textToFind/ } <$fh>
}; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-26T12:34:36.943

您可以使用

```
perl -pe 's/search/replace/g' 
```

代替

```
sed 's/search/replace/' 
```

.. 然而 ..

这些适用于命令行或 shell 脚本。由于您已经在 perl 脚本中，因此上面的“Paul Tomblin”给出了正确答案。

玩得开心，eKerner.com

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-04T21:29:00.793

如果`sed`表达式很大，可以使用`s2p`, 将其转换为`perl`程序。

如果你运行 < `s2p 's/^\([0-9]*\)[:].*/\1/p'`>，你会得到：

```
#!/opt/perl/bin/perl -w
eval 'exec /opt/perl/bin/perl -S $0 ${1+"$@"}'
  if 0;
$0 =~ s/^.*?(\w+)[\.\w+]*$/$1/;

use strict;
use Symbol;
use vars qw{ $isEOF $Hold %wFiles @Q $CondReg
         $doAutoPrint $doOpenWrite $doPrint };
$doAutoPrint = 1;
$doOpenWrite = 1;
# prototypes
sub openARGV();
sub getsARGV(;\$);
sub eofARGV();
sub printQ();

# Run: the sed loop reading input and applying the script
#
sub Run(){
    my( $h, $icnt, $s, $n );
    # hack (not unbreakable :-/) to avoid // matching an empty string
    my $z = "\000"; $z =~ /$z/;
    # Initialize.
    openARGV();
    $Hold    = '';
    $CondReg = 0;
    $doPrint = $doAutoPrint;
CYCLE:
    while( getsARGV() ){
    chomp();
    $CondReg = 0;   # cleared on t
BOS:;
# s/^\([0-9]*\)[:].*/\1/p
{ $s = s /^(\d*)[:].*/${1}/s;
  $CondReg ||= $s;
  print $_, "\n" if $s;
}
EOS:    if( $doPrint ){
            print $_, "\n";
        } else {
        $doPrint = $doAutoPrint;
    }
        printQ() if @Q;
    }

    exit( 0 );
}
Run();

# openARGV: open 1st input file
#
sub openARGV(){
    unshift( @ARGV, '-' ) unless @ARGV;
    my $file = shift( @ARGV );
    open( ARG, "<$file" )
    || die( "$0: can't open $file for reading ($!)\n" );
    $isEOF = 0;
}

# getsARGV: Read another input line into argument (default: $_).
#           Move on to next input file, and reset EOF flag $isEOF.
sub getsARGV(;\$){
    my $argref = @_ ? shift() : \$_; 
    while( $isEOF || ! defined( $$argref = <ARG> ) ){
    close( ARG );
    return 0 unless @ARGV;
    my $file = shift( @ARGV );
    open( ARG, "<$file" )
    || die( "$0: can't open $file for reading ($!)\n" );
    $isEOF = 0;
    }
    1;
}

# eofARGV: end-of-file test
#
sub eofARGV(){
    return @ARGV == 0 && ( $isEOF = eof( ARG ) );
}

# makeHandle: Generates another file handle for some file (given by its path)
#             to be written due to a w command or an s command's w flag.
sub makeHandle($){
    my( $path ) = @_;
    my $handle;
    if( ! exists( $wFiles{$path} ) || $wFiles{$path} eq '' ){
        $handle = $wFiles{$path} = gensym();
    if( $doOpenWrite ){
        if( ! open( $handle, ">$path" ) ){
        die( "$0: can't open $path for writing: ($!)\n" );
        }
    }
    } else {
        $handle = $wFiles{$path};
    }
    return $handle;
}

# printQ: Print queued output which is either a string or a reference
#         to a pathname.
sub printQ(){
    for my $q ( @Q ){
    if( ref( $q ) ){
            # flush open w files so that reading this file gets it all
        if( exists( $wFiles{$$q} ) && $wFiles{$$q} ne '' ){
        open( $wFiles{$$q}, ">>$$q" );
        }
            # copy file to stdout: slow, but safe
        if( open( RF, "<$$q" ) ){
        while( defined( my $line = <RF> ) ){
            print $line;
        }
        close( RF );
        }
    } else {
        print $q;
    }
    }
    undef( @Q );
} 
```

不完全值得在小表情上做。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-04-06T09:31:49.380

以下是使用 Perl 替代 Sed 的方法：

代替：

```
sed "s/xxx/yyy/g" files_to_process 
```

采用：

```
perl -i.bak -pe "s/xxx/yyy/g" files_to_process 
```

这将*就地*修改文件并对每个修改的文件进行备份 ( `.bak`)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-04T16:42:13.760

编辑：好的，我现在修好了。

```
use File::Grep qw/fmap/;

my @lineNumbers = fmap { /$pattern/ ? $_[1] : () } $fileToProcess; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-11-09T22:28:57.537

使用 Perl 比使用 grep 和 sed 更容易；看到[另一个答案](https://stackoverflow.com/a/611945/3614563)。

您的代码失败了，因为 Perl 弄乱了 sed 代码中的反斜杠。为防止这种情况发生，请将您的 sed 代码写入`'a single-quoted Perl string'`，然后使用`\Q$sedCode\E`将代码插入到 shell 命令中。（关于`\Q...E`，请参阅[perldoc -f quotemeta](http://perldoc.perl.org/functions/quotemeta.html)。它通常的目的是为正则表达式引用字符，但[它也适用于 shell 命令](http://blog.thewebsitepeople.org/2014/03/shell-escaping-in-perl/)。）

```
my $fileToProcess = "example.txt";
my $sedCode = 's/^\([0-9]*\)[:].*/\1/p';
chomp(my @linenumbers =
      `grep -n "textToFind" \Q$fileToProcess\E | sed -n \Q$sedCode\E`);
printf "%s\n", join(', ', @linenumbers); 
```

给予`example.txt`_

```
this has textToFind
this doesn't
textToFind again
textNotToFind 
```

输出是`1, 3`。

# perl - 我怎样才能用 Perl 的能力给人们留下深刻印象？

> ID：611377
> 
> 赞同：17
> 
> 时间：2009-03-04T16:33:55.777
> 
> 标签：perl

我想为我的同事做一个演示，展示 Perl 可以做的一些令人惊奇的事情，这些事情会让程序员和非程序员都对自己说，“哇，你能做到吗？！” 我真的很想转过头来，因为许多人认为 Perl 是一种垂死的语言，但也很有趣。

我的一些想法是以下模块的演示：

*   [电子表格::WriteExcel](http://search.cpan.org/perldoc?Spreadsheet::WriteExcel)和[电子表格::ParseExcel](http://search.cpan.org/perldoc?Spreadsheet::ParseExcel)
*   [万维网::机械化](http://search.cpan.org/perldoc?WWW::Mechanize)
*   [图片::魔术师](http://search.cpan.org/perldoc?Image::Magick)

有什么建议或意见吗？

顺便说一句，我们是一家科技公司（经营一个数据中心），所以我同事的计算机素养很高。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-04T16:46:07.590

几年前，当我第一次学习如何编程时，我女朋友的表弟向我展示了他编写的一个 Perl 脚本，该脚本与一个包含所有已知卫星位置的数据库联系起来，并计算了空间站等最大物体的飞越时间先生。该脚本通过[cron](http://en.wikipedia.org/wiki/Cron)在他运行的服务器上运行，它会定期运行，然后在给定对象在夜空中可见的头顶上大约 5 分钟之前向他发送一个页面。当我们在城里走来走去时，他可以通过突然指向并说“看！”来引起所有人的注意，当卫星在头顶巡航时，每个人都发出呜呜声。

当时我对那个脚本印象深刻，因为我不知道如何编写一个几乎如此复杂的程序。现在我有了一个更好的主意，我仍然认为它是一个很好的演示，因为它展示了一些新颖的东西，可以在相对较短的时间内用这种语言完成，而且几乎没有汗水。所以我会说选择一些新颖或有趣的东西，并强调 Perl 的语言经济及其网络功能。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-04T17:11:41.007

我相信[CPAN](http://en.wikipedia.org/wiki/CPAN)本身就令人印象深刻。新模块的安装非常容易，因为它们都**在**那里。

然后组合模块来做一些很酷的事情：从几乎所有经过的数据生成 RSS（或 Atom），使用[GraphViz::*](http://search.cpan.org/dist/GraphViz/)生成漂亮的图片 (tm)。

您还可以查看一些大型框架类型模块的教程，例如[Catalyst](http://search.cpan.org/dist/Catalyst)或[POE](http://search.cpan.org/dist/POE)，它们有一些非常漂亮的事情可以用很少的代码完成。

如果当地文化不是太紧张，一些 Acme::* 模块（例如[Acme::Bleach](http://search.cpan.org/dist/Acme::Bleach)）非常聪明，一定会让你发笑。

最后，当然是使用[XML::Twig](http://search.cpan.org/dist/XML::Twig)，这是一种可以为您提供美元和欧元之间当前汇率的单行代码：

```
perl -MXML::Twig -l -e'print XML::Twig->parse( "http://www.x-rates.com")->first_elt(q{a[@href="/d/USD/EUR/graph120.html"]})->text' 
```

很容易让它适应来自另一个网站的数据。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-04T17:20:54.230

给他们[看冰冻泡泡](http://www.frozen-bubble.org/)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-04T20:47:22.487

在向他们展示[search.cpan.org](http://search.cpan.org/)（并解释 CPAN 的概念）之后，向他们展示以下任何内容：

*   [驼鹿](http://search.cpan.org/perldoc?Moose)
*   [DBIx::类](http://search.cpan.org/perldoc?DBIx::Class)
*   [催化剂](http://search.cpan.org/perldoc?Catalyst)
*   [内联::Java](http://search.cpan.org/perldoc?Inline::Java)
*   [内联::C](http://search.cpan.org/perldoc?Inline::C)
*   [Inline::WSC](http://search.cpan.org/perldoc?Inline::WSC)（Windows 上来自 Perl 的 JavaScript/VBScript）
*   [成像仪](http://search.cpan.org/perldoc?Imager)
*   [Kamaitachi](http://search.cpan.org/perldoc?Kamaitachi)（用 Moose 和 Danga::Socket 用 Perl 编写的 Flash 媒体服务器）

然后用 sort/map/grep 组合（又名[Schwarzian Transform](http://www.perlmonks.org/?node_id=476700)）让他们大吃一惊，它在 1 行代码中比在 50 行 C# 中完成的工作更多。

向他们展示[线程](http://search.cpan.org/perldoc?threads)和[分叉](http://search.cpan.org/perldoc?forks)，然后将其与在 Java 或 C# 下完成相同工作所需的相同代码进行比较。

如果他们没有被 Perl 多年来使用 C#**刚刚**引入的相同习语这一事实所震撼，那么我不知道该说什么。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-04T17:04:00.417

屏幕抓取、与外部程序交互以及快速解析文本文件的某种组合会给人们留下深刻印象。squook 给出的例子绝对符合要求。

另一方面，为什么不在你的日常工作中使用它，编写其他人都使用的非常有用的工具，并向人们解释你用 Perl 制作了这些工具呢？这样，您就可以为工作完成有用的事情，而您工作场所的人肯定会欣赏*完成工作*的价值。:)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-04T17:49:53.973

对我来说最酷的事情之一就是使用 Perl 进行代码生成。特别是当它涉及其他语言时。我编写了几个小脚本来生成 C++ 类和 Java 代码。

回到我还是 Perl 新手的时候。我编写了这段代码，它基于我们的数据库生成了模式文件。大约 2 小时后，我发现我不需要为[DBIx::Class](http://en.wikipedia.org/wiki/DBIx::Class)执行此操作。这不是很好的 Perl 代码（不要为它投反对票。这只是一个例子），但它为我准确地生成了 200 个模式文件。

```
my @db = `mysql -u XXXXX -pXXXXX --skip-column-names -e "show databases;"`;

foreach my $db_name (@db) {
    chomp($db_name);
    my @tables = `mysql -u XXXXX -pXXXXX --skip-column-names -e "use $db_name; show tables;"`;
     $_ =~ s/\n// foreach(@tables);

    unless ( -e "$db_name.pm") {
        open(DBFILE, '>', "$db_name.pm");
        print DBFILE "package mysql::schemes::$db_name;\n";
        print DBFILE "use base qw/DBIx::Class::Schema/;\n\n";
        print DBFILE '__PACKAGE__->load_classes(qw/' . join(' ', @tables) . "/);\n\n";
        print DBFILE "1;";
        close(DBFILE);
    }
    mkdir $db_name unless ( -d $db_name or -e $db_name );
    foreach my $table_name (@tables) {
           my @columns = `mysql -u XXXX -pXXXX --skip-column-names -e "USE $db_name; desc \\\`$table_name\\\`;"`;
           $_ =~ s/\n$// foreach(@columns);

           my (@names, $primary_key);
           foreach (@columns) {
                my ($name, $type, $null, $key, $default) = split(/\t/, $_);
                chomp($default);
                push(@names, $name);
                $primary_key = $name if($key ne '');
            }

            unless ( -e "$db_name/$table_name.pm" ) {
                open(TBFILE, '>', "$db_name/$table_name.pm");
                print TBFILE "package mysql::schemes::" . $db_name . "::" . $table_name . ";\n";
                print TBFILE "use base qw/DBIx::Class/;\n\n";
                print TBFILE "__PACKAGE__->load_components(qw/PK::Auto Core/);\n";
                print TBFILE "__PACKAGE__->table('$table_name');\n";
                print TBFILE "__PACKAGE__->add_columns(qw/" . join(' ', @names) . "/;\n";
                print TBFILE "__PACKAGE__->set_primary_key('$primary_key');\n\n" unless($primary_key eq '');
                print TBFILE "1;";
                close(TBFILE);
            }
    }
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-05T06:22:34.803

我总是说同样的话，但为了向人们展示 CPAN 的有用性，我会向他们展示将英文文本解析为其组成句子的问题。

遇到这个问题的聪明观众可能会说“就在句号上分裂”。然后边缘情况和问题将开始发生在他们身上。句号出现在各种其他地方；句子以问号和感叹号以及三个尾随句号结尾......句号或！或者 ？后跟空格，不，但这不起作用，因为它后面可能跟着 EOF 等。

如果您准备了一些包含所有这些边缘案例的棘手文本，您只需指向一个示例即可击落他们提出的所有解决方案。然后你会用 Lingua::En::Sentence 解析它。

它并不像您所说的那样华而不实，但它显示了一个模块的力量，这些模块的作者已经解决了您的听众刚刚遇到的所有问题，并解决了这些问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-04T18:20:19.187

使用单行演示复杂的数据操作，例如解析 Web 服务器日志和 404 错误，然后使用另一个单行从 HTML 文档集合中删除损坏的链接...

有一次我给一群长期的系统管理员教授了一个 Perl 研讨会，当他们看到如何使用模块化和数据结构等真正的编程技巧来改进他们的 shell 脚本时，他们看到了最大的价值。他们已经知道的。在 Windows 环境中，我将演示如何操作大型文件结构、权限和注册表，因为每个人总是需要这种东西，而 Perl 比批处理文件等更健壮。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-04T19:45:40.903

我认为能够[编写宏来操作 Windows 剪贴板](http://www.perlmonks.org/?node_id=648493)是相当令人印象深刻的。它有各种各样的可能性，并且可以从几乎任何可以剪切/粘贴文本的 Windows 应用程序中为您提供 Perl 的强大功能。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-10-02T09:20:08.567

这是在 perl for win32 [http://www.unix.gr/FLOSSeavesDrop.exe中完成的](http://www.unix.gr/FLOSSeavesDrop.exe)

它是一种远程屏幕审计辅助工具。在 Windows PC 上运行它，然后你可以只用一个网络浏览器来监控它的主显示。将浏览器定位到 PC 的 IP 端口 42000

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-04T17:25:01.303

如果您想使用[Image::Magick](http://search.cpan.org/~jcristy/PerlMagick-6.58/Magick.pm)，您可以编写一个快速脚本，将常规图片转换为 ASCII 艺术。那将是一个相当快的脚本。应用[sobel 算子](http://en.wikipedia.org/wiki/Sobel_operator)，然后将生成的亮度转换为 ASCII 值。我实际上已经在 Python 中做到了这一点：[example](http://andrebluehs.net/projects.html) .

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-04T22:16:04.830

第一个想法：[App::Asciio](http://search.cpan.org/perldoc?App::Asciio) （[见截屏视频](http://www.youtube.com/watch?v=IiOHYNHo_Nw)）

第二个想法：如果没有一个小而紧的案例，就很难演示。与其发明它们，不如从其他人那里借来展示 Perl 的优雅。

一种选择是 Microsoft Scripting Games 的解决方案。ActiveState 的 Jan Dubois 提供了[带有评论的解决方案](http://www.microsoft.com/technet/scriptcenter/funzone/games/games08/experts.mspx)，您可以使用/调整。（就我个人而言，我发现我的许多解决方案使用的代码要少得多，因此您可能希望将它们编辑下来，让 Perl 看起来更加优雅。）

另一种选择可能是浏览[Randal Schwartz 的一些专栏](http://www.stonehenge.com/merlyn/LinuxMag/)。里面有一些宝石。（例如[用推特指法自己](http://www.stonehenge.com/merlyn/LinuxMag/col93.html)）

至于应用程序，[Perl::Critic](http://search.cpan.org/perldoc?Perl::Critic)非常棒。和[ack](http://search.cpan.org/perldoc?ack)一样。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-01-16T15:05:53.437

我认为这里的大多数答案都不会真正让任何人惊叹，尤其是科技人群。他们可能会对 Perl 能做到这一点感到惊讶，但他们不会对你能做到这一点感到惊讶。然而，即使他们对你能做到这一点并不感到惊讶，他们也可能会惊讶于你能做到这一点的速度有多快，或者代码多么少。

如果你正在寻找让他们惊叹的东西，你必须弄清楚他们认为在他们的工作中什么是困难的，并看看 Perl 是否可以使它变得非常容易。我发现人们往往不在乎一种语言是否可以做他们不感兴趣的事情。话虽如此，用 Perl 给任何人留下深刻印象就像在任何其他领域给任何人留下深刻印象一样：你必须了解他们以及他们会留下深刻印象的东西。你必须了解你的听众。

Perl 实际上并没有任何特殊功能可以让它做任何其他语言也可以做的事情。然而，Perl 结合了许多您通常在同一种编程语言中找不到的特性。

大多数让我印象深刻的事情几乎与语言无关：

*   尽管架构存在差异，但有一个代码库可以在数百个不同的平台上运行。

*   Perl 的[CPAN](http://search.cpan.org/)在其他语言中仍然是无与伦比的（这真的很可悲，因为对其他语言做同样的事情是如此容易）。

*   测试文化确实提高了 Perl 编程的标准，并且有很多工作可以梳理平台依赖性、跨模块问题等等，而无需原始开发人员做太多事情。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-04T20:03:21.827

在轻浮和娱乐方面，Damian Conway 进入第三届混淆 Perl 竞赛，[SELFgol](http://www.perlfoundation.org/perl5/index.cgi?selfgol)执行了 4 个任务

```
* Its a quine (when executed, prints an exact copy of itself)
* Turns other programs into quines
* Plays Conway's Game of Life
* Animates a marquee banner 
```

所有这些都在 1000 个字符以内。很有趣。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-05T03:24:49.533

如果您在 IT 中心，您周围可能有许多计算机……[小型计算机](http://en.wikipedia.org/wiki/Minicomputer)、[大型机](http://en.wikipedia.org/wiki/Mainframe_computer)、PC 等。

一个脚本如何输出并获取有关这些机器的某种信息，您的 IT 人员需要这些信息，并以某种 HTML 格式提供它。

很久以前，我有 15 台基于 TCP/IP 的服务器，它们为各种客户端做一些事情。我编写了一个 Perl 脚本，该脚本提取了每个服务器的参数，并将这些信息插入到一个新的 Excel 电子表格中，每个服务器一个选项卡。然后它把它放在一个文件服务器上，每个人都可以检查它。它为支持服务器的人员节省了大量时间。

环顾四周，寻找一种可以通过减少体力劳动让他们的生活更轻松的情况。我认为这是你最好的选择。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-05T05:11:35.720

由于大多数编程语言在你实现某事的速度方面相当可比，也许你可以用 Perl 平台的坚固性和价值“惊叹”它们？这里有[一些有趣的统计数据](http://www.bofh.org.uk/2009/03/04/perl-test-infected-since-1987)，说明 Perl 发行版和 CPAN 模块的测试情况。CPAN 也是一个了不起的创作，它具有相关的文档、搜索、评论、注释和错误跟踪网站。[CPAN 测试人员](http://testers.cpan.org/)绝对是锦上添花：多个平台和 Perl 版本的测试人员集合。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-05T23:19:55.607

我最喜欢的 Acme 模块是 Acme::Eyedrops 和 Acme::Bleach。适合轻度缓解。

# javascript - 火狐这个功能

> ID：611378
> 
> 赞同：3
> 
> 时间：2009-03-04T16:33:56.650
> 
> 标签：javascript, internet-explorer, firefox, this

为什么 Firefox 不处理这个。此代码适用于 IE。

```
<%@ Language=VBScript %>
<HTML>
<HEAD>
<META NAME="GENERATOR" Content="Microsoft Visual Studio 6.0">
</HEAD>
<script type='text/javascript'>
function drvFunc(elem)
{
    var e = elem.name;
    var d = "document."
    var f = "frm";
    var str = d+"."+f+"."+e+".value;";
    alert(eval(str));
}
</script>
<BODY>
<form name=frm method=post>
<input type=button name=myButton id=myButton value='MyButton' onclick='drvFunc(this)'>
</form>
</BODY>
</HTML> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-04T16:43:07.067

```
function drvFunc(elem) {
  alert(elem.value);
} 
```

你不需要邪恶的 eval() 这个函数......

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-04T16:41:37.193

问题是你有两个时期被连接起来：

1.  `var d = "document."`
2.  `var str = d+"."+f...`

您的结果字符串变为：`"document..frm.myButton.value;"`

删除其中一个期间，它将起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T09:55:47.507

你也可以去：

```
<input type='button' name='2ndButton' id='2ndButton' onclick='drvFunc(this.id)'> 

function drvFunc(elemid){ 
   alert(document.getElementById(elemid).value); 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T17:23:00.073

我是这个代码线程的原作者。我不确定我是否正确地说明了问题。

```
function drvFunc(elem)
{
    **var e = elem.name;** <-- in firefox, this fails.  e is not initialized!! 
    var d = "document."
...
} 
```

在一个表单上，我可能会写一些这样的代码，它在 IE 中运行良好......

```
<input type=button name=1stButton id=1stButton onclick='drvFunc(this)'>
<input type=button name=2ndButton id=2ndButton onclick='drvFunc(this)'> 
```

...然后 drvFunc 可以做到这一点

```
function drvFunc(elem)
{

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T16:45:34.003

改变

```
var d = "document." 
```

至

```
var d = "document" 
```

您正在使用“document..frm”运行 eval

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T17:32:44.840

您需要在`<input>`标签上的属性周围加上引号（单引号或双引号）。

Firefox 处理未引用的属性可能与 IE 不同：[http ://www.cs.tut.fi/~jkorpela/qattr.html](http://www.cs.tut.fi/~jkorpela/qattr.html)

正如其他人所说，您还需要删除多余的点`"document."`，并且可能也应该重构`drvFunc`to remove `eval`。

在 Firefox 3 下，以下内容非常适合我：

```
<%@ Language=VBScript %>
<HTML>
<HEAD>
<META NAME="GENERATOR" Content="Microsoft Visual Studio 6.0">
<script type='text/javascript'>
function drvFunc(elem)
{
    alert(elem.value);
}
</script>
</HEAD>
<BODY>
<form name="frm" method="post">
<input type="button" name="myButton" id="myButton" value="MyButton" onclick="drvFunc(this)">
</form>
</BODY>
</HTML> 
```

# css - 回头客的 CSS Sprite 性能增益是多少？

> ID：611381
> 
> 赞同：1
> 
> 时间：2009-03-04T16:34:24.590
> 
> 标签：css, performance, user-interface

我有一个有一个大菜单的网站，菜单上的每个项目都有一个图标。我一直在研究实现一个 CSS sprite 来加速它，但我想知道性能提升会是什么。我的网站不向公众开放，所以用户几乎总是会重复，所以值得实施还是我应该只依靠缓存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T16:40:51.283

除非您的网站有大量的非重复流量，否则可能根本不会有明显的性能提升。您目前是否遇到性能问题？如果没有，那么可能没有必要过早地优化这样一个相对较小的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T16:47:45.510

你有多大把握，在未来，网站的某些部分不会

*   公开
*   扩大私人观众
*   获取新菜单

所有这些都是您可能要考虑预先进行此操作的原因。我不知道您的情况，但对于某些开发人员来说，前两项可能会作为业务决策突然实施，而程序员甚至从未听说过这件事，后来经理回来询问提高网站性能的方法。或者它甚至永远不会走得那么远：也许网站因为速度慢而失去了用户，而管理层也从未听说过。

现在，既然你已经有了可以工作的代码，我就不会太担心了。但是，当最初将站点放在一起时，要记住这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T16:50:21.197

我认为您应该问的主要问题是您的用户是否对网站的响应能力感到满意。如果不是，并且没有更大的潜在问题导致此问题，那么您可以使用此更改。

[List Apart http://www.alistapart.com/articles/sprites/](http://www.alistapart.com/articles/sprites/)上有一篇关于该主题的好文章

# visual-studio-2005 - Visual Studio 为 HTML 使用什么渲染引擎？

> ID：611385
> 
> 赞同：1
> 
> 时间：2009-03-04T16:34:54.917
> 
> 标签：visual-studio-2005

有谁知道 Visual Studio 使用什么渲染引擎来渲染它的 HTML 预览？

它似乎对 IE6 更友好，但仍然不是真正的 WYSIWYG

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T16:43:09.670

如果您指的是在编辑页面时呈现页面的任何内容，很可能是他们专门为此目的编写的内容，因为它需要允许您编辑内容。

# php - 无论如何要在 Dreamweaver 中检查 PHP？

> ID：611390
> 
> 赞同：4
> 
> 时间：2009-03-04T16:35:49.703
> 
> 标签：php, plugins, dreamweaver

我在 Dreamweaver（当前版本为 CS3）中完成所有 PHP 编码，我已经习惯并喜欢它。不过，我想要一件事，就是能够检查错误。目前，在我将页面上传到服务器之前，我看不到它们。无论如何在 Dreamweaver 中设置 PHP 错误检查？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T16:38:19.963

你的意思是当你打字的时候？由于 PHP 没有被编译，所以它不像 Java 或 C# 这样的语言那么容易。最接近的是[PHPLint](http://www.icosaedro.it/phplint/)。不幸的是，您必须对 Cygwin 进行一些黑客操作才能使其在 Windows 下工作。

我知道这不是您要求的，但 Dreamweaver 不是一个非常好的 PHP 编辑器。它缺乏很多特性，并不是真的打算主要用于 PHP。试试这些编辑器，它们有即时错误检查功能：

*   [日蚀 PDT](http://www.eclipse.org/pdt/)
*   [禅德工作室](http://www.zend.com/en/products/studio/)
*   [科莫多编辑](http://www.activestate.com/komodo_edit/)

如果您的意思是如何设置系统以便可以在计算机上本地测试 PHP 而无需将其上传到网络，那么您需要在计算机上安装一个网络服务器。我强烈推荐[Xampp](http://www.apachefriends.org/en/xampp.html)。它是在您的计算机上安装 Apache、MySQL、PHP 等的多合一软件包，并且具有漂亮的控制面板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-13T05:17:39.370

多年来，我一直在使用 PHP/MySQL/HTML/CSS/JS 进行编码。Dreamweaver 在其发展过程中做了很多好事。CS4 产品很好，但仍然缺少专业人士绝对需要的那些东西……实时代码检查、代码完成等。这些都是绝对的。

PHPed 是一个不错的产品，但仅在 Windows 中可用。尽管它声称，它在 Mac 或 Linux 平台上不稳定。

Zend 和 Aptana 几乎是一回事。两者都是基于 Eclips-PDT 的产品，除了 Aptana 功能更全。例如，Zend 对客户的反应非常迟钝，因为它不包括诸如自动换行之类的简单事物。Aptana Studio 1.5 拥有自己的 PHP 插件非常出色，但由于采用了未完成的原始 PDT，因此不再可用。

NetBeans 绝对是最好的 PHP 平台，但有一个缺点是内存不足……至少在 Mac 上是这样（但这可能是 Java VM 的问题）。但它确实提供了最好的一组功能......而且它是免费的。

Aptana 1.5 是我目前的选择，但由于它不再被增强，我正在寻找一个新的 IDE 选择。到目前为止，这一直是 NetBeans。我希望他们最终会修复内存泄漏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-23T13:53:29.637

约翰·艾萨克

我想你的祈祷已经被听到了。现在在dreamweaver 中，您可以在不上传到服务器的情况下查看代码。您必须做的一件事是使用包括 PHP 和 MYSQL 的本地网络设置您的站点。我现在使用的版本是CS5。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T16:38:48.073

我强烈推荐使用像[Eclipse PDT](http://www.eclipse.org/pdt/)这样的 IDE ，它将极大地增强您使用 PHP 的体验。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T02:17:09.540

我个人非常喜欢 NuSphere 的[phpED](http://www.nusphere.com/)。它比我尝试过的其他几个编辑器更好地完成代码和语法检查。

为了实时查看您的工作，我建议您下载[WAMP](http://www.wampserver.com/en/)并在您的计算机上设置一个快速的网络服务器。每次您想查看更改时，它都会通过 FTP 上传甜菜。

# sql-server - ROW_NUMBER() 列无效并试图加快查询帮助

> ID：611394
> 
> 赞同：0
> 
> 时间：2009-03-04T16:36:48.860
> 
> 标签：sql-server, tsql

我正在尝试使用 ROW_NUMBER 函数，但遇到了两个问题。1) 因为我是按降序排列计数，所以 rowid 不是从 1 开始，例如从 41 开始。2) 当我尝试将 rowid 恢复到 42 到 52 之间时，它说 rowid 是无效列。下面是一些额外的列被删除的低调查询，所以它更具可读性：

```
SELECT ROW_NUMBER() OVER (ORDER BY column1) AS rowid,
hrl.column0
(SELECT top 1 bus from hc WHERE column2 = hc.column2) AS c,
'Site' as Based,
column1, column2, column3, column4,
CASE WHEN status = '1' Then 'Active'
     WHEN status = '2' Then 'Canceled'
ELSE
   'Unknown'
END as column5,
column6,
(select count(*) from hrl where column1 = hrl.column1) as [cnt]
FROM hrl
INNER JOIN hc on hc.column2 = hrl.column2
INNER JOIN rsc on rsc.column3 = hrl.column3
LEFT OUTER JOIN  gmt on gmt.[column7] = hrl.[column7]
where bus LIKE '%test%'
ORDER BY [cnt] desc,rowid
and  rowid >= 1 AND rowid <= 10 -- Says rowid is invalid 
```

这是我想要的数据

```
RowID 业务计数

1 绿色 50
2 红 30
3 蓝色 20

```

这是我得到的：

```
RowID 业务计数

3 蓝色 20
2 红 30
1 绿色 50

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T16:39:19.023

将其放入子查询中：

```
SELECT *
FROM (
    SELECT ROW_NUMBER() OVER (ORDER BY column1) AS rowid,
    hrl.column0,
    (SELECT top 1 bus from hc WHERE column2 = hc.column2) AS c,
    'Site' as Based,
    column1, column2, column3, column4,
    CASE WHEN status = '1' Then 'Active'
         WHEN status = '2' Then 'Canceled'
    ELSE
       'Unknown'
    END as column5,
    column6,
    (select count(*) from hrl where column1 = hrl.column1) as [cnt]
    FROM hrl
    INNER JOIN hc on hc.column2 = hrl.column2
    INNER JOIN rsc on rsc.column3 = hrl.column3
    LEFT OUTER JOIN  gmt on gmt.[column7] = hrl.[column7]
    where bus LIKE '%test%'
) sq
WHERE rowid >= 1 AND rowid <= 10
ORDER BY [cnt] DESC 
```

如果您只想`TOP 10 column1`要按 排序的行`[cnt]`，您可以使用：

```
SELECT *
FROM (
    SELECT TOP 10
           hrl.column0,
           (SELECT top 1 bus from hc WHERE column2 = hc.column2) AS c,
           'Site' as Based,
           column1, column2, column3, column4,
           CASE WHEN status = '1' Then 'Active'
                WHEN status = '2' Then 'Canceled'
                ELSE 'Unknown'
           END as column5,
           column6,
           (select count(*) from hrl where column1 = hrl.column1) as [cnt]
    FROM   hrl
    INNER JOIN hc on hc.column2 = hrl.column2
    INNER JOIN rsc on rsc.column3 = hrl.column3
    LEFT OUTER JOIN  gmt on gmt.[column7] = hrl.[column7]
    WHERE  bus LIKE '%test%'
    ORDER BY column1
) sq
ORDER BY [cnt] DESC 
```

或者，如果你只是需要`ORDER BY [cnt] DESC`，试试这个：

```
SELECT TOP 10
       hrl.column0,
       (SELECT top 1 bus from hc WHERE column2 = hc.column2) AS c,
       'Site' as Based,
       column1, column2, column3, column4,
       CASE WHEN status = '1' Then 'Active'
            WHEN status = '2' Then 'Canceled'
            ELSE 'Unknown'
       END as column5,
       column6,
       (select count(*) from hrl where column1 = hrl.column1) as [cnt]
FROM   hrl
INNER JOIN hc on hc.column2 = hrl.column2
INNER JOIN rsc on rsc.column3 = hrl.column3
LEFT OUTER JOIN  gmt on gmt.[column7] = hrl.[column7]
WHERE  bus LIKE '%test%'
ORDER BY [cnt] DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T04:10:30.037

将未排序的数据包装为 CTE（公用表表达式）

```
;with NotSorted as (
    SELECT  ROW_NUMBER() OVER (ORDER BY column1) AS rowid, 
        hrl.column0, 
        (SELECT top 1 bus from hc WHERE column2 = hc.column2) AS c,
        'Site' as Based, column1, column2, column3, column4,
        CASE WHEN status = '1' Then 'Active'
             WHEN status = '2' Then 'Canceled'
             ELSE 'Unknown'
        END as column5, column6,
        (select count(*) from hrl where column1 = hrl.column1) as [cnt]
    FROM    hrl
            INNER JOIN hc on hc.column2 = hrl.column2
            INNER JOIN rsc on rsc.column3 = hrl.column3
            LEFT OUTER JOIN  gmt on gmt.[column7] = hrl.[column7]
    where   bus LIKE '%test%'
)
select  *
from    NotSorted
ORDER BY [cnt] desc, rowid and  rowid >= 1 AND rowid <= 10 
```

至于，

> and rowid >= 1 AND rowid <= 10 -- 表示 rowid 无效

您不能直接访问计算别名，您通常会将计算列放入子查询或作为 CTE

# cocoa - 翻转NSViews层（CALayer）的坐标

> ID：611396
> 
> 赞同：2
> 
> 时间：2009-03-04T16:37:17.470
> 
> 标签：cocoa, core-animation

我在 awakeFromNib 中做到了这一点：

```
drawLayer = [CALayer layer];
self.layer = drawLayer;
[self setWantsLayer:YES]; 
```

有一个“添加：”动作

```
// some  business logic

    [drawLayer addSublayer:layer];
    [self layout];

-(void)layout
while(pg = [pageEnumr nextObject])

    {
    //rect is calculated so that layers are added in order (left to right)
    [pg setFrame:rect];
    } 
```

我希望从superLayer（视图的CALayer）的左上角添加子层，但它们是从左下角添加的

我试过仿射变换

```
 CGAffineTransform  trans = CGAffineTransformMake(1.0,0.0,0.0,-1.0,0.0,0.0);
   self.layer.affineTransform =    trans; 
```

但滚动使我的子层消失

我用了变换

```
CATransform3D aTransform = CATransform3DIdentity;
aTransform = CATransform3DMakeRotation(M_PI, 1, 0, 0);  
self.layer..transform = aTransform; 
```

我必须应用变换来反旋转 subLayers，在添加大约 100 个子图层后，滚动变慢并且应用程序变得无响应

如果我不应用任何变换（无仿射或无变换），那么即使在添加 1000 个子层后应用程序也很快

我的应用程序必须托管大量不同大小的层。帮助我如何使托管层采用翻转坐标...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T16:57:32.040

如果你想翻转图层的坐标空间，我相信反转 Y 比例是更好的处理方法。我做了类似的事情，以便使用以下代码在 iPhone 上以另一种方式反转坐标系（以便在 UIView 中托管的 CALayer 将遵循 Mac 的 Quartz 坐标系）：

```
self.layer.sublayerTransform = CATransform3DMakeScale(1.0f, -1.0f, 1.0f); 
```

尝试使用此变换或应用于图层变换属性的相同变换。在我的测试中，这并没有损害性能。

如果您发现需要应用变换来对抗每个图层的翻转，而这会降低性能，也许您应该手动计算每个图层放置的正确 Y 坐标。这并不难（self.layer.frame.size.height - y - newLayer.frame.size.height，我相信）。

# mysql - 计算今天、昨天...和其他时间添加的行数

> ID：611402
> 
> 赞同：5
> 
> 时间：2009-03-04T16:37:44.240
> 
> 标签：mysql, sql, count

我今天从这里得到了解决问题的好方向，但我一直试图遵循这个方向。

我想使用我`count`的过去从表中检索所有行的. 我使用这些字段填充这些字段，它们的格式为.`30 days``date field``now()``Y-m-d h:i:s`

*   我需要一个`count`用于今天、昨天、3 天前添加的行...等
*   我想我可以使用上面的方法来计算每个月的数量？
*   最后一个`count`使用月份作为总月份的一年，前一年等？

我希望不在我的查询中指定日期，并且查询只是通用的并计算出相对于今天的计数。我也希望通过考虑不同的月份有不同的天数，我也能准确地做到这一点。

我怎样才能只`count`使用**SQL**得到这个？然后我可以将结果集用作数组并使用`PHP`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-04T16:46:16.310

昨天插入的记录数：

```
select count(*) from mytable where date(myfield)=date(date_sub(now(),interval 1 day)); 
```

年度：

```
select count(*) from mytable where year(myfield)=year(now()); 
```

等等...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T16:42:15.070

查看 MySQL 的[DATE_ADD](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-add)和[DATE_SUB](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-sub)函数，它将为您提供所需的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T16:45:37.323

我不完全确定您的数据库结构是什么样的，但您可能可以使用以下方法实现您想要的`GROUP BY`：

按天汇总：

```
SELECT date(my_date_field) d, count(*) c FROM tbl
GROUP BY d
ORDER BY d 
```

按月汇总：

```
SELECT year(my_date_field) y, month(my_date_field) m, count(*) c FROM tbl
GROUP BY y, m
ORDER BY y, m 
```

要按年份聚合，您可以简单地从上面的示例中删除月份参数。

如果你想得到`limit`具体的结果，你可以`WHERE`直接在 d、y`my_date_field`或`HAVING`m 上使用。用于`DATE_SUB`计算相对于当前日期的日期。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T16:45:04.800

查看 DATEDIFF ...我不确定 mysql 的确切语法，但它最终应该类似于：

```
select * from Table WHERE datediff(StartDate, Today) < DaySpan 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T17:04:33.737

根据按日期、月份和年份分组尝试此解决方案：

```
-- Testing data
DECLARE @TestTable TABLE(ID INT, AddDate DATETIME)
INSERT INTO @TestTable
SELECT 1, '2009-03-04 14:58:01' UNION
SELECT 1, '2009-05-14 14:58:01' UNION
SELECT 1, '2009-05-14 14:58:02' UNION
SELECT 1, '2009-05-24 14:58:01' UNION
SELECT 1, '2009-05-24 14:58:02' UNION
SELECT 1, '2009-05-24 14:58:03' UNION
SELECT 1, '2009-07-04 14:58:01' UNION
SELECT 1, '2009-09-04 14:58:01' UNION
SELECT 1, '2010-01-04 14:58:01' UNION
SELECT 1, '2010-03-04 14:58:01' UNION
SELECT 1, '2010-03-04 14:58:02'

-- MySQL Answer
-- for each day
SELECT EXTRACT(YEAR_MONTH_DAY, AddDate), COUNT(ID) FROM @TestTable
GROUP BY EXTRACT(YEAR_MONTH_DAY, AddDate)
-- for each month
SELECT EXTRACT(YEAR_MONTH, AddDate), COUNT(ID) FROM @TestTable
GROUP BY EXTRACT(YEAR_MONTH, AddDate)
-- for each year
SELECT EXTRACT(YEAR, AddDate), COUNT(ID) FROM @TestTable
GROUP BY EXTRACT(YEAR, AddDate)

-- SQL Answer
-- for each day
SELECT dateadd(day, datediff(day, 0, AddDate)+0, 0), COUNT(ID) 
FROM @TestTable
GROUP BY dateadd(day, datediff(day, 0, AddDate)+0, 0)
-- for each month
SELECT dateadd(month, datediff(month, 0, AddDate)+0, 0), COUNT(ID) 
FROM @TestTable
GROUP BY dateadd(month, datediff(month, 0, AddDate)+0, 0)
-- for each year
SELECT dateadd(year, datediff(year, 0, AddDate)+0, 0), COUNT(ID) 
FROM @TestTable
GROUP BY dateadd(year, datediff(year, 0, AddDate)+0, 0) 
```

# java - 如何将数据从 Perl 传递到 Java？

> ID：611417
> 
> 赞同：5
> 
> 时间：2009-03-04T16:41:54.620
> 
> 标签：java, perl, language-interoperability

我正在处理一些 Java <-> Perl 交互。我想知道将信息从 Perl 传递到 Java 的最佳方法是什么。（关于 Perl 和 Java 的很好的答案[在这里](https://stackoverflow.com/questions/603554/how-should-i-call-a-perl-script-in-java)和[这里](https://stackoverflow.com/questions/603163/is-perl-a-good-option-for-heavy-text-processing/603837#603837)顺便说一句）。

有很多文本和 XML(XML::Twig) 我在 Perl 中解析，在我应该从 Java Web App 调用的脚本中。所以我收集了所有这些数据，我需要它在 Java 中的某些对象中使​​用它。

将信息从 Perl 发送到 Java 的好策略是什么？是否有可能从 Perl 返回一个对象或其他兼容的数据结构到 Java？

我猜想写入一个文本文件并从 Java 中读取它会使使用 Perl 获得的所有优化变得毫无意义。

性能是这里的一个重要问题。

**编辑：** 从我在[这里](https://stackoverflow.com/questions/274840/how-can-i-call-perl-from-java)看到的情况来看，也许 Inline-Java 会是一个不错的选择？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T17:12:56.777

如果性能很重要，我建议运行持久的 Perl 进程。每次你想运行你的代码时启动一个 Perl 解释器将是一个相当大的开销。

最简单的通信方式是让 Java 进程打开与 Perl 进程的 TCP 连接，写入一些数据并取回一些数据。

您用于将数据从 Perl 进程发送回 Java 进程的格式将取决于您发送的内容以及您希望代码的通用性和可重用性。发回 XML 字符串会很好而且通用，但是发回用Perl 中的[pack](http://perldoc.perl.org/functions/pack.html)创建的字节数组，然后用 Java 中的[DataInputStream](http://java.sun.com/j2se/1.4.2/docs/api/java/io/DataInputStream.html)读取会快得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T16:53:56.370

[JSON](http://json.org/)是一种用于传递数据的简单、轻量级的格式。

您可以添加[Rhino](http://www.mozilla.org/rhino/)或与您的工具包类似的东西，并可能获得额外的性能（更不用说脚本引擎），但这取决于您计划项目的复杂程度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T16:43:10.607

如果您已经拥有 XML，那么您最好的选择可能是继续使用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-04T18:55:05.767

[内联::Java](http://search.cpan.org/perldoc?Inline::Java)。一旦您启动并运行它，它就会非常有效。几年前，我在做一个项目，其中有一个 Perl Web 应用程序与 Java SOAP 服务器进行实时通信，但速度太慢了。我们将其替换为使用 Inline::Java 进行通信的系统，并且速度更快。绝对最小化你来回传递对象的点，并尝试使这些对象简单（我们坚持使用字符串、数字和数组）以防止事情变得过于失控。但我绝对是一个皈依者！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T18:30:07.853

我还觉得奇怪的是，您用于解析 XML 的 perl 代码比 java 中的等效代码要快得多。但是，即使是这样，我也无法想象它会比 IPC 产生的开销更快。即使您使用持久的 perl 进程，您仍然必须向它发送数据，大概是通过套接字，然后取回一些数据，最后将其反序列化为可用的东西。

您是否尝试过提高 Java 中 XML 解析的性能？如果您使用的是 DOM 或第三方库（如 JDOM 或 castor），请尝试使用 SAX。或者也许只使用正则表达式而不是解析 XML 会更快（[尽管有 jwz）](http://www.jwz.org/hacks/marginal.html)。

在任何情况下，我都建议您先对您的 java 代码使用分析器，看看它是否可以改进。

# asp.net - Windows 上的持续集成堆栈与 Mercurial + Mercurial 队列？

> ID：611420
> 
> 赞同：6
> 
> 时间：2009-03-04T16:42:41.030
> 
> 标签：asp.net, mercurial, continuous-integration

我们一直在将 Mercurial 与 Mercurial 队列（+补丁保护）一起用于许多 Windows ASP.Net 项目的源代码控制。

我有兴趣为此建立一个持续集成环境，但在与 CC/Trac 等相互冲突的成功报告中迷失了方向。

我想知道还有谁在做这件事，你的应用程序/实用程序堆栈是什么？另外，如果您对工作流程有任何提示，我会全神贯注 :)

提前欣赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-02-18T21:27:53.263

我们一起使用 hudson 和 mercurial，并且非常成功。它们都足够灵活，可以满足您的任何需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T03:26:05.067

We are very happy using **Mercurial**/[**Kiln**](http://www.fogcreek.com/kiln/) with [**TeamCity**](http://www.jetbrains.com/teamcity/).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T20:22:26.717

我们正在使用[Trac](http://trac.edgewall.org)和[BuildBot](http://www.buildbot.net)。对于 Mercurial 的简单使用，效果相当不错。

两者都可以使用 Commit-hooks，但您可能需要深入挖掘一下，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T18:40:20.777

Which CruiseControl?

If the Java version I know people use it with both Trac and Mercurial, though I don't have the experience with those myself.

But you can ask on the CruiseControl [users mailing list](http://cruisecontrol.sourceforge.net/contact.html) to see what others are doing...

# wpf - WPF - 画布高度（以像素为单位）

> ID：611427
> 
> 赞同：4
> 
> 时间：2009-03-04T16:43:24.740
> 
> 标签：wpf, pixels

如何确定画布（具有一定宽度）的像素宽度？

我在 AnimatedImage 控件中有一个位图，并且我知道位图的宽度（以像素为单位），并且我想缩放位图以使其水平完全适合画布。我如何确定这个比例？

注意：我不需要使用 RenderTargetBitmap，因为位图已经加载。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-04T17:03:22.180

在 WPF 中，单位是独立于设备的。计算单位实际像素大小的公式是：

每个 WPF 单元的像素 = ConstantWPFUnit 大小 * 监视器 DPI；

以像素为单位的元素大小 = 每个 WPF 单位的像素 * MyElement.ActualWidth

恒定的 WPF 单元大小为 1/96。如果我没记错的话，监视器 DPI 可以作为从 SystemInformation.GetPrimaryMonitor 或类似返回的类中的属性找到。

FrameworkElement 的 ActualWidth 采用与设备无关的单位，是布局发生后元素实际占用的宽度。只需将此属性乘以您在上面计算的每个 WPF 单位的像素，您就会得到答案。

但是，我怀疑您进行了很多手动编码。以任何所需方式拉伸图像和其他视觉元素通常可以简单地通过在相关控件/画笔上设置属性来完成。您是否尝试过为包含位图的元素制作 Horizo​​ntalAlignment="Stretch" 和 VerticalAlignment="Center"？

# c# - 为什么我在比较 IIS 7 上的对象实例时遇到奇怪的问题？

> ID：611433
> 
> 赞同：0
> 
> 时间：2009-03-04T16:45:32.927
> 
> 标签：c#, .net, asp.net, iis-7, windows-server-2008

我有一个非常奇怪的问题，我无法通过比较 IIS 7 上的对象来解决。我们正在在 IIS 7 上部署基于 IIS 6 的旧 ASP.NET 应用程序，但是我们有这个相等比较问题，我们可以似乎没有弄清楚。

首先让我说我在 IIS 6 和 IIS 7 上都运行相同的程序集和代码，但是对象的比较与 IIS 6 和 IIS 7 上的相同代码不同。这是我的示例对象看起来像：

```
class Country : EntityBase {
    public int CountryID { get; set; }
    public string Name { get; set; }

    public override bool Equals(object obj) {
        if (obj == null || !(obj is Country))
            return false;

        Country c = (Country)obj;
        return CountryID == c.CountryID;
    }

    public override int GetHashCode() {
        return CountryID.GetHashCode();
    }
} 
```

我在 IIS 6 和 IIS 7 的 ASPX 页面中都有以下代码：

```
<% foreach(var country in proposalCountries) { %>
<%= country.Country.CountryID %>
<%= country.Country.CountryID.GetHashCode() %>
<%= country.Country.GetHashCode() %>

<%= proposalCountryServices.Count(c => c.Country == country.Country) %>
<%= proposalCountryServices.Count(c => (c.Country != null && country.Country != null) && c.Country.Equals(country.Country)) %>)
<%= proposalCountryServices.Count(c => Object.Equals(c.Country, country.Country)) %>
<% } %> 
```

这是我的结果：

### IIS 6：

```
100 <-- CountryID
100 <-- CountryID Hash Code
100 <-- Country Hash Code

1 <-- Something Found
1 <-- Something Found
1 <-- Something Found 
```

### IIS 7：

```
100 <-- CountryID
100 <-- CountryID Hash Code
100 <-- Country Hash Code

0 <-- Nothing Found
1 <-- Something Found
1 <-- Something Found 
```

Windows 2003 和 Windows 2008 上的 .NET 3.5 SP1 有区别吗？我真的不知道问题可能是什么。有没有人遇到过类似的问题？

### 更新1：

回答乔恩的问题。这两个集合是使用 NHibernate 加载的。但我觉得我应该重申 IIS 6 和 IIS 7 都使用**完全相同**的应用程序构建，所以除非 NHibernate 或 DynamicProxy2 正在改变基于 Windows 2003 或 Windows 2007 的加载方式，我无法做到在谷歌上找到任何东西，我不知道该怎么做。

每当我比较我的两个实体对象时，这也是一个系统范围的问题。所以它可能与 DynamicProxy2 包装器有关，但两个对象都是 Country 对象，并且考虑到我创建的覆盖，一切都应该在 IIS 6 和 IIS 7 中相同。

### 更新 2：

这似乎是 DynamicProxy2 或 NHibernate 问题。因为我尝试了以下代码：

```
<%
    var c1 = new ICost.Business.Entities.Country {
        CountryID = 100
    };
    var c2 = new ICost.Business.Entities.Country {
        CountryID = 100
    };
%>
<%= c1.CountryID == c2.CountryID %>
<%= c1.GetHashCode() == c2.GetHashCode() %>
<%= c1.Equals(c2) %>
<%= Object.Equals(c1, c2) %>
<%= c1 == c2 %> 
```

对于 IIS 6 和 IIS 7，结果都是, `true`, `true`, `true`, . 请参阅下面的答案，了解我为解决此问题所做的工作。`true``false`

### 更新 3：

这也可能与它有关： [看起来您忘记使用 IIS7 向 Windsor Castle 注册 http 模块](https://stackoverflow.com/questions/258011/problem-with-windsor-castle-with-iis7)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T17:39:38.007

你还没有解释什么`proposalCountries`和`proposalCountryServices`是。在我看来，您的 Equals 方法工作得很好，但在 IIS7 中它们包含不同的对象 - 您有两个具有相同 ID 的对象（因此 Equals 匹配）但它们是不同的对象，所以 == 不匹配.

请详细说明这两个集合是如何加载的——这可能是它的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T17:15:29.483

我看到的区别是你写的一个

```
c.Country == country.Country 
```

如果是两个，它是

```
c.Country.Equals(country.Country)) 
```

所以我猜想在后一种情况下他成功了，因为他在第一种情况下比较了两个对象的 CountryID，但是他正在比较对象本身。

为什么这在 IE6 下有效我不知道......对不起

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T17:17:47.683

您没有使用引用相等（见下文）。

Object.Equals 将在您的类型上调用重写的 Equals 方法。

我怀疑您已经从不同的 DataContexts 中提取了实体的不同实例，并将其添加到列表中，因此使用覆盖的 Equals 来尝试使其工作。

更新：

抱歉，不确定您是否使用的是 LINQ2SQL。

您可能可以通过覆盖 ==/!= 运算符来解决此问题，但也需要考虑一些因素。

更新 2：

要理解我的意思，请找到您认为相等的两个实例（正是发生此问题的位置）。设置断点。现在，进入 &obj1 和 enter 和 &obj2 并进入，你会注意到它们指向不同的对象地址。在 IIS 6 和 7 上执行此操作。

我不确定为什么它在 IIS6 和 IIS7 上的行为不同，但我怀疑页面生命周期中的细微差别可能是它们在引用上不相等的原因。

更新 3：

你是在 IIS7 的经典模式下运行的吗？如果没有，请尝试这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T18:47:06.550

这是对我有用的解决方案：

```
public static bool operator ==(BaseEntity a, BaseEntity b)
{
    return Object.Equals(a, b);
}

public static bool operator !=(BaseEntity a, BaseEntity b)
{
    return !Object.Equals(a, b);
} 
```

显然 NHibernate 或 DynamicProxy 在 Windows 2003 下做了某种魔术，以使“==”运算符在运算符过载的情况下正常工作。

# silverlight - 我可以在 Silverlight 中打印内容吗

> ID：611439
> 
> 赞同：0
> 
> 时间：2009-03-04T16:46:13.970
> 
> 标签：silverlight

Flash 提供了一种打印内容的简单方法。有没有办法在silverlight中做同样的事情

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T17:00:22.623

在 Onclick 处理程序中编写：

```
 window.document.execCommand("Print"); 
```

IE 会弹出一个打印对话框来提供打印选项

如果这不起作用，我在[这里找到了一个专注于 Silverlight 打印的人发布的博客](http://jonas.follesoe.no/PrintingInSilverlight2UsingCSSAndASPNETAJAX4.aspx)

# c# - 如何使用 LINQ 按 C# 中的特定时间戳间隔分组？

> ID：611441
> 
> 赞同：0
> 
> 时间：2009-03-04T16:46:17.090
> 
> 标签：c#, linq, datetime, group-by, intervals

我有一个包含刻度对象的列表，其中包括一对双精度值和一个时间戳。

我想根据时间间隔（例如 15 分钟）将列表分成子列表。一个列表仅包含来自以下时间的刻度对象：8:00:00 - 8:14-59 usw usw

### C#-代码：

```
var result = from tick in listTicks
group tick by tick.timestamp.Hour; 
```

像天、小时、分钟这样的`datetime`功能可以正常工作，但对我来说不可能有一个特定的时间间隔。

它是对象的 LINQ。我已经从数据库中获得了列表，我想转换列表。

如果我有每天 8-22 到 3 小时的数据，他以这种方式分开：

> 0-2;3-5;6-8;9-11

带代码：

```
var result = from tick in listTicks group tick by
(tick.timestamp.Day * 10 + tick.timestamp.Hour / 3); 
```

我想：

> 8-10；11-13；14-16；17-19；20-22

我希望它以这种方式分开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T16:59:55.450

```
var result = from tick in listTicks
group tick by (tick.timestamp - DateTime.MinValue).TotalMinutes / 15 into f
from c in f
select new { StartTime = DateTime.MinValue + TimeSpan.FromMinutes(c.Key),
             Items = ... }; 
```

已修复：DateTime.Now 会导致问题 :)

错误通知：不适用于 LINQ2SQL

修复：留给读者:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T17:32:00.707

在 SQL 数据库中创建一个计算列，将此表达式设置为日期并使其返回该日期表示的秒数。

然后，您可以按除值分组，它应该可以正常工作。如果除以 15 * 60，您将得到 15 分钟的组。

## 编辑：

```
var result = from tick in listTicks 
             group tick by tick.timestamp / (3 * 3600); 
```

为了使上述工作正常，时间戳应该是自某个纪元以来的秒数，如果您使用的是 SQL 服务器，这将是 SqlDateTime.MinValue。

# c# - 我可以在 ASP:Button 的 Text 属性中添加标签吗？

> ID：611449
> 
> 赞同：10
> 
> 时间：2009-03-04T16:48:35.803
> 
> 标签：c#, asp.net

我正在尝试做这样的事情：

```
<asp:Button ID="btnSearch" 
            runat="server" 
            CssClass="greybtn" 
            Text='<span>Search</span>'
            OnClick="btnSearch_Click" /> 
```

它显示`<span>Search</span>`而不仅仅是`Search`.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-08-04T07:52:42.450

您可以像这样在 ASP.NET LinkBut​​ton 上放置一个跨度：-

```
<asp:LinkButton ID="TestLinkButton" CssClass="btn btn-success" runat="server"><span class="glyphicon glyphicon-refresh"/>Press Me</asp:LinkButton> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T16:51:49.743

您不能将标记放在按钮内。asp:Button 控件只是呈现为输入按钮 HTML 标记：（`<input type="button" value="<span>Search</span>" />`技术上`value="&lt;span&gt;Search&lt;/span&gt;" />`）。浏览器将`value`属性的内容视为文字字符串。

但是，您**可以**将标记放在 a 中`<button><span>Search</span></button>`（您可以在其中放置相当多的 HTML，包括图像）。[这个问题](https://stackoverflow.com/questions/187482/how-can-i-use-the-button-tag-with-aspnet)讨论了构建一个发出`button`标签的控件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T06:16:58.917

您可以为此设置一个 asp linkBut​​ton：

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T16:52:28.760

不，它会呈现一个标签，因此无论您放在 Text 属性中的任何内容都会呈现为该按钮的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T17:00:06.930

text 属性会自动变成实体`<`和. 不仅如此，按钮作为元素呈现给 html，并在其属性中设置文本。`>``&lt;``&gt;``input``value`

您可能想要一个 HyperLink 或 Label 控件吗？

# excel - Excel 数据透视图线性时间刻度

> ID：611455
> 
> 赞同：4
> 
> 时间：2009-03-04T16:50:24.287
> 
> 标签：excel, time, charts, pivot

我有一个数据集（约 10000 行），格式如下：

```
+---------------------------+---------------+-------------+
| DateTimeCreated           | Machine       | ProductName |
+---------------------------+---------------+-------------+
| 2009-03-03 00:00:12.217   | COMP001       | Product001  |
+---------------------------+---------------+-------------+ 
```

我使用具有以下布局的数据透视表和图表对此进行了绘制

```
Page: ProductName
Column:  Machine
Row: DateTimeCreated - Group by Day, Hour, Minute
Data: Count of DateTimeCreated 
```

这一切都可以正常工作，但是结果图的时间尺度不是线性的。对于一天中没有发生我跟踪的事件的那些分钟，这些分钟不会显示在图表上。我正在跟踪的事件也可以持续数小时而不会发生，这会导致更加非线性的图表。

这是试图说明我的图表的 x 轴的尝试：

```
|09|   10    |  11  |         12         |14| 16 |      18        |  20  |23| 
```

期望的结果是：

```
|00|01|02|03|04|05|06|07|08|etc 
```

所以每个小时都是相同的大小，即使事件没有发生也会显示（所以在我的折线图中，这条线只是暂时变为 0）

这可以实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T22:28:41.017

我将数据集更改为如下所示

```
+---------------------------+---------------+-------------+-------+
| DateTimeCreated           | Machine       | ProductName | Count |
+---------------------------+---------------+-------------+-------+
| 2009-03-03 00:02:00.000   | COMP001       | Product001  |   2   |
+---------------------------+---------------+-------------+-------+ 
```

以便查询按分钟对事件进行分组并在分钟内提供计数

然后我生成了第二个数据集，其中包含一天中每一分钟的条目，但计数为 0 因为我只使用 24 小时数据集，所以这不是不合理的

结合这两个数据集在数据透视图上给出了一个线性时间线。

# ruby-on-rails - 如何使用指定的语言环境对 sqlite3 中的文本进行排序？

> ID：611459
> 
> 赞同：15
> 
> 时间：2009-03-04T16:50:51.057
> 
> 标签：ruby-on-rails, sqlite, locale, collation

默认情况下，Sqlite3 仅按 ascii 字母排序。我试图在谷歌中查找，但我发现的唯一内容是有关排序规则的信息。Sqlite3 只有`NOCASE`,`RTRIM`和`BIARY`排序规则。如何添加对特定语言环境的支持？（我在 Rails 应用程序中使用它）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-05T15:32:42.780

我接受了 Doug Currie 的回答，但我想添加一些“算法”如何做到这一点，因为 sqlite3 文档非常奇怪（至少对我而言）。

好的，我们有工作 sqlite3 现在：

1.  [下载 sqlite 的 ICU 扩展](https://www.sqlite.org/src/artifact?ci=trunk&filename=ext/icu/icu.c)

2.  编译它：

    ```
    gcc -shared icu.c `icu-config --ldflags` -o libSqliteIcu.so

    ```

    它适用于 Linux。我还需要安装额外的 ICU 开发包：

    ```
    sudo apt-get install libicu-dev

    ```

    我正在研究 64 位架构，但我遇到了错误`__relocation R_X86_64_32S__`（无论它是什么意思 :)。GCC 建议添加`-fPIC`编译选项，它有所帮助。

3.  运行 sqlite3。我们可以使用命令加载扩展：

    ```
    .load './libSqliteIcu.so'

    ```

    假设它在当前目录中，我们也可以指定整个路径。

4.  创建新的排序规则：

    ```
    选择 icu_load_collat​​ion('pl_PL', 'POLISH');

    ```

    第一个参数是所需的语言环境，第二个参数是它（可以是任何东西）。

5.  现在我们可以使用新的语言环境对数据进行排序：

    ```
    SELECT * FROM some_table ORDER BY name COLLATE POLISH;

    ```

    而且不区分大小写！

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-05T12:41:40.493

SQLite[支持](http://www.sqlite.org/src/doc/trunk/ext/icu/README.txt)与[ICU](http://icu-project.org/)集成。根据自述文件， `sqlite/ext/icu/README.txt` 该`sqlite/ext/icu/`目录包含 SQLite“ICU”扩展的源代码，它是“Unicode 国际组件”库与 SQLite 的集成。

```
1\. Features

    1.1  SQL Scalars upper() and lower()
    1.2  Unicode Aware LIKE Operator
    1.3  ICU Collation Sequences
    1.4  SQL REGEXP Operator 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-01T23:59:24.327

如果你负担不起编译 ICU 扩展的费用，你可以让 UDF 做同样的事情。在 PHP/PDO 中：

```
$pdo->sqliteCreateFunction('locale',
    function ($data, $locale = 'root')
    {
        static $collators = array();

        if (isset($collators[$locale]) !== true)
        {
            $collators[$locale] = new \Collator($locale);
        }

        return $collators[$locale]->getSortKey($data);
    }
); 
```

示例用法：

```
SELECT * FROM "table" ORDER BY locale("column", 'pt_PT'); 
```

我不希望这种方法与原生扩展一样高效，但它肯定更便携。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-17T15:21:03.120

正如 Doug Currie 回答的那样，可以通过加载[SQLite“ICU”扩展名来正确排序重音字符](https://www.sqlite.org/src/artifact?ci=trunk&filename=ext/icu/README.txt)

需要编译扩展，如 kiew 自己的答案中所述。但是，ICU 自述文件和 kiew 的回答中给出的库名称对我不起作用。[这个其他答案](https://stackoverflow.com/a/52876577/111036)建议改用名称`libicu.so`。

所以这就是在 Ubuntu 16.04 和 Debian 9.8 Stretch 上对我有用的方法：

```
sudo apt install libicu-dev libsqlite3-dev dpkg-dev gcc make
apt-get source sqlite3
cd sqlite3-*/ext/icu       # assuming you have only 1 sqlite3 source directory
gcc -shared icu.c `icu-config --ldflags` -fPIC -o libicu.so
sudo cp libicu.so /usr/local/lib/
sudo ldconfig 
```

之后在 sqlite3 中，您可以

```
.load libicu
SELECT icu_load_collation('', 'ICU'); 
```

的 2 个参数`icu_load_collation`是语言环境和自定义名称。语言环境似乎是可选的，可以留空。然后可以看到自定义名称

```
PRAGMA collation_list; 
```

它可以用作

```
SELECT col FROM tbl ORDER BY col COLLATE ICU; 
```

# java - Tomcat 找不到我的 Servlet 并抛出异常，但为什么呢？

> ID：611465
> 
> 赞同：10
> 
> 时间：2009-03-04T16:52:57.777
> 
> 标签：java, tomcat

我正在尝试进入 Java Web 开发，但似乎遇到了 Tomcat 和一个非常简单的 servlet 的一个奇怪问题。每次我尝试加载应用程序时，catalina 日志都会喷出这个：

```
Caused by: java.lang.IllegalArgumentException: Servlet mapping specifies an unknown servlet name MyServlet
    at org.apache.catalina.core.StandardContext.addServletMapping(StandardContext.java:2393)
    at org.apache.catalina.core.StandardContext.addServletMapping(StandardContext.java:2373)
    ... 40 more
Mar 4, 2009 10:37:58 AM org.apache.catalina.startup.ContextConfig applicationWebConfig
SEVERE: Parse error in application web.xml file at jndi:/localhost/mywebapp/WEB-INF/web.xml
java.lang.IllegalArgumentException: Servlet mapping specifies an unknown servlet name MyServlet 
```

有道理。它似乎找不到我的 servlet。但是，servlet 似乎在正确的位置。我可以在**WEB-INF/classes/MyServlet.class清楚地看到它**

作为参考，这是我当前使用的 web.xml 文件：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" version="2.5"> 
    <description>My first web app in Java.</description>
    <display-name>My Web App</display-name>

    <servlet>
        <servlet-name>MyServlet</servlet-name>
        <servlet-class>MyServlet</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>MyServlet</servlet-name>
        <url-pattern>/myservlet</url-pattern>
    </servlet-mapping>
</web-app> 
```

正如你所看到的，我保持简单......但它不断抛出这个异常。Java 中的基本 Web 应用程序是什么样的，我缺少哪些组件？

**更新**

为了绝对确定它不是某种人工制品，我启动了一个新的 Tomcat 副本并再次尝试。这样做后，这开始出现在日志文件中：

```
SEVERE: Error deploying web application archive mywebapp.war
java.lang.UnsupportedClassVersionError: Bad version number in .class file (unable to load class MyServlet) 
```

我为 MyServlet 类转储了我的 .class 文件，使用 -target 1.5 对其进行了重建，重新打包了 .war，一切正常。

十分感谢你的帮助！故障排除的一个很好的教训永远不会伤害任何人。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-04T18:42:35.797

好吧，鉴于更新的信息，您的问题似乎是您用于类的编译器可能是比运行 Tomcat 的版本更新的 JDK 版本。

检查用于启动 Tomcat 的 JDK 版本，然后看看您是否可以做一些事情来协调该版本与用于编译 servlet 的版本之间的差异。

那应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T17:15:14.367

下面的行是否**完全**来自您的`web.xml`？Tomcat 找到映射`/myservlet`到名为“ `MyServlet`”的 servlet 的 servlet 映射，但抱怨它找不到任何具有该名称的 servlet 定义。案件很重要。您提供的内容看起来正确，但请仔细检查`web.xml`以确保大小写正确。仔细检查`web.xml`目录中 Tomcat 使用它的位置`mywebapp/WEB-INF/web.xml`

```
<servlet>
    <servlet-name>MyServlet</servlet-name>   <-- Check this name
    <servlet-class>MyServlet</servlet-class>
</servlet>

<servlet-mapping>
    <servlet-name>MyServlet</servlet-name>  <-- Compare against this name
    <url-pattern>/myservlet</url-pattern>
</servlet-mapping> 
```

如果不是这样，请告诉我们。但这些名称区分大小写。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T17:14:41.920

如果 MyServlet 类位于包中，则应在 servlet-name 节点中使用包点类表示法将其列出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T17:17:49.370

几个提示：

*   您的 servlet 类是否扩展了 HttpServlet？
*   文件系统权限怎么样-那里有任何可能的问题吗？
*   也许，也尝试将类移动到命名包（myservlet.MyServlet）

一般来说，还要尝试在日志中查找更多异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T17:00:47.087

有没有旧版本的`web.xml`潜伏在某个地方，没有`<servlet>`障碍？

也许`find . -type f -name web.xml`在tomcat的目录中做一个（或类似的Windows）？

# sql - sybase sql将秒值转换为小时分钟和秒的方法

> ID：611466
> 
> 赞同：1
> 
> 时间：2009-03-04T16:53:10.020
> 
> 标签：sql, date, sybase

在 sybase 中是否有任何内置函数可以将秒值转换为小时、分钟和秒？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-07T12:45:24.897

如果您希望结果格式为小时：分钟：秒

```
select convert(varchar(8), dateadd(SECOND, 65, '1970-01-01'), 108) 
```

传递 65 作为我们的秒数导致...

```
00:01:05 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T17:14:15.150

不知道有没有这样的功能，如果没有，简单的公式是：

```
 HH = floor(seconds / 3600)
 MM = floor(seconds / 60) % 60
 SS = seconds % 60 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T17:23:22.477

如果它的价值限制为 1 天，您可以使用：

```
datepart(hour, dateadd(second, value, '1900-01-01'))
datepart(minute, dateadd(second, value, '1900-01-01'))
datepart(second, dateadd(second, value, '1900-01-01')) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T03:32:01.997

一个常见的“秒”维度是“自 unix 纪元以来的秒数”或“time_t”。如果这是您所指的，您可以执行类似的操作

```
选择日期添加（秒，123456，'1970-01-01'）

```

您将拥有一个日期时间值，可以通过 DATEPART 将其解构为各个部分

pjjH

# iphone - 在 OpenGL ES 中，如何将屏幕坐标转换为世界坐标？

> ID：611468
> 
> 赞同：1
> 
> 时间：2009-03-04T16:53:21.707
> 
> 标签：iphone, opengl-es

这适用于 2D 游戏，因此只有 x 和 y 轴。游戏在 iPhone 上处于横向模式。我希望能够设置渲染纹理的屏幕 x 和 y 坐标。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T17:09:48.420

如果你在做一个 2D 游戏，你可以设置你的投影和模型视图矩阵，这样你根本不需要转换：

```
// This goes in your init code somewhere
// Set up 480x320 orthographic projection
glMatrixMode(GL_PROJECTION);
glLoadIdentity();
glOrthof(-240.0f, 240.0f, -160.0f, 160.0f, -1.0f, 1.0f);

// Rotate into landscape mode
glMatrixMode(GL_MODELVIEW);
glLoadIdentity();
glRotatef(-90.0f, 0.0f, 1.0f, 0.0f); 
```

这使得世界坐标 (-240, -160) 映射到屏幕的左上角（横向模式下的左下角）， (240, 160) 映射到右下角（横向模式下的右上角）等。由于 iPhone 的屏幕是 480x320，因此您不需要在世界坐标和屏幕坐标之间转换，并使用这样设置的矩阵。

当然，如果您希望能够移动相机，那么您需要根据相机的位置进行偏移。

# html - 为安全起见对 HTML 输入进行编码时，如何避免对 Ñ 或 ñ 等国际字符进行编码？

> ID：611471
> 
> 赞同：5
> 
> 时间：2009-03-04T16:54:00.720
> 
> 标签：html, asp.net-mvc, security, encoding

我在 ASP.NET MVC 应用程序中有一个文本区域，用户可以在其中键入一些文本。当我向用户显示文本时，我使用它`Html.Encode`来防止恶意输入。问题是用户可以输入西班牙语，也许他输入`año`并将其`Encode`转换为`a&#241o`. 我怎样才能防止这种情况？

编辑：在生成的 HTML 中，我看到：

```
<a href="a1-'a1'-Cama&amp;#241;o?sort=estadisticas#241;o">a1 'a1' Cama&amp;#241;o</a> 
```

在页面后面我有这个，这次显示是正确的：

```
<b>a1 'a1' Cama&#241;o</b> 
```

第一个是这样生成的：

```
<%= Html.RouteLink(Html.Encode(Model.NAME),  ...... %> 
```

第二个是这样的：

```
<%= Html.Encode(Model.NAME)%> 
```

所以我的猜测是问题出在`Html.RouteLink`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T16:59:06.653

您是否不小心编码*了两次？*

例如，如果您在服务器端以编程方式设置 Textarea 的内容，它将在渲染时自动对内容进行编码。

尝试查看 textarea 的原始 HTML 输出。

通常，当您在 textarea 内容中放置转义符时，它应该显示在已解码的 textarea 中（显示为预期的未转义字符）。

所以这可能是一个意外 Html.Encode 不必要的问题。

如果您的数据已经转义，您可能希望在将其放入 textarea 之前取消转义（Html.Decode）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T18:42:44.390

> 所以我的猜测是问题出在 Html.RouteLink

是的。您不应该对进入 RouteLink 的参数进行 HTML 编码，它会自己生成 HTML，因此会为您处理转义。

# windows - WinQual：为什么 WER 不接受代码签名证书？

> ID：611472
> 
> 赞同：29
> 
> 时间：2009-03-04T16:54:30.453
> 
> 标签：windows, error-reporting, winqual, bumptop

*2015 年1 月 24 日编辑*：现在无法使用其他受信任的证书颁发机构。一问一答并不过时：

WinQual 仍然拒绝签名：

![在此处输入图像描述](https://i.stack.imgur.com/vkivZ.png)

当我们已经确定它是一个有效的数字签名时：

![在此处输入图像描述](https://i.stack.imgur.com/Ld1JC.png)

为了完整起见，我将在下面留下*其他人*所做的编辑；只是为了指出他错了。他可以忍受这种耻辱：

* * *

*自 2014 年起编辑：现在可以使用其他受信任的证书颁发机构。问与答已过时。*

* * *

2005 年，我尝试在 Microsoft 建立一个 WinQual 帐户，这样我就可以获取通过 Windows 错误报告 (WER) 自动提交的（如果有的话）崩溃转储文件。我不允许进行故障转储，因为我没有 Verisign 证书。相反，我有一个更便宜的，由 Verisign 的子公司生产：Thawte。

* * *

您加入的方法是：您对他们提供的示例 exe 进行数字签名。这证明您与签署应用程序的签名者是同一个签名者，他们从野外获得了崩溃转储。

在密码学上，需要私钥才能在可执行文件上生成数字签名。只有该私钥的持有者才能为匹配的公钥创建签名。谁生成了该私钥并不重要。这包括从以下位置生成的证书：

*   自签名
*   [富国银行](http://en.wikipedia.org/wiki/Wells_Fargo)
*   数字证书
*   安全信托
*   信任软件
*   [夸瓦迪斯](http://en.wikipedia.org/wiki/QuoVadis)
*   [去吧爸爸](http://en.wikipedia.org/wiki/GoDaddy)
*   [委托](http://en.wikipedia.org/wiki/Entrust)
*   [网络信任](http://en.wikipedia.org/wiki/Cybertrust)
*   [地理信托](http://en.wikipedia.org/wiki/GeoTrust)
*   [环球信](http://en.wikipedia.org/wiki/GlobalSign)
*   [科莫多](http://en.wikipedia.org/wiki/Comodo)
*   [解冻](http://en.wikipedia.org/wiki/Thawte)
*   威瑞信

然而微软的 WinQual 只接受威瑞信生成的数字证书。甚至 Verisign 的子公司都不够好（Thawte）。

谁能想到微软不想接受代码签名证书的任何技术、法律或道德原因？WinQual 网站说：

> **为什么 Winqual 会员资格需要数字证书？**
> 
> 数字证书有助于保护您的公司免受试图冒充您的员工或以其他方式对您的公司实施欺诈行为的个人的侵害。使用数字证书可以证明用户或组织的身份。

Thawte 数字证书是否不安全？

* * *

两年后，我向 WinQual 发送了提醒通知，我一直在等待能够获得我的故障转储。WinQual 团队的回应是：

> 你好，
> 
> 感谢您的提醒。我们已通知相关人员这仍然是一个请求。

* * *

2008 年，我在 Microsoft 支持论坛上[提出了这个问题，得到的回应是：](http://social.msdn.microsoft.com/Forums/en-US/isvwindowserrors/thread/92419a64-af22-4527-bcf4-eeeb0d2423cd/)

> 我们现在只设置接受 VeriSign 证书。我们对支持其他类型的证书的需求并不强烈。

不“设置”接受其他类型的证书可能意味着什么？

如果签署 WinQual.exe 测试应用程序的密钥的指纹与签署可执行文件的指纹相同，那么你在野外得到的故障转储：证明 -*它们是我的故障转储，把它们给我。*

与所有其他数字签名相反，并没有一个特殊的 API 来检查 Verisign 数字签名是否有效。无论谁生成密钥，有效的签名都是有效的。

Microsoft**可以**不*信任*签名者，但这与身份不同。

* * *

所以这是我的问题，谁能想到 WinQual 没有设置为支持数字签名的任何实际原因？

一个人推测答案是他们只是懒惰：

> 我不知道，但我会假设运行 winQual 系统的团队是一个实时团队，而不是一个开发团队——例如，面向维护现有系统的个性和技能。不过我可能是错的。

他们不想做改变它的工作。但是任何人都可以想到需要改变的东西吗？无论生成密钥是什么，这都是相同的逻辑：“指纹是否匹配”。

我错过了什么？

* * *

## 更新

很高兴听到其他开发人员的故事。这样我就知道我并不孤单，这个问题可以作为微软改变的工具。即使我最初的意图是抱怨咆哮，为了保持这个有效的 StackOverflow 问题，我正在寻找微软只能接受 Verisign 证书的技术*原因。*

加密 API 不关心颁发证书的公司的名称是什么：它只关心签名者链返回到受信任的根。

微软没有使用已建立的加密基础设施，而是仅限于威瑞信，这可能会发生什么？

如果有人能指出任何博客条目，其中项目经理或开发人员解释了**原因**，我也许会感到满意。

* * *

## 更新二

人们似乎错过了我的问题的重点。Windows 已经拥有代码基础结构以确保数字签名证书受到根授权机构的信任。这是我们签名的可执行文件之一的数字签名屏幕截图。

您可以看到我们的证书是由 Thawte 的 Code-Signing authority 证书签名的，而该证书又是由 Thawte 签名的：

[![替代文字](https://i.stack.imgur.com/79a2A.png)](https://i.stack.imgur.com/79a2A.png)

Windows 默认附带“解冻”证书：

[![替代文字](https://i.stack.imgur.com/rAIpA.png)](https://i.stack.imgur.com/rAIpA.png)

**Thawte Premium Server CA**足够好，Windows 和 Internet Explorer 的每个副本都已经信任它。并且已经有一个既定的 API 来检查证书是否有效（即受信任）。

当 WinQual 人出现时，他们不得不**竭尽全力**避免检查正确的方法，而是推出了自己的解决方案，仅将 Verisign 硬编码为受信任的根。**为什么**他们会**竭尽全力**忽略其他受信任的根权限，即*在运行其代码的 Windows 机器上提供的*权限，而是硬编码 Verisign？

他们没有像其他人那样做（Windows Explorer、Firefox、Chrome、Internet Explorer、Opera、CertMgr 等），而是*专门*只允许 Verisign。我的问题是为什么。

`Why would WER not accept code-signing certificates?`

如果它只是：

*   因为最初写它的人不知道正确的方法离开他的头顶
*   而不是花费大量时间研究正确的方法
*   他只是把东西扔在一起
*   只是为了测试，他只硬编码了一个签名者
*   完全打算稍后回来并修复它
*   但代码现在正在运行
*   它在没有被修复的情况下上线了
*   没有人愿意承担破坏它的责任
*   没有人愿意花钱修理它
*   并且没有足够的客户抱怨将其作为重中之重
*   即使有很多人抱怨，买一个威瑞信也只要 99 美元
*   所以你不能放手去买一个威瑞信吗？

……这样就好了。除了我不相信。我不相信这是投入生产的测试代码。我觉得这是一个有意识的、具体的决定，让他们忽略了其他签名者。他们所做的，并将继续，只对威瑞信表示敬意。

但是对于我的生活，我想不出原因。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-14T15:39:28.890

好吧，我刚刚发布了另一个请求，基本上告诉他们我们不会参与，除非他们接受 Comodo 代码签名证书。

Microsoft 联系我们，告诉我们他们希望我们查看有关 Windows 7 的报告，但我们无法登录，因为我们不使用 Verisign。好的，你联系了我……我还需要多少认证？

我已经联系了产品经理，我们看看会发生什么。

并回答您上面的半反问问题 - 他们没有理由不能验证其他签名的 EXE。Windows 做到了，IE 做到了，代码已经在里面了。他们不需要做任何特别的事情来支持它。

更新：

在与 Microsoft 代表交谈后，我被告知您必须至少购买 99 美元的 versign 证书才能“验证”并获取您的错误报告。瘸。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-10-18T06:15:52.570

我刚刚注册了 WinQual，我一直在思考这个问题；我想我现在有了答案。

简而言之：**他们根本没有使用 VeriSign 作为证书：他们只是将验证您身份的任务外包出去。**

Microsoft 不希望您在没有首先验证您的身份的情况下访问 WinQual 站点。所以他们需要一个身份验证过程。

他们可能有一个部门向您收取 99 美元的费用并进行验证。但他们已经在威瑞信拥有大量股份，而威瑞信已经拥有可以做到这一点的员工。因此，他们使用注册证书的过程来验证您的身份。它根本不使用证书，它只是委托 VeriSign 完成验证您的任务。

请注意，他们不需要您继续维护 VeriSign 证书来保留您的帐户：这只是加入该网站的一次性费用。

因为这是 Microsoft 验证您身份的案例，并且他们信任 VeriSign，因为他们参与其中，而且他们不太信任 Comodo，他们希望您为此目的使用 VeriSign，而不是任何其他证书。从开发人员的角度来看，这似乎有点傻，但从他们的角度来看，我可以理解。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-08-09T09:57:46.143

完成代码签名和最近的 Winqual 注册后，这里有一些说明：

1.  对于 Winqual 注册（注册），不会根据 Winqual 数据库检查您的签名本身。Winqual 仅检查来自 VeriSign 的证明 VeriSign 检查了您的身份的证书。然后他们从您的签名中获取您的公司名称。

2.  在下一步中，您必须创建一个或多个“产品映射文件”（使用 Microsoft 的工具）并将它们上传到 Winqual。之后，Winqual 服务器会针对所有地图文件检查数 TB 的崩溃数据库，并为您提供“事件”列表。（因此，您用于代码签名的签名是无关紧要的。）

3.  Microsoft 不能接受其他证书颁发机构也没有技术原因。但是：他们将如何从中受益？还有一个特价计划，只需 99 美元即可从 VeriSign 获得为期一年的代码签名证书，如果将其与开发工具链或 MSDN/TechNet 会员资格的成本进行比较，它并不十分昂贵。

4.  在我们的案例中，从 VeriSign 获得证书非常简单且非常快速 - 整个过程在两天内完成。（我们不在美国，所以我预计会延迟。） [只是为了澄清：您自己生成签名，它由 company_private_key（用于签名）和 company_public_key（用于验证您的代码签名）组成。任何证书颁发机构（如 VeriSign）只需使用其私钥对您的 company_public_key 进行反签名。这使您的证书可验证。]

5.  我们不知道 VeriSign 99 美元的证书也可以用于代码签名（它**不仅仅是**一个组织 ID）。所以最初我们选择了另一个 CA 来进行代码签名。然后我们获得了用于 Winqual 注册的 VeriSign 证书。

6.  Microsoft 在 WHDC 和 Winqual 上发布了哪些签名提供者可以接受哪些类型的签名的信息。在从另一个 CA 获得证书之前，您不能真的责怪他们自己没有阅读此内容，对吗？

希望这可能有助于阐明一些观点。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-11-04T23:09:15.973

同样的故事，我正在认证 Win7 徽标的申请，以获得 MS 合作伙伴计划的积分。我购买了 Comodo 代码签名证书。该应用程序通过了测试，现在我正在尝试设置一个 Winqual 帐户，在最初对必须购买另一个签名证书感到生气之后，我延迟了 5 天，试图以 99 美元的价格实际购买这个“组织证书”。没办法，“ *VeriSign SSL 证书注册暂时不可用。请稍后再试。*”，而且支持也可能是我遇到过的最糟糕的。OMG ...请至少尝试阅读问题描述，甚至尝试重现步骤，不要只是给我一些愚蠢的知识库解决方案来解决另一个问题还是说服务不可用，5天后就可以了。好郁闷……

如果有人有同样的问题，只是一个更新，我终于得到了注册问题的答案并下订单。（我想你需要找到合适的技术支持人员：）

*在颁发证书之前，我们将在我们的系统中编辑订单并为您输入正确的公司和国家/地区值。我们发给您的证书将包含正确的信息。”*

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-22T15:58:28.920

哈！我遇到了与我们的 Comodo 证书完全相同的方案。这是典型的欺凌行为，他们的回答完全是胡说八道。如果有的话，我不信任 Verisign，而不是 Comodo 和 Thawte 等。让我们不要忘记他们[前一段时间尝试过的](http://jeremy.zawodny.com/blog/archives/000970.html)东西。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-02-08T12:34:56.793

这是一个支持更改的地方：[https ://connect.microsoft.com/site831/feedback/details/531903/allow-other-certificates-in-winqual-not-only-verisign](https://connect.microsoft.com/site831/feedback/details/531903/allow-other-certificates-in-winqual-not-only-verisign)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-04T16:59:31.317

我们遇到了同样的问题。他们不会接受 Comodo 代码签名证书。很可能是为了增加他们的团体收入（MS 拥有的 VeriSign/VeriTest）。我不相信他们没有收到*大量*使用非 VeriSign 证书的请求。但是你有什么选择......？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-10-27T07:02:39.487

问题实际上更深。

为了保持特殊地位，必须对我们的一种产品进行重新认证。当然，这只能通过 VeriTest 来完成。为了节省资金并能够在他们注意到问题之前对其做出响应，我们决定选择自测选项，该选项允许我们使用 Microsoft 的所谓“Works with”工具自行测试我们的软件。

虽然文档说您需要使用身份验证证书对所有二进制代码进行签名才能通过 Windows Server 2008 R2 的验证，但没有人提到这实际上是可选的并且不会对测试结果产生影响（直到您实际使用报告页面说此步骤是可选的，不会对测试结果产生影响）。

然而，在那之前我们已经购买了 Comodo 证书，因为它只是 VeriSign 证书价格的四分之一，而且无论如何都做同样的事情。

在成功重新认证后不久，我们收到了来自微软的关于当前虚拟发布活动的通知，以及参与其中的可能性（这是一件很棒的事情）。但是，要注册，我们需要输入 WinQual 并猜测什么……当然，我们需要 VeriSign WinQual 公司证书（至少）。

现在真正有趣的是，至少有两天时间，相应的 VeriSign 网站都无法访问。再过三天，不可能获得这样的证书，直到现在他们甚至没有回应支持请求。

如果其他公司开始托管类似于 WinQual 的平台，除了它确实接受所有严肃出版商的证书，那不是很好吗？

乔尔......杰夫，......来吧。那是给你的东西：

**“[...] exhandler.com 就像 winqual，...但没有邪恶。”**

# java - 既然我们在 java 中有注解，那么 xdoclet 是遗留的吗？

> ID：611473
> 
> 赞同：2
> 
> 时间：2009-03-04T16:54:32.857
> 
> 标签：java, annotations, xdoclet

我偶然发现了 xdoclet 项目，发现它非常受欢迎。所以问题是，现在我们在 java 中有注释：xdoclet 是遗留的吗？

或者我没有看到/理解的 xdoclet 有什么东西。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-04T16:56:25.473

`XDoclet`是通过`JavaDoc`. 任何可以用`XDoclet`（以及更多）完成的事情都可以用`JDK5+`注释来完成。

然而，一个明显的区别是它`XDoclet`是非*侵入性的*。也就是说，它不需要您将类导入到您自己的代码中。如果您在自己的代码中使用第 3 方 Java 注释，那么您当然无法在没有第 3 方 jar 存在的情况下构建您的代码。这不是 XDoclet 的缺点。（您可能根本不认为这是一个缺点。）

当然，即使`XDoclet`可能是遗留问题，我怀疑对于大多数严重依赖它的项目，不会急于迁移到使用注释（格言：如果它没有坏，就不要修复它）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T17:09:25.800

希望 XDoclet 成为历史。正如已经指出的那样，您需要包含来自注释提供者的某种工件，通常是某种 api 模块。这只会加强我们在 java 中习惯的强类型化方面，允许所有现代 ide 中的各种自动跟踪/跟踪和适当的工具支持。

# css - 更改下拉箭头的颜色和外观

> ID：611482
> 
> 赞同：70
> 
> 时间：2009-03-04T16:57:21.477
> 
> 标签：css, drop-down-menu

我想更改下拉列表箭头的默认外观，以便在浏览器中看起来相同。有没有办法使用 CSS 或其他方式覆盖下拉箭头的默认外观？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-01-31T03:10:23.487

您可以使用 CSS 实现这一点，但您并没有在技术上更改箭头本身。

在此示例中，我实际上隐藏了默认箭头并显示了我自己的箭头。

```
.styleSelect select {
  background: transparent;
  width: 168px;
  padding: 5px;
  font-size: 16px;
  line-height: 1;
  border: 0;
  border-radius: 0;
  height: 34px;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  color: #000;
}

.styleSelect {
  width: 140px;
  height: 34px;
  overflow: hidden;
  background: url("images/downArrow.png") no-repeat right #fff;
  border: 2px solid #000;
}
```

```
<div class="styleSelect">
  <select class="units">
    <option value="Metres">Metres</option>
    <option value="Feet">Feet</option>
    <option value="Fathoms">Fathoms</option>
  </select>
</div>
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-04T17:00:26.713

不，跨浏览器表单自定义即使不是不可能，也很难适用于所有浏览器。如果您真的关心这些小部件的外观，您应该使用 javascript 实现。

见[http://www.456bereastreet.com/archive/200409/styling_form_controls/](http://www.456bereastreet.com/archive/200409/styling_form_controls/) 和[http://developer.yahoo.com/yui/examples/button/btn_example07.html](http://developer.yahoo.com/yui/examples/button/btn_example07.html)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2017-03-04T16:53:40.053

可以通过以下方式完成：

```
select{
  background: url(data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0Ljk1IDEwIj48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6I2ZmZjt9LmNscy0ye2ZpbGw6IzQ0NDt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPmFycm93czwvdGl0bGU+PHJlY3QgY2xhc3M9ImNscy0xIiB3aWR0aD0iNC45NSIgaGVpZ2h0PSIxMCIvPjxwb2x5Z29uIGNsYXNzPSJjbHMtMiIgcG9pbnRzPSIxLjQxIDQuNjcgMi40OCAzLjE4IDMuNTQgNC42NyAxLjQxIDQuNjciLz48cG9seWdvbiBjbGFzcz0iY2xzLTIiIHBvaW50cz0iMy41NCA1LjMzIDIuNDggNi44MiAxLjQxIDUuMzMgMy41NCA1LjMzIi8+PC9zdmc+) no-repeat 100% 50%;
} 
```

```
select{
  background: url(data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0Ljk1IDEwIj48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6I2ZmZjt9LmNscy0ye2ZpbGw6IzQ0NDt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPmFycm93czwvdGl0bGU+PHJlY3QgY2xhc3M9ImNscy0xIiB3aWR0aD0iNC45NSIgaGVpZ2h0PSIxMCIvPjxwb2x5Z29uIGNsYXNzPSJjbHMtMiIgcG9pbnRzPSIxLjQxIDQuNjcgMi40OCAzLjE4IDMuNTQgNC42NyAxLjQxIDQuNjciLz48cG9seWdvbiBjbGFzcz0iY2xzLTIiIHBvaW50cz0iMy41NCA1LjMzIDIuNDggNi44MiAxLjQxIDUuMzMgMy41NCA1LjMzIi8+PC9zdmc+) no-repeat 100% 50%;

    -moz-appearance: none;
    -webkit-appearance: none;
    -webkit-border-radius: 0px;
    appearance: none;
    outline-width: 0;

    padding: 10px 10px 10px 5px;
    display: block;
    width: 10em;
    border: none;
    font-size: 1rem;

    border-bottom: 1px solid #757575;
  }
```

```
<div class="styleSelect">
  <select class="units">
    <option value="Metres">Metres</option>
    <option value="Feet">Feet</option>
    <option value="Fathoms">Fathoms</option>
  </select>
</div>
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-04T17:01:26.133

元素由应用程序生成，`<select>`样式不是 CSS/HTML 规范的一部分。

您必须使用自己的 DIV 伪造它并将其覆盖在现有 DIV 之上，或者构建自己的控件来模拟相同的功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T17:02:32.400

不，你不能通过使用实际的`<select>`.

这是一篇关于该主题的好文章：[<select> 新事物](http://v2.easy-designs.net/articles/replaceSelect/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T17:07:57.473

恐怕不容易做到。问题是 Css 无法替换选择中的箭头，因为这是由浏览器呈现的。但是您可以从 div 和 input 元素以及 Javascript 构建一个新控件，以执行与 select 相同的功能。

例如，尝试查看一些 Jquery 的自动完成插件。

否则这里有一些关于 select 元素的信息：

[http://www.devarticles.com/c/a/Web-Style-Sheets/Taming-the-Select/](http://www.devarticles.com/c/a/Web-Style-Sheets/Taming-the-Select/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-13T01:21:13.533

我们用过YUI，Chosen，目前正在使用jQuery Select2插件：[https ://select2.github.io/](https://select2.github.io/)

它非常强大，箭头只是冰山一角。

一旦风格化选择成为要求，我同意其他人的意见，使用插件。不要杀死自己重新发明轮子。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-04T17:02:50.717

除非您打算创建自己的下拉列表（而不是使用标准库下拉列表），否则您会被卡住。DDL 控件的外观将取决于您正在运行的系统和/或呈现输出的浏览器。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-04-27T06:46:50.587

尝试将“border-top”属性的颜色更改为白色

# log4net - 以编程方式配置 RollingFileAppender 日期滚动

> ID：611483
> 
> 赞同：3
> 
> 时间：2009-03-04T16:57:21.960
> 
> 标签：log4net

我正在以编程方式在 log4net 中配置 RollingFileAppender。我目前有这样的事情：

```
RollingFileAppender fa = new RollingFileAppender();
fa.AppendToFile = true;
fa.RollingStyle = RollingFileAppender.RollingMode.Date;
fa.DatePattern = "yyyyMMdd";
fa.StaticLogFileName = true;
// Set more properties and add the appender to the root repository 
```

这拒绝根据日期滚动日志。如果我将 RollingStyle 切换为 Size 或 Composite，它将滚动，但仅基于大小，而不是基于日期。我尝试删除 StaticLogFileName 并使用 DatePattern 无济于事。

我必须以编程方式配置它，因为我不知道运行时附加器的数量，所以使用 XML 配置它，我过去已经能够使用它，这是不行的。有人有什么想法吗？我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T16:19:48.227

这种行为是因为 RollingFileAppender（以及许多其他附加程序以及过滤器）实现[了 IOptionHandler 接口](http://logging.apache.org/log4net/release/sdk/log4net.Core.IOptionHandler.html)，该接口“允许对象延迟激活其选项，直到所有选项都已设置。这是具有相关选项的组件所必需的在所有设置完成之前仍然模棱两可”。

更进一步：“在设置配置属性后，必须在此对象上调用[ActivateOptions](http://logging.apache.org/log4net/release/sdk/log4net.Core.IOptionHandler.ActivateOptions.html)方法。在调用 ActivateOptions 之前，此对象处于未定义状态，不得使用。”

通过 xml 文件配置适配器时，您不必考虑激活，因为它是由 log4net 配置器完成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T16:55:25.803

在设置文件附加程序之后但在将附加程序添加到层次结构之前，我添加了对 ActivateOptions() 的调用，这似乎有效。为什么有些选项在没有调用的情况下就卡住了，而另一些选项却没有，这是另一天的问题。

# tfs - 是否可以使用 TFS SDK 来创建、排队和跟踪构建？

> ID：611485
> 
> 赞同：8
> 
> 时间：2009-03-04T16:57:47.343
> 
> 标签：tfs, sdk, build-automation

我一直在谷歌搜索，找不到任何可靠的例子是如何做到的，或者是否可以做到。我认为它可以。谁能指出我正确的方向？

到目前为止，我一直在查看 msdn 上的 TFS 命名空间文档。我的目标是能够从 Intranet Web 应用程序完全自动化和跟踪我们在 TFS 中的构建。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-04T21:09:41.060

理查德为我指出了正确的方向，所以我将用我的发现来回答我自己的问题。

是的，您可以使用 TFS SDK 来创建、排队和跟踪构建。您需要的接口/类位于 Microsoft.TeamFoundation.Build.Client 命名空间中。IBuildServer、IBuildDefinition 和 IBuildDetail 特别有用。

TFS 2010 更新：这是一个使用 TFS 2010 SDK 的示例程序，可在[此处](https://docs.microsoft.com/en-us/archive/blogs/jpricket/tfs2010-queuing-a-build-from-code-with-custom-process-parameter-values)找到：

```
using System;
using System.Collections.Generic;
using Microsoft.TeamFoundation.Build.Client;
using Microsoft.TeamFoundation.Build.Workflow;
using Microsoft.TeamFoundation.Client;

namespace ManageBuildTemplates
{
    class Program
    {
        static void Main(string[] args)
        {
            TfsTeamProjectCollection collection = TfsTeamProjectCollectionFactory.GetTeamProjectCollection(new Uri("http://jpricket-test:8080/tfs/collection0"));
            IBuildServer buildServer = collection.GetService<IBuildServer>();

            IBuildDefinition definition = buildServer.GetBuildDefinition("UnitTests", "Definition1");

            IBuildRequest request = definition.CreateBuildRequest();
            request.ProcessParameters = UpdateVerbosity(request.ProcessParameters, BuildVerbosity.Diagnostic);

            buildServer.QueueBuild(request);
        }

        private static string UpdateVerbosity(string processParameters, BuildVerbosity buildVerbosity)
        {
            IDictionary<String, Object> paramValues = WorkflowHelpers.DeserializeProcessParameters(processParameters);
            paramValues[ProcessParameterMetadata.StandardParameterNames.Verbosity] = buildVerbosity;
            return WorkflowHelpers.SerializeProcessParameters(paramValues);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T17:12:34.263

查看 tfsbuild.exe（在 VS 安装的 .../Common9/IDE 文件夹中）。

这引用了程序集`Microsoft.TeamFoundation.Build.Client`，`Microsoft.TeamFoundation.Build.Common`看起来很有帮助，......并且包含没有与其他 TFS cient 程序集一起记录的命名空间，但在 MSDN 上[http://msdn.microsoft.com/en-us/library/cc339575.aspx](http://msdn.microsoft.com/en-us/library/cc339575.aspx)

# asp.net - 在 OnLoadComplete 中的动态链接按钮上添加 ClickEvent

> ID：611491
> 
> 赞同：0
> 
> 时间：2009-03-04T16:58:39.057
> 
> 标签：asp.net, click, linkbutton, dynamic-controls

我正在 ASP.Net 中创建一个文件浏览器，但我遇到了一个我认为与动态控件上的事件关联有关的问题。我将在这里解释我的代码的作用：

当我的页面加载（OnLoad）时，我调用一个方法（createStuff（））创建许多链接按钮（代表当前目录中的文件夹），这些链接按钮连接到将当前目录更改为与链接按钮关联的事件的事件.

由于在调用 OnLoad 后会触发链接按钮单击事件（因此当前目录在 onload 后首先更改），因此链接按钮不会更新以反映新的当前目录（它们是在单击更改当前目录之前创建的-事件）。因此，我还在 OnLoadComplete 中调用 createStuff() 导致链接按钮被更新并反映新当前目录中的文件夹。

但是（这是我的问题）似乎我在 createStuff() 中执行的事件连接（Click += new EventHandler(changeDirectory)）在 OnLoadComplete 中调用该方法时并没有真正起作用（在链接按钮之后调用 OnLoadComplete -点击事件已被触发）。结果是，虽然链接按钮的文本属性反映了新目录中的文件夹，但单击链接按钮不会触发事件。

我该如何解决这个问题？我尝试在 OnLoad 中重新连接 LinkBut​​tons 上的事件，但结果相同。

先感谢您

丹麦西蒙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T21:26:44.670

一致地设置 LinkBut​​ton 的`ID`属性。

此行为的两个常见原因是 (1) 缺少事件处理程序和 (2) 缺少 ID 属性。由于您确定您的事件处理程序正在附加期间，`OnLoad`因此缺少 ID 属性可能是罪魁祸首。

当用户在客户端单击您的 LinkBut​​ton 时，会向服务器发送一个 PostBack，该服务器按 ID 命名 LinkBut​​ton。如果您不能确保您的控件在 PostBacks 之间具有相同的 ID，则您的事件处理程序可能不会被引发。

# c# - 在 .Net 中设置/删除事件处理程序

> ID：611492
> 
> 赞同：4
> 
> 时间：2009-03-04T16:58:42.487
> 
> 标签：c#, .net, event-handling, lambda

所以我坚持修复/维护另一个程序员代码（blech）

我是规则的坚定教授**“如果它没有坏就不要修复它！”** 因此，每次遇到可怕的代码时都想更改某些内容，因此我将自己限制在仅更改可能的绝对最少代码量以进行所需的修复。但在某些情况下，我真的需要先了解一些东西，然后再尝试遵循/更改它。

我在这里遇到了一点：

```
region.LineSelected = (x) => { }; 
```

我想知道它是否与此相同：

```
region.LineSelected = null; 
```

在我改变它的方法之前，我想 100% 肯定第一行正在做什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-04T17:01:28.410

**根据我目前对该主题的看法进行编辑**

它们是不相同的。lambda 版本正在向一个空的匿名方法添加一个事件处理程序。这允许其他代码自由地提高 LineSelected() 而不必担心它是否为空（即没有侦听器）。

例如。

```
var lineSelected = this.LineSelected;

if (lineSelected != null)
{
    lineSelected(EventArgs.Empty);
} 
```

如果在 if 之后但在事件引发之前在另一个线程中取消订阅 LineSelected，则上述语句可能会引发 NullReferenceException。~~将 LineSelected 分配给一个临时变量，然后引发它可以调用未订阅的事件侦听器。~~将事件处理程序分配给局部变量是处理空委托的推荐方法。

~~通过添加一个空委托，其他代码始终能够调用 LineSelected 而不必担心 NullReferenceException。~~通过将多播事件委托分配给局部变量，您可以确保该值不能被另一个线程修改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T17:03:15.473

我想不出任何理由拥有第一行代码。我唯一能想到的是，在引发 LineSelected 事件时，如果类中有第一行代码，则无需检查 LineSelected 事件是否为空。IE：

```
if (this.LineSelected != null)
{
   LineSelected(this,new EventArgs());
} 
```

相反，您可以在没有空检查的情况下引发事件。

但是，使用第二行代码，您将需要检查空值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T17:32:38.523

那不是一个事件处理程序，那是一个简单的委托。（必须使用 += 和 -= 修改事件处理程序以附加和分离事件）。

如前所述，将委托属性设置为空处理程序意味着在调用委托之前不必执行空检查（假设没有其他东西可以将其设置为空）。

这可能使调用代码更方便，但不应将其混淆为性能改进（通过消除检查 null 的需要）。一般来说，委托方法调用的开销会明显高于空检查的开销。可能有一些场景（例如，如果委托在 99.99% 的时间里有一个“真实”的实现）避免空值检查可以提高性能，但很难想象一个场景中微小的性能差异可能足以影响值得的是，它也不保证完全删除委托调用以支持更有效的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T17:02:18.173

不，这不是一回事——第一行分配`LineSelected`了一个空委托，这与`null`.

发现差异的最简单方法是查看编译器在您使用 lambda 语法时为您生成的代码。这段代码：

```
using System;

class Program
{
    static void Main()
    {
        Action<int> func0 = (x) => { };
        Action<int> func1 = null;
    }
} 
```

真的编译成这样：

```
internal class Program
{
    // Methods
    private static void Main()
    {
        Action<int> func0 = delegate (int x) {
        };
    }
} 
```

请注意，编译器足够聪明，可以将其删除`func1`，因为它被设置为`null`并且没有在其他地方引用。但请注意，它`func0`仍然存在并设置为一个委托，尽管它什么都不做，但与`null`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T17:03:35.020

它们不一样，因为设置了事件处理程序。

假设暴露 LineSelected 的类忘记了：

```
if( LineSelected != null )
    LineSelected(...) 
```

如果该类要调用 LineSelected 并且没有人在听，那么它将抛出 NullReferenceException

请注意，您也可以（在区域内）避免竞争条件：

var 事件 = LineSelected; 如果（事件！= null）事件（...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T17:06:29.850

我认为这是一种避免对每个事件进行空检查的技术。

如果 LineSelected 事件引发代码没有正确的 null 检查，那么这将导致异常：

```
region.LineSelected = null;

/* no event handlers added to LineSelected */

class Region {
    void OnLineSelected() {
        // Null error!
        LineSelected();
    }
} 
```

但是，如果添加了一个空的无副作用处理程序，那么即使没有人向事件添加处理程序，上面的代码也可以正常工作，因为总会附加那个空处理程序。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-04T17:06:41.940

为了扩展理查德和安德鲁所说的，它相当于

```
region.LineSelected = delegate {}; 
```

这意味着当您引发事件时，您不需要先检查 null，因为它有一个委托（以小幅性能损失为代价）

# jquery - 为什么我的 jquery 表单验证不适用于 IE7？它适用于 FF、Opera、Safari 等

> ID：611493
> 
> 赞同：1
> 
> 时间：2009-03-04T16:58:45.733
> 
> 标签：jquery, validation, firefox, forms, internet-explorer-7

我最近在我们社区学院测试的表单上使用了 jquery 和表单验证插件：

*   [www.mchenry.edu/parentorientation](http://www.mchenry.edu/parentorientation)

马上，（如果使用 FF、Opera、Safari 等查看）当您单击提交而不输入任何值时，您会在表单中收到一些不错的错误消息，即预期的效果。但是，如果您使用的是 IE7，当您单击提交时，您将获得我们的后端开发人员偏爱的服务器端验证。为什么IE7会忽略jquery验证而跳转到服务器端验证？我可以做些什么来让 IE 正常运行，还是我坚持我所拥有的？

感谢您提供的任何见解。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-12-29T02:59:10.007

我知道这篇文章已有 2 年历史，但我是通过谷歌找到的，所以也许其他人会。

[fozylet 提到](https://stackoverflow.com/a/5933640/94928)的问题已在 jQuery Validation 插件版本 1.9.0 [http://bassistance.de/jquery-plugins/jquery-plugin-validation/中修复](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

name 属性不再需要它来工作。我在表单中使用 spring，所以实际上无法指定 name 属性。杂散的逗号也不会停止表单验证现在的工作。

迟到总比不到好...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T17:18:09.320

51 号线

> }, //结束消息

去掉逗号。

并使用[IE 调试栏](http://www.my-debugbar.com/wiki/CompanionJS/HomePage)。

尝试使用更高版本的 jQuery Validation Plugin 1.9.0，它适用于 IE7 和 8。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-05-09T07:03:26.220

在 IE 上使用 jQuery 验证插件时要注意的另一件事是：

**必须为您正在验证的*元素*以及*表单*和*提交*按钮指定**ID**和**名称。**虽然 FF 和 Chrome 没有这些也可以工作，但 IE 不能。**

 *****没有名称的选项卡验证确实有效，但表单提交验证无效。

# c# - 运行 Subclipse 和 TortoiseSVN 的版本问题

> ID：611512
> 
> 赞同：2
> 
> 时间：2009-03-04T17:02:25.130
> 
> 标签：c#, tortoisesvn, subclipse

正如有人回答我的另一个问题所建议的那样，我为 Java 安装了 Subclipse，并为#develop 安装了 TortoiseSVN。当我尝试编辑 C# 类时，它说“客户端太旧，无法使用工作副本” - 但 TortoiseSVN (1.5) 的 Subversion 版本似乎比 Subclipse (1.4?) 的版本更新。发生了什么事 - 消息似乎有点倒退！我可以降级 TortoiseSVN 的版本级别以匹配 Subclipse，还是升级 Subclipse？！建议将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T17:09:55.300

直接来自[常见问题解答](http://tortoisesvn.tigris.org/faq.html#clientold)：

> 完整的错误消息是：此客户端太旧，无法使用工作副本“。”；请获取更新的 Subversion 客户端。

一旦您使用了与更高版本的 Subversion 链接的 Subversion 客户端，您将收到此错误消息，然后尝试使用与旧版本链接的 Subversion 客户端执行命令，例如，您在工作副本上使用了 1.4.x 客户端，现在你在同一个工作副本上尝试一个 svn 1.3.x 客户端。

原因是 Subversion 1.4 和 1.5 在每个命令上透明地升级工作副本。但是一旦升级了工作副本格式，老客户就不能再访问工作副本了，因为他们不知道新的格式。

“修复”此问题的唯一解决方案是升级您使用的任何客户端并给您此错误消息。或者与老客户重新结帐。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T16:27:14.457

原来我的问题是由于 #develop 2.2 强制 TortoiseSVN 1.4 - 它不适用于 TortoiseSVN 1.5。那好吧！无论如何感谢您的反馈！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T17:13:33.200

消息是正确的。您有两个 SVN 客户端：TortoiseSVN 和 Subclipse。Subclipse 客户端太旧，无法使用 TortoiseSVN 工作副本。作为 subversion 1.5 更改的一部分，修改了工作副本的格式以支持新的合并跟踪功能。如果您使用 TortoiseSVN 访问您的工作副本，它将自动从 v1.4 格式转换为更新的 v1.5 格式（这在 TortoiseSVN 和 Subversion 发行说明中有所提及）。

因此，如果您要在同一个工作副本上同时使用 Subclipse 和 TortoiseSVN，您将希望两个客户端都基于兼容的 subversion 版本（即都在 subversion 1.4.x 上或都基于 subversion 1.5.x） . 所以你应该升级 Subclipse，或者降级 TortoiseSVN。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-04T17:10:37.797

尝试使用 Subversive，它现在是官方的 Subversion Eclipse 插件。

[1]： http: [//www.eclipse.org/subversive/](http://www.eclipse.org/subversive/)

# php - 使用面向 Web 的应用程序防止目录遍历 - 正则表达式是防弹的吗？

> ID：611520
> 
> 赞同：4
> 
> 时间：2009-03-04T17:03:36.377
> 
> 标签：php, directory, directory-traversal

我处于需要允许用户下载从 URL 动态确定的文件的情况。在下载开始之前，我需要做一些身份验证，所以下载必须先通过脚本运行。所有文件都将存储在 Web 根目录之外，以防止手动下载。

例如，以下任何内容都可能是下载链接：

*   [http://example.com/downloads/companyxyz/overview.pdf](http://example.com/downloads/companyxyz/overview.pdf)
*   [http://example.com/downloads/companyxyz/images/logo.png](http://example.com/downloads/companyxyz/images/logo.png)
*   [http://example.com/downloads/companyxyz/present/ppt/presentation.ppt](http://example.com/downloads/companyxyz/present/ppt/presentation.ppt)

基本上，文件夹深度可以变化。

为了防止目录遍历，比如说： [http://example.com/downloads/../../../../etc/passwd](http://example.com/downloads/../../../../etc/passwd) 我显然需要对 URI 进行一些检查。（注意：我没有将此信息存储在数据库中的选项，必须使用 URI）

以下正则表达式是否可以确保用户没有输入可疑内容：

```
preg_match('/^\/([-_\w]+\/)*[-_\w]+\.(zip|gif|jpg|png|pdf|ppt|png)$/iD', $path) 
```

我还有哪些其他选项可以确保 URI 正常？可能在 PHP 中使用 realpath？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T17:09:37.487

我建议使用[`realpath()`](http://www.php.net/manual/en/function.realpath.php)将路径转换为绝对路径。然后，您可以将结果与允许目录的路径进行比较。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T17:17:34.673

我不是 PHP 开发人员，但我可以告诉您，在这种情况下使用基于正则表达式的保护就像穿着 T 恤抵御飓风。

这种问题在安全术语中被称为**规范化漏洞**（您的应用程序在操作系统有机会将其转换为绝对文件路径之前解析给定文件名）。攻击者将能够想出任意数量的文件名排列，这些排列几乎肯定无法与您的正则表达式匹配。

如果您*必须*使用正则表达式，则使其尽可能悲观（*仅*匹配有效文件名，拒绝其他任何内容）。我建议您对 PHP 中的规范化方法进​​行一些研究。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T17:08:42.403

我认为您可以为此使用[htaccess 。](http://httpd.apache.org/docs/1.3/howto/htaccess.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T20:32:29.167

我认为以下 3 项检查可能是一个理想的解决方案

*   确保文件与文件路径看起来像的普遍接受的正则表达式匹配
*   使用 realpath（在 PHP 中）获取用户请求文件的规范形式并进行比较以确保它位于基本目录中
*   从 PHP v5.3 开始，您可以使用 ini_set 将 open_basedir 限制为特定文件夹，这样就不可能读取该文件夹之外的文件（使用 fopen、include、fread 等）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T17:07:48.737

您的文件名将包含哪些字符？如果它只是 [a-zA-Z0-9] 单点破折号和斜线，则可以随意剥离其他任何内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-16T12:39:01.753

我的解决方案

```
$filesPath = realpath(".");
$reqPath = realpath($_GET["file"]);
$pat = "%^".preg_quote($filesPath)."%";

if(preg_match($pat,$reqPath)){
    echo "File found";
}else{
    echo "Access denied"
}
?> 
```

# clickonce - 通过 URL 启动 ClickOnce，但不检查更新

> ID：611532
> 
> 赞同：3
> 
> 时间：2009-03-04T17:05:44.780
> 
> 标签：clickonce

我有一个 ClickOnce 应用程序，它经常通过 URL 从另一个应用程序启动。URL 包括一些加载数据的命令行参数等。

由于启动应用程序的频率如此之高，我想取消对版本更新的检查。所以我通过 ApplicationDeployment 类实现了我自己的检查来避免它。如果您在安装应用程序后从“开始”菜单启动，它工作正常。

但是，我们还希望通过 URL 行为保留启动，因为它在很多方面都具有优势。但是通过 URL 启动时，总​​是会执行更新检查——似乎 IE 不够聪明，无法在本地下载区域中查找应用程序以查看它是否已安装...

有谁知道在仍然使用 URL 启动机制的同时获得“不自动检查更新”行为的方法？

* * *

实际上，看起来问题是 ClickOnce 模型中的 Catch-22。如果您使用 URL 启动，IE 将*始终*与主机联系并检查版本，并在必要时更新，无论应用程序是否标记为“不检查版本”。但是，如果您从“开始”菜单启动，ClickOnce 会禁用命令行参数。

有没有人找到解决这个问题的方法，或者知道 MS 计划修复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-04T05:57:50.073

微软没有什么可以“修复”的。这是在线 ClickOnce 部署的预期行为。它会检查以确保它在线并检查以确保它正在运行最新版本，然后它会运行。如果您不希望它这样做，那么您需要将其设置为在线和离线运行。

我认为如果您将其设置为离线并仍然通过 http url 调用它，它仍然会检查更新，但我不会发誓。如果它是一个在线/离线应用程序，您可以改为通过开始菜单上的快捷方式调用它。

如果您的目标是 .NET 3.5 SP-1 或 .NET 4.0，您可以将参数传递给在线/离线的应用程序。要了解如何做到这一点，请查看[这篇文章](http://robindotnet.wordpress.com/2010/03/21/how-to-pass-arguments-to-an-offline-clickonce-application/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T18:07:13.463

您是否考虑[过将应用程序注册到自定义 URL 协议](http://msdn.microsoft.com/en-us/library/aa767914(VS.85).aspx)？这可能会提供您认为需要的属性：即能够从 Web 浏览器内部使用任意启动参数启动应用程序。

# c# - 仅向每个唯一访问者提供一次功能

> ID：611538
> 
> 赞同：1
> 
> 时间：2009-03-04T17:07:01.797
> 
> 标签：c#, .net, unique, visitor-pattern

我写了一个留言板作为我的第一个 ASP.NET 项目。到目前为止，它似乎运作良好。但是，我拥有的功能之一是每封邮件都有垃圾邮件评级。它只是查看者将邮件标记为垃圾邮件的次数除以查看邮件的总次数。这个想法是允许用户在他们选择这样做时忽略具有高垃圾邮件评级的邮件。

然而，整个系统可以被垃圾邮件发送者简单地查看他自己的消息并刷新很多次，这将增加消息被查看的次数。连续多次将邮件标记为垃圾邮件的人也可以阻止它。我需要一种方法来确定特定访问者是否已经查看了特定消息，以及确定特定用户是否已经将特定消息标记为垃圾邮件的方法。

我不想要求注册 - 我希望任何人都能够查看或发布消息。我一直在考虑的两个想法是，当访问者进入网站时设置一个 cookie，以便我可以跟踪他们，或者创建一个新的数据表，在用户查看邮件或将其标记为垃圾邮件时记录用户的 IP 地址。其他人能想出更好的方法吗？.NET 是否有任何内置功能可以帮助我确定访问者是否是第一次查看页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T17:10:54.877

最可靠的措施是 IP 地址过滤，因为垃圾邮件发送者可以通过编写自己的程序来请求页面来规避任何其他方法。它会影响您在 NAT 后面的客户端，但对于垃圾邮件过滤目的，它工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T17:20:31.483

ASP.Net 有一个名为的内置功能`Personalization`，可用于检测和记住匿名用户以及普通的“注册”用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T17:33:53.760

对于匿名用户，请使用 IP。这会产生误报，特别是对于某些互联网提供商而言，但对于您的场景来说，这似乎是一个不错的权衡。我也会让用户更容易被识别，open id 是一个很好的方法。

# c# - 在 Gridview 中选择特定行

> ID：611546
> 
> 赞同：0
> 
> 时间：2009-03-04T17:08:48.580
> 
> 标签：c#, asp.net, gridview

我正在使用 GridView 和 DataTable 来填充网格。我也在使用自定义分页。

使用 GridView 的搜索功能，我在每个字段上提供了一个文本框，用于搜索网格中的记录。如果找到该记录，则选择该记录。

我在分页时遇到问题，当我遍历网格的行时，如果数据在另一页上，则循环仅显示页面行。如何选择该行以进入该页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T17:17:46.797

您必须选择页面：GridView1.PageIndex。您可能需要做更多工作，具体取决于您绑定网格的方式。

# macos - OSX 10.5 中的 X11 库？

> ID：611547
> 
> 赞同：2
> 
> 时间：2009-03-04T17:09:10.747
> 
> 标签：macos, installation, x11

我有（我相信）一个相当标准的 10.5 安装，我正在尝试编译.. 嗯，我正在尝试编译 T.38modem，它需要 OPAL，它需要 pwlib，它需要 libX11。有点傻，不过无所谓。

问题是在 /usr/X11/lib 中，我有以下内容：

```
Brians-mini$ nol libX11.*
lrwxr-xr-x 1 root wheel 14 Mar 3 2008 libX11.6.2.0.dylib@ -> libX11.6.dylib
lrwxr-xr-x 1 root wheel 18 Feb 20 17:53 libX11.6.dylib@ -> libX11.6.2.0.dylib
lrwxr-xr-x 1 root wheel 14 Feb 20 17:54 libX11.dylib@ -> libX11.6.dylib 
```

有人觉得这有什么奇怪的吗？

那么，我应该从哪里获得 libX11.dylib？（或 .6.2.0.dylib 或其他）

编辑对评论的回复：otool 给出：

```
X11:
    /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation (compatibility version 150.0.0, current version 476.15.0)
    /System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration (compatibility version 1.0.0, current version 212.2.0)
    /usr/X11/lib/libXau.6.dylib (compatibility version 7.0.0, current version 7.0.0)
    /usr/X11/lib/libxcb.1.dylib (compatibility version 2.0.0, current version 2.0.0)
    /usr/X11/lib/libX11.6.dylib (compatibility version 9.0.0, current version 9.0.0)
    /usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 111.1.1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T17:43:07.123

X11 是 Leopard 安装 DVD 上的可选安装。

[在 Mac OS X 中使用 X11](http://docs.info.apple.com/article.html?path=Mac/10.5/en/8699.html)

*编辑：*

[从：](http://developer.apple.com/opensource/tools/X11.html)

> “X11 SDK 头文件作为 Xcode 开发工具的一部分提供。”

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T18:17:02.720

嗯，这很可爱！:-)

我已经查看了我的机器以及市场营销同事的机器，他在没有开发工具的情况下进行了简单的（只需点击“安装”）Leopard 安装。我们俩都有 /usr/X11/lib （我认为它现在默认安装在 Leopard 中）。

有趣的是，我们俩还有一个 libX11.6.dylib，它不仅仅指向一个循环：

```
lrwxr-xr-x  1 root  wheel       14  3 Mar  2008 /usr/X11/lib/libX11.6.2.0.dylib -> libX11.6.dylib
-rwxr-xr-x  1 root  wheel  4620928 31 Jul  2008 /usr/X11/lib/libX11.6.dylib
lrwxr-xr-x  1 root  wheel       14  3 Mar  2008 /usr/X11/lib/libX11.dylib -> libX11.6.dylib 
```

您介意看看您的 X11.app 并查看它指向的位置吗？我想知道是否存在腐败或其他好处：

```
$ cd /Applications/Utilities/X11.app/Contents/MacOS
$ otool -L X11 
```

您应该会看到如下内容：

```
/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation (compatibility version 150.0.0, current version 476.15.0)
/System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration (compatibility version 1.0.0, current version 212.2.0)
/usr/X11/lib/libXau.6.dylib (compatibility version 7.0.0, current version 7.0.0)
/usr/X11/lib/libxcb.1.dylib (compatibility version 2.0.0, current version 2.0.0)
/usr/X11/lib/libX11.6.dylib (compatibility version 9.0.0, current version 9.0.0)
/usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 111.1.1) 
```

您可以只重新安装 Leopard 磁盘中的 X11 部分，但如果您已升级到 10.5.xa，则 10.5.0 磁盘可能不允许您仅安装该部分。没有把握。你在英特尔 mac 上吗？如果是这样，那么某人（比如我）可能会直接向您发送该死的文件，但如果 X11 由于某种原因严重损坏，它可能无法解决问题。

**编辑**：MacPorts 似乎也有一个 xorg-libX11 端口文件，如果这更容易，您可以安装它：http: [//trac.macports.org/browser/trunk/dports/x11/xorg-libX11/Portfile](http://trac.macports.org/browser/trunk/dports/x11/xorg-libX11/Portfile)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T18:53:11.137

事实证明，在某些时候 X11 设置不正确，然后我尝试从 Fink 安装它，然后一切都崩溃了。我做了一个 rm libX11.*.dylib 并从磁盘重新安装了 X11，现在至少 pwlib 似乎正在安装......

# c# - C# 将 20 位精度双精度转换为字符串并再次返回

> ID：611552
> 
> 赞同：31
> 
> 时间：2009-03-04T17:09:49.997
> 
> 标签：c#, double, precision, tostring

在 C# 中。我有一个具有 20 位精度的双精度数（我从数据库中提取的）。在 Visual Studio（使用 QuickWatch）中，我可以看到双精度值 = 0.00034101243963859839。

我想在文本框中显示这个值，然后当我把它拿出来并将它转换回双精度值时让它成为相同的值。但我总是输掉最后两位数字

我尝试了以下方法：

```
double d = 0.00034101243963859839;
string s = d.ToString();
string s2 = d.ToString("F20");
string s3 = d.ToString("0.00000000000000000000"); -- 20 0's
string s4 = (d*100d).ToString(); 
```

在这些情况下：

```
s = 0.000341012439638598
s2 = 0.00034101243963859800
s3 = 0.00034101243963859800
s4 = 0.0341012439638598
```

我希望能够做到以下几点：

```
double d = 0.00034101243963859839;
string s = d.ToString();
//...
double d2 = double.Parse(s);
if(d == d2)
{
  //-- Success
} 
```

有没有办法保持最后两位精度？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-04T17:12:56.917

使用“R”[数字格式字符串](https://docs.microsoft.com/en-us/dotnet/standard/base-types/standard-numeric-format-strings?redirectedfrom=MSDN#RFormatString)：

```
double d = 0.00034101243963859839;
string s = d.ToString("R");
//...
double d2 = double.Parse(s);
if(d == d2)
{
  //-- Success
} 
```

代表“`R`往返”。从链接的文档：

> 仅 Single 和 Double 类型支持此格式。往返说明符保证转换为字符串的数值将被解析回相同的数值。

顺便说一句，我怀疑没有办法保留最后两位数。只有这么多的精确度可用，我怀疑他们是否会`d`首先做到这一点。但是您可以确保您的字符串至少可以正确读取您所拥有的内容。

如果您真的需要额外的精度，您可以尝试使用 a`decimal`代替。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-07T23:52:01.213

不可以。除了 double 是二进制的，因此不适合十进制值之外，double 最多有 15/16 个十进制数字（53 位）。十进制最多有 28/29 位（96 位），所以可以使用它。如果您在数据库中具有更高的精度，则需要一个自己的 C# bignum 类，请查看 stackoverflow 的实现。

# c# - 在单个查询中使用多个 DataContexts 的 Linq to SQL

> ID：611554
> 
> 赞同：3
> 
> 时间：2009-03-04T17:10:02.943
> 
> 标签：c#, .net, asp.net, linq, linq-to-sql

我有这个 Linq to SQL 查询序列，它基本上返回一个名为 PROJECTS 的表上的搜索。我正在利用延迟执行来慢慢建立它。

```
var query = from p in objDBContext.PROJECTs
where (p.PROVIDER_ID == cwForm.productForm) 
select p; 

query = from p in query
where p.SubmittedDate >= cwForm.beginDateForm
select p; 
```

我编写了一些 SQL 函数，它们将标量值和表值作为辅助函数返回，因为 LINQ 不支持`ISDATE()`全文搜索。它们与`Projects`表在同一个 .dbml 文件中。

所以现在我有：

```
var dateQuery = from d in objDBContext.ISDATE   
select d;
//returns a bool

var ftsQuery = from f in objDBContext.FullTextSearch
select f;
//returns a valued-table with the primary keys of hits with fulltextsearch 
```

我的问题是，如何在原始查询 p 上使用这些新的 objDBContexts？我也有兴趣弄清楚如何将 executequery() 映射回原始查询。

就像是：

```
query = from p in query
        from d in dateQuery
        from f in ftsQuery
where d.ISDATE(p.Field1) &&  f.FullContextSearch(searchString)    

    select p; 
```

我希望这是有道理的。我有一些类型不匹配的错误，并尝试用谷歌搜索一段时间，但找不到任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T19:50:20.437

由于您已经在上下文类上定义了所有方法，因此对所有三个使用相同的实例：

```
var query = from p in objDBContext.Projects where
    p.PROVIDER_ID == cwForm.productForm 
    && objDBContext.ISDATE(p.Field1)
    && objDBContext.FullTextSearch(searchString)
        //assuming FullTextSearch returns boolean
    select p 
```

如果 FullTextSearch 不返回布尔值，则需要构建一个表达式。就像它返回 IList 一样，你可以这样做`objDBContext.FullTextSearch(searchString).Contains(p)`

尽管请记住，无论您采用哪种方式，您尝试执行的操作都会导致数据库往返三次。在这种情况下，手工制作 SQL 可能会更好。LINQ to SQL 不能也不打算在 100% 的时间里替换 SQL。

# django - 新手 Django 问题：为创建和更新表单而疯狂

> ID：611575
> 
> 赞同：1
> 
> 时间：2009-03-04T17:15:40.920
> 
> 标签：django, crud

好的。我只是把自己绑在一个结上，试图在 Django 中制作一个表格，我可以用它来输入有关新记录的数据或更新现有记录。

如果有这个模型，任何人都可以在我的表单、视图和 URL 中勾勒出我应该拥有的正确内容吗？：

```
class Person(models.Model) :
  name = models.CharField()
  age = models.IntegerField() 
```

在另一个页面中，我想要一个指向表单的链接，它可以让我创建一个人的新实例或编辑一个现有的实例。

我感到困惑的事情：

*   我是否需要 urls.py 上的两条不同的行，一条链接到空白表单，不传递 id，另一条在我传递 id 时链接到表单？

*   我是否需要两种不同的视图，一种在保存实例之前接收表单，另一种在实例存在时接收？

我确定我已经在views.py 中使用一个链接和一个函数完成了此操作，但我似乎无法再正确处理它了。似乎不起作用的是尝试发送带有 id 的 url

```
 /edit/id 
```

并且没有

```
 /edit/ 
```

到具有 id 的默认参数的相同视图函数

```
 def edit(request,id=0) :
    blah 
```

那么这样做的*正确*方法是什么？

干杯。菲尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T18:28:06.440

设置您的 urls.py 以捕获 id 变量（如果包含在 url 中），然后在您的 views.py 中检查 null

您的 urls.py 可能如下所示：

```
(r'^edit/(?P<person_id>\w+)/$', 'mysite.myapp.views.edit_person'), 
```

然后，在您的 views.py 中：

```
def edit_person(person_id=None):
    if(person_id): #show populated form
    else: # show empty form 
```

# math - 什么简单的数学函数 f(x) 具有这些属性？

> ID：611576
> 
> 赞同：7
> 
> 时间：2009-03-04T17:15:45.350
> 
> 标签：math, function

我有一个小数学问题。我想要一个具有这些属性的函数：

1.  对于远大于 0 的 x：lim f(x) = x
2.  对于 x 远小于 0：lim f(x) = 0
3.  和 f(0) = 1 *（对不起，我在这里 f(1)=1 是错误的！）*
4.  f(x) 应该是[单调递增的](http://en.wikipedia.org/wiki/Monotonic_function)

所以函数应该看起来像这样：

```
 ^
        |   /
        |  /
        | /
   ___.-+´
--´-----+------>
        | 
```

到目前为止我得到的最好的结果是`x/(1 + e^(-x))`，但后来我意识到它下降到 0 以下并且不是单调增加的。

[GraphFunc Online](http://graph.seriesmathstudy.com/)对玩转这些功能有很大帮助。

此外，如果该函数计算速度很快，那将很有帮助，因为我需要经常执行它。

**编辑**：我在程序中使用它来限制值。我有一个优化算法，它使用带有[Levenberg-Marquardt](http://en.wikipedia.org/wiki/Levenberg-Marquardt_algorithm)算法的曲线拟合。但该算法不允许约束，并在整个实数值范围内进行优化。所以我需要一个这样的函数，这样我就可以添加一个人为的约束，使函数大于 0。一个简单的方法是使用`f(x) = x²`，但函数不是单调递增的，它有两个最小值。

Levenberg-Marquardt 逼近导数，所以我认为函数也平滑时最好。但我不确定这是否绝对必要。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-04T18:59:27.223

这是一个满足您要求的[平滑函数：](http://en.wikipedia.org/wiki/Smooth_function)

```
f(x) = (x + sqrt(x^2 + 4)) / 2 
```

对于 x = 0，您可以看到 f(x) = 1。对于非常大的正 x，`sqrt(x^2 + 4)`大约是 x，因此 f(x) ≈ x。对于非常大的负 x，`sqrt(x^2 + 4)`大约为 -x，因此 f(x) ≈ 0。

一阶导数是

```
f'(x) = 1/2 + 1/2*x/sqrt(x^2 + 4) 
```

对于 x > 0，`x/sqrt(x^2 + 4) > 0`，所以 f'(x) > 0。对于 x < 0，

```
0 < x^2/(x^2 + 4) < 1
0 < |x|/sqrt(x^2 + 4) < 1
-1 < x/sqrt(x^2 + 4) < 0
-1/2 < 1/2*x/sqrt(x^2 + 4) < 0
1/2 + 1/2*x/sqrt(x^2 + 4) > 0 
```

因此，对于所有 x，f'(x) > 0，因此 f(x) 根据需要单调递增。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T17:23:36.500

除了 0 处的不连续性之外，其他`x/(1 - e^(-x))`工作。所以将 f(0) 定义为 1，然后你就设置好了。

```
#define E 2.71828183
double SimpleFunc(double x)
{
   if (x == 0)
      return 1;
   return x / (1 - pow(E, (-x)));
} 
```

可能更快：

```
double SimpleFunc2(double x)
{
   if (x < 0)
     return 1/(1 - x);
   return x+1;
} 
```

两者在一阶导数中都是连续的，但第二个在二阶导数中有一个跳跃）

如果您真的不想执行分段功能，请尝试以下操作：`(x^2+.1)^.5 / ((1 - e^(-x))^2+.1)^.5`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-04T17:30:50.367

f(x) = abs( x/2 ) + x/2

其中 abs(x) 是 x 的绝对值

这个简单的函数显然可以快速计算并满足所有四个标准。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T17:46:53.933

只是为了给你一些想法，这是一个没有约束 f(1)=1 并且不是单调递增的解决方案。

基本上你想在两个函数之间混合：f1(x) = 0 代表 x < 0，f2(x) = x 代表 x > 0。你想要平滑混合。在 -inf 和 +inf 处具有恒定限制的简单阶梯函数是 atan（限制分别为 -pi/2 和 +pi/2）。

因此，将 atan blend 函数与 f1 和 f2 结合，您将得到：

blend(x) = atan(x)/pi + 0.5 f(x) = (1 - blend(x)) * f1(x) + blend(x) * f2(x)

这使：

f(x) = (atan(x)/pi + 0.5) * x

您可能可以使用其他混合函数来代替 atan。另请注意，与小的负值相比，f(x) 将是负数。

如果您希望曲线通过 (1,1)，则可以使用 atan(0)=0 的事实。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T17:32:08.163

我不知道你到底在用它做什么；分段函数有什么问题？如果你要经常执行它，这样的事情会比做指数更快：

```
f(x) = -1/x, x < -1
f(x) = 1, -1 <= x <= 1
f(x) = x, x > 1 
```

编辑：修复它，使其真正起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T18:03:50.383

1/2 * (x + ABS(x))

它是单调的。

f(1) = 1。

当 x 小于零时，f(x) = 0，否则等于 x。

# vb.net - 将电子邮件地址从 X400 转换为 SMTP

> ID：611581
> 
> 赞同：3
> 
> 时间：2009-03-04T17:17:13.537
> 
> 标签：vb.net, outlook

我正在尝试从 VB.Net 中的 X400 地址获取 SMTP 地址。如果我为我们域中的用户调出 Outlook 属性，并查看“电子邮件地址”，我可以看到 SMTP 地址，但我需要通过代码来获取它。我尝试检查 OutlookSpy 中的通讯簿，看看我是否可以在 Outlook 对象模型中找到一个属性来公开它，但我快干了。

出于工作原因，我也无法使用 Outlook Redemption，这似乎有解决方案。

有什么建议么？

# .net - .net 正则表达式涉及 html 标签

> ID：611583
> 
> 赞同：0
> 
> 时间：2009-03-04T17:17:22.333
> 
> 标签：.net, regex

我正在寻找一个正则表达式来检测字符串是否不仅仅是一堆 HTML 标记。

因此，所需的功能是：

```
Input -> Output

"<html></html>" -> False

"<html>Hi</html>" -> True

"<a href='google.com'>Click Me</a>" -> True

"hello" -> True

"<bold><italics></bold></italics>" -> False

"" -> Don't care 
```

曾几何时，我本可以自己完成，但时间太长了。

提前致谢。

编辑：我不在乎它们是否是真正的 HTML 标签。让我们调用 <> 的sa 标记内的任何内容。也不关心开始标签是否与结束标签匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T17:23:18.763

替换`"<[^>]*>"`为空字符串，修剪结果并检查之后是否还有任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T17:24:51.910

我曾经用它来去除 html 标签：

```
const string tagsPatterns = "\\s*<.*?>\\s*"; 
value = System.Text.RegularExpressions.Regex.Replace(value, tagsPatterns, " "); 
```

我想你可以玩一下（这个版本想保留空格），得到没有标签的字符串，并检查它是否不为空

**更新 1:**就这样:)

```
bool HasText(string value)
{
    const string tagsPatterns = "<.*?>"; 
    value = System.Text.RegularExpressions.Regex.Replace(value, tagsPatterns, "");
    return value.Trim() != "";
}
[TestMethod]
public void TestMethod2()
{
    Assert.IsFalse(HasText("<html></html>"));
    Assert.IsTrue(HasText("<html>Hi</html>"));
    Assert.IsTrue(HasText("<a href='google.com'>Click Me</a>"));
    Assert.IsTrue(HasText("hello"));
    Assert.IsFalse(HasText("<bold><italics></bold></italics>"));
    Assert.IsFalse(HasText(""));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T17:24:54.500

这是 Phil Haack 写的一篇关于使用[正则表达式匹配 html](http://haacked.com/archive/2004/10/25/usingregularexpressionstomatchhtml.aspx)的文章。

此外，如果您想要一行简单的代码，请考虑将字符串加载到 XmlDocument 中。它会解析它，所以你会知道你是否有有效的 xml。

# layout - 当面板在另一个 wx.sizer 中展开时，如何展开 wx.panel 的 wx.sizer？

> ID：611592
> 
> 赞同：0
> 
> 时间：2009-03-04T17:19:30.347
> 
> 标签：layout, wxpython, sizer

我有一个 wx.Panel，它有一个与之关联的 GridBagSizer。这个面板被放置在另一个 Sizer (BoxSizer) 中，它的 add 有 expand 标志——这意味着面板占据了 sizer 的整个宽度，这很棒。...但是面板的内部尺寸器现在没有填满面板。

当我添加它的组件时，我尝试将内部sizer 的标志设置为 wx.Expand|wx.ALL，但这不起作用。任何人都知道如何确保在面板展开时大小调整器保持与面板相同的宽度？

*编辑：我的代码创建包含 GridBagSizer 的面板：*

```
def getNewButton(self, bmp1, bmp2, label):
        panel = wx.Panel(self.frame, -1, pos=(0,0), style=wx.BORDER_THEME)
        sizer = wx.GridBagSizer(0, 1)

        #The button
        b = buttons.GenBitmapToggleButton(panel, wx.ID_ANY, None)
        self.frame.Bind(wx.EVT_BUTTON, self.OnToggleButton, b)
        b.Bind(wx.EVT_ENTER_WINDOW, self.OnMouseEnter)
        b.Bind(wx.EVT_LEAVE_WINDOW, self.OnMouseLeave)
        mask = wx.Mask(bmp1, wx.BLUE)
        bmp1.SetMask(mask)
        b.SetBitmapLabel(bmp1)
        mask = wx.Mask(bmp2, wx.BLUE)
        bmp2.SetMask(mask)
        b.SetBitmapSelected(bmp2)
        b.SetToggle(False)
        b.SetInitialSize(size = wx.Size(30, 30))
        b.SetBezelWidth(0)

        #The Label Button
        l1 = buttons.GenButton(panel, wx.ID_ANY, label, style=wx.BORDER_NONE)
        self.frame.Bind(wx.EVT_BUTTON, self.OnFlatButton, l1)
        l1.Bind(wx.EVT_ENTER_WINDOW, self.OnMouseEnter)
        l1.Bind(wx.EVT_LEAVE_WINDOW, self.OnNonToggleMouseLeave)

        sizer.Add(b, wx.GBPosition(0,0))
        sizer.Add(l1, wx.GBPosition(0,1), flag=wx.EXPAND)

        panel.SetSizer(sizer)
        sizer.SetSizeHints(panel)
        self.buttonsList.append(ImgToggleButtonComponents(b,panel,l1))
        return panel 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T15:22:20.753

你在这里所做的一切看起来都很合理。我认为您缺少 AddGrowableCol() 调用。

```
 sizer.Add(b, wx.GBPosition(0,0))
    sizer.Add(l1, wx.GBPosition(0,1), flag=wx.EXPAND)
    sizer.AddGrowableCol(1) 
```

我个人更幸运的是使用 FlexGridSizer 而不是 GridBagSizer：

```
 fgs = wx.FlexGridSizer(gridRows[fields], 2, 0, 0)
    fgs.AddGrowableCol(1)

    fgs.Add(wx.StaticText(self, -1, "Contact Phone"), 0, wx.ALL, border) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T17:33:43.247

你有正确的想法。如果您发布一些代码（只是一些占位符，具有不同的背景颜色或其他东西，以便我们可以看到发生了什么），诊断会更容易。确保正确设置了内部 Panel 的父级，您可以尝试一些 sizer 提示：gridbagsizer.SetSizeHints(innerPanel) 看看是否有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T17:00:19.643

另一种可能的方法是使用 Box Sizer：

```
sizer = wx.BoxSizer(wx.HORIZONTAL)
sizer.Add(item1)
sizer.Add(item2, proportion=1, flag=wx.EXPAND) 
```

两种方法都奏效了！谢谢 ：）

# ftp - 基于 Web 的 FTP 客户端和代码编辑器

> ID：611597
> 
> 赞同：3
> 
> 时间：2009-03-04T17:22:11.217
> 
> 标签：ftp, web-based

我正在寻找一种**完全从浏览器窗口**维护基于 LAMP 的网站的方法。

目前我正在使用 FlashFXP 和 NoteTab Pro 进行 FTP 和代码编辑，但只要我在办公桌前，它们就很好。

**当我不在办公室时，**我想找到一种方法来进行网站编辑。

如果我正在拜访家人，并且客户打电话给我关于他们网站中的错误，那么能够连接到在线 FTP 客户端、输入密码并**直接在主机上工作**会很棒。

该程序至少需要多次撤消、缩进制表符、CHMOD 功能以及在服务器上创建和删除文件的能力。

我想避免使用大量广告的解决方案，并且干净的 GUI 是当务之急。

. . .

**FireFTP**真的很漂亮，但它拒绝在我维护的主站点上显示一些文件。而且，由于该程序将在不是我的计算机上使用，并且可能在公共场所使用，因此最好避免安装插件（可能还有浏览器）。如果我能让它工作，我可以将它用于日常 FTP。

**Bespin**看起来很有希望，但在撰写本文时，它还没有 FTP 连接功能，并且导出的可能性非常有限。

**最终选择： Net2FTP**。它做我想做的一切。我唯一的抱怨是**它很丑**，但我可以忍受它以换取我将获得的灵活性。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-04T17:23:43.160

我以前使用过[FireFTP](http://fireftp.mozdev.org/)，一个 Firefox FTP 插件。它提供标准 FTP 客户端的所有功能，但在其自己的选项卡中运行。

更新：您始终可以安装[Firefox Portable](http://portableapps.com/apps/internet/firefox_portable)并在那里安装插件，这样您就可以将它放在 USB 记忆棒上随身携带，以便在其他人的计算机上使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-01T14:25:46.890

PHPanywhere.net 正是您想要的。:)

它是一个实时语法代码编辑器，支持所有 Web 格式，并包括一个强大的 FTP 编辑器。

看看@http: [//phpanywhere.net/](http://phpanywhere.net/)，让我知道你的想法！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-23T02:31:07.133

我个人使用[http://kodingen.com](http://kodingen.com)进行远程工作。他们还为开发新项目提供免费托管...

无论如何检查出来！

对我来说 phpanywhere.net 不起作用...我总是遇到文件损坏和粘贴问题。

祝你好运

PS：我知道它是一个旧帖子，但有人可能会发现它很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T17:23:16.487

试试 Firefox 扩展程序[FireFTP](http://fireftp.mozdev.org/)。在自己的选项卡中运行。

[![替代文字](https://i.stack.imgur.com/jZmRD.jpg)](https://i.stack.imgur.com/jZmRD.jpg)
[（来源：[mozdev.org](http://fireftp.mozdev.org/images/fireftpthumb.jpg)）]

## 编辑：

您想要完整的网络解决方案吗？尝试使用[Net2FTP](http://www.net2ftp.com/)。免费，无需注册，可从任何浏览器访问。我已经使用了很多次，我认为它具有您想要的所有功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T17:47:01.653

既然您已经指定您实际上是在寻找基于**Web 的**而不是基于**浏览器的**，我建议编辑们看看[Bespin](https://bespin.mozilla.com/)，它的名字最近经常出现。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T17:54:24.257

我喜欢[net2ftp](http://www.net2ftp.com/)

它是基于网络的，允许在标准文本框中进行上传、页面/代码编辑

另一个不错的功能：您可以将 net2ftp 上传到您自己的个人网站，并使用它来 ftp 到您可以访问的任何其他网站。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-17T15:08:11.217

对于这种类型的东西，最好的是[http://codey.co](http://codey.co)

问题是您不能在列表中添加超过 10 个 FTP 连接，并且您一次只能运行 1 个......但是编辑器很棒并且运行起来就像一个魅力。

希望你喜欢它并考虑到它处于测试阶段，但对于测试版，它已经帮助了我一年多。

干杯，愿代码与您同在！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-02-20T08:48:03.687

Net2FTP 可以完成这项工作，但它很丑陋。

如果您可以创建一个帐户并存储 FTP 站点，那就太棒了。

我使用[http://codeanywhere.com](http://codeanywhere.com)

您可以使用它免费存储 1 个 FTP 帐户。而且界面看起来不错。如果您想存储超过 1 个 FTP 帐户，您必须付费。

有没有像 codeanywhere.com 这样免费的服务？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-03T09:50:14.673

Filezilla 不错。试试它的便携版。没有广告并且能够创建和删除文件..非常方便...我使用它已经 2 年了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-12-26T17:25:09.593

好的，这是一篇旧帖子，但由于我遇到了同样的问题并环顾四周，我遇到了一个新设计的旧应用程序。

[PSPad](http://www.pspad.com/en/)非常方便：

*   集成 FTP，用于直接编辑服务器上的文件等。
*   您可以将它放在 USB 磁盘上并在世界任何地方使用它
*   它也是一个免费软件

该程序附带许多其他功能。好东西好像还不够。这对开发人员来说只是一个糖果棒:-)。试试看，支持多种语言！

[PSPad（家庭，英文）](http://www.pspad.com/en/)

[PSPad 下载](http://www.pspad.com/en/download.php)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-03-04T18:53:52.697

正如 tj111 回答（[基于 Web 的 FTP 客户端和代码编辑器](https://stackoverflow.com/questions/611597/looking-for-web-based-ftp-client-text-editor/611605#611605)）中所说，您可以安装 fireFTP 和 FireFOx 便携版，以便能够从 USB 记忆棒运行 firefox。
然后你可以在同一个 U 盘上安装 notepad++。这是一个很棒的开源编辑器，具有语法突出显示和参数提示等等。( [http://notepad-plus.sourceforge.net/nl/site.htm](http://notepad-plus.sourceforge.net/nl/site.htm) ) 然后你可以从那个 U 盘运行 fireFTP 和 notepad++。您可以将 fireFTP 配置为使用 notepad++ 自动打开文件。当您将文件保存在记事本++ 中时，fireFTP 将在您的 FTP 服务器上自动更新它。

# c# - 如何使用 LINQ 在 C# 中处理子列表并获取新对象列表？

> ID：611598
> 
> 赞同：0
> 
> 时间：2009-03-04T17:22:26.190
> 
> 标签：c#, .net, linq, object, custom-lists

我有一个 LINQ 查询，它给了我一个包含多个子列表的列表，所有这些子列表都具有双值。

我想从中得到一个查询结果。

如何获得第一个、最后一个、最高和最低的双精度值？

它应该是一个新对象，新的返回值应该是一个列表吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T11:16:07.110

确实，手动编码的版本会快一点，但除非您知道性能是您的应用程序的关键问题，否则我不会担心这一点。代码的 LINQ 版本如下所示：

```
 IEnumerable<List<double>> queryResults = /*...*/

  var aggregates =
    from ds in queryResults
    select new {
      First = ds[0], Last = ds[ds.Count - 1],
      Lowest = ds.Min(), Highest = ds.Max() }; 
```

我认为这绝对更容易阅读:-)。如果嵌套的东西 ( `ds`) 不是类型，`List`那么您将需要使用`First()`和`Last()`扩展方法而不是直接索引。

请注意，如果您对性能感兴趣，您还可以使用并行 LINQ，它在多个线程上运行查询。对于短名单，没有真正的理由这样做，但如果集合很大，它可能会给你更好的性能（比单线程手动编码版本更好）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T18:24:36.043

你的问题相当不清楚。但是，听起来您有一系列从 LINQ 查询返回的列表对象，并且您希望从所有这些子列表中的值中获取一些聚合。我从来没有在 LINQ 中看到过这样做的方法，老实说，即使有办法做到这一点，我也不认为性能可能会那么好。您正在寻找的聚合非常简单，可以通过循环手动计算。像这样的东西：

```
 double min = 200000000;
 double max = -200000000;
 double first = 0;
 double last = 0;
 bool hasFoundFirst = false;
 foreach ( List<double> childList in queryResults )
 {
      foreach ( double val in childList )
      {
           if ( !hasFoundFirst )
           {
                hasFoundFirst = true;
                first = val;
           }

           if ( val < min )
              min = val;
           if ( val > max )
              max = val;
           last = val;
      }
 } 
```

这样的事情会以一种非常有效的方式为您提供您正在寻找的结果。这种事情，如果你能有效地编码，往往会比 LINQ 快。LINQ 很棒，我用它做很多事情，但它只是众多工具中的一种。

# ruby-on-rails - 在 Rails 中 - 是否有一种将换行符转换为的 rails 方法 ？

> ID：611609
> 
> 赞同：117
> 
> 时间：2009-03-04T17:24:21.380
> 
> 标签：ruby-on-rails, ruby

有没有一种 Railsy 方法可以将 \n 转换为`<br>`？

目前，我正在这样做：

```
mystring.gsub(/\n/, '<br>') 
```

* * *

## 回答 #1

> 赞同：267
> 
> 时间：2009-03-04T17:48:02.683

是的，rails`simple_format`完全可以满足您的需求，并且由于它还添加了段落标签，所以效果稍好一些。看

[http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-simple_format](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-simple_format)

例子：

```
 simple_format(mystring) 
```

请注意，它`simple_format`允许基本的 HTML 标记，但也传递`sanitize`删除所有脚本的文本，因此对于用户输入应该是安全的。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-03-04T17:32:41.033

您可以通过执行以下操作使其更通用：

```
mystring.gsub(/(?:\n\r?|\r\n?)/, '<br>') 
```

这样您就可以覆盖 DOS、*NIX、Mac 和意外的无效行结尾。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-07-29T11:58:47.643

当您处理用户输入时，您应该小心这一点。
`simple_format`插入`<br>`标签，但它**会允许其他 html 标签**！

使用 simple_format 时，`<b>Hello</b>`将呈现为“ **Hello** ”，您可能不希望这样。

相反，您可以使用`<%= h(c.text).gsub("\n", "<br>").html_safe %>`
`h()`将首先对 html 进行编码，`gsub`替换换行符并`html_safe`允许`<br>`显示标签。

这将准确显示用户输入的内容。它还允许在例如评论中讨论 html。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2015-02-11T02:25:34.557

只需使用

```
white-space: pre-line; 
```

在您的 CSS 中，文本将换行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T17:30:30.103

您还可以考虑您正在尝试做什么 - 如果您很好地格式化人们输入的文本，您可能会考虑使用像[Markdown](http://tomayko.com/writings/ruby-markdown-libraries-real-cheap-for-you-two-for-price-of-one)这样的过滤器来让您的用户格式化他们的文本，而无需打开 HTML 的蠕虫罐头。你知道，就像在 Stack Overflow 上一样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T17:26:50.987

没有。您所拥有的是常用的替代方法。大多数人使用的定义是：

```
 def nl2br text
       text.gsub(/\n/, '<br/>')
   end 
```

之所以这样命名，是因为它模仿了[同名的 PHP 函数的功能](http://us3.php.net/nl2br)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-05T05:03:58.480

```
mystring.gsub(/\r\n|\r|\n/, '\n') 
```

为我工作

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-09T10:08:01.317

你可以这样做`simple_format(h(text))`——这`h`将确保不呈现任何 HTML。

正如其他答案中提到的，这将比您要求的多一点。它将整个内容包含在 中`<p>`，如果您在任何地方都有双换行符，它还会添加更多段落。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-02-19T02:03:05.733

另一种选择是仅显示`<pre>`html5 标记内的文本。

> HTML 元素表示要完全按照 HTML 文件中所写的方式呈现的预格式化文本。文本通常使用非比例（“等宽”）字体呈现。此元素内的空格显示为已写入。

[https://developer.mozilla.org/en-US/docs/Web/HTML/Element/pre](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/pre)

# asp.net - 您如何使用 ASP.NET 开发服务器测试涉及“远程主机”错误的错误处理？

> ID：611614
> 
> 赞同：0
> 
> 时间：2009-03-04T17:25:40.723
> 
> 标签：asp.net, visual-studio-2008, httpexception

我们有一个正在生产中的 ASP.NET 网站，它生成报告并将其作为 PDF 文件发送到用户的浏览器。我们的错误报告显示我们遇到了很多这样的异常：

System.Web.HttpException：远程主机关闭了连接。错误代码为 0x80072746。

这些似乎是由于用户在报告生成完成之前关闭浏览器造成的。我添加了代码来处理这个错误，但我找不到测试它的方法。在 Visual Studio 中测试时运行的 ASP.NET 开发服务器不允许远程连接，因此我无法转到另一台机器上尝试。在我的机器上运行网站时关闭浏览器不会产生异常（大概是因为我不是“远程主机”）。

所以，我想我的问题是，如何测试我的新错误处理代码（不将其推送到实时服务器）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T17:31:21.990

您可以将站点安装到本地 IIS 服务器，而不是使用 Visual Studio 的内置服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T17:31:40.210

当您在您的盒子上运行/调试服务器代码时，让其他人指向您的盒子并关闭浏览器。这将允许您拥有两个单独的主机和客户端计算机，并且还允许您在需要时潜在地调试问题。

# firefox - 可以将 Firefox 的“查看源代码”设置为不发出新的 GET 请求吗？

> ID：611617
> 
> 赞同：50
> 
> 时间：2009-03-04T17:26:33.793
> 
> 标签：firefox, firefox-3

这有点与编码无关，但程序员经常在自己的页面和其他人的页面上“查看源代码”。我了解到，当您在 Firefox 中执行普通查看源代码时，它会获取您所在的 URL 并向该 URL 发出另一个 GET 请求。这不好的原因有两个：

1.  如果您刚刚发布了 POST 并查看源代码，您将看不到浏览器实际为您呈现的 HTML。
2.  如果站点作者错误地制作了一个采取某些行动的表格（发送电子邮件或写入数据库或其他任何东西），那么将再次采取（或尝试）该行动。这有点危险。

我听说有一些东西可以添加到 about:config 中来防止这种情况发生，但没有运气。我还阅读了一些可以解决这个问题的扩展，其中包括 Firebug，但 ctrl-shift-u 与 F12 相比非常方便，然后单击几下即可找到您感兴趣的元素。

所以......我可以翻转一个开关来让 Firefox 的 View Source 一直像 View Generated Source 一样，并点击缓存而不是发出新的 GET 请求？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-04T17:32:33.640

如果您安装[Web 开发人员工具栏](https://addons.mozilla.org/en-US/firefox/addon/60)扩展，“查看源代码”下有一个名为“查看生成的源代码”的选项，它将向您显示页面的当前源代码，包括您可能所做的任何 DOM 更改。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-04T17:29:16.113

您执行 Ctrl+A，右键单击并“查看选择源”，这不会重新请求页面。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-11-16T21:53:24.273

“查看生成的源代码”与通过“查看源代码”获得的源代码不同。

查看生成的源“改进”代码、解析 html、在标签之间添加换行符、更改属性顺序 (width="100%" cellpadding="0" => cellpadding="0" width="100%")、添加属性值（nowrap => nowrap="nowrap"）和标签（tbody from nowhere）等。

您可能认为这更好，但如果您想将旧生成的源代码与实际文件进行比较，它是没有用的。

您最好的选择是搜索目录缓存。

问候

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-04T17:33:14.700

使用 FireBug 扩展。它仅显示（并允许您导航）呈现的源，因此不需要另一个请求（并且它显示 Javascript 更改）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-15T16:52:11.903

*尽管被破坏了至少 16 年，并且在 Mozilla 的错误跟踪器上仍然没有得到正式解决，但实际上这似乎已经随着2021 年 9 月 17 日**发布的 Firefox 92.0 的发布而悄然修复。***

* * *

*上一个答案：*

~~这在 Firefox 中被破坏了一段时间：~~

[https://bugzilla.mozilla.org/show_bug.cgi?id=307089](https://bugzilla.mozilla.org/show_bug.cgi?id=307089)

他们对错误跟踪器的响应速度不是很快，但您的选择是：

~~(1) 向错误跟踪器抱怨，
(2) 自己修复它，它是开源软件，
(3) 找到另一个浏览器。~~

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-19T13:02:03.123

扩展@Techn4k 的答案：如果您设置了这两个属性，但仍然获得重新获取或重新发布行为，请清除浏览器缓存：转到`about:preferences#advanced`，单击网络选项卡，然后单击`clear now`（或类似）缓存信息部分。

这允许 Firefox 获取和缓存页面，因此不会出现 re-GET 或 re-POST。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-17T10:47:28.783

这令人不安。上述方法的替代方法是使用 F12 打开调试器，然后单击网络选项卡。

当您浏览到不同的页面时，会显示每个 GET/POST。然后，您可以单击所需的帖子，然后单击“响应”选项卡以查看浏览器接收到的数据。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-04-11T09:54:58.373

该解决方案在 2012 年还可以，但如今已不再适用。

~~在地址栏中输入“about:config”。在过滤器框中，键入：“browser.cache”“browser.cache.disk.enable”和“browser.cache.memory.enable”必须设置为 TRUE。完毕 ！所有功劳归功于@MatrixFrog~~

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-12-14T10:21:20.383

您可以在发出查看源代码命令之前将 Firefox 设置为离线模式。它不会（能够）获得新的页面源。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2019-12-05T12:08:52.857

打开开发控制台（使用 F12、右键菜单中的“检查元素”等）并导航到检查器选项卡。右键单击面板中显示 DOM 树的任意位置，然后单击“全部展开”。滚动到 DOM 树的最顶部并右键单击该`<html>`标记。单击“编辑为 HTML”，整个 DOM 树应出现在可编辑的文本框中。现在应该可以使用 Ctrl+A 进行选择。复制并粘贴到您选择的目的地。

请记住，如果源本身包含 URL，例如从 CDN 导入样式，这意味着您的页面副本仍然不会独立加载，并且如果您无法访问这些资源，则看起来会有所不同。它将是页面原始逻辑的精确副本，以及您的更改。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2012-12-22T07:20:16.680

这是一个较老的问题，但它仍然会不时发生，具体取决于它们当前在最新的 Firefox 中出现的问题或导致冲突的细微扩展错误。

我想发布一个似乎对我始终有效的解决方法，因为最终我们必须完成工作，而不是花费数小时试图解决这个问题。

只需添加 `view-source:`到 url 的开头，它就会显示带有您尝试使用的获取/发布数据的源。

IE。

`view-source:http://stackoverflow.com/`

不是真正的解决方案，而是完成工作的变通方法。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2016-01-20T16:57:12.840

从 Firefox 42.0 开始，单击“查看源代码”不应执行新的 GET 请求，而是使用缓存：

> 重要的是，我们还确保 View Page Source 按原样从 Firefox 的缓存中为您提供页面源——我们不会获取新版本。

参考：[https ://hacks.mozilla.org/2015/07/developer-edition-41-view-source-in-a-tab-screenshot-elements-har-files-and-more/](https://hacks.mozilla.org/2015/07/developer-edition-41-view-source-in-a-tab-screenshot-elements-har-files-and-more/)

# ajax - MVC Ajax 更新面板

> ID：611620
> 
> 赞同：6
> 
> 时间：2009-03-04T17:27:48.347
> 
> 标签：ajax, model-view-controller, updatepanel

我知道（至少我很确定）没有像 asp:UpdatePanel 这样的 MVC 控件。谁能给我一些关于如何做到这一点的想法。

我有一个集合，我从我的存储库和服务层添加条目。在我的母版页中，我想根据此集合中是否有任何内容显示警报。

通常我会有一个 UpdatePanel，它的 UpdateMode="Always" 它会检查集合并显示我的消息。

你知道我如何在 MVC 中实现类似的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T17:56:18.573

远离 UpdatePanel 概念。

ASP.NET MVC 包括 jQuery，Microsoft 现在完全支持它。您将需要创建部分视图 (RenderPartial)，以调用返回 JSON 的控制器上的方法。

然后，使用 jQuery 连接控件和局部视图。

jQuery 是一个非常强大的 JavaScript 库。在深入研究 ASP.NET MVC /Scripts/jquery-xxxjs 文件时，我强烈推荐[jQuery in Action 一书](https://rads.stackoverflow.com/amzn/click/com/1933988355)作为参考。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T14:02:02.297

我将 Ajax.BeginForm() 与部分视图回调一起使用。并在控制器中完成我所有的代码。就像一个魅力，你甚至可以重载所有方法，如 OnSuccess OnFailure 和 OnComplete。使用它有很多功能。:P

# c# - 在目录中查找程序集

> ID：611621
> 
> 赞同：1
> 
> 时间：2009-03-04T17:27:52.620
> 
> 标签：c#, reflection

如何获取给定位置的程序集列表？我正在尝试对 appdomain 进行反思，这给了我所有已加载的内容。我只想要正在执行的程序集目录中的内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-04T17:29:48.013

要获取执行的程序集路径：

```
using System.IO;

String path= Path.GetDirectoryName(
 System.Reflection.Assembly.GetExecutingAssembly().Location); 
```

要获取所有程序集：

```
 DirectoryInfo di= new DirectoryInfo(path);
 FileInfo[] fis = di.GetFiles("*.dll");
 foreach(FileInfo fis in fls )
    //do something 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T17:30:40.617

您可以使用 System.IO 命名空间获取文件列表。查看目录类。然后，您需要确定该文件是否为程序集。您可以检查二进制文件以查找 IL 元数据，但这超出了此答案的范围。

您也可以尝试仅使用 System.Reflection.Assembly.ReflectionOnlyLoadFrom() 加载每个文件以进行反射。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T17:32:01.970

仅通过加载它们，并注意哪些无法加载。这当然会将那些没有失败的加载到当前的应用程序域中。

只有 .NET 运行时会告诉您什么是有效程序集（并且程序集不必具有“.exe”或“.dll”扩展名）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T17:33:46.787

要获取当前应用程序域中加载的所有程序集，可以使用[GetAssemblies](http://msdn.microsoft.com/en-us/library/system.appdomain.getassemblies.aspx)方法：

```
Assembly[] assemblies = AppDomain.CurrentDomain.GetAssemblies(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T18:15:12.710

[BtBh](https://stackoverflow.com/users/6088/btbh)提供的解决方案可以查找所有扩展名为 .dll 的文件。[Ricards](https://stackoverflow.com/users/67392/richard)指出，只有 .Net 运行时才能告诉您什么是有效程序集。这意味着您必须显式加载找到的每个 .dll 文件以检查它是否是有效的 .Net 程序集（它可能只是一个普通的旧 Windows dll）。正如[Josh](https://stackoverflow.com/users/26160/josh)所提到的，有一个静态方法[Assembly.ReflectionOnlyLoadFrom](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.reflectiononlyloadfrom.aspx)，它允许您加载程序集以通过反射进行检查。

# sql-server-2008 - 使用 Express 版启用 SSRS 我的报告

> ID：611625
> 
> 赞同：0
> 
> 时间：2009-03-04T17:28:57.673
> 
> 标签：sql-server-2008, reporting-services, sql-server-2008-express

有没有办法在 SQL Server Reporting Services 2008 中启用“<a href="http://msdn.microsoft.com/en-us/library/ms155893.aspx" rel="nofollow noreferrer">我的报告”功能当我使用[带有高级服务的 SQL Server 2008 Express 版本时](http://www.microsoft.com/downloads/details.aspx?familyid=B5D1B8C3-FDA5-4508-B0D0-1311D670E336&displaylang=en)？

由于我使用的是 Express 版本，[因此无法将 SQL Server Management Studio 连接到 Reporting Services](http://technet.microsoft.com/en-us/library/ms365166.aspx)：-

> “SQL Server Management Studio Express 不能用于管理报表服务器”。

我正在使用[报表管理](http://msdn.microsoft.com/en-us/library/ms157147.aspx)器浏览器界面进行 SSRS 管理。启用“<a href="http://msdn.microsoft.com/en-us/library/ms155893.aspx" rel="nofollow noreferrer">我的报告”的选项似乎不在 SSRS 2008 的报告管理器中那么是否有另一种方法可以启用此选项，也许是命令行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T10:57:58.853

*老实说，这是一个猜测，因为我没有 SQL 2008 Express 来测试它——但它绝对适用于 SQL 2005 标准。*

我认为您可以使用`rs.exe`

创建一个文本文件（我假设您将其命名为 myReportsEnable.rss）并向其中添加以下文本：

```
Public Overridable Sub Main()
    SetSystemProperties
End Sub

Private Sub SetSystemProperties()

    Dim Properties(0) As Microsoft.SqlServer.ReportingServices2008.[Property]
    Properties(0) = New Microsoft.SqlServer.ReportingServices2008.[Property]
    Properties(0).Name = "EnableMyReports"
    Properties(0).Value = "True"
    RS.SetSystemProperties(Properties)
End Sub 
```

（我从 SQL2005 得到这个，所以我假设这`Microsoft.SqlServer.ReportingServices2008`是正确的类型 - 如果不是，请道歉）

保存文件，然后使用以下命令从命令行执行它`rs.exe`：

```
rs -i myReportsEnable.rss -s http://~YourServerName~/reportserver 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T18:56:30.470

Ed Harper 的回答在 SRSS 2008 的速成版实例上对我有用，但只是在我将名称改回“ReportingServices2005”之后。

我还尝试将 ConfigurationInfo 表中的“enablemyreports”值从“false”更改为“true”，但这种尝试只是在报告管理器中给了我一个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-06T19:47:33.593

我知道这并不能完全回答我提出的问题！但是，我通过使用[SQL Server 开发人员版](http://www.microsoft.com/sqlserver/2008/en/us/developer.aspx)来解决这个问题，因为我的 SQL Server 安装用于培训等。虽然不像[Express Edition](http://www.microsoft.com/downloads/details.aspx?familyid=B5D1B8C3-FDA5-4508-B0D0-1311D670E336&displaylang=en)那样免费，但它很便宜。

使用[SQL Server 开发人员版](http://www.microsoft.com/sqlserver/2008/en/us/developer.aspx)允许我启用[“我的报告”](http://msdn.microsoft.com/en-us/library/ms155893.aspx)功能。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-04T17:48:02.900

我相信您正在寻找[具有高级服务的 SQL Server Express Edition](http://www.microsoft.com/downloads/details.aspx?familyid=B5D1B8C3-FDA5-4508-B0D0-1311D670E336&displaylang=en)。

# c# - 带有 32 位 VB6 COM 对象的 64 位 C#

> ID：611651
> 
> 赞同：3
> 
> 时间：2009-03-04T17:35:20.577
> 
> 标签：c#, com, vb6, interop

我有一个 32 位进程内 STA VB6 dll。很遗憾，我对此无能为力。我的 C# 组件极大地受益于 64 位。无论如何从我的 64 位进程调用/接口这个 32 位 dll 吗？任何形式的包装或任何东西？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-04T17:38:05.060

没有直接的方法可以做到这一点。

由于您无法移植 VB6 inproc dll，我建议您编写一个 32 位进程外服务器，该服务器实现相同的接口并将其委托给 VB6 代码。然后，您的 64 位应用程序可以调用进程外服务器，因为 COM 将负责在进程之间编组类型。

它不漂亮，它会工作！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-04T17:50:49.040

本文[在 64 位 Windows 中处理旧版 32 位组件可](https://stackoverflow.com/questions/359331/access-x86-com-from-x64-net/448039#448039)帮助您：

我找到了这个解决方案，请参阅[文章](http://blogs.msdn.com/b/volkerw/archive/2006/03/23/559087.aspx)：
• 将项目类型从进程内转换为进程外
• 使用 COM+ 作为主机（这对我有用）
• 使用 dllhost 作为代理主机

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-01-18T09:50:43.133

您可以在代理中加载（例如）仅 32 位的 DLL，并通过以下方式从 64 位进程访问它。

如果有可用的编组器，这将起作用，通常会有一个带有类型库的组件，因为它们通常使用标准编组器。如果对象需要自定义代理/存根，它将不起作用，因为 64 位版本不存在，或者您一开始就不会遇到这个问题。

## 如何注册第三方 32 位组件以供 64 位客户端使用

首先你需要一个 AppID。如果 DLL 已经有 AppID，您应该使用它。您可以通过检查您感兴趣的 CoClass 的 CLSID 键来查找。

这里使用的示例是`Capicom.HashedData`和`Capicom.EncryptedData`类。Capicom 只有 32 位。

*   **AppID：** CAPICOM 没有 AppID，所以对于 AppID，我刚刚使用了 EncryptedData 类的 CLSID。

*   **CLSID：**您需要一个您希望能够从 64 位客户端创建的每个类的 CLSID 列表。在这个例子中，它只是 EncryptedData 和 HashedData。

*   **注册：**根据示例创建一个包含详细信息的注册表文件，并将其加载到注册表中。

您应该使用 32 位版本的 Regedit 来执行此操作，因为它是一个 32 位组件。如果您想要从 32 位访问 64 位组件，请使用另一个。（这是因为 32 位兼容层的注册表虚拟化 - 使用匹配的 regedit 位数版本会为您解决这个问题，确保您编辑正确的注册表虚拟化版本）。

```
Windows Registry Editor Version 5.00

;;; Capicom AppID - just using the Capicom.EncryptedData CLSID
;;; Use default surrogate = empty string
[HKEY_CLASSES_ROOT\AppID\{A440BD76-CFE1-4D46-AB1F-15F238437A3D}]
"DllSurrogate"=""

;;; Capicom.EncryptedData
[HKEY_CLASSES_ROOT\CLSID\{A440BD76-CFE1-4D46-AB1F-15F238437A3D}]
AppID="{A440BD76-CFE1-4D46-AB1F-15F238437A3D}"

;;; Capicom.HashedData - use same AppID for all!!!!!
[HKEY_CLASSES_ROOT\CLSID\{CE32ABF6-475D-41F6-BF82-D27F03E3D38B}]
AppID="{A440BD76-CFE1-4D46-AB1F-15F238437A3D}" 
```

保存到`myComponent-dllhost.reg`文件中，然后就可以离开了。

```
c:\windows\sysWow64\regedit.exe "myComponent-dllhost.reg" 
```

您现在应该能够从 64 位脚本/COM 主机访问 Capicom.HashedData 和 Capicom.EncryptedData。

**笔记：**

*   这仅适用于基本的 OLE 自动化类型。任何与 VBScript 或 JavaScript 中的 Windows Scripting Host 脚本兼容的对象都应该没问题。
*   You only have to add the AppID to directly creatable objects. That's basically those with an InprocServer32 entry. Objects which are generated from factories or which are only available as child objects do not have to have an AppID added.
*   If there is already an AppID all you need to do is add the empty-string `"DllSurrogate"` entry. That's it!
*   this will **NOT** affect normal clients of the DLL. As long as the bit-ness matches, they will continue to be loaded in-process as before. The only difference it will make is that it will become possible to instantiate it out-of-process from a client of a different bitness.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-04T17:44:15.547

32 位 COM 组件将不得不耗尽进程。

在着手创建包装器之前，请检查 COM+（对象服务）是否会承载它。

# jquery - 如何在 html 注释中找到包含特定文本的 html 元素？

> ID：611662
> 
> 赞同：3
> 
> 时间：2009-03-04T17:39:09.630
> 
> 标签：jquery, html, sharepoint, comments

我正在尝试使用 jQuery 来识别包含特定 HTML 注释文本的 <td> 元素。标准的 ":contains" 选择器似乎没有考虑评论。我的上下文是我想向同一个 td 元素动态添加一些内容。这是目标 td 的示例：

```
<TD valign="top" class="ms-formbody" width="400px">
        <!-- FieldName="Title"
             FieldInternalName="Title"
             FieldType="SPFieldText"
          -->
            <span dir="none">
        <input name="ctl00$m$g_0b1e4ca3_9450_4f3e_b3af_8134fe014ea5$ctl00$ctl04$ctl00$ctl00$ctl00$ctl04$ctl00$ctl00$TextField" type="text" maxlength="255" id="ctl00_m_g_0b1e4ca3_9450_4f3e_b3af_8134fe014ea5_ctl00_ctl04_ctl00_ctl00_ctl00_ctl04_ctl00_ctl00_TextField" title="Title" class="ms-long" /><br>
    </span>

        </TD> 
```

此 html 是由 SharePoint 作为新列表项表单的一部分生成的，我真的很想在我的文档中找到注释中的“FieldInternalName”与某些文本字符串匹配的 td。如何使用 jQuery（或任何 javascript 都可以）最好地找到这些 td 元素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T17:56:35.033

您可以获取`innerHTML`元素的 并在其上运行正则表达式。

例子：

```
// HTML: <div id="myElement">Lorem <!-- a comment --> ipsum.</div>

var element = document.getElementById('myElement');
alert(element.innerHTML); // alerts "Lorem <!-- a comment --> ipsum."
// here you could run a regular expression 
```

**更新：**一个更全面的示例（使用 jQuery）：

```
var tds = $('td'), match;
tds.each(function(index, element) {
    match = $(element).innerHTML.match(/FieldInternalName="(^["])"/);
    if (match) alert(match);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T18:03:05.390

```
if(document.getElementById('myElement').innerHTML.indexOf(text_string) != -1) { //do something } 
```

# smtp - Exim 发件人标注验证，但仅适用于我的域

> ID：611668
> 
> 赞同：0
> 
> 时间：2009-03-04T17:42:17.547
> 
> 标签：smtp, exim

我的备份 MX 服务器上有 exim 4。我想对其进行配置，以便完成发件人标注地址验证，但仅限于在 local_domains 或 relay_to_domains 中列出的发件人地址的域部分，即邮件声称来自我管理的域。

我想使用它，因为我的主 MX 将拒绝在其中一个本地域中具有伪造发件人地址的邮件，这会导致辅助 MX 发送不需要的退回邮件。这也会被主服务器拒绝，并且不需要的退回邮件会永久（或直到它过期）位于辅助服务器的邮件队列中/

我已经有收件人标注验证工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T22:17:49.210

将以下内容放入 RCPT-TO ACL：

```
deny
    sender_domains = +local_domains : +relay_to_domains
    ! verify = sender/callout 
```

从长远来看，您可能希望找到一种将有效收件人列表同步到辅助 MX 的方法。

# c - pthread 回调中断用户输入

> ID：611672
> 
> 赞同：0
> 
> 时间：2009-03-04T17:43:33.287
> 
> 标签：c, posix, pthreads, callback

我已经编写了自己的 stop_watch 模块。这将创建一个线程并休眠几秒钟。一旦秒数过期，它将调用 main.c 中的回调函数并通知用户时间已过期。

这样用户将只有 3 秒的时间输入一个数字，而他们必须输入 5 个数字。如果时间到期，程序必须停止。

2个问题。1）如果他们在要求的时间内输入数字。我怎样才能取消线程。我正在考虑使用 thread_kill 或 thread_cancel？2）如何终止 do_while 循环？因为 scanf 在等待用户进入时会阻塞。

非常感谢您的任何建议，

我的代码如下：

```
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>

#include "stop_watch.h"

struct data_struct *g_data_struct;

void timeout_cb(int id)
{
    printf("Digit timeout\n");
    free(g_data_struct);
}

int main()
{
    pthread_t thread_id;
    unsigned int digit = 0;

    g_data_struct = (struct data_struct*) calloc(1, sizeof(*g_data_struct));

    if(!g_data_struct)
    {
        printf("=== failed to allocate memory ===\n");
        return 0;
    }

    /* start timer for 3 seconds */
    g_data_struct->seconds = 3;
    g_data_struct->func_ptr = timeout_cb;
    thread_id = start_stopwatch(g_data_struct);

    do
    {
        printf("Enter digit: ");
        scanf("%d", &digit);
    }while(1);

    pthread_join(thread_id, NULL);
    printf("=== End of Program - all threads in ===\n");

    free(g_data_struct);

    return 0;
}

#include <stdio.h>
#include <pthread.h>

#include "stop_watch.h"

pthread_t thread_id;
static id = 10;

/* start sleeping and call the callback when seconds have expired */
static void* g_start_timer(void *args)
{
    void (*function_pointer)(int id);
    int seconds = ((struct data_struct*) args)->seconds;
    function_pointer = ((struct data_struct*) args)->func_ptr;

    sleep(seconds);

    (void) (*function_pointer)(id);

    pthread_exit(NULL);

    return 0;
}

/* Will sleep in its own thread for a period of seconds */
int start_stopwatch(struct data_struct *g_data_struct)
{
    int rc = 0;

    int seconds = g_data_struct->seconds;
    printf("=== start_stopwatch(): %d\n", seconds);

    rc =  pthread_create(&thread_id, NULL, g_start_timer, (void *) g_data_struct);

    if(rc)
    {    
        printf("=== Failed to create thread\n");
        return 1;
    }

    return thread_id;
} 
```

顺便说一句，这个问题是关于 C99 gcc 的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T21:17:11.010

我不建议首先为此使用单独的线程。但是，由于它看起来像是学习如何使用线程的练习，所以我会继续使用它。

您可以设置一个全局布尔标志，指示是否输入了数字。在 g_start_timer 中，就在调用 function_pointer 之前，检查标志是否已设置。如果是，请不要调用该函数。

如果您希望线程在其休眠期到期之前提前终止，您可以使用带有 try 锁的互斥锁。

编辑：既然你说这不是一个练习，我会提到我会怎么做。使用在等待标准输入时可能超时的函数，例如 select() 或 poll()。或者，使用 alarm() 中断。以下是使用警报的示例：

```
#include <stdio.h>
#include <signal.h>
#include <unistd.h>
#include <errno.h>

void alarm_signal(int signum)
{
}

int main()
{
    char c;
    unsigned int v = 0;
    struct sigaction act;
    puts("Enter digit: ");

    /* Register dummy handler for alarm */
    act.sa_handler = &alarm_signal;
    act.sa_flags = 0;
    sigemptyset(&act.sa_mask);
    sigaction(SIGALRM, &act, NULL);

    /* Set timer for 3 seconds */
    alarm(3);

    /* Read the digits */
    errno = 0;
    while(0 != read(STDIN_FILENO, &c, 1))
    {
        if(c < '0' || c > '9')
            break;
        v = v*10 + c - '0';
    }
    if(errno == EINTR)
        puts("Timed out");
    else
        printf("Value is %d\n", v);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-19T06:32:13.967

当然你可以使用 thread_cancel 来取消一个线程。至于 scanf 的事情，你可能会想到使用管道来模拟来自终端的输入。

# oracle - FROM 列表中的 Oracle 相关子查询

> ID：611676
> 
> 赞同：1
> 
> 时间：2009-03-04T17:44:43.003
> 
> 标签：oracle, oracle10g, subquery, sql

我只是尝试在 Oracle`FROM`中的语句的子句中执行关联子查询`SELECT`，但我收到一个错误，表明我无法执行关联（大意`Obs.pID`是无法识别）。

这应该工作吗？

```
FROM ml.Person Person 
    JOIN ml.Obs ON Person.pID = Obs.pId
        JOIN (SELECT ObsMax2.pId, ObsMax2.hdId
                , MAX(ObsMax2.obsDate) as maxDate
                FROM ml.Obs ObsMax2
                WHERE ObsMax2.pId = Obs.pId
                    AND ObsMax2.obsDate < {?EndDate}
                GROUP BY ObsMax2.pId, ObsMax2.hdId) ObsMax 
            ON Obs.pId = ObsMax.pId
                AND Obs.hdId = ObsMax.hdId
                AND Obs.obsDate = ObsMax.maxDate 
```

我的解决方法似乎是使它成为一个不相关的子查询，并向子查询添加条件，以防止它完全运行 amuck、amuck、amu--oof*抱歉*。

不过，如果可能的话，我宁愿弄清楚如何正确关联它 - 像该子查询一样工作的视图需要永远构建。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-05T02:38:52.953

您可以通过使用分析函数确定每个 pid 和 hdid 的最大 obsDate 来实现查询的这一部分的意图。

它会是这样的：

```
select ...
from   (
       SELECT pId,
              hdId,
              obsDate
              MAX(obsDate) over (partition by pId, hdId) maxDate
       FROM   ml.Obs
       WHERE  obsDate < {?EndDate}
       )
where  obsDate = maxDate
/ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T19:27:44.503

FROM 子句中的子查询不能引用同一 FROM 子句中的其他表。删除 ObsMax2.pId = Obs.pId 子句应该可以解决问题，据我所知，由于相同的子句处于连接条件中，因此会给您完全相同的结果。但是，正如您所提到的，您可能会在子查询中使用 GROUP BY 时遇到性能问题。

据我所知，您正试图从 ml.Obs 中获取单个 pID/hdId 记录，其最大 obsDate 小于 {EndDate}。在这种情况下，如何将子查询移到可以关联它的 WHERE 子句中呢？例如：

```
select ...
from
  ml.Person Person
  join ml.Obs on Person.PID = Obs.pId
where Obs.obsDate = (
    select max(obsDate)
    from ml.Obs Obs2
    where Obs2.pId = Obs.pId
      and obs2.hdId = Obs.hdId
      and Obs2.obsDate < {EndDate}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T19:28:33.080

您已经为许多表格添加了“ml”前缀。但并非无处不在（例如，第一次加入）。假设您需要（对于用户/权限/其他）：

在 Person.pID 上加入 ml.Obs = **ml.**Obs.pId

或者

加入 ml.Obs **Obs** ON Person.pID = Obs.pId

还有其他地方也需要这样做。

如果不是这种情况，请将它们从您的查询中删除，因为它们无关紧要并且会分散注意力。

# oracle - 如何从 Oracle XMLTYPE 中提取叶节点

> ID：611680
> 
> 赞同：3
> 
> 时间：2009-03-04T17:45:26.183
> 
> 标签：oracle, xpath, extract, xmltype

我只想从 Oracle 10g 中的 XMLTYPE 对象中提取叶节点

```
SELECT
    t.getStringVal() AS text
FROM
    TABLE( XMLSequence( 
        XMLTYPE(
            '<xml>
                <node>
                    <one>text</one>
                </node>
                <node>
                    <two>text</two>
                </node>
                <node>
                    <three>text</three>
                </node>
            </xml>'
        ).extract( '//*' ) 
    ) ) t 
```

我应该使用什么作为 WHERE 子句，所以它只返回这些：

```
 <one>text</one>
                    <two>text</two>
                    <three>text</three> 
```

我尝试了以下方法，但它们不起作用：

```
WHERE t.existsNode( '//*' ) = 0
WHERE t.existsNode( '/.//*' ) = 0
WHERE t.existsNode( './/*' ) = 0 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T17:57:45.840

没关系，我找到了：

```
WHERE
    t.existsNode( '/*//*' ) = 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-14T23:35:11.897

XPath`//*[not(*)]`将获取级别 1 或更深且没有任何子级的任何元素：

[SQL小提琴](http://sqlfiddle.com/#!4/ae2cc8/61)

**查询 1**：

```
SELECT t.getStringVal()
FROM   TABLE(
         XMLSEQUENCE(
           XMLTYPE(
             '<xml>
             <node><one>text</one></node>
             <node><two>text</two></node>
             <node><three>text</three></node>
             </xml>'
           ).extract( '//*[not(*)]' )
         )
       ) t 
```

**[结果](http://sqlfiddle.com/#!4/ae2cc8/61/0)**：

```
|    T.GETSTRINGVAL() |
|---------------------|
|     <one>text</one> |
|     <two>text</two> |
| <three>text</three> | 
```

如果您希望能够包含根元素，请使用 XPath `(//*|/*)[not(*)]`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-12-01T05:17:44.013

您可以尝试以下 PL/SQL：

```
DECLARE
  x XMLType := XMLType(
            '<?xml version="1.0" ?>
            <xml>
                <node>
                    <one>text</one>
                </node>
                <node>
                    <two>text</two>
                </node
                <node>
                    <three>text</three>
                </node>
            </xml>');
BEGIN
  FOR r IN (
    SELECT ExtractValue(Value(p),'/XML/node/one/text()') as one_x
          ,ExtractValue(Value(p),'/XML/node/two/text()') as TWO_x
          ,ExtractValue(Value(p),'/XML/node/three/text()') as three
    FROM   TABLE(XMLSequence(Extract(x,'/XML/node/'))) p
    ) LOOP
    /* do whatever you want with r.one_x, r.TWO_x, r.three_x */
  END LOOP;
END; 
```

# python - Django 模型继承。隐藏或删除字段

> ID：611691
> 
> 赞同：10
> 
> 时间：2009-03-04T17:49:26.487
> 
> 标签：python, django, django-models, django-admin

我想从一些 3rd 方代码继承模型类。我不会使用某些字段，但希望我的客户能够在 Admin 中编辑模型。最好的办法是向管理员隐藏它们，还是我可以从一开始就阻止它们被创建？

此外 - 如果需要其中一个不需要的字段，我该怎么办？我的第一个想法是覆盖 save 方法并输入一个默认值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T19:02:41.100

您可以控制在管理员中可编辑的字段。

来自 Django 文档：

> 如果您想要一个仅包含名称和标题字段的 Author 模型的表单，您可以像这样指定字段或排除：
> 
> ```
> class AuthorAdmin(admin.ModelAdmin):
>     fields = ('name', 'title')
> 
> class AuthorAdmin(admin.ModelAdmin):
>     exclude = ('birth_date',) 
> ```

[http://docs.djangoproject.com/en/dev/ref/contrib/admin/](http://docs.djangoproject.com/en/dev/ref/contrib/admin/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T17:57:34.423

如果您正在继承模型，那么尝试隐藏或禁用任何现有字段可能是不明智的。您可能做的最好的事情就是您所建议的：覆盖`save()`并处理您的逻辑。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-04T18:20:55.223

与其继承，不如考虑使用自定义表单。

1.  您可以从显示中删除仍在模型中的字段。

2.  `clean()`您可以在表单的方法中验证并提供默认值。

请参阅[http://docs.djangoproject.com/en/dev/ref/contrib/admin/#adding-custom-validation-to-the-admin](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#adding-custom-validation-to-the-admin)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-25T12:29:08.560

只要您继承的第 3 方模型是一个**抽象模型**并且您确定不需要该字段，您就可以使用以下声明[在模型级别将其删除：](https://docs.djangoproject.com/en/3.2/topics/db/models/#field-name-hiding-is-not-permitted)

```
class MyChild(ThirdPartyModel):
   unimportant_field = None 
```

这样它甚至不会存在于数据库中，您当然不需要在 Admin 中进行任何进一步的修改。

# asp.net - 您如何在 ASP.Net 中访问 I 系列中的数据？

> ID：611693
> 
> 赞同：0
> 
> 时间：2009-03-04T17:50:22.257
> 
> 标签：asp.net, linq, ibm-midrange

我们当前所有的 ASP.Net Web 应用程序都使用 ODBC 连接和命令对象访问我们的 IBM I 系列。我应该转向另一种访问方式吗？当您的 ASP.Net 应用程序需要从中获取数据时，您当前如何访问您的 I 系列？一定有更好的方法。

我最近看到[这篇](http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/index.jsp?topic=/com.ibm.db2.luw.apdv.ms.doc/doc/c0054118.html)关于 IBM 在 Web 服务器上使用特定客户端版本支持 Linq to Entities 的文章。对我来说，这似乎是更长期的路线，但希望获得更多反馈。我从 MS 那里得到了一种感觉，即 Linq to Entities 是他们计划走的长期路线。其他人也有这种感觉吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T17:57:38.603

我正在使用 IBM 提供的驱动程序。这样做的好处是我们可以使用构建在企业库应用程序块上的单个 DataAccess 对象，而不用为 iSeries 连接创建一堆自定义代码。

```
Provider=IBMDA400.DataSource.1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T20:09:33.097

为什么“需要更好的方法”？你试图避免的使用方式有什么问题？您是否可能直接在您的网页中使用 SQL？您是否缺少数据访问层或对象关系映射器？在我看来，一个设计良好且具有良好业务对象层的系统不会真正关心与 400 的实际连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T20:42:26.623

我已经使用 IBM 托管的提供商来访问 ISeries，而且效果很好。

[IBM 在这里](http://www.redbooks.ibm.com/abstracts/sg246440.html?Open)有一些关于它的 RedBook 资源。

到目前为止，在我为 ISeries 编写的应用程序中，使用任何 ORM 是不合理的，但如果需要，我肯定会选择[NHibernate](http://www.nhibernate.org/)。

# architecture - 我应该选择哪一个？X86 还是 X64 架构？（在戴尔 PC GX680 上安装 Windows 200X 服务器操作系统时）

> ID：611694
> 
> 赞同：1
> 
> 时间：2009-03-04T17:50:48.930
> 
> 标签：architecture, installation, operating-system

我正在尝试在 DELL optiplex 桌面 GX600 系列上安装 windows 服务器操作系统，在安装过程中，在第一步中，我被要求选择：1）Windows 2008 X86 架构或 2）Windows 2008 X64 架构

现在，我如何确定我的戴尔台式机基于什么架构以及我应该选择哪个操作系统安装选项？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T17:56:41.133

正如 epophwolf[提到](https://stackoverflow.com/questions/611694/which-one-should-i-choose-x86-or-x64-architecture-while-installing-windows-20/611705#611705)的，如果您想充分利用超过 3GB 的 RAM，则需要 x64。但是，还有其他考虑因素。首先，您的机器有 x64 处理器吗？如果机器完全支持 x64，那在我看来是最好的选择。大多数软件现在都与 x64 操作系统兼容，并且在 x64 开发环境中，您可以同时为这两种操作系统进行开发。此外，x64 Windows 操作系统能够更好地利用处理器的功能，而且我发现它在我的机器上比 x86 更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T18:36:21.163

下载[CPU-Z](http://www.cpuid.com/cpuz.php)并在当前系统上运行它。如果您的处理器支持 EM64T 指令集（假设它是 Intel，不知道 AMD），那么您将能够运行 x64。

我一直在两台机器上运行 x64，一台 Server 2008 和另一台 Vista Ultimate，我没有遇到任何问题，或者至少没有立即想到的问题。如果您想使用超过 3.25-3.5 GB 的 RAM，我推荐 64 位。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T17:53:25.353

如果您需要超过 3gb 的内存，则需要 64 位操作系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T18:18:36.417

我刚刚在戴尔网站上查看过，找不到任何关于 GX600 的参考资料，但没有任何适用于 32 位版本的 GX620/630 的 Vista/W2K8 驱动程序，更不用说 64 位版本了。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-04T17:55:35.567

这完全取决于您将在桌面上使用的应用程序以及它们是否支持 x64。

列一个清单，做一些研究，但如果你不确定，并且没有充分的理由去 x64，我会去 x86。

# .net - SqlTransaction 已完成

> ID：611700
> 
> 赞同：25
> 
> 时间：2009-03-04T17:51:25.980
> 
> 标签：.net, sql-server, sql-server-2005, transactions

我有一个可能对 SQL Server 2005 数据库进行数千次插入的应用程序。如果插入因任何原因（外键约束、字段长度等）失败，则应用程序旨在记录插入错误并继续。

每个插入都独立于其他插入，因此数据库完整性不需要事务。但是，我们确实希望使用它们来提高性能。当我使用事务时，每 100 次提交中约有 1 次出现以下错误。

```
This SqlTransaction has completed; it is no longer usable.
   at System.Data.SqlClient.SqlTransaction.ZombieCheck()
   at System.Data.SqlClient.SqlTransaction.Commit() 
```

为了尝试追踪原因，我在每个事务操作中都放置了跟踪语句，这样我就可以确保在调用 commit 之前事务没有被关闭。我已经确认我的应用程序不会关闭交易。然后我使用完全相同的输入数据再次运行该应用程序，它成功了。

如果我关闭注销，它会再次失败。重新打开它就成功了。这种开/关切换是通过 app.config 完成的，无需重新编译。

显然，日志记录的行为改变了时间并使其工作。这表明存在线程问题。但是，我的应用程序不是多线程的。

我看到一个 MS KB 条目表明 .Net 2.0 框架的错误可能会导致类似的问题 ( [http://support.microsoft.com/kb/912732](http://support.microsoft.com/kb/912732) )。但是，他们提供的修复程序并不能解决此问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-05T22:00:50.070

感谢所有的反馈。我一直在 MSDN 论坛上与 MSFT 的某个人合作，以弄清楚发生了什么。事实证明，问题是由于日期时间转换问题导致其中一个插入失败。

主要问题是如果它是日期转换错误，则会显示此错误。但是，如果它是另一个错误，例如字段太长，则不会导致此问题。在这两种情况下，我都希望事务仍然存在，因此我可以对其调用 Rollback。

我有一个完整的示例程序来复制这个问题。如果有人希望看到它或与 MSFT 交换，您可以在 SqlTransaction.ZombieCheck 错误线程下的 microsoft.public.dotnet.framework.adonet 中的 MSFT 新闻组中找到该线程。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-04T19:07:10.993

不看代码就很难提供帮助。我从您的描述中假设您在每 N 次插入后使用事务来提交，这将提高性能与提交每个插入相比，前提是 N 不是太大。

但缺点是：如果一个插入失败，当你回滚事务时，当前批次 N 中的任何其他插入都将被回滚。

通常，您应该在关闭连接之前处理一个事务（如果尚未提交，它将回滚该事务）。通常的模式如下所示：

```
using(SqlConnection connection = ...)
{
    connection.Open();
    using(SqlTransaction transaction = connection.BeginTransaction())
    {
        ... do stuff ...
        transaction.Commit(); // commit if all is successful
    } // transaction.Dispose will be called here and will rollback if not committed
} // connection.Dispose called here 
```

如果您需要更多帮助，请发布代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-05T00:24:07.020

请记住，您的应用程序并不是事务的唯一参与者——SQL Server 也参与其中。

您引用的错误：

> 此 SqlTransaction 已完成；它不再可用。在 System.Data.SqlClient.SqlTransaction.ZombieCheck() 在 System.Data.SqlClient.SqlTransaction.Commit()

并不表示事务已提交，只是表示它已完成。

我的第一个建议是您的服务器已终止事务，因为它花费了太长时间（经过的挂墙时间）或太大（太多更改或太多锁）。

我的第二个建议是检查您是否正在适当地清理连接和事务。您可能会遇到问题，因为您偶尔会在自动回收之前耗尽一些资源池。

例如，[`DbConnection`](http://msdn.microsoft.com/en-us/library/system.data.common.dbconnection.aspx)实现[IDisposable](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)，因此您需要确保正确清理 -如果可以[使用 using](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)语句，或者`Dispose()`如果不能直接调用。['DbCommand'](http://social.msdn.microsoft.com/Search/en-US/?query=dbcommand&ac=8)类似，因为它也实现了`IDisposable`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-10-28T21:55:16.270

抛出此异常是因为实际的 DB 事务已经回滚，因此在客户端表示它的 .NET 对象已经是“僵尸”。

更详细的解释在[这里](https://web.archive.org/web/20081205072853/http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework.adonet/topic63721.aspx)。[这篇文章](https://docs.microsoft.com/en-us/archive/blogs/dataaccesstechnologies/zombie-check-on-transaction-error-this-sqltransaction-has-completed-it-is-no-longer-usable)解释了如何为这种情况编写正确的事务回滚代码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-11-23T23:26:47.097

根据这篇文章：http: [//blogs.msdn.com/b/dataaccesstechnologies/archive/2010/08/24/zombie-check-on-transaction-error-this-sqltransaction-has-completed-it-is-no -longer-usable.aspx](http://blogs.msdn.com/b/dataaccesstechnologies/archive/2010/08/24/zombie-check-on-transaction-error-this-sqltransaction-has-completed-it-is-no-longer-usable.aspx)

临时解决方案可能是尝试捕获回滚或提交操作。所以这段代码足以阻止错误抛出：

```
 public static void TryRollback(this System.Data.IDbTransaction t)
    {
        try
        {
            t.Rollback();
        }
        catch (Exception ex)
        {
            // log error in my case
        }
    }

    public static void TryCommit(this System.Data.IDbTransaction t)
    {
        try
        {
            t.Commit();
        }
        catch (Exception ex)
        {
            // log error in my case
        }
    } 
```

从 msdn 网站查看此示例：http: [//msdn.microsoft.com/en-us/library/system.data.sqlclient.sqltransaction.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqltransaction.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T01:58:00.663

好吧，首先，IMO，你不应该期望你的应用程序处理像这样的“硬”错误。您的应用程序应该了解这些业务规则是什么并对其进行说明。不要强迫您的数据库成为业务规则或约束规则警察。它应该只是一个数据规则警察，在那个时候，用 RETURN 和其他方法告诉接口是优雅的。架构的东西不应该被强加那么远。

在回答您的问题时，我怀疑在没有看到您的任何代码的情况下，您正在尝试在发生错误时进行提交，而您还不知道。这就是我的第一个陈述背后的原因......试图捕捉数据库给出的错误，而不让您的应用程序理解并参与这些规则，您会让自己头疼。

尝试这个。插入*不会*因数据库约束或其他错误而失败的行，并通过提交处理插入。走着瞧吧。然后推入一些*会*失败的记录，处理一个提交，看看你是否得到了你可爱的错误。第三，再次运行错误，强制回滚，看看是否成功。

只是一些想法。再次，作为总结，我认为这与不以优雅的方式从数据库中捕获某些“硬”错误并期望前端处理它们有关。同样，我的专家意见，不，不要这样做。一团糟。您的应用程序需要在背面的规则知识上重叠。这些东西已经到位，只是为了确保在测试期间不会发生这种情况，并且偶尔会出现这样的错误，然后将其放在前面以处理忘记的外键表集查找。

希望能帮助到你。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-06-27T14:12:15.823

我的问题也是类似的，原来是我自己做的。我在 VS2008 项目中运行了一堆脚本来创建存储过程。在其中一个过程中，我使用了一笔交易。该脚本在事务中执行创建过程，而不是将事务代码作为过程的一部分。因此，当它没有错误地结束时，它提交了脚本的事务。.Net 代码也在使用然后提交一个事务，当它试图关闭已经在 SQL 脚本中关闭的事务时，就会出现僵尸效应。我从 SQL 脚本中删除了事务，依赖于在 .Net 代码中打开和检查的事务，这解决了问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-05T04:27:32.520

您已经证明您的数据没有任何合理怀疑。
FWIW，我宁愿将插入移动到 SPROC 中并且根本不使用事务。
如果您需要 UI 做出响应，请使用后台工作人员来执行数据库任务。
对我来说，交易是针对相互关联的活动，而不是节省时间的工具。插入成本必须在沿线某处支付。

我最近在一个数据库应用程序上使用了 ANTS 分析器，并且惊讶地看到间歇性 SQlClient 异常显示在稳定执行的代码中。打开连接时，错误在框架中很深。它们永远不会浮出水面，也不会被客户端代码检测到。所以...重点？
它并非一帆风顺，将繁重的工作从 UI 上移开并接受成本。HTH 鲍勃

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-10T10:40:55.380

我也面临同样的问题。

```
This SqlTransaction has completed; it is no longer usable 
```

经过一番研究，我发现我的数据库日志文件大小为 40GB 左右。
大数据量导致我的 sql 事务未提交。

因此，我的解决方案是通过查看[此参考链接](https://stackoverflow.com/questions/56628/how-do-you-clear-the-transaction-log-in-a-sql-server-2005-database/7952692#7952692)`shrink`来记录文件大小。

```
CREATE PROCEDURE sp_ShrinkLog_ByDataBaseName(
@DataBaseName VARCHAR(200)
)
AS
BEGIN

DECLARE @DBName VARCHAR(200)
DECLARE @LogFileName VARCHAR(200)
SET @DBName = @DataBaseName

SELECT @LogFileName = [Logical File Name]
FROM
(
SELECT
    DB_NAME(database_id)  AS "Database Name", 
type_desc             AS "File Type", 
name                  AS "Logical File Name", 
physical_name         AS "Physical File", 
state_desc            AS "State"
FROM
    SYS.MASTER_FILES
WHERE
    database_id = DB_ID(@DBName)
    and type_desc = 'LOG'
) AS SystemInfo
SELECT LogFileName = @LogFileName

EXECUTE(
'USE ' + @DBName + ';

-- Truncate the log by changing the database recovery model to SIMPLE.
ALTER DATABASE ' + @DBName + '
SET RECOVERY SIMPLE;

-- Shrink the truncated log file to 1 MB.
DBCC SHRINKFILE (' + @LogFileName + ', 1);

-- Reset the database recovery model.
ALTER DATABASE ' + @DBName + '
SET RECOVERY FULL;

')
END 
```

然后执行它`EXEC sp_ShrinkLog_ByDataBaseName 'Yor_DB_NAME'`。

如果这对您不起作用，这是[另一种](http://support.microsoft.com/kb/912732)我认为可行的解决方案。

# c++ - 指向指针问题的指针

> ID：611703
> 
> 赞同：4
> 
> 时间：2009-03-04T17:52:17.790
> 
> 标签：c++, pointers, smart-pointers

我有一个带有指向接口对象的（非智能）指针的类（我们称之为 pInterface），我正在构建一个嵌套类，它也需要访问该接口。我将通过将指向接口的指针传递给嵌套类的构造函数来解决这个问题，如下所示：

```
CNestedClass someClass( pInterface, ... ); 
```

但是，我不确定将此指针存储在嵌套类中的最佳方式。我可以使用：

```
1) A scoped (or other smart) pointer (to the original object)
2) A pointer to a pointer 
```

你们会建议什么，为什么？

编辑：我应该澄清 - 嵌套类将需要调用接口对象上的方法，但是它不会创建它（或修改“指向”的对象），父类对此负责。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-04T17:57:25.297

如果任一类都可以更改指针的值，则使用指向指针的指针 - 例如，通过删除现有对象并用新对象替换它。这允许两个类通过解除对指针的引用仍然使用相同的对象。

如果不是，您关心的是确保对象在两个类的整个生命周期内保持有效。

*   如果嵌套类的寿命较短，您不必担心。
*   如果它是相同的，只要你以正确的顺序清理（例如首先嵌套类，然后是对象）然后再一次，你不必担心
*   如果嵌套类在所有者被销毁后仍然存在，那么您必须实现一种方法来确保对象也存在。

如果您需要确保对象的生命周期，可以通过引用计数语义来完成，无论是手动还是通过智能指针接口。

对于智能指针， boost::shared_ptr 将是一个不错的选择。shared_ptr 允许一个对象的所有权被多个指针共享。当最后一个 shared_ptr 超出范围时，该对象被删除。

（注意这不是 auto_ptr 的情况，其中一个对象是独占的）。

需要注意的事项；

1.  使用 boost::shared_ptr 时，请确保嵌套类具有 shared_ptr 的**副本**，而不是引用/指针。
2.  std::auto_ptr 的行为完全不同，对象是独占而不是共享的
3.  boost::shared_ptr 只能用于堆对象，例如从调用“new”返回的指针

例子：

```
typedef boost::shared_ptr<Interface> shared_interface;

class NestedClass
{
  shared_interface mInterface; // empty pointer
}

void NestedClass::setInterface(shared_interface& foo)
{
  mInterface= foo; // take a copy of foo.
}

void ParentClass::init( void )
{
  // mInterface is also declared as shared_interface
  mInterface = new Interface();
  mNestedClass->setInterface(mInterface);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T18:01:17.750

您可能希望使用指向指针的指针的另一个原因是*外部*代码可能会更改原始指针值（例如，使其指向新对象，或在释放它指向的对象后将其设置为 NULL）。但是，IMO 在将指针提供给其他人之后更改指针是非常糟糕的做法。

因此，如果外部代码和嵌套类都没有改变指针，只需将其作为原始指针的副本作为成员变量（字段）存储在嵌套类中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T17:53:53.387

传入一个指向你的接口的指针的地址（IMyInterface**ppInterface），如果它是由类实现的，则填充指针。

该类可以将其 this 指针转换为该接口并填充指针 *ppInterface。如果类没有实现这个接口，它可以将 *ppInterface 设置为 NULL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T18:01:10.387

基本上，您在两个不同的对象之间共享指向同一对象的指针。如果您不使用任何智能指针，只需将指针存储到共享对象即可。您必须小心共享对象的所有权，即哪个对象负责解除分配共享对象并通知其他对象它已经消失。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T18:18:13.483

```
class Outer
{
    class Inner
    {
    };
}; 
```

由于 Outer 的对象仅持有指向 pInterface 对象的 RAW 指针，这意味着 Outer 对象不拥有或无法控制 pInterface 对象的生命周期。因此，我们希望可以保证 pInterface 对象与外部对象一样长；在这种情况下，甚至没有理由使用指针，您可以只使用引用（假设不存在 pInterface 为 NULL 的情况）。

Inner 如何持有它的“引用”（不是 C++ 引用）取决于我们需要更多关于所涉及对象之间关系的信息！

*   内部对象和外部对象之间的关系是什么。
*   与继承 pInterface 指针的 Outer 对象相比，Inner 对象的寿命是多少？
*   什么是 Outer 对象的寿命比 pInterface 对象短的保证。

等等

# javascript - 如何在所有浏览器中实现一致的布局？

> ID：611704
> 
> 赞同：18
> 
> 时间：2009-03-04T17:52:40.657
> 
> 标签：javascript, jquery, html, css

我即将结束我的[小学习项目](http://www.my-clock.net)中的重复警报。它仍然充满了错误，但由于这是一个周末项目，我正在慢慢纠正它们。我的问题是跨浏览器的布局不一致。

目前，我正在尝试改进`My Alarms`登录后的“”框（请不要尝试破解我的网站，它仍然非常不稳定）。

### 问题

你能给我什么样的技巧、技巧、技巧等来确保跨浏览器的布局兼容性？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-03-04T17:55:50.480

我发现避免痛苦的最佳策略是遵循以下规则：

1.  首先构建一个更兼容且对开发人员友好的浏览器，例如 firefox，定期在 IE（以及 safari/chrome(webkit) 和 opera）中进行彻底测试。
2.  使用严格的文档类型——你不一定需要*完美的*标记，但它应该非常好——足以避免浏览器的怪癖模式，因为怪癖根据定义不是标准的
3.  使用[重置样式表](https://stackoverflow.com/questions/167531/is-it-ok-to-use-a-css-reset-stylesheet)。请注意，根据工作表的内容，该项目可能与#2 的目标不兼容。
4.  使用 jQuery 或 Prototype 之类的 javascript 框架 - 它们可以隐藏一些 javascript 和 DOM 不兼容性。
5.  使用良好的语义布局 - 对于行为不端的浏览器，它更有可能很好地降级
6.  接受它不会是完美的，不要担心真正的小差异

遵循这些规则，一开始就没有那么多问题。

有关 TODO 参考，请参阅以下问题：
[https ://stackoverflow.com/questions/72394/what-should-a-developer-know-before-building-a-public-web-site](https://stackoverflow.com/questions/72394/what-should-a-developer-know-before-building-a-public-web-site)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-04T18:39:21.513

您需要正确的文档类型，以便页面以符合标准的模式呈现。

[W3C：推荐的 DTD 列表](http://www.w3.org/QA/2002/04/valid-dtd-list.html)

尽量保持标准。这就是构建浏览器所遵循的，所以这是你能找到的最好的共同点。此外，这也是未来浏览器将遵循的方式，因此您可以尽可能准确地预测代码在未来浏览器版本中的表现。

构建时，首先在不是 Internet Explorer 的浏览器中测试页面。如果您首先为 IE 构建，您将依赖它的呈现错误，然后您将遇到很大的问题，使其在没有这些错误的浏览器中看起来相同。Firefox 是最常见的非 IE 浏览器，在遵循标准方面也是最中立的浏览器之一。

Firefox 的 Firebug 插件可以让您准确查看每个元素应用了哪些样式，并且您还可以实时调整样式，因此这是一个非常方便的工具。

尽量使布局尽可能简单和健壮，并尽可能保持 html 的原始语义。搜索引擎在为其设计的元素中查找内容，例如标签中的标题`h1`和标签中的文本`p`，因此通过遵循标记的原始意图，您可以使您的页面在网络上更加可见。

您可能必须添加一些额外的样式来抑制 IE 中的怪癖，例如为应该设法自行计算其高度的元素指定高度，添加 display:inline; 浮动元素（仍然是块元素）来摆弄 IE 的内部渲染标志，或者使用溢出：隐藏来抑制 IE 使所有元素至少高一个字符的冲动。使用填充而不是边距，因为 IE 无法正确折叠边距。

仅在不得已的情况下使用条件标签。通过使用特定于版本的代码，您可以获得可能必须为每个发布的新浏览器版本维护的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T17:56:26.907

针对 FireFox 进行设计和测试...

然后进行一些在 IE 中工作所需的更改。

我是一个 IE 人，但是当我让它在 IE 中看起来不错，然后 Firefox 得到它的正确/错误时，这让我发疯了。我知道 Firefox 更接近标准，但 IE 做出了很好的假设......所以

啊！)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T17:57:46.980

首先对符合标准的浏览器进行编码，然后使用[条件样式表](http://css-tricks.com/how-to-create-an-ie-only-stylesheet/)来修复各种 IE 版本中的问题。大多数其他问题都是次要的，IE 通常需要最大的努力来强制它匹配。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T18:48:12.867

除了 Joel 的回答之外，我发现它有助于使事情尽可能简单。此外，使用包装 div 有很大帮助 - 您可以将简单的样式应用于应该适用于所有浏览器的包装器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T22:09:14.110

我努力确保我的网站设计是跨浏览器兼容的。我的流程如下：

1.  在 Photoshop 中绘制粗略的布局想法。甚至在一张纸上。
2.  在 Photoshop 中模拟屏幕截图（在此处插入最喜欢的照片编辑器）。
3.  根据上述设计开始建站。
4.  决定与哪些浏览器兼容很重要。
5.  使用这些浏览器测试每个主要设计更改的站点
6.  为了让所有目标浏览器正常工作，我不得不使用一些[CSS hack 。](http://www.google.com.au/search?hl=en&q=CSS+Browser+hacks&meta=)我尽量避免屈服于这些，因为它们可能会对未来的某些浏览器版本产生更长的意外副作用。
7.  最后一步是在所有测试浏览器中查看最终产品。会有细微的差异，这是您需要决定何时画线的地方。因为很多时间可以很容易地花在推动像素上。

一般来说，我的目标是排名前 4 位的浏览器：IE-7、IE-8、FF、Chrome 和 Safari。我最近使用 CSS hack 来解决 IE-7 的问题：

```
width: 50px;
*width: 45px;  /* IE-7 Hack */ 
```

这通过使用一点无效的 CSS (*) 来工作，列出的其他浏览器将正确地忽略此 hack，但 IE-7 会读取它。因为它是最后读取的，所以它被应用

提示：考虑实际[浏览器市场份额](http://www.w3schools.com/browsers/browsers_stats.asp)。这可能与您的实际访问者有很大不同。记录哪些浏览器会在未来某个时间访问您的网站，并确保您至少涵盖了大多数浏览器品牌 + 版本

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2009-03-09T16:42:52.250

我被遗忘的门票：使用嵌套表进行设计。另一种方法是：只需将您的网站创建为大图像而不是 html。缺点是速度慢并且限制了功能。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2009-03-09T17:01:10.787

这听起来很傻，但是对于每个请求，您都可以将所有内容呈现到一个图像文件中，然后只用那个文件来响应请求。

好的？

# java - Java 浮点数学 - （英尺/米的转换）

> ID：611709
> 
> 赞同：3
> 
> 时间：2009-03-04T17:54:34.117
> 
> 标签：java, floating-point

我认为非常基本的问题 - 我正在执行此功能：

```
private double convertMetersToFeet(double meters)
{
  //function converts Feet to Meters.
      double toFeet = meters;
      toFeet = meters*3.2808;  // official conversion rate of Meters to Feet
      return toFeet;
} 
```

问题是输出；例如，我从 101 的输入中得到 337.36080000000004。截断浮点数的适当做法是什么？

正如下面的答案所假设的，我希望 4 个有效数字与我的转化率保持一致。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-04T18:00:05.493

您可以使用[NumberFormat](http://java.sun.com/j2se/1.5.0/docs/api/java/text/NumberFormat.html)实例。

```
NumberFormat nf = NumberFormat.getInstance(Locale.UK);
nf.setMinimumFractionDigits(4);
nf.setMaximumFractionDigits(4);
System.out.println(nf.format(feet)); 
```

或者您可以使用[DecimalFormat](http://java.sun.com/j2se/1.5.0/docs/api/java/text/DecimalFormat.html)。

```
DecimalFormat df = new DecimalFormat("0.0000");
System.out.println(df.format(feet)); 
```

后者 (DecimalFormat) 用于当您明确要声明格式时使用，前者 (NumberFormat) 用于需要本地化设置。

对于四个一致的小数，如果您不是在很长的距离上工作，则无需拖入 BigDecimal。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T20:19:35.343

为了后代，我正在回答我自己的问题。我使用了上面的 DecimalFormat 答案，但答案没有考虑到方法的返回类型。

这是完成的代码：

```
 private double convertMetersToFeet(double meters)
{
  //function converts Feet to Meters.
      double toFeet = meters;
      toFeet = meters*3.2808;  // official conversion rate of Meters to Feet
      String formattedNumber = new DecimalFormat("0.0000").format(toFeet); //return with 4 decimal places
      double d = Double.valueOf(formattedNumber.trim()).doubleValue();
      return d;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T18:02:48.263

如果您需要精确计算，请使用[BigDecimal](http://java.sun.com/javase/6/docs/api/java/math/BigDecimal.html)而不是 float。如果您只想在打印时截断，请使用[DecimalFormat](http://java.sun.com/javase/6/docs/api/java/text/DecimalFormat.html)。

```
DecimalFormat df = new DecimalFormat ("0.00");
System.out.println(df.format(convertMetersToFeet(101))); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T17:57:07.560

用于`java.math.BigDecimal`十进制算术。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T22:16:14.427

如果它不是用于打印，您不应该关心错误。337.36080000000004 与 337.3608 一样正确，因为因子中只有 5 个有效数字，而测试输入中只有 3 个有效数字。（我当然希望你的方法给出的答案是 331 而不是 337）

[但是，从另一个问题](https://stackoverflow.com/questions/329957/truncate-decimal-number-not-round-off)中提取的这条线似乎也可以解决问题。

```
double toFeet = ((int)(meters*3.2808*10000))/10000.0; 
```

唯一的问题是溢出速度更快。

# xaml - Silverlight - XAML 中的相对 DataContext？

> ID：611712
> 
> 赞同：2
> 
> 时间：2009-03-04T17:55:35.737
> 
> 标签：xaml, silverlight, data-binding, datacontext

在 Silverlight XAML 中，我想我刚刚意识到嵌套容器上的 DataContext 声明与父容器的 DataContext 相关。请大家确认一下。

如果是这样，那么让我问这个问题：在一个子 XAML 容器元素（即 StackPanel）上，你将如何跳出那个相关的 DataContext 树，并从更高的位置开始，或者如果你想设置一个不同的 DataContext 一起开始StackPanel 上的 DataContext 到不同的根上下文？

换句话说，如何从父 DataContext 中打破子 DataContext？

（寻找 XAML 代码解决方案/语法）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T18:26:05.710

你的第一个假设是正确的。DataContext 是由嵌套元素继承的。

在子 XAML 容器元素上，您始终可以重新定义 DataContext 是什么。

请参见下面的示例：

```
 <UserControl.Resources>
        <local:Customer x:Key="Cust">
        <local:Supplier x:Key="Supp">
    </UserControl.Resources>
    <Grid x:Name="LayoutRoot" Background="White" DataContext="{StaticResource Cust}">
        <Grid.RowDefinitions>
            <RowDefinition></RowDefinition>
            <RowDefinition></RowDefinition>
        </Grid.RowDefinitions>
        <StackPanel Orientation="Horizontal" Grid.Row="0">
            <TextBlock Text="Customer Name: " />
            <TextBox Text="{Binding Path=Name}"/>
        </StackPanel>
        <StackPanel Orientation="Horizontal" Grid.Row="1" DataContext="{StaticResource Supp}">
            <TextBlock Text="Supplier Name: " />
            <TextBox Text="{Binding Path=Name}"/>
            <TextBlock Text=" Telephone: " />
            <TextBox Text="{Binding Path=Telephone}"/>
        </StackPanel>
    </Grid> 

```

以下是上述示例的“模型”类：

```
 public class Customer
    {
        public Customer()
        {
            Name = "Customer name";
            Address = "Customer address";
        }
        public string Name { get; set; }
        public string Address { get; set; }
    }

    public class Supplier
    {
        public Supplier()
        {
            Name = "Supplier name";
            Address = "Supplier address";
            Telephone = "(555)555-5555";
        }

        public string Name { get; set; }
        public string Address { get; set; }
        public string Telephone { get; set; }
    } 

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-28T01:29:49.370

查看这个博客，它详细介绍了一个代理类，用于从 xaml 中完成您需要的所有工作。

[ [http://weblogs.asp.net/dwahlin/archive/2009/08/20/creating-a-silverlight-datacontext-proxy-to-simplify-data-binding-in-nested-controls.aspx][1]](http://weblogs.asp.net/dwahlin/archive/2009/08/20/creating-a-silverlight-datacontext-proxy-to-simplify-data-binding-in-nested-controls.aspx][1])

# perl - 获取 Perl 数组的最后 N 个元素的最佳方法是什么？

> ID：611723
> 
> 赞同：20
> 
> 时间：2009-03-04T17:57:11.880
> 
> 标签：perl, arrays, slice

获取 Perl 数组的最后 N 个元素的最佳方法是什么？

如果数组小于 N，我不希望`undefs`返回值中有一堆。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-04T18:06:40.423

```
@last_n = @source[-$n..-1]; 
```

如果你不需要`undef`s，那么：

```
@last_n = ($n >= @source) ? @source : @source[-$n..-1]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-04T18:01:12.260

我认为您想要的称为[slice](http://perldoc.perl.org/perldata.html#Slices)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-04T18:06:52.933

```
@a = (a .. z);
@last_five = @a[ $#a - 4 .. $#a ];
say join " ", @last_five; 
```

输出：

> vwxyz

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-21T14:57:53.460

简单，没有数学：

```
@a = reverse @a;
@a = splice(@a, 0, $elements_to_keep);
@a = reverse @a; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-11T10:05:17.300

由于标量上下文中的@a 给出了数组 a 的长度，并且因为`@a == $#a + 1`（除非`$[`设置为非零），所以可以通过`@a[$n..@a-1]`--#tmtowtdi 获得从第 $n 个（从零开始计数）到最后一个元素的切片。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-05-29T08:36:59.317

TMTOWTDI，但我认为这更容易阅读（但从 中删除了元素`@source`）：

```
my @last_n = splice(@source, -$n); 
```

如果你不确定它`@source`至少有`$n`元素：

```
my @last_n = ($n >= @source) ? @source : splice(@source, -$n); 
```

# java - 如何处理 Java BigDecimal 性能？

> ID：611732
> 
> 赞同：62
> 
> 时间：2009-03-04T17:58:35.200
> 
> 标签：java, optimization, currency, math, bigdecimal

我为生活编写货币交易应用程序，所以我必须使用货币值（遗憾的是，Java 仍然没有十进制浮点类型并且没有任何东西支持任意精度的货币计算）。“使用 BigDecimal！” ——你可能会说。我愿意。但是现在我有一些代码，其中性能**是**一个问题，BigDecimal 比`double`原语慢 1000 多倍（！）。

计算非常简单：系统所做的是`a = (1/b) * c`多次计算（其中和`a`是定点值）。然而，问题在于这个。我不能使用定点算术，因为没有定点。而且不仅丑陋，而且速度缓慢。`b``c``(1/b)``BigDecimal result = a.multiply(BigDecimal.ONE.divide(b).multiply(c)`

我可以用什么来代替 BigDecimal？我需要至少 10 倍的性能提升。我发现了其他优秀[的 JScience 库](http://www.jscience.org "JScience")，它具有任意精度的算术，但它甚至比 BigDecimal 还要慢。

有什么建议么？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-04T18:02:07.080

也许您应该从用 a = c/b 替换 a = (1/b) * c 开始？它不是 10 倍，但仍然是一些东西。

如果我是你，我会创建自己的 Money 类，它会保留多头美元和多头美分，并在其中做数学运算。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-04T19:26:33.117

大多数双重操作为您提供了足够的精度。你可以用双精度表示 10 万亿美元，这对你来说可能绰绰有余。

在我工作过的所有交易系统（四家不同的银行）中，他们都使用双精度和适当的四舍五入。我认为没有任何理由使用 BigDecimal。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-02-06T16:23:26.353

所以我最初的答案是完全错误的，因为我的基准写得不好。我想我是应该受到批评的人，而不是 OP ;) 这可能是我写过的第一个基准测试之一……哦，好吧，这就是你学习的方式。而不是删除答案，这里是我没有测量错误的结果。一些注意事项：

*   预先计算数组，这样我就不会通过生成它们来弄乱结果
*   *永远*不要打电话`BigDecimal.doubleValue()`，因为它非常慢
*   不要通过添加`BigDecimal`s 来弄乱结果。只需返回一个值，并使用 if 语句来防止编译器优化。不过，请确保它在大部分时间都可以工作，以允许分支预测消除那部分代码。

测试：

*   BigDecimal：完全按照您的建议进行数学运算
*   BigDecNoRecip: (1/b) * c = c/b, 只做 c/b
*   双倍：用双打做数学

这是输出：

```
 0% Scenario{vm=java, trial=0, benchmark=Double} 0.34 ns; ?=0.00 ns @ 3 trials
33% Scenario{vm=java, trial=0, benchmark=BigDecimal} 356.03 ns; ?=11.51 ns @ 10 trials
67% Scenario{vm=java, trial=0, benchmark=BigDecNoRecip} 301.91 ns; ?=14.86 ns @ 10 trials

    benchmark      ns linear runtime
       Double   0.335 =
   BigDecimal 356.031 ==============================
BigDecNoRecip 301.909 =========================

vm: java
trial: 0 
```

这是代码：

```
import java.math.BigDecimal;
import java.math.MathContext;
import java.util.Random;

import com.google.caliper.Runner;
import com.google.caliper.SimpleBenchmark;

public class BigDecimalTest {
  public static class Benchmark1 extends SimpleBenchmark {
    private static int ARRAY_SIZE = 131072;

    private Random r;

    private BigDecimal[][] bigValues = new BigDecimal[3][];
    private double[][] doubleValues = new double[3][];

    @Override
    protected void setUp() throws Exception {
      super.setUp();
      r = new Random();

      for(int i = 0; i < 3; i++) {
        bigValues[i] = new BigDecimal[ARRAY_SIZE];
        doubleValues[i] = new double[ARRAY_SIZE];

        for(int j = 0; j < ARRAY_SIZE; j++) {
          doubleValues[i][j] = r.nextDouble() * 1000000;
          bigValues[i][j] = BigDecimal.valueOf(doubleValues[i][j]); 
        }
      }
    }

    public double timeDouble(int reps) {
      double returnValue = 0;
      for (int i = 0; i < reps; i++) {
        double a = doubleValues[0][reps & 131071];
        double b = doubleValues[1][reps & 131071];
        double c = doubleValues[2][reps & 131071];
        double division = a * (1/b) * c; 
        if((i & 255) == 0) returnValue = division;
      }
      return returnValue;
    }

    public BigDecimal timeBigDecimal(int reps) {
      BigDecimal returnValue = BigDecimal.ZERO;
      for (int i = 0; i < reps; i++) {
        BigDecimal a = bigValues[0][reps & 131071];
        BigDecimal b = bigValues[1][reps & 131071];
        BigDecimal c = bigValues[2][reps & 131071];
        BigDecimal division = a.multiply(BigDecimal.ONE.divide(b, MathContext.DECIMAL64).multiply(c));
        if((i & 255) == 0) returnValue = division;
      }
      return returnValue;
    }

    public BigDecimal timeBigDecNoRecip(int reps) {
      BigDecimal returnValue = BigDecimal.ZERO;
      for (int i = 0; i < reps; i++) {
        BigDecimal a = bigValues[0][reps & 131071];
        BigDecimal b = bigValues[1][reps & 131071];
        BigDecimal c = bigValues[2][reps & 131071];
        BigDecimal division = a.multiply(c.divide(b, MathContext.DECIMAL64));
        if((i & 255) == 0) returnValue = division;
      }
      return returnValue;
    }
  }

  public static void main(String... args) {
    Runner.main(Benchmark1.class, new String[0]);
  }
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-04T18:23:44.657

假设你可以工作到任意但已知的精度（比如十亿分之一美分）并且有一个你需要处理的已知最大值（一万亿美元？），你可以编写一个类，将该值存储为十亿分之一的整数一分钱。你需要两个 long 来表示它。这应该比使用 double 慢十倍；大约是 BigDecimal 的一百倍。

大多数操作只是对每个部分执行操作并重新归一化。除法稍微复杂一些，但并不多。

编辑：回应评论。您将需要在您的类上实现位移操作（很容易，因为高 long 的乘数是 2 的幂）。要进行除法，请移动除数，直到它不大于被除数；从被除数中减去移位的除数并增加结果（使用适当的移位）。重复。

再次编辑：您可能会发现 BigInteger 在这里可以满足您的需求。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-04T18:06:19.347

将多头存储为美分数。例如，`BigDecimal money = new BigDecimal ("4.20")`变成`long money = 420`。您只需要记住修改 100 即可获得美元和美分的输出。如果你需要跟踪，比如说，十分之一美分，它会变成`long money = 4200`。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-04T18:09:59.633

您可能想转向定点数学。现在只是在搜索一些图书馆。在 sourceforge[定点上，](http://sourceforge.net/projects/jmfp)我还没有深入研究过这个。[熊熊的](http://www.beartronics.com/imode/fplib/index.html)

你用 org.jscience.economics.money 测试过吗？因为这保证了准确性。固定点将仅与分配给每个部分的位数一样准确，但速度很快。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-04T19:12:23.400

就个人而言，我不认为 BigDecimal 是理想的。

您确实想在内部使用 long 来实现您自己的 Money 类，以表示最小单位（即美分、10 美分）。在这方面有一些工作，实施`add()`等等`divide()`，但这并不是那么难。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-04T18:40:22.150

What version of the JDK/JRE are you using?

Also you might try [ArciMath BigDecimal](http://users.belgacombusiness.net/arci/) to see if theirs speeds it up for you.

Edit:

I remember reading somewhere (I think it was Effective Java) that the BigDecmal class was changed from being JNI called to a C library to all Java at some point... and it got faster from that. So it could be that any arbitrary precision library you use is not going to get you the speed you need.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-29T05:00:59.660

```
Only 10x performance increase desired for something that is 1000x slower than primitive?!. 
```

在这方面投入更多的硬件可能会更便宜（考虑到货币计算错误的可能性）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-09-12T15:58:16.473

Commons Math - Apache Commons 数学库

[http://mvnrepository.com/artifact/org.apache.commons/commons-math3/3.2](http://mvnrepository.com/artifact/org.apache.commons/commons-math3/3.2)

根据我自己对特定用例的基准测试，它比双倍慢 10 - 20 倍（比 1000 倍好得多）——基本上是用于加法/乘法。在对另一种算法进行基准测试后，该算法具有一系列加法，然后是幂运算，性能下降要差得多：200x - 400x。所以 + 和 * 看起来相当快，但不是 exp 和 log。

> *Commons Math 是一个轻量级、独立的数学和统计组件库，解决了 Java 编程语言或 Commons Lang 中不可用的最常见问题。*

注意：API 保护构造函数在命名工厂 DfpField（而不是更直观的 DfpFac 或 DfpFactory）时强制使用工厂模式。所以你必须使用

```
new DfpField(numberOfDigits).newDfp(myNormalNumber) 
```

实例化一个 Dfp，然后你可以调用`.multiply`或其他任何东西。我想我会提到这一点，因为它有点令人困惑。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-04T18:09:59.727

1/b 也不能完全用 BigDecimal 表示。请参阅 API 文档以了解结果是如何四舍五入的。

围绕一两个长字段编写自己的固定十进制类应该不会*太难。*我不知道任何合适的现成库。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-06-18T10:41:23.477

我知道我在非常老的主题下发帖，但这是谷歌发现的第一个主题。考虑将您的计算移至您可能从中获取数据进行处理的数据库。我也同意 Gareth Davis 的观点，他写道：

> . 在大多数沼泽标准 webapps 中，jdbc 访问和访问其他网络资源的开销淹没了真正快速数学的任何好处。

在大多数情况下，错误查询比数学库对性能的影响更大。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-04-27T19:58:24.617

在 64 位 JVM 上，按如下方式创建 BigDecimal 使其速度提高约 5 倍：

```
BigDecimal bd = new BigDecimal(Double.toString(d), MathContext.DECIMAL64); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-11T20:18:50.280

早在 99 年的股票交易系统中就有类似的问题。在设计之初，我们选择将系统中的每个数字表示为 long 乘以 1000000，因此 1.3423 是 1342300L。但主要驱动因素是内存占用而不是直线性能。

*一句话提醒，除非我真的*确定数学表现非常关键，否则我今天不会再这样做了。在大多数标准 webapps 中，jdbc 访问和访问其他网络资源的开销淹没了快速计算的任何好处。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-05-04T16:20:52.123

容易...对您的结果进行四舍五入通常会消除双重数据类型的错误。如果您正在计算余额，您还必须考虑谁将拥有四舍五入造成的更多/更少便士。

bigdeciaml 计算也会产生更多/更少的便士，考虑 100/3 的情况。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-04T19:08:00.227

JNI有可能吗？您可能能够恢复一些速度并可能利用现有的本机定点库（甚至可能还有一些 SSE* 优点）

也许[http://gmplib.org/](http://gmplib.org/)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-04T19:25:17.567

也许您应该考虑获得硬件加速的十进制算术？

[http://speleotrove.com/decimal/](http://speleotrove.com/decimal/)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-10-30T05:19:42.200

似乎最简单的解决方案是使用 BigInteger 而不是 long 来实现pesto 的解决方案。如果它看起来很乱，那么编写一个包装 BigInteger 的类来隐藏精度调整会很容易。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-06-25T16:49:45.590

我知道这是一个非常古老的线程，但我正在编写一个应用程序（顺便说一下，一个交易应用程序），其中在几千个历史烛台上计算 MACD 等指标（计算多个指数移动平均线）的数量令人无法接受时间（几分钟）。我正在使用 BigDecimal。

每次我滚动或调整窗口大小时，它都必须遍历缓存值以调整 Y 比例，但即使这样也需要几秒钟才能更新。它使应用程序无法使用。每次我调整各种指标的参数时，重新计算都需要几分钟。

然后我把它全部改成双倍，它的速度要快得多。问题是我使用哈希图缓存值。我想出的解决方案使用一个双值的包装池。通过合并包装器，您不会受到自动装箱到/来自 Double 的性能影响。

该应用程序现在立即计算 MACD（+MACD 信号，MACD 直方图），没有延迟。BigDecimal 对象创建的成本是惊人的。想想像 a.add( b.multiply( c )).scale(3) 这样的东西，以及一个语句创建了多少个对象。

```
 import java.util.HashMap;

public class FastDoubleMap<K>
{
    private static final Pool<Wrapper> POOL = new Pool<FastDoubleMap.Wrapper>()
    {
        protected Wrapper newInstance()
        {
            return new Wrapper();
        }
    };

    private final HashMap<K, Wrapper> mMap;

    public FastDoubleMap()
    {
        mMap = new HashMap<>();
    }

    public void put( K pKey, double pValue )
    {
        Wrapper lWrapper = POOL.checkOut();
        lWrapper.mValue = pValue;
        mMap.put( pKey, lWrapper );
    }

    public double get( K pKey )
    {
        Wrapper lWrapper  = mMap.get( pKey );
        if( lWrapper == null )
        {
            return Double.NaN;
        }
        else
        {
            return lWrapper.mValue;
        }
    }

    public double remove( K pKey )
    {
        Wrapper lWrapper = mMap.remove( pKey );
        if( lWrapper != null )
        {
            double lDouble = lWrapper.mDouble;
            POOL.checkIn( lWrapper );
            return lDouble;
        }
        else
        {
            return Double.NaN;
        }
    }

    private static class Wrapper
        implements Pooled
    {
        private double mValue ;

        public void cleanup()
        {
            mValue = Double.NaN;
        }
    }
} 
```

# compact-framework - 通过 .net CF 应用程序更改用户密码

> ID：611734
> 
> 赞同：0
> 
> 时间：2009-03-04T17:59:06.290
> 
> 标签：compact-framework

我们的用户密码经常过期，我们需要一种方法让用户在 CF 应用程序中设置新密码（CF2.0 WIncE5.0，HP 瘦客户端）。

有任何想法吗？我猜我将不得不使用 P/Invoke，并且链接将不胜感激。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T16:09:05.717

如果您指的是本地操作系统帐户密码或远程域密码，请不要这样做。很难获得正确的安全性，这是一个更好的功能，留给操作系统工具和 UI（调用它们怎么样？），最重要的是，您将教您的用户将他们的凭据委托给 some_random_app。这不酷...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T16:49:41.207

毕竟我不必通过CF做

# sql-server - 在 SQL Server Reporting Services 中将日期从“yyyyMMdd”格式化为“M/d/yyyy”的正确表达式是什么？

> ID：611735
> 
> 赞同：3
> 
> 时间：2009-03-04T17:59:10.673
> 
> 标签：sql-server, reporting-services, formatting

我以“yyyyMMdd”的形式在我的数据集中获取日期（即 20080228 表示 2008 年 2 月 28 日）

我需要将这些转换为“M/d/yyyy”

例子：

```
20080228 = 2/28/2008
20080101 = 1/1/2008
20081001 = 10/1/2008
20081212 = 12/12/2008 
```

处理这个问题的正确表达是什么？

**编辑**

我使用的表达式（ORDDTE 是“yyyyMMdd”格式，我有一个西班牙语或英语日期格式的开关）：

```
=CDate(Mid(First(Fields!ORDDTE.Value, "ReturnTagHeader").ToString(), 5, 2) + "/" + Right(First(Fields!ORDDTE.Value, "ReturnTagHeader").ToString(), 2) + "/" + Left(First(Fields!ORDDTE.Value, "ReturnTagHeader").ToString(), 4)).ToString(IIf(Parameters!Language.Value = "ES", "d/M/yyyy", "M/d/yyyy")) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T18:04:59.177

试一试。您可以使用字符串函数。我猜这个输入/字段/参数总是会有一个 2 位数的月份和 2 位数的日期，所以你可以摆脱这个......在日期字段上设置表达式，如下所示：

```
=MID(Fields!ORDDTE.Value.ToString(), 5, 2) 
  + "/" + RIGHT(Fields!ORDDTE.Value.ToString(), 2)
  + "/" + LEFT(Fields!ORDDTE.Value.ToString(), 4) 
```

你也可以尝试做这样的事情......在[这里](http://snippets.dzone.com/posts/show/2237)找到......

```
=System.DateTime.ParseExact(Fields!ORDDTE.Value,"dd/MM/yyyy",System.Globalization.DateTimeFormatInfo.InvariantInfo).ToString("yyyyMMdd") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T18:01:50.230

如果您在字段上设置表达式，您应该能够将其包装在 FormatDateTime()

例子： `formatdatetime(FieldWhatever, 0)`

0 应该是您要查找的特定格式的说明符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T18:22:59.773

试试这个：

```
Format(FieldWhatever,"MM/dd/yyyy") 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-04T18:55:32.457

为什么不在数据集中的 sql 调用中将该字段转换为日期时间。

```
Select CAST(DateField AS datetime) As Date FROM DateTable 
```

然后为你的表达：

```
=Cdate(Fields!Date.Value).ToShortDateString 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-10T13:52:44.897

这推断 datevalue 是以整数的形式出现的，需要对其进行转换才能使用 MID()。

日期值 = 20080901 <- yyyyMMdd

= Mid(cSTR(DATEVALUE) ,5 ,2) &"/"& Mid(cSTR(DATEVALUE) ,7 ,2) &"/"& Mid(cSTR(DATEVALUE) ,1 ,4)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T18:16:03.160

除了 Report Services 表达式，您还可以格式化存储过程中的日期：

```
select 
    CONVERT(VARCHAR(10), [dateField], 101) as 'date' 
from someTable 
```

这有缺点，因为这将是通用的，如果您的报告必须国际化，您将处于不利地位。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-27T18:49:51.627

迟到的答案...

为什么不将“报告语言”设置为“用户！语言”，如此[处所述](http://msdn.microsoft.com/en-us/library/ms156493.aspx)？这会检测浏览器设置。

然后“d”表示短日期。如果需要，请使用 CDate。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-05T07:13:21.057

```
SUBSTRING((DT_WSTR,30)DATEADD("D",-1,GETDATE()),1,4) + 
SUBSTRING((DT_WSTR,30)DATEADD("D",-1,GETDATE()),6,2) +
SUBSTRING((DT_WSTR,30)DATEADD("D",-1,GETDATE()),9,2) 
```

# asp.net - 禁用“客户端已断开连接”。ASP.NET 中的错误？

> ID：611742
> 
> 赞同：2
> 
> 时间：2009-03-04T18:01:10.747
> 
> 标签：asp.net, iis, error-handling

我们的 ASP.NET 应用程序中有一个全局错误处理程序，它记录并通过电子邮件发送可能发生的任何异常错误。

ASP.NET 常见的一个错误是“客户端已断开连接”。当他们在数据仍在加载时关闭页面时发生的错误。错误本身不是问题，但它会被记录和报告。

是否有通过 IIS 或 web.config 文件设置禁用此功能？

或者基本上是使用全局错误处理程序代码逻辑过滤它的唯一方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T18:06:46.880

只需在全局错误处理程序上过滤它

# c# - LINQ to SQL - 使用部分类和方法扩展数据上下文时编译错误

> ID：611745
> 
> 赞同：8
> 
> 时间：2009-03-04T18:01:30.170
> 
> 标签：c#, linq, linq-to-sql, oop, partial-classes

我正在尝试使用我的 datacontext.designer.cs 文件中的可扩展性方法定义来进行一些验证。

所以我创建了一个新文件并添加了以下代码：

```
public partial class LawEnforcementDataContext : System.Data.Linq.DataContext
{

    partial void InsertCourse(Course instance) // this definition copied from generated file
    {
        ValidateCourse(instance);
        this.ExecuteDynamicInsert(instance);
    }

    partial void UpdateCourse(Course instance) // this definition copied from generated file
    {
        ValidateCourse(instance);
        this.ExecuteDynamicUpdate(instance);
    }

    private void ValidateCourse(Course instance)
    {
        if (instance.StartDate > instance.EndDate)
        {
            throw new ApplicationException("Start date cannot be later than end date.");
        }
    }
} 
```

由于这些错误，我无法编译：

```
Error   1   No defining declaration found for implementing declaration of partial method 'LawEnforcementDataContext.InsertCourse(reservation.lawenforcement.Course)'
Error   2   No defining declaration found for implementing declaration of partial method 'LawEnforcementDataContext.UpdateCourse(reservation.lawenforcement.Course)' 
```

我看不出我做错了什么。我以前做过。此外，在添加上述代码后，在引用由 LINQ to SQL 创建的类的代码中，它抱怨我的实体类型不再存在。就好像分部类 LawEnforcementDataContext 完全接管了生成的代码。

## 编辑

以下是生成代码的部分声明的另一半：

```
 // the class
    public partial class LawEnforcementDataContext : System.Data.Linq.DataContext

    // the methods
    partial void InsertCourse(Course instance);
    partial void UpdateCourse(Course instance); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-04T20:38:13.600

您的两个部分类是在不同的命名空间中定义的，因此编译器不会“共享”它们。

DBML 设计器的属性下有一个设置。也许它重置了？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T20:31:52.633

为了验证 Linq 中的字段，您需要实现 OnValidate 方法而不是 Insert 和 Update 方法。

例如：

```
partial void OnValidate(System.Data.Linq.ChangeAction action)
    {
        //All content items need titles
        if (Description == null || Description == "")
            throw new Exception("The description field is empty!");

        //Content types of image need...images
        if (ContentItemTypeId == (int)ContentItemTypes.Image && ImageData == null)
            throw new Exception("An image is required in order to save this content item!");

        //New Content Items don't have ids.  If a new one comes through, set the default values for it.
        if (this.ContentItemId == 0)
        {
            this.CreatedOn = DateTime.Now;
            this.LastUpdatedOn = DateTime.Now;
            this.IsDeletable = true;
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T18:04:05.873

从您的方法中删除`partial`关键字 - 生成的类没有任何部分方法。

**编辑：**部分方法仅在定义如下时才起作用：

```
partial class Foo
{
    partial void foo();
}

partial class Foo
{
    partial void foo() { }
} 
```

其中一个声明需要像抽象方法或接口方法声明一样编写。如果编译器找到一个具有实现的部分方法并且在其他地方找不到匹配的部分方法声明，则会生成此错误。

**编辑：**这是要检查的东西-参数`Course`是否可能在两个声明之一中不是完全相同的类型？换句话说，有没有可能发生过这样的事情：

```
partial class Foo
{
    partial void foo(Biz.Parameter p);
}

partial class Foo
{
    partial void foo(Baz.Parameter p) { }
}

namespace Baz
{
    class Parameter { }
}

namespace Biz
{
    class Parameter { }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T18:14:38.313

为了澄清，它是部分类，而不是其中的方法 - L2S 生成的 DataContext 类是一个部分类，但不包含任何部分方法**下面的更正**。

为了澄清*定义*和*实现*部分方法声明的区别，[这可能会有所帮助](http://blogs.msdn.com/wesdyer/archive/2007/05/31/more-on-partial-methods.aspx)。

**编辑**

好吧，我从来没有 - 我以前没有见过/使用过“#region 可扩展性方法定义”方法......你每天都会学到一些东西！无论如何，我链接到的文章是关于一般部分方法的有用讨论，与 L2S 分开。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T18:16:01.117

该错误意味着您正在实施的部分方法尚未在 LawEnforcementDataContext 类中定义。

这些方法应该在您将表添加到 DataContext 时自动定义，在生成的源（可能是 LawEnforcement.designer.cs）中查找标有 #region 可扩展性方法定义的 LawEnforcementDataContext 类中的区域，所有部分方法都将在此处定义。我希望这些方法会丢失，请尝试在 Linq 模型中删除并重新添加 Course 表以生成它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-11T05:48:47.677

罗尼，我刚刚遇到了同样的问题。警告：当您在一个实体文件中有多个类时要小心。

检查部分类的位置：您是否像我一样不小心将定义放在数据上下文括号中？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-11-03T22:14:43.660

所以，当我遇到这个错误时，我正在使用源生成器。

问题是在生成器的源代码中，我需要添加命名空间。

`string source = $@" namespace ORMSoda.Tests.TestProgram {{ public static partial class Program {{ static partial void HelloFrom(string name) {{ System.Console.WriteLine($""Generator says: Hi from '{{name}}'""); }} }} }} ";`

# jquery - 为什么使用 JQuery 生成的锚标记不会触发其 onclick 事件？

> ID：611748
> 
> 赞同：0
> 
> 时间：2009-03-04T18:02:09.357
> 
> 标签：jquery

我正在使用 jQuery 动态生成锚标记。我已经向它添加了一个 onclick 属性，但是当我单击链接时，onclick 不会触发。

我正在生成链接如下：

```
$(document).ready(function() {

    var attributes = {
        "id": "xxx",
        "onclick": "alert('xxxx');",
        "href": "https://localhost/widget/TabTest.aspx#"
    };
    var link = $.create("a", attributes);
    $(link).append("xxxx");
    $("#WidgetContainer").append(link);
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T18:09:05.033

使用 jQuery 的 click() 函数设置 click 属性。

```
var attributes = {
     "id": "xxx",
     "href": "https://localhost/widget/TabTest.aspx#"
 };
 var link = $.create("a", attributes);
 $(link).append("xxxx").click(function(){ alert("HELLO"); });
 $("#WidgetContainer").append(link); 
```

您所做的可能在某些浏览器中有效，但在其他浏览器中无效（我曾在 FF 中工作，但在 IE 中失败）。一般来说，如果 jQuery 有一个函数可以做某事，就使用它。

* * *

编辑：为了回应 Adam Backstrom 对这个问题的评论，我想我最好提供一个替代方案。当我过去这样做时，我是这样做的：

```
$("#someplace").wrapInner("<a href='#'></a>");
$("#someplace a").click(function() {
    alert("Hello");
}); 
```

* * *

编辑2：从评论到这篇文章，如何在一行中做到这一点（并不总是最好的主意）：

```
$("<a id='xxx' href='https://localhost/widget/TabTest.aspx#'>xxxx</a>")
      .click(function() { alert("Hello"); })
      .appendTo($("#WidgetContainer")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T18:31:54.340

如果您使用 jQuery 1.3 或更高版本，您可以使用“实时”事件绑定将点击事件附加到您添加到页面的任何 <A> 标记。例如：

```
$('a').live('click', function (evt) {
    alert('Hello');
    evt.preventDefault();
});
var link = $.create('a', {
    'id' : 'xxx',
    'href' : 'http://localhost/'
});
$('#container').append(link); 
```

# c# - 保持 VS2005 与文件系统同步？

> ID：611753
> 
> 赞同：2
> 
> 时间：2009-03-04T18:03:17.840
> 
> 标签：c#, .net, visual-studio, visual-studio-2005

有没有一种简单的方法可以使 VS2005 项目与直接在文件系统上所做的更改保持同步？在 Eclipse 中，我可以简单地“刷新”项目并显示任何更改。VS中是否存在类似的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T18:15:07.360

您可以单击解决方案资源管理器中的显示所有文件按钮，这将显示当前不在您的项目中的文件。从那里，您可以右键单击并将文件包含在您的项目中。

您将不得不偶尔单击刷新以查看新文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T18:04:09.180

VS2005 将自动检测项目中文件的文件系统更改并询问您是否要重新加载源代码。如果您有未保存的更改，它会询问您是否要丢弃旧的更改。

因此，不需要额外的工作来设置 VS2005 与您的文件系统保持同步，以便添加到您的项目中的文件。

对于添加到文件系统但不在您的项目中的文件，您可以例如在现有位置之上创建一个新的 Web 解决方案，它将自动添加您文件夹中的所有文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T18:06:30.390

您必须明确地将文件添加到项目中。如果属于该项目的文件已更新，Visual Studio 将提示重新加载。解决方案资源管理器工具窗口中还有一个刷新按钮，其行为方式类似于 Ronseal。

# java - Java InputStream 阻塞读取

> ID：611760
> 
> 赞同：56
> 
> 时间：2009-03-04T18:06:17.707
> 
> 标签：java, blocking, inputstream, rxtx, java-io

根据java api，`InputStream.read()`描述为：

> 如果由于到达流的末尾而没有可用的字节，则返回值 -1。此方法会一直阻塞，直到输入数据可用、检测到流结束或引发异常。

我有一个`while(true)`循环进行读取，当没有任何内容通过流发送时，我总是得到-1。这是预期的。

我的问题是 read() 什么时候会阻塞？因为如果它没有得到任何数据，它会返回-1。我希望阻塞读取要等到收到数据。如果您已经到达输入流的末尾，那么 read() 不应该只是等待数据而不是返回 -1 吗？

或者 read() 只有在有另一个线程访问流并且您的 read() 无法访问流时才会阻塞？

* * *

这引出了我的下一个问题。我曾经有事件监听器（由我的库提供），它会在数据可用时通知我。当我收到通知时，我会调用`while((aByte = read()) > -1)`存储字节。当我在非常接近的时间内获得两个事件并且并未显示我的所有数据时，我感到很困惑。似乎只显示了第二个事件数据的尾部，其余的都丢失了。

我最终更改了我的代码，以便当我收到一个事件时，我调用`if(inputStream.available() > 0) while((aByte = read()) > -1)`了存储字节。现在它工作正常，我的所有数据都显示出来了。

有人可以解释这种行为吗？据说`InputStream.available()`返回在阻塞下一个调用者（流的？）之前可以读取的字节数。即使我不使用 .available() 我希望读取第一个事件只会阻止读取第二个事件，但不会擦除或消耗太多流数据。为什么这样做会导致无法显示我的所有数据？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-03-04T18:11:54.030

某些实现的底层数据源`InputStream`可以发出已到达流末尾的信号，不再发送数据。在接收到此信号之前，对此类流的读取操作可能会阻塞。

例如，`InputStream`来自`Socket`套接字的一个将阻塞，而不是返回 EOF，直到收到一个设置了 FIN 标志的 TCP 数据包。当从这样的流中接收到 EOF 时，您可以确信在该套接字上发送的所有数据都已被可靠地接收，并且您将无法再读取任何数据。（另一方面，如果阻塞读取导致异常，则可能会丢失一些数据。）

其他流，例如来自原始文件或串行端口的流，可能缺少类似的格式或协议，以表明没有更多数据可用。当当前没有数据可用时，此类流可以立即返回 EOF (-1) 而不是阻塞。但是，在没有这种格式或协议的情况下，您无法确定对方何时完成发送数据。

* * *

关于你的第二个问题，听起来你可能有比赛条件。在没有看到有问题的代码的情况下，我猜测问题实际上在于您的“显示”方法。也许第二个通知显示的尝试以某种方式破坏了第一个通知期间完成的工作。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-04T18:09:58.900

如果它是流的结尾，则返回 -1。如果流仍然打开（即套接字连接）但没有数据到达读取端（服务器很慢，网络很慢，...） read() 阻塞。

你不需要调用available()。我很难理解您的通知设计，但是除了 read() 本身之外，您不需要任何调用。方法 available() 只是为了方便。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-04T18:17:23.750

好的，这有点乱，所以首先让我们澄清一下：`InputStream.read()`阻塞与多线程无关。如果您有多个线程从同一个输入流中读取，并且您触发了两个彼此非常接近的事件 - 每个线程都试图消费一个事件，那么您会得到损坏：第一个读取的线程将获得一些字节（可能所有字节），当第二个线程被调度时，它将读取其余的字节。如果您计划在多个线程中使用单个 IO 流，则始终`synchronized() {}`受到一些外部约束。

其次，如果你可以从你的读取`InputStream`直到你得到-1，然后等待并稍后再读取，那么你正在使用的 InputStream 实现被破坏了！合同`InputStream`明确规定，`InputStream.read()`只有在没有更多数据要读取时才应该返回 -1，因为已经到达整个流的末尾并且不再有数据可用 - 比如当您从文件中读取并到达结尾。

“现在没有更多数据可用，请稍候，你会得到更多”的行为是为了`read()`阻塞而不返回，直到有一些数据可用（或抛出异常）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-04-23T15:16:17.143

默认情况下，提供的 RXTX InputStream 的行为是不兼容的。

您必须将接收阈值设置为 1 并禁用接收超时：

```
serialPort.enableReceiveThreshold(1);
serialPort.disableReceiveTimeout(); 
```

来源：[RXTX 串行连接 - 阻塞 read() 的问题](https://stackoverflow.com/questions/5219450/rxtx-serial-connection-blocking-read-problem/5934997#5934997)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-09-01T02:28:04.253

是的！不要放弃你的直播 Jbu。我们在这里谈论串行通信。对于串行的东西，绝对可以/将在读取时返回-1，但仍然期望稍后有数据。问题是大多数人习惯于处理 TCP/IP，除非 TCP/IP 断开连接，否则它应该总是返回 0……然后是的，-1 是有道理的。但是，使用 Serial 时，长时间没有数据流，也没有“HTTP Keep Alive”或 TCP/IP 心跳，或者（在大多数情况下）没有硬件流控制。但是链接是物理的，并且仍然通过“铜”连接并且仍然完美地活着。

现在，如果他们所说的是正确的，即：串行应该在 -1 上关闭，那么为什么我们必须注意诸如 OnCTS、pmCarroerDetect、onDSR、onRingIndicator 等内容......哎呀，如果 0 意味着它在那里, -1 表示不是，那就搞砸所有这些检测功能！:-)

您可能面临的问题可能在其他地方。

现在，到细节：

**Q：“好像只显示了第二个事件的数据的尾部，其余的都不见了。”**

A：我猜你是在一个循环中，重复使用相同的 byte[] 缓冲区。第一条消息进来，还没有显示在屏幕/日志/标准输出上（因为你在循环中），然后你读取第二条消息，替换缓冲区中的第一条消息数据。再说一次，因为我猜你不会存储你读了多少，然后确保将你的存储缓冲区偏移上一个读取量。

**问：“我最终更改了我的代码，以便当我得到一个事件时，我调用了 if(inputStream.available() > 0) while((aByte = read()) > -1) 来存储字节。”**

A：好极了……这就是好东西。现在，您的数据缓冲区位于 IF 语句中，您的第二条消息不会破坏您的第一条消息……好吧，实际上，它可能只是第一个位置的一条大（er）消息。但现在，您将一口气读完所有内容，并保持数据完整。

**C：“……比赛条件……”**

A: 啊，好家伙'抓住所有的替罪羊！竞态条件... :-) 是的，这可能是竞态条件，事实上它很可能是。但是，它也可能只是 RXTX 清除标志的方式。“数据可用标志”的清除可能不会像人们预期的那样快。例如，任何人都知道 read VS readLine 与清除先前存储数据的缓冲区和重新设置事件标志之间的区别吗？我也没有。:-) 我也找不到答案……但是……让我再啰嗦几句。事件驱动编程仍然存在一些缺陷。让我给你一个我最近不得不处理的真实世界的例子。

*   我得到了一些 TCP/IP 数据，比如说 20 个字节。
*   所以我收到了接收数据的 OnEvent。
*   我什至在 20 个字节上开始我的“读取”。
*   在我读完我的 20 个字节之前……我又得到了 10 个字节。
*   然而，TCP/IP 看起来会通知我，哦，看到标志仍然是 SET，并且不会再次通知我。
*   但是，我读完了我的 20 个字节（available() 说有 20 个）...
*   ...最后 10 个字节保留在 TCP/IP Q... 因为我没有收到通知。

看，通知被错过了，因为标志仍然设置......即使我已经开始读取字节。如果我完成了字节，那么标志就会被清除，并且我会收到接下来 10 个字节的通知。

与你现在正在发生的事情完全相反。

所以是的，使用 IF available() ...读取返回的数据长度。然后，如果您偏执，请设置一个计时器并再次调用 available()，如果那里仍有数据，则不读取新数据。如果 available() 返回 0（或 -1），则放松...坐等...等待下一个 OnEvent 通知。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-05-05T09:08:45.420

**`InputStream`只是一个抽象类**，不幸的是实现决定了会发生什么。

**如果什么也没找到会发生什么：**

*   **套接字**（即`SocketInputStream`）将阻塞直到接收到数据（默认情况下）。但是可以设置一个超时时间（见：）`setSoTimeout`，然后`read`将阻塞 x 毫秒。如果仍然没有收到任何内容，**`SocketTimeoutException`**则将抛出 a。

    但是不管有没有超时，从 a 读取`SocketInputStream` **有时会导致`-1`.** （*例如，当多个客户端同时连接到同一个`host:port`时，即使设备看起来已连接，a 的结果`read`也可能立即导致 a `-1`（从不返回数据）。*）

*   **Serialio**通信将始终返回`-1`；您还可以设置超时（使用`setTimeoutRx`），将首先阻止 x 毫秒，但如果没有找到`read`，结果仍然是。*（备注：但有多个串行 io 类可用，行为可能取决于供应商。）*`-1`

**   **文件**（阅读器或流）将产生一个**`EOFException`**.* 

 ***为通用解决方案工作：**

*   如果将上述任何流包装在 a 中**`DataInputStream`**，则可以使用`readByte`,`readChar`等方法。**所有`-1`值都转换为`EOFException`.** *（PS：如果您执行大量小读取，那么最好将其包装在`BufferedInputStream`第一个中）*
*   `SocketTimeoutException`和`EOFException`extend都有`IOException`，还有其他几种可能`IOException`的。**只检查`IOException`' 来检测通信问题很方便。**

*另一个敏感话题是潮红。`flush`就套接字而言意味着“现在发送”，但就 Serialio 而言，它意味着“丢弃缓冲区”。*

* * *

## 回答 #7

> 赞同：-7
> 
> 时间：2010-11-23T15:56:56.113

我认为如果你使用 thread.sleep() 你可以接收整个数据流

# gwt - 将 JavaScript 覆盖转换回 JSON？

> ID：611768
> 
> 赞同：0
> 
> 时间：2009-03-04T18:07:34.367
> 
> 标签：gwt

我无法将对象从 JSON 转换为 JavaScript 覆盖对象，然后再转换回来。我现在在课堂上有以下内容：

```
public class Aff extends JavaScriptObject {
  protected Aff() {};
  public static native Aff fromJSONString(String jsonString) /*-{
     return eval('(' + jsonString + ')');
  }-*/;
  public final native String toJSON() /*-{
    return this.toString();
  }-*/;
  // followed by get/seters and a bunch of TODO.
} 
```

我能够创建和使用对象，但`obj.toJSON()`返回`[object Object]`. 如果不手动转换回 JSON，我似乎找不到任何解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-05T11:05:30.723

> this.toString();

实际上并不产生 json 代码。它打印对象的字符串表示。您将需要自定义代码来写出 json，或者更好地使用库。

使用库的两种方法 - 使用 gwt 内置的 json 库。不太好，但不需要编写jsni代码。或者，将脚本资源添加到您的模块 xml 中以获取库，例如[此处的一个 javascript json 库](http://www.json.org/)，并在 jsni 中使用它。或者，找到另一个图书馆，那里确实有数百个。

# wix - 在构建和组件问题中生成 WiX XML 文件

> ID：611770
> 
> 赞同：0
> 
> 时间：2009-03-04T18:09:51.927
> 
> 标签：wix, installation, windows-installer

我正在尝试为我创建的网站编写安装程序。在 WiX 教程中，它说“同样，一个组件应该只包含非常强烈地属于在一起的项目，以至于它们总是需要一起安装或删除。”。我相信整个网站都符合这个描述。我有两个关于组件的问题。首先是显然我的网站有很多目录，我不知道如何将所有目录/文件放入一个组件中（这甚至可能吗？），如果我从程序生成我的组件，我的 GUID 几乎肯定必须每个版本都不同，每个版本都会强制更改主要版本？有什么我想念的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T01:21:44.493

组件的文件不能跨越目录。Windows 安装程序的限制。获得稳定的组件 ID 是一个棘手的问题，但是 WiX v3 中有一些新技巧可以为您处理这个问题。Component/@Guid="*" 是诀窍。新的（如上周）heat.exe 将为您生成似乎满足您需求的片段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T18:26:56.737

我必须事先承认，我在 WIX 方面的经验非常有限。但是，我的印象是一个组件映射到一个可安装的东西，比如文件或 dll。这些被安排到组件组中，然后添加到功能中。功能是作为单元安装的东西，例如：核心、文档和示例。在这种情况下，您总是需要核心组件，但可以省略文档和示例功能。

我不认为更改组件的 GUID 会迫使您更改主要版本号。

我自己在使用 WIX 时遇到了困难，因为学习曲线可能非常陡峭。我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-14T01:27:13.557

经历过这些，我的建议是：

1.  每个文件都应该有它自己的组件。
2.  如果您按照步骤 1 进行操作。正如 Rob 所说，每个组件都可以具有属性[GUID="*"](http://n2.nabble.com/Multipe-products-tt2449390.html#a2452738)
3.  ComponentGroup 是你的朋友 :)
4.  如果将 ProductCode 设置为 * 并将 UpgradeCode 保留为固定 GUID，则不必为每次升级编写新的升级安装程序，因为您的 MSI 既是新的安装安装程序，也是升级安装程序。为了帮助控制这一点[，您需要了解](http://blogs.technet.com/alexshev/archive/2008/02/15/from-msi-to-wix-part-8-major-upgrade.aspx)Upgrade 和 UpgradeVersion 元素。

这里还有一些[技巧](https://stackoverflow.com/questions/471424/wix-tricks-and-best-practices)。

# regex - 有效电子邮件地址的正则表达式？

> ID：611775
> 
> 赞同：6
> 
> 时间：2009-03-04T18:11:03.033
> 
> 标签：regex, email

完全重复：[使用正则表达式验证电子邮件地址](https://stackoverflow.com/questions/201323/what-is-the-best-regular-expression-for-validating-email-addresses)

什么是有效的电子邮件地址字符和模式，您将如何编写与其匹配的正则表达式？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-04T18:14:03.243

干得好：

```
(?:(?:\r\n)?[ \t])*(?:(?:(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t]
)+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:
\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(
?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ 
\t]))*"(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\0
31]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\
](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+
(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:
(?:\r\n)?[ \t])*))*|(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z
|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)
?[ \t])*)*\<(?:(?:\r\n)?[ \t])*(?:@(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\
r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[
 \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)
?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t]
)*))*(?:,@(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[
 \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*
)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t]
)+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*)
*:(?:(?:\r\n)?[ \t])*)?(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+
|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r
\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:
\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t
]))*"(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031
]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](
?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?
:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?
:\r\n)?[ \t])*))*\>(?:(?:\r\n)?[ \t])*)|(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?
:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?
[ \t]))*"(?:(?:\r\n)?[ \t])*)*:(?:(?:\r\n)?[ \t])*(?:(?:(?:[^()<>@,;:\\".\[\] 
\000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|
\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>
@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"
(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t]
)*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\
".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?
:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[
\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*|(?:[^()<>@,;:\\".\[\] \000-
\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(
?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*)*\<(?:(?:\r\n)?[ \t])*(?:@(?:[^()<>@,;
:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([
^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\"
.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\
]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*(?:,@(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\
[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\
r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] 
\000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]
|\\.)*\](?:(?:\r\n)?[ \t])*))*)*:(?:(?:\r\n)?[ \t])*)?(?:[^()<>@,;:\\".\[\] \0
00-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\
.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,
;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?
:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t])*
(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".
\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[
^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]
]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*\>(?:(?:\r\n)?[ \t])*)(?:,\s*(
?:(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\
".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*)(?:\.(?:(
?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[
\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t
])*))*@(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t
])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?
:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|
\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*|(?:
[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\
]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*)*\<(?:(?:\r\n)
?[ \t])*(?:@(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["
()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)
?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>
@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*(?:,@(?:(?:\r\n)?[
 \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,
;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t]
)*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\
".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*)*:(?:(?:\r\n)?[ \t])*)?
(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".
\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:
\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[
"()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])
*))*@(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])
+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\
.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z
|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*\>(?:(
?:\r\n)?[ \t])*))*)?;\s*) 
```

不，我不是在开玩笑。[http://www.ex-parrot.com/~pdw/Mail-RFC822-Address.html](http://www.ex-parrot.com/~pdw/Mail-RFC822-Address.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T18:12:54.213

这是一个很好的起点：

[http://www.regular-expressions.info/email.html](http://www.regular-expressions.info/email.html)

附带说明一下，这个网站可能是开始获取正则表达式帮助和教程的最佳地点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-04T18:13:52.073

简短的回答是：这很复杂。

我遇到的用于电子邮件验证的最完整和最准确的正则表达式是[此处](http://www.leshazlewood.com/?p=5)记录的。它不适合胆小的人；它足够复杂，它被分解成多个部分，以便人类更容易解析（示例代码在 Java 中）。但是在值得一直进行验证的情况下，我认为它不会变得更好。

请记住，该[规范](https://www.rfc-editor.org/rfc/rfc2822#section-3.4.1)提到了许多可能不被认为是电子邮件地址典型的情况。您可能想了解它们并决定这些案例对您是否重要。

无论如何，我建议您使用单元测试来确认您的表达涵盖了您认为重要的情况。这样，当您使用它时，您可以确定您没有破坏一些以前有效的案例。

# silverlight-2.0 - 复杂silverlight过程中的进度指示器

> ID：611778
> 
> 赞同：0
> 
> 时间：2009-03-04T18:12:23.700
> 
> 标签：silverlight-2.0

我正在开发一个 Silverlight 应用程序。当应用程序加载时，它会启动一个复杂的布局过程，大约需要 10 秒

1.  通过 Web 服务加载数据集
2.  创建对象
3.  放置对象
4.  下载照片
5.  连接对象

我无法向用户显示所有这一切正在发生的任何进度指示器。除了第 1 步之外，所有步骤似乎都发生在可视线程上。如何拆分线程，以便我可以给用户一些正在发生的事情的指示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-09T06:39:29.903

我不能为你解决整个问题，但也许可以给你一个正确方向的提示。我刚刚从 msdn阅读了这篇[Wicked 代码文章。](http://msdn.microsoft.com/magazine/dd483293(en-us).aspx)

里面有一个关于[“即时渲染”](http://msdn.microsoft.com/magazine/dd483293(en-us).aspx#id0080034)的项目，它有点相似，它也显示照片，但只有当它们可用时。

希望它有点帮助。

# c# - 使字符串 URL 友好（例如：将蒙特利尔转换为蒙特利尔）

> ID：611787
> 
> 赞同：3
> 
> 时间：2009-03-04T18:14:52.040
> 
> 标签：c#, string, internationalization, friendly-url

我正在编写一个需要友好 url 的 Web 应用程序，但我不确定如何处理非 7 位 ASCII 字符。我也不想用 URL 编码的实体替换重音字符。是否有允许这种转换的 C# 方法，或者我是否需要实际映射出我想要处理的每一个案例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T18:18:05.933

我不知道如何在 C# 中做到这一点，但你想要的神奇词汇是“Unicode 分解”。有一种标准方法可以分解像“é”这样的组合字符，然后您应该能够过滤掉非 ASCII 字符。

编辑：[这](http://www.codeproject.com/KB/cs/UnicodeNormalization.aspx?display=Print)可能是您正在寻找的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T18:26:55.520

使用 UTF-8：

> 非 ASCII 字符必须首先根据 UTF-8 [STD63] 进行编码，然后必须对相应 UTF-8 序列的每个八位字节进行百分比编码才能表示为 URI 字符。— [RFC 3986](http://www.ietf.org/rfc/rfc3986.txt)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T18:22:31.320

有类似的内容：[URL 路由：创建友好 URL 时处理空格和非法字符](https://stackoverflow.com/questions/266719/url-routing-handling-spaces-and-illegal-characters-when-creating-friendly-urls)

不过，我不推荐自动转换。在进行此类更改时，某些单词可能会改变含义。你可以把一个好词变成一个不恰当的词。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T18:47:18.250

好的——这里有一些很好的答案。这些方法会奏效。但是，我不得不质疑你的基本前提。我假设您正在讨论的这些值基本上是查询字符串参数，是吗？这是必须过滤掉特殊字符的最常见原因。

两三年来，我使用字符串编码/解码方法通过查询字符串传递这样的东西。总是有间歇性的问题，因为——该死——有很多不同的可能的特殊字符，以及一个浏览器与另一个浏览器中的问题，等等。我们的方法没有这里概述的那么复杂，但仍然如此。2005 年，在对我正在开发的大部分系统进行重写期间，我们决定改为只通过查询字符串传递 id 值。这种方法效果非常好，我想不出它有什么缺点。如果你有一个数据库后端，无论如何，你已经为几乎每个字符串附加了一个 id。如果这是用于搜索等，您可以随时通过表单发送 - 或者您可以使用 AJAX 解决方案

Those methods aren't going to be the best for every situation -- there is no magic bullet here any more than anywhere else -- but this approach has been simple and very functional for me and my team, and so I think it's something for you to at least consider.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T18:20:47.923

好吧，我认为这很简单，这些字符并不多，您可以使用字符串类的 Replace() 方法很容易地替换字符串中的那些字符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T18:24:09.757

此链接可能会有所帮助： http: [//www.codeproject.com/KB/cs/UnicodeNormalization.aspx](http://www.codeproject.com/KB/cs/UnicodeNormalization.aspx)

```
private string LatinToAscii(string InString)
{
string newString = string.Empty, charString;
char ch;
int charsCopied;

for (int i = 0; i < InString.Length; i++)
{
    charString = InString.Substring(i, 1);
    charString = charString.Normalize(NormalizationForm.FormKD);
    // If the character doesn't decompose, leave it as-is

    if (charString.Length == 1)
        newString += charString;
    else
    {
        charsCopied = 0;
        for (int j = 0; j < charString.Length; j++)
        {
            ch = charString[j];
            // If the char is 7-bit ASCII, add

            if (ch < 128)
            {
                newString += ch;
                charsCopied++;
            }
        }
        /* If we've decomposed non-ASCII, give it back
         * in its entirety, since we only mean to decompose
         * Latin chars.
        */
        if (charsCopied == 0)
            newString += InString.Substring(i, 1);
    }
}
return newString;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T18:26:00.267

[http://Montréal.com](http://Montr%C3%A9al.com)

（在浏览器中复制/粘贴，它有效吗？）

# linq-to-sql - Linq to SQL DTO 和复合对象

> ID：611792
> 
> 赞同：4
> 
> 时间：2009-03-04T18:15:48.450
> 
> 标签：linq-to-sql, dto, separation-of-concerns

我使用与其他人类似的方法将我的 LINQ 对象保存在我的 LINQ 数据提供程序中并返回 IQueryable 以允许过滤等。这适用于通过其 ID 或其他属性过滤简单对象，但我遇到了问题连接由其他子对象组成的表对象

```
 //CoreDBDataContext db = coreDB;
public IQueryable<DTO.Position> GetPositions()    {
     return from p in coreDB.Positions
         select new DTO.Position
             {
             DTO.User = new DTO.User(p.User.id,p.User.username, p.User.firstName,p.User.lastName,p.User.email,p.User.isActive),
             DTO.Role = new DTO.Role(p.Role.id, p.Role.name, p.Role.isActive),
             DTO.OrgUnit = new DTO.OrgUnit(p.OrgUnit.id,p.OrgUnit.name,p.OrgUnit.isActive)
             }; 
```

coreDB.Positions 是我的 Linq Position 对象，我返回一个 DTO Position，它由 User、OrgUnit 和 Role 组成（基础表是一个带有 UserID、RoleID 和 OrgUnitID 的连接表）

我遇到的问题是，当我尝试在 Iqueryable 上添加过滤器时，我收到一条 SQL 错误，提示我的 DTO.User 对象没有可用的翻译

```
public static IQueryable<Position> WithUserID(this IQueryable<Position> query, int userID)
    {
        return query.Where(p => p.User.ID == userID);
    } 
```

我完全不知道如何解决这个问题，因为我所有的谷歌结果似乎都是与直接使用生成的 LINQ 对象的人一起工作的

关于如何完成这项工作的任何想法，或者我在这里做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T20:09:11.687

Linq2SQL 只理解设计器生成的对象。嗯，这并不完全正确，但足够接近。

因此，当您针对 Linq2SQL 对象编写 Linq 查询时，查询将在查询实际执行时转换为有效 SQL，而不是在编写时。由于您的 DTO 对象不是 Linq2SQL 对象，因此 Linq2SQL 将不知道如何创建正确的 SQL。

如果你想以这种方式保持你的分离，你必须找到一种方法来执行你的查询，只涉及 Linq2SQL 对象，并且只将结果映射到你的 DTO。

也许您可以将查询方法重写为：

> **更新：**参数必须是 type `Expression<>`，并且没有必要返回一个`IQueryable<>`. 感谢弗雷迪指出。

```
public IEnumerable<DTO.Position> FindPositions(Expression<Func<Position, bool>> criteria)
{
    return from p in coreDB.Positions
           where criteria.Invoke(p)
           select new DTO.Position
                      {
                          User = new DTO.User(p.User.id, p.User.username, p.User.firstName, p.User.lastName,
                                       p.User.email, p.User.isActive),
                          Role = new DTO.Role(p.Role.id, p.Role.name, p.Role.isActive),
                          OrgUnit = new DTO.OrgUnit(p.OrgUnit.id, p.OrgUnit.name, p.OrgUnit.isActive)
                      };
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T20:17:35.897

我已经能够使用类似的方法成功地工作：

```
var courses = from c in Map(origCourses)
where !expiredStatuses.Contains(c.Status)
select c; 
```

地图有：

```
 select new UserCourseListItem
    {
        CourseID = c.CourseID,
        CourseName = cm.CourseName,
        CourseType = c.CourseType.Value
        ... 
```

如何尝试使用这种类型的初始化（而不是构造函数）。

附言。这是一个工作应用程序的一部分，expiredStatuses 甚至与一个复杂的表达式有关。

**更新 1：**这与提到的场景类似，因为：

*   Map 正在返回一个 IQueryable，它是一个 POCO 对象。
*   在调用返回带有 POCO 对象的 IQueryable 的 Map 方法后，我正在对其应用过滤器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T17:39:12.397

I ended up not using filters for my complex queries. Instead, I added methods to the repository for the more complex query requirements. I feel this will make the system easier to understand and hence maintain.

# cmd - 如何使用命令提示符删除文本文件的最后一行？

> ID：611796
> 
> 赞同：3
> 
> 时间：2009-03-04T18:16:35.030
> 
> 标签：cmd

我有一个文本文件，我正在使用命令提示符将其导入访问表。问题是这个文本文件的最后一行有一个空行。任何人都可以为我提供一个脚本，删除文件末尾的空白行，以便我可以完成我的自动化过程。我使用的是 Windows 2000 平台。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T18:28:03.927

```
 sed '$d' 
```

删除最后一行，但不在 Windows 2000 中。获取 gnu utils 以获取 Windows 的 sed。

在[此站点上](http://student.northpark.edu/pemente/sed/sed1line.txt)，您将找到用于操作文件的其他 sed 命令的列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T18:23:49.647

这适用于`head`

```
head -n -1 input.txt > output.txt 
```

不幸的是，我认为默认情况下 Windows 并没有附带那个有用的工具，但是安装[Cygwin](http://www.cygwin.com/)可以为您提供这些以及许多其他的东西。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-04T18:22:48.917

[这](http://www.microsoft.com/technet/scriptcenter/resources/qanda/jan06/hey0103.mspx)是一个从文本文件中删除空行的脚本。它是为 Windows 2000 编写的。

```
Const ForReading = 1
Const ForWriting = 2

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFile = objFSO.OpenTextFile("C:\Scripts\Test.txt", ForReading)

Do Until objFile.AtEndOfStream
    strLine = objFile.Readline
    strLine = Trim(strLine)
    If Len(strLine) > 0 Then
        strNewContents = strNewContents & strLine & vbCrLf
    End If
Loop

objFile.Close

Set objFile = objFSO.OpenTextFile("C:\Scripts\Test.txt", ForWriting)
objFile.Write strNewContents
objFile.Close 
```

# cobol - 如何使用 cobol 删除单个记录？

> ID：611797
> 
> 赞同：1
> 
> 时间：2009-03-04T18:16:46.857
> 
> 标签：cobol

### 样本输出：

产品编号：XXXXXX

产品描述：

产品数量

产品价格

您要删除此记录吗？

只需输入 ID，我就可以访问有关它的信息并询问我是否要删除记录。

谁能帮我？我对 Cobol 有点陌生。我正在使用 1985 cobol 并在 Windows Vista 操作系统中运行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T18:28:09.607

如果你想从 中删除当前记录，你需要这样的东西：

```
DELETE file
     ON INVALID KEY 
          what to do 
     NOT ON INVALID KEY
          what to do
END-DELETE 
```

要删除文件本身，您希望在 JCL 或本地等价物（例如操作系统）中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T21:19:40.863

如果文件是按顺序打开的，则在将该记录读入程序后执行 DELETE 语句。

如果文件是随机或动态打开的，则使用 DELETE 语句将 RELATIVE KEY 或 RECORD KEY 设置为要删除的记录（删除前无需读取记录）。

在这两种情况下，语句的最小编码都是：

删除文件名。

# wpf - 通过directx或其他方法在WPF应用程序中实时1394火线视频

> ID：611802
> 
> 赞同：2
> 
> 时间：2009-03-04T18:18:09.117
> 
> 标签：wpf, video, directx, directshow, firewire

是否有任何人都知道我可以用来将火线视频流式传输到 WPF 应用程序的控件。我不需要相机控制或仅捕获视频。我需要 WPF 托管，因为我将在顶部添加 WPF 内容。

我希望通过在 WPF 中添加直接 X 表面，可能会出现这样的情况。

理想情况下寻找相对较高水平的东西（根本不是直接的表演者）。

谢谢，布赖恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T14:20:13.983

WPF 有几个非常好的视频渲染包。这个家伙[Jeremiah Morrill](http://jmorrill.hjtcentral.com/Home/tabid/428/Default.aspx)有一个[博客](http://jmorrill.hjtcentral.com/Home/tabid/428/Default.aspx)，他在其中讨论了他的众多渲染项目。有 WPF Win32 渲染项目，以及他记录的许多低级技术，用于如何访问加速播放、Media Foundation .NET、DVD 控件等……我相信他的博客的标题是“Jer's One Stop Shop”。

如果您喜欢视频/WPF，一般来说阅读他的博客是个好主意。最后我检查了“MediaKit”，这是他更全面的项目之一，它可以轻松使用 DirectShow（简单的 xaml 和你的关闭和运行，所以不用担心）和其他知名的本地接口。它非常健壮且积极维护，如果不是那个特定项目，请查看他最近贡献的一些 API，以及一些各种 Win7 媒体支持。

我提出另一个项目[增强现实](http://www.mperfect.net/wpfAugReal/)的唯一原因是您提到“在顶部”添加内容。如果您进行大量视频制作，您绝对应该查看 wpfAugRel。我不知道在哪里可以添加它，但我相信您可以在该站点上找到它，但它允许您在 python 中编写一些相当流畅的实时视频制作脚本。

- 编辑 -

对，看看这个[google 代码](http://sites.google.com/site/augmentedrealitytestingsite/)页，它有一些视频（图片值一千字对吗？），但无论如何，它允许你通过使用“标记”道具，基本上是比特，将 3D 内容混入真人电影纸张具有一些易于机器识别的功能，有助于其底层引擎将计算机渲染输出注入到现实世界场景中，高度动态，因此您可以将这些标记物四处乱扔，并且 3D 内容移动流畅……无论如何祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T19:23:03.723

查看UberDemo 的[这篇文章](http://blogs.msdn.com/uberdemo/archive/2008/03/27/capturing-a-webcam-stream-to-a-wmv-file-from-within-a-wpf-application.aspx)。它使用 Windows Media Encoder 和 WPF 将视频捕获到 WMV 文件中。有一段关于如何在 WPF 应用程序中进行预览。

# security - 这个场景安全吗？

> ID：611808
> 
> 赞同：7
> 
> 时间：2009-03-04T18:19:45.133
> 
> 标签：security, encryption, rsa

我正在使用 RSA 加密服务器和客户端之间的通信。假设我们有 2 个非对称密钥，密钥 1 和密钥 2。

服务器从一开始就有key1（私有），客户端有key1（公共）

所以这里是场景：

1.  客户端生成key2
2.  客户端连接到服务器
3.  发送用 key1(public) 加密的 key2(public)
4.  从现在开始，服务器将发送所有使用 key2(public) 加密的数据
5.  客户端向服务器发送一些随机数据
6.  服务器发回相同的散列数据
7.  客户端验证数据是否正确

据我所知，这应该可以防止中间人攻击，还是我错过了什么？在第 7 点，客户端应该知道是否有人试图给服务器提供错误的密钥来加密，因为除了服务器之外没有其他人可以解密 key2(public)。

如果有什么可以提高安全性的方法，请告诉我。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-04T18:23:45.403

提高安全性的最佳方法是使用现有设计，而不是尝试重新发明轮子。我不是说你做的事就一定是错的，只是说很多比你我聪明得多的人都花了很多时间思考这个问题。请改用 TLS。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T18:30:19.320

只要 key1 (private) 没有被第三方以某种方式截获，你的场景看起来是安全的。

我想我实际上在一篇论文的某个地方看到了这一点。在其中，Alice 给了 Bob 一个未上锁的盒子（密钥 1 公开），然后 Bob 将一堆他自己的盒子（密钥 2 公开）放入其中，将其锁定并将其发送回 Alice。Alice 然后打开盒子（密钥 1 私人），现在她可以安全地密封 Bob 刚刚给她的盒子。

尽管有盒子类比，但这本质上就是你正在做的事情，所以我会说它是安全的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T18:32:47.550

不，此协议不安全。

中间人可以拦截客户端发送的数据并将它想要的任何内容发送到服务器，因为您没有为服务器指定任何机制来验证客户端或验证它接收到的消息的完整性。

当然，你可以修改你的协议来解决这些明显的问题，但还有其他问题。如果你把它们都修好了，你就会有一些映射到 TLS 或 SSH 的东西，那么为什么不从那里开始呢？

* * *

@Petoj——我关注的问题是服务器信任它收到的消息；您的提案在那里没有提供任何安全保障。但是，如果您担心机密性，您仍然会遇到问题，因为 MITM 可以原封不动地来回传递消息，直到他看到想要查找的内容，因为您对客户端消息没有任何隐私。

您的提议似乎旨在确保来自客户端的消息的完整性。您已经将协议开发到客户端无法区分攻击和网络故障的程度。与其试图帮助客户端确定服务器是否对被篡改的消息采取了行动，不如让服务器在对消息采取行动之前验证消息的完整性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-04T18:35:24.923

我同意，只需使用 TLS。

另外，第 5 步到第 7 步提供了什么价值？想要在步骤 1-4 之后进行攻击的 MITM（例如，通过传递 n 个事务然后停止，强制从头开始重试的某种 DoS）也可以在步骤 5-7 之后进行。他们添加了什么？

——马库斯

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T18:37:04.903

我同意 Greg 的观点，即**您正在重新发明轮子**。您本质上描述的是一些基本形式的[密钥交换](http://en.wikipedia.org/wiki/Key_exchange)。顺便说一句，为了确保它可以安全地抵御中间人攻击，您还必须确定服务器的身份，即确保客户端可以确定地知道它认为公开的内容（key1）确实是服务器而不是中间人（例如，使用 CA 或将服务器的公共（key1）存储在客户端的安全存储中。）

此外，从系统的角度来看，您还必须注意其他一些注意事项，例如**：**

*   **非对称密钥加密比对称密钥加密慢**，这也是[TLS](http://en.wikipedia.org/wiki/Transport_Layer_Security)等现有解决方案将使用非对称密钥加密仅协商一个临时对称密钥的原因之一，然后将其用于通道加密。
*   如果第三方的流量分析成功破解了临时对称密钥，那么您并没有破坏您的非对称密钥对。出于这个原因，我们鼓励您相对频繁**地重新协商临时密钥。**可以说，在您的场景中生成一个新`key2`的会减轻这方面的影响。

# c# - Windows FILETIME 包含什么？尝试转换为 PHP 日期/时间

> ID：611816
> 
> 赞同：3
> 
> 时间：2009-03-04T18:22:02.803
> 
> 标签：c#, php, datetime

我已经确定我需要将 Windows FILETIME 类型转换为 PHP 可以使用的类型。我希望这是一个 PHP 函数。

假设我有这个值：60 F3 47 D1 57 98 C9 01

第 1 步：（感谢此页面[http://www.cyanwerks.com/file-format-url.html](http://www.cyanwerks.com/file-format-url.html)）我知道我需要将订单更改为 01 C9 98 57 D1 47 F3 60

第2步： ？？？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T18:23:55.373

从[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms724284.aspx)：

> 包含一个 64 位值，表示自 1601 年 1 月 1 日 (UTC) 以来的 100 纳秒间隔数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T18:25:36.210

感谢 Hugh Bothwell 回答这个问题： [帮助我将长值（以十六进制表示）转换回日期/时间](https://stackoverflow.com/questions/610603/help-me-translate-long-value-expressed-in-hex-back-in-to-a-date-time)

```
<?php

    // strip non-hex characters
    function hexstring($str) {
        $hex = array(
                '0'=>'0',       '1'=>'1',       '2'=>'2',       '3'=>'3',       '4'=>'4',
                '5'=>'5',       '6'=>'6',       '7'=>'7',       '8'=>'8',       '9'=>'9',
                'a'=>'a',       'b'=>'b',       'c'=>'c',       'd'=>'d',       'e'=>'e',       'f'=>'f',
                'A'=>'a',       'B'=>'b',       'C'=>'c',       'D'=>'d',       'E'=>'e',       'F'=>'f'
        );

        $t = '';
        $len = strlen($str);
        for ($i=0; $i<$len; ++$i) {
                $ch = $str[$i];
                if (isset($hex[$ch]))
                        $t .= $hex[$ch];
        }

        return $t;
    }

    // swap little-endian to big-endian
    function flip_endian($str) {
        // make sure #digits is even
        if ( strlen($str) & 1 )
                $str = '0' . $str;

        $t = '';
        for ($i = strlen($str)-2; $i >= 0; $i-=2)
                $t .= substr($str, $i, 2);

        return $t;
    }

    // convert hex string to BC-int
    function hex_to_bcint($str) {
        $hex = array(
                '0'=>'0',       '1'=>'1',       '2'=>'2',       '3'=>'3',       '4'=>'4',
                '5'=>'5',       '6'=>'6',       '7'=>'7',       '8'=>'8',       '9'=>'9',
                'a'=>'10',      'b'=>'11',      'c'=>'12',      'd'=>'13',      'e'=>'14',      'f'=>'15',
                'A'=>'10',      'B'=>'11',      'C'=>'12',      'D'=>'13',      'E'=>'14',      'F'=>'15'
        );

        $bci = '0';
        $len = strlen($str);
        for ($i=0; $i<$len; ++$i) {
                $bci = bcmul($bci, '16');

                $ch = $str[$i];
                if (isset($hex[$ch]))
                        $bci = bcadd($bci, $hex[$ch]);
        }

        return $bci;
    }

    // WARNING! range clipping
    //   Windows date time has range from 29000 BC to 29000 AD
    //   Unix time only has range from 1901 AD to 2038 AD
    // WARNING! loss of accuracy
    //   Windows date time has accuracy to 0.0000001s
    //   Unix time only has accuracy to 1.0s
    function win64_to_unix($bci) {
        // Unix epoch as a Windows file date-time value
        $magicnum = '116444735995904000';

        $t = bcsub($bci, $magicnum);    // Cast to Unix epoch
        $t = bcdiv($t, '10000000', 0);  // Convert from ticks to seconds

        return $t;
    }

// get input
$dtval = isset($_GET["dt"]) ? strval($_GET["dt"]) : "0";
$dtval = hexstring($dtval);             // strip non-hex chars

// convert to quadword
$dtval = substr($dtval, 0, 16);         // clip overlength string
$dtval = str_pad($dtval, 16, '0');  // pad underlength string
$quad = flip_endian($dtval);

// convert to int
$win64_datetime = hex_to_bcint($quad);

// convert to Unix timestamp value
$unix_datetime = win64_to_unix($win64_datetime);

?><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Windows datetime test code</title>
</head>

    <form method="get">
        <label>Datetime value: <input name="dt" type="text" value="<?php echo $dtval; ?>"/></label>
        <input type="submit" />
    </form>
    <hr />
    Result:
        Quad: <?php echo $quad; ?><br />
        Int: <?php echo $win64_datetime; ?><br />
        Unix timestamp: <?php echo $unix_datetime; ?><br />
        Date: <?php echo date("D, d F Y H:i:s e", $unix_datetime); ?><br />
<body>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T05:27:12.923

PHP需要什么样的时间？是time_t吗？如果是这样，只需从 unix 纪元（1970-jan-01 UTC）中减去您的 DateTime 并获取 TotalSeconds 值。

# java - 哪个面向 Java 的词法分析器用于简单项目（ANTLR、DIY 等）

> ID：611820
> 
> 赞同：7
> 
> 时间：2009-03-04T18:23:09.417
> 
> 标签：java, parsing, antlr, dsl, ragel

我正在开发一个小型文本编辑器项目，并希望为几种语言（Java、XML ..仅举几例）添加基本的语法突出显示。作为学习经验，我想添加一个流行或不流行的 Java 词法分析器。

你推荐什么项目。Antlr 可能是最知名的，但它看起来相当复杂和沉重。

这是我知道的选项。

1.  蚂蚁
2.  Ragel（是的，它可以生成用于处理输入的 Java 源代码）
3.  自己做（我想我可以编写一个简单的令牌解析器并突出显示源代码）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-04T18:27:56.893

ANTLR 或 JavaCC 将是我所知道的两个。我首先推荐ANTLR。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T03:59:22.790

ANTLR 可能看起来既复杂又笨重，但您不需要使用它包含的所有功能；它的层次感很好。我非常喜欢用它来开发解析器。对于初学者，您可以使用出色的[ANTLRWorks](http://www.antlr.org/works/index.html)来可视化和测试您正在创建的语法。能够看到它捕获令牌、构建解析树并逐步完成整个过程真是太好了。

For your text editor project, I would check out [filter grammars](http://www.antlr.org/wiki/display/ANTLR3/Lexical+filters), which might suit your needs nicely. For filter grammars you don't need to specify the entire lexical structure of your language, only the parts that you care about (i.e. need to highlight, color or index) and you can always add in more until you can handle a whole language.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-09T11:39:47.613

Google code has new project [acacia-lex](http://code.google.com/p/acacia-lex/). Written by myself, it seems simple (so far) java lexer using javax annotations.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T18:32:42.747

紫貂CC

另一个有趣的选项（我还没有尝试过）是 Xtext，它使用 Antlr，但还包括为您的语言创建 Eclipse 编辑器的工具。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T03:04:20.397

ANTLR 是要走的路。我不会手工建造它。如果您浏览 ANTLR 网站，您还会发现[语法](http://www.antlr.org/grammar/list)可用于 Java、XML 等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T03:42:30.757

另一种选择是[Xtext](http://wiki.eclipse.org/Xtext)。它不仅会为您的语法生成解析器，还会生成带有语法着色、错误标记、内容辅助和大纲视图的完整编辑器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T19:10:19.207

[我以前用JFlex](http://jflex.de/)做过，对它很满意。但是我强调的语言很简单，我不需要解析器生成器，所以你的里程可能会有所不同。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-05T03:10:35.387

[JLex](http://www.cs.princeton.edu/~appel/modern/java/JLex/)和[CUP](http://www2.cs.tum.edu/projects/cup/)分别是不错的词法分析器和解析器生成器。我目前正在使用这两种语言为我正在从事的项目开发一种简单的脚本语言。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-03-04T18:29:57.510

我认为您不需要词法分析器。您所需要的只是首先读取文件扩展名以检测语言，然后从列出语言关键字的 xml 文件中轻松找到它们并突出显示它们。

# wiki - Wikia 使用什么软件，我可以将它用于我自己的托管 Wiki 吗？

> ID：611827
> 
> 赞同：0
> 
> 时间：2009-03-04T18:24:19.740
> 
> 标签：wiki, mediawiki, wikipedia

我希望自己托管的 Wiki 完全在我的控制之下，但我想要像[**Wikia**](http://starwars.wikia.com/wiki/Main_Page)这样先进的东西，而不是普通的、缺乏功能的[**Wikipedia**](http://en.wikipedia.org/wiki/Main_Page)风格的 MediaWiki。

Wikia 使用什么软件，我可以将它用于我自己的托管 Wiki 吗？它只是升级/添加了 MediaWiki。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T08:04:28.633

[您可以在他们的开发 wiki](http://dev.wikia.com/wiki/Wikia_Developers_Wiki)找到 Wikia 对 MediaWiki 的自定义和扩展。

他们将大部分调整后的代码保存在一个可公开访问的 SVN 服务器中，并在那里链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T18:26:51.747

AFAIK，Wikia 使用他们多年来一直在扩充的标准 Mediawiki 发行版的修改版本。

他们的商业模式是托管 Wiki（并产生广告收入），同时也通过标准 MediaWiki 中没有的功能来吸引用户。我不认为他们免费提供该软件，我怀疑他们目前正在出售它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T18:52:48.907

Wikia 使用最新版本的 MediaWiki 软件 (MediaWiki 1.13.4)，但带有许多[扩展名](http://traveller.wikia.com/wiki/Special:Version). 您看到的高级功能是他们在顶部添加 css 和 javascript 的“皮肤”（称为 Monaco）的辛勤工作。如果你有礼貌地问，他们会给你一份。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-17T21:13:07.993

他们的源代码位于公共 GitHub 存储库中。

如果您想下载并自行使用它，请转到最新的“release-*”分支。

[https://github.com/Wikia/app](https://github.com/Wikia/app)

# url - 如何在 Emacs Lisp 中“URL 解码”字符串？

> ID：611831
> 
> 赞同：29
> 
> 时间：2009-03-04T18:24:40.380
> 
> 标签：url, emacs, elisp, urlencode, urldecode

我有一个像“foo%20bar”这样的字符串，我想要“foo bar”。

我知道必须有一个内置函数来解码 Emacs Lisp 中的 URL 编码字符串（查询字符串），但是对于我的生活，我今天找不到它，无论是在我的*lisp/*文件夹中还是在 Google 中。

这叫什么？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-05T08:06:04.477

```
url-unhex-string 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2011-06-30T21:03:28.987

就我而言，我需要以交互方式执行此操作。以前的答案给了我正确的调用函数，然后只需将其包装一点以使其具有交互性：

```
(defun func-region (start end func)
  "run a function over the region between START and END in current buffer."
  (save-excursion
    (let ((text (delete-and-extract-region start end)))
      (insert (funcall func text)))))

(defun hex-region (start end)
  "urlencode the region between START and END in current buffer."
  (interactive "r")
  (func-region start end #'url-hexify-string))

(defun unhex-region (start end)
  "de-urlencode the region between START and END in current buffer."
  (interactive "r")
  (func-region start end #'url-unhex-string)) 
```

添加盐，我的意思是根据口味绑定到键。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-28T12:08:46.173

Emacs 附带了一个[URL 库](http://www.emacswiki.org/emacs/UrlPackage)，它提供了一系列 URL 解析功能——正如[huaiyuan](https://stackoverflow.com/questions/611831/how-do-decode-url-in-emacs-lisp/613925#613925)和[Charlie Martin](https://stackoverflow.com/questions/611831/how-do-decode-url-in-emacs-lisp/611912#611912)已经指出的那样。这是一个小示例，可以让您了解如何使用它：

```
(let ((url "http://www.google.hu/search?q=elisp+decode+url&btnG=Google+keres%E9s&meta="))
  ;; Return list of arguments and values
  (url-parse-query-string
   ;; Decode hexas
   (url-unhex-string
    ;; Retrieve argument list
    (url-filename
     ;; Parse URL, return a struct
     (url-generic-parse-url url)))))
=> (("meta" "") ("btnG" "Google+keresés") ("/search?q" "elisp+decode+url")) 
```

我认为依赖它而不是[Org-mode](https://en.wikipedia.org/wiki/Org-mode)更好，因为它*的*主要目的是解析 URL。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-04T20:31:08.077

`org-link-unescape`在非常简单的情况下工作......`w3m-url-decode-string`更好，但它不是内置的，而且我在本地拥有的版本不适用于 Emacs 23。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T18:44:16.243

我认为你让它有点太难了：`split-string`可能会做你想做的大部分事情。对于更高级的东西，请查看`url-expand.el`; 不幸的是，其中许多没有文档字符串，因此您可能必须阅读代码。

`url-generic-parse-url`看起来像一个潜在的赢家。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-24T11:32:01.887

您可以`urlenc`从[MELPA](https://www.emacswiki.org/emacs/MELPA)抓取并`urlenc:decode-region`用于一个区域或`urlenc:decode-insert`以交互方式插入您的文本。

# user-interface - 如何在 wxWidgets 中设置最小窗口大小？

> ID：611841
> 
> 赞同：10
> 
> 时间：2009-03-04T18:27:31.090
> 
> 标签：user-interface, cross-platform, wxwidgets, wxperl

这是我拥有的小部件的层次结构：

Frame > wxBoxSizer > wxPanel > wxBoxSizer > wxFlexGridSizer（2 列，9 行），里面有各种表单域和按钮。

第一个 BoxSizer 是放置面板，第二个是围绕 FlexGrid 做一个边框。

一切看起来都不错，如果窗口放大，框架可以正常展开，但它也可以调整到几乎没有，隐藏所有表单元素。

如何将窗口的最小尺寸强制为默认情况下 FlexGridSizer 建议的尺寸（所有表单元素都可见并具有最小的可能尺寸）？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-02-12T22:02:02.573

可能为时已晚，但这里给出的答案是不必要的复杂，您只需要调用`SetSizerAndFit(sizer)`将 sizer 与框架相关联，设置其初始大小并将此大小设置为最小可接受大小。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-05T18:30:33.367

使用 Frame 上的 SetMinSize() 方法设置最小尺寸将对框架的最小区域设置限制（刚刚测试过）。一旦设置，wxWidgets 将不允许框架的大小小于指定的值。

我会这样设置值。在构造函数中，设置框架的所有元素。最后，在您调用该`Layout()`方法设置所有尺寸器等之后，调用该`GetSize(int *w, int *h)`方法以在默认布局下获取框架的 x 和 y 大小。使用这些值调用该`SetMinSize()`方法以将该默认大小设置为您的 Frame 的最小值。这将考虑到所有不同的填充和边框，以及由框架和包含的元素设置的这些。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T07:29:14.007

在 wxPerl 中，[dagorym](https://stackoverflow.com/users/171/dagorym)的答案可以简洁地写成 `$self->SetMinSize($self->GetSize());`调用`Layout()`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T20:48:13.950

我会尝试使用[wxFlexGridSizer->GetMinSize()](http://docs.wxwidgets.org/stable/wx_wxsizer.html#wxsizergetminsize)返回的任何内容调用[wxFrame->SetMinSize(wxSize)](http://docs.wxwidgets.org/stable/wx_wxwindow.html#wxwindowsetminsize)，应该可以工作，但未经测试。您需要注意 GetMinSize 所说的关于转换为窗口大小的内容，然后才能通过我期望的。

# javascript - YUI 编辑器：摆脱内容中的标签

> ID：611843
> 
> 赞同：0
> 
> 时间：2009-03-04T18:27:40.200
> 
> 标签：javascript, ruby-on-rails, yui, richtextbox, yui-editor

我实现了[YUI 富文本编辑器](http://developer.yahoo.com/yui/editor/)，一旦我从编辑器中保存内容，我想摆脱`<html>`,`<body>`和标签。`DOCTYPE`我知道我可以通过解析 HTML 来做到这一点，但必须有更好的解决方案。

现在，当我在 YUI 编辑器中编辑文本时，它会被保存：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
    <body>
        <p>foo</p>
    </body>
</html> 
```

...但我想保存这个：

```
<p>foo</p> 
```

任何的想法？

PS：我使用[yui_editor 插件为 ruby​​ on rails](http://github.com/larsklevan/yui_editor/tree/master)实现了 YUI 编辑器，但也欢迎 YUI 编辑器通用答案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T10:25:34.037

与此同时，我通过在提交时解析 html 自己解决了这个问题。是的，我知道，起初我并不是在寻找这个解决方案，但最后我得出结论，这是解决它的最简单方法。我使用[Nokogiri RubyGem](http://github.com/tenderlove/nokogiri/tree/master) for Rails 进行解析：

```
value = Nokogiri::HTML(yui_content).css('body').to_html 
value.gsub!(/<body>/,'') 
value.gsub!(/<\/body>/,'') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T18:57:41.687

一种解决方案是，它使用正则表达式来捕获`<body`> 和`</body>`. 示例（从 YUI 编辑器页面修改）：

```
var myEditor = new YAHOO.widget.Editor('msgpost');
myEditor.render();

YAHOO.util.Event.on('somebutton', 'click', function() {
    myEditor.saveHTML();

    //The var html will now have the contents of the textarea
    var html = myEditor.get('element').value, match;

    match = html.match(/<body[^>]*>([\s\S]*?)<\/body>/i);
    html = match ? match[1] : html;
}); 
```

# sql-server - MS SQL Server 2008 - 从 MySQL 迁移时的困惑 re：“从 TABLE 中选择 XYZ”

> ID：611850
> 
> 赞同：1
> 
> 时间：2009-03-04T18:28:17.657
> 
> 标签：sql-server, database, sql-server-2008

所以我在这里很困惑。

我必须将我的数据库从 MySQL 迁移到 MS SQL Server 2008。我已经通过 SQL Maestros 的“MS SQL 数据向导”应用程序传输了数据。它从我的 MySQL 数据库“gk”中获取数据+结构，并将其复制到我的 MS SQL Express 实例上的数据库“gk”中。

但是当我连接到 MS SQL 实例并尝试运行 SQL 查询时，我只会在执行“ `select * from gk.TABLENAME`”或“ `select * from gk.gk.TABLENAME`”时得到结果......如果我在执行“ `select * from TABLENAME`”之后执行“ `use gk`”，我会得到：

> 错误：无效的对象名称'TABLENAME'
> SQLState：S0002
> 错误代码：208

如何使这种行为“正常”？即，我连接到一个特定的数据库，这样我就不必明确告诉它在哪个数据库/模式中找到表？

**更新：** 我应该指定由 SQL 数据向导应用程序创建的结构。查看 SQL Server Management Studio 上的对象浏览器树，有这样的：

```
[HOSTNAME]\SQLEXPRESS (SQL Server ...)
  |-- Databases
       |-- System Databases
       |-- gk
            |...
            |-- Tables   
                  |-- TABLE1
                  |-- TABLE2
                  |-- TABLE3 
```

... 等等。

谢谢。-担

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T18:31:17.227

试试这个，如果你还没有：

```
USE gk
GO

SELECT * FROM tablename 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T19:18:26.210

在您的用户的登录属性对话框中，有一个“用户映射”页面，您可以在其中设置用户的默认架构。将其设置为“gk”（在“gk”数据库中）应该允许您在不完全限定表的情况下编写查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T19:02:55.467

看起来向导创建了一个名为“gk”的数据库，然后将所有表放在名为“gk”的模式中。

如果表存在于命名模式中（即，除了“dbo”的默认模式之外的其他东西），那么您在查询时总是必须指定模式。

注意：在某些情况下，不明确指定架构/所有者会显着降低性能。在旧版本的 SQL 中更重要，但仍然存在。在您的应用程序中可能没有足够大的差异，但仍然值得了解：

*   [没有所有者资格的过程调用对性能的影响](http://sqlblog.com/blogs/linchi_shea/archive/2007/06/30/performance-impact-of-procedure-calls-without-owner-qualification.aspx)
*   [比较 SQL 2000 结果的后续帖子](http://sqlblog.com/blogs/linchi_shea/archive/2007/07/05/performance-impact-of-procedure-calls-without-owner-qualification-sql-server-2000.aspx)

# html - 为什么浮动跨度会下降？

> ID：611851
> 
> 赞同：4
> 
> 时间：2009-03-04T18:28:20.340
> 
> 标签：html, css, firefox

这段代码在 Webkit (chrome) 中可以正常工作，但在 Firefox 中不行，第二个跨度会下降，你知道为什么吗？

```
<div id="sbar">
    <span id="status">Some Text</span>
    <span id="mlog" style="float: right;">Some text in the right</span>
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T18:30:14.437

尝试反转两个跨度。

```
<div id="sbar">
    <span id="mlog" style="float: right;">Some text in the right</span>
    <span id="status">Some Text</span>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T18:40:06.817

是的...反转使它可以使用浮动，您需要像浏览器可以拾取的堆栈一样排列元素 -

所以当向左浮动时

一种

乙

C

将浮动到 ABC -

一种

AB

美国广播公司

当所有浮动正确时会给你CBA，如

一种

文学学士

CBA

我已经在 Firefox 中看到了这个实现，还没有检查过 webkit。不过，您可以放心。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T19:44:13.947

> 此代码在 Webkit (chrome) 中可以正常工作，但在 Firefox 中不能

WebKit 是错误的。该标准规定右浮动必须向下一行。

有关说明，请参阅[CSS：三列布局问题](https://stackoverflow.com/questions/533607/css-three-column-layout-problem/533671)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T19:59:12.197

> 这段代码在 Webkit (chrome) 中可以正常工作，但在 Firefox 中不行，第二个跨度会下降，你知道为什么吗？

是的。浮动元素的行为将低于代码中它之前的非浮动元素。其他人已经给你修复了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-14T21:14:17.287

可以提出其他解决方案而无需逆转。它确实适用于不同的浏览器

```
<div id="sbar" style="position:relative;">
    <span id="status">Some Text</span>
    <span id="mlog" style="position:absolute; top:0;right:0;">Some text in the right</span>
</div> 
```

# javascript - 如何在 Javascript 中匹配 event.keyCode 时避免幻数

> ID：611852
> 
> 赞同：5
> 
> 时间：2009-03-04T18:28:46.343
> 
> 标签：javascript, dom-events, standards, magic-numbers

在 Javascript 中匹配按键时可以避免幻数吗？

一个例子是使用[13 来匹配回车键](https://stackoverflow.com/questions/302122/jquery-event-keypress-which-key-was-pressed)。

我可以指定自己的常量，但我不知道这些值在不同平台/浏览器/语言环境中是否足够稳定。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-05T05:33:40.147

我第一次尝试这样做时，我使用了 String 的 charCodeAt 方法。例如，如果您想检测“a”键的按下：

```
if ("A".charCodeAt(0) == event.keyCode) {
  /* Do stuff here. */
} 
```

请注意，我使用了大写字母“A”而不是“a”。这是因为 event.keyCode 仅报告为大写字母的 Unicode 值（如果它是 alpha 键）。使这个问题有点棘手的是，有几种方法可以获取所按下键的 Unicode 值。在 Firefox 中，您有：

*   event.keyCode
*   event.charCode
*   event.which

根据 Mozilla 开发人员文档，密钥的 Unicode 值将存储在[event.keyCode](https://developer.mozilla.org/en/DOM/event.keyCode)或[event.charCode](https://developer.mozilla.org/en/DOM/event.charCode)中，但不能同时存储。不管哪一个有code，也会存储在[event.which中](https://developer.mozilla.org/en/DOM/event.which). 但是，如果值存储在 charCode 中，它将区分大小写。因此，根据您从哪里获取事件，您可能必须同时检查“a”和“A”。如果您只能从“onkeydown”事件中获取关键事件，并且您的目标是 Firefox，那么您可以指望在 event.keyCode 中设置不区分大小写（大写）的代码。事实上，我在 Windows XP 上的 Firefox 3.0.3、MacOS 10.4 上的 Firefox 3.0.4、MacOS 10.4 上的 Safari 3.2.1 和 MacOS 10.4 上的 OmniWeb 5.8 上进行了测试，并且一切都一样。但是，我没有在任何 IE 版本或 Opera 等上尝试过这个。

如果您想自己从头开始开发它。我建议尽可能多地在您可以访问的不同操作系统上找到尽可能多的不同浏览器，并进行一些试验以了解每个浏览器如何报告关键代码。但是，已经有人完成了这项工作。甚至在您作为示例链接的问题[的答案之一中](https://stackoverflow.com/questions/302122/jquery-event-keypress-which-key-was-pressed/303024#303024)也提到了它！[它是一个名为js-hotkeys](http://code.google.com/p/js-hotkeys/)的 jQuery 插件。它允许您注册回调函数以在按下某个键或组合键时执行。我从项目站点复制的示例用法：

```
$(document).bind('keydown', 'Ctrl+a', fn); 
```

它已经过测试，可以在各种不同的浏览器/平台上工作，所以如果你使用 jQuery，这可能是要走的路。如果您出于某种原因不想使用 jQuery，那么您也不会不走运。显然，这是基于您可以使用的[另一个脚本。](http://www.openjs.com/scripts/events/keyboard_shortcuts/)我个人还没有使用过这些库中的任何一个，所以我不能保证它们的易用性或有效性。也就是说，如果我有你的问题，这就是我想要解决的方向。

# email - 埃里克施密特的电子邮件方面不在 Twitter 中

> ID：611854
> 
> 赞同：0
> 
> 时间：2009-03-04T18:29:52.270
> 
> 标签：email

在[谷歌首席执行官埃里克施密特关于 twitter 的评论](http://www.businessinsider.com/google-ceo-twitter-a-poor-mans-email-system-2009-3)中，他强调了 twitter 缺乏的电子邮件系统的某些方面。

他提到的电子邮件的方面是：

*   贮存
*   撤销
*   身份

谁能解释一下传统电子邮件系统的这些方面？我有兴趣创建一个类似推特的系统，并希望更好地了解现有的通信协议及其能力/特征。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T01:33:25.263

从6小时后开始。没有人回答这个我会试一试。

*   贮存

好吧，您不能像存储电子邮件一样存储推文，对吗？

*   撤销

嗯，也许是因为在一封电子邮件中，您可以收回一些评论或就某些主题来回讨论，将主题保留在一个地方。

*   身份

    该电子邮件将您标识为域 (user@domain) 中的用户，因此创建了一个在线身份。Twitter 没有（至少目前还没有）

Twitter 没有包含这些功能，因为它的性质很好，不是电子邮件的替代品。

网络论坛（像这样）也是从电子邮件系统演变而来的，其中所有的问题/答案都使用电子邮件作为交流渠道。

# c# - Silverlight 中的交换控件

> ID：611862
> 
> 赞同：0
> 
> 时间：2009-03-04T18:32:25.913
> 
> 标签：c#, silverlight

我有一个 6 行 6 列的 Grid 控件。

在第一行，我有一个可以有两种状态的下拉菜单。（新的或二手的）

当我处于新状态时，我有两个控件。第 3 行第 1 列中的黄色对照和第 5 行第 1 列中的红色对照

当我处于已使用状态时，我想交换控件的位置，以便红色控件占据第 3 行第 1 列，黄色控件占据第 5 行第 1 列。

这在 Silverlight 中可行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T18:53:12.337

What you really want is the WPF triggers. Unfortunately, triggers are not supported in Silverlight, so that's not an option for you.

You could try the [`VisualStateManager`](http://msdn.microsoft.com/en-us/library/system.windows.visualstatemanager(VS.95).aspx) class. Granted, its main purpose it to maintain transitions between visual states of the control, and thus it uses story boards and does anymation of the properties; hence, it might not work with the Grid.Column property.

Tim Heuer has a short [introduction of VSM](http://timheuer.com/blog/archive/2008/06/04/silverlight-introduces-visual-state-manager-vsm.aspx). Here's an opinion on the [shortcomings of VSM](http://hestia.typepad.com/flatlander/2008/06/why-the-silverl.html).

You can also build you [custom state manager on top of the VSM](http://silverlight.net/blogs/justinangel/archive/2008/12/25/custom-vsm-visualstatemanagers-in-silverlight-2-0.aspx), which can give you state management without animated transitions and also potential support for properties not supported by the VSM class.

Or you could just have your own method that you call when the state is changed (you should know when that happens) and explicitly change the Grid.Column property on the two controls. The main drawback is that your code now has explicit knowledge about the visual representation and the layout and how it is tied to the state.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T19:20:54.470

实际上，Grid 类包含如下方法：

Grid.SetRow(controlName, row_position); Grid.SetColumn(controlName, col_position); Grid.SetColumnSpan(controName, integer);

我可以用来交换我的控件。

这可以正常工作，因为我的控件中只有一个 Grid，但是，如果我的控件有多个网格，我认为这不会起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T14:38:51.093

向需要动态内容的单元格添加网格。添加一种方法来处理下拉选定项目更改事件。当它发生变化时，动态清除然后在各自的单元格中设置网格的内容，如下所示：

```
myContainerGrid.Children.Clear();
myContainerGrid.Children.Add(myNewControl); 
```

如果内容更复杂，您可以将每个内容包装到单独的用户控件中，然后将其动态加载到容器网格中。

——马特

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T19:07:37.157

为此，您可以使用**SetValue**方法。

您可以在下拉列表的事件处理程序上执行此操作，如下所示：

```
 _rowPanel1 = 2;
            _rowPanel2 = 1;
            panel1.SetValue(Grid.RowProperty, _rowPanel1);
            panel2.SetValue(Grid.RowProperty, _rowPanel2); 
```

 `更进一步，您可以将面板上的 Grid.RowProperty（和/或列）绑定到实现 INotifyPropertyChanged 的​​类的 clr 属性。

# iphone - 如何重置（即取消缩放）UIScrollView？

> ID：611865
> 
> 赞同：1
> 
> 时间：2009-03-04T18:32:57.597
> 
> 标签：iphone, cocoa-touch, uiscrollview

我有一个 UIScrollView，其中包含一个图像和一个分段控件，允许用户在 ScrollView 内切换图像。如果我只是在 UIImageView 内交换图像，它将以放大状态显示新图像。如何将 UIScrollView 重置为未放大状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T22:12:40.093

我在[github.com/andreyvit/ScrollingMadness/](http://github.com/andreyvit/ScrollingMadness/)详细讨论了 UIScrollView 缩放的工作原理（以及原因） 。

（该链接还包含对如何以编程方式缩放 UIScrollView、如何模拟照片库样式的分页+缩放+滚动、示例项目和封装了一些缩放魔术的 ZoomScrollView 类的描述。）

引用：

UIScrollView 没有“当前缩放级别”的概念，因为它包含的每个子视图都可能有自己的当前缩放级别。请注意，UIScrollView 中没有字段来保持当前缩放级别。但是我们知道有人存储了该缩放级别，因为如果您捏缩放子视图，然后将其变换重置为 CGAffineTransformIdentity，然后再次捏，您会注意到子视图之前的缩放级别已恢复。

事实上，如果你看一下反汇编，它是 UIView 存储自己的缩放级别（在 _gestureInfo 字段指向的 UIGestureInfo 对象内）。它还有一组很好的未记录方法，例如`zoomScale`和`setZoomScale:animated:`。（请注意，它还有一堆与旋转相关的方法，也许我们很快就会获得旋转手势支持。）

但是，如果我们创建一个仅用于缩放的新 UIView 并将我们真正的可缩放视图添加为它的子视图，我们将始终从缩放级别 1.0 开始。我的程序化缩放实现就是基于这个技巧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T19:43:09.927

如果您没有在捏缩放事件完成时重新绘制视图，则缩放因子由您从 viewForZoomingInScrollView: 委托方法返回的视图的变换属性设置。要重置此缩放，请将视图的变换属性的值设置为 CGAffineTransformIdentity。

但请注意，您的下一次捏合缩放操作将从上一次捏合缩放停止的位置开始（也就是说，您的新比例将被忽略）。要解决此问题，您可能需要实现我[在此处](https://stackoverflow.com/questions/448285/how-do-i-reset-after-a-uiscrollview-zoom/451629#451629)描述的一些内容。

# reporting-services - 本地化 SQL Server Reporting Services 报表 (.rdl) 的简单方法是什么？

> ID：611866
> 
> 赞同：8
> 
> 时间：2009-03-04T18:33:00.967
> 
> 标签：reporting-services, localization

我正在尝试提供我目前在 SQL Server Reporting Services 中构建的报告的西班牙语和英语版本。是否有一种简单的方法来本地化报告（类似于在 .NET Web 应用程序中使用资源文件作为标签）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T23:36:27.633

这只是.Net代码，因此您可以通过自定义程序集中的一些帮助方法访问标准资源文件，但这很难测试等

这方面的一个例子是这里[http://forums.asp.net/p/952617/1171729.aspx](http://forums.asp.net/p/952617/1171729.aspx)

有时更简单的解决方案是在数据库中有一个语言表，并让所有标签通过标签名称和 User!Langauge 参数对其使用过滤器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-24T05:29:27.947

嗨，如果对您有帮助，您可以查看下面的帖子。

[http://bharatsavaliya.blogspot.com/2009/06/custom-functionscode-in-sql-reporting.html](http://bharatsavaliya.blogspot.com/2009/06/custom-functionscode-in-sql-reporting.html)

问候，乙

# xslt - 使用 XSL 显示“£”和“€”符号

> ID：611868
> 
> 赞同：1
> 
> 时间：2009-03-04T18:33:57.547
> 
> 标签：xslt

我正在读取数据源，然后对输出的文本应用 xsl 转换，所有 £ 和 € 符号都被剥离。

我错过了一些明显的东西吗？我尝试将编码更改为 iso-8859-1 无济于事。

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" >
    <xsl:output encoding="utf-8"/>
    <xsl:output method="html" omit-xml-declaration="yes"/>
    <xsl:param name="Subject"/>
    <xsl:param name="DateString"/>
    <xsl:param name="CurrentSiteUrl"/>

    <xsl:template match="/">
        <html>
            <xsl:apply-templates/>
    </html>
    </xsl:template>
    <xsl:template match="posts>
        <xsl:variable name="postcount" select="count(content)"/>
        <html>
            <head>
            <meta http-equiv="Content-Type" content="text/html;utf-8" />
            </head> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T18:35:40.213

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T14:57:39.480

直接使用 £ 和 € 字符。这就是 UTF-8 的用途。

只需确保您发送的 XML 文件具有正确的 MIME 类型。[在声明](http://diveintomark.org/archives/2004/02/13/xml-media-types)中经常使用[`text/xml`覆盖编码`<?xml ?>`](http://diveintomark.org/archives/2004/02/13/xml-media-types)！
将服务器配置为始终使用`application/xml`，如果它还没有这样做。

您在 HTML 编码声明中有错误。`<meta>`应包含：.
`text/html;`**`charset=`**`UTF-8`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T17:18:51.753

> 我错过了一些明显的东西吗？我尝试将编码更改为 iso-8859-1 无济于事。

这不起作用，因为“€”不在 iso-8859-1 中

```
<xsl:output encoding="utf-8"/>
<xsl:output method="html" omit-xml-declaration="yes"/> 
```

只是一种预感，但你能做到吗

```
<xsl:output method="html" omit-xml-declaration="yes" encoding="utf-8"/> 
```

我不知道 xsl:output 的属性是否被连接或覆盖。

您可能会发现实体无论如何都是经过编码的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T18:37:04.357

try using &eur; and &#163; to output those symbols.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-14T15:56:56.887

我遇到了同样的问题（使用欧元符号）。该问题是硬编码在 FONET.DLL 中的。在类`TrueTypeFont`方法`MapCharacter`中写为：

```
public override ushort MapCharacter(char c) 
{
    if (c > Byte.MaxValue) 
        return (ushort) FirstChar;
    return mapping.MapCharacter(c);
} 
```

因此，任何值大于 255 的字符都将被“忽略”。我下载了源代码（来自[https://fonet.codeplex.com/](https://fonet.codeplex.com/)）并将方法修改为：

```
public override ushort MapCharacter(char c) 
{
    return mapping.MapCharacter(c);
} 
```

使用这个库和这个新方法，欧元符号神奇地变得可见！

# actionscript-3 - 类似 Ruby 的问题：使这个函数更短（ActionScript 3）

> ID：611873
> 
> 赞同：4
> 
> 时间：2009-03-04T18:36:21.333
> 
> 标签：actionscript-3, actionscript, verbosity

我刚刚写了这个非常冗长的代码来把像 2 这样的数字变成 02。**你能把这个函数做得更短吗，拜托（维护功能）？**

```
 public static function format(n:int, minimumLength:int):String {
        var retVal:String = n.toString();
        var stillNeed:int = minimumLength - retVal.length;
        for (var i:int = 0; i < stillNeed; i++) {
            retVal = "0" + retVal;
        }
        return retVal;
    } 
```

请使用变量类型。如果已经有我不知道的内置功能，则加分（良好的氛围点，而不是 SO 点）。

如果有人想用其他语言发布一些非常短的等价物，那也会很有趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T18:55:42.973

我认为没有内置的方法，但这可能更干净（如果不一定性能更好）：

```
//20 zeroes, could be more if needed
public static var Zeroes:String = "00000000000000000000"   

public static function format(n:Number, minimumLength:int):String {
var retVal:String = (n.toFixed(0)); // cut off the decimals
var stillNeed:int = minimumLength - retVal.length;
retVal = Zeroes.substring(0, stillNeed) + retVal; 
return retVal;
} 
```

“zeroes” var 消除了循环的需要，只需从预构建的字符串中添加所需的任意多个零即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T18:58:28.800

[Christophe Herreman](https://stackoverflow.com/users/17255/christophe-herreman)几乎做对了，但他的方法增加了更多的零，而不是微分量。我修复了一点：

```
public static function format(n:int, minimumLength:int):String {
  var v:String = n.toString();
  var stillNeed:int = minimumLength - v.length;       
  return (stillNeed > 0) ? v : String(Math.pow(10, stillNeed) + v).substr(1);
} 
```

我之前的尝试：

```
 public static function format(n:int, minimumLength:int):String {
    var stillNeed:int = minimumLength - n.toString().length;               
    return (n.split("").reverse().join("") as int) // 32 -> 23
             *Math.pow(10, stillNeed > 0 ? stillNeed : 0).toString() // 23000
                 .split("").reverse().join("");  // 00032
 }

 public static function formatAny(n:Number, minimumLength:int):String {
    return format((int)n) + n.toString().split('.')[ 1 ];
 }

 // use this if you want to handle -ve numbers as well
 public static function formatAny(n:Number, minimumLength:int):String {
    return (n < 0 ? '-' : '') + formatAny(n, minimumLength);
 } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-05T08:53:52.850

这不会是最快的实现（它做了一些不必要的复制并有一个循环），但它**很好**并且可读：

```
public static function pad(num:int, minLength:uint):String {
    var str:String = num.toString();
    while (str.length < minLength) str = "0" + str;
    return str;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-04T19:04:18.147

这个怎么样：

```
public static function format(n:int, len:int):String {
  var v:String = n.toString();
  return (v.length >= len) ? v : String(Math.pow(10, len) + n).substr(1);
} 
```

顺便说一句，没有内置功能可以做到这一点。如果您需要像样的填充功能，请查看 Apache Commons Lang 中的[StringUtils](https://github.com/apache/commons-lang/blob/master/src/main/java/org/apache/commons/lang3/StringUtils.java)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-29T21:09:51.643

向 dirkgently 和所有其他在这里做出回应的人表示支持，但显然人们在没有实际尝试代码的情况下投票。

dirkgently 的最终功能大部分是正确的，但他的 '>' 需要是一个 '<'。

此功能按预期执行（经过相当彻底的测试）：

```
public static function format(n:int, minimumLength:int):String {
  var v:String = n.toString();
  var stillNeed:int = minimumLength - v.length;
  return (stillNeed < 0) ? v : String(Math.pow(10, stillNeed) + v).substr(1);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T21:36:47.453

> “如果有人想用其他语言发布一些非常短的等价物，那也很有趣。”

在 javascript 中很容易 - 将其粘贴到浏览器的地址栏中

javascript: 函数 zit(n, w) {var z="000000000000000000"; 返回 (z+n).substr(-w);} alert(zit(567, 9)); 无效（0）；

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-05T13:36:20.407

我总是通过获取一个包含所有零的零的最大填充宽度的字符串来完成此操作，然后将字符串附加到零字符串的末尾，然后使用子字符串来获取右手长度数字。

就像是：

```
function pad(num:int, length:unit):String{
    var big_padded:String "0000000000000000000000000000" + num.toString();
    return big_padded.substring(big_padded.length - length);
 } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-07T00:21:44.013

adobe 推出的 as3corelib 包有一个不错的 NumberFormatter 小类，它使用了一系列 STATIC 类。在这种情况下，您可以使用 addLeadingZero 函数。

```
//The following method is from the NumberFormatter class of the as3corelib package by Adobe.
public static function addLeadingZero(n:Number):String
{
var out:String = String(n);

if(n < 10 && n > -1)
{
    out = "0" + out;
}

return out;
} 
```

我包含这个函数只是为了展示它的简单性，但我会使用包而不是函数，因为它提供了许多其他有用的功能，如 StringUtils、MD5 等加密方法、blowfish 等。

[您可以在此处](http://code.google.com/p/as3corelib/)下载包 对于新用户，您必须提供该包所在的类路径。导入类而不是使用它们的完全限定的类名也很聪明。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-07-02T19:54:23.200

```
private function leadingZeros(value:int, numDigits:int):String
{
            return String(new Array(numDigits + 1).join("0") + String(value)).substr(-numDigits, numDigits);
} 
```

# algorithm - 合理优化图表缩放

> ID：611878
> 
> 赞同：33
> 
> 时间：2009-03-04T18:37:21.690
> 
> 标签：algorithm, math, charts

我需要制作一个具有优化*y*轴最大值的图表。

我目前制作图表的方法只是使用所有图表的最大值，然后将其除以 10，并将其用作网格线。我没写。

**更新说明：**这些图表已更改。一旦我修复了代码，我的动态图就开始工作了，这让这个问题变得荒谬（因为示例中不再有任何错误）。我已经用静态图像更新了这些，但有些答案引用了不同的值。记住这一点。 [![旧图表](https://i.stack.imgur.com/W5fPK.png)](https://i.stack.imgur.com/W5fPK.png) 到目前为止，2 月份有 12003 到 14003 个呼入电话。信息丰富，但丑陋。

我想避免看起来像猴子的图表想出了*y*轴数字。

使用 Google 图表 API 会有所帮助，但仍然不是我想要的。 ![谷歌 API 图表](https://i.stack.imgur.com/RLX3h.png) 数字很​​干净，但 y 值的顶部始终与图表上的最大值相同。该图表的范围从 0 到 1357。我需要计算出 1400 的正确值，但**有问题**。

* * *

我在这里加入了[rbobby](https://stackoverflow.com/questions/611878/reasonable-optimized-chart-scaling/611979#611979)对“好”数字的定义，因为它很好地解释了它。

*   “不错”的数字是具有 3 个或更少非零数字的数字（例如 1230000）
*   一个“好”的数字与零数字具有相同或少数几个非零数字（例如，1230 不好，1200 好）
*   最好的数字是 3 个零的倍数（例如“1,000”、“1,000,000”）
*   第二好的数字是 3 个零加上 2 个零的复数（例如“1,500,000”、“1,200”）

## 解决方案

[![新图表](https://i.stack.imgur.com/ubIkH.png)](https://i.stack.imgur.com/ubIkH.png)

我找到了使用 Mark Ransom 想法的修改版本来获得我想要的结果的方法。

首先，Mark Ransom 的代码在给定刻度数时确定刻度之间的最佳间距。有时，这个数字最终会是图表上最高值的两倍多，具体取决于您想要多少条网格线。

我正在做的是用 5、6、7、8、9 和 10 条网格线（刻度线）运行 Mark 的代码，以找出其中最低的。值为 23 时，图表高度变为 25，网格线位于 5、10、15、20 和 25 处。值为 26 时，图表高度为 30，网格线位于 5、10 , 15, 20, 25, 和 30。网格线之间的间距相同，但数量更多。

因此，这里是复制 Excel 所做的一切以制作精美图表的步骤。

1.  暂时将图表的最高值提高 5% 左右（这样图表的最高点和图表区域的顶部之间总是有一些空间。我们希望 99.9 向上舍入到 120）
2.  找到 5、6、7、8、9 和 10 条网格线的最佳网格线位置。
3.  从这些数字中选出最低的。记住获得该值所需的网格线数。
4.  现在您有了最佳图表高度。线/条永远不会与图表顶部对接，并且您拥有最佳的刻度数。

PHP：

```
function roundUp($maxValue){
    $optiMax = $maxValue * 2;
    for ($i = 5; $i <= 10; $i++){
        $tmpMaxValue = bestTick($maxValue,$i);
        if (($optiMax > $tmpMaxValue) and ($tmpMaxValue > ($maxValue + $maxValue * 0.05))){
            $optiMax = $tmpMaxValue;
            $optiTicks = $i;
        }
    }
    return $optiMax;
}
function bestTick($maxValue, $mostTicks){
    $minimum = $maxValue / $mostTicks;
    $magnitude = pow(10,floor(log($minimum) / log(10)));
    $residual = $minimum / $magnitude;
    if ($residual > 5){
        $tick = 10 * $magnitude;
    } elseif ($residual > 2) {
        $tick = 5 * $magnitude;
    } elseif ($residual > 1){
        $tick = 2 * $magnitude;
    } else {
        $tick = $magnitude;
    }
    return ($tick * $mostTicks);
} 
```

Python：

```
import math

def BestTick(largest, mostticks):
    minimum = largest / mostticks
    magnitude = 10 ** math.floor(math.log(minimum) / math.log(10))
    residual = minimum / magnitude
    if residual > 5:
        tick = 10 * magnitude
    elif residual > 2:
        tick = 5 * magnitude
    elif residual > 1:
        tick = 2 * magnitude
    else:
        tick = magnitude
    return tick

value = int(input(""))
optMax = value * 2
for i in range(5,11):
    maxValue = BestTick(value,i) * i
    print maxValue
    if (optMax > maxValue) and (maxValue > value  + (value*.05)):
        optMax = maxValue
        optTicks = i
print "\nTest Value: " + str(value + (value * .05)) + "\n\nChart Height: " + str(optMax) + " Ticks: " + str(optTicks) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T19:19:58.920

这是来自以前的类似问题：

[图表上“漂亮”网格线间隔的算法](https://stackoverflow.com/questions/361681/algorithm-for-nice-grid-line-intervals-on-a-graph)

> 我已经用一种蛮力方法做到了这一点。首先，找出你可以放入空间的最大刻度线数。将值的总范围除以刻度数；这是刻度线的*最小* 间距。现在计算以 10 为底的对数下限以获得刻度的大小，然后除以该值。您最终应该得到 1 到 10 范围内的值。只需选择大于或等于该值的整数并将其乘以之前计算的对数即可。这是您的最终刻度间距。
> 
> Python 中的示例：

```
import math

def BestTick(largest, mostticks):
    minimum = largest / mostticks
    magnitude = 10 ** math.floor(math.log(minimum) / math.log(10))
    residual = minimum / magnitude
    if residual > 5:
        tick = 10 * magnitude
    elif residual > 2:
        tick = 5 * magnitude
    elif residual > 1:
        tick = 2 * magnitude
    else:
        tick = magnitude
    return tick 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T19:13:57.530

您最多可以四舍五入两位有效数字。以下伪代码应该可以工作：

```
// maxValue is the largest value in your chart
magnitude = floor(log10(maxValue))
base = 10^(magnitude - 1)
chartHeight = ceiling(maxValue / base) * base 
```

例如，如果`maxValue`是 1357，则幅度为 3，基数为 100。除以 100、向上舍入和乘以 100 的结果是向上舍入到 100 的下一个倍数，即四舍五入到两位有效数字。在这种情况下，结果为 1400 (1357 ⇒ 13.57 ⇒ 14 ⇒ 1400)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-04T19:05:17.287

在过去，我以一种蛮力的方式做到了这一点。这是一段运行良好的 C++ 代码......但对于硬编码的下限和上限（0 和 5000）：

```
int PickYUnits()
{
    int MinSize[8] = {20, 20, 20, 20, 20, 20, 20, 20};
    int ItemsPerUnit[8] = {5, 10, 20, 25, 50, 100, 250, 500};
    int ItemLimits[8] = {20, 50, 100, 250, 500, 1000, 2500, 5000};
    int MaxNumUnits = 8;
    double PixelsPerY;
    int PixelsPerAxis;
    int Units;

    //
    // Figure out the max from the dataset
    //  - Min is always 0 for a bar chart
    //
    m_MinY = 0;
    m_MaxY = -9999999;
    m_TotalY = 0;
    for (int j = 0; j < m_DataPoints.GetSize(); j++) {
        if (m_DataPoints[j].m_y > m_MaxY) {
            m_MaxY = m_DataPoints[j].m_y;
        }

        m_TotalY += m_DataPoints[j].m_y;
    }

    //
    // Give some space at the top
    //
    m_MaxY = m_MaxY + 1;

    //
    // Figure out the size of the range
    //
    double yRange = (m_MaxY - m_MinY);

    //
    // Pick the initial size
    //
    Units = MaxNumUnits;
    for (int k = 0; k < MaxNumUnits; k++)
    {
        if (yRange < ItemLimits[k])
        {
            Units = k;
            break;
        }
    }

    //
    // Adjust it upwards based on the space available
    //
    PixelsPerY = m_rcGraph.Height() / yRange;
    PixelsPerAxis = (int)(PixelsPerY * ItemsPerUnit[Units]);

    while (PixelsPerAxis < MinSize[Units]){
        Units += 1;
        PixelsPerAxis = (int)(PixelsPerY * ItemsPerUnit[Units]);
        if (Units == 5)
            break;
    }

    return ItemsPerUnit[Units];
} 
```

但是，您所说的某些内容使我感到不安。要选择好的轴数，“好数”的定义会有所帮助：

*   “不错”的数字是具有 3 个或更少非零数字的数字（例如 1230000）
*   一个“好”的数字与零数字具有相同或少数几个非零数字（例如，1230 不好，1200 好）
*   最好的数字是 3 个零的倍数（例如“1,000”、“1,000,000”）
*   第二好的数字是 3 个零加上 2 个零的复数（例如“1,500,000”、“1,200”）

不确定上述定义是否“正确”或实际上有帮助（但有了定义，设计算法就变得更简单了）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-06-04T09:51:42.633

稍作改进和测试......（适用于单位的分数，而不仅仅是整数）

```
public void testNumbers() {
        double test = 0.20000;

        double multiple = 1;
        int scale = 0;
        String[] prefix = new String[]{"", "m", "u", "n"};
        while (Math.log10(test) < 0) {
            multiple = multiple * 1000;
            test = test * 1000;
            scale++;
        }

        double tick;
        double minimum = test / 10;
        double magnitude = 100000000;
        while (minimum <= magnitude){
            magnitude = magnitude / 10;
        }

        double residual = test / (magnitude * 10);
        if (residual > 5) {
            tick = 10 * magnitude;
        } else if (residual > 2) {
            tick = 5 * magnitude;
        } else if (residual > 1) {
            tick = 2 * magnitude;
        } else {
            tick = magnitude;
        }

        double curAmt = 0;

        int ticks = (int) Math.ceil(test / tick);

        for (int ix = 0; ix < ticks; ix++) {
            curAmt += tick;
            BigDecimal bigDecimal = new BigDecimal(curAmt);
            bigDecimal.setScale(2, BigDecimal.ROUND_HALF_UP);
            System.out.println(bigDecimal.stripTrailingZeros().toPlainString() + prefix[scale] + "s");
        }

        System.out.println("Value = " + test + prefix[scale] + "s");
        System.out.println("Tick = " + tick + prefix[scale] + "s");
        System.out.println("Ticks = " + ticks);
        System.out.println("Scale = " +  multiple + " : " + scale);

    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T18:44:12.157

如果你想要 1400 在顶部，那么如何将最后两个参数调整为 1400 而不是 1357：

![替代文字](https://chart.apis.google.com/chart?cht=lc&chs=650x220&chg=0,20&chxt=x,y&chxl=0:|Jan|Feb|Mar|Apr|May|June|July|Aug|Sep|Oct|Nov|Dec&chdl=Total%20Inbound|Total%20Outbound|New%20Callers|Unanswered%20Calls&chco=6633CC,FFCC00,66CC33,FF0000&chd=t:51,1357,376,0,0,0,0,0,0,0,0|41,372,6,0,0,0,0,0,0,0,01|64,311,43,0,0,0,0,0,0,0,0|0,11,0,0,0,0,0,0,0,0,0&chds=1,1400&chxr=1,0,1400)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T18:58:05.027

你可以使用 div 和 mod。例如。

假设您希望图表以 20 为增量四舍五入（只是为了使其比典型的“10”值更随意）。

所以我会假设 1、11、18 将四舍五入为 20。但 21、33、38 将四舍五入为 40。

要得出正确的值，请执行以下操作：

```
Where divisor = your rounding increment.

divisor = 20
multiple = maxValue / divisor;  // Do an integer divide here. 
if (maxValue modulus divisor > 0)
   multiple++;

graphMax = multiple * maxValue; 
```

所以现在让我们插入实数：

> ```
> divisor = 20;
> multiple = 33 / 20; (integer divide)
> so multiple = 1
> if (33 modulus 20 > 0)  (it is.. it equals 13) 
>    multiple++;
> 
> so multiple = 2;
> graphMax = multiple (2) * maxValue (20);
> graphMax = 40; 
> ```

# svn - 如何回滚全部或部分对 svn 的提交？

> ID：611879
> 
> 赞同：12
> 
> 时间：2009-03-04T18:37:35.887
> 
> 标签：svn, tortoisesvn, rollback

如何使用 TortoiseSVN 恢复全部或部分 SVN 提交？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-04T18:51:38.363

首先，您需要确定您想要还原修订版的“所有更改”，还是仅还原单个文件。TortoiseSVN 只有“1 或全部”的方法；意思是，您可以恢复整个签入集或单个文件：而不是部分签入。

## 整个变更集

因此，如果恢复一个特定的版本（并且您希望更改该变更集中的所有文件），您将需要右键单击 -> TortoiseSVN -> 显示日志。找到要回滚到的修订/变更集，右键单击该修订“恢复到此修订”。

还有一个您可能感兴趣的选项，即“Revert changes from this revision”，它将在该版本和您当前版本之间进行差异合并，并仅合并差异。我发现这有时更有吸引力；所以，我可以保留变更集之间的所有更改。

## 单个文件

另一种选择是恢复单个文件。您将再次右键单击 -> TortoiseSVN -> 显示日志；但这一次，您可以选择单个文件。

TortoiseSVN 不允许您在变更集中选择多个文件来恢复。要么全部，要么只有1。

## 变更集签入

对于所有其他阅读，请确保“签入”仅涉及与该更改相关的文件。这应该是当今的普遍做法；但是，我仍然发现开发人员在一天结束时“枪杀”签入，将当天的所有更改捆绑到一个签入中。

我眯着眼睛看着那些开发者。-_^

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T18:38:57.020

**如果你想恢复之前的提交（修订）：**

使用资源管理器：

1.  右键单击要还原的文件/文件夹，
2.  TortoiseSVN->显示日志，
3.  右键单击不需要的修订，
4.  "从本次修订中恢复更改",
5.  提交->确定。

**如果要撤消本地所做的更改（未提交）**

使用资源管理器：右键单击文件，TortoiseSVN->Revert。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T18:52:30.500

除了 Bartek 所说的，您可以检查本地工作副本的特定修订，然后将其提交回头部。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T00:28:41.367

请注意，您只能在签入新修订版的意义上“恢复”，该修订版不再包含您想要恢复的更改。这在其他答案中有所描述。

您实际上*无法*撤消签入（如“从未发生过”），旧状态仍将保留在存储库的历史记录中。

真正撤消/删除东西是一个长期存在的功能要求：

[http://subversion.tigris.org/issues/show_bug.cgi?id=516](http://subversion.tigris.org/issues/show_bug.cgi?id=516)

# extjs - Best looking administration panels for web applications

> ID：611882
> 
> 赞同：-1
> 
> 时间：2009-03-04T18:37:53.717
> 
> 标签：extjs

Please post a couple links to screenshots or demos to best looking administration interfaces for web applications and why do you think so.

Personally, I like what 37signals produces, also extJS based panels, though they tend to be rather slow.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-08T01:09:46.760

[我猜， lipsiadmin](http://rubygems.org/gems/lipsiadmin)就是你要找的东西

> Lipsiadmin 是您项目的新革命性管理员。Lipsiadmin 基于 Ext Js 2.0。框架（带有原型适配器）并且已为 Rails 2.0 做好准备。该管理员适用于新手开发人员，也适用于专家，并非完全用 javascript 编写，因为开发人员的目标是以敏捷的方式构建 Web/站点应用程序，因此我们以一种新的智能方式使用 extjs，混合了“旧”html 和新ajax 函数，例如 ext 管理页面、网格、树和错误的布局，但表单是 html 代码。

# regex - 正则表达式 - 如何匹配除特定模式之外的所有内容

> ID：611883
> 
> 赞同：172
> 
> 时间：2009-03-04T18:37:55.247
> 
> 标签：regex, findstr

如何编写正则表达式来匹配任何不符合特定模式的字符串？我面临必须匹配 (A and ~B) 模式的情况。

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-03-04T18:41:03.380

您可以使用前瞻断言：

```
(?!999)\d{3} 
```

此示例匹配除 之外的三个数字`999`。

* * *

但是，如果您碰巧没有具有此功能的正则表达式实现（请参阅正则表达式风格的[比较](https://en.wikipedia.org/wiki/Comparison_of_regular_expression_engines)），您可能必须自己构建具有基本功能的正则表达式。

仅具有基本语法的兼容正则表达式将是：

```
[0-8]\d\d|\d[0-8]\d|\d\d[0-8] 
```

这也匹配任何不是 的三位数序列`999`。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-02-21T11:26:16.957

如果要匹配字符串中的单词 A 而不是匹配单词 B。例如：如果您有文本：

```
1\. I have a two pets - dog and a cat
2\. I have a pet - dog 
```

如果你想搜索有宠物**狗****但没有猫**的文本行，你可以使用这个正则表达式：

```
^(?=.*?\bdog\b)((?!cat).)*$ 
```

它只会找到第二行：

```
2\. I have a pet - dog 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-04T18:48:29.823

匹配模式并使用宿主语言反转匹配的布尔结果。这将更加清晰和可维护。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-05-13T21:51:42.467

不是，复活了这个古老的问题，因为它有一个没有提到的简单解决方案。[（在对正则表达式赏金任务](https://stackoverflow.com/q/23589174)进行一些研究时发现了您的问题。）

> 我面临必须匹配 (A and ~B) 模式的情况。

基本的正则表达式非常简单：`B|(A)`

您只需忽略整体匹配并检查将包含 A 的第 1 组捕获。

一个例子（所有关于在正则表达式中解析 html 的免责声明）：A 是数字，B 是内的数字`<a tag`

正则表达式：`<a.*?<\/a>|(\d+)`

[演示](http://regex101.com/r/uS4iZ7)（查看右下窗格中的第 1 组）

**参考**

[除了情况 s1、s2、s3 之外，如何匹配模式](https://stackoverflow.com/q/23589174)

[如何匹配模式，除非...](http://www.rexegg.com/regex-best-trick.html)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-04T19:11:16.040

正则语言的补语也是正则语言，但要构造它，您必须为正则语言构建[DFA](http://en.wikipedia.org/wiki/Deterministic_finite_automata)，并将任何有效的状态更改为错误。请参阅[此](http://nitsan.org/~maratb/cs164/lminus.html)示例。该页面没有说的是它转换`/(ac|bd)/`为`/(a[^c]?|b[^d]?|[^ab])/`. 从 DFA 转换回正则表达式并非易事。如果您可以像之前建议的那样使用未更改的正则表达式并更改代码中的语义，则会更容易。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-05T02:26:17.787

模式 - 重新

```
str.split(/re/g) 
```

将返回除模式之外的所有内容。

[在这里](http://www.pagecolumn.com/tool/regtest.htm)测试

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T02:29:28.200

```
(B)|(A) 
```

然后使用第 2 组捕获的内容...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-01-15T16:11:00.943

我在这里的回答也可能解决您的问题：

[https://stackoverflow.com/a/27967674/543814](https://stackoverflow.com/a/27967674/543814)

*   而不是替换，你会使用匹配。
*   而不是 group `$1`，您将阅读 group `$2`。
*   组`$2`在此处不被捕获，这是您可以避免的。

例子：

`Regex.Match("50% of 50% is 25%", "(\d+\%)|(.+?)");`

第一个捕获组指定您希望避免的模式。最后一个捕获组捕获其他所有内容。只需读出该组，`$2`.

# deployment - How can I check the device platform before deployment in the .NET Compact Framework?

> ID：611888
> 
> 赞同：0
> 
> 时间：2009-03-04T18:39:17.177
> 
> 标签：deployment, windows-mobile, platform, pocketpc

I've developed an application for Windows Mobile using Windows Mobile 6 Pro with CF 3.5 and I have some deployment questions.

I'm targeting only Pocket PC and I don't want to let users install it on their smartphone (because it simply won't work).

How can I check for the platform on which the user is installing the application and show him some error message?

Just to let you know, I have an .msi in order to install the app into the device from the desktop (setup project with cab inside), and it's fine.

I just need this extra verification.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T19:21:51.567

有关如何检测平台的信息，请参阅此[链接。](http://blogs.msdn.com/netcfteam/archive/2006/09/22/766343.aspx)Cab 文件支持可选的[setup.dll](http://msdn.microsoft.com/en-us/library/aa924308.aspx)，可用于在 Install init、Install exit、Uninstall init 和 Unistall exit 中注册自定义操作。如果平台不匹配，您可以使用 install init 入口点并停止安装或显示对话框。这当然必须是原生开发。

# windows - Start Directory in Windows Explorer running Vista not set properly?

> ID：611890
> 
> 赞同：0
> 
> 时间：2009-03-04T18:39:51.200
> 
> 标签：windows, windows-vista, explorer

When I right click on Windows Explorer, select Properties, it opens a panel, I set the value of "Start In" to "C:\", which means I want it to point to my C: drive when I open explorer, but it's not working, it always points to "Documents". On XP I did the same thing and it worked, but now I got this new PC with Vista, it doesn't work? How to fix this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T19:18:56.020

使用资源管理器启动参数，例如：

```
%SystemRoot%\explorer.exe /e,D:\Downloads 
```

# .net - NHibernate 过滤器不适用于 Session.Get

> ID：611891
> 
> 赞同：7
> 
> 时间：2009-03-04T18:39:54.367
> 
> 标签：.net, nhibernate

我正在尝试实现一个可软删除的存储库。通常这可以通过删除事件侦听器轻松完成。要过滤掉已删除的实体，我可以将**Where**属性添加到我的类映射中。但是，我还需要在该实体的存储库中实现另外两个方法：**Restore**和**Purge**。恢复将“取消删除”实体，而清除将硬删除它们。这意味着我不能使用 Where 属性（因为它阻止了软删除的实体对任何访问）

我尝试使用**过滤器**。我可以创建一个过滤器并在会话中启用或禁用它以达到相同的结果。但问题是过滤器对 Session.Get 方法没有任何影响（它们只影响基于 ICriteria 的访问）。

关于如何解决这个问题的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-07-13T09:17:38.597

法比奥·毛洛的引述：

> 按照设计。过滤器不适用于 Get 或 Load，因为它们的意思是：我想用这个 ID 加载实体。
> 
> 仅当您使用显式联接或更一般地，当过滤器的 QuerySpace 与查询的 QuerySpace 匹配时，动态过滤器才适用于 HQL/Criteria 和 Collection（对集合启用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-13T09:06:00.170

IInterceptor 会为此工作吗？

查看 EmptyInterceptor 我发现它有一个 OnLoad，我认为您可以使用它来拦截对象加载。

# c++ - 我需要在 C++ 中创建一个简单的回调吗？我应该使用 boost::function 吗？

> ID：611892
> 
> 赞同：2
> 
> 时间：2009-03-04T18:40:00.013
> 
> 标签：c++, boost, callback, functor

假设我有一些这样的代码：

```
class Visitor {
   public:
      Visitor(callBackFunction) {}
      void visit() {
          //do something useful
          invokeCallback();
      }
}

class ClassThatCanBeVisited {
    Visitor &visitor;

    public:
       ClassThatCanBeVisited(Visitor &_visitor) : visitor(_visitor){}
       void someUsefulMethod() {
          int data= 42;
          visitor.visit(data);
       }
};

void callBackFunction() {
    //do something useful in the context of the Main file
}
int main() {
     Visitor visitor;
     ClassThatCanBeVisited foo(visitor);
     foo.someUsefulMethod();
} 
```

我需要创建一个简单的回调，只要调用 Visitor::visit() 就会调用该回调。我知道我可能应该将回调的代码放在我的访问者中，但它在不同的上下文中，所以我想将 callBackFunction() 传递给访问者，以便他可以调用我的回调函数。

我在网上找了东西，看到了 boost::function，但是 c++ 已经有了基本的仿函数。

为了使代码更清晰，我应该使用哪一个？回调将是一个简单的 void() 函数，但它可能会增长，你永远不知道未来 :)

推荐的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T18:43:09.960

是的 boost::function 会做得很好。这是它的一个非常常见的用法。您将需要使用 boost::bind 将实例绑定到成员函数。

```
 func = boost::bind( &MyClass::CallbackFunc, this); 
```

将是您在课堂上如何做到这一点。

确保“this”不会消失，否则你的 boost 函数会在某个 boost header 的中间崩溃。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T18:45:37.130

如果您不想使用 boost::function，可以使用回调接口及其层次结构。

```
class VisitorCallback
{
public:
    virtual void handle( const Visitor& ) = 0;
}; 
```

如果您有或可以使用 boost::function - 使用它，这是摆脱所有这些回调类的好方法。

**编辑：** @edisongustavo：

boost::function 和 boost::bind 可能不会使您的代码更具可读性。但它会让你有机会将自由函数（我的意思是类外函数和静态类函数）作为回调以及任何类的现有函数传递。

使用 boost 函数，您可以将具有例如 2 个参数的函数作为回调传递，而回调函数只需要一个参数。

```
typedef boost::function< void ( int ) > IntExpectingCallback;

void TwoIntFunction( int, int );
{
}
...
IntExpectingCallback callback = boost::bind( TwoIntFunction, 5, _1 ); 
```

但是同样，除非您的所有团队都知道并支持提升，否则这不会使您的代码更具可读性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T07:28:13.437

上面的答案很好，但我只想指出您在问题中提到的一些内容，这仍然与您在 C++ 回调对象（在 Mykola 的答案中）和 boost 之间的选择有关。

“回调将是一个简单的 void() 函数，但它可能会增长，你永远不知道未来 :)”

这可能是额外的、不必要的功能的最糟糕的原因——即“以防万一你需要它”。如果你不知道——那么不要做超出必要的事情，你的猜测很可能是错误的，尤其是在你需要的时候。

另一方面，如果您确实知道很可能*很快*就会需要该功能，那么可能值得添加它。

再次重申 Mykola 所说的话——如果你的项目已经有了提升并且你的团队喜欢它，那么就使用它，否则它可能是矫枉过正的。

# javascript - Jquery 问题：如何分解多部分表单，以便一次只能看到一个字段集？

> ID：611898
> 
> 赞同：1
> 
> 时间：2009-03-04T18:41:23.630
> 
> 标签：javascript, jquery, jquery-plugins, webforms

我牢牢掌握了 XHTML 和 CSS，但 PHP 和 Javascript 对我来说就像魔法一样。

我正在使用基于 PHP 的[Textpattern CMS](http://textpattern.com)构建一个讨论站点。用户登录后，可以使用公共端表单添加新的讨论主题。有很多输入字段，按`fieldset`单个`form`元素中的 HTML 元素分组，向特定数据库表添加新行。我想做的是**一次只显示一个字段集**，插入允许人们**在字段集之间导航的***上一个*和*下一个*链接。

 **Textpattern 与 jquery 捆绑在一起，我找到了一个[描述此功能的 jquery 插件](http://blog.vokle.com/index.php/2008/08/22/babysteps/)。但我无法让它工作。

这是我的文档中的内容`head`：

```
<style type="text/css" media="screen">
    fieldset {display: none;}
</style>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js"></script>
<script type="text/javascript" src="http://site.url/scripts/jquery.babysteps-0.2.1.js"></script>
<script type="text/javascript" language="javascript">
    $('#step1').bindStep('#step2');
    $('#step2').bindStep('#step3');

    $('#step1').show();
</script> 
```

我的表格是这样的：

```
<fieldset id="step1">
    <legend>Step 1 Fields</legend>
    <!-- fields -->
</fieldset>
<fieldset id="step2">
    <legend>Step 2 Fields</legend>
    <!-- fields -->
</fieldset>
<fieldset id="step3">
    <legend>Step 3 Fields</legend>
    <!-- fields -->
</fieldset>
<input type="submit" value="Post this Article!" /> 
```

结果是`style`声明隐藏了*every* `fieldset`，但脚本根本不显示`step1`。我已经仔细检查了所有文件路径，并尝试使用指向本地 jquery 包的链接而不是 Google 版本的链接，但我得到了相同的结果。

如果我能做到这一点，我会很高兴，但如果有另一种方法可以在没有 babysteps 插件的情况下实现这一点，我也会对这个结果感到满意。

您可以提供的任何指导或具体建议将不胜感激！分步说明或实际故障排除问题（您的计算机是否已插入？）也可能会有所帮助。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T18:46:37.627

我不确定那个特定的插件，但只有 jquery：

```
$(function(){

    $('#gotoStep2').click(function(){
        $('#step1').hide();
        $('#step2').show();
        return false;
    });

}); 
```

你在哪里

```
<input type="button" id="gotoStep2" value="next &raquo;"/> 
```

内部步骤1

和你的CSS：

```
#step2, #step3 //etc
{
    display: none;
} 
```

我相信你可以弄清楚如何在你的所有步骤中重复这个:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T18:54:47.857

```
<script type="text/javascript" language="javascript">
  $(function(){
    $("#step1").bindStep("#step2");
    $("#step2").bindStep("#step3");

    $("#step1").show();
  });
</script> 
```

如果这不起作用，请放弃该插件。（说真的，甚至该页面上的演示都不起作用。）

# rest - 带有 URL 查询参数的 HTTP POST——好主意还是不好？

> ID：611906
> 
> 赞同：547
> 
> 时间：2009-03-04T18:42:52.393
> 
> 标签：rest, http

我正在设计一个通过 HTTP 的 API，我想知道是否使用 HTTP POST 命令，但只有 URL 查询参数，没有请求正文，是一个好方法。

注意事项：

*   “良好的 Web 设计”需要通过 POST 发送非幂等操作。这是一个非幂等的动作。
*   当请求参数存在于 URL 中时，更容易开发和调试此应用程序。
*   API 不适合广泛使用。
*   似乎发出没有正文的 POST 请求需要更多的工作，例如`Content-Length: 0`必须显式添加标头。
*   在我看来，没有正文的 POST 也有点违背大多数开发人员和 HTTP 框架的期望。

通过 URL 查询而不是请求正文在 POST 请求上发送参数是否有更多的陷阱或优势？

编辑：正在考虑的原因是这些操作不是幂等的，并且除了检索之外还有副作用。请参阅[HTTP 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)：

> 特别是，已经建立了约定，即 GET 和 HEAD 方法不应该具有采取除检索之外的操作的意义。这些方法应该被认为是“安全的”。这允许用户代理以特殊的方式表示其他方法，例如 POST、PUT 和 DELETE，以便用户意识到正在请求可能不安全的操作。
> 
> ...
> 
> 方法还可以具有“幂等性”的属性，因为（除了错误或过期问题）N > 0 个相同请求的副作用与单个请求相同。GET、HEAD、PUT 和 DELETE 方法共享此属性。此外，方法 OPTIONS 和 TRACE 不应该有副作用，因此本质上是幂等的。

* * *

## 回答 #1

> 赞同：320
> 
> 时间：2009-03-04T19:20:39.370

如果您的操作不是幂等的，那么您*必须*使用`POST`. 如果你不这样做，你只是在自找麻烦。 `GET`，`PUT`并且`DELETE`方法*必须*是幂等的。想象一下，如果客户端为您的服务预取所有可能的`GET`请求，您的应用程序会发生什么——如果这会导致客户端可见的副作用，那么就出了问题。

我同意发送`POST`带有查询字符串但没有正文的 a 似乎很奇怪，但我认为在某些情况下它可能是合适的。

将 URL 的查询部分视为对资源的命令，以限制当前请求的范围。通常，查询字符串用于对`GET`请求进行排序或过滤（如），但我认为在 a上限制范围也是`?page=1&sort=title`有意义的（也许如）。`POST``?action=delete&id=5`

* * *

## 回答 #2

> 赞同：166
> 
> 时间：2012-05-03T06:56:04.410

每个人都是对的：坚持使用 POST 处理非幂等请求。

同时使用 URI 查询字符串和请求内容怎么样？那么它是有效的HTTP（见注1），为什么不呢？！

这也是完全合乎逻辑的：URL，包括它们的查询字符串部分，用于*定位*资源。而 HTTP 方法动词（POST - 及其可选的请求内容）用于指定操作或*如何处理*资源。这些应该是正交的问题。（但是，对于 ContentType=application/x-www-form-urlencoded 的特殊情况，它们并不是完美的正交关注点，请参见下面的注释 2。）

注 1：HTTP 规范 (1.1) 没有规定查询参数和内容对于接受 POST 或 PUT 请求的 HTTP 服务器是互斥的。所以任何服务器都可以自由地接受两者。即，如果您编写服务器，则没有什么可以阻止您选择同时接受两者（除了可能是一个不灵活的框架）。通常，服务器可以根据它想要的任何规则来解释查询字符串。它甚至可以使用条件逻辑来解释它们，该逻辑也引用其他标头（如 Content-Type），这导致注 2：

注意 2：如果*Web 浏览器*是人们访问您的 Web 应用程序的主要方式，并且**application/x-www-form-urlencoded**是他们发布的 Content-Type，那么您*应该*遵循该 Content-Type 的规则。并且 application/x-www-form-urlencoded 的规则更加具体（坦率地说，不寻常）：在这种情况下，您必须将 URI 解释为一组参数，而不是资源位置。[这与Powerlord提出的用处相同；可能很难使用 Web 表单将内容发布到您的服务器。只是解释有点不同。]

注 3：查询字符串最初的用途是什么？RFC 3986 将 HTTP 查询字符串定义为 URI 部分，用作定位资源的非分层方式。

如果提出这个问题的读者想问什么是好的 RESTful 架构：RESTful 架构模式不需要 URI 方案以特定方式工作。RESTful 架构关注系统的其他属性，例如资源的可缓存性、资源本身的设计（它们的行为、能力和表示），以及是否满足幂等性。或者换句话说，实现与HTTP协议及其HTTP方法动词集高度兼容的设计。:-) （换句话说，RESTful 架构对资源的*定位*方式不是很清楚。）

最后一点：有时查询参数会用于其他事情，既不是定位资源也不是编码内容。见过像“PUT=true”或“POST=true”这样的查询参数吗？这些是不允许您使用 PUT 和 POST 方法的浏览器的解决方法。虽然这些参数被视为 URL 查询字符串的一部分（在线上），但我认为它们在本质上不是 URL 查询*的*一部分。

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2009-03-04T19:16:26.167

你要理由吗？这是一个：

不能使用 Web 表单向混合使用 GET 和 POST 的页面发送请求。如果将表单的方法设置为 GET，则所有参数都在查询字符串中。如果将表单的方法设置为 POST，则所有参数都在请求正文中。

来源：HTML 4.01 标准，第[17.13 节表单提交](http://www.w3.org/TR/html4/interact/forms.html#submit-format)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-03-04T18:56:28.400

从编程的角度来看，对于客户端，它正在打包参数并将它们附加到 url 并执行 POST 与 GET。在服务器端，它评估来自查询字符串的入站参数，而不是发布的字节。基本上，这是一个洗涤。

可能存在优点/缺点的地方可能在于特定客户端平台如何在其网络堆栈中使用 POST 和 GET 例程，以及 Web 服务器如何处理这些请求。根据您的实施，一种方法可能比另一种更有效。知道这将指导您在这里做出决定。

尽管如此，从程序员的角度来看，我更喜欢允许在正文中包含所有参数的 POST，或者在 url 上包含所有参数的 GET，并在任何 POST 请求中显式忽略 url 参数。它避免了混淆。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-05-10T19:04:11.960

我认为在将内容有效负载限制在 POST 正文中的同时，具有标识 URL 上的资源的查询参数仍然可能是相当 RESTful 的。这似乎将“我要发送什么？”的考虑分开。与“我将其发送给谁？”。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-05T00:49:53.213

[REST](http://en.wikipedia.org/wiki/Representational_State_Transfer)阵营有一些指导原则，我们可以使用这些原则来标准化我们使用 HTTP 动词的方式。这在您构建 RESTful API 时很有帮助。

简而言之：GET 应该是只读的，即对服务器状态没有影响。POST 用于在服务器上创建资源。PUT 用于更新或创建资源。DELETE 用于删除资源。

换句话说，如果您的 API 操作更改了服务器状态，REST 建议我们使用 POST/PUT/DELETE，而不是 GET。

用户代理通常知道执行多个 POST 是不好的，并且会警告它，因为 POST 的目的是改变服务器状态（例如，在结帐时支付商品），您可能不想这样做两次！

与您可以随心所欲地执行的 GET 相比（幂等）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-12-15T12:35:51.367

可以在 POST 端点上使用查询参数，只要它们引用已经存在的资源。

例如：

```
POST /user_settings?user_id=4
{
  "use_safe_mode": 1
} 
```

上面的 POST 有一个引用现有资源的查询参数。body 参数定义要创建的新资源。

# 编辑：

我更喜欢让端点的路径直接指向已经存在的资源，如下所示：

```
POST /user_settings/4
{
...
} 
```

原因有三：

1.  我发现它具有更好的可读性，因为查询参数被命名，如上面的“user_id”，而不仅仅是“4”。
2.  通常，还有一个 GET 端点来获取资源。在这种情况下，端点的路径和查询参数将是相同的，我喜欢这种对称性。
3.  如果需要多个参数来定义已经存在的资源，我发现嵌套可能会变得繁琐且难以阅读：

```
POST /user_settings/{user_id}/{which_settings_id}/{xyz}/{abc}/ ...
{
...
} 
```

# encryption - 将订单号隐藏/加密为另一个数字：对称，“随机”外观？

> ID：611915
> 
> 赞同：30
> 
> 时间：2009-03-04T18:45:41.733
> 
> 标签：encryption, random, encoding, numbers

客户有一个简单的递增订单号（1、2、3...）。他希望最终用户收到一个 8 位或 9 位（只有数字——没有字符）的“随机”数字。显然，这个“随机”数字实际上必须是唯一且可逆的（它实际上是对实际订单号的加密）。

我的第一个想法是随机播放一些位。当我向客户展示一个示例序列时，他抱怨随后的 obfuscOrderNumbers 一直在增加，直到它们达到“混洗”点（低阶位开始发挥作用的点）。他希望 obfuscOrderNumbers 看起来尽可能随机。

我的下一个想法是确定性地播种一个线性同余伪随机数生成器，然后取实际OrderNumber th 值。但在这种情况下，我需要担心冲突——客户端需要一个保证在至少 10^7 个周期内不会发生冲突的算法。

我的第三个想法是“嗯，只是加密该死的东西”，但如果我使用股票加密库，我必须对其进行后处理才能获得 8 位或 9 位数字的唯一要求。

我的第四个想法是将 actualOrderNumber 的位解释为格雷编码的整数并返回它。

我的第五个想法是：“我可能想多了。我敢打赌 StackOverflow 上的某个人可以用几行代码做到这一点。”

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-04T19:33:02.553

随机选择一个 8 位或 9 位数字，例如 839712541。然后，取您的订单号的二进制表示形式（在此示例中，我没有使用 2 的补码），将其填充到相同的位数（30），然后反转它, 异或翻转的订单号和幻数。例如：

```
1         = 000000000000000000000000000001

Flip      = 100000000000000000000000000000
839712541 = 110010000011001111111100011101
XOR       = 010010000011001111111100011101 = 302841629

2         = 000000000000000000000000000010

Flip      = 010000000000000000000000000000
839712541 = 110010000011001111111100011101
XOR       = 100010000011001111111100011101 = 571277085 
```

要取回订单编号，请将输出编号与您的幻数异或，转换为位字符串，然后反转。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-04T19:10:02.157

哈希函数？ [http://www.partow.net/programming/hashfunctions/index.html](http://www.partow.net/programming/hashfunctions/index.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-04T19:09:47.087

客户是否会要求分发混淆的连续订单号以使其看起来特别像任何东西？

如果您不想使加密复杂化，请结合使用位改组和一些随机加盐（如果您有多余的位/数字） XOR 叠加在某个固定常数（或某些函数的某些函数上，很容易可随时与模糊的订单 ID 一起使用，例如`customer_id`下订单的人？）

* * *

**编辑**

看来，客户的所有愿望都是让外部方无法推断销售进度。在这种情况下，改组解决方案（位映射，例如原始位 1 映射到混淆位 6，原始位 6 映射到混淆位 3 等）应该绰绰有余。如果你真的想让它更难破解，可以添加一些随机位，前提是你有额外的位可用（例如，假设原始订单号最多只有 6 位，但你可以在混淆的订单号中使用 8-9，那么您可以在执行位映射之前使用 2-3 位随机数）。可能对结果进行异或以进行额外的恐吓（好奇的一方可能会尝试生成两个连续的混淆订单，将它们相互异或以摆脱异或常数，

* * *

**编辑2**

当然，您可以为经过混淆的订单 ID 分配完全随机的数字，将对应关系存储到持久存储（例如 DB）并执行冲突检测以及针对同一存储的去混淆处理。如果你问我有点矫枉过正，但从好的方面来说，它是最好的混淆（并且你实现你的灵魂想要的任何分布函数，*你*可以随时更改分布函数。）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-04T19:20:56.280

在 9 位数字中，第一个数字是 0 到 7（或 1-8）之间的随机索引。在该位置放置另一个随机数字。剩下的就是“真实订单号：

*   原始订单：**100**
*   随机指数：5
*   随机数：4（保证，掷骰子:)）
*   结果：**500040100**

*   原编号：**101**

*   随机指数：2
*   随机数字 6
*   结果：**200001061**

您可以决定第 5 个（或任何其他）数字是索引。

或者，如果您可以接受 6 位数的真实订单号，那么您也可以引入“二级”索引。您可以颠倒“真实”顺序中的数字顺序。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-07-25T14:47:27.157

我看到这个很晚，（！）因此我的反应很晚。它可能对以后出现的其他人有用。

你说：“我的第三个想法是‘嗯，只是加密该死的东西，’但如果我使用股票加密库，我必须对其进行后处理才能获得 8 位或 9 位数字的唯一要求。”

那是对的。加密是可逆的，并且对于给定的输入保证是唯一的。正如您所指出的，大多数标准加密都没有正确的块大小。然而，有一个[Hasty Pudding Cipher](http://en.wikipedia.org/wiki/Hasty_Pudding_cipher)可以有 1 位以上的任何块大小。

或者，您可以编写自己的。鉴于您不需要 NSA 无法破解的东西，那么您可以构建一个简单的[Feistel 密码](http://en.wikipedia.org/wiki/Feistel_cipher)来满足您的需求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-06T10:08:53.933

如果您的订单 ID 是唯一的，您只需创建一个前缀并将该前缀与您的订单 ID 添加/混合。

像这样的东西：

```
long pre = DateTime.Now.Ticks % 100;
string prefix = pre.ToString();
string number = prefix + YOURID.ToString() 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-11-20T09:45:54.917

```
<?PHP 

$cry = array(0=>5,1=>3,2=>9,3=>2,4=>7,5=>6,6=>1,7=>8,8=>0,9=>4);

function enc($e,$cry,$k){
    if(strlen($e)>10)die("max encrypt digits is 10");
    if(strlen($e) >= $k)die("Request encrypt must be lesser than its length");
    if(strlen($e) ==0)die("must pass some numbers");

    $ct =  $e;
    $jump = ($k-1)-strlen($e);
    $ency = $cry[(strlen($e))];
    $n = 0;
    for($a=0;$a<$k-1;$a++){
        if($jump > 0){
            if($a%2 == 1){
                $ency .=rand(0,9);
                $jump -=1;
            }else{
                if(isset($ct[$n])){
                    $ency.=$cry[$ct[$n]];
                    $n++;
                }else{
                    $ency .=rand(0,9);
                    $jump -=1;
                }
            }
        }else{
            $ency.= $cry[$ct[$n]];
            $n++;
        }
    }
    return $ency;
}

function dec($e,$cry){
    //$decy = substr($e,6);
    $ar = str_split($e,1);
    $len = array_search($ar[0], $cry);
    $jump = strlen($e)-($len+1);
    $val = "";
    for($i=1;$i<strlen($e);$i++){
        if($i%2==0){
            if($jump >0){
                //$val .=array_search($e[$i], $cry);
                $jump--;
            }else{
                $val .=array_search($e[$i], $cry);
            }
        }else{
            if($len > 0){
                $val .=array_search($e[$i], $cry);
                $len--;
            }else{
                $jump--;
            }
        }
    }
    return $val;
}
if(isset($_GET["n"])){
    $n = $_GET["n"];
}else{
    $n = 1000;
}

$str = 1253;
$str = enc($str,$cry,15);
echo "Encerypted Value : ".$str ."<br/>";
$str = dec($str,$cry);
echo "Decrypted Value : ".$str ."<br/>";
?> 
```

# c# - Nested Datalists in ASP.net

> ID：611916
> 
> 赞同：2
> 
> 时间：2009-03-04T18:45:57.643
> 
> 标签：c#, asp.net, vb.net, nested, datalist

I am using nested datalists to display hierarchical data. In the nested datalist i want to be able to bind to a property that belongs to the object that the parent datalist is bound to.

does anyone know how I can achieve this ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T19:38:30.887

我不知道存档的干净方法。

哈克你可能（不想）想尝试：

```
<%# 
     (DataBinder.GetDataItem(Container.BindingContainer...BindingContainer) as AType)
     .PropertyOfParentsDataListDataItem 
 %> 
```

或者

```
<%# 
     Eval(
        DataBinder.GetDataItem(Container.BindingContainer...BindingContainer)
        ,"PropertyOfParentsDataListDataItem"
     )
 %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-25T13:37:21.743

我不知道如何内联，但如果你连接到 OnItemDataBound ，你可以使用以下代码：

```
Protected Sub YourList_ItemDataBound(ByVal sender As Object, ByVal e As DataListItemEventArgs) Handles YourList.ItemDataBound

  If e.Item.ItemType = ListItemType.Item Or _
    e.Item.ItemType = ListItemType.AlternatingItem Then

    CType(e.Item.FindControl("LabelName"), Label).Text = _
       DataBinder.Eval(CType(sender.Parent, DataListItem).DataItem, "FieldName"))

  End If

End Sub 
```

或在 C# 中（未经验证）

```
Protected Void YourList_ItemDataBound(Object sender, DataListItemEventArgs e)
{
   if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem )
  {
    ((Label)e.Item.FindControl("LabelName")).Text = 
       DataBinder.Eval(((DataListItem)sender.Parent).DataItem, "FieldName");

  }
} 
```

# c# - 如何在 C# 中删除包含只读文件的目录？

> ID：611921
> 
> 赞同：61
> 
> 时间：2009-03-04T18:47:10.357
> 
> 标签：c#, directory, readonly, delete-directory

我需要删除一个包含只读文件的目录。哪种方法更好：

*   使用`DirectoryInfo.Delete()`, 或,

*   `ManagementObject.InvokeMethod("Delete")`?

使用`DirectoryInfo.Delete()`，我必须手动关闭每个文件的只读属性，但`ManagementObject.InvokeMethod("Delete")`似乎不需要。有没有一种情况比另一种更可取？

示例代码（test.txt 是只读的）。

### 第一种方式：

```
DirectoryInfo dir = new DirectoryInfo(@"C:\Users\David\Desktop\");
dir.CreateSubdirectory("Test");

DirectoryInfo test = new DirectoryInfo(@"C:\Users\David\Desktop\Test\");
File.Copy(@"C:\Users\David\Desktop\test.txt", @"C:\Users\David\Desktop\Test\test.txt");
File.SetAttributes(@"C:\Users\David\Desktop\Test\test.txt", FileAttributes.Archive);
test.Delete(true); 
```

### 第二种方式：

```
DirectoryInfo dir = new DirectoryInfo(@"C:\Users\David\Desktop\");
dir.CreateSubdirectory("Test");

DirectoryInfo test = new DirectoryInfo(@"C:\Users\David\Desktop\Test\");
File.Copy(@"C:\Users\David\Desktop\test.txt", @"C:\Users\David\Desktop\Test\test.txt");

string folder = @"C:\Users\David\Desktop\Test";
string dirObject = "Win32_Directory.Name='" + folder + "'";
using (ManagementObject managementObject = new ManagementObject(dirObject))
{
    managementObject.Get();
    ManagementBaseObject outParams = managementObject.InvokeMethod("Delete", null,
    null);
    // ReturnValue should be 0, else failure
    if (Convert.ToInt32(outParams.Properties["ReturnValue"].Value) != 0)
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2012-01-03T15:12:23.377

避免递归调用的最简单方法是在获取s时使用该`AllDirectories`选项，如下所示：`FileSystemInfo`

```
public static void ForceDeleteDirectory(string path) 
{
    var directory = new DirectoryInfo(path) { Attributes = FileAttributes.Normal };

    foreach (var info in directory.GetFileSystemInfos("*", SearchOption.AllDirectories))
    {
        info.Attributes = FileAttributes.Normal;
    }

    directory.Delete(true);
} 
```

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2009-03-15T16:10:55.443

这是一个扩展方法，它设置`Attributes`为`Normal`递归，然后删除项目：

```
public static void DeleteReadOnly(this FileSystemInfo fileSystemInfo)
{
    var directoryInfo = fileSystemInfo as DirectoryInfo;    
    if (directoryInfo != null)
    {
        foreach (FileSystemInfo childInfo in directoryInfo.GetFileSystemInfos())
        {
            childInfo.DeleteReadOnly();
        }
    }

    fileSystemInfo.Attributes = FileAttributes.Normal;
    fileSystemInfo.Delete();
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-06-09T19:15:35.867

试试这个，

```
private void DeleteRecursiveFolder(string pFolderPath)
{
    foreach (string Folder in Directory.GetDirectories(pFolderPath))
    {
        DeleteRecursiveFolder(Folder);
    }

    foreach (string file in Directory.GetFiles(pFolderPath))
    {
        var pPath = Path.Combine(pFolderPath, file);
        FileInfo fi = new FileInfo(pPath);
        File.SetAttributes(pPath, FileAttributes.Normal);
        File.Delete(file);
    }

    Directory.Delete(pFolderPath);
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-11-21T19:50:43.320

另一种不需要递归的方法。

```
public static void ForceDeleteDirectory(string path)
{
    DirectoryInfo root;
    Stack<DirectoryInfo> fols;
    DirectoryInfo fol;
    fols = new Stack<DirectoryInfo>();
    root = new DirectoryInfo(path);
    fols.Push(root);
    while (fols.Count > 0)
    {
        fol = fols.Pop();
        fol.Attributes = fol.Attributes & ~(FileAttributes.Archive | FileAttributes.ReadOnly | FileAttributes.Hidden);
        foreach (DirectoryInfo d in fol.GetDirectories())
        {
            fols.Push(d);
        }
        foreach (FileInfo f in fol.GetFiles())
        {
            f.Attributes = f.Attributes & ~(FileAttributes.Archive | FileAttributes.ReadOnly | FileAttributes.Hidden);
            f.Delete();
        }
    }
    root.Delete(true);
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-02-07T12:49:39.173

```
private void DeleteRecursiveFolder(DirectoryInfo dirInfo)
{
    foreach (var subDir in dirInfo.GetDirectories())
    {
        DeleteRecursiveFolder(subDir);
    }

    foreach (var file in dirInfo.GetFiles())
    {
        file.Attributes=FileAttributes.Normal;
        file.Delete();
    }

    dirInfo.Delete();
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-05T14:37:43.163

最好的解决方案是将所有文件标记为非只读，然后删除该目录。

```
// delete/clear hidden attribute
File.SetAttributes(filePath, File.GetAttributes(filePath) & ~FileAttributes.Hidden);

// delete/clear archive and read only attributes
File.SetAttributes(filePath, File.GetAttributes(filePath) 
    & ~(FileAttributes.Archive | FileAttributes.ReadOnly)); 
```

请注意，~ 是一个按位逻辑运算符，它返回给定二进制值的补码。我没有对此进行测试，但它应该可以工作。

谢谢！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-05T00:06:33.163

我会说你的第一种方法看起来更明确和可读。第二种方法闻起来像反射，不是类型安全的，而且看起来很奇怪。`ManagementObject`可以代表多种事物，因此实际上删除目录并不明显`.InvokeMethod("Delete")`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-08T00:37:06.157

从表面上看，使用 WMI 方法似乎比遍历整个文件系统更有效（例如，假设目录有 10 的数千个文件）。但我不知道 WMI 也不进行迭代。如果是这样，更接近金属（再次，假设）它应该更有效。

为了优雅，我承认递归方法很酷。

性能测试应该回答效率问题。如果包装在 DirectoryInfo 的扩展方法中，两者都可以很优雅。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-10-19T14:07:50.423

这是另一种避免自身递归的解决方案。

```
public static void DirectoryDeleteAll(string directoryPath)
{
    var rootInfo = new DirectoryInfo(directoryPath) { Attributes = FileAttributes.Normal };
    foreach (var fileInfo in rootInfo.GetFileSystemInfos()) fileInfo.Attributes = FileAttributes.Normal;
    foreach (var subDirectory in Directory.GetDirectories(directoryPath, "*", SearchOption.AllDirectories))
    {
        var subInfo = new DirectoryInfo(subDirectory) { Attributes = FileAttributes.Normal };
        foreach (var fileInfo in subInfo.GetFileSystemInfos()) fileInfo.Attributes = FileAttributes.Normal;
    }
    Directory.Delete(directoryPath, true);
} 
```

这通过在删除之前重置文件夹和文件的属性来工作，因此您可以删除“DirectoryResetAttributes”方法的最后一行并单独使用删除。

在相关说明中，虽然这有效，但我在删除“太长”的路径时遇到了问题，最终使用了此处发布的 robocopy 解决方案：[C#删除具有长路径的文件夹](https://stackoverflow.com/questions/2223007/c-sharp-deleting-a-folder-that-has-long-paths/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-28T06:18:27.570

为了跟进 Vitaliy Ulantikov 的解决方案，我用重命名/移动文件夹方法对其进行了补充：

```
 public static void renameFolder(String sourcePath, String targetPath) {
     try
     {
        if (System.IO.Directory.Exists(targetPath))
           DeleteFileSystemInfo(new DirectoryInfo(targetPath));
        System.IO.Directory.Move(sourcePath, targetPath);
     }
     catch (Exception ex)
     {
        Console.WriteLine("renameFolder: " + sourcePath + " " + targetPath + " " + ex.Message);
        throw ex;
     }
  }

  private static void DeleteFileSystemInfo(FileSystemInfo fsi) {
     fsi.Attributes = FileAttributes.Normal;
     var di = fsi as DirectoryInfo;

     if (di != null)
     {
        foreach (var dirInfo in di.GetFileSystemInfos())
        {
           DeleteFileSystemInfo(dirInfo);
        }
     }

     fsi.Delete();
  } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-03-15T09:34:18.607

我的 NET 框架 3.5 和 NET 框架版本 4 及更高版本的解决方案：

```
#region DeleteWithReadOnly
internal static void DeleteWithReadOnly(this DirectoryInfo di)
{
   foreach (FileSystemInfo fsi in di.EnumerateFileSystemInfos("*", SearchOption.AllDirectories))
   {
      fsi.Attributes = FileAttributes.Normal;
   }
   di.Delete(true);
}
#endregion

#region DeleteWithReadOnlyNET3_5
internal static void DeleteWithReadOnlyNET3_5(this DirectoryInfo di)
{
   foreach (FileSystemInfo fsi in di.GetFiles("*", SearchOption.AllDirectories))
   {
      fsi.Attributes = FileAttributes.Normal;
   }
   di.Delete(true);
}
#endregion 
```

用法：

```
DirectoryInfo di = new DirectoryInfo(@"C:\TMP");
di.DeleteWithReadOnly(); 
```

# visual-studio - 在版本控制中维护 Visual Studio vcproj 项目文件的建议

> ID：611925
> 
> 赞同：12
> 
> 时间：2009-03-04T18:47:22.650
> 
> 标签：visual-studio, version-control, project, projects-and-solutions

Microsoft Visual Studio 使用 XML 来保存其`.vcproj`项目文件。所以区分 XML 项目文件*应该*很容易。

不幸的是，如果您更改任何项目文件的属性，Visual Studio 坚持随机打乱项目文件的 XML 节点！这使得项目文件更改的文本差异和合并基本上是不可能的。更改一个编译器设置会使我的视觉差异工具认为我已经更改了文件中 50% 的行！我什至尝试过一些 XML 差异工具，但它们只是显示了对相同混乱的更结构化的视图。

有人对`.vcproj`在源代码管理中维护文件有任何建议吗？或者说服 Visual Studio**不要**重新排列文件中的 XML 节点的`.vcproj`方法？

（我还研究过使用 CMake 之类的工具`.vcproj`从对差异更友好的文本文件生成文件，但 CMake 有其自身的问题。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T19:16:27.947

这似乎时不时出现。

*   [合并 vcproj 文件 - SCM 的地狱](https://stackoverflow.com/questions/372357/merging-vcproj-files-scms-hell)

对于插件或其他规范化工具来说，这可能是一个成熟的问题。

在 MS 决定修复它之前，这将是一个很好的副业。那么你就不走运了——除非他们当然愿意购买你的 IP。

有人想开始一个开源项目或商业产品吗？我是游戏。

我可能会尝试一个独立的规范化工具，然后看看我是否可以把它变成一个插件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-03-01T03:41:00.740

我们现在在这里看到这种情况，项目文件的配置在几个人的计算机上重新排序，这非常令人沮丧......

****注意：***我们都使用 VS 2008 Pro，而不是 Team

起初看起来它们是随机重新排序的，但实际上有一个**模式**，它根本不是随机的。

对于一组，配置按平台排序，然后按配置：

*   调试|Win32
*   **调试|x64**
*   发布|Win32
*   **发布|x64**
*   调试 DX11|Win32
*   **调试 DX11|x64**
*   发布 DX11|Win32
*   **发布 DX11|x64**
*   ...

对于另一组，配置按 Config 排序，然后按 Platform：

*   调试|Win32
*   发布|Win32
*   调试 DX11|Win32
*   发布 DX11|Win32
*   **调试|x64**
*   **发布|x64**
*   **调试 DX11|x64**
*   **发布 DX11|x64**
*   ...

纵观 perforce 的历史，这与同一组人提交的多个项目是一致的，并且大约有 50/50 的比例，所以这不仅仅发生在一个人身上。

这是你们都看到的同一个问题吗？如果是这样，我希望这种模式有助于找到不涉及宏/额外差异步骤的解决方案......

它必须是某个地方的设置，或者是点击某物的副作用，因为每台机器都是 100% 可重现的。即使您为初始环境布局选择哪个选项（VC++、VB、通用开发等...）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T18:51:36.820

我使用 WinMerge 作为我的差异工具，并启用了移动块检测。它并不能完全解决问题，但它使可视化差异更容易忍受。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T23:07:03.820

您在哪个版本的 Visual Studio 中看到了这个？

我对 .vcproj 文件做了很多工作（我们在多个 Visual Studio 版本中为我们的库维护项目文件的版本，而且我总是在区分和合并这些东西），但我从未见过这种行为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-02T19:24:13.150

我在 Adob​​e 的团队在 vs2008 中也看到了同样的情况。只是一个基本的调试/发布，win32/win64 项目为您提供 4 种配置和随机洗牌。有几个人试图弄清楚 devstudio 重新排序的时间和原因，但目前的想法是排序键是关键字哈希 - 因此是半随机的。我们已经放弃了，在代码审查中只是总结了“真正的”变化。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-07T15:04:51.050

我想我已经找到了这次洗牌的原因。至少在VS2008中。

如果您安装 x64 编译器，VS 会将项目排序为：

```
Debug|Win32
Debug|x64
Release|Win32
Release|x64 
```

如果你不这样做，它会像这样订购它们：

```
Debug|Win32
Release|Win32
Debug|x64
Release|x64 
```

因此，请确保您所有的同行都安装了相同的编译器集，这样它就不会洗牌。

对其进行了测试，这种行为似乎是可重现的。

# wpf-controls - 如何在 WPF 中的用户控件中将控件指定为属性？

> ID：611928
> 
> 赞同：1
> 
> 时间：2009-03-04T18:48:53.283
> 
> 标签：wpf-controls

### 我的 XAML：

```
<TextBox x:Name="myTextBox" .../>
<MyExtender TargetTextBox=? .../> 
```

### 我的C＃：

```
MyExtender : UserControl
{
    public TargetTextBox { get; set; }
} 
```

如何在 XAML 中设置 TargetTextBox 属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T19:01:52.863

你应该能够做到：

```
<TextBox Name="tb">Something</TextBox>
<my:MyExtender TargetTextBox="{Binding ElementName=tb}" /> 
```

但这需要 TargetTextBox 是一个 DependencyProperty。将 MyExtender.xaml.cs 更改为：

```
 public partial class MyExtender : System.Windows.Controls.UserControl
{
    public MyExtender()
    {
        InitializeComponent();
    }
    public static readonly DependencyProperty TargetTextBoxPropery = 
        DependencyProperty.Register("TargetTextBox", typeof(TextBox), typeof(MyExtender));

    public TextBox TargetTextBox
    {
        get { return (TextBox)GetValue(TargetTextBoxPropery); }
        set { SetValue(TargetTextBoxPropery, value); }
    }

} 
```

你应该准备好了。

# .net - 在托管 C++ 中检测调试模式

> ID：611929
> 
> 赞同：1
> 
> 时间：2009-03-04T18:49:34.233
> 
> 标签：.net, c++, .net-2.0

在托管 C++/C++/CLI 中检测应用程序是否在调试模式下运行的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T19:00:49.950

[IsDebuggerPresent()](http://msdn.microsoft.com/en-us/library/ms680345(VS.85).aspx)吗？

或者如果它是用调试构建的？对于常规 C++，这很容易（定义了 _DEBUG），对于托管我不知道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T20:24:08.017

```
array<Object^>^ debuggableAttributes = Assembly::GetExecutingAssembly()->GetCustomAttributes(DebuggableAttribute::typeid, false);

Console::WriteLine(debuggableAttributes->Length > 0); 
```

（在调试模式下编译时，编译器会向程序集添加 DebuggableAttribute）

# c# - 使用哪个通用集合？

> ID：611930
> 
> 赞同：2
> 
> 时间：2009-03-04T18:50:05.090
> 
> 标签：c#, .net, asp.net, generics, collections

我有 2 个单独的课程：

*   区域属性
*   字段属性

1 个 AreaProperties 可以映射到 1 个 FieldProperties。在不改变设计的情况下，我想要一个方法来返回`List<>`这些对象中的一个

C# 中的什么通用集合是合适的？

我知道我可以发送 2 个列表，函数如下所示：

```
public List<AreaProperties> Save(ref List<FieldProperties>)
{
    ..code
} 
```

**编辑： Dror Helper 的解决方案听起来不错。但是，我最近发现FieldProperties和AreaProperties之间没有1：1的关系。我现在将如何处理这个问题。我仍然想使用具有 FieldProperties 和 AreaProperties 对象的自定义类，但我将如何处理 1 到多个场景？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-04T19:02:04.767

您可以创建一个具有两个成员的类/结构 - AreaProperties 和 FieldProperties 并返回该类的列表

```
class Pair<T1, T2>
{
     T1 t1;
     T2 t2;
}

List<Pair<AreaProperties, FieldProperties>> Save(){ ...} 
```

或者使用 System.Collections.Generic.KeyValuePair 代替（根据下面的帕特里克建议）

```
List<KeyValuePair<AreaProperties, FieldProperties>> Save(){ ... } 
```

这样，您也可以保持 1..1 关系。

**编辑：** 如果你需要 1..n 关系，我认为你想返回 List>> ，这样你就有一个返回的每个 AreaProperties 的字段属性列表，并且你仍然保持它们之间的关系。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T19:05:26.677

你可以返回一个`List<KeyValuePair<AreaProperties, FieldProperties>>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T19:02:35.357

你可以使用泛型[`Dictionary<FieldProperties, AreaPropeties>`](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)吗？您将不得不编写自己的[`Comparer<FieldPropeties>`](http://msdn.microsoft.com/en-us/library/cfttsh47.aspx)和[`KeyValuePair<FieldProperties, AreaProperties>`](http://msdn.microsoft.com/en-us/library/5tbh8a42.aspx).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T19:14:20.057

如果需要强制执行 1:1 关系，我建议使用[Dror 提到](https://stackoverflow.com/questions/611930/which-generic-collection-to-use/611970#611970)的结构方法。如果没有强制执行 1:1 关系，我会考虑使用 out 参数修饰符。

```
void foo()
{
  List<AreaProperties> listArea;
  List<FieldProperties> listField;
}

void Bar(out List<AreaProperties> listArea, out List<FieldProperties> listField)
{
  listArea = new List<AreaProperties>();
  listField = new List<FieldProperties>();

} 
```

# ruby-on-rails - render :json 不接受选项

> ID：611931
> 
> 赞同：27
> 
> 时间：2009-03-04T18:50:07.493
> 
> 标签：ruby-on-rails, json, api

我很想使用`render :json`，但它似乎没有那么灵活。这样做的正确方法是什么？

```
respond_to do |format|
  format.html # index.html.erb
  format.xml  { render :xml => @things }

  #This is great
  format.json { render :text => @things.to_json(:include => :photos) }

  #This doesn't include photos
  format.json { render :json => @things, :include => :photos }
end 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-04T21:19:30.053

我做过类似的事情`render :json`。这对我有用：

```
respond_to do |format|
    format.html # index.html.erb
    format.json  { render :json => @things.to_json(:include => { :photos => { :only => [:id, :url] } }) }
end 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2011-04-12T16:01:39.257

我想这篇文章可能对你有用[——Rails to_json 或 as_json？](http://jonathanjulian.com/2010/04/rails-to_json-or-as_json/)通过乔纳森朱利安。

主要的想法是你应该避免在控制器中使用 to_json。在模型中定义 as_json 方法要灵活得多。

例如：

在您的事物模型中

```
def as_json(options={})
  super(:include => :photos)
end 
```

然后你可以在你的控制器中写

```
render :json => @things 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-12-29T21:54:16.143

在你的控制器中管理复杂的哈希会很快变得丑陋。

在 Rails 3 中，您可以使用 ActiveModel::Serializer。请参阅[http://api.rubyonrails.org/classes/ActiveModel/Serialization.html](http://api.rubyonrails.org/classes/ActiveModel/Serialization.html)

如果您正在做任何重要的事情，请参阅 [https://github.com/rails-api/active_model_serializers](https://github.com/rails-api/active_model_serializers)。我建议创建单独的序列化程序类以避免混淆模型并使测试更容易。

```
class ThingSerializer < ActiveModel::Serializer
  has_many :photos
  attributes :name, :whatever
end

# ThingsController
def index
  render :json => @things
end

# test it out
thing = Thing.new :name => "bob"
ThingSerializer.new(thing, nil).to_json 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-22T08:12:25.927

```
format.json { render @things.to_json(:include => :photos) } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-01T09:28:38.873

如果是数组，我所做的是

```
respond_to do |format|
  format.html
  format.json {render :json => {:medias => @medias.to_json, :total => 13000, :time => 0.0001 }}
end 
```

# javascript - IE 未提交动态添加的表单元素

> ID：611932
> 
> 赞同：9
> 
> 时间：2009-03-04T18:50:14.687
> 
> 标签：javascript, internet-explorer, webforms, dhtml

我编写了一些 JavaScript 来允许编辑 HTML 表单中的项目列表，包括添加和删除项目。让它在 Firefox 中工作。在 Internet Explorer 中尝试时，我发现任何添加的项目都没有与表单一起提交。

长话短说...大量的简化、调试，找出了触发 IE 忽略新表单输入的行。这样行为问题就解决了。

但现在我必须问：为什么？这是一个IE错误吗？

这是简化的代码：

```
<html>
<head>
    <title>Test</title>
    <script type="text/javascript">
        function add() {
            div = document.getElementById("mylist");

            // *** Adding text here works perfectly fine. ***
            div.innerHTML += " ";

            e = document.createElement("input");
            e.setAttribute("type", "text");
            e.setAttribute("name", "field3");
            e.setAttribute("value", "--NEWVALUE--");
            div.appendChild(e);

            // *** Adding text here works perfectly fine in Firefox, but for
            //     Internet Explorer it causes field3 to not be submitted. ***
            //div.innerHTML += " ";
        }
    </script>
</head>
<body>
    <form action="" method="get">
        <div id="mylist">
            <input type="text" name="field1" value="value1" />
            <input type="text" name="field2" value="value2" />
        </div>
        <a href="javascript:" onclick="add()" />Add</a>
        <input type="submit" value="Submit" />
    </form>
</body>
</html> 
```

要尝试一下，做显而易见的事情：在 IE 中加载，单击添加，单击提交，查看地址栏中的内容。如果你取消最后一行的注释`add()`，IE 会突然停止报告`field3`。无论哪种方式，它在 Firefox 中都可以正常工作。

有任何想法吗？好奇的心想知道。（如果需要，我将如何以便携的方式在其中添加文本，让 IE 很高兴？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T19:36:13.670

> 这是一个IE错误吗？

似乎如此。当您通过 DOM 方法创建 <input> 元素时，IE 并没有完全拾取 'name' 属性。元素确实提交了，但如果您尝试获取元素的“innerHTML”表示，它就会神秘地消失。如果您通过直接写入innerHTML 创建元素，则不会发生这种情况。

此外，如果您使用 DOM 级别 0 表单导航方法，例如“myform.elements.x.value”，则通过“元素”数组访问可能不起作用（类似于某些人错误使用的直接“myform.x”访问）。无论如何，这些天您可能更喜欢 getElementById()。

所以*要么*使用innerHTML *，要么*使用DOM方法；创建表单域时最好不要混合它们。

这已[记录在案（请参阅“备注”）](http://msdn.microsoft.com/en-us/library/ms534184(VS.85).aspx)并最终在 IE8 中修复。

在任何情况下，永远不要这样做：

> div.innerHTML+= '...';

这只是语法糖：

> div.innerHTML= div.innerHTML+'...';

换句话说，它必须序列化元素的整个子 HTML 内容，然后进行字符串连接，然后将新字符串重新解析回元素，丢弃所有原始内容。这意味着您将丢失任何无法序列化的内容：以及 IE 的虚假半创建“名称”属性，这也意味着您附加到每个子元素的任何 JavaScript 事件处理程序、DOM 侦听器或其他自定义属性。此外，不必要的序列化/解析周期很慢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T19:02:59.787

IE 对在运行时更改一些内置属性非常挑剔。例如，输入元素的名称在设置时不能更改。

如果我是你，我会尝试两件事：

1.  `setAttribute()`尝试显式设置和属性`name`，而不是使用：`type``value`

    `e.name = "text";`

2.  如果这不起作用，您可能必须在`document.createElement()`调用中包含所有这些属性：

    `var e = document.createElement("<input type='text' name='field'>");`

    这实际上可能会在某些浏览器中引发异常。所以最好的跨浏览器方法是：

.

```
var e;
  try {
    e = document.createElement("<input type='text' name='field'>");
  } catch (ex) {
    e = document.createElement("input");
    e.type = 'text';
    e.name = 'field';
  }
  e.value = 'value'; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-04T20:26:41.117

谢谢 bobince 和 levik 的回答。使用这些以及更多的实验，这是我的结论：

1.  是的，这是一个 IE 错误。

2.  IE 8 根据[微软](http://msdn.microsoft.com/en-us/library/ms534184%28VS.85%29.aspx)的说法修复了该错误：“Internet Explorer 8 及更高版本可以在运行时对使用 createElement 方法动态创建的元素设置 NAME 属性。”

3.  `e.setAttribute("name", "field3")`错误是这样的：仅调用*kind-of 会*设置名称。如果元素没有发生任何其他事情，它将起作用，但如果请求序列化，则不会序列化名称。所以当我说`innerHTML += " "`强制序列化时，它失去了名字，所以它在反序列化时没有恢复。没有名字，没有包含在表单提交中。

4.  解决方法 #1：`e = document.createElement("<input name='field3' />")`即使在面临序列化时也可以。

5.  解决方法 #2：我可以附加一个像这样的文本元素，而不是使用 innerHTML += 添加文本`div.appendChild(document.createTextNode(" "));`：我认为必须有更好的添加文本的方法，现在我知道了:-)。

干杯，
--jsf

# winapi - 在 CDialog 中显示尺寸夹点？

> ID：611933
> 
> 赞同：3
> 
> 时间：2009-03-04T18:50:20.660
> 
> 标签：winapi, mfc, resize

我已经看到了处理这个东西的绘制的代码`DFCS_SCROLLSIZEGRIP`（对？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T19:08:54.110

代替更好的答案，我将发布我拥有的代码，用于绘制尺寸握把并处理命中测试。您还需要在 OnSize 期间使适当的区域无效，以便重新绘制它。

```
BOOL CMyDialog::OnEraseBkgnd(CDC* pDC)
{
    if (CDialog::OnEraseBkgnd(pDC))
    {
        // draw size grip
        CRect r;
        GetClientRect(&r);
        int size = GetSystemMetrics(SM_CXVSCROLL);
        r.left = r.right - size;
        r.top = r.bottom - size;
        pDC->DrawFrameControl(&r, DFC_SCROLL, DFCS_SCROLLSIZEGRIP);
        return TRUE;
    }
    else
    {
        return FALSE;
    }
} 
```

-

```
LRESULT CMyDialog::OnNcHitTest(CPoint point)
{
    // return HTBOTTOMRIGHT for sizegrip area
    CRect r;
    GetClientRect(&r);
    int size = GetSystemMetrics(SM_CXVSCROLL);
    r.left = r.right - size;
    r.top = r.bottom - size;
    ScreenToClient(&point);

    if (r.PtInRect(point))
    {
        return HTBOTTOMRIGHT;
    }
    else
        return CDialog::OnNcHitTest(point);
} 
```

来源：[http ://www.tech-archive.net/Archive/Development/microsoft.public.win32.programmer.ui/2006-01/msg00103.html](http://www.tech-archive.net/Archive/Development/microsoft.public.win32.programmer.ui/2006-01/msg00103.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-06T23:52:06.703

除了上面提到的 OnEraseBkgnd 和 OnNcHitTest 之外，还需要在窗口变大时使抓握区域无效，否则放大时会留下痕迹：

```
void CMyDialog::OnSize(UINT nType, INT cx, INT cy)
{

    CRect  rc;
    int    iSize=GetSystemMetrics(SM_CXVSCROLL);

    GetClientRect(rc);
    InvalidateRect(CRect(rc.left-iSize, rc.bottom-iSize, rc.right, rc.bottom), FALSE);
    CDialog::OnSize(nType, cx, cy);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T15:55:13.297

我认为没有默认样式可以免费获得此功能。您必须使用类名`Scrollbar`和控件样式[SBS_SIZEGRIP创建一个新的子窗口](http://msdn.microsoft.com/en-us/library/bb787533(VS.85).aspx)

# embedded - 我可以在不重置电路板的情况下重置 Microchip 的 TCP/IP 堆栈吗？

> ID：611935
> 
> 赞同：2
> 
> 时间：2009-03-04T18:50:58.850
> 
> 标签：embedded, microchip

我在 8 位微控制器上使用 Microchip 的免费 TCP/IP（4.55 版）堆栈。

我正在尝试在不使用 asm("RESET") 进行全板重置的情况下重置堆栈。

关于如何重新启动此堆栈的任何想法。

**更新**

我通过以下步骤重置堆栈

1.  将复位引脚切换到 Microchip 以太网芯片上
2.  调用 StackInit();
3.  手动重置 UDP 通告状态机

这似乎从我遇到的致命 SPI 错误中恢复过来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T18:30:12.483

调用 StackInit()。该函数重新初始化所有子模块（TCP、UDP、SMTP 等）。它还会破坏您打开的所有 TCP 和 UDP 套接字，因此您必须重新打开要使用的套接字。

附带说明：我关注了 Microchip 论坛上的主题。我的 TCP 堆栈中也出现了奇怪的重置。它最终成为堆栈溢出。将一些变量放在堆栈的顶部。

```
#pragma udata stackoverflow = 0xE00
UInt32 StackUpperBound[8];
#pragma udata 
```

在 main() 的开头初始化这些变量，并在开头放置一个断点。查看这些变量是否被覆盖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T20:17:07.877

我对 Microchip 堆栈完全不熟悉，但除非堆栈被设计为重新启动，否则我怀疑你会成功。

如果所有缓冲区和结构都是静态分配的，那么理论上，您可以调用初始化例程来“重新启动”堆栈（假设它对结构进行了重新初始化）。

如果它使用动态缓冲区（malloc），那么我相信你会不走运。

# sql - MS access query using many tables

> ID：611941
> 
> 赞同：3
> 
> 时间：2009-03-04T18:52:39.343
> 
> 标签：sql, ms-access

I have a database with 12 tables with pension details of employees for Jan-Dec 2008\. I want to get the total pension for 12 months for each employee adding up amounts from all the 12 tables (jan through dec).

How should I write the query?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-04T19:24:18.987

您可能需要重新考虑这种设计，而是使用一个包含一列来指示 MONTH 和 YEAR 的表。

鉴于您当前的设计，您的查询将需要如下所示（显然，替换您自己的表和字段名称）：

首先，创建此查询并将其保存为“每月总计”：

```
SELECT EmployeeId AS EmployeeNumber, SUM(Pension_Amount) AS Pension_Totals
FROM Pension_January
GROUP BY EmployeeId
UNION ALL
SELECT EmployeeId, SUM(Pension_Amount)
FROM Pension_February
GROUP BY EmployeeId
UNION ALL
.....Other months.....
UNION ALL
SELECT EmployeeId, SUM(Pension_Amount)
FROM Pension_December
GROUP BY EmployeeId; 
```

其次，创建另一个引用第一个查询：

```
SELECT
  [Monthly Totals].EmployeeNumber,
  SUM([Monthly Totals].Pension_Totals) AS Employee_Total
FROM [Monthly Totals]
GROUP BY [Monthly Totals].EmployeeNumber; 
```

现在保存第二个查询并运行它。它应该给你你需要的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T19:11:00.050

为什么你有 12 张不同的桌子？这是一个根本上糟糕的设计。

反正...

```
Select
  EmployeeID, Total2008 = Sum(Value)
From
  (Select EmployeeID, Value From JanuaryTable
  Union All
  Select EmployeeID, Value From FebruaryTable
  ...
  Select EmployeeID, Value From DecemberTable)
Group By
  EmployeeID 
```

# .net - What does .NET developers need to know about these certain topics?

> ID：611957
> 
> 赞同：1
> 
> 时间：2009-03-04T18:57:02.377
> 
> 标签：.net

I would like the SO community let me know what does juniors and proficient .NET Developers should know regarding the following subjects, also some code examples or brainteasers like the ones [here](http://www.yoda.arachsys.com/csharp/teasers.html) will help a lot.

*   System Types

*   Collection and Generics

*   Configuration and Installation

*   Monitoring and Debugging

*   File I/O

*   Globalization

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T19:17:18.067

另一个用于仿制药。

要求传递的泛型类型是实现特定接口的类型的正确语法（VB 或 C#）是什么？

接口要求为 IHydratable 的 C# 示例

```
public static T HydrateObject<T>(IDataReader reader) where T : IHydratable 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T19:16:21.207

> 文件输入/输出

你怎么：

*   读取文件的内容
*   什么是文件编码...例如 UTF-8。.Net 在内部使用哪种编码？[不希望有大量细节，但应该知道并非所有内容都是 ASCII]
*   为什么以下代码会因 FileNotFoundException 而失败：

    ```
    if (File.Exists(name)) {
      var content = File.ReadAllText(name);
    } 
    ```

> 全球化

*   什么是全球化？
*   全球化应用程序没有什么。[应该知道不要硬编码用户显示文本、日期/时间/数字/...格式]

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T19:05:13.200

Let me start you off.

Generics:

What is the difference between an `ArrayList` and a `List<T>`? (Boxing/unboxing should come up here).

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-04T19:24:41.203

在我的头上，对于初级开发人员：

*   方法覆盖和重载之间的区别
*   命名空间、类、程序集之间的区别
*   值和引用类型的差异
*   解释拳击以及如何避免它

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T19:28:53.320

以下代码有什么问题

```
struct MyStruct
{

   int _a;
   int _b;

   public MyStruct()
   {

   }

public MyStruct(int a,int b)
   {
        _a = a;
        _b = b;
   } 

} 
```

# reporting-services - Dynamic merging of cells in SSRS

> ID：611962
> 
> 赞同：1
> 
> 时间：2009-03-04T18:59:07.410
> 
> 标签：reporting-services, merge, conditional, dynamic, cells

In an SSRS Report ,I have a table which has 14 columns, 1st column is 7am and the last column is 7pm. I have 100 records with conference names and the timings,

ex:

1.  international conference 9am to 5pm
2.  national conference 8 am to 11 am

so the problem is these column cells must merge based on the timings and display as one textbox with center aligning the text

ex: national conference the columns from 8 to 11 am are to be merged and the time 8 to 11am must display in these merged cells with center align.

Can anyone give me any suggestion for this issue, i thought to write custom code for this but i did not get any idea.

So, If anyone can help me i will be very grateful.

(Can we merge the cells dynamically based on the condition in SSRS)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T20:04:29.333

我会复制这一行，所以会有一行包含合并的单元格，第二行是单独的。然后应将第一行的隐藏属性设置为

```
 = (Fields!ConferenceName = "interenational") 
```

对于第二行

```
 = (Fields!ConferenceName = "national") 
```

# python - 编译的字节码文件（.pyc）可以在不同的目录中生成吗？

> ID：611967
> 
> 赞同：16
> 
> 时间：2009-03-04T19:01:40.087
> 
> 标签：python, bytecode

> **可能重复：**
> [如何在单独的文件夹中编译 python 文件？](https://stackoverflow.com/questions/471928/way-to-have-compiled-python-files-in-a-separate-folder)

当 python 将模块编译为字节码时，它会从你的 .py 文件生成 .pyc 文件。

我的问题是，是否可以将这些 .pyc 文件写入与模块所在的目录不同的目录？

例如，我有一个很大的模块目录。我不想让它到处都是 .pyc 文件，我想将我的源代码保留在目录中，并有一个像“字节码”这样的子目录，所有 .pyc 都存储在其中。

这可能吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-04T19:10:29.630

[这在“如何在单独的文件夹中编译 python 文件？](https://stackoverflow.com/questions/471928/way-to-have-compiled-python-files-in-a-seperate-folder) ”中回答了这个问题。

简短的回答：**不**——除非你运行的是 Python 3.2 或更高版本——见[这里](https://stackoverflow.com/a/16476434/66851)。

澄清一下：在 3.2 之前，您*可以*按照 Brian R. Bondy 的建议编译字节码并将其放在其他地方，但除非您实际上从那里运行它（而不是从您想要保持原始状态的文件夹中）Python 仍将输出字节码，其中 . py 文件是。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-04T19:09:30.490

检查[py_compile 模块](http://docs.python.org/library/py_compile.html#module-py_compile)，特别是：

```
py_compile.compile(file[, cfile[, dfile[, doraise]]]) 
```

cfile 是您感兴趣的参数。

从上面的链接：

> ...字节码写入cfile，默认为file + 'c' ...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-24T12:05:07.067

我自己也在寻找这个问题的答案，但找不到太多。但是，您可以将文件夹名称添加到新编译的文件名前（需要先确保文件夹存在）

这是一些对我有用的代码：

```
import py_compile
import os
import glob
import shutil

path = ''
for infile in glob.glob( os.path.join(path, '*.py') ):
    print "current file is: " + infile
    strDestination = 'compiled/' + infile + 'c'
    py_compile.compile(infile,strDestination) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-04T19:46:22.867

如果“乱扔垃圾”确实是您的问题，您可以随时将 .zip 文件和/或文件打包`.py`并将`.pyc`其`.pyo`附加到您的 .zip 文件中`sys.path`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T19:08:36.327

我似乎记得在某处读到这是不可能的，Python People 有理由不让它成为可能，尽管我不记得在哪里。

*编辑*：对不起，我误读了这个问题——我的意思是（我认为）不可能将 Python 可执行文件配置为默认将其字节码文件放在不同的目录中。您总是可以编写一个小的 Python 编译器脚本（或者找到一个，我相信它们就在那里），它将字节码文件放在您选择的位置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T19:09:56.213

您可以编写一个脚本来编译它们，然后移动它们。就像是：

```
for i in `ls *.pyc`
do
 mv $i $DEST_DIR
done 
```

（可以缩短为：

```
for i in *.pyc
do
    mv $i $DEST_DIR
done 
```

或者，令人惊讶的是，

```
mv *.pyc $DEST_DIR 
```

)

# javascript - 在javascript中获取特定DOM元素组的内容列表的最佳方法是什么？

> ID：611978
> 
> 赞同：0
> 
> 时间：2009-03-04T19:05:13.277
> 
> 标签：javascript, html, dom

基本场景：我在 HTML 页面上有一系列动态生成的元素。（目前，它们都是`divs`，但它们不需要是。）

我想要的是一个 javascript 函数，它将遍历所有那些`divs`（或其他）寻找特定值的存在。

最好、最跨浏览器的方法是什么？getElementsByName() 是否适用`divs` 于所有浏览器？我可以给他们所有相同的 ID 并以某种方式从 getElementById 中获取一个数组吗？

如果我将它们更改`divs`为`spans`or `inputs`，这会让事情变得更容易吗？

谢谢！

（编辑：对于这个项目，如果有一个不使用任何外部 js 库的解决方案，那将是最好的。我假设 jQuery 有一个函数可以在一行中执行此操作，但目前我想避免打开它一罐蠕虫与客户端。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T19:10:58.130

`getElementsByTagName`是在 DOM Core 中定义的，所以任何实现它的浏览器都可以。这就是当前使用的所有浏览器。

看看这里的细节：[http ://www.quirksmode.org/dom/w3c_core.html](http://www.quirksmode.org/dom/w3c_core.html)

需要注意的一个问题是，它`getElementsByTagName`返回一个`NodeList`- 而不是一个数组。它的工作原理相同，但它的评估很晚，所以如果你在遍历 a 时向 DOM 添加/删除节点`NodeList`，你会得到奇怪的结果。在这些情况下，编写两个循环；首先循环遍历`NodeList`并将所有条目存储在数组中 - 然后循环遍历数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T19:13:01.027

元素是什么并不重要，重要的是它们在页面中的位置。如果它们都是单个父元素的子元素，那么您的问题很简单。给父元素一个 ID，您可以使用`getElementById()`它来抓取它并迭代它的子元素。

`getElementById()`当在文档中找到多个 ID 实例时，行为未定义。大多数会返回他们能找到的第一个元素，但你当然不能指望得到一个数组。

`getElementsByTagName()`仅当您可以使用一些您确定不会出现在页面其他位置的晦涩标签时才会起作用。您可以通过指定您感兴趣的元素将具有您可以检查的属性（例如@class 或@title）来扩充它。然后，您可以遍历`getElementsByTagName()`检查结果并仅查看存在该属性的元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T19:16:20.160

您可以使用[此](http://jacksleight.com/blog/2008/01/14/getelementsby/)站点查看 getElementBy 最适合您的需求。
有一些使用库和一些像**troelskn**写的在所有支持的浏览器中应用标准 javascript。

# perl - 如何记录在 Perl 中就地编辑期间所做的更改？

> ID：611981
> 
> 赞同：2
> 
> 时间：2009-03-04T19:05:40.670
> 
> 标签：perl, file, replace, find, logging

我编写了一个简单的 ksh 脚本，它调用 Perl 程序来查找和替换文件。传入的 arg 是主目录：

```
 perl -pi -e 's/find/replace/g' $1/*.html 
```

它工作得很好。但是，我想将所有更改输出到日志文件。我已经尝试过管道和重定向，但无法让它工作。有任何想法吗？

谢谢，格伦

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-04T19:23:28.083

像这样将所有更改发送到 STDERR：

```
perl -pi -e '$old = $_; s/find/replace/g and warn "${ARGV}[$.]: $old $_"; close ARGV if eof' $1/*.html 
```

更新：固定美元。在多个文件上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T19:50:27.647

您可以打印到 STDERR 并将 STDERR 输出重定向到文件，如下所示：

```
perl -pi -e 'chomp($prev=$_);s/find/replace/g and print STDERR "$ARGV - $.: $prev -> $_"; close ARGV if eof' $1/*.html 2> logfile.txt 
```

*编辑：添加了文件名，并在使用多个输入文件时固定显示行号*

# java - 无法安装我的 NetBeans 插件

> ID：611990
> 
> 赞同：0
> 
> 时间：2009-03-04T19:08:30.523
> 
> 标签：java, netbeans, netbeans-plugins

尝试创建一个 NetBeans 插件，但由于安装模块的过程失败，我进展甚微。我正在做的是右键单击并选择“在开发 IDE 中安装/重新加载”选项，它失败并出现以下异常：

```
Enabling StandardModule:org.willcodejavaforfood.com jarFile: /Users/Erik/NetBeansProjects/module2/build/cluster/modules/org-willcodejavaforfood-com.jar...
java.io.IOException: Cannot enable StandardModule:org.willcodejavaforfood jarFile: /Users/Erik/NetBeansProjects/module2/build/cluster/modules/org-willcodejavaforfood.jar; problems: [Java > 1.6]
        at org.netbeans.core.startup.ModuleSystem.deployTestModule(ModuleSystem.java:358)
        at org.netbeans.core.startup.TestModuleDeployer.deployTestModule(TestModuleDeployer.java:68)
        at org.netbeans.modules.apisupport.ant.InstallModuleTask.execute(InstallModuleTask.java:77)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)
        at sun.reflect.GeneratedMethodAccessor176.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.Target.execute(Target.java:357)
        at org.apache.tools.ant.Target.performTasks(Target.java:385)
        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1337)
        at org.apache.tools.ant.Project.executeTarget(Project.java:1306)
        at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
        at org.apache.tools.ant.Project.executeTargets(Project.java:1189)
        at org.apache.tools.ant.module.bridge.impl.BridgeImpl.run(BridgeImpl.java:273)
        at org.apache.tools.ant.module.run.TargetExecutor.run(TargetExecutor.java:499)
        at org.netbeans.core.execution.RunClassThread.run(RunClassThread.java:151) 
```

在 Mac OS X 10.5.6 上使用 NetBeans 6.5 并运行 Java 1.6

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T12:36:11.847

显然这是 Mac OS X 的 NetBeans 问题......

[来自netbeans论坛的回答](http://forums.netbeans.org/viewtopic.php?p=26822#26822)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T19:21:55.063

如果您创建一个新的 NetBeans 模块项目并简单地运行它，它会起作用吗？（试图缩小问题的范围，并消除除绝对基础之外的任何内容是一个不错的起点）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-29T01:12:41.643

看起来您的目标平台设置为 JDK 5，但您的模块是针对 JDK 6 构建的。**`******