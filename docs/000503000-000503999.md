# StackOverflow 问答 000503000-000503999

# apache-flex - 如何将电子邮件从 Outlook 拖入 Adob e AIR 应用程序

> ID：503000
> 
> 赞同：2
> 
> 时间：2009-02-02T12:13:26.560
> 
> 标签：apache-flex, drag-and-drop, air

这是一个关于 Adob​​e AIR 和 MS Outlook 的问题。

我想将电子邮件从 Outlook 拖到 AIR 应用程序中。我希望将以下数据传输到 AIR 应用程序中：

*   Outlook 中邮件的唯一 ID，用于创建到 Outlook 的链接
*   邮件的富文本
*   有关邮件的一些信息，例如发件人、收件人、日期等。

一些 Windows 应用程序会这样做，例如[My Life Organized](http://www.mylifeorganized.net/)或[Linker](http://www.teamscope.com/otherpro/utilities.asp)。这对 AIR 有任何可能吗？我很确定我不仅需要 AIR 应用程序，还需要一些 Windows 应用程序或 Outlook 插件来实现这一点。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-02T17:02:33.777

*   基本上，您在将接收拖放的 UI 元素上收听[NativeDragEvent .NATIVE_DRAG_ENTER、NATIVE_DRAG_DROP 和 NATIVE_DRAG_EXIT。](http://livedocs.adobe.com/flex/3/langref/flash/events/NativeDragEvent.html)
*   所有这三个事件都是通过 NativeDragEvent 引发的，您可以通过它通过 event.clipboard 访问各种格式的数据。[getData() ，传入](http://livedocs.adobe.com/flex/3/langref/flash/desktop/Clipboard.html#getData())[ClipboardFormats](http://livedocs.adobe.com/flex/3/langref/flash/desktop/ClipboardFormats.html)指定的格式（例如 ClipboardFormats.FILE_LIST_FORMAT）
*   在 NATIVE_DRAG_ENTER 中，您可以通过 NativeDragManager 上的静态方法接受/拒绝拖动操作

您需要的类都在[flash.desktop](http://livedocs.adobe.com/flex/3/langref/flash/desktop/package-detail.html)包中。只需尝试各种剪贴板格式，直到您看到所需的数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-05T14:00:44.853

不，无法从 Outlook 电子邮件中拖放附件文件

@Stefan：AIR 不允许将电子邮件从 Outlook 拖到 AIR 应用程序中。相反，您会收到一个字符串，其中包含一些邮件信息，例如主题、大小、收件人……没有内容，没有附件。很遗憾...请随时纠正我，但是我已经搜索了一段时间的解决方案，但没有找到解决方案....问候 Steelheart

# java - 有人可以向我解释这个 JDBC 异常吗？

> ID：503003
> 
> 赞同：2
> 
> 时间：2009-02-02T12:14:07.197
> 
> 标签：java, oracle, exception, jdbc

使用 JDBC 向 Oracle 数据库执行插入时出现以下异常。

```
java.sql.SQLRecoverableException: Io exception: Unexpected packet 
```

什么可能导致这种情况，我该如何从中恢复？

我正在编写的应用程序会快速连续地对数据库进行大量更新。从例外情况来看，我认为这是一个网络问题，但是数据库与我的应用程序在同一个盒子上。

我没有堆栈跟踪，这是那些令人讨厌的“在我的机器上工作”问题之一，当我将它放在客户端站点上时它会出现问题。

不幸的是，我必须拼凑一些可以解决此问题/诊断的东西，但是当我不在办公室时，客户端站点仅在下午 5 点到晚上 9 点之间将数据发送到我的应用程序...

我有几个小时来解决我的意外情况......

有什么想法吗。

**问题解决了：**

这是一个同步问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T12:20:41.130

您是否有任何机会使用多个线程并忘记了同步？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T12:38:10.643

听起来像是驱动程序问题，您使用的服务器版本是否有更新的驱动程序？此外，请确保您的类路径中没有旧版本的 ojdbc jar。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T20:49:01.010

一批插入多少个？

在某些情况下，建议在事务中设置提交阈值。如果你在做交易，你应该注意这一点。

顺便说一句，任何堆栈跟踪？

# makefile - 如何获得 Solaris 10 的“make”

> ID：503008
> 
> 赞同：0
> 
> 时间：2009-02-02T12:15:11.237
> 
> 标签：makefile, solaris

我当前的项目涉及在 Solaris VMWare 设备（托管在 Mac 上）中编写 Perl 代码。

为了使用 CPAN，我需要在 VM 中安装一个“make”版本。

这样做最节俭的方法是什么（磁盘空间和下载容量有限）？

* * *

**编辑：**原来我有一个 Solaris 10，毕竟。
         Timo Geusch 的回答仍然有效。事后我会报告我是否以及如何让它工作。谢谢蒂莫

* * *

**编辑：** 这是我下载和安装make的方式：

1.  从 sunfreeware.com下载[make-3.81-sol10-x86-local.gz](ftp://ftp.sunfreeware.com/pub/freeware/intel/10/make-3.81-sol10-x86-local.gz)和[libgcc-3.4.6-sol10-x86-](ftp://ftp.sunfreeware.com/pub/freeware/intel/10/libgcc-3.4.6-sol10-x86-local.gz) local.gz。
2.  使用安全副本将它们从 OSX 传输到 Solaris VM。
3.  以 root 身份登录 vm，cd 到 /tmp
4.  gunzip 两个文件
5.  pkgadd -d 两个提取的文件，回答了提示..
6.  **完毕**

再次感谢蒂莫。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-02T12:34:23.350

sunfreeware站点有一个用于 Solaris 9 的 GNU Make 3.81 的[预](http://www.sunfreeware.com/)构建版本 - 这可能是您最好的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-04T07:07:26.533

如果您至少安装了“开发人员”级别的安装选项/软件包集群，请在 /usr/ccs/bin 中检查 Solaris 包含的 make。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-13T09:18:34.603

请注意，/usr/ccs/bin/make 不是 gnumake。makefile 的语法基本相同，但是 gnumake 具有程序确实使用的扩展。

通过一些小的编辑，您可能可以从 /usr/ccs/bin/make 开始构建 gnumake。

# wpf - WPF DataGrid 已填充，除非我使用 LINQ 过滤其项目

> ID：503014
> 
> 赞同：0
> 
> 时间：2009-02-02T12:18:41.120
> 
> 标签：wpf, linq, data-binding, datagrid, filtering

我有一个简单的 WPFToolkit `DataGrid`：

```
<Grid>
    <dg:DataGrid Name="theDataGrid"/>
</Grid> 
```

在一个简单`Contact`类后面的代码中：

```
public class Contact
{
    public string FirstName { get; set; }
    public string LastName { get; set; }

    public Contact(string firstName, string lastName)
    {
        this.FirstName = firstName;
        this.LastName = lastName;
    }
} 
```

在后面代码的主构造函数中，我构建了一个`List`集合并将其绑定到我的`DataGrid`：

```
List<Contact> contacts = new List<Contact>();
contacts.Add(new Contact("John", "Tester"));
contacts.Add(new Contact("Jill", "Tester"));
contacts.Add(new Contact("Joe", "Tester"));
contacts.Add(new Contact("Jimmy", "Nontester"));
theDataGrid.ItemsSource = contacts; 
```

这很好用，但是如果我像这样使用 LINQ 过滤这些联系人：

```
List<Contact> contacts = new List<Contact>();
contacts.Add(new Contact("John", "Tester"));
contacts.Add(new Contact("Jill", "Tester"));
contacts.Add(new Contact("Joe", "Tester"));
contacts.Add(new Contact("Jimmy", "Nontester"));

var filteredContacts = contacts.Where(contact => contact.LastName.StartsWith("T"));
theDataGrid.ItemsSource = filteredContacts; 
```

然后我`DataGrid`的被填充了，但这些字段都是空的（！）。例如，在上面的例子中，我`DataGrid`的三行都是空的。奇怪的是调试的时候，`filteredContacts`包含了四个项目。

如何使用 LINQ 过滤我的自定义对象并让它们显示在我的`DataGrid`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T12:29:44.920

我会尝试两件事：

1.  改变

    ```
    theDataGrid.ItemsSource = filteredContacts; 
    ```

    到

    ```
    theDataGrid.ItemsSource = filteredContacts.ToList(); 
    ```

2.  第二种是使用视图并在视图上过滤。

    ```
    ListCollectionView view = (ListCollectionView)CollectionViewSource.GetDefaultView(contacts);

    view.Filter = delegate(object item) { return (item as Contact).LastName.StartsWith("T"); };

    theDataGrid.ItemsSource = view; 
    ```

# javascript - 如何禁用 JavaScript 错误消息？

> ID：503026
> 
> 赞同：2
> 
> 时间：2009-02-02T12:21:19.303
> 
> 标签：javascript, internet-explorer, error-handling

我知道这是一个微不足道的问题，但是如何禁用烦人的 JavaScript 错误消息？

我正在将数据插入到一个未完成的 Web 应用程序中，并且每次提交的表单都会出现大约 30 个错误。这让我疯狂。

我正在使用 IE7。

请注意，我已经尝试过“Internet 选项 - 高级 - 浏览”，禁用 IE 和其他脚本调试，并取消选中“为每个脚本错误显示通知”。我得到的只是一条不同的错误消息，但我仍然需要关闭很多警报消息。

我想我要疯了。

编辑：图片前后（省略网址以保护无辜者）： ![替代文字](https://i.stack.imgur.com/SwytR.jpg)

我无权访问代码，我只是插入数据，应用程序仍在构建中，JavaScript 是从代码隐藏生成的。我绝对无法消除此错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-02T12:30:08.413

如果你想在代码中关闭它们，你可以这样做：

```
window.onerror = null; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T14:28:01.687

似乎您没有“足够的存储空间”。也许您可以尝试增加缓存大小。这只是在黑暗中拍摄，但值得一试......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T18:14:34.847

如果您不想隐藏所有其他错误，请将对代码的调用包装在 try/catch 中。

```
try {
    callDodgyCode();
}
catch(e) {
    // Eat error
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T18:25:48.977

经过一些谷歌搜索后，如果您的用户代理字符串太长，您可能会得到这个。见[这里](http://blogs.msdn.com/scicoria/archive/2009/01/15/adding-web-parts-via-ie-7-and-the-not-enough-storage-is-available-to-complete-this-operation-javascript-error-message.aspx)和[这里](http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/d863c31c-8a50-4e9d-9482-ec479d330658/)。我不相信这会解决它，但它可能值得一试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T12:24:21.717

听起来您的设置正确。您确定这些实际上不是代码中的警报吗？

# c++ - 在 AFX 中使用什么函数对这些密码进行编码？

> ID：503030
> 
> 赞同：1
> 
> 时间：2009-02-02T12:23:23.200
> 
> 标签：c++, encoding, afx

我正在尝试找出无法找到源的 LOGIN DLL 使用的密码文件的格式。管理工具是用 AFX 编写的，所以我希望它可以提供有关用于编码密码的算法的线索。

使用管理工具，我们有两个经过编码的密码。第一个是“dinosaur123456789”，加密的十六进制在这里：

恐龙密码的十六进制值是

00h：4A 6E 3C 34 29 32 2E 59 51 6B 2B 4E 4F 20 47 75；Jn<4)2.YQk+NO Gu 10h: 6A 33 09 ; j3。20小时：64 69 6E 6F 73 61 75 72 31 32 33 34 35 36 37 38；恐龙12345678 30h: 39 30 ; 90

另一个密码“gertcha”编码为e8h： 4D 35 4C 46 53 5C 7E ；灌浆 M5LFS\~

我试过寻找一个常见的 XOR，但没有找到任何东西。密码文件中的密码长度相同，因此我假设这些是可逆编码（它是另一个时代！）。我想知道 AFX 类是否可能有用于此类事情的方法？

如果有人可以计算出编码，那就太好了！

谢谢，马修

[编辑：] 好的，首先，我将继续前进，并在新的解决方案中将过去抛在脑后。仍然使用旧数据会很好。确实，如果有人想把它当作一个谜题来解决，那么我仍然希望能够使用它。

对于那些想要尝试的人，我完成了两个密码。

All 'a' - 19 个 a 的密码： 47 7D 47 38 58 57 7C 73 59 2D 50 ；G}G8XW|sY-P 79 68 29 3E 44 52 31 6B 09 ; yh)>DR1k。

全 'b' - 带有 16 个 b 的密码。48 7D 2C 71 78 67 4B 46 49 48 5F；H},qxgKFIH_69 7D 39 79 5E 09 ; 我}9y^。

这使我确信没有简单的解决方案，并且有一些反馈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T20:27:54.657

好吧，我对它做了一个快速的密码分析，到目前为止，我可以告诉你每个密码似乎都以它的 ascii 值 + 26 开头。下一个八位字节似乎是密码的第一个字符和第二个字符之间的区别, 添加到它的 ascii 值。3d字母，我还没想通。我认为可以肯定地说您正在处理某种反馈密码，这就是 XOR 没有出现任何结果的原因。我认为每个八位位组的值都取决于前一个。

我可以继续，但这东西需要很多时间。希望这可以给你一个开始，或者给你一些想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T15:35:16.137

但由于输出与输入的长度相等，这看起来像是一些固定密钥密码。这可能是一个微不足道的异或。

我建议测试以下密码：

```
 * AAAAAAAA
 * aaaaaaaa
 * BBBBBBBB
 * ABABABAB
 * BABABABA
 * AAAABBBB
 * BBBBAAAA
 * AAAAAAAAAAAAAAAA
 * AAAAAAAABBBBBBBB
 * BBBBBBBBAAAAAAAA 
```

这也许可以让我们在不对 DLL 进行逆向工程的情况下破解密码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T17:11:30.030

dll可以编码单字符密码吗？甚至是零字符密码？

您将要从最琐碎的测试用例开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T18:28:08.643

您可能从错误的角度看待这个问题。我认为弄清楚密码哈希是如何创建的最好的原因是对登录 dll 进行逆向工程。

我会推荐[IDA Pro](http://www.hex-rays.com/idapro/)来完成这项任务。帮助您将可执行代码反转为可读的汇编程序，这是非常值得的。如果您不想付钱，还有其他免费的反汇编程序，但我没有遇到像 IDA Pro 这样强大的东西。我推荐的免费静态反汇编器/调试器是 SmidgeonSoft 的[PEBrowse](http://www.smidgeonsoft.prohosting.com/)，因为它有利于快速浏览实时运行的系统，并且对加载调试符号具有良好的 PDB 支持。

# internet-explorer - InternetExplorer.Application 对象和 cookie 容器

> ID：503041
> 
> 赞同：6
> 
> 时间：2009-02-02T12:27:24.953
> 
> 标签：internet-explorer, cookies, automation

我有以下用 VB.NET 编写的控制台应用程序：

```
Sub Main()
    Dim ie As Object = CreateObject("InternetExplorer.Application")
    ie.Visible = True
    ie.Navigate2("http://localhost:4631/Default.aspx")
End Sub 
```

该程序使用[InternetExplorer.Application](http://msdn.microsoft.com/en-us/library/aa752084(VS.85).aspx)自动化对象来启动 IE 窗口并导航给定的 url。我遇到的问题是，即使我启动了我的应用程序的多个实例，使用这种方法创建的 IE 窗口都共享同一个 cookie 容器。我可以使用任何参数来指定为每个窗口创建不同的 cookie 容器吗？

这是我用来测试 cookie 的网页：

```
<%@ Page Language="C#" AutoEventWireup="true" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<script runat="server">
    protected void Page_Load(object sender, EventArgs e)
    {
        // Store something into the session in order to create the cookie
        Session["foo"] "bar";
        Response.Write(Session.SessionID);
    }
</script>
<html xmlns="http://www.w3.org/1999/xhtml" >
<body>
    <form id="form1" runat="server"></form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-19T01:47:46.730

关于`CreateObject("InternetExplorer.Application")`您创建一个 Internet Explorer 实例，您的所有程序实例都通过这一进程进行通信。**每个进程都会保留 Cookie**。

You can try to use in your application `WebBrowser` control instead (see [http://msdn.microsoft.com/en-us/library/3s8ys666.aspx](http://msdn.microsoft.com/en-us/library/3s8ys666.aspx)). You find in [http://msdn.microsoft.com/en-us/library/aa752044(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa752044(VS.85).aspx) information which compare two ways. If you will use `WebBrowser` control in you application all instances of your application will have his own set of cookies, but only one set of cookies per process independent on the number of `WebBrowser` controls in your application.

Inside of any process you can any time clear the cookie with respect of following call

```
InternetSetOption(IntPtr.Zero, INTERNET_OPTION_END_BROWSER_SESSION, IntPtr.Zero, 0); 
```

(see [http://support.microsoft.com/kb/195192/en](http://support.microsoft.com/kb/195192/en)) which shows one more time the nature of cookies holding.

# mysql - Performance tool for MySQL

> ID：503042
> 
> 赞同：0
> 
> 时间：2009-02-02T12:27:39.197
> 
> 标签：mysql, database, performance

Ciao, I'm looking for performance tool for testing of load in terms of data and number of users,better if they are open source

Thanks

Andrea

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T13:15:48.400

In linux: [mytop](http://jeremy.zawodny.com/mysql/mytop/)

> "mytop is a console-based (non-gui) tool for monitoring the threads and overall performance of MySQL"

Ps: It's open source

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T13:39:07.557

我喜欢[monyog](http://www.webyog.com)，虽然它刚退出 beta 测试时有一点问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T12:43:19.040

Check [Spotlight](http://www.quest.com/spotlight-on-mysql/). It's have a powerful tool

and see this [page it have a bunch of powerful tools](http://www.mysqlperformanceblog.com/tools/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-29T19:54:32.293

For diagnose performance problems you can use free [MySQL Query Profiler](http://dev.mysql.com/tech-resources/articles/using-new-query-profiler.html).

# javascript - JavaScript：IP 在这些子网之一中吗？

> ID：503052
> 
> 赞同：22
> 
> 时间：2009-02-02T12:31:45.383
> 
> 标签：javascript, sql, sqlite, performance, subnet

所以我有 ~12600 个子网：

例如。123.123.208.0/20

和一个IP。

我可以使用 SQLite 数据库或数组或其他任何东西

大约一个月前有一个类似的问题被问到，但是我不是要检查一个 IP 与一个子网，而是一堆子网（显然是最有效的方法，希望不是 O（总子网））:)

如何检查 IP 是否属于这些子网之一，如果这有助于优化，我需要 true 或 false 而不是子网。

当前列表中有类似的子网，例如：（实际提取）

```
123.123.48.0/22 <-- not a typo
123.123.48.0/24 <-- not a typo
123.123.90.0/24
123.123.91.0/24
123.123.217.0/24 
```

总的来说，它们的范围从 4.xyz 到 222.xyz

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-02T13:37:35.250

最好的方法是 IMO 利用位运算符。例如，`123.123.48.0/22`将`(123<<24)+(123<<16)+(48<<8)+0`(=2071670784；这可能是一个负数) 表示为 32 位数字 IP 地址，并将`-1<<(32-22)`= -1024 表示为掩码。有了这个，同样，你的测试 IP 地址转换为一个数字，你可以这样做：

```
(inputIP & testMask) == testIP 
```

例如，123.123.49.123 在该范围内，`2071671163 & -1024`2071670784 也是如此

所以，这里有一些工具功能：

```
function IPnumber(IPaddress) {
    var ip = IPaddress.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/);
    if(ip) {
        return (+ip[1]<<24) + (+ip[2]<<16) + (+ip[3]<<8) + (+ip[4]);
    }
    // else ... ?
    return null;
}

function IPmask(maskSize) {
    return -1<<(32-maskSize)
} 
```

测试：

```
(IPnumber('123.123.49.123') & IPmask('22')) == IPnumber('123.123.48.0') 
```

产量`true`。

如果您的掩码格式为“255.255.252.0”，那么您也可以使用 IPnumber 函数作为掩码。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-08-01T18:28:22.423

尝试这个：

```
var ip2long = function(ip){
    var components;

    if(components = ip.match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/))
    {
        var iplong = 0;
        var power  = 1;
        for(var i=4; i>=1; i-=1)
        {
            iplong += power * parseInt(components[i]);
            power  *= 256;
        }
        return iplong;
    }
    else return -1;
};

var inSubNet = function(ip, subnet)
{   
    var mask, base_ip, long_ip = ip2long(ip);
    if( (mask = subnet.match(/^(.*?)\/(\d{1,2})$/)) && ((base_ip=ip2long(mask[1])) >= 0) )
    {
        var freedom = Math.pow(2, 32 - parseInt(mask[2]));
        return (long_ip > base_ip) && (long_ip < base_ip + freedom - 1);
    }
    else return false;
}; 
```

用法：

```
inSubNet('192.30.252.63', '192.30.252.0/22') => true
inSubNet('192.31.252.63', '192.30.252.0/22') => false 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-09-25T14:03:35.593

我设法通过使用[节点网络掩码](https://github.com/rs/node-netmask)模块解决了这个问题。您可以通过以下方式检查 IP 是否属于子网：

```
import { Netmask } from 'netmask'

const block = new Netmask('123.123.208.0/20')
const ip = '123.123.208.0'
console.log(block.contains(ip)) 
```

将在这里打印`true`。

您可以使用以下方法安装它：

```
npm i --save netmask 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-02T12:42:24.097

Convert the lower ip and the upper ip in the range to integers and store the range in the db then make sure both columns are indexed.

Off the top of my head (pseudo code):

```
function ipmap(w,x,y,z) {
  return 16777216*w + 65536*x + 256*y + z;
}

var masks = array[ipmap(128,0,0,0), ipmap(196,0,0,0), ..., ipmap(255,255,255,255)]

function lowrange(w, x, y, z, rangelength) {
  return ipmap(w, x, y, z) & masks[rangelength]
}

function hirange(w, x, y, z, rangelength) {
  return lowrange(w, x, y, z, ,rangelength) + ipmap(255,255,255,255) - masks[rangelength];
} 
```

That ought to do it.

To find whether a particular ip falls in any of the ranges, convert it to an integer and do:

```
SELECT COUNT(*) FROM ipranges WHERE lowrange <= 1234567 AND 1234567 <= highrange 
```

The query optimizer should be able to speed this up greatly.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-03-21T08:47:15.570

功能`IPnumber`和`IPmask`很好，但我宁愿测试：

```
(IPnumber('123.123.49.123') & IPmask('22')) == (IPnumber('123.123.48.0')  & IPmask('22')) 
```

因为对于每个地址，你只需要考虑地址的网络部分。因此，这样做`IPmask('22')`会将地址的计算机部分归零，您应该对网络地址执行相同的操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-02-17T03:54:11.023

**关键词**：二分查找、预处理、排序

我遇到了类似的问题，如果您可以预处理子网列表并对其进行排序，那么二进制搜索似乎非常有效。然后你可以实现**O(log n)**的渐近时间复杂度。

这是我的代码（MIT 许可证，原始位置：[https](https://github.com/iBug/pac/blob/854289a674578d096f60241804f5893a3fa17523/code.js) ://github.com/iBug/pac/blob/854289a674578d096f60241804f5893a3fa17523/code.js ）：

```
function belongsToSubnet(host, list) {
  var ip = host.split(".").map(Number);
  ip = 0x1000000 * ip[0] + 0x10000 * ip[1] + 0x100 * ip[2] + ip[3];

  if (ip < list[0][0])
    return false;

  // Binary search
  var x = 0, y = list.length, middle;
  while (y - x > 1) {
    middle = Math.floor((x + y) / 2);
    if (list[middle][0] < ip)
      x = middle;
    else
      y = middle;
  }

  // Match
  var masked = ip & list[x][1];
  return (masked ^ list[x][0]) == 0;
} 
```

以及一个示例用法：

```
function isLan(host) {
  return belongsToSubnet(host, LAN);
}

var LAN = [
  [0x0A000000, 0xFF000000], // 10.0.0.0/8
  [0x64400000, 0xFFC00000], // 100.64.0.0/10
  [0x7F000000, 0xFF000000], // 127.0.0.0/8
  [0xA9FE0000, 0xFFFF0000], // 169.254.0.0/16
  [0xAC100000, 0xFFF00000], // 172.16.0.0/12
  [0xC0A80000, 0xFFFF0000]  // 192.168.0.0/16
]; 
```

```
isLan("127.12.34.56"); // => true
isLan("8.8.8.8"); // => false (Google's Public DNS) 
```

您可以[获取一个 PAC 脚本*](https://ibugone.com/project/pac-generator)，并查看它如何针对 5000 个子网执行（它从其他地方加载中国 IP 列表，对它们进行排序并适当地格式化它们）。在实践中，它的速度令人惊讶地令人满意。

可以使用上述页面上的 F12 开发工具检查预处理代码。简而言之，您需要将 IP 地址和网络掩码转换`1.2.3.4/16`为`[0x01020304, 0xFFFF0000]`，即 32 位无符号整数。

^(* 链接到我的个人网站。)

# sql - 如何创建从多个未链接的表中提取数据的存储过程 我该怎么做

> ID：503054
> 
> 赞同：0
> 
> 时间：2009-02-02T12:32:03.603
> 
> 标签：sql, sql-server-2005

我需要创建一个存储过程，它从多个未链接的表中提取数据我该怎么做。基本上我有一些未链接的表，我需要做的就是从所有这些表中提取所有数据。

请帮助我的生活依赖于此

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T12:34:23.693

只做几个选择？

```
select * from MyTable1;
select * from MyTable2;
select * from MyTable3; 
```

然后，您可以从调用代码访问这些表中的每一个。我会提供一个关于如何做到这一点的例子，但你没有包括任何关于你用什么语言打电话的细节......如果我的生活依赖它，我会包括的细节:)

如果您的意思是您在多个表中有行，并且您想将它们全部拉回来，那么您可以通过执行 UNION 来做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T12:56:42.057

Your questions is not clear, but if you are trying to pull just certain things from certain tables and then return them to the user, can do something like this:

```
CREATE PROCEDURE spMyTestProc 
AS

        DECLARE @F1 int
        DECLARE @F2 int
        DECLARE @F3 int
        DECLARE @f4 char(10)

        SELECT @f1 = FIELD1 from MYTABLE1

        SELECT @F2 = FIELD2 FROM MYTABLE2

        SELECT @F3 = FIELD3, @F4=FIELD4 FROM MYTABLE3

    /* NOW return the result set to the user, it'll come back just like a regular select */    
        SELECT @F1 AS F1, @F2 AS F2, @F3 AS F3, @F4=F4 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T12:58:41.693

The presence or absence of primary or foreign keys doesn't prevent you from joining the tables. (It won't be particularly fast, but you can do it.) Neither does their existing in separate database instances.

You say that your databases aren't linked. From this, I have to infer that the database you're writing the stored procedure in likely has no access to the 2nd database; if that's the case, you won't be able to access it anyway. You need to add a link to the 2nd database using Enterprise Manager.

Once you've done that, you can reference the tables in the 2nd database using its schema name as below:

```
SELECT *
FROM foo.employees 
```

where foo is the schema name.

Good luck.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T13:11:05.133

```
SELECT Field1, Field2, Field3 FROM Table1 
UNION ALL
SELECT F1, F2, F3 FROM Table2 
UNION ALL 
SELECT Fld1, Fld2, Fld3 FROM Table3; 
```

This will pull all data from all three tables into single output. Check that other table fields match type of the first table and you are good to go.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T12:35:19.150

“未链接”是什么意思？它们在同一个 sql server 实例上吗？如果是这样，只需从完整的模式名称中选择。

例如。

从 database1.dbo.table 中选择 * 从 database2.dbo.table 中选择 *

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T12:35:54.533

如果您想要一个结果集，您可以使用`JOIN`关键字，无论表是否定义了外键关系；只需指定您想要加入表格的列。

或者，您可以使用多个结果集并且只包含多个`SELECT`语句。

# java - 无法将 JConsole 与作为 Windows 服务运行的 Tomcat 一起使用

> ID：503057
> 
> 赞同：21
> 
> 时间：2009-02-02T12:33:44.957
> 
> 标签：java, tomcat, jmx, jconsole

我将 tomcat 6.0.18 作为 Windows 服务运行。在服务小程序中，jvm 是默认配置的，即它使用 JRE 的 jvm.dll。

我正在尝试使用 JConsole 监视此应用程序，但无法在本地连接到它。我添加了参数 -Dcom.sun.management.jmxremote （在使用 start.bat 脚本启动 tomcat 时有效）。但是jvm似乎没有拿起参数。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-17T01:38:46.303

有一个很好的 GUI 来编辑选项，无需在注册表中乱七八糟。

打开 C:\Program Files\Apache Software Foundation\Tomcat 6.0\bin\tomcat6.exe（或者直接双击任务栏中的监视器图标）。转到 Java 窗格，将以下内容添加到参数列表中，然后重新启动 Tomcat。

```
-Dcom.sun.management.jmxremote
-Dcom.sun.management.jmxremote.port=8086
-Dcom.sun.management.jmxremote.ssl=false
-Dcom.sun.management.jmxremote.authenticate=false

```

然后，您可以连接 JConsole 或更新的 VisualVM。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T16:37:49.677

这是更改 jvmoptions 和与服务交互的规定方式：

[http://tomcat.apache.org/tomcat-5.5-doc/windows-service-howto.html](http://tomcat.apache.org/tomcat-5.5-doc/windows-service-howto.html)

我会尝试进入您在 HKLM/Software/Apache Software Foundation/Procrun 2.0//Parameters/Java 的注册表并直接编辑“选项”多字符串值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-16T10:01:24.677

我发布它主要是为了给自己记录这些信息，我还没有验证它——但这应该也可以：

[http://mysqlandsqlserver.blogspot.com/2010/02/jconsolejmap-and-tomcat-as-windows.html](http://mysqlandsqlserver.blogspot.com/2010/02/jconsolejmap-and-tomcat-as-windows.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-27T15:37:58.273

仍然有一种相当简单的方法可以使用我在[这里](https://blogs.oracle.com/nbprofiler/entry/monitoring_java_processes_running_as)发现的本地模式将 JConsole 连接到作为 Windows 服务启动的 Java 进程。

基本上它说，为了连接到作为 Windows 服务启动的 Java 进程，您需要将 JConsole 作为 Windows 服务启动（您可以使用 Windows 本机 api 或使用任何包装器，如[yajsw](http://yajsw.sourceforge.net/)。）

顺便说一句，这将使您免于重新启动对我来说至关重要的 Java 进程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T16:10:46.083

如果 Tomcat 作为 Windows 服务运行，并且您想在本地附加到 JVM，则需要将 VisualVM 或 JConsole 作为系统帐户运行。您可以使用[Sysinternals PsExec.exe](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)来完成此操作。

```
psexec.exe -i -s c:\visualvm\bin\visualvm.exe 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-22T04:43:18.917

在 catalina.bat 顶部附近添加以下内容

```
set JAVA_OPTS=%JAVA_OPTS% -Dcom.sun.management.jmxremote ^
    -Dcom.sun.management.jmxremote.port=8086 ^
    -Dcom.sun.management.jmxremote.ssl=false ^
    -Dcom.sun.management.jmxremote.authenticate=false 
```

停止并重新启动tomcat（显然）

运行 jconsole.exe。如果您的 tomcat 作为服务运行，则以管理员身份运行 jconsole.exe。

选择远程进程并输入 localhost:8086

# .net - 如何锁定表格的一行

> ID：503065
> 
> 赞同：2
> 
> 时间：2009-02-02T12:36:41.973
> 
> 标签：.net, sql

我有一个在终端上运行的应用程序。

终端在数据库表上注册。

在应用程序在终端上运行的所有会话期间，我需要确保与终端对应的表的行被锁定并且没有人可以更新它。

做这个的最好方式是什么？

我使用 C#.NET 作为编程语言，使用 SQL Server 作为 DBMS。

感谢：D

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T13:01:22.467

In general, I try to work with short-lived locks where I can do an entire unit of work in a single (serializable) transaction; this avoids the need for an additional locking mechanism, as the db locks will do everything needed.

When working with long-lived locks: It is a bad idea to use rdbms-locks for that purpose - it simply doesn't scale. Timestamp or row-version columns are a good way of doing optimistic concurrency to prevent against accidental over-writing.

To publish / enforce the fact that a row is being edited, I would store the user-id/user-name of the locking user in a column (null if not locked). This makes it clear who owns the row - i.e. when you want to edit the row, first UPDATE it, setting your user-id (and ensuring that it isn't already locked).

To cope with locks that aren't removed correctly (because of a dead terminal etc) there are 3 common options:

*   when the lock owner logs in again, allow them to break their own locks
*   allow an administrator to break the user's locks
*   store a lock-timeout column (datetime), and have a scheduled task automatically unlock rows that are overdue

So to summarise - consider something like:

```
Foo
===
Id | ...data... | Timestamp | LockOwner | LockTimeout
---+------------+-----------+-----------+------------ 
```

etc

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T12:53:53.373

数据库不适用于这种锁定。您可以锁定项目，但仅限于操作期间（SELECT、INSERT、UPDATE、DELETE）。

也许您应该尝试添加一个名为“inUse”的位列，并在终端使用它时将其设置为 True(1)。对终端进行编程以尊重已设置的 inUse 值，并确保在终端完成时将其设置为 False (0)。

为什么无论如何都要锁定行，每个终端都有一行不是更好吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T12:56:56.860

执行此操作的最简单方法是假设您有协作进程并让终端应用程序（我假设它创建行）在创建行时生成并存储与该终端关联的唯一值。这样，在表中插入行的每个进程都有自己的唯一值，并且可以在更新表中的行时使用该值作为检查。如果您在事务中执行插入并读回插入的值，数据库可以为您生成唯一值（Guid 或 UniqueIdentifier，甚至只是一个整数标识字段）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T12:59:35.000

在许多 sql 方言中，您可以执行这种锁定：

```
begin transaction

select * from FOOTABLE f for update where ID = '12345'

[... do any other stuff here ... ] 

commit transaction 
```

# html - Outlook HTML 邮件 - 将链接项目更改为嵌入

> ID：503066
> 
> 赞同：2
> 
> 时间：2009-02-02T12:38:01.313
> 
> 标签：html, image, rtf, attachment, outlook-object-model

我正在尝试通过 C# 3 发送 HTML 格式的电子邮件`Outlook.MailItem`

```
Outlook.MailItem objMail = (Outlook.MailItem)olkApp.CreateItem(Outlook.OlItemType.olMailItem);
objMail.To = to;
objMail.Subject = subject;
objMail.HTMLBody = htmlBody; 
```

电子邮件是通过从 RTF 控件（TX 文本控件）保存而在外部生成的，该控件生成 HTML，其中包含指向存储在`<<FileName>>`_files 子目录中的图像的链接。例子：

`<img border="0" src="file:///C:/Documents%20and%20Settings/ItsMe/Local%20Settings/Temp/2/zbt4dmvs_Images/zbt4dmvs_1.png" width="94" height="94" alt="[image]">`

以这种方式发送电子邮件会生成链接损坏的邮件。

使用 Outlook 2007 作为电子邮件客户端和 Word 作为电子邮件编辑器，切换到 RTF（选项选项卡、格式选项卡组）可以保留布局*并*内联图像。

通过以下方式以编程方式执行此操作：

```
var oldFormat = objMail.BodyFormat;
objMail.BodyFormat = Outlook.OlBodyFormat.olFormatRichText;
objMail.BodyFormat = oldFormat; 
```

丢失格式并破坏图像（图像成为`[image]`屏幕上的链接标记，可单击但不再显示图像）。这并不奇怪，因为[MailItem.BodyFormat 属性](http://msdn.microsoft.com/en-us/library/bb207134.aspx)的文档说“*当属性从 RTF 切换到 HTML 时，所有文本格式都会丢失，`BodyFormat`反之亦然*”。

可悲的是，似乎没有一种简单的方法来更改 to 中的each `Type`，因为它是在创建.`Attachment``MailItem.Attachements``OlAttachmentType.olByValue``Attachment`

想到的一种方法是遍历 HTML，用标记替换``<img>``标签并以编程方式遍历`MailItem`文本，插入一个`Outlook.Attachment`of `Type` `OlAttachmentType.olByValue`.

另一种选择是转换``<img>``要使用的链接``src="cid:uniqueIdN"``并将图像添加为具有引用身份的附件。

那么，对于这个问题......有没有办法将链接图像转换为嵌入图像，最好不要进入第三方工具，如 Redemption？转换为 RTF 碰巧会产生结果，但这样做绝不是先决条件，而且显然可能会失去保真度 - 我只是想让它正常工作：D 我现有的想法对我来说听起来都不干净。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T13:12:52.680

由于您使用的是 .net > 2.0，因此您可能需要查看 System.Net.Mail 命名空间以创建邮件消息。我发现它非常可定制，并且非常易于用于与您类似的任务。我遇到的唯一问题是确保我使用了正确的[编码](https://stackoverflow.com/questions/368456/email-sent-in-english-is-displayed-to-the-end-user-with-picture-alphabet-chinese)，并且我必须使用 HTML 表格进行布局（css 无法正常工作）。这里有一些链接向您展示它是如何工作的......

*   [基本的](http://www.beansoftware.com/ASP.NET-Tutorials/Send-E-Mail.aspx)
*   [具有多个视图](http://www.fuzzydev.com/blogs/dotnet/archive/2006/07/23/System_Net_Mail_AlternateView_LinkedResource.aspx)（纯文本和 HTML）

如果这不是一个选项，那么我建议使用 Content ID 路线并将图像嵌入为附件。您的另一个选择是在网站上公开托管图像，并将 html 中的图像链接更改为公共图像。

您应该意识到 HTML 电子邮件很容易看起来像垃圾邮件，并且可以被电子邮件服务器和客户端视为垃圾邮件。即使是那些仅供内部使用的（它发生在我身上）也可能最终出现在 Outlook 的垃圾邮件文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T13:12:59.857

DOH!，实际上在 Outlook 2007 中*发送*电子邮件会强制图像嵌入。

8K 的已发送项目大小比我看到的 60K (RTF) 的草稿大小与 1K 的草稿大小（尚未转换为 RTF 并再次返回的 HTML）小得多。

所以它一直在做我的意思。Grr。

我将把 Q 和 A 留在这里，以防它帮助有同样困惑的心态的人。

顺便说一句，我在旅途中发现了一些有用的链接：

[发送电子邮件示例](http://aspalliance.com/1354_Sending_HTML_Mail_with_Embedded_Image_in_NET.all)

[一般问答网站以及其他质量不同的示例](http://outlookcode.com)

# windows - 使用脚本清除 Internet Explorer 6.0 浏览历史记录

> ID：503068
> 
> 赞同：4
> 
> 时间：2009-02-02T12:38:06.103
> 
> 标签：windows, internet-explorer, batch-file

我正在使用以下脚本删除 IE 7.0 中的浏览历史记录

```
RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 255 
```

但现在我需要一个脚本来清除 IE 6.0 中的浏览历史记录

我收到一个错误，“缺少条目 ClearMyTracksByProcess”我已经传递了不同的参数，如 2 ,5 等，但没有成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T09:26:35.093

```
// test.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include "test.h"
#include <shlguid.h> // Needed for CLSID_CUrlHistory
#include <urlhist.h> // Needed for IUrlHistoryStg2 and IID_IUrlHistoryStg2

#ifdef _DEBUG
#define new DEBUG_NEW
#endif

// The one and only application object

CWinApp theApp;

using namespace std;

int _tmain(int argc, TCHAR* argv[], TCHAR* envp[])
{
    int nRetCode = 0;

    // initialize MFC and print and error on failure
    if (!AfxWinInit(::GetModuleHandle(NULL), NULL, ::GetCommandLine(), 0))
    {
        // TODO: change error code to suit your needs
        _tprintf(_T("Fatal Error: MFC initialization failed\n"));
        nRetCode = 1;
    }
    else
    {
        // TODO: code your application's behavior here.

        IUrlHistoryStg2* pHistory;  // We need this interface for clearing the history.
        HRESULT hr;
        DWORD cRef;
        CoInitialize(NULL);
        // Load the correct Class and request IUrlHistoryStg2
        hr = CoCreateInstance(CLSID_CUrlHistory, NULL, CLSCTX_INPROC_SERVER,
        IID_IUrlHistoryStg2, reinterpret_cast<void **>(&pHistory));

        if (SUCCEEDED(hr))
        {
         // Clear the IE History
         hr = pHistory->ClearHistory();
        }
        // Release our reference to the 
        cRef = pHistory->Release();
        CoUninitialize();
    }

    return nRetCode;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T12:51:51.490

由于`INETCPL.CPL version 7.0`Internet Explorer 7 附带的入口点确实有一个名为 的入口点`ClearMyTracksByProcessW`，因此它可能不存在于 IE6 中。

因此，脚本可能是一个更基本的解决方案：

```
@ECHO OFF
ECHO * Cleaning Current User's Temp Folders *
FOR /D %%G IN ("C:\Documents and Settings\*.*") DO DEL/S/Q/F "%%G\Cookies\*.*"
FOR /D %%G IN ("C:\Documents and Settings\*.*") DO DEL/S/Q/F "%%G\Local Settings\Temp\*.*"
FOR /D %%G IN ("C:\Documents and Settings\*.*") DO DEL/S/Q/F "%%G\Local Settings\History\*.*"
FOR /D %%G IN ("C:\Documents and Settings\*.*") DO DEL/S/Q/F "%%G\Local Settings\Temporary Internet Files\*.*"
Echo * Done *
PAUSE
CLS 
```

（您可以只保留您对此脚本感兴趣的“删除”）

但是，正如[该线程中所报告的](http://www.howtogeek.com/howto/windows/clear-ie7-browsing-history-from-the-command-line/)，这可能还不够。

* * *

唯一的其他解决方案是使用（免费）第三方实用程序：

[替代文字 http://www.ccleanerbeginnersguide.com/ccleanerhelp.png](http://www.ccleanerbeginnersguide.com/ccleanerhelp.png) [CCleaner](http://www.ccleanerbeginnersguide.com/scr/commandline.htm)

[此线程中提到了](http://www.windowskb.com/Uwe/Forum.aspx/windowsxp/261874/Clear-IE-History-using-Batch-file-Recent)其他选项：

*   [索引.dat](http://support.it-mate.co.uk/?mode=Products&p=Index.datSuite)
*   [Xp 调整（见右图 24）](http://www.kellys-korner-xp.com/xp_tweaks.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T02:35:14.800

ClearMyTracks() 不是 IE6 的一部分，所以你不能做同样的伎俩。

如果您只是想清除历史记录，您可以编写一个仅 CoCreates(CLSID_CUrlHistory, IID_IUrlHistoryStg2) 的小程序，然后调用[IUrlHistoryStg::ClearHistory()](http://msdn.microsoft.com/en-us/library/aa767715(VS.85).aspx)。

也应该能够从 VBScript 中做到这一点，但我不知道正确的魔力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-21T15:39:03.270

坏消息

尝试在带有 IE8/9 的 Win 7 上使用 ClearMyTracksByProcess 删除 Internet 历史记录不再有效，您只能通过在启动时运行 dos delete 命令来清理一些文件，因为微软使用超级隐藏文件夹，锁定文件，这会造成很大的混乱和不安大哥。

此代码清除 IE8/9 以及 FireFox 和共享对象/flash cookie，但如果您想删除 Index.dat 文件，请单击我的名字以查看代码。

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Diagnostics; 
using System.Text;

namespace Fidling
{
    public static class SpywareRemoval
    {
        private static void RemoveSpywareFiles(string RootPath, string Path,bool Recursive)
        {
            string FullPath = RootPath + Path + "\\";
            if (Directory.Exists(FullPath))
            {
                DirectoryInfo DInfo = new DirectoryInfo(FullPath);
                FileAttributes Attr = DInfo.Attributes;
                DInfo.Attributes = FileAttributes.Normal;
                foreach (string FileName in Directory.GetFiles(FullPath))
                {
                    RemoveSpywareFile(FileName);
                }
                if (Recursive)
                {
                    foreach (string DirName in Directory.GetDirectories(FullPath))
                    {
                        RemoveSpywareFiles("", DirName, true);
                        try { Directory.Delete(DirName); }catch { }
                    }
                }
                DInfo.Attributes = Attr;
            }
        }

        private static void RemoveSpywareFile(string FileName)
        {
            if (File.Exists(FileName))
            {
                try { File.Delete(FileName); }catch { }//Locked by something and you can forget trying to delete index.dat files this way
            }
        }

        private static void DeleteFireFoxFiles(string FireFoxPath)
        {
            RemoveSpywareFile(FireFoxPath + "cookies.sqlite");
            RemoveSpywareFile(FireFoxPath + "content-prefs.sqlite");
            RemoveSpywareFile(FireFoxPath + "downloads.sqlite");
            RemoveSpywareFile(FireFoxPath + "formhistory.sqlite");
            RemoveSpywareFile(FireFoxPath + "search.sqlite");
            RemoveSpywareFile(FireFoxPath + "signons.sqlite");
            RemoveSpywareFile(FireFoxPath + "search.json");
            RemoveSpywareFile(FireFoxPath + "permissions.sqlite");
        }

        public static void RunCleanup()
        {
            try { KillProcess("iexplore"); }
            catch { }//Need to stop incase they have locked the files we want to delete
            try { KillProcess("FireFox"); }
            catch { }//Need to stop incase they have locked the files we want to delete
            string RootPath = Environment.GetFolderPath(Environment.SpecialFolder.Personal).ToLower().Replace("documents", "");
            RemoveSpywareFiles(RootPath, @"AppData\Roaming\Macromedia\Flash Player\#SharedObjects",false);
            RemoveSpywareFiles(RootPath, @"AppData\Roaming\Macromedia\Flash Player\macromedia.com\support\flashplayer\sys\#local", false);
            RemoveSpywareFiles(RootPath, @"AppData\Local\Temporary Internet Files", false);//Not working
            RemoveSpywareFiles("", Environment.GetFolderPath(Environment.SpecialFolder.Cookies), true);
            RemoveSpywareFiles("", Environment.GetFolderPath(Environment.SpecialFolder.InternetCache), true);
            RemoveSpywareFiles("", Environment.GetFolderPath(Environment.SpecialFolder.History), true);
            RemoveSpywareFiles(RootPath, @"AppData\Local\Microsoft\Windows\Wer", true);  
            RemoveSpywareFiles(RootPath, @"AppData\Local\Microsoft\Windows\Caches", false);          
            RemoveSpywareFiles(RootPath, @"AppData\Local\Microsoft\WebsiteCache", false);
            RemoveSpywareFiles(RootPath, @"AppData\Local\Temp", false);
            RemoveSpywareFiles(RootPath, @"AppData\LocalLow\Microsoft\CryptnetUrlCache", false);
            RemoveSpywareFiles(RootPath, @"AppData\LocalLow\Apple Computer\QuickTime\downloads", false);
            RemoveSpywareFiles(RootPath, @"AppData\Local\Mozilla\Firefox\Profiles", false);
            RemoveSpywareFiles(RootPath, @"AppData\Roaming\Microsoft\Office\Recent", false);
            RemoveSpywareFiles(RootPath, @"AppData\Roaming\Adobe\Flash Player\AssetCache", false);
            if (Directory.Exists(RootPath + @"\AppData\Roaming\Mozilla\Firefox\Profiles"))
            {
                string FireFoxPath = RootPath + @"AppData\Roaming\Mozilla\Firefox\Profiles\";
                DeleteFireFoxFiles(FireFoxPath);
                foreach (string SubPath in Directory.GetDirectories(FireFoxPath))
                {
                    DeleteFireFoxFiles(SubPath + "\\");
                }
            }
        }

        private static void KillProcess(string ProcessName)
        {//We ned to kill Internet explorer and Firefox to stop them locking files
            ProcessName = ProcessName.ToLower();
            foreach (Process P in Process.GetProcesses())
            {
                if (P.ProcessName.ToLower().StartsWith(ProcessName))
                    P.Kill();
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-09T10:37:17.277

我会帮您解决这个问题..这就是我自己使用的。

我召唤一个提示框，随意编辑

```
@echo off
echo.
echo Clearing History 
echo Please close this window if opening this was a mistake.
pause
echo.
echo Clearing History: File Explorer
Del /F /Q %APPDATA%\Microsoft\Windows\Recent\*
Del /F /Q %APPDATA%\Microsoft\Windows\Recent\AutomaticDestinations\*
Del /F /Q %APPDATA%\Microsoft\Windows\Recent\CustomDestinations\*
REG Delete HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RunMRU /VA /F
REG Delete HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths /VA /F 
echo.
echo Completed!
echo.
echo -----------------------------------------------------------------------------------
echo.
echo Clearing History: Firefox
echo.
echo Scanning for 'Firefox' data
set DataDir=C:\Users\%USERNAME%\AppData\Local\Mozilla\Firefox\Profiles
IF NOT EXIST "%DataDir%" GOTO NOFIREFOXDIR
del /q /s /f "%DataDir%"
rd /s /q "%DataDir%"
for /d %%x in (C:\Users\%USERNAME%\AppData\Roaming\Mozilla\Firefox\Profiles\*) do del /q /s /f %%x\*sqlite
GOTO YESFIREFOXDIR
:NOFIREFOXDIR
echo.
echo Firefox NOT found!
echo.
GOTO CHROMESETUP
:YESFIREFOXDIR
echo.
echo Completed!
echo.
:CHROMESETUP
echo -----------------------------------------------------------------------------------
echo.
echo Clearing History: Google Chrome
echo.
echo Scanning for 'Google Chrome' data.
set ChromeDir=C:\Users\%USERNAME%\AppData\Local\Google\Chrome\User Data
IF NOT EXIST "%ChromeDir%" GOTO NOCHROMEDIR
del /q /s /f "%ChromeDir%"
rd /s /q "%ChromeDir%"
GOTO YESCHROMEDIR
:NOCHROMEDIR
echo.
echo Google Chrome NOT found!
echo.
GOTO OPERASETUP
:YESCHROMEDIR
echo.
echo Completed!
echo.
:OPERASETUP
echo -----------------------------------------------------------------------------------
echo.
echo Clearing History: Opera
echo.
echo Scanning for 'Opera' data.
set OperaDir=C:\Users\%USERNAME%\AppData\Local\Opera\Opera
set OperaDir2=C:\Users\%USERNAME%\AppData\Roaming\Opera\Opera
IF NOT EXIST "%OperaDir%" GOTO OPERA2
del /q /s /f "%Opera%"
rd /s /q "%Opera%"
:OPERA2
IF NOT EXIST "%OperaDir2%" GOTO NOOPERADIR
del /q /s /f "%Opera2%"
rd /s /q "%Opera2%"
GOTO YESOPERADIR
:NOOPERADIR
echo.
echo Opera NOT found!
echo.
GOTO APPLESETUP
:YESOPERADIR
echo.
echo Completed!
echo.
:APPLESETUP
echo -----------------------------------------------------------------------------------
echo.
echo Clearing History: Apple Safari
echo.
echo Scanning for 'Apple Safari' data.
set AppleDir=C:\Users\%USERNAME%\AppData\Local\Applec~1\Safari
set AppleDir2=C:\Users\%USERNAME%\AppData\Roaming\Applec~1\Safari
IF NOT EXIST "%AppleDir%" GOTO APPLESETOP
del /q /s /f "%AppleDir%\History"
rd /s /q "%AppleDir%\History"
del /q /s /f "%AppleDir%\Cache.db"
del /q /s /f "%AppleDir%\WebpageIcons.db"
:APPLESETOP
IF NOT EXIST "%AppleDir2%" GOTO NOAPPLEDIR
del /q /s /f "%AppleDir2%"
rd /s /q "%AppleDir2%"
GOTO YESAPPLEDIR
:NOAPPLEDIR
echo.
echo Apple Safari NOT found!
echo.
GOTO INTESETUP
:YESAPPLEDIR
echo.
echo Completed!
echo.
:INTESETUP
echo -----------------------------------------------------------------------------------
echo.
echo Clearing History: Microsoft Internet Explorer
echo.
echo Scanning for 'Microsoft Internet Explorer' data.
set IEDataDir=C:\Users\%USERNAME%\AppData\Local\Microsoft\Intern~1
IF NOT EXIST "%IEDataDir%" GOTO HISTORYDIR
del /q /s /f "%IEDataDir%"
rd /s /q "%IEDataDir%"
:HISTORYDIR
set History=C:\Users\%USERNAME%\AppData\Local\Microsoft\Windows\History
IF NOT EXIST "%History%" GOTO IETEMPDIR
del /q /s /f "%History%"
rd /s /q "%History%"
:IETEMPDIR
set IETemp=C:\Users\%USERNAME%\AppData\Local\Microsoft\Windows\Tempor~1
IF NOT EXIST "%History%" GOTO COOKIESDIR
del /q /s /f "%IETemp%"
rd /s /q "%IETemp%"
:COOKIESDIR
set Cookies=C:\Users\%USERNAME%\AppData\Roaming\Microsoft\Windows\Cookies
IF NOT EXIST "%Cookies%" GOTO FLASHCCC
del /q /s /f "%Cookies%"
rd /s /q "%Cookies%"
:FLASHCCC
set FlashCookies=C:\Users\%USERNAME%\AppData\Roaming\Macromedia\Flashp~1
IF NOT EXIST "%FlashCookies%" GOTO FINAL
del /q /s /f "%FlashCookies%"
rd /s /q "%FlashCookies%"
:FINAL
echo.
cls
echo.
echo Thank you for using our cleaner...
echo.
pause 
```

# php - php和mysql不显示数据，不进入foreach循环

> ID：503077
> 
> 赞同：0
> 
> 时间：2009-02-02T12:44:37.073
> 
> 标签：php, mysql, ajax, lamp

我在修改 php 应用程序以进行分页时遇到问题。我的错误似乎与我的逻辑有关，我不清楚我做错了什么。我以前遇到过，但目前没有收到 mysql_num_rows() 不是有效的结果资源以及向 foreach 提供了无效参数的错误。我认为我的逻辑存在问题，即阻止返回 mysql 的结果。

除了测试while循环外，我所有的“测试”回声都被输出。生成一个页面，其中包含查询名称和单词拍卖，以及第一个和上一个链接，但没有下一个和最后一个链接。如果可以指出一种为表中的行生成链接的更有效方法，而不是为每个单元格创建链接，我将不胜感激。是否可以为多个项目建立连续链接？

```
<?php
if (isset($_GET["cmd"]))
  $cmd = $_GET["cmd"]; else
die("You should have a 'cmd' parameter in your URL");
$query ='';
if (isset($_GET["query"])) {
    $query = $_GET["query"];
}
if (isset($_GET["pg"]))
{ 
 $pg = $_GET["pg"];
 }
  else $pg = 1;
$con = mysql_connect("localhost","user","password");
echo "test connection<p>";
if(!$con) {
    die('Connection failed because of' .mysql_error());
}
mysql_query('SET NAMES utf8');
mysql_select_db("database",$con);
if($cmd=="GetRecordSet"){
    echo "test in loop<p>"; 
    $table = 'SaleS';
    $page_rows = 10;
    $max = 'limit ' .($pg - 1) * $page_rows .',' .$page_rows;
    $rows = getRowsByProductSearch($query, $table, $max);
    echo "test after query<p>";
    $numRows = mysql_num_rows($rows);
    $last = ceil($rows/$page_rows);
    if ($pg < 1) {
        $pg = 1;
    } elseif ($pg > $last) {
        $pg = $last;
    }
    echo 'html stuff <p>';

    foreach ($rows as $row) {

echo "test foreach <p>";
        $pk = $row['Product_NO'];
        echo '<tr>' . "\n";
        echo '<td><a href="#" onclick="updateByPk(\'Layer2\', \'' . $pk . '\')">'.$row['USERNAME'].'</a></td>' . "\n";
        echo '<td><a href="#" onclick="updateByPk(\'Layer2\', \'' . $pk . '\')">'.$row['shortDate'].'</a></td>' . "\n";
        echo '<td><a href="#" onclick="updateByPk(\'Layer2\', \'' . $pk . '\')">'.$row['Product_NAME'].'</a></td>' . "\n";
        echo '</tr>' . "\n";
    }
    if ($pg == 1) {
    } else {
        echo " <a href='{$_SERVER['PHP_SELF']}?pg=1'> <<-First</a> ";
        echo " ";
        $previous = $pg-1;
        echo " <a href='{$_SERVER['PHP_SELF']}?pg=$previous'> <-Previous</a> ";
    }
    echo "---------------------------";
    if ($pg == $last) {
    } else {
        $next = $pg+1;
        echo " <a href='{$_SERVER['PHP_SELF']}?pg=$next'>Next -></a> ";
        echo " ";
        echo " <a href='{$_SERVER['PHP_SELF']}?pg=$last'>Last ->></a> ";
    }
    echo "</table>\n";
}
echo "</div>";
function getRowsByProductSearch($searchString, $table, $max) {
    $searchString = mysql_real_escape_string($searchString);
    $result = mysql_query("SELECT Product_NO, USERNAME, ACCESSSTARTS, Product_NAME, date_format(mycolumn, '%d %m %Y') as shortDate FROM {$table} WHERE upper(Product_NAME) LIKE '%" . $searchString . "%'" . $max);
    if($result === false) {
        echo mysql_error();
    }
    $rows = array();
    while($row = mysql_fetch_assoc($result)) {
        echo "test while <p>";
        $rows[] = $row;
    }
    return $rows;
    mysql_free_result($result);
} 
```

编辑：我已经打印出没有的mysql错误。但是，从包含 100 多条记录的数据库中打印出 8 个“测试时间”。从未进入 foreach 循环，我不确定为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T13:25:28.457

> 如果 (!(isset($pg))) { $pg = 1; }

$pg 将如何设置？您似乎没有从 $_GET 中读取它。如果你依赖于 register_globals：不要那样做！尝试从 $_GET 读取它并将其解析为正整数，如果失败则回退到 '1'。

> <a href='{$_SERVER['PHP_SELF']}?pg=$next'>下一个-></a>

您似乎正在丢失页面所需的其他参数，“查询”和“cmd”。

一般来说，我发现阅读您的代码非常困难，尤其是 echo() 的无缩进使用。此外，每次您“...$template...”或将字符串连接到 HTML 时，您都会遇到数不清的 HTML/脚本注入漏洞，而无需 htmlspecialchars() 处理它。

PHP 是一种模板语言：使用它，不要对抗它！例如：

```
<?php
    // Define this to allow us to output HTML-escaped strings painlessly
    //
    function h($s) {
        echo(htmlspecialchars($s), ENT_QUOTES);
    }

    // Get path to self with parameters other than page number
    //
    $myurl= $_SERVER['PHP_SELF'].'?cmd='.urlencode($cmd).'&query='.urlencode($query);
?>

<div id="tableheader" class="tableheader">
    <h1><?php h($query) ?> Sales</h1>
</div>
<div id="tablecontent" class="tablecontent">
    <table border="0" width="100%"> <!-- width, border, cell width maybe better done in CSS -->
        <tr>
            <td width="15%">Seller ID</td>
            <td width="10%">Start Date</td>
            <td width="75%">Description</td>
        </tr>
        <?php foreach ($rows as $row) { ?>
            <tr id="row-<?php h($row['Product_NO']) ?>" onclick="updateByPk('Layer2', this.id.split('-')[1]);">
                <td><?php h($row['USERNAME']); ?></td>
                <td><?php h($row['shortDate']); ?></td>
                <td><?php h($row['Product_NAME']); ?></td>
            </tr>
        <?php } ?>
    </table>
</div>
<div class="pagercontrols">
    <?php if ($pg>1) ?>
        <a href="<?php h($myurl) ?>&amp;pg=1"> &lt;&lt;- First </a>
    <?php } ?>
    <?php if ($pg>2) ?>
        <a href="<?php h($myurl) ?>&amp;pg=<?php h($pg-1) ?>"> &lt;-- Previous </a>
    <?php } ?>
    <?php if ($pg<$last-1) ?>
        <a href="<?php h($myurl) ?>&amp;pg=<?php h($pg+1) ?>"> Next --> </a>
    <?php } ?>
    <?php if ($pg<$last) ?>
        <a href="<?php h($myurl) ?>&amp;pg=<?php h($last) ?>"> Last ->> </a>
    <?php } ?>
</div> 
```

> 是否可以为多个项目建立连续链接？

跨细胞，没有。但无论如何，你并没有真正使用链接——那些“#”锚不会去任何地方。上面的示例将 onclick 放在表格行上。究竟什么更适合可访问性取决于您的应用程序到底想要做什么。

（上面还假设 PK 实际上是数字，因为其他字符可能无法放入“id”。您可能还需要考虑删除内联“onclick”并将代码移动到下面的脚本 - 请参阅“unobtrusive脚本”。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T19:22:15.460

问题（或至少其中一个）出在以下代码中：

```
$rows = getRowsByProductSearch($query, $table, $max);
$numRows = mysql_num_rows($rows); 
```

$numRows 变量不是 MySQL 结果集，它只是 getRowsByProductSearch 返回的普通数组。

将代码更改为：

```
$rows = getRowsByProductSearch($query, $table, $max);
$numRows = count($rows); 
```

那么它至少应该为你找到一些结果。

祝你好运，詹姆斯

你好呀，

下一个问题是如下行：

```
$last = ceil($rows/$page_rows); 
```

应改为：

```
$last = ceil($numRows / $page_rows); 
```

建议至少在调试时将以下行添加到脚本的开头：

```
ini_set('error_reporting', E_ALL | E_STRICT);
ini_set('display_errors', 'On'); 
```

因为那会引发致命错误并为您节省大量时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T13:12:37.873

这是错误的：

```
if($cmd=="GetRecordSet")
echo "test in loop\n"; { 
```

它应该是：

```
if($cmd=="GetRecordSet") {
    echo "test in loop\n"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T13:29:36.110

在您的`getRowsByProductSearch`函数中，您返回`mysql_error`是否发生的结果。为了调试代码，也许您可​​以将其打印出来，这样您就可以轻松查看问题所在。

# delphi - 如何链接“并行”类层次结构？

> ID：503079
> 
> 赞同：4
> 
> 时间：2009-02-02T12:46:55.400
> 
> 标签：delphi, virtual, rtti, class-hierarchy

我有一个小的类层次结构，其中每个类对应于某个 TComponent 后代（例如基类 TDefaultFrobber，其后代 TActionFrobber 和 TMenuItemFrobber，分别对应于 TComponent、TCustomAction 和 TMenuItem）。现在我想要一个工厂（？）函数是这样的：

```
function CreateFrobber(AComponent: TComponent): IFrobber;
begin
  if AComponent is TCustomAction then
    Result := TActionFrobber.Create(TCustomAction(AComponent))
  else if AComponent is TMenuItem then
    Result := TMenuItemFrobber.Create(TMenuItem(AComponent))
  else
    Result := TDefaultFrobber.Create(AComponent);
end; 
```

我可以以某种方式重构它以使用虚拟函数或类似的东西而不是 if-else 级联或 RTTI 吗？

**编辑：**我现在的解决方案：

```
unit Frobbers;

interface

uses
  Classes;

type
  IComponentFrobber = interface
  end;

  TComponentFrobberClass = class of TComponentFrobber;

  TComponentFrobber = class(TInterfacedObject, IComponentFrobber)
  strict private
    FComponent: TComponent;
  protected
    constructor Create(AComponent: TComponent);
    property Component: TComponent read FComponent;
  public
    class function FindFrobberClass(AComponentClass: TComponentClass): TComponentFrobberClass; overload; static;
    class function FindFrobberClass(AComponent: TComponent): TComponentFrobberClass; overload; static;
    class procedure RegisterFrobber(AComponentClass: TComponentClass; AFrobberClass: TComponentFrobberClass); static;
  end;

implementation

uses
  ActnList,
  Menus;

type
  TComponentFrobberRegistryItem = record
    ComponentClass: TComponentClass;
    FrobberClass: TComponentFrobberClass;
  end;

var
  FComponentFrobberRegistry: array of TComponentFrobberRegistryItem;

class function TComponentFrobber.FindFrobberClass(AComponentClass: TComponentClass): TComponentFrobberClass;
var
  i: Integer;
begin
  // Search backwards, so that more specialized frobbers are found first:
  for i := High(FComponentFrobberRegistry) downto Low(FComponentFrobberRegistry) do
    if FComponentFrobberRegistry[i].ComponentClass = AComponentClass then
    begin
      Result := FComponentFrobberRegistry[i].FrobberClass;
      Exit;
    end;
  Result := nil;
end;

constructor TComponentFrobber.Create(AComponent: TComponent);
begin
  inherited Create;
  FComponent := AComponent;
end;

class function TComponentFrobber.FindFrobberClass(AComponent: TComponent): TComponentFrobberClass;
var
  i: Integer;
begin
  // Search backwards, so that more specialized frobbers are found first:
  for i := High(FComponentFrobberRegistry) downto Low(FComponentFrobberRegistry) do
    if AComponent is FComponentFrobberRegistry[i].ComponentClass then
    begin
      Result := FComponentFrobberRegistry[i].FrobberClass;
      Exit;
    end;
  Result := nil;
end;

class procedure TComponentFrobber.RegisterFrobber(AComponentClass: TComponentClass;
  AFrobberClass: TComponentFrobberClass);
var
  i: Integer;
begin
  Assert(FindFrobberClass(AComponentClass) = nil, 'Duplicate Frobber class');
  i := Length(FComponentFrobberRegistry);
  SetLength(FComponentFrobberRegistry, Succ(i));
  FComponentFrobberRegistry[i].ComponentClass := AComponentClass;
  FComponentFrobberRegistry[i].FrobberClass := AFrobberClass;
end;

function CreateComponentFrobber(AComponent: TComponent): IComponentFrobber;
var
  FrobberClass: TComponentFrobberClass;
begin
  FrobberClass := TComponentFrobber.FindFrobberClass(AComponent);
  Assert(FrobberClass <> nil);
  Result := FrobberClass.Create(AComponent);
end;

type
  TActionFrobber = class(TComponentFrobber);
  TMenuItemFrobber = class(TComponentFrobber);

initialization
  TComponentFrobber.RegisterFrobber(TCustomAction, TActionFrobber);
  TComponentFrobber.RegisterFrobber(TMenuItem, TMenuItemFrobber);
end. 
```

感谢 Cesar、Gamecat 和 mghie。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T13:11:02.183

如果您使用虚拟构造函数创建一个类并为该类创建一个类类型。您可以根据组件类名称创建查找列表。

例子：

```
type
  TFrobber = class 
  public
    constructor Create; virtual;

    class function CreateFrobber(const AComponent: TComponent): TFrobber;
  end;
  TFrobberClass = class of TFrobber;

  type 
    TFrobberRec = record 
      ClassName: ShortString;
      ClassType: TFrobberClass;
    end;

  const
    cFrobberCount = 3;
    cFrobberList : array[1..cFrobberCount] of TFrobberRec = (
      (ClassName : 'TAction'; ClassType: TActionFrobber),
      (ClassName : 'TButton'; ClassType: TButtonFrobber),
      (ClassName : 'TMenuItem'; ClassType: TMenuItemFrobber)
    );

  class function TFrobber.CreateFrobber(const AComponent: TComponent): TFrobber;
  var
    i : Integer;
  begin
    Result := nil;
    for i := 1 to cFrobberCount do begin
      if AComponent.ClassName = cFrobberList[i].ClassName then begin
        Result := cFrobberList[i].ClassType.Create();
        Exit;
      end;
    end;
  end; 
```

您当然也可以使用动态列表（字典），但是您必须以某种方式注册每个组合。

**更新**

评论mghie的言论。

你完全正确。但这不可能没有真正丑陋的把戏。现在你必须使用一个单元的初始化/终结部分来重新注册一个类。但是将初始化/终结类方法添加到类中会很酷。这些必须与单元的初始化（和终结）一起调用。像这样：

```
class 
  TFrobber = class
  private
    initialization Init; // Called at program start just after unit initialization
    finalization Exit;  // called at program end just before unit finalization.
  end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T13:13:33.363

2个建议：制作类的类对数组，然后可以获取索引并使用类构造函数的对，

```
var
  ArrayItem: array[0..1] of TComponentClass = (TActionFrobber, TMenuItemFrobber);
  ArrayOwner: array[0..1] of TComponentClass = (TCustomAction, TMenuItem);

function CreateFrobber(AComponent: TComponentClass): IFrobber;
var
  Index: Integer;
begin
  Result:= nil;
  for I := Low(ArrayOwner) to High(ArrayOwner) do
    if AComponent is ArrayOwner[I] then
    begin
      Result:= ArrayItem[I].Create(AComponent);
      Break;
    end;

  if Result = nil then
    Result:= TDefaultFrobber.Create(AComponent);
end; 
```

或使用 RTTI + ClassName 约定，如下所示：

```
function CreateFrobber(AComponent: TComponentClass): IFrobber;
const 
  FrobberClassSuffix = 'Frobber';
var
  LClass: TComponentClass;
  LComponent: TComponent;
begin
  LClass:= Classes.FindClass(AComponent.ClassName + FrobberClassSuffix);
  if LClass <> nil then 
    LComponent:= LClass.Create(AComponent) 
  else
    LComponent:= TDefaultFrobber.Create(AComponent);

  if not Supports(LComponent, IFrobber, Result) then
    Result:= nil;
end; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T17:09:40.737

我想为您当前的解决方案添加一些评论，在这里回答，因为这在评论部分实际上无法做到：

```
type
  IComponentFrobber = interface
  end;

  TComponentFrobberClass = class of TComponentFrobber;

  TComponentFrobber = class(TInterfacedObject, IComponentFrobber)
  strict private
    FComponent: TComponent;
  protected
    constructor Create(AComponent: TComponent);
    property Component: TComponent read FComponent;
  public
    class function FindFrobberClass(AComponentClass: TComponentClass):
      TComponentFrobberClass; overload; static;
    class function FindFrobberClass(AComponent: TComponent):
      TComponentFrobberClass; overload; static;
    class procedure RegisterFrobber(AComponentClass: TComponentClass;
      AFrobberClass: TComponentFrobberClass); static;
  end; 
```

将 TInterfacedObject 用于基类没有多大意义，因为您将始终需要对象，而不是它实现的接口——否则您将如何找到具体的 Frobber 类？我会将它拆分为 TComponentFrobber，从 TInterfacedObject 下降，以及具有类方法的 TComponentRegistry 类（从 TObject 下降）。然后，您当然可以使注册表类更通用，它不绑定到 TComponentFrobber 并且可以重用。

**编辑：**例如在加载文件时，我使用了类似的类注册表：加载下一个对象的标识符（例如字符串、整数或 GUID），然后从注册表中获取正确的类以实例化，然后创建并加载对象.

```
type
  TComponentFrobberRegistryItem = record
    ComponentClass: TComponentClass;
    FrobberClass: TComponentFrobberClass;
  end;

var
  FComponentFrobberRegistry: array of TComponentFrobberRegistryItem; 
```

如果您永远不会在注册表中添加或删除类，这是可以的，但通常我不会使用数组而是注册表条目的列表。

```
class function TComponentFrobber.FindFrobberClass(AComponentClass: TComponentClass):
  TComponentFrobberClass;
var
  i: Integer;
begin
  // Search backwards, so that more specialized frobbers are found first:
  for i := High(FComponentFrobberRegistry) downto Low(FComponentFrobberRegistry) do
    if FComponentFrobberRegistry[i].ComponentClass = AComponentClass then
    begin
      Result := FComponentFrobberRegistry[i].FrobberClass;
      Exit;
    end;
  Result := nil;
end; 
```

在数组中向后搜索将无助于找到最专业的 frobber，除非您以正确的顺序添加它们（首先是最不专业的）。为什么不检查 ClassType 是否相等？如果您也需要测试基类，还有 ClassParent 可以遍历类层次结构。

# ruby-on-rails - 在选择框更改时更改布局

> ID：503084
> 
> 赞同：2
> 
> 时间：2009-02-02T12:48:44.227
> 
> 标签：ruby-on-rails, prototype

我想根据选择框中的选择来渲染部分内容。这看起来微不足道，但我找不到一个例子。

非常感谢所有帮助。

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T16:19:20.853

如果您只是尝试在表单提交的页面上呈现部分内容，

```
<%= render :partial => params[:your_selectbox_value_matching_the_partial_you_want] %> 
```

因此，如果您有一个选择框，例如

```
<select name='the_partial'>
    <input value="partial1">Some Partial</input>
    <input value="partial2">Another Partial</input>
</select> 
```

你需要渲染

```
<%= render :partial => params[:the_partial] %> 
```

假设您的视图文件夹中有 _partial1.html.erb 和 partial2.html.erb

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T14:15:18.903

我会从这样的事情开始：

```
app/views/_layout_selector.html.erb:
<form action="<%= request.request_uri -%>">
  <select name='layout'>
    <input value="blue">Blue</input>
    <input value="pink">Pink</input>
    <input value="green">Green</input>
  </select>
</form>

app/views/layouts/blue.html.erb:
<html>
  ...
  <%= render :partial => '/layout_selector' %>
  ...
</html>

(/app/views/layouts/pink.html.erb and green.html.erb similar)

app/controllers/application.rb:
class ApplicationController < ActionController::Base
  DEFAULT_LAYOUT = 'blue'
  layout :pick_layout
  ...
  private
  def pick_layout
    params[:layout] || DEFAULT
  end
end 
```

# javascript - 如何重定向到另一个网页？

> ID：503093
> 
> 赞同：7710
> 
> 时间：2009-02-02T12:54:16.867
> 
> 标签：javascript, jquery, redirect

如何使用 jQuery 或纯 JavaScript 将用户从一个页面重定向到另一个页面？

* * *

## 回答 #1

> 赞同：15815
> 
> 时间：2009-02-03T04:24:09.767

## 一个不是简单地使用 jQuery 重定向

jQuery 不是必需的，它[**`window.location.replace(...)`**](https://developer.mozilla.org/en-US/docs/Web/API/Location/replace)最好模拟 HTTP 重定向。

`window.location.replace(...)`比 using 更好`window.location.href`，因为`replace()`不会将原始页面保留在会话历史记录中，这意味着用户不会陷入永无止境的后退按钮惨败。

如果要模拟某人单击链接，请使用 **`location.href`**

如果要模拟 HTTP 重定向，请使用**`location.replace`**

**例如：**

```
// similar behavior as an HTTP redirect
window.location.replace("http://stackoverflow.com");

// similar behavior as clicking on a link
window.location.href = "http://stackoverflow.com"; 
```

* * *

## 回答 #2

> 赞同：1790
> 
> 时间：2009-10-28T16:35:36.547

**警告：**此答案仅作为一种可能的解决方案提供；这显然*不是*最好的解决方案，因为它需要 jQuery。相反，更喜欢纯 JavaScript 解决方案。

```
$(location).prop('href', 'http://stackoverflow.com') 
```

* * *

## 回答 #3

> 赞同：795
> 
> 时间：2012-07-27T14:41:13.373

# 重定向页面的标准“香草”JavaScript 方式

```
window.location.href = 'newPage.html'; 
```

## 或者更简单地说：（因为`window`是全球性的）

```
location.href = 'newPage.html'; 
```

* * *

> **如果您在这里是因为在重定向时*丢失了*HTTP_REFERER，请继续阅读：**
> 
> （否则忽略这最后一部分）

* * *

以下部分适用于那些使用`HTTP_REFERER`许多安全措施之一的人（尽管它不是一个很好的保护措施）。如果您使用的是[Internet Explorer 8](http://en.wikipedia.org/wiki/Internet_Explorer_8)或更低版本，则在使用任何形式的 JavaScript 页面重定向（location.href 等）时，这些变量会丢失。

下面我们将为**IE8 及更低版本**实现一个替代方案，这样我们就不会丢失 HTTP_REFERER。否则，您几乎总是可以简单地使用`window.location.href`.

针对`HTTP_REFERER`（URL 粘贴、会话等）的测试*可以*帮助判断请求是否合法。 *（**注意：**还有一些方法可以解决/欺骗这些引荐来源网址，正如评论中的 droop 链接所指出的那样）*

* * *

简单的跨浏览器测试解决方案（回退到 Internet Explorer 9+ 和所有其他浏览器的 window.location.href）

**用法：`redirect('anotherpage.aspx');`**

```
function redirect (url) {
    var ua        = navigator.userAgent.toLowerCase(),
        isIE      = ua.indexOf('msie') !== -1,
        version   = parseInt(ua.substr(4, 2), 10);

    // Internet Explorer 8 and lower
    if (isIE && version < 9) {
        var link = document.createElement('a');
        link.href = url;
        document.body.appendChild(link);
        link.click();
    }

    // All other browsers can use the standard window.location.href (they don't lose HTTP_REFERER like Internet Explorer 8 & lower does)
    else { 
        window.location.href = url; 
    }
} 
```

* * *

## 回答 #4

> 赞同：480
> 
> 时间：2014-01-28T04:28:26.867

有很多方法可以做到这一点。

```
// window.location
window.location.replace('http://www.example.com')
window.location.assign('http://www.example.com')
window.location.href = 'http://www.example.com'
document.location.href = '/path'

// window.history
window.history.back()
window.history.go(-1)

// window.navigate; ONLY for old versions of Internet Explorer
window.navigate('top.jsp')

// Probably no bueno
self.location = 'http://www.example.com';
top.location = 'http://www.example.com';

// jQuery
$(location).attr('href','http://www.example.com')
$(window).attr('location','http://www.example.com')
$(location).prop('href', 'http://www.example.com') 
```

* * *

## 回答 #5

> 赞同：361
> 
> 时间：2010-10-22T23:45:30.560

这适用于每个浏览器：

```
window.location.href = 'your_url'; 
```

* * *

## 回答 #6

> 赞同：318
> 
> 时间：2009-02-02T13:18:06.320

如果您对您正在尝试做的事情更具描述性，那将会有所帮助。如果您尝试生成分页数据，则可以选择一些方法来执行此操作。您可以为希望能够直接访问的每个页面生成单独的链接。

```
<a href='/path-to-page?page=1' class='pager-link'>1</a>
<a href='/path-to-page?page=2' class='pager-link'>2</a>
<span class='pager-link current-page'>3</a>
... 
```

请注意，示例中的当前页面在代码和 CSS 中的处理方式不同。

如果您希望通过 AJAX 更改分页数据，这就是 jQuery 的用武之地。您要做的是将单击处理程序添加到对应于不同页面的每个锚标记。此单击处理程序将调用一些 jQuery 代码，该代码通过 AJAX 获取下一页并使用新数据更新表。下面的示例假设您有一个返回新页面数据的 Web 服务。

```
$(document).ready( function() {
    $('a.pager-link').click( function() {
        var page = $(this).attr('href').split(/\?/)[1];
        $.ajax({
            type: 'POST',
            url: '/path-to-service',
            data: page,
            success: function(content) {
               $('#myTable').html(content);  // replace
            }
        });
        return false; // to stop link
    });
}); 
```

* * *

## 回答 #7

> 赞同：271
> 
> 时间：2013-04-25T10:12:24.457

我也认为这`location.replace(URL)`是最好的方法，但是如果您想通知搜索引擎您的重定向（他们不分析 JavaScript 代码来查看重定向），您应该将`rel="canonical"`元标记添加到您的网站。

添加一个带有 HTML 刷新元标记的 noscript 部分也是一个很好的解决方案。我建议你使用这个[JavaScript 重定向工具](http://insider.zone/tools/client-side-url-redirect-generator/ "客户端 URL 重定向代码生成器")来创建重定向。它还支持 Internet Explorer 以传递 HTTP 引荐来源网址。

没有延迟的示例代码如下所示：

```
<!-- Place this snippet right after opening the head tag to make it work properly -->

<!-- This code is licensed under GNU GPL v3 -->
<!-- You are allowed to freely copy, distribute and use this code, but removing author credit is strictly prohibited -->
<!-- Generated by http://insider.zone/tools/client-side-url-redirect-generator/ -->

<!-- REDIRECTING STARTS -->
<link rel="canonical" href="https://yourdomain.com/"/>
<noscript>
    <meta http-equiv="refresh" content="0;URL=https://yourdomain.com/">
</noscript>
<!--[if lt IE 9]><script type="text/javascript">var IE_fix=true;</script><![endif]-->
<script type="text/javascript">
    var url = "https://yourdomain.com/";
    if(typeof IE_fix != "undefined") // IE8 and lower fix to pass the http referer
    {
        document.write("redirecting..."); // Don't remove this line or appendChild() will fail because it is called before document.onload to make the redirect as fast as possible. Nobody will see this text, it is only a tech fix.
        var referLink = document.createElement("a");
        referLink.href = url;
        document.body.appendChild(referLink);
        referLink.click();
    }
    else { window.location.replace(url); } // All other browsers
</script>
<!-- Credit goes to http://insider.zone/ -->
<!-- REDIRECTING ENDS --> 
```

* * *

## 回答 #8

> 赞同：238
> 
> 时间：2012-10-30T12:15:29.597

但是如果有人想重定向回主页，那么他可以使用以下代码段。

```
window.location = window.location.host 
```

如果您拥有三个不同的环境（开发、登台和生产），那将会很有帮助。

您只需将这些词放在 Chrome 控制台或[Firebug](http://en.wikipedia.org/wiki/Firebug_%28software%29)的控制台中即可探索此 window 或 window.location 对象。

* * *

## 回答 #9

> 赞同：222
> 
> 时间：2013-12-23T13:35:15.603

JavaScript 为您提供了许多方法来检索和更改显示在浏览器地址栏中的当前 URL。所有这些方法都使用 Location 对象，它是 Window 对象的一个​​属性。您可以创建一个具有当前 URL 的新 Location 对象，如下所示。

```
var currentLocation = window.location; 
```

**URL的基本结构**

```
<protocol>//<hostname>:<port>/<pathname><search><hash> 
```

![在此处输入图像描述](https://i.stack.imgur.com/4kiBE.jpg)

1.  协议——指定用于访问 Internet 上的资源的协议名称。（HTTP（无 SSL）或 HTTPS（有 SSL））

2.  主机名——主机名指定拥有资源的主机。例如，www.stackoverflow.com。服务器使用主机名提供服务。

3.  port -- 一个端口号，用于识别 Internet 或其他网络消息到达服务器时要转发到的特定进程。

4.  路径名——路径提供有关 Web 客户端想要访问的主机中的特定资源的信息。例如，stackoverflow.com/index.html。

5.  查询——查询字符串跟随路径组件，并提供资源可用于某些目的的信息字符串（例如，作为搜索的参数或作为要处理的数据）。

6.  hash -- URL 的锚点部分，包括井号 (#)。

使用这些 Location 对象属性，您可以访问所有这些 URL 组件

1.  **hash** - 设置或返回 URL 的锚点部分。
2.  **host** - 设置或返回 URL 的主机名和端口。
3.  **主机名** - 设置或返回 URL 的主机名。
4.  **href** - 设置或返回整个 URL。
5.  **pathname** - 设置或返回 URL 的路径名。
6.  **port** - 设置或返回服务器用于 URL 的端口号。
7.  **协议** - 设置或返回 URL 的协议。
8.  **search** - 设置或返回 URL 的查询部分

现在，如果您想更改页面或将用户重定向到其他页面，您可以使用`href`Location 对象的属性，如下所示

您可以使用 Location 对象的 href 属性。

```
window.location.href = "http://www.stackoverflow.com"; 
```

**Location Object**也有这三个方法

1.  **assign()** -- 加载一个新文档。
2.  **reload()** -- 重新加载当前文档。
3.  **replace()** -- 用新文档替换当前文档

您还可以使用 assign() 和 replace 方法重定向到其他页面，例如这些

```
location.assign("http://www.stackoverflow.com");

location.replace("http://www.stackoverflow.com"); 
```

***assign() 和 replace() 有何不同****-- replace() 方法和 assign() 方法() 的区别在于 replace() 从文档历史记录中删除当前文档的 URL，意味着不能使用“返回”按钮导航回原始文档。因此，如果您想加载一个新文档，并希望提供导航回原始文档的选项，请使用 assign() 方法。*

您也可以像这样使用**jQuery**更改位置对象 href 属性

```
$(location).attr('href',url); 
```

因此，您可以将用户重定向到其他一些 url。

* * *

## 回答 #10

> 赞同：212
> 
> 时间：2017-02-26T13:36:49.213

基本上**jQuery**只是一个**JavaScript**框架，在这种情况下，为了做一些事情，比如**重定向**，你可以只使用纯 JavaScript，所以在这种情况下，你有 3 个使用 vanilla JavaScript 的选项：

1）使用 location **replace**，这将替换页面的当前历史记录，意味着无法使用**返回**按钮返回到原始页面。

```
window.location.replace("http://stackoverflow.com"); 
```

2）使用 location **assign**，这将为您保留历史记录，并使用后退按钮，您可以返回原始页面：

```
window.location.assign("http://stackoverflow.com"); 
```

3）我建议使用之前的方法之一，但这可能是使用纯 JavaScript 的第三个选项：

```
window.location.href="http://stackoverflow.com"; 
```

您也可以在 jQuery 中编写一个函数来处理它，但不推荐，因为它只有一行纯 JavaScript 函数，如果您已经在窗口范围内，您也可以在没有窗口的情况下使用上述所有函数，例如`window.location.replace("http://stackoverflow.com");`可以是`location.replace("http://stackoverflow.com");`

我也将它们全部显示在下图中：

[![location.replace location.assign](https://i.stack.imgur.com/ODheM.jpg)](https://i.stack.imgur.com/ODheM.jpg)

* * *

## 回答 #11

> 赞同：200
> 
> 时间：2014-02-16T14:42:55.533

应该只能使用`window.location`.

**例子：**

```
window.location = "https://stackoverflow.com/"; 
```

这是有关该主题的过去帖子：[如何重定向到另一个网页？](https://stackoverflow.com/questions/503093/how-can-i-make-a-redirect-page-in-jquery-javascript)

* * *

## 回答 #12

> 赞同：176
> 
> 时间：2014-08-27T21:50:35.843

**在开始之前，jQuery 是一个用于 DOM 操作的 JavaScript 库。所以你不应该使用 jQuery 进行页面重定向。**

来自 Jquery.com 的报价：

> 虽然 jQuery 在旧浏览器版本中运行可能不会出现重大问题，但我们不会在其中积极测试 jQuery，并且通常不会修复其中可能出现的错误。

在这里找到： [https ://jquery.com/browser-support/](https://jquery.com/browser-support/)

因此，jQuery 并不是向后兼容的终极解决方案。

以下使用原始 JavaScript 的解决方案适用于所有浏览器，并且长期以来一直是标准的，因此您不需要任何库来支持跨浏览器。

此页面将在 3000 毫秒后重定向到**[Google](http://www.google.com)**

```
<!DOCTYPE html>
<html>
    <head>
        <title>example</title>
    </head>
    <body>
        <p>You will be redirected to google shortly.</p>
        <script>
            setTimeout(function(){
                window.location.href="http://www.google.com"; // The URL that will be redirected too.
            }, 3000); // The bigger the number the longer the delay.
        </script>
    </body>
</html> 
```

不同的选项如下：

```
window.location.href="url"; // Simulates normal navigation to a new page
window.location.replace("url"); // Removes current URL from history and replaces it with a new URL
window.location.assign("url"); // Adds new URL to the history stack and redirects to the new URL

window.history.back(); // Simulates a back button click
window.history.go(-1); // Simulates a back button click
window.history.back(-1); // Simulates a back button click
window.navigate("page.html"); // Same as window.location="url" 
```

使用替换时，后退按钮不会回到重定向页面，就好像它从未出现在历史记录中一样。如果您希望用户能够返回重定向页面，请使用`window.location.href`或`window.location.assign`。如果您确实使用了让用户返回重定向页面的选项，请记住，当您进入重定向页面时，它会将您重定向回来。因此，在为您的重定向选择选项时要考虑到这一点。在页面仅在用户完成操作时重定向的情况下，将页面放在后退按钮历史记录中就可以了。但是如果页面自动重定向，那么您应该使用替换，以便用户可以使用后退按钮而不会被迫返回重定向发送的页面。

您还可以使用元数据来运行页面重定向，如下所示。

**元刷新**

```
<meta http-equiv="refresh" content="0;url=http://evil.com/" /> 
```

**元位置**

```
<meta http-equiv="location" content="URL=http://evil.com" /> 
```

**基地劫持**

```
<base href="http://evil.com/" /> 
```

在此页面上可以找到更多将您毫无戒心的客户端重定向到他们可能不希望访问的页面的方法（其中不依赖于 jQuery）：

> [https://code.google.com/p/html5security/wiki/RedirectionMethods](https://code.google.com/p/html5security/wiki/RedirectionMethods)

我还想指出，人们不喜欢被随机重定向。仅在绝对需要时重定向人员。如果您开始随机重定向人们，他们将永远不会再访问您的网站。

下一段是假设的：

您也可能被报告为恶意网站。如果发生这种情况，那么当人们单击指向您网站的链接时，用户浏览器可能会警告他们您的网站是恶意的。如果人们在您的网站上报告糟糕的体验，搜索引擎也可能会开始降低您的评分。

请查看有关重定向的 Google 网站管理员指南： https: [//support.google.com/webmasters/answer/2721217?hl=en&ref_topic=6001971](https://support.google.com/webmasters/answer/2721217?hl=en&ref_topic=6001971)

这是一个有趣的小页面，可将您踢出页面。

```
<!DOCTYPE html>
<html>
    <head>
        <title>Go Away</title>
    </head>
    <body>
        <h1>Go Away</h1>
        <script>
            setTimeout(function(){
                window.history.back();
            }, 3000);
        </script>
    </body>
</html> 
```

如果您将两个页面示例组合在一起，您将拥有一个重新路由的婴儿循环，这将保证您的用户永远不会想要再次使用您的网站。

* * *

## 回答 #13

> 赞同：174
> 
> 时间：2009-10-13T09:36:37.837

```
var url = 'asdf.html';
window.location.href = url; 
```

* * *

## 回答 #14

> 赞同：149
> 
> 时间：2012-05-23T13:03:23.500

你可以在没有 jQuery 的情况下做到这一点：

```
window.location = "http://yourdomain.com"; 
```

如果你只想要 jQuery，那么你可以这样做：

```
$jq(window).attr("location","http://yourdomain.com"); 
```

* * *

## 回答 #15

> 赞同：147
> 
> 时间：2011-09-05T17:25:09.870

这适用于 jQuery：

```
$(window).attr("location", "http://google.fr"); 
```

* * *

## 回答 #16

> 赞同：96
> 
> 时间：2014-02-06T10:28:57.513

**# 使用 jQuery/JavaScript 方法的 HTML 页面重定向**

试试这个示例代码：

```
function YourJavaScriptFunction()
{
    var i = $('#login').val();
    if (i == 'login')
        window.location = "Login.php";
    else
        window.location = "Logout.php";
} 
```

如果您想提供完整的 URL 为**`window.location = "www.google.co.in";`**.

* * *

## 回答 #17

> 赞同：88
> 
> 时间：2014-12-26T19:08:21.787

**原始问题：** “如何使用 jQuery 重定向？”，因此答案实现了 jQuery >> 免费用例。

* * *

仅使用 JavaScript 重定向到页面：

```
window.location.href = "/contact/"; 
```

或者，如果您需要延迟：

```
setTimeout(function () {
  window.location.href = "/contact/";
}, 2000);   // Time in milliseconds 
```

jQuery 允许您轻松地从网页中选择元素。您可以在页面上找到您想要的任何内容，然后使用 jQuery 来添加特殊效果、对用户操作做出反应，或者在您选择的元素内部或外部显示和隐藏内容。所有这些任务都从知道[如何选择元素或事件](http://learn.jquery.com/using-jquery-core/selecting-elements/)开始。

```
$('a,img').on('click',function(e){
  e.preventDefault();
  $(this).animate({
    opacity: 0 //Put some CSS animation here
  }, 500);
  setTimeout(function(){
    // OK, finished jQuery staff, let's go redirect
    window.location.href = "/contact/";
  },500);
}); 
```

想象一下有人用 10000 行代码编写了一个脚本/插件。使用 jQuery，您只需一两行即可连接到此代码。

* * *

## 回答 #18

> 赞同：81
> 
> 时间：2014-01-27T10:11:14.480

您需要将此行放入您的代码中：

```
$(location).attr("href","http://stackoverflow.com"); 
```

如果您没有 jQuery，请使用 JavaScript：

```
window.location.replace("http://stackoverflow.com");
window.location.href("http://stackoverflow.com"); 
```

* * *

## 回答 #19

> 赞同：80
> 
> 时间：2013-08-30T23:46:33.333

所以，问题是如何制作重定向页面，而不是如何重定向到网站？

您只需要为此使用 JavaScript。这是一些将创建动态重定向页面的小代码。

```
<script>
    var url = window.location.search.split('url=')[1]; // Get the URL after ?url=
    if( url ) window.location.replace(url);
</script> 
```

所以说你只是把这个片段放到`redirect/index.html`你网站上的一个文件中，你可以像这样使用它。

> `http://www.mywebsite.com/redirect?url=http://stackoverflow.com`

如果您转到该链接，它会自动将您重定向到**stackoverflow.com**。

> **[链接到文档](https://developer.mozilla.org/en-US/docs/Web/API/window.location)**

**这就是您使用 JavaScript制作*简单重定向页面的方式***

编辑：

还有一点需要注意。我已经`window.location.replace`在我的代码中添加了，因为我认为它适合重定向页面，但是，你必须知道，当你使用`window.location.replace`并且你被重定向时，当你在浏览器中按下后退按钮时，它**不会**回到重定向页面，它会回到之前的页面，看看这个小演示的东西。

例子：

> 过程：**商店首页**=>**将页面重定向到谷歌**=>**谷歌**
> 
> 在谷歌时：**谷歌**=>**浏览器中的后退按钮**=>**商店主页**

因此，如果这符合您的需求，那么一切都应该没问题。如果您想在浏览器历史记录中包含重定向页面，请替换此

```
if( url ) window.location.replace(url); 
```

和

```
if( url ) window.location.href = url; 
```

* * *

## 回答 #20

> 赞同：78
> 
> 时间：2012-11-14T02:17:49.447

在您的点击功能上，只需添加：

```
window.location.href = "The URL where you want to redirect";
$('#id').click(function(){
    window.location.href = "http://www.google.com";
}); 
```

* * *

## 回答 #21

> 赞同：64
> 
> 时间：2013-11-19T04:01:10.757

试试这个：

```
location.assign("http://www.google.com"); 
```

[示例代码片段](http://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_loc_assign)。

* * *

## 回答 #22

> 赞同：60
> 
> 时间：2013-07-11T17:40:31.137

不需要 jQuery。你可以这样做：

```
window.open("URL","_self","","") 
```

就是这么容易！

发起 HTTP 请求的最佳方式是使用`document.loacation.href.replace('URL')`.

* * *

## 回答 #23

> 赞同：54
> 
> 时间：2013-06-06T12:37:35.987

先正确写。您想在应用程序中导航到另一个链接，从您的应用程序中导航到另一个链接。这是代码：

```
window.location.href = "http://www.google.com"; 
```

如果你想在你的应用程序中导航页面，那么我也有代码，如果你愿意的话。

* * *

## 回答 #24

> 赞同：54
> 
> 时间：2014-09-05T16:36:44.607

您可以像这样在 jQuery 中重定向：

```
$(location).attr('href', 'http://yourPage.com/'); 
```

* * *

## 回答 #25

> 赞同：54
> 
> 时间：2017-02-23T23:01:28.413

# 使用 JavaScript：

### 方法一：

```
window.location.href="http://google.com"; 
```

### 方法二：

```
window.location.replace("http://google.com"); 
```

* * *

# 使用 jQuery：

### 方法一：$(location)

```
$(location).attr('href', 'http://google.com'); 
```

### 方法二：可重用函数

```
jQuery.fn.redirectTo = function(url){
    window.location.href = url;
}

jQuery(window).redirectTo("http://google.com"); 
```

* * *

## 回答 #26

> 赞同：47
> 
> 时间：2013-07-01T04:11:27.447

在 JavaScript 和 jQuery 中，我们可以使用以下代码将一个页面重定向到另一个页面：

```
window.location.href="http://google.com";
window.location.replace("page1.html"); 
```

* * *

## 回答 #27

> 赞同：46
> 
> 时间：2015-05-22T05:18:11.670

Javascript：

```
window.location.href='www.your_url.com';
window.top.location.href='www.your_url.com';
window.location.replace('www.your_url.com'); 
```

查询：

```
var url='www.your_url.com';
$(location).attr('href',url);
$(location).prop('href',url);//instead of location you can use window 
```

* * *

## 回答 #28

> 赞同：46
> 
> 时间：2016-04-13T16:23:25.817

# ECMAScript 6 + jQuery，85 字节

```
$({jQueryCode:(url)=>location.replace(url)}).attr("jQueryCode")("http://example.com") 
```

请不要杀我，这是一个笑话。这是个笑话。*这是个玩笑。*

这确实“提供了对问题的答案”，因为它要求“使用 jQuery”的解决方案，在这种情况下需要以某种方式强制它进入等式。

Ferrybig 显然需要解释这个笑话（还是在开玩笑，我敢肯定评论表上的选项有限），所以事不宜迟：

其他答案是不必要地`attr()`在`location`or对象上使用 jQuery 。`window`

这个答案也滥用了它，但以一种更荒谬的方式。这不是使用它来设置位置，而是`attr()`用于检索设置位置的函数。

`jQueryCode`即使没有关于它的任何 jQuery，该函数也会被命名，并且调用函数`somethingCode`非常可怕，尤其是当某些东西甚至不是一种语言时。

“85 bytes”是对 Code Golf 的引用。打高尔夫球显然不是你应该在代码高尔夫球之外做的事情，而且这个答案显然不是真正的打高尔夫球。

基本上，畏缩。

* * *

## 回答 #29

> 赞同：45
> 
> 时间：2018-03-30T11:43:31.050

JavaScript 非常广泛。如果你想跳转到另一个页面，你有三个选项。

```
 window.location.href='otherpage.com';
 window.location.assign('otherpage.com');
 //and...

 window.location.replace('otherpage.com'); 
```

当您想移动到另一个页面时，如果这是您的要求，您可以使用其中的任何一个。然而，所有三个选项都限于不同的情况。根据您的要求明智地选择。

如果您对有关该概念的更多知识感兴趣，可以进一步了解。

```
window.location.href; // Returns the href (URL) of the current page
window.location.hostname; // Returns the domain name of the web host
window.location.pathname; // Returns the path and filename of the current page
window.location.protocol; // Returns the web protocol used (http: or https:)
window.location.assign; // Loads a new document
window.location.replace; // RReplace the current location with new one. 
```

* * *

## 回答 #30

> 赞同：44
> 
> 时间：2013-11-29T00:49:45.547

这是一个延时重定向。您可以将延迟时间设置为任何您想要的：

```
<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Your Document Title</title>
    <script type="text/javascript">
        function delayer(delay) {
            onLoad = setTimeout('window.location.href = "http://www.google.com/"', delay);
        }
    </script>
</head>

<body>
    <script>
        delayer(8000)
    </script>
    <div>You will be redirected in 8 seconds!</div>
</body>

</html> 
```

* * *

## 回答 #31

> 赞同：41
> 
> 时间：2014-07-07T00:54:58.573

有三种主要方法可以做到这一点，

```
window.location.href='blaah.com';
window.location.assign('blaah.com'); 
```

和...

```
window.location.replace('blaah.com'); 
```

对于传统的重定向，最后一个是最好的，因为它不会保存您在搜索历史中重定向之前访问的页面。但是，如果您只想使用 JavaScript 打开选项卡，则可以使用上述任何方法。[1](http://basicuse.net/tips/pl/scripting_languages/javascript/how_to_make_a_page_redirect_in_javascript)

编辑：`window`前缀是可选的。

* * *

## 回答 #32

> 赞同：40
> 
> 时间：2015-02-28T15:42:44.790

我只需要用另一种更新的 jQuery 方法来更新这种荒谬：

```
var url = 'http://www.fiftywaystoleaveyourlocation.com';
$(location).prop('href', url); 
```

* * *

## 回答 #33

> 赞同：37
> 
> 时间：2013-06-10T16:04:57.330

在 PHP、HTML 或 jQuery 部分之后编写以下代码。如果在 PHP 或 HTML 部分的中间，则使用 <script> 标记。

```
location.href = "http://google.com" 
```

* * *

## 回答 #34

> 赞同：36
> 
> 时间：2016-03-03T10:50:15.220

## 用于重定向页面或 URL 的 jQuery 代码

> **第一种方式**

这是用于重定向页面的 jQuery 代码。因为，我已将此代码放在 $(document).ready() 函数中，所以它会在页面加载后立即执行。

```
var url = "http://stackoverflow.com";
$(location).attr('href',url);
```

您甚至可以将 URL 直接传递给**attr()**方法，而不是使用变量。

> **第二种方式**

```
 window.location.href="http://stackoverflow.com"; 
```

您也可以这样编码（两者内部相同）：

```
window.location="http://stackoverflow.com"; 
```

如果您对 window.location 和 之间的区别感到好奇`window.location.href`，那么您可以看到后者是`href`显式设置属性，而前者是隐式设置。由于`window.location`返回一个对象，默认情况下设置其`.href`属性。

> **第三条路**

还有另一种使用 JavaScript 重定向页面的`replace()`方法，即`window.location`object 方法。您可以将新 URL 传递给该`replace()`方法，它将模拟 HTTP 重定向。顺便说一句，请记住该`window.location.replace()`方法不会将原始页面放入会话历史记录中，这可能会影响后退按钮的行为。有时，它是你想要的，所以小心使用它。

```
// Doesn't put originating page in history
window.location.replace("http://stackoverflow.com");
```

> **第四路**

like **attr()**方法（jQuery 1.6 引入后）

```
var url = "http://stackoverflow.com";
$(location).prop('href', url);
```

* * *

## 回答 #35

> 赞同：32
> 
> 时间：2016-12-13T10:43:32.770

在**jQuery**中，使用`$(location).attr('href', url)`：

```
$(document).ready(function(){
    var url = "https://www.youtube.com/watch?v=JwMKRevYa_M";
    $(location).attr('href', url); // Using this
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

在*原始* **JavaScript**中，有多种方法可以实现：

```
window.location.href="https://www.youtube.com/watch?v=JwMKRevYa_M"; 
```

- 明确设置 href 属性。

```
window.location = "http://www.GameOfThrones.com"; 
```

- 它是隐式的因为 window.location 返回一个对象，默认情况下设置它的 .href 属性。

```
window.location.replace("http://www.stackoverflow.com"); 
```

- 用新窗口替换当前窗口的位置。

```
self.location = "http://www.somewebsite.com"; 
```

- 设置当前窗口本身的位置。

下面是一个特定时间（3 秒）后 JavaScript 重定向的示例：

```
<script>
    setTimeout(function() {
        window.location.href = "https://www.youtube.com/";
    }, 3000);
</script>
```

* * *

## 回答 #36

> 赞同：26
> 
> 时间：2015-12-04T16:41:44.997

在 JavaScript 和 jQuery 中，我们使用以下代码来重定向页面：

```
window.location.href="http://google.com";
window.location.replace("page1.html"); 
```

但是你可以在 jQuery 中创建一个函数来重定向页面：

```
jQuery.fn.redirect=function(url)
{
    window.location.href=url;
} 
```

并调用此函数：

```
jQuery(window).redirect("http://stackoverflow.com/") 
```

* * *

## 回答 #37

> 赞同：25
> 
> 时间：2014-09-11T15:43:08.340

使用 jQuery 函数：

```
$.extend({
  redirectPost: function(location, args) {
    var form = '';
    $.each(args, function(key, value) {
      form += '<input type="hidden" name="' + key + '" value="' + value + '">';
    });
    $('<form action="' + location + '" method="POST">' + form + '</form>').appendTo($(document.body)).submit();
  }
}); 
```

在您的代码中，您可以像这样使用它：

```
$.redirectPost("addPhotos.php", {pimreference:  $("#pimreference").val(), tag: $("#tag").val()}); 
```

* * *

## 回答 #38

> 赞同：24
> 
> 时间：2015-06-16T12:01:53.377

只需在**JavaScript**中，您可以使用以下命令重定向到特定页面：

```
window.location.replace("http://www.test.com"); 
```

或者

```
location.replace("http://www.test.com"); 
```

或者

```
window.location.href = "http://www.test.com"; 
```

**使用 jQuery：**

```
$(window).attr("location","http://www.test.com"); 
```

* * *

## 回答 #39

> 赞同：20
> 
> 时间：2013-12-10T10:09:27.350

您可以像在下面的代码中一样使用它，`getRequestToForwardPage`请求映射 ( [URL](http://en.wikipedia.org/wiki/Uniform_Resource_Locator) ) 在哪里。您也可以使用您的网址。

```
function savePopUp(){
    $.blockUI();
    $.ajax({
        url:"GuestHouseProcessor?roomType="+$("#roomType").val(),
        data: $("#popForm").serialize(),
        dataType: "json",
        error: (function() {
            alert("Server Error");
            $.unblockUI();
    }),
    success: function(map) {
        $("#layer1").hide();
        $.unblockUI();
        window.location = "getRequestToForwardPage";
    }
}); 
```

这适用于应用程序的相同上下文。

如果您只想使用特定于 jquery 的代码，那么以下代码可能会有所帮助：

```
 $(location).attr('href',"http://www.google.com");
 $jq(window).attr("location","http://www.google.com");
 $(location).prop('href',"http://www.google.com"); 
```

* * *

## 回答 #40

> 赞同：18
> 
> 时间：2014-01-29T10:20:32.723

```
<script type="text/javascript">
var url = "https://yourdomain.com";

// IE8 and lower fix
if (navigator.userAgent.match(/MSIE\s(?!9.0)/))
{
    var referLink = document.createElement("a");
    referLink.href = url;
    document.body.appendChild(referLink);
    referLink.click();
}

// All other browsers
else { window.location.replace(url); }
</script> 
```

* * *

## 回答 #41

> 赞同：18
> 
> 时间：2017-12-22T21:00:58.243

使用`location.replace()`将重定向您，但不保存上一页的历史记录。提交表单时最好使用它。

但是，当您想保留历史记录时，您必须使用`location.href=//path`.

**例子：**

```
// Form with steps
document.getElementById('#next').onclick = function() {
   window.location.href='/step2' // Iteration of steps;
}

// Go to next step
document.getElementById('#back').onclick = function() {
   window.history.back();
}

// Finish
document.getElementById('#finish').onclick = function() {
   window.location.href = '/success';
}

// On success page
window.onload = function() {
    setTimeout(function() {
       window.location.replace('/home'); // I can't go back to success page by pressing the back button
    },3000);
} 
```

* * *

## 回答 #42

> 赞同：16
> 
> 时间：2018-02-14T10:35:50.623

您可以在脚本部分中为按钮单击事件编写 Url.Action，如下所示。

```
function onclick() {
    location.href = '@Url.Action("Index", "Home")';
} 
```

* * *

## 回答 #43

> 赞同：15
> 
> 时间：2014-09-08T04:49:39.113

这是重定向到其他页面的代码，超时时间为 10 秒。

```
<script>
    function Redirect()
    {
        window.location="http://www.adarshkr.com";
    }

    document.write("You will be redirected to a new page in 10 seconds.");
    setTimeout('Redirect()', 10000);
</script> 
```

您也可以这样做，使用 location.assign 单击按钮：

```
<input type="button" value="Load new document" onclick="newPage()">
<script>
    function newPage() {
        window.location.assign("http://www.adarshkr.com")
    }
</script> 
```

* * *

## 回答 #44

> 赞同：15
> 
> 时间：2016-09-30T12:15:08.260

这很容易实现。您可以使用：

```
window.location.href = "http://www.example.com/"; 
```

这将记住上一页的历史记录。因此，可以通过单击浏览器的后退按钮返回。

或者：

```
window.location.replace("http://www.example.com/"); 
```

此方法不记住前一页的历史记录。在这种情况下，后退按钮将被禁用。

* * *

## 回答 #45

> 赞同：15
> 
> 时间：2018-02-17T20:31:42.390

如果您更喜欢使用纯 JavaScript，我意识到在 Firefox 中使用 of`document.location.href = "https://example.com"`或`window.location.href = "https://example.com"`会导致兼容性问题。而是尝试使用：

```
location.href = "https://example.com";
location.replace("http://example.com"); 
```

在我的情况下已经解决了这个问题。祝你好运！

* * *

## 回答 #46

> 赞同：14
> 
> 时间：2016-08-29T06:38:19.110

您可以使用：

```
window.location.replace("http://www.example.com/"); 
```

该`replace()`方法不会将原始页面保存在会话历史记录中，因此用户无法使用后退按钮返回并再次被重定向。注意：在这种情况下，浏览器后退按钮将被禁用。

但是，如果您想要与单击链接相同的效果，您应该选择：

```
window.location.href = "http://www.example.com/"; 
```

在这种情况下，浏览器后退按钮将处于活动状态。

* * *

## 回答 #47

> 赞同：14
> 
> 时间：2016-11-23T16:42:09.613

采用：

```
function redirect(a) {
    location = a
} 
```

并调用它：`redirect([url]);`

不需要`href`after `location`，因为它是隐含的。

* * *

## 回答 #48

> 赞同：14
> 
> 时间：2017-02-09T06:34:03.480

```
<script type="text/javascript">
    if(window.location.href === "http://stackoverflow.com") {      
         window.location.replace("https://www.google.co.in/");
       }
</script> 
```

* * *

## 回答 #49

> 赞同：14
> 
> 时间：2017-08-28T06:01:38.177

**单页申请**，在同一申请路线内

```
window.location.pathname = '/stack'; 
```

**JavaScript：**

```
location.href = "http://stack.com";
window.location = "http://stack.com"; 
```

**jQuery：**

```
$(location).attr('href', "http://www.stack.com");
$(window).attr('location', "http://www.stack.com"); 
```

**角 4**

```
import { Router } from '@angular/router';
export class NavtabComponent{
    constructor(private router: Router) {
    }
    this.router.navigate(['bookings/taxi']);
} 
```

* * *

## 回答 #50

> 赞同：13
> 
> 时间：2017-05-26T19:23:55.960

我只是添加另一种方式：

要将您网站的任何特定页面/链接重定向到另一个页面，只需添加以下代码行：

```
<script>
    if(window.location.href == 'old_url')
    {
        window.location.href="new_url";
    }

    // Another URL redirect
    if(window.location.href == 'old_url2')
    {
        window.location.href="new_url2";
    }
</script> 
```

举一个现实生活中的例子，

```
<script>
    if(window.location.href == 'https://old-site.com')
    {
        window.location.href="https://new-site.com";
    }

    // Another URL redirect
    if(window.location.href == 'https://old-site.com/simple-post.html')
    {
        window.location.href="https://new-site.com/simple-post.html";
    }
</script> 
```

通过使用这个简单的代码，您可以重定向整个站点或任何单个页面。

* * *

## 回答 #51

> 赞同：13
> 
> 时间：2017-06-27T09:36:11.403

1.  **位置分配（）：**

    通过将路径传递给它来分配路径路径。即使在分配路径之后，**Assign也会为您提供历史记录。**

    **使用方法：**值应该传入它。

    **例如：** `location.assign("http://google.com")`

    [![在此处输入图像描述](https://i.stack.imgur.com/FMfAy.png)](https://i.stack.imgur.com/FMfAy.png)

2.  **位置.href**

    可以定义进入它的路径......一旦设置它就会重定向到给定的路径，它会保留历史......

    **使用方法：**赋值给它。

    **例如：** `location.href = "http://google.com"`

3.  **位置.替换（）：**

    如果您不想保留历史记录，它将有助于替换路径。一旦你替换了它的路径，它就不会给你历史。

    **使用方法：**传入值。

    **例如：** `location.replace("http://google.com")`

    [![在此处输入图像描述](https://i.stack.imgur.com/bL4bM.jpg)](https://i.stack.imgur.com/bL4bM.jpg)

* * *

`assign()`和`href`相似，都可以保存历史。`assign`将通过传递一个值来工作，而 href 通过分配来工作。

您可以通过分配使用 JavaScript 本身而不使用 jQuery 来实现它，

```
window.location = "http://google.com"
location.href = "http://google.com" 
```

您可以使用 jQuery 实现类似的功能，如下所示。它将与上面完全相同，

```
$(window).attr('location', "http://www.google.com");
$(location).attr('href', "http://www.google.com"); 
```

你可以很容易地理解两者之间的区别......

这是位置对象，

[![来自 chrome 的位置 API](https://i.stack.imgur.com/no5kR.png)](https://i.stack.imgur.com/no5kR.png)

* * *

## 回答 #52

> 赞同：12
> 
> 时间：2016-10-24T09:26:27.183

您可以使用以下方法重定向页面：

1.  通过在头部使用元标记 - `<meta http-equiv="refresh" content="0;url=http://your-page-url.com" />`。请注意，`content="0;`... 用于在您需要重定向页面的秒数之后

2.  通过使用 JavaScript：`window.location.href = "http://your-page-url.com";`

3.  通过使用 jQuery：`$(location).attr('href', 'http://yourPage.com/');`

* * *

## 回答 #53

> 赞同：10
> 
> 时间：2016-06-16T16:26:58.033

我已经使用了 JavaScript 的函数 redirect()。它正在工作。

```
<script type="text/javascript">
    $(function () {
        //It's similar to HTTP redirect
        window.location.replace("http://www.Technomark.in");

        //It's similar to clicking on a link
        window.location.href = "Http://www.Technomark.in";
    })
</script> 
```

* * *

## 回答 #54

> 赞同：10
> 
> 时间：2017-07-19T11:01:02.533

如果您想简单地重定向到同一应用程序中的路线

```
window.location.pathname = '/examplepath' 
```

将是要走的路。

* * *

## 回答 #55

> 赞同：8
> 
> 时间：2016-03-04T07:22:54.647

从客户端进行重定向的所有方法：

```
<!DOCTYPE html>
<html>
    <head>
        <title>JavaScript and jQuery example to redirect a page or URL </title>
    </head>
    <body>
        <div id="redirect">
            <h2>Redirecting to another page</h2>
        </div>

        <script src="scripts/jquery-1.6.2.min.js"></script>
        <script>
            // JavaScript code to redirect a URL
            window.location.replace("http://stackoverflow.com");
            // window.location.replace('http://code.shouttoday.com');

            // Another way to redirect page using JavaScript

            // window.location.assign('http://code.shouttoday.com');
            // window.location.href = 'http://code.shouttoday.com';
            // document.location.href = '/relativePath';

            //jQuery code to redirect a page or URL
            $(document).ready(function(){
                //var url = "http://code.shouttoday.com";
                //$(location).attr('href',url);
                // $(window).attr('location',url)
                //$(location).prop('href', url)
            });
        </script>
    </body>
</html>
```

* * *

## 回答 #56

> 赞同：7
> 
> 时间：2014-09-29T13:43:10.143

**使用 jQuery/JavaScript 重定向用户**

通过在 jQuery 或 JavaScript 中使用位置对象，我们可以将用户重定向到另一个网页。

**在 jQuery 中**

将用户从一个页面重定向到另一个页面的代码是：

```
var url = 'http://www.example.com';
$(location).attr('href', url); 
```

**在 JavaScript 中**

将用户从一个页面重定向到另一个页面的代码是：

```
var url = 'http://www.example.com';
window.location.href = url; 
```

**或者**

```
var url = 'http://www.example.com';
window.location = url; 
```

* * *

## 回答 #57

> 赞同：6
> 
> 时间：2017-12-07T22:08:15.710

在我的工作经验中，JavaScript 的重定向要好得多。

这取决于您要如何更改位置。如果您想在用户历史记录中记录您的网站，请使用`window.location.href='ur website';`. 否则要在不登录历史记录的情况下执行此操作，请使用`window.location.replace("your website");`.

* * *

## 回答 #58

> 赞同：5
> 
> 时间：2014-02-07T20:16:40.667

这就是我使用它的方式。

```
 window.location.replace('yourPage.aspx');   
   // If you're on root and redirection page is also on the root

   window.location.replace(window.location.host + '/subDirectory/yourPage.aspx');

   // If you're in sub directory and redirection page is also in some other sub directory. 
```

# css - Text size for drop down menu/input select not working in Safari

> ID：503101
> 
> 赞同：18
> 
> 时间：2009-02-02T12:57:16.627
> 
> 标签：css

First question...

I'm having trouble getting ANY of the Drop down menu/Input Select's to appear with size 18 font in Safari.

Works fine in FF.

Code:

```
<form class="form">
<select name="make">
<option value="0"> All</option>
</select>
</form> 
```

Css:

```
.form input{
font-size:18px;
margin-bottom:0px;
} 
```

Any ideas? Can view live at [[http://www.motolistr.com][1]](http://www.motolistr.com][1])

Best, Nick

EDIT 1: Thanks for the quick reply. I added a style to the select itself to avoid confusion. I tried;

```
<select name='make' style='font-size: 18pt;'>
 </select> 
```

And

```
<select name='make' style='font-size: 18px;'>
 </select> 
```

And

```
<select name='make' style='font-size: 1.3em;'>
 </select> 
```

Still not working in SAFARI...Again FF works fine with all 3.

Best, Nick

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-03-19T21:21:57.867

要在 Safari 中设置选择样式，您首先必须关闭 os 样式：

```
select {
    -webkit-appearance: none;
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2010-03-30T11:12:26.813

不过有趣的是：如果您更改Safari上的`background`- 或- 属性，您的.`border``select``font-size`

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-08-14T23:19:44.900

I figured out a way that safari will pick up on font-size ... all you need to do is set a border color, like the following.

**-webkit-appearance: none;** will make you lose all of safari's attributes, like the arrows... below you can increase the size without losing that.

**Will Work in Safari**

```
<select style=" font-size: 3em; border: black;">
    <option>TEXT</option>
</select> 
```

**Won't Work in Safari**

```
<select style=" font-size: 3em;">
    <option>TEXT</option>
</select> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-02T14:06:00.997

它显示选择控件在 Safari 中是不可设置的；它总是使用自己的 OS X 风格的小部件绘制例程来显示它们。直到最近，这还是一种常态：浏览器通常会使用操作系统提供的普通小部件作为表单字段。CSS2 并没有真正说明样式应该如何应用于表单字段（如果有的话）。

今天的一些浏览器将选择的字体样式应用于选项（IE7、Opera）；有些允许页面选择和弹出选项的样式不同（Mozilla，Chrome），因此您可以做的最好的一致性是：

```
.form select, .form option {
    font: Whatever 18px;
} 
```

但是，如果您绝对需要 Safari 中的样式下拉菜单，您将需要在 JavaScript 中编写自己的笨重的 ersatz-select。（或者查看执行此操作的许多现有脚本和框架插件之一。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-06-27T21:56:50.933

首先从这个

```
.form input{
font-size:18px;
margin-bottom:0px;
} 
```

将不起作用，因为您没有为选择元素设置样式，而您正在为输入元素设置样式。试试这个，它很可能会奏效。

```
.form select {
font-size:18px;
margin-bottom:0px;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-11-03T17:45:26.703

至少在 Safari 5.1（我不再运行 3）中，您可以使用以下命令关闭默认样式：

```
select{-webkit-appearance: none} 
```

然后它将符合您的字体大小。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-02T13:00:48.867

The `select` technically isn't an `input` tag. Try assigning a class to your select and set the style for the class.

**EDIT**: Turns out that Aqua style selects only have three different font sizes available. If you need to set an exact font size, you can turn off Aqua by giving the item a background color, then set the size. FYI, it appears that 20px works without setting the background so it must size up to the next supported Aqua size.

Reference: [http://particletree.com/notebook/design-friendly-select-elements-in-safari-3/](http://particletree.com/notebook/design-friendly-select-elements-in-safari-3/). Test page with various styles at [http://particletree.com/examples/safari3/drop.html](http://particletree.com/examples/safari3/drop.html).

```
 <select name='make' class='big-input'>
 </select>

 .big-input
 {
     background: #fff; // turns off Aqua
     font-size: 18pt; // assuming you meant 18pt, not 18px
     margin-bottom: 0px;
 } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-09-07T23:37:53.403

设置 line-height:100% 将限制选择框的高度以获得更一致的外观，但它仍然不会影响实际字体大小。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-03-16T00:12:20.773

在某些情况下，它可以帮助：

```
select {
    -webkit-appearance: menulist-button;
    font-size: 30px;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-05-31T13:24:40.087

您可以通过执行以下操作来定位 Safari`select`标记：

```
select {
    width: 224px;
    line-height: 1.8;  (This can be in px too)
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-07-26T21:26:34.263

尝试这个

```
<style>
select { border:0; color:#000000; background:transparent;
font-size:20px; font-weight:bold; padding:2px 10px; width:378px;
*width:350px; *background:#FFFFFF; -webkit-appearance: none; }

#mainselection { overflow:hidden; width:350px;
-moz-border-radius: 9px 9px 9px 9px;
-webkit-border-radius: 9px 9px 9px 9px;
border-radius: 9px 9px 9px 9px;
box-shadow: 1px 1px 11px #330033;
background: url("img/arrow.gif") no-repeat scroll 319px 5px #FFFFFF; 
}
</style> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-03-09T11:30:25.390

我找到了一种通过使用**百分比**来更改 Safari 中选择元素的字体大小的方法。
然后您的代码变为：

```
<select name='make' style='font-size: 120%;'></select> 
```

对于 13px 的字体大小（我觉得这很吸引人）。

*这是在 Safari 5.1.3 中测试的*

# apache-flex - Flex 3.0：在饼图的图例中显示数据

> ID：503102
> 
> 赞同：1
> 
> 时间：2009-02-02T12:58:17.047
> 
> 标签：apache-flex, charts, customization, legend, pie-chart

我是 Adob​​e Flex 3.0 的新手。我需要在饼图图例中显示数据，以及彩色标记。关于如何去做，我有一些模糊的想法。（也许我必须编写我的自定义 legendMarkerRenderer。）有人可以指点一下吗？网上关于这方面的例子并不多。

提前致谢！

公关

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T00:05:50.440

要在 Legend 上显示数据，您需要扩展 LegendItem 类。您可以在我的博客中看到的示例：http: ~~[//northam.blogspot.com/2009/05/flex-showing-data-in-legend-of-pie.html](http://northam.blogspot.com/2009/05/flex-showing-data-in-legend-of-pie.html)~~

享受！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T18:55:13.893

这是一个对您非常有用的链接。Flex 3 组件资源管理器...它提供了如何实现大多数（如果不是全部）adobe flex 组件的示例。如果您想要更复杂的东西，您可能需要扩展图例并创建自己的组件。从事情的声音来看，它应该给你足够的继续前进

~~[Flex 3 组件资源管理器](http://examples.adobe.com/flex3/componentexplorer/explorer.html)~~（断开的链接）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T10:20:17.120

您始终可以根据您的要求自定义 flex 中的 UI 控件。所以你可以扩展图例类

也看看@这个：[liveDocs](http://livedocs.adobe.com/flex/201/html/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Book_Parts&file=charts_formatting_110_42.html)

# asp.net - ABAP RFC 调试

> ID：503118
> 
> 赞同：2
> 
> 时间：2009-02-02T13:02:24.183
> 
> 标签：asp.net, abap, saprfc

我是一名 ASP.NET 和 ABAP 开发人员。多年来，我使用 RFC 通过 SAP .NET 连接器与 ASP.NET 进行通信。

在集成测试期间，有时我们需要调试从 ASP.ENT 调用的 RFC，只是因为我们面临的错误不会发生在 SE37 上。

所以，每次我需要调试 RFC 时，我都插入了：

```
IF <<CONDITION>>. WHILE 1 EQ 1\. BREAK-POINT. ENDWHILE. ENDIF. 
```

这样，程序就会卡住。然后我去SM50调试它。

我想知道是否还有其他方法可以做到这一点，因为我不喜欢更改代码以进行调试或实现某些调试控制功能的想法。

那么，当您需要调试 RFC 时，您会怎么做？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-03T19:53:03.353

我假设您使用的是相当新版本的 sap (4.7+) 执行以下操作：

*   在 ASP 中获取使 RFC 调用到 SAP 的用户名
*   启动 SE37，转到 RFC 的代码部分
*   查看顶部的菜单，单击“实用程序”
*   点击设置
*   转到调试选项卡
*   填写将从 ASP 进行调用的用户名
*   单击 IP 匹配（否则每次任何用户拨打电话时都会出现一个调试会话）
*   会话断点立即激活也很高兴单击
*   将外部断点放在需要的位置（单击带有停止符号和小人的图标）
*   测试您的 ASP 连接器
*   断点应该生效，会弹出一个调试窗口
*   您可能无权执行此操作，如果不起作用，请使用 SU53 找出您缺少的内容。

这应该有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T17:39:09.693

棘手..您能否详细说明“该错误不会在se37发生”是什么意思？

这是否意味着您无法重现导致问题的数据，或者问题特定于通过 RFC 调用功能模块这一事实？

通常，你应该可以使用se37来启动功能模块，并且有一些方法可以将不同的数据星座记录到功能模块中。功能模块的行为应该是相同的，无论是从 se37 调用还是通过 RFC ...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-21T16:04:50.840

当您通过 SE37 调用 RFM 时，您会在不知不觉中使用 SAP 选择屏幕。如果您在从 RFC 调用时有一个带有标题行的表，它可能有标题行“填满”

如果您从 RFC 调用相同的 FM，则最初的标题行。

在 PT_JNC 处循环。出口。ENDLOOP。或 READ TABLE PT_JNC INDEX 1.
将有助于填充标题行

这是一个微妙的区别。其他简单的区别是 SAP 使用 YYYYMMDD 日期格式和 HH24MISS 时间

问候 jnc 在加尔各答

# c# - StructureMap InstanceScope.Hybrid 和 IDisposable

> ID：503120
> 
> 赞同：7
> 
> 时间：2009-02-02T13:02:42.620
> 
> 标签：c#, asp.net-mvc, linq, inversion-of-control, structuremap

我正在开发一个 asp.net-mvc 应用程序。linq 数据上下文通过结构映射传递到我的服务对象中。我已经设置了一个混合范围。这一切都很好。

```
protected override void configure()
{
    ForRequestedType<AetherDataContext>()
        .TheDefaultIs(() => new AetherDataContext())
        .CacheBy(InstanceScope.Hybrid);
} 
```

问题是我一直在运行我们的内存，我想知道 IDisposable 接口是否真的被调用过。

有人有什么想法吗？

没有人对可能导致我的记忆异常的事情有任何其他想法？

更新：

所以一些额外的信息，我只是在我的数据上下文中塞进了几个方法，在那里放了刹车点。

```
protected override void Dispose(bool disposing)
{
    Debug.WriteLine("Disposing: " + DateTime.Now);
    base.Dispose(disposing);
}

public new void Dispose()
{
    Debug.WriteLine("Disposing: " + DateTime.Now);
    base.Dispose();
} 
```

我不太确定我是否以正确的方式执行此操作，我猜会调用新方法？

无论如何，没有一个刹车点被击中。但是，每个请求都会调用同一类的构造函数。不理想我想。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T15:26:48.947

好的，所以最新版本的 StructureMap [(2.3.5)](http://codebetter.com/blogs/jeremy.miller/archive/2009/02/01/structuremap-2-5-3-is-released-and-the-future-of-structuremap.aspx)有一个有用的小方法，称为

```
HttpContextBuildPolicy.DisposeAndClearAll(); 
```

> 清理 HttpContext 和 ThreadLocal 上的便捷方法。HttpContextBuildPolicy.DisposeAndClearAll()、ThreadLocalStoragePolicy.DisposeAndClearAll()。如果对象是 IDisposable，调用任一方法都会弹出所有缓存的实例并调用 IDispose。

以前没有调用 dispose 方法，我将其添加到 Application_EndRequest ，现在它们是。我希望这能解决我的一些记忆问题。

我们会看到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T14:54:14.363

这几乎是我 2 天前提出的问题的精确副本：[包含实施 IDisposable 的项目的会话](https://stackoverflow.com/questions/498095/session-containing-items-implementing-idisposable)

InstanceScope.Hybrid 仅将对象存储在 HttpContext.Current.Items 中（如果存在）或 ThreadLocal 存储，否则 InstanceScope.HttpSession 的工作方式与使用 HttpSession 和 ThreadLocal 的方式相同。项目集合每个请求都存在，因此如果您实施我的问题中指出的模式，您应该会在当前请求结束时看到 Dispose 触发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T14:55:13.970

所以解决方案；它的卡西尼号造成了问题。基本上它为每个请求创建一个新的上下文。这就是为什么我看到再次创建上下文的原因，至于为什么它没有正确地调用我一次性我不知道。但我再次准备相信这与卡西尼号有关。

# flash - Flash 服务器端共享对象 - LSO

> ID：503122
> 
> 赞同：0
> 
> 时间：2009-02-02T13:03:24.447
> 
> 标签：flash, actionscript, data-access, local-shared-object, lso

Adobe docs *（我找不到哪个）*声明 Flash 可以从服务器读取共享对象（.SOL 文件？）。这可能是一种在客户端存储数据和检索数据的有趣方式。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T13:17:50.500

首先，.SOL 文件和 LocalSharedObject 顾名思义是纯粹的本地数据。它们存储在客户端，而不是服务器上，可以与 cookie 进行比较，或保存文件。但它们不是服务器端的。

如果您想在服务器上存储数据并在客户端检索它，您有很多技术，具体取决于您想要/可以在服务器上安装什么。

最明显的当然是使用您选择的语言的网络服务，并通过您的 Flash 应用程序访问它。

您还可以使用 ActionScript Remoting 功能调用服务器端方法来存储和检索对象。您必须为您的语言找到合适的库。AMFPHP 是 php 的参考，我知道 .NET 和 Java 也存在一些库。[这是一个使用 php 的示例](http://www.oscartrelles.com/archives/as3_flash_remoting_example)

最后，您可以使用 Adob​​e 专有技术的 Flash Media Server。我没有太多经验，但你应该能够在[这里找到有用的资源](http://www.adobe.com/devnet/flashmediaserver/)

# asp.net - How to Integrate Yahoo API Search in web-Application using Asp.net

> ID：503125
> 
> 赞同：1
> 
> 时间：2009-02-02T13:04:00.013
> 
> 标签：asp.net, web-services

I want to integrate yahoo search api in my web application in asp.net with C#. I don't know how to call yahoo api.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T22:22:47.650

```
string AppId = "foo";
string Query = "stackoverflow";
int NumResults = 10;

WebClient webClient = new WebClient();
string request = string.Format(
    "http://search.yahooapis.com/WebSearchService/V1/webSearch?appid={0}&query={1}&results={2}"
    , AppId
    , Query
    , NumResults);            
byte[] response = webClient.DownloadData(request);
string responseXML = System.Text.UTF8Encoding.UTF8.GetString(response);
Console.WriteLine(responseXML);
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T14:56:03.220

我不确定它是否仍然有效，但几年前我为此编写了一个 C# 和 VB.Net 包装器。雅虎甚至将它包含在他们的示例代码中。你可以从[我的网站](http://www.mgbrown.com/downloads.aspx)下载。基本上，您在从 Yahoo 的开发人员网站获得的 XML 模式上使用 XSD.Exe，然后将 Web 请求的结果反序列化为 XSD.exe 生成的对象。

# bash - 通过 shell 发送 arp

> ID：503135
> 
> 赞同：2
> 
> 时间：2009-02-02T13:08:18.787
> 
> 标签：bash, networking, arp

有没有办法在 MacOS X 或任何其他 UNIX 上通过 shell（例如手动或通过 shell 脚本）发送自定义（和不需要的事件）arp 响应？此外，有没有办法让软件在不向任何人发送 ping 的情况下要求当前子网中所有 IP 的 MAC 表示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T13:41:26.350

就在这里。这种活动用于 ARP Spoofing 和 ARP Poisoning 攻击，并且是针对 ex 执行的。由`arpspoof`. 如果您想发现主机的 MAC，当您知道它的 IP 并且它位于您的广播域 (LAN) 中时，请使用`arping`. ARP 是第 2 层协议，因此它的数据包不会被路由器转发，但它比 ICMP echo (ping) 更可靠。

一些工具：

*   `arp`- 标准程序 (win/unix) 用于列出主机的 IP-MAC 地址关联缓存，其中包含已学习的 IP

*   `arping`- 为给定 IP 发送 ARP 请求并显示接收到的 ARP 响应中包含的 MAC 的 unix 程序

*   `arpspoof`- 来自 dsniff 包的程序生成虚假 ARP 响应

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T13:22:33.457

[数据包生成器](http://en.wikipedia.org/wiki/Packet_generator)可能会解决问题。维基百科页面链接到一些实现，但我不知道它们是否适用于 OSX。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T13:50:04.993

也有`[arp-scan](http://www.nta-monitor.com/tools-resources/security-tools/arp-scan)`使用`libpcap`；并`arpdropper`使用`libnet`.

要被动（或主动）嗅探网络中的 ARP 数据包并显示生成数据包的机器的 IP 和 MAC 地址，您可以使用名为[ArpSpyX](http://thebends.org/~allen/arpspyx/)的 Mac OS X 应用程序。

```
# arpdropper requires http://sourceforge.net/projects/libnet-dev/ to compile
# (libnet & arpdropper successfully compiled on Mac OS X 10.6.8)
curl -LO http://thebends.googlecode.com/svn/trunk/misc/arpdropper.c
gcc -Wall -Wextra -lnet -o arpdropper arpdropper.c

./arpdropper

# Usage: ./arpdropper -i <device> -s <source ip> -d <dest ip>
# For arp replies:
#   ./arpdropper -r -i <device> -s <source ip> -m <source mac> -d <dest ip>

# using nmap
# get a pre-compiled Mac OS X version of nmap at:
# http://nmap.org/download.html#macosx or
# http://www.berndsworld.com/downloads/
nmap -PR -oN nmap-arpscan.txt 192.168.0.0/16 
```

# c# - 是否有可能避免沮丧？

> ID：503139
> 
> 赞同：2
> 
> 时间：2009-02-02T13:09:42.217
> 
> 标签：c#, polymorphism, downcast

我有一些逻辑，它定义和使用一些用户定义的类型，比如：

```
class Word
{
  System.Drawing.Font font; //a System type
  string text;
}

class Canvass
{
  System.Drawing.Graphics graphics; //another, related System type
  ... and other data members ...
  //a method whose implementation combines the two System types
  internal void draw(Word word, Point point)
  {
    //make the System API call
    graphics.DrawString(word.text, word.font, Brushes.Block, point);
  }
} 
```

逻辑在使用类型进行计算（例如定位每个`Word`实例）之后，间接使用一些`System`API，例如通过调用`Canvass.draw`方法。

我想让这个逻辑独立于`System.Drawing`命名空间：主要是为了帮助进行单元测试（我认为单元测试的输出会更容易验证该`draw`方法是否绘制到真实`System.Drawing.Graphics`实例之外的东西）。

为了消除逻辑对命名空间的依赖`System.Drawing`，我想我会声明一些新接口作为`System.Drawing`类型的占位符，例如：

```
interface IMyFont
{
}

interface IMyGraphics
{
  void drawString(string text, IMyFont font, Point point);
}

class Word
{
  IMyFont font; //no longer depends on System.Drawing.Font
  string text;
}

class Canvass
{
  IMyGraphics graphics;  //no longer depends on System.Drawing.Graphics
  ... and other data ...

  internal void draw(Word word, Point point)
  {
    //use interface method instead of making a direct System API call
    graphics.drawText(word.text, word.font, point);
  }
} 
```

如果我这样做了，那么不同的程序集可能有不同的`IMyFont`and`IMyGraphics`接口实现，例如......

```
class MyFont : IMyFont
{
  System.Drawing.Font theFont;
}

class MyGraphics : IMyGraphics
{
  System.Drawing.Graphics theGraphics;

  public void drawString(string text, IMyFont font, Point point)
  {

    //!!! downcast !!!

    System.Drawing.Font theFont = ((MyFont)font).theFont;

    //make the System API call
    theGraphics.DrawString(word.text, theFont, Brushes.Block, point);
  }
} 
```

...但是，如上图所示，实现将需要向下转换。

我的问题是，**有没有一种方法可以做到这一点而无需在实施过程中感到沮丧？**`Word`通过“这个”，我的意思是“定义像并且`Canvass`不依赖于特定具体类型的UDT `System`”？

另一种选择是抽象 UDT ...

```
class Word
{
  //System.Drawing.Font font; //declared in a subclass of Word
  string text;
}

class Canvass
{
  //System.Drawing.Graphics graphics; //declared in a subclass of Canvass
  //concrete draw method is defined in a subclass of Canvass
  internal abstract void draw(Word word, Point point); 
} 
```

...但这也需要在子类的实现中进行向下转换。

我也想过使用双重调度习惯，但这取决于命名 API 中的各种子类。

或者，如果没有接口或子类，有没有使用委托的方法？

* * *

**- 编辑： -**

有两种可能的答案。

一个答案是使用泛型，正如下面“兰蒂斯爵士”的回答所建议的那样，以及 John Skeet 链接到的博客文章所建议的那样。我怀疑这在大多数情况下都可以正常工作。从我的角度来看，不利的一面是它意味着`TFont`作为模板参数引入：它不仅是一个类`Word`（包含一个`Font`实例），它需要成为一个泛型类（如`WordT<TFont>`）......这也是任何包含`WordT<TFont>`(eg `Paragraph`) 的类现在也需要成为具有`TFont`参数 (eg `ParagraphT<TFont>`) 的泛型。最终，程序集中的几乎每个类都变成了泛型类。这**确实**保留了类型安全性并避免了向下转换的需要......**但是**它有点难看，并且扰乱了封装的错觉（“字体”是不透明的实现细节的错觉）。

另一个答案是在用户类中使用地图或字典。而不是`Font`在可重用库中，而不是抽象接口，定义一个“句柄”类，如：

```
public struct FontHandle
{
  public readonly int handleValue;
  FontHandle(int handleValue)
  {
    this.handleValue = handleValue;
  }
} 
```

然后，不要从 向下转换，而是`FontHandle`保留一个将值`Dictionary<int, Font>`映射到实例的实例。`FontHandle``Font`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T13:12:59.713

首先，我想知道整个场景是不是有点人为；你真的**需要**这种抽象级别吗？也许订阅[YAGNI](http://en.wikipedia.org/wiki/You_Ain't_Gonna_Need_It)？

为什么你`MyGraphics`只使用 a `MyFont`？它可以与 一起使用`IFont`吗？那将是更好地使用接口，并且可以避免整个问题...

一种选择可能是重新设计一点，以便`IFont`只描述字体的元数据（大小、字体等），并且您可以在具体内容上进行`MyGraphics`如下操作：

```
[public|internal] MyFont GetFont(IFont font) {...} // or just Font 
```

并且它成为图形的工作来进行翻译 - 所以然后使用了类似的东西：

```
public void drawString(string text, IMyFont font, Point point)
{
    using(System.Drawing.Font theFont = GetFont(font))
    {
        theGraphics.DrawString(word.text, theFont, Brushes.Block, point);
    }
    // etc
} 
```

当然，`Point`也可能需要翻译；-p

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T13:14:02.083

您实际上是在说“我比编译器更了解 - 我知道它一定是`MyFont`. 那时你已经得到`MyFont`并且`MyGraphics`再次紧密耦合，这会稍微减少接口的点。

应该`MyGraphics`使用任何`IFont`，或只使用`MyFont`? 如果你可以让它与任何`IFont`你一起工作，你会没事的。否则，您可能需要查看复杂的泛型以使其所有编译时类型安全。您可能会发现[我在 Protocol Buffers 中关于泛型的帖子在](http://msmvps.com/blogs/jon_skeet/archive/2008/08/29/lessons-learned-from-protocol-buffers-part-3-generic-type-relationships.aspx)类似情况下很有用。

（附带建议 - 如果您遵循命名约定，您的代码将更像 .NET，其中包括方法的 Pascal 大小写。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T13:38:48.773

我目前不太了解 C# - 现在已经有一段时间了。但是如果你不想把你所有的东西都放在那里，你可能会被迫使用泛型。

我可以只提供 Java 代码，但 C# 应该能够通过`where`关键字来做同样的事情。

使您的接口成为通用接口。在Java中，那将是

`IMyGraphics<T extends IMyFont>` 进而`MyGraphics : IMyGraphics<MyFont>`

然后重新定义`drawString`Signature`T font`作为第二个参数，而不是`IMyFont`. 这应该使您能够编写

`public void drawString(string text, MyFont font, Point point)`

直接进入你的`MyGraphics`班级。

* * *

在 C# 中`IMyGraphics<T extends IMyFont>`应该是这样`public interface IMyGraphics<T> where T:IMyFont`，但我对此不是 100% 确定的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T13:27:40.637

你不喜欢演员表 from `IFont`to`MyFont`吗？你可以这样做：

```
interface IFont {
    object Font { get; }
}

class MyFont : IFont {
    object Font { get { return ...; } }
} 
```

当然，您仍然需要在绘图方法中转换 from `System.Object`to `System.Drawing.Font`，但您刚刚消除了对特定类实现的依赖（`MyFont`）。

```
public void DrawString(string text, IFont font, Point point)
{
    System.Drawing.Font f = (Font)font.Font;
    graphics.DrawString(text, f, Brushes.Block, point);
} 
```

# flash - Whats AMFPHP 以及如何使用它来读取二进制文件？

> ID：503143
> 
> 赞同：0
> 
> 时间：2009-02-02T13:10:29.300
> 
> 标签：flash, actionscript-2, binary-data, amfphp

我需要一个解决方案来从存储在服务器上的任何文件类型中读取**原始二进制文件。**

我听说过 AMFPHP，但最初被推迟了，因为我认为它需要管理员访问权限才能在服务器上安装服务。

我可以用它来读取二进制文件吗？对此的任何解决方案都会被广泛接受。

*（不，我在 XML CDATA 部分尝试了二进制，但有太多非法的“控制”字符）*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T13:29:05.453

您无需权限即可安装 amfphp，只需将其放在服务器上的子文件夹中即可。

之后，您只需要编写 php 代码来读取二进制文件并使用 amfphp 将这些数据传递给您的 actionscript 代码。[这](http://www.flash-db.com/Tutorials/helloAS3/)是关于 amfPhp 的一个不错的教程

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T13:19:31.527

是的，AMFPHP 服务是用 PHP 编写的，因此只需编写一个读取二进制文件并将数据返回给客户端的服务即可。

您可能已经发现，安装 AMFPHP 不需要任何特殊权限。

# python - 如何解析 nagios status.dat 文件？

> ID：503148
> 
> 赞同：5
> 
> 时间：2009-02-02T13:11:09.377
> 
> 标签：python, parsing, nagios

我想解析 nagios3 的 status.dat 文件并使用 python 脚本输出为 xml。xml 部分很简单，但我该如何解析文件呢？使用多行正则表达式？由于监视了许多主机和服务，文件可能会很大，将整个文件加载到内存中是否明智？
我只需要提取具有关键状态的服务和它们所属的主机。

任何帮助和指出正确的方向都将受到高度赞赏。

**LE**文件的外观如下：

```
########################################
#          NAGIOS STATUS FILE
#
# THIS FILE IS AUTOMATICALLY GENERATED
# BY NAGIOS.  DO NOT MODIFY THIS FILE!
########################################

info {
    created=1233491098
    version=2.11
    }

program {
    modified_host_attributes=0
    modified_service_attributes=0
    nagios_pid=15015
    daemon_mode=1
    program_start=1233490393
    last_command_check=0
    last_log_rotation=0
    enable_notifications=1
    active_service_checks_enabled=1
    passive_service_checks_enabled=1
    active_host_checks_enabled=1
    passive_host_checks_enabled=1
    enable_event_handlers=1
    obsess_over_services=0
    obsess_over_hosts=0
    check_service_freshness=1
    check_host_freshness=0
    enable_flap_detection=0
    enable_failure_prediction=1
    process_performance_data=0
    global_host_event_handler=
    global_service_event_handler=
    total_external_command_buffer_slots=4096
    used_external_command_buffer_slots=0
    high_external_command_buffer_slots=0
    total_check_result_buffer_slots=4096
    used_check_result_buffer_slots=0
    high_check_result_buffer_slots=2
    }

host {
    host_name=localhost
    modified_attributes=0
    check_command=check-host-alive
    event_handler=
    has_been_checked=1
    should_be_scheduled=0
    check_execution_time=0.019
    check_latency=0.000
    check_type=0
    current_state=0
    last_hard_state=0
    plugin_output=PING OK - Packet loss = 0%, RTA = 3.57 ms
    performance_data=
    last_check=1233490883
    next_check=0
    current_attempt=1
    max_attempts=10
    state_type=1
    last_state_change=1233489475
    last_hard_state_change=1233489475
    last_time_up=1233490883
    last_time_down=0
    last_time_unreachable=0
    last_notification=0
    next_notification=0
    no_more_notifications=0
    current_notification_number=0
    notifications_enabled=1
    problem_has_been_acknowledged=0
    acknowledgement_type=0
    active_checks_enabled=1
    passive_checks_enabled=1
    event_handler_enabled=1
    flap_detection_enabled=1
    failure_prediction_enabled=1
    process_performance_data=1
    obsess_over_host=1
    last_update=1233491098
    is_flapping=0
    percent_state_change=0.00
    scheduled_downtime_depth=0
    }

service {
    host_name=gateway
    service_description=PING
    modified_attributes=0
    check_command=check_ping!100.0,20%!500.0,60%
    event_handler=
    has_been_checked=1
    should_be_scheduled=1
    check_execution_time=4.017
    check_latency=0.210
    check_type=0
    current_state=0
    last_hard_state=0
    current_attempt=1
    max_attempts=4
    state_type=1
    last_state_change=1233489432
    last_hard_state_change=1233489432
    last_time_ok=1233491078
    last_time_warning=0
    last_time_unknown=0
    last_time_critical=0
    plugin_output=PING OK - Packet loss = 0%, RTA = 2.98 ms
    performance_data=
    last_check=1233491078
    next_check=1233491378
    current_notification_number=0
    last_notification=0
    next_notification=0
    no_more_notifications=0
    notifications_enabled=1
    active_checks_enabled=1
    passive_checks_enabled=1
    event_handler_enabled=1
    problem_has_been_acknowledged=0
    acknowledgement_type=0
    flap_detection_enabled=1
    failure_prediction_enabled=1
    process_performance_data=1
    obsess_over_service=1
    last_update=1233491098
    is_flapping=0
    percent_state_change=0.00
    scheduled_downtime_depth=0
    } 
```

它可以有任意数量的主机，一个主机可以有任意数量的服务。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-04-03T02:46:05.447

Pfft，获取你自己的 mk_livestatus。[http://mathias-kettner.de/checkmk_livestatus.html](http://mathias-kettner.de/checkmk_livestatus.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-23T04:11:04.360

Nagioosity 完全符合您的要求：

[http://code.google.com/p/nagioosity/](http://code.google.com/p/nagiosity/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-10T09:57:58.120

从上面的示例中无耻地窃取，这里是 Python 2.4 的版本构建，它返回一个包含 nagios 部分数组的 dict。

```
def parseConf(source):
    conf = {}
    patID=re.compile(r"(?:\s*define)?\s*(\w+)\s+{")
    patAttr=re.compile(r"\s*(\w+)(?:=|\s+)(.*)")
    patEndID=re.compile(r"\s*}")
    for line in source.splitlines():
        line=line.strip()
        matchID = patID.match(line)
        matchAttr = patAttr.match(line)
        matchEndID = patEndID.match( line)
        if len(line) == 0 or line[0]=='#':
            pass
        elif matchID:
            identifier = matchID.group(1)
            cur = [identifier, {}]
        elif matchAttr:
            attribute = matchAttr.group(1)
            value = matchAttr.group(2).strip()
            cur[1][attribute] = value
        elif matchEndID and cur:
            conf.setdefault(cur[0],[]).append(cur[1])              
            del cur
    return conf 
```

要获取具有以“devops”开头的联系人组的主机的所有名称：

```
nagcfg=parseConf(stringcontaingcompleteconfig)
hostlist=[host['host_name'] for host in nagcfg['host'] 
          if host['contact_groups'].startswith('devops')] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-02T15:12:37.633

不知道 nagios 及其配置文件，但结构看起来很简单：

```
# comment
identifier {
  attribute=
  attribute=value
} 
```

可以简单地翻译成

```
<identifier>
    <attribute name="attribute-name">attribute-value</attribute>
</identifier> 
```

所有内容都包含在根级 <nagios> 标记内。

我看不到值中的换行符。nagios 是否有多行值？

您需要注意属性值中的等号，因此将您的正则表达式设置为非贪婪。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-02T16:45:17.353

你可以这样做：

```
def parseConf(filename):
    conf = []
    with open(filename, 'r') as f:
        for i in f.readlines():
            if i[0] == '#': continue
            matchID = re.search(r"([\w]+) {", i)
            matchAttr = re.search(r"[ ]*([\w]+)=([\w\d]*)", i)
            matchEndID = re.search(r"[ ]*}", i)
            if matchID:
                identifier = matchID.group(1)
                cur = [identifier, {}]
            elif matchAttr:
                attribute = matchAttr.group(1)
                value = matchAttr.group(2)
                cur[1][attribute] = value
            elif matchEndID:
                conf.append(cur)
    return conf

def conf2xml(filename):
    conf = parseConf(filename)
    xml = ''
    for ID in conf:
        xml += '<%s>\n' % ID[0]
        for attr in ID[1]:
            xml += '\t<attribute name="%s">%s</attribute>\n' % \
                    (attr, ID[1][attr])
        xml += '</%s>\n' % ID[0]
    return xml 
```

然后尝试这样做：

```
print   conf2xml('conf.dat') 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-06-04T21:08:35.600

如果您稍微调整 Andrea 的解决方案，您可以使用该代码来解析 status.dat 以及 objects.cache

```
def parseConf(source):
conf = []
for line in source.splitlines():
    line=line.strip()
    matchID = re.match(r"(?:\s*define)?\s*(\w+)\s+{", line)
    matchAttr = re.match(r"\s*(\w+)(?:=|\s+)(.*)", line)
    matchEndID = re.match(r"\s*}", line)
    if len(line) == 0 or line[0]=='#':
        pass
    elif matchID:
        identifier = matchID.group(1)
        cur = [identifier, {}]
    elif matchAttr:
        attribute = matchAttr.group(1)
        value = matchAttr.group(2).strip()
        cur[1][attribute] = value
    elif matchEndID and cur:
        conf.append(cur)
        del cur
return conf 
```

nagios 为什么选择对这些文件使用两种不同的格式有点令人费解，但是一旦您将它们都解析为一些可用的 python 对象，您就可以通过外部命令文件做很多魔术。

如果有人有解决方案将其放入真正的 xml dom 中，那就太棒了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-02-16T19:55:52.590

在过去的几个月里，我编写并发布了一个工具，它解析 Nagios status.dat 和 objects.cache 并构建一个模型，允许对 Nagios 数据进行一些非常有用的操作。我们用它来驱动一个内部操作仪表板，它是一个简化的“迷你”Nagios。它在持续开发中，我忽略了测试和文档，但代码并不太疯狂，我觉得很容易理解。

让我知道你的想法...... [https://github.com/zebpalmer/NagParser](https://github.com/zebpalmer/NagParser)

# java - Eclipse 报错：此项目需要迁移 WTP 元数据

> ID：503157
> 
> 赞同：56
> 
> 时间：2009-02-02T13:13:09.527
> 
> 标签：java, eclipse, eclipse-wtp

我们在 Eclipse 3.2 中启动了一个 Web 项目，我们已经升级到 Eclipse 3.4，但现在项目出现错误：

“这个项目需要迁移 WTP 元数据”

我们尝试右键单击并执行“快速修复”，这实际上是为了迁移 WTP 元数据。不幸的是，什么也没发生，错误仍然存​​在。

我们可以从问题中删除该错误，并且一切正常，但是，每次我们从源代码管理重新导入项目时，错误都会重新出现。关于如何永久消除此错误或如何实际迁移 WTP 元数据的任何想法？

**更新：**每个人，请对适合您的答案进行投票，而不是添加您自己的答案来引用以前的人的答案。

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2009-05-08T09:12:52.127

上述解决方案工作正常，但它一次又一次地爬起来。一个更简单的解决方案是在 Eclipse 中右键单击相关项目并选择 Validate。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-03-12T10:28:58.113

对我来说，这些都不起作用。我的解决方案是在 Eclipse 停止时删除以下文件：

```
/workspace/.metadata/.plugins/org.eclipse.core.resources/.projects/myprojectname/.markers 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-11-05T08:29:50.240

这是您可以尝试的另一件事，只有这对我有用:(

转到项目属性 > 项目方面 > 勾选“Java”和“实用程序模块”...应用如果您的项目是从其他项目中引用的，则此方法有效...否则您可以使用这些选项...看看哪个适合您.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-02T13:23:07.977

`.project`尝试在文件中添加这一行

```
<nature>org.eclipse.wst.common.project.facet.core.nature</nature> 
```

或者参考[这个讨论](http://www.ibm.com/developerworks/forums/thread.jspa?threadID=141106)：例如，确保没有重复的条目`.sessions/org.eclipse.wst.common.component`

* * *

正如[larf311](https://stackoverflow.com/users/31169/larf311)评论中所述，在这种情况下的实际答案是：

> 删除“ `.settings/org.eclipse.wst.common.component`”文件。

简单的。;)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-29T18:45:52.840

删除 .markers 文件为我解决了这个问题。我会赞成该解决方案，但我没有这样做的“声誉”。:(

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-06-28T07:01:40.587

这只是意味着 wtp 的项目配置是旧的，或者模块之间存在冲突。转到项目-> 属性-> 项目方面。然后单击以下内容：动态 Web 项目 2.5 版、Java 5 或 6 和 javascript 工具包（不确定是否有必要）。您会注意到 .settings 文件发生了变化。签入新的更改，每次有人签出项目时都应该没问题

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-03T23:42:58.427

删除项目，并将其从源代码控制中签出

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-08T18:50:04.717

我使用SVN，每次在新计算机上签出项目时都会遇到这个问题，我修复的方法是将.settings从原始位置复制到项目的新文件夹，当然使用验证

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-06-04T01:01:58.890

使用 maven ... mvn eclipse:clean ... mvn eclipse:eclipse ... 重新导入项目

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-01-10T13:33:04.787

在项目的属性中，我选择了 Project Facets。未选择任何内容，但右侧有一条消息指示需要选择 Java 1.3 或更高版本。我选择了 Java 6，然后在关闭“属性”窗口后，我仍然需要执行“验证”。问题终于消失了。

# networking - 向子网上的每个 IP 发送 ping

> ID：503171
> 
> 赞同：62
> 
> 时间：2009-02-02T13:16:34.560
> 
> 标签：networking, shell, ping, arp

是否有基于命令行的方式向子网中的每台计算机发送 ping？像

```
for(int i = 1; i < 254; i++)
    ping(192.168.1.i); 
```

强制执行arp解析？

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2009-02-02T13:48:28.113

并非所有机器都`nmap`可用，但它是任何网络发现的绝佳工具，而且肯定比通过独立`ping`命令迭代更好。

```
$ nmap -n -sP 10.0.0.0/24

在 2009-02-02 07:41 CST 开始 Nmap 4.20 ( http://insecure.org )
主机 10.0.0.1 似乎已启动。
主机 10.0.0.10 似乎已启动。
主机 10.0.0.104 似乎已启动。
主机 10.0.0.124 似乎已启动。
主机 10.0.0.125 似乎已启动。
主机 10.0.0.129 似乎已启动。
Nmap 完成：在 2.365 秒内扫描了 256 个 IP 地址（最多 6 个主机）

```

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2015-08-17T14:11:44.713

我建议将**fping**与 mask 选项一起使用，因为您不会限制自己使用 ping。

```
fping -g 192.168.1.0/24 
```

响应将很容易在脚本中解析：

```
192.168.1.1 is alive
192.168.1.2 is alive
192.168.1.3 is alive
192.168.1.5 is alive
...
192.168.1.4 is unreachable
192.168.1.6 is unreachable
192.168.1.7 is unreachable
... 
```

注意：使用该参数`-a`会将输出限制为可访问的 IP 地址，您可能需要使用它，否则 fping 也会打印无法访问的地址：

```
fping -a -g 192.168.1.0/24 
```

来自男人：

> **fping**与**ping**的不同之处在于您可以在命令行上指定任意数量的目标，或者指定一个包含要 ping 的目标列表的文件。**fping**不会在超时或回复之前发送到一个目标，而是发送一个 ping 数据包并以循环方式移动到下一个目标。

更多信息： http: [//fping.org/](http://fping.org/)

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2009-02-02T13:20:23.303

**广播 ping：**

```
$ ping 192.168.1.255
PING 192.168.1.255 (192.168.1.255): 56 data bytes
64 bytes from 192.168.1.154: icmp_seq=0 ttl=64 time=0.104 ms
64 bytes from 192.168.1.51: icmp_seq=0 ttl=64 time=2.058 ms (DUP!)
64 bytes from 192.168.1.151: icmp_seq=0 ttl=64 time=2.135 ms (DUP!)
... 
```

`-b`（在 Linux 上添加一个选项）

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-02-02T13:21:19.760

在 Bash 外壳中：

```
#!/bin/sh

COUNTER=1

while [ $COUNTER -lt 254 ]
do
   ping 192.168.1.$COUNTER -c 1
   COUNTER=$(( $COUNTER + 1 ))
done 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2016-02-23T14:11:50.137

我刚想到这个问题，但答案并不让我满意。所以我推出了自己的：

```
echo $(seq 254) | xargs -P255 -I% -d" " ping -W 1 -c 1 192.168.0.% | grep -E "[0-1].*?:" 
```

*   优势一：无需安装任何额外工具
*   优势二：速度快。它并行执行所有操作，每次 ping 1s (" `-W 1`") 都有一个超时。所以它将在 1 秒内完成 :)
*   优势3：输出是这样的

> ```
> 64 bytes from 192.168.0.16: icmp_seq=1 ttl=64 time=0.019 ms
> 64 bytes from 192.168.0.12: icmp_seq=1 ttl=64 time=1.78 ms
> 64 bytes from 192.168.0.21: icmp_seq=1 ttl=64 time=2.43 ms
> 64 bytes from 192.168.0.1: icmp_seq=1 ttl=64 time=1.97 ms
> 64 bytes from 192.168.0.11: icmp_seq=1 ttl=64 time=619 ms 
> ```

编辑：这里与脚本相同，因为当您的 xargs 没有 -P 标志时，就像 openwrt 中的情况一样（我刚刚发现）

```
for i in $(seq 255);
do
 ping -W 1 -c 1 10.0.0.$i | grep 'from' &
done 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-02-02T13:48:19.113

命令行实用程序 nmap 也可以这样做：

```
nmap -sP 192.168.1.* 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-11-27T16:09:51.397

```
for i in $(seq 1 254); do ping -c1 -t 1 192.168.11.$i; done 
```

添加 a`-t 1`在退出前仅等待一秒钟。如果您只有几个设备连接到该子网，这会大大提高速度。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-01-23T21:47:48.260

```
FOR /L %i in (1,1,254) DO PING 192.168.1.%i -n 1 -w 100 | for /f "tokens=3 delims=: " %j in ('find /i "TTL="') do echo %j>>IPsOnline.txt 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2014-01-26T23:49:18.007

这是对上述@david-rodríguez-dribeas 答案的修改，它并行运行所有 ping（快得多），并且只显示返回 ping 的 ip 地址的输出。

```
export COUNTER=1
while [ $COUNTER -lt 255 ]
do
    ping $1$COUNTER -c 1 -w 400 | grep -B 1 "Lost = 0" &
    COUNTER=$(( $COUNTER + 1 ))
done 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-02T13:25:06.290

在 linux 下，我认为 ping -b 192.168.1.255 可以工作（192.168.1.255 是 192.168.1.* 的广播地址）但是 IIRC 在 Windows 下不起作用。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-01-21T02:58:53.340

我来晚了，但这是我为此目的编写的一个小脚本，我在 Windows PowerShell 中运行。您应该能够将其复制并粘贴到 ISE 中。然后这将运行 arp 命令并将结果保存到 .txt 文件中并在记事本中打开它。

```
# Declare Variables
$MyIpAddress
$MyIpAddressLast

# Declare Variable And Get User Inputs
$IpFirstThree=Read-Host 'What is the first three octects of you IP addresses please include the last period?'
$IpStart=Read-Host 'Which IP Address do you want to start with? Include NO periods.'
$IpEnd=Read-Host 'Which IP Address do you want to end with? Include NO periods.'
$SaveMyFilePath=Read-Host 'Enter the file path and name you want for the text file results.'
$PingTries=Read-Host 'Enter the number of times you want to try pinging each address.'

#Run from start ip and ping
#Run the arp -a and output the results to a text file
#Then launch notepad and open the results file
Foreach($MyIpAddressLast in $IpStart..$IpEnd)
{$MyIpAddress=$IpFirstThree+$MyIpAddressLast
    Test-Connection -computername $MyIpAddress -Count $PingTries}
arp -a | Out-File $SaveMyFilePath
notepad.exe $SaveMyFilePath 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-07T01:10:59.693

```
#!/bin/sh

COUNTER=$1

while [ $COUNTER -lt 254 ]
do
 echo $COUNTER
 ping -c 1 192.168.1.$COUNTER | grep 'ms'
 COUNTER=$(( $COUNTER + 1 ))
done

#specify start number like this: ./ping.sh 1
#then run another few instances to cover more ground
#aka one at 1, another at 100, another at 200
#this just finds addresses quicker. will only print ttl info when an address resolves 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-03-30T10:09:14.097

该脚本在**OpenWRT中运行良好**

在一个新文件中放入此代码，

```
#!/bin/sh
echo "Online IPs" > out.txt
COUNTER=1

while [ $COUNTER -lt 255 ]
do
 ping $1.$COUNTER -c 1 -w 400 | grep "time" >> out.txt &
 COUNTER=$(( $COUNTER + 1 ))
done
killall ping 
```

设置执行权限并启动它

root@r1:/# **nping 192.168.1**

然后查看 out.txt 文件中连接的所有主机

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2015-10-21T12:53:41.040

```
for i in $(seq 1 254); do ping -c1 192.168.11.$i; done 
```

# vsto - Deploy VSTO application in visual studio windows application

> ID：503172
> 
> 赞同：0
> 
> 时间：2009-02-02T13:16:51.407
> 
> 标签：vsto

I have created a VSTO application using office 2005 & visual studio 2005 professional.I found there a setup folder.While i am running the *.exe file in client machine,it giving me error."An add-in could not be found or could not be loaded."

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T13:30:26.497

客户端机器的架构是什么？

如果 Vista：您是否禁用了 UAC（安全对话框）？

如果清单文件的路径正确，还要检查注册表。

是否加载了正确的框架版本？

您是在使用发布功能，还是在尝试创建自己的 MSI？

您需要在您身边进行一些调试才能对此进行排序：

1.  尝试完全卸载 VSTO SE 并重新安装。
2.  无需任何额外代码即可创建新的 VSTO 加载项并运行它。
3.  评估发生的事情并相应地执行操作

# perl - Perl 中的面向对象异常处理值得吗？

> ID：503189
> 
> 赞同：12
> 
> 时间：2009-02-02T13:22:00.383
> 
> 标签：perl, exception, exception-handling

我最近阅读了Perl.com 文章[“Perl 中的面向对象异常处理” 。](http://www.perl.com/pub/a/2002/11/14/exception.html)在 Perl 中使用异常有什么意义吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-02T16:32:11.093

我应该注意到你引用的文章是旧的，你现在应该使用[Exception::Class](http://metacpan.org/pod/Exception::Class)而不是 Error.pm，它很古怪并且容易中断（我称之为“黑魔法”）。我应该注意，我现在是 Error.pm 的维护者，但我不再推荐它或将它用于我自己的代码。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-02T15:07:29.563

> “在 Perl 中使用异常有什么意义吗？”

是的，我强烈推荐阅读[Damian Conway的](http://www.perlfoundation.org/perl5/index.cgi?damian_conway)[Perl Best Practices](http://www.perlfoundation.org/perl5/index.cgi?perl_best_practices)中的“错误处理”一章。

它确实让我大开眼界;-)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-02T16:10:55.707

绝对地。如果你扔一个简单的“骰子”，你真的没有更多的信息可以让*计算机*处理。例如，我有一个使用 Test::Most 的测试框架，该模块可以让你在测试失败时死掉。但是，我的框架需要知道我是因为测试失败还是因为代码死了而死。因此，我抛出了一个 Test::Most::Exception 并且我的框架可以检查异常类型并采取适当的措施。

例外是你的朋友:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-02T16:31:39.877

在任何编程语言中，异常都可以让您以不同的方式处理不同类型的错误。这对于跟踪测试中的细粒度错误和智能地处理程序中可恢复的错误非常有用。对于您编写的每个一次性程序来说，这并不值得，但对于您花费大量时间开发的东西来说，它可能是值得的。

# php - 准备好的语句中的 mysqli 绑定字段

> ID：503190
> 
> 赞同：0
> 
> 时间：2009-02-02T13:22:02.100
> 
> 标签：php, mysql, ajax, mysqli

我有以下代码，我收到错误：

**警告**：mysqli_stmt::bind_result() [mysqli-stmt.bind-result]：绑定变量的数量与文件中准备好的语句中的字段数量不匹配。

如果这只是一个警告，代码不应该仍然有效吗？我想做一个选择 * 并显示除一个字段之外的所有数据，我想分别绑定和处理。有什么办法，或者更好的方法吗？我目前的解决方案（未尝试）是使用 getRecords 将正确数量的变量绑定到结果，然后使用 getHtml 单独绑定为不同的名称。

绑定有什么好处，有没有必要。

```
<?php
if (isset($_GET["cmd"]))
  $cmd = $_GET["cmd"]; else
  die("You should have a 'cmd' parameter in your URL");
$id = $_GET["id"];
$con = mysqli_connect("localhost", "user", "password", "db");
if (!$con) {
    echo "Can't connect to MySQL Server. Errorcode: %s\n". mysqli_connect_error();
    exit;
}
$con->set_charset("utf8");
echo "test outside loop";
if($cmd=="GetSaleData") {
    echo "test inside loop";
    if ($getRecords = $con->prepare("SELECT SELECT Product_NO, Product_NAME, SUBTITLE, CURRENT_BID, START_PRICE, BID_COUNT, QUANT_TOTAL, QUANT_SOLD, ACCESSSTARTS, ACCESSENDS, ACCESSORIGIN_END, USERNAME, BEST_BIDDER_ID, FINISHED, WATCH, BUYITNOW_PRICE, PIC_URL, PRIVATE_AUCTION, AUCTION_TYPE, ACCESSINSERT_DATE, ACCESSUPDATE_DATE, CAT_DESC, CAT_PATH, COUNTRYCODE, LOCATION, CONDITIONS, REVISED, PAYPAL_ACCEPT, PRE_TERMINATED, SHIPPING_TO, FEE_INSERTION, FEE_FINAL, FEE_LISTING, PIC_XXL, PIC_DIASHOW, PIC_COUNT, ITEM_SITE_ID FROM Sales WHERE Product_NO = ?")) FROM SaleS WHERE PRODUCT_NO = ?")) {
        $getHtml = $con->prepare("SELECT PRODUCT_DESC FROM SaleS WHERE PRODUCT_NO = ?");
        $getHtml->bind_param("i", $id);
        $getHtml->execute();
        $getHtml->bind_result($PRODUCT_DESC);
        $getRecords->bind_param("i", $id);
        $getRecords->execute();
        $getRecords->bind_result($PRODUCT_NO, $PRODUCT_NAME, $SUBTITLE, $CURRENT_BID, $START_PRICE, $BID_COUNT, $QUANT_TOTAL, $QUANT_SOLD, $ACCESSSTARTS, $ACCESSENDS, $ACCESSORIGIN_END, $USERNAME, $BEST_BIDDER_ID, $FINISHED, $WATCH, $BUYITNOW_PRICE, $PIC_URL, $PRIVATE_Sale, $Sale_TYPE, $ACCESSINSERT_DATE, $ACCESSUPDATE_DATE, $CAT_DESC, $CAT_PATH, $COUNTRYCODE, $LOCATION, $CONDITIONS, $REVISED, $PAYPAL_ACCEPT, $PRE_TERMINATED, $SHIPPING_TO, $FEE_INSERTION, 
        $FEE_FINAL, $FEE_LISTING, $PIC_XXL, $PIC_DIASHOW, $PIC_COUNT, $ITEM_SITE_ID);
        while ($getRecords->fetch()) {
            // operations snipped for question
            echo "<h1>".$PRODUCT_NAME."</h1>
<div id='leftlayer' class='leftlayer'>
<p><strong>Username: </strong>".$USERNAME."
<p><strong>Shipping to: </strong> ". $country ."
<img src='./images/".$id.".jpg"' width='".$imageSize["width"]."' height='".$imageSize["height"]."'>
</div>
<div id='rightlayer'> 
</div>";
//
} 
}
}
} 
```

我也想知道我的 img src 语句有什么问题......，我觉得我错过了一些基本的东西，比如斜线或引号。

编辑：代码现在在将 * 替换为列名后显示错误，但是从未输入过 while 循环，因此不执行任何操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-02T13:35:51.260

[根据 MySQLi bind_result() 的示例，](http://www.php.net/manual/en/mysqli-stmt.bind-result.php)您可能需要在 SELECT 中明确声明列名，而不是使用 * 。

关于 img 行，您在 .jpg 之后有一个额外的 "

```
<img src='./images/".$id.".jpg"' width= 
```

应该

```
<img src='./images/".$id.".jpg width= 
```

此外，您实际上不需要拆分字符串并连接变量，因为使用 " 将导致字符串被解析为变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T13:37:25.140

我猜问题出在这里：

```
$getRecords->bind_result($PRODUCT_NO, $PRODUCT_NAME, $SUBTITLE, $CURRENT_BID, $START_PRICE, $BID_COUNT, $QUANT_TOTAL, $QUANT_SOLD, $ACCESSSTARTS, $ACCESSENDS, $ACCESSORIGIN_END, $USERNAME, $BEST_BIDDER_ID, $FINISHED, $WATCH, $BUYITNOW_PRICE, $PIC_URL, $PRIVATE_Sale, $Sale_TYPE, $ACCESSINSERT_DATE, $ACCESSUPDATE_DATE, $CAT_DESC, $CAT_PATH, $COUNTRYCODE, $LOCATION, $CONDITIONS, $REVISED, $PAYPAL_ACCEPT, $PRE_TERMINATED, $SHIPPING_TO, $FEE_INSERTION, 
        $FEE_FINAL, $FEE_LISTING, $PIC_XXL, $PIC_DIASHOW, $PIC_COUNT, $ITEM_SITE_ID); 
```

您可能缺少一列。如果您的列数少于结果集中检索到的列数，则该代码将起作用。

至于 img 标签，如果您在 xhmtl 上，则必须将其关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T15:47:15.380

我将从修复这条线开始：

```
if ($getRecords = $con->prepare("SELECT SELECT Product_NO, Product_NAME, SUBTITLE, CURRENT_BID, START_PRICE, BID_COUNT, QUANT_TOTAL, QUANT_SOLD, ACCESSSTARTS, ACCESSENDS, ACCESSORIGIN_END, USERNAME, BEST_BIDDER_ID, FINISHED, WATCH, BUYITNOW_PRICE, PIC_URL, PRIVATE_AUCTION, AUCTION_TYPE, ACCESSINSERT_DATE, ACCESSUPDATE_DATE, CAT_DESC, CAT_PATH, COUNTRYCODE, LOCATION, CONDITIONS, REVISED, PAYPAL_ACCEPT, PRE_TERMINATED, SHIPPING_TO, FEE_INSERTION, FEE_FINAL, FEE_LISTING, PIC_XXL, PIC_DIASHOW, PIC_COUNT, ITEM_SITE_ID FROM Sales WHERE Product_NO = ?")) FROM SaleS WHERE PRODUCT_NO = ?")) { 
```

我假设它应该看起来像这样：

```
if ($getRecords = $con->prepare("SELECT Product_NO, Product_NAME, SUBTITLE, CURRENT_BID, START_PRICE, BID_COUNT, QUANT_TOTAL, QUANT_SOLD, ACCESSSTARTS, ACCESSENDS, ACCESSORIGIN_END, USERNAME, BEST_BIDDER_ID, FINISHED, WATCH, BUYITNOW_PRICE, PIC_URL, PRIVATE_AUCTION, AUCTION_TYPE, ACCESSINSERT_DATE, ACCESSUPDATE_DATE, CAT_DESC, CAT_PATH, COUNTRYCODE, LOCATION, CONDITIONS, REVISED, PAYPAL_ACCEPT, PRE_TERMINATED, SHIPPING_TO, FEE_INSERTION, FEE_FINAL, FEE_LISTING, PIC_XXL, PIC_DIASHOW, PIC_COUNT, ITEM_SITE_ID FROM Sales WHERE Product_NO = ?")) { 
```

# java - 从源头获取和获取java程序的I/O

> ID：503195
> 
> 赞同：3
> 
> 时间：2009-02-02T13:24:09.083
> 
> 标签：java

如何编写一个程序来运行另一个 java 程序（应该调用该程序）从该程序向该程序提供输入并获取输出并将输出打印到文件中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-02T13:27:05.647

使用[ProcessBuilder](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/ProcessBuilder.html)

例子：

```
ProcessBuilder pb = new ProcessBuilder("myCommand", "myArg1", "myArg2");
Process p = pb.start();
InputStream in = p.getInputStream();
OutputStream out = p.getOutputStream();

// Write to input of the program using outputstream here
...

// Read output of program from input stream here
// ...

FileOutputStream fileOut = new FileOutputStream("output.txt");
BufferedInputStream bIn = new BufferedInputStream(in);

byte buf = new byte[4096];
int count;

while ((count = bIn.read(buf)) != -1) {
    fileOut.write(buf, 0, count);
}

...
fileOut.close();
bIn.close();

// Exception handling is left as an exercise for the reader :-P 
```

# javascript - 如何通过浏览器确定远程服务器的延迟

> ID：503199
> 
> 赞同：16
> 
> 时间：2009-02-02T13:25:21.657
> 
> 标签：javascript, flash, browser, latency, ping

我运行了几个游戏隧道服务器，并希望有一个页面，客户端可以在其中对所有服务器运行 ping 并找出响应速度最快的服务器。据我所知，在 JavaScript 中似乎没有合适的方法来执行此操作，但我在想，是否有人知道在 Flash 或其他一些客户端浏览器技术中执行此操作的方法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-18T16:44:51.637

大多数小程序技术，包括 Javascript，都执行同源策略。可以动态添加 DOM 元素，例如图像，并使用 onload 事件处理程序收集时间信息。

伪代码

```
for (server in servers) {
  var img = document.createElement('IMG');
  server.startTime = getCurrentTimeInMS();
  img.onload=function() { server.endTime = getcurrentTimeInMS(); }
  img.src = server.imgUrl;
} 
```

然后等待适当的时间并检查每个服务器对象的时间。根据需要重复并根据需要计算平均值。我不确定您可以期待什么样的准确性。

缺点：

*   您可能使用了错误的工具来完成这项工作。没有为此类应用程序配备浏览器。
*   这可能是非常不准确的。
*   如果您请求的资源被缓存，它不会给您想要的结果，但您可以通过每次更改 url 来解决这个问题。
*   与正常 ping 相比，这是带宽密集型的。使图像变小，例如 spacer.gif 文件。
*   时间不仅取决于远程服务器的延迟，还取决于该服务器的带宽。这可能或多或少有用，但重要的是要注意它不仅仅是延迟。
*   您需要能够为来自不同服务器的 HTTP 请求提供服务，并且至关重要的是，每个服务器应该提供完全相同的资源（或相同长度的资源）。服务器上的条件会影响响应时间，例如一台服务器正在压缩数据而另一台没有。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-21T21:12:43.560

在调用服务器之前，记录下 Javascript 时间：

```
var startTime = new Date(); 
```

从服务器加载图像：

```
var img = new Image()
img.onload = function() {
    // record end time
}
img.src = "http://server1.domain.com/ping.jpg"; 
```

请求完成后，再次记录时间。（当然，鉴于请求没有超时。）

```
var endTime = new Date(); 
```

您的 ping 以毫秒为单位：

```
var ping = endTime. getTime() - startTime.getTime(); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-21T21:31:57.587

您真正需要的只是从连接开始到第一次就绪状态更改的时间......

```
函数 getPing() {
  变量开始；
  var 客户端 = getClient(); // xmlhttp请求对象
  client.onreadystatechange = function() {
    if (client.readyState > 0) {
      pingDone（开始）；//处理ping
      客户端.onreadystatechange = null; //删除处理程序
    }
  }

  开始 = 新日期（）；
  client.open("HEAD", "/ping.txt"); //静态文件
  客户端.send();
}

功能 pingDone(开始) {
  完成 = 新日期（）；
  ms = done.valueOf() - start.valueOf();
  alert(ms + "ms ping 时间");
}

函数 getClient() {
  如果（窗口.XMLHttpRequest）
    返回新的 XMLHttpRequest();

  如果（窗口。ActiveXObject）
    返回新的 ActiveXObject('MSXML2.XMLHTTP.3.0');

  throw("没有可用的 XMLHttpRequest 对象。");
}

```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T20:28:27.950

这是一种`<iframe>`方法：

[![](https://i.stack.imgur.com/YUKv9.png "服务器延迟")](https://i.stack.imgur.com/YUKv9.png "服务器延迟")
[（来源：[magnetiq.com](http://magnetiq.com/exports/server_ping.png)）]

`<table>`创建一个包含两列的表（不一定是字面意义上的）。第一列将包含服务器的名称（可能还有指向它们的链接）。第二列具有从各个服务器加载探测文档的 iframe。每个探测文档都会在初始获取请求上执行此操作：

1.  获取当前系统时间
2.  在将系统时间作为查询参数传递的同时，重定向 (302) 到第二个探测文档
3.  第二个探测文档读取当前系统时间，根据传递给它的初始读数计算增量，并以大字体显示。此增量将是服务器以重定向响应响应客户端所用的时间加上客户端向重定向目标发出第二次请求所用的时间。它不完全是“ping”，但它是客户端与每个服务器的相对延迟的可比较度量。实际上，这是从服务器到客户端的“反向 ping”。

您将在不违反同域策略的情况下使用 iframe，因为根本没有尝试操纵 iframe 内容。玩家将简单地用他/她的眼睛看到这些值，而您将依赖于用户浏览数字并单击最有意义的服务器链接。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-25T04:28:40.713

任何发出 HTTP 请求的东西（就像这里的大多数答案一样）通常测量的延迟至少是正常 ping 看到的延迟的两倍，因为您至少需要三向握手和终止数据包（两次往返而不是一次）。如果您发出 HTTP 请求，请尽量减少标头。足够长的标头（由于聊天服务器或客户端上的 cookie 等）可能会增加额外的往返行程，从而影响您的测量结果。

正如 Cherona 所指出的，如果您已经与服务器建立了活动的 HTTP 2 连接，或者如果服务器使用 HTTP 3，那么情况可能并非如此。

最准确的选择是打开到每个服务器的 websocket 连接，并测量发送微小消息和接收微小响应所需的时间（在建立连接之后）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-02T13:32:19.193

如果您正在谈论在客户端运行某些东西，由于安全原因，我不确定这是否可行。

也许你最好的选择是一个 java 小程序——但这需要再次检查本地安全策略。

如果我尝试在 JS 中考虑一些 hack 来做到这一点，也许你可以尝试发送一个带有回调函数的异步请求，该函数测量它所花费的毫秒数——但这只是我的想法。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-22T19:29:58.933

在 Flash 中测量服务器响应时间并不难。

Flash 必须在访问远程服务器之前请求策略文件。此类策略文件的默认位置是服务器的根文件夹：/crossdomain.xml

（您可以轻松找到有关跨域文件格式的信息）

既然无论如何都需要这样的文件，为什么不使用它来测量服务器响应时间呢？加载文件本身而不是图像，并使用 getTimer() 测量它所花费的时间。

这将为您提供对 HTTP 连接的良好估计。

但如果您正在处理游戏服务器，您可能需要直接检查 TCP 连接的速度。为此，您需要使用 flash.net.Socket 您还必须首先通过运行请求策略文件： Security.loadPolicyFile("xmlsocket://server.domain.com:5342");

其中 5342 表示您的服务器的端口号，它应该使用正确的 XML 策略字符串进行响应。建立套接字连接后，任何请求/响应都会让您测量不同的服务器响应时间。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-21T20:59:45.543

'file pings' 的问题在于您将评估 http 服务器响应，而您所服务的游戏的目标资源可能具有非常不同的行为，从而导致不同的延迟。

只是一个出乎意料的想法，根据实际情况甚至可能不切实际：但是，根据通常由服务器在游戏过程中执行的短任务序列（例如打开 RTMP）制作服务器脚本不是很有趣连接，检索信息，发回）。根据服务器的总数，您几乎可以同时打开它们并将第一个响应定义为获胜者（减去您的客户端独立处理每个查询所需的时间）。

当然，从服务器端来说，这是一种相当昂贵的方法，但至少你会希望得到一个可靠的结果（服务器和网络延迟的总和）。即使评估需要几秒钟，这也只是整个游戏乐趣的一小部分。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-03-29T19:42:53.370

根据@Mr. 的回复。Shiny 和@Georg Schölly 是一个完整且带有注释的示例。

为了测试，只需将以下代码以相同的顺序复制并粘贴到空的 .html、.php 或其他兼容文件中。

在开始获取之前，记录当前的 Javascript 时间。使用`new Date()`，我们使用当前日期和时间创建一个新的日期对象。

```
<script type="text/javascript">

var startTime = new Date(); 
```

现在让我们创建一个 html 对象图像，仍然没有源代码，并将其归因于变量 img。

```
var img = new Image(); 
```

下一个特征是在图像中放置一个源。.src 反映了 src html 属性。重要的！将您的 img.src 指向一个非常小且轻量级的图像文件，如果可能的话小于 10KB。

为了防止缓存，在文件末尾添加了一个随机参数，在 .png 扩展名之后。

```
var random_string = Math.random().toString();
img.src = "http://static.bbci.co.uk/frameworks/barlesque/5.0.0/orb/4/img/bbc-blocks-dark.png" + "?" + random_string; 
```

现在我们可以调用我们的函数，该函数将在图像加载时运行，因为 .onload：

```
img.onload = function() {
    var endTime = new Date();
    var ping = endTime. getTime() - startTime.getTime();
    alert(img.src + " loaded in " + ping + " ms");
}
</script> 
```

在函数内部，我们有一个变量 endTime，它接收源图像加载后的日期时间。

最后，ping 变量接收初始时间减去最终时间。警报弹出窗口显示结果。

# linq - 如何将由 IQueryable 对象创建的 Expression 的执行转移到 IEnumerable？

> ID：503208
> 
> 赞同：3
> 
> 时间：2009-02-02T13:27:42.853
> 
> 标签：linq, ienumerable, expression, iqueryable

在我的代码中，我想让我的存储库 IQueryable。这样，选择的标准将是一个 linq 表达式树。

现在，如果我想在理论上模拟我的存储库，这很容易：只需实现我的存储库的接口（这也是一个 IQueryable 对象）。

我的模拟存储库实现将只是一个内存集合，但我的问题是：你知道一种简单的方法来实现我的模拟的 IQueryable 接口，将查询传输到我的内存集合（IEnumerable）吗？

感谢您的答复，

***一些精度***

我的存储库的客户端对象将以这种方式使用我的存储库：

var result = from entry in MyRepository where entry.Product == "SomeProduct" 选择条目；

ToList 或 AsEnumerable 的作用是执行查询并将结果作为 List 或 IEnumerable 返回。但是我必须在我的存储库上实现 IQueryable 接口，并使用 IQueryProvider 将调用中的表达式转换为 IEnumerable 对象。

***解决方案***

该解决方案的实现是将调用 IQueryable 委托给我使用 AsQueryable 的内存集合。

```
public class MockRepository : IQueryable<DomainObject>
    {
        private List<DomainObject> inMemoryList = new List<DomainObject>();

        #region IEnumerable<DomainObject> Members

        public IEnumerator<DomainObject> GetEnumerator()
        {
            return inMemoryList.GetEnumerator();
        }

        #endregion

        #region IEnumerable Members

        IEnumerator IEnumerable.GetEnumerator()
        {
            return inMemoryList.GetEnumerator();
        }

        #endregion

        #region IQueryable Members

        public Type ElementType
        {
            get
            {
                return inMemoryList.AsQueryable().ElementType;
            }
        }

        public Expression Expression
        {
            get
            {
                return inMemoryList.AsQueryable().Expression;
            }
        }

        public IQueryProvider Provider
        {
            get
            {
                return inMemoryList.AsQueryable().Provider;
            }
        }

        #endregion
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T13:50:50.107

在你的模拟上使用[AsQueryable](http://msdn.microsoft.com/en-us/library/bb353734.aspx)。现在它们是可查询的，您可以像对待任何其他可查询的一样对待它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T13:35:02.680

可以用扩展方法吗

```
.ToList<> 
```

# language-design - 为什么许多语言区分大小写？

> ID：503218
> 
> 赞同：46
> 
> 时间：2009-02-02T13:30:18.917
> 
> 标签：language-design, case-sensitive

为什么许多语言区分大小写？

仅仅是继承的问题吗？C++ 是区分大小写的，因为 C 是，Java 是区分大小写的，因为 C++ 是，等等？还是背后有更务实的原因？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-02-02T13:34:35.147

我认为您不会得到比“因为该语言的作者认为那样更好”更好的答案。就个人而言，我认为他们是对的。我不想在同一个源文件中的任何地方找到这些行（并引用同一个对象+方法）......

```
SomeObject.SomeMethod();
...
SOMEOBJECT.SOMEMETHOD();
...
someObject.someMethod();
...
sOmEoBjEcT.sOmEmEtHoD(); 
```

我想没有人会高兴看到这个...

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2009-02-02T15:19:12.660

Unix。

Unix 是区分大小写的，因此为在 Unix 上使用而开发的许多编程语言都区分大小写。

计算机不会宽容-大写字符与小写字符不同，它们完全不同。而在处理周期、RAM 等很昂贵的时候，强迫编译器和计算机“宽容”的努力并不值得，人们只是想让这些东西正常工作。

[请注意，在Visual Basic](http://en.wikipedia.org/wiki/Visual_Basic)出现之前，不区分大小写并没有真正成为有用的东西——一旦公司开始投资于让大众编程对他们的底线是一件好事的概念（即，微软赚更多的钱，如果Windows 上有更多程序）语言是否开始变得更友好和更宽容。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-02-02T13:40:49.627

要考虑的一件有趣的事情是英语也区分大小写。（我怀疑这对大多数自然语言都是正确的，但可能并非对所有人都是正确的。）

有一个很大的区别（我住的地方，无论如何，在雷丁镇附近）：

> 我喜欢读书。

和

> 我喜欢读书。

同样，虽然很多人*确实*大写不正确，并且您通常可以理解其含义，但这并不意味着这样的写作被认为是*正确*的。当涉及到这种事情时，我是一个固执己见的人，当然，这并不是说我自己做对了一切。我不知道这是否是编程语言区分大小写继承的一部分，但我怀疑它可能是。

编程语言区分大小写的一个明显优势是文本也变得不区分*文化*。不得不偶尔向编译器说明源文件使用哪种文本编码已经够糟糕了——必须指定它所在的*文化*会更糟:(

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2009-02-02T13:35:40.637

对于开发人员和语言语法规范来说，这实际上是非常实用的：小写/大写的区别为标识符命名增加了大量的表现力。

从语言语法的角度来看，您可以强制某些标识符以小写或大写开头（例如 Java 类名）。这使得解析更容易，因此有助于保持语法简洁。

从开发人员的角度来看，这允许大量方便的编码约定，使您的代码更清晰、更易于理解。

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2009-02-02T13:35:19.343

我的猜测是区分大小写会扩大名称空间。一个不错的技巧，例如

```
MyClass myClass; 
```

使用不区分大小写的编译器是不可能的。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2009-02-02T13:43:39.433

大小写折叠仅在英语中很简单（并且对于所有字符 < 128）。德语[sz 或 "sharp s" (ß)](http://en.wikipedia.org/wiki/%C3%9F)在 ISO 8859-1 字符集中没有大写变体。[经过大约十年的讨论](http://en.wikipedia.org/wiki/%C3%9F#Capital_.C3.9F)，它只收到了一个 Unicode 格式（现在，所有字体都必须更新......）。汉字和平假名（日语字母）甚至不知道小写。

*为了避免这种混乱，即使在这个 Unicode 时代，允许大小写折叠和*Unicode 标识符也是不明智的。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2009-02-02T13:35:25.583

回到当解析和编译真的很昂贵并且需要整晚的时候，如果它不必担心大小写，这对编译器来说是有利的。

一旦出现仅通过其案例唯一的标识符，就很难再返回了。许多开发人员喜欢它，并且似乎并没有很大的意愿撤消它。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2009-02-14T19:03:46.247

**ExpertSexChange**

我相信这是 Stack Overflow 的竞争对手，您必须付费才能阅读答案。嗯...不区分大小写，站点名称的含义是模棱两可的。

这是语言区分大小写的一个很好的理由。少一点歧义！对程序员的模棱两可被认为是令人讨厌的。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2009-02-02T13:40:30.377

通过使用命名约定，区分大小写增加了语言的可读性。你不能写

```
Person person = new Person("Bill"); 
```

如果您的语言不区分大小写，因为编译器无法区分类名和变量名。

此外，如果让 Person、person、Person、PersoN、PersOn 和 PERSON 都是等价的标记，我会很头疼。:)

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2009-02-02T15:58:15.840

**i**的大写形式是什么？**我**（U+0049）还是我（U+ **0130**）？

大小写取决于语言环境。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2009-02-02T15:12:02.890

因为他们像*一盒青蛙一样愚蠢*，正是因为在这个线程中给出了相反观点的原因（我什至不会问那是什么。木头换树等等）。

当 FOOBAR = FooBar = foobar 时，您可以选择您的约定，其他编码人员也可以这样做，*无论他们是否同意您的偏好*。没有混乱。

他们也无法摆脱天才的一击，即在同一个文件中具有相同名称的常量、函数和变量，尽管大写不同。再次，没有混淆。

你调用你的变量网站，他们调用他们的网站，哪个系统会混淆？扫描时也不是一件容易的事。

至于查找，在查找之前将名称转换为小写真的需要更多处理吗？进行自己的过早优化是一回事，期望从您选择的语言的开发人员那里得到它是完全不同的层次。

...然而，所有这些说区分大小写的答案减少了混淆。*叹*

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2009-02-02T15:13:41.297

许多（非编程）语言（例如使用罗马字母的欧洲语言）都区分大小写，因此这些语言的母语人士使用大写/小写区分是很自然的。

*编程语言不*区分大小写的想法是由于早期硬件（包括使用 5 位字符代码的计算机前电传机）的限制而产生的历史产物。

主张区分大小写语言的人一定无法区分

```
IAmNowHere 
```

从

```
IAmNowhere 
```

（*这是个玩笑！* ;-)

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-02-02T13:48:32.000

如果你没有帽子，你怎么大喊大叫？！啊！

你必须富有表现力。但老实说，在世界上所有的人中，那些从事编程逻辑工作的人会是第一个坚持差异实际上就是差异的人。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-02-02T15:31:06.130

还有 Common Lisp，它是一种区分大小写的语言，许多人错误地认为它不区分大小写。当您输入`(car x)`Listener 时，它会变成`(CAR X)`进行处理。可以使用小写名称定义符号，但必须用类似`|lower-case-symbol|`. 因此，输入`(car x)`or`(CAR X)`或`(Car X)`all 的工作方式相同。

（Franz Lisp 一度引入了他们所谓的“现代”大写，其中 Listener 不会折叠大小写，而 CL 关键字将小写。我从来没有很好地遵循它，以至于不知道那里发生了什么。）

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2009-02-02T18:31:34.173

字母的大写[不是一个通用的概念](http://www.moserware.com/2008/02/does-your-code-pass-turkey-test.html)。Java 使用 Unicode，因此如果您想要不区分大小写的 Java，程序的含义可能会根据编译的语言环境而改变。

大多数语言不允许您将点或逗号（或撇号或空格）放在整数文字的中间，可能是因为这也取决于语言环境。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2009-02-14T18:31:25.030

来自 .NET Framework Developer's Guide [Capitalization Conventions](http://msdn.microsoft.com/en-us/library/ms229043.aspx)，区分大小写：

> 大写指南的存在只是为了使标识符更易于阅读和识别。大小写不能用作避免库元素之间名称冲突的方法。
> 
> 不要假设所有编程语言都区分大小写。他们不是。名称不能仅因大小写而异。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2015-12-08T22:34:55.727

我已经阅读了整个线程。我必须相信那些报告发现区分大小写的价值的人从未使用真正的高级语言（根据定义不区分大小写）进行编程。K&R 承认 C 是中等水平。在使用 Pascal、Delphi、Lazarus、ADA 等进行编程后，人们了解到高度可读的代码很容易编写并且可以快速运行，而不必拘泥于简洁的区分大小写的结构。毕竟，可读性是关于这个主题的第一个也是最后一个词。代码是为人编写的，而不是为计算机编写的。使用不区分大小写的代码进行调试没有问题。当一个人转向一种中级语言时，会发现区分大小写没有任何优势。然而，调试区分大小写所花费的大量时间会导致问题。尤其是在将来自不同编码器的模块拼凑在一起时。似乎还有很多受访者不理解不区分大小写的含义。只有字符 az 受到影响。这些是 ASCII 字符的顺序子集。三个或四个字节的机器代码使编译器在这个字符范围内对大小写不感兴趣。它不会改变下划线、数字或其他任何内容。关于其他语言和字符集的要点根本不适用于此讨论。编译器或中断器将被编码为临时转换或不转换字符以在编译时根据是否为 ​​ASCII 进行分析。这些是 ASCII 字符的顺序子集。三个或四个字节的机器代码使编译器在这个字符范围内对大小写不感兴趣。它不会改变下划线、数字或其他任何内容。关于其他语言和字符集的要点根本不适用于此讨论。编译器或中断器将被编码为临时转换或不转换字符以在编译时根据是否为 ​​ASCII 进行分析。这些是 ASCII 字符的顺序子集。三个或四个字节的机器代码使编译器在这个字符范围内对大小写不感兴趣。它不会改变下划线、数字或其他任何内容。关于其他语言和字符集的要点根本不适用于此讨论。编译器或中断器将被编码为临时转换或不转换字符以在编译时根据是否为 ​​ASCII 进行分析。

我对像 Python 这样的新语言重复了 K&R 所犯的错误感到震惊。是的，他们在编译器、源代码和目标代码的总 RAM 为 1000 字节的环境中节省了 6 个字节。那时就是这样。现在内存不是问题。现在，莫名其妙地，即使是 Python 中的保留字也是区分大小写的！我认为我不需要使用“Print”的“For”作为变量或函数名。但是这种可能性已经被保留下来，因为在每个标识符的确切情况下满足中断器所花费的时间是昂贵的。我认为这是一笔糟糕的交易。

迄今为止，我读过的支持区分大小写的最接近的内容是关于 Hashing 的评论。但是，这些罕见的编码事件可以通过仔细注意细节来处理，但似乎不值得编码人员在编写区分大小写的代码时进行毫无意义的审查。对问题的两种看法。一种是鼓励糟糕的编码，在代码中设置陷阱，并且需要额外的注意力才能转移到更大的概念上。另一个没有缺点，在高级语言中完美地工作，并且在没有害处的情况下允许灵活性。在我看来，这就像 VHS 战胜 BETA 的又一案例。这只是我的两分钱在这里。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-02-02T14:02:38.587

这里的很多人都说过，用几种形式的大写来指代同一个东西是不好的，例如：

```
person
perSoN
PERSON 
```

真正糟糕的是，如果这些都在代码中引用了不同的对象。如果你有变量 person、perSoN 和 PERSON 都指不同的东西，那么你就有问题了。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2009-02-02T14:09:00.303

区分大小写并不能真正帮助大小写一致性。

```
Foo.Bar  
foo.Bar  
fOO.bAR 
```

在不区分大小写的语言中，编辑器可以轻松地自动修复。在区分大小写的语言中修复它更难，因为它可能是合法的。编辑器首先必须检查 foo.Bar 和 fOO.bAR 是否存在，并且还必须猜测您输入的大小写错误，而不是忘记声明变量（因为 Foo 与 fOO 不同）。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2009-04-22T07:28:12.620

我认为使用区分大小写的语言会鼓励人们编写糟糕的代码。

```
Const SHOESIZE = 9

Class ShoeSize

ShoeSize.shoesize = SHOESIZE

call shoeSize(ShoeSize);

function shoeSize(SHOEsize)
{
   int ShoeSIZE = 10
   return ShoeSize
} 
```

呃。对于不同的目的，您想不出比“ShoeSize”更好的变量名吗？您可以使用十亿个不同的词，但您选择继续使用 ShoeSize？

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2009-12-23T17:19:16.170

我看到的每个支持区分大小写的示例都是基于编写糟糕的、无法描述的代码的愿望。例如“日期”与“myDate”的论点——这些都是*同样不具描述*性和不好的做法。好的做法是将其命名为实际名称：birthDate、hireDate、invoiceDate 等等。谁在他们的头脑中会想要编写如下代码：

```
Public Class Person
    Public Shared ReadOnly PERSON As Person
End Class
Public Class Employee
    Public person As Person = person.PERSON
End Class 
```

**令人惊讶的是，这在**敏感的 VB.Net 代码中是完全有效的情况。区分大小写允许您甚至更公然违反良好的编程习惯的想法是反对它的论据，而不是支持它。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-02T14:16:24.797

因为很多人发现employeeSocailSecurityNumber 和employee_social_security_number 一样易读，而且更短。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-04-24T04:51:32.483

您也可以（愚蠢地）对所有类、变量、函数和方法只使用单字母（“a”、“b”和“c”）。

但是你*为什么*想要？

**使用有意义的名称**，而不是：

```
function a(a)
{
    int a = a.a;
    return a
} 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2014-04-04T14:45:25.597

> 按照典型的编码标准，Person 是一个类，person 是变量名，PERSON 是常量。使用具有不同大小写的相同单词来表示相关但略有不同的事物通常很有用。

因此，如果您的企业中有 3 名员工都叫 Robert，您会称他们为 Robert、robert 和 ROBERT，对吗？并依靠人们确切地知道您的意思是哪一个？

如果您的电子邮件系统区分大小写，请给他们电子邮件地址，例如 Robert@widgets.com、robert@widgets.com 和 ROBERT@widgets.com？

未经授权的个人数据泄露的可能性将是巨大的。更不用说您是否将数据库根密码发送给即将被解雇的心怀不满的员工。

最好叫他们鲍勃、罗比和罗伯特。如果他们的姓氏是 Arthur、Banks 和 Clarke，最好还是称他们为 Robert A、Robert B 和 Robert C

真的 - 为什么会有一个会引起错误或混淆的命名约定，这依赖于人们非常警觉？你的词汇量这么少吗？

至于提到所谓的方便技巧“MyClass myClass”的人 - 为什么，为什么？你故意让人难以一眼看出使用的方法是类方法还是实例方法。

另外，您失去了告诉下一个阅读您的代码的人更多关于该类的特定实例的机会。

例如。

上一个客户

客户新客户

客户公司客户

理想情况下，您的实例名称需要告诉您的同事，而不仅仅是它所基于的类！

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2016-04-27T21:40:10.613

通过示例学习总是更容易，所以这里是：

C#（区分大小写但可从不区分大小写的 VB.NET 中使用）：

```
CONSTANT_NAME
IInterfaceName // Uses I prefix in all case sensitive and insensitive languages
ClassName      // Readable in both case sensitive and insensitive languages
_classMember   // sometimes m_classMember or just classMember
DoSomething(someParam) // Method with action name, params can be _someParam
PropertyName   // Same style in case sensitive and insensitive languages
localVariable  // Never using prefix 
```

Java 和 JS 使用类似于 C# 的样式，但方法/函数/事件被声明为变量 doSomething、onEvent。

ObjectPascal（Delphi 和 Lazarus/FPC 不区分大小写，如 ADA 和 VB.NET）

```
CConstantName     // One can use Def or no prefix, not a standard
IInterfaceName
TClassName        // Non-atomic types/classes have T prefix e.g. TStructRecordName
PSomePointer      // Pointers have types, safer low level stuff
FClassFieldMember // F means Field member similar to m
DoSomething(Parameter) // Older code uses prefix A for parameters instead
PropertyName
LLocalVariable    // Older code uses prefix for parameters not local vars 
```

仅对每种类型使用 OneCase 和前缀在所有语言中都是有意义的。即使是没有前缀的语言也有更新的结构，比如不依赖大小写而是使用前缀的接口。

因此，语言是否区分大小写并不重要。新概念被添加到区分大小写的语言中，这些语言过于混乱，无法单独用大小写来表达，并且需要使用前缀。

由于区分大小写的语言开始使用前缀，因此停止使用具有相同标识符名称 someIdentifier SomeIdentifier SOME_IDENTIFIER、ISomeIdentifier 的大小写并仅在有意义的地方使用前缀是合理的。

考虑这个问题：您有一个名为 something 的类成员、一个名为 something 的方法/函数参数和一个名为 something 的局部变量，可以使用什么大小写约定来轻松区分这些？在任何地方都使用最一致的CaseStyle并添加前缀不是更容易吗？

不区分大小写语言的粉丝关心代码质量，他们只想要一种风格。有时他们接受这样一个事实，即一个库编写得不好并使用严格的样式，而该库可能没有样式或代码很差。

区分大小写和不区分大小写的语言都需要严格的纪律，到处只有一种风格更有意义。如果我们有一种只使用 StrictCase、一种风格和前缀的语言，那就更好了。

有很多糟糕的 C 代码，区分大小写不会使其可读，您对此无能为力。在不区分大小写的语言中，您可以在代码中强制使用良好的样式，而无需重写库。在尚不存在的 StrictCase 语言中，所有代码都将具有良好的质量:)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-04-22T07:30:50.240

> 我的班级我的班级；使用不区分大小写的编译器是不可能的。

或者你可能很聪明，实际上使用了 2 个不同的词......这可以更好地展示你实际想要做的事情，比如：

> 我的类我的汽车设计；

呃。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2014-03-02T12:34:40.120

语言区分大小写还有另一个原因。ID 可以存储在哈希表中，并且哈希表依赖于哈希函数，这些函数将为不同的情况提供不同的哈希值。在通过散列函数运行它们之前，将所有 ID 转换为全部大写或全部小写可能并不方便。我在编写自己的编译器时遇到了这个问题。将我的语言声明为区分大小写要简单得多（更懒惰）。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2015-10-15T10:02:29.330

如果单词分隔不重要，那么我们为什么要在单词之间放置空格？因此，我认为名称中单词之间的下划线确实会增加可读性。此外，适当字符大写的小写字母最容易阅读。最后，如果所有的词都可以通过口耳相传来传达，那肯定会容易得多——“Corporate Underscore Customer”而不是“Capital C Lower Case orporate Underscore Capital C Lower Case ustome r”！- 前者可以“在脑海中”说出后者不能 - 我想知道那些对区分大小写感到满意的人如何在他们的大脑中处理这些区分大小写的名称 - 我真的很挣扎。所以我觉得区分大小写根本没有帮助——在我看来，这是 COBOL 的倒退。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2017-01-15T14:05:45.090

因为人们严重地想太多事情。

不区分大小写在保留大小写并结合类型和变量命名空间之间的分离时效果最佳。这意味着：

*   如果您将一个类声明为 ' `TextureImage`'，然后尝试将其用作 ' `textureImage`'，IDE 可以自动更正您。这为您提供了一个优势，即除非您声明标识符或使用下划线，否则您永远不必按 shift 键。

*   就像在 Java 和其他几种语言中一样；输入“”是完全有效的`MyClass myClass`。IDE 和编译器在区分使用类型和使用变量时应该没有问题。

此外，不区分大小写保证 ' `o`' 和 ' `O`' 永远不会引用不同的对象。常见的论点包括：

*   " `sOmEoNe wIlL tYpE cOdE lIkE tHiS`"; =>*并且有人_永远不会_被允许加入编程团队，所以这是一个稻草人的论点。即使他们确实做到了，不区分大小写更多的是解决问题而不是问题，因为这意味着您不必记住他们使用的任何疯狂的大写/小写组合。*

*   “你不能轻易国际化不区分大小写！”; =>*超过 95% 的编程语言是用英语编写的，这是有充分理由的。没有竞争的字符编码，地球上绝大多数键盘都是基于英语的（部分或全部）。支持 unicode 标识符可能是 21 世纪任何人想出的最愚蠢的想法；因为很大一部分 unicode 字符是 frikkin 不可见的代理，所以无需使用谷歌翻译即可阅读代码，无需复制粘贴标识符或使用字符映射即可编写代码。*

*   “但区分大小写的语言有更多标识符！”；=>*不，它们有语法重载的标识符，这实际上更糟。*

我不使用任何不区分大小写的语言，但是如果您认真考虑这类事情，其优势是显而易见的。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2017-07-28T00:35:01.393

一个合理的答案可能是该语言的设计者认为这将使该语言更容易理解并考虑未来:)

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2009-02-02T17:23:44.687

看起来人们大多同意区分大小写很重要，我同意。

但是，当您必须以正确的大小写输入内容时可能会很烦人，因此我认为 IDE 应该让您输入错误的大小写，但如果您点击自动完成快捷方式，它应该进行不区分大小写的匹配。这给了我们两全其美。

# c# - Active Directory 的角色安全性

> ID：503220
> 
> 赞同：1
> 
> 时间：2009-02-02T13:31:51.953
> 
> 标签：c#, .net, asp.net, security

我必须确保工作中的 asp.net 网站的安全性。他们要求我对我的工作的活动目录进行基于角色的安全性，以便我可以制作站点地图并为正确的人提供正确的访问权限。

我应该使用哪类框架？制作通用身份？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T13:36:25.003

它已经内置到 AD 身份验证中。如果您通过 NTLM 登录或 AD 连接表单身份验证设置对 AD 进行身份验证，则线程身份将包含用户所属的组，并且站点地图控件的基于角色的部分将起作用。

具体来说，您使用*WindowsTokenRoleProvider*。这是一种单向角色管理器（您不能将人员添加到组 - 您必须为此使用 AD 工具。使用站点地图[内置的](http://msdn.microsoft.com/en-us/library/ms178428.aspx)支持根据角色修剪站点地图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T14:02:07.213

是的，您可以使用 RoleManager。看看[http://msdn.microsoft.com/en-us/library/ms998314.aspx](http://msdn.microsoft.com/en-us/library/ms998314.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T13:40:39.377

我需要通过 Active Directory 查找 Intranet 上的每个用户，然后根据用户拥有的角色和访问权限构建正确的菜单。

我应该使用 RoleManager 还是类似的类？

# wpf - 在 XAML 中怎么说：例如 TextBox 的默认宽度和高度

> ID：503233
> 
> 赞同：11
> 
> 时间：2009-02-02T13:36:29.247
> 
> 标签：wpf, xaml, textbox, font-size, autosize

所以我从 HTML 的角度来看 WPF。

我只想像这样`TextBox`在我的窗口上放一个：

```
<Grid>
    <TextBox Name="theName" />
</Grid> 
```

原来`TextBox`是巨大的，覆盖了整个窗口。（！）

好的，这不是我想要的，但我也不想定义确切的大小，因为我知道`Height`并且`Width`应该灵活，所以我尝试：

```
<TextBox Name="theName" Width="Auto" Height="Auto"/> 
```

一样。所以我尝试：

```
<TextBox Name="theName" 
    HorizontalAlignment="Stretch" 
    VerticalAlignment="Stretch"/> 
```

一样。所以我只是硬编码尺寸：

```
<TextBox Name="theName" Width="100" Height="20"/> 
```

我知道这在 WPF 中不是一个好的编程习惯。

那么，你如何告诉`TextBox`“显示正在使用的字体大小的默认大小”？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-02T14:48:20.537

你可以更进一步地举 Bryan 的例子。通过指定不拉伸的特定对齐方式并进一步约束 TextBox，使其不会扩展超过特定大小。例如：

```
<Grid x:Name="LayoutRoot">
        <TextBox HorizontalAlignment="Left" VerticalAlignment="Top" Text="TextBox" TextWrapping="Wrap" 
        MinWidth="15" MinHeight="20" MaxWidth="500" MaxHeight="50"/>
</Grid> 
```

您可以通过在 Grid 内设置行/列并以各种方式限制它们来进一步实现它。当您来自 HTML 背景时，可以将其想象为使用表格来控制布局。请记住，您还可以嵌套其他容器对象（即 StackPanels、WrapPanels、其他 Grids 等...）。

XAML 和 WPF/Silverlight 控件的挑战在于它们非常灵活，因此您必须掌握所有选项以及它们如何影响布局。

祝你好运。我现在正在经历同样的事情。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-02T13:57:25.490

使用不同的容器。Grid 总是拉伸其子控件以填充网格单元格。

例如，您可以使用仅在一个方向上拉伸其控件的堆栈面板。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-02T14:37:25.847

除了像 Stefan 提到的那样使用不同的面板之外，您还可以给 TextBox 一个非拉伸的对齐方式。例如

```
<TextBox Name="theName" HorizontalAlignment="Left" VerticalAlignment="Top"/> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T15:38:00.950

WPF 中的大小不是像素，它们是 1/96 英寸的“与设备无关的像素”——因此在今天的正常 DPI 设置中，它们将 1:1 映射到像素。

但是，如果您在高 DPI 模式下运行程序，TextBox 将随着 DPI（和字体）增长。

所以设置一个硬编码的大小并不是那么糟糕。

除此之外，您只能使用非“拉伸”的 Horizo​​ntalAlignment 和 VerticalAlignment，这会将 TextBox 的大小调整为内容 - 但是空的 TextBox 会很小。

您可以将 VerticalAlignment 设置为“Center”、“Top”或“Bottom”以获得大约一行的自动高度（可能由 MinHeight 设置支持以避免非常小的字体问题），然后设置 Width 使 TextBox 宽度不会随着用户输入而改变。

# c# - ASMX 页面返回旧的 Web 方法

> ID：503242
> 
> 赞同：2
> 
> 时间：2009-02-02T13:39:06.933
> 
> 标签：c#, asp.net, web-services

我一定很笨（我确定我犯了错误，但目前无法弄清楚）

实际上，我部署了包含对包含很少 Web 方法的类库的引用的 ASMX 页面。当我浏览该站点时，它会公开这些方法。但是有些它没有向我展示我在其中添加的任何其他方法。DLL 是强名称程序集。

有什么线索吗？

我尝试重新添加参考，但没有区别。

它工作但我不知道天气文件没有更新或引用，所以我做了什么，我删除了引用，从 bin 和 GAC 中删除了文件，然后重新添加了文件。重建后，我再次部署它们并且它工作.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T13:52:15.143

您需要更新添加到项目中的 Web 参考。如果类库包含 Web 引用，请更新其中的引用，然后重新添加/更新项目对类库的引用。如果您不更新，那么您的项目将知道的唯一存根/方法是首次添加 Web 引用时创建的存根/方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T14:40:37.090

还是与 GAC 有关。如果您的类库程序集作为旧版本位于 GAC 中，则不会更新。

# apache-flex - 从 Flex 2.0.1 升级到 Flex 3.* 时遇到问题了吗？

> ID：503245
> 
> 赞同：2
> 
> 时间：2009-02-02T13:39:32.827
> 
> 标签：apache-flex, upgrade

我问这个问题是为了收集 Flex 3.* 中所有不兼容的更改/错误修复，Flex 2.0.1 应用程序的维护者需要在升级之前了解这些更改/错误修复。我正在考虑以下性质的问题：

1.  2.0.1 中的错误有一些解决方法，并已在 3.* 中修复，使解决方法不仅无用而且错误。
2.  3.* 中引入的错误在 2.0.1 中有效，需要新的解决方法。
3.  行为略有不同的特征（事件、属性等）。
4.  不兼容的内部更改不应该影响程序员，*除非*他们像我一样干预了框架的内部对象。:-)
5.  任何不适合这些类别的东西。

（我发现了几个这样的问题，当我前段时间最后一次尝试时。不幸的是我没有做笔记，从那时起我就忘记了它们，但是当我再次弄清楚它们时我会更新这篇文章。我[报告了一个](https://bugs.adobe.com/jira/browse/SDK-14821)问题Adobe 错误跟踪站点，不幸的是，它被推迟了。）

了解这种升级的优点/缺点也会很有趣。有什么炫技吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T19:20:24.560

以下是一些可能对您有所帮助的链接：

[http://blogs.adobe.com/flexdoc/2008/02/migrating_from_flex_2_to_flex.html](http://blogs.adobe.com/flexdoc/2008/02/migrating_from_flex_2_to_flex.html)

[http://blog.comtaste.com/2007/06/migrate_from_flex_2_to_flex_3.html](http://blog.comtaste.com/2007/06/migrate_from_flex_2_to_flex_3.html)

[http://butterfliesandbugs.wordpress.com/category/flex-migration/](http://butterfliesandbugs.wordpress.com/category/flex-migration/)

[http://butterfliesandbugs.wordpress.com/2008/03/04/understanding-flex-3-migration-issues-part-i/](http://butterfliesandbugs.wordpress.com/2008/03/04/understanding-flex-3-migration-issues-part-i/)

[http://butterfliesandbugs.wordpress.com/2008/03/06/understanding-flex-3-migration-issues-part-ii/](http://butterfliesandbugs.wordpress.com/2008/03/06/understanding-flex-3-migration-issues-part-ii/)

[http://butterfliesandbugs.wordpress.com/2008/03/16/understanding-flex-3-migration-issues-part-iii/](http://butterfliesandbugs.wordpress.com/2008/03/16/understanding-flex-3-migration-issues-part-iii/)

作为记录，从 Flex 2 到 3 的大多数迁移问题都很轻微，特别是与从 Flex 1.x 迁移到 2 的问题相比。我升级了几个应用程序，完全没有问题。话虽如此，上述链接应该有助于注意您可能遇到的大多数问题。

# xml - 弹性树属性，空引用？

> ID：503251
> 
> 赞同：0
> 
> 时间：2009-02-02T13:42:31.090
> 
> 标签：xml, apache-flex, tree

我正在拉下一个大型 XML 文件，但我无法控制它的结构。

我使用自定义函数来使用标签名称将树结构视为 flex 树，但随后它中断了。我猜它与我的另一个函数有关，它从所选节点调用属性值。

见代码。

 `````
<mx:Tree x="254" y="21" width="498" height="579" id="xmllisttree"       labelFunction="namer" dataProvider="{treeData}" showRoot="false"  change="treeChanged(event)" /> 
```

//and the Cdata

```
import mx.rpc.events.ResultEvent; 
[Bindable] private var fullXML:XMLList;  
private function contentHandler(evt:ResultEvent):void{  
    fullXML = evt.result.page;  
}  

[Bindable]
public var selectedNode:Object;

public function treeChanged(event:Event):void {
selectedNode=Tree(event.target).selectedItem;
}

 public function namer(item:Object):String {
        var node:XML = XML(item);
        var nodeName:QName = node.name();
        var stringtest:String ="bunny";
            return nodeName.localName;
        } 
````  `错误是 TypeError：错误 #1009：无法访问空对象引用的属性或方法。

空引用在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T18:01:28.223

好的。听起来您的 XML 看起来像这样：

```
<root>
  <test>
    <child>leaf 1</child>
  </test>
  <test2>
    <child2>leaf 2</child2>
  </test2>
</root> 
```

这其中的重要部分是 child 和 child2 标记中有简单的内容。展开树以显示“叶 1”或“叶 2”会导致您收到错误，因为 node.name() 将返回 null。这是有道理的，因为 'leaf 1' 和 'leaf 2' 是文本节点并且没有节点名称。

要更正此问题，您可以将 namer 函数更新为以下内容：

```
public function namer(item:Object):String {
    var node:XML = XML(item);
    var nodeName:QName = node.name();
    if (nodeName) {
        return nodeName.localName;
    } else {
        return String(node);
    }
} 
```

这将使用“leaf 1”和“leaf 2”作为树中相应节点的标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T18:40:30.520

您是否尝试过在 flex builder 或 eclipse 中调试它？

最有可能出现空引用错误的是传递给 namer() 的“item”参数。树组件确实将字符串传递给 labelFuntion 方法，但它可能不是可以转换为 xml 对象的字符串。我肯定会先检查一下。

我可以看到的另一件事是错误的，您正在访问 localName ，就好像它是一个属性一样。它实际上是方法，因此您应该通过 nodeName.localName() 调用它。 **编辑...现在这是不正确的，因为我没有意识到 nodeName 是 QName 类型。localName 实际上是这种类型的一个属性。应用**

编辑：您的 Tree 组件也有一个 dataProvider

```
dataProvider="{treeData}" 
```

从您给出的示例中，它看起来不像 treeData 存在。那应该是fullXML吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T19:05:27.507

根据 Flex 和回答我另一个问题的人 (Herreman) 的说法，将 localname 称为属性是正确的做事方式。

fullXML 和 stringtest 行是工件。我将 XML 嵌入到同一个文件 atm.xml 中。

尝试绘制叶节点时返回 nodeName.localName 失败。所以我知道它与以下内容有关：

```
return nodeName.localName; 
```

和

```
public function treeChanged(event:Event):void {
selectedNode=Tree(event.target).selectedItem;
} 
```

# c# - 如何确定一个类型是否实现了特定的泛型接口类型

> ID：503263
> 
> 赞同：252
> 
> 时间：2009-02-02T13:50:39.793
> 
> 标签：c#, .net, reflection

假设以下类型定义：

```
public interface IFoo<T> : IBar<T> {}
public class Foo<T> : IFoo<T> {} 
```

当只有重整类型可用时，如何确定该类型是否`Foo`实现了泛型接口？`IBar<T>`

* * *

## 回答 #1

> 赞同：431
> 
> 时间：2009-02-02T14:25:33.000

通过使用 TcKs 的答案，也可以使用以下 LINQ 查询来完成：

```
bool isBar = foo.GetType().GetInterfaces().Any(x =>
  x.IsGenericType &&
  x.GetGenericTypeDefinition() == typeof(IBar<>)); 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-02-02T13:59:51.697

你必须向上遍历继承树，找到树中每个类的所有接口，*如果*接口是泛型的，则`typeof(IBar<>)`与调用结果进行比较。当然，这一切都有点痛苦。`Type.GetGenericTypeDefinition`

 *有关更多信息和代码，请参阅[此答案](https://stackoverflow.com/questions/457676/c-reflection-check-if-a-class-is-derived-from-a-generic-class)和[这些](https://stackoverflow.com/search?q=GetGenericTypeDefinition)答案。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-02-02T14:00:33.003

```
public interface IFoo<T> : IBar<T> {}
public class Foo : IFoo<Foo> {}

var implementedInterfaces = typeof( Foo ).GetInterfaces();
foreach( var interfaceType in implementedInterfaces ) {
    if ( false == interfaceType.IsGeneric ) { continue; }
    var genericType = interfaceType.GetGenericTypeDefinition();
    if ( genericType == typeof( IFoo<> ) ) {
        // do something !
        break;
    }
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-09-24T01:52:47.203

作为辅助方法扩展

```
public static bool Implements<I>(this Type type, I @interface) where I : class
{
    if(((@interface as Type)==null) || !(@interface as Type).IsInterface)
        throw new ArgumentException("Only interfaces can be 'implemented'.");

    return (@interface as Type).IsAssignableFrom(type);
} 
```

示例用法：

```
var testObject = new Dictionary<int, object>();
result = testObject.GetType().Implements(typeof(IDictionary<int, object>)); // true! 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-05-12T10:28:18.103

我正在使用@GenericProgrammers 扩展方法的稍微简单的版本：

```
public static bool Implements<TInterface>(this Type type) where TInterface : class {
    var interfaceType = typeof(TInterface);

    if (!interfaceType.IsInterface)
        throw new InvalidOperationException("Only interfaces can be implemented.");

    return (interfaceType.IsAssignableFrom(type));
} 
```

用法：

```
 if (!featureType.Implements<IFeature>())
        throw new InvalidCastException(); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-02-08T15:41:31.463

要完全处理类型系统，我认为您需要处理递归，例如`IList<T>`: `ICollection<T>`: `IEnumerable<T>`，没有它您将不会知道`IList<int>`最终实现了`IEnumerable<>`.

```
 /// <summary>Determines whether a type, like IList&lt;int&gt;, implements an open generic interface, like
    /// IEnumerable&lt;&gt;. Note that this only checks against *interfaces*.</summary>
    /// <param name="candidateType">The type to check.</param>
    /// <param name="openGenericInterfaceType">The open generic type which it may impelement</param>
    /// <returns>Whether the candidate type implements the open interface.</returns>
    public static bool ImplementsOpenGenericInterface(this Type candidateType, Type openGenericInterfaceType)
    {
        Contract.Requires(candidateType != null);
        Contract.Requires(openGenericInterfaceType != null);

        return
            candidateType.Equals(openGenericInterfaceType) ||
            (candidateType.IsGenericType && candidateType.GetGenericTypeDefinition().Equals(openGenericInterfaceType)) ||
            candidateType.GetInterfaces().Any(i => i.IsGenericType && i.ImplementsOpenGenericInterface(openGenericInterfaceType));

    } 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-02T13:55:12.343

您必须检查通用接口的构造类型。

你将不得不做这样的事情：

```
foo is IBar<String> 
```

因为`IBar<String>`表示该构造类型。您必须这样做的原因是，如果`T`在您的检查中未定义，编译器不知道您的意思是`IBar<Int32>`or `IBar<SomethingElse>`。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-02T14:03:12.483

首先`public class Foo : IFoo<T> {}`不编译，因为您需要指定一个类而不是 T，但假设您执行类似的操作`public class Foo : IFoo<SomeClass> {}`

那么如果你这样做

```
Foo f = new Foo();
IBar<SomeClass> b = f as IBar<SomeClass>;

if(b != null)  //derives from IBar<>
    Blabla(); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-12-14T23:31:40.113

如果您想要一个支持通用基类型和接口的扩展方法，我扩展了 sduplooy 的答案：

```
 public static bool InheritsFrom(this Type t1, Type t2)
    {
        if (null == t1 || null == t2)
            return false;

        if (null != t1.BaseType &&
            t1.BaseType.IsGenericType &&
            t1.BaseType.GetGenericTypeDefinition() == t2)
        {
            return true;
        }

        if (InheritsFrom(t1.BaseType, t2))
            return true;

        return
            (t2.IsAssignableFrom(t1) && t1 != t2)
            ||
            t1.GetInterfaces().Any(x =>
              x.IsGenericType &&
              x.GetGenericTypeDefinition() == t2);
    } 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-04-27T17:48:54.567

检查类型是否继承或实现泛型类型的方法：

```
 public static bool IsTheGenericType(this Type candidateType, Type genericType)
    {
        return
            candidateType != null && genericType != null &&
            (candidateType.IsGenericType && candidateType.GetGenericTypeDefinition() == genericType ||
             candidateType.GetInterfaces().Any(i => i.IsGenericType && i.GetGenericTypeDefinition() == genericType) ||
             candidateType.BaseType != null && candidateType.BaseType.IsTheGenericType(genericType));
    } 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-08-15T18:34:45.010

尝试以下扩展。

```
public static bool Implements(this Type @this, Type @interface)
{
    if (@this == null || @interface == null) return false;
    return @interface.GenericTypeArguments.Length>0
        ? @interface.IsAssignableFrom(@this)
        : @this.GetInterfaces().Any(c => c.Name == @interface.Name);
} 
```

来测试它。创造

```
public interface IFoo { }
public interface IFoo<T> : IFoo { }
public interface IFoo<T, M> : IFoo<T> { }
public class Foo : IFoo { }
public class Foo<T> : IFoo { }
public class Foo<T, M> : IFoo<T> { }
public class FooInt : IFoo<int> { }
public class FooStringInt : IFoo<string, int> { }
public class Foo2 : Foo { } 
```

和测试方法

```
public void Test()
{
    Console.WriteLine(typeof(Foo).Implements(typeof(IFoo)));
    Console.WriteLine(typeof(FooInt).Implements(typeof(IFoo)));
    Console.WriteLine(typeof(FooInt).Implements(typeof(IFoo<>)));
    Console.WriteLine(typeof(FooInt).Implements(typeof(IFoo<int>)));
    Console.WriteLine(typeof(FooInt).Implements(typeof(IFoo<string>)));
    Console.WriteLine(typeof(FooInt).Implements(typeof(IFoo<,>)));
    Console.WriteLine(typeof(FooStringInt).Implements(typeof(IFoo<,>)));
    Console.WriteLine(typeof(FooStringInt).Implements(typeof(IFoo<string,int>)));
    Console.WriteLine(typeof(Foo<int,string>).Implements(typeof(IFoo<string>)));
 } 
```

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2011-06-13T06:51:17.280

以下应该没有错：

```
bool implementsGeneric = (anObject.Implements("IBar`1") != null); 
```

如果您想为您的 IBar 查询提供特定的泛型类型参数，您可以捕获 AmbiguousMatchException 以获得额外的功劳。

# c# - 具有静态和动态内容的 WinForms UserControl 的最佳布局？

> ID：503267
> 
> 赞同：3
> 
> 时间：2009-02-02T13:51:14.397
> 
> 标签：c#, .net, winforms, layout

我有一个用户控件，它具有：a）顶部的按钮面板（它必须始终可见）b）带有在运行时动态添加和调整大小的控件的面板。控件可以有很多，因此面板必须是可滚动的。

此用户控件将托管在一个表单中，具有以下要求： a) 表单的初始大小将尽量适应动态内容的最大部分。b) 在更改表单大小时，必须相应地重新调整控件的大小。

我玩过各种锚定、对接和自动调整大小，但我并没有完全按照我想要的方式工作。有时，是滚动搞砸了，有时是别的东西。

面板的锚定、停靠和自动调整大小、用户控件、表单的哪种组合应该最有效地达到预期的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T15:30:37.363

我成功地满足了要求。这是我的解决方案：

动态面板固定在控件的顶部和底部。它没有 AutoSize，它在内容更改后手动更改其 MaximumSize 和 PreferredSize。

该表单使用以下方式托管表单：

```
 cntrl.AutoSize = true;
        cntrl.AutoSizeMode = System.Windows.Forms.AutoSizeMode.GrowAndShrink;
        cntrl.Dock = System.Windows.Forms.DockStyle.Fill; 
```

该表单订阅了一个自定义控件的事件，该事件通知了preferredHeight，并相应地更改了自己的Height。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T14:06:43.960

我会选择一个表格布局面板。您可以为顶部的按钮指定两行一列的确切大小，并用底部填充其余部分。然后为该区域的动态内容放置一个普通面板或一个flowlayoutpanel。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T13:57:30.000

在不知道您的问题的细节的情况下，我发现带有一个固定面板和/或固定滑块的多个填充对接拆分容器通常会产生非常方便的调整大小体验。您也可以非常有效地折叠面板。

# model-view-controller - 从 Grails 中的布局视图访问模型

> ID：503279
> 
> 赞同：5
> 
> 时间：2009-02-02T13:58:22.383
> 
> 标签：model-view-controller, grails, sitemesh

我在 Grails 中使用了布局支持（sitemesh），效果很好。我想调整我的布局以使其取决于用户是否登录。

我的 grails-app/views/layouts/main.gsp 包含以下代码：

```
<g:if test="${user}">
  Username: ${user.username}
</g:if> 
```

但是，似乎 layout-GSP:s 无法访问模型，因此无法访问用户变量（尝试时出现“无会话”异常）。使我的布局取决于用户是否登录的推荐方法是什么？

提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-02T15:13:31.593

我建议为此目的使用请求或会话范围。可能最干燥的方法是填充范围是一个过滤器。例如在文件 grails-app/conf/SecurityFilters.groovy 中（您需要创建它）：

```
class SecurityFilters {

    def filters = {
        populateCurrentUser(controller: '*', action: '*') {
            before = {
                 request.user = User.get(session.userId)
            }
        }
    }
} 
```

该示例假定您将当前用户的 id 存储在会话属性“userId”中，并且您有一个域类“User”。在布局中使用它就像这样简单：

```
<g:if test="${request.user}">
   Current User: ${request.user.username}
</g:if> 
```

# model-view-controller - UI 界面和 TDD 步骤

> ID：503285
> 
> 赞同：1
> 
> 时间：2009-02-02T14:01:00.350
> 
> 标签：model-view-controller, interface, tdd

好的，已经尝试了我的第一次 TDD 尝试，是时候反思一下并获得一些指导了，因为它对我来说并不是那么成功。该解决方案部分是使用现有框架制作的，这可能使 TDD 不太理想。似乎给我最大的问题的部分是视图和控制器之间的交互。我将举几个简单的例子，希望有人能告诉我哪些地方我可以做得更好。

每个视图的接口都继承自一个基本接口，具有以下成员（还有更多）：

公共接口 IView
{
void ShowField(string fieldId)
void HideField(string fieldId)
void SetFieldVisibility(string fieldId, bool visible)
void DisableField(string fieldId)
void ShowValidationError(string fieldId)
...
}

具体视图的接口，然后将为每个字段添加成员，例如这个公共接口 IMyView ： IView
{
string Name { get; 放; }
字符串 NameFieldID { 获取；}
...
}

你觉得这怎么样？从通用接口继承是好主意还是坏主意？给我带来麻烦的事情之一是，首先我使用了 ShowField 和 HideField，然后发现我宁愿使用 SetFieldVisiblity。我没有改变方法的结果，但我必须更新我的测试，我认为这应该是必要的。有多种方法做同样的事情是一件坏事吗？一方面，这两种方法在不同的情况下都很方便，但它们确实使界面变得混乱，使得界面比严格意义上的要复杂得多。

没有通用界面的设计会更好吗？那会删除 fieldID，我不知道为什么，但我认为 fieldID 的东西很臭，我可能错了。我只会在需要时制作 Show 和 Hide 方法，也就是说，如果它们会被控制器调用。这将是一个不太通用的解决方案，并且需要在视图中使用更多代码，但控制器代码会更简单一些。

因此视图界面可能如下所示： public interface IMyView
{
void ShowName()
void HideName()
string Name { get; 放; }
int 年龄 { 得到；放; }
}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-02T14:06:07.440

目前我并没有真正看到通用接口的附加值。

我认为更好的解决方案是在控制器类上有一些属性：IsControlXYZVisible。然后，您可以将控件的可见属性数据绑定到此属性。

并且您的单元测试将测试 IsControlXYZVisible 的值，这将更容易完成。

我也不明白你为什么说你对 TDD 有不好的体验。我认为您的应用程序架构需要更多的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T14:40:57.137

你的问题对我来说有点模糊，但标题本身需要一个链接：

[谦虚对话框](http://www.objectmentor.com/resources/articles/TheHumbleDialogBox.pdf)

当你问让两个函数做同样的事情是否不好时，我说“是的，这很糟糕”。如果一个调用另一个，那么有两个函数有什么意义？如果不是，你有代码重复，当您更新一个而不是另一个时，这是一个等待发芽的错误。

事实上，有一个有效的例子，你有两个几乎相同的函数：一个检查它的参数，一个不检查它的参数，但通常只有一个是公共的，另一个是私有的......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T15:08:01.527

你想测试什么？Show* 是否会使 UI 中的小部件可见？做什么的？

我的建议：不要试图弄清楚框架是否正常工作。这是浪费时间。开发框架的人应该这样做，所以你在重复他们的工作。

通常，您想知道您的代码是否正确。因此，如果您想知道是否调用了正确的方法，请创建模型：

```
public class SomeFrameworkMockup extends SomeFramework {
    public boolean wasCalled;
    public void methodToTest() {
        wasCalled = true;
    }
} 
```

使用模型构建 UI。

要测试的第二件事是您的算法是否有效。为此，请将它们隔离在简单的辅助对象中，您可以轻松地使用所有方法并使用各种输入对其进行测试。

在测试期间避免使用外部框架。它只会让你感到困惑。当您构建了一个工作产品后，使用鼠标对其进行测试。如果您发现任何问题，请找到问题的根源，然后才开始针对框架编写测试，以确保此错误不会再次出现。但是 90% 的情况下，这些错误也会出现在您的代码中。

# asp.net - SQL/Oracle DB 的数据层中的常用方法

> ID：503287
> 
> 赞同：0
> 
> 时间：2009-02-02T14:01:30.350
> 
> 标签：asp.net, ado.net

在 .NET 中，如果我的数据库是 SQL Server，那么在数据层中，我们有语句 SQLConnection、SQLCommand、SQLDataReader...

假设我们将 DB 更改为 oracle，那么我们需要将语句更改为 OracleConnection、OracleCommand、OracleDataReader 等等。

相反，我怎样才能拥有一些通用方法，以便在运行时基于 DB 类型调用相应的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T14:31:06.953

这就是微软在`System.Data`命名空间中实现与数据库无关的接口的原因。建议您查看`IDbConnection, IDbCommand, IDataReader, IDbDataParameter`封装基本功能但允许您支持多个数据库系统的其他方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T14:06:50.357

这是一个想法（不是运行时解决方案，但可能对您有用）...

使用一些虚拟方法（如 等）创建一个`IDataAccess`接口（或者可能是一个抽象类）`Get(), Update(), Delete()`。然后创建一些基类（如`SqlDataAccess`and `OracleDataAccess`），它们实现`IDataAccess`. 然后创建`RanjiniDataAccess`继承自`SqlDataAccess`或的类`OracleDataAccess`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T14:10:46.993

一种方法是使用 System.Data.OleDb 命名空间中定义的 OleDbConnection 等类 - 然后您应该能够通过更改连接字符串将您的应用程序指向 Oracle 或 SQL Server 数据库。

请记住，这可能会带来轻微的性能折衷，因为 Sql 和 Oracle 对象已针对这些 DB 进行了优化。

但实际上，您应该询问您的数据库平台更改为其他供应商的可能性有多大。

# mysql - 如何避免 MySQL 中的重复注册

> ID：503292
> 
> 赞同：0
> 
> 时间：2009-02-02T14:02:34.840
> 
> 标签：mysql

我想知道是否可以限制用户插入重复的注册记录。例如，某些团队从 5.1.2009 - 31.12.2009 注册。然后有人为 5.2.2009 - 31.12.2009 注册了同一个团队。通常 end_date 不是问题，但 start_date 不应介于现有记录的开始日期和结束日期之间

```
CREATE TABLE IF NOT EXISTS `ejl_team_registration` (
  `id` int(11) NOT NULL auto_increment,
  `team_id` int(11) NOT NULL,
  `league_id` smallint(6) NOT NULL,
  `start_date` date NOT NULL,
  `end_date` date NOT NULL,
  PRIMARY KEY  (`team_id`,`league_id`,`start_date`),
  UNIQUE KEY `id` (`id`)
); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T14:05:41.417

我会在程序的代码中检查它，而不是在数据库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T14:09:41.503

如果您想在数据库中执行此操作，您可以使用[预插入触发器](http://dev.mysql.com/doc/refman/5.0/en/trigger-syntax.html)，如果​​有任何冲突记录，该触发器将失败。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T09:20:32.540

这是一个经典的时间重叠问题。假设您想在 A (start_date) 到 B (end_date) 期间注册某个团队。

在接下来的情况下，这不应该被允许：

1.  同一个团队已经注册，所以注册期间完全在AB期间内（start_date >= A and end_date <= B）
2.  同一个团队已经在 A 点注册（start_date <= A and end_date >= A）
3.  同一个团队已经在 B 点注册（start_date <= B 和 end_date >= B）

在这些情况下，注册会导致时间重叠。在其他任何情况下都不会，因此您可以自由注册。

在 sql 中，检查将是：

```
select count(*) from ejl_team_registration
where (team_id=123 and league_id=45)
and ((start_date>=A and end_date<=B)
or (start_date<=A and end_date>=A)
or (start_date<=B and end_date>=B)
); 
```

......当然是team_id、league_id、A和B的真实值。

如果查询返回 0 以外的任何值，则团队已经注册，再次注册会导致时间重叠。

为了证明这一点，让我们填充表格：

```
insert into ejl_team_registration (id, team_id, league_id, start_date, end_date)
values (1, 123, 45, '2007-01-01', '2007-12-31')
, (2, 123, 45, '2008-01-01', '2008-12-31')
, (3, 123, 45, '20010-01-01', '2010-12-31'); 
```

让我们检查一下我们是否可以在 '2009-02-03' 和 '2009-12-31' 之间在 45 年注册团队 123：

```
select count(*) from ejl_team_registration
where (team_id=123 and league_id=45)
and ((start_date<='2009-02-03' and end_date>='2009-12-31')
or (start_date<='2009-03-31' and end_date>='2009-03-02')
or (start_date<='2009-12-31' and end_date>='2009-12-31')
); 
```

结果是0，所以我们可以自由注册。无法在例如“2009-02-03”和“2011-12-31”之间注册。我会留给你检查其他值作为练习。

PS：你提到的结束日期通常不是问题。事实上是这样，因为插入一个结束日期无效的条目也会导致重叠。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T14:07:51.477

在执行 INSERT 之前，请执行 SELECT 来检查。

```
SELECT COUNT(*) FROM `ejl_team_registration`
WHERE `team_id` = [[myTeamId]] AND `league_id` = [[myLeagueId]]
    AND `start_date` <= NOW()
    AND `end_date` >= NOW() 
```

如果返回大于 0，则不要插入。

# python - 使用 App Engine Datastore 查询 Django 表单的不同选项列表

> ID：503295
> 
> 赞同：1
> 
> 时间：2009-02-02T14:02:55.713
> 
> 标签：python, django, google-app-engine

几天来，我一直试图解决这个问题，但无法让它发挥作用。我到处都是。我会继续尝试解决这个问题，但希望有一个更快的解决方案。我正在使用 App Engine 数据存储区 + Django。

在视图和自定义表单中使用查询，我能够获得表单列表，但随后无法发布。我一直在试图弄清楚如何将选择动态添加为 Django 表单的一部分......我尝试了各种方法但没有成功。帮助！

下面是两个模型。我想获得一个不同的 address_id 列表以显示在 InfoForm 的位置字段中。这些字段可以（并且可能应该）命名相同，但我认为如果它们命名不同会更容易。

```
class Info(db.Model):
    user = db.UserProperty()
    location = db.StringProperty()
    info = db.StringProperty()
    created = db.DateTimeProperty(auto_now_add=True)
    modified = db.DateTimeProperty(auto_now=True)

class Locations(db.Model):
    user = db.UserProperty()
    address_id = db.StringProperty()
    address = db.StringProperty()

class InfoForm(djangoforms.ModelForm):
    info = forms.ChoiceField(choices=INFO_CHOICES)
    location = forms.ChoiceField()
    class Meta:
            model = Info
            exclude = ['user','created','modified'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T18:15:45.533

我不熟悉 App Engine Datastore，但我猜您可能想要按照以下方式做一些事情：

```
class InfoForm(djangoforms.ModelForm):
    def __init__(self, *args, **kwargs):
        super(InfoForm, self).__init__(*args, **kwargs)
        choices = [(r.id, r.info) for r in Info.objects.filter(...)]
        self.fields['info'] = ChoiceField(choices=choices) 
```

通过动态分配`info`，您将从您的`InfoForm`类中排除这一行：

```
 info = forms.ChoiceField(choices=INFO_CHOICES) 
```

# c# - 将字节 [] 转换为位图 c# 时出现 ArgumentException

> ID：503298
> 
> 赞同：1
> 
> 时间：2009-02-02T14:04:23.557
> 
> 标签：c#, .net, asp.net, web-services

我正在尝试将字节数组转换为位图，但它总是向我显示：

> System.ArgumentException：参数无效。

我的代码如下：

我通过网络服务传递字节：

```
 string DecodedString = string.Empty;
 DecodedString = System.Text.Encoding.GetEncoding(1251).GetString(bytes);
 sResult = sResult + "<Photo>" +XmlConvert.EncodeName(DecodedString) + "</Photo>"; 
```

在我的网页中：

```
byte[] bytes = (Byte[])System.Text.Encoding.GetEncoding(1251).GetBytes(XmlConvert.DecodeName(xDocument.SelectSingleNode("Response/Images/Photo").InnerText));
    System.IO.MemoryStream ms = new System.IO.MemoryStream(bytes);

    System.Drawing.Bitmap b = new System.Drawing.Bitmap(ms);//(System.Drawing.Image.FromStream(ms)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T14:15:50.367

尝试将字符串作为 Base64 传递：

```
string DecodedString = string.Empty;
DecodedString = System.Convert.ToBase64String(bytes)
sResult = sResult + "<Photo>" +XmlConvert.EncodeName(DecodedString) + "</Photo>"; 
```

...

```
byte[] bytes = System.Convert.FromBase64String(xDocument.SelectSingleNode("Response/Images/Photo").InnerText);
System.IO.MemoryStream ms = new System.IO.MemoryStream(bytes);
System.Drawing.Bitmap b = System.Drawing.Image.FromStream(ms); 
```

您也不需要使用 XmlConvert 对字符串进行编码/解码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T16:47:00.907

我做到了，在你们所有人的帮助下，这是我的页面代码

```
 byte[] bytes = System.Convert.FromBase64String(xDocument.SelectSingleNode("Response/Images/Photo").InnerText);

   System.IO.MemoryStream ms = new System.IO.MemoryStream(bytes);

   System.Drawing.Bitmap b = new System.Drawing.Bitmap(ms); //(Bitmap)System.Drawing.Image.FromStream(ms);

   System.Drawing.Imaging.FrameDimension frameDim;
   frameDim = new System.Drawing.Imaging.FrameDimension(b.FrameDimensionsList[0]);

   int NumberOfFrames = b.GetFrameCount(frameDim);
   string[] paths = new string[NumberOfFrames];

   for (int i = 0; i < NumberOfFrames; i++)
   {
     b.SelectActiveFrame(frameDim, i);

     System.Drawing.Bitmap bmp = new System.Drawing.Bitmap(b);
     paths[i] = imagePathfile.Remove(imagePathfile.Length - 4, 4) + i.ToString() + ".gif";

     bmp.Save(paths[i], System.Drawing.Imaging.ImageFormat.Gif);
     //bmp.Save(Response.OutputStream, System.Drawing.Imaging.ImageFormat.Gif);
     bmp.Dispose();
   }

    Image1.Src = paths[0];
    //Check if there's more than 1 image cause its a TIFF
    if (paths.Length>1)
    {
      Image2.Src = paths[1];  
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T15:35:56.760

尝试这个：

```
byte[] bytes = System.Convert.FromBase64String(xDocument.SelectSingleNode("Response/Images/Photo").InnerText);
System.Drawing.ImageConverter imageConverter = new System.Drawing.ImageConverter();
Image image = imageConverter.ConvertFrom(bytes) as Image;
System.Drawing.Bitmap b = new System.Drawing.BitMap(image); 
```

**编辑**

看看这个：

[通过 c# 传输 Web 服务上的任何文件](http://www.codeproject.com/KB/webservices/Transfer_any_files_on_Web.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-09T04:58:17.490

实际上我遇到过这个问题，就我而言，当我使用IE浏览器时，没问题，但是当使用另一个浏览器时，它总是有同样的错误。

“参数无效异常总是发生在同一行代码中：System.Drawing.Image.FromStream(ms));”

所以我认为这个问题似乎取决于浏览器和图像类型（JPEG，JPEG2000）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T14:18:11.113

I had a similar problem recently, but using Silverlight. I ended up needing to create a Custom HTTP Handler in order to pass the byte[] that defined the image back as a stream.

See [http://www.dotnetcurry.com/ShowArticle.aspx?ID=220](http://www.dotnetcurry.com/ShowArticle.aspx?ID=220)

Edit: This allows you to avoid worrying about XML encoding, and passes the image back in Binary form... YMMV

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T15:58:17.417

根据[MSDN](http://msdn.microsoft.com/en-us/library/93z9ee4x.aspx)：

> ArgumentException - 流没有有效的图像格式

我相信您的问题出在`byte[]`您传递给 Web 服务的原始数组中。根据您的一条评论，您做了：

```
System.IO.FileStream fs = new System.IO.FileStream(sPath, System.IO.FileMode.Open, System.IO.FileAccess.Read);
int streamLength = Convert.ToInt32(fs.Length);
bytes = new byte[streamLength];
fs.Read(bytes, 0, streamLength); 
```

[`fs.Read`](http://msdn.microsoft.com/en-us/library/system.io.filestream.read.aspx)返回已读入字节数组的字节数；它并不总是读取整个文件！
尝试使用[http://www.dotnetspider.com/resources/4515-convert-file-into-byte-array.aspx](http://www.dotnetspider.com/resources/4515-convert-file-into-byte-array.aspx)`StreamFile`中的方法。（[谷歌搜索](http://www.google.com/search?q=file+byte+array+c%23)的第一个结果）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-08T01:12:50.687

这是我用来将字节转换为图像以进行单元测试的一些代码：

```
 protected override Image LoadImage()
    {
        //get a temp image from bytes, instead of loading from disk
        //data:image/gif;base64,
        byte[] bytes = Convert.FromBase64String("R0lGODlhAQABAIAAAAAAAAAAACH5BAAAAAAALAAAAAABAAEAAAICTAEAOw==");

        Image image;
        using (MemoryStream ms = new MemoryStream(bytes))
        {
            image = Image.FromStream(ms);
        }

        return image;
    } 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-11-08T01:19:51.690

据我了解，图像无法显示，因为图像字节的格式不正确。每种图像格式都有自己的头部或其他东西。

# fluent-nhibernate - 如何在流利的 nhibernate 中将枚举映射为字符串？

> ID：503310
> 
> 赞同：13
> 
> 时间：2009-02-02T14:08:55.997
> 
> 标签：fluent-nhibernate, nhibernate-mapping

是否可以使用 Fluent Nhibernate 将枚举映射为字符串？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-02T14:15:03.210

是的，如果您这样做，默认情况下会这样做：

```
Map(x => x.YourProperty); 
```

确保您使用的是最新版本的主干。

* * *

正如[Yavor Shahpasov](https://stackoverflow.com/users/463181/yavor-shahpasov)在评论中指出的那样，在更新的版本中，您可以通过以下方式完成相同的操作：

```
Map(x => x.Property).CustomType<GenericEnumMapper<YourPropertyEnumType>>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-25T00:19:19.223

还有可以作为 customType 传递的 EnumString 类

# delphi - 删除临时目录

> ID：503312
> 
> 赞同：1
> 
> 时间：2009-02-02T14:09:08.260
> 
> 标签：delphi, directory

我有这个代码，

```
showmessage('C:\TEMP\'+openfiles[openfilelist.ItemIndex].ID);
if removedir('C:\TEMP\'+openfiles[openfilelist.ItemIndex].ID) then
  showmessage('Removed')
else
  showmessage('Failed'); 
```

该消息显示`C:\TEMP\0`并且该目录确实存在，因为程序之前创建了它并使用了其中的文件，然后将其删除。我可以看到文件和目录，所以我知道它们在那里。程序成功删除文件但不删除目录。

如果我对它工作的目录进行硬编码 - 这意味着它接受字符串 `C:\TEMP\0`但不接受`C:\TEMP\'+openfiles[openfilelist.ItemIndex].ID`两者都等于`C:\TEMP\0`. 我无法对这些目录进行硬编码，我该怎么办？如何从字符串 + 字符串转换`removedir()`为预期的任何内容。我在 Delphi basics 中查看了这个，它需要一个字符串。

我很困惑，因为 string + string = string. 到底是怎么回事？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-02T14:26:11.220

确保您的程序和任何其他程序都没有将该目录作为其当前工作目录。当您重新编译程序时，情况可能不再如此，因此硬编码值对您有用可能是一个红鲱鱼。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-02T14:35:56.943

除了其他好的答案之外，您不应该将临时文件夹存储在 C:\TEMP 中。请改用从[GetTempFilename](http://17slon.com/blogs/gabr/2008/12/christmas-mystery.html)返回的值。与 C:\TEMP 不同，此位置（因操作系统而异）适用于所有操作系统和所有级别的用户访问控制。这也消除了您硬编码的位置也可能被硬编码到另一个系统中的风险。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T14:18:05.247

如果我理解正确，`openfiles[openfilelist.ItemIndex].ID`是一个包含数字的字符串吗？
如果是这样，您是否检查过它不包含空格？像这样的东西：

```
filename := 'C:\TEMP\' + trim(openfiles[openfilelist.ItemIndex].ID);
showmessage(filename);
if removedir(filename) then
   showmessage('Removed')
else
   showmessage('Failed'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T14:37:05.987

openfiles 和 openfilelist 是什么类型的对象？

他们是否会打开文件夹，如果是这样，当您尝试删除文件夹时它们可能仍处于打开状态。

# c# - 您将如何构建 HttpTraceListener？

> ID：503320
> 
> 赞同：2
> 
> 时间：2009-02-02T14:11:10.423
> 
> 标签：c#, .net-3.5, trace

我的应用程序使用 Trace 对象来记录信息。使用 TextWriterTraceListener 将信息捕获在一个文件中，并且可以完美运行。但是，我想添加另一个 TraceListerner，它将信息记录到 Web 服务中。换句话说，我需要一个 HttpTraceListener。此外，我需要一些*智能*的东西，我不希望看到每个日志条目的 HTTP 请求。

你会如何建造这样的东西？我知道我必须继承 TraceListener （文档有点神秘......）但是**有人知道 HttpTraceListener 是否已经存在**吗？我不想重新发明轮子...

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T15:34:13.360

由于您对变量日志记录的要求，即不为每个条目发出请求，您肯定需要创建自己的侦听器。

根据 TraceListener 上的 MSDN 文档（[http://msdn.microsoft.com/en-us/library/system.diagnostics.tracelistener(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.tracelistener(VS.80).aspx)）

“从此类继承以实现 Debug 和 Trace 类的自定义侦听器。至少，您必须实现 Write 和 WriteLine 方法。此外，您可以实现 Fail、Close 和 Flush 方法。”

我将从：

1.  从 TraceListener 继承。
2.  实现 Write/WriteLine 方法
3.  在 Write 中添加您的逻辑以将请求提交到 Web 服务。如果您使用基类实现，WriteLine 只需附加一个行终止符。
4.  根据您的应用程序的需要覆盖失败/关闭/刷新。

这 5 种方法将为您提供实现侦听器所需的所有访问权限。

# asp.net - URL 中的 ASP.NET SessionID

> ID：503321
> 
> 赞同：1
> 
> 时间：2009-02-02T14:12:09.267
> 
> 标签：asp.net, session

我正在接管一个在 URL 字符串中传递会话 ID 的 ASP.NET Web 应用程序。我不得不假设有一个奇怪的错误与服务器配置有关，但我不知所措。

页面 A 有一个看起来很像这样的 URL 字符串：

[http://whateverqa.com/NTapsWeb/(S(yn5cby55lgzstcen0ng2b4iq))/List_Forms.aspx?wid=__zzwid1](http://whateverqa.com/NTapsWeb/(S(yn5cby55lgzstcen0ng2b4iq))/List_Forms.aspx?wid=__zzwid1)

当您单击一个按钮时，它会转到显示一些信息的页面 B，当您在该页面上单击退出时，它将带您回到页面 A，但请注意它是如何将 url 中的会话 ID 移回 NTapsWeb 后面的：

[http://whateverqa.com/(S(yn5cby55lgzstcen0ng2b4iq))/NTapsWeb/List_Forms.aspx?wid=__zzwid1](http://whateverqa.com/(S(yn5cby55lgzstcen0ng2b4iq))/NTapsWeb/List_Forms.aspx?wid=__zzwid1)

这给我留下了一个页面错误，上面写着：

“您无权查看此页面

## 您无权使用您提供的凭据查看此目录或页面。

请尝试以下方法：

如果您认为您应该能够查看此目录或页面，请联系网站管理员。单击刷新按钮以使用不同的凭据重试。HTTP 错误 403 - 禁止访问：访问被拒绝。互联网信息服务 (IIS)

* * *

技术信息（支持人员）

转到 Microsoft 产品支持服务并执行 HTTP 和 403 字样的标题搜索。打开 IIS 帮助（可在 IIS 管理器 (inetmgr) 中访问），然后搜索标题为“关于安全性、身份验证和关于自定义错误消息”的主题。

奇怪的是，这就是它在生产服务器上的工作方式，并且它在会话 ID 在字符串中向下移动时工作得很好。如果我复制会话 ID 并在错误后将其放入：

[http://whateverqa.com/NTapsWeb/(S(yn5cby55lgzstcen0ng2b4iq))/List_Forms.aspx?wid=__zzwid1](http://whateverqa.com/NTapsWeb/(S(yn5cby55lgzstcen0ng2b4iq))/List_Forms.aspx?wid=__zzwid1)

它加载正常。同样，这在生产中运行良好，只是在 QA 服务器上不起作用。

* * *

感谢您的回复。这不是超时问题，因为正如我提到的，如果我在 url 中将会话 ID 向上移动，它会再次起作用，所以数据仍然存在。

退出按钮的代码在 JavaScript 中，如下所示：

```
<script type="text/javascript">
function ExecFuncInMain(id, arg)
{
    //alert('test'+id);
    var o = window.top._mainWindow.document.all[id];
    if(o!=null)
    {
        var s = o.onclick+"";
        //alert(s);
        if(s!=null && s!='null') 
        {
            s = s.replace("javascript:", "").replace("\n", "").replace("\n", "").replace("\n", "").replace("\n", "").replace("\n", "").replace("{", "").replace("}","");
            s = "window.top._mainWindow."+s.replace("function anonymous()", "")+";";
        }
        else s = s.replace('null','');
        s = s+"window.top._mainWindow.__doPostBack('"+o.id+"', '');";
        //alert(s);
        eval(s);
    }
    else alert("object is null");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T15:08:42.260

在 web.config 中找到行 sessionState 并确保 cookieless 设置为 false，所以它看起来像这样：

```
<sessionState mode="InProc" cookieless="false" timeout="400"></sessionState> 
```

# php - file_get_contents() 使用的内存在未分配给变量时是否会被释放？

> ID：503322
> 
> 赞同：3
> 
> 时间：2009-02-02T14:12:17.397
> 
> 标签：php, memory-consumption

当我使用 file_get_contents 并将其作为参数传递给另一个函数而不将其分配给变量时，该内存是否会在脚本执行完成之前被释放？

例如：

```
preg_match($pattern, file_get_contents('http://domain.tld/path/to/file.ext'), $matches); 
```

file_get_contents 使用的内存会在脚本完成之前释放吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-02T14:25:27.197

为保存文件内容而创建的临时字符串将被销毁。无需深入研究来源进行确认，您可以通过以下几种方法测试作为函数参数创建的临时值是否被破坏：

## 方法 1：报告其销毁的类

这通过使用报告其自身消亡的类来演示生命周期：

```
class lifetime
{
    public function __construct()
    {
         echo "construct\n";
    }
    public function __destruct()
    {
         echo "destruct\n";
    }

}

function getTestObject()
{
   return new lifetime();
}

function foo($obj)
{
   echo "inside foo\n";
}

echo "Calling foo\n";
foo(getTestObject());
echo "foo complete\n"; 
```

这输出

```
Calling foo
construct
inside foo
destruct
foo complete 
```

这表明隐含的临时变量在 foo 函数调用之后立即*被销毁。*

## 方法2：测量内存使用情况

这是另一种方法，它使用[memory_get_usage](http://memory_get_usage)进一步确认来衡量我们消耗了多少。

```
function foo($str)
{
   $length=strlen($str);

   echo "in foo: data is $length, memory usage=".memory_get_usage()."\n";
}

echo "start: ".memory_get_usage()."\n";
foo(file_get_contents('/tmp/three_megabyte_file'));
echo "end: ".memory_get_usage()."\n"; 
```

这输出

```
start: 50672
in foo: data is 2999384, memory usage=3050884
end: 51544 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T14:19:07.383

在您的示例中，`$matches`超出范围时将释放内存。
如果您不存储匹配结果，则内存将立即释放

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-18T20:29:38.883

在以下代码中，内存使用量 = 6493720

开始：1050504

结束：6492344

```
echo "start: ".memory_get_usage()."\n";
$data = file_get_contents("/six_megabyte_file");
echo "end: ".memory_get_usage()."\n"; 
```

但以下代码中的内存使用量 = 1049680

开始 = 1050504

结束 = 1050976

```
echo "start: ".memory_get_usage()."\n";
file_get_contents("/six_megabyte_file");
echo "end: ".memory_get_usage()."\n"; 
```

**注意：在第一个代码文件中存储在一个变量中。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-14T12:22:05.697

如果您认为这将有助于避免内存不足错误，那您就错了。您的代码（[bytes_format](https://stackoverflow.com/a/2510459/318765)）：

```
<?php
$url = 'http://speedtest.netcologne.de/test_10mb.bin';
echo 'Before: ' . bytes_format(memory_get_usage()) . PHP_EOL;
preg_match('~~', file_get_contents($url), $matches);
echo 'After: ' . bytes_format(memory_get_usage()) . PHP_EOL;
echo 'Peak: ' . bytes_format(memory_get_peak_usage(true)) . PHP_EOL;
?> 
```

使用 10.5 MB：

```
Before: 215.41 KB
After: 218.41 KB
Peak: 10.5 MB 
```

这个代码：

```
<?php
$url = 'http://speedtest.netcologne.de/test_10mb.bin';
echo 'Before: ' . bytes_format(memory_get_usage()) . PHP_EOL;
$contents = file_get_contents($url);
preg_match('~~', $contents, $matches);
unset($contents);
echo 'After: ' . bytes_format(memory_get_usage()) . PHP_EOL;
echo 'Peak: ' . bytes_format(memory_get_peak_usage(true)) . PHP_EOL;
?> 
```

也使用 10.5 MB：

```
Before: 215.13 KB
After: 217.64 KB
Peak: 10.5 MB 
```

如果您想保护您的脚本，您需要使用`$length`参数或[分块读取文件](https://stackoverflow.com/a/5249971/318765)。

# wpf - 在 WPF 中实现 MVVM 而不使用 System.Windows.Input.ICommand

> ID：503329
> 
> 赞同：8
> 
> 时间：2009-02-02T14:15:25.860
> 
> 标签：wpf, mvvm

我正在尝试使用 MVVM (Model-View-ViewModel) 模式实现 WPF 应用程序，并且我希望将 View 部分与 Model 和 ViewModel 部分（一个 DLL）放在一个单独的程序集（一个 EXE）中。

这里的转折是保持模型/视图模型程序集清除任何 WPF 依赖项。这样做的原因是我想从具有不同（非 WPF）UI 技术的可执行文件中重用它，例如 Mono 下的 WinForms 或 GTK#。

默认情况下，这是无法做到的，因为 ViewModel 公开了一个或多个 ICommand。但是 ICommand 类型是在 System.Windows.Input 命名空间中定义的，属于 WPF！

那么，有没有不使用 ICommand 来满足 WPF 绑定机制的方法呢？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T14:34:05.463

您应该能够在 wpf 层和单个命令处理程序类中定义单个 WPF 自定义路由命令。您的所有 WPF 类都可以使用适当的参数绑定到这一命令。

然后，处理程序类可以将命令转换为您自己在 ViewModel 层中定义的自定义命令接口，并且独立于 WPF。

最简单的示例是带有 Execute 方法的 void 委托的包装器。

您所有不同的 GUI 层只需在一个位置从其本机命令类型转换为您的自定义命令类型。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-03T14:52:16.720

WinForms 没有使用 MVVM 样式视图模型所需的丰富数据绑定和命令基础设施。

就像您不能在客户端应用程序中重用 Web 应用程序 MVC 控制器一样（至少在没有创建大量包装器和适配器的情况下，最终只会使编写和调试代码变得更加困难，而不会为客户提供任何价值），您可以'不要在 WinForms 应用程序中重用 WPF MVVM。

我没有在实际项目中使用 GTK#，所以我不知道它能做什么或不能做什么，但我怀疑 MVVM 无论如何都不是 GTK# 的最佳方法。

尝试将应用程序的尽可能多的行为转移到模型中，拥有一个仅公开来自模型的数据并基于视图模型中没有逻辑的命令调用模型的视图模型。

然后对于 WinForms 只需删除视图模型并直接从 UI 调用模型，或者创建另一个基于 WinForms 的中间层更有限的数据绑定支持。

重复 GTK# 或编写 MVC 控制器和视图，为模型提供 Web 前端。

不要试图强迫一种技术进入一种针对另一种技术进行优化的使用模式，不要从头开始编写自己的命令基础架构（我以前做过，不是我最有成效的选择），为每种技术使用最好的工具.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-02-10T14:10:09.180

我需要一个这样的例子，所以我用各种技术写了一个。

我有几个设计目标

1 - 保持简单

2 - 视图中绝对没有代码隐藏（Window 类）

3 - 演示 ViewModel 类库中仅 System 引用的依赖关系。

4 - 将业务逻辑保留在 ViewModel 中并直接路由到适当的方法，而无需编写一堆“存根”方法。

这是代码...

App.xaml（没有 StartupUri 是唯一值得注意的）

```
<Application 
    x:Class="WpfApplicationCleanSeparation.App" 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
</Application> 
```

App.xaml.cs（加载主视图）

```
using System.Windows;
using WpfApplicationCleanSeparation.ViewModels;

namespace WpfApplicationCleanSeparation
{
    public partial class App
    {
        protected override void OnStartup(StartupEventArgs e)
        {
            var view = new MainView();
            var viewModel = new MainViewModel();

            view.InitializeComponent();
            view.DataContext = viewModel;
            CommandRouter.WireMainView(view, viewModel);
            view.Show();
        }
    }
} 
```

CommandRouter.cs（魔法）

```
using System.Windows.Input;
using WpfApplicationCleanSeparation.ViewModels;

namespace WpfApplicationCleanSeparation
{
    public static class CommandRouter
    {
        static CommandRouter()
        {
            IncrementCounter = new RoutedCommand();
            DecrementCounter = new RoutedCommand();
        }

        public static RoutedCommand IncrementCounter { get; private set; }
        public static RoutedCommand DecrementCounter { get; private set; }

        public static void WireMainView(MainView view, MainViewModel viewModel)
        {
            if (view == null || viewModel == null) return;

            view.CommandBindings.Add(
                new CommandBinding(
                    IncrementCounter,
                    (λ1, λ2) => viewModel.IncrementCounter(),
                    (λ1, λ2) =>
                        {
                            λ2.CanExecute = true;
                            λ2.Handled = true;
                        }));
            view.CommandBindings.Add(
                new CommandBinding(
                    DecrementCounter,
                    (λ1, λ2) => viewModel.DecrementCounter(),
                    (λ1, λ2) =>
                        {
                            λ2.CanExecute = true;
                            λ2.Handled = true;
                        }));
        }
    }
} 
```

MainView.xaml（没有代码隐藏，从字面上删除！）

```
<Window 
    x:Class="WpfApplicationCleanSeparation.MainView" 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:WpfApplicationCleanSeparation="clr-namespace:WpfApplicationCleanSeparation" 
    Title="MainWindow" 
    Height="100" 
    Width="100">
    <StackPanel>
        <TextBlock Text="{Binding Counter}"></TextBlock>
        <Button Content="Decrement" Command="WpfApplicationCleanSeparation:CommandRouter.DecrementCounter"></Button>
        <Button Content="Increment" Command="WpfApplicationCleanSeparation:CommandRouter.IncrementCounter"></Button>
    </StackPanel>
</Window> 
```

MainViewModel.cs（也包括实际的模型，因为这个例子非常简单，请原谅 MVVM 模式的脱轨。

```
using System.ComponentModel;

namespace WpfApplicationCleanSeparation.ViewModels
{
    public class CounterModel
    {
        public int Data { get; private set; }

        public void IncrementCounter()
        {
            Data++;
        }

        public void DecrementCounter()
        {
            Data--;
        }
    }

    public class MainViewModel : INotifyPropertyChanged
    {
        private CounterModel Model { get; set; }
        public event PropertyChangedEventHandler PropertyChanged = delegate { };

        public MainViewModel()
        {
            Model = new CounterModel();
        }

        public int Counter
        {
            get { return Model.Data; }
        }

        public void IncrementCounter()
        {
            Model.IncrementCounter();

            PropertyChanged(this, new PropertyChangedEventArgs("Counter"));
        }

        public void DecrementCounter()
        {
            Model.DecrementCounter();

            PropertyChanged(this, new PropertyChangedEventArgs("Counter"));
        }
    }
} 
```

![证明](https://i.stack.imgur.com/sYPsR.png)

只是快速而肮脏，我希望它对某人有用。我通过各种 Google 看到了几种不同的方法，但没有什么比我想要的尽可能少的代码更简单易实现的了。如果有进一步简化的方法，请告诉我，谢谢。

快乐编码:)

编辑：为了简化我自己的代码，您可能会发现这对于将添加到单行中很有用。

```
 private static void Wire(this UIElement element, RoutedCommand command, Action action)
    {
        element.CommandBindings.Add(new CommandBinding(command, (sender, e) => action(), (sender, e) => { e.CanExecute = true; }));
    } 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-11-05T17:42:50.747

对不起，戴夫，但我不太喜欢你的解决方案。首先，您必须在代码中手动为每个命令编写管道，然后您必须配置 CommandRouter 以了解应用程序中的每个视图/视图模型关联。

我采取了不同的方法。

我有一个 Mvvm 实用程序程序集（它没有 WPF 依赖项）并且我在我的视图模型中使用它。在该程序集中，我声明了一个自定义 ICommand 接口和一个实现该接口的 DelegateCommand 类。

```
namespace CommonUtil.Mvvm
{
    using System;

    public interface ICommand
    {
        void Execute(object parameter);
        bool CanExecute(object parameter);

        event EventHandler CanExecuteChanged;
    }

    public class DelegateCommand : ICommand
    {
        public DelegateCommand(Action<object> execute) : this(execute, null)
        {

        }

        public DelegateCommand(Action<object> execute, Func<object, bool> canExecute)
        {
            _execute = execute;
            _canExecute = canExecute;
        }

        public void Execute(object parameter)
        {
            _execute(parameter);
        }

        public bool CanExecute(object parameter)
        {
            return _canExecute == null || _canExecute(parameter);
        }

        public event EventHandler CanExecuteChanged;

        private readonly Action<object> _execute;
        private readonly Func<object, bool> _canExecute;
    }
} 
```

我还有一个 Wpf 库程序集（它确实引用了系统 WPF 库），我从我的 WPF UI 项目中引用了它。在该程序集中，我声明了一个具有标准 System.Windows.Input.ICommand 接口的 CommandWrapper 类。CommandWrapper 是使用我的自定义 ICommand 的实例构造的，并且只是将 Execute、CanExecute 和 CanExecuteChanged 直接委托给我的自定义 ICommand 类型。

```
namespace WpfUtil
{
    using System;
    using System.Windows.Input;

    public class CommandWrapper : ICommand
    {
        // Public.

        public CommandWrapper(CommonUtil.Mvvm.ICommand source)
        {
            _source = source;
            _source.CanExecuteChanged += OnSource_CanExecuteChanged;
            CommandManager.RequerySuggested += OnCommandManager_RequerySuggested;
        }

        public void Execute(object parameter)
        {
            _source.Execute(parameter);
        }

        public bool CanExecute(object parameter)
        {
            return _source.CanExecute(parameter);
        }

        public event System.EventHandler CanExecuteChanged = delegate { };

        // Implementation.

        private void OnSource_CanExecuteChanged(object sender, EventArgs args)
        {
            CanExecuteChanged(sender, args);
        }

        private void OnCommandManager_RequerySuggested(object sender, EventArgs args)
        {
            CanExecuteChanged(sender, args);
        }

        private readonly CommonUtil.Mvvm.ICommand _source;
    }
} 
```

在我的 Wpf 程序集中，我还创建了一个 ValueConverter，当传递我的自定义 ICommand 的一个实例时，它会吐出一个与 Windows.Input.ICommand 兼容的 CommandWrapper 的实例。

```
namespace WpfUtil
{
    using System;
    using System.Globalization;
    using System.Windows.Data;

    public class CommandConverter : IValueConverter
    {

        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            return new CommandWrapper((CommonUtil.Mvvm.ICommand)value);
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new System.NotImplementedException();
        }
    }
} 
```

现在，我的视图模型可以将命令公开为我的自定义命令类型的实例，而不必依赖 WPF，并且我的 UI 可以使用我的 ValueConverter 将 Windows.Input.ICommand 命令绑定到这些视图模型，就像这样。（省略了 XAML 命名空间垃圾邮件）。

```
<Window x:Class="Project1.MainWindow">

    <Window.Resources>
        <wpf:CommandConverter x:Key="_commandConv"/>
    </Window.Resources>

    <Grid>
        <Button Content="Button1" Command="{Binding CustomCommandOnViewModel,
                                        Converter={StaticResource _commandConv}}"/>
    </Grid>

</Window> 
```

现在，如果我真的很懒（我是）并且不必每次都必须手动应用 CommandConverter，那么在我的 Wpf 程序集中我可以像这样创建自己的 Binding 子类：

```
namespace WpfUtil
{
    using System.Windows.Data;

    public class CommandBindingExtension : Binding
    {
        public CommandBindingExtension(string path) : base(path)
        {
            Converter = new CommandConverter();
        }
    }
} 
```

所以现在我可以更简单地绑定到我的自定义命令类型：

```
<Window x:Class="Project1.MainWindow"
                xmlns:wpf="clr-namespace:WpfUtil;assembly=WpfUtil">

    <Window.Resources>
        <wpf:CommandConverter x:Key="_commandConv"/>
    </Window.Resources>

    <Grid>
        <Button Content="Button1" Command="{wpf:CommandBinding CustomCommandOnViewModel}"/>
    </Grid>

</Window> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T21:38:58.770

而不是 VM 公开命令，只需公开方法。然后使用附加行为将事件绑定到方法，或者如果您需要命令，请使用可以委托给这些方法并通过附加行为创建命令的 ICommand。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-21T21:19:01.537

当然这是可能的。您可以创建另一个抽象级别。添加您自己的与 ICommand 类似或相同的 IMyCommand 接口并使用它。

看看我当前的 MVVM 解决方案，它解决了您提到的大多数问题，但它完全从特定于平台的事物中抽象出来并且可以重用。此外，我没有使用任何代码隐藏，仅与实现 ICommand 的 DelegateCommands 绑定。Dialog 基本上是一个 View - 一个单独的控件，它有自己的 ViewModel，它从主屏幕的 ViewModel 显示，但通过 DelagateCommand 绑定从 UI 触发。

在此处查看完整的 Silverlight 4 解决方案[Modal dialogs with MVVM and Silverlight 4](http://blog.roboblob.com/2010/01/19/modal-dialogs-with-mvvm-and-silverlight-4/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-05-06T16:15:30.790

我认为你在错误的地方分离你的项目。我认为你应该只分享你的模型和业务逻辑类。

VM 是模型的改编，以适应 WPF 视图。我会保持 VM 简单并做到这一点。

我无法想象在 Winforms 上强制使用 MVVM。OTOH 只有模型和业务逻辑，如果需要，您可以将它们直接注入表单。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-07-25T13:08:13.047

“您不能在 WinForms 应用程序中重用 WPF MVVM”

为此，请参阅 url [http://waf.codeplex.com/](http://waf.codeplex.com/)，我在 Win Form 中使用过 MVVM，现在每当我想将应用程序的演示文稿从 Win Form 升级到 WPF 时，它将在应用程序逻辑没有变化的情况下进行更改，

但是我在 Asp.net MVC 中重用 ViewModel 有一个问题，所以我可以在 Web 中制作相同的 Desktop win 应用程序，而无需或更少更改应用程序逻辑。

谢谢...

# asp.net - Win2008出现奇怪的通讯错误

> ID：503332
> 
> 赞同：1
> 
> 时间：2009-02-02T14:16:05.860
> 
> 标签：asp.net, wcf, iis-7

我有一个托管主要 WCF 服务的 Windows 服务。该服务的客户端都托管在 IIS 7 中，第一个是 IIS 托管的 WCF 服务，第二个是标准的 Asp.Net 应用程序。两个 IIS 托管客户端都通过命名管道与 Windows 服务进行通信。

IIS 托管的 WCF 服务可以与 windows 托管的 WCF 服务完美通信，但 Asp.Net 服务失败并出现以下错误：无法从管道 URI 获取管道名称：访问被拒绝。

我的第一反应是，这是某个地方的权限问题，但我不知道在哪里。其次，为什么 IIS 托管的 WCF 服务能够毫无问题地进行通信，但 Asp.Net 应用程序却失败了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T21:02:09.690

好的，我解决了它，或者更确切地说，我弄清楚了权限问题在哪里。

事实证明，匿名身份验证设置使用的是我们的客户端（自然人，而不是我们的 WCF 客户端）创建的一些奇怪的用户，而不是 NetworkService 用户（应用程序池使用的身份）。

但这几乎引发了另一个问题：为什么甚至新创建的站点都默认使用此IUSR而不是系统默认设置？无论如何，我只是希望这能在谷歌中被索引，因为几乎没有与之相关的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T16:02:57.047

检查 WCF 和 ASP.NET 服务所在的应用程序池的标识。

也许 WCF 服务的 AppPool 的身份与其他 AppPool 的权限不同？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T02:21:39.030

此外，您可能需要注意，IUSR 是匿名访问者的默认 IIS7 帐户。有关默认帐户的说明，请参阅[了解 IIS 7.0 中的内置用户和组帐户。](http://learn.iis.net/page.aspx/140/understanding-the-built-in-user-and-group-accounts-in-iis-7/)

希望这会有所帮助。

# winforms - Infragistics UltraCombo 上的预设值

> ID：503339
> 
> 赞同：2
> 
> 时间：2009-02-02T14:18:06.587
> 
> 标签：winforms, text, datasource, infragistics, ultracombo

我有一个`ultraCombo`设置为特定的基础设施`datasource`。我想预先选择其中一个值，这样用户就不必选择它（大多数情况下它将是预先选择的值）。但是，当我将 设置`ultraCombo`为该值时，它会修改下拉列表以仅包含该单个值！

我尝试过使用`ultraCombo.value`方法、`ultraCombo.textbox.text`方法等，它们的行为方式都相同。当我查看调试器时，完整列表似乎存在，只是没有显示。如何在不破坏下拉列表的情况下预先选择列表中的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T14:24:57.557

在数据绑定期间，您不只是使用 Infragistics 的任何方法来获取/设置所选值/索引吗

IE`ultracombo.selectedvalue = "My Value"`

或者`ultracombo.selectedindex = 1`

编辑：我做了一些谷歌搜索，并在他们的支持论坛上找到了一个主题，似乎有人在问同样的问题。他们在那里说要选择一个答案，您只需设置 .Value 属性，所以我想象它可能类似于`ultracombo.value = 1`

这是更多[完整支持线程](http://forums.infragistics.com/forums/t/1048.aspx)的链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T15:49:48.820

最后使用以下代码使其工作：

```
Dim tempValue As String = myPreviousValue 'changes to the object loose the selected row--save it off and restore later 
MyUltraCombo.DataSource = queryDS.Tables(0) 'load the new data

'Restore the previous selection 
If tempValue <> "" Then
    For Each row As Infragistics.Win.UltraWinGrid.UltraGridRow In MyUltraCombo.Rows
        If row.Cells(0).Value.ToString = tempValue Then
            MyUltraCombo.SelectedRow = row
        End If
    Next
End If 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T08:20:50.000

这是您设置 的值的方式`Infragistics ComboBox`：

```
ultracombo.value=1 
```

# organization - OrgCharts - Did you write something custom or use shrink-wrapped tool?

> ID：503349
> 
> 赞同：1
> 
> 时间：2009-02-02T14:22:32.117
> 
> 标签：organization, hierarchy, orgchart

I'm just wondering what other developers have done in this area.

What does your organization do to get a hierarchical view of your reporting structure? Did you write something custom or use shrink-wrapped tool? How have you integrated that with other internal tools?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T14:26:52.547

I use [Graphviz](http://www.graphviz.org/) for things like this.

Apart from being very fast to construct the charts, it keeps them in a textual form that can be kept under version control or easily compared to previous ones.

With [wiki plugins](http://twiki.org/cgi-bin/view/Plugins/DirectedGraphPlugin), for wiki engines such as [twiki](http://twiki.org/), you can have the diagrams rendered in the wiki pages.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T14:27:30.390

I use Excel then import that into Visio.

Directors Sectaries’ have to implement so i just ask them to fill in a spreadsheet then import that into Visio - =>.

**UPDATE after comment by SHS =>**

IF you look at the Visio 2007 DATA menu -> Import Data Solution -> Organisation Chart -> there is a wizard (set the columns for the spreadsheet)

All I have in the Columns is

Role - Person - ReportsTo

The wizard helps with the mapping and you get to set who is at the top of the tree.

We have awsome sectaries - but often the least technology driven solution is often the best.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T14:33:40.910

See the [Organizational Chart](http://code.google.com/apis/visualization/documentation/gadgetgallery.html) gadget from the [Google Visualization API](http://www.google.com/ig/directory?url=www.google.com/ig/modules/orgchart.xml).

# c# - 如何在 ASP.Net 中设计公共 API？

> ID：503351
> 
> 赞同：6
> 
> 时间：2009-02-02T14:23:07.373
> 
> 标签：c#, asp.net, api

我目前正在使用 SQL Server 在 ASP.Net 中开发一个 Web 应用程序，我希望拥有某种公共 API，以便我的用户可以获取他们的数据并按照自己的意愿进行操作。

我从来没有做过这样的事情，你能推荐一些指导方针让我遵循吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T14:25:48.647

您将要研究 Web 服务。 [这是一篇很好的文章，向您展示了如何创建 RESTful WCF 服务。](http://www.developer.com/net/article.php/3695436) 使用 RESTful 服务将允许您的用户使用漂亮干净的 URL 在您的服务中调用 API 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T14:47:29.337

WCF 是要走的路——你可以使用 SOAP / REST 服务——因为你正在计划一个使用 REST 的公共 API 是正确的方式——来自 MSDN（入门工具包和实验室）的以下链接将让你开始 [http:// msdn.microsoft.com/en-us/netframework/cc950529.aspx](http://msdn.microsoft.com/en-us/netframework/cc950529.aspx) [http://code.msdn.microsoft.com/wcfrestlabs](http://code.msdn.microsoft.com/wcfrestlabs)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T17:01:09.770

我最近发现了 Hessian，到目前为止我很喜欢它。它不使用 XML，因此速度更快，并且有许多不同语言的库。

[http://hessian.caucho.com/](http://hessian.caucho.com/)

[http://www.hessiancsharp.org/](http://www.hessiancsharp.org/)

**编辑：**

Netbeans 播客不久前有这本 API 书的作者： [http ://wiki.apidesign.org/wiki/Main_Page](http://wiki.apidesign.org/wiki/Main_Page)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T18:13:40.090

您可以尝试使用 Microsoft 为 ASP.NET 提供的新动态数据服务。它可能正是您正在寻找的。我对它不是很熟悉，只是我认为它处理了很多框架代码，你必须构建以将 ASP.NET REST 用于 API。

[http://www.asp.net/dynamicdata/](http://www.asp.net/dynamicdata/)

# java - Is there a possibility for smaller JRE / packaging Java software for Softgrid

> ID：503369
> 
> 赞同：3
> 
> 时间：2009-02-02T14:27:14.200
> 
> 标签：java, software-distribution

My Java program is being distributed as a [Microsoft App-V](http://en.wikipedia.org/wiki/Microsoft_Application_Virtualization) package (also known as Softgrid) on a customer. The JRE size is causing some headache, being quite large when distributed over slower connections (the App-V seems to cause the Java package to be included with the distribution and not as a zipped distribution but as a uncompressed, installed package).

Is there some possibility to have a smaller version of the JRE or something?

Or if somebody has good ideas on the distribution of the JRE with App-V package that could be fine also. (even though I don't have straight influence to the packaging) Come compression should be available but it doesn't seem to have so much effect.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T14:40:31.490

You can look at bundling **java kernel** installer only. It is ~1MB in size. When installed, it will download java classes on demand.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T15:13:16.400

IBM 的[J9](http://en.wikipedia.org/wiki/IBM_J9)是一个相当小的 JVM。我在手机应用程序中使用它，它占用的内存很少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T14:35:34.243

Older versions of the JRE are generally smaller, since the standard API has been continuously added to. Of course, this is only an option if your app does not require recent language features and/or API classes.

Also, double-check that you're using a JRE rather than a JDK (which is much larger)

# .net - Intersecting GraphicsPath objects

> ID：503376
> 
> 赞同：2
> 
> 时间：2009-02-02T14:28:57.753
> 
> 标签：.net, winforms, gdi+, gdi

How can I intersect two (.NET) GraphicsPath objects?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T18:19:10.360

您是否试图让两个不同路径包围的区域？那是一条`Region`，而不是一条路径：

```
var rgn1 = new Region(path1);
var intersection = rgn1.Intersect(path2);
rgn1.Dispose(); 
```

如果这不是您的意思，您将不得不提供更多信息。

# javascript - 在线文本编辑器如何工作？

> ID：503381
> 
> 赞同：8
> 
> 时间：2009-02-02T14:30:37.657
> 
> 标签：javascript, editor, wysiwyg, fckeditor

我正在尝试开发一个在线编辑器（如 FCKEditor/etc），但我不知道它们是如何工作的。我知道所见即所得的有 Javascript 和 IFrame，但它们实际上是如何工作的？

我对实时预览输入编辑器的内容特别好奇。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-02T15:45:59.187

RTE 通常（总是？）使用 iframe 实现。该 iframe 中可用的文档对象必须将属性[designMode 设置为 on](https://developer.mozilla.org/en/Rich-Text_Editing_in_Mozilla)。在此之后，为了实现粗体、斜体、颜色、背景等基本功能，您所要做的一切都使用文档对象的 execCommand 方法完成。

使用 iframe 的主要原因是在单击样式按钮时不会失去选择的焦点（Firefox 只允许在 iframe 上设置此属性）。此外，contentEditable 属性在 Firefox 3 之前的版本中不可用。

当你想用那个 RTE 做一些花哨的事情时，事情会变得有点复杂。此时，您必须使用[Range 对象](https://developer.mozilla.org/En/DOM/Range)（在各种浏览器中实现方式不同）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T14:41:33.140

[FCKEditor](http://www.fckeditor.net/download)是开源的，源代码是免费的。

Stackoverflow上使用[的编辑器](https://blog.stackoverflow.com/2009/01/updated-wmd-editor/)的代码[也可用](http://github.com/derobins/wmd/tree/master)

花一些时间阅读源代码可能是值得的。这里的人们很乐意帮助解释任何不清楚的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T14:42:09.473

我相信所见即所得编辑器的关键是[*contenteditable*](http://www.w3.org/TR/html5/editing.html)属性（它可以应用于任何 HTML 标记，但在这种情况下可能类似于 div）。其余功能通常由访问 DOM 和操作 HTML 的 Javascript 提供。关于预览功能，这可能只是挂钩在用户编辑元素时引发的事件，然后获取其 HTML 并使用一些相对简单的 Javascript 将其显示在页面的其他位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T14:35:00.237

> （例如：啊，有一个无边框的输入文本，与实际显示的部分同步。所以要把字母变成红色，他们只是改变了样式）等等。

这就是它的完成方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T14:42:12.560

**更新：** *如果你只需要一个编辑器，我建议你使用这里人们给出的任何其他建议。但是，如果您有一些学术目的来构建它，那么以下将是一个跳板。*

* * *

这很容易完成（某些部分）。例如，您可以使用 jQuery 快速启动和运行。

```
div.theScreen {
  width:320px;
  height:75px;
  border:1px solid #CCCCCC;
  background-color:#f1f1f1;
}

<div class="theScreen"></div>
<div><textarea class="typePad"></textarea></div> 
```

现在我们已经有了标记和样式，我们可以添加一些简单的 Javascript 来触发实时预览。

```
$(document).ready(function(){
  $(".typePad").keyup(function(){
    $(".theScreen").html($(".typePad").val());
  });
}); 
```

这是一个非常粗略和简单的示例，但它可以帮助您入门。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T15:31:08.047

大约一年半前，我开始了一个开源“sourceforge”项目来制作富文本编辑器。我从来不知道如何将我的代码放在那里，但是为了开发它，我必须研究“内容可编辑模式”在 IE 和 Firefox 中是如何工作的。我的研究主要包括火狐网站和微软网站。

我看到这样做的代码很丑陋，而且对 OO 不太友好（抱歉，我是一个对象偏执狂，我无能为力），所以需要大量重构才能形成我可以开发的形式并延长。

不幸的是，即使您遵循浏览器的“内容可编辑模式”提供的功能，您最终仍然会得到一个充满错误的编辑器。原因是“内容可编辑模式”与从 MS Word 粘贴（每个人都尝试这样做）或创建编号列表不一致，并且它生成的标记将不一致且格式不正确。

这就是我现在使用[TinyMCE](http://tinymce.moxiecode.com)的原因。TinyMCE 充满了我个人会避免的设计决策，但它们修复了您在尝试制作自己的编辑器时会遇到的大多数错误。它还具有许多功能，可让您根据需要对其进行自定义。

我不能推荐其他任何东西，因为我还没有真正尝试过其他选择。

虽然 TinyMCE 似乎是最好的选择，但它仍然让我头疼，因为粘贴 Word 文档仍然是不可预测的，所见即所得的承诺在 HTML 中实际上是不可能的，但客户期望它，而且一旦开始就会出现许多问题让用户将原始 HTML 放入您的数据库中。（尤其是当您的代码库有部分最后更新于 1993 年时......）

# c# - 在 C# 中验证 readline 输入的最佳方法是什么？

> ID：503383
> 
> 赞同：1
> 
> 时间：2009-02-02T14:31:17.247
> 
> 标签：c#, readline, verify

哦，有两件事：1）它是一个控制台应用程序。2）我知道它是丹麦语，但这并不重要，它只是要求输入的一个例子。文本和变量无关紧要。

好吧，考虑一下这个简单的输入：它实际上可以是任何类型的输入问题。

```
Console.WriteLine("Hvad er dit kundenummer: (Kun hele tal tilladt)");
string inputKnr = Console.ReadLine();
kundenummer = Convert.ToInt16(inputKnr); 
```

现在，如果客户输入错误怎么办？比如一封信。try & catch 将确保应用程序不会中断，但这不是我想要的解决方案。我想让它说你做错了，再试一次。很经典吧？

但是解决此解决方案的最佳方法是什么？我想过这个：

```
bool fangetKundenummer = true;
while (fangetKundenummer)
{
Console.WriteLine("Hvad er dit kundenummer: (Kun hele tal tilladt)");
string inputKnr = Console.ReadLine();
try
{
    kundenummer = Convert.ToInt16(inputKnr);
    fangetKundenummer = false;
}
catch
{
    Console.WriteLine("Fejl. Prøv igen");
}
} 
```

但这似乎不是正确的方法。

另外，顺便提一下，我正在玩的这个小应用程序**连续有 4 个输入问题**。这将意味着这个讨厌的 while() 循环的 4 倍。

你也可以写一个函数。像这样的事情（没有理由以正确的方式做，它只是为了说明一个概念）：

```
static void verifyInput()
{
    try
    {
        Console.WriteLine("question");
        input = Console.ReadLine();
        kundenummer = Convert.ToInt16(input)
    }
    catch
    {
        Console.WriteLine("Wrong. Do it over");
        verifyInput(); //start the function all over
    }
} 
```

但是您必须为每个输入问题编写一个函数，即使他们可能要求完全相同！（意思可能都是要求一个整数；但有不同的问题和变量）。

这似乎并不比 while() 解决方案好多少。

有没有人有一个聪明的主意？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-02T14:32:21.210

使用[Int16.TryParse](http://msdn.microsoft.com/en-us/library/system.int16.tryparse.aspx)和其他数字类型的等价物。所有这些都返回一个布尔结果以指示解析成功或失败，并采用一个`out`设置为解析结果的参数（或在失败的情况下为 0）。在您的情况下，您可能希望将调用包装在一个方法中以继续提示：

```
static Int16 PromptForInt16(string prompt)
{
    while (true)
    {
        Console.Write(prompt);
        Int16 result;
        if (Int16.TryParse(Console.ReadLine(), out result))
        {
            return result;
        }
        Console.WriteLine("Sorry, invalid number entered. Try again.");
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T14:34:36.477

您可以使用 TryParse 模式：

```
string s; // for "is not valid" message
short val; // final value
while(!short.TryParse(s=Console.ReadLine(), out val)) {
    Console.WriteLine(s + " is not valid...");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T14:53:24.677

只是为了一些变化，测试字符串本身，而不是 TryParse，这将需要额外的存储空间，并且可能是不需要的转换？

```
static void Main(string[] args)
{
    var isFalse = "t".IsInt();
    var isTrue = "123".IsInt();
    var isAlsoFalse = "123.1".IsInt();

}

static bool IsInt(this IEnumerable<char> s)
{
    return s.All(x => char.IsNumber(x));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T14:33:08.540

这是一个可能有帮助的链接：

[http://msdn.microsoft.com/en-us/library/system.int16.tryparse.aspx](http://msdn.microsoft.com/en-us/library/system.int16.tryparse.aspx)

# c++ - 如何调试 FindFirstChangeNotification 获取的文件更改通知？

> ID：503401
> 
> 赞同：1
> 
> 时间：2009-02-02T14:36:19.827
> 
> 标签：c++, debugging, winapi, notifications

所以，问题是：我收到了一些我不想收到的通知。但我不知道我得到它们的文件/目录。有没有办法知道为什么给定的通知被解雇了？

如果您考虑 ReadDirectoryChangesW，请包含一个有意义的代码示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T20:13:26.287

如果您希望 Windows 告诉您更改了哪些特定文件或子目录，则需要使用[ReadDirectoryChangesW](http://msdn.microsoft.com/en-us/library/aa365465(VS.85).aspx)。如果使用完成例程，异步模式相当简单。

另一方面，通过使用稍微复杂的[I/O 完成端口](http://msdn.microsoft.com/en-us/library/aa365198(VS.85).aspx)方法，您可能会获得更好的性能。我会推荐下载 Wes Jones 出色的[CDirectoryChangeWatcher](http://www.codeproject.com/KB/files/directorychangewatcher.aspx) 源代码作为起点。他的代码将帮助您避免几个陷阱，尤其是在解析`FILE_NOTIFY_INFORMATION`记录时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T21:23:22.843

~伪代码

```
HANDLE handles[MAX_HANDLES];
std::string dir_array[MAX_HANDLES];

for i from 0 to MAX_HANDLES:
   h[i] = FindFirstChangeNotification(dir_array[i]...);

nCount = MAX_HANDLES;
ret = WaitForMultipleObjects(handles, nCount ...);

// check if ret returns something between WAIT_OBJECT_0 and WAIT_OBJECT_0+nCount-1
if "so":
  ret -= WAIT_OBJECT_0;
  cout << "Directory " << dir_array[ret] << " changed" << endl; 
```

请参阅：http: [//msdn.microsoft.com/en-us/library/ms687025 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms687025(VS.85).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T14:46:43.940

在专业的 Win32 api 新闻组 news://comp.os.ms-windows.programmer.win32 上查看著名的 MS 示例（C 代码）（自 90 年代...）

# ruby - returning objects in ruby

> ID：503404
> 
> 赞同：1
> 
> 时间：2009-02-02T14:39:04.033
> 
> 标签：ruby, oop

Here I have the start of a news posting app I'm working on in ruby. Creating an article works fine, but I'm lost as to how to retrieve one. I'd like my Article.get method to return an article object,.. but it seems the only way to do this is to make all the Article attributes writable, which I don't really want to do. Are there any better ways to go about doing this?

```
require 'date'
require 'ftools'
require 'find'

module News
    class Article
        attr_reader :topic, :body, :created, :directory, :file_name, :file, :author
        attr_writer :topic, :body, :created, :directory, :file_name, :file, :author

        def initialize(author, topic, body)
            @topic = topic
            @body = body
            @author = author
            @created = DateTime.now()
            @directory = 'archive/' + @created.strftime('%Y/%m') + '/'
            @file_name = @created.strftime('%H-%M-%S')
            @file = @directory + @file_name

            File.makedirs(@directory) unless File.directory?(@directory)

            if !File.file?(@file)
                @article = File.new(@file, 'w', 0777)
                @article.print "#{@topic}\n#{@author}\n#{@body}"
                @article.close()
            end
        end

        def Article.get(path)
        #???
        end
    end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T14:56:54.997

我认为这里的问题是您正在使用初始化方法将记录保存到文件系统，如果您想实例化一个文章对象以返回

```
Article.new 
```

那么这也将调用初始化方法；这可能就是它令人困惑的原因；您似乎将两件事合并为一种方法。

因此，为了简化它，我将有一个与`persist`您的方法分开的（保存）`initialize`方法。

我相信你有充分的理由在文件系统而不是数据库上这样做，但我不禁觉得阅读活动记录模式会很有启发性，无论是它的[Ruby 实现](http://ar.rubyonrails.com/)（如果你决定使用数据库）或只是[模式](http://en.wikipedia.org/wiki/Active_record_pattern)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T15:15:53.540

我可能会创建两个类，一个负责将文章读写到磁盘（或数据库或其他任何地方），另一个负责文章。这样存储类（比如 ArticleStorage）就可以很容易地从磁盘中读取数据并创建一个 Article-instance，然后可以将其返回。

就像是

```
 class ArticleStorage
  def self.save(article)
    # Make sure the folder is available, and the file is writable
    file.puts(article.to_s)
  end

  def self.load(title)
    # Open the file named title in the right directory
    # Read the file into a hash for example
    return Article.new(file[:author], file[:topic], file[:body], file[:created])
  end
end

class Article
  def initialize(author, topic, body, created)
    # save variables
  end

  def to_s
    # Format and prepare the article for saving
  end
end 
```

然后你可以做类似的事情`a = Article.new("author", "my topic", "long text", Time.now)`并保存`ArticleStorage.save(a)`并加载`a = ArticleStorage.load("my topic")`

# wpf - 如何在 WPF 中使用数组/集合？

> ID：503414
> 
> 赞同：0
> 
> 时间：2009-02-02T14:41:34.857
> 
> 标签：wpf, vb.net, xaml

我有一个程序，它有一些 Textareas / 标签，它们可以在窗口上的任何位置以任何顺序 - 但是我想从列表、集合或数组中为它们分配值，所以我希望一个标签读取 MyCollection(1) 和另一个 MyCollection (2) 依此类推-它们并不总是在一起或以相同的顺序排列，因此 ListBox 不好-您如何在代码中构建集合，例如 VB.NET，然后为每个标签提供我想要的 Item 索引的引用显示。

主要问题是：

1.  如何将运行时集合与 XAML 代码一起使用
2.  如何在 XAML 中引用集合项
3.  项目清单

如何做到这一点可以以任何顺序读取，例如读取索引 4，然后 2，然后 1

我被困在如何进行！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-02T14:57:07.150

我不确定我是否完全理解这个问题 - 但根据我的理解，我会尝试回答

因此，您在窗口上有一些标签和文本区域，并且在运行时您希望它们从集合中提取信息（一项）并显示。在文件背后的代码（.xaml.cs）文件中，您可以使用 linq 并获取标签控件，然后从集合中找到值并分配

您可以在运行时创建一个对象并将您的控件绑定到该对象 - 提供一个 IConverter 实现以绑定到正确的值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T15:08:05.427

这听起来很有趣 - 所以我找到我想要的标签，然后从集合中分配它的值，例如标签带有标签或类似的“1”，然后使用代码找到带有这个名称/标签的标签并分配它是数组中的第一项 - 从来没有想过 - 这可能会。提供 IConverter 实现的另一种解决方案我不明白，但我至少可以做第一个！

Thanks - if anyone else has any other ideas - maybe someone else out there needs something like this.

# c++ - 如何获取当前用户权限组？

> ID：503421
> 
> 赞同：0
> 
> 时间：2009-02-02T14:43:39.143
> 
> 标签：c++, windows, permissions, qt4

我有一个 Qt/C++ 项目和一个旧的 VB6 项目。

由于缺乏管理员权限，用户群可能没有对 HKEY_LOCAL_MACHINE 的权限，但我需要更新注册表项。

如何获取用户所属组的列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-03T05:50:10.170

我有这个[is_admin](http://web.archive.org/web/20150324022053/http://win32.mvps.org/security/is_admin.html)程序书签。这是如何做到这一点的一个很好的例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T15:11:52.813

看看[NetGroupGetUsers](http://msdn.microsoft.com/en-us/library/aa370430(VS.85).aspx) API。

# c# - The type initializer for 'Emgu.CV.CvInvoke' threw an exception

> ID：503427
> 
> 赞同：3
> 
> 时间：2009-02-02T14:46:15.987
> 
> 标签：c#, emgucv

If anyone who use Emgu openCv wrapper in .net 3.5 framework,please tell me why this exception appears,Its inner exception is unable to load cxcore.dll.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-08-17T12:05:31.663

对于 Emgu CV 版本 <= 2.1，这意味着以下 dll：cvXXX.dll、cvauxXXX.dll、cxcoreXXX.dll、highguiXXX.dll、opencv_ffmpegXXX.dll、mlXXX.dll 和 cvextern.dll，其中 XXX 是 OpenCV 版本号。

对于 Emgu CV 版本 >= 2.2，这意味着以下 dll：opencv_calib3dXXX.dll、opencv_contribXXX.dll、opencv_coreXXX.dll、opencv_features2dXXX.dll、opencv_highguiXXX.dll、opencv_imgprocXXX.dll、opencv_legacyXXX.dll、opencv_mlXXX.dll、opencv_objectdetectXXX.dll、opencv_videoXXX .dll，其中 XXX 是 OpenCV 版本号。

复制这些文件并将它们粘贴到 C:\WINDOWS\system32

它对我有用

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-07-09T23:50:23.813

以下是我解决问题的方法：复制安装 Emgu 的“bin”文件夹下的 x86（或 64 位操作系统上的 x64）文件夹地址。我的是：C:\Emgu\emgucv-windows-universal-gpu 2.4.9.1847\bin\x86

然后在此处粘贴此地址：控制面板>系统>高级系统设置>环境变量>在系统变量中单击“路径”并单击编辑>在字符串末尾添加分号并粘贴您刚刚复制到的地址该分号后的剪贴板>单击“确定”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-08T22:43:33.243

这个错误发生在我身上。我添加了最初位于 bin 文件夹内的**cxcore210.dll （对于 emgucv 2.1 版本）。**

然后这导致了一个新错误，说我还必须包含**highgui210.dll**（也适用于 emgucv 2.1 版本）...

然后问题就解决了：）

我希望它也对你有用......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-23T10:11:49.103

在尝试了所有可能的 opencv_xxx 组合之后，它对我有用的是包括库 npp32_42_9.dll。希望能帮助到你。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-05T05:03:00.793

You don't have the right version of openCV installed, or you don't have the openCV dll's installed at all. The latest version of Emgu uses cxcore110.dll, previous version use cxcore100.dll. They have to either be in the directory your application is running, or in the path (probably %system32%). I had this problem a when I tried to get Emgu running.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-02T14:52:33.680

I suggest you [turn on Fusion logging](http://blogs.msdn.com/suzcook/archive/2003/05/29/57120.aspx) and see where it's *trying* to load cxcore.dll from, and check that you've got it in the right place.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-02T18:24:58.943

我有同样的问题。我设置了 Fusion 日志记录，但对我没有帮助。我在与 cxcore110.dll 相同的目录中运行程序集，所以我很难过。

接下来，我在路径中的一个目录中加载/复制了所有 OpenCV DLL，同样的问题。

使用dependency walker后找到解决方案。它适用于任何具有 VS2005 和 VS2008 的系统。如果您只有 VS2008，那么您将需要 Microsoft Visual C++ 2005 SP1 Redistributable Package (x86)s] [1](http://www.microsoft.com/downloads/details.aspx?familyid=200b2fd9-ae1a-4a14-984d-389c36f85647&displaylang=en)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-11-15T21:36:46.270

如果您已经进行了 dll 设置，但仍然出现异常，请尝试如下操作：转到项目属性 -> 应用程序 -> 目标框架，并将其更改为 NET。框架 4，然后单击“是”。再次运行您的应用程序，它应该可以正常工作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-02-02T03:09:16.917

我花了一段时间才弄清楚为什么会在我的情况下发生这种情况，因为上述解决方案都没有解决问题。原来我`Windows 10 Pro N`安装了缺少媒体功能的。安装后`Media Feature Pack`它工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-25T04:50:46.290

就我而言，在 bin\release 下添加这些文件解决了这个问题：**npp32_42_9.dll**和**cudart32_42_9.dll**

我花了大约 2 个小时才得出结论:)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-07-08T18:10:33.050

我最近安装了 EmguCV 2.9。64 位应用程序工作正常。当我尝试使用 32 位平台 (x86) 时出现此异常。

我意识到，在按照教程设置 Emgu 时，我已将系统环境变量中的“路径”设置为 .\x64 文件夹。就我而言，它是 C:\Emgu\emgucv-windows-universal-cuda 2.9.0.1922\bin\

为了使 32 位应用程序工作，我将“路径”变量更改为 .\x86 文件夹，重新启动计算机。缺点是 64 位解决方案将不再有效。

理想的解决方案是将所有 DLL 文件从 .\x86 或 .\x64 复制到可执行文件所在的位置。就我而言，因为我使用的是 LabVIEW + .NET DLL，LabVIEW 会将 DLL 的副本复制到其缓存文件夹中，因此为了便于开发的临时解决方案是更改“Path”变量。当我分发最终的二进制可执行文件时，我将复制匹配的 DLL 文件。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-10-04T23:40:33.347

我之前和昨天安装了 OpenCv2.3.1，我安装了 EmguCV3.0 的最新版本（也尝试了 2.9），但它给出了那个错误。

我尝试的所有解决方案都不起作用，但我安装了 EmguCV 2.3 并解决了。我认为 EmguCV 和 opencv 版本对于解决方案很重要。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-02-18T11:49:03.203

将 EMGU 安装的 bin 文件夹中的所有非托管 dll 复制并粘贴到 exe 文件所在的位置（项目文件夹的 Release 或 Debug 文件夹）。
就我而言，非托管 dll 位于“C:\Emgu\emgucv-windows-universal-cuda 2.9.0.1922\bin\x86”

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-08-12T02:17:34.770

我有错误的次数和次数。我使用的是 EmguCV 2.4.9 和 .Net 框架 4.5。我检查了很多教程，但没有找到答案。最后，当我将版本 220 和 249 的 opencv 文件都放入时，它起作用了！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-11-04T20:30:23.810

在尝试了很多事情之后，如果您的 .dll 文件都正确放置并且仅存在版本问题，请尝试以下简单步骤：

1.  打开已创建项目的属性
2.  转到构建部分
3.  将平台目标更改为“任何 CPU”

保存并重建项目。

# testing - Testing procedure

> ID：503432
> 
> 赞同：0
> 
> 时间：2009-02-02T14:48:37.807
> 
> 标签：testing, project-management, installation, project

I developed one application, and starting the testing phase soon,

While I'm trying to setup a testing plan, I have one question!

Shall I start by testing the actual application functionality, or the installation procedure first? (Please note that the installer is an actual project we have)

Thanks,

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T14:54:37.200

希望应用程序本身和安装程序的功能不相关，您可以按任何顺序测试它们。

**编辑：回复评论** 让我重新表述：希望有两个假设：

*1) 我的安装程序会将我的用户系统置于适当的状态，以便我的应用程序运行*

和

*2) 如果系统处于正确状态，我的应用程序可以正常运行*

是无关的。显然，如果您的安装程序失败，如果由安装程序安装，您的应用程序将无法运行:)

如果您对此有疑问（尤其是不确定“正确状态”的定义），那可能是您应该测试的第一件事：您的应用程序运行需要什么样的“状态”。然后您可以独立地测试安装程序和应用程序

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T18:43:22.137

如果你发现错误，你应该测试最伤害你的东西，这样如果你发现一个非常大的问题，至少你会尽快知道并可以相应地管理期望。

在您的情况下，我认为该应用程序构成最大的风险，最初应该关注这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T14:54:48.933

真的有关系吗？

拥有安装程序可能会使应用程序的测试更容易（对于 QA），因为如果有安装程序，您无需作为测试人员执行任何手动步骤。

如果是我，我只会让安装程序测试成为产品测试的一个子集。（这是 QA 测试，不是单元测试）

# c++ - How to deal with excess precision in floating-point computations?

> ID：503436
> 
> 赞同：10
> 
> 时间：2009-02-02T14:49:46.710
> 
> 标签：c++, c, floating-point

In my numerical simulation I have code similar to the following snippet

```
double x;
do {
  x = /* some computation */;
} while (x <= 0.0);
/* some algorithm that requires x to be (precisely) larger than 0 */ 
```

With certain compilers (e.g. gcc) on certain platforms (e.g. linux, x87 math) it is possible that `x` is computed in higher than double precision ("with excess precision"). (*Update*: When I talk of precision here, I mean precision /and/ range.) Under these circumstances it is conceivable that the comparison (`x <= 0`) returns false even though the next time x is rounded down to double precision it becomes 0\. (And there's no guarantee that x isn't rounded down at an arbitrary point in time.)

Is there any way to perform this comparison that

*   is portable,
*   works in code that gets inlined,
*   has no performance impact and
*   doesn't exclude some arbitrary range (0, eps)?

I tried to use (`x < std::numeric_limits<double>::denorm_min()`) but that seemed to significantly slow down the loop when working with SSE2 math. (I know that denormals can slow down a computation, but I didn't expect them to be slower to just move around and compare.)

*Update:* An alternative is to use `volatile` to force `x` into memory before the comparison, e.g. by writing

```
} while (*((volatile double*)&x) <= 0.0); 
```

However, depending on the application and the optimizations applied by the compiler, this solution can introduce a noticeable overhead too.

*Update:* The problem with any tolerance is that it's quite arbitrary, i.e. it depends on the specific application or context. I'd prefer to just do the comparison without excess precision, so that I don't have to make any additional assumptions or introduce some arbitrary epsilons into the documentation of my library functions.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T15:11:05.030

正如 Arkadiy 在评论中所说，明确的演员表`((double)x) <= 0.0` *应该*起作用 - 至少根据标准。

C99:TC3，5.2.4.2.2 §8：

> 除了赋值和强制转换（删除所有额外的范围和精度）之外，带有浮动操作数的操作值和经过通常算术转换的值以及浮动常量的值被评估为范围和精度可能大于要求的格式类型。[...]

* * *

如果您在 x86 上使用 GCC，则可以使用 flags和`-mpc32`将浮点运算的精度设置为单精度、双精度和扩展双精度。`-mpc64``-mpc80`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T17:13:43.677

In your question, you stated that using `volatile` will work but that there'll be a huge performance hit. What about using the `volatile` variable only during the comparison, allowing `x` to be held in a register?

```
double x; /* might have excess precision */
volatile double x_dbl; /* guaranteed to be double precision */
do {
  x = /* some computation */;
  x_dbl = x;
} while (x_dbl <= 0.0); 
```

* * *

You should also check if you can speed up the comparison with the smallest subnormal value by using `long double` explicitly and cache this value, ie

```
const long double dbl_denorm_min = static_cast<long double>(std::numeric_limits<double>::denorm_min()); 
```

and then compare

```
x < dbl_denorm_min 
```

I'd assume that a decent compiler would do this automatically, but one never knows...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T15:00:41.213

我想知道你是否有正确的停止标准。听起来 x <= 0 是一个**异常**条件，但不是**终止**条件，并且终止条件更容易满足。也许你的 while 循环中应该有一个 break 语句，当满足某些容差时停止迭代。例如，当两个连续的迭代彼此足够接近时，许多算法就会终止。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T15:02:54.017

请务必将该检查设为绝对值。它必须是零附近的ε，上下。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T15:01:21.010

好吧，GCC 有一个标志， -fexcess-precision 会导致您正在讨论的问题。它还有一个标志 -ffloat-store ，可以解决您正在讨论的问题。

“不要将浮点变量存储在寄存器中。这可以防止在 68000 等机器上出现不希望出现的过高精度，其中（68881 的）浮点寄存器保持比双精度更高的精度。”

我怀疑该解决方案没有性能影响，但影响可能不会过于昂贵。随机谷歌搜索表明它的成本约为 20%。实际上，我不认为有*一个*既便携又不影响性能的解决方案，因为强制芯片不使用过高的精度通常会涉及一些非自由操作。但是，这可能是您想要的解决方案。

# c# - What is the best way to integrate a report designer in a .NET application?

> ID：503437
> 
> 赞同：2
> 
> 时间：2009-02-02T14:50:36.867
> 
> 标签：c#, .net, reporting

I need a solution in order to provide customers the ability to customize their own reports, without any IT knowledge. I need a designer easy to integrate with my .NET (C#) application.

What is the best solution/product, if any? Or should I consider to develop my own?

Thanks all, G.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T14:59:11.030

一种选择是[报表生成器，](http://msdn.microsoft.com/en-us/library/ms155933.aspx)它与 SQL Server 一起提供。您可以在数据库上生成数据集市或数据源视图。如果您的应用程序有一个 Web 前端，您可以相当轻松地将流量引导到构建器应用程序。对于富客户端，它的集成度稍差一些，因为您必须生成一个浏览器并在报表模型上打开它。

这方面的另一个选择是[RSInteract。](http://www.rsinteract.com/) 这比报表生成器要好一些，因为它对 OLAP 多维数据集有更好的支持。它将使用 (IIRC) RS 报告、报告模型和多维数据集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T15:01:08.310

[我在另一个问题中发布了这个](https://stackoverflow.com/questions/491133/user-defined-reports-with-ssrs/499317#499317)，但我也会把它放在这里。这是我为实现类似目标而必须做的事情的快速总结。

> 在我的公司，我不得不组装我们自己的报表生成器。
> 
> 我们有大约 30 份报告服务报告，我们的用户可以通过 Web 或桌面应用程序访问这些报告。我们想要做的是让我们的用户能够获取这些报告中的任何给定部分并创建自己的部分。
> 
> 如果有我们为他们构建的报告，但他们不想看到图表，他们可以创建没有它的相同报告。如果他们想将 4 个不同报告中的部分组合成一份摘要报告，他们可以将这些部分拖到我们的自定义构建器上并保存。
> 
> 我必须放在一起的报表生成器会下拉他们选择的所有不同的子报表，并通过 XML 读取将它们添加到我创建的报表生成器模板 XML 文件中。然后，我必须汇总所有参数，以免多次要求它们（如果您不希望它们汇总，参数名称在所有报告中必须是唯一的）。这个新的报告 XML 被部署到服务器上，用户可以随时访问它们。
> 
> 我还让他们能够通过在空白画布上的任何位置拖动文本框、图像、全局变量（运行日期、创建时间、运行人、页码等）来创建自己的封面、页眉和页脚。然后，我将他们在此画布上使用并调整大小的所有项目转换为另一个报告 XML 文件，并将其部署为他们可以添加到自定义报告中的子报告。
> 
> 是的，这需要做很多工作，但我们的用户喜欢它。我们现在正在允许他们创建具有特殊分组的报告，以便可以在不同级别运行报告。
> 
> 所以这是可能的，但没有简单的答案。=) 我很乐意向任何提出建议的人提供建议，但直接复制代码可能违反了我的合同，但除此之外我会尽我所能。

# wpf - 如何将自定义对象数据绑定到 ComboBox

> ID：503439
> 
> 赞同：0
> 
> 时间：2009-02-02T14:50:40.157
> 
> 标签：wpf, xaml, data-binding, combobox

我有一个自定义类`Contact`。

我正在尝试将 a 绑定`List<Contact>`到 ComboBox。

但是我无法获得该`Windows.Resources`部分的正确语法/命令，例如下面的代码给出了错误“类型引用找不到名为'List'的公共类型”，我需要修复什么才能让它`Windows.Resources`工作？

**XAML：**

```
<Window x:Class="dpwpf.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300"
    xmlns:system="clr-namespace:System;assembly=mscorlib"
    xmlns:local="clr-namespace:dpwpf">

    <Window.Resources>
        <ObjectDataProvider
            x:Key="contacts"
            MethodName="GetContacts"
            ObjectType="{x:Type system:List}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="local:GetContacts"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </Window.Resources>

    <StackPanel>
        <StackPanel>
            <TextBlock Text="Select the contact:"/>
            <ComboBox ItemsSource="{Binding
                Source={StaticResource contacts}}"/>
        </StackPanel>
    </StackPanel>
</Window> 
```

**类后面的代码：**

```
namespace dpwpf
{
    class StoreDB
    {
        private string connectionString = "App_Data/main.sqlite";

        public List<Contact> GetContacts()
        {
            SQLiteConnection conn = new SQLiteConnection("Data Source=" + connectionString);
            SQLiteCommand cmd = conn.CreateCommand();

            List<Contact> contacts = new List<Contact>();
            try
            {
                conn.Open();
                cmd.CommandText = String.Format("SELECT * FROM contacts");
                SQLiteDataReader reader = cmd.ExecuteReader();
                while (reader.Read())
                {
                    Contact contact = new Contact(
                        Int32.Parse(reader[0].ToString()),
                        reader[1].ToString(),
                        reader[2].ToString()
                    );
                    contacts.Add(contact);
                }
            }
            finally
            {
                conn.Close();
            }

            return contacts;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T15:06:59.843

您的问题出在这一行：

```
ObjectType="{x:Type system:List}" 
```

这需要是在其中`GetContacts`定义的对象。

在您的`window1.xaml.cs`情况下，它看起来像这样：

```
ObjectType="{x:Type X:Window1}" 
```

# android - How would you describe the current state of the Android platform?

> ID：503451
> 
> 赞同：7
> 
> 时间：2009-02-02T14:54:20.883
> 
> 标签：android

Since the release of Android (over a year ago?), it's momentum seems to have slowed. I'm wondering of your perceptions of adoption and viability in the "long run".

I believe Apple will "lighten up" a bit with real competition and with other platforms appearing to open their platform more to developers, do you feel that Android will be buried before it can mature?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T18:52:16.830

我认为 G1 的丑陋对很多用户来说是一个大问题。即使它对每个人来说都不是“丑陋”，但距离竞争还有很长的路要走——即使是 BlackBerry 恕我直言 :) 如果用户没有迅速采用，对市场的兴趣就不那么大了，开发人员不会有太多的冲动开发很酷的东西...

此外，正如格兰特指出的那样，您不能出售任何东西这一事实也无济于事。

我会再等一下，直到：
- 发布更多正式支持 Android 的手机
- Android Market 开始全面运作

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-02T19:18:01.490

虽然我喜欢 Android，但我并不喜欢我的 G1。电池寿命很长，硬件质量还有待改进。话虽如此，Android 市场正在迅速贬低为 1337 发言和用户成为“第一个”发表评论的愿望（更不用说对实际应用程序有用的任何东西了）。

谷歌需要给市场带来某种形式的节制，让开发者开始为应用程序收费。还有一个巨大的愿望是升级当前的硬件选择。我不得不说，我对 HTC 首次以 G1 的形式提供的产品有点惊讶。我还有其他 HTC 硬件（例如 att 倾斜），这是具有出色电池寿命的优质硬件（运行 winmo 6 不少于）。

挂在那里。Android 还处于起步阶段，随着时间的推移只会变得更好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-06T07:48:32.360

我刚开始为 Android 开发。有一个可感知的学习曲线。仅仅了解 Java 不会让您走得太远。您必须了解整个 XML 布局（其方法类似于 WPF）才能开始开发。

总体而言，该平台令人印象深刻，但有些实现感觉就像是在另一个星球上开发的。举个例子，一个叫做**layout_gravity**的 Widget 的属性是指对齐。你必须花一些时间在 Android 上才能真正获得更好的体验。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-02T19:06:48.907

就个人而言，我认为谷歌应该试图推迟 G1 的发布，直到更多的 Android 手机至少接近市场。

我感觉它是一个坚固的平台，而 G1 本身也很坚固。不幸的是，用户群并不像 G1 看起来过时的那么大。

总的来说，虽然我相信当我们开始看到更多手机发布时，android 将会开始回升……

至于苹果，除非他们开始兑现他们向我们承诺的一些东西，否则这个市场将会放缓。讨厌听起来像破唱片，但复制+粘贴现在应该已经实现了，推送通知落后了多远？不要误会我的意思，我想要可靠的、经过良好测试的功能；但是，我不想在等待时被拉扯。如果它已准备好或非常接近准备好，请不要告诉我。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-02T14:58:02.920

我保证一旦人们可以为他们开发的应用程序获得报酬，这种势头就会加快。

# c# - 数学公式在 C# 中给出的答案与在 excel 或计算器中的答案不同

> ID：503456
> 
> 赞同：1
> 
> 时间：2009-02-02T14:55:53.080
> 
> 标签：c#, javascript, math, extjs

我一直在尝试使用一个公式来计算我们团队正在创建的程序中的独家增值税。该公式在计算器或 excel 中使用时可以正常工作，但在我们程序的函数中使用时会给出不同的输出！

这是功能：

```
function fn_calcVat() 
{
    var vRate = Ext.getCmp('crd_vat_rate').getValue();
    var vTranAmt = Ext.getCmp('crd_tran_amt').getValue();

    if (vRate != '' && vTranAmt != '') 
    {
        alert(Ext.getCmp('vatable').getValue().toString());
        var vAmt = 0;
        if (Ext.getCmp('vatable').getValue().toString() == 'Y')
        {
            vAmt = (vRate / ((vTranAmt / 100) + 1));
            Ext.getCmp('crd_vat_amt').setValue(vAmt.toFixed(2));
            Ext.getCmp('crd_tran_tot').setValue(vTranAmt.toString());
            vAmt = 0;
        }
        else 
        {
            vAmt = ((vRate / 100) * vTranAmt);
            Ext.getCmp('crd_vat_amt').setValue(vAmt.toFixed(2));
            Ext.getCmp('crd_tran_tot').setValue((vTranAmt + vAmt));
            vAmt = 0;
        }                
    }
} 
```

问题公式是`vAmt = (vRate / ((vTranAmt / 100) + 1));`

另一个公式运行良好。

一个示例输入是 100，增值税率为 14.00，预期的答案是税额 14，尽管它给出的是 7！

我们正在使用 EXTJS、js 和 C# 的混搭...

任何帮助将不胜感激。

亲切的问候

缺口

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T15:01:58.683

您可能会使用以下代码成为[整数除法](http://mathworld.wolfram.com/IntegerDivision.html)的牺牲品：

```
vAmt = (vRate / ((vTranAmt / 100) + 1)); 
```

您应该将公式更改为以下内容以避免混淆：

```
vAmt = (vRate / ((vTranAmt / 100.0) + 1.0)); 
```

但是，使用您提供的数字，为 vTranAmt 插入 100，为 vRate 插入 14 不会有整数除法问题，但会给您 7：

```
vAmt = (14 / ((100 / 100) + 1))
     = (14 / ((1        ) + 1))
     = (14 / (2              ))
     = (7                     ) 
```

所以要么你的公式不正确，要么 7 是正确的答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T15:01:36.627

我想到了两件事。首先，不要使用“var”，而是使用小数或特定的东西。这样做的原因是编译器将根据变量的数据类型来决定您是指整数除法还是十进制除法。如果它选择整数，它可能会代表您进行一些意外的舍入。第二件事是确保从那些 .getCmp() 调用中正确获取变量值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T15:07:40.403

公式不正确，应该是

```
vAmt = vTranAmt * (vRate / 100.0d); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T15:04:26.963

只是为了解释：

公式：

```
vAmt = (vRate / ((vTranAmt / 100) + 1)); 
```

参数：

```
vRate = 14
vTranAmt = 100 
```

代替：

```
vAmt = (14 / ((100 / 100) + 1)); 
```

结石：

```
vAmt = (14 / (1 + 1)); 
```

结石：

```
vAmt = (14 / (2)); 
```

结石：

```
vAmt = (14 / 2); 
```

结石：

```
vAmt = (7); 
```

所以 7 是预期的答案。

但是你可以重写

```
vAmt = 100 * vRate / (vTranAmt + 100); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T15:01:05.643

我猜这是由于整数和浮点数之间的差异。

试试这样：

```
vAmt = (vRate / ((vTranAmt / 100.0) + 1.0)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T15:06:48.783

你确定公式在 Excel 中是相同的并且在那里有效吗？我不确定你到底想做什么，但你除以`vTranAmt`，所以这个值越大，结果越小。这听起来不对，如果结果应该是一些税额......

**编辑：**很可能你已经切换了`vRate`和变量。`vTranAmt`

# sql-server - SQL Server (2008) 创建具有唯一行的链接表

> ID：503459
> 
> 赞同：0
> 
> 时间：2009-02-02T14:56:16.917
> 
> 标签：sql-server, database, database-design

我无法与 SQL Server Managemen Studio 2008 取得联系！我想创建一个链接表，将事件链接到许多受众（EventAudience）。

可能包含的数据示例：

## 事件ID | 受众 ID

```
 4              1
  5              1
  4              2 
```

但是，我不希望这样：

## 事件ID | 受众 ID

```
 4              1
  4              1 
```

我一直在研究人际关系和约束……但到目前为止还没有快乐！

作为问题的第二部分，我想设置 Audience 表，这样如果从 Audience 中删除一行，它将以级联方式清除 EventAudience 链接表。

与往常一样，任何帮助/建议表示赞赏！

谢谢皮特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T14:59:00.233

只需使用：

```
CREATE UNIQUE INDEX UQ_EventAudience ON dbo.EventAudience(EventID, AudienceID); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T14:59:44.447

您应该能够在 EventId 和 AudienceID 上创建复合 UNIQUE 约束。

此表与具有 CASCADE DELETE 的 Audience 表之间的外键关系应该处理您的第二部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-13T14:43:02.967

也可以使这些 id 成为表的复合主键。由于主键需要唯一性。

```
CONSTRAINT [PK_EventIdAudienceId] PRIMARY KEY CLUSTERED 
( [EventId] ASC, [AudienceId] ASC ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-02T17:46:36.207

如果您在表设计器中进行编辑，则可以 ctrl 单击两列并将其设置为主键。那似乎总是对我有用。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-02T15:04:16.790

替代建议：使用触发器。

> 伪代码...
> 
> 在链接表上创建更新触发器...
> 如果记录尚不存在，则创建它，否则退出。

删除的相同想法

> 再次伪代码
> 
> 在受众表上创建删除触发器...
> 从受众表中删除项目
> 在链接表中定位并删除引用。

抱歉，它是伪代码，我手头没有 SQL 服务器来查找语法，所以我不想误导。

# python - django facebook 连接丢失的库？

> ID：503462
> 
> 赞同：0
> 
> 时间：2009-02-02T14:57:05.933
> 
> 标签：python, django, facebook, integration, fbconnect

我正在尝试将一些与照片相关的功能与我的网站和 Facebook 集成。我检查了 facebook connect，这似乎是解决这个问题的方法（因为我不想制作应用程序，只需让用户进行身份验证，然后从 facebook 获取一些内容以集成到我们的网站中）

首先，如果您认为有更好的方法可以做到这一点（可能是无限会话？），请告诉我。

否则这是我遇到的问题...我下载了[django-fbconnect](http://code.google.com/p/django-fbconnect/)并将其安装为应用程序（根据 svn 中包含的 readme.txt），但 python 抱怨缺少信号。py

```
Error: No module named signals 
```

由于这行代码，我认为应该是 fbconnect/signals.py：

```
from fbconnect.signals import facebook_update 
```

无论如何，有人有使用 django-fbconnect 的经验吗？或有关让开发人员更新谷歌代码的任何建议？

谢谢

**编辑**：发现这个：“[在 15 分钟内将 Facebook Connect 与 Django 集成](http://nyquistrate.com/django/facebook-connect/)”，它使用中间件而不是 django-fbconnect 应用程序。我更喜欢该应用程序，因为它更轻巧，代码更清晰。此外，它坚持 django 的“一切都是应用程序”文化。但我想我会研究另一种可能性

**编辑 2**：我联系了 django-fbconnect 的原作者，他慷慨地用丢失的文件更新了项目（他也在这篇文章中回答了）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T10:31:00.520

我刚刚添加了丢失的文件。给您带来的不便深表歉意。：/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T19:28:55.617

van gale 提出的解决方案（删除引用 signals.py 文件的行）运行良好。我想我最终可能最终需要编写自己的 signals.py ......我会随时更新。

无论如何，这是答案：

**~~删除由 signals.py 提供的功能及其所有用途~~**

~~这有点蹩脚，但哦，好吧~~

丢失的文件已添加到谷歌代码项目中！:)

# java - 用于 WEPOS 的 JVM

> ID：503467
> 
> 赞同：1
> 
> 时间：2009-02-02T14:58:48.720
> 
> 标签：java, windows, embedded, jvm

我正在研究在 WEPOS（Windows Embedded for Point of Service）平台上运行 j2se(1.5) 应用程序。我注意到 Sun 为嵌入式 Windows XP 提供了一个 java 运行时（Java SE for Embedded 5.0）。我想知道如果

1.  我可以在 WEPOS 平台上使用标准的 Sun Hotspot 吗？
2.  Java SE for Embedded 5.0 是否也可以在 WEPOS 上运行？（如果是这样，SE for Embedded 将更好地利用有限的资源）

谢谢，迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T16:00:15.057

根据[Wepos Product Overview](http://download.microsoft.com/download/1/4/D/14DD5554-0C2A-4B89-ACDC-CBB94F65EBE4/WEPOS%20Product%20Overview%20White%20Paper.pdf)，您应该能够在其上安装 J2SE (1.5)：

“Windows Embedded for Point of Service 操作系统与为 Windows XP Professional 构建的技术完全兼容，包括现有的 Windows XP 驱动程序。WEPOS 提供与 Windows XP Professional 和 Microsoft Win32® 操作系统 API 的二进制兼容性，从而简化了应用程序的开发和迁移以及提供对**Java 虚拟机**的支持。”

# asp.net - 在 ASP.NET 和 Silverlight 2 之间共享 DAL 的最佳实践

> ID：503468
> 
> 赞同：3
> 
> 时间：2009-02-02T14:58:52.277
> 
> 标签：asp.net, wcf, silverlight, asynchronous

我有一个 ASP.NET 3.5 电子商务网站，它有一个管理部分。我想换掉基于 ASP.NET 的管理部分并在 Silverlight 2 中重写它。Silverlight 需要异步调用，所以我不能只从新的 SL2 应用程序调用我现有的 DAL。

做这样的事情的最佳做法是什么？我应该创建一个 WCF 服务并通过它调用我现有的 DAL，还是应该将所有内容都移植到 WCF，或者我应该将异步调用添加到我现有的非 WCF DAL 中。寻找有关执行此类操作的最佳方法的建议。

编辑：所以我正在阅读的是，最好的方法是利用我现有的 DAL 并创建一个简单的 WCF 服务，该服务引用该 DAL 并包装调用。WCF 服务只是充当中间人来访问我的 DAL，但将它暴露给 Silverlight。如果你从头开始呢？您是否应该将 DAL 构建为 WCF 服务，并从 WPF 客户端、ASP.NET 客户端、Silverlight 客户端、任何其他使用者等开始使用该服务。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T07:14:14.707

您通常希望避免将数据访问代码放入 Silverlight 应用程序，因为用户可以轻松地对您的代码进行逆向工程。事实上，出于这个原因，Silverlight 运行时不包含任何数据库通信框架类。

推荐的最佳做法是使用 WCF 服务包装您的数据访问层并从 Silverlight 调用 WCF 服务。[这里](http://www.netfxharmonics.com/2008/11/Understanding-WCF-Services-in-Silverlight-2)有一篇关于这样做的好文章。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-02T15:02:09.683

如果您在多个地方需要您的 DAL，我建议您将其包装在 WCF 服务层中。

这将取决于您的 DAL，但请尽量将现有代码包装在服务层中，而不是将所有内容重新编写*为*服务。这将为您提供最大的测试灵活性和未来的可扩展性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-18T15:17:24.653

当然，如果您从头开始创建 DAL，WCF 服务是一个不错的选择。但我认为现在.NET RIA 服务在这种情况下会是更好的选择。.Net RIA 服务只是 WCF 服务的包装器。但允许更好的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-18T15:19:59.437

RIA 服务是当今最好的选择。另一种非 WCF 方式（WCF 数据访问在 silverlight 中的大规模 LOB 应用程序中很难维护）可能是在服务器和客户端之间交换数据的 RESTful 方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-23T07:24:05.043

我们是否可以拥有一个 WCF 托管层并通过反射和 T4 代码生成访问已经实现的 DAL 组件。

使用现有 DAL 公开为 wcf 服务的最佳做法是什么？

# javascript - 保护远程 ajax 方法调用

> ID：503469
> 
> 赞同：2
> 
> 时间：2009-02-02T14:58:58.767
> 
> 标签：javascript, ajax, security

我编写了一些 JavaScript 代码来在 asp.net 应用程序中执行 ajax 调用。这会触发一个调用 URL 的方法，在 POST 中发送一些参数。

接收页面处理数据并更新我们的数据库。

我们将向客户提供此代码，以便他们向我们发送我们在每笔交易的结账过程中需要的数据。

谁能告诉我是否有办法防止未经授权访问此 URL？否则，不道德的开发人员可能会在不应该的情况下使用此 URL 将数据添加到我们的数据库中。

感谢您的任何指示。

* * *

这里的问题是我将向我们的客户提供代码，他们会将其添加到他们的网站上。所以我没有选择让他们执行比在他们的网站上添加几行代码更复杂的事情。

但是，代码需要以某种安全的方式向我们的服务器发送数据？

这是不可能的情况，还是在处理发生后我需要执行某种审计？

谢谢大家提出一些好的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T15:21:19.143

您可以使用 SOAP 将用户名/密码与请求一起传递。SSL 应该用于加密通过网络传输的数据。这是我们使用的一些代码：

这是一个将保存随请求发送的凭据的类：

```
Imports System.Web.Services.Protocols
Public Class ServiceCredentials

Inherits SoapHeader

Private _userName As String
Public Property UserName() As String
    Get
        Return _userName
    End Get
    Set(ByVal value As String)
        _userName = value
    End Set
End Property

Private _password As String
Public Property Password() As String
    Get
        Return _password
    End Get
    Set(ByVal value As String)
        _password = value
    End Set
End Property

Public Sub New()

End Sub

Public Sub NewUserInfo(ByVal ServiceUser As String, ByVal ServicePassword As String)
    Me.UserName = ServiceUser
    Me.Password = ServicePassword

End Sub 
```

在 Web 服务的定义中添加一个属性：

```
 <WebMethod()> _
<SoapHeader("CredentialsHeader")> _
   Function MyWebMethod(ByVal paremetersPassed as String)
   'check permissions here
   If PermissionsValid(CredentialsHeader) then
    'ok!
       .......
   else
       'throw a permission error
  end if
 End Function 
```

然后从那里，只需创建一个函数（在我的示例中，PermissionsValid）来检查权限：

```
Function PermissionsValid(byval Credentials as ServiceCredentials) as boolean

    'check Credentials.Username and Credentials.Password here and return a boolean
End Function 
```

这可能看起来像是一堆工作，但是这样，当他们发送请求时，您可以根据数据库或您想要的任何其他内容检查它。您还可以在最后轻松关闭用户名。

更简单的方法是限制允许访问服务页面的 IP 地址。但是，然后您会遇到 IP 地址更改等问题。

顺便说一句，大部分内容都是在我发帖时输入的，因此您可能需要检查代码以确保它可以编译。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T15:03:59.820

您应该使用 SSL 保护您的服务

编辑：我忘记了最“基本”的：HTTP 身份验证（使用登录名/密码）我找到了一个链接，但它来自 2003 年：[http ://www-128.ibm.com/developerworks/webservices/library/ws-sec1.html](http://www-128.ibm.com/developerworks/webservices/library/ws-sec1.html)

编辑2：正如评论中所说，我认为这里的问题符合REST Web服务的目的......我对asp.net一无所知，但您应该期待REST教程并查看您拥有的安全替代方案对完整 WS-Security 实现的 HTTP 身份验证

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T15:14:21.780

像往常一样设置用户登录系统 - 即当用户登录时，将用户名和密码哈希存储在会话或 cookie 中。

POST 页面或处理程序可以简单地检查所需的凭据 - 如果丢失或不正确，您可以只返回权限错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T15:10:28.323

您能否检查您的接收页面是否用户已登录，即

```
if User.IsAuthenticated 
```

?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T15:10:42.893

您的所有客户都在您的域上吗？
否则，您将无法使用 XMLHttpRequest 对象从他们的站点发送数据。XHR 受同源[政策](https://developer.mozilla.org/En/Same_origin_policy_for_JavaScript)的约束。
您可以在 iframe 中从服务器发布到页面。您需要提示您的用户输入他们的用户名和密码，以便这些详细信息不会暴露在您的脚本中，并且应该通过 ssl 提供目标。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T15:54:37.690

抱歉，我无法添加评论，因为我还没有足够的回复。

我不完全理解你的问题。您是否在询问您提供用户名/密码的开发人员是否决定滥用网络服务？

如果是这种情况，您可能希望在系统中包含某种登录。（事实上​​，无论如何你都应该这样做。）

您可以在 PermissionsValid 函数期间将条目写入某种日志（文件、事件日志、sql 表等）。这可以显示 IP 地址和传递的用户名以及完成时间的时间戳。通过这种方式，您可以查看是否有人试图“入侵”。

在验证权限并记录用户发送的数据后，您还可以在 MyWebMethod 函数中添加一些内容。通过这种方式，您可以知道谁发送了它、何时、从何地以及发送了什么。如果您想加倍努力，您甚至可以在进行任何更新之前记录数据。这将使您能够回滚任何恶意更改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T19:36:34.433

假设如下：

```
Browser <-(1)-> ASP/.NET App (`https://123.com/app`) <-(2)-> Web Service (`https://456.com/ws`) 
```

1) 通过证书交换 + 基本身份验证使用 ssl 保护 Web 服务。这样您就知道唯一允许的消费者是 .net 应用程序。

2）在 .net 应用程序上创建一个代理，例如`https://123.com/webservicecall`将您的请求转发到 Web 服务。

这样，您不会在 Web 应用程序的域之外进行调用，您将知道已登录的用户，并且您正在保护 ws 端点以防止查看和访问。

But really it sounds like you shouldn't be using a proxy and instead call the .net app using ajax and the .net app then makes the web service call directly.

# database - 表修订/历史？

> ID：503472
> 
> 赞同：2
> 
> 时间：2009-02-02T14:59:16.537
> 
> 标签：database, rdbms

我试图找出在关系数据库中保留表的历史记录/修订的最佳方法。

我做了一些研究和阅读，但不确定跟踪变化的最佳方法是什么。对于我的主表，我很确定我已经确定了一个修订表，以跟踪（见图），但我不确定的是关系表。也许只是一个包含更改的审计跟踪表？

`movies_has_actors`查看下面的示例图片，保存表格历史的最佳方式是什么？我不能简单地对两个主要表（电影、演员）进行处理，因为我需要知道在建立关系时哪个 MOVIE revision_id 是活动的。如果我想跟踪哪个 USER 添加了关系（示例图片中没有 USER 表）怎么办？我不想将所有内容都保留在关系表本身中，因为这只会增长巨大并减慢查询速度......！[alt text][1]

总而言之，保存关系表历史的最佳方法是什么？

图片链接：img115.imageshack.us/my.php?image=44623598nv1.jpg

[1]：[图片](http://img115.imageshack.us/my.php?image=44623598nv1.jpg)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T15:02:26.000

在 SQL Server 2008 中，MSDN 上称为 CDC（更改数据捕获）CDC 的新功能可以提供帮助。CDC 是一种无需编写触发器或其他机制即可将表数据的更改记录到另一个表中的能力，更改数据捕获记录 SQL Server 中表的插入、更新和删除等更改，从而使更改的详细信息在关系中可用格式。

Channel9 视频 - [https://channel9.msdn.com/posts/ashishjaiman/CDC-Change-Data-Capture-SQL-Server-2008/](https://channel9.msdn.com/posts/ashishjaiman/CDC-Change-Data-Capture-SQL-Server-2008/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T15:02:50.007

我认为审计表是一个很好的解决方案。如果您使用 SQL Server 2008，请查看[Change Data Capture](http://msdn.microsoft.com/en-us/library/bb522489.aspx)。这是一项自动更改跟踪功能。

# arrays - 如何从 Visual FoxPro 9 OLEPUBLIC 类返回数组？

> ID：503480
> 
> 赞同：1
> 
> 时间：2009-02-02T15:01:43.567
> 
> 标签：arrays, vbscript, ole, visual-foxpro, foxpro

作为 FoxPro 的新手（但 Clipper 的老手），我有点不知所措，不知道如何从以下 OLEPUBLIC 类返回数组。*编辑*：我已经修改了下面的代码，以考虑下面@Stuart 所做的评论。

```
DEFINE CLASS db AS CUSTOM OLEPUBLIC

    DIMENSION ada(1) && public scope for later return

    FUNCTION opendb( cpName )
        SET MULTILOCKS ON
        USE (cpName) EXCLUSIVE NOUPDATE
        = CURSORSETPROP("Buffering",5)
        RETURN ALIAS()
    ENDFUNC

    && etc

    FUNCTION getrecord( sAlias, nRecno )
        SELECT (sAlias)
        GOTO (nRecno)
        fc = FCOUNT()
        DIMENSION this.ada(fc)
        FOR i = 1 TO fc
            STORE CURVAL(FIELD(i)) to THIS.ada(i)
        ENDFOR
        RETURN @THIS.ada
    ENDFUNC
ENDDEFINE 
```

鉴于以下 VBScript，我可以很好地打开文件。我似乎无法做的是取回比错误消息更有用的东西。

```
set sp = createobject("sloop.db")
al = sp.opendb("p:\testing\sloop\patient.dbf")
wscript.echo sp.getrecord(al,1) 
```

这是错误消息：

> c:\temp\foo.vbs(3, 1) sloop.db sloop.db: .getrecord p:\testing\sloop\sloop.prg 第 41 行错误语法错误。200

事实证明，第 41 行是

> ```
>  RETURN @THIS.ada 
> ```

这真的很奇怪，因为这是微软建议的语法。有什么线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-10T08:42:58.863

（晚了 5 年，但也许对那里的人仍然有用......）

更好的选择是让您的 VFP 代码创建一个 Collection 对象，然后解析数组并将所有元素添加到集合中（使用 .Add() 方法）。然后您可以将集合对象传回给 VB，VB 很乐意使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T19:08:52.023

尝试'return @ada'，但 VFP 数组从未与其他语言很好地配合，尽管[试图让它们这样做](http://msdn.microsoft.com/en-us/library/aa728495(VS.71).aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T20:02:25.520

您修改后的代码在 VFP9SP2 中对我有用 - 我必须构建为 EXE，但设法从 VBSCript 访问数据。

这是我的 VBScript 代码：

```
set sp = createobject("stack1.db") ' Different project name
al = sp.opendb("C:\WORK\VFP\DATABASES\DATA\DATA.DBF")
arrData = sp.getrecord(al,1)
msgbox(arrData(1)) 
```

# wpf - WPF：组合框显示“（命名空间）。（类名）”而不是数据

> ID：503488
> 
> 赞同：10
> 
> 时间：2009-02-02T15:02:38.137
> 
> 标签：wpf, xaml, data-binding, combobox

我想让我`ComboBox`在 XAML 中绑定到我`List`在代码后面的自定义对象集合。

目前`ComboBox`每个条目的列表`dpwpf.Contact`是 my `{namespace}.{classname}`.

我需要在 XAML 中输入什么来告诉它列出，例如 LastName + FirstName？

我知道这有点像`{Binding Path=... Value=...}`，但我无法理解。

XAML：

```
<Window x:Class="dpwpf.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <StackPanel>
        <StackPanel>
            <TextBlock Text="Select the contact:"/>
            <ComboBox Name="theContactList"/>
        </StackPanel>
    </StackPanel>
</Window> 
```

代码背后：

```
namespace dpwpf
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            StoreDB db = new StoreDB();
            List<Contact> contacts = db.GetContacts()
            theContactList.ItemsSource = contacts.ToList();
        }
    }
} 
```

# 回答：

```
<Window x:Class="dpwpf.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300"
    xmlns:local="clr-namespace:dpwpf">

    <Window.Resources>
        <DataTemplate DataType="{x:Type local:Contact}">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding LastName}"/>
                <TextBlock Text=" "/>
                <TextBlock Text="{Binding FirstName}"/>
            </StackPanel>
        </DataTemplate>
    </Window.Resources>

    <StackPanel>
        <StackPanel Margin="10">
            <TextBlock Text="Contact Name:" Foreground="#555"/>
            <TextBox Name="theName"/>
        </StackPanel>
        <StackPanel>
            <TextBlock Text="Select the contact:"/>
            <ComboBox Name="theContactList"/>
        </StackPanel>
    </StackPanel>
</Window> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-02T15:18:38.493

您可以覆盖 的`ToString`方法`Contact`，也可以`DataTemplate`在 WPF 中定义 a。

```
xmlns:dpwpf="... namespace of dpwpf"

<Window.Resources>
    <DataTemplate DataType="{x:Type dpwpf:Contact}">
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="{Binding LastName}">
            <TextBlock Text=" ">
            <TextBlock Text="{Binding FirstName}">
        </StackPanel>
    </DataTemplate>
</Window.Resources> 
```

这允许您定义`Contact`对象在窗口中任何位置的显示方式。如果您想将此限制为 ，`ComboBox`您可以将`DataTemplate`just 添加到`ComboBox`资源中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-08-27T10:14:33.390

只需将其添加到您的 ComboBox 标记中（xaml 代码）

```
TextSearch.TextPath ="Title" 
```

`ToString()`修改会影响您以后需要的所有情况，我不建议您这样做。

看那个例子： [http ://simplesample.site90.com/wpf_combobox.php](http://simplesample.site90.com/wpf_combobox.php)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-02T15:16:17.407

绑定机制所做的是在被绑定的类型上调用 ToString()。因为我猜你没有覆盖 ToString() 它只是这样 namespace.type 而不是有用的东西。

正如 rebelious 所说，您可以使用 DisplayMember 告诉绑定使用该名称的属性作为显示值，或者您可以覆盖 ToString() 如下所示以显示您的自定义属性。

```
public void Contact
{
 public string FirstName { get; set; }
 public override string ToString()
 {
   return FirstName; 
 }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-02T15:09:48.183

你需要使用 DisplayMember="TheValue"

您可以在 XAML 或 CLR 中添加它，还请注意您的绑定，而不是通过 XAML。我认为这与您的前一个问题有关。通过 ObjectDataProvider 实现绑定使用该示例并在 XAML 中添加 DisplayMemeber="memeber"

HTH，埃里克，

# sockets - 加入 2 个插槽？

> ID：503497
> 
> 赞同：2
> 
> 时间：2009-02-02T15:04:19.490
> 
> 标签：sockets, system

可以连接两个插座吗？

例如，如果一个进程在某个时候充当两个其他进程之间的消息路由器，那么能够让开将节省一堆套接字 IO。这似乎应该是可能的，但我什至从未听说过它正在完成！

如果可能，是否可以在 Linux 和 Windows 上使用？如果是这样，是否使用不同的机制来设置它？

顺便说一句：我刚发现这个：

[Linux splice() 系统调用。](http://en.wikipedia.org/wiki/Splice_(system_call))

这似乎接近我的要求（当然假设这也适用于套接字 FD），但是是否有 Windows 等价物？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T15:44:00.563

AFAIK，这是不可能的。

一个简单的例子：如果你的进程在三台不同的机器上运行，代理机器如何在不涉及 TCP/UDP/任何级别的流量重定向的情况下退出？

splice 不是解决方案，它只是优化 i/o 传输，避免不必要的内存复制，但无论如何，您需要一个循环输入并调用 splice 以将数据“传输”到输出的进程（如果套接字是真实网络套接字，数据必须通过网卡两次）。

律师事务所，安德里亚

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T22:35:22.343

简短的回答是否**。**

稍长的答案是**Not General**。系统调用是特定于`splice()`Linux 的，并且没有为套接字定义。如果要为套接字定义它，那么它将是一种将内存映射文件连接到流套接字或从流套接字连接的方法*。*它不会是双向的。大神们只知道这个区域的 Windows 上存在什么。

The Excessively Geeky answer is **Well, You Could Extend The OS Kernel, But...** that might not be what you want. If neither remote address of the two `PF_INET` or `PF_INET6` sockets is node-local, then the router will still be forwarding packets between the two remote hosts, each of which has a socket 5-tuple that references your router host. And no, I will *not* explain the dark arts of ARP/ND6 spoofing to work around that problem.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-25T19:52:57.077

I have programed something like this in the past. Assuming, you are the programmer for all three processes it is possible but tricky. If you have socket connection A and socket connection B, you take the information from A, send it to B and have B send a connection request to A. This will require a bit of coding, but it should work. It did for me. Hope that works! Good luck!

# ajax - ASP.NET AJAX：如何在用户控件中实现脚本管理器的 PageMethods 功能

> ID：503518
> 
> 赞同：2
> 
> 时间：2009-02-02T15:09:59.650
> 
> 标签：ajax, asp.net-ajax, pagemethods

我无法在用户控件中实现脚本管理器的 PageMethods 功能，这是一种可以做到的方式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T15:13:50.673

不，这是做不到的。请参阅“ [UserControl 中的 PageMethods](http://forums.asp.net/p/977525/1242935.aspx) ”和“ UserControl 中的[ASP.NET AJAX 页面方法](https://stackoverflow.com/questions/249304/asp-net-ajax-page-methods-from-usercontrol)”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T11:19:27.920

我很简单，我们只需要在 ascx 将嵌入的 ascx 页面的代码隐藏中编写页面方法，瞧！我们现在可以在用户控件中使用脚本管理器的 PageMethods 功能。

# c++ - C++ 图像处理库

> ID：503526
> 
> 赞同：3
> 
> 时间：2009-02-02T15:11:45.920
> 
> 标签：c++, image-processing, ocr

我需要一个可以检测图像中对象的库（使用边缘检测）。这与验证码无关。我正在开发一个使用 OCR 并且可以在任何屏幕分辨率下工作的 MTGO 机器人。为了将它移植到任何屏幕分辨率，我的想法是在结果页面上扫描狭窄的范围（玩家拥有的卡片可以在文本行中列出）并找到该范围内的每个对象。然后取每个对象的最低和最高像素坐标来查找行的开始和结束位置（在 y 轴上），以便我可以使用 OCR 读取每一行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T15:23:29.747

如果您不了解[OpenCV](http://sourceforge.net/projects/opencvlibrary)示例集合，那么它们可以帮助您朝着正确的方向前进……还有[Camellia](http://camellia.sourceforge.net/index.html)，它本身不使用“边缘检测”，但可以通过一点点获得您需要的结果工作的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T21:30:17.137

它并不便宜，但我使用了 Intel Processing Primitives，并且对它们的性能印象深刻。它们适用于 Intel 和 AMD 处理器，以及 Windows 和 Linux

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-25T13:55:26.837

也许这会很有用：

Simd [Library](http://simd.sourceforge.net)是一个免费的开源图像处理库，专为 C 和 C++ 程序员设计。它为图像处理提供了许多有用的高性能算法，例如：像素格式转换、图像缩放和过滤、从图像中提取统计信息、运动检测。通过使用不同的 SIMD CPU 扩展对算法进行了优化。特别是该库支持以下 CPU 扩展：SSE、SSE2、SSSE3、SSE4.1、SSE4.2、AVX 和 AVX2 用于 x86/x64，VMX(Altivec) 和 VSX(Power7) 用于 PowerPC，NEON 用于 ARM。Simd 库具有 C API，还包含有用的 C++ 类和函数，以方便访问 C API。该库支持动态和静态链接、32 位和 64 位 Windows 和 Linux、MSVS 和 G++ 编译器、MSVS 项目和 CMake 构建系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T15:57:37.370

看过[Lead 工具成像 SDK](http://www.leadtools.com/)吗？不是免费的，但是很全面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T21:27:12.103

[正方体 ocr](http://code.google.com/p/tesseract-ocr/) ? （阿帕奇许可证 2.0）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-23T23:35:35.697

Framewave 基于[AMD 性能库](http://framewave.sourceforge.net/)，提供图像处理功能。还检查相关[的快速跨平台 C/C++ 图像处理库](http://framewave.sourceforge.net/)

# delphi - Delphi：如何停止 TAction 快捷键自动重复？

> ID：503538
> 
> 赞同：3
> 
> 时间：2009-02-02T15:14:02.263
> 
> 标签：delphi, keyboard, autorepeat, taction

我正在使用 Delphi TActionList，其中包含一些操作的快捷键。

我想防止某些操作被键盘自动重复多次触发，但我*不想*影响全局的自动重复操作。这样做的最佳方法是什么？

***澄清***：我仍然需要处理多个快速按键 -*我只想*忽略自动重复生成的按键。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-02T16:27:21.180

拦截[WM_KEYDOWN](http://msdn.microsoft.com/en-us/library/ms646280(VS.85).aspx)消息，并查看第 30 位，看它是否在自动重复。如果是，请不要像往常一样传递消息，它不会被看到。

您可能需要启用表单密钥预览才能完成这项工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T15:36:18.677

您可以删除 TTimer，将 TTimer.Interval 设置为您想要的值（1000 = 1 秒），然后在 TAc​​tionList 中执行以下操作：

```
procedure TfrmMain.ActionList1Execute(Action: TBasicAction; var Handled: Boolean);
begin
  if Timer1.Enabled then 
  begin
    Handled := True;
    Exit;
  end;

  Handled := false; 
  Timer1.Enabled := true;     
end; 
```

也不要忘记在**Timer.OnTimer**中禁用计时器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T08:48:56.503

您可以保存上次使用某个操作的时间，如果两者之间的时间太短，则忽略它。对于单个操作，您可以执行以下操作：

```
procedure TForm.FormCreate(const Sender: TObject);
begin
  // ...

  FLastActionTime := Now; // 
end;

proceudure TForm.Action1Execute(const Sender: TObject);
const
  cThreshold = 1/(24*60*60*10); // 0.1 sec
begin
  if Now-FLastActionTime<cThreshold then
    Exit; // Ignore two actions within 0.1 sec
  FLastActionTime := Now;
end; 
```

您可以将其与 dmajkic 的解决方案结合使用，以获得更通用的方法。如果你真的有野心，你可以创建一个新版本的 TAction/TActionlist。

# linq - 为什么没有显示实例化数据上下文的属性和方法的智能感知？

> ID：503540
> 
> 赞同：1
> 
> 时间：2009-02-02T15:14:36.990
> 
> 标签：linq, datacontext

我在 VS 2008 中有一个 Web 应用程序项目，并且我创建了一个 Linq to SQL 文件，我从我的数据库中将一个表拖到该文件上。数据上下文创建得很好，但是当我实例化这种类型的对象时，我在 Intellisense 上显示的唯一项目是基于我拖到设计器上的表的类，即使在这个上，如果我放一个点在它之后。有谁知道为什么我没有看到这个数据上下文的所有方法（即 SubmitChanges 等）。

```
EmsContentModelDataContext context;

#region Methods

protected void Page_Load(object sender, EventArgs e)
{
    context = new EmsContentModelDataContext(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-03T11:54:40.137

好的 - 结果相对简单。只是该类中存在编译错误导致智能感知中断。当我从新文件重新创建文件并清除编译错误时，我得到了智能感知。

# sql - 在 SQL 中表达数据约束

> ID：503541
> 
> 赞同：0
> 
> 时间：2009-02-02T15:14:52.213
> 
> 标签：sql

我正在为我的妻子编写一个日程安排应用程序，我遇到了以下问题。

我有一个可以用 ActiveRecord 术语描述的模式：

*   每个**资源**都有并且属于许多*事件*
*   每个**事件**都有并且属于很多*资源*，并且有很多*时间跨度*
*   每个**时间跨度**都属于一个*事件*，具有三个属性：*day*、*start-time*和*end-time*。

我想对我的数据施加以下限制：

```
    A. 对于每个*时间跨度*，*timespan.start-time ≤ timespan.end-time* 
    B. 对于每个*事件*，对于每个*t_a*，*t_b* ∈ *TIMESPANS(event)*，*t_a =* t_b
       或*t_a.day ≠ t_b.day*
           或*t_a.end-time ≤ t_b.start-time*
           或
           t_a.start *-time ≥ t_b.end-time* 
    C. 对于每个*资源*，对于每个*e_a*，*e_b* ∈ *EVENTS(资源）*，
       e_a *= e_b*
           或对于每个*t_a* ∈ *TIMESPANS(e_a)*和*t_b* ∈ *TIMESPANS(e_b)*，
              t_a.day *≠ t_b.day*
                  或*t_a.end-time ≤ t_b.start-time*
                  或*t_a.start-time ≥ t_b.end-time*

```

(A) 确保时间跨度的格式正确，(B) 确保事件不会自我冲突，以及 (C) 确保资源不会过度调度。

目前我在应用层强制执行这些约束，但是，为了自学，我想知道是否可以将这些约束放在数据库层。

有什么方法可以在 SQL 中表达这些约束？

**编辑：** 所以我发现我想要的是 SQL 的`CREATE ASSERTION`语句（至少，对于那些不能被简单覆盖的语句`CHECK`），但它似乎不像任何支持它的 RDBMS（[至少，截至 2005 年](http://www.dbmonster.com/Uwe/Forum.aspx/databases/1991/Which-RDBMS-supports-the-CREATE-ASSERTION-statement)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T15:30:10.063

A 在`CHECK CONSTRAINT`时间跨度表中很容易用 a 表示，因为每一行都可以在不检查任何其他行的情况下检查自身的一致性。

B 和 C 更复杂，需要从其他表中读取信息。在这种情况下（至少在 SQL Server 中），可以使用用户定义的函数（将当前行中的值传递给它）来检查其他表，或者您可以使用`TRIGGER`which 来检查其他表。

注意：在编写这样的触发器时，请记住触发器会为 SQL 语句触发一次。如果该语句具有`INSERT`多`UPDATE`行，则该`INSERTED`表将包含多行，应使用适当的技术检查所有行以匹配您的域约束，例如`JOIN`.

顺便说一句：Joe Celko最近有一篇关于约束的[好文章。](http://www.simple-talk.com/sql/t-sql-programming/constraint-yourself!/)

# wpf - WPF/LINQ 数据层设计题

> ID：503549
> 
> 赞同：0
> 
> 时间：2009-02-02T15:16:24.787
> 
> 标签：wpf, linq

我正在阅读 C# 2008 中 Pro WPF 中的“数据绑定”一章。

他们让你设置了这个类：

```
public class StoreDB
{
    public Contact GetContact(int id) {...}
    public List<Contact> GetContacts() {...}
} 
```

这个想法是调用这些方法，获取 a`Contact`或 a`List<Contact>`并将它们绑定到适当的控件，使用 LINQ 在后一种方法上过滤/排序您的对象。

这一切都说得通。

但是，当您有 100,000 个联系人并且您想获得其中的 3 个时会发生什么？您的`GetContacts()`方法得到 100,000，而您的 LINQ 选择了其中三个？

这不是超级低效吗？

如何构建真实世界的应用程序来避免这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T15:32:42.100

我会推荐一种**没有**GetContacts 返回 List<T> 的设计。我不完全确定您是否想使用 List<T> 因为您返回的集合是可变的。在 WPF 中，如果您真的想要一个可变的项目列表，请尝试 ObservableCollection<T>。

但是，我认为最好的接口会返回一个 IEnumerable<T>，它是 SQL 或 LINQ 查询的结果。这将为活页夹提供一个不可变的联系人集合，可以使用 LINQ to Objects 简单轻松地对其进行过滤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T15:22:39.890

我不知道您使用的书，但这里的问题是您使用的是什么数据库，如果它的 SQL 那么您可以使用 LINQ to SQL 并通过 VS 设计器将 dbml 文件添加到您的项目中，然后只需拖动您想要使用的故事将服务器资源管理器视图放到 dbml 上，您的所有业务对象类都将自动生成。

从那里您可以使用创建的 dataContex 并使用 linq 在获取结果之前对其进行过滤。

您现在一直在做的是过滤您通过不同方式获取的对象。

HTH，埃里克

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T15:30:57.050

既然你一直在问 WPF 和 LINQ 问题，我想你真的想看看 WPF 和 LINQ 或 ADO.net 的一些好的视频转换，

这是一个非常直接地开始学习的优秀资源。

[视频培训 WPF](http://windowsclient.net/learn/videos_wpf.aspx)

HTH，埃里克

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T15:44:03.780

欢迎来到 Linq 世界！

你想返回一个`IQueryable<Contact>`：

```
public class StoreDB
{
    public Contact GetContact(int id) {...}

    // change to this:
    public IQueryable<Contact> GetContacts() {...}
} 
```

现在您可以这样说而不会浪费周期或带宽：

```
IQueryable<Contact> SerachByFirstName(StoreDB store, string searchParam, int limit) 
{
    return store.GetContacts()
        .Where(c => c.FirstName == searchParam)
        .Take(limit);
} 
```

事实上，除非您开始枚举 IQueryable，否则这仍然不会向数据库发送查询。也就是说，您仍然可以添加更多`Where()`或`OrderBy()`或任何内容，当最终评估查询时，它们将被合并并一起发送到源。

* * *

当然，这并不能帮助您绑定到 UI。但这是一个难题。您要么必须将底层 EntitySet 公开给 WPF，要么使用[MVVM](http://dasz.at/index.php/2008/11/doing-gui-architecture-the-right-way/)（或类似）架构来分离数据访问和 UI。

# multithreading - 每个处理器生成多个线程是否有意义？

> ID：503551
> 
> 赞同：8
> 
> 时间：2009-02-02T15:17:06.610
> 
> 标签：multithreading, concurrency

从逻辑的角度来看，一个应用程序可能需要数十个或数百个线程，其中一些我们大部分时间都在休眠，但极少数会一直并发运行。问题是：产生比系统中的处理器更多的并发线程是否有意义，还是浪费？

我见过一些服务器应用程序实现了一个调度程序来逻辑地管理任务（通常称为作业），但也产生了很多线程，所以我看不出好处在哪里。

提前致谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-02T15:21:16.943

当然。如果您的软件经常使用磁盘或网络 IO，您通常可以通过添加更多线程来提高吞吐量。当其他线程阻塞 IO 时，那些额外的线程将被唤醒并做一些事情。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-02T15:28:00.347

其他人谈到了几乎可以肯定确实有意义的情况（当您进行任何类型的慢速 IO 时）。

如果出现以下情况，这可能**不是**一个好主意：

*   您的线程正在执行 CPU 密集型工作

和

*   每个线程都想使用大量（即与缓存大小相比显着）不重叠的内存

在这种情况下，可能会导致不必要的缓存未命中。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-02T15:21:13.217

这可能是有道理的，如果

1.  您的程序设计优势，因为您有最好在线程中实现的并行任务，或者

2.  您的某些线程受 I/O 限制，因此它们不会自行使用处理器/内核。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-02T15:20:59.723

简短的回答是“是”。

即使您可以从多处理器环境中的多线程中获得更多收益，但它在单处理器机器上仍然是一项有用的技术，主要是因为这意味着您会将一些工作委派给进程调度程序，后者应该拥有比您更好的信息。

如果您不使用多线程，您最终将自己完成调度工作，如果这是您需要的，这可能是一件好事，但很可能既乏味又低效

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-02T15:19:51.020

每当您有一个任务等待 I/O 操作时，将它包含在一个线程中并启动它确实是有意义的。在等待 I/O 操作完成时，您的线程很有可能会被挂起。当它被唤醒时，结果将等待它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-02T15:20:28.817

好处之一是当您升级硬件时，可能会获得更多的处理器/内核。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-02T15:20:06.603

因为所有现代操作系统都是多任务处理：每个线程都从处理器获得时间共享。它实际上不是并发执行，但考虑到处理器每秒可以处理数千个请求，它是一个“明显的”并发执行。

所以是的，如果情况需要，在单个处理器上进行多线程确实有意义。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-26T22:11:16.547

我发现，在编写通过网络处理更大数据集的数据解析器时，最好为字母表中的每个字母（与数据有关）创建一个线程，并使程序受更多 CPU 和内存限制。网络和磁盘操作继承的 I/O 边界是一个主要瓶颈，因此您最好“开始”处理其他数据文件，而不是按顺序执行工作。

在四核上，启动四个以上的线程肯定是有意义的。这 4 个线程不太可能分布在一个以上的内核上，尤其是在当今的处理器速度下。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-10-15T14:35:30.490

根据 Herb Sutter（并发方面的领先专家之一）的说法，并发的[支柱之一](http://www.drdobbs.com/high-performance-computing/200001985)是**通过异步代理的响应性和隔离**性。总结是：

*通过独立运行任务和异步任务、通过消息进行通信来保持响应。*

很棒的文章（以及整个系列！）。我还在等书。

# .net - 为真正的 Windows 程序员完成真正的工作？

> ID：503554
> 
> 赞同：0
> 
> 时间：2009-02-02T15:18:26.247
> 
> 标签：.net, windows, agile, scrum

有人在这里尝试使用 Getting Real(37Signals) 方法开发 Windows 应用程序吗？（C#/.NET）。或者简单地说，使用敏捷开发项目。

我们开发占用开发时间的 Windows 应用程序。我们从来没有从客户那里得到具体的 UI 定义。由于这个问题或其他原因，我们从来没有任何像样的设计。

你们是如何从头开始管理桌面应用程序开发的？

我们用，

*   C＃
*   智能客户端
*   出租车
*   视觉工作室 2008
*   WCF
*   OPC UA

我们的队伍

*   2名开发人员（6年经验）
*   4名开发人员（少于1年经验）
*   1名测试工程师（1年经验）

我们遵循“Scrum”。

开发窗口应用程序（包括 UI 定义、原型设计、可用性测试、开发、部署）的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-02T15:22:30.420

我不确定“体面的设计”和“永远不会得到具体的 UI 定义”是否有联系……就个人而言，我是一个“在引擎盖下”的人，所以我专注于底层设计/架构——只要理解了整个用例（即“我将需要能够有效地获取所有 [this] 信息，仅给出 [this] 等”）然后您应该能够设计整个系统（和单元测试它）独立于 UI。

或者你只是指UI设计？

好吧，关于用户界面；如果您有单独的设计（“漂亮”）和开发人员（“代码”）负责人，请考虑 WPF；blend 和 VS 之间的 xaml 拆分允许更清晰的分离，允许您的设计人员在很大程度上孤立地调整 UI（给开发团队或给开发团队一些钩子）。

用于部署；如果它是一个选项，ClickOnce 是非常轻松的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T18:52:28.063

没有人从客户端获得具体的 UI 定义。Scrum 应该帮助您处理不断变化的/不具体的 UI 定义。我的经验是你会得到某种类型的设计类比（让它看起来像 Outlook 或我的手机或某些网页。）。然后你向客户展示一些东西，现在他们对他们真正想要的外观有了更好的了解（移动这个，重命名那个，把它变成一个组合框，那个是红色的吗？等等）。您将通过每个表单、菜单和每个报告多次进行此操作。

# asp.net - 使用 ODBC 在 asp.net 中获取列名的最佳方法是什么？

> ID：503560
> 
> 赞同：0
> 
> 时间：2009-02-02T15:19:57.337
> 
> 标签：asp.net, odbc

我有一个有四列这样的数据库

level_1, level_2, level_3, level_4

还有 id、name 等，但目前对我来说只有这四个是重要的。

我需要通过列名知道哪一列的值为“BOSS”。

例如，level_2 的值可能是 BOSS。我需要知道四列中的一列有代码 BOSS 以及哪一列，按列名，它是。

原因是我必须稍后更新这一行，但我不知道 BOSS 的值在哪里。例如，它可能在 level_4 中。

我知道 DataSet 中有一个 columnname 属性，但我不知道如何在这里使用它。我无法发布我的代码，因为它有很多迭代，但都不起作用。我希望我忽略了一些明显的东西。

我正在使用 ASP.NET 2.0 和 ODBC。

谢谢你的任何想法。

只是为了澄清-我不需要知道如何获取列名本身。columnname 属性适用于此。不知道哪一栏会有上面BOSS的值。一旦我可以确定我将获得 columnname 属性值。

我不知道哪一列会显示 BOSS 的原因是因为其他值可能在四个值中的任何一个中，因此数据输入人员必须选择一个开放字段并输入代码 - 这是我继承的旧数据库应用程序.

更新：

这是我想出的。我不喜欢它，但它就在这里。它有效，但感觉不对：

```
 String[] myValues = new String[5] {"BOSS", "ANOTHERCODE", "ANOTHERCODE", "ANOTHERCODE", "ANOTHERCODE"};
        int x = 0;
            foreach (String level in myValues)
            {
                foreach (DataColumn dc in ds.Tables[0].Columns)
                {
                    String myColumnValue = ds.Tables[0].Rows[0][x].ToString();
                    if (myColumnValue == level)
                    { return ds.Tables[0].Columns[x].ColumnName; }
                    x += 1;
                }
                x = 0;
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T15:50:43.483

好的，所以您有 4 列可以具有 BOSS 值。我想解决你的问题的最好方法是循环思考这 4 列，直到你得到 Value BOSS，当你找到它时，将列名存储在一个变量中，以便以后可以取回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T15:26:52.253

我不确定你需要什么......你的问题有点模糊......

如果您需要访问列名，请这样做：DataTable.Columns[columnNumber].ColumnName

# c# - 如何安排 C# Windows 服务每天执行任务？

> ID：503564
> 
> 赞同：85
> 
> 时间：2009-02-02T15:21:07.757
> 
> 标签：c#, windows-services, scheduling, scheduled-tasks

我有一个用 C# (.NET 1.1) 编写的服务，并希望它在每晚午夜执行一些清理操作。我必须保留服务中包含的所有代码，那么完成此操作的最简单方法是什么？使用`Thread.Sleep()`和检查时间滚动？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-02-02T15:31:04.833

我不会使用 Thread.Sleep()。要么使用计划任务（正如其他人提到的那样），要么在您的服务中设置一个计时器，它会定期触发（例如每 10 分钟）并检查自上次运行以来日期是否更改：

```
private Timer _timer;
private DateTime _lastRun = DateTime.Now.AddDays(-1);

protected override void OnStart(string[] args)
{
    _timer = new Timer(10 * 60 * 1000); // every 10 minutes
    _timer.Elapsed += new System.Timers.ElapsedEventHandler(timer_Elapsed);
    _timer.Start();
    //...
}

private void timer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
{
    // ignore the time, just compare the date
    if (_lastRun.Date < DateTime.Now.Date)
    {
        // stop the timer while we are running the cleanup task
        _timer.Stop();
        //
        // do cleanup stuff
        //
        _lastRun = DateTime.Now;
        _timer.Start();
    }
} 
```

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2009-02-02T15:28:15.107

查看[Quartz.NET](http://quartznet.sourceforge.net/)。您可以在 Windows 服务中使用它。它允许您根据配置的计划运行作业，它甚至支持简单的“cron 作业”语法。我已经取得了很大的成功。

这是其用法的快速示例：

```
// Instantiate the Quartz.NET scheduler
var schedulerFactory = new StdSchedulerFactory();
var scheduler = schedulerFactory.GetScheduler();

// Instantiate the JobDetail object passing in the type of your
// custom job class. Your class merely needs to implement a simple
// interface with a single method called "Execute".
var job = new JobDetail("job1", "group1", typeof(MyJobClass));

// Instantiate a trigger using the basic cron syntax.
// This tells it to run at 1AM every Monday - Friday.
var trigger = new CronTrigger(
    "trigger1", "group1", "job1", "group1", "0 0 1 ? * MON-FRI");

// Add the job to the scheduler
scheduler.AddJob(job, true);
scheduler.ScheduleJob(trigger); 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-02-02T15:27:29.630

日常任务？听起来它应该只是一个计划任务（控制面板） - 这里不需要服务。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-02-02T15:26:51.457

它必须是实际的服务吗？您可以只使用 Windows 控制面板中的内置计划任务吗？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-02T15:26:03.737

我实现这一点的方法是使用计时器。

运行服务器计时器，让它每 60 秒检查一次小时/分钟。

如果是正确的小时/分钟，则运行您的流程。

实际上，我已将其抽象为我称为 OnceADayRunner 的基类。

让我清理一下代码，然后在这里发布。

```
 private void OnceADayRunnerTimer_Elapsed(object sender, ElapsedEventArgs e)
    {
        using (NDC.Push(GetType().Name))
        {
            try
            {
                log.DebugFormat("Checking if it's time to process at: {0}", e.SignalTime);
                log.DebugFormat("IsTestMode: {0}", IsTestMode);

                if ((e.SignalTime.Minute == MinuteToCheck && e.SignalTime.Hour == HourToCheck) || IsTestMode)
                {
                    log.InfoFormat("Processing at: Hour = {0} - Minute = {1}", e.SignalTime.Hour, e.SignalTime.Minute);
                    OnceADayTimer.Enabled = false;
                    OnceADayMethod();
                    OnceADayTimer.Enabled = true;

                    IsTestMode = false;
                }
                else
                {
                    log.DebugFormat("Not correct time at: Hour = {0} - Minute = {1}", e.SignalTime.Hour, e.SignalTime.Minute);
                }
            }
            catch (Exception ex)
            {
                OnceADayTimer.Enabled = true;
                log.Error(ex.ToString());
            }

            OnceADayTimer.Start();
        }
    } 
```

该方法的核心在于 e.SignalTime.Minute/Hour 检查。

那里有用于测试等的钩子，但这就是你的计时器看起来可以让它全部工作的样子。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-02T17:02:04.090

正如其他人已经写的那样，计时器是您描述的场景中的最佳选择。

根据您的具体要求，可能不需要每分钟检查一次当前时间。如果您不需要在午夜执行该操作，*而是*在午夜后一小时内执行，您可以采用[Martin 的方法](https://stackoverflow.com/questions/503564/c-service-perform-daily-task/503606#503606)，即仅检查日期是否已更改。

如果您希望在午夜执行操作的原因是您希望计算机上的工作负载较低，那么最好小心：其他人经常做出相同的假设，突然间您在 0:00 和 0 之间开始了 100 个清理操作上午01点

在这种情况下，您应该考虑在不同的时间开始清理。我通常不是在时钟时间做这些事情，而是在半小时（1.30 am 是我个人的偏好）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-02T15:36:12.187

我建议您使用计时器，但将其设置为每 45 秒检查一次，而不是每分钟检查一次。否则，您可能会遇到负载过重的情况，错过了对特定分钟的检查，因为在计时器触发时间和代码运行并检查当前时间之间，您可能错过了目标分钟。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-03T02:56:20.340

您也可以在这里尝试 TaskSchedulerLibrary [http://visualstudiogallery.msdn.microsoft.com/a4a4f042-ffd3-42f2-a689-290ec13011f8](http://visualstudiogallery.msdn.microsoft.com/a4a4f042-ffd3-42f2-a689-290ec13011f8)

实现抽象类`AbstractScheduledTask`并调用`ScheduleUtilityFactory.AddScheduleTaskToBatch`静态方法

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-04-24T05:53:09.747

For those that found the above solutions not working, it's because you may have a `this` inside your class, which implies an extension method which, as the error message says, only makes sense on a non-generic static class. Your class isn't static. This doesn't seem to be something that makes sense as an extension method, since it's acting on the instance in question, so remove the `this`.

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2013-08-09T14:11:41.587

试试这个：

```
public partial class Service : ServiceBase
{
    private Timer timer;
    public Service()
    {
        InitializeComponent();
    }

    protected override void OnStart(string[] args)
    {
        SetTimer();
    }

    private void SetTimer()
    {
        if (timer == null)
        {
            timer = new Timer();
            timer.AutoReset = true;
            timer.Interval = 60000 * Convert.ToDouble(ConfigurationManager.AppSettings["IntervalMinutes"]);
            timer.Elapsed += new ElapsedEventHandler(timer_Elapsed);
            timer.Start();
        }
    }

    private void timer_Elapsed(object source, System.Timers.ElapsedEventArgs e)
    {
        //Do some thing logic here
    }

    protected override void OnStop()
    {
        // disposed all service objects
    }
} 
```

# sql - SQLServer 2000 中的高效分页（限制）查询？

> ID：503566
> 
> 赞同：10
> 
> 时间：2009-02-02T15:21:14.573
> 
> 标签：sql, sql-server-2000, paging, limit

在 SQLServer 2000 中进行分页查询的最有效方法是什么？

“分页查询”相当于在 MySQL 中使用 LIMIT 语句。

编辑：在这种情况下，存储过程是否比任何基于集合的查询更有效？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-06T16:05:51.593

[大型结果集的分页](http://www.codeproject.com/KB/aspnet/PagingLarge.aspx)和获胜者正在使用 RowCount。还有一个用于更复杂查询的通用版本。但是要归功于**Jasmin Muharemovic** :)

```
DECLARE @Sort /* the type of the sorting column */
SET ROWCOUNT @StartRow
SELECT @Sort = SortColumn FROM Table ORDER BY SortColumn
SET ROWCOUNT @PageSize
SELECT ... FROM Table WHERE SortColumn >= @Sort ORDER BY SortColumn 
```

文章包含完整的源代码。

请阅读“2004-05-05 更新”信息。！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-02T15:25:55.827

我认为嵌套`SELECT TOP n`查询可能是完成它的最有效方法。

```
SELECT TOP ThisPageRecordCount *
FROM Table
WHERE ID NOT IN (SELECT TOP BeforeThisPageRecordCount ID FROM Table ORDER BY OrderingColumn)
ORDER BY OrderingColumn 
```

替换`ThisPageRecordCount`为每页的项目并`BeforeThisPageRecordCount`替换为`(PageNumber - 1) * items-per-page`.

当然，SQL Server 2005 中更好的方法是`ROW_NUMBER()`在 CTE 中使用该函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T03:29:17.673

查询的效率实际上取决于底层表的结构。如果假设您有一个名为 ID 的主键，它是一个 IDENTITY，*并且*它是一个聚集索引，*并且*您可以假设没有人对其进行 IDENTITY_INSERT，您可以执行如下查询：

SELECT TOP XXX FROM table WHERE ID > @LastPagesID;

这将使您尽快获得结果。其他所有真正有效的东西都是对此的一些变体——也许它不是一个 ID——也许你用来分页的实际上是一个你知道是唯一的日期，但你明白了……此处显示的基于 IN () 的查询可能会起作用，但它们不会影响部分聚集或覆盖索引扫描的性能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T08:57:29.113

我认为您在这里真正拥有的是升级到 SQL 2005 的令人信服的理由。

在 SQL 2005 中，这可以通过以下方式快速轻松地完成：

```
select ROW_NUMBER() over (order by [MyField]) as rowNum, *
from [MyTable]
where rowNum between @firstRow and @lastRow 
```

如果你真的坚持使用 SQL 2000，我会担心——微软不会再完全支持它了，因为它现在已经两代了。

恐怕不会有一种最好的方法来做到这一点——所有的解决方案都是黑客。

@Petar Petrov 的回答可能是最一致的，但是：

*   如果您要在较小的表上处理聚集索引以进行排序，那么 ASC-DESC 方法（使用 TOP 以每种方式动态构建两种排序）可能更快。
*   如果您的数据是相对静态的并且您的排序是固定的，那么您可以添加自己的 rowNum 字段，当您更改排序顺序时会更新该字段（听起来很可怕，但对于大型表来说会很快）。

我认为您每次都在使用查询分析器进行几个小时的调整。无论哪种方式，存储过程都不会产生太大影响——查询计划的缓存不太可能成为瓶颈。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T12:49:44.857

这是一个通用的 SQL Server 2000 存储过程，它将对任何表执行分页。存储过程接受表的名称、要输出的列（默认为表中的所有列）、可选的 WHERE 条件、可选的排序顺序、要检索的页码和每页的行数。

```
 CREATE PROCEDURE [dbo].[GetPage]
    @pTableName VARCHAR(30),
    @pColumns VARCHAR(200) = '*',
    @pFilter VARCHAR(200) = '',
    @pSort VARCHAR(200) = '',
    @pPage INT = 1,
    @pPageRows INT = 10
    AS

    SET NOCOUNT ON
    DECLARE @vSQL VARCHAR(4000)
    DECLARE @vTempTable VARCHAR(30)
    DECLARE @vRowStart INT
    DECLARE @vTotalRows INT

    SET @vTempTable = '##Tmp' + CAST(DATEPART(YYYY, GETDATE()) AS VARCHAR(4)) +
    CAST(DATEPART(MM, GETDATE()) AS VARCHAR(2)) +
    CAST(DATEPART(DD, GETDATE()) AS VARCHAR(2)) +
    CAST(DATEPART(HH, GETDATE()) AS VARCHAR(2)) +
    CAST(DATEPART(MI, GETDATE()) AS VARCHAR(2)) +
    CAST(DATEPART(SS, GETDATE()) AS VARCHAR(2)) +
    CAST(DATEPART(MS, GETDATE()) AS VARCHAR(3))

    SET @vSQL = 'SELECT ' + @pColumns + ', IDENTITY(INT, 1, 1) AS ROWID INTO ' + @vTempTable + ' FROM ' + @pTableName

    IF @pFilter != '' AND @pFilter IS NOT NULL
    SET @vSQL = @vSQL + ' WHERE ' + @pFilter

    IF @pSort != '' AND @pSort IS NOT NULL
    SET @vSQL = @vSQL + ' ORDER BY ' + @pSort

    EXECUTE (@vSQL)

    -- Get the total number of rows selected
    SET @vTotalRows = @@ROWCOUNT

    -- If page number = 0, set it to the first page
    IF @pPage = 0
    SET @pPage = 1

    -- If page number is beyond the last page, set page to the last page
    IF (@pPage * @pPageRows) > @vTotalRows
    BEGIN
    SET @pPage = @vTotalRows / @pPageRows
    IF (@vTotalRows % @pPageRows) != 0
    SET @pPage = @pPage + 1
    END

    SET @vRowStart = ((@pPage - 1) * @pPageRows) + 1
    SET @vSQL = 'SELECT * FROM ' + @vTempTable + ' WHERE ROWID BETWEEN ' + CAST(@vRowStart AS VARCHAR(10)) +
    ' AND ' + CAST((@vRowStart + @pPageRows - 1) AS VARCHAR(10)) + ' ORDER BY ROWID'
    EXECUTE (@vSQL)

    SET @vSQL = 'DROP TABLE ' + @vTempTable
    EXECUTE (@vSQL)

GO 
```

以下是一些关于如何使用 Northwing 数据库的示例：

```
EXECUTE [dbo].[GetPage] 'Customers', '*', '', '', 1, 10
EXECUTE [dbo].[GetPage] 'Customers', '*', '', 'CustomerID DESC', 1, 10 
```

确认一下，这不是我的工作，而是由 [http://www.eggheadcafe.com/PrintSearchContent.asp?LINKID=1055提供](http://www.eggheadcafe.com/PrintSearchContent.asp?LINKID=1055)

干杯，约翰

# sql - SQL SUBSTRING vs RIGHT - 最佳实践

> ID：503573
> 
> 赞同：24
> 
> 时间：2009-02-02T15:23:06.410
> 
> 标签：sql, tsql, string

我试图找出从字符串开头删除字符时的最佳做法。

在某些语言中，您可以使用不带长度参数的 MID，但在 TSQL 中，长度是必需的。

考虑以下代码，最佳做法是什么？（十六进制字符串是可变长度的）

```
DECLARE @sHex VARCHAR(66)
SET @sHex = '0x7E260F3DA734AD4BD816B88F485CE501D843DF067C8EDCB8AC7DAD331852E04D'

PRINT RIGHT(@sHex,LEN(@sHex) -2)
PRINT SUBSTRING(@sHex,3,LEN(@sHex) -2)
PRINT SUBSTRING(@sHex,3,65535) 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-02T15:24:56.093

嗯，第一个更能表达你的意图。最后一个显然是混乱的（硬编码长度等）。我怀疑你会发现第一个和第二个之间的性能差异很大，所以我会使用最简单的 - `RIGHT`。

当然，如果你做了很多，你可以写一个 udf 来封装这个 - 然后如果你改变主意，你只有一个地方可以改变......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-02T15:37:49.580

+1 在正确的功能上，你想做什么更清楚

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-02T15:27:32.190

我会使用该`right`功能，因为它可以更好地显示您的意图。该`substring`函数最适合用于从较长字符串的中间提取字符串。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-03T13:05:34.273

我使用第二个 SUBSTRING，因为它更便携。并非所有 dbms 都有 LEFT 和 RIGHT。

# java - 将一百万个数字从java传递到matlab？

> ID：503578
> 
> 赞同：3
> 
> 时间：2009-02-02T15:25:33.533
> 
> 标签：java, matlab, double

我有一些在 10.919 秒内运行的代码。对其进行分析表明，10.182 秒被浪费在

```
opaque.double 
```

当我使用时调用

```
jClass.GetArrays(jArray1,jArray2);

struct.prop1 = double(jArray1);
struct.prop2 = double(jArray1); 
```

可以做什么？我必须使用 Java 与外部 API 进行交互。

编辑：我使用了以下技巧：

```
struct.prop1 = cell2mat( cell( jArray1) ); 
```

并下降到 1.5s / 2.2s

编辑：

使java返回数组的长逗号分隔字符串表示，然后使用

```
data = strread(char(jString),'%f','delimiter',',' ); 
```

产生几乎可以忍受的性能

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T16:00:45.830

问题在于盒装 Java 原语的使用——在本例中为***java.lang.Double 。***

只需将 Java 的签名从 Double 更改为 double，Matlab 就可以无缝地处理数组，而无需转换开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T15:29:11.017

您可能会考虑将其保存到文件中，然后在另一端读取它。它也可能同样慢（尤其是在涉及网络的情况下），但值得一试。

您还可以考虑将其转换为二进制数据块，然后传递它，然后再将其转换回来。

我有一个偷偷摸摸的怀疑，由于表现不佳，它会在自己的事务中传递数组的每个元素，而不是一次全部传递。

-亚当

# c# - 如何从 ScaleOut StateServer (SOSS) 获取可用 NamedCache 对象的列表？

> ID：503580
> 
> 赞同：2
> 
> 时间：2009-02-02T15:25:59.727
> 
> 标签：c#

我正在使用 v4.0。

**更新：**

到目前为止，我已经一起破解了这个：

```
public class AllFilter : IFilter
{
    #region IFilter Members

    IndexCollection IFilter.GetIndexCollection()
    {
        return new IndexCollection();
    }

    MatchOptions IFilter.GetMatchOptions()
    {
        return MatchOptions.MatchAll;
    }

    #endregion
}

public class CacheMonitorController : Controller
{
    public ActionResult Index()
    {
        var results =
            from result in ApplicationNamespace.GlobalNamespace.Query(new AllFilter()).OfType<StateServerKey>()
            group result by result.AppId;

        var b = new StringBuilder();

        foreach (var result in results)
        {
            var cache = CacheFactory.GetCache(result.Key);                
            b.AppendLine(cache.Name);
        }

        return this.Content(b.ToString(), "text/plain");
    }
} 
```

不幸的是，缓存的名称总是出现`null`，即使在创建缓存时肯定有一个名称。这个名字当然需要在 UI 中是可识别的，所以我需要一种方法来获取它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T18:32:52.300

显然，在 v4.0 中没有办法做到这一点 - 存储本身的键以及值的键都存储为哈希（以`uint`s 的形式），所以除非使用 NamedCache 检索实名，不知其名。

唯一的选择是跟踪缓存中另一个存储中键的字符串值。

根据 ScaleOut 软件的 Mark Waterman 的说法，检索名称的功能将在 2009 年春季发布的 v5.0 中提供。

# ruby - 如何访问 Ruby 中的符号表？

> ID：503583
> 
> 赞同：7
> 
> 时间：2009-02-02T15:26:22.097
> 
> 标签：ruby, serialization, symbols

有没有办法在 Ruby 中访问符号表中的所有内容？我希望能够序列化或以其他方式保存程序运行的当前状态。为此，我似乎需要能够遍历范围内的所有变量。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T17:32:29.817

我认为他来自 perl 背景，并且他想获取脚本中定义的所有变量并将它们序列化。这样，当他加载文件时，他会取回它们。我仍在寻找如何获取变量列表，但将使用 Marshal.dump 进行序列化，并使用 Marshal.load 进行读取。一旦我了解如何获取所有已定义变量的列表，我将编辑该帖子。

编辑：找到了！

您可以通过调用这些方法获取所有变量的列表：

```
local_variables
global_variables

```

如果您还没有序列化代码，我建议您这样做：

*   创建一个包含变量名和变量值的类或 Struct 实例，并将它们添加到数组中：

```
 local_variables.each {|var| my_array << MyVarObject.new(var,eval(var)) } # eval is used to get the value of the variable 

```

然后序列化数组：

```
 data = Marshal.dump(my_array)
File.open("myfile.ser","w") do |file|
  file.puts data
end
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-02T17:26:22.463

如果我正确理解了您的问题-您希望查看程序中的所有符号，那么以下内容应该可以解决问题：

```
puts Symbol.all_symbols.inspect 
```

“all_symbols”类方法将返回程序中当前每个符号的数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T17:20:49.217

我不相信有，但你总是可以使用[marshall](http://www.ruby-doc.org/core-1.8.7/classes/Marshal.html)转储/加载。

# javascript - 如何仅传递某些表单值

> ID：503592
> 
> 赞同：0
> 
> 时间：2009-02-02T15:28:02.953
> 
> 标签：javascript, html

我有一个包含很多 SELECT 的表单。由于各种原因，我只想将用户选择的表单传递给表单。换句话说，每个 SELECT 都是这样的：

```
<SELECT name=field001>
  <option value=-1>Please pick a value</option>
  <option value=1>1</option>
  <option value=2>2</option>
  <option value=3>3</option>
</SELECT> 
```

通常，一次只会选择一两个，我只想将选定的传递给表单。我猜我需要取消设置 JavaScript 中为 -1 的输入，但我不知道该怎么做，也想知道这种事情是否有标准方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-02T15:36:11.313

当您发布表单时，它会将每个控件的值发送到服务器。如果您需要防止这种情况发生，我认为您最好的选择是覆盖 onSubmit 操作并重定向到同一页面的新实例，仅在查询字符串中放置您想要的信息。

请记住，这会大大增加您的代码复杂性，并使其更难维护。我的观点是，您根本不会获得足够的性能来使您的努力值得，但这取决于您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T15:41:45.610

这并不常见。

如果您真的需要它，那么您可以执行@Sergio 建议的操作，或者实际删除要从 dom 中跳过的项目，或者在提交时将它们标记为禁用（尽管有些浏览器我使用`disabled`控件做不同的事情 -你必须检查）。

这真的不常见。如果您有太多选择以至于发送它们会导致问题，那么您的选择太多了。

处理这个问题的正常方法是使用你的魔法值“-1”来知道何时忽略服务器端的某些值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T15:48:21.303

无论数量如何，我都会始终检查每个元素，尤其是因为数量。您还能如何确定用户没有更改其他内容？你说：

> 通常，一次只会选择一两个

所以就在那里，你甚至不能 100% 确定，是吗？经验告诉我永远不要相信你希望“通常”发生的事情，因为它往往会出乎意料地抓住你！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T16:45:57.693

假设您只有一个表单，请将此脚本添加到您的页面：

```
document.forms[0].onsubmit = function(){
    var selects = this.getElementsByTagName('select');
    for ( var i = selects.length - 1; i>=0; i-- ) {
        if ( selects.item(i).value == -1 ) {
            selects.item(i).parentNode.removeChild(selects.item(i));
        }
    }
    return true;
} 
```

# javascript - 如何使aa：hover逐渐有其他颜色

> ID：503595
> 
> 赞同：6
> 
> 时间：2009-02-02T15:28:28.850
> 
> 标签：javascript, html, css, colors

嗨，我的菜单有颜色`#006699`，当悬停时我希望它**逐渐** 转到颜色`#4796E9`。那可能吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-02T15:31:18.703

是的，您可以使用[jQuery](http://www.jquery.com)来做到这一点。CSS Tricks 有一个名为*Color Fading Menu with jQuery* [here](http://css-tricks.com/color-fading-menu-with-jquery/)的教程。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-04T11:29:20.547

您也可以使用 CSS3 来实现它（不过，它适用于除 IE9 和更低版本之外的所有浏览器）。这是一个例子：

```
-webkit-transition: color 0.2s ease-out;
-moz-transition: color 0.2s ease-out;
-ms-transition: color 0.2s ease-out;
-o-transition: color 0.2s ease-out;
transition: color 0.2s ease-out; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T15:29:46.117

[这听起来像是您可以使用jQuery](http://docs.jquery.com/Effects)做的事情。

本

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-13T22:31:30.767

## 你不需要 JavaScrip ！！！

这可以很容易地完成`CSS3 transitions`

```
<style>
nav {
  transition: background-color 0.5s ease;
  background-color: #006699;
  color: white;
}

nav:hover {
  background-color: #4796E9;
}
</style>

<nav>
  <h1>This menu changes color GRADUALLY on mouse-hover</h1>
</nav> 
```

看看我的工作代码笔：http: [//codepen.io/omarjuvera/pen/vGMezz](http://codepen.io/omarjuvera/pen/vGMezz)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T15:31:37.733

我认为CSS不可能做到这一点。但是你可以通过javascript来做到这一点。试试jquery中的[fadeIn](http://docs.jquery.com/Effects/fadeIn#speedcallback)效果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T15:31:51.027

[这是](http://davidwalsh.name/fading-links-jquery-dwfadinglinks)一个有人用 JQuery 做的插件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T15:31:52.913

使用 JavaScript（您可以使用 jQuery animate() 方法轻松完成）或 WebKit CSS 动画：[http](http://webkit.org/blog/138/css-animation/) ://webkit.org/blog/138/css-animation/ （请注意，此方法仅适用于 WebKit）。

我推荐 JavaScript 路线——使用 jQuery 或 scriptaculous 之类的框架。此处有关 jQuery 动画方法的信息：http: [//docs.jquery.com/Effects/animate](http://docs.jquery.com/Effects/animate#paramsdurationeasingcallback)

# apache-flex - 松散耦合的 Flex 3 同级组件

> ID：503626
> 
> 赞同：1
> 
> 时间：2009-02-02T15:36:26.977
> 
> 标签：apache-flex, actionscript-3

我正在创建一个应用程序，其中有两个 mxml 组件 MainPanel.mxml 和 TextPanel.mxml，它们包含在名为 index.mxml 的父应用程序中。当我在 TextPanel.mxml 中存在的文本框中键入内容时，我希望能够将此数据绑定到 TextPanel.mxml 中存在的标签。我知道这可以通过执行以下操作来完成：

```
<mx:Label text="{Application.application.textArea.text1.text}" /> 
```

但是，我想让我的组件更容易与系统交换，这会产生我不想要的依赖关系。

以下是我想出的解决方案，尽管我觉得那里有更好的方法（为简洁起见，省略了一些代码）。

index.mxml（父应用程序）：

```
<mx:Script>
    <![CDATA[

        [Bindable]
        private var _text:String;

        private function handleTextChange(input:String):void {
            _text = input;
        }

    ]]>
</mx:Script>

<tp:TextPanel id="textArea" 
    textChange="handleTextChange(event.stringData)"/>

<cp:MainPanel id="mainArea" text = "{_text}" /> 
```

文本面板.mxml：

```
<mx:Metadata>
    [Event(name="textChange", type="events.CustomStringDataEvent")]
</mx:Metadata>

<mx:Script>
    <![CDATA[
        import events.CustomStringDataEvent;
        private function textChangeHandler(event:Event):void {
            var input:String = event.target.text;
            dispatchEvent(new CustomStringDataEvent(input, 'textChange'));
        }
    ]]>
</mx:Script>
<mx:TextInput id="text1" change="textChangeHandler(event)"/> 
```

主面板.mxml

```
<mx:Script>
    <![CDATA[

        [Bindable]
        public var text:String;

    ]]>
</mx:Script> 
<mx:Label text="{text}" /> 
```

所以最后我的问题**是，在两个兄弟组件之间创建松散耦合的最佳实践是什么？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T17:08:26.433

当然，这是一种方法。但是您也可以创建另一个类，例如，保存由您的一个（或任何）组件写入的数据，然后为每个组件提供对该对象的引用；这可能会通过更少的代码和手动事件处理为您带来相同的效果。

例如，保存数据的类对象可能看起来像这样（注意`Bindable`公共成员的属性：

```
package
{
    public class MyBindableObject
    {
        [Bindable]
        public var myStringProperty:String = "";        

        public function MyBindableObject()
        {
            //
        }   
    }
} 
```

...和您的主应用程序容器，它将最初实例化对象（并分发对其子组件的引用），如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical" xmlns:local="*" initialize="this_initialize(event)">

    <mx:Script>
        <![CDATA[

            [Bindable]
            private var myObject:MyBindableObject;

            private function this_initialize(event:Event):void
            {
                myObject = new MyBindableObject();
            }

        ]]>
    </mx:Script>

    <mx:TextInput text="{myObject.myStringProperty}" />
    <local:MyCustomComponent myObject="{myObject}" />
    <local:MyOtherCustomComponent myObject="{myObject}" />

</mx:WindowedApplication> 
```

...和 ​​MyCustomComponent （注意`Bindable`&`Inspectable`属性），在这种情况下恰好`myObject.myStringProperty`直接写入：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml">

    <mx:Script>
        <![CDATA[

            [Bindable]
            [Inspectable]
            public var myObject:MyBindableObject;

            private function myEventHandler(event:Event):void
            {
                myObject.myStringProperty = txt.text;
            }

        ]]>
    </mx:Script>

    <mx:TextInput id="txt" text="{myObject.myStringProperty}" keyUp="myEventHandler(event)" /> 
```

... 和 MyOtherCustomComponent，它接收在前面的组件中所做的更改（并且这些更改也顺便传播到容器应用程序）：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml">

    <mx:Script>
        <![CDATA[

            [Bindable]
            [Inspectable]
            public var myObject:MyBindableObject;

        ]]>
    </mx:Script>

    <mx:TextInput text="{myObject.myStringProperty}" />

</mx:Canvas> 
```

同样，容器应用程序初始化对象实例，将它自己的子组件的属性之一绑定到该对象的属性的值（可选），并将对该对象的引用传递给可能想要使用它的任何子组件。在这种情况下，第二个组件写入值，而其他两个组件立即获取更改，因为 MyBindableObject 类上的 myStringProperty 标记为 Bindable，并且每个组件都包含一个侦听器，用于对该属性的更改。

这个例子有点简单，因为它实际上只是在某个对象上设置了一个字符串值，从而将事件分派工作卸载到 Flex 框架，这仅消除了几行代码——但这在这里可能是一件好事，因为有真的不需要为简单的文本更改/属性更改事件设计自定义事件，因为 Flex 可以为您处理大部分甚至所有这些工作。

尽管如此，它仍然取决于您希望自定义 TextPanel 的程度。如果您想将其开发为更复杂的组件，那么我可能会建议将初始对象实例化移动到 TextPanel 本身，通过定义和调度其他自定义事件并拥有主应用程序和兄弟组件来完成您所做的事情通过 textPanel.addEventListener（或类似的 MXML 中的内联）或 textPanel.myObject.addEventListener 侦听组件或可绑定对象上的事件通知，具体取决于哪个合适。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T17:08:09.257

您在这里所做的是一种[中介模式](http://en.wikipedia.org/wiki/Mediator_pattern)的实现，这是一种完全可以接受的做事方式，在我看来，这可能是您正在寻找的“最佳实践”，因为您正在使用的组件不直接相互依赖——它们只是调度事件并让其他人处理“更高级别”的功能。

另一种方法是[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)，您可以在其中为组件提供相互引用并让它们直接通信。这样，您*将使*组件相互依赖（或者可能不完全相互依赖，但任何实现相同接口的组件），但您不必编写任何中介代码。在这里，与中介者模式相反，我所指的“高级”功能实际上是组件本身而不是其他人（中介者）的责任。

# jquery - 如何使用 jquery 将 json 格式的多个参数传递给 Web 服务？

> ID：503627
> 
> 赞同：16
> 
> 时间：2009-02-02T15:37:48.143
> 
> 标签：jquery, json

我正在尝试使用 jquery 执行 asp.net 网络服务。当我只传递一个输入参数时，它工作正常：

```
$.ajax({  
    type: "POST",  
    url: url,  
    data: "{'Id1':'2'}",  
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: callback
}); 
```

但是如果我尝试传递多个参数它会失败

```
$.ajax({  
    type: "POST",  
    url: url,  
    data: "{'Id1':'2'},{'Id2':'2'}",  
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: callback
}); 
```

当然，当我尝试传递 2 个输入参数时，我修改了 web 方法，使其接受 2 个输入参数。

有任何想法吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-02T15:57:05.077

找到了解决方案：

它应该是：

```
"{'Id1':'2','Id2':'2'}" 
```

并不是

```
"{'Id1':'2'},{'Id2':'2'}" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-02T15:45:43.150

这是在黑暗中的一次尝试，但也许你需要包装你的 JSON 参数；就像这样说：

```
data: "{'Ids':[{'Id1':'2'},{'Id2':'2'}]}" 
```

确保您的 JSON 格式正确？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-12T16:23:44.810

我有同样的问题并通过

```
 data: "Id1=" + id1 + "&Id2=" + id2 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-11T12:25:38.217

我认为最好的方法是：

```
data: "{'Ids':['2','2']}" 
```

要读取此值 Ids[0]、Ids[1]。

# .net - 如何将控件的值从子级获取到.NET 中父级的属性中？

> ID：503630
> 
> 赞同：1
> 
> 时间：2009-02-02T15:38:07.550
> 
> 标签：.net, asp.net, webforms

我有一个具有一些类似控件的表单，并且父级包含属性，但子级实际上具有 html 控件。如何使用父类中的“子”控件设置我的 getter/setter？（网络表格 - 仅供参考）

我通过搜索找到了以下内容，而我正在寻找的是相反的

[从子用户控件获取父用户控件中的属性值](https://stackoverflow.com/questions/463938/getting-value-of-a-property-in-parent-user-control-from-a-child-user-control)

**编辑：**

我应该早点尝试这个，但发现解释这种疯狂的情况是“有趣的”。以下是 100% 有效的方法

```
Get
  Return DirectCast(Page.FindControl("lblCASE_NUMBER"), HtmlContainerControl).InnerHtml
End Get 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T15:45:44.493

如果我理解正确，您在另一个用户控件（父）中有一个用户控件（子），您需要从父级中访问子属性。

如果这是正确的，您需要做的就是像在任何其他类中一样在子级中创建属性或方法。不仅仅是从父母那里使用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T16:19:08.933

跟进评论：

好的，所以如果我理解正确，您希望在用户控件上拥有控件，但在父控件上拥有代码（因为您不想重复代码）。

你有两种方法可以做到这一点：

1 - 将您的代码放在父级并在每个子级上创建属性，以便您可以访问控件的值。

2 - 创建一个抽象类来放置您不想复制的代码并让您的所有孩子都继承它。您将需要在此类中创建公共对象作为“受保护的抽象 ObjectName”，并在您的孩子中将它们设置为“受保护的覆盖 ObjectName”。此选项将提供最少的代码编写，但它“迫使”您理解继承。

# version-control - 当您计划将来进行重写时如何处理分支？

> ID：503632
> 
> 赞同：3
> 
> 时间：2009-02-02T15:38:44.117
> 
> 标签：version-control, tfs, branch

我的开发团队很快就会转向分支——我们已经被 SourceSafe 诅咒了，我们正在转向 Team Foundation Server——我很好奇一些事情。

传统上，当我们对产品进行重大修订时，甚至文件夹结构或文件名都不会保持不变，我们会在源代码控制中创建一个新的根文件夹。

例如

```
$/V1.0
$/V1.1
$/V1.5
$/V2.0 
```

等等。

我对分支是全新的，我正在阅读的一件事是你可以为你的产品的不同版本使用不同的分支。现在，当您谈论对代码进行修补程序或小幅更改或修改时 - 最坏的情况是您可能会添加新文件 - 这是有道理的。

但是，当您制作产品的“V-Next”版本时，您计划或多或少地对产品进行完全重写（[不是从头开始](http://www.joelonsoftware.com/articles/fog0000000069.html)，而是彻底重写），直到文件夹结构和文件名称可能会完全不同，这仍然是您想通过分支做的事情吗？或者您想创建一个新的根目录（上面的 $/V2.0）来处理它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T15:51:09.163

我们的开发团队在 Subversion 中使用了一个非常标准的分支结构。在主存储库中，我们有 3 个文件夹：

*   分支机构
*   标签
*   树干

在您的示例中，所有 V* 文件夹都将位于标签下。所有主要开发都发生在主干中，当我们需要对另一个项目的主干中的内容进行更改时，我们会使用分支。

我们还使用分支来存储对主干的重大更改。如果您需要在重写完成之前修复主干中的错误，这是一个很好的做法。因此，我们将在分支下创建一个“V-Next”分支，完成后，我们将该分支合并回主干。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T16:00:56.427

我不是 TFS 专家，但我对[分支和标签](https://stackoverflow.com/questions/16142#114384)确实有“强烈”的看法。

任何 VCS 中的分支都应保留，以隔离与当前不兼容的开发工作。

这意味着，无论您当前工作的环境（分支或无分支）如何，如果您*在*启动您提到的那些剧烈重构时无法继续当前的开发，那么您需要一个分支。
在该分支中，您的文件历史记录可以采用新路径，同时仍被记录

诀窍是不要解释分支的标签，特别是如果两者都表示为目录。

`V2.0`可以解释为：

*   文件的历史记录应该是固定和不可变的标签
*   历史发展到 2.0 版本的分支

我会推荐一个命名约定来阐明目录背后的意图：
`V2.0_Refactoring`例如会更清晰并指示一个分支。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T15:53:56.130

分支将您的历史记录在一起，并允许您查看项目的完整起源。此外，可能（取决于产品和混乱状态）将已发布版本中的修复合并到“下一个”版本中，这可能会或可能不会减少保持同步的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T16:07:09.067

根据我的经验，最有效的分支策略是有一个单一的“主线”主干，每个主要版本的分支，然后根据需要为每个较小的版本分支。大多数工作都是在主线中完成的，然后当我们非常接近发布时，我们会分支并稳定分支。

您可以为任意小的变更集/发布分支​​，但最终会产生过多的认知开销，使它们变得有价值。您还可以创建更多临时分支以将大型正在进行的工作与主要分支隔离，直到准备好合并更改。

以所有这些作为背景，我认为在发布开始时“重新开始”没有多大价值。即使在发布结束时一切都将发生变化，您仍然希望了解事情如何随着时间的推移而演变的完整历史。我假设 TFS 会跟踪移动/重命名/删除等，因此即使您正在进行大量文件级更改，这也是宝贵的历史记录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T16:38:27.477

您可能想查看一些有关最佳实践的文章：

*   [软件配置管理的高级最佳实践](http://www.perforce.com/perforce/bestpractices.html)
*   [高级 SCM 分支策略](http://www.vance.com/steve/perforce/Branching_Strategies.html)
*   [合并是软件开发人员协作的关键](http://www.markshuttleworth.com/archives/126)

在您的情况下，我不会创建一个分支来托管您的 V-next。只有当您准备好通过创建包装分支向客户交付时，您才应该创建该分支。

我会创建一些短期分支（每个 scrum 迭代 1 个）来托管您的风险开发，并在每次迭代结束时将它们合并回来。只为有风险的开发创建开发分支，例如您正在谈论的密集重构。

你的主分支应该总是稳定的。准备好交付给客户或至少准备扩展包装分支。

我还推荐[SCM 模式](http://www.scmpatterns.com/book/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T23:44:10.383

阅读：http: [//oreilly.com/catalog/practicalperforce/chapter/ch07.pdf](http://oreilly.com/catalog/practicalperforce/chapter/ch07.pdf)

# php - 用 PHP 执行 linux 命令

> ID：503633
> 
> 赞同：4
> 
> 时间：2009-02-02T15:38:46.957
> 
> 标签：php, shell, scripting

我正在尝试通过 PHP 命令行脚本执行 linux 命令，使用 exec 命令没有问题。

问题是，如果出现问题（例如用户/密码不正确），我正在执行的命令（mysqldump）会输出错误消息。我似乎无法捕获此错误以记录它。它只是将此错误打印到屏幕上。

如何使此错误不打印到屏幕上，而是将其放入变量中以在我的脚本中使用？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T15:51:45.683

使用[popen](http://php.net/popen)运行进程。此页面上的示例 #2 准确显示了您正在寻找的内容：

```
<?php
error_reporting(E_ALL);

/* Add redirection so we can get stderr. */
$handle = popen('/path/to/spooge 2>&1', 'r');
echo "'$handle'; " . gettype($handle) . "\n";
$read = fread($handle, 2096);
echo $read;
pclose($handle);
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T15:43:56.977

```
exec("mysqldump -u user -p passwod database >  outputfile.sql 2> error.log"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T15:46:33.650

您需要[将 stderr 重定向到 stdout](http://www.phpdig.net/ref/rn50.html)，以便捕获它。此示例将 stdout 路由到 devnull（因此忽略它）并将 stderr 路由给您：

```
exec('ls * 2>&1 1>/dev/null'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T15:43:02.393

我在 Unix 中不太热（新年决议...），但这些功能看起来很有帮助：

*   **[`shell_exec`](http://uk3.php.net/manual/en/function.shell-exec.php)**- 以字符串形式返回结果。
*   **[`passthru`](http://www.php.net/manual/en/function.passthru.php)**- 看起来你可以像这样执行：`passthru('command', $result);`然后使用`$result`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T15:41:55.560

你看过[system()](http://php.net/manual/en/function.system.php)命令吗？自从我做任何 PHP 以来已经有一段时间了，但这敲响了警钟。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T15:42:04.517

尝试使用反引号？

```
$var = `命令`;

```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T15:49:22.443

以下将 stderr 消息路由到与正常输出相同的位置。

```
exec("mysql_dump blah 2>&1",$output,$return_val)
if($return_val !== 0) 
echo "there was an error" 
```

2>&1 表示将 stderr 消息重新路由到与 stdout 相同的位置，因此将被加载到输出数组中。

# django - 将 ExtJS 与 Django 框架一起使用的最佳实践是什么

> ID：503635
> 
> 赞同：6
> 
> 时间：2009-02-02T15:40:02.133
> 
> 标签：django, extjs

我喜欢在服务器端使用 django，在客户端使用 extjs。可能使用 REST 接口来发布资源。对此有什么想法？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T02:18:45.573

您可能需要考虑[django-rest-interface](http://code.google.com/p/django-rest-interface/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-31T14:40:36.887

可能您应该使用 extjs 版本更新您的问题。当前的 extjs 版本 4.2 可以很好地与 django 集成。示例之一： [https ://github.com/linovia/django-rest-framework-extjs](https://github.com/linovia/django-rest-framework-extjs)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-30T17:24:27.913

ExtJs 3 现在大量使用 REST！

# winapi - 如何以编程方式打开控制面板？

> ID：503636
> 
> 赞同：5
> 
> 时间：2009-02-02T15:40:17.827
> 
> 标签：winapi, controlpanel

如何以编程方式打开自定义控制面板，例如 custom.cpl？具体来说，作为 32 位应用程序运行时，如何打开 64 位 cpl？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-02T15:49:03.970

由于我在 SO 上没有找到好的答案，因此这是我的研究的解决方案：

*   启动一个新的应用程序“control”，它将控制面板的名称作为其第一个参数：

> ```
> ::ShellExecute(m_hWnd, NULL, _T("control.exe"), _T("access.cpl"), NULL, SW_SHOW); 
> ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T02:46:31.670

Vista 添加了对规范名称的支持，因此您不必对 dll 文件名和选项卡索引进行硬编码

示例：WinExec("%systemroot%\system32\control.exe /name Microsoft.WindowsUpdate", SW_NORMAL);

（名字总是英文）

有关列表，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/cc144191(VS.85).aspx)

XP/2000 支持“control.exe 鼠标”和其他一些关键字，请参阅相同的 MSDN 页面以获取列表（您可以通过在 control.exe 上运行字符串来找到一些未记录的关键字）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-01-08T14:25:11.453

就用这个....

```
ProcessStartInfo startInfo = new ProcessStartInfo("appwiz.cpl");
startInfo.UseShellExecute = true;
Process.Start(startInfo); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-28T11:49:03.500

Step1 : 从机器上读取系统目录。Step2 : 使用 Process 启动 ControlPanel

```
 **Process.Start(System.Environment.SystemDirectory + @"\appwiz.cpl");** 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-20T01:09:12.200

正如我之前在另一个问题中提到的：

如果您在命令提示符中键入“开始控制”或“控制”，它将打开控制面板。

因此只需运行一个进程。

这段代码（波纹管）对我来说非常有效：

```
public Form1()
{
     InitializeComponent();
}

    #region Variables
    Process p;
    #endregion Variables

    [...]

    void myMethod()
    {
            try
            {
                p = new Process();
                p.StartInfo.FileName = "cmd.exe";
                p.StartInfo.RedirectStandardInput = true;
                p.StartInfo.RedirectStandardOutput = true;
                p.StartInfo.CreateNoWindow = true;
                p.StartInfo.UseShellExecute = false;
                p.Start();

                p.StandardInput.WriteLine("start control"); 
                p.StandardInput.Flush();
                p.StandardInput.Close();
                Console.WriteLine(p.StandardOutput.ReadToEnd());
            }
            catch (Exception ex) { MessageBox.Show(ex.Message); }
    } 
```

# c# - 对象架构设计问题

> ID：503651
> 
> 赞同：0
> 
> 时间：2009-02-02T15:45:40.780
> 
> 标签：c#, architecture, oop, object

我试图弄清楚如何最好地布置这一点。我将解释我现在所拥有的，但我想知道是否有更好的方法来做到这一点。

我有一个具有基本属性的类 Section：名称、描述等。我使用部分列表供用户选择。他们可以根据需要向 Parent 对象和任意数量的 Section 添加一个 Section。

当他们向父级添加一个部分时，他们必须分配它属于哪个组（比如说 group1、group2、group3）以及它将以什么顺序显示。这个 Group 属性不在桌面上，当我列出 Sections 供用户选择时，不需要组，这没有意义。想想他们正在添加的这个部分作为具有额外属性的克隆。

我有另一个表，它有一个外键到 Parent 和 Section。许多部分可以添加到 1 个父级。在此链接表上还有他们添加的每个部分的 Grouping 和 DisplayOrder 列（以及其他一些列）。

因此，当我创建 Parent 对象并查询其 Sections 的集合时，我是否想尝试使用相同的 Section 类并添加一个 Grouping 属性？

```
 Section 1
 Section 2
 Section 3

Parent 1
     Section 1 - Group = g1, DisplayOrder = 1
     Section 1 - Group = g2, DisplayOrder = 2
     Section 2 - Group = g2, DisplayOrder = 3
     Section 3 - Group = g3, DisplayOrder = 4

Parent 2
     Section 4 - Group = g3, DisplayOrder = 1
     Section 1 - Group = g2, DisplayOrder = 2
     Section 2 - Group = g3, DisplayOrder = 3 
```

如果您不知道我在说什么，请告诉我，我会尽力解释得更好……否则我会删除它并假装我从未问过。=P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T16:02:34.320

听起来该组不是部分的固有属性。仅在将部分与父母相关联时才有意义。鉴于此，我不会添加组属性。也许制作一个公开组的部分容器类：

```
interface IGroupedSection
{
    ISection Section { get; }
    string Group { get; }
} 
```

或将分组作为父级的属性，例如

```
interface IParent
{
     void AddSection(string group, ISection section);
     IEnumerable<ISection> GetSectionsInGroup(string group);
} 
```

毕竟，您可能需要多个部分分组策略，因此最好不要将您的部分设计与它可以包含的集合类型结合起来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T16:12:07.717

如果可能在对象层次结构中，您希望避免子到父链接。它导致非常紧密的耦合和尴尬的关系。

假设我了解您的问题，我将创建一个 Group 对象以插入到父母和部分之间。父母会有一个组列表，每个组都有一个部分列表。

**编辑以响应 DisplayOrder：**

显示顺序实际上是父级的属性，而不是部分。父级包含一个部分列表，并且该列表具有与之关联的特定顺序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T15:53:39.203

我会添加 group 属性。空值适用于尚未分配给父级的部分。这类似于 Windows 窗体组件中 Owner 的行为。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-02T15:58:07.120

我会让 group 成为 Section 的属性。然后，您可以使用 LINQ 在 Parent 上添加 group1、group2 等的属性来查询集合并仅返回每个组中的那些（如果您需要能够这样做）。

# asp.net - 从 HttpContext.Current.Request 获取标签的值

> ID：503654
> 
> 赞同：1
> 
> 时间：2009-02-02T15:45:56.223
> 
> 标签：asp.net, asp.net-mvc

我的表单中有一个标签，我试图使用 HttpContext.Current.Request 获取标签的值。但标签不是关键，只有输入类型。有没有办法检索标签的值？

你好

请求[“lbl1”] 不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T15:51:42.313

您无法从请求集合中获取标签值。

可以通过请求集合访问文本框、下拉菜单、复选框、单选按钮、列表框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T15:50:23.110

试试 HttpContext.Current.Request.Form["lbl1"]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T15:52:45.663

标签不是 HTML 输入类型，因此它不会出现在 HttpRequest 中。

您可以在客户端使用 JavaScript 获取 lbl1 的值并将其放入隐藏的表单变量中。但是，您必须提供更多关于您正在尝试做的事情的详细信息，看看这是否可行。

# sharepoint - MOSS 2007 Wiki 导出到 MS Word 或 PDF

> ID：503657
> 
> 赞同：1
> 
> 时间：2009-02-02T15:46:21.183
> 
> 标签：sharepoint, ms-word, ms-office, wiki, sharepoint-2007

我已经开始使用 MOSS 2007 的 wiki 功能来存储与我正在处理的项目相关的正在进行的技术文档，在我开始写几页之后我突然想到，没有简单的方法可以将所有页面导出到一份文件。

对于那些熟悉 MOSS 2007 的人，有什么想法可以实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T04:46:00.513

过去，我创建了一个将 SharePoint 内容导出为 PDF 和 HTML 的网站功能，但这是用于发布网站的。我认为它需要一些重写才能使其与 Wiki 一起使用。

它基本上遍历站点及其所有子站点的导航，并读取存储在“页面”文档库中的所有页面。然后对于每个页面，它使用 XSLT 提取内容。

让我知道我是否应该在某个地方提供源代码。

干杯，迈克尔

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-12T12:37:20.267

您应该能够创建一个显示所有 wiki 文章内容的视图。这不漂亮；你会得到一个很长的网页。我现在没有启动并运行共享点来告诉你确切的步骤，但我以前做过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T19:34:15.357

[BlueRidge](http://wiki.bluebridge.de/)有一个扩展程序，允许您导出为 PDF，但 640 欧元以上的价格有点贵。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T13:33:24.023

您可以将内容复制/粘贴到所需的文档中。这不方便，但它是一个潜在的解决方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T01:06:32.583

我也在寻求解决方案。我们有一个遵循分级结构的多级 Wiki 内容。我们能否自动将 MOSS Wiki 内容导出到更结构化的数据库，例如 Excel、Access 或 XML？

# ruby-on-rails - Rails 和 Adob e Livecycle 的奇怪问题 pdf

> ID：503659
> 
> 赞同：1
> 
> 时间：2009-02-02T15:46:55.113
> 
> 标签：ruby-on-rails, pdf, adobe, livecycle

我正在构建一个显示（产品）目录的站点，单击时将打开 Adob​​e Livecycle 生成的 pdf。有一些表单字段，当按下提交按钮时，这些字段将被提交到 url [http://localhost:3000/pdf-parser](http://localhost:3000/pdf-parser)。

该文件获取所有参数并可以将它们存储在数据库中。问题是确定哪个用户通过 Pdf 发送数据？如果我可以将一些参数（如 user_id）注入到 Livecycle pdf 文件中，该文件将被传递给[http://localhost:3000/pdf-parser](http://localhost:3000/pdf-parser)以便我可以标记用户，那么这可以实现。

我用谷歌搜索了几次，但由于 Adob​​e Livecycle 是一个新产品，我无法得到答案。

那么，任何 Rails 编码器都可以为我指明正确的方向吗？或者这甚至可以实现吗？或者有没有其他解决这个问题的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T21:55:22.550

如果您在向`pdf`用户发送数据时设置了任何 cookie（例如，继续在控制器的`session`对象中存储一些内容，例如`session[:user_id]=1234`），Acrobat 是否会连同提交的表单数据一起发回 cookie？（例如是`session[:user_id]=1234`？）如果是这样，那么你有你的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T08:29:03.077

我使用 XFA xml 文件和 dotNet 自定义构建的渲染器库解决了它。

# c# - 在 UpdatePanel 之外更新控件

> ID：503662
> 
> 赞同：13
> 
> 时间：2009-02-02T15:47:24.193
> 
> 标签：c#, asp.net, ajax, asp.net-ajax, updatepanel

所以我有一个`UserControl`带有一些级联`DropDownList`的 s 。从列表 1 中选择会启用列表 2，而后者又会启用列表 3。在所有三个列表中做出选择后，您可以转到下一页。

`DropDownList`s 都在一个`UpdatePanel`. 但是“下一页”按钮在`UpdatePanel`. 应该禁用该按钮，直到所有三个列表都有选择，然后应该再次启用它。但由于该按钮位于 之外`UpdatePanel`，因此在我进行选择时它不会更新。（**编辑**：“下一页”按钮位于还包含的页面上`UserControl`。）

我知道解决这个问题的一种方法：

```
var scriptManager = ScriptManager.GetCurrent(this.Page);
scriptManager.RegisterPostBackControl(dropDownList1);
scriptManager.RegisterPostBackControl(dropDownList2);
scriptManager.RegisterPostBackControl(dropDownList3); 
```

这样可以确保在更改任何下拉列表时进行回发，以便按钮可以更新。但是如果我这样做，我可能会通过首先摆脱 来简化`UpdatePanel`。

有没有另一种方法，通过一些聪明的 JavaScript 或其他东西，我可以在`UpdatePanel`不放弃 Ajax 的情况下更新控件之外的控件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-02T16:05:13.767

在下一个按钮周围放置一个 UpdatePanel 并为每个下拉菜单创建一个触发器，以便它触发异步回发。前任：

```
<Triggers>
    <asp:AsyncPostBackTrigger ControlID="dropDownList1" />
    <asp:AsyncPostBackTrigger ControlID="dropDownList2" />
    <asp:AsyncPostBackTrigger ControlID="dropDownList3" />
</Triggers> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-02T15:55:30.480

你不能在“下一页”周围添加一个更新面板，然后在下拉列表更新面板中添加一个触发器来触发下一页更新面板吗？

只是抛出想法，没有实际尝试过:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T03:36:38.717

您可以通过将控件放入 update_panel2 并说`update_panel2.update()`.

请注意，`UpdateMode`必须将 UpdatePanel 的 设置`conditional`为才能正常工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T16:05:09.290

理想情况下，这将在 javascript 中完成，并在 click 事件处理程序中进行服务器端验证检查。

一个快速的 jQuery 示例：

```
//assuming the dropdowns all have the css class "cascade"
$('select.cascade').change(function() {
  If ($('option:selected',this).length == 3) {
    $('input[id$=btnNext]').removeAttr('disabled');
  }
}); 
```

# c++ - 类中派生信息的成员函数

> ID：503664
> 
> 赞同：2
> 
> 时间：2009-02-02T15:48:06.377
> 
> 标签：c++, oop

在为类设计接口时，我通常会考虑是否应该提供可以通过使用其他成员函数的组合来计算/派生的成员函数。例如：

```
class DocContainer
{
 public:
   Doc* getDoc(int index) const;
   bool isDocSelected(Doc*) const;
   int getDocCount() const;

  //Should this method be here???
  //This method returns the selected documents in the contrainer (in selectedDocs_out)
  void getSelectedDocs(std::vector<Doc*>& selectedDocs_out) const;
}; 
```

我应该将它作为类成员函数提供还是作为可以定义此方法的命名空间？哪个是首选？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T15:59:36.757

我认为将 getSelectedDocs 作为成员函数很好。对于 DocContainer 来说，这是一个完全合理的操作，因此作为成员是有意义的。成员函数应该在那里使类有用。他们不需要满足某种最低限度的要求。

将它移到类之外的一个缺点是人们在尝试弄清楚如何使用 DocContainer 时必须查看两个地方：他们需要查看类和实用程序命名空间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T16:44:42.033

一般来说，您可能应该更喜欢自由函数。从 OOP 的角度考虑它。

如果该函数不需要访问任何私有成员，那么为什么要*授予*它访问它们的权限？这不利于封装。这意味着当类的内部被修改时，更多的代码可能会失败。

它还限制了可能的代码重用量。

如果你把函数写成这样：

```
template <typename T>
bool getSelectedDocs(T& container, std::vector<Doc*>&); 
```

然后 getSelectedDocs 的相同实现将适用于*任何*公开所需功能的类，而不仅仅是您的 DocContainer。

当然，如果您不喜欢模板，可以使用接口，然后它仍然适用于实现该接口的任何类。

另一方面，如果它是一个成员函数，那么它只适用于这个特定的类（可能还有派生类）。

C++ 标准库遵循相同的方法。例如，考虑一下`std::find`，由于这个确切的原因，它是一个自由函数。它不需要知道它正在搜索的类的内部结构。它只需要*一些*满足其要求的实现。这意味着相同的`find()`实现可以在标准库或其他地方的任何容器上运行。

Scott Meyers 主张[同样的事情](http://www.ddj.com/cpp/184401197)。

如果你不喜欢它弄乱你的主命名空间，你当然可以把它放到一个单独的命名空间中，为这个特定的类提供功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T15:59:49.253

STL 基本上针对的是小型接口，因此在您的情况下，当且仅当`getSelectedDocs`可以比组合更有效地实现`isDocSelected`并且`getDoc`它将被实现为成员函数。

这种技术可能不适用于任何地方，但它是防止界面混乱的一个很好的经验法则。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-02T16:48:24.413

我同意[Konrad](https://stackoverflow.com/questions/503664/member-functions-for-derived-information-in-a-class/503712#503712)和[jalf](https://stackoverflow.com/questions/503664/member-functions-for-derived-information-in-a-class/503861#503861)的回答。除非拥有“getSelectedDocs”有显着的好处，否则它会使 DocContainer 的界面变得混乱。

添加此成员会触发我的[臭代码](http://en.wikipedia.org/wiki/Code_smell)传感器。DocContainer 显然是一个容器，那么为什么不使用迭代器来扫描单个文档呢？

```
class DocContainer
{
public:
  iterator begin ();
  iterator end ();

  // ...
  bool isDocSelected (Doc *) const;
}; 
```

然后，根据需要使用仿函数创建文档向量：

```
typedef std::vector <Doc*> DocVector;
class IsDocSelected {
public:
  IsDocSelected (DocContainer const & docs, DocVector & results)
  : docs (docs)
  , results (results)
  {}

  void operator()(Doc & doc) const
  {
    if (docs.isDocSelected (&doc))
    {
      results.push_back (&doc);
    }
  }
private:
  DocContainer const & docs;
  DocVector & results;
};

void foo (DocContainer & docs)
{
  DocVector results;
  std :: for_each (docs.begin ()
    , docs.end ()
    , IsDocSelected (docs, results));
} 
```

这有点冗长（至少在我们有[lambdas](http://en.wikipedia.org/wiki/C%2B%2B0x#Lambda_functions_and_expressions)之前），但这种方法的一个优点是特定类型的过滤不与 DocContainer 类耦合。将来，如果您需要一个新的“未选择”文档列表，则无需将接口更改为 DocContainer，您只需编写一个新的“IsDocNotSelected”类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T16:02:36.767

答案可能是“这取决于”......

如果该类是库的公共接口的一部分，将被许多不同的调用者使用，那么有一个很好的论据可以提供多种功能以使其易于使用，包括一些重复和/或交叉。但是，如果该类仅由单个上游调用者使用，那么提供多种方法来实现同一件事可能没有意义。请记住，接口中的所有代码都必须经过测试和记录，因此添加最后一点功能总是要付出代价的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T18:35:34.867

我认为如果该方法是完全有效的：

*   适合班级职责
*   对一小部分班级客户不太具体（至少 20%）

如果该方法包含复杂的逻辑/计算，在许多地方维护起来比仅在类中更昂贵，则尤其如此。

# svn - 重组颠覆存储库的长期影响是什么

> ID：503665
> 
> 赞同：5
> 
> 时间：2009-02-02T15:48:11.400
> 
> 标签：svn, version-control

工作中的颠覆存储库是在对其结构没有太多规划的情况下建立的。目前没有配置明确的标签、主干或分支，尽管通过使用 subclipse:tags 存在一些标签元数据

当前存储库的格式为：

> /核心代码A
> 
> /核心代码B
> 
> /项目1
> 
> /项目2

最近，一位新开发人员开始使用我们内部应用程序的“版本 2”，并将其放在不同的文件夹下：

> /new/NewCoreA
> 
> /新/NewCoreB
> 
> /新/项目3
> 
> /新/项目4

这些项目都依赖于核心代码的各个部分，以及类似的项目（例如，几个项目可能依赖于同一个主题）。这些依赖关系在一些基于文本的项目属性文件的内容中被引用。

我一直在使用 svndumpfilter 命令，通过 sed 管道输出并将其重组为两个单独的存储库（“旧”和“新”）。很容易做到，我现在有两个不同的存储库，设置了主干、标签和分支（子剪辑标记信息可以在以后重新解析）。

我担心的是，通过在每次提交上摆弄颠覆结构，我正在破坏以前工作的构建，特别是考虑到对其他项目的依赖。另一方面，我需要尽快在这个代码库中添加标签和分支。但是，如果我在几个月后改变主意，我也不想强迫开发人员重新检查他们的项目。

我想我对每个存储库的选择是：

1.  用“重组前”标签标记存储库，按照我想要的方式重组存储库，用“重组后”标记。
    *   好：不会破坏历史建筑
    *   不好：有效地将未来的工作与过去的工作断开，不容易发布 xx1 补丁
2.  重构整个存储库，打破以前的构建
    *   好：保持代码的历史连续性
    *   不好：以前的版本已损坏，如果再次需要，肯定需要 xx1 补丁版本
3.  重构整个存储库并在每个阶段编辑项目属性文件
    *   好：代码的连续性得到维护，项目应该构建
    *   坏：编辑文件的实际内容比简单地更改有关其位置的元数据要脆弱得多

前两个选择很容易做到 - 但我希望其他开发人员在现实世界 20 到 20 年后对他们在类似情况下所做的事情以及错误或正确的事情进行后见之明。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T08:40:25.707

存储库布局（更改）更多的是关于您的开发组织，而不是任何技术。在不知道代码量、重组后代码需要更改的数量以及从事代码工作的人数的情况下，很难推荐任何具体的东西，但我会先让所有受影响的人参与进来，然后将 1-2 天的时间用于 repo 大修 - 代码冻结，只允许修复以使代码可构建。最后，每个人都会快乐很多。试图做这个卧底可能会让你发现一个流氓开发者仍在你的 SVN 服务器的某个黑暗角落里做他/她自己的分支。

而且我不会太担心访问历史代码布局。您始终可以在 /oldlayoutdonottouchthiswithoutrealneed 之类的内容下标记当前布局，并将其留在那里以修补旧版本。对于这样的技巧，SVN 是一个非常棒的工具。

PS 我从未使用过 subclipse，但看起来 subclipse 标签与按书本上的 SVN 标签有很大不同。他们似乎更喜欢 CVS 标签。确保你在那里没有混淆。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T15:58:05.497

我不会碰历史。那时情况很糟糕，如果你想再次回到那里，你将不得不付出代价。

当然，你可能“知道”你会经常重温过去，那么使用#3 并通过所有重要点的新 .1 版本来完成整个 repo 可能是有意义的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T10:03:23.123

有什么方法可以让构建属性文件反映相对路径而不是硬编码路径？

假设您的任务涉及将主文件夹组织成标签、分支和主干，我认为子文件夹/文件（至少在一定程度上）将保留它们的相对位置？

如果我是你，我会考虑修复我的属性文件以变得更通用并且独立于绝对路径..

希望这会有所帮助.. 干杯！

# sql - SQL Sever TSQL 脚本如何判断它具有哪些安全权限？

> ID：503666
> 
> 赞同：5
> 
> 时间：2009-02-02T15:48:14.970
> 
> 标签：sql, sql-server, security, tsql

我有一个 TSQL 脚本，用于在我的产品安装过程中设置数据库。它需要许多步骤，总共需要五分钟左右。有时此脚本在最后一步会失败，因为运行该脚本的用户对数据库没有足够的权限。在这种情况下，我希望脚本失败。为此，我希望脚本预先测试它具有哪些权限。如果脚本以特定的安全权限运行，任何人都可以指出一种通用的测试方式吗？

**编辑：**在特定情况下，我正在查看它正在尝试进行备份，但我遇到了其他问题，并希望有一个通用的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T16:40:05.210

```
select * from fn_my_permissions(NULL, 'SERVER') 
```

这为您提供了当前会话在服务器上的权限列表

```
select * from fn_my_permissions(NULL, 'DATABASE') 
```

这为您提供了当前数据库上当前会话的权限列表。

[请参阅此处了解更多信息](http://msdn.microsoft.com/en-us/library/ms176097%28SQL.90%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T15:53:15.540

我认为在一系列选择之后更新或插入失败。

只需尝试*简单*的更新或在事务中插入。对行 ID 进行硬编码，或者任何使其简单快速的内容。

不要提交事务——而是回滚它。

如果您无权进行插入或更新，这应该会失败。如果您这样做，它将回滚并且不会导致永久更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T16:35:30.540

尝试使用某些 where 条件预先插入/更新最后一个

```
insert/update
where 1=2

if (@@error <> 0)
   raise error 6666 'no permissions' 
```

这不会造成任何伤害，但会提前表明缺乏权利。

# sql - 替换 SQL 查询中的多个字符串

> ID：503673
> 
> 赞同：12
> 
> 时间：2009-02-02T15:50:21.783
> 
> 标签：sql, sql-server, tsql

我正在 SQL Server 中编写一个 SQL 查询，其中我需要用单个字符串值替换多个字符串值。例如

```
Product     Quantity
-------     --------
Apple       2
Orange      3
Banana      1
Vegetable   7
Dairy       6 
```

会成为

```
Product     Quantity
-------     --------
Fruit       2
Fruit       3
Fruit       1
Vegetable   7
Dairy       6 
```

我知道如何做到这一点的唯一方法是在 SELECT 子句中使用嵌套的 REPLACE。

```
SELECT
  REPLACE('Banana', REPLACE('Orange', REPLACE('Banana', Product, 'Fruit'),
           'Fruit'), 'Fruit') AS Product
FROM
  Table 
```

有没有更简单的方法？

编辑：产品类别中可能还有其他值。请参阅上面的编辑示例。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-02T16:16:13.853

到目前为止，BradC 有最好的答案，但如果您由于某种原因无法创建附加表，我想发布对 Kibbee 答案的改编：

```
SELECT
    CASE WHEN Product IN ('Banana', 'Apple', 'Orange') Then 'Fruit'
    ELSE Product END 
FROM [Table] 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-02T15:55:18.343

制作一个新的“类别”表，其中包含您的产品列表以及它们所属的“类别”。

然后做一个内部连接。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-02T15:53:59.967

```
Select
Case Product WHEN 'Banana' Then 'Fruit'
WHEN 'Apple' Then 'Fruit'
WHEN 'Orange' Then 'Fruit'
ELSE Product
END
FROM Table 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T15:53:08.223

如果除了提到的产品之外没有其他产品，您可以这样做：

```
SELECT 'Fruit' AS Product,
        Quantity
FROM Table 
```

如果有其他产品只需添加 WHERE 子句

```
WHERE Product IN ('Banana', 'Orange', 'Apple') 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T15:57:17.543

您可以创建一个带有单列“产品”列的临时表，并插入所有要替换的产品名称。

然后对目标表进行内部连接以进行更新。

```
UPDATE
    Table
SET Product = 'Fruit'
FROM
    Table t1 INNER JOIN #Table t2 on t1.Product = t2.Product 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T16:16:40.233

从长远来看，创建“类别”表的建议将是您的最佳选择。

例如，请查看此链接： [数据属于您的表格 - 不在您的代码中](http://weblogs.sqlteam.com/jeffs/archive/2006/02/10/9002.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-23T12:25:01.987

用单引号分隔 SQL 中的文本：

```
CASE WHEN ShiptoPlant IN (';','/',' ') Then '' ELSE ShipToPlant END 
```

# sql - MS SQL 2005 比较包含方括号的字段

> ID：503680
> 
> 赞同：1
> 
> 时间：2009-02-02T15:52:35.743
> 
> 标签：sql, sql-server, sql-server-2005

我正在使用 MS SQL Server 2005 (9.0.4035) 并尝试在 nvarchar(4000) 字段中查找包含相同数据的行。该字段包含具有左方括号和右方括号的 xml。

这是示例数据：
DataID Data
1 1
2 1
3 2]
4 2]
5 3[
6 3[

使用“like”运算符，我希望得到 3 个匹配对，但我的问题是第 5 行和第 6 行不匹配，我只返回第 1 行和第 2 行匹配，第 3 行和第 4 行匹配。

我知道 MS SQL 2005 在查询中添加了正则表达式支持，但我没想到它们会将字段数据评估为正则表达式，我认为它正在这样做。是否需要启用某种模式才能获得正确的结果？

任何帮助表示赞赏，
瑞恩

**编辑：**添加了使用的 sql 语句：

Select t1.DataID, t2.DataID From TestTable t1, TestTable t2
where t1.DataID <> t2.DataID
and t1.Data like t2.Data

**编辑：**回答
使用 '=' 运算符有效，但转义 '[' 无效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T16:17:27.067

将查询更改为使用 = 而不是 LIKE，您将获得预期的结果。SQL 2005 T-SQL 不会执行正则表达式——您需要为此使用 CLR 函数——但 LIKE 语句会执行模式匹配。'[' 和 ']' 保留用于类似语句中的模式匹配，如果您打算让它们成为相等匹配，则必须将它们转义。

有关 LIKE 语句的信息，请参阅[http://msdn.microsoft.com/en-us/library/ms179859.aspx](http://msdn.microsoft.com/en-us/library/ms179859.aspx)。

以下两个查询中的任何一个都解决了我的测试中的问题...

```
--using equals operator...
Select t1.DataID, t2.DataID From TestTable t1, TestTable t2
Where t1.DataID <> t2.DataID
and t1.Data = t2.Data

--using replace to add an escape character.
Select t1.DataID, t2.DataID From TestTable t1, TestTable t2
Where t1.DataID <> t2.DataID
and t1.Data like REPLACE(t2.Data, '[', '\[') escape '\' 
```

# ruby-on-rails - Ruby on Rails 的可扩展性/性能？

> ID：503684
> 
> 赞同：71
> 
> 时间：2009-02-02T15:53:17.160
> 
> 标签：ruby-on-rails, ruby, scalability

我已经使用 PHP 有一段时间了，并且已经很好地将它与 CodeIgniter 一起使用，这是一个很棒的框架。我正在开始一个新的个人项目，上次我在考虑使用什么（PHP 与 ROR）我使用 PHP，因为我听说 ROR 存在可伸缩性问题，尤其是在阅读了 Twitter 开发人员对此的评价之后。可扩展性在 ROR 中是否仍然是一个问题，或者是否已经对其进行了改进？

我想学习一门新语言，ROR 似乎很有趣。PHP 完成了工作，但众所周知，它的语法和组织结构很糟糕，感觉就像一个大黑客。

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2009-02-02T20:14:08.460

为了扩展 Ryan Doherty 的答案......

我在日常工作中使用静态类型语言（.NET/C#），同时将 Ruby 作为副业。在我目前的日常工作之前，我是一家 Ruby 开发公司的首席程序员，为 New York Times Syndication 服务工作。在此之前，我也在 PHP 中工作过（虽然很久很久以前）。

我这么说只是为了这样说：我亲身经历过 Rails（以及更普遍的 ruby​​）性能问题，以及其他一些替代方案。正如 Ryan 所说，你不会让它自动为你扩展。找到你的瓶颈需要工作和极大的耐心。

我们从其他人甚至我们自己那里看到的大部分性能问题都是处理我们的 ORM 层中执行缓慢的查询。我们从 Rails/ActiveRecord 到 Rails/DataMapper，最后到 Merb/DM，每次迭代都因为底层框架而变得更快。

缓存为性能创造了惊人的奇迹。不幸的是，我们无法缓存我们的数据。我们的缓存最多每五分钟就会有效地失效。我们网站的几乎每一点都是动态的。因此，如果/当您无法做到这一点时，也许您可​​以从我们的经验中学习。

我们最终不得不认真地微调我们的数据库索引，确保我们的查询没有做非常愚蠢的事情，确保我们执行的查询没有超出绝对必要的数量，等等。当我说“非常愚蠢的事情”时，我表示 1 + N 查询问题...

```
#1 query
Dog.find(:all).each do |dog|
   #N queries
   dog.owner.siblings.each do |sibling|
      #N queries per above N query!!
      sibling.pets.each do |pet|
         #Do something here
      end
   end
end 
```

DataMapper 是处理上述问题的好方法（它*没有 1 + N 问题*），但更好的方法是动用你的大脑并停止做这样的查询：D 当你需要原始性能时，大多数 ORM图层不会轻易处理非常自定义的查询，因此您不妨手写它们。

我们也做了常识性的事情。我们为我们不断增长的数据库购买了一个强大的服务器，并将它移到它自己的专用盒子上。我们还必须不断进行大量的处理和数据导入。我们也将我们的处理转移到*它*自己的盒子上。我们还停止为我们的数据导入实用程序加载整个该死的堆栈。我们只加载了我们绝对需要的内容（从而减少了内存开销！）。

如果你还不能说...一般来说，当涉及到 ruby​​/rails/merb 时，你必须*向外*扩展，将硬件扔到问题上。但归根结底，硬件很便宜；虽然这不是伪劣代码的借口！:D

即使有这些困难，如果我能提供帮助，我个人永远不会在另一个框架中启动项目。我爱上了这种语言，并且每天都在不断地了解它。这是我从 C# 中得不到的东西，尽管 C# 更快。

我也喜欢开源工具，开始使用该语言的低成本，从那里得到一些东西并尝试看看它是否有市场的低成本，同时使用一种通常可以优雅和美丽的语言工作...

最后，在选择框架时，一切都取决于您日复一日地生活、呼吸、饮食和睡眠。如果您喜欢 Microsoft 的思维方式，请选择 .NET。如果您想要开源但仍然想要结构，请尝试 Java。如果您想拥有一种动态语言并且仍然具有比 ruby​​ 更多的结构，请尝试使用 python。如果你想要优雅，试试 Ruby（我小子，我小子......还有许多其他优雅的语言符合要求。不要试图引发一场激烈的战争：D）

见鬼，都试试吧！我倾向于同意上面的答案，即早期担心优化并不是你应该或不应该选择框架的原因，但我不同意这是他们唯一的答案。

所以简而言之，是的，你必须克服一些困难，但是语言的优雅，恕我直言，远远超过了这些缺点。

很抱歉这本小说，但我一直因为性能问题而反复出现。它是*可以*克服的。所以不要让这把你吓跑。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-02-02T16:07:39.770

RoR 被用于许多大型网站，但与*任何*语言或框架一样，它需要良好的架构（数据库扩展、缓存、调整等）才能扩展到大量用户。

RoR 进行了一些小的更改，使其更易于扩展，但不要指望它会为您神奇地扩展。每个网站都有不同的扩展问题，因此您必须投入一些工作才能使其扩展。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-02T16:17:37.627

开发能够为您的项目带来最大成功机会的技术——快速开发、易于调试、易于部署、良好的工具、您对它了如指掌（除非重点是学习一门新语言）等。

如果您每月获得数以千万计的独特性，您可以随时雇用几个人并在需要时用不同的技术重写...

......你会在*缓存中**耙*- ing （对不起 - 无法抗拒！）

 ** * *

## 回答 #4

> 赞同：14
> 
> 时间：2011-07-18T09:05:31.797

首先，将 Rails 与 Symfony、CodeIgniter 或 CakePHP 进行比较可能更有意义，因为 Ruby on Rails 是一个完整的 Web 应用程序框架。与 PHP 或 PHP 框架相比，Rails 应用程序具有体积小、干净且易读的优点。PHP 非常适合小型个人页面（最初它代表“个人主页”），而 Rails 是一个完整的 MVC 框架，可用于构建大型站点。

Ruby on Rails**没有**比同类 PHP 框架更大的可扩展性问题。如果您只有中等数量的用户（10,000-100,000）操作类似数量的对象，Rails 和 PHP 都可以很好地扩展。对于几千个用户来说，一个经典的单体架构就足够了。通过一点 M&M（Memcached 和 MySQL），您还可以处理数百万个对象。M&M 架构使用 MySQL 服务器处理写入，使用 Memcached 处理高读取负载。传统的存储模式，即使用规范化关系表（或充其量是 SQL Master/Multiple Read Slave 设置）的单个 SQL 服务器，不再适用于非常大的站点。

如果你有数十亿用户，比如谷歌、Twitter 和 Facebook，那么分布式架构可能会更好。如果您真的想无限制地扩展您的应用程序，请使用某种廉价的商品硬件作为基础，将您的应用程序划分为一组服务，保持每个组件或服务本身可扩展（将每个组件设计为可扩展的服务），并适应您的应用程序的架构。然后，您将需要合适的可扩展数据存储，如 NoSQL 数据库和分布式哈希表 (DHT)，您将需要复杂的 map-reduce 算法来处理它们，您将不得不处理 SOA、外部服务和消息传递。PHP 和 Rails 都没有提供灵丹妙药。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-02T16:01:20.077

使用 RoR 的原因在于，除非您进入 Alexa 的前 100 名，否则您不会遇到任何可扩展性问题。除非您可以挤出 Phusion、Passenger 或 Mongrel，否则您将在共享主机上遇到更多稳定性问题。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-02T20:02:56.953

花点时间看看 Twitter 人员必须处理的问题，然后问问自己，您的应用程序是否需要扩展到该级别。

然后无论如何都要在 Rails 中构建它，因为你知道它是有意义的。如果您达到 Twitter 级别的音量，那么您将乐于考虑性能优化选项。至少你会用一种很好的语言来应用它们！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-06-17T14:20:28.717

你不能比较 PHP 和 ROR，PHP 是一种脚本语言，如 Ruby，Rails 是一个框架，如 CakePHP。
说，我强烈建议您使用 Rails，因为您将拥有一个严格**按照 MVC 模式组织**的应用程序，这对于您的可伸缩性要求是**必须的。**（使用 PHP 您必须自己处理项目组织）。
但是关于可扩展性，Rails 不仅仅是 MVC：例如，您可以开始使用数据库开发您的应用程序，在路上毫不费力地更改它（在大多数情况下），因此我们可以声明 Rails 应用程序（几乎）是**数据库独立**的，因为它是 ORM（允许您避免数据库查询），您可以做很多其他的事情。
（看看这个视频[http://www.youtube.com/watch?v=p5EIrSM8dCA](http://www.youtube.com/watch?v=p5EIrSM8dCA)）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-02-16T10:45:41.500

只是想在 Keith Hanson 关于 1 + N 问题的聪明点中添加更多信息，他说：

> DataMapper 是处理上述问题的好方法（它没有 1 + N 问题），但更好的方法是动用你的大脑并停止做这样的查询：D 当你需要原始性能时，大多数 ORM图层不会轻易处理非常自定义的查询，因此您不妨手写它们。

Doctrine 是 PHP 最流行的 ORM 之一。它通过提供一种称为 Doctrine Query Language (DQL) 的语言来解决 ORM 固有的 1 + N 复杂性问题。这允许您编写使用现有模型关系的类似 SQL 的语句。例如

> $q = Doctrine_Query::Create() ->select(*) ->from(ModelA m) ->leftJoin(m.ModelB) ->execute()

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-06-24T21:39:48.220

我从这个线程中得到的印象是，ROR 的可伸缩性问题主要归结为 ORM 在加载子对象方面的混乱——即上面提到的“1+N”问题。在上面瑞恩给狗和主人的例子中：

```
Dog.find(:all).each do |dog|
   #N queries
   dog.owner.siblings.each do |sibling|
      #N queries per above N query!!
      sibling.pets.each do |pet|
         #Do something here
      end
   end
end 
```

您实际上可以编写一条 sql 语句来获取所有这些数据，并且您还可以将这些数据“缝合”到您自定义编写的对象的 Dog.Owner.Siblings.Pets 对象层次结构中。但是有人可以编写一个自动执行此操作的 ORM，以便上面的示例会导致到数据库的一次往返和一个 SQL 语句，而不是可能的数百个？完全。只需将这些表连接到一个数据集中，然后执行一些逻辑将其拼接起来。使该逻辑具有通用性有点棘手，因此它可以处理任何对象集，但不能处理世界末日。最后，表和对象仅在三个类别之一（1:1、1:many、many:many）中相互关联。只是没有人构建过那个 ORM。

您需要一种语法来预先告诉系统您要为此*特定加载哪些子级*询问。您可以通过“急切”加载 LinqToSql (C#) 来做到这一点，这不是 ROR 的一部分，但即使这会导致到数据库的一次往返，它仍然是数百个单独的 SQL 语句。目前已经成立。它实际上更多地是关于 ORM 的历史。他们只是开始走上错误的道路，并且在我看来从未真正恢复过。“延迟加载”是大多数 ORM 的默认行为，即每次提及子对象都会引发另一次往返，这很疯狂。然后使用“急切”加载 - 预先加载孩子，这是在我知道的 LinqToSql 之外的所有内容中静态设置的 - 即哪些孩子总是加载某些对象 - 就好像你在加载集合时总是需要加载相同的孩子的狗。

您需要某种强类型语法来说明这次我要加载这些子孙。即，类似：

```
Dog.Owners.Include()
Dog.Owners.Siblings.Include()
Dog.Owners.Siblings.Pets.Include() 
```

那么你可以发出这个命令：

```
Dog.find(:all).each do |dog| 
```

ORM 系统会知道它需要连接哪些表，然后将结果数据拼接到 OM 层次结构中。确实，您可以在当前问题上抛出硬件，我通常赞成，但没有理由不应该更好地编写 ORM（即 Hibernate、Entity Framework、Ruby ActiveRecord）。硬件确实不能让您摆脱 8 次往返、100 条 SQL 语句的查询，而这本来应该是一次往返和一条 SQL 语句。

# matlab - 有没有办法在matlab的单元格模式下调用子函数？

> ID：503689
> 
> 赞同：9
> 
> 时间：2009-02-02T15:54:24.147
> 
> 标签：matlab

假设我有以下代码：

```
% Cellmode_subfunction_test.m
%% Cell 1
foo(1);

%% Cell 2
foo(2);

%% Definition of the foo subfunction
function foo(num)
disp(['num=' num2str(num)]); 
```

如何使用最后定义的子功能测试单元格 1 和单元格 2？

编辑：基本上这个例子中的每个单元格都会执行一些冗长的计算，所以我想分别测试和调试它们。我正在使用子函数来抽象和重用通用功能，因为到目前为止这个功能只在这个特定的应用程序中使用，我真的不想将 foo 放在单独的 m 文件中。

编辑（2）：我只记得我隐约记得单元模式仅在 matlab 脚本中工作，而不在函数 m 文件中工作，并且在此类脚本中不允许子函数和嵌套函数。因此，我所要求的可能是不可能的。

尽管下面给出的匿名函数解决方案可能有些限制，因为它只允许单个表达式函数，但实际上它确实足以满足我的愿望，因此我已经接受它作为我的问题的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-02T16:02:36.283

更正：

我误解了你对 CELL 这个词的使用。我很抱歉。看来您只是想在命令行定义一个函数而不将其保存到 .m 文件中。为此，您可以使用匿名函数：

```
foo = @(num) disp(['num=' num2str(num)]); 
```

然后你可以像使用任何其他函数一样使用“foo”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T13:34:29.920

我通常处理的方式是在主函数内部的某处使用 dbstop。然后您可以访问主函数通常可以访问的所有功能。如果您正在使用 ML 编辑器，只需在第一次调用 foo 时使用断点。

希望能帮助到你。

担

# jquery - 用击键触发超链接

> ID：503691
> 
> 赞同：0
> 
> 时间：2009-02-02T15:55:17.500
> 
> 标签：jquery, html

我想通过使用 jQuery 按 Enter 来触发超链接。我有以下 html，但 Enter-stroke 所做的只是触发警报，它不会导航到链接。但是，单击该链接会导航到新地址。我错过了什么？

我知道我的测试函数正在运行，因为 addClass/removeClass 函数正在运行。

```
<html>
<head>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            $("a").click(function(event){
                alert(this.href);
            });
        });
        function test(event){
            if (event.keyCode == 13) {
                $("a").addClass("test");
                $("a.one").trigger('click');
            }
            else {
                $("a").removeClass("test");}
        }
    </script>
    <style type="text/css">
        a.test { font-weight: bold; }
    </style>
</head>
<body onkeypress='test(event)'>
    <a class="one" href="http://jquery.com/">jQuery</a>
    <br/>
    <a class="two" href="http://stackoverflow.com/">stack overflow</a>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T16:09:48.547

添加一个 window.location = this.href; 到您的点击功能。那应该行得通。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T16:11:29.357

那么，您想触发点击还是简单地重新定位？链接本质上是重定位的，但是当您触发 onclick 到其他事件时，它只会执行绑定功能。

我建议你把这个任务分成以下几个部分来保持你的代码更干净：1）单独的函数来执行所需的操作，包括使用 window.location.href="yournewurl" （或者一些带有 jquery 插件的高级东西，比如这个[http： //www.oakcitygraphics.com/jquery/jqURL/jqURLdemo.html](http://www.oakcitygraphics.com/jquery/jqURL/jqURLdemo.html) )。2）在需要的事件上调用这个函数，比如 onclick 等。

或者只是在 if (event.keyCode == 13) { ... } 块中强制定位。

# iphone - iPhone：响应用户事件

> ID：503706
> 
> 赞同：0
> 
> 时间：2009-02-02T15:58:57.803
> 
> 标签：iphone

iPhone开发者新手问题：

当用户停止收听 iPhone 上的曲目（即按下停止按钮）时，我希望让我的应用程序执行操作。是否可以挂钩这类事件（播放/暂停/停止等）？如果是这样，我会使用哪个 API？

问候，安迪。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T16:03:07.827

不，真的没有办法做到这一点。据我所知，没有办法告诉轨道已经停止，但即使你的应用程序在“停止”指令时也必须在前台，因为没有后台应用程序（Apple 除外） .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T17:40:06.540

Perhaps KVO would provide the behavior you need.

[Key-Value Observing Programming Guide (requires ADC login)](http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html)

# silverlight - 下载卫星/地图图像（来自谷歌地图或实时地图？）

> ID：503711
> 
> 赞同：0
> 
> 时间：2009-02-02T15:59:49.160
> 
> 标签：silverlight, google-maps, deepzoom

我正在构建一个小游戏项目，我想在 deepzoom 中使用一个城镇的卫星图像，获得它们的最简单方法是什么？我敢肯定有比 PrtScn 更好的方法，我试过谷歌地图下载器，但它不下载卫星图像，而且它的公司似乎不再提供它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T16:39:28.270

Microsoft Virtual Earth 具有可在应用程序中使用的基于 SOAP 和 AJAX 的服务。该服务有一个暂存和生产版本。使用 Staging 版本是免费的，可以轻松满足“游戏项目”的需求。生产版本需要花钱，并且可以为具有许多用户的大型应用程序提供信息。

[http://dev.live.com/VirtualEarth/](http://dev.live.com/VirtualEarth/)

但是，使用 Staging sdk 需要进行一些注册。您可以从这里开始：http: [//msdn.microsoft.com/en-us/library/cc980844.aspx](http://msdn.microsoft.com/en-us/library/cc980844.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T22:01:30.380

看看地球深处，除非你想要建造的是地球深处给你的东西——在这种情况下，它可能会消除所有的乐趣；）

[http://www.codeplex.com/deepearth](http://www.codeplex.com/deepearth)

如果你想走自己的路，那么过去你可以直接从托管它们的 MS Virtual Earth 服务器手动请求各种图像图块，如果你可以计算[四键](http://msdn.microsoft.com/en-us/library/bb259689.aspx)并构建正确的 URL，从而绕过它们支付模式。虽然我知道他们正在寻求消除这个循环漏洞，但这肯定是早期版本的 Deep Earth 所做的。

# javascript - 为什么 toPrecision 返回一个字符串？

> ID：503716
> 
> 赞同：2
> 
> 时间：2009-02-02T16:00:21.407
> 
> 标签：javascript, floating-point, types, numbers

查看此代码：

```
function testprecision(){
    var isNotNumber = parseFloat('1.3').toPrecision(6);
    alert(typeof isNotNumber); //=> string
} 
```

我会期待一个数字。如果 'isNotNumber' 应该是一个实数，重铸是解决方案：

```
alert(typeof parseFloat(isNotNumber)) //=> number 
```

[编辑] 感谢您的回答。我得出的结论是，精度并不是那么精确。它可以表示一个数字的*总位数*，也可以表示*小数位数*。荷兰（我来自哪里）的大多数人都以“小数位数”的方式考虑精度。javascript toPrecision 方法涉及第一个表示，所以这很混乱。无论如何，该方法可以引入“错误精度”，对吗？对于我们必须固定的第二个含义，同样如此（返回字符串，错误精度的可能性）。

无论如何，在将重新发明轮子作为我的主要爱好后，我使用我在这里收集的知识来构建一个 javascript 浮动对象。也许它对外面的人有用，或者你们中的一个人有更好的想法？

```
function Float(f,nDec) {
  var Base = this,val;
  setPrecision( nDec || 2 );      
  set( f || 0, nDec || Base.precision );
  Base.set    = set;
  Base.ndec   = setPrecision;
  /** public setprecision 
   *  sets a value for the number of fractional
   *  digits (decimals) you would like getf to 
   *  return. NB: can't be more than 20.
   *  Returns the Float object, so allows method 
   *  chaining
   *  @param {Number} iPrecision
   */
  function setPrecision(iPrecision) {
      var ix = parseInt(iPrecision,10) || 2;
       Base.precision = ix >= 21 ? 20 : ix;
       return Base;
  }
  /** public set
   *  sets the 'internal' value of the object. Returns
   *  the Float object, so allows method chaining
   *  @param {Number} f
   *  @param {Number} ndec
   */
  function set(f,ndec) {
       val =  parseFloat(f) || 0;
       if (ndec) { setPrecision(ndec); }
       Base.val = val;
       return Base;
  }
  /** public get: 
   * return number value (as a float)
   */
  Base.get = function(){
      var ndec = Math.pow(10,Base.precision),
          ival = parseInt(val*ndec,10)/ndec;
      Base.val = ival;
      return Base.val;
  };
  /** public getf 
   *  returns formatted string with precision
   *  (see Base.setPrecision)
   *  if [hx] is supplied, it returns
   *  the float as hexadecimal, otherwise
   *  @param {Boolean} hx
   */
  Base.getf = function(hx){
      var v = Base.val.toFixed(Base.precision);
      return hx ? v.toString(16) : v;
  };
  /** public add
   * adds [f] to the current value (if [f] is a
   * Float, otherwise returns current value)
   * optionally sets a new number of decimals
   * from parameter [ndec]
   * @param {Number} f
   * @param {Number} ndec
   */
  Base.add = function(f,ndec){
      if ( parseFloat(f) || val===0) {
           set(Base.val+parseFloat(f));
           if (ndec) { setPrecision(ndec);}
      }
     return Base.get();
  };
  /** toString 
   *  returns the internal value of the Float object
   *  functions like a getter (supposedly)
   */
  Base.toString = Base.get;
} 
```

用法/示例：

```
var xf = new Float(); //=> value now 0.0
xf.set(0.86/0.8765,17).add(3.459);
alert(xf+'|'+xf.getf()); //=> 4.440175128351398|4.44017512835139800 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-02T16:04:37.777

来自文档：“将表示 Number 对象的字符串返回到指定的精度。”

toPrecision() 似乎用于格式化输出，在这种情况下，字符串是最合理的结果。它以不会被进一步操作破坏的形式表示最终输出。

如果您出于计算原因想要截断一些精度，我倾向于乘以 10^n，其中 n 是我想要保留的数字，从中取一个整数，然后再除以相同的数字。不过这并不完美：在某些情况下，您可能会导致溢出。坦率地说，我更喜欢在服务器上进行更复杂的财务计算，我有货币、二进制编码的十进制或类似的数字类型。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-02T16:08:05.307

假设你有一个像“1.6”这样的数字。如果将其格式化为右侧有 6 个零，您将得到“1.600000”。对计算机来说，它仍然是与 1.6 相同的数字，但对您和您的网站而言，如果您的所有数字的长度不同（例如，这可能会损害解析器），它就不一样了。

因此，为了避免这种情况，toPrecision 返回一个字符串，否则解释器将重新格式化该数字以再次变为“1.6”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-12-11T09:09:15.803

的目的是将 a 的有效*十进制*数字`toPrecision`截断为指定的数量。但是 s 的内部表示的数据类型是*二进制*IEEE-754 double。因此，在大多数情况下，**不可能**存储*精确*的返回值。由于这种不精确性，返回值将具有无限数量的十进制数字，这将导致无效。*`Number``Number`****`Number``toPrecision`*****

 *****所以这个问题唯一合理的解决方案是返回十进制数字。目前，十进制数字唯一合理的 JS 数据类型是字符串。

* * *

`Number`如果用于十进制数字，这里有一个示例来说明 s 的不精确性：

```
// the following looks like something with 2 decimal digits:
var number = 1.6;

// but in fact it's a number with an infinite amount of decimal digits.
// let's look at the first 30 of them:
alert(number.toPrecision(30));

// 1.60000000000000008881784197001 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-02T16:03:45.423

因为它是一个格式化函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T16:07:11.953

您需要一个用于尾随零的字符串。货币显示就是一个很好的例子。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T16:20:46.543

问题是使用`toPrecision`. 不试一试。

```
var isNotNumber = parseFloat('1.3');
alert(typeof isNotNumber); //=> number 
```

# c# - 使用来自 C# 的托管 C++ dll

> ID：503718
> 
> 赞同：5
> 
> 时间：2009-02-02T16:01:07.957
> 
> 标签：c#, .net, c++, managed

我使用托管 C++ 创建了一个 dll。现在我正在尝试从 C# 中使用它。我已将对象添加到项目引用中。对象浏览器正确显示dll中的对象，对象浏览器中dll的路径与实际路径相对应。

但是，当我运行 C# 程序时，它会抱怨：

> 未处理的异常：System.IO.FileNotFoundException：找不到指定的模块。（来自 HRESULT 的异常：0x8007007E）

知道还需要做什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T16:02:49.717

我认为您的托管 C++ 程序集缺少其他程序集或 dll 的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T16:04:45.670

您的托管 C++ 程序集是否有其他依赖项，包括非托管 dll？如果您引用的程序集未能加载依赖项，您将在运行时看到此错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T16:07:34.713

您是否在未安装 VS 的机器上运行发布版本的应用程序？

我只是问，因为我在这里遇到了类似的问题：[混合模式库和 CRT 依赖项 - 帮助](https://stackoverflow.com/questions/230715/mixed-mode-library-and-crt-dependencies-help)

如果您向下滚动到我的答案，您会看到我所做的对我有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-17T12:08:04.503

检查 c++ 程序集是否存在于与 c# 程序相同的文件夹中。如果“Copy Local”属性设置为 true（在您的 c# 应用程序中对 c++ dll 的引用），它应该被自动复制。

如果存在 c++ dll，最可能的问题是 c++ dll 依赖于另一个无法找到的非托管 dll（即 c# 不会将这些复制到您的应用程序文件夹，因为它不知道非托管引用）。您可以在 c++ dll 上使用[DependencyWalker](http://www.dependencywalker.com)来检查缺少的依赖项。

另一个可能的原因可能是您的 MSVC 运行时 dll 有问题。查看 DependencyWalker 是否抱怨缺少 MSVCR*.dll、MSVCP*.dll 等...文件。

# performance - 如何更改第三方组件的 WCF 绑定？

> ID：503719
> 
> 赞同：0
> 
> 时间：2009-02-02T16:01:19.063
> 
> 标签：performance, wcf, wcf-binding

我有一个使用 WCF 构建的第三方应用程序。它作为 Windows 服务安装，**`wsHttpBinding`**并且**`basicHttpBinding`**默认支持。

有没有办法切换到更优化的绑定，例如**`tcpBinding`**or **`named pipes`**？

我将在同一服务器中使用该服务，因此可以选择命名管道。

我想知道我是否可以通过修改windows服务的.config文件在第三方上做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T16:11:15.563

如果您提到的 WCF 服务器服务使用“.config”文件进行初始化，那么应该可以修改行为（这就是使用配置文件的重点：您可以修改参数而无需重新编译代码）。

尝试添加新的绑定配置并修改端点的“绑定”和“绑定配置”属性以指向新的。

在客户端配置中，设置相同的绑定类型，或者如果您配置了 metadataExchange，请更新服务引用并查看客户端的配置是否已更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T03:09:09.690

您只需要在 app.config 中为服务提供一个新的绑定配置，该配置的契约属性与您希望以不同方式托管的类型相匹配。这会创建一个单独的服务主机，它可能对组件/服务很重要，也可能无关紧要。合同属性是这里的关键，因为这是 WCF 将如何确定要使用的绑定/端点配置。“WCF ABC = 地址、绑定、合同”，指定这三个，您应该启动并运行。

还可以通过引用 Web 应用程序项目中的必要程序集，然后创建标识适当基类的必要 .svc 文件，将 Windows 服务 WCF 服务作为 IIS WCF 服务托管。

# java - Java中的泛型，使用通配符

> ID：503721
> 
> 赞同：4
> 
> 时间：2009-02-02T16:01:33.180
> 
> 标签：java, generics, bounded-wildcard

我有一个关于 Java 中的泛型的问题，即使用通配符。我有一个像这样的示例类 GenClass：

```
public class GenClass<E> {

    private E var;

    public void setVar(E x) {
        var = x;
    }

    public E getVar() {
        return var;
    }
} 
```

我有另一个简单的类：

```
public class ExampleClass {

} 
```

我编写了以下测试类：

```
public class TestGenClass {

    public static void main(String[] str) {

        ExampleClass ec = new ExampleClass();

        GenClass<ExampleClass> c = new GenClass<ExampleClass>();

        c.setVar(ec);
        System.out.println(c.getVar());  // OUTPUT: ExampleClass@addbf1
    }

} 
```

现在，如果我使用通配符并在测试类中这样写：

```
GenClass<?> c = new GenClass<ExampleClass>(); 
```

在：

```
GenClass<ExampleClass> c = new GenClass<ExampleClass>(); 
```

编译器对这个新语句没有问题，但是，它抱怨

```
c.setVar(ec); 
```

它说“方法（setVar（））不适用于参数（ExampleClass）”。为什么我会收到此消息？

我认为我使用通配符的方式使引用变量 c 的类型为 GenClass，它可以接受任何类作为参数 - 在 EI 的位置上会有任何类。这只是变量的声明。然后我用它初始化它

```
new GenClass<ExampleClass>() 
```

这意味着我创建了一个 GenClass 类型的对象，它有一个 ExampleClass 类型的类作为参数。所以，我认为现在 GenClass 中的 E 将是 ExampleClass，并且我将能够使用方法 setVar()，将其作为参数类型为 ExampleClass。这是我的假设和理解，但Java似乎不喜欢它，我也不对。任何评论表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-02T16:12:47.730

[Java 泛型教程](http://java.sun.com/docs/books/tutorial/extra/generics/wildcards.html)中涵盖了这种确切情况。

> 请注意，[使用通配符]，我们仍然可以从 [通用`Collection`] 中读取元素并赋予它们 type `Object`。这总是安全的，因为无论集合的实际类型是什么，它都包含对象。但是，向其中添加任意对象是不安全的：

```
Collection<?> c = new ArrayList<String>();
c.add(new Object()); // Compile time error 
```

> 因为我们不知道元素类型`c`代表什么，所以我们不能向它添加对象。该`add()`方法接受 type 的参数`E`，即集合的元素类型。当实际类型参数为`?`时，它代表某种未知类型。**我们传递给的任何参数`add`都必须是这种未知类型的子类型。因为我们不知道那是什么类型，所以我们不能传入任何东西。**唯一的例外是`null`，它是每个类型的成员。

（强调我的）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T16:30:51.687

mmyers 有正确的答案，但我只是想评论您问题的这一部分（这听起来像是您想要使用通配符的理由）：

> 我认为我使用通配符的方式使引用变量 c 的类型为 GenClass，它可以接受任何类作为参数 - 在 EI 的位置上会有任何类。这只是变量的声明。然后我用它初始化它

如果你真的想做到这一点，你可以做一些没有编译错误的事情：

```
GenClass<Object> gc = new GenClass<Object>();
gc.setVar(new ExampleClass()); 
```

但是话又说回来，如果你想声明一个`GenClass`可以包含任何类型的实例，我不确定你为什么要使用泛型——你可以只使用原始类：

```
GenClass raw = new GenClass();
raw.setVar(new ExampleClass());
raw.setVar("this runs ok"); 
```

# xml - 如何最好地更新 MSBuild 中的 XML 节点

> ID：503730
> 
> 赞同：5
> 
> 时间：2009-02-02T16:03:53.723
> 
> 标签：xml, msbuild, web-config, msbuildcommunitytasks

我一直在使用 Tigris 社区任务来使用 XMLUpdate 任务更新各种 AppSettings 键。

但是，现在我想向 system.net 部分添加一个节点来设置代理。

我声明了一个属性

```
<PropertyGroup>
    <proxy>&lt;defaultProxy&gt; &lt;proxy usesystemdefault="False" proxyaddress="http://IPADDRESS:PORT" /&gt; &lt;/defaultProxy&gt;</proxy>
  </PropertyGroup> 
```

XMLUpdate 任务看起来像

```
<XmlUpdate
 Prefix="n"
 Namespace="http://schemas.microsoft.com/.NetConfiguration/v2.0"
 XmlFileName="$(BuildDir)\Builds\_PublishedWebsites\Presentation\Web.config"
 XPath="/n:configuration/n:system.net"
 Value="$(proxy)"  /> 
```

这会更新 Web 配置，但它会直接从属性组更新，即不会转换尖括号的转义字符。有没有人有任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-03T07:07:46.083

您可以使用 XmlMassUpdate 代替 XmlUpdate 任务。

```
<ProjectExtensions>
  <defaultProxy>
    <proxy usesystemdefault="False" proxyaddress="http://IPADDRESS:PORT"/>
  </defaultProxy>
</ProjectExtensions>

<Target Name="SubstituteFromWebConfig">
  <XmlMassUpdate 
    NamespaceDefinitions="msb=http://schemas.microsoft.com/developer/msbuild/2003;n=http://schemas.microsoft.com/.NetConfiguration/v2.0"
    ContentFile="$(BuildDir)\Builds\_PublishedWebsites\Presentation\Web.config" 
    ContentRoot="/n:configuration/n:system.net"
    SubstitutionsFile="$(MSBuildProjectFullPath)"
    SubstitutionsRoot="/msb:Project/msb:ProjectExtensions/msb:system.web" />
</Target> 
```

在此示例中，我们将*ContentFile*中的*ContentRoot指向的节点替换为**SubstitutionsFile*中的*SubstitutionsRoot*指向的节点（当前的 MSBuild 文件）。

 ***此技术利用**MSBuild ProjectExtensions 元素**，该元素允许您**将 XML 添加到****将被 MSBuild 引擎忽略**的项目文件中。

（或者，如果您不想使用 XmlMassUpdate，您可以在 ProjectExtensions 和 XmlUpdate 中的节点上使用 XmlRead 任务。）

# c# - List.Contains(item) 带有通用对象列表

> ID：503734
> 
> 赞同：13
> 
> 时间：2009-02-02T16:05:01.427
> 
> 标签：c#

如果您有一个列表，如果存在指定的属性或属性集合，您如何返回该项目？

```
public class Testing
{
    public string value1 { get; set; }
    public string value2 { get; set; }
    public int value3 { get; set; }
}
public class TestingList
{
    public void TestingNewList()
    {
        var testList = new List<Testing>
                           {
                               new Testing {value1 = "Value1 - 1", value2 = "Value2 - 1", value3 = 3},
                               new Testing {value1 = "Value1 - 2", value2 = "Value2 - 2", value3 = 2},
                               new Testing {value1 = "Value1 - 3", value2 = "Value2 - 3", value3 = 3},
                               new Testing {value1 = "Value1 - 4", value2 = "Value2 - 4", value3 = 4},
                               new Testing {value1 = "Value1 - 5", value2 = "Value2 - 5", value3 = 5},
                               new Testing {value1 = "Value1 - 6", value2 = "Value2 - 6", value3 = 6},
                               new Testing {value1 = "Value1 - 7", value2 = "Value2 - 7", value3 = 7}
                           };

        //use testList.Contains to see if value3 = 3
        //use testList.Contains to see if value3 = 2 and value1 = "Value1 - 2"

    }
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-02T16:11:28.077

你可以使用

```
testList.Exists(x=>x.value3 == 3) 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-02T16:10:04.037

如果您使用的是 .NET 3.5 或更高版本，LINQ 就是这个问题的答案：

```
testList.Where(t => t.value3 == 3);
testList.Where(t => t.value3 == 2 && t.value1 == "Value1 - 2"); 
```

如果不使用 .NET 3.5，那么您可以循环并选择您想要的。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-02T16:10:33.273

查看类的[`Find`](http://msdn.microsoft.com/en-us/library/x0b5b5bc.aspx)or[`FindAll`](http://msdn.microsoft.com/en-us/library/x0b5b5bc.aspx)方法[`List<T>`](http://msdn.microsoft.com/en-us/library/x0b5b5bc.aspx)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-02T16:11:53.207

如果要使用类的相等实现，可以使用[`Contains`](http://msdn.microsoft.com/en-us/library/bb919166.aspx)方法。根据您定义相等性的方式（默认情况下它将是引用的，这不会有任何帮助），您可能能够运行其中一个测试。您还可以为[`IEqualityComparer<T>`](http://msdn.microsoft.com/en-us/library/ms132151.aspx)要执行的每个测试创建多个 s。

或者，对于不仅仅依赖于类的相等性的测试，您可以使用该[`Exists`](http://msdn.microsoft.com/en-us/library/bfed8bca.aspx)方法并传入一个委托进行测试（或者[`Find`](http://msdn.microsoft.com/en-us/library/x0b5b5bc.aspx)如果您想要对匹配实例的引用）。

例如，您可以`Testing`像这样在类中定义相等：

```
public class Testing: IEquatable<Testing>
{
    // getters, setters, other code
    ...

    public bool Equals(Testing other)
    {
        return other != null && other.value3 == this.value3;
    }
} 
```

然后，您将使用以下代码测试列表是否包含 value3 == 3 的项目：

```
Testing testValue = new Testing();
testValue.value3 = 3;
return testList.Contains(testValue); 
```

要使用 Exists，您可以执行以下操作（首先使用委托，其次使用 lambda）：

```
return testList.Exists(delegate(testValue) { return testValue.value3 == 3 });

return testList.Exists(testValue => testValue.value3 == 2 && testValue.value1 == "Value1 - 2"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T16:13:01.223

LINQ 查询可能是编写此代码的最简单方法。

```
Testing result = (from t in testList where t.value3 == 3 select t).FirstOrDefault(); 
```

# vba - 单击框时突出显示和取消突出显示特定范围

> ID：503739
> 
> 赞同：1
> 
> 时间：2009-02-02T16:06:05.543
> 
> 标签：vba, automation, excel

我是视觉基础的初学者。我想要做的是每当单击一个框时，突出显示一个特定范围。然后，如果在此之后单击另一个框，则先前的范围将取消突出显示，而另一个范围将突出显示。这是我的代码，但它现在不起作用。

```
Dim FSelect As Boolean
Dim myRange As Range

Sub Rectangle18_Click()

   If FSelect Then
        UnhighlightBox (myRange) <---error - runtime error "424" object required
   End If

   Range("C9:D9").Select
   HighlightBox

   FSelect = True

   Set myRange = Range("C9:D9")
   End Sub

Sub Rectangle19_Click()

   If FSelect Then
        UnhighlightBox (myRange)
   End If

   Range("C11:D11").Select
   HighlightBox

   FSelect = True

   Set myRange = Range("C11:D11")

End Sub    

Sub HighlightBox()
   Selection.Interior.ColorIndex = 36
End Sub

Sub UnhighlightBox(cellRng As Range)
   cellRng.Interior.ColorIndex = 2
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T01:06:57.213

Putting the parentheses around the argument when calling the UnhighlightBox procedure is incorrect.

Two possible correct forms:

`UnhighlightBox myRange`

`Call UnhighlightBox(myRange)`

I find the first form (without the `Call` keyword) to be preferable

For the Excel 2003 help:

> You are not required to use the Call keyword when calling a procedure. However, if you use the Call keyword to call a procedure that requires arguments, argumentlist must be enclosed in parentheses. If you omit the Call keyword, you also must omit the parentheses around argumentlist.

Please note that this does not apply to a function which returns a value. A function needs to be called as part of an assignment (e.g. `a = f(x)`) and the arguments must be enclosed in parentheses

Your use of the `FSelect` boolean (which initialises to false) should be preventing the problem with calling `UnhighlightBox` before `myRange` is ever set.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T16:46:52.747

当我将此代码放入 excel 时，它会抱怨 Select。我认为您不能将 Select 用作​​变量...

编辑： Select 是 VB/A 中的保留关键字，它开始 Select Case 块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T18:16:28.820

使用 UnhighlightBox 例程时，您要么需要将 Call 语句放在手边，要么删除括号。

例如：

```
Call UnhighlightBox (myRange) 
```

或者

```
UnhighlightBox myRange 
```

有关为什么使用 Call 等的更多信息，请参阅以下任一内容：

[什么是呼叫关键字在 vb6 中做什么](https://stackoverflow.com/questions/479891/what-does-the-call-keyword-do-in-vb6)

[MSDN](http://msdn.microsoft.com/en-us/library/wcx04ck5(VS.85).aspx)

# com - 如何强制进程外 COM 服务器的进程隔离？

> ID：503740
> 
> 赞同：0
> 
> 时间：2009-02-02T16:06:10.503
> 
> 标签：com, interop, automation, legacy

我正在编写托管代码，该代码必须与供应商的 COM 自动化服务器进行交互，但该服务器已耗尽进程。我发现如果有多个客户端连接到该服务器，它就会变得不稳定。例如，如果我在进程 A 中的托管代码和进程 B 中的托管代码都连接到此 COM 服务器，则将为 COM 服务器启动一个进程，并且它的行为不太可靠。 **我希望有一种方法可以为每个客户端-服务器连接强制一个单独的进程**。理想情况下，我想结束：

托管进程 A 与进程**C1**
中的 COM 服务器通信 托管进程 B 与进程**C2中的 COM 服务器通信**

我想到的一个想法是，如果我以不同的安全身份运行进程 A 和进程 B，那可能会导致 COM 基础架构创建单独的服务器进程。然而，我宁愿不走那条路。托管进程 A 和托管进程 B 实际上是 Windows 服务。而且我正在使用身份本地系统运行它们（因为我需要它们能够与桌面交互，并且您无法检查服务小程序上的“与桌面交互”框以获取不作为本地运行的服务系统）。而我需要与桌面交互的原因是这个COM服务器偶尔会在屏幕上抛出一个对话框，如果服务本身不能与桌面交互，那么COM服务器生成的不能显示对话框（我相信它是显示在隐藏的 WinStation 上）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T17:13:08.653

放置在 COM+ 注册的组件，这会在您的位置放置一个隔离层。
使用：控制面板->管理工具
或 cmd/执行 DCOMCNFG

组件服务->计算机->我的电脑->COM+应用程序，右键，新建应用程序，下一步，创建一个空应用程序，输入应用名称“COM+ your.dll”，下一步，选择本地服务，下一步，下一步，下一步，完成.

在新项目中，展开，在组件，右键单击，新组件，下一步，选择安装新组件，选择您的组件。

单击组件属性，选项卡身份，选择系统帐户。

有关调用中的错误，请参阅事件之后。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T16:25:28.920

我已经有一段时间没有这样做了，所以我的记忆很模糊。

如果使用 DCOM config 工具将 OOP COM 服务器配置为 DCOM 服务器，相信可以指定隔离级别。几年前，我使用了一个非线程安全的进程内 DLL，需要从 IIS 以线程安全的方式访问它，它很有魅力。

请让我知道这对你有没有用 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T16:25:53.913

您最好的选择是让供应商修复组件。毕竟，如果它不能处理多个客户端，可能还会潜伏其他*错误。*如果你不能做到这一点，还有其他一些事情可以尝试。

对于进程内 COM 对象，我有时需要手动加载 dll 并直接访问接口，而无需通过 COM。

我自己没有使用进程外 COM 完成此操作，但您可以尝试一些事情。最终，库只是一个坐在那里接收调用函数的消息的进程。

您也许可以为每个客户端手动启动流程的新副本，然后向其发送消息。你可能会遇到一些麻烦。例如，进程可能会检查它是否已经在运行并拒绝启动或不满意。

如果您知道客户端数量的上限，您可以考虑的另一种方法是制作原始 .exe 文件的多个副本，然后使用二进制补丁（类似于 Microsoft Research 的 detours 库）来覆盖 COM注册函数并将每个副本注册为单独的 COM 对象。

# svn - 如何使用 TortoiseSVN 从源代码管理中删除文件夹？

> ID：503743
> 
> 赞同：133
> 
> 时间：2009-02-02T16:07:00.800
> 
> 标签：svn, version-control, tortoisesvn

如何从[TortoiseSVN](http://en.wikipedia.org/wiki/TortoiseSVN)的源代码控制中删除文件夹？

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2009-02-02T16:59:15.657

这里描述了最简单的方法：http: [//tortoisesvn.net/unversion.html](http://tortoisesvn.net/unversion.html)

那篇文章有点罗嗦，有些方法对我不起作用（比如将文件夹拖到自身上——Windows 7 不允许这样做））。

以下是文章中对我有用的内容：

> 简单：当您**右键单击**工作副本并从上下文菜单中选择“**导出**...”时，将显示一个文件夹浏览对话框，您可以在其中选择要将工作副本导出到的文件夹。如果您现在**选择工作副本所在的路径** 作为目标（即，您将工作副本导出到自身），TortoiseSVN 将删除该工作副本的所有 .svn 文件夹。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2010-08-05T13:35:07.313

扩展上下文菜单中有一个专门的项目：

*   按住`Shift`键并右键单击该文件夹。
*   在 TortoiseSVN 菜单下点击“删除（保持本地）”

![在此处输入图像描述](https://i.stack.imgur.com/yDETm.png)

图片来自[TortoiseSVN 的扩展上下文菜单](http://tortoisesvn.net/extendedcontextmenu.html)页面。
[删除（保留本地）](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-rename.html#tsvn-dug-rename-delete)文档简介。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-02T16:17:09.063

如果您想从源代码管理中删除该文件夹但将其保留在本地，最简单的方法是

1.  创建文件夹的备份（只需将其复制到其他地方）
2.  按照说明删除它
3.  恢复文件夹
4.  告诉颠覆“忽略”文件夹

您还应该删除`.svn`正在删除的文件夹中的目录，否则您最终会混淆 svn/tortoise。您还可以为第 1 步执行“导出”，这将为`.svn`您删除任何目录（如果您要为整个目录树而不是单个目录执行此操作，这比手动清理文件夹要方便得多） .

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-02T16:16:13.137

TortoiseSVN 菜单有一个导出选项，它将为您提供与存储库分离的文件夹的副本。或者，您可以右键单击 + 拖动文件夹，然后选择“SVN 导出到此处”或“SVN 全部导出到此处”。

“全部导出”相当于在“导出”对话框中选择“也导出未版本控制的文件”，这将有效地克隆没有 .svn 文件夹的工作副本。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-02T16:09:12.043

您右键单击目录，转到**TortoiseSVN** -> **Delete**。然后右键单击父目录和**SVN 提交...**，这将删除该文件夹。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-08-30T14:09:49.497

删除要从版本控制中删除的文件夹中的 .svn 文件夹。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-07-10T02:55:57.700

Windows 搜索，设置系统和隐藏文件标志...文件名“.svn”...搜索后 - 排序以便所有 .svn 目录组合在一起...突出显示 - 点击删除 :)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-04-11T16:07:24.420

我运行了乌龟命令“更新到 SVN 1.7”，它将所有 .svn 文件夹合并到一个文件夹中。然后我可以只删除一个 .svn 文件夹，一切顺利！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-05-14T10:17:21.767

我看到有三种简单的方法可以使用 TortoiseSVN 取消验证并保留文件（或目录）**的本地版本：**

1.  [在Stefan 所写](https://stackoverflow.com/a/503919/971443)的相同路径上导出；
2.  “删除（保持本地）”功能使用 Shift 键作为[bob esponja 的答案](https://stackoverflow.com/a/3415184/971443)访问；
3.  [取消版本并添加到](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-howto-unversion.html)我用这个答案报告的忽略列表选项

我发现后一种方法是三种方法中最简单的，而第一种方法（投票最多）在执行操作方面最长。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-09-13T23:07:07.863

这对我有用：

1.  右键单击要删除的文件夹/分支并使用 TortoiseSNV->Delete
2.  执行清理。我是从命令行执行此操作的`svn cleanup <path to the folder to delete including folder name>`；否则，您可以右键单击该文件夹并执行清理。
3.  转到要删除的文件夹的父目录并提交更改。

这应该从您的工作目录和 Subversion 中删除该文件夹。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-08-27T17:31:57.377

在选择“将未版本化的文件导出到”选项时将文件夹导出到新位置对我来说非常有用。TortoiseSVN 删除了所有 Subversion 特定的设置，你得到一个干净的文件夹。现在您可以删除原始文件夹并将新导出的文件夹移到那里。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-10-05T22:36:06.700

有时我会遇到来自 Subversion 的工作副本文件夹，我知道这些文件夹在版本控制下需要更长的时间。我想“解压”它们。通常我会在所有与 .svn 相关的文件夹上进行某种查找和删除，但如果您安装了 TortoiseSVN，则有一种更简单的方法。

您应该熟悉“导出”命令。这将在没有所有那些讨厌的 .svn 文件夹的新位置复制文件。如果您想“取消版本”某些内容但不想要副本 - 只需执行“导出”，当 Tortoise 要求“要导出到的文件夹”时，只需选择您的工作副本所在的文件夹即可！Tortoise 将继续删除所有 .svn 文件夹。

引用：[http ://thecrumb.com/2008/09/25/removing-svn-files-with-tortoisesvn/](http://thecrumb.com/2008/09/25/removing-svn-files-with-tortoisesvn/)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2013-07-25T12:36:41.330

右键单击工作副本并从上下文菜单中选择“导出...”。显示文件夹浏览对话框。

您必须选择与工作副本所在的路径相同的路径作为目标。TortoiseSVN 会询问您是否要删除该工作副本的所有 .svn 文件夹。只是说是！

# perl - 如何获取创建 Perl 子例程引用的文件和行号？

> ID：503769
> 
> 赞同：10
> 
> 时间：2009-02-02T16:14:40.597
> 
> 标签：perl

给定子程序引用，有没有办法找出声明子程序的文件和行号？警告和朋友似乎做对了，但我在外部需要这个。这是我的测试程序：

```
#!/usr/bin/perl -l

use strict;
use warnings;
use B;

# line 99 'bin/some_code.pl'
{
    no strict 'refs';
    print B::svref_2object(\*{'Foo::some_sub'})->LINE;
    print B::svref_2object(\&Foo::some_sub)->GV->LINE;
}
Foo::some_sub();

package Foo;
# line 23 'bin/some_file.pl'
sub some_sub {
    warn "Got to here";
} 
```

输出：

```
102
102
Got to here at 'bin/some_file.pl' line 24. 
```

行信息不是我所期望的，所以我假设我做错了什么（B::GV 有一个相应的 FILE 方法，但在我让 LINE 工作之前，它对我来说没有多大用处）。

还有其他方法可以获取此信息吗？我在上面的代码中做错了吗？

*更新*：事实证明，如果我不使用 line 指令，'FILE' 和 'LINE' 方法似乎可以正常工作。看起来这可能是 B::GV 模块中的错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T16:26:08.390

你可以试试看[`caller`](http://perldoc.perl.org/functions/caller.html)。这是调试器用来构建堆栈跟踪的内容，所以也许这就是您想要的。

我不认为`__LINE__`，`__FILE__`并且`__PACKAGE__`在这里帮助您，因为它们仅提供*当前*执行点的位置，这意味着给定代码引用或子代码，您将获得相同的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T09:39:44.713

您已经在做其中的一些，但也请参阅[Perlmonks](http://www.perlmonks.org)线程[“跟踪匿名 coderef 的文件名/行号”](http://www.perlmonks.org/?node_id=413725)。

# powershell - PowerShell：如何从 SnapIn 以编程方式安装驱动器

> ID：503774
> 
> 赞同：1
> 
> 时间：2009-02-02T16:16:07.647
> 
> 标签：powershell, snap-in

我正在 C# 中创建一套自定义 cmdlet 和提供程序。我还有一个 PowerShell 管理单元，负责注册 cmdlet 和提供程序。我已经导出了一个控制台会话，以便我可以使用 -PSConsoleFile 参数启动 PowerShell 以自动加载我的管理单元。

我还想在使用管理单元运行 PS 时安装驱动器。实际上，我希望在 PS 会话开始时运行以下命令：

new-psdrive -name [驱动器名] -psprovider FileSystem -root [本地文件系统上文件夹的路径]

我尝试将上述命令放在 .ps1 文件中，并使用 -command 和 .ps1 文件的路径启动 PS，同时指定 -NoExit 标志。该脚本确实运行，但驱动器未在后续会话中映射。

有没有一种简单的方法可以在 snap in 中创建一个新的 psdrive？我还研究了从 FileSystemProvider 派生，但它是密封的。我研究了以编程方式运行 NewPSDriveCommand ，但似乎不受支持。

我在这里错过了一些简单的东西吗？

谢谢！

编辑：我忘了提到如果可能的话我不想使用配置文件来完成这个。我想将这个管理单元分发给其他人，我希望他们不必编辑他们的配置文件来让一切正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T17:54:17.870

您可以在管理单元中创建 PSDrive。作为提供程序的一部分，您可以覆盖一个方法[InitializeDefaultDrives 。](http://msdn.microsoft.com/en-us/library/system.management.automation.provider.drivecmdletprovider.initializedefaultdrives(VS.85).aspx)

例子：

```
protected override Collection<PSDriveInfo> InitializeDefaultDrives()
        {
            Collection<PSDriveInfo> drives = new Collection<PSDriveInfo>();

            drives.Add(new PSDriveInfo(
                "YourDriveName",
                ProviderInfo,
                "YourDriveRoot",
                "Description of Your Drive",
                null));

            return drives;
        } 
```

重新阅读您的问题和评论后：您也许可以从 Microsoft.PowerShell.Core 命名空间中获取对文件系统 providerinfo 对象的引用...虽然我还没有测试过...

来自 PowerShell 的文件系统提供程序信息是：

```
PS C:\scripts\PowerShell> Get-PSProvider filesystem | fl *

ImplementingType : Microsoft.PowerShell.Commands.FileSystemProvider
HelpFile         : System.Management.Automation.dll-Help.xml
Name             : FileSystem
PSSnapIn         : Microsoft.PowerShell.Core
ModuleName       : Microsoft.PowerShell.Core
Module           :
Description      :
Capabilities     : Filter, ShouldProcess
Home             : H:\
Drives           : {C, A, D, H...} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T16:35:58.823

您可以尝试将语句添加到您的 Powershell 全局或环境配置文件中。两者都位于 %username%\My Documents\WindowsPowerShell。您的全局配置文件名为 profile.ps1，您的环境配置文件为每个 shell 命名（Microsoft.PowerShell_profile.ps1 用于默认 Powershell 环境）。

我的 profile.ps1 文件中有几个 new-psdrive 语句。这种方法的缺点是等待 Powershell 连接所有这些 PSDrive（如果它们位于慢速服务器上）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T08:57:56.237

您可以将命令放在 ps1 文件中并添加选项 -scope Global。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-16T07:21:47.997

您是在谈论创建一个 : 函数，以便您可以像使用 c: 这样的文件系统驱动器一样切换到该驱动器？

我在 NewDrive 方法的末尾有以下代码。

```
// create the <drive>: alias
string func = string.Format("function {0}: {{ set-location {0}: }}", drive.Name);
this.InvokeCommand.InvokeScript(
       func
       , false
       , System.Management.Automation.Runspaces.PipelineResultTypes.None
       , null
       , null); 
```

然后在 RemoveDrive 方法中进行匹配的删除调用，以删除匹配的函数。

```
string func = string.Format("function {0}: {{ remove-item function:\ {0}: }}"
       , drive.Name);
this.InvokeCommand.InvokeScript(
       func
       , false
       , System.Management.Automation.Runspaces.PipelineResultTypes.None
       , null
       , null); 
```

# sql - 复杂的 SQL 查询（至少对我来说）

> ID：503781
> 
> 赞同：3
> 
> 时间：2009-02-02T16:18:07.907
> 
> 标签：sql

我正在尝试开发一个将返回序列号列表的 sql 查询。该表设置为每当序列号到达一个步骤时，输入日期和时间。当它完成该步骤时，将输入另一个日期和时间。我想开发一个查询，它将为我提供已进入步骤但未退出步骤的序列号列表。他们可能多次进入，所以我只寻找没有出口的序列号，然后进入。

例（为方便使用，将表格称为“Table1”）

```
 1\. Serial | Step  | Date

 2\. 1      | enter | 10/1
 3\. 1      | exit  | 10/2
 4\. 1      | enter | 10/4
 5\. 2      | enter | 10/4
 6\. 3      | enter | 10/5
 7\. 3      | exit  | 10/6 
```

对于上表，应检索序列号 1 和 2，但不应检索序列号 3。

这可以在带有子查询的信号查询中完成吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T16:26:11.447

```
select * from Table1 
group by Step 
having count(*) % 2 = 1 
```

这是当不能有两个“输入”但每个输入后跟一个“退出”时（如提供的示例中所示）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T16:36:31.473

就我个人而言，我认为最好通过改变数据的存储方式来做到这一点。当前的方法不可能是有效的或有效的。是的，您可以四处寻找方法来获取数据。但是，当您输入了多个步骤而同一个序列号没有退出时会发生什么？是的，它不应该发生，但迟早会发生，除非您编写了代码来防止它（代码可能会变得复杂编写）。有一个表将进入和退出存储在同一记录中会更干净。然后查询（并且更快）以找到那些进入但未退出的人变得微不足道。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T16:24:04.773

这将为您提供所有没有结尾“退出”的“进入”记录。如果您只需要序列号列表，则还应按序列号分组并仅选择该列。

```
SELECT t1.* 
FROM Table1 t1
LEFT JOIN Table1 t2 ON t2.Serial=t1.Serial 
    AND t2.Step='Exit' AND t2.[Date] >= t1.[Date]
WHERE t1.Step='Enter' AND t2.Serial IS NULL 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T13:07:07.930

我在 MySQL 中对此进行了测试。

```
SELECT Serial, 
  COUNT(NULLIF(Step,'enter')) AS exits, 
  COUNT(NULLIF(Step,'exit')) AS enters 
FROM Table1
  WHERE Step IN ('enter','exit')
GROUP BY Serial
HAVING enters <> exits 
```

我不确定 Date 在这里的重要性，但可以轻松修改以上内容以纳入日内或跨日要求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T16:23:29.643

```
SELECT DISTINCT Serial
FROM Table t
WHERE (SELECT COUNT(*) FROM Table t2 WHERE t.Serial = t2.Serial AND Step = 'exit') <
      (SELECT COUNT(*) FROM Table t2 WHERE t.Serial = t2.Serial AND Step = 'enter') 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-02T16:26:22.930

```
SELECT * FROM Table1 T1
WHERE NOT EXISTS (
  SELECT * FROM Table1 T2   
  WHERE T2.Serial = T1.Serial 
    AND T2.Step = 'exit'
    AND T2.Date > T1.Date
) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T17:29:14.940

Several people have suggested rearranging your data, but I don't see any examples, so I'll take a crack at it. This is a partially-denormalized variant of the same table you've described. It should work well with a limited number of "steps" (this example only takes into account "enter" and "exit", but it could be easily expanded), but its greatest weakness is that adding additional steps after populating the table (say, enter/process/exit) is expensive — you have to `ALTER TABLE` to do so.

```
serial  enter_date  exit_date
------  ----------  ---------
     1        10/1       10/2
     1        10/4       NULL
     2        10/4       NULL
     3        10/5       10/6 
```

Your query then becomes quite simple:

```
SELECT serial,enter_date FROM table1 WHERE exit_date IS NULL;

serial  enter_date
------  ----------
     1        10/4
     2        10/4 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-02T18:09:24.280

这是一个应该适用于您的场景的简单查询

```
SELECT Serial FROM Table1 t1
WHERE Step='enter' 
AND (SELECT Max(Date) FROM Table1 t2 WHERE t2.Serial = t1.Serial) = t1.Date 
```

我已经对此进行了测试，这将为您提供序列号为 1 和 2 的行

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-02T17:06:58.120

在甲骨文中：

```
SELECT *
FROM (
 SELECT serial,
 CASE
   WHEN so < 0 THEN "Stack overflow"
   WHEN depth > 0 THEN "In"
   ELSE "Out"
 END AS stack
 FROM (
  SELECT serial, MIN(SUM(DECODE(step, "enter", 1, "exit", -1) OVER (PARTITION BY serial ORDER BY date)) AS so, SUM(DECODE(step, "enter", 1, "exit", -1)) AS depth
  FROM Table 1
  GROUP BY serial
 )
)
WHERE stack = "Out" 
```

这将选择您想要的**并**过滤掉`exits`没有发生的事情`enters`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-02T16:25:36.363

如果您确定您不需要匹配的输入和退出值，您可以查找“输入”计数不等于“退出”计数的所有序列值.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-02T16:32:25.193

如果您使用的是 MS SQL 2005 或 2008，您可以使用 CTE 来获得您正在寻找的结果...

```
WITH ExitCTE
AS
    (SELECT Serial, StepDate
    FROM    #Table1
    WHERE   Step = 'exit')
SELECT  A.*
FROM    #Table1 A LEFT JOIN ExitCTE B ON A.Serial = B.Serial AND B.StepDate > A.StepDate
WHERE   A.Step = 'enter'
        AND B.Serial IS NULL 
```

如果您不使用这些，我会尝试使用子查询...

```
SELECT  A.*
FROM    #Table1 A LEFT JOIN (SELECT Serial, StepDate
                            FROM    #Table1
                            WHERE   Step = 'exit') B 
            ON A.Serial = B.Serial AND B.StepDate > A.StepDate
WHERE   A.Step = 'enter'
        AND B.Serial IS NULL 
```

# c# - 单元测试 XML 生成

> ID：503784
> 
> 赞同：34
> 
> 时间：2009-02-02T16:19:33.457
> 
> 标签：c#, xml, unit-testing, nunit

人们推荐的用于测试 xml 的单元测试策略是正确生成的。

我目前的测试似乎有点原始，类似于：

```
[Test]
public void pseudo_test()
{
   XmlDocument myDOC = new XmlDocument();
   mydoc = _task.MyMethodToMakeXMLDoc();

   Assert.AreEqual(myDoc.OuterXML(),"big string of XML")
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-02T18:05:19.483

首先，几乎每个人都在说，验证 XML 是否定义了模式。（如果没有，定义一个。）

但是您可以通过对文档执行 XPath 查询来构建更精细的测试，例如：

```
string xml="Your xml string here" ;
XmlDocument doc = new XmlDocument();
doc.LoadXml(xml);
path = "/doc/element1[@id='key1']/element2[. = 'value2']";
Assert.IsTrue(doc.SelectSingleNode(path) != null); 
```

这不仅可以让您测试您的文档在语义上是否有效，还可以测试生成它的方法是否使用您期望的值填充它。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-02T16:31:38.707

[XMLUnit](http://xmlunit.sourceforge.net/)可以帮助你。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-22T18:45:53.283

[Fluent Assertions](http://www.fluentassertions.com/)是一个优秀的库，用于以流畅、易于阅读的风格表达测试断言。它适用于所有主要的单元测试框架。

它还具有一些有用的 XML 功能（全部取自[此处](https://github.com/dennisdoomen/fluentassertions/wiki#xml-classes)的示例），例如：

```
xElementA.Should().Be(xElementB);

xDocument.Should().HaveRoot("configuration");
xDocument.Should().HaveElement("settings");

xElement.Should().HaveAttribute("age", "36");
xElement.Should().HaveElement("address");

xAttribute.Should().HaveValue("Amsterdam"); 
```

请注意，这适用于 LINQ-To-XML 而不是原始问题中指定的 XmlDocument 对象，但这些天我个人发现我使用 LINQ-To-XML 作为首选。

如果您想添加更多 XML 断言以满足您的需要，它也很容易扩展。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-02T16:28:12.583

另一种可能性可能是使用 XmlReader 并检查错误计数 > 0。像这样：

```
 void CheckXml()
    {
        string _xmlFile = "this.xml";
        string _xsdFile = "schema.xsd"; 
        StringCollection _xmlErrors = new StringCollection();

        XmlReader reader = null;
        XmlReaderSettings settings = new XmlReaderSettings();
        settings.ValidationEventHandler += new ValidationEventHandler(this.ValidationEventHandler);
        settings.ValidationType = ValidationType.Schema;
        settings.IgnoreComments = chkIgnoreComments.Checked;
        settings.IgnoreProcessingInstructions = chkIgnoreProcessingInstructions.Checked;
        settings.IgnoreWhitespace = chkIgnoreWhiteSpace.Checked;
        settings.Schemas.Add(null, XmlReader.Create(_xsdFile));
        reader = XmlReader.Create(_xmlFile, settings);
        while (reader.Read())
        {
        }
        reader.Close();
        Assert.AreEqual(_xmlErrors.Count,0);
    }    

    void ValidationEventHandler(object sender, ValidationEventArgs args)
    {
        _xmlErrors.Add("<" + args.Severity + "> " + args.Message);
    } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-02T16:31:29.003

针对 XML 模式或 DTD 进行验证，同时检查节点是否具有您期望的值。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-02T16:29:51.347

如果您有一个您期望输出的标准格式，为什么不创建一个 XML 模式或 DTD 并针对它进行验证。这将不依赖于数据，因此将是灵活的。在设计系统时，定义 XML 的形成方式也很有帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-01T18:53:46.453

[marianor 的这篇博客文章](http://weblogs.asp.net/marianor/archive/2009/01/02/easy-way-to-compare-two-xmls-for-equality.aspx)提供了一种比较 XElement 结构的轻量级方法，因此我将在处理[XMLUnit](http://xmlunit.sourceforge.net/)之前尝试一下。

> 首先要做的是规范化这两个 XMLs...使用 Linq... 在两个元素都被规范化之后，您可以简单地比较两个字符串。

XML 通过对元素和属性名称进行排序来规范化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-02T17:41:55.350

Validate it against an XSD schema using XmlSchema class. Its found under System.XML i think. Another option would be to write a serialization class (XMLSerializer) to deserialize your XML into an object. The gain will be that it will implicitly validate your structure and after that the values can be easily accessed for testing using the resulting object.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-02T18:33:21.893

使用 Schema 进行验证的另一个原因是，虽然 XML 节点是明确排序的，但 XML 属性不是。

所以你的字符串比较：

```
Assert.AreEqual(myDoc.OuterXML(),"big string of XML") 
```

如果属性的顺序不同，则会失败，如果手动创建一个 XML 而另一个以编程方式创建，则很容易发生这种情况。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-02T16:26:44.923

为什么不假设某些商业 xml 解析器是正确的并针对它验证您的 xml 代码呢？就像是。

```
Assert.IsTrue(myDoc.Xml.ParseOK) 
```

除此之外，如果你想彻底，我会说你必须自己构建一个解析器并验证 xml 规范要求的每条规则。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-09-12T14:40:39.890

我计划使用这个新的[Approval Testing](http://approvaltests.sourceforge.net/)库来帮助进行 XML 测试。

它看起来非常适合这项工作，但请先自己阅读，因为我没有使用它的经验。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-06-30T15:49:04.323

验证生成的文档格式正确 验证生成的文档是否有效 验证生成的文档是否正确。

据推测，您正在使用有用的数据制作 XML 文档，因此您需要确保为测试提供正确的输入覆盖范围。我看到的最常见的问题是

*   错误转义的元素
*   错误转义的属性
*   错误转义的元素名称
*   错误转义的属性名称

因此，如果您还没有这样做，则需要查看 XML 规范以了解每个地方允许的内容。

每次测试应该进行多少“检查”并不清楚。我想，这在很大程度上取决于您的问题空间中的单元。每个单元测试都检查一条数据是否在 XML 中正确表达似乎是合理的。在这种情况下，我同意 Robert 的观点，即最好简单检查一下您是否在单个 XPath 位置找到了正确的数据。

对于较大的自动化测试，您想要检查整个文档，我发现有效的是有一个预期结果，它也是一个文档，并逐个节点遍历它，使用 XPath 表达式找到相应的节点在实际文档中，然后应用两个节点中编码的数据的正确比较。

使用这种方法，您通常希望一次捕获所有故障，而不是在第一次故障时中止，因此您可能需要对如何跟踪不匹配发生的位置进行处理。

通过更多的工作，您可以识别出某些元素类型被排除在测试之外（如时间戳），或者验证它们是指向等效节点的指针，或者......您想要的任何类型的自定义验证。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-06-04T14:38:41.090

您可以使用 DTD 检查生成的 xml 的有效性。

为了测试正确的内容，我会选择[XMLUnit](http://www.xmlunit.org)。

使用 XMLUnit 断言 xml：

```
XMLUnit.setIgnoreWhitespace(true);
XMLUnit.setIgnoreDiffBetweenTextAndCDATA(true);

Diff diff = new Diff(expectedDocument, obtainedDocument);
XMLAssert.assertXMLIdentical("xml invalid", diff, true); 
```

您可能会遇到的一件事是生成的 xml 可能包含不断变化的标识符（id/uid 属性等）。这可以通过在断言生成的 xml 时使用[DifferenceListener来解决。](http://www.xmlunit.org/api/java/master/org/custommonkey/xmlunit/DifferenceListener.html)

这种DifferenceListener的示例实现：

```
public class IgnoreVariableAttributesDifferenceListener implements DifferenceListener {

    private final List<String> IGNORE_ATTRS;
    private final boolean ignoreAttributeOrder;

    public IgnoreVariableAttributesDifferenceListener(List<String> attributesToIgnore, boolean ignoreAttributeOrder) {
        this.IGNORE_ATTRS = attributesToIgnore;
        this.ignoreAttributeOrder = ignoreAttributeOrder;
    }

    @Override
    public int differenceFound(Difference difference) {
        // for attribute value differences, check for ignored attributes
        if (difference.getId() == DifferenceConstants.ATTR_VALUE_ID) {
            if (IGNORE_ATTRS.contains(difference.getControlNodeDetail().getNode().getNodeName())) {
                return RETURN_IGNORE_DIFFERENCE_NODES_IDENTICAL;
            }
        }
        // attribute order mismatch (optionally ignored)
        else if (difference.getId() == DifferenceConstants.ATTR_SEQUENCE_ID && ignoreAttributeOrder) {
            return RETURN_IGNORE_DIFFERENCE_NODES_IDENTICAL;
        }
        // attribute missing / not expected
        else if (difference.getId() == DifferenceConstants.ATTR_NAME_NOT_FOUND_ID) {
            if (IGNORE_ATTRS.contains(difference.getTestNodeDetail().getValue())) {
                return RETURN_IGNORE_DIFFERENCE_NODES_IDENTICAL;
            }
        }

        return RETURN_ACCEPT_DIFFERENCE;
    }

    @Override
    public void skippedComparison(Node control, Node test) {
        // nothing to do
    }
} 
```

使用差异监听器：

```
 XMLUnit.setIgnoreWhitespace(true);
    XMLUnit.setIgnoreDiffBetweenTextAndCDATA(true);

    Diff diff = new Diff(expectedDocument, obtainedDocument);
    diff.overrideDifferenceListener(new IgnoreVariableAttributesDifferenceListener(Arrays.asList("id", "uid"), true));

    XMLAssert.assertXMLIdentical("xml invalid", diff, true); 
```

# c# - 从函数返回内存流

> ID：503789
> 
> 赞同：25
> 
> 时间：2009-02-02T16:22:49.207
> 
> 标签：c#

在您看来，是从函数返回新分配的内存流，还是将其传递给函数更好？例如，

```
void Foo(MemoryStream m) 
{ 
   m.Write(somebuffer, 0, somebuffer.Length); 
} 
```

或者

```
void MemoryStream Foo()
{
    MemoryStream retval = new MemoryStream();
    retval.Write(somebuffer, 0, somebuffer.Length);
    return retval;
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-02T16:35:13.067

这有点像询问您是否应该从方法中返回一个字符串或获取一个 StringBuilder 并附加到它。答案取决于用例是什么。

调用者是否可能希望使用包含某些数据的现有流来调用您的方法？他们可能想使用同一个流多次调用它吗？如果是这样，采用 MemoryStream 的版本会更有效。另一方面，如果他们只需要一次数据，则将其作为 MemoryStream（或更简单地说，作为字节数组）返回可能更合适。

不幸的是，从描述中我们无法真正说出发生了什么。当然，您可以将两者都实现为重载并从另一个中调用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-02T16:28:03.923

**将内存流传递给**函数并**返回**函数的内存流不应互换使用。您描述的方法有两个不同的目的。

*   当您希望函数对参数执行某些操作时，将某些内容传递给函数。

*   从函数返回一些东西是调用者应该对结果做一些事情的时候。

你在谈论两种不同的东西，苹果和橙子。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-02T16:32:53.900

我总是将流传递给函数。这允许它与调用者选择的任何流一起工作，例如直接进入文件而没有任何缓冲。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-02T16:24:57.190

您可以安全地从函数中返回它。您必须调用`Dispose()`或将其放在`using`子句中，因为它实现了 IDisposable。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T16:25:47.297

你的第二个更好。如果可能的话，我总是尽量避免改变函数内部的对象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-02T16:50:29.293

经过一番思考，我认为这归结为该`Foo`方法的预期语义。是吗：

*   创建流的操作（例如`File.Open()`）
*   修改流的操作（例如`something.WriteXml()`）

如果答案是“创建一个流”，让它返回一个流。如果它修改了流，则将流传入。

如果答案是“两者兼而有之”，那么拆分方法以使其只有一个职责可能是有意义的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T16:25:55.130

没有两个太多的区别。在第一种情况下，调用者将控制内存流，在第二种情况下，您可以执行以下操作：

```
using (MemoryStream ms = Foo())
{
  //Do Stuff here.
} 
```

最重要的是要记住正确处理它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-02T16:34:12.507

我更喜欢注入的形式。它消除了您的代码和 MemoryStream 之间的直接耦合，并使其更具可测试性。

```
public void Foo(Stream stream)
{
    stream.Write(somebuffer, 0, somebuffer.Length);
} 
```

现在我可以使用任何实现 Stream 的类（包括模拟类）来测试 Foo。

通常，我会在类的构造函数中进行注入，而不是在单个方法上进行注入，但想法基本相同。

```
public class FooClass
{
   public Stream FooStream { get; private set; }

   public FooClass() : this(null) { }

   public FooClass( Stream stream )
   {
       // provide a default if not specified
       this.FooStream = stream ?? new MemoryStream();
   }

   public void Foo()
   {
       this.FooStream.Write( somebuffer, 0, somebuffer.Length );
   }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-02T16:38:38.193

我倾向于第一个原因有两个：

1.  谁“拥有”内存流的语义很清楚。调用者创建了它，所以由调用者来摆脱它（这对于其他类型的流保留非托管资源来说更成问题）
2.  `Foo`可以与对您的流进行操作的其他方法结合使用

也就是说，如果 的主要目的`Foo`是作为 MemoryStreams 的工厂方法（类似于 File.Open 等），那么第二种方法更有意义。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-02T17:33:53.883

因为流是需要显式处理的资源（内存、文件、网络），所以最好应用 RAII 方法来处理它们。这意味着初始化它们的函数必须负责发布（我们在 C# 中“使用”keyord 就是为了这个）。为了启用这种模式，我说接受流作为参数。这样，调用者可以决定何时创建和处置流。当您使用它时，请让您的方法接受任何流实现；它似乎不需要只为 MemoryStream 工作。

# c# - 在 C# 中，我可以使用反射来确定枚举类型是 int、byte、short 等吗？

> ID：503806
> 
> 赞同：28
> 
> 时间：2009-02-02T16:26:15.223
> 
> 标签：c#, .net, enums, types

这可能吗？我在任何地方都找不到它。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-02-02T16:28:01.943

试试这个：

```
Enum.GetUnderlyingType(typeof(YourEnum)) 
```

# c - 在屏幕上绘制二维颜色三元组的最快方法是什么？

> ID：503816
> 
> 赞同：9
> 
> 时间：2009-02-02T16:29:57.070
> 
> 标签：c, linux, opengl, draw, xorg

目标语言是 C/C++，程序只能在 Linux 上运行，但平台独立的解决方案显然是首选。我运行 Xorg，XVideo 和 OpenGL 都可用。

在配备英特尔显卡的英特尔酷睿 2 双核上，我可以在 1024x768 上获得多少 FPS？（仅绘制计数，考虑阵列在 RAM 中已准备好；不需要精确的预测）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-02T19:02:44.063

绘制二维颜色三元组数组的最快方法：

1.  使用浮点（*不是*字节，*不是*双精度）存储。每个三元组由 3 个浮点数组成，每个浮点数从 0.0 到 1.0。这是 GPU 实现的最佳格式（但`GL_LUMINANCE`在不需要色调时使用灰度存储 - 更快！）
2.  将数组上传到纹理`glTexImage2D`
3.  确保`GL_TEXTURE_MIN_FILTER`纹理参数设置为`GL_NEAREST`
4.  将纹理映射到适当的四边形。

这种方法比使用平台的本机 blitting**略**快`glDrawPixels`（由于某种原因往往实施得不好）并且快得多。

 **此外，当您的像素图未更改时，它使您可以选择重复执行第 4 步而无需第 2 步，这当然要快得多。

仅提供慢速本地 blitting 的库包括：

*   Windows 的 GDI
*   X11 上的 SDL（在 Windows 上，它在使用 HW_SURFACE 时提供了一个快速的 opengl 后端）
*   Qt

至于您可以期待的 FPS，在带有 Intel 显卡的 Intel Core 2 Duo 上绘制 1024x768 纹理：如果纹理每帧都发生变化，则大约 60FPS，如果不变化，则 >100FPS。

但你自己做，看看;)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-02T18:59:28.797

不久前我使用 C 和 OpenGL 进行了此操作，通过创建全屏大小的四边形获得了非常好的性能，然后使用纹理映射将位图转移到四边形的面上。

这是一些示例代码，希望您可以使用它。

```
#include <GL/glut.h>
#include <GL/glut.h>

#define WIDTH 1024
#define HEIGHT 768

unsigned char texture[WIDTH][HEIGHT][3];             

void renderScene() {    

    // render the texture here

    glEnable (GL_TEXTURE_2D);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);

    glTexImage2D (
        GL_TEXTURE_2D,
        0,
        GL_RGB,
        WIDTH,
        HEIGHT,
        0,
        GL_RGB,
        GL_UNSIGNED_BYTE,
        &texture[0][0][0]
    );

    glBegin(GL_QUADS);
        glTexCoord2f(0.0f, 0.0f); glVertex2f(-1.0, -1.0);
        glTexCoord2f(1.0f, 0.0f); glVertex2f( 1.0, -1.0);
        glTexCoord2f(1.0f, 1.0f); glVertex2f( 1.0,  1.0);
        glTexCoord2f(0.0f, 1.0f); glVertex2f(-1.0,  1.0);
    glEnd();

    glFlush();
    glutSwapBuffers();
}

int main(int argc, char **argv) {
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB);

    glutInitWindowPosition(100, 100);
    glutInitWindowSize(WIDTH, HEIGHT);
    glutCreateWindow(" ");

    glutDisplayFunc(renderScene);

    glutMainLoop();

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T17:28:16.783

如果您想将像素转储到屏幕上，您可能需要使用[sdl 的](http://www.libsdl.org/) “表面”功能。为了获得最佳性能，请尝试将输入数据安排在与输出表面相似的布局中。如果可能，请避免在表面中一次设置一个像素。

SDL 本身并不是一个硬件接口，而是一个可移植层，可以很好地在许多其他显示层之上运行，包括 DirectX、OpenGL、DirectFB 和 xlib，因此您可以获得非常好的可移植性，而且它是一个非常薄的层在这些技术之上，因此您在这些技术之上支付的性能开销很少。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T18:22:59.480

除 SDL 之外的其他选项（如前所述）

*   [Cairo](http://www.cairographics.org/OpenGL/)表面浮华（在 C 中，适用于所有平台，但在 Linux 中最好）
*   [QT Canvas](http://doc.trolltech.com/4.0/qt4-arthur.html)（在 C++ 中，多平台）
*   OpenGL 原始 API 或[QT OpenGL](http://doc.trolltech.com/4.4/qtopengl.html)（你需要知道 openGL）
*   如果您想考虑非 opengl 平台，则纯 Xlib/XCB

我的建议

1.  QT 如果你更喜欢 C++
2.  开罗，如果你喜欢 C

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-30T15:50:15.453

“我可以期待多少 fps”的问题无法认真回答。即使您说出进行处理器布局的人的祖父，也不会。它取决于太多的变量。

*   你需要渲染多少个三元组？
*   他们在帧之间改变吗？
*   以什么速率（如果每秒超过 30 次，您不会注意到变化）？
*   是所有像素一直在变化还是只是某些区域的一些像素发生变化？
*   您是否看到没有任何透视失真的像素？
*   你总是看到所有的像素吗？
*   根据 opengl 驱动程序的版本，您会得到不同的结果

这可能会永远持续下去，答案完全取决于您的算法。如果您坚持使用 opengl 方法，您还可以尝试不同的扩展（例如[http://www.opengl.org/registry/specs/NV/pixel_data_range.txt](http://www.opengl.org/registry/specs/NV/pixel_data_range.txt)），看看它是否更适合您的需求；虽然已经提到的 glTexSubImage() 方法非常快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T16:34:25.020

> 在 1024x768 上我可以期待多少 FPS？

这个问题的答案取决于许多无法判断的因素。

# css - IE7 的某些 CSS 属性选择器有问题吗？

> ID：503826
> 
> 赞同：0
> 
> 时间：2009-02-02T16:32:04.617
> 
> 标签：css, xhtml, layout, internet-explorer-7

我正在尝试通过使用“for”属性选择它们来设置一些表单标签的样式。但是当我在 IE7 中预览它时，什么都没有被拾取。我这样做是因为我想给它们设置不同的样式，而不添加到现有的标记中。

因此，如果我的 CSS 如下所示，我将一无所获：

```
<style>
 label[for="foo"] {
 background: blue;
 padding: 1em
}
</style>

<form>
 <label for="foo"/>bar</label>
 <input name="foo" type="text"/>
</form> 
```

但是，如果我将其更改为此，样式将起作用。

```
<style>
 label[fro="foo"] {
 background: blue;
 padding: 1em
}
</style>

<form>
 <label fro="foo"/>bar</label>
 <input name="foo" type="text"/>
</form> 
```

你以前见过这样的问题吗？我编写 CSS、IE7 或其他东西的方式有问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T16:47:07.817

该用户似乎遇到了与您相同的问题： [这里](http://reference.sitepoint.com/css/attributeselector#usernote472)

他说因为“for”是保留字，所以不能用作属性名。但 'htmlFor' 是与 for 属性关联的 DOM 属性名称

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T16:57:27.360

标签与特定的输入字段配对，那么有什么理由不能使用 class 而不是为此目的在 CSS 中创建大量选择器？

# microsoft-sync-framework - 同步框架：你能通过 http 同步吗

> ID：503832
> 
> 赞同：2
> 
> 时间：2009-02-02T16:33:08.530
> 
> 标签：microsoft-sync-framework

我们计划使用 ADO.NET 的同步服务来与总部同步商店，并且有人建议我通过**WCF 代理**进行同步。

通过 WCF 代理进行同步是否意味着我可以**通过 http 进行同步**？如果没有，是否可以使用同步服务通过 http 进行同步。

（我不想每次获得需要与总部同步的新商店时都更新我们的**防火墙—​​—这就是我想通过 http 同步的原因）。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T10:50:41.837

是的，WCF 实现了 SOAP 和 REST Web 服务，两者都可以通过 http 或 http/s 公开。

[这是 MSDN 关于 WCF 的一些文档。](http://msdn.microsoft.com/en-us/library/ms733768.aspx)

我们总是使用 http/s (SSL)，即使在我们的局域网内也是如此。

# c++ - 在 C++ 中实现智能指针的最佳方法是什么？

> ID：503833
> 
> 赞同：12
> 
> 时间：2009-02-02T16:33:14.677
> 
> 标签：c++, smart-pointers, c++03, raii, reference-counting

我一直在评估各种智能指针实现（哇，那里有很多），在我看来，它们中的大多数可以分为两大类：

1) 此类别对引用的对象使用继承，以便它们具有引用计数，并且通常实现 up() 和 down()（或它们的等价物）。IE，要使用智能指针，您指向的对象必须从 ref 实现提供的某个类继承。

2) 此类别使用辅助对象来保存引用计数。例如，智能指针不是直接指向一个对象，而是实际上指向这个元数据对象……谁有引用计数和 up() 和 down() 实现（并且谁通常提供指针指向的机制获取指向的实际对象，以便智能指针可以正确实现运算符->（））。

现在， 1 有一个缺点，它强制您希望引用 count 的所有对象都从一个共同的祖先继承，这意味着您不能使用它来引用您无法控制源代码的 count 对象到。

2 的问题是由于计数存储在另一个对象中，如果您曾经遇到将指向现有引用计数对象的指针转换为引用的情况，您可能有一个错误（IE，因为计数不在实际对象，新引用无法获取计数...引用到引用复制构造或赋值很好，因为它们可以共享计数对象，但是如果您必须从指针转换，您重新完全冲洗）...

现在，据我了解， boost::shared_pointer 使用机制 2，或类似的东西......也就是说，我无法完全决定哪个更糟！我只在生产代码中使用过机制 1……有人对这两种风格都有经验吗？或者也许还有另一种比这两种方法更好的方法？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-02T19:00:37.110

> “在 C++ 中实现智能指针的最佳方法是什么”

1.  **不！** 使用现有的、经过良好测试的智能指针，例如 boost::shared_ptr 或 std::tr1::shared_ptr（使用 C++ 11 的 std::unique_ptr 和 std::shared_ptr）
2.  如果必须，请记住：
    1.  使用安全布尔成语
    2.  提供一个运算符->
    3.  提供强大的异常保证
    4.  记录你的班级对删除器的例外要求
    5.  尽可能使用 copy-modify-swap 来实现强异常保证
    6.  记录您是否正确处理多线程
    7.  编写广泛的单元测试
    8.  以这样的方式实现转换为基，它将删除派生指针类型（策略智能指针/动态删除器智能指针）
    9.  支持访问原始指针
    10.  考虑提供弱指针来打破周期的成本/收益
    11.  为您的智能指针提供适当的转换运算符
    12.  使您的构造函数模板化以处理从派生的构造基指针。

并且不要忘记上面不完整列表中我可能忘记的任何内容。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-02T17:13:21.507

只是为了为无处不在的 Boost 答案提供不同的观点（即使它是*许多*用途的正确答案），请查看[Loki](http://loki-lib.sourceforge.net/index.php?n=Main.Idioms)的智能指针实现。对于设计哲学的论述，Loki 的原始创建者写了《[现代 C++ 设计](http://en.wikipedia.org/wiki/Modern_C%2B%2B_Design)》一书。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-02T16:44:01.740

我已经使用 boost::shared_ptr 好几年了，虽然你对缺点的看法是正确的（不能通过指针进行赋值），但我认为这绝对值得，因为它拯救了我大量与指针相关的错误.

在我的自制游戏引擎中，我尽可能地用 shared_ptr 替换了普通指针。如果您通过引用调用大多数函数，那么这导致的性能损失实际上并没有那么糟糕，这样编译器就不必创建太多的临时 shared_ptr 实例。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-02T16:55:14.307

Boost 还有一个侵入式指针（如解决方案 1），它不需要从任何东西继承。它确实需要更改指向类的指针以存储引用计数并提供适当的成员函数。我在内存效率很重要的情况下使用了它，并且不希望每个共享指针使用另一个对象的开销。

例子：

```
class Event {
public:
typedef boost::intrusive_ptr<Event> Ptr;
void addRef();
unsigned release();
\\ ...
private:
unsigned fRefCount;
};

inline void Event::addRef()
{
  fRefCount++;
}
inline unsigned Event::release(){
    fRefCount--;
    return fRefCount;
}

inline void intrusive_ptr_add_ref(Event* e)
{
  e->addRef();
}

inline void intrusive_ptr_release(Event* e)
{
  if (e->release() == 0)
  delete e;
} 
```

使用 Ptr typedef 以便我可以在 boost::shared_ptr<> 和 boost::intrusive_ptr<> 之间轻松切换，而无需更改任何客户端代码

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-02T17:03:47.423

如果你坚持使用标准库中的那些，你会没事的。
尽管除了您指定的类型之外，还有一些其他类型。

*   共享：所有权在多个对象之间共享
*   拥有：一个对象拥有该对象但允许转让。
*   不可移动：一个对象拥有该对象并且不能转让。

标准库有：

*   标准::auto_ptr

Boost 比 tr1 改编的多一些（标准的下一个版本）

*   std::tr1::shared_ptr
*   std::tr1::weak_ptr

而那些仍在提升中的人（无论如何这是必须拥有的）有望进入tr2。

*   boost::scoped_ptr
*   boost::scoped_array
*   boost::shared_array
*   boost::intrusive_ptr

请参阅： [智能指针：或者谁拥有你的宝贝？](https://stackoverflow.com/questions/94227/smart-pointers-or-who-owns-you-baby)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-02T17:13:19.963

在我看来，这个问题有点像问“哪个是最好的排序算法？” 没有一个答案，这取决于你的情况。

出于我自己的目的，我使用的是您的类型 1。我无权访问 TR1 库。我确实可以完全控制我需要共享指针的所有类。类型 1 的额外内存和时间效率可能非常小，但内存使用和速度对我的代码来说是个大问题，所以类型 1 是一个灌篮高手。

另一方面，对于可以使用 TR1 的任何人，我认为类型 2 std::tr1::shared_ptr 类将是一个明智的默认选择，只要没有什么紧迫的理由不使用它就可以使用它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-02T16:53:28.960

2的问题可以解决。出于同样的原因，Boost 提供了 boost::shared_from_this。在实践中，这不是一个大问题。

但是他们选择您的选项 #2 的原因是它可以在所有情况下使用。依赖继承并不总是一种选择，然后你就会得到一个智能指针，你不能将它用于一半的代码。

我不得不说#2 是最好的，因为它可以在任何情况下使用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-02T18:16:58.743

我们的项目广泛使用智能指针。一开始不确定要使用哪个指针，因此其中一位主要作者在他的模块中选择了一个侵入式指针，而另一位则选择了非侵入式版本。

一般来说，两种指针类型之间的差异并不显着。唯一的例外是我们的非侵入式指针的早期版本是从原始指针隐式转换的，如果指针使用不正确，这很容易导致内存问题：

```
void doSomething (NIPtr<int> const &);

void foo () {
  NIPtr<int> i = new int;
  int & j = *i;
  doSomething (&j);          // Ooops - owned by two pointers! :(
} 
```

前段时间，一些重构导致代码的某些部分被合并，因此必须选择使用哪种指针类型。非侵入式指针现在将转换构造函数声明为*显式*，因此决定使用侵入式指针以节省所需的代码更改量。

令我们非常惊讶的是，我们注意到的一件事是，通过使用侵入式指针，我们立即获得了性能提升。我们并没有对此进行太多研究，只是假设不同之处在于维护计数对象的成本。到目前为止，非侵入式共享指针的其他实现可能已经解决了这个问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-02T19:06:30.017

您在谈论的是**侵入式**和**非侵入式**智能指针。Boost 两者都有。`boost::intrusive_ptr`每次需要更改引用计数时，都会调用一个函数来减少和增加对象的引用计数。它不是调用成员函数，而是自由函数。因此，它允许管理对象而无需更改其类型的定义。正如你所说，`boost::shared_ptr`是非侵入性的，你的第 2 类。

我有一个解释 intrusive_ptr 的答案：[让 shared_ptr 不使用 delete](https://stackoverflow.com/questions/441306/make-sharedptr-not-use-delete/441442#441442)。简而言之，如果您有一个已经引用计数的对象，或者需要（如您所解释的）一个已经被 intrusive_ptr 引用的对象，则可以使用它。

# database-design - 教学数据库设计的好例子

> ID：503834
> 
> 赞同：7
> 
> 时间：2009-02-02T16:33:41.213
> 
> 标签：database-design, normalization, scenarios

有没有人有任何教授关系数据库和 SQL 的好场景？我能找到的所有示例要么是微不足道的，要么具有不太可能的域约束（例如全名是唯一的）。

我特别想找到一些规范化的好例子：不立即适合 3NF 和 BCNF 的表。目前我为每个级别使用不同的问题。

当然，我也喜欢设计糟糕的数据库的好例子，但在掌握基础知识之前，这有点让人分心。

* * *

谢谢，一些很好的例子。我已将学生/班级一标记为答案，因为我认为这是迄今为止最好的，但如果有人想贡献更多，请做。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-02T16:41:16.673

我似乎记得学生/班级是经典之作，您也可以将成绩放在那里以使其更复杂一些。

*   学生可以参加许多课程

*   班级有很多学生

*   对于学生参加的每个班级，他们可以有一个成绩

最初，您可以在一个表中执行此操作，然后将其非规范化为三个。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-02T20:03:11.337

题外话

教过数据库课程后，我建议在掌握查询的基础知识之前忘记设计。一旦人们了解了如何从数据库中获取数据，人们就会更好地理解规范化的必要性。如果您从规范化和设计开始，您将失去课堂其余部分的大部分学生。设计应该是数据库课程的最后一个模块，但我看过的所有教科书都是从它开始的。

更好的是让他们在学习查询时同时查询好的和坏的数据库设计，然后他们会真正了解在教授设计时糟糕的设计是多么痛苦。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T16:46:25.307

电子商务/购物车设计很好，因为大多数人都理解这个概念，你可以将它推向许多不同的方向。

你可以做一些简单的事情，比如购物车、购物车项目、用户、订单、订单项目等。

然后你可以更深入地了解 user_addresses、user_emails、items、item_details、item_history 等。

这可以提供很多很好的辩论，因为有很多判断电话。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T20:23:06.307

我永远不会忘记的一个概念是整个“复数”与“单数”的命名。一位伟大的导师曾经告诉我，您应该将表名设计为复数，将列名设计为单数，并且永远不要为列名创建特定于时间的名称。时间名称示例有 NutsSold1998、NutsSold1999、NutsSold2000 等。切勿在列名称中添加年份、月份或周数或时间等。

表名示例：Employees（非Employee）Parts（非Part）Student（学生）

列名示例：EmployeeID（不是EmployeesID 或EmployeeIDS 等）PartID（不是PartsID 或PartIDS 等）StudentID（不是StudentID 或StudentIDS 等）

并注意 ID、代码、密钥、数字等的正确用法......我总是被教导不要在列的名称中使用“密钥”，除非它是一个实际的表键（主键或外键，但不一定是交替的）.. 大多数情况下，附加“ID”会比附加“数字”或“代码”更好，但这完全取决于上下文。

这伴随着时间和设计表格的经验，阅读好的材料，例如《为[普通人设计的数据库设计》](http://www.bookpool.com/sm/0201752840)和[《为所有人设计的数据建模》](https://rads.stackoverflow.com/amzn/click/com/1590592131)。此外，花大量时间寻找好的设计并将它们分开。它绝对是一门手艺，你只会随着时间和练习而变得更好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T11:17:48.477

另一个好的模型是 invoice-item 模型，因为“最佳选择”取决于各种因素：

*   写入与读取操作的数量；
*   表现;
*   是否需要报告功能？

看看这个数据模型：

发票

*   ID
*   日期

发票项目

*   发票编号
*   描述
*   数量

应用程序功能如下：

*   创建新发票；
*   每天晚上创建并发送两个报告：(a) 每张发票的总金额，(b) 当天的总金额。

假设您平均每张发票有 5 件物品，每天有 100 张发票，您最终每天都会这样做：

*   5 x 100 写入 InvoiceItem；
*   100 写在发票上；
*   5 x 100 + 100 = 600 从 Invoice 和 InvoiceItem 读取（报告 (a)）；
*   5 x 100 + 100 = 600 从 Invoice 和 InvoiceItem 读取（报告 (b)）；

所以总计 = 1800 次操作/天，假设读取和写入的成本相同。

如果在实体“Invoice”上添加“TotalAmount”属性，情况会有所不同：

*   5 x 100 写入 InvoiceItem；
*   100 次写入 Invoice（包括 TotalAmount）；
*   *100仅*来自发票（报告 (a)）；
*   *100仅*来自发票（报告 (b)）；

总共有 800 次操作 :)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-21T21:19:59.253

这是一个可以追溯到我大学时代的例子——它既被用作数据库设计挑战，也被用作面向对象的设计挑战。

并非所有信息都立即显示出来 - 部分挑战是了解如何调整设计以处理新要求，以及适当的规范化如何使这更容易。

假设您必须为大学/学院的情况设计一个数据库并且想要处理注册。

您已经教授了**课程**。每门课程每周都有一个标题和一个固定的时间段。

每门课程都有一位**讲师**介绍课程。

每门课程都有许多学习该课程的**学生**。

每门课程都有一名或多名**导师**帮助学生学习。您无需跟踪哪些导师帮助了哪些学生。

有些课程有多个固定时间段。

有些课程有多个讲师。

讲师和导师是有报酬的，这意味着我们需要跟踪一些信息以用于税收目的。税务部门不在乎他们的报酬是什么——他们希望我们每人只有一个记录。

在某些课程中，讲师还担任导师，以近距离了解一些学生如何处理材料。

一些导师也是其他课程的讲师。

要成为课程的导师，您必须在更早的时间成为该课程的学生。

并非每个学生都会因通过课程而获得学分——有些学生只是在审核课程而不需要学分。

课程失败的学生可以稍后再次参加该课程。我们需要记录每一次尝试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T16:48:48.000

总是有图书馆的例子（图书馆有很多书，每本书都有一个作者和出版商，当你规范化时可以将它们推到单独的表中）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-02T16:54:54.680

关于：

> 我特别想找到一些规范化的好例子：不立即适合 3NF 和 BCNF 的表。

您可以在此处找到*规范化*的数据库模式示例：http: [//www.microsoft.com/sqlserver/2005/en/us/express-starter-schemas.aspx](http://www.microsoft.com/sqlserver/2005/en/us/express-starter-schemas.aspx)。您可以从头开始构建它们，以向您的学生展示“标准化方式”。特别看一下联系人管理模式。您可以轻松地对模式进行非规范化并将其恢复为 3NF 或更深。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-02T17:00:47.213

Itzik Ben Gan 的新书 Microsoft SQL Server 2008：T-SQL Fundamentals 有一个非常基本的示例，您可以看到该示例源自简化的 Northwind 数据库。

[Microsoft SQL Server 2008：T-SQL Fundamentals 作者支持页面](http://www.sql.co.il/books/tsqlfund2008/)

# windows - 如何回显并将控制台输出发送到 bat 脚本中的文件？

> ID：503846
> 
> 赞同：147
> 
> 时间：2009-02-02T16:38:02.470
> 
> 标签：windows, batch-file, cmd

我有一个执行任务并将输出发送到文本文件的批处理脚本。有没有办法在控制台窗口上也显示输出？

例如：

```
c:\Windows>dir > windows-dir.txt 
```

有没有办法`dir`在控制台窗口中显示输出并将其放入文本文件中？

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2011-01-03T20:34:58.123

不，您不能使用纯重定向。
但是通过一些技巧（比如[tee.bat](https://stackoverflow.com/a/10719322/463115)）你可以。

我试着解释一下重定向。

**您使用> file**或**< file**重定向十个流之一
并不重要，如果重定向是在命令之前或之后，那么这两行几乎相同。

```
dir > file.txt
> file.txt dir 
```

此示例中的重定向只是**1>**的快捷方式，这意味着流 1 (STDOUT) 将被重定向。**因此，您可以在前面加上2> err.txt**
之类的数字来重定向任何流，并且还允许在一行中重定向多个流。

 **```
dir 1> files.txt 2> err.txt 3> nothing.txt 
```

在此示例中，“标准输出”将进入 files.txt，所有错误都将出现在 err.txt 中，stream3 将进入 nothing.txt（DIR 不使用流 3）。
**Stream0 是 STDIN
Stream1 是 STDOUT Stream2
是 STDERR
Stream3-9 未使用**

但是，如果您尝试多次重定向同一个流会发生什么？

```
dir > files.txt > two.txt 
```

“只能有一个”，而且永远是最后一个！
所以它等于**dir > two.txt**

好的，还有一种额外的可能性，将一个流重定向到另一个流。

```
dir 1>files.txt 2>&1 
```

**2>&1**将 stream2 重定向到 stream1 并且**1>files.txt**将所有重定向到**files.txt**。
这里的顺序很重要！

```
dir ... 1>nul 2>&1
dir ... 2>&1 1>nul 
```

是不同的。第一行将所有（STDOUT 和 STDERR）重定向到 NUL，
但第二行将 STDOUT 重定向到 NUL，将 STDERR 重定向到“空”STDOUT。

作为一个结论，很明显为什么 Otávio Décio 和 andynormancx 的例子行不通。

```
command > file >&1
dir > file.txt >&2 
```

两者都尝试将 stream1 重定向两次，但“只能有一个”，并且始终是最后一个。
所以你得到

```
command 1>&1
dir 1>&2 
```

在第一个示例中，不允许将 stream1 重定向到 stream1（也不是很有用）。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2011-10-29T18:57:55.660

只需以这种方式使用 Windows 版本的 UNIX tee 命令（可从[http://unxutils.sourceforge.net 找到](http://unxutils.sourceforge.net)）：

```
mycommand > tee outpu_file.txt 
```

如果您还需要 STDERR 输出，请使用以下内容。
将`2>&1`STDERR 输出组合到 STDOUT（主流）中。

```
mycommand 2>&1 | tee output_file.txt 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-02T16:42:41.617

如果您不需要实时输出（即程序正在编写它），您可以添加

```
type windows-dir.txt 
```

在那条线之后。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-07-17T07:27:07.330

对我有用的解决方案是：[dir > a.txt | 输入 a.txt](https://stackoverflow.com/questions/796476/dos-command-to-display-result-on-console-and-redirect-the-output-to-a-file/1141753#1141753)。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-01-05T01:56:54.917

是的，有一种方法可以在控制台（屏幕）和文件中显示单个命令输出。使用您的示例，使用...

```
@ECHO OFF
FOR /F "tokens=*" %%I IN ('DIR') DO ECHO %%I & ECHO %%I>>windows-dir.txt 
```

详细解释：

该`FOR`命令将命令或文本的输出解析为可以多次引用的变量。

对于命令，例如`DIR /B`，用单引号括起来，如下例所示。用您想要的命令替换`DIR /B`文本。

```
FOR /F "tokens=*" %%I IN ('DIR /B') DO ECHO %%I & ECHO %%I>>FILE.TXT 
```

要显示文本，请用双引号将文本括起来，如下例所示。

```
FOR /F "tokens=*" %%I IN ("Find this text on console (screen) and in file") DO ECHO %%I & ECHO %%I>>FILE.TXT 
```

...并带有换行...

```
FOR /F "tokens=*" %%I IN ("Find this text on console (screen) and in file") DO (
  ECHO %%I & ECHO %%I>>FILE.TXT
) 
```

如果您有时只希望在控制台（屏幕）上输出，有时只发送到文件，有时发送到两者，请使用变量指定 FOR 循环的“DO”子句，如下所示`%TOECHOWHERE%`。

```
@ECHO OFF
FOR %%I IN (TRUE FALSE) DO (
  FOR %%J IN (TRUE FALSE) DO (
    SET TOSCREEN=%%I & SET TOFILE=%%J & CALL :Runit)
)
GOTO :Finish

:Runit
  REM Both TOSCREEN and TOFILE get assigned a trailing space in the FOR loops
  REM above when the FOR loops are evaluating the first item in the list,
  REM "TRUE".  So, the first value of TOSCREEN is "TRUE " (with a trailing
  REM space), the second value is "FALSE" (no trailing or leading space).
  REM Adding the ": =" text after "TOSCREEN" tells the command processor to
  REM remove all spaces from the value in the "TOSCREEN" variable.
  IF "%TOSCREEN: =%"=="TRUE" (
      IF "%TOFILE: =%"=="TRUE" (
          SET TEXT=On screen, and in "FILE.TXT"
          SET TOECHOWHERE="ECHO %%I & ECHO %%I>>FILE.TXT"
        ) ELSE (
          SET TEXT=On screen, not in "FILE.TXT"
          SET TOECHOWHERE="ECHO %%I"
      )
    ) ELSE (
      IF "%TOFILE: =%"=="TRUE" (
          SET TEXT=Not on screen, but in "FILE.TXT"
          SET TOECHOWHERE="ECHO %%I>>FILE.txt"
        ) ELSE (
          SET TEXT=Not on screen, nor in "FILE.TXT"
          SET TOECHOWHERE="ECHO %%I>NUL"
      )
  )
  FOR /F "tokens=*" %%I IN ("%TEXT%") DO %TOECHOWHERE:~1,-1%
GOTO :eof

:Finish
  ECHO Finished [this text to console (screen) only].
  PAUSE 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-02T16:41:38.390

```
command > file >&1 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-06-15T12:33:05.403

如果要追加而不是替换输出文件，您可能需要使用

```
dir 1>> files.txt 2>> err.txt 
```

或者

```
dir 1>> files.txt 2>>&1 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-02-25T22:59:05.967

我的选择是这样的：

创建一个接收消息并自动将其发送到控制台和日志文件的过程的子例程。

```
setlocal
set logfile=logfile.log

call :screenandlog "%DATE% %TIME% This message goes to the screen and to the log"    

goto :eof

:screenandlog
set message=%~1
echo %message% & echo %message% >> %logfile%
exit /b 
```

如果您向消息中添加变量，请确保在将其发送到子例程之前删除其中的引号，否则它可能会破坏您的批处理。当然，这只适用于回声。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-05-27T09:47:25.767

我做了一个简单的 C# 控制台，它可以处理实时输出到 cmd 屏幕和日志

```
class Tee
{
    static int Main(string[] args)
    {
        try
        {
            string logFilePath = Path.GetFullPath(args[0]);

            using (StreamWriter writer = new StreamWriter(logFilePath, true))
            {
                for (int value; (value = Console.In.Read()) != -1;)
                {
                    var word = Char.ConvertFromUtf32(value);
                    Console.Write(word);
                    writer.Write(word);
                }
            }
        }
        catch (Exception)
        {
            return 1;
        }
        return 0;
    }
} 
```

批处理文件的使用方式和你使用 Unix 的方式一样`tee`

```
foo | tee xxx.log 
```

这是包含 Tee.exe 的存储库，以防您没有编译工具 [https://github.com/iamshiao/Tee](https://github.com/iamshiao/Tee)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-03-08T16:24:49.930

我喜欢 atn 的回答，但对我来说下载它并不像 wintee 那样简单[，](http://code.google.com/p/wintee/)它也是开源的，只提供 tee 功能（如果你只想要 tee 而不是整套 unix 实用程序，这很有用）。我从 davor 对[Displaying Windows command prompt output and redirecting it to a file](https://stackoverflow.com/questions/796476/displaying-windows-command-prompt-output-and-redirecting-it-to-a-file)的回答中了解到这一点，您还可以在其中找到对 unix 实用程序的引用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-04-06T00:32:37.380

“Tomas R”提供的解决方案非常适合 OP 的问题，并且它本身就可用。

试试： chkdsk c: > output.txt | 输入输出.txt

此命令的输出涉及一个完成百分比，该完成百分比会串行输出到文件中，因此它看起来有点混乱（即文本将随着它的进行而被附加）。这不会发生在输出到 STDOUT（屏幕）的位上。如果您只执行相同的命令而不进行重定向，情况就是这样。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2020-01-20T14:06:56.213

我想你想要这样的东西：

```
echo Your Msg> YourTxtFile.txt 
```

或者如果你想要一个新行：

```
echo Your Msg>> YourTxtFile.txt 
```

这些命令非常适合日志。

*注意：这有时会出现故障并替换我计算机上的整个文本文件。*

*另注：如果文件不存在，则会创建文件。*

# c# - .NET WebBrowser 控件 javascript

> ID：503863
> 
> 赞同：0
> 
> 时间：2009-02-02T16:45:32.890
> 
> 标签：c#, .net, javascript, browser

有人知道.NET 应用程序中的 webBrowser activex 控件是否存在某种错误或问题，在这种情况下，嵌入式浏览器会加载一个依赖于 javascript 来播放音乐预览的网页。它可以工作一次，但是如果您导航到系统中的新页面，它就会停止工作。

仅在普通 IE 浏览器中查看同一个站点根本不会出现任何错误（在多个不同类型的系统上进行了测试）。

* * *

它发生在几个不同的操作系统上，XP 32 和 64 位、Vista、Windows 7。

它也不是一个 java 小程序，只是 jQuery 和带有一些 JS 的长尾视频播放器，用于将预览链接绑定到播放器。我很困惑为什么它有时会起作用，但有时却不起作用。

它也是一个大型实时系统，并收到很多投诉。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-02-12T00:07:17.110

让我直接告诉你。WebBrowser 控件上的默认呈现引擎是固定的，以确保跨所有平台的兼容性。

基本上，如果您安装的浏览器是 IE 7 - IE 9，那么使用的渲染引擎仅是 IE 7.0（默认情况下）。

但是，如果您安装的 IE 版本是 IE 6 或更低，那么使用的渲染引擎是 IE 4.0，当然除非您另外设置。

有一种误解认为 WebBrowser 控件使用当前安装的任何内容（当前 IE 版本），但事实并非如此，因为它们这样做是为了减少向后兼容性问题。[您可以通过在普通浏览器中访问 http://www.whatsmyuseragent.com](http://www.whatsmyuseragent.com)，然后在 WebBrowser 控件中再次访问该网站来看到（作为证据）这确实是您的问题，您会看到它显示 MSIE 7.0 :)。

我怀疑使用 IE 6.0 的用户（和您）会遇到您提到的问题，因为他们使用的渲染引擎是 IE 4.0（如果他们运行的是 IE 7 到 IE9 之间的任何东西，则为 IE 7）。这真的很糟糕，特别是如果他们在IE 6上，如果他们是IE 6，你应该要求他们升级他们的浏览器，然后，无论如何都会使用IE 7.0。

我不确定，当 IE 10.0 发布时，WebBrowser 控件的默认引擎是否会转到 10.0（当然，如果系统上安装了 10.0）或者即使在 IE 10.0 发布后它仍将保持为 IE 7.0，我们将有出来后看看。但是，如果我们根据之前的经验猜测，我怀疑 IE 10.0 将是最后一个使用 IE 7.0 渲染引擎的版本，而当 IE 11 出来时，对于 IE 11 之间的所有 IE 版本，默认渲染引擎将保持为 IE 11 & IE 14\. 这只是通过推断他们过去所做的事情的猜测。

您可以将 WebBrowser 控件设置为使用当前安装的 Internet Explorer 版本；如果您想了解有关如何执行此操作或如何进一步修复渲染引擎的更多信息，请告诉我，我会为您提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-26T07:38:39.210

The web browser control uses the same shell as the installed version of Internet Explorer, but in my experience, the full browser handles things more gracefully.

It is worth adding some debug to the JavaScript to see where the problem is - is it because longtail isn't registering as loaded, so no events are binding or is it because of a problem with the events.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T01:50:56.597

Which version of .net are you using?

Also which OS?

Ive noticed within Vista that Java applets `<applet>` tags causes catastrophic issues. I believe this is due to it using Microsoft JVM for its java processing, which happens to be unsupported now. This does not occur in XP from what ive seen

# apache-flex - 只有在源文件被修改的情况下，如何执行 Ant 任务？

> ID：503865
> 
> 赞同：16
> 
> 时间：2009-02-02T16:46:17.583
> 
> 标签：apache-flex, ant, dependencies

必须有一个简单的方法来做到这一点。我使用依赖于 SWC 库的 ant 构建了一个 Flex 应用程序，除了它是否需要重建库之外，它工作正常。如果库的任何源文件（*.as、*.mxml）比 SWC 更新，我如何告诉 ant 只运行任务？

我看过 <dependset> 但它似乎只是删除文件，而不是确定是否应该运行任务。<depend> 似乎期望源文件和目标文件之间存在一对一的关系，而不是一对多的关系——我有许多输入文件和一个输出文件，但没有中间目标文件。

非常感谢，亚历克斯

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-02T17:23:23.390

您可以使用 Ant [uptodate 任务](http://ant.apache.org/manual/Tasks/uptodate.html)来创建一个属性，并且只有在设置了该属性时才执行您的其他目标。

我对 flex 了解不多，但你可能想要这样的东西：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="test" default="compile">

   <target name="checkforchanges">
      <uptodate property="nochanges">
         <srcfiles dir="." includes="**/*.as"/>
         <srcfiles dir="." includes="**/*.mxml"/>
         <mapper to="applicaton.flex"/>
      </uptodate>
   </target>

   <target name="compile" depends="checkforchanges" unless="nochanges">
      ...
   </target>

</project> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-05T21:44:52.643

[ant contrib](http://ant-contrib.sourceforge.net)库中的[OutOfDate](http://ant-contrib.sourceforge.net/tasks/tasks/outofdate.html)任务在IMO 中比 Ant选项干净得多。原因是您必须定义其他目标才能设置属性。`uptodate`

Ant contrib 的解决方案（来自他们的示例页面）：

```
<outofdate>
    <sourcefiles>
        <pathelement path="build.xml"/>
        <fileset dir="${lib.dir}"/>
    </sourcefiles>
    <targetfiles path="${jrun.file}"/>
    <sequential>
        <mkdir dir="${build.bin.dir}"/>
        <echo file="${jrun.file}" message="java -cp ${jrun.path} $*"/>
        <chmod file="${jrun.file}" perm="ugo+rx"/>
    </sequential>
</outofdate> 
```

一切都很好地保存在一个目标内。

# c++ - linux中的定时器类

> ID：503866
> 
> 赞同：2
> 
> 时间：2009-02-02T16:46:22.857
> 
> 标签：c++, linux, timer

我需要一个计时器来执行分辨率相对较低的回调。在 Linux 中实现此类 C++ 计时器类的最佳方法是什么？有没有我可以使用的库？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-03T03:50:42.720

如果您在框架（Glib、Qt、Wx、...）中编写，您将已经拥有一个具有定时回调功能的事件循环。我会假设情况并非如此。

如果您正在编写自己的事件循环，则可以将`gettimeofday`/`select`对（`struct timeval`，微秒精度）或`clock_gettime`/`nanosleep`对（`struct timespec`，纳秒精度）用于您自己的事件调度程序。尽管后一个界面的分辨率更高，但调度永远不会那么准确，所以选择最适合的。

```
#include <algorithm>
#include <functional>
#include <vector>

#include <errno.h>
#include <sys/time.h>
#include <unistd.h>

using namespace std;

class scheduler {
public:
    scheduler();
    int events();
    void addEvent(const struct timeval, int (*)(void *), void *);
    int dispatchUntil(const struct timeval &);
    bool waitUntil(const struct timeval * = NULL);
    int loopUntil(const struct timeval * = NULL);

private:
    static bool tv_le(const struct timeval &, const struct timeval &);
    struct event {
        struct timeval when;
        int (*callback)(void *);
        void *data;
    };
    static struct _cmp
      : public binary_function<bool, const struct event &, const struct event &>
    {
        bool operator()(const struct event &a, const struct event &b) {
            return !tv_le(a.when, b.when);
        }
    } cmp;
    vector<struct event> heap;
};

bool scheduler::tv_le(const struct timeval &a, const struct timeval &b) {
    return a.tv_sec < b.tv_sec ||
        a.tv_sec == b.tv_sec && a.tv_usec <= b.tv_usec;
}

scheduler::scheduler() : heap() {}

int scheduler::events() {
    return heap.size();
}

void scheduler::addEvent(const struct timeval when, int (*callback)(void *), void *data) {
    struct event ev = {when, callback, data};
    heap.push_back(ev);
    push_heap(heap.begin(), heap.end(), cmp);
}

int scheduler::dispatchUntil(const struct timeval &tv) {
    int count = 0;
    while (heap.size() > 0 && tv_le(heap.front().when, tv)) {
        struct event ev = heap.front();
        pop_heap(heap.begin(), heap.end(), cmp);
        heap.pop_back();
        ev.callback(ev.data);
        count++;
    }
    return count;
}

bool scheduler::waitUntil(const struct timeval *tv) {
    if (heap.size() > 0 && (!tv || tv_le(heap.front().when, *tv)))
        tv = &heap.front().when;
    if (!tv)
        return false;
    struct timeval tv2;
    do {
        gettimeofday(&tv2, NULL);
        if (tv_le(*tv, tv2))
            break;
        tv2.tv_sec -= tv->tv_sec;
        if ((tv2.tv_usec -= tv->tv_usec) < 0) {
            tv2.tv_sec--;
            tv2.tv_usec += 1000000;
        }
    } while (select(0, NULL, NULL, NULL, &tv2) < 0 && errno == EINTR);
    return heap.size() > 0 && tv_le(*tv, heap.front().when);
}

int scheduler::loopUntil(const struct timeval *tv) {
    int counter = 0;
    while (waitUntil(tv))
        counter += dispatchUntil(heap.front().when);
    return counter;
} 
```

警告：我喜欢 C。我从不写 C++。我只是假装懂语言。

免责声明：刚刚写的，完全未经测试。基本思想是将事件保存在优先级队列中，等到第一个，运行它，然后重复。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-02T18:29:51.277

使用 boost::asio 库。它具有调用回调的同步和异步计时器。

[http://www.boost.org/doc/libs/1_37_0/doc/html/boost_asio/tutorial.html](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_asio/tutorial.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T18:19:37.647

试试 time.h 中定义的 clock_gettime() 函数：

```
int clock_gettime(clockid_t clk_id, struct timespec *tp);

struct timespec {
  time_t   tv_sec;        /* seconds */
  long     tv_nsec;       /* nanoseconds */
}; 
```

通常你可以这样称呼它：

```
struct timespec ts;
clock_gettime(CLOCK_REALTIME, &ts); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T18:31:44.347

time.h 标头中的 timeval 结构是您正在寻找的。它有以秒和纳秒为单位的时间。所以以纳秒为单位的总时间是 timeval.tv_sec * 1000000 + timeval.tv_usec。很简单，我想。

```
#include <time.h>
timeval theStartTime;
gettimeofday(&theStartTime);
std::cout<<"The time we got's seconds field = "<<theStartTime.tv_sec<<std::endl;
std::cout<<"The time we got's nanoseconds field =  "<<theStartTime.tv_usec<<std::endl; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T15:32:08.950

这是一个计时器类的链接。您只需要创建计时器并将其值传递给自动重新加载或不。指向回调函数的指针。如果您希望它由线程或信号处理。如果您选择信号，那么您也必须通过信号。

[http://timerlinux.codeplex.com/](http://timerlinux.codeplex.com/)

如果你想学习更多关于定时器或信号的知识，有一本好书叫做 linux 系统编程。您只需要阅读 3 章并对其进行解释。

# php - 从 PHP 代码中自动删除注释的最佳方法

> ID：503871
> 
> 赞同：54
> 
> 时间：2009-02-02T16:48:00.560
> 
> 标签：php, comments, strip

从 PHP 文件中删除注释的最佳方法是什么？

我想做一些类似于 strip-whitespace() 的事情——但它也不应该删除换行符。

例如，

我要这个：

```
<?PHP
// something
if ($whatsit) {
    do_something(); # we do something here
    echo '<html>Some embedded HTML</html>';
}
/* another long
comment
*/
some_more_code();
?> 
```

成为：

```
<?PHP
if ($whatsit) {
    do_something();
    echo '<html>Some embedded HTML</html>';
}
some_more_code();
?> 
```

（尽管如果空行仍然保留在删除注释的位置，那就不行了。）

这可能是不可能的，因为需要保留嵌入的 HTML——这就是在谷歌上出现的问题。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-02-02T16:53:54.293

我会使用[标记器](http://www.php.net/manual/en/book.tokenizer.php)。这是我的解决方案。它应该适用于 PHP 4 和 5：

```
$fileStr = file_get_contents('path/to/file');
$newStr  = '';

$commentTokens = array(T_COMMENT);

if (defined('T_DOC_COMMENT')) {
    $commentTokens[] = T_DOC_COMMENT; // PHP 5
}

if (defined('T_ML_COMMENT')) {
    $commentTokens[] = T_ML_COMMENT;  // PHP 4
}

$tokens = token_get_all($fileStr);

foreach ($tokens as $token) {    
    if (is_array($token)) {
        if (in_array($token[0], $commentTokens)) {
            continue;
        }

        $token = $token[1];
    }

    $newStr .= $token;
}

echo $newStr; 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-02-02T17:02:22.247

用于`php -w <sourcefile>`生成去除注释和空格的文件，然后使用[PHP_Beautifier 之](http://pear.php.net/package/PHP_Beautifier)类的美化器重新格式化以提高可读性。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-02T17:06:17.467

```
$fileStr = file_get_contents('file.php');
foreach (token_get_all($fileStr) as $token ) {
    if ($token[0] != T_COMMENT) {
        continue;
    }
    $fileStr = str_replace($token[1], '', $fileStr);
}

echo $fileStr; 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-11-15T10:49:31.503

这是上面发布的函数，修改为递归地从目录及其所有子目录中的所有 PHP 文件中删除所有注释：

```
function rmcomments($id) {
    if (file_exists($id)) {
        if (is_dir($id)) {
            $handle = opendir($id);
            while($file = readdir($handle)) {
                if (($file != ".") && ($file != "..")) {
                    rmcomments($id . "/" . $file); }}
            closedir($handle); }
        else if ((is_file($id)) && (end(explode('.', $id)) == "php")) {
            if (!is_writable($id)) { chmod($id, 0777); }
            if (is_writable($id)) {
                $fileStr = file_get_contents($id);
                $newStr  = '';
                $commentTokens = array(T_COMMENT);
                if (defined('T_DOC_COMMENT')) { $commentTokens[] = T_DOC_COMMENT; }
                if (defined('T_ML_COMMENT')) { $commentTokens[] = T_ML_COMMENT; }
                $tokens = token_get_all($fileStr);
                foreach ($tokens as $token) {
                    if (is_array($token)) {
                        if (in_array($token[0], $commentTokens)) { continue; }
                        $token = $token[1]; }
                    $newStr .= $token; }
                if (!file_put_contents($id, $newStr)) {
                    $open = fopen($id, "w");
                    fwrite($open, $newStr);
                    fclose($open);
                }
            }
        }
    }
}

rmcomments("path/to/directory"); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-01-03T14:47:15.073

更强大的版本：删除文件夹中的所有评论

```
<?php
    $di = new RecursiveDirectoryIterator(__DIR__, RecursiveDirectoryIterator::SKIP_DOTS);
    $it = new RecursiveIteratorIterator($di);
    $fileArr = [];
    foreach($it as $file) {
        if(pathinfo($file, PATHINFO_EXTENSION) == "php") {
            ob_start();
            echo $file;
            $file = ob_get_clean();
            $fileArr[] = $file;
        }
    }
    $arr = [T_COMMENT, T_DOC_COMMENT];
    $count = count($fileArr);
    for($i=1; $i < $count; $i++) {
        $fileStr = file_get_contents($fileArr[$i]);
        foreach(token_get_all($fileStr) as $token) {
            if(in_array($token[0], $arr)) {
                $fileStr = str_replace($token[1], '', $fileStr);
            }
        }
        file_put_contents($fileArr[$i], $fileStr);
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-02-25T13:08:41.957

如果您已经使用[UltraEdit](https://en.wikipedia.org/wiki/UltraEdit)之类的编辑器，您可以打开一个或多个 PHP 文件，然后使用**简单的 Find&Replace ( `Ctrl`+ `R`)**和以下[Perl](https://en.wikipedia.org/wiki/Perl) [正则表达式](https://en.wikipedia.org/wiki/Regular_expression)：

```
(?s)/\*.*\*/ 
```

请注意，上面的正则表达式也会删除字符串中的注释，即，`echo "hello/*babe*/";`也`/*babe*/`将被删除。因此，如果您要从中删除评论的文件很少，这可能是一个解决方案。为了绝对确保它不会错误地替换不是注释的内容，您必须运行*Find&Replace*命令并在每次替换时批准。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-08-13T03:53:48.073

Bash 解决方案：如果要从当前目录开始的所有 PHP 文件中递归删除注释，可以在终端中编写此单行代码。（它使用`temp1`文件来存储 PHP 内容以供处理。）

**请注意，这将删除所有带有注释的空格。**

```
 find . -type f -name '*.php' | while read VAR; do php -wq $VAR > temp1  ;  cat temp1 > $VAR; done 
```

然后你应该删除`temp1`文件之后。

如果安装了[PHP_BEAUTIFER ，](https://pear.php.net/package/PHP_Beautifier/)**那么您可以获得格式良好的代码，无需**注释

```
 find . -type f -name '*.php' | while read VAR; do php -wq $VAR > temp1; php_beautifier temp1 > temp2;  cat temp2 > $VAR; done; 
```

然后删除两个文件（`temp1`和`temp2`）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-08T14:39:20.933

```
/*
* T_ML_COMMENT does not exist in PHP 5.
* The following three lines define it in order to
* preserve backwards compatibility.
*
* The next two lines define the PHP 5 only T_DOC_COMMENT,
* which we will mask as T_ML_COMMENT for PHP 4.
*/

if (! defined('T_ML_COMMENT')) {
    define('T_ML_COMMENT', T_COMMENT);
} else {
    define('T_DOC_COMMENT', T_ML_COMMENT);
}

/*
 * Remove all comment in $file
 */

function remove_comment($file) {
    $comment_token = array(T_COMMENT, T_ML_COMMENT, T_DOC_COMMENT);

    $input = file_get_contents($file);
    $tokens = token_get_all($input);
    $output = '';

    foreach ($tokens as $token) {
        if (is_string($token)) {
            $output .= $token;
        } else {
            list($id, $text) = $token;

            if (in_array($id, $comment_token)) {
                $output .= $text;
            }
        }
    }

    file_put_contents($file, $output);
}

/*
 * Glob recursive
 * @return ['dir/filename', ...]
 */

function glob_recursive($pattern, $flags = 0) {
    $file_list = glob($pattern, $flags);

    $sub_dir = glob(dirname($pattern) . '/*', GLOB_ONLYDIR);
    // If sub directory exist
    if (count($sub_dir) > 0) {
        $file_list = array_merge(
            glob_recursive(dirname($pattern) . '/*/' . basename($pattern), $flags),
            $file_list
        );
    }

    return $file_list;
}

// Remove all comment of '*.php', include sub directory
foreach (glob_recursive('*.php') as $file) {
    remove_comment($file);
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-06-18T17:39:02.813

对于 Ajax 和 JSON 响应，我使用以下 PHP 代码从 HTML/JavaScript 代码中删除注释，因此它会更小（我的代码增加了大约 15%）。

```
// Replace doubled spaces with single ones (ignored in HTML any way)
$html = preg_replace('@(\s){2,}@', '\1', $html);
// Remove single and multiline comments, tabs and newline chars
$html = preg_replace(
    '@(/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+/)|((?<!:)//.*)|[\t\r\n]@i',
    '',
    $html
); 
```

它简短而有效，但如果您的代码语法错误，它可能会产生意想不到的结果。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-01-18T19:11:04.680

在命令提示符下运行命令`php --strip file.php`（例如*cmd.exe*），然后浏览到*[WriteCodeOnline](http://www.writephponline.com/phpbeautifier)*。

在这里，*file.php*是您自己的文件。

![1](https://i.stack.imgur.com/NSdbO.png)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-05-20T10:52:45.537

在 2019 年，它可以像这样工作：

```
<?php
/*   hi there !!!
here are the comments */
//another try

echo removecomments('index.php');

/*   hi there !!!
here are the comments */
//another try
function removecomments($f){
    $w=Array(';','{','}');
    $ts = token_get_all(php_strip_whitespace($f));
    $s='';
    foreach($ts as $t){
        if(is_array($t)){
            $s .=$t[1];
        }else{
            $s .=$t;
            if( in_array($t,$w) ) $s.=chr(13).chr(10);
        }
    }

    return $s;
}

?> 
```

如果你想查看结果，让我们先在[XAMPP](https://en.wikipedia.org/wiki/XAMPP)中运行它，然后你会得到一个空白页面，但是如果你右键单击并单击查看源代码，你会得到你的 PHP 脚本......它正在加载自己并删除所有评论和标签。

我也更喜欢这个解决方案，因为我用它来加速我的框架一个文件引擎“m.php”，在*php_strip_whitespace*之后，我观察到的所有没有这个脚本的源代码都是最慢的：我做了 10 个基准测试，然后我计算了数学平均值（我认为 PHP 7 在解析时正在恢复丢失的 cr_lf，或者在这些丢失时需要一段时间）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-07-23T09:54:47.320

在接受答案之后，我也需要保留文件的行号，所以这里是接受答案的变体：

```
 /**
     * Removes the php comments from the given valid php string, and returns the result.
     *
     * Note: a valid php string must start with <?php.
     *
     * If the preserveWhiteSpace option is true, it will replace the comments with some whitespaces, so that
     * the line numbers are preserved.
     *
     *
     * @param string $str
     * @param bool $preserveWhiteSpace
     * @return string
     */
    function removePhpComments(string $str, bool $preserveWhiteSpace = true): string
    {
        $commentTokens = [
            \T_COMMENT,
            \T_DOC_COMMENT,
        ];
        $tokens = token_get_all($str);

        if (true === $preserveWhiteSpace) {
            $lines = explode(PHP_EOL, $str);
        }

        $s = '';
        foreach ($tokens as $token) {
            if (is_array($token)) {
                if (in_array($token[0], $commentTokens)) {
                    if (true === $preserveWhiteSpace) {
                        $comment = $token[1];
                        $lineNb = $token[2];
                        $firstLine = $lines[$lineNb - 1];
                        $p = explode(PHP_EOL, $comment);
                        $nbLineComments = count($p);
                        if ($nbLineComments < 1) {
                            $nbLineComments = 1;
                        }
                        $firstCommentLine = array_shift($p);

                        $isStandAlone = (trim($firstLine) === trim($firstCommentLine));

                        if (false === $isStandAlone) {
                            if (2 === $nbLineComments) {
                                $s .= PHP_EOL;
                            }

                            continue; // Just remove inline comments
                        }

                        // Stand-alone case
                        $s .= str_repeat(PHP_EOL, $nbLineComments - 1);
                    }
                    continue;
                }
                $token = $token[1];
            }

            $s .= $token;
        }
        return $s;
    } 
```

注意：这是针对 PHP 7+ 的（我不关心与旧 PHP 版本的向后兼容性）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-02T16:51:14.563

问题是，一个不太健壮的匹配算法（例如简单的正则表达式）会在它明显不应该的时候开始剥离：

```
if (preg_match('#^/*' . $this->index . '#', $this->permalink_structure)) { 
```

它可能不会影响您的代码，但最终有人会被您的脚本所吸引。因此，您将不得不使用一个比您预期的更了解该语言的实用程序。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-07-11T10:33:57.533

`php -w`或者`php_strip_whitespace($filename);`

[文件](https://php.net/manual/en/function.php-strip-whitespace.php)

# wpf - 如何在 XAML/WPF 中存储和检索多个形状？

> ID：503873
> 
> 赞同：3
> 
> 时间：2009-02-02T16:48:39.890
> 
> 标签：wpf, vb.net, xaml, resources, shape

似乎在使用 XAML / WPF 做应该简单的事情时遇到了很多问题 - 我已经使用矩形和椭圆等形状创建了一些基于 XAML 的图像来创建我需要应用程序的其他部分使用的图标 - 但我不能似乎找到了如何做到这一点 - 我似乎能够在资源字典中存储一个画布，但无法在任何其他窗口中使用它。这是如何完成的——这些是我想在整个项目中使用的两个或三个形状的简单图像！
图像还必须可调整大小 - 我知道如何存储路径，但是这些形状包含我想要保留的渐变样式，而且我不知道矩形如何转换为路径和颜色数据。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-03T13:51:00.293

您应该使用绘图并使用 KP Adrian 建议的 DrawingBrush 或 DrawingImage 和 Image 控件来显示它，但如果您不能使用绘图，则可以在 VisualBrush 中使用 Canvas。

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
<Page.Resources>
    <VisualBrush x:Key="Icon">
        <VisualBrush.Visual>
            <Canvas Width="10" Height="10">
                <Ellipse Width="5" Height="5" Fill="Red"/>
                <Ellipse Width="5" Height="5" Fill="Blue" Canvas.Left="5" Canvas.Top="5"/>
            </Canvas>
        </VisualBrush.Visual>
    </VisualBrush>
</Page.Resources>
    <Rectangle Width="100" Height="100" Fill="{StaticResource Icon}"/>
</Page> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T20:19:35.517

您不想使用 Canvas 将这些资源存储在资源字典中。您的几何图形的根可能类似于 DrawingBrush（特别是如果您使用 Expression Design 创建图像），这些是需要添加到资源字典中的项目，如下所示：

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <DrawingBrush x:Key="YourResourceKey">
<DrawingBrush.Drawing>
<DrawingGroup>
<!-- This can change a lot, but a typical XAML file exported from a Design image would have the geometry of the image here as a bunch of Paths or GeometryDrawings -->
</DrawingGroup>
</DrawingBrush.Drawing>
</ResourceDictionary> 
```

我假设您知道如何在您的应用程序中引用此资源字典。

要使用资源，您只需将它们分配给适当的属性。对于形状类型的图像，您可以将它们分配给类似 Rectangle 的 Fill 属性（还有很多其他方法，但这是一种简单的方法）。这是一个例子：

```
<Button>
   <Grid>
      <Rectangle Fill="{StaticResource YourResourceKey}" />
   </Grid>
</Button> 
```

# c# - 使用子集合的子集合过滤子集合

> ID：503876
> 
> 赞同：1
> 
> 时间：2009-02-02T16:48:50.933
> 
> 标签：c#, nhibernate

呃，我想不出更好的标题。基本上我有一个名为 MarketGroups 的类，它有一个子集合 Markgroups，它有一个 MarketTypes 的集合，而 MarketTypes 有一个 MetaGroups 的集合。

我希望能够在一个查询中加载父级，并且只返回具有 MarketTypes 且其 MetaGroup 集合中有一个特定 MetaGroup 的子 MarketGroups。

我知道这个问题：[Filter child collection returned with Aggregate Root using Nhibernate](https://stackoverflow.com/questions/247571/filter-child-collection-returned-with-aggregate-root-using-nhibernate)但**不是**我正在寻找的解决方案，我想在理想情况下作为一个查询在代码中执行此操作，但我不介意拆分它。

:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T17:06:33.480

除非您限制默认加载的子项（使用您链接到的方法），否则您必须在一个查询中加载父项，在另一个查询中加载子项。AFAIK 无法查询对象并且仅加载某些子对象。

请注意，您始终可以同时使用 MultiQuery 提交它们。

HQL 之类的（这可能有点遗漏）：

```
 select
                mt
            from 
                MarketGroup mg
            inner join
                mg.MarketTypes mt
            inner join
                mt.MetaGroups mg
            where 
               mg.ID=12312 and mg.ID=3214123 
```

# java - 如何在 Java 中以微秒精度测量时间？

> ID：503877
> 
> 赞同：23
> 
> 时间：2009-02-02T16:49:05.690
> 
> 标签：java, time

我在互联网上看到我应该使用`System.nanoTime()`，但这对我不起作用 - 它给了我毫秒精度的时间。我只需要我的函数执行前后的微秒，这样我就知道需要多长时间。我正在使用 Windows XP。

基本上，我有这段代码，例如，在 java 链表中执行 100 万到 1000 万次插入。问题是我无法正确测量精度；有时在较小的列表中插入所有内容所需的时间更少。

这是一个例子：

```
class test
{
    public static void main(String args[])
    {
        for(int k=1000000; k<=10000000; k+=1000000)
        {
            System.out.println(k);
            LinkedList<Integer> aux = new LinkedList<Integer>();
            //need something here to see the start time
            for(int i=0; i<k; i++)
                aux.addFirst(10000);
            //need something here to see the end time
            //print here the difference between both times
        }
    }
} 
```

我这样做了很多次——每个 k 都有一个外部循环执行 20 次——但结果并不好。有时进行 1000 万次插入所需的时间比 100 万次要少，因为我现在使用的没有得到正确的测量时间（System.nanoTime()）

编辑 2：是的，我使用的是 Sun JVM。

编辑3：我可能在代码中做错了什么，我会看看改变它是否符合我的要求。

编辑 4：我的错误，似乎 System.nanoTime() 有效。呸。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-02T17:02:20.627

我的猜测是，由于[`System.nanoTime()`](http://java.sun.com/javase/6/docs/api/java/lang/System.html#nanoTime())使用“最精确的可用系统计时器”，它显然在您的系统上只有毫秒精度，所以您无法获得更好的结果。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-02-02T16:55:25.303

我不清楚你到底在做什么基准测试，但总的来说，任何需要*这么*短时间运行的测试，低于 50 毫秒的精度都是相关的，*很*容易受到其他干扰。

我通常会尝试让基准测试运行至少 10 秒。我现在正在编写的框架会猜测要运行多少次迭代，这样就需要 30 秒。这意味着您不会仅仅因为其他一些进程窃取 CPU 几毫秒而得到*完全不同的结果。*

运行更长的时间**几乎总是**比尝试以更细粒度的精度进行测量更好的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-02T17:17:26.803

`System.nanoTime()` uses a counter in the CPU and is usually accurate to about 1 micro-second on Windows XP and Linux.

Note: Windows XP is often less accurate on multi-cpu machines as it doesn't compensate for different CPUs having different counters. Linux does. Note 2: It will drift relative to the System.currentTimeMillis() as it is based on the accuracy of the clock for your CPU (which doesn't need to be so accurate over a period of time), rather than the clock you have for getting the time.(which drifts less per day, but has less granularity)

In your benchmark you are basically testing the speed at which you can create new objects. Not surprisingly your results will vary dramatically based on your GC settings and how recently a GC has been performed.

Try running your tests with the following options and you should see very different results.

```
-verbosegc -XX:NewSize=128m -mx256m 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-02-18T21:42:08.550

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-02T16:57:01.917

这很奇怪。System.nanoTime() 应该可以工作。您使用的是 Sun JVM 吗？

你能重复你的操作 1000 次，然后将时间除以 1000 来找出你需要知道的内容吗？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-02T17:00:13.563

您必须重复测试数千次。有很多事情会影响您的测量，例如垃圾收集、I/O、换入/换出、就绪队列线程的大小等。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-03T15:27:00.443

如果您想要一个可靠的结果，请使用分析器。我建议使用[VisualVM](http://en.wikipedia.org/wiki/VisualVM)，它易于安装，并且从 1.6.0_07 版本开始与 JDK 捆绑在一起。

它是一个易于使用的可视化工具，集成了多个命令行 JDK 工具和轻量级分析功能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-02T17:02:31.310

可能是底层操作系统不提供具有纳秒精度的计时器。

还有一个[较旧的帖子](https://stackoverflow.com/questions/351565/system-currenttimemillis-vs-system-nanotime)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-08-19T12:05:03.307

是的，System.nanoTime 的准确性和精确度通常比 System.currentTimeMillis 好得多，但不能保证：在最坏的情况下它可能会变得一样糟糕。

ThreadMXBean.getCurrentThreadCpuTime 倾向于产生更小的时间，但它的分辨率不清楚，并且它还有更多的缺点（你真的想要 CPU 时间吗？平台相关语义，你的平台支持？）。

用所有三种技术测量时间也有一些成本，即需要时间本身，这会扭曲测量结果。成本高度依赖于平台，但通常成本(System.currentTimeMillis) << cost(System.nanoTime) << cost(ThreadMXBean.getCurrentThreadCpuTime)。

关于一般的微基准测试，请参阅

*   [如何在 Java 中编写正确的微基准测试？](https://stackoverflow.com/questions/504103/how-do-i-write-a-correct-micro-benchmark-in-java/513259#513259)
*   [使用 java 创建快速/可靠的基准测试？](https://stackoverflow.com/questions/6373550/create-quick-reliable-benchmark-with-java/7120803#7120803)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-02T17:08:50.720

这种依赖于短时间间隔的基准测试会给您带来不可靠的结果。由于 I/O、交换、进程切换、缓存、垃圾收集等外部因素，您总是会得到不同的结果。此外，JVM 会优化您的调用，因此第一次测量的事情可能比后来的调用慢。JVM 开始越来越多地优化您执行的命令。

此外，像 System.nanoTime() 这样的方法依赖于底层系统的计时器。他们可能（并且很可能）没有粒度来衡量该准确性。引用[API](http://java.sun.com/javase/6/docs/api/java/lang/System.html#nanoTime())：

> 此方法提供纳秒精度，但不一定提供纳秒精度。不保证值的变化频率。

要真正进行高精度测量，您需要访问具有保证精度的外部计时硬件。

为了使您的基准测试更加稳定，您需要多次执行它并测量比仅毫秒更大的时间间隔。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-13T15:21:16.270

对于我们最近的分析，我发现了这一点，`ThreadMXBean.getCurrentThreadCpuTime()`并且该选项`-XX:+UseLinuxPosixThreadCPUClocks`可以满足我们的需要。

有关详细信息，请参阅[http://bugs.java.com/view_bug.do?bug_id=6888526](http://bugs.java.com/view_bug.do?bug_id=6888526)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-10-14T15:31:09.737

我最终采用的“快速而肮脏”的解决方案：

```
TimeUnit.NANOSECONDS.toMicros(System.nanoTime()); 
```

更新：

我最初使用 System.nanoTime 但后来我发现它只能用于经过的时间，我最终更改了我的代码以使用毫秒或在某些地方使用：

```
TimeUnit.MILLISECONDS.toMicros(System.currentTimeMillis()); 
```

但这只会在值的末尾添加零（micros = millis * 1000）

将此答案留在这里作为“警告标志”，以防其他人想到 nanoTime :)

# c - 如何知道“errno”是什么意思？

> ID：503878
> 
> 赞同：269
> 
> 时间：2009-02-02T16:49:13.943
> 
> 标签：c, linux, errno

打电话时`execl(...)`，我得到一个`errno=2`. 这是什么意思？我怎么知道这个的意思`errno`？

* * *

## 回答 #1

> 赞同：397
> 
> 时间：2009-02-02T17:23:42.487

您可以使用[`strerror()`](http://en.cppreference.com/w/c/string/byte/strerror)来获取错误号的人类可读字符串。这与打印的字符串相同，[`perror()`](http://en.cppreference.com/w/c/io/perror)但如果您将错误消息格式化为标准错误输出以外的其他内容，它会很有用。

例如：

```
#include <errno.h>
#include <string.h>

/* ... */

if(read(fd, buf, 1)==-1) {
    printf("Oh dear, something went wrong with read()! %s\n", strerror(errno));
} 
```

Linux 还支持显式线程安全变体`strerror_r()`。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2009-02-02T16:59:27.043

您可以使用以下单行`perror`代码检索系统上的完整值列表，而不是在您获得的任何错误代码上运行：`errno`

`cpp -dM /usr/include/errno.h | grep 'define E' | sort -n -k 3`

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2011-10-05T16:08:04.533

在 Linux 上，还有一个非常简洁的工具可以立即告诉每个错误代码的含义。在 Ubuntu 上：`apt-get install errno`.

然后，例如，如果您想获取错误类型 2 的描述，只需`errno 2`在终端中输入。

与`errno -l`您一起获得包含所有错误及其描述的列表。比以前的海报提到的其他方法要容易得多。

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2016-10-10T02:50:11.597

这是`errno -l`重新格式化的输出以提高可读性：

```
 1   EPERM             Operation not permitted
  2   ENOENT            No such file or directory
  3   ESRCH             No such process
  4   EINTR             Interrupted system call
  5   EIO               Input/output error
  6   ENXIO             No such device or address
  7   E2BIG             Argument list too long
  8   ENOEXEC           Exec format error
  9   EBADF             Bad file descriptor
 10   ECHILD            No child processes
 11   EAGAIN            Resource temporarily unavailable
 11   EWOULDBLOCK       Resource temporarily unavailable
 12   ENOMEM            Cannot allocate memory
 13   EACCES            Permission denied
 14   EFAULT            Bad address
 15   ENOTBLK           Block device required
 16   EBUSY             Device or resource busy
 17   EEXIST            File exists
 18   EXDEV             Invalid cross-device link
 19   ENODEV            No such device
 20   ENOTDIR           Not a directory
 21   EISDIR            Is a directory
 22   EINVAL            Invalid argument
 23   ENFILE            Too many open files in system
 24   EMFILE            Too many open files
 25   ENOTTY            Inappropriate ioctl for device
 26   ETXTBSY           Text file busy
 27   EFBIG             File too large
 28   ENOSPC            No space left on device
 29   ESPIPE            Illegal seek
 30   EROFS             Read-only file system
 31   EMLINK            Too many links
 32   EPIPE             Broken pipe
 33   EDOM              Numerical argument out of domain
 34   ERANGE            Numerical result out of range
 35   EDEADLK           Resource deadlock avoided
 35   EDEADLOCK         Resource deadlock avoided
 36   ENAMETOOLONG      File name too long
 37   ENOLCK            No locks available
 38   ENOSYS            Function not implemented
 39   ENOTEMPTY         Directory not empty
 40   ELOOP             Too many levels of symbolic links
 42   ENOMSG            No message of desired type
 43   EIDRM             Identifier removed
 44   ECHRNG            Channel number out of range
 45   EL2NSYNC          Level 2 not synchronized
 46   EL3HLT            Level 3 halted
 47   EL3RST            Level 3 reset
 48   ELNRNG            Link number out of range
 49   EUNATCH           Protocol driver not attached
 50   ENOCSI            No CSI structure available
 51   EL2HLT            Level 2 halted
 52   EBADE             Invalid exchange
 53   EBADR             Invalid request descriptor
 54   EXFULL            Exchange full
 55   ENOANO            No anode
 56   EBADRQC           Invalid request code
 57   EBADSLT           Invalid slot
 59   EBFONT            Bad font file format
 60   ENOSTR            Device not a stream
 61   ENODATA           No data available
 62   ETIME             Timer expired
 63   ENOSR             Out of streams resources
 64   ENONET            Machine is not on the network
 65   ENOPKG            Package not installed
 66   EREMOTE           Object is remote
 67   ENOLINK           Link has been severed
 68   EADV              Advertise error
 69   ESRMNT            Srmount error
 70   ECOMM             Communication error on send
 71   EPROTO            Protocol error
 72   EMULTIHOP         Multihop attempted
 73   EDOTDOT           RFS specific error
 74   EBADMSG           Bad message
 75   EOVERFLOW         Value too large for defined data type
 76   ENOTUNIQ          Name not unique on network
 77   EBADFD            File descriptor in bad state
 78   EREMCHG           Remote address changed
 79   ELIBACC           Can not access a needed shared library
 80   ELIBBAD           Accessing a corrupted shared library
 81   ELIBSCN           .lib section in a.out corrupted
 82   ELIBMAX           Attempting to link in too many shared libraries
 83   ELIBEXEC          Cannot exec a shared library directly
 84   EILSEQ            Invalid or incomplete multibyte or wide character
 85   ERESTART          Interrupted system call should be restarted
 86   ESTRPIPE          Streams pipe error
 87   EUSERS            Too many users
 88   ENOTSOCK          Socket operation on non-socket
 89   EDESTADDRREQ      Destination address required
 90   EMSGSIZE          Message too long
 91   EPROTOTYPE        Protocol wrong type for socket
 92   ENOPROTOOPT       Protocol not available
 93   EPROTONOSUPPORT   Protocol not supported
 94   ESOCKTNOSUPPORT   Socket type not supported
 95   ENOTSUP           Operation not supported
 95   EOPNOTSUPP        Operation not supported
 96   EPFNOSUPPORT      Protocol family not supported
 97   EAFNOSUPPORT      Address family not supported by protocol
 98   EADDRINUSE        Address already in use
 99   EADDRNOTAVAIL     Cannot assign requested address
100   ENETDOWN          Network is down
101   ENETUNREACH       Network is unreachable
102   ENETRESET         Network dropped connection on reset
103   ECONNABORTED      Software caused connection abort
104   ECONNRESET        Connection reset by peer
105   ENOBUFS           No buffer space available
106   EISCONN           Transport endpoint is already connected
107   ENOTCONN          Transport endpoint is not connected
108   ESHUTDOWN         Cannot send after transport endpoint shutdown
109   ETOOMANYREFS      Too many references: cannot splice
110   ETIMEDOUT         Connection timed out
111   ECONNREFUSED      Connection refused
112   EHOSTDOWN         Host is down
113   EHOSTUNREACH      No route to host
114   EALREADY          Operation already in progress
115   EINPROGRESS       Operation now in progress
116   ESTALE            Stale file handle
117   EUCLEAN           Structure needs cleaning
118   ENOTNAM           Not a XENIX named type file
119   ENAVAIL           No XENIX semaphores available
120   EISNAM            Is a named type file
121   EREMOTEIO         Remote I/O error
122   EDQUOT            Disk quota exceeded
123   ENOMEDIUM         No medium found
124   EMEDIUMTYPE       Wrong medium type
125   ECANCELED         Operation canceled
126   ENOKEY            Required key not available
127   EKEYEXPIRED       Key has expired
128   EKEYREVOKED       Key has been revoked
129   EKEYREJECTED      Key was rejected by service
130   EOWNERDEAD        Owner died
131   ENOTRECOVERABLE   State not recoverable
132   ERFKILL           Operation not possible due to RF-kill
133   EHWPOISON         Memory page has hardware error 
```

我在 Vim 中使用 tabularise 来对齐列：

```
:%Tab /^[^ ]*\zs /r1l1l1
:%Tab /^ *[^ ]* *[^ ]*\zs /l1 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2009-02-02T16:51:56.497

错误代码 2 表示“找不到文件/目录”。通常，您可以使用[perror](http://en.cppreference.com/w/c/io/perror)函数打印人类可读的字符串。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-02-02T17:25:02.063

有一些处理`errno`s 的有用函数。（为了清楚起见，这些是内置的`libc`——我只是提供示例实现，因为有些人发现阅读代码比阅读英语更清晰。）

```
#include <string.h>
char *strerror(int errnum);

/* you can think of it as being implemented like this: */
static char strerror_buf[1024];
const char *sys_errlist[] = {
    [EPERM]  = "Operation not permitted",
    [ENOENT] = "No such file or directory",
    [ESRCH]  = "No such process",
    [EINTR]  = "Interrupted system call",
    [EIO]    = "I/O error",
    [ENXIO]  = "No such device or address",
    [E2BIG]  = "Argument list too long",
    /* etc. */
};
int sys_nerr = sizeof(sys_errlist) / sizeof(char *);
char *strerror(int errnum) {
    if (0 <= errnum && errnum < sys_nerr && sys_errlist[errnum])
        strcpy(strerror_buf, sys_errlist[errnum]);
    else
        sprintf(strerror_buf, "Unknown error %d", errnum);
    return strerror_buf;
} 
```

`strerror`返回一个字符串，描述您传递给它的错误号。注意，这不是线程或中断安全的；可以自由地重写字符串并在下一次调用时返回相同的指针。`strerror_r`如果您需要担心这一点，请使用。

```
#include <stdio.h>
void perror(const char *s);

/* you can think of it as being implemented like this: */
void perror(const char *s) {
    fprintf(stderr, "%s: %s\n", s, strerror(errno));
} 
```

`perror`打印出你给它的消息，加上一个描述 current 的字符串`errno`，到标准错误。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-10-28T10:05:28.950

这比在 中查找代码要快`errno.h`，比此处发布的大多数解决方案要短，并且不需要安装第三方工具：

`perl -E 'say $!=shift' 2`

产量

`No such file or directory`

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-02-02T16:50:51.133

这是[文档](http://www.cl.cam.ac.uk/cgi-bin/manpage?3+errno)。那应该告诉您它的含义以及如何处理它们。您应该避免使用数值并使用其中列出的常量，因为不同系统之间的数字可能会发生变化。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2011-11-01T19:19:39.917

```
#include <errno.h> 
#include <stdio.h> 
#include <stdlib.h> 

int main(int i, char *c[]) { 
  if (i != 2)  
    fprintf(stderr, "Usage: perror errno\n"); 
  else { 
    errno = atoi(c[1]); 
    perror(""); 
  } 
  exit(0); 
} 
```

适用于 Solaris。
`cc perror.c -o perror`<< 使用这一行来编译它

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-03T10:50:08.893

我使用以下脚本：

```
#!/usr/bin/python

import errno
import os
import sys

toname = dict((str(getattr(errno, x)), x) 
              for x in dir(errno) 
              if x.startswith("E"))
tocode = dict((x, getattr(errno, x)) 
              for x in dir(errno) 
              if x.startswith("E"))

for arg in sys.argv[1:]:
    if arg in tocode:
        print arg, tocode[arg], os.strerror(tocode[arg])
    elif arg in toname:
        print toname[arg], arg, os.strerror(int(arg))
    else:
        print "Unknown:", arg 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-11-06T00:47:26.747

键入`sudo apt-get install moreutils`您的 shell，然后在安装后键入`errno 2`. 您还可以使用`errno -l`所有错误编号，或通过管道将其仅查看文件编号`grep`，如下所示：`errno -l | grep file`.

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-02T16:51:00.477

称呼

```
perror("execl"); 
```

万一出错。

样本：

```
if(read(fd, buf, 1)==-1) {
    perror("read");
} 
```

和的联机帮助页`errno(3)`也`perror(3)`很有趣...

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-02T16:50:45.220

它的意思是：

> 找不到文件或目录。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-02T17:15:54.700

当您使用[strace](https://en.wikipedia.org/wiki/Strace)（在 Linux 上）运行二进制文件时，它将输出系统调用的返回值以及错误号的含义。这有时可能对您有用。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-05-22T08:20:45.543

我的 .bashrc 文件中有以下函数 - 它从头文件中查找 errno 值（可以是`/usr/include/errno.h`,`/usr/include/linux/errno.h`等）

如果机器上安装了头文件，它就可以工作；-)

通常头文件有错误+接下来是注释中的解释；以下内容：

./asm-generic/errno-base.h:#define EAGAIN 11 /* 再试一次 */

```
function errno()
{
    local arg=$1

    if [[ "x$arg" == "x-h" ]]; then
        cat <<EOF
        Usage: errno <num>
        Prints text that describes errno error number
        EOF
    else
        pushd /usr/include
        find . -name "errno*.h" | xargs grep   "[[:space:]]${arg}[[:space:]]"
        popd
    fi
} 
```

# svn - 与自己协调的版本控制

> ID：503892
> 
> 赞同：7
> 
> 时间：2009-02-02T16:52:05.747
> 
> 标签：svn, git, version-control

对于业余时间的编程，我有一台台式机和一台笔记本电脑（都是 Mac，尽管我怀疑这个问题会有所不同）。我在他们两个上都安装了 VMware，并使用 Linux 映像来运行我的代码。它们是相同的图像，所以我在两个地方都有相同的环境。

诀窍是我喜欢对我的所有编码使用版本控制，即使我没有与其他人协调。我想在我使用的任何系统上查看我的代码的最新版本。

我不想一直依赖网络访问——我可能在没有 Wi-Fi 的地方编码（是的，这种情况很少见，但有些地方仍处于石器时代）。我正在考虑使用 git，但如果我在本地有可用的存储库，SVN 之类的东西也会这样做。或者，笔记本电脑可能成为 SVN 服务器，桌面访问它。

以前有人做过这种事情吗？任何陷阱/陷阱/经验教训？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T16:55:17.613

如果您始终无法访问网络，我强烈推荐 git。

[但是，如果您仍然需要使用 subversion 存储库，您仍然可以通过使用git-svn](http://www.viget.com/extend/effectively-using-git-with-subversion/)获得两全其美的效果。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-02T17:19:24.257

好吧，我绝对推荐使用分布式系统而不是 Subversion。这将满足您不依赖网络访问的要求，并且可能更适合您的工作流程。分布式 VCS 的主要选择是[git](http://git-scm.com/)、[Mercurial](http://www.selenic.com/mercurial/wiki/)（也称为“hg”）和[Bazaar](http://bazaar-vcs.org/)（或“bzr”）。我个人的偏好是 Mercurial，但它们都相当可比。

然而，Mercurial 确实比其他人拥有的一件事（这对您的情况非常有帮助）是“hg serve”命令。你可以在这里阅读：[与“hg serve”的非正式分享](http://hgbook.red-bean.com/hgbookch6.html#x10-1220006.4)。基本上，它设置了一个非常简单的（临时）服务器，以允许通过网络拉取您的存储库。我一直使用它来保持台式机和笔记本电脑之间的代码同步。如果我在笔记本电脑上进行了一些更改，我只需在那里运行“hg serve”，然后从桌面运行“hg pull”，反之亦然，如果我一直在桌面上工作。

所以总的来说，我肯定会建议研究分布式系统，我认为他们会在设置你想要的那种环境方面做得最好。网络上有大量关于使用它们的信息。我没有花太多时间与其他人在一起，但是如果您想尝试 Mercurial，[这本免费的在线书籍几乎涵盖了您入门所需的所有内容](http://hgbook.red-bean.com/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T16:55:47.190

无论您做什么，请确保定期备份您的存储库。如果您的笔记本电脑包含您的存储库，则尤其如此。您还需要考虑如果您的笔记本电脑被盗会发生什么。使用 git 并将存储库留在桌面上可能会更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T17:02:30.237

作为已经提到的 Git 的替代品，我强烈推荐[Bazaar](http://bazaar-vcs.org/)。它和 git 一样是一个分布式 VCS，但有一些区别。

对于（当然有些偏颇）比较，请查看[此页面](http://bazaar-vcs.org/BzrVsGit)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T17:29:08.340

如果您追求简单（设置），SVN 很好。它可以在没有网络连接的情况下工作，因为您的整个历史记录都保存在每台同步的 PC 上，而且 SVN+SSH 的设置很简单。它使用 SSH 的内置功能来运行程序，因此，如果您设置了 SSH 服务器，您只需创建一个存储库，一切正常……无需任何服务器设置。

这也可以作为您的备份，因为您在与之同步的每台计算机上都有整个存储库。

分布式版本控制系统也很有趣，但我认为前期投资更高，但它的优点是您可以在不连接的情况下保存到存储库（如果您单独工作，则不太重要，但可以在任何地方进行检查点和回滚可以发挥它的优势）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T16:57:27.937

当您无权访问存储库时，使用 SVN 会变得非常尴尬。由于我在一台计算机上完成了所有开发工作，因此我在 SVN 上做得很好，但您可能会发现它并不容易。据我所知，这正是 git 旨在处理的问题 - 它允许您进行在本地副本中注册的提交，然后在您访问它时将它们全部上传到存储库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T17:00:22.237

您可以考虑购买一台 SVN 主机——它们的价格相当实惠，并且让您不必为自己处理网络连接而烦恼：

[http://www.google.com/search?hl=en&q=svn+hosting&btnG=Google+Search&aq=f&oq=](http://www.google.com/search?hl=en&q=svn+hosting&btnG=Google+Search&aq=f&oq=)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-02T17:34:24.913

我最喜欢的 VCS 是[darcs](http://darcs.net)，因为它支持补丁挑选。它是一个分布式 VCS，非常易于使用。

# .net - 嵌套框架 (WPF) - 如何使外框的导航栏忽略内框？

> ID：503893
> 
> 赞同：2
> 
> 时间：2009-02-02T16:52:13.157
> 
> 标签：.net, wpf

当单击某些顶级按钮时，我的应用程序有一个加载/导航的框架。问题是，其中一个托管页面有自己的框架，并且与外部框架的导航栏混淆（单击向后和向前导航内部框架以及外部框架）。

有没有办法让外框的导航控件只关心它的直接内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T17:03:20.843

原来有一个 frame 属性可以很好地处理这个问题：

```
ContentFrame.JournalOwnership = JournalOwnership.OwnsJournal; 
```

在内部框架上设置它会强制它使用自己的日志，而不是使用默认值（JournalOwnership.Automatic，如果框架托管在另一个框架或 NavigationWindow 中，则与 JournalOwnership.UsesParentJournal 相同）。

# asp.net - 在 MVC 中处理 ASP.Net 自定义控件

> ID：503894
> 
> 赞同：0
> 
> 时间：2009-02-02T16:53:13.310
> 
> 标签：asp.net, asp.net-mvc, custom-server-controls

我在互联网上环顾四周，试图回答这个问题。不过好像有点复杂！似乎提出了各种不同的主题，例如 HtmlHelper 和其他东西。

基本上。如何在 MVC 中使用自定义控件？以一种避免做任何不受欢迎的事情的方式。

另外，使用 MVC 是否必须在页面中添加一些简单的逻辑？这不是我们应该远离的吗？

更新：因此，您似乎不能使用依赖于 MVC 所取消的任何内容的控件，例如回发事件和视图状态。那你能自己做吗？一个当然只进行渲染的控件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T17:02:23.137

可以使用 ASP.NET 控件吗？也许。如果控件不使用 ViewState 或回发事件，它可能会起作用。例如，LoginView 控件工作得很好。Telerik 通过一些控件支持 ASP.NET MVC。另一方面，如果控件需要 ViewState 或回发，那么它就无法工作。具有数据绑定的控件并不理想，因为您通常必须使用他背后的代码。但是，如果您在后面添加代码，它们将起作用。

另一方面，不了解 ASP.NET 的控件（例如 jQuery UI 控件）工作得很好。

不，您不必将逻辑放在页面中。你也不要把它放在页面后面的代码上。相反，[使用辅助方法](http://blog.wekeroad.com/blog/some-thoughts-on-oxite/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T16:59:44.420

关于第二个问题，页面正是视图逻辑应该去的地方。任何其他逻辑都应该在您的控制器或模型中。

我不确定自定义控件是什么意思。您可以拥有通过部分呈现的 ViewUserControls 以重用视图代码。如果您谈论的是为 Web 表单构建的第三部分控件，它们很可能不会起作用——至少暂时不会。但是，如果您绝对必须拥有它们，则可以在同一个站点中将 MVC 与传统 Web 表单混合使用。

# asp.net - 我应该在哪里使用资源文件？

> ID：503897
> 
> 赞同：0
> 
> 时间：2009-02-02T16:53:40.160
> 
> 标签：asp.net, resources

我应该直接在aspx页面中使用资源文件吗

```
<asp:Literal ID="userManagementSave" Text="<%$ Resources: save_lbl %>" runat="server" /> 
```

或在代码中创建一个子，例如

```
private sub setLang()
   userManagementSave.text = GetLocalResourceObject("save_lbl")
end sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T17:00:09.007

我喜欢引用内联文本，因为不在后面的代码中更容易更新。

由于您追求的唯一功能是内容输出，因此您可以内联进行。如果您正在做更复杂的事情，那么后面代码中的方法会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T17:13:00.353

恩恩的回答很好。通常，当您维护代码时，如果您必须修复页面上的某些内容，您将首先开始查找 aspx 文件，只需找到控件的名称即可。如果该代码是内联的，您会立即找到它，而不必四处寻找。

如果您发现自己在 aspx 中编写的代码比此属性分配多，请至少移动到代码隐藏，因为在 aspx 中代码更难调试和读取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T21:56:22.527

我目前正在使用 VSTS 2008，但我似乎记得 VS2005 中也提供了此功能......

基本上使用生成本地资源的内置支持

*   为 aspx 编写 Html
*   使用合理的字符串设置所有属性（例如 lblName.Text = "Name"）
*   确保在设计器中打开了 aspx 页面
*   工具 --> 生成本地资源
*   在名为 App_LocalResources 的子目录中会自动生成一个资源文件。资源的值设置为 Html 中提供的文本

NB Html 已更新为包含元标记

这是一种有用的技术，因为它为控件的所有属性生成资源，这些属性需要提供以使页面完全多语言/所有字符串存储在资源中，即图像上的 alt - 永远忘记那个！如果您不想，您不必为所有资源键提供文本。

# c# - 我对 IComparable 和集合排序方法有疑问

> ID：503898
> 
> 赞同：7
> 
> 时间：2009-02-02T16:53:42.967
> 
> 标签：c#, .net, generics, inheritance

好的，所以我有一个类似于下面代码的场景，我有一个实现 IComparable 的父类和一个子类。

```
class Parent : IComparable<Parent> 
class Child : Parent

Child a = new Child();
Child b = new Child();
a.CompareTo(b); 
```

现在上述工作正常，我可以将两个子对象相互比较没问题

```
List<Child> l = new List<Child>();
l.Add(b);
l.Add(a);
l.Sort(); 
```

尽管出现 InvalidOperationException，但上述操作失败了。有人可以解释为什么当子类确实实现 IComparable 接口时这种排序不起作用，或者至少在我看来它确实如此。

好的，这是我的实际父类的 CompareTo 实现

```
 public int CompareTo(IDType other)
 {
       return this.Name.ToString().CompareTo(other.ToString());
 } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T17:00:38.290

您的类型实现`IComparable<Parent>`而不是`IComparable<Child>`. 正如[排序的 MSDN 文档](http://msdn.microsoft.com/en-us/library/b0zbh7b6.aspx)所说，如果“默认比较器 Comparer(T).Default 找不到 IComparable(T) 通用接口或类型 T 的 IComparable 接口的实现”，它将抛出 InvalidOperationException。实际上它不能，其中 T 是 Child。如果你试着把它做成一个`List<Parent>`你可能会发现它很好。

编辑：或者（最好是 IMO）实施`IComparable<Child>`. 目前还不清楚是否可以将一个孩子与另一个孩子进行明智的比较。实现`IComparable<Child>`——即使该实现只是遵循基本实现——也宣传了可比性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T17:05:22.257

我试了一下，遇到了同样的错误。我的猜测是，因为你有一个`List<Child>`它正在寻找实现的人`IComparable<Child>`，而不是`IComparable<Parent>`.

如果您将集合更改为`List<Parent>`，则似乎可以正常工作。或者，让 Child 实现`IComparable<Child>`（它可以只委托给 Parent 的实现）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T17:05:35.173

我的猜测是这与协方差/逆变的东西有关。我这么说的原因是因为这失败了，就像你说的：

```
 public class Parent : IComparable<Parent>
    {
        public int Age { get; set; }

        public int CompareTo(Parent other)
        {

            return this.Age.CompareTo(other.Age);
        }

    }

    public class Child : Parent
    {
        public string Name { get; set; }
    } 
```

但是，当我更改父级以实现非通用 IComparable 并执行此操作时，它起作用了：

```
 public class Parent : IComparable
    {
    public int Age { get; set; }

    public int CompareTo(object other)
    {
        Parent p = other as Parent;
        return this.Age.CompareTo(p.Age);
    }

}

    public class Child : Parent
    {
        public string Name { get; set; }
    } 
```

我用以下代码对其进行了测试：

```
 List<Child> c = new List<Child>();
    c.Add(new Child { Age = 10, Name = "Alex" });
    c.Add(new Child { Age = 6, Name = "Jack" });
    c.Add(new Child { Age = 15, Name = "Bob" });

    c.Sort(); 
```

# database - 通用数据库监控工具

> ID：503900
> 
> 赞同：0
> 
> 时间：2009-02-02T16:54:42.263
> 
> 标签：database, monitoring, utility

似乎*应该*存在这样的东西，但我从未听说过它，并且会发现这样的实用程序非常有用。很多时候，我开发的应用程序都有数据库支持——SQL Server 或 Oracle。在开发过程中，我们鼓励应用程序的最终用户测试该站点——我可以通过在数据库中查找条目来验证这一点……如果有条目，他们一直在测试……如果没有，他们没有。

我想要的是一个工具/实用程序，可以为我做这个检查。我将指定数据库和连接参数，并且该工具将定期汇集数据库（基于我指定的值）并在数据库中有任何新活动时提醒我（也许它会在系统托盘中弹出通知）。我还可以指定多个数据库场景以在该工具中进行监控。如果存在这样的应用程序，我就不必手动对数据库运行查询以获取新活动。我知道 SQL Profiler，但是当我查看它时，它似乎对我想做的事情有点过分（而且它也不会进行 Oracle DB 监控）。此外，要使用 SQL Profiler，您必须是数据库的管理员。我需要监控只有只读帐户的数据库。

有人知道这样的工具是否存在吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T17:11:51.777

Sounds like something really easy to write yourself. Just query the database schema, then do a select count(*) or select max(lastUpdateTime) query on each table and save the result. If something is different send yourself an email. JDBC in Java gives you access to the schema information in a cross-database manner. Don't know about ADO.

# visual-studio - 如何不在生成的命名空间中包含 Visual Studio 项目文件夹名称

> ID：503908
> 
> 赞同：37
> 
> 时间：2009-02-02T16:56:00.390
> 
> 标签：visual-studio, namespaces, solution

如何防止将 VS 项目中解决方案文件夹的名称附加到为添加到解决方案文件夹的新项目生成的命名空间中？

示例：VS 解决方案中的 C# 项目 C# 项目属性中设置的默认命名空间：“BigClient.Domain”

如果在这个项目中创建一个名为“MySpecialStuff”的解决方案文件夹，然后将一个新类添加到“MySpecialStuff”解决方案文件夹中，VS 会创建一个具有“BigClient.Domain.MySpecialStuff”命名空间的新 .cs 文件。我想找到一个允许新添加的类的命名空间仅保留“BigClient.Domain”的“项目级”命名空间而不是 VS 将“MySpecialStuff”解决方案文件夹名称附加到命名空间的方法。

我似乎记得读过某人的博客文章，这是可能的（通过 VS 中的选项/设置或注册表设置），但我不记得现在在哪里或如何想要它:)

如果不同 VS 版本的答案 = 不同，我的平台是 VS 2008。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T17:02:20.843

如果您安装了 ReSharper，请在目录设置 (F4) 上将 Namespace Provider 设置为 false。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T20:46:39.427

创建一个新的类模板或更改 Visual Studio 的类模板。有关如何执行此操作，请参阅 MSDN 文档。在模板文件中，您很快就会看到插入“安全”命名空间名称的行。

# javascript - 表单提交上的 JavaScript

> ID：503911
> 
> 赞同：0
> 
> 时间：2009-02-02T16:56:48.437
> 
> 标签：javascript, coldfusion

我正在提交一个 ColdFusion 表单，我想在运行我的 ColdFusion 代码以根据需要处理表单之前运行一些 JavaScript 来检查字段验证。

我怎样才能做到这一点？表单通过验证后，我在 JS 中如何调用我的 .cfm 文件？

谢谢！

-杰森

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T17:34:08.067

你需要

```
<form name="myform" action="myserverscript.cfm" onsubmit="return validate()"> 
```

如果您返回 true 表单提交， false 它不会

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-03T17:15:35.387

我希望你也在服务器端进行验证。永远不要仅仅依靠 javascript 来清理您的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T17:10:12.857

JQuery - [http://jquery.com/](http://jquery.com/) jquery 的验证插件 - [http://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

在 jquery.com 上做大量示例非常简单

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T17:05:47.640

您可以将`onclick`事件附加到输入按钮，例如：

```
<input type="submit" value="Submit" onClick="validate()"> 
```

然后 validate 方法将负责检查表单值。`true`如果表单有效，则validate 方法应该返回，因此`committing`表单提交。如果返回`false`，则不提交表单。这就是它适用于 HTML、JavaScript 和表单的方式。

此外，由*标记*链接的文档应该可以进一步帮助您。

# c++ - 从2个向量中提取元素？

> ID：503916
> 
> 赞同：0
> 
> 时间：2009-02-02T16:57:48.247
> 
> 标签：c++, vector, iterator, containers

我有 2 个向量，其中一个具有 vec1{e1,e2,e3,e4}，另一个具有 vec2 {e2,e4,e5,e7}

如何有效地从上述向量中获取三个向量，以使 1.具有仅在 vec1 中可用的元素，类似地 2 仅具有 vec2 元素和 3.具有公共元素

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T17:04:32.523

`std::set_intersection`如果两个向量都已排序，应该可以解决问题：http: [//msdn.microsoft.com/en-us/library/zfd331yx.aspx](http://msdn.microsoft.com/en-us/library/zfd331yx.aspx)

```
std::set_intersection(vec1.begin(), vec1.end(), vec2.begin(), vec2.end(), std::back_inserter(vec3)); 
```

自定义谓词也可用于比较：

```
std::set_intersection(vec1.begin(), vec1.end(), vec2.begin(), vec2.end(), std::back_inserter(vec3), my_equal_functor()); 
```

如果它们没有排序，你当然可以先排序，或者你可以遍历 vec1，对于每个元素，使用 std::find 来查看它是否存在于 vec2 中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T17:15:23.830

您要的是其他两者`vec3`的*交集*。Jalf 演示了如何`vec3`使用[header中](http://dinkumware.com/manuals/?manual=compleat&page=algorith.html)[的](http://dinkumware.com/manuals/?manual=compleat&page=algorith.html)`std::set_intersection`函数进行填充。但请记住，要使 set 函数起作用，**向量必须是 sorted**。[`<algorithm>`](http://dinkumware.com/manuals/?manual=compleat&page=algorith.html)

 **那么你想要`vec1`和被自己和`vec2`被*区别*`vec3`。在集合符号中：

```
vec1 := vec1 \ vec3;
vec2 := vec2 \ vec3; 
```

您可以使用该`std::set_difference`功能，但不能使用它来就地修改向量。您必须计算另一个向量来保持差异：

```
std::vector<foo> temp;
std::set_difference(vec1.begin(), vec1.end(),
                    vec3.begin(), vec3.end(),
                    std::back_inserter(temp));
vec1 = temp;
temp.clear();
std::set_difference(vec2.begin(), vec2.end(),
                    vec3.begin(), vec3.end(),
                    std::back_inserter(temp));
vec2 = temp; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T17:08:53.530

如果元素数量较少，您可以使用易于实现且运行时间为 O(n ^(2 ) 的简单方法。)

如果您有大量元素，您可以从其中一个构建哈希表并在其中查找其他向量的元素。或者，您可以对其中一个进行排序并对其进行二分搜索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T17:09:40.627

您描述的问题是矢量交集。这取决于输入向量的大小。

如果两个向量的大小彼此接近，则最好进行合并（如合并排序）。如果一个向量比另一个小得多，请执行以下操作： 对于较小向量的每个元素，使用二进制搜索在较大向量中搜索该元素。

这是信息检索中的一个常见问题，您必须与倒排索引相交。这方面有一些研究论文。

# html - 可以在同一页面上使用多个 h1 标签，但样式不同吗？

> ID：503925
> 
> 赞同：45
> 
> 时间：2009-02-02T17:00:19.583
> 
> 标签：html, css, seo

我有一个网页，我在各种 DIV 中多次使用 h1 标签，并且我将每个 div 的 h1 样式设置为适当的大小。

例如...

```
#content h1 {
  font-size:22px;
}

#left-nav h1 {
  font-size:14px;
}

#content .recent-news h1 {
  font-size:16px;
} 
```

这可以吗？我担心搜索引擎优化。

解决此问题的最佳方法是什么？还是我什么都不担心？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2010-04-29T15:08:14.927

来自 Google 的 Matt Cutts 回答了[一个页面上的多个 H1：好还是坏？](http://www.youtube.com/watch?v=GIn5qJKU8VM)（2009 年 3 月 5 日）与：

> 好吧，如果有多个部分是合乎逻辑的，那么拥有多个部分并不是那么糟糕，你知道多个`h1`s。我会注意过度。如果您的整个页面是`h1`，那看起来很克里蒂，对吧？所以不要做所有事情`h1`然后你 CSS 让它看起来像普通文本，因为我们看到一些竞争对手抱怨如果用户关闭 CSS 或 CSS 不加载，它看起来真的很糟糕。所以，你知道，这里有一点是可以的`h1`，然后可能一个页面上有两个部分，所以也许这里有一点`h1`。
> 
> 但是你真的应该将它用于标题或标题，这就是意图。不要只是`h1`在页面上随处乱扔。因为我可以告诉你，如果你只是`h1`在页面上到处乱扔东西，人们就会试图滥用它，所以我们的算法会尝试考虑到这一点，所以它对你并没有那么好。所以我会在有意义且更谨慎的地方使用它，但你可以多次使用它。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-02T17:04:46.750

请记住，您的 h1 用于指示上下文，而不是布局。所以，在一个页面上有几个本质上没有错。

在这个特定示例中，您需要确定左侧导航 h1 是否与内容 h1 和最近新闻 h1 具有相同的上下文重要性。如果您的脑海中存在清晰的层次结构，请使用您的标题标签来演示它。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-02T17:13:00.637

在我看来，你不必担心，这样做是可以的。

H1 将您的部分内容指定为一级标题。因此，如果您的导航 div 中有一级标题（例如`<H1>Navigation Menu</H1>`），那当然应该是`#nav h1`.

如果您的内容中应该有多个 H1，取决于：如果您有一个博客并且每个条目都有自己的标题，那么这些将是 H1。但是，如果您的博客本身有标题（例如`<H1>My Blog!</H1>`），则博客条目标题应该是 H2。

但这只是理论。寻找可读的语义标记。你最好通过查看你的 html 并问自己：'它可读吗？如果我用另一种方式做，可读性会提高吗？答案因项目而异。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-02T17:03:33.947

一般来说，每页应该只有一个 h1，并且 h1 应该简洁地代表该页面上的内容。只要您愿意使用 CSS 进行样式设置，找出哪个级别的标题（h2、h3、h4 等）可以正确表示您要使用的标题，然后改用样式。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-02T17:04:32.993

从语义上讲，我更喜欢在页面上使用一个 h1，主要用于页面的标题。对 SEO 而言，这可能并不重要，而且随着 html 与 HTML5 一起使用的方式，通用`header`标签将使其更简单，并且该参数已过时。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T05:07:45.110

我不喜欢多个`H1`s 的想法。`H1`是顶层，最重要的标题，页面基本上是关于该主题的。如果您有一个同样重要的第二个主题，请不要将其放在另一个`H1`标签中，而是将其放在另一个页面中。这是应得的，对吧？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-15T04:45:22.797

在尝试回答同一个问题时，我发布了这个问题，其中可能包含一些有用的信息。我担心在不同的地方使用相同的 H1、H2、H3 是，除非您总是像在示例中那样指定“父”样式* - 那么您可能会遇到问题。

> [决定如何为 H1、H2、H3 等创建 CSS 的困境。](https://stackoverflow.com/questions/647295/dilemma-in-deciding-how-to-create-css-for-h1-h2-h3-etc/647296#647296)

* 那就是说你永远不会自己定义'h1'

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-26T02:23:51.623

我尝试在页面上只有一个 H1，并且几乎但稍微从标题标签的内容重新排列/H1 是单个页面的主要思想，其他所有内容都应该是 h2 标签，并且更低... .

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-27T04:18:09.053

如果是关于 seo 最好使用 h1 标签如果你只想将它用于样式目的，请使用 css 样式表。

最重要的是：如果网页中使用了多个 h1 标签，那么 google 可能会将该页面视为垃圾邮件。可以多次使用 h1 以外的其他标题标签，例如 h2 h3 h4 h5 h6。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-01-09T18:25:26.427

这一切都取决于你`doctype`是什么。每个部分可以使用`html5`多个`h1`标签。（不要阅读，根据`<section></section>`！）在示例中使用时`XHTML 1.0 Transitional` `doctype`，我会避免`h1`在单个页面上使用多个标签。

在示例中使用时`XHTML 1.0 Transitional` `doctype`，我经常会选择这样的东西：

*   h1：最大。每页一次
*   h2：最大。每页两次
*   等等

还有@joel，即使你的回答还不错，请不要试图混淆任何人......我可以说我是谷歌软件工程师，因为我只是与谷歌合作（不是公司，而是产品）而且我是一名工程师......请在声明此类内容时列出您的公司名称和任何证书。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-02-02T18:40:24.787

我认为在我的页面上的每个块元素的顶部放置一个 H1 标签是很好的 SEO 做法，但这只是我。当然，这个 H1 标签应该包含与您定位的关键字/主题相关的信息。

这是我发现的一种非常有效的搜索引擎优化方法，所以告诉你不要这样做的人试图阻止你加入我们的奖金。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-09-20T14:07:41.867

随着HTML5的采用，如果合理的话，几个H1是完全可以的。很好，IIRC，也在 HTML4 中，但除非页面非常垃圾，否则我从未见过它使用过。

多个 H1 适用的一个示例是包含标题、摘录和链接到完整内容的文章列表：

```
<header>
    <h1>Articles</h1>
    <h2>About fish</h2>
    <p>Some intro text</p>
</header>

<section id="articles">
    <article>
        <h1>Title</h1>
        <blockquote class="excerpt">
            Excerpt here
        </blockquote>
        <a href="/whatevs">Read more</a>
    </article>

    <article>
        <h1>Title</h1>
        <blockquote class="excerpt">
            Excerpt here
        </blockquote>
        <a href="/whatevs">Read more</a>
    </article>

</section> 
```

这在语义上是应该的，因此在 SEO 方面也很好。事实上，我认为这比文章的 H2 更好，因为文章本身不是“关于鱼的文章”的子标题，但我想这也可以被反对。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-01-14T18:13:46.383

**你可以，但你不应该有多个H1。**

引用 A11yproject 的 Accessible Heading 结构（[How-Tos 文章链接](https://www.a11yproject.com/posts/how-to-accessible-heading-structure/#one-h1)）

> 对于可访问性和 SEO，在网页上有多个 h1 是不好的做法。它创建了一个扁平且无意义的结构。但是，这不是 WCAG 2 AA 违规。长答案涉及简短的历史课。

> 随着 HTML5 中 HTML 文档大纲的引入，提出了使用多个 h1。大纲中的每个部分都可以包含一个 H1。但问题是：文档大纲从未被浏览器或辅助技术改编。因此，对多个 h1 的支持在 HTML5.1 中被删除

# wix - Wix：根据操作系统更改参数

> ID：503948
> 
> 赞同：2
> 
> 时间：2009-02-02T17:03:18.063
> 
> 标签：wix, windows-installer

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T21:23:08.570

我不必使用 WiX 进行 COM 安装（谢天谢地）。但是从文档和[这个线程](http://n2.nabble.com/How-to-use-SelfRegCost--td693403.html)中，听起来 SelfRegCost 只是为了让 MSI 知道它需要多少空间来验证可用。我猜空白要么是一个错误，要么被视为零并仍然安装 DLL。

我肯定会选择多个组件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T18:47:14.570

您需要使用条件组件以不同的方式安装到不同的操作系统。

您的建议是让部分安装失败，但希望是静默。

使用自定义操作，您可以做到这一点！

```
<CustomAction Id="YourId" Directory="INSTALLDIR" ExeCommand='regsvr32.exe /s "[INSTALLDIR]YourCOM.dll"' Return="ignore" /> 
```

当然，由于 Rob Mensching 提供的一系列原因，不建议这样做。

# java - 为什么人们使用 Velocity 和/或 NVelocity？

> ID：503957
> 
> 赞同：4
> 
> 时间：2009-02-02T17:05:13.553
> 
> 标签：java, .net, asp.net-mvc, templates, theory

在过去的一年里，我听到了很多关于 Velocity 和 NVelocity 的信息。阅读他们的文档并在网上进行搜索并没有给我想要的答案。

在什么情况下我会在我的开发中使用这个库？它解决了哪些尚未解决的问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-02T17:11:26.287

自从 Web 应用程序出现以来，人们就开始考虑在许多应用程序中分离关注点，包括 Web 应用程序。挑战在于将视图代码与业务代码或逻辑代码分开。jsps刚出现时，很多人直接在jsps中编写大量逻辑（数据库访问等），打破了**关注点分离**的基本原则（jsps应该负责呈现，而不是逻辑）。

Velocity、Freemarker 等都是模板引擎，允许分离 UI 逻辑和业务逻辑，从而促进呈现的变化，同时最大限度地减少业务方面的变化。这些模板引擎具有执行常见 UI 任务的工具，例如在某些条件成立时显示一个 html 块，或者**在维护视图之外的逻辑代码的同时**迭代列表。这是长期维护复杂应用程序的基础。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T02:39:38.307

我认为重要的是要指出，与作为模板机制的 JSP/ASP.NET 相比，Velocity/NVelocity 真正“强制”关注的分离。

对于 JSP/ASP.NET 的 <% .. %>，任何 Java/.NET 代码都是允许的。这就是为什么有时您确实会在这些文件中看到业务逻辑代码的原因。

使用 Velocity/NVelocity，您无法嵌入长系列的代码。相反，您确实被迫传入计算值，Velocity/NVelocity 会根据模板的设计方式拾取并显示它们。

另一点是它们可以在 Web 容器环境之外工作（至少 Velocity 可以 AFAIK）。假设您使用 JSP/ASP.NET 设计了一个报告模板。它在网络上运行良好。然后突然有一个更改请求要从桌面应用程序完成。您可以初始化 Velocity/NVelocity，计算值，然后渲染模板，而不是在其中嵌入 Web 容器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T17:08:59.020

它是一个模板引擎。如果您有很多混合了可变内容的静态文本，那么模板是减少您必须做的工作量的好方法。它比 String.Format 或大量串联要好得多，因为它不那么重复或容易出错，而且更易于维护，因为您只需查看它就可以准确地确定模板的作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T22:01:31.207

我们使用模板为生产、UAT、系统测试、应急系统等生成配置文件。

我们有一个主 Spring 配置文件，我们将一个属性文件注入其中。我们有一个由 Velocity 解析的主属性文件，这允许我们将所有系统设置保存在一个文件中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-03T10:54:57.793

作为奖励，对于那些感兴趣的人，我建议阅读以下内容：

*   [http://www.artima.com/lejava/articles/stringtemplate.html](http://www.artima.com/lejava/articles/stringtemplate.html)
*   [http://www.cs.usfca.edu/~parrt/papers/ST.pdf](http://www.cs.usfca.edu/~parrt/papers/ST.pdf)

这些是关于 StringTemplate 的链接，这是由 Terence Parr 编写的模板引擎，antlr 是一种无处不在的解析器（例如：hibernate 使用 antlr）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-23T13:37:45.183

1 - Velocity 引擎实际上将**实时数据**与`xyz.vm`保存**静态信息**
的文件合并2 - vm 文件使用 Velocity 模板语言（VTL） [（它可以迭代放置在上下文中的 java 可迭代 java 对象，可以调用可访问的方法通过放置在上下文中的对象）]

**使用 Velocity 的情况 -** *将 java 的强大功能带到 html[不仅仅是 html]*
1-当您必须经常生成具有不同数据和恒定样式的报告邮件时。（foreach 支持）
2-当您想要将实时数据与虚拟占位符合并到深度嵌套的内容中
3-当您想根据数据的值决定样式信息时（如果其他支持）
还有更多
参考 - [http://velocity.apache.org/engine/releases/velocity-1.5/user-guide.html](http://velocity.apache.org/engine/releases/velocity-1.5/user-guide.html)

# asp.net - 保留原始参数的 ASP.NET 404（找不到页面）重定向

> ID：503960
> 
> 赞同：2
> 
> 时间：2009-02-02T17:05:29.357
> 
> 标签：asp.net, redirect, error-handling, http-status-code-404

我正在用具有不同结构的新 Web 应用程序替换旧的 Web 应用程序。

我无法更改新应用程序的虚拟目录路径，因为我的用户已经为旧应用程序的不同链接添加了书签。

假设我有一个用户，他有这个书签：

[http://server/webapp/oldpage.aspx?data=somedata](http://server/webapp/oldpage.aspx?data=somedata)

我的新应用程序将驻留在同一个虚拟目录中，替换旧的，但它不再具有 oldpage.aspx，而是具有不同的布局，但它仍然需要旧 url 中的参数。

因此，我已将 404 错误重定向到 redirectfrombookmark.aspx，在那里我决定如何处理请求。

问题是，我收到的唯一参数是“aspxerrorpath=/webapp/oldpage.aspx”，而不是“data”参数，我需要它来正确处理请求。

知道如何在 404 处理程序中获取完整的“原始”网址吗？

编辑：阅读答案，看起来我没有把问题说得足够清楚：

1.  用户已经为许多不同的页面添加了书签（oldpage1、oldpage2 等），我应该平等地处理它们。
2.  每个旧页面的参数几乎相同，我只需要特定的。
3.  我想为“新”应用程序重新使用“旧”虚拟目录名称。
4.  搜索机器人等不是问题，这是具有动态内容的内部应用程序，它经常过期。

问题是 - 我是否可以在我的“新”应用程序中使用旧名称创建一堆空页面，并在其 OnLoad 中创建 Request.Redirect。即这可以使用 404 机制或 Global.asax 中的一些事件处理等来完成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-02T17:57:24.243

出于 SEO 的目的，您**永远**不应重定向 404 错误。404 应该是一个死胡同，其中包含一些有关如何定位您正在寻找的页面的有用信息，例如站点地图。

您应该使用**301，永久移动**。这允许搜索机器人在不丢失分配给原始页面的页面排名的情况下更新其索引，

请参阅：[http](http://www.webconfs.com/how-to-redirect-a-webpage.php) ://www.webconfs.com/how-to-redirect-a-webpage.php ，了解如何编写此类响应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T18:32:11.833

您可以查看[UrlRewritingNet](http://www.urlrewriting.net/149/en/home.html)组件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T18:04:00.830

您还应该考虑使用 Global.ascx(?extention) 文件中的一些事件来检查错误并智能地重定向。OnError 事件是您想要使用的。您将在该时间点（在 HttpContext 对象下）获得来自请求的变量，并且您可以让您的代码在那里而不是 404 工作。如果您走这条路线，请确保您正确重定向 404 以用于除 oldpage 之外的任何内容.aspx。

很抱歉，我现在没有任何明确的示例或信息，希望这将为您指明正确的方向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T17:50:27.970

POST 和 GET 参数仅适用于每个请求。如果您已经知道旧页面的名称 (OldPage.aspx)，为什么不在其中添加自定义重定向？

# c# - Forms Auth - 如何防止欺骗用户帐户只知道扩展的用户信息？

> ID：503967
> 
> 赞同：0
> 
> 时间：2009-02-02T17:07:08.493
> 
> 标签：c#, asp.net, security, forms-authentication

我有点奇怪的困境。请耐心等待我尝试解释它！

我正在使用表单身份验证并将其他用户信息存储在另一个表中（从 Forms Auth 引用的 UserID、加密的 SSN、Salt 值）。当用户注册到该站点时，我会询问 SSN、DOB 和 LName，并在他们创建帐户之前对我们的系统进行验证。我想确定该 SSN 在表单身份验证中是否有与之关联的帐户。由于 SSN 是使用盐值加密的，因此我无法在不查看每一行的情况下进行查找。

我只想要每个 SSN 1 个用户帐户。使用盐值会破坏这一点。

在我看来，解决这个问题的唯一方法是对 SSN 使用通用加密算法。当用户输入它时，我应用相同的加密算法并查看用户扩展属性表中是否存在值匹配。

这足够安全吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T22:54:49.087

如果您希望加密（而不是散列） SSN 值，那么将密钥存储在 Natso 指出的同一个表中并不是一个好习惯。这是充满危险的，因为密钥不会与它们保护的数据一起存储 - 如果攻击者设法获得您的数据库的转储，他将能够解密加密的内容，因为密钥是一起存储的。

应用程序应从安全密钥存储中获取密钥，然后可以使用该密钥对信息进行加密/解密。这样，您可以继续将敏感信息存储在数据库中，从而保护您的信息，并应用不同的机制（通常是文件系统安全性）来保护您的密钥存储。

这当然是假设您的要求是以安全的方式将数据存储在数据库中，并在稍后的时间点恢复相同的数据。但是，如果数据一旦通过算法就无法恢复，则应该探索哈希的使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T18:30:42.100

与其使用相同的盐值，不如根据其他用户信息生成盐，以便可以对其进行重构。因此，一旦用户申请，您就可以重新生成盐，并且您可以生成预期的哈希并在单个查询中完成工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T17:15:24.140

Use the same salt every time. Then you can compare the encrypted values.

# asp.net - 如何使用 CSS 指定的 DOCTYPE 修复 100% 高度表中的表行高度？

> ID：503981
> 
> 赞同：2
> 
> 时间：2009-02-02T17:09:46.820
> 
> 标签：asp.net, html, css

[这是我可以创建一个 HTML 表格宽度的百分比高度但像素精确的行高](https://stackoverflow.com/questions/495194/can-i-create-a-html-table-width-a-percentage-height-but-pixel-accurate-row-height)的后续问题吗？.

我在 HTML 页面中有一个表格，将用于表格数据（所以我不想要基于 div 的答案）。这需要以 100% 的高度渲染，第一行具有固定大小，第二行拉伸以适应剩余的可用区域。

我使用了以下代码：

```
<html>
  <body>
    <table style="border-collapse:collapse;height:100%;width:100%;">
      <tr>
        <td style="border:solid 1px black;height:100px">1</td>
        <td style="border:solid 1px black">2</td>
      </tr>
      <tr>
        <td style="border:solid 1px black">3</td>
        <td style="border:solid 1px black">4</td>
      </tr>
    </table>
  </body>
</html> 
```

这可以按我的要求工作。

问题是，当我将它放入在 Visual Studio 中创建的 ASP.NET 页面中时，它会添加一个 DOCTYPE 元素。添加 DOCTYPE（并将 html 和 body 标签的 CSS 设置为包含 height:100%）后，表格的顶行比底行大得多，并且两行都没有固定高度。

我知道我应该使用 DOCTYPE 而不是依赖 Internet Explorer 中的“怪癖模式”来确保未来的兼容性。但是，我已经尝试了所有可以找到的 DOCTYPE 来尝试将此行为更改为我需要的但无法使其正常工作。它确实在 Firefox 中工作，但该工作适用于用户使用 IE7 的 Intranet。

如果您想查看问题，请尝试以下操作：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html style="height:100%">
  <body style="height:100%">
    <table style="border-collapse:collapse;height:100%;width:100%;">
      <tr>
        <td style="border:solid 1px black;height:100px">1</td>
        <td style="border:solid 1px black">2</td>
      </tr>
      <tr>
        <td style="border:solid 1px black">3</td>
        <td style="border:solid 1px black">4</td>
      </tr>
    </table>
  </body>
</html> 
```

有人知道答案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T23:15:19.017

有一个简单的方法可以解决这个问题，特别是如果页面只包含这个表，而您只是希望它工作。我不确定 ASP.NET 是否会让您：在文档类型前添加注释。例如

```
<!-- Here for IE6/7 -->
<!DOCTYPE html (etc.)>
... The HTML that works in quirks mode ... 
```

这将使 IE6 和 IE7 触发*quirks*模式，这意味着那些早期的答案实际上会起作用。但它是对 DOCTYPE 的完全有效使用，并且会在所有其他浏览器中触发*标准模式。*IE8（无论如何都是 RC1）也为此使用了 quirks 模式，尽管它在标准模式下也能正确呈现。

当然，将 IE6 和 7 保持在 quirks 模式意味着它们对于所有其他东西也将处于 quirks 模式，所以如果你要使用很多其他 CSS，你可能会后悔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T19:09:23.473

我尝试尽可能少地使用 %，因为填充、边框和边距会添加到 100% 宽度（如果有），除非您使用石器时代的浏览器。我过去只是平铺背景图像来伪造我想要的任何东西在父元素或主体上具有 100% 的高度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T21:49:23.900

首先，我建议将高度设置为行级别，而不是单元格级别。其次，如果您将第二行的高度设置为 100%，IE 将让它填满表格中剩余的可用空间。以下应该有效：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html style="height:100%">
  <body style="height:100%">
    <table style="border-collapse:collapse;height:100%;width:100%; table-layout:fixed;">
      <tr style="height: 100px;">
        <td style="border:solid 1px black">1</td>
        <td style="border:solid 1px black">2</td>
      </tr>
      <tr style="height: 100%">
        <td style="border:solid 1px black">3</td>
        <td style="border:solid 1px black">4</td>
      </tr>
    </table>
  </body>
</html> 
```

虽然使用基于百分比的高度可能不是您的最佳选择，但在不了解和理解您要完成的任务的情况下，这是我能给您的最佳建议

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T21:52:43.817

好吧，我发布到您的问题的[解决方案](https://stackoverflow.com/questions/495194/can-i-create-a-html-table-width-a-percentage-height-but-pixel-accurate-row-height/495219#495219)，它有一个（必要的）div 包裹在您的桌子上，与该 DOCTYPE 和我尝试过的其他几个完美配合，所以我不确定问题是什么。

您是否只是因为其中有一个 div 而选择忽略它？还是您没有阅读或尝试过？div有什么问题？

# .net - 我应该如何反序列化这个字符串数据？

> ID：503982
> 
> 赞同：0
> 
> 时间：2009-02-02T17:09:47.990
> 
> 标签：.net, parsing, serialization, data-structures

我的应用程序接收代表对象的字符串。我必须解析字符串以获取我正在创建的对象的属性值。每个对象都必须知道有多少属性、每个属性的含义等细节。但是，我想避免让每个类都知道如何解析字符串。我宁愿为每个单独的对象传递一个更合适的数据结构（如数据集或 XML）......更容易填充其属性的东西。

.NET 框架中是否有适合这种类型的东西？或者我应该创建自己的容器对象？

**添加：**

我认为我最初没有很好地解释我的问题。这是一个澄清的例子。

假设我的程序总是传递一个字符串，表示 Wiki 语法中的数据表。就像是：

```
 {||Client:||ABC|-|Contact:||Joe Smith|-|Current revision:||1.0||} 
```

我不希望我的每个特定 wiki 表对象（例如，ClientContactTable、CustomerOrderTable 等）都知道如何解析 | 和 - 和}。因此，我想编写 1 块代码，将字符串解析为一些“中间”层对象，我可以将其传递给每个特定 Wiki 表对象的构造函数。

**我的问题是：**中间层对象应该是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T17:13:35.830

我建议使用 BinaryFormatter。

[http://www.codeguru.com/columns/dotnet/article.php/c6595](http://www.codeguru.com/columns/dotnet/article.php/c6595)

或直接参考：

[http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatters.binary.binaryformatter.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatters.binary.binaryformatter.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T17:14:57.980

我可能错误地理解了您的问题，但我认为标准 .NET 序列化适合您的需求：

```
var ms = new MemoryStream();
var formatter = new BinaryFormatter();
formatter.Serialize(ms, myObject);

// Deserialization:
var deserialized = (MyClass)formatter.Deserialize(stream); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T17:26:15.243

一种传统的方法是通过`System.Xml.Serialization`课程。这允许您将对象序列化到磁盘，并在以后反序列化它们。这有一些限制：类型应该是公共的，有一个公共的无参数构造函数，并且有 XmlSerializer 属性。

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.Xml.Serialization;

namespace ConsoleApplication1
{
    [Serializable]
    public class Cat
    {
        DateTime _dateOfBirth;
        string _name;

        public DateTime DateOfBirth
        {
            get { return _dateOfBirth; }
            set { _dateOfBirth = value; }
        }

        public string Name
        {
            get { return _name; }
            set { _name = value; }
        }

        public Cat() : this(DateTime.Now, "(Cat with no name)") { }

        public Cat(DateTime dateOfBirth, string name)
        {
            this.DateOfBirth = dateOfBirth;
            this.Name = name;
        }

        public override string ToString()
        {
            return string.Format("Name: {0}, DateOfBirth: {1}", Name, DateOfBirth);
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            Cat originalCat = new Cat(DateTime.Now, "Fluffy");
            XmlSerializer serializer = new XmlSerializer(typeof(Cat));

            MemoryStream memStream = new MemoryStream(); // can be file stream
            serializer.Serialize(memStream, originalCat);

            memStream.Position = 0; // this is just here to make this code sample work, usually you
                                    // you don't need to set your streams position manually

            Cat deserializedCat = (Cat)serializer.Deserialize(memStream);

            Console.WriteLine("originalCat.ToString(): {0}", originalCat.ToString());
            Console.WriteLine("deserializedCat.ToString(): {0}", deserializedCat.ToString());

            Console.ReadKey(true);
        }
    }
} 
```

一般来说，你应该*非常*小心这种序列化。当您尝试在同一程序集的不同版本之间序列化/反序列化对象时，就会发生奇怪的事情。

**Edit to add:** The code above will serialize your object to XML. You can see the XML representation by substituting your MemoryString with a StringWriter instead (call the stringWriterInstance.ToString() method to get the XML string directly). Others have suggested using the BinaryFormatter, which does more or less the same thing, but the output is binary rather than text.

Both approaches are valid ways to serialize data, it just depends on whether you like dealing more with XML or binary data.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T17:15:53.703

您需要解析字符串数据并将其转换为对象或 xml - 我建议您使用 string.split 创建一个集合（数组），然后使用 linq 创建您想要的数据结构并传递给返回您的工厂基于您传递给工厂的参数的正确对象以及数据结构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T17:28:05.207

If you need to store your object(s), you should use the XmlSerializer(s). This will de/serialize your objects as XML and parse them for you.

```
public List<_type> LoadDataFromResource<_type>(string file)
{
   List<_type> data = new List<_type>();
   FileStream str = File.OpenRead(file);
   if (str == null) return null;
   XmlSerializer sr = new XmlSerializer(data.GetType());
   if (sr == null) return null;
   data = sr.Deserialize(str) as List<_type>;
   return data;
}

public bool SaveData<_type>(string file, List<_type> data)
{
StreamWriter writer = File.CreateText(file);
if (writer == null) return false;
XmlSerializer sr = new XmlSerializer(data.GetType());
if (sr == null) return false;
sr.Serialize(writer, data);
return true;
} 
```

# javascript - Position div depending on distance browser edge (javascript)

> ID：503992
> 
> 赞同：6
> 
> 时间：2009-02-02T17:12:51.960
> 
> 标签：javascript, positioning, tooltip

I am trying to create a small tooltip script that mostly relies on css. The bit of JavaScript I can't figure out is how to position the div based on its distance to the browsers edge.

When the div appears I would like it to check how close it is to the top, bottom, left and right. For example if there is not enough space to display the div above the tooltip link it should position it below the link.

Essentially I would like the div to be "aware" of its position and know where to go to make sure it is visible.

Thanks

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-07-28T18:59:21.013

我只需要自己编写非常相似的代码，用于[tipsy](http://onehackoranother.com/projects/jquery/tipsy/)（所以我的解决方案使用jQuery）。这是基本的数学，假设`<div id="mydiv">...</div>`是你正在使用的 div。在测量到右边缘和下边缘的距离时，我也会考虑 div 的高度和宽度。

`dTop`, `dBottom`, `dLeft`, 和`dRight`分别是从 div 的顶部、底部、左侧和右侧边缘到视口同一边缘的距离。如果要根据 div 的左上角进行测量，计算and时不要减去`dTop`or 。`dLeft``dBottom``dRight`

```
var $doc = $(document),
    $win = $(window),
    $this = $('#mydiv'),
    offset = $this.offset(),
    dTop = offset.top - $doc.scrollTop(),
    dBottom = $win.height() - dTop - $this.height(),
    dLeft = offset.left - $doc.scrollLeft(),
    dRight = $win.width() - dLeft - $this.width(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T17:17:25.930

See [Measuring Element Dimension and Location](http://msdn.microsoft.com/en-us/library/ms530302.aspx) for help

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T17:27:33.023

This [cheat sheet](http://attic.scripteka.com/prototype_cheatsheet_1.6.0.2.pdf) for the [Prototype library](http://prototypejs.org) has a good example.

# .net - In .NET, is the call stack inextricably tied to a thread?

> ID：503996
> 
> 赞同：1
> 
> 时间：2009-02-02T17:13:04.300
> 
> 标签：.net, multithreading, il, intermediate-language

Is it at all possible in the middle of a function execution to set a pointer to the current stack (to be picked up later) and then release the current thread (without unwinding the call stack) and give it back to the thread pool? And then, have another thread pick up where that thread left off? I know it would mean that someone calling into the function would not know that the current thread context would have changed, and it would probably involve writing some custom IL code to do something like this, but is there ANY way to do this?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-02T17:15:37.620

No, a stack is part of the state of a thread. You can use asynchronous workflows to do this sort of thing (and the CCR makes this easier) but you can't just give the thread back to the thread pool.

You could write a thread pool which *did* do this, but it would be a bad idea IMO - it would be the thread pool equivalent of calling Application.DoEvents IMO.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-15T20:54:17.697

您所描述的是定界的延续。可悲的是，CLR 不支持这一点，并且无法通过我知道的任何技巧在托管代码（甚至混合代码）中实现。

目前，我需要 IronScheme 中的这个功能。有一些方法可以在 CLR 上创建这种功能，方法是编写一个进行 CPS 转换的编译器，但这会导致许多互操作性问题（您不能直接调用 .NET 函数等）。

我在 IronScheme 中对 CPS 转换做了一些实验，但是我当前的编译器并不真正适合这个，而且执行速度很慢。****************``