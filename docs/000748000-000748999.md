# StackOverflow 问答 000748000-000748999

# usability - 不让用户犯错与给予他们灵活性

> ID：748001
> 
> 赞同：3
> 
> 时间：2009-04-14T14:55:44.330
> 
> 标签：usability, customization

我正在开发一种易于使用和设置的产品，竞争主要需要很长的设置时间，在某些情况下甚至需要为每个客户定制解决方案。我们的应用程序的一部分现在正在根据客户请求进行扩展，看起来我们需要使其非常灵活，以便每个客户都可以对其行为方式进行大量控制。问题是我不想让系统过于可配置，因为我相信这会使学习和使用变得更加复杂。我还担心它会为有人为自己搞砸事情打开大门，有点像给他们一把枪，尽管我实际上并没有为他们指指点点。

有没有其他人面临过将权力交到用户手中的类似困境？你是怎么解决的？结果是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T15:05:33.433

我通常不喜欢认为所有用户都是愚蠢的，但有一条规则仍然可以应用：

**如果你给他们机会，他们会打破它**

现在由你决定是否赋予他们做潜在愚蠢事情的能力。或者更好的是，开发它以便当他们做他们所做的愚蠢的巫术时，它可以优雅地从错误状态中恢复或恢复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T15:02:03.907

我强烈推荐你阅读 Joel 的[Controlling Your Environment Makes You Happy](http://www.joelonsoftware.com/uibook/chapters/fog0000000057.html)，它可以被描述为关于用户界面设计的一篇论文，但它实际上是关于可用性的，并且融入了健康的心理学。

我指的部分是[Choices](http://www.joelonsoftware.com/uibook/chapters/fog0000000059.html)：

> 每次您提供一个选项时，您都是在要求用户做出决定。

这是我非常同意的。许多开发人员、产品经理等采取简单的方法，他们没有弄清楚用户真正需要什么，而是给他们一个选择。您可以在 Clearcase 或 PVCS 等企业过时软件中看到这一点，其中有很多选项——其中 90% 是你永远**不会**改变的——这表明设计师试图为所有人提供所有东西，而不是做一两件特别的事情出色地。

相反，它只是做了很多糟糕的事情。

保持简单，遵循惯例，不要用无意义和不必要的选择压倒用户，并使软件表现得像普通用户所期望的那样。仅此一项就可以使您与许多其他产品区分开来。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T15:05:13.683

我个人喜欢 TurboTax 模型（[http://turbotax.intuit.com/](http://turbotax.intuit.com/)）。在创建纳税申报表时，我会得到一个简单的、像五岁一样告诉我的向导，它会引导我逐步完成整个过程，*但*我可以随时跳出该过程并使用更高级的功能，稍后返回该过程。

让您的用户在 80% 的时间里都可以轻松、简单、整洁地做他们将要做的事情，但要让他们有能力故意超越常规。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T15:16:04.950

您的问题的有趣时机。在美国，这是所得税周。填写 ol' 1040 和相关的子表单应该让我们对用户所忍受的有所同情。

我学到的教训是：

**只问与用户域相关的问题**；避免与软件系统有关的问题；如果您可以得出答案或提出最可能的答案，请这样做。

**将相关问题放在一起**（只要它们通常由同一个人使用最有可能在同一地点和时间获得的数据输入，这是这些目的的*相关*定义）。

使其支持**增量输入**。输入他们拥有的数据应该很容易，并在其余数据可用时推迟完成。

**显示状态有效性和完整性。**清楚地表明他们离拥有可验证的数据还有多远。

**使其可中断。**确保可以中断流程、离开应用程序、返回并从中断的地方继续。

* * *

是的，编程更难。接受它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T15:46:43.443

至少有两种方法可以构建好的软件产品：

1.  专注于一组狭窄的功能，并很好地实现该功能。

2.  将您的系统设计为可定制的（理想情况下，通过脚本编写）。如果您正确地完成了基本系统，则很容易在定制层之上提供基本的、没有选项的、只做我想要的功能。

不幸的是，还有很多方法可以创建一个糟糕的软件产品。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T06:31:11.843

您的问题意味着您可以提供灵活的解决方案或使其万无一失。

我不会那样说的。对我来说，这是一个用户期望的问题，首先的问题是：如何在不破坏应用程序的情况下满足所有重要的用户期望（即使它们相互冲突）？

例如，具有菜单、面包屑导航、站点地图和搜索的 Web 应用程序提供了五种不同的方式来查找您正在寻找的内容以及如何去那里。这样，大多数用户可以快速轻松地找到他们期望的功能，因此对大量文档的需求实际上可能会减少。

因此，答案可能是提供几种不同的精心选择的方法来解决一项特定任务，同时每种方法都可以独立进行简化以避免用户错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-14T15:29:38.100

*当使用sensible defaults*时，我取得了巨大的成功，并且作为用户最快乐。换句话说，让最常见的用例变得简单（甚至更好，免费），但让用户能够在情况需要时跳出该用例。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-14T15:03:54.043

答案在于您的最终用户是谁。我曾经编写被专业体育教练使用的软件。虽然这些人确实擅长他们所做的事情，但他们几乎不精通计算机使用，因此我们的可配置性保持在最低限度（至少就 GUI 中可以完成的事情而言）。

另一方面，如果您正在与高级用户打交道，那么添加选项通常不是一件坏事，只要它们不是侵入性的。

这完全取决于谁会得到它们。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-14T15:04:31.187

阅读 Jeff Atwood 的《[培训您的用户](http://www.codinghorror.com/blog/archives/001237.html)》 。这是一篇很棒的文章，有一些非常有用的链接。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-14T15:08:44.610

我喜欢 Firefox 的做法。基本选项可以在选项菜单中访问，其余的都在 about:config 下。因此，如果您需要，您将拥有一个简单的界面和令人难以置信的灵活性。

# vb.net - 自定义数据表搜索

> ID：748004
> 
> 赞同：0
> 
> 时间：2009-04-14T14:56:57.087
> 
> 标签：vb.net, .net-2.0, datatable, dataset

编辑：注意。我应该提到我对使用 .Select、DataRowView、RowFind 等不感兴趣。感谢您的这些建议，但就目前的代码而言，我希望对其进行优化。

我编写了一个函数来在数据表中搜索数组中的术语。然后我将数据表作为数据集返回，以便它可以绑定到 DataGridView。有没有人有任何优化的想法？由于这是一个实时搜索（每个输入的字词都会立即搜索），我想让这个功能尽可能快。速度实际上已经相当不错了，但我想我值得问问大家是否还有其他可以改变的地方。

 *****   VB.NET
*   .NET 2.0** 

**公共函数 SearchEngine(ByVal terms() As String, ByRef residentTBL As DataTable) As DataSet Dim newdts As New DataSet("Users") Dim newtable, temptable As New DataTable Dim residentPassCeiling, tempPassCeiling, termsceiling As Integer residentPassCeiling = residentTBL.Rows.Count - 1 个termceiling = Terms.GetUpperBound(0) newtable = ResidentTBL.Clone**

 **```
 For j = 0 To termsceiling

            If j < 1 Then
                '######################## BEGIN First Pass ########################################################################
                For i = 0 To residentPassCeiling

                    If ResidentTBL.Rows(i).Item(TheColumns.AccountName - 1).ToString.ToUpper = Terms(j).ToUpper Then
                        'we have an excact match on account skip further additions
                        newtable.Rows.Clear()
                        newtable.ImportRow(ResidentTBL.Rows(i))
                        newdts.Tables.Add(newtable)
                        Return newdts
                    Else
                        If _
                        ResidentTBL.Rows(i).Item(TheColumns.AccountName - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Or _
                        ResidentTBL.Rows(i).Item(TheColumns.displayName - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Or _
                        ResidentTBL.Rows(i).Item(TheColumns.sn - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Or _
                        ResidentTBL.Rows(i).Item(TheColumns.givenName - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Or _
                        ResidentTBL.Rows(i).Item(TheColumns.l - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Or _
                        ResidentTBL.Rows(i).Item(TheColumns.department - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Or _
                        ResidentTBL.Rows(i).Item(TheColumns.telephoneNumber - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Or _
                        ResidentTBL.Rows(i).Item(TheColumns.building - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Then
                            'then add to the row
                            newtable.ImportRow(ResidentTBL.Rows(i))
                        End If
                    End If

                Next i
                '######################## END First Pass ########################################################################
            Else
                '######################## BEGIN Second.. Pass(es) ########################################################################
                'Further searches we want to search the already filtered datatable from each term
                temptable = newtable.Clone
                temptable = newtable.Copy
                newtable.Clear()
                tempPassCeiling = temptable.Rows.Count - 1
                For i = 0 To tempPassCeiling

                    If temptable.Rows(i).Item(TheColumns.AccountName - 1).ToString.ToUpper = Terms(j).ToUpper Then
                        'we have an excact match on account skip further additions
                        newtable.Rows.Clear()
                        newtable.ImportRow(temptable.Rows(i))
                        newdts.Tables.Add(newtable)
                        Return newdts
                    Else
                        If _
                        temptable.Rows(i).Item(TheColumns.AccountName - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Or _
                        temptable.Rows(i).Item(TheColumns.sn - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Or _
                        temptable.Rows(i).Item(TheColumns.givenName - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Or _
                        temptable.Rows(i).Item(TheColumns.l - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Or _
                        temptable.Rows(i).Item(TheColumns.department - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Or _
                        temptable.Rows(i).Item(TheColumns.telephoneNumber - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Or _
                        temptable.Rows(i).Item(TheColumns.building - 1).ToString.ToUpper Like Terms(j).ToUpper & "*" Then
                            'then add to the row
                            newtable.ImportRow(temptable.Rows(i))
                        End If
                    End If

                Next i

                temptable = Nothing
                '######################## END Second.. Pass(es) ########################################################################
            End If

        Next j
        newdts.Tables.Add(newtable)
        ResidentTBL = Nothing

        Return newdts
        newdts = Nothing

    End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T15:00:38.373

您可能想研究使用 DataViews 过滤数据：

[http://aspnet101.com/aspnet101/tutorials.aspx?id=31](http://aspnet101.com/aspnet101/tutorials.aspx?id=31)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T15:02:15.950

您可以生成 DataTable 过滤器字符串以从数据表中选择行。

[http://msdn.microsoft.com/en-us/library/system.data.datatable.select.aspx](http://msdn.microsoft.com/en-us/library/system.data.datatable.select.aspx)

这是过滤器字符串上的文档

[http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx)

# c++ - 我需要手动关闭 ifstream 吗？

> ID：748014
> 
> 赞同：234
> 
> 时间：2009-04-14T14:59:26.160
> 
> 标签：c++, ifstream, raii

`close()`使用时需要手动调用`std::ifstream`吗？

例如，在代码中：

```
std::string readContentsOfFile(std::string fileName) {

  std::ifstream file(fileName.c_str());

  if (file.good()) {
      std::stringstream buffer;
      buffer << file.rdbuf();
      file.close();

      return buffer.str();
  }
  throw std::runtime_exception("file not found");
} 
```

我需要`file.close()`手动调用吗？不应该`ifstream`使用[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)来关闭文件吗？

* * *

## 回答 #1

> 赞同：284
> 
> 时间：2009-04-14T15:09:35.060

不

这就是 RAII 的用途，让析构函数完成它的工作。手动关闭它并没有什么坏处，但这不是 C++ 的方式，它是在 C 中使用类进行编程。

如果你想在函数结束之前关闭文件，你总是可以使用嵌套范围。

在标准（27.8.1.5 类模板 basic_ifstream）中，将使用持有实际文件句柄`ifstream`的成员来实现。`basic_filebuf`它作为一个成员保存，因此当 ifstream 对象析构时，它也会调用析构函数 on `basic_filebuf`。从标准（27.8.1.2）来看，该析构函数会关闭文件：

> `virtual ˜basic_filebuf();`
> 
> **效果：**销毁类的对象`basic_filebuf<charT,traits>`。来电`close()`。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2009-04-14T15:44:45.477

需要关闭文件吗？
不

你应该关闭文件吗？
依靠。

如果文件无法正确关闭，您是否关心可能发生的错误情况？请记住，`setstate(failbit)`如果失败，请关闭电话。**由于RAII** ，析构函数会自动调用`close()`您，但不会让您测试失败位，因为对象不再存在。

 *** * *

## 回答 #3

> 赞同：16
> 
> 时间：2011-07-14T20:45:00.663

我同意@Martin。如果您写入文件，则数据可能仍位于缓冲区中，并且在`close()`调用之前可能不会写入文件。如果不手动执行，您不知道是否有错误。不向用户报告错误是一种非常糟糕的做法。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-05-22T11:37:39.727

您可以允许析构函数完成它的工作。但就像任何 RAII 对象一样，有时手动调用 close 可能会有所作为。例如：

```
#include <fstream>

using std::ofstream;

int main() {
  ofstream ofs("hello.txt");
  ofs << "Hello world\n";
  return 0;
} 
```

写入文件内容。但：

```
#include <stdlib.h>

#include <fstream>

using std::ofstream;

int main() {
  ofstream ofs("hello.txt");
  ofs << "Hello world\n";
  exit(0);
} 
```

没有。这些是进程突然退出的罕见情况。崩溃的过程也可以做类似的事情。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-15T09:24:43.820

不，这是由`ifstream`析构函数自动完成的。您应该手动调用它的唯一原因是因为该`fstream`实例具有很大的范围，例如，如果它是长寿类实例的成员变量。

# iphone - openGL ES中glArrayElement()&glTexGeni()的等效函数是什么

> ID：748015
> 
> 赞同：0
> 
> 时间：2009-04-14T14:59:59.700
> 
> 标签：iphone

谁能告诉我openGL ES中glArrayElement（）和glTexGeni（）的等效函数是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T16:58:50.507

这两个功能没有等价物。

OpenGL|ES 是 OpenGL 的精简和精简版本，所以有些东西被遗漏了。

glArrayElement 不是必需的，因为整个 glBegin / glEnd 渲染模式已从 GL|ES 中删除。如果没有 glBegin/glEnd，glArrayElement 就没有意义了。由于您必须重写渲染代码以使用 glDrawArrays/glDrawElements，您不会错过它。

glTexGen 也已被删除。如果您使用更高版本的 GL|ES，您可以使用顶点着色器模拟所有功能。如果你受困于早期的 GL|ES（1.0 或 1.1），你必须在软件中模拟它（例如，你自己计算纹理坐标并通过 glTexCoordPointer 将它们传递给 gl）。

# c# - 如何在 WPF 中构建类似 VS 的属性面板？

> ID：748027
> 
> 赞同：2
> 
> 时间：2009-04-14T15:02:27.870
> 
> 标签：c#, wpf, visual-studio

我得到了一个`TreeView`包含来自不同类的不同对象。现在我想构建一个属性面板，它显示不同的内容，取决于在`TreeView`. 构建此类面板的最佳方法是什么？不同的面板和折叠面板取决于选择（谁让我更容易实现 ObserverPattern？）？还是其他方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T15:42:26.540

我会将属性面板（可能只是一个`ContentControl`）绑定`SelectedItem`到`TreeView`：

```
<ContentPanel Content="{Binding SelectedItem, ElementName=_treeView}"/> 
```

然后我将使用`DataTemplate`s 为您拥有的每一类项目显示正确的面板：

```
<DataTemplate DataType="{x:Type local:SomeClass}">
    <Label>This is displayed for SomeClass</Label>
</DataTemplate>

<DataTemplate DataType="{x:Type local:SomeOtherClass}">
    <Label>This is displayed for SomeOtherClass</Label>
</DataTemplate> 
```

显然，您`DataTemplate`的 s 可以根据需要变得复杂，以显示`TreeView`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T07:10:35.937

你的意思是一个[属性网格](http://msdn.microsoft.com/en-us/library/system.windows.forms.propertygrid.aspx)？

# python - 如何在python脚本中获取exe的输出？

> ID：748028
> 
> 赞同：12
> 
> 时间：2009-04-14T15:02:33.423
> 
> 标签：python, ide, executable, redirect

当我在 Python 中调用外部`.exe`程序时，如何`printf`从应用程序获取输出`.exe`并将其打印到我的 Python IDE？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-14T15:09:02.113

要从 Python 调用外部程序，请使用[subprocess](http://docs.python.org/library/subprocess.html#module-subprocess)模块。

> subprocess 模块允许您生成新进程，连接到它们的输入/输出/错误管道，并获取它们的返回码。

文档中的一个示例（`output`是一个提供子进程输出的文件对象。）：

```
output = subprocess.Popen(["mycmd", "myarg"], stdout=subprocess.PIPE).communicate()[0] 
```

一个具体的例子，使用`cmd`带有 2 个参数的 Windows 命令行解释器：

```
>>> p1 = subprocess.Popen(["cmd", "/C", "date"],stdout=subprocess.PIPE)
>>> p1.communicate()[0]
'The current date is: Tue 04/14/2009 \r\nEnter the new date: (mm-dd-yy) '
>>> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-14T15:38:55.490

我很确定您在这里谈论的是 Windows（基于您问题的措辞），但是在 Unix/Linux（包括 Mac）环境中，命令模块也可用：

```
import commands

( stat, output ) = commands.getstatusoutput( "somecommand" )

if( stat == 0 ):
    print "Command succeeded, here is the output: %s" % output
else:
    print "Command failed, here is the output: %s" % output 
```

commands 模块提供了一个非常简单的接口来运行命令并获取状态（返回代码）和输出（从 stdout 和 stderr 读取）。或者，您可以通过分别调用 commands.getstatus() 或 commands.getoutput() 来获取状态或仅输出。

# pdf - PDF格式的网络服务图像？

> ID：748031
> 
> 赞同：1
> 
> 时间：2009-04-14T15:02:53.877
> 
> 标签：pdf

PDF 和/或 Adob​​e Reader 是否支持通过 URL 包含图像，以便您可以将来自 Web 服务器的动态图像插入到文档中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T15:45:12.633

你的问题的答案是肯定的和否定的。如果您查看第 7.11.5 节中的[PDF 规范](http://www.adobe.com/devnet/acrobat/pdfs/PDF32000_2008.pdf)（我将使用 1.7 版），您会发现 PDF 文档中的流可以由 URL 表示。所以是的，您可以继续并指定 PDF 在指定的 URL 中具有其图像内容。

问题在于，当您在 PDF 中指定图像时，您正在指定一个特定的图像，该图像必须具有特定的数据长度和编码。仅指定尺寸、dct 压缩（又名 jpg）和 URL 是不够的。图像包含在特定长度的流中。如果流太长或太短，则将其视为错误。

因此，您可以动态提供图像，前提是它们始终具有完全相同的字节长度。我认为。我之所以这么说是因为规范对于在流字典中将长度设置为 0 时会发生什么情况有些模棱两可。

现在，这样做实用吗？也许——您需要一个相当强大的 PDF 工具包才能创作这些文档。如果你有这个，我认为你最好即时创作客户想要的整个 PDF 文档，而不是在阅读时尝试替换图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T15:15:16.497

我不相信您可以以这种方式将动态图像放置在 PDF 文档中。可以使用 Web 托管的内容（使用 PHP、Coldfusion 等）动态创建整个 PDF 文档，但稍后在 Web 服务器上更改该内容不会动态更新以前生成的 PDF 文档，这听起来像是您想要的做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T15:15:54.047

由于 PDF 本质上是可移植的（便携式文档格式），因此并不总是在线查看，这违背了文档格式的原则，并且据我所知不受支持。

您可以在生成 PDF 时包含对图像的引用，但所述图像将嵌入到 PDF 中，而不是链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-12T18:56:13.167

您可以使用 pdf.js 并稍微修改渲染方法，以便注入图像。你可以在这里找到 pdf.js：[https ://github.com/mozilla/pdf.js](https://github.com/mozilla/pdf.js)

你也可以使用 FlexPaper，它有一个 API，允许你用图像覆盖你的文档 [http://flexpaper.devaldi.com/](http://flexpaper.devaldi.com/)

# nhibernate - 模糊 NHibernate/Fluent NHibernate 错误

> ID：748044
> 
> 赞同：8
> 
> 时间：2009-04-14T15:04:48.240
> 
> 标签：nhibernate, fluent-nhibernate

尝试构建会话工厂时遇到以下错误：

```
PersistenceTests.Can_Map_Orders_To_Database : Failed 
System.IndexOutOfRangeException: Index was outside the bounds of the 
array. 
at NHibernate.Mapping.Column.set_Name(String value) 
at NHibernate.Cfg.XmlHbmBinding.ClassBinder.BindColumns(XmlNode node, 
SimpleValue model, Boolean isNullable, Boolean autoColumn, String 
propertyPath) 
at NHibernate.Cfg.XmlHbmBinding.ClassBinder.BindColumnsOrFormula 
(XmlNode node, SimpleValue simpleValue, String path, Boolean 
isNullable) 
at NHibernate.Cfg.XmlHbmBinding.ClassBinder.BindSimpleValue(XmlNode 
node, SimpleValue model, Boolean isNullable, String path) 
at 
NHibernate.Cfg.XmlHbmBinding.CollectionBinder.BindCollectionSecondPass 
(XmlNode node, Collection model, IDictionary`2 persistentClasses) 
at 
NHibernate.Cfg.XmlHbmBinding.CollectionBinder.<>c__DisplayClassd.<AddCollec tionSecondPass>b__c 
(IDictionary`2 persistentClasses) 
at NHibernate.Cfg.Configuration.SecondPassCompile() 
at NHibernate.Cfg.Configuration.BuildSessionFactory() 
at FluentNHibernate.Cfg.FluentConfiguration.BuildSessionFactory() in c: 
\Code Samples\NHibernate\Fluent Nhibernate - Trunk\src\FluentNHibernate 
\Cfg\FluentConfiguration.cs: line 94 
FluentNHibernate.Cfg.FluentConfigurationException: An invalid or 
incomplete configuration was used while creating a SessionFactory. 
Check PotentialReasons collection, and InnerException for more detail. 
at FluentNHibernate.Cfg.FluentConfiguration.BuildSessionFactory() in c: 
\Code Samples\NHibernate\Fluent Nhibernate - Trunk\src\FluentNHibernate 
\Cfg\FluentConfiguration.cs: line 99 
at FluentNHibernate.SessionSource..ctor(FluentConfiguration config) in 
c:\Code Samples\NHibernate\Fluent Nhibernate - Trunk\src 
\FluentNHibernate\SessionSource.cs: line 38 
at 
FluentNHibernate.Testing.SingleConnectionSessionSourceForSQLiteInMemoryTest ing..ctor 
(FluentConfiguration config) in c:\Code Samples\NHibernate\Fluent 
Nhibernate - Trunk\src\FluentNHibernate\Testing 
\SingleConnectionSessionSourceForSQLiteInMemoryTesting.cs: line 15 
at Core.Infrastructure.Data.NHibernate.Tests.PersistenceTests.SetUp() 
in PersistenceTests.cs: line 26 
```

我正在处理 FNH 主干和 NH 2.0.1。有趣的是我能够编译我的映射（通过 AutoPersistenceModel.CompileMappings）并将它们成功写入文件系统 - FNH 不会抱怨。只有在尝试构建会话工厂时，所有内容都会出现上述不太有用的错误消息。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-12-17T09:19:00.060

我发现内部异常提供了更多细节。就我而言，我必须将 NHibernate.ByteCode.Castle.dll 文件添加到引用中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-14T15:27:04.800

Fluent NHibernate 本身很少直接向您抱怨。在内部它只是为你构建你的 HBM 文件，所以如果你告诉它构建错误的东西，那么 NHibernate 会变得脾气暴躁。

如果您还没有，您可能希望从导出映射文件开始，如下所示：

```
.Mappings(m => m.FluentMappings.AddFromAssemblyOf<MyClass>()
    .ExportTo("path") 
```

然后你可以在那里挖掘，看看是否有问题。我确实记得以前遇到过这个错误，我认为这与映射的列数不匹配有关。这是我的映射中容易错过的错误之一，所以不幸的是，我只能建议真正搜索`ExportTo`任何没有意义的输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T15:20:23.460

我们需要查看您的配置以提供很大帮助。但是堆栈跟踪的这一部分应该让您知道从哪里开始。

> ```
> at FluentNHibernate.Cfg.FluentConfiguration.BuildSessionFactory() in c: 
> \Code Samples\NHibernate\Fluent Nhibernate - Trunk\src\FluentNHibernate 
> \Cfg\FluentConfiguration.cs: line 94 
> FluentNHibernate.Cfg.FluentConfigurationException: An invalid or 
> incomplete configuration was used while creating a SessionFactory. 
> Check PotentialReasons collection, and InnerException for more detail. 
> ```

# html - 如何在 Silverlight 文本块中显示简单的 HTML？

> ID：748050
> 
> 赞同：7
> 
> 时间：2009-04-14T15:07:00.307
> 
> 标签：html, silverlight, textblock

我有一个数据源，其中包含 HTML 标记（B、I、A），需要在 Silverlight 列表框中显示它。

搜索它似乎是一个问题，但大多数帖子都是旧的，并且似乎与 Silverlight 1 有关。

目前使用 Silverlight 显示简单 HTML 的最佳方式是什么，如果没有别的，只是粗体、斜体和超链接的 B、I 和 A 标签？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T15:19:24.867

Silverlight 2.0 中没有本机支持。但是，有人已经创建了一个`HtmlTextBlock`适合您目的的控件。查看作者关于该主题的[阻止帖子。](http://blogs.msdn.com/delay/archive/2008/03/17/continuing-support-for-simple-html-display-in-silverlight-htmltextblock-sample-updated-for-silverlight-2-beta-1.aspx)[这里](http://dlaa.me/Samples/SilverlightHtmlTextBlock/)还有一个演示页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T12:25:46.770

如果您只想在 XAML 中执行此操作：

```
<TextBlock>
    Text:&#160;<Italic>italic</Italic>&#160;and&#160;<Bold>bold</Bold>
</TextBlock> 
```

  是空间的反义词。结果是：

文本：*斜体*和**粗体**

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-11-27T08:56:56.503

这个评论系统很古怪。我昨晚添加了2条评论。添加第二个后，我仍然只能看到第一个。今天早上，在清除浏览器 cookie 后，我只看到了我的第二个。奇怪。

无论如何，我在绑定其 Html 属性的控件上遇到了问题，并且每次属性更改时它都会附加 html。我通过在方法顶部添加以下内容来修复它`ParseAndSetText()`：

```
this.SelectAll();            
this.Selection.Text = ""; 
```

我还遇到了一个问题，即当 DOM 解析例程失败时引发异常，我通过更改来修复它：

```
Xaml = null; 
```

和

```
this.SelectAll();            
this.Selection.Text = ""; 
```

# .net - 在大型项目中组织 WPF 样式和 ResourceDictionaries 的最佳方式是什么？

> ID：748053
> 
> 赞同：12
> 
> 时间：2009-04-14T15:08:11.413
> 
> 标签：.net, wpf, xaml

我有一个使用大量样式、画笔和主题的大型 WPF 应用程序。与多个开发人员一起管理大量样式变得越来越困难。现在，我们的大多数应用程序范围的样式都在一个资源字典中，而主题画笔则在各自的资源字典中。

问题是很难找到我们想要使用的样式，因为主要资源字典已经变得如此之大。关于重组这个的最佳方法有什么建议吗？我已经考虑将它分成单独的资源字典，用于样式所针对的控件类型。例如 ButtonStyles.xaml 字典，但我不确定这是否是正确的方法。

如果有人对他们如何组织他们的大型资源词典有任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-14T15:12:32.307

绝对使用多个资源字典是要走的路。合并资源字典的能力一直是 Silverlight 开发人员的障碍（直到 3.0），但从一开始就对 WPF 开发人员有利。

对于中型项目，我强烈建议将您的资源聚集在指示特定类型的字典中，例如 ButtonStyles.xaml 和 Brushes.xaml 和 Images.xaml 等。

对于非常大的项目，如果您有多个共享资源字典的多个贡献者，这些资源字典可能会被多个 WPF 应用程序和前端使用，我建议您创建一个完整的单独程序集，其中包含您的所有资源字典。

我没有亲自尝试过，但有人告诉我，Expression Blend 2 甚至在 Blend 3 中更是如此，具有非常好的 GUI，可用于构建和组织资源字典以及将每个控件样式转换为资源等。

# ant - 操作系统升级后无法从 ANT 访问环境变量

> ID：748054
> 
> 赞同：1
> 
> 时间：2009-04-14T15:08:38.743
> 
> 标签：ant, windows-server-2003, upgrade

服务器从 Windows 2000 升级到 Windows 2003，现在我无法从 Ant 构建脚本访问环境变量。

我仍然可以从命令行很好地访问它们，但`${env.JAVA_HOME}`例如失败。

如何在不重写可在所有其他服务器上为该服务器定制的约 100 个构建脚本的情况下解决此问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T15:25:24.150

不幸的是，我认为您不应该使用该环境变量。为了解决这些问题，`${java.home}`您可以使用内置的，它不依赖于正确设置的操作系统和/或用户环境。（参见[Ant 手册](http://ant.apache.org/manual/using.html#built-in-props)中关于 Ant内置属性的讨论。）

您可以通过 (1) 手动设置 JAVA_HOME 环境变量或 (2) 修改 ant.bat 文件以手动分配它来绕过重写所有构建脚本。这两个选项都很脆弱，因为它们会在 Java 升级时中断，但至少它们可能会很快失败。

# bash - 需要一种方法来收集 JAR 文件的总大小

> ID：748056
> 
> 赞同：0
> 
> 时间：2009-04-14T15:08:41.520
> 
> 标签：bash, jar, size

我是更高级的 bash 命令的新手。我需要一种方法来计算代码行中外部库的大小。有几个主要目录，但我也有一个电子表格，其中包含需要包含的库的实际位置。

我已经摆弄过`find`，`du`但我不清楚如何指定多个位置。我可以找到电子表格中列出的数百个罐子的大小，而不是与主目录近似吗？

**编辑：**我现在可以找到特定文件的大小。我必须将带有位置的 excel 电子表格导出到 csv。在 PSPad 中，我“加入行”并将其复制并直接粘贴到`list_of_files`插槽中。( `find list_of_files | xargs du -hc`)。我无法`find`使用包含由空格/制表符/行分隔的位置的文件。

现在我不知道替换是否`list_of_files`会`list_of_directories`起作用。看起来它计算了两次，例如

```
1.0M /folder/dummy/image1.jpg  
1.0M /folder/dummy/image2.jpg  
2.0M /folder/dummy  
3.0M /folder/image3.jpg  
7.0M /folder  
14.0M total 
```

这是假的，但如果它是这样计数的，那不是我想要的。我怀疑这是因为我得到的总数似乎真的很高。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T15:12:01.187

你的意思是...

```
find list_of_directories | xargs du -hc 
```

然后，如果您想精确地通过管道传输到电子表格中列出的文件，您需要一种过滤它们的方法。它是文本文件还是哪种格式？

```
find `(cat file)` | xargs du -hc 
```

如果它们以空格分隔的列表形式存在于 txt 文件中，则可能会这样做。可能你会有一些关于空格的问题......你必须引用文件名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T15:22:59.177

```
for fn in `find DIR1 DIR2 FILE1 -name *.jar`; do du $fn; done | awk '{TOTAL += $1} END {print TOTAL}' 
```

您可以指定文件和目录来代替 DIR1、DIR2、FILE1 等。您可以通过删除管道 awk 命令列出它们各自的大小。

# iphone - iPhone - 奇怪的编译错误

> ID：748061
> 
> 赞同：1
> 
> 时间：2009-04-14T15:11:42.997
> 
> 标签：iphone, cocoa-touch, xcode, interface-builder, compilation

我有一个运行良好的 iPhone (Xcode) 项目。必须更改某些内容，因为突然间我收到了与`NSLog`,`UIActionSheet`和其他几个我一直使用*JUST FINE*的项目有关的错误。我错过了什么？任何帮助将不胜感激！

```
Checking Dependencies

Ld /Users/markgoldberg/Documents/iPhoneApps/iPhone_PNP/build/Debug-iphonesimulator/iPhone_PNP.app/iPhone_PNP normal i386
    cd /Users/markgoldberg/Documents/iPhoneApps/iPhone_PNP
    setenv MACOSX_DEPLOYMENT_TARGET 10.5
    setenv PATH "/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    /Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/gcc-4.2 -arch i386 -isysroot /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator3.0.sdk -L/Users/markgoldberg/Documents/iPhoneApps/iPhone_PNP/build/Debug-iphonesimulator -F/Users/markgoldberg/Documents/iPhoneApps/iPhone_PNP/build/Debug-iphonesimulator -filelist /Users/markgoldberg/Documents/iPhoneApps/iPhone_PNP/build/iPhone_PNP.build/Debug-iphonesimulator/iPhone_PNP.build/Objects-normal/i386/iPhone_PNP.LinkFileList -mmacosx-version-min=10.5 -framework Foundation -framework UIKit -framework CoreGraphics -o /Users/markgoldberg/Documents/iPhoneApps/iPhone_PNP/build/Debug-iphonesimulator/iPhone_PNP.app/iPhone_PNP
Undefined symbols:
  ".objc_class_name_SettingsWindowViewController", referenced from:
      literal-pointer@__OBJC@__cls_refs@SettingsWindowViewController in iPhone_PNPAppDelegate.o
ld: symbol(s) not found
collect2: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T17:52:15.207

你解决了这个问题，但你可能不知道为什么。知道出了什么问题以及为什么要修复它可能很重要，这样您就可以使它不再发生。

问题很可能是您的 SettingsWindowViewController.m 文件不是您正在构建的 iPhone_PNP 目标的成员。项目只是容器；目标实际上构建了东西，如果一个文件在项目中但没有分配给目标，它将不会被构建。

删除文件并重新添加默认为将其添加到当前目标。您可能已经看到一个带有复选框的列表并且没有注意到它，但是该复选框是解决问题的原因。

将来更简单的方法是将源文件拖到目标中，或者在其上选择获取信息，然后单击“常规”选项卡中的目标复选框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T15:23:30.673

尝试干净的构建。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T11:24:40.973

您尚未在`SettingsWindowViewController`任何地方定义该类。

从您的解决方案（`SettingsWindowViewController.m`从项目中删除并重新添加它）看起来它们没有包含在目标的“编译源”阶段（如 cdespinosa 建议的那样）。您可以通过在“组和文件”窗格的目标项中打开“编译源”twistie 来检查这一点。

除了 cdespinosa 建议设置目标成员的方法外，您还可以通过左键单击标题在“组和文件”窗格中显示带有“目标成员”的额外列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T12:50:30.190

好的 - 我从这个 URL 找到了问题： http: [//forums.macrumors.com/showthread.php?t=475818](http://forums.macrumors.com/showthread.php?t=475818)

我只需要从我的项目中删除我的 SettingsWindowViewController.h 和 SettingsWindowViewController.m 文件并重新添加它们。问题已解决。

谢谢你们！

# c# - 将多个值返回给方法调用者

> ID：748062
> 
> 赞同：570
> 
> 时间：2009-04-14T15:11:57.660
> 
> 标签：c#, return

我阅读了[这个问题的 C++ 版本，](https://stackoverflow.com/questions/321068/returning-multiple-values-from-a-c-function)但并没有真正理解它。

有人可以清楚地解释它是否可以在 C# 中完成，以及如何完成？

* * *

## 回答 #1

> 赞同：723
> 
> 时间：2012-04-23T10:24:13.400

在 C# 7 及更高版本中，请参阅[此答案](https://stackoverflow.com/a/36436255/316760)。

在以前的版本中，您可以使用[.NET 4.0+ 的 Tuple](http://msdn.microsoft.com/en-us/library/system.tuple.aspx)：

例如：

```
public Tuple<int, int> GetMultipleValue()
{
     return Tuple.Create(1,2);
} 
```

具有两个值的元组具有`Item1`和`Item2`作为属性。

* * *

## 回答 #2

> 赞同：662
> 
> 时间：2016-04-05T20:19:32.903

现在 C# 7 已经发布，您可以使用新包含的元组语法

```
(string, string, string) LookupName(long id) // tuple return type
{
    ... // retrieve first, middle and last from data storage
    return (first, middle, last); // tuple literal
} 
```

然后可以这样使用：

```
var names = LookupName(id);
WriteLine($"found {names.Item1} {names.Item3}."); 
```

您还可以为您的元素提供名称（因此它们不是“Item1”、“Item2”等）。您可以通过在签名或返回方法中添加名称来做到这一点：

```
(string first, string middle, string last) LookupName(long id) // tuple elements have names 
```

或者

```
return (first: first, middle: middle, last: last); // named tuple elements in a literal 
```

它们也可以被解构，这是一个非常不错的新特性：

```
(string first, string middle, string last) = LookupName(id1); // deconstructing declaration 
```

查看[此链接](https://blogs.msdn.microsoft.com/dotnet/2017/03/09/new-features-in-c-7-0/)以查看有关可以做什么的更多示例：)

* * *

## 回答 #3

> 赞同：262
> 
> 时间：2015-06-03T23:04:41.317

您可以使用三种不同的方式

**1\. ref/out 参数**

**使用参考：**

```
static void Main(string[] args)
{
    int a = 10;
    int b = 20;
    int add = 0;
    int multiply = 0;
    Add_Multiply(a, b, ref add, ref multiply);
    Console.WriteLine(add);
    Console.WriteLine(multiply);
}

private static void Add_Multiply(int a, int b, ref int add, ref int multiply)
{
    add = a + b;
    multiply = a * b;
} 
```

**用完：**

```
static void Main(string[] args)
{
    int a = 10;
    int b = 20;
    int add;
    int multiply;
    Add_Multiply(a, b, out add, out multiply);
    Console.WriteLine(add);
    Console.WriteLine(multiply);
}

private static void Add_Multiply(int a, int b, out int add, out int multiply)
{
    add = a + b;
    multiply = a * b;
} 
```

**2.结构/类**

**使用结构：**

```
struct Result
{
    public int add;
    public int multiply;
}
static void Main(string[] args)
{
    int a = 10;
    int b = 20;
    var result = Add_Multiply(a, b);
    Console.WriteLine(result.add);
    Console.WriteLine(result.multiply);
}

private static Result Add_Multiply(int a, int b)
{
    var result = new Result
    {
        add = a * b,
        multiply = a + b
    };
    return result;
} 
```

**使用类：**

```
class Result
{
    public int add;
    public int multiply;
}
static void Main(string[] args)
{
    int a = 10;
    int b = 20;
    var result = Add_Multiply(a, b);
    Console.WriteLine(result.add);
    Console.WriteLine(result.multiply);
}

private static Result Add_Multiply(int a, int b)
{
    var result = new Result
    {
        add = a * b,
        multiply = a + b
    };
    return result;
} 
```

**3\. 元组**

**元组类**

```
static void Main(string[] args)
{
    int a = 10;
    int b = 20;
    var result = Add_Multiply(a, b);
    Console.WriteLine(result.Item1);
    Console.WriteLine(result.Item2);
}

private static Tuple<int, int> Add_Multiply(int a, int b)
{
    var tuple = new Tuple<int, int>(a + b, a * b);
    return tuple;
} 
```

**C# 7 元组**

```
static void Main(string[] args)
{
    int a = 10;
    int b = 20;
    (int a_plus_b, int a_mult_b) = Add_Multiply(a, b);
    Console.WriteLine(a_plus_b);
    Console.WriteLine(a_mult_b);
}

private static (int a_plus_b, int a_mult_b) Add_Multiply(int a, int b)
{
    return(a + b, a * b);
} 
```

* * *

## 回答 #4

> 赞同：75
> 
> 时间：2009-04-14T15:16:22.610

您不能在 C# 中执行此操作。您可以做的是有一个`out`参数或返回您自己的类（或结构，如果您希望它是不可变的）。

使用 out 参数

```
public int GetDay(DateTime date, out string name)
{
  // ...
} 
```

使用自定义类（或结构）

```
public DayOfWeek GetDay(DateTime date)
{
  // ...
}

public class DayOfWeek
{
  public int Day { get; set; }
  public string Name { get; set; }
} 
```

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2017-03-09T11:43:19.850

在 C#7 中有一个新的`Tuple`语法：

```
static (string foo, int bar) GetTuple()
{
    return ("hello", 5);
} 
```

您可以将此作为记录返回：

```
var result = GetTuple();
var foo = result.foo
// foo == "hello" 
```

您还可以使用新的解构器语法：

```
(string foo) = GetTuple();
// foo == "hello" 
```

但是要小心序列化，所有这些都是语法糖——在实际编译的代码中，这将是一个`Tuple<string, int>`（根据[接受的答案](https://stackoverflow.com/a/10278769/905)），带有`Item1`and`Item2`而不是`foo`and `bar`。这意味着序列化（或反序列化）将使用这些属性名称。

因此，对于序列化，声明一个记录类并返回它。

C#7 中的新功能还有改进的`out`参数语法。您现在可以声明`out`内联，这在某些情况下更适合：

```
if(int.TryParse("123", out int result)) {
    // Do something with result
} 
```

但是，大多数情况下，您将在 .NET 自己的库中使用它，而不是在您自己的函数中。

* * *

## 回答 #6

> 赞同：40
> 
> 时间：2009-04-14T15:15:01.663

如果您的意思是返回多个值，您可以返回包含要返回的值的类/结构，或者在参数上使用“out”关键字，如下所示：

```
public void Foo(int input, out int output1, out string output2, out string errors) {
    // set out parameters inside function
} 
```

* * *

## 回答 #7

> 赞同：33
> 
> 时间：2009-04-14T15:18:02.590

之前的海报是对的。您不能从 C# 方法返回多个值。但是，您确实有几个选择：

*   返回包含多个成员的结构
*   返回一个类的实例
*   使用输出参数（使用**out**或**ref**关键字）
*   使用字典或键值对作为输出

这里的利弊通常很难弄清楚。如果您返回一个结构，请确保它很小，因为结构是值类型并在堆栈上传递。如果你返回一个类的实例，这里有一些设计模式，你可能想使用它们来避免引起问题 - 类的成员可以被修改，因为 C# 通过引用传递对象（你没有像在 VB 中那样的 ByVal ）。

最后，您可以使用输出参数，但我会将它的使用限制在只有几个（例如 3 个或更少）参数的情况下 - 否则事情会变得丑陋且难以维护。此外，使用输出参数可能会阻碍敏捷性，因为每次需要向返回值添加某些内容时，方法签名都必须更改，而返回结构或类实例时，您可以在不修改方法签名的情况下添加成员。

从架构的角度来看，我建议不要使用键值对或字典。我发现这种编码风格需要使用该方法的代码中的“秘密知识”。它必须提前知道键将是什么以及值的含义，并且如果从事内部实现的开发人员更改了创建字典或 KVP 的方式，它可以很容易地在整个应用程序中创建故障级联。

* * *

## 回答 #8

> 赞同：33
> 
> 时间：2019-09-05T14:42:01.677

有很多方法；但是如果您不想创建新的对象或结构或类似的东西，您可以在[C# 7.0](https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-7)之后执行以下操作：

```
 (string firstName, string lastName) GetName(string myParameter)
    {
        var firstName = myParameter;
        var lastName = myParameter + " something";
        return (firstName, lastName);
    }

    void DoSomethingWithNames()
    {
        var (firstName, lastName) = GetName("myname");

    } 
```

* * *

## 回答 #9

> 赞同：23
> 
> 时间：2009-04-14T15:16:10.240

您要么返回一个*类实例*，要么使用*out*参数。下面是一个输出参数的例子：

```
void mymethod(out int param1, out int param2)
{
    param1 = 10;
    param2 = 20;
} 
```

像这样称呼它：

```
int i, j;
mymethod(out i, out j);
// i will be 20 and j will be 10 
```

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2016-08-27T16:24:17.373

> 一些答案建议使用**out 参数**，但我建议不要使用它，因为**它们不适用于 async methods**。有关更多信息，请参阅 [此](https://stackoverflow.com/questions/18716928/how-to-write-a-async-method-with-out-parameter)。

其他答案使用元组，我也推荐使用 C# 7.0 中引入的新功能。

```
(string, string, string) LookupName(long id) // tuple return type
{
    ... // retrieve first, middle and last from data storage
    return (first, middle, last); // tuple literal
}

var names = LookupName(id);
WriteLine($"found {names.Item1} {names.Item3}."); 
```

更多信息可以在[这里](https://blogs.msdn.microsoft.com/dotnet/2016/08/24/whats-new-in-csharp-7-0/)找到。

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2009-04-14T15:18:41.857

不，您不能从 C# 中的函数返回多个值（对于低于 C# 7 的版本），至少不能像在 Python 中那样。

但是，有几种选择：

您可以返回一个类型为对象的数组，其中包含您想要的多个值。

```
private object[] DoSomething()
{
    return new [] { 'value1', 'value2', 3 };
} 
```

您可以使用`out`参数。

```
private string DoSomething(out string outparam1, out int outparam2)
{
    outparam1 = 'value2';
    outparam2 = 3;
    return 'value1';
} 
```

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2009-04-14T15:19:55.333

有几种方法可以做到这一点。您可以使用`ref`参数：

```
int Foo(ref Bar bar) { } 
```

这会传递对函数的引用，从而允许函数修改调用代码堆栈中的对象。虽然这在技术上不是“返回”值，但它是一种让函数执行类似操作的方法。在上面的代码中，函数将返回一个`int`和（可能）修改`bar`。

另一种类似的方法是使用`out`参数。参数与具有附加的编译器强制规则的`out`参数相同。`ref`这条规则是，如果您将`out`参数传递给函数，则该函数需要在返回之前设置其值。除了该规则之外，`out`参数的工作方式就像`ref`参数一样。

最后一种方法（在大多数情况下也是最好的方法）是创建一个封装两个值并允许函数返回的类型：

```
class FooBar 
{
    public int i { get; set; }
    public Bar b { get; set; }
}

FooBar Foo(Bar bar) { } 
```

最后一种方法更简单，更容易阅读和理解。

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2019-01-18T04:30:30.797

```
<--Return more statements like this you can --> 

public (int,string,etc) Sample( int a, int b)  
{
    //your code;
    return (a,b);  
} 
```

您可以收到类似的代码

```
(c,d,etc) = Sample( 1,2); 
```

我希望它有效。

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2009-04-14T15:17:27.397

在 C# 4 中，您将能够使用对元组的内置支持来轻松​​处理此问题。

与此同时，有两种选择。

首先，您可以使用 ref 或 out 参数为您的参数分配值，这些值将被传递回调用例程。

这看起来像：

```
void myFunction(ref int setMe, out int youMustSetMe); 
```

其次，您可以将返回值包装到一个结构或类中，并将它们作为该结构的成员传回。KeyValuePair 适用于 2 - 对于超过 2，您将需要自定义类或结构。

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2012-03-06T10:53:42.697

你可以试试这个“KeyValuePair”

```
private KeyValuePair<int, int> GetNumbers()
{
  return new KeyValuePair<int, int>(1, 2);
}

var numbers = GetNumbers();

Console.WriteLine("Output : {0}, {1}",numbers.Key, numbers.Value); 
```

**输出 ：**

*输出：1、2*

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2009-04-14T15:16:56.883

类、结构、集合和数组可以包含多个值。输出和参考参数也可以在函数中设置。通过元组在动态和函数语言中返回多个值是可能的，但在 C# 中则不行。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2009-04-14T15:51:39.313

主要有两种方法。1\. 使用 out/ref 参数 2\. 返回一个对象数组

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2013-09-20T06:41:17.877

以下是基本`Two`方法：

**1) 使用 ' `out`' 作为参数** 您也可以将 'out' 用于 4.0 和次要版本。

**“出”的例子：**

```
using System;

namespace out_parameter
{
  class Program
   {
     //Accept two input parameter and returns two out value
     public static void rect(int len, int width, out int area, out int perimeter)
      {
        area = len * width;
        perimeter = 2 * (len + width);
      }
     static void Main(string[] args)
      {
        int area, perimeter;
        // passing two parameter and getting two returning value
        Program.rect(5, 4, out area, out perimeter);
        Console.WriteLine("Area of Rectangle is {0}\t",area);
        Console.WriteLine("Perimeter of Rectangle is {0}\t", perimeter);
        Console.ReadLine();
      }
   }
} 
```

**输出：**

矩形的面积是 20

矩形的周长是 18

**注意：* *- `out`keyword 描述了参数的实际变量位置被复制到被调用方法的堆栈中，这些相同的位置可以被重写。这意味着调用方法将访问更改的参数。

**2)`Tuple<T>`**

**元组示例：**

使用返回多个 DataType 值`Tuple<T>`

```
using System;

class Program
{
    static void Main()
    {
    // Create four-item tuple; use var implicit type.
    var tuple = new Tuple<string, string[], int, int[]>("perl",
        new string[] { "java", "c#" },
        1,
        new int[] { 2, 3 });
    // Pass tuple as argument.
    M(tuple);
    }

    static void M(Tuple<string, string[], int, int[]> tuple)
    {
    // Evaluate the tuple's items.
    Console.WriteLine(tuple.Item1);
    foreach (string value in tuple.Item2)
    {
        Console.WriteLine(value);
    }
    Console.WriteLine(tuple.Item3);
    foreach (int value in tuple.Item4)
    {
        Console.WriteLine(value);
    }
    }
} 
```

**输出**

```
perl
java
c#
1
2
3 
```

*注意：* **元组的使用从 Framework 4.0 及更高版本开始有效**。`Tuple`类型是一个`class`. 它将分配在内存中托管堆上的单独位置。创建 后`Tuple`，您无法更改其值`fields`。这使得它`Tuple`更像一个`struct`.

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2015-09-11T05:56:43.697

采用委托的方法可以向调用者提供多个值。这借用了我[在这里](https://stackoverflow.com/a/32515539/5062254)的答案，并使用了一些来自[Hadas 接受的答案](https://stackoverflow.com/a/10278769/5062254)。

```
delegate void ValuesDelegate(int upVotes, int comments);
void GetMultipleValues(ValuesDelegate callback)
{
    callback(1, 2);
} 
```

调用者提供一个 lambda（或命名函数），而智能感知通过从委托中复制变量名称来提供帮助。

```
GetMultipleValues((upVotes, comments) =>
{
     Console.WriteLine($"This post has {upVotes} Up Votes and {comments} Comments.");
}); 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2015-11-23T20:15:40.957

从[本文](http://www.dotnetperls.com/multiple-return-values)中，您可以使用上述帖子中的三个选项。

**KeyValuePair**是最快的方法。

**出**在第二个。

**元组**是最慢的。

无论如何，这取决于最适合您的方案。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2014-11-21T10:32:39.980

只需以 OOP 方式使用这样的类：

```
class div
{
    public int remainder;

    public int quotient(int dividend, int divisor)
    {
        remainder = ...;
        return ...;
    }
} 
```

函数成员返回大多数调用者主要感兴趣的商。此外，它将余数存储为数据成员，之后调用者可以轻松访问。

通过这种方式，您可以获得许多额外的“返回值”，如果您实现数据库或网络调用，则非常有用，其中可能需要大量错误消息，但仅在发生错误的情况下。

我也在 OP 所指的 C++ 问题中输入了这个解决方案。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2016-05-27T14:24:58.353

您可以使用动态对象。我认为它比 Tuple 具有更好的可读性。

```
static void Main(string[] args){
    var obj = GetMultipleValues();
    Console.WriteLine(obj.Id);
    Console.WriteLine(obj.Name);
}

private static dynamic GetMultipleValues() {
    dynamic temp = new System.Dynamic.ExpandoObject();
    temp.Id = 123;
    temp.Name = "Lorem Ipsum";
    return temp;
} 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2016-06-28T08:23:24.470

C# 的未来版本将包括命名元组。看看这个 channel9 会话的演示 [https://channel9.msdn.com/Events/Build/2016/B889](https://channel9.msdn.com/Events/Build/2016/B889)

跳到 13:00 获取元组内容。这将允许以下内容：

```
(int sum, int count) Tally(IEnumerable<int> list)
{
// calculate stuff here
return (0,0)
}

int resultsum = Tally(numbers).sum 
```

（视频中的不完整示例）

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2015-08-27T21:46:51.323

方法：

1）KeyValuePair（最佳性能 - 0.32 ns）：

```
 KeyValuePair<int, int> Location(int p_1, int p_2, int p_3, int p_4)
    {                 
         return new KeyValuePair<int,int>(p_2 - p_1, p_4-p_3);
    } 
```

2) 元组 - 5.40 ns：

```
 Tuple<int, int> Location(int p_1, int p_2, int p_3, int p_4)
    {
          return new Tuple<int, int>(p_2 - p_1, p_4-p_3);
    } 
```

3) out (1.64 ns) 或 ref 4) 创建您自己的自定义类/结构

ns -> 纳秒

参考：[多返回值](http://www.dotnetperls.com/multiple-return-values)。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2016-09-13T12:21:02.450

您还可以使用 OperationResult

```
public OperationResult DoesSomething(int number1, int number2)
{
// Your Code
var returnValue1 = "return Value 1";
var returnValue2 = "return Value 2";

var operationResult = new OperationResult(returnValue1, returnValue2);
return operationResult;
} 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2013-08-16T09:38:55.097

你可以试试这个

```
public IEnumerable<string> Get()
 {
     return new string[] { "value1", "value2" };
 } 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2021-09-12T20:07:54.683

作为替代方案，您可以将方法设置为 void 并且不返回任何内容。而是创建一个带有参数的公共类并将它们设置在您的方法中。

```
public class FooBar()
{
    public string foo { get; set; }
    public int bar { get; set; }
} 
```

然后为你的方法试试这个

```
public void MyMethod(Foo foo, Bar bar)
{
    FooBar fooBar = new FooBar();
    fooBar.foo = "some string";
    fooBar.bar = 1;
} 
```

# jquery - 使用 live() - 好处 - 类似于 bind()

> ID：748076
> 
> 赞同：9
> 
> 时间：2009-04-14T15:15:36.467
> 
> 标签：jquery

我一直在阅读有关 jquery 现场活动的一些信息，但仍然有点困惑？使用它有什么好处？

[http://docs.jquery.com/Events/live](http://docs.jquery.com/Events/live)

我知道它与 bind 类似，但是这两个事件在我看来仍然不合适。

只是寻找一些指针。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-14T15:21:00.103

> **警告**：这个答案是旧的。**仍然非常有用**，但`live`在较新版本的 jQuery 中已被弃用和删除。所以请阅读答案，因为用例没有改变，您将了解为什么以及何时使用较少的事件处理程序。但除非您仍在使用真正旧版本的 jQuery（v1.4.2 或更早版本），否则您应该考虑编写新的等效代码。如[jQuery API 中`live`](http://api.jquery.com/live/#entry-longdesc)所述并在此处复制：
> 
> > `.live()`根据其后继者重写该方法很简单；这些是对所有三种事件附件方法进行等效调用的模板：
> > 
> > 1.  `$( selector ).live( events, data, handler ); // jQuery 1.3+`
> > 2.  `$( document ).delegate( selector, events, data, handler ); // jQuery 1.4.3+`
> > 3.  `$( document ).on( events, selector, data, handler ); // jQuery 1.7+`

有时在页面加载时你有一组元素，比如编辑链接：

```
<table>
  <tr>
    <td>Item 1</td>
    <td><a href="#" class="edit">Edit</a></td>
  </tr>
  <tr>
    <td>Item 2</td>
    <td><a href="#" class="edit">Edit</a></td>
  </tr>
  <tr>
    <td>Item 3</td>
    <td><a href="#" class="edit">Edit</a></td>
  </tr>
</table> 
```

现在，也许你对 jQuery 有类似的东西：

```
$(document).ready(function() {
  $('a.edit').click(function() {
    // do something
    return false;
  });
}); 
```

但是，如果您在页面初始加载后动态地向该表添加新元素怎么办？

```
$('table').append('
    <tr><td>Item 4</td><td><a href="#" class="edit">Edit</a></td></tr>
'); 
```

当您在此新项目上单击“编辑”时，不会发生任何事情，因为事件是在页面加载时绑定的。进入直播。有了它，你可以像这样绑定上面的事件：

```
$(document).ready(function() {
  $('a.edit').live('click', function() {
    // do something
    return false;
  });
}); 
```

现在，如果您在页面初始加载后添加任何`<a>`具有类的新元素`edit`，它仍将注册此事件处理程序。

但是这是如何实现的呢？

jQuery 使用所谓的事件委托来实现此功能。事件委托在这种情况下或当您想要加载大量处理程序时很有帮助。假设您有一个带有图像的 DIV：

```
<div id="container">
    <img src="happy.jpg">
    <img src="sad.jpg">
    <img src="laugh.jpg">
    <img src="boring.jpg">
</div> 
```

但是不是 4 个图像，而是 100 个、200 个或 1000 个。您希望将单击事件绑定到图像，以便在用户单击它时执行 X 操作。做你可能期望的...

```
$('#container img').click(function() {
    // do something
}); 
```

...然后将绑定数百个都做同样事情的处理程序！这是低效的，并且可能导致繁重的 web 应用程序性能下降。使用事件委托，即使您以后不打算添加更多图像，在这种情况下使用 live 会更好，因为您可以将**一个**处理程序绑定到容器并检查目标是否是图像，然后执行操作：

```
// to achieve the effect without live...
$('#container').click(function(e) {
    if($(e.target).is('img')) {
        performAction(e.target);
    }
});

// or, with live:
$('img', '#container').live('click', function() {
    performAction(this);
}); 
```

由于 jQuery 知道以后可以添加新元素或者性能很重要，因此它可能会像第一个示例中那样将事件添加到 div 而不是将事件绑定到实际图像（实际上，我很确定它绑定它们到主体，但它可能到上面示例中的容器），然后委托。此`e.target`属性可以让它在事后检查被单击/执行的事件是否与您可能指定的选择器匹配。

明确一点：这不仅有助于不必重新绑定事件的直接方式，而且对于大量项目来说它可以显着加快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T15:20:09.030

基本上，`.live()`如果您有一个非常动态的网站，您不必费心更新事件处理程序。

```
$('.hello').live('click', function () {
  alert('Hello!');
}); 
```

该示例将单击事件绑定到任何已经具有“hello”类的元素*以及*任何动态插入的元素，无论是通过 AJAX 还是通过老式 JavaScript。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T15:20:28.013

好处是事件处理程序也将在创建这些元素时添加到新的匹配元素。这使您不必在每次创建需要它的新元素（匹配以前使用的选择器）时手动添加事件处理程序。

> 在 jQuery 1.3 中添加：将处理程序绑定到所有当前**和未来**匹配元素的事件（如单击）。

来自[http://docs.jquery.com/Events/live#typefn](http://docs.jquery.com/Events/live#typefn)，强调我的。

# c# - 寻找新电子邮件的实时 IMAP 通知

> ID：748079
> 
> 赞同：10
> 
> 时间：2009-04-14T15:16:07.447
> 
> 标签：c#, email, imap, notifications, instant

我正在寻找一种方法来监视 GMail 收件箱中的新电子邮件。但是，我想避免每隔几分钟检查一次，我正在寻找某种实时通知。我注意到 Outlook（和其他支持 IMAP 的客户端）在有新电子邮件时会立即显示，但不幸的是，所有 .NET IMAP 库似乎都缺少此功能。

有谁知道具有此功能的 IMAP 库？还是有另一种方法可以在不进行短期轮询的情况下立即通知新消息？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-14T15:24:32.403

您需要处理[IMAP IDLE](http://www.isode.com/whitepapers/imap-idle.html)。

这将在新消息到达时通知您，而无需不断轮询（这很糟糕）。

* * *

[MailBee.Net](http://www.afterlogic.com/mailbee-net/net-imap-component.asp)是一个非常好的商业 .NET IMAP 库。不久前我将它用于一个小项目，它似乎处理得很好，并且相当容易使用。可能还有其他的——只要在你的库中搜索发送 IDLE 命令或 IDLE 命令处理，你可能会找到一些东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-04-15T05:00:14.857

Mail.dll 支持 IDLE。这是简化的示例：

```
using (Imap client = new Imap())
{
    client.ConnectSSL("imap.server.com");
    client.Login("user@server.com", "password");

    FolderStatus folderStatus = client.SelectInbox();
    Console.WriteLine("Total message count: {0}",
        folderStatus.MessageCount);

    while(true)
    {
        FolderStatus currentStatus = client.Idle();
        Console.WriteLine("Total message count: {0}",
                currentStatus.MessageCount);
        foreach(long uid in client.SearchFlag(Flag.Unseen))
        {
            IMail email = new MailBuilder().CreateFromEml(
                client.GetHeadersByUID(uid));
            Console.WriteLine(email.Subject);
        }
    }
    client.Close();
} 
```

您可以在以下网址下载 Mail.dll：http: [//www.lesnikowski.com/mail/](http://www.lesnikowski.com/mail/)

另请查看我的[博客以获取示例](http://www.lesnikowski.com/blog/index.php/imap-idle/)。

请注意，Mail.dll 是我创建的商业产品。

@Queops

以下是来自 2 个在线防病毒扫描程序的报告：

[www.viruschief.com](http://www.viruschief.com/report.html?report_id=06549db0f13a1083f033a34eaf545cb3922c43e0)

[www.virustotal.com](http://www.virustotal.com/file-scan/report.html?id=dbf1a2b64486ab00baa73ceba863fe9869defd9a11ffc4c0a5a4ffb59bc39fe6-1288190138)

请注意，VirusTotal 正在使用 Symantec 扫描程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-27T10:43:33.287

Try free .NET library for accessing IMAP server [S22.Imap](https://github.com/smiley22/S22.Imap), with IDLE support

# asp.net - 从 ASPX 将多个 Eval() 传递给 JavaScript 函数

> ID：748080
> 
> 赞同：3
> 
> 时间：2009-04-14T15:16:08.773
> 
> 标签：asp.net, javascript

我正在尝试将多个`Eval()`参数从`.aspx`文件传递给 JavaScript 函数，但我不断收到编译器错误。我是 JavaScript 新手，以前从未真正使用`Eval()`过。我哪里错了？

**注意**：下面显示的行实际上都在一行上，但为了清楚起见，将其包裹在此处：

```
<asp:LinkButton runat="server" Text='<%#Eval("Title")%>'
    OnClick='javascript:ShowEventDetails'
    CommandArgument='<%#
        Eval("EventID").ToString()          & Eval("Title").ToString() &
        Eval("Location").ToString()         & Eval("StartTime").ToString() &
        Eval("Description").ToString()      & Eval("Link").ToString() &
        Eval("ContactFirstName").ToString() & Eval("ContactLastName").ToString() &
        Eval("ContactEmail").ToString()     & Eval("InsertionTime").ToString() &
        Eval("EventAdmin").ToString()%>); ' /> 
```

有没有更好的方法来做到这一点？如果是这样，它们是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T15:31:17.083

[OnClick](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.onclick.aspx)是控件上的一个属性，它需要对事件处理程序方法的引用。将 JavaScript 放入 OnClick 属性将不起作用。

如果您想在单击按钮时执行任意 JavaScript，请使用[OnClientClick](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.onclientclick.aspx)。我假设您想将 evals 作为参数传递给 ShowEventDetails（为便于阅读而格式化）：

```
<asp:LinkButton ID="LinkButton1" runat="server" Text='<%# Eval("Title")%>' 
    OnClientClick='ShowEventDetails("<%# Eval("EventID").ToString() %>",
        "<%# Eval("Title").ToString() %>",
        "<%# Eval("Location").ToString() %>",
        "<%# Eval("StartTime").ToString() %>",
        "<%# Eval("Description").ToString() %>",
        "<%# Eval("Link").ToString() %>",
        "<%# Eval("ContactFirstName").ToString() %>",
        "<%# Eval("ContactLastName").ToString() %>",
        "<%# Eval("ContactEmail").ToString() %>",
        "<%# Eval("InsertionTime").ToString() %>",
        "<%# Eval("EventAdmin").ToString() %>");' /> 
```

本质上，您正在构建一个长字符串：

```
ShowEventDetails('123','Event Title','New York' ... etc ... 
```

单击 LinkBut​​ton 时在 JS 中执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-29T16:02:20.443

The best way to do this is to set the `OnClientClick` property in the code-behind, like so:

```
LinkButton lb = new LinkButton(); //Instantiate the linkbutton wherever you need to 
```

Once you do, use `String.Format` to put your items into the `OnClientClick` property.

```
lb.OnClientClick = String.Format("javascript:ShowEventDetails
( '{0}', '{1}', '{2}', '{3}', '{4}', '{5}', '{6}', '{7}', '{8}', '{9}', '{10}');", 
  EventID.ToString(), Title.ToString(), Location.ToString(), StartTime.ToString(), 
  Description.ToString(), Link.ToString(), ContactFirstName.ToString(),
  ContactLastName.ToString(), ContactEmail.ToString(), InsertionTime.ToString(),
  EventAdmin.ToString() ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-14T17:13:45.390

另一种从aspx客户端传递多个参数的方法，示例代码如下

> 如果要传递字符串参数，请使用两个双引号（*+ ",""" + Eval("xxx").ToString() + """ ）*

```
OnClientClick='<%#"javascript:return OpenDetailsPage(" + Eval("xxx").ToString() + ",""" + Eval("xxx").ToString() + """," _
                                                + Eval("xxx").ToString() + "," + Eval("xxx").ToString() + "," + Eval("xxx").ToString() + "," _
                                                + Eval("xxx").ToString() + ",""" + Eval("xxx").ToString() + """,this);"%> ' 
```

# .net - 如何将 double* 转换为数组 (6)

> ID：748085
> 
> 赞同：0
> 
> 时间：2009-04-14T15:16:36.277
> 
> 标签：.net, c++, unmanaged, managed

我有一个返回 6 个双精度数组的函数。

```
double* Validation(); 
```

我想将此返回值转换为托管代码。

```
array<double>^ validationPosition = gcnew array<double>(6);
validationPosition = Validation(); 
```

我收到此错误：

```
error C2440: '=' : cannot convert from 'double *' to 'cli::array<Type> ^' 
```

我该怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T15:19:10.887

如果您希望它位于托管阵列中，则需要将其复制到阵列中。本机 double* 数组不能直接用作托管数组。

您可以使用 Marshall::Copy 来复制它，或者只是循环遍历您的 6 个值。

您还希望（可能）删除 [] 您的返回值，因为这听起来像是在您的 validation() 例程内部分配一个数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T15:19:51.837

您可以编写一个函数，遍历原始 double* 中的每个变量，并将值放入 cli::array 中的相关容器中，然后返回新数组。

# php - 从 AJAX 表单输入中检索 PHP 变量

> ID：748086
> 
> 赞同：1
> 
> 时间：2009-04-14T15:16:36.947
> 
> 标签：php, ajax, json

我在 PHP 中有一个表单，将变量发送到 PHP 文件，该文件将它们适当地插入到 MySQL 表中。

我目前有一个 div 显示来自 PHP 的响应（这是由 PHP 打印的任何内容）。

一切正常。问题是我想使用在 PHP MySQL 插入过程中创建/更新的变量。即不仅显示该 PHP 文件中打印的内容，而且使用这些变量。

我已经看到复杂使用 JSON 编码可能跨越这个鸿沟，但我很想知道这是否是最简单的方法。如果有人对此主题有任何好的链接或示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T15:21:41.270

我假设您希望能够通过 AJAX 将多条数据发送回您的页面并对其进行操作。

JSON 确实是最简单的方法。如果您使用 PHP5，您可以使用 PHP 端的 json_encode() 将复杂的数据类型（例如对象或数组）发送回浏览器页面。然后在 javascript 中，对发回的数据使用 eval()（例如：var data = eval(response);）将其解析回 javascript 中可用的复杂类型。

那里有大量教程将向您展示如何做到这一点，并比这里的回复更详细地解释它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T15:23:04.623

使用[PrototypeJS](http://www.prototypejs.org)并这样做：

有一些这样的PHP

```
 $jsonHeader = array();  

 if($_REQUEST['param1'])  
 {  
   echo '<p>You passed ' . $_REQUEST['param1'] . '</p>';  
   $jsonHeader['status'] = 'Success';  
 }else  
 {  
   $jsonHeader['status'] = 'Failed because the request was invalid';  
 }  

 if(is_array($jsonHeader) and sizeof($jsonHeader) > 0)  
 {  
   header('X-JSON: (' . json_encode($jsonHeader) . ')');  
 } 
```

然后像这样进行 Ajax 调用

```
new Ajax.Request('dostuff.php', {  
   method:  'get',  
   parameters:  {'param1':  'this is param 1'},  
   onSuccess:  function(response, jsonHeader){  
    if(jsonHeader['status'] == 'Success'){  
      //Everything is OK, do stuff  
    }else{  
      alert(jsonHeader['status']);  
    }  
   },   
   onFailure:  function(){  
     alert('Fail!');  
   }  
}); 
```

Prototype 抓取 PHP 返回的 X-JSON 标头，并自动将 onSuccess 函数的 jsonHeader 参数设置为最初在 PHP 中设置的值的 Javascript 数组。

* * *

只要您返回到 Javascript 的数据量适合 HTTP 标头，上述情况就很好。

如果您需要传回大量数据，只需让 PHP 输出 JSON 编码结果，而不是将其作为标头的一部分。然后，您可以在 Ajax 调用中使用响应对象的 evalJSON() 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T15:24:10.860

您不必只显示“在那个 PHP 文件中打印的内容”，您的 PHP 文件可以将 JavaScript 推荐打印回您的页面。然后，您可以在收到响应后执行这些命令。我喜欢为此使用该`eval`功能，但是这里的许多人会阻止您这样做:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T15:24:37.973

只需使用“echo”函数将 PHP 变量放入标准输出中即可。

回声 $myVarName;

或者，我更喜欢 printf()，确保在输出*之前*检查输入中的 HTML以避免 XSS 问题。

使用这样的东西：

printf("你的输入是：%s", strip_tags(%myInputVar));

此外，请记住在输出数字时使用 %d 或 %f 格式化程序以获得最佳安全性。

# c# - 将参数作为 Xml 传递给存储过程

> ID：748087
> 
> 赞同：6
> 
> 时间：2009-04-14T15:16:38.287
> 
> 标签：c#, xml, tsql, soa

我需要将参数作为 Xml 传递给我的存储过程。

我在中间层有一个 WCF 服务，它调用我的数据层，然后将请求转发到适当的存储过程。

设计是 WCF 服务负责构建 XML 以传递给存储库。

我只是想知道是要控制中间层的 Xml 中包含哪些参数，还是使用客户端构建的字典，然后将其转换为中间层的 Xml？

目前我选择了后者——例如：

```
 public TestQueryResponseMessage TestQuery(TestQueryRequestMessage message)
 {
        var result = Repository.ExecuteQuery("TestQuery", ParamsToXml(message.Body.Params));

        return new TestQueryResponseMessage
        {
            Body = new TestQueryResponse
            {
                TopicItems = result;
            }
        }
    }

private string ParamsToXml(Dictionary<string, string> nvc)
{
        //TODO: Refactor
        StringBuilder sb = new StringBuilder();

        sb.Append("<params>");
        foreach (KeyValuePair<string, string> param in nvc)
        {
            sb.Append("<param>");
            sb.Append("<" + param.Key + ">");
            sb.Append(param.Value);
            sb.Append("</" + param.Key + ">");
            sb.Append("</param>");
        }
        sb.Append("</params>");

        return sb.ToString();
} 
```

但是我可能需要第一种方式。例如

```
public TestQueryResponseMessage TestQuery(TestQueryRequestMessage message)
{
       string xml = string.Format("<params><TestParameter>{0}</TestParameter></params>",message.Body.TestParameter)

       var result = Repository.ExecuteQuery("TestQuery", xml);

      return new TestQueryResponseMessage
      {
          Body = new TestQueryResponse
          {
                    TopicItems = result;
          }
      }
} 
```

蜂巢有什么推荐的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T12:57:13.717

如果必须使用xml；然后我不会传递字典，而是使用一个代表该数据的类，并使用`XmlSerializer`它作为 xml 获取它：

```
[Serializable, XmlRoot("args")]
public class SomeArgs {
    [XmlElement("foo")] public string Foo { get; set; } 
    [XmlAttribute("bar")] public int Bar { get; set; }
}
...
SomeArgs args = new SomeArgs { Foo = "abc", Bar = 123 };
XmlSerializer ser = new XmlSerializer(typeof(SomeArgs));
StringWriter sw = new StringWriter();
ser.Serialize(sw, args);
string xml = sw.ToString(); 
```

这使得以面向对象的方式管理哪些参数适用于哪些查询变得更加容易。这也意味着您不必进行自己的 xml 转义...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T15:57:42.970

一旦您使用 Bob The Janitor 的解决方案，您就拥有了 XML。

使用 XML 参数创建存储过程。然后，根据您拥有多少 XML 以及您使用它做什么，您可以使用 Xquery 或 OpenXML 来分​​解 XML 文档。提取数据并执行正确的操作。这个例子是基本的伪代码，但你应该明白。

```
CREATE PROCEDURE [usp_Customer_INS_By_XML]
@Customer_XML XML
AS
BEGIN
EXEC sp_xml_preparedocument @xmldoc OUTPUT, @Customer_XML

--OPEN XML example of inserting multiple customers into a Table.
INSERT INTO CUSTOMER
(
First_Name
Middle_Name
Last_Name
)
SELECT
First_Name
,Middle_Name
,Last_Name
FROM OPENXML (@xmldoc, '/ArrayOfCustomers[1]/Customer',2)
WITH(
 First_Name VARCHAR(50)
,Middle_Name VARCHR(50)
,Last_Name VARCHAR(50)
)

EXEC sp_xml_removedocument @xmldoc
END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T04:14:56.920

您可以像这样使用对象序列化类

```
 public class Serialization
    {
        /// <summary>
        /// Serializes the object.
        /// </summary>
        /// <param name="myObject">My object.</param>
        /// <returns></returns>
        public static XmlDocument SerializeObject(Object myObject)
        {
            XmlDocument XmlObject = new XmlDocument();
            String XmlizedString = string.Empty;

            try
            {                
                MemoryStream memoryStream = new MemoryStream();
                XmlSerializer xs = new XmlSerializer(myObject.GetType());
                XmlTextWriter xmlTextWriter = new XmlTextWriter(memoryStream, Encoding.UTF8);
                xs.Serialize(xmlTextWriter, myObject);
                memoryStream = (MemoryStream)xmlTextWriter.BaseStream;
                XmlizedString = UTF8ByteArrayToString(memoryStream.ToArray());                
            }
            catch (Exception e)
            {
                System.Console.WriteLine(e);
            }
            XmlObject.LoadXml(XmlizedString);
            return XmlObject;            
        }

        /// <summary>
        /// Deserializes the object.
        /// </summary>
        /// <typeparam name="T"></typeparam>
        /// <param name="XmlizedString">The p xmlized string.</param>
        /// <returns></returns>
        public static T DeserializeObject<T>(String XmlizedString)
        {
            XmlSerializer xs = new XmlSerializer(typeof(T));
            MemoryStream memoryStream = new MemoryStream(StringToUTF8ByteArray(XmlizedString));
            //XmlTextWriter xmlTextWriter = new XmlTextWriter(memoryStream, Encoding.UTF8);
            Object myObject = xs.Deserialize(memoryStream);
            return (T)myObject;
        } 

        /// <summary>
        /// To convert a Byte Array of Unicode values (UTF-8 encoded) to a complete String.
        /// </summary>
        /// <param name="characters">Unicode Byte Array to be converted to String</param>
        /// <returns>String converted from Unicode Byte Array</returns>
        private static String UTF8ByteArrayToString(Byte[] characters)
        {
            UTF8Encoding encoding = new UTF8Encoding();
            String constructedString = encoding.GetString(characters);
            return (constructedString);
        }

        /// <summary>
        /// Converts the String to UTF8 Byte array and is used in De serialization
        /// </summary>
        /// <param name="pXmlString"></param>
        /// <returns></returns>
        private static Byte[] StringToUTF8ByteArray(String pXmlString)
        {
            UTF8Encoding encoding = new UTF8Encoding();
            Byte[] byteArray = encoding.GetBytes(pXmlString);
            return byteArray;
        } 
    } 
```

那么您不必手动构建 XML，而且您可以将它与任何项目一起使用以使用 XSLT 对其进行转换

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T15:24:17.660

我会将 xml 构造代码放在域对象中。这样，您只需从 Web 服务或数据层调用 obj.GetXML()。

# iphone - iPhone 持久存储

> ID：748092
> 
> 赞同：1
> 
> 时间：2009-04-14T15:17:53.573
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我需要在我的应用程序执行时存储某些信息，并在应用程序启动时再次获取它。我尝试使用 GData 将其存储在 XML 中，但没有成功。我使用了 NSFileHandle 它没有给我一个错误，但它无法创建一个用于读/写目的的 .txt 文件。有没有其他方法可以在 iPhone 上存储和检索数据。下面是我的 NSFileHandle 代码。

```
NSString *path = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"myFile.txt"];
//NSFileHandle *fh = [NSFileHandle fileHandleForWritingAtPath:@"file://localhost/Users/shraddha/Desktop/info.txt"];
NSFileHandle *fh = [NSFileHandle fileHandleForWritingAtPath:@"myFile.txt"];
[fh seekToEndOfFile];
NSData *data = [camName dataUsingEncoding:NSASCIIStringEncoding];
[fh writeData:data];
[fh closeFile]; 
```

阅读

```
NSString *path = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"myFile.txt"];
//NSFileHandle *fh = [NSFileHandle fileHandleForReadingAtPath:@"file://localhost/Users/shraddha/Desktop/info.txt"];
NSFileHandle *fh = [NSFileHandle fileHandleForReadingAtPath:@"myFile.txt"];
if(fh == nil)
    return nil;
else
{
    NSData *data = [fh readDataOfLength:8];
    NSString *retStr = [[NSString alloc] initWithData:data encoding:NSASCIIStringEncoding];
    return retStr;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-14T15:42:52.500

您正在尝试写入您可能无权执行的资源目录。尝试更改代码的第一行以指向文档目录：

```
NSArray *savePaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSMutableString *savePath = [NSMutableString stringWithString:[savePaths objectAtIndex:0]];
[savePath appendString:@"/myFile.txt"]; 
```

此外，您无需担心文件句柄。`NSData`能够将自己写入磁盘：

```
BOOL result = [data writeToFile:savePath atomically:YES]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T15:23:18.617

您可以使用 sqlite 数据库在 iPhone 上存储持久数据。这是一篇博客文章，应该可以让您指出正确的方向：

[http://dblog.com.au/iphone-development-tutorials/iphone-sdk-tutorial-reading-data-from-a-sqlite-database/](http://dblog.com.au/iphone-development-tutorials/iphone-sdk-tutorial-reading-data-from-a-sqlite-database/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-14T15:23:29.443

每个 iPhone 应用程序都有读取/写入名称/值对的能力，这对于存储用户偏好等小信息非常非常有用。您的应用程序的用户也可以编辑这些首选项（如果您选择）。

另一个比尝试进行文本文件存储和检索更强大的选项（我从不喜欢这个选项，尤其是 iPhone 上糟糕的 XML 解析支持）是 sqlite。sqlite 是一个非常轻量级的关系数据库引擎，它包含在每个 iPhone 和 iPod touch 中。

# jquery-ui - 通过表单更新 jQuery 滑块的选项

> ID：748112
> 
> 赞同：1
> 
> 时间：2009-04-14T15:21:48.620
> 
> 标签：jquery-ui, slider

我有一个[jQuery Slider](http://docs.jquery.com/UI/Slider)，我试图通过添加三个输入字段使其更具动态性：

> 分钟
> 
> 最大限度
> 
> 步

我想获取这些字段，然后`onblur`更新我的滑块选项。我读到您可以设置如下选项：

```
$('.selector').slider('option', 'max', 7); 
```

并对 min、step 等以及其他选项执行相同的操作。

我昨天试过玩它，但我不知道如何让它更新。我正在使用没有提交按钮的表单，所以只需更改模糊即可。

我知道我会得到`.val()`输入并将其设置为一个变量，那么它会是：

```
 $('.selector').slider('option', 'max', var_here); 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T15:33:54.457

尝试使用类似的东西，假设您的最小输入的 id 为“min”

```
$('#min').blur(function() {
  var newMin = parseInt($(this).val());
  $('.selector').slider('option', 'min', newMin);
}); 
```

# jquery - jquery淡入淡出效果在FF中不起作用

> ID：748113
> 
> 赞同：3
> 
> 时间：2009-04-14T15:22:28.757
> 
> 标签：jquery, firefox, fade, fadeout

这段代码在 IE 中淡化了 div。在 Firefox 3.0.8 中，淡出时间过去了，div 立即消失。我找不到任何人提到这个问题。

```
 $(function() {
            $("#show").click(function() {
                $("#show").fadeOut('slow');
            });
        });

<div id="show">this is where to show it</div> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-28T14:31:57.797

我整个早上都在努力解决这个问题，终于找到了我的问题……“Scripts/jquery-1.3.2-vsdoc.js”的标题

```
/*
 * 此文件已被注释为支持 Visual Studio Intellisense。
 * 你不应该在运行时在浏览器中使用这个文件——它只是
 * 仅用于设计时 IntelliSense。请使用
 * 用于所有生产用途的标准 jQuery 库。
 *
 * 评论版本：1.3.2a
 */

```

当他们说**“你不应该在浏览器中运行时使用这个文件”时，**他们肯定是认真的......

所以请确保您使用的是非 -vsdoc 版本的 jquery 和 jquery-min

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T17:26:36.493

谢谢您的帮助。

我发现了问题。我的例子并不完整。我还包括`jquery-vsdoc.js`jQuery VS intellisense。把它拿出来让它工作。

我为未来的读者使用了这个技巧

```
<%if (false) { %>
<script src="common/jquery-vsdoc.js" type="text/javascript"></script>
<% } %> 
```

奇怪。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T16:14:04.233

它适用于 Firefox 3.0.8 和 Windows XP。

[这是我测试过的示例页面。](http://jsbin.com/ewica)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T16:27:16.200

也为我工作

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js" type="text/javascript">
</script>

<script type="text/javascript">
 $(function() {
            $("#show").click(function() {
                $("#show").fadeOut('slow');
            });
        });
</script>
   <div id="show">this is where to show it</div> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-06T23:49:03.380

我在这个问题上纠结了很长时间。我的代码甚至与任何 jquery-vsdoc.js 都没有任何关系。

解决方案：关闭浏览器，重新打开，重新加载页面。

不知道为什么它不起作用。

不要像我一样让自己发疯！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-11T11:10:28.840

我的问题是，我尝试先在 CSS 中制作动画，然后在 jQuery 中导致出现问题。

```
 transition:.5s linear; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-10T06:38:06.333

您必须将 event.preventDefault() 放在那里才能使其工作。

```
$(function() {
     $("#show").click(function(event) {
        event.preventDefault();
        $("#show").fadeOut('slow');
     });
 });

<div id="show">this is where to show it</div> 
```

# jsunit - 在没有测试套件的情况下运行 JSUnit 测试

> ID：748129
> 
> 赞同：0
> 
> 时间：2009-04-14T15:26:06.410
> 
> 标签：jsunit

有没有办法在不指定测试套件文件的情况下运行 JSUnit 测试。我想在一个特定的包中运行所有测试，这样就不必记住向现有套件添加任何新测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T15:43:03.093

我相信 Eclipse 和 Maven 都会为您做到这一点。

# python - 对 Django 应用程序进行基准测试

> ID：748130
> 
> 赞同：15
> 
> 时间：2009-04-14T15:26:16.893
> 
> 标签：python, django, profiling

我有兴趣随时测试我的 django 应用程序的性能，获取逐行性能数据的最佳方法是什么？

**注意**：谷歌搜索这会返回很多人对 django 本身进行基准测试。我不是在寻找 django 的基准，我正在尝试测试我正在编写的 django 应用程序的性能:)

谢谢！

**编辑**：通过“逐行”，我只是指对单个函数、数据库调用等进行计时，以在非常精细的层面上找出瓶颈所在

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-14T15:39:50.573

这有两层。我们已经为我们的测试准备了大部分#1。我们即将开始#2。

1.  Django 孤立无援。普通的 Django 单元测试在这里运行良好。创建一些循环通过几个（少于 6 个）“典型”用例的测试。获取这个，发布那个，等等。收集计时数据。这不是真正的 Web 性能，但它是一个易于使用的测试场景，可用于调整。

2.  你的整个网络堆栈。在这种情况下，您需要一个运行 Squid、Apache、Django、MySQL 等的常规服务器。您需要第二台计算机来充当客户端，通过 urllib2 运行您的网站，执行一些（少于 6 个）“典型”用例。获取这个，发布那个，等等。收集计时数据。这仍然不是“真正的”网络性能，因为它不是通过互联网实现的，但它与您在没有非常复杂的设置的情况下所获得的一样接近。

请注意，#2（端到端）包括大量缓存以提高性能。如果您的客户端脚本正在做类似的工作，那么缓存将非常有益。如果您的客户端脚本每次都做独特的事情，那么缓存将不太有用。

最困难的部分是确定“典型”工作负载是什么。这不是功能测试，因此工作负载不必包括所有内容。此外，您的客户端运行的并发会话越多，它变得越慢。当您的测试客户端是处理过程中最慢的部分时，不要努力优化您的服务器。

* * *

**编辑**

如果“逐行”意味着“分析”，那么你必须让 Python 分析器运行。

[https://docs.python.org/library/profile.html](https://docs.python.org/library/profile.html)

请注意，Django ORM 层中有大量缓存。因此，运行一个视图函数六次以获得一组有意义的测量值是不明智的。您必须运行一组“典型”操作，然后在配置文件中找到热点。

通常，您的应用程序很容易优化——您不应该做太多事情。您的视图函数应该很短并且没有处理可言。同样，您的表单和模型方法函数应该非常短。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T15:57:17.490

获取 Django 应用程序的逐行性能数据（分析）的一种方法是使用 WSGI 中间件组件，例如**[repoze.profile](http://pypi.python.org/pypi/repoze.profile/0.8)**。

假设您将 mod_wsgi 与 Apache 一起使用，您可以将 repoze.profile 插入到您的应用程序中，如下所示：

```
...
application = django.core.handlers.wsgi.WSGIHandler()
...
from repoze.profile.profiler import AccumulatingProfileMiddleware
application = AccumulatingProfileMiddleware(
    application,
    log_filename='/path/to/logs/profile.log',
    discard_first_request=True,
    flush_at_shutdown=True,
    path='/_profile'
) 
```

现在您可以将浏览器指向 /_profile 以查看您的个人资料数据。当然，这不适用于 mod_python 或内部 Django 服务器。

# php - 在 404 上使用 PHP 和 MySQL 进行 301 重定向

> ID：748135
> 
> 赞同：1
> 
> 时间：2009-04-14T15:27:09.120
> 
> 标签：php, mysql, apache, redirect, http-status-code-301

我正在将一个包含 500 多页的大型静态网站转移到 Joomla 安装中，但我想要做的是使用 PHP 内置的 301 标头重定向来动态重定向传入的请求，而不是编写一个 500 多行的 .htaccess 文件到新网址。

因此，例如，在我移动站点后，以下 URL 将 404 没有重定向-

[http://www.foo.com/old_page.html](http://www.foo.com/old_page.html)

我希望它重定向到

```
http://www.foo.com/old-page.php 
```

所以我想创建一个旧 URL 及其对应的新 URL 的 MySQL 数据库，然后，如果服务器要返回 404，它首先检查数据库中现有的旧 URL，如果匹配，则发出301 重定向到新的 URL。对了，我在这里有意义吗？

我该怎么做？我可以“谈论”逻辑，但不确定从哪里开始或如何完成它，因为虽然我了解 PHP，但我并不真正了解这将如何与 Apache 一起工作（或者即使它会例如......） ?

如果您知道任何已经在执行此操作的脚本，那就更好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T15:31:45.273

在您的 Apache 配置中，设置您喜欢的任何 /404handler.php 脚本的 ErrorDocument。在其运行上下文中，**$_SERVER['REQUEST_URI']**将是请求的原始页面的 URI。进行数据库查找，如果找到要重定向的页面，请使用**header("Location: " . $wherever)**重定向到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T15:34:37.950

我能想到的最简单的方法是使用[mod_rewrite](http://www.addedbytes.com/apache/url-rewriting-for-beginners/)（链接是一个很棒的介绍教程）将所有传入请求重定向到单个 PHP 脚本（或使用一个标志，以便仅当请求是针对文件时才会发生此重定向不存在），请求的地址作为查询字符串的一部分传递。从那里，让 PHP 脚本查找该请求应该去哪里，并重定向到它。

所以如果有人试图打开[http://www.foo.com/old_page.html](http://www.foo.com/old_page.html)， mod_rewrite 会发送到类似[http://www.foo.com/redirect.php?page=old_page.html](http://www.foo.com/redirect.php?page=old_page.html)的东西。redirect.php 然后进行数据库查找以查看“old_page.html”的新地址是什么，并重定向到那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T15:29:13.670

与其创建数据库，不如直接将重定向放入具有旧 URL（即 old_page.html）的页面中？

由于您显然是对数据库条目逐个执行此操作，因此您可以对页面逐个执行此操作。

给定旧页面的名称和新页面的 URL，您可以编写一个快速的 perl 脚本或任何您喜欢的东西来为您生成这些 html 页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-18T17:04:33.090

您还可以使用[`RewriteMap`](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritemap)：

```
old_page new-page
# … 
```

但是您需要在 httpd.conf（或虚拟主机配置）中定义该映射：

```
RewriteMap oldtonew txt:/path/to/file/map.txt 
```

然后，您可以在 .htaccess 文件中使用该映射：

```
RewriteCond ${oldtonew:$1} .+
RewriteRule ^(.*)\.html$ /%0.html [L,R=301] 
```

# sql-server - AcquireConnection method call to the connection manager failed with error code 0xC0202009

> ID：748136
> 
> 赞同：24
> 
> 时间：2009-04-14T15:27:50.540
> 
> 标签：sql-server, excel, ssis, oledb

I have an SSIS package which reads an Excel File (Data Flow Source) and transfer the data to SQL Server using OLEDB Destination Data Flow Item. The OLEDB Connection Manager used for the destination is configured to use Windows Authentication. The package works fine on my development machine. But when I open the same package on another machine and try to execute it gives the following error in Validation phase

> Error: 0xC020801C at DFT_NSOffers, Source - 'Subscription Offers$' 1 [347]: The AcquireConnection method call to the connection manager "ExcelConnection_NSOffers" failed with error code 0xC0202009. Error: 0xC0047017 at DFT_NSOffers, DTS.Pipeline: component "Source - 'Subscription Offers$' 1" (347) failed validation and returned error code 0xC020801C. Error: 0xC004700C at DFT_NSOffers, DTS.Pipeline: One or more component failed validation. Error: 0xC0024107 at DFT_NSOffers: There were errors during task validation

I'm using SQL Server 2005 (Version - 9.0.1399)

How do I fix this? Do I need to install any other component or service pack?

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-17T10:32:56.913

I don't think it's 64/32 bit error. My Dev machine and DB server are 32bit. But I could make it work. I had to set `Delay Validation` property of `Data Flow` tasks to `TRUE`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T15:32:01.027

64/32 bit error? I found this as a problem as my dev machine was 32bit and the production server 64bit. If so, you may need to call the 32bit runtime directly from the command line.

This link says it better (No 64bit JET driver): [http://social.msdn.microsoft.com/forums/en-US/sqlintegrationservices/thread/da076e51-8149-4948-add1-6192d8966ead/](http://social.msdn.microsoft.com/forums/en-US/sqlintegrationservices/thread/da076e51-8149-4948-add1-6192d8966ead/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-13T08:48:38.530

For me, I was accessing my `XLS` file from a network share. Moving the file for my connection manager to a local folder fixed the issue.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-05-02T12:25:29.750

Hi This can be solved by changing the prorperty of the project in the solution explorer then give `false` to `64bit runtime` option

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-05-06T21:42:46.563

If you are receiving preview of data in the excel source. But while executing the data flow task you receive Acquire connection error. Then move the file to local system and change the file path in excel connection manager and try executing again.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-10-25T15:56:02.173

I was finally able to resolve the "Excel connection issue" in my case it was not a 64 bit issue like some of them had encounterd, I noticed the package worked fine when i didnt enable the package configuration, but i wanted my package to run with the configuration file, digging further into it i noticed i had selected all the properties that were available, I unchecked all and checked only the ones that I needed to store in the package configuration file. and ta dha it works :)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-03-07T12:11:08.500

In my case the problem was the 32/64 bit driver which I solved by configuring the properties of the sql server job:

![enter image description here](https://i.stack.imgur.com/b2Q3f.png)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-05T07:55:46.990

I had similar issue just that excel was the destination in my case instead of source as in the case of the original question/issue. I have spent hours to resolve this issue but looks like finally Soniya Parmar saved the day for me. I have set job and let it run for few iterations already and all is good now. As per her suggestion I set up the delay validation of the Excel connection manager to 'True. Thanks Soniya

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-27T11:13:17.840

Setting RetainSameConnection property to True for Excel manager Worked for me .

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-03-20T20:04:12.373

I had similar issue, trying to load data from Excel spreadsheet; and was running on WinX64\. So I went VS BI`s project properties: Configuration Properties \ Dbugging and Switch Run64BitRuntime from True to False. It worked.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-07-20T11:04:29.583

I was also getting the same error and it simply got resolved after installing the MS offices driver and Execute the job in 32 Bit DTEXEC. Now it works fine.

You can get the setup from below.

[https://www.microsoft.com/en-in/download/confirmation.aspx?id=23734](https://www.microsoft.com/en-in/download/confirmation.aspx?id=23734)

* * *

## 回答 #12

> 赞同：-5
> 
> 时间：2014-10-14T11:03:55.943

In order to resolve this issue make all your data flow tasks in one sequence. It means it should not execute parallel. One data flow task sequence should contain only one data flow task and for this another data flow task as sequence.

Ex:-

![enter image description here](https://i.stack.imgur.com/JL4p1.jpg)

# c++ - 当一个函数（来自一个库）包含在 VC++ MFC 项目中时，“CoInitialize failed”

> ID：748152
> 
> 赞同：0
> 
> 时间：2009-04-14T15:32:53.490
> 
> 标签：c++, windows, visual-studio, mfc

我知道这有点含糊，我只是在这里寻找一般可能性，以使我走上正轨。

我在我的 MFC Dialog 程序中包含两个库和它们的 .h 并编译它，没问题。但是，当我从其中一个库调用函数时，它会弹出一个对话框，显示“Com Error”“CoInitialize Failed”。那不是我真正调用函数的时候，而是程序开始运行的时候。我的假设是，当它看到该函数时，它实际上调用了 lib，而当它调用时，可能在我的 MFC 程序中调用 CoInit 之前调用了 CoInit，从而造成冲突？

单步执行代码，似乎在 CDialog::DoModal

我总是可以添加更多细节，我只是希望能够朝着正确的方向前进。非常感谢您的帮助！

**编辑：**

问题是，我不知道 DLL 在哪里调用 CoInitialize。我真的不能发布代码，因为代码太多了，即使是一个简单的程序也是如此。我会尝试依赖 walker 并查看我的 InitInstance ... 还有其他建议吗？非常感谢你们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T15:41:48.273

尝试添加您自己对 CoInitializeEx 的调用，并确保您在主线程中使用 STA（SingleThreadedApartment）线程。

很有可能正在将您的主线程设置为 MTA，但您的库需要并需要 STA，因此 CoInitialize 调用失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T15:40:22.037

一个好的方向是添加更多细节，特别是如果你有它们，比如 CoInitialize 返回的 HRESULT 是哪个？

我的猜测是这样的库有一个静态初始化，如果没有调用来自 dll 的函数，它们会被链接器丢弃，但如果至少调用了一个函数，那么静态初始化器就会被链接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T05:27:35.587

您可以通过在其上放置一个断点来找出谁在调用 CoInitialize。

这是您使用[Debugging Tools for Windows](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)的方式。

您首先使用 gflags.exe 为您的 exe 启用调试器选项。

为了那个原因

1.  运行 gflags.exe 在图像文件选项中给出你的 exe 的名称，比如 xyz.exe。按 T​​ab 启用图像级别选项。在调试器选项*中输入 windbg* -g的完整路径

这将导致您每次启动 xyz.exe 时都附加调试器来启动您的 exe。

现在要在 CoInitialize 调用上设置断点，在 Windbg 中中断执行。在命令窗格中键入

bp Ole32!CoInitialize

停止调试，提示时保存工作区并重启xyz.exe

这一次，当有人调用 CoInitialize 时，应用程序将进入调试器。

希望对你有帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T15:53:02.490

您应该在您的 App InitInstance() 中调用 CoInitialize。然后它应该在调用 DoModal() 之前执行。

可能此错误消息并不表示 lib 尝试调用 CoInitialize 本身，而是尝试了其他一些 COM 调用，并且从它收到的错误中推断出您没有调用 CoInitialize。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T06:04:42.757

一个常见的错误是，如果引用的 DLL 丢失，那么当调用 CoInitialize 时，它​​会尝试加载 DLL，但由于旧的 E_FAIL 而失败。尝试使用依赖遍历器并检查您可能错过的任何 DLL。

# php - 单表邻接树

> ID：748155
> 
> 赞同：3
> 
> 时间：2009-04-14T15:33:09.653
> 
> 标签：php, tree, hierarchy, adjacency-list

我读过很多人讨论嵌套列表，但我想知道如何在 PHP 中遍历邻接列表/树。

我有一张桌子：id、title、parent_id

我已将所有记录选择到一个名为 $pages 的数组中。

然后使用这个php：

```
function makeList($pages, $used) {
    if (count($pages)) {
        echo "<ul>";
        foreach ($pages as $page) {
            echo "<li>".$page['pag_title'];
            $par_id = $page['pag_id'];
            $subsql("SELECT * FROM pages WHERE pag_parent = ".$par_id."");

            // running the new sql through an abstraction layer
            $childpages = $dbch->fetchAll();
            makeList($childpages, $used, $lastused);
            echo "</li>";
        }
        echo "</ul>";
    }
} 
```

这类作品，但我最终会重复任何子菜单，例如

*   家
    *   消息
        *   子新闻
    *   文章
        *   文章
*   消息
    *   子新闻
*   文章
    *   文章
*   子新闻
*   文章

我尝试将当前 id 添加到通过函数传递的数组中，然后使用 in_array 检查它是否存在，但这样做我并不高兴。

任何帮助将非常感激。

我需要解析整个树，所以不能选择 parent 作为 0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T17:32:55.417

由于它已经执行 SQL，因此您不必在第一次函数调用之前执行它。

```
function makeList($par_id = 0) {
    //your sql code here
    $subsql("SELECT * FROM pages WHERE pag_parent = $par_id");
    $pages = $dbch->fetchAll();

    if (count($pages)) {
        echo '<ul>';
        foreach ($pages as $page) {
            echo '<li>', $page['pag_title'];
            makeList($page['pag_id']);
            echo '</li>';
        }
        echo '</ul>';
    }
} 
```

为了将它存储为更多树，您可能希望查看此站点：[将分层数据存储在数据库](http://www.sitepoint.com/article/hierarchical-data-database/)中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-16T15:06:11.270

如果您创建一个按父 ID 分组的页面数组，则递归构建列表非常容易。这将只需要一个数据库查询。

```
<?php

 //example data
 $items = array(
    array('id'=>1, 'title'=>'Home', 'parent_id'=>0),
    array('id'=>2, 'title'=>'News', 'parent_id'=>1),
    array('id'=>3, 'title'=>'Sub News', 'parent_id'=>2),
    array('id'=>4, 'title'=>'Articles', 'parent_id'=>0),
    array('id'=>5, 'title'=>'Article', 'parent_id'=>4),
    array('id'=>6, 'title'=>'Article2', 'parent_id'=>4)
 );

 //create new list grouped by parent id
 $itemsByParent = array();
 foreach ($items as $item) {
    if (!isset($itemsByParent[$item['parent_id']])) {
        $itemsByParent[$item['parent_id']] = array();
    }

    $itemsByParent[$item['parent_id']][] = $item;
 }

 //print list recursively 
 function printList($items, $parentId = 0) {
    echo '<ul>';
    foreach ($items[$parentId] as $item) {
        echo '<li>';
        echo $item['title'];
        $curId = $item['id'];
        //if there are children
        if (!empty($items[$curId])) {
            makeList($items, $curId);
        }           
        echo '</li>';
    }
    echo '</ul>';
 }

printList($itemsByParent); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T16:18:36.393

$page 来自哪里？如果您不对其进行转义或使用准备好的语句，您的代码中可能存在 sql 注入漏洞。

此外，for 循环中的 SELECT 语句作为一种不好的做法跳出。如果表不是那么大，那么选择整个表的内容，然后在 PHP 中遍历结果集，构建树形数据结构。在您的树是链表的病态情况下，这可能需要多达 n*(n-1)/2 次迭代。当所有节点都添加到树中时停止，或者剩余节点的数量从一次迭代到下一次迭代保持不变 - 这意味着剩余节点不是根节点的子节点。

或者，如果您的数据库支持递归 SQL 查询，您可以使用它，它只会选择作为父节点子节点的节点。您仍然需要在 PHP 中自己构建树对象。查询的形式类似于：

```
WITH temptable(id, title, parent_id) AS (
  SELECT id, title, parent_id FROM pages WHERE id = ?
  UNION ALL
  SELECT a.id, a.title, a.parent_id FROM pages a, temptable t
   WHERE t.parent_id = a.id
) SELECT * FROM temptable 
```

替换“？” 在带有起始页 ID 的第二行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T15:39:01.667

最简单的解决方法是，当您进行初始选择设置`$pages`（您没有显示）时，添加一个 WHERE 子句，例如：

```
WHERE pag_parent = 0 
```

（或 IS NULL，取决于您如何存储“顶级”页面）。

这样一来，您最初就不会选择所有孩子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T15:58:36.217

当该表变大时，递归会变得笨拙。我写了一篇关于无递归方法的博客文章：[http ://www.alandelevie.com/2008/07/12/recursion-less-storage-of-hierarchical-data-in-a-relational-database/](http://www.alandelevie.com/2008/07/12/recursion-less-storage-of-hierarchical-data-in-a-relational-database/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-22T20:20:23.653

查找节点的最高父级、所有父级和所有子级（Tom Haigh 答案的增强）：

```
<?php

 //sample data (can be pulled from mysql)
 $items = array(
    array('id'=>1, 'title'=>'Home', 'parent_id'=>0),
    array('id'=>2, 'title'=>'News', 'parent_id'=>1),
    array('id'=>3, 'title'=>'Sub News', 'parent_id'=>2),
    array('id'=>4, 'title'=>'Articles', 'parent_id'=>0),
    array('id'=>5, 'title'=>'Article', 'parent_id'=>4),
    array('id'=>6, 'title'=>'Article2', 'parent_id'=>4)
 );

 //create new list grouped by parent id
 $itemsByParent = array();
 foreach ($items as $item) {
    if (!isset($itemsByParent[$item['parent_id']])) {
        $itemsByParent[$item['parent_id']] = array();
    }

    $itemsByParent[$item['parent_id']][] = $item;
 }

 //print list recursively 
 function printList($items, $parentId = 0) {
    echo '<ul>';
    foreach ($items[$parentId] as $item) {
        echo '<li>';
        echo $item['title'];
        $curId = $item['id'];
        //if there are children
        if (!empty($items[$curId])) {
            printList($items, $curId);
        }           
        echo '</li>';
    }
    echo '</ul>';
 }

printList($itemsByParent);

/***************Extra Functionality 1****************/

function findTopParent($id,$ibp){

    foreach($ibp as $parentID=>$children){ 

            foreach($children as $child){

            if($child['id']==$id){

             if($child['parent_id']!=0){

            //echo $child['parent_id'];
            return findTopParent($child['parent_id'],$ibp);

          }else{ return $child['title'];}

         }              
        }
}
}

$itemID=7;  
$TopParent= findTopParent($itemID,$itemsByParent);

/***************Extra Functionality 2****************/

function getAllParents($id,$ibp){ //full path

foreach($ibp as $parentID=>$nodes){ 

    foreach($nodes as $node){

        if($node['id']==$id){

             if($node['parent_id']!=0){

                $a=getAllParents($node['parent_id'],$ibp);
                array_push($a,$node['parent_id']);
                return $a;

              }else{
                    return array();
                  }

             }
    }
}
}

$FullPath= getAllParents(3,$itemsByParent);
print_r($FullPath);

/*
Array
(
[0] => 1
[1] => 2
)
*/

/***************Extra Functionality 3****************/

 //this function gets all offspring(subnodes); children, grand children, etc...
 function getAllDescendancy($id,$ibp){

 if(array_key_exists($id,$ibp)){

         $kids=array();
         foreach($ibp[$id] as $child){

            array_push($kids,$child['id']);

            if(array_key_exists($child['id'],$ibp))

$kids=array_merge($kids,getAllDescendancy($child['id'],$ibp));

             }

         return $kids;       

     }else{
            return array();//supplied $id has no kids
          }
 }

print_r(getAllDescendancy(1,$itemsByParent));
/*
Array
(
[0] => 2
[1] => 3
)
*/

print_r(getAllDescendancy(4,$itemsByParent));
/*
Array
(
[0] => 5
[1] => 6
)
*/

print_r(getAllDescendancy(0,$itemsByParent));
/*
Array
(
[0] => 1
[1] => 2
[2] => 3
[3] => 4
[4] => 5
[5] => 6
)

*/

?> 
```

# odbc - 如何为 Progress DB 设置 ODBC 10.1b

> ID：748159
> 
> 赞同：1
> 
> 时间：2009-04-14T15:34:39.883
> 
> 标签：odbc, installation, openedge, progress-db

我正在尝试为 Progress 10.1b 设置 ODBC 客户端驱动程序。我能够安装所需的客户端软件，但显然还需要运行一个 ODBC.reg 脚本文件才能正确设置注册表，以便我使用 ODBC 驱动程序。

谁能指出我在哪里可以找到这个脚本？或者告诉我必须创建的一组注册表项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T12:26:17.947

这不是安装过程的标准部分。

这些是您安装客户端所[遵循](http://progress.atgnow.com/esprogress/resultDisplay.do?gotoLink=34198&docType=1000&contextId=36258%3A34198.34279&clusterName=CombinedCluster&contentId=e0fd17e9-a745-4b52-ba42-34f96cd10b4d&responseId=61e197040ff9ab04%3A1b1fbf4%3A121f268d141%3A-12eb&groupId=1&answerGroup=17&score=668&page=https%3A%2F%2Fprogress.atgnow.com%2Fesprogress%2Fdocs%2FProgress%2Fesupport.progress.com%2FEDocHTML%2FOpenEdge%2F10.1B%2Fgsins%2Fgsins-07-1.html&result=28&excerpt=The+installation+also+automatically+adds+entries+when+you+install+an+ODBC+driver.&resultType=5000#Goto34198)的步骤吗？

如果如您所说，客户端已正确安装，您只需要设置 DSN。以下内容应该有效（从 Progress Knowledge Center 窃取并稍作编辑）：

启动 ODBC 数据源管理器（在管理工具文件夹中的控制面板中找到）

例子：

```
1\. Select the System DSN tab
2\. Select the Add button to the right
3\. Select the MERANT 32-BIT Progress SQL-92 driver for your version of Progress.
4\. Select Finish 
```

这将打开新 DSN 的配置屏幕。

填写以下信息：

```
1\.   Data Source Name..... (whatever you choose)
2\.   Description.......(optional and whatever you think is appropriate)
3\.   Host Name......(the server where the database is located)
4\.   Port Number.... (the port your database broker was started with...if multiple
      brokers..the SQL broker port)
5\.   Database Name....(database name you wish to connect to)
6\.   User ID...(the user you logged in with or if security is turned on..a user
      that can connect to the database)
7\.   Leave all other tab settings at the defaults for the initial configuration.
8\.   Select the Apply button.
9\.   Select the Test Connect button.
10\.  Screen requesting a password pops up. (enter one only if the database
       normally requires a user name and password from the 4GL side to enter the database) 
```

# opengl - OpenGL中的帧缓冲区对象和像素缓冲区对象有什么区别？

> ID：748162
> 
> 赞同：46
> 
> 时间：2009-04-14T15:37:03.013
> 
> 标签：opengl

FBO和PBO有什么区别？我应该使用哪一个进行离屏渲染？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-06-09T16:51:17.363

> FBO和PBO有什么区别？

一个更好的问题是它们有何相似之处。唯一相似的就是他们的*名字*。

[帧缓冲区对象](http://www.opengl.org/wiki/Framebuffer_Object)（注意大写：帧缓冲区是一个词，而不是两个）是一个包含多个可用作渲染目标的图像的对象。

[像素缓冲区对象](http://www.opengl.org/wiki/Pixel_Buffer_Object)是：

1.  一个[缓冲区对象](http://www.opengl.org/wiki/Buffer_Object)。FBO*不是*缓冲区对象。同样：帧缓冲区是一个词。
2.  一个缓冲区对象，用于向[图像异步上传/下载像素数据](https://www.opengl.org/wiki/Pixel_Transfer)。

如果要渲染到纹理或只是[非屏幕帧缓冲区](http://www.opengl.org/wiki/Default_Framebuffer)，则使用 FBO。如果您尝试将像素数据异步读取回您的应用程序，或者您尝试将像素数据异步传输到 OpenGL 图像，那么您可以使用 PBO。

他们一点都不像。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-14T15:39:25.597

[FBO](http://www.opengl.org/wiki/Framebuffer_Object) （帧缓冲区对象）是一个目标，您可以在其中渲染默认帧缓冲区或屏幕以外的图像。

[PBO](https://www.opengl.org/wiki/Pixel_Buffer_Object)（像素缓冲区对象）允许在设备之间*异步*传输像素数据。如果您在等待像素传输时还有其他事情可以完成，这有助于提高渲染时的整体性能。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-14T15:39:48.560

我会阅读[VBO、PBO 和 FBO](http://hacksoflife.blogspot.com/2006/10/vbos-pbos-and-fbos.html)：

> Apple 发布了两个非常好的示例代码，演示了 PBO 和 FBO。尽管这些是特定于 Mac 的，但作为示例代码，它们在任何平台上都很好，因为 PBO 和 FBO 是 OpenGL 扩展，而不是窗口系统扩展。
> 
> 那么所有这些对象是什么？情况如下：

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-03-09T18:02:23.630

我想强调一些东西。

**FBO**它不是内存块。我认为它看起来像指针结构。您必须将 Texture 附加到 FBO 才能使用它。附加纹理后，您现在可以绘制到它以进行屏幕外渲染或第二遍效果。

```
struct FBO{
AttachColor0 *ptr0;
AttachColor1 *ptr1;
AttachColor2 *ptr2;
AttachDepth  *ptr3;
}; 
```

另一方面，**PBO**是内存块“用于保存内存类型的块。”尝试将其视为 x 大小的 malloc，然后您可以使用 memcpy 将数据从它复制到纹理/FBO 或复制到它“。

*   为什么要使用 PBO？

创建中间内存缓冲区以与主机内存接口，并且不停止 OpenGL 绘图将纹理上传到主机或从主机上传。

# sql-server - SQL Server 2008 上 varbinary(max) 文件流的长度

> ID：748165
> 
> 赞同：6
> 
> 时间：2009-04-14T15:37:33.277
> 
> 标签：sql-server, filestream, varbinary, datalength

有没有一些有效的方法来获取“varbinary(max) filestream”列中的数据长度？我发现只有转换为 varchar 然后调用“LEN”函数的样本。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-12T07:08:44.933

```
SELECT
      length = DATALENGTH(Name),
      Name 
FROM 
      Production.Product 
ORDER BY 
      Name 
```

*“返回用于表示任何表达式**的字节数。”***

T-SQL 和引用取自 MSDN 的[DATALENGTH (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms173486.aspx)库。

# asynchronous - 异步与同步执行，主要区别是什么？

> ID：748175
> 
> 赞同：1338
> 
> 时间：2009-04-14T15:39:43.320
> 
> 标签：asynchronous, execution, synchronous

异步执行和同步执行有什么区别？

* * *

## 回答 #1

> 赞同：1918
> 
> 时间：2009-04-14T15:43:10.160

当您同步执行某事时，您会等待它完成，然后再继续执行另一个任务。当您异步执行某事时，您可以在它完成之前继续执行另一个任务。

话虽如此，在计算机的上下文中，这转化为在另一个“线程”上执行进程或任务。线程是作为工作单元存在的一系列命令（代码块）。操作系统可以管理多个线程，并在切换到另一个线程以使其轮流做一些工作之前，为一个线程分配一块（“切片”）处理器时间。在其核心（请原谅双关语），处理器可以简单地执行命令，它没有同时做两件事的概念。操作系统通过将时间片分配给不同的线程来模拟这一点。

现在，如果您在混合中引入多个内核/处理器，那么事情实际上可以同时发生。操作系统可以将时间分配给第一个处理器上的一个线程，然后将相同的时间块分配给不同处理器上的另一个线程。所有这一切都是为了让操作系统管理您的任务的完成，同时您可以继续编写代码并做其他事情。

异步编程是一个复杂的话题，因为当你可以同时做它们时事物如何联系在一起的语义。有很多关于这个主题的文章和书籍；看一看！

* * *

## 回答 #2

> 赞同：1251
> 
> 时间：2009-04-14T15:53:27.997

**同步/异步与多线程无关。**

同步或*同步*意味着以某种方式“连接”或“依赖”。换句话说，两个同步任务必须相互了解，并且一个任务必须以某种依赖于另一个的方式执行，例如等待启动，直到另一个任务完成。
异步意味着它们是完全独立的，任何一方都不必以任何方式考虑对方，无论是在启动中还是在执行中。

同步（一个线程）：

```
1 thread ->   |<---A---->||<----B---------->||<------C----->| 
```

同步（多线程）：

```
thread A -> |<---A---->|   
                        \  
thread B ------------>   ->|<----B---------->|   
                                              \   
thread C ---------------------------------->   ->|<------C----->| 
```

异步（一个线程）：

```
 A-Start ------------------------------------------ A-End   
           | B-Start -----------------------------------------|--- B-End   
           |    |      C-Start ------------------- C-End      |      |   
           |    |       |                           |         |      |
           V    V       V                           V         V      V      
1 thread->|<-A-|<--B---|<-C-|-A-|-C-|--A--|-B-|--C-->|---A---->|--B-->| 
```

异步（多线程）：

```
 thread A ->     |<---A---->|
 thread B ----->     |<----B---------->| 
 thread C --------->     |<------C--------->| 
```

*   `<`用,`>`字符表示的任务 A、B、C 的起点和终点。
*   由竖线表示的 CPU 时间片`|`

从技术上讲，同步/异步的概念实际上**与线程没有任何关系**。虽然，一般来说，在同一个线程上运行的异步任务是不常见的，但这是可能的（参见下面的示例），并且*通常会发现两个或多个任务在**不同*的线程上同步执行......不，这个概念同步/异步的选择*仅*与第二个或后续任务是否可以在另一个（第一个）任务完成之前启动，或者它是否必须等待有关。就这些。什么线程（或多个线程），或进程，或 CPU，或者实际上，在什么硬件上执行任务是不相关的。事实上，为了说明这一点，我已经编辑了图形来显示这一点。

* * *

**异步示例：**

在解决许多工程问题时，该软件旨在将整个问题分解为多个单独的任务，然后异步执行它们。矩阵求逆或有限元分析问题就是很好的例子。在计算中，对列表进行排序就是一个例子。例如，快速排序例程将列表拆分为两个列表，并对每个列表执行快速排序，递归调用自身（快速排序）。在上述两个示例中，这两个任务可以（并且经常）异步执行。它们不需要位于单独的线程上。即使是一台只有一个 CPU 和一个执行线程的机器，也可以编码为在第一个任务完成之前启动第二个任务的处理。唯一的标准是*一项任务的结果不需要作为另一项任务的输入*. 只要任务的开始时间和结束时间重叠（仅当两者的输出都不需要作为另一个的输入时才可能），它们就会异步执行，无论有多少线程正在使用。

**同步示例：**

由多个任务组成的任何过程，其中任务必须按顺序执行，但必须在另一台机器上执行（获取和/或更新数据，从金融服务获取股票报价等）。如果它在单独的机器上，它在单独的线程上，无论是同步的还是异步的。

* * *

## 回答 #3

> 赞同：704
> 
> 时间：2014-11-07T15:43:07.433

简单来说：

同步

你在排队买电影票。在你前面的每个人都得到一个之前，你不能得到一个，这同样适用于你后面排队的人。

异步

你和很多人在一家餐馆。你点你的食物。其他人也可以订购他们的食物，他们不必等到您的食物煮熟并送达您才可以订购。在厨房里，餐厅的工作人员不断地做饭、上菜和接单。人们将在食物煮熟后立即上菜。

* * *

## 回答 #4

> 赞同：390
> 
> 时间：2015-06-08T11:13:08.070

# 类比简单说明

[![愤怒的员工](https://i.stack.imgur.com/uxSn5.jpg)](https://i.stack.imgur.com/uxSn5.jpg)

（故事和图片可以帮助您记住）。

**同步执行**

我的老板是个大忙人。他告诉我写代码。我告诉他：好的。我开始了，他像秃鹰一样看着我，站在我身后，远离我的肩膀。我就像“伙计，WTF：我完成这件事时你为什么不去做点什么？”

他就像：“不，我在*这里等*你完成。” 这是同步的。

**异步执行**

老板让我去做，老板没有在那儿等我的工作，而是离开并做其他任务。当我完成我的工作时，我只是向我的老板汇报并说：“我完成了！” 这是异步执行。

（听我的建议：永远不要和你身后的老板一起工作。）

* * *

## 回答 #5

> 赞同：95
> 
> 时间：2009-04-14T15:43:52.840

**同步执行**意味着执行发生在一个系列中。 `A->B->C->D`. 如果您正在调用这些例程，`A`将运行，然后完成，然后`B`将开始，然后完成，然后`C`将开始，等等。

使用**异步执行**，您开始一个例程，并在您开始下一个例程时让它在后台运行，然后在某个时候说“等待这个完成”。它更像是：

*开始* `A->B->C->D->`*等待*`A`完成_

优点是您可以在仍在运行时执行`B`、`C`和 or （在后台，在单独的线程上），因此您可以更好地利用资源并减少“挂起”或“等待”。`D``A`

* * *

## 回答 #6

> 赞同：65
> 
> 时间：2015-08-17T14:11:16.937

简而言之，同步是指两个或多个进程的**起点**和**终点**，而***不是***它们的**执行**。在此示例中，进程 A 的端点与进程 B 的起点同步：

```
同步
   |--------A--------|
                     |--------B--------|

```

另一方面，异步进程*没有*同步它们的开始和端点：

```
异步
   |--------A--------|
         |--------B--------|

```

在进程 A 与进程 B 重叠的地方，它们同时或[同步](http://www.merriam-webster.com/dictionary/synchronous "同步")运行（字典定义），因此会造成混淆。

更新：Charles Bretana 改进[了他的答案](https://stackoverflow.com/a/748235)，所以这个答案现在只是一个简单的（可能过于简单化）助记符。

* * *

## 回答 #7

> 赞同：61
> 
> 时间：2009-04-14T15:47:33.283

同步意味着调用者等待响应或完成，`asynchronous`调用者继续，响应稍后出现（如果适用）。

举个例子：

```
static void Main(string[] args)
{
    Console.WriteLine("Before call");
    doSomething();
    Console.WriteLine("After call");
}

private static void doSomething()
{
    Console.WriteLine("In call");
} 
```

这将始终输出：

```
Before call
In call
After call 
```

但是如果我们要制作`doSomething` `asynchronous`（有多种方法），那么输出*可能会*变成：

```
Before call
After call
In call 
```

因为进行异步调用的方法将立即继续下一行代码。我说“可以”，因为异步操作无法保证执行顺序。它也可以按原样执行，具体取决于线程时间等。

* * *

## 回答 #8

> 赞同：49
> 
> 时间：2018-03-20T13:54:10.270

**同步与异步**

`Sync`和`async`操作是关于执行**顺序**a`next task` **与**`current task`

让我们看一个例子 where `Task 2`is`current task`和`Task 3`is a `next task`。任务是原子操作 - 堆栈中的方法调用（方法框架）

**同步**- 意味着任务将被一一执行。A`next task`只有在`current task`完成后才开始。`Task 3`直到`Task 2`完成才开始

**单线程 + 同步 - 顺序**通常执行。伪代码：

```
main() {
    task1()
    task2()
    task3()
} 
```

![](https://i.stack.imgur.com/8fQVc.png)

**多线程 + 同步 - 并行**- 阻塞。阻塞意味着一个线程正在等待（尽管它可以做一些有用的事情。例如 Java `ExecutorService`[^([About])](https://stackoverflow.com/a/66567556/4770877)和`Future`[^([About])](https://stackoverflow.com/a/66082407/4770877)）伪代码：

```
main() {
    task1()
    Future future = ExecutorService.submit(task2())
    future.get() //<- blocked operation
    task3()
} 
```

![](https://i.stack.imgur.com/yw9cr.png)

**异步**——意味着任务立即返回控制权并承诺执行代码并稍后通知结果（例如回调、功能）。`Task 3`即使`Task 2`没有完成也会执行。`async callback`, `completion handler`[^([关于])](https://stackoverflow.com/a/60990583/4770877)

**单线程 + 异步 - 使用并发** `Callback Queue`( `Message Queue`) 和`Event Loop`( `Run Loop`, `Looper`)。`Event Loop`检查是否`Thread Stack`为空，如果为真，则将第一个项目从其中推`Callback Queue`入`Thread Stack`并再次重复这些步骤。简单的例子是按钮点击，发布事件......伪代码：

```
main() {
    task1()
    ThreadMain.handler.post(task2());
    task3()
} 
```

![](https://i.stack.imgur.com/SvOQ7.png)

**多线程 + 异步 - 并发和并行**非阻塞。例如，当您需要在另一个线程上进行一些计算而不阻塞时。伪代码：

```
main() {
    task1()

    new Thread(task2()).start();
    //or
    Future future = ExecutorService.submit(task2())

    task3()
} 
```

您可以使用阻塞方法`get()`或`async callback`通过使用任务 2 的结果`loop`

![](https://i.stack.imgur.com/gAOF0.png)

例如在移动世界中，我们有 UI/主线程，我们需要下载一些东西，我们有几个选择：

*   `sync`block - 阻塞 UI 线程并在下载完成时等待。UI 没有响应。
*   `async`回调 - 创建一个带有异步回调的新线程以更新 UI（无法从非 UI 线程访问 UI）。回调地狱。
*   `async`coroutine [^([About])](https://stackoverflow.com/a/65169350/4770877) - 具有同步语法的异步任务。它允许将下载任务（挂起功能）与 UI 任务混合

[[iOS 同步/异步]](https://stackoverflow.com/a/59542492/4770877) , [[Android 同步/异步]](https://stackoverflow.com/a/49338894/4770877)

[[并行与并发]](https://stackoverflow.com/a/63744581/4770877)

* * *

## 回答 #9

> 赞同：36
> 
> 时间：2009-04-14T16:27:25.263

我认为这是一个有点迂回的解释，但它仍然使用现实生活中的例子来澄清。

小例子：

假设播放音频涉及三个步骤：

1.  从硬盘获取压缩歌曲
2.  解压音频。
3.  播放未压缩的音频。

如果您的音频播放器按顺序为每首歌曲执行步骤 1、2、3，则它是同步的。您将不得不等待一段时间才能听到这首歌，直到歌曲真正被提取并解压缩。

如果您的音频播放器执行步骤 1、2、3 彼此独立，则它是异步的。IE。在播放音频 1（步骤 3）时，如果它并行从硬盘获取音频 3（步骤 1）并并行解压缩音频 2。（第 2 步）您最终会听到这首歌，而无需等待太多提取和解压缩。

* * *

## 回答 #10

> 赞同：28
> 
> 时间：2009-04-14T15:41:50.957

简单地说，异步执行就是在后台做事。

例如，如果您想从 Internet 下载文件，您可能会使用同步函数来执行此操作，但它会阻塞您的线程，直到文件完成下载。这会使您的应用程序对任何用户输入都没有响应。

相反，您可以使用异步方法在后台下载文件。在这种情况下，下载功能立即返回，程序继续正常执行。所有下载操作都在后台完成，完成后会通知您的程序。

* * *

## 回答 #11

> 赞同：28
> 
> 时间：2019-03-31T23:01:26.730

我创建了一个 gif 来解释这一点，希望对您有所帮助：看，第 3 行是异步的，其他的是同步的。第 3 行之前的所有行都应该等到第 3 行完成它的工作之前，但是由于第 3 行是异步的，所以下一行（第 4 行），不要等待第 3 行，但第 5 行应该等待第 4 行完成它的工作，并且第 6 行应该等待第 5 行和第 7 行等待 6，因为第 4、5、6、7 行不是异步的。 [![第 3 行是异步的，其他是同步的](https://i.stack.imgur.com/Hji4s.gif)](https://i.stack.imgur.com/Hji4s.gif)

* * *

## 回答 #12

> 赞同：22
> 
> 时间：2017-10-02T11:22:20.153

作为一个非常简单的例子，

**同步**

想象一下 3 名学生被要求在公路上进行接力赛。

第一名学生跑了她给定的距离，停下并将接力棒传给第二名学生。没有其他人开始跑步。

```
1------>
        2.
                3. 
```

当第二个学生取回接力棒时，她开始跑给定的距离。

```
 1.
        2------>
                3. 
```

第二个学生解开了她的鞋带。现在她又停下来绑起来了。因此，第二届的结束时间被延长，第三届的开始时间被推迟。

```
 1.
        --2.--->
                3. 
```

这种模式一直持续到第 3 名从第 2 名手中接过接力棒并完成比赛。

**异步**

想象一下 10 个随机的人走在同一条路上。他们当然不是在排队，只是在路上以不同的速度随意走在不同的地方。

第二个人的鞋带解开了。她停下来把它重新绑起来。

但是没有人在等她把它绑起来。其他人仍然以他们以前的方式行走，以同样的步伐。

```
10-->    9-->
   8--> 7-->   6-->
 5-->     4-->
1-->   2\.    3--> 
```

* * *

## 回答 #13

> 赞同：18
> 
> 时间：2015-11-07T16:33:20.857

同步基本上意味着您一次只能执行一件事。异步意味着您可以一次执行多项操作，而无需完成当前操作即可继续执行下一项操作。

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2012-12-15T13:38:51.213

当执行类似 a>b>c>d> 的序列时，如果我们在执行过程中遇到失败，例如：

```
a
b
c
fail 
```

然后我们从头开始：

```
a
b
c
d 
```

这是同步的

但是，如果我们有相同的执行顺序：a>b>c>d>，而我们中间有一个失败：

```
a
b
c
fail 
```

...但我们不是从头开始，而是从故障点重新开始：

```
c
d 
```

...这被称为异步。

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2019-04-10T07:46:18.880

**使用制作早餐的说明示例**

1.  倒一杯咖啡。
2.  加热平底锅，然后煎两个鸡蛋。
3.  煎三片培根。
4.  烤两片面包。
5.  在吐司中加入黄油和果酱。
6.  倒入一杯橙汁。

如果你有烹饪经验，你会异步执行这些指令。你会开始为鸡蛋加热锅，然后开始培根。你把面包放在烤面包机里，然后开始鸡蛋。在流程的每一步，您都会开始一项任务，然后将注意力转移到准备好引起您注意的任务上。

**做早餐**是非并行**异步**工作的一个很好的例子。一个人（或线程）可以处理所有这些任务。继续早餐的类比，一个人可以通过在第一个任务完成之前开始下一个任务来异步制作早餐。无论是否有人在看，烹饪都会进行。一旦你开始为鸡蛋加热平底锅，你就可以开始煎培根了。培根开始后，您可以将面包放入烤面包机中。

对于并行算法，您需要多个厨师（或线程）。一个做鸡蛋，一个做培根，依此类推。每个人都只专注于那一项任务。每个厨师（或线程）将被同步阻塞，等待培根准备好翻转，或者吐司弹出。

来自[异步编程概念的参考](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/async/)

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2013-01-11T15:18:31.887

您将同步与并行与串行混淆。同步意味着所有在同一时间。同步意味着彼此相关，可以意味着串联或固定间隔。虽然程序正在做所有事情，但它是串联运行的。拿一本字典……这就是我们喝不甜茶的原因。你有茶或加糖的茶。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2014-04-09T14:45:43.647

同步操作在返回给调用者之前完成其工作。

异步操作在返回给调用者后完成（大部分或全部）其工作。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2016-07-11T01:30:59.683

关于同步执行的“*同时*”定义（有时令人困惑），这是理解它的好方法：

**同步执行**：*代码块中的所有任务都同时执行。*

**异步执行**：*代码块中的所有任务并非全部同时执行。*

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2018-01-11T15:24:51.063

我认为一个很好的思考方式是经典的跑步接力赛

**同步**：进程就像同一个团队的成员，直到他们收到接力棒（前一个进程/运行器的执行结束）才会执行，但它们都彼此同步。

**异步**：在同一个接力赛道上的不同团队成员的进程类似，它们将运行和停止，彼此异步，但在同一个比赛中（整体程序执行）。

是否有意义？

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2018-05-23T16:04:33.587

同步的不同英文定义在[这里](https://en.oxforddictionaries.com/definition/synchronize)

> 协调; 结合。

我认为这是比“同时发生”更好的定义。这也是一个定义，但我认为它不适合它在计算机科学中的使用方式。

因此，异步任务不与其他任务协调，而同步任务与其他任务协调，因此一个在另一个开始之前完成。

如何做到这一点是一个不同的问题。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-01-11T15:29:42.927

同步意味着队列方式执行一个一个的任务将被执行。假设只有需要在朋友之间共享才能到达目的地的车辆将被共享。
在异步情况下，每个朋友都可以租到车辆并到达目的地。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-10-04T15:48:45.250

是的，同步意味着同时，从字面上看，它意味着一起工作。世界上的多个人/物体可以同时做多件事，但是如果我们看一下计算机，它说同步意味着进程一起工作，这意味着进程依赖于彼此的返回，这就是它们被执行的原因一个接一个地以适当的顺序。而异步意味着进程不一起工作，它们可以同时工作（如果在多线程上），但独立工作。

# visual-studio-2008 - 搁置 TFS 中的待定更改

> ID：748184
> 
> 赞同：32
> 
> 时间：2009-04-14T15:42:44.327
> 
> 标签：visual-studio-2008, tfs, version-control, tfvc

现在，我有一些重大的代码更改无法及时完成，因此需要搁置。有没有一种好方法可以将这些更改从我的工作区中取出，但以后可以返回它们？也许我遗漏了一些东西，但看起来即使它们被搁置，这些更改仍保留在工作区中。

有一个更好的方法吗？我不想创建另一个工作区。

我们正在使用 VS 2008 和 TFS 2008。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-04-14T15:45:59.670

当您搁置更改时，底部有一个复选框“在本地保留待处理的更改”。取消选中它，它将在构建 Shelf 时撤消对文件的签出。

此外，一旦创建了货架，您就可以自己安全地撤消结帐；结果相同，但我认为该复选框更安全一些，因为它只会撤消对您正在搁置的文件的签出（因此您不会意外撤消对您错过或故意没有搁置的文件的签出）。

# bash - 如何在 Bash 脚本中运行 AWK？

> ID：748185
> 
> 赞同：2
> 
> 时间：2009-04-14T15:42:45.870
> 
> 标签：bash, awk

问题与我[在这里](https://stackoverflow.com/questions/721575/how-can-i-show-the-number-of-annotations-from-google-cse-in-blogger/748141#748141)的回答有关。

我无法让以下代码工作

```
#!/bin/bash 
wget http://www.google.com/coop/cse?cx=017685108214920485934%3Aizx6pzojwka -O CSE-spanien
awk '/^searches [1-9]* sites, including:/ { print $2 }' CSE-spanien 
```

**错误消息示例**[已编辑]

```
$./code
--2009-04-14 19:01:32--  http://www.google.com/coop/cse?cx=017685108214920485934%3Aizx6pzojwka
Resolving www.google.com... 74.125.79.103, 74.125.79.99, 74.125.79.147, ...
Connecting to www.google.com|74.125.79.103|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: unspecified [text/html]
Saving to: `cse?cx=017685108214920485934:izx6pzojwka.6'

    [ <=>                                                                                                               ] 8,096       --.-K/s   in 0s      

2009-04-14 19:01:33 (78.0 MB/s) - `cse?cx=017685108214920485934:izx6pzojwka.6' saved [8096]

./code: line 3: -O: command not found
awk(57264) malloc: *** error for object 0x4eee0: Non-aligned pointer being freed (2)
*** set a breakpoint in malloc_error_break to debug
awk: cmd. line:1: fatal: cannot open file `/Users/Masi/Documents/test/CSE-spanien' for reading (No such file or directory) 
```

**如何在 Bash 脚本中运行 AWK？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T15:51:05.147

你在`-O CSE-spanien`你的行尾失踪了`wget`。结果，`CSE-spanien`不存在 -`wget`将其保存为带有文件名的 HTML `cse?cx=017685108214920485934:izx6pzojwka.2`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T15:46:09.810

一些随意的想法

*   检查你的路径---脚本环境中使用的路径。在您的环境中被`awk`命名为“awk”吗？
*   考虑将[HERE 文档](http://tldp.org/LDP/abs/html/here-docs.html)用于非平凡的脚本
*   您需要重定向输出吗？标准误呢？
*   您是否应该捕获前一个流程的退出状态并首先做出一些决策？
*   从您的错误消息看来，您可以使用`if [ -f FileToUse ]`. 如果您不确定 whee`wget`会输出输出，您可能需要强制输出 ( `-O`)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T15:55:18.337

问题是 wget 不会`CSE-spanien`在当前工作目录中创建文件。我建议您检查文件的创建位置并在 awk 命令中添加文件的完整或相对路径。测试预期文件是否存在也是明智之举（`test -f CSE-spanien && awk ...`）

# c# - 如何捕获电话号码

> ID：748186
> 
> 赞同：4
> 
> 时间：2009-04-14T15:42:48.677
> 
> 标签：c#, .net, vb.net

我正在寻找在 vb.net 或 c#.net 中创建一个 Windows 应用程序，它将捕获来电的电话号码。这将是一条陆线。硬件要求是什么？将使用哪些 .Net 库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-18T00:59:55.660

您需要一个支持来电显示并受 Windows 支持的最新调制解调器。Windows 提供了一个与调制解调器对话的 API，称为电话应用程序编程接口，也称为 TAPI。[不幸的是，无法从托管代码轻松访问](http://support.microsoft.com/kb/841712)此 API 。

在托管代码中访问呼叫者 ID 的最佳选择是使用位于 TAPI API 之上的免费或共享软件 TAPI OCX 控件之一，它们中的大多数应该有一个简单的 API，可以为您提供传入号码。谷歌搜索“TAPI OCX”或“TAPI Caller ID”之类的东西，看看有什么可用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T15:49:57.523

如果它是您正在谈论的固定电话，那么您只需要一个标准模拟调制解调器和一个用于连接它的串行端口。您将使用标准的 AT 样式命令来控制调制解调器并监控传入的数据。

有关特定命令和事件，请查看[有关 Hayes AT 命令集的 Wikipedia 文章](http://en.wikipedia.org/wiki/Hayes_command_set)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T02:30:59.447

如果您有 VOIP 系统，您的系统提供商可能有一个 API 可用于执行此操作。根据我的经验，这将花费额外的费用并且是错误的。

# delphi - 如何捕获以 TDBGrid 作为其父级的按钮的单击事件？

> ID：748190
> 
> 赞同：3
> 
> 时间：2009-04-14T15:43:28.287
> 
> 标签：delphi, vcl

我有一个小按钮，我想添加到 Delphi TDBGrid 组件的左上角（在标题/标题单元格中）。我可以轻松放置按钮，但现在未处理单击事件。我猜这个事件被网格捕获了。有什么办法可以强制此特定事件转到按钮？注意我仍然需要网格来处理它的标题按钮的点击事件，就像它目前所做的那样。

```
procedure TForm38.FormCreate(Sender: TObject);
begin
   button1.Parent := grid;
   button1.Top := 0;
   button1.Left := 0;
   button1.Width := 12;
   button1.Height := 18;
   button1.OnClick := Button1Click;
end; 
```

**更新：**我发现我可以使用按钮的 MouseDown 事件，这似乎工作得很好，但我不能使用 click 事件。

```
procedure TForm38.Button1MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
   if ( Button = mbLeft ) then
      TButton(Sender).Click;
end; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T16:14:14.140

哇，这是一个顽固的人。TDBGrid 没有通用的“OnClick”事件处理程序，并且您的按钮的位置使其难以伪造。我唯一能想到的就是创建自己的组件。这并不像一开始听起来那么困难。从 TDBGrid 下降并覆盖 MouseUp 方法。看一下 TCustomDBGrid.MouseUp 的实现方式。我还没有对此进行测试，但您可能会尝试这样的事情：在测试的 if 语句之后

```
(cell.x >= FIndicatorOffset) 
```

并触发点击事件，如果 cell.x < FIndicatorOffset，让它触发 TitleClick(nil) 或其他东西。然后将事件处理程序附加到网格的 OnTitleClick 事件，如果 Column = nil 则调用 Button1.Click。（是的，有点像黑客，但我想不出更简单的方法。如果我是你，我会把这个作为错误报告给 QC。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T16:38:59.760

我不确定它为什么会吃点击信息。您实际上是通过 MouseUp 事件处理程序模拟单击事件。

```
procedure TForm38.Button1MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
var
  ctrl: TButton;
begin
  ctrl := Sender as TButton;
  if (x > 0) and (x < ctrl.Width) and (y > 0) and (y < ctrl.Height)  then
    ctrl.Click;
end; 
```

如果您测试一个普通按钮，您将看到单击事件在您释放鼠标之前不会发生。模拟单击按钮会产生奇怪的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T07:11:13.407

以下是一个干净的解决方案，在 Delphi 1 和 Delphi 2007 上都成功尝试过：

```
procedure TForm38.FormCreate(Sender: TObject);
begin
   button1.Parent := grid;
   button1.Top := 0;
   button1.Left := 0;
   button1.Width := 12;
   button1.Height := 18;
   button1.OnClick := Button1Click;

   // only add this line
   button1.ControlStyle := button1.ControlStyle + [csClickEvents];

end; 
```

# wpf - 在 WPF 中，你能在 PathFigure 中找到最合适的片段吗？

> ID：748191
> 
> 赞同：0
> 
> 时间：2009-04-14T15:43:36.367
> 
> 标签：wpf, hittest

我正在制作一个涉及拖动显示元素的控件。由于其中一部分是弧线，因此我必须使用 PathFigure，以便可以使用 ArcSegments。我想知道鼠标是否在图形的特定部分上，但我没有看到明显的方法来做到这一点。这是不可能的还是我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-14T14:45:21.120

根 Path 对象具有鼠标的正常 UI 事件，而不是一个带有很多弧的路径，您将需要很多路径，每个路径都有一个弧。

# php - 不应该缓存的 Html / php 页面（客户端）

> ID：748193
> 
> 赞同：1
> 
> 时间：2009-04-14T15:44:35.443
> 
> 标签：php, html

网址在这里：[http ://www.thexsoft.com/DownloadFolder/download.php?file=P2PTransfer](http://www.thexsoft.com/DownloadFolder/download.php?file=P2PTransfer)

这个页面基本上是我设置 url 以下载我发布的某个问题的一种方式。此页面永远不应该被缓存，但它似乎仍在缓存中。

我设置了以下项目：

```
<meta http-equiv="expires" content="0" >
<meta http-equiv="cache-control" content="no-cache" >
<meta http-equiv="pragma" content="no-cache" >
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" > 
```

当我没有 fastclick.net 广告代码时，页面上的 html 代码验证 100%，但我现在保留它，因为它通常在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T15:49:34.590

Pragma: no-cache 仅在通过安全连接 (https) 使用时防止缓存。如果在非安全页面中使用 Pragma: no-cache META 标签，则其处理方式与 Expires: -1 相同。该页面将被缓存但标记为立即过期。

[http://support.microsoft.com/kb/234067](http://support.microsoft.com/kb/234067)

```
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Expires" CONTENT="-1"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T15:51:00.453

是的，在某些情况下浏览器会积极缓存，尤其是 IE6。您需要检查服务器正在发送的 http 标头，如果这不是问题，请尝试使用 cachebusting URL（插入一个随机/基于时间的 get 变量）以使浏览器认为它是一个新 URL。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T19:17:03.467

[我使用Firebug](http://www.getfirebug.com/)检查了您的标题：

```
Cache-Control: max-age=1209600
Expires: Tue, 28 Apr 2009 18:49:15 GMT 
```

[在 PHP 中，您可以使用header()](http://www.php.net/manual/en/function.header.php)发送 HTTP 标头。

```
header('Pragma: no-cache');
header('Expires: -1');
header('Cache-Control: must-revalidate, post-check=0, pre-check=0'); 
```

# windows - SCardEstablishContext 作为服务挂起

> ID：748197
> 
> 赞同：2
> 
> 时间：2009-04-14T15:45:10.763
> 
> 标签：windows, delphi, windows-services

当从服务调用时，为什么 SCardEstablishContext 可能会挂起，永远不会返回？

我的代码在许多 Windows 安装中都能正常工作。它访问 Cherry 键盘的智能卡读卡器 (6x44) 以读取智能卡上的数据。它在大多数已试用过的 PC 上都能正常工作。但是，在某些在西班牙运行西班牙文 Windows 的 PC 上，SCardEstablishContext 函数永远不会返回。我无法弄清楚为什么会这样。我已经记录了它的任一侧，但它之后的日志条目没有出现。然后我不能关闭它（工作线程卡住了），必须杀死它。

如果从应用程序而不是服务运行，完全相同的线程代码可以正常工作。提供用户而不是系统的服务登录设置没有区别。我在这里的一台机器上安装了西班牙语 XP，但它工作得很好。远端具有与我在这里相同的 Winscard.dll 版本（均处于 XP SP3 状态）。事件日志中未显示任何错误。

我怎样才能找出问题所在，以及解决问题的方法？（下面的德尔福代码）

```
// based on code by Norbert Huettisch
function TPCSCConnector.Init: boolean;
var
    RetVar: LongInt;
    ReaderList: string;
    ReaderListSize: integer;
    v: array[0..MAXIMUM_SMARTCARD_READERS] of string;
    i: integer;
begin
    Result := false;
    FNumReaders := 0;
{$IFDEF MJ_ONLY}
    LogReport(leInformation, 'About to call SCardEstablishContext');
{$ENDIF}
    RetVar := SCardEstablishContext(SCARD_SCOPE_USER, nil, nil, @FContext);
{$IFDEF MJ_ONLY}
    // never gets to report this (and logging known good etc)
    LogReport(leInformation, 'SCardEstablishContext result = ' + IntToStr(RetVar));
{$ENDIF}
    if RetVar = SCARD_S_SUCCESS then
    begin 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T17:40:11.360

API 函数出现挂起的原因可能有多种，例如死锁，或者等待用户输入的不可见消息框或对话框。您应该尝试[使用 WinDbg](http://support.microsoft.com/kb/824344/en)获取堆栈跟踪。

您还应该确保您尝试在同一环境中重现该错误。重要的一点可能是快速用户切换是否处于活动状态以及其他用户是否已登录，以及是否有相同的设备驱动程序和服务正在运行。

# c# - 这是 LINQable 吗？

> ID：748200
> 
> 赞同：0
> 
> 时间：2009-04-14T15:45:29.297
> 
> 标签：c#, linq

我有一个表示过滤器路径的字符串（例如“Plant Filters\Equipment\Equipment List”）叶节点是过滤器类型，其余是过滤器文件夹。

我需要：

1.  遍历每个节点（不是叶子）并获取它 -> 文件夹
2.  检查路径中的下一个条目，看看它是否与上面的文件夹匹配
3.  如果它匹配，它是最后一个，然后它得到它的过滤器
4.  然后检查它的过滤器，看它是否与最后一个字符串条目匹配，如果不匹配，则获取其文件夹并基本上返回步骤 2。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T18:55:12.023

这是一种递归结构，无法使用 LINQ 标准查询运算符进行处理。在这里，您可以找到允许编写递归 lambda 表达式[的 Y 组合器的实现。](http://www.pluralsight.com/community/blogs/jeffsch/archive/2006/08/18/33631.aspx)我不确定你是否应该使用它，因为在底层它是一个简单问题的相当复杂的解决方案。这种[递归查询运算符的实现](http://work.j832.com/2008/01/flattening-recursive-algorithms-with.html)（请注意，链接的博客条目不是正确的最终解决方案 - 阅读后面的条目以使其正确）要简单得多，但不能解决定义递归 lambda 表达式的一般问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T16:24:49.810

好吧，我对没有示例代码有点困惑，但据我所知，任何东西都可以被 linqed，如果它是集合、类等......我建议做的是使用 split 函数创建该路径的字符串数组，然后查询该字符串，使用 Switch 运算符或 If else。

我真的需要看样品，这样我才能更准确地判断。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T16:36:16.013

我在定义 ForEachIndex extn 后尝试了这种方式。没有测试过（duhh），我认为应该可以。

```
public static FilterBase FilterFromPath(this Site activeSite, string filterPath)
    {
        //"Catalog Filters\Default Filters\SP3D Report Filters\Types of Reports\Equipment\Equipment Material Take-Off"            
        Checks.IsNotNull(() => activeSite.ActivePlant);

        FilterFolder currentFolder = null;
        string plantFilters = CmnLocalizer.GetString(CmnResourceIDs.CmnFilterPlantFiltersFolder, "Plant Filters");
        string catalogFilters = CmnLocalizer.GetString(CmnResourceIDs.CmnFilterCatalogFiltersFolder, "Catalog Filters");

        if (filterPath.StartsWith(plantFilters))
            currentFolder = activeSite.ActivePlant.PlantModel.Folders[0] as FilterFolder;
        else if (filterPath.StartsWith(catalogFilters))
            currentFolder = activeSite.ActivePlant.PlantCatalog.Folders[0] as FilterFolder;
        else
            throw new ArgumentException("Invalid filter root specified. Should start with Plant or Catalog Filters");

        IEnumerable<string> pathEntries = filterPath.Split(new string[] { @"\" }, StringSplitOptions.RemoveEmptyEntries).Skip(1);
        Checks.IsNotNull(() => pathEntries);
        if (pathEntries.Count() == 0)
            throw new ArgumentException("Invalid filter path specified");

        int lastIndex = pathEntries.Count() - 1;            
        FilterBase filterFound = null;

        pathEntries.ForEachIndex((item, index) =>
        {
            if (index == lastIndex)
            {
                filterFound = currentFolder.ChildFilters.FirstOrDefault(f => f.Name.Equals(item));
                if (filterFound.Equals(default(FilterBase)))
                    throw new ArgumentException(string.Format("Filter '{0}' could not be found", item));
            }
            else
            {
                currentFolder = currentFolder.ChildFolders.FirstOrDefault(f => f.Name.Equals(item));
                if (currentFolder.Equals(default(FilterFolder)))
                    throw new ArgumentException(string.Format("Folder '{0}' given in filter path not found", item));
            }
        });

        return filterFound;
    } 
```

# wpf - WPF 还是工作流？

> ID：748201
> 
> 赞同：2
> 
> 时间：2009-04-14T15:45:57.283
> 
> 标签：wpf, workflow, workflow-foundation

我有一个问题，希望你能引导我朝着正确的方向前进。

由于缺乏更好的术语，我正在开发一个需要某种形式的决策树/工作流程的应用程序。为了清楚起见，我将在下面对其进行描述。

我有一个用户将在网页上填写的请求表。表格的开头是“推荐类型”。根据所选择的推荐类型，某些表单问题将发生变化。根据推荐类型，可能有 2、3 或 4 组问题。整组问题可以通过或失败。

如果第一组问题失败......然后表格停止处理，等等。

处理这个问题的最佳方法是什么？WPF 在这种情况下会很好地工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T15:50:50.110

WPF 是[Windows Presentation Foundation](http://msdn.microsoft.com/en-us/netframework/aa663328.aspx)，更多的是关于用户界面而不是工作流管理系统。对于工作流程，您可以构建自己的本地数据库驱动解决方案，也可以使用 Ultimus 或 Sharepoint 等工具。

您可能还会想到[Windows Work Flow Foundation](http://msdn.microsoft.com/en-us/netframework/aa663328.aspx)。

我已经使用 Ultimus 和本地开发的实现来进行工作流程管理。同行使用过Sharepoint。每个都有好处或优点/缺点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T16:13:03.940

我不确定 Workflow 与 ASP.NET 的配合如何，因为我从未尝试过。我相信一些样本实际上可能涵盖了这一点，所以这是可能的。这是第一个技术障碍。

听起来逻辑并不复杂。根据推荐类型，用户可以采用有限数量的“路径”。每条路径都是相当线性的，有 2-4 个“组”问题。每个组可以坐在一个页面上吗？这将大大简化事情。

[Spring.NET Web Framework](http://www.springframework.net/doc-latest/reference/html/web.html#web-resultmapping)等Web 框架可能比 Workflow 更适合此任务。您正在尝试表达一些条件逻辑——本质上，“如果 X 则转到下一页，否则结束问题”。Spring.NET 使用其验证框架和结果映射来处理这种精确的逻辑。

工作流当然非常适合这种逻辑，但是除了验证之外，对于每组问题，是否会发生任何事情？如果没有，那可能是矫枉过正。

# flash - SWFObject（1.5 和 2.1）不允许在 IE 中全屏显示

> ID：748211
> 
> 赞同：0
> 
> 时间：2009-04-14T15:48:14.063
> 
> 标签：flash, actionscript-3, swfobject

有谁知道为什么和/或如何在不抓取 SWFObject 的情况下解决这个问题？

非常感谢，

编辑：对不起，我的错 alowFullScreen 参数设置为“ **true** ”而不是“ **always** ”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T16:01:41.567

您是否`allowFullscreen`在包含的 HTML 中设置了 Flashvar？有关详细信息（包括全屏模式安全详细信息），请参阅本[教程。](http://livedocs.adobe.com/flex/3/html/help.html?content=05B_Security_06.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T16:27:40.693

抱歉，allowFullScreen 参数设置为“true”而不是“always”是我的错

# asp.net-mvc - 如何使用我选择的 URL 格式实现动态路由？

> ID：748212
> 
> 赞同：0
> 
> 时间：2009-04-14T15:48:14.453
> 
> 标签：asp.net-mvc, routing, url-routing

我的 URL 要求是`countryname/statename/cityname`. 为此，我正在编写我自己的`RouteHandler`并添加一条新路线，`routecollection`如下所示：

```
routes.Add(new Route("{*data}",
           new RouteValueDictionary(new
               {
                 controller = "Location",
                 action = "GetLocations"
               }),
           new MyRoutehandler())); 
```

现在我的问题是：如何生成这种类型的 URL？

我试过`Html.ActionLink()`了，但它要求输入动作名称和控制器名称。但是，在我的 URL 格式中，我没有任何操作名称或控制器名称。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T18:11:52.907

您是否有理由不能将以下内容与内置路由处理程序一起使用：

```
routes.MapRoute("LocationRoute",
                "{countryname}/{statename}/{cityname}", 
                new { controller = "Location", action = "GetLocations" }); 
```

这可能与默认的 "{controller}/{action}/{id}" 路由冲突，但无论如何都会在您当前的系统中发生（除非您创建自定义*Route*，继承自`System.Web.Routing.RouteBase`，而不是自定义*Route Handler*）。*Route Handler*用于处理提取路由数据后要执行的操作。由于您仍在使用 Controller 和 Action，因此您应该仍然可以使用`MvcRouteHandler`. 如果要自定义提取 Route Data 的方式，您可能需要自定义*Route*。

顺便说一句，如果您想使用不涉及 Controller 和 Action 名称的路由，请使用`Html.RouteLink`. `ActionLink`只是一个包装器，它将控制器和动作放入 中，`RouteValuesDictionary`并调用与 . 相同的内部帮助器`RouteLink`。

虽然在这种情况下，路由仍然有一个 Controller 和 Action（“Location”和“GetLocations”），所以你仍然可以使用`ActionLink`. 我*认为* `ActionLink`可以让你指定一个路由名称，所以如果你给你的路由一个名称，你可以在其中指定该名称，`ActionLink`它将使用该路由来生成 URL（我可能错了，如果是这样，你仍然可以使用`RouteLink`并手动添加控制器和动作路由值）

# apache-flex - 在 Adob e Flex 中设置数据网格行的背景颜色

> ID：748213
> 
> 赞同：6
> 
> 时间：2009-04-14T15:48:34.110
> 
> 标签：apache-flex, datagrid, colors, background, row

我需要以编程方式更改 Flex 中数据网格中单行的背景颜色。我搜索了网络并找到了对“dg.setPropertiesAt”的引用，这不是受支持的方法（根据编译器）。此外，有建议扩展 dg 的“drawRowBackground”方法，但我需要在外部设置背景（而不是从 dg 内部的逻辑）。

欢迎任何和所有建议。

TIA，鲍勃

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T16:18:46.640

您必须使用 itemRenderer 才能完成此操作。有关详细信息，请参阅以下示例：

[http://butterfliesandbugs.wordpress.com/2007/07/11/using-an-itemrenderer-to-change-the-background-of-a-datagrid-cell/](http://butterfliesandbugs.wordpress.com/2007/07/11/using-an-itemrenderer-to-change-the-background-of-a-datagrid-cell/)

[http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&postId=61&productId=2](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&postId=61&productId=2)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-04-15T16:52:20.390

I managed it by extending the DataGrid class and creating my own method, like this:

```
public function paintRow(rowNumber:Number,color:uint):void{
var rowBGs:Sprite=Sprite(listContent.getChildByName("rowBGs"));
drawRowBackground(rowBGs,rowNumber,listContent.rowInfo[rowNumber].y,listContent.rowInfo[rowNumber].height,color,null);
} 
```

This was inspired by the drawRowBackgrounds method of the datagrid class.

Hope it helps.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-14T20:57:21.777

几天前我也在想同样的事情。如果你有 Flex 的 Pro 版本，它的 AdvancedDataGrid 有内置的“styleFunction”属性来处理这个问题。如果您手边只有常规的 DataGrid，这可能会有所帮助：

[http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&productId=2&postId=12548](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&productId=2&postId=12548)

那里的评论链接到 styleFunction 的文档：

[http://livedocs.adobe.com/flex/3/langref/mx/controls/advancedDataGridClasses/AdvancedDataGridBase.html#styleFunction](http://livedocs.adobe.com/flex/3/langref/mx/controls/advancedDataGridClasses/AdvancedDataGridBase.html#styleFunction)

除此之外，Stiggler 对使用 itemRenderer 的建议是您的另一种选择。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-01T11:48:06.700

将此与 spark.DataGrid 一起使用

DataGridRowBackground.mxml：

```
<?xml version="1.0" encoding="utf-8"?>
<s:DefaultGridItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark" 
    xmlns:mx="library://ns.adobe.com/flex/halo"
    implements="spark.components.gridClasses.IGridVisualElement"
    backgroundColor="{data.color}" background="true">

    <fx:Script>
        <![CDATA[

    import spark.components.Grid;

    public function prepareGridVisualElement(grid:Grid, rowIndex:int, columnIndex:int):void
    {
        if (!grid.dataProvider || rowIndex >= grid.dataProvider.length)
            data = null;
        else
            data = grid.dataProvider.getItemAt(rowIndex);
    }

        ]]>
    </fx:Script>
</s:DefaultGridItemRenderer> 
```

在您的应用代码中：

```
<s:DataGrid>
    <s:rowBackground>
        <fx:Component><my:DataGridRowBackground /></fx:Component>
    </s:rowBackground>
</s:DataGrid> 
```

关键元素是 IGridVisualElement 接口，可让您绑定到 dataProvider。该接口由 GridLayout 调用。请参阅： http: [//opensource.adobe.com/svn/opensource/flex/sdk/trunk/frameworks/projects/spark/src/spark/components/gridClasses/GridLayout.as](http://opensource.adobe.com/svn/opensource/flex/sdk/trunk/frameworks/projects/spark/src/spark/components/gridClasses/GridLayout.as)。您可以将任何 IVisualElement 用作背景渲染器，但使用 s:DefaultGridItemRenderer 您可以获得一些开箱即用的功能。

希望这可以帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-24T20:38:57.760

```
dg.setPropertiesAt(3, {backgroundColor:0xFF0000}); 
```

Where dg is your datagrid and the number 3 is the row color of your grid.

# visual-studio - Visual Studio 字体和颜色：需要更多可定制性

> ID：748215
> 
> 赞同：3
> 
> 时间：2009-04-14T15:49:23.217
> 
> 标签：visual-studio, fonts, colors, customization

例如，我希望类字段、方法名称和属性加粗，但我不希望它们在方法主体内加粗。例如，

```
public static void **WriteStuff**(string notEvenUsed) {
    var x = 0;
    Console.WriteLine("Stuff");
} 
```

我希望 WriteStuff 为粗体，但不是 WriteLine、x 或 notEvenUsed。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T16:04:35.490

您可以编写一个 Visual Studio 加载项来执行此操作，但您还有*很多*工作要做——您需要编写自己的 C# 解析器，而不是胆小的任务。

ReSharper 比 vanilla Visual Studio 有更多的颜色编码选项（例如，它会对 notEvenUsed 进行颜色编码以表明它甚至没有被使用），但他们目前没有选项仅将声明加粗。实际上，我已经为此功能编写了[ReSharper 增强请求。](http://www.jetbrains.net/jira/browse/RSRP-98618)随意投票支持该增强功能；也许他们会把它放进去（我们都会很高兴）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T15:51:02.963

我不认为这是可能的。

但是，您可以使用 html 写入文件。它会很简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T15:54:30.553

没有内置的方法可以做你想做的事。我相信[ReSharper](http://www.jetbrains.com/resharper/)允许您进行更高级的颜色自定义，但如果它允许这样的粒度，我会感到惊讶。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T06:21:30.700

[Visual Assist](http://www.wholetomato.com)还允许您进行更多颜色自定义。

# php - ISP 将我的站点移至新服务器后会话丢失

> ID：748219
> 
> 赞同：1
> 
> 时间：2009-04-14T15:50:49.423
> 
> 标签：php, cookies, session

在我的 ISP 将我的站点移动到新服务器后，我遇到了一些会话问题，据说设置相同。这个问题似乎也是特定于浏览器的，我不太明白。

首先，我的站点使用会话登录，自从他们移动站点以来，这已经被破坏了。

我的 ISP 设置了[一个测试页面](http://launchcomplex.com/loggedin_test1.php)。当我在 IE 6 中点击此页面（其中设置了一些会话变量）然后点击“标题重定向”按钮时，会话似乎工作正常。如果我在 Firefox/Opera 中尝试，我会在重定向页面上获得一个新的会话 ID。我的 ISP 报告会话也适用于 IE，尽管我想他们使用的是 IE7 甚至 8。

在我的 ISP 移动它之前，我的网站上的一切都运行良好，虽然他们在响应方面非常有帮助，但他们不知道它为什么会损坏。我的其他几个网站与他们一起被打破了，但他们已经通过服务器调整解决了......有没有人知道发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T15:58:33.600

您正在从“launchcomplex.com”重定向到“www.launchcomplex.com”

如果你设置[`session.cookie_domain`](http://www.php.net/session.cookie_domain)它应该工作 - 见[`session_set_cookie_params()`](http://www.php.net/session_set_cookie_params)

> Cookie 域，例如“www.php.net”。要使 cookie 在所有子域上可见，则域必须以点为前缀，例如“.php.net”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T15:58:15.223

当他们移动服务器时，他们是否迁移到集群配置？这意味着当我访问您的网页时，我是否总是从同一台物理服务器请求内容，或者可能是服务器集群中的任何一个？

如果是后者，那是你的问题。默认情况下，会话是基于文件的，因此不能扩展到多个服务器。

一种解决方案是使用 session_set_save_handler() 来编写您自己的会话管理器。通常，您会使用数据库来使用此方法读取/写入会话数据。

# sql - SQL - 使用 GROUP BY 获取更多数据

> ID：748229
> 
> 赞同：0
> 
> 时间：2009-04-14T15:51:57.580
> 
> 标签：sql

希望有人可以帮助我解决这个问题。

假设我有一个名为 incoming_data 的表，它有 4 列：

```
primary_key_id
serial_number
counter
selected_color 
```

我从填充此表的源获取数据。主键的身份已打开，因此不会重复。我将获得具有不同选定颜色的重复序列号。

来自设备的计数器不断增加。

所以我要做的就是选择我今天收到的所有数据，按序列号对数据进行分组，只获取计数器值最高的记录。

简单的：

```
SELECT      serial_number, MAX(counter)
FROM        incoming_data 
GROUP BY    serial number 
```

这非常有效，除了我想对收到的颜色信息做一些事情。

如果我为选择添加颜色，那么我会得到所有记录，因为我那天收到的所有颜色都是不同的。那是行不通的。

如果我可以获取记录的 primary_key_id，那么我可以只查询颜色，但这也不起作用，因为每个 primary_key_id 值都不同，我都得到了它们。

关于更好的技术来做到这一点的任何建议？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T15:58:46.237

提取相关密钥，然后加入以获得“非密钥”。这适用于 MS SQL Server 和更高版本的 Sybase。

```
SELECT 
    i.serial_number, i.counter, i.selected_color
FROM
   (
   SELECT      serial_number, MAX(counter) AS maxc
   FROM            incoming_data 
   GROUP BY    serial number
   ) max
   JOIN
   incoming_data i ON max.serial_number = i.serial_number AND max.maxc = i.counter 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T15:56:19.190

编辑：处理多个记录具有相同序列号和最大计数器值的情况。这将提取具有最大 primary_key_id 的那些倍数之一

```
 Select * From incoming_data 
    Where primary_key_id In 
       (Select Max(primary_key_id) From incoming_data I
        Where Counter = 
              (Select Max(counter) From incoming_data 
               Where SerialNumber = I.SerialNumber)
        Group By SerialNumber) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T16:01:50.787

嗨，我想这可能会做你想要的？

`SELECT selected_color, serial_number, counter FROM incoming_data GROUP BY serial_number ORDER BY counter DESC LIMIT 1;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T16:08:22.813

如果您不需要查询中的确切颜色，但可以在之后对其进行解析，请尝试以下操作：

```
SELECT      serial_number, MAX(counter), MAX( CONCAT(counter, ':', selected_color) )
FROM            incoming_data 
GROUP BY    serial number 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-17T11:30:12.173

我正在尝试从两个连接的表中获取最大数量。我尝试使用 DISTINCT 来避免重复数字，但失败了。然后我发现了以下查询并且在单个表上工作得很好，但是我没有让它在连接两个表上工作。

如何在我的查询中实现以下查询： select top 10 ConsumptionKWH from PeriodicConsumptions group by ConsumptionKWH order by min(ConsumptionKWH) asc

需要：

" SELECT * FROM " & _ " (SELECT Distinct top 10 " & _ " PeriodicConsumptions.ConsumptionKWH, " & _ " MeterReadings.MeterNo, " & _ " MeterReadings.LastKWH," & _ " MeterReadings.AccountNo, " & _ " MeterReadings .MultiplyFactor," & _ " MeterReadings.LastReading," & _ " MeterReadings.ThisMonthReading," & _ " MeterReadings.NumberofDays," & _ " MeterReadings.ReadingGYear, " & _ " MeterReadings.ReadingGMonth, " &_ " MeterReadings.ReadingDate " & _ " FROM MeterReadings, PeriodicConsumptions" & _ " 其中 MeterReadings.AccountNo = PeriodicConsumptions.AccountNo " & _ " 和 MeterReadings.ReadingGYear =PeriodicConsumptions.ConsumptionYear " & _ " 和 MeterReadings.ReadingGMonth =PeriodicConsumptions.ConsumptionMonth " & _ " 和 MeterReadings.ReadingDate = PeriodicConsumptions.FromDate " & _ " ORDER BY PeriodicConsumptions.ConsumptionKWH desc) as t " & _ " ORDER BY ConsumptionKWH asc"FROM MeterReadings, PeriodicConsumptions" & _ " 其中 MeterReadings.AccountNo = PeriodicConsumptions.AccountNo " & _ " 和 MeterReadings.ReadingGYear =PeriodicConsumptions.ConsumptionYear " & _ " 和 MeterReadings.ReadingGMonth =PeriodicConsumptions.ConsumptionMonth " & _ " 和 MeterReadings.ReadingDate = PeriodicConsumptions .FromDate " & _ " ORDER BY PeriodicConsumptions.ConsumptionKWH desc) as t " & _ " ORDER BY ConsumptionKWH asc"FROM MeterReadings, PeriodicConsumptions" & _ " 其中 MeterReadings.AccountNo = PeriodicConsumptions.AccountNo " & _ " 和 MeterReadings.ReadingGYear =PeriodicConsumptions.ConsumptionYear " & _ " 和 MeterReadings.ReadingGMonth =PeriodicConsumptions.ConsumptionMonth " & _ " 和 MeterReadings.ReadingDate = PeriodicConsumptions .FromDate " & _ " ORDER BY PeriodicConsumptions.ConsumptionKWH desc) as t " & _ " ORDER BY ConsumptionKWH asc"和 MeterReadings.ReadingGYear =PeriodicConsumptions.ConsumptionYear " & _ " 和 MeterReadings.ReadingGMonth =PeriodicConsumptions.ConsumptionMonth " & _ " 和 MeterReadings.ReadingDate = PeriodicConsumptions.FromDate " & _ " ORDER BY PeriodicConsumptions.ConsumptionKWH desc) as t " & _ " ORDER BY ConsumptionKWH asc"和 MeterReadings.ReadingGYear =PeriodicConsumptions.ConsumptionYear " & _ " 和 MeterReadings.ReadingGMonth =PeriodicConsumptions.ConsumptionMonth " & _ " 和 MeterReadings.ReadingDate = PeriodicConsumptions.FromDate " & _ " ORDER BY PeriodicConsumptions.ConsumptionKWH desc) as t " & _ " ORDER BY ConsumptionKWH asc"& _ " ORDER BY ConsumptionKWH asc"& _ " ORDER BY ConsumptionKWH asc"

谢谢

# sql - 防止 Sql 列溢出

> ID：748232
> 
> 赞同：2
> 
> 时间：2009-04-14T15:52:29.153
> 
> 标签：sql, sql-server, database, stored-procedures

如果我有一个参数化存储过程，它采用 varchar(10) 值并将其转换为 int，我目前必须确保该值不大于最大 int 值的 varchar 等效值。

```
IF @Criteria <= '2147483647'
    SET @Id = CONVERT(int, @Criteria) 
```

我的问题：从 varchar 值转换时是否有更好的方法来防止 int 列溢出？

编辑：是的，很明显，如果我觉得一个值将合法地包含接近最大值的东西，我可以扩展到 BigInt。这实际上是为了处理对此存储过程的不正确调用，并且只是在结果值可能溢出所需数据类型的情况下使用 Convert() 的一个通用问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T16:01:26.293

为了处理各种条件（空格、小数等），如果您无法在客户端上清理，请将转换包装在 TRY/CATCH 中。假设 SQL Server 2005

```
...
BEGIN TRY
   SET @Id = CONVERT(int, @Criteria)
END TRY
BEGIN CATCH
   SET @Id = NULL
END CATCH
... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T16:16:59.470

您的测试将无法可靠地工作。

如果@Criteria 包含“11111111111111111111”，则它的排序小于您的幻数，因为您正在进行字符串比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T15:57:07.800

最简单和最好的方法是在源头处理它，也就是创建 varchar 的地方。或者解释一下“防止溢出”是什么意思。当 varchar 实际上太长时，您期望会发生什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T15:57:49.250

如果你通过空格怎么办？- 它将通过 IF 条件但转换失败。您也应该使用 ISNUMERIC ()。

```
IF @Criteria <= '2147483647' AND ISNUMERIC(@Criteria)
        SET @Id = CONVERT(int, @Criteria) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T15:58:51.183

一个更好的问题可能是为什么您将溢出其目标列的整数存储为 varchars。我不太确定你能做些什么来完全防止溢出；您可以考虑将 Id 切换为无符号整数，这样您最多可以获得 2^32 位可用（我猜 Criteria 永远不会是负数，因为您将它分配给 Id 列）。

我不确定 SQL Server 是否支持它，但 MySQL 有 BIGINT 列，最多可达 2^64（如果你想签名，则为 2^63）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T16:44:36.237

首先，您的输入长度 10 看起来您不期望（或接受）负值。int 的下限是 -2147483648，它将由 11 个字符的字符串表示。

基于上面 DJ 的代码，我建议您将 ISNUMERIC() 调用放在 CONVERT/compare 之前。

```
IF ISNUMERIC(@Criteria) = 1
  AND CONVERT(bigint, @Criteria) <=  2147483647
        SET @Id = CONVERT(int, @Criteria) 
```

这首先转换为 bigint，然后进行比较。下面是几个测试用例：

```
DECLARE @Id         int
DECLARE @Criteria   varchar(10)

PRINT 'Expect failure (NULL)'
SET @Criteria = '2147483648'
SET @Id = NULL

IF ISNUMERIC(@Criteria) = 1
  AND CONVERT(bigint, @Criteria) <=  2147483647
        SET @Id = CONVERT(int, @Criteria)

SELECT @Id AS '@Id', @Criteria AS '@Criteria', CONVERT(bigint, @Criteria) AS 'Converted to bigint'

PRINT 'Expect success'
SET @Criteria = '2147483647'
SET @Id = NULL

IF ISNUMERIC(@Criteria) = 1
  AND CONVERT(bigint, @Criteria) <=  2147483647
        SET @Id = CONVERT(int, @Criteria)

SELECT @Id AS '@Id', @Criteria AS '@Criteria', CONVERT(bigint, @Criteria) AS 'Converted to bigint'

PRINT 'Expect failure but get success because @Criteria is truncated to 10 characters'
SET @Criteria = '11111111111111111111'
SET @Id = NULL

IF ISNUMERIC(@Criteria) = 1
  AND CONVERT(bigint, @Criteria) <= 2147483647
        SET @Id = CONVERT(int, @Criteria)

SELECT @Id AS '@Id', @Criteria AS '@Criteria', CONVERT(bigint, @Criteria) AS 'Converted to bigint' 
```

和结果：

```
Expect failure (NULL)
        @Id @Criteria   Converted to bigint
----------- ---------- --------------------
       NULL 2147483648           2147483648

Expect success
        @Id @Criteria   Converted to bigint
----------- ---------- --------------------
 2147483647 2147483647           2147483647

Expect failure but get success because @Criteria is truncated to 10 characters
        @Id @Criteria   Converted to bigint
----------- ---------- --------------------
 1111111111 1111111111           1111111111 
```

请注意，传递 '11111111111111111111' 实际上有效，因为输入被截断。

# arrays - 通过基于 PHP WSDL 的 Web 服务返回一个数组数组

> ID：748236
> 
> 赞同：1
> 
> 时间：2009-04-14T15:54:23.797
> 
> 标签：arrays, web-services, wsdl

我正在努力解决以下问题：

我有一个基于 PHP 的 Web 服务，需要由各种客户端使用。只要我保持简单，一切正常。我认为 Axis2 和 .NET 不喜欢`soapenc:array`中的定义`WSDL`，所以我创建了用于映射对象数组的列表类型：

```
<xsd:complexType name="CourseList">
  <xsd:sequence>
    <xsd:element name="Courses" type="tns:Course" minOccurs="0" maxOccurs="unbounded"/>
  </xsd:sequence>
</xsd:complexType> 
```

现在，如果我包含类似 List of 的内容`CourseLists`（使用相同的 WSDL 过程），.NET 会像 Axis2 (ADB) 处理这些数据一样失败。我用soapUI检查了来自网络的XML；看起来很合理。

我真的在这个绳索上。任何提示将不胜感激。

TIA

```
 KB22 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-11T19:07:34.620

这个问题比罪还要古老，但它从未被回答过，当我最近遇到同样的问题时，我自己也很难找到答案。可能有更好的方法来做到这一点，但我最终做的是这样的。

这实际上更进一步，一个 3-d 数组，但一般原理是相同的。

```
<xs:element name="myOtherArray">
<xs:complexType>
    <xs:sequence>
        <xs:element name="someInsideArrayProperty" type="xs:int"/>
    </xs:sequence>
</xs:complexType> 
```

```
<xs:element name="myArray">
<xs:complexType>
    <xs:sequence>
        <xs:element name="someArrayProperty" type="xs:string"/>
        <xs:element name="yetAnotherArray" maxOccurs="unbounded" type="ns:myOtherArray"/>
    </xs:sequence>
</xs:complexType> 
```

```
<xs:element name="myResponse">
<xs:complexType>
    <xs:sequence>
        <xs:element name="myResponseArray" maxOccurs="unbounded">
            <xs:complexType>
                <xs:sequence>
                    <xs:element name="someProperty" type="xs:int"/>
                    <xs:element name="someOtherProperty" type="xs:string"/>
                    ...
                    <xs:element name="anotherArray" type="ns:myArray" maxOccurs="unbounded"/>
                </xs:sequence>
            </xs:complexType>
        </xs:element>
    </xs:sequence>
</xs:complexType> 
```

# c# - WaitForExit 用于远程计算机上的进程

> ID：748239
> 
> 赞同：5
> 
> 时间：2009-04-14T15:54:34.687
> 
> 标签：c#, process

我正在使用[WMI 在远程机器上启动一个进程](https://stackoverflow.com/questions/677867/run-application-or-process-on-a-remote-computer)。创建进程的调用立即返回，我还获得了远程机器上进程的 ID。

我想等待远程过程完成。一种选择是轮询远程机器上具有给定 id 的进程是否仍然存在。

但是，我想知道是否有更好的方法来实现这一点，也许使用本机 WinAPI 函数？

只是为了获得更多信息，这是我目前用来启动远程进程的代码：

```
ConnectionOptions connOptions = new ConnectionOptions();
connOptions.Impersonation = ImpersonationLevel.Impersonate;
connOptions.EnablePrivileges = true;

connOptions.Username = domainUserName;
connOptions.Password = password;

ManagementScope manScope = new ManagementScope(String.Format(@"\\{0}\ROOT\CIMV2", host), connOptions);
manScope.Connect();

ObjectGetOptions objectGetOptions = new ObjectGetOptions();
ManagementPath managementPath = new ManagementPath("Win32_Process");
ManagementClass processClass = new ManagementClass(manScope, managementPath, objectGetOptions);

ManagementBaseObject inParams = processClass.GetMethodParameters("Create");
inParams["CommandLine"] = commandLine;

ManagementBaseObject outParams = processClass.InvokeMethod("Create", inParams, null); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T18:32:58.020

我不知道这有多有效，您可以使用[ManagementEventWatcher](http://msdn.microsoft.com/en-us/library/system.management.managementeventwatcher.aspx)来观看查询。

这是我在网上找到的东西。

```
WqlEventQuery wQuery = 
 new WqlEventQuery("Select * From __InstanceDeletionEvent Within 1 Where TargetInstance ISA 'Win32_Process'");

using (ManagementEventWatcher wWatcher = new ManagementEventWatcher(scope, wQuery))
{    
  bool stopped = false;

  while (stopped == false)
  {
    using (ManagementBaseObject MBOobj = wWatcher.WaitForNextEvent())
    {
      if (((ManagementBaseObject)MBOobj["TargetInstance"])["ProcessID"].ToString() == ProcID)
      {
        // the process has stopped
        stopped = true;
      }
    }
  }

  wWatcher.Stop();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T16:54:25.247

实现此目的的本机 Win32 方法是`WaitForSingleObject()`对返回的进程句柄执行 a `CreateProcess()`，但是我认为 WMI 不会为您提供此句柄。

[本文](http://www.microsoft.com/technet/scriptcenter/resources/qanda/dec06/hey1208.mspx)提供了另一个您可以考虑的选项 - 它不是轮询进程列表并等待您的进程消失，而是重复查询与您的进程 ID 匹配的进程删除事件：

```
strComputer = "."

Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2:Win32_Process")
objWMIService.Create "notepad.exe", null, null, intProcessID

Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")

Set colMonitoredProcesses = objWMIService.ExecNotificationQuery _
    ("Select * From __InstanceDeletionEvent Within 1 Where TargetInstance ISA 'Win32_Process'")

Do Until i = 1
    Set objLatestProcess = colMonitoredProcesses.NextEvent
    If objLatestProcess.TargetInstance.ProcessID = intProcessID Then
        i = 1
    End If
Loop 
```

* * *

您还可以通过使用`ManagementEventWatcher`对象及其`WaitForNextEvent`方法来改进这一点，以避免必须轮询删除事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T08:35:42.860

如果远程机器上的进程是您的代码，那么您可以在调用机器上打开一个套接字，并在完成后让远程机器“ping”它。

如果您想将此方法用于任何远程进程，您可以在远程计算机上安装一个帮助应用程序/服务来监控您的进程并返回完成的 ping。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-02T10:15:49.967

我还没有机会检查这个，

int pid = (int)managementBaseObject["processId"];

进程 remPrc = Process.GetProcessById(pid, RemoteMachine);

remPrc.WaitForExit();

# jquery - 将 jquery 对象传递给函数

> ID：748240
> 
> 赞同：1
> 
> 时间：2009-04-14T15:54:39.117
> 
> 标签：jquery

你会怎么做这样的事情：

```
somemethod($("#buttonelement"));

function(ele) {
  ele.click(function(event) { alert("hi"); });
} 
```

换句话说，您如何将元素作为 jquery 对象传递并注册单击事件。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-14T15:55:58.100

就这样……？

```
function someMethod(ele) {
    ele.click(function(event) {
        alert("hi");
    });
}

someMethod($("#buttonelement")); 
```

jQuery 对象就像 Javascript 中的任何其他对象一样，可以正常传递给函数。

# .net - DataGridView 绑定到 DataTable。获取枚举的组合框

> ID：748243
> 
> 赞同：2
> 
> 时间：2009-04-14T15:55:48.663
> 
> 标签：.net, winforms, ado.net, datagridview, datatable

如果您有一个`DataTable`具有某种 Enum 类型的列。

然后你将 a 绑定`DataGridView`到这个`DataTable`( `myDgv.DataSource = myDataTable`)..

如何`DataGridView`在此列的每个单元格中使显示成为组合框（或者它是下拉列表？您唯一可以做的就是选择）？组合框应选择当前值，并且可选择其他可能的枚举值。

目前，这些单元格显示为普通的旧可编辑文本单元格，其中包含枚举值的字符串表示形式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T16:09:37.333

我建议您阅读[强制 DataGridView 执行我的投标 - ComboBox hackery 的故事](http://weblogs.asp.net/cfrazier/archive/2005/12/07/432607.aspx)：

> 起初我对 DataGridView 示例（概述）（下载 DataGridView 示例）持乐观态度，但我没有看到任何我想做的事情：获取一个枚举值并使用组合框在网格中表示它。所以，这就是我的做法。

您还应该查看[如何：将对象绑定到 Windows 窗体 DataGridView 控件](http://msdn.microsoft.com/en-us/library/y0wfd4yz.aspx)：

> 下面的代码示例演示如何将对象集合绑定到 DataGridView 控件，以便每个对象显示为单独的行。此示例还说明了如何在 DataGridViewComboBoxColumn 中显示具有枚举类型的属性，以便组合框下拉列表包含枚举值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T16:09:56.617

好吧，我不知道我要说的是否适合这里，但我最近有一个类似的要求：在绑定到 DataSet 的 DataGridView 中显示一个链接，这是

```
protected void grvResultado_RowDataBound(object sender, GridViewRowEventArgs e) {
    if (grvResultado.HeaderRow == null || grvResultado.HeaderRow.Cells.Count == 0) return;
    bool hasLink = false;
    int ind = 0;
    foreach (TableCell c in grvResultado.HeaderRow.Cells) {
        if (c.Text == "link") {
            hasLink = true;
            break;
        }
        ind++;
    }
    if (!hasLink) return;

    if (e.Row.RowType == DataControlRowType.DataRow) {
        TableCell c = e.Row.Cells[ind];
        var lnk = new HyperLink();
        lnk.Text = "Ver";
        lnk.NavigateUrl = c.Text;
        c.Controls.Clear();
        c.Controls.Add(lnk);
    }
} 
```

你可以像我一样适应你需要的东西

# sql-server - 数据库不可知的表/视图导出软件？

> ID：748248
> 
> 赞同：0
> 
> 时间：2009-04-14T15:56:58.783
> 
> 标签：sql-server, database, oracle, components

*试图为我们的常见/基本数据导出任务寻找更优雅/整体的解决方案*

我相信肯定有软件可以让我：

*   从 GUI 定义并保持“设置”（文件格式、分隔符、编码、列名等的定义）
*   按计划/从命令行运行
*   在 Oracle 和 MSSql 上工作

但是，我还没有找到它......任何提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T14:33:13.783

如何使用 groovy 将数据导出到 xml 文件。

请参阅[http://groovy.codehaus.org/Convert+SQL+Result+To+XML](http://groovy.codehaus.org/Convert+SQL+Result+To+XML)

对于 gui 的东西，[Oracle 的 SQL Developer](http://www.oracle.com/technology/products/database/sql_developer/index.html)可以连接到 Oracle、MySQL、SQL Server、MS Access 和 Sybase

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T09:55:49.200

搜索以使用来自[http://sqlmanager.net](http://sqlmanager.net)的产品结束。

他们有满足上述需求的产品，除了有单独的产品，即 MSSQL 和 Oracle

# regex - 如何生成与给定正则表达式匹配的随机字符串？

> ID：748253
> 
> 赞同：20
> 
> 时间：2009-04-14T15:57:23.090
> 
> 标签：regex, parsing, random, reverse

### 复制：

> [匹配正则表达式的随机字符串](https://stackoverflow.com/questions/205411/random-string-that-matches-a-regexp)

不，不是。我正在寻找一种简单通用的方法，一种我可以实际实施的方法。这比随机生成密码要困难得多。

* * *

我想创建一个采用正则表达式的应用程序，并显示与该表达式匹配的 10 个随机生成的字符串。它应该帮助人们更好地理解他们的正则表达式，并决定他们是否足够安全以用于验证目的。有谁知道一个简单的方法来做到这一点？

一个明显的解决方案是编写（或窃取）一个正则表达式解析器，但这似乎真的超出了我的想象。

我再说一遍，我正在寻找一种**简单而通用**的方法来做到这一点。

**编辑：**蛮力方法是不可能的。`[a-z0-9]{10}`假设随机字符串每秒只有100 万次迭代，那么迭代所有 10 字符字符串的空间需要[65 年。](https://www.google.com/search?q=(34%5E10)/(1000000*60*60*24*365)&qscrl=1)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-14T16:00:51.427

将您的正则表达式解析为[DFA](http://en.wikipedia.org/wiki/Deterministic_finite_state_machine)，然后随机遍历您的 DFA 直到您最终处于接受状态，为每个转换输出一个字符。每次遍历都会产生一个与表达式匹配的新字符串。

但是，这不适用于不是真正正则的“正则”表达式，例如带有反向引用的表达式。这取决于你追求什么样的表达方式。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-14T16:04:11.373

看看 Perl 的[String::Random](http://search.cpan.org/dist/String-Random/lib/String/Random.pm)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T18:53:53.647

一种可能实用也可能不实用的相当丑陋的解决方案是利用现有的正则表达式诊断选项。一些正则表达式库能够找出正则表达式未能匹配的位置。在这种情况下，您*可以*使用实际上是一种蛮力形式，但一次使用一个字符并尝试获得更长（和更匹配）的字符串，直到获得完全匹配。这是一个非常丑陋的解决方案。但是，与标准的蛮力解决方案不同，它在 ab 之类的字符串上失败还会告诉您是否存在匹配的字符串 ab.*（如果不存在，请停止并尝试 ac。如果是，请尝试更长的字符串）。这可能不适用于所有正则表达式库。

从好的方面来说，从教学的角度来看，这种解决方案可能非常酷。在实践中，它可能在效果上类似于 dfa 解决方案，但不需要考虑 dfa。

请注意，您不希望在此技术中使用随机字符串。但是，如果您跟踪您在树中测试过的内容，则可以使用随机字符开始，因此效果是相同的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-14T16:03:31.967

如果您的唯一标准是您的方法简单且通用，那么没有什么比蛮力更容易或更通用的了。:)

```
for (i = 0; i < 10; ++i) {
    do {
        var str = generateRandomString();
    } while (!myRegex.match(str));
    myListOfGoodStrings.push(str);
} 
```

当然，这是一种非常愚蠢的做事方式，*主要*是为了开玩笑。

我认为你最好的选择是尝试编写你自己的非常基本的解析器，只教它你期望遇到的东西（例如：字母和数字范围，重复/可选字符......不要担心看起来 -背后等）

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-14T16:10:43.183

普遍性标准是不可能的。给定正则表达式["^To be, or not to be -- 这就是问题：$"](http://www.monologuearchive.com/s/shakespeare_001.html)，不会有十个唯一的随机字符串匹配。

对于非退化情况：

moonshadow 与 Perl 的 String::Random 的链接就是答案。从标准输入读取 RegEx 并将十次 String::Random 调用的输出写入标准输出的 Perl 程序是微不足道的。[使用Perl2exe](http://www.indigostar.com/perl2exe.htm)将其编译为 Windows 或 Unix exe，并从 PHP、Python 或其他任何地方调用它。

另请参阅[基于正则表达式的随机文本生成器](https://stackoverflow.com/questions/274011/random-text-generator-based-on-regex)

# .net - 在 Windows Mobile 上编程 ActiveSync

> ID：748254
> 
> 赞同：3
> 
> 时间：2009-04-14T15:57:41.373
> 
> 标签：.net, windows, windows-mobile, activesync

我正在开发一个管理联系人信息的桌面应用程序，我希望能够使其与 Windows Mobile 设备上的联系人列表同步。我需要了解哪些命名空间/API 才能做到这一点？我更喜欢 .NET 紧凑框架中的一些东西，但我也可以使用 Win32。我正在寻找一种完全独立的方法，即不依赖于单独的应用程序，例如 Outlook。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T18:01:45.660

如果您可以使用最新的紧凑框架，那么您可以使用[WindowsMo​​bile 类库](http://msdn.microsoft.com/en-us/library/bb158492.aspx)。

如果您必须使用旧版本的框架或想要支持旧硬件，您可以使用 Interop访问本机[ActiveSync API 。](http://msdn.microsoft.com/en-us/library/aa457095.aspx)所有[C++ API](http://msdn.microsoft.com/en-us/library/ms839094.aspx)都可以通过 Interop/PInvoke 或 COM Interop 访问。一个例子是[here](http://msdn.microsoft.com/en-us/library/ms180791(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T17:45:54.530

ActiveSync 没有托管 API。ActiveSync SDK 文件夹中有一个名为“stockpor”的示例（默认情况下，它位于 C:\Program Files\Windows CE Tools\wce500\Windows Mobile 5.0 Pocket PC SDK\Activesync\Activesync 股票投资组合示例），它为您提供了一个示例如何进行自定义项目同步。

编辑：第二种选择是在设备端使用[POOM](http://msdn.microsoft.com/en-us/library/aa914277.aspx)，并创建一个您可以与之交互的自定义[​​ RAPI DLL](http://msdn.microsoft.com/en-us/library/aa921197.aspx)（不建议尝试直接打开联系人数据库，因为不能保证记录格式保持不变跨 WinMo 版本）。您必须自己解决冲突等，但以这种方式获取设备上的联系信息可能更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T10:44:26.987

还可以考虑查看[Microsoft SyncFramework](http://msdn.microsoft.com/en-us/sync/default.aspx)。同步是一个比人们意识到的要困难得多的问题，构建一个满足所有边缘情况的解决方案可能非常困难。IIRC 他们甚至有从 Outlook 同步到 Pocket PC 的示例。

如果您决定走 RAPI 路线 OpenNETCF 有一个不错的 RAPI C# 库，请参见[此处](http://www.opennetcf.com/FreeSoftware/DesktopCommunication/tabid/90/Default.aspx)。

# opengl - 是否可以在 opengl 中从 2 个不同的线程渲染 2 个不同的帧缓冲区对象？

> ID：748256
> 
> 赞同：0
> 
> 时间：2009-04-14T15:58:09.327
> 
> 标签：opengl

或者换句话说：不同的帧缓冲对象是不同的opengl上下文吗？

如果是这样，我可以在不同的线程中渲染不同的 FBO，并在它们在屏幕外渲染后将它们传递给将在屏幕上下文中实际绘制它们的主线程。可能吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T16:02:30.097

如果两个 FBO 是在 2 个不同的上下文中创建的，则可以。

但是，在一个窗口中将它们合成到屏幕上需要将它们传回软件，然后再传回窗口上下文中的硬件。这比仅在一个线程的主上下文中渲染它们要慢。

如果要在一个窗口中进行渲染，最好将注意力集中在单个线程中，然后将注意力集中在其他地方的线程上。剔除和物理是线程的好地方（如果有的话），但是对于渲染，每个上下文一个线程是基本的经验法则（每个窗口几乎意味着一个上下文）。

# c# - C# Web 代理中的 SSL；如何确定请求是否为 SLL？

> ID：748258
> 
> 赞同：2
> 
> 时间：2009-04-14T15:58:17.097
> 
> 标签：c#, sockets, ssl, proxy

我从头开始构建了一个网络代理（使用`Socket`和`NetworkStream`类）。我现在正在尝试为它实现 SSL 支持，以便它可以处理 HTTPS 请求和响应。我很清楚我需要做什么（使用`SslStream`），但我不知道如何确定我从客户端获得的请求是否是 SSL。

我已经在这个主题上搜索了几个小时，但一直找不到合适的解决方案。

在我这样做之后：

```
TcpListener pServer = new TcpListener(localIP, port);
pServer.Start(256);
Socket a_socket = pServer.AcceptSocket(); 
```

我如何知道我是否需要使用`SslStream`or来阅读信息`NetworkStream`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T16:14:49.770

此后，客户端将向您发送一个**CONNECT**方法请求，您只需重定向流量即可。

样品连接：

```
CONNECT www.google.com:443 HTTP/1.1 
```

看到这个后，只需切换到数据重定向模式。您无法截获或读取数据，因此无论如何您都不必担心 SSLStream，您不会触摸它。

但是，如果您想要 MITM（中间人），那么您需要切换到 SSL，否则只需**重定向目标**URL 和端口的任何内容，就是这样。

显然，如果您拦截请求，客户端浏览器将弹出 SSL 证书异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T16:15:13.110

您需要添加对 CONNECT 命令的支持。

[http://www.codeproject.com/KB/IP/akashhttpproxy.aspx](http://www.codeproject.com/KB/IP/akashhttpproxy.aspx)

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2009-04-14T16:02:10.143

这就是代理客户端对 HTTP 使用一种代理，而对 HTTPS 使用另一种代理的原因。您无法知道您将收到哪种类型的连接。

# sharepoint - 正确的 stsadm 命令来更新 SharePoint 解决方案/功能

> ID：748261
> 
> 赞同：6
> 
> 时间：2009-04-14T15:58:47.313
> 
> 标签：sharepoint, solution, stsadm, feature-upgrade

依次强制升级到 SharePoint 解决方案的正确 stsadm 命令是什么。我努力了

> C:>"C:\Program Files\Common Files\Microsoft Shared\web server extensions\12\BIN\stsadm.exe" -o deploysolution -name "MySolution.wsp" -immediate -allcontenturls -allowGacDeployment -allowCasPolicies -force

其次是

> C:>"C:\Program Files\Common Files\Microsoft Shared\web server extensions\12\BIN\stsadm.exe" -o execadmsvcjobs

它似乎已部署并将解决方案显示为在我推送这些命令时具有部署时间，但我的文件似乎没有得到更新并且新文件也没有出现。

我错过了什么吗？处理这些命令后是否需要执行**IISReset /noforce 。**

谢谢，乔什·刘易斯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-14T18:07:18.720

正确的方法是使用 -o upgradesolution 命令。在大多数情况下，无需撤回和删除解决方案并重新安装。请务必像往常一样使用 -o execadmsvcjobs 进行跟进。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T16:15:42.483

```
stsadm -o retractsolution -name ... -immediate -allcontenturls
stsadm -o execadmsvcjobs
stsadm -o deletesolution -name ...
stsadm -o addsolution -filename ... 
stsadm -o deploysolution -name ... -immediate -allcontenturls -allowgacdeployment -allowcaspolicies
stsadm -o execadmsvcjobs 
```

几个警告：

有时您必须首先停用该功能 (stsadm -o deactivatefeature)。当我将包含列表模板的站点功能更改为 Web 功能时，我最终在创建页面上出现了双链接。所以我不得不再次安装旧功能，停用它，然后重新安装新功能。

如果您不确定自己在做什么，请不要使用 -force。如果您将它与 -o deletesolution 命令一起使用，您最终可能会在部分或全部服务器上使用旧版本的文件。此类问题可能很难追踪，并且会给您带来很多额外的工作，尤其是在您有多个前端服务器的情况下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T20:34:06.113

1.  幻影文件不会得到更新。

2.  stsadm -o execadmsvcjobs 将处理任何作业，即处理延迟

3.  重新激活功能，包含内容的功能（下一次；使用功能装订！）

4.  升级解决方案不会总是自动安装新功能（是的，安装，不激活）。检查这个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T16:16:35.977

IISRESET 也可能值得，但您可以尝试运行“SharePoint 产品和技术配置向导”，AKA PSCONFIG.EXE

位于 C:\Program Files\Common Files\microsoft shared\Web Server Extensions\12\BIN

它将同步数据库、IIS 和二进制文件上的信息。应用 Service Pack 时需要运行它。

还要确保场中的所有服务器都可以访问管理中心，并且您在所有服务器上都运行了 PSCONFIG。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-26T09:20:25.277

我认为因为您在 deploysolution 命令中提供了 -force 参数，您实际上是在抑制可能显示的错误消息 - 沿着解决方案已经存在的行。如前所述，要么做retract->deploy 要么升级（取决于你的场景）。

# sharepoint-2007 - CAML 仅显示 Sharepoint 2007 中的站点

> ID：748263
> 
> 赞同：2
> 
> 时间：2009-04-14T15:59:00.853
> 
> 标签：sharepoint-2007, caml

我只需要查看在内容和结构报告 Web 部件中定义 CAML 结构视图的可用站点。

我尝试使用 Stramit Caml Viewer 和 U2U Caml Query Builder 2007，但它们似乎不支持我不想显示的对象（站点和子站点）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T10:51:05.073

如果您只想查看，那么您不能使用 Power shell 吗？

看看这个使用 powershell 脚本从 Web 应用程序获取数据的链接。

[https://sharepoint.stackexchange.com/questions/47536/best-way-to-get-all-subsites](https://sharepoint.stackexchange.com/questions/47536/best-way-to-get-all-subsites)

# c# - 将树结构数据转换为 XML——性能问题

> ID：748271
> 
> 赞同：2
> 
> 时间：2009-04-14T16:01:13.470
> 
> 标签：c#, xml, tree

我有一组树结构的数据。目前我将这些数据保存到二进制文件中。缺点是这些数据的排序、过滤非常困难。不仅如此，当数据量很大时，从硬盘读取到内存的速度很慢。

所以我正在考虑将这些树状数据保存到 XML 文件中。我想要这个的原因是因为

1.  XML 已内置用于过滤和数据操作的库
2.  社区很好地支持 XML 操作，而现在我必须支持我自己的数据结构操作

鉴于.Net 对 XML 的支持，我想知道从 XML 查询数据是否比从二进制文件查询数据更快（在加载速度方面）？我进行转换有什么好处吗？我很确定，就编程工作而言，XML 胜过我自己的树数据结构，但是加载速度呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T16:04:06.833

根据经验：您不会发现 XML 是管理数据的最小或最快的方法。

您的描述没有给出足够的细节来确定，但也许关系数据库会是更好的方法。将树结构映射到关系模型通常并不困难。（反过来说就是另一回事了……）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T16:06:00.463

数据大小可能会大于您当前的树大小，因为 XML 是文本，因此所有数据都必须序列化为文本表示。因此加载可能会或可能不会更慢，这也取决于您当前的加载实现。

至于其余的，如果做得好，查询和修改数据非常简单且相当有效，但由于文本性质，它通常不能超过做得好的二进制实现。

如果您需要转换您的树数据（用于显示等），XML 非常棒 - 使用[XSL 转换](http://en.wikipedia.org/wiki/XSL_Transformations)允许您创建几乎任何 XML、HTML 或数据的文本表示，而几乎不需要编程（因此也需要测试和调试）工作.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T16:39:01.867

从性能的角度来看，XML 几乎肯定会在与二进制结构的竞争中输掉。但是，从开发和技术的角度来看，您认为 XML 会胜出是完全正确的。

我完全同意@Dan 的说法。随着数据大小的增加，XML 数据结构的性能呈指数级下降。它的使用如此普遍，因为大多数应用程序不处理通常存储在数据库中或序列化为二进制数据的大量数据。

# ms-access - 使用 Access 2007 VBA 创建数据透视图

> ID：748274
> 
> 赞同：5
> 
> 时间：2009-04-14T16:01:43.187
> 
> 标签：ms-access, charts, vba, pivot

好的，互联网上绝对没有好的文章可以解释或有关于如何使用 VBA 创建数据透视图的代码示例。我需要这个，因为我需要数据透视图根据表单中的用户选择显示不同的结果。Excel 有一些，但 Access 的语法不同。我知道这是一个蹩脚的问题，但如果有人有如何在 VBA 中创建数据透视图的示例，我将非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T11:37:53.127

经过大约 3 天的搜索，我想我找到了它。没有人真正关心，这只有 6 个视图，这说明了 VBA 的完全可怕性。无论如何，MSDN 将其隐藏在“Office XP”下而不是 Access 下，但无论如何。

[http://msdn.microsoft.com/en-us/library/aa662945.aspx#](http://msdn.microsoft.com/en-us/library/aa662945.aspx#)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-11T00:38:44.750

我在 Access 2007 中创建了一个数据透视图表单。在另一个表单上，我有用户选择控件和数据透视表作为子表单。然后我在主窗体中使用这样的代码。对象模型与 OWC11（Office Web Components 11）相同。

```
Private Function DisplayChart()

  With mysubform.Form.ChartSpace
    .Clear
    .AllowFiltering = True
    .HasChartSpaceTitle = True
    .ChartSpaceTitle.Caption = "test"
    .DisplayFieldButtons = False
    .DisplayToolbar = False

    .ConnectionString = ...
    .CommandText = "SELECT rSeries, rCategory, rDate, rValue " & _
        "FROM myTable"

    .Charts(0).Type = chChartTypePie

    .SetData chDimSeriesNames, chDataBound, "rSeries"
    .SetData chDimCategories, chDataBound, "rCategory"
    .SetData chDimValues, chDataBound, "rValue"

    .HasChartSpaceLegend = True

  End With

End Function 
```

常量可以从 OWC11 导出

C:\Program Files\Common Files\Microsoft Shared\Web Components\11\OWC11.DLL

您需要它们位于模块的顶部。在这个阶段，我不确定如何从 Access 数据透视图中提取它们。引用 OWC11 并将子窗体 ChartSpace 设置为声明为 OWC11.ChartSpace 的变量。编写代码后更改为“对象”类型，并删除后期绑定的引用（并重新测试）。这样，当您部署时，您的 refs 就不会卡在 64 位机器上。

```
Private Enum ChartConstants
  chDimSeriesNames = 0
  chDimCategories = 1
  chDimValues = 2
  chDataBound = 0
  chAxisPositionValue = -8
  chAxisPositionCategory = -7
  chChartTypePie = 18
End Enum 
```

请记住，您还可以让用户访问数据透视图属性表单、字段列表和拖放区。或者他们可以右键单击图表以找到它们。

（注意 - 这对我来说仍然是一个新发现，所以如果我发现任何问题，我会努力更新这个答案。）

# mysql - 使用 SQL 确定文本字段的字数统计

> ID：748276
> 
> 赞同：22
> 
> 时间：2009-04-14T16:01:55.357
> 
> 标签：mysql, sql, text-processing, word-count

我最近一直在研究一些数据库搜索功能，并希望获得一些信息，例如每个文档的平均单词（例如数据库中的文本字段）。到目前为止，我发现的唯一一件事（没有在数据库之外使用选择的语言进行处理）是：

```
SELECT AVG(LENGTH(content) - LENGTH(REPLACE(content, ' ', '')) + 1)
FROM documents 
```

这似乎可行*，但您还有其他建议吗？我目前正在使用 MySQL 4（希望尽快为这个应用程序迁移到版本 5），但我也对通用解决方案感兴趣。

谢谢！

* 我可以想象这是一种非常粗略的确定方法，因为它也不考虑内容中的 HTML 等。这对于这个特定项目来说没问题，但还有更好的方法吗？

**更新：**定义我所说的“更好”：更准确，执行更有效，或者更“正确”（易于维护，良好实践等）。对于我现有的内容，上面的查询速度足够快，并且对于这个项目来说是准确的，但我将来可能需要类似的东西（所以我问了）。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-04-15T23:30:35.580

MySQL 的文本处理能力不足以满足您的需求。存储函数是一种选择，但可能会很慢。在 MySQL 中处理数据的最佳选择是添加一个[用户定义的函数](https://dev.mysql.com/doc/extending-mysql/5.7/en/adding-loadable-function.html)。如果你无论如何要构建一个更新版本的 MySQL，你也可以添加一个[native function](https://dev.mysql.com/doc/extending-mysql/5.7/en/adding-native-function.html)。

“正确”的方法是处理数据库之外的数据，因为数据库是用于存储而不是处理的，任何繁重的处理都可能会给 DBMS 带来过多的负担。此外，在 MySQL 之外计算字数可以更轻松地更改对单词的定义。如何将字数存储在数据库中并在文档更改时更新它？

示例存储函数：

```
DELIMITER $$
CREATE FUNCTION wordcount(str LONGTEXT)
       RETURNS INT
       DETERMINISTIC
       SQL SECURITY INVOKER
       NO SQL
  BEGIN
    DECLARE wordCnt, idx, maxIdx INT DEFAULT 0;
    DECLARE currChar, prevChar BOOL DEFAULT 0;
    SET maxIdx=char_length(str);
    SET idx = 1;
    WHILE idx <= maxIdx DO
        SET currChar=SUBSTRING(str, idx, 1) RLIKE '[[:alnum:]]';
        IF NOT prevChar AND currChar THEN
            SET wordCnt=wordCnt+1;
        END IF;
        SET prevChar=currChar;
        SET idx=idx+1;
    END WHILE;
    RETURN wordCnt;
  END
$$
DELIMITER ; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-08-13T20:02:05.727

这要快得多，尽管准确度略低。我发现它的计数只有 4%，这对于“估计”场景来说是可以的。

```
SELECT
    ROUND (   
        (
            CHAR_LENGTH(content) - CHAR_LENGTH(REPLACE (content, " ", "")) 
        ) 
        / CHAR_LENGTH(" ")        
    ) AS count    
FROM documents 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-31T21:18:47.110

您可以使用来自[https://github.com/spachev/mysql_udf_bundle](https://github.com/spachev/mysql_udf_bundle)`word_count()`的UDF 。我从接受的答案中移植了逻辑，不同之处在于我的代码仅支持 latin1 字符集。需要重新设计逻辑以支持其他字符集。此外，两种实现都始终将非字母数字字符视为分隔符，这可能并不总是可取的 - 例如，两种实现都将“教师用书”视为三个单词。

当然，UDF 版本要快得多。为了进行快速测试，我在 Project Guttenberg 的数据集上进行了尝试，该数据集包含 9751 条记录，总计约 3 GB。UDF 在 18 秒内完成了所有这些，而存储函数只用了 63 秒来处理 30 条记录（UDF 在 0.05 秒内完成）。所以在这种情况下，UDF 大约快 1000 倍。

UDF 将在速度上击败任何其他不涉及修改 MySQL 源代码的方法。这是因为它可以访问内存中的字符串字节，并且可以直接对字节进行操作，而无需移动它们。它也被编译成机器代码并直接在 CPU 上运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-17T18:43:01.913

一些类似情况的简单解决方案（MySQL）：

SELECT *, (CHAR_LENGTH(student)-CHAR_LENGTH(REPLACE(student,' ','')))+1 as 'count'
FROM files;

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-15T09:57:59.803

好吧，我尝试使用上面定义的函数，它很棒，除了一种情况。

在英语中，您经常使用 ' 作为单词的一部分。至少对我来说，上面的函数将“没有”计为 2。

所以这是我的小修正：

```
DELIMITER $$
CREATE FUNCTION wordcount(str TEXT)
            RETURNS INT
            DETERMINISTIC
            SQL SECURITY INVOKER
            NO SQL
       BEGIN
         DECLARE wordCnt, idx, maxIdx INT DEFAULT 0;
         DECLARE currChar, prevChar BOOL DEFAULT 0;
         SET maxIdx=CHAR_LENGTH(str);
         WHILE idx < maxIdx DO
             SET currChar=SUBSTRING(str, idx, 1) RLIKE '[[:alnum:]]' OR SUBSTRING(str, idx, 1) RLIKE "'";
             IF NOT prevChar AND currChar THEN
                 SET wordCnt=wordCnt+1;
             END IF;
             SET prevChar=currChar;
             SET idx=idx+1;
         END WHILE;
         RETURN wordCnt;
       END
     $$ 
```

# iphone - 如何使用 iPhone SDK 清除圆角矩形外的角？

> ID：748282
> 
> 赞同：3
> 
> 时间：2009-04-14T16:03:12.153
> 
> 标签：iphone, drawing, core-graphics

我正在尝试实现自定义视图。此视图应显示由灰色圆形矩形边框包围的图像。我可以让图像和边框正常显示，但是，由于边框有圆角，我需要一种方法来清除这些角，以便它们正确显示视图后面的任何内容。我怎样才能做到这一点？

似乎我可以使用`CGContextClearRect`，但是我不必多次调用它，重建圆角之外的区域吗？这听起来过于复杂。

有没有更好的方法来创建这个视图？

这是我当前的代码：

```
- (void)drawRect:(CGRect)rect
{
    CGContextRef context = UIGraphicsGetCurrentContext();

    // Draw the image. This will completely fill the current rect.
    [image drawInRect:self.bounds];

    // Ensure we draw completely within our bounds instead of straddling it.
    CGRect rrect = self.bounds;
    rrect.size.height = rrect.size.height - 1.0;
    rrect.size.width = rrect.size.width - 1.0;
    rrect.origin.x = rrect.origin.x + (1.0 / 2);
    rrect.origin.y = rrect.origin.y + (1.0 / 2);

    CGFloat radius = 5.0;
    CGFloat minx = CGRectGetMinX(rrect);
    CGFloat midx = CGRectGetMidX(rrect);
    CGFloat maxx = CGRectGetMaxX(rrect);
    CGFloat miny = CGRectGetMinY(rrect);
    CGFloat midy = CGRectGetMidY(rrect);
    CGFloat maxy = CGRectGetMaxY(rrect);

    // Draw the rounded rect border.
    CGContextSetRGBStrokeColor(context, 0.6, 0.6, 0.6, 1.0);
    CGContextSetRGBFillColor(context, 1.0, 1.0, 1.0, 0.0);
    CGContextSetLineWidth(context, 1.0);
    CGContextMoveToPoint(context, minx, midy);
    CGContextAddArcToPoint(context, minx, miny, midx, miny, radius);
    CGContextAddArcToPoint(context, maxx, miny, maxx, midy, radius);
    CGContextAddArcToPoint(context, maxx, maxy, midx, maxy, radius);
    CGContextAddArcToPoint(context, minx, maxy, minx, midy, radius);
    CGContextClosePath(context);
    CGContextDrawPath(context, kCGPathFillStroke);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-14T16:38:19.903

在绘制图像之前将圆角矩形路径添加到剪切路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-06T09:53:14.833

上周我试图做类似的事情。

对于您的问题、答案和其他问答，我创建了一个带有解决方案的示例。

[https://github.com/GabrielMassana/TransparentRoudRectButton](https://github.com/GabrielMassana/TransparentRoudRectButton)

![在此处输入图像描述](https://i.stack.imgur.com/vUgSx.jpg)

# asp.net - 在某些情况下如何覆盖/更改 FormsAuthentication LoginUrl

> ID：748287
> 
> 赞同：17
> 
> 时间：2009-04-14T16:03:41.827
> 
> 标签：asp.net, .net, forms-authentication

有没有办法动态更改 FormsAuthentication 的 LoginUrl？我拥有的是受 FormsAuth 保护的整个站点，但是对于子文件夹中的某些页面，我想将用户带到不同的登录页面，并让 FormsAuth 处理 ReturnUrl 的东西。这是可能的还是我必须为子文件夹案例编写自己的重定向代码？

这是一个示例布局：

```
 ~/LogOn1.aspx
   ~/Protected1.aspx
   ~/Protected2.aspx
   ~/Subfolder/
   ~/Subfolder/LogOn2.aspx
   ~/Subfolder/NotProtected.aspx
   ~/Subfolder/Protected3.aspx 
```

所以我的 web.config 看起来像：

```
 <forms loginUrl="~/Splash.aspx" ... /> 
```

所有受保护的 *.aspx 页面都有

```
 <deny users="?"> 
```

不过，如果用户是匿名的，我想要的是 ~/Subfolder/Protected3.aspx 被重定向到 ~/Subfolder/LogOn2.aspx。

我确实尝试在 ~/Subfolder/web.config 中放置一个精简版的 web.config：

```
<?xml version="1.0"?>
<configuration>
   <system.web>
      <authentication mode="Forms">
         <forms loginUrl="~/Subfolder/LogOn.aspx" name="SiteAuth" protection="All" timeout="30" path="/" defaultUrl="~/Subfolder/default.aspx" requireSSL="true" cookieless="UseCookies" enableCrossAppRedirects="false" />
      </authentication>
      <authorization>
         <deny users="?" />
      </authorization>
   </system.web>
</configuration> 
```

但我得到的只是这个错误：

> 在应用程序级别之外使用注册为 allowDefinition='MachineToApplication' 的部分是错误的。此错误可能是由未在 IIS 中配置为应用程序的虚拟目录引起的。

我认为此时将子文件夹目录设为应用程序会导致更多问题，但也许我错了。如果它是一个应用程序，那不会将 ~/Subfolder 中的所有代码与父应用程序的其余部分分开吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-14T20:33:34.347

您遇到的问题是[Forms 元素](http://msdn.microsoft.com/en-us/library/1d3t3c61.aspx)只允许在应用程序级别 - 您不能在 sub-web.config 中定义它。

不幸的是，您也不能使用[Location 元素](http://msdn.microsoft.com/en-us/library/b6x6shw7.aspx)定义它，并且[FormsAuthentication.LoginUrl](http://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.loginurl.aspx)属性是只读的。

寻找了一下，看起来你最好的选择是在你的登录页面上有一些代码来检测用户来自哪里（即通过检查“ReturnUrl”查询字符串的值）并重定向到你的另一个登录页面如果它们来自子目录。但是我承认，如果您想要多个子目录的自定义登录页面，这根本不能很好地扩展。:(

* * *

响应您的编辑-是的，将子文件夹设为应用程序将“解决”此错误，但正如您所指出的，您会遇到更多问题，因为您需要移动所有相关的二进制文件 app_code，你在那个子文件夹中还有什么，所以这不是一个真正的解决方案。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-19T22:07:01.383

我也遇到了这个问题，刚刚在这里用谷歌搜索试图解决它，然后记得很久以前就做过了，我所做的是在 Page_Load 事件的根文件夹中的默认 login.aspx 页面中，我根据返回 url 进行了重定向到我的子目录管理及其 login.aspx 页面！您必须为每个子目录重复相关位。

```
public void Page_Load(object sender, EventArgs e)
{
 //check for existence of ReturnUrl in QueryString       
    //if it contains manage redirect to manage login page
    if (!String.IsNullOrEmpty(Request.QueryString["ReturnUrl"]))
    {
        if (Request.QueryString["ReturnUrl"].Contains("manage"))
        {
            Response.Redirect("manage/login.aspx");

        }
    } 
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-14T18:13:02.623

每个子文件夹都允许您拥有一个单独的 webconfig 文件。因此，您可以将 web.config 与标签放在子文件夹中：

```
<authentication mode="Forms">
    <forms loginUrl="~/Subfolder/LogOn2.aspx" />
</authentication> 
```

# php - PHP：得到一个“使用未定义的常量 COOKIE_LOGIN”我该如何解决这个问题？

> ID：748289
> 
> 赞同：0
> 
> 时间：2009-04-14T16:03:50.373
> 
> 标签：php, cookies

我没有对影响 COOKIE 的代码进行任何更改，现在我得到以下信息：

使用未定义的常量 COOKIE_LOGIN - 假定为“COOKIE_LOGIN”

```
//Destroy Cookie
if (isset($_COOKIE[COOKIE_LOGIN]) && !empty($_COOKIE[COOKIE_LOGIN]))
    setcookie(COOKIE_LOGIN,$objUserSerialized,time() - 86400 ); 
```

我不确定我需要做什么才能真正改变这一点，因为我不知道从什么开始，因此无法跟踪问题。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-14T16:05:37.017

您需要用引号将数组键括起来：

```
if (isset($_COOKIE['COOKIE_LOGIN']) && !empty($_COOKIE['COOKIE_LOGIN']))
    setcookie('COOKIE_LOGIN',$objUserSerialized,time() - 86400 ); 
```

PHP 将未知文字转换为字符串并引发警告。您的 php.ini 可能具有不显示警告的错误报告级别，但有人可能已对其进行了更新或其他内容。无论哪种情况，在这种情况下利用 PHP 的行为都是不好的做法。

有关更多信息，请查看[php 文档](http://us.php.net/types.array)：

> 始终在字符串文字数组索引周围使用引号。例如，$foo['bar'] 是正确的，而 $foo[bar] 不是。
> 
> 这是错误的，但它有效。原因是这段代码有一个未定义的常量（bar）而不是字符串（'bar' - 注意引号）。PHP 将来可能会定义常量，不幸的是，对于此类代码，这些常量具有相同的名称。它之所以起作用，是因为 PHP 会自动将一个裸字符串（一个不与任何已知符号对应的未加引号的字符串）转换为包含该裸字符串的字符串。例如，如果没有定义名为 bar 的常量，那么 PHP 将替换字符串 'bar' 并使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T16:08:11.427

除非是您定义的实际常量，否则您不能说`$_COOKIE[COOKIE_LOGIN]`没有错误，例如：`COOKIE_LOGIN`

```
define("COOKIE_LOGIN", 5); 
```

有些人有编写代码的习惯，例如：

```
$ary[example] = 5;
echo $ary[example]; 
```

假设“example”（作为字符串）将是数组键。如果您禁用错误报告，PHP 过去会原谅这种行为。但是，这是错误的。`$_COOKIE["COOKIE_LOGIN"]`除非您已明确定义`COOKIE_LOGIN`为常量，否则您应该使用。

# schema - 具有任意顺序的子元素的架构元素定义

> ID：748307
> 
> 赞同：0
> 
> 时间：2009-04-14T16:06:57.747
> 
> 标签：schema, xsd

我正在尝试在模式中创建一个元素，其中它的子类型可以按任何顺序出现，并且可以根据需要多次出现：

```
 <xs:element name="workflowNodes">
    <xs:complexType>
        <xs:sequence minOccurs="0" maxPO>
            <xs:element ref="nodeType1" />
            <xs:element ref="nodeType2" />
            <xs:element ref="nodeType3" />
            <xs:element ref="nodeType4" />
        </xs:sequence>
    </xs:complexType>
</xs:element> 
```

其中节点 nodeType(n) 可以按任何顺序排列，并且可以根据需要重复。

另外，我试过：

但是当没有 nodeType1 时，编译器无法正常工作，抱怨 nodeType2 无效。

我在这里想念什么？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T16:10:53.510

你应该能够通过这样做得到你的结果：

```
<xs:element name="workflowNodes">
        <xs:complexType>
                <xs:choice minOccurs="0" maxOccurs="unbounded">
                        <xs:element ref="nodeType1" />
                        <xs:element ref="nodeType2" />
                        <xs:element ref="nodeType3" />
                        <xs:element ref="nodeType4" />
                </xs:choice>
        </xs:complexType>
</xs:element> 
```

<xs:choice> 让您可以选择其中一个元素，并且让 xs:choice 出现多次可以让您随意选择每个元素。

马克

# javascript - Javascript - 获取放入 HTA 的文件路径

> ID：748308
> 
> 赞同：2
> 
> 时间：2009-04-14T16:07:11.707
> 
> 标签：javascript, vbscript, drag-and-drop, hta

我正在构建一个供个人使用的小 HTA，并且希望能够将文件拖放到界面中。一旦文件被删除，我要么自动运行它（假设它符合我设置的一些参数，比如文件扩展名），要么至少填写 HTA 界面上的输入框。

我已经广泛搜索，但找不到解决方案。想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T20:38:02.533

Tomalak，在他的声明中是不正确的......除了你必须在注册表中为 HTA 文件添加 DropHandler 之外，你可以做你想做的事，这很容易做到，一旦完成，你就可以做你想做的事去做。我找不到太多关于它的文档，但这是一个很久以前由一个名叫 Michel Gallant 的人编写的 HTA 的链接，它向您展示了如何使用它：[https ://www.jensign.com/www /wsh/成像器/](http://www.jensign.com/JavaScience/www/wsh/imager/index.html)

当 HTA 启动时，它会查看您是否已经配置了 DropHandler。如果您不这样做，它会为您提供为您配置它的选项。配置完成后，您只需关闭并重新打开 HTA 和 wallah，即可在 HTA 文件中提供拖放支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-16T17:11:23.667

如果您不想启用 drop 处理程序，我可以想象一种可能的方式。这有点像喜剧连锁店，但如果我被逼到角落并需要该功能，我可以看到自己实现了这一点。

您可以创建一个 IFRAME，它的 src 作为某个临时文件夹。此文件夹将显示为资源管理器视图。然后，您可以将文件拖入其中。针对该文件夹设置轮询例程以查看是否有任何新文件。瞧，你有一种蹩脚的方式来支持给定文件的拖放操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-11T07:08:11.757

去尝试提供拖放的谷歌齿轮。

你甚至可以在 hta 中使用 mysql。

Google Gears 在 hta 中不可用，但是，您可以在 html 文件中创建 activexobject，然后使用`iframe(<iframe application="true" src=".."></iframe>)`

之后，您可以`activexobject`通过`iframe`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-31T21:26:18.380

关于 …

> “**希望能够将文件拖放到[HTA]界面**”

…我将其解释为希望将文件拖放到 HTA 的运行窗口，而不是将文件拖放到 HTA 文件本身或其快捷方式上。

使用 HTML5，丢弃本身很容易。使用例如`<div>`元素作为放置区域。为此元素处理事件`dragenter`和。例如，drop 处理程序可能如下所示：`dragover``drop`

```
function on_drop( e )
{
    e.preventDefault();  // stops the browser from redirecting off to the file
    var dt = e.dataTransfer

    var is_file_transfer = false;
    for( var i = 0; i < dt.types.length; ++i )
    {
        if( dt.types[i].toLowerCase() == 'files' )
        {
            is_file_transfer = true;
        }
    }
    if( !is_file_transfer )
    {
        return false;
    }
    on_files_dropped( dt.files );
    return true;
} 
```

...`on_files_dropped`您定义的处理文件删除的函数在哪里。

在文档加载事件中动态添加事件处理程序，如下所示：

```
var dropbox = document.getElementById( 'blah' );
dropbox.addEventListener( 'dragenter', on_dragenter, false );
dropbox.addEventListener( 'dragover', on_dragover, false );
dropbox.addEventListener( 'drop', on_drop, false ); 
```

到现在为止还挺好。

但是，安全性有一个限制：*您无法直接了解原始文件路径*，只能了解文件名和文件大小。因为此功能是为 Web 设计的，而不是为本地受信任的 HTML 应用程序设计的。所以它可能是也可能不是问题。

*   为了将拖放的文件用作 HTML 元素的*源*，并且通常用于读取拖放的文件，HTML5 提供了一个**`FileReader`**（有许多可用的[教程](http://www.html5rocks.com/en/tutorials/file/dndfiles/)，它们进一步链接到技术文档）。

*   如果需要本地路径，例如在 Windows Mediaplayer 中播放文件，您可以*假设*拖动操作源自 Windows 资源管理器，现在也称为文件资源管理器，然后只需检查哪个资源管理器窗口（如果有）包含具有该文件的文件名称和大小。

希望不会找到超过一个这样的原始窗口。

```
var shell   = new ActiveXObject( "Shell.Application" );
var fso     = new ActiveXObject( "Scripting.FileSystemObject" );

function possible_paths_for( filename )
{
    var windows     = shell.windows();      // Windows Explorer windows.
    var n_windows   = windows.Count;

    var lowercase_filename = filename.toLowerCase();
    var paths = Array();
    for( var i = 0; i < n_windows; ++i )
    {
        var url     = windows.Item(i).LocationURL;
        var path    = decodeURI( url.substr( 8 ) ).replace( /\//g, '\\' );
        // The path can be the path of this HTML application (.hta file), so:
        if( fso.FolderExists( path ) )
        {
            var folder  = fso.GetFolder( path );
            for( var it = new Enumerator( folder.Files ); !it.atEnd(); it.moveNext() )
            {
                var file = it.item();
                if( file.Name.toLowerCase() == lowercase_filename )
                {
                    paths.push( file.Path.toLowerCase() );
                }
            }
        }
    }
    return paths;
} 
```

基本上就是这样。除了，也许，因为 HTA 默认为 IE7，如何获得 HTML5 功能。可以通过 doctype 声明，但到目前为止，在我的小实验中，我只使用以下内容：

```
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <!-- A windows web control defaults to quirky IE7 semantics. Request for better: -->
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="MSThemeCompatible" content="yes"> 
```

这为您提供了最新的 Internet Explorer 引擎，但代价是没有`HTA`元素，因此无法直接访问命令行。我发现[可以通过运行 Windows 的`wmic`程序](http://pastebin.com/4LpGGkXZ)来检索命令行，但这是一个可怕的 hack。这整个问题区域，大多数显然开放的道路最终被关闭，似乎是微软现在将 HTA 视为[一种*遗留技术*的结果，将悄悄地逐步淘汰，转而支持全屏广告的 Windows 8 AppStore 应用程序](https://connect.microsoft.com/IE/feedback/details/785055/hta-application-tag-does-not-work-in-ie10)。

无论如何，祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-10T13:18:45.087

**我可以确认可以使用“ Web 浏览器**”在 HTA 窗口中获得文件和文件夹的拖放功能（无需使用任何第三方 ActiveX 对象、HTML5 或注册表操作）。

它的“RegisterAsDropTarget”参数打开允许这样的操作，而“Web 浏览器”本身是内置在自 XP 或 2000 以来的每个 Windows 中默认情况下。这样，它适用于以任何语言环境命名的输入文件（Unicode 名称支持），而例如，WScript 和 CScript 默认情况下不支持此功能。

下面是一个作为独立组件实现的示例，具有许多自定义功能，包括样式和背景。它适用于 64 位和 32 位文件夹路径，并且可以插入到特定窗口的 DOM 树中。

将下面的源代码另存为文本文件，然后将其扩展名更改为“hta”。然后通过双击启动获得的应用程序。

```
<script>
/*
Extended Drop Target v1.1.4 (https://tastyscriptsforfree.wix.com/page/scripts)
Copyright 2017-2020 Vladimir Samarets. All rights reserved.
tastyscriptsforfree@protonmail.com

Release date: November 9, 2020.

Use this script sample entirely at your own risk.
This script sample is copyrighted freeware and I am not responsible for any damage or data loss it could unintentionally cause.
You may modify it but please leave a comment with direct link to https://tastyscriptsforfree.wix.com/page/scripts in that case.
*/

offscreenBuffering = true;                                                                                       //postpone the application window appearance till its UI is ready
var O = function(o){return new ActiveXObject(o);},
WSS = O('WScript.Shell'),
env = WSS.Environment('Process'),
head = document.documentElement.firstChild,                                                      //head
PID;                                                                                                                         //PID of 64 bit HTA instance

if(!env('is64bit'))                                                                                                      //indicates whether the application is launched as 64 bit or not
{
    !function hide(e){try{moveTo(10000, 10000);}catch(e){try{hide();}catch(e){hide();}}}();                                  //hiding the application window
    head.insertBefore(document.createElement('<hta:application showInTaskBar=0>'), head.firstChild);        //hiding the application in the Taskbar

    var WMI=                                                                                                            //a small library written by me for obtaining WMI instance, its common methods and properties
    {                                                                                                                           //below is a sample of creating a process with certain window shifts and environment variables
                                                                                                                                //and obtaining its <ProcessId> by using WMI
        SWL:new ActiveXObject('WbemScripting.SWbemLocator'),
        PRMS:function(p)
        {
            var s = WMI.PS.SpawnInstance_();
            for(var i in p)
                s[i] = p[i];
            return s;
        },
        Create:function(c, s, d)
        {
            var CreateIn = WMI.CreateIn.SpawnInstance_();
            CreateIn.CommandLine = c;
            CreateIn.ProcessStartupInformation = s;
            CreateIn.CurrentDirectory = d;
            return WMI.PRC.ExecMethod_('Create', CreateIn).ProcessId;
        }
    };
    WMI.PRC = (WMI.WM = WMI.SWL.ConnectServer('.', 'root/cimv2')).Get('Win32_Process');
    WMI.PS = WMI.WM.Get('Win32_ProcessStartup');
    WMI.CreateIn = WMI.PRC.Methods_('Create').InParameters;

    var ID = O('Scriptlet.TypeLib').GUID.substr(0, 38),                                             //the unique ID obtaining
    EV = 'is64bit='+ID;                                                                                              //passing the unique ID to 64 bit HTA instance as an Environment variable
    for(var items = new Enumerator(env); !items.atEnd(); items.moveNext())
        EV += '?' + items.item();                                                                                  //obtaining all Environment variables for current process

    PID = WMI.Create                                                                                               //obtaining PID of 64 bit HTA instance
        (
            'mshta "' + decodeURIComponent(location.pathname) + '"',                     //current path
            WMI.PRMS
            (
                {
                    X:10000, Y:10000,                                                                              //hiding the application window before it is shown in order to resize it smoothly
                    EnvironmentVariables:
                        EV.split('?')                                                                                      //obtaining an array of all Environment variables by using this approach is universal for different
                                                                                                                                //versions of Windows
                        /*
                        [                                                                                                       //another way to pass certain Environment variables
                            'is64bit='+ID,                                                                              //indicates that the application is launched as 64 bit
                            'SystemRoot='+env('SystemRoot'),                                           //for start
                            'SystemDrive='+env('SystemDrive'),                                         //for hyperlinks
                            'TEMP='+env('TEMP'),                                                                //for "mailto" links
                            'CommonProgramW6432='+env('CommonProgramW6432')     //for ADODB.Stream
                        ]
                        */
                }
            )
        );

    head.firstChild.insertAdjacentHTML('afterEnd', '<object id=' + ID + ' PID=' + PID +
        ' classid=clsid:8856F961-340A-11D0-A96B-00C04FD705A2><param name=RegisterAsBrowser value=1>');      //registering current HTA window in collection of windows

    showModalDialog('javascript:for(var ws=new ActiveXObject("Shell.Application").Windows(),i=ws.Count;i-->0;)if((w=ws.Item(i))&&w.id=="'+ID+'"){w.s=document.Script;break;}', 0,
        'dialogWidth:0;unadorned:1;');                                                                       //silent stop of the script and obtaining window focus for "AppActivate"
    close();onerror=function(){close();};throw 0;                                                     //declining any further attempts of executing the rest statements of the code
}

var w,dt=new Date();
head.insertBefore(document.createElement('<hta:application contextMenu=no selection=no scroll=no>'), head.firstChild);      //adding custom HTA header dynamically
document.title='Extended Drop Target';
resizeTo(800, 400);
for(var ws = O('Shell.Application').Windows(), i = ws.Count; i -- > 0;)
    if((w = ws.Item(i)) && w.id == env('is64bit'))
    {
        PID = w.PID;
        w.document.Script.WSS.AppActivate(PID);                                                                                                                            //using "WScript.Shell" in focus to activate
                                                                                                                                                                                                          //the application window of 64 bit HTA instance;
                                                                                                                                                                                                          //remember that "WScript.Shell" should be
                                                                                                                                                                                                          //in focus in order "AppActivate" to work properly
        break;
    }

document.write('<body>');                                                                                      //obtaining body
if(w && w.id == env('is64bit'))
    w.s.close();                                                                                                         //closing previous 32 bit HTA instance while being in safe focus

document.body.appendChild(document.createTextNode('Debug screen (for test purposes only):'));
document.body.appendChild(document.createElement('br'));
document.body.appendChild(document.createElement('<textarea id=result cols=85 rows=5>'));
document.body.appendChild(document.createElement('p'));
document.body.appendChild(document.createTextNode('Extended Drop Target:'));
document.body.appendChild(document.createElement('br'));

document.body.appendChild
(
    (
        function createDropTarget(doc, filesAllowed, foldersAllowed, dTStyle, hdFont, wMColor, dMColor, pMColor, eMColor, process, resolve, msg, dBgImage, bBgImage,
            description, redirect)
        {
            var dropTarget = doc.createElement('<span style="' + dTStyle + '">'),

            ms = dropTarget.appendChild
            (
                doc.createElement('<span style="width:100%;height:100%;padding:10px;overflow:hidden;">')
            ),                                                                                                                  //message screen that hides Web Browser during dropped items processing

            WB = '<object classid=clsid:8856F961-340A-11D0-A96B-00C04FD705A2 style="width:100%;height:100%;"><param name=Location value="about:<body onload=\'b=0;\'' +
                ' ondragover=(function(){clearTimeout(b);b=setTimeout(\'location.reload();\',100);}()) bgColor=' + dMColor +
                ' style=\'width:100%;height:100%;position:absolute;margin:0;border:0;overflow:hidden;\'>'+ (description || '') +'">',
            processing = 1,                                                                                           //indicates whether a dropped item processing is started or not
            processed = 1,                                                                                            //indicates whether a dropped item is processed or not
            DBcatched = 1,                                                                                            //indicates whether DownloadBegin Web Browser event has been catched or not
            allowed,                                                                                                       //indicates whether drop target is allowed or not
            allowedText = (filesAllowed ? foldersAllowed ? msg[32] : msg[33] : foldersAllowed ? msg[34] : ''),      //"Drop a file or folder here."
            WBTReset,                                                                                                  //timeout for Web Browser reset

            startProcessing = function(p)                                                                      //processing the item path received after item drop (item path)
            {
                clearTimeout(WBTReset);
                dropTarget.children[processed = 1].removeNode();
                createDropTarget();
                setTimeout(function()
                {
                    var delay = 0;
                    if(p)                                                                                                      //the item can be accessed
                    {
                        sM(msg[38] + p + '</div>', pMColor);                                              //show "Processing"
                        var dt = new Date(),                                                                         //date before processing
                        e;                                                                                                     //error ID
                        try{e = process(p);}catch(e){e = 43;}                                               //unknown error occured
                        dt = new Date() - dt;                                                                         //date after processing
                        delay += dt>1000 ? 0 : 1000 - dt;
                        if(!e)                                                                                                 //no errors occured
                            setTimeout(function(){sM(msg[39] + createDropTarget.timeToHMSR(dt) + ' =-</div>', pMColor);}, delay);       //show "Processed in"
                        else                                                                                                 //an error occured
                        {
                            var err;
                            try{resolve(e);}catch(err){;}
                            setTimeout(function(){sM(msg[39] + createDropTarget.timeToHMSR(dt) + ' =-</div><br>' + msg[e], eMColor);}, delay);      //show "Processed in" with error
                            if(!redirect)
                                delay += 1000;
                        }
                    }
                    else                                                                                                     //the item can't be accessed
                    {
                        sM(msg[40] + msg[41] + allowedText + msg[42], eMColor);          //show "The item is not a file or folder, can't be accessed or its size is too big."
                        delay += 1000;
                    }

                    sDM(delay + 1000);
                }, 1000);
            },

            setWBTReset = function(r)                                                                          //setting a timeout for Web Browser reset (reset)
            {
                if(!processing)
                {
                    processing = 1;
                    ms.style.display = '';
                    if(r)
                        WBTReset = setTimeout(startProcessing, 1000);
                }
            },

            DB = function()                                                                                            //catching "DownloadBegin" Web Browser event
            {
                DBcatched = 1;
                setWBTReset(1);
            },

            STC = function(p)                                                                                         //catching "StatusTextChange" Web Browser event (item path)
            {
                setWBTReset(p);
                if(!processed && /file:|</.test(p))
                {
                    if(/file:/.test(p))
                        startProcessing(filesAllowed ? decodeURIComponent(p).replace(/.+:((?:\/{3})|(?=\/{2}))(.+)...$/,'$2').replace(/\//g,'\\') : 0);
                    else if(/</.test(p))
                    {
                        if(!DBcatched)                                                                                  //indicates that drop target is leaved without drop
                        {
                            processed = 1;
                            clearTimeout(WBTReset);
                            sM(msg[31] + allowedText + msg[35] + '</div>', dMColor, dBgImage);      //show "Drop a file or folder here."
                            allowed = 1;
                            ms.style.display = '';
                        }
                        else                                                                                                 //shortcuts with complex structure
                            startProcessing();
                    }
                }
            },

            NC2 = function(o, p)                                                                                     //catching "NavigateComplete2" Web Browser event (Web Browser object, item path)
            {
                if(!processed)
                    startProcessing(foldersAllowed && typeof p == 'string' && p.match(/^[^:]/) ? p : 0);
            },

            NE = function()                                                                                             //catching "NavigateError" Web Browser event
            {
                if(!processed)
                    startProcessing();
            },

            sM = function(m, c, bgImage)                                                                      //show message (message, background or text color, background image)
            {
                if(dBgImage || bBgImage)
                {
                    if(bgImage)
                        ms.style.backgroundImage = 'url(' + bgImage + ')';
                    ms.style.color = c;
                }
                else
                    ms.style.backgroundColor = c;
                m = '<div style="font:' + hdFont + ';">' + m;
                if(!redirect)
                    ms.innerHTML = m;
                else
                    redirect(m);
            },

            sDM = function(delay)                                                                                 //show default message (delay)
            {
                setTimeout(function(){allowed = 1;}, delay);
                setTimeout(function(){if(allowed)sM((allowedText ? msg[31] + allowedText + msg[35] : msg[36]) + '</div>', dMColor, dBgImage);}, delay + 100);     //show "Drop a file or folder
                                                                                                                                                                                                                                                             //here." or "Drop Target is
            }                                                                                                                                                                                                                                                //disabled."

            sM(msg[30], wMColor, dBgImage);                                                             //show welcome message

            ms.ondragenter=function()
            {
                if(allowed && (filesAllowed || foldersAllowed) && !event.dataTransfer.getData('text'))      //text dropping is not allowed
                {
                    event.dataTransfer.dropEffect='move';
                    return false;
                }
            }

            ms.ondragover = function()
            {
                if(allowed && (filesAllowed || foldersAllowed) && !event.dataTransfer.getData('text'))      //text dropping is not allowed
                {
                    event.dataTransfer.dropEffect='move';
                    if(!Math.abs(event.x - this.x) && !Math.abs(event.y - this.y))              //accepting only slow mouse motion
                    {
                        this.style.display = 'none';
                        DBcatched = allowed = processing = processed = 0;
                        sM(msg[37], dMColor, bBgImage);                                                 //show "Analysing..."
                    }
                    this.x = event.x;
                    this.y = event.y;
                    return false;
                }
            }

            !(createDropTarget = function()
            {
                dropTarget.insertAdjacentHTML('beforeEnd', WB);
                with(dropTarget.children[1])
                {
                    RegisterAsDropTarget = Silent = Offline = 1;
                    attachEvent('DownloadBegin', DB);
                    attachEvent('StatusTextChange', STC);
                    attachEvent('NavigateComplete2', NC2);
                    attachEvent('NavigateError', NE);
                }
            })();

            createDropTarget.timeToHMSR = function(d)                                             //convert date to hours, minutes, seconds and remainder (milliseconds) notation (date)
            {
                var r = d % 3600000,
                h = d / 3600000 ^ 0,                                                                                 //hours
                m = r / 60000 ^ 0,                                                                                     //minutes
                s = r % 60000 / 1000 ^ 0;                                                                         //seconds
                r = d % 1000;                                                                                           //remainder (milliseconds)
                return ((h ? h + 'h' : '') + (m ? (h ? ' ' : '') + m + 'm' : '') + (s ? (h || m ? ' ' : '') + s + 's' : '') + (r ? (h || m || s ? ' ' : '') + r + 'ms' : '')) || '0ms';
            },

            sDM(3000);                                                                                                  //postponing Web Browser access while it generates its events at start

            return dropTarget;
        }
        (
            //BEGIN of Extended Drop Target custom settings

            document,                                                                                                   //"document" object of certain window
            1,                                                                                                                 //indicates whether processing of files is allowed or not
            1,                                                                                                                 //indicates whether processing of folders is allowed or not
            'width:350px;height:150px;border:2px blue solid;font:bold 10pt Arial;text-align:center;cursor:default;overflow:hidden;word-break:break-all;',       //drop target style
            'bold 12pt Tahoma',                                                                                    //message header font
            'yellow',                                                                                                       //welcome message background color if background image is not set or text color otherwise
            'mediumaquamarine',                                                                                 //default message background color if background image is not set or text color otherwise
            'limegreen',                                                                                                 //processing message background color if background image is not set or text color otherwise
            'salmon',                                                                                                     //error message background color if background image is not set or text color otherwise

            function(p)                                                                                                   //data processing sample (file or folder path)
            {
                alert('Here goes data processing sample.\n\nProcessing:\n' + p);
                //throw 1;                                                                                                 //unknown error occured
                //return 1;                                                                                                //certain error 1 occured
                return 0;                                                                                                  //no errors
            },

            function(e)                                                                                                   //error resolving sample (error ID)
            {
                switch(e)
                {
                    case 1:
                        result.value = '\nCertain error 1 is catched.';                                  //additional action sample for certain error 1
                        updateData1();
                        break;
                    default:
                        result.value = '\nAn unknown error is catched.';                             //additional action sample for an unknown error
                        sendEmail();
                        break;
                }
                file.Close();                                                                                              //built-in silent catching of errors if certain error resolving method is still inaccessible
            },

            {                                                                                                                   //list of all messages for Extended Drop Target
                30: 'Welcome!</div><br>Hello World!',                                                 //welcome message
                31: 'Drop a ',                                                                                           //31, 32, 33, 34, 35 - "Drop a file or folder here."
                32: 'file or folder',
                33: 'file',
                34: 'folder',
                35: ' here.',
                36: 'Drop Target is disabled.',
                37: '-= Analysing... =-</div>',
                38: '-= Processing =-</div><br><div style="text-align:left;">',
                39: '-= Processed in ',
                40: "-= Can't be processed =-</div><br>",
                41: 'The item is not a ',                                                                           //41, 32, 33, 34, 42 - "The item is not a file or folder,<br>can't be accessed or its size is too big."
                42: ",<br>can't be accessed or its size is too big.",
                43: 'An unknown error occured.',                                                            //unknown error message
                1: 'Certain error 1 occured.'                                                                   //certain error 1 message
                                                                                                                                //certain error # message
                                                                                                                                //...
            }

            //,'C:\\Windows\\Web\\Screen\\img103.png'                                               //default background image or "undefined" (optional)
            //,'C:\\Windows\\Web\\Screen\\img102.jpg'                                                //busy mode background image or "undefined" (optional)

            //,'<div style=\'font:10pt Tahoma;padding:20px;\'>List of files supported by default.</div>'
                                                                                                                                //description length depends on the message language or its actual bytes count or "undefined" (optional)

            //,function(m){result.value = m;}                                                                  //sample for receiving messages or "undefined" (optional)

            //END of Extended Drop Target custom settings
        )
    )
);

result.value = '\nLoading time for 64 bit instance (if possible): ' + createDropTarget.timeToHMSR(new Date() - dt) + '.';
moveTo(screen.availWidth / 2 - 400, screen.availHeight / 2 - 200);

</script> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-14T16:33:07.620

HTA 显然不能成为 shell 删除操作的目标——至少在我的系统上，在 HTA 上删除某些东西是不可能的。

这意味着你不能*直接*做你想做的事。

但是，.vbs 可以是放置目标。已删除文件的完整路径可通过该`WScript.Arguments.Unnamed`集合获得。

[HTA 可以通过commandLine Property](http://msdn.microsoft.com/en-us/library/ms536479(VS.85).aspx)访问它的命令行参数。这意味着您可以构建一个小的帮助程序 VBScript，将删除的文件转换为命令行并为您调用 HTA。

请注意，您不能在 .vbs 上删除无穷无尽的文件，命令行也不是无限的。在几 kB 的区域内会有一个长度限制（我没有试图找到确切的限制在哪里，只是准备面对一个限制。）

# javascript - 用javascript在html页面中查找单词

> ID：748309
> 
> 赞同：18
> 
> 时间：2009-04-14T16:08:02.860
> 
> 标签：javascript, html

如何快速搜索 html 页面中的单词？我怎样才能得到这个词所在的html标签？（所以我可以使用整个标签）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-14T16:15:36.993

要找到该单词所在的元素，您必须遍历整个树，仅查看文本节点，应用与上述相同的测试。在文本节点中找到单词后，返回该节点的父节点。

```
var word = "foo",
    queue = [document.body],
    curr
;
while (curr = queue.pop()) {
    if (!curr.textContent.match(word)) continue;
    for (var i = 0; i < curr.childNodes.length; ++i) {
        switch (curr.childNodes[i].nodeType) {
            case Node.TEXT_NODE : // 3
                if (curr.childNodes[i].textContent.match(word)) {
                    console.log("Found!");
                    console.log(curr);
                    // you might want to end your search here.
                }
                break;
            case Node.ELEMENT_NODE : // 1
                queue.push(curr.childNodes[i]);
                break;
        }
    }
} 
```

这在 Firefox 中有效，对 IE 没有任何承诺。

它的作用是从 body 元素开始并检查该元素中是否存在单词。如果没有，那么就是这样，搜索就停止了。如果它在 body 元素中，那么它将遍历 body 的所有直接子元素。如果它找到一个文本节点，则查看该单词是否在该文本节点中。如果它找到一个元素，则将其推入队列。继续前进，直到您找到该词或没有更多要搜索的元素。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-14T16:14:04.670

您可以遍历 DOM 元素，在其中查找子字符串。既不快速也不优雅，但对于小型 HTML 可能工作得很好。

我会尝试一些递归的东西，比如：（*代码未测试）*

```
findText(node, text) {
  if(node.childNodes.length==0) {//leaf node
   if(node.textContent.indexOf(text)== -1) return [];
   return [node];
  }
  var matchingNodes = new Array();
  for(child in node.childNodes) {
    matchingNodes.concat(findText(child, text));
  }
  return matchingNodes;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T16:16:07.397

您可以尝试使用 XPath，它既快速又准确

[http://www.w3schools.com/Xpath/xpath_examples.asp](http://www.w3schools.com/Xpath/xpath_examples.asp)

此外，如果 XPath 稍微复杂一点，那么您可以尝试任何 jQuery 之类的 javascript 库，它隐藏了样板代码并更容易表达您想要找到的内容。

此外，从 IE8 和下一个 Firefox 3.5 开始，还实现了 Selectors API。您需要做的就是使用 CSS 来表达要搜索的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T16:19:29.340

您可能可以*足够快*地阅读文档树的主体并对其执行简单的字符串测试，而不必远远超出此范围 - 不过，这在一定程度上取决于您正在使用的 HTML - 您对页面有多少控制权? 如果您在您控制的网站中工作，您可能可以将搜索重点放在可能与页面不同的页面部分上您不一定知道需要测试哪些内容。

同样，如果您要多次搜索同一页面并且您的数据集很大，则可能值得在内存中创建某种索引，而如果您只想搜索几个单词或使用较小的文档，则可能不需要值得花费时间和复杂性来构建它。

最好的办法可能是获取一些您认为具有代表性的示例文档，然后根据人们在此处提供的方法进行大量原型设计。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-18T17:39:23.313

```
form.addEventListener("submit", (e) => {
e.preventDefault();
var keyword = document.getElementById("search_input");
let words = keyword.value;
var word = words,
    queue = [document.body],
    curr;
while (curr = queue.pop()) {
    if (!curr.textContent.toUpperCase().match(word.toUpperCase())) continue;
    for (var i = 0; i < curr.childNodes.length; ++i) {
        switch (curr.childNodes[i].nodeType) {
            case Node.TEXT_NODE: // 3
                if (curr.childNodes[i].textContent.toUpperCase().match(word.toUpperCase())) {
                    console.log("Found!");
                    console.log(curr);
                    curr.scrollIntoView();
                }
                break;
            case Node.ELEMENT_NODE: // 1
                queue.push(curr.childNodes[i]);
                break;
        }
    }
} 
```

});

# c# - WinForms - 你如何获得控件“想要”的大小？

> ID：748316
> 
> 赞同：7
> 
> 时间：2009-04-14T16:10:41.187
> 
> 标签：c#, .net, winforms

当 a`Control`停靠在容器中（如 a `Panel`）并且太宽而无法显示（因此出现滚动条）时，`Control.Width`似乎返回了 Control 的可见宽度（图片中的顶部箭头）。

您如何获得控件“想要”的宽度？即，如果您不必滚动，您会看到它的全宽（图片中的底部箭头）。

[替代文字 http://img19.imageshack.us/img19/372/size.png](http://img19.imageshack.us/img19/372/size.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-14T16:24:51.947

您可能会发现控件的两个不同属性对此很有用。DefaultSize 是控件最初创建时的大小，然后是 PreferredSize，可以说是控件可以适应的大小。所有控件都具有这些属性，并且 PreferredSize 应该是您正在寻找的那个。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-14T16:31:40.527

`Bounds`是其绘制的实际尺寸

`ClientSize`是大小减去任何滚动条

`Control.PreferredSize`是你想要的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-08T16:58:18.263

`Control.HorizontalScrollbar.Maximum`，或者`Control.VerticalScrollbar.Maximum`应该返回所需的最大大小。它可能会返回少量，因为它可能会切断填充。

# c# - ReliabilityContractAttribute 有什么作用？

> ID：748319
> 
> 赞同：13
> 
> 时间：2009-04-14T16:11:12.603
> 
> 标签：c#, .net, vb.net, attributes

它是否有任何作用或仅用于文档。如果仅用于文档，为什么文档不记录它？

例如，这两个静态方法`System.Array`：

```
[ReliabilityContract(Consistency.MayCorruptInstance, Cer.MayFail)]
public static void Copy(Array sourceArray, Array destinationArray, int length)

[ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
public static void ConstrainedCopy(Array sourceArray, int sourceIndex, Array destinationArray, int destinationIndex, int length) 
```

他们生成的 MSDN 文档甚至没有提及[`Copy`](http://msdn.microsoft.com/en-us/library/k4yx47a1.aspx)或[`ConstrainedCopy`](http://msdn.microsoft.com/en-us/library/system.array.constrainedcopy.aspx)注释。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-14T16:54:42.017

我相信它们也用于受约束的执行区域，因此 CLR 知道它可以安全地做什么。您的代码在 CER 中无法执行某些操作，作为回报，CLR 保证不会引发某些带外异常。

[MSDN](https://msdn.microsoft.com/en-us/library/ms228973(v=vs.110).aspx)有更多细节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T16:13:05.983

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.runtime.constrainedexecution.reliabilitycontractattribute.aspx)：

> ReliabilityContractAttribute 属性为您提供了一种记录代码的机制，并指示您在面对可能导致不一致状态的异常情况时可以做出何种类型的可靠性保证。在此上下文中，异常情况定义为可由公共语言运行时在运行时生成的异步异常，例如中止线程、内存不足情况和堆栈溢出。您可以将 ReliabilityContractAttribute 特性应用于程序集、类型和方法。
> 
> 将此属性与 Consistency 枚举结合使用，通过记录特定代码段的可靠性级别来定义可靠性协定。

# asp.net - AspNetSqlMembershipProvider 和 PasswordRecovery 控件

> ID：748320
> 
> 赞同：0
> 
> 时间：2009-04-14T16:11:15.490
> 
> 标签：asp.net, asp.net-2.0, passwords, membership, membership-provider

我的场景是我有一个 asp.net 2.0 应用程序 web 应用程序，它的 AspNetSqlMembershipProvider 属性为：

> enablePasswordRetrieval="false" 和 passwordFormat="Hashed"

但是现在需要将未加密的用户密码存储为明文并将其显示给超级用户。我通过将 AspNetSqlMembershipProvider 属性更改为：

> enablePasswordRetrieval="true" 和 passwordFormat="Clear"

问题在于 PasswordRecovery 控件的行为方式。根据我的阅读，它会检查 AspNetSqlMembershipProvider 标记的属性，如果 enablePasswordRetrieval="true" 和 passwordFormat="Clear" 它将尝试检索密码，当密码仍然有效地存储为散列密码时，这会导致问题。当 AspNetSqlMembershipProvider 属性为 enablePasswordRetrieval="true" 和 passwordFormat="Clear" 时，是否有任何方法可以强制 PasswordRecovery 控件重置而不检索密码？

很抱歉冗长的解释，所有帮助/指针一如既往地非常感谢。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T17:55:48.797

另外，请记住，以明文形式存储密码具有法律含义。如果这些密码被滥用或泄露，您应对所有被泄露的数据负责（包括通过您**不**拥有但用户使用相同密码的任何其他服务访问的数据）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T16:16:01.920

我认为尝试使用两种方法在数据库中存储密码不会有任何运气。

我的建议是更改具有散列密码的帐户的密码，以便它们以纯文本形式存储并从那里继续。

或者，如果您*必须*存储一些散列密码和一些明文密码，则必须考虑扩展会员提供程序以支持此功能。以我的经验，这往往比它的价值更麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T16:19:16.717

根据我的经验，更改密码格式是有问题的——我认为没有办法让提供商自动为您处理这个问题。

您可能需要考虑强制散列用户在下次登录时更改密码，或者只是编写一个流程，通过并在数据库中重置他们的密码。密码表中有一个描述格式的列（我现在看不到），因此您可以将该值从 hash 更改为 clear，然后 hash-value 将是他们的明文密码，应该可以登录。

# python - Python：将那些 TinyURL（bit.ly、tinyurl、ow.ly）转换为完整的 URL

> ID：748324
> 
> 赞同：13
> 
> 时间：2009-04-14T16:14:04.157
> 
> 标签：python, bit.ly, tinyurl

我只是在学习 python，并且对如何实现这一点很感兴趣。在寻找答案的过程中，我遇到了这个服务：[http ://www.longurlplease.com](http://www.longurlplease.com)

例如：

[http://bit.ly/rgCbf](http://bit.ly/rgCbf)可以转换为：

[http://webdesignledger.com/freebies/the-best-social-media-icons-all-in-one-place](http://webdesignledger.com/freebies/the-best-social-media-icons-all-in-one-place)

我用 Firefox 进行了一些检查，发现原始 url 不在标题中。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-14T16:17:56.877

Enter [`urllib2`](http://docs.python.org/library/urllib2.html)，它提供了最简单的方法：

```
>>> import urllib2
>>> fp = urllib2.urlopen('http://bit.ly/rgCbf')
>>> fp.geturl()
'http://webdesignledger.com/freebies/the-best-social-media-icons-all-in-one-place' 
```

但是，为了参考起见，请注意，这也可以通过[`httplib`](http://docs.python.org/library/httplib.html#module-httplib)：

```
>>> import httplib
>>> conn = httplib.HTTPConnection('bit.ly')
>>> conn.request('HEAD', '/rgCbf')
>>> response = conn.getresponse()
>>> response.getheader('location')
'http://webdesignledger.com/freebies/the-best-social-media-icons-all-in-one-place' 
```

并且[`PycURL`](http://pycurl.sourceforge.net/)，虽然我不确定这是否是使用它的最佳方法：

```
>>> import pycurl
>>> conn = pycurl.Curl()
>>> conn.setopt(pycurl.URL, "http://bit.ly/rgCbf")
>>> conn.setopt(pycurl.FOLLOWLOCATION, 1)
>>> conn.setopt(pycurl.CUSTOMREQUEST, 'HEAD')
>>> conn.setopt(pycurl.NOBODY, True)
>>> conn.perform()
>>> conn.getinfo(pycurl.EFFECTIVE_URL)
'http://webdesignledger.com/freebies/the-best-social-media-icons-all-in-one-place' 
```

# django - 在 django admin 中对模型进行分组

> ID：748328
> 
> 赞同：17
> 
> 时间：2009-04-14T16:14:16.153
> 
> 标签：django, django-models, django-admin

有没有办法在 django 管理界面中对模型进行分组？

我目前有一个名为 requests 的应用程序，在管理站点中显示了以下模型：

```
**Requests**
Divisions
Hardware Requests
Hardware Types
Requests
Software Requests
Software Types 
```

我希望将部门、软件请求和硬件请求分别分组到“类型”组中。我知道我可以覆盖和硬编码 admin/index.html 和 base_site.html 但这似乎很复杂，只是为了指定分组。

有什么我可以添加到 Meta 类来指定组名的吗？

到目前为止，我发现实现我想要的唯一方法是将模型移动到请求中的新应用程序（“requests.Types”），但同样，感觉不是“正确的方式”。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2018-07-10T14:15:34.373

您可以使用[django-modeladmin-reorder](https://pypi.org/project/django-modeladmin-reorder/)来完成。

然后，您将按照以下方式对其进行配置（settings.py）：

```
ADMIN_REORDER = (
    {'app': 'requests', 'label': 'Types',
        'models': (
            'requests.Divisions',
            'requests.HardwareRequests',
            'requests.HardwareTypes'
        )
   },
   {'app': 'requests', 'label': 'Other models',
        'models': (
            'requests.Requests',
            'requests.SoftwareRequests',
            'requests.SoftwareTypes'
        )
   },
) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-15T05:08:21.300

您无法在模型定义中添加任何内容来执行此操作，因为模型（根据设计）不知道管理员的存在，也不知道它们将如何在管理员中呈现。

在这种情况下，您只需编写一个模板来满足您的需求并使用它；您所要求的只是进行演示更改，而模板是您在 Django 中进行演示的地方。

# bash - 如何使用 lame 在 shell 脚本中编码 wav 文件？

> ID：748329
> 
> 赞同：2
> 
> 时间：2009-04-14T16:14:19.617
> 
> 标签：bash, encoding, shell, mp3, wav

我正在尝试通过带有空格的变量来设置艺术家信息。跛脚废话。也许我被 bash 智障了？

```
#!/bin/bash
year=2008;
artist="New Kids On The Block";
album="The Block";
bitrate=320;
lame="lame -b $bitrate --ta \"$artist\"  --tl \"$album\" --ty $year"

function first_half
{
    for (( i=1;i<10;i++ )); do
        $lame "track_0$i.wav" "track_0$i.mp3";
    done;
}

function second_half
{
    for (( x=10;x<18;x++ )); do
        echo $lame "track_$x.wav" "track_$x.mp3";
    done;
}

first_half &
first_pid=$!

#second_half &
#second_pid=$ 
```

这是脚本的输出。

```
user@host:~/ogg/noartist/unknown_disc$ ./encode.sh 
user@host:~/ogg/noartist/unknown_disc$ lame: excess arg The
lame: excess arg The 
```

Lame 抱怨每次循环迭代......当然。

我更改了脚本以回显循环的迭代之一，这就是输出的内容。

```
lame -b 320 --ta "New Kids On The Block" --tl "The Block" --ty 2008 track_01.wav track_01.mp3 
```

这在外壳上工作正常......我很困惑。我在这里做错了什么？我知道这与我的变量中的空格有关，但我不确定如何解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T21:19:50.850

问题是线路

```
lame="lame -b $bitrate --ta \"$artist\"  --tl \"$album\" --ty $year" 
```

因为 $lame later 被多次评估。你可以跑

```
bash -xv ./encode.sh 
```

查看执行的命令和替换的变量（而不是运行“bash -xv”，您可以在脚本中添加“set -xv”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T21:50:44.393

“跛脚”应该是一个功能。注意：我在同一目录“./lame”中运行了“lame”，因此我可以使用另一个脚本来测试结果。

```
#!/bin/bash
year=2008
artist="New Kids On The Block"
album="The Block"
bitrate=320

function lame()
{
#local bitrate=$1
#local artist=$2
#local album=$3
#local year=$4
local in=$1
local out=$2
./lame -b "$bitrate" --ta "$artist" --tl "$album" --ty "$year" "$in" "$out"
}

function first_half
{
    for (( i=1;i<10;i++ )); do
        lame "track_0$i.wav" "track_0$i.mp3"
    done
}

first_half &
first_pid=$! 
```

瘸：

```
#!/bin/bash

echo ===============================================
echo $0 $*
echo "0 ==> \"$0\""

CNT=1
while true; do
  echo -n "$CNT "
  [ $CNT -lt 10 ] && echo -n " "
  echo "==> \"$1\""
  CNT=$(($CNT + 1))
  shift
  [ -z "$1" ] && break
done

echo =============================================== 
```

样本输出（部分）：

```
===============================================
./lame -b 320 --ta New Kids On The Block --tl The Block --ty 2008 track_01.wav track_01.mp3
0 ==> "./lame"
1  ==> "-b"
2  ==> "320"
3  ==> "--ta"
4  ==> "New Kids On The Block"
5  ==> "--tl"
6  ==> "The Block"
7  ==> "--ty"
8  ==> "2008"
9  ==> "track_01.wav"
10 ==> "track_01.mp3"
===============================================
===============================================
./lame -b 320 --ta New Kids On The Block --tl The Block --ty 2008 track_02.wav track_02.mp3
0 ==> "./lame"
1  ==> "-b"
2  ==> "320"
3  ==> "--ta"
4  ==> "New Kids On The Block"
5  ==> "--tl"
6  ==> "The Block"
7  ==> "--ty"
8  ==> "2008"
9  ==> "track_02.wav"
10 ==> "track_02.mp3"
=============================================== 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T17:19:47.540

我找到了一个我使用的临时解决方案......

这有点像黑客，但它可以完成工作：

```
#!/bin/bash
year="2008";
artist="\"New Kids On The Block\"";
album="\"The Block\"";
bitrate=320;
genre="Pop";
lame="lame -b $bitrate --ta $artist  --tl $album --ty $year --tg $genre"

function first_half
{
    echo "Encoding first half...";
    for (( i=1;i<10;i++ )); do
        echo $lame "track_0$i.wav" "track_0$i.mp3" > run1.sh;
        bash run1.sh >/dev/null 2>/dev/null;
    done;
    rm -f run1.sh;
}

function second_half
{
    echo "Encoding second half too...";
    for (( x=10;x<18;x++ )); do
        echo $lame "track_$x.wav" "track_$x.mp3" >run2.sh;
        bash run2.sh >/dev/null 2>/dev/null;
    done;
    rm -f run2.sh;
}

first_half &
echo $! > first_half.pid

second_half
echo $! > second_half.pid

echo "Done!";
rm *.pid -f 
```

# asp.net-mvc - POST 操作方法中的强类型 ViewModel 仅包含空值

> ID：748331
> 
> 赞同：7
> 
> 时间：2009-04-14T16:14:57.073
> 
> 标签：asp.net-mvc

我正在尝试使用接收自定义形状的 ViewModel 类的强类型视图来实现我的编辑操作方法。换句话说，我想要一个强类型的 ViewModel，它包含应该编辑的 Linq 实体以及应该在视图中显示的一些其他对象。

我可以在调用 GET Edit 操作方法时看到视图，但是强类型的 POST 操作方法只接收一个带有空参数的 ViewModel 类，我不知道如何检索 POST 参数。

视图模型如下所示：

```
//my custom-shaped ViewModel
public class CustomersFormViewModel
{
    public SelectList AccountTypesDropDownBox;
    public SelectList CountriesDropDownBox;
    public Customer Customer;
} 
```

动作方法如下所示：

```
//
// GET: /CustomersController/Edit   

public ActionResult Edit(int ID)
{
   var model = new CustomersFormViewModel
                    {
                        Customer = repository.Load(ID.Value),
                        CountriesDropDownBox = GetCountries(),
                        AccountTypesDropDownBox = GetAccountTypes()
                    };
    return View(model);
}

//
// POST: /CustomersController/Edit  

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(CustomersFormViewModel model)
{
    //THE NEXT LINE THROWS!!!
    Debug.Assert(Model.Customer!=null);
    return View(model);
} 
```

这是我的编辑视图：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/CustAdminMaster.master"
    Inherits="System.Web.Mvc.ViewPage<Zeiterfassung.Controllers.CustomersController+CustomersFormViewModel>" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
    NewEdit
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <h2>
        NewEdit</h2>
    <%= Html.ValidationSummary("Edit was unsuccessful. Please correct the errors and try again.") %>
    <% using (Html.BeginForm())
       {%>
    <fieldset>
        <legend>Fields</legend>
        <p>
            <label for="FirstName">FirstName:</label>
            <%= Html.TextBox("FirstName",Model.Customer.FirstName) %>
            <%= Html.ValidationMessage("FirstName", "*") %>
        </p>
        <p>
            <input type="submit" value="Save" />
        </p>
    </fieldset>
    <% } %>
    <div>
        <%=Html.ActionLink("Back to List", "Index") %>
    </div>
</asp:Content> 
```

我还尝试了带有 formValues 参数的 POST 操作方法，但视图模型仍然不包含发布的参数：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(int ID, FormCollection formValues)
{
      CustomersFormViewModel model = new CustomersFormViewModel();            
      UpdateModel(model);
      //THE NEXT LINE STILL THROWS
      Debug.Assert(model.Customer!=null);
      return View("NewEdit",model);
} 
```

到目前为止，我发现的唯一方法是编写自己的代码，从 FormCollection 中获取发布的参数并相应地更新我的自定义 ViewModel。但这种方法似乎有点原始。真的没有更好的方法来做到这一点吗？

**编辑：**我刚刚按照 tvanfosson 的建议在视图中尝试了不同的语法，但问题仍然没有改变：

```
<label for="Customer.FirstName">FirstName:</label>
    <%= Html.TextBox("Customer.FirstName") %>
    <%= Html.ValidationMessage("Customer.FirstName", "*") %> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-14T16:32:33.643

您需要根据模型中的前缀命名字段。此外，您需要修改视图模型以使用属性而不是字段。默认模型绑定器仅在绑定时查看模型上的公共属性。

```
 <label for="Customer.FirstName">FirstName:</label>
    <%= Html.TextBox("Customer.FirstName") %>
    <%= Html.ValidationMessage("Customer.FirstName", "*") %> 
```

这样，模型绑定器就知道如何将表单参数与模型的适当组件和关联属性相关联。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-01-14T16:26:20.623

已经有一段时间了，但这个问题确实没有答案。

篡改了同样的问题，直到我在我的视图模型上发现了具有私有集的 auto 属性。

查看您的视图模型，您缺少自动属性获取和设置器！

因此，相应地更改您的视图模型：

```
public class CustomersFormViewModel

    {
        public SelectList AccountTypesDropDownBox {get; set;}
        public SelectList CountriesDropDownBox {get; set;}
        public Customer Customer {get; set;}
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T04:05:08.550

尝试

```
UpdateModel(model, "Customer"); 
```

也看看这里：

[UpdateModel 前缀 - ASP.NET MVC](https://stackoverflow.com/questions/347524/updatemodel-prefix-asp-net-mvc)

如果还是不行，在UpdateModel之后设置断点。如果它没有完成这项工作，请尝试在 quickWatch(ctrl+alt+q) 中使用不同的调用 UpdateModel 组合。

如果它*仍然*不起作用，请连接源并调试一下:)。你会学到一些新东西，然后你会告诉我们:)。然后大家就开心了。

祝你好运。

# sms - 如何像 Twitter 那样发送 SMS 消息？

> ID：748337
> 
> 赞同：5
> 
> 时间：2009-04-14T16:16:10.673
> 
> 标签：sms, messaging

是否所有的手机公司都有开放的 API 允许您像 Twitter 一样发送 SMS 消息？

你需要付钱吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T16:20:06.543

许多（大多数？）移动公司都有允许您发送 SMS 的电子邮件网关。对于 AT&T，我相信它是 phonenumber@text.att.net，但每个提供商都有不同的地址。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T16:20:33.190

这篇[维基百科](http://en.wikipedia.org/wiki/SMS_gateway)文章很好地总结了它。一些手机公司有简单的格式。例如，Verizon 使用 number@vtext.com。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-26T01:52:00.120

它变得有点复杂。电子邮件网关可能适用于某些运营商，但不适用于其他运营商。如前所述，它基于您的手机运营商、我们可以提供的聚合器，以及可能的第三方“跨运营商”。但是，这也取决于数量。如果您只是通过电子邮件偶尔发送短信，它当然可以工作，但是，它只是偶尔使用，而且您不会收到手机通常看到的确认信息。对于消息的批量传输，您通常需要与您的运营商讨论如何访问他们的“SMSC 网关”。SMSC 网关使用互联网协议 (SMPP) 将消息从您的应用程序传输到运营商云。它专为音量而设计，您可以获得消息的响应代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T20:55:50.843

如果您想要一个可靠的解决方案，那么是的，您必须为此付费，有一些有限的免费版本。

我们将 Clickatell 用于早期项目[http://www.clickatell.com/developers.php](http://www.clickatell.com/developers.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T16:31:37.687

这取决于您在哪个国家/地区。在英国付款发送 - 接收是免费的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T20:51:17.887

看看[messagepub](http://messagepub.com)。它们提供了一个简单的 API，以便您可以从应用程序发送 SMS 消息。

# watin - 有人对 WEBAii、Watin 和 Selenuim 有什么建议吗？

> ID：748353
> 
> 赞同：4
> 
> 时间：2009-04-14T16:21:07.323
> 
> 标签：watin

请给我您对 WebAii、Watin 和 Selenuim 的宝贵建议。实际上，我一直在使用 WebAii，它对我来说工作正常，但同时我还没有使用其他框架来测试支持 Ajax 的 Web 应用程序。请分享您在使用这些框架之一时遇到的想法或问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T16:55:20.267

我们同时使用了 watir、watin 和 webaii，并选择了 webaii，因为它在处理 AJAX 时具有可预测性。

webaii 框架的定价是正确的 :) 但如果它是开源的，它会让团队中的一些人更舒服。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-24T22:17:17.213

即使在与 Telerik 合并之后。WebAii 仍然是免费的。可以从这里下载： [http ://www.telerik.com/community/free-products.aspx](http://www.telerik.com/community/free-products.aspx)

# com - 什么是 COM？

> ID：748355
> 
> 赞同：27
> 
> 时间：2009-04-14T16:24:03.133
> 
> 标签：com, guid

我努力搜索，但无法掌握整个想法。谁能告诉我：

*   COM实际上是什么？
*   GUID 如何工作，COM 如何使用它们？
*   COM如何解决不同DLL版本的问题。

或者至少，给我指出一篇解释这些概念的好文章？谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-14T16:45:14.020

COM 是“组件对象模型”。它是最早设计用于允许“二进制重用”组件的技术之一……最初，它是对 Microsoft Office 大约 1988-1992 年的时间框架（称为动态数据交换 (DDE)）的重写，旨在让各种 Office 应用程序相互通信的技术。重写它的第一次尝试称为 OLE-Automation（对象链接和嵌入）。但是当他们完成后，他们将其重命名为 COM。

这个怎么运作：

本质上，在 COM 之前，当客户端组件想要使用一个组件（编写为 C++ 库）时，它必须与库一起编译，因此它可以准确地知道编译后的二进制文件中有多少字节才能找到每个方法或函数称呼。

对于 COM，有一个关于如何构建这些方法的定义机制，然后编译器生成一个单独的文件（称为类型库或接口定义语言 (IDL) 文件，其中包含所有这些函数偏移数据。

然后，作为组件的用户，您必须“注册”它，它将所有这些信息（从 GUID 中键控）写入操作系统注册表，任何客户端应用程序都可以访问它，并通过从注册表中读取数据，它可以知道在二进制文件中的何处找到每个方法或类的入口点。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-14T16:44:13.960

您的问题有点大，无法在此处进行完整解释。可以在《[了解 ActiveX 和 OL](https://rads.stackoverflow.com/amzn/click/com/1572312165) E》一书中找到对 COM 的快速高级介绍。更详细但仍然是介绍性的介绍是[Inside COM](https://rads.stackoverflow.com/amzn/click/com/1572313498)。关于这个主题的最好的书是 Don Box 的[Essential COM](https://rads.stackoverflow.com/amzn/click/com/0201634465)。

几个快速的答案：

*   COM 是对象的二进制接口标准。它允许各种程序写入接口，而不必使用相同的编译器以相同的语言编写。也有相关的服务可用。
*   GUID 是 COM 用来标识接口的全局唯一编号。
*   COM 不能解决不同的 DLL 版本问题。它只允许为每个 GUID 注册一个 DLL。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-14T17:03:22.510

COM 启用可重用的软件。与构建块一样，您可以创建 COM 对象（或现在 .NET 中的程序集）来为更大的软件提供功能。我使用 COM 为 Excel 和 MS BizTalk 提供数据库集成。MS BizTalk 等软件使用 COM/Assemblies 来扩展标准流程的处理能力；您可以将 COM 插入到消息工作流中以执行比 Microsoft 实现的更多的处理。COM 还允许使用提供内置对象池、安全性和控制接口的组件服务。

[维基百科对GUID](https://en.wikipedia.org/wiki/Globally_unique_identifier)有很好的定义。请注意，Microsoft 的格式在其他开发社区中不一定使用。

COM 本身并不能解决 DLL 版本问题。如果您使用 COM 版本控制功能，它使您能够增量地扩展软件。因此，如果您有一个使用 COM 将 XML 转换为文本的应用程序（例如）并且您想要增强，您可以创建一个新版本 (2.0)，您可以在更新源应用程序以使用新的 COM。这样，您可以（如果需要）拥有一个 switch 语句，如果系统限制需要，它仍然可以使用旧的 COM，或者使用新的 COM（它们将是不同的 DLL）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-14T16:56:39.967

COM 有很多不同的东西。我推荐 Don Box 的书 Essential COM 作为学习的好方法。

至少，COM 对象是公开单个接口 IUnknown 的对象。该接口有 3 个方法，AddRef、Release 和 QueryInterface。AddRef/Release 使对象能够被引用计数，并在最后一个引用被释放时自动删除。QueryInterface 允许您询问对象以获取它支持的其他接口。

大多数 COM 对象都是可发现的。它们在 HKEY_CLASSES_ROOT 下的注册表中注册，带有一个标识 GUID，称为 CLSID（类 ID）。如果您知道 GUID，这使您可以调用 CoCreateInstance 来创建已注册对象的实例。您还可以通过 COM API 在注册表中查询支持 ProgId（程序 id）的 CLSID，这是一个标识对象的字符串。

许多 COM 对象具有指定对象支持的接口和方法的类型库，以及具有方法 Invoke 的 IDispatch，它允许您动态调用对象上的方法。这使得对象可以从不支持强类型的脚本语言中使用。

一些对象支持在不同的进程、不同的线程或不同的机器上运行。COM 支持对这些类型的对象进行编组。如果可能，标准编组器可以使用对象的类型库来编组对对象的调用，但也可以提供自定义编组器。

COM 对象还有很多东西，我几乎没有触及表面。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-14T16:40:10.973

10,000 英尺视野：

COM 是软件组件的通信机制。例如，您可以与 COM 接口（.NET 中的 COM 互操作）进行交互，以使用未通过公共接口（.NET 程序集）公开的功能。

[GUID 在 Wikipedia http://en.wikipedia.org/wiki/Globally_Unique_Identifier](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)上的解释相当不错

我一直将 LIB 文件理解为 C++ 链接器的目标文件。它们包含 cpp 文件中所有对象的代码。编译器在链接不需要的目标文件部分时进行优化。

有人请澄清，因为我确信我屠杀了其中的一些。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T16:44:27.283

[COM](http://en.wikipedia.org/wiki/Component_Object_Model)是 Microsoft 的组件对象模型，它是一种二进制兼容接口，用于以各种语言编写的程序相互操作。这是 OLE 和 .NET 技术之间的“进化步骤”。

如果您想从 C++ 的角度了解 COM，请查看 Don Box 的[Essential COM](https://rads.stackoverflow.com/amzn/click/com/0201634465)或Rector 和 Sells 的[ATL Internals](https://rads.stackoverflow.com/amzn/click/com/0321159624)。

[microsoft.public.vc.atl](http://groups.google.com/group/microsoft.public.vc.atl/topics)组可能是提出您无法在此处获得答案的问题的最佳场所。它主要是一个 ATL 新闻组，但它似乎也是一般 COM 问题流量最多的新闻组。（只是为通常的新闻组生硬和不耐烦做好准备）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-14T16:47:38.397

COM 是一种开发软件组件的方法，即小型二进制 exe，它为应用程序、操作系统和其他组件提供服务。开发自定义 COM 组件就像开发面向对象的 API。GUID 是一个全局唯一 ID，用于唯一标识一个 COM 组件。

您可以参考 Dale Rogerson 的一本非常好的书以了解更多详细信息。[内部 COM](http://www.amazon.co.uk/Inside-COM-Dale-Rogerson/dp/1572313498)

# java - 通过反射或其他方式覆盖java final 方法？

> ID：748362
> 
> 赞同：13
> 
> 时间：2009-04-14T16:25:23.817
> 
> 标签：java, reflection, methods, final

在尝试编写测试用例时会出现这个问题。Foo 是框架库中的一个类，我没有源代码访问权限。

```
public class Foo{
  public final Object getX(){
  ...
  }
} 
```

我的申请将

```
public class Bar extends Foo{
  public int process(){
    Object value = getX();
    ...
  }
} 
```

由于其他依赖关系，我无法创建 Foo 对象，因此单元测试用例无法初始化。BarTest 抛出一个空指针，因为值为空。

```
public class BarTest extends TestCase{
  public testProcess(){
    Bar bar = new Bar();        
    int result = bar.process();
    ...
  }
} 
```

有没有办法可以使用反射 api 将 getX() 设置为非最终的？或者我应该如何进行测试？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2016-11-16T15:47:25.633

因为这是谷歌中“覆盖最终方法 java”的最佳结果之一。我想我会留下我的解决方案。此类显示了一个使用示例“Bagel”类和免费使用的 javassist 库的简单解决方案：

```
/**
 * This class shows how you can override a final method of a super class using the Javassist's bytecode toolkit
 * The library can be found here: http://jboss-javassist.github.io/javassist/
 * 
 * The basic idea is that you get the super class and reset the modifiers so the modifiers of the method don't include final.
 * Then you add in a new method to the sub class which overrides the now non final method of the super class.
 * 
 * The only "catch" is you have to do the class manipulation before any calls to the class happen in your code. So put the
 * manipulation as early in your code as you can otherwise you will get exceptions.
 */

package packagename;

import javassist.ClassPool;
import javassist.CtClass;
import javassist.CtMethod;
import javassist.CtNewMethod;
import javassist.Modifier;

/** 
 * A simple class to show how to use the library
 */
public class TestCt {

    /** 
     * The starting point for the application
     */
    public static void main(String[] args) {

        // in order for us to override the final method we must manipulate the class using the Javassist library.
        // we need to do this FIRST because once we initialize the class it will no longer be editable.
        try
        {
            // get the super class
            CtClass bagel = ClassPool.getDefault().get("packagename.TestCt$Bagel");

            // get the method you want to override
            CtMethod originalMethod = bagel.getDeclaredMethod("getDescription");

            // set the modifier. This will remove the 'final' modifier from the method.
            // If for whatever reason you needed more than one modifier just add them together
            originalMethod.setModifiers(Modifier.PUBLIC);

            // save the changes to the super class
            bagel.toClass();

            // get the subclass
            CtClass bagelsolver = ClassPool.getDefault().get("packagename.TestCt$BagelWithOptions");

            // create the method that will override the super class's method and include the options in the output
            CtMethod overrideMethod = CtNewMethod.make("public String getDescription() { return super.getDescription() + \" with \" + getOptions(); }", bagelsolver);

            // add the new method to the sub class
            bagelsolver.addMethod(overrideMethod);

            // save the changes to the sub class
            bagelsolver.toClass();
        }
        catch (Exception e)
        {
            e.printStackTrace();
        }

        // now that we have edited the classes with the new methods, we can create an instance and see if it worked

        // create a new instance of BagelWithOptions
        BagelWithOptions myBagel = new BagelWithOptions();

        // give it some options
        myBagel.setOptions("cheese, bacon and eggs");

        // print the description of the bagel to the console.
        // This should now use our new code when calling getDescription() which will include the options in the output.
        System.out.println("My bagel is: " + myBagel.getDescription());

        // The output should be:
        // **My bagel is: a plain bagel with cheese, bacon and eggs**
    }

    /**
     * A plain bagel class which has a final method which we want to override
     */
    public static class Bagel {

        /**
         * return a description for this bagel
         */
        public final String getDescription() {
            return "a plain bagel";
        }
    }

    /**
     * A sub class of bagel which adds some extra options for the bagel.
     */
    public static class BagelWithOptions extends Bagel {

        /**
         * A string that will contain any extra options for the bagel
         */
        String  options;

        /**
         * Initiate the bagel with no extra options
         */
        public BagelWithOptions() {
            options = "nothing else";
        }

        /**
         * Set the options for the bagel
         * @param options - a string with the new options for this bagel
         */
        public void setOptions(String options) {
            this.options = options;
        }

        /**
         * return the current options for this bagel
         */
        public String getOptions() {
            return options;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T16:56:08.643

您可以创建另一个可以在测试中覆盖的方法：

```
public class Bar extends Foo {
  protected Object doGetX() {
    return getX();
  }
  public int process(){
    Object value = doGetX();
    ...
  }
} 
```

然后，您可以在 BarTest 中覆盖 doGetX。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T16:38:47.437

Seb 是正确的，只是为了确保您得到问题的答案，而不是在本机代码中做某事（我很确定这不会起作用）或在运行时修改类的字节码，并创建类在运行时覆盖该方法，我看不到改变方法“最终性”的方法。反思在这里对你没有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T16:31:36.937

如果您的单元测试用例由于其他依赖项而无法创建 Foo，这可能表明您一开始就没有正确进行单元测试。

单元测试旨在在生产代码运行的相同环境下进行测试，因此我建议在您的测试中重新创建相同的生产环境。否则，您的测试将不完整。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T18:18:44.217

如果返回的变量`getX()`不是`final`，您可以使用[单元测试私有方法的最佳方法是什么？](https://stackoverflow.com/questions/34571/whats-the-best-way-of-unit-testing-private-methods/34658#34658)用于通过 改变`private`变量的值`Reflection`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T11:30:34.297

```
public class Bar extends Foo{
  public int process(){
    Object value = getX();
    return process2(value);
  }
  public int process2(Object value){
  ...
  }
}

public class BarTest extends TestCase{
  public testProcess(){
    Bar bar = new Bar();   
    Mockobj mo = new Mockobj();     
    int result = bar.process2(mo);
    ...
  }
} 
```

我最终所做的是上述。这有点难看......詹姆斯的解决方案肯定比这好得多......

# c# - 这是一种设计模式吗？

> ID：748363
> 
> 赞同：5
> 
> 时间：2009-04-14T16:25:37.733
> 
> 标签：c#, design-patterns, oop

在我们的整个代码库中，我们都有这种重复的模式，其中有一个接口与一个方法。这是真正的设计模式吗？如果是这样，它是什么，有什么好处？

这里有一些例子：

```
 public interface IRunnable
    {       
        void Run();     
    }

    public interface IAction
    {
        void Perform();
    }

    public interface ICommand
    {
        void Execute(ActionArgs _actionargs);
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T16:27:32.877

我已经看到这被称为[命令模式](http://en.wikipedia.org/wiki/Command_pattern)。

我第一次了解它是阅读鲍勃叔叔的[*C# 中的敏捷原则、模式和实践*](https://rads.stackoverflow.com/amzn/click/com/0131857258)。

我相信它的优雅就是它的简单。我在编写文件处理服务时使用过它。该服务执行读取/删除文件的所有管理。当需要处理文件时，会加载相应的插件。每个插件都实现了一个`Process`方法，并执行处理该类型文件所需的一切。（主要是解析内容并插入数据库。）

每次我必须处理具有新布局的新文件类型时，我所要做的就是创建一个新的插件来实现`Process`.

这对我有用，因为我需要一个简单的解决方案。如果您需要接受多个参数，这可能不是要使用的模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T16:31:17.267

这些中的任何一个都可能是[Command Pattern](http://en.wikipedia.org/wiki/Command_pattern)的特定情况，具体取决于它的使用方式和上下文。这部分取决于您设置它的原因和方式。

命令模式通常还包括状态和各种对象的概念。通常，这种类型的接口会暗示这一点，所以我猜这就是您在这里所认为的设计模式，但是如果没有调用者或多个目标，很难判断这是否是它的经典示例。 ..

然而，这本身对我来说只是基本的接口抽象，而不是我归类为设计模式的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T16:35:11.563

据说它是一种[命令设计模式](http://en.wikipedia.org/wiki/Command_pattern)。但它（就我而言）更像是实现结果的 Java 方式。在 C# 中，您可以使用委托以及在 C++ 函数指针和仿函数中。

如果您已经在某个 Class 方法中实现了一些反应，那么创建越来越多的类没有多大意义。您可以在 C++ 中绑定或在 C# 中设置为委托。在 Java 中，我想您别无选择，只能编写您找到的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T16:31:44.893

我不确定您是否可以将其称为设计模式，因为您提供的接口并未提供常见问题的解决方案，而是为您正在开发的项目中非常具体的问题提供解决方案。

您正确使用接口的原因是因为您不能让所有需要这些方法的类扩展包含这些方法的基类，但您需要知道特定类承诺实现这些。

可能是，正如之前的一些海报所建议的那样：[http ://en.wikipedia.org/wiki/Command_pattern](http://en.wikipedia.org/wiki/Command_pattern)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T16:31:46.203

您可以使用 lambda 表达式删除此重复（或防止其用于将来的代码）。Lambda 表达式正是针对这种情况的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T16:32:00.417

如果有的话，那么它就是一个函子。它用于没有第一类函数（指针）的语言中，用于函数（指针）的用途，例如线程的主函数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-14T16:32:21.197

接口的应用程序只有一种方法。我的意思是，在 .NET 中有很多 - INotifyPropertyChanged，其中之一（PropertyChanged 事件）。它只是保证一个对象有一个特定的方法（不管它实际上是什么类型的对象），所以你可以调用它（同样，不管类型）。

```
Dim runnableObjects As List(Of Object)
runnableObjects.Add(New MyRunnableObject1)
runnableObjects.Add(New MyRunnableObject2)

For Each o As IRunnable In runnableObjects
  o.Run()
Next 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-14T16:58:11.600

也许我遗漏了一些东西，但前两个看起来可能是[策略模式](http://www.dofactory.com/Patterns/PatternStrategy.aspx)的一部分。基本上，一个对象有一个 IAction 类型的成员，并且该成员在运行时根据系统的需要被分配/重新分配，以便以特定方式（即使用特定策略）执行任务。

# java - 如何进行多模块弹簧配置？

> ID：748377
> 
> 赞同：24
> 
> 时间：2009-04-14T16:30:28.703
> 
> 标签：java, spring

我有一个多模块（Maven）弹簧构建。所有模块都发布了一些 bean，并且大多数模块还使用了在依赖关系图中进一步定义的 bean。虽然大部分是注解声明的 bean，但几乎每个模块也有一两个 xml 声明的 bean。

虽然我们有一个半体面的解决方案，但我真的想知道在这种情况下组织 xml 文件的正确/最佳方式是什么？您是在模块之间使用导入还是有其他方式？你是把所有的 xml 文件放在一个地方还是根据依赖关系图分散它们？您的解决方案如何处理部分 spring 上下文（典型的集成测试）？

我还希望以一种可以让我最佳地利用我的 IDE 的 spring 支持（IDEA 和一些 Eclipse 用户）的方式来组织它。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-23T08:02:11.327

我们在模块中使用通配符导入来允许其他模块向声明导入的模块贡献 bean：

```
<import resource="classpath*:com/acme/**/*-core-support.xml" /> 
```

## 模块化

在这种情况下，想要为“主机”做出贡献的模块只需放置一个正确命名的文件`src/main/resources/com/acme`即可自动拾取。如果您使用类路径扫描（通过`<context:component-scan />`它会变得更加容易）。

在这方面有帮助的另一件事是一些小的 Spring 扩展，它可以拾取给定类型的 bean 并再次重新发布它们`ApplicationContext`。通过做这样的事情：

```
<plugin:list id="beanList" class="com.acme.MyCoolPluginInterface" />

<bean class="com.acme.MyPluginHost">
   <property name="plugins" ref="beanList" />
</bean> 
```

结合通配符导入，这将：

1.  收集在`ApplicationContext`该实现中找到的所有 bean，`MyCoolPluginInterface`并将它们包装在一个注册`beanList`为`ApplicationContext`.
2.  允许`MyPluginHost`引用该列表。

事实上，您现在可以通过将插件模块添加到类路径（在 Maven 中也称为依赖项）来简单地扩展您的应用程序。

这个微小的 Spring 扩展称为 Spring Plugin，并在 Apache 2 许可下发布。有关更多信息，请参阅[http://github.com/SpringSource/spring-plugin](http://github.com/SpringSource/spring-plugin)。Github上还有一个更高级的[示例项目](https://github.com/olivergierke/Whoops-Architecture/tree/master/plugins-sample)，它展示了它是如何工作的，并在 GitHub 上改进了模块化。该应用程序是我的“哎呀！我的架构去哪儿了？”的示例代码。演示文稿，您可以在此处查看[幻灯片](https://speakerdeck.com/olivergierke/whoops-where-did-my-architecture-go-1)或在此处观看[录音](http://www.youtube.com/watch?v=s9LJG6olxI4)。

## 不同的环境

通常我们将应用程序配置为在目标环境中运行（使用 JNDI 查找等）。当然，您希望使用标准`PropertyPlaceholderConfigurer`机制来外部化管理员必须接触或将在各种环境中更改的配置。

对于集成测试，我们通常会在普通配置文件之外`src/main/test`加载*额外的配置文件，**覆盖*将配置绑定到环境的关键 bean。例如，如果您的普通配置文件中有数据源

```
 <jee:jndi-lookup id="dataSource" jndi-name="jdbc/MyDataSource" /> 
```

你会`test-context.xml`通过使用覆盖它

```
 <bean id="dataSource" class="...DataSource" />
    <!-- config -->
 </bean> 
```

并在测试类中的原始文件*之后*导入它

```
 @ConfigurationContext(locations = {"app-context.xml", "test-context.xml"})
 public FooBarIntegrationtest {
   // ...
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T16:55:36.180

我们只需根据使用情况从多个 XML 配置文件创建应用程序上下文。

例如，对于没有服务器的测试，上下文是通过使用每个服务模块中的所有配置文件来创建的。

部署后，我们通过 Spring Remoting 访问服务，因此客户端使用通过 XML 配置初始化的应用程序上下文，该配置定义了启用远程处理的代理 bean。同时，服务由测试用例使用的相同 XML 文件配置，但应用程序上下文现在由 DispatcherServlet 或 EJB 或 MDB 加载。

此设置允许我们为每个场景定制应用程序上下文，而无需在配置文件中复制任何信息，从而使维护更加简单。此外，通过导入在配置文件之间没有硬依赖，因为这是在实际创建 ApplicationContext 的上层处理的。

无法评论 IDE 支持，因为我们还没有使用它。

# c# - 如何在C#中删除不在堆栈顶部的堆栈项

> ID：748387
> 
> 赞同：37
> 
> 时间：2009-04-14T16:32:05.597
> 
> 标签：c#, stack

不幸的是，一个项目只能通过“pop”从堆栈中删除。堆栈没有“删除”方法或类似的东西，但我有一个堆栈（是的，我需要一个堆栈！），我需要从中删除一些元素。

这样做有诀窍吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-04-14T16:35:07.773

如果您需要删除不在顶部的项目，那么您需要的不是堆栈。

尝试从列表中实现自己的堆栈。然后您可以实现自己的推送和弹出功能（在列表中添加和删除），以及您自己的特殊 PopFromTheMiddle 功能。

例如

```
public class ItsAlmostAStack<T>
{
    private List<T> items = new List<T>();

    public void Push(T item)
    {
        items.Add(item);
    }
    public T Pop()
    {
        if (items.Count > 0)
        {
            T temp = items[items.Count - 1];
            items.RemoveAt(items.Count - 1);
            return temp;
        }
        else
            return default(T);
    }
    public void Remove(int itemAtPosition)
    {
        items.RemoveAt(itemAtPosition);
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-14T16:35:18.257

考虑使用不同的容器。也许是一个链表。然后你可以使用

```
添加优先
最后添加
删除最后一个
删除优先
```

就像从堆栈中弹出/推送一样，您可以使用

```
消除
```

从列表中间删除任何节点

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-10T04:35:59.067

您可以使用[LinkedList](http://msdn.microsoft.com/en-us/library/he2s3bh7.aspx)

基于列表的删除可能效率较低。在通过引用删除基于列表的堆栈将有 O(N) 搜索和 O(N) 调整大小。LinkedList 搜索是 O(N)，删除是 O(1)。对于按索引删除，LinkedList 应该有 O(N) 遍历和 O(1) 删除，而 List 将有 O(1) 遍历（因为它是索引）和由于调整大小而导致 O(N) 删除。

除了效率之外，LinkedList 实现将使您保留在标准库中，从而使您的代码具有更大的灵活性并减少您编写的代码。

这应该能够处理 Pop、Push 和 Remove

```
 public class FIFOStack<T> : LinkedList<T>
    {
        public T Pop()
        {
            T first = First();
            RemoveFirst();
            return first;
        }

        public void Push(T object)
        {
            AddFirst(object);
        }

        //Remove(T object) implemented in LinkedList
   } 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-14T16:45:22.583

也许扩展方法会起作用，但我怀疑确实需要完全不同的数据结构。

```
public static T Remove<T>( this Stack<T> stack, T element )
{
     T obj = stack.Pop();
     if (obj.Equals(element))
     {
         return obj;
     }
     else
     {
        T toReturn = stack.Remove( element );
        stack.Push(obj);
        return toReturn;
     }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-14T16:38:01.400

在真正的堆栈中，这只能通过一种方式完成 -

弹出所有项目，直到删除您想要的项目，然后以适当的顺序将它们推回堆栈。

但是，这不是很有效。

如果你真的想从任何位置删除，我建议从 List、LinkedList 或其他集合构建一个伪堆栈。这将使您可以轻松地执行此操作。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-14T16:36:45.397

那么它不是堆栈吗？堆栈是`LAST in FIRST out`. 您将不得不编写一个自定义的或选择其他的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-14T16:37:52.603

```
 Stack temp = new Stack();
   object x, y;
   While ((x = myStack.Pop()) != ObjectImSearchingFor)
       temp.Push(x);
   object found = x;
   While ((y = temp.Pop()) != null)
      myStack.Push(y); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-05-03T17:15:18.183

我在多毛情况下使用的一个技巧是在堆栈中的项目中添加一个“不推荐使用”标志。当我想“删除”一个项目时，我只需升起该标志（并清理该对象占用的任何资源）。然后，当 Pop() 处理项目时，我只需检查标志是否被提升，然后在循环中再次弹出，直到找到未弃用的项目。

```
do 
{  
   obj = mQueue.Pop();  
} while (obj.deprecated); 
```

您可以管理自己的项目计数以了解队列中仍有多少“真实”项目，如果多线程解决方案需要，显然应该使用锁定。

我发现对于不断流经它们的队列 - 推送和弹出的项目 - 以这种方式处理它会更有效，它是你可以获得的最快的（支付 O(1) 从中间删除一个项目）和内存明智如果保留的对象很小，那么项目是否以合理的速度流动几乎是无关紧要的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-02-02T10:30:44.027

Stack<> 的构造函数将 IEnumerable<> 作为参数。因此可以执行以下操作：

```
myStack = new Stack<item>( myStack.Where(i => i != objectToRemove).Reverse() ); 
```

这在许多方面都是非性能的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-14T16:38:00.433

嗯......我同意前两个答案，但如果你想破解你的方式，只需弹出并保存所有元素，直到你找到你想要的，然后重新推送它们

是的，是丑陋的，性能不佳的，可能是奇怪的代码，需要很长的注释来解释原因，但你可以做到......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-03-06T19:00:09.407

我遇到了这个问题。在我的代码中，我创建了自己的扩展方法：

```
public static class StackExtensions
{
    public static void Remove<T>(this Stack<T> myStack, ICollection<T> elementsToRemove)
    {
        var reversedStack = new Stack<T>();

        while(myStack.Count > 0)
        {
            var topItem = myStack.Pop();
            if (!elementsToRemove.Contains(topItem))
            {
                reversedStack.Push(topItem);
            }
        }

        while(reversedStack.Count > 0)
        {
            myStack.Push(reversedStack.Pop());
        }           
    }
} 
```

我这样称呼我的方法：

```
var removedReportNumbers = 
selectedReportNumbersInSession.Except(selectedReportNumbersList).ToList();

selectedReportNumbersInSession.Remove(removedReportNumbers); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-08-05T01:59:19.663

我使用了一个列表并添加了一些扩展方法，例如，

```
public static IThing Pop(this List<IThing> list)
{
  if (list == null || list.Count == 0) return default(IThing);

  // get last item to return
  var thing = list[list.Count - 1];
  // remove last item
  list.RemoveAt(list.Count-1);

  return thing;
}

public static IThing Peek(this List<IThing> list)
{
  if (list == null || list.Count == 0) return default(IThing);

  // get last item to return
  return list[list.Count - 1];
}

public static void Remove(this List<IThing> list, IThing thing)
{
  if (list == null || list.Count == 0) return;
  if (!list.Contains(thing)) return;

  list.Remove(thing); // only removes the first it finds
}

public static void Insert(this List<IThing> list, int index, IThing thing)
{
  if (list == null || index > list.Count || index < 0) return;

  list.Insert(index, thing);
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-04-01T15:44:32.820

这仍然处理整个堆栈，但它是删除条目的替代方法。但是，按照这种方式编写，如果同一条目在堆栈中多次出现，它将全部删除。

```
using System.Collections.Generic;

namespace StackTest
{
    class Program
    {
        static void Main(string[] args)
        {
            Stack<string> stackOne = new Stack<string>();

            stackOne.Push("Five");
            stackOne.Push("Four");
            stackOne.Push("Three");
            stackOne.Push("Two");
            stackOne.Push("One");

            deleteStackEntry(stackOne, @"Three");
            deleteStackEntry(stackOne, @"Five");
        }
        static void deleteStackEntry(Stack<string> st, string EntryToDelete)
        {
            // If stack is empty
            if (st.Count == 0) return;

            // Remove current item 
            string currEntry = st.Pop();

            // Remove other items with recursive call
            deleteStackEntry(st, EntryToDelete);

            // Put all items back except the one we want to delete 
            if (currEntry != EntryToDelete)
                st.Push(currEntry);
        }
    }
} 
```

# xml - 将（Sql Server）xml 列与实体框架一起使用

> ID：748391
> 
> 赞同：17
> 
> 时间：2009-04-14T16:32:46.983
> 
> 标签：xml, entity-framework, sql-server-2008

有没有人尝试将 xml 类型的列与 Entity Framework 一起使用？实体返回一个字符串。

当表列是 XML 类型时，下一版本的 Entity Framework 是否支持 XElement 类型。

问候。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T05:10:21.837

实体框架将 XML 列内容（输入或不输入）作为字符串返回，因此它无法从 xml 文档内容（它的节点）创建实体......如果您仍然好奇阅读这篇文章，它为您的问题提供了可能的解决方案..我没试过（[链接文本](http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/58c1b27d-3274-4942-962c-06ff0671661b/)）

回答 Marc 的最后一个问题..我希望在 EF 的下一个版本中看到将 xml 文档内容映射为实体的可能性，就像它对普通表和它们之间的关系所做的那样.. 或者至少使部分xml 文档作为实体中的属性..

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-05-12T00:00:39.890

这就是我现在正在做的事情，我正在向与我的模型匹配的部分类添加一个方法，该模型具有一个 .Data 属性作为字符串。

本质上你有调用 instance.UseData((data) => { ... });

从那里，您可以在 lambda 表达式中读取/操作数据并将其保存回数据库的原始字段...我希望能够为此创建一个属性，该属性绑定到一个事件以更新相关领域。

我将更多动态结构作为 XML 推入 Data 字段中……这在 VB.Net 中比 C# 更自然……如果我的项目是在 C# 中，我可能倾向于使用 JSON……

**C＃**

```
public void UseData(Action<XElement> editor)
{
    var def = XElement.Parse("<Data></Data>");
    XElement data;
    try
    {
        if (String.IsNullOrWhiteSpace(this.Data))
        {
            data = def;
        }
        else
        {
            data = XElement.Parse(this.Data);
        }
    }
    catch (Exception ex)
    {
        data = def;
    }
    editor(data);
    this.Data = data.ToString();
} 
```

**VB.Net**

```
Public Sub UseData(editor As Action(Of XElement))
    Dim def = <Data></Data>
    Dim data As XElement
    Try
        If String.IsNullOrWhiteSpace(Me.Data) Then
            data = def
        Else
            data = XElement.Parse(Me.Data)
        End If
    Catch ex As Exception
        data = def
    End Try
    editor(data)
    Me.Data = data.ToString()
End Sub 
```

# mysql - 使用 Rails + MySql 最佳实践的 Web 服务

> ID：748396
> 
> 赞同：0
> 
> 时间：2009-04-14T16:34:52.610
> 
> 标签：mysql, ruby-on-rails, service

好吧，我需要一些 Rails 人员的建议和最佳实践。

我对这个平台还很陌生，但我之前用 Java 做过数据库支持的 Web 开发工作。在这一点上，我已经完成了大约 20 个教程，并且我一直在同一个地方受到阻碍。

这是我所做的和我正在经历的。我创建了一个新的应用程序

```
rails my_rails_app 
```

我在 MySQL 中创建了架构和表，并为 rails (rails_root/pass1234) 创建了一个帐户，并更新了 config/databases.yml 以反映新帐户：

```
development:
    adapter: mysql
    encoding: utf8
    reconnect: false
    database: demo_development
    username: rails_root
    password: pass1234
    host: localhost 
```

此时，我为“客户”表生成脚手架：

```
ruby script/generate scaffold customer 
```

哪个成功返回。所以现在我们启动服务器：

```
ruby script/server 
```

它将引导 Mongrel 并按预期在本地计算机上的 3000 端口启动服务器。将浏览器定向到[http://localhost:3000/customers](http://localhost:3000/customers)后，页面正确显示“列出客户”，但**没有列出任何字段**。当我按下“新客户”的链接时，**仍然**没有要修改的字段，但我可以创建一个空的客户记录。由于此操作在所有字段（其中一些不可为空）中放置“空值”，因此会引发 Mysql 错误——“列 'name' 不能为空”，它试图运行的 SQL 查询。

我很困惑，主要是因为如果它当时正在接收我的字段，为什么它不早点显示它们？显然它正在连接到正确的数据库并识别出正确的表。这是怎么回事？

现在，另一方面，如果我在启动服务器之前将条目放入表中，页面现在会在“列出客户”标题下方显示“显示”、“编辑”和“销毁”链接选项。但是，不会反映任何字段或数据。如果我点击“销毁”，表中的记录确实被销毁了。但是我仍然没有看到由 rails 生成的网页上的任何记录或字段，除非它是错误消息。

这是我的生成脚手架命令的输出：

```
\ROR\my_app>ruby script/generate scaffold contact
      exists  app/models/
      exists  app/controllers/
      exists  app/helpers/
      create  app/views/contacts
      exists  app/views/layouts/
      exists  test/functional/
      exists  test/unit/
      create  test/unit/helpers/
      exists  public/stylesheets/
      create  app/views/contacts/index.html.erb
      create  app/views/contacts/show.html.erb
      create  app/views/contacts/new.html.erb
      create  app/views/contacts/edit.html.erb
      create  app/views/layouts/contacts.html.erb
      create  public/stylesheets/scaffold.css
      create  app/controllers/contacts_controller.rb
      create  test/functional/contacts_controller_test.rb
      create  app/helpers/contacts_helper.rb
      create  test/unit/helpers/contacts_helper_test.rb
       route  map.resources :contacts
  dependency  model
      exists    app/models/
      exists    test/unit/
      exists    test/fixtures/
      create    app/models/contact.rb
      create    test/unit/contact_test.rb
      create    test/fixtures/contacts.yml
      create    db/migrate
      create    db/migrate/20090414185634_create_contacts.rb 
```

以下是生成的主要文件：

应用\控制器\contacts_controller.rb

```
class ContactsController < ApplicationController
  # GET /contacts
  # GET /contacts.xml
  def index
    @contacts = Contact.all

    respond_to do |format|
      format.html # index.html.erb
      format.xml  { render :xml => @contacts }
    end
  end

  # GET /contacts/1
  # GET /contacts/1.xml
  def show
    @contact = Contact.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @contact }
    end
  end

  # GET /contacts/new
  # GET /contacts/new.xml
  def new
    @contact = Contact.new

    respond_to do |format|
      format.html # new.html.erb
      format.xml  { render :xml => @contact }
    end
  end

  # GET /contacts/1/edit
  def edit
    @contact = Contact.find(params[:id])
  end

  # POST /contacts
  # POST /contacts.xml
  def create
    @contact = Contact.new(params[:contact])

    respond_to do |format|
      if @contact.save
        flash[:notice] = 'Contact was successfully created.'
        format.html { redirect_to(@contact) }
        format.xml  { render :xml => @contact, :status => :created, :location => @contact }
      else
        format.html { render :action => "new" }
        format.xml  { render :xml => @contact.errors, :status => :unprocessable_entity }
      end
    end
  end

  # PUT /contacts/1
  # PUT /contacts/1.xml
  def update
    @contact = Contact.find(params[:id])

    respond_to do |format|
      if @contact.update_attributes(params[:contact])
        flash[:notice] = 'Contact was successfully updated.'
        format.html { redirect_to(@contact) }
        format.xml  { head :ok }
      else
        format.html { render :action => "edit" }
        format.xml  { render :xml => @contact.errors, :status => :unprocessable_entity }
      end
    end
  end

  # DELETE /contacts/1
  # DELETE /contacts/1.xml
  def destroy
    @contact = Contact.find(params[:id])
    @contact.destroy

    respond_to do |format|
      format.html { redirect_to(contacts_url) }
      format.xml  { head :ok }
    end
  end
end 
```

app\views\contacts\index.html.erb

```
<h1>Listing contacts</h1>

<table>
  <tr>
  </tr>

<% @contacts.each do |contact| %>
  <tr>
    <td><%= link_to 'Show', contact %></td>
    <td><%= link_to 'Edit', edit_contact_path(contact) %></td>
    <td><%= link_to 'Destroy', contact, :confirm => 'Are you sure?', :method => :delete %></td>
  </tr>
<% end %>
</table>

<br />

<%= link_to 'New contact', new_contact_path %> 
```

app\views\contacts\show.html.erb

```
<%= link_to 'Edit', edit_contact_path(@contact) %> |
<%= link_to 'Back', contacts_path %> 
```

app\views\contacts\new.html.erb

```
<h1>New contact</h1>

<% form_for(@contact) do |f| %>
  <%= f.error_messages %>

  <p>
    <%= f.submit 'Create' %>
  </p>
<% end %>

<%= link_to 'Back', contacts_path %> 
```

应用\视图\联系人\edit.html.erb

```
<h1>Editing contact</h1>

<% form_for(@contact) do |f| %>
  <%= f.error_messages %>

  <p>
    <%= f.submit 'Update' %>
  </p>
<% end %>

<%= link_to 'Show', @contact %> |
<%= link_to 'Back', contacts_path %> 
```

任何（进一步的）建议将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T19:47:06.500

我相信如果您在创建脚手架时指定它们，Rails 只会为它在脚手架中创建的视图添加字段，即“ `script/generate scaffold post title:string body:text published:boolean`”（顺便说一下，这也会为相关表创建数据库迁移）。我认为它不会在搭建脚手架期间对数据库进行任何检查，但我还没有深入研究脚手架生成代码以绝对确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T19:24:15.587

您是否为联系人模型编写了迁移？

Rails 直接从数据库中读取字段，并根据表上的内容动态生成属性。如果你只是运行脚手架生成器，迁移仍然是空的。编写迁移后，您可以运行迁移，`rake db:migrate`然后我相信这些字段应该显示在脚手架中。

然而，我已经很久没有接触过脚手架了。恕我直言，它们仅在您第一次学习 Rails 时才有用，应该尽早放弃使用它们。

# c# - 有 CapitalizeFirstLetter 方法吗？

> ID：748411
> 
> 赞同：9
> 
> 时间：2009-04-14T16:38:30.727
> 
> 标签：c#, .net, string

有没有办法做到这一点？可以用扩展方法来完成吗？

我想实现这一点：

```
string s = "foo".CapitalizeFirstLetter();
// s is now "Foo" 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-14T16:39:46.857

一个简单的扩展方法，它将大写字符串的第一个字母。正如 Karl 指出的那样，这假设第一个字母是正确的更改，因此不是完全文化安全的。

```
public static string CapitalizeFirstLetter(this String input)
{
    if (string.IsNullOrEmpty(input)) 
        return input;

    return input.Substring(0, 1).ToUpper(CultureInfo.CurrentCulture) +
        input.Substring(1, input.Length - 1);
} 
```

您还可以使用[System.Globalization.CultureInfo.CurrentCulture.TextInfo.ToTitleCase](http://msdn.microsoft.com/en-us/library/system.globalization.textinfo.totitlecase.aspx)。该函数会将**每个单词**的第一个字符转换为大写。因此，如果您的输入字符串是`have fun`结果将是`Have Fun`.

```
public static string CapitalizeFirstLetter(this String input)
{
     if (string.IsNullOrEmpty(input)) 
         return input;

     return CultureInfo.CurrentCulture.TextInfo.ToTitleCase(input);
} 
```

有关更多信息，请参阅[此问题](https://stackoverflow.com/questions/72831/how-do-i-capitalize-first-letter-of-first-name-and-last-name-in-c)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-14T16:44:52.007

[System.Globalization.CultureInfo.CurrentCulture.TextInfo.ToTitleCase](http://msdn.microsoft.com/en-us/library/system.globalization.textinfo.totitlecase.aspx)

它具有文化安全的优势。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T17:41:35.577

试试这个：

```
static public string UpperCaseFirstCharacter(this string text) {
    return Regex.Replace(text, "^[a-z]", m => m.Value.ToUpper());
} 
```

# java - 将比较器从 C# 移植到 Java

> ID：748417
> 
> 赞同：1
> 
> 时间：2009-04-14T16:39:02.927
> 
> 标签：java, c#, porting

我正在尝试将这些小的数学调用从 C# 转换为 Java，并且只是想确保它们以相同的方式运行。我添加了一个额外的调用，因为它在 Java 中不受支持。

**这是C#中的代码**

```
public override int CompareTo(object a)
{
EquationGenome Gene1 = this;
EquationGenome Gene2 = (EquationGenome)a;
return Math.Sign(Gene2.CurrentFitness  -  Gene1.CurrentFitness);
} 
```

* * *

**爪哇：**

注意 Math.Sign 没有被调用。

```
/**
* Compare to.
*/
public int compareTo(final Object a) {

    final EquationGenome gene1 = this;
    final EquationGenome gene2 = (EquationGenome) a;
    return (int) ((-1.0) * (gene2.currentFitness - gene1.currentFitness));
} 
```

这是在 Java 中使用两个 int 参数复制 C# 的“下一个”的方法：

```
public static final int nextInt(final Random r, final int min, final int max) {

    final int diff = max - min;
    final int n = r.nextInt(diff);
    return n + min;

} 
```

这些方法从 C# 到 Java 是否等效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T16:54:37.960

为什么不直接使用 Java 的 compareTo？这是假设 currentFitness 是 Integer 类型而不是原始类型 int。否则，您可以将其包装在 Integer 中。这不是最有效的方法，但对我来说更清楚。

```
/**
* Compare to.
*/
public int compareTo(final Object a) {

    final EquationGenome gene1 = this;
    final EquationGenome gene2 = (EquationGenome) a;
    return gene1.currentFitness.compareTo(gene2.currentFitness);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T16:50:22.837

不，因为 C# 中的 Math.Sign 返回三个值之一：如果值 < 0，则返回 -1，如果值等于 0，则返回 0，如果值大于 0，则返回 1。它不会将符号翻转正如您在 Java 代码中所做的那样乘以 -1。

在 C# 中，CompareTo 函数期望 -1 表示调用它的对象小于传入的对象。由于您要返回从值 2 中减去值 1 的符号，因此这将被切换。鉴于您的 Java 代码，我怀疑这是否是您想要的算法。传统上，您会从值 1 中减去值 2 并使用该符号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T17:10:06.597

如果您的 Java 版本`EquationGenome`实现了该[`Comparable`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Comparable.html)接口，您将能够利用许多[Java API](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/class-use/Comparable.html)。这会将您的课程更改为如下所示：

```
final class EquationGenome
  implements Comparable<EquationGenome>
{
  ...
  public int compareTo(final EquationGenome gene2) ... 
```

然后，你用乘法做什么还不清楚。我假设“自然顺序”是从最合适到最不合适。然后我会像这样实现比较：

```
public int compareTo(final EquationGenome that) {
  if (currentFitness == that.currentFitness) {
    /* TODO: Add more tests if there are other properties that distinguish
     * one EquationGenome from another (secondary sort keys). */
    return 0;
  } else 
    return (currentFitness > that.currentFitness) ? -1 : +1;
} 
```

按照惯例，您应该将方法[实现为`equals`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Comparable.html#compareTo(T))与您的方法[“一致”](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Comparable.html#compareTo(T))`compareTo`，或者清楚地记录您的类以注意不一致之处。如果你实现了`equals`，你也应该[实现`hashCode`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html#hashCode())一致性。

```
public boolean equals(Object o) {
  return o instanceof EquationGenome && compareTo((EquationGenome) o) == 0;
}

public int hashCode() {
  return currentFitness;
} 
```

* * *

产生随机数的方法是可以的，只要你明白[`max`排除在外即可；](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Random.html#nextInt(int))该方法从半开区间生成随机数`(min, max]`。如果要包含`max`在范围内，请在`diff`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T19:37:14.173

我会写类似的东西。

注意：使用带有可变字段的 Comparator 时要非常小心，因为这可能会产生不良的副作用。

```
public class EquationGenome implenents Comparable<EquationGenome> {
    private final double currentFitness;
    public EquationGenome(double currentFitness) {
        this.currentFitness = currentFitness;
    }

    public int compareTo(EquationGenome eg) {
        return Double.compareTo(currentFitness, eg.currentFitness);
    }
} 
```

# xml - 是否可以使用 XSLT 翻转和旋转文本？

> ID：748423
> 
> 赞同：4
> 
> 时间：2009-04-14T16:40:37.137
> 
> 标签：xml, xslt

我想获取 XML 标记的内容，并在通过样式表查看时将其水平（镜像）和垂直（作为一列）翻转显示。如果不使用随机的第三方库，这可能吗？

```
<mytag>Random Data</mytag> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T17:05:40.710

因此，XSLT 不适合字符串处理。使用 XSLT 2.0，情况会变得更好，因为有更多的字符串函数可用，并且基于序列的操作是可能的。

在 XSLT 1.0（它仍然是编写代码最便携的版本）中，只能通过递归来实现逐个字符的字符串处理。为了它的乐趣，这个：

```
<xsl:output method="text" />

<xsl:variable name="CRLF" select="'&#13;&#10;'" />

<xsl:template match="/mytag">
  <!-- flip string -->
  <xsl:call-template name="reverse-string">
    <xsl:with-param name="s" select="string(.)" />
  </xsl:call-template>
  <xsl:value-of select="$CRLF" />

  <!-- vertical string -->
  <xsl:call-template name="vertical-string">
    <xsl:with-param name="s" select="string(.)" />
  </xsl:call-template>
</xsl:template>

<xsl:template name="reverse-string">
  <xsl:param name="s" select="''" />

  <xsl:variable name="l" select="string-length($s)" />

  <xsl:value-of select="substring($s, $l, 1)" />

  <xsl:if test="$l &gt; 0">
    <xsl:call-template name="reverse-string">
      <xsl:with-param name="s" select="substring($s, 1, $l - 1)" />
    </xsl:call-template>
  </xsl:if>
</xsl:template>

<xsl:template name="vertical-string">
  <xsl:param name="s" select="''" />

  <xsl:variable name="l" select="string-length($s)" />

  <xsl:value-of select="concat(substring($s, 1, 1), $CRLF)" />

  <xsl:if test="$l &gt; 0">
    <xsl:call-template name="vertical-string">
      <xsl:with-param name="s" select="substring($s, 2, $l)" />
    </xsl:call-template>
  </xsl:if>
</xsl:template> 
```

产生：

```
ataD modnaR
R
a
n
d
o
m

D
a
t
a 
```

编辑：要明确：我不支持以任何方式*实际使用*上述代码示例。表示问题应该在表示层中解决。以上方法可行，但逐字符递归是进行字符串处理的最低效的方法之一，除非您别无选择，否则请避免在 XSLT 中进行字符串处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T16:51:22.337

XSLT 用于转换。要更改演示文稿，您应该使用 CSS 或 XSL-FO。

在 XSL-FO 中，您可以设置[`writing-mode`为`tb-lr`](http://www.w3.org/TR/xsl11/#writing-mode)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T16:53:24.950

Vartec 是对的。我最终使用以下 CSS 完成了它：

```
.verticaltext {
  writing-mode: tb-rl;
  filter: flipv;
} 
```

谢谢！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T20:12:43.927

**[使用XPath 2.0](http://www.w3.org/TR/xpath20/) / [XSLT 2.0](http://www.w3.org/TR/xslt20/)****很容易做到这一点**（在[**XSLT 1.0**](http://www.w3.org/TR/xslt)中可以使用[**FXSL**](http://fxsl.sf.net) 1.x 的函数/模板）：

这两个任务都可以作为 XPath 2.0 表达式的结果生成：

**1.反转字符串：**

```
 codepoints-to-string(
           reverse(string-to-codepoints($vText))
                       ) 
```

**2.垂直化一个字符串：**

```
 replace($vText, '(.)', '$1&#xA;') 
```

我们要操作的字符串包含在变量中`$vText`。

**要查看实际情况，我们只需将上述 XPath 表达式放入 XSLT 2.0 样式表中**：

```
<xsl:stylesheet version="2.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xsl:output method="text"/>

  <xsl:variable name="vText" as="xs:string"
       select="'Random Data'"/>

  <xsl:variable name="vReversed" as="xs:string"
       select="codepoints-to-string(
                       reverse(string-to-codepoints($vText))
                                    )
               "
  />

  <xsl:variable name="vVertical" as="xs:string*"
       select="replace($vText, '(.)', '$1&#xA;')"/>

  <xsl:template match="/">
    <xsl:sequence select="$vReversed"/>
===================================
<xsl:text/>
    <xsl:sequence select="$vVertical"/>
  </xsl:template>
</xsl:stylesheet> 
```

**执行此转换时（无论是什么（如果有）XML 文档都无关紧要），就会产生想要的结果**: :)

```
ataD modnaR
===================================
R
a
n
d
o
m

D
a
t
a 
```

**请注意**以下标准 XPath 2.0 函数的使用：

*   [**`string-to-codepoints()`**](http://www.w3.org/TR/xpath-functions/#func-string-to-codepoints)和[**`codepoints-to-string()`**](http://www.w3.org/TR/xpath-functions/#func-codepoints-to-string)
*   [**`reverse()`**](http://www.w3.org/TR/xpath-functions/#func-reverse)
*   [**`replace()`**](http://www.w3.org/TR/xpath-functions/#func-replace)

# c# - JQuery 和不可见的选择 - JQuery

> ID：748424
> 
> 赞同：1
> 
> 时间：2009-04-14T16:40:39.537
> 
> 标签：c#, .net, asp.net, jquery

我有一个不可见设置为 false 的选择复选框。ASPX 看起来像这样：

```
<input name="selGR" id="selGR" type="checkbox" checked="checked" visible="false" runat="server" fieldname="GR"/> 
```

选择框甚​​至没有在 HTML 中呈现，这解释了为什么 JQuery 没有找到它。有没有解决的办法？

**编辑：设置风格有效！谢谢。我很想知道 .NET 框架在使用 visible="false" 呈现控件时是否遵循任何规则？对于所有控件，无论它们是服务器控件、自定义控件还是 html 控件，都遵循此规则吗？另外，设置样式而不是设置可见属性的任何副作用？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T16:46:38.087

您始终可以将显示属性设置为无。jQuery 届时将能够找到它。

```
<input type="checkbox" id="selGr" style="display:none" /> 
```

也供日后参考。$("#selGr").hide() & $("#selGr").show() 基本上使用了元素的显示属性。

我不相信“可见”是元素的属性。不过，可以在样式属性中设置可见性和显示。为了更好地了解可见性和隐藏之间的区别，请查看： http: [//www.devx.com/tips/Tip/13638](http://www.devx.com/tips/Tip/13638)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T16:56:29.437

**Visible**是一个asp.net 属性，设置为false 是要求服务器不要渲染控件。这就是为什么您的复选框不在 html 源代码中的原因。

将 html 显示样式属性更改为**none**是告诉资源管理器不要显示复选框，但是它仍然包含在源代码中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T16:45:38.480

使用“style='display: none'”而不是“visible='false'”。这样，它仍然会在呈现的 HTML 中供 JQuery 使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-06T12:06:21.730

这是您可以使用“显示：无”的选项，

但是如果你使用这个，那么你的控件每次都会在页面中呈现，如果你在 Firebug 中看到它，你会在那里找到你的控件，并且在 Visible=false 中不会发生这种情况

# visual-studio-2008 - 包含文件夹中所有文件的 Visual Studio 安装项目

> ID：748429
> 
> 赞同：5
> 
> 时间：2009-04-14T16:43:36.597
> 
> 标签：visual-studio-2008, deployment, installation, setup-project

我们有一个设置项目，当前添加了来自不同 Visual Studio 项目的项目输出。我们想更改打包系统并使用一个文件夹，其中包含一堆准备在设置中部署的部署文件。
但这意味着我们需要一个一个地添加文件，并在每个版本有新文件时继续添加它们。
我在这个[问题](https://stackoverflow.com/questions/498932/whats-the-easiest-way-to-install-100s-of-files-in-a-visual-studio-setup-project)中看到我们无法添加带有 *.aspx 等规则的文件。
所以我正在考虑创建一个小工具，它将根据可用文件更改 vdproj 文件。你能帮我看看这个文件的格式吗？似乎有一些与包含的每个文件相关联的 GUID。
有没有人对如何做到这一点有更好的解决方案？
我们目前还没有考虑使用不同的设置工具，我们只是寻找一个简单的文件打包解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-12-23T21:08:36.607

要添加整个文件夹，只需打开 Windows 资源管理器窗口，然后将要添加的所有文件拖到文件系统视图中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-02-26T14:25:27.073

我终于找到了解决这个问题的真正方法。我需要的是在构建时将给定外部目录（不是项目的一部分）中的所有文件添加到安装项目中，即如果将文件添加到该外部目录，它将自动包含在下一个版本的安装程序。

我所做的是我在解决方案（类库项目）中创建了一个新项目并从中删除了所有内容：Class1.cs、AssemblyInfo.cs 以及包含上述文件`<Compile>`元素的 csproj 文件的相关 ItemGroups 和`<Reference>`元素包括。

然后，我添加了一个新的 ItemGroup：

```
<ItemGroup>
  <Content Include="Path\To\The\Directory\**\*.*">
    <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
  </Content>
</ItemGroup> 
```

这样，这个新项目不包含任何文件，但它将所有文件（递归地，由`\**\`指示目录中的 指示）引用为*Content files*。

因此，在构建时，这些文件被视为*内容文件*，因此被复制到新项目的输出目录中。

那么，我为什么要做以上所有事情呢？只是因为，安装项目可以选择包含**来自另一个项目的内容文件！**

因此，通过这种方式，您可以使任意外部文件成为解决方案的“一部分”，而无需实际列出它们，文件列表在*build time*进行评估，然后从 Setup 项目中引用它们。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-19T18:14:01.467

这个问题似乎没有简单的解决方案。我们最终更改了设置工具并使用 Advanced Installer 来创建设置，它有一个很好的功能，可以同步文件夹内的文件以进行部署。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-10-29T22:29:47.633

我们遇到了同样的问题。您不能拖放.. 但是您可以在 Windows 资源管理器中转到您想要的内容，复制项目（可以包括子文件夹），然后返回 VS Installer 并粘贴这些（例如应用程序文件夹）。

笔记。如果您需要创建自定义文件夹（例如 c:\html），您也可以使用此方法，但您必须先在左侧窗格中创建自定义文件夹（指定绝对路径作为目标），然后再次转到左侧窗格并粘贴。

此方法适用于打包一组文件夹，但不会同步可能具有不同内容的文件夹！如果部署之间的内容发生变化，您必须重新复制/粘贴以使安装程序文件包含所有内容！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T17:40:33.357

您可以使用宏添加文件夹中的所有文件吗？

另外，也许您可​​以只清除安装项目中的文件（使用宏或加载项）并使用相同的方法将文件添加到文件夹中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-11T09:27:24.167

您可以右键单击资源管理器中的文件夹并单击复制，然后右键单击安装项目中文件系统视图中的文件夹并单击粘贴。拖放对我不起作用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-12-03T02:49:54.303

我有同样的问题。虽然不是理想的解决方案，但我的一个想法是拥有一个将文件压缩起来的批处理文件，然后我的安装项目只是分发该 zip。之后，您必须在安装后解压缩它们。

或者，您可以编写一个小应用程序将它们压缩成一个文件，并在应用程序第一次运行时解压缩它们。基本上一样的解决方案，只是你自己写，所以不需要使用第三方解压工具，安装过程更干净一些。

我想我实际上很快就会为我的项目执行后一种解决方案，因为我也没有考虑为更好的安装应用程序支付大笔费用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-30T12:55:52.593

哦，不，您可以将文件和文件夹**拖放**到 vs 中的设置目录

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-19T00:43:24.397

以下工作完美：只需将文件夹拖放到安装目录（使用 Windows 资源管理器而不是解决方案资源管理器）。然后它将添加其中的所有文件和所有子文件夹。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2019-03-26T14:55:19.003

1.  您可以在 Windows 资源管理器中右键单击文件夹（需要复制）并单击 Ctrl+A 或选择所有文件并单击复制。
2.  在 FileSystem 编辑器中，导航到左侧。然后右键单击应用程序文件夹并单击添加并选择文件夹。
3.  为文件夹命名
4.  在文件系统编辑器的右侧，右键单击并选择粘贴
5.  该文件夹的所有内容将被复制到步骤 2 中新创建的文件夹中。

有关详细信息，请参阅以下链接 [https://dzone.com/articles/creating-msisetup-package-c](https://dzone.com/articles/creating-msisetup-package-c)

# shell - make 中的 Shell 状态码

> ID：748445
> 
> 赞同：19
> 
> 时间：2009-04-14T16:48:26.493
> 
> 标签：shell, makefile

在重构 Python 脚本时，我使用 Makefile（在 Linux 下运行 GNU make）来自动化我的繁重工作。该脚本创建一个输出文件，我想确保输出文件在面对我的重构时保持不变。

但是，我发现无法获取命令的状态代码来影响后续的 shell if 命令。

下面的规则说明了这个问题：

```
check-cond-codes:
    diff report2008_4.csv report2008_4.csv-save-for-regression-testing; echo no differences: =$$!=
    diff -q poalim report2008_4.csv; echo differences: =$$!= 
```

第一个 'diff' 比较两个相同的文件，第二个比较两个不同的文件。输出是：

```
diff report2008_4.csv report2008_4.csv-save-for-regression-testing; echo no differences: =$!=
no differences: ==
diff -q poalim report2008_4.csv; echo differences: =$!=
Files poalim and report2008_4.csv differ
differences: == 
```

所以很明显'$$！' 是捕获“差异”状态代码的错误变量。即使在 Makefile 的开头使用 SHELL := /bin/bash 也不能解决问题。

一个返回我需要的值的变量（如果它存在的话）将在真实规则的“if”命令中使用。

创建一个小的临时 shell 脚本来代替在 Makefile 中编写所有内联命令的替代方法是不可取的，但我将使用它作为最后的手段。

有关的：

*   [如何使失败的 shell 命令中断](https://stackoverflow.com/questions/225542/how-to-make-a-failing-shell-command-interrupt-make)

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-14T17:01:49.987

我认为您正在寻找`$?`shell 变量，它给出了上一个命令的退出代码。例如：

```
$ diff foo.txt foo.txt
$ echo $?
0 
```

要在您的 makefile 中使用它，您必须转义`$`，如`$$?`：

```
all:
    diff foo.txt foo.txt ; if [ $$? -eq 0 ] ; then echo "no differences" ; fi 
```

请注意，make 中规则正文中的每个命令都在单独的子 shell 中运行。例如，以下将不起作用：

```
all:
    diff foo.txt foo.txt
    if [ $$? -eq 0 ] ; then echo "no differences" ; fi 
```

因为`diff`和`if`命令是在不同的 shell 进程中执行的。如果你想使用命令的输出状态，你必须在同一个 shell 的上下文中这样做，就像我之前的例子一样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T16:55:41.733

使用'$$?' 而不是“$$!” （感谢[基于进程退出代码的退出 Shell 脚本的](https://stackoverflow.com/questions/90418/exit-shell-script-based-on-process-exit-code)第四个答案）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-14T16:59:17.463

不要忘记您的每个命令都在单独的子shell 中运行。

这就是为什么你经常看到类似的东西：

```
my_target:
    do something \
    do something else \
    do last thing. 
```

并且在调试时，不要忘记每个有用的 -n 选项，它会打印命令但不执行它们，以及 -p 选项，它将向您显示完整的 make 环境，包括设置各种位和部分的位置。

高温高压

干杯，

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-12-11T04:56:00.930

如果您将结果代码传递给`if`，您可以简单地执行以下操作：

```
all:
    if diff foo.txt foo.txt ; then echo "no differences" ; fi 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T16:56:01.013

bash 变量是`$?`，但是为什么还要打印出状态码呢？

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-04-14T16:56:38.283

试试 `\$?' 我认为 $$ 正在由 makefile 解释

# sql - SQL Server 2005 中的“类 CSS”后备级联数据

> ID：748449
> 
> 赞同：2
> 
> 时间：2009-04-14T16:51:14.503
> 
> 标签：sql, sql-server

我正在尝试在 SQL Server 中实现价格回退系统。我想为一种产品设置一组越来越具体的价格（例如：按地区、商店、仓库等），可能会或可能不会定义，并且能够选择最具体的价格（即：一个定义了大多数参数的参数）在报告中。

例如，我可能有以下数据：

```
 Region
--------
   1
   2

 Store  
--------
   1
   2
   3

Product | Region | Store | Price
--------------------------------
  Foo   | NULL   | NULL  |  1.0
  Foo   | 1      | NULL  |  2.0
  Foo   | 1      | 1     |  2.5
  Foo   | 1      | 2     |  2.3 
```

因此，如果我想知道产品 Foo 的价格...

*   在区域 1 中，商店 1 = 2.5
*   在 Region 1 中，Store 3 = 2.0 *（Store 3 没有在数据中明确定义，因此结果来自 Region 1 的 NULL 存储）*
*   在Region 2中，Store 4 = 1.0 *（Region 2在数据中没有明确定义，所以结果来自NULL region）*

为了简单起见，我可以假设 Store 总是比 region 更具体，一个 store 只能存在于一个 region。

此数据的架构将如下所示：

```
CREATE TABLE Prices(
    ID      int   IDENTITY(1,1) NOT NULL,
    Product int   NOT NULL,
    Region  int   NULL,
    Store   int   NULL,
    Price   money NOT NULL,
    CONSTRAINT PK_Prices PRIMARY KEY CLUSTERED (ID ASC),
    CONSTRAINT IX_Prices UNIQUE NONCLUSTERED (Product ASC, Region ASC, Store ASC)
) 
```

除了在代码中处理这些数据之外，我如何根据（区域、商店）查询此表以获取每种产品的有效价格列表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T17:17:45.300

试试这个：
**编辑**所有产品，每一个列出一次，即使给定的地区和商店不存在......

```
CREATE PROCEDURE GetPrice
     @Region int = null
    ,@Store int = null
AS

SELECT
    Product
        ,Region
        ,Store
        ,Price
    FROM (SELECT
              Product
                  ,Region AS Region
                  ,Store As Store
                  ,Price
                  ,Row_Number() OVER(PARTITION BY Product ORDER BY SortBy,Product,Region,Store,Price) AS RowNumber
              FROM (SELECT 1 AS SortBy,* FROM Prices WHERE (Region = @Region OR @Region IS NULL) AND (Store = @Store OR @Store IS NULL)
                    UNION
                    SELECT 2 AS SortBy,* FROM Prices WHERE (Region = @Region OR @Region IS NULL) 
                    UNION
                    SELECT 3 AS SortBy,* FROM Prices
                   ) Prices
         ) dt
    WHERE RowNumber=1
    ORDER BY Product

GO 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T18:30:43.330

哇，你们太努力了。这是一种简单的方法：使用 COALESCE 命令，该命令采用第一个非空值。

```
SELECT COALESCE(st.Price, rg.Price, gn.Price) AS Price
  FROM dbo.Prices gn  /*General price*/
  LEFT OUTER JOIN dbo.Prices rg /*Regional price*/
    ON rg.Product = @Product AND rg.Region = @Region AND rg.Store IS NULL
  LEFT OUTER JOIN dbo.Prices st  /*Store price*/
    ON rg.Product = @Product AND rg.Region = @Region AND rg.Store = @Store
  WHERE gn.Product = @Product
    AND gn.Region IS NULL AND gn.Store IS NULL 
```

这样，如果不为空，您将获得商店价格，如果不为空，您将获得区域价格，如果其他所有方法都失败，您将获得一般价格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T18:33:45.133

我认为您的数据模型可能有点古怪。是否仅为报告填充价格表？我可能会查看我的表格，但如果我不得不使用这个设置，我会做这样的事情：

对于指定地区的产品价格（非商店）。在接受区域作为参数的存储过程中使用此选择。如果我做得对，它将返回区域价格（如果有）和产品价格（如果没有）。

Select Product, Price from dbo.prices where (Region = @region) or (region is NULL and product not in (select product from prices where region = @Region))

对于指定商店的产品价格。在接受 store 作为参数的存储过程中使用此选择。您还需要通过区域或从商店中找出。如果我做对了，它将返回商店价格，如果有，则返回区域价格，然后是产品价格。

从 dbo.prices 选择产品、价格 where (store = @store) or (store is NULL AND region = @Region and product not in (select product from prices where store = @store) or (store is NULL and region is NULL and产品不在（从区域 = @Region 的价格中选择产品））

要从多个区域或商店获取价格，只需多次执行上述存储过程之一（在循环或光标中）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-14T18:24:51.097

我想这一定行得通（虽然没有尝试过）：

```
select top 1 price
from prices
where product = @product
and isnull(region, @region) = @region
and isnull(store, @store) = @store
order by region desc, store desc 
```

一个产品必须至少有 1 个价格记录。ORDER BY .. DESC 最后对原始 NULL 值进行排序。

# python - 使用 PIL 在 Python 中将带有回车符的文本写入图像

> ID：748453
> 
> 赞同：1
> 
> 时间：2009-04-14T16:53:16.230
> 
> 标签：python, text, image, python-imaging-library

我有一个 python 脚本，它使用 PIL 将文本写入图像。除了遇到带有回车符的字符串外，这一切都很好。我需要在文本中保留回车。我没有在图像上写回车，而是在应该返回的地方得到一个小方框字符。这是编写文本的代码：

```
<code>
 draw = ImageDraw.Draw(blankTemplate)
 draw.text((35 + attSpacing, 570),str(attText),fill=0,font=attFont)
</code> 
```

attText 是我遇到问题的变量。我在写它之前将它转换为一个字符串，因为在某些情况下它是一个数字。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-14T16:58:25.440

让我们想一想。“回归”意味着什么？这意味着向左走一段距离，然后向下走一段距离并继续显示字符。

您必须执行以下操作。

```
y, x = 35, 570
for line in attText.splitlines():
    draw.text( (x,y), line, ... )
    y = y + attSpacing 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-15T22:19:58.870

您可以尝试以下代码，它非常适合我的需求：

```
# Place Text on background
    lineCnt = 0
    for line in str(attText):
        draw = ImageDraw.Draw(blankTemplate)
        draw.text((35 + attSpacing,570 + 80 * lineCnt), line, font=attFont)
        lineCnt = lineCnt +1 
```

表达式“y+80*lineCnt”根据行号将文本向下移动 y 位置。（必须根据字体调整移位系数“80”）。

# c# - C# - 输出参数的语法糖？

> ID：748455
> 
> 赞同：8
> 
> 时间：2009-04-14T16:54:13.483
> 
> 标签：c#, parameters, syntactic-sugar

让我们说一下，C# 在最纯粹的意义上允许多个返回值，我们希望看到类似的东西：

```
string sender = message.GetSender();
string receiver = message.GetReceiver(); 
```

压缩为：

```
string sender, receiver = message.GetParticipants(); 
```

在这种情况下，在我实际调用方法之前，我不必了解方法的返回值。也许我依靠 Intellisense 来告诉我我正在处理什么返回值，或者我正在寻找一种方法来从我不熟悉的类中返回我想要的东西。

同样，我们目前在 C# 中有这样的东西：

```
string receiver;
string sender = message.GetParticipants(out receiver); 
```

其中 GetParticipants 的参数是一个**输出**字符串参数。然而，这与上面的有点不同，因为这意味着我必须抢占，或者至少回去写，创建一个变量来保存 out 参数的结果的代码。这有点违反直觉。

我的问题是，当前 C# 中是否有任何语法糖允许开发人员在与方法调用相同的行中进行此声明？我认为这会使开发（微小）更加流畅，并且如果我正在执行以下操作，也会使代码更具可读性：

```
string sender = message.GetParicipants(out string receiver); 
```

以表明接收者正在当场宣布和分配。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-14T16:57:27.720

不，目前没有任何语法糖。我也没有听说有任何介绍的打算。

我不能说我使用`out`参数的次数足够多，以至于这对我来说确实是一个重要的问题（我希望 C# 团队花时间在其他功能上），但我同意这有点烦人。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T17:08:04.590

.NET 4 将添加一个处理此问题的元组概念。不幸的是，C# 语言不会为“解构绑定”提供任何语言支持。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-14T17:16:30.963

就个人而言，我喜欢使用 out 参数时带来的不便。它可以帮助我思考我的方法是否真的在做它应该做的事情，或者我是否在其中塞入了太多的功能。也就是说，也许 C#4.0/.Net 4 中的动态类型会解决您的一些问题。

```
dynamic participant = message.GetParticipants();

var sender = participant.Sender;
var recipient = participant.Recipient; 
```

在哪里

```
public object GetParticipants()
{
     return new { Sender = ..., Recipient = ... };
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T17:10:13.397

您也可以返回 a`Tuple<T,U>`或类似的东西。但是，由于您要返回两个字符串，因此可能会令人困惑。

我使用非常方便的[BclExtras 库](http://code.msdn.microsoft.com/BclExtras)的元组结构（在 SO 上找到它，谢谢 JaredPar！）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-14T17:24:59.323

我认为不存在这样的功能，但如果它以类似于 perl 中的数组的方式实现，那实际上可能很有用。

在 perl 中，您可以将数组分配给括号中的变量列表。所以你可以例如这样做

```
($user, $password) = split(/:/,$data);

```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-14T18:18:04.780

这最让我烦恼的地方：因为没有（比如说）`DateTime.TryParse`不带`out`参数的重载，所以你不能写

```
if (DateTime.TryParse(s, out d))
{
   return new ValidationError("{0} isn't a valid date", s);
} 
```

without declaring `d`. I don't know if this is a problem with `out` parameters or just with how the `TryParse` method is implemented, but it's annoying.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-04-16T18:21:30.750

This syntactic sugar is now is now available in the roslyn preview [as seen here (called Declaration expressions)](http://roslyn.codeplex.com/wikipage?title=Language%20Feature%20Status).

```
int.TryParse(s, out var x); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-14T16:55:46.460

充其量您必须使用`var`而不是显式类型，除非您想将所有多个返回值限制为相同类型（不太可能）。您还将限制变量的范围；目前，您可以在更高的范围内声明一个变量并在 out 参数中对其进行初始化。使用这种方法，变量将超出与其赋值相同的块中的范围。显然这在某些情况下是可用的，但我不想将其作为一般规则强制执行。显然，您可以保留 ' `out`' 选项，但人们可能会为一种方法或另一种方法编写代码。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-14T17:04:23.600

试试下面的代码

```
Participants p = message.GetParticipants();
log(p.sender,p.receiver); 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-14T17:07:45.493

我认为这不是你想要的。您可能遇到过一段您会喜欢的代码。但是变量突然出现，因为它们已被引入参数列表中，这将是个人的噩梦（对我来说:)）

从可移植性/可维护性的角度来看，多个返回值具有严重的缺点。如果您创建了一个返回两个字符串的函数，而您现在希望它返回三个字符串，您将不得不更改所有使用该函数的代码。然而，返回的记录类型通常在此类常见场景中表现良好。

你可能正在打开潘多拉的盒子;-)

对于线压缩：

```
string s1, s2; s1 = foo.bar(s2); 
```

行可以是*任意*长度，因此您可以将一些常见的东西打包成一个。试着忍受分号。

# php - 推荐的企业网站开源内容管理系统？

> ID：748457
> 
> 赞同：3
> 
> 时间：2009-04-14T16:54:21.877
> 
> 标签：php, ruby, open-source, content-management-system

我们正准备重写/重组我们的公司网站，并正在寻找一个 CMS 来支持它。我需要 CMS 提供一种方法，让我们公司中的某些用户控制网站的某些部分（即，让我们的营销部门更新新闻稿，让我们的人力资源部门更新招聘信息等）。它也应该是相当非技术人员友好的......

你有什么特别推荐的吗，为什么？就个人而言，我更喜欢基于 ruby​​ 的系统，因为我们在内部拥有很多这样的技能，但我不确定 ruby​​ 是否已达到功能级别，并且是否遵循基于 PHP 的系统。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T17:13:48.100

我推荐[Drupal](http://www.drupal.org)，因为很多大公司都使用它来支持他们的内容网站（参见[Fast Company](http://fastcompany.com)、[Yahoo! Research](http://research.yahoo.com)、[The Onion](http://www.theonion.com)、[43folders](http://www.43folders.com)等）

Drupal 已经过验证，非常健壮和可靠。它拥有庞大的用户群、非常有用的支持、大量的[模块/插件](http://drupal.org/project/Modules)和代码库扩展。对于开发人员来说，它是一个快速的设置并且非常容易扩展。对于设计师来说，[Drupal 模板系统](http://drupal.org/node/306)是一种集成设计的轻量级方式。

Drupal 也有一个广泛[的基于角色的权限系统](http://drupal.org/node/310)，它也允许非技术人员管理规则。

至于红宝石，我看到的唯一接近的是[Radiant CMS](http://radiantcms.org/)。他们也有很多可用的模块/插件，但我不确定这个项目有多成熟。他们也有一个简单的基于角色的权限系统。

[Comatose](http://comatose.rubyforge.org/)是另一种选择，但它是一个 CMS 插件，而不是 CMS 包本身。它位于轨道之上，这取决于您的技能、偏好和现有设置，这可能是好事还是坏事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T17:04:44.143

我们公司使用 Drupal。我们之所以选择它，主要是因为它尽可能地接近行业“标准”，而且它并没有让我们失望。

我们的图形/UI 人员（不会编程）在处理“主题”文件和“块”时没有问题，尽管在她弄清楚它们如何协同工作时，她确实有一点初步的学习曲线。我们的博客维护者（甚至不知道 HTML）可以使用 Drupal 的富文本编辑器（即不知道任何 HTML）向博客添加条目。而我们工程师......好吧，一旦我们设置好它（这很容易），我们几乎不需要与它进行交互，所以我们没有抱怨。

当然，像这样的事情，你的里程可能会有所不同，因为我只是短暂地使用过 Joomla，我不能说 Drupal 一定比它好。我可以说，Drupal 不仅能够处理大型网站的前端（我们的后端是 JSP），而且可以由非技术人员轻松编辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T16:57:11.370

Joomla 是我最喜欢的企业 Intranet 网站 CMS，它具有细粒度的访问控制，易于扩展，并且围绕它建立了一个庞大的社区。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T17:16:10.013

我发现 Joomla 更容易理解。Typo 3 是一个更难的选择，但具有更多功能。Drupal 也不错。

无论您选择什么，请确保它是众所周知的开源名称。否则，您可能会陷入供应商锁定或找不到支持。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T17:19:40.550

我很惊讶没有人提到[Typo3](http://typo3.org/)，因为我工作过的每家公司都使用过它。
它非常可扩展，我还没有看到其他 CMS 支持受控用户权限。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T20:05:56.953

如果你想要一个基于 Ruby 的 CMS，你很可能想要 Radiant。还有其他的，但我发现 Radiant 是最容易扩展的。在这一点上它已经相当成熟了，我的一些朋友几乎完全使用它来构建客户网站，并取得了巨大的成功。Radiant 还有一个非常好的 PHP 克隆，称为 FrogCMS。

如果您确实选择了 Radiant，您可能希望在 Phusion Passenger 之上运行它以将维护降至最低。其他部署选项通常仅在性能是主要考虑因素时才有意义，这对于 CMS 来说很少见。

# wcf - Silverlight WCF 服务表现奇怪

> ID：748469
> 
> 赞同：0
> 
> 时间：2009-04-14T16:55:58.470
> 
> 标签：wcf, silverlight

我有一个调用 wcf 服务的 silverlight 项目。在我的本地机器上一切正常。

但是，当我部署到虚拟机时，wcf 服务返回完全相同的查询，但结果为空。

我尝试过调试，但无法让它在 wcf 服务中中断。

有什么想法可能是什么问题，或者我该如何调试它？

谢谢

* * *

我弄清楚了问题所在，但不确定解决方案是什么。

在我的 silverlight 项目中，我引用的 wcf 服务是[http://localhost/.../SilverlightApiService.svc](http://localhost/.../SilverlightApiService.svc)

我在我的虚拟机上使用了提琴手来查看发出的请求，而不是尝试联系上述服务，而是尝试联系：

[http:///.../SilverlightApiService.svc](http:///.../SilverlightApiService.svc)

所以，由于某种原因，我的机器名称被插入其中而不是 localhost。对此的任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T23:52:06.433

我在部署到 amazon ec2 时遇到了这个确切的问题 - 服务的机器名称是在 wsdl 而不是 dns 中返回的。

有几个解决方案（一个涉及创建静态 wsdl - 太糟糕了！）

但另一个是为服务创建一种工厂模式

该线程（您可以阅读所有内容，但答案在底部。） [http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/c7fd51a2-773e-41d4-95a0-244e925597fe/](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/c7fd51a2-773e-41d4-95a0-244e925597fe/)

这样做的轻微缺点是，尽管它有效 - 如果您更改服务器的位置，您将需要记住更新您的配置 - 虽然并不难，但很容易忘记这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T19:20:30.433

I have had that happen before. I would try this. Set you start page as the web service file and run the app. Then set the start page back to your default page. Then update all the server references in your SL project. Recompile everything and republish. This has helped me a bunch of times in the past.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T00:11:41.083

我想到了。

基本上，我的机器名称是硬编码在我的 silverlight 项目的 ServiceReferences.ClientConfig 文件中的。

我必须做的是在实例化我的服务客户端时以编程方式指定用于服务引用的 url：

```
System.ServiceModel.EndpointAddress address = new System.ServiceModel.EndpointAddress(new Uri
        (Application.Current.Host.Source, "../WebServices/SilverlightService.svc"));

        ServiceClient serviceClient = new ServiceClient("BasicHttpBinding_IService", address); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T17:06:34.827

你能给我们更多的信息吗？你使用什么样的绑定？服务配置和客户端配置是什么样的？你从哪里得到你的数据被返回？难道是虚拟机上的服务没有得到任何数据？（例如查询一个没有请求数据的数据库？）

马克

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T22:59:07.623

我弄清楚了问题所在，但不确定解决方案是什么。

在我的 silverlight 项目中，我引用的 wcf 服务是[http://localhost/.../SilverlightService.svc](http://localhost/.../SilverlightService.svc)

我在我的虚拟机上使用了提琴手来查看发出的请求，而不是尝试联系上述服务，而是尝试联系：

http:///.../SilverlightService.svc

所以，由于某种原因，我的机器名称被插入其中而不是 localhost。对此的任何想法将不胜感激。

# mysql - 找不到 mysql.sock

> ID：748478
> 
> 赞同：85
> 
> 时间：2009-04-14T16:57:14.880
> 
> 标签：mysql, macos, sockets, installation

我只需要重新安装 mysql，但我在启动时遇到了问题。它找不到套接字（mysql.sock）。问题是我也不能。在我的 Mac OS X 10.4 终端中，我输入: `locate mysql.sock`，然后返回`/private/tmp/mysql.sock`。套接字文件存在于该位置是有道理的，但实际上并不存在。

1.  如何找到套接字文件？

2.  如果 locate 返回一个错误的位置，它必须有某种内存并且可能有索引。如何刷新该索引？

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2010-12-17T10:07:15.143

回答您问题的第一部分：

跑

```
% mysqladmin -p -u <user-name> variables 
```

并检查“套接字”变量

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2013-08-09T09:36:11.947

这解决了我的问题

```
mysql_config --socket 
```

**更新**

mysql_config 可以告诉我们文件 mysql.sock 应该在哪里，但在我的情况下，该文件不存在。所以，我删除了 my.cnf：

```
sudo rm -rf /etc/my.cnf 
```

然后重启mysql：

```
brew services restart mysql 
```

该文件已创建，mysql 现在运行良好。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2015-06-09T20:36:16.633

这为我找到了它：

```
netstat -ln | grep mysql 
```

Mac OSX

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-04-14T17:20:51.283

当 MySQL 守护进程启动时，应该自动创建套接字文件。

如果没有找到，很可能应该包含它的目录不存在，或者其他一些文件系统问题正在阻止创建套接字。

要找出文件的位置，请使用：

```
% mysqld --verbose --help | grep ^socket 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-06-27T18:42:09.393

我的问题也是 mysql.sock 文件。

在drupal安装过程中，我不得不说我想使用哪个数据库，但我的数据库没有找到

```
mkdir /var/mysql
ln -s /tmp/mysql.sock /var/mysql/mysql.sock 
```

系统正在搜索 mysql.sock 但它在错误的目录中

您所要做的就是链接它;）

我花了很多时间搜索所有重要信息，但我花了几个小时才知道如何适应，但现在我可以展示结果了：D

ps：如果你想完全一样，你必须将你的`/tmp/mysql.sock-file`（如果它也位于你的系统中）链接到 php.ini （或 php.default.ini ）给出的目录，其中`pdo_mysql.default_socket= ...`

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-01-05T22:08:50.680

我得到了使用的确切路径：

```
netstat -ln | grep -o -m 1 -E '\S*mysqld?\.sock' 
```

由于这仅返回路径并且不需要任何输入，因此您可以在 shell 脚本中使用它。

MySQL 必须当前在您的机器上运行才能正常工作。也适用于 MariaDB。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-05-03T19:21:22.603

最初的问题似乎来自以下混淆：a) 文件在哪里，b) 在哪里寻找它（以及为什么我们在进行定位或 grep 时找不到它）。我认为 Alnitak 的意思是你想找到它链接到的位置 - 但 grep 不会显示链接，对吧？该文件并不存在于那里，因为它是一个链接，它只是一个指针。您仍然需要知道将链接放在哪里。

我的 sock 文件肯定在 /tmp 中，我得到的错误是在 /var/lib/ 中寻找它（不仅仅是 /var）我现在已经链接到 /var 和 /var/lib，但我仍然收到错误“无法通过套接字 'var/lib/mysql.sock' (2) 连接到本地 MySQL 服务器”。

注意错误之后的（2）....我在另一个线程上发现这意味着可能确实尝试使用套接字，但是套接字本身有问题 - 所以要完全关闭机器 - 以便插座关闭。然后重新启动应该可以解决它。我试过这个，但它对我不起作用（现在我怀疑我是否重启得太快了？真的吗？）也许这将是其他人的解决方案。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-03-28T03:02:12.017

```
$ mysqladmin variables | grep sock 
```

试试这个，这将输出所需的结果，摆脱不相关的信息。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-09-15T19:33:22.270

我在 Mac OS X 10.11.6 上遇到了同样的错误：

`ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2)`

经过大量的痛苦和挖掘这里和相关问题的建议，似乎都没有解决问题，我回去删除了已安装的文件夹，然后就做了`brew install mysql`.

大多数命令仍然出现相同的错误，但这有效：

`/usr/local/bin/mysqld`

并返回：

> /usr/local/bin/mysqld：准备连接。
> 
> 版本：'5.7.12' 套接字：'/tmp/mysql.sock' 端口：3306 Homebrew

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-03-10T13:15:12.273

为了刷新我运行的定位数据库

```
/usr/libexec/locate.updatedb 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-06-08T08:19:23.777

我根本找不到 mysql 套接字，所以重新安装了 mysql 服务器（保留了所有表和 phpmyadmin 设置）。以下是命令：

1) 安装

> sudo apt-get install mysql-server

2）按照终端配置步骤

> sudo mysql_secure_installation

3）检查状态：（应返回“活动：活动（运行）”）

> systemctl 状态 mysql.service

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-05-21T13:23:11.290

不幸的是，上述方法都不适用于我的情况。但最后我找到了解决方案。

要查找 mysql.sock 文件在哪里，只需打开 xampp 管理器，选择 MySQL 并单击右侧的配置。在配置面板上单击打开配置文件，然后按 CMD+F 快捷方式搜索 mysql.sock。

就我而言，mysql.sock 的所有者已更改，我不得不将其更改回 root admin：chmod root:admin mysql.sock

之后，该数据库已被访问。

* * *

## 回答 #13

> 赞同：-4
> 
> 时间：2009-04-14T17:09:50.840

我对问题 #1 无能为力，但要刷新`locate`的文件数据库，请运行：

```
updatedb 
```

# algorithm - 没有任何额外工作，普通的联合/查找算法线程是否安全？

> ID：748479
> 
> 赞同：2
> 
> 时间：2009-04-14T16:57:24.427
> 
> 标签：algorithm, multithreading, data-structures, lock-free

对于单线程情况，标准的[联合/查找或不相交集](http://en.wikipedia.org/wiki/Disjoint-set_data_structure)数据结构具有非常好的运行时间（有效地）。`O(1)`但是在多线程情况下它的有效性/性能是什么？我*认为*即使没有锁定或除了原子指针大小的写入之外的任何原子操作，它也是完全有效的。

有人看到以下逻辑有任何问题吗？

> 首先，我假设指针大小的写入是原子的。由此，不难争辩说您可以安全地`find`在多个线程中运行该函数，因为将发生的唯一更新都设置为相同的值。如果您允许`find`函数在调用时返回正确的答案（而不是在返回时），那么不难争辩说可以同时运行多个`find`s 和单个；`union`s的参数`find`不变，`union`唯一的更新根和`find`s 从不更新根。
> 
> 至于剩下的情况（几个`union`），我认为这也行得通，但我不太确定。

顺便说一句：我不要求解决方案与单线程版本一样高效。（为了避免锁/原子，我也愿意丢弃全局相干状态。）

* * *

*编辑：*再看一下，多联合案例不起作用，因为如果不是新根的一侧与其他东西联合（也不是根），那么您可以将其从第二个联合的另一侧切断.

```
A = find(a)  // union 1
B = find(b)  // union 1
----
X = find(x)  //   union 2 (x == a) -> (X == A) -> (X.par aliases A.par)
Y = find(y)  //   union 2
X.par = Y    //   union 2
----
A.par = B    // union 1 
```

这可以通过[CAS](http://en.wikipedia.org/wiki/Compare-and-swap)来回避：

```
while(!CAS(A == A.par, B)) A = find(A); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T17:11:39.790

可用于此结构的同步类型与[Readers-writers problem](http://en.wikipedia.org/wiki/Readers-writers_problem)类似。性能将取决于将执行多少个联合，因为随后将停止查找操作。

我不确定您是否可以同时运行多个查找和一个联合，因为联合操作的最后一个案例不是原子的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-31T14:57:19.850

有点晚了，但供将来参考。使用原子操作，您可以构建不相交的集合数据结构。不变的是每个集合都由其最小的成员表示，这可以避免由于竞争条件而导致的循环。

```
// atomic_compare_and_exchange(unsigned int *data, unsigned int new_value, unsigned int comparator)

// "The result used to be the root of v once"
static unsigned int GetSet(volatile unsigned int *H_RESTRICT set, const unsigned int v)
{
  unsigned int next;
  unsigned int root = v;
  unsigned int prev = v;

  while (root != (next = set[root]))
  {
    /* Update set[prev] to point to next instead of root.
      * If it was updated by some other thread in the meantime, or if this
      * is the first step (where set[prev]==next, not root), ignore. */
    atomic_compare_and_exchange(set + prev, next, root);

    prev = root;
    root = next;
  }

  /* Update the path to the root */

  return root;
}

// FALSE == "They used not to be in the same set"
// TRUE == "They are in the same set, and will be forever"
static HBOOL IsInSameSet(volatile unsigned int *H_RESTRICT set, unsigned int v1, unsigned int v2)
{
  do
  {
    v1 = GetSet(set, v1);
    v2 = GetSet(set, v2);
  } while (set[v1] != v1 || set[v2] != v2);

  return v1 == v2;
}

static void Union(volatile unsigned int *H_RESTRICT set, unsigned int v1, unsigned int v2)
{
  unsigned int result;

  do
  {
    v1 = GetSet(set, v1);
    v2 = GetSet(set, v2);
    if (v1 == v2)
    {
      /* Already same set. This cannot be changed by a parallel operation. */
      break;
    }
    if (v1 < v2)
    {
      /* Make sure we connect the larger to the smaller set. This also avoids
       * cyclic reconnections in case of race conditions. */
      unsigned int tmp = v1;
      v1 = v2;
      v2 = tmp;
    }

    /* Make v1 point to v2 */
    result = atomic_compare_and_exchange(set + v1, v2, v1);
  } while (result != v1);
} 
```

# exception - Enterprise Library 4.1 例外政策

> ID：748481
> 
> 赞同：0
> 
> 时间：2009-04-14T16:58:08.903
> 
> 标签：exception, enterprise-library, policy

我正在使用 Enterprise Library 4.1 并希望实现异常处理和日志记录。我能够设置一个处理 System.Exception 类型的一般异常的策略。我将此政策称为“数据访问政策”。

在一般应用程序开发规则中，我应该创建多少个策略？捕获 SqlExceptions 的最佳实践是什么？是否应该定义单独的策略？

我正在寻找的是使用 Enterprise Library 开发应用程序的人们的一些建议，以及他们如何设置异常处理策略以及一些示例会有所帮助。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-10-03T12:19:23.510

您可以为 SqlExceptions 添加新策略。

这是一篇很棒的文章：[Enterprise Library 4.1 :: 异常处理应用程序块](http://weblogs.asp.net/sukumarraju/archive/2009/10/04/microsoft-enterprise-library-4-1-exception-handling-block.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T15:29:29.120

It's probably a bit late for you now but this link may help someone else. It's a page from the Enterprise Library documentation entitled ["Determining Appropriate Exception Policies and Actions"](http://msdn.microsoft.com/en-us/library/ff647137.aspx) and does exactly what it says on the tin

# php - 为什么下面的 php 代码没有返回预期值？

> ID：748488
> 
> 赞同：0
> 
> 时间：2009-04-14T16:59:19.353
> 
> 标签：php, linux, bash, scripting

我正在尝试制作一些 php 脚本，这些脚本将在系统调用命令（如 top 和其他自定义脚本）中运行。你可以看到下面的代码非常简单。我们在下面的 php 中遇到的问题是，当我从 linux 提示符调用 php 时，例如：

```
#php checkTOP.php 
```

它将返回屏幕中的 top -n 1 输出，那里没有问题。

当我使用[http://url.com/checkTOP.php](http://url.com/checkTOP.php)从网络服务器运行脚本时，它只返回以下内容：

> 程序：/usr/bin/top -n 1 ver1 = retval = 1 返回不为零

这是我的调试语句。

```
<?php
        $program="/usr/bin/top -n 1";
        echo "program:{$program}<br /> \n";
        $ver1=system($program,$retval);
        echo "ver1 = {$ver1}<br />\n";
        echo "retval = {$retval}<br /> \n";
        if($retval==0)
        {
                echo "Returned 0<br />\n";
        }
        else
        {
                echo "Returned not zero <br />\n";
        }
        die;
?> 
```

变化1：还有一件事。所有权限设置正确 /usr/bin/top 设置 root:apache 与 rxrxrx 以及所有目录 /usr/bin。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T20:08:35.717

奥莱打败了我；我使用了输出缓冲，所以我会发布它：

``<?PHP`
ob_start();
$program="/usr/bin/top -n 1 -b";
passthru($program);
$t=ob_get_contents();
ob_end_clean();
`echo "<PRE>$t</PRE>";` `?>``

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T17:06:38.820

听起来这是与用户帐户有关的问题。当您从命令行手动运行它时，您可能在与网络服务器尝试运行的用户不同的用户下运行。

需要检查的一些事项：

*   是否为 PHP 启用了[安全模式？](http://php.net/manual/en/features.safe-mode.php)
*   运行网络服务器的用户（通常是“www-data”）是否有权执行`top`？
*   能不能打开更高的[报错级别](http://php.net/manual/en/function.error-reporting.php)看看能不能得到更多的信息？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T17:11:20.133

根据您想从系统收集的信息，从 /proc/ 文件系统收集信息可能更有用，当然也更安全。

你想从命令中得到什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T19:59:49.323

获得顶部输出的一种方法是发送 -b 开关以批处理模式运行顶部，并使用 exec() 以每行一个元素的数组中获取输出。

```
<?php
exec('/usr/bin/top -n 1 -b',$output);
echo '<pre>',implode("\n",$output),'</pre>'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T20:19:24.270

看起来系统函数返回失败，在这种情况下 retval 可能为空。

如果您无法获取系统命令，您可以尝试使用 exec 并查看它是否有效。它还会为您提供所需的一切，我*认为*它还会返回一条错误消息以帮助调试问题：

[http://us3.php.net/manual/en/function.exec.php](http://us3.php.net/manual/en/function.exec.php)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T23:41:20.820

top 命令通常不会将其输出发送到标准输出。您无法使用系统命令捕获它。使用 -b 选项设置“批处理模式”，它应该适合您。

```
$program="/usr/bin/top -b -n 1"; 
```

当您从 linux 提示符运行它时，它看起来像是在工作，因为输出会显示。当我尝试它时，我注意到输出与 echo 命令的预期不太匹配。这就是让我知道输出有些奇怪的原因，并且检查顶部的手册页确认了 -b 标志。

--
bmb

# sharepoint - 通过事件处理程序更新签入列

> ID：748489
> 
> 赞同：1
> 
> 时间：2009-04-14T17:00:14.687
> 
> 标签：sharepoint, events, event-handling

在签入文档时，我编写了以下事件处理程序代码来更新文档库中的列：

```
Select Case listEvent.Type

Case SPListEventType.CheckIn

  sLog = sLog + "Newest Item is Checked-out" + vbCrLf
  Dim ApproveStatusBoolean As Boolean = True

  For Each oField In oItem.Fields
    If (oItem("ApproveStatus") = "Rejected") Then
      ApproveStatusBoolean = False ' Old document for re-review
      Exit For
    End If
  Next

  If (ApproveStatusBoolean = False) Then
    oItem("ApproveStatus") = "Submitted"
    oItem.Update()

    SmtpMail.Send(objMailMesg)
  End If
End Select 
```

我发现如果我从文档库签入文档，ApproverStatus 列正在更新，但如果我从 Word 文档内部签入文档，则当它提示“其他用户在您签入之前无法看到您的更改。你要签到吗？”。

如果我也从内部签入，您能否帮我知道出了什么问题如何更新专栏。

或者有什么方法可以让我自己关闭该提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T20:23:19.020

The first thing you should do is to varify that the same event is fired in both cases. I would do that by writing some debug statements to a log file, but I am also kind of ol' school. If I was to debug that code I would outcomment most of the code like the SMTP mail statement in order to raise the signal to noise ratio.

Once that is handled you can dig into the root cause

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T01:43:00.373

您的代码也可能存在问题。尝试以下...

```
Select Case listEvent.Type

Case SPListEventType.CheckIn

  sLog = sLog + "Newest Item is Checked-out" + vbCrLf

  If (oItem("ApproveStatus") != "Rejected") Then
    oItem("ApproveStatus") = "Submitted"
    oItem.Update()
    sLog = sLog + "Item has set to ApproveStatus:Submitted" + vbCrLf
    SmtpMail.Send(objMailMesg)
  End If

End Select 
```

如果您使用非 Office 文档或 Office 2003 文档，您也会得到不同的结果。您还必须测试这些。请注意，对 Office 2007 文档使用同步事件可能会导致事件被调用，但随后会被[存储在 Office 文档](https://stackoverflow.com/questions/205913/data-disappearing-after-itemupdate-in-sharepoint-with-office-2007-documents)本身中的旧值覆盖。

# python - 如何在 Python 中从毫秒创建日期时间？

> ID：748491
> 
> 赞同：186
> 
> 时间：2009-04-14T17:01:03.047
> 
> 标签：python, datetime

[我可以通过java.util.Date(milliseconds)](https://docs.oracle.com/javase/8/docs/api/java/util/Date.html)在 Java 中创建一个类似的 Date 对象。如何在 Python 中创建可比较对象？

> 分配一个 Date 对象并将其初始化以表示自称为“纪元”的标准基准时间（即 1970 年 1 月 1 日 00:00:00 GMT）以来的指定毫秒数。

* * *

## 回答 #1

> 赞同：301
> 
> 时间：2009-04-14T17:12:51.707

只需将其转换为时间戳

```
datetime.datetime.fromtimestamp(ms/1000.0) 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-07-25T10:01:32.803

那这个呢？我认为可以指望它处理 1970 年之前和 2038 年之后的日期。

```
target_datetime_ms = 200000 # or whatever
base_datetime = datetime.datetime(1970, 1, 1)
delta = datetime.timedelta(0, 0, 0, target_datetime_ms)
target_datetime = base_datetime + delta 
```

如 Python 标准库中所述：

> 如果时间戳超出平台 C localtime() 或 gmtime() 函数支持的值范围，则 fromtimestamp() 可能会引发 ValueError。这通常仅限于 1970 年到 2038 年的年份。

很明显，这可以在一行中完成：

```
target_dt = datetime(1970, 1, 1) + timedelta(milliseconds=target_dt_ms) 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2019-02-21T16:00:20.647

由于使用熊猫而有点重，但有效：

```
import pandas as pd
pd.to_datetime(msec_from_java, unit='ms').to_pydatetime() 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2020-08-04T18:59:31.500

将毫秒转换为日期时间 (UTC)：

```
import datetime
time_in_millis = 1596542285000
dt = datetime.datetime.fromtimestamp(time_in_millis / 1000.0, tz=datetime.timezone.utc) 
```

[按照RFC3339](https://www.rfc-editor.org/rfc/rfc3339#section-5.6)标准（由 Open API 规范使用）将日期时间转换为字符串：

```
from rfc3339 import rfc3339
converted_to_str = rfc3339(dt, utc=True, use_system_timezone=False)
# 2020-08-04T11:58:05Z 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2020-04-22T14:32:43.080

```
import pandas as pd

Date_Time = pd.to_datetime(df.NameOfColumn, unit='ms') 
```

# c# - EnableViewState 会影响 GridView 上的哪些控件？

> ID：748496
> 
> 赞同：3
> 
> 时间：2009-04-14T17:03:14.507
> 
> 标签：c#, .net, asp.net, html

我正在清理我的视图源并想使用`EnableViewState`. 我正在使用具有以下内容的gridview。

```
<asp:GridView ID="GridView1" runat="server" AlternatingRowStyle-BackColor="#ECECEC"
            AllowSorting="true" AutoGenerateColumns="False" OnRowDataBound="gridvw_RowDataBound"
            ShowFooter="True" OnSorting="gridvw1_DataSort" Caption="New Shoes"
            CssClass="blueBord" HeaderStyle-ForeColor="White" OnPageIndexChanging="gridvw_PageIndexChanging"
            OnRowCreated="gridvw_RowCreated" AllowPaging="True" PageSize="50" EnableViewState="false"> 
```

哪些控件可以`EnableViewState = true/false`影响 a `GridView`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T17:11:09.993

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.aspx)：

GridView 控件在回发时根据存储在 ViewState 中的信息重新创建。如果 GridView 控件包含一个 TemplateField 或一个将 CausesValidation 属性设置为 true 的 CommandField，则 EnableViewState 属性也必须设置为 true 以确保并发数据操作（例如更新和删除）适用于相应的行。

分页和列排序信息将以控制状态存储，不受更改影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T17:10:55.300

它将影响`GridView`. 至于使用哪些控件`ViewState`来保持值，在不知道您的`GridView`外观的情况下很难说。

# ruby-on-rails - 当我尝试使用 https 访问我的 rails 站点时，为什么会收到 404 错误？

> ID：748500
> 
> 赞同：1
> 
> 时间：2009-04-14T17:04:37.530
> 
> 标签：ruby-on-rails, ssl, https, http-status-code-404, passenger

我的服务器目前正在托管一个 php 站点。该站点已对某些页面使用 ssl。现在我正在过渡到 Rails，我所有的新 Rails 应用程序都进入了一个子文件夹。乘客已设置好，我的应用程序运行良好。一个问题，如果我尝试使用 ssl 访问这些页面，我会收到 404 错误。显然，apache 正在寻找文字文件夹，而不是像往常一样将其交给Passenger。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T17:20:23.030

SSL（端口 443）站点的 Apache 可能没有以与“正常”（端口 80）站点相同的方式为Passenger 设置。

# c++ - 您如何将单元测试引入大型的遗留 (C/C++) 代码库？

> ID：748503
> 
> 赞同：77
> 
> 时间：2009-04-14T17:05:17.717
> 
> 标签：c++, c, unit-testing, unix, legacy

我们有一个用 C 编写的大型多平台应用程序。（使用少量但不断增长的 C++）它经过多年发展，具有许多您期望在大型 C/C++ 应用程序中具有的特性：

*   `#ifdef`地狱
*   难以隔离可测试代码的大文件
*   过于复杂而无法轻松测试的功能

由于此代码是针对嵌入式设备的，因此在实际目标上运行它会产生很多开销。因此，我们希望在本地系统上以快速的周期进行更多的开发和测试。但我们想避免“复制/粘贴到系统上的 .c 文件、修复错误、复制/粘贴回去”的经典策略。如果开发人员要不厌其烦地这样做，我们希望以后能够重新创建相同的测试，并以自动化的方式运行。

这是我们的问题：为了将代码重构为更加模块化，我们需要它更具可测试性。但是为了引入自动化单元测试，我们需要它更加模块化。

一个问题是，由于我们的文件太大，我们可能在一个文件中有一个函数，该函数调用*同*一个文件中的一个函数，我们需要将其存根以进行良好的单元测试。随着我们的代码变得更加模块化，这似乎不再是一个问题，但这还有很长的路要走。

我们想做的一件事是用注释标记“已知可测试”的源代码。然后我们可以为可测试代码编写脚本扫描源文件，将其编译到单独的文件中，并将其与单元测试链接。当我们修复缺陷并添加更多功能时，我们可以慢慢引入单元测试。

但是，有人担心维护这个方案（以及所有必需的存根函数）会变得太麻烦，并且开发人员将停止维护单元测试。所以另一种方法是使用一个工具，自动为所有代码生成存根，并将文件与它链接起来。（我们发现可以做到这一点的唯一工具是昂贵的商业产品）但是这种方法似乎*要求*我们所有的代码在开始之前都更加模块化，因为只有外部调用可以被存根。

就个人而言，我宁愿让开发人员考虑他们的外部依赖关系并智能地编写他们自己的存根。但是，对于一个 10,000 行的文件来说，这可能是为了消除所有依赖关系而难以承受的。可能很难说服开发人员他们需要为所有外部依赖项维护存根，但这是正确的方法吗？（我听到的另一个论点是子系统的维护者应该为他们的子系统维护存根。但我想知道“强迫”开发人员编写他们自己的存根是否会导致更好的单元测试？）

`#ifdefs`当然，这个问题又增加了一个完整的维度。

我们已经查看了几个基于 C/C++ 的单元测试框架，并且有很多看起来不错的选项。但是我们还没有找到任何东西来缓解从“没有单元测试的毛球代码”到“可单元测试的代码”的过渡。

所以这是我对其他经历过这个的人的问题：

*   什么是好的起点？我们是在朝着正确的方向前进，还是我们错过了一些明显的东西？
*   哪些工具可能有助于过渡？（最好是免费/开源，因为我们现在的预算大约是“零”）

请注意，我们的构建环境是基于 Linux/UNIX 的，因此我们不能使用任何仅限 Windows 的工具。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-04-14T17:19:27.337

> 我们还没有找到任何东西来缓解从“没有单元测试的代码毛球”到“可单元测试的代码”的过渡。

[多么可悲——没有奇迹般的解决方案——只是为了纠正多年积累的技术债务](https://stackoverflow.com/questions/55421/do-you-actively-manage-technical-debt)而进行的大量艰苦工作。

没有简单的过渡。你有一个大的、复杂的、严重的问题。

您只能通过微小的步骤来解决它。每个微小的步骤都涉及以下内容。

1.  选择一段绝对必要的离散代码。（不要在垃圾的边缘蚕食。）选择一个重要的组件，并且——不知何故——可以从其余部分中剔除。虽然单个函数是理想的，但它可能是一组错综复杂的函数，也可能是一个完整的函数文件。可以从对您的可测试组件来说不太完美的东西开始。

2.  弄清楚它应该做什么。弄清楚它的界面应该是什么。为此，您可能必须进行一些初始重构以使您的目标片段实际上是离散的。

3.  编写一个“整体”集成测试——现在——或多或少地测试你发现的离散代码。在您尝试更改任何重要内容之前，请先通过此操作。

4.  将代码重构为整洁、可测试的单元，这些单元比您当前的毛球更有意义。您将不得不（目前）与您的整体集成测试保持一些向后兼容性。

5.  为新单元编写单元测试。

6.  一切都通过后，停用旧 API 并修复更改将破坏的内容。如有必要，返工原始集成测试；它测试旧的 API，你想测试新的 API。

迭代。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-04-14T17:24:40.133

Michael Feathers 写了这本圣经，[有效地使用遗留代码](https://rads.stackoverflow.com/amzn/click/com/0131177052)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-14T17:35:08.423

我对遗留代码和引入测试的一点经验是创建“[特征测试](http://en.wikipedia.org/wiki/Characterization_Test)”。您开始使用已知输入创建测试，然后获取输出。这些测试对于您不知道它们真正做什么但您知道它们正在工作的方法/类很有用。

但是，有时几乎不可能创建单元测试（甚至是特征测试）。在那种情况下，我通过验收测试（在这种情况下为[Fitnesse ）来解决问题。](http://fitnesse.org/)

您创建了测试一个功能所需的一大堆类，并在 Fitnesse 上进行检查。它类似于“表征测试”，但要高一级。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-16T00:14:03.917

正如乔治所说，有效地使用遗留代码是这类事情的圣经。

但是，您团队中的其他人会接受的唯一方法是，如果他们看到了保持测试正常运行对他们个人的好处。

为此，您需要一个尽可能易于使用的测试框架。计划让其他开发人员将您的测试作为示例来编写自己的测试。如果他们没有单元测试经验，不要指望他们花时间学习框架，他们可能会认为编写单元测试会减慢他们的开发速度，因此不知道框架是跳过测试的借口。

花一些时间使用巡航控制、luntbuild、cdash 等进行持续集成。如果您的代码每晚自动编译并运行测试，那么如果单元测试在 qa 之前发现错误，开发人员将开始看到好处。

值得鼓励的一件事是共享代码所有权。如果开发人员更改了他们的代码并破坏了其他人的测试，他们不应该期望那个人修复他们的测试，他们应该调查为什么测试不工作并自己修复它。根据我的经验，这是最难实现的事情之一。

大多数开发人员编写某种形式的单元测试，有时是一小段他们不签入或集成构建的一次性代码。将这些轻松集成到构建中，开发人员将开始购买。

我的方法是为新的代码添加测试，并且随着代码的修改，有时您无法在不解耦太多现有代码的情况下添加尽可能多或尽可能详细的测试，在实用方面会出错。

我坚持单元测试的唯一地方是平台特定的代码。#ifdefs 被平台特定的更高级别函数/类替换的地方，必须在所有平台上使用相同的测试进行测试。这可以节省大量添加新平台的时间。

我们使用 boost::test 来构建我们的测试，简单的自注册函数使编写测试变得容易。

这些封装在 CTest（CMake 的一部分）中，它一次运行一组单元测试可执行文件并生成一个简单的报告。

我们的夜间构建使用 ant 和 luntbuild 自动化（ant 粘合 c++、.net 和 java 构建）

很快我希望在构建中添加自动化部署和功能测试。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-16T19:19:41.010

我们正在这样做。三年前，我加入开发团队的项目没有单元测试，几乎没有代码审查，以及相当临时的构建过程。

代码库由一组 COM 组件 (ATL/MFC)、跨平台 C++ Oracle 数据盒和一些 Java 组件组成，所有这些都使用跨平台 C++ 核心库。有些代码已经有将近十年的历史了。

第一步是添加一些单元测试。不幸的是，这种行为非常受数据驱动，因此在生成单元测试框架（最初是 CppUnit，现在通过 JUnit 和 NUnit 扩展到其他模块）方面进行了一些初步努力，该框架使用来自数据库的测试数据。大多数最初的测试都是功能测试，它锻炼了最外层，而不是真正的单元测试。您可能需要花费一些精力（您可能需要为此进行预算）来实施测试工具。

如果你尽可能降低添加单元测试的成本，我发现它会很有帮助。测试框架使得在修复现有功能中的错误时添加测试相对容易，新代码可以进行适当的单元测试。当您重构和实现新的代码区域时，您可以添加适当的单元测试来测试更小的代码区域。

去年，我们增加了与 CruiseControl 的持续集成，并使我们的构建过程自动化。这增加了使测试保持最新和通过的更多动力，这在早期是一个大问题。因此，我建议您将常规（至少每晚）单元测试运行作为开发过程的一部分。

我们最近专注于改进我们的代码审查流程，该流程相当少见且效率低下。其目的是降低启动和执行代码审查的成本，从而鼓励开发人员更频繁地进行审查。此外，作为我们流程改进的一部分，我试图在项目规划中获得时间进行代码审查和单元测试，以确保单个开发人员必须更多地考虑它们，而以前只有固定的比例花费在他们身上的时间更容易在日程安排中迷失。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-14T18:24:56.277

我曾参与过具有完全单元测试代码库的 Green field 项目和多年来不断发展的大型 C++ 应用程序，并且有许多不同的开发人员参与其中。

老实说，我不会费心尝试将遗留代码库置于单元测试和测试优先开发可以增加很多价值的状态。

一旦遗留代码库达到一定的大小和复杂性，使其达到单元测试覆盖率为您提供很多好处的地步，就变成了一项相当于完全重写的任务。

主要问题是，一旦您开始重构以实现可测试性，您就会开始引入错误。只有当您获得高测试覆盖率时，您才能期望找到并修复所有这些新错误。

这意味着您要么非常缓慢而谨慎地进行，并且直到几年后您才能获得经过良好单元测试的代码库的好处。（可能从没有发生合并等。）与此同时，您可能会引入一些对软件的最终用户没有明显价值的新错误。

或者你速度很快，但代码库不稳定，直到你的所有代码都达到了高测试覆盖率。（所以你最终有 2 个分支，一个在生产中，一个用于单元测试版本。）

当然，对于某些项目来说，这一切都是规模问题，重写可能只需要几周时间，而且肯定是值得的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-14T17:18:32.630

要考虑的一种方法是首先放置一个系统范围的模拟框架，您可以使用它来开发集成测试。从集成测试开始可能看起来违反直觉，但是在您描述的环境中进行真正的单元测试的问题是相当可怕的。可能不仅仅是在软件中模拟整个运行时......

这种方法只会绕过您列出的问题——尽管它会给您许多不同的问题。但在实践中，我发现使用健壮的集成测试框架，您可以开发在单元级别执行功能的测试，尽管没有单元隔离。

PS：考虑编写一个命令驱动的仿真框架，可能建立在 Python 或 Tcl 之上。这将使您可以很容易地编写脚本测试...

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-14T17:18:39.680

天，

我将首先查看任何明显的点，例如在头文件中使用 dec。

然后开始查看代码是如何布局的。合乎逻辑吗？也许开始将大文件分解成更小的文件。

或许可以拿一份 Jon Lakos 的优秀著作《Large-Scale C++ Software Design》（经过[消毒的 Amazon 链接](https://rads.stackoverflow.com/amzn/click/com/0201633620)）来了解应该如何布局。

一旦你开始对代码库本身有了更多的信心，即文件布局中的代码布局，并且已经清除了一些不好的气味，例如在头文件中使用 dec，那么你就可以开始挑选一些你可以使用的功能用于开始编写单元测试。

选择一个好的平台，我喜欢 CUnit 和 CPPUnit，然后从那里开始。

不过，这将是一段漫长而缓慢的旅程。

高温高压

干杯，

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-14T17:18:20.960

首先使其更加模块化要容易得多。您不能真正对具有大量依赖项的东西进行单元测试。何时重构是一个棘手的计算。您确实必须权衡成本和风险与收益。这段代码会被广泛重用吗？或者这段代码真的不会改变。如果您打算继续使用它，那么您可能想要重构。

听起来，你想重构。您需要首先分解最简单的实用程序并在它们的基础上进行构建。你的 C 模块做了很多事情。例如，可能有一些代码总是以某种方式格式化字符串。也许这可以成为一个独立的实用程序模块。您已经有了新的字符串格式化模块，使代码更具可读性。它已经是一个改进。您是在断言您处于第 22 条捕获状态。你真的不是。仅仅通过移动事物，您就使代码更具可读性和可维护性。

现在您可以为这个断开的模块创建一个单元测试。你可以通过几种方式做到这一点。您可以制作一个单独的应用程序，只包含您的代码并在您的 PC 上的主例程中运行一堆案例，或者定义一个名为“UnitTest”的静态函数，它将执行所有测试用例并在它们通过时返回“1”。这可以在目标上运行。

也许你不能 100% 使用这种方法，但它是一个开始，它可能会让你看到其他可以轻松分解为可测试实用程序的东西。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-01-22T20:33:09.963

这一切都有一个哲学方面。

你真的想要经过测试、功能齐全、整洁的代码吗？这是你的目标吗？你有什么好处吗？

是的，起初这听起来很愚蠢。但老实说，除非你是系统的实际所有者，而不仅仅是一名员工，否则 bug 就意味着更多的工作，更多的工作意味着更多的钱。在处理毛球时，您会非常开心。

我只是在这里猜测，但是，你承担这场巨大的战斗所承担的风险可能比你通过整理代码获得的可能回报要高得多。如果你缺乏社交技巧来解决这个问题，你只会被视为麻烦制造者。我见过这些人，我也是其中之一。但是，当然，如果你能做到这一点，那就太酷了。我会印象深刻的。

但是，如果你觉得你现在被欺负了花费额外的时间来保持一个不整洁的系统工作，你真的认为一旦代码变得整洁和漂亮，这种情况就会改变吗？不.. 一旦代码变得整洁，人们将有这么多空闲时间在第一个可用的截止日期再次完全销毁它。

最后，创造美好工作场所的是管理层，而不是代码。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-16T08:27:10.020

我认为，基本上你有两个不同的问题：

1.  需要重构的大型代码库
2.  与团队合作

模块化、重构、插入单元测试等是一项艰巨的任务，我怀疑任何工具都可以接管大部分工作。是一种难得的技能。一些程序员可以很好地做到这一点。大多数人讨厌它。

与团队一起完成这样的任务很乏味。我强烈怀疑“强迫”开发人员是否会奏效。Iains 的想法很好，但我会考虑找一两个能够并且想要“清理”源代码的程序员：重构、模块化、引入单元测试等。让这些人完成工作，其他人引入新的错误，aehm 功能。只有**喜欢**这种工作的人才会在这份工作上取得成功。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-04-16T09:09:55.610

**使使用测试变得容易。**

我首先将“自动运行”放置到位。如果您希望开发人员（包括您自己）编写测试，请轻松运行它们并查看结果。

编写三行测试，针对最新版本运行它并查看结果应该*只需单击一下即可*，而不是将开发人员发送到咖啡机。

这意味着您需要最新版本，您可能需要更改人们如何处理代码等的政策。我知道这样的过程可以是嵌入式设备的 PITA，对此我无法提供任何建议。但我知道，如果运行测试很难，没有人会编写它们。

**测试什么可以测试**

我知道我在这里违背了常见的单元测试理念，但这就是我所做的：为易于测试的事物编写测试。我不打扰嘲笑，我不重构使其可测试，如果涉及 UI，我没有单元测试。但是越来越多的我的图书馆例程都有一个。

我很惊讶简单的测试会发现什么。采摘低垂的果实绝不是无用的。

换个角度来看：如果它不是一个成功的产品，你就不会打算维持那个巨大的毛球烂摊子。您当前的质量控制不是需要更换的完全失败。相反，在容易做到的地方使用单元测试。

（不过，您需要完成它。不要陷入构建过程中“修复所有问题”的困境。）

**教你如何改进你的代码库**

任何具有这种历史的代码库都需要改进，这是肯定的。但是，您永远不会重构所有这些。

查看具有相同功能的两段代码，大多数人都会同意哪一个在给定方面（性能、可读性、可维护性、可测试性……）下“更好”。困难的部分是三个：

*   如何平衡不同的方面
*   如何同意这段代码**足够好**
*   如何在不破坏任何东西的情况下将糟糕的代码变成足够好的代码。

第一点可能是最难的，也是一个社会问题和工程问题。但其他点可以学习。我不知道任何采用这种方法的正式课程，但也许你可以在内部组织一些东西：从两个人一起写到“研讨会”，你可以在其中获取一段讨厌的代码并讨论如何改进它。

* * *

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2020-02-18T10:12:35.573

不确定它是否真实，但我在这里有一些小建议。据我了解，您提出了有关将单元测试增量非侵入性集成到大量遗留代码中的方法问题，许多利益相关者保护他们的沼泽。

通常，第一步是独立于所有其他代码构建您的测试代码。即使是长期遗留代码中的这一步也非常复杂。我建议将您的测试代码构建为具有运行时链接的动态共享库。这将允许您仅重构一小段测试不足的代码，而不是整个 20K 文件。因此，您可以开始逐个功能覆盖，而无需触及/修复所有链接问题

# c# - 从 ThreadID 获取 ThreadName

> ID：748512
> 
> 赞同：8
> 
> 时间：2009-04-14T17:07:59.893
> 
> 标签：c#, .net, multithreading

有没有办法从 ThreadId 中获取 Thread 的 ThreadName？（例如，像 10 或 15 等的 ThreadID）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-14T17:11:45.407

不在托管代码中。[`Thread`](http://msdn.microsoft.com/en-us/library/system.threading.thread.aspx)据我所知，您甚至无法获得当前进程的对象列表。你可以得到`ProcessThread`s[`Process.Threads`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.threads.aspx)并`ProcessThread`提供一个[`Id`](http://msdn.microsoft.com/en-us/library/system.diagnostics.processthread.id.aspx)属性，如果这对你有帮助的话......但[`ProcessThread`](http://msdn.microsoft.com/en-us/library/system.diagnostics.processthread.aspx)据我所知， a 没有名字:(

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T17:21:41.483

我能找到的最好的信息在这里：

[http://www.mail-archive.com/advanced-dotnet@discuss.develop.com/msg07369.html](http://www.mail-archive.com/advanced-dotnet@discuss.develop.com/msg07369.html)

不过，这似乎并没有太大帮助。似乎没有什么好的方法可以做到这一点，除非您更改代码以维护所有应用程序线程的列表（或字典）。

# algorithm - 在给定开始/结束时间数组的情况下查找总空闲时间的算法

> ID：748516
> 
> 赞同：6
> 
> 时间：2009-04-14T17:09:11.467
> 
> 标签：algorithm

假设你有一个开始和结束时间。

此外，您还获得了一系列工作，由它们的开始和结束时间描述。这些作业可能重叠（即，可以同时运行多个作业）。我需要找到一种方法来确定有多少时间闲置而没有运行任何工作。

当然，如果任何时候只能运行一个作业，我可以减去每个作业的运行时间，但重叠部分让我很难过。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-14T17:12:47.197

对时间进行排序，然后按顺序遍历它们。
如果某个时间是开始时间，则将正在运行的任务数加 1。
如果是停止时间，则减 1。
跟踪任务数为 0 时还有多少时间。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-14T17:14:06.430

将所有开始和结束时间放入一个数组中，将它们标记为开始时间或结束时间。按时间对数组进行排序。现在遍历排序列表，记录有多少作业正在运行：

*   读取开始时间时递增计数器
*   读取结束时间时递减计数器

每当您从零增加到一时，将 (current_time - previous_time) 添加到总空闲时间。如有必要，请记住还要对开始和结束进行特殊处理。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-14T17:23:28.967

这是一种略有不同的方法。第一部分用于说明目的。

创建一个整数数组，表示所有作业的完整时间线。这可以是几小时、几分钟或任何您需要的时间。我会假设几个小时。找到最早开始时间和最晚结束时间来设置数组的大小。将所有元素初始化为零。

循环遍历每个作业，为作业运行的每一小时增加时间轴中的计数器。因此，如果作业从下午 3 点运行到下午 5 点，则为两个小时，因此您将增加 3 小时和 4 小时的时间段以指示作业在这些时间段内运行。

循环遍历时间线，记录您遇到的零。这些是没有作业运行的时间段。

现在，如果您了解这一点，那么摆脱数组就很容易了。无需创建（可能很大）数组，只需跟踪整个时间线的开始和结束时间。对于该范围内的每个小时，循环遍历所有作业，并查看在此期间有多少作业在运行。任何为零的都是空闲时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T17:38:35.547

```
Sort the jobs based on their end times.

Jobs<startTime,EndTime>[] = contains the Sorted list.

Take first Job in the list
Jobs[0]

intialize:
    EndTime = Job[0].EndTime
    StartTime = Job[0].StartTime
     idleTime =0;

For i = 1 till Jobs.size
{
    if ( Jobs[i].EndTime >= StartTime )
    {
        //Do nothing, its overlapping
    }
    else
    { //Previoys Job time doesnot overlap, so get the idle time.
        idleTime += (StartTime -Jobs[i].EndTime);
    }

     StartTime = Jobs[i].StartTime;
     EndTime = Jobs[i].EndTime;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T17:39:19.880

当一个或多个作业正在运行时，您有大量的忙碌时间。空闲时间是繁忙块之间时间跨度的总和。伪代码：

```
idle_time = 0
sort jobs by start time
foreach job in jobs
{
  if (job.start > current_chunk.end)
  {
    idle_time += job.start - current_chunk.end
  }
  if (job.end > current_chunk.end)
  {
    current_chunk.end = job.end
  }
} 
```

注意：为简单起见，我省略了处理第一个元素的代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-04T12:50:51.870

我们有 2 个工作的开始时间和结束时间数组。作业可以重叠，如以下两个示例数组中所示。

```
startTime = [2.1, 5.0, 8.3, 14.1 ,16.5, 24.2 ,28.1, 40.6 ,42.3 , 45.4 ]
endTime =  [4.0 ,10.0 ,9.3 ,18.1 ,26.5 ,25.3, 36.6 ,60.6, 44.3 ,55.4] 
```

我们必须计算系统的空闲时间。在这种情况下，计算是： `Total idle time = 2.1 + (5.0-4.0) + (14.1-10.0) + (28.1-26.5) + (40.6-36.6) = 12.8 units`

所以，解决方案是：

```
startTime = [2.1 , 5.0  , 8.3 , 14.1 , 16.5 , 24.2 , 28.1 , 40.6 , 42.3 ]
endTime =   [4.0 , 10.0 , 9.3 , 18.1 , 26.5 , 25.3 , 36.6 , 60.6 , 44.3 ]

if len(startTime)>0:
    idleTime = startTime[0];
    eT =  endTime[0];
    i = 1 
    while i < len(startTime):
        if startTime[i]>eT:
            idleTime += (startTime[i] -eT)
            eT = endTime[i]
        else:
            if endTime[i]>eT:
                eT = endTime[i]
        i+=1
    print("Idle Time is : " , idleTime )    
else:
    print ("Idle Time is : " , 0 ) 
```

# scalability - 可扩展的云计算服务

> ID：748520
> 
> 赞同：0
> 
> 时间：2009-04-14T17:10:26.017
> 
> 标签：scalability, cloud

我正在寻找具有以下要求的云计算服务：

*   无需管理服务器
*   即时可用性
*   自动缩放
*   运行任务至少几分钟的能力

除了进程只能运行 30 秒之外，Google App Engine 似乎满足了所有这些要求。

我的应用程序是一个网站，可在用户请求时为用户执行一些繁重的计算。我希望负载在一半时间内接近于零，并且最多同时运行数百个任务。

这样的事情存在吗？

编辑：这些是我已经看过的服务，以及为什么它们对我不起作用：

*   Amazon EC2 - 需要服务器管理，我无法在几秒钟内从 0 台服务器变为 1 台服务器
*   Amazon MapReduce - 启动需要几分钟。如果它在几秒钟内可用，这将是我会使用的
*   Microsoft Azure - 正如 Alan 所说，它仍然需要服务器管理
*   Google App Engine - 任务只能持续 30 秒

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T17:14:21.453

我相信亚马逊的 EC2 符合您的要求。

[亚马逊 EC2](http://aws.amazon.com/ec2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T17:34:16.913

除了前面提到的 Amazon EC2 和 Microsoft Azure 平台之外，Rackspace 的[Mosso将是您的另一个选择。](http://www.mosso.com/)

我使用过 EC2，它对我来说效果很好。它没有任何内置工具可以根据服务器负载自动启动新服务器。[不过，为此， RightScale](http://www.rightscale.com/)和[CloudKick](https://www.cloudkick.com/)等第三方公司可以帮助您管理云服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T17:16:10.263

你可以使用[微软 Azure](http://www.microsoft.com/azure/default.mspx)，它在 CTP 中是免费的，直到今年秋天。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T17:23:42.943

[Windows Azure](http://www.microsoft.com/azure/default.mspx)发布后，或许能够满足您的需求。它的级别低于 Google App Engine，但它应该为您管理可扩展性和可用性。它有两种进程——web 和worker。Web 进程用于前端，工作进程用于后台处理。听起来这正是您正在寻找的。

通过一点点机器设置，您也可以使用 Amazon EC2 和附加服务来做同样的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T17:29:57.080

Amazon Elastic MapReduce 将为您执行此操作：

[http://aws.amazon.com/elasticmapreduce/](http://aws.amazon.com/elasticmapreduce/)

您将不得不设置服务器的数量和其他高级参数，但对于运行大型计算作业，您可能会找到最好的方法。

# objective-c - 在 Objective-C 表达式中使用常量变量？

> ID：748521
> 
> 赞同：1
> 
> 时间：2009-04-14T17:10:32.757
> 
> 标签：objective-c, scope, constants

在 Java 中

> `static final int VCount = 21, TCount = 28, NCount = VCount * TCount;`

在 Objective-C 中

> `static int VCount = 21, TCount = 28, NCount = ???;`

我如何表达**NCount** int 因为它指的是变量？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-14T17:19:32.923

这些变量不是常数。通常在 Objective-C 中，您会使用预处理器定义基本常量并将它们放在共享头文件中。例如：

```
#define VCOUNT 21 
```

以这种方式创建的常量通常全部大写。另一种约定是在共享源文件（所有内容都链接到的文件）中创建符号并将其声明为外部符号。Cocoa 使用定义明确的键值来实现这一点。例如，在共享头文件中，您将定义变量：

```
extern const NSString *myGlobalKey; 
```

然后在某个源文件中，定义变量的实际值（在文件范围内）：

```
const NSString *myGlobalKey = @"MyGlobalKey"; 
```

如果您的类只是使用全局常量变量并且值不需要在您的类之外的范围，则可以使用这些技术中的任何一种并且根本不在任何共享头文件中为它们提供定义。

# ajax - 如何制作 AJAX 电子表格或可编辑和可导航的 Web 表格/网格？

> ID：748527
> 
> 赞同：3
> 
> 时间：2009-04-14T17:11:29.433
> 
> 标签：ajax, spreadsheet

[今天的许多 Web 应用程序](http://ajax.phpmagazine.net/2007/03/ajax_spreadsheets_roundup.html)都有电子表格。我试图制作一个非常相似的表格，但功能有所降低：

1.  可编辑单元格
2.  按箭头键，或者会让您转到当前单元格旁边的单元格（在正确的方向上）

我找到了[ext grid](http://extjs.com/deploy/ext/docs/output/Ext.grid.Grid.html)和[YUI DataTable](http://developer.yahoo.com/yui/datatable/)，除了它们是可编辑的之外，我还没有找到一种简单的方法让它们可以通过键盘导航。

任何人都知道如何正确配置它们？有人知道另一个可以帮助我的 JS 库吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T17:17:37.187

使用其中任何一个网格，只需观看键盘按键事件。检查它是否是箭头，如果是，则移动焦点。这两个网格都支持通过代码选择单元格，所以你应该很高兴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T17:21:03.170

[http://os.arandomurl.com/jqueryspreadsheet/](http://os.arandomurl.com/jqueryspreadsheet/) 箭头工作

[http://plugins.jquery.com/project/sheet](http://plugins.jquery.com/project/sheet)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-24T02:17:22.163

试试[Gelsheet](http://gelsheet.sourceforge.net) 一个类似 Google Doc 的应用程序（精简版），但是是开源的！您可以根据需要安装和自定义。也有 wordpress、opengoo 和 fengoffice 的插件。

祝你好运 ！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-26T17:09:40.143

有一个名为[jqGrid](http://trirand.com/blog/jqgrid/jqgrid.html)的 jQuery 插件。听起来很不错。

# .net - 为什么我的 App.Config 代码库不能帮助 .NET 定位我的程序集？

> ID：748535
> 
> 赞同：1
> 
> 时间：2009-04-14T17:12:57.727
> 
> 标签：.net, .net-assembly, codebase

我有以下客户端应用程序及其相应的`config`文件：

```
namespace Chapter9
{
    class Program
    {
        static void Main(string[] args)
        {
            AppDomain.CurrentDomain.ExecuteAssembly("AssemblyPrivate.exe");
        }
    }
}

<configuration>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <codeBase href="file://C:\Users\djpiter\Documents\Visual Studio 2008\Projects\70536\AssemblyPrivate\bin\Debug\AssemblyPrivate.exe"/>
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration> 
```

`AssemblyPrivate.exe`没有公钥，也不位于 GAC 中。据我所知，运行时应该先解析`app.config`文件，然后再在客户端应用程序目录中查找程序集。

未处理的异常（为便于阅读而包装）是：

```
Unhandled Exception: System.IO.FileNotFoundException: Could not load file or assembly
'file:///C:\Users\djpiter\Documents\Visual Studio 2008\Projects\70536\Chapter9\bin\Debug\AssemblyPrivate.exe'
or one of its dependencies. The system cannot find the file specified. 
```

为什么它不工作？我需要使用动态绑定（不是静态的）。

亲切的问候，PK

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T17:17:23.583

不要忽视“*或其依赖项之一*”。您确定所有 AssemblyPrivate.exe 的依赖项都可用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-17T07:04:01.523

您现在可能已经自己解决了这个问题，仅供参考：

我相信您缺少“assemblyIdentity”元素。如果您在 codeBase 元素中另外指定它，它应该可以工作。

```
 <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="office"
                  publicKeyToken="71e9bce111e9429c" />
        <codeBase href="Microsoft.Office.Interop.v11.dll" version="11.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime> 
```

请参阅[http://msdn.microsoft.com/en-us/library/b0yt6ck0%28v=VS.100%29.aspx](http://msdn.microsoft.com/en-us/library/b0yt6ck0%28v=VS.100%29.aspx)

# windows-installer - 如何以编程方式删除广告的快捷方式？

> ID：748540
> 
> 赞同：0
> 
> 时间：2009-04-14T17:14:22.810
> 
> 标签：windows-installer, advertised-shortcut

所以我搞砸了一个 msi 安装程序并在仅测试安装后部署它，而不是卸载（我知道，安装后添加了一个 exe 的运行，但忘记指定它应该只在安装而不是卸载时发生）。

我找到了[Windows Installer Cleanup](http://support.microsoft.com/kb/290301)实用程序，以及我将用于自动化该过程的相关 msizap。现在的问题是，当之后在顶部安装较新版本时，广告中的快捷方式仍会尝试进行修复（或尝试加载旧版本实际上正在执行的任何操作）并失败。直接从文件运行程序工作正常，但我需要以自动方式删除广告的快捷方式。它现在不需要非常强大，相当小的私人测试版安装基础，因此可以假设快捷方式位于桌面和开始菜单的最初安装位置。

对于广告的快捷方式，我是否需要考虑任何特殊问题，或者我可以将其视为任何其他文件并删除它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T22:15:56.067

就快捷方式而言，它只是一个可以删除的普通文件。

但是，我会提醒您使用 MSIZAP - 它确实是*最后的手段*，并且留下了很多信息、共享的 DLL 计数、注册表项、文件等。一旦删除了 Windows Installer 信息，您就需要删除与您的程序从注册表。SharedDLL 引用计数是最糟糕的事情，因为当您尝试使用新的 MSI 重新安装/卸载时，它们会搞砸。

Rob 有一篇很好的帖子详细介绍了[使用 MSIZAP 的一些陷阱](http://robmensching.com/blog/posts/2009/3/6/More-on-Haacks-Troubleshooting-Windows-MSI-Installers)。除非您准备手动搜索它留下的所有注册表信息，否则您不想使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T17:53:09.410

AFAIK 广告的快捷方式负责进行设置。
这些是特殊的 lnk 文件，它们指向带有 spicel 参数的安装程序，当它们被激活时将执行设置（您可以使用记事本或十六进制编辑器查看信息）。
无论如何，MSI zap 应该已经删除了所有设置的痕迹。
如果您执行 zap 然后按快捷方式，设置是否会运行？或者你得到一个错误？

# java - 将 JSON 字符串转换/映射到 javabean 的最简单方法是什么？

> ID：748541
> 
> 赞同：4
> 
> 时间：2009-04-14T17:14:30.690
> 
> 标签：java, json

我有一个我读入的 JSON 字符串，并希望将其解析/映射到 JavaBean，以便我可以在我的 Java 代码中使用它。实现这一目标的最简单方法/库是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T20:27:27.760

I wrote a JSON library to do just that..

[http://code.google.com/p/svenson/](http://code.google.com/p/svenson/)

With svenson you would do something like:

```
// assume json to be a JSON dataset as String
MyBean bean = JSONParser.defaultJSONParser().parse(MyBean.class, json); 
```

Svenson gives you free choice of either using maps/lists or your own POJOs to convert data to and from JSON.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T23:12:07.727

[杰克逊](http://jackson.codehaus.org/Tutorial)呢？就像提到的其他一个一样，映射非常简单：

MyBean bean = new ObjectMapper().readValue(json, MyBean.class);

处理地图、列表、原语、bean；具有适当的泛型支持和映射过程的完全可配置性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T17:18:56.810

XStream 以其易用性而闻名，并支持 JSON：

[http://x-stream.github.io/json-tutorial.html](http://x-stream.github.io/json-tutorial.html)

# sql-server - 如何查找重复的字段组合

> ID：748542
> 
> 赞同：0
> 
> 时间：2009-04-14T17:14:47.707
> 
> 标签：sql-server, sql-server-2005, tsql

我有一个包含 id、a 和 b 列的表。

a+b 应该是唯一的，但这是一个未正确约束的遗留数据库。如何为 a+b 不唯一的记录获取一组 id？

如果我有

```
ID A B
1  2 3
2  2 3
3  1 3
4  1 4 
```

然后我想从查询中取回记录 1 和 2。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T17:17:50.680

```
select
    id, a, b

from your_table t

join (select a, b from your_table group by a, b having count(1) > 1) dup on dup.a = t.a and dup.b = t.b 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T17:23:15.863

要取回第 1*行*和第 2 行（如您所述），请使用以下命令：

```
SELECT
  *
FROM
  your_table
  INNER JOIN (
    SELECT a, b FROM your_table GROUP BY a, b HAVING COUNT(*) > 1
  ) dupes ON 
    your_table.a = dupes.a AND
    your_table.b = dupes.b 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T04:03:27.157

使用窗口函数稍微快一点：

```
select *
from (
     select
        a
     ,  b
     ,  cnt = count(*) over ( partition by a, b )
     from your_table
) x
where cnt > 1; /* Dupe */ 
```

# c++ - Internet Explorer 控件不会加载 CSS 和 JS

> ID：748547
> 
> 赞同：2
> 
> 时间：2009-04-14T17:17:06.453
> 
> 标签：c++, internet-explorer, winapi, controls, wxwidgets

我在 Win32 应用程序中嵌入了一个 IE 控件。此应用程序的唯一目的是确保始终加载 URl 并每 N 分钟刷新一次。

我的问题是几乎总是第一次访问 URL 时没有加载 CSS 和 JS 文件。此行为在应用程序运行时随机重复。

我的网络服务器甚至没有注册浏览器获取 CSS 和 JS 文件的尝试。我不知道为什么，但浏览器控件并不时不时要求它们。

任何人都知道可能导致这种不稳定行为的原因是什么？我该如何调试呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T01:05:08.707

如果目的是加载 URI，为什么要使用 IE 控件？您无法预测它何时会缓存。而是使用 WinInet API

[http://msdn.microsoft.com/en-us/library/aa383630(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa383630(VS.85).aspx)

[这是一个教程](http://www.dotnetheaven.com/Uploadfile/mahesh/WinInetIntroduction05242005061945AM/WinInetIntroduction.aspx)

您需要设置所需的缓存行为，但您可以直接编写您希望它执行的操作，而不依赖于控件的行为。您可以解析结果以确保正确（检查正确的 HTTP 结果、解析文本等）

# asp.net-mvc - 像 Html.DropDownList() 这样的 ASP.NET MVC 辅助方法是否对输出 HTML 进行编码？

> ID：748557
> 
> 赞同：2
> 
> 时间：2009-04-14T17:18:55.733
> 
> 标签：asp.net-mvc, html-helper

我只是想知道当我使用 HTML 帮助器（如`Html.DropDownList()`.

如果是这样，我如何对它们进行编码？如果我手动构建下拉列表，这很容易做到——只需用“ `Html.Encode()`”包装每个值。但是，我不知道在使用 HTML 帮助程序时如何做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T17:30:12.007

看起来值是自动编码的，所以没有理由自己做。下面是实际 ASP.NET MVC 1.0 源代码的片段，您可以从 codeplex（在 SelectExtensions.cs 中）下载它：

```
 private static string ListItemToOption(SelectListItem item) {
        TagBuilder builder = new TagBuilder("option") {
            InnerHtml = HttpUtility.HtmlEncode(item.Text)
        };
        if (item.Value != null) {
            builder.Attributes["value"] = item.Value;
        }
        if (item.Selected) {
            builder.Attributes["selected"] = "selected";
        }
        return builder.ToString(TagRenderMode.Normal);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T17:22:22.043

他们是这样。

如果你想自己做，这`Html.Encode()`取决于`Html.AttributeEncode()`你在 HTML 中编码的位置。

# php - 404 错误页面 ~ 重定向图像 - PHP

> ID：748567
> 
> 赞同：0
> 
> 时间：2009-04-14T17:20:50.393
> 
> 标签：php, apache, redirect

我在 PHP 应用程序中使用自定义 404 页面。

在那个 404 页面上，我检查某些不再存在的“已知”旧页面，然后将用户重定向到更新或最相关的当前页面。效果很好。

现在我面临着一系列已被删除的旧图像，并且正在**寻找一种将图像重定向到新图像的方法**（如果可能，全部在 php 代码中）。

我短暂地四处搜寻，却空无一人。

有什么办法可以做到这一点？

这是我的代码示例：

```
<?php
    //-- grab info regarding bad request --
    $root       = $_SERVER['DOCUMENT_ROOT'];
    $page       = parse_url($_SERVER['REQUEST_URI']);
    $page       = $page['path'];
    $referer        = $_SERVER['HTTP_REFERER'];
    $host       = $_SERVER['REMOTE_HOST'];

    //-- try to redirect old pages/files ----------------------
    //
    $page = urlencode($page);

    if ( stristr($page, "some_old_file.zip") ) {
        // Example file redirect
        echo    "<META HTTP-EQUIV=\"refresh\" CONTENT=\"0;URL=http://www.site.com/the/new/file.zip\">";

    } elseif ( stristr($page, "some_old_page.php") ) {  
        // example webpage redirect
        echo    "<META HTTP-EQUIV=\"refresh\" CONTENT=\"0;URL=http://www.site.com/the/new/page.php\">";

    } elseif ( stristr($page, "some_old_image.jpg") ) {
        // not sure how to do this ...
        // ...
        // ...
        // ...
        // ...
        // ...
        // not sure how to do this ...          
    } else {
        // everything else - direct to custom 404 search page
        echo    "<META HTTP-EQUIV=\"refresh\" CONTENT=\"0;URL=http://www.site/com/the/custom/404_help.php?page={$page}\">";
    }
    //
    // -------------------------------------------------------

?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T17:24:51.367

而不是输出元刷新，使用位置标头

```
header("Location: /path/to/image.jpg\r\n"); 
```

\r\n 只是用于分隔标题的新行。

注意：标头必须在任何其他输出之前发送

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T17:24:33.957

您将需要服务器端重定向。查看 php 函数“标头”和 http 状态代码 301（永久移动）。您会发现大量现成的 5 衬里解决方案。

如果我是你，我也会对 html 内容使用这种方法来通知搜索引擎相同内容的新位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T17:25:33.890

我的建议是使用 Apache 重定向（在您的 Apache conf 文件或 .htaccess 中）在 Apache 内部执行此操作。你可以这样做：

```
RedirectMatch old_file_path new_file_path 
```

这不仅会提高您的性能，而且您不必每次都进行查找。最好的部分是，如果您将来需要添加更多丢失的重定向，它将是可管理的。

# c# - Why ExecuteCodeWithGuaranteedCleanup doesn't work?

> ID：748573
> 
> 赞同：6
> 
> 时间：2009-04-14T17:21:46.333
> 
> 标签：c#

I was trying to "measure" stack depth. Why the following program doesn't print anything?

```
class Program
{
    private static int Depth = 0;

    static void A(object o) 
    {
        Depth++;
        A(o);
    }

    static void B(object o, bool e)
    {
        Console.WriteLine(Depth);
    }

    static void Main(string[] args)
    {
        RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(A, B, null);
    }
} 
```

Some answers simply include a quote from MSDN, like "Starting with the .NET Framework version 2.0, a StackOverflowException object cannot be caught by a try-catch block and the corresponding process is terminated by default." Believe me, sometimes (when there is enough stack space) it can be cought, the following prints some number just fine:

```
class Program
{
    private static int depth = 0;

    static void A(object o)
    {
        depth++;
        if (Environment.StackTrace.Length > 8000)
            throw new StackOverflowException("Catch me if you can.");
        A(o);
    }

    static void B(object o, bool e)
    {
        Console.WriteLine(depth);
    }

    static void Main(string[] args)
    {
        RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(A, B, null);
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T21:21:07.820

Regarding your edit, I don't think user code throwing a StackOverflowException is the same as the CLR throwing it.

There's a bit of discussion about it [here](http://bytes.com/groups/net-c/224083-help-me-understand-stackoverflowexception).

> Jeffrey's (Richter, author of [Applied Microsoft® .NET Framework Programming](https://rads.stackoverflow.com/amzn/click/com/0735614229) ) comment applies to real stack overflows, i.e. to stack overflows that occur if your code contains an infinite recursion, something like:
> 
> void MyMethod() { MyMethod(); }
> 
> If you throw the StackOverflowException yourself, it will be handled like any other exception, and Jeffrey's comment does not apply.
> 
> Also, Jeffrey's comment says: "if the stack overflow occurs WITHIN THE CLR ITSELF ...". So, if the .NET VM can detect the stack overflow "cleanly", i.e. without running ITSELF into a stack overflow, then you should get a StackOverflowException and your catch and finally blocks should execute as usual. But, in the tragic case where the VM ITSELF runs into a stack overflow, you won't be as lucky: the VM will not propagate a StackOverflowException (but crash in some other weird way) and your catch and finally blocks won't execute.
> 
> Morale is: be careful with infinite recursion because you don't have a 100% guarantee that the VM will detect and signal them cleanly!
> 
> Bruno.

Clarified who "Jeffrey" was since the OP was citing that book.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T21:14:12.047

If you want to catch it, load it into another process (that calls-back to yours via remoting) and lets the miscreant code execute there. The other process may terminate, and you *could* get a neat SOE popping out the end of the pipe on your side - without the adverse effects of the rather inconvenient exception.

Note that a separate AppDomain in the same process won't cut it.

If you want to get the stack trace from an exception the following code will do you great justice:

```
 class Program
    {
        static void Main(string[] args)
        {
            try
            {
                Recurse(0);
            }
            catch (Exception ex)
            {
                StackTrace st = new StackTrace(ex);
                // Go wild.
                Console.WriteLine(st.FrameCount);
            }
            Console.ReadLine();
        }

        static void Recurse(int counter)
        {
            if (counter >= 100)
                throw new Exception();
            Recurse(++counter);
        }
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-14T17:26:18.787

According to [MSDN](http://msdn.microsoft.com/en-us/library/system.stackoverflowexception.aspx):

> In prior versions of the .NET Framework, your application could catch a StackOverflowException object (for example, to recover from unbounded recursion). However, that practice is currently discouraged because significant additional code is required to reliably catch a stack overflow exception and continue program execution.
> 
> Starting with the .NET Framework version 2.0, a StackOverflowException object cannot be caught by a try-catch block and the corresponding process is terminated by default. Consequently, users are advised to write their code to detect and prevent a stack overflow. For example, if your application depends on recursion, use a counter or a state condition to terminate the recursive loop. Note that an application that hosts the common language runtime (CLR) can specify that the CLR unload the application domain where the stack overflow exception occurs and let the corresponding process continue. For more information, see ICLRPolicyManager Interface and Hosting the Common Language Runtime.

Due to this fact I don't believe that you will be able to do what you want to do as the `StackOverflowException will terminate the process.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T17:32:05.593

Starting with the .NET Framework version 2.0, a StackOverflowException object cannot be caught by a try-catch block and the corresponding process is terminated by default

# .net - 从 Winforms (.net) 将网格绑定到 Linq 数据源

> ID：748575
> 
> 赞同：1
> 
> 时间：2009-04-14T17:22:13.477
> 
> 标签：.net, winforms, linq, linq-to-entities, grid

回到过去（即上个月），我会将我的 winforms 网格绑定到数据集，然后关闭并运行。默认情况下，可以更新网格内容。（类似于 Excel 电子表格）

但是，如果我将网格绑定到 Linq 数据源（Linq to SQL 或 Linq to Entities），我的 winforms 网格将被锁定为只读模式。如何启用更新模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T05:49:13.323

您是否在投影中使用匿名类型？IE

```
select new {Foo = order.Foo, Bar = custmoer.Bar}; 
```

（或类似的） - C# 中的匿名类型是不可变的，所以是的：它看起来是只读的。但是，*常规*类（LINQ 生成的或您自己的）应该是可编辑的。唯一要记住的是调用`.ToList()`任何查询（而不是给它`IEnumerable<T>`/`IQueryable<T>`对象）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T05:54:36.993

查看`GetNewBindingList`“更好”绑定的各种类的方法。

完成后记得打电话`SubmitChanges`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T17:57:58.063

找到解决方案：使用 lambda 表达式过滤实体并直接绑定到实体。

# listview - 列表视图 UpdateCommand 传递空值

> ID：748578
> 
> 赞同：0
> 
> 时间：2009-04-14T17:23:10.310
> 
> 标签：listview

我正在尝试`listview`自动绑定和更新数据元素。在查看了大量示例和教程之后，我似乎仍然无法找到我的代码有什么问题。显示器工作得很好。只是更新命令失败。这是我的`SqlDataSource`节点：

```
<asp:SqlDataSource ID="MSSQLDataSource" runat="server"
                   ConnectionString="<%$ ConnectionStrings:DBConn%>"
                   DataSourceMode="DataSet"
                   SelectCommand="select isnull(visits, 0) as Visits, iis.VirtualName, iis.clientname, iis.devurl, iis.stagingurl , iis.liveurl from iissites iis left join (select count(*) as visits, VirtualName from devvisits group by VirtualName) dv on iis.VirtualName = dv.VirtualName order by visits desc" UpdateCommand="update iissites set clientname = @clientname, stagingurl = @stagingurl where VirtualName = @VirtualName">
    <UpdateParameters>
        <asp:Parameter Name="clientname" Type="String" />
        <asp:Parameter Name="stagingurl" Type="String" />
        <asp:Parameter Name="VirtualName" Type="String" />
    </UpdateParameters>
</asp:SqlDataSource> 
```

请注意，`@VirtualName`参数正在被拾取（但未绑定，因为它是 PK）。这是我的`asp:ListView`节点：

```
<asp:ListView DataSourceID="MSSQLDataSource" runat="server" DataKeyNames="VirtualName">            
    <LayoutTemplate>
        <table cellpadding="1">
            <tr id="Tr1" runat="server">
                <th>&nbsp;</th>
                <th id="Th2">Clent Name</th>
                <th id="Th1">Local Site</th>
                <th id="Th3">LHits</th>
                <th>Staging</th>
            </tr>
            <tr id="ItemPlaceHolder" runat="server" ></tr>
        </table>
    </LayoutTemplate>

    <ItemTemplate>
        <tr runat="server" class='<%# Container.DataItemIndex % 2 == 0 ? "row" : "row alt" %>'>
           <td class="command"><asp:ImageButton ImageUrl="images/edit.jpg"  ID="btnEdit" runat="server"  Text="Edit" CommandName="Edit" /></td>
            <td>
                <%#Eval("clientname") ?? "nbsp;" %>
            </td>
            <td align="left">
                <asp:LinkButton ID="LinkButton1" OnCommand="clickLink"
                                CommandName="devvisits" CommandArgument='<%#Eval("VirtualName") %>'
                                runat="server" ><%#Eval("VirtualName") ?? "nbsp;"%>
                </asp:LinkButton>
            </td>
            <td align="left">
                <%#Eval("Visits") ?? "nbsp;" %>
            </td>
            <td>
                <%#Eval("stagingurl") ?? "nbsp;" %>
            </td>
        </tr>
    </ItemTemplate>

    <EditItemTemplate>
        <tr id="TrEdit" runat="server">
            <td>
                <asp:ImageButton ImageUrl="images/cancel.jpg" runat="server" CommandName="Cancel" />
                <asp:ImageButton ImageUrl="images/save.jpg" runat="server" ID="UpdateButton" CommandName="Update" />
            </td>
            <td>
                <asp:TextBox ID="clientname" runat="server" Text='<%#Bind("clientname") %>'  ></asp:TextBox>
            </td>
            <td align="left">
                <asp:Label ID="VirtualName" runat="server">
                    <asp:LinkButton ID="LinkButton2" OnCommand="clickLink"
                                    CommandName="devvisits"
                                    CommandArgument='<%#Eval("VirtualName") %>'
                                    runat="server" ><%#Eval("VirtualName") %>
                    </asp:LinkButton>
                </asp:Label>
            </td>
            <td align="left">
                <asp:Label ID="DevHits" runat="server">
                   <%#Eval("Visits") %>
                </asp:Label>
            </td>
            <td align="left">
                <asp:TextBox ID="TextBox2" runat="server" Text='<%#Bind("stagingurl") %>'  ></asp:TextBox>
            </td>
        </tr>
    </EditItemTemplate>
</asp:ListView> 
```

对于任何反馈，我们都表示感谢。

-杰西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-04T16:21:59.660

我也为此苦苦挣扎，找到了一个工作区，但它真的很丑。我从 ListView ItemUpdating 事件中的控件获取值，将值存储在局部变量中，然后处理 objectdatasource 更新事件，使用这些值设置对象的属性。我使用 objectdatasource 的 DataObjectTypeName。不喜欢那个解决方案，但它是唯一对我有用的东西，我可以继续……

# c# - 单击编辑时以编程方式更改 EditRowStyle

> ID：748583
> 
> 赞同：1
> 
> 时间：2009-04-14T17:24:16.327
> 
> 标签：c#, asp.net, gridview, editing

我有一个 ASP.NET(2.0 using C#) web 应用程序，其中有一个 gridview。我有一个编辑列，但我没有使用常规的编辑功能。单击编辑时会发生其他事情。

我想知道如何更改`GridView_RowEditing`函数中单击 Edit 的行的样式？

我试过这个：

```
 protected void Grid_RowEditing(object sender, GridViewEditEventArgs e)
    {
     Grid.Rows[e.NewEditIndex].BorderStyle = BorderStyle.Groove;
     //Do some Other things 
    } 
```

当我单击它时，其他功能有效，但样式没有改变。我要做的就是更改editRow 的样式，以便我可以分辨它是哪一个。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T04:30:09.287

据我了解，您可以在 GridView 中为 SelectedItem 设置特定样式。然后当点击编辑按钮时，你可以这样做 -

```
grdView.SelectedIndex = e.NewEditIndex; 
```

完成此操作后，编辑模式下的行将被选中，并应用“SelectedItem”样式。

# apache - CNAMES 慢吗？

> ID：748584
> 
> 赞同：17
> 
> 时间：2009-04-14T17:24:20.947
> 
> 标签：apache, dns, amazon-s3, amazon-web-services

我将 CNAME 与 S3/CloudFront 一起使用来提供一些静态文件，如 js、css、图像等。

我这样做是为了使存储桶的 URL 漂亮，因为我认为最好将所有目标都定位到我的网站，以防将来我想移动这些文件，更改应该是透明的。

今天阅读博客，我看到一些人认为 CNAME 不利于速度。

那么，该怎么想呢？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-14T17:29:05.117

CNAMES 使用 DNS 查找添加了另一层间接性，因此会产生一些惩罚。但是，一旦通过 DNS 查找了 IP，它应该保持缓存状态，并且该客户端不应再发生惩罚。

确保在您的 DNS 条目中正确设置到期时间，您应该不会看到任何明显的延迟。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-14T18:10:16.047

根据其他答案，使用 CNAME 只会导致非常小的额外 DNS 解析延迟，并且只有当结果尚未在递归 DNS 服务器的缓存中时。

请注意，DNS 客户端通常不会明确要求 CNAME 记录。通常，他们会询问他们实际想要的任何记录类型——对于一个将是一个`A`或`AAAA`记录的网络浏览器。

上游服务器的工作就是识别出被查询的域名里面有CNAME条目，然后查找并返回目标结果。在这种情况下，CNAME 记录和所需结果都会在 DNS 响应的*答复部分*中返回（而不是在其他人回答的*附加部分中）。*

为获得最佳性能，最好将 CNAME 的目标托管在与包含 CNAME 的域名相同的权威 DNS 服务器上，以便无需进一步的 DNS 请求即可完成 CNAME 解析。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-14T17:44:15.983

在大多数情况下，使用 CNAME 的影响非常小。DNS 响应格式允许服务器在消息中添加一些额外的数据，并且在很多情况下，当您查找 CNAME 记录时，服务器会在附加数据部分添加相应的 A 记录，因此无需再查找。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-14T17:32:47.853

使用 CNAMES 需要注意的一件事是，如果 CNAME 的目标未缓存，则需要再次查找，正如 Ben S 所说。

但是，如果 CNAME 的目标是另一个 CNAME，那么它将需要 YET ANOTHER 查找，令人作呕。

我建议不要将您的 CNAME 指向另一个 CNAME。

# c# - 我应该如何跟踪正在使用的 Objs，C#

> ID：748591
> 
> 赞同：2
> 
> 时间：2009-04-14T17:24:59.883
> 
> 标签：c#

我有一个管理器连接到服务器。我保持连接处于活动状态，我希望我的线程在需要时请求连接。我的问题是

我如何自动跟踪对象？我希望它类似于作用域指针。我请求连接，然后当我的 obj 超出范围时，它会告诉管理器它不再使用。我不会将它作为指针传递。我会做类似的事情

```
{
Obj = Man.GetObj();
//some loop
    Obj.DoSomething()
} //auto tell man that obj is no longer in use 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T17:28:32.700

您可以创建自己的包装对象并实现`IDisposable`。在该`Dispose()`方法中，向经理发出您不再使用的信号。然后你可以让你的陈述像......

```
using(Obj obj = Man.GetObj())
{
    Obj.DoSomething();
} 
```

该`using`块在范围关闭时自动调用该`Dispose()`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T17:26:24.467

查看 using 语句。

[MSDN](http://msdn.microsoft.com/en-us/library/yh598w02(VS.80).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T17:27:12.453

实现 IDisposable 接口，并使用**using**关键字

```
类 MyClass : IDisposable
{
    无效处置（）
    {}
}

使用(MyClass obj = Man.GetObj())
{
    obj.DoSomething();
}// obj.Dispose() 将在对象超出范围时被调用。

```

# c# - 查找列表中元素的最佳位置

> ID：748596
> 
> 赞同：1
> 
> 时间：2009-04-14T17:25:58.117
> 
> 标签：c#, .net, algorithm, list, sorting

我有按特定顺序填充的 List 集合（要求是，此顺序不能更改）。此列表包含实体类型对象。

在列表的初始填充之后，我需要插入更多来自另一个数据源的对象。这些对象需要插入到特定的位置，这样排序才是正确的。

例如，如果初始列表具有以下元素

1.  AAA
2.  AAB
3.  AAC
4.  ACC
5.  ADA

在初始填充后，我想插入“ABB”元素，它需要插入 3 到 4 之间。

目前我有以下方法可以找到新元素的正确位置。

```
 private static int FindPositionForArticle(string word)        
    {
        string key = word.ToLower();
        for (int i = word.Length; i >= 0; i--)
        {
            if(i < word.Length)
                key = key.Remove(i, 1);

            int pos = 0;
            int insertPos = 0;
            foreach(ArticleEntity article in list)
            {
                if(article.Text.ToLower().StartsWith(key))
                    insertPos = pos;
                else if (!article.Text.ToLower().StartsWith(key) && insertPos > 0)
                    return insertPos++;
                pos++;
            }
        }
        return 0;
    } 
```

这种方法背后的目的思想：

1.  取需要插入的“word”并尝试找到与“word”同名的元素的位置

2.  如果没有找到任何内容，请从“word”中删除最后一个字符并再次搜索。

3.  重复删除最后一个字符，直到找到最佳位置。

不幸的是，我的方法有错误（实施不正确）。目前我的方法建议最佳位置为 0，这是完全不正确的。

如果您想使用我的示例代码，您可以在以下位置下载它：

[http://dl.getdropbox.com/u/204110/FindPosition.cs.txt](http://dl.getdropbox.com/u/204110/FindPosition.cs.txt)

先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T17:29:28.033

```
int index = list.BinarySearch(word); 
```

如果 index 为正数或零，则表示已在列表中找到该项目。如果为负，则它包含列表中下一个最高项目的索引的按位补码。

所以，为此：

```
List<string> list = new List<string>{"AAA","AAB","AAC","ACC","ADA"};
int index = list.BinarySearch("ABB"); // => -4
int insertIndex = ~index; // => 3
list.Insert(insertIndex, "ABB"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T17:40:02.327

字符串类型的[SortedList](http://msdn.microsoft.com/en-us/library/system.collections.sortedlist.aspx)不是更好吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T18:28:01.387

由于您使用的该列表可通过其索引访问，因此您可能希望实现类似于 Chris Doggett 的 anwser 的二进制搜索。与您当前按顺序实现的列表相比，这将为您提供更好的运行时：

您的运行时间当前与列表中的项目数呈线性关系，如果您像这样插入*n 个*项目，您将获得大约*n ^(2 个)*操作的运行时间。

使用二分搜索（`SortedList`顺便说一下，内部也是如此），您最终将获得更好的每次插入*log2* (n) 的运行时间，例如插入 n 项时的总运行时间 *n***log2(n)*。

二分查找的基本思想很简单：

1.  项目清单

2.  首先，您将完整范围作为可能的位置（左= 0，右=列表中的当前计数）

3.  如果左等于右，你找到了合适的位置

4.  否则，选择中间元素 (left+right)/2 并将其与要插入的键进行比较。

    *   如果比较的结果 < 0，则将 right 设置为中间 index-1，因此将下一次迭代的搜索范围重置为列表的左半部分
    *   如果结果大于0，你设置left为中间index+1，这样下一次搜索就在右边
    *   否则比较为 0 并且您有一个重复项，按照您的意愿处理（忽略或插入相同的索引），然后中断循环（参见 5。）
5.  在 3 处循环；搜索范围现在变小了...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T17:33:49.737

您是否考虑过使用[SortedList](http://msdn.microsoft.com/en-us/library/system.collections.sortedlist.aspx)数据结构？如果它将包含需要以某种特定方式排序的复杂数据类型，您可以指定一个[IComparer](http://support.microsoft.com/kb/320727)对象来创建它。

IComparer 唯一需要做的就是能够确定一个项目属于之前还是之后。鉴于此，SortedList 将正确地保持顺序。

使用这种结构可以保证按照您在内部指定的顺序保持不变，这样您就不必维护本质上实现排序的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T18:02:30.137

这段代码：

```
 private static System.Collections.SortedList list = new System.Collections.SortedList();

    static void Main(string[] args)
    {
        list.Add("AAA" , "AAA");
        list.Add("AAB", "AAB");
        list.Add("AAC", "AAC");
        list.Add("ACC", "ACC");
        list.Add("ADA", "ADA");
        Console.WriteLine("List before");
        for (int j = 0; j < list.Count ; j++)
        {
            Console.WriteLine(list.GetByIndex(j));
        }
        list.Add("ABB","ABB");

        Console.WriteLine(list.IndexOfKey("ABB"));

        for (int j = 0; j < list.Count; j++)
        {
            Console.WriteLine(list.GetByIndex(j));
        }

        Console.ReadLine();

    } 
```

正在将项目插入您需要的位置..

还是你需要别的东西？？不需要 Icompare，您正在对常见字符串进行排序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T19:30:07.507

我已经做了你想做的事情。您有一个 ArticleEntity 对象的列表。您需要对该列表进行排序。因此，首先您需要为您的班级添加排序功能。我的示例是在 VB 中，转换为 C# 应该不会太难。

像这样向您的班级添加排序：

```
 Public Class ArticleEntity
    Implements IComparable(Of ArticleEntity)

    Public Overloads Function CompareTo(ByVal Other As ArticleEntity) As Integer _
        Implements IComparable(Of ArticleEntity).CompareTo
        Return Me._PropertyToSort.CompareTo(Other._PropertyToSort)
    End Function 
```

然后，在您添加所有需要添加到 List Of(ArticleEntity) 的内容后，您可以：

```
MyListOfArticleEntities.Sort() 
```

我想这就是你要找的。如果不是，请告诉我。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-17T08:58:09.327

您的收藏*需要*是`List`?

如果您不需要在插入新元素之前访问列表中的元素，那么[堆](http://en.wikipedia.org/wiki/Heap_(data_structure))听起来会做得更好。基本上你会：

1.  将所有初始元素插入堆中
2.  稍后，以完全相同的方式插入额外的项目
3.  按排序顺序将每个项目从堆中读出到`List`.

这些步骤中的每一个都只是每个对象的 O(log n) 时间。我确定 C# 有堆的实现。

注意：我指的是数据结构意义上的“堆”，而不是全局内存池意义上的“堆”。

# .net - .net activeX 等价物

> ID：748603
> 
> 赞同：0
> 
> 时间：2009-04-14T17:28:22.480
> 
> 标签：.net, activex, client-server, client-side

是否有 ActiveX 的纯 .NET 替代品？我在问是否有办法让我编写一个厚客户端控件，以便在.NET 的网页中加载并与之交互，没有 com。

编辑：我不想在纯 .NET 中使用 ActiveX，我想要 ActiveX 的 .NET 替代品。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T17:30:54.317

恐怕没有完美的托管唯一等效于 ActiveX。主要是有充分的理由。ActiveX 是一种危险的安全技术，在许多方面复制它的影响需要复制缺乏安全性。

你试过银光吗？

它不是一个完美的 ActiveX 替代品，因为它不会授予您对机器的无限制访问权限。但它确实提供了在 .Net 中编写富客户端控件的能力。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T17:40:06.930

您可以使用[UserControl](http://msdn.microsoft.com/en-us/library/system.windows.forms.usercontrol.aspx)它可以嵌入到 IE 中，我不知道您所说的与 Web 浏览器交互是什么意思，但它可以在页面上调用脚本并发布可以由页面上的脚本处理的事件。
请注意，必须预先安装 .NET 才能使控件正常工作。
您也可以使用*JaredPar*提到的 Silverlight，但您的 api 会受到更多限制。

# sql-server - 自动将随机字符串分配给新记录

> ID：748605
> 
> 赞同：0
> 
> 时间：2009-04-14T17:28:42.730
> 
> 标签：sql-server, random

我已经有一个客户表，但从现在开始，必须在新列中为新记录分配一个*由 5 个字符组成的唯一随机字母数字字符串*。无论如何我可以做到这一点而不必使用触发器（插入时？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T17:41:54.553

调用函数的默认约束效果最好。但是，您应该检查将创建多少条记录。

虽然 5 个字符可能足以唯一标识您的预期记录数量（假设 AZ，0-9，我相信这大约是 6000 万个代码），但当您开始随机生成它们时，您可能会发现您很快就遇到了[生日悖论](http://en.wikipedia.org/wiki/Birthday_Problem)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T17:34:43.933

您可以使用调用生成随机字符串的函数的默认约束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T17:37:40.727

对于触发器：嗯..我会使用触发器它具有使用以前代码的优势。

但是您也可以创建一个存储过程，将您的插入内容包装到表中。

对于唯一的 5 个字符：您可以在初始集和时间上创建一个 md5，然后将其从基数 10 重新编码为基数 255。

剩余部分可以截断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T17:52:10.363

我有类似的情况，但在代码中生成字符串然后将其发送到数据库。当然，这是在一张很小的桌子上使用的，所以我不用担心速度。认为它可能会有所帮助，尽管它假设您使用的是 c#。

```
 /// Generates a string and checks for existance
    /// <returns>Non-existant string as ID</returns>
    public static string GetRandomNumbers(int numChars, string Type)
    {
        string result = string.Empty;
        bool isUnique = false;

        while (!isUnique)
        {
            //Build the string
            result = MakeID(numChars);
            //Check if unsued
            isUnique = GetValueExists(result, Type);
        }
        return result;
    }
    /// Builds the string 
    public static string MakeID(int numChars)
    {
        string random = string.Empty;

        string[] chars = { "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z" };
        Random rnd = new Random();
        for (int i = 0; i < numChars; i++)
        {
            random += chars[rnd.Next(0, 35)];
        }
        return random;

    }
    /// Checks database tables based on type for existance, if exists then retry
    /// <returns>true or false</returns>
    private static bool GetValueExists(string value, string Type)
    {
        bool result = false;

        string sql = "";
        if (Type == "URL")
        {
            sql = string.Format(@"IF EXISTS (SELECT COUNT(1) FROM myTable WHERE uniqueString = '{0}') 
            BEGIN 
                SELECT 1 
            END  
            ELSE  
            BEGIN 
                SELECT 0 
            END ", value);
        }
        //query the DB to see if it's in use
        result = //ExecuteSQL

        return result;
    } 
```

# apache - 我应该创建哪个：Apache 服务器扩展，还是从头开始创建服务器？

> ID：748609
> 
> 赞同：0
> 
> 时间：2009-04-14T17:29:48.437
> 
> 标签：apache, webserver

简而言之，我需要创建一个服务器，其后端从另一台服务器查询信息。我想知道其他人如何解决这个问题。

下面是对问题的详细描述：我需要创建一个服务器（称为此服务器 Alpha），该服务器根据客户端请求的网页向另一台服务器（称为此服务器 Omega）发出请求。这些请求是网络消息，而不是 SQL 查询。请求的信息将成为提供给 Alpha 客户的内容的一部分。例如，客户端可能想要显示好友列表。Alpha 会向 Omega 查询客户的好友列表。Alpha 然后显示一个带有好友列表的网页。

客户端无法直接连接到 Omega。服务器 Alpha 几乎只处理客户端连接，管理从客户端到 Omega 服务器的查询并提供新网页（可能包含从 Omega 查询的信息）。

我是网络开发的新手。我不太了解 Apache 模块。但是，似乎大部分功能已经在 Apache 中可用。似乎可以扩展 Apache 以发送从其他服务器 Omega 查询信息的网络消息。另一种选择是从头开始创建 Alpha 服务器。

你会使用哪种方法？还有另一种更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T17:37:14.737

如果没有更多关于你在做什么的细节，听起来这两种方法中的任何一种都过分了。如果我在现代 Web 编程环境中进行好友列表查询，我会考虑以下内容：

*   Server Alpha 是我的普通 Web 堆栈：Apache，我的应用程序服务器（例如，Rails 的Passenger，或Java 的JBoss 等）。
*   服务器 Omega 显然已经存在，所以我不会解决它。如果它不存在，它可能是另一个像 Alpha 一样配置的服务器。

鉴于：

*   来自用户的 Web 请求通过 www.Alpha 发送到 Alpha。
*   我在 Alpha 上的 Web 应用程序通过适当的协议连接到 Omega。这可能是 XMPP 来查询 Jabber 服务器、LDAP 或其他任何东西。Omega 返回它的结果。
*   Alpha 上的 Web 应用程序使用这些结果构建一个页面以返回给用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T17:34:38.520

听起来您想要反向代理或应用程序服务器。您对 Omega 实际返回的数据类型有点模糊——如果您希望 Omega 生成网页，请查看反向代理。Apache 有一个内置的代理模块，但我听说 Squid 有更好的性能：

*   [http://www.visolve.com/squid/whitepapers/reverseproxy.php](http://www.visolve.com/squid/whitepapers/reverseproxy.php)
*   [http://wiki.squid-cache.org/SquidFaq/ReverseProxy](http://wiki.squid-cache.org/SquidFaq/ReverseProxy)

如果 Alpha 和 Omega 使用自定义协议，那么您需要将 Omega 视为[应用服务器](http://en.wikipedia.org/wiki/Application_server)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T17:37:34.877

从它的声音来看，它是一种由相当普通的脚本网页提供服务的系统。例如，使用 PHP 脚本调用后端 Web 服务并生成包含信息的网页。需要多少处理，取决于 Omega 的输出与您希望 HTML 的外观之间的差异。

一个 Apache 模块似乎过于复杂——而一个全新的服务器完全是矫枉过正。

# ruby-on-rails - 在另一个域上使用 RESTful Web 服务的正确“Rails 方式”是什么？

> ID：748614
> 
> 赞同：55
> 
> 时间：2009-04-14T17:31:02.303
> 
> 标签：ruby-on-rails, rest

我想编写一个使用 RESTful Web 服务 API 的 Ruby on Rails 应用程序，对结果执行一些逻辑，然后在我的视图中显示该数据。例如，假设我想编写一个在 search.twitter.com 上进行搜索的程序。使用纯红宝石我可能会创建以下方法：

```
def run(search_term='', last_id=0)
  @results = []
  url = URI.parse("http://search.twitter.com")
  res = Net::HTTP.start(url.host, url.port) do |http|
    http.get("/search.json?q=#{search_term}&since_id=#{last_id.to_s}")
  end
  @results = JSON.parse res.body
end 
```

我很想将该方法作为私有方法放入我的 Rails 控制器，但我的一部分认为有更好、更“Rails”的方法来做到这一点。是否有最佳实践方法，或者这真的是最好的方法吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-04-14T17:42:56.267

有一个名为 HTTParty 的插件/宝石，我已将其用于多个项目。

[http://johnnunemaker.com/httparty/](http://johnnunemaker.com/httparty/)

HTTParty 让您可以轻松使用任何 Web 服务并将结果解析为您的哈希。然后您可以使用哈希本身或使用结果实例化一个或多个模型实例。我已经做到了两种方式。

对于 twitter 示例，您的代码如下所示：

```
class Twitter
  include HTTParty
  base_uri 'twitter.com'

  def initialize(u, p)
    @auth = {:username => u, :password => p}
  end

  # which can be :friends, :user or :public
  # options[:query] can be things like since, since_id, count, etc.
  def timeline(which=:friends, options={})
    options.merge!({:basic_auth => @auth})
    self.class.get("/statuses/#{which}_timeline.json", options)
  end

  def post(text)
    options = { :query => {:status => text}, :basic_auth => @auth }
    self.class.post('/statuses/update.json', options)
  end
end

# usage examples.
twitter = Twitter.new('username', 'password')
twitter.post("It's an HTTParty and everyone is invited!")
twitter.timeline(:friends, :query => {:since_id => 868482746})
twitter.timeline(:friends, :query => 'since_id=868482746') 
```

最后一点，您也可以使用上面的代码，但绝对将代码包含在模型中而不是控制器中。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-09-28T17:57:36.157

[Restclient](https://github.com/rest-client/rest-client)是解决这个问题的一个非常好的解决方案。

```
require 'rest_client'
RestClient.get 'http://example.com/resource'
RestClient.get 'http://example.com/resource', {:params => {:id => 50, 'foo' => 'bar'}} 
```

从[自述文件](https://github.com/rest-client/rest-client/blob/master/README.md)。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-14T17:39:21.363

如果远程 RESTful Web 服务也是使用 Ruby on Rails 创建的，那么[ActiveResource](https://github.com/rails/activeresource) 就是要走的路。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-14T17:40:20.830

作为对您的 Twitter 示例的响应，有一个[Twitter Gem](http://twitter.rubyforge.org/)可以帮助您自动执行此操作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-07-29T19:09:03.573

我认为法拉第在这里值得一提。非常好的界面，以及强大的中间件概念。

[https://github.com/lostisland/faraday](https://github.com/lostisland/faraday)

# security - Rijndael 和 AES 之间的差异

> ID：748622
> 
> 赞同：42
> 
> 时间：2009-04-14T17:33:10.050
> 
> 标签：security, encryption, encryption-symmetric

我正在研究加密算法 - 有人可以快速了解 Rijndael 和 AES 之间的区别吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-04-14T17:39:21.580

AES 是美国联邦标准[FIPS 197](http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf)，它是[Rijndael](http://web.archive.org/web/20070711123800/http://csrc.nist.gov/CryptoToolkit/aes/rijndael/Rijndael-ammended.pdf)的子集：

> AES 具有 128 位的固定块大小和 128、192 或 256 位的密钥大小，而 Rijndael 可以指定块和密钥大小为 32 位的任意倍数，最小为 128 位，最大为 256位。

来自[Wikipedia 上的高级加密标准](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2013-05-09T15:02:03.767

严格来说，高级加密标准 (AES) 不是一种算法。**AES 是**美国国家标准与技术研究院 (NIST) 定义的规范。AES 是数据加密标准 (DES) 的继承者。

AES 已于 2001 年 11 月 26 日在 FIPS PUB 197 中公布。联邦信息处理标准出版物 (FIPS PUB) 由 NIST 在美国商务部长批准后发布。

**Rijndael 是由 Joan Daemen 和 Vincent Rijmen 创建**的对称密钥加密算法。**它是一种分组密码，具有可变的块大小、可变的密钥长度和可变的轮数。块长度和密钥长度可以独立指定为从 128 位到 256 位的 32 位的任意倍数。**

 **Rijndael 密码被选为高级加密标准 (AES)。

在 Rijndael AES 变体中，块大小限制为 128 位，密钥长度仅限于 128、192 或 256 位。

*   [NIST 关于命名 AES/Rijndael 的文件](http://csrc.nist.gov/archive/aes/rijndael/Rijndael-ammended.pdf)
*   [NIST FIPS PUB 197](http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-13T16:39:13.530

实际上在 3DES（三重数据加密标准）的危机中，NIST 决定建立一个新的标准。AES 是基于 Rijndael 算法的算法实际采用的标准，这不过是两个研究科学家的组合，分别是 Rijmen 博士和 Daemen 博士，根据他们将块长度的大小固定为 128 位和密钥大小的算法128 或 256 位。后来在标准化时，在高级加密技术 (AES) 中提到，128 位的对称分组密码可以支持 128,192 和 256 位或 16,24 和 32 字节

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-08-06T07:41:54.473

AES 是 Rijndael 的简化版本，它仅定义为 128 位的块大小，而 Rijndael 定义为 128、192 和 256 位的块大小。如果在加密和解密之间使用不同的块大小，则无法恢复原始明文。

Rijndael-256 和 Rijndael-192 必须被视为与 AES (Rijndael-128) 完全不同的算法。它们本质上是不相容的。

# c# - C# 的皮棉

> ID：748631
> 
> 赞同：58
> 
> 时间：2009-04-14T17:36:43.367
> 
> 标签：c#, .net, code-analysis, lint

C# 有类似 lint 的工具吗？我有编译器将警告标记为错误，我有 Stylecop，但这些只捕获最严重的错误。是否有任何其他必备工具（尤其是对于像我这样的新手 C#ers）可以指出我正在做的可能愚蠢的事情？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-14T17:37:52.443

试过[FxCop](http://msdn.microsoft.com/en-us/library/bb429476.aspx)吗？它作为“代码分析”集成到 VS 中

在较新版本的 Visual Studio 中，它被称为“Microsoft Code Analysis”，可以从 Visual Studio Marketplace 下载：[https ://marketplace.visualstudio.com/items?itemName=VisualStudioPlatformTeam.MicrosoftCodeAnalysis2017](https://marketplace.visualstudio.com/items?itemName=VisualStudioPlatformTeam.MicrosoftCodeAnalysis2017)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-14T17:40:54.277

[Resharper](http://www.jetbrains.com/resharper/)执行了相当多的静态分析以及大量其他有用的事情。从[8.0 版](http://confluence.jetbrains.com/display/ReSharper/ReSharper+8+EAP)开始，分析可以在命令行模式下运行。目前，如果没有它，我不会在 C# 中编码。

除了 FxCop，[Gendarme](http://mono-project.com/Gendarme)是另一个值得关注的工具（它是 Mono 的 FxCop 版本，但它们的方法和实际发现的错误不同）。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2016-06-10T15:08:47.070

[SonarLint](http://www.sonarlint.org/visualstudio/index.html)（免费、开源）非常棒！

> 适用于 Visual Studio 的 SonarLint 基于 .NET 编译器平台（“Roslyn”）及其代码分析 API 并从中受益，可在 Visual Studio 2015 中提供完全集成的用户体验。SonarLint 是免费的、开源的，并且在 Visual工作室画廊。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-14T17:42:25.223

[Mono](http://mono-project.com/Gendarme)的宪兵类似于 FxCop

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T17:50:50.977

你可以试试 Red-Gate 的 .Net Reflector，你可以从[这里](http://www.red-gate.com/products/reflector/)得到它。CodePlex 上提供了许多有用的 .Net Reflector 插件，您可以从[此处](http://www.codeplex.com/reflectoraddins)获取。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-05-30T11:09:16.137

这个问题已经有了答案，但供参考...

你可以试试[**PVS-Studio**](http://www.viva64.com/en/pvs-studio/)。这不是免费的，但是，恕我直言，必须有一个。从他们的网站引用：

> PVS-Studio 是一种用于检测用 C、C++ 和 C# 编写的程序源代码中的错误的工具。
> 
> PVS-Studio 执行静态代码分析并生成帮助程序员查找和修复错误的报告。PVS-Studio 进行广泛的代码检查；但搜索错印和复制粘贴错误特别有用。
> 
> 该分析器专为使用 Visual Studio 的开发人员设计。

# c# - ListView 项目未在 GridView 列中呈现

> ID：748632
> 
> 赞同：0
> 
> 时间：2009-04-14T17:37:13.863
> 
> 标签：c#, .net, wpf, listview

我有一个 ListView 控件绑定到项目的 ObservableCollection，我已经将它的视图设置为 GridView，列绑定到属性数据。事情似乎没问题，但源属性中的数据根本没有被渲染。这是 ScanData 结构：

```
struct ScanData
{
    public ushort Port;
    public bool? Status;
    public string ServiceName;
} 
```

XAML：

```
<ListView IsSynchronizedWithCurrentItem="True" Width="Auto" Name="_resultsListView" ItemsSource="{Binding}" Height="138">
    <ListView.View>
        <GridView ScrollViewer.IsDeferredScrollingEnabled="True">
            <GridViewColumn Header="Port" Width="50" DisplayMemberBinding="{Binding Path=Port}"/>
            <GridViewColumn Header="Status" DisplayMemberBinding="{Binding Path=Status}"/>
            <GridViewColumn Header="Service" Width="231" DisplayMemberBinding="{Binding Path=ServiceName}"/>
    </GridView>
    </ListView.View> 
</ListView> 
```

代码隐藏（最相关的部分，无论如何）：

```
public partial class AddServerDialog
{
    PortScanner _scanner;
    ObservableCollection<ScanData> _resultList;
    Brush _defaultPortTextBorderBrush;

    public AddServerDialog()
    {
        this.InitializeComponent();
        _resultList = new ObservableCollection<ScanData>();
        _resultsListView.DataContext = _resultList;
    }

    // ...

    private void _addScanButton_Click(object sender, RoutedEventArgs e)
    {
        _resultList.Add(_scanner.CreateScan(ushort.Parse(_portText.Text)));
    }
} 
```

当我单击导致 _addScanButton_Click 触发的按钮时，我可以看到项目被添加到他呈现的 ListView 中（例如，行是可选的），但是三列中没有显示任何内容。DataContext 中的 ScanData 项都设置了 Port 属性，所以不应该在“Port”列中呈现数字吗？其他两个属性在运行时为空，所以我不希望看到它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T17:40:02.890

ScanData 上的数据必须是属性，而不是字段。

```
struct ScanData
{
    public ushort Port {get;set;}
    public bool? Status{get;set;}
    public string ServiceName{get;set;}
} 
```

# apache-flex - Flex：跨域图片加载？

> ID：748639
> 
> 赞同：1
> 
> 时间：2009-04-14T17:37:54.737
> 
> 标签：apache-flex, cross-domain

好的，我有一个使用 < mx:Image /> 标签加载产品图像并更改源的应用程序。.SWF 位于网站的 http 端，图片位于网站的 https 端。所以起初我收到了这个错误：

> SecurityError：错误 #2122：安全沙箱违规：Loader.content： [http](http://www.MYDOMAIN.com/Masonic.swf) ://www.MYDOMAIN.com/Masonic.swf 无法访问 [https://www.MYDOMAIN.com/masonic_images/13_red_d2-MAS72479bl_red.jpg](https://www.MYDOMAIN.com/masonic_images/13_red_d2-MAS72479bl_red.jpg)。需要策略文件，但在加载此媒体时未设置 checkPolicyFile 标志。在 flash.display::Loader/get content() 在 SmoothImage/ [http://www.adobe.com/2006/flex/mx/internal::contentLoaderInfo_completeEventHandl](http://www.adobe.com/2006/flex/mx/internal::contentLoaderInfo_completeEventHandl) er()

因此，经过一些研究，我发现了这篇文章：[http](http://www.damienking.net/tutorial-using-remotely-hosted-images-flex) ://www.damienking.net/tutorial-using-remotely-hosted-images-flex我按照它所说的做了，现在我得到了这个类似的错误：

> SecurityError：错误 #2123：违反安全沙箱：Loader.content： [http](http://www.MYDOMAIN.com/Masonic.swf) ://www.MYDOMAIN.com/Masonic.swf 无法访问 [https://www.MYDOMAIN.com/masonic_images/12_red_d2-MAS60338bl_red.jpg](https://www.MYDOMAIN.com/masonic_images/12_red_d2-MAS60338bl_red.jpg)。没有策略文件被授予访问权限。在 flash.display::Loader/get content() 在 SmoothImage/ [http://www.adobe.com/2006/flex/mx/internal::contentLoaderInfo_completeEventHandl](http://www.adobe.com/2006/flex/mx/internal::contentLoaderInfo_completeEventHandl) er()

同样，在我点击弹出的错误框后，图像确实会在之后加载，但随后会设置为实际图像的大小，而不是我设置组件的宽度和高度。我不知道该怎么做。

任何帮助表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T13:26:51.180

通过本文中的说明，我能够使用代理使其工作：[http ://raghuonflex.wordpress.com/2007/10/11/jsp-proxy-code-for-sourcing-cross-domain- images/?referer=sphere_related_content/](http://raghuonflex.wordpress.com/2007/10/11/jsp-proxy-code-for-sourcing-cross-domain-images/?referer=sphere_related_content/)我认为图像加载速度较慢，它可能不是理想的解决方案，但至少它现在可以工作，总比没有好。

# c# - 如何在表单帖子中获取查询字符串的值

> ID：748658
> 
> 赞同：2
> 
> 时间：2009-04-14T17:43:59.493
> 
> 标签：c#, asp.net-mvc

我有一个网址：

> ```
> /Account.aspx/Confirm/34a1418b-4ff3-4237-9c0b-9d0235909d76 
> ```

和一个表格：

```
<% using (Html.BeginForm())
   { %>
    <fieldset>
        <p>
            <label for="password" class="instructions">
                Contraseña:</label>
            <%= Html.Password("password") %>
            <%= Html.ValidationMessage("password", "*") %>
        </p>
        <p>
            <input type="submit" value="Validar" />
        </p>
    </fieldset>
<% } %> 
```

在控制器的动作中：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Confirm(string id, string password)
{
    //code
} 
```

我想获取 URL 中 GUID 的值（Confirm 之后的部分）和输入密码的值。

我怎样才能做到这一点？

**编辑：**

我已经注册了这条路线：

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
    routes.IgnoreRoute("Error.aspx/{*pathInfo}");
    routes.IgnoreRoute("Admin/{*pathInfo}");
    routes.MapRoute(
        "Default",
        "{controller}.aspx/{action}/{id}",
        new { controller = "Home", action = "Index", id = "" } 
    );
    routes.MapRoute("Root", "", 
            new { controller = "Home", action = "Index", id = "" });
} 
```

我认为任何事情都很奇怪，但是在 Confirm 操作的 id 参数中，我得到了一个空字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T00:21:36.820

这不是因为您发布的表单中没有 ID 吗？

您可以在表单页面上将模型设置为传入的 ID，然后为该 ID 分配一个隐藏的输入值...

```
<%@ Page Language="C#" MasterPageFile="~/Views/Shared/Site.Master"
Inherits="System.Web.Mvc.ViewPage<string>" %>

```

```
公共 ActionResult 确认（字符串 id）
{
   返回视图（id）；
}

```

现在 ViewData.Model 将包含您的 ID。把它放在你的表格里。

```
<input type="hidden" id="id" name="id" value="<%= ViewData.Model %>" />

```

然后，当您提交表单时，它将通过 ID。

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Confirm(string id, string password)
{
   //...现在您可以访问 ID 和密码
}

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T17:51:27.557

在您的 Global.asax.cs 中，为 Confirm 定义一个路由，指定 URL 的最后一部分是一个参数。

例如：

```
"Account/Confirm/{id}" 
```

MVC 框架会自动解析 URL 并在 id 参数中返回 GUID

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T17:53:25.773

您并没有真正指出要发回的 URL，只是用于表单的 URL，但试试这个：

```
var pathInfo = HttpContext.Request.PathInfo 
```

这应该返回`/Confirm/34a1418b-4ff3-4237-9c0b-9d0235909d76`，如果您有一个与此页面关联的路由，您可能可以使这更容易，只需将 GUID 命名为 RouteValue。如果您有路线发布它，我将很乐意提供帮助。

# xslt - XSLT 创建新的 HTML 标记

> ID：748664
> 
> 赞同：2
> 
> 时间：2009-04-14T17:44:53.160
> 
> 标签：xslt

如何在 XSLT 中创建新的 HTML 标记/节点？我从另一个变量中获取节点/标签名称。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T17:49:14.193

```
<xsl:element name="{$ELEMENT_NAME}">
  <xsl:attribute name="{$ATTRIBUTE_NAME}">
    <xsl:value-of select="$ATTRIBUTE_VALUE"/>
  </xsl:attribute>
  <content>
    <goes>
      <here/>
    </goes>
  </content>
</xsl:element> 
```

**编辑：**
您需要**{**和**}**作为“名称”属性，而不是“选择”属性。

[**在这里**阅读。](http://www.w3.org/TR/xslt#attribute-value-templates)

对不起！我自己在答案的第一个“版本”中忘记了它。

# c# - 层次结构与合并列表

> ID：748671
> 
> 赞同：0
> 
> 时间：2009-04-14T17:47:10.330
> 
> 标签：c#, .net

基本上在我的应用程序中，我想将用户创建的所有节点存储在一个全局列表中，比如：

```
GlobalComposition = { collection } 
```

它将存储如下节点：

```
ImageInput01, ImageInput02, Blur01, Sharpen01, Contrast01, Contrast02 
```

我无法决定是应该将它们存储在线性“一维”集合中，还是只存储包含其他节点的基本节点？所以对于类似的东西：

```
ImageInput01 -> Blur01 -> Sharpen01 -> Contrast01 
```

仅存储`ImageInput01`。

这使我能够对基本节点之后的操作节点使用相同的名称。

对于节点的唯一命名系统、性能、轻松遍历组合中的节点等，哪一个会更好？

对我来说，保持层次结构似乎更明智，但想了解人们的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T17:49:51.510

当然，从分类学的角度来看，层次结构会给你更多的权力。此外，在大多数情况下，搜索树比搜索一维集合更有效。

只要您还使用 .NET 通用集合，您也可以将 .ToList() 用于一维集合。

不幸的是，层次结构有点难以实现，但通常如果有迹象表明需要它，您将能够很好地利用它为您提供的功能。

# assembly - 如何仅使用逻辑运算符 AND 判断一个数字是否是四的倍数？

> ID：748673
> 
> 赞同：8
> 
> 时间：2009-04-14T17:47:59.173
> 
> 标签：assembly, binary, bit-manipulation

我正在搞乱汇编语言编程，我很好奇如何使用逻辑运算符 AND 判断一个数字是否是 4 的倍数？

我知道如何使用“div”或“remainder”指令来做到这一点，但我试图通过数字/单词的位操作来做到这一点。

谁能指出我正确的方向？我正在使用 MIP，但与语言无关的答案很好。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-14T17:49:53.537

好吧，要检测一个数字是否是另一个数字的倍数，您只需要做`x MOD y`. 如果结果是`0`，那么它是偶数。

这也是真的，对于每`y`一个是 的幂`2`，`(x MOD y)`都等于`(x AND (y - 1))`。

所以：

```
IF (x AND 3) == 0 THEN
    /* multiple of 4 */ 
```

**编辑：**

好的，你想知道**为什么** `(x MOD y) == (x AND (y - 1))`什么时候`y`是 2 的幂。我会尽力解释。

基本上，如果一个数字是 2 的幂，那么它只有一个位集（因为二进制是以 2 为底的）。这意味着所有低位都未设置。例如：`16 == 10000b, 8 == 1000b`等。

如果从这些值中减去 1。您最终会设置未设置的位，并设置其下方的所有位。

`15 = 01111b, 7 = 0111b`等。所以基本上它是创建一个掩码，可用于测试是否设置了任何低位。我希望这很清楚。

**编辑：** Bastien Léonard 的评论也很好地涵盖了它：

> 如果将（无符号）除以 4，则向右移动两位。因此，剩下的就是这两个位，当你除法时它们会丢失。4 - 1 = 11b，即一个掩码，当您将其与一个值进行“与”运算时会产生最右边的两个位。

**编辑：**请参阅此页面以获得更清晰的解释：[http](http://en.wikipedia.org/wiki/Power_of_two#Fast_algorithm_to_check_if_a_positive_number_is_a_power_of_two) ://en.wikipedia.org/wiki/Power_of_two#Fast_algorithm_to_check_if_a_positive_number_is_a_power_of_two 。

它涵盖了检测 2 的幂以及使用 AND 作为快速模运算（如果它是 2 的幂）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T17:52:11.457

(x & 3) == 0

Wrt 汇编语言，如果可用则使用 TST，否则使用 AND，并检查零标志。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-14T18:01:20.123

在 x86 程序集中：

```
 test eax, 3
    jnz not_multiple_of_4

    ; action to be taken if EAX is a multiple of 4

not_multiple_of_4:
    ; ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T17:52:27.523

如果一个数字的低 2 位为 0，则该数字是 4 的倍数，因此您可以简单地将数字右移两次并检查移位的位是否为 0。

# sql - Access SQL中如何替换多个字符？

> ID：748674
> 
> 赞同：1
> 
> 时间：2009-04-14T17:48:02.090
> 
> 标签：sql, ms-access, replace, vba

我是 SQL 的新手，所以希望有人可以为我说明这一点。我尝试按照“替换 SQL 查询中的多个字符串”发布，但我被卡住了。

我正在尝试与上述帖子的发起人做同样的事情，但使用不同的表格和不同的字段。假设下面的字段“ `ShiptoPlant`”在表“ `BTST`”中有3条记录（我的表实际上有数千条记录）......

**表名：BTST**

```
 ---------------
   | ShiptoPlant |
   | ----------- |
   | Plant #1    |
   | Plant - 2   |
   | Plant/3     |
   --------------- 
```

这是我试图在 SQL 屏幕中输入的内容：

```
SELECT CASE WHEN ShipToPlant IN ("#", "-", "/") Then ""
ELSE ShipToPlant END FROM BTST; 
```

我不断收到消息（错误 3075）...

```
"Syntax error (missing operator) in query expression 
'CASE WHEN ShiptoPlant IN (";","/"," ") Then "" ELSE ShipToPlant END'." 
```

我想对键盘上的每个字符执行此操作，但`"*"`因为它是通配符除外。

您能提供的任何帮助将不胜感激！

**编辑：从评论中添加的背景信息**

我从我们的 14 家供应商那里收集了 2008 日历年的单项发票级别数据。我正在尝试规范供应商提供给我们的工厂名称。

每个供应商都可以用不同的名称来称呼工厂，例如

**供应商可以调用我们主列表上的**Signode 服务****

 **```
Signode Service 
Signode - Service.
SignodeSvc
SignodeService 
```

我正在尝试去除非字母数字字符，以便我可以尝试使用我们的主列表来识别植物，方法是创建一系列查看前 10 个字符的链接，如果不匹配，则为 8 个字符、6、4...

我的基本问题是我不知道如何从表格中删除字母数字字符。我将在几个列上执行此操作，但我计划创建单独的查询来编辑其他列。

也许我需要做一个删除所有字母数字的批量更新查询。我仍然不清楚如何写它。这是我开始删除所有空间的方法。它工作得很好，但是当我尝试嵌套替换时失败了

```
UPDATE BTST SET ShipToPlant = replace(ShipToPlant," ",""); 
```

**编辑 2：从评论中获取的更多信息**

每个月，多达 100 个新的植物名称排列出现在我们的行项目发票数据中——这可能代表数千个发票记录。我正在尝试构建一种快速而肮脏的方法来将最终名称的 master_id 分配给每个植物名称排列。我认为最好的方法是查看工厂、地址、城市和州字段，但问题是这些字段也有各种排列，例如，

```
128 Brookview Drive
128 Brookview Lane 
```

通过取出字母数字并做

```
LEFT(PlantName,#chars) & _
LEFT(Address,#chars) & _
LEFT(City,#chars) & _
LEFT(State,#chars) 
```

通过更改字符数直到在发票数据和主工厂列表（两个表都包含工厂、地址、城市和州）之间找到匹配项，您最终可以找到匹配项。当然，当您开始减少正在输入的字符数时`LEFT`，准确性就会受到影响。我已经在 excel 中完成了这项工作，并且获得了不错的收益。谁能推荐一个更好的解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-14T20:01:10.727

您可能希望考虑使用用户定义函数 (UDF)

```
SELECT ShiptoPlant, CleanString([ShiptoPlant]) AS Clean
FROM Table

Function CleanString(strText)
Dim objRegEx As Object

Set objRegEx = CreateObject("VBScript.RegExp")
objRegEx.IgnoreCase = True
objRegEx.Global = True

objRegEx.Pattern = "[^a-z0-9]"
CleanString = objRegEx.Replace(strText, "")

End Function 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T18:41:26.220

您可以使用 Access 中的内置[`Replace`](http://www.techonthenet.com/access/functions/string/replace.php)功能

```
SELECT
    Replace(Replace(Replace(ShipToPlant, "#", ""), "-", ""), "/", "") AS ShipToPlant
FROM
    BTST 
```

正如其他人所说，在 Access 中，您可以在 VBA 中编写自己的函数并在查询中使用它们。

**编辑：**

这是一种通过将 Replace 函数包装在我们自己的函数中来处理嵌套 Replace 限制的方法。感觉*很脏*但很管用——把它放在 Access 的一个模块中

```
Public Function SuperReplace(ByRef field As String, ByVal ReplaceString As String) As String
    ' Size this as big as you need... it is zero-based by default' 
    Dim ReplaceArray(3) As String

    'Fill each element with the character you need to replace'  
    ReplaceArray(0) = "#"
    ReplaceArray(1) = "-"
    ReplaceArray(2) = "/"
    ReplaceArray(3) = " "

    Dim i As Integer
    For i = LBound(ReplaceArray) To UBound(ReplaceArray)    
       field = Replace(field, ReplaceArray(i), ReplaceString)
    Next i

    SuperReplace = field    
End Function 
```

然后用这个查询测试它

```
SELECT 
    SuperReplace(ShipToPlant,"") AS ShipToPlant
FROM
    BTST 
```

您可能希望对其进行扩展，以便可以传入字符串数组，而不是将它们硬编码到函数中。

**编辑2：**

针对问题评论中的其他信息，这里有一个关于您可能希望如何以不同方式处理这种情况的建议。这种方法的优点是，一旦您映射了植物名称排列，您将不需要在未来几年对未来数据执行字符串替换，只需将新植物名称和排列添加到地图中。

从创建另一个表开始，我们称之为`plant_map`

```
CREATE TABLE plant_map (id AUTOINCREMENT PRIMARY KEY, name TEXT, master_id LONG) 
```

到`plant_map`中，添加植物名称的所有排列，并将您希望用来引用特定植物名称排列组的名称的 id 插入到 master_id 字段中。根据您的评论，我将使用**Signnode 服务**

```
INSERT INTO plant_map(name, master_id) VALUES ("Signode Service", 1);
INSERT INTO plant_map(name, master_id) VALUES ("Signode Svc", 1);
INSERT INTO plant_map(name, master_id) VALUES ("Signode - Service", 1);
INSERT INTO plant_map(name, master_id) VALUES ("Signode svc", 1);
INSERT INTO plant_map(name, master_id) VALUES ("SignodeService", 1); 
```

现在，当您查询 BTST 表时，您可以使用以下方法获取Signnode**服务的数据**

```
SELECT
    field1,
    field2
FROM
    BTST source
INNER JOIN
    (
    plant_map map1      
    INNER JOIN
    plant_map map2
    ON map1.master_id = map2.id
    )
    ON source.ShipToPlant = map1.name
WHERE
    map2.name = "Signode Service" 
```

表中的数据`BTST`可以保持不变。

从本质上讲，这是将植物名称加入`BTST`到名称中`plant_map`，使用`master_id`, self 加入`id`其中，`plant_map`这样您只需要传入一个“通用”名称。我建议在每个列上放置一个索引，`name`因为这两个字段都将用于连接。`master_id``plant_map`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T18:26:59.750

不要认为 Access 支持 CASE 语句。考虑使用 iif：

```
iif ( condition, value_if_true, value_if_false ) 
```

对于这种情况，您可以使用 REPLACE 功能：

```
SELECT 
    REPLACE(REPLACE(REPLACE(yourfield, '#', ''), '-', ''), '/', '') 
    as FieldName
FROM
    .... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T18:30:14.313

好的，你的问题已经改变了，所以解决方案也会改变。这里有两种方法。快速而肮脏的方法只能部分解决您的问题，因为它无法解释更奇怪的排列，例如缺少空格或拼写错误的单词。快速而肮脏的方式：

1.  创建一个新表 - 我们称之为 tChar。
2.  在其中放置一个文本字段 - 您要替换的字符 - 我们将`char`在此示例中调用它
3.  将要删除的所有 char 或 char 组合放在此表中。
4.  创建并运行下面的查询。请注意，它一次只会删除一个项目，但您也可以将相同替换的不同版本放入其中，例如“-”或“-”。在此示例中，我创建了`tPlant`一个名为`ShipToPlant`.

    `SELECT tPlant.ShipToPlant, Replace([ShipToPlant], (SELECT top 1 char FROM tChar WHERE instr(ShipToPlant,char)<>0 ORDER BY len(char) Desc),"" ) AS New FROM tPlant;`

更好（但更复杂）的方式。这个解释是笼统的，因为几乎不可能把整个东西都放在这里。如果您想直接与我联系，请使用我在 gmail 的用户名。：

1.  创建一个限定符表 - 人们输入的错误，例如 svc 而不是 service。在这里，您将输入您获得的每一个奇怪的排列。
2.  使用 QualifierID 和 Plant ID 创建一个表。在这里，您会说哪个限定符用于哪个工厂。
3.  创建一个查询，将两者和您的表连接起来，其中包含错误的植物名称。使用 instr 所以说出字段中的内容。
4.  创建第二个查询来聚合第一个查询。计算 instr 字段并将其用作分数。得分最高的条目是植物。
5.  您将不得不手动输入它找不到的那些，但很快就会几乎没有，因为表格中的条目越来越多。

呃

* * *

你有几个不同的选择。Access中没有sql中的CASE，需要使用IIF。它不像更健壮的数据库引擎中的解决方案那样优雅，并且需要为此实例嵌套，但它会为您完成工作。

```
SELECT
    iif(instr(ShipToPlant,"#")<>0,"",
    iif(instr(ShipToPlant,"-")<>0,"",
    iif(instr(ShipToPlant,"/")<>0,"",ShipToPlant ))) AS FieldName
FROM BTST; 
```

您也可以使用 sql 来限制您的数据。

```
SELECT YourID, nz(aBTST.ShipToPlant,"") AS ShipToPlant  
FROM BTST LEFT JOIN (
    SELECT YourID, ShipToPlant 
    FROM BTST 
    WHERE ShipToPlant NOT IN("#", "-", "/")
    ) as aBTST ON BTST.YourID=aBTST.YourID 
```

如果您了解 VB，您还可以创建自己的函数并将它们放在查询中……但那是另一篇文章。:) HTH

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T19:54:22.490

在代码模块中创建一个公共函数。

```
Public Function StripChars(ByVal pStringtoStrip As Variant, ByVal pCharsToKeep As String) As String

Dim sChar As String
Dim sTemp As String
Dim iCtr As Integer

  sTemp = ""

  For iCtr = 1 To Len(pStringtoStrip)
    sChar = Mid(pStringtoStrip, iCtr, 1)
    If InStr(pCharsToKeep, sChar) > 0 Then
      sTemp = sTemp & sChar
    End If
  Next

  StripChars = sTemp

End Function 
```

然后在您的查询中

```
SELECT
    StripChars(ShipToPlant, "abcdefghijklmnopqrstuvwxyz0123456789") AS ShipToPlantDisplay  
FROM 
    BTST 
```

注意 - 这对于很多记录来说会很慢 - 如果你这是永久的，那么使用相同的函数创建一个更新查询。

编辑：做一个更新：

```
UPDATE BTST
    SET ShipToPlant = StripChars(ShipToPlant, "abcdefghijklmnopqrstuvwxyz0123456789") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T21:44:40.597

全部 - 我最终将 REPLACE() 函数嵌套在两个单独的查询中。由于我需要替换超过 35 个非字母数字字符，并且 Access 将查询的复杂性限制在 20 个嵌套函数左右，因此我只是将其拆分为两个进程。有点笨拙，但它确实有效。在这种情况下应该遵循 KISS 原则。谢谢你的帮助！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-14T18:28:42.913

```
 SELECT 
IIF
(
    Instr(1,ShipToPlant , "#") > 0 
    OR Instr(1,ShipToPlant , "/") > 0 
    OR Instr(1,ShipToPlant , "-") > 0, ""
    , ShipToPlant 
)
FROM BTST 

```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-20T14:39:40.323

此查询获取前 3 个字符并将它们替换为空白

示例：`BO-1234`
输出：`1234`

```
BO: IIf(IsNumeric(Left([sMessageDetails],3)),[sMessageDetails],Replace([sMessageDetails],Left([sMessageDetails],3),"")) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-09-14T16:10:24.293

我知道这是一个非常古老的问题，但我在寻找解决此问题的方法时偶然发现了它，但最终使用了不同的方法。

我希望更新的字段称为“客户”。'CustName' 字段中有 20 多个重音字符，我希望删除它们的变音符号 - 所以（例如）ã > a。

对于这些字符中的每一个，我创建了一个新表“recodes”，其中包含 2 个字段“char”和“recode”。'char' 包含我希望删除的字符，而 'recode' 包含替换字符。

然后对于替换，我在更新语句中做了一个完整的外部连接

```
UPDATE Customers, Recodes SET Customers.CustName = Replace([CustName],[char],[recode]); 
```

这与嵌套所有替换语句具有相同的效果，并且更易于管理。

# python - 查找重复文件并删除它们

> ID：748675
> 
> 赞同：74
> 
> 时间：2009-04-14T17:48:21.717
> 
> 标签：python, file, duplicates

我正在编写一个 Python 程序来查找和删除文件夹中的重复文件。

我有多个 mp3 文件和其他一些文件的副本。我正在使用 sh1 算法。

如何找到这些重复文件并将其删除？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2016-03-20T11:33:09.867

## 最快的算法 - 与公认的答案相比，性能提高了 100 倍（真的 :)）

其他解决方案中的方法非常酷，但它们忘记了重复文件的一个重要属性——它们具有相同的文件大小。仅对相同大小的文件计算昂贵的哈希将节省大量 CPU；最后的性能比较，这里是解释。

迭代@nosklo 给出的可靠答案，并借用@Raffi 的想法来获得每个文件开头的快速散列，并仅在快速散列中的冲突计算完整的散列，以下是步骤：

1.  建立文件的哈希表，其中文件大小是关键。
2.  对于相同大小的文件，用它们的前 1024 个字节的哈希创建一个哈希表；非碰撞元素是唯一的
3.  对于前 1k 字节具有相同散列的文件，计算完整内容的散列 - 匹配的文件不是唯一的。

编码：

```
#!/usr/bin/env python
# if running in py3, change the shebang, drop the next import for readability (it does no harm in py3)
from __future__ import print_function   # py2 compatibility
from collections import defaultdict
import hashlib
import os
import sys

def chunk_reader(fobj, chunk_size=1024):
    """Generator that reads a file in chunks of bytes"""
    while True:
        chunk = fobj.read(chunk_size)
        if not chunk:
            return
        yield chunk

def get_hash(filename, first_chunk_only=False, hash=hashlib.sha1):
    hashobj = hash()
    file_object = open(filename, 'rb')

    if first_chunk_only:
        hashobj.update(file_object.read(1024))
    else:
        for chunk in chunk_reader(file_object):
            hashobj.update(chunk)
    hashed = hashobj.digest()

    file_object.close()
    return hashed

def check_for_duplicates(paths, hash=hashlib.sha1):
    hashes_by_size = defaultdict(list)  # dict of size_in_bytes: [full_path_to_file1, full_path_to_file2, ]
    hashes_on_1k = defaultdict(list)  # dict of (hash1k, size_in_bytes): [full_path_to_file1, full_path_to_file2, ]
    hashes_full = {}   # dict of full_file_hash: full_path_to_file_string

    for path in paths:
        for dirpath, dirnames, filenames in os.walk(path):
            # get all files that have the same size - they are the collision candidates
            for filename in filenames:
                full_path = os.path.join(dirpath, filename)
                try:
                    # if the target is a symlink (soft one), this will 
                    # dereference it - change the value to the actual target file
                    full_path = os.path.realpath(full_path)
                    file_size = os.path.getsize(full_path)
                    hashes_by_size[file_size].append(full_path)
                except (OSError,):
                    # not accessible (permissions, etc) - pass on
                    continue

    # For all files with the same file size, get their hash on the 1st 1024 bytes only
    for size_in_bytes, files in hashes_by_size.items():
        if len(files) < 2:
            continue    # this file size is unique, no need to spend CPU cycles on it

        for filename in files:
            try:
                small_hash = get_hash(filename, first_chunk_only=True)
                # the key is the hash on the first 1024 bytes plus the size - to
                # avoid collisions on equal hashes in the first part of the file
                # credits to @Futal for the optimization
                hashes_on_1k[(small_hash, size_in_bytes)].append(filename)
            except (OSError,):
                # the file access might've changed till the exec point got here 
                continue

    # For all files with the hash on the 1st 1024 bytes, get their hash on the full file - collisions will be duplicates
    for __, files_list in hashes_on_1k.items():
        if len(files_list) < 2:
            continue    # this hash of fist 1k file bytes is unique, no need to spend cpy cycles on it

        for filename in files_list:
            try: 
                full_hash = get_hash(filename, first_chunk_only=False)
                duplicate = hashes_full.get(full_hash)
                if duplicate:
                    print("Duplicate found: {} and {}".format(filename, duplicate))
                else:
                    hashes_full[full_hash] = filename
            except (OSError,):
                # the file access might've changed till the exec point got here 
                continue

if __name__ == "__main__":
    if sys.argv[1:]:
        check_for_duplicates(sys.argv[1:])
    else:
        print("Please pass the paths to check as parameters to the script") 
```

* * *

而且，这是有趣的部分 - 性能比较。

基线 -

*   一个包含 1047 个文件的目录，32 mp4，1015 - jpg，总大小 - 5445.998 MiB - 即我手机的相机自动上传目录:)
*   小型（但功能齐全）处理器 - 1600 BogoMIPS，1.2 GHz 32L1 + 256L2 Kbs 缓存，/proc/cpuinfo：

> 处理器：Feroceon 88FR131 rev 1 (v5l) BogoMIPS：1599.07

（即我的低端 NAS :)，运行 Python 2.7.11。

所以，@nosklo 非常方便的解决方案的输出：

```
root@NAS:InstantUpload# time ~/scripts/checkDuplicates.py 
Duplicate found: ./IMG_20151231_143053 (2).jpg and ./IMG_20151231_143053.jpg
Duplicate found: ./IMG_20151125_233019 (2).jpg and ./IMG_20151125_233019.jpg
Duplicate found: ./IMG_20160204_150311.jpg and ./IMG_20160204_150311 (2).jpg
Duplicate found: ./IMG_20160216_074620 (2).jpg and ./IMG_20160216_074620.jpg

real    5m44.198s
user    4m44.550s
sys     0m33.530s 
```

而且，这是在大小检查上带有过滤器的版本，然后是小散列，最后是完整散列（如果发现冲突）：

```
root@NAS:InstantUpload# time ~/scripts/checkDuplicatesSmallHash.py . "/i-data/51608399/photo/Todor phone"
Duplicate found: ./IMG_20160216_074620 (2).jpg and ./IMG_20160216_074620.jpg
Duplicate found: ./IMG_20160204_150311.jpg and ./IMG_20160204_150311 (2).jpg
Duplicate found: ./IMG_20151231_143053 (2).jpg and ./IMG_20151231_143053.jpg
Duplicate found: ./IMG_20151125_233019 (2).jpg and ./IMG_20151125_233019.jpg

real    0m1.398s
user    0m1.200s
sys     0m0.080s 
```

两个版本各运行 3 次，以获得所需时间的平均值。

所以 v1 是 (user+sys) **284s**，其他 - **2s**；相当不同，呵呵 :) 随着这一增加，人们可以使用 SHA512，甚至更高级 - 所需的计算量减少会减轻性能损失。

负面：

*   比其他版本更多的磁盘访问 - 每个文件都被访问一次以获取大小统计信息（这很便宜，但仍然是磁盘 IO），并且每个副本都打开两次（对于小的前 1k 字节散列，以及完整的内容散列）
*   由于存储哈希表运行时将消耗更多内存

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-04-14T19:00:37.737

# 递归文件夹版本：

此版本使用文件大小和内容的哈希值来查找重复项。您可以传递多个路径，它将递归扫描所有路径并报告找到的所有重复项。

```
import sys
import os
import hashlib

def chunk_reader(fobj, chunk_size=1024):
    """Generator that reads a file in chunks of bytes"""
    while True:
        chunk = fobj.read(chunk_size)
        if not chunk:
            return
        yield chunk

def check_for_duplicates(paths, hash=hashlib.sha1):
    hashes = {}
    for path in paths:
        for dirpath, dirnames, filenames in os.walk(path):
            for filename in filenames:
                full_path = os.path.join(dirpath, filename)
                hashobj = hash()
                for chunk in chunk_reader(open(full_path, 'rb')):
                    hashobj.update(chunk)
                file_id = (hashobj.digest(), os.path.getsize(full_path))
                duplicate = hashes.get(file_id, None)
                if duplicate:
                    print "Duplicate found: %s and %s" % (full_path, duplicate)
                else:
                    hashes[file_id] = full_path

if sys.argv[1:]:
    check_for_duplicates(sys.argv[1:])
else:
    print "Please pass the paths to check as parameters to the script" 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-04-14T18:51:46.837

```
def remove_duplicates(dir):
    unique = []
    for filename in os.listdir(dir):
        if os.path.isfile(filename):
            filehash = md5.md5(file(filename).read()).hexdigest()
            if filehash not in unique: 
                unique.append(filehash)
            else: 
                os.remove(filename) 
```

//编辑：

对于 MP3，您可能也对此主题感兴趣[检测具有不同比特率和/或不同 ID3 标签的重复 MP3 文件？](https://stackoverflow.com/questions/476227/detect-duplicate-mp3-files-with-different-bitrates-and-or-different-id3-tags)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-14T17:50:52.753

前段时间我用 Python 写过一个——欢迎你使用它。

```
import sys
import os
import hashlib

check_path = (lambda filepath, hashes, p = sys.stdout.write:
        (lambda hash = hashlib.sha1 (file (filepath).read ()).hexdigest ():
                ((hash in hashes) and (p ('DUPLICATE FILE\n'
                                          '   %s\n'
                                          'of %s\n' % (filepath, hashes[hash])))
                 or hashes.setdefault (hash, filepath)))())

scan = (lambda dirpath, hashes = {}: 
                map (lambda (root, dirs, files):
                        map (lambda filename: check_path (os.path.join (root, filename), hashes), files), os.walk (dirpath)))

((len (sys.argv) > 1) and scan (sys.argv[1])) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-10-24T09:14:42.073

## 更快的算法

如果应该分析许多“大尺寸”文件（图像、mp3、pdf 文档），那么使用以下比较算法会很有趣/更快：

1.  对文件的前 N ​​个字节（比如 1KB）执行第一个快速散列。这个散列会说文件是否不同，但不会说两个文件是否完全相同（散列的准确性，从磁盘读取的有限数据）

2.  第二个较慢的散列，如果在第一阶段发生冲突，则更准确并在文件的整个内容上执行

下面是这个算法的一个实现：

```
import hashlib
def Checksum(current_file_name, check_type = 'sha512', first_block = False):
  """Computes the hash for the given file. If first_block is True,
  only the first block of size size_block is hashed."""
  size_block = 1024 * 1024 # The first N bytes (1KB)

  d = {'sha1' : hashlib.sha1, 'md5': hashlib.md5, 'sha512': hashlib.sha512}

  if(not d.has_key(check_type)):
    raise Exception("Unknown checksum method")

  file_size = os.stat(current_file_name)[stat.ST_SIZE]
  with file(current_file_name, 'rb') as f:
    key = d[check_type].__call__()
    while True:
      s = f.read(size_block)
      key.update(s)
      file_size -= size_block
      if(len(s) < size_block or first_block):
        break
  return key.hexdigest().upper()

def find_duplicates(files):
  """Find duplicates among a set of files.
  The implementation uses two types of hashes:
  - A small and fast one one the first block of the file (first 1KB), 
  - and in case of collision a complete hash on the file. The complete hash 
  is not computed twice.
  It flushes the files that seems to have the same content 
  (according to the hash method) at the end.
  """

  print 'Analyzing', len(files), 'files'

  # this dictionary will receive small hashes
  d = {}
  # this dictionary will receive full hashes. It is filled
  # only in case of collision on the small hash (contains at least two 
  # elements)
  duplicates = {}

  for f in files:

    # small hash to be fast
    check = Checksum(f, first_block = True, check_type = 'sha1')

    if(not d.has_key(check)):
      # d[check] is a list of files that have the same small hash
      d[check] = [(f, None)]
    else:
      l = d[check]
      l.append((f, None))

      for index, (ff, checkfull) in enumerate(l):

        if(checkfull is None):
          # computes the full hash in case of collision
          checkfull = Checksum(ff, first_block = False)
          l[index] = (ff, checkfull)

          # for each new full hash computed, check if their is 
          # a collision in the duplicate dictionary. 
          if(not duplicates.has_key(checkfull)):
            duplicates[checkfull] = [ff]
          else:
            duplicates[checkfull].append(ff)

  # prints the detected duplicates
  if(len(duplicates) != 0):
    print
    print "The following files have the same sha512 hash"

    for h, lf in duplicates.items():
      if(len(lf)==1):
        continue
      print 'Hash value', h
      for f in lf:
        print '\t', f.encode('unicode_escape') if \
          type(f) is types.UnicodeType else f
  return duplicates 
```

该`find_duplicates`函数采用文件列表。这样，也可以比较两个目录（例如，为了更好地同步它们的内容。）创建具有指定扩展名的文件列表并避免进入某些目录的函数示例如下：

```
def getFiles(_path, extensions = ['.png'], 
             subdirs = False, avoid_directories = None):
  """Returns the list of files in the path :'_path', 
     of extension in 'extensions'. 'subdir' indicates if 
     the search should also be performed in the subdirectories. 
     If extensions = [] or None, all files are returned.
     avoid_directories: if set, do not parse subdirectories that 
     match any element of avoid_directories."""

  l = []
  extensions = [p.lower() for p in extensions] if not extensions is None \
    else None
  for root, dirs, files in os.walk(_path, topdown=True):

    for name in files:
      if(extensions is None or len(extensions) == 0 or \
         os.path.splitext(name)[1].lower() in extensions):
        l.append(os.path.join(root, name))

    if(not subdirs):
      while(len(dirs) > 0):
        dirs.pop()
    elif(not avoid_directories is None):
      for d in avoid_directories:
        if(d in dirs): dirs.remove(d)

  return l 
```

这种方法很方便，`.svn`例如不解析路径，这肯定会触发`find_duplicates`.

欢迎反馈。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-04-27T12:49:29.993

@IanLee1521 在[这里](https://github.com/IanLee1521/utilities/blob/master/utilities/find_duplicates.py)有一个很好的解决方案。它非常有效，因为它首先根据文件大小检查重复项。

```
#! /usr/bin/env python

# Originally taken from:
# http://www.pythoncentral.io/finding-duplicate-files-with-python/
# Original Auther: Andres Torres

# Adapted to only compute the md5sum of files with the same size

import argparse
import os
import sys
import hashlib

def find_duplicates(folders):
    """
    Takes in an iterable of folders and prints & returns the duplicate files
    """
    dup_size = {}
    for i in folders:
        # Iterate the folders given
        if os.path.exists(i):
            # Find the duplicated files and append them to dup_size
            join_dicts(dup_size, find_duplicate_size(i))
        else:
            print('%s is not a valid path, please verify' % i)
            return {}

    print('Comparing files with the same size...')
    dups = {}
    for dup_list in dup_size.values():
        if len(dup_list) > 1:
            join_dicts(dups, find_duplicate_hash(dup_list))
    print_results(dups)
    return dups

def find_duplicate_size(parent_dir):
    # Dups in format {hash:[names]}
    dups = {}
    for dirName, subdirs, fileList in os.walk(parent_dir):
        print('Scanning %s...' % dirName)
        for filename in fileList:
            # Get the path to the file
            path = os.path.join(dirName, filename)
            # Check to make sure the path is valid.
            if not os.path.exists(path):
                continue
            # Calculate sizes
            file_size = os.path.getsize(path)
            # Add or append the file path
            if file_size in dups:
                dups[file_size].append(path)
            else:
                dups[file_size] = [path]
    return dups

def find_duplicate_hash(file_list):
    print('Comparing: ')
    for filename in file_list:
        print('    {}'.format(filename))
    dups = {}
    for path in file_list:
        file_hash = hashfile(path)
        if file_hash in dups:
            dups[file_hash].append(path)
        else:
            dups[file_hash] = [path]
    return dups

# Joins two dictionaries
def join_dicts(dict1, dict2):
    for key in dict2.keys():
        if key in dict1:
            dict1[key] = dict1[key] + dict2[key]
        else:
            dict1[key] = dict2[key]

def hashfile(path, blocksize=65536):
    afile = open(path, 'rb')
    hasher = hashlib.md5()
    buf = afile.read(blocksize)
    while len(buf) > 0:
        hasher.update(buf)
        buf = afile.read(blocksize)
    afile.close()
    return hasher.hexdigest()

def print_results(dict1):
    results = list(filter(lambda x: len(x) > 1, dict1.values()))
    if len(results) > 0:
        print('Duplicates Found:')
        print(
            'The following files are identical. The name could differ, but the'
            ' content is identical'
            )
        print('___________________')
        for result in results:
            for subresult in result:
                print('\t\t%s' % subresult)
            print('___________________')

    else:
        print('No duplicate files found.')

def main():
    parser = argparse.ArgumentParser(description='Find duplicate files')
    parser.add_argument(
        'folders', metavar='dir', type=str, nargs='+',
        help='A directory to parse for duplicates',
        )
    args = parser.parse_args()

    find_duplicates(args.folders)

if __name__ == '__main__':
    sys.exit(main()) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-08-31T21:40:54.487

```
 import hashlib
    import os
    import sys
    from sets import Set

    def read_chunk(fobj, chunk_size = 2048):
        """ Files can be huge so read them in chunks of bytes. """
        while True:
            chunk = fobj.read(chunk_size)
            if not chunk:
                return
            yield chunk

    def remove_duplicates(dir, hashfun = hashlib.sha512):
        unique = Set()
        for filename in os.listdir(dir):
            filepath = os.path.join(dir, filename)
            if os.path.isfile(filepath):
                hashobj = hashfun()
                for chunk in read_chunk(open(filepath,'rb')):
                    hashobj.update(chunk)
                    # the size of the hashobj is constant
                    # print "hashfun: ", hashfun.__sizeof__()
                hashfile = hashobj.hexdigest()
                if hashfile not in unique:
                    unique.add(hashfile)
                else: 
                    os.remove(filepath)

    try:
        hashfun = hashlib.sha256
        remove_duplicates(sys.argv[1], hashfun)
    except IndexError:
        print """Please pass a path to a directory with 
        duplicate files as a parameter to the script.""" 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-09-13T21:59:39.273

Python 有一个标准库`filecmp`，用于比较文件和目录。

它检查文件大小。它检查 8k 块中的内容。它适用于二进制文件。

它不散列。

[filecmp 的 python 文档](https://docs.python.org/3/library/filecmp.html#module-filecmp)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-15T09:26:51.027

为了安全起见（如果出现问题，自动删除它们可能会很危险！），这是我使用的，基于@zalew 的回答。

还请注意，md5 sum 代码与@zalew 的代码略有不同，因为*他的代码生成了太多错误的重复文件*（这就是为什么我说自动删除它们很危险！）。

```
import hashlib, os
unique = dict()
for filename in os.listdir('.'):
    if os.path.isfile(filename):
        filehash = hashlib.md5(open(filename, 'rb').read()).hexdigest()

        if filehash not in unique: 
            unique[filehash] = filename
        else:
            print filename + ' is a duplicate of ' + unique[filehash] 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-02-19T11:34:00.590

我找到了一个 100% 的工作代码，用于在文件夹中递归删除重复文件。只需将 clean 方法中的文件夹名称替换为您的文件夹名称即可。

```
import time
import os
import shutil
from hashlib import sha256

class Duplython:
    def __init__(self):
        self.home_dir = os.getcwd()
        self.File_hashes = []
        self.Cleaned_dirs = []
        self.Total_bytes_saved = 0
        self.block_size = 65536
        self.count_cleaned = 0

    def welcome(self) -> None:
        print('******************************************************************')
        print('****************        DUPLYTHON      ****************************')
        print('********************************************************************\n\n')
        print('----------------        WELCOME        ----------------------------')
        time.sleep(3)
        print('\nCleaning .................')
        return None

    def generate_hash(self, Filename: str) -> str:
        Filehash = sha256()
        try:
            with open(Filename, 'rb') as File:
                fileblock = File.read(self.block_size)
                while len(fileblock) > 0:
                    Filehash.update(fileblock)
                    fileblock = File.read(self.block_size)
                Filehash = Filehash.hexdigest()
            return Filehash
        except:
            return False

    def clean(self) -> None:
        all_dirs = [path[0] for path in os.walk('E:\\songs')]
        for path in all_dirs:
            os.chdir(path)
            All_Files = [file for file in os.listdir() if os.path.isfile(file)]
            for file in All_Files:
                filehash = self.generate_hash(file)
                if not filehash in self.File_hashes:
                    if filehash:
                        self.File_hashes.append(filehash)
                        # print(file)
                else:
                    byte_saved = os.path.getsize(file)
                    self.count_cleaned += 1
                    self.Total_bytes_saved += byte_saved
                    os.remove(file)
                    filename = file.split('/')[-1]
                    print(filename, '.. cleaned ')
            os.chdir(self.home_dir)

    def cleaning_summary(self) -> None:
        mb_saved = self.Total_bytes_saved / 1048576
        mb_saved = round(mb_saved, 2)
        print('\n\n--------------FINISHED CLEANING ------------')
        print('File cleaned  : ', self.count_cleaned)
        print('Total Space saved : ', mb_saved, 'MB')
        print('-----------------------------------------------')

    def main(self) -> None:
        self.welcome()
        self.clean()
        self.cleaning_summary()

#
# if __name__ == '__main__':
#     App = Duplython()
#     App.main()

def dedupe_bing_images():
    App = Duplython()
    App.main()
    return True

dedupe_bing_images() 
```

# c# - 数据绑定后（在事件处理程序期间）从 RepeaterItem 检索 DataItem

> ID：748677
> 
> 赞同：3
> 
> 时间：2009-04-14T17:49:31.853
> 
> 标签：c#, asp.net, data-binding, repeater

我正在尝试找到一种方法来做一些我认为必须是可能的事情，但我只是错过了这一点 - 所以希望有人可以给我一点推动:)

我正在使用 ASP.NET 中的数据绑定（视图状态已关闭 - 所以在这里和那里使用 controlstate 来处理一些事情）来呈现一个转发器（repeaterPriceClasses），它在每个项目模板（repeaterPriceBands）中都有一个转发器。基本上，这会在每个单元格中从一些文本和一个下拉列表中呈现一个表格。

我正在尝试找到一种方法来枚举按钮的事件处理程序中的 repeaterOuter，以给我一个列表，列出所有原始绑定的元素，这些元素现在有一个值为 >0 的下拉列表，以及该值是什么.

```
public Dictionary<Price, int> SelectedPrices
{
    get
    {
        var sel = new Dictionary<Price, int>();
        foreach(RepeaterItem itemClass in repeaterPriceClasses.Items)
        {
            var repeaterPriceBands = itemClass.FindControl("repeaterPriceBands") as Repeater;

            foreach(RepeaterItem itemBand in repeaterPriceBands.Items)
            {
                var context = (Price)itemBand.DataItem;
                var listQty = itemBand.FindControl("listQty") as DropDownList;

                if(listQty.SelectedValue.ToInt32() > 0)
                {
                    sel.Add(context, listQty.SelectedValue.ToInt32());
                }
            }
        }
        return sel;
    }
} 
```

现在这失败了，因为在数据绑定完成后 itemBand.DataItem 始终为空。

我应该使用什么技术来解决这个问题？

1.  带有主键的隐藏字段（不理想，可能会被滥用并增加页面的权重）

2.  根据索引从原始缓存数据中查找（似乎是错误的）

3.  还是别的/更好的……？

**编辑：**我可以提供更多信息来帮助解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T04:26:42.913

当 DataItem 可用时，您可以尝试在 ItemDataBound 事件中为 HTML 元素添加额外的属性。

```
ddlSomething.Attributes["Attribute1"] = dataItemObject.PropertyName; 
```

[编辑] 除了使用属性之外，您还可以为每一行呈现一些包含这样的 JSON 对象的数组。

```
var repeaterItemAttributes = [ { Prop1: val1, Prop2: val2, ... }, { ... }, ... ] 
```

因此，通过使用它，您不必呈现属性，并且您的代码也将兼容 XHTML（但它不是必需的）。然后，您可以遍历对象数组并读取您喜欢的任何属性。您还可以将您正在谈论的轻加密应用于属性值。[/编辑]

# apache-flex - 如何知道一个对象在 AS3 中是否是动态的

> ID：748685
> 
> 赞同：4
> 
> 时间：2009-04-14T17:50:48.527
> 
> 标签：apache-flex, flash, actionscript-3, oop, dynamic

在 Action Script 3 中，您可以编写一个定义动态对象的类（MovieClip 和 Object 是两个示例），该对象可以在运行时进行修改。我想知道是否有某种方法（当然是在运行时）可以知道某个对象是否是动态的。

PS：不做这样的事情：

```
function isDynamic(object) {
    try {
        object.newProperty = 'someValue'
    } catch (e) {
        return false
    }
    return true
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-14T18:14:10.110

CookieOfFortune思路不错，可惜代码本身有问题，isDynamic是一个属性，返回的值会是一个XMLList，其值为反映真假值的String，而不是直接返回Boolean的子节点. 它应该看起来更像这样：

```
function isDynamic(object) : Boolean
{
    var type:XML = describeType(object);
    return type.@isDynamic.toString() == "true";
}
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T17:59:40.410

您可以使用 flash.utils 中的 describeType 以 XML 形式描述对象。这是对 API 的引用：[flash.utils.describeType](http://livedocs.adobe.com/flex/201/langref/flash/utils/package.html#describeType())

```
function isDynamic(object) {
    var type:XML = describeType(object);
    if (type.@isDynamic == "true") return true;
    return false;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T01:03:03.873

当心！

*任何时候你*想使用 describeType() 函数，*请**使用* 变体：

 **```
import mx.utils.DescribeTypeCache;
var typeDesc:XML = DescribeTypeCache.describeType(object).typeDescription; 
```

重复调用运行时反射机制的性能绝对会*很糟糕*。这就是 Adob​​e 发明 DescribeTypeCache 类的原因。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-08-04T22:58:06.303

这是一个非常古老的帖子，但我会为那些未来的搜索者添加一个选项。

AS3 有一个内置的方法：

```
mx.utils.ObjectUtil.isDynamicObject(yourObject); 
```

[在此处](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/utils/ObjectUtil.html#isDynamicObject%28%29)阅读更多相关信息。

# ide - 被 ILIDE 卡住了

> ID：748701
> 
> 赞同：3
> 
> 时间：2009-04-14T17:57:02.757
> 
> 标签：ide, cil, ilide

我正在拼命地为 MSIL 找到一个（好的，甚至任何？）IDE。（对于那个 c ：[MSIL 的 IDE](https://stackoverflow.com/questions/640583/ide-for-msil)）

我以为我用 ILIDE 找到了一个，但是在调试我的代码时，我总是（不取决于代码）得到：

> SandDock]TD.SandDock.ControlLayoutSystem::OnMouseMove(System.Windows.Forms.MouseEventArgs

当我不使用鼠标时（因为它显然是由 e 鼠标悬停触发的）我得到：

`System.NullReferenceException`来自“调试器 3”，没有任何附加信息。

有没有人更成功地使用该程序（3.0）？

# c# - C#中的泛型继承？

> ID：748706
> 
> 赞同：15
> 
> 时间：2009-04-14T17:59:27.977
> 
> 标签：c#, generics, inheritance

> **可能重复：**
> [为什么 C# 泛型不能像在 C++ 模板中那样从泛型类型参数之一派生？](https://stackoverflow.com/questions/1842636/why-cannot-c-sharp-generics-derive-from-one-of-the-generic-type-parameters-like)

我可以

```
public class MyGenericClass : DL
//but i cannot do
public class MyGenericClass <T> : T 
```

我该怎么做第二个？如果我不能这样做，我该怎么做

```
public class MyGenericClass <T> 
{
    T obj;
    //have all MyGenericClass.XYZ call obj.XYZ
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-14T18:03:34.860

这是不可能的，因为根据 T 的类型，MyGenericClass 的公共接口会改变。

如果您有许多不同的类都公开相同的接口，则可以声明 MyGenericClass 以公开该接口，并在所有函数的实现中将调用委托给 obj

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-14T19:35:32.970

The specific question, why can't you do this:

```
public class MyGenericClass<T> : T 
```

And you can do this:

```
public class MyGenericClass<T> 
{
   T obj;
} 
```

The reason is that the CLR likes to be able to compile a single version of the code for MyGenericClass that will work for any reference type specified for T.

It can do this for the second case, because it can quietly replace `T` with `object` and insert appropriate casts, roughly equivalent to:

```
public class MyGenericClass 
{
   object obj;
} 
```

But for the inheritance version, that trick doesn't work.

Also, many useful facilities would be impossible to describe through interface constraints. When you inherit from a type, you can do a lot more than just call methods on it - you can override them as well. Consider this hypothetical example:

```
class MyBase 
{
    public virtual void MyVirtual() { }
}

class MyGenericDerived<T> : T
{
    public override void MyVirtual() 
    {
        Console.WriteLine("Overridden!"); 
    }
} 

MyBase obj = new MyGenericDerived<MyBase>();
obj.MyVirtual(); 
```

What I want to do there is something like a "mix-in", where MyGenericDerived supplies definitions for virtual functions in whatever base it is applied to. But how does the compiler know that T will have a method called MyVirtual that can be overridden? I'd need to put a constraint on T. How would I express that through interfaces? It's impossible. Using interfaces to describe constraints isn't an adequate solution once you allow inheritance from type parameters. So that's another reason why it doesn't exist in the language today.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-14T18:16:02.583

你可以做类似的事情

```
public interface IXyzable { void xyz(); }

public class MyGenericClass<T> : IXyzable where T : IXyzable {
    T obj;
    public void xyz() {
        obj.xyz();
    }
} 
```

编辑：现在我明白了这个问题

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T18:18:31.707

您将需要所有可能的 T 来实现某些接口，以便您知道 obj.XYZ() 有意义，然后您可以这样做

```
public interface Ixyz
{
    void XYZ();
}

public class MyGenericClass<T> : Ixyz where T:Ixyz, new()
{
    T obj;

    public MyGenericClass()
    {
        obj = new T();
    }

    public void XYZ()
    {
        obj.XYZ();
    }
} 
```

我也让 MyGenericClass 实现了 Ixyz，因为它显然确实公开了正确的方法，但也许最好忽略它，因为它允许

```
var x = new MyGenericClass<MyGenericClass<SomeClass>>(); 
```

这不太可能是一个好主意。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T18:30:17.073

这几乎是鸭式打字，但您可以使用反射。当您使用对 obj 的引用创建泛型类时，请使用反射来尝试找到具有正确签名的方法。只要您存储对该方法的引用，性能就不会太差。

```
class BaseGeneric<T>
{
    private T obj;
    private MethodInfo mi;
    private const string MethodNameOfInterest = "Xyz";

    public BaseGeneric(T theObject)
    {
        this.obj = theObject;
        Type t = obj.GetType();
         mi = t.GetMethod(MethodNameOfInterest);
    }

    public void Xyz()
    {
        mi.Invoke(obj, null);
    }
} 
```

当然，您需要为错误检查等添加更多内容，但这是您可以做的要点。另外，不要忘记将 System.Reflection 命名空间添加到您的 using 子句中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T19:24:39.597

The .NET type system won't allow type declarations of the form you're attempting. One reason why this is disallowed should be intuitive: how would `MyGenericClass<T>` act when `T` is a sealed class (e.g. `System.String`)?

If you absolutely need this functionality (and you know that the type `T` you'll be using isn't sealed), you can generate proxies at runtime using the classes in the `Reflection.Emit` namespace. It may also be possible to achieve this effect using AOP tools like PostSharp.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-14T19:42:58.383

What about this:

```
class BaseClass<T>
{
    public T property { get; set; }
}

class GenericClass<T> : BaseClass<T>
{ 

}

class Program
{
    static void Main(string[] args)
    {
        GenericClass<int> l = new GenericClass<int>();
        l.property = 10;
    }
} 
```

This achieves what you want to do?

# msbuild - 我在哪里可以获得项目文件中所有可用属性的列表？

> ID：748711
> 
> 赞同：3
> 
> 时间：2009-04-14T18:00:22.653
> 
> 标签：msbuild, properties, tfsbuild

我正在寻找一种资源来列出 MSBuild 项目文件中定义的所有内置属性。具体来说，我使用的是 Team Build 项目文件，但据我了解，它们是同一个（如果我错了，请纠正我）。

我已经知道保留的属性：http: [//msdn.microsoft.com/en-us/library/ms164309.aspx](http://msdn.microsoft.com/en-us/library/ms164309.aspx)

但我注意到示例中引用了其他方便的变量，例如 $(SolutionRoot) 和 $(OutDir)。

是否有我可以访问的所有属性的完整列表？这些其他属性在哪里定义？我发现一个论坛帖子问了同样的问题，它指向 Microsoft.TeamFoundation.Build.targets 文件，但我在那里查看并找不到列出的 $(SolutionRoot) 和 $(OutDir) 的定义。

感谢您提供的任何帮助，丹尼尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T21:52:57.903

这是另一个很好的参考：

[http://blogs.msdn.com/aaronhallberg/archive/2008/02/12/team-build-2008-property-reference.aspx](http://blogs.msdn.com/aaronhallberg/archive/2008/02/12/team-build-2008-property-reference.aspx)

瓦卡诺

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T19:18:14.667

你看到了吗：[http ://www.woodwardweb.com/vsts/30_useful_team.html](http://www.woodwardweb.com/vsts/30_useful_team.html)

# svn - 跟踪中的多个项目

> ID：748719
> 
> 赞同：6
> 
> 时间：2009-04-14T18:03:56.793
> 
> 标签：svn, project-management, trac

如何轻松管理多个 SVN 存储库/trac 实例？我有一堆项目想要整合到一个单一的身份验证方案中。此外，我希望能够为每个项目启用插件，并同时为多个项目配置一堆 trac 选项。

能够从 Web 界面添加和删除项目也很不错。

谢谢

-纳尔逊

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T19:00:49.607

我们在 trac 上遇到了同样的问题，我们的解决方案是迁移到[redmine](http://www.redmine.org/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-10-15T11:46:24.420

我想这就是你要找的。

[http://trac.edgewall.org/wiki/TracMultipleProjects](http://trac.edgewall.org/wiki/TracMultipleProjects)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-14T21:24:56.843

关于您问题的 trac 部分，您可能需要关注这个问题： [您如何处理 trac 中的多个（重叠）项目？](https://stackoverflow.com/questions/268039/how-do-you-handle-multiple-overlapping-projects-in-trac)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-05-28T20:40:19.687

这里的一些答案已经过时了，因为与此同时 Trac 尤其是它的插件已经取得了很大的进步。IMO 不再需要更改为 Redmine。这是当前最先进的技术，尤其是维护和有用的：

另请查看[Trac 的插件推荐站点](http://trac.edgewall.org/wiki/PluginList)。IMO 最好将以下插件添加到新安装的 Trac-1.0 中：

*   SimpleMultiProjectPlugin（一个 Trac 实例中的多个项目）
*   AdvancedTicketWorkflowPlugin（自己的工单状态和工作流程转换，如“测试”）
*   TimingAndEstimationPlugin（工作时间、计划时间）
*   EstimationToolsPlugin（燃尽图和工作量图表）
*   TracJsGanttPlugin（甘特图）
*   MasterTicketsPlugin（票据依赖）
*   ​SubticketsPlugin（工单层次结构）
*   ChildTicketsPlugin（父子关系）
*   FullBlogPlugin（博客和新闻）
*   TracTicketStatsPlugin（工作流统计）
*   AutocompleteUsersPlugin（用户名自动补全）
*   UserManagerPlugin（用户和角色）
*   UpcomingMilestonesChartMacro（里程碑日期图表）

这是良好项目管理所需的一切的良好组合。它们都可以在 trac-hacks.org 上找到，Trac 的插件安装非常容易。

自 0.12 以来，对多个存储库的支持是 Trac 本身的内置功能。

还可以看看即将到来的[Apache Bloodhound 项目](http://bloodhound.apache.org/)，它建立在 Trac 之上，也是我上面所写内容的替代方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T18:12:42.360

纳尔逊——

我相信您正在寻找的功能在标准 Trac 发行版中不存在。

不确定您是否能够使用 Subversion 托管/Trac 托管服务，但有几种服务可以为您提供所有这些，以及零设置/维护问题。其中一些有可能满足您需求的免费或低成本选项。

[http://www.projecthut.com](http://www.projecthut.com)

[http://www.projectlocker.com/](http://www.projectlocker.com/)

[http://sourcerepo.com](http://sourcerepo.com)

[http://wush.net](http://wush.net)

还有更多，谷歌搜索“Subversion 托管”或“Trac 托管”会出现。

全面披露：我为 ProjectLocker 工作。

# php - 在一个或很少的查询中更新多个 MySQL 行的显示顺序

> ID：748720
> 
> 赞同：17
> 
> 时间：2009-04-14T18:04:37.293
> 
> 标签：php, mysql, sorting

我有一张表，每行有 20 行，每行都有一个显示顺序（1-20）。

```
SELECT * FROM `mytable` ORDER BY `display_order` DESC; 
```

从管理区域，您可以拖动行或为每行手动键入一个新数字。

当然，为每一行循环一个 UPDATE 查询是不好的，在一个或很少的查询中，有什么替代方法适合更新 20 行甚至更多行中的一个单元格，50-200+？

* * *

**编辑：**很多好的回应和想法。我可能会扩展我迄今为止考虑的想法：

**一个数组字符串**：我可以在一个字符串中按我想要的顺序列出唯一行 ID - 例如第 1、9、2、6、23 行。当订单更新时，隐藏字段会使用 JavaScript 更新，并在完成后将其添加到数据库或文本文件中：

```
UPDATE `my_dispaly_order_table` SET `display_order`='1,9,2,6,23'; 
```

**单独更新每一行**：这是我试图避免的，但它只会很少更改，所以每周或每月一次点击 20-30 次调用可能不是问题，所以我通常只在每一行上调用 UPDATE做：

```
UPDATE `mytable` SET `display_order`='1' WHERE `rowId` = 1;
UPDATE `mytable` SET `display_order`='2' WHERE `rowId` = 9;
UPDATE `mytable` SET `display_order`='3' WHERE `rowId` = 2;
UPDATE `mytable` SET `display_order`='4' WHERE `rowId` = 6;
UPDATE `mytable` SET `display_order`='5' WHERE `rowId` = 23; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-04-23T04:24:58.873

soulmerge 的回答让我思考，我认为这是一个更好的解决方案。您需要做的是使用 IN() 选择具有 id 的行，然后使用 CASE 设置值。

```
UPDATE mytable SET display_order =
  CASE id
    WHEN 10 THEN 1
    WHEN 23 THEN 2
    WHEN 4 THEN 3
  END CASE
WHERE id IN (10, 23, 4) 
```

我当前的应用程序需要这个。在 PHP 中，我从 jQuery UI 的内置可排序功能中获得了一组序列化（和有序）的 id。所以数组看起来像这样：

```
$new_order = array(4, 2, 99, 15, 32); // etc 
```

为了生成单个 MySQL 更新查询，我这样做：

```
$query = "UPDATE mytable SET display_order = (CASE id ";
foreach($new_order as $sort => $id) {
  $query .= " WHEN {$id} THEN {$sort}";
}
$query .= " END CASE) WHERE id IN (" . implode(",", $new_order) . ")"; 
```

最后的“内爆”只是给了我 IN() 的 ID 列表。这对我来说很有效。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-14T18:20:12.403

你应该首先确保该列没有 UNIQUE 索引，否则 mysql 会在查询期间告诉你约束被破坏。之后，您可以执行以下操作：

```
-- Move #10 down (i.e. swap #10 and #11)
UPDATE mytable SET display_order =
  CASE display_order
    WHEN 10 THEN 11
    WHEN 11 THEN 10
  END CASE
WHERE display_order BETWEEN 10 AND 11;

-- Move #4 to #10
UPDATE mytable SET display_order
  CASE display_order
    WHEN 4 THEN 10
    ELSE display_order - 1
  END CASE
WHERE display_order BETWEEN 4 AND 10; 
```

但你实际上应该确保你一步一步地做事。如果不使用 id，分两步交换将导致编号损坏。IE：

```
-- Swap in two steps will not work as demostrated here:

UPDATE mytable SET display_order = 10 WHERE display_order = 11;
-- Now you have two entries with display_order = 10

UPDATE mytable SET display_order = 11 WHERE display_order = 10;
-- Now you have two entries with display_order = 11 (both have been changed) 
```

这里是[对 mysql 的 CASE 语句的](http://dev.mysql.com/doc/refman/5.1/de/case-statement.html)引用。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-15T08:43:53.947

有点晚了，但它可能对其他人有用：

```
UPDATE mytable SET display_order = FIND_IN_SET(rowId, '1,9,2,6,23') WHERE rowId in (1,9,2,6,23) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T18:12:46.430

您可以尝试将其包装成几个语句，我认为这不可能在一个语句中。例如，假设您要更新第 10 行。您希望提高 10 点之后的每条记录。

```
UPDATE table SET col=col+1 WHERE col > 10
UPDATE table SET col=10 WHERE id = X
... 
```

但是要引入所有所需的逻辑真的很困难。因为有些记录可能需要递减等等。你想避免重复等等。

从开发人员时间与收益的角度考虑这一点。

因为即使有人每天排序一次，与在存储过程中修复它或伪优化此功能相比，开销也很小，因此您不会运行 20 次查询。如果这不是每天运行 100 次，那么 20 次查询就可以了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-10-11T21:52:35.870

这是对数据库中的项目进行排序的好方法。正是我想要的;）

这是 Jamon Holmgren 版本的改进版本。这个函数是完全动态的：

```
function reOrderRows($tablename, $ordercol, $idsarray){

    $query = "UPDATE $tablename SET $ordercol = (CASE $ordercol ";
    foreach($idsarray as $prev => $new) {
      $query .= " WHEN $prev THEN $new\n";
    }
    $query .= " END) WHERE $ordercol IN (" . implode(",", array_keys($idsarray)) . ")";

    mysql_query($query);
} 
```

这假设您的表**$tablename上有一个列****$ordercol**仅用于排序目的。

 ****$idsarray**是格式为 array("current_order_num" => "updated_order_num") 的数组。

因此，如果您只想交换表格中的两行（例如，假设您的网页上有“上移”和“下移”图标），则可以在前一个之上使用此功能：

```
function swapRows($tablename, $ordercol, $firstid, $secondid){
    $swaparray = array("$firstid" => "$secondid", "$secondid" => "$firstid");
    reOrderRows($tablename, $ordercol, $swaparray); 
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T15:15:05.603

如果您需要拖动行，这是一个很好的实现`linked list`。

使用 a 对行进行排序`linked list`意味着您`3`一次最多更新行 - 即使您移动整个块（只要它是连续的）。

像这样创建一个行表：

```
CREATE TABLE t_list (
        id INT NOT NULL PRIMARY KEY,
        parent INT NOT NULL,
        value VARCHAR(50) NOT NULL,
        /* Don't forget to create an index on PARENT */
        KEY ix_list_parent ON (parent)
)

id   parent  value

1    0       Value1
2    3       Value2
3    4       Value3
4    1       Value4 
```

并使用此`MySQL`查询按顺序选择行：

```
SELECT  @r := (
        SELECT  id
        FROM    t_list
        WHERE   parent = @r
        ) AS id
FROM    (
        SELECT  @r := 0
        ) vars,
        t_list 
```

这将遍历您的链表并返回已订购的项目：

```
id   parent  value

1    0       Value1
4    1       Value4
3    4       Value3
2    3       Value2 
```

要移动一行，您需要更新该`parent`行的`parent`、其当前子项的 以及`parent`您之前插入的行的 。

请参阅我的博客中的这一系列文章，了解如何有效地做到这一点`MySQL`：

*   [**排序列表**](http://explainextended.com/2009/03/25/sorting-lists/)- 如何从链接列表中选择已排序的项目
*   [**排序列表：移动项目**](http://explainextended.com/2009/03/26/sorting-lists-moving-items/)- 如何移动单个项目
*   [**排序列表：添加项目**](http://explainextended.com/2009/03/27/sorting-lists-adding-items/)- 如何插入单个项目
*   [**排序列表：删除项目**](http://explainextended.com/2009/03/28/sorting-lists-deleting-items/)- 如何删除单个项目
*   [**排序列表：移动块**](http://explainextended.com/2009/03/29/sorting-lists-moving-blocks/)- 如何移动连续块
*   [**排序列表：删除块**](http://explainextended.com/2009/03/30/sorting-lists-deleting-blocks/)- 如何删除连续块

有很多文章，因为行锁定存在一些问题，每种情况的处理方式应略有不同。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-14T18:14:14.447

您可以删除重新插入所有行 - 这将在两个查询中完成整个操作（如果您需要选择所有数据，则三个查询）。我不会指望它会更快，而且你必须在事务中完成它，否则你很快就会去备份。它还可能导致表碎片。

更好的选择可能是将每个更改记录为历史记录，然后执行以下操作：

例如，位置 10 向下移动了 2 位到第 12 位

```
UPDATE table SET display_order = display_order -1 WHERE display_order BETWEEN 10 AND 12
UPDATE table SET display_order = 12 WHERE row_id = [id of what was row 10] 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-07T14:49:31.327

我正在考虑这个问题，我想出的解决方案是使用十进制数字作为顺序，并将项目的数量更改为下一个项目和上一个项目之间的数字

```
Order    Item
-----    ----
1        Original Item 1
2        Original Item 2
3        Original Item 3
4        Original Item 4
5        Original Item 5 
```

如果将项目 4 更改为第二个位置，您将获得：

```
Order    Item
-----    ----
1        Original Item 1
1.5      Original Item 4
2        Original Item 2
3        Original Item 3
5        Original Item 5 
```

如果将第 3 项更改为第 3 位，您将获得：

```
Order    Item
-----    ----
1        Original Item 1
1.5      Original Item 4
1.75     Original Item 3
2        Original Item 2
5        Original Item 5 
```

从理论上讲，两位小数之间总是有一个小数，但您可能会面临一些存储限制。

这样，您只需更新正在重新排序的行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-14T19:41:42.287

Collect the new order in a temporary variable and put a "save this order" button to the admin area. Then save the order for the rows with one round.

You'll get better response times, undoable changes, fewer modified rows (because in low level in the dbms, practically no updates used to be possible, but save a new instance of the whole row and delete the old one).

After all, it would be a lower cost solution for a whole reordering and would save some coding on the update optimization.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-14T18:09:10.887

您可以创建一个临时表并使用要更改的行的主键以及这些行的 display_order 的新值填充，然后使用 UPDATE 的多表版本一次性更新表。但是，如果不测试这两种方法，我不会认为这会更快。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-14T18:09:46.500

向表中添加一个 id（或其他键），并更新其中 id（或键）= id（或键）更改行的位置。

当然，您必须确保没有重复的 display_order 值，或者您可以接受 display_order 以任何顺序显示的关系，或者您将在 order by list 中引入第二个决胜局.

# sql - 为关系生成 CSV 的 Oracle 内联方法

> ID：748723
> 
> 赞同：1
> 
> 时间：2009-04-14T18:07:28.067
> 
> 标签：sql, oracle

我有以下表格：

```
ALERT (ID,Name)
   1  |  Alert A
   2  |  Alert B

ALERT_BRAND_XREF (ALERT_ID, BRAND_ID)
   1  | 1
   1  | 2
   2  | 1

BRAND (ID, NAME)
  1  | Brand A
  2  | Brand B 
```

我正在尝试编写一个语句以在一个字段中以 CSV 列表的形式返回包含适用品牌的警报列表。期望的结果：

```
 Alert A  |  Brand A, Brand B
 Alert B  |  Brand A 
```

有没有办法在不编写单独的函数的情况下做到这一点？如果可能的话，我想在一个独立的 SQL 语句中做到这一点。

这是 Oracle 9i。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T18:12:04.483

在 MySQL 中，使用该`GROUP_CONCAT()`函数会很容易，但在 Oracle 中做同样的事情看起来有点混乱：

[Oracle group_concat() 更新（再次）](http://halisway.blogspot.com/2006/08/oracle-groupconcat-updated-again.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T09:48:44.177

看看[这个解决方案](http://blog.lishman.com/2008/05/how-to-pivot-column-to-csv-list-in.html)，它非常有用。使用 SYS_CONNECT_BY_PATH 和分析函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T18:39:23.870

这是将重复组转换为逗号分隔列表的另一种方法。它使用 Oracle SQL 方言的 MODEL 子句。（甲骨文 10g）

[http://plsqlnotes.blogspot.com/2007/09/using-model-for-generating-csv-by_2227.html#links](http://plsqlnotes.blogspot.com/2007/09/using-model-for-generating-csv-by_2227.html#links)

（替换我之前的错误答案）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-05T12:06:08.427

在 oracle 中，您可以使用 wm_concat()

```
SELECT a.Name , wm_concat(b.Name) FROM 
   ALERT a, 
   ALERT_BRAND_XREF  abx ,
   BRAND b 
  where a.id = abx.ALERT_ID 
   and abx.BRAND_ID = b.id 
  group by  a.Name; 
```

# c# - 在visual basic中投射？

> ID：748725
> 
> 赞同：12
> 
> 时间：2009-04-14T18:08:50.027
> 
> 标签：c#, vb.net, casting

我是一名被迫使用 VB 的 C# 程序员（嗯！！！！）。我想用一种方法检查多个控件的状态，在 C# 中，这将是这样完成的：

```
if (((CheckBox)sender).Checked == true)
{
    // Do something...
}
else
{
    // Do something else...
} 
```

那么如何在 VB 中实现这一点呢？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-14T18:10:17.077

C＃：

```
(CheckBox)sender 
```

VB：

```
CType(sender, CheckBox) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-14T18:25:53.653

VB 实际上有 2 个转换概念。

1.  CLR 风格铸造
2.  词法铸造

CLR 风格转换是 C# 用户更熟悉的。这使用 CLR 类型系统和转换来执行强制转换。VB 有 DirectCast 和 TryCast，分别相当于 C# cast 和 as 运算符。

除了 CLR 类型系统之外，VB 中的词法转换还做了额外的工作。它们实际上代表了潜在演员阵容的超集。通过查找转换运算符上的 C 前缀很容易发现词法转换：CType、CInt、CString 等……如果编译器不直接知道这些转换，它们将通过 VB 运行时。运行时将在类型系统之上进行解释，以允许像下面这样的强制转换工作

```
Dim v1 = CType("1", Integer)
Dim v2 = CBool("1") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T18:12:17.307

[亚当罗宾逊](https://stackoverflow.com/questions/748725/casting-in-visual-basic/748732#748732)是正确的，也[`DirectCast`](http://msdn.microsoft.com/en-us/library/7k6y2h6x(VS.71).aspx)可供您使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T11:15:12.850

DirectCast 将在编译时执行转换，但只能用于转换引用类型。Ctype 将在运行时执行转换（比在编译时转换慢），但对于转换值类型显然很有用。在您的情况下，“发件人”是一种引用类型，因此 DirectCast 将是要走的路。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-04T20:31:42.627

在 VB.net 中进行转换使用关键字`ctype`. 所以 C# 语句`(CheckBox)sender`相当于`ctype(sender,CheckBox)`VB.net 中的语句。

因此，您在 VB.net 中的代码是：

```
if ctype(sender,CheckBox).Checked =True Then
    ' Do something...
else
    ' Do something else...
End If 
```

# jquery - 使用 JQuery 获取 Iframe 的当前 src

> ID：748727
> 
> 赞同：18
> 
> 时间：2009-04-14T18:09:16.440
> 
> 标签：jquery, iframe

每当用户单击不在同一域的 iframe 中的页面上的链接时，我都需要收到通知。我知道 xss 限制，但我只需要知道 Iframe 中提供的当前页面。有没有办法在不违反 xss 规则的情况下做到这一点？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-12-22T19:54:26.420

要使用 jQuery 获取 iframe 位置：

```
alert( $('iframeId').contents().get(0).location.href ); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-14T18:20:39.140

如果不是跨站点脚本限制，这应该可以工作。不幸的是，我不知道在不违反这些限制的情况下获取 URL 的方法。

```
<html>
    <head>
        <script type="text/javascript">
            function GetIFrameUrl()
            {
                alert('url = ' + document.frames['frame1'].location.href);
            }
        </script>
    </head>
    <body>
        <a href="#" onclick="GetIFrameUrl();">Find the iFrame URL</a>
        <iframe name="frame1" src="http://www.google.com" width="100%" height="400"></iframe>
    </body>
</html> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-12-18T15:03:09.987

您可以使用 vanilla js 轻松完成。

*   在文档中查询具有特定名称、id、类或其他内容的元素
*   获取该元素的属性来源

    ```
     //Get by Id
     var frame_src = document.getElementById('myIframe').src
     //Get by tag name - get the first
     var frame_src = document.getElementsByName('frmExternal')[0].src
     //Alert 
     alert(frame_src) 
    ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-14T08:17:00.593

```
 <script type="text/javascript"> // if window open in iframe then redirect to main site
         if(window.top.location != window.self.location)
         {
            alert(window.self.location);
            // top.window.location.href = window.self.location;
         }
    </script> 
```

# c# - 重写 .NET 基类库中的现有功能

> ID：748728
> 
> 赞同：3
> 
> 时间：2009-04-14T18:09:17.173
> 
> 标签：c#, .net, asp.net, vb.net

关于我昨天提出的关于日志记录的另一个[问题](https://stackoverflow.com/questions/744693/how-do-i-detect-if-im-running-in-the-console)，我被介绍给了 TraceListeners，这是我以前从未遇到过的，并且非常希望我有。我数不清有多少次不必要地编写记录器来执行此操作，也没有人指出这一点或问我为什么不使用内置工具。这让我想知道，由于我不知道的 .NET 功能，我忽略了哪些其他功能并将其不必要地写入了我的应用程序。

如果其他人知道 .NET 已经内置了支持它的方法，是否有其他人拥有完全改变他们编写应用程序或应用程序组件的方式的 .NET 功能？

如果其他开发人员发布了他们经常遇到事后看来完全不需要的组件或代码块的场景，而原始开发人员只知道内置的 .NET 组件（例如我之前提到的 TraceListeners），那将会很方便。

这不一定包括3.5 本身的新增功能，但如果与场景相关，则可以*。*

**编辑**- 根据之前的评论，我对我之前同意的语言的“隐藏功能”并不感兴趣 - 我正在寻找由于我自己（或原始开发人员）的无知而经常被忽视的框架组件不必要地编写/重写了自己的组件/类/方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T18:13:31.250

yield 关键字改变了我编写代码的方式。这是一个了不起的小关键字，它对编写真正出色的代码有很多意义。

Yield 使用允许您将多个操作串在一起的数据创建“差异调用”，但只遍历列表一次。在下面的示例中，使用 yield，您将只创建一个列表，并遍历数据集一次。

```
FindAllData().Filter("keyword").Transform(MyTransform).ToList() 
```

yield 关键字是构建大多数 LINQ 扩展的基础，它为您提供 LINQ 的性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T18:13:13.450

还：

*   [ASP.NET 的隐藏特性](https://stackoverflow.com/questions/54929/hidden-features-of-asp-net)
*   [VB.NET 的隐藏特性？](https://stackoverflow.com/questions/102084/hidden-features-of-vb-net)
*   [F#的隐藏特性](https://stackoverflow.com/questions/181613/hidden-features-of-f)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T18:13:40.547

我遇到的最常被忽视的功能是 ASP.net 健康监控系统。一个不错的概述在这里：[http ://aspnet.4guysfromrolla.com/articles/031407-1.aspx](http://aspnet.4guysfromrolla.com/articles/031407-1.aspx)

我知道在我真正在一本书或网络上看到任何关于它的东西之前，我个人在几个应用程序上重新创建了它。

有一次，我在一次会议上与某人交谈并询问了此事。他们告诉我，MS 的开发人员沟通技巧很差，所以基本上没有记录 :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T18:24:31.910

不久前我重写了`System.Net.WebClient`课程。我正在做一些网络抓取并开始我自己的类来包装 HttpWebRequest/HttpWebReponse。然后我在中途发现了 WebClient。我还是完成了它，因为我需要 WebClient 不提供的功能（控制 cookie 和用户代理）。

我正在考虑重写的是`String.Format()`方法。我想反映用于解析输入字符串的代码并模仿它来构建我自己的“CompiledFormat”类，您可以在循环中使用该类，而不必在每次迭代时重新解析您的格式字符串。结果将允许像这样的高效代码：

```
var PhoneFormat = new CompiledFormat("({0}){1}-{2}x{3}");
foreach (PhoneNumber item in MyPhoneList)
{
    Console.WriteLine(PhoneFormat.Apply(PhoneNumber.AreaCode, PhoneNumber.Prefix, PhoneNumber.Number, PhoneNumber.Extension));
} 
```

**更新：**
这促使我最终去做。在此处查看结果： [性能问题：与 String.Format 进行比较](https://stackoverflow.com/questions/761121/performance-issue-building-a-string)

# c# - 无法在 .Net 中预览多个页面 tiff 文件

> ID：748735
> 
> 赞同：4
> 
> 时间：2009-04-14T18:11:14.733
> 
> 标签：c#, .net, printing, preview

我正在尝试从 C# 2005 Windows 应用程序预览和打印多页 TIFF 文件。打印工作正常，但是当我将 PrintDocument 发送到 PrintPreviewDialog 时，我得到第一页的两个图像，而不是第一页和第二页的图像。当我使用 PrintPreviewControl 时，我也遇到了同样的问题。

下面是带有 2 个按钮、一个 PrintDocument 和一个 PrintPreviewDialog 的表单的代码，用于演示该问题。

```
public partial class Form1 : Form
{
    private Image m_Image;
    private Int32 m_CurrentPage;
    private Int32 m_PageCount;

    private void Form1_Load(object sender, EventArgs e)
    {
        m_Image = Image.FromFile(".\\Test-2-Page-Image.tif");
        m_PageCount = m_Image.GetFrameCount(FrameDimension.Page);
    }

    private void printDocument_BeginPrint(object sender, PrintEventArgs e)
    {
        m_CurrentPage = 0;
        m_PageCount = m_Image.GetFrameCount(FrameDimension.Page);
    }

    private void printDocument_PrintPage(object sender, PrintPageEventArgs e)
    {
        m_Image.SelectActiveFrame(FrameDimension.Page, m_CurrentPage);
        e.Graphics.DrawImage(m_Image, 0, 0);
        ++m_CurrentPage;
        e.HasMorePages = (m_CurrentPage < m_PageCount);
    }

    private void btnPreview_Click(object sender, EventArgs e)
    {
        printPreviewDialog.Document = printDocument;
        printPreviewDialog.ShowDialog();
    }

    private void btnPrint_Click(object sender, EventArgs e)
    {
        printDocument.Print();
    }
} 
```

有谁知道 .Net 框架中的 PrintPreviewDialog 是否存在问题，或者我做错了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T09:51:15.740

这是该`Graphics.DrawImage()`功能的错误。

问题记录在这里：[Graphics.DrawImage Bug](http://radio.weblogs.com/0122832/2005/10/20.html)

工作代码如下所示：

```
img.SelectActiveFrame(FrameDimension.Page, curPage);
using(MemoryStream stm = new MemoryStream())
{     
    img.Save(stm, imgCodecInfo, encParams); // save to memory stream
    Bitmap bmp = (Bitmap)Image.FromStream(stm);
    e.Graphics.DrawImage((Image)bmp,0,0);
    bmp.Dispose();
} 
```

# c# - 在单击超链接字段时更改 Gridview 行样式

> ID：748743
> 
> 赞同：0
> 
> 时间：2009-04-14T18:12:23.483
> 
> 标签：c#, asp.net, gridview, hyperlink

我有一个 ASP.NET（使用 C# 的 2.0）网络应用程序，其中我在页面上有一个网格视图（My_Page.aspx）。gridview 从 Oracle 数据库中获取数据。我在 gridview 中有一个超链接字段，单击该字段时，会回发到同一页面，但单击的项目的详细信息（使用 QueryString）。

```
<asp:HyperLinkField DataNavigateUrlFields="ID" 
                    DataNavigateUrlFormatString="My_Page.aspx?id={0}"
                    DataTextField="NAME" 
                    HeaderText="Item1" 
                    SortExpression="NAME" /> 
```

我想知道如何更改单击超链接所在行的样式。

有任何想法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T18:34:25.537

首先， HyperLink(Field) 通常不会回发，但在您的情况下，请求具有新参数的同一页面。

要为 GridView 行设置 CSS 类，请使用 RowCreated 事件执行以下操作：

```
protected void GridView_RowCreated(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
        if (e.Row.DataItem.ToString() == Request["id"])
            e.Row.CssClass = "highlighted-css-class";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-24T11:16:09.813

我的情况：

```
<asp:GridView ID="gvProjects" runat="server">
<SelectedRowStyle CssClass="current" />
<Columns>
<asp:TemplateField>
    <ItemTemplate>
        <asp:LinkButton ID="cmdShowProject" runat="server" 
           OnCommand="cmdShowProject_Command"
           CssClass="show-project" CommandName="select"
    </ItemTemplate>
</asp:TemplateField> 
```

**必须设置**SelectedRowStyle （通过单个属性或通过 CssClass）。**CommandName 必须是**“选择”**才能更改行样式。GridView 位于 UpdatePanel 中。**

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T14:57:30.023

我建议你使用 Javascript 来实现这一点。由于您不能直接使用链接按钮，因此您必须在 DOM 中导航到父 TR (TableRow) 元素并设置其类属性。

首先，添加 onclick 属性（如果 HyperLinkField 不可能，请尝试简单的 HyperLink 或 LinkBut​​ton）

将控件作为参数传递给 Javascript 函数

```
onclick="selectRow(this)"

function selectRow(hyperlink) { ... } 
```

我将让您弄清楚如何在 DOM 中导航以找到父 TR。

几个参考：

[domtables](http://www.howtocreate.co.uk/tutorials/javascript/domtables)

[域结构](http://www.howtocreate.co.uk/tutorials/javascript/domstructure)

希望能帮助到你

# database - 如何将图像与 Google App Engine 中的实体相关联

> ID：748746
> 
> 赞同：0
> 
> 时间：2009-04-14T18:12:46.117
> 
> 标签：database, image, google-app-engine, cloud

我正在开发一个 Google App Engine 应用程序，并且已经到了我想将文件系统上的图像与数据库中的实体相关联的地步。

我正在使用 bulkupload_client.py 脚本将实体上传到数据库，但我一直在试图弄清楚如何将文件系统文件与实体相关联。如果一个实体有以下图像：main,detail,front,back 我*想*我可能想要这样的命名方案：`<entity_key`>_main.jpg

我想我可以为每个实体创建一个 GUID 并使用它，但我宁愿不必这样做。

有任何想法吗？

我想我不能使用实体键，因为它在本地和生产数据存储之间可能不同，所以我必须在生产批量上传后重命名我的所有图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T05:59:12.393

有一个关于如何[使用 Google App Engine 提供动态图像](http://code.google.com/appengine/articles/images.html)的 GAE 教程。包括解释和可下载的源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T19:14:49.213

基于我对 GAE 的非常有限的了解，我在这里看到了两个选项。

首先，您实际上不能在 GAE 中向文件系统写入任何内容，对吗？这意味着您想要包含的任何图像都必须作为 Web 应用程序的一部分上传，因此将具有已知且不可更改的静态名称和目录结构。在这种情况下，您对 _main.jpg 或 /entity_key/main.jpg 的想法可以正常工作。

第二个选项是将图像作为 blob 存储在数据库中。这可能允许动态上传图像，而不是每次需要更新图像时都必须上传新版本的 web 应用程序。它会很快占用您的免费数据库空间。以下是有关从数据库中提供图片的一些信息。[http://code.google.com/appengine/articles/images.html](http://code.google.com/appengine/articles/images.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T15:36:58.357

如果您要静态上传图像，则可以根据需要使用基于键的方案：只需为实体分配一个键名，然后使用它来查找关联的图像。您指定一个键名（在 Python 版本中）作为实体类的 key_name 构造函数参数：

```
myentity = EntityClass(key_name="bleh", foo="bar", bar=123)
myentity.put() 
```

您可以像这样获取实体的键名：

```
myentity.key().name() 
```

听起来有问题的数据存储实体基本上是静态内容，所以也许你最好简单地将它们编码为源中的文字，从而将它们放在内存中，或者在运行时从本地数据文件加载它们，绕过需要为他们查询数据存储？

# windows-mobile - IE Mobile：由于错误 0x80072f7c 无法连接

> ID：748756
> 
> 赞同：2
> 
> 时间：2009-04-14T18:15:06.097
> 
> 标签：windows-mobile, ie-mobile

去年年底，我们推出了移动浏览器网站[m.cozi.com 。](http://m.cozi.com/)我们选择使用静态 HTML 和 CSS，而不是 JavaScript，提供最低标准的体验。它适用于大多数人，但我们的一些客户报告连接问题。我真的不知道如何吸引他们。

有问题的都是在 Windows Mobile 上运行 IE Mobile。当然是 WM6，也可能是 WM5。许多 WM6/IE 用户都没有问题。当然，我从未见过任何有问题的手机。

那些确实有问题的人在访问我们的网站时会看到这一点：

```
"Alert. The page you are looking for cannot be found
due to unknown error 0x80072f7c." 
```

0x80072f7c = `ERROR_WINHTTP_REDIRECT_FAILED`，但我可靠地得知 winhttp 在 Windows Mobile 中不存在。

我已经要求我们的客户服务团队检查这些用户是否确实可以从他们的移动浏览器连接到其他网站，HTTP 和 HTTPS。

我认为这可能与运营商的 HTTP 代理有关。我们收到了来自 AT&T 用户和加拿大罗杰斯用户的问题报告，但这些都是主要运营商，并且有很多用户对这些运营商没有问题。

一位用户报告说，在 IE Mobile 出现故障的同一部手机上，Opera Mobile 运行良好。

我就此询问了 Windows Mobile 团队的一位联系人，但他找不到任何有用的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T19:46:16.457

I sometimes receive that error on my Windows Mobile 5 device when it's docked. When docked it's supposed to route the internet access through the host computer, but it doesn't always work. Normally undocking it and plugging it back in fixes it.

# unit-testing - 用于命令行集成测试的 PHPUnit

> ID：748758
> 
> 赞同：2
> 
> 时间：2009-04-14T18:15:14.490
> 
> 标签：unit-testing, integration-testing, phpunit

最近，我开始研究我们产品中的 Email2SMS 功能。当我加入该项目时，该组件的单元测试代码覆盖率为零。遗留代码。

自从我开始研究它以来，我一直在使用测试优先的方法。但是代码质量非常低。很难将它拆分并通过单元测试来测试小块，所以我决定编写集成测试。

有一个 php 脚本，它接受一些消息信息，在数据库中搜索用户并保存一些信息，如果一切正常。

```
$last_line = system('php emailtosms.php -file=unicode_message.txt ', $retval);

$this->assertStringExistsInLogFile('Email to SMS message was not sent'); 
```

是坏还是不好？你将如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T18:37:12.127

不太好。

在较低级别进行测试，将 emailtosms.php 脚本作为处理命令行参数的简单包装器，然后传递给更可测试的类。根据最后一步，您可以编写单元测试来执行除最后发送之外的几乎所有操作（也许模拟实际发送它的最后一步，并将其存储到一个变量中，然后检查您那里是否有有效的东西）。

最终的集成，端到端运行整个类，并检查其输出，查看最终的日志 - 或者更高级别，将放入日志中的内容。

# iis - 来自 web.config 的 IIS 虚拟目录

> ID：748772
> 
> 赞同：3
> 
> 时间：2009-04-14T18:20:50.420
> 
> 标签：iis, web-config, virtual-directory

我有一个 IIS 问题，我认为[这个博客](http://geekswithblogs.net/ranganh/archive/2005/04/25/37609.aspx)给了我一个解决方法：

> 要解决它，请右键单击虚拟目录 - 选择属性，然后单击“应用程序”标签和文本框旁边的“创建”。它将使用虚拟目录的名称自动创建“应用程序”。现在可以访问应用程序了。

但是我无权访问 IIS GUI。有没有办法通过编辑 web.config 文件来做同样的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T18:27:28.937

恐怕这是不可能的。将目录配置为应用程序、设置 AppPool 等是 Web 服务器的职责。通常，您的网络托管服务提供商会提供一个控制面板，让您可以配置虚拟目录。如果没有，您需要通过他们的支持渠道与他们联系以完成此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T18:24:56.713

您不能通过 web.config 创建虚拟目录。如果这是在网络主机上，那么您将需要使用他们为您提供的任何用户界面来创建虚拟目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T18:28:01.153

或者在您被允许访问的某些托管站点上，您需要向服务中心或帮助台提交一张票，以使其成为应用程序。他们还需要知道您希望它是哪个版本的 .net 框架。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-27T19:35:59.113

该`ImageResizer`项目有一种使用自己的机制创建虚拟文件夹的方法。不建议用于生产，但它可能适合某些需求。

添加

```
<add name="VirtualFolder" virtualPath="~/" physicalPath="..\Images" vpp="false "/> 
```

到该`<plugins />`部分。

[http://imageresizing.net/docs/v4/plugins/virtualfolder](http://imageresizing.net/docs/v4/plugins/virtualfolder)

# c# - 如何将 IDisposable + 委托 obj 添加到现有类

> ID：748775
> 
> 赞同：0
> 
> 时间：2009-04-14T18:22:58.840
> 
> 标签：c#

我被告知我想做的事情是不可能的。我想要做的是扩展一个类，所以它有一个 IDisposable obj，它将调用一个委托 obj。新类应该与基类完全一样（obj.BaseMethod() 我不想做 obj.theobj.BaseMethod()）。基本上我将得到的只是经理将知道它给线程的对象是否超出范围或不再使用。我怎样才能做到这一点？（请参阅此线程关于我正在尝试做什么[我应该如何跟踪使用中的 Objs，C#](https://stackoverflow.com/questions/748591/how-should-i-track-objs-in-use-c)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T18:33:32.760

您可以为此使用 AOP，例如 Spring.NET，然后将 IDisposable 接口和必要的函数添加到您的类中。

# .net - 同步运行 GC.Collect

> ID：748777
> 
> 赞同：15
> 
> 时间：2009-04-14T18:23:53.423
> 
> 标签：.net, nunit, garbage-collection

`GC.Collect`似乎在后台线程中启动垃圾收集，然后立即返回。我怎样才能`GC.Collect`同步运行——即等待垃圾收集完成？

这是在 NUnit 测试的上下文中。我尝试将[gcConcurrent](http://msdn.microsoft.com/en-us/library/at1stbec.aspx)设置添加到我的测试程序集的 app.config 文件中，并且我对 nunit.exe.config 进行了同样的尝试。两者都没有任何效果——当我调试时，我仍然可以看到终结器在“GC终结器线程”上运行，而不是调用的线程`GC.Collect`（NUnit的“TestRunnerThread”），并且两个线程同时运行。

背景：如果我的测试泄漏（不要调用 Dispose）特定类，我希望我的测试失败。所以我为那个设置静态`wasLeaked`标志的类添加了一个终结器；然后我的测试 TearDown 调用`GC.Collect()`然后抛出如果`wasLeaked`是真的。但它并没有确定性地失败，因为当它读取时`wasLeaked`，终结器通常还没有被调用。（在垃圾收集最终完成之后，它会失败一些后来的测试。）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-14T19:14:49.137

终结器在专用的高优先级后台线程上运行。从你帖子的背景来看，我认为你可以简单地做

```
GC.Collect();
GC.WaitForPendingFinalizers(); 
```

将`Collect()`安排任何非根实例进行终结，然后线程将等待终结器线程完成。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T18:31:59.957

您可以使用`GC.RegisterForFullGCNotification`, 触发完整的集合，`GC.Collect(GC.MaxGeneration)`然后使用`GC.WaitForFullGCComplete`and`GC.WaitForPendingFinalizers`方法，但请确保仅在您的测试中使用它，它们不应该用于生产代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T18:33:50.450

一种更简单/更好的方法可能是使用模拟并检查 Dispose 被显式调用的期望。

使用 RhinoMocks 的示例

```
public void SomeMethodTest()
{
     var disposable = MockRepository.GenerateMock<DisposableClass>();

     disposable.Expect( d => d.Dispose() );

     // use constructor injection to pass in mock `DisposableClass` object
     var classUnderTest = new ClassUnderTest( disposable ); 

     classUnderTest.SomeMethod();

     disposable.VerifyAllExpectations();
} 
```

如果该方法需要创建然后处置对象，那么我将使用并注入一个能够创建模拟对象的工厂类。下面的示例在工厂中使用存根，因为它不是我们在此测试中测试的内容。

```
public void SomeMethod2Test()
{
     var factory = MockRepository.Stub<DisposableFactory>();
     var disposable = MockRepository.GenerateMock<DisposableClass>();

     factory.Stub( f => f.CreateDisposable() ).Return( disposable );         
     disposable.Expect( d => d.Dispose() );

     // use constructor injection to pass in mock factory
     var classUnderTest = new ClassUnderTest( factory ); 

     classUnderTest.SomeMethod();

     disposable.VerifyAllExpectations();
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T18:58:13.077

无论您是否使用并发 GC，终结器始终在单独的线程上运行。如果您想确保终结器已运行，请尝试`GC.WaitForPendingFinalizers`改用。

# git - 如何将简单的非源代码控制项目备份转换为版本化的 git 存储库？

> ID：748778
> 
> 赞同：9
> 
> 时间：2009-04-14T18:23:57.637
> 
> 标签：git, version-control

我一直非常淘气。我已经开发了一段时间的软件（我是唯一的开发人员）（好吧，这已经过去了几年），但没有使用任何类型的源代码控制。

从现在开始，我已经决定使用源代码控制（git 似乎最有可能，因为 windows 工具似乎在过去几个月里出现了很多）。我所拥有的是我的（.NET）解决方案的整个目录的过时备份。

我想做的是自动让我的备份在修订历史中可见。会很乱。项目和文件将在解决方案历史过程中添加/删除。我不担心这样的问题，例如我知道重命名文件被解释为删除文件并添加新的、不相关的文件。

更一般地说，我的问题是：我有时间订购了更改目录的副本。我认为将第一个导入 git 很容易。但是，我希望目录的所有后续副本按日期顺序合并，一次一个，而不必单独提交每个子目录和文件。

这是可能的，还是只是因为我没有从一开始就使用源代码控制而受到惩罚？

编辑：如果我手动继续使用“单独提交所有快照”方法（少于 20 个快照），有没有办法（正如 Esko Luontola 建议的那样）用我拥有的日期覆盖提交日期快照。git commit 似乎没有允许这样做的标志。还有另一种方法（我正在使用Vista）？

编辑：回答我使用原始日期的问题：您必须设置 GIT_AUTHOR_DATE 和/或 GIT_COMMITER_DATE 环境变量以在执行提交时覆盖当前日期和时间的使用。

有两组变量（还有 GIT_(AUTHOR|COMMITER)_(NAME|DATE|EMAIL)）的原因是为了区分发送补丁的作者和实际进行提交的维护者进入回购。

请注意，如果在 VS 上使用 git 扩展：如果您使用 'git bash' 命令行设置 (export varname="value") 这些变量，然后切换回 GUI 进行提交，它似乎会忽略它们。您必须留在命令行上并从那里运行“git commit”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T09:58:29.790

您可以使用git.git 存储库中分发的基于[git-fast-import的示例工具：（](http://kernel.org/pub/software/scm/git/docs/git-fast-import.html)`import-zips.py` *在 Python 中）*或`import-tars.perl` *（在 Perl 中）*，或者使用这些脚本作为您自己的导入脚本的基础。[`contrib/fast-import/`](http://repo.or.cz/w/git.git?a=tree;f=contrib/fast-import)您可以在目录中找到这些脚本。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-14T18:26:02.920

可能已经有一种自动化的方法可以做到这一点，但是 git 应该足够聪明，可以让你`git init`在最旧的备份中，然后重复地将`.git`文件夹复制到增量更新的备份，并为每个备份创建一个提交。编写脚本应该很容易。

更好的是，您可以将`--git-dir=`选项或`$GIT_DIR`环境变量传递给 git 并让它使用存储库，从而节省复制步骤。

像这样的东西：

```
cd $FINAL_DIR
git init

export GIT_DIR=$FINAL_DIR/.git

cd $NEXT_BACKUP
git add -A .
git commit
# rinse and repeat 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-14T19:03:54.327

我不太清楚为什么您不想单独提交所有快照。我的意思是，执行此操作的 shell 脚本（或 Perl、Python、Ruby、Tcl 等）可能不到 5 行代码和不到 10 分钟的工作时间。

此外，还有[`git load-dirs`](http://Software.Complete.Org/software/wiki/vcs-load-dirs/)，它可以让您将其减少到 3 行和 5 分钟。但是您仍然必须单独加载每个目录。

但是，如果您愿意，可以使用[`git fast-import`](http://Kernel.Org/pub/software/scm/git/docs/git-fast-import.html)旨在使编写存储库转换器和导入器更容易的工具。根据手册页，您可以在大约 100 行和几个小时内编写一个导入程序。

然而，所有这一切都忽略了最大的问题：VCS的*价值**不*在于内容——您也可以为此使用定期备份——而在于提交消息。没有什么神奇的工具可以帮助你，你必须自己输入它们……更重要的是，你必须准确地记住*为什么*你在过去几年里做出了每一个小小的改变。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-21T20:31:48.700

另请查看[迁移到 Git 章节](https://git-scm.com/book/en/v2/Git-and-Other-Systems-Migrating-to-Git#A-Custom-Importer)中的“自定义导入器”部分。其中谈到了这个确切的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-25T19:36:18.267

如果您使用的是`import-tars`importer (in `contrib/fast-import/`)，请知道当存档包含全局 PAX 标头（用于注册提交）时，它会在存储库的顶层创建虚假文件，这会产生自己的逻辑来检测和省略常见的前导目录无效，已在 Git 2.27（2020 年第二季度）中更正。

请参阅[Johannes Schindelin ( ) 的](https://github.com/dscho)[commit c839fcf](https://github.com/git/git/commit/c839fcff65f72d3a656d541f223151c940eed108)（2020 年 3 月 24 日[）](https://github.com/dscho)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 8633f21](https://github.com/git/git/commit/8633f213e63412f76d7ded5a0a046c37d84388f5))^(中，2020 年 4 月 22 日）)[`dscho`](https://github.com/dscho)
^([`gitster`](https://github.com/gitster))

> ## [`import-tars`](https://github.com/git/git/commit/c839fcff65f72d3a656d541f223151c940eed108): 忽略全局 PAX 标头
> 
> ^(签字人：约翰内斯·辛德林)
> 
> tar 导入[`contrib/fast-import/import-tars.perl`](https://github.com/git/git/blob/c839fcff65f72d3a656d541f223151c940eed108/contrib/fast-import/import-tars.perl)器有一个非常方便的特性：如果存储在导入的*所有*`.tar`路径都以公共前缀开头，例如`git-2.26.0/`在[https://github.com/git/git/archive/v2.26.0.tar.gz](https://github.com/git/git/archive/v2.26.0.tar.gz)的 tar 中，然后去掉这个前缀。
> 
> 这个特性很有意义，因为将同一个项目的两个或多个修订版导入 Git 是相对常见的，显然我们不希望所有文件都存在于一个名称从一个修订版到另一个修订版更改的树中。
> 
> 现在，该功能的问题在于，如果`pax_global_header`在树顶部的所述前缀之外有一个“文件”，它就会崩溃。
> 
> 这是`.tar`由 Git 自己的[`git archive`](https://git-scm.com/docs/git-archive)命令生成的文件的情况：它插入该标头，并`git archive`允许`_not`通过`--prefix=my-project-1.0.0/`.
> 
> `.tar`在将文件导入 Git时，让我们跳过任何全局标题。
> 
> 注意：此全局标头可能包含有用的信息。
> 例如，在 的输出中`git archive`，它列出了原始提交，其中`_is`_ 有用的信息。
> 
> 未来对`import-tars.perl`脚本的改进可能是将该信息包含在提交消息中，或者对这些信息执行其他操作（例如，使用`mtime`包含在全局标头中的信息作为提交日期）。
> 此补丁不会阻止任何将来的补丁发生这种情况，它只会阻止将标头视为常规文件。

# javascript - 在网站上混淆电子邮件地址的最佳方法是什么？

> ID：748780
> 
> 赞同：150
> 
> 时间：2009-04-14T18:24:48.197
> 
> 标签：javascript, html, email, obfuscation

在过去的几天里，我一直在努力更新我的个人网站。我个人网站的网址是（我的名字）.（我的姓氏）.com，因为我的姓氏很不寻常，我有幸拿到了这个域名。我的电子邮件地址是（我的名字）@（我的姓氏）.com。所以说真的，当它归结为猜测时，这并不是很难。

无论如何，我想将一个 mailto: 链接集成到我的网站中，以便人们可以与我联系。而且，尽管我的电子邮件地址不是很难猜到，但我宁愿它不被垃圾邮件机器人收集，这些机器人只是爬取网站的电子邮件地址模式并将它们添加到他们的数据库中。

混淆我的电子邮件地址的最佳方法是什么，最好是链接形式？我知道的方法有：

```
<a href="mailto:x@y.com">e-mail me</a> 
```

它有效，但这也意味着一旦我的网站进入谷歌，我就会在垃圾邮件中翻滚，因为垃圾邮件机器人很容易找出我的电子邮件地址。

```
<img src="images/e-mail.png" /> 
```

这是不太理想的，因为不仅访问者无法单击它向我发送电子邮件，而且更智能的垃圾邮件机器人可能能够检测到图像包含的字符。

我知道可能没有完美的解决方案，但我只是想知道每个人都认为什么是最好的。如有必要，我绝对愿意使用 JavaScript，因为我的网站已经使用了大量的 JavaScript。

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-04-14T18:29:01.867

我将字符编码为 HTML 实体（[类似这样](http://www.wbwip.com/wbw/emailencoder.html)）。它不需要启用 JS，并且似乎已经阻止了大部分垃圾邮件。我想一个智能机器人可能仍然会收获它，但我没有遇到任何问题。

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2009-04-14T18:29:38.760

就个人而言，我已经放弃隐藏我的电子邮件地址。我发现寻找更好的垃圾邮件过滤解决方案比担心混淆更容易。您可能会花费数天时间试图找到混淆地址的最佳方法，然后只需一个人将您的地址出售给垃圾邮件发送者，所有这些工作都毫无用处。

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2009-04-14T18:28:32.897

当前接受的解决方案是创建一个允许用户向您发送电子邮件的联系表单。如果您从中收到大量垃圾邮件（我的网站上没有），那么您可以添加一个验证码以防万一，此时您将远离“唾手可得的果实”。

事实是，如果您提供了一个链接，用户可以单击该链接以在“收件人：”字段中使用您的地址弹出打开他们的电子邮件客户端，那么计算机能够从页面中破译电子邮件地址，因此可以垃圾邮件机器人。

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2009-04-15T01:56:02.587

您提到这是针对您的个人网站的。在我的个人网站（例如，bobsomers.com）上，我只有一段这样说：

> 在新网站上线之前与我联系的最佳方式是给我发送电子邮件。我的电子邮件地址是我在这个网站上的名字。如果您无法从该提示中弄清楚，那么您可能会发现电子邮件比找出我的地址更具挑战性。

人们似乎能够很好地解决这个问题，因为我一直收到合法的电子邮件。有时最好的解决方案不需要编写任何代码。:)

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2016-09-13T08:45:06.043

一种混淆`href`锚点的轻量级方法是对其进行 base64 编码：

```
> btoa('mailto:email@example.com')
< "bWFpbHRvOmVtYWlsQGV4YW1wbGUuY29t" 
```

然后将其硬编码：

```
<a href="javascript:window.location.href=atob('bWFpbHRvOmVtYWlsQGV4YW1wbGUuY29t')">E-Mail</a> 
```

或动态服务器端，例如在 PHP 中：

```
<a href="javascript:window.location.href=atob('<?= base64_encode("mailto:email@example.com") ?>')">E-Mail</a> 
```

结合字符串还原，它可以非常节省垃圾邮件：

```
<a href="javascript:window.location.href=atob('<?= base64_encode("mailto:email@example.com") ?>')" style="unicode-bidi: bidi-override; direction: rtl;"><?= strrev("email@example.com") ?></a> 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-04-14T18:34:33.883

显然[使用 CSS 来改变文本的方向](http://techblog.tilllate.com/2008/07/20/ten-methods-to-obfuscate-e-mail-addresses-compared/)效果很好。该链接还测试了许多其他混淆方法。

无论你使用什么，都不可避免地会被打败。您的主要目标应该是避免惹恼您的用户。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2009-04-14T18:26:28.877

不要在这里使用任何混淆技术，因为这可能是电子邮件收割者首先要找出人们如何混淆电子邮件的地方。如果您必须在网站上显示您的电子邮件地址，请不要只是逐字复制其他人的方法；以某种其他网站没有使用过的独特方式对其进行混淆，以便收割者在访问您的网站之前不会知道您的方法。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2014-02-20T11:01:40.057

我的其实很简单：

```
<h3 id="email">hello@gmail.com</h3><!-- add a fake email -->

    $(document).ready(function(){
//my email in reverse :)
            var s = 'moc.elibomajninbew@htiek';
            var e = s.split("").reverse().join("");
            $('#email').html('<a href="mailto:'+e+'">'+e+'</a>');
    }); 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-04-14T18:33:10.250

你可以像谷歌一样在谷歌代码（和组）上做。显示电子邮件的部分内容和可点击部分（“...”）。单击表示您想知道该电子邮件，并要求您填写验证码。之后，您可以看到电子邮件（和其他人？）。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-04-14T22:17:22.693

我维护的一个网站使用一种有点简单的 JavaScript 方法（希望）将垃圾邮件程序拒之门外。

电子邮件链接调用一个 JS 函数：

```
功能发送电子邮件（名称，域）{
    location.href = 'mailto:' + 名称 + '@' + 域；
}

```

为了确保只有启用了 JS 的用户才能看到该链接，请将它们写出来：

```
函数 writeEmailLink(realName, name, domain) {
    document.write('<a href="javascript:sendEmail(\''
      + 名称 + '\', \'' + 域 + '\')">');
    document.write(realName);
    document.write('</a>');
}   

```

使用一个JS函数写出一个调用另一个的链接意味着有两层保护。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-04-14T18:26:47.927

我使用 JavaScript 混淆，例如看一下这个：

[http://www.jottings.com/obfuscator/](http://www.jottings.com/obfuscator/)

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2013-02-22T18:30:54.517

正如上面的海报所说，我还使用了[jottings 网站上](http://www.jottings.com/obfuscator/)的 JavaScript 混淆。

该网页生成一些可以改进的 JavaScript。文本字符串是清晰的`mailto:`并且可以被机器人识别（它可以发现这个并且不混淆这个字符串），但是如果一个人进入 jottings.com 网页，一个表单的电子邮件地址`mailto:addr@site.tld`而不是`addr@site.tld`然后删除文本`mailto:`从生成的 JavaScript 中，突然有一些 JavaScript 看起来似乎与电子邮件一点关系都没有——只是随机的 JavaScript，其中充满了网络。人们可以通过去掉链接文本来进一步改进这一点——我用我的电子邮件地址的图像替换了我的，它的字体相当模糊。然后，以防 jottings.com 上的这种方法变得流行起来，我随机化了输出 JavaScript 中的变量名称，以使机器人难以发现 jottings 生成的 JavaScript 代码的实例。

显然，这些改进中的一些可以内置到笔记本身的机制中，并且由于代码是公开可用的，这将相对容易。

一个例子可能会使这一点更加清楚。我在上面的链接中使用了 Jottings Obfuscator 来隐藏`mailto:foo@bar.com`（注意我通过输入字符串`mailto:foo@bar.com`而不是 来欺骗 jottings 网站的初衷`foo@bar.com`）与文本“Send Me Email”，其中 jottings 变成了这个 Javascript：

```
<script type="text/javascript" language="javascript">
<!--
// Email obfuscator script 2.1 by Tim Williams, University of Arizona
// Random encryption key feature by Andrew Moulden, Site Engineering Ltd
// This code is freeware provided these four comment lines remain intact
// A wizard to generate this code is at http://www.jottings.com/obfuscator/
{ coded = "3A1OTJ:rJJ@VAK.GJ3"
  key = "J0K94NR2SXLupIGqVwt8EZlhznemfaPjs7QvTB6iOyWYo3rAk5FHMdxCg1cDbU"
  shift=coded.length
  link=""
  for (i=0; i<coded.length; i++) {
    if (key.indexOf(coded.charAt(i))==-1) {
      ltr = coded.charAt(i)
      link += (ltr)
    }
    else { 
      ltr = (key.indexOf(coded.charAt(i))-shift+key.length) % key.length
      link += (key.charAt(ltr))
    }
  }
document.write("<a href='mailto:"+link+"'>Send Me Email</a>")
}
//-->
</script><noscript>Sorry, you need Javascript on to email me.</noscript> 
```

取回后，我将其粘贴到编辑器中，然后：

1.  去除那个`mailto:`
2.  用指向我的电子邮件地址图像的指针替换链接文本
3.  重命名所有变量
4.  用另一个指向电子邮件地址图像的链接替换“noscript”部分

我最终得到了这个：

```
<script type="text/javascript" language="javascript">
<!--
// Email obfuscator script 2.1 by Tim Williams, University of Arizona
// Random encryption kkeoy feature by Andrew Moulden, Site Engineering Ltd
// This kudzu is freeware provided these four comment lines remain intact
// A wizard to generate this kudzu is at http://www.jottings.com/obfuscator/
{ kudzu = "3A1OTJ:rJJ@VAK.GJ3"
  kkeoy = "J0K94NR2SXLupIGqVwt8EZlhznemfaPjs7QvTB6iOyWYo3rAk5FHMdxCg1cDbU"
  shift=kudzu.length
  klonk=""
  for (variter=0; variter<kudzu.length; variter++) {
    if (kkeoy.indexOf(kudzu.charAt(variter))==-1) {
      lutu = kudzu.charAt(variter)
      klonk += (lutu)
    }
    else {
      lutu = (kkeoy.indexOf(kudzu.charAt(variter))-shift+kkeoy.length) % kkeoy.length
      klonk += (kkeoy.charAt(lutu))
    }
  }
document.write("<a href='"+klonk+"'><img src='contactaddressimage.png' alt='Send Me Email' border='0' height='62' width='240'></a>")
}
//-->
</script>
<noscript>
    <img src="contactaddressimage.png" border="0" height="62" width="240">
    <font face="Arial" size="3"><br>&nbsp;</font></p>
</noscript> 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-04-14T20:13:10.353

我不知道这有多好。页面完成加载后，您能否不留下您的电子邮件地址并使用 AJAX 调用加载它。不确定垃圾邮件机器人是否可以获取更改后的 HTML，或者它们是否足够聪明以侦听其他 HTTP 流量以尝试选择电子邮件地址，或者它们是否只是在第一次收到页面时扫描页面。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-08-03T19:38:21.730

一个人测试了九种在页面上显示电子邮件地址的不同方式，然后在他的博客上[发布了结果。](http://techblog.tilllate.com/2008/07/20/ten-methods-to-obfuscate-e-mail-addresses-compared/)

他最好的三个方法是：

1.  使用 CSS 更改代码方向
2.  使用 CSS 显示：无
3.  ROT13 加密

警告——这是两年前发布的。垃圾邮件机器人可能变得更聪明了。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-12-23T15:27:59.920

如果您使用 PHP，您可以获取一个自动执行此操作的免费脚本。它被称为“私人爸爸”，我们将其用于我们自己的在线音频流服务。只需一行代码，它就可以开箱即用......你可以[在这里获取](http://www.privatedaddy.com)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-01-28T17:12:37.380

另一种方法是使用 JavaScript 框架并将数据/模型绑定到 HTML 元素。在 AngularJS 的情况下，HTML 元素将被写成：

```
<a href="mailto:{{contactEmail}}"><span>{{contactEmail}}</span></a> 
```

插值 {{data}} 绑定使用包含实际电子邮件值的范围变量。此外，还可以使用过滤器来处理电子邮件的解码，如下所示：

```
<a href="mailto:{{contactEmail | decode}}"><span>{{contactEmail | decode}}</span></a> 
```

好处在于 HTML 的编写方式。缺点是它需要脚本支持，有些人可能会拒绝。

只是另一种方法。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-01-10T01:41:37.617

使用 JQuery，但如果需要，可以很容易地移植到纯 JS。将采用以下 HTML 块。我提供的这个例子也适用`tel:`于电话链接。

```
<a class="obfuscate" 
 href="mailto:archie...trajano...net">
 archie...trajano...net
</a>
<a class="obfuscate"
 href="tel:+One FourOneSix-EightFiveSix-SixSixFiveFive">
 FourOneSix-EightFiveSix-SixSixFiveFive
</a> 
```

并使用 Javascript 将其转换为正确的链接。

```
$(".obfuscate").each(function () {

$(this).html($(this).html()
.replace("...", "@").replace(/\.\.\./g, ".")
.replace(/One/g, "1")
.replace(/Two/g, "2")
.replace(/三/g, "3")
.replace(/四/g, "4")
.replace(/五/g, "5")
.replace(/六/g, "6")
.replace(/七/g, "7")
.replace(/八/g, "8")
.replace(/9/g, "9")
.replace(/Zero/g, "0"))

$(this).attr("href", $(this).attr("href")
.replace("...", "@").replace(/\.\.\./g, ".")
.replace(/One/g, "1")
.replace(/Two/g, "2")
.replace(/三/g, "3")
.replace(/四/g, "4")
.replace(/五/g, "5")
.replace(/六/g, "6")
.replace(/七/g, "7")
.replace(/八/g, "8")
.replace(/9/g, "9")
.replace(/Zero/g, "0"))

})

```

我在这里更详细地记录了它[https://trajano.net/2017/01/obfuscating-mailto-links/](https://trajano.net/2017/01/obfuscating-mailto-links/)

de/obfuscation 算法非常简单，所以写起来也不会太费力（不需要 base64 解析）

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-09-11T20:28:17.140

## Ajax 调用解决方案

最好是在网站上有一个表格，不要显示电子邮件地址，因为所有机器人日复一日地变得更加智能，但是如果您需要在网站上显示电子邮件地址，那么您可以通过ajax调用在您的服务器，并在点击时显示。

**HTML**

```
<a class="obfmail" href="#" rel="info">click here to show email address</a> 
```

或者

```
<a class="obfmail" href="#" rel="info">
    <img src="img/click-to-show-email.jpg">
</a> 
```

**jQuery**

```
$(document).one'click', '.obfmail', function(e) {
    e.preventDefault();
    a = $(this);
    addr = a.attr('rel');
    $.ajax({
        data: { 
            email: addr
        },
        url : "/a/getemail",
        type: "POST",
        dataType: 'json',
        success: function(data) {
            a.html(data.addr);
            a.attr('href', 'mailto:' + data.addr);
        }
    });
}); 
```

**PHP**

```
if($_POST['email']) {
    ...
    return json_encode(array(
        code     => '200',
        response => 'success',
        addr     => 'info@domain.ltd'
    ));
} 
```

为了提高安全性，您可以像这样进行更改`.on`，甚至可以使用您在 ajax 调用中传递给数据的 PHP 生成的令牌，以仅接受一次 ajax 函数调用，如下所示：`.one``$(document).one('click', '.obfmail', function(e) {`

html:`<a class="obfmail" href="#" rel="info" token="w3487ghdr6rc">`

jQuery：

```
...
addr = a.attr('rel');
tkn  = a.attr('token');
$.ajax({
    data: { 
        email: addr,
        token: tkn
    }, ... 
```

.

> 也可以对返回的电子邮件地址进行编码或反转它。

.

> 电话号码也能正常工作！

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-01-28T08:18:31.460

Cloudflare 现在提供免费的[电子邮件混淆服务](https://support.cloudflare.com/hc/en-us/articles/200170016-What-is-Email-Address-Obfuscation-)。如果您使用 Cloudlfare，这可能是一个选项。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-04-14T18:30:56.200

老实说，如果您询问 mailto 是否真的是您想要使用的东西，您的问题可能没有实际意义。例如，许多使用 Web 邮件或在浏览器中没有正确设置邮件客户端的人不会从 mailto 中受益。您正在公开您的电子邮件地址以获取对大部分用户不起作用的功能。

您可以做的是使用表单在幕后发送电子邮件，以便隐藏电子邮件地址，您不必担心不会从 mailto 中受益的可怜的 sap。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-12-23T15:30:36.203

如果您在您的网站上说“我的电子邮件地址是（我的名字）@（我的姓氏）.com。”，并且您的名字和姓氏非常明显，这似乎是最好的垃圾邮件防护你会得到的。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2014-05-24T15:17:57.900

如果有人在使用 Rails，他们可以使用`actionview-encoded_mail_to`gem。( [https://github.com/reed/actionview-encoded_mail_to](https://github.com/reed/actionview-encoded_mail_to) )

有几个选项：

> :encode - 此键将接受字符串“javascript”或“hex”。传递“javascript”将动态创建并编码 mailto 链接，然后将其评估到页面的 DOM 中。如果用户禁用了 JavaScript，此方法将不会在页面上显示链接。传递“十六进制”将在输出 mailto 链接之前对 email_address 进行十六进制编码。
> 
> :replace_at - 如果未提供链接名称，则使用 email_address 作为链接标签。您可以使用此选项来混淆 email_address，方法是将 @ 符号替换为作为值给出的字符串。
> 
> :replace_dot - 如果未提供链接名称，则使用 email_address 作为链接标签。您可以使用此选项通过替换 . 在电子邮件中将字符串作为值。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-09-10T05:34:39.830

```
<!-- Multi-Email Obfuscator  -->
<!-- step 1: &#064; = @  -->
<!-- step 2: a scrap element  -->
<!-- step 3: ROT13 encode for .com  -->
info<!-- step 1 -->&#064;<!-- step 2 --><b style="display:none">my</b>domain<!-- step 3 --><script>document.write(".pbz".replace(/[a-zA-Z]/g,function(c){return String.fromCharCode((c<="Z"?90:122)>=(c=c.charCodeAt(0)+13)?c:c-26);}));</script> 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-07-04T15:30:03.583

由于没有在任何地方提及此解决方案，但对我来说效果很好：

我这样做：

*   使用虚假电子邮件创建一个 mailto 链接。我喜欢 admin@localhost.localdomain 的原因很明显：垃圾邮件发送者在未经检查使用此地址时可能会向他自己的僵尸网络发送垃圾邮件。

*   密码真实的电子邮件地址，并将其放在不相关但可找到的隐藏跨度或您喜欢的任何元素中。显然是为了混淆电子邮件并将其隐藏在收割机之外。根据您的项目结构，您甚至可能希望将其放入 JS 或 Session 变量中。

*   在一秒钟后为这些链接创建一个点击处理程序，该处理程序会解密并将正确的电子邮件地址写入虚假的 mailto 链接，而不是阻止默认值。我不认为爬虫点击 mailto 链接，但如果他们愿意，他们可能不会等待一秒钟，而人类必须非常快才能在页面加载后的第一秒内点击链接。

现在您有了一个功能齐全但经过混淆、蜜罐和时间安全的 mailto 链接。

工作示例 php 文件：

```
<html>
<head>
<title>E-Mail Obfuscating</title>
</head>
<body>
<?php
$email = "example@email.org";
echo "<a class='emailLink' href='mailto:admin@localhost.localdomain' >Send me an e-mail!</a>"
    ."<span style='display:none' data-hash='" . base64_encode($email) . "' />";
?>
<script>
<!--
var emailLinks = document.getElementsByClassName("emailLink");
setTimeout(function() {
    for(var i=0; i <emailLinks.length; ++i){
        emailLinks[i].addEventListener("click", function(){
            let encodedEmail = this.nextSibling.getAttribute('data-hash');
            let decodedEmail = atob(encodedEmail);
            this.href = "mailto:" + decodedEmail;
            this.text = decodedEmail;
        });
    }
}, 1000);

-->
</script>
</body>
</html> 
```

愿代码与你同在。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-09-24T15:46:22.107

如果创建指向受密码保护的目录的“联系我”链接怎么办？当然，您必须提供通行证才能访问。

“联系我” > ••••••••••• > 联系人/index.html

访问后，contact/index.html 页面会显示电子邮件，例如 mailto。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2020-10-19T02:41:40.917

我的解决方案是使用 css 重新排列字符并在悬停时替换元素。用户看不到任何变化。

```
const obscureHoverReverseMailTo = input => `<span style="display: inline-flex; color: rgb(0, 0, 238); cursor: pointer; text-decoration: underline;" onmouseover="const newContent = [...this.children].sort((a, b) => a.style.order - b.style.order).map(el => el.innerText).join('');this.outerHTML = \`<a href='mailto: \${newContent}'>\${newContent}</a>\`">${input.split("").map((char, index) => `<span style="order: ${index}">${char}</span>`).sort(() => 0.5 - Math.random()).join("")}</span>`; 
```

```
const obscureHoverReverseMailTo = input => `<span style="display: inline-flex; color: rgb(0, 0, 238); cursor: pointer; text-decoration: underline;" onmouseover="const newContent = [...this.children].sort((a, b) => a.style.order - b.style.order).map(el => el.innerText).join('');this.outerHTML = \`<a href='mailto: \${newContent}'>\${newContent}</a>\`">${input.split("").map((char, index) => `<span style="order: ${index}">${char}</span>`).sort(() => 0.5 - Math.random()).join("")}</span>`;

document.getElementById("testRoot").innerHTML = obscureHoverReverseMailTo("hello@example.com")
```

```
<div id="testRoot"></div>

<input type="text" onkeyup="document.getElementById('testOut').innerHTML = obscureHoverReverseMailTo(this.value)">
<div id="testOut"></div>
```

如果您还有其他要隐藏的内容，这是该功能：

```
const obscureHoverReverse = input => `<span style="display: inline-flex" onmouseover="this.outerHTML = [...this.children].sort((a, b) => a.style.order - b.style.order).map(el => el.innerText).join('')">${input.split("").map((char, index) => `<span style="order: ${index}">${char}</span>`).sort(() => 0.5 - Math.random()).join("")}</span>`; 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2020-10-29T19:06:38.717

我同意@srobinson 的观点，因为使用在线表单对 html 实体进行编码似乎有点可疑。几行python将为您完成：

```
def htmlEntities( string ):
    return ''.join(['&#{0};'.format(ord(char)) for char in string])

htmlEntities("barnstable@example.com") 
```

以上返回：

```
'&#98;&#97;&#114;&#110;&#115;&#116;&#97;&#98;&#108;&#101;&#64;&#101;&#120;&#97;&#109;&#112;&#108;&#101;&#46;&#99;&#111;&#109;' 
```

这是 barnstable@example.com 编码为 HTML 实体（用单引号括起来）。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-01-03T23:27:24.533

简单的 JavaScript 无感知机器人通常会查找`mailto:`和/或`@`在 HTML 页面内容中。混淆这些关键字将大大减少电子邮件地址抓取的机会。

可以使用Base-64 编码的 URL 模板`mailto:%user%@%domain%`：

```
function contact(user, domain = location.hostname) {
  const template = atob('bWFpbHRvOiV1c2VyJUAlZG9tYWluJQ==');
  location.href = template
    .replace('%user%', user)
    .replace('%domain%', domain);
  return false;
} 
```

`'bWFpbHRvOiV1c2VyJUAlZG9tYWluJQ=='`在哪里`btoa('mailto:%user%@%domain%')`。

HTML 链接需要更新如下：

```
<a href="javascript: contact('x', 'y.com')">e-mail me</a> 
```

此外，`javascript:`地址可以对用户隐藏：

```
<a href="#" onclick="return contact('x', 'y.com')">e-mail me</a> 
```

这些`return`语句阻止页面导航到`#`锚点。

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2010-11-26T18:00:19.007

我使用[PHP 函数](http://snipplr.com/view/10947/secure-email-link/)生成一些 javascript 以在页面加载时输出电子邮件。请注意，运行时*不需要*PHP 生成 JS，您可以在本地生成一次 JS，然后将静态 JS 包含在您的页面中。

您还可以使用下面这段代码片段的链接函数来自动混淆某些给定 HTML 中的电子邮件地址（其中 $processedContent 是 HTML）：

```
 $emailMatches = array();
 $matchCount = preg_match_all('/(?:[a-zA-Z0-9_\.\-])+\@(?:(?:[a-zA-Z0-9\-])+\.)+(?:[a-zA-Z0-9]{2,4})+/', $processedContent, $emailMatches);

 if($matchCount > 0) {
    $emailMatches = $emailMatches[0];

    foreach($emailMatches as $email) {
    $replacement = createJSMailLink($email);

    $processedContent = str_replace($email, createJSMailLink($email), $processedContent);
 } 
```

* * *

## 回答 #30

> 赞同：-2
> 
> 时间：2010-03-03T10:41:25.960

看看[这个](http://hivelogic.com/enkoder)。

“Enkoder 表单”将加密您的电子邮件地址并将结果转换为自我评估的 JavaScript，将其隐藏在爬网寻找暴露地址的电子邮件收集机器人之外。网络浏览器将正确显示您的地址，但电子邮件收集机器人几乎无法辨认。

# java - Google App Engine 背后的逻辑（如果有），不包括标准 JDK 1.6 API

> ID：748788
> 
> 赞同：3
> 
> 时间：2009-04-14T18:26:03.247
> 
> 标签：java, google-app-engine, jdk1.6, stax

看起来 GAE 选择了 JDK 1.6 类的一个子集，如下所示：

[Google App Engine JDK 白名单](http://code.google.com/appengine/docs/java/jrewhitelist.html)

这是非常不幸的，因为处理数据绑定、反射、类加载和注释的最常见的 Java 库到处都有类链接错误。尽管有些遗漏可能是针对已弃用或遗留的东西，但也有其他遗漏。我特别关心的是流式拉解析器 (javax.xml.stream.*)，它在长时间延迟后才添加到 JDK 1.6（API 与 JDK 1.4 大约同时完成）。忽略这一点会使进行可扩展的高性能 xml 处理变得更加困难。

据我了解，问题不仅是缺少类，而且由于安全限制，它们甚至无法添加。

所以：这是一个开放式的哲学问题，可能只有 GAE 开发人员可以肯定地回答，但是......为什么有些 API 从标准 JDK 1.6 中删除，似乎是武断的？

**更新**：

快速说明：感谢您的回答。对于它的价值，我真的看不出安全性与不包括 javax.xml.stream 有什么关系。安全方面与许多其他事情相关（例如，我不需要线程，并且可以看到它们为什么会出现），所以这是可以理解的样板答案；只是不适用于这个。

Stax API 只是一组用于大声喊叫的接口和抽象。但更重要的是，它具有与包括 SAX、DOM 和 JAXP 接口完全相同的分支——这些接口已经包含在内！

但看起来这个问题已经引起了谷歌开发者的注意：

[关于将 Stax API 列入白名单的讨论](http://groups.google.com/groups/profile?enc_user=avBN6RgAAAC56AMLouLnCybHXs-kWCD5tiDKbEn1fjJfYkQTWXi1Vg)

所以这里希望这个和类似的问题可以迅速得到解决。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-14T18:37:40.443

GAE 在托管环境中运行，其中包含不受信任的（并且可能是恶意的）客户端，这些客户端通常可以免费访问。

在这种类型的环境中，安全性是一个非常重要的问题，具有文件系统访问权限的 API 会受到非常严格的审查。我认为这就是为什么他们选择在他们允许的范围内相当保守地开始。

不过，如果随着安全问题得到解决（并根据需求），如果更多的课程进入白名单，我一点也不感到惊讶。

但我什至不希望获得可用的线程工具，例如。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T18:37:19.180

这些东西是随意丢弃的，非常值得怀疑。GAE 运行在对安全极为敏感的环境中，对类库的内部审计很可能会发现 Google 不愿意承担的一些风险。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T05:19:46.110

至于您的高性能流式 XML 解析器，您可以尝试找到合适的库（jar 文件）。除非它依赖于线程或文件访问（或列入黑名单的 API），否则它应该与 JDK 中的一样工作。

有很多（相当复杂的）[库可以在 GAE 上运行](http://groups.google.com/group/google-appengine-java/web/will-it-play-in-app-engine)。

# asp.net - asp.net(c#) 创建 Excel 工作表，我需要在服务器上安装 Excel 吗？

> ID：748792
> 
> 赞同：2
> 
> 时间：2009-04-14T18:27:01.513
> 
> 标签：asp.net, excel

我创建了一个使用 Microsoft.Office.Interop.Excel 的应用程序，在我的本地和测试环境中一切正常，但该应用程序在生产环境中不起作用。

原来我在本地安装了 Office，测试服务器也是如此，但是，生产服务器没有安装 Excel。

我真的不能回去更改我的代码，但是，我真的不想在生产服务器上安装 Excel。

除了在生产服务器上安装 Office Excel 以使应用程序运行之外，我还有其他选择吗？

谢谢，感谢您的帮助。史蒂文

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T18:30:46.200

Office Interop*确实*需要在服务器上安装 Office。

在更一般的情况下，您*不需要*Excel 来创建工作表，**您应该避免使用任何需要它用于 Web 的解决方案**。这包括办公室互操作：它不能在 Web 环境中扩展。

有关更多选项，请参阅此问题：
[在 ASP.NET 中生成 Excel 文件](https://stackoverflow.com/questions/150339/generating-an-excel-file-in-asp-net)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-04T09:29:21.717

您是否尝试为 .NET 找到一些免费的 Excel 组件。例如，这两个组件都有用于创建 excel 文件的免费版本：

*   [gembox excel component](http://gemdoxsoftware.com) (xlsx and xls files up to 150 rows)
*   [excel jetcell net component](http://www.devtriogroup.com/ExcelJetcell/Default.aspx) (without restriction writes text to excel files xls and xlsx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T18:33:20.920

Excel 互操作库通过在后台打开 Excel 应用程序来处理电子表格来工作。因此，在不更新代码的情况下，您需要在服务器上安装 Excel。但是，对于从 ASP.NET 使用 Excel 而言，使用互操作是一种非常缓慢且容易出错的解决方案，Joel 提供的链接提供了几个不错的选择。

# ide - 在 Flash CS4 IDE 中访问舞台

> ID：748793
> 
> 赞同：5
> 
> 时间：2009-04-14T18:27:12.620
> 
> 标签：ide, flash, flash-cs4, stage

Flash CS4 创作环境中的阶段是一个正在运行的 SWF。这就是让 3D 和骨骼工具在 IDE 中工作的原因。

是否可以访问该 swf ？我怀疑直接的答案是否定的，因为这可能会引发一些安全问题，并导致许多开发人员每 5 分钟崩溃一次 IDE :)。

也就是说，我不希望这是一个直接的过程，但我想应该有一种方法可以访问它。

有什么想法吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T00:51:16.483

我只能告诉你组件在舞台上是如何工作的，我们已经尝试过你所说的访问类型。

我怀疑在它们的核心，3d 和骨骼工具是使用类似组件的技术来实现的，以显示“实时”舞台实例。通常，这将涉及放置在舞台上的实时预览 swf 的编译实例。将舞台视为单个玩家是误导性的。每个组件预览都在自己的沙箱中运行，据我所知，它无法与 IDE 舞台上的其他组件预览进行通信。没有共同的存储位置。

当然，如果你负责预览 swf（和组件的情况一样），你可以尝试 LocalConnection 聊天，但是你要穿透的预览是关闭的。我怀疑如果你足够努力，你会发现隐藏在安装文件夹中的 bone/3d 预览（也许在 swc 中 .. **ik.swc**看起来很有趣）并且可能能够用反编译器破解它，但直截了当开箱即用，我不确定您的要求是否有解决方案。

# mysql - 收集数据然后将数据导入drupal的最佳方式？

> ID：748807
> 
> 赞同：2
> 
> 时间：2009-04-14T18:29:44.923
> 
> 标签：mysql, database, excel, drupal, web

我正在使用 Drupal 构建我的第一个数据库驱动网站，我有几个问题。

1.  我目前正在使用我希望最终能够从网站查询的所有数据（在导入之后）填充一个 google docs excel 电子表格。这是最好的开始方式吗？

2.  如果这不是开始的最佳方式，您会推荐什么？

3.  我的计划是填充电子表格，然后通过 CCK 节点将其作为 csv 导入 mysql 数据库。

我已经看到了两种方法来做到这一点。

[http://drupal.org/node/133705](http://drupal.org/node/133705)（将数据导入CCK节点）

[http://drupal.org/node/237574](http://drupal.org/node/237574)（使用电子表格/csv 代替 SQL 插入语句插入数据）

基本上我的问题是最好的收集方式是什么，然后将数据导入drupal？

提前感谢您的任何帮助，建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-16T14:54:30.033

[在http://groups.drupal.org/node/21338](http://groups.drupal.org/node/21338)有可用模块的比较

过去，当我这样做时，我只是编写代码来在 cron 运行时执行此操作（请参阅[http://drupal.org/project/phorum](http://drupal.org/project/phorum)以获取示例框架，您可以剥离并构建备份以执行您需要的操作）。

如果我现在要这样做，我可能会使用[http://drupal.org/project/migrate](http://drupal.org/project/migrate)模块，其中的理念是“将其导入 MySQL，查看数据，通过 GUI 导入”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-16T21:59:41.357

有一个非常好的模块，节点导入。它允许您获取 GoogleDocs 电子表格并将其作为 .csv 文件导入。

它非常易于使用，该模块允许您将 .csv 列映射到您希望它们转到的节点字段，因此您不必担心按特定顺序设置列。此外，如果某些记录有错误，它会吐出一个带有错误文件的 .csv 文件以及导致错误的原因，但会导入所有好的记录。

我用这种方法最多导入了 3000 个节点。

# apache - 使用 ProxyPassMatch 重定向 aspx 请求时缺少图像

> ID：748813
> 
> 赞同：0
> 
> 时间：2009-04-14T18:30:38.213
> 
> 标签：apache, iis

```
<VirtualHost *:80>
ServerName mine.abc.def.edu
ProxyPassMatch ^(/.*\.aspx.*) http://mine.abc.def.edu:8080/$1
</VirtualHost> 
```

我在端口 8080 上运行 IIS，在端口 80 上运行 Apache。我在 apache 配置中获得了上述内容，以成功将 ASP.NET 页面重定向到 IIS，但页面上的图像丢失了。我在想我需要某种反向代理规则，上面写着“如果对图像或其他资源的请求来自 aspx 页面，则添加端口 8080”，但我不确定如何实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T18:46:38.783

可以为 IIS 服务器使用不同的虚拟主机名或子目录吗？这样你就可以在你的 mod_proxy 设置中匹配主机头。

# sql-server - 是否有任何机制可以从 Visual Studio 2008 连接到 sql server 7？

> ID：748817
> 
> 赞同：0
> 
> 时间：2009-04-14T18:31:49.380
> 
> 标签：sql-server, visual-studio-2008, sql-server-7

我们目前正在将基于 SQL Server 7 的数据库迁移到 SQL Server 2000（是的进展）但是同时我们必须支持我们的 SQL Server 7 数据库产品。我们目前可以访问 Visual Studio 2008，而且我知道不存在对连接到 SQL Server 7 的本机支持。有谁知道任何第三方解决方案可以让我使用 Visual Studio 2008 和 SQL Server 7 进行开发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T18:36:16.670

您应该能够使用 System.Data.SqlClient 命名空间中的类连接到 SQL Server 7 或更高版本的实例。

# c# - 如何在 WinXP 中使用 IIS 5.1 发送邮件？

> ID：748819
> 
> 赞同：1
> 
> 时间：2009-04-14T18:32:30.533
> 
> 标签：c#, asp.net, asp.net-mvc, iis, email

我有这个代码来发送邮件：

```
public bool SendMail(MailMessage message)
{
    message.From = new MailAddress(AppProperties.FromMailAddress, AppProperties.FromDisplayName);
    SmtpClient smtp = new SmtpClient { EnableSsl = AppProperties.EnableSsl };
    try
    {
        smtp.Send(message);
        return true;
    }
    catch (Exception)
    {
        return false;
    }
} 
```

并已将 web.config 配置为使用 localhost 中的 IIS 5.1 发送邮件（如答案所示）：

```
 <system.net>
    <mailSettings>
      <smtp deliveryMethod="Network">
        <network host="localhost"
                 userName=""
                 password=""
                 defaultCredentials="false"
                 port="25" />
      </smtp>
    </mailSettings>
  </system.net> 
```

在 Windows XP 中使用 IIS 5.1 发送邮件需要做什么？有可能做到吗？正如你所说，我想是的，因为我没有得到任何例外，但我没有在目的地收到它。如果我应该输入用户名和密码，那必须是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T14:50:02.613

您应该首先安装 SMTP 服务器（Windows 组件 > IIS > SMTP 服务），然后将其配置为启用中继。

> IIS > 默认 SMTP 服务器 > 属性访问 > 身份验证
> 
> 访问控制 > 匿名访问 - 选中
> 
> 中继限制 > 中继 > 选择 - 仅以下列表 > 添加 > 127.0.0.1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T18:42:17.577

当然有可能，但是您将不再需要使用 SSL。在配置文件中，您的端口可能是 25，您可能需要也可能不需要用户名/密码，当然您的主机名也会改变。

还要确保将 SMTP 组件与 IIS 一起安装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T18:47:24.133

是的，您可以这样发送：D（但我认为您需要使用端口 25） smtp 类是 .net 的一部分

# c# - 消息框导致失去焦点

> ID：748826
> 
> 赞同：1
> 
> 时间：2009-04-14T18:34:07.363
> 
> 标签：c#, .net

我创建了一个包含三个控件的工具栏。第一个是文本框、确定按钮和清除按钮。本质上，我使用这个工具栏来搜索一些文本。当没有找到结果时，我会弹出一个消息框通知用户没有找到结果。但是当用户单击消息框的“确定”按钮时，文本框失去焦点，焦点传递到下一个控件，即“确定”按钮。我应该怎么做才能避免文本框失去焦点。我正在使用 c#。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T18:38:05.323

你不能。单击“确定”按钮强制它具有控制权（因此文本框失去控制）。

但是，您可以在点击事件上执行此操作：

```
MessageBox.Show("asdf");
textBox1.Focus(); 
```

**编辑**

作为对您的评论的回应，我认为一旦另一个控件获得焦点，就没有一种简单的方法可以将焦点返回到最后一个控件，并且单击时搜索和清除按钮必须获得焦点。你可以这样做：

```
private Control _last;

private void textBox1_Leave(object sender, EventArgs e)
{
    _last = (Control) sender;
}

private void button1_Click(object sender, EventArgs e)
{
    MessageBox.Show("asdf");
    _last.Focus();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T18:38:15.840

你的问题不是很清楚，但你可以让你的控制成为这样的焦点：

```
textBox1.Focus(); 
```

# http - 如何使用表单创建 HTTP GET 请求

> ID：748829
> 
> 赞同：0
> 
> 时间：2009-04-14T18:34:51.587
> 
> 标签：http

如何在没有表单的情况下发送 HTTP GET 请求？此请求在网页上执行。

有关我要完成的工作以及原因的更多详细信息，请在此处查看我的问题：[http get/post request and google geolocation api](https://stackoverflow.com/questions/745217/http-get-post-request-and-google-geolocation-api)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-14T18:36:57.277

任何链接都是一个 GET 请求，所以，只需创建一个链接，在末尾添加额外的信息，就完成了。

[http://someurl.net/somelink?value1=avalue&value2=anothervalue](http://someurl.net/somelink?value1=avalue&value2=anothervalue)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T18:38:18.070

当用户点击一个普通的超链接时，它会发出一个 GET 请求。加载图像也是一个 GET 请求，就像在页面中嵌入内容的大多数其他方式一样。如果您尝试通过 JavaScript 执行此操作，则可以使用 XMLHttpRequest。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T18:36:39.790

您可以使用 Ajax 和 jQuery 的[get](http://docs.jquery.com/Ajax/jQuery.get)方法：

```
$.get("someURL.php?variables=true"); 
```

请注意，您只能向同一域发出请求，或者目标域必须返回[JSON 格式的结果](http://docs.jquery.com/Ajax/jQuery.getJSON#urldatacallback)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T18:37:42.877

在纯 HTML 中，您可以这样做，例如请求图像：

```
<img src="http://example.com/?bla=bla"> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T18:39:48.347

```
< a href="www.google.com">google</a> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T19:08:24.143

我同意 altCognito 指出使用 jquery 但我宁愿使用

```
$.get("someurl.php", { variable: value }); 
```

我更喜欢这种方式，因为它允许我发送对象而不是连接字符串。[你可以在这里](http://docs.jquery.com/Ajax/jQuery.get#urldatacallbacktype)看到几个样本

# ruby - Merb & DataMapper - 访问数据库连接信息？

> ID：748831
> 
> 赞同：0
> 
> 时间：2009-04-14T18:36:26.263
> 
> 标签：ruby, database, datamapper, merb

我将 Merb 和 DataMapper 与 MySQL 数据库一起使用。我想从我的 Merb 应用程序的 Rake 任务中访问数据库名称、用户和密码。我想我可以`YAML.load()`使用 database.yml，但这看起来很难看。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T19:05:58.440

```
desc "outputs database connection parameters"
task :db_conn => :merb_env do |t|
  puts "Username: #{DataMapper.repository.adapter.uri.user}"
  puts "Password: #{DataMapper.repository.adapter.uri.password}"
  puts "Database: #{DataMapper.repository.adapter.uri.path.split('/').last}"
end 
```

有趣的部分是`=> :merb_env`位。这可确保“merb_env”任务在您的任务执行之前执行。这只是加载了 Merb 环境，此时您可以继续检查其配置。

# javascript - 如何使用 jquery 获取所有元素父级？

> ID：748842
> 
> 赞同：10
> 
> 时间：2009-04-14T18:37:52.860
> 
> 标签：javascript, jquery, html, dom

如何使用 jquery 获取所有元素父级？我想将这些父母保存在一个变量中，以便以后可以用作选择器。
例如`<div><a><img id="myImg"/></a></div>`
GetParents('myImg'); 将返回“div a”类似的东西

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-14T18:42:58.213

/// 获取所有父元素的数组：

```
allParents = $("#myElement").parents("*") 
```

/// 通过元素的父元素获取嵌套选择器：

```
function GetParents(id) {
    var parents = $("#" + id).parents("*");
    var selector = "";
    for (var i = parents.length-1; i >= 0; i--) {
        selector += parents[i].tagName + " ";
    }

    selector += "#" + id;

    return selector;
} 
```

GetParents('myImage') 将返回您的嵌套选择器： HTML BODY DIV A #myImage

## 请注意为什么你想要这个，但它可以作为选择器重用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-14T18:54:24.753

您不需要抓取它们的选择器，因为之后您可以直接将它们与 jQuery 一起使用。

如果您想稍后使用所有父母，您可以执行以下操作：

```
var parents = $("#element").parents();
for(var i = 0; i < parents.length; i++){
  $(parents[i]).dosomething();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-14T18:40:06.863

每个元素只有一个真正的父元素。要访问并保存它，请编写以下内容：

```
myParent = $("#myElement").parent(); 
```

如果您也需要父母父母，请使用 .parents()

有关详细信息，请参阅文档：

[http://docs.jquery.com/Traversing/parent#expr](http://docs.jquery.com/Traversing/parent#expr)

[http://docs.jquery.com/Traversing/parents#expr](http://docs.jquery.com/Traversing/parents#expr)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T18:46:53.930

您可以使用 parents() 让您的直系父母和他们的父母在树上。您还可以将选择器作为 arg 传递，以仅获取符合特定条件的父母。例如：

```
$('#myelement').parents('[id$=container]')
```

获取所有具有 id 属性的父母，其值以文本“容器”结尾

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-08T07:41:24.043

您可以像这样获取元素父母的所有标签：

```
var sParents = $('#myImg').parents('*').map(function() {                
      return this.tagName;
    }).get().join(' '); 
```

您还可以将*this.tagName*替换为*this.id*例如或其他属性

# math - 离散结构和离散数学之间的区别

> ID：748844
> 
> 赞同：12
> 
> 时间：2009-04-14T18:38:10.393
> 
> 标签：math, computer-science, discrete-mathematics

我还没有找到好的答案。或任何答案，就此而言。我被要求为 CS 课程教授离散结构，但同时确保它不是离散数学课程——这是由数学系提供的。

许多大学提供离散结构课程。还有很多DS教科书。但是当我查看课程大纲和教科书介绍时，从未使用过“离散结构”一词；他们改用“离散数学”。DS 仅出现在课程/教科书的标题中。

例子：

[ODU 的 CS 381](http://www.cs.odu.edu/~toida/nerzic/content/intro2discrete/intro2discrete.html)

[维基百科上的离散结构条目](http://en.wikipedia.org/wiki/Discrete_structures)

什么是离散结构，它与离散数学有何不同？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-14T18:54:59.997

我清楚地记得我们的教科书上说：

```
Discrete structures are structures that are used in describing discrete mathematics.

Discrete mathematics is math that makes use of discrete structures. 
```

实际上，离散数学就是这样，数学处理离散值。离散结构有点像离散数学的结构，但也处理主题。然而，这两者作为课程名称，描述的是同一件事。

这些术语可以互换使用并且非常模糊，以至于询问您的人可能没有意识到他们在问什么。我认为您不会找到任何可以为您提供明确答案的资源，但您可能想要做的是教授离散数学，重点是 CS 视角。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-14T18:45:57.863

我有[http://www.amazon.com/Discrete-Computational-Structures-Computer-Mathematics/dp/0124208509](https://rads.stackoverflow.com/amzn/click/com/0124208509)这似乎是他们想要的。

第 1 章说“这是一本关于结构的书”。

> 总是，由于我们对数字计算感兴趣，我们的结构将是离散的。

我想你可以把头发分开说“看，这只是离散数学的升温。” 虽然这可能是真的，但我认为这只是一个焦点问题。

当重点放在数字计算上时，它就变成了离散结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T18:59:07.973

我认为你的问题有两个部分：1）这些人到底想让我教什么？2）离散结构与离散数学有何不同？

我对#1 的最佳猜测是，你被要求教授基本数据结构/算法课程，在大多数本科 CS 课程中，这些课程都是在编程入门之后进行的。

至于＃2，我猜真的没有区别。它们听起来当然是一样的。但是，虽然“数学”倾向于理论，但对我来说，“结构”这个词意味着实际应用和工程。这让我怀疑这是你的基本数据结构/算法课程。Big-O，红黑树之类的。

但实际上，您可能希望将您的问题直接提交给雇用您的 CS 部门。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-09T14:42:45.990

1.  线性数学以连续方式处理数据，而离散数学以非连续方式处理数据。例如：线性：电流流动。离散：图上的二进制数作为 0 和 1 表示不是连续形式。
2.  章节：
3.  线性数学：矩阵、线性方程求和等。它处理矢量、线和平面。
4.  离散数学：概率、图形、集合等

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-04-27T20:01:35.620

我认为在离散数学中。我们教离散数学。基础知识，并从软件结构世界中获取少量示例。在离散结构中，我们研究软件结构（或由软件生成的结构），因此每个离散结构之前都有几节课，例如来自世界离散数学的讲座。需要理解这个结构。换句话说：我们在应用程序中强调离散结构，而在离散数学中。我们强调数学理论。

# ms-access - 如何在 VBA 中执行文字？

> ID：748847
> 
> 赞同：1
> 
> 时间：2009-04-14T18:38:20.283
> 
> 标签：ms-access, vba

有没有办法执行文字，例如，

```
 UseValueKey = ExecuteMethod("Date()") 
```

我想让变量 UseValueKey 返回实际日期。

我正在使用 VBA。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T18:43:04.063

几年来我没有做过任何 VBA 编码，但我记得 Access VBA 有一个 Eval() 方法，可用于评估表示为字符串的代码。

本文[给出](http://bytes.com/topic/visual-basic/answers/767159-using-eval-function-treat-string-vba-statement)了它的用法示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T18:44:15.077

您可以尝试[Eval](http://msdn.microsoft.com/en-us/library/aa172212(office.11).aspx)功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T09:00:19.557

如果如问题注释中所示，函数名称是已知的并且可以作为类的方法传递，请尝试查看

```
CallByName object, routine, callType 
```

其中 callType 指示被调用的例程是属性 Get/Let/Set 还是 Method。

与愚弄代码评估相比，它感觉不那么笨拙（并且控制得更好），在这种情况下，您可能会让自己敞开心扉，呃，*意想不到的*后果......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T19:06:06.800

也许我没有完全关注你，但你应该能够使用

```
Date 
```

例如

```
UseValueKey = date 
```

# c# - 如果使用 RMO，我应该使用推送订阅还是拉取订阅？

> ID：748848
> 
> 赞同：0
> 
> 时间：2009-04-14T18:38:48.600
> 
> 标签：c#, .net, sql-server, replication

我有一个 CRUD winform 应用程序，它使用合并复制来允许“断开连接”功能。我的问题是；如果我以编程方式使用 RMO（如[HERE](http://msdn.microsoft.com/en-us/library/ms146910(SQL.90).aspx)）进行所有初始化和同步，它是推还是拉有关系吗？

会有什么不同？

我了解两者之间的差异（请参阅[此处](http://msdn.microsoft.com/en-us/library/ms151170.aspx)），但似乎如果我仅通过 RMO 进行交互，差异会变得有些模糊。如果可以的话，即使合并复制偏爱Pull，我也想使用Push来使服务器首当其冲并且更易于管理。

此外，由于我们的环境，我不需要“实时”更新。无论哪种情况，同步都会从 UI 事件中触发。

有人对这个有经验么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T02:25:11.020

我们通过 RMO 在 20 多个偶尔连接的客户端系统上使用合并复制。据我所知，您应该选择拉订阅。我不知道您是否可以使其与推送订阅一起使用，但我不建议尝试。正如您所说，客户端系统将请求同步，这符合拉取订阅的定义。

您的第二个链接中的“使用时间”部分在这种情况下的推送建议中非常清楚：

> *   数据通常会按需或按计划同步，而不是连续同步。
> *   发布有大量订阅者，和/或在分发服务器上运行所有代理会占用大量资源。
> *   订户是自主的、断开连接的和/或移动的。订阅者将确定他们何时连接和同步更改。
> *   最常与合并复制一起使用。

# c# - 层次结构的集合

> ID：748851
> 
> 赞同：0
> 
> 时间：2009-04-14T18:39:28.830
> 
> 标签：c#, .net, collections

在我正在编写的应用程序中，我试图找到一种有效存储层次结构的方法。这是一个[例子](http://www.battlestarvfx.com/images/bsg_breakouttutorial/BSG_TUT_CompTest_Fusion_GUI.jpg)。

在底部，您可以看到要存储的节点。我应该使用多维列表吗？这似乎不是很理想，对吧？我在想像这样持有参考资料：

```
node.Parent
node.Children { collection } 
```

任何人都有这种东西的经验吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T18:42:42.067

是的。你有正确的想法。如果您需要双向层次结构，我不会使用多维列表......我会在树中添加一个节点，每个节点都包含一个父节点和一组子节点。

你在正确的轨道上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T18:43:58.197

这是树的一个相当基本的实现，是的。如果选择为孩子制作 IList 或 IEnumable 或 ArrayList 等集合，则取决于您。

我强烈建议您构建一个通用实现，而不是为您的域模型键入一个，但这取决于您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T18:50:48.757

如果不是所有项目都属于同一类型，我可以在这种情况下为链表和子集合使用抽象基类。

# asp.net - 优化 Telerik ASP.NET AJAX 控件

> ID：748860
> 
> 赞同：3
> 
> 时间：2009-04-14T18:43:51.630
> 
> 标签：asp.net, telerik, rad-controls, telerik-ajax

关于优化 Telerik Web 控件的任何好的资源（链接）？我想有些功能默认是打开的。这些功能需要根据请求下载资源（javascript、css、图像）。很高兴知道这些功能是什么，如果不使用就关闭它们。

你知道这些功能吗？我主要对 Telerik AJAX 组件感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T18:57:14.513

这有帮助吗？

[优化 RadControls for ASP.NET AJAX 的输出、页面加载时间和整体性能](http://www.telerik.com/help/aspnet-ajax/optimizing_output_and_page_load_time_by_using_radscriptmanager_and_radstylesheetmanager.html)

[RadInput 与 RadInputManager](http://www.telerikwatch.com/2009/02/optimization-tips-radinput-vs.html)

[使用 RadAjaxManagerProxy 控件](http://telerikwatch.com/2008/05/optimization-tips-using.html)

你有没有尝试搜索任何东西？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T06:50:05.050

最近在寻找性能提升技术时，我还在 Telerik 网站上找到了这些资源：

[最佳性能页面](http://www.telerik.com/products/aspnet-ajax/resources/top-performance.aspx)

[支持中心 RadControls 性能部分](http://www.telerik.com/support/aspnet-ajax.aspx)

它们看起来非常具有描述性，并涵盖了大部分控件。

迪克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T13:09:01.067

这里有更多：

[优化输出、页面加载时间和整体性能](http://www.telerik.com/help/aspnet-ajax/optimizing_output_and_page_load_time_by_using_radscriptmanager_and_radstylesheetmanager.html)

[公共论坛中的 15 大优化提示和技巧](http://blogs.telerik.com/ToddAnglin/Posts/07-05-14/Top_15_Optimization_Tips_and_Tricks.aspx?ReturnURL=/ToddAnglin/Posts.aspx%3fPage%3d3)

# matlab - MATLAB中的数字到字母交换

> ID：748869
> 
> 赞同：2
> 
> 时间：2009-04-14T18:47:11.917
> 
> 标签：matlab

例如，我有一个向量`V = [ 1, 2, 3, 4 ]`。有没有办法将其更改为字母，`[ a,b,c,d ]`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-14T20:39:59.150

直接使用 'a' 而不是 ascii 代码可能更具可读性

```
charString = char(V-1+'a'); 
```

大写然后获得

```
charString = char(V-1+'A'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T20:37:01.170

有两种简单的方法可以做到这一点。一种方法是简单的索引。

```
C = 'abcdefghijklmnopqrstuvwxyz';
V = [8 5 12 12 15 23 15 18 12 4];

C(V)
ans =
helloworld 
```

当然，char 也会这样做。char 答案更好，因为它不需要您存储要索引的字母列表。

```
char('a' + V - 1)
ans =
helloworld 
```

这是最好的，因为当您将“a”添加到某物时，它会即时将“a”转换为其 ascii 表示形式。+'a' 将产生 97，'a' 的 ascii 形式。

一件好事是它也适用于“A”，所以如果你想要大写字母，只需添加“A”。

```
char('A' + V - 1)
ans =
HELLOWORLD 
```

您可以通过以下命令找到有关在 MATLAB 中处理字符串的更多信息：

```
help strings
doc strings 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T19:01:11.353

就像是

```
C = char(V+ones(size(V)).*(97-1)) 
```

应该可以工作（97 是 'a' 的 ASCII 码，你希望 1 映射到 'a' 看起来像）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T19:58:32.837

使用[CHAR](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/char.html)函数，将数字（即 ASCII 码）转换为字符：

```
charString = char(V+96); 
```

**编辑：**要倒退（将 'a' 映射到 1，'b' 到 2 等），请使用[DOUBLE](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/double.html)函数将字符重铸回其 ASCII 码：

```
V = double(charString)-96; 
```

# jquery - jQuery 中的 BindAsEventListener 等价物？

> ID：748870
> 
> 赞同：4
> 
> 时间：2009-04-14T18:47:19.437
> 
> 标签：jquery, prototypejs

我正在尝试使用 jQuery 将单击事件绑定到某个元素。使用原型我知道我可以使用`BindAsEventListener()`.

例子：

```
var myObject = {

init: function(txtOneId, txtTwoId, lblResultId, ancAddId) {
    this.txtOneId = txtOneId;
    this.txtTwoId = txtTwoId;
    this.lblResultId = lblResultId;
    this.ancAddId = ancAddId;

    var addListener = this.addResult.bindAsEventListener(this);

    Event.observe(this.txtOneId, 'keyup', addListener);
    Event.observe(this.txtTwoId, 'keyup', addListener);
},

addResult: function() {

    var valueOne = $(this.txtOneId).value;
    var valueTwo = $(this.txtTwoId).value;

    if (isNaN(valueOne) || valueOne == "")
        valueOne = 0;
    else
        valueOne = parseInt(valueOne);

    if (isNaN(valueTwo) || valueTwo == "")
        valueTwo = 0;
    else
        valueTwo = parseInt(valueTwo);

    var result = valueOne + valueTwo;

    $(this.lblResultId).innerHTML = result;

    return false;
}}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T19:33:29.280

我假设您仍在使用原型，并且添加了 jQuery 没有冲突，因此**$()**是原型方法，而**$j()**是 jQuery 方法。

**快速回答**

您只需要更改您的 init 方法。

```
 init: function(txtOneId, txtTwoId, lblResultId, ancAddId) {
        this.txtOneId = txtOneId;
        this.txtTwoId = txtTwoId;
        this.lblResultId = lblResultId;
        this.ancAddId = ancAddId;

        var handler = function(event){ event.data.addResult(event) };

        $j(this.txtOneId).bind('keyup', this, handler);
        $j(this.txtTwoId).bind('keyup', this, handler);
    } 
```

**解释**

在 Prototype 中，您使用了 bindAsEventListener 函数，以便在收到事件时 this 引用可用。

对于 jQuery，您可以使用以下语法（来自[jquery api](http://api.jquery.com/bind/)）通过 bind 方法传递此事件数据：

```
.bind( eventType [, eventData], handler(eventObject) ); 
```

应用到您的代码，使用匿名函数，这将解析为：

```
$j(this.txtOneId).bind('keyup', this, function(event){ event.data.addResult(event) }); 
```

在这种情况下，我们将 'keyup' 事件绑定到文本元素，将 this 引用作为 eventData 传递，然后在处理函数中我们使用 event.data 引用 eventData (this) 以执行 this.addResult(event) 方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-08T21:56:55.017

要在不利用原型函数的情况下做到这一点，您可以使用 jQuery.proxy

[http://api.jquery.com/jQuery.proxy/](http://api.jquery.com/jQuery.proxy/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T19:04:06.870

[绑定文档。](http://docs.jquery.com/Events/bind#typedatafn)

您将需要使用此示例：在您的示例中，您在事件处理程序中使用了一个对象。此代码将允许您绑定对象并将其作为事件的一部分取回。这比创建闭包要方便一些。

```
function Something() {
  this.myData = "fun";
  this.handleClick = function(event) {
    alert(event.data.myData);
  }
}

var something = new Something();
$('h2').bind("click", something, something.handleClick); 
```

Bind 适用于您需要的几乎所有事件：可能的事件值：模糊、焦点、加载、调整大小、滚动、卸载、beforeunload、单击、dblclick、mousedown、mouseup、mousemove、mouseover、mouseout、mouseenter、mouseleave、change、select、submit , keydown, keypress, keyup, 错误

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T18:53:47.067

[点击（fn）](http://docs.jquery.com/Events/click#fn)：

```
$("#someElement").click( function(event) {
     alert("Hi you clicked me!");
}); 
```

或者如果您想将“处理程序”定义为命名函数：

```
function someElementClicked(event) {
     alert("Hi you clicked me!");
};

$("#someElement").click(someElementClicked); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-14T18:58:47.303

完全等效的是 $().bind() 函数：

```
$("#elem").bind('click', function() {
  //do stuff here
}); 
```

# python - 从使用 libglade 转换为 GtkBuilder 的步骤是什么？（Python）

> ID：748872
> 
> 赞同：5
> 
> 时间：2009-04-14T18:47:35.677
> 
> 标签：python, pygtk, glade, gtkbuilder

我有一个使用 libglade 并使用以下内容加载 xml 文件的小项目：

```
self.gladefile = "sdm.glade"
self.wTree = gtk.glade.XML(self.gladefile) 
self.window = self.wTree.get_widget("MainWindow")
if (self.window):
    self.window.connect("destroy", gtk.main_quit)
dic = { "on_button1_clicked" : self.button1_clicked, 
        "on_MainWindow_destroy" : gtk.main_quit}
self.wTree.signal_autoconnect(dic) 
```

在林间空地转换我的项目后，我需要进行哪些结构更改？我在 Ubuntu 9.04 上。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-14T21:57:11.477

你需要`gtk.Builder`改用。此类可以加载任意数量的 UI 文件，因此您需要手动添加它们，无论是作为文件还是作为字符串：

```
self.uifile = "sdm.ui"
self.wTree = gtk.Builder()
self.wTree.add_from_file(self.uifile) 
```

而不是`get_widget`，只需`get_object`在构建器类上使用：

```
self.window = self.wTree.get_object("MainWindow")
if self.window:
    self.window.connect("destroy", gtk.main_quit) 
```

要连接信号，只需使用`connect_signals`，它也需要一个字典：

```
dic = { "on_button1_clicked" : self.button1_clicked, 
    "on_MainWindow_destroy" : gtk.main_quit}
self.wTree.connect_signals(dic) 
```

曾经是这种情况（至少在 GTK+ 2.12 中，不确定它是否仍然相同）您只能调用`connect_signals`一次，在第一次调用期间未连接的任何信号将永远不会连接。这在林间空地是不同的，所以如果你以前依赖过这个功能，请小心。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-11-29T22:01:27.803

Torsten 的回答是正确的，但有点不完整，所以本着 [http://xkcd.com/979/](http://xkcd.com/979/)的精神，这是我最近经过反复试验后确定的程序：

在 Glade 界面设计器中打开 yada.glade。转到编辑->项目并将项目类型更改为 GtkBuilder 并确保它针对最新版本（撰写本文时为 2.24）。保存文件，确保它以 GtkBuilder 格式保存，并将名称从 yada.glade 更改为 yada.ui

打开 yada.py 并更改以下代码：

```
gladefile = relativize_filename(os.path.join("glade", "yada.glade"))
self.wTree = gtk.glade.XML(gladefile, self.windowname) 
```

到：

```
uifile = relativize_filename(os.path.join("glade", "yada.ui"))
self.wTree = gtk.Builder()
self.wTree.add_from_file(uifile) 
```

同样将所有实例更改`self.wTree.get_widget(...)`为`self.wTree.get_object(...)`

更改`self.wTree.signal_autoconnect(dic)`为`self.wTree.connect_signals(dic)`

如果您的代码依赖于界面设计器中分配给小部件的名称，请更改`widget.get_name()`为`gtk.Buildable.get_name(widget)`. `widget.get_name()`现在只返回小部件类型。编辑：您还需要更改`widget.set_name('my_widget')`为`gtk.Buildable.set_name(widget, 'my_widget')`.

删除`import gtk.glade`

我发现在 yada.ui xml 文件中定义了许多未使用的信号，我不得不打开 xml 文件并手动删除它们以消除它们引起的警告。

# javascript - 从 iframe 中获取 top href 和 innerHTML

> ID：748873
> 
> 赞同：2
> 
> 时间：2009-04-14T18:48:37.873
> 
> 标签：javascript, jquery, css, iframe

有没有办法从单独域的 iframe 中从顶部获取任何信息？有人要求我验证他们的广告不在色情等内容旁边……但他们的广告总是在发布商网站的 iframe 内。

有趣的是，当我将 twitter.com 放入 iframe 时，他们开启了 iframe 破坏技术 - 如下所示：

```
<script type="text/javascript">
//<![CDATA[
    if (window.top !== window.self) { setTimeout(function(){document.body.innerHTML='';},1);window.self.onload=function(evt){document.body.innerHTML='';};}
//]]>
</script> 
```

令我印象深刻的是，作为一个不同的域，他们仍然有能力获得window.top。但是，当我尝试将此功能扩展到 window.top.location 或 window.top.href 以获取顶部窗口的 URL 时，我得到

```
uncaught exception: [Exception... "Component returned failure code: 0x8007000e (NS_ERROR_OUT_OF_MEMORY) [nsIDOMNSHTMLDocument.write]"  nsresult: "0x8007000e (NS_ERROR_OUT_OF_MEMORY)"  location: "JS frame :: http://tester.tester.com/iframe3.html :: <TOP_LEVEL> :: line 9"  data: no]
http://tester.tester.com/iframe3.html
Line 9 
```

这实际上只是 Gecko 误报的权限错误（我认为）。

对此有什么想法吗？是否可以使用等式声明，因为 iframe 实际上没有获取数据，而获取数据本身不可用？

我能得到的任何信息总比没有好，所以请随时提供部分答案。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T19:28:57.247

> 是否可以使用等式声明，因为 iframe 实际上没有获取数据，而获取数据本身不可用？

这是 JavaScript 的一个古老怪癖，您始终可以获取跨域框架/iframe/parent/opener 的“窗口”对象。但是——出于明显的安全原因——你不能访问对象的大多数成员。由于浏览器错误，过去偶尔有一些方法可以绕过这些限制，但没有什么可以依赖的。

几乎您可以对未知窗口对象有用的唯一一件事就是检查它是否与其他一些已知窗口对象（例如当前窗口对象）相同。

如果你想测试一个未知窗口是否至少在你自己的域内，你可以尝试`otherwindow.location`在一个`try...catch`块内访问。

> 有没有办法从单独域的 iframe 中从顶部获取任何信息？

否，但您可以在 HTTP 服务器端记录“Referer”标头，以查看包含 <iframe> 的页面。但是，您的广告网络肯定已经为您这样做了吗？

> 如果 (window.top !== window.self)

好奇的; window.self 和 window 是一回事；我不知道你为什么会使用更长的版本。此测试的最短习语是：

```
if (top!==self) 
```

只要您不定义任何其他称为“top”或“self”的变量，它就可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T18:52:02.810

不，没有。这是由于[跨站点脚本](http://en.wikipedia.org/wiki/Cross-site_scripting)攻击。

# .net - 暂停 System.Timers.Timer 的正确方法？

> ID：748876
> 
> 赞同：6
> 
> 时间：2009-04-14T18:51:28.663
> 
> 标签：.net, vb.net, timer

我正在研究如何暂停 a `System.Timers.Timer`，但如果不重置计时器，我无法找出暂停它的正确方法。

如何暂停？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-14T18:59:38.097

没有 Pause()，你可以在 Pause() 上写一个：

1.  更改（超时。无限，超时。无限）
2.  保存计算计时器剩余量。

在简历（）上：

1.  变化（计时器剩余量）

如果您编写此课程，请将其发布在答案中，因为似乎我们中的许多人都需要 Timer 课程之外的功能。:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-08T11:22:49.080

我现在明白了，我确定它不是防弹的，所以告诉我它有什么问题......

```
Public Class ImprovedTimer
Inherits System.Timers.Timer

Private _sw As System.Diagnostics.Stopwatch
Private _paused As Boolean
Private _originalInterval As Double
Private _intervalRemaining As Double?

Public ReadOnly Property IntervalRemaining() As Double?
    Get
        Return _intervalRemaining
    End Get
End Property

Public ReadOnly Property Paused() As Boolean
    Get
        Return _paused
    End Get
End Property

Public ReadOnly Property OriginalInterval() As Double
    Get
        Return _originalInterval
    End Get
End Property

Public Sub Pause()
    If Me.Enabled Then
        _intervalRemaining = Me.Interval - _sw.ElapsedMilliseconds
        _paused = True
        resetStopWatch(False, False)
        MyBase.Stop()
    End If
End Sub

Public Sub [Resume]()
    If _paused Then
        Me.Interval = If(_intervalRemaining.HasValue, _intervalRemaining.Value, _originalInterval)
        resetStopWatch(True, False)
        MyBase.Start()
    End If
End Sub

Public Overloads Property Enabled() As Boolean
    Get
        Return MyBase.Enabled
    End Get
    Set(ByVal value As Boolean)
        MyBase.Enabled = value
        resetStopWatch(MyBase.Enabled, True)
    End Set
End Property

Public Overloads Sub Start()
    resetStopWatch(True, True)
    MyBase.Start()
End Sub

Public Overloads Sub [Stop]()
    resetStopWatch(False, True)
    MyBase.Stop()
End Sub

Public Overloads Property Interval() As Double
    Get
        Return MyBase.Interval
    End Get
    Set(ByVal value As Double)
        MyBase.Interval = value
        If Not _paused Then
            _originalInterval = MyBase.Interval
        End If
    End Set
End Property

Private Sub resetStopWatch(ByVal startNew As Boolean, ByVal resetPause As Boolean)
    If _sw IsNot Nothing Then
        _sw.Stop()
        _sw = Nothing
    End If
    If resetPause Then
        If _paused Then
            Me.Interval = _originalInterval
        End If
        _paused = False
        _intervalRemaining = Nothing
    End If
    If startNew Then
        _sw = System.Diagnostics.Stopwatch.StartNew
    End If
End Sub

Private Sub ImprovedTimer_Disposed(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Disposed
    resetStopWatch(False, True)
End Sub

Private Sub ImprovedTimer_Elapsed(ByVal sender As Object, ByVal e As System.Timers.ElapsedEventArgs) Handles Me.Elapsed
    resetStopWatch(Me.AutoReset, True)
End Sub

End Class 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T19:50:48.410

你应该听从 Shay Erlichmen 的建议。您需要在暂停时保存剩余时间，并在计时器恢复时从该点继续。至于您当前的代码有什么问题：

```
Me.Interval = Me.Interval - sw.ElapsedMilliseconds 
```

上面的代码将确保下次您恢复时它会在第一个滴答声上按预期工作，但在连续滴答声上，您将使用 Me.Interval - sw.ElapsedMilliseconds 作为间隔而不是原始设置的间隔。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-17T15:57:00.453

这是我一直在使用的。它可能不是最先进的准确，但效果很好。至少，对于尝试在计时器暂停/恢复的人来说，这是一个很好的起点。

```
public class PausableTimer
{
    private Timer _timer;
    private Stopwatch _stopWatch;
    private bool _paused;
    private double _interval;
    private double _remainingTimeBeforePause;

    public PausableTimer(double interval, ElapsedEventHandler handler)
    {
        _interval = interval;
        _stopWatch = new Stopwatch();

        _timer = new Timer(interval);
        _timer.Elapsed += (sender, arguments) => {
            if (handler != null)
            {
                if(_timer.AutoReset)
                {
                    _stopWatch.Restart();
                }

                handler(sender, arguments);
            }
        };

        _timer.AutoReset = false;
    }

    public bool AutoReset
    {
        get
        {
            return _timer.AutoReset;
        }
        set
        {
            _timer.AutoReset = value;
        }
    }

    public void Start()
    {
        _timer.Start();
        _stopWatch.Restart();
    }

    public void Stop()
    {
        _timer.Stop();
        _stopWatch.Stop();
    }

    public void Pause()
    {
        if(!_paused && _timer.Enabled)
        {
            _stopWatch.Stop();
            _timer.Stop();
            _remainingTimeBeforePause = Math.Max(0, _interval - _stopWatch.ElapsedMilliseconds);
            _paused = true;
        }
    }

    public void Resume()
    {
        if(_paused)
        {
            _paused = false;
            if(_remainingTimeBeforePause > 0)
            {
                _timer.Interval = _remainingTimeBeforePause;
                _timer.Start();
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-15T13:29:36.383

根据 sveilleux2 和 Tomerz 之前的评论，我改进了实现 IDisposable 的解决方案，允许多次暂停-恢复调用，并添加了 Enabled 和 Paused 属性。

```
public class PausableTimer: IDisposable
{
    private Timer _timer;
    private Stopwatch _stopWatch;
    private bool _paused;
    private double _remainingTimeBeforePause;
    public event ElapsedEventHandler Elapsed;

    public PausableTimer()
    {
        _stopWatch = new Stopwatch();

        _timer = new Timer();
        _timer.AutoReset = false;
        _timer.Elapsed += (sender, arguments) =>
        {
            Elapsed?.Invoke(sender, arguments);

            if (_timer != null && _timer.AutoReset)
            {
                _stopWatch.Restart();
            }
        };

    }

    public PausableTimer(double interval): this()
    {
        Interval = interval;
    }

    public bool AutoReset
    {
        get
        {
            return _timer.AutoReset;
        }
        set
        {
            _timer.AutoReset = value;
        }
    }

    public bool Enabled
    {
        get
        {
            return _timer.Enabled;
        }
        set
        {
            _timer.Enabled = value;
        }
    }

    public double Interval
    {
        get
        {
            return _timer.Interval;
        }
        set
        {
            _timer.Interval = value;
        }
    }

    public bool Paused
    {
        get
        {
            return _paused;
        }
    }

    public void Start()
    {
        _timer.Start();
        _stopWatch.Restart();
    }

    public void Stop()
    {
        _timer.Stop();
        _stopWatch.Stop();
    }

    public void Pause()
    {
        if (!_paused && _timer.Enabled)
        {
            _paused = true;
            _stopWatch.Stop();
            _timer.Stop();
            _remainingTimeBeforePause = Math.Max(0, Interval - _stopWatch.ElapsedMilliseconds);
        }
    }

    public void Resume()
    {
        if (_paused)
        {
            _paused = false;
            if (_remainingTimeBeforePause > 0)
            {
                _timer.Interval = _remainingTimeBeforePause;
                _timer.Start();
                _stopWatch.Start();
            }
        }
    }

    bool _disposed = false;

    public void Dispose()
    {
        if (_timer != null && !_disposed)
        {
            // Not thread safe...
            _disposed = true;
            _timer.Dispose();
            _timer = null;
        }
    }

    ~PausableTimer()
    {
        Dispose();
    }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-09-25T02:16:33.950

像这样创建一个计时器：

```
 System.Timers.Timer t = new System.Timers.Timer(1000) 
    t.Elapsed += new System.Timers.ElapsedEventHandler(timerEvent);

    public void timerEvent(object source, System.Timers.ElapsedEventArgs e)
    {

    } 
```

您可以设置此属性来启动或暂停计时器执行 timeEvent：

开始：

```
 t.Enabled = true 
```

暂停：

```
 t.Enabled = false 
```

# c# - Ref Abuse：值得清理吗？

> ID：748878
> 
> 赞同：11
> 
> 时间：2009-04-14T18:51:45.433
> 
> 标签：c#, ref

我继承了一些广泛且不必要地使用**ref**关键字的代码。**最初的开发人员显然担心如果不使用ref** ，对象会像原始类型一样被克隆，并且在编写 50k+ 行代码之前没有费心研究这个问题。

这与其他不良编码实践相结合，造成了一些表面上非常危险的情况。例如：

* * *

```
Customer person = NextInLine(); 
//person is Alice
person.DataBackend.ChangeAddress(ref person, newAddress);
//person could now be Bob, Eve, or null 
```

你能想象走进一家商店改变你的地址，然后作为一个完全不同的人走出去吗？

* * *

可怕，但*实际上*在此应用程序中使用**ref**似乎是无害的多余。我很难证明清理它需要花费大量时间。为了帮助推销这个想法，我提出以下问题：

## 对 ref 的不必要使用还有什么破坏性？

我特别关心维护。带有示例的合理答案是首选。

也欢迎您争辩没有必要进行清理。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-14T18:56:18.277

我想说最大的危险是如果由于`null`某种原因将参数设置为函数内部：

```
public void MakeNull(ref Customer person)
{
    // random code
    person = null;
    return;
} 
```

现在，你不只是一个*不同*的人，你已经完全从存在中消失了！

只要开发此应用程序的人了解：

> 默认情况下，对象引用是按值传递的。

和：

> 使用`ref`关键字，对象引用通过引用传递。

如果代码现在按预期工作并且您的开发人员了解其中的区别，那么将它们全部删除可能不值得。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T18:59:14.447

我将添加我见过的最糟糕的 ref 关键字用法，该方法看起来像这样：

```
public bool DoAction(ref Exception exception) {...} 
```

是的，您必须声明并传递一个 Exception 引用才能调用该方法，然后检查该方法的返回值以查看是否已捕获异常并通过 ref 异常返回。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T18:59:55.710

你能弄清楚为什么代码的发起者认为他们需要将参数作为 ref 吗？是因为他们确实更新了它然后删除了功能，还是仅仅因为他们当时不了解 c#？

如果你认为清理工作是值得的，那就继续吧——特别是如果你现在有时间的话。当真正的问题出现时，您可能无法正确修复它，因为它很可能是紧急的错误修复，您将没有时间做正确的工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T19:00:49.047

在 C# 中修改方法中参数的值是很常见的，因为它们通常是按值而不是按 ref。这适用于引用类型和值类型；例如，将引用设置为 null 会更改原始引用。当其他开发人员“照常”工作时，这可能会导致非常奇怪和痛苦的错误。使用 ref 参数创建递归方法是不行的。

除此之外，您对可以通过 ref 传递的内容有限制。例如，您不能传递常量值、只读字段、属性等，因此在使用 ref 参数调用方法时需要大量辅助变量。

最后但并非最不重要的一点是性能可能不太好，因为它需要更多的间接性（引用只是一个需要在每次访问时解析的引用）并且还可以使对象保持更长时间，因为引用不会消失范围尽可能快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T19:42:39.397

对我来说，这听起来像是一个 C++ 开发人员做出无根据的假设。

我会警惕对有效的东西进行大规模更改。（我假设它有效，因为您没有评论它被破坏，只是它很危险）。

您要做的最后一件事是打破一些微妙的事情，并且必须花费一周的时间来追踪问题。

我建议你边走边清理——一次一种方法。

1.  在您确定不需要的地方找到使用 ref 的方法。
2.  更改方法签名并修复调用。
3.  测试。
4.  重复。

虽然您遇到的具体问题可能比大多数情况更严重，但您的情况很常见 - 拥有不符合我们当前对“*正确方式*”做事的理解的大型代码库。

批发“升级”经常遇到困难。随手重构——在你处理它们时使事情符合规范——要安全得多。

这在建筑行业有先例。例如，旧建筑（比如 19 世纪）中的电线不需要接触，除非出现问题。但是，当出现问题*时*，必须按照现代标准完成新工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T19:30:43.763

我会尝试修复它。只需使用正则表达式执行解决方案范围的字符串替换，然后检查单元测试。我知道这可能会破坏代码。但是你多久使用一次 ref？几乎从来没有，对吧？鉴于开发人员不知道它是如何工作的，我认为它在某处（应该的方式）使用的机会更小。如果代码中断 - 好吧，回滚......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-04T23:58:05.963

> 对 ref 的不必要使用还有什么破坏性？

其他答案涉及语义问题，这绝对是最重要的事情。好的代码是自我记录的，当我给出一个 ref 参数时，我认为它*会*改变。如果不是，则 API 无法自我记录。

但是为了好玩，我们看看另一个方面——性能怎么样？

```
void ChangeAddress(ref Customer person, Address address)
{
    person.Address = address;
} 
```

这里`person`是一个引用的引用，所以每当你访问它时都会引入一些间接性。让我们看一些可能转化为的程序集：

```
mov eax, [person]           ; load the reference to person.
mov [eax+Address], address  ; assign address to person.Address. 
```

现在是非参考版本：

```
void ChangeAddress(Customer person, Address address)
{
    person.Address = address;
} 
```

这里没有间接性，所以我们可以去掉一个读取：

```
mov [person+Address], address  ; assign address to person.Address. 
```

在实践中，人们希望 .NET 缓存`[person]`在`ref`版本中，将间接成本分摊到多次访问中。除了像这里这样的琐碎方法之外，它实际上可能不会减少 50% 的指令数。

# python - 如何在 ReportLab 中创建项目符号列表

> ID：748881
> 
> 赞同：7
> 
> 时间：2009-04-14T18:53:07.737
> 
> 标签：python, pdf, reportlab

如何在 ReportLab 中创建项目符号列表？该文档令人沮丧地含糊不清。我在尝试：

```
text = ur '''
<para bulletText="&bull;">
item 1
</para>
<para bulletText="&bull;">
item 2
</para>
'''
Story.append(Paragraph(text,TEXT_STYLE)) 
```

但我不断收到类似`list index out of range`. `<para></para>`似乎我不能在一次调用中放置多个`Paragraph()`？我也试过设置`TEXT_STYLE.bulletText="&bull;"`，但这也不起作用......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-03-01T10:40:16.133

最新版本的 ReportLab 具有 ListFlowable 和 ListItem 对象（查看当前用户指南的第 9 章）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-14T21:10:23.320

bulletText 参数实际上是`Paragraph`对象的构造函数，而不是`<para>`标签:-) 试试这个：

```
story.append(Paragraph(text, TEXT_STYLE, bulletText='-')) 
```

[不过，请查看ReportLab 文档](http://www.reportlab.com/docs/reportlab-userguide.pdf)第 68 页（现在是第 74 页，2012 年）上的示例。ReportLab 中的约定似乎是使用标签，并且文档确实警告您每个实例`<bullet>`只能有一个。`Paragraph`我们在 ReportLab 中渲染我们的项目符号，如下所示：

```
story.append(Paragraph('<bullet>The rain in spain</bullet>', TEXT_STYLE)) 
```

# apache-flex - 找出按下的字符

> ID：748884
> 
> 赞同：7
> 
> 时间：2009-04-14T18:54:06.457
> 
> 标签：apache-flex, flash, actionscript-3, keyboard

如果我向 KeyboardEvent.KEY_DOWN 添加一个监听器，我可以找出 keyCode 和 charCode。

keyCode 根据键盘映射到不同的字符。

根据帮助，charCode 同样没用：

> 字符代码值是英文键盘值。例如，如果您按 Shift+3，则 charCode 在日语键盘上为 #，就像在英语键盘上一样。

那么，我怎样才能找出用户按下了哪个字符呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T19:03:59.770

您遗漏了引用的一个非常重要的部分，或者它在您找到它的地方丢失了：

> 例如，如果您按下 Shift+3，getASCIICode() 方法会在日文键盘上返回 #，就像在英文键盘上一样。
> 
> [http://livedocs.adobe.com/flex/201/langref/flash/events/KeyboardEvent.html](http://livedocs.adobe.com/flex/201/langref/flash/events/KeyboardEvent.html)

这可能更有帮助：

> charCode 属性是该键在当前字符集中的数值（默认字符集是 UTF-8，它支持 ASCII）。
> 
> [http://livedocs.adobe.com/flex/2/docs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000480.html](http://livedocs.adobe.com/flex/2/docs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000480.html)

您的应用程序确定使用什么字符集，这意味着即使您必须使用不同键盘本地的不同键来生成相同的字符，它也将具有相同的 charCode。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T17:04:15.790

注意：（这一般是关于键盘消息，并不单独适用于动作脚本。我误读了问题并提供了更深入的答案，然后很有帮助）

真的，从键盘到 windows char 的路径是一个非常复杂的路径，它是这样的：

*   键盘将扫描码发送到键盘设备驱动程序 (KDD)。
*   KDD 向系统消息队列发送消息。
*   然后系统将消息发送到创建具有当前键盘焦点的窗口的前台线程。
*   线程的消息循环获取消息并计算出正确的字符翻译。

在完成整个过程之前，不会计算键入的“真实”字符，因为每个窗口和线程都可以位于不同的语言环境中，并且在不知道语言环境和键缓冲区历史记录的情况下，您无法真正“翻译”键。

“WM_KEYDOWN”和“WM_KEYUP”消息不能只用 MapVirtualKey 或其他东西转换，因为你不知道有多少按键构成一个字符。简单的方法就是处理“WM_CHAR”事件并使用它。考虑以下：

*   en-US locale，你按下下面的键 a + ' + a，你会得到下面的输出“a'a”
*   pt-BZ 语言环境，你按下下面的键 a + ' + a，你得到下面的输出“aá”

因此，在这两个示例中，您都会收到 3 个 KEYDOWN、KEYUP 消息，但第一个您会收到 3 个 WM_CHAR，而第二个您只会收到 2 个。

以下文章对基本概念非常有用：http: [//msdn.microsoft.com/en-us/library/ms646267 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms646267(VS.85).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T18:19:24.823

您不能有效地使用`charCode`或`keyCode`确定输入的字符。您必须只比较字符串。`KeyboardEvent`不会给你输入的文本，这也很愚蠢。

就我而言`KeyboardEvent.KEY_DOWN`，除了事件之外，我还实现了一个`TextEvent.TEXT_INPUT`事件。在后者的处理程序中，我实现了所有`charCode`需要的功能，并且没有因键盘区域设置而异（例如空格键或回车）。在前者中，我检查了事件的文本属性以比较我需要的独立于语言环境的内容。

忘了提到这篇文章向我暗示了那个解决方案：[如何找出语言中按下的字符？](https://stackoverflow.com/questions/4537349/how-to-find-out-the-character-pressed-key-in-languages?lq=1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T19:01:57.590

键入日文平假名等字符通常需要多次击键，有时甚至需要从下拉菜单中选择适当的字符。您可能想要侦听不同的事件，例如文本字段的更改事件。

# asp.net - 从共享驱动器托管的网站中特定于服务器的 web.config

> ID：748891
> 
> 赞同：3
> 
> 时间：2009-04-14T18:55:38.557
> 
> 标签：asp.net, web-config, replication, load-balancing

**背景信息：文件复制是蹩脚的**

目前，我们有一个大规模、高流量的 ASP.NET Web 应用程序，负载平衡在 8 个不同的 IIS 服务器上。由于站点的性质，对 .aspx 文件和 .ascx 控件的微小更改会在一天中频繁发生，并且在经过测试并发布到现场后，会定期通过 xcopy 部署复制到每个公共网络服务器10分钟。

当然，这是非常低效的，因为每个服务器都必须有整个站点的冗余副本，我们希望消除 10 分钟的发布延迟。

**可能的改进：从共享存储托管**

我们现在可以选择使用带有 iSCSI 接口的集中式存储来集中托管整个站点，每个服务器都认为远程存储是本地驱动器。发布将是即时的和全系统的。

*注意：无法将驱动器从 UNC 共享中托管，因为站点结构中有许多不同的目录，每个目录都需要用于 ASP.NET 的 FileSystemWatcher 来监视更改，因此很快就会达到 SMB 最大命令数。是的，我们知道 MaxCmds 和 MaxMpxCt 注册表设置。*

**问题：Web.config 更改触发大量重新编译**

我们预见到的问题是文件系统结构的某些更改可能导致几乎每个已编译的 .aspx 或 .ascx 都必须重新编译，从而导致请求排队和服务器已关闭的感觉。大多数资源并未在系统范围内使用，因此在更改时重新编译它们几乎不会导致资源中断。站点上所有页面使用的全局母版页可能会导致此问题，但这可以通过代码轻松管理。

罪魁祸首是 web.config 文件。对 web.config 文件的更改会导致整个 Web 应用程序循环使用，并进行重新编译。因此，我们目前不复制 web.config 更改。任何 web.config 更改都需要将 Web 服务器从负载平衡器中移除，应用（和测试）更改，然后使用垃圾请求预热服务器，然后再将其放回负载平衡器上。

但是，如果 web.config 文件与 Web 应用程序目录结构的其余部分一样位于集中存储上，则该文件只有一份副本，并且无法再对各个服务器进行修补和预热。

**问题**

有没有办法让 ASP.NET Web 应用程序从名为 Web.config 的文件以外的源获取其行进命令？

理想情况下，每台服务器只有一个文件，例如：

*   默认.aspx
*   全球.asax
*   Web-ServerA.config
*   Web-ServerB.config
*   ...
*   Web-ServerN.config

无论如何，名称“web.config”在哪里定义？是否有可以在每台服务器上设置的注册表设置？是否可以在 machine.config 或全局 web.config 中创建一个条目来指定要使用的文件？

**超出范围的事情**

我很清楚，我不是在问如何为调试、测试和实时设置不同的 AppSettings。还有其他主题涵盖了这一点，而且我的所有 web.config 大部分时间都是相同的，唯一需要它们不同的时候是执行更新时。

我们没有将 web.config 用于任何 appSettings 信息；这是针对真正重要的东西，例如程序集引用、httpHandler 定义和其他无法数据库化的 system.web 设置。

**更新**

我尝试在注册表中搜索 Web.config，除了指出我最近编辑过 web.config 文件的应用程序之外，什么也没找到，我显然做了很多。那里没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T19:04:10.643

我的第一个问题是你在 web.config 中保留了什么 & 你可以将它移动到数据库中吗？我们将每个配置设置保存在数据库中的表中，并使用 machine.config 来存储数据库连接信息。

不知道对你有多少重写，但它会避免你的问题。

另一种选择是将您的配置项存放在一个外部文件中，并从 web.config 中引用它。在 aspnet wp 被回收之前，不会重新读取对该文件的更改，但允许您更改设置，然后通过 IISRESET 循环每个服务器。

```
<configuration>
   <appSettings file="OtherFile.config">
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T17:41:52.510

1.  只是好奇，您使用的是什么文件系统？NTFS 不是共享存储文件系统。换句话说，一次不能有多个节点写入文件系统。

2.  我建议在 IIS 中的站点下使用虚拟目录。这可能需要对代码布局进行一些重组，但不应该太大。因此，您将拥有站点的根主目录以及特定于该计算机的 web.config，然后将 vdir 映射到您设置的任何共享文件系统资源。

# java - 你如何在 Java 中打开网页？

> ID：748895
> 
> 赞同：16
> 
> 时间：2009-04-14T18:57:51.440
> 
> 标签：java, web, jframe

有没有一种简单的方法可以在 GUI 的 JPanel 中打开网页？

如果没有，您如何使用计算机的默认 Web 浏览器打开网页？

我希望我可以用不到 20 行代码来做一些事情，并且最多需要创建一个类。虽然没有理由 20，只是希望代码少......

我打算打开一个指南去玩游戏。该指南是在线的并且有多个页面，但是这些页面相互链接，所以我希望我只需要用我的代码调用一个 URL。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-14T19:13:47.937

使用默认 Web 浏览器打开网页很容易：

```
java.awt.Desktop.getDesktop().browse(theURI); 
```

嵌入浏览器并不是那么容易。`JEditorPane`有*一些*HTML 能力（如果我没记错我有限的 Swing 知识的话），但它非常有限，不适合通用浏览器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T19:11:40.890

我知道有两种标准方法：

1.  标准[`JEditorPane`](http://java.sun.com/javase/6/docs/api/javax/swing/JEditorPane.html)组件
2.  [`Desktop`](http://java.sun.com/javase/6/docs/api/java/awt/Desktop.html). [`getDesktop()`](http://java.sun.com/javase/6/docs/api/java/awt/Desktop.html#getDesktop()). [`browse(URI)`](http://java.sun.com/javase/6/docs/api/java/awt/Desktop.html#browse(java.net.URI))打开用户的默认浏览器（Java 6 或更高版本）

    很快，还会有第三个：

3.  该[`JWebPane`](http://blogs.oracle.com/thejavatutorials/entry/html_component)组件，显然尚未发布

`JEditorPane`非常简单；它不处理 CSS 或 JavaScript，你甚至必须自己处理超链接。但是您可以将它嵌入到您的应用程序中，而不是启动 FireFox。

以下是如何使用超链接的示例（假设您的文档不使用框架）：

```
// ... initialize myEditorPane
myEditorPane.setEditable(false); // to allow it to generate HyperlinkEvents
myEditorPane.addHyperlinkListener(new HyperlinkListener() {
    public void hyperlinkUpdate(HyperlinkEvent e) {
        if (e.getEventType() == HyperlinkEvent.EventType.ENTERED) {
            myEditorPane.setToolTipText(e.getDescription());
        } else if (e.getEventType() == HyperlinkEvent.EventType.EXITED) {
            myEditorPane.setToolTipText(null);
        } else if (e.getEventType() == HyperlinkEvent.EventType.ACTIVATED) {
            try {
                myEditorPane.setPage(e.getURL());
            } catch (IOException ex) {
                // handle error
                ex.printStackTrace();
            }
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T19:14:27.123

如果您正在开发小程序，则可以使用[AppletContext.showDocument](http://java.sun.com/j2se/1.4.2/docs/api/java/applet/AppletContext.html#showDocument(java.net.URL,%20java.lang.String))。那将是一个单行：

```
getAppletContext().showDocument("http://example.com", "_blank"); 
```

如果您正在开发桌面应用程序，您可以尝试[Bare Bones Browser Launch](http://www.centerkey.com/java/browser/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T19:15:07.637

根本没有尝试过，但是来自[lobo 浏览器的](http://lobobrowser.org/)[cobra HTML 解析器和查看](http://lobobrowser.org/cobra/getting-started.jsp)器，一个用纯 Java 编写的浏览器，可能是你所追求的。他们提供了设置在线 html 查看器的示例代码：

```
import javax.swing.*;
import org.lobobrowser.html.gui.*;
import org.lobobrowser.html.test.*;

public class BareMinimumTest {
  public static void main(String[] args) throws Exception {
    JFrame window = new JFrame();
    HtmlPanel panel = new HtmlPanel();
    window.getContentPane().add(panel);
    window.setSize(600, 400);
    window.setVisible(true);
    new SimpleHtmlRendererContext(panel, new SimpleUserAgentContext())
    .navigate("http://lobobrowser.org/browser/home.jsp");
  }
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-14T19:11:43.560

我不知道这样的内置函数是否存在，但我会使用带有 iexplore.exe 或 firefox.exe 的[Runtime](http://www.ida.liu.se/~TDDB32/kursbibliotek/BlueJ/docs/api/java/lang/Runtime.html)类的**exec**作为参数。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2017-12-13T00:48:30.353

请尝试以下代码：

```
import java.awt.Desktop;
import java.net.URI;
import java.net.URISyntaxExaception;

//below is the code
//whatvever the url is it has to have https://

Desktop d = Desktop.getDesktop();
try {
    d.browse(new URI("http://google.com"));
} catch (IOException | URISyntaxException e2) {
    e2.printStackTrace();
} 
```

# c# - C#中的遗传算法？

> ID：748898
> 
> 赞同：4
> 
> 时间：2009-04-14T18:58:28.770
> 
> 标签：c#, .net, genetic-algorithm

如何在 C# 中编写遗传算法？有图书馆吗？喜欢 C++： http: [//lancet.mit.edu/ga/](http://lancet.mit.edu/ga/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-11-22T11:55:20.170

这听起来像是一个滑稽的答案，但你首先要决定你想让遗传算法解决什么问题。如前所述，旅行销售人员问题是一个常见的问题，也是了解他们如何工作的相当好的方法。

我说这是 GA 最重要的部分之一是适应度函数，没有框架会为你编写。

这篇2003 年的[codeproject 文章](http://www.codeproject.com/KB/recipes/btl_ga.aspx)确实涵盖了：

*   健身功能
*   有偏的轮盘赌
*   突变

它易于使用：

```
GA ga = new GA(crossover rate, 
               mutation rate, 
               population size, 
               number of generations,
               number of parameters for the fitness function);

ga.FitnessFunction = new GAFunction(theActualFunction); 
```

这可以升级到 .NET 3：

```
ga.FitnessFunction = delegate(double[] values)
{
    return 1.2d;
}; 
```

如您所见，适应度函数期望您的基因表示为双值（而不是例如位字符串）。

但是（这并不是在否定这篇文章，这很好），只要您知道基本 GA 的工作原理，您就可以很容易地自己编写这篇文章。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-30T13:37:40.077

有一个很好的框架“AForge.NET Genetics”，它会给你提供的不仅仅是你可以在 codeproject 上找到的“hello world”示例。请参阅 C# 中的重复帖子[遗传编程](https://stackoverflow.com/questions/14008/genetic-programming-in-c-sharp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T19:03:49.023

[您可以在CodeProject](http://www.codeproject.com)上找到 C# 的一些遗传算法信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-28T20:59:13.207

我用 C# 开发了一个简单的 GA 展示项目。这是遗传算法的hello world，我在一组接口上构建了示例，这些接口足够通用，可以用作开发遗传算法的模式。

[您可以在 github 页面](http://github.com/JohnIdol/typingmonkey)上找到代码和文档（包括包含设计图的 Enterprise Architect 文档）。您还可以[下载](http://github.com/JohnIdol/typingmonkey/downloads)可执行文件以查看它的运行情况。

希望能帮助到你。

# java - 为什么我的 Ant 主构建文件不能正常工作？

> ID：748903
> 
> 赞同：2
> 
> 时间：2009-04-14T18:59:29.423
> 
> 标签：java, ant, build

我们有一堆 Ant 脚本，每个子项目都有一个。最后，我们想从一个主构建脚本运行所有这些，并做一些其他的清理工作来打包整个项目。每个单独的 Ant 脚本都被命名`ant.xml`并位于其项目的子目录中。每个都使用 Ant`import`导入一个`ant-commons.xml`，然后覆盖那里的一些特定目标。

例如，其中一个项目覆盖`compile`目标，设置`classpath`适当，并将 and 设置`source`为`target`1.5（ant-commons 使用 1.4）

现在，从理论上讲，这一切听起来都很容易。这是主构建脚本：

```
<project name="Retain" basedir="." default="main">
  <target name="main">
    <ant dir="SharedJava" antfile="ant.xml" target="clean"/>
    <ant dir="SharedJava" antfile="ant.xml" target="copy_current"/>
    <ant dir="GWEasySoap" antfile="ant.xml" target="clean"/>
    <ant dir="GWEasySoap" antfile="ant.xml" target="copy_current"/>
    <ant dir="RetainLib" antfile="ant.xml" target="clean"/>
    <ant dir="RetainLib" antfile="ant.xml" inheritAll="false"  target="copy_current"/>
    <ant dir="RetainIndex" antfile="ant.xml" target="clean"/>
    <ant dir="RetainIndex" antfile="ant.xml" target="copy_current"/>
    <ant dir="RetainPersist" antfile="ant.xml" target="clean"/>
    <ant dir="RetainPersist" antfile="ant.xml" target="copy_current"/>
  </target>
</project> 
```

实际发生的情况：

前几个子项目运行良好。`RetainLib`, 实际上，它需要引用`SharedJava`' 的 jar，然后失败，抱怨它如何找不到它。当我删除`RetainLib`时，`RetainIndex`失败了，抱怨你不应该在 1.4 目标文件中使用泛型。

在玩了之后，我很简单地确定这些是坚持在内部运行编译目标`ant-commons`而不是被覆盖的目标。

为什么？我怎样才能解决这个问题？（我的意思是优雅的 - 显然我可以完全取消使用 ant-commons，我敢打赌一切都会奏效。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-18T04:32:51.717

我建议在任务上使用**inheritAll="false"**属性。您看到的问题与主文件的 basedir 和其他属性导致子项目的相对路径问题有关。

我也会放弃**dir=".."**属性以确保基于子项目的获胜。

所以这就是我要做的......

```
<project name="Retain" basedir="." default="main">
  <target name="main">
    <ant antfile="SharedJava/ant.xml" target="clean" inheritAll="false"/>
    <ant antfile="SharedJava/ant.xml" target="copy_current" inheritAll="false"/>
    <ant antfile="GWEasySoap/ant.xml" target="clean" inheritAll="false"/>
    <ant antfile="GWEasySoap/ant.xml" target="copy_current" inheritAll="false"/>
    ...
  </target>
</project> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-13T03:51:07.910

我从事过一个与此类似的项目，所做的是创建一个构建目录，其中放置了所有 ant 任务的输出，它运行良好。如果没有关于构建文件内部发生的事情的额外信息，将很难提供额外的洞察力

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-08T10:32:20.860

每个调用都会打开一个新的 ant 实例。即使“SharedJava”在 ant-commons.xml 中做了一些覆盖，其他脚本也看不到它。您可以尝试在基本脚本中包含 ant-commons.xml 并使用子子句中的值，因为有些是继承的。对于不可继承的值，例如路径，您可以使用命名参数之类的东西：

```
<ant antfile="${check.build.file}" target="validateXml">
   <property name="p.check_dir" location="${project.base.dir}" />
   <property name="p.dtd_dir" location="${build.data.dir}" />
</ant> 
```

我选择在外部脚本的任务中没有依赖关系，而是在它们的调用中表示为参数的那些。

# php - PHP：使用 PHP 将文件保存到不同的根目录？

> ID：748915
> 
> 赞同：0
> 
> 时间：2009-04-14T19:02:42.737
> 
> 标签：php, php4

好的，当我通过 move_uploaded_file() 使用 PHP 保存上传的文件时，我不能使用绝对 URL，我必须使用相对 URL。我的网站有 2 个根目录，一个用于 http 端，一个用于 https 端：分别为 httpdocs 和 httpsdocs。因此，如果我的脚本在 https 端，我如何将文件保存到 http 端的位置？

谢谢！

**更新** 好的所以看起来我使用了错误的绝对路径约定我这样做是这样的：

```
$dir = 'https://www.mydomain.com/masonic_images/';
move_uploaded_file($_FILES['blue_image']['tmp_name'], $dir.$new_name); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T19:12:14.760

[`move_uploaded_file()`](http://php.net/move_uploaded_file)不接受任一参数的 URL。目标是文件系统上的绝对路径。

```
<?php
$dir = '/var/www/httpsdocs/'; // Adjust to your configuration
move_uploaded_file($_FILES['blue_image']['tmp_name'], $dir.$new_name); 
```

正如[@apphacker 所](https://stackoverflow.com/questions/748915/php-saving-files-with-php-to-different-root-directory/748936#748936)建议的那样。您可以使用它[`realpath(__FILE__)`](http://php.net/realpath)来确定文件的绝对路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T19:09:16.013

如果因为不知道绝对路径是什么而不能使用绝对路径，可以使用 PHP 的 realpath() 找出它是什么然后使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T19:09:32.707

httpdocs 和 httpsdocs 目录是否都位于同一个父文件夹中？如果是这样，只需为 move_uploaded_file 中的第二个参数使用相对路径即可将文件放在另一个根目录中。

例如：

```
$uploaddir = '../httpdocs/';
$uploadfile = $uploaddir . basename($_FILES['myfile']['name']); 
```

此代码假定上传脚本位于 httpsdocs 根目录中，并且您希望将文件保存到 httpdocs 目录中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T21:02:46.647

请注意，由于您将上传`httpdocs`的文件放入其中，因此可以上传 php 文件并执行任意代码。

# c# - 无法部署新的 SharePoint 网站模板程序集版本

> ID：748924
> 
> 赞同：2
> 
> 时间：2009-04-14T19:04:54.917
> 
> 标签：c#, visual-studio-2008, sharepoint, assemblies, deployment

我构建了我的 SharePoint 网站模板解决方案程序集并成功将其部署到 SharePoint，版本为 6.4.0.2032。我做了一些测试，发现我的代码存在一些问题。我解决了这些问题。通过“setup.bat /uninstall”卸载了我的解决方案。将我的程序集重建到版本 6.4.0.2033。我再次成功安装了我的新模板，但在尝试将我的一个 web 部件添加到页面时，SharePoint 继续寻找我的程序集的旧版本。

我错过了一步吗？

以下是 C:\Program Files\Common Files\Microsoft Shared\web server extensions\12\LOGS 中日志的片段：

```
04/08/2009 13:04:58.18  w3wp.exe (0x0AA8)                           0x0BE4  Windows SharePoint Services     Web Parts                       8l4f    Monitorable Error importing WebPart. Assembly  SharePoint.Site, Version=6.4.0.2032, Culture=neutral, PublicKeyToken=db45c0486d0dc06d, TypeName. SharePoint.Site.MetadataSearch, SharePoint.Site, Version=6.4.0.2032, Culture=neutral, PublicKeyToken=db45c0486d0dc06d 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-12T13:49:48.743

当使用“setup.bat /uninstall”删除以前的版本时，我注意到 WebPart 的相应“.webpart”文件没有被删除。当新版本被重新分解时，这些“.webpart”文件不会得到更新并继续指向以前的程序集版本。

要查看您的 Web 部件引用的程序集版本：

1.  在 SharePoint 中打开顶级网站设置（网站操作 > 网站设置 > 转到顶级网站设置）
2.  单击“图库”列下的“Web 部件”
3.  单击 Web 部件旁边的“编辑”图标
4.  单击“查看 XML”工具栏按钮

您应该能够在编译的解决方案中找到相应的新“.webpart”文件（它应该引用您的新程序集）。然后只需将其上传到此 Web 部件库列表（记得勾选“覆盖现有文件”）

如果找不到“.webpart”文件，您可以随时从“Web 部件库”下载副本并手动修改它。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T20:34:02.407

在 SharePoint 中，您有很多对程序集的引用。一些存储在磁盘上的文件中（布局文件中的页面引用），而另一些存储在内容数据库中（内容文件中的页面引用）。当您使用解决方案框架进行部署时，SharePoint 还会将 SafeControls 添加到 web.config 文件中。这些条目通过其强名称引用程序集。

我的经验是，您应该避免更改 SharePoint 解决方案的程序集版本 - 这将为您省去各种麻烦。要跟踪程序集版本，您应该改用程序集文件版本。这不会导致 SharePoint 出错。

我提到解决方案升级了吗？只需考虑在您的 Web 部件已添加到数十个页面的场中升级程序集。所有这些页面都将引用旧程序集，并且可能会在升级后导致未处理的错误。

程序集文件版本属性在 AssemblyInfo.cs 文件中设置：

```
[assembly: AssemblyVersion("6.0.0.0")]
[assembly: AssemblyFileVersion("6.4.0.2033")] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T20:49:22.763

您的 web.config 文件中引用了哪个版本？仔细检查它是否是您期望的版本 (6.4.0.2033)。做一个 IIsrest 并再试一次。

# .net - IIS 应用程序池 PID

> ID：748927
> 
> 赞同：50
> 
> 时间：2009-04-14T19:05:43.153
> 
> 标签：.net, iis, application-pool, pid

是否有人熟悉获取与进程 ID 关联的应用程序池的方法？我正在使用 Win32_Process 查询 W3WP 服务并返回 PID 现在我正在尝试获取与之关联的应用程序池。

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2009-09-14T11:41:08.257

在 Windows Server 2008 上，这已更改。

在 systemroot\system32\inetsrv 你找到 appcmd.exe

使用

> appcmd 列表 wp

您将获得所有工作进程的列表以及它们正在服务的应用程序池。

您可能需要在具有管理员权限的 shell 中运行它。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-14T19:19:31.170

如果您只是使用命令行来解决问题，您也可以这样做：

该脚本已放置在 Windows Server 2003 上的 systemroot\system32 中，因此只需转到您的命令提示符并输入 iisapp.vbs（.vbs 是可选的），您将获得所有应用程序池信息的即时列表一直想知道。如果 CScript 不是您的默认 WSH 脚本宿主，您可能需要键入 cscript iisapp.vbs。

让我们看一个输出示例：

```
W3WP.exe PID: 1468 AppPoolId: AppPoolForSite1.com
W3WP.exe PID: 3056 AppPoolId: AppPoolForSite2.com
W3WP.exe PID: 1316 AppPoolId: AppPoolForSite3.com 
```

微软直接从马口中记录[了这一点](http://www.microsoft.com/resources/documentation/WindowsServ/2003)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-10-11T14:52:39.093

我刚刚发现您也可以在 IIS 7 的 UI 中找到它。选择您的 Web 服务器节点并打开“工作进程”。这将显示每个应用程序池的名称及其进程 ID 和利用率详细信息。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-10-22T23:12:07.433

如果您在 Windows Server 2008 上运行并且您只希望 PID 提供给另一个脚本或命令，您可以使用它：

```
c:\windows\system32\inetsrv\appcmd list wps /apppool.name:"My Application Pool" /text:WP.NAME 
```

例如，要创建一个批处理脚本来创建特定应用程序池的内存转储，请使用以下命令：

```
c:\windows\system32\inetsrv\appcmd list wps /apppool.name:"My Application Pool" /text:WP.NAME > "%temp%\pid.txt"
for /F %%a in (%temp%\pid.txt) do c:\debugger\adplus.exe -hang -o d:\dumps -p %%a
pause 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-12-08T20:10:03.270

可以使用任务管理器查看进程运行的用户名（一般与应用池名称相同）和进程ID，但必须在任务管理器中开启这些列，而且还假设进程运行的用户名与应用程序池名称相同（据我所知，这是默认值，除非使用 Sharepoint 等）。
另请注意，此页面中列出的所有方法可能仅显示当前正在运行的进程，这意味着如果您的特定进程由于空闲时间而关闭，您必须首先使用该站点才能在列表中显示该进程，在您的情况下，这意味着您应该首先访问所有站点以确保与它们关联的进程正在运行。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-14T19:10:31.097

```
ServerManager serverManager = new ServerManager();
ApplicationPoolCollection applicationPoolCollection = serverManager.ApplicationPools; 
```

尝试使用它，它应该可以满足您的需求。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-02-02T15:14:52.173

打开 IIS 管理器（运行 > Inetmgr），从左侧站点导航树中选择根级别，然后从“功能视图面板”中选择“工作进程”</p>

单击“工作进程”以获取当前正在运行的所有工作进程的详细信息

从此列表中，您将获得应用程序池名称、进程 ID

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-06-01T17:03:59.593

这应该这样做。

```
public string getAppPoolName(int pid)
{            
    ServerManager serverManager = new ServerManager();

    ApplicationPoolCollection apc = serverManager.ApplicationPools;

    foreach (var app in apc)
    {
        var workers = app.WorkerProcesses;

        foreach (var w in workers)
        {                   
            if (w.ProcessId == pid)
            {
                return app.Name;
            }
        }
    }

    return string.Empty;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-01-18T02:13:02.550

PID 和应用程序池给出其名称：

```
$AppPoolName = 'AppPoolForSite1'
(Get-ItemProperty IIS:\AppPools\$AppPoolName -Name WorkerProcesses).Collection.processId 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-17T14:23:48.637

如果您有多个应用程序池并且想知道每个应用程序池的 PID。您可以运行下面的 powershell，它将遍历机器上的所有应用程序池，查询 PID，并以漂亮的表格格式显示应用程序池名称和 PID。

```
import-module webadministration

$dirs = dir IIS:\AppPools\

foreach($dir in $dirs)
{
    Write-Output([pscustomobject]@{
        Name = $dir.Name
        PID = (dir IIS:\AppPools\$($dir.Name)\WorkerProcesses).ProcessId
    })
} 
```

# java - Java Netscape LDAP 删除

> ID：748937
> 
> 赞同：0
> 
> 时间：2009-04-14T19:09:22.690
> 
> 标签：java, ldap

我一直在使用 Java Netscape LDAP 库来修改 LDAP 条目（[http://www.mozilla.org/directory/javasdk.html](http://www.mozilla.org/directory/javasdk.html)）。我现在需要一种删除条目的方法。我浏览了图书馆，但找不到任何我认为可行的东西。

找到“LDAPDelete”，但它看起来像是从命令行使用的。

如果有人可以发布一些如何使用对象 ID 执行此操作的示例代码，那将非常有帮助。

添加：搜索并找到对象后，我使用 getDN() 方法的返回值作为 DN 字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T19:29:16.857

看看`LDAPConnection.delete(java.lang.string dn)`这就是您应该用来删除条目的内容。

在伪代码中：

```
LDAPConnection myCon = new LDAPConnection("192.168.1.1",389);
myCon.delete("cn=Alan,ou=engineers,dc=fool,dc=com"); 
```

你必须对那个例子进行javify，但这应该可以。

[网景目录 API 文档](http://docs.sun.com/source/816-5618-10/netscape/ldap/LDAPConnection.html#delete(java.lang.String))

# asp.net-mvc - 实体框架中的字段最大长度

> ID：748939
> 
> 赞同：23
> 
> 时间：2009-04-14T19:09:43.983
> 
> 标签：asp.net-mvc, entity-framework

我需要使用带有实体框架的 ASP.NET MVC 在我的视图上的测试字段上设置最大长度，但我找不到如何获取 varchar 字段的最大长度。

有没有一种简单的方法来获取它，或者数据库字段的任何其他属性

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-21T13:21:35.697

这是我如何做到的（在实体上使用扩展方法）：

```
public static int? GetMaxLength(this EntityObject entite, string nomPropriete)
    {
        int? result = null;
        using (XEntities contexte = XEntities.GetCurrentContext())
        {
            var queryResult = from meta in contexte.MetadataWorkspace.GetItems(DataSpace.CSpace)
                               .Where(m => m.BuiltInTypeKind == BuiltInTypeKind.EntityType)
                              from p in (meta as EntityType).Properties
                                 .Where(p => p.DeclaringType.Name == entite.GetType().Name
                                     && p.Name == nomPropriete
                                     && p.TypeUsage.EdmType.Name == "String")
                              select p.TypeUsage.Facets["MaxLength"].Value;
            if (queryResult.Count() > 0)
            {
                result = Convert.ToInt32(queryResult.First());
            }
        }
        return result;
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T19:27:46.767

**更新**

我意识到这个答案并不直接适用于 EF。在我回答的时候，大约 20 分钟没有答案，我想知道我是如何用 LINQToSQL 解决类似问题的可能会有所帮助。鉴于 OP 基本上使用了相同的技术，尽管使用了 EF 属性，这似乎表明我做出了正确的选择。我将这个答案留在这里作为上下文，以及那些遇到同样问题但使用 LINQToSQL 的人。

**原来的**

我不了解 EF，但是 LINQToSQL 实体属性是用 ColumnAttributes 装饰的。您可以通过查看 CustomAttributesCollection 从属性的 PropertyInfo 中获取 ColumnAttribute。该属性的值需要解析长度。我在我的验证器类中这样做是为了确保我不会因为使用对我的列来说太长的字符串而出现 SQL 错误。

这是我用来提取字符串属性的列长度的方法。

```
 public static int MaximumPropertyLength( Type type, string propertyName )
    {
        int maximumLength = -1;
        PropertyInfo info = type.GetProperty( propertyName, BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance );
        if (info != null)
        {
            var attribute = info.GetCustomAttributes( typeof( ColumnAttribute ), false )
                                .Cast<ColumnAttribute>()
                                .FirstOrDefault();
            if (attribute != null)
            {
                maximumLength = ExtractLength( attribute.DbType );
            }
        }
        return maximumLength;
    }

    private static int ExtractLength( string dbType )
    {
        int max = int.MaxValue;
        if (dbType.Contains( "(" ))
        {
            string[] parts = dbType.Split( new char[] { '(', ')' }, StringSplitOptions.RemoveEmptyEntries );
            if (parts.Length > 1)
            {
                int.TryParse( parts[1], out max );
            }
        }
        return max;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T02:34:50.073

对于 EntityFramework，您需要使用代码生成器或 T4 模板将您自己的自定义属性添加到类中。

那么 tvanfosson 上面所说的将是正确的。默认情况下，EF 不会保留此信息。

[http://blogs.msdn.com/adonet/archive/2008/01/24/customizing-code-generation-in-the-ado-net-entity-designer.aspx](http://blogs.msdn.com/adonet/archive/2008/01/24/customizing-code-generation-in-the-ado-net-entity-designer.aspx)

用您的代码生成器解释我在谈论的更多内容。我已经完成了您之前提到的事情，这非常漂亮，问题出在专有代码上，所以我没有为您提供示例。

# java - 当通过 -Xmx 分配更多内存时，Sun JVM 是否会变慢？

> ID：748940
> 
> 赞同：10
> 
> 时间：2009-04-14T19:10:03.237
> 
> 标签：java, jvm, performance

当更多内存可用并通过 -Xmx 使用时，Sun JVM 是否会变慢？（假设：机器有足够的物理内存，所以虚拟内存交换不成问题。）

我问是因为我的生产服务器要接受内存升级。我想将 -Xmx 的值提高到*颓废*的程度。这个想法是为了防止由于我自己不时发生的编程错误而导致任何堆空间耗尽失败。罕见的事件，但如果我有一个淫秽的 -Xmx 值，比如 2048mb 或更高，我快速发展的 web 应用程序可以避免它们。该应用程序受到严格监控，因此会注意到 JVM 内存消耗的异常峰值并修复任何缺陷。

可能的重要细节：

*   Java 6（在 64 位模式下运行）
*   4核至强
*   RHEL4 64 位
*   春天，休眠
*   高磁盘和网络IO

***编辑****：我试图避免发布我的 JVM 的配置，但显然这使问题变得荒谬可笑。因此，我们在这里使用相关的配置参数：*

```
-Xms256m 
-Xmx1024m 
-XX:+UseConcMarkSweepGC 
-XX:+AlwaysActAsServerClassMachine 
-XX:MaxGCPauseMillis=1000 
-XX:MaxGCMinorPauseMillis=1000 
-XX:+PrintGCTimeStamps 
-XX:+HeapDumpOnOutOfMemoryError 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T19:34:09.403

通过添加更多内存，堆满需要更长的时间。因此，它将减少垃圾收集的频率。但是，根据您的对象的致命程度，您可能会发现执行任何一次 GC 所需的时间会增加。

GC 需要多长时间的主要因素是有多少*活动*对象。因此，如果几乎所有对象都在年轻时死亡，并且一旦建立，它们都没有逃脱年轻堆，那么您可能不会注意到执行 GC 所需的时间有多大变化。但是，每当您必须循环使用永久堆时，您可能会发现一切都停止了不合理的时间，因为这些对象中的大多数仍然存在。相应地调整大小。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T19:33:00.950

如果您只是在问题上投入更多内存，您的应用程序将获得更好的吞吐量，但如果您不在使用 CMS 垃圾收集器的多核系统上，您的响应速度可能会下降。这是因为会发生更少的 GC，但他们会有更多的工作要做。好处是您将通过 GC 释放更多内存，因此分配将继续非常便宜，因此吞吐量更高。

顺便说一句，您似乎混淆了 -Xmx 和 -Xms。-Xms 只是设置初始堆大小，而 -Xmx 是您的最大堆大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T19:18:42.090

更多内存通常可以在垃圾收集环境中为您提供更好的性能，至少只要这不会导致虚拟内存使用/交换。

GC 只跟踪引用，而不是内存本身。最后，VM 将分配相同数量的（主要是短暂的、临时的）对象，但垃圾收集器需要更少地调用——因此垃圾收集器的工作总量不会更多——甚至更少，因为这也有助于使用弱引用的缓存机制。

我不确定是否还有 64 位的服务器和客户端 VM（有 32 位），所以您可能也想调查一下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T04:36:26.540

根据我的经验，它不会减慢速度，但 JVM 会一直尝试缩减到 Xms 并尝试保持在下边界或接近。因此，如果您可以努力，也可以使用 Xms。Sun 建议两者尺寸相同。添加一些 -XX:NewSize=512m （只是一个虚构的数字）以避免在老年代中昂贵的旧数据堆积，从而导致更长/更重的 GC。我们正在使用 700 MB NewSize 运行我们的 Web 应用程序，因为大多数数据都是短暂的。

所以，底线：我不希望放慢速度，而是让你的更多记忆发挥作用。设置一个更大的新大小区域并将 Xms 设置为 Xmx 以降低 GC 的压力，因为它不需要尝试削减到 Xms 限制...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T07:27:01.920

如果您增加 -Xmx，它通常不会帮助您提高性能/吞吐量。理论上可能会有更长的“停止世界”阶段，但在实践中，CMS 并不是一个真正的问题。

当然你不应该将 -Xmx 设置为像 300Gbyte 这样的疯狂值，除非你真的需要它:)

# ajax - setAttribute、onClick 和跨浏览器兼容性

> ID：748941
> 
> 赞同：5
> 
> 时间：2009-04-14T19:10:25.013
> 
> 标签：ajax, dom, setattribute

我已经阅读了许多关于此的帖子，但没有任何可靠的答案。这是我的代码：

```
// button creation
onew = document.createElement('input');
onew.setAttribute("type", "button");
onew.setAttribute("value", "hosts");
onew.onclick = function(){fnDisplay_Computers("'" + alines[i] + "'"); }; // ie
onew.setAttribute("onclick", "fnDisplay_Computers('" + alines[i] + "')"); // mozilla
odiv.appendChild(onew); 
```

现在，setAttribute() 方法（带有 mozilla 注释）在 mozilla 中可以正常工作，但前提是它位于它上面的行之后。所以换句话说，它似乎只是默认为最后设置的那个。.onclick 方法（带有 ie 注释）在这两种情况下都不起作用，我是否使用不正确？

无论哪种方式，我都找不到在 IE 中完成这项工作的方法，更不用说两者了。我在使用 .onclick 方法时确实更改了函数调用，并且仅使用对警报函数的简单调用就可以正常工作，这就是为什么我认为我的语法不正确的原因。

长话短说，我无法让 onclick 参数在 IE/Mozilla 之间保持一致。

——尼古拉斯

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-14T20:32:24.550

> onew.setAttribute("类型", "按钮");

切勿在 HTML 文档上使用 setAttribute。IE 在很多情况下都犯了严重错误，而且 DOM-HTML 属性更短、更快且更易于阅读：

```
onew.type= 'button'; 
```

> onew.onclick = function(){fnDisplay_Computers("'" + alines[i] + "'"); }; // IE

什么是“直线”？为什么要将其转换为字符串并用单引号括起来？看起来您正在尝试做一些令人发指的事情，涉及评估字符串中的代码（这就是您在下面的“onew.setAttribute”版本中所做的事情）。在字符串中评估 JavaScript 代码几乎总是错误的；像瘟疫一样避免它。在上述情况下，IE 应该和 Firefox 一样：它不应该工作。

如果 'alines[i]' 是一个字符串，我猜你想要做的是通过构造一个代码字符串来记住该字符串，该字符串将在 JavaScript 中评估为原始字符串。但：

```
"'" + alines[i] + "'" 
```

是不够的。如果 'alines[i]' 中有撇号或反斜杠会怎样？

```
'O'Reilly' 
```

你有一个语法错误和可能的安全漏洞。现在，你可以做一些费力和烦人的事情，比如：

```
"'" + alines[i].split('\\').join('\\\\').split("'").join("\\'") + "'" 
```

尝试转义字符串，但它很丑陋并且不适用于其他数据类型。你甚至可以让 JavaScript 为你做这件事：

```
uneval(alines[i]) 
```

但并非所有对象都可以转换为可评估的 JavaScript 源字符串；基本上整个方法注定要失败。

如果您只想让 onclick 回调调用带参数的函数，通常的做法是直接编写代码：

```
onew.onclick= function() {
    fnDisplay_Computers(alines[i]);
}; 
```

通常这会起作用，并且是您想要的。但是，您可能在此处遇到了轻微的皱纹，这可能会让您感到困惑，以考虑使用弦乐的古怪方法。

即，如果在这种情况下“i”是封闭“for”循环的变量，则对“alines[i]”的引用不会像你想象的那样做。当点击发生时，回调函数将访问“i”——这是*在*循环完成之后。此时，“i”变量将保留其在循环结束时的任何值，因此“alines[i]”将始终是“alines”的最后一个元素，无论单击哪个“新”。

（请参阅[如何在 ActionScript 3 (AS3) 中修复闭包问题，](https://stackoverflow.com/questions/422784)了解有关此问题的一些讨论。它是 JavaScript 和 Python 中与闭包混淆的最大原因之一，总有一天应该在语言级别上修复。）

您可以通过将闭包封装在自己的函数中来解决循环问题，如下所示：

```
function callbackWithArgs(f, args) {
    return function() { f.apply(window, args); }
}

// ...

onew.onclick= callbackWithArgs(fnDisplay_Computers, [alines[i]]); 
```

在更高版本的 JavaScript 中，您将能够简单地说：

```
onew.onclick= fnDisplay_Computers.bind(window, alines[i]); 
```

如果您希望能够在今天的浏览器中使用“Function.bind()”，您可以从[Prototype](http://www.prototypejs.org/)框架中获得一个实现，或者只使用：

```
if (!('bind' in Function.prototype)) {
    Function.prototype.bind= function(owner) {
        var that= this;
        var args= Array.prototype.slice.call(arguments, 1);
        return function() {
            return that.apply(owner,
                args.length===0? arguments : arguments.length===0? args :
                args.concat(Array.prototype.slice.call(arguments, 0))
            );
        };
    };
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-14T19:18:52.170

我通常使用类似的东西：

```
onew.onclick = new Function("fnDisplay_Computers('" + alines[i] + "')"); 
```

这应该适用于 IE e Firefox。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T19:17:48.863

基于 Mozilla 的浏览器使用[`addEventListener()`](https://developer.mozilla.org/En/DOM:element.addEventListener)带“ ”的函数`click`作为参数，IE 使用带“ ”的函数；我发现最好使用 try/catch 语句，例如：`type`[`attachEvent()`](http://msdn.microsoft.com/en-us/library/ms536343(VS.85).aspx)`onclick``sEvent`

```
try {
  onew.attachEvent("onclick", //For IE
                   function(){fnDisplay_Computers("'" + alines[i] + "'"); });
}
catch(e) {
  onew.addEventListener("click", //For Mozilla-based browsers
                   function(){fnDisplay_Computers("'" + alines[i] + "'"); },
                   false);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-24T16:21:45.493

我认为＃3抗议太多了。在很多情况下，我正在动态构建一个表并且需要将参数传递给回调函数。这不是类型安全问题，因为我的变量 parm 是相关表行的整数索引。这是具有似乎跨浏览器兼容的变量和固定参数的代码：

```
for (i = 0; i < arrTableData.length; i++) {
    eleTR = objTable.insertRow(i + 1);
    cell = eleTR.insertCell(0);
    cell.width = "21";
    var myElement = document.createElement('img');
    myElement.setAttribute('src', 'images/button_down.gif');
    myElement.setAttribute('alt', 'Move item down');
    myElement.onclick = new Function('moveItem(' + i + ',0)');
    cell.appendChild(myElement);
} 
```

# http - 当单击浏览器中的链接时，如何获取由 word 文档中的 url 创建的 http 会话

> ID：748944
> 
> 赞同：1
> 
> 时间：2009-04-14T19:11:32.000
> 
> 标签：http, session, servlets, ms-word

我有一个基于 servlet 的应用程序，它创建一个会话并在第一次访问它时存储一些信息。此信息用于后续页面。如果从 msword 文档中单击初始 url，则该过程会遇到麻烦。servlet 创建一个会话并将响应发回。响应显示在新打开的浏览器中。从浏览器内部单击的链接会创建一个新会话。从浏览器单击的任何后续 url 都会重用第二个会话

有没有办法强制服务器识别第二个请求的初始会话？

我创建了一个示例 servlet，它检索会话并将 ID 连同一个新链接一起写入以回调自身。

下面是测试servlet

```
public class SessionServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response)  throws ServletException, IOException {
        StringBuffer sb = new StringBuffer();
        sb.append("<HTML>\r\n<HEAD>\r\n<title>\r\nServlet Session Test\r\n</title>\r\n");
        sb.append("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\r\n");
        sb.append("</HEAD>\r\n<BODY>\r\n");

        HttpSession userSession = request.getSession(true);

        if (userSession.isNew()) {
            sb.append("User Session is new\r\n");
        } else {
            sb.append("User Session is old\r\n");
        }
        sb.append("<br>User Session ID = " + userSession.getId() + "<BR>");

        sb.append("URL <a href=\"http://localhost:9080/myTestApp/SessionTest\"> Session Test </a>");
        sb.append("</BODY> </HTML>\r\n");

        response.setContentType("text/html; charset=UTF-8");
        ServletOutputStream sos = response.getOutputStream();
        sos.write(sb.toString().getBytes("UTF-8"));
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T03:14:33.400

安装像[Fiddler](http://www.fiddler2.com/fiddler2/)这样的 Web 调试器或进行[Wireshark](http://www.wireshark.org/)捕获，我敢打赌您的 JSESSIONID cookie 不会在 HTTP 请求上发送。我已经通过在 IE 中打开的 Microsoft Word 的链接看到了这一点。

我所做的是将您的代码更改为`request.getSession(false)`，如果您`null`返回，则`response.sendRedirect`使用附加到 URL 的附加查询字符串参数（例如 newSession=true）返回自己。当请求返回这个附加参数时，然后执行`request.getSession(true)`. 希望这会找到您现有的会话，但如果没有，它将创建一个新会话。请注意不要将您的代码置于无限的 sendRedirect 循环中。这是因为当 IE 发出第二个 HTTP 请求时，它会发送 cookie。

# authentication - 什么时候应该重置经过身份验证的用户？

> ID：748948
> 
> 赞同：0
> 
> 时间：2009-04-14T19:12:23.760
> 
> 标签：authentication, login

在我的 Web 应用程序中，我使用了 asp Login 控件来简化登录过程。我注意到，如果我在浏览器中打开该站点并登录，然后打开另一个浏览器并转到该站点，那么第二个浏览器显示我已经登录，即使我没有使用该浏览器登录. 我注意到其他一些网站（例如我的银行的网络访问）以这种方式工作，但对我来说仍然很奇怪。我不确定它是否不好，但这很奇怪。

这种行为不好吗？

我还注意到，如果我关闭所有浏览器，然后打开一个新浏览器并访问该站点，我就没有登录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T19:21:40.820

This is because those sites use session cookies. If you open *different* brwosers at the same time, such as FireFox, Opera, Chrome and IE, you'll have to log in in all of the browsers independently. However, when re-using the same browser application, this usually does not spawn a new process with its own session data but rather re-uses the already open browser.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T19:23:08.647

If you are using a browser that supports multi-tabbed sessions e.g. IE7+, Firefox etc, you will find that, if you have the same ASP.NET website open in multiple tabs, each tab will share the same authentication credentials. This is because the session ID applies to the browser instance, not the tab instance, so if a user logs in on 1 tab, then opens up another tab to the website, they won't have to provide their credentials twice.

I don't think there's an easy way around this behaviour. You could choose employ cookie 'munging', storing the forms authentication ticket on the URL, but this seems like a bad idea from a security POV.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T20:39:05.643

Lucero 和 pmarflee 都是正确的。

不过，要提供更多信息：

Firefox 将在选项卡和所有浏览器实例之间共享会话

IE 8 还将在选项卡和所有浏览器实例之间共享会话

IE 7 在选项卡之间共享会话，但不跨实例

IE 6 不跨实例共享会话

我不确定 Opera、Chrome 或 Safari 如何处理会话。

# objective-c - 使用 Cocoa 检测正在运行的应用程序何时播放音频

> ID：748949
> 
> 赞同：5
> 
> 时间：2009-04-14T19:13:31.823
> 
> 标签：objective-c, cocoa, macos, audio

我正在考虑编写一个作为后台进程运行并检测应用程序（例如 Safari）何时播放音频的应用程序。我可以`NSWorkspace`用来获取当前正在运行的应用程序的进程 ID，但在检测这些进程在做什么时我不知所措。我假设有一种方法可以监听进程并检测对象正在发送的公共消息。我为我对这个问题的无知道歉。

有没有人尝试过这样的事情或知道任何可以提供帮助的资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T19:51:27.940

[SoundFlower](https://github.com/mattingalls/Soundflower)是一个开源项目，它允许 Mac OS X 应用程序相互传递音频。它几乎肯定会做一些类似于你描述的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T14:14:33.507

我认为您的“答案”根本不是答案...

并且有一个答案（不是“42”）

这样做的最佳选择是编写一个直通音频输出设备。实际上，很像soundflower。因此，您的音频输出设备将加载实际的（物理）音频输出设备并将音频数据直接传递给它（当然，在首先查看音频流之后！）。那么您只需要说服您的用户将您的音频设备配置为默认音频输出设备，以便大多数播放声音的应用程序会自动使用它。瞧……

您的音频处理功能可能只是在将缓冲区传递给实际输出设备之前对缓冲区进行快速 RMS。并且当音频功率超过某个阈值时（可能是苹果音频硬件的 -54dB 之类的），那么您就知道某个应用正在发出声音。

|K<

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T19:20:37.180

我在另一个线程上被告知，虽然这是可能的，但这是一种非常先进的技术，不推荐使用。这将涉及使用[应用程序增强器 (APE)](http://www.unsanity.com/haxies/ape/)，并且被认为不是“好”的事情。看起来这个应用程序的想法注定要成为天空中的大回收站 :)

# python - 如何在 Google App Engine 中获取具有所需属性的类型的所有实体？

> ID：748952
> 
> 赞同：0
> 
> 时间：2009-04-14T19:14:12.943
> 
> 标签：python, google-app-engine, data-modeling, entity

我有一个模型，它具有如下所需的字符串属性：

```
class Jean(db.Model):
    sex = db.StringProperty(required=True, choices=set(["male", "female"])) 
```

当我尝试调用 Jean.all() 时，python 抱怨没有必需的属性。

当然，必须有一种方法可以得到所有这些。

如果史蒂夫是正确的（他的回答确实有道理）。我如何确定这是否真的导致了问题。如何找出我的数据存储区中的确切内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T19:27:43.113

也许您在数据存储中有没有性别属性的旧数据（在您指定所需属性之前添加），然后系统抱怨有一个没有性别属性的条目。

尝试添加一个默认值：

```
class Jean(db.Model):
    sex = db.StringProperty(required=True, choices=set(["male", "female"]), default="male") 
```

我希望它有所帮助。

/edit：转到本地数据存储查看器（默认位于[http://localhost:8080/_ah/admin/](http://localhost:8080/_ah/admin/)）并列出您的实体。您可以尝试通过填充缺失的属性来手动修复问题（如果可能）。

# servlets - 如何为 selenium 核心创建 /postResults servlet

> ID：748958
> 
> 赞同：0
> 
> 时间：2009-04-14T19:15:39.757
> 
> 标签：servlets, selenium

我查看了文档，它所说的只是创建一个 servlet……用什么？

我需要为此 servlet 使用代码吗？

它是否只需要为空白并具有 postResults 的名称？

是否有为此提供的 ant 脚本？

我在 google 或 selenium 的网站上找不到任何可以让我参与其中的内容。

谢谢

更新：我找到了以下示例

```
 <servlet>
        <servlet-name>postResults</servlet-name>
        <servlet-class>com.thoughtworks.selenium.results.servlet.SeleniumResultsServlet</servlet-class>

        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>postResults</servlet-name>
        <url-pattern>/postResults</url-pattern>
    </servlet-mapping> 
```

但是，我似乎在我的硒罐中的任何地方都找不到这个 Class 文件。我有 RC 和常规核心下载，但没有骰子。我从哪里得到这个 jar 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T12:33:31.497

如果您像我一样使用 Selenium 的纯 html/javascript 功能，那么您知道在测试时您不会得到结果报告，除非您在某处设置了 postResults servlet 来将结果推送到。

我通过拆开 fitRunner 插件来确定我需要什么来进行设置，从而找到了解决方案。

这是一个java解决方案顺便说一句。

[http://jira.openqa.org/browse/SEL-102](http://jira.openqa.org/browse/SEL-102)你可以在这里下载一个 zip 文件，里面有你需要的一切和一堆你不需要的东西。

在您的 web 应用程序中，只需将您在 web.xml 中找到的 servlet 映射添加到您的 web 应用程序。确保您的参考包创建如下

然后，如果您还没有这些 jar，您将在 zip 中找到它们，然后将它们添加到您的 Web 应用程序库中。

jstl.jar 和standard.jar

创建两个类 your.package.path.SeleniumResultServlet

在其中粘贴以下代码。

```
package com.your.package.path;

import java.io.IOException;
import java.util.Collection;
import java.util.LinkedList;
import java.util.List;

import javax.servlet.ServletException;
import javax.servlet.ServletOutputStream;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class SeleniumResultsServlet extends HttpServlet {

    private static TestResults results;

    public static TestResults getResults() {
        return results;
    }

    public static void setResults(TestResults testResults) {
        results = testResults;
    }

    protected void doGet(HttpServletRequest request,
            HttpServletResponse response) throws ServletException, IOException {

        if (request.getParameter("clear") != null) {
            results = null;
            ServletOutputStream out = response.getOutputStream();
            out.println("selenium results cleared!");
        } else {
            forwardToResultsPage(request, response);
        }
    }

    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
                                                throws ServletException, IOException {
        String result = request.getParameter("result");
        String totalTime = request.getParameter("totalTime");
        String numTestPasses = request.getParameter("numTestPasses");
        String numTestFailures = request.getParameter("numTestFailures");
        String numCommandPasses = request.getParameter("numCommandPasses");
        String numCommandFailures = request.getParameter("numCommandFailures");
        String numCommandErrors = request.getParameter("numCommandErrors");
        String suite = request.getParameter("suite");

        int numTotalTests = Integer.parseInt(numTestPasses) + Integer.parseInt(numTestFailures);

        List testTables = createTestTables(request, numTotalTests);

        results = new TestResults(result, totalTime,
                numTestPasses, numTestFailures, numCommandPasses,
                numCommandFailures, numCommandErrors, suite, testTables);

        forwardToResultsPage(request, response);
    }

    private List createTestTables(HttpServletRequest request, int numTotalTests) {
        List testTables = new LinkedList();
        for (int i = 1; i <= numTotalTests; i++) {
            String testTable = request.getParameter("testTable." + i);
            System.out.println("table " + i);
            System.out.println(testTable);
            testTables.add(testTable);
        }
        return testTables;
    }

    private void forwardToResultsPage(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        request.setAttribute("results", results);
        request.getRequestDispatcher("/WEB-INF/jsp/viewResults.jsp").forward(request, response);
    }

    public static class TestResults {

        private final String result;
        private final String totalTime;
        private final String numTestPasses;
        private final String numTestFailures;
        private final String numCommandPasses;
        private final String numCommandFailures;
        private final String numCommandErrors;
        private final String suite;

        private final List testTables;

        public TestResults(String postedResult, String postedTotalTime, 
                String postedNumTestPasses, String postedNumTestFailures, 
                String postedNumCommandPasses, String postedNumCommandFailures, 
                String postedNumCommandErrors, String postedSuite, List postedTestTables) {

            result = postedResult;
            numCommandFailures = postedNumCommandFailures;
            numCommandErrors = postedNumCommandErrors;
            suite = postedSuite;
            totalTime = postedTotalTime;
            numTestPasses = postedNumTestPasses;
            numTestFailures = postedNumTestFailures;
            numCommandPasses = postedNumCommandPasses;
            testTables = postedTestTables;
        }

        public String getDecodedTestSuite() {
            return new UrlDecoder().decode(suite);
        }

        public List getDecodedTestTables() {
            return new UrlDecoder().decodeListOfStrings(testTables);
        }

        public String getResult() {
            return result;
        }
        public String getNumCommandErrors() {
            return numCommandErrors;
        }
        public String getNumCommandFailures() {
            return numCommandFailures;
        }
        public String getNumCommandPasses() {
            return numCommandPasses;
        }
        public String getNumTestFailures() {
            return numTestFailures;
        }
        public String getNumTestPasses() {
            return numTestPasses;
        }
        public String getSuite() {
            return suite;
        }
        public Collection getTestTables() {
            return testTables;
        }
        public String getTotalTime() {
            return totalTime;
        }
        public int getNumTotalTests() {
            return Integer.parseInt(numTestPasses) + Integer.parseInt(numTestFailures);
        }
    }
} 
```

然后继续在同一个包中创建一个 UrlDecoder 类

```
 package your.package.path;
import java.io.UnsupportedEncodingException;import java.net.URLDecoder;
    import java.util.Iterator;
    import java.util.LinkedList;
    import java.util.List;

    /**
     * @author Darren Cotterill
     * @author Ajit George
     * @version $Revision: $
     */
    public class UrlDecoder {

        public String decode(String string) {
            try {
                return URLDecoder.decode(string, System.getProperty("file.encoding"));
            } catch (UnsupportedEncodingException e) {
                return string;
            }
        }

        public List decodeListOfStrings(List list) {
            List decodedList = new LinkedList();

            for (Iterator i = list.iterator(); i.hasNext();) {
                decodedList.add(decode((String) i.next()));
            }

            return decodedList;
        }

} 
```

在您的 web-inf 中创建一个名为 jsp 的文件夹

将 viewResults.jsp 复制到 zip 文件中。将 c.tld 复制到 /web-inf

重启你的服务器

如果您在尝试从 selenium 加载 postResults servlet 时遇到一些愚蠢的错误，请尝试将 viewResults.jsp 中的 taglib 引用更改为使用 sun url，因为不同的版本依赖关系可能无法正常工作。servlet 1.0 与 2.0 的东西。

```
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %> 
```

然后，当您运行测试运行程序并在 selenium 屏幕中选择自动选项时，您将拥有一个 postResults servlet，您可以随意使用和自定义。

希望这对其他人有帮助。在尝试创建文档时，有一种方法来格式化测试结果是一个很大的帮助，而使用常规 selenium 的 zip 文件中的东西并没有给你这个基本功能，你必须自己烘焙它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T19:28:42.830

postResults servlet 在持续集成环境中很有用，您希望将 selenium 测试结果发送到您选择的 URL（我相信在设置 selenium 测试时它是可配置的），然后让该服务器包含 selenium 结果作为构建结果。如果您不想对 selenium 测试结果进行任何后处理，那么您根本不需要设置 postResults servlet。

# java - “Spotlight”之类的 Swing 组件？

> ID：748964
> 
> 赞同：0
> 
> 时间：2009-04-14T19:17:05.403
> 
> 标签：java, user-interface, swing, components

我只是在考虑改善我们的数据输入应用程序的用户体验的方法，并考虑了一个类似 Mac OS X Spotlight 的搜索栏，它允许用户搜索任意术语并从与这些术语匹配的选项列表中进行选择。

我想象一些能够同时显示类别（如联系人、约会、邮件等）和相关结果的东西。

您是否知道任何在某处随时可用的 Swing 组件，因此我不需要再次创建 UI 部分，而是专注于实际的“搜索插件”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T20:08:04.313

喜欢搜索工具？还是“聚光灯”的视觉效果，一切都变暗了，但匹配的东西上有光？

如果您谈论的是 UI 组件，那么 O'Reilly 的“Swing Hacks”一书中有一个聚光灯示例。

如果您正在谈论搜索/索引，我会推荐 Apache Lucene。不确定有人

[编辑：我的答案就在这里被切断了吗？]

有一个现成的功能齐全的搜索结果浏览器，就像现在的 Spotlight 一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T20:28:55.713

顺便说一句，我想不出您正在查看的“现成”组件，但您可能会发现以下有趣的内容：

[小工具](http://code.google.com/p/macwidgets/)

这是“mac 风格”小部件的集合，例如类似于您在 iTunes 中找到的“抬头显示”和侧边栏列表。

您可能想尝试调整其中一些以适应您的需要。

# utf-8 - 什么是多字节字符集？

> ID：748965
> 
> 赞同：44
> 
> 时间：2009-04-14T19:17:46.103
> 
> 标签：utf-8, terminology, multibyte

术语多字节是指一个字符集，其字符可以（但不必）宽于 1 个字节（例如 UTF-8）还是指在任何情况下都大于 1 个字节的字符集（例如 UTF -16) ? 换句话说：如果有人谈论多字节字符集，这意味着什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-14T19:31:03.777

该术语含糊不清，但在我的国际化工作中，我们通常避免使用术语“多字节字符集”来指代基于 Unicode 的编码。通常，我们仅将这个术语用于具有一个或多个字节来定义每个字符的传统编码方案（不包括每个字符只需要一个字节的编码）。

通常包括 Shift-jis、jis、euc-jp、euc-kr 以及中文编码。

大多数遗留编码，除了一些例外，需要一种状态机模型（或更简单地说，页面交换模型）来处理，并且在文本流中向后移动是复杂且容易出错的。UTF-8 和 UTF-16 不会遇到这个问题，因为 UTF-8 可以使用位掩码进行测试，而 UTF-16 可以针对一系列代理对进行测试，因此在非病态文档中前后移动可以安全地完成，没有很大的复杂性。

对于泰语和越南语等语言，一些遗留编码具有多字节字符集的一些复杂性，但实际上只是建立在组合字符之上，并且通常不与广义术语“多字节”混为一谈。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-14T19:46:30.323

> 如果有人谈论多字节字符集是什么意思？

像往常一样，这取决于谁在说话！

从逻辑上讲，它应该包括 UTF-8、Shift-JIS、GB 等：可变长度编码。在这个组中通常不会考虑 UTF-16（即使它有点像，代理项是什么；当然，当通过 UTF-16LE/UTF-16BE 编码为字节时它是多个字节）。

但在 Microsoftland 中，该术语更典型地用于表示可变长度的默认系统代码页（对于遗留的非 Unicode 应用程序，遗憾的是仍然有很多）。在这种用法中，不能包含 UTF-8 和 UTF-16LE/UTF-16BE，因为 Windows 上的系统代码页不能设置为这两种编码中的任何一种。

事实上，在某些情况下，“mbcs”只不过是系统代码页的同义词，也称为“ANSI”（甚至更容易引起误解）。在这种情况下，“多字节”字符集实际上可能像 cp1252 西欧那样微不足道，每个字符只使用一个字节！

我的建议：当你有这个意思时使用“可变长度”，并避免使用模棱两可的术语“多字节”；当其他人使用它时，您需要要求澄清，但通常具有 Windows 背景的人会谈论传统的东亚代码页，如 cp932 (Shift-JIS) 而不是 UTF。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-14T19:24:15.400

您没有 1 字节 = 1 字符映射的所有字符集。所有 Unicode 变体，以及亚洲字符集都是多字节的。

有关更多信息，我建议阅读[此 Wikipedia 文章](http://en.wikipedia.org/wiki/Multi-byte_character_set)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-14T19:24:32.233

多字节字符表示其编码需要超过 1 个字节的字符。然而，这并不意味着使用该特定编码的所有字符都将具有相同的宽度（以字节计）。例如：UTF-8 和 UTF-16 编码的字符有时可能使用多个字节，而**所有**UTF-32 编码的字符**总是**使用 32 位。

参考：

*   [IBM：多字节字符](http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp?topic=/com.ibm.xlcpp8a.doc/standlib/ref/mbchar.htm)
*   [Unicode 和多字节字符集（存档）](https://web.archive.org/web/20131208005609/http://msdn.microsoft.com/en-us/library/ey142t48(VS.80).aspx)、[Unicode 和多字节字符集 (MBCS) 支持 | 微软文档](https://docs.microsoft.com/en-us/cpp/atl-mfc-shared/unicode-and-multibyte-character-set-mbcs-support)
*   [Unicode 联盟网站](http://unicode.org/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-14T19:19:13.137

通常是前者，即类 UTF-8。有关详细信息，请参阅[可变宽度编码](http://en.wikipedia.org/wiki/Variable-width_encoding)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-14T19:19:43.977

前者——尽管术语“可变长度编码”更合适。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-14T19:21:22.177

我通常用它来指代每个字符**可以**有多个字节的任何字符。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-12-31T13:20:43.927

> 多字节字符集可以由一字节和两字节字符组成。因此，多字节字符串可能包含单字节和双字节字符的混合。

参考：[单字节和多字节字符集](https://msdn.microsoft.com/en-us/library/4bb3e64h.aspx)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-09-18T16:38:11.017

UTF-8 是多字节的，这意味着每个英文字符（ASCII）存储在 1 个字节中，而非英文字符（如中文、泰文）存储在 3 个字节中。当您将中文/泰文与英文混合时，例如“ทt”，第一个泰文字符“ท”使用 3 个字节，而第二个英文字符“t”仅使用 1 个字节。设计多字节编码的人意识到，英文字符不应该存储在 3 个字节中，而可以放在 1 个字节中，因为这样会浪费存储空间。

UTF-16 以固定的 2 字节长度存储每个英文或非英文字符，因此它不是多字节而是称为宽字符。它非常适合每个字符完全适合 2 个字节的中文/泰语语言，但打印到 utf-8 控制台输出需要使用函数 wcstombs() 从宽字符转换为多字节格式。

UTF-32 以固定的 4 字节长度存储每个字符，但由于浪费存储空间，没有人使用它来存储字符。

# .net - 如何将巨大的 XML 文件转换为关系数据以执行查询

> ID：748977
> 
> 赞同：2
> 
> 时间：2009-04-14T19:20:25.830
> 
> 标签：.net, sql-server, xml

我至少有 100 个 xml 文件，每个文件大约 300 MB，其中的电子邮件消息基本上采用下面列出的格式。

现在我的问题是，如何将这些数据导入 SQL Sever 数据库，以便对这些数据执行查询。我的查询大致如下：某个人是否在给定的时间段内向另一个人发送了一封电子邮件，其中包含主题/正文等的某些关键字。

这是我尝试过的：

1) 将每个 XML 文件加载到 SQL Server 中的 XML 数据类型字段中。使用这种方法，我无法提出 Xpath(?) 查询来做我需要的事情。甚至可以在 Xpath 中执行此操作吗？

2) 使用 ReadXML 和 ReadSchema 将每个文件加载到 .NET 数据集中。这似乎可以很好地加载，并且似乎使用外键等创建了正确数量的 DataTable，但这意味着我必须在数据库上创建 100 组表。以某种方式将所有内容连接到一个表中，然后执行查询。

让我知道你们是否有任何其他建议。

谢谢。

```
<Message>
<MsgID>4651286700000CAA00EF00010000</MsgID>
<MsgTime>2007-05-21-01.04.39.000000</MsgTime>
<MsgTimeUTC>1179723879</MsgTimeUTC>
<MsgLang>CODE 1252</MsgLang>
<Sender>
    <UserInfo>
        <FirstName>X</FirstName>
        <LastName>Y</LastName>
        <AccountName>121212</AccountName>
        <CorporateEmailAddress>someone@somewhere.com</CorporateEmailAddress>
    </UserInfo>
</Sender>
<Recipient DeliveryType = " ">
    <UserInfo>
        <FirstName>A</FirstName>
        <LastName>B</LastName>
        <FirmNumber>7593</FirmNumber>
        <AccountName>STRATEGIC AS</AccountName>
        <AccountNumber>604806</AccountNumber>
        <CorporateEmailAddress>A@B.COM</CorporateEmailAddress>
    </UserInfo>
</Recipient>
<Subject>
    Please review the following
</Subject>
<Attachment>
    <FileName>37715772.htm</FileName>
    <FileID>503242486522279_37715772.htm</FileID>
    <FileSize>31175</FileSize>
</Attachment>
<MsgBody>
    This is the message Body
</MsgBody> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T19:24:05.167

使用**Xml 批量加载**组件

[http://support.microsoft.com/kb/316005](http://support.microsoft.com/kb/316005)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T19:28:39.807

您可以尝试使用[XmlReader.ReadSubtree()](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.readsubtree.aspx)来读取一条消息。将整个文件加载到内存中并不是一个好主意。

将一条消息的数据传递给 SQL 服务器很容易，您还可以传递 XML 并在存储过程中在 SQL 服务器上解析它（使用[OPENXML ）。](http://msdn.microsoft.com/en-us/library/aa276847(SQL.80).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T19:39:33.633

如果您要进行查询，为什么不直接使用 XML LINQ 来执行此操作。它可能会更简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T21:09:19.453

我会使用您提到的 ReadXML 方法，但一次只处理一个 XML 文件，然后使用 DataSet/DataTable Merge 方法。只要模式相同，它就应该继续添加到相同的表中（更多行而不是重复的表），并确保您每次处理该文件所拥有的 XMLDocument 或 XMLTextReader，这样您就会得到记忆回来了。

完成后，使用 SqlDataAdapter 和 SqlCommandBuilder 自动生成 INSERT 语句并将其刷新到 SQL 表中。如果您使用 Visual Studio 的数据资源管理器生成强类型数据集，这会更容易。

您甚至可能希望间歇性地执行此操作并清除数据集，以便降低内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T08:14:36.343

使用 SQL Server 集成服务。有一个为此任务设计的 XML 源适配器，带有一个方便的设计器，您可以在其中选择 XML 中的节点或属性，这些节点或属性将变成数据库中的列。

请参阅SSIS 团队的[这篇博文。](http://blogs.msdn.com/mattm/archive/2007/12/11/using-xml-source.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T09:12:34.083

如果您需要这样做一次，我将创建一个 xslt 将 xml 转换为 SQL 插入语句并执行生成的 sql 脚本来填充表。由于 xml 文件很大，这不会导致内存问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-02T17:36:37.680

听起来数据库不是必需的，只是一种能够查询的方式。如果是这种情况，请尝试使用 XMLMax，它应该会在大约 20 秒内加载 300MB 的 xml。它有一个索引 xpath 查询，索引大约需要 15 分钟。其他选项将是本机 xml 数据库。eXistDB 是开源的，我有一位用户告诉我他已经使用了千兆字节大小的 xml，并且对它非常满意。但是为给定的 xml 加载、索引和设置它确实需要很多时间。

# language-agnostic - 去哪里浏览开源项目？

> ID：748980
> 
> 赞同：9
> 
> 时间：2009-04-14T19:20:37.453
> 
> 标签：language-agnostic, open-source

我决定四处寻找需要帮助的开源项目，并为一两个人提供一些时间。但是有一个问题，是否有一个站点列出了当前正在寻找开发人员的开源项目，并且是否有任何地方我可以例如按语言/技术/等过滤开源项目。

我所追求的是一种了解许多开源项目的方法，这样我就可以决定它们是否让我感兴趣。

想法在哪里可以找到这些信息？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-14T19:26:31.573

三个主要的：

[**源锻造**](http://sourceforge.net/)

[**CodePlex**](http://www.codeplex.com)

[**谷歌代码**](http://code.google.com)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T19:23:06.543

查看[Freshmeat](http://freshmeat.net)以获取各种开源目录。除此之外，我建议您在网上浏览您感兴趣的主题，看看那里有什么。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-14T19:31:36.897

虽然您可能对自己参与不感兴趣，但 Google Summer of Code 有一个参与[项目的列表](http://socghop.appspot.com/program/accepted_orgs/google/gsoc2009)。一个项目参与通常意味着它需要更多的贡献者，它有愿意帮助新贡献者的导师，并且它有一个想法列表，其中包含对刚开始使用代码库的人有益的任务（尽管它们通常被设计为一个全职的夏季项目，它们的范围确实很大）。

[浏览这个列表绝对可以帮助你更轻松地找到要做的事情，而不是在SourceForge](http://sf.net)、[Google Code](http://code.google.com)或[GitHub 上](http://github.com)搜索每个可用的开源项目（尽管 GitHub 很好，因为你可以很容易地分叉、破解尽可能多的补丁和一次性根据需要进行分支，然后请求在完成后合并您的代码）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T19:42:48.350

我建议选择一个你喜欢和使用的软件，并找到一种方法来为此做出贡献。具体来说，修复您注意到的烦恼或错误。如果您没有看到任何烦恼或错误，请查找项目的错误跟踪器。这样，它就是您投资的项目，并且您至少已经部分了解了从最终用户的角度来看代码的工作方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T19:22:12.037

[Source Forge](http://sourceforge.net)是一个很好的起点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T19:23:47.883

也可以查看[CodePlex](http://www.codeplex.com/)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-14T19:24:53.323

[我喜欢浏览GitHub 上](http://github.com)有趣的项目，如果我认为它们很有趣，并且如果我觉得我可以做出贡献，那么就分叉它们吧！我还没有为任何事情做出贡献，但这一切似乎都非常容易和吸引人。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-14T19:24:15.620

好吧，我会直接前往[Sourceforge](http://sourceforge.net/)，找到一个您感兴趣的项目，然后开始查看他们的错误列表以帮助修复问题。Sourceforge 可以过滤掉您不感兴趣的语言或主题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-14T19:25:52.043

最好的：[http](http://code.google.com/) ://code.google.com/ 和 Sourceforge

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-14T19:36:14.390

[Ohloh](http://www.ohloh.net) 是一个很棒的存储库，索引了许多项目。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-14T20:41:21.143

Craigslist.com 也是一个贡献你技能的好地方......我知道你不会在 craigslist 上找到你的开源项目，但是嘿，有人可以免费使用你的技术技能......如果你有空的话不要让某人从中受益...****************