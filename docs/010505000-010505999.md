# StackOverflow 问答 10505000-10505999

# java - Java 游戏区难度

> ID：10505000
> 
> 赞同：1
> 
> 时间：2012-05-08T19:15:25.093
> 
> 标签：java, swing, jpanel

在许多第一人称 2d 游戏中，会有一个巨大的比赛场地，但您的计算机上的显示区域却很小：

```
++++++++++++++++++++++++++++++++++++
+++++aaaaaa+++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++
+++++aaaaaa+++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++
+++++aaaaaa+++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++
+++++aaaaaa+++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++ 
```

其中“+”是整个比赛场地，“a”是屏幕上的可显示区域。

我想做一个像这样的游戏，按下箭头键会让你在整个比赛场地上移动。

问题：我需要创建一个巨大的 JPanel 来完成这个吗？（比屏幕大）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T19:24:30.437

如果您开始常规游戏，您是否希望在屏幕底部和侧面找到整个关卡的滚动条？或者您是否希望您可以（使用鼠标/箭头/...）浏览整个关卡。

在第一种情况下，做我的客人并创建一个巨大的`JPanel`并将其放入 a`JScrollPane`但我强烈建议选择选项 2。

[对于选项 2，我在另一个相关的 SO question](https://stackoverflow.com/questions/8672598/what-is-the-best-way-to-load-and-cache-images-in-java/8672945#8672945)中概述了一种可能的方法。这可能值得一看

# java - 不需要显式创建 Short 对象？

> ID：10505001
> 
> 赞同：7
> 
> 时间：2012-05-08T19:15:30.513
> 
> 标签：java

以下代码完美运行并将 1 和 2 值添加到列表中，但为什么呢？为什么不需要显式创建 Short 对象？例如：`list.add(new Short(1));`

```
List<Short> list = new ArrayList();
list.add((short)1);
list.add((short)2);
System.out.println(list); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-08T19:16:13.263

这称为[自动装箱](http://docs.oracle.com/javase/1.5.0/docs/guide/language/autoboxing.html)。它是一种自动将基元转换为其相应对象类型的功能。它从 Java 1.5 开始存在。

自动装箱的反面称为自动拆箱，但要注意 NullPointerException

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:21:54.313

这称为自动装箱。

请注意，它仍然会`Short`自动创建真正的对象，这些对象在您的堆上占用 16 个字节，与 Integer 对象相同。只有原生`short`值只占用 2 个字节（但不能放入`java.util.collections`）。

在很多情况下

```
list.put((short) 12345);
list.put((short) 12345); 
```

实际上甚至会创建*两个*这样的对象，即 32 字节加上列表对象占用的内存。存储在列表中的指针每个已经占用了 4-8 个字节。

如果您只有几个实例，那没关系。如果你有几百万，这可能会因为内存管理和使用而严重影响性能。使用原始短裤，您通常可以走 10 倍的距离，然后才会变慢或内存不足。

# mysql - 如何在 Rails 中执行复杂的查询

> ID：10505003
> 
> 赞同：0
> 
> 时间：2012-05-08T19:15:36.677
> 
> 标签：mysql, ruby-on-rails-3

我有以下查询，我需要将其转换为类似语法的 rails。有什么方法可以做到这一点，还是只使用普通的 MYSQL 更好？

```
SELECT `terminals`.`serial`, Count(*) AS count, MAX(`logs`.`created_at`) AS created_at 
FROM 
(SELECT * FROM `terminals` WHERE `terminals`.`user_id`= 1) AS terminals 
INNER JOIN `bap-backend`.`logs` ON terminals.`serial`=`logs`.`serial` 
GROUP BY `serial` ORDER BY `logs`.`created_at` 
```

内部 Select 是为了确保只有 current_user 的终端被选中，然后我只需要终端串行。我需要这个查询来概述所有用户的终端，并显示终端提供了多少日志以及最后一个日志发生的时间。该查询适用于我的测试数据，只有 Rails 中的实现对我来说有点复杂。

谢谢！

## 编辑

对于谷歌的人，只需使用 find_by_sql，您仍然可以在其中添加变量。只需在命令前添加一个类，如下例所示：

```
@items_event = Item.find_by_sql(["SELECT items.*, ei_relationships.itemprice, ei_relationships.currency, ei_relationships.itemunit
                                      FROM `ei_relationships` INNER JOIN `items` ON `items`.`id` = `ei_relationships`.`item_id`
                                      WHERE `ei_relationships`.`event_id` = ?", @event[:id]]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:23:42.283

我不声称对 Rails 有任何了解，所以我无法回答这部分问题。但是如果你坚持使用普通的 MySQL，你的查询可以稍微清理一下：

```
SELECT
    terminals.serial,
    COUNT(*) AS count,
    MAX(logs.created_at) AS created_at 
FROM 
    terminals 
    INNER JOIN `bap-backend`.logs
        ON terminals.serial = logs.serial AND terminals.user_id = 1 /* instead of performing a subquery, just add this to your join conditions */
GROUP BY
    serial
ORDER BY
    logs.created_at 
```

这取出了一个子查询，这应该有助于您的表现。

# javascript - 用 window.print() 打印大表只打印一页

> ID：10505006
> 
> 赞同：5
> 
> 时间：2012-05-08T19:15:45.953
> 
> 标签：javascript, html, css, printing

我有一个带有非常宽的报告表的网页——几十列，相当多的水平滚动。当我尝试使用 window.print() 打印页面时，浏览器（Firefox 或 Chrome）只打印一页并切断其余页面。

有没有办法告诉浏览器打印整个网页，即使这意味着将表格溢出到更多（纸质）页面？

该表目前没有以任何方式显示或打印的样式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T23:49:31.943

[Print a very wide HTML table without clipping right hand side](https://stackoverflow.com/questions/8891944/print-a-very-wide-html-table-without-clipping-right-hand-side) and [Print Stylesheets for pages with long horizontal tables](https://stackoverflow.com/questions/292642/print-stylesheets-for-pages-with-long-horizontal-tables) seem to indicate you are kinda screwed if you must take a CSS only approach. The only thing I can think of *might* work (and yes, I tried) is something *a little insane* like

```
<style media="print">
table, table * {
 display:inline-block;
}
table tr {display:block;}
table td {padding:10px;}
</style> 
```

which, of course, attempts to do away with the normal table styles.

See [http://jsfiddle.net/jfcox/WTRxm/](http://jsfiddle.net/jfcox/WTRxm/) and, apparently for a printable version [http://jsfiddle.net/jfcox/WTRxm/show/](http://jsfiddle.net/jfcox/WTRxm/show/)

Seems to work in Firefox and Chrome (that is, it flows the cells around as inline blocks for each row) I don't know what the standards say about this, though. Mileage may vary.

Edit: as a bonus, it seems it's not too hard to add counters to the cells so that you know what column a cell was in (only tested in chrome).

```
<style media="print">
table, table * {
 display:inline-block;
}
table tr {display:block;
    counter-reset: section; }
table td {padding:10px;}
table td:before {
    counter-increment: section;
    content: counters(section, ".") " ";
}    

</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:51:23.387

> 该表目前没有以任何方式显示或打印的样式。

这是为什么？你最好为打印编写一个指定的样式表，因为没有办法强制（欺骗）浏览器打印水平滚动的内容，既不是通过 JavaScript 也不是通过 CSS。

要么以其他方式破坏表格数据，要么为此目的使用样式表。

这是[一篇关于在 A List Apart 上编写用于打印的 CSS](http://www.alistapart.com/articles/goingtoprint/)的文章，以帮助您入门，祝您好运。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-08T19:50:46.810

您可以创建一个 print.css 来设置打印页面的内容样式。将其链接到您的页面：

```
<link rel="stylesheet" type="text/css" media="print" href="print.css" /> 
```

# javascript - Jquery Mobile 需要延迟我的对话框

> ID：10505011
> 
> 赞同：0
> 
> 时间：2012-05-08T19:16:18.300
> 
> 标签：javascript, jquery, android, jquery-mobile, mobile-browser

几秒钟后我的背景显示在屏幕上，我需要弹出我的对话框。

当前代码有点飞溅。但我需要几秒钟后弹出而不是刷新。

这是我的代码

```
<!DOCTYPE html>
<html>
<head>
<title>Apple</title>
<!-- the three things that jQuery Mobile needs to work -->
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
    <style>
        /* App custom styles */

.text-align-center {
 text-align: center;
 }
.text-align-right {
 text-align: right;
}

.ui-content {
 margin-top: 200px;
}

.ui-page {
background : transparent url(http://i45.tinypic.com/abc.jpg) 0 0 no-repeat !important;
background-size : cover;
}
    </style>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js">
    </script>
    <script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js">
    </script>
   <!-- <script type="text/javascript" src="mobiledetect.js"></script>*/ -->

   <script type="text/javascript">

        $(document).bind("mobileinit", function()
        {
            $.mobile.defaultPageTransition = "fade";
        });
       $('div[data-role|="page"]').live('pageshow', function(event){
              var nextPage = $($(this).attr('NextPage'));
              setTimeout(function(){
            $.mobile.changePage(nextPage);
              }, 1000);
        });
    </script>

</head>
<body>

<div data-role="page" data-theme="b" id="splash" NextPage='#iphonepage' style="background-color: #fff;"> 
    <div class="splash">        
    </div>
</div>

<!-- This is the first page -->
 <section id="iphonepage" data-theme="b" data-role="dialog" style="margin-top: 0.5px !important" style="font-size: 12px !important;">
     <div data-role="content">
            <div>
                <h1 class="text-align-center">
                    <b>
                        Apple
                    </b>
                </h1>
                <br />
            </div>

            <a data-role="button" href="http://m.apple.com">
                Go
            </a>
        </div>

</section> 
```

​</p>

# java - 如何使用 jstack 获取堆栈跟踪历史记录？

> ID：10505015
> 
> 赞同：0
> 
> 时间：2012-05-08T19:16:25.147
> 
> 标签：java

我`"jdk1.6.0/bin/jstack -l PID > /tmp/stack-DATE.txt"`用来获取当前快照。

是否可以获得大约 8 天前的特定时间戳的堆栈跟踪？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:25:15.290

如果您试图从前一个时间点捕获的转储中获取它，那么是的，您可以获得它，而且您希望回到多长时间并不重要。如果您依赖 pid，则堆栈信息将是当前信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:27:12.623

不幸的是你不能。想象一下存储所有快照将消耗多少内存/磁盘空间。您可以设置一些每秒转储线程的作业，但 JVM 本身只能返回当前堆栈状态。

# svn - 颠覆：锁定还是解锁？

> ID：10505019
> 
> 赞同：0
> 
> 时间：2012-05-08T19:16:54.057
> 
> 标签：svn

我刚刚提取了一个 SVN 回购。拉出后，我立即`cd`进入文件夹并执行`svn status`. 存储库中的所有文件都被锁定。然后我尝试执行一个`svn unlock *`，然后我收到一条消息，指出当前工作副本中没有任何内容被锁定。很迷茫，这些看似矛盾。如何解锁 fricken 文件/文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:23:06.027

您是否尝试使用带有 force 标志的 svn unlock 命令？

```
svn unlock -force * 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:31:53.777

过去也尝试`svn cleanup`过几次为我工作

# android - Android 上的服务器模式 SSL startHandshake 需要 12 秒才能完成

> ID：10505036
> 
> 赞同：3
> 
> 时间：2012-05-08T19:18:39.840
> 
> 标签：android, ssl

我是安卓新手。对于应用程序，我需要在 Android 上将普通 TCP 套接字升级为 SSL 套接字（服务器模式）。以下代码有效，但在装有 Android 2.3.3 (API 10) 的三星 Galaxy S 上完成 SSL 握手大约需要 12 秒。我还在模拟器上用 android 4.0.3 (API 15) 测试了相同的代码，结果是一样的。客户端是 Chrome 浏览器。从 Wireshark 跟踪来看，所有 SSL 握手消息的流动速度都非常快，然后在 Change Cipher Spec/Encrypted Handshake 消息（服务器端 SSL 握手的最后两条消息）和第一个应用程序数据（它是来自 chrome 的 HTTP GET）。

```
private boolean handleSSLHandshake() {

    try {
        SSLContext sc = SSLContext.getInstance("TLS");
        sc.init(this.kmf.getKeyManagers(), null, null);
        SSLSocketFactory factory = sc.getSocketFactory();            
        this.sslSocket = (SSLSocket) factory.createSocket(this.socket,
                                         this.socket.getInetAddress().getHostAddress(),
                                         this.socket.getPort(),
                                         true);
        this.sslSocket.setUseClientMode(false);
        this.sslSocket.addHandshakeCompletedListener(this);
        this.sslSocket.startHandshake();
        Log.d(TAG, "SSL upgrade succeeds!");
        this.input = this.sslSocket.getInputStream();
        this.output = this.sslSocket.getOutputStream();
    } catch (NoSuchAlgorithmException e) {
        Log.d(TAG, "Got NoSuchAlgorithmException while upgrading to SSL" + e);
        this.sslSocket = null;
        return false;
    } catch (KeyManagementException e) {
        Log.d(TAG, "Got KeyManagementException while upgrading to SSL" + e);
    } catch (UnknownHostException e) {
        Log.d(TAG, "Got UnknownHostException while upgrading to SSL" + e);
        this.sslSocket = null;
        return false;
    } catch (IOException e) {
        Log.d(TAG, "Got IOException while upgrading to SSL" + e);
        this.sslSocket = null;
        return false;
    }
    return true;
}

public void handshakeCompleted(HandshakeCompletedEvent event) {

    Log.d(TAG, "SSL handshake completed");
} 
```

有谁知道哪个代码花了 10 秒？如何减少这种情况？以及如何在 Android 上调试 SSL 握手？

非常感谢帮助，

/开端

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:59:17.493

You could monitor load on the device to see if the CPU is busy during those 10 secs. Also try on different devices and/or the emulator to see if you get the same results. Another possibility is that it's waiting on DNS, but that shouldn't happen that late. Check your packet captures for DNS queries.

# dynamics-crm - CRM 2011 功能区 DisplayRule ValueRule 检查是否为空

> ID：10505040
> 
> 赞同：6
> 
> 时间：2012-05-08T19:18:55.947
> 
> 标签：dynamics-crm, dynamics-crm-2011

快速的，我没有看到任何直接的答案，所以我想我会问。（这是在[微软社交网站上提出的相同问题](http://social.microsoft.com/Forums/eu/crmdevelopment/thread/44d1187d-547d-49c5-a734-d4ad347a3a40)，也没有得到回答）

如果我有一个 DisplayRule 和一个 ValueRule ，我如何检查 null ？下面这个建议的解决方案显然不起作用（根据链接的问题）：

```
 <DisplayRule Id="new.incident.form.IsNotRelatedToY.DisplayRule">
    <ValueRule Field="YId" Value="null" InvertResult="true" />
  </DisplayRule> 
```

它取决于字段的类型吗？如果是这样，我需要它在两种不同的情况下工作，当 YId 是实体引用时，以及当 YId 是字符串时。我认为“null”不能用于字符串，因为“null”是一个有效的字符串。

有人有一个工作的例子吗？

编辑：看起来[ValueRule 文档](http://msdn.microsoft.com/en-us/library/gg334317.aspx)没有关于这个主题的内容。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T19:59:01.437

好问题，但不幸的是我认为这里没有任何好的答案，因为我认为这是一个错误。如果您将`"null"`a 中的字符串属性用作 a 的值`ValueRule`，`EnableRule`您会看到该按钮实际上已启用（或禁用，具体取决于您为 设置的内容`InvertResult`）。`DisplayRule`它只是对s不起作用。（我最好的猜测是他们只是在开发`EnableRules`而不是`DisplayRules`; 正如您的链接中提到的那样，不支持`CustomRule`s `DisplayRules`，尽管它存在于s `EnableRules`。）

我会提交错误报告，但 Microsoft Connect 仍然只接受 Dynamics CRM 的“建议”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-15T07:37:16.490

它已在 CRM 2013 中修复。我刚刚对其进行了测试并开始工作

# c# - 如何设置使用 .NET Web 应用程序的子文件夹作为其基础的 IIS 网站？

> ID：10505041
> 
> 赞同：3
> 
> 时间：2012-05-08T19:19:09.453
> 
> 标签：c#, asp.net, visual-studio-2010, iis-6, virtual-directory

我有一个 .NET Web 应用程序，我在其中开发了三个独立的网站，它们都共享一些类、母版页等。（调用网站`mysite1`、`mysite2`和`mysite3`）

当我使用 VS 中的“在浏览器中查看”查看该站点时（这会导致[http://localhost/projectName/mysite1/default.aspx](http://localhost/projectName/mysite1/default.aspx)），一切都按预期工作。

但是，我还设置了一个名为的 IIS 网站`Mysite1`，该网站使用[http://mysite1/](http://mysite1/)并指向“mysite1”子文件夹作为其本地路径（在主目录下）。当我访问[http://mysite1/](http://mysite1/)时，我收到以下 ASP.NET 错误：

> 解析器错误消息：无法加载类型“MyProject.Mysite1.Default”。
> 
> 源错误：
> 
> `Line 1: <%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="MyProject.Mysite1.Default" %>`
> 
> `Line 2:`
> 
> `Line 3: <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">`

命名空间都是有效的，从“在浏览器中查看”运行时站点正常工作就证明了这一点。我认为这与人为更改应用程序的基本文件夹有关，因为这是其他几个错误引起的，但我不知道如何解决它。

我应该如何配置 IIS 以使用 Web 应用程序的子文件夹作为其基本文件夹？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T19:24:30.877

> 1.  转到 IIS。
> 2.  右键单击您的网站。
> 3.  创建名为 mysite1 的虚拟目录。
> 4.  右键单击虚拟目录 mysite1 并选择转换为应用程序

现在可以在`http://mysite1/`里面操作和页面了`mysite1`

> **`CodeBehind`**= 需要编译（asp.net 1.1模型），编译好的二进制放在网站的bin文件夹下。在部署之前，您需要在 Visual Studio 中进行编译。当您不希望源代码以纯文本形式查看时的良好模型......例如，当您交付给您没有义务提供代码的客户时。
> 
> **`CodeFile`**= 您为源文件提供部署解决方案。ASP.NET 2.0 运行时在需要时编译代码。编译后的文件位于 Microsfot.NET[.NET version]\Temporary ASP.NET Files。

# php - 从 PHP 中去除逗号

> ID：10505049
> 
> 赞同：1
> 
> 时间：2012-05-08T19:19:41.410
> 
> 标签：php, string, str-replace, strip

我有一个存储在 PHP 变量中的动态值。该变量包含一串数据，表示单击了哪些复选框。它像这样返回：Option1，Option2，Option3，Option4.....

我想去掉逗号，所以它只是 Option1 Option2 Option3 Option4....

我的代码：

```
<?php 
    $type = the_field('type_of_work'); 
    $type = str_replace(",", "",$type);
    echo $type; 
?> 
```

出于某种原因，逗号仍在呈现。知道为什么或如何解决这个问题吗？如您所知，the_field('type_of_work') 是一种从 wordpress' 后端提取高级自定义字段的方法，但不应与此问题相关，因为它正在成功地重新调整带有逗号的字符串。有什么想法吗？

更新：我将以不同的方式来解决这个问题：

```
if(in_array('brand-id', get_field('type_of_work') )): 
    echo "brand-id";
endif; 

echo " ";

if(in_array('print', get_field('type_of_work') )): 
    echo "print";
endif; 
```

很快....

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T19:22:17.623

还有一些你没有包括在内的东西。您发布的代码完美地完成了它的工作。如果您仍然看到逗号，那么这里有其他东西在起作用。

```
<?php 
    $type = the_field('type_of_work'); 
    $type = str_replace(",", "",$type);
    echo $type; 
?> 
```

`die`这是您确定的最佳时机。

```
<?php
die(str_replace(',', '',the_field('type_of_work')));
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:29:50.150

尽管您提供的代码应该可以完美运行，但我建议您改用它：

```
$type = explode(',', $type); 
```

这将把它变成一个值数组。`trim()`单独设置每个值也是一个好主意。

所以，而不是：

```
$item = 'Item1 Item2 Item3'; 
```

你会得到一个数组：

```
$item = array('Item1', 'Item2', 'Item3'); // Assuming each value is `trim()`ed 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:22:48.190

正则表达式替换

```
preg_replace("/,/", "", $string); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T19:24:50.703

您可以尝试将它们爆炸成一个数组，然后将它们内爆回来......

```
$split = "super,cali,fragilistic,expi,alidocious";
$arr = explode(",",$split);
$finalStr = implode(" ",$arr);
echo $finalStr; 
```

`super cali fragilistic expi alidocious`

* * *

[implode](http://php.net/manual/en/function.implode.php)和[explode](http://www.php.net/manual/en/function.explode.php)的文档。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-20T19:58:26.837

这是诀窍：

```
<?php
$type = get_field('type_of_work');
$type = implode(' ', $type);
echo $type;
?> 
```

或者简单地说：

```
<?php echo implode(' ', get_field('type_of_work')); ?> 
```

因为 get_field 是一个数组。

# html - 同一页面上的多个对象需要 rel=canonical URI

> ID：10505051
> 
> 赞同：3
> 
> 时间：2012-05-08T19:19:45.830
> 
> 标签：html, semantic-web, semantic-markup, rel

编辑：这个问题很长，包括几个我正在寻找的东西的例子。我找到了答案（见下文），即确实存在类似的东西，您可以在[schema.org](http://schema.org)上阅读所有相关信息。

我希望能够将某些语义信息附加到同一页面上的几个不同项目。例如，我的页面有一个歌曲列表，看起来有点像：

```
<div class="song">
    <img src="cover-art-image" />
    <p>Description on image</p>
    <a id="..." href="link-to-song">View song</a>
</div>
<div class="song">
    ...
</div> 
```

现在，我想显示有关这些对象（在本例中为歌曲）的语义信息，因此我们`<meta>`在歌曲的实际页面上的标签中包含语义数据（以及`<link rel="author" ...>`等等）。

所以我想知道最好的方式是沟通（搜索引擎，JavaScript 位，或者在我们的例子中是浏览器插件）链接`"View song"`是唯一描述语义对象（元数据和所有）的 URI .

我已经阅读过 using `link rel="canonical"`，但据我所知，这意味着在标题中使用，以描述*当前页面*（或通知搜索引擎当前页面的规范表示是什么），而我想要传达的是我们想要描述一个正在显示在当前页面上的子对象。所以，在一个理想的世界里，我会写这样的东西：

```
<div class="song">
    <img ... />
    <p> ... </p>
    <a href="link-to-song" rel="canonical">View Song</a>
</div> 
```

`href`描述位于（即歌曲页面）末尾的东西是父 HTML 节点的规范表示。但是，这并不是真正的`rel="canonical"`意思：是否已经定义了类似的东西可以做（即交流）我想要的东西？

如果不是，那么实现这种东西的最“网络友好”的方式是什么？我敢肯定只使用多个`rel="canonical"`链接不是这样做的方法（最好不要通过尝试嵌入实际上应该有用的语义数据来冒犯搜索引擎）。

我唯一能想到的就是放一些类似的东西

```
<a href="..." rev="summary"> ... </a> 
```

为了反映此处显示的内容是条目主页上内容的摘要 - 但我认为这不会被解释为“范围”以表示“包含此链接的 DOM 节点是...的摘要” .

编辑：关于如何使用它的另一个例子（如果我的意思不清楚）可能是让博客文章上的每条评论都包含这样一个链接，这将唯一标识与该特定帖子关联的 URI。在该链接之后，您会找到一个页面，其中包含例如`<link rel="author"...>`评论信息、指向发表评论的帖子的链接等等。

编辑：为了更清楚我的意思，我们已经使用了元数据，例如

```
<link rel="canonical" href="..." /> 
```

在`<head>`页面的 URI 中传达有关*此*URI 中描述的对象（或内容）的语义数据。因此，`<head>`可以认为存在于页面级别的元数据的*范围*（滥用术语）。我想知道我们如何在页面的各个部分级别对元数据进行范围界定（因此在上面的示例中，我想在包含它们的 DOM 节点级别界定元信息）。以下不是有效的标记（出于显而易见的原因，将受到搜索引擎的惩罚），但说明了我的意思：

```
<html>
    <head>
        <link rel="canonical" href="/canonical/representation/of/this/page.html" />
    </head>
    <body>
        <div id="item1">
            <a rel="canonical" href="/canonical/representation/of/item1.html" />
            <p>Some local description of item2</p>
        </div>
        <div id="item2">
            <a rel="canonical" href="/canonical/representation/of/item2.html" />
            <p>Some local description of item2</p>
        </div>
     </body>
</html> 
```

然后在地址上`/canonical/representation/of/item1.html`我们可能会找到一些语义数据（例如，Open Graph 数据）：

```
<html prefix="og: http://ogp.me/ns#">
    <head>
        <meta property="og:title" content="Some title" />
        <meta property="og:type" content="music.song" />
        <meta property="og:url" content="/canonical/representation/of/item1.html" />
    </head>
    <body>
        <!-- User-facing content of the page -->
    </body>
</html> 
```

这种关系需要一个`rel=...`标记的原因是我们希望将其标记为包含有关页面特定部分的相关语义数据（而不是页面中的其他链接，它可能指向任何地方），并且应该跟随程序想要发现此类数据（然后可以知道这些数据仅与链接所在的特定 DOM 节点“范围”的页面部分相关）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T20:29:01.307

事实证明，这*是*使用**Microdata**完成的。`<canvas>`它不像原生视频和朋友那样受到同样的关注，但它是 HTML5 规范的一部分（[这里](http://www.whatwg.org/specs/web-apps/current-work/multipage/microdata.html#using-the-microdata-dom-api)），甚至意味着有一个 JavaScript API（尽管 Opera 是迄今为止唯一实现它的浏览器 -那里没有惊喜）。

更好的是，事实证明像谷歌、必应和雅虎这样的人！所有人都关心这些东西，并创建了[schema.org](http://schema.org/)来记录它（以及提供完整的现成数据类型列表）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:51:03.783

我理解您所说的方式是，您希望确保链接的含义是将用户带到有关歌曲的页面。所以你要确保链接的含义是清楚的。你有没有想过这个：

```
<a href="" class="song">
    <img ... />
    <p> ... </p>
</a> 
```

我最初想在其中包含一个图形标签，但感觉不对；我的怀疑得到了[http://html5doctor.com/your-questions-15/](http://html5doctor.com/your-questions-15/)令人敬畏的权威的证实。

# jsf-2 - 将值从 xhtml 传递到 java 脚本而不是输入字段

> ID：10505053
> 
> 赞同：1
> 
> 时间：2012-05-08T19:19:56.640
> 
> 标签：jsf-2

除了inputHidden和inputText之外，有没有办法从UI获取值到javascript。当输入字段出现错误时，输入隐藏字段不会被更新。如果我们必须使用绑定值，则需要更改很多代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:50:18.433

JSF 最终生成 HTML。JS 是 HTML 的一部分。只需让 JSF 打印它，就好像它是一个 JS 变量。

例如

```
<script>var someString = '#{bean.someString}';</script> 
```

```
<script>doSomething('#{bean.someString}');</script> 
```

```
<script>var someNumber = #{bean.someNumber};</script> 
```

```
<script>var someJsonObject = #{bean.someJsonObject};</script> 
```

您也可以使用`<h:outputScript>`代替`<script>`. 无论您在哪里声明，这都可以轻松地重新定位到头部或身体底部。例如

```
<h:outputScript target="body">doSomething('#{bean.someString}');</h:outputScript> 
```

# php - 如何检测纯文本文件的 MIME 类型：CSS、Javascript、ini、sql？

> ID：10505056
> 
> 赞同：8
> 
> 时间：2012-05-08T19:20:08.103
> 
> 标签：php, file, mime-types

用 PHP 检测文件的 MIME 类型很简单——只需使用 PEAR 的[MIME_Type](http://pear.php.net/package/MIME_Type)包、PHP 的[fileinfo](http://php.net/fileinfo)或`file -i`在 Unix 机器上调用。这对于二进制文件和所有其他具有某种“魔术字节”的文件非常有效，通过这些文件可以轻松检测到它们。

我失败的是检测正确的 MIME 类型的纯文本文件：

*   CSS
*   差异
*   INI（配置）
*   Javascript
*   第一时间
*   SQL

所有这些都被标识为“文本/纯文本”，这是正确的，但对我来说太不具体了。我需要真实的类型，即使分析文件内容需要一些时间。

所以我的问题是：存在哪些解决方案来检测此类纯文本文件的 MIME 类型？有图书馆吗？代码片段？

* * *

请注意，我既没有文件名也没有文件扩展名，但我有文件内容。

* * *

如果我使用 ruby​​，我可以集成[github 的 linguist](https://github.com/github/linguist)。Ohloh 的[ohcount](https://github.com/blackducksw/ohcount/)是用 C 编写的，但是有一个命令行工具来检测类型：`ohcount -d $file`

## 我试过的

### 算了

正确检测 xml 和 php 文件，其他都没有。

### 阿帕奇蒂卡

检测 xml 和 html，所有其他测试文件仅被视为`text/plain`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T11:02:34.643

由于我没有找到合适的库，所以我编写了自己的*魔术*文件来正确检测我的所有测试文件。

我的应用程序首先尝试我的自定义魔术文件进行检测，如果未检测到类型，则回退到正常/系统魔术文件。

它在 github 上的代码，请参见[https://github.com/cweiske/MIME_Type_PlainDetect](https://github.com/cweiske/MIME_Type_PlainDetect)。魔术文件位于[data/programming.magic](https://github.com/cweiske/MIME_Type_PlainDetect/blob/master/data/programming.magic)并且可以与`file -f programming.magic /path/to/source`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:28:31.830

我认为Apache Tika 的*魔法检测*可以帮助您：

[http://tika.apache.org/](http://tika.apache.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T20:06:18.480

如何 ：

*   **.ini**要检查 ini 文件，您将使用[parse_ini_file](http://php.net/manual/en/function.parse-ini-file.php)函数。如果 ini 文件错误，则返回 false。
*   **.css**首先检查你是否找到类似的东西`body {`， `html {`或者 `body, html {`。您还可以尝试使用 CSS 中的关键字，例如`font-family`、`background`、`border`等。
*   **.sql**您可能会找到类似`INSERT INTO`, `UPDATE (.*) SET`,`CREATE TABLE`等的内容，再次查找关键字。
*   **.js**对于 Javascript，您将不得不再次查找 parse all 以查找关键字...

对于其他人，我不认识他们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-06T09:02:26.037

我找到了这个库： http: [//pear.php.net/package/MIME_Type/](http://pear.php.net/package/MIME_Type/)

根据其描述，它“提供处理 MIME 类型的功能”。并提供以下功能：

*   解析 MIME 类型。
*   支持完整的 RFC2045 规范。
*   许多实用功能，用于处理和确定有关类型的信息。
*   大多数函数都可以静态调用。
*   自动检测文件的 mime 类型，可以使用 fileinfo 扩展名、mime_magic 扩展名、“file”命令或内置映射列表

# java - Netbeans 导出到 Jar，包括所有库文件

> ID：10505057
> 
> 赞同：12
> 
> 时间：2012-05-08T19:20:10.437
> 
> 标签：java, netbeans, jar, netbeans-7, build.xml

**我真正需要**的是来自 Eclipse with Netbeans 的等价物：

![在此处输入图像描述](../Images/cf71a592d5b7046612fc85e03a850cc2.png)

我想要`Extract required libraries into generated JAR`这样我就可以分发它，而无需在任何地方都包含 lib 文件夹。

这是原始问题。

我正在尝试用[Netbeans](http://www.netbeans.org)构建一个 jar ，它将所有库文件打包在其中。我听说 Eclipse 可以通过选择 Export 来实现。使用 Netbeans，如果我“清理并构建”它会在 dist 文件夹中创建一个可执行 jar，但它所依赖的所有库都在一个名为 lib 的文件夹中。我需要将所有内容都放在一个 jar 文件中。我认为它与 build.xml 文件有关。这是我的说法。我在这里做错了什么？

谢谢您的帮助。

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="BONotifier" default="default" basedir=".">
  <description>Builds, tests, and runs the project BONotifier.</description>
  <import file="nbproject/build-impl.xml"/>
  <target name="-post-jar">
    <jar jarfile="dist/Combined-dist.jar">
      <zipfileset src="${dist.jar}" excludes="META-INF/*" />
      <zipfileset src="lib/commons-io-1.4.jar" excludes="META-INF/*" />
      <manifest>
        <attribute name="Main-Class" value="controller.MainController"/>
      </manifest>
    </jar>
  </target>
</project> 
```

**更新**：上面的代码在 build.xml 中。以下在 build-impl.xml 中。我猜这意味着 build.xml 在 build-impl.xml 期间运行。

```
<target name="-pre-init">
    <!-- Empty placeholder for easier customization. -->
    <!-- You can override this target in the ../build.xml file. -->
</target> 
```

**注意**我从这个[论坛](http://www.java-forums.org/netbeans/12582-netbeans-creating-jar-including-jar-libraries.html)得到这个。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-08T21:50:46.603

我更喜欢[这个](http://java.sun.com/developer/technicalArticles/java_warehouse/single_jar/)解决方案，因为没有什么可下载的，全部基于 Ant 构建（约 20 行）。这样就没有额外的依赖关系了。如果你有几分钟的时间，你也可以了解 Ant。

似乎指向原始文章的链接已损坏（感谢 Oracle）。这是另一个[链接](http://mavistechchannel.wordpress.com/2010/08/17/how-to-build-a-single-jar-file-with-external-libs/)。

原始文章也可从 Oracle[链接](http://www.oracle.com/technetwork/articles/javase/index-139904.html)获得。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-03T13:20:09.093

1.  使用 7zip（或其他工具）打开生成的 jar
2.  将jar库添加到文件夹中
3.  编辑清单以设置类路径

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-13T00:43:51.737

好的，这就是我的解决方案。我的程序在 Netbeans 上编译和运行时也遇到了问题，但是当我尝试 Java -jar MyJarFile.jar 时它失败了现在，我不完全了解 Maven，我认为这就是为什么在让 Netbeans 8.0.2 包含我的 jar 时遇到问题库中的文件以将它们放入 jar 文件中。我正在考虑如何在 Eclipse 中使用没有 Maven 的 jar 文件。

编译所有依赖项和插件的是 Maven。不是 Netbeans。（如果你能让 Netbeans 做到这一点，请告诉我们如何 (^.^)v ）

[已解决 - 适用于 Linux] 通过打开终端。

然后

cd /MyRootDirectoryForMyProject

下一个

mvn org.apache.maven.plugins:maven-compiler-plugin:compile

下一个

mvn 安装

这将在目标目录中创建 jar 文件。

MyJarFile-1.0-jar-with-dependencies.jar

现在

光盘目标

（您可能需要运行：chmod +x MyJarFile-1.0-jar-with-dependencies.jar）最后

java -jar MyJarFile-1.0-jar-with-dependencies.jar

请参见

[https://cwiki.apache.org/confluence/display/MAVEN/LifecyclePhaseNotFoundException](https://cwiki.apache.org/confluence/display/MAVEN/LifecyclePhaseNotFoundException)

我将把这个解决方案发布在有类似问题的其他几个页面上。希望我能从一周的挫折中拯救某人。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-08T19:49:56.013

没有内置的方法可以做到这一点。但是，您可以使用外部工具来归档此文件，例如 OneJar：

[http://one-jar.sourceforge.net/](http://one-jar.sourceforge.net/)

编辑：显然这甚至是 Netbeans 团队希望你这样做的方式：[http ://wiki.netbeans.org/PackagingADistributableJavaApp](http://wiki.netbeans.org/PackagingADistributableJavaApp)

# lua - 带有小延迟的简单计数 [lua, LÖVE]

> ID：10505060
> 
> 赞同：1
> 
> 时间：2012-05-08T19:20:18.363
> 
> 标签：lua, love2d

我是 lua 和 LÖVE 的新手。

我正在尝试以少量延迟对数字进行简单计数，以便用户可以看到计数发生（而不是代码简单地计数然后显示完成的计数）

我有以下代码：

```
function love.draw()
    love.graphics.print("Welcome again to a simple counting sheep excercise.", 50, 50)

    i = 20
    ypos = 70

    while i > 0 do

        love.graphics.print("Number: " .. i .. ".", 50, ypos)
        love.timer.sleep(1)
        i = i - 1
        ypos = ypos + 12

    end

end 
```

但是当我运行它时，它只会挂起约 20 秒，然后显示完成的计数。如何让它在每次迭代之间短暂暂停？我怀疑问题在于draw函数被调用一次，所以它在显示之前完成了所有工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T20:17:40.440

`love.draw()`每秒调用很多次，所以你不应该真的睡觉，因为它会导致整个应用程序挂起。

相反，用于`love.update()`根据当前时间（或基于时间增量）更新应用程序的状态。

例如，我会表达你想要做的事情如下：

```
function love.load()
   initTime = love.timer.getTime()
   displayString = true
end

function love.draw()
    love.graphics.print("Welcome again to a simple counting sheep excercise.", 50, 50)
    if displayString then
        love.graphics.print("Number: " .. currentNumber .. ".", 50, currentYpos)
    end
end

function love.update()
    local currentTime = love.timer.getTime()
    local timeDelta = math.floor(currentTime - initTime)
    currentNumber = 20 - timeDelta
    currentYpos = 70 + 12 * timeDelta
    if currentNumber < 0 then
        displayString = false
    end
end 
```

首先我找到初始时间，然后根据与初始时间的时间差计算数量和位置。差异以秒为单位，这就是为什么我打电话`math.floor`以确保我得到一个整数。

# ruby - 为什么 Nokogiri::CSS.xpath_for 返回一个数组？

> ID：10505062
> 
> 赞同：2
> 
> 时间：2012-05-08T19:20:29.340
> 
> 标签：ruby, xpath, css-selectors, nokogiri

我正在查看 Nokogiri::CSS 的源代码，因为我需要将 CSS 选择器转换为 XPATH。运行示例代码并调用 xpath_for 方法后，我看到它返回了一个数组。为什么是这样？CSS 选择器是否有可能返回多个 xpath？

```
[18] pry(main)> Nokogiri::CSS.xpath_for 'div.divddy input:first'
=> ["//div[contains(concat(' ', @class, ' '), ' divddy ')]//input[position() = 1]"] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T20:15:15.140

一个[CSS 选择器可以包含多个用逗号分隔的组件](http://www.w3.org/TR/selectors/#grouping)：

> **5\. 选择器组**
> 
> 一个以逗号分隔的选择器列表表示由列表中的每个单独选择器选择的所有元素的并集。

例如：

```
div.divddy input:first, div#where_is input.pancakes_house { /*...*/ } 
```

因此，如果您将分组选择器交给它，大概会[`xpath_for`](http://nokogiri.org/Nokogiri/CSS.html#method-c-xpath_for)返回一个数组。例如：

```
>> Nokogiri::CSS.xpath_for 'div.divddy input:first, div#where_is input.pancakes_house'
=> ["//div[contains(concat(' ', @class, ' '), ' divddy ')]//input[position() = 1]", "//div[@id = 'where_is']//input[contains(concat(' ', @class, ' '), ' pancakes_house ')]"] 
```

请注意，在这种情况下，返回的数组长度为 2。

# perl - Perl 不会在对象销毁时调用 DESTROY 的情况？

> ID：10505065
> 
> 赞同：4
> 
> 时间：2012-05-08T19:20:41.357
> 
> 标签：perl

这是我的一个同事遇到的一个令人困惑的问题。而且我也无法找出原因。

简短的版本是，在他编写的一个`DESTROY`定义了析构函数/方法的类中，`DESTROY`当对象被销毁时不会被调用。它不会在我们认为对象超出范围的时候被调用。虽然我们认为在某处可能存在对它的悬空引用，但它也不会在脚本退出时被调用。我们在类和脚本中乱扔了调试`print`语句，甚至在一个`END`块中显式调用它只是为了验证我们没有以某种方式将它放在错误的命名空间中。（我们没有。显式调用`print`按预期触发了所有语句。）

所以我对此感到困惑，并且和他一样对答案感兴趣。什么情况下可能会导致这种行为？有问题的脚本正在干净地退出 - 没有调用`POSIX::_exit`或类似的东西。唯一的“变量”是该类[`Class::MethodMaker`](https://metacpan.org/module/Class%3a%3aMethodMaker)用于定义一些访问器和构造函数。但是，文档中没有提及`Class::MethodMaker`与（或覆盖）类`DESTROY`方法进行交互。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T17:20:39.487

还有另一种不调用 DESTROY 的方法，它没有特别清楚地记录在案。但是，只有在您编写守护程序之类的情况下，它才会影响您。本质上，如果你的进程因为一个信号（甚至是 CTRL-C，实际上是 SIGINT）而死掉，那么它就不会调用 DESTROY 方法。您可以通过使用仅调用 exit() 的信号处理程序来实现它。在下面的示例中，如果程序正常退出或收到 SIGTERM，则调用 DESTROY() 方法：

```
sub _signal_handler {
  exit(0);
}

sub new {
  my ($class) = @_;
  my $self = {};
  bless $self, $class;
  SIG{'TERM'} = \&_signal_handler;
  return $self;
}

sub DESTROY {
  my ($self) = @_;
  print "Destroy method called\n";
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-05T15:08:23.940

没有看到代码，就无法知道出了什么问题。但我可以想象一个场景，看起来您的 DESTROY() 方法似乎没有被调用：

```
#!/usr/bin/perl

use strict;
use warnings;

sub DESTROY {
    die {};
    print "DESTROY\n";
}

{
    print "creating object...\n";
    my $obj = bless {};
    print "it goes out of scope...\n";
}

print "object is out of scope\n"; 
```

此脚本打印：

```
creating object...
it goes out of scope...
object is out of scope 
```

很可能，该错误不像此示例中那样明显。die() 调用可能在 DESTROY 代码中很深。

die() 调用可能是由您没有想到的某些情况引起的。对象在全局销毁期间以任意顺序取消定义：

```
#!/usr/bin/perl

use strict;
use warnings;

sub DESTROY {
    die {} if ! defined $_[0]->[0];
    print "$_[0]->DESTROY()\n";
}

print "creating objects...\n";
my $x = bless [];
my $y = bless [$x];
$x->[0] = $y;
print "before global destruction...\n"; 
```

循环引用不是发生这种情况所必需的。其中一个对象检查它是否可以访问另一个对象。如果访问失败，则抛出异常。

h2h，马蒂亚斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-05-04T13:00:46.433

刚刚发现在一个类中有超过 1 个 DESTROY 子也会导致这种情况，看起来只有最后一个实例被调用。

# php - 如何全局使 CGridView 使用“原始”作为 CDataColumn 的默认类型？

> ID：10505071
> 
> 赞同：2
> 
> 时间：2012-05-08T19:20:52.897
> 
> 标签：php, yii

Yii 中是否有全局设置来更改 htmlentity 显示从`"&copy;" to "©"` admin(ajax grid)/view/ 和编辑视图？

我发现在 CGridView 参数中，我可以将每一列更新为`'type'=>'raw'`如下所示，但我需要在 20 个模型中执行此操作，并且每个视图都需要手动执行，除非我可以在某个地方全局执行此操作。我有一个使用 导入数据的脚本， `&copy;`当客户去编辑一个项目时，他们希望看到`©`。任何帮助都会得到帮助！

```
<?php $this->widget('zii.widgets.grid.CGridView', array(

        'id'=>'item-grid',
        'dataProvider'=>$model->search(),
        'filter'=>$model,

        'columns'=>array(
                'id',
                'price1',
                'price1label',
                'price2',
                'price2label',
                array('name'=>'name','type'=>'raw'), // this will display the raw entity 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T09:34:05.527

Yii 中没有内置这样的功能，但通常情况下，您可以扩展几个类来实现目标。

首先，请注意[这](http://code.google.com/p/yii/source/browse/tags/1.1.10/framework/zii/widgets/grid/CDataColumn.php#51)是您想要更改其默认值的属性。如果你能做到这一点，那么所有的问题都会消失。

既然你不能，你需要扩展`CDataColumn`来实现这一点。死简单：

```
Yii::import('zii.widgets.grid.CDataColumn');

class SpecialDataColumn extends CDataColumn {
    public $type = 'raw'; // that's all!
} 
```

现在的问题是你还需要告诉 Yii 使用你的特殊列类而不是内置的。您可以通过`type`在实例化中指定每列的来做到这一点`CGridView`，但这是不可接受的，因为您仍然需要编辑每个视图中的每一列。所以我们必须研究如何`CGridView`决定使用 a`CDataColumn`并覆盖它。

Grepping 一点表明[这](http://code.google.com/p/yii/source/browse/tags/1.1.10/framework/zii/widgets/grid/CGridView.php#287)是您需要修改的代码。具体来说，有两条感兴趣的线：

```
$column=$this->createDataColumn($column); 
```

和

```
$column['class']='CDataColumn'; 
```

因此，您需要重写`createDataColumn`方法（更改第一行的功能）和`initColumns`方法（编辑第二行）。开始了：

```
Yii::import('zii.widgets.grid.CGridView');

class SpecialGridView extends CGridView {
    protected function initColumns() {
        // copy all of the stock implementation code, changing only
        // $column['class']='CDataColumn' to $column['class']='SpecialDataColumn'
    }

    protected function createDataColumn($text)
    {
        // copy all of the stock implementation code, changing only
        // $column=new CDataColumn($this) to $column=new SpecialDataColumn($this)
    }
} 
```

完成此操作后，您离幸福只差一个编辑：

```
this->widget('SpecialGridView', ...); 
```

您仍然需要在使用数据网格的每个视图中进行此编辑，但查找/替换不应超过几秒钟。

* * *

¹实际上，您*可以*简单地转到框架源中的那个文件，编辑几个字符，保存，问题就解决了。这种方法的问题是，如果你升级到更高版本的 Yii，你的应用程序会在没有警告的情况下恢复到旧的行为。我不推荐它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T04:14:56.117

查看 Yii 的[widgetfactory](http://www.yiiframework.com/doc/guide/1.1/en/topics.theming#customizing-widgets-globally)设置。我不确定它是否会让你为 CDataColumn 指定选项，但这是你可以做到的地方

编辑：看起来你不能以这种方式覆盖 CGridColumn 设置，因为它不直接从小部件类继承。因此，您最好的选择可能是覆盖 CGridView，为您的默认列指定一个自定义类并以这种方式设置公共变量 type='raw'。

您也许可以使用 widgetfactory 来覆盖 CGridView 的默认类，但我没有这样做。因此，您可能会被迫更新所有 CGridView 位置以使用新的 CGridView 类覆盖。

# button - ExtJS 4.1“HoverButton”扩展问题

> ID：10505095
> 
> 赞同：0
> 
> 时间：2012-05-08T19:22:30.563
> 
> 标签：button, extjs, menu, hover, extjs4

我正在开发 Ext.Button 的扩展，它可以在鼠标悬停/鼠标悬停时显示/隐藏按钮的菜单。它对于按钮的直接子菜单非常有效，但是我遇到了一个问题，即让它在任何二级/三级/等菜单中都能正常运行。

现在，当用户在包含菜单的顶部菜单中的项目上移动时，它将打开菜单，用户可以毫无问题地将光标移入其中，一切都将保持打开状态。如果用户随后将光标移出二级菜单进入开放空间，则所有菜单都将关闭，这也是正确的。但是，有时如果用户移动到二级菜单，然后回到其父菜单，所有菜单都会关闭，这不是应该发生的，至少光标现在所在的父菜单应该保持打开状态.

从我最初的调试来看，事件的触发方式及其时间似乎是一个问题。从子菜单移回父菜单时，似乎不会触发父菜单的 mouseenter 事件。其次，在我看来，菜单 mouseover 事件的触发不够可靠或不够频繁，无法在子菜单上的 mouseleave 事件触发后取消延迟的隐藏任务。

问题演示：http: [//qs1724.pair.com/users/autod1nx/EMPLOYEE/BDAMI/hoverbutton/index.html](http://qs1724.pair.com/users/autod1nx/EMPLOYEE/BDAMI/hoverbutton/index.html)

这是代码，它有什么根本性的错误吗？

```
Ext.define('Ext.HoverButton', {    
    extend: 'Ext.Button',
    alias: 'widget.hoverButton',
    isOver: false,
    hideDelay: 250,
    showDelay: 200,

    applyListeners: function(menu, cfg) {
        Ext.apply(menu, cfg);
        Ext.each(menu.items, function(item, idx, allItems) {
            if(item.menu) this.applyListeners(item.menu, cfg);
        }, this);
    },

    initComponent: function() {
        var config = {}, 
            menuConfig = {}, 
            me = this;

        me.delayedShowMenu = new Ext.util.DelayedTask(function() {
            if(!me.isOver) return;
            me.showMenu();
        }, this);

        me.delayedHideMenu = new Ext.util.DelayedTask(function() {
            if(me.isOver) return;
            me.hideMenu();
        });

        if(Ext.isDefined(this.initialConfig.menu)) {
            config = {
                listeners: {
                    mouseover: {
                        scope: me,
                        fn: function(b) {
                            me.isOver = true;
                            me.delayedShowMenu.delay(me.showDelay);
                        }
                    },
                    mouseout: {
                        scope: me,
                        fn: function(b) {
                            me.isOver = false;
                            me.delayedHideMenu.delay(me.hideDelay);
                        }
                    }
                }
            };

            menuConfig = {
                listeners: {
                    mouseover: {
                        scope: me,
                        fn: function(menu, item, e) {
                            me.delayedHideMenu.cancel();
                        }
                    },
                    mouseenter: {
                        scope: me,
                        fn: function(menu, e) {
                            me.delayedHideMenu.cancel();
                        }
                    },
                    mouseleave: {
                        scope: me,
                        fn: function(menu, e) {
                            me.delayedHideMenu.delay(me.hideDelay);
                        }
                    }
                }
            };

            //apply mouseover/leave listeners to all submenus recursively
            me.applyListeners(me.menu, menuConfig);      
        }

        Ext.apply(me, Ext.apply(me.initialConfig, config));
        Ext.HoverButton.superclass.initComponent.apply(me, arguments);
    }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-13T05:19:06.607

我发现这个可行，而且更简单。

```
Ext.define('Ext.HoverButton', {
extend    : 'Ext.Button',
alias     : 'widget.hoverButton',
listeners : {
        mouseover : function() {
            this.showMenu();
        },
        menushow : function() {
            this.mouseLeaveMonitor = this.menu.el.monitorMouseLeave(100, this.hideMenu, this);
        },
        destroy : function(combo) {
            combo.menu.el.un(combo.mouseLeaveMonitor);
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T17:14:40.260

我一直在做一些类似的事情，在浏览[http://www.quirksmode.org/dom/events/mouseover.html后我已经解决了这个问题](http://www.quirksmode.org/dom/events/mouseover.html)

似乎 DOM 的事件顺序应该是 mouseover -> mouseenter -> mouseout -> mouseleave，这意味着有时会在设置 delay() 之前调用 cancel()。为了解决这个问题，我将最后输入的内容保留在变量中：

```
mouseenter: {
 scope: me,
 fn: function(menu, e) {
  presentlyInside = menu; /* << */
  me.delayedHideMenu.cancel();
 }
},
mouseleave: {
 scope: me,
 fn: function(menu, e) {
  if(presentlyInside==menu) /* << */
    me.delayedHideMenu.delay(me.hideDelay);
 }
} 
```

希望能帮助到你！

# java - JExcelAPI 是否适用于 jre 1.5？

> ID：10505096
> 
> 赞同：0
> 
> 时间：2012-05-08T19:22:34.960
> 
> 标签：java, jexcelapi

我已经下载了 JExcelAPI 版本 2.6.12，但我无法使用 JRE 1.5 运行它，只能使用 JRE 1.6。

有人可以证实这一点吗？或者也许指出哪个版本的 JExcel 适用于 JRE 1.5？我无法在 JExcel 网站上找到它。

我需要在仅限于使用 JRE 1.5 的项目中使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:34:27.373

也许您可以尝试 Apache POI 的 HSSF ...根据我的经验，大多数使用原生 Excel 格式的项目都使用它。

[http://poi.apache.org/spreadsheet/quick-guide.html](http://poi.apache.org/spreadsheet/quick-guide.html)

# apache-flex - Adobe Flex List Itemrenderer：无法滚动列表

> ID：10505099
> 
> 赞同：2
> 
> 时间：2012-05-08T19:22:54.420
> 
> 标签：apache-flex, list, adobe, itemrenderer

我已经成功设置了一个列表，该列表从数据库中提取用户并将它们显示在列表中。我目前正在使用 itemrenderer 自定义列表，并且进展顺利。我可以拉出一个用户的头像，然后在它的右边我会显示他们的名字，下面是他们的年龄。问题是我只能将 4 个结果放入列表中，并且我可以看到第 5 个的顶部，但是没有滚动条。我会显示一个打印屏幕，但我在我的数据库中填充了关于我的朋友和他们的 Facebook 详细信息的真实信息，所以我宁愿不这样做。

在我的主 mxml 程序中，我有以下代码：

```
<s:List id="resultList" includeIn="loggedin" x="120" y="246"
      width="100%" itemRenderer="userList">   
    <s:layout>  
        <s:VerticalLayout useVirtualLayout="true" requestedMinRowCount="1"/>  
    </s:layout>  
    <s:AsyncListView list="{getUserResult.lastResult}"/>  
</s:List> 
```

在`userList.mxml`我有以下代码：

```
<s:ItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009" 
                xmlns:s="library://ns.adobe.com/flex/spark" 
                xmlns:mx="library://ns.adobe.com/flex/mx" 
                autoDrawBackground="true">  
    <s:Image id="fbImg" source="http://graph.facebook.com/{data.facebookid}/picture?type=normal" x="0" y="0"/>  
    <s:Label id="usernameLbl" x="120" y="0" fontFamily="Calibri" fontSize="25" fontWeight="bold" text="{data.firstname} {data.lastname}"/>  
    <s:Label id="ageLbl" text="{data.dob}" x="120" y="40" />  
</s:ItemRenderer> 
```

有人知道为什么我不能滚动所有结果吗？我敢肯定这是我不知道的非常简单的事情。
编辑：我很抱歉这种可怕的格式。我似乎无法让我的代码很好地显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:57:18.290

为您的列表分配一个高度，世界上一切都将是正确的。如果你不这样做，它假定它可以延伸到页面底部以显示所有数据，即使你看不到它。

```
<s:List id="resultList" includeIn="loggedin" x="120" y="246"
  width="100%" height="100%" itemRenderer="userList">   
<s:layout>  
    <s:VerticalLayout useVirtualLayout="true" requestedMinRowCount="1"/>  
</s:layout>  
<s:AsyncListView list="{getUserResult.lastResult}"/> 
```

PS 很好的问题，有很多细节和完美的代码量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-08T04:26:25.393

List 看到百分比高度（height="100%"）时遇到问题。因此，我必须使用诸如 height="{myContainer.height}" 之类的东西来设置它并且它起作用了。

# php - 在 PHP 中使用引号时的问题

> ID：10505101
> 
> 赞同：0
> 
> 时间：2012-05-08T19:23:13.650
> 
> 标签：php, quotes

我了解到引号在 PHP 中并不重要。

但是在下面的代码中，如果我尝试在`eval()`;中使用单引号 我收到错误，另一方面代码可以正常使用双引号。

```
$a = '2';
$b = '3';
$c = '$a+$b';
echo $c.'<br/>';
eval("\$c = \"$c\";");
//eval('\$c = \'$c\';');  //Parse error: syntax error, unexpected T_VARIABLE, expecting T_STRING
echo $c; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:26:49.170

行情很重要;-)

```
<?php

$color = "red";

echo "My car is $color"; // Outputs "My car is red"
echo 'My car is $color'; // Outputs "My car is $color"

?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:27:52.327

[PHP.net](http://php.net/manual/de/language.types.string.php)说使用单引号时不会扩展转义序列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T19:25:11.220

与双引号不同，PHP 不解析单引号中的变量。

**例子：**

```
$name = 'John';
echo 'hello $name'; // hello $name
echo "hello $name"; // hello John 
```

[更多信息](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.single)

* * *

`eval`仅供参考，出于安全原因，在生产环境中使用并不是一个好主意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T19:28:36.307

使用`eval`是一个`bad idea`，但如果你这样做，`learning purpose`那么正确的方法是

```
 eval("\$c = \$c;"); 
```

.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T19:26:16.043

[不要在这里使用 eval](https://www.google.com/search?q=eval%20is%20evil)和更新你的[字符串引用技巧](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.single)：

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-08T19:34:11.293

以下示例摘自：[The PHP Manual](http://php.net/manual/en/language.types.string.php)

```
<?php
echo 'this is a simple string';

echo 'You can also have embedded newlines in 
strings this way as it is
okay to do';

// Outputs: Arnold once said: "I'll be back"
echo 'Arnold once said: "I\'ll be back"';

// Outputs: You deleted C:\*.*?
echo 'You deleted C:\\*.*?';

// Outputs: You deleted C:\*.*?
echo 'You deleted C:\*.*?';

// Outputs: This will not expand: \n a newline
echo 'This will not expand: \n a newline';

// Outputs: Variables do not $expand $either
echo 'Variables do not $expand $either';
?> 
```

# gdb - gdb 引用的“系统提供的 DSO”是什么？

> ID：10505102
> 
> 赞同：4
> 
> 时间：2012-05-08T19:23:24.637
> 
> 标签：gdb, llvm-gcc

我正在运行 gdb，`set verbose on`我试图理解我收到的消息之一：

```
Reading symbols from system-supplied DSO at 0x7ffff7ffb000...(no debugging symbols found)...done. 
```

是什么`system-supplied DSO`？经过一番搜索，我认为这`DSO`可能代表“动态共享对象”。但是我仍然不明白 gdb 在这里做什么以及如何解决找不到调试符号的问题（或者它是否重要）。

此外，我正在调试的程序正在使用 llvm-gcc 进行编译，并应用了 LLVM 通行证。我认为这会影响 gdb 的行为，但我不确定如何。

所以本质上我的问题是 gdb 打印的消息是什么意思，它是否可能导致问题，如果是这样，我有什么建议可以帮助 gdb 找到调试符号。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-10-07T20:35:26.257

在此上下文中，system-supplied-DSO 是指由 linux 内核直接提供的共享库，例如 VDSO。Debuginfo 确实可供他们使用，但与内核而不是用户空间一起打包。如果您的发行版支持，请使用`debuginfod`自动获取它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-04T15:02:43.140

根据[本](http://www.icl.utk.edu/%7Emucci/MPPopt/additional/MIPSPRO_TUNE/11chap3.pdf)文档，DSO 是：

> 动态共享对象 (DSO) 是一个对象文件，旨在在多个应用程序（a.out 文件）执行时同时使用或共享它们。

我相信系统提供的 DSO 只是操作系统提供并由主可执行文件加载的 DLL。由于这是一个外部库，除非您单独下载它们，否则您没有此类对象的调试符号。通常，发布二进制文件会去除调试符号，但它们可以具有指向单独文件的链接。典型的 Linux 发行版提供了一个包含此类二进制文件的调试符号的软件包（如基于 RedHat 的发行版的 xxx-debuginfo-xxx.rpm）。

# c# - 根据日期，从 XML 获取今天和接下来两天的值？

> ID：10505103
> 
> 赞同：0
> 
> 时间：2012-05-08T19:23:24.677
> 
> 标签：c#, linq, linq-to-xml

目标：根据今天的日期和月份，从 XML 中获取实际和接下来两天的值。

问题：虽然我的 c.Attribute("Day").Value 发生了变化，但我的 c.Attribute("Month").Value 保持不变。因此，如果实际日期是 30.04.2012，那么它将显示 30.04.2012 的祈祷时间，而不是 01.05.2012 和 02.05.2012。如何解决这个问题？

我也不确定这`Dato = c.Attribute("Day").Value + "." + c.Attribute("Month").Value + "." + myDay.Year.ToString(),`是否有好处？我希望列表框显示它获取的 xml 的日期。

请帮忙。我的代码、XML 和下面的类。

```
var filteredData3 = from c in loadedCustomData.Descendants("PrayerTime")
    where int.Parse(c.Attribute("Day").Value) >= myDay.Day && int.Parse(c.Attribute("Day").Value) < (myDay.Day + 3) 
    && c.Attribute("Month").Value == myDay.Month.ToString()

        select new Bønn()
        {

        Dato = c.Attribute("Day").Value + "." + c.Attribute("Month").Value + "." + myDay.Year.ToString(),
        Fajr = TimeSpan.Parse(c.Attribute("Fajr").Value),
        Sunrise = TimeSpan.Parse(c.Attribute("Sunrise").Value),
        Zohr = TimeSpan.Parse(c.Attribute("Zohr").Value),
        Asr = TimeSpan.Parse(c.Attribute("Asr").Value),
        Maghrib = TimeSpan.Parse(c.Attribute("Maghrib").Value),
        Isha = TimeSpan.Parse(c.Attribute("Isha").Value),
        Jumma = TimeSpan.Parse(c.Attribute("Jumma").Value),

        };

listBox1.ItemsSource = filteredData3; 
```

这是我的课：

```
public class Bønn
{

    public TimeSpan Fajr { get; set; }
    public TimeSpan Sunrise { get; set; }
    public TimeSpan Zohr { get; set; }
    public TimeSpan Asr { get; set; }
    public TimeSpan Maghrib { get; set; }
    public TimeSpan Isha { get; set; }
    public TimeSpan Jumma { get; set; }

    public string Dato { get; set; }

} 
```

这是我的 XML：

```
<PrayerTime
        Dag ="30" 
        Måned="4" 
        Fajr="04:09" 
        Sunrise="05:19" 
        Zohr="13:19" 
        Asr="18:30"
        Maghrib="21:14" 
        Isha="22:24" 

    />
    <PrayerTime
        Dag ="1" 
        Måned="5" 
        Fajr="04:08" 
        Sunrise="05:16" 
        Zohr="13:19" 
        Asr="18:31"
        Maghrib="21:17" 
        Isha="22:25" 

    />
    <PrayerTime
        Dag ="2" 
        Måned="5" 
        Fajr="04:06" 
        Sunrise="05:13" 
        Zohr="13:19" 
        Asr="18:33"
        Maghrib="21:19" 
        Isha="22:27" 
    /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:29:40.407

我建议您将“模型”类更改为使用`DateTime`而不是`string`日期。*将所有*元素转换为您的模型类，*然后进行*过滤。这比尝试根据属性进行算术运算要简单得多。

另请注意，使用显式转换 from`XAttribute`比`int.Parse`在任何地方调用更简单。我实际上建议`FromXElement`在您的模型类中创建一个静态方法，这样您就可以编写：

```
DateTime start = DateTime.Today;
// We'll use this as an *exclusive* upper bound
DateTime end = start.AddDays(3);

var query = from c in loadedCustomData.Descendants("PrayerTime")
            let bonn = Bønn.FromXElement(c)
            where bonn.Dato >= start && bonn.Dato < end;
            select bonn; 
```

或者在扩展方法语法中：

```
// start and end as before
var query = loadedCustomData.Descendants("PrayerTime")
                .Select(c => Bønn.FromXElement(c))
                .Where(bonn => bonn.Dato >= start && bonn.Dato < end); 
```

# jquery - 单页应用程序和 $(window).bind('load', function() {....}

> ID：10505110
> 
> 赞同：0
> 
> 时间：2012-05-08T19:23:43.237
> 
> 标签：jquery

当窗口在单页应用程序中完全加载时，我使用此代码通过绑定它来加载图像库：

```
$(window).bind("load", function() {
    console.log("window loaded");
    $("div#gallery").slideViewerPro({
        autoslide: true,
        thumbsVis: false,
        galBorderWidth: 1,
        galBorderColor: "#003f00"
    });
}); 
```

此事件仅在窗口已加载时有效，并且在单页应用程序的情况下，此事件只有一个回调权限，并且仅在加载窗口后才有效？每当我的页面发生变化时，$(window).bind(......) 的回调就再也不会被调用了？！例如，在单页应用程序中使用 jQuery 请求更改内容更合适。jQuery 中是否有 haschange() 或 dom_has_loaded()？

我希望我清楚地指出了这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:56:58.690

jQuery 中没有任何方法可以做你想做的事情。这将需要可能并非所有浏览器都支持的 DOM 突变事件或效率不高的 setInterval。

相反，将自定义事件绑定到窗口并在您更改页面内容时触发该事件。

```
$(window).bind("contentChanged load",function(){
    console.log("window loaded or changed");
    $("#gallery").slideViewerPro({ // div#gallery is very inefficient
        autoslide: true,
        thumbsVis: false,
        galBorderWidth: 1,
        galBorderColor: "#003f00"
    });
}); 
```

后来：

```
$("#content").load("somepage.php",function(){
    $(window).trigger("contentChanged");
}); 
```

# circos - 你好世界马戏团的例子？

> ID：10505120
> 
> 赞同：6
> 
> 时间：2012-05-08T19:24:38.820
> 
> 标签：circos

有人可以为我提供马戏团的“hello world”示例吗？(www.circos.ca)

我知道压缩发行版提供了大量教程，但我学习的方式是采用最低限度的配置，然后从中构建——我找不到。

那么，有人帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:16:02.353

circos 的开发者在另一个论坛上回答了我的问题：

[https://groups.google.com/forum/?fromgroups#!topic/circos-data-visualization/FGWmZqNexoM](https://groups.google.com/forum/?fromgroups#!topic/circos-data-visualization/FGWmZqNexoM)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T08:37:43.360

是的，Martin（circos 的作者）在 circos 的 google 组（[http://groups.google.com/group/circos-data-visualization](http://groups.google.com/group/circos-data-visualization)）中非常好。

顺便说一句，你的问题很简单 :) 下载并安装 circos 后，只需按照以下步骤操作：

```
cd your-circos-root-dir
bin/circos -conf example/circos.conf 
```

也许你在安装circos的时候会遇到一些常见的错误，比如perl模块安装错误，请看这里：[http ://circos.ca/documentation/tutorials/configuration/](http://circos.ca/documentation/tutorials/configuration/)

# html - 我怎样才能让这个文本一直坐在左边？

> ID：10505121
> 
> 赞同：6
> 
> 时间：2012-05-08T19:24:38.750
> 
> 标签：html, css

**编辑：**这是情况的[小提琴](http://jsfiddle.net/simple/LXyGB/)。

好的，所以我正在构建一个网页，但我遇到了一个令人讨厌的字体怪癖。似乎无衬线字体拒绝精确地位于它们所在的框的左边缘。

这里有一些实验性的 HTML 来演示这个问题：

```
<html>
<head>
    <style>
        .box {
            margin: 30px 0px 0px 30px;
            border: 1px solid #f00;
        }
    </style>
</head>
<body style="font-size: 36px;">
    <!-- text beginning with 'M', which has serifs protruding from the left side in a serif font -->
    <div class="box" style="font-family: 'Segoe UI';">My text</div> <!-- sans-serif -->
    <div class="box" style="font-family: 'Times New Roman';">My text</div> <!-- serif -->
    <div class="box" style="font-family: 'Arial';">My text</div> <!-- sans-serif -->
    <div class="box" style="font-family: 'Garamond';">My text</div> <!-- serif -->

    <!-- text beginning with 'T', which has no left-protruding serifs in a serif font -->
    <div class="box" style="font-family: 'Segoe UI';">Text</div> <!-- sans-serif -->
    <div class="box" style="font-family: 'Times New Roman';">Text</div> <!-- serif -->
    <div class="box" style="font-family: 'Arial';">Text</div> <!-- sans-serif -->
    <div class="box" style="font-family: 'Garamond';">Text</div> <!-- serif -->
</body>
</html> 
```

关于 CSS 属性的任何想法我可以设置/修改以使文本位于其容器的左边缘？优雅地，就是 - 我真的不喜欢逐个字符的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T21:07:52.777

我不确定你是否是这个意思，但它可能是从 M 到其边界的“边距”......

好吧，让我解释一下字体...

每个字母在其所在的位置都有固定大小的“框”。因此，如果字体的创建者没有使用整个房间，则可能会发生这种效果！意味着，除了编辑字体，你不能做任何事情！

[这是我的意思的示例（创建字体的演练）。](http://ilovetypography.com/2007/10/22/so-you-want-to-create-a-font-part-1/)

示例图片，您可以在其中看到上 M 的距离……因此，如果您不使左侧 M 破折号弯曲，请笔直进行，就像在您的版本中一样，您的边框和 M 之间会有一个“间隙”！:)

![字体字符框](../Images/d8fc2f3e22c234c004a3c95e0739cba5.png)

如果您选择文本，您可以看到该字符是正确的。“蓝色”选择会告诉您它与边框笔直且没有间隙，如果出现渲染或 css 错误不会发生什么！

我希望我能帮助你回答这个问题。

# java - 通过扩展 DefaultMessage 创建一个类

> ID：10505130
> 
> 赞同：0
> 
> 时间：2012-05-08T19:25:20.090
> 
> 标签：java, apache-camel

我正在尝试重用 DefautMessage 类将正文发送到 seda 组件。我的消息类在下面给出，没有实现。

```
public class TestMessage extends DefaultMessage{
} 
```

然后我将其作为

```
TestMessage msg = new TestMessage();
            msg.setBody(doc);
            getCamelContext().createProducerTemplate().sendBody("seda:inputDoc",msg); 
```

但是在运行应用程序时，我遇到了以下异常：

```
Caused by: org.apache.camel.InvalidPayloadException: No body available of type: org.dom4j.Document but has value: Message: org.dom4j.tree.DefaultDocument@122bfd6 [Document: name testDocument] of type: com.test.TestMessage on: Message: Message: org.dom4j.tree.DefaultDocument@122bfd6 [Document: name testDocument] 
```

我的实施有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:47:20.787

我认为你包装了错误的对象它期待 org.dom4j.Document 但它得到了 org.dom4j.tree.DefaultDocument

什么是文档类型？？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T05:47:09.537

通常您不需要定义自己的消息类。只需使用骆驼的 DefaultMessage 并设置您需要的正文和标题。您尝试扩展 DefaultMessage 是否有特殊原因？

# css - 跨浏览器平台测试

> ID：10505134
> 
> 赞同：0
> 
> 时间：2012-05-08T19:25:29.817
> 
> 标签：css, internet-explorer, cross-browser, cross-platform

我正在为我们在 2 个平台 win xp 和 win 7 上的 ie8 开发中使用的 extjs 库运行一些测试。

我注意到win xp上的ie8网格表没有正确对齐。但是win7上的IE8看起来很完美。

应用跨浏览器/跨平台修复的最佳方式是什么？

我是应用浏览器特定的 CSS 还是选择语句修复？任何建议将不胜感激。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:33:36.963

我要做的第一件事是在这两种情况下运行开发人员工具 (F12)，并确保浏览器模式和文档模式在两种情况下都相同。如果它们设置为 IE8 模式，则页面应该以相同的方式呈现。

# php - HTML中的多个隐藏字段

> ID：10505135
> 
> 赞同：0
> 
> 时间：2012-05-08T19:25:36.647
> 
> 标签：php, html, ajax

我正在创建一个弹出对话框，我需要在其中以隐藏格式放置一组值，但是当我在 AJAX 帖子中获取值时，我只得到最后一个值。

这是 PHP 部分：

```
$plan_ids=array();
foreach($test_plan as $plan)
{
    $plan_ids[]=$plan['plan_id'];
}
?>

<?php
foreach($plan_ids as $id)
{
    echo "<input type='hidden' id='plan_id' value='$id'>";
}
//var_dump($plan_ids);
// echo $plan['plan_id'];
?> 
```

在 AJAX 部分我正在做：

```
$("#save").click(function () {
    var name = $('#name').val();
    var id = $('#release_id').val();
    var plan_id = $('#plan_id').val();
    //alert('hello');
    $.ajax({
        type: 'POST',
        url: '/api/api.php?action=put_iteration&name=' + name + '&id=' + id + '&plan_id=' + plan_id,
        data: "name=" + name + "&id=" + id + "&plan_id=" + plan_id,
        success: function () {
            $('#save').hide(function () {
                $('div.success').fadeIn();
            });
        }
    });
}); 
```

我对 HTML 隐藏字段一无所知。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:33:32.410

不是 PHP 人，但有一些想法。请原谅我的语法错误。

在循环中，您正在创建具有相同 ID 的隐藏元素。这是不好的。更改 ID 将（应该始终）唯一的代码。

```
<div>
foreach($plan_ids as $id)
{
    echo "<input type='hidden' id='plan-$id' value='$id' class='myHidden'>";
} 
```

现在在您的脚本中，使用基于隐藏项的 jQuery 选择器

var hiddenItems=$("input[type='hidden']");

可能现在你可以通过这个循环

```
 var items
   $.each(hiddenItems,function(item,index){
      items+= hiddenItems[index];
   }); 
```

或者您可以`map`像这样运行，以便它给出隐藏字段的值列表，以逗号分隔。

```
 var itemsJoined=$("input[type='hidden']").map(function () {
        return this.value;
    }).get().join(','); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:33:29.443

我认为您想更改`id='plan_id'`为`name='plan_id[]'`开始...。您只能拥有一个具有给定 id 的元素（即 id 必须在给定页面中的元素之间是唯一的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T19:35:52.543

您可以将所有隐藏字段命名为数组`name="plan_id[]"`

而不是将其作为字符串传递，您可以在隐藏字段周围有一个包装 FORM，然后使用[jquery serialize 函数](http://api.jquery.com/serialize/)来发布它

现在您将在 POST 变量中以数组的形式获取所有 plan_id

添加示例

```
<?php
echo '<form name="planidform" id="planidform">';
foreach($plan_ids as $id)
{
    echo "<input type='hidden' name="plan_id[]" value='$id'>";
}
echo '</form>';
?> 
```

在 jQuery 之后，请按以下方式进行操作：

```
data: "name=" + name + "&id=" + id + "&"+$("#planidform").serialize(), 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T19:36:09.507

您应该将不同的名称/ ID 放入隐藏字段。如果你想一次性提交它们，你可以将它们存储在一个数组中。例如：

```
$i=0;
foreach($plan_ids as $id){
$i++;
echo "<input type='hidden' id='plan_id_$i' value='$id'>";} 
```

然后你可以在 JS 中对它们进行寻址或分组。

# desire2learn - Desire2Learn 效价 API 用户 ID

> ID：10505137
> 
> 赞同：1
> 
> 时间：2012-05-08T19:25:41.297
> 
> 标签：desire2learn

获取以下 Valence Grades API 中使用的用户 ID 的首选方法是什么？

PUT /d2l/api/le/(D2LVERSION: 版本)/(D2LID: orgUnitId)/grades/(D2LID:gradeObjectId)/values/(D2LID: userId)

此处的用户 id 是否与身份验证期间收到的令牌 ID 相同，还是您调用“whoami”API，还是其他？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:24:34.337

“whoami”调用提供有关您正在使用的当前 UserContext 的数据（您在身份验证步骤中获取的令牌值）。例如，如果您以管理员身份登录，则会返回管理员的用户 ID。

[WhoAmI API 调用](http://docs.valence.desire2learn.com/res/user.html#get--d2l-api-lp-%28D2LVERSION-version%29-users-whoami "WhoAmI API 调用")

```
GET /d2l/api/lp/(D2LVERSION: version)/users/whoami 
```

这将为您提供有关当前 UserContext 的信息

```
{
    "Identifier": "<string:D2LID>",
    "FirstName": "<string>",
    "LastName": "<string>",
    "UniqueName": "<string>",
    "ProfileIdentifier": "<string:D2LID>"
} 
```

如果您正在寻找特定 orgUnit 中用户的 UserId，我会进行以下调用：

[类列表 API 调用](http://docs.valence.desire2learn.com/res/enroll.html#get--d2l-api-le-%28D2LVERSION-version%29-%28D2LID-orgUnitId%29-classlist- "类列表 API 调用")

```
GET /d2l/api/le/(D2LVERSION: version)/(D2LID: orgUnitId)/classlist/ 
```

这将为您提供一个 ClasslistUsers 数组

```
{
    "Identifier": "<string:D2LID>",
    "ProfileIdentifier": "<string:D2LID>",
    "DisplayName": "<string>",
    "UserName": "<string>|null",
    "OrgDefinedId": "<string>|null",
    "Email": "<string>|null"
} 
```

在任何一种情况下，“标识符”值都是您要用于 (D2LID:UserId) 的值

# php - 如何在 PHP 中解析以格式化用户提交的帖子？

> ID：10505139
> 
> 赞同：0
> 
> 时间：2012-05-08T19:25:58.570
> 
> 标签：php, parsing, formatting

我想为用户提供一些格式化选项，例如 Reddit 或 stackOverFlow，但希望将其保留在 PHP 中。如何解析 PHP 中的字符串以使其识别类似的模式`**[anything here]**`？

explode() 似乎并没有像我想的那样优雅地解决问题。我应该只使用基于explode（）输出的嵌套ifs和fors吗？这里有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:29:38.363

其他人已经做过无数次了，我建议使用现有的库。例如可以使用 Markdown： http: [//michelf.com/projects/php-markdown/](http://michelf.com/projects/php-markdown/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-08T19:32:28.597

检查正则表达式：

```
$string = '*bold* or _underscored_ or even /italic/ ..';
// italic
$string = preg_replace('~/([^/]+)/~', '<i>$1</i>', $string);
// bold
$string = preg_replace('/\*([^\*]+)\*/', '<b>$1</b>', $string);
// underscore
$string = preg_replace('/_([^_]+)_/', '<u>$1</u>', $string);

echo $string; 
```

输出：

```
<b>bold</b> or <u>underscored</u> or even <i>italic</i> .. 
```

或使用 BBCode 解析器。

# php - 使用正则表达式的选择性格式

> ID：10505140
> 
> 赞同：0
> 
> 时间：2012-05-08T19:25:59.267
> 
> 标签：php, html, regex

我有一个非常复杂但格式正确的 HTML 字符串，其中包含很多链接。我的部分任务是将所有锚点转换为带有“XX1”字样的粗体。在不使用 jQuery/js 的情况下，这可以在 PHP 中完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:31:12.273

您可以`preg_replace`为此使用，请尝试：

```
preg_replace('/(<a.*>.*XX1.*<\/a>)/imU', '<b>${1}</b>', $html); 
```

没有测试模式，但应该可以。

# django - Django：有没有包含所有 wordpress 功能的 django 博客或 cms 引擎？

> ID：10505142
> 
> 赞同：4
> 
> 时间：2012-05-08T19:26:14.883
> 
> 标签：django, content-management-system, django-cms

正如它所说，我想要具有 wordpress 功能的 django cms 引擎。

我想建立类似[tutsplus.com](http://tutsplus.com)网络的东西，但希望它在 python/django 基础中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:39:14.657

Django 是一个框架，因此在大多数情况下，它会比 wordpress 更复杂一些，以便开箱即用地制作像 tutsplus 这样的东西。

查看 [http://pinaxproject.com/](http://pinaxproject.com/)（我挖掘 pinax）或 [https://github.com/nathanborror/django-basic-apps](https://github.com/nathanborror/django-basic-apps)

但是您可能还想深入研究基于 django 的 CMS（通过其他帖子），例如：

[Django CMS 哪个最好？](https://stackoverflow.com/questions/3515320/django-cms-which-is-the-best) [将现有的博客代码集成到 Django-CMS 中？](https://stackoverflow.com/questions/10099822/integrate-existing-blog-code-into-django-cms)

此处提供基于 Django 的 CMS 的更详细列表：http: [//djangopackages.com/grids/g/cms/](http://djangopackages.com/grids/g/cms/)

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-16T03:49:12.180

我有使用 django-cms 的经验，我发现它有很好的文档记录并且很容易上手。我仍然必须找出将表格放入其中的好方法。

# javascript - 为什么 jQuery Extend Deep Copy 不递归复制对象？

> ID：10505144
> 
> 赞同：9
> 
> 时间：2012-05-08T19:26:20.703
> 
> 标签：javascript, jquery, extend, javascript-objects, deep-copy

我到处搜索，发现类似的问题并没有真正解决我的问题，所以如果这似乎是重复，我深表歉意，但从我的实验来看，jQuery 的深层复制功能实际上并没有像描述的那样工作（或也许我误读了它的描述）。

这是一个演示我遇到的问题的示例：http: [//jsfiddle.net/wcYsH/](http://jsfiddle.net/wcYsH/)

或者这个下载： [https ://github.com/kevroy314/jQuery-Extend-Test](https://github.com/kevroy314/jQuery-Extend-Test)

为什么操作深拷贝时，前一个副本中的数据会发生变化？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T23:51:17.120

一方面，您没有创建普通对象。

我正在查看 jQuery 1.7.2 的源代码以进行扩展。

[https://github.com/jquery/jquery/blob/master/src/core.js](https://github.com/jquery/jquery/blob/master/src/core.js)

我注意到这条线：

```
if ( deep && copy && ( jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)) 
```

必须评估才能`true`进行深度复制。复制只是被复制的当前对象的一部分。

但是您不是在创建“普通”对象。您正在创建通过使用 new 运算符调用构造函数生成的对象。

现在，在 isPlainObject 中，似乎必须评估这些行。（其中 hasOwn 是`hasOwn = Object.prototype.hasOwnProperty`

```
 try {
        // Not own constructor property must be Object
        if ( obj.constructor &&
            !hasOwn.call(obj, "constructor") &&
            !hasOwn.call(obj.constructor.prototype, "isPrototypeOf") ) {
            return false;
        }
    } catch ( e ) {
        // IE8,9 Will throw exceptions on certain host objects #9897
        return false;
    } 
```

它在那里得出结论，它不是“plainObject”。

*当您考虑具有构造函数的对象可能应该通过该构造函数创建*或至少使用某种“克隆”方法时，这是有道理的，就像您在其他语言/框架中看到的那样。

# jboss - EJB 服务器检测

> ID：10505146
> 
> 赞同：1
> 
> 时间：2012-05-08T19:26:25.900
> 
> 标签：jboss, version

我想检测我的 EJB 在哪个服务器上运行，特别是在 jBoss 6 和 Glassfish 3 之间。我一直试图从 jBoss 中的 EJB 内部获取 EJBContext，但没有成功（“env not bound”）。

有没有办法从 jBoss 6 的 EJB 中获取服务器名称和版本，或任何其他信息？

我已经能够使用 servlet 上下文从 servlet 内部获取这些信息，但我需要它在 EJB 中。

谢谢

# ios5 - 如何在视图控制器容器中呈现第一个视图控制器

> ID：10505149
> 
> 赞同：4
> 
> 时间：2012-05-08T19:26:38.057
> 
> 标签：ios5, uiviewcontroller, uiviewanimation

我根据视图控制器上的 iOS 文档编写了一个自定义视图控制器容器，我正在努力寻找一种优雅的方式来呈现第一个视图控制器，该控制器还可以`viewWillAppear:`自动转发相关的显示消息。

当我尝试`transitionFromViewController:toViewController:duration:options:animations:completion:`使用时`fromViewController:`，`nil`我得到一个错误。我已经使用动画块将视图动画化到视图层次结构中`UIView`。这似乎打破了外观方法的自动转发，意味着我有责任在适当`viewWillAppear:`的`ViewDidAppear:`时候调用。有没有更有效的方法将第一个视图转换到处理外观和旋转方法的屏幕上？

我的代码在第一个视图控制器中看起来有点像这样。

```
self.visibleViewController = [[UIViewController alloc] init];
[self addChildViewController:self.visibleViewController];

[self.visibleViewController viewWillAppear:YES];
[self.visibleViewController.view setAlpha:0];
[self.view addSubview:self.visibleViewController.view];

[UIView animateWithDuration:0.5 
                      delay:0 
                    options:UIViewAnimationOptionCurveEaseOut 
                 animations:^{
                     self.visibleViewController.view.alpha = 1;
                 }
                 completion:^(BOOL finished){
                     [self.visibleViewController viewDidAppear];
                     [self.visibleViewController didMoveToParentViewController:self];
                 }]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T11:12:40.950

答案一直隐藏在文档中。

的文档`UIViewController`是

`- (void)beginAppearanceTransition:(BOOL)isAppearing animated:(BOOL)animated`

和同伴

`- (void)endAppearanceTransition`

他们的文档说永远不要从您自己的代码中调用`viewWillAppear`等。您可以使用这些方法正确地启动链条。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:03:22.607

您确定系统不会向您的子视图控制器发送 viewWillAppear/viewDidAppear/DidMoveToParentViewController 消息吗？Apple 文档的这一点暗示它确实：

> 为了让 iOS 将事件正确地路由到子视图控制器和这些控制器管理的视图，您的容器视图控制器必须在将子视图控制器添加到视图层次结构之前将子视图控制器与其自身关联。

我读到的方式是，如果您将视图控制器添加为子视图，然后将子视图的根视图添加到您的视图中，系统应该在您添加视图控制器时发送适当的消息。

尝试手动调用这些方法并在子视图控制器中设置断点以查看它们是否仍然被调用。

# javascript - 如何在javascript中动态生成div id

> ID：10505152
> 
> 赞同：1
> 
> 时间：2012-05-08T19:26:51.700
> 
> 标签：javascript, ruby-on-rails, html, selector

我有一种感觉，这将是那些愚蠢的问题之一。但是，这让我摸不着头脑。

我有一个部分，它根据对象 id 创建一系列具有唯一 id 的 div：

```
<% @contact.email_addresses.each do |email_address| %>
    <div id=<%= "email_address_"+email_address.id.to_s %>>
    .
    . do stuff
    .
    </div>
<% end %> 
```

这给了我一系列看起来像这样的 div：

```
<div id="email_address_13">
  foo@bar.com
  <div class="form_icon" title="edit email address" rel="tooltip" ,="">
    <a data-remote="true" href="/email_addresses/13/edit?contact_id=2">
      <img height="11" width="11" src="/assets/mini_icons/fat_pencil.png" alt="Fat_pencil">
    </a>
  </div>
  <div class="form_icon" title="delete email address" rel="tooltip" ,="">
    <a rel="nofollow" data-remote="true" data-method="delete" data-confirm="Are you sure?" href="/email_addresses/13?contact_id=2">
      <img height="9" width="9" src="/assets/mini_icons/remove.png" alt="Remove">
    </a>
  </div>
</div> 
```

如您所见，在每个 div 中都有一个编辑和取消按钮。到目前为止，一切都很好。

当用户单击编辑按钮时，我想将 div 的内容替换为允许编辑的表单。所以，在我的 edit.js.erb 文件中，我想要：

```
$('#email_address_13').html("<%= escape_javascript(render 'email_address_form')%>") 
```

所以，这就是问题所在。在我的 edit.js.erb 文件中，我如何`email_address_`与 my连接，`email_address.id`以便最终得到看起来像的选择器`'#email_address_13'`？

当我硬编码`'#email_addres_13'`时，一切都很好。所以这只是一个关于如何在我的`edit.js.erb`文件中动态生成我的 div 选择器的问题。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:13:47.317

我会将 id 添加到图标 img 并将其连接到 javascript 级别。您的 HTML 将如下所示（我已将 id 和 class 添加到编辑图标中）：

```
<div id="email_address_13">
    foo@bar.com
    <div class="form_icon" title="edit email address" rel="tooltip" ,="">
        <a data-remote="true" href="/email_addresses/13/edit?contact_id=2">
           <img id="13" class="edit" height="11" width="11" src="/assets/mini_icons/fat_pencil.png" alt="Fat_pencil">
        </a>
    </div>
    <div class="form_icon" title="delete email address" rel="tooltip" ,="">
        <a rel="nofollow" data-remote="true" data-method="delete" data-confirm="Are you sure?" href="/email_addresses/13?contact_id=2">
            <img height="9" width="9" src="/assets/mini_icons/remove.png" alt="Remove">
        </a>
    </div>
</div> 
```

现在，您的编辑 js 函数将如下所示：

```
$(".edit").click( function() {
    var id = $(this).id;
    $('#email_address_' + id).html("<%= escape_javascript(render 'email_address_form')%>")
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T07:02:14.227

明白了......原来edit.js.erb中的一行代码完成了整个事情。

就串联而言，诀窍是：

`$('#email_address_<%= @email_address.id.to_s %>')`

由于这是在一个 .erb 文件中，我可以使用它`<%= @email_address.id.to_s %>`来抓取`id`（沿途将其从整数转换为字符串）。这需要进入 $() 内部，否则`.html is not a function`会引发错误。所以，整个电话是：

`$($('#email_address_<%= @email_address.id.to_s %>')).html("<%= escape_javascript(render 'email_address_form')%>");`

由于按钮是表单的一部分，因此无需绑定 click 事件。根据定义，当单击按钮时，它会触发控制器方法 ( `edit`) 和关联的 javascript 文件 ( `edit.js.erb`)。

谢谢您的帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T19:38:34.147

您可以将类添加到 div

```
<% @contact.email_addresses.each do |email_address| %>
    <div class='your-class' id=<%= "email_address_"+email_address.id.to_s %>>
    .
    . do stuff
    .
    </div>
<% end %> 
```

并在 edit.js 中使用类选择器而不是 id 选择器

```
$('.your-class').html("<%= escape_javascript(render 'email_address_form')%>") 
```

`

# iphone - 使用 NSPredicate 过滤 NSDictionary 对象的 NSArray

> ID：10505154
> 
> 赞同：12
> 
> 时间：2012-05-08T19:27:00.703
> 
> 标签：iphone, ios, nsarray, nsdictionary, nspredicate

我有一个 NSDictionary 对象的 NSArray。我想使用 NSPredicate 根据字典的键过滤数组。我一直在做这样的事情：

```
NSString *predicateString = [NSString stringWithFormat:@"%@ == '%@'", key, value];
NSPredicate *predicate = [NSPredicate predicateWithFormat:predicateString];
NSArray *filteredResults = [allResultsArray filteredArrayUsingPredicate:predicate]; 
```

如果他们输入的键是一个词，这很好用：颜色、姓名、年龄。但如果 key 是多词则不起作用，例如：Person Age、Person Name。

基本上，任何包含空格的键都不起作用。我尝试在字符串中的键周围加上单引号，就像它们在值方面完成一样，但这也不起作用。也试过双引号，但无济于事。

请就此提出建议。提前致谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-18T05:12:41.633

对我来说，凯文的回答不起作用。我用了：

```
NSPredicate *predicateString = [NSPredicate predicateWithFormat:@"%K contains[cd] %@", keySelected, text];//keySelected is NSString itself
        NSLog(@"predicate %@",predicateString);
        filteredArray = [NSMutableArray arrayWithArray:[YourArrayNeedToFilter filteredArrayUsingPredicate:predicateString]]; 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-08T19:54:35.060

使用动态密钥时，您应该使用`%K`令牌而不是`%@`. 您也不希望值标记周围的引号。它们将使您的谓词针对文字字符串`@"%@"`而不是针对`value`.

```
NSString *predicateString = [NSString stringWithFormat:@"%K == %@", key, value]; 
```

这记录在[Predicate Format String Syntax guide](http://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html#//apple_ref/doc/uid/TP40001795-SW1)中。

* * *

编辑：正如 Anum Amin 指出的那样，`+[NSString stringWithFormat:]`它不处理谓词格式。你想要`[NSPredicate predicateWithFormat:@"%K == %@", key, value]`。

# xslt - 如何使用 XSLT 转换带有元数据的 XML 文档？

> ID：10505157
> 
> 赞同：2
> 
> 时间：2012-05-08T19:27:11.627
> 
> 标签：xslt

我有一个报告生成器工具，可以为不同类型的报告生成 XML 文档。这些 XML 文档中的每一个都有一组字段（以下 XML 文档中的报告：列），用于描述其中的实际数据（以下 XML 文档中的报告：行）。由于字段列表是动态的并且对于每种报告都在不断变化，因此如何编写使用“字段”将数据转换为 csv 文件的通用 XSL 模板。

我的示例 XML 文档：

```
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<reporting:root xmlns:reporting="http://www.something.net/reporting">

  <reporting:default0 reporting:type="Portfolio">
    <reporting:header>      
      <reporting:configuration>
        <reporting:columns>
          <reporting:column reporting:group="instrument" reporting:name="Ident" reporting:tag="ident" reporting:type="int"/>
          <reporting:column reporting:group="prices" reporting:name="Last (Time)" reporting:tag="lastTime" reporting:type="string"/>
          <reporting:column reporting:group="noGroup" reporting:name="RIC" reporting:tag="ric" reporting:type="string"/>
          <reporting:column reporting:group="instrument" reporting:name="Reference" reporting:tag="reference" reporting:type="string"/>
         <reporting:column reporting:group="result" reporting:name="Currency" reporting:tag="currency" reporting:type="string"/>          
        </reporting:columns>
     </reporting:configuration>      
    </reporting:header>
    <reporting:window reporting:Id="36674" reporting:level="0" reporting:name="MY_PORTFOLIO" reporting:parentId="11991">
      <reporting:line reporting:Id="67520135" reporting:level="1" reporting:name="INTERNATIONAL BUSINESS MACHINES CORP" reporting:parentId="36674" reporting:positionType="0">
        <reporting:ident>643633</reporting:ident>        
        <reporting:reference>IBM.USD</reporting:reference>
        <reporting:currency>USD</reporting:currency>        
      </reporting:line>
     <reporting:line reporting:Id="67520179" reporting:level="1" reporting:name="GENERAL ELECTRIC CO" reporting:parentId="36674" reporting:positionType="0">
        <reporting:ident>643635</reporting:ident>
        <reporting:ric>GE.N</reporting:ric>
        <reporting:reference>GE.USD</reporting:reference>
        <reporting:currency>USD</reporting:currency>        
     </reporting:line>
    </reporting:window>
  </reporting:default0>
</reporting:root> 
```

我需要看到格式如下的输出：

```
ident,lastTime,ric,reference,currency
643633,,,IBM.USD,USD
643635,,GE.N,GE.USD,USD 
```

我做了一些工作，但它完成了一半。找不到如何处理“动态”字段列表并将它们用作描述实际数据的标签。

有人可以帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:08:45.787

在 XSLT 中有多种方法可以解决这个问题，但我认为最优雅和可维护的方法是编写一个样式表来处理给定的源文档，并输出一个 XSLT 样式表来进行实际报告。我已经看到这种方法在许多项目中非常成功地使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T21:57:50.837

尝试

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:r="http://www.something.net/reporting">
    <xsl:output method="text" version="1.0"/>
    <xsl:template match="/">
        <xsl:for-each select="/r:root/r:default0/r:header/r:configuration/r:columns/r:column">
            <xsl:value-of select="@r:tag"/>
            <xsl:if test="position() != last()">,</xsl:if>
        </xsl:for-each>
        <xsl:text>&#xA;</xsl:text>
        <xsl:for-each select="/r:root/r:default0/r:window/r:line">
            <xsl:variable name="POSITION" select="position()"/>
            <xsl:for-each select="//r:root/r:default0/r:header/r:configuration/r:columns/r:column">
                <xsl:variable name="TAGNAME" select="@r:tag"/><xsl:value-of select="//r:line[$POSITION]/*[local-name()=$TAGNAME]"/><xsl:if test="position() != last()">,</xsl:if>
            </xsl:for-each>
            <xsl:text>&#xA;</xsl:text>
        </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

请注意，我只是缩短了命名空间前缀以使其更易于阅读（和键入）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T21:42:03.617

```
<xsl:output method="text"/>

<xsl:template match="/">

    <xsl:for-each select="/*:root/*:default0/*:header/*:configuration/*:columns/*:column">
        <xsl:value-of select="@reporting:tag"/>
        <xsl:text>,</xsl:text>
    </xsl:for-each>
    <xsl:for-each select="/*:root/*:default0/*:window/*:line">
        <xsl:variable name="theline"  select="."/>
        <xsl:text>&#x0a;</xsl:text>

        <xsl:for-each select="/*:root/*:default0/*:header/*:configuration/*:columns/*:column" >
            <xsl:variable name="oname"  select="@reporting:tag" />
              <xsl:value-of select="$theline/*[local-name()=$oname]" /><xsl:text>,</xsl:text>
        </xsl:for-each>
    </xsl:for-each>
</xsl:template> 
```

将产生：

ident,lastTime,ric,参考,货币,

643633,,,IBM.USD,USD,

643635,,GE.N,GE.USD,USD,

（你需要坚持检查最后一个去掉最后的逗号。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T13:14:13.173

**这个简短而简单的转换：**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:r="http://www.something.net/reporting">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:variable name="vColNames" select="/*/*/r:header/*/*/*/@r:tag"/>

 <xsl:template match="/">
  <xsl:for-each select="$vColNames">
   <xsl:value-of select="concat(., ',')"/>
  </xsl:for-each>
  <xsl:apply-templates/>
 </xsl:template>

 <xsl:template match="r:line">
  <xsl:variable name="vThis" select="."/>
  <xsl:text>&#xA;</xsl:text>
  <xsl:for-each select="$vColNames">
    <xsl:if test="position() > 1">,</xsl:if>
    <xsl:apply-templates select="$vThis/*[local-name() = current()]"/>
  </xsl:for-each>
 </xsl:template>
</xsl:stylesheet> 
```

**在提供的 XML 文档上运行时：**

```
<reporting:root xmlns:reporting="http://www.something.net/reporting">

  <reporting:default0 reporting:type="Portfolio">
    <reporting:header>
      <reporting:configuration>
        <reporting:columns>
          <reporting:column reporting:group="instrument" reporting:name="Ident" reporting:tag="ident" reporting:type="int"/>
          <reporting:column reporting:group="prices" reporting:name="Last (Time)" reporting:tag="lastTime" reporting:type="string"/>
          <reporting:column reporting:group="noGroup" reporting:name="RIC" reporting:tag="ric" reporting:type="string"/>
          <reporting:column reporting:group="instrument" reporting:name="Reference" reporting:tag="reference" reporting:type="string"/>
         <reporting:column reporting:group="result" reporting:name="Currency" reporting:tag="currency" reporting:type="string"/>
        </reporting:columns>
     </reporting:configuration>
    </reporting:header>
    <reporting:window reporting:Id="36674" reporting:level="0" reporting:name="MY_PORTFOLIO" reporting:parentId="11991">
      <reporting:line reporting:Id="67520135" reporting:level="1" reporting:name="INTERNATIONAL BUSINESS MACHINES CORP" reporting:parentId="36674" reporting:positionType="0">
        <reporting:ident>643633</reporting:ident>
        <reporting:reference>IBM.USD</reporting:reference>
        <reporting:currency>USD</reporting:currency>
      </reporting:line>
     <reporting:line reporting:Id="67520179" reporting:level="1" reporting:name="GENERAL ELECTRIC CO" reporting:parentId="36674" reporting:positionType="0">
        <reporting:ident>643635</reporting:ident>
        <reporting:ric>GE.N</reporting:ric>
        <reporting:reference>GE.USD</reporting:reference>
        <reporting:currency>USD</reporting:currency>
     </reporting:line>
    </reporting:window>
  </reporting:default0>
</reporting:root> 
```

**产生想要的正确结果**：

```
ident,lastTime,ric,reference,currency,
643633,,,IBM.USD,USD
643635,,GE.N,GE.USD,USD 
```

# powershell - Powershell 参数声明替代方案

> ID：10505159
> 
> 赞同：4
> 
> 时间：2012-05-08T19:27:15.633
> 
> 标签：powershell, parameters, declaration

有什么区别：

```
function foo ([int] i, [string] s) { ... } 
```

和：

```
function foo { 
    param (
        [int] i,
        [string] s
    )
    { ... }
} 
```

MSDN 上的帮助没有解释这一点。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T08:14:36.907

除了方便，没有什么区别。两种方式都有效。使用 param（在我看来）更具可读性，尤其是在参数声明可能包含几行代码并且您可以使用缩进和换行符的高级函数中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:31:01.077

在这种情况下没有区别。您可能需要使用`param`高级函数参数的声明

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T03:08:01.937

脚本和脚本块中需要 Param 语句，其中没有像函数中那样定义参数的自然位置。Manojlds 是正确的，如果您使用无法在更传统的参数列表中使用的 param 语句，您有很多机会使用高级函数“选项”来增强函数参数。

# jakarta-ee - JTA 和 Spring @Transactional 注解的区别

> ID：10505160
> 
> 赞同：9
> 
> 时间：2012-05-08T19:27:16.493
> 
> 标签：jakarta-ee, transactions, annotations, jta, spring-transactions

我已经开始使用 Spring 的`@Transactional`注解了，它为管理事务提供了很多便利。然而，在我们的代码中使用这个注解现在使我们依赖于 Spring。我知道对于 JPA 类型的东西，有一个[javax 持久性](http://docs.oracle.com/javaee/5/api/javax/persistence/package-summary.html)包，如果 JPA 注释，我们可以在其中使用各种标记代码，但由于它们都来自`javax.persistence`，因此我们的代码不依赖于任何特定的实现或 ORM。

我想我的问题是是否有任何类似的事务性注释。我找到了一个[javax jta](http://java.sun.com/products/jta/javadocs-1.0.1/index.html)包，但我不确定 Spring 是否真的可以实现任何通用注释。基本上我只是想知道是否有任何类型的通用 javax 类注释，我们可以将它们放在方法上来管理事务功能，以便我们不依赖于 Spring。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-08T20:48:15.417

我认为 JavaEE 6 不像 Spring 那样提供事务分界注释。我认为最接近的类似物是使用 EJB 无状态会话 bean，它们本质上是事务性的，但没有明确划分（如果我错了，请有人纠正我）。

您可以自行决定选择将代码耦合到哪些 API。使用 Spring 的优点`@Transactional`是您独立于所使用的特定事务 API（`@Transactional`可以使用 JTA、JPA、Hibernate 或原始 JDBC 事务，而无需更改代码）。但是，当然，您与 Spring 相关联。

如果注释样式是您想要的，那么我看不出除了 Spring 之外别无选择，除非您想完全接受 JavaEE 并使用 EJB 3.x 样式的注释。

# windows - BCryptGetFipsAlgorithmMode 使用哪些数据来确定 FIP 状态？

> ID：10505162
> 
> 赞同：4
> 
> 时间：2012-05-08T19:27:27.780
> 
> 标签：windows, cryptography, registry, fips, cng

我很难找出决定[`BCryptGetFipsAlgorithmMode()`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa375460%28v=vs.85%29.aspx)返回 TRUE 或 FALSE 的因素。它是否只返回以下状态：

> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\FIPSAlgorithmPolicy\Enabled

或者是别的什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:37:31.667

据我了解：基本上是的。

这是确定您正在运行的系统是否具有组策略中指定的[FIPS 合规性的 C/C++ 方法。](http://support.microsoft.com/kb/811833)使用此功能而不是注册表项，Microsoft 可以在他们认为合适的时候移动注册表项，并确定可以强制执行此规则的其他方式。我怀疑这就是为什么他们提供了一个功能而不仅仅是要检查的密钥的详细信息。

# php - 如何使用 PHP 限制标题标签的长度

> ID：10505165
> 
> 赞同：1
> 
> 时间：2012-05-08T19:27:42.577
> 
> 标签：php, seo, title

我想限制 php.ini 中自动生成的页面标题的字符数。

你能想出任何可以为我做这件事的 php 或 jquery 代码吗，我只需在页面标题中输入我想要的最大字符数（70 个字符）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:31:34.193

这样的事情呢？

```
<title><?php echo substr( $mytitle, 0, 70 ); ?></title> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:31:36.240

这就是 substr 常用的用途。

```
<title><?php print substr($title, 0, 70); ?></title> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T19:31:46.210

您可以使用这个简单的 truncate() 函数：

```
function truncate($text, $maxlength, $dots = true) {
    if(strlen($text) > $maxlength) {
        if ( $dots ) return substr($text, 0, ($maxlength - 4)) . ' ...';
        else return substr($text, 0, ($maxlength - 4));
    } else {
        return $text;
    }

} 
```

例如，在您的模板文件/您输入标题标签的任何位置：

```
<title><?php echo truncate ($title, 70); ?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T19:40:45.937

以前的答案很好，但请使用多字节子字符串：

```
<title><?php echo mb_substr($title, 0, 75); ?></title> 
```

否则多字节字符可能会被拆分。

```
function shortenText($text, $maxlength = 70, $appendix = "...")
{
  if (mb_strlen($text) <= $maxlength) {
    return $text;
  }
  $text = mb_substr($text, 0, $maxlength - mb_strlen($appendix));
  $text .= $appendix;
  return $text;
} 
```

用法：

```
<title><?php echo shortenText($title); ?></title>
// or
<title><?php echo shortenText($title, 50); ?></title>
// or 
<title><?php echo shortenText($title, 80, " [..]"); ?></title> 
```

# ruby-on-rails - 如何使用 Rails 中的值初始化 ActiveRecord？

> ID：10505166
> 
> 赞同：27
> 
> 时间：2012-05-08T19:27:43.437
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.2

在普通的java中，我会使用：

```
public User(String name, String email) {
  this.name = name;
  this.email = f(email);
  this.admin = false;
} 
```

* * *

但是，我在 Rails (3.2.3) 中找不到使用 ActiveRecords 的简单标准方法。

### 1.覆盖初始化

```
def initialize(attributes = {}, options = {})
  @name  = attributes[:name]
  @email = f(attributes[:email])
  @admin = false
end 
```

但是从数据库创建[记录时可能会丢失](http://blog.dalethatcher.com/2008/03/rails-dont-override-initialize-on.html)

### 2.使用`after_initialize`回调

通过覆盖它：

```
def after_initialize(attributes = {}, options = {})
  ...
end 
```

或使用宏：

```
after_initialize : my_own_little_init
def my_own_little_init(attributes = {}, options = {})
  ...
end 
```

但可能存在[一些弃用问题](https://stackoverflow.com/questions/328525/what-is-the-best-way-to-set-default-values-in-activerecord)。

[SO 中](https://stackoverflow.com/questions/1550688/how-do-i-create-a-default-value-for-attributes-in-rails-activerecords-model)还有一些[其他](https://stackoverflow.com/questions/4906704/how-to-use-after-initialize-in-rails-3)链接，但它们可能已过时。

* * *

那么，*使用的正确/标准方法是什么？*

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-08T20:11:35.473

当您的默认值适用于所有记录时，应在您的架构中定义它们。所以

```
def change
  creates_table :posts do |t|
    t.boolean :published, default: false
    t.string :title
    t.text :content
    t.references :author
    t.timestamps
  end
end 
```

在这里，每一个新的 Post 都会有 false 表示已发布。如果你想要对象级别的默认值，最好使用工厂风格的实现：

```
User.build_admin(params)

def self.build_admin(params)
  user = User.new(params)
  user.admin = true
  user
end 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-04-07T13:50:15.770

根据 Rails Guides，最好的方法是使用[after_initialize](http://guides.rubyonrails.org/active_record_callbacks.html#after-initialize-and-after-find)。因为用initialize我们要声明super，所以最好使用callback。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-08T19:49:40.093

我喜欢的一种解决方案是通过范围：

```
class User ...
   scope :admins, where(admin: true) 
```

然后你可以同时做：在管理员状态下创建新用户（即使用`admin`== `true`），`User.admins.new(...)`并以同样的方式获取所有管理员`User.admins`。

您可以制作一些范围并将其中的一些用作创建/搜索的模板。您也可以使用`default_scope`相同的含义，但没有默认应用的名称。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-13T08:13:58.213

今天早上我正在寻找类似的东西。虽然在数据库中设置默认值显然会起作用，但它似乎违反了 Rails 让应用程序处理数据完整性（因此默认值？）的约定。

我偶然发现了这篇[文章](http://www.davidverhasselt.com/2011/06/28/5-ways-to-set-attributes-in-activerecord/)。由于您可能不想立即将记录保存到数据库中，我认为最好的方法是通过调用来覆盖初始化方法`write_attribute()`。

```
def initialize
  super
  write_attribute(name, "John Doe")
  write_attribute(email,  f(email))
  write_attribute(admin, false)
end 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-08-08T00:41:49.120

这将在 Rails 4 中工作。

```
def initialize(params)
    super
    params[:name] = params[:name] + "xyz" 
    write_attribute(:name, params[:name]) 
    write_attribute(:some_other_field, "stuff")
    write_attribute(:email, params[:email])
    write_attribute(:admin, false)
end 
```

# c# - 无法使用 Xpath 正确解析 Xmlement

> ID：10505167
> 
> 赞同：1
> 
> 时间：2012-05-08T19:27:47.367
> 
> 标签：c#, xml, web-services, xml-parsing

我有返回如下 xmlement 的 Web 服务

```
<Application xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
   <Type>C</Type>
   <AppDate>2012-05-01T00:00:00</AppDate>
   <Applicants>
      <ID>1234</ID>
   </Applicants>
   <Applicants>
      <ID>0</ID>
   </Applicants>
   <Status>O</Status>
</Application> 
```

在我的客户端我有这样的代码

```
XmlElement root = proxy.CallWebservice();

XmlNodeList nodeList;
nodeList = root.SelectNodes("/Application/Applicants");
foreach (XmlNode applicants in nodeList)
{
    Console.WriteLine(applicants.InnerXml);
} 
```

问题：我无法输出任何东西。

但

如果我这样做

```
File.WriteAllText(@"d:\output.xml", root.OuterXml.ToString());
XmlDocument doc = new XmlDocument();
doc.Load(@"d:\output.xml");
XmlElement root = doc.DocumentElement;

XmlNodeList nodeList;
nodeList = root.SelectNodes("/Application/Applicants");
foreach (XmlNode title in nodeList)
{
    Console.WriteLine(title.InnerXml);
} 
```

它可以工作，我不想写入文件来读取节点。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T23:30:15.677

我不得不使用 XmlNodeList 节点列表；

```
nodeList = root.SelectNodes("Applicants"); 
```

因为我的根是应用程序

# c - Linux & C: 'write()' 不向文件写入任何内容

> ID：10505173
> 
> 赞同：2
> 
> 时间：2012-05-08T19:28:26.913
> 
> 标签：c, linux, file-io

我有一个简单的任务要完成这个例程，它所要做的就是打开文件，从缓冲区附加数据并关闭。为此，我在 linux 机器上使用了“open”和“write”。虽然 'write()' 之后的返回码是正数，但文件大小并没有增加，而且总是空的。我正在拉扯我的头发来弄清楚下面的代码有什么问题。以为一些新鲜的眼睛可以散发出一些光芒。

```
#define BIT_Q_FILE  ".\\bitq.dat"

int BQWrite(void *p)
{
int fd ;
int rc = -1 ;

fd = open(BIT_Q_FILE, O_RDWR | O_APPEND ) ;

if (fd < 0)
    return -1;

memset(&BITQBuff,0,sizeof(typeBITQFile));
memcpy(&BITQBuff.pBitQueue,p,sizeof(typeBITQueue));

rc = write(fd, &BITQBuff,sizeof(typeBITQFile)) ;

close(fd) ;

if(rc!=sizeof(typeBITQFile))
{
    return -1;
}

rc = sizeof(typeBITQueue);

return rc ;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T19:38:20.743

我在这里遇到了你的问题：

```
#define BIT_Q_FILE  ".\\bitq.dat" 
```

您已经遇到了 Windows 到 Unix 移植问题的三重奏：

*   Unix 上的目录分隔符是`/`，而不是`\`。
*   但是 Unix 非常乐意让你`\`在文件名中间加入。（*唯一*不能出现在路径名组件中的字节——我真正的意思是*字节，而不是字符——是那些值为 0x2F 和 0x00 的字节。）*
*   Unix 也非常乐意让文件名以点开头*。*但是，默认情况下`ls`不打印任何以点开头的文件名。

因此，您希望将数据写入`bitq.dat`当前目录中名为的文件，但实际上正在将数据写入`.\bitq.dat`仍在当前目录中的名为 的文件中。该文件默认是隐藏的，因此看起来数据正在消失在空气中。 `ls -a`将显示隐藏文件，`rm .\\bitq.dat`并将其删除。要修复您的代码，只需将定义更改为

```
#define BIT_Q_FILE "bitq.dat" 
```

没有必要`./`在传递给 的路径上放置前导`open`。

这可能不是您的代码的唯一问题，但我没有看到任何其他明显错误的地方。如果您需要更多帮助，请发布一个新问题，其中包含一个*完整*的、 *最小的*测试程序，人们可以自己编译和运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T19:35:08.237

尝试改变

```
#define BIT_Q_FILE  ".\\\bitq.dat" 
```

到

```
#define BIT_Q_FILE  "./bitq.dat" 
```

# javascript - 顺序函数调用

> ID：10505176
> 
> 赞同：0
> 
> 时间：2012-05-08T19:28:32.663
> 
> 标签：javascript, servlets, settimeout, sequential

我正在与一个更改并保存外部文件的 servlet 通信。由于这需要一些时间，我需要我的一些 javascript 函数调用顺序发生，以便一个函数的操作不会干扰另一个函数的操作。

为此，我编写了一个“顺序”函数，该函数采用另一个函数，该函数只能在busyflag 设置为false 时调用（即同时没有其他函数调用被处理时）。这是我的代码：

```
var busy = false;
function sequential(action) {
    while(busy)
        setTimeout(function(){sequential(action);}, 10);
    busy = true;
    action();
    setTimeout(function(){busy = false;}, 100);
}

function test1() {sequential(function() {alert("test1");});}
function test2() {sequential(function() {alert("test2");});} 
```

这是[jsFiddle](http://jsfiddle.net/D65Pp/4/)上的示例。由于某种原因，这段代码在第二次调用时不断循环（当函数调用必须等待时）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:40:10.507

```
while(busy)
        setTimeout(function(){sequential(action);}, 10); 
```

`setTimeout`不阻塞，它立即返回并允许循环继续。Javascript 是单线程的，所以这个循环只是保持运行并阻止任何其他代码执行，这意味着busy 永远不会被设置为 false 以退出循环。

假设您正在等待的这些事情是`ajax`调用，您可能希望使用某种队列，然后在调用的回调中`ajax`运行下一个请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:40:40.130

我认为您的 javascript 正在对您的服务器进行 ajax 调用。

如果您需要不同的调用一个接一个地运行，那么您应该让您的 javascript 代码设置挂钩，以等待它从一个调用返回结果，然后再发出下一个请求。

为了这些目的，我建议使用[jQuery之类的 javascript 工具包。](http://jquery.com/)它使这样的问题更容易解决。jQuery 中的每个 ajax 方法都至少接受一个在查询完成时将调用的回调。对于[jQuery.ajax()](http://api.jquery.com/jQuery.ajax/)你可以去

```
$.ajax(...).done(function() {
   // This part will be run when the request is complete
}); 
```

对于[.load()](http://api.jquery.com/load/)：

```
$("#my_element").load(url,data,function() {
   // This part will be run when the request is complete
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T09:47:38.177

我首先实现了 James Montagne 建议的解决方案，但经过一番搜索后，我发现您可以使用 XMLHttprequest 的 onreadystatechange 属性将忙标志设置为 true。

此代码按预期工作：

```
function sequential(action) {
if (busy) setTimeout(function(){sequential(action);}, 20);
else action();
}

function send(message){
    busy = true;
    var request = new XMLHttpRequest();
    request.open("POST", "owlapi", true);
    request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    request.send(message);
    request.onreadystatechange = function() {busy = false;};
} 
```

# objective-c - 制作 UIView 及其所有子视图的深层副本

> ID：10505184
> 
> 赞同：3
> 
> 时间：2012-05-08T19:28:58.070
> 
> 标签：objective-c, ios, uiscrollview, uikit, deep-copy

我需要制作包含多个子视图的 UIView 的深层副本。请帮我弄清楚如何做到这一点？我在 google 和 SO 上进行了一些搜索，但没有找到任何我想要的东西。

对于那些想知道为什么的人的解释：我有一个无限滚动的 UIScrollView，当然，内容重复。每个“集合”内容（例如，26 个标记为 AZ 的 UIButtons）都包含在一个视图中。这是我需要对其进行深层复制的视图，以便我可以在滚动视图中的屏幕上显示它的多个实例。

我不能简单地重新创建包含按钮的视图的结构，因为按下按钮会调用我的 UIScrollView 子类无法访问的类的函数。我也不希望重新创建它们，因为当我可以简单地进行深层复制时，通过逻辑重新创建并将所有子视图放置在容器视图中似乎是一种浪费。

谁能帮我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T13:24:30.337

（根据我的要求发表评论）

啊哈，我现在明白了。我认为唯一的方法是在运行时创建更多副本并隐藏它们；否则你必须遍历所有子视图，重新创建所有框架，颜色等......但正如你所说，你可能会遇到复制按钮目标等问题 - 但可能有一些有用的东西可以帮助完成这里：

[如何获取 UIButton Target、Action 和 Control 事件？](https://stackoverflow.com/questions/5182860/how-to-get-uibutton-target-action-and-control-events)

# android - 如何在 SurfaceView 中显示 Admob

> ID：10505185
> 
> 赞同：0
> 
> 时间：2012-05-08T19:29:06.423
> 
> 标签：android, admob, surfaceview

我尝试在我的 SurfaceView 上显示 Admob。

1.  我使用来自 Mario Zechner 的书籍开始 android 游戏的框架
2.  在框架中有一个类（AndroidFastRenderView 扩展 SurfaceView 实现 Runnable），并且在该类中有行 canvas.drawBitmap(framebuffer, null, dstRect, null); 其中 framebuffer 是位图，在游戏中全部绘制。
3.  在该框架中有一个类（AndroidGame extends Activity），其中行 setContentView(renderView);

这里的renderView是AndroidFastRenderView，也就是SurfaceView，现在我尝试添加Admob，但我不知道怎么做。

我可以像这样创建 Admob

AdView adView = new AdView(this, AdSize.BANNER, "MyID");

但是在哪里添加该视图

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:27:05.140

AdMob 的[广告目录](http://code.google.com/p/google-mobile-dev/source/browse/adcatalog/src/com/google/ad/catalog/layouts/OpenGLViewExample.java?repo=ad-catalog-android)示例应用程序有一个与此类似的示例。在上面的示例中，`AdView`是在 XML 中定义的。但在高层次上，你可能会想要这样的东西：

```
<RelativeLayout ...>
    <AdView ...
        android:id="@+id/adView"
        android:layout_alignParentBottom="true"/>
    <AndroidFastRenderView ...
        android:layout_above="@id/adView"/>
</RelativeLayout> 
```

位于AndroidFastRenderView`AdView`之外的顶部或底部的位置。如果您是在代码中执行此操作，我建议您创建一个`RelativeLayout`，在底部添加 的`AdView`作为子视图`RelativeLayout`（例如），然后将 添加`renderView`为 的子视图`RelativeLayout`，但在`AdView`.

# c# - 非静态字段、方法或属性“System.Web.UI.Page.Server.get”需要对象引用

> ID：10505187
> 
> 赞同：9
> 
> 时间：2012-05-08T19:29:16.023
> 
> 标签：c#, asp.net, inheritance, object, server.mappath

所以我有两个功能，我遇到了一个有趣的问题。本质上，我的目标是让我的代码在一个易于包含的 cs 文件中更具可移植性。

这是说cs文件：

```
namespace basicFunctions {
public partial class phpPort : System.Web.UI.Page {
    public static string includer(string filename) {
        string path = Server.MapPath("./" + filename);
        string content = System.IO.File.ReadAllText(path);
        return content;
    }
    public void returnError() {
        Response.Write("<h2>An error has occurred!</h2>");
        Response.Write("<p>You have followed an incorrect link. Please double check and try again.</p>");
        Response.Write(includer("footer.html"));
        Response.End();
    }
}
} 
```

这是引用它的页面：

```
<% @Page Language="C#" Debug="true" Inherits="basicFunctions.phpPort" CodeFile="basicfunctions.cs" %>
<% @Import Namespace="System.Web.Configuration" %>

<script language="C#" runat="server">
void Page_Load(object sender,EventArgs e) {
    Response.Write(includer("header.html"));
    //irrelevant code
    if ('stuff happens') {
        returnError();
    }
    Response.Write(includer("footer.html"));
}
</script> 
```

我得到的错误是上面列出的错误，即：

> 编译器错误消息：CS0120：非静态字段、方法或属性“System.Web.UI.Page.Server.get”需要对象引用

在以下行：

> 第 5 行：字符串路径 = Server.MapPath("./" + 文件名);

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-08T19:31:52.293

[`Server`](http://msdn.microsoft.com/en-us/library/system.web.ui.page.server.aspx)仅适用于`System.Web.UI.Page`-implementations 的实例（因为它是实例属性）。

您有 2 个选项：

1.  将方法从静态转换为实例
2.  使用以下代码：

（创建的开销`System.Web.UI.HtmlControls.HtmlGenericControl`）

```
public static string FooMethod(string path)
{
    var htmlGenericControl = new System.Web.UI.HtmlControls.HtmlGenericControl();
    var mappedPath = htmlGenericControl.MapPath(path);
    return mappedPath;
} 
```

或（未测试）：

```
public static string FooMethod(string path)
{
    var mappedPath = HostingEnvironment.MapPath(path);
    return mappedPath;
} 
```

或（不是那个好选择，因为它以某种方式伪装成静态，而仅对 webcontext-calls 是静态的）：

```
public static string FooMethod(string path)
{
    var mappedPath = HttpContext.Current.Server.MapPath(path);
    return mappedPath;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T21:23:30.670

怎么用`HttpContext.Current`？我认为您可以使用它来获取对`Server`静态函数的引用。

此处描述：[在静态类中访问的 HttpContext.Current](https://stackoverflow.com/questions/556310/httpcontext-current-accessed-in-static-classes)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-21T00:04:54.623

前段时间我遇到了类似的事情——简单地说，你不能从静态方法中的 .cs 代码隐藏中提取 Server.MapPath() （除非后面的代码以某种方式继承了网页类，这可能不是无论如何都允许）。

我的简单解决方法是让方法背后的代码将路径作为参数捕获，然后调用网页在调用期间使用 Server.MapPath 执行该方法。

代码背后（.CS）：

```
 public static void doStuff(string path, string desc)
{
    string oldConfigPath=path+"webconfig-"+desc+"-"+".xml";

... now go do something ...
} 
```

网页 (.ASPX) 方法调用：

```
 ...
doStuff(Server.MapPath("./log/"),"saveBasic");
... 
```

无需抨击或与 OP 交谈，这似乎是一种合理的混淆。希望这可以帮助 ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T19:36:57.363

```
public static string includer(string filename) 
{
        string content = System.IO.File.ReadAllText(filename);
        return content;
}

includer(Server.MapPath("./" + filename)); 
```

# c - 模拟流数据

> ID：10505195
> 
> 赞同：4
> 
> 时间：2012-05-08T19:30:02.180
> 
> 标签：c, perl, stream, simulation, named-pipes

我正在尝试编写一个程序，该程序将从平面数据文件中读取并模拟流式传输，以便我可以测试读取流式数据的程序，而无需连接和启动流式硬件。

实现这一目标的更现实的方法是什么？我需要它根据模拟的硬件以可变速度流式传输。

到目前为止，我的两个想法是一个写入命名管道的程序，或者一个以我需要的速率写入虚拟串行端口的程序。

是否有更好（更现实）的方式来模拟流数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T19:50:35.077

设置一个后台进程，以您想要的任何速率将文件写入套接字。在 Perl 中，

```
use Socket;
socketpair my $A, my $B, AF_UNIX, SOCK_STREAM, PF_UNSPEC;

if (fork() == 0) {
    stream();
    exit;
}

while (<$A>) {
    print;
}

sub stream {
    # output 1024 bytes/sec
    select $B; $| = 1;          # disable output buffering
    open my $fh, '<', '/file/to/stream';
    my $buffer;
    while (my $n = read $fh, $buffer, 1024) {
        sleep 1;
        print $B $buffer;
    }
    close $fh;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:40:35.143

我会以最接近原始流数据源的方式模拟流。例如，如果您通常从网络套接字获取流，则使用网络套接字进行模拟；如果您有串行端口，则使用虚拟串行端口等。否则，您将需要一个适配器用于您的流消费者代码（但您已经知道了我假设的所有这些）。

除此之外，您还需要一个速率限制算法来控制要发送的数据量。快速搜索让我知道了[这一点](https://stackoverflow.com/questions/667508/whats-a-good-rate-limiting-algorithm)，但肯定有更复杂和复杂的算法。YMMV。

这当然假设您知道如何为流的使用者创建有效的数据/数据包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T12:15:36.490

您可以尝试通过查看[涓涓细流](http://monkey.org/~marius/pages/?page=trickle)（用户空间带宽整形器）来节省一些编码时间。

# java - 解析后 SimpleDateFormat 错误的 unix 时间戳

> ID：10505196
> 
> 赞同：0
> 
> 时间：2012-05-08T19:30:07.113
> 
> 标签：java, date, timezone, simpledateformat

我正在尝试使用 SimpleDateFormat 在 unix 时间戳和自定义格式之间进行转换，反之亦然。为了测试反之亦然的转换，我编写了以下测试用例：

```
public class Testception extends TestCase {
    public void testTheTestOrTestception() throws ParseException {
        Date datum = new Date(649555200000L);
        SimpleDateFormat dfm = new SimpleDateFormat("yyyy-MM-dd");
        TimeZone tZ = TimeZone.getTimeZone("Europe/Berlin");
        dfm.setTimeZone(tZ);
        String aDifferentFormat = dfm.format(datum);
        assertEquals("1990-08-02", aDifferentFormat);
        Date datum2 = dfm.parse(aDifferentFormat);
        assertEquals(649555200000L, datum2.getTime());
    }
} 
```

我从一个 unixtimestamp (649555200000) 开始，将其转换为我的自定义格式 ("1990-08-02")，效果很好。但不幸的是，第二个断言失败，而不是预期的 649555200000L 结果是 649548000000L

提前致谢。

干杯 L0rdAli3n

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T19:35:21.993

这完全与时区有关。

您已将其设置为*UTC*午夜，并将其格式化为日期 - 但实际上是柏林时间凌晨 2 点。

然后，您将解析该*日期*，该日期将解析为*Berlin 的该日期的*午夜，这比您的起点早两个小时。如果您想再次恢复午夜 UTC，只需将您的时区设置`SimpleDateFormat`为 UTC 时区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:37:02.863

代码没有问题，只是输入假设。

649555200000L 是 1990 年 8 月 2 日柏林的凌晨 2 点。实际结果是柏林午夜的正确值，当您将仅日期的字符串模式解析为 java.util.Date 时，java 会给您这个值。

# objective-c - 跨 ViewController 共享数据

> ID：10505198
> 
> 赞同：0
> 
> 时间：2012-05-08T19:30:18.693
> 
> 标签：objective-c, ios, uiviewcontroller

在阅读了一堆 stackoverflow 帖子和论坛后，我对这个主题感到非常困惑。很多人谈论使用委托，但如果有大量数据，可能会导致内存问题。

我只处理来自 TCP/IP 设备的大约 600 字节的数据，并用新的值覆盖现有值。

我制作了一个`RootViewController`具有特殊视图和 TCP/IP 套接字的视图，此外，我还有两个必须使用来自`RootViewController`(TCP/IP) 的数据的视图控制器。

我是否应该为 TCP 内容创建一个单独的类，而不是在我的 RootViewController 中混合它？

另外我应该如何处理跨 ViewControllers 的数据共享？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:48:41.437

如果您对 TCP 的“东西”做了很多工作（例如获取数据、显示数据、重新格式化数据、比较或更改数据然后重新保存等），那么我建议创建一个单独的类（可能是 NSObject ) 具有处理 TCP 内容的所有方法，然后在根视图控制器中创建该对象的实例。

至于在其他视图控制器中获取数据，您必须在其他视图控制器中创建对根视图控制器的引用，然后在界面构建器中（或以编程方式）连接它们。只要确保你没有创建一个全新的根视图控制器实例（即不要使用 [[RootViewController alloc] init];）

那有意义吗？如果您发布更多有关您的应用程序结构的信息（例如您是否使用导航控制器等），我可能会更具体地为您服务。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T04:01:48.463

为了在类之间共享数据，您可以使用通知机制。在您的**FromClass.m**中发布通知：

```
NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:yourTCPData, @"TCPData", nil];
[[NSNotificationCenter defaultCenter] postNotificationName:@"gotTCPData" object:nil userInfo:options]; 
```

在你的**ToClass.m** viewDidLoad 添加这个：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(makeSomeThingUsefulWithTCPData:)name:@"gotTCPData" object:nil]; 
```

...并在您的**ToClass.m**中的某处添加此方法：

```
- (void)makeSomeThingUsefulWithTCPData:(NSNotification *)notification {
  NSDictionary *dict = [notification userInfo];
  yourTCPDataClass *yourTCPDataObject = [dict objectForKey:@"TCPData"];
  // Here make something useful with your TCP data
  } 
```

还要在您的**ToClass.m** viewDidUnload 中添加它以在视图将被卸载时释放观察者对象：

```
[[NSNotificationCenter defaultCenter] removeObserver:self]; 
```

# asp.net - 无法启用约束 - 我需要编译吗？。网

> ID：10505201
> 
> 赞同：0
> 
> 时间：2012-05-08T19:30:36.693
> 
> 标签：asp.net, .net

.Net 非常新。一切正常，直到我添加`<Tracking>`到我的 XML 文件中：

```
<Product>
    <id>product1</id>
    <Name>Product 1</Name>
    <Packart>detailimg</Packart>
    <TitleFile>detailtitleoriginal</TitleFile>
    <Description>Description</Description>
    <Ingredients>Ingredients</Ingredients>
    <FeedingInstructions>Instructions</FeedingInstructions>
    <Analysis>Analysis</Analysis>
    <Footer>Footer</Footer>
    **<Tracking>Test</Tracking>**
</Product> 
```

我的 XSD 文件是这样的：

```
<?xml version="1.0" encoding="utf-8" ?>
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified"
xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="Products">
        <xs:complexType>
            <xs:sequence>
                <xs:element maxOccurs="unbounded" name="Product">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="id" type="xs:string" />
                            <xs:element name="Name" type="xs:string" />
                            <xs:element name="Packart" type="xs:string" />
                            <xs:element name="TitleFile" type="xs:string" />
                            <xs:element name="Description" type="xs:string" />
                            <xs:element name="Ingredients" type="xs:string" />
                            <xs:element name="FeedingInstructions" type="xs:string" />
                            <xs:element name="Analysis" type="xs:string" />
                            <xs:element name="Footer" type="xs:string" />
                            <xs:element name="Tracking" type="xs:string" /></xs:sequence>
                    </xs:complexType>
                </xs:element>
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

然后在我的 aspx 页面中我添加了：

`<%=row[ "Tracking"]%>`

当我在浏览器中查看页面时，出现错误：

```
Failed to enable constraints. One or more rows contain values violating non-null, unique, or foreign-key constraints.

Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Data.ConstraintException: Failed to enable constraints. One or more rows contain values violating non-null, unique, or foreign-key constraints.

Source Error: 

Line 19:             ds = new System.Data.DataSet();
Line 20:             ds.ReadXmlSchema(MapPath("Content/xml/Products.xsd"));
Line 21:             ds.ReadXml(MapPath("Content/xml/Products.xml"));
Line 22:             Cache.Insert("Products", ds, new System.Web.Caching.CacheDependency(MapPath("Content/xml/Products.xml")),
Line 23:                          DateTime.Now.AddHours(12), System.Web.Caching.Cache.NoSlidingExpiration);

Source File: d:\ProductDetails.aspx.cs    Line: 21 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:12:31.417

快速解决此问题的一种方法是禁用数据集上的 EnforceConstraints：

```
ds.EnforceConstraints = false;
//now you can load the data 
```

**更新**：显然，这可能会产生不良影响。您应该决定在您的场景中是否是这种情况。

# ruby - 自定义厨师提供者不起作用

> ID：10505202
> 
> 赞同：0
> 
> 时间：2012-05-08T19:30:51.810
> 
> 标签：ruby, chef-infra

我正在尝试添加一个自定义厨师提供程序——`Chef::Provider::Tarball`基于`Chef::Provider::Git`.

由于某种原因，它不想工作。我补充说：

```
/usr/lib/ruby/vendor_ruby/chef/provider/tarball.rb 
```

并且还添加了对`Chef::Provider::Tarball`in`/usr/lib/ruby/vendor_ruby/chef/provider/deploy.rb`和的引用`/usr/lib/ruby/vendor_ruby/chef/providers.rb`：

```
require "chef/provider/tarball" 
```

我收到的错误消息是**FATAL: NameError: uninitialized constant Chef::Provider::Tarball**

这是完整的堆栈：

[https://gist.github.com/7aa71a2088c5ec36d011](https://gist.github.com/7aa71a2088c5ec36d011)

有什么想法我可能会错过吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T23:44:28.677

您可能不想尝试制作这样的内置提供程序。处理它的正确方法是用[LWRP](http://wiki.opscode.com/display/chef/Lightweight+Resources+and+Providers+%28LWRP%29)制作一本食谱。根据包含 LWRP 的说明书，您仍然可以在其他说明书中使用 LWRP。如果您确定需要重量级提供程序而不是 LWRP，您可能希望将其构建到 Chef 代码本身（提供程序位于 lib/chef/provider/ 下），以便自动加载而不使用 require 行。

# java - java.lang.ClassCastException：在自定义复合组件上

> ID：10505206
> 
> 赞同：2
> 
> 时间：2012-05-08T19:31:02.973
> 
> 标签：java, android, xml

我有一个通过调用下面的 xml 来设置 xml 的活动。这个 xml 布局又调用了一个自定义复合组件，该组件设置了两个按钮和一个编辑文本。然后我的主要活动尝试从自定义复合组件定义的编辑文本中获取值。我有下面的 logcat 报告，但看不到它是什么，我没有得到正确的结果。

XML 布局文件

```
 <com.android.control.MinutePicker
            android:id="@+id/MinPick"
            android:orientation="vertical"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content">
        </com.android.control.MinutePicker> 
```

com.android.control.MinutePicker

```
but1 = new Button( context );
but1.setTextSize( TEXT_SIZE );
but1.setText( "-" );
but2 = new Button( context );
but2.setTextSize( TEXT_SIZE );
but2.setText( "-" );
valueText = new EditText( context );
valueText.setTextSize( TEXT_SIZE );
valueText.setGravity( Gravity.CENTER_VERTICAL | Gravity.CENTER_HORIZONTAL );
valueText.setText(0);
this.setLayoutParams( new LinearLayout.LayoutParams( LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT ) );
LayoutParams elementParams = new LinearLayout.LayoutParams( ELEMENT_WIDTH, ELEMENT_HEIGHT );

    addView( but1, elementParams );
    addView( valueText, elementParams );
    addView( but2, elementParams ); 
```

然后尝试获取编辑文本的值的主要活动。

```
 EditText Identifier = (EditText)findViewById(R.id.MinPick);
             String value = Identifier.getText().toString();
             Toast toast = Toast.makeText(PerfectSleepActivity.this, value, Toast.LENGTH_SHORT);
             toast.setGravity(Gravity.CENTER, 0, 0);
             toast.show(); 
```

LogCat 报告

```
05-08 19:03:56.141: E/AndroidRuntime(200): Uncaught handler: thread main exiting due to uncaught exception
05-08 19:03:57.730: E/AndroidRuntime(200): java.lang.ClassCastException: com.android.control.MinutePicker
05-08 19:03:57.730: E/AndroidRuntime(200):  at com.ap.df.DFActivity$2.onClick(PerfectSleepActivity.java:37)
05-08 19:03:57.730: E/AndroidRuntime(200):  at android.view.View.performClick(View.java:2344)
05-08 19:03:57.730: E/AndroidRuntime(200):  at android.view.View.onTouchEvent(View.java:4133)
05-08 19:03:57.730: E/AndroidRuntime(200):  at android.widget.TextView.onTouchEvent(TextView.java:6510)
05-08 19:03:57.730: E/AndroidRuntime(200):  at android.view.View.dispatchTouchEvent(View.java:3672)
05-08 19:03:57.730: E/AndroidRuntime(200):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:882)
05-08 19:03:57.730: E/AndroidRuntime(200):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:882)
05-08 19:03:57.730: E/AndroidRuntime(200):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:882)
05-08 19:03:57.730: E/AndroidRuntime(200):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:882)
05-08 19:03:57.730: E/AndroidRuntime(200):  at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1712)
05-08 19:03:57.730: E/AndroidRuntime(200):  at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1202)
05-08 19:03:57.730: E/AndroidRuntime(200):  at android.app.Activity.dispatchTouchEvent(Activity.java:1987)
05-08 19:03:57.730: E/AndroidRuntime(200):  at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1696)
05-08 19:03:57.730: E/AndroidRuntime(200):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1658)
05-08 19:03:57.730: E/AndroidRuntime(200):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-08 19:03:57.730: E/AndroidRuntime(200):  at android.os.Looper.loop(Looper.java:123)
05-08 19:03:57.730: E/AndroidRuntime(200):  at android.app.ActivityThread.main(ActivityThread.java:4203)
05-08 19:03:57.730: E/AndroidRuntime(200):  at java.lang.reflect.Method.invokeNative(Native Method)
05-08 19:03:57.730: E/AndroidRuntime(200):  at java.lang.reflect.Method.invoke(Method.java:521)
05-08 19:03:57.730: E/AndroidRuntime(200):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
05-08 19:03:57.730: E/AndroidRuntime(200):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:549)
05-08 19:03:57.730: E/AndroidRuntime(200):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:35:10.993

看起来您正试图在这行代码中将 MinutePicker (com.android.control.MinutePicker) 类型的类转换为 EditText：

```
EditText Identifier = (EditText)findViewById(R.id.MinPick); 
```

R.id.MinPick 是 MinutePicker 类型，而不是 EditText。

这行不通。MinutePicker 是否继承自 EditText 或其他东西？请发布类标识符（不仅仅是其中包含的代码）。

也许您的意思是执行以下操作：

```
MinutePicker mp = (MinutePicker)findViewById(R.id.MinPick); 
```

# objective-c - EasyTableView 的单元格选择问题

> ID：10505211
> 
> 赞同：2
> 
> 时间：2012-05-08T19:31:14.103
> 
> 标签：objective-c, ios5, uitableview

我对 EasyTableView 有一个简单的问题（https://github.com/alekseyn/EasyTableView）

我有许多可以正常工作的水平滚动表。

我能够选择一个单元格并执行一个转场，但是，一旦新的视图控制器被解除，我将不再能够选择该单元格并执行相同的操作，直到我在同一个表中选择了另一个单元格。

我的问题是：如何以编程方式取消选择以前选择的单元格以重新启用此特定操作。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T16:53:36.597

selectedIndexPath 是有意持久的，以防用户将选定的 tableview 单元格滚动到屏幕外然后再次返回。如果您不想要这种持久性，请在委托方法之后添加如下所示的行（在 EasyTableView.m 中）：

```
- (void)setSelectedIndexPath:(NSIndexPath *)indexPath {

    if (![_selectedIndexPath isEqual:indexPath]) {
        NSIndexPath *oldIndexPath = [_selectedIndexPath copy];

        _selectedIndexPath = indexPath;

        UITableViewCell *deselectedCell = (UITableViewCell *)[self.tableView cellForRowAtIndexPath:oldIndexPath];
        UITableViewCell *selectedCell   = (UITableViewCell *)[self.tableView cellForRowAtIndexPath:_selectedIndexPath];

    if ([delegate respondsToSelector:@selector(easyTableView:selectedView:atIndexPath:deselectedView:)]) {
        UIView *selectedView = [selectedCell viewWithTag:CELL_CONTENT_TAG];
        UIView *deselectedView = [deselectedCell viewWithTag:CELL_CONTENT_TAG];

        [delegate easyTableView:self
                   selectedView:selectedView
                    atIndexPath:_selectedIndexPath
                 deselectedView:deselectedView];

        // Add this line here!
        _selectedIndexPath = nil;
        }
    }
} 
```

# javascript - 更正功能以尽快宣布获胜者

> ID：10505222
> 
> 赞同：-4
> 
> 时间：2012-05-08T19:31:59.370
> 
> 标签：javascript

我正在做一个井字游戏。

我将如何更改以下代码，以便可以在完成之前宣布获胜者（每个正方形都填充）并且获胜者是第一个获得 3 个匹配值的人，而不是最后一个获得它的人？

```
function check_squares () {
    var values = new Array(); 
    var complete = true;

    $('.square').each(function () {     
        values.push( $(this).html() );  
        //if ($(this).html() == '') complete = false;
    });

    if (complete == true) { 
        var winner = false;

        if ( values[0] == values[1] && values[1] == values[2] ) winner = values[0];
        if ( values[3] == values[4] && values[4] == values[5] ) winner = values[3];
        if ( values[6] == values[7] && values[7] == values[8] ) winner = values[6];
        if ( values[0] == values[3] && values[3] == values[6] ) winner = values[0];
        if ( values[1] == values[4] && values[4] == values[7] ) winner = values[1];
        if ( values[2] == values[5] && values[5] == values[8] ) winner = values[2];
        if ( values[0] == values[4] && values[4] == values[8] ) winner = values[0];
        if ( values[2] == values[4] && values[4] == values[6] ) winner = values[2];

        if (winner) {           
            $('#output').html('Winner: ' + winner);
        } else {        
            $('#output').html('No Winner');
        }
    } else {    
        if (player_x == true) {     
            $('#output').html('x turn to move');
        } else {        
            $('#output').html('o turn to move');
        }       
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:31:14.460

你的功能几乎是正确的。主要是，您只需要在玩家每次更改单元格的值时调用它。

我已经稍微调整了你的函数，以允许它被多次调用。我已在我更改的部分中添加了注释，以使它们更易于查找。

```
// Move these two variables into the global scope so that they are not reset
// by each call to check_squares and so that our click function can access them.
var complete = false;
var winner = null;

function check_squares () {
    var values = new Array(); 

    $('.square').each(function () {     
        values.push( $(this).html() );  
        //if ($(this).html() == '') complete = false;
    });

    // Debug statement to see the order of the values.
    console.log(values);

    if (!complete) {
        if ( values[0] == values[1] && values[1] == values[2] ) winner = values[0];
        if ( values[3] == values[4] && values[4] == values[5] ) winner = values[3];
        if ( values[6] == values[7] && values[7] == values[8] ) winner = values[6];
        if ( values[0] == values[3] && values[3] == values[6] ) winner = values[0];
        if ( values[1] == values[4] && values[4] == values[7] ) winner = values[1];
        if ( values[2] == values[5] && values[5] == values[8] ) winner = values[2];
        if ( values[0] == values[4] && values[4] == values[8] ) winner = values[0];
        if ( values[2] == values[4] && values[4] == values[6] ) winner = values[2];

        if (winner) {           
            $('#output').html('Winner: ' + winner);
            // Indicate that there was a winner so no more input is allowed.
            complete = true;
        } else {        
            $('#output').html('No Winner');
        }
    } else {    
        if (player_x == true) {     
            $('#output').html('x turn to move');
        } else {        
            $('#output').html('o turn to move');
        }       
    }
}

// Add a click handler to each square that checks for win conditions after each
// X or 0 is added.
$(".square").click(function() {
  if (!complete)
  {
    // This obviously needs to be changed to determine which player is going.
    $(this).html("X");
    check_squares();
  }
}); 
```

我创建了一个简单的[JSFiddle](http://jsfiddle.net/brantolsen/AsFRs/)来查看一个工作示例。

# javascript - 在 Android 上使用 PhoneGap 和 pep.jquery.js 进行拖放

> ID：10505227
> 
> 赞同：0
> 
> 时间：2012-05-08T19:32:36.800
> 
> 标签：javascript, android, jquery-mobile, cordova

我在 PhoneGap 应用程序中创建基于拖放的菜单时遇到问题。我尝试了一些插件，例如 jquery.mobileraganddrop.js (http://www.stevefenton.co.uk/Content/Jquery-Mobile-Drag-And-Drop/) 没有工作并尝试自己编写此功能在 jquery mobile 上使用“触摸”事件（虽然动画并不流畅）。结果都不足以支持我的事业。

最终我找到了 pep.jquery.js (http://pep.briangonzalez.org/) 插件，它看起来很完美，但是出现了一些问题，我将在后面描述。

下面给出的代码背后的想法是菜单项显示为标记，这些标记均匀地围绕一个圆圈放置。每当将令牌放在圆心时，都会选择菜单选项。如果在触摸事件结束时令牌距离圆心不够近，则将其移回其原始位置。

问题是：拖动可以在 PC 上工作，但在**Android**手机上根本**不起作用，当我停止拖动令牌时不会发生***touchend*事件（我知道 marginLeft 和 marginTop 设置为 0 并且赢了'不会导致令牌移动到原始位置 - 我将其留作调试目的）。

 ***```
$(document).ready(function(){
    var centerX = 240;
    var centerY = 440;
    var radius = 180;
    var internalRadius = 86;    
    var tokenNumber = $("#circle .token").length;

    reloadTokens(tokenNumber, radius, 0);

    $(".token").pep({
        cssEaseDuration: 0,
        activeClass: "activeToken"
    });

    $("#token").bind("touchend",function(){
        $(this).forceStop();
        $(this).animate({
            marginLeft: 0,
            marginTop: 0
        }, "fast", "easein");
    });

});

function reloadTokens(tokenNumber, radius, additionalOffset){

    var degreeOffset = 60;

    var i = 0;
    $(".token").each(function(){
        degree = (i * (360/tokenNumber) - degreeOffset + additionalOffset) % 360;
        var tokenX = radius * Math.cos(degree * (Math.PI / 180)) + radius;
        var tokenY = radius * Math.sin(degree * (Math.PI / 180)) + radius;
        $(this).css({
            marginLeft: tokenX,
            marginTop: tokenY
        });
        i++;
    });
} 
```

对此代码的任何帮助将不胜感激。:) 如果你给我另一个想法，我也会很高兴如何使用 phonegap 处理拖放，而不是我之前描述的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T19:40:28.040

电影，

我创造了 Pep。哪个 Android 设备以及该设备上的哪个浏览器？给我更多信息，我会帮助调试。

如果您[在此处](https://github.com/briangonzalez/pep.jquery.js/issues)提出问题，我们可以跟踪该错误，我将确保在此处交叉引用该问题，并且我们可以发布此问题的合法答案。***

# regex - 使用正则表达式从 clojure 集合中提取字符串

> ID：10505229
> 
> 赞同：4
> 
> 时间：2012-05-08T19:32:45.987
> 
> 标签：regex, clojure, substring, compojure

你能建议我从字符串序列中提取子字符串的最短和最简单的方法吗？我通过使用 enlive 框架获取此集合，该框架从某些网页获取内容，这是我得到的结果：

```
("background-image:url('http://s3.mangareader.net/cover/gantz/gantz-r0.jpg')"
 "background-image:url('http://s3.mangareader.net/cover/deadman-wonderland/deadman-wonderland-r0.jpg')"
 "background-image:url('http://s3.mangareader.net/cover/12-prince/12-prince-r1.jpg')" ) 
```

我想要的是在从序列中的每个字符串中提取 URL 时获得一些帮助。我尝试了一些使用分区函数的方法，但没有成功。任何人都可以为这个问题提出一个正则表达式或任何其他方法吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T19:54:04.687

`re-seq`到resque！

```
(map #(re-seq #"http.*jpg" %) d)
(("http://s3.mangareader.net/cover/gantz/gantz-r0.jpg")  
("http://s3.mangareader.net/cover/deadman-wonderland/deadman-wonderland-r0.jpg") 
("http://s3.mangareader.net/cover/12-prince/12-prince-r1.jpg"))
user> 
```

`re-find`甚至更好：

```
user> (map #(re-find #"http.*jpg" %) d)
("http://s3.mangareader.net/cover/gantz/gantz-r0.jpg" 
 "http://s3.mangareader.net/cover/deadman-wonderland/deadman-wonderland-r0.jpg" 
 "http://s3.mangareader.net/cover/12-prince/12-prince-r1.jpg") 
```

因为它不会添加额外的 seq 层。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:51:49.960

像这样简单的东西对你有用吗？

```
(defn extract-url [s]
  (subs s (inc (.indexOf s "'")) (.lastIndexOf s "'"))) 
```

此函数将返回一个字符串，其中包含第一个和最后一个单引号之间的所有字符。

假设您的字符串序列命名为`ss`，则：

```
(map extract-url ss)
;=> ("http://s3.mangareader.net/cover/gantz/gantz-r0.jpg"
;    "http://s3.mangareader.net/cover/deadman-wonderland/deadman-wonderland-r0.jpg"
;    "http://s3.mangareader.net/cover/12-prince/12-prince-r1.jpg") 
```

这绝对不是一个通用的解决方案，但它适合您提供的输入。

# oracle - 就 TEMP 表空间而言，查询的成本是多少？

> ID：10505232
> 
> 赞同：2
> 
> 时间：2012-05-08T19:33:01.793
> 
> 标签：oracle

我有一些存储过程可以执行一些更复杂的查询并大量使用集合。

我的 DBA 抱怨他们偶尔会消耗 S#$%ton 的内存 TEMP 表空间。

我可以对查询进行优化，但我也希望尽可能无创，为此我需要查看我的更改对 TEMP 表空间的影响。

问题：

**如何查看我的查询在 TEMP 表空间上的成本？**

要考虑的一件事是我没有 DBA 访问权限。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T21:52:47.843

取决于您的查询在 temp 上的成本是什么意思。

如果您可以从 v$tempseg_usage 中选择，您可以看到您在 temp 中消耗了多少空间 - 在 DEV 数据库上，您的 DBA 没有理由不能让您访问该视图。

正如 gpeche 所提到的 - autotrace 可以让您很好地了解您从 temp 执行的 IO 数量 - 因此结合空间使用情况可以让您很好地了解正在发生的事情。

大型集合通常是个坏主意——它们会消耗 PGA 中的大量内存（与 TEMP 非常不同），所有其他会话都共享这些内存——这将是您的 DBA 所关心的问题。多大取决于您的系统 - 数千条小记录可能还不错，但集合中有数千条或数百万条记录，我会担心。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-09T05:31:28.763

在做各种有趣的查询和技巧之前，估计过滤后应该排序的数据量。如果这大于排序区域的大小，排序会将块从内存移动到临时并稍后将它们读回。在原始数据大小上增加一点开销；使用 30% 的开销。这应该对所需的总排序大小给出合理的估计。

对集合使用相同的策略。某处必须有数据空间，没有魔法/压缩可以使您的数据量更小。如果您有最多 1000 行的内存并尝试将其与 1000.000 行一起使用，它将不适合。在这种情况下，请与您的 dba 交谈并尝试找到解决方案。可能是您最终对工作负载进行了分区。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T20:59:58.600

如果没有 DBA 访问权限，我会尝试使用[AUTOTRACE](http://docs.oracle.com/cd/E11882_01/server.112/e16604/ch_eight.htm#i1037231)。它不会为您提供 TEMP 表空间消耗，但您可以获得很多有用的信息来调整查询（逻辑读取、磁盘排序数、递归 SQL、重做消耗、网络往返）。请注意，您需要授予一些权限才能使用 AUTOTRACE，但不需要完全的 DBA 权限。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-09T07:52:13.850

当您的查询正在运行时，您可以查询 v$sql_workarea_active，或者在它运行后您可以查询[v$sql_workarea](http://docs.oracle.com/cd/B19306_01/server.102/b14237/dynviews_2126.htm)。

这些将根据使用的内存、使用的磁盘空间和（最重要的）通过次数（空间使用只是问题的一部分——多通道排序非常昂贵）向您显示临时表空间的使用情况，并将使用情况与解释计划中的步骤。

然后，您可以考虑修改内存管理是否可以帮助您减少临时表空间的使用，无论是使用的绝对空间还是通过计数。

# php - 在 PHP 中检测用户中止/客户端断开连接

> ID：10505237
> 
> 赞同：8
> 
> 时间：2012-05-08T19:33:29.213
> 
> 标签：php

最近，我们需要检测**客户端何时从****服务器**突然中止/断开连接。突然，我的意思是不一定通过浏览器的***STOP***按钮，实际上，客户端是通过 POST 发送的 SOAP 消息（使用***soapUI***），因此，断开连接可能就像在收到之前停止（ ***Ctrl + C*** ）客户端一样简单一个答复。我们花了几天时间试图找到一个解决方案，直到我们找到了解决办法。因此，这可能是一个带有隐含响应的问题，但目标是提供可以帮助许多其他有相同需求的人的信息。

以下是我们使用服务器检测客户端断开连接的基本代码：

```
<?PHP
ignore_user_abort(true);            // Continue running the script even when the client aborts/disconnects

sleep(5);                           // Sleep 5 seconds so we can stop the client before it recieves a reponse from the server

echo "RESPONSE sent to the client"; // Response to the Request
ob_flush();                         // Clean output buffer
flush();                            // Clean PHP's output buffer
usleep(500000);                     // Sleep half a second in order to detect if Apache's server sent the Response
echo " ";                           // Echo a blank space to see if it could be sent to the client
ob_flush();                         // Clean output buffer
flush();                            // Clean PHP's output buffer

if(connection_status() != 0) {      // Client aborted/disconnected abruptly
  return -1;
}
else {                              // Client recieved the response correctly
  return 0;
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T17:39:03.880

PHP 中的“ **connection_aborted** ”函数将解决您的问题。

[您可以在此链接](http://php.net/manual/en/function.connection-aborted.php)中查看带有示例用法的函数语法。

# php - 简单的 html dom：如何获取没有特定属性的标签

> ID：10505243
> 
> 赞同：5
> 
> 时间：2012-05-08T19:33:33.557
> 
> 标签：php, parsing, css-selectors, html-parsing, simple-html-dom

我想获得“class”属性等于“someclass”的标签，但只有那些没有定义属性“id”的标签。

**我尝试**了以下（基于this answer）但没有奏效：

```
$html->find('.someclass[id!=*]'); 
```

**笔记：**

我正在使用[简单的 HTML DOM 类](http://simplehtmldom.sourceforge.net/manual.htm)，在他们提供的基本文档中，我没有找到我需要的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T19:53:10.903

来自[PHP Simple HTML DOM Parser Manual](http://simplehtmldom.sourceforge.net/manual.htm)，在[How to find HTML elements？](http://simplehtmldom.sourceforge.net/manual.htm#section_find)，我们可以阅读：

> **[!attribute] 匹配没有**指定属性的元素。

**您的代码将变为：**

```
$html->find('.someclass[!id]'); 
```

这将匹配具有`someClass`没有`id`属性的类的元素。

* * *

我最初的答案是基于元素的选择，就像我们使用 jQuery 一样，因为 Simple HTML DOM Parser 声称在我们可以阅读的[主页上支持它们：](http://simplehtmldom.sourceforge.net/)

> 使用像 jQuery 一样的选择器在 HTML 页面上查找标签。

^(对于那些被我的原始回答冒犯并在评论中表达不满的人，我深表歉意！)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-05T18:58:50.017

[简单的 HTML DOM 类](http://simplehtmldom.sourceforge.net/manual.htm)不支持负属性匹配所需的[CSS3 伪类。](http://www.w3.org/TR/css3-selectors/#pseudo-classes)

解决这个限制很简单，没有太多麻烦。

```
$nodes = array_filter($html->find('.something'), function($node){return empty($node->id);}); 
```

# zooming - TurnJS 和浏览器缩放

> ID：10505245
> 
> 赞同：2
> 
> 时间：2012-05-08T19:33:35.193
> 
> 标签：zooming, turnjs

我最近偶然发现了 TurnJS 插件来创建翻页效果。我现在正在使用它来重新创建一个过去构建的 Flash 翻书。其中一项规定是它必须缩小或放大以填充浏览器窗口而不滚动。我一直在尝试使用我自己的简单 JS，利用浏览器转换属性来缩放容器。缩放工作正常，但是一旦所有内容都被缩放，翻书效果就不能很好地工作（摇晃的页面过渡和页面角不能很好地工作）。

我也一直在尝试，也没有太多运气。

我还在第二页上使用 Flot 实现了一个图表，并且还注意到在缩放时，鼠标悬停未正确对齐。这类似于页面角落发生的情况。

原始 flash 版本：[http](http://www.return-it.ca/ar2010/index.html)
://www.return-it.ca/ar2010/index.html 没有缩放：[http ://dev.bitpowered.ca/encorp/](http://dev.bitpowered.ca/encorp/)

我是不是走错了路？有没有其他方法可以让这一切正常工作，或者我是这个吗？提前致谢。

# android - 配置（方向）更改的嵌套片段

> ID：10505247
> 
> 赞同：2
> 
> 时间：2012-05-08T19:33:39.727
> 
> 标签：android, configuration, orientation, fragment

我无法理解 Android 如何在方向更改时处理片段（尤其是嵌套片段）。

假设我有一个`a1`加载片段的活动`f1`。`f1`然后在方法中将片段的多个实例加载`f2`到自身中`oncreateview()`。

现在我的活动`a1`在（`oncreate()`）中有这个：

```
if (savedInstanceState != null)
    return; 
```

确保`f1`不会加载多个实例。我做同样的事情`f1`以确保`f2`不会加载重复的实例。

但是，我的班级稍后`f1`需要引用这些`f2`实例。目前我将它们存储在`f1`对象中的 ArrayList 中，但是在方向更改后，此 ArrayList 为空，我认为这些`f2`实例无论如何都是不同的对象。

所以我的问题是，如何拥有嵌套片段并在方向改变后保持对它们的引用的最佳方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:40:46.330

您可以使用 FragmentManger 查找对其他片段的引用。

您可以通过执行以下操作来获取对另一个片段的引用：

```
DetailsFragment details = (DetailsFragment) getFragmentManager().findFragmentById(R.id.details); 
```

或者

```
DetailsFragment details = (DetailsFragment) getFragmentManager().findFragmentByTag("my tag"); 
```

如果您还没有看过它，请查看[这篇](http://android-developers.blogspot.com/2011/02/android-30-fragments-api.html)博文。

在您有同一个片段的多个实例的情况下，您可以在创建片段时设置一个标签，并在查找片段时使用它而不是 id。

# serialization - proto 编译器（谷歌协议缓冲区的）是用哪种语言编写的？

> ID：10505248
> 
> 赞同：2
> 
> 时间：2012-05-08T19:33:41.390
> 
> 标签：serialization, protocol-buffers

我想知道“原型编译器”（用于从 Java、Python 或 C++ 生成源文件的编译器）是用哪种语言编写的？可能是多种语言的混合？

任何帮助，将不胜感激。

提前致谢 贺拉斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:37:54.080

它似乎是用[C++](https://developers.google.com/protocol-buffers/docs/reference/cpp/index#google.protobuf.compiler)编写的。还有关于[Java](https://developers.google.com/protocol-buffers/docs/reference/java/index)和[Python](https://developers.google.com/protocol-buffers/docs/reference/python/index) API 的文档，但它们似乎不包含编译器本身（至少我没有看到任何明显是编译器的东西，尽管我没有花很多时间寻找它要么）。

也就是说，我几乎想投票结束——对于大多数实际目的，用于实现编译器的语言基本上是一个琐碎的问题，与实际使用无关。然而，有一个完全合法的例外：如果您要下载和修改编译器，了解您需要使用的语言可能会非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T07:00:10.757

protoc 编译器是用 C 或 C++ 编写的（无论如何它都是本机程序）。

当我想处理java文件中的proto文件时，我

1.  我使用 protoc 命令将它们转换为协议缓冲区文件，即

    protoc protofile.proto --descriptor_set_out=输出文件

2.  读取新的协议缓冲区文件（它是一个 FileDescriptorSet）并使用它

一个过于复杂的例子是example，是 **compileProto**方法在

[http://code.google.com/p/protobufeditor/source/browse/trunk/%20protobufeditor/Source/ProtoBufEditor/src/net/sf/RecordEditor/ProtoBuf/re/display/ProtoLayoutSelection.java](http://code.google.com/p/protobufeditor/source/browse/trunk/%20protobufeditor/Source/ProtoBufEditor/src/net/sf/RecordEditor/ProtoBuf/re/display/ProtoLayoutSelection.java)

它之所以复杂是因为 options 因为 protoc 命令和选项可以存储在属性文件中。

**注意：****getFileDescriptor**方法读取新创建的协议缓冲区

# android - 在 Android 上，每次运行时内存不足

> ID：10505251
> 
> 赞同：1
> 
> 时间：2012-05-08T19:34:00.477
> 
> 标签：android, memory

我的应用程序在第一次运行时运行良好，但如果我重新启动它会崩溃并让我强制关闭。在我按下强制关闭按钮后，我可以再次启动应用程序。如果我在按下后退按钮后尝试重新启动，我必须强制关闭。我让我每次尝试都运行它而不会出错。我认为 android 应该负责将内存返回给计算机，所以我们不必做那些家务：我确实有一个有点大的数组：

```
int  worldgrid= new int[640][480][3]; 
```

在我的构造函数中，我可能不得不缩短它。我确实做了第一次尝试。记录猫消息：

> 05-08 19:09:46.035：E/dalvikvm-heap(420)：28 字节分配内存不足。
> 
> 05-08 19:09:46.195：我/dalvikvm（420）：| group="main" sCount=0 dsCount=0 s=N obj=0x4001d8e0 self=0xccb0 05-08 19:09:46.195: I/dalvikvm(420): | sysTid=420 nice=0 sched=0/0 cgrp=默认句柄=-1345026008 05-08 19:09:46.205: I/dalvikvm(420): | schedstat=( 52616400652 22917249866 1196 ) 05-08 19:09:46.205: I/dalvikvm(420): at java.lang.reflect.Array.createMultiArray(Native Method) 05-08 19:09:46.205: I/dalvikvm( 420): at java.lang.reflect.Array.newInstance(Array.java:444) 05-08 19:09:46.455: I/dalvikvm(420): at com.gravedigger.MainGamePanel.(MainGamePanel.java:215) 05-08 19:09:46.455: I/dalvikvm(420): 在 com.digger.DiggerActivity.onCreate(GravediggerActivity.java:116) 05-08 19:09:46.615: I/dalvikvm(420): 在 android。 app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047) 05-08 19:09:46.625:
> 
> 05-08 19:09:47.045: I/dalvikvm(420): | group="main" sCount=1 dsCount=0 s=N obj=0x4001d8e0 self=0xccb0 05-08 19:09:47.045: I/dalvikvm(420): | sysTid=420 nice=0 sched=0/0 cgrp=默认句柄=-1345026008 05-08 19:09:47.045: I/dalvikvm(420): | schedstat=( 52980087202 23270903160 1219 ) 05-08 19:09:47.045: I/dalvikvm(420): at java.lang.reflect.Array.createMultiArray(Native Method) 05-08 19:09:47.045: I/dalvikvm( 420): 在 java.lang.reflect.Array.newInstance(Array.java:444) 05-08 19:09:47.045: I/dalvikvm(420): 在 com.digger.MainGamePanel.(MainGamePanel.java:215) 05-08 19:09:47.045: I/dalvikvm(420): 在 com.digger.DiggerActivity.onCreate(GravediggerActivity.java:116) 05-08 19:09:47.045: I/dalvikvm(420): 在 android。 app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047) 05-08 19:09:47.185: I/dalvikvm(420): 在 java.lang.reflect.Method.invoke(Method.java:521) 05-08 19:09:47.195: I/dalvikvm(420): 在 com.android.internal.os.ZygoteInit $MethodAndArgsCaller.run(ZygoteInit.java:868) 05-08 19:09:47.195: I/dalvikvm(420): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626) 05-08 19 :09:47.195: I/dalvikvm(420): at dalvik.system.NativeStart.main(Native Method) 05-08 19:09:47.195: I/dalvikvm(420): "Binder Thread #2" prio=5 tid =6 本地 05-08 19:09:47.195: I/dalvikvm(420): | group="main" sCount=1 dsCount=0 s=N obj=0x44f366b8 self=0x11d230 05-08 19:09:47.195: I/dalvikvm(420): | sysTid=425 nice=0 sched=0/0 cgrp=default 句柄=1297528 05-08 19:09:47.195: I/dalvikvm(420): | schedstat=(118912719 416670422 51) 05-08 19:09:47.195: I/dalvikvm(420): 在 dalvik.system.NativeStart。运行（本机方法）05-08 19:09:47.195：I/dalvikvm（420）：“Binder Thread #1”prio=5 tid=5 NATIVE 05-08 19:09:47.195：I/dalvikvm（420）： | group="main" sCount=1 dsCount=0 s=N obj=0x44f36480 self=0x11fd80 05-08 19:09:47.750: I/dalvikvm(420): | sysTid=424 nice=0 sched=0/0 cgrp=default 句柄=1269616 05-08 19:09:47.750: I/dalvikvm(420): | schedstat=( 114332827 305656917 35 ) 05-08 19:09:47.750: I/dalvikvm(420): at dalvik.system.NativeStart.run(Native Method) 05-08 19:09:47.755: I/dalvikvm(420) ：“JDWP”守护进程prio=5 tid=4 VMWAIT 05-08 19:09:47.755：I/dalvikvm(420)：| group="system" sCount=1 dsCount=0 s=N obj=0x44f352a0 self=0x135ad0 05-08 19:09:47.755: I/dalvikvm(420): | sysTid=423 nice=0 sched=0/0 cgrp=默认句柄=1196352 05-08 19:09:47.765: I/dalvikvm(420): | schedstat=( 59551849 158373474 18 ) 05-08 19:09:47.765: I/dalvikvm(420): at dalvik.system.NativeStart.run(Native Method) 05-08 19:09:47.775: I/dalvikvm(420) ：“信号捕手”守护进程prio=5 tid=3 VMWAIT 05-08 19:09:47.886：I/dalvikvm(420)：| group="system" sCount=1 dsCount=0 s=N obj=0x44f351e8 self=0x125550 05-08 19:09:47.886: I/dalvikvm(420): | sysTid=422 nice=0 sched=0/0 cgrp=default 句柄=1240608 05-08 19:09:47.886: I/dalvikvm(420): | schedstat=( 2639901 40055709 3 ) 05-08 19:09:47.886: I/dalvikvm(420): at dalvik.system.NativeStart.run(Native Method) 05-08 19:09:47.886: I/dalvikvm(420) : "HeapWorker" 守护进程 prio=5 tid=2 RUNNABLE 05-08 19:09:47.886: I/dalvikvm(420): | group="system" sCount=0 dsCount=0 s=N obj=0x438b8e50 self=0x12ece0 05-08 19:09:47.886: 我/dalvikvm（420）：| sysTid=421 nice=0 sched=0/0 cgrp=default 句柄=1195896 05-08 19:09:47.906: I/dalvikvm(420): | schedstat=( 4477669539 2785983510 211 ) 05-08 19:09:47.906: I/dalvikvm(420): at com.android.internal.os.BinderInternal$GcWatcher.finalize(BinderInternal.java:~48) 05-08 19: 09:47.906: I/dalvikvm(420): at dalvik.system.NativeStart.run(Native Method) 05-08 19:09:47.906: D/dalvikvm(420): threadid=2: 发送两个 SIGSTKFLTs 到 threadid=2 (tid=421) 导致调试器转储 05-08 19:09:57.895: D/dalvikvm(420): 发送，暂停让调试器运行 05-08 19:10:05.956: D/dalvikvm(420): 继续 05 -08 19:10:05.956：E/dalvikvm(420)：VM 中止

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:56:06.053

可能，在内存中拥有如此大的数组并不好。但无论如何，您可以通过以下方式重构数组来减少内存使用量： int worldgrid = new int[3][480][640];

这个技巧将多次减少内存使用量。它与数组和每个项目的 java 内存开销有关，详细信息可以在这里找到。 [http://www.javamex.com/tutorials/memory/array_memory_usage.shtml](http://www.javamex.com/tutorials/memory/array_memory_usage.shtml)

还要检查，你没有保留任何指向数组的链接，它会阻止它从内存中删除。此外，垃圾收集器不会在删除所有链接后立即从内存中删除。因此，如果您不使指向等于 null 的数组的链接，它会保存在内存中，并且当您重新启动应用程序时（无法保证活动被完全杀死），并尝试在 onCreate 中创建数组（正如我从日志中看到的那样) 旧数组还不能被删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:02:58.593

我不能告诉你为什么你每隔一段时间就会收到错误而没有看到你的代码的其余部分。你有你正在使用的静态变量吗？

但是，我可以建议您将内存消耗减少 3 倍。看起来您正在尝试存储 rgb 图像。问题是每个红色、绿色或蓝色像素只需要一个字节，但你给它一个 int 是 4 个字节。更好的方法是使用以下方法将红色、绿色和蓝色编码为单个 int：`int color = Color.rgb(red, geen, blue)`这样您只需将数组初始化为`int[] worldgrid= new int[640][480]`并将内存使用量减少 3 倍。

此外，您甚至可能根本不应该将它存储为多维数组，而只需`int[] worldgrid = new int[640*480];`在索引数组时执行以下操作：`int result = worldgrid[row + col*640];`

# c# - 枚举描述值到下拉列表

> ID：10505253
> 
> 赞同：11
> 
> 时间：2012-05-08T19:34:20.027
> 
> 标签：c#, enums

我是 C# 新手，我有一个问题，

我有一个类似的枚举

```
 public enum
        {
    [Description("1,2,3")]
    123,
    [Description("3,4,5")]
    345,
    [Description("6,7,8 ")]
    678,
       } 
```

现在我希望枚举描述绑定到下拉列表..有人可以帮助我..

提前致谢！

PS：如果我不清楚，我很抱歉..如果我需要更具体，请告诉我

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-08T19:46:55.417

```
public static class EnumExtensionMethods
{
    public static string GetDescription(this Enum enumValue)
    {
        object[] attr = enumValue.GetType().GetField(enumValue.ToString())
            .GetCustomAttributes(typeof (DescriptionAttribute), false);

        return attr.Length > 0 
           ? ((DescriptionAttribute) attr[0]).Description 
           : enumValue.ToString();            
    }

    public static T ParseEnum<T>(this string stringVal)
    {
        return (T) Enum.Parse(typeof (T), stringVal);
    }
}

//Usage with an ASP.NET DropDownList
foreach(MyEnum value in Enum.GetValues<MyEnum>())
   myDDL.Items.Add(New ListItem(value.GetDescription(), value.ToString())
...
var selectedEnumValue = myDDL.SelectedItem.Value.ParseEnum<MyEnum>()

//Usage with a WinForms ComboBox
foreach(MyEnum value in Enum.GetValues<MyEnum>())
   myComboBox.Items.Add(new KeyValuePair<string, MyEnum>(value.GetDescription(), value));

myComboBox.DisplayMember = "Key";
myComboBox.ValueMember = "Value";
...
var selectedEnumValue = myComboBox.SelectedItem.Value; 
```

这两种扩展方法对我来说是非常宝贵的，因为我做了 5 年和两种不同的工作，完全满足您的需求。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T19:56:44.967

你会这样写：

```
public enum Test
{
  [Description("1,2,3")]
  a = 123,
  [Description("3,4,5")]
  b = 345,
  [Description("6,7,8")]
  c = 678
}

//Get attributes from the enum
    var items = 
       typeof(Test).GetEnumNames()
        .Select (x => typeof(Test).GetMember(x)[0].GetCustomAttributes(
           typeof(DescriptionAttribute), false))
        .SelectMany(x => 
           x.Select (y => new ListItem(((DescriptionAttribute)y).Description)))

//Add items to ddl
    foreach(var item in items)
       ddl.Items.Add(item); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:38:58.017

您可以构建一个包装类，在每个成员上查找 DescriptionAttribute 并显示它。然后绑定到包装器实例。像这样的东西：

[获取 Enum<T> 值说明](https://stackoverflow.com/questions/297299/get-the-enumt-value-description)

# javascript - CSS marginTop 不能在 DIV 上工作而 marginLeft 工作

> ID：10505256
> 
> 赞同：0
> 
> 时间：2012-05-08T19:34:29.663
> 
> 标签：javascript, css, margin

> **可能重复：**
> [为什么这种 CSS margin-top 样式不起作用？](https://stackoverflow.com/questions/9519841/why-does-this-css-margin-top-style-not-work)

假设我有两个 DIV，一个在另一个内部（DIV1 -> DIV2），并且我在内部 DIV 上定义了一个 marginTop 属性，它应该在 DIV1 内移动 DIV2。相反，它将 DIV1**和**DIV2 从顶部移动 # 个像素。然而，marginLeft 在 DIV1 中正确移动 DIV2。

```
 // DIV1
    var x = document.createElement("div");
    x.style.width = "200px";
    x.style.height = "200px";
    x.style.backgroundColor = "red";

    // DIV2
    var y = document.createElement("div");
    y.style.width = "50px";
    y.style.height = "50px";
    y.style.backgroundColor = "black";
    y.style.marginTop = "10px";
    y.style.marginLeft = "10px"

    document.body.appendChild(x);
    x.appendChild(y); 
```

![在此处输入图像描述](../Images/b88b2e931882b26e6ee9a20b0dde1cba.png)

为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:36:32.603

`overflow: hidden;`在红色上设置一个`<div>`应该可以纠正

# c++ - int a[5]和int(&a)[5]在模板参数推导中的区别

> ID：10505259
> 
> 赞同：9
> 
> 时间：2012-05-08T19:34:38.570
> 
> 标签：c++, arrays, templates, template-argument-deduction

这个问题是关于采用静态已知大小的数组的函数。

以下面的最小程序为例：

```
#include <iostream>

template<size_t N>
void arrfun_a(int a[N])
{
    for(size_t i = 0; i < N; ++i)
        std::cout << a[i]++ << " ";
}

int main()
{
    int a[] = { 1, 2, 3, 4, 5 };
    arrfun_a<5>(a);
    std::cout << std::endl;
    arrfun_a<5>(a);

    return 0;
} 
```

运行时，它会打印预期的结果：

```
2 3 4 5 6
3 4 5 6 7 
```

但是，当我尝试让我的编译器（VS 2010）推断`5`出`could not deduce template argument for 'int [n]' from 'int [5]'`.

一些研究导致`arrfun_b`模板参数推导工作的更新：

```
template<size_t n>
void arrfun_b(int (&a)[n])
{
    for(size_t i = 0; i < n; ++i)
        std::cout << ++(a[i]) << std::endl;
} 
```

`arrfun_a`无论调用还是`arrfun_b`调用，程序的结果都是一样的。

到目前为止，我发现的唯一区别是模板参数推导是否有效，以及是否可以使用不是 5 的 N 调用函数......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-08T19:37:17.133

编译器会默默地更改函数参数的类型，`int a[N]`从而`int *a`丢失数组的大小。`int(&a)[5]`确实是对大小为 5 的数组的引用，并且不能传递任何其他大小的数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:39:49.277

我认为这是引用和指针之间的区别。

arrfun_a 传递一个指向 int 的指针。

arrfun_b 传递对整数数组的引用。

# c# - htmlUnit 中的重定向处理

> ID：10505269
> 
> 赞同：0
> 
> 时间：2012-05-08T19:35:24.160
> 
> 标签：c#, htmlunit

重定向时如何获取当前页面？如果我发送表单或服务器重定向我..

UPD webClient.getCurrentWindow().getEnclosedPage(); 完美地为我工作。谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T07:36:15.687

默认情况下，Webclient 设置为根据服务器请求重定向页面。为什么不禁用选项 wClient.setRedirectEnabled(false);

# matlab - 如何使用 Mikolajczyk 的特征检测器/描述符评估框架？

> ID：10505270
> 
> 赞同：5
> 
> 时间：2012-05-08T19:35:30.897
> 
> 标签：matlab, computer-vision, feature-detection, surf, feature-descriptor

[我正在尝试使用Mikolajczyk 等人](http://www.robots.ox.ac.uk/~vgg/research/affine/)的事实上的标准框架来评估我的 SURF 描述符实现的正确性。[人](http://www.robots.ox.ac.uk/~vgg/research/affine/)_ 我使用 OpenCV 来检测和描述 SURF 特征，并使用相同的特征位置作为我的描述符实现的输入。

为了评估描述符性能，该框架需要首先评估检测器的可重复性。不幸的是，可重复性测试需要一个特征位置列表以及定义每个特征周围图像区域的大小和方向的椭圆参数。然而，OpenCV 的 SURF 检测器只提供特征位置、比例和方向。

[相关论文](http://www.robots.ox.ac.uk/~vgg/research/affine/det_eval_files/vibes_ijcv2004.pdf)提出从二阶矩矩阵的特征值迭代计算这些椭圆参数。这是唯一的方法吗？据我所知，这需要对 OpenCV 进行一些摆弄。之后有没有办法从特征列表和输入图像中计算那些椭圆参数（例如在Matlab中）？

有没有人使用过这个框架并且可以帮助我提供一些见解或指示？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T10:29:01.170

您可以使用 OpenCV 中的文件评估.cpp。在目录 OpenCV/modules/features2d/src 中。在此文件中，您可以使用“EllipticKeyPoint”类，该类具有将“KeyPoint”转换为“ElipticKeyPoint”的功能

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:51:15.180

老实说，我从未使用过这个框架。但我认为你应该看看这篇[关于](http://lear.inrialpes.fr/pubs/2005/MS05/mikolajczyk_pami05.pdf)局部描述符性能评估的论文。

# iphone - 从预览内容生成的文档缩略图

> ID：10505273
> 
> 赞同：1
> 
> 时间：2012-05-08T19:35:55.760
> 
> 标签：iphone, ios, ipad, document, thumbnails

我正在一个 ios 应用程序中创建一个代表各种类型（PDF、图像、视频、HTML、.pages、.numbers、Word 等）下载文件的单元格网格，并且正在寻找一种方法来抢先创建预览缩略图让这些文件显示在单元格中。我目前正在使用 UIDocumentInteractionController 在用户选择一个文档后预览这些文档，并希望图标数组能够返回预览图像。不幸的是，它只返回一个通用图标。

我看到 Pages 和 Numbers 这样做，但他们拥有文档和格式。我希望 Quicklook 框架能提供一个解决方案，但我还没有找到它。有没有其他人找到一种方法来轻松生成这些缩略图？

我更喜欢使用实际的 UIImage 而不是其他人建议的 UIWebView 。该解决方案似乎是一个黑客，我必须相信那里有更好的解决方案。

我的下一个选择是在他们打开文档后通过将视图捕获为图像来生成预览，但这仍然看起来很老套。

有人有任何想法或更清晰的选择吗？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T22:47:26.787

我的解决方案：我从来没有找到一个完整的解决方案这个特定的问题，但我能够相当有效地处理 PDF。老实说，我不记得是我写了这个还是找到了一个例子。如果是您的代码发布在其他地方，谢谢！此处的最终结果是 docImage 为空，或者包含 PDF 的第一页作为图像。加载表格行时，我将图像预览设置为默认图像，然后使用块在后台线程上运行此代码。完成后，我只需将预览动画返回到单元格中。

```
NSURL *pdfFileURL = [NSURL fileURLWithPath:localFilePath];
CGPDFDocumentRef pdfDoc = CGPDFDocumentCreateWithURL((__bridge CFURLRef) pdfFileURL);
NSUInteger numPages = CGPDFDocumentGetNumberOfPages(pdfDoc);

if(numPages > 0) {
    docImage = [UIImage imageFromPDFDocumentRef:pdfDoc];
}
CGPDFDocumentRelease(pdfDoc); 
```

UIImage 类别：

```
@implementation UIImage (CGPDFDocument)

+(UIImage *)imageFromPDFDocumentRef:(CGPDFDocumentRef)documentRef {
    return [self imageFromPDFDocumentRef:documentRef page:1];
} 
+(UIImage *)imageFromPDFDocumentRef:(CGPDFDocumentRef)documentRef page:(NSUInteger)page {
    CGPDFPageRef pageRef = CGPDFDocumentGetPage(documentRef, page);
    CGRect pageRect = CGPDFPageGetBoxRect(pageRef, kCGPDFCropBox);

    UIGraphicsBeginImageContext(pageRect.size);
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextTranslateCTM(context, CGRectGetMinX(pageRect),CGRectGetMaxY(pageRect));
    CGContextScaleCTM(context, 1, -1);  
    CGContextTranslateCTM(context, -(pageRect.origin.x), -(pageRect.origin.y));
    CGContextDrawPDFPage(context, pageRef);

    UIImage *finalImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return finalImage;    
}
@end 
```

# ios - 不要在初始化方法和 dealloc 中使用访问器方法

> ID：10505274
> 
> 赞同：8
> 
> 时间：2012-05-08T19:36:00.413
> 
> 标签：ios, objective-c, memory-management

我正在阅读有关[内存管理](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmPractical.html#//apple_ref/doc/uid/TP40004447-SW6)的一些内容，他们不建议在初始化方法中使用访问器方法。

**问题**：为什么我们不应该在初始化方法中使用访问器方法？

我对此感到困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:42:40.310

这是我写的一个例子，它演示了两件事：

*   如何重新排序初始化
*   如何引入泄漏

[初始化属性，点表示法](https://stackoverflow.com/questions/5932677/initializing-a-property-dot-notation/5932733#5932733)

尽管该示例侧重于初始化，但`dealloc`容易出现类似类别的问题。举一个具体的例子：一个对象可能会在 中部分复活`dealloc`，引用计数不平衡成为潜在的危险。

简而言之，您希望专注于正确初始化和清理对象所需的数据——而不是通过任何子类关注对象的行为问题/影响。

* * *

更多阅读：

[为什么 myInstance = nil 而不是 self.myInstance = nil？](https://stackoverflow.com/questions/4895189/iphone-why-myinstance-nil-instead-of-self-myinstance-nil/4895752#4895752)

[我应该在 ARC 的 init 方法中引用 self.property 吗？](https://stackoverflow.com/questions/8056188/should-i-refer-to-self-property-in-the-init-method-with-arc/8056260#8056260)

[将保留属性设置为新创建的对象的最佳方法](https://stackoverflow.com/questions/7842641/best-way-to-set-a-retained-property-to-a-newly-created-object/7842811#7842811)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:26:01.203

对于双方的开发人员来说，这有点像宗教问题，而 ARC 的到来进一步混淆了这个问题。

有几个原因：

1.  对象未完全初始化，访问器可能依赖于完全初始化的对象。

2.  访问器可能有副作用，并且对象没有完全初始化。一个常见的副作用是在第一次使用时实例化 iVar。

这些参数也适用于在`dealloc`（对于非 ARC 代码）中使用访问器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T20:44:48.603

KVC 观察者监视 getter 和 setter 方法。除非您绝对确定没有人会观察您的财产，否则您就是在自找麻烦。有一个缺陷，即观察者正在处理部分解除分配的对象，这很难重现并且几乎无法测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T20:45:13.103

在 intialiser 方法中不使用访问器方法的主要原因`dealloc`可能源于 Mac OS X 开发，并且在 iOS 上可能不是什么大问题。Mac OS X GUI 开发涉及一个有用的东西，叫做“绑定”，它允许您将控件的属性绑定到对象的属性，这样当用户更新控件时，“绑定”会自动更新属性，如果程序更新属性（通过访问器方法），“绑定”会自动更新控件。

很多绑定的东西都是用 Key-Value Observing 完成的（我认为）。Key-Value Observing 是当一个对象观察到其他对象属性的变化时。每当您使用访问器方法更改属性时，任何正在观察您的对象的对象都会收到通知，以便它可以对属性的新值采取行动。使用访问器方法可以在您不希望它们发生时触发任何 Key-Value Observing 通知，例如在初始化和释放期间，因为您的对象的任何观察者将只处理部分初始化或部分释放的实例，而不是完全初始化实例。

还有另一个主要的关注领域，那就是当你的对象被子类化时。当您使用访问器方法设置对象的属性时，您实际上将调用子类的访问器方法（如果它实现了不同的访问器方法）。这不太可能成为问题，因为与 .NET 相比，Objective-C 开发中的继承很少见。

# asp.net - 在 ASP.net 中动态填充下拉列表，并将该值传递给另一个查询？

> ID：10505275
> 
> 赞同：1
> 
> 时间：2012-05-08T19:36:08.407
> 
> 标签：asp.net, drop-down-menu, data-driven, population

2个问题给大家。

1）如何按年份排序，使用 DESC 时会崩溃？

2）如果我像这样填充我的列表：

```
 string strConn = ConfigurationManager.ConnectionStrings["rde_410978ConnectionString"].ToString();
    SqlConnection con = new SqlConnection(strConn);
    SqlCommand cmd = new SqlCommand();
    cmd.Connection = con;
    cmd.CommandType = CommandType.Text;
    cmd.CommandText = "Select Distinct Year from MonthlySales DESC"; //DESC DOESNT WORK?

    DataSet objDs = new DataSet();
    SqlDataAdapter dAdapter = new SqlDataAdapter();
    dAdapter.SelectCommand = cmd;
    con.Open();
    dAdapter.Fill(objDs);
    con.Close();

    if (objDs.Tables[0].Rows.Count > 0)
    {
        ddItems.DataSource = objDs.Tables[0];
        ddItems.DataTextField = "Year";
        ddItems.DataValueField = "Year";
        ddItems.DataBind();
        ddItems.Items.Insert(0, "Select");
    } 
```

如何使所选年份出现在 ddItems.SelectedItem 下？

```
WHERE Year = " + ddItems.SelectedItem + "GROUP BY Name "; 
```

当我动态填充我的列表时，另一个查询的那部分不起作用，任何原因/如何修复它。

问候。

编辑：为了让我的第二个问题更清楚，在调试后它总是选择下拉列表中的顶部项目而不是实际选择的项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:39:12.223

答案 1)

```
cmd.CommandText = "Select Distinct Year from MonthlySales ORDER BY 1 DESC" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:39:55.283

首先，在你的 sql 中你缺少“order by”...使用这个

```
"Select Distinct Year from MonthlySales order by Year DESC" 
```

其次，您需要使用 SelectedValue 属性来获取下拉列表的选定值...如下...

```
WHERE Year = " + ddItems.SelectedValue + " GROUP BY Name"; 
```

话虽如此，我强烈建议您使用...“参数化” sql...这是一个有关如何启用参数化 sql 查询的示例... [给我参数化 SQL，或者给我死](http://www.codinghorror.com/blog/2005/04/give-me-parameterized-sql-or-give-me-death.html)

**更新：**

看起来你在每个帖子上绑定你的下拉列表......你可以试试这个......

```
if (!Page.IsPostBack && objDs.Tables[0].Rows.Count > 0)
    {
        ddItems.DataSource = objDs.Tables[0];
        ddItems.DataTextField = "Year";
        ddItems.DataValueField = "Year";
        ddItems.DataBind();
        ddItems.Items.Insert(0, "Select");
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T19:40:10.120

你失踪了`order by`。这里是。

```
"Select Distinct Year from MonthlySales order by Year DESC"; 
```

对于您的第二部分，您可以执行此操作。请注意空间`" GROUP BY Name"`

```
WHERE Year = " + ddItems.SelectedItem.Text + " GROUP BY Name "; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T19:56:18.290

```
using (SqlConnection con = new SqlConnection(strConn))
{
    using (SqlCommand cmd = new SqlCommand())
    {
        cmd.Connection = con;
        cmd.CommandType = CommandType.Text;
        cmd.CommandText = "Select Distinct Year from MonthlySales Order By DESC";

        using (DataSet objDs = new DataSet())
        {
            using (SqlDataAdapter dAdapter = new SqlDataAdapter())
            {
                dAdapter.SelectCommand = cmd;
                con.Open();
                dAdapter.Fill(objDs);
                con.Close();

                if (objDs.Tables[0].Rows.Count > 0)
                {
                    ddItems.DataSource = objDs.Tables[0];
                    ddItems.DataTextField = "Year";
                    ddItems.DataValueField = "Year";
                    ddItems.DataBind();
                    ddItems.Items.Insert(0, "Select");
                }
            }
        }
    }
} 
```

# javascript - 在javascript中查找二维对象数组中的值索引

> ID：10505284
> 
> 赞同：3
> 
> 时间：2012-05-08T19:37:00.380
> 
> 标签：javascript, arrays, multidimensional-array, for-loop

我有一个像这样的二维对象数组：

```
[[{id: 123}, {id: 456}, {id: 789}], [{id: 111}, {id: 222}, {id: 333}], [{id: 444}, {id: 555}, {id: 666}], [{id: 777}]] 
```

我需要在顶级数组级别找到 id 的索引。

因此，如果我要搜索值为 '222' 的 id 属性，我希望返回索引 1。

我尝试了以下方法：

```
var arr = [[{id: 123}, {id: 456}, {id: 789}], [{id: 111}, {id: 222}, {id: 333}], [{id: 444}, {id: 555}, {id: 666}], [{id: 777}]],
    len = arr.length
    ID = 789;

for (var i = 0; i < len; i++){
    for (var j = 0; j < arr[i].length; j++){
        for (var key in o) {
            if (key === 'id') {
                if (o[key] == ID) {
                    // get index value 
                }
            }
        }           
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T19:42:55.920

将您的代码包装在一个函数中，将您的注释替换为`return i`，通过返回一个标记值（例如 -1）来回避：

```
function indexOfRowContainingId(id, matrix) {
  for (var i=0, len=matrix.length; i<len; i++) {
    for (var j=0, len2=matrix[i].length; j<len2; j++) {
      if (matrix[i][j].id === id) { return i; }
    }
  }
  return -1;
}
// ...
indexOfRowContainingId(222, arr); // => 1
indexOfRowContainingId('bogus', arr); // => -1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:44:34.687

既然你知道你想要`id`，你就不需要`for-in`循环。

只要打破外循环，`i`就会成为你的价值。

```
var arr = [[{id: 123}, {id: 456}, {id: 789}], [{id: 111}, {id: 222}, {id: 333}], [{id: 444}, {id: 555}, {id: 666}], [{id: 777}]],
    len = arr.length
    ID = 789;

OUTER: for (var i = 0; i < len; i++){
    for (var j = 0; j < arr[i].length; j++){
        if (arr[i][j].id === ID)
            break OUTER;           
    }
} 
```

或者把它变成一个函数，然后返回`i`。

# javascript - 如何遍历对象中所有唯一的条目对？

> ID：10505286
> 
> 赞同：4
> 
> 时间：2012-05-08T19:37:05.573
> 
> 标签：javascript, iteration, javascript-objects

我目前有一个数组数据结构，我像这样迭代它，调用`foo`每对唯一的元素。

```
for(var i = 0; i < arr.length; i++) {
    for(var j = i + 1; j < arr.length; j++) {
        foo(arr[i], arr[j]);
    }
} 
```

但是，我意识到我宁愿使用对象而不是数组，因为这样我就可以很容易地按名称添加和删除元素。

但是，我看不到迭代此类对象的明显方法。我能得到的最接近的是：

```
for(i in obj) {
    for(j in obj) {
        foo(obj[i], obj[j]);
    }
} 
```

显然，这将对每一对做两次，甚至产生一对相同的元素。有没有一种简单的方法可以像在第一个代码示例中的数组中那样迭代对象？

### 更新：

[在jsperf](http://jsperf.com/adjacent-pair-iteration)上测试解决方案的性能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T20:29:07.930

我的解决方案最初是作为评论写的：

`if (i < j)`在内循环中添加条件。它可能不是最好的解决方案，但只要 foo 函数对`foo(2, 10)`and做同样的事情，它就可以工作`foo(10, 2)`：

```
for(i in obj) {
    for(j in obj) {
        if (i < j) {
            foo(obj[i], obj[j]);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:44:27.290

假设我理解你的问题......也许检查一下外部循环是否已经访问了该值？

```
var visited = {}
for(i in obj) {
    visited[i] = true;
    for(j in obj) {
        if(j in visited){ continue; }
        foo(obj[i], obj[j]);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T19:50:21.550

使用 Object.keys() 将键列表作为数组取出：

```
keys = Object.keys();
for(i=0;i<keys.length;i++) {
    for(j=i+1;j<keys.length;j++) {
        foo(obj[keys[i]], obj[keys[j]]);
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-08T19:55:20.473

也许您可以尝试取消设置使用的对象：

```
for(i in obj) {
    var a = obj[i];
    delete obj[i];
    for(j in obj) {
        foo(a, obj[j]);
    }
} 
```

[http://jsfiddle.net/bXcvb/](http://jsfiddle.net/bXcvb/)

如果您需要完整的原始 obj，请参阅：[如何正确克隆 JavaScript 对象？](https://stackoverflow.com/questions/728360/copying-an-object-in-javascript)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-08T19:47:19.893

您可以将对象键推送到数组中：

```
var obj_keys = [];
for (i in obj) {
  obj_keys.push(i);
}

for(i = 0; i < obj_keys.length; ++i) {
    for(j = i + 1; j < obj_keys.length; ++j) {
        foo(obj[obj_keys[i]], obj[obj_keys[j]]);
    }
} 
```

# python - 如何让 AppEngine 在同一页面上显示错误？

> ID：10505293
> 
> 赞同：1
> 
> 时间：2012-05-08T19:37:25.140
> 
> 标签：python, google-app-engine

有没有办法让 AppEngine 在我尝试加载的页面中显示来自日志控制台的错误？这个想法是避免每次都去日志......

```
 File "test.py", line 14
    title = r.getElementsByTagName("title")[0].firstChild.data      
        ^
IndentationError: expected an indented block 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:46:46.607

通常，您可以使用 try 语句的 catch-all ( ) 子句捕获*所有*错误，包括语法错误。`except:`如果您可以在代码中使用这种策略，然后在例如警报消息（或任何其他方式）中显示异常，那么您就得到了您所要求的。

另外，看看[这个](https://stackoverflow.com/questions/3154900/global-exception-handling-in-google-app-engine)问题和接受的答案。如果您`handle_exception`按照那里的说明进行覆盖，您可以放置​​以您喜欢的方式修改对请求的响应的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T05:15:51.610

如果您使用的是 webapp 或 webapp2 框架，您可以通过添加`debug=True`到`WSGIApplication`构造函数来执行此操作。

但请注意，这通常不是一个好主意，因为它会将您的应用程序的内部细节暴露给用户，并向他们展示一个特别无用的 500 页面。

# c# - 从 C# 代码运行 New-MailContact cmdlet 时未创建联系人

> ID：10505294
> 
> 赞同：1
> 
> 时间：2012-05-08T19:37:25.390
> 
> 标签：c#, powershell, active-directory, cmdlets

我有一个应用程序（除其他外）需要调用 New-MailContact cmdlet 并在 Active Directory 中创建联系人。我已经关注了一些技术文章以达到我所拥有的程度，但它仍然无法正常工作。

我已经验证我正在使用的服务帐户具有基于[此 TechNet 页面](http://technet.microsoft.com/en-us/library/bb124519%28v=exchg.80%29.aspx "这个技术网页面")的正确身份验证。我能够从 powershell 找到并调用 cmdlet，并且没有收到任何错误。

但是，运行后我检查了我的 OU，但没有创建我的联系人。我发现[了这篇](http://support.microsoft.com/kb/555190)我认为可能值得怀疑的 KB 文章，但由于 cmdlet 在调用后没有返回任何错误，因此我不能确定这是否能解决我的问题。

这是我正在做的一个片段：

```
 public bool CreateMailContactObject(ADExchangeContact adExchangeContacts)
    {
        Collection<PSObject> results;
        Pipeline pipeLine = null;

        try
        {
            var runspaceConfiguration = RunspaceConfiguration.Create();
            PSSnapInException snapInException;
            var snapInInfo = runspaceConfiguration.AddPSSnapIn("Microsoft.Exchange.Management.PowerShell.Admin", out snapInException);

            using (var runspace = RunspaceFactory.CreateRunspace(runspaceConfiguration))
            {
                var newMailBoxContact = new Command("New-MailContact");
                newMailBoxContact.Parameters.Add("Name", adExchangeContacts.DisplayName);
                newMailBoxContact.Parameters.Add("ExternalEmailAddress", adExchangeContacts.ExternalEmailAddress);
                newMailBoxContact.Parameters.Add("OrganizationalUnit", adExchangeContacts.OrganizationalUnit);
                newMailBoxContact.Parameters.Add("Alias", adExchangeContacts.Alias);

                runspace.Open();

                pipeLine = runspace.CreatePipeline();
                pipeLine.Commands.Add(newMailBoxContact);

                results = pipeLine.Invoke();

                _log.DebugFormat("results.Count = {0}", results.Count);
                results.ForEach(x => x.Properties.ForEach(y => _log.DebugFormat("{0}: {1}", y.Name, y.Value)));

                pipeLine.Stop();
                runspace.Close();
            }

            return true;
        }
        catch (Exception ex)
        {
            // Add log statement
            _log.ErrorFormat("Creation of Mail Contact in AD Failed. Error: {0}", ex);
            return false;
        }            
    } 
```

我没有得到任何异常，并且我的结果列表在管道调用中是空的。有什么我想念的吗？如果在 AD 中创建联系人时由于权限导致 cmdlet 失败，我不希望在结果集中收到某种错误`pipeLine.Invoke()`吗？？

我是运行 Powershell 的新手，所以如果手头还有其他问题（知识库文章之外），请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:48:47.747

```
 if (pipeline.Error != null && pipeline.Error.Count > 0)
                {
                    StringBuilder pipelineError = new StringBuilder();
                    pipelineError.AppendFormat("Error calling Add-MailboxPermission.");
                    foreach (object item in thisPipeline.Error.ReadToEnd())
                    {
                        pipelineError.AppendFormat("{0}\n", item.ToString());
                    }

                    ErrorText = ErrorText + "Error: " + pipelineError.ToString() + Environment.NewLine;
                } 
```

请将此代码放在**pipeline.Invoke()**之后并检查其中是否有任何错误

**更新：** 我认为向用户授予正确权限是错误的，对此有一些解决方案：

[http://boardreader.com/thread/Microsoft_Exchange_2010_wont_allow_new_M_1w69j__37ad9f8a-cdcf-4d26-9384-00ad1a3d0f91.html](http://boardreader.com/thread/Microsoft_Exchange_2010_wont_allow_new_M_1w69j__37ad9f8a-cdcf-4d26-9384-00ad1a3d0f91.html)
[http://blogs.technet.com/b/richardroddy/archive/2010/07/12/exchange-2010-and-the -exchange-trusted-subsystem.aspx](http://blogs.technet.com/b/richardroddy/archive/2010/07/12/exchange-2010-and-the-exchange-trusted-subsystem.aspx)

# ios - iOS 网络/原生应用 Facebook 登录弹出窗口 - 失败？

> ID：10505303
> 
> 赞同：7
> 
> 时间：2012-05-08T19:38:02.867
> 
> 标签：ios, facebook, web-applications, facebook-javascript-sdk, facebook-ios-sdk

我正在尝试构建一个允许用户登录 Facebook 的网络应用程序。一切都在 Firefox/Chrome/Safari 中运行（在手机/平板电脑和 OSX 上）。

当应用程序在平板电脑（原生 UIWebview 和 Web-app）上运行时，它会完美地加载第一页。

当用户单击“与 Facebook 连接”按钮时，应用程序会加载 Facebook 登录页面。

用户登录后（同样，在 Native UIWebview 和 web-app 中），视图变成白色，挂在 URL 上：'https://www.facebook.com/dialog/permissions.request?_path=permissions.request&app_id =[APP_ID]...' - 这似乎不应该发生......

如果我重新启动应用程序/网络应用程序，用户会自动登录，并重定向到成功页面。

## 我认为导致问题的原因

当您在 Firefox/Chrome/Safari 浏览器中运行网页时，Facebook 登录对话框会作为弹出窗口或另一个选项卡弹出（后者在本机 Safari 浏览器上）。

我认为这是此弹出页面以及成功登录时 Javascript 如何与自身通信的问题。`window.close`没有根页面可以返回的东西（因为 web 应用程序和 UIWebview 只有一个 webview 实例）......也许？

## 解决方法失败（UIWebview）

由于应用程序挂断了前面提到的 URL，我决定添加一个 if 语句`shouldStartLoadWithRequest(...)`来强制 UIWebview 转到成功 URL。

它加载 URL，但在 Facebook 的 Javascript SDK 函数`FB.getLoginStatus`函数返回“已连接”之前（我每次看到它都会返回“已连接”）该函数`FB.Event.subscribe('auth.logout' function() {...});`被触发。

我不明白它为什么要注销用户，然后告诉我用户已连接（登录） - 按此顺序。

**在我开始尝试构建这个 100% 原生（并且必须忍受苹果的开发帐户并提交应用程序）之前有什么想法吗？**

## 登录脚本

```
<script>(function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=APP_ID";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));</script>

        <script>
        var seccond_page = false;
        window.fbAsyncInit = function() {
            FB.init({
                appId      : '[APP_ID]',
                status     : true,
                cookie     : true,
                xfbml      : true,
                oauth      : true
            });

            FB.Event.subscribe('auth.login', function(response) {
                window.location.href = '<?= $success ?>';
            });

            FB.Event.subscribe('auth.logout', function(response) {
                window.location.reload();
            });

            FB.login(function(response) {
                alert(response.status);
                if (response.status) {
                    if (response.status == 'connected') {
                        window.location.href = '<?= $success ?>';
                    }
                }
            }, {scope: 'email, user_likes, user_status, user_birthday, user_location, publish_checkins'});

            $(document).on('click', '#fb_login_button', function() {
                FB.login();
            });
        };
        </script> 
```

## 成功页面

```
 <script>
        var fb_user_id = '';
        var fb_access_token = '';
        var user_location = '';
        window.fbAsyncInit = function() {
            FB.init({
                appId      : '[APP_ID]',
                status     : true,
                cookie     : true,
                xfbml      : true,
                oauth      : true
            });

            FB.getLoginStatus(function(response) {
                alert('Response - ' + response.status); 
                // the auth.logout is fired before the return of this in the failed fix
                if (response.status === 'connected') {
                    if (response.authResponse) {
                        fb_user_id = response.authResponse.userID
                        fb_access_token = response.authResponse.accessToken;
                    }
                }

            });

            FB.Event.subscribe('auth.logout', function(response) {
                alert('logout - auth.logout'); 
                // This event is fired before the above function in the failed fix
                window.location.href = '<?= site_url('fb_login'); ?>';
            });

            FB.Event.subscribe('edge.create', function(response){
                if (response == '<?= $like_url ?>') {
                    //action
                }
            });
        };
</script> 
```

所有页面都有元标记：`<meta name="apple-mobile-web-app-capable" content="yes">`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T17:32:41.047

Facebook 在 auth.login 之前调用 auth.logout，原因我不清楚。在假设用户确实已注销之前，您应该检查响应参数。[Facebook 文档](http://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/)状态：

> auth.logout - 用户注销时触发。传入回调函数的响应对象如下所示： { status: "", /* 当前会话状态 */ }

如果只在`response.status`is really时执行注销处理`""`，您可能会发现在登录过程中，它在调用`auth.login`侦听器后立即调用`auth.logout`侦听器。您当前的`auth.logout`处理会阻止您注意到这一点，因为页面重新加载会停止 JS 和 ajax 执行。

# c# - 使用 Json.net 反序列化时出现“意外令牌：StartObject”

> ID：10505306
> 
> 赞同：3
> 
> 时间：2012-05-08T19:38:26.050
> 
> 标签：c#, json, json.net

我有 C# WebClient 返回的以下 JSON：

```
"\n\n\n{\n \"resultCount\":1,\n \"results\": [\n{\"wrapperType\":\"artist\", \"artistType\":\"Artist\", \"artistName\":\"Jack Johnson\", \"artistLinkUrl\":\"http://itunes.apple.com/us/artist/jack-johnson/id909253?uo=4\", \"artistId\":909253, \"amgArtistId\":468749, \"primaryGenreName\":\"Rock\", \"primaryGenreId\":21}]\n}\n\n\n" 
```

或者，更清楚地说：

```
{
   "resultCount ":1,
   "results ":[
      {
         "wrapperType ":"artist ",
         "artistType ":"Artist ",
         "artistName ":"Jack Johnson ",
         "artistLinkUrl ":"http://itunes.apple.com/us/artist/jack-johnson/id909253?uo=4 ",
         "artistId ":909253,
         "amgArtistId ":468749,
         "primaryGenreName ":"Rock ",
         "primaryGenreId ":21
      }
   ]
} 
```

我尝试将其反序列化为一个类，如下所示：

```
 thejsonresult = JsonConvert.DeserializeObject<JsonResult>(WebRequest.Json); 
```

但收到以下错误：

> 读取字符串时出错。意外标记：StartObject。第 7 行，位置 2。

我很迷茫，找不到任何关于此的文档。有人有线索吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T06:08:20.370

我相信这个问题实际上是在你试图反序列化的类中找到的。

您拥有的包装器属性未正确反序列化。如果它是你类中的一个对象，那么它应该可以工作，但如果它是一个字符串，我猜是这样，那么 Json 反序列化器将尝试反序列化它并发现它不是一个字符串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-11-26T01:44:05.040

我最近使用序列化结果中的字符串遇到了相同类型的反序列化异常，“Unexpected token: StartObject”。

似乎目标的属性声明不能与对象类型同名。在我的例子中，被反序列化的对象有一个 ZipCode 的属性，它是一个 ZipCode 类。

最终，将属性名称更改为类名称以外的名称解决了异常。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-08T19:45:57.493

这不会在 LINQPad 中为我抛出任何异常：

```
JsonConvert.DeserializeObject<JsonResult>("\n\n\n{\n \"resultCount\":1,\n \"results\": [\n{\"wrapperType\":\"artist\", \"artistType\":\"Artist\", \"artistName\":\"Jack Johnson\", \"artistLinkUrl\":\"http://itunes.apple.com/us/artist/jack-johnson/id909253?uo=4\", \"artistId\":909253, \"amgArtistId\":468749, \"primaryGenreName\":\"Rock\", \"primaryGenreId\":21}]\n}\n\n\n") 
```

如果您得到不同的结果，您可能想尝试不同版本的 JSON.NET 以查看它是否存在错误。

# performance - 将数据库放到专用服务器上时性能会变差吗？

> ID：10505310
> 
> 赞同：2
> 
> 时间：2012-05-08T19:38:38.633
> 
> 标签：performance, web-services, scalability, scalable

我听说扩展系统的一种方法是为 Web 服务器、数据库服务器使用不同的机器，甚至为每种类型的服务器使用多个实例

我想知道这如何提高“一台服务器用于一切”模型的性能？这些服务器之间的连接没有瓶颈吗？此外，在从不同的 Web 服务器访问数据库服务器时，您将不得不关心同步。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:50:23.340

如果您的基础设施足够小，那么是的，1 台服务器（可能）是（可能）最好的做事方式，但是当您的规模开始要求您使用超过 1 台服务器时，扩展您的单个机器的大小可能会变得更多昂贵然后拥有多个更便宜的服务器。这也意味着您可以拥有更多的容错能力（如果一台服务器出现故障，其他服务器可以接管）。至于同步数据，在数据库端通常通过集群或复制来实现，在应用端可以通过memcached或保存到驱动之类的方式来实现，而web服务器本身并不需要同步. 本地网络上的网络瓶颈（就像您的服务器可能来自彼此一样）可以忽略不计。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-20T16:33:27.950

拥有大量服务器似乎是一个有吸引力的解决方案。经常发生的一个问题是服务器之间的通信产生的延迟。即使使用光纤互连，它也会比它们驻留在同一台服务器上慢。当然，在单个服务器解决方案中，如果一个服务器应用程序做了很多工作，它可能会耗尽数据库应用程序所需的 CPU 资源。

另一个可能出现的问题是 SAN。SAN 的支持者会说它们与本地连接的存储一样快。SAN 的目的是降低存储成本。即使 SAN 使用与本地解决方案相同的高性能磁盘（消除成本节省），您仍然需要在 SAN 上处理较慢的连接和更多的并发用户。

传统观点认为，数据库应该是基于 SQL 的标准化数据。花一些时间权衡利弊（是的，SQL 有弊端）是值得的。

自从“远古时代”（至少在过去二十年）以来，冷漠的程序员已经用他们懒得在客户端实现的东西使服务器超载。冷漠（或无知）的建筑师允许这种做法继续下去。最终结果：几乎无用的缓慢 c/s 实现。将服务器园区增加三倍是一种绝望的“交付前一周”措施，充其量只会导致性能的边际提升。通常你会失去性能。

数据库不应该被涉及多个表的复杂请求所困扰。由客户端过滤的简单请求是要走的路。

要尝试的一件事可能是将框架/ SOAP 处理放在一台服务器上，并让它向 DB 服务器发送二进制请求，该服务器以二进制响应进行回答（试图理解 SOAP 请求是非常占用 CPU 资源的，而您不这样做'不想留给无论如何都会或多或少窒息的数据库应用程序）。这样，您将让 SOAP 仅限制环境的一部分（用户/其他框架用户的接口），其余接口将尽可能高效（二进制）。

另一件事——如果应用程序允许的话——是在数据库应用程序上放置一个缓存前端。这个缓存的目的是在不涉及数据库本身的情况下做尽可能多的重复性工作。这样，数据库就可以处理更少但（也许）更复杂的请求，而不是做所有事情。

哦，不要让客户端直接向数据库发送 SQL 语句。你会惊讶于数据库必须应对的垃圾。

# sql - 在货币汇率中使用的最大小数位数是多少？

> ID：10505312
> 
> 赞同：10
> 
> 时间：2012-05-08T19:38:51.643
> 
> 标签：sql, tsql, decimal, currency, currency-exchange-rates

我需要在 SQL 2008 数据库中存储**货币汇率数据。**我想将 rate 作为`decimal`数据库中的一种数据类型。

我不确定的一件事是**要给出多少小数位**（**例如 decimal(18, ?)**）。

因为，我将使用此服务作为来源： http: [//openexchangerates.org/latest.json](http://openexchangerates.org/latest.json)。在那里，似乎使用的最高小数位数是“ **6** ”。

这是正确的数字，还是可能有超过**6**个小数位的费率？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-08T19:45:41.507

我曾经做过一个基于 C# 的国际金融包，它必须支持多种货币，我们支持 6 位小数。我们有几个非常有经验的设计师告诉我们这就足够了。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-11-21T02:46:53.570

如今，为了支持不太可能的 XBT/VND 汇率，您需要 10 到 14 位小数

截至 2017 年 11 月 20 日，

```
1 XBT = 185,416,429.63 VND
1 VND = 0.00000000539327 XBT 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-09T10:12:48.533

对此没有一个简单的答案。问题是您要存储什么：

*   它是发票的*最终货币金额吗？*
*   还是可能*是单据行*的行金额（例如发票行的行金额）？

## 最终货币金额

我只知道小数点后 2 位的货币，但[根据 Oracle](https://docs.oracle.com/cd/E41507_01/epm91pbr3/eng/epm/penw/task_ConfiguringCurrencyPrecisionforCurrencyConversion-99126e.html)的这个文档，ISO 标准规定货币允许**小数点**后 3 位。（我找不到 Oracle 在这里提到的 ISO 文档）。

*有趣：* SQL Server 有一个数据类型[`money`，`smallmoney`](https://docs.microsoft.com/en-us/sql/t-sql/data-types/money-and-smallmoney-transact-sql?view=sql-server-ver15)它支持 4 位小数。不知道他们是怎么想出来的，可能是因为四舍五入的问题（见下文）。

## 单据行的行数

您可能希望确保不会遇到四舍五入问题，因此使用超过 3 个小数位来表示文档总金额（例如发票）的“子金额”。

*例子：*

| 线 | 数量 | 价格 | 折扣 | 行金额 | 行金额四舍五入到小数点后 2 位 |
| --- | --- | --- | --- | --- | --- |
| 项目 A | 5 | 79.99 | 3% | 387.9515 | 387.95 |
| B项 | 2 | 56.12 | 3% | 108.8728 | 108.87 |
| 项目 C | 1 | 12.19 | 3% | 11.8243 | 11.82 |
| 全部的 |  |  |  | 508.65 | 508.64 |

当我们将行数四舍五入到小数点后两位时，我们最终会有 1 美分的四舍五入差异。您可以使用其他数字玩这个游戏，如果您遇到的差异超过小数点后三位。

我使用的大多数系统都使用不同的方法：

*   在行金额中使用**5 个或更多小数位。**小数点后 5 位，如果这些四舍五入问题应该解决。我看到 ERP 系统有 10 个小数位，但我认为这更像是一个糟糕的应用程序设计。
*   *将行中的“强制”四舍五入为*最大货币金额。小数位。当您想在发票中打印“行金额”并且您不想制作四舍五入的行金额与总金额不匹配的打印发票时，这是有道理的
*   使其可以为应用程序配置应使用多少小数位。
*   在文档中添加“粗略”行以对四舍五入进行打折，以防四舍五入问题对客户不利。
*   当出现舍入问题时警告应用程序用户并询问系统应如何处理它们

如何处理文档行中的舍入问题取决于您的应用程序设计。

# iphone - iOS 5 - AFNetworking - 上传视频

> ID：10505317
> 
> 赞同：2
> 
> 时间：2012-05-08T19:39:03.520
> 
> 标签：iphone, ios5, upload, afnetworking

对于我的应用程序，用户将能够录制视频或从他们的相册中选择视频，并通过 php 脚本将视频文件上传到服务器。要将文件上传到服务器，我使用的是 AFNetworking。我最初尝试从相册上传视频，但由于我无法让它工作，我在主包中添加了一个视频（我知道通过我为 php 脚本制作的 html 前端可以很好地上传）。

代码是：

```
NSString *vidURL = [[NSBundle mainBundle] pathForResource:@"test" ofType:@"mov"];
    NSData *videoData = [NSData dataWithContentsOfURL:[NSURL fileURLWithPath:vidURL]];

    NSLog(@"The test vid's url is %@.",vidURL);

    AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:[NSURL fileURLWithPath: @"http://www.mywebsite.com"]];

    NSMutableURLRequest *afRequest = [httpClient multipartFormRequestWithMethod:@"POST" path:@"/upload.php" parameters:nil constructingBodyWithBlock:^(id <AFMultipartFormData>formData) 
    {
        [formData appendPartWithFileData:videoData name:@"file" fileName:@"test.mov" mimeType:@"video/quicktime"]; 
    }];

    AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:afRequest];

    [operation setUploadProgressBlock:^(NSInteger bytesWritten,long long totalBytesWritten,long long totalBytesExpectedToWrite) 
    {

        NSLog(@"Sent %lld of %lld bytes", totalBytesWritten, totalBytesExpectedToWrite);

    }];

    [operation start]; 
```

我的 PHP 脚本运行良好，因为我可以通过 HTML 表单上传相同的视频。但是，上面的代码无法到达 setUploadProgressBlock。

是否有任何东西对任何人来说都是破碎的，或者我还缺少什么？

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T18:53:25.140

这是我用来解决问题的方法：

```
httpClient = [AFHTTPClient clientWithBaseURL:[NSURL URLWithString:@"http://www.mysite.com"]];

    NSMutableURLRequest *afRequest = [httpClient multipartFormRequestWithMethod:@"POST" path:@"/upload.php" parameters:nil constructingBodyWithBlock:^(id <AFMultipartFormData>formData) 
    {
        [formData appendPartWithFileData:videoData name:@"file" fileName:@"filename.mov" mimeType:@"video/quicktime"];
    }];

    AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:afRequest];

    [operation setUploadProgressBlock:^(NSInteger bytesWritten,long long totalBytesWritten,long long totalBytesExpectedToWrite) 
    {

        NSLog(@"Sent %lld of %lld bytes", totalBytesWritten, totalBytesExpectedToWrite);

    }];

    [operation  setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {NSLog(@"Success");} 
                                      failure:^(AFHTTPRequestOperation *operation, NSError *error) {NSLog(@"error: %@",  operation.responseString);}];
    [operation start]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T19:49:27.613

也许对象会立即被释放。使 AFHTTPClient 成为您的类或子类的实例变量并使其成为单例。

更重要的是：替换此行：

```
[operation start]; 
```

和：

```
[httpClient enqueueHTTPRequestOperation:operation]; 
```

# crystal-reports - 在 Crystal Reports 10 中按结果分组

> ID：10505318
> 
> 赞同：0
> 
> 时间：2012-05-08T19:39:07.063
> 
> 标签：crystal-reports, grouping

我对 Crystal Reports 比较陌生，正在尝试创建一个按组显示计数的报告。例子：

表“设备”

```
设备类型/型号 维修日期
米 2011 年 7 月 12 日
C 2012 年 3 月 1 日
2011 年 5 月 9 日
男 2011 年 10 月 1 日
男 2011 年 11 月 1 日
2011 年 9 月 9 日
```

我的问题是如何获得每年维修 1 次、每年维修 2 次等的设备数量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:06:56.403

创建一个新公式：

```
Year({Date of Repair}) 
```

然后按设备类型/型号分组，然后按您的新公式。

完成此操作后，您可以右键单击日期值并选择“插入摘要”并将其设置为计数。然后，您可以将汇总字段拖到正确的组级别。

# facebook - Facebook API - 类似于 Hootsuite 的身份验证

> ID：10505329
> 
> 赞同：0
> 
> 时间：2012-05-08T19:39:57.947
> 
> 标签：facebook, facebook-graph-api

我需要实现一个系统来检索来自 facebook 用户的信息，而与登录到 facebook 的用户无关。

我的数据库中有用户访问令牌，但每次用户需要登录 Facebook。

我的问题是Hootsuite（hootsuite.com）的身份验证如何工作，因为没有必要。只需登录Hootsuite就可以从facebook恢复所有数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:54:13.857

你所说的（如果我理解正确的话）在 Facebook 眼中是对隐私的侵犯。用户必须与应用程序交互才能检索有关用户的信息。

Facebook 的 API 访问通过`access_token`特定于用户和请求它的应用程序的方式工作。 `access_token`的有效时间有限，之后应用程序将不得不请求一个新的或请求对该令牌的扩展。在任何一种情况下，当发出这样的请求时，用户都必须与应用程序交互，并因此登录到 Facebook。

我不熟悉您提到的网站，但对他人的应用程序进行逆向工程不在本网站的范围内。

# ruby-on-rails - Rails 3.2、Vagrant 和 HAML：ActionView::MissingTemplate

> ID：10505332
> 
> 赞同：2
> 
> 时间：2012-05-08T19:40:01.867
> 
> 标签：ruby-on-rails, haml, vagrant

我已经阅读了可以在 Stackoverflow 和其他地方找到的所有相关主题，但没有看到报告过这个特定问题。

我的一位开发人员正在 Windows 7 上使用 Ubuntu ocelot 盒运行 Vagrant。我在运行 Pow 的 iMac 上。我们正在使用 HAML 开发 Rails 应用程序。

偶尔，他会得到这个错误：

```
ActionView::MissingTemplate in Admin/apps#edit

Showing /vagrant/app/views/admin/_panel.html.haml where line #15 raised:

Missing partial admin/apps/list, application/list with {:locale=>[:en], :formats=>[:html], :handlers=>[:erb, :builder, :coffee, :haml]}. Searched in:
  * "/vagrant/app/views" 
```

我拉入代码并在 Pow 中运行它，它运行完美。

但是，当他重命名有问题的文件（例如，从 _list.html.haml 到 _kevin.html.haml）时，它开始在他的机器上运行。如果他将其重命名为“_list”，则会再次出现错误。

它也不仅仅是一个特定的文件名。这是非常随机的。

有任何想法吗？

**编辑**

似乎只有当您尝试在视图不存在时加载视图然后进入并稍后创建它时才会发生这种情况。Vagrant/Rails 似乎认为它仍然不存在。试图弄清楚这种缓存可能发生在哪里以及我们现在如何清除它。

**编辑 2**

似乎重新启动 Vagrant 可以解决此问题。

```
vagrant reload 
```

希望这可以帮助某人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T20:30:33.703

似乎重新启动 Vagrant 可以解决此问题。

```
vagrant reload 
```

希望这可以帮助某人。

# java - 如何解析具有自定义逻辑条件的字符串？

> ID：10505333
> 
> 赞同：3
> 
> 时间：2012-05-08T19:40:05.717
> 
> 标签：java, string, parsing, boolean

我有一个包含多行条件字符串的文件，我需要读取该文件并将逻辑条件字符串转换为实际代码。有几个参数，条件的每一行检查一个或多个参数是否满足指定值或包含指定值。例如：

```
$parameterA = "value_1" AND ($parameterB CONTAIN "%value_2%" OR $parameterC = "value_3") 
```

“=”、“AND”和“OR”具有“==”、“&&”和“||”的含义。“%”是通配符。

将其转换为代码后，它应该如下所示：

```
if (obj.parameterA == "value_1" && (obj.parameterB.contains("value_2") || obj.parameterC == "value_3"))
     return true;
else return false; 
```

其中“obj”是某个类的实例。

我在这里搜索了其他帖子，似乎ANTLR可能是一个不错的选择。但是，我没有这方面的经验，也不知道在 Java 中使用它有多难。在深入了解 ANTLR 的所有细节之前，我只想检查一下是否还有其他好的想法。非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:50:17.583

实际上我不知道现有库是否这样做，但评估表达式的经典方法是分两步完成：

您拥有的表达式是中缀表示法，因此您需要将其转换为前缀表示法，这是删除括号并将运算符放在操作数前面。

在第二步中，您使用一个简单的递归算法来评估表达式，该算法反过来也将负责解析变量。

还有一件事，你应该给赋值运算符最高优先级。

我编写了一个表达式评估器的开源实现：也许您可以扩展它以满足您的需求。

[jDTO 表达式评估器源](https://github.com/jDTOBinder/jDTO-Binder/tree/master/jdto/src/main/java/org/jdto/util/expression)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:05:37.383

对于非常简单的语言（例如布尔表达式），像 ANTLR 之类的工具可以工作，但确实有点矫枉过正。您可以很容易地手动编写解析器。[请参阅我关于手动编写递归下降解析器的](https://stackoverflow.com/questions/2245962/is-there-an-alternative-for-flex-bison-that-is-usable-on-8-bit-embedded-systems/2336769#2336769)SO答案。

# android - 将 Android 视图附加到布局/从布局分离

> ID：10505346
> 
> 赞同：2
> 
> 时间：2012-05-08T19:41:04.813
> 
> 标签：android, android-layout, android-webview

我想在 Application 类的派生类的 onCreate() 方法中创建一个 WebView，然后在调用活动 onCreate() 时将其附加到主布局，并在调用 onDestroyed() 时将其分离。因此，每次创建/销毁活动时，WebView 组件都是相同的（有点单例）。问题是我（以我的 Windows API 背景）不知道如何做到这一点。只是新的 WebView()/addiew()/removeView()？

你问我为什么要这样做？[防止在关闭屏幕时重新创建 Android 活动](https://stackoverflow.com/questions/10498636/prevent-android-activity-from-being-recreated-on-turning-screen-off)简而言之，WebView 永远不应该被破坏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T10:53:18.833

没什么特别的。在清单中将 MyApp 注册为应用程序类名称。

```
public class MyApp extends Application
{
    public WebView _WebView = null;

    @Override
    public void onCreate()
    {
        _WebView = new WebView(getApplicationContext());
        // Settings etc.
        _WebView.loadUrl("url");

        super.onCreate();
    }
} 
```

从 main.xml 中删除视图。

```
public class MyActivity extends Activity
{
    WebView _WebView;
    RelativeLayout _Layout; // Should be declared in main.xml.

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);

        _Layout = (RelativeLayout) findViewById(R.id.rl);
        ViewTreeObserver vto = _Layout.getViewTreeObserver(); 
        vto.addOnGlobalLayoutListener(new MyLayoutListener()); // .layout(0,0,width,height);

        Display display = getWindowManager().getDefaultDisplay();
        MyApp app = (MyApp) this.getApplication();
        _WebView = app._WebView;
        _Layout.addView(_WebView, display.getWidth(), display.getHeight());
    }

    @Override
    protected void onDestroy()
    {
        _Layout.removeView(_WebView);
        super.onDestroy();
    }
}

private class MyLayoutListener implements OnGlobalLayoutListener
{
    public void onGlobalLayout()
    {
        Display display = getWindowManager().getDefaultDisplay();
        _WebView.layout(0, 0, display.getWidth(), display.getHeight());
        //_Layout.getViewTreeObserver().removeGlobalOnLayoutListener(this);
    }
} 
```

# parsing - 来自 twitter user_timeline 的 Json 解析

> ID：10505349
> 
> 赞同：0
> 
> 时间：2012-05-08T19:41:40.897
> 
> 标签：parsing, twitter, json.net

我正在尝试从 twitter user_Stream api 提要中解析 json 内容，并尝试使用 json.net 和 javascriptserializer，但首先需要了解 json 的正确格式。文件内容不断给出一个错误，即存在一些无效的关闭或错过的关闭，我想知道是否有人知道 twitter user_stream 结果中一个帖子/活动的开始和结束标签是什么。在这个文件中，内容开始如下，以“转推”结束：假}]

```
[{"created_at":"Tue May 08 10:30:05 +0000   2012","id":199808381991653377,
   "id_str":"199808381991653377",
   "text":"@waddehawk Sorry for the misinformation earlier, this should be tomorrow after 2pm.",
   "source":"\u003cahref=\"http:\/\/www.awarenessnetworks.com\/home\/\"                              
   "truncated":false,
   "in_reply_to_status_id":199796940358156288,
   "in_reply_to_status_id_str":"199796940358156288",
     "in_reply_to_user_id":333905755,"in_reply_to_user_id_str":"333905755",
   "in_reply_to_screen_name":"waddehawk",
   "user":{"id":95310018,"id_str":"95310018",
   "name":"DBS Bank","screen_name":"dbsbank","location":"Singapore",
   "description":"The DBS official channel, we're here Mon-Fri, 9am-6pm. Otherwise, call us at 18001111111 or              contact us via www.dbs.com\/contact",
   "url":"http:             \/\/www.dbs.com","protected":false,
  "followers_count":1350,"friends_count":173,"listed_count":58,
  "created_at":"Tue Dec 08 00:07:04 +0000            2009","favourites_count":0,"utc_offset":28800,
    "time_zone":"Singapore","geo_enabled":false,
    "verified":false,"statuses_count":306,"lang":"en",
  "contributors_enabled":false,"is_translator":false,
  "profile_background_color":"CC0000",
  "profile_background_image_url":"http:\/\/a0.twimg.com\/profile_background_images\/125391568\/twitter_bg.gif",
  "profile_background_image_url_https":
    "https:\/\/si0.twimg.com\/profile_background_images\/125391568\/twitter_bg.gif",
  "profile_background_tile":false,
  "profile_image_url":"http:\/\/a0.twimg.com\/profile_images           \/1051424405\/dbslogo_e2_4c_r_normal.gif",
  "retweeted":false}] 
```

我一直在尝试的不同代码尝试：

```
 Dim stringSplitter() As String = {"{"}

   ' split the f ile content based on the closing entry tag
         sampleResults = Nothing
    Try
        sampleResults = 
         post.Split(stringSplitter, StringSplitOptions.RemoveEmptyEntries)

        for each entry in sampleResults           

        Dim jreader2 As JsonTextReader = New JsonTextReader(New StringReader(entry))

        entry = "{ " & entry & "}"

        Dim js As New JavaScriptSerializer

        Dim jrobj As Object = js.DeserializeObject(entry)
        For Each crap As Object In CType(jrobj, Array)
            Console.WriteLine(crap("id"))
        Next

     ' Or try

        Dim jobj As JObject = JObject.Parse(entry)
     'Or try

        dim jarr as Jarray = JArray.Parse(jarr)

        Dim skipFlag As Boolean = False

        Dim token As JToken = JObject.Parse(entry)
        statid = token.SelectToken("id")
        searchTerm = token.SelectToken("matching_rules")

        Dim results As List(Of JToken) = jobj.Children().ToList 
```

但我得到的错误是 JsonToken EndArray is not valid for closing jsonType Object

# c# - 是否首先调用母版页？

> ID：10505350
> 
> 赞同：10
> 
> 时间：2012-05-08T19:41:45.067
> 
> 标签：c#, asp.net, .net, master-pages

我认为这是真的，但想提出这个问题。是在 ASP.NET 中首先执行母版页，还是正在检索的页面？

我问是因为我想在母版页中完成一些处理，其结果被加载到一个静态对象中，然后可以由被调用的页面使用（例如用户数据）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-08T19:46:37.000

抱歉只是引用，但我不知道要添加什么：

> 各个 ASP.NET 服务器控件有自己的生命周期，类似于页面生命周期。例如，控件的 Init 和 Load 事件发生在相应的页面事件期间。
> 
> 尽管 Init 和 Load 都在每个控件上递归发生，但它们以相反的顺序发生。每个子控件的 Init 事件（以及 Unload 事件）发生在为其容器引发相应事件之前（自下而上）。但是，容器的 Load 事件发生在其子控件的 Load 事件之前（自上而下）。 **母版页的行为类似于页面上的子控件：母版页 Init 事件发生在页面 Init 和 Load 事件之前，而母版页 Load 事件发生在页面 Init 和 Load 事件之后。**

[http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

![在此处输入图像描述](../Images/0a9b556a27e0aef729da5a0dd2d3310b.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-08T19:51:00.100

## **`Execution Priority`**

> 1.  内容页
> 2.  母版页
> 3.  用户控制

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-08T19:44:04.733

大多数页面事件将在母版页上的相应事件之前被调用（本质上，母版页被认为是它链接到的页面的*一部分*- 它是一个用户控件）。

有关详细信息，请参阅ASP.Net 2.0 - 母版页： OdeToCode 上的[提示、技巧和陷阱。](http://odetocode.com/articles/450.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T19:47:01.597

您可以查看 .net 文档，其中说明了何时以及以何种顺序调用事件

看看[这个](http://weblogs.asp.net/ricardoperes/archive/2009/03/08/asp-net-page-events-lifecycle.aspx)，[这个](http://odetocode.com/articles/450.aspx)和[这个](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

# javascript - How to hide all elements of class?

> ID：10505354
> 
> 赞同：0
> 
> 时间：2012-05-08T19:42:15.557
> 
> 标签：javascript, jquery

I found this function:

```
document.getElementsByClassName = function(c){
    for(var i=0,a=[],o;o=document.body.getElementsByTagName('*')[i++];){
        if(RegExp('\\b'+c+'\\b','gi').test(o.className)){
            a.push(o);
        }
    }

    return a;
} 
```

How can I hide all elements by class?

I tried:

```
var array = document.getElementsByClassName("hide");

for(var i = 0; i < array.length; i++)
{
    $(array[i]).hide();
} 
```

But I got error:

```
Could not convert JavaScript argument arg 0 [nsIDOMWindow.getComputedStyle] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T19:45:12.067

jQuery allows CSS selectors to be used, doing away with the need for hand-built loops and regular expressions. To hide an element with class `fooey`, just do

```
$('.fooey').hide(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:45:27.670

If you're using vanilla JavaScript, then:

```
var array = document.getElementsByClassName("hide");

for(var i = 0; i < array.length; i++)
{
    array[i].style.display = 'none';
    array[i].onclick = function(){
        // do stuff
    };
    /* or:
    array[i].addEventListener('click',functionToCall);
    */
} 
```

But, given that you're using jQuery, I don't understand why you're complicating things for yourself, just use:

```
$('.hide').hide(); 
```

Further to the above, given your comment:

> Because I must add event "click" for each element.

Simply use:

```
$(elementSelector).click(
    function(){
        // do stuff
    }); 
```

Assuming you want to hide, and bind a click-event to, the same elements:

```
$('.hide').hide().click(
    function(){
        // do stuff
    }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T19:45:36.827

What you get from `getElementsByClassName` is NOT an array, but a `NodeList`, hence the error when trying to loop.

However, you can still loop over a NodeList using the following:

```
var nodeList = document.getElementsByClassName("hide");
for(var x in nodeList){} 
```

# java - 引用自己的 wsdl url

> ID：10505358
> 
> 赞同：3
> 
> 时间：2012-05-08T19:42:40.490
> 
> 标签：java, web-services, wsdl, glassfish, jax-ws

我正在构建一个 Web 服务，该服务应该通过将其 wsdl URL 发送到该服务器来在另一台服务器上注册。

我在 Netbeans 中构建了一个非常基本的 Web 服务，

```
@WebService
public class RegisterTest{
    @WebMethod(operationName = "emphasize")
    public String emphasize(@WebParam(name = "inputStr") String input){
        return input + "!!!";
    }
} 
```

Netbeans 会自动将我定向到 localhost:8080/RegisterTest/RegisterTestService?Tester，当然，wsdl 可以在 localhost:8080/RegisterTest/RegisterTestService?wsdl 中找到。

我将如何以编程方式获取此 URL？

编辑：我注意到似乎存储此 URL 的唯一地方是 glassfish 服务器本身。上下文根似乎只能在 glassfish/domain//config/domain.xml 中找到。有没有访问 glassfish 服务器 API 的好方法？我可以通过 UI 中的应用程序 > serviceName > View Endpoint 轻松获取端点地址，有没有一种编程方式可以做到这一点？我尝试过查看 asadmin 命令，但似乎也找不到任何可以获取上下文根或端点 URL 的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-04T05:22:17.867

未经测试，但应该非常接近您正在寻找的内容：

```
@WebService
public class RegisterTest
{
    @Resource
    private WebServiceContext context;

    @WebMethod(operationName = "emphasize")
    public String emphasize(@WebParam(name = "inputStr") String input)
    {
        return input + "!!!";
    }

    @WebMethod(operationName = "getWsdlUrl")
    public String getWsdlUrl()
    {
        final ServletContext sContext = (ServletContext)
            this.context.getMessageContext().get(MessageContext.SERVLET_CONTEXT);
        final HttpServletRequest req = (HttpServletRequest)
            this.context.getMessageContext().get(MessageContext.SERVLET_REQUEST);
        final StringBuilder sb = new StringBuilder();

        sb.append(req.isSecure() ? "https" : "http");
        sb.append("://");
        sb.append(req.getLocalName());

        if ((req.isSecure() && req.getLocalPort() != 443) || 
            (!req.isSecure() && req.getLocalPort() != 80))
        {
            sb.append(":");
            sb.append(req.getLocalPort());          
        }

        sb.append(sContext.getContextPath());
        sb.append(RegisterTest.class.getSimpleName());
        sb.append("Service?wsdl");

        return sb.toString();
    }
} 
```

# javascript - 使用Javascript的HTML中两个字段之间的区别

> ID：10505359
> 
> 赞同：0
> 
> 时间：2012-05-08T19:42:43.253
> 
> 标签：javascript, html, textfield

我已经在网上搜索（我所期望的）这个问题的基本答案。

我有一个 HTML 表单，我正在为一个特定的系统组合在一起。我有两个文本字段，用户将在其中输入两个温度。我想要第三个文本字段，onBlur 将产生这两个温度之间的差异。我有一个脚本，我认为它正朝着正确的方向前进，但不起作用。由于我将使用它的系统，我不能在 HTML 中包含标签。

我的脚本：

```
 <script language="javascript" type="text/javascript">
    <!--
    function calculate_temp(TempIn, TempOut) {
    var TempIn = parseInt(document.getElementById('TempIn').value);
    var TempOut   = parseInt(document.getElementById('TempOut').value); 
    var Delta = TempIn - TempOut;
    document.getElementById('Delta').innerHTML = Delta
    }
    // -->
    </script> 
```

我的 HTML：

```
 <body> 
    <div> 
    <p><label for="TempIn">TempIn: </label><input type="text" name="TempIn" id="TempIn" /></p>
    <p><label for="TempOut">TempOut: </label><input type="text" name="TempOut" id="TempOut" /></p>
    <p><label for="Delta">Delta: </label> <input type="text" name="Delta" id="Delta" onBlur="calculate_temp(this.form.TempIn.value, this.form.TempOut.value)"/></p>
    </div> 
    </body> 
```

谁能解释我在这里做错了什么？同样，我希望用户输入 TempIn，点击选项卡，输入 TempOut，点击选项卡，然后自动计算 Delta。

就像我说的，我在网上找到的每一种资源都以稍微不同的方式实现它，但如果我使用任何一种方法，我似乎都无法让它发挥作用。

任何帮助是极大的赞赏。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:48:13.393

An`input`没有`innerHTML`，您应该使用 value。

```
document.getElementById('Delta').value = Delta 
```

此外，**始终**将第二个参数传递给`parseInt`基数。否则它经常会猜错基数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T20:00:01.330

1.  删除脚本中的注释： 。
2.  XHTML 中的所有标记和属性名称必须小写（可选）。即：模糊。
3.  对于您预期的行为，我建议使用`onfocus`事件，它更有意义。
4.  如果您可以通过脚本访问元素，则无需向 calculate_temp() 函数传递任何内容。
5.  使用属性更改`Delta`输入的值。`value`

结果：

```
<head>

<title>Untitled 1</title>

    <script language="javascript" type="text/javascript">
        function calculate_temp(TempIn, TempOut) {
            var TempIn = parseInt(document.getElementById('TempIn').value);
            var TempOut   = parseInt(document.getElementById('TempOut').value); 
            var Delta = TempIn - TempOut;
            document.getElementById('Delta').value = Delta
        }   
    </script>

</head>

<body>

    <div> 
    <p><label for="TempIn">TempIn: </label><input type="text" name="TempIn" id="TempIn" /></p>
    <p><label for="TempOut">TempOut: </label><input type="text" name="TempOut" id="TempOut" /></p>
    <p><label for="Delta">Delta: </label> <input type="text" name="Delta" id="Delta" onfocus="calculate_temp()"/></p>
    </div> 

</body> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T20:01:02.500

我会把我的帽子扔进擂台......

html:

```
 <div> 
        <p><label for="TempIn">TempIn: </label><input type="text" name="TempIn" id="TempIn"/></p>
        <p><label for="TempOut">TempOut: </label><input type="text" name="TempOut" id="TempOut" /></p>
        <p><label for="Delta">Delta: </label> <input type="text" name="Delta" id="Delta"/></p>
    </div> ​​​​ 
```

js：

```
/* store elements */
var TempIn = document.getElementById('TempIn'),
    TempOut = document.getElementById('TempOut'),
    Delta = document.getElementById('Delta');

function calculate_temp() {
    Delta.value = parseInt(TempIn.value,10) - parseInt(TempOut.value,10);
}

/* unobtrusive onblur */
TempIn.onblur = calculate_temp;
TempOut.onblur = calculate_temp;
Delta.onblur = calculate_temp; 
```

这是一个小提琴：http: [//jsfiddle.net/JKirchartz/TbHW3/](http://jsfiddle.net/JKirchartz/TbHW3/)

**编辑**可能应该提到，这个 JS 应该在你的`</body>`标签正上方，或者在 dom 加载时运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T19:51:07.027

当相关控件失去焦点时触发该事件，因此只有当用户将焦点从输入`OnBlur`移开时才能调用您的代码。`Delta`您希望在`TempOut`输入失去焦点时调用它，因此应该设置事件处理：

```
<p><label for="TempIn">TempIn: </label><input type="text" name="TempIn" id="TempIn" /></p>
<p><label for="TempOut">TempOut: </label><input type="text" name="TempOut" id="TempOut" onBlur="calculate_temp(this.form.TempIn.value, this.form.TempOut.value)"/></p>
<p><label for="Delta">Delta: </label> <input type="text" name="Delta" id="Delta" /></p> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T19:53:55.833

试试这个

脚本：

```
<script language="javascript" type="text/javascript">
<!--
function calculate_temp() {
var TempIn = parseInt(document.getElementById('TempIn').value);
var TempOut   = parseInt(document.getElementById('TempOut').value); 
var Delta = TempIn - TempOut;
document.getElementById('Delta').value = Delta;
}
// -->
</script> 
```

html:

```
<body> 
<div> 
<p><label for="TempIn">TempIn: </label><input type="text" name="TempIn" id="TempIn" /></p>
<p><label for="TempOut">TempOut: </label><input type="text" name="TempOut" id="TempOut" /></p>
<p><label for="Delta">Delta: </label> <input type="text" name="Delta" id="Delta" onBlur="calculate_temp()"/></p>
</div> 
</body> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-08T19:54:39.733

```
 <div> 
        <p><label for="TempIn">TempIn: </label><input type="text" name="TempIn" id="TempIn" onBlur="calculate_temp(document.getElementById('TempIn').value, document.getElementById('TempOut').value);"/></p>
        <p><label for="TempOut">TempOut: </label><input type="text" name="TempOut" id="TempOut" onBlur="calculate_temp(document.getElementById('TempIn').value, document.getElementById('TempOut').value);"/></p>
        <p><label for="Delta">Delta: </label> <input type="text" name="Delta" id="Delta" /></p>
    </div>
    <script language="javascript" type="text/javascript">
        <!--
        function calculate_temp(TempIn, TempOut) {

        var Delta = TempIn - TempOut;
        document.getElementById('Delta').value = Delta
        }
    // -->
    </script> 
```

# django - Django中各种权限级别的区别

> ID：10505361
> 
> 赞同：0
> 
> 时间：2012-05-08T19:43:02.643
> 
> 标签：django, permissions, system, authentication

据我所知，在 django 中可以使用 3 个权限级别（无论是通过 django 本身还是通过使用 3rd 方应用程序）。1) 基于模型的权限 2) 基于对象的权限 3) 基于行的权限

如果您能告诉我这 3 个权限系统级别之间的确切区别，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T21:35:40.220

不知道你从哪里得到这些信息，但它甚至不是完全正确的。Django 在技术上没有*任何*权限系统。contrib 应用程序添加了一个“权限”系统，`auth`但它是可选的，可以完全用其他东西代替。该`admin`应用程序（也是一个 contrib 包，并且是可选的）使用`auth`，所以如果你在谈论 Django 管理员，或者在`auth`你自己的应用程序中使用这个包，那么我们可以谈谈。

在`auth`中，你有`User`s、`Group`s 和`Permission`s。`User`s 有“超级用户”或“常规”用户风格，`Permission`当您运行 syncdb（`auth`包含在 中`INSTALLED_APPS`）时，项目中的每个模型都会自动获得三个 s：can_add、can_change 和 can_delete。`User`s 标记为“超级用户”( `is_superuser == True`)，可以对任何模型执行任何操作。其他用户需要`Permission`明确分配给他们。此外，`Group`s 可能有`Permission`s 分配给它们，然后，任何`User`分配给它的人都会`Group`继承这些权限。

因此，用户可能无法对任何模型执行任何操作，无法对某些或所有模型进行添加、更改或删除功能的某种组合，或者无法完全访问对任何模型执行任何操作。在“实例”的意义上，没有“基于对象”权限的概念。您可以编辑模型的每个实例，也可以不编辑。也没有“基于行”权限的概念。无论如何，数据库表中的一行只是模型的一个实例。

# javascript - JS（jQuery）：随机触发单击 2 个表格行

> ID：10505364
> 
> 赞同：2
> 
> 时间：2012-05-08T19:43:32.563
> 
> 标签：javascript, jquery, random, triggers

鉴于此 HTML：

```
<div id="TABLE1" class="tabs">
    <table>
        <tbody datasrc="Music">
            <tr id="randomid">lorem</tr>
            <tr id="foo">lorem</tr>
            <tr id="abcde">lorem</tr>
            <tr id="fghijk">lorem</tr>
            <tr id="lmnop">lorem</tr>
            <tr id="qwerty">lorem</tr>
        </tbody>
    </table>
</div>
<div id="TABLE_2" class="tabs">
    <table>
        <tbody datasrc="Music">
            <tr id="random5">lorem</tr>
            <tr id="farhaf">lorem</tr>
            <tr id="haerf">lorem</tr>
            <tr id="hagasdg">lorem</tr>
            <tr id="hrfafh">lorem</tr>
            <tr id="qwerty">lorem</tr>
        </tbody>
    </table>
</div>
<div id="LASTTABLE" class="tabs">
    <table>
        <tbody datasrc="Music">
            <tr id="rtefdgag">lorem</tr>
            <tr id="wrtjfd">lorem</tr>
            <tr id="reaht">lorem</tr>
            <tr id="aggag">lorem</tr>
            <tr id="rthhre">lorem</tr>
            <tr id="argarg">lorem</tr>
        </tbody>
    </table>
</div> 
```

**我试图`<tr>`从每个表中随机触发 2 。**我什至不能这样做。

目前对于我的测试，我使用：

```
$("#button").on('click', function () {
    $('#randomid').trigger('click')
}) 
```

但这个触发器只是第一个表的第一行。

那我怎么能：

1.  当我按下#按钮时，
2.  从每个表中获取 2 个随机行，触发器
3.  每 10 毫秒点击每一行（所以他们有一个顺序）。

关于应用程序：

这是一个音乐播放器网站。每张桌子都有不同风格的音乐。摇滚，另类，爵士等。有一个按钮'随机选择音乐'）。该按钮将触发每个表中的 2 个随机 tr，因此您最终将 2 首爵士歌曲、2 首摇滚歌曲等添加到播放列表中。该表看起来像这样：[http](http://dribbble.com/system/users/31916/screenshots/167289/k-dribble.png?1309036379) ://dribbble.com/system/users/31916/screenshots/167289/k-dribble.png?1309036379但这些复选框不是实际的复选框，而是在点击时改变位置以查看和感觉的图像比复选框更好，并且仍然与复选框相同。

用户可以触发“复选框”或通过单击行上的任意位置（逻辑）来选择歌曲，因此后端的开发方式是捕获一行中任意位置的点击，而不是特别是复选框（因此我没有选择触发那些）。我认为没有更好的解决方案可以从每个表中随机触发 2 行单击。

支持 IE8+。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:09:49.477

请参阅下面的我的版本，

[**演示**](http://jsfiddle.net/skram/kzG3A/3/)

**注意：**下面的代码有一些演示代码和冗余变量，您可以清理它们，但我将其留在那里以使代码看起来清晰且不言自明。

```
$(function() {
    var $tables = $('table'); //gets the tree tables

    var mQ = []; //music queue
    var timer = null;
    $('button').click(function () {
        $('#result').html(''); //demo code
        var t = 0, $tr;
        var t1 = [];
        $tables.each(function () {
            $tr = $(this).find('tr');

            t1[0] = Math.floor(Math.random()*$tr.length);
            t1[1] = Math.floor(Math.random()*$tr.length);

            while (t1[0] == t1[1]) { //To make sure not same row is selected
                t1[1] = Math.floor(Math.random()*$tr.length);
            }

            mQ.push($tr.get(t1[0]));
            mQ.push($tr.get(t1[1]));
        });

        timer = setInterval(function () {//Create timer to trigger click every 10ms
            if (mQ.length == 0) {
                clearInterval(timer);
                return false;
            }
            $(mQ.shift()).click().addClass('selected');            
        }, 10);
    });

    $('tr').click(function () {
        //do your magic
        $('#result').append(this.id + '<br />');
    });
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T20:22:25.883

我首先建议您以不同的方式执行此操作，但如果您准备触发点击事件，这是一般的想法。

```
 $(".tab").each(function(){
        var count = $(this).children(tr).length;    
        var r1 = Math.floor(Math.random()*count); //Get a random number less than the total count of rows
        $(this).children('tr').eq(r1).trigger('click');//retrieve the nth (r1) item in the list and fire it's trigger event

    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T20:07:15.670

> 也更新了 Fiddle 上的新代码

也许更像这样？...

```
$(function() {
    $("button").click(function(e) {
        $(".selected").removeClass("selected");

        $("table").each(function(i) {
            var irand = {
                a: Math.floor((Math.random()*($(this).find("tr").length)-1)+1),
                b: undefined
            };

            while (irand.b == irand.a || irand.b == undefined) {
                irand.b = Math.floor((Math.random()*($(this).find("tr").length)-1)+1);
            };

            console.log($(this).find("tr").filter(function(i) { return i == irand.a || i == irand.b }).addClass("selected"));
        });
    });
});​ 
```

# [在这里查看工作小提琴...](http://jsfiddle.net/SpYk3/BWfwt/)

# python - 多个python文件中的相对导入

> ID：10505365
> 
> 赞同：-1
> 
> 时间：2012-05-08T19:43:33.937
> 
> 标签：python, django

我有以下目录结构：

目录名称是`test_app`

```
|-- __init__.py
|-- manage.py
|-- models.py
|-- views.py 
```

我有一个非常基本的问题要问，我将以下值放入我的`__init__.py`

```
alpha = "123"
beta = "546" 
```

我如何在模型、视图和管理中获得 alpha 和 beta 的值？我尝试了以下方法：

```
from . import alpha

from test_app import alpha 
```

他们两个都没有工作，我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T20:00:49.450

`__init__.py`通常为空，表示您的目录中的文件，在这种情况下 test_app 可以导入。您可以将您的值放在另一个 .py 文件中（例如：constants.py）并执行以下操作：

```
|-- __init__.py
|-- manage.py
|-- models.py
|-- views.py
|-- constants.py 
```

然后导入你的常量：

```
from test_app import constants 
```

constants.py 的内容是

```
alpha = "123"
beta = "546" 
```

然后你就可以使用你存储在常量中的任何值

```
print(constants.alpha)
print(constants.beta) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:50:15.530

我不确定我是否会将常量或我需要包含的内容放入 中`__init__.py`，但这是：

```
from __init__ import things 
```

将适用于导入`things`定义在`__init__.py`.

我不这样做的原因是，python 包通常`__init__.py`用于控制通过以下方式导出的内容。`from package.name import *`在这种情况下，您的常量也将被导出——如果这是您想要的，这很好，但如果不是，那就不好了。

# php - 我如何结合两个语句将是一个查询？

> ID：10505367
> 
> 赞同：0
> 
> 时间：2012-05-08T19:43:57.837
> 
> 标签：php, mysql

这里有一个示例查询以获取两种类型的图标..

```
$fetchIcon = array();
$queryIcon = $db->query("SELECT * FROM icon_code WHERE icon_type = 'icon'");
while ($fIcon = $db->fetch_assoc($queryIcon)) {
    $fetchIcon[] = $fIcon;
}

$fetchOther = array();
$queryOther = $db->query("SELECT * FROM icon_code WHERE icon_type = 'other'");
while ($fOther = $db->fetch_assoc($queryOther)) {
    $fetchOther[] = $fOther;
} 
```

然后我用来`foreach`在同一页面上显示输出。

```
foreach ($fetchIcon as $Icon) {
  echo $Icon['IconName']; // select option for Icon
}

foreach ($fetchOther as $Other) {
  echo $Other['IconName']; // select option for other icon
} 
```

**问题：** 如何将两条语句结合起来进行一次查询？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T19:44:48.117

```
SELECT * FROM icon_code 
WHERE icon_type = 'icon' 
or icon_type = 'other' 
ORDER BY icon_type 
```

或者

```
SELECT * FROM icon_code 
WHERE icon_type in ('icon', 'other')
ORDER BY icon_type 
```

`order by`按类型获取订单是可选的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T19:46:55.283

```
SELECT *
FROM icon_code
WHERE icon_type IN ('icon', 'other') 
```

进而

```
$fetchIcon = array();
$fetchOther = array();

while($row = mysql_fetch_assoc($result)) {
    switch($row['icon_type']) {
       case 'icon':
           $fetchIcon[] = $row;
           break;
       case 'other':
       default:
           $fetchOther[] = $row;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T19:46:24.607

我建议使用[IN](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#function_in)函数：

```
$queryOther = $db->query("SELECT * FROM icon_code WHERE icon_type IN ('other', 'icon'"); 
```

# python - Python：安装问题后导入 Numpy

> ID：10505368
> 
> 赞同：1
> 
> 时间：2012-05-08T19:44:00.713
> 
> 标签：python, numpy

所以我使用以下方法安装了 numpy：

```
python setup.py build
python setup.py install --prefix=/bla/somefolder/ 
```

现在一切都很顺利，但是当我尝试导入 numpy 时它不起作用。所以我进入这个文件夹，我根本找不到 numpy.py。我尝试在我的 .bashrc 文件中添加到 PYTHONENV 的路径，但这没有用。我迷失了想法。

任何帮助将不胜感激。

# python - scipy.optimize.fsolve 中的输入/输出错误

> ID：10505378
> 
> 赞同：1
> 
> 时间：2012-05-08T19:44:30.813
> 
> 标签：python, numpy, scipy

当我在 scipy 中使用 root-finder 时，我似乎遇到了错误。我想知道是否有人能指出我做错了什么。
我正在寻找其根源的函数只是一个简单的例子，并不是特别重要。

如果我使用 scipy 0.9.0 运行此代码：

```
import numpy as np
from scipy.optimize import fsolve

tmpFunc = lambda xIn: (xIn[0]-4)**2 + (xIn[1]-5)**2 + (xIn[2]-7)**3

x0 = [3,4,5]
xFinal = fsolve(tmpFunc, x0 )

print xFinal 
```

我收到以下错误消息：

```
Traceback (most recent call last):
  File "tmpStack.py", line 7, in <module>
    xFinal = fsolve(tmpFunc, x0 )
  File "/usr/lib/python2.7/dist-packages/scipy/optimize/minpack.py", line 115, in fsolve
    _check_func('fsolve', 'func', func, x0, args, n, (n,))
  File "/usr/lib/python2.7/dist-packages/scipy/optimize/minpack.py", line 26, in _check_func
    raise TypeError(msg)
TypeError: fsolve: there is a mismatch between the input and output shape of the 'func' argument '<lambda>'. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:02:55.923

好吧，看起来我试图错误地使用这个例程。这个例程需要相同数量的方程和变量，而我给它的一个方程有三个变量。因此，如果要最小化的函数的输入是 3-D 数组，则输出应该是 3-D 数组。此代码有效：

```
import numpy as np
from scipy.optimize import fsolve

tmpFunc = lambda xIn: np.array( [(xIn[0]-4)**2 + xIn[1], (xIn[1]-5)**2 - xIn[2]) \
, (xIn[2]-7)**3 + xIn[0] ] )

x0 = [3,4,5]
xFinal = fsolve(tmpFunc, x0 )

print xFinal 
```

这表示同时求解三个方程。

# azure - Azure 辅助角色无法正常工作

> ID：10505381
> 
> 赞同：1
> 
> 时间：2012-05-08T19:44:36.123
> 
> 标签：azure, azure-worker-roles

我有一个不在云环境中工作的工人角色。

当我在本地运行它时，它运行良好，但是，当我将它部署到 Azure 时，我遇到了一些麻烦。部署本身是无缝进行的，在 VM 启动后，我的应用程序无法运行。事件日志上没有任何内容，而且，即使在我设置应用程序以将所有跟踪消息刷新到 Azure 表之后，那里也没有写入任何内容。

如何检查我的应用程序是否真的在 VM 上运行？为什么我的应用程序无法在本地运行，因为它在本地运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:32:16.517

最好的方法是启用 RDP 并远程进入机器。然后，您可以查看正在运行的进程并确保事情按您的预期运行。如果运行失败，事件日志中没有任何内容，这很奇怪。门户是否将部署显示为就绪？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T20:56:03.740

是否尝试在您的 webrole 上实施诊断？这是查找代码中任何错误的最佳方法。另一种解决方案是在启动期间安装 sysinternals。Patriek van Dorp 制作了一个 nu get 包，它添加了 sysinternal 套件作为您的云项目的插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-23T09:30:15.277

也许为时已晚，但我有类似的问题。当我在本地运行它时，它正在运行。部署后没有运行任何东西。问题是，我部署到网站，那里的工作人员不可用。你应该部署到 CloudService（有可用两个角色）或制作 Sheduler，它将在您的页面上请求您需要的处理工作。当然，在您的自定义 intreval 中。

顺便说一句，对不起我的英语......

问候

# ruby-on-rails - 在 CRUD 应用程序中查看 - 语法错误，意外的关键字_确保，期望 $end

> ID：10505382
> 
> 赞同：0
> 
> 时间：2012-05-08T19:44:37.163
> 
> 标签：ruby-on-rails, view, syntax-error, crud

在我的联系人列表 CRUD 应用程序中，当我键入以下 URL 时，所有联系人都会正确显示：localhost/contact

但是，我希望每个联系人有两个选项 - 更新信息或删除记录。因此，一旦我点击联系人，比如说“Chetan”，我想进入一个带有两个选项的“showmain”页面——更新（将我链接到更新页面）和删除（将我链接到删除页面）。

我的控制器如下：-

```
class ContactController < ApplicationController

  def index
    @contacts=Contact.find(:all)

      respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @contacts }
    end
  end

  def show
    @contact=Contact.find(params[:id])
  end

  def del
    @contact=Contact.find(params[:id])
  end

  def new
    @contact=Contact.new
  end

  def create
     @contact=Contact.new(params[:contact])
    if @contact.save!
      redirect_to :action => "index"
    else
      render :action => "new"
    end
  end

  def showmain

      respond_to do |format|
      format.html # index.html.erb
      format.json 
  #  @contact=Contact.new(params[:contact])
  end

  def update
    @contact=Contact.find(params[:id])
    @contact.attributes= params[:contact]
    @contact.save!
    redirect_to :action => "index" 
  end

  def delete
    @contact=Contact.find(params[:id])
    @contact.destroy
    redirect_to :action => "index"
  end
  end
  end 
```

我的 showmain.html.erb 页面出现语法错误（showmain.html.erb:14: syntax error, unexpected keyword_ensure, expecting $end）如下：-

```
<h1>Do you want to Update or Delete the Attributes? </h1>

<ul>
    <li>
        <%= link_to "Update" ,:action=>'show',:id => @contact -%>
    </li>

    <li>
        <%= link_to "Delete" ,:action=>'del',:id => @contact -%>
    </li>   
</ul>
<% end %>

<p>
    <%= link_to "Back", {:action => 'index'} -%>
</p> 
```

需要一些帮助来消除错误..

我的 show.html.erb 如下：-

```
<h1>View/Edit Contact</h1>

 <% link_to "Update" , contact_path(@contact) do |f| -%

  <%= f.label :first_name %>:
  <%= f.text_field :first_name %><br />

  <%= f.label :last_name %>:
  <%= f.text_field :last_name %><br />

  <%= f.label :address %>:
  <%= f.text_field :address %><br />

  <%= f.label :city %>:
  <%= f.text_field :city %><br />

  <%= f.label :state %>:
  <%= f.text_field :state %><br />

  <%= f.label :country %>:
  <%= f.text_field :country %><br />

  <%= f.label :phone %>:
  <%= f.text_field :phone %><br />

  <%= f.label :email %>:
  <%= f.text_field :email %><br />

  <%= f.submit "Update" %>

<% end %>

<p>
    <%= link_to 'Back', {:action => 'index'} %>
</p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:56:03.863

```
def showmain

  respond_to do |format|
      format.html # index.html.erb
      format.json 
      #  @contact=Contact.new(params[:contact])
  end #Close respond_to
end # Close the showmain 
```

# javascript - Javascript CRM 转换错误

> ID：10505383
> 
> 赞同：0
> 
> 时间：2012-05-08T19:44:46.517
> 
> 标签：javascript, jquery

我在企业房地产 CRM 工作。允许使用 Javascript，但不支持。当我插入这个：

```
<script>

function tick(){
    $('#ticker li:first').slideUp( function () { $(this).appendTo($('#ticker')).slideDown(); });
}
setInterval(function(){ tick () }, 5000); 
```

代码转换为：

```
<script type="text/javascript">// <![CDATA[
    function tick(){
        $('#ticker li:first').slideUp( function () { $(this).appendTo($('#ticker')).slideDown(); });
    }
    setInterval(function(){ tick () }, 5000);
// ]]></script> 
```

我该如何解决这个问题？提前感谢您帮助“新手”！

亚历克斯·T。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:09:46.503

不确定服务器端功能在做什么，但这实际上是明智的，没有什么可担心的。

`<script>`和`</script>`标签的修改是

1.  明确指定语言
2.  防止非javascript浏览器将（至少大部分）javascript渲染到页面中。

# sql-server - 保持 Sql server 表从 Access 表更新

> ID：10505385
> 
> 赞同：1
> 
> 时间：2012-05-08T19:44:51.003
> 
> 标签：sql-server, ms-access

我正在尝试从访问表中更新 Sql 服务器中的表。每当在访问表中进行更改时，我希望该更改反映在 sql server 表中。这两个表可以相同。我已经创建了一个从访问 sql server 的 ODBC 连接，并且可以将表导出到 sql server；我只是不知道必须做什么来保持该表的更新。任何建议表示赞赏。

这应该在 Access 中还是在 sql server 中实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:00:48.973

您可以将 SQL Server 表作为链接表添加到 Access 数据库吗？（[关于如何添加链接表的有用文章](http://www.mssqltips.com/sqlservertip/1480/configure-microsoft-access-linked-tables-with-a-sql-server-database/)）？这样一来，Access 数据库的用户（希望不会太多！）实际上是在直接编辑 SQL Server 表。如果这不是可取的，那么如何在 SQL Server 数据库中创建另一个表，并将其作为链接表添加到 Access 数据库中。然后，添加一个触发器，以便在对该表进行插入/更新/删除时，在您的主表上执行相同的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:53:24.590

Access~~没有我知道的在更新/插入/删除行时发生的“事件”。~~ 正如 JeffO 指出的那样，[数据宏](http://office.microsoft.com/en-us/access-help/create-a-data-macro-HA010378170.aspx)可以做你想做的事。

您还可以定期同步它们。有几种技术可以定期执行同步任务（SQL Server 代理、Windows 服务、Windows 调度程序、应用程序中的计时器等），但如果两个表都可以修改，仍然必须处理同步存在的所有问题，最糟糕的是数据冲突解决。没有简单的解决方案。

也许如果您解释了您在 SQL Server 和 Access 中使用同步数据解决的问题，那么有人可能会为您指出没有这些问题的解决方案的方向。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T20:04:03.890

我认为在 SQL Server 中设置[链接服务器](http://msdn.microsoft.com/en-us/library/ms188279.aspx)可能比从 Access 自动导出数据更容易实现。

根据[MSDN 页面](http://msdn.microsoft.com/en-us/library/ms188279.aspx)，

> 许多类型的 OLE DB 数据源都可以配置为链接服务器，包括**Microsoft Access**和 Excel。

Server-on-SQL-2005-Server/

# xamarin.ios - Section.HeaderView 在 Monotouch Dialog 中自动调整大小

> ID：10505386
> 
> 赞同：4
> 
> 时间：2012-05-08T19:44:51.287
> 
> 标签：xamarin.ios, monotouch.dialog

我正在使用 Monotouch.Dialog，并且我已经对类 Section 进行了子类化以实现自定义 HeaderView。问题是标题视图会自动调整大小，这是我正在使用的代码：

```
    公共类 MySection : 部分
    {
        公共我的部分（）
        {
            UIView v = new UIView(new RectangleF(0,0,30,30));
            v.BackgroundColor = UIColor.Red;
            this.HeaderView = v;
        }
    }
```

我附上了屏幕截图：http:
[//imageshack.us/photo/my-images/864/capturdcran20120508212.png](http://imageshack.us/photo/my-images/864/capturedcran20120508212.png)

编辑

好的，我已经找到了解决这个问题的方法

诀窍是添加一个包含真实 HeaderView 的 View 并将 AutosizesSubviews 属性设置为 false。然后只需将视图添加到最新的：

```
 public class MySection : Section
{
    public MySection ()
    {
        UIView v0 = new UIView(new RectangleF(0,0,50, 60));
        v0.AutosizesSubviews = false;
        UIView v = new UIView(new RectangleF(0,0,30,30));
        v.BackgroundColor = UIColor.Red;
        v0.AddSubview(v);
        this.HeaderView = v0;
    }
} 
```

# vb6 - 如何获取字体描述符 - TTF 字体的 CapHeight、Ascent、Descent、Flags、ItalicAngle、Stemv

> ID：10505389
> 
> 赞同：3
> 
> 时间：2012-05-08T19:45:04.560
> 
> 标签：vb6, pdf-generation, truetype, embedded-fonts, ps

我正在尝试创建自己的工具来创建 pdf 文件。一切都很顺利，我唯一想念的是字体描述符。请让我知道 afm/pfa/pfb 的 capheight、ascent、descent、glag、斜体角度的正确值或任何可用于生成相同值的工具

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:20:09.440

Fontographer 将显示这些值。只是收集统计数据有点贵。我的副本很旧，早在 Macromedia 拥有它的时候。FontLab 现在可以了。见[http://www.fontlab.com/font-editor/fontographer/](http://www.fontlab.com/font-editor/fontographer/)

# javascript - 带有 REST API 和 ACL 的云数据库

> ID：10505391
> 
> 赞同：4
> 
> 时间：2012-05-08T19:45:13.763
> 
> 标签：javascript, database, rest

有没有数据库，可以满足以下要求

*   托管在云端
*   REST API
*   支持具有不同访问权限的不同 API 密钥（尤其是只读）
*   免费定价计划

我为 Javascript 应用程序寻找数据库，没有我自己的中间层作为数据库和客户端应用程序之间的提供者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-17T08:54:37.163

you have a lot of choices but still you can use free license for development

you can try those

[https://parse.com](https://parse.com) (its very good one and they have a lot of libraries almost for programming language)

"[http://couchdb.apache.org](http://couchdb.apache.org)" (this is very good choice if you want to build local DB with JSON response )

# c++ - 运行时 C++“未定义符号”异常

> ID：10505400
> 
> 赞同：-1
> 
> 时间：2012-05-08T19:45:42.763
> 
> 标签：c++, compiler-construction, linker, undefined-symbol

对于实际正在执行的方法，我得到一个未定义的符号异常。这对我来说毫无意义。以下是日志示例：

/src/CustomerReturnProcessUtils/labelPrintUtils/CreturnLabelPrinter.cpp:402 (null)(): CreturnLabelPrinter: [InitializeZebraPrint] 成功连接到套接字 /apollo/env/CustomerReturnUIServiceUS/bin/CustomerReturnUIService: 符号查找错误: /apollo/env/CustomerReturnUIServiceUS/bin /CustomerReturnUIService：未定义符号：_ZN19CreturnLabelPrinter10PrintLabelESSSsiiiSsbSs

“连接到套接字的成功”由 CreturnLabelPrinter::PrintLabel 内部的方法调用记录...我怎样才能获得未定义的符号异常？这是一种非静态方法。它的代码不相关（无论如何我都不能在这里发布）......我只是想知道这可能发生在什么条件下。在这些模块的编译和链接过程中，我没有看到任何问题。调用方法与“未定义符号”位于不同的库中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:54:37.660

当我有 2 个版本的库并且我链接到错误的版本时，这发生在我身上。c++filt 还显示：

```
$ c++filt __ZN19CreturnLabelPrinter10PrintLabelESsSsiiiSsbSs
CreturnLabelPrinter::PrintLabel(std::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::basic_string<char, std::char_traits<char>, std::allocator<char> >, int, int, int, std::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, std::basic_string<char, std::char_traits<char>, std::allocator<char> >) 
```

这有很多参数，你检查了吗？

# java - JBOSS：EJB 如何修复 java.lang.reflect.UndeclaredThrowableException？

> ID：10505401
> 
> 赞同：0
> 
> 时间：2012-05-08T19:45:44.920
> 
> 标签：java, jboss, ejb, ejb-3.0, ejb-3.1

在 bean 中，我尝试使用此方法列出所有文章

```
public List<Article> listerLesArticles() {
    javax.persistence.Query req = manager.createQuery("select * from Article");
    return req.getResultList();
} 
```

当我调用该方法时来自客户

```
public void lister() {
    List<Article> arr = epicerie.listerLesArticles();
    System.out.println(" ");
    Iterator<Article> iterator =  arr.iterator();
    while (iterator.hasNext()) {
        Article unArticle=iterator.next();
        System.out.println(unArticle.getCode());
    }
    System.exit(0);
} 
```

但我明白了`Exception`：

```
Exception in thread "main" java.lang.reflect.UndeclaredThrowableException
    at $Proxy2.listerLesArticles(Unknown Source)
    at ecpicerie.EpicerieClient.lister(EpicerieClient.java:80)
    at ecpicerie.EpicerieClient.main(EpicerieClient.java:122)
Caused by: java.lang.ClassNotFoundException: org.hibernate.hql.ast.QuerySyntaxException
    at org.jboss.remoting.serialization.ClassLoaderUtility.loadClass(ClassLoaderUtility.java:103)
    at org.jboss.remoting.loading.RemotingClassLoader.loadClass(RemotingClassLoader.java:86)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:334)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:264)
    at org.jboss.remoting.loading.ObjectInputStreamWithClassLoader.resolveClass(ObjectInputStreamWithClassLoader.java:176)
    at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:1592)
    at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1513)
    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1749)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1346)
    at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1963)
    at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1887)
    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1770)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1346)
    at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1963)
    at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1887)
    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1770)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1346)
    at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1963)
    at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1887)
    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1770)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1346)
    at java.io.ObjectInputStream.readObject(ObjectInputStream.java:368)
    at org.jboss.remoting.serialization.impl.java.JavaSerializationManager.receiveObjectVersion2_2(JavaSerializationManager.java:238)
    at org.jboss.remoting.serialization.impl.java.JavaSerializationManager.receiveObject(JavaSerializationManager.java:138)
    at org.jboss.remoting.marshal.serializable.SerializableUnMarshaller.read(SerializableUnMarshaller.java:123)
    at org.jboss.remoting.transport.socket.MicroSocketClientInvoker.versionedRead(MicroSocketClientInvoker.java:1215)
    at org.jboss.remoting.transport.socket.MicroSocketClientInvoker.transport(MicroSocketClientInvoker.java:845)
    at org.jboss.remoting.MicroRemoteClientInvoker.invoke(MicroRemoteClientInvoker.java:160)
    at org.jboss.remoting.Client.invoke(Client.java:1708)
    at org.jboss.remoting.Client.invoke(Client.java:612)
    at org.jboss.aspects.remoting.InvokeRemoteInterceptor.invoke(InvokeRemoteInterceptor.java:60)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.aspects.tx.ClientTxPropagationInterceptor.invoke(ClientTxPropagationInterceptor.java:61)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.ejb3.security.client.SecurityClientInterceptor.invoke(SecurityClientInterceptor.java:65)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.ejb3.remoting.IsLocalInterceptor.invoke(IsLocalInterceptor.java:74)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.aspects.remoting.PojiProxy.invoke(PojiProxy.java:62)
    at $Proxy3.invoke(Unknown Source)
    at org.jboss.ejb3.proxy.handler.ProxyInvocationHandlerBase.invoke(ProxyInvocationHandlerBase.java:261)
    at org.jboss.ejb3.proxy.handler.session.SessionSpecProxyInvocationHandlerBase.invoke(SessionSpecProxyInvocationHandlerBase.java:101)
    at $Proxy2.listerLesArticles(Unknown Source)
    at ecpicerie.EpicerieClient.lister(EpicerieClient.java:80)
    at ecpicerie.EpicerieClient.main(EpicerieClient.java:122)
    at org.jboss.aspects.remoting.InvokeRemoteInterceptor.invoke(InvokeRemoteInterceptor.java:72)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.aspects.tx.ClientTxPropagationInterceptor.invoke(ClientTxPropagationInterceptor.java:61)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.ejb3.security.client.SecurityClientInterceptor.invoke(SecurityClientInterceptor.java:65)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.ejb3.remoting.IsLocalInterceptor.invoke(IsLocalInterceptor.java:74)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.aspects.remoting.PojiProxy.invoke(PojiProxy.java:62)
    at $Proxy3.invoke(Unknown Source)
    at org.jboss.ejb3.proxy.handler.ProxyInvocationHandlerBase.invoke(ProxyInvocationHandlerBase.java:261)
    at org.jboss.ejb3.proxy.handler.session.SessionSpecProxyInvocationHandlerBase.invoke(SessionSpecProxyInvocationHandlerBase.java:101)
    ... 3 more 
```

在这条线上

```
List<Article> arr=epicerie.listerLesArticles(); 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T08:30:53.437

你有两个基本问题：

*   您的 JPQL 查询错误
*   您的客户端没有所有必需的客户端库

请参阅查询的另一个答案，但要意识到通过修复查询，您只解决了一半的问题。服务器的文档应该告诉您需要复制哪些库（对于 JBoss，它基本上是整个 /client 库）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:57:07.687

尝试将您的 HQL 查询设置为：“来自文章”。造成这种情况的根本原因似乎是您遇到了 HQL 语法异常，但由于它没有 JPA 的 jar，因此无法将其序列化到您的客户端应用程序。

编辑：正如 Achille 的评论，“从文章 e 中选择 e”也可以。

# java - 使用计时器更新 jframe 组件的位置

> ID：10505404
> 
> 赞同：0
> 
> 时间：2012-05-08T19:46:01.720
> 
> 标签：java, swing, jframe, mouseevent, jlabel

我正在尝试制作一个使用标签来追逐用户鼠标的程序，我有两个问题：

首先，标签的位置是通过整个计算机屏幕的坐标来判断的，而不仅仅是窗口。

其次，当计时器使用时，标签在应用期间不会移动`repaint()`。

```
private JPanel contentPane;

/**
 * Launch the application.
 */
public static void main(String[] args) {
    EventQueue.invokeLater(new Runnable() {
        public void run() {
            try {
                MouseFollowDisplay frame = new MouseFollowDisplay();
                frame.setVisible(true);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    });
}

/**
 * Create the frame.
 */
public MouseFollowDisplay() {
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setBounds(100, 100, 450, 300);
    contentPane = new JPanel();
    contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
    setContentPane(contentPane);
    contentPane.setLayout(null);

    final JLabel lblNewLabel = new JLabel("RUN!");
    lblNewLabel.setRequestFocusEnabled(false);
    lblNewLabel.setLocation(new Point(5, 5));
    lblNewLabel.setBounds(10, 11, 31, 23);
    contentPane.add(lblNewLabel);

    contentPane.addMouseListener(new MouseAdapter() {

        int DELAY = 500;

        ActionListener MouseDetect = new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                // TODO Auto-generated method stub

                PointerInfo a = MouseInfo.getPointerInfo();
                Point b = a.getLocation();
                int x = (int) b.getX();
                int y = (int) b.getY();
                System.out.println(x + "," + y); 

                int lx = lblNewLabel.getX();
                int ly = lblNewLabel.getY();

                if (lx <= x+5 && lx >= x-5 && ly <= y+5 && ly >= y-5){
                    DetectMouse.stop();
                    JOptionPane.showMessageDialog(null, "You Lose!");
                }else{
                    lx = -((lx - x) * 5) / (Math.abs(lx - x));
                    ly = -((ly - y) * 5) / (Math.abs(ly - y));
                    lblNewLabel.repaint(lx, ly, 31, 23);
                }

                if (DELAY >= 150) {
                    DELAY -= 5;
                    DetectMouse.setDelay(DELAY);
                }
            }
        };

        Timer DetectMouse = new Timer(DELAY, MouseDetect);

        public void mouseClicked(MouseEvent arg0) {
            if (DetectMouse.isRunning()){
                DetectMouse.stop();
                DELAY = 500;
            }
            else{
                DetectMouse.start();    
            }
        }   
    });
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T21:14:25.587

这

```
lblNewLabel.repaint(lx, ly, 31, 23) 
```

通话不会移动您的标签。请参阅该重绘方法的 javadoc

> 如果组件正在显示，则将指定区域添加到脏区域列表。在所有当前挂起的事件都被调度后，组件将被重新绘制。

您要做的是调整标签的位置，然后重新绘制面板（标签的旧区域和新区域）。

比布局更好的方法`null`是拥有自己的布局`JComponent`或`JPanel`在其中覆盖`paintComponent`方法并使用该方法绘制该字符串`Graphics#drawString`。在这种情况下，不要忘记调用`super.paintComponent`以避免文本多次出现（例如，请参阅[this SO question](https://stackoverflow.com/questions/10459391/image-not-repainting-just-multiplying/)，了解如果您忘记调用会发生什么`super.paintComponent`）

# c - 双精度奇怪的行为。需要解释

> ID：10505411
> 
> 赞同：4
> 
> 时间：2012-05-08T19:46:47.777
> 
> 标签：c, gcc, floating-point

这是代码：

```
#include <stdio.h>
#include <math.h>

static double const x = 665857;
static double const y = 470832;

int main(){
    double z = x*x*x*x -(y*y*y*y*4+y*y*4);
    printf("%f \n",z);
    return 0;
} 
```

神秘地（对我来说）如果在 32 位机器上编译（或者在我的例子中使用 -m32 标志在 64 位机器上），这段代码会打印“0.0”，并且使用 GCC 4.6。据我所知，浮点运算有可能使它们上溢/下溢或失去精度，但是...... 0？如何？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T19:56:41.550

问题不在于数字溢出。问题是双打没有足够的精度来区分减法的两个操作数。

的值为`x*x*x*x`196573006004558194713601。

的值为`y*y*y*y*4+y*y*4`196573006004558194713600。

这些数字有 78 位，只有最后一位不同。双精度数只有 53 位。其他数字仅四舍五入到 53 位。

在您的情况下，两个操作数四舍五入为相同的数字，因此它们的差为 0。

如果稍微改写 z 的表达式，甚至会发生更奇怪的事情：

```
double z = x * x * x * x - ((y * y + 1) * y * y * 4); 
```

通过此更改，您将获得 33554432！为什么？因为中间结果四舍五入的方式导致右操作数的最后一位不同。最后一位的值为2^(78-53)=2^25。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-08T19:55:21.577

用任意精度整数计算表达式：

```
Prelude> 665857^4 - 4*(470832^4 + 470832^2)
1 
```

由于 a`double`通常只有 53 位精度，而中间结果有 78 位，精度不足以精确计算结果，因此它被四舍五入，最后一位在某些时候被遗忘。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-08T19:55:19.187

您的代码中没有浮点上溢或下溢。这两个量的数量级为 1.96573006 × 10^23，并且在很大程度上适合`double`. 你的例子只是说明了灾难性的取消，你减去两个相近的量，结果的相对精度变得可怕。

见[http://en.wikipedia.org/wiki/Loss_of_significance](http://en.wikipedia.org/wiki/Loss_of_significance)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-08T21:44:46.130

这是 IEEE 754 以标准化形式表示浮点数的方式的结果。float 或 double 或任何其他符合 IEEE 754 的表示形式存储如下：

```
1.xxxxxxxxxxxxxxxxxxx * 2^exp 
```

其中`xxxxxxxxxxxxxxxxxxx`是尾数的小数部分，因此尾数本身始终在 [1, 2) 范围内。始终为 1 的整数部分不存储在表示中。位数`x`定义精度。它是 52 位`double`。指数以偏移形式存储（必须减去 1023 才能获得它的值），但现在这无关紧要。

64 位 IEEE 754 中的 665857^4 是：

```
0 10001001100 (1)0100110100000001111100111011101010000101110010100010
+ exponent    mantissa 
```

（第一位是符号位：0 = 正，1 - 负；括号中的位并未真正存储）

在 80 位 x86 扩展精度中，它是：

```
0 10001001100    (1)0100110100000001111100111011101010000101110010100010
0 100000001001100 1 010011010000000111110011101110101000010111001010000111000111011 
```

（这里的整数部分是表示的明确部分 - 与 IEEE 754 的偏差；为了清楚起见，我已对齐尾数）

64 位 IEEE 754 和 80 位 x86 扩展精度中的 4*470832^4 为：

```
0 10001001100    (1)0100110100000001111100111011101001111111010101100111
0 100000001001100 1 010011010000000111110011101110100111111101010110011100100010000 
```

64 位 IEEE 754 和 80 位 x86 扩展精度中的 4*470832^2 为：

```
0 10000100110    (1)1001110011101010100101010100100000000000000000000000
0 100000000100110 1 100111001110101010010101010010000000000000000000000000000000000 
```

将最后两个数字相加时，过程如下：调整较小值的指数以匹配较大值的指数，同时将尾数向右移动以保留该值。由于两个指数相差 38，因此较小数字的尾数向右移动 38 位：

470832^2*4 调整后的 64 位 IEEE 754 和 80 位 x86 扩展精度：

```
 this bit came from 1.xxxx ------------------------------v
0 10001001100    (0)0000000000000000000000000000000000000110011100111010|1010
0 100000001001100 0 0000000000000000000000000000000000000110011100111010101001010101 
```

现在这两个量具有相同的指数，它们的尾数可以相加：

```
0 10001001100 (1)0100110100000001111100111011101001111111010101100111|0010
0 10001001100 (0)0000000000000000000000000000000000000110011100111010|1010
--------------------------------------------------------------------------
0 10001001100 (1)0100110100000001111100111011101010000101110010100001|1100 
```

我在栏的右侧保留了一些 80 位精度位，因为内部求和是以更高的 80 位精度完成的。

现在让我们在 64 位 + 80 位代表的一些位中执行减法：

```
minuend    0 10001001100 (1)0100110100000001111100111011101010000101110010100001|1100
subtrahend 0 10001001100 (1)0100110100000001111100111011101010000101110010100001|1100
-------------------------------------------------------------------------------------
difference 0 10001001100 (0)0000000000000000000000000000000000000000000000000000|0000 
```

纯0！如果您以全 80 位执行计算，您将再次获得纯 0。

这里真正的问题是 1.0 不能以 2^77 的指数以 64 位精度表示 - 尾数中没有 77 位精度。对于 80 位精度也是如此 - 尾数中只有 63 位，在给定指数 2^77 的情况下，比表示 1.0 所需的少 14 位。

就是这样了！这只是科学计算的美妙世界，没有什么能像你在数学课上学到的那样工作......

# xcode - 使用三个相关的 NSPopUpButton 在 CoreData 中设置值

> ID：10505416
> 
> 赞同：13
> 
> 时间：2012-05-08T19:47:03.220
> 
> 标签：xcode, core-data, nsarraycontroller

我希望用适当的措辞来表达自己。

我有三个实体：*customer*、*country*、*state*。在*country*和*state*之间，有两种关系。所以我可以创建一些*国家*并选择其中一个我可以创建一些属于它的*州。*

为了创建实体“客户”的界面，我放了三个`NSPopUpButton's`：

*   第一个选择*国家*，
*   第二个显示与所选*国家*相关的*州*。
**   最后一个显示与所选州相关的邮政编码。*

 *我的问题是我无法通过所选`NSPopUpButton`实体“客户”传递数据。NSPopoUpButton 通过绑定工作：

*   内容（绑定到：国家，排列对象），
*   内容值（绑定到：国家，排列对象，模型键：国家），
*   选定索引（绑定到：国家，selectionIndex）。

怎么做才能保证三者选择的数据`NSPopUpButton's`记录在实体“客户”的相应字段中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T22:30:29.963

在这里使用 3 个弹出窗口似乎可以解决您的问题，因为您可以返回每个选定项目的 int，然后将该信息传递给下一个按钮按下。

因此，当他们按“国家/地区”时，返回国家/地区 ID，并将其放入您的客户实体中。

然后，当他们按下 state 时，将 country 传递到此弹出窗口，并显示 states，然后将 state id 传回，并对 city 执行相同的操作。

这样你就没有很多托管对象了，因为你真的不需要数据，你只需要 id，也许还有名字，来显示给用户，这些可以在通知中传回到您的控制器。*

# scheme - 这个简短的 cdr/car 命令字符串的输出是什么？

> ID：10505417
> 
> 赞同：2
> 
> 时间：2012-05-08T19:47:06.447
> 
> 标签：scheme, racket

我试图了解 car 和 cdr 的多个调用如何协同工作。例如，下面的例子看起来很简单：

```
(car (cdr '(car (cdr (1 2 3)))) 
```

我的 DrRacket 编译器`'(cdr (1 2 3))`在运行时输出，但我不知道如何。不应该先取 (1 2 3) 的 cdr 吗？前两辆车和cdr呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T19:48:31.677

不，quote 运算符将引用它后面的所有表单和子表单。只执行列表的第一个 car 和 cdr；首先`(cdr '(car (cdr (1 2 3)))`-> `'((cdr (1 2 3))`，然后`(car '((cdr (1 2 3)))`-> `'(cdr (1 2 3))`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T22:26:48.810

这里的问题是“报价”比你想象的要强大得多。特别是，引用是对“读者”的指令——检查你的程序的第一段代码——重写你的程序

```
(car (cdr '(car (cdr (1 2 3)))) 
```

...进入

```
(car (cdr (list (quote car) (list (quote cdr) (list 1 2 3)))) 
```

也就是说，quote 向下流动并将每个左括号更改为新的列表创建，并将每个标识符更改为带引号的符号。

将引号应用于标识符以外的事物（例如，`'abc`）是一个相当模糊的概念，通常在您对列表有很多经验并且正在寻找一种缩写它们的好方法之后更有意义。

# java - 如何找到 slf4j 绑定到的库？

> ID：10505418
> 
> 赞同：56
> 
> 时间：2012-05-08T19:47:13.230
> 
> 标签：java, logging, log4j, slf4j

我正在使用 slf4j 登录我的应用程序。我明白了 slf4j 的目的。我想知道如何找出当前绑定的日志库 slf4j。我在我引用的库中有 log4j。我假设 slf4j 已将自身绑定到 log4j。

我想知道的是，有没有办法明确确认这个绑定？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-05-08T19:58:04.193

只需执行 SLF4J 的操作即可发现绑定：

```
final StaticLoggerBinder binder = StaticLoggerBinder.getSingleton(); 
```

现在您可以尝试找出在我的案例中实际实现的[logback](/questions/tagged/logback "显示标记为“logback”的问题")是什么：

```
System.out.println(binder.getLoggerFactory());
System.out.println(binder.getLoggerFactoryClassStr()); 
```

这打印：

```
ch.qos.logback.classic.LoggerContext[default]
ch.qos.logback.classic.selector.DefaultContextSelector 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-08T19:58:13.247

[`StaticLoggerBinder`](http://www.slf4j.org/apidocs/org/slf4j/impl/StaticLoggerBinder.html)'s[`getLoggerFactoryClassStr()`](http://www.slf4j.org/apidocs/org/slf4j/impl/StaticLoggerBinder.html#getLoggerFactoryClassStr%28%29)方法可能是您正在寻找的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-07-20T16:00:19.943

简单的。在.. 说.. LOG.info(...) 上放一个断点。一旦调试器停在那里，进入.. 和 viola.. 你会发现自己在实际记录器的代码中......比如 log4j 或 logback.. 随便什么。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-05-14T16:51:31.880

可以使用主要的 slf4j 公共 API（即没有内部 StaticLoggerBinder）来执行此操作，例如检测 slf4j 是否对 log4j2 有 bpound：

```
if ("org.apache.logging.slf4j.Log4jLoggerFactory".equals(
    org.slf4j.LoggerFactory.getILoggerFactory().getClass().getName()
) 
{ ... } 
```

# php - php计时器只允许用户每两秒输入一次

> ID：10505422
> 
> 赞同：5
> 
> 时间：2012-05-08T19:47:22.000
> 
> 标签：php, jquery, security, timer

我正在编写一个网站，您可以在其中发布内容。这适用于以下 jQuery ajax：

```
 $.ajax({
        type: 'POST',
        url: 'action/post.php',
        data: 'posttext='+posttext+'&imageurl='+imageurl,
        success: function(feedback){
            $('#feedback').val(feedback);
        }
    }); 
```

现在我想知道：任何人都可以编写自己的 ajax 将某些内容发布到站点并一遍又一遍地执行此操作。我该如何防止这种情况？我确信我需要在 post.php 中进行某种安全检查——我已经听说过 http referer，但是可以对其进行修改，因此它并不是真正值得信赖的。

我还想在 post.php 中添加一个计时器，以确保来自同一 IP 地址的帖子只能每 x 秒发布一次，如果帖子发送时间低于 x 秒，则重置计时器（有点像堆栈溢出与评论一起做）。

有谁知道如何保护 ajax 以及如何设置计时器？或任何其他想法如何保护发布机制？

谢谢！

丹尼斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:54:17.270

您最好的方法是将您的信息存储在数据库中。一个表中可以有 4 个字段：

```
ipAddress, submitDate, postText, imageUrl 
```

提交后，检查数据库中是否有当前 IP 地址的条目。如果是这样，请将条目的提交日期与当前日期进行比较，如果超过您的阈值，则允许提交。否则，发出错误消息并将用户重定向回来。

然而，这仍然不是万无一失的，因为 IP 地址也可能被欺骗，或者用户可能隐藏在代理后面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:10:10.733

只需将 IP 和请求时间存储在日志文件中。然后检查每个请求的日志文件是否存在该 IP 并比较存储的时间。

这是一个简单的脚本，它只允许 10 秒后来自同一 IP 的请求：

```
$waitSeconds = 10;
if (allowRequest($waitSeconds)) {
    // allowed
    echo "Welcome.";
} else {
    // not allowed
    echo "Please wait at least $waitSeconds after your last request.";
}
echo '<hr /><a href="#" onclick="location.reload(true);return false">try again</a>';

function getLastRequestTimeDiff($ip = null, $logFile = null)
{
    if ($ip === null) {
        // no specific ip provided, grab vom $_SERVER array
        $ip = $_SERVER["REMOTE_ADDR"];
    }
    if ($logFile === null) {
        // no specific log file taken
        $logFile = "./lookup.log";
    }
    if (!is_file($logFile)) {
        // touch
        file_put_contents($logFile, serialize(array()));
    }
    // read content
    $logContent = file_get_contents($logFile);
    // unserialize, check manual
    $lookup = unserialize($logContent);
    // default diff (f.e. for first request)
    $diff = 0;
    // current timestamp
    $now = time();
    if (array_key_exists($ip, $lookup)) {
        // we know the ip, retrieve the timestamp and calculate the diff
        $diff = $now - $lookup[$ip];
    }
    // set the new request time
    $lookup[$ip] = $now;
    // serialize the content
    $logContent = serialize($lookup);
    // and write it back to our log file
    file_put_contents($logFile, $logContent);
    // return diff (in seconds)
    return $diff;
}

// encapsulate our function in a more simple function (allow yes/no)
function allowRequest($allowed = 10, $ip = null, $logFile = null)
{
    $timeDiff = getLastRequestTimeDiff($ip, $logFile);
    return $timeDiff >= $allowed;
} 
```

# c++ - 从 C++ 中的其他方法调用构造函数

> ID：10505425
> 
> 赞同：0
> 
> 时间：2012-05-08T19:47:25.313
> 
> 标签：c++, constructor

我不确定这在 C++ 中是否合法：

```
class Image
{
     Image(int w, int h) // constructor
     {
            ...
     }

     Image GetSpecialImage()
     {
          Image rVal(10,10);
          return rVal;
     }
} 
```

我是否需要`init()`在 C++ 中使用另一种中间级别的方法来执行此操作？如果是，你能告诉我怎么做吗？

* * *

`EDIT:`尽管你说这很好，但它并没有真正做我想做的事情......让我再给你一些代码：

```
class Image
{
     float* data;
     int w;
     int h;

     Image(int w, int h) // constructor
     {
            this->w = w;
            this->h = h;
            data = (float*) malloc ( w * h * sizeof(float) );
     }

     Image GetSpecialImage()
     {
          Image rVal(this->w,this->h);

          for(i=0;i<this->w * this->h;i++)
          {
                rVal.data[i] = this->data[i] + 1;
          }

          return rVal;
     }
}

int main()
{
      Image temp(100, 100);
      Image result = temp.GetSpecialImage();
      cout<<result.data[0];

      return 0;
} 
```

这部分有什么问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T19:53:57.217

正如赛斯所说，这是合法的。

您可以更改以使其更好地工作的方法是创建`GetSpecialImage`一个静态函数。类中定义的静态函数是类函数而不是对象函数。这意味着你不需要一个对象来调用它。

然后它会被这样调用：`Image special = Image::GetSpecialImage();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:54:35.590

是的，你可以这样做。不过我会这样做

```
 Image GetSpecialImage()
 {            
     return Image(10,10);      
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:56:10.917

虽然这段代码没有任何问题（好吧，除了返回一个本地，这是一个禁忌），我猜你正在寻找的是一个静态构造函数模式。像这样：

```
class Image{
 public:
  static Image* GetSpecialImage(){
    return new Image(10,10);
  }
};

//and call it so
Image *i = Image::GetSpecialImage(); 
```

# c# - 按名称获取实体

> ID：10505427
> 
> 赞同：6
> 
> 时间：2012-05-08T19:47:41.000
> 
> 标签：c#, entity-framework, reflection

假设我有一个 EF 实体名称列表，例如：

```
List<string> entityNames = new List<string>(){
    "Table1",
    "Table2",
    "Table3"
}; 
```

从这个实体列表中，我想单独查询每个实体，类似于：

```
var result = efContext.Table1.Where(t => ...); 
```

使用反射或黑魔法，我将如何获得对实际实体的引用，以便我可以得到类似的东西：

```
foreach(var e in entityNames)
{
    var entity = efcontext.GetType().GetProperties().Where(t => t.Name == e).Single();
    var result = efContext.entity.Where(t => ...);
} 
```

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:49:07.463

假设列出的所有实体类型都实现了您打算在`Where`子句中使用的一些通用接口，您可以执行以下操作：

```
foreach(var e in entityNames)
{
    PropertyInfo entityProperty = efcontext.GetType().GetProperties().Where(t => t.Name == e).Single();
    var baseQuery = (IQueryable<IMyEntity>)entity.GetValue(efContext, null);
    var result = baseQuery.Where(t => ...);
} 
```

# c# - 根据百分比从 IEnumerable 中选择行

> ID：10505428
> 
> 赞同：4
> 
> 时间：2012-05-08T19:47:55.453
> 
> 标签：c#

我目前有一个每 5 分钟运行一次的 Windows 服务。该代码从数据库中选择行进行处理。有一个上限（允许选择的最大行数），因此选择的行数可以在 0-100 之间。

我希望根据随机百分比选择对这些行进行一些处理。

*   任务 1 25%
*   任务 2 50%
*   任务 3 100%

为简单起见，我们假设服务选择了 100 行，那么随机选择的 25 行将运行任务 1，随机选择的 50 行将运行任务 2，所有行都将运行任务 3。

我目前的代码看起来像：

```
var rows = repository.GetRows(100);

foreach(var row in rows)
{
    task1.Run(row);
    task2.Run(row);
    task3.Run(row);
} 
```

这将在所有行上运行所有三个任务。我将如何只选择分配给每个任务的百分比？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:24:50.733

您可以定义一个 Shuffle() 扩展方法来执行 Fisher-Yates-Durstenfeld shuffle（它以线性时间执行，而不是 OrderBy 的 NlogN 时间）：

```
public static IEnumerable<T> Shuffle<T>(this IEnumerable<T> input)
{
    var buffer = input.ToArray();
    //Math.Random is OK for "everyday" randomness;
    //you should use RNGCryptoServiceProvider if you need 
    //cryptographically-strong randomness
    var rng = new Math.Random();

    //as the loop proceeds, the element to output will be randomly chosen
    //from the elements at index i or above, which will then be swapped with i;
    //the yield return gives us each shuffled value as it is chosen, and
    //allows the shuffling to happen "lazily".
    for (int i = 0; i < buffer.Length; i++)
    {
        int j = rng.Next(i, buffer.Length);
        yield return buffer[j];
        //if we cared about the elements in the buffer this would be a swap,
        //but we don't, so...    
        buffer[j] = buffer[i];
    }
}

//simple extension method to provide List.ForEach()-like functionality
//on any collection or IEnumerable.
public static void ForEach(this IEnumerable<T> collection, Action<T> action)
{
    foreach(var element in collection) action(element);
}

//Usage - pretty much the same as Raphael's, 
//but now you don't have to convert to a List to use ForEach:
rows.Shuffle().Take(25).ForEach(m => task1.Run(m));
rows.Shuffle().Take(50).ForEach(m => task2.Run(m));
rows.ForEach(m => task3.Run(m)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:54:25.443

可能有点土气……

```
var rows = repository.GetRows(100);

rows.OrderBy(Guid.NewGuid()).Take(25).ToList().ForEach(m => task1.Run(m));
rows.OrderBy(Guid.NewGuid()).Take(50).ToList().ForEach(m => task2.Run(m));
rows.ToList().ForEach(m => task3.Run(m)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T20:06:52.217

对于这种情况，您可以使用 Knuth 的随机抽样方法（从 n 中选择 m 项）：

```
var rows = repository.GetRows(100);
int[] maxTake = new[] {25,50,100};
int remaining = rows.Length;
Random rand = new Random();

for (int i = 0; i < rows.Length; i++)
{
    var num = rand.Next() % remaining;
    if (num < maxTake[0])
    {
        task1.Run(rows[i]);
        maxTake[0]--;
    }
    if (num < maxTake[1])
    {
        task2.Run(rows[i]);
        maxTake[1]--;
    }
    if (num < maxTake[2])
    {
        task3.Run(rows[i]);
        maxTake[2]--;
    }
    remaining--;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T19:54:28.117

您可以通过以下方式获得随机子集合：

```
task1.Run(rows);
task2.Run(rows.OrderBy(x => Guid.NewGuid()).Take(25));
task2.Run(rows.OrderBy(x => Guid.NewGuid()).Take(50)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T19:55:30.037

您可以使用`Random`实例为每一行生成一个随机值（介于 0.0 和 1.0 之间）。

大约 25% 的行的生成值小于 0.25；大约 50% 的行的生成值会小于 0.5。

```
var rows = repository.GetRows(100);

Random random = new Random();

task1.Run(rows.Where(_ => random.NextDouble() <= 0.25));
task2.Run(rows.Where(_ => random.NextDouble() <= 0.5));
task3.Run(row); 
```

如果您想保证您将获得行集合的 25% 和 50%（向下舍入），请使用：

```
Random random = new Random();

var rows = repository.GetRows(100);
var rowsRandomized = rows.OrderBy(_ => random.NextDouble());

task2.Run(rowsRandomized.Take((int)(0.25 * rows.Count())));
task2.Run(rowsRandomized.Take((int)(0.5 * rows.Count())));
task3.Run(rowsRandomized); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-08T19:59:58.327

获得 25 个随机唯一数字

```
 Random rand=new Random()

 int[] task1nums = new int[25];
 for (int i=0;i<25;i++);
 {
    int r=rand.Next(100);

    while (task1nums.Contains(r))
    {
        r=rand.Next(100);
    }
    task1nums[i]=r;
} 
```

获得 50 个随机唯一数字

```
 int[] task2nums = new int[50];
 for (int i=0;i<50;i++);
 {
    int r=rand.Next(100);

    while (task2nums.Contains(r))
    {
        r=rand.Next(100);
    }
    task2nums[i]=r;
} 
```

所以现在你有 25 个随机数和 50 个随机数

```
var rows = repository.GetRows(100);
int counter=0
foreach(var row in rows)
{
    if (task1nums.Contains(counter))
    task1.Run(row);
    if (task2nums.Contains(counter))
    task2.Run(row);

    task3.Run(row);

    counter++;
} 
```

# apache-flex - Flex - 如何检测对象数据是否已更改？

> ID：10505430
> 
> 赞同：0
> 
> 时间：2012-05-08T19:48:00.643
> 
> 标签：apache-flex, events, object, flash-builder

在 Flex (Flash Builder 4) 中，我需要一种方法来了解数组集合中的某些内容是否已更改。

我有一个自定义对象：

[可绑定] public var _myobject:MyObject;

它基本上只是一个包含一堆不同 String 和 Number 属性的类。

我需要一种可靠的方法来了解是否有任何属性已更改。例如，我将属性绑定到用户界面（字段），但也可以通过代码更改某些属性。

有没有办法做到这一点？我找到了 ChangeWatcher，但看起来它只查看一个简单的属性，例如字符串或数字。我需要观察或检测对象中所有属性的变化，希望不必将 ChangeWatcher 事件添加到每个属性。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T00:39:53.060

您最好只在您希望可绑定的特定属性上调度绑定事件。更好的是，调度一个自定义绑定事件，这样所有绑定的东西都不必过滤“这是我关心的属性吗？” 使用 Flash Builder 4.5 很容易做到这一点，只需选择变量名称并按 Ctrl-1，选择“创建 getter 和 setter”，选择 getter 和 setter 并选中“可绑定”和“创建自定义事件”。

这将为您创建如下所示的代码：

```
private var _yourProperty:String;

[Bindable (event='yourPropertyChange')]
public function get yourProperty():String {
   return _yourProperty;
}

public function set yourProperty(value:String):void {
   if (value !=== _yourProperty) {
     _yourProperty = value;
     dispatchEvent(new Event('yourPropertyChange'));
   }
} 
```

当您仅使用 Bindable 标记时，这将比 Flash Builder 在幕后为您生成的代码更简洁、更高效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:31:52.023

如果您将定义的类用作 VO/DAO 并将 [Bindable] 标记应用于该类，这将为您绑定所有属性（只要它们是读/写的）。

匿名对象检测充其量是困难的，更不用说增加失去编译器类型检查的额外麻烦了。

超级基本的例子： - 关键是将它绑定到调度程序，因此它可以在内部发送PropertyChangeEvent。

```
 [Bindable]
 public class Actor extends EventDispatcher 
 {
      public var fName:String;
      public var lName:String;
      public var age:uint;

      public function get displayName():String
      {
          return lName +', '+ fName;
      }

      public function Actor()
      {
          super();
      }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T08:19:01.503

```
public class BindableDictionary extends EventDispatcher {
        public function BindableDictionary() {
            super();
        }

        public var dictionary:Dictionary = new Dictionary();

        [Bindable("change")]
        public function get(key:Object):Object {
            return dictionary[key];
        }

        public function put(key:Object, value:Object):void {
            dictionary[key] = value;
            dispatchEvent(new Event(Event.CHANGE));
        }
    } 
```

也许这门课会给你一些新的想法

# database-design - Trello 如何如此迅速地展示历史？

> ID：10505431
> 
> 赞同：26
> 
> 时间：2012-05-08T19:48:05.563
> 
> 标签：database-design, architecture, trello

Trello 显示自董事会成立以来任何用户所做的所有事情的历史日志。同样，如果您单击特定卡片，它会显示任何人与该卡片相关的任何操作的历史记录。

跟踪无限期保存的每个更改/添加/删除必须收集大量数据，并且还可能成为写入历史跟踪日志的瓶颈（假设它被立即写入各种数据存储）。我的意思是，他们并不是将所有内容都存储在分布在 1000 台服务器上的日志文件中，他们只在需要查找某些内容时才收集和解析——他们一直在显示所有这些信息。

我知道这不是提供此类服务的唯一服务，但是您将如何构建这样的系统？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-14T02:07:15.623

我在 Trello 团队。我们在 MongoDB 实例中使用 Actions 集合，在它所引用的模型的 id 上具有复合索引（Card 是模型，Member 也是）和执行操作的日期。没有花哨的缓存或任何东西，除了索引和最近使用的文档由数据库保存在内存中。Actions 是迄今为止我们最大的系列。

值得一提的是，显示动作所需的大部分数据都以非规范化的方式存储在动作文档中，因此大大加快了速度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T19:56:08.327

想到的最简单的方法是有一个像这样的表：

```
create table HistoryItems (
ID INT PK,
UserID INT PK,
DateTime datetime,
Data varbinary(max)/varchar(max)/...) 
```

在 UserID 上建立索引允许快速检索。覆盖索引可以在一次磁盘查找中获取整个用户的历史记录，无论它有多长。

该表可以聚集在 (UserID asc, DateTime desc, ID) 上，因此您甚至根本不需要*任何*索引并且仍然具有最佳性能。

关系数据库的任何简单问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-16T15:19:09.217

我在我的 PHP + MySQL 应用程序中与 Trello 的 @Brett 非常相似，我用它来跟踪我们在线网上商店的订单和生产管理应用程序中的用户活动。

我有餐桌活动，其中包括：

*   `user_id`: 执行操作的用户
*   `action_id`: 已执行的操作（例如创建、更新、删除等...）
*   `resource`：执行操作的资源（模型）的 ENUM 列表（例如订单、发票、产品等）
*   `resource_id`: 执行操作的资源的 PK
*   `description`: 动作的文字描述（可以为空）

它确实是一个大表，但使用正确的索引它处理得很好。它执行它的目的。简单快捷。目前它拥有 20 万条记录，并且随着 cca 的增长而增长。每天1000个新条目。

# flash - 在绝对图像上居中嵌入 swf 对象

> ID：10505437
> 
> 赞同：0
> 
> 时间：2012-05-08T19:48:37.763
> 
> 标签：flash, xhtml, center

XHTML 仍然是一种非常糟糕的语言，您必须尝试许多技巧才能获得简单的结果，例如使对象居中并在每个浏览器上都获得它们。那是我的问题。所以，我有一个覆盖整个页面的图像。它不是背景，因为我希望它适合屏幕，而背景不会那样做。我的图像定位为绝对。现在，我想要的是在图像上水平居中的 Flash swf。有时它可以工作，但仅限于非 IE 浏览器（一如既往）。有时它不在任何浏览器上。问题是我只是不知道如何使 flasj 对象以图像为中心。它总是出现在屏幕的左上角。我的代码是这样的：

```
<body style="margin: 0px auto; text-align: center; width: 100%; height: 100%;">
    <object type="application/x-shockwave-flash" 
        height="100" width="200" 
        style="position: absolute; float: top; margin: 10px auto; z-index: 1;">
        ...
        ...
    </object>
    <img src="image.jpg" height="100%" width="100%" 
        style="postion: absolute; left: 0px; top: 0px; z-index:-1;" />
</body> 
```

主要问题是我在 IE（*Impossible to Explore*）浏览器中看不到 flash 中心。你怎么看？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:11:09.023

如果你想居中，给它一个自动水平边距以及`display: block`.

```
<object style="display: block; width: 200px; margin: 0 auto;"> .. </object> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:54:40.810

首先，我强烈推荐 swfobject，这是一种广泛使用的将 flash 嵌入 html 的标准。

[http://code.google.com/p/swfobject/](http://code.google.com/p/swfobject/)

如果您想继续使用 object 标签，请尝试将其包装在 div 中并在 div 上设置定位属性，而不是 object 标签。

# windows - ssh 到 Windows 机器时，如何在登录时自动设置路径？

> ID：10505443
> 
> 赞同：0
> 
> 时间：2012-05-08T19:48:51.733
> 
> 标签：windows, ssh

我想在 Windows 服务器上设置路径，以便当我通过 SSH 登录时目录

```
C:\Program Files (x86)\Git\libexec\git-core 
```

在我的路上。

我可以 ssh 到服务器，但 %PATH% 不包含上面的目录。

是否有像“.profile”、“.bashrc”或“.login”这样的文件，我可以在其中将目录添加到路径中？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-03T15:22:42.407

您还可以从命令行设置路径

```
setx PATH "%PATH%;C:\Program Files (x86)\Git\libexec\git-core" 
```

不过，我遇到了和你一样的问题，这是我在键盘上的命令提示符下与远程登录时的路径不同。仍在试图弄清楚这一点。

# java - 如何在不提交表单 Wicket 的情况下获取默认模型对象

> ID：10505445
> 
> 赞同：-4
> 
> 时间：2012-05-08T19:48:54.917
> 
> 标签：java, html, wicket

我有一些检查组，我可以在没有提交表单的情况下获取DefaultModelObject 我需要检查复选框谢谢，对不起，我的英语不好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T08:27:14.573

很难从您的问题中分辨出来，但是如果您想要获得有关复选框更改的通知，并`CheckGroup`在每次更改时更新 ' 模型对象，请使用[`AjaxFormChoiceComponentUpdatingBehavior`](http://wicket.apache.org/apidocs/1.5/org/apache/wicket/ajax/form/AjaxFormChoiceComponentUpdatingBehavior.html).

```
CheckGroup cg = new CheckGroup("id");
cg.add(new Radio("id1", someObject);    
cg.add(new Radio("id2", someObject2);
cg.add(new Radio("id3", someObject3);
cg.add(new AjaxFormChoiceComponentUpdatingBehavior(){
    @Override
    protected void onUpdate(AjaxRequestTarget target) {
        // Get the CheckGroup's updated model object.
        Object modelObject = getComponent().getModelObject(); 
    } 
}; 
```

`<input type="check">`该组件将在您的所有或上输出适当的 JavaScript 事件侦听`<input type="radio">`器，以便调用`onUpdate`行为的方法。

考虑到`AjaxFormChoiceComponentUpdatingBehavior`将为`Validators`组件执行（并调用`onError`而不是`onUpdate`相应地调用），但*它不会*执行 FormValidators，因此如果是这种情况，您必须自己检查输入。

# iphone - iPhone 4S 加速度计规格

> ID：10505446
> 
> 赞同：0
> 
> 时间：2012-05-08T19:49:04.377
> 
> 标签：iphone, accelerometer

谁能帮我找到 iPhone 4S 加速度计的完整规格？

我试图在 apple.com 上或内部搜索一些东西，但是，我没有成功。

我想要一些关于加速度计测量的完整规格：测量规模，读数刷新的频率，主要是关于它的一切。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:02:27.457

iPhone 4S 使用 STMicro STM33DH 3 轴加速度计和 STIMicro AGDI 3 轴陀螺仪。我找不到规格表或产品页面。

资料来源：

*   [http://www.bigigloo.de/wordpress/wp-content/uploads/2011/04/CoreMotion.pdf](http://www.bigigloo.de/wordpress/wp-content/uploads/2011/04/CoreMotion.pdf)
*   [http://www.ifixit.com/Teardown/iPhone-4-Teardown/3130/2](http://www.ifixit.com/Teardown/iPhone-4-Teardown/3130/2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-07T12:08:48.297

真正的加速度计型号是 LIS331DLH，看[这个](http://www.tgdaily.com/hardware-features/50344-the-real-iphone-4-teardown)（强调我的）

> 在主要的设计胜利中，英飞凌发现自己拥有收发器（标有“Apple 338S0626”）和 X-GOLD 61x（标有“3833”）基带处理器。[然而]，最值得注意的部件来自**ST Micro**，它不仅提供了**LIS331DLH 3 轴加速度计（错误地识别为 STM33DH）** [连同] 3 轴数字陀螺仪......

[Chipworks 网页](http://www.chipworks.com/en/technical-competitive-analysis/resources/blog/iphone-4s-teardown-a-closer-look-at-the-chips-inside/)也将其识别为 LIS331DLH

加速度计的规格在[这里](http://www.st.com/web/en/resource/technical/document/datasheet/CD00213470.pdf)。

# security - curl异常60：证书安全api异常

> ID：10505449
> 
> 赞同：2
> 
> 时间：2012-05-08T19:49:11.983
> 
> 标签：security, curl, ssl-certificate, facebook-oauth, facebook-authentication

> **致命错误**：未捕获的 CurlException：60：无法使用第**886**行**/home/ldr/public_html/src/base_facebook.php中抛出的已知 CA 证书对对等证书进行身份验证**
> 
>  **见： http: [//ldr.x10.bz/examples/with_js_sdk.php](http://ldr.x10.bz/examples/with_js_sdk.php)**

 **我已经收到这个错误两天了，找不到任何关于它来自哪里的信息？为什么证书是已知的，有没有办法让它再次不为人知？

它已经工作了几个月，所以不确定 API 是否刚刚更新，但我已经删除了所有内容并刚刚上传了 PHP SDK 3.1.1 但仍然没有运气:(

我读过有关禁用对等验证的信息，但听起来是个坏主意（而且我知道它可以在启用它的情况下工作）。可能不小心取消选中某处的框 - 任何关于如何将其恢复正常的想法将不胜感激:)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T21:59:03.493

证书会根据系统上某处的信任库进行验证。此信任库应不时更新；例如，Firefox 和 Windows 在更新软件时会这样做。错误有点不清楚；这实际上意味着您的 curl 客户端获得了一个它没有*受*信任（根）证书的证书。

您可能希望使用您最喜欢的最新浏览器访问该站点并将根证书保存在某处，然后创建一个包含该单个证书的 CA 存储。当然，如果那个被替换或者服务器选择了另一个证书颁发机构，它就会失败。

可能更新 curl 或 OpenSSL 库可以解决问题，请先尝试 :)。**

# java - 在 JavaScript 中区分内网和外网 IP 地址

> ID：10505450
> 
> 赞同：0
> 
> 时间：2012-05-08T19:49:26.280
> 
> 标签：java, javascript, google-app-engine, google-chrome-extension, firefox-addon

我正在编写一个浏览器插件（Chrome 和 Firefox），简而言之，它会根据**用户访问的每个页面的**内容（即我们不是在谈论用户*自己的*页面）进行“一些计算”，呈现有分数的用户。在得分特别高的情况下，将页面标题、页面 URL 等（自动）提交给中央服务，以便显示一种排名表。

所有这一切都完美无缺，但我希望 - 在可能的情况下 -从我们的用户碰巧访问的 Intranet 页面中**删除所有流量。**（我们不存储或传输任何页面内容，但存在隐私问题，我们不希望与内部/公司文件有任何关系。）

从理论上讲，我可以计算出（以合理的准确度）IP 是否可能来自 Intranet @[区分 Intranet 和官方 IP 地址之间](https://stackoverflow.com/questions/601602/distinguish-the-between-intranet-and-official-ip-addresses)，但由于 DOM 不提供对文档主机 IP 的访问，因此是考虑到查找服务可能会停止/缓慢，尝试即时确定 IP 然后应用这些 IP 规则是否可行？

一个更简单的替代方案（例如文档主机名的 TLD 的模式匹配）几乎一样好吗？

有什么建议么？

**更新：**

我正准备自己回答这个问题*：“我将在提交页面统计信息时在服务器上进行 IP 检查，并且只有在 IP 不在内部范围内时才完成提交——这要容易得多。”* ...不幸的是我不能这样做：因为我的后端是 Google AppEngine [Java] 并且`InetAddress`类受到限制，我不能进行任意 IP 查找。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T21:28:10.977

您应该使用[nsIDNSService](https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIDNSService)来解析 Firefox 中的主机名。沿着这些思路：

```
var threadManager = Components.classes["@mozilla.org/thread-manager;1"]
                              .getService(Components.interfaces.nsIThreadManager);
var dnsService = Components.classes["@mozilla.org/network/dns-service;1"]
                           .createInstance(Components.interfaces.nsIDNSService);
var listener = {
  onLookupComplete: function(request, record, status)
  {
    if (Components.isSuccessCode(status))
      alert("Host IP address: " + record.getNextAddrAsString());
    else
      alert("Lookup failed");
  }
};
dnsService.asyncResolve("www.google.com", 0, listener,
                        threadManager.currentThread); 
```

这通常是一个非常快的操作，因为主机名已经被缓存了。注意：如果您使用附加 SDK，那么您将必须[使用 chrome 权限](https://addons.mozilla.org/en-US/developers/docs/sdk/1.6/dev-guide/tutorials/chrome.html)`Components`并用相应的别名替换对属性的访问。

至于 Chrome，我怀疑你是否可以在那里正确解决这个问题。正如 Korvin Szanto 在评论中指出的那样，*任何*主机名都可以指向本地地址。Chrome 不会让你获得它与之通信的 IP 地址。

# unicode - 如何对不同语言的列表项进行分组？

> ID：10505454
> 
> 赞同：1
> 
> 时间：2012-05-08T19:49:39.213
> 
> 标签：unicode, collation, icu

我有一个在排序列表中显示用户数据的应用程序。该列表有一个索引，在英文中是字母 AZ。点击索引中的一个字母会跳转到以该字母开头的项目。这适用于类似英语的语言，但对于使用不同字符集的语言（例如中文）则完全失败。

我可以使用 ICU 将项目列表整理成正确的顺序，但我如何才能找到其他语言的正确索引集？请注意，我不提前知道整个列表，因此无法从数据中生成索引。

可以为每种支持的语言重新计算索引，但在这种情况下，我将如何找到此类列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:04:36.053

CLDR 中的“索引字符”信息是为了这样的目的而存在的：“索引字符是用作 UI“索引”的有序字符列表，即允许用户点击的可点击字符（或字符序列）列表查看更大的“目标”列表的一部分。” （[http://www.unicode.org/reports/tr35/#Character_Elements](http://www.unicode.org/reports/tr35/#Character_Elements)）

恐怕这些信息还没有在 ICU 中，但是如果您只需要几种语言的信息，您可以从 [http://unicode.org/repos/cldr-tmp/trunk/diff/by_type/复制数据misc.indexCharacters.html](http://unicode.org/repos/cldr-tmp/trunk/diff/by_type/misc.indexCharacters.html)

# javascript - 正则表达式将 URL 转换为链接

> ID：10505456
> 
> 赞同：-1
> 
> 时间：2012-05-08T19:49:40.913
> 
> 标签：javascript, regex

我从这个网站“借用”了一个正则表达式：[http](http://daringfireball.net/2010/07/improved_regex_for_matching_urls) ://daringfireball.net/2010/07/improved_regex_for_matching_urls 这几乎是完整的，但我想匹配 example.com
我知道 stackoverflow 不是 doyourhomework.com 但我过了很长时间没有结果的思考。这是一个要测试的小提琴：http: [//jsfiddle.net/BGnMm/25/](http://jsfiddle.net/BGnMm/25/)你可以在最后看到 exemple.com 不是一个链接。

```
var reg=/\b((?:[a-z][\w-]+:(?:\/*)|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi;
var allurl="http:foo.com/blah_blah http://foo.com/blah_blah/ (Something like http://foo.com/blah_blah) http://foo.com/blah_blah_(wikipedia) http://foo.com/more_(than)_one_(parens) (Something like http://foo.com/blah_blah_(wikipedia)) http://foo.com/blah_(wikipedia)#cite-1 http://foo.com/blah_(wikipedia)_blah#cite-1 http://foo.com/unicode_(✪)_in_parens http://foo.com/(something)?after=parens http://foo.com/blah_blah. http://foo.com/blah_blah/. <http://foo.com/blah_blah> <http://foo.com/blah_blah/> http://foo.com/blah_blah, http://www.extinguishedscholar.com/wpglob/?p=364\. http://✪df.ws/1234 rdar://1234 rdar:/1234 x-yojimbo-item://6303E4C1-6A6E-45A6-AB9D-3A908F59AE0E message://%3c330e7f840905021726r6a4ba78dkf1fd71420c1bf6ff@mail.gmail.com%3e http://➡.ws/䨹 www.c.ws/䨹 <tag>http://example.com</tag> Just a www.example.com link. http://example.com/something?with,commas,in,url, but not at end What about <mailto:gruber@daringfireball.net?subject=TEST> (including brokets). mailto:name@example.com bit.ly/foo “is.gd/foo/” WWW.EXAMPLE.COM http://www.asianewsphoto.com/(S(neugxif4twuizg551ywh3f55))/Web_ENG/View_DetailPhoto.aspx?PicId=752 http://www.asianewsphoto.com/(S(neugxif4twuizg551ywh3f55)) http://lcweb2.loc.gov/cgi-bin/query/h?pp/horyd:@field(NUMBER+@band(thc+5a46634)) 6:00p filename.txt http://example.com/quotes-are-“part” ✪df.ws/1234 example.com example.com/";
document.write(allurl.replace(reg,"<a href='$1' >$1</a><br />")); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:15:57.827

在 之后添加一个交替运算符 ( `|`) `{2,4}\/`，即

```
 var reg=/\b((?:[a-z][\w-]+:(?:\/*)|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/|)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi; 
```

你应该明白这点。第一个未捕获的组 ，`(?: … )`查找 URL 的“指示符”。例如，一个指示符是`www`（后跟最多 3 位数字）。但是，您正在寻求一种*根本没有任何指示符*来识别 URL 的方法。因此，我们在上面所做的是添加了一个子句“*或空匹配*”作为“有效”指示符。 **这样做的结果是您的正则表达式现在的选择性降低了：各种字符串，不仅`example.com`还有`filename.txt`, `3.141593`, 和`omg...really`被识别为 URL！** 您唯一的其他（现成的）选项是对后缀更具选择性，例如需要特定的后缀（`com|org|net`)，但是这消除了原始正则表达式的一般性，它根本没有指定任何后缀。

换句话说，您可能面临逻辑的限制，而不是正则表达式编写技能或正则表达式语言本身的限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:58:13.967

请检查是否

```
var reg=/\b((?:[a-z][\w-]+:(?:\/*)|(?:www\d{0,3}[.])|[a-z0-9.\-]+[.][a-z]{2,4}\/{0,1})(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))*(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi; 
```

适合您的需求。www(anyNumber) 刚刚出现一或零次。抱歉第一个答案，没有注意到文字。

# database - 我应该如何创建这个数据库结构，认为我得到了一个幻想

> ID：10505458
> 
> 赞同：0
> 
> 时间：2012-05-08T19:49:49.563
> 
> 标签：database, nhibernate

我有一个 RESTful 服务器，用作手机游戏的服务器，我现在正在尝试创建一个数据库（使用 NHibernate），但我不确定如何在数据库中正确执行此操作

数据库中有用户，每个用户可以参与很多游戏，游戏是 QDGame 继承的超类（该类也有继承的子类，但这里不重要）所以一个玩家可以成为 10 个 QDGame 的一部分

我的困境是 X 数量的玩家可以成为一个游戏的一部分，所以我应该在列表类型的游戏中列出一个列表吗？我认为那是错误的，因为每个玩家都会有很多游戏并且每场游戏都会有很多玩家（Fantrap？）

那么我应该如何在许多用户之间共享许多游戏之间的链接呢？

![在此处输入图像描述](../Images/7ff03e7f313db053fd69254e7917839e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T04:15:58.300

如果我正确理解了您的问题，那么您正在这里寻找多对多关系

```
Users [UserId, ....]
Games [GameId, ...]
GameUsers[GameUserId, GameId, UserId, ...] 
```

# java - 编程模式 - 示例研究

> ID：10505469
> 
> 赞同：4
> 
> 时间：2012-05-08T19:50:23.447
> 
> 标签：java, design-patterns

我在测试中遇到了这个问题：

> 这是一种什么样的编程/设计模式：
> 
> ```
> FileReader fr = new FileReader("file.txt");
> BufferedReader bf = new BufferedReader(fr); 
> ```

很抱歉给您带来麻烦，但编程模式的定义对我来说还不清楚，我不知道如何正确回答这个问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-08T19:52:53.527

这是[装饰者模式](http://en.wikipedia.org/wiki/Decorator_pattern)的一个例子。

正如链接的维基百科文章所述：

> 装饰器模式是一种允许将行为动态添加到现有对象的设计模式。

在您的示例中，您正在向 a 添加缓冲`FileReader`，这比常规的未缓冲 提供更有效的读取`FileReader`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:59:55.527

这是`Decorator`模式。来自*设计模式*书：

> 意图：动态地为对象附加额外的职责。装饰器为扩展功能提供了一种灵活的替代子类的方法
> 
> ...
> 
> 适用性：使用装饰器
> 
> *   动态和透明地向单个对象添加职责，即不影响其他对象。
> *   对于可以撤销的责任。
> *   当通过子类化扩展不切实际时。有时大量的独立扩展是可能的，并且会产生大量的子类来支持每种组合。或者一个类定义可能被隐藏或不能用于子类化。

在 的情况下`BufferedReader`，它将缓冲功能附加到`FileReader`.

如果你想了解更多关于模式的知识，我推荐阅读这本书（或者更轻松的“Head First Patterns”）。**此外**，关于 JDK 中的模式使用的 SO 上有很好的[答案](https://stackoverflow.com/questions/1673841/examples-of-gof-design-patterns)——非常酷的东西！

# c# - DirectorySearcher.Filter 返回当月生日的用户

> ID：10505486
> 
> 赞同：1
> 
> 时间：2012-05-08T19:51:26.677
> 
> 标签：c#, ldap

我正在尝试查找所有在本月过生日的 AD 用户。我希望这是动态的，但无论如何。我是查询 ldap 的新手，我在编写过滤搜索的字符串时遇到了麻烦。目前我正在获取所有用户，然后使用 LINQ 对返回的用户列表进行排序，但我想我会尝试从 AD 搜索中返回用户。现在我有：

```
System.DirectoryServices.DirectoryEntry entry = new System.DirectoryServices.DirectoryEntry(_path, username, pwd);

System.DirectoryServices.DirectorySearcher mySearcher = new System.DirectoryServices.DirectorySearcher(entry);

mySearcher.Filter = ("(objectClass=user)"); 
```

我相信运行 AD 的人将他们的 B-days 简单地存储为格式为 MMDD 即 0508 的字符串。对此我无能为力（如果有更好的方法，我无能为力）。

那么解决这个问题的最佳方法是什么？

如果需要，附加代码：

```
 SortOption option = new SortOption("sAMAccountName", System.DirectoryServices.SortDirection.Ascending);

        mySearcher.Sort = option;

        DataSet ds = new DataSet();

        DataTable dtUsers = new DataTable("Users");

        dtUsers.Columns.Add("userid");

        dtUsers.Columns.Add("name");

        dtUsers.Columns.Add("birthday");

        dtUsers.Columns.Add("anniversary");

        dtUsers.Constraints.Add("UniqueUserId", dtUsers.Columns["userid"], true);

        foreach (System.DirectoryServices.SearchResult resEnt in mySearcher.FindAll())

        {

        System.DirectoryServices.DirectoryEntry de1 = resEnt.GetDirectoryEntry();

        DataRow drUser = dtUsers.NewRow();

        if (de1.Properties["sAMAccountName"].Value != null && de1.Properties["name"].Value != null && de1.Properties["employeeBirthDate"].Value != null && de1.Properties["employeeHireDate"].Value != null)

        {

        drUser["userid"] = de1.Properties["sAMAccountName"].Value.ToString();

        drUser["name"] = de1.Properties["name"].Value.ToString();
        drUser["birthday"] = de1.Properties["employeeBirthDate"].Value.ToString();
        drUser["anniversary"] = de1.Properties["employeeHireDate"].Value.ToString();

        dtUsers.Rows.Add(drUser);

        }

    }

    ds.Tables.Add(dtUsers); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:14:30.147

LDAP 客户端可以使用`substring`搜索过滤器来限制返回到搜索请求的条目。例如，过滤器`(&(objectClass=user)(birthday=05*))`将返回所有具有 的属性和以开头的属性`objectClass`的条目。如果使用此方法，应提前通知目录管理员，以确保正确索引生日属性。`user``birthday``05`

### 也可以看看

*   [LDAP：掌握搜索过滤器](http://ff1959.wordpress.com/2011/09/21/mastering-ldap-search-filters/)
*   [LDAP：搜索最佳实践](http://www.ldapguru.info/ldap/ldap-search-best-practices.html)
*   [LDAP：编程实践](http://ff1959.wordpress.com/2011/10/27/ldap-programming-best-practices/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:13:26.447

```
int now = DateTime.Now.Month;
                string month;
                if (now < 10)
                {
                    month = "0" + now.ToString();
                }
                else
                {
                    month = now.ToString();
                }

mySearcher.Filter = ("(&(objectClass=user)(|(employeeHireDate=" + month + "*)(employeeBirthDate=" + month + "*)))"); 
```

# php - 检查变量是否包含姓名和姓氏中的至少一个数字

> ID：10505487
> 
> 赞同：1
> 
> 时间：2012-05-08T19:51:28.137
> 
> 标签：php, validation

我想检查在此输入中的名字之后是否至少插入了一个数字。

因此，如果用户输入“joe”，它不会验证，但“joe d”或“joe doe”它会通过。

如何才能做到这一点？

```
$nome = $this->coalesce($form['nome']);
if (strlen($nome) > 0)
    $this->setValue('nome', strtoupper($nome));
else
    $this->addError('nome', 'Invalid name!'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:53:42.540

您可以使用正则表达式来执行此操作：

```
if( preg_match( '/\w+ \w+/', $name)) {
    echo "Validation passes!";
} else { 
    echo "Invalid input";
} 
```

您可以将正则表达式更改为`'/[A-Za-z]+ [A-Za-z]+/'`，因为`\w`将匹配的不仅仅是字母字符（它包括数字和下划线）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:53:34.603

应该这样做：

```
if(!preg_match('/[a-z]+\s+[a-z]+/i', $nome)) {
    $this->addError('nome', 'Invalid name!');
} 
```

这将验证由一串字母字符组成的名称，后跟一个空格，然后是另一个字母字符串。

# session - 尝试从 Session Scoped Bean 获取 .getSessionMap() 时出现 IllegalStateException

> ID：10505488
> 
> 赞同：1
> 
> 时间：2012-05-08T19:51:39.410
> 
> 标签：session, jsf, illegalstateexception, session-bean

我是 Java 和 JSF 的新手。我需要有关 IllegalStateException 的帮助。这是场景：

在我当前的项目中，我为应用程序菜单提供了这个 Session Scoped bean：

```
public final class MenuBean implements Serializable{  
    private MenuModel model;
    private FacesContext context = FacesContext.getCurrentInstance();

    public MenuModel getModel() {
        return model;
    }

    public MenuBean() {
        updateMenu();
    }

    public void updateMenu(){
        Map session = (Map<String,Object>) context.getExternalContext().getSessionMap();
        EUser user = (EUser) session.get(UserBean.USER_SESSION_KEY);

        ...
    }

    private MethodExpression createMethodExpression(String action) {  
        ...  
    }
} 
```

在我的逻辑上，我需要更新菜单，所以我这样做：

```
ExternalContext extContext = context.getExternalContext();
Map sMap = (Map<String,Object>) extContext.getSessionMap();

MenuBean menu = (MenuBean) sMap.get("menuBean");
menu.updateMenu(); 
```

bean 构造良好，但是当我尝试手动更新它时，如上所示，我在更新方法的第一行得到 IllegalStateException`updateMenu()`

我不明白出了什么问题，因为我可以在第一次构建菜单时使用相同的调用来获取会话映射。

此外，使用 NetBeans 调试器，我可以看到 MenuBean 的实例已正确恢复。

你们能帮帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T21:38:50.283

`FacesContext`存储在 HTTP 请求线程中。您绝对不应该将其声明并分配为实例的实例变量，该实例的寿命比 HTTP 请求长（最好也不要在它已经基于请求的情况下 - 这是糟糕的设计）。当`FacesContext`HTTP 请求完成时，实例被释放并失效。在任何后续 HTTP 请求中，该实例不再有效。有非法状态的手段。这解释了`IllegalStateException`你所看到的。

您需要**删除**以下行：

```
private FacesContext context = FacesContext.getCurrentInstance(); 
```

并修复您的代码以使其仅在方法块中使用线程本地：

```
Map<String, Object> sessionMap = FacesContext.getCurrentInstance().getExternalContext().getSessionMap();
// ... 
```

您始终可以将其分配为变量，但这应该只保留线程本地：

```
FacesContext context = FacesContext.getCurrentInstance();
Map<String, Object> sessionMap = context.getExternalContext().getSessionMap();
// ... 
```

* * *

**与具体问题**无关**`@ManagedProperty`，在这种特殊情况下使用起来更容易。**

 **```
public final class MenuBean implements Serializable {  

    @ManagedProperty("#{user}")
    private EUser user;

    // ...
} 
```

然后 JSF 将为您注入它。**

# jquery - jQuery 和 JQM - 使用最接近过滤器来获取索引

> ID：10505497
> 
> 赞同：0
> 
> 时间：2012-05-08T19:52:26.637
> 
> 标签：jquery, jquery-mobile, jquery-traversing

我有一段 html，当 JQM 完成它时，它看起来像这样（简化）：

```
<div id="servicesList">
    <div id="servicesHeader">Services</div>
    <ul data-role="listview" class="ui-listview">
        <li id="Serv1" class="serviceLink">Service 1</li>
    </ul>
    <ul data-role="listview" class="ui-listview">
        <li id="Serv2" class="serviceLink">Service 2</li>
    </ul>
</div> 
```

此代码是从另一段脚本动态生成的。

每个服务都有一个附加的点击事件，它可以动态地拉入更多数据。理想情况下，我希望能够在单击服务时引用它的索引。这是我当前的代码：

```
$('.serviceLink').click(function() {
    var index = $(this).closest("ul").index();
    servAnimate(index);
}); 
```

显然，这不起作用，因为拉入的对象数组包括 servicesHeader div。我如何才能只获得父 ul 的数组？本质上，当用户点击服务 1 时，返回的索引应该是 0，而不是 1。现在，索引 0 引用 servicesHeader div。

我也试过这个：

```
$(this).closest("ul").filter("ul").index(); 
```

任何帮助，将不胜感激！

编辑：我应该指定 HTML 是由另一个开发人员的脚本生成的。它可能会改变，也可能保持不变。到目前为止，我唯一的保证是 UL 将保持在同一级别，并且将具有类 serviceLink。

再说一遍，我如何只获取父 UL 的索引，而不管存在哪些其他兄弟元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:02:23.443

除非我忽略了您的要求中的某些内容，否则这是否符合要求？

```
$(function() {
    $('#servicesList .serviceLink').on('click', function() {
        alert($('.serviceLink').index(this));
    });
})​ 
```

这将在您单击服务 1 时返回 0，当您单击服务 2 时返回 1。

**更新**：这只会在主 div“servicesList”中找到“.serviceLinks”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T13:27:25.787

感觉自己像个失败者回答我自己的问题！

我已经习惯了只使用 index() 本身，以至于我忘记了你可以给它添加限定符。另外，我假设（并告诉所有回答者）我必须从单击的元素向后工作并找到它的位置。相反，我所做的是根据我知道不会更改的内容（容器 div ID 和每个链接周围的结构）构建元素列表，然后从那里获取单击元素的索引：

```
$('.serviceLink').click(function() {
    var index = $('#servicesList ul[data-role="listview"] li.serviceLink').index(this);
    servAnimate(index);
}); 
```

我感谢大家帮助解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T20:01:32.830

引入另一个仅包含服务列表的 DIV - 即 UL。然后，`.closest('div')`将找到这个新的 div，并且索引将从其中的零开始。

编辑：

试试这个：

```
$("#servicesList").on('click', 'ul', function() {
    var index = $(this).siblings("ul").andSelf().index(this);
    alert(index);
}); 
```

**[演示](http://jsfiddle.net/AdHz2/1/)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T20:11:49.213

有什么问题：

```
$('.serviceLink').click(function() {
    var index = $(this).closest("ul").index() - 1;
    alert(index);
});​ 
```

见[http://jsfiddle.net/u4Hy4/](http://jsfiddle.net/u4Hy4/)

# sql - 在 case 中嵌入 If 语句

> ID：10505505
> 
> 赞同：6
> 
> 时间：2012-05-08T19:53:24.087
> 
> 标签：sql, sql-server, tsql

如何在案例中嵌入和 if 语句。这就是我到目前为止所拥有的。

```
DECLARE @LDCCode as int
       DECLARE @InvoiceDate as datetime
       DECLARE @PaymentSemiMonthlyDays AS int
       SET @LDCCode = 20
       SET @InvoiceDate = '5/16/2012'
       DECLARE @InvDateDayMonth AS INT
       DECLARE @ReturnDate AS DATETIME
       SET @ReturnDate = @InvoiceDate
       DECLARE @PaymentDOM AS INT
       DECLARE @PaymentDays AS INT
       DECLARE @PaymentSemiMonthlyOffset AS INT

SET @ReturnDate = CASE WHEN NOT @PaymentDOM IS NULL THEN
   @ReturnDate + (@PaymentDOM - DATEPART(day, DateAdd(mm,1,@ReturnDate))) 
WHEN NOT @PaymentDays IS NULL THEN 
            DATEADD(Day,@PaymentDays,@ReturnDate)
WHEN NOT @PaymentSemiMonthlyOffset IS NULL THEN                     
    IF @LDCCode = 40 AND @InvDateDayMonth > 11 AND @InvDateDayMonth < 26 
       SELECT @ReturnDate + (@PaymentSemiMonthlyOffset - DATEPART(day, DateAdd(mm,1,@ReturnDate)))
    ELSE
       SELECT @ReturnDate + (@PaymentSemiMonthlyDays - DATEPART(day, DateAdd(mm,1,@ReturnDate)))    
    END 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-08T19:57:55.853

您不能以这种方式组合逻辑，但您可以添加一个嵌套`CASE`的现有`CASE`语句：

```
SET @ReturnDate = (CASE WHEN NOT @PaymentDOM IS NULL THEN
    @ReturnDate + (@PaymentDOM - DATEPART(day, DateAdd(mm,1,@ReturnDate))) 
WHEN NOT @PaymentDays IS NULL THEN 
    DATEADD(Day,@PaymentDays,@ReturnDate)
WHEN NOT @PaymentSemiMonthlyOffset IS NULL THEN
    CASE WHEN @LDCCode = 40 AND @InvDateDayMonth > 11 AND @InvDateDayMonth < 26 THEN
        @ReturnDate + (@PaymentSemiMonthlyOffset - DATEPART(day, DateAdd(mm,1,@ReturnDate)))
    ELSE
        @ReturnDate + (@PaymentSemiMonthlyDays - DATEPART(day, DateAdd(mm,1,@ReturnDate)))
    END   
END) 
```

但是，如果这是在存储过程中，我可能会选择更简单`IF/THEN/ELSE`的结构而不是`CASE`：

```
IF @PaymentDOM IS NULL
    SET @ReturnDate = @ReturnDate + (@PaymentDOM - DATEPART(day, DateAdd(mm, 1, @ReturnDate))) 
ELSE IF NOT @PaymentDays IS NULL
    SET @ReturnDate = DATEADD(Day,@PaymentDays,@ReturnDate)
ELSE IF NOT @PaymentSemiMonthlyOffset IS NULL
BEGIN
    IF @LDCCode = 40 AND @InvDateDayMonth > 11 AND @InvDateDayMonth < 26
        SET @ReturnDate = @ReturnDate + (@PaymentSemiMonthlyOffset - DATEPART(day, DateAdd(mm, 1, @ReturnDate)))
    ELSE
        SET @ReturnDate = @ReturnDate + (@PaymentSemiMonthlyDays - DATEPART(day, DateAdd(mm, 1, @ReturnDate)))
END 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T20:12:01.620

由于所有表达式都添加了一些东西，并且由于您多次`@ReturnDate`计算一个月中的哪一天，我认为这可以简化为：`@ReturnDate`

```
DECLARE @Plus1M INT;
SET @Plus1M = DATEPART(DAY, DATEADD(MONTH, 1, @ReturnDate));

SET @ReturnDate = DATEADD(DAY, 
  COALESCE(
    @PaymentDays, -- if @PaymentDays IS NULL, this will be skipped
    @PaymentDOM - @Plus1M,  -- if @PaymentDOM is NULL, this will be skipped
    CASE WHEN @PaymentSemiMonthlyOffset IS NOT NULL THEN
      CASE WHEN @LDCCode = 40 AND @InvDateDayMonth BETWEEN 12 AND 25
        THEN @PaymentSemiMonthlyOffset 
        ELSE @PaymentSemiMonthlyDays 
      END - @Plus1M
    END
  ), 
  @ReturnDate
); 
```

但是如果你想把它写成冗长和冗余的表达式，那么：

```
SET @ReturnDate = CASE 
  WHEN @PaymentDOM IS NOT NULL THEN
    DATEADD(DAY, @PaymentDOM 
    - DATEPART(DAY, DATEADD(MONTH, 1, @ReturnDate)), @ReturnDate) 
  WHEN @PaymentDays IS NOT NULL THEN 
    DATEADD(DAY, @PaymentDays, @ReturnDate)
  WHEN @PaymentSemiMonthlyOffset IS NOT NULL THEN
    CASE WHEN @LDCCode = 40 AND @InvDateDayMonth BETWEEN 12 AND 25 THEN
      DATEADD(DAY, @PaymentSemiMonthlyOffset 
      - DATEPART(DAY, DATEADD(MONTH, 1, @ReturnDate)), @ReturnDate)
    ELSE
      DATEADD(DAY, @PaymentSemiMonthlyDays 
      - DATEPART(DAY, DATEADD(MONTH, 1, @ReturnDate)), @ReturnDate)   
    END 
  END; 
```

但是很难验证，因为您现有的查询无法解析，并且您没有向我们展示示例数据或所需的结果。

我会避免使用`@Datetime + INT`速记，而宁愿拼出`DATEADD`操作，因为速记不适用于较新的类型（`DATE`,`DATETIME2`等）。我也会避免使用速记，`mm`因为其中一些缩写并不明显。另外三个字符使这一点更加明显。而且`NOT ...something... IS NULL`阅读起来也不是很直观。我宁愿说“灯不是红的”而不是“灯不是红的”。

# perl - 特殊变量是否在其他必需模块的函数调用中保持其存在？

> ID：10505509
> 
> 赞同：0
> 
> 时间：2012-05-08T19:53:32.680
> 
> 标签：perl, require

我不是 perl 专家，我不太了解 perl 的所有作用域规则是如何工作的。我正在设置一个 $ENV{'whatever'} 环境变量，然后我在另一个源 .pl 文件中调用一个函数并尝试读取该 ENV 条目，但我什么也没得到。文档到处都说 ENV 对于当前进程和任何分叉的子进程都存在，但是在其他源文件中是否可以访问 %ENV 变量？

源文件是通过“require”命令包含的。这是正确的方法，还是在需要源文件时如何使变量可用的静态（第一次）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T20:00:47.593

`%ENV`是一个全局的，因此它可以从加载到进程中的每个源文件的任何地方访问。

`%ENV`当使用 a 创建新进程时会*继承*`fork`它，但新进程会获得自己的副本，因此在一个进程中所做的任何更改都不会在另一个进程中可见。

如果您使用`do`or加载另一个源文件`require`，`use`那么它将被加载到同一个进程中，它会看到相同的`%ENV`.

但是，如果您使用`system`或加载新脚本，`exec`然后新脚本正在新进程中加载​​，它将获得自己的`%ENV`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:08:50.263

来自[`perldoc perlvar`](http://perldoc.perl.org/perlvar.html)：

> ```
> %ENV 
> ```
> 
> 哈希`%ENV`包含您当前的环境。`fork()`在 ENV 中设置一个值会更改您随后关闭的任何子进程的环境 。

* * *

`require`-ing .pl 文件与分叉命令不同。

通过 Bash 包装器设置必要的环境变量会更简单：

```
$ cat wrapper.sh
#!/bin/bash

export whatever="/usr/bin/some_dir/";  # Set to env

perl script.pl;                        # Invoke the script

$ cat script.pl
#!/usr/bin/perl

print $ENV{whatever};                  # wrapper.sh : "/usr/bin/some_dir/"
                                       # script.pl  : "" 
```

# jquery - jQuery Mobile 等待整个页面加载完毕

> ID：10505511
> 
> 赞同：1
> 
> 时间：2012-05-08T19:53:39.433
> 
> 标签：jquery, jquery-mobile

我对 jQuery Mobile 的问题是如何等到页面完全加载（所有图像、文本）后再实际加载它。澄清一下，一旦用户单击链接，加载图形会在页面加载时停留在屏幕上，一旦完全加载，隐藏加载图形并加载页面。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T00:19:10.917

```
$(document).on('click', '.my-custom-links', function() {
    //get the requested page
    $.ajax({
        url     : this.href,
        success : function (page) {
            //get only the first data-role="page" element
            var $page = $(page).find('[data-role="page"]').first();

            //now bind an event handler to all the elements that will need to load
            var $assets       = $page.find('img, script, link'),
                assets_loaded = 0;

            //make sure to bind to the load event before adding the element to the DOM
            $assets.on('load', function () {
                assets_loaded++;
                if (assets_loaded == $assets.length) {
                    //all the assets have loaded, so navigate to the new page
                    $.mobile.changePage($page);
                }
            });

            //add new page to the DOM
            $.mobile.pageContainer.append($page)
        },
        error   : function (jqXHR, textStatus, errorThrown) { /*Don't forget to handle errors*/ }
    });
    return false;
}); 
```

这是第一次破解。基本想法与@Kevin B. 评论的相差不远。劫持某些链接的点击，抓取链接目标的页面，将其添加到 DOM，然后仅在资产加载后才显示它。

# ruby-on-rails - 如何从模型中收集独特的对象

> ID：10505515
> 
> 赞同：0
> 
> 时间：2012-05-08T19:53:48.100
> 
> 标签：ruby-on-rails, ruby

我有模型“表演”，它有很多“表演”，表演有一定的“位置”。两场或多场演出可能在同一地点。

我正在寻找一种方法来获取节目表演使用的所有位置，但只需要一次（如果位置 X 有三场表演，我只需要获取 X 一次）。

编辑：我现在处于这种形式：对象数组`[[performance_id:1, location_id:1],[performance_id:2, location_id:1],[performance_id:3, location_id:2]]`。如何获得包含 [1,2] (唯一 location_id) 的数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:51:42.803

我在数组中添加了逗号：

```
[
  [performance_id:1, location_id:1],
  [performance_id:2, location_id:1],
  [performance_id:3, location_id:2]  ].flatten.map {|h| h[:location_id]}.uniq

 => [1, 2] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:56:33.770

不确定这是否适合你

```
show.performances.collect(&:location).uniq 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T20:01:11.880

大概是这样的

```
Location.joins(:performances).where(:performances => { :show_id => 5 }).group("locations.id") 
```

# css - 绝对定位元素，但在另一个元素的右侧

> ID：10505516
> 
> 赞同：2
> 
> 时间：2012-05-08T19:53:51.643
> 
> 标签：css

我正在尝试使用 HTML 和 CSS 在某些表单字段的右侧添加一个标注气泡。我不希望标注影响任何其他布局，所以我已经将它绝对定位，但我想以某种方式将它定位在另一个元素右侧一定距离处。

这基本上就是我所拥有的：

```
<ul>
    <dt><label>...</label></dt>
    <dd>
        <input ...>
        <span class='callout'>Helpful tip about this field</span>
    </dd>
</ul> 
```

和：

```
.callout {
    position: absolute;
} 
```

所以我想要`.callout`布局流程之外（因此`position:absolute`，但我希望它位于与之关联的输入字段的右侧（当然，事先不知道字段的宽度）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T19:56:42.963

您将要绝对相对于您的元素定位它。因此，将您的容器设置为位置：相对，并将您的标注设置为位置：绝对。Top/left 然后成为父元素的左上角。说得通？

这里有一个小提琴来说明这个概念：

[http://jsfiddle.net/tNCDK/](http://jsfiddle.net/tNCDK/)

HTML：

```
<div id="parent">
    <div id="child"></div>
</div> 
```

CSS：

```
#parent { 
  position: relative;
  border: solid 1px #000; 
  width: 200px; 
  height: 200px; 
}

#child { 
  position: absolute;
  top: 10px;
  right: -50px;
  border: solid 1px #000; 
  width: 50px; 
  height: 50px; 
} 
```

​​</p>

# cakephp - cakephp HABTM 协会 saveAll？

> ID：10505521
> 
> 赞同：0
> 
> 时间：2012-05-08T19:54:00.260
> 
> 标签：cakephp, has-and-belongs-to-many

我有两个表和一个连接表。我尝试使用 $hasAndBelongsToMany 但它没有用，所以我为连接表创建了一个模型并使用。

```
User hasMany Membership
Membership belongsTo User, Club
Club hasMany Membership. 
```

我有一个保存到两个表的表格。

```
function dashboard_add(){

        $user = $this->Session->read('User');

        $register = false;

        if (!empty($this->data)) {

                if($this->Club->saveAll($this->data)){
                    $this->Session->setFlash(__('You have registered your club. You will be contacted soon!', true), 'default', array('class' => 'success'));
                    $this->redirect(array('action' => 'index'));
                } else {   
                    $this->Session->setFlash(__('There was a problem with your registration. Please, try again.', true), 'default', array('class' => 'warning'));
                }

        }

        if (empty($this->data)) {
            $this->data = $this->User->read(null, $user['User']['id']);
        }

        $this->set(compact('register'));

    } 
```

用户模型有

```
var $hasMany = array(
        'Membership' => array(
            'className' => 'Membership',
            'foreignKey' => 'user_id'
        )
    ); 
```

会员模型有

```
var $belongsTo = array('User','Membership'); 
```

俱乐部模型有

```
var $hasMany = array(
        'Membership' => array(
            'className' => 'Membership',
            'foreignKey' => 'club_id'
        ),
        'Upload' => array(
            'className' => 'Upload',
            'foreignKey' => 'club_id'
        )
    ); 
```

我没有收到任何错误。俱乐部表填充，但成员和用户表不插入/更新。

**更新：调试($this->Club->save($this->data));**

```
Array
(
    [User] => Array
        (
            [id] => 1
            [first_name] => this
            [last_name] => that
            [company_name] => other
            [city] => this
            [state] => that
            [zip] => other
            [telephone] => that
            [email_address] => this
        )

    [Club] => Array
        (
            [address] => fvdfvx
            [title] => xcvxcv
            [category] => xcvxcv
            [modified] => 2012-05-03 06:31:12
        )

) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T23:24:44.213

我假设您使用的是 cakePHP 1.3.x。请参阅文档以了解 cake 如何同时保存多个模型，您需要生成一个包含所有模型的数组来保存.. 例如：

```
Array
(
    [Article] => Array
        (
            [title] => My first article
        )
    [Comment] => Array
        (
            [0] => Array
                (
                    [comment] => Comment 1
            [user_id] => 1
                )
        [1] => Array
                (
                    [comment] => Comment 2
            [user_id] => 2
                )
        )
) 
```

[http://book.cakephp.org/1.3/view/1031/Saving-Your-Data](http://book.cakephp.org/1.3/view/1031/Saving-Your-Data)

显然，在您的 $this->data 中，您只有一个简单的数组 [User]。而不是像示例中那样保存多个数组。

我希望我有所帮助。问候。

# java - 当一个 Web 服务连接到另一个 Web 服务时出现 ServiceConstructionException

> ID：10505532
> 
> 赞同：2
> 
> 时间：2012-05-08T19:54:37.137
> 
> 标签：java, web-services, jboss, wsdl

我有 2 个 Web 服务，当我用客户端测试它们时，它们都可以正常工作。但是当我尝试从另一个 Web 服务构建到一个 Web 服务的端口时，JBOSS 会爆炸，但有几个例外：

> 向类 pt.ist.anacom.shared.security.SecurityInitListener 的侦听器实例发送上下文初始化事件的异常：javax.xml.ws.WebServiceException：org.apache.cxf.service.factory.ServiceConstructionException：创建服务失败。

引起的

> org.apache.cxf.service.factory.ServiceConstructionException：创建服务失败。

引起的

> javax.wsdl.WSDLException: WSDLException: faultCode=PARSER_ERROR: java.lang.ClassCastException: org.apache.xerces.parsers.XIncludeAwareParserConfiguration 不能转换为 org.apache.xerces.xni.parser.XMLParserConfiguration

造成的：

> java.lang.ClassCastException：org.apache.xerces.parsers.XIncludeAwareParserConfiguration 不能转换为 org.apache.xerces.xni.parser.XMLParserConfiguration

所以我有 Web 服务 A 和 Web 服务 B。我部署 Web 服务 A，然后在我的 Web 服务 B 的上下文侦听器上添加：

```
org.stubs.WebServiceA_Service service = new org.stubs.WebServiceA_Service(); // EXPLODES HERE
org.stubs.WebServiceA web = service.getWebServiceAPort(); //never runs this line, crashes before 
```

这两个 Web 服务都是首先实现的（自下而上？），这意味着我定义了 WebService 类，部署它（JBOSS 自动生成 wsdl），然后我使用它。

当我从测试客户端访问 webserviceA 时，它工作正常，但当我尝试从 WebServiceB 访问它时却不行。

我已经为此失去了几天，并尝试了几乎所有我能做的事情..所以任何帮助都非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:26:47.643

在将 Web 服务部署到 WebLogic 服务器的多个案例中，我遇到了同样的问题，问题是服务器类路径上的 xerces 库与 Web 服务实例中包含的库之间的版本冲突。

在一种情况下，解决方案是避免将 xerces 库包含在 Web 服务应用程序中（如果恰好是您的引擎，则在 maven pom 中为 xerces 库指示范围“提供”）。另一方面，解决方案是使用（weblogic 的）过滤类加载器功能来指导服务器使用应用程序中包含的 xerces 库而不是服务器的实现。

根据您的问题，我在 jboss 中查找了此功能并找到了这篇文章： http: [//www.mastertheboss.com/jboss-application-server/223-solving-jboss-5-classloading-issues.html](http://www.mastertheboss.com/jboss-application-server/223-solving-jboss-5-classloading-issues.html)

希望这会有所帮助...

# android - 使用 HierarchyViewer 加载活动时出错

> ID：10505538
> 
> 赞同：4
> 
> 时间：2012-05-08T19:54:49.450
> 
> 标签：android, android-layout

我尝试使用 HierarchyViewer 检查布局，但它没有加载。首先，我尝试使用模拟器，但由于它无法正常工作，然后我尝试使用[ViewServer](https://github.com/romainguy/ViewServer)

使用模拟器它会静默失败，但使用 ViewServer 我可以获得堆栈跟踪：

```
W/dalvikvm(459): Unable to match class for part: 'Landroid/view/accessibility/AccessibilityNodeInfo;)V'
 W/View(459): Problem dumping the view:
 W/View(459): java.lang.NoSuchMethodException
 W/View(459):   at java.lang.Class.getDeclaredMethods(Native Method)
 W/View(459):   at java.lang.ClassCache.getDeclaredMethods(ClassCache.java:140)
 W/View(459):   at java.lang.Class.getDeclaredMethods(Class.java:757)
 W/View(459):   at android.view.ViewDebug.getExportedPropertyMethods(ViewDebug.java:1331)
 W/View(459):   at android.view.ViewDebug.exportMethods(ViewDebug.java:1372)
 W/View(459):   at android.view.ViewDebug.dumpViewProperties(ViewDebug.java:1364)
 W/View(459):   at android.view.ViewDebug.dumpViewProperties(ViewDebug.java:1354)
 W/View(459):   at android.view.ViewDebug.dumpViewWithProperties(ViewDebug.java:1270)
 W/View(459):   at android.view.ViewDebug.dumpViewHierarchyWithProperties(ViewDebug.java:1244)
 W/View(459):   at android.view.ViewDebug.dumpViewHierarchyWithProperties(ViewDebug.java:1252)
 W/View(459):   at android.view.ViewDebug.dumpViewHierarchyWithProperties(ViewDebug.java:1252)
 W/View(459):   at android.view.ViewDebug.dumpViewHierarchyWithProperties(ViewDebug.java:1252)
 W/View(459):   at android.view.ViewDebug.dumpViewHierarchyWithProperties(ViewDebug.java:1252)
 W/View(459):   at android.view.ViewDebug.dumpViewHierarchyWithProperties(ViewDebug.java:1252)
 W/View(459):   at android.view.ViewDebug.dumpViewHierarchyWithProperties(ViewDebug.java:1252)
 W/View(459):   at android.view.ViewDebug.dumpViewHierarchyWithProperties(ViewDebug.java:1252)
 W/View(459):   at android.view.ViewDebug.dump(ViewDebug.java:1204)
 W/View(459):   at android.view.ViewDebug.dispatchCommand(ViewDebug.java:863)
 W/View(459):   at android.view.ViewRoot$W.executeCommand(ViewRoot.java:3070)
 W/View(459):   at android.view.IWindow$Stub.onTransact(IWindow.java:65)
 W/View(459):   at android.os.Binder.execTransact(Binder.java:320)
 W/View(459):   at dalvik.system.NativeStart.run(Native Method) 
```

关于会发生什么的任何想法？我不知道它是否相关，但该应用程序在 ICS 设备上运行并使用带有 SherlockBar 的支持库

# php - Wordpress 类别挂钩

> ID：10505554
> 
> 赞同：1
> 
> 时间：2012-05-08T19:55:30.707
> 
> 标签：php, html, css, wordpress

所以我需要当用户编辑一个类别时，我想添加另一个文本字段，以便用户可以为该类别设置颜色，这可行吗？我将上传一张图片，以便您了解我的意思![在此处输入图像描述](../Images/c690cceae2445bb00221cacdb7779ecc.png)

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T20:32:21.040

你不会在你想要的地方得到新的字段，但是你去。将其放在您的 functions.php 文件中，为您的类别提供黑色或白色的颜色选择：

```
<?php
add_action('edit_category_form', 'add_extra_fields');
add_action('edited_category', 'save_extra_fields');
function add_extra_fields($tag)
{
    $colors = array('Black' => '000', 'White' => 'FFF');
    $selected = get_option('category_'.$tag->term_id.'_color');
    echo '<select name="cat_color">';
    foreach($colors as $name => $hex)
    {
        echo '<option value="'.$hex.'"'.($hex == $selected ? ' selected="selected"' : '').'>'.$name.'</option>';
    }
    echo '</select>';
}
function save_extra_fields($term_id)
{
    if($_POST['cat_color'])
    {
        update_option('category_'.$term_id.'_color', $_POST['cat_color']);
    }
}
?> 
```

您可以根据需要向颜色数组添加更多标签和值。

# logging - Nginx 与 /var/log 在 tmpfs

> ID：10505555
> 
> 赞同：1
> 
> 时间：2012-05-08T19:55:35.237
> 
> 标签：logging, nginx, tmpfs

我将开发机器设置为将 tmpfs 用于 /var/log。鉴于此，在每次启动时，内容都是空白的，并且逐渐填充了记录其胆量时创建的任何进程。

问题是（根据我对错误消息的解释）：nginx 非常不愿意创建自己的日志目录（在这种情况下是 /var/log/nginx），所以在启动过程中它不断向我抛出错误：

```
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
2012/05/08 21:42:35 [emerg] 2368#0: open() "/var/log/nginx/error.log" failed (2: No such file or directory)
nginx: configuration file /etc/nginx/nginx.conf test failed 
```

一旦我创建了目录，一切都很好。有没有办法告诉 nginx（至少尝试）创建日志目录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-02-11T15:42:52.227

作为脚本 /etc/init.d/nginx 中 do_start 函数的第一行，添加以下命令：

```
# Create the folder "nginx" in /var/log otherwise nginx can't start
mkdir -p /var/log/nginx 
```

我不喜欢这个解决方案，但这也是我发现的最简单/最快的解决方案。

问候

编辑 - 如果使用 Debian，init.d 脚本有点不同。“mkdir”行就在“start”行之后：

```
start)
    mkdir -p /var/log/nginx 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-07T23:15:17.060

我意识到这个线程比小行星上的泥土还要古老，但我想在这里包含这个答案，以便为后代勇敢的搜索者提供，这样他们就可以避免我刚刚让自己经历的辛勤工作。

如果您收到以下消息：

```
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
2012/05/08 21:42:35 [emerg] 2368#0: open() "/var/log/nginx/error.log" failed (2: No such file or directory)
nginx: configuration file /etc/nginx/nginx.conf test failed 
```

**确保您的 var/log 文件夹未设置为 tmpfs！！！！** 我已经设置了这种方式来减少对系统中 SD 卡的写入，这意味着每次 nginx 启动时，它都无法在 /var/log/nginx 找到日志或 nginx 文件夹 - 所以它失败了并退出。如果在 /etc/fstab 中看到 /var/log 输入，将其注释掉，重新启动，手动创建一次 nginx 文件夹（我还手动创建了 error.log 和 access.log（空白文件））并重新启动 nginx 服务。从那时起，您的 nginx 服务器将运行良好（除非您执行其他操作来破坏它，但那是另一个线程）。

# javascript - 在动态创建的文本框中格式化文本

> ID：10505557
> 
> 赞同：0
> 
> 时间：2012-05-08T19:55:36.787
> 
> 标签：javascript, jquery

我有生成具有不同 id 的文本区域的 jquery。现在我需要制作一些按钮来格式化文本区域内的文本。例如：当用户点击某个文本区域，输入文本，然后单击“粗体”按钮，只有该文本区域内的文本会变为粗体（在其他会正常）。我确实设法用 JS 制作了这样的东西，但它太原始了（文本在所有文本框中都被格式化）:( 以下是一些示例代码：

```
<button id="bold">B</button>
<textarea id="ta_1">Some test text</textarea>
<textarea id="ta_2">Some test text</textarea> 
```

我想说的是：一个按钮，多个文本框。在 ta_1 中输入文本并单击粗体，应该只加粗该 txtarea 中的文本。附加信息：所有 id 都以相同的单词开头，最后的数字不同。

我觉得有一些简单的解决方案，只是想不通：D

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:04:50.343

实际上这是一个非常糟糕的做法，但你可以这样做，

```
var activeEl;

$("textarea").focus(function() {
  activeEl = $(this);
});

$("#bold").click(function() {
  $("textarea").css("font-weight", "");
  activeEl.css("font-weight","bold");
}); 
```

[​​演示](http://jsfiddle.net/CXzFv/1)

**UPDATE-1：**我不知道你为什么要这样做，但我建议你使用像[elRTE这样的所见即所得编辑器](http://elrte.org/)

**UPDATE-2**：您可以在 elRTE 中定制您的工具栏，如果您希望您的编辑器只有一个“粗体”按钮，是的，您可以这样做，

```
$(document).ready(function() {
    elRTE.prototype.options.panels.web2pyPanel = ['bold'];
    elRTE.prototype.options.toolbars.web2pyToolbar = ['web2pyPanel'];
    var opts = {
        toolbar: 'web2pyToolbar',
    }
    var rte = $('#our-element').elrte(opts);
});​ 
```

[elRTE 演示](http://jsfiddle.net/T7vtW/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:01:13.573

使用 document.activeElement

```
var activeEl;
$('#bold').mousedown(function()
{
     activeEl = document.activeElement

});
$("#bold").click(function() {

  //check activeElement
  if(......){
      activeEl .css("font-weight","bold");
  }
}); 
```

不要忘记检查 activeElement 是否完全是 textarea

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T20:10:29.500

我不确定这对于用户功能来说是一个好主意，但可以做到。您只需要在某处记录“活动文本区域”。我建议使用`.data()`. [jsFiddle](http://jsfiddle.net/nzVKF/12/)

```
//disable the button until we have a target textarea to avoid confusion
$('#bold').attr('disabled','disabled');

//Record a new 'activeElement' each time user focuses a textarea
$('textarea').focus(function(e){
    $('#bold').data('activeElement',e.target)
        .removeAttr('disabled');//this first time we will enable the bold button
});

//retrieve the stored 'activeElement' and do something to it
$('#bold').click(function(){
    var activeElement = $('#bold').data('activeElement');
    $(activeElement).css('font-weight','bold');
}); 
```

大多数人希望“文本格式”按钮能够处理他们的选择。选择和范围超出了 jQuery 的范围，并且使用起来非常复杂。正如已经建议的那样，我建议使用许多精彩的 WYSIWYG 之一，例如[tinyMCE](http://www.tinymce.com/)。

# jquery - 如何使图像从屏幕之外出现？

> ID：10505558
> 
> 赞同：0
> 
> 时间：2012-05-08T19:55:36.730
> 
> 标签：jquery, html, css

我有一张图片，它实际上是带有 facebook“like”按钮的图片 :)。

当我将页面向下滚动到底部时，我希望它从屏幕右侧滑出。怎么做？

也许jQuery？但是怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:00:33.610

给图像一个`left`大于窗口宽度的 css 位置。比使用例如 jQuery.animate 来移动它。

HTML：

```
<img src="http://www.vpul.upenn.edu/platthouse/files/FB_button_1.jpg"> 
```

CSS：

```
img {
  position: absolute;
  left: 1000px;
}
body{
  overflow: hidden;
} 
```

JS：

```
setTimeout(function(){$('img').animate({left: 10}, 500)}, 1000); 
```

例子：

[jsfiddle](http://jsfiddle.net/snies/mRESg/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T10:08:27.020

我认为[这个](http://jsfiddle.net/LQS7D/)jsfiddle 可以满足您的要求。

当用户向下滚动 100 像素并且（通常被遗忘）时，当用户向上滚动时，该按钮会被 jQuery 动画化。

```
$(document).ready(function () {
    var like = $('#fblike');

    $(window).scroll(function () {
        if ($(document).scrollTop() > 100) {
            like.animate({
                opacity: 1,
                right: 5
            }, 300);
        }
        else {
                like.animate({
                opacity: 0,
                right: -60
                }, 200);
        }        
    });
});​ 
```

# c# - 如何使用 ObservableCollection 从 ViewModel 刷新 UI？

> ID：10505561
> 
> 赞同：19
> 
> 时间：2012-05-08T19:56:02.540
> 
> 标签：c#, wpf, mvvm

我有一个列表框，其中包含绑定到 ObservableCollection 的项目。

现在，在 viewModel 中，我需要更新 UI。我没有从我的视图模型中引用列表框。

如果我从我的 ObservableCollection 中删除或添加一个项目，则 ui 会更新。

基于其他一些逻辑，我需要更新 UI ......但 ObservableCollection 是相同的。

如何在不从我的 ObservableCollection 添加或删除项目的情况下更新 UI？

谢谢

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2016-04-23T13:23:26.583

我有一个类似的问题，我想更改项目的背景，但显然项目和集合都没有改变。

它是通过调用实现的：

```
CollectionViewSource.GetDefaultView(your_collection_name).Refresh(); 
```

这在不改变集合的情况下刷新了视图模型中的视图

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-05-08T20:05:17.467

如果您因为编辑了集合*中*的项目而需要更改 UI ，那么您应该安排这些项目来实现`INotifyPropertyChanged`接口。如果您的集合中的对象有一个`PropertyChanged`事件，那么 UI 将从各个项目中侦听该事件。（如果可能，您还可以将集合中的项目更改为`DependencyObjects`with `DependencyProperties`，这可以实现相同的目标。）

如果您*确实*需要*在您的集合没有任何*更改时触发 UI 更新，那么执行此操作的方法是手动引发`CollectionChanged`事件。这不能按`ObservableCollection<>`原样完成，但您可以从该类派生一个新集合，并`protected OnCollectionChanged`从某个新方法中调用该`public`方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-04-29T09:38:42.403

这是扩展方法的一个很好的例子。它隐藏了实现，以防它在将来的版本中发生变化，可以在一个地方进行修改，并且调用代码看起来更简单且不那么混乱。

```
public static void Refresh<T>(this ObservableCollection<T> value)
{
    CollectionViewSource.GetDefaultView(value).Refresh();
} 
```

用法：

```
myCollection.Refresh(); 
```

# asp.net - 从 Silver Light 提交 froms 到 asp.net 页面

> ID：10505564
> 
> 赞同：0
> 
> 时间：2012-05-08T19:56:07.997
> 
> 标签：asp.net, silverlight, forms, submit

我是 silverlight 的新手，是否可以在 silver light 应用程序中提交 from from with 。我想在 asp.net 中使用 silverlight 控件，它们看起来比 asp.net 控件好得多。如何在 silverlight 5 中执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-12T18:26:54.353

我相信您现在已经得到了答案，但是对于后来的读者，我发现这种方式是在 Silverlight 中执行此操作的最佳方式。这样您就不需要任何 aspx 页面，您可以直接从 silverlight 创建和提交 html 页面。

它将使用 Silverlight 浏览器互操作以编程方式创建 HTML 表单并为其设置元素。

```
//Creates a blank html document
var htmldoc = System.Windows.Browser.HtmlPage.Document;
// Returns a Reference type to the body of html page
var body = htmldoc.Body;

// Create a <form> element and add it to the body
var newForm = htmldoc.CreateElement("form");
newForm.SetAttribute("action", targetUrl);
newForm.SetAttribute("method", "post");
body.AppendChild(newForm);

//Add your elements to your form
HtmlElement input1 = htmldoc.CreateElement("input");
input1.SetAttribute("type", "hidden");
input1.SetAttribute("name", "someName");
input1.SetAttribute("value", "someValue");
newForm.AppendChild(input1);

//submit your form
newForm.Invoke("submit"); 
```

这么简单！

原答案：[这个答案](https://stackoverflow.com/questions/9175910/navigate-and-post-data-from-silverlight)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:47:32.257

您可以通过从 silverlight 控件调用的 javascript 函数调用 form.submit() [http://msdn.microsoft.com/en-us/library/cc221359%28v=VS.95%29.aspx](http://msdn.microsoft.com/en-us/library/cc221359%28v=VS.95%29.aspx)

你也可以导航：HtmlPage.Window.Navigate(url)

# javascript - jsTree从按钮创建节点

> ID：10505568
> 
> 赞同：0
> 
> 时间：2012-05-08T19:56:16.900
> 
> 标签：javascript, jquery, ajax, jstree

当我尝试创建节点时，我遇到了特定的麻烦。从上下文菜单中一切都会好起来的，但是当我从按钮调用创建事件时，我没有 AJAX 请求。

看：

```
 bind("create.jstree", function (e, data) {
    console.log('creating');

    $.ajax({
        type: 'post',
        url: '/item/add',
        data: {
            name:  data.rslt.name,
            id_menu_content_parent: data.rslt.parent.attr("id").replace("node_",""),
            id_type_object: data.rslt.obj.attr("rel")
        },
        success: function (dataItem){
        }
    });
    console.log('end');
}); 
```

现在，当我从上下文菜单调用正常时，我看到 sting created *，*下一个 AJAX 请求，最后是字符串结束，但是当我单击按钮时，我**只**看到字符串*创建*，仅此而已。

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T21:22:57.253

当从上下文菜单调用时创建工作但使用按钮调用时不起作用的最可能原因是，对于上下文菜单，您可能在调用创建回调时选择了一个树节点。但是，当您从按钮调用创建回调时，您可能不一定选择了节点。这很可能会导致您的`$.ajax`调用失败，因为它试图引用未定义的属性。具体来说，`data.rslt.parent.attr("id")`将失败，因为如果您没有选择节点，您的新节点将在父级别创建，因此`data.rslt.parent`值为`-1`. 这应该可以解释为什么您没有看到您的`console.log('end')`输出。

从你的问题我猜你没有使用调试器来调试你的javascript。如果你打算做任何严肃的开发，你不能依赖`printf`样式调试，特别是因为你的浏览器可能已经有一个 javascript 调试器。如果您通过调试器运行代码，您将能够立即在帖子中看到导致问题的原因。学习有效地使用调试器可能需要一段时间，但它会为您节省更多时间并帮助您编写更好的代码。

顺便说一句，我建议您在 FireFox 中使用 Firebugs 或 Chrome 调试您的代码，因为这两种浏览器都提供了很好的开发工具。

# mysql - 为什么我会出现转义错误？

> ID：10505569
> 
> 赞同：0
> 
> 时间：2012-05-08T19:56:18.360
> 
> 标签：mysql, perl

我编写了一个非常简单的 Perl 脚本，其中包含以下行。

```
my $q_it = $dbh->prepare('SELECT customdata.Field_ID,
  customdata.Record_ID,
  customdata.StringValue
  FROM customdata
  WHERE customdata.Field_ID='\'10012'\' && (StringValue LIKE '\'1%'\' OR StringValue LIKE   '\'2%'\' OR StringValue LIKE '\'9%'\');
  '); 
```

其中 customdata 是一个表。

但是，我总是遇到语法错误，抱怨“WHERER”子句：

```
Backslash found where operator expected at /home/wblocaladmin/Robert_2.pl line 18, near "'10012'\" 
```

由于它是引用语句中的引用，所以我尝试像上面那样转义单引号。有没有人能帮我找出哪里出错了？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T19:58:07.653

为什么不只使用双引号将字符串括起来？

```
my $q_it = $dbh->prepare("SELECT customdata.Field_ID,
  customdata.Record_ID,
  customdata.StringValue
  FROM customdata
  WHERE customdata.Field_ID='10012' && (StringValue LIKE '1%' OR StringValue LIKE   '2%' OR StringValue LIKE '9%');
  "); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T20:02:37.063

使用[q](http://perldoc.perl.org/perlop.html#Quote-Like-Operators)引用带有单引号的字符串：

```
my $q_it = $dbh->prepare(q{SELECT customdata.Field_ID,
   customdata.Record_ID,
   customdata.StringValue
   FROM customdata
   WHERE customdata.Field_ID='10012' 
   && (StringValue LIKE '1%' OR StringValue LIKE   '2%' OR StringValue LIKE '9%')
}); 
```

您还可以使用 heredocs：

```
my $q = <<'QUERY';
    SELECT customdata.Field_ID,
    customdata.Record_ID,
    customdata.StringValue
    FROM customdata
    WHERE customdata.Field_ID='10012' 
    && (StringValue LIKE '1%' OR StringValue LIKE   '2%' OR StringValue LIKE '9%')
QUERY
my $q_it = $dbh->prepare( $q ); 
```

注意：我删除了分号，因为它不属于 DBI 查询。

作为记录，在 perl 中连接的正确方法是：

```
my $string = 'foo' . 'bar'; ## foobar 
```

在 perl 中进行分隔的正确方法是：

```
my $string = 'foo \'bar\''; ## foo 'bar' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-08T20:00:29.480

作为[aleroot's answer](https://stackoverflow.com/a/10505594/29995)的替代方案，您可以修复您的报价转义。您的转义引号周围有不必要的单引号。

```
my $q_it = $dbh->prepare('SELECT customdata.Field_ID,
  customdata.Record_ID,
  customdata.StringValue
  FROM customdata
  WHERE customdata.Field_ID=\'10012\' && (StringValue LIKE \'1%\' OR StringValue LIKE   \'2%\' OR StringValue LIKE \'9%\');
  '); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T19:59:39.420

您可以使用双引号来减轻痛苦，但这里的问题是您只是在不使用`.`(dot) 运算符的情况下连接字符串。

# qt - 设计现代桌面 GUI

> ID：10505572
> 
> 赞同：1
> 
> 时间：2012-05-08T19:56:34.973
> 
> 标签：qt, user-interface, qt4, qtstylesheets

我想开发一个桌面程序，最重要的标准之一是拥有出色的用户界面——无论是在可用性方面还是在风格方面。当我说风格时，我指的是通常与 Android/Apple 应用程序相关联的很酷的设计（和效果）。我希望设计一个与 Chris Granger 为 Light Table 设计的用户界面类似（或受其启发）的用户界面。这是 Light Table 的链接：[http](http://www.kickstarter.com/projects/ibdknox/light-table) ://www.kickstarter.com/projects/ibdknox/light-table 甚至 Autodesk Maya 也是使用 Qt 设计的。

另外，我希望通过拖放方法来设计界面，所以我很快完成了界面部分，然后转到程序的其他重要部分。我使用过 Java Swing 和 AWT。但是它们提供了原生接口，这些接口很好并且易于使用，但不符合风格/酷的因素。所以我尝试了Qt。我觉得 Qt 是对 Swing 的重大改进。但作为新手，我无法判断它的全部功能。VLC 和 Maya 的界面是用 Qt 设计的，所以我知道 Qt 是要走的路。现在，Qt 提供了两个主要的 UI 设计工具——Qt Designer 和 Qt Quick。他们的文档和网站说 Qt Designer 应该用于桌面应用程序，它会给你一个原生风格的界面。但我不想要原生风格的界面。另一方面，Qt Quick，

**是否可以使用 Qt Quick 进行桌面 UI 设计？**

**或者，是否可以从 Qt Designer 中提取出我希望实现的那种设计？**

我也喜欢 Autodesk Maya 的界面设计，并希望给我的程序带来这种感觉。此外，是否有其他或更好的跨平台 UI 设计工具。我选择 Qt 的另一个原因是它是跨平台的。我希望我的程序同样可以在 Linux/Windows/Mac 上运行。

# php - 在不拆分单词的情况下限制 PHP 中标题的字符数

> ID：10505576
> 
> 赞同：0
> 
> 时间：2012-05-08T19:56:52.147
> 
> 标签：php, seo, title

> **可能重复：**
> [缩短 PHP 中的字符串（仅限完整单词）](https://stackoverflow.com/questions/972010/shorten-string-in-php-full-words-only)
> [如何从字符串中获取前 x 个字符，而不切断最后一个单词？](https://stackoverflow.com/questions/1104306/how-to-get-first-x-chars-from-a-string-without-cutting-off-the-last-word)

很像这个问题：[如何使用 PHP 限制标题标签的长度](https://stackoverflow.com/questions/10505165/how-to-limit-the-length-of-the-title-tag-using-php)

...答案类似于：

```
 [title]  ?php echo substr( $mytitle, 0, 70 );  [/title] 
```

...但是有没有办法在解决方案不会将任何单词减半的情况下做到这一点？那么如果单词部分超过字符数的限制，解决方案会删除整个单词，而不是限制在字符数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:05:15.860

这可能会让你达到 95%，但这并不完美......

```
$mytitle = 'How to Limit the Length of the Title Tag using PHP';
$arr = explode(' ',$mytitle);
$string = '';

foreach($arr as $word) {
    if(strlen($string) > 69) break;
    $string .= ' ' . $word;
}

echo $string; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:04:18.627

以下可能是更容易实施的解决方案之一，但它不是最有效的。

看看[`wordwrap`](http://no.php.net/manual/en/function.wordwrap.php)哪个将您的字符串拆分为多行而不会破坏单词。然后，您可以使用例如换行将其拆分为结果字符串。`explode("\n", $var, 2)`得到第一行，这将是你的标题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T20:06:09.063

一个有点有趣的，如果不是最佳的解决方案（未经测试，但你应该明白）：

```
$wrapped = wordwrap($mytitle, 70, "ENDOFTITLE")
$truncated = substr($wrapped, 0, strpos($wrapped, "ENDOFTITLE")); 
```

不过，重复问题的答案会提供更好的解决方案。

# jsf - JSF + Primefaces - 动态包含

> ID：10505581
> 
> 赞同：0
> 
> 时间：2012-05-08T19:57:16.930
> 
> 标签：jsf, dynamic, include, primefaces, tabview

首先，对不起我的英语^^我在我的结构中遇到了动态包含的问题。

我有一个选项卡视图，选项卡是动态构建的。选项卡是由不同的命令按钮创建的，在我的一个 bean 中，放在选项卡的一个 ArrayList 中

这是标签视图：

```
<p:tabView value="#{indexBean.tabs}" var="tab" id="tabView" activeIndex="#{indexBean.selectedNewTab}" 
```

这些是标签：

```
<p:tab title="#{tab.title}" closable="#{tab.closable}"> 
```

在选项卡中，我有不同的 . 我只有一个如此定义的选项卡：

```
<ui:include src="content/accordion.xhtml"/> 
<ui:include src="content/toolbar.xhtml"/>
<ui:include src="content/dataTableRawResults.xhtml"/> 
<ui:include src="content/dataTableCurves.xhtml"/> 
<ui:include src="content/dataTableReports.xhtml"/> 
<ui:include src="content/dataTableAdvancedStatistics.xhtml"/> 
```

包含的每个页面都有一个渲染标签（在我的 bean 中，我设置了不同的布尔值，以便我可以根据需要专门化每一个......）

这很好..除了一个问题......它太慢了！！

我想是因为渲染..所以我尝试了不同的方法来解决它..

我尝试使用 .. 使用 .. 的 src 标记中的查询。但似乎没有任何效果。使用查询，我正确打开了第一个选项卡。但是当我打开第二个选项卡时，第一个选项卡与第二个选项卡相同一个（就像它的属性已被覆盖）..

谢谢大家！

如果我没有很好地解释，请问我，我会尽量准确！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T10:13:09.843

如果它太慢，也许你可以尝试通过向你的 p:tabView 添加属性 dynamic="true" 来动态加载选项卡：

```
<p:tabView dynamic=true ... > 
```

# javascript - ios - 将文本注入 UIWebView 文本字段

> ID：10505585
> 
> 赞同：1
> 
> 时间：2012-05-08T19:57:42.523
> 
> 标签：javascript, ios, webforms, uitextfield

快速提问 - 如果网络表单中的文本字段不会自动获得表单设置的焦点，即您必须在键盘弹出之前按下该字段 - 我是否正确假设该字段无法编辑？

换句话说 - 我不能通过向其中注入 javascript 来为 textField 设置文本，除非它专注于加载网站，对吗？

注意：我**不是**在这里谈论设置文本或占位符:-)

干杯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-08T20:00:28.593

是的你可以！您可以使用 Javascript 设置值：

```
[theWebView stringByEvaluatingJavaScriptFromString:@"document.getElementById('textFieldID').value = 'MyText'"] 
```

[这是](https://stackoverflow.com/questions/6089809/set-text-for-a-textfield-in-uiwebview)一篇文章，向您展示了如何使用 Javascript 设置和获取文本字段的值。

希望这有帮助！

# html - 代码标签不将包含的文本打印为文字是否会打扰其他人？

> ID：10505588
> 
> 赞同：-4
> 
> 时间：2012-05-08T19:57:54.403
> 
> 标签：html

似乎这应该在 HTML5 中得到纠正，或者至少规范应该指定`<code>`标签这样做。

到目前为止，如果您在代码标签中有标签，它会考虑那些 DOM 元素。

应该有一种方法可以编写标签而不必逃避它们。我错过了什么，或者他们没有想到这一点这很荒谬吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T23:38:44.840

甚至在 HTML 2.0 发布之前，这种特性就已经被考虑过了，用`<xmp>`and`<listing>`元素而不是`<code>`.`</xmp>`在您的转义代码中？

话虽如此，`<xmp>`如今已相当一致地实施，并且相当接近在 HTML5 中有效。以下引用来自 HTML5 编辑器 Ian Hickson 对[Bug 12235 - Make `<xmp>`conforming](https://www.w3.org/Bugs/Public/show_bug.cgi?id=12235)的评论。

> 建议：允许`<xmp>`作为与 HTML 具有相同语义`<pre>` 但保留特殊解析规则的元素。
> 
> 优点：经验丰富的作者正在编写规范、HTML 教程、编程语言博客或其他包含预期包含的代码片段`<`和`&`字符的页面，可以节省转义其`<`s 和`&`s 的时间。
> 
> 缺点：语言复杂，引入了另一种多语言差异，可能被误认为是一种安全功能，如果您必须稍后在块内添加标记（例如，突出显示一个部分），使用起来会很痛苦，不支持字符之外的字符页面的编码（因为它无法获取实体）。
> 
> 我同意亨利的观点，这是一个艰难的决定。

--

> 状态：拒绝更改
> 
> 说明：规格无变化
> 
> 理由：我要对此说不，主要是出于简单性论点。不过，这是一个艰难的决定。双方都有一些很好的论据。

最后，我应该注意`<code>`不能改变的行为。现在这样做会破坏很多很多网页。

# c# - LINQ多对多关系，如何写出正确的WHERE子句？

> ID：10505595
> 
> 赞同：12
> 
> 时间：2012-05-08T19:58:10.877
> 
> 标签：c#, linq, entity-framework-4, dbcontext

我对我的表使用多对多关系。

有一个查询：

```
var query = from post in context.Posts
        from tag in post.Tags where tag.TagId == 10
        select post; 
```

好的，它工作正常。我收到具有 id 指定标签的帖子。

我有一组标签 ID。我想获得包含我收藏中每个标签的帖子。

我尝试以下方式：

```
var tagIds = new int[]{1, 3, 7, 23, 56};

var query = from post in context.Posts
        from tag in post.Tags where tagIds.Contains( tag.TagId )
        select post; 
```

它不起作用。该查询返回具有任何一个指定标签的所有帖子。

我想得到一个这样的子句，但动态地用于集合中的任何标签计数：

```
post.Tags.Whare(x => x.TagId = 1 && x.TagId = 3 && x.TagId = 7 && ... ) 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-08T20:02:00.267

您不应该将每个帖子的标签投射到*外部*查询中；相反，您需要使用内部查询来执行外部过滤器的检查。（在 SQL 中，我们习惯将其称为[相关子查询](http://en.wikipedia.org/wiki/Correlated_subquery)。）

```
var query = 
    from post in context.Posts
    where post.Tags.All(tag => tagIds.Contains(tag.TagId))
    select post; 
```

替代语法：

```
var query = 
    context.Posts.Where(post =>
        post.Tags.All(tag => 
            tagIds.Contains(tag.TagId))); 
```

**编辑**：根据[Slauma 的说明](https://stackoverflow.com/questions/10505595/linq-many-to-many-relationship-how-to-write-a-correct-where-clause/10505638#comment13582881_10505624)进行更正。下面的版本返回的帖子至少包含`tagIds`集合中的所有标签。

```
var query = 
    from post in context.Posts
    where tagIds.All(requiredId => post.Tags.Any(tag => tag.TagId == requiredId))
    select post; 
```

替代语法：

```
var query = 
    context.Posts.Where(post => 
        tagIds.All(requiredId => 
            post.Tags.Any(tag =>
                tag.TagId == requiredId))); 
```

**编辑[2]**：根据 Slauma 在上面更正。还包括另一个充分利用以下查询语法的替代方案：

```
// Project posts from context for which
// no Ids from tagIds are not matched
// by any tags from post
var query =
    from post in context.Posts
    where
    ( 
        // Project Ids from tagIds that are
        // not matched by any tags from post
        from requiredId in tagIds
        where
        (
            // Project tags from post that match requiredId
            from tag in post.Tags
            where tag.TagId == requiredId
            select tag
        ).Any() == false
        select requiredId 
    ).Any() == false
    select post; 
```

我曾经在 Transact-SQL`.Any() == false`中模拟运算符。`NOT EXISTS`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T20:01:01.293

这实际上很容易做到：

```
var tags = context.Posts.Where(post => post.Tags.All(tag => tagIds.Contains(tag))); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-08T20:04:52.247

如果您希望标签集合仅包含您指定的集合而不包含其他集合，则另一种选择是使两个列表相交：

```
var query = from post in context.Posts
  let tags = post.Tags.Select(x => x.Id).ToList()
  where tags.Intersect(tagIds).Count() == tags.Length
  select post; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T20:01:04.197

试试看`Any`。

```
var query = from post in context.Posts
    from tag in post.Tags where tagIds.Any(t => t == tag.TagId )
    select post; 
```

# mongodb - mongodb 部分数组

> ID：10505599
> 
> 赞同：-1
> 
> 时间：2012-05-08T19:58:21.340
> 
> 标签：mongodb

我有一个看起来像这样的模式：

```
{
  "_id" : ObjectId("4f6af5c7065f92581a000013"),
  ....
  "conversation" : [{
      "_id" : ObjectId("4f6af5c7065f92581a000013"),
      "msg" : "message1",
      "userID" : 1
    },{
      "_id" : ObjectId("4f6af5c7065f92581a000016"),
      "msg" : "message3",
      "userID" : 1
    },{
      "_id" : ObjectId("4f6af5c7065f92581a000023"),
      "msg" : "msg",
      "userID" : 1
    }]
} 
```

我需要的是输出一个元素列表，其键 msg 的值包含'msg' 可以这样做吗？

```
db.dialogs.find({ "_id" : new ObjectId('4f6af5c7065f92581a000013'), "conversation.msg" : /msg/i }) 
```

但它会输出有关对象的所有信息。我需要的只是

```
{
          "_id" : ObjectId("4f6af5c7065f92581a000023"),
          "msg" : "msg",
          "userID" : 1
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:00:46.830

不，您不能自己选择子数组的元素。父文档的结构将被保留（不过，您可以选择不从其他 tnan 对话的字段中选择（就像您在示例中所做的那样））。

# iphone - 比较字符不起作用

> ID：10505601
> 
> 赞同：-6
> 
> 时间：2012-05-08T19:58:54.517
> 
> 标签：iphone, objective-c, ios, xcode

我有 12，第一个单词有 6 个，第二个单词有 6 个。

为什么这不起作用：

```
if 
    (aChar1 == aChar7)
    (aChar2 == aChar8){
        //do something
    } 
```

意思是，如果 aChar1 等于 aChar7 并且 aChar2 等于 aChar8 做某事，它会给我错误...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T20:02:26.907

它甚至不应该编译......正确的语法是

```
if ((aChar1 == aChar7) && (aChar2 == aChar8)) {
    //do something
} 
```

# r - 加快 write.table 的性能

> ID：10505605
> 
> 赞同：46
> 
> 时间：2012-05-08T19:59:30.730
> 
> 标签：r

我有一个`data.frame`，我想把它写出来。my 的尺寸为`data.frame`256 行 x 65536 列。什么是更快的替代品`write.csv`？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2016-04-07T02:11:03.930

`data.table::fwrite()`由 Otto Seiskari 贡献，在 1.9.8+ 版本中可用。Matt 在上面做了额外的增强（包括并行化）并写[了一篇](http://blog.h2o.ai/2016/04/fast-csv-writing-for-r/)关于它的文章。请报告[跟踪器](https://github.com/Rdatatable/data.table/issues/)上的任何问题。

首先，这是上面@chase 使用的相同维度的比较（即非常多的列：**65,000 列（！）** x 256 行），以及`fwrite`and `write_feather`，以便我们在机器之间具有一些一致性。`compress=FALSE`请注意基础 R 中的巨大差异。

```
# -----------------------------------------------------------------------------
# function  | object type |  output type | compress= | Runtime | File size |
# -----------------------------------------------------------------------------
# save      |      matrix |    binary    |   FALSE   |    0.3s |    134MB  |
# save      |  data.frame |    binary    |   FALSE   |    0.4s |    135MB  |
# feather   |  data.frame |    binary    |   FALSE   |    0.4s |    139MB  |
# fwrite    |  data.table |    csv       |   FALSE   |    1.0s |    302MB  |
# save      |      matrix |    binary    |   TRUE    |   17.9s |     89MB  |
# save      |  data.frame |    binary    |   TRUE    |   18.1s |     89MB  |
# write.csv |      matrix |    csv       |   FALSE   |   21.7s |    302MB  |
# write.csv |  data.frame |    csv       |   FALSE   |  121.3s |    302MB  | 
```

请注意，`fwrite()`并行运行。此处显示的时序是在 13 英寸 Macbook Pro 上，配备 2 个内核和 1 个线程/内核（通过超线程+2 个虚拟线程）、512GB SSD、256KB/内核 L2 缓存和 4MB L4 缓存。根据您的系统规格，YMMV。

我还针对相对**更有可能（和更大）的数据**重新运行了基准测试：

```
library(data.table)
NN <- 5e6 # at this number of rows, the .csv output is ~800Mb on my machine
set.seed(51423)
DT <- data.table(
  str1 = sample(sprintf("%010d",1:NN)), #ID field 1
  str2 = sample(sprintf("%09d",1:NN)),  #ID field 2
  # varying length string field--think names/addresses, etc.
  str3 = replicate(NN,paste0(sample(LETTERS,sample(10:30,1),T), collapse="")),
  # factor-like string field with 50 "levels"
  str4 = sprintf("%05d",sample(sample(1e5,50),NN,T)),
  # factor-like string field with 17 levels, varying length
  str5 = sample(replicate(17,paste0(sample(LETTERS, sample(15:25,1),T),
      collapse="")),NN,T),
  # lognormally distributed numeric
  num1 = round(exp(rnorm(NN,mean=6.5,sd=1.5)),2),
  # 3 binary strings
  str6 = sample(c("Y","N"),NN,T),
  str7 = sample(c("M","F"),NN,T),
  str8 = sample(c("B","W"),NN,T),
  # right-skewed (integer type)
  int1 = as.integer(ceiling(rexp(NN))),
  num2 = round(exp(rnorm(NN,mean=6,sd=1.5)),2),
  # lognormal numeric that can be positive or negative
  num3 = (-1)^sample(2,NN,T)*round(exp(rnorm(NN,mean=6,sd=1.5)),2))

# -------------------------------------------------------------------------------
# function  |   object   | out |        other args         | Runtime  | File size |
# -------------------------------------------------------------------------------
# fwrite    | data.table | csv |      quote = FALSE        |   1.7s   |  523.2MB  |
# fwrite    | data.frame | csv |      quote = FALSE        |   1.7s   |  523.2MB  |
# feather   | data.frame | bin |     no compression        |   3.3s   |  635.3MB  |
# save      | data.frame | bin |     compress = FALSE      |  12.0s   |  795.3MB  |
# write.csv | data.frame | csv |    row.names = FALSE      |  28.7s   |  493.7MB  |
# save      | data.frame | bin |     compress = TRUE       |  48.1s   |  190.3MB  |
# ------------------------------------------------------------------------------- 
```

所以`fwrite`比`feather`这个测试快 2 倍。这是在上面提到的同一台机器上`fwrite`运行的，在 2 个内核上并行运行。

`feather`似乎也相当快的二进制格式，但还没有压缩。

* * *

这是一个尝试显示如何`fwrite`在比例方面进行比较：

注意：基准已经通过运行 base R 来更新`save()`（`compress = FALSE`因为羽毛也没有被压缩）。

[![mb](../Images/3e4fece0097f6521dd031b27574fdce8.png)](https://i.imgur.com/eCLIqKq.png)

因此`fwrite`，所有这些数据中最快的（在 2 个内核上运行）加上它创建了一个`.csv`可以轻松查看、检查和传递给`grep`等的`sed`。

复制代码：

```
require(data.table)
require(microbenchmark)
require(feather)
ns <- as.integer(10^seq(2, 6, length.out = 25))
DTn <- function(nn)
    data.table(
          str1 = sample(sprintf("%010d",1:nn)),
          str2 = sample(sprintf("%09d",1:nn)),
          str3 = replicate(nn,paste0(sample(LETTERS,sample(10:30,1),T), collapse="")),
          str4 = sprintf("%05d",sample(sample(1e5,50),nn,T)),
          str5 = sample(replicate(17,paste0(sample(LETTERS, sample(15:25,1),T), collapse="")),nn,T),
          num1 = round(exp(rnorm(nn,mean=6.5,sd=1.5)),2),
          str6 = sample(c("Y","N"),nn,T),
          str7 = sample(c("M","F"),nn,T),
          str8 = sample(c("B","W"),nn,T),
          int1 = as.integer(ceiling(rexp(nn))),
          num2 = round(exp(rnorm(nn,mean=6,sd=1.5)),2),
          num3 = (-1)^sample(2,nn,T)*round(exp(rnorm(nn,mean=6,sd=1.5)),2))

count <- data.table(n = ns,
                    c = c(rep(1000, 12),
                          rep(100, 6),
                          rep(10, 7)))

mbs <- lapply(ns, function(nn){
  print(nn)
  set.seed(51423)
  DT <- DTn(nn)
  microbenchmark(times = count[n==nn,c],
               write.csv=write.csv(DT, "writecsv.csv", quote=FALSE, row.names=FALSE),
               save=save(DT, file = "save.RData", compress=FALSE),
               fwrite=fwrite(DT, "fwrite_turbo.csv", quote=FALSE, sep=","),
               feather=write_feather(DT, "feather.feather"))})

png("microbenchmark.png", height=600, width=600)
par(las=2, oma = c(1, 0, 0, 0))
matplot(ns, t(sapply(mbs, function(x) {
  y <- summary(x)[,"median"]
  y/y[3]})),
  main = "Relative Speed of fwrite (turbo) vs. rest",
  xlab = "", ylab = "Time Relative to fwrite (turbo)",
  type = "l", lty = 1, lwd = 2, 
  col = c("red", "blue", "black", "magenta"), xaxt = "n", 
  ylim=c(0,25), xlim=c(0, max(ns)))
axis(1, at = ns, labels = prettyNum(ns, ","))
mtext("# Rows", side = 1, las = 1, line = 5)
legend("right", lty = 1, lwd = 3, 
       legend = c("write.csv", "save", "feather"),
       col = c("red", "blue", "magenta"))
dev.off() 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-05-08T20:19:58.613

如果您的所有列都属于同一类，则在写出之前转换为矩阵，可提供近 6 倍的速度。此外，您可以考虑使用`write.matrix()`from package `MASS`，尽管在本示例中并没有证明它更快。也许我没有正确设置一些东西：

```
#Fake data
m <- matrix(runif(256*65536), nrow = 256)
#AS a data.frame
system.time(write.csv(as.data.frame(m), "dataframe.csv"))
#----------
#   user  system elapsed 
# 319.53   13.65  333.76 

#As a matrix
system.time(write.csv(m, "matrix.csv"))
#----------
#   user  system elapsed 
#  52.43    0.88   53.59 

#Using write.matrix()
require(MASS)
system.time(write.matrix(m, "writematrix.csv"))
#----------
#   user  system elapsed 
# 113.58   59.12  172.75 
```

# 编辑

为了解决下面提出的关于上述结果对 data.frame 不公平的担忧，这里有一些更多的结果和时间，以表明整体消息仍然是“如果可能，将您的数据对象转换为矩阵。如果不可能，处理或者，如果时机至关重要，请重新考虑为什么需要以 CSV 格式写出 200MB 以上的文件”：

```
#This is a data.frame
m2 <- as.data.frame(matrix(runif(256*65536), nrow = 256))
#This is still 6x slower
system.time(write.csv(m2, "dataframe.csv"))
#   user  system elapsed 
# 317.85   13.95  332.44
#This even includes the overhead in converting to as.matrix in the timing 
system.time(write.csv(as.matrix(m2), "asmatrix.csv"))
#   user  system elapsed 
#  53.67    0.92   54.67 
```

所以，什么都没有真正改变。为了确认这是合理的，请考虑 的相对时间成本`as.data.frame()`：

```
m3 <- as.matrix(m2)
system.time(as.data.frame(m3))
#   user  system elapsed 
#   0.77    0.00    0.77 
```

因此，并没有像下面的评论所相信的那样有什么大不了的或歪曲的信息。如果您仍然不相信`write.csv()`在大型 data.frames 上使用在性能方面是一个坏主意，请查阅以下手册`Note`：

```
write.table can be slow for data frames with large numbers (hundreds or more) of
columns: this is inevitable as each column could be of a different class and so must be
handled separately. If they are all of the same class, consider using a matrix instead. 
```

最后，如果您仍然因为更快地保存内容而失眠，请考虑迁移到本机 RData 对象

```
system.time(save(m2, file = "thisisfast.RData"))
#   user  system elapsed 
#  21.67    0.12   21.81 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-04-07T18:26:05.093

另一种选择是使用[羽毛](https://github.com/wesm/feather/tree/master/R)文件格式。

```
df <- as.data.frame(matrix(runif(256*65536), nrow = 256))

system.time(feather::write_feather(df, "df.feather"))
#>   user  system elapsed 
#>  0.237   0.355   0.617 
```

Feather 是一种二进制文件格式，旨在提高读写效率。它旨在与多种语言一起使用：目前有 R 和 python 客户端，还有一个 julia 客户端正在开发中。

为了比较，这里需要多长时间`saveRDS`：

```
system.time(saveRDS(df, "df.rds"))
#>   user  system elapsed 
#> 17.363   0.307  17.856 
```

现在，这是一个有点不公平的比较，因为默认`saveRDS`是压缩数据，而这里的数据是不可压缩的，因为它是完全随机的。关闭压缩会`saveRDS`显着加快：

```
system.time(saveRDS(df, "df.rds", compress = FALSE))
#>   user  system elapsed 
#>  0.181   0.247   0.473 
```

事实上，它现在比羽毛快一点。那么为什么要使用羽毛呢？嗯，它通常比 快`readRDS()`，并且与读取数据的次数相比，您通常写入数据的次数相对较少。

```
system.time(readRDS("df.rds"))
#>   user  system elapsed 
#>  0.198   0.090   0.287 

system.time(feather::read_feather("df.feather"))
#>   user  system elapsed 
#>  0.125   0.060   0.185 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-11-30T07:04:09.030

## [包裹](http://www.fstpackage.org/)_[`fst`](http://www.fstpackage.org/)

用于非常快速地读取和写入数据文件的最新选项是[**`fst`**package](http://www.fstpackage.org/)。`fst`生成二进制格式的文件。

使用`write.fst(dat, "file.fst", compress=0)`，其中`compress`可以从 0（无压缩）到 100（最大压缩）。可以使用 将数据读回到 R 中`dat = read.fst("file.fst")`。根据[包网站](http://www.fstpackage.org/)上列出的时间，它比`feather`,`data.table`和 base R`readRDS`和`writeRDS`.

包开发站点警告说，`fst`数据格式仍在发展中，`fst`因此不应该用于长期数据存储。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-01T02:25:25.847

您还可以尝试“readr”包的 read_rds（与 data.table::fread 相比）和 write_rds（与 data.table::fwrite 相比）。

这是我的数据集中的一个简单示例（1133 行和 429499 列）：

# 写数据集

`fwrite(rankp2,file="rankp2_429499.txt",col.names=T,row.names=F,quote = F,sep="\t")` `write_rds(rankp2,"rankp2_429499.rds")`

# 读取数据集（1133 行和 429499 列）

`system.time(fread("rankp2_429499.txt",sep="\t",header=T,fill = TRUE)) 　user system elapsed 42.391 0.526 42.949`

`system.time(read_rds("rankp2_429499.rds")) user system elapsed 2.157 0.388 2.547`

希望能帮助到你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-29T17:05:44.407

我认为你应该使用 fwrite()

它更快，对我帮助很大：

```
fwrite(x, file = "", append = FALSE, quote = "auto",
  sep = ",", sep2 = c("","|",""),
  eol = if (.Platform$OS.type=="windows") "\r\n" else "\n",
  na = "", dec = ".", row.names = FALSE, col.names = TRUE,
  qmethod = c("double","escape"),
  logical01 = getOption("datatable.logical01", FALSE),  # due to change to TRUE; see NEWS
  logicalAsInt = logical01,  # deprecated
  dateTimeAs = c("ISO","squash","epoch","write.csv"),
  buffMB = 8L, nThread = getDTthreads(),
  showProgress = interactive(),
  verbose = getOption("datatable.verbose", FALSE)) 
```

[https://jangorecki.gitlab.io/data.table/library/data.table/html/fwrite.html](https://jangorecki.gitlab.io/data.table/library/data.table/html/fwrite.html)

# c# - 无法从 CKEditor MVC3 获取文本

> ID：10505617
> 
> 赞同：1
> 
> 时间：2012-05-08T20:00:29.840
> 
> 标签：c#, asp.net-mvc-3

我是 Asp.Net MVC3 的新手，我正在尝试使用 CKEditor。但是无法获取我输入的文本，然后我推送提交。

我的观点：

```
<form method=post action="@Url.Action("Description")">
    <textarea class="ckeditor" id="editor1" rows="10" name="Details">@Resources.Resources.DescriptionSampleText</textarea>
    <input type="submit" />
</form> 
```

那里的控制器我需要文本：

```
[HttpPost]
public ActionResult Description(string textdetails)
{
    //Doing something with the text
    return RedirectToAction("Create", "Project", new { text = textdetails});
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T21:01:18.687

您的问题有三种解决方案。我将从直接解决它开始（两种方法），但是，在我看来这不是最好的方法。无论如何，稍后再谈。

ASP.NET MVC (3) 很多基于约定的工作。它会神奇地将值等从请求分配到参数等。当然，这些约定显然是基于参数的名称。你必须确保你的名字匹配（正如你现在可能想的那样，这将是一个很难维护的问题）。

快速的解决方案是将视图中的 textarea 命名为与 HttpPost 操作的参数相同。您的视图代码如下所示：

```
<form method=post action="@Url.Action("Description")">
    <textarea class="ckeditor" id="editor1" rows="10" name="Textdetails">@Resources.Resources.DescriptionSampleText</textarea>
    <input type="submit" />
</form> 
```

这应该有效。注意：我现在没有自己测试这个，但是许多初学者指南也这样做，所以我认为这会起作用。无论如何，我真的不喜欢这个解决方案，因为它真的很难维护（重构等不会很容易）。

第二种解决方案是使用`FormCollection`. 您将其作为 HttpPost 操作的参数提供，然后您可以通过索引访问您的值。有关示例和更多信息，您可以查看此 SO 帖子：[https](https://stackoverflow.com/a/5088493/578843) ://stackoverflow.com/a/5088493/578843 。

最后一个解决方案（我更喜欢）是创建一个 ViewModel。我建议您阅读本指南（[http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/examineing-the-edit-methods-and-edit-view](http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/examining-the-edit-methods-and-edit-view)），了解如何正确编辑页面等。

最后一件事，如果您想将 HTML 作为内容提交，您将不得不禁用 ASP.NET 的保存保护或向您的方法（或类）添加注释。请不要通常禁用保存保护（它会检查 html 等的输入），仅在需要时使用注释禁用它。您可以在您的操作中将`ValidateInput`属性（[MSDN 链接](http://msdn.microsoft.com/en-us/library/system.web.mvc.validateinputattribute.aspx)）设置为 false。例子：

```
[HttpPost]
[ValidateInput(false)]
public ActionResult Description(string textdetails)
{
    //Doing something with the text
    return RedirectToAction("Create", "Project", new { text = textdetails});
} 
```

# objective-c - 脚本值既不是数组也不是指针

> ID：10505623
> 
> 赞同：0
> 
> 时间：2012-05-08T20:00:58.747
> 
> 标签：objective-c, xcode, arrays, multidimensional-array

所以我试图为一个二维整数数组分配内存，这样我就可以在确定大小的循环之外引用它。（我有一个范围问题，因为数组的大小不固定。）

所以这是建议的解决方案，但我收到错误“脚本值既不是数组也不是指针”。有人知道我在做什么错吗？

```
//M and m are just 2 int numbers
int X = self.create2dArray(M,m);

for(int kk = 0; kk < M; kk++)
{   
for (int kk1 = 0; kk1 < m; kk1++)
        {
//small "x" is an NSMutableArray of NSNumbers.  So I am just running the 2 for loops to fill the whole 2D array
        X[kk][kk1] = [[x objectAtIndex: (kk + kk1 * J)] intValue]; //ERROR Line
        }                   
}

//outside of Main

static inline int **create2dArray(int w, int h)
{
    size_t size = sizeof(int) * 2 + w * sizeof(int *);
    int **arr = malloc(size);
    int *sizes = (int *) arr;
    sizes[0] = w;
    sizes[1] = h; 
    arr = (int **) (sizes + 2);

    for (int i = 0; i < w; i++)
    {
        arr[i] = calloc(h, sizeof(**arr));
    }

    return arr;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:34:58.403

我相信第一行应该开始`int** X`而不是`int X`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:27:24.930

好的，所以您的问题很可能在于您手动为整数分配内存。我提出的解决方案是用随机的“填充”数字填充它，例如：0。这样做，您不会冒险弄乱分配过程。此外，它更容易并且可以工作，因为您稍后将用整数填充它。希望这有帮助！

# c# - 为区域语言实现字典应用程序

> ID：10505626
> 
> 赞同：0
> 
> 时间：2012-05-08T20:01:03.617
> 
> 标签：c#, .net, dictionary, desktop-application

我需要为区域语言实现一个字典应用程序，如“Word Web”。我有一些基本问题，比如

1.  如何存储内容？我的意思是在哪种类型的文件中？
2.  如何从文件中搜索特定单词？

由于语言不是英语，这对我来说变得更具挑战性。请建议如何进行此操作？（我是一个 .Net C# 程序员。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:08:52.137

大多数语言的词典只有几十万个单词。您可以将字典中的每个单词完美地存储在数据库中的表上，这样，利用数据库引擎高效地执行搜索，甚至实现排序等。

您可以下载完全免费的[SQL SERVER EXPRESS EDITION 。](http://www.microsoft.com/sqlserver/en/us/editions/2012-editions/express.aspx)您可以从 Mozilla Firefox 词典加载项中找到大多数语言的文本格式词典。您可以将这些文本文件加载到数据库中的表中，并将其用于您的应用程序。

# c# - C#，使用 OpenXmlWriter 和 Open XML SDK 编写 XLSX

> ID：10505628
> 
> 赞同：3
> 
> 时间：2012-05-08T20:01:05.213
> 
> 标签：c#, export-to-excel, openxml-sdk

在 C# 中，以下程序编译并运行，但它不会在 excel 输出文件中写入任何内容。

我让它在没有的情况下工作，`OpenXmlWriter`但我开始内存不足，所以我必须`OpenXmlWriter`根据这个[http://blogs.msdn.com/b/brian_jones/archive/2010/06/22/writing-large-excel切换到-files-with-the-open-xml-sdk.aspx](http://blogs.msdn.com/b/brian_jones/archive/2010/06/22/writing-large-excel-files-with-the-open-xml-sdk.aspx)

```
class Program
{
    static void Main(string[] args)
    {
        File.Copy("book.xlsx", "output.xlsx", true);
        WriteValuesSAX("output.xlsx", 10, 10);
    }

    static void WriteValuesSAX(string filename, int numRows, int numCols)
    {
        using (SpreadsheetDocument myDoc = 
               SpreadsheetDocument.Open(filename, true))
        {
            WorkbookPart workbookPart = myDoc.WorkbookPart;
            WorksheetPart worksheetPart = workbookPart.WorksheetParts.First();

            OpenXmlWriter writer = OpenXmlWriter.Create(worksheetPart);

            Row r = new Row();
            Cell c = new Cell();
            CellValue v = new CellValue("Test");
            c.AppendChild(v);

            writer.WriteStartElement(new SheetData());
            for (int row = 0; row < numRows; row++)
            {
                writer.WriteStartElement(r);
                for (int col = 0; col < numCols; col++)
                {
                    writer.WriteElement(c);
                }
                writer.WriteEndElement();
            }
            writer.WriteEndElement();

            writer.Close();
        }
    }
} 
```

为什么它不写任何东西来输出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T18:05:36.070

我还不太了解这一点，但我得到了它的工作。这就是我最终的结果。

```
class Program
{
    static void Main(string[] args)
    {
        File.Copy("book.xlsx", "output.xlsx", true);
        WriteRandomValuesSAX("output.xlsx", 10, 10);
    }

    static void WriteRandomValuesSAX(string filename, int numRows, int numCols)
    {
        using (SpreadsheetDocument myDoc = SpreadsheetDocument.Open(filename, true))
        {
            WorkbookPart workbookPart = myDoc.WorkbookPart;
            WorksheetPart worksheetPart = workbookPart.WorksheetParts.Last();

            OpenXmlWriter writer = OpenXmlWriter.Create(worksheetPart);

            Row r = new Row();
            Cell c = new Cell();
            CellValue v = new CellValue("Test");
            c.AppendChild(v);

            writer.WriteStartElement(new Worksheet());
            writer.WriteStartElement(new SheetData());
            for (int row = 0; row < numRows; row++)
            {
                writer.WriteStartElement(r);
                for (int col = 0; col < numCols; col++)
                {
                    writer.WriteElement(c);
                }
                writer.WriteEndElement();
            }
            writer.WriteEndElement();
            writer.WriteEndElement();

            writer.Close();
        }
    }
} 
```

注意我添加了`writer.WriteStartElement(new Worksheet());`另一个`writer.WriteEndElement();`

* * *

我在这里找到了正确的 xml 格式：http: [//msdn.microsoft.com/en-us/library/gg278309.aspx](http://msdn.microsoft.com/en-us/library/gg278309.aspx)

哪个是

```
<?xml version="1.0" encoding="utf-8"?> <x:worksheet xmlns:x="http://schemas.openxmlformats.org/spreadsheetml/2006/main">
    <x:sheetData>
        <x:row r="1">
            <x:c r="A1" t="n">
                <x:v>100</x:v>
            </x:c>
        </x:row>
    </x:sheetData> </x:worksheet> 
```

所以我打开（解压缩）xlsx 文件并导航到 output.xlsx\xl\worksheets\sheet1.xml，发现我缺少`<x:worksheet>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-29T11:44:54.857

使用上面的代码会在 Excel 2007 中给我错误消息“Excel 发现不可读的内容”。使用此处的信息[how-to-properly-use-openxmlwriter-to-write-large-excel-files](http://polymathprogrammer.com/2012/08/06/how-to-properly-use-openxmlwriter-to-write-large-excel-files)并在添加列时更改代码到以下删除了错误。

```
for(int col = 0; col < numCols; col++)
{
    var oxa = new List<OpenXmlAttribute>();
    oxa.Add(new OpenXmlAttribute("t",null,"str"));
    writer.WriteStartElement(c,oxa);
    writer.WriteElement(new CellValue(string.Format("R{0}C{1}", row, col)));
    writer.WriteEndElement();
} 
```

# java - 使用 jquery-1.7.1.min.js 编译错误

> ID：10505631
> 
> 赞同：6
> 
> 时间：2012-05-08T20:01:22.743
> 
> 标签：java, javascript, jquery, eclipse, maven

我正在尝试使用 maven 和 spring 运行一个动态 web 项目。我有一个使用 jquery-1.7.1.min.js 的代码。但我在文件中看到编译错误。以下是错误的屏幕截图。

有没有人遇到过同样的问题或知道如何解决它

![eclipse中显示的编译错误](../Images/14d3c1648e905f092e9181c71fb9774b.png)

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-23T02:52:00.183

来自[http://imwill.com/eclipse-java-ee-jquery-validation-error-workaround/#.UK7jAOOe-I5](http://imwill.com/eclipse-java-ee-jquery-validation-error-workaround/#.UK7jAOOe-I5)

解决方法 - 如何修复要摆脱烦人的错误符号，请执行以下操作：

1) 右键单击​​ Eclipse 项目资源管理器视图中的项目根文件夹

2) 转到属性 -> JavaScript -> 包含路径 -> 源选项卡

3) 选择排除和编辑...，然后添加..

4) 现在您可以浏览有错误的 JavaScript 文件，也可以输入一个通配符模式，该模式将排除与您的模式匹配的任何内容。就我而言，我输入了 **/jquery*.js 以排除所有 jQuery 库文件。

5）然后你可以再次点击OK，Finish和OK

6) 你的 Eclipse 进度视图现在应该显示一个 Building Workspace 消息

7）多田！错误符号不见了！

除了上述步骤之外，我还必须手动删除旧的问题标记。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T20:15:48.803

如果这些错误来自您的 jquery 源文件，这在 eclipse 中是正常的。如果它们来自您自己的 javascript 文件，则可能是个问题。

Eclipse 的 javascript 警告在很大程度上是无用的。由于 ASI 和 eclipse 根本不能很好地处理，Javascript 缩小器有目的地删除分号。

检查我的本地 jQuery 文件，我得到了几乎相同的警告和错误列表。

# css - 单击后按钮恢复原始样式而不是保持活动状态

> ID：10505635
> 
> 赞同：0
> 
> 时间：2012-05-08T20:01:36.127
> 
> 标签：css

基本上我有两个三种按钮样式：正常、悬停和活动。

单击按钮后，我希望它保持活动样式，而不是在页面加载前片刻恢复正常。这可以用css完成还是我必须用jquery来完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T20:04:16.687

您*可以*使用`:focus`伪类而不是`:active`，因为`:active`仅当鼠标在一个元素上时才适用，而单击所述元素将给出它，`:focus`直到焦点转移到其他地方（如页面上的另一个按钮，或完全另一个窗口）。

# asp.net - 未触摸页面后视图状态 MAC 验证失败

> ID：10505637
> 
> 赞同：0
> 
> 时间：2012-05-08T20:01:43.577
> 
> 标签：asp.net, iis-7.5, viewstate

错误：

```
Validation of viewstate MAC failed. If this application is hosted by a Web Farm or cluster, ensure that <machineKey> configuration specifies the same validationKey and validation algorithm. AutoGenerate cannot be used in a cluster. 
```

我正在使用 ASP.NET 4.0 并在浏览器上留下无法触摸的页面然后返回并单击某个 LinkBut​​ton 后出现此错误。

请注意，我已将此部分添加到 web.config：

```
<machineKey validationKey="5D063F8696973939183E8CD13363F9B1D2F3D267CAD70E5F0602A81603AB77F9AD82919311A00CEF867FA1216898BE6FE32DF267AEA98E8E18837B375998621C"                 decryptionKey="DD1D0F9CD56447D829DC9040C651AA5235C3F0FEDB8C91C8A45960C30F0A4314" 
                validation="SHA1" 
                decryption="AES" /> 
```

但我仍然收到此错误。我想它可能会在会话过期或类似的情况下发生。但是如何在不禁用视图状态的 MAC 加密的情况下避免它呢？

谢谢

# cocoa - 使用 CoreText 的带有变音符号的字符边界框

> ID：10505648
> 
> 赞同：8
> 
> 时间：2012-05-08T20:02:36.867
> 
> 标签：cocoa

我正在尝试使用各种技术在 MacOS X/iOS 中获取字符的边界框。我现在展示我所有的尝试。到目前为止，如果我想获得诸如“Ä”之类的变音符号的大小，代码将失败。

## 使用`CTFontGetBoundingRectsForGlyphs`

```
-(void) resizeLayer1:(CATextLayer *)l toString:(NSString *)string
{
    // need to set CGFont explicitly to convert font property to a CGFontRef
    CGFontRef layerFont = CGFontCreateWithFontName((CFStringRef)@"Helvetica");
    l.font = layerFont;

    string = l.string;
    NSUInteger len = [string length];

    // get characters from NSString
    UniChar *characters = (UniChar *)malloc(sizeof(UniChar)*len);
    CFStringGetCharacters((__bridge CFStringRef)l.string, CFRangeMake(0, [l.string length]), characters);

    // Get CTFontRef from CGFontRef
    CTFontRef coreTextFont = CTFontCreateWithGraphicsFont(layerFont, l.fontSize, NULL, NULL);

    // allocate glyphs and bounding box arrays for holding the result
    // assuming that each character is only one glyph, which is wrong
    CGGlyph *glyphs = (CGGlyph *)malloc(sizeof(CGGlyph)*len);
    CTFontGetGlyphsForCharacters(coreTextFont, characters, glyphs, len);

    // get bounding boxes for glyphs
    CGRect *bb = (CGRect *)malloc(sizeof(CGRect)*len);
    CTFontGetBoundingRectsForGlyphs(coreTextFont, kCTFontDefaultOrientation, glyphs, bb, len);
    CFRelease(coreTextFont);

    l.position = CGPointMake(200.f, 100.f);

    l.bounds = bb[0];

    l.backgroundColor = CGColorCreateGenericRGB(0.f, .5f, .9f, 1.f);

    free(characters);
    free(glyphs);
    free(bb);
} 
```

**结果**它有点工作，但是当字形由 CATextLayer 呈现时，会有一些填充

## 使用`CTFramesetterSuggestFrameSizeWithConstraints`

```
-(void) resizeLayer2:(CATextLayer *)l toString:(NSString *)string
{
    // need to set CGFont explicitly to convert font property to a CGFontRef
    CGFontRef layerFont = CGFontCreateWithFontName((CFStringRef)@"Helvetica");
    l.font = layerFont;

    string = l.string;

    NSUInteger len = [string length];

    // get characters from NSString
    UniChar *characters = (UniChar *)malloc(sizeof(UniChar)*len);
    CFStringGetCharacters((__bridge CFStringRef)l.string, CFRangeMake(0, [l.string length]), characters);

    // Get CTFontRef from CGFontRef
    CTFontRef coreTextFont = CTFontCreateWithGraphicsFont(layerFont, l.fontSize, NULL, NULL);

    CFMutableAttributedStringRef attrStr = CFAttributedStringCreateMutable(kCFAllocatorDefault, 0);
    CFAttributedStringReplaceString(attrStr, CFRangeMake(0, 0), (__bridge CFStringRef)string);
    CTTextAlignment alignment = kCTJustifiedTextAlignment;
    CTParagraphStyleSetting _settings[] = { {kCTParagraphStyleSpecifierAlignment, sizeof(alignment), &alignment} };
    CTParagraphStyleRef paragraphStyle = CTParagraphStyleCreate(_settings, sizeof(_settings) / sizeof(_settings[0]));
    CFAttributedStringSetAttribute(attrStr, CFRangeMake(0, CFAttributedStringGetLength(attrStr)), kCTParagraphStyleAttributeName, paragraphStyle);
    CFAttributedStringSetAttribute(attrStr, CFRangeMake(0, CFAttributedStringGetLength(attrStr)), kCTFontAttributeName, coreTextFont);
    CFRelease(paragraphStyle);

    CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString(attrStr);
    CFRelease(attrStr);

    CFRange range;
    CGFloat maxWidth  = CGFLOAT_MAX;
    CGFloat maxHeight = 10000.f;
    CGSize constraint = CGSizeMake(maxWidth, maxHeight);

    //  checking frame sizes
    CGSize coreTextSize = CTFramesetterSuggestFrameSizeWithConstraints(framesetter, CFRangeMake(0, len), nil, constraint, &range); 

    // allocate glyphs and bounding box arrays for holding the result
    // assuming that each character is only one glyph, which is wrong
    CGGlyph *glyphs = (CGGlyph *)malloc(sizeof(CGGlyph)*len);
    CTFontGetGlyphsForCharacters(coreTextFont, characters, glyphs, len);

    // get bounding boxes for glyphs
    CGRect *bb = (CGRect *)malloc(sizeof(CGRect)*len);
    CTFontGetBoundingRectsForGlyphs(coreTextFont, kCTFontDefaultOrientation, glyphs, bb, len);
    CFRelease(coreTextFont);

    bb[0].origin = l.bounds.origin;
    coreTextSize.width = ceilf(coreTextSize.width);
    coreTextSize.height = ceilf(coreTextSize.height);
    bb[0].size = coreTextSize;

    l.position = CGPointMake(200.f, 100.f);

    // after setting the bounds the layer gets transparent
    l.bounds = bb[0];
    l.opaque = YES;
    return;    

    l.backgroundColor = CGColorCreateGenericRGB(0.f, .5f, .9f, 1.f);

    free(characters);
    free(glyphs);
    free(bb);
} 
```

**结果**字符串的边界框是正确的。变音符号有问题：Ä 缺少点，因为边界框不够高。

## 使用`CTLineGetTypographicBounds`

```
-(void) resizeLayer3:(CATextLayer *)l toString:(NSString *)string
{
    // need to set CGFont explicitly to convert font property to a CGFontRef
    CGFontRef layerFont = CGFontCreateWithFontName((CFStringRef)@"Helvetica");
    l.font = layerFont;

    string = l.string;

    NSUInteger len = [string length];

    // get characters from NSString
    UniChar *characters = (UniChar *)malloc(sizeof(UniChar)*len);
    CFStringGetCharacters((__bridge CFStringRef)l.string, CFRangeMake(0, [l.string length]), characters);

    // Get CTFontRef from CGFontRef
    CTFontRef coreTextFont = CTFontCreateWithGraphicsFont(layerFont, l.fontSize, NULL, NULL);

    CFMutableAttributedStringRef attrStr = CFAttributedStringCreateMutable(kCFAllocatorDefault, 0);
    CFAttributedStringReplaceString(attrStr, CFRangeMake(0, 0), (__bridge CFStringRef)string);
    CFAttributedStringSetAttribute(attrStr, CFRangeMake(0, CFAttributedStringGetLength(attrStr)), kCTFontAttributeName, coreTextFont);

    CTLineRef line = CTLineCreateWithAttributedString(attrStr);
    CGFloat ascent;
    CGFloat descent;
    CGFloat width = CTLineGetTypographicBounds(line, &ascent, &descent, NULL);
    CGFloat height = ascent+descent;
    CGSize coreTextSize = CGSizeMake(width,height);

    // get bounding boxes for glyphs
    CGRect *bb = (CGRect *)malloc(sizeof(CGRect)*len);
    CFRelease(coreTextFont);

    bb[0].origin = CGPointZero;
    coreTextSize.width = ceilf(coreTextSize.width);
    coreTextSize.height = ceilf(coreTextSize.height);
    bb[0].size = coreTextSize;

    l.position = CGPointMake(200.f, 100.f);

    // after setting the bounds the layer gets transparent
    l.bounds = bb[0];
    l.opaque = YES;
    return;    

    l.backgroundColor = CGColorCreateGenericRGB(0.f, .5f, .9f, 1.f);

    free(characters);
    free(bb);
} 
```

**结果**字符串的边界框是正确的。变音符号有问题：Ä 缺少点，因为边界框不够高。

## 使用`CTFontGetBoundingRectsForGlyphs`

```
-(void) resizeLayer4:(CATextLayer *)l toString:(NSString *)string
{
    // need to set CGFont explicitly to convert font property to a CGFontRef
    CGFontRef layerFont = CGFontCreateWithFontName((CFStringRef)@"Helvetica");
    l.font = layerFont;

    string = l.string;

    NSUInteger len = [string length];

    // get characters from NSString
    UniChar *characters = (UniChar *)malloc(sizeof(UniChar)*len);
    CFStringGetCharacters((__bridge CFStringRef)l.string, CFRangeMake(0, [l.string length]), characters);

    // Get CTFontRef from CGFontRef
    CTFontRef coreTextFont = CTFontCreateWithGraphicsFont(layerFont, l.fontSize, NULL, NULL);

    // allocate glyphs and bounding box arrays for holding the result
    // assuming that each character is only one glyph, which is wrong
    CGGlyph *glyphs = (CGGlyph *)malloc(sizeof(CGGlyph)*len);
    CTFontGetGlyphsForCharacters(coreTextFont, characters, glyphs, len);

    CGPathRef glyphPath = CTFontCreatePathForGlyph(coreTextFont, glyphs[1], NULL);
    CGRect rect = CGPathGetBoundingBox(glyphPath);

    // get bounding boxes for glyphs
    CGRect *bb = (CGRect *)malloc(sizeof(CGRect)*len);
    CTFontGetBoundingRectsForGlyphs(coreTextFont, kCTFontDefaultOrientation, glyphs, bb, len);
    CFRelease(coreTextFont);

    l.position = CGPointMake(200.f, 100.f);

    l.bounds = rect;

    l.backgroundColor = CGColorCreateGenericRGB(0.f, .5f, .9f, 1.f);

    free(characters);
    free(glyphs);
    free(bb);
} 
```

**结果**字符串的边界框是正确的。变音符号本身就有问题，因为变音符号本身是一个字形，而字符是另一个字形，这意味着 Ä 由两个字形组成。怎么可能使用它？

还有其他我忽略并值得尝试的可能性吗？

# 编辑

第三种选择`CTLineGetTypographicBounds`似乎有效。但是，我遇到了一个不同的问题，即 a 中的第一行`CATextLayer`缺少其变音符号。第一行不知何故不够高。那意味着我在这里叫错了树。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T06:13:12.803

试试 CTLineGetImageBounds。但是请注意，这将包括延伸到基线以下的部分字形，例如，这与小写字母 ä 相关。

简要说明：圆形形状必须超出直线形状才能以相同的视觉重量出现。例如，参见小写 b 或 d，它们在基线处具有圆形和直线形状。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-10T06:16:31.590

在第一个示例中，您似乎忽略了字形的边界矩形很可能具有负 y 原点这一事实。返回的矩形通常被视为`y=0`文本的基线。因此，您在边界矩形中设置了一个偏移量，这可能也是图层在文本中具有偏移量的原因。（没试过，但这么认为）

如果您对特定文本的边界不感兴趣，但选择包含各种文本的高度，您可能还想选择`CTFontGetBoundingBox`.

# python - 多线程加速下载

> ID：10505654
> 
> 赞同：1
> 
> 时间：2012-05-08T20:03:01.510
> 
> 标签：python, beautifulsoup, lxml, urllib2, urllib

如何同时下载多个链接？我下面的脚本有效，但一次只能下载一个，而且速度非常慢。我不知道如何在我的脚本中加入多线程。

Python 脚本：

```
from BeautifulSoup import BeautifulSoup
import lxml.html as html
import urlparse
import os, sys
import urllib2
import re

print ("downloading and parsing Bibles...")
root = html.parse(open('links.html'))
for link in root.findall('//a'):
  url = link.get('href')
  name = urlparse.urlparse(url).path.split('/')[-1]
  dirname = urlparse.urlparse(url).path.split('.')[-1]
  f = urllib2.urlopen(url)
  s = f.read()
  if (os.path.isdir(dirname) == 0): 
    os.mkdir(dirname)
  soup = BeautifulSoup(s)
  articleTag = soup.html.body.article
  converted = str(articleTag)
  full_path = os.path.join(dirname, name)
  open(full_path, 'w').write(converted)
  print(name) 
```

名为的 HTML 文件`links.html`：

```
<a href="http://www.youversion.com/bible/gen.1.nmv-fas">http://www.youversion.com/bible/gen.1.nmv-fas</a>

<a href="http://www.youversion.com/bible/gen.2.nmv-fas">http://www.youversion.com/bible/gen.2.nmv-fas</a>

<a href="http://www.youversion.com/bible/gen.3.nmv-fas">http://www.youversion.com/bible/gen.3.nmv-fas</a>

<a href="http://www.youversion.com/bible/gen.4.nmv-fas">http://www.youversion.com/bible/gen.4.nmv-fas</a> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-08T20:27:04.057

我用它`multiprocessing`来并行化事物——出于某种原因，我比它更喜欢它`threading`

```
from BeautifulSoup import BeautifulSoup
import lxml.html as html
import urlparse
import os, sys
import urllib2
import re
import multiprocessing

print ("downloading and parsing Bibles...")
def download_stuff(link):
  url = link.get('href')
  name = urlparse.urlparse(url).path.split('/')[-1]
  dirname = urlparse.urlparse(url).path.split('.')[-1]
  f = urllib2.urlopen(url)
  s = f.read()
  if (os.path.isdir(dirname) == 0): 
    os.mkdir(dirname)
  soup = BeautifulSoup(s)
  articleTag = soup.html.body.article
  converted = str(articleTag)
  full_path = os.path.join(dirname, name)
  open(full_path, 'w').write(converted)
  print(name)

root = html.parse(open('links.html'))
links = root.findall('//a')
pool = multiprocessing.Pool(processes=5) #use 5 processes to download the data
output = pool.map(download_stuff,links)  #output is a list of [None,None,...] since download_stuff doesn't return anything 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-12-30T11:30:33.783

在 2017 年，现在还有其他一些选项，例如 asyncio 和 ThreadPoolExecutor。

这是 ThreadPoolExecutor 的示例（包含在 Python 期货中）

```
from concurrent.futures import ThreadPoolExecutor

def download(url, filename):
    ... your dowload function...
    pass

with ThreadPoolExecutor(max_workers=12) as executor:
    future = executor.submit(download, url, filename)
    print(future.result()) 
```

submit() 函数将任务提交到队列。（队列管理为您完成）

```
Python version 3.5 and above:
if max_workers is None or not given, it will default to the number of processors on the 
machine, multiplied by 5. 
```

您可以将 max_workers 设置为实际 CPU 核心数的几倍，根据上下文切换开销进行一些测试，看看您能提高多少。

欲了解更多信息： [https ://docs.python.org/3/library/concurrent.futures.html](https://docs.python.org/3/library/concurrent.futures.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T20:14:02.663

在我看来，这就像消费者 - 生产者问题 - 见维基百科

您可以使用

```
import Queue, thread

# create a Queue.Queue here
queue = Queue.Queue()

print ("downloading and parsing Bibles...")
root = html.parse(open('links.html'))
for link in root.findall('//a'):
  url = link.get('href')
  queue.put(url) # produce

def thrad():
  url = queue.get() # consume
  name = urlparse.urlparse(url).path.split('/')[-1]
  dirname = urlparse.urlparse(url).path.split('.')[-1]
  f = urllib2.urlopen(url)
  s = f.read()
  if (os.path.isdir(dirname) == 0): 
    os.mkdir(dirname)
  soup = BeautifulSoup(s)
  articleTag = soup.html.body.article
  converted = str(articleTag)
  full_path = os.path.join(dirname, name)
  open(full_path, 'wb').write(converted)
  print(name)

thread.start_new(thrad, ()) # start 1 threads 
```

# console - Bamboo、NAnt 和 PSExec 不显示控制台 UI

> ID：10505655
> 
> 赞同：1
> 
> 时间：2012-05-08T20:03:15.073
> 
> 标签：console, nant, bamboo, psexec

在 Bamboo 构建期间，我需要 NAnt 在本地机器上启动一个长时间运行的控制台应用程序。它可以正确执行此操作，但没有控制台 UI。我没有尝试展示所有这些，而是​​将其简化为一个也不显示 UI 的简单示例。

当我键入以下内容时：

```
C:\PSExecPath\psexec -d -i ping localhost 
```

或者

```
C:\PSExecPath\psexec \\localmachinename -d -i ping localhost 
```

我得到了人们期望的结果，包括 UI。

但是，当从 NAnt 启动相同的命令时，没有 UI。例如，当 NAnt 在使用 Bamboo 启动后运行以下构建文件时：

```
<?xml version="1.0"?>
<project default="all">
    <target name="all">
        <exec program="C:\PSExecPath\psexec.exe" spawn="true">
            <arg value="\\localmachinename" />
            <arg value="-d" />
            <arg value="-i" />
            <arg value="ping" />
            <arg value="localhost" />
        </exec>
    </target>
</project> 
```

只是为了确保说明，NAnt 正在同一配置文件中执行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T19:37:38.373

Bamboo 作为服务运行。我将其更改为作为控制台运行，一切都按预期开始运行。

# javascript - ASP.NET MVC 根据屏幕大小通过 JavaScript 在标题中插入 CSS 文件

> ID：10505657
> 
> 赞同：0
> 
> 时间：2012-05-08T20:03:24.540
> 
> 标签：javascript, jquery, css, asp.net-mvc-3

我正在开发一个 MVC3 应用程序，其母版页在正文中呈现视图。现在我有 2 个 css 文件（不同的布局），我想根据客户端的屏幕大小选择 CSS。 **一切都适用于下面的代码，但是，仅适用于索引页面，每当我转到第二页时，无论它是什么，根本不会呈现任何 CSS。** 下面的代码放在母版页的 HEAD 部分。

```
<script type="text/javascript">
      var css = './Content/SiteWide.css'     

      if ($(window).width() < 1140) {
      css = './Content/SiteNarrow.css';            
      }
      var tempcss = '<link href="TEMPCSS" rel="stylesheet" type="text/css" />';
      var cssLink = tempcss.replace("TEMPCSS", css);
      document.write(cssLink);    
</script> 
```

因此，当您转到第二页（都使用相同的母版页）时，不知何故 CSS 不会再次加载，你们有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T20:09:39.183

使用 CSS 媒体查询而不是 Javascript。

```
<!-- dropped rel attribute -->
<link media="only screen and (max-width:1139px)" href="SiteNarrow.css" />
<link media="only screen and (min-width:1140px)" href="SiteWide.css" /> 
```

理想情况下，您为一种状态创建一个 CSS 文件，并在满足条件时使用另一个覆盖。

```
<!-- dropped rel attribute -->
<link href="base.css" />
<link media="only screen and (min-width:1140px)" href="override.css" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:11:03.400

我相信你需要使用 Url.Content()。IE

```
@Url.Content("~/Content/SiteWide.css"); 
```

如果您使用从索引页面导航时，路径可能不正确

```
./Content/SiteWide.css 
```

我通常发现 Url.Content() 在路径到项目中的文件时是正确的做法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T20:08:30.930

我建议实施响应式网页设计

[http://www.sitepoint.com/responsive-web-design/#fbid=UhFHwQrRwnn](http://www.sitepoint.com/responsive-web-design/#fbid=UhFHwQrRwnn)

您可以使用所谓的“媒体查询”来实时动态地应用不同的 css 文件或属性作为屏幕大小的变化。很酷！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T20:13:01.600

专业提示：不要使用静态文件位置。使用 Url.Content。

您的代码如下所示：

```
var css = '@Url.Content("~/Content/SiteWide.css")'; 
```

试试这个，看看它是否有效。根据经验，我的静态位置有时无法按预期工作，而 Url.Content 为我解决了问题。

# c# - C# - 提取图像时解析 ffmpeg 标准输出

> ID：10505659
> 
> 赞同：6
> 
> 时间：2012-05-08T20:03:41.017
> 
> 标签：c#, ffmpeg

我通过从我的 c# 代码中启动 ffmpeg 进程来提取单个视频帧。默认行为是将这些图像写入磁盘。但是，为了加快处理速度，我想重定向 ffmpeg 标准输出以接收流并在我的程序中进一步处理它。

我正在使用与此类似的参数：

```
-i \"" + Filename + "\" -vf \"scale=640:-1\" -an -vframes 100 -r 1 -f image2 - 
```

这会将字节流重定向到标准输出，我可以使用`process.StartInfo.RedirectStandardOutput = true`.

这可能适用于电影流，因为我只有一个输出，但上面的调用会产生 10 个单个图像（写入硬盘时），我如何从标准输出解析字节流并将其拆分为单个文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T20:51:26.247

我找到了一个似乎可行的解决方案，但奇怪的是，[ffmpeg 文档](http://ffmpeg.org/ffmpeg.html)中没有提到：`image2pipe`用作输出格式。

因此，对于上面的示例，它将是：

```
-i \"" + Filename + "\" -vf \"scale=640:-1\" -an -vframes 100 -r 1 -f image2pipe - 
```

这会将字节流重定向到标准输出并允许捕获和解析图像

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T13:09:40.863

感谢您的回答@leepfrog 这基本上是一样的：

```
StringBuilder str = new StringBuilder();

        //Input file path
        str.Append(string.Format(" -i {0}", myinputFile));

        //Set the frame rate
        str.Append(string.Format(" -r {0}", myframeRate);

        //Indicate the output format
        str.Append(" -f image2pipe");

        //Connect the output to the standard output
        str.Append(" pipe:1");

        return str.ToString(); 
```

# php - PHP echo $row['username'] 不显示第一个用户名？

> ID：10505662
> 
> 赞同：0
> 
> 时间：2012-05-08T20:04:11.730
> 
> 标签：php, mysql, database

我不太确定问题出在哪里，我有一个带有 userid 外键的 post 表，我想基于此从 users 表中提取他们的用户名，似乎可以将它们拉出来，但它不会t 显示在第一个帖子上。我的代码是：

```
$query_therealuserid = 'SELECT users.username, users.userid, posts.userid, posts.created_at
FROM users, posts
WHERE users.userid = posts.userid
ORDER BY posts.created_at';

$therealuserid = mysql_query($query_therealuserid, $akaearthdb) or die(mysql_error()); 
```

和

```
<?php do { ?>
  <div id= "post">
    <?php if (stripos($row_rsjustpost['link'], ".png") !== false) {?>
            <img src="<?php echo $row_rsjustpost['link']; ?>" id="postImage" alt="Broken Link">
            <?php }?>
    <?php if (stripos($row_rsjustpost['link'], ".gif") !== false) {?>
            <img src="<?php echo $row_rsjustpost['link']; ?>" id="postImage" alt="Broken Link">
            <?php }?>
    <?php if (stripos($row_rsjustpost['link'], ".jpg") !== false) {?>
            <img src="<?php echo $row_rsjustpost['link']; ?>" id="postImage" alt="Broken Link">
            <?php }?>
    <?php if (stripos($row_rsjustpost['link'], ".jpeg") !== false) {?>
            <img src="<?php echo $row_rsjustpost['link']; ?>" id="postImage" alt="Broken Link">
            <?php }?> 

    <a href="<?php echo $row_rsjustpost['link']; ?>"><?php echo $row_rsjustpost['title']; ?></a>
    <br/>
    <?php echo $row_rsjustpost['text']; ?>
    </p>
    <br />

            <?php 
            do {
            if ($whileLoopCounter0!=$whileLoopCounter1){break;}
        ?>By: <?php echo $row['username'];
        echo "<br />";
            $whileLoopCounter1++;

            } while($row = mysql_fetch_array($therealuserid));
            ?>

  </div>
  <?php $whileLoopCounter0++; ?>
  <?php } while ($row_rsjustpost = mysql_fetch_assoc($rsjustpost)); ?>
</div> 
```

当我拉起页面时，我得到了所有帖子，但第一个没有用户名，并且用户名都被推下一个帖子。第一个帖子的 postid 为 2，如果我创建一个 postid 为 1 和用户 ID 的新帖子，它会显示在顶部而没有用户名，并且其他用户名会向上移动，以便它们是正确的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:09:22.510

那是因为您使用了 do-while 循环，在`$row = mysql_fetch_array($therealuserid)`循环结束时执行，为什么不使用常规的 while 循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:11:16.770

您当前正在使用 do-while 循环，因此首先执行 do 块，然后仅在第一次执行 do 块后评估 while 块。

改用这个：

```
while ($whileLoopCounter0==$whileLoopCounter1) {
   $row = mysql_fetch_array($therealuserid);
   if ($row){
 ?>
 By: 
 <?php 
      echo $row['username'];
      echo "<br />";
      $whileLoopCounter1++;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T20:11:49.153

看起来您在增加循环计数器后正在获取用户名。用户名在循环为一个之后被拉出，因此第一行将为空，因为该数据尚不存在。

尽管您正在做很多其他事情，但这只是在浪费精力。尝试将结果扔到一个对象中并使用`foreach($result as $key=>$value)`or`foreach($result as $item)`如果您不需要密钥。

# clipboard - 为什么 HotkeySet() 不能处理剪贴板数据？

> ID：10505664
> 
> 赞同：0
> 
> 时间：2012-05-08T20:04:12.860
> 
> 标签：clipboard, autoit, hotkeys

`CTRL`使用热键 ( ++ )时，我的剪贴板控制器可以将多个项目复制到剪贴板，而不是只复制一个项目，并一次粘贴所有项目 ( + `SHIFT`+ )，或直接粘贴前 10 个项目中的任何一个( + + ... ) . 另一种选择是清除剪贴板 ( ++ ) 。`Q``CTRL``SHIFT``W``CTRL``SHIFT``1``9``CTRL``SHIFT``-`

它仅适用于多次复制和粘贴，但随后尝试进行复制操作时不会将任何内容添加到缓冲区中。我找不到原因。

代码（问题应该在`addToClipboard()`or中`getAll()`）：

```
#include <GUIConstantsEx.au3>
#include <WindowsConstants.au3>
#include <array.au3>

Global $clipBoard[50]=[""]
Global $counter = 0

HotKeySet("^+q","addToClipboard")
HotKeySet("^+-","emptyAll")
HotKeySet("^+w","getAll")
HotKeySet("^+1","get1")
HotKeySet("^+2","get2")
HotKeySet("^+3","get3")
HotKeySet("^+4","get4")
HotKeySet("^+5","get5")
HotKeySet("^+6","get6")
HotKeySet("^+7","get7")
HotKeySet("^+8","get8")
HotKeySet("^+9","get9")

$hGUI = GuiCreate("Clipboard Controller", 100, 100,Default,Default,$WS_SIZEBOX)
GUISetState()

Func addToClipboard()
    Send ("^c")
    $copied = ClipGet()
    $clipBoard[Mod($counter,50)] = $copied
    $counter +=1
EndFunc

Func getByIndex($i)
    $statement = $clipBoard[$i]
    ClipPut($statement)
    Send("^v")
EndFunc

Func getAll()
    $statement =""
    For $i In $clipBoard
        If $i <> "" Then
            $statement &= $i & @CRLF
        EndIf
    Next
    ClipPut($statement)
    Send("^v")
EndFunc

Func emptyAll()
    For $i=0 To 49
        $clipBoard[$i]=""
    Next
    ClipPut("")
EndFunc

Func get1()
    getByIndex(0)
EndFunc

Func get2()
    getByIndex(1)
EndFunc

Func get3()
    getByIndex(2)
EndFunc

Func get4()
    getByIndex(3)
EndFunc

Func get5()
    getByIndex(4)
EndFunc

Func get6()
    getByIndex(5)
EndFunc

Func get7()
    getByIndex(6)
EndFunc

Func get8()
    getByIndex(7)
EndFunc

Func get9()
    getByIndex(8)
EndFunc

While 1
    Switch GUIGetMsg()
        Case $GUI_EVENT_CLOSE
            Exit
    EndSwitch
WEnd 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T12:16:39.030

问题是一个古老的陷阱......

复制到剪贴板需要很少的时间，尤其是大项目..发送后尝试睡眠

```
Func addToClipboard()
Send ("^c")
sleep(1000) ; try different values
    $copied = ClipGet()
$clipBoard[Mod($counter,50)] = $copied
$counter +=1
EndFunc 
```

反正喜欢你的剧本..idea

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:33:00.823

问题是代码`addToClipboard`正在运行，而用户仍然按下按键。结果，`Send`旨在发送的命令`Ctrl+C`实际上是正在发送`Ctrl+Shift+C`，因此永远不会复制文本。

解决方案是等待用户使用该`_IsPressed`功能抬起这些键，然后在释放所有键后执行代码。当您进入该功能时禁用热键（并在您离开时重新启用）也可能是明智的，这样长时间按住热键不会继续触发该功能。

另一种方法是将`WM_COPY`消息直接发送到具有焦点的控件。这不能保证对每个控件都有效（尽管如果没有，我会感到非常惊讶）。这将是一种更可靠的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T13:34:39.250

希望这是问题的结束，我找到了另一种从剪贴板设置/获取数据的方法，函数：`_ClipBoard_SetData ()`&`_ClipBoard_GetData()`从库`<Clipboard.au3>`中，在尝试它们之后效果很好，毕竟问题似乎在于从剪贴板设置和获取数据.. 稍后会出现 isA 以确保其最终是否正确

# javascript - Runaway jQuery - 页面随着时间的推移运行速度变慢

> ID：10505665
> 
> 赞同：2
> 
> 时间：2012-05-08T20:04:14.757
> 
> 标签：javascript, jquery, memory-leaks, cufon

我们有一个计时器，它删除无序列表中的顶部项目并将其移动到列表的底部。每个项目都有图像、自定义字体、翻转等。

出于某种原因，页面运行的时间越长，它变得越慢。将鼠标悬停在功能区上时，您会注意到延迟。色带应该在悬停时变成红色，但是当它变慢时，您会注意到可能需要几秒钟才能看到悬停状态。

我不知道为什么会这样。我相信我们正在适当地清理所有东西，但显然有问题。

这是有问题的页面... [http://gmfg.trailerparkinteractive.com/](http://gmfg.trailerparkinteractive.com/)

让我知道我是否可以提供任何其他详细信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T20:54:52.550

看来您有内存泄漏，[这是您检测到的方法](http://gent.ilcore.com/2011/08/finding-memory-leaks.html)。

似乎您的一个脚本正在短时间内分配和释放大量内存。

![内存泄漏](../Images/ae27437dabcb8b6cab1b4384305c7df2.png)

进一步深入研究保留树，我们发现一些 HTML 元素节点正在从 DOM 中删除但没有释放。

![保留树](../Images/6cb9332d6033819c8c3296a5f99272db.png)

我的建议是，尝试在禁用不同脚本的同时运行您的站点，并使用此方法重新测试以猜测哪个插件正在执行此操作。

# php - 有谁知道支持组合键的 Kohana 的最佳 ORM？

> ID：10505669
> 
> 赞同：2
> 
> 时间：2012-05-08T20:04:22.087
> 
> 标签：php, database, orm, kohana

有人知道支持复合键的 Kohana 的最佳 ORM 吗？我目前正在研究使用 Sprig 和 Jelly。

[http://kohana-modules.com/modules/sittercity/sprig](http://kohana-modules.com/modules/sittercity/sprig)

[https://github.com/jonathangeiger/kohana-jelly](https://github.com/jonathangeiger/kohana-jelly)

还没有实现，但一旦我有一个强有力的比较就会更新这个问题。在另一张纸条上，有没有人同时使用过哪一个更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:21:16.417

你看过LEAP吗？它支持复合键，我一直将它用于大型项目并且没有遇到问题。

[http://orm.spadefootcode.com/](http://orm.spadefootcode.com/)

# java - 每个 jar 的 logback 配置文件

> ID：10505674
> 
> 赞同：2
> 
> 时间：2012-05-08T20:04:45.697
> 
> 标签：java, logging, jar, classpath, logback

我想提供带有自己的[logback](http://logback.qos.ch/)日志配置的 jar 文件。配置 logback 的常用方法是使用 logback 库从类路径的根读取的默认文件 logback.xml（适用于应用程序服务器或不适用）。

您可以从主 logback 配置文件中[包含](http://logback.qos.ch/manual/joran.html#fileInclusion)其他文件（没有尝试过），但我不知道哪些 jar 将在类路径中，哪些需要日志配置。

另外，这些 jars 可以在命令行应用程序或应用程序服务器（共享库或非共享库）中使用。

我想也许我可以获取 jar 的文件路径并检查那里是否有配置文件，并尝试以编程方式读取配置并使用 JoranConfigurator 加载它。

```
// This is the way I find to get the path to the jar
String path = ClassThatWantsALogger.class.getProtectionDomain().getCodeSource()
            .getLocation().getPath();
String decodedPath = URLDecoder.decode(path, "UTF-8");// the path to the jar 
```

但是这种方法可能会失败，因为取决于安全限制，可能在 Linux 或应用程序服务器中失败。对于可能有更好解决方案的问题，这是一种艰难的方法。

您是否想像一种管理 jar 的方法可以拥有适用于任何环境的自己的 logback 配置文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:18:27.643

我会[引用自己](https://stackoverflow.com/a/7107934/696632)来回答您的问题：日志配置是客户端应用程序的关注点（关注点分离）。记录的地点、方式和内容由他决定。我们的图书馆不得对它强加任何东西。

# php - 是否可以区分使用 .htaccess 的图像热链接和常规链接？

> ID：10505678
> 
> 赞同：4
> 
> 时间：2012-05-08T20:04:58.000
> 
> 标签：php, .htaccess, hotlinking

我认为答案是否定的，但理想情况下，我希望能够允许图像盗链，但重定向常规链接。例如，如果有人使用它，它应该按预期工作：

```
<img src='http://mysite.com/image.jpg'/> 
```

但如果他们使用它，它会在访问时重定向到不同的页面：

```
<a href='http://mysite.com/image.jpg'>Click Here</a> 
```

我相信`$HTTP_REFERER`是一样的，不管这两种方法。有没有其他聪明的方法来区分这两者？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T16:56:17.987

许多浏览器`Accpet:`在这两种情况下发送不同的标头。

从以下位置请求资源时`<img src="xxx">`：

```
Accept: */* 
```

在地址栏中请求 url 时：

```
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 
```

# python - 这个函数调用是如何工作的？（涉及多对括号和装饰器）

> ID：10505679
> 
> 赞同：3
> 
> 时间：2012-05-08T20:04:58.050
> 
> 标签：python

在有关装饰器和“复合语句”的官方 Python 文档的此页面上，给出了以下代码示例：

[样品开始]

```
@f1(arg)
@f2
def func(): pass 
```

相当于：

```
def func(): pass
func = f1(arg)(f2(func)) 
```

[样本结束]

但是，我不明白'func = f1(arg)(f2(func))'。我以前从未见过这样的电话，我不知道这意味着什么。是使用不同参数进行多次调用，每对括号包含一个参数（第一个中的'arg'，第二个中的'f2（func）'），还是别的什么？我需要了解这一点才能学习装饰器。另外，这在 Python 2.7 中有效吗？我咨询过的关于装饰器的网站之一是关于 Python 3.2 的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:08:21.997

你需要知道的是，函数是第一类对象——你可以像`int`s 或`str`s 一样传递函数。

`f1`返回一个函数，因此您发布的内容类似于：

```
def func(): pass
f1_ret = f1(arg)
f2_ret = f2(func)
func = f1_ret(f2_ret) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:08:41.263

Python 函数调用的结果与其他任何值一样。如果你愿意，你可以`func = f1(arg)(f2(func))`写成

```
def func(): pass
x = f2(func)
y = f1(arg)
func = y(x) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T20:08:50.773

接受参数的装饰器必须*返回*一个执行实际装饰的函数。所以`@f1(arg)`调用`f1(arg)`。`f1`返回一个函数，可以使用通常的`(...)`符号来调用它：`f1(arg)(...)`. 第二组括号中的内容是什么？被装饰的函数，这是`f2(func)`因为第二个装饰器。所以把它们放在一起，你就得到了`f1(arg)(f2(func))`。

那么，您缺少的部分是`f1`返回一个函数，而第二组括号正在调用返回的函数。

# session - 从会话请求后哈希图值更改

> ID：10505680
> 
> 赞同：0
> 
> 时间：2012-05-08T20:04:59.450
> 
> 标签：session, jakarta-ee, hashmap

我从事 Java/HTML 项目。我已将哈希图设置为会话属性。我从会话中请求哈希图并将键/值放入其中 `map.put("some string", "1")` 。当第二次执行此操作时，我打印了 hashmap 内容并且唯一的值，即在 hashmap 上的最后一次操作之后为“1”，变为“-1”。

在我看来，Hashmap 是这个项目最好的数据结构。任何人都可以帮忙吗？

```
public class Cart {
    private HashMap<String, asd> list;

    public Cart(){
        list = new HashMap<String, asd>();
    }

    public HashMap<String, asd> getMap(){
        return list;
    }

    /*
     * Parameter: code
     *      -1: increase quantity by 1
     *      0: delete product from the product list
     *      else: set the product quantity to the passed value
     */
    public void alterProduct(int code, String product){
        if(list.containsKey(product)) {
            if(code == -1) plusOne(product);
            if(code == 0) remove(product);
            else setValue(product, code);
        }else {
            asd asd = new asd();
            asd.a = 1;
            list.put(product, asd);
        }
    }

    private void plusOne(String product){
        asd asd = list.get(product);
        asd.a = asd.a + 1;
        list.put(product, asd);
    }

    private void remove(String product){
        list.remove(product);
    }

    private void setValue(String product, int code){
        asd asd = new asd();
        asd.a = code;
        list.put(product, asd);
    }
}

class asd{
    int a;

    public String toString(){
        return ""+a;
    }
} 
```

`Cart`我将对象设置为会话属性的JSP 代码：

```
<%
    Cart myCart = new Cart();
    session.setAttribute("cart",myCart);
%> 
```

小服务程序代码：

```
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // TODO Auto-generated method stub
        Cart cart = (Cart) request.getSession().getAttribute("cart");
        cart.alterProduct(-1, (String) request.getSession().getAttribute("name"));
        doGet(request, response);
    } 
```

在我`alterProduct`第二次调用相同`(String) request.getSession().getAttribute("name")`的值后，相同键的哈希映射值为'-1'。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T07:54:12.130

什么是产品类型/价值？它是如何连接到“购物车”的？

我猜你搞砸了数据类型会发生什么。另一种选择是您的`Cart.toString()`方法中有错误。我建议您使用“普通”数据类型更改代码并重新检查。如果失败，请使用您的 Cart 类而不进行混乱的转换并调试代码。

你这里有错误：

```
 public void alterProduct(int code, String product){
    if(list.containsKey(product)) {
      if(code == -1) plusOne(product);
      if(code == 0) remove(product);
      else setValue(product, code);
  }

  private void setValue(String product, int code){
    asd asd = new asd();
    asd.a = code;
    list.put(product, asd);
  } 
```

考虑第二次打电话时会发生什么`art.alterProduct(-1, "something")`。 `list.containsKey(product)`是真的（你使用相同的产品”），代码是-1。所以

`if(code == -1) plusOne(product);`按预期执行。

但是你有一些奇怪的东西

`if(code == 0) remove(product); else setValue(product, code);`

`code ==0`被评估为假，所以**调用 else 指令**。你在打电话`setValue(product, -1)`

正如您在上面看到的，setValue 会将 -1 分配给您观察到的 asd.a。

# orm - kohana ORM 关系

> ID：10505686
> 
> 赞同：0
> 
> 时间：2012-05-08T20:05:23.090
> 
> 标签：orm, kohana, relationship, belongs-to

我有两张桌子。

```
Table1 { Column1, Column2 }

Table2 { Column1, Column2 } 
```

我的关系如下：

```
Table1.Column1 belongs_to Table2.Column2 
```

所以在 Table1_Model 中：

```
protected $_belongs_to = array('Table2' => array('foreign_key' => 'Column1')); 
```

但是我应该如何指定我想将它连接到 Table2.Column2？Table2.Column2 不是主索引。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:40:02.640

我不知道你为什么会有这样的关系。

如果 table1 属于 table2，那么我会将其视为：

`Table1.Column2 belongs_to Table2.Column1`，因为 Table1.Column2 是链接 Table2 主键的外键。

所以 Table1_Model 中的关系是：

`protected $_belongs_to = array('Table2' => array('foreign_key' => 'Column2'));`

更多信息在这里： http: [//kohanaframework.org/3.2/guide/orm/relationships](http://kohanaframework.org/3.2/guide/orm/relationships)

# ruby-on-rails - Ubuntu升级后Rails连接到MySQL的未初始化常量错误

> ID：10505687
> 
> 赞同：1
> 
> 时间：2012-05-08T20:05:24.880
> 
> 标签：ruby-on-rails

我刚刚将 Ubuntu 从 11.10 升级到 12.04，当我尝试在 Rails 2.3.14 中本地运行项目时，出现此错误：

> 未初始化的常量 MysqlCompat::MysqlRes

有没有办法轻松解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T20:09:13.680

您应该重新安装用于连接数据库的 gem。

例如，如果您使用的是`mysql2`gem，那么您可以执行以下操作：

```
gem uninstall mysql2
gem install mysql2 
```

这将重新构建 Ubuntu 升级搞砸的原生扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:17:19.033

在升级宝石时，有时会搞砸。无需卸载，重新安装即可。

```
gem install mysql2 
```

我在 mysql gem 上也看到过这种情况。

# xamarin.ios - 根据构建类型设置 Info.plist 版本号的自定义命令的正确类型？

> ID：10505688
> 
> 赞同：2
> 
> 时间：2012-05-08T20:05:28.683
> 
> 标签：xamarin.ios, monodevelop

我正在尝试根据构建类型（设备/模拟器或调试/发布）设置我的应用程序的版本号，以便我可以从开发人员构建报告的崩溃中筛选出我在野外实际构建中看到的崩溃。

我通过使用构建后自定义命令来执行此操作，该命令的问题是它在应用程序包签名后修改 plist 文件，导致我无法部署到实际设备的应用程序。

似乎如果我将其作为构建步骤执行，它会避免该问题，但我担心它可能与我认为在某处发生的 plist 合并步骤冲突。

有没有正确的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T18:35:14.367

在合并之前，您可以尝试预构建步骤来修改项目中的 Info.plist。这很老套，但在我们将 MonoTouch 移植到 xbuild 引擎之前可能不会有更好的方法，xbuild 引擎的可扩展性要高得多——而且还没有时间表。

# assembly - lea 0x0(%esi),%esi是什么意思

> ID：10505690
> 
> 赞同：9
> 
> 时间：2012-05-08T20:05:33.943
> 
> 标签：assembly, disassembly

```
lea    0x0(%esi),%esi 
```

我相信它没有结果，只是在填充空间。是这样吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-08T20:07:59.597

它是一个 NOP。它将 %esi 和 0x0 的内容相加，并将结果放入 %esi。有些人要么有一个笨拙的代码生成器，要么需要填充 N 个字节，其中这条指令的大小是正确的。

LEA 指令执行速度非常快（通常为 1 个时钟），因此这比 N 个 nop 好得多。

x86 与它一样古怪，有各种指令，除了填充不同数量的字节外，它们实际上什么都不做。您可能会发现其他不同长度的无用指令。您往往会发现很长但在 1 个时钟或更短的时间内执行的指令。

AMD x86-64 手册有一些关于 NOP 应该使用什么的建议；他们建议在实际 NOP IIRC 之前重复多次前缀操作码之一。这样的前缀操作码很快就会被指令获取引擎消耗掉；大多数情况下，它们的成本隐藏在指令预取中，而不是指令执行时间中。

# android - Android DatePicker 月份为整数

> ID：10505691
> 
> 赞同：1
> 
> 时间：2012-05-08T20:05:35.443
> 
> 标签：android, datepicker

我有一个简单的问题，但经过一段时间的搜索，我还没有找到答案。在 DatePicker 中，是否可以将月份更改为整数而不是字符串？例如：{1,2,3..} 不是 {jan,feb,mar...}

**编辑：**

尽管@kaneda 的解决方案似乎有效，但至少在android 3.0 中方法和属性不一样。我正在使用的代码是这样的：

```
public DatePickerCustom(Context context, AttributeSet attrs) {
       super(context, attrs);
       Field[] fields = DatePicker.class.getDeclaredFields();
       try {
           for (Field field : fields) {
               field.setAccessible(true);
               if (TextUtils.equals(field.getName(), "mMonthSpinner")) {
                   Method m =     field.getType().getDeclaredMethod("setDisplayedValues", String[].class);
                   m.setAccessible(true);
                   String[] s = new String[]     {"01","02","03","04","05","06","07","08","09","10","11","12"};
                   Object[] params = new Object[1];
                   params[0] = s;
                   m.invoke(field.get(this), params);
                   break;
               }
           }
       }
       catch (Exception e) {
           System.out.println(e.getMessage());
           e.printStackTrace();
       }
    } 
```

**编辑2：**

最好的解决方案是创建一个自定义 DatePicker（遵循@kaneda 的第一个建议），它将始终在没有兼容性问题的情况下工作，并且不会通过反射进行中继。

使用了来自 android的[date_picker.xml和 @kaneda 发布的 DatePicker.java。](http://www.devdaily.com/java/jwarehouse/android-examples/platforms/android-2/data/res/layout/date_picker.xml.shtml)此外，我使用了自定义 NumberPicker（因为 DatePicker 小部件使用的是 android 内部的）。对于 NumberPicker 小部件，我点击了这个[链接](http://www.quietlycoding.com/?p=5)。

在 CustomDatePicker 中，我对该函数进行了注释`getShortMonths()`并将月份范围设置为`mMonthPicker.setRange(1, NUMBER_OF_MONTHS);`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T04:49:02.373

对于最佳实践，我认为如果您`DatePicker`通过创建自己的布局来创建自己的自定义，这对您来说是最正确和最容易的，所以我建议您查看它的源代码以供参考：

[安卓源代码](http://source.android.com/source/downloading.html)

或者

[这里](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2.2_r1/android/widget/DatePicker.java)

这就是花哨的方式。丑陋的方式，你可以这样做：

**安卓版本 < 3.0**

```
package my.pkg;
...
class MyDatePicker extends DatePicker {

    public MyDatePicker(Context context, AttributeSet attrs) {
        super(context, attrs);
        Field[] fields = DatePicker.class.getDeclaredFields();
        try {
            for (Field field : fields) {
                field.setAccessible(true);
                if (TextUtils.equals(field.getName(), "mMonthPicker")) {
                    Method m = field.getType().getDeclaredMethod("setRange", int.class, int.class, String[].class);
                    m.setAccessible(true);
                    String[] s = new String[] {"01","02","03","04","05","06","07","08","09","10","11","12"};
                    m.invoke(field.get(this), 1, 12, s);
                    break;
                }
            }
        }
        catch (Exception e) {
            System.out.println(e.getMessage());
            e.printStackTrace();
        }
    }

} 
```

**Android 版本 >= 3.0（仅构造函数）**

```
public MyDatePicker(Context context, AttributeSet attrs) {
    super(context, attrs);
    Field[] fields = DatePicker.class.getDeclaredFields();
    try {
        String[] s = new String[] {"01","02","03","04","05","06","07","08","09","10","11","12"};
        for (Field field : fields) {
            field.setAccessible(true);
            if (TextUtils.equals(field.getName(), "mMonthSpinner")) {
                NumberPicker monthPicker = (NumberPicker) field.get(this);
                monthPicker.setDisplayedValues(s);
            } 
            if (TextUtils.equals(field.getName(), "mShortMonths")) {
                field.set(this, s);
            }
        }
    }
    catch (Exception e) {
        System.out.println(e.getMessage());
        e.printStackTrace();
    }
} 
```

然后是样板xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <my.pkg.MyDatePicker
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />
</LinearLayout> 
```

![在此处输入图像描述](../Images/b77214f14cf238e69e8c40986b16da70.png)

# orchardcms - 您如何配置 Orchard CMS 以使用默认（空）子域？

> ID：10505695
> 
> 赞同：1
> 
> 时间：2012-05-08T20:06:01.450
> 
> 标签：orchardcms, subdomain, domain-name

我已经运行了 Orchard CMS，`www.example.com`但我也希望它能够接收到`example.com`（无子域）的请求。

这是如何实现的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:25:11.600

将永久重定向从一个重定向到另一个。这对 SEO 来说是正确的。

# java - alpha通道怎么可能是-1？

> ID：10505702
> 
> 赞同：0
> 
> 时间：2012-05-08T20:06:51.810
> 
> 标签：java, alpha

我想知道单个像素的 alpha 通道如何为-1？我正在浏览 PNG 图像的每个像素（加载在缓冲图像中，ARGB 类型）。许多 alpha 值是 -1（其他值大于零） - 这怎么可能？值不应该在 0 到 255 之间吗？代码如下。感谢您的任何提示！

```
// imagine some great loop for x and y before this code
int a = (scaledImage.getRGB(x, y) & 0xff000000) >> 24; // kill all bits except for the first 8, shift 24 to the right to get them
System.out.println("" + a); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:09:04.640

您遇到了符号扩展问题。请改用无符号移位运算符`>>>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:09:31.043

如果将其视为无符号整数，则 -1 = 0xFF = 255。这只是解释 alpha 通道 255 值的另一种方式。

# c# - 使用 Moq 存根接口方法

> ID：10505704
> 
> 赞同：11
> 
> 时间：2012-05-08T20:07:01.810
> 
> 标签：c#, .net, unit-testing, moq, stub

> **可能重复：**
> [如何模拟一个返回 int 且最小起订量的方法](https://stackoverflow.com/questions/3962636/how-to-mock-a-method-that-returns-an-int-with-moq)

这是我的界面：

```
public interface ICalenderService
    {
        DateTime Adjust(DateTime dateToAdjust, BusinessDayConvention convention, List<HolidayCity> holidayCities);
    } 
```

我已经做了一些研究，看起来你可以很容易地模拟这个，但我想使用 Moq 将它存根，这样我就可以将存根传递给我的其他类构造函数，并让存根返回`DateTime`我想要的任何`Adjust`方法。

最简单的方法是什么？

编辑：我知道我可以在我的项目中创建自己的存根，但我想编写更少的代码，我认为 Moq 可以让我这样做，我只是不知道语法是什么样的。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-08T20:18:15.390

像这样设置存根：

```
var calendarServiceStub = new Mock<ICalenderService>();

calendarServiceStub
    .Setup(c => c.Adjust(It.IsAny<DateTime>(), It.IsAny<BusinessDayConvention>(), It.IsAny<List<HolidayCity>>()))
    .Returns(theDateTimeResultYouWant); 
```

传递`calendarServiceStub.Object`给另一个类的构造函数。

# iphone - 如何以编程方式设置 UITableView 部分标题（iPhone/iPad）？

> ID：10505708
> 
> 赞同：113
> 
> 时间：2012-05-08T20:07:12.200
> 
> 标签：iphone, ipad, uitableview, uistoryboard, iboutlet

我`UITableView`在 Interface Builder 中使用`storyboards`. `UITableView`设置有许多不同的`static cells`部分。

我遇到的问题是我试图用几种不同的语言设置我的应用程序。为此，我需要能够以`UITableView`某种方式更改章节标题。

请问有人可以帮我吗？理想情况下，我想使用来解决这个问题，`IBOutlets`但是我怀疑在这种情况下这甚至是不可能的。任何意见和建议将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：288
> 
> 时间：2012-05-08T20:27:53.500

将 UITableView 连接到控制器后`delegate`，`datasource`您可以执行以下操作：

### 对象

```
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {

    NSString *sectionName;
    switch (section) {
        case 0:
            sectionName = NSLocalizedString(@"mySectionName", @"mySectionName");
            break;
        case 1:
            sectionName = NSLocalizedString(@"myOtherSectionName", @"myOtherSectionName");
            break;
        // ...
        default:
            sectionName = @"";
            break;
    }    
    return sectionName;
} 
```

* * *

### 迅速

```
func tableView(_ tableView: UITableView, titleForHeaderInSection section: Int) -> String? {

    let sectionName: String
    switch section {
        case 0:
            sectionName = NSLocalizedString("mySectionName", comment: "mySectionName")
        case 1:
            sectionName = NSLocalizedString("myOtherSectionName", comment: "myOtherSectionName")
        // ...
        default:
            sectionName = ""
    }
    return sectionName
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-12-02T10:58:56.480

如果您正在使用 Swift 编写代码，它看起来像这样的示例

```
func tableView(tableView: UITableView, titleForHeaderInSection section: Int) -> String?
{
    switch section
    {
        case 0:
            return "Apple Devices"
        case 1:
            return "Samsung Devices"
        default:
            return "Other Devices"
    }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-08T20:12:25.987

使用 UITableViewDataSource 方法

```
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-11-15T04:44:56.120

**titleForHeaderInSection**是*UITableView 的委托方法，*因此应用部分写入的标题文本如下，

```
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section{
    return @"Hello World";
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-08-29T10:00:23.350

请注意，如果在 UITableView 的委托中实现，`-(NSString *)tableView: titleForHeaderInSection:`则不会被 UITableView 调用；`- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-07-31T14:43:47.207

我不知道过去版本的`UITableView`协议，但从 iOS 9 开始，`func tableView(tableView: UITableView, titleForHeaderInSection section: Int) -> String?`它是`UITableViewDataSource`协议的一部分。

```
 class ViewController: UIViewController {

      @IBOutlet weak var tableView: UITableView!

      override func viewDidLoad() {
         super.viewDidLoad()
         tableView.dataSource = self
      }
   }

   extension ViewController: UITableViewDataSource {
      func tableView(tableView: UITableView, titleForHeaderInSection section: Int) -> String? {
         return "Section name"
      }
   } 
```

您无需声明`delegate`即可用数据填充表格。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-05-30T11:22:56.727

```
- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section
{
   return 45.0f; 
//set height according to row or section , whatever you want to do!
} 
```

部分标签文本已设置。

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    UIView *sectionHeaderView;

        sectionHeaderView = [[UIView alloc] initWithFrame:
                             CGRectMake(0, 0, tableView.frame.size.width, 120.0)];

    sectionHeaderView.backgroundColor = kColor(61, 201, 247);

    UILabel *headerLabel = [[UILabel alloc] initWithFrame:
                            CGRectMake(sectionHeaderView.frame.origin.x,sectionHeaderView.frame.origin.y - 44, sectionHeaderView.frame.size.width, sectionHeaderView.frame.size.height)];

    headerLabel.backgroundColor = [UIColor clearColor];
    [headerLabel setTextColor:kColor(255, 255, 255)];
    headerLabel.textAlignment = NSTextAlignmentCenter;
    [headerLabel setFont:kFont(20)];
    [sectionHeaderView addSubview:headerLabel];

    switch (section) {
        case 0:
            headerLabel.text = @"Section 1";
            return sectionHeaderView;
            break;
        case 1:
            headerLabel.text = @"Section 2";
            return sectionHeaderView;
            break;
        case 2:
            headerLabel.text = @"Section 3";
            return sectionHeaderView;
            break;
        default:
            break;
    }

    return sectionHeaderView;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-09-20T12:21:35.117

> 其他答案没有错，但这个提供了一种非编程解决方案，在静态表较小的情况下可能很有用。好处是可以使用故事板组织本地化。可以继续通过 XLIFF 文件从 Xcode 导出本地化。Xcode 9 还提供了几个[新工具来简化本地化](https://www.ibabbleon.com/copywriter-translator/2017/06/whats-new-in-localization-in-xcode-9-ios-11/)。

（原来的）

我有类似的要求。我的 Main.storyboard(Base) 中有一个带有静态单元格的静态表。要使用 .string 文件本地化章节标题，例如 Main.strings(German)，只需在情节提要中选择章节并记下对象 ID

[![对象 ID](../Images/89d1202957c8545460323022eb269978.png)](https://i.stack.imgur.com/15zvb.png)

然后转到您的字符串文件，在我的情况下为 Main.strings(German) 并插入翻译，如：

```
"MLo-jM-tSN.headerTitle" = "Localized section title"; 
```

## 其他资源：

*   [苹果 WWDC 2017](https://developer.apple.com/videos/play/wwdc2017/401/)
*   [关于本地化的中篇文章 ~ Xcode 9 / Swift 4](https://medium.com/@ezeokeonyekachi_84156/localization-of-ios-app-in-swift-4-and-xcode-9-3c7c7d53ae11)

# java - 在文本中查找常用短语

> ID：10505709
> 
> 赞同：0
> 
> 时间：2012-05-08T20:07:13.410
> 
> 标签：java, text

过去我写过代码来查找正文中的常用词，但我很好奇是否有一种已知的方法可以在正文中查找常用短语？（在Java中）

有谁知道如何在没有 Lucene 或 nlp 的情况下完成这样的事情？还有哪些其他工具或解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:43:29.460

如果不确切知道您想做什么，就很难给您答案。对您的问题的一个天真的答案是将文本拆分为标点符号，并使用数据结构来存储文本中每个句子的计数器，为您从文本中解析的每个句子增加计数器。

例如，您可以使用优先级队列来保持句子按其计数器排序。然后，您可以删除 n 次最常见句子的最大元素 n 次，或者弹出句子，直到计数器大于您想要的数字。

但是，如果您不想要精确的句子，则要么必须更改存储在优先级队列中的内容，要么必须完全使用另一种算法。

希望这至少有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:58:44.030

有点间接的算法：

可以创建一个**置换索引**：对于每个句子中的所有单词，存储句子并对单词进行排序，然后是剩余的句子，然后是之前的所有句子。前部分无关紧要。

然后你应该能够计算两个或更多单词的常用短语。

# mysql - 从 MySQL 迁移到 SQL Server，存在约束问题

> ID：10505711
> 
> 赞同：14
> 
> 时间：2012-05-08T20:07:27.313
> 
> 标签：mysql, sql, sql-server, sql-server-2008-r2, sql-server-migration-assi

我创建了一个使用 MySQL 数据库的 Web 应用程序，但我必须将数据库迁移到**Microsoft SQL Server 2008 R2**并且我正在使用**SQL Server 迁移助手**(SSMA)。

对于某些使用外键的表，我的报告中出现错误。

## 1.自引用外键

我有一个表在行之间具有父子关系；**地**图表：

```
| map_id | map_title           | latitude  | longitude  | map_zoom | map_parent |
|:------:|:-------------------:|:---------:|:----------:|:--------:|:----------:|
| 1      | My Parent Map       | 50.364829 | -52.635623 | 17       | NULL       |
| 2      | Some Child Map      | 50.366916 | -52.634718 |          | 1          |
| 3      | Another Child Map   | 50.364898 | -52.634543 |          | 1          |
| 4      | My Last Example Map | 50.361986 | -52.638891 |          | 3          | 
```

SQL Server 迁移助手 (SSMA) 生成的报告显示将用于在 SQL Server 中创建表的 SQL。

**MySQL**（来源）：

```
1  CREATE
2      TABLE `map`
3          (
4              `map_id` int(11) UNSIGNED NOT NULL  AUTO_INCREMENT, 
5              `map_title` varchar(50) DEFAULT NULL, 
6              `latitude` varchar(12) DEFAULT NULL, 
7              `longitude` varchar(12) DEFAULT NULL, 
8              `map_zoom` varchar(5) NOT NULL, 
9              `map_parent` int(11) UNSIGNED DEFAULT NULL, 
10               PRIMARY KEY  (`map_id`) , 
11               KEY `map_parent`  (`map_parent`) , 
12               CONSTRAINT `map_ibfk_2` FOREIGN KEY  (`map_parent`)  REFERENCES `map`  (`map_id`)   ON DELETE CASCADE   ON UPDATE CASCADE 
13          )  ENGINE = InnoDB AUTO_INCREMENT = 12 DEFAULT  CHARSET = utf8; 
```

**SQL Server**（目标，由 SSMA 生成的 SQL）：

```
1  CREATE TABLE dbo.map
2  (
3      map_id bigint NOT NULL IDENTITY(12, 1), 
4      map_title nvarchar(50) NULL DEFAULT NULL, 
5      latitude nvarchar(12) NULL DEFAULT NULL, 
6      longitude nvarchar(12) NULL DEFAULT NULL, 
7      map_zoom nvarchar(5) NOT NULL, 
8      map_parent bigint NULL DEFAULT NULL, 
9      CONSTRAINT PK_map_map_id PRIMARY KEY (map_id), 
10      /* 
11      *   SSMA error messages:
12      *   M2SS0040: ON DELETE  CASCADE|SET NULL|SET DEFAULT action  was changed to NO ACTION to avoid circular references of cascaded foreign keys.
13  
14      CONSTRAINT map$map_ibfk_2 FOREIGN KEY (map_parent) REFERENCES dbo.map (map_id) 
15           ON DELETE NO ACTION 
16          /* 
17          *   SSMA error messages:
18          *   M2SS0036: ON UPDATE CASCADE|SET NULL|SET DEFAULT action  was changed to NO ACTION to avoid circular references of cascaded foreign keys.
19  
20           ON UPDATE NO ACTION
21          */
22  
23  
24      */
25  
26  
27  )
28  GO
29  CREATE NONCLUSTERED INDEX map_parent
30      ON dbo.map (map_parent ASC)
31  GO 
```

正如您所看到的，它给出了一个错误，表明它更改了 my `ON UPDATE CASCADE`and`ON DELETE CASCADE`以`NO ACTION` “避免级联外键的循环引用”。

## 2.多对多表

我有两个表出现“多路径”错误，并且类似地更改为`NO ACTION`.

**资产属性**表：

```
| asset_id | property_id | property_value  |
|:--------:|:-----------:|:---------------:|
| 933      | 1           | Joseph          |
| 933      | 2           | Green           |
| 936      | 1           | Jacob           |
| 936      | 2           | Yellow          |
| 942      | 1           | Susan           |
| 942      | 2           | Blue            | 
```

**MySQL**（来源）：

```
1  CREATE
2      TABLE `asset_property`
3          (
4              `asset_id` int(11) NOT NULL, 
5              `property_id` int(11) NOT NULL, 
6              `property_value` varchar(100) DEFAULT NULL, 
7               PRIMARY KEY  (`asset_id`, `property_id`) , 
8               KEY `asset_id`  (`asset_id`) , 
9               KEY `property_id`  (`property_id`) , 
10               CONSTRAINT `asset_property_ibfk_1` FOREIGN KEY  (`asset_id`)  REFERENCES `asset`  (`asset_id`)   ON DELETE CASCADE   ON UPDATE CASCADE , 
11               CONSTRAINT `asset_property_ibfk_2` FOREIGN KEY  (`property_id`)  REFERENCES `property`  (`property_id`)   ON DELETE CASCADE   ON UPDATE CASCADE 
12          )  ENGINE = InnoDB DEFAULT  CHARSET = utf8; 
```

**SQL Server**（目标，由 SSMA 生成的 SQL）：

```
1  CREATE TABLE dbo.asset_property
2  (
3      asset_id int NOT NULL, 
4      property_id int NOT NULL, 
5      property_value nvarchar(100) NULL DEFAULT NULL, 
6      CONSTRAINT PK_asset_property_asset_id PRIMARY KEY (asset_id, property_id), 
7      /* 
8      *   SSMA error messages:
9      *   M2SS0041: ON DELETE CASCADE|SET NULL|SET DEFAULT action was changed to NO ACTION to avoid multiple paths in cascaded foreign keys.
10  
11      CONSTRAINT asset_property$asset_property_ibfk_1 FOREIGN KEY (asset_id) REFERENCES dbo.asset (asset_id) 
12           ON DELETE NO ACTION 
13          /* 
14          *   SSMA error messages:
15          *   M2SS0037: ON UPDATE CASCADE|SET NULL|SET DEFAULT action was changed to NO ACTION to avoid multiple paths in cascaded foreign keys.
16  
17           ON UPDATE NO ACTION
18          */
19  
20  
21      */
22  
23  , 
24      CONSTRAINT asset_property$asset_property_ibfk_2 FOREIGN KEY (property_id) REFERENCES dbo.property (property_id) 
25           ON DELETE CASCADE 
26           ON UPDATE CASCADE
27  )
28  GO
29  CREATE NONCLUSTERED INDEX asset_id
30      ON dbo.asset_property (asset_id ASC) 31  GO 32  CREATE NONCLUSTERED INDEX property_id
33      ON dbo.asset_property (property_id ASC) 34  GO 
```

我只找到了[一篇](http://blogs.msdn.com/b/ssma/archive/2011/03/19/mysql-to-sql-server-migration-method-for-correcting-schema-issues.aspx)讨论这些错误的文章。文章对自引用表错误的解决方案似乎并不适用，而多对多错误解决方案只是删除约束“因为应用程序或用户不应该修改这些值”。

谢谢你的帮助！！

* * *

![数据库图](../Images/ff1276858be1fdf6bd6aeb010da72c6c.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T05:42:38.490

我对 SSMA 没有经验，我使用 SSIS 迁移数据库。阅读您的问题后，我想我可以给您一些建议。

您在数据库中创建了循环依赖关系。当您的数据库具有循环依赖关系并且您在两个依赖表中都有数据时，如果要迁移数据，您必须禁用目标数据库中的键约束。避免第二个问题应该避免级联选项，而是使用存储过程或触发器。

你可以看看这个链接：

[http://blogs.msdn.com/b/ssma/archive/2011/03/19/mysql-to-sql-server-migration-method-for-correcting-schema-issues.aspx](http://blogs.msdn.com/b/ssma/archive/2011/03/19/mysql-to-sql-server-migration-method-for-correcting-schema-issues.aspx)

我已经测试了链接，它工作正常

# c++ - 使用空 std::vector 的地址调用 C 函数

> ID：10505712
> 
> 赞同：1
> 
> 时间：2012-05-08T20:07:27.393
> 
> 标签：c++, stdvector

如果我有一个可以容纳 100 个字符的 std::vector 缓冲区，并且我调用一个 C 函数，它将写入一个 NULL 终止的字符串，就像`writestring(&buffer[0], buffer.size())`我读过的那样，如果缓冲区中已经有数据，那就没问题了。但如果向量为空，则行为未定义。我该如何解决这个问题，我可以向缓冲区写入一些东西，比如“qwerty”，然后调用 writestring() 以便我知道行为总是被定义的吗？你们在调用 C 函数时使用什么样的存储？我刚刚阅读了有关 .data 的信息，但我不知道它有多常见或可移植。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:08:51.310

C++

```
std::vector<char> v;
v.resize(100);
writestring(&v[0], v.size()); 
```

C

```
void writestring(char*p, size_t len) {
  strncpy(p, "Doofi", len);
} 
```

> 如果向量为空，则行为未定义。我该如何解决？

通过传递一个非空缓冲区。使用该`.resize()`方法快速填充向量，或将其构造为最初的正确大小：`std::vector<int> v(100);`.

> 你们在调用 C 函数时使用什么样的存储？

`std::vector`是这个应用程序的一个不错的选择。对于 C，它看起来就像一个数组或 malloc 的区域。但是，要意识到 C 的指针只有在向量没有被重新分配或销毁时才有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T20:10:04.583

首先调整向量的大小：

```
buffer.resize(100);
writestring(buffer.data(), buffer.size());  // buffer.data() == &buffer[0] 
```

或者，一次性构建所需大小的缓冲区：

```
std::vector<char> buffer(100); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T21:10:43.277

我认为您应该测试缓冲区是否为空。如果为空，则不要调用 writestring。

# matlab - 在可变数量的点之间调试样条曲线的构造

> ID：10505713
> 
> 赞同：1
> 
> 时间：2012-05-08T20:07:32.490
> 
> 标签：matlab, interpolation, splines

给定 x 和 y 中的点数，我想创建与所有点相交并且在交叉点具有相同斜率的样条线。

我的方法是为点的交点建立一组方程，并在交点处规定相等的斜率，然后使用 fsolve() 来确定系数。

然而，在绘制找到的样条曲线时，尽管它们与 x 和 y 中给出的正确点相交，但它们在相交点处的斜率不同。

我一直在尝试调试这个脚本两天的大部分时间，但没有任何运气。有人能指出为什么我的样条曲线没有得到正确的斜率吗？还是 fsolve() 在找到令人满意的解决方案之前退出？

主文件：

```
result = fsolve(@(K) eqns(x,y,K) , ones(1,(size(x,1)-1)*3) ); %Calls eqns() in eqns.m

A = result(1 : size(x,1)-1 );
B = result(size(x,1) : 2*size(x,1)-2 );
C = result(2*size(x,1)-1 : 3*size(x,1)-3 );

%Plot splines
splinePts = size(A,2)*100;
x_spline = [0 : x(end)/splinePts : x(end)];
fx = ones(splinePts,1);
for i = 1:size(A,2)
    for j = 1:100
        k = i*100-100 + j;
        fx(k) = A(i) * x_spline(k)^2 + B(i) * x_spline(k) + C(i);
    end
end

plot(fx); 
```

eqns.m

```
function fcns=eqns(x,y,K)

A = K(1 : size(x,1)-1 ); %Coefficients for X^2
B = K(size(x,1) : 2*size(x,1)-2); %Coefficients for X
C = K(2*size(x,1)-1 : 3*size(x,1)-3); %Constants

%Equations for hitting all points
syms H;
temp = H; %Initiate variable for containing equations.

for i = 1:size(B,2)
    temp(end+1) = eqn(x(i),y(i),A,B,C,i); %Calls eqn() in eqn.
    temp(end+1) = eqn(x(i+1),y(i+1),A,B,C,i);
end

%Equations for slopes at spline intersections
syms X;
temp(end+1) = subs( diff(eqn(X,0,A,B,C,1),X) - 0 , 'X' , x(1) );

for i = 1:size(A,2)-1
    temp(end+1) = subs( diff(eqn(X,1,A,B,C,i),X) - diff(eqn(X,1,A,B,C,i+1),X) , 'X' , x(i)+1 );
end

fcns = double( temp(2:end) );

end 
```

eqn.m

```
function fcn=eqn(X,Y,A,B,C,i)

fcn = A(i)*X^2 + B(i)*X + C(i) - Y;

end 
```

# php - 如何更改 App 按钮的值？

> ID：10505715
> 
> 赞同：0
> 
> 时间：2012-05-08T20:07:55.943
> 
> 标签：php, facebook

> **可能重复：**
> [如何更改“转到应用程序”按钮？](https://stackoverflow.com/questions/10476189/how-to-change-the-go-to-app-button)

我需要改变

![在此处输入图像描述](../Images/958bd3c0b0ffcb677ff424ae0452c242.png)

命名为

![在此处输入图像描述](../Images/3ae21bac9e38178f7476b43069ced455.png)

我怎样才能做到这一点？。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:12:10.880

如果您没有使用 Facebook 的默认操作类型之一，您可能根本无法影响该按钮的文本。

# parsing - 这个语法是 LR(1) 而不是 SLR(1)？

> ID：10505717
> 
> 赞同：7
> 
> 时间：2012-05-08T20:07:59.230
> 
> 标签：parsing, grammar, conflict, context-free-grammar, lr

我有以下语法，我被告知是 LR(1) 但不是 SLR(1)：

> **S** ::= 一个**A** | b **A** c | 直流| bda
> 
> **一个**::= d

我不明白为什么会这样。你将如何证明这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-23T06:13:24.023

我没有足够的声誉来评论上述答案，而且我对这个问题有点晚了，但是......

我在其他地方看到过这个语法作为一个例子，而 OP 实际上打错了。它应该是：

**S** ::= **A** a | b **A** c | 直流| bda

**一个**::= d

即，**S**的第一个子句是' **A** a'，而不是'a **A** '。

在*这种*情况下，A 的 FOLLOWS 集是 { $, a, c} 并且在状态 8 中存在 SLR 冲突。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-02T21:32:53.963

One way to figure this out would be to try to construct LR(1) and SLR(1) parsers for the grammar. If we find any shift/reduce or reduce/reduce conflicts in the course of doing so, we can show that the grammar must not belong to one of those classes of languages.

Let's start off with the SLR(1) parser. First, we need to compute the LR(0) configurating sets for the grammar. These are seen here:

```
(1)
S -> .aA
S -> .bAc
S -> .dc
S -> .bda

(2)
S -> a.A
A -> .d

(3)
S -> aA.

(4)
A -> d.

(5)
S -> b.Ac
S -> b.da
A -> .d

(6)
S -> bA.c

(7)
S -> bAc.

(8)
S -> bd.a
A -> d.

(9)
S -> bda.

(10)
S -> d.c

(11)
S -> dc. 
```

Next, we need to get the FOLLOW sets for all the nonterminals. This is shown here:

```
FOLLOW(S) = { $ }
FOLLOW(A) = { $, c } 
```

Given this, we can go back and upgrade the LR(0) configurating sets into SLR(1) configurating sets:

```
(1)
S -> .aA    [ $ ]
S -> .bAc   [ $ ]
S -> .dc    [ $ ]
S -> .bda   [ $ ]

(2)
S -> a.A    [ $ ]
A -> .d     [ $, c ]

(3)
S -> aA.    [ $ ]

(4)
A -> d.     [ $, c ]

(5)
S -> b.Ac   [ $ ]
S -> b.da   [ $ ]
A -> .d     [ $, c ]

(6)
S -> bA.c   [ $ ]

(7)
S -> bAc.   [ $ ]

(8)
S -> bd.a   [ $ ]
A -> d.     [ $, c ]

(9)
S -> bda.   [ $ ]

(10)
S -> d.c    [ $ ]

(11)
S -> dc.    [ $ ] 
```

Interestingly enough, there are no conflicts here! The only possible shift/reduce conflict is in state (8), but there is no conflict here because the shift action is on `a` and the reduce is on `$`. Consequently, this grammar actually *is* SLR(1). Since any SLR(1) grammar is also LR(1), this means that the grammar is both SLR(1) and LR(1).

Hope this helps!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-22T08:47:07.043

我考虑编写一个网络应用程序来确定 CFG 以及 LR(0)、SLR(1) 和 LR(1) 表的第一组和后一组。这将使您可以轻松地尝试一下。

但幸运的是我先google了一下，发现已经有这样的工具了（我没想到会是这样）。您可以在此处找到该工具：

[http://smlweb.cpsc.ucalgary.ca/](http://smlweb.cpsc.ucalgary.ca/)

它需要以下格式的输入：

```
S -> a A | b A c | d c | b d a.
A -> d. 
```

使用这个工具，我已经验证了其他人已经说过的：有问题的语法*是*SLR(1)。（我给这个问题-1）。

在 Toby Hutton 建议的修改之后，它不再是 SLR(1)，而是 LR(1)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-14T14:01:35.197

1）给定的语法在自顶向下解析中为LL(1)，在自底向上解析中为LALR(1)。

2）当您创建解析表时，并且解析表没有多个条目，那么语法往往会参加 LALR(1)。

3）如果您的解析表有多个条目（我的意思是发生冲突），则该语法被称为 SLR(1)。

4）一个语法被称为LR（1），因为它的解析表或ACTION / GOTO表没有冲突，我们都知道在LR（1）发生冲突期间我们合并数据并得到LALR。

LR(0) OR SLR OR SLR(1) 相同

LR(1) OR CLR 相同

LALR 或 LALR(1) 相同

(1) 参数定义语法分析器的内部构建效率类型。

谢谢你。

# asp.net - 在 Visual Studio 2010 设计视图中双击表单控件会插入脚本而不是插入事件处理程序

> ID：10505720
> 
> 赞同：1
> 
> 时间：2012-05-08T20:08:04.553
> 
> 标签：asp.net, vb.net, webforms

标题几乎准确地提出了这个问题，但我要重复一遍；

当我在 Visual Studio 2010 的 Web 应用程序项目的设计视图中双击表单控件时，例如说“按钮”或“提交”，它会在我的 .aspx 文件中插入一个 javascript 函数。当我在工作中执行此操作时，它会自动为代码隐藏中的控件创建一个事件处理程序。

如何将其更改为该设置？我已经使用了“/resetsettings”，类似问题的其他答案并不能解决我的问题。我已经重新安装，浏览了我能找到的每个菜单（尽管我可能错过了一些东西），我正在拔头发。

我不想每次都输入那些事件处理程序子例程！哈喽！

提前感谢您提供任何有用的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T21:48:58.790

看起来你正在双击一个常规的 HTML 元素。例如，如果您有

```
<input type="button" value="Test" id="Test" name="Test" /> 
```

并在设计视图中双击它，它将在页面上为其创建一个 JavaScript 函数，并在元素中创建一个 onclick 事件。如果要在后面的代码中创建事件处理程序，则需要有一个 Asp.Net 控件，例如

`<asp:Button runat="server" ID="Test" Text="Test" />`

然后双击它在后面的代码中创建一个代码事件。

此外，请确保顶部的页面指令具有正确的文件名，以便其`CodeFile`属性正确映射到现有的代码隐藏文件。

# entity-framework - 使用 Code First 的 EF 4.1 上的 Fluent 映射出错

> ID：10505721
> 
> 赞同：1
> 
> 时间：2012-05-08T20:08:13.730
> 
> 标签：entity-framework, ef-code-first, fluentvalidation, entity-framework-mapping

这里有一个简单的模型：

```
public class Product1
{
   public int Id { get; set; }
   public double Price { get; set; }
   public int CurrencyID  { get; set; }
   public Currency Currency  { get; set; }
}

public class Product2
{
   public int Id { get; set; }
   public double Price { get; set; }
   public int CurrencyID  { get; set; }
   public Currency Currency  { get; set; }
}

public class Currency
{
   public int Id { get; set; }
   public string Name { get; set; }
   public string ISO4217 { get; set; }
   public string Symbol { get; set; }
} 
```

如您所见，Currency 只是一个列表，将由两个不同的实体使用，但如果我尝试运行它，它会给我一个错误，说这是无效的，因为可能导致多个级联路径。

现在我想弄清楚如何在 OnModelCreating 上建模

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
   modelBuilder.Entity<Product1>().HasRequired(p => p.Currency).WithMany().WillCascadeOnDelete(false);
   modelBuilder.Entity<Product2>().HasRequired(p => p.Currency).WithMany().WillCascadeOnDelete(false);
} 
```

但是由于某种原因，尽管产品已正确创建，但每当我尝试加载它时，货币都会变为空。

我在这个建模中做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T13:17:17.950

我想通了，我将在这里解释以供将来参考：在更好地查看创建的基础后，我意识到它正在为错误的字段创建 FK：P1:ID -> Currency:ID，而正确的应该是 P1:CurrencyID -> 货币：ID

所以我找到了一种强制正确FK的方法：

```
modelBuilder.Entity<Product1>().HasRequired(p => p.Currency).WithMany().HasForeignKey(p => p.CurrencyId); 
```

就这样！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-03T21:49:46.853

像这样映射你的类：

```
public class Product1Mapping : EntityTypeConfiguration<Product1>
    {
     public Product1Mapping ()
      {
       ToTable("Product1");
       HasKey(p => p.Id);
       HasRequired(p => p.Tag).WithMany().HasForeignKey(t => t.CurrencyID);
      }
    }

  public class Product2Mapping : EntityTypeConfiguration<Product2>
    {
      public Product2Mapping ()
      {
       ToTable("Product2");
       HasKey(p => p.Id);
       HasRequired(p => p.Tag).WithMany().HasForeignKey(t => t.CurrencyID);
       //other properties
      }
    } 
```

并像这样更改您的 OnModelCreating 创建方法：

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            base.OnModelCreating(modelBuilder);
            modelBuilder.Configurations.Add(new AccountMapping());
            // Add other mapping classes
        }

       public DbSet<Product1> Product1{ get; set; }
       public DbSet<Product2> Product2{ get; set; } 
```

有关更多信息，请参阅这些链接：

[http://msdn.microsoft.com/en-us/data/jj591617.aspx](http://msdn.microsoft.com/en-us/data/jj591617.aspx)

[http://entityframework.codeplex.com/workitem/1049](http://entityframework.codeplex.com/workitem/1049)

# windows - Node.JS NPM 无法在 Windows 上运行

> ID：10505723
> 
> 赞同：2
> 
> 时间：2012-05-08T20:08:26.783
> 
> 标签：windows, node.js, npm

我刚刚安装了最新版本的 nodejs，虽然我可以让它很好地运行 js 文件，但我无法让 npm 做任何事情。

如果我打开 node.exe，它会出现一个提示，然后我分别尝试了以下每一项，但它们都不起作用：

```
> node npm install socket.io
> npm install socket.io
> help
> node help 
```

以上所有结果都只返回“...”行，然后我输入的每件事，我都会得到另一行“...”。

这非常令人沮丧。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-04T19:08:39.490

如果您在安装最新的 nodejs 时打开了命令提示符，那么在您关闭命令提示符并打开一个新的提示符之前，将无法识别 Windows 路径中 npm 的路径。

我知道这已经有一个可以接受的答案，但我只是发现了这个，然后意识到我自己的错误，并认为它可能会帮助其他人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T21:00:49.297

打开 node.exe 将打开 Read-eval-print 循环 (REPL)。试试：

```
c:\users\windowslogin>npm install socket.io 
```

# objective-c - 如何在不关闭 TabBarController 的情况下呈现ModalViewController

> ID：10505725
> 
> 赞同：0
> 
> 时间：2012-05-08T20:08:39.060
> 
> 标签：objective-c, ios, modalviewcontroller, tabbarcontroller

嘿伙计们，我正在尝试在带有标签栏控制器的应用程序中呈现模态视图控制器。问题是，每次呈现新视图时，它都会出现在我的标签栏顶部。

即使呈现视图，我也需要保留标签栏。就像谷歌地图应用程序在屏幕底部使用他的工具栏一样。

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:56:13.017

默认情况下，模态视图控制器会占据整个屏幕（至少在 iPhone/iPod 上）。因此，它涵盖了您当时在屏幕上的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-29T19:32:15.990

通过模态 segue 呈现的视图控制器意味着独立存在。如果你想保留你的 Navigation 和 TabBar，那么只需使用 push segue 来呈现新的 ViewController。记住要使用这种 segue，您的呈现控制器需要已经是 UINavigationController 的一部分。

使用它来推送 ViewController。如果它是 UINavigationController，它将自行推送其链接的 RootViewController。

创建一个 viewController 来推送：（使用 Storyboard）

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard_iPhone" bundle:nil];
UIViewController *vc = [storyboard instantiateViewControllerWithIdentifier:@"LoginViewController"]; 
```

或（使用代码/笔尖）

```
LoginViewController *viewController = [[LoginViewController alloc] init]; //initWithNibNamed in case you are using nibs.
//in case you want to start a new Navigation: UINavigationController = [[UINavigationController alloc] initWithRootViewController:viewController]; 
```

并推动：

```
[self.navigationController pushViewController:vc animated:true]; 
```

此外，如果您将 Storyboards 用于 segues，您可以使用它来完成所有工作。记得设置 segue 标识符。

```
[self performSegueWithIdentifier:@"pushLoginViewController" sender:self]; //Segue needs to exist and to be linked with the performing controller. Only use this if you need to trigger the segue with coder rather than an interface object.

- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"pushLiftDetail"]) {
        [[segue.destinationViewController someMethod:]];
        segue.destinationViewController.someProperty = x;
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-08T20:12:26.153

我认为您需要将 UITabBar 添加到模式视图并实现/复制主栏具有的按钮和功能。模态窗口的本质是它具有完全的控制权，直到它被解除。

您可以尝试将您的 UITabBarController 放入 NavBarController，但我不确定这是否可行。

UITabBarController -> NavBarController -> 模态视图

# javascript - 延迟脚本直到所有消息都通过？

> ID：10505726
> 
> 赞同：1
> 
> 时间：2012-05-08T20:08:40.407
> 
> 标签：javascript, google-chrome, message

像往常一样，我在 Google 上搜索了一下，并阅读了 Message Passing API，但是，我不得不再次求助于 StackOverflow 的好人。

我的问题是：在 Google Chrome 扩展程序的背景页面和内容脚本之间传递消息时，有没有办法让它异步 - 即延迟 JavaScript 直到检测到消息成功传递？

在消息传递函数使用传递的`localStorage`数据之后，我立即有一个函数。在第一次运行时，由于数据传递速度不够快，脚本总是会导致错误。

目前，我正在规避这个问题，`setTimeout(nextFunction, 250);`但这并不是一个优雅或实用的解决方案，因为传递的值的数量和大小总是会发生变化，我无法知道传递这些值需要多长时间。另外，我想，通过时间与浏览器版本和用户系统有关。

简而言之，我*需要*它是动态的。

我考虑过类似的东西

```
function passMessages(){
    chrome.extension.sendRequest({method: "methodName"}, function(response) {
        localStorage["lsName"] = response.data;
    });

    checkPassedMessages();
}

function checkPassedMessages(){
    if (!localStorage["lsName"]){
        setTimeout(checkPassedMessages, 100); //Recheck until data exists
    } else {
         continueOn();
    }
} 
```

但我需要传递相当多的数据（至少 20 个值），坦率地说，这对`!localStorage["lsName1"] && !localStorage["lsName2"]`等是不切实际的。另外，我什至不知道这是否可行。

有没有人有任何想法？

谢谢

**更新：**不幸的是，仍然没有答案。任何人都可以提供任何帮助吗？：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T09:34:05.673

我不知道我是否解释错了你的问题。据我了解，您正在从扩展页面向内容脚本发送请求。内容处理程序中的请求处理程序对传递的消息执行一些操作，之后您需要将控制权返回到扩展页面。如果这是您需要的，您可以在[Google 扩展文档](http://code.google.com/chrome/extensions/messaging.html)中找到所有内容。以下代码有效

```
//Passing the message
function passMessages(){
  chrome.extension.sendRequest({method: "methodName"}, function(response) {
    //callback function that will be called from the receiving end

    continueOn();
  });
}

//Recieving the message
chrome.extension.onRequest.addListener(
  function(request, sender, sendResponse) {
     //Do the required operation with the message passed and call sendResponse

     sendResponse();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:19:29.333

您可以通过收集传递的信息来解决此问题的一般情况（即，在任何平台上，在不同的执行线程之间进行通信），同时在开始处理收集的信息之前等待某种后续的“go”消息。您可以使用相同的想法让发件人等待完整的回复。

当然，您的特定平台可能会提供执行此操作的工具；但如果没有，您始终可以手动构建通用解决方案。

# c# - 如何将数据选择到列表中 而不是数据表？

> ID：10505733
> 
> 赞同：7
> 
> 时间：2012-05-08T20:08:53.680
> 
> 标签：c#, c#-4.0

这就是我目前从数据库中选择数据的方式：

```
public DataTable GetData()
{
    DataTable table = new DataTable("Table");
    using (SqlConnection connection = new SqlConnection("Connection string"))
    {
        SqlCommand command = new SqlCommand();
        command.Connection = connection;
        command.CommandType = System.Data.CommandType.Text;
        command.CommandText = "query string";

        connection.Open();
        SqlDataAdapter adapter = new SqlDataAdapter(command);
        adapter.Fill(table);
    }
    return table;
} 
```

但它返回 DataTable，我想选择 List 而不是 DataTable。像这样：

```
public List<MyClass> GetData()
{
    DataTable table = new DataTable("Table");
    using (SqlConnection connection = new SqlConnection("Connection string"))
    {
        SqlCommand command = new SqlCommand();
        command.Connection = connection;
        command.CommandType = System.Data.CommandType.Text;
        command.CommandText = "query string";

        connection.Open();
        SqlDataAdapter adapter = new SqlDataAdapter(command);
        adapter.Fill(table);
    }
    ...
    return [List of MyClass];
} 
```

我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T20:25:47.200

如果要使用`DataRowCollection`填充自定义对象列表，可以使用 LINQ 和对象初始化程序：

```
var lst = table.AsEnumerable().Select(r =>
    new MyObject
    {
        FirstProperty = r.Field<int>("FirstProperty"),
        OtherProperty = r.Field<string>("OtherProperty")
    }).ToList(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T20:14:23.707

如果您不想深入研究 LINQ to SQL 或实体框架，我建议您使用[dapper-dot-net 。](http://code.google.com/p/dapper-dot-net/)在大多数情况下，为了实现你的结果而摸索自己`IDataReader`是不值得的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-08T20:14:31.320

试试这个代码。

```
public List<MyClass> GetData()
{
    DataTable table = new DataTable("Table");
    using (SqlConnection connection = new SqlConnection("Connection string"))
    {
        SqlCommand command = new SqlCommand();
        command.Connection = connection;
        command.CommandType = System.Data.CommandType.Text;
        command.CommandText = "query string";
        connection.Open();
        SqlDataAdapter adapter = new SqlDataAdapter(command);
        adapter.Fill(table);
        List<MyClass> list=new List<MyClass>();
        foreach(DataRow row in table)
        {
            MyClass instance = new MyClass();
            instance.ID = row["ID"];
            //similarly for rest of the properties

            list.Add(instance);
        }

    }

    return list;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T20:13:11.557

如果您使用的是 ADO.NET 方法 - 您将获得一个数据表，您可以将其转换为 List 或 IEnumberable。

或者，您可以查看诸如 nHibernate 之类的 ORM 工具或使用 LINQ to SQL

# ruby - vagrant - Windows 7 权限被拒绝

> ID：10505734
> 
> 赞同：1
> 
> 时间：2012-05-08T20:08:56.223
> 
> 标签：ruby, virtualbox, vagrant

我正在尝试设置 Vagrant 框，但在 Windows 上遇到 Permission Denied 错误。我能够成功下载并创建一个盒子，但是当它尝试导入该盒子时会抛出错误。Vagrantfile 很好，因为我可以让盒子在 Mac OSX 和 Ubuntu 上正常启动和运行。我一直在使用 Vagrant 提供的安装包。我曾尝试以管理员身份运行命令提示符，但仍然没有运气。

# visual-studio-2010 - 数据库项目中的条件编译

> ID：10505737
> 
> 赞同：1
> 
> 时间：2012-05-08T20:09:02.520
> 
> 标签：visual-studio-2010, conditional-compilation

我有一个带有两个部署后脚本（InitData 和 TestData）的 vs 2010 数据库项目。我只想在 DEBUG 编译常量存在的情况下执行 TestData，所以 Script.PostDeployment.sql 脚本看起来像这样：

```
:r .\InitData.sql
#if DEBUG
:r .\TestData.sql
#endif 
```

但是这样做我得到一个编译错误`Incorrect syntax near '#if'`，有什么办法可以实现吗？

# wordpress - HTTP标头在非www URL上返回404？

> ID：10505740
> 
> 赞同：2
> 
> 时间：2012-05-08T20:09:12.003
> 
> 标签：wordpress, http, .htaccess, dns, http-status-code-404

我在我的服务器上的 mp3 文件上执行 PHP get_headers() 并在使用非 www 地址时接收 HTTP 404，在使用 www 时接收 HTTP 200。

我可以从浏览器中的任一地址访问该文件，那为什么是 404？我可以用.htaccess 以某种方式解决这个问题吗？

1）WordPress被配置为使用非www地址（example.com）

2) 文件位于 WordPress 安装的 wp-content/uploads 区域

3) www 子域有一个指向非 www 域的 DNS CNAME (www.example.com -> example.com)

* * *

标题： http: [//lhcsj.org/wp-content/uploads/2012/05/2012-5-6-sj.mp3](http://lhcsj.org/wp-content/uploads/2012/05/2012-5-6-sj.mp3)

```
HTTP/1.1 404 Not Found
Date: Tue, 08 May 2012 21:11:43 GMT
Server: Apache/2.2.3 (CentOS)
Content-Length: 314
Connection: close
Content-Type: text/html; charset=iso-8859-1 
```

标题：[http ://www.lhcsj.org/wp-content/uploads/2012/05/2012-5-6-sj.mp3](http://www.lhcsj.org/wp-content/uploads/2012/05/2012-5-6-sj.mp3)

```
HTTP/1.1 200 OK
Date: Tue, 08 May 2012 21:08:05 GMT
Server: Apache/2.2.3 (CentOS)
Last-Modified: Mon, 07 May 2012 17:19:47 GMT
ETag: "9c52430-e3626f-7a1332c0"
Accept-Ranges: bytes
Content-Length: 14901871
Connection: close
Content-Type: audio/mpeg 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T00:09:20.503

`www.example.com`和通过 DNS CNAME 条目指向同一个 IP 地址这一事实`example.com`并不意味着服务器被配置为同时为两者提供服务。该服务器可以配置为处理大量 HTTP 主机，默认值可能不是`www.example.com`其他的。事实上，它会为未配置的主机（甚至不是默认主机）返回 404 状态，这并不奇怪。

检查`VirtualHost`您的 Apache Httpd 配置中是否存在针对`www.example.com`和的条目`example.com`。为特定主机配置 Wordpress 的事实只有在通过该步骤后才会发挥作用。

# python - 如何在Python中遍历字符串的句子？

> ID：10505741
> 
> 赞同：6
> 
> 时间：2012-05-08T20:09:12.743
> 
> 标签：python, text-segmentation

假设我有一个字符串`text = "A compiler translates code from a source language"`。我想做两件事：

1.  我需要使用库遍历每个单词和词干`NLTK`。词干提取的功能是`PorterStemmer().stem_word(word)`。我们必须传递参数'word'。我怎样才能阻止每个单词并取回被阻止的句子？

2.  我需要从`text`字符串中删除某些停用词。包含停用词的列表存储在文本文件中（空格分隔）

    ```
    stopwordsfile = open('c:/stopwordlist.txt','r+')
    stopwordslist=stopwordsfile.read() 
    ```

    如何从中删除这些停用词`text`并获得干净的新字符串？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-08T20:22:50.097

我将此作为评论发布，但我认为我不妨将其充实为一个完整的答案并进行一些解释：

您想使用[`str.split()`](http://docs.python.org/library/stdtypes.html#str.split)将字符串拆分为单词，然后对每个单词进行词干：

```
for word in text.split(" "):
    PorterStemmer().stem_word(word) 
```

由于您想将所有词干组合在一起，因此将这些词干重新组合在一起是微不足道的。为了轻松有效地做到这一点，我们使用[`str.join()`](http://docs.python.org/library/stdtypes.html#str.join)和[生成器表达式](https://www.youtube.com/watch?v=t85uBptTDYY)：

```
" ".join(PorterStemmer().stem_word(word) for word in text.split(" ")) 
```

编辑：

对于您的其他问题：

```
with open("/path/to/file.txt") as f:
    words = set(f) 
```

在这里，我们使用语句打开文件[（`with`这](http://www.youtube.com/watch?v=lRaKmobSXF4)是打开文件的最佳方式，因为它可以正确处理关闭它们，即使在异常情况下，并且更具可读性）并将内容读入一个集合。我们使用一个集合，因为我们不关心单词的顺序，或者重复，以后会更有效率。我假设每行一个单词 - 如果不是这种情况，并且它们是逗号分隔或空格分隔的，那么`str.split()`像我们之前所做的那样使用（带有适当的参数）可能是一个好计划。

```
stems = (PorterStemmer().stem_word(word) for word in text.split(" "))
" ".join(stem for stem in stems if stem not in words) 
```

在这里，我们使用生成器表达式的 if 子句来忽略我们从文件加载的单词集中的单词。对集合的成员资格检查是 O(1)，所以这应该是相对有效的。

编辑2：

要在词干之前删除它们，它甚至更简单：

```
" ".join(PorterStemmer().stem_word(word) for word in text.split(" ") if word not in words) 
```

删除给定的单词很简单：

```
filtered_words = [word for word in unfiltered_words if not in set_of_words_to_filter] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T20:12:37.917

遍历字符串中的每个单词：

```
for word in text.split():
    PorterStemmer().stem_word(word) 
```

使用字符串的连接方法（由 Lattyware 推荐）将片段连接到一个大字符串。

```
" ".join(PorterStemmer().stem_word(word) for word in text.split(" ")) 
```

# sencha-touch - 为 Ext.Msg.alert 和 Ext.Msg.confirm 配置 Sencha Touch 图标？

> ID：10505748
> 
> 赞同：1
> 
> 时间：2012-05-08T20:09:32.397
> 
> 标签：sencha-touch

如何为这些 Sencha Touch 事件指定自定义图标：

*   `Ext.Msg.alert`
*   `Ext.Msg.confirm`

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:22:25.267

在 Ext.Msg (MessageBox) 上，您可以指定和`iconCls`配置项来控制使用的图标。

图标应该是 40x40 并且您显然想要引用`background: url();`指向您图标 url 的 css 类。

由于警报和确认是消息框的子集，因此配置项也应该在它们上可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T13:41:03.880

感谢@douga，我决定在 Ext.Msg.confirm 上使用 CSS 类和标签在我的 Sencha 代码中指定一个自定义图标。.customIcon {背景图像：url（）；背景位置：xy；}。

谢谢 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-25T05:16:14.007

我最近创建了这个新应用程序，它可以帮助您准备可以分配给的命名图标`iconCls`。它为您的 Sencha Touch 应用程序生成 SCCS 文件。自述文件解释了在 Ico Moon 网站上创建图标以及使用该工具将 Ico Moon 项目文件转换为 SCSS 以在 Sencha Touch 中使用的步骤。这也已经通过 Sencha Architect 项目进行了测试。

*   [https://github.com/tohagan/sencha-ico-moon](https://github.com/tohagan/sencha-ico-moon)

# jquery - 像这样的Jquery水平滚动条？

> ID：10505749
> 
> 赞同：-3
> 
> 时间：2012-05-08T20:09:34.380
> 
> 标签：jquery, scroller

我想知道是否可以像这样 [http://www.lazzarionline.com/collections.php用鼠标单击控件重新创建水平滚动效果](http://www.lazzarionline.com/collections.php)

非常感谢，我搜索了很多，但我没有找到类似 Luca 画廊的东西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:13:44.887

你必须做一些可拖动的东西，这对 jQuery 来说很容易，就像`$("#someComponent").draggable();`（你最好先用谷歌搜索）。但是您自己给出了答案，您找到了该水平滑块所在的站点，因此请查看源代码并复制粘贴。**Stackoverflow 不是为您编写代码的。**

# iphone - 从 TableView 中的 UIMenuController 中删除默认剪切、复制、粘贴

> ID：10505755
> 
> 赞同：6
> 
> 时间：2012-05-08T20:09:49.517
> 
> 标签：iphone, uimenucontroller

我正在尝试从 UIMenuController 中删除默认菜单项。我为 UIWebview 或 UITextView 找到了这篇文章：

[如何从 iOS 中的 UIMenuController 中删除默认的 UIMenuItem？](https://stackoverflow.com/questions/6074694/how-to-remove-the-default-uimenuitem-from-the-uimenucontroller-in-ios)

我正在尝试为新的 iOS 5 方法执行此操作，您可以在表格选择中显示菜单项。所以我的类是 UIViewController 的子类，其中有一个 UITableView。我不确定如何或是否可以删除默认项目。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-17T00:15:46.040

表视图委托方法`-tableView:canPerformAction:forRowAtIndexPath:withSender:`正是为此目的。

这是一个例子：

```
override func tableView(tableView: UITableView, canPerformAction action: Selector, forRowAtIndexPath indexPath: NSIndexPath, withSender sender: AnyObject?) -> Bool {
    switch action {
    case Selector("cut:"), Selector("copy:"), Selector("paste:"):
        return false // as per your question
    case Selector("myAction:"):
        return true
    default:
        return false
    }
} 
```

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2013-05-08T10:41:44.513

Use this code to remove the default features of `cut`, `copy`, `paste` and `select`:

```
(BOOL)canPerformAction:(SEL)action withSender:(id)sender
{
    UIMenuController * menuContoller=[UIMenuController sharedMenuController];    
    if (menuContoller) 
    {
        [UIMenuController sharedMenuController].menuVisible=NO;
    }
    return NO;
} 
```

# android - 即使应用程序关闭也使用警报管理器？

> ID：10505757
> 
> 赞同：7
> 
> 时间：2012-05-08T20:09:52.353
> 
> 标签：android, alarmmanager

我正在使用一个`Alarm Manager`来更新一个带有`Service`. 我有两个不同的问题。

第一个问题：我以警报管理器的意图调用该服务。像这样：

```
alarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
Intent i = new Intent(context, MyService.class);
pi = PendingIntent.getService(context, 0, i, PendingIntent.FLAG_UPDATE_CURRENT);

context.startService(new Intent(context, MyService.class));

Long repeat = Long.parseLong(prefs.getString("update_preference", "600"));
alarmManager.setInexactRepeating(AlarmManager.RTC_WAKEUP, Calendar.getInstance().getTimeInMillis(), 1000*repeat, pi); 
```

这是错的吗？

它看起来和工作正常。但是当我查看*工作服务时，*我在列表中看不到我的服务名称。也许它没有作为*单一/单独*的服务运行。刚刚看到应用程序名称（不是作为服务）。我不确定如何分开或有关系吗？

另一个问题：随着时间的推移，控制小部件更新的正在运行的应用程序会以某种方式**关闭**（手动或由任务杀手）。当然`Alarm Manager`会停止，小部件的功能也会停止。例如按钮点击。

但是，Twitter 解决了这个问题。当小部件处于活动状态时，如果我关闭控制小部件的主应用程序（Twitter）而不是单击小部件，以某种方式触发小部件的应用程序，它会重新启动。所以按钮工作正常。这怎么可能？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:26:44.933

您不需要`context.startservice`按照待处理的意图执行此操作，如果您希望服务第一次立即运行，只需将其设置为在当前时间运行，然后设置从当前时间开始的时间间隔。

当您不需要时，您还设置了 2 种不同类型的重复`setRepeating`是严格的哪里`setInexact`不是，并且可以在操作系统被触发时进行调整，因此不精确。你想要一个或另一个，而不是两者。

而且这些间隔非常小，它会显着杀死电池。

应该就是这个

```
alarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
Intent i = new Intent(context, MyService.class);
pi = PendingIntent.getService(context, 0, i, PendingIntent.FLAG_UPDATE_CURRENT);

Long repeat = Long.parseLong(prefs.getString("update_preference", "600"));
alarmManager.setInexactRepeating(AlarmManager.RTC_WAKEUP,
                      Calendar.getInstance().getTimeInMillis(), 1000*repeat, pi); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:23:19.770

您的应用程序/服务并非一直在运行，这很好。事实上，它不需要/必须一直运行来更新小部件。如果您使用 AlarmManager 安排 Intent，如果 Intent 已关闭，则应用程序将在该 Intent 被触发时启动。

# php - 根据对象属性从数组中删除重复项？

> ID：10505760
> 
> 赞同：10
> 
> 时间：2012-05-08T20:10:02.340
> 
> 标签：php, object, multidimensional-array, duplicate-removal

我有一个对象数组。我想根据对象中的“名称”值删除重复项。

```
 [0]=>
  object(stdClass)#337 (9) {
    ["term_id"]=>
    string(2) "23"
    ["name"]=>
    string(12) "Assasination"
    ["slug"]=>
    string(12) "assasination"
  }
  [1]=>
  object(stdClass)#44 (9) {
    ["term_id"]=>
    string(2) "14"
    ["name"]=>
    string(16) "Campaign Finance"
    ["slug"]=>
    string(16) "campaign-finance"
  }
  [2]=>
  object(stdClass)#298 (9) {
    ["term_id"]=>
    string(2) "15"
    ["name"]=>
    string(16) "Campaign Finance"
    ["slug"]=>
    string(49) "campaign-finance-good-government-political-reform"
  } 
```

所以在这种情况下，如何从数组中删除重复的“Campaign Finance”对象。那么整个 [2] 对象呢？

我在这里处理了一堆 PHP 重复数组问题，但似乎没有一个处理对象并仅根据一个参数进行过滤。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-08T20:23:48.443

对于`php >=7.0`：

由于`array_column`自 PHP 7.0 起适用于对象数组，您可以按照@plashenkov 的建议使用以下组合：

```
$filtered = array_intersect_key($array, array_unique(array_column($array, 'someProperty'))); 
```

完整示例：[https ://3v4l.org/IboLu#v8.0.8](https://3v4l.org/IboLu#v8.0.8)

```
class my_obj
{
        public $term_id;
        public $name;
        public $slug;

        public function __construct($i, $n, $s)
        {
                $this->term_id = $i;
                $this->name = $n;
                $this->slug = $s;
        }
}

$objA = new my_obj(23, 'Assasination', 'assasination');
$objB = new my_obj(14, 'Campaign Finance', 'campaign-finance');
$objC = new my_obj(15, 'Campaign Finance', 'campaign-finance-good-government-political-reform');

$array = array($objA, $objB, $objC);
echo 'Original array:\n';
print_r($array);

/** Answer Code begins here */
$filtered = array_intersect_key($array, array_unique(array_column($array, 'name')));
/** Answer Code ends here */

echo 'After removing duplicates\n';
print_r($filtered); 
```

输出：

```
Original array:
Array
(
    [0] => my_obj Object
        (
            [term_id] => 23
            [name] => Assasination
            [slug] => assasination
        )

    [1] => my_obj Object
        (
            [term_id] => 14
            [name] => Campaign Finance
            [slug] => campaign-finance
        )

    [2] => my_obj Object
        (
            [term_id] => 15
            [name] => Campaign Finance
            [slug] => campaign-finance-good-government-political-reform
        )

)
After removing duplicates
Array
(
    [0] => my_obj Object
        (
            [term_id] => 23
            [name] => Assasination
            [slug] => assasination
        )

    [1] => my_obj Object
        (
            [term_id] => 14
            [name] => Campaign Finance
            [slug] => campaign-finance
        )

) 
```

term_id 为 15 的对象已被删除，因为它与 term_id 14 同名。

对于`php <7.0`：

使用现有键和名称作为值构建一个新数组，使用`array_unique`（注意它保留键）。

然后将原始数组中的每个键复制到一个新数组 ( `$filtered`) 中（或从原始键中删除所有不在唯一数组中的内容）。

编辑：完整示例：[https ://3v4l.org/SCrko#v5.6.40](https://3v4l.org/SCrko#v5.6.40)

```
class my_obj
{
        public $term_id;
        public $name;
        public $slug;

        public function __construct($i, $n, $s)
        {
                $this->term_id = $i;
                $this->name = $n;
                $this->slug = $s;
        }
}

$objA = new my_obj(23, 'Assasination', 'assasination');
$objB = new my_obj(14, 'Campaign Finance', 'campaign-finance');
$objC = new my_obj(15, 'Campaign Finance', 'campaign-finance-good-government-political-reform');

$array = array($objA, $objB, $objC);

echo 'Original array:\n';
print_r($array);

/** Answer Code begins here **/

// Build temporary array for array_unique
$tmp = array();
foreach($array as $k => $v)
    $tmp[$k] = $v->name;

// Find duplicates in temporary array
$tmp = array_unique($tmp);

// Build new array with only non-duplicate items
$filtered = [];
foreach($array as $k => $v)
{
    if (array_key_exists($k, $tmp))
        $filtered[$k] = $v;
}

/** Answer Code ends here **/

echo 'After removing duplicates\n';
print_r($filtered); 
```

输出：

```
Original array:
Array
(
    [0] => my_obj Object
        (
            [term_id] => 23
            [name] => Assasination
            [slug] => assasination
        )

    [1] => my_obj Object
        (
            [term_id] => 14
            [name] => Campaign Finance
            [slug] => campaign-finance
        )

    [2] => my_obj Object
        (
            [term_id] => 15
            [name] => Campaign Finance
            [slug] => campaign-finance-good-government-political-reform
        )

)
After removing duplicates
Array
(
    [0] => my_obj Object
        (
            [term_id] => 23
            [name] => Assasination
            [slug] => assasination
        )

    [1] => my_obj Object
        (
            [term_id] => 14
            [name] => Campaign Finance
            [slug] => campaign-finance
        )

) 
```

term_id 为 15 的对象已被删除，因为它与 term_id 14 同名。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2020-04-10T12:17:26.787

单线：

```
$filtered = array_intersect_key($array, array_unique(array_column($array, 'someProperty'))); 
```

请注意，array_column() 适用于 PHP 7 和更新版本中的对象数组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-21T23:03:54.927

我一直在寻找一个好的答案，但找不到一个，所以我自己写了一个来处理这种情况，以及你想基于多个属性进行重复数据删除的情况。

```
$array = DeDupeArrayOfObjectsByProps($array, ['name']); 
```

这是通用函数：

```
/**
 * Iterates over the array of objects and looks for matching property values.
 * If a match is found the later object is removed from the array, which is returned
 * @param array $objects    The objects to iterate over
 * @param array $props      Array of the properties to dedupe on.
 *   If more than one property is specified then all properties must match for it to be deduped.
 * @return array
 */
public function DeDupeArrayOfObjectsByProps($objects, $props) {
    if (empty($objects) || empty($props))
        return $objects;
    $results = array();
    foreach ($objects as $object) {
        $matched = false;
        foreach ($results as $result) {
            $matchs = 0;
            foreach ($props as $prop) {
                if ($object->$prop == $result->$prop)
                    $matchs++;
            }
            if ($matchs == count($props)) {
                $matched = true;
                break;
            }

        }
        if (!$matched)
            $results[] = $object;
    }
    return $results;
} 
```

这是您的案例的完整用法：

```
class my_obj {
    public $term_id;
    public $name;
    public $slug;

    public function __construct($i, $n, $s) {
        $this->term_id = $i;
        $this->name = $n;
        $this->slug = $s;
    }
}

$objA = new my_obj(23, "Assasination", "assasination");
$objB = new my_obj(14, "Campaign Finance", "campaign-finance");
$objC = new my_obj(15, "Campaign Finance", "campaign-finance-good-government-political-reform");
$array = array($objA, $objB, $objC);

$array = DeDupeArrayOfObjectsByProps($array, ['name']);
var_dump($array); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-31T22:06:17.810

我需要同样的东西......这就是我所做的（基于[这篇文章](https://stackoverflow.com/a/6057401/782013)，适用于数组和对象）

```
function my_array_unique_by_subkey($array,$subkey){

    $temp = array();

    $unique = array_filter($array, function ($v) use (&$temp,$subkey) {

        if ( is_object($v) ) $v = (array)$v;

        if ( !array_key_exists($subkey,$v) ) return false;

        if ( in_array($v[$subkey], $temp) ) {
            return false;
        } else {
            array_push($temp, $v[$subkey]);
            return true;
        }
    });

    return $unique;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-22T15:07:44.727

稍微偏离主题，但密切相关：仅按实例对对象数组进行重复数据删除的最短方法：

```
/**
 * The array must NOT contain scalars.
 *
 * @param mixed[] $objects
 * @return mixed[]
 */
public static function arrayUniqueForObjects(array $objects): array
{
    $deDuplicatedArray = [];

    foreach ($objects as $object) {
        $deDuplicatedArray[spl_object_hash($object)] = $object;
    }

    return array_values($deDuplicatedArray);
} 
```

# java - 哪个 rpc/messaging 框架最适合这种情况？

> ID：10505764
> 
> 赞同：5
> 
> 时间：2012-05-08T20:10:25.740
> 
> 标签：java, c++, asynchronous, messaging, rpc

用例：一个 Java 进程和一个或两个 C++ 进程，总是在同一台机器上。需要双向、二进制、非持久通信。其中一个 C++ 进程负责实例化其他进程。

我环顾四周，看到了 XML/JSON-RPC、Protocol Buffers、Thrift、zeromq 等。

如果可能的话，可移植性会很好，但需要 Windows XP/7。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-25T20:29:40.090

通常，您应该在设计中将消息传输和消息反序列化分开，并尽可能保持它们正交。简而言之，将数据（消息）流行为与消息内容分离。

1.  有几种面向消息的传输框架，允许为线程、进程之间的客户端/服务器通信（请求/回复、发布/订阅、推/拉等）的某些行为模式发送和接收中性有效负载数据（消息）和网络服务作为客户端和服务器实例。
2.  有许多框架以传输中性（例如，提供用于交换独立于机器字节序的本机整数数据的有线格式）方式提供有效载荷（消息）数据的反序列化/序列化。
3.  对于您的特定用例，最佳组合选择是什么，取决于您对设计决策的许多要求和约束：

    *   作为线程、进程或服务器/进程的客户端/服务器处理单元的可扩展性
    *   整体性能和消息延迟
    *   处理单元资源需求（例如堆内存或代码大小）
    *   网络资源影响（通过网络接口发送的内容）
    *   ETC。 ...

**可能的解决方案：**
我认为ZMQ 消息传递框架与[Google Protobuf消息](http://code.google.com/p/protobuf/)[框架](http://zguide.zeromq.org/page%3aall)相结合可以为您的用例提供可行的解决方案。有针对[c++](/questions/tagged/c%2b%2b "显示标记为“c++”的问题")和[java](/questions/tagged/java "显示标记为“java”的问题")的语言绑定（请参阅[ZMQ Java 绑定](http://www.zeromq.org/bindings%3ajava)），您将拥有针对进程间和线程间通信的优化实现。ZMQ 连接以类似套接字的方式设计，支持双向（请求/回复）通信模式以及单向（发布/订阅、推/拉）通信模式。

如前所述，消息内容的格式取决于您，但[Google Protobuf](http://code.google.com/p/protobuf/)可能适用于内部定义的消息协议，这些协议支持 C++ 和 Java 语言绑定。[Google Protobuf](http://code.google.com/p/protobuf/)还提供了一种机制来定义[RPC 服务接口](https://developers.google.com/protocol-buffers/docs/proto#services)，但您必须为客户端/服务器实现提供具体的消息传输协议。我从未通过 ZMQ 传输实现这一点，但如果有必要，它应该是可能的。

XML/JSON-RPC 可能被考虑用于发布（例如通过 REST 服务）协议（使用 ZMQ 桥接相当容易）。

考虑到您的要求，我猜后面的协议格式选项不是必需的，但可能很有用，具体取决于您打算与 Java/C++ 参与者一起使用的框架。

AFAIK ZMQ 符合您对 Windows XP/7 平台的可移植性限制。不确定，但 Windows 系统上的线程间通信可能存在限制。但这似乎不适用于您描述的场景。

**替代传输框架：**

1.  [活动MQ](http://activemq.apache.org/)
2.  [Boost asio](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/overview.html)（C++ 包装的本机套接字，我不了解 java 端，请随意增强此信息）

**备用消息编码/解码框架：**

1.  XML-RPC [C++](http://xmlrpc-c.sourceforge.net/) / [java](http://ws.apache.org/xmlrpc/)（通常假设 HTTP 传输）
2.  [JSON](http://www.json.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:45:03.977

根据问题评论中的信息，我想协议缓冲区是需要考虑的东西——它在线上具有二进制格式，具有简单的 API，并且不提供任何冗余的东西，例如持久性。

# php - 我的代码中出现意外的 $END。使困惑

> ID：10505766
> 
> 赞同：-1
> 
> 时间：2012-05-08T20:10:30.933
> 
> 标签：php

我一直在搜索不同的站点以查看我做错了什么，但我不断收到 Parse 错误意外 $END。你能看看我的代码并告诉我我做错了什么吗？

```
 <!DOCTYPE html>
        <html>

    <head><meta name=Campus DrinkThink API Page/>
        <title> Campus DrinkThink API Page </title> 
    </head>
    <body>
    <?php

                // has the user taken the quiz before?
                if (isset($_COOKIE['visit_id'])) {                                                                  

        // if so, look up their answers in the JSON file
        $visit_id = $_COOKIE['visit_id'];                                                                
        $all_my_variables = json_decode(file_get_contents("/var/www/html/data/$visit_id.json"), TRUE);  
        $location= $all_my_variables -> location;

        echo "<h1>Your Night Out in Depth!</h1>";

        // make an API call to find what kind of place they typed in
        $google_maps_array = json_decode(
            file_get_contents( 'http://maps.googleapis.com/maps/api/geocode/json?address='.
                urlencode(
                    htmlspecialchars_decode(
                        $all_my_variables['location']
                    )
                ) . "&sensor=false"
            ), TRUE
        );
        $google_map_image= json_decode(file_get_contents("http://maps.googleapis.com/maps/api/staticmap?center=".
           urlencode($location)."&zoom=20&size=400x400"),
           TRUE
           );

            // remind them of their quiz answers
        echo "<p>When you used Campus DrinkThink";
        echo "You said that you were located at,: <b>";
        echo $all_my_variables['location'];                                                                 
        echo "</b>.</p>";     

        // handle the situation where there is no result
        if ($google_maps_array['status'] == 'ZERO_RESULTS')
            {                                           
            echo "<p>Google Maps can't find you at this time! Sorry!</p>";  
        // otherwise, if there is a result
    } else {            
            // output the place type by looking in the first [0] 
            // type element in the first [0] result element
            echo "<p>Google Maps says that this is a location type called: <strong>";
            echo $google_maps_array["results"][0]["types"][0];                                        
        echo "</strong></p>";

    }

    }else {  // no cookie is set                                                                      

            // you didn't use the app

        echo "<p>You have not yet used Campus DrinkThink</p>";
        print "<a href='http://haleysoehn.com/campusdrinkthink-form.html'> Click Here For the Quiz </a>";
        echo "Then return here to see your explained results";
    ?>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:14:50.817

这条线

```
 }else {  // no cookie is set 
```

缺少它的右括号`}`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:14:58.680

您没有关闭在旁边打开的最后一个括号`// no cookie is set`

您应该使用带有语法突出显示的编辑器来提供帮助。Eclipse 不错，Notepad++ 也不错

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T20:16:35.260

您需要在第 12 行关闭此 if 语句：

```
if (isset($_COOKIE['visit_id'])) { 
```

您应该在 php 结束标记之前关闭它。

# unit-testing - UNIT 测试 dto 和域对象

> ID：10505768
> 
> 赞同：3
> 
> 时间：2012-05-08T20:10:39.437
> 
> 标签：unit-testing, mocking, domain-driven-design, dto

我打算写一个抽象类的东西来测试我所有的 DTO 和 DOMAIN 对象。这个类将接受模板对象（通用类型）并使用反射来获取其中的属性类型，并将一些默认值分配给识别的原始类型，稍后将通过访问它们来断言这些类型值。这样，每当我的 DTO 测试继承这个类时，大部分代码都使用在测试中编写的一行代码进行测试。这只是一个想法，如果我正在重新发明轮子，如果这样的东西已经存在，想从你们那里知道吗？如果有更好的方法可以用更少且可重复的代码来测试 DTO 和域对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T22:37:10.850

我不认为这是测试域对象的好方法。根据定义，这些对象封装了数据和相关行为，它们应该不仅仅是带有 getter 和 setter 的哑数据容器。您将不得不为这些对象手写单元测试，就像您自己手写对象一样。根据 DDD，这是您实际假设要花费时间的地方。

关于 DTO，您可能想看看这个[问题](https://stackoverflow.com/q/1539989/625332)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T13:21:02.967

我的建议 ：

*   不要对 DTO 进行单元测试。这些只是简单的数据结构，有一堆 getter 和 setter，没有任何行为。getter 和 setter 太笨了，无法测试（除非它们封装了某种条件逻辑，而这在 DTO 中很少出现）。

*   不要试图自动化或泛化您的域对象测试。我看不出测试它们行为的代码是如何被重用的，因为它们都有不同的行为定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-23T10:04:44.387

尽管我认为对 DTO 进行单元测试毫无价值，但根据@Dmitry 的回答，我想出了这个类：

```
[TestClass]
public class PeopleTest
{
    [TestMethod]
    public void OneObjectNull()
    {
        Person obj1 = null;
        var obj2 = new Person
        {
            Id = "101",
            Name = "George Waits",
            Address = "Lake Palmer 10"
        };

        Assert.AreNotEqual(obj1, obj2);
        Assert.AreNotEqual(obj2, obj1);
    }

    [TestMethod]
    public void DeepEqual()
    {
        var obj1 = new Person
        {
            Id = "101",
            Name = "George Waits",
            Address = "Lake Palmer 10"
        };

        var peolpleList1 = new List<Person> { obj1 };
        var peolpleList2 = new List<Person> { obj1 };

        Assert.AreEqual(obj1, obj1);
        CollectionAssert.AreEqual(peolpleList1, peolpleList2);
    }

    [TestMethod]
    public void DeepNotEqual()
    {
        var obj1 = new Person
        {
            Id = "101",
            Name = "George Waits",
            Address = "Lake Palmer 10"
        };

        var obj2 = new Person
        {
            Id = "102",
            Name = "Rachel Smith",
            Address = "Lake Palmer 10"
        };

        var peolpleList1 = new List<Person> { obj1 };
        var peolpleList2 = new List<Person> { obj2 };

        Assert.AreNotEqual(peolpleList1, peolpleList2);

        var group1 = new KeyValuePair<string, List<Person>>("group1", peolpleList1);
        var group2 = new KeyValuePair<string, List<Person>>("group2", peolpleList2);

        Assert.AreNotEqual(group1, group2);
    }

    [TestMethod]
    public void PropertyPositive()
    {
       var obj1 = new Person
        {
            Id = "101",
            Name = "George Waits",
            Address = "Lake Palmer 10"
        };
        obj1.Address = "Parker av 101";

        var obj2 = new Person
        {
            Id = "102",
            Name = "Rachel Smith",
            Address = "Lake Palmer 10"
        };
        obj1.Address = "Listener av 45";

        Assert.AreNotEqual(obj1, obj2);
    }
} 
```

# jsf - 如何使用自定义异常处理程序处理 javax.el.PropertyNotFoundException

> ID：10505769
> 
> 赞同：4
> 
> 时间：2012-05-08T20:10:50.023
> 
> 标签：jsf, exception, jsf-2, exception-handling, omnifaces

我尝试了omniFaces 的AjaxExceptionHandler（这很有帮助）并将其配置为捕获`java.lang.Throwable`来自各种请求（不仅是ajax 请求）的异常。

`javax.el.PropertyNotFoundException`它工作得很好，但是当开发人员拼错 EL 表达式时它不会被捕获。

那么问题来了： JSF2`javax.el.PropertyNotFoundException`的机制如何处理？`ExceptionHandlerFactory`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:44:58.000

[`FullAjaxExceptionHandler`](http://showcase.omnifaces.org/exceptionhandlers/FullAjaxExceptionHandler)应该可以应付。您的具体问题可能是因为您有一个相对较大的页面溢出了 Facelets 的默认缓冲区大小 2KB，因此在引发异常时响应已经提交。提交响应时，响应的一部分已经发送到客户端。**无法**取回已发送的字节并使用错误页面呈现新的响应。不使用 ajax 时，您会遇到完全相同的问题。相反，该异常将被记录下来，并且客户端将卡在一个半生不熟的页面上。

您可能希望将默认响应缓冲区大小增加到最大 HTML 响应的大小。这样，响应将在第一个字节发送到客户端之前生成并完全缓冲在服务器的内存中。您可以通过`javax.faces.FACELETS_BUFFER_SIZE`上下文参数设置它，`web.xml`以字节为单位的缓冲区大小作为值。以下示例将其设置为 64KB。

```
<context-param>
    <param-name>javax.faces.FACELETS_BUFFER_SIZE</param-name>
    <param-value>65535</param-value>    
</context-param> 
```

您可能只想在开发/测试环境中设置它，以便可以发现视图端的任何错误，并且实时环境可以继续使用默认缓冲区大小来节省服务器内存。

# java - 使用 JSTL 访问模型对象

> ID：10505771
> 
> 赞同：0
> 
> 时间：2012-05-08T20:10:51.353
> 
> 标签：java, ajax, spring, jstl

我目前正在尝试掌握 AJAX，并且在访问模型对象时遇到问题。

我的测试代码所做的是从下拉列表中获取选定项的值，当按下按钮时，它将这个值传递给`AjaxTest()`，它将参数附加到模型，但我似乎无法输出模型对象 -我想知道为什么会这样？

绝对是有价值的`param`。

```
<div id="result"></div>

<script type="text/javascript">

    var param = document.getElementById("blah").value;

    var loadUrl = "/ajax/" + param;  
    $("#button").click(function(){  

        $.post(loadUrl, function(data){
            alert("Data Loaded: " + data);
            $("#result").html("<p>Param: ${output}</p>"); 
        });
    });  
</script>

@RequestMapping(value = "/ajax/{param}", method = RequestMethod.POST)
public @ResponseBody String AjaxTest(@PathVariable String param, final ModelMap model){

    model.addAttribute("output", param);
    return param;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:42:04.127

我认为您对客户端和服务器端有点混淆。您的 java 看起来是正确的，但您的 js 正在尝试访问 jstl 表达式（ ${output} ）。当页面呈现时，jstl 表达式不会解析，这将在 Ajax 请求/响应发生之前。

您的 js 需要使用变量“数据”，这是您的 java 添加到模型的数据。像这样的东西：

```
$("#result).html("<p>Param: " + data.output + "</p>"); 
```

这假设模型是 json 希望这有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:42:36.837

首次加载页面时，将执行 JSP 代码。此代码包含以下几行：

```
$("#button").click(function(){  

    $.post(loadUrl, function(data){
        alert("Data Loaded: " + data);
        $("#result").html("<p>Param: ${output}</p>"); 
    });
}); 
```

因此，JSP EL 代码由容器解释，并且 ${output} 被替换为输出属性的值。由于此属性为 null，因此生成以下 HTML 代码并将其发送到浏览器：

```
$("#button").click(function(){  

    $.post(loadUrl, function(data){
        alert("Data Loaded: " + data);
        $("#result").html("<p>Param: </p>"); 
    });
}); 
```

当您单击该按钮时，将执行上述 JavaScript 代码。它向 ajax URL 发送一个 AJAX 请求，当响应返回时，它执行回调函数：

```
alert("Data Loaded: " + data);
$("#result").html("<p>Param: </p>"); 
```

因此，从服务器接收到的数据会显示在一个警告框中，然后由“result”标识的 HTML 元素的内容被替换为`<p>Param: </p>`.

# jquery - 使用 jQuery 检查任何出现的特殊字符

> ID：10505772
> 
> 赞同：0
> 
> 时间：2012-05-08T20:10:57.363
> 
> 标签：jquery, regex, jquery-validate

如果我有一组特殊字符，例如：`!@#$%^&*(){}[]<>?/|-`我如何检查字符串（或字段值）中是否存在这些字符？尝试添加一个方法 jQuery 验证器插件，如果其中任何一个存在，它将拒绝该字段。我意识到这要求很多，正则表达式正在杀死我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T20:15:04.570

试试这个：

```
/[!@#$%\^&*(){}[\]<>?/|\-]/ 
```

你只需要逃避`]`. 在字符类 ( `[]`) 中，其他字符按字面解释。

更多信息：[http](http://www.regular-expressions.info/charclass.html) ://www.regular-expressions.info/charclass.html （在“字符类中的元字符”下）

# java-me - 用于 J2ME 平台的 JVM 语言

> ID：10505776
> 
> 赞同：1
> 
> 时间：2012-05-08T20:11:14.693
> 
> 标签：java-me, jvm-languages, xtend, mirah

我目前正在为 J2ME 环境（CLDC 1.1 配置和 IMP-NG 配置文件）编写一个嵌入式应用程序。被基于 JVM 的语言（Groovy、Scala、Clojure 等等）的所有这些新特性宠坏了，我正在考虑将其中一种用于我的代码。

但是，大多数提到的语言都需要相当不错的 JVM 环境。大多数所谓的“动态”语言都要求 VM 具有反射功能。许多人要求注释支持。以上功能在 J2ME 下均不可用。

根据我的发现，[Xtend](http://www.eclipse.org/xtend/ "Xtend 主页")看起来是一个可行的选择，因为它的编译器会输出纯 Java，而不是字节码，并且不需要任何库来满足运行时的需要。当然，生成的 Java 代码也必须满足一些要求，但 Xtend 网页在这方面看起来很有希望：

> Xtend 只是上课，没有别的
> 
> Java 中的接口定义已经非常简洁明了。它们具有不错的默认可见性，并且在其他领域也几乎没有什么可以改进的。鉴于能够处理这些文件的所有知识和强大的工具，没有理由以不同的方式定义它们。这同样适用于枚举和注释类型。
> 
> 这就是 Xtend 只能做类并依赖于 Java 中定义的接口、注释和枚举的原因。Xtend 并不是要取代 Java，而是要使其现代化。

我是对的吗，可以为 J2ME 平台编译 Xtend 生成的代码，还是有些结构在那里不起作用？

或者，您能否推荐任何其他可以在 J2ME 上运行的“丰富”Java 修改语言？

**更新：**知道作为另一个源代码产生结果的“编译器”称为*transcompiler*，还可以找到[Mirah](http://www.mirah.org) ，这是一种不需要运行时库和特定 Java 功能的工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T21:28:14.783

Xtend 生成的代码大量使用了 google guava。如果这与 J2ME 兼容，那么 Xtend 可能是您选择的语言。我不知道有什么会阻止在提供专用开发工具包（例如 Android）的其他平台上使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T03:45:24.290

除了能够生成 Java 源代码之外，Mirah 最近还添加了对 javac 的 --bootclasspath 选项的支持，它允许您针对非标准版本的 Java 核心类（例如 LeJOS）生成字节码。

它仍然有点新鲜，但是让更多人在不同的 java 上使用它会很好。

# permissions - 在 Win Server 2008 中设置证书的私钥权限

> ID：10505779
> 
> 赞同：3
> 
> 时间：2012-05-08T20:11:30.463
> 
> 标签：permissions, certificate, windows-server-2008, makecert

在 Windows Server 2003 上使用 makecert 创建证书时，我必须将私钥的权限设置为可供 NETWORK SERVICE 访问，以便 WCF 服务可以读取私钥。我可以通过导航到 C:\Documents and Settings\All Users\Application Data\Microsoft\Crypto\RSA\MachineKeys 来访问该文件。一旦我为 NETWORK SERVICE 设置了读取权限，一切正常。

我正在查看 Windows Server 2008，但在 C:\Users 或其他任何地方都找不到类似的位置。设置私钥权限的正确机制是什么？它们位于哪里？我正在使用 makecert 直接将其安装到 TrustedPeople / localmachine

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T13:06:43.237

看起来这里使用的工具是[WinHttpCertCfg.exe](http://www.microsoft.com/en-us/download/details.aspx?id=19801)。与我上面描述的方法相比，这是在证书私钥上设置权限的更简洁的方法。我的猜测是，在 Windows 2008 及更高版本中，MS 决定将键隐藏在更离散的位置。

我使用 WinHttpCertCfg 来设置权限。下面是一个示例命令，用于授予 NETWORK SERVICE 对 LOCAL_MACHINE\TrustedPeople 中名为 MyCert01 的证书的读取权限。

```
winhttpcertcfg.exe -g -c LOCAL_MACHINE\TrustedPeople -s MyCert01 -a "NETWORK SERVICE" 
```

# c - 如何将字符串存储在C中的多维数组中？

> ID：10505780
> 
> 赞同：0
> 
> 时间：2012-05-08T20:11:33.367
> 
> 标签：c

我觉得问得很傻，但我很难找到答案。如何将“Rose”重新分配给“Douglas”？看来我必须使用循环。

```
#include <stdio.h>

int main() {

  char arr[3][12]= { "Rose", "India", "technologies" };
  printf("Array of String is = %s,%s,%s\n", arr[0], arr[1], arr[2]);
  arr[0][0] = {"Douglas"};
  printf("Array of String is = %s,%s,%s\n", arr[0], arr[1], arr[2]);

    return(0);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T20:12:48.243

你可以这样做`strcpy()`：

```
strcpy(arr[0], "Douglas"); 
```

使用 时`strcpy()`，您必须确保目标中有足够的空间来保存您要放在那里的字符串（加上终止 NUL 字符）。在这种情况下，因为您为每个字符串分配了 12 个字节并且`"Douglas"`将占用 8 个字节。

# c# - 使用实体检索 SQL 视图

> ID：10505788
> 
> 赞同：1
> 
> 时间：2012-05-08T20:12:07.587
> 
> 标签：c#, asp.net-mvc, entity-framework

我的数据库中有一个名为“viewUsers”的视图，我需要使用其他实体生成的表对其进行操作。如何在实体中检索此数据库视图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:23:47.753

在向导中，您可以选择视图。EF 会照顾好休息。详细示例 [在这里](http://In%20the%20Wizard,%20you%20can%20select%20Views.%20EF%20will%20take%20care%20of%20rest.)

![在此处输入图像描述](../Images/5bb01ee4f6dc6a01e9a460b9a37d5cd6.png)

**编辑：**根据评论（如何在codefirst中进行），

从 Entity Framework 4.2 开始，Codefirst 仅支持表。这意味着它只能生成包含表的模式。但是，如果您正在使用现有数据库，则可以将可更新视图与实体映射。您可以使用实体框架来选择、插入、更新和删除数据。这与表格相同。由于这些操作的表和视图的 SQL 语法是相同的，**我们在向 codefirst 撒谎，因为视图是表！**

例如：如果我们想从`vwCustomerDetails`为实体调用的视图中获取数据`CustomerDetail`，我们可以使用数据注释来执行此操作

```
[Table("vwCustomerDetails")]
public class CustomerDetail
{
  // properties
} 
```

或者，使用 Fluent API，您可以执行此操作，

```
modelBuilder.Entity<CustomerDetail>().ToTable("vwCustomerDetails"); 
```

**从普通视图加载数据**

有时您可能希望从另一个视图加载一些数据，该视图返回与我们的初始假表（视图）相同的结果。例如：在某些页面中，我们需要显示得分最高的前十名 CustomerDetails。假设我们有一个单独的视图调用`vwTop10Customers`它。我们可以使用 DBSet 上的 SqlQuery 方法来加载这样的 entotues

```
var topCustomers=dbContext.CustomerDetails.SqlQuery("SELECT * FROM  vwTop10Customers"); 
```

视图必须返回与实体完全相同的列名。否则 EF 将在映射时遇到问题。

# c# - System.InvalidCastException：指定的演员表无效

> ID：10505797
> 
> 赞同：2
> 
> 时间：2012-05-08T20:12:36.573
> 
> 标签：c#, sql-server, datetime

我从数据库中检索了一个表，其中包含 sql server 中“时间”类型的列，我尝试将其分配给 DateTime 变量，但我收到此错误：System.InvalidCastException：指定的转换无效。

这是我的 C# 代码：

```
DateTime StartTime = (DateTime)dt.Rows[i]["startTime"]; 
```

知道“startTime”列的类型是“time”，我可以在数据库中更改它。有什么帮助吗？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T20:48:19.370

```
DateTime StartTime = Convert.ToDateTime(dt.Rows[i]["startTime"].ToString()); 
```

如果你知道它可能是空的..

```
DateTime StartTime = (dt.Rows[i]["startTime"] == DBNull.Value ? DateTime.MinValue : Convert.ToDateTime(dt.Rows[i]["startTime"].ToString())); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T20:40:15.727

您应该能够将其转换为`TimeSpan`：

```
var startTime = dt.Rows<TimeSpan>("startTime"); 
```

# jquery - Jquery用字符串交换img src？+ 网址编码

> ID：10505799
> 
> 赞同：1
> 
> 时间：2012-05-08T20:12:37.867
> 
> 标签：jquery, image, src, url-encoding

我正在使用二维码生成器，当用户点击“生成代码”按钮时，我需要将图像（生成二维码）换出。所以我需要图像 src 成为 textarea 值和纠错值的组合，以及 url 编码。

这是我所拥有的：

```
 <script type="text/javascript">
$(document).ready(function() {
    var $qr_image = $('#qr-image');
    var $qr_text = $('#qr-text');
    var $qr_elc = $('#qr-elc');

    $.qrGenerate = function() {
        $qr_image.attr('src', '$qr_text.val' + '$qr_elc.val');
    }
    });
</script> 
```

下面的行是我的麻烦来自哪里。现在，当我单击按钮时，我得到：“http://urlblahblah/$qr_text.val$qr_elc.val”

`$qr_image.attr('src', '$qr_text.val' + '$qr_elc.val');`

我也知道编码是通过使用 escape(''); 完成的，但我不知道把它放在哪里。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:16:07.390

当你在变量周围加上引号时，它会变成一个字符串，你应该使用不带引号的变量名：

```
$.qrGenerate = function() {
    $qr_image.attr('src', $qr_text.val() + $qr_elc.val());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:15:42.083

当您在值周围使用引号时，您正在组合两个字符串`$qr_text.val`和`$qr_elc.val()`，因此您的结果。摆脱`'`你的价值观，你应该没问题：

```
$qr_image.attr('src', $qr_text.val() + $qr_elc.val()); 
```

# java - 在祖父母班上打电话给超级？

> ID：10505801
> 
> 赞同：0
> 
> 时间：2012-05-08T20:12:38.687
> 
> 标签：java, super

> **可能重复：**
> [为什么是 super.super.method(); 在 Java 中不允许？](https://stackoverflow.com/questions/586363/why-is-super-super-method-not-allowed-in-java)

```
Class A
Class B extends A
Class C extends B 
```

如何让 C 类中的方法调用 A 类的超类？

我试过这个，但它失败了......

```
A.super.someMethod(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:24:24.043

如果您打算调用`super.super.someMethod()`Java，那么简单的答案是您不能这样做。Java 故意禁止这样做，因为它违反了封装。

# sql - 从 ER 图生成 SQL 的好软件？

> ID：10505810
> 
> 赞同：5
> 
> 时间：2012-05-08T20:13:15.893
> 
> 标签：sql, database

我正在创建一个数据库，我需要创建一些表。

我想知道您使用或推荐哪些软件（最好是免费的）从 ER 图中生成 SQL 代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:25:11.393

多年来，我们一直使用 Case Studio 2 对相当复杂的模式进行建模——它非常好。我们使用它为 MySQL、Oracle 和 SQL Server 创建脚本。它现在被称为 Toad Data Modeller：[https](https://www.quest.com/products/toad-data-modeler/) ://www.quest.com/products/toad-data-modeler/有一个免费软件版本（虽然不确定这与付费许可版本有何不同）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:15:48.337

不是免费的，但很有效：[Microsoft Visio](http://office.microsoft.com/en-us/visio/)。

它有一个很好的 ER 图模板，包含关系、主键信息等。我相信它既可以在数据库中生成模式，也可以通过将其指向数据库来创建图。

# android - Android - 我也在哪里解压缩我的 apk 扩展文件？

> ID：10505811
> 
> 赞同：1
> 
> 时间：2012-05-08T20:13:18.347
> 
> 标签：android, apk, expansion

我们已经打破了 Google 的 APK 大小限制，并计划通过扩展包发送我们下载的声音文件。“assets”文件夹中有两个目录用于保存我们的 oggsm，Music 和 Sounds

第一部分进行得很顺利，设法将包含这两个目录和大约 200 个文件的压缩文件推送到 obb 文件夹中，并且可以打开 zip 并访问其中的文件。

问题是我把它们放在哪里？

我一直在尝试获取我们的 apk 数据最初解包的根目录，并将声音放回它们之前所在的位置。

这是正确的还是我们应该使用 getexternalfilesdir() 并将我的两个文件夹放在那里并使用新位置来播放声音？

感谢您的任何回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T22:58:56.133

请不要解压缩您的 APK 扩展文件。通过使用 zip -0 添加它们，以将它们存储在 APK 文件（未压缩）中的方式存储您的资产。然后，您可以直接从 APK 扩展文件中流式传输它们。如果您解压缩 APK 扩展文件，您需要将文件存储两次，因为如果您更新您的应用程序，Google Play 将再次下载 APK 扩展文件。

Android 中的所有音频和视频 API 都将采用 FileDescriptor、偏移量和长度。

例子：

[http://developer.android.com/reference/android/media/MediaPlayer.html#setDataSource(java.io.FileDescriptor](http://developer.android.com/reference/android/media/MediaPlayer.html#setDataSource(java.io.FileDescriptor) , long, long)

事实证明，APK 扩展文件包附带的示例代码在 ZipResourceFile 中有一个函数，该函数返回一个 AssetFileDescriptor。

AssetFileDescriptor 对象返回偏移量和长度，以及原始文件描述符。

# python - Python和gevent - AttributeError：“模块”对象没有属性“队列”

> ID：10505820
> 
> 赞同：0
> 
> 时间：2012-05-08T20:13:52.197
> 
> 标签：python, gevent

我对 gevent 相当陌生，但我试图创建一个队列，但出现以下错误。我正在使用python2.7。

```
import gevent
queue = gevent.queue.Queue()

Traceback (most recent call last):
  File "/home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbAsyncServers/bottleServer.py", line 8, in <module>
    queue = gevent.queue.Queue()
AttributeError: 'module' object has no attribute 'queue' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:20:47.700

尝试：

```
import gevent.queue
queue = gevent.queue.Queue() 
```

或者

```
from gevent.queue import Queue
queue = Queue() 
```

# iphone - 如何在 Windows 上创建 iphone webapp？（我可以用我朋友的mac来整理）

> ID：10505823
> 
> 赞同：0
> 
> 时间：2012-05-08T20:14:05.497
> 
> 标签：iphone, windows, web-applications

我知道有人问过很多类似的问题，但我的情况有点不同。

我有一台 Windows 机器，我想在其上进行开发。我可以借用我朋友的 mac 来签名/发布到商店或其他东西。

是否有可能做到这一点？我可以在 Eclipse 中创建一个“动态 Web 应用程序项目”，进行编码并最终使用 MAC 来完成它吗？我的应用是 100% 离线应用。

在哪里可以找到 HTML/CSS 文件的目录结构？

如何实现按钮和其他 UI 的 iphone 外观？

我知道很多人都这样做了，但我找不到任何教程。如果你知道的话，请给我指一个。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:17:24.057

听起来这对于电话间隙来说是一项很棒的工作。

[http://phonegap.com/](http://phonegap.com/)

他们提供包装软件，让您的 Web 应用程序在手机上本地运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:23:29.427

在我看来，您应该查看[phonegap](http://www.phonegap.com)进行编码。

为了让您的按钮、背景、图标等看起来和感觉更像原生 iOS 应用程序，请查看此[iOS 图形列表](http://webdesignledger.com/freebies/11-ui-kits-for-iphone-and-ipad-development)。大多数都是免费的。有带有预剪切图像的 .zip 文件，以及许多 .psd 文件供您选择。如果您不使用 xCode 或 Titanium 来构建应用程序，这些是获得原生外观和感觉的好方法。

# javascript - 如何在使用 jquery 模板时按顺序淡入项目

> ID：10505825
> 
> 赞同：0
> 
> 时间：2012-05-08T20:14:11.217
> 
> 标签：javascript, jquery, jquery-templates

嘿伙计们，我正在尝试在使用 jquery 模板时按顺序淡入项目列表。

我已经看到如何在不使用 jquery 模板的情况下执行此操作，但不确定在使用它们时如何执行此操作。

这是我想要的效果：

[http://demos.coolajax.net/jquery/sequential_fadein_fadeout/](http://demos.coolajax.net/jquery/sequential_fadein_fadeout/)

这是我的模板代码：

```
$template.tmpl(formattedData).appendTo($el); 
```

谢谢你的帮助！

更新：

我认为以下是我需要做的......

```
$template.tmpl(formattedData).appendTo($el).delay(100*index).fadeIn(250); 
```

问题是如何获得该索引值？

我可以做这样的事情吗？

```
$template.tmpl(formattedData).appendTo($el).each(function(i){$.delay(100*i).fadeIn(250)}); 
```

更新：

我能够弄清楚。这是答案

```
$template.tmpl(formattedData).appendTo($el).each(function(i){$(this).delay(200*i).fadeIn(250);}); 
```

不要忘记在你的 CSS 中为你的 'li' 设置你的 display 属性为 none （这部分已经正确了）。

无论如何，感谢所有试图提供帮助的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:30:22.437

您应该附加“display：none”样式，然后为每个样式设置动画。

在您的代码中，“每个”不会迭代 li 标签，它会尝试迭代 li.parent 标签（ul）。

```
$(document).ready(function() {
    for(var i=0; i < 10; i++) {
        $("ul").append("<li style='display:none'>New element-"+i+"</li>")
    }
    $("ul li").each(function(index) {                    
            $(this).delay(100*index).fadeIn(250);
            $("li:even").css("background","#cfe9b6");
            $("li:odd").css("background","#b0db86");
     });
});​ 
```

[演示](http://jsfiddle.net/f6Mn3/)

# jquery - 如何在 jQuery Mobile 中导航正确的页面

> ID：10505841
> 
> 赞同：0
> 
> 时间：2012-05-08T20:15:49.497
> 
> 标签：jquery, html

我是 jQuery Mobile 的新手。我尝试使用 jquery 导航到页面，但 URL 有问题。

我的代码

```
 <a href="http://tom.hostxx.com/car.html" data-role="button" data-theme="c" data-transition="pop">Car</a> 
```

它加载了页面[http://tom.hostxx.com/#http://tom.hostxx.com/car.html](http://tom.hostxx.com/#http://tom.hostxx.com/car.html)的空白内容，而不是[http://tom.hostxx.com/car.html](http://tom.hostxx.com/car.html)。

谁能解释一下？太感谢了！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:28:17.227

你有没有试过放一个相对的href？

我不知道您的页面到底在哪里，但类似`href="car.html"`​​.

您应该查看[文档](http://jquerymobile.com/demos/1.1.0/docs/pages/page-links.html)并查看他们的代码。

# download - Opa : 为二进制资源命名

> ID：10505842
> 
> 赞同：1
> 
> 时间：2012-05-08T20:15:55.340
> 
> 标签：download, binary, opa

我正在尝试从 opa 数据库下载文件。我使用了以下代码：

```
case {path:[], query:[("download", filename)], ...} : Resource.binary(/myDatabase[filename], "application/txt") 
```

它工作正常，但我下载的文件始终命名为“download.txt”。如何更改此名称？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:49:54.503

```
case {path:[], query:[("download", filename)], ...} : Resource.binary(/myDatabase[filename], "application/txt") |> Resource.add_header(_, {content_disposition={attachment=filename}}) 
```

# javascript - 如何使用类名隐藏 DIV？

> ID：10505847
> 
> 赞同：-1
> 
> 时间：2012-05-08T20:16:17.540
> 
> 标签：javascript, jquery

我的代码：

```
var array1 = document.getElementsByClassName("div");
var array2 = document.getElementsByClassName("button");

    for(var i = 0; i < array1.length; i++)
    {
        $(array2[i]).show();
        $(array1[i]).hide();

        $(array2[i]).click(function(){
            $(array1[i]).slideToggle();
        });
    } 
```

为什么出现错误：无法转换 JavaScript 参数 arg 0？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T20:20:57.100

```
var $buttons = $(".button").hide();

$(".div").show().bind("click", function(event) {
    var index = $divs.index(this);

    $buttons.eq(index).slideToggle();
}); 
```

或者：

```
var $buttons = $(".button").hide(),
    $divs = $(".div").show();

$.each($buttons, function(index) {
    var $button = $(this);
    $divs.eq(index).bind("click", function() {
        $button.slideToggle();
    });
}); 
```

或者

```
var $buttons = $(".button").hide(),
    $divs = $(".div").show();

$buttons.each(function(index) {
    var $button = $(this);
    $divs.eq(index).bind("click", function() {
        $button.slideToggle();
    });
}); 
```

# javascript - 如果未安装 Google 地球插件，请切换到 Google 地图

> ID：10505850
> 
> 赞同：2
> 
> 时间：2012-05-08T20:16:35.627
> 
> 标签：javascript, google-maps, dom-events, google-earth, google-earth-plugin

我目前正在制作一些使用 ge 插件的 Google 地球网络应用程序。但是，并不是每个人都安装了它，而且您还无法获得移动设备的插件。我已经进行了 js 检查以查看用户是否有 ge 插件。我想做的是提供继续和下载插件或切换到页面的谷歌地图版本的选项。

关于如何最好地做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T22:03:36.333

如果你显示插件并且用户没有安装插件，它会自动用地球-y图像和一个按钮来填充目标div来安装插件。所以真的，你只需要决定如何引导用户并为他们提供选择，如果他们想要一种体验或另一种体验。

您可以使用

```
google.earth.isSupported() 
```

检查一个平台是否完全不受支持（例如，在移动设备上），如果它返回 false，则自动重定向到基于地图的页面版本，没有返回选项（因为没有办法他们运行地球插件）。

在`isSupported()`返回 true 的平台上，您可以使用

```
google.earth.isInstalled() 
```

检查插件是否已安装。如果*该*检查返回 false，您可以将用户重定向到基于地图的页面，但包含一个用于安装插件的按钮，或者您可以将它们留在基于地球的页面上，该页面将自动包含“安装地球插件”按钮，如果他们不想安装任何东西，您可以在其下方放置一个额外的按钮供用户选择基于地图的版本。

如果两个函数都返回 true，那么您显然可以做任何您想做的事情。

编辑：实际上，您似乎已经对至少其中一些操作感到满意，因此，如果您只是在寻找允许在两个版本之间切换的最佳实践，我发现只需在插件下方提供一个链接或一个按钮div 对于大多数用户来说已经足够了。

# java - 如何在不编写已经很简单的方法的情况下简化一个类？

> ID：10505851
> 
> 赞同：4
> 
> 时间：2012-05-08T20:16:47.010
> 
> 标签：java, python, oop, facade

我有一个复杂的类，我想通过实现一个外观类来简化它（假设我无法控制复杂的类）。我的问题是复杂类有很多方法，我将简化其中的一些，其余的将保持原样。下面解释我所说的“简化”。

我想找到一种方法，如果一个方法是用外观实现的，然后调用它，如果没有，那么在复杂类中调用该方法。我想要这个的原因是编写更少的代码:) [少即是多]

**例子：**

```
Facade facade = // initialize
facade.simplified(); // defined in Facade class so call it

// not defined in Facade but exists in the complex class
// so call the one in the complex class
facade.alreadySimple(); 
```

想到的选项是：

**选项1：**编写一个包含复杂类变量的类并实现复杂类，然后通过直接委托实现简单类：

```
class Facade {
    private PowerfulButComplexClass realWorker = // initialize
    public void simplified() {
         // do stuff
    }
    public void alreadySimple() {
         realWorker.alreadySimple();
    }
    // more stuff
} 
```

但是使用这种方法，我将需要只用一个委托语句来实现所有简单的方法。所以我需要写更多的代码（虽然很简单）

**选项 2：**扩展复杂类并实现简化的方法，但是这些方法的简单和复杂版本都将可见。

在python中，我可以实现类似的行为：

```
class PowerfulButComplexClass(object):
    def alreadySimple(self):
        # really simple

    # some very complex methods

class Facade(object):
    def __init__(self):
        self.realworker = PowerfulButComplexClass()
    def simplified(self):
        # simplified version of complex methods in PowerfulButComplexClass

    def __getattribute__(self, key):
    """For rest of the PowerfulButComplexClass' methods use them as they are
    because they are simple enough.
    """
        try:
            # return simplified version if we did
            attr = object.__getattribute__(self, key)
        except AttributeError:
            # return PowerfulButComplexClass' version because it is already simple
            attr = object.__getattribute__(self.data, key)
        return attr

obj = Facace()
obj.simplified() # call the one we have defined
obj.alreadySimple( # call the one defined in PowerfulButComplexClass 
```

*那么实现这一点的 Java 方法是什么？*

编辑：我所说的“简化”是什么意思：复杂的方法可以是具有太多参数的方法

```
void complex method(arg1, arg2, ..., argn) // n is sufficiently large 
```

或一组相关的方法，它们几乎总是一起调用以完成单个任务

```
outArg1 = someMethod(arg1, arg2);
outArg2 = someOtherMethod(outArg1, arg3);
actualResult = someAnotherMethod(outArg2); 
```

所以我们想要这样的东西：

```
String simplified(arg1, arg2, arg3) {
    outArg1 = someMethod(arg1, arg2);
    outArg2 = someOtherMethod(outArg1, arg3);
    return someAnotherMethod(outArg2);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:20:03.733

这叫继承。考虑以下代码：

```
class Complex {
    public function complex() { /* Complex Function */ }
    public function simple() { /* Already simple function */ }
}

class SimplifiedComplex extends Complex {
    public function complex() { /* Simplify Here */ }
} 
```

该`simple()`方法将作用于一个`SimplifiedComplex`对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T20:53:40.260

我想你已经调用它了。我会选择选项 1。考虑到 java 的刚性，它提供了最大的灵活性。

我更喜欢它，因为它有利于组合而不是继承。尽管这会创建更多代码，但我发现从长远来看，这样的设计通常更容易修改。

继承只能用于建模严格的“是”关系，其中子类必须具有**基类的所有属性和行为**。如果您将继承用于其他任何事情，那么您会自找麻烦。

最后，我不赞成“少即是多”的想法（在此处插入非常简洁、难以理解的 perl 示例）。我认同“代码应该尽可能简单，而不是简单”的原则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T20:33:58.913

根据您的用例，您可能希望通过委托（选项 1）在复杂类中的某些功能前面创建一个外观，而不是为复杂类中的其余功能提供支持，而是提供访问方法直接复杂类（getComplexClass）。

这可能会使设计更清晰。例如，考虑一个处理银行系统大部分功能的复杂类。创建一个名为“Account”的类，它可以访问复杂的类，但只使用与银行账户相关的方法，这有助于设计。为方便起见，Account 类可以有一个方法 getBankSystemForAccount 或类似的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-09T01:09:58.477

这在 Java 中很难看，但是您可以编写一个函数，该函数接受您要调用的方法的名称和一个参数列表，并使用反射找到要调用的适当方法。这在概念上与您在 Python 中的操作方式相似，只是更难看。

# php - 将 MySQL 变量传递给 Joomla 模块，而不是使用 Twitter 搜索的默认字段

> ID：10505852
> 
> 赞同：0
> 
> 时间：2012-05-08T20:16:58.677
> 
> 标签：php, mysql, joomla

看来我在这里碰壁了，需要一些帮助

想将 MySql 变量传递给 Joomla 模块

我使用 Yootheme 的 Widget-kit 来显示来自搜索词的推文。效果很好，但您需要在模块后端输入 twitter 搜索词。

相反，我想使用一个变量（已在页面上使用）并将该变量传递给 Twitter 模块，以便它可以显示我想要的推文

以下是一些 PHP 行，其中包含我想使用的变量

```
$document->setTitle(JText::sprintf('COVERAGE_DATA_PLACE', $this->country->country_name,     $this->city->city_name));

$text = JString::str_ireplace('%city_name%',$this->city->city_name,$text);

$this->setBreadcrumbs(array('country','city')); 
```

有什么方法可以获取“City”变量并将其发送到 twitter 模块中的“word”字段？

这是 twitter 模块的代码

```
<?php

Class: TwitterWidgetkitHelper
    Twitter helper class
*/
class TwitterWidgetkitHelper extends WidgetkitHelper {

/* type */
public $type;

/* options */
public $options;

/*
    Function: Constructor
        Class Constructor.
*/
public function __construct($widgetkit) {
    parent::__construct($widgetkit);

    // init vars
    $this->type    = strtolower(str_replace('WidgetkitHelper', '', get_class($this)));
    $this->options = $this['system']->options;

    // create cache
    $cache = $this['path']->path('cache:');
    if ($cache && !file_exists($cache.'/twitter')) {
        mkdir($cache.'/twitter', 0777, true);
    }

    // register path
    $this['path']->register(dirname(__FILE__), $this->type);
}

/*
    Function: site
        Site init actions

    Returns:
        Void
*/
public function site() {

    // add translations
    foreach (array('LESS_THAN_A_MINUTE_AGO', 'ABOUT_A_MINUTE_AGO', 'X_MINUTES_AGO', 'ABOUT_AN_HOUR_AGO', 'X_HOURS_AGO', 'ONE_DAY_AGO', 'X_DAYS_AGO') as $key) {
        $translations[$key] = $this['system']->__($key);
    }

    // add stylesheets/javascripts
    $this['asset']->addFile('css', 'twitter:styles/style.css');
    $this['asset']->addFile('js', 'twitter:twitter.js');
    $this['asset']->addString('js', sprintf('jQuery.trans.addDic(%s);', json_encode($translations)));

    // rtl
    if ($this['system']->options->get('direction') == 'rtl') {
        $this['asset']->addFile('css', 'twitter:styles/rtl.css');
    }

}

/*
    Function: render
        Render widget on site

    Returns:
        String
*/
public function render($options) {

    if ($tweets = $this->_getTweets($options)) {

        // get options
        extract($options);

        return $this['template']->render("twitter:styles/$style/template", compact('tweets', 'show_image', 'show_author', 'show_date', 'image_size'));
    }

    return 'No tweets found.';
}

/*
    Function: _getURL
        Create Twitter Query URL

    Returns:
        String
*/
protected function _getURL($options) {

    // get options
    extract($options);

    // clean options
    foreach (array('from_user', 'to_user', 'ref_user', 'word', 'nots', 'hashtag') as $var) {
        $$var = preg_replace('/[@#]/', '', preg_replace('/\s+/', ' ', trim($$var)));
    }

    // build query
    $query = array();

    if ($from_user) {
        $query[] = 'from:'.str_replace(' ', ' OR from:', $from_user);
    }

    if ($to_user) {
        $query[] = 'to:'.str_replace(' ', ' OR to:', $to_user);
    }

    if ($ref_user) {
        $query[] = '@'.str_replace(' ', ' @', $ref_user);
    }

    if ($word) {
        $query[] = $word;
    }

    if ($nots) {
        $query[] = '-'.str_replace(' ', ' -', $nots);
    }

    if ($hashtag) {
        $query[] = '#'.str_replace(' ', ' #', $hashtag);
    }

    $limit = min($limit ? intval($limit) : 5, 100);

    // build timeline url
    if ($from_user && !strpos($from_user, ' ') && count($query) == 1) {

        $url = 'http://twitter.com/statuses/user_timeline/'.strtolower($from_user).'.json';

        if ($limit > 15) {
            $url .= '?count='.$limit;
        }

        return $url;
    }

    // build search url
    if (count($query)) {

        $url = 'http://search.twitter.com/search.json?q='.urlencode(implode(' ', $query));

        if ($limit > 15) {
            $url .= '&rpp='.$limit;
        }

        return $url;
    }

    return null;    
}

/*
    Function: _getTweets
        Get Tweet Object Array

    Returns:
        Array
*/
protected function _getTweets($options) {

    // init vars
    $tweets = array();

    // query twitter
    if ($url = $this->_getURL($options)) {
        if ($path = $this['path']->path('cache:twitter')) {
            $file = rtrim($path, '/').sprintf('/twitter-%s.php', md5($url));

            // is cached ?
            if (file_exists($file)) {
                $response = file_get_contents($file);
            }

            // refresh cache ?
            if (!file_exists($file) || (time() - filemtime($file)) > 300) {

                // send query
                $request = $this['http']->get($url);

                if (isset($request['status']['code']) && $request['status']['code'] == 200) {
                    $response = $request['body'];
                    file_put_contents($file, $response);
                }
            }
        }
    }

    // create tweets
    if (isset($response)) {

        $response = json_decode($response, true);

        if (is_array($response)) {

            if (isset($response['results'])) {
                foreach ($response['results'] as $res) {

                    $tweet = new WidgetkitTweet();
                    $tweet->user = $res['from_user'];
                    $tweet->name = $res['from_user'];
                    $tweet->image = $res['profile_image_url'];
                    $tweet->text = $res['text'];
                    $tweet->created_at = $res['created_at'];
                    $tweets[] = $tweet;
                }
            } else {
                foreach ($response as $res) {

                    $tweet = new WidgetkitTweet();
                    $tweet->user = $res['user']['screen_name'];
                    $tweet->name = $res['user']['name'];
                    $tweet->image = $res['user']['profile_image_url'];
                    $tweet->text = $res['text'];
                    $tweet->created_at = $res['created_at'];

                    $tweets[] = $tweet;
                }
            }

        }
    }

    return array_slice($tweets, 0, $options['limit'] ? intval($options['limit']) : 5);
}

}

class WidgetkitTweet {

public $user;
public $name;
public $image;
public $text;
public $created_at;

public function getLink() {
    return 'http://twitter.com/'.$this->user;           
}

public function getText() {

    // format text
    $text = preg_replace('@(https?://([-\w\.]+)+(/([\w/_\.]*(\?\S+)?(#\S+)?)?)?)@', '<a href="$1">$1</a>', $this->text);
    $text = preg_replace('/@(\w+)/', '<a href="http://twitter.com/$1">@$1</a>', $text);
    $text = preg_replace('/\s+#(\w+)/', ' <a href="http://search.twitter.com/search?q=%23$1">#$1</a>', $text);

    return $text;           
}

}

// bind events
$widgetkit = Widgetkit::getInstance();
$widgetkit['event']->bind('site', array($widgetkit['twitter'], 'site')); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T18:08:36.363

我相信你可以用这个做你想做的事： [http ://www.j-plant.com/joomla-extensions/free-extensions/26-module-plant.html](http://www.j-plant.com/joomla-extensions/free-extensions/26-module-plant.html)

> 该插件支持模块参数覆盖。使用以下代码覆盖参数：
> 
> `[moduleplant id="77" <param_name_1>="<param_value_1>" <param_name_N>="<param_value_N>"]` 用必要的参数名称和值替换和。您可以根据需要覆盖任意数量的参数。可用的模块参数可以在模块 XML 清单文件中找到。清单文件通常位于下一个路径中：
> 
> ```
> modules/<module_type>/<module_type>.xml 
> ```

# ruby-on-rails - 在 Rails 应用程序中使用 accept_nested_attributes_for 时如何维护嵌套属性的顺序

> ID：10505853
> 
> 赞同：22
> 
> 时间：2012-05-08T20:16:59.347
> 
> 标签：ruby-on-rails, nested-attributes

这是父模型：

```
class TypeWell < ActiveRecord::Base
   ...

  has_many :type_well_phases, :dependent => :destroy
  accepts_nested_attributes_for :type_well_phases, :reject_if => lambda { |a| a[:phase_id].blank? }, :allow_destroy => true

  ...
end 
```

这是嵌套模型：

```
class TypeWellPhase < ActiveRecord::Base

  belongs_to :type_well
  belongs_to :phase

end 
```

这是阶段模型：

```
class Phase < ActiveRecord::Base
  ... 
  has_many :type_well_phases
  ...
end 
```

我通过从父模型控制器中的阶段（阶段模型）表中复制所有记录来在子表（TypeWellPhases）中添加嵌套记录，如下所示：

```
class TypeWellsController < ResourceController
   ...
  def new
    @new_heading = "New Type Well - Computed"
    @type_well   = TypeWell.new
    initialize_phase_fields
  end

  private

  def initialize_phase_fields
    Phase.order("id").all.each do |p|
      type_well_phase               = @type_well.type_well_phases.build
      type_well_phase.phase_id      = p.id
      type_well_phase.gw_heat_value = p.gw_heat_value
    end
  end
  ...
end 
```

我这样做是因为我想通过添加的子字段保持特定的顺序。代码 Phase.order("id") 的一部分就是为此，因为阶段表具有特定顺序的这些记录。

在此之后，我使用 simple_form_for 和 simple_fields_for 帮助器，如下所示在我的部分表单中：

```
= simple_form_for @type_well do |f|
    ...
    #type_well_phases
      = f.simple_fields_for :type_well_phases do |type_well_phase|
        = render "type_well_phase_fields", :f => type_well_phase 
```

一切都按预期工作；大部分的时间。但是，有时表单中子行的顺序在保存后会变得混乱。顺序在此应用程序中很重要，这就是为什么我在控制器的私有方法中明确执行此排序的原因。

我正在使用“茧”宝石添加删除子记录。我不确定为什么这个订单有时会搞砸。

很抱歉这么长的帖子，但我想预先提供所有相关的细节。

感谢任何指针。

巴拉特

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-05-08T20:39:53.750

我将以更通用的方式向您解释。假设您有 Product 和 Order 模型：

```
= form_for @product do |f|
    ...
    = f.fields_for :orders do |order_fields|
        = order_fields.text_field :name 
```

如果您希望您的订单按名称排序，那么只需对它们进行排序:)

代替：

```
 = f.fields_for :orders do |order_fields| 
```

放：

```
 = f.fields_for :orders, f.object.orders.order(:name) do |order_fields| 
```

如您所见，作为has 方法`f`块参数的变量。这是您的@product，因此您可以通过获取其订单，然后通过应用所需的排序（对于这个小小的混乱，抱歉：订单/订单）。`form_for``object``.orders``.order(:name)`

您可以将排序顺序作为`fields_for`.

PS您使用 simple_form gem 不会影响我的解决方案。如果您将“simple_”添加到助手中，它将起作用。只是希望我的回答对其他人更有帮助，而不是太与任务相关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-30T04:11:12.167

如果您使用的是 Rails 2.3.14 或更早版本，则必须使用：

```
f.fields_for :orders, f.object.orders.all(:order => :name) do |order_fields| 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2022-02-16T11:46:35.873

我用这种方式：

```
class League < ActiveRecord::Base
  has_many :rounds, -> { sort_by_number }, dependent: :destroy
end

class League::Round < ActiveRecord::Base
  belongs_to :league
  scope :sort_by_number, -> { order('league_rounds.number ASC') }
end 
```

在视图中

```
= form_for league do |f|
  = f.fields_for :rounds do |round_form|
    # Here rounds are sorted by sort_by_number 
```

这种方法允许使用模型中定义的任何范围。这种方法允许创建几个不同排序的关联。

# ios - NSURLConnection/NSURLRequest 是否将 POST 默认设置为表单提交？

> ID：10505854
> 
> 赞同：0
> 
> 时间：2012-05-08T20:17:13.437
> 
> 标签：ios

我正在使用 NSURLConnection 和 NSURLRequest 将一些 XML 数据的 HTTP POST 发送到服务器。

但是，服务器无法在 HTTP 正文中找到数据，因为它已被打包，假设网页正在执行表单提交（参数 = form-urlencoded 正在设置，可能默认情况下由 NSURLConnection 设置？）。

这不是我明确要做的事情，我只是使用以下方法添加正文数据：

```
 [request setHTTPBody: [body dataUsingEncoding:NSUTF8StringEncoding]]; 
```

如何停止/覆盖此行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:58:34.263

我不知道默认值，但您可以更改它：

```
[request setValue:@"application/x-www-form-urlencoded charset=utf-8" forHTTPHeaderField:@"Content-Type"]; 
```

看看[文档](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSMutableURLRequest_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMutableURLRequest/setValue%3aforHTTPHeaderField%3a)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T09:40:56.047

在这里，我在 Web 服务器上发布 XML 数据并使用 NSURLConnection 获取 xml 响应。步骤如下：

1) 通过 NSURLConnection 异步请求在服务器上发布数据

```
 NSMutableString *productDetailString =[[NSMutableString alloc] init];

    [productDetailString appendString:@"<product>"];
    [productDetailString appendFormat:@"<product_name>%@</product_name>",name];
    [productDetailString appendString:@"<product_id>1024</product_id>"];
    [productDetailString appendString:@"</product>"];        

     NSString *message=[[NSString alloc] initWithFormat:@"_xmlrequestPostage=%@",productDetailString];

//    NSString *message=[[NSString alloc] initWithFormat:@"_xmlrequestPostage="                             
//                      "<product>\n"
//                          "<product_name>%@</product_name>\n"
//                          "<product_id>%@</product_id>\n"
//                      "</product>\n",name, id];

    NSString *urlString = [NSString stringWithFormat:@"http://flightsflights.com.au/Mega/product.asmx/GetProductPrice"];

    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init] ;
    [request setURL:[NSURL URLWithString:urlString]];
    [request setHTTPMethod:@"POST"];

    //set headers

    NSString *contentType = [NSString stringWithFormat:@"application/x-www-form-urlencoded"];
    [request addValue:contentType forHTTPHeaderField: @"Content-Type"];

    [request addValue:[NSString stringWithFormat:@"%d",[message length]] forHTTPHeaderField:@"Content-Length"];

    //create the body

    NSMutableData *postBody = [[NSMutableData alloc]initWithData:[[NSString stringWithFormat:@"%@",message] dataUsingEncoding:NSUTF8StringEncoding]];

    //post
    [request setHTTPBody:postBody];

    //get response
    NSURLConnection *connection=[[NSURLConnection alloc] initWithRequest:request delegate:self];

    if(connection)
    {
        webData=[[NSMutableData data] retain];
    }
    else
    {
        UIAlertView *alert=[[UIAlertView alloc] initWithTitle:@"Mega Australia" message:@"Problem in network." delegate:self cancelButtonTitle:@"Ok" otherButtonTitles:nil];
        [alert show];
        [alert release];
    } 
```

2) 通知 NSURLConnection 类的代表

```
 -(void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
    {
       [webData setLength: 0];
    }
   -(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
    {
       [webData appendData:data];
    }
   -(void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
    {
         UIAlertView *alert=[[UIAlertView alloc]initWithTitle:@"Error" message:@"ERROR with conenction " delegate:self cancelButtonTitle:@"Ok" otherButtonTitles:nil, nil];
        [alert show];
        [alert release];
    [connection release];
    [webData release];
    }
   -(void)connectionDidFinishLoading:(NSURLConnection *)connection
   {
        if(webData==nil)
        {
             UIAlertView *thealert=[[UIAlertView alloc] initWithTitle:@"Error" message:@"No data found." delegate:self cancelButtonTitle:@"Ok" otherButtonTitles:nil];
            [thealert show];
            [thealert release];
        }
        else
        {

             NSString *str=[[NSString alloc] initWithData:webData encoding:NSUTF8StringEncoding];

            str=[str stringByReplacingOccurrencesOfString:@"&lt;" withString:@"<"];
            str=[str stringByReplacingOccurrencesOfString:@"&gt;" withString:@">"];

            NSData *data=[str dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES];
            product=[[NSMutableArray alloc] init];

            NSXMLParser *xmlParser=[[NSXMLParser alloc] initWithData:data];
            xmlParser.delegate=self;
            [xmlParser parse];
            webData=nil;
            [webData release];
       }
   } 
```

3) 在 .h 文件中添加以下变量： { NSMutableData *webData; NSMutableDictionary *aProduct; NSMutableArray *产品；

```
 NSMutableString *name, *pro_id, *currentElement, *statusCode;
   }
   @property (retain, nonatomic) NSMutableString *name;
   @property (retain, nonatomic) NSMutableString *pro_id;
   @property (retain, nonatomic) NSMutableString *statusCode; 
```

4) .m 文件中的综合名称、pro_id 和 statusCode

5) 通知 NSXMLParse 类的代表

```
 -(void) parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
     {
           currentElement=[elementName copy];

           if([elementName isEqualToString:@"product"])
           {
              self.name=[[NSMutableString alloc] init];
              self.pro_id=[[NSMutableString alloc] init];

              aProduct=[[NSMutableDictionary alloc] init];
           }
           else if([elementName isEqualToString:@"status"])
           {
               self.statusCode=[[NSMutableString alloc] init];
           }
     }

     -(void) parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
     {
          if([currentElement isEqualToString:@"product_name"])
          {
               [self.name appendString:string];
          }
          else if([currentElement isEqualToString:@"product_id"])
          {
                [self.pro_id appendString:string];
          }
          else if([currentElement isEqualToString:@"status"])
          {
                [self.statusCode appendString:string];
                if(![self.statusCode isEqualToString:@"200"])
                {
                      UIAlertView *alert=[[UIAlertView alloc] initWithTitle:@"Mega Australia" message:@"Input string is not in a correct format." delegate:self cancelButtonTitle:@"Ok" otherButtonTitles: nil];
                      [alert show];
                      [alert release];
                      return;
                 }
           }
      }

      - (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
      {
           if ([elementName isEqualToString:@"product"])
           {
                 [aProduct setObject:self.name forKey:@"name"];
                 [aProduct setObject:self.pro_id forKey:@"id"];

                 [product addObject:[aProduct copy]];
            }
      }

      - (void)parserDidEndDocument:(NSXMLParser *)parser
      {
            return;
      } 
```

# deployment - JBoss 7.1 如何将ear/war 部署到外部目录

> ID：10505856
> 
> 赞同：5
> 
> 时间：2012-05-08T20:17:20.720
> 
> 标签：deployment, jboss7.x

在 JBoss 7.1 中，默认部署目录是独立/部署。

我想将此默认值更改为外部目录。我知道在 JBoss 5 中，我可以在 profile-repository.xml 中指定它。

如何在 JBoss 7.1 中做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T21:10:48.177

查看[部署扫描仪](https://docs.jboss.org/author/display/AS71/Deployment+Scanner+configuration)配置。您可以将路径更改为任何或您想要的。另一种选择是使用默认的，但为您的其他目录添加一个额外的部署扫描器。

# python - 串行通信 Python 到 Arduino - 无法识别回车

> ID：10505860
> 
> 赞同：3
> 
> 时间：2012-05-08T20:17:32.443
> 
> 标签：python, arduino, pyserial

我正在尝试通过运行 Ubuntu 10.04 的 BeagleBone 和 Arduino 之间的串行通信。到目前为止，我可以发送一个字符串，但是我在识别换行符时遇到了问题。

从 BB 方面，在 Python3 中并使用 PySerial，我已经（仅针对相关位进行了编辑）：

```
import serial
ser = serial.Serial('/dev/ttyACM0', 9600)

ser.write(chr(13).encode('ascii')) # establishes serial connection 
                                   # which will reset Arduino

delay(3000) # give time for reset. This method is from my own library

mesg = 'Beagle\n'
ser.write(mesg.encode('ascii')) 
```

在 Arduino 方面，我有：

```
boolean newMsg = false;
String incomingMsg = "";

void setup()
{
   /* some stuff - not relevant */
   Serial.begin(9600);
}

void loop()
{
    if(newMsg) {
        lcd.print(incomingMsg);
        newMsg = false;
    }
}

void serialEvent()
{
    incomingMsg = "";
    while (Serial.available() > 0) {
        char inByte = Serial.read();
        if (inByte == '\n') {
            newMsg = true;
        } else {
            incomingMsg = incomingMsg + inByte;
        }
    }
} 
```

问题是 newMsg 永远不会被设置为 true，因为它`if (inByte == '\n')`永远不会被验证为 true。我什至尝试在两边都使用'\r'，甚至使用可输入字符（'#'），但这个测试永远不会奏效。不过，字符串“Beagle”可以很好地通过，因此`incomingMsg`可以正常使用。

奇怪的是，我在 Arduino 和 Processing 之间工作（机器人上的 Arduino 通过蓝牙连接到笔记本电脑上的 Processing）。我只是不明白为什么它在这里不起作用。有什么想法吗？

**更新**：我有一个部分答案，并且现在可以使用，尽管我仍然想知道有什么问题。

`if (inByte == '\n')`正在被验证为真实。但是由于某种原因，将 true 分配给全局布尔变量`newMsg`不起作用。尽管在 serialEvent() 中进行了赋值，但它的值在 loop() 中仍然是绝对错误的。然而它是一个全局变量（尽管大多数程序员不喜欢它们，但在 Arduino 中使用得相当多）。我将 loop() 中的测试替换为：

```
if (messageReceived != "") 
```

现在它可以工作了。但我仍然想知道为什么存在这个布尔问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T20:02:17.563

由于 newMsg 在中断驱动函数中被更改，您可能需要将 newMsg 声明为 volatile：

```
volatile boolean newMsg = false; 
```

将通知编译器该值可能会更改，并且不应对其进行优化。

[Arduino易失参考](http://arduino.cc/en/Reference/Volatile)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:25:12.847

如果您使用 Windows，我建议：

我不知道串行，但我知道文件：

```
ser = serial.Serial('/dev/ttyACM0', 9600) # mode = 'w' 
```

应该以阅读文本模式打开文件。然而

```
ser = serial.Serial('/dev/ttyACM0', 9600, 'wb') # may not be correct 
```

应该以读取二进制模式打开文件对象。

看看 open(... mode = ...) 的例子。或者看看你是否在某处找到一个'w'作为选项，你可以用'wb'替换。

我猜在 windows 下 \r 被删除以使文本文件 IO 与 posix 兼容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T20:43:16.187

您缺少一些相关代码。该函数`serialEvent`包含一个循环，在读取**所有**`while`数据之前不会退出，并且不会调用您的函数。**`loop`**

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T23:00:05.590

我在使用 PARITY_ODD/bytesize=serial.SEVENBITS 时遇到了这个问题，因为我将其更改为：

```
ser = serial.Serial(
    port='/dev/ttyUSB0',
    baudrate=9600,
    parity=serial.PARITY_NONE,
    stopbits=serial.STOPBITS_TWO,
    bytesize=serial.EIGHTBITS
) 
```

工作正常。**

# apache - 如何使用 .htaccess 将特定链接重定向到 https:// 其他所有内容到 http://？

> ID：10505862
> 
> 赞同：0
> 
> 时间：2012-05-08T20:17:45.330
> 
> 标签：apache, .htaccess, mod-rewrite, redirect, ssl

我正在尝试使用 htaccess 自动将所有对某些页面的请求定向到 https，将其他所有请求定向到 http://

这是我有代码强制ssl在下面工作的代码

```
RewriteEngine on
RewriteBase /

RewriteCond %{SERVER_PORT} !^443$
RewriteRule ^va-homebuyers-guide https://domain.com/va-homebuyers-guide/ [R=301,L]

RewriteCond %{SERVER_PORT} !^443$
RewriteRule ^va-purchase-request https://domain.com/va-purchase-request/ [R=301,L]

RewriteCond %{SERVER_PORT} !^443$
RewriteRule ^va-streamline-refinance https://domain.com/va-streamline-refinance/ [R=301,L] 
```

这按预期工作并重定向到这些页面的 ssl 版本。然后我尝试添加以下内容以将其他所有内容重定向到 http：

```
RewriteCond %{SERVER_PORT} !^80
RewriteCond %{REQUEST_URI} !^va-homebuyers-guide$
RewriteCond %{REQUEST_URI} !^va-purchase-request$
RewriteCond %{REQUEST_URI} !^va-streamline-refinance$
RewriteRule ^(.*)$ http://domain.com/$1 [R,L] 
```

此代码在转到 /va-purchase-request /va-homebuyers-guide 和 /va-streamline-refinance 时会导致重定向循环，并且根本不会重定向其他页面。

我完全坚持这一点，任何帮助将不胜感激！

编辑：

我在wordpress添加的.htaccess文件中也有这个代码......它会干扰其他重定向吗？

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

# 结束 WordPress

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:50:17.577

将您的 .htaccess 代码替换为：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTPS} off
RewriteRule ^va-(homebuyers-guide|purchase-request|streamline-refinance)(/.*|)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L,NC]

RewriteCond %{HTTPS} on
RewriteRule (?!^va-(homebuyers-guide|purchase-request|streamline-refinance)(/.*|)$)^.*$ http://%{HTTP_HOST}%{REQUEST_URI} [R=301,L,NC] 
```

# android - CheckBox 禁用 Changed 属性的自动更改

> ID：10505864
> 
> 赞同：0
> 
> 时间：2012-05-08T20:18:10.690
> 
> 标签：android, android-layout

我想自定义 CheckBox 的行为。单击它应该调用一个从服务器请求某些东西的方法。一段时间后，当服务器响应回调方法时，应该更新复选框。

如何禁用 Changed 属性的自动更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:29:15.263

创建一个扩展类`CheckBox`。覆盖方法`performClick()`。在这种方法中，你应该从你的服务器请求东西（请异步，不要锁定 UI）。删除调用，`super.performClick()`否则 CheckBox 每次都会被检查。然后在您的服务器请求返回时更新 CheckBox 由您决定。

# asp.net - 从 ASP.NET 的菜单控件中删除一些子项

> ID：10505870
> 
> 赞同：0
> 
> 时间：2012-05-08T20:18:52.253
> 
> 标签：asp.net, menu, submenu

我知道这是一个非常常见的问题。但是，我已经看了一遍，找不到适合我的场景的好答案。我有一个包含子菜单的 MainMenu。我需要从子菜单中删除一些项目，而不是全部。`MainMenu.Items.Remove(e.Item)`我可以通过使用菜单的 Databound 事件轻松地从 MainMenu 中删除项目

以下菜单中的示例如何从 Main2 菜单中删除 sub2。Main1- Main2->sub1,sub2

我的菜单绑定到站点地图。我试过了`e.Item.ChildItems.RemoveAt(0)`，但是`e.Item.ChildItems.Count`Main2 是 0。我不知道如何解决这个问题。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:25:08.083

如果您的菜单绑定到 SiteMap 并且您想删除项目，您不需要制作新地图并绑定到它吗？

# php - 动态加载网站的一部分 - 更改 url

> ID：10505871
> 
> 赞同：3
> 
> 时间：2012-05-08T20:18:53.533
> 
> 标签：php, jquery, html, dynamic, load

我的问题是关于这个网站 - [http://www.bits-apogee.org/2011/](http://www.bits-apogee.org/2011/)

每当您单击侧面导航栏中的链接时，都会动态加载网站的中间部分。此外，网址也发生了变化，其他一切都保持不变。这是怎么做的？

这是一些查询插件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:22:44.547

该站点在 URL 中使用哈希 (#) 来表示正在加载的新内容。

这对于人们为动态加载的内容添加书签（通常散列加载到页面上的特定区域，命名锚点或新浏览器的 ID）很有用，因为它们不会触发页面刷新......

[http://www.highrankings.com/urls-with-hashtags-307](http://www.highrankings.com/urls-with-hashtags-307)对此存在缺点（SEO）问题...但是您会注意到越来越多的网站这样做，因此我认为 SEO 机器人会变得更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:23:31.077

我完全同意@JMCCreative。看起来这是一次真正的刷新。您应该查看 StackOverflow 上的以下帖子。

[在不重新加载页面的情况下修改 URL](https://stackoverflow.com/questions/824349/modify-the-url-without-reloading-the-page)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T20:24:29.330

有2种可能：

*   您可以使用 HTML5 功能来更改 url（历史 pushState），但是该功能尚未在所有浏览器中可用。有关更多信息，请查看此 SO 帖子：[有没有办法在不刷新页面的情况下更改浏览器的地址栏？](https://stackoverflow.com/questions/352343/changing-browsers-address-bar-without-refreshing).
*   对于还没有上述功能的浏览器，您可以使用主题标签 (#) 部分作为后备。

如果你使用 jQuery，你可以使用方便的插件[jQuery Address](http://www.asual.com/jquery/address/)。这将处理上述两种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T01:52:50.197

他们没有使用插件。他们正在向这样的 URL 发出 ajax 请求：http: [//www.bits-apogee.org/2011/getcontent/?](http://www.bits-apogee.org/2011/getcontent/?even=Rachel+Armstrong) even= Rachel+Armstrong 并将概述转储到容器中。

* * *

这类流程的循环通常是这样的：

1.  监听链接点击
2.  点击时，防止默认事件。
3.  用户 window.history.pushState 更新 url
4.  其他一些代码 - 听到新的历史
5.  生成一个 url 来获取内容。
6.  ajax加载url
7.  将数据转储到容器中

* * *

我使用的 2 个库都比上面的更容易，因为它们依赖于通过 AJAX 加载常规 html 页面，而不是您指向的示例站点，该站点使用 JSON 格式来获取数据。

*   [Pjax](https://github.com/defunkt/jquery-pjax) - 通过从不同的 URL 拉出该 HTML 节点来更新页面的部分。
*   [Ajaxify](https://github.com/browserstate/ajaxify) - 最简单的解决方案，您可以在 10 分钟内在 HTML 网站上完成该效果。

# .net - WPF - 具有固定标题/行的 ScrollViewer

> ID：10505875
> 
> 赞同：10
> 
> 时间：2012-05-08T20:19:10.627
> 
> 标签：.net, wpf, user-interface, scrollviewer

什么是创建具有固定标题的 ScrollViewer 的最简单方法（始终保持在顶部忽略滚动的控件），但仍然水平滚动。

我是否应该编写自己的 ScrollViewer 模板，其标题位于 ScrollContentPresenter 上方，并在水平滚动值更改时移动它，或者最好将标题放在 ScrollViewer 中并垂直移动它？或者也许有更好的方法来实现这一点......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:47:47.077

我想你可以通过嵌套scrollviewers来达到你想要的效果。

```
 <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="50" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Border Background="Gray">
                <TextBlock Text="HEader" /> 
            </Border>

            <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">

            </ScrollViewer>
        </Grid>
    </ScrollViewer> 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-05-08T20:44:25.327

您可以通过这种方式禁用垂直滚动条：

```
ScrollViewer.VerticalScrollBarVisibility="Disabled" 
```

# objective-c - 这个方法名称是否表明它是异步的？

> ID：10505882
> 
> 赞同：2
> 
> 时间：2012-05-08T20:20:05.353
> 
> 标签：objective-c, syntax

我已经推断出了 Objective-C 中的很多事情，并且我已经阅读了几个简单地讨论数据类型的教程，但是我没有遇到任何简单地解释语法的东西。

首先，这意味着什么？它的作用是启动一个线程并获取从服务器返回的数据：

```
- (void)apiCall:(void (^)(NSMutableArray *list))block { 
```

该函数头中的某些内容是否告诉我它是异步的？那是什么`block`意思？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T20:24:33.653

1.  不，块并不意味着异步，Obj-C 中的块只是一些可以作为参数传递给方法的代码。
2.  以 - 开头的方法是实例方法，以 + 开头的方法是类方法。
3.  ^ 是表示块的句法标记。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T20:26:03.627

对于您的第一个问题：您必须查看 API 文档以了解它是否是异步的。

有关一般块的更多信息，请参见此处：

[苹果积木编程指南](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/00_Introduction.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T20:33:58.600

让我们从第二个项目符号开始：类方法用 声明`+`，实例方法用 声明`-`。

第一个和第三个是相关的，名为block的参数是一个代码块，它是一段打算稍后运行的代码。鉴于此方法的名称`apiCall`，我建议这是调用完成后运行的方法。

我们很自然地会怀疑这个方法会在另一个线程上做一些工作，然后调用你提供的块，但为此你需要检查文档或代码。

签名：`(void (^)(NSMutableArray* list)) block`描述具有 void 返回类型和`NSMutableArray* list`作为唯一参数的代码块。

块参数的一个示例用法是：

```
void (^apiCallCallback)(NSMutableArray*) = ^(NSMutableArray* list) {
    NSLog(@"The API returned %d items in a list", [list length]);
}

[someApiInstance apiCall:apiCallCallback]; 
```

在 API 实例完成它应该做的任何事情后，您会看到打印了日志语句。

# php - 从 XML 文件中获取最后一个元素

> ID：10505884
> 
> 赞同：0
> 
> 时间：2012-05-08T20:20:19.443
> 
> 标签：php, xml-parsing

我有一个示例 xml 文件，如下所示。我可以有 100 个条目标签，其中包含有关每个条目的信息。我所追求的是最终和之前关闭 xml 结构。

```
<feed xml:base="http://odata.me.com/v1/Catalog/" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices" xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" xmlns="http://www.w3.org/2005/Atom">
<title type="text">Videos</title>
<id>http://odata.me.com/v1/Catalog/Videos</id>  
 <link rel="self" title="Videos" href="Videos" />

 <entry>
    <id>http://odata.me.com/v1/Catalog/Videos('AEAB20400094')</id>
    <title type="text"></title>
    <updated>2012-05-08T19:20:08Z</updated>
    <author>
      <name />
    </author>
    <link rel="edit" title="VideoEf" href="Videos('AEAB20400094')" />
    <link rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/ContentProviderEntity" type="application/atom+xml;type=entry" title="ContentProviderEntity" href="Videos('AEAB20400094')/ContentProviderEntity" />
    <link rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/VideoVersionsCollection" type="application/atom+xml;type=feed" title="VideoVersionsCollection" href="Videos('AEAB20400094')/VideoVersionsCollection" />
    <link rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/VideoBuyLinksCollection" type="application/atom+xml;type=feed" title="VideoBuyLinksCollection" href="Videos('AEAB20400094')/VideoBuyLinksCollection" />
    <link rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/VideoMetadatasCollection" type="application/atom+xml;type=feed" title="VideoMetadatasCollection" href="Videos('AEAB20400094')/VideoMetadatasCollection" />
    <link rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/VideoPoliciesCollection" type="application/atom+xml;type=feed" title="VideoPoliciesCollection" href="Videos('AEAB20400094')/VideoPoliciesCollection" />
    <link rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/GenresCollection" type="application/atom+xml;type=feed" title="GenresCollection" href="Videos('AEAB20400094')/GenresCollection" />
    <category term="Me.Data.EF.Entities.VideoEf" scheme="http://schemas.microsoft.com/ado/2007/08/dataservices/scheme" />
    <content type="application/xml">
      <m:properties>
        <d:Isrc>AEAB20400094</d:Isrc>
        <d:Title>Akhasmak Ah</d:Title>
        <d:ThumbnailFilename>03FE946D8DC4D4E82A1EA56DD9EB89DA.jpg</d:ThumbnailFilename>
        <d:ContentProviderID m:type="Edm.Int32">11</d:ContentProviderID>
        <d:DurationInSeconds m:type="Edm.Int32">17</d:DurationInSeconds>
        <d:CreationDate m:type="Edm.DateTime">2010-10-26T21:57:30.363</d:CreationDate>
        <d:ModifiedDate m:type="Edm.DateTime">2012-05-03T20:56:42.383</d:ModifiedDate>
        <d:StartDate m:type="Edm.DateTime">2009-07-13T00:00:00</d:StartDate>
        <d:EndDate m:type="Edm.DateTime" m:null="true" />
        <d:CopyrightLine>(P) 2002 The copyright in this audiovisual recording is owned by Relax-In/Megastar under exclusive license to EMI Music Arabia</d:CopyrightLine>
        <d:FilteredTitle>Akhasmak Ah</d:FilteredTitle>
        <d:ThumbnailUrl>http://cache.me.com/Content/MeImages/video/03FE946D8DC4D4E82A1EA56DD9EB89DA.jpg</d:ThumbnailUrl>
      </m:properties>
    </content>
</entry>
 <link rel="next" href="http://odata.me.com/v1/Catalog/Videos?$skiptoken='AUBM80800189'" />  
</feed> 
```

有谁知道我怎样才能抓住最后一个元素..我正在寻找href中的值。

哦，我在 PHP5 中这样做

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:31:03.703

Xpath 是你的朋友 :) 类似：

```
//link[@rel='next']/@href 
```

我不确定上面的 xpath 是否完全正确（没有尝试过），但它是这样的。它还基于这样的假设，即您所追求的最后一个链接元素始终具有 rel 属性的值为“下一个”

您需要使用一些 php xpath 库来使用它。一些 PHP 示例代码：

```
$doc = new DOMDocument();
$doc->loadXML($data);
$xp = new DOMXPath($doc);
$xp->registerNamespace('atom', 'http://www.w3.org/2005/Atom');
var_dump($xp->evaluate('string(//atom:link[@rel="next"]/@href)')) ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T09:37:24.083

在这些相同的示例中，标题可以通过

```
$title=$xp->evaluate('string(//atom:content/m:properties/d:Title)'); 
```

# wpf - WPF 高度动画 - 高度方向

> ID：10505887
> 
> 赞同：0
> 
> 时间：2012-05-08T20:20:27.083
> 
> 标签：wpf, pixelsense

我正在为 Microsoft Surface 创建一个应用程序。我有一个使用 rendertransform 旋转 180 度的 WPF 控件，以便另一边的人可以使用它。有两个，一个旋转，一个不旋转。当用户选择控件上的选项卡时，控件会增大以适应选项卡的大小。在未旋转的那个上，高度动画正常工作，向屏幕“顶部”“向上”增长。旋转后的生长方向相同，也朝向顶部，但它需要向相反的方向生长。两者都应该向屏幕中心增长。

设置（它们是地图上的图例）：

```
<SurfaceWindow>
   <Canvas>
      <UserControl />
      <UserControl /> // rotated
      <Map />
   </Canvas>
</SurfaceWindow> 
```

**有没有办法控制高度动画的方向？**

谢谢，安德鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T02:24:53.130

解决了。

使用 LayoutTransform 而不是 RenderTransform

例如

```
Legend2.LayoutTransform = new RotateTransform(180); 
```

代替

```
Legend2.RenderTransform = new RotateTransform(180); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:55:34.697

您不需要两个控件：只需要一个具有“翻转”属性（或在设计时使用它的依赖属性）的控件。当 Flipped 为 True 时，您应该将控件的旋转和 VerticalAlignment 设置为 Top。当为假时，没有旋转和垂直对齐到底部。

# jquery - 单击/使用滚动条时防止滚动顶部（到底部）

> ID：10505889
> 
> 赞同：0
> 
> 时间：2012-05-08T20:20:33.703
> 
> 标签：jquery

我正在聊天，只是为了好玩

加载新消息时，它会滚动到包含所有消息的 div (#chatlist) 的底部。但是当我使用 div 的滚动条（溢出：自动）时，它也会尝试向下滚动。我怎样才能避免这种情况？

我尝试了各种无点击检测方法，到目前为止没有运气

这是我的代码。间隔每隔几秒触发一次：

```
var chatlist = $('#chatlist');

function chatinterval() {
    $.ajax({
        type: "POST",
        url: '/chatinterval.php',
        data: "dbtime=" + latestchat,
        dataType: "json",
        success: function (data) {
            if (data) {
                chatlist.append(data.dbtext);
                latestchat = data.dblatest;
                // this part makes it scroll down
                chatlist.scrollTop(chatlist[0].scrollHeight - chatlist.height());
            }
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:40:44.877

您可以使用`mousedown`和`scroll`事件来控制标志变量（例如`clicked`）。由于`mouseup`在您取消单击滚动条时不会触发，我们可以在每个`scroll`事件上设置超时（在我的示例中为 5 秒），以等待用户手动停止滚动。所以最终的代码应该是这样的：

```
var chatlist = $('#chatlist');

var timer = null;
var clicked = false;

chatlist.on({
    mousedown: function() {
        clicked = true;
    },
    scroll: function() {
        clearTimeout(timer);
        timer = setTimeout(function() {
            clicked = false;
        }, 5000);
    }
});

function chatinterval() {
    $.ajax({
        type: "POST",
        url: '/chatinterval.php',
        data: "dbtime=" + latestchat,
        dataType: "json",
        success: function (data) {
            if (data) {
                chatlist.append(data.dbtext);
                latestchat = data.dblatest;
                // this part makes it scroll down
                if (!clicked) {
                    chatlist.scrollTop(chatlist[0].scrollHeight - chatlist.height());
                }
            }
        }
    });
} 
```

**演示：http:** [//jsfiddle.net/rkUt9/](http://jsfiddle.net/rkUt9/)

# sql - 如何通过比较 ID 和使用 WHERE 子句来使用 INSERT INTO？

> ID：10505893
> 
> 赞同：0
> 
> 时间：2012-05-08T20:20:40.087
> 
> 标签：sql, database, sql-server-2008

**表格1**

```
ID
Position
Other
Other
Name
Description 
```

**表2**

```
ID
Name
Description
LN
Other 
```

我想将所有值`Table2`从`Table1`where`Table1.ID = Table2.ID`和`Table2.LN = 'en'`

以下查询给出错误。制定查询的正确方法是什么？

```
INSERT INTO dbo.Table1(Name, Description)
    SELECT  
        Name, Description 
    FROM
        dbo.Table2
    WHERE
        Table2.ID = Table1.ID 
        AND Table2.LN = 'en' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T20:26:43.233

```
Update table1
set table1.name = table2.name,
    table1.description = table2.description
from
table1  inner join
table2  on table1.id = table2.id
where table2.ln = 'en' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T20:25:03.137

你应该使用 UPDATE 而不是 INSERT

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T20:26:25.513

我认为您需要进行更新而不是插入正弦，您正在映射到表 1 中已经存在的 ID

[这显示了如何创建一个过程来更新多个列](http://social.msdn.microsoft.com/Forums/en-US/transactsql/thread/b9c271f8-11c4-433c-917a-8987216f2ed4/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T20:25:56.163

以下做你想要的。它是您所写内容的一个小变体，仅在 from 子句中包含 Table1：

```
INSERT INTO dbo.Table1(Name,Description)
    SELECT Name, Description
    FROM dbo.Table2 join
         Table1
         on Table2.id = Table1.id
    WHERE Table2.LN = 'en' 
```

对我来说，这个数据布局看起来有点奇怪，因为它在 Table1 中插入了重复的“id”。但是，这确实回答了您的问题。

# email - 从 Redmine 插件发送电子邮件

> ID：10505894
> 
> 赞同：7
> 
> 时间：2012-05-08T20:20:43.017
> 
> 标签：email, redmine, redmine-plugins

我正在写一个Redmine插件。我已经有了模型、视图和控制器。每当有人创建、更新或删除我的模型时，我都想向特定组中的人发送电子邮件。（类似于当有人创建或更新问题时由 Redmine 发送的电子邮件）有人可以告诉我什么是最好的解决方法吗？谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-10-23T17:02:56.857

我知道你问已经 2 年了，但我遇到了同样的问题，我想出了如何用我的插件发送电子邮件。

对于名为 my_plugin 的插件，您需要做的是：

## 1\. 创建一个继承自 Mailer 的模型。

因此，如果我想要一个名为 MyPluginMailer 的邮件程序：

*   我创建 redmine_folder/plugins/my_plugin/app/models/my_plugin_mailer.rb
*   我创建了继承自 redmine Mailer 的 MyPluginMailer 类

像那样：

```
class MyPluginMailer < Mailer
end 
```

## 2\. 创建一个调用邮件程序的方法。

假设我正在为 redmine 编写一个新闻插件。我想发送一封电子邮件，总结我提交的文章，这样用户就不必在每次想知道是否有新内容时都轮询插件。

我在邮件程序类中创建了一个方法：

```
class MyPluginMailer < Mailer
  def on_new_article(user_to_warn, article)
    mail to: user_to_warn.email, subject: "New article: #{article.title}"
    @article = article #So that @article will be available in the views.
  end
end 
```

例如，您可以在您的 Article 类中的 after_create 回调中调用此方法。

## 3\. 为方法创建一些视图。

我**必须**创建 2 个不同的文件：

1.  my_method.html.erb
2.  my_method.text.erb

否则 redmine 将因“找不到模板”异常而崩溃。

所以在我的 redmine_folder/plugins/my_plugin/app/views/my_plugin_mailer/ 我创建

1.  on_new_article.html.erb
2.  on_new_article.text.erb

在我的 on_new_article.html.erb 中，我写了如下内容：

```
<h1><%= @article.title %></h1>
<p><%= @article.summary %></p> 
```

# iphone - 故事板segue交叉溶解？

> ID：10505897
> 
> 赞同：0
> 
> 时间：2012-05-08T20:20:58.130
> 
> 标签：iphone, ios, xcode, ipad

**我想使用以下过渡交叉溶解，但我不希望它在过渡时出现闪烁**

我很抱歉我的英语不好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:46:08.293

您需要在项目中添加一个子类：

*   添加一个新的 .h 和 .m 文件作为 UIStoryboardSegue 的子类
*   将此代码添加到您的 .m 文件中：

`- (void)perform { [self.sourceViewController presentModalViewController:self.destinationViewController animated:NO]; }`

*   现在转到您的 .storyboard 并将您的 .m 文件的名称添加到您喜欢的 segue 的类字段中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T01:37:13.907

我在 XCode 4.4.1 中找不到故事板的 segue 类字段。该字段是否可能在以前的版本中但不在当前版本中？

编辑：我找到了方法。创建 segue 时必须选择“自定义”，它可以工作。谢谢。

顺便说一句：该教程不可用。

# cakephp - CakePHP 2.1 HABTM 未获得相关信息

> ID：10505900
> 
> 赞同：0
> 
> 时间：2012-05-08T20:21:16.170
> 
> 标签：cakephp

有个问题困扰了我一下午：

我正在制作一个吉他装备网站，所以我使用的是装备物品表、用户表和装备到用户的桥接表。也就是说，一个用户可以拥有多个项目并且项目可以属于多个用户。所以**HABTM**。

一个项目属于一个品牌（例如 Fender - Stratocaster），所以我在项目模型中设置了**belongsTo**关系，并在品牌模型中设置了**HasMany关系。**当我检查项目控制器中的输出时，齿轮及其相关品牌的数据都应有尽有。

用户控制面板（和类似区域）基本上列出了用户拥有的所有项目。设置好用户和物品之间的**HABTM**关系后，我检查了控制器的输出。虽然物品的信息和桥牌信息都出现了，但物品的关联品牌信息却没有。结果本质上应该是一个项目列表，包括品牌信息，就好像它是“where user_id = x”。相反，它似乎只获取项目信息而没有获取任何关系。

我有什么遗漏或愚蠢的错误吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:46:49.403

您是否考虑在对用户执行时设置/更改`recursive`属性`find()`？
设置得越高`recursive`，就会发现越深的关联。

另一种方法可能是`Containable`对用户使用行为：

```
$this->User->find('first',array(
    'conditions'=>array('User.id'=>1),  
    'contain' => array('Item'=>array('Brand'))
)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:43:58.830

设置递归级别，或者您可以使用 ContainableBehavior

# html - 寻求vim函数在超链接后面插入文本

> ID：10505904
> 
> 赞同：1
> 
> 时间：2012-05-08T20:21:44.950
> 
> 标签：html, vim, wget

我正在写一本书。我有一个很大的注释文件，带有感兴趣的超链接。我希望能够将光标移动到超链接上，执行命令，并插入网页文本以供阅读、剪切和修改。理想情况下，它只是可读的文本而不是完整的 HTML，但我会采取我能得到的（或者我能得到的，如果这是正确的 shell 函数）。

当然这样的东西已经放在一起了，但是搜索“vim insert text hyperlink”之类的不是很有帮助。你见过这个功能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T21:00:29.640

将光标移动到炒作链接，然后键入以下命令：

```
:exec 'r!wget -q -O- ' getline('.') ' | html2text' 
```

它将在炒作链接之后附加炒作链接的内容。
要使此命令起作用，您需要 install `html2text`。
祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T22:40:42.780

将鼠标光标放在超链接上，执行

> `:r``C-r``C-a``Enter`

这将在下一行插入原始内容。预处理：

> `:r !links -dump``C-r``C-a``Enter`

当然，您可以将其映射到一个键：

```
:nnoremap <F6> :r !links -dump <C-r><C-a><CR> 
```

* * *

### 各种注释：

如果您引用了网址，您可能会不高兴，`C-r``C-a`因为引号将被包含在内。考虑做

```
:se iskeyword+=/,:,. 
```

并`C-r``C-w`改为使用。或者，

```
:se isfname-=" 
```

允许您改为使用`C-r``C-f`。

如果您不想修改任何设置，请考虑创建一个函数来保存和恢复`&iskeyword`or的值`&isfname`。要拿出大枪，请为 URL 编写一个正则表达式并使用它：

```
func! ReadFromUrl()
    let url = substitute(getline('.'), '\c\v^.*((https?|ftp|file)://[a-z0-9.:/%+()]+).*$', '\1', '')
    exec 'r! links -dump "' . url . '"'
endf

command! ReadFromUrl call ReadFromUrl()
nnoremap! <F6> ReadFromUrl<CR> 
```

# php - PHP fgetcsv 错误 - 我该如何安排？

> ID：10505905
> 
> 赞同：0
> 
> 时间：2012-05-08T20:21:45.383
> 
> 标签：php

我收到以下错误：

“注意：fgetcsv() [function.fgetcsv]：分隔符必须是单个字符”在我的浏览器中

我的 PHP 代码如下 - 有人可以重新排列吗？

```
$fh = fopen('notes.txt', 'r') or die('Unable to open notes.txt');
while(($line = fgetcsv($fh, 0, '||')) !== FALSE)
   if ($line[0] == $name) {
       echo <<<EOL

My color is $line[2]
EOL;
       break; // if there's only ever one '5678' line in the, get out now.
   }

fclose($fh); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:25:48.773

从[fgetcsv](http://php.net/manual/en/function.fgetcsv.php)文档中，您的分隔符只能是一个字符的长度。以供将来参考，尽管在询问与能够查看数据（或数据样本）的文件有关的问题时非常宝贵

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:48:34.000

简而言之，您使用的是两个字符“||” 当你只能一个像逗号“，”。[阅读文档。](http://php.net/manual/en/function.fgetcsv.php)

# c++ - 如何将字符串转换为 char *agv[]

> ID：10505909
> 
> 赞同：-1
> 
> 时间：2012-05-08T20:22:17.043
> 
> 标签：c++, arrays, string, char

我正在构建一个命令行工具，一开始整行是一个字符串。我怎么能转换：

```
 string text = "-f input.gmn -output.jpg"; 
```

进入

```
 const char *argv[] = { "ProgramNameHere", "-f", "input.gmn", "-output.jpg" }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:41:08.053

如果我必须使用`getopt`，并且我知道我是以空格分隔的 开头`std::string`，我会这样做：

```
#include <iostream>
#include <string>
#include <sstream>
#include <algorithm>
#include <iterator>
#include <vector>
#include <cassert>
#include <cstring>

int main() {

    https://stackoverflow.com/questions/236129/how-to-split-a-string-in-c

    // My input
    std::string sentence = "-f input.gmn -output.jpg";

    // My input as a stream
    std::istringstream iss(sentence);

    // Create first entry
    std::vector<std::string> tokens;
    tokens.push_back("ProgramNameHere");

    // Split my input and put the result in the rest of the vector
    std::copy(std::istream_iterator<std::string>(iss),
        std::istream_iterator<std::string>(),
        std::back_inserter(tokens));

    // Now we have vector<string>, but we need array of char*. Convert to char*
    std::vector<char *> ptokens;
    for(auto& s : tokens)
        ptokens.push_back(&s[0]);

    // Now we have vector<char*>, but we need array of char*. Grab array
    char **argv = &ptokens[0];
    int argc = ptokens.size();

    // Use argc and argv as desired. Note that they will become invalid when
    // *either* of the previous vectors goes out of scope.
    assert(strcmp(argv[2], "input.gmn") == 0);
    assert(argc == 4);

} 
```

另请参阅：[在 C++ 中拆分字符串？](https://stackoverflow.com/questions/236129/how-to-split-a-string-in-c)

* * *

*后记*：在我提供的解决方案中，我使用了 C++2011 中引入的两种语言特性：[基于范围的 for 循环](http://en.wikipedia.org/wiki/C%2B%2B11#Range-based_for-loop)和[类型推断](http://en.wikipedia.org/wiki/C%2B%2B11#Type_inference)。

仅当您的编译器支持以下新功能时，此代码片段才会编译：

```
 for(auto& s : tokens)
        ptokens.push_back(&s[0]); 
```

如果您有较旧的 C++ 编译器，则可能需要使用 C++2003 功能重写它：

```
 for(std::vector<string>::iterator it = tokens.begin(); it != tokens.end(); ++it)
        ptokens.push_back(it->c_str()); 
```

或者

```
 for(std::vector<string>::size_type i = 0; i < tokens.size(); ++i)
        ptokens.push_back(tokens[i].c_str()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:26:01.097

我建议使用 boost::program_options 来解析程序的参数。

否则，如果您使用 MSVC，您可能需要使用内置的 __argc 和 __argv。

没有可移植的方法来获取程序的图像名称，因此如果您首先通过丢弃原始 argv 参数将其丢弃，则无法从任何地方获取该信息。

~~您可以使用 C strtok 函数来拆分您的参数~~……实际上，只需将 boost::algorithm::split 与 any_of(' ') 一起使用即可。

# jquery - JQuery 插件平滑 Div 滚动的分步教程

> ID：10505913
> 
> 赞同：0
> 
> 时间：2012-05-08T20:22:47.930
> 
> 标签：jquery, wordpress, smooth-scrolling

我知道 JQuery 并且正在寻找[Smooth Div Scroll](http://www.smoothdivscroll.com/)的分步教程。我有兴趣将此功能添加到 Wordpress 中的页面。

这些是我理解的步骤：

(1) 在标题中添加以下脚本：

```
<script type="text/javascript">
$(function() {
$("div#makeMeScrollable").smoothDivScroll();
});
</script> 
```

(2) 将 css 添加到主样式表。

(3) 在页面中添加代码

```
<div id="makeMeScrollable">
<div class="scrollingHotSpotLeft"></div>
<div class="scrollingHotSpotRight"></div>
<div class="scrollWrapper">
<div class="scrollableArea">
<img src="images/demo/image_1.jpg" width="400" height="200" />
<img src="images/demo/image_2.jpg" width="350" height="200" />
<img src="images/demo/image_3.jpg" width="545" height="200" />
<img src="images/demo/image_4.jpg" width="400" height="200" />
<img src="images/demo/image_5.jpg" width="600" height="200" />
</div>
</div>
</div> 
```

这个对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:43:12.180

嗨，这就是我让它工作的方式！

**就在我添加的“头”标签内**

```
 <style type="text/css">
      #makeMeScrollable
    {
        width:100%;
        height: 330px;
        position: relative;
    }

     #makeMeScrollable div.scrollableArea img
    {
        position: relative;
        float: left;
        margin: 0;
        padding: 0;
        /* If you don't want the images in the scroller to be selectable, try the following
           block of code. It's just a nice feature that prevent the images from
           accidentally becoming selected/inverted when the user interacts with the scroller. */
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -o-user-select: none;
        user-select: none;
    }
</style> 
```

**其次，我将此添加到页面！**

```
<!-- LOAD JAVASCRIPT LATE - JUST BEFORE THE BODY TAG 
     That way the browser will have loaded the images
     and will know the width of the images. No need to
     specify the width in the CSS or inline. -->

<!-- jQuery library - Please load it from Google API's -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

<!-- jQuery UI Widget and Effects Core (custom download)
     You can make your own at: http://jqueryui.com/download -->
<script src="js/jquery-ui-1.8.18.custom.min.js" type="text/javascript"></script>

<!-- Latest version of jQuery Mouse Wheel by Brandon Aaron
     You will find it here: http://brandonaaron.net/code/mousewheel/demos -->
<script src="js/jquery.mousewheel.min.js" type="text/javascript"></script>

<!-- Smooth Div Scroll 1.2 minified-->
<script src="js/jquery.smoothdivscroll-1.2-min.js" type="text/javascript"></script>

<!-- If you want to look at the uncompressed version you find it at
     js/jquery.smoothDivScroll-1.2.js -->

<!-- Plugin initialization -->
<script type="text/javascript">
    // Initialize the plugin with no custom options
    $(document).ready(function () {
        // None of the options are set
        $("div#makeMeScrollable").smoothDivScroll({});
    });
</script> 
```

我设置的选项是覆盖默认值！

然后我去我的CSS并添加这个

```
 /* Invisible left hotspot */
    div.scrollingHotSpotLeft
    {
/* The hotspots have a minimum width of 100 pixels and if there is room the will grow
    and occupy 15% of the scrollable area (30% combined). Adjust it to your own taste. */
min-width: 75px;
width: 10%;
height: 100%;
/* There is a big background image and it's used to solve some problems I experienced
in Internet Explorer 6\. */
background-image: url(../images/big_transparent.gif);
background-repeat: repeat;
background-position: center center;
position: absolute;
z-index: 200;
left: 0;
/*  The first url is for Firefox and other browsers, the second is for Internet Explorer */
cursor: url(../images/cursors/cursor_arrow_left.png), url(../images/cursors/cursor_arrow_left.cur),w-resize;
   }

  /* Visible left hotspot */
  div.scrollingHotSpotLeftVisible
   {
background-image: url(../images/arrow_left.gif);                
background-color: #fff;
background-repeat: no-repeat;
opacity: 0.35; /* Standard CSS3 opacity setting */
-moz-opacity: 0.35; /* Opacity for really old versions of Mozilla Firefox (0.9 or older) */
filter: alpha(opacity = 35); /* Opacity for Internet Explorer. */
zoom: 1; /* Trigger "hasLayout" in Internet Explorer 6 or older versions */
    }

   /* Invisible right hotspot */
   div.scrollingHotSpotRight
 {
min-width: 75px;
width: 10%;
height: 100%;
background-image: url(../images/big_transparent.gif);
background-repeat: repeat;
background-position: center center;
position: absolute;
z-index: 200;
right: 0;
cursor: url(../images/cursors/cursor_arrow_right.png), url(../images/cursors/cursor_arrow_right.cur),e-resize;
    }

    /* Visible right hotspot */
    div.scrollingHotSpotRightVisible
    {
background-image: url(../images/arrow_right.gif);
background-color: #fff;
background-repeat: no-repeat;
opacity: 0.35;
filter: alpha(opacity = 35);
-moz-opacity: 0.35;
zoom: 1;
    }

     /* The scroll wrapper is always the same width and height as the containing element (div).
   Overflow is hidden because you don't want to show all of the scrollable area.
   */
   div.scrollWrapper
   {
position: relative;
overflow: hidden;
width: 100%;
height: 100%;
   }

   div.scrollableArea
   {
position: relative;
width: auto;
height: 100%;
   } 
```

最后我在 javscript 上添加了这个，但是在 head 标签下

```
<div id="makeMeScrollable">
    <img src="images/demo/field.jpg" alt="Demo image" id="field" />
    <img src="images/demo/gnome.jpg" alt="Demo image" id="gnome" />
    <img src="images/demo/pencils.jpg" alt="Demo image" id="pencils" />
    <img src="images/demo/golf.jpg" alt="Demo image" id="golf" />
    <img src="images/demo/river.jpg" alt="Demo image" id="river" />
    <img src="images/demo/train.jpg" alt="Demo image" id="train" />
    <img src="images/demo/leaf.jpg" alt="Demo image" id="leaf" />
    <img src="images/demo/dog.jpg" alt="Demo image" id="dog" />
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:29:35.160

从 jquery 平滑页面放在 head 标签内

```
<script type="text/javascript">
    $(document).ready(function() {
        $("#makeMeScrollable").smoothDivScroll({ 
            mousewheelScrolling: true,
            manualContinuousScrolling: true,
            visibleHotSpotBackgrounds: "always",
            autoScrollingMode: "onstart"
        });
    });
</script> 
```

在你想展示这些图像的地方

```
<div id="makeMeScrollable">
        <img src="images/demo/field.jpg" alt="Demo image" id="field" />
        <img src="images/demo/gnome.jpg" alt="Demo image" id="gnome" />
        <img src="images/demo/pencils.jpg" alt="Demo image" id="pencils" />
        <img src="images/demo/golf.jpg" alt="Demo image" id="golf" />
        <img src="images/demo/river.jpg" alt="Demo image" id="river" />
        <img src="images/demo/train.jpg" alt="Demo image" id="train" />
        <img src="images/demo/leaf.jpg" alt="Demo image" id="leaf" />
        <img src="images/demo/dog.jpg" alt="Demo image" id="dog" />
</div> 
```

# node.js - 使用 URL 重写从 iisnode 提供静态文件

> ID：10505918
> 
> 赞同：2
> 
> 时间：2012-05-08T20:23:00.227
> 
> 标签：node.js, iis-7, iisnode

我在我的 web.config 文件中使用重写规则，以便在 issnode 下运行的节点应用程序指向我的 server.js 文件。myapp/* 指向 server.js。

```
 <rule name="myapp" enabled="true">
      <match url="myapp/*" />
      <action type="Rewrite" url="server.js" />
    </rule> 
```

这一直很好 www.mywebsite.com/myapp/ 会加载运行我的应用程序。我想要的是从网站的根目录进行重定向，以便 www.mywebsite.com/ 运行我的应用程序。所以我改变了我的 web.config 文件

```
 <rule name="myapp" enabled="true">
      <match url="/*" />
      <action type="Rewrite" url="server.js" />
    </rule> 
```

所以这是运行 server.js 并提供我的静态 html 文件，唯一的问题是从我的 html 文件（css、js、图像等）中引用任何外部文件，每个请求只需 500 秒。我正在使用它来提供静态文件

```
 var libpath = require('path');
        var _path = "."; <-- This seems to be the problem

        var uri = url.parse(req.url).pathname;
    var filename = libpath.join(_path, uri);
    fs.readFile(filename, "binary", function (err, file) {
            if (err) {
            res.writeHead(500, {
                "Content-Type": "text/plain"
            });
                 res.write(err + "\n");
                 res.end();
                return;
            }

         var type = mime.lookup(filename);
            res.writeHead(200, {
                "Content-Type": type
            });
         res.write(file, "binary");
         res.end();
        });

    break; 
```

所以我的问题是如何指向我的节点应用程序/服务器的根目录来提供静态文件。

谢谢

城野

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T17:57:34.060

在 iisnode 中提供静态内容的最佳方式是配置 URL 重写模块，以便 IIS 静态文件处理程序处理对静态内容的请求，而不是 node.js。与使用任何 node.js 机制为这些文件提供服务相比，让 IIS 服务静态内容具有很大的性能优势，因为围绕缓存进行了内核级优化，并且不必中断 JavaScript 代码。

有关实现此目的的样板 web.config 配置，请参阅[https://github.com/tjanczuk/iisnode/issues/160#issuecomment-5606547](https://github.com/tjanczuk/iisnode/issues/160#issuecomment-5606547)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-08-18T21:15:42.093

我在使用建议的规则配置时遇到了一些问题，所以我做了一些更改：

```
<system.webServer>
  <handlers>
    <clear />
    <add name="iisnode" path="/index.js" verb="*" modules="iisnode" />
    <add name="StaticFile" path="*" verb="*" modules="StaticFileModule,DefaultDocumentModule,DirectoryListingModule" resourceType="Either" requireAccess="Read" />
  </handlers>
  <rewrite>
    <rules>
      <rule name="static">
        <action type="Rewrite" url="www{REQUEST_URI}" />
      </rule>
      <rule name="serve-static" stopProcessing="true">
        <conditions logicalGrouping="MatchAny">
          <add input="{REQUEST_FILENAME}" matchType="IsFile" />
          <add input="{REQUEST_URI}" pattern="^/www/$" />
        </conditions>
      </rule>
      <rule name="node">
        <action type="Rewrite" url="index.js" />
      </rule>
    </rules>
  </rewrite>
</system.webServer> 
```

*   第一条规则为所有请求添加前缀`www`，我的客户端目录。
*   如果文件存在或请求根路径，则第二条规则停止处理
*   第三条规则将其他任何内容重写为我的后端节点脚本的名称，以便 iisnode 处理程序可以获取它。

请注意，iisnode 处理程序路径设置为`/index.js`似乎消除了与同名客户端文件的冲突。

# php - 使用 json_decode 解码条带 json 不起作用

> ID：10505929
> 
> 赞同：1
> 
> 时间：2012-05-08T20:23:52.690
> 
> 标签：php, stripe-payments

我有来自条纹的 json，我正在尝试将它解码为 json_decode。

我没有收到错误。只是什么都没有回来。我正在从条带中取回数据，但我无法对其进行解码。

```
{
   "created":1326853478,
   "data":{
      "object":{
         "amount":4500,
         "card":{
            "country":"US",
            "cvc_check":"pass",
            "exp_month":7,
            "exp_year":2014,
            "fingerprint":"9aQtfsI8a17zjEZd",
            "id":"cc_00000000000000",
            "last4":"9782",
            "object":"card",
            "type":"Visa"
         },
         "created":1322700852,
         "currency":"usd",
         "disputed":false,
         "fee":0,
         "id":"ch_00000000000000",
         "livemode":false,
         "object":"charge",
         "paid":true,
         "refunded":true
      }
   },
   "id":"evt_00000000000000",
   "livemode":false,
   "type":"charge.refunded"
} 
```

* * *

```
// retrieve the request's body and parse it as JSON
$body = @file_get_contents('php://input');

$event_json = json_decode($body,true);
print_r($event_json); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:53:37.120

在这里，我运行了这个：

```
<?php
     $data = '{ "created": 1326853478, "data": { "object": { "amount": 4500, "card": { "country": "US", "cvc_check": "pass", "exp_month": 7, "exp_year": 2014, "fingerprint": "9aQtfsI8a17zjEZd", "id": "cc_00000000000000", "last4": "9782", "object": "card", "type": "Visa" }, "created": 1322700852, "currency": "usd", "disputed": false, "fee": 0, "id": "ch_00000000000000", "livemode": false, "object": "charge", "paid": true, "refunded": true } }, "id": "evt_00000000000000", "livemode": false, "type": "charge.refunded" }';

    $arr = json_decode($data, true);

    print_r($arr);

?> 
```

它奏效了。所以，理论上你应该能够使用：

```
<?php

    $arr = json_decode(file_get_contents('php://input'), true);

    print_r($arr);

?> 
```

正如 Ignacio Vazquez-Abrams 所说，不要使用“@”字符，因为它会掩盖错误消息并使其更难调试。

我还会检查您拥有的 PHP 版本。json_decode() 仅适用于 5.2.0 及更高版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:56:42.043

该`php://input`流允许您从请求正文中读取原始数据。该数据将是一个字符串，根据请求中的值类型，将类似于：

```
"name=ok&submit=submit" 
```

这**不是**JSON，因此不会以您期望的方式解码为 JSON 。如果无法解码，该`json_decode()`函数将返回*null*。

您从哪里获得上面发布的 JSON？这是您需要传递给`json_decode()`.

如果 JSON 在请求中传递，就像在回调实例中一样，您仍然需要解析该部分以仅获取 JSON。如果`php://input`流给你**name=ok&submit=submit&json={"created": 1326853478}**那么你必须把它解析出来。您可以使用PHP 手册中的[此函数](http://www.php.net/manual/en/language.variables.external.php#94607)来分隔值以像`$_POST`数组一样工作：

```
<?php
   // Function to fix up PHP's messing up POST input containing dots, etc.
   function getRealPOST() {
      $pairs = explode("&", file_get_contents("php://input"));
      $vars = array();
      foreach ($pairs as $pair) {
         $nv = explode("=", $pair);
         $name = urldecode($nv[0]);
         $value = urldecode($nv[1]);
         $vars[$name] = $value;
      }
      return $vars;
   }
?> 
```

要使用它：

```
$post = getRealPOST();
$stripe_json = $post['json'];
$event_json = json_decode($stripe_json); 
```

# git - 通过 http 克隆时缺少 Git 远程分支，但在远程机器中本地克隆时可用

> ID：10505934
> 
> 赞同：4
> 
> 时间：2012-05-08T20:24:13.683
> 
> 标签：git, branch, git-branch, git-remote

我被困了很长时间。我很确定这是从 svn 迁移时出现的错误。

在裸仓库所在的服务器中：

```
$ git clone /var/git/queryj.git
$ cd queryj
$ git branch -r

origin/HEAD -> origin/remotes/trunk
origin/br-0_6--ventura24-2_0-5
origin/master
origin/remotes/br-0_6--ventura24-1_0
origin/remotes/br-0_6--ventura24-1_9-stable
origin/remotes/br-0_6--ventura24-1_9-synchr
origin/remotes/br-0_6--ventura24-2_0
origin/remotes/br-0_6--ventura24-2_0-0 
```

通过 https 克隆存储库时，我得到不同的结果：

```
$ git clone https://git.acm-sl.org/queryj.git
$ cd queryj
$ git branch -r

origin/HEAD -> origin/remotes/trunk
origin/br-0_6--ventura24-2_0-5
origin/remotes/trunk
origin/ventura24-2_0-stable 
```

知道如何在通过 https 克隆时使丢失的分支可用吗？它是通过 webdav 导出的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T10:02:52.817

A默认`git clone`不会为所有[远程跟踪分支创建本地分支。](https://stackoverflow.com/questions/4693588/git-what-is-a-tracking-branch/4697054#4697054)

**[`git for-each-ref`](http://git-scm.com/docs/git-for-each-ref)**列出 Git 对象时不要忘记。该**`--format`**选项实际上**可以是一个完整的脚本**。

例如，使用上游分支创建本地分支（**尚不存在**的本地分支）到给定的远程（也使用“[是否有更好的方法来确定本地 git 分支是否存在？](https://stackoverflow.com/q/5167957/6309) ”）：

```
#!/bin/bash

aremote=$1
fmt='r=%(refname); T=$(r#refs/remotes/$aremote/}
if [[ "$T" != HEAD ]]; then
  git show-ref --verify --quiet refs/heads/$T
  res=$?
  if [[ "$res" != "0" ]] ; then git branch --set-upstream $T $aremote/$T ; fi
fi
'
e=`git for-each-ref --shell --format="$fmt" refs/remotes/$aremote`
eval "e" 
```

您将使用该脚本与您的远程名称作为参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T12:15:23.693

通过 HTTP 克隆（不使用智能服务器）使用从存储库的其余部分生成的一些额外元数据。此元数据需要手动更新，您可以通过运行`git update-server-info`.

# java - JUnit 测试、休眠和未知实体错误

> ID：10505939
> 
> 赞同：1
> 
> 时间：2012-05-08T20:24:31.800
> 
> 标签：java, hibernate, junit

我正在尝试使用 Hibernate 来坚持一个非常简单的类。我**没有**使用 Spring，我**没有**使用映射文件，只是**简单的注释**。我**正在**使用`javax.persistence.Entity`而不是`org.hibernate.Entity`. 尽管如此，当运行 JUnit 测试（位于与类不同的包中，一个测试包中）时，我得到`testAddUser caused an ERROR: Unknown entity: restauracja.PersonalInfo`.

我究竟做错了什么？

**更新：**这就是我初始化会话工厂的方式：

```
private final static SessionFactory factory;
static {
    Configuration cfg = new AnnotationConfiguration().configure("hibernate.cfg.xml");
    factory = cfg.buildSessionFactory();
} 
```

并运行测试：

```
@Test
public void testAddUser() {
    Session session = factory.openSession();
    Transaction tx = session.beginTransaction();

    PersonalInfo pi = new PersonalInfo("Jan", "Kowalski", "Krótka 6a", "Gniezno", 123456l);

    session.saveOrUpdate(pi);
    tx.commit();
    session.close();

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T20:51:03.967

Hibernate 通常有一个类的集合，它知道并调查了注解。我怀疑您需要将您的`restauracja.PersonalInfo`课程添加到该集合中。例如，在我们的测试工具中，我们执行以下操作：

```
AnnotationConfiguration cfg = new AnnotationConfiguration();
for (Class<?> clazz : databaseConfig.getHibernateClasses()) {
    cfg.addAnnotatedClass(clazz);
} 
```

特定单元测试使用的每个类都需要指定测试所需的所有类`hibernate`必须在该列表中。我怀疑类列表可能在`hibernate.cfg.xml`文件中，您只需将缺少的类添加到该列表中。

# cakephp - unload() CakePHP 上传插件似乎不起作用

> ID：10505942
> 
> 赞同：0
> 
> 时间：2012-05-08T20:24:44.843
> 
> 标签：cakephp, model, cakephp-2.0, uploader

我正在使用 CakePHP 2.1.1 和 Miles Johnson 的[Uploader Plugin](http://milesj.me/code/cakephp/uploader) v 3.5。
虽然我认为我在尝试卸载 FileValidation 行为时遇到了问题，但它工作得非常好。

我已经设置了行为`Uploader.Attachment`和`Uploader.FileValidator`（见问题的底部）。
在`afterSave`回调中，我现在需要`Post`再次保存，以便为不同的语言环境添加翻译字段。

当我再次保存时，这似乎会导致`FileValidation`行为错误。我得到错误：
`failed to open stream: No such file or directory [APP/Plugin/Uploader/Model/Behavior/FileValidationBehavior.php, line 296]`
不知何故，行为正在再次寻找 tmp 文件。
当我根本不定义`FileValidation`行为时，一切顺利。所以我想在常规期间完成它的工作后禁用该行为`save()`，就在我第二次去之前`save()`。
因此在`afterSave($created)`我声明

```
$this->Behaviors->unload('FileValidation');
$this->save($data); 
```

错误消失了，但我收到 4 个警告作为回报：

```
Warning (512): Could not find validation handler maxWidth for file [CORE/Cake/Model/Model.php, line 3155]  
Warning (512): Could not find validation handler maxHeight for file [CORE/Cake/Model/Model.php, line 3155]
Warning (512): Could not find validation handler filesize for file [CORE/Cake/Model/Model.php, line 3155]
Warning (512): Could not find validation handler required for file [CORE/Cake/Model/Model.php, line 3155] 
```

我也尝试过`$this->Behaviors->disable('FileValidation')`，但无济于事。这是行为中的错误（未正确卸载本身）还是我没有正确处理卸载？

亲切的问候，巴特

行为设置：

```
public $actsAs = array('Uploader.Attachment' => array(
        'file' => array(
            'name'      => 'uniqueFilename',    // Name of the function to use to format filenames
            'baseDir'   => APP,         // See UploaderComponent::$baseDir
            'uploadDir' => 'webroot/img/upload/',           // See UploaderComponent::$uploadDir
            'dbColumn'  => 'uploadPath',    // The database column name to save the path to
            'importFrom'    => '',          // Path or URL to import file
            'defaultPath'   => '',          // Default file path if no upload present
            'maxNameLength' => 30,          // Max file name length
            'overwrite' => false,       // Overwrite file with same name if it exists
            'stopSave'  => true,        // Stop the model save() if upload fails
            'transforms'    => array(),     // What transformations to do on images: scale, resize, etc
            's3'        => array(),     // Array of Amazon S3 settings
            'metaColumns'   => array(       // Mapping of meta data to database fields
                'ext' => 'ext',
                'type' => 'type',
                'size' => 'size',
                'group' => 'group',
                'width' => 'width',
                'height' => 'height',
                'filesize' => 'size',
                'name'=>'name'
            )
        )
    ),
    'Uploader.FileValidation' => array(
        'file' => array(
            'maxWidth' => array(
                'value' => 1000,
                'error' => 'Image too wide. Max 1000px'
            ),
            'maxHeight' => array(
                'value' => 1000,
                'error' => 'Image too high. Max 1000px'
            ),
            'extension' => array(
                'value' => array('gif', 'jpg', 'png', 'jpeg'),
                'error' => 'Mimetype incorrect',
            ),
            'filesize' => array(
                'value' => 1048576,
                'error' => 'Filesize too high. Max 1 MB'
            )
        )
    )
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T22:18:55.057

没有直接关系，但你想尝试另一个文件上传插件吗？这个可能会成功：http: [//bakery.cakephp.org/articles/srs2012/2012/03/12/ajaxmultiupload_plugin_for_cake_2_0_x_and_2_1](http://bakery.cakephp.org/articles/srs2012/2012/03/12/ajaxmultiupload_plugin_for_cake_2_0_x_and_2_1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:48:41.197

不确定这是否会解决您的问题，但我发现（由于某种原因我不知道为什么）如果您没有在 Config/core.php 中将调试设置为 0，则会引发此错误

# php - 生成元描述时的神秘换行符

> ID：10505948
> 
> 赞同：1
> 
> 时间：2012-05-08T20:25:18.610
> 
> 标签：php

我有这个功能，它可以**将一个字符串切割成多个字符，而不会切掉任何单词**。我将它用于**页面的 meta_description**。

```
function meta_description_function($text, $length){ // Meta Description Function
        if(strlen($text) > $length) {
            $text = substr($text, 0, strpos($text, ' ', $length));
        }
        return $text;
    } 
```

我从 wordpress 帖子中提取内容：

```
$content = $content_post->post_content; 
```

我从内容中剥离标签：

```
$content = strip_tags($content); 
```

我将我的功能应用于内容：

```
$meta_description = meta_description_function($content, 140); 
```

**问题是当 $content 是这样的时候：**

```
<p>Hello I am sentence one inside my own paragraph.</p>

<p>Hello I am sentence two inside my own paragraph.</p> 
```

**应用内容并回显 $meta_description 后，我得到了不同行的句子，如下所示：**

```
<meta name="description" content="Hello I am sentence one inside my own paragraph.
**<i get a space here!>**
Hello I am sentence two inside my own paragraph." /> 
```

如果我使用了条形标签，为什么会出现这个空白空间，我该怎么做才能让它消失？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:29:24.717

修剪空白，并删除换行符。然后剥离标签。**都在一条线上！**

`$content = trim( preg_replace( '/\s+/', ' ', strip_tags($content) ) );` **注意：** \s 处理的情况不仅仅是换行符和空格..还有制表符和换页符等。

[演示](http://www.tehplayground.com/#M1z2XguEs)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T20:31:34.680

您得到换行符是因为您的 HTML 中也有换行符。`striptags`将删除所有标签，但不会删除换行符。

要删除它们，您可以使用[`trim()`](http://php.net/trim)或[`preg_replace`](http://php.net/preg-replace)/ [`str_replace`](http://php.net/str-replace)。只需从`\n`字符串中删除。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T20:31:38.093

我相信您的代码实际上是从源代码中显示换行符：

```
<p>Hello I am sentence one inside my own paragraph.</p>

<p>Hello I am sentence two inside my own paragraph.</p> 
```

两者之间的空白行实际上是用两个换行符、回车符或两者兼而有之。你可能可以做这样的事情来摆脱它：

```
$text = str_replace("\n", "", $text);
$text = str_replace("\r", "", $text); 
```

希望有帮助！注意-您可能希望用空格而不是空字符串替换。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T20:30:07.103

`$content = str_replace( "\n", "", strip_tags($content) );`

# mysql - Debian，mysql：如何调整这些值

> ID：10505949
> 
> 赞同：1
> 
> 时间：2012-05-08T20:25:23.157
> 
> 标签：mysql, apache, apache2, debian

我有一个 16 GB 内存（CPU：4 * 2Ghz）的 debian VPS。

当我现在有大约 2,000 个请求/秒时，我注意到一些性能问题。

CPU 位于：

```
41% user, 8% kernel, 2% IO, 49% idle 
```

和公羊：

```
15.71 GB total, 4.97 GB used 
```

在服务器方面，我是一个完全的菜鸟，所以我不想乱七八糟。我注意到将 max_connections 从 1,000 提高到 2,000 并将 key_buffer 从 512 提高到 1024M 时性能有所提高。

如果有人可以查看下面的值，并让我知道我是否可以做任何调整，那就太棒了。提前致谢：

```
 # * Fine Tuning
#
key_buffer      = 1024M
max_allowed_packet  = 512M
thread_stack        = 192K
thread_cache_size       = 8
# This replaces the startup script and checks MyISAM tables if needed
# the first time they are touched
myisam-recover         = BACKUP
max_connections        = 2000
#table_cache            = 64
#thread_concurrency     = 10
#
# * Query Cache Configuration
#
query_cache_limit   = 32M
query_cache_size        = 128M 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:29:30.333

首先：备份您的 my.cnf 以在出现任何问题时返回。

然后使用[mysqltuner.pl](http://mysqltuner.pl)给你一些关于你的数据库的基本信息和一些调优建议。在进行更改之前，请务必参考 mysql 文档该设置的实际作用并评估它（似乎）是否有意义。然后应用更改并在 24+h 后再次运行 mysqltuner 以查看更改

# c# - 如何形成正确的 MySQL 连接字符串？

> ID：10505952
> 
> 赞同：18
> 
> 时间：2012-05-08T20:25:30.020
> 
> 标签：c#, mysql, database-connection

我正在使用 C#，我正在尝试连接到 00webhost 托管的 MySQL 数据库。

我在线上遇到错误`connection.Open()`：

> 没有具有此参数的 mysql 主机。

我已经检查过了，一切似乎都很好。

```
string MyConString = "SERVER=mysql7.000webhost.com;" +
        "DATABASE=a455555_test;" +
        "UID=a455555_me;" +
        "PASSWORD=something;";
         MySqlConnection connection = new MySqlConnection(MyConString);
         MySqlCommand command = connection.CreateCommand();
         MySqlDataReader Reader;
         command.CommandText = "INSERT Test SET lat=" + 
             OSGconv.deciLat + ",long=" + OSGconv.deciLon;
         connection.Open();
         Reader = command.ExecuteReader();
         connection.Close(); 
```

这个连接字符串有什么问题？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-08T20:29:08.803

尝试以这种方式创建连接字符串：

```
MySqlConnectionStringBuilder conn_string = new MySqlConnectionStringBuilder();
conn_string.Server = "mysql7.000webhost.com";
conn_string.UserID = "a455555_test";
conn_string.Password = "a455555_me";
conn_string.Database = "xxxxxxxx";

using (MySqlConnection conn = new MySqlConnection(conn_string.ToString()))
using (MySqlCommand cmd = conn.CreateCommand())
{    //watch out for this SQL injection vulnerability below
     cmd.CommandText = string.Format("INSERT Test (lat, long) VALUES ({0},{1})",
                                    OSGconv.deciLat, OSGconv.deciLon);
     conn.Open();
     cmd.ExecuteNonQuery();
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-08T20:39:47.060

```
string MyConString = "Data Source='mysql7.000webhost.com';" +
"Port=3306;" +
"Database='a455555_test';" +
"UID='a455555_me';" +
"PWD='something';"; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-08T20:47:46.313

这是一个例子：

```
MySqlConnection con = new MySqlConnection(
    "Server=ServerName;Database=DataBaseName;UID=username;Password=password");

MySqlCommand cmd = new MySqlCommand(
    " INSERT Into Test (lat, long) VALUES ('"+OSGconv.deciLat+"','"+
    OSGconv.deciLon+"')", con);

con.Open();
cmd.ExecuteNonQuery();
con.Close(); 
```

# javascript - `vertical-align: middle` 没有达到我的预期

> ID：10505962
> 
> 赞同：2
> 
> 时间：2012-05-08T20:26:19.240
> 
> 标签：javascript, jquery, html, css

如果我在将 CSS 规则`vertical-align: middle;`应用于该单元格的表格单元格中，则所有文本都在单元格中垂直居中。

```
<table>
    <tr>
        <td style="vertical-align: middle;">
            I am vertically centered text!
        </td>
    </tr>
</table> 
```

但是，如果我将其应用于另一个元素，它的功能会有所不同或根本没有。例如：

```
<div style="width: 300px; height: 400px; vertical-align: middle;">
    I am not vertically centered, but I wish I was :(
</div> 
```

但是，如果我将它应用于图像标签，那么它会调整图像与其他内联元素的方向。

[这是一个包含所有这些场景示例的 jsfiddle。](http://jsfiddle.net/Chevex/7FYBa/)

我的问题是，我怎样才能在一个简单的 DIV 中完成垂直居中对齐，就像它在表格单元格中的行为方式一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:29:38.053

添加`display: table-cell`到您的 div。

jsfiddle：http: [//jsfiddle.net/7FYBa/20/](http://jsfiddle.net/7FYBa/20/)

```
<div class="outer" style="position:absolute;">
    <div class="inner" style="display:table-cell; vertical-align:middle;">
        I am not vertically centered, but I wish I was :(
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T20:36:14.550

但是当然。垂直居中在 CSS 中非常时髦。

我建议您阅读那里的一些垂直居中技术。不同的元素和考虑因素等同于不同的方法。[这是我建议的一篇文章](http://blog.themeforest.net/tutorials/vertical-centering-with-css/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T20:41:30.647

您可以使用 jQuery [http://jsfiddle.net/7FYBa/30/尝试这样的事情](http://jsfiddle.net/7FYBa/30/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T20:45:07.407

`vertical-align`当您增加`line-height`.

```
#elem {
    vertical-align: middle;
    line-height: 100px;
} 
```

但当然布局并不是那么容易使用`line-height`。

# javascript - 简单的jquery ajax返回

> ID：10505965
> 
> 赞同：1
> 
> 时间：2012-05-08T20:26:34.857
> 
> 标签：javascript, jquery, ajax, return

我有这个简单的脚本：

```
function paginateUsers(page){
   get( _config_remote_host+'/users?page='+page,function(json){

      json = JSON.parse(json);
        var _html = "";
        var json_users;
        var json_num_users;

        if(json.users){
        json_users = json.users;
        json_num_users = json.number_of_users;
        }
        if(!json.users){
            json_users = json;
            json_num_users = 0;
        }
        for(i = 0; i < json_users.length; i ++){
          if(i == 0){ _html += '<div class="row-fluid separator20">';}
          _html += '<div class="span3 media userbox">'
                      +'<div class="row-fluid">'
                       + '<div class="span3">'
                        + ' <a class="thumbnail" href="#">'
                         +' <img src="jon.png" alt=""/>'
                        +'  </a>'
                       +' </div>'
                        +'<div class="span9">'
                         +' <ul class="unstyled">'
                          +'  <li><strong><a href="user.html?id='+json_users[i].id+'">'+json_users[i].first_name+'</strong></br>'+json_users[i].last_name+'</a></li>'

                             +'   <li><h6>New york city</h6></li>'
                        +'    <li><a class="pull-right btn btn-mini">Contact</a></li>'
                       +'   </ul>'
                      +'  </div>'
                     +' </div>'
                    +'</div>';
                if(i%3 == 2){ _html += '</div><div class="row-fluid separator20">';}
             } 

        $('.users-list').html(_html).hide().fadeIn(100);
        //return always total users number to calculate total links number
        return json_num_users;
        });

  } 
```

然后我做

```
var n = paginateUsers(1);
    alert(n) 
```

但它总是提醒'未定义'，这里真正的问题是什么？

这里的ajax调用和init函数：

```
function createCORSRequest(_method, _url){
  var xhr = new XMLHttpRequest();
  if ("withCredentials" in xhr) {
    // Check if the XMLHttpRequest object has a "withCredentials" property.
    // "withCredentials" only exists on XMLHTTPRequest2 objects.
    xhr.open(_method, _url, true);
  } else if (typeof XDomainRequest != "undefined") {
    // Otherwise, check if XDomainRequest.
    // XDomainRequest only exists in IE, and is IE's way of making CORS requests.
    xhr = new XDomainRequest();
    xhr.open(_method, _url);
  } else {
    // Otherwise, CORS is not supported by the browser.
    xhr = null;
  }
  return xhr;
}

/*END INIT FUNCTION*/

function get(_url, _callback){
  var xhr = createCORSRequest('GET',_url);
  if (!xhr){
    throw new Error('CORS not supported');
  }
  $('.ajax-loading').show();
  xhr.send();

  /*SUCCESS -- do somenthing with data*/
  xhr.onload = function(){
    // process the response.
    _callback(xhr.responseText);
    $('.ajax-loading').hide();
  };

  xhr.onerror = function(e){
    console.log(e);
    $('.ajax-loading').show();
  };
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:31:06.447

您不能从 AJAX 调用返回，它是异步的。您的返回值在回调函数中，该函数在将来某个时间点执行 AJAX 调用时运行。 `paginateUsers`实际上并没有返回任何东西（这意味着它返回`undefined`）。

您应该在回调中执行与数据相关的所有操作，而不是尝试返回任何内容。或者，最好传递一个回调函数，并在完成后调用它。

```
function paginateUsers(page, callback){
    get( _config_remote_host+'/users?page='+page,function(json){
        // code...
        if(typeof callback === 'function'){
            callback(json_num_users); // Instead of "return json_num_users;"
        }
    });
} 
```

然后你可以这样做：

```
paginateUsers(1, function(result){
    // result should be the value of json_num_users
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:30:41.703

`paginateUser`如果您返回 的结果，则您不会从 中返回任何内容`get`，这可能应该是`$.get`您将拥有延迟对象（在 jquery 1.5 之后），该对象具有`done` `then`接受相应回调作为参数的方法

你也可以这样做

```
var p = $.get(....)  ( or $.post or $.ajax etc )

$.when(p).done(mydone).fail(myfail)

function mydone(data){  }
function myfail(err) {  } 
```

已编辑：在您进行编辑后，我看到您正在自己实现 ajax 调用，并使用 jquery 进行 DOM 操作，这很奇怪

最好只使用`$.getJSON`接受 url 并返回延迟对象的方法，它更易于使用并且具有可靠的 API

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T20:37:07.437

$.get 正在异步运行 - 它向服务器发起一个新请求，当所有服务器端处理完成后，它将返回一些东西。

但是您的 paginateUser() 函数在浏览器中运行，它只是发送请求（到无处/到服务器）而不等待结果。

# javascript - 使用 javascript 确定正在使用的浏览器

> ID：10505966
> 
> 赞同：5
> 
> 时间：2012-05-08T20:26:37.737
> 
> 标签：javascript, html

我在确定浏览器时遇到问题。

我试过使用`navigator`，很好，它没有帮助。

我曾经`alert(navigator.appName);`确定浏览器和我当前正在使用的浏览器`Google Chrome`，当弹出窗口出现时它显示出来`Mozilla`，但`Mozilla`它工作正常并且`Mozilla`它自己。

代码有问题吗？或者它是一些错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T20:51:50.260

```
navigator.sayswho= (function(){
    var N= navigator.appName, ua= navigator.userAgent, tem,
    M= ua.match(/(opera|chrome|safari|firefox|msie)\/?\s*([\d\.]+)/i);
    if(M && (tem= ua.match(/version\/([\.\d]+)/i))!= null) M[2]= tem[1];
    M= M? [M[1], M[2]]:[N, navigator.appVersion, '-?'];
    return M.join(' ');
})();

alert(navigator.sayswho) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T20:38:09.383

它接近 chrome，如果您需要一个简单的简短解决方案，请尝试使用它：

```
function getBrowser() {
  if( navigator.userAgent.indexOf("Chrome") != -1 ) {
    return "Chrome";
  } else if( navigator.userAgent.indexOf("Opera") != -1 ) {
    return "Opera";
  } else if( navigator.userAgent.indexOf("MSIE") != -1 ) {
    return "IE";
  } else if( navigator.userAgent.indexOf("Firefox") != -1 ) {
    return "Firefox";
  } else {
    return "unknown";
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T20:29:50.247

要回答您的问题，不，没有问题或错误。Chrome 将自己称为 Mozilla。有关 Chrome 提供的确切用户代理字符串，请参阅此内容。

[http://www.useragentstring.com/pages/useragentstring.php?name=Chrome](http://www.useragentstring.com/pages/useragentstring.php?name=Chrome)

这里有些例子：

> 铬 20.0.1092.0
> 
> Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.6 (KHTML, like Gecko) Chrome/20.0.1092.0 Safari/536.6
> 
> 铬 20.0.1090.0
> 
> Mozilla/5.0 (Windows NT 6.2) AppleWebKit/536.6 (KHTML, like Gecko) Chrome/20.0.1090.0 Safari/536.6

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T20:29:57.190

试试看`navigator.appVersion`，应该更具体。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T20:31:43.680

这是一个非常好的 js 文件的链接，它应该回答你所有的问题：

[http://www.quirksmode.org/js/detect.html](http://www.quirksmode.org/js/detect.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-08T23:06:25.590

浏览器嗅探[^(维基百科)](http://en.wikipedia.org/wiki/Browser_sniffing) [^(MDC)](https://developer.mozilla.org/en/Browser_Detection_and_Cross_Browser_Support#Excluding_Unknown_Browsers)不是一个好的做法。如果有新的浏览器，但不公开怎么办？检测应该针对功能而不是浏览器。浏览器可能会改变，变得过时，功能是持久的。

只是为了完整性和冒险精神 - 有一种方法可以测试特定的 JavaScript 对象：

```
isChrome = function() { return !!(window.chrome);}
isOpera = function() { return !!(window.opera);} 
```

对于 IE，有一个神奇的东西叫做条件编译[^(SO Question)](https://stackoverflow.com/a/5596179/179669)和关于它的材料[^(MSDN)](http://msdn.microsoft.com/en-us/library/121hztk3%28v=vs.71%29.aspx) [^(JSkit)](http://www.javascriptkit.com/javatutors/conditionalcompile.shtml)。

# visual-studio - 如何管理 TFS 和本地计算机之间的不同数据库构建参考路径？

> ID：10505977
> 
> 赞同：0
> 
> 时间：2012-05-08T20:27:29.330
> 
> 标签：visual-studio, tfs, build, database-project

我有两个数据库项目 DB_A 和 DB_B。项目 DB_A 引用 DB_B。

我通过指向 DB_B.dbschema 添加了一个数据库引用

```
C:\SourceParent\DB Projects\DB_B\sql\debug\DB_B.dbschema 
```

当我在本地机器上构建项目 DB_A 时，它工作正常。

现在我想在我的 TFS 构建服务器上构建它，但我收到以下错误

```
File D:\Builds\SourceParent\Build_Name\DB_B\sql\debug\DB_B.dbschema does not exist 
```

我的构建服务器上有一个 DB_B 构建，但它位于不同的路径（构建定义不一定与项目名称匹配）。

我想我可以在我的构建定义中添加一个构建事件来将 .dbschema 文件复制到服务器上的正确位置，但我不想这样做。（这需要为每个构建定义提供一个特殊的构建模板。）

有什么方法可以让 TFS 构建指向不同的位置吗？或者其他一些我可以做到这一点的好方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:38:20.590

我通过创建一个`$(DB_SCHEMAS)`指向我机器上的目录的环境变量来解决这个问题（例如`C:\dbschemas`）。

然后我在项目 DB_B 中添加了一个构建后事件，将 DB_B.dbschema 复制到`$(DB_SCHEMAS)`.

然后我在项目 DB_A 中添加了一个数据库引用，指向`$(DB_SCHEMAS)\DB_B.dbschema`. 请注意，Visual Studio 将使用相对路径添加此引用。为了解决这个问题，我在解决方案资源管理器中卸载了项目，并编辑了提示路径以使用`$(DB_SCHEMAS)`环境变量。

现在我刚刚在 TFS 服务器上添加了这个环境变量，它将按预期工作。构建项目 DB_B 将其 .dbschema 文件复制到`$(DB_SCHEMAS)`（无论在哪里），然后构建项目 DB_A 引用此方案。

唯一的缺点是我的队友都得在他们的机器上添加这个环境变量，否则他们无法在本地构建。

# iphone - NSMutableArray 洗牌问题

> ID：10505978
> 
> 赞同：-1
> 
> 时间：2012-05-08T20:27:30.113
> 
> 标签：iphone, nsmutablearray, shuffle

我已经解决了包含终止方法的问题。

```
If(indexes==0){
endUp = YES;
} 
```

感谢您为我指出正确的方向。这不是洗牌的问题。阿莱西格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T21:14:09.930

错误可能在您用来洗牌第一个数组的循环中。你不发布你的代码的那部分......是这样的吗？

```
for (int i=0; i<[indexes count]; i++){
// (...)
        [indexes removeObjectAtIndex:index]; 
// (...)
} 
```

这可能会更好：

```
int arrayCount = [indexes count];
for (int i=0; i<arrayCount; i++){
// (...)
        [indexes removeObjectAtIndex:index]; 
// (...)
} 
```

这个完整的代码运行良好，没有错误或崩溃：

```
int length = 10; 
NSMutableArray* indexes = [[NSMutableArray alloc] initWithCapacity:length];

for (int i=0; i<10; i++) [indexes addObject:[NSNumber numberWithInt:i]];
NSMutableArray*shuffle = [[NSMutableArray alloc] initWithCapacity:length];

int arrayCount = [indexes count];
for (int i=0; i<arrayCount; i++){

    int index = arc4random()%[indexes count];
    NSLog(@"___index: %i", index);
    NSLog(@"indexes: %@ ", indexes);

    [shuffle addObject:[indexes objectAtIndex:index]];
    [indexes removeObjectAtIndex:index]; 
    NSLog(@"shuffle: %@ ", shuffle);
}

for (int i=0; i<[shuffle count]; i++){
    int questionNumber = [[shuffle objectAtIndex:i] intValue] + 1; 
    NSLog(@"questionNumber: %i ", questionNumber);

} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-09T12:42:18.620

我明白了，无论如何，明白了！我实现了一个'if'语句，它将终止它！ `if ([indexes count] == 0)
{endProcess = YES}`

# django - 当我将 cmsplugin_blog 用作 apphook 时，它会显示空站点

> ID：10505979
> 
> 赞同：1
> 
> 时间：2012-05-08T20:27:38.960
> 
> 标签：django, django-cms

我没有让 cmsplugin_blog 在我的 Django CMS 2.2 应用程序中工作：

我从[http://cmsplugin-blog.readthedocs.org/en/latest/](http://cmsplugin-blog.readthedocs.org/en/latest/)完成了所有步骤。

然后我为我的一个 CMS 页面选择了博客应用程序。但是页面是空的。甚至我的基本模板中的标题也不包括在内。我得到的页面源代码只有：

```
<link rel="alternate" type="application/rss+xml" title="RSS feed" href="/de/news/rss/" />
<link rel="alternate" type="application/rss+xml" title="RSS feed (any language)" href="/de/news/rss/any/" /> 
```

我的模板的源代码是：

```
{% extends "base.html" %}
{% load cms_tags %}
{% load menu_tags %}

{% block base_content %}
    {% block left-col %}{% endblock %}
    {% block right-col %}{% endblock %}
{% endblock %} 
```

有人知道我错过了什么吗？

当我尝试将博客应用程序作为插件包含在另一个 CMS 页面上时，它可以工作。

[除了http://cmsplugin-blog.readthedocs.org/en/latest](http://cmsplugin-blog.readthedocs.org/en/latest)之外， cmsplugin_blog 是否还有其他文档，而我只是愚蠢地找到它们？

谢谢您的帮助！

# format - jquery自动完成数据格式

> ID：10505981
> 
> 赞同：2
> 
> 时间：2012-05-08T20:27:39.720
> 
> 标签：format, jquery-autocomplete

我正在尝试在 jQuery 自动完成中显示 jSON 数据，除了下拉菜单不显示外，一切正常。
我可以使用`parse:`（有很多例子），但我认为我需要通过`source:`.

**是否有可能以我正在做的方式显示数据还是我们需要解析？
如果是，如何？**

我对 jquery UI 不是很好

```
$(function() {
    function log( message ) {
        $( "<div/>" ).text( message ).prependTo( "#log" );
        $( "#log" ).attr( "scrollTop", 0 );
    }

    $( "#aut_teachers" ).autocomplete({
        source: function(request, response) {
            $.ajax({
                url: base_url+"controller/model",
                data: request,
                dataType: "json",
                type: "post",
                success: function(data){
                    response(data.value);// here is where the problem is
                }

            });
        },
        minLength: 2,
        select: function( event, ui ) {
            log( ui.item ?
            "Selected: " + ui.item.value + " aka " + ui.item.id :
            "Nothing selected, input was " + this.value );
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:38:44.330

您应该使用`data.message`do`response`而不是`data.value`.

由于，`data.message`是一个对象数组，并且对象是标签/值，因此您可以使用它。

检查[自动完成文档](http://jqueryui.com/demos/autocomplete/)以获取更多信息。

# silverlight - 检测已安装的 OOB Silverlight 应用程序版本并从浏览器 Application.Install() 强制更新

> ID：10505983
> 
> 赞同：1
> 
> 时间：2012-05-08T20:28:06.230
> 
> 标签：silverlight, silverlight-5.0

1.  用户在浏览器外安装我的 Silverlight 应用程序。

2.  我将我的 Silverlight 应用程序的新版本部署到用户之前在步骤 1 中安装了我的 silverlight 应用程序的 URL。

3.  然后，用户返回到他们最初安装我的应用程序的网页，并应用了步骤 2 中描述的更新。

4.  用户第二次从网页安装，不允许更新本地安装的版本。

发生这种情况时，它会在用户桌面上安装第二个（更新版本）应用程序，而不是更新当前安装的版本。有没有办法强制更新应用程序的 OOB 安装版本，而不是在之前的版本旁边安装第二个更新的实例？

编辑：

我的源 URL 是如何定义的。

```
public partial class _default : System.Web.UI.Page
{
    private const string XapPath = "ClientBin/Client.xap";

    public string HostSource { get; set; }

    protected override void OnLoad(EventArgs e)
    {
        base.OnLoad(e);

        HostSource = string.Concat(XapPath, "?"
            ,  System.IO.File.GetLastWriteTime(Server.MapPath(XapPath)).ToString().GetHashCode());
    }
} 
```

我正在尝试更新的 Silverlight 应用程序的对象标记代码...

```
 <object data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="100%" height="100%">
      <param name="source" value="<%=HostSource %>"/>
      <param name="onError" value="onSilverlightError" />
      <param name="background" value="white" />
      <param name="minRuntimeVersion" value="5.0.61118.0" />
      <param name="autoUpgrade" value="true" />
      <a href="http://go.microsoft.com/fwlink/?LinkID=149156&v=5.0.61118.0" style="text-decoration:none">
          <img src="http://go.microsoft.com/fwlink/?LinkId=161376" alt="Get Microsoft Silverlight" style="border-style:none"/>
      </a>
    </object> 
```

# asp.net-mvc-3 - 两个MVC项目——图片分享

> ID：10505986
> 
> 赞同：1
> 
> 时间：2012-05-08T20:28:30.890
> 
> 标签：asp.net-mvc-3, image, multi-tenant

开始：

我在解决方案中有 2 个 MVC3 项目，其中一个用于管理员，另一个用于普通用户。管理员在其项目的文件夹中动态上传图像。所以我想从用户项目中获取图像以显示在相同的网页中。

我还有代表服务、应用逻辑和数据访问的三个项目。

我一直在寻找解决方案并发现相同的事情：1-将图像存储在数据库中，然后将其从服务中检索到用户项目。2-引用来自用户 MVC 项目的图像。（做不到）

最好的方法是什么？我该如何实现第一个？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:34:05.973

首先，您有两个应用程序而不是一个应用程序，其管理区域仅限授权用户，是否有原因？

至于将图像存储在数据库中，您可以将图像转换为字节数组并将其作为 varbinary(max) 存储在数据库中。

这个问题显示了将文件流（我假设您正在通过表单上传图像）转换为字节数组的示例：[Convert a bitmap into a byte array](https://stackoverflow.com/questions/7350679/convert-a-bitmap-into-a-byte-array-in-c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:32:49.537

我想，您应该将其合并到一个项目中并使用**ASP.NET MVC Areas**。创建一个名为“Admin”的区域，并将与管理员相关的内容保存在其中。将与普通用户相关的内容保留在根级别。那你应该很好。您应该能够在这两者之间共享图像，因为您在同一个项目中。

如果您确实想将其保留为单独的项目并部署为单独的网站，则应通过图像引用其他网站`absolute url`中的图像

# c++ - 检测混合字符串中的非字母字符

> ID：10505987
> 
> 赞同：0
> 
> 时间：2012-05-08T20:28:35.053
> 
> 标签：c++

我的代码的非常简化的版本：

```
#include <iostream>
#include <string>
using namespace std;

int main () {
string name;

cout << "Enter first and last name" << endl;
getline(cin, name);

return 0;
} 
```

如您所见，我希望我的用户输入他们的名字和姓氏，其中包括空格。我想检查它是否有数字字符，如果输入了任何字符，就会抛出一个错误。示例输入可以是：“J0hn Sm1th”，当然会显示错误。

我知道我将不得不使用 isAlpha() 如果只输入数字或只输入字母，我可以让它工作，但当它们组合在一起时就不行。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-08T20:32:02.950

如果您有 C++11，请使用`std::all_of(name.begin(), name.end(), isalpha)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:41:31.797

```
#include <cstddef>
#include <string>

bool check_name(const string& str)
{
    for (std::size_t i = 0; i < str.size(); ++i)
        if (!((str[i]>='a' && str[i]<='z') ||
              (str[i]>='A' && str[i]<='Z') ||
               str[i]==' ' || str[i]=='-' ))
        return false;
    return true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-17T07:08:57.500

您可以检查小写和大写值是否相同，对于非字母字符，它们将相同

# c - C：释放重新分配的指针

> ID：10505991
> 
> 赞同：0
> 
> 时间：2012-05-08T20:28:39.483
> 
> 标签：c, pointers, free, realloc

我今天发现，当我尝试`free`指向已重新分配的指针时，程序崩溃并打印“分段错误”。

在此指针（数组）上调用A`realloc()`以调整数组大小并将旧数组与另一个数组合并。

在程序中我必须`free`这样做，我怎样才能绕过这个问题而不必制作某种缓冲区数组，向其中添加 2 个其他数组然后释放它们？

1.  `PARTICLE`： 结构体
2.  `newCount`: 旧数组的大小总和 + 正在添加的数组

代码：

```
group1->particleList = 
         (PARTICLE *) realloc(group1->particleList, newCount * sizeof(PARTICLE)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:39:30.867

释放重新分配的指针应该没有问题。一个名为 valgrind 的程序可以为您提供一些关于代码中正在发生的事情的有价值的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:39:28.273

您是否包含“stdlib.h”？

铸造`realloc`和朋友的回归可以隐藏它没有原型的问题。较旧的编译器然后将其返回一个`int`，将其`int`转换为指针类型并完成损坏。

`realloc`正如其他人提到的那样，会返回的问题`0`不应该在缓冲时导致错误`free`，而是更早。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T20:37:18.763

首先，确保将结果分配给`realloc`临时变量；如果请求失败，`realloc`将返回 NULL，并且您将失去对已分配内存的处理：

```
PARTICLE *tmp = realloc(group1->particleList, ...); // cast is unnecessary
if (tmp)
  group1->particlelist = tmp;
else
  /* handle realloc failure */ 
```

确保`group1->particleList`在调用之前不会意外覆盖（可能在合并代码中？）`free`。`realloc`即使在调用失败的情况下它被 NULL 覆盖，`free` *也应该*能够处理 NULL 参数（基本上，这将是一个空操作）。

# objective-c - 如果 UITableView 没有条目，则显示警报

> ID：10505993
> 
> 赞同：-1
> 
> 时间：2012-05-08T20:28:52.517
> 
> 标签：objective-c, ipad, uitableview, ios5

在我的 iPad 应用程序中，如果 UITableView 上没有条目或所有单元格都是空的，并且如果按下特定按钮，则应该有警报。检查 UITableView 中所有单元格是否为空的条件是什么？

谢谢并恭祝安康

个人电脑

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T20:32:41.673

检查数据源的计数。

例如，如果您使用的是数组`myArrayData`：

```
if ([myArrayData count] == 0) {
    // Do code here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:37:50.617

除了亚当约翰逊的回答

如果您的数据来自**核心数据**并且您正在实施`NSFetchedResultController`

```
if ([self.fetchedResultsController.fetchedObjects count] > 0) {
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"UIAlertView"
    message:@"My message" delegate:self cancelButtonTitle:@"Cancel"
    otherButtonTitles:@"OK", nil];
    [alert show];
    [alert release];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T20:37:20.633

您可以使用 viewWillAppear 方法来检查您的要求。

如果您的按钮被按下（我假设在不同的视图控制器上？）您可能希望在按下按钮时实际设置一个 BOOL 并在此视图控制器中引用它。

通常表格视图使用数组（或某些对象）来保存它们的值，您可以简单地检查是否 (myarray.count > 0) 以查看是否有任何表格单元格。

如果您留下有关您的设置的更多信息，我很乐意更具体地满足您的需求。祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-15T04:31:50.530

如果使用 CoreData，可以通过 numberOfRowInSection 检测写入表的行数如下

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

    id <NSFetchedResultsSectionInfo> sectionInfo = [[self.fetchedResultsController sections] objectAtIndex:section];

    if (sectionInfo.numberOfObjects == 0) {

              //Here you can use your code
    }

    return [sectionInfo numberOfObjects];
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-08T20:32:56.580

好吧，您可以枚举所有单元格并查看它们是否包含任何内容。例如：

```
BOOL isEmpty = false;
UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:1]];
// Then depending on what kind of value you have in it...
if (cell.textLabel.text == @""){
// Keep going through the enumeration until there's actually something and then set isEmpty to true!
} 
```