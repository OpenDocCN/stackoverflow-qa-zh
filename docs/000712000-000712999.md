# StackOverflow 问答 000712000-000712999

# sharepoint - 仅绑定到我的自定义内容类型的 Sharepoint 列表定义

> ID：712000
> 
> 赞同：1
> 
> 时间：2009-04-02T23:16:49.040
> 
> 标签：sharepoint, sharepoint-2007, wss, content-type, list-definition

我正在开发一个实现新列表的 Sharepoint 解决方案。此列表具有附加到自定义内容类型的事件接收器。

我正在使用 VSeWSS 1.3 执行此任务，一切正常（创建了内容类型，创建了一个列表并将其绑定到内容类型，事件接收器成功触发。

我唯一担心的是，在创建的列表中，它始终显示基本内容类型（带有标题字段的项目 CT）。通过 Web GUI，我可以隐藏此内容类型，但我无法在我的 XML 定义中找到执行此操作的位置，或者在解决方案中使用它以避免部署时的双重任务。

有什么建议么？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T02:40:48.630

您必须为自定义列表编辑 Schema.xml。找到`<ContentTypes>`标签并删除任何您不希望显示的内容。

您的列表定义将有一个 guid（例如`<Elements Id="0a8594c8-5cf1-492e-88ce-df943830c88c"`），它将从模式 xml 中指定列表（例如`<List Name="... ...Id="0a8594c8-5cf1-492e-88ce-df943830c88c">`）

我不确定实现的目的是什么，通常有一个 feature.xml 将以前的 xml 文件组合在一起（例如`<ElementManifests><ElementManifest Location="MyFeature\ListDefinition.xml" /><ElementFile Location="MyFeature\schema.xml" />`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T04:31:35.687

在 schema.xml 中，您需要进行 2 处更改

在 <List> 元素中添加以下属性：

```
EnableContentTypes="TRUE" 
```

<ContentTypes> 元素应该包含一个指定您的自定义内容类型的 <ContentType> 元素。

例如：

```
<?xml version="1.0"?>
<List 
  xmlns:ows="Microsoft SharePoint" 
  Title="List_Title" 
  FolderCreation="FALSE" 
  Direction="$Resources:Direction;" 
  Url="Lists/List_Title" 
  BaseType="0" 
  Name="List_Title" 
  Id="51D716AC-DF9D-4ebb-9F8E-9134EEBB7C39" 
  Type="100" 
  xmlns="http://schemas.microsoft.com/sharepoint/"
  EnableContentTypes="TRUE"
>
  <MetaData>
    <ContentTypes>
      <ContentTypeRef ID="0x01..." />
    </ContentTypes> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T17:05:50.730

这两个答案都对我有帮助，但我还发现您需要在列表定义中再次指定列（不仅在内容类型中），否则它们不会出现在列表中。

# java - Java 是否有获取各种字节顺序标记的方法？

> ID：712004
> 
> 赞同：4
> 
> 时间：2009-04-02T23:20:53.133
> 
> 标签：java, unicode, byte-order-mark

我正在寻找一种实用方法或 Java 中的常量，它将返回与编码的适当字节顺序标记相对应的字节，但我似乎找不到。有吗？我真的很想做类似的事情：

```
byte[] bom = Charset.forName( CharEncoding.UTF8 ).getByteOrderMark(); 
```

`CharEncoding`来自 Apache Commons 。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T20:03:23.170

Java 不识别 UTF-8 的字节顺序标记。请参阅错误[4508058](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4508058)和[6378911](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6378911)。

要点是添加了支持，破坏了向后兼容性，并被回滚。您必须自己在 UTF-8 中进行 BOM 识别。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T15:41:57.147

Apache Commons IO 包含您要查找的内容，请参阅[`org.apache.commons.io.ByteOrderMark`](https://commons.apache.org/proper/commons-io/javadocs/api-2.4/org/apache/commons/io/ByteOrderMark.html).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T09:42:06.277

您可以像这样生成 BOM：

```
byte[] utf8_bom = "\uFEFF".getBytes("UTF-8");
byte[] utf16le_bom = "\uFEFF".getBytes("UnicodeLittleUnmarked"); 
```

如果您希望使用此方法为其他编码创建 BOM，请确保使用不会自动插入 BOM 的编码版本，否则会重复。此技术仅适用于 Unicode 编码，不会对其他人产生有意义的结果（如 Windows-1252）。

*   [Unicode BOM 常见问题](http://unicode.org/faq/utf_bom.html)
*   [Sun Java 6 支持的编码](http://java.sun.com/javase/6/docs/technotes/guides/intl/encoding.doc.html)
*   [Sun Java 5 支持的编码](http://java.sun.com/j2se/1.5.0/docs/guide/intl/encoding.doc.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T00:03:34.233

据我所知，JDK 中没有任何东西，也没有任何 Apache 项目。

Eclipse EMF 有一个 Enum，但是它提供了支持：

[`org.eclipse.emf.ecore.resource.ContentHandler.ByteOrderMark`](http://help.eclipse.org/stable/topic/org.eclipse.emf.doc/references/javadoc/org/eclipse/emf/ecore/resource/ContentHandler.ByteOrderMark.html)

不知道对你有没有帮助？

这里有一些关于每种编码类型的各种 BOM 的更多信息，您可以为此编写一个简单的帮助程序类或枚举...

[http://mindprod.com/jgloss/bom.html](http://mindprod.com/jgloss/bom.html)

希望有帮助。老实说，我很惊讶这不在 Commons I/O 中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T06:23:09.280

值得注意的是，许多编码不使用任何字节顺序标记。例如，UTF-8 中的空字符串只是一个空字节[]。虽然为 UTF-8 指定了 BOM，但它在 Java 中很少使用，并且并不总是受支持。

# sql-server - Delphi：“参数对象定义不正确。提供的信息不一致或不完整。”

> ID：712011
> 
> 赞同：7
> 
> 时间：2009-04-02T23:23:55.420
> 
> 标签：sql-server, delphi

我正在尝试将记录插入到 3 层数据库设置中的表中，并且中间层服务器在尝试将第一个参数添加到查询时生成上面的错误消息作为 OLE 异常。

我用谷歌搜索了这个错误，我始终发现相同的结果：它来自查询中某处的字符串中有一个冒号，这阻碍了 ADO 的 SQL 解析器。这不是这里的情况。任何地方都没有虚假的冒号。我已经针对我要插入的表的架构检查并重新检查了对象定义。一切都检查出来了，这让我的同事很难过。有谁知道还有什么可能导致这种情况？我在这里束手无策。

我正在使用 Delphi 2007 和 SQL Server 2005。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T03:44:11.053

我可以使用 Delphi 2007 和 MSSQL Server 2008 得到这个错误，我找到了一个解决方法。（恕我直言，这很糟糕，但如果你的问题是由同一件事引起的，它可能对你有用。）

产生错误的代码：

```
with TADOQuery.Create(nil)
do try

   Connection := ADOConnection;

   SQL.Text := ' (SELECT * FROM Stock WHERE  InvCode = :InvCode ) '
              +' (SELECT * FROM Stock WHERE  InvCode = :InvCode ) ';

   Prepared := true;

   Parameters.ParamByName('InvCode').Value := 1;

   Open;  // <<<<< I get the "parameter object is...etc. error here.

 finally
   Free;
 end; 
```

我找到了两种解决方法：

1）从SQL中删除括号，即：

```
 SQL.Text := ' SELECT * FROM Stock WHERE  InvCode = :InvCode  '
              +' SELECT * FROM Stock WHERE  InvCode = :InvCode  '; 
```

2）使用两个参数而不是一个：

```
with TADOQuery.Create(nil)
do try

   Connection := ADOConnection;

   SQL.Text := ' (SELECT * FROM Stock WHERE  InvCode = :InvCode1 ) '
              +' (SELECT * FROM Stock WHERE  InvCode = :InvCode2 ) ';

   Prepared := true;

   Parameters.ParamByName('InvCode1').Value := 1;
   Parameters.ParamByName('InvCode2').Value := 1;

   Open;  // <<<<< no error now.

 finally
   Free;
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-12T20:06:52.427

我在搜索前面提到的异常消息时发现了这个线程。就我而言，原因是试图将 SQL 注释 /* foo */ 嵌入到我的 query.sql.text 中。

（我认为在我的分析器窗口中看到一条评论会很方便。）

无论如何-Delphi7讨厌那个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-26T14:18:16.987

这是一个迟到的回复。就我而言，这是完全不同的事情。

我试图向数据库添加一个存储过程。

```
Query.SQL.Text :=
'create procedure [dbo].[test]' + #13#10 +
'@param int ' + #13#10 +
'as' + #13#10 + 
'-- For the parameter you can pick two values:' + #13#10 + 
'-- 1: Value one' + #13#10 + 
'-- 2: Value two'; 
```

当我删除冒号 (:) 时，它起作用了。因为它将冒号视为参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-30T08:45:37.490

我面临您问题中描述的相同错误。我已将错误追踪到`ADODB.pas`-> `procedure TParameters.AppendParameters; ParameterCollection.Append(Items[I].ParameterObject)`。

通过使用断点，在我的情况下，错误是由一个应该填充数据库中的字段的参数引发的，`DateTime`而我从未填充过该参数。设置`parameter().value:=''`解决的问题（我也尝试过`varNull`，但有一个问题 - 而不是在数据库中发送 Null，查询正在发送`1`- 的整数值`varNull`）。

PS：我知道这是一个“迟到迟到”的答案，但也许有人会遇到同样的错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-30T16:35:03.407

我自己也遇到了这个错误。我正在使用 Delphi 7 使用 TAdoQuery 组件写入 2003 MS Access 数据库。（旧代码）我的查询直接在 MS Access 中运行良好，但在 Delphi 中通过 TAdoQuery 对象失败。我的错误来自日期/时间值的冒号（向原始海报道歉）。

据我了解，Jet SQL 日期/时间格式为#mm/dd/yyyy hh:nn:ss#（不需要0 左填充）。

如果 TAdoQuery.ParamCheck 属性为 True，则此格式失败。（谢谢发帖人！）两种解决方法是：a）将 ParamCheck 设置为 False，或 b）使用不同的日期/时间格式，即“mm/dd/yyyy hh:nn:ss”（带双引号）。

我测试了这两个选项，它们都有效。

尽管双引号日期/时间格式不是 Jet 日期/时间格式，但 Access 非常擅长灵活处理这些日期/时间格式。我还怀疑它与 BDE/LocalSQL/Paradox（Delphi 7 的本机 SQL 和数据库引擎）日期/时间格式（使用双引号，如上所述）有关。解析器可能被设计为忽略带引号的字符串（双引号是 BDE LocalSQL 中的字符串值分隔符），但可能会在其他非本机日期/时间格式上遇到一些问题。

SQL Server 使用单引号来分隔字符串，因此在写入 SQL Server 表（未测试）时，它可能代替双引号起作用。或者也许 Delphi TAdoQuery 对象仍然会绊倒。在这种情况下关闭 ParamCheck 可能是唯一的选择。如果您打算在代码中切换 ParamCheck 属性值，如果您不打算解析当前 SQL，则在启用它之前确保 SQL 属性为空，可以节省一些处理时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-31T11:56:06.603

我也遇到了同样的问题，但使用的是动态命令（例如 Update 语句）。
某些参数可能为 NULL。
我可以让它工作的唯一方法是设置 parameter.DataType := ftString 和 parameter.Size := 1 而**不是设置 value**。

```
cmdUpdate := TADOCommand.Create(Self);
try
  cmdUpdate.Connection := '**Conections String**';
  cmdUpdate.CommandText := 'UPDATE xx SET yy = :Param1 WHERE zz = :Param2';
  cmdUpdate.Parameters.ParamByName('Param2').Value := WhereClause;
  if VarIsNull(SetValue) then
  begin
    cmdUpdate.Parameters.ParamByName('Param1').DataType := ftString;
    cmdUpdate.Parameters.ParamByName('Param1').Size := 1;
  end else cmdUpdate.Parameters.ParamByName('Param1').Value := SetValue;
  cmdUpdate.Execute;
finally
  cmdUpdate.Free;
end; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-12T20:22:51.167

我今天刚刚在一个 TADOQuery 上遇到了这个错误，它`ParamCheck := False`在 SQL 中有和没有冒号。

不知何故将**OLECMDEXECOPT_DODEFAULT**参数传递给 TWebBrowser.ExecWB() 对我来说是这样的：

这说明了问题：

```
pvaIn := EmptyParam;
pvaOut := EmptyParam;
TWebBrowser1.ExecWB(OLECMDID_COPY, OLECMDEXECOPT_DODEFAULT, pvaIn, pvaOut); 
```

这没有显示问题：

```
pvaIn := EmptyParam;
pvaOut := EmptyParam;
TWebBrowser1.ExecWB(OLECMDID_COPY, OLECMDEXECOPT_DONTPROMPTUSER, pvaIn, pvaOut); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-03T13:50:57.440

查询中的单个双引号也可以从我刚刚遇到的情况中引发此错误，并且我根本没有使用参数......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-03T09:17:39.893

您是否设置了参数的 DataType 还是将其保留为 ftUnknown？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-02T23:31:27.977

如果我没记错的话，你必须显式地将 NULL 值放入参数中。如果您使用的是 TAdoStoredProc 组件，您应该在设计时执行此操作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-03T01:26:38.963

您是否使用任何线程？我似乎记得当 ADO 连接用于另一个同步查询时计时器事件启动查询时收到此错误。（计时器每分钟检查一次“系统可用”标志）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-06-22T10:18:54.470

我得到了同样的错误。原来，这是因为存储过程的一个参数被声明为 varchar(max)。使它成为 varchar(4000) 并且错误消失了。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-09-22T15:05:44.030

尝试在 SQL 中使用时间值并忘记用 QuotedStr() 包装它时，可能会出现此错误。

# java - 如何帮助java tomcat进程重新获得使用的内存？

> ID：712018
> 
> 赞同：3
> 
> 时间：2009-04-02T23:27:07.783
> 
> 标签：java, memory, tomcat, memory-management

我们正在运行一个使用 Java 64bit 5 gigs -Xmx 的最大堆大小的 Web 应用程序。我们无法控制 java 代码。我们只能调整配置参数。我们面临的情况是，Java 进程在启动时占用了分配的全部堆后，开始对网站请求的响应非常缓慢。我的猜测是等待 GC 收集未使用的内存对象。

下图将向您展示 linux 中的 top 图像，显示进程的危急情况。

[java进程的顶部图像http://cp.images.s3.amazonaws.com/ForumImages/java-gc-issue.jpg](http://cp.images.s3.amazonaws.com/ForumImages/java-gc-issue.jpg)

有什么办法可以帮助java重新获得分配空间内使用的内存。

编辑1：我使用下面的一些答案来回答我的问题。因为我的问题太难回答了，结果变成了讨论。我将发布我如何能够监控 GC 周期，并且我会以更多的票数选择答案。我通过真正的 vnc 查看器使用了 jconsole，以便能够从我的 windows 机器挂钩到运行 tomcat 的 linux 机器。

我使用这个参数来启动 java 进程：

```
-Djava.awt.headless=true -server -Xms512m -Xmx5120m -Dbuild.compiler.emacs=true -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=4999 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false 
```

这是我得到的输出类型，从 jconsole 到 vnc 查看器。 [GC 示例图片 http://cp.images.s3.amazonaws.com/ForumImages/Sample_GC_Image.jpg](http://cp.images.s3.amazonaws.com/ForumImages/Sample_GC_Image.jpg "样品 GC 图像")

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T23:33:24.320

我建议你不要猜测。获取一些数据以确切了解发生了什么。您可以使用[视觉 gc](http://java.sun.com/performance/jvmstat/visualgc.html)来查看发生了什么。

如果是烫发空间被填满，你将无能为力。

哪个JVM？如果它是 5 或更高，那么除了最大堆大小之外，您还可以调整其他参数。查看[http://blog.springsource.com/2008/10/14/optimising-and-tuning-apache-tomcat-part-2/](http://blog.springsource.com/2008/10/14/optimising-and-tuning-apache-tomcat-part-2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T06:20:56.137

如果您的应用程序越来越慢，这听起来像是内存泄漏。GC 总是会在需要时立即开始清理未使用的对象。如果添加 -verbosegc，您将能够看到执行 GC 的频率以及 GC 后有多少内存可用。如果堆的使用率超过 80%，则必须增加最大内存或修复程序以使其不使用太多。

你能做一个`numactl --hardware`吗？我建议你不要使用超过 80% 的内存库，否则你的 GC 时间会急剧增加。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T23:57:18.383

听起来您需要了解堆栈使用情况的详细信息。为此，我推荐 JMAP ( [http://java.sun.com/j2se/1.5.0/docs/tooldocs/share/jmap.html](http://java.sun.com/j2se/1.5.0/docs/tooldocs/share/jmap.html) )，您可以在进程 ID (PID) 上运行它以查看正在使用内存的内容。在应用程序运行时多次拍摄 JMAP 快照，看看哪些类没有释放堆栈。

干杯，

-理查德

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T15:44:56.130

尝试使用 `-verbose:gc -Xloggc:/path/to/where/you/want/gc.log`参数运行应用程序，并研究生成的 gc.log；它应该告诉您在垃圾收集上花费了多少时间。或者，正如 Duffymo 上面建议的那样，使用 visualGC 为您提供相同的数据。

确保您使用的是合适的收集器——假设您使用的是 java 5，您可能需要并行或低暂停 (CMS) 收集器。

阅读[Sun 的 GC 调整文档](http://java.sun.com/docs/hotspot/gc5.0/gc_tuning_5.html)，看看您还可以调整什么。有时我发现非常大的堆会适得其反（假设应用程序实际上并不*需要*所有空间）；更频繁，较小的收藏有时最终会比偶尔的大量收藏具有更少的破坏性。

# python - 列出 Nosetest 找到的所有测试

> ID：712020
> 
> 赞同：42
> 
> 时间：2009-04-02T23:27:37.703
> 
> 标签：python, unit-testing, nose, nosetests

我`nosetests`用来运行我的单元测试，它运行良好。我想在`nostests`不实际运行它们的情况下获取所有测试结果的列表。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-07-20T00:32:07.173

0.11.1 版目前可用。您可以在不运行测试的情况下获取测试列表，如下所示：

```
nosetests -v --collect-only 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-08-10T11:37:31.200

我建议使用：

```
nosetests -vv --collect-only 
```

虽然该`-vv`选项未在 中描述`man nosetests`，但[“鼻子单元测试框架的扩展介绍”](http://ivory.idyll.org/articles/nose-intro.html)指出：

> 使用 -vv 标志可以为您提供鼻子的测试发现算法的详细输出。这将告诉您鼻子是否甚至在正确的位置寻找您的测试。

`-vv`在尝试确定为什么nosetests 只找到您的一些测试时，该选项可以节省时间。（在我的情况下，这是因为nosetests 跳过了某些测试，因为`.py`脚本是可执行的。）

底线是该`-vv`选项非常方便，我几乎总是使用它而不是该`-v`选项。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T02:58:03.307

很快就会有：上周在 PyCon 上演示了一个产生这种行为的新 --collect 开关。它应该“很快”在主干上，并将在 0.11 版本中。

http://groups.google.com/group/nose-users 列表是鼻子问题的绝佳资源。

# apache - Apache/nginx 细粒度（每个文件）权限？

> ID：712023
> 
> 赞同：0
> 
> 时间：2009-04-02T23:28:39.340
> 
> 标签：apache, authentication, permissions, authorization, nginx

是否可以使用 Apache 或 nginx 设置细粒度的权限？给定大量文件和大量用户，指定每个经过身份验证的用户只能访问他/她自己的文件的好方法是什么？

```
user_a can access file_a_1, file_a_2
user_b can access file_b_1
user_c can access file_c_1, file_c2, file_c3, file_a_2 
```

这些是静态的只读文件（大部分）。想象一下类似访问控制但使用 http 的文件系统。没有 web-dav；这是网络应用程序的一部分；图像将作为浏览器中用户页面的一部分显示。我想确保没有其他人可以看到图像，即使他们可以找到它的 url。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T02:15:39.347

啊。如果没有编写自己的身份验证处理程序，我怀疑是否有一种简单的方法可以完成此操作，至少使用 Apache。

如果[lighttpd](http://www.lighttpd.net/)是一个选项，我可能会在 PHP 脚本中实现安全检查，如果一切正常，[`X-LIGHTTPD-send-file`](http://redmine.lighttpd.net/projects/lighttpd/wiki/X-LIGHTTPD-send-file)则在响应中添加一个标头。这意味着 lighty 将在不通过 PHP 的情况下完成所有文件传输。

（快速谷歌搜索显示 apache*应该*支持这样的东西`X-sendfile`，但我无法从 Apache 文档中得到任何关于此的信息。）

编辑：显然你可以用 Apache 和[`mod proxy scgi`](http://httpd.apache.org/docs/trunk/mod/mod_proxy_scgi.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-06T13:25:03.910

我意识到我在这里发布了 necroposting，但只是为了未来的谷歌人，

这是 andri 解决方案的类似 nginx 选项：

[http://blog.kovyrin.net/2006/11/01/nginx-x-accel-redirect-php-rails/](http://blog.kovyrin.net/2006/11/01/nginx-x-accel-redirect-php-rails/)

[http://wiki.nginx.org/NginxXSendfile](http://wiki.nginx.org/NginxXSendfile)

...显然，对于 Apache 来说也是如此：

[http://tn123.ath.cx/mod_xsendfile/](http://tn123.ath.cx/mod_xsendfile/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T01:09:45.400

不完全确定您要做什么。这些用户需要写权限，还是文件是只读的？这些是静态文件吗？

# asp.net - Formview 和 MS-Ajax 更新面板

> ID：712026
> 
> 赞同：1
> 
> 时间：2009-04-02T23:29:35.797
> 
> 标签：asp.net, asp.net-ajax, webforms

在由 formview 控件触发的部分回发后，formview 编辑按钮的条件显示存在问题。我在 ItemTemplate 中定义了一个编辑按钮，如下所示：

```
<asp:FormView ID="fvGenericDetails" runat="server">
    <ItemTemplate>
       <asp:Button ID="btnEditGenericDetails" runat="server" Visible="false" CausesValidation="False" CssClass="prepend-top" CommandName="Edit" Text="Edit Generic Details" />
</ItemTemplate> 
```

该按钮根据页面加载事件中的用户权限有条件地显示：

```
If CurrentUser.HasAdminStatus and fvGenericDetails.CurrentMode = FormViewMode.ReadOnly Then
    Dim btnEditGenericDetails As Button =  CType(Me.fvGenericDetails.FindControl("btnEditGenericDetails"), Button)
    btnEditGenericDetails.Visible = True
End If 
```

我遇到的问题是，由于 formview 控件位于 UpdatePanel 中，因此当控件返回只读模式时，部分回发不会触发页面加载事件，并且编辑按钮不可见。我应该使用什么事件来允许这种部分回发？

编辑：调试页面后，在部分回发之后，页面确实遇到了 page_load 事件，但是 formview.currentmode = edit :|

我尝试使用 ModeChanged 事件但没有成功。答案只是不使用formview控件吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T23:44:29.177

我认为最好的地方是在这样的 FormView_ModeChanging 事件中：

```
Protected Sub FormView1_ItemDataBound(ByVal sender As Object, ByVal e As EventArgs) Handles FormView1.ItemDataBound
        If e.NewMode = FormViewMode.ReadOnly Then
            If CurrentUser.HasAdminStatus Then
                Dim btnEditGenericDetails As Button = CType(Me.fvGenericDetails.FindControl("btnEditGenericDetails"), Button)
                btnEditGenericDetails.Visible = True

            End If
        End If
End Sub 
```

好的...如果您将代码放在**ItemDataBound**事件处理程序中，那么它应该可以工作。这与 InsertTemplate 在绑定到 FormView 的对象之前不存在的事实有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T23:44:54.417

除非你有你的按钮显示逻辑包裹在

```
if(!IsPostBack){} //don't know what the VB equivalent is 
```

您的代码应该可以正常工作。启动调试器并在 IF 语句上放置一个断点，然后查看 fvGenericDetails.CurrentMode 的计算结果

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T20:56:25.063

伙计，这可能会有所帮助，但请尝试更改 Prerender 或 Init 页面 evnt 上的 formview 视图

# web-services - 将 SOAP WS 公开为 JMS 是否可能（合理）？

> ID：712032
> 
> 赞同：0
> 
> 时间：2009-04-02T23:31:41.440
> 
> 标签：web-services, architecture, jms

如果是这样，消息会是什么样的？带有 SOAP 请求或响应的 XML 文档？

这有意义吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T23:36:01.880

Glassfish 是这么认为的：

[https://jms-ws-transport.dev.java.net/](https://jms-ws-transport.dev.java.net/)

一条异步消息对我来说意味着没有响应或简单的 ACK（“我们收到了您的消息；我们会回复您。”）。

# java - JSTL forEach 逆序

> ID：712046
> 
> 赞同：26
> 
> 时间：2009-04-02T23:36:26.077
> 
> 标签：java, jsp, jstl

使用 JSTL 的`forEach`标签，是否可以以相反的顺序进行迭代？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-02T23:44:50.517

当您`forEach`用于创建整数循环时，您可以前进或后退，但这需要一些工作。事实证明你不能这样做，例如：

```
<c:forEach var="i" begin="10" end="0" step="-1">
    ....
</c:forEach> 
```

因为规范要求步骤是积极的。但是您始终可以按正序循环，然后使用`<c:var`将递增的数字转换为递减的数字：

```
<c:forEach var="i" begin="0" end="10" step="1">
   <c:var var="decr" value="${10-i}"/>
    ....
</c:forEach> 
```

但是，当您`forEach`对任何类型的 Collection 进行操作时，我不知道有任何方法可以使对象以相反的顺序排列。至少，必须先将元素排序为相反的顺序，**然后**使用`forEach`.

`forEach`通过在 JSP 中执行以下操作，我已成功按所需顺序导航循环：

```
<%
List list = (List)session.getAttribute("list");
Comparator comp = ....
Collections.sort(list, comp);
%>

<c:forEach var="bean" items="<%=list%>">
     ...
</c:forEach> 
```

使用合适的比较器，您可以按任何所需的顺序遍历项目。这行得通。但是我不知道有一种方法可以非常简单地以相反的顺序迭代提供的集合。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-04-23T09:31:03.113

基于[Eddie](https://stackoverflow.com/a/712062/578821)给出的答案，我使用以下代码以相反的顺序遍历集合。

给定一个名为“list”的集合，其中存储了人员列表。

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn"%>

<%-- Keep a reference to the size of the collection --%>
<c:set var="num_people" value="${fn:length(list)}" />

<%-- Iterate through items. Start at 1 to avoid array index out of bounds --%>
<c:forEach var="i" begin="1" end="${num_people}" step="1">
    <c:set var="person" value="${list[num_people-i]}" />

    ${person.name}<br />
</c:forEach> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-03T02:22:48.203

您还可以考虑滚动一个自定义 JSTL 函数，该函数返回列表的反向副本，由以下内容支持：

```
public static <T extends Object> List<T> reverse(List<T> list) {
    List<T> copy = Collections.emptyList();
    Collections.copy(copy, list);
    Collections.reverse(copy);
    return copy;
} 
```

不适用于集合，但正如另一个答案中提到的，排序的概念对于某些集合来说有点模糊。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-23T15:30:43.083

我们可以用一点技巧来做到这一点：-

```
<c:forEach begin="1" end="10" var="i" step="1">
     <c:set var="j" value="${10-i+1}" scope="page"></c:set>
     <c:out value="${j}"/>
</c:forEach> 
```

输出将是：- 10 9 8 7 6 5 4 3 2 1

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-09T20:03:24.333

您可以[在将 Collection](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#reverse(java.util.List))添加到模型之前对其进行反转。

这也意味着您无需在视图层中执行任何操作即可满足您的要求。

# testing - 我可以使用兼容 IE7 的 IE8 来测试网站吗？

> ID：712055
> 
> 赞同：12
> 
> 时间：2009-04-02T23:40:01.060
> 
> 标签：testing, internet-explorer-8, internet-explorer-7, cross-browser

作为开发人员，我可以安全地升级到 IE8 并使用其 IE7 兼容模式来测试网站在 IE7 中的外观吗？对于IE6，我有一个虚拟机，很不方便。我不想升级到 IE8，然后现在为 IE7 准备另一个虚拟机。

还是 IE7 兼容模式真的不同，我不能依赖它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T23:59:17.520

IE8 中的兼容模式不是 IE7 的 100% 仿真。安全更改没有版本化，一些 DOM 操作没有版本化。查看 Microsoft 的此博客文章以获取更改列表。

[http://blogs.msdn.com/ie/archive/2009/03/12/site-compatibility-and-ie8.aspx](http://blogs.msdn.com/ie/archive/2009/03/12/site-compatibility-and-ie8.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-03T00:00:39.997

微软正在开发一种名为[Expression Web SuperPreview](http://www.microsoft.com/downloads/details.aspx?FamilyID=8e6ac106-525d-45d0-84db-dccff3fae677&displaylang=en)的工具，以便更轻松地测试不断增长的浏览器群。

[Long Zheng](http://www.istartedsomething.com/20090318/expression-web-superpreview-cross-browser-testing/)和[The Expression Web Team](http://blogs.msdn.com/xweb/archive/2009/03/18/Microsoft-Expression-Web-SuperPreview-for-Windows-Internet-Explorer.aspx)描述的博客条目。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T00:06:14.447

您应该尝试使用[**IE Tester**](http://www.my-debugbar.com/wiki/IETester/HomePage) - 一个救命稻草。它可以让您在一个程序中查看 IE 5.5、6、7、当前安装版本和 8 beta 的网站 - 每个浏览器版本都加载到它自己的选项卡中，并且可以是分屏等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T23:44:20.783

MSHTML 代码已更改。IE7 兼容模式应该非常接近 IE7，但是……代码改变了。我仍然会测试两者。

Microsoft提供了可用于测试的[Virtual PC 映像。](http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T23:57:04.793

我知道 IE7 和 IE8（兼容模式）并不相同。就我而言，这是在 IE7 中出现的 CSS 问题，而不是在 IE8 中

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T23:44:58.100

我使用 IE7 兼容模式，它对我有用。您是否尝试过 Multiple IE [http://tredosoft.com/Multiple_IE](http://tredosoft.com/Multiple_IE)而不是使用虚拟机？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T00:56:32.717

不要忘记 Firefox 的 IETab... 让事情变得更简单。尽管 IIRC，您只能使用它来测试系统上的默认版本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-14T11:16:13.583

看来微软终于发布了 Expression Web SuperPreview

可以在这里下载

[http://www.microsoft.com/downloads/details.aspx?FamilyID=8e6ac106-525d-45d0-84db-dccff3fae677&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=8e6ac106-525d-45d0-84db-dccff3fae677&displaylang=en)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-18T22:17:55.440

另一个答案中列出了多个 IE。

“多个 IE”有一个更新的称为[Internet Explorer 集合](http://finalbuilds.edskes.net/iecollection.htm)的继任者。

# c# - appSettings 和 ConfigurationManager.AppSettings 问题

> ID：712068
> 
> 赞同：18
> 
> 时间：2009-04-02T23:46:46.973
> 
> 标签：c#, asp.net, asp.net-mvc

我搜索了该站点，虽然我发现了一些非常有用的信息，但我无法弄清楚我的代码发生了什么。我有以下 web.config：

```
<?xml version="1.0"?>
<configuration>
  <system.web>
  </system.web>

  <system.webServer>
  </system.webServer>

  <appSettings>
    <add key="APIKey" value="23e24c73feed7ca0f6afd876575842de"/>
    <add key="Secret" value="################################"/>
    <add key="Callback" value="http://localhost:55994/"/>
    <add key="Suffix" value="My3Words"/>
  </appSettings>
</configuration> 
```

我已经剪掉了 system.web 和 system.webServer 中的内容，但这是在 ASP.NET MVC 应用程序中生成的默认设置。

我正在尝试访问该部分中的密钥（这是一个使用 FB Connect 的简单 Facebook 应用程序）。

在我的代码中，我有以下行：

```
return ConfigurationManager.AppSettings["APIKey"]; 
```

它返回一个空值。我不太明白发生了什么。我有必要条件：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Web.Mvc.Ajax;
using System.Configuration; 
```

在我的 .cs 文件的顶部。我非常怀疑键盘后存在错误（即在我的大脑中），但我无法解决这个问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-03T07:39:35.650

您是否尝试过使用[WebConfigurationManager](http://msdn.microsoft.com/en-us/library/system.web.configuration.webconfigurationmanager.aspx)：

```
return System.Web.Configuration.WebConfigurationManager.AppSettings["APIKey"]; 
```

这是在 Web 应用程序中使用配置文件的首选选项 - 它处理嵌套配置文件等内容。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-15T23:12:30.460

Visual Studio 为 MVC 创建 2 个 web.config 文件。1 在根目录下，另一个在 Views 文件夹中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-19T16:49:32.350

您确定您使用的是正确的 Web.Config 文件吗？您可能希望使用应用程序根目录中的那个，而不是 Views 目录中的那个。

[ASP.NET MVC 和两个 Web.config 文件](https://stackoverflow.com/questions/517086/asp-net-mvc-and-two-web-config-files)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T00:13:48.217

检查以确保 web.config 文件的构建操作为“无”。如果构建操作是“嵌入式资源”，我已经看到了这个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T00:17:31.017

您的 machine.config 是否具有必需的 AppSettings 部分。它应该看起来像（版本号会不同）：

```
<configuration>
   <configSections>
       <section name="appSettings"
          type="System.Configuration.NameValueFileSectionHandler, System,          Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
   </configSections>
</configuration> 
```

您确定您使用的是正确的 web.config 吗？[ConfigurationManager.AppSettings.Settings](http://msdn.microsoft.com/en-us/library/system.configuration.appsettingssection.settings.aspx)是什么样的？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-01T19:01:25.077

我的解决方案中有两个项目首先我在类库项目中添加 app.config 文件，所有实例都是从控制台应用程序调用的我在类库项目的配置文件中添加了这些条目

```
<appSettings> 
<add key="userName" value="user2" /> 
<add key="emilsLimit" value="50" /> 
</appSettings> 
```

当我在类库项目中的一个类中获取这些时它抛出空异常但是当我从类库项目中删除 app.config 并添加到控制台项目中时它可以工作。干杯

注意：控制台中添加了类库项目引用

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T06:12:52.677

我敢打赌，您在编写时使用正确的语法来访问它们：ConfigurationManager.AppSettings["Key1"];

尝试这种格式的网络配置

```
<?xml version="1.0"?>
<configuration xmlns="http://schemas.microsoft.com/.NetConfiguration/v2.0">
<appSettings>
    <add key="Key1" value="Val1"/>
    <add key="Key2" value="Val2"/>
</appSettings>
<connectionStrings>
    ......
    ......
</connectionStrings>
<system.web>
    <sessionState mode="InProc" timeout="20"/>
    <authorization>
        ......
    </authorization>

    <pages>
        <namespaces>
            <add namespace="System.Data"/>
            <add namespace="System.Data.SqlClient"/>
            <add namespace="System.IO"/>
        </namespaces>
    </pages>
    <customErrors mode="Off"/>
    <compilation debug="true"/></system.web>
</configuration> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-03T00:13:31.947

你有没有尝试过：

```
return ConfigurationManager.AppSettings.Get("APIKey"); 
```

# powershell - Out-File -force，不创建中间目录

> ID：712074
> 
> 赞同：9
> 
> 时间：2009-04-02T23:51:18.897
> 
> 标签：powershell

我的代码是：

```
$path = "c:\no-such-dir\00.txt"
"foo" | Out-File -force -filePath $path 
```

错误：

> 输出文件：找不到路径“C:\no-such-dir\00.txt”的一部分

帮助文件-full

> 例如，Force 将覆盖只读属性或创建目录以完成文件路径，但不会尝试更改文件权限。

所以它似乎应该创建'no-such-dir'，但它没有。发生什么了？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-03T00:26:25.973

这看起来像一个错误。根据[http://www.vistax64.com/powershell/62805-out-file-force-doesnt-seem-work-advertised.html](http://www.vistax64.com/powershell/62805-out-file-force-doesnt-seem-work-advertised.html)，此问题已在 MS Connect 上提交。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-03T00:42:29.770

正如 Micheal 所提到的，这看起来像是一个错误（或虚假广告！）。

**编辑：**我最初认为 ">" 运算符有效，但我在测试中犯了一个错误。它没有，正如人们所期望的那样。但是，您可以尝试使用 new-item 代替：

```
new-item -force -path $path -value "bar" -type file 
```

不完全一样，但你可以创建一个简单的函数来做你想做的事：

```
function Out-FileForce {
PARAM($path)
PROCESS
{
    if(Test-Path $path)
    {
        Out-File -inputObject $_ -append -filepath $path
    }
    else
    {
        new-item -force -path $path -value $_ -type file
    }
}
} 
```

# asp.net-mvc - 如何在 ASP.NET MVC 中向用户提供操作“成功”反馈？

> ID：712077
> 
> 赞同：5
> 
> 时间：2009-04-02T23:52:23.260
> 
> 标签：asp.net-mvc

假设我们有一个编辑视图来编辑我们的数据，我们想让用户知道他们的编辑结果，即。确认它确实已成功保存在模型上。

一种解决方案是在 Edit Controller 操作方法中将消息分配给 ViewData，然后使用 View 将消息显示回给用户。

例如在 Edit Controller 操作方法中：

```
ViewData["EditResult"] = "All is well in the world."; 
```

...在视图中的某个地方：

```
<%= ViewData["EditResult"] %> 
```

这很好也很简单，但这是从控制器向视图提供反馈的最佳方式吗？还有什么其他选择，因为我似乎将演示类型的东西放在控制器中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T23:57:31.237

一个非常简单的方法是将一些布尔值或其他状态标志作为模型数据的一部分传递给视图；然后，视图可以按照它认为合适的方式呈现该信息。

或者，您可能需要考虑为成功与失败分别提供不同的视图，因为您很可能在每种情况下都呈现完全不同的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T00:01:30.213

通常我有一个显示特定模型状态的显示操作。成功更新后，我将重定向到模型特定实例的 Show 操作并显示更新的信息。请注意，没有任何“成功”消息，但更改会反映在更新的模型状态中。这是我通常尝试做的：向用户显示他们操作的结果，而不是指示操作成功的消息。

# python - 使用 matplotlib 调整文本和条宽的条形图大小 - python

> ID：712082
> 
> 赞同：1
> 
> 时间：2009-04-02T23:54:34.893
> 
> 标签：python, matplotlib

我正在使用 matplotlib-0.91（第一次）创建一个条形图，但是 y 轴标签被切断了。如果我将图形的宽度增加得足够多，它们最终会完全显示出来，但是输出的大小不正确。

有什么办法处理这个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T08:23:48.447

我想我遇到了类似的问题。

看看这是否有助于调整标签的字体大小：

```
import matplotlib.pyplot as plt
import matplotlib.font_manager as fm

fontsize2use = 10

fig = plt.figure(figsize=(10,5))
plt.xticks(fontsize=fontsize2use)  
plt.yticks(fontsize=fontsize2use)    
fontprop = fm.FontProperties(size=fontsize2use)
ax = fig.add_subplot(111)
ax.set_xlabel('XaxisLabel')
ax.set_ylabel('YaxisLabel')
.
<main plotting code>
.
ax.legend(loc=0, prop=fontprop) 
```

对于条形宽度，如果您使用[pyplot.bar](http://matplotlib.sourceforge.net/api/pyplot_api.html?#matplotlib.pyplot.bar)看起来您可以使用 width 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T22:07:00.743

看看[`subplots_adjust`](http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.subplots_adjust)，或只是使用。[`axes`](http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.axes)`([left,bottom,width,height])`

# actionscript-3 - arsort 与 Actionscript 3

> ID：712094
> 
> 赞同：0
> 
> 时间：2009-04-03T00:01:55.250
> 
> 标签：actionscript-3, arrays

如何对索引数组进行排序并在 Actionscript 3.0 中维护索引关联。Array.sort(); 无论如何，方法似乎都会重新索引数组。基本上我需要在 Actionscript 中重新创建[arsort](http://us2.php.net/manual/en/function.arsort.php) php 函数。可能的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T00:40:02.553

为此，您需要一个关联数组（即 an `Object`），因为当索引为整数时，flash 会自动将它们从 0 重新排序为*n*，正如您可能已经注意到的（这在您的情况下可能很烦人，但有其原因）。

如果要跟踪键值，一个技巧是将索引存储在数组中每个项目的值中：

```
var array:Object = new Array();

array.push({index:0,name:"Tom"});
array.push({index:1,name:"Andrew"});
array.push({index:2,name:"Mark"});

array.sortOn("name");

for each(var item:Object in array)
    trace(item.index, item.name); 
```

这将追踪：

```
1 Andrew 
2 Mark 
0 Tom 
```

`Vector`nb 如果您的值是强类型的 a而不是a ，这可以得到改善`Array`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T00:43:55.557

我想您可能正在寻找[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/Array.html#sortOn()](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/Array.html#sortOn())

# vba - 在运行时在 word vba 中创建一个新的选择对象

> ID：712098
> 
> 赞同：1
> 
> 时间：2009-04-03T00:04:25.837
> 
> 标签：vba, ms-word, selection

我之前问过这个问题，但我认为我不够清楚。

我需要编写一个 Word VBA 宏，它将提示用户在宏开始运行后通过突出显示它来选择一些文本，然后处理新的选择。此过程将在宏内重复未知次数。

我唯一的问题是弄清楚如何让 VBA 宏“暂停”并允许用户进行此选择。如果有人熟悉 AutoCAD VBA，我正在寻找等效的`AcadSelectionSet.SelectOnScreen`方法。这似乎如此明显和根本，但我在 Microsoft 帮助文件或在线搜索中找不到任何告诉我如何执行此操作的内容。如果可以的话请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T00:49:15.823

您是否应该查看对象的`WindowSelectionChange`事件`Application`？

在特殊`ThisDocument`模块中，您需要这样的代码：

```
Public WithEvents app As Application

Private Sub app_WindowSelectionChange(ByVal Sel As Selection)

MsgBox "The selection has changed"

End Sub 
```

显然`MsgBox`用有用的代码替换 并使用`Sel`参数来访问选择。`ThisDocument`如果您想尝试其他活动，请使用模块顶部的下拉菜单

要设置它，您需要在普通代码模块中使用这样的宏：

```
Sub setUpApp()

Set ThisDocument.app = ThisDocument.Application

End Sub 
```

`setUpApp`运行一次后，只要`app_WindowSelectionChange`选择更改，就会触发该事件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T12:18:12.810

您可以使用无模式表单让您的宏继续运行，直到满足特定条件：

**表单设计器：**

*   添加表格。
*   添加一个按钮。
*   添加一个标签。

**表格代码：**

```
Option Explicit

Dim m_stopHere As Boolean
Dim m_timesDone As Long

Private Sub CommandButton1_Click()

    m_timesDone = m_timesDone + 1
    m_stopHere = Not DoStuff(m_timesDone)

    Me.Caption = "DoStuff was called " & m_timesDone & " time(s)."

       If m_stopHere Then
    MsgBox "Processing finished, closing form..."
    Unload Me
   End If
End Sub

Private Function DoStuff(times As Long) As Boolean

    Dim myCondition As Boolean

    If times < 5 Then
    MsgBox "You selected: " & Selection.Text
    Selection.Collapse wdCollapseEnd
    myCondition = True
    Else
    Me.Label1.Caption = "No more selections, thanks!"
    End If

    DoStuff = myCondition
End Function

Private Sub UserForm_Initialize()
    Me.Label1.Caption = "Please select some text in Word and press the button."
End Sub 
```

**另一个代码模块：**

```
Sub StopAndGo()
    UserForm1.Show vbModeless
End Sub 
```

# ruby - “混乱多态”反模式

> ID：712105
> 
> 赞同：5
> 
> 时间：2009-04-03T00:09:53.127
> 
> 标签：ruby, refactoring, tdd, polymorphism, anti-patterns

在相当大的 Ruby 应用程序中，我们遇到给定对象由以下几项标识的情况：例如名称和 ID。这些值类型中的每一个都有不同的用途，因此并不完全等价（id 和 name 在不同的地方保留）。因此，我们最终会在应用程序中传递各种值（id、名称和对象）。这种情况至少在某种程度上似乎是一个问题，因为我们已经被错误所困扰，这些错误涉及不清楚应该将什么类型传递给给定函数。实际上，我记得这些年来在许多应用程序中看到过类似的问题代码，尽管我再也没有给它一个具体的名字。

Ruby 作为一种无类型语言，不像 C++ 那样允许经典的基于类型的多态函数。作为一种解决方法，一位同事经常使用这种代码：

```
 def initialize starting_value
    if starting_post.kindof? Foo
      @starting_id = get_id_from_foo starting_value
    elsif starting_post.kindof? Bar
      @starting_id = get_id_from_bar starting_value
    else
      raise "illegal type"
    end
  end 
```

这段代码围绕我们的代码库（不仅仅是初始化程序）的扩散导致了我所说的“混乱多态”。它通常有效，但有时会产生非常令人费解的情况。

我对此有三个问题。

*   有没有正式的名称作为反模式？“混乱的接口？”，“混乱的多态性？” 或者是其他东西？
*   人们认为这有多糟糕？
*   有系统的方法来重构它吗？我们在普通重构中遇到的挑战是，我们创建的许多测试都使用这种松散类型，因此我们必须同时更改测试和实现，因此不会产生普通基于测试的重构的脚手架效应。我认为实际上可以“加强”这种松散的多态性，并将代码抽象为一个函数，而不是立即将其撕掉。但这会是个好主意吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T00:15:42.113

您不能定义某种 get_id 方法，以便 id 返回自身，对象返回 id，并且名称执行获取 id 所需的任何操作吗？然后，您始终可以将任何您知道将是三者之一的东西规范化。如果需要，也可以使用 get_name 和 get_object 方法。

也就是说，您已经定义了一个隐式 ThingWhatHasAnID 接口，并将其设为函数参数的鸭子类型。

除非我遗漏了什么，否则我会将这种反模式称为“错过了创建抽象的机会”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T00:25:23.697

几乎任何时候你发现自己打开了一个对象的类，这表明行为应该是对象本身的一个方法。消息分发*是*基于接收者的多态的。在这种情况下，它应该是这样的：

```
def initialize starting_value
  @starting_id = starting_value.id
end 
```

定义`id`做任何`get_id_from_*`用来做的各种方法。因为你会得到一个 NoMethodError，所以非法类型的情况已经出现了。

至于叫什么，我称之为“面向对象语言的过程编程”。

# java - 如何将 Servlet 设置为在 Java 中作为主页运行？

> ID：712106
> 
> 赞同：5
> 
> 时间：2009-04-03T00:11:48.783
> 
> 标签：java, tomcat, servlets

我正在尝试使用 Java 中的 Tomcat 创建一个简单的 Web 项目。

在 web.xml 文件中，我指向了一个 servlet，当有人访问时我想运行它`http://localhost:8080/MyProject`，所以我使用`/`了 URL 模式。这行得通，但是它的缺点是所有指向 html 和 javascript 文件的链接都被传递到主 servlet 而不是适当的文件本身。将 Url 模式从`/`to更改为`/Home`或`/Main`修复它。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-03T01:58:50.883

为什么不使用[`<welcome-file>`](http://edocs.bea.com/wls/docs61/webapp/web_xml.html#1026980)web.xml 的属性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T11:22:02.463

您可以在根目录的 index.jsp 中设置转发，并将其重定向到您的 servlet。

例如，在您的 web.xml 中，您将定义您的 servlet 映射到某个已知路径，例如“/home”。

在您的 web-inf 根目录下的 index.jsp 中，您可以编写

```
<jsp:forward page="/home" /> 
```

如果您决定采用此路线，请查看此以获取更多信息[http://java.sun.com/products/jsp/tags/syntaxref.fm9.html](http://java.sun.com/products/jsp/tags/syntaxref.fm9.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T00:29:32.627

将您的 servlet 移动到 webapps/ROOT，因为这是 Tomcat 中的默认根上下文。

或者，编辑 context.xml 并在那里设置根上下文路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-14T23:01:02.563

去掉 :8080 和应用程序名称，将应用程序映射到任何地方，使用 Apache 作为前端，ModJk 与幕后的 Tomcat 服务器通信。毕竟，写 :8080 也不像拥有一个真正的主页，不是吗？

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-03T00:32:55.053

如果它是解包的，那么你的所有目录 ROOT 或者如果它被打包，则为战争 ROOT.war。

# .net - 在 .net 中，为什么抛出异常计算量很大？

> ID：712108
> 
> 赞同：3
> 
> 时间：2009-04-03T00:12:00.267
> 
> 标签：.net

在 .net 中，为什么抛出异常计算量很大？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T00:14:45.063

诸如在异常点计算完整调用堆栈之类的事情需要时间和计算。

但是，在某些地方 .NET 比 C++ 做得更好，因为它不必像 C++ 异常处理程序那样跟踪需要清理的内存。

有关更多详细信息，我推荐Rico Mariani关于此主题[的博文。](http://blogs.msdn.com/ricom/archive/2003/12/19/44697.aspx)

# language-agnostic - 合同工作时常见实用应用程序的版权/许可注释

> ID：712110
> 
> 赞同：3
> 
> 时间：2009-04-03T00:13:21.573
> 
> 标签：language-agnostic, licensing

我正在做一些合同工作，他们需要我正在编写的应用程序的源代码。对于我为客户编写的新文件，我将版权授予他们。但是，我正在使用我自己开发的一些实用程序文件（用于操作系统抽象，如线程）（而不是客户的一角钱）。我想保留将这些文件用于我自己未来的项目或未来的承包工作的权利。

我的问题是，我在源代码文件的顶部提供什么类型的许可和版权声明？我正在考虑类似于 Boost 软件许可证的东西：

> Copright (c) 2009 [我的法定姓名]
> 
> 特此授权 [客户法定名称] 免费使用、复制、修改、展示、分发、执行和传输本软件，并准备本软件的衍生作品，并允许第三方该软件是为此而提供的，所有这些都受以下条件的约束：
> 
> 软件中的版权声明和整个声明，包括上述许可授予、此限制和以下免责声明，必须全部或部分包含在软件的所有副本以及软件的所有衍生作品中，除非此类副本或衍生作品仅以源语言处理器生成的机器可执行目标代码的形式存在。
> 
> 本软件按“原样”提供，不提供任何形式的明示或暗示保证，包括但不限于对适销性、特定用途适用性、所有权和非侵权性的保证。在任何情况下，版权持有人或任何分发该软件的人均不对由该软件或该软件的使用或其他交易引起或与之相关的任何损害或其他责任负责，无论是合同、侵权或其他方面的责任。

此许可和版权声明是否足够？有没有类似情况的人可以发布他们的许可证？

**编辑**

我现在关心的文件非常简单——只是围绕特定于操作系统的东西（例如线程和互斥体）的薄包装。这不是我将作为独立产品出售的库，也不是我担心客户将来使用或分发的东西。

如果我要制作一个我打算出售的图书馆，我会使用不同的许可证（我很可能会为此联系律师）。

在项目中使用这些文件很方便，我不想让客户声称如果不向他们支付特许权使用费，我就无法在未来的项目中使用该软件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T00:16:18.460

不要听起来老套，但你最好的选择是咨询律师。不应该超过几百块钱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T00:17:13.640

这是特定于语言环境的，但您的版权应该足够了。但是，这并不能阻止他们重新分发您的代码。

这可能是设计使然，但我想我会提到它，以防万一。

* * *

编辑：阅读您的评论后，如果可能的话，我会提前与您的客户协商。最好提前告诉他们，您有一些想要包含的代码，并且将免费包含许可和重新分发，但您将保留对它的权利。如果他们对此不满意，您可以协商您的时间以独家方式为他们编写新鲜的新代码。

如果可以选择，我发现我曾经合作过的每个客户都会很乐意使用有效、经过测试并且免费的东西，而不是他们需要付费开发的东西，如果不是的话伤害他们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T00:55:55.277

如果您想比较的话，MIT 许可证非常相似。不需要许可证副本的二进制文件也不例外，但我从未听说过会阻止任何人。

您还可以考虑公共领域的奉献精神。

无论许可证是什么，客户的律师都可能希望让自己满意，即他们很乐意将具有该许可证的软件包含在他们的产品中。特别是，他们可能需要知道如果他们将来大幅修改您的代码会发生什么，并希望对其修改后的版本拥有版权。

如果您故意向他们出售擦除硬盘并向所有客户发送死亡威胁的代码，我认为“原样”条款实际上不会使您免于承担责任；-)

# python - 是否有一个很好的 python 模块可以在 C 中进行 HTML 编码/转义？

> ID：712113
> 
> 赞同：0
> 
> 时间：2009-04-03T00:14:23.630
> 
> 标签：python, escaping, python-module

有 cgi.escape 但似乎是用纯 python 实现的。似乎大多数像 Django 这样的框架也只是运行一些正则表达式。这是我们经常做的事情，所以最好让它尽可能快。

也许 C 实现不会比一系列正则表达式快多少？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T00:34:50.103

请参阅基于[libxml2的](http://xmlsoft.org/)[lxml](http://codespeak.net/lxml/)。虽然它主要是一个 XML 库，但[也提供 HTML 支持](http://codespeak.net/lxml/parsing.html#parsing-html)。

# python - 在 debian 上通过 crontab 执行 python 脚本变得疯狂！

> ID：712124
> 
> 赞同：6
> 
> 时间：2009-04-03T00:18:21.797
> 
> 标签：python, debian, cron, crontab

这是我的 crontab 文件的样子：

```
* * * * *  root /usr/bin/python /root/test.py >> /root/classwatch.log 2>&1 
```

这就是我的 python 脚本的样子：

```
#!/usr/bin/python
print "hello" 
```

cronjob 创建日志文件。但它是空的。我也很确定 python 文件没有被执行。

感谢任何帮助！过去 4 小时我一直在玩它，但没有运气。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T06:56:02.603

有两种方法可以创建 crontab——每个用户或全局。对于全局 crontab (/etc/crontab)，您指定用户，如下所示：

```
# m h dom mon dow user  command
17  *   *   *   *   root        cd / && run-parts --report /etc/cron.hourly 
```

对于您不使用的用户 crontab，根据：

```
aj@wherever:~$ crontab -l
0 * * * * /home/aj/bin/update-foobar 
```

通过 #! 运行 python 脚本 表示法，您只需使脚本可执行（chmod 755 /root/test.py），然后直接调用它，例如：

```
/root/test.py 
```

如果您不想这样做，您可以通过 python 解释器手动运行它，例如：

```
/usr/bin/python /root/test.py 
```

这假定您正在运行的任何用户（即 /etc/crontab 中的用户，或您正在运行 crontab -e 的用户）都有权查看 python 脚本 - /root 可能无法访问普通用户，例如.

您可以通过添加以下内容来很好地了解您的脚本是否正在执行：

```
import time
time.sleep(20)   # pause for 20 seconds 
```

然后用“top”或“ps aux”或“pstree”检查python是否实际运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T00:29:27.540

更新...

将内容替换为

```
* * * * * date >> /tmp/foo 
```

这个[链接](http://209.85.173.132/search?q=cache:JZMjUwxr_8AJ:ubuntuforums.org/showthread.php%3Ft%3D847446+debian+cron+missing+output&cd=8&hl=en&ct=clnk&gl=us)有帮助吗？

删除它应该创建的文件。它会回来吗？我以为每个用户都有自己的 crontab 文件，所以上线的用户是怀疑的。
是否有人对你开了个玩笑并用无操作替换了 python 二进制文件？

我不得不认为 cron 不能正常工作，因为 echo 不起作用。您是否确保使用 echo 将输出目录更改为 /tmp？

您可以对文件进行 od（八进制转储）并查看是否将控制字符或制表符放入 cron 文件中？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-15T13:58:21.910

```
chmod 755 /root/test.py 
```

接着

```
* * * * * /root/test.py >> /root/classwatch.log 2>&1 
```

应该管用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T01:51:30.027

如果您正在编辑 /etc/crontab，则 crontab 条目是正确的 - 但是，如果您使用的是普通用户的 crontab（即 crontab -e、crontab crontabfle 等），则根条目在语法上是不正确的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T01:58:46.640

尝试只发送标准输出到日志文件，而不是标准错误和粗壮：
/usr/bin/python /root/test.py > /root/classwatch.log

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T00:36:33.123

您是否尝试将脚本放在其他地方（例如 /usr/local/bin/）？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T00:47:55.670

这在我的 RHES 4 Linux 机器上对我来说很好，如图所示（注意：我删除了 crontab 中的“root”用户名）。

我怀疑您安装 cron 作业的方式或系统上的 cron 配置有问题。你怎么安装这个？你是用的`crontab -e`还是其他方法？您是否能够成功地为 root 运行任何其他 cron 作业？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T01:20:37.310

这可能是因为之前声明的作业由于语法错误而失败。您可以粘贴整个 crontab 吗？就我所见，你的台词看起来不错。

# php - 如果函数中没有提供参数，我如何测试它是否留空？

> ID：712126
> 
> 赞同：1
> 
> 时间：2009-04-03T00:20:14.740
> 
> 标签：php

```
<?php    
/* Copyright Date
--------------------------*/
function copyright_date($creation_year) {
    $current_year = date('Y');

    if ($creation_year == $current_year || $creation_year == '') {
        echo $current_year;
    } 
    else {
        echo $creation_year . '-' . $current_year;
    }           
}
?> 
```

如果有人忘记添加参数（网站创建的年份），例如

```
<?php copyright_date(); ?> 
```

代替：

```
<?php copyright_date(2009); ?> 
```

**我将如何测试以查看参数是否留空？**在我的 if 语句中，这就是 $creation_year == '' 的用途，但由于参数不是字符串，所以它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T00:24:25.227

使用默认值`$creation_year`创建一个可选参数。`NULL`

```
function copyright_date($creation_year=NULL) { 
```

现在在函数内部只需测试是否`$creation_year`等于`NULL`，这将在不带参数调用函数时发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-07-14T01:18:27.813

其实我认为你必须使用[`func_num_args()`](https://www.php.net/manual/en/function.func-num-args.php). 在实践中它更安全。

```
function copyright_date($creation_year = NULL) {
    if(!func_num_args()) {
        // Nothing passed to the function
    }
} 
```

为什么？因为如果你设置一个默认值，假设`function copyright_date($creation_year = NULL)`你不知道是否传递了 NULL。如果您设置了默认值，也会`isset()`返回。`true`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T00:23:50.643

您可以使用该[`isset`](http://php.net/isset)功能

```
if ($creation_year == $current_year || !isset($creation_year)){
 //...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-29T08:52:52.850

如果有人需要进一步澄清答案：

您可以尝试将函数的参数设置为 NULL。这会将变量的值（在您的情况下为 $creation_year）设置为空变量。该变量已被声明，但不包含任何值。当函数被这样调用时：

```
<?php copyright_date();  ?> 
```

您的函数将执行 else 块中的代码。

如果函数以其他方式调用（提供参数），如下所示：

```
 <?php copyright_date($creation_year);  ?> 
```

提供的参数替换 NULL 值，并运行 If 块中的代码。

考虑到这一点，你还需要有这个：

```
|| $creation_year == NULL 
```

在你的 if 条件下。这将检查 $creation_year 的值是否为空。

# c# - 是否可以在连接“之前”确定 SQL 服务器设置的身份验证模式？

> ID：712127
> 
> 赞同：1
> 
> 时间：2009-04-03T00:22:00.460
> 
> 标签：c#, sql-server-2005

我知道这听起来有点倒退，但我希望能够在连接凭据之前确定 SQL 服务器的身份验证模式。这可能吗？

如果您有兴趣，我将简要解释原因...

*我们产品的大多数用户不知道、不了解甚至不关心他们的业务应用程序底层的数据库。传统上，我们只是在安装过程中静默安装 SQL Server 2005 Express，并在应用程序中嵌入 SQL 用户和密码。对于过去 10 年我们出售给的大多数“妈和爸”公司来说，这已经足够了。*

随着安全问题变得越来越突出，我们的产品开始接触到一些更大规模的用户（IT 顾问甚至他们自己的员工，他们确实对安全有所了解）一些他们自己已经存在（之前的“我们的产品”被安装）我们发现我们需要更灵活地适应现有环境的 SQL 服务器。

我对此没有意见，但我不想在安装时将有关 SQL 服务器身份验证方法、用户名和密码等的决定强加给我们的“最小公分母”用户。

如果这一切都很难，我们甚至在开始之前就失去了它们。

因此，我希望我们的应用程序能够快速轻松地确定服务器运行的模式，并适当地构建其连接字符串。

*目前我们只是在使用试错法——尝试使用 Windows 身份验证连接，连接？= 好，失败？= 尝试使用 SQL 和已知的用户名/密码，连接？= 好，失败？现在提示输入凭据，因为在这种情况下，他们必须更改了内容，因此对他们在做什么有一个想法。*

“试错”是唯一的方法，还是有办法在连接凭据之前检查身份验证模式？（使用 c# 和 sql2005 来获得它的价值）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T01:12:40.307

对于它的价值，我不确定在尝试连接之前检查身份验证模式是否会有所帮助。

如果认证方式是Windows Auth，则只有尝试连接才能知道当前用户的身份是否有登录权限。

如果身份验证模式是混合身份验证，则无法保证您指定的帐户和密码也能正常工作 - 所以我认为您别无选择，只能使用试错法。

# html - 在 HTML 中，我可以用 ✓ 打勾。有对应的 X 标记吗？

> ID：712132
> 
> 赞同：238
> 
> 时间：2009-04-03T00:23:49.037
> 
> 标签：html, encoding, symbols, entities

✓ ( `&#x2713;`) 是否有对应的 X 标记？它是什么？

* * *

## 回答 #1

> 赞同：303
> 
> 时间：2009-04-03T00:27:30.917

✓ 对应的叉`&#x2713;`号是 ✗`&#x2717;`我认为（装饰符号）。

* * *

## 回答 #2

> 赞同：174
> 
> 时间：2011-10-10T17:24:11.400

✗

```
&#x2717; 
```

✘

```
&#x2718; 
```

✕

```
&#x2715; 
```

✖

```
&#x2716; 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2014-09-03T19:23:16.060

就个人而言，我喜欢在命名实体可用时使用它们，因为它们使我的 HTML 更具可读性。因此，我喜欢使用`&check;`✓ 和`&cross;`✗。如果您不确定您想要的角色是否存在命名实体，请尝试使用[&what 搜索站点](http://www.amp-what.com/unicode/search/x)。它包括每个实体的名称（如果有的话）。

如评论中所述，`&check;`并且`&cross;`在 HTML4 中不受支持，因此如果您想针对大多数浏览器，最好使用更神秘`&#x2713;`的`&#x2717;`。我能找到的最权威的参考资料是在 W3C 网站上：[HTML4](http://www.w3.org/TR/html4/sgml/entities.html#h-24.2.1)和[HTML5](http://www.w3.org/TR/html5/syntax.html#named-character-references)。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2009-04-03T00:25:32.777

它位于键盘上的 Z 和 C 之间。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-07-10T11:30:25.230

我认为这会对每个人都有帮助。

所有代码都取自这里 - [https://www.toptal.com/designers/htmlarrows/symbols/](https://www.toptal.com/designers/htmlarrows/symbols/)

✗</p>

```
&#x2717; 
```

✘</p>

```
&#x2718; 
```

✕</p>

```
&#x2715; 
```

✖</p>

```
&#x2716; 
```

✓</p>

```
&#x2713; 
```

✔</p>

```
&#x2714; 
```

☑</p>

```
&#x2611; 
```

# email - 允许设计人员访问 DotNetNuke 中的电子邮件模板

> ID：712145
> 
> 赞同：1
> 
> 时间：2009-04-03T00:30:00.737
> 
> 标签：email, dotnetnuke

在自定义 DotNetNuke 模块中，我希望能够基于模板发送电子邮件。我希望能够为某些模板参数注入文本值。我还希望站点管理员能够编辑电子邮件内容。我希望管理员能够以一种相当简单的方式进行布局和文本。

一种解决方案是使用本地化字符串来允许自定义电子邮件内容，该电子邮件结构在某处硬编码。这是不可取的，因为它不允许管理员修改布局。

另一种解决方案是设置文本/HTML 模块以包含电子邮件内容。这样做的好处是允许管理员编辑文本和布局。它的缺点是管理员可能会使用电子邮件阅读器无法访问的 CSS 样式表中的样式。

关于如何做到这一点的任何其他想法？第三方插件或模块就可以了。对于我查看过的电子邮件模块，它们更多地是关于设置电子邮件活动。对于我看到的那些，我不确定我是否可以从我的自定义模块以编程方式发送电子邮件。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T16:24:45.200

如果您的电子邮件模板可以少于 2000 个字符，我建议您使用模块设置来存储您的数据。您可以在标准 Settings.ascx 控件上执行此操作，以覆盖 UpdateSettings 方法。2000 个字符的限制基于 TabModuleSettings.SettingValue 数据库字段大小。

```
 public override void UpdateSettings()
    {
        try
          {
            ModuleController objModules = new ModuleController();
            objModules.UpdateTabModuleSetting(TabModuleId, "EmailTemplate", this.txtEmailTemplate.Text);

            SynchronizeModule();              
        }
        catch (Exception exc) //Module failed to load
        {
            Exceptions.ProcessModuleLoadException(this, exc);
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T18:36:54.743

个人有几个选择。

1.  本地化文件。这实际上很容易由站点管理员通过 Admin -> Languages 进行修改。但是，这是针对每个门户的自定义。
2.  模块设置，但是你非常有限，2000 个字符，但可以让用户根据 mdoule 进行修改。
3.  基于 SQL 或文件，允许他们根据需要进行自定义，并提供一种简单的上传/下载/管理方式。

# c# - 按数字或字母顺序对多值数据进行排序 - LINQ to SQL 和 C#3

> ID：712147
> 
> 赞同：1
> 
> 时间：2009-04-03T00:31:05.947
> 
> 标签：c#, sql, linq, orm, sorting

我在为 LINQ 谓词提供按字母或数字排序所需的知识时遇到问题。

我正在使用具有可排序列的多值透视数据集。该列始终作为 varchar 存储在 DB 中，但是，它具有该数据类型实际是什么的查找知识。为简化起见，除了字符串之外，该列还可以包含整数。

我编写了一个通用（且有效）的排序谓词，如下所示。

```
Func<MyObject, string> sortClause = p => p.MyObjectProperties.Find(s => s.Name == theSortProperty).Value; 
```

问题是，如果我的可排序列包含数值（在数据库中存储为 varchar），我会得到

```
13
131   <-- 131 between 13 and 14!!!
14
15 
```

当然，从字母数字上看，这是正确的。

正如我所说，我以编程方式知道SortProperty 的数据类型（字符串或整数）。我希望能够指示谓词使用字母方式或数字方式进行排序。我认为没有简单的方法可以做到这一点，因为我的 LINQ to SQL 映射将该列声明为 [Column(Storage="_Value", DbType="NVarChar(MAX)", UpdateCheck=UpdateCheck.Never)]

但是我相信一定有人以前见过这个并且可以提供建议。我应该提到 NHibernate 或其他 ORM 对我来说是不可能的.....谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T01:24:00.420

实现此目的的一种方法是用零填充字符串数值，直到可能出现的最宽值的长度，然后对填充值进行排序：

```
string s = "131";
s =  s.PadLeft(8, '0'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T13:29:13.877

您可以在 LINQ 查询中使用一些 System.Convert 函数。如果您将 orderby 更改为 System.Convert.ToInt32()，您应该能够按数字排序而不是按字典顺序排序。

# html - 如何在标题（H1、H2 等）标签中定位元素？

> ID：712153
> 
> 赞同：7
> 
> 时间：2009-04-03T00:34:31.973
> 
> 标签：html, css

这似乎应该很容易，但它让我发疯！

我需要能够将按钮或其他输入元素放置在标题元素的右侧，标题元素也包含文本。

基本标记是：

```
<h3>Order Details  <input type="button" value="Refund" id="btnRefund"  /></h3> 
```

期望的结果是文本“订单详细信息”位于 H3 元素的左侧，而按钮位于右侧。显而易见的解决方案是将 align:right 添加到按钮，但这会导致按钮出现在 H3 元素之外或不与文本内联。

我尝试了 H3 元素上 position 属性的各种组合，并将文本包装在 div 和 span 标签中。

当我得到解决方案时，我确信我会踢自己。

**编辑/更新：** 我坚持使用 nickf 的答案（无论如何现在），因为我正在处理一个相当旧的系统，其中 H3 已经在外部样式表中设置了样式，包括背景颜色等。还有很多 H3 标签的实例使用时没有嵌套任何其他元素，对我来说，让 div 标签复制 H3 标签的样式来适应这一点是没有意义的。

如果我从头开始，我可能会考虑马克的答案。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-03T00:37:00.860

你必须把它放在第一位

```
<h3><input type="button" style="float: right">Order Details</h3> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T01:12:46.267

~~这不符合 w3c 标准吗？~~

你不能把整个东西包在一个div里吗？

```
<div><h3>Order Details</h3><input type="button" value="Refund" id="btnRefund"  /></div> 
```

如果您需要某种形式的统一外观，请将您的样式应用于 div，而不是 h3？将 h3 向左浮动或使用`display:inline`，使它们并排显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T04:24:17.647

好吧，这就是我在受到 Mark 和 Nick F 的启发后得到的结果。这有点杂乱无章，但更能吸引我的情感。h3 仍然是父元素，这对我来说更有意义，至少在语义上。

```
<h3 style="position:relative;">
   <span style="position:absolute;">Order Details</span>
   <span style="text-align:right;
                width:100%;
                position:absolute">
      <input type="submit" name="btnRefund" value="Refund" id="btnRefund"
         class="TextFields" /></span></h3> 
```

样式显然应该在样式表中结束。

这种方法的缺点是比尼克斯的回答要高，但实际上并不比马克的要高。还有一个小问题，就是在 h3 中放置一个不间断的空格作为最后一个字符。

# php - PHP：重试查询一定次数或直到成功

> ID：712161
> 
> 赞同：1
> 
> 时间：2009-04-03T00:38:16.053
> 
> 标签：php, loops

我正在对 Alexa API 进行查询，由于某种未知原因，该 API 偶尔会失败。当它确实失败时，我想自动重试查询，最多 10 次。

失败时，API 返回的响应包含 substring `AuthFailure`。

我可以执行什么样的循环来重试查询，直到返回的响应不包含子字符串`AuthFailure`或尝试了 10 次重试？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T00:41:54.127

你可以用一个`for`循环来做到这一点。

```
for($i=0; $i < 10; $i++) {
    $return = (Alexa call here) 
    if(!strstr($return,"AuthFailure"))
        break;
} 
```

将 10 调整为您想要的任何数字。更好的是，在其他地方使用常量`define()`'ed。这将一直运行，直到尝试次数用完或返回值不包含“AuthFailure”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T00:42:13.953

我会做这样的事情：

```
define('ALEXA_FAILED', 'AuthFailure');

$response = ALEXA_FAILED;
$tries = 0;

while ($tries <= 10 && stripos($response, ALEXA_FAILED) !== FALSE)
{
    $response = GetAlexaResponse();
    $tries++;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T03:10:48.173

就个人而言，我会将调用包装在一个函数中，例如：

```
public function getAlexaResponse($aParam)
{
   //code that does the call
   return $response;
} 
```

我将使用附加参数扩展该函数并递归调用它：

```
public function getAlexaResponse($aParam, $attempts = 10)
{
   //code that does the call
   if(!strstr($response,"AuthFailure") && ($attempt > 0)){
       $this->getAlexaResponse($aParam, --$attempts);
   }
   return $response;
} 
```

# oop - 类属性声明：private vs public

> ID：712167
> 
> 赞同：15
> 
> 时间：2009-04-03T00:42:44.497
> 
> 标签：oop, class, attributes

定义私有属性而不是公共属性有什么好处？如果我可以将它们公开，为什么我还要创建访问和修改私有属性的方法的额外工作？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-03T00:56:14.450

短期内没有，除了让 OOP 纯粹主义者不开心。

（我假设您的意思是公开原本会使用 getter/setter 的属性 - 如果您将所有属性都公开，显然会有很大的不同）。

从长远来看，这样做有一些非常好的理由。

首先，它允许您在其源头验证输入，而不是稍后必须使用硬件断点和黑魔法的组合回溯原点。

例如

```
void Foo::setWeight(float weight)
{
  ASSERTMSG(weight >= 0.0f && weight <= 1.0f, "Weights must fall in [0..1]");
  mWeight = weight;
} 
```

它还允许您稍后更改对象的行为，而无需重构客户端代码。

例如

```
void Foo::setSomething(float thing)
{
  mThing = thing;
  // 2009/4/2: turns out we need to recalc a few things when this changes..
  ...
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-03T00:45:24.180

如果您使用 getter/setter，您可以在更改或访问时执行逻辑。您可以验证输入，而不是假设它总是正确的。您可以跟踪获取值的次数。

最重要的是，它的设计很好。它使您（该类的开发人员）可以更好地控制其使用方式，并具有更大的能力来防止误用、滥用或只是某人做错事。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T00:47:59.040

因为您应该始终努力从接口保护实现。如果您公开一个属性，您就是在让客户知道您对该属性的实现情况。

这使您不仅要保留接口，还要保留实现。

此外，如果您使用一种方法，您还可以执行其他智能操作，例如验证、访问控制、会计。如果您将某个属性设为公开，则您对客户端可以使用该属性执行的操作的控制权要小得多

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T01:25:40.870

主要是因为OO的封装概念。使用 private 可以封装对对象变量的访问，从而保持对对象状态的控制。不允许外部对象更改您不知道的对象的状态。

一个简单的例子是一个 Pocket 对象。

```
 class Pocket {
 public int numberOfCoins = 10;
 private boolean haveMoney = true;

 public void giveOneCoin(){
    if(stillHaveMoney()){
     numberOfCoins--;
     if(numberOfCoins=<0){
         haveMoney=false;
     }
   }
 }

 public boolean stillHaveMoney(){
  return haveMoney;
 }

} 
```

现在想象另一个类如下：

```
class PickPockets {
   public void getSomeMoney(Pocket pocket){
      pocket.numberOfCoins=0;
   }
} 
```

当然这是一个简单的例子。然而，这表明控制对类字段/属性的访问是多么重要。想象一个具有更复杂状态控制的更复杂对象。封装使得对象的抽象性和一致性更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T00:46:24.723

如果您创建访问方法，则将实现与接口分开。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T00:48:01.397

私有属性为您提供了针对该属性的类用户的一定程度的保护。如果您使用公共属性，则需要添加更多逻辑来预先测试无效值，这可能需要更多工作，并且计算成本更高。

公共属性也“混乱”了界面。您提供的公共属性越少，您的对象就越“干净”和更容易使用。拥有一些私有属性可以为您提供灵活性，同时提供原本不存在的易用性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T00:55:13.250

在 C# 中，它是惯用的。这意味着公共字段会令人惊讶，并且会使其他人花费更长的时间来理解您的代码。

它是惯用的原因与人们给出的其他解释有关，但它是惯用的事实意味着您应该更喜欢属性而不是公共字段，除非有令人信服的理由使用字段。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-27T02:45:06.550

通常，仅当您认为有必要时，您才会对要在程序逻辑中隔离的字段使用 Private 声明。

公共声明使您可以更好地控制自己的程序流程；您可以随时更改公共字段。你是家里的男人。

那么，为什么大多数人会自发地对 Private 声明做出 BIG YES 的回应？

因为：

*   在大学里，他们被教导“就那样”去做。（最谨慎的理由）
*   他们最终愚蠢地立即假设您正在构建代码库，构建软件组件供他人使用，或者正在从事某些密码学实现。只有在这些情况下，您才不确定您的领域会发生什么。

底线是惊人的“商业”！如果你在“卖”它，那就去私有化，否则就做你喜欢的事。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-08-24T12:24:37.860

如果所有属性都是私有的，那么从长远来看你会更好。这包括不使用吸气剂。如果您正在访问对象的属性，那么您正在破坏封装，并且根本没有真正进行 OOP。到那时，构建类的大部分理由都被浪费了。为什么要建造一座城堡来抵御入侵者，然后让所有的门都敞开？或者（与吸气剂）总是根据要求欢迎入侵者。

“得墨忒耳法则”和“告诉不要问”的方法已被证明可以降低生产代码中的错误率。使用公共属性不会使面向对象的纯粹主义者不高兴，它只会使用您的代码来阻止他们。

告诉您的对象如何处理它们的属性，不要向它们询问值，操作它们并将它们写回。这就像带一只狗去散步，然后一根一根地捡起它的腿让它动起来。

顺便说一句，相反，行为都应该是公开的。任何看起来应该是私有的方法实际上是另一个类的未提取方法。提取该类和方法，并在您的眼前观察您的设计简化。

# c# - 需要帮助来确定跟踪系统 (.NET) 的最佳解决方案是什么

> ID：712170
> 
> 赞同：4
> 
> 时间：2009-04-03T00:45:05.630
> 
> 标签：c#, .net, asp.net, multithreading, msmq

这是我在这里的第一个问题，我的名字是安娜！

我的问题：我的客户有几个个人设备（带 gps 的黑匣子）来定位人/车……大约有 12000 人/车使用该设备……它将他们的位置发送到指定的 IP/端口……我可以在那一边不要做任何事情......

我的工作？开发一个侦听器以捕获设备发送的所有数据并使用 .NET 将其加载到数据库中...

我的想法：使用线程的窗口服务（也许是 ThreadPool？）。所以该服务将捕获所有传入的消息，创建一个线程并放入数据库......

这是解决问题的最佳方法吗？我在这里阅读有关消息队列（MSMQ）的信息...您认为我应该使用它吗？

安娜

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T00:54:51.100

位置/时间的数量以及位置信息的传输方式（是 TCP、UDP 等）将有助于确定最佳方法。

一些问题：

*   12000 台设备多久发送一次消息？
*   位置是如何传输的？UDP？TCP？
*   你有什么可靠性要求？

从它的声音来看，拥有一个可以捕获请求并仅在内部维护一个队列以保存到数据库的服务应该可以正常工作。除非您可以更改传输端，否则我不相信 MSMQ 对您有用，即使那样，它可能有必要也可能没有必要。

* * *

编辑：鉴于下面的评论，我建议您有一个 TCP 侦听器将请求传递给线程池来处理。

我会看一下关于使用线程池设置 TCP 侦听服务器的[教程。](http://www.java2s.com/Tutorial/CSharp/0580__Network/ThreadPoolbasedTcpserver.htm)我看到的最大潜在问题是请求的数量——从你所说的来看，你将有大约 400 个请求/秒。如果没有一个非常好的系统，这将是一个挑战。线程池可能会比尝试执行自己的线程执行得更好，因为您希望避免必须不断创建新线程的开销。您肯定希望主处理循环中的延迟非常小（例如 Sleep(0)，或者根本不睡眠），因为平均每 2.5 毫秒会有一个请求。单个睡眠往往会在 14-15 毫秒的最小值处进行时间切片，因此您可能不希望在循环中进行任何睡眠。

不过，我想说的是，您可能会发现这不太好用，因为原始连接数量可能有问题。如果有任何方法可以转换为正在发送的 UDP 数据包，它可能会为您带来更好的吞吐量（以牺牲一些可靠性为代价）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T12:25:16.827

下面的代码未经测试或仅应被视为指导。它使用线程池来处理所有事情。我将所有内容都放在同一个文件中，仅用于示例。您应该将所有内容分成几个文件。

重要的是不要让所有客户端直接保存到数据库，因为这会使线程池饿死。尝试使用“MaxThreads”常量来获得一个适用于您的数据库/服务器的值。

还要记住，我在下面根本不处理任何异常。例如，您需要在 BeginRead、EndRead 和 TcpListener 方法上处理 SocketException。

我尝试使用最少数量的线程同步锁，代码应该非常有效。瓶颈很可能是数据库。

```
using System;
using System.Collections.Generic;
using System.Net;
using System.Net.Sockets;
using System.Threading;

namespace FastListener
{
    /// <summary>
    /// Example position class, replace with a real definition
    /// </summary>
    public class Position
    {
        public int X { get; set; }
        public int Y { get; set; }
    }

    /// <summary>
    /// Needed to be able to pass socket/buffer info
    /// between asynchronous requests.
    /// </summary>
    public struct ClientContext
    {
        public Socket socket;
        public byte[] buffer;
    }

    class Program
    {
        /// <summary>
        /// Positions received from mobile clients but not yet saved
        /// into the database.
        /// </summary>
        private readonly Queue<Position> _positions = new Queue<Position>();

        /// <summary>
        /// Number of threads currently saving stuff to the database.
        /// </summary>
        private int _poolThreads;

        /// <summary>
        /// Maximum number of threads that can save info to the database.
        /// </summary>
        private const int MaxThreads = 10;

        static void Main(string[] args)
        {
            new Program().Start();
        }

        private void Start()
        {
            TcpListener listener = new TcpListener(IPAddress.Any, 1343);
            listener.Start(50);
            listener.BeginAcceptSocket(OnAccept, listener);
        }

        // Listener got a new connection
        private void OnAccept(IAsyncResult ar)
        {
            TcpListener listener = (TcpListener) ar.AsyncState;

            // It's very important to start listening ASAP
            // since you'll have a lot of incoming connections.
            listener.BeginAcceptSocket(OnAccept, listener);

            // I recommend that you create a buffer pool to improve performance
            byte[] buffer = new byte[400];

            // Now accept the socket.
            Socket socket = listener.EndAcceptSocket(ar);
            StartRead(new ClientContext {buffer = buffer, socket = socket});
        }

        private void StartRead(ClientContext context)
        {
            // start reading from the client.
            context.socket.BeginReceive(context.buffer, 0, 400, SocketFlags.None, OnReceive, context);
        }

        // Stuff from a client.
        private void OnReceive(IAsyncResult ar)
        {
            ClientContext context = (ClientContext) ar.AsyncState;

            int bytesRead = context.socket.EndReceive(ar);
            if (bytesRead == 0)
            {
                // Put the buffer back in the pool
                context.socket.Close();
                return;
            }

            // convert bytes to position.
            // i'll just fake that here.
            Position pos = new Position();

            // Either handle the request directly
            if (_poolThreads < MaxThreads)
                ThreadPool.QueueUserWorkItem(SaveToDatabase, pos);
            else
            {
                // Or enqueue it to let a already active
                // thread handle it when done with the previous position
                lock (_positions)
                    _positions.Enqueue(pos);
            }

            // Don't forget to read from the client again
            StartRead(context); 
        }

        // will save stuff to the database.
        private void SaveToDatabase(object state)
        {
            // Could use Interlocked.Increment, but not really vital if 
            // one more more extra threads are saving to the db.
            ++_poolThreads; 

            Position position = (Position) state;
            while (true)
            {
                // IMPLEMENT DB SAVE LOGIC HERE.

                // check if another position is in the queue.
                lock (_positions)
                {
                    if (_positions.Count > 0)
                        position = _positions.Dequeue();
                    else
                        break; // jump out of the loop
                }
            }

            --_poolThreads;
        }
    }
} 
```

# paypal - 谁能推荐一个慈善网站的支付网关？

> ID：712171
> 
> 赞同：3
> 
> 时间：2009-04-03T00:45:22.277
> 
> 标签：paypal, payment-gateway

是否有支付网关只收取所支付款项的一部分，但前期启动费用非常低？

我想为慈善机构设置支付网关。

顺便说一句 - 仅仅通过贝宝接受捐款并避免整个支付网关的麻烦有什么害处吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T00:47:36.233

许多开源项目使用贝宝进行捐赠，我想这没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-09T04:01:39.980

对于启动，我推荐 Paypal Pro。您可以使用 Paypal Pro 解决方案创建在线捐赠表格。有了它，您的捐助者可以使用任何类型的卡付款，而不仅仅是 Paypal。如果你选择别的东西，我建议你有一个月到月的合同——作为一个初创公司，你不知道未来会怎样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T15:12:58.960

[Network For Good](https://www.groundspring.org/services/donatenow.cfm)似乎是一个不错的选择。无启动费和 30 美元/月 + 3%/交易费。该公司本身也是一个非营利组织。

对于其他建议...

[http://nonprofit.about.com/od/faqsfundraising/f/creditcards.htm](http://nonprofit.about.com/od/faqsfundraising/f/creditcards.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-08T11:00:54.890

Paypal 不会像其他支付网关那样向慈善机构收取费用，所以这是您最好的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T20:52:05.867

一些公司开始提供捐赠软件，除了每件物品的费用外，付款包括免费。Global Cloud 和 Simply Easier Payments 就是一些例子。除了与 PayPal 相同的处理费外，无需额外费用即可获得所有的花里胡哨。

# c# - 如何在后台线程中连接到远程服务器上的数据库？

> ID：712177
> 
> 赞同：0
> 
> 时间：2009-04-03T00:47:02.333
> 
> 标签：c#, multithreading, linq-to-sql

我有一个 Windows 窗体，我在其上显示来自本地数据库的数据。

我还想连接到远程数据库，并从那里显示一些其他数据。但是，这个远程数据库可能已关闭或速度很慢。

我不希望 UI 在尝试连接到此远程数据库时冻结。

所以对线程或线程安全一无所知，这是我笨拙的例子：

```
RemoteDataContext rdt;

private void GetRemoteDataContext() {
    rdt = new RemoteDataContext(RemoteServerConnectionString);
}

private void FillFromRemoteDataContext() {
   lblTest.text = rdt.TestTable.First().TestField;
}

private void Form1_Shown(object sender, EventArgs e) {
    Thread t = new Thread(new ThreadStart(new delegate {
        try {
            GetRemoteDataContext();
            FillFromRemoteDataContext();
        } catch { }  // ignore connection errors, just don't display data
    );
    t.Start;
} 
```

所以你应该能够从中看出我想要实现什么。

我的问题是，正确的方法是什么？

* * *

**更新：**谢谢大家，现在我有（在`Form1Shown`）：

```
BackgroundWorker bw = new BackgroundWorker();
bw.DoWork += new DoWorkEventHandler((sender, e) => {
    e.Result = null;
    try {
        e.Result = new RemoteDataContext(RemoteServerConnectionString);
    } catch { } // ignore connection errors, just don't display data
});
bw.RunWorkerCompleted += new RunWorkerCompletedEventHandler((sender, e) => {
    if (e.Result != null) {
        rdt = (RemoteDataContext)e.Result;
        FillFromRemoteDataContext();            
    }
});
bw.RunWorkerAsync(); 
```

它有效，据我了解，应该没有与线程相关的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T00:50:17.833

您可能想检查[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)类，它会使事情变得容易得多。

您只需为实际工作、进度报告和线程完成指定委托。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T01:20:05.047

这就是我的做法，但是当您的数据库连接成功并且您需要更新您的 UI 时，您将遇到的问题是跨线程访问。正如 CMS 建议的那样，您可以使用 BackgroundWorker 类并让它为您处理跨线程编组。我倾向于进行更细粒度的控制，我会将您的示例实现为：

```
RemoteDataContext rdt;
private void GetRemoteDataContext() {    
   rdt = new RemoteDataContext(RemoteServerConnectionString);
}
private void FillFromRemoteDataContext() { 
    if (lblTest.Dispatcher.Thread != Thread.CurrentThread) {
        lblTest.Dispatcher.Invoke(delegate { lblTest.text = rdt.TestTable.First().TestField}); 
    } 
    else {
        lblTest.text = rdt.TestTable.First().TestField;
    }
}
private void Form1_Shown(object sender, EventArgs e) {    
    ThreadPool.QueueUserWorkItem(delegate {        
        try {            
            GetRemoteDataContext();            
            FillFromRemoteDataContext();        
        } catch { }  // ignore connection errors, just don't display data   
    });    
} 
```

# hibernate - Hibernate：ThreadLocalSessionContext：在调用 bind() 时已经绑定了会话

> ID：712183
> 
> 赞同：0
> 
> 时间：2009-04-03T00:48:02.020
> 
> 标签：hibernate, struts, hibernate-session

当我尝试通过以下方式使用 ThreadLocalSessionContext 时：

```
Session hsession = HibernateUtils.getSession();
ThreadLocalSessionContext.bind(hsession);
// do stuff
hsession.close(); 
```

我对每一个 Struts Action 都这样做。我做错了什么，导致我收到以下错误吗？

```
[ThreadLocalSessionContext] Already session bound on call to bind(); make sure you clean up your sessions! 
```

我检查了所有包含 ThreadLocalSessionContext.bind 的文件，并确保这些会话已明确关闭。有没有办法监控会话何时绑定到会话工厂？

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T16:34:28.717

事实证明，尽管[文档](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/context/ThreadLocalSessionContext.html)表明“如果在此类管理的会话上调用 close()，它将自动解除绑定。” 它实际上不是自动的！

您必须显式调用`ThreadLocalSessionContext.unbind(sessionFactory)`才能取消绑定会话。否则，即使会话关闭，它仍然绑定到 SessionFactory。

# sql - 需要一个 .sql 文件

> ID：712184
> 
> 赞同：0
> 
> 时间：2009-04-03T00:48:59.647
> 
> 标签：sql, mysql, mysqldump

我想知道 .sql 文件是什么样的。如何从 mysqldump 创建一个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T00:51:55.427

```
mysqldump -u <user> -p <database> > out.sql 
```

它应该提示输入密码。

# php - 从 php 中的数组构建“交叉表”或“数据透视表”

> ID：712186
> 
> 赞同：4
> 
> 时间：2009-04-03T00:50:27.583
> 
> 标签：php, arrays, performance, pivot-table

我有一个类似于以下定义的对象数组：

```
$scores = array();

// Bob round 1
$s = new RoundScore();
$s->Round_Name = 'Round 1';
$s->Player_Name = 'Bob';
$s->Score = 10;
$scores[0] = $s;

// Bob round 2
$s = new RoundScore();
$s->Round_Name = 'Round 2';
$s->Player_Name = 'Bob';
$s->Score = 7;
$scores[1] = $s;

// Jack round 1
$s = new RoundScore();
$s->Round_Name = 'Round 1';
$s->Player_Name = 'Jack';
$s->Score = 6;
$scores[2] = $s;

// Jack round 2
$s = new RoundScore();
$s->Round_Name = 'Round 2';
$s->Player_Name = 'Jack';
$s->Score = 12;
$scores[3] = $s; 
```

如果我遍历并将`$scores`对象转储到表中，它将如下所示：

```
Round_Name 玩家得分
----------------------------
第 1 轮鲍勃 10
第 2 轮鲍勃 7
第一轮杰克 6
回合 2 杰克 12

```

然而，我想要的是这样的：

```
玩家 第 1 轮 第 2 轮总计
-------------------------------------------
鲍勃 10 7 17
杰克 6 12 18

```

我不会提前知道会有多少回合或玩家，让我们说我不能改变对象的构造方式。

在 php 中执行此操作的最有效方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T02:09:08.080

据我所知，PHP 数组是作为哈希表实现的（因此查找/更新应该非常有效） 时间效率是否会成为问题，无论如何？

我会以“简单”的方式来做：

```
$table = array();
$round_names = array();
$total = array();

foreach ($scores as $score)
{
    $round_names[] = $score->Round_Name;
    $table[$score->Player_Name][$score->Round_Name] = $score->score;
    $total[$score->Player_Name] += $score->score;
}

$round_names = array_unique($round_names);

foreach ($table as $player => $rounds)
{
    echo "$player\t";
    foreach ($round_names as $round)
        echo "$rounds[$round]\t";
    echo "$total[$player]\n";
} 
```

（我知道数组没有正确初始化，但你明白了）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T02:10:35.270

如果我们可以假设：

*   数组中的分数顺序始终是按玩家姓名，然后按轮数的顺序
*   每个玩家的回合数相同

然后，我们可以做的是打印每个玩家的分数，因为我们在数组中移动，同时计算过程中的总数，但如果我们看到一个新玩家则重置它：

```
$round_count = 0;
$header_printed = false;
$current_player = NULL;
$current_total = 0;
$current_output_line = "";
foreach ($scores as $score) {
    // Check whether we have to move to a new player
    if ($score->Player_Name != $current_player) {
        // Check whether we have anything to print before
        // resetting the variables
        if (!is_null($current_player)) {
            if (!$header_printed) {
                printf("%-10s", "Player");
                for ($i = 0; $i < $round_count; $i++) {
                    printf("%-10s", "Round $i");
                }
                printf("%-10s\n", "Total");

                $header_printed = true;
            }

            $current_output_line .= sprintf("%5d\n", $current_total);
            print $current_output_line;
        }

        // Reset the total and various variables for the new player
        $round_count = 0;
        $current_player = $score->Player_Name;
        $current_total = 0;
        $current_output_line = sprintf("%-10s", $score->Player_Name);
    }

    $round_count++;
    $current_total += $score->Score;
    $current_output_line .= sprintf("%5d     ", $score->Score);
}
// The last player is not printed because we exited the loop 
// before the print statement, so we need a print statement here.
if ($current_output_line != "") {
    $current_output_line .= sprintf("%5d\n", $current_total);
    print $current_output_line;
} 
```

样本输出：

```
Player    Round 0   Round 1   Total
Bob          10         7        17
Jack          6        12        18 
```

这应该非常有效，因为它只通过数组一次。

# java - Grails/Groovy 内存泄漏故障排除？

> ID：712187
> 
> 赞同：17
> 
> 时间：2009-04-03T00:50:53.200
> 
> 标签：java, grails, groovy, jvm

我有一个 Grails 应用程序，它可以创建和销毁相当数量的域对象，而且它似乎以非常非常快的速度耗尽了 PermGen 空间。我已经完成了通常的调整（将 PermGen 提高到 256M，启用类 GC 等），但没有骰子。

有人愿意推荐一些（希望是免费或非常便宜的）工具来解决 Groovy 和/或 Java 中的这种内存消耗问题吗？或者您用来解决 JVM 内存问题的一些技术？

编辑：这是当应用程序以生产模式部署在 Tomcat 中时；我没有尝试过其他容器。即便如此，如果有一些资源来追踪问题，那就太好了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-22T21:03:56.450

你有没有尝试过

```
-XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled 
```

?

再加上增加常见的嫌疑人（`-Xmx`、和） `-Xms`，这解决了我们生产 Tomcat 上的所有 PermGen 问题，这些问题在部署应用程序后不久就发生了。之后再也没有见过另一个OOM-Exception。:-)`-XX:PermSize``-XX:MaxPermSize`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-03T08:18:47.973

我个人喜欢[VisualVM](https://visualvm.dev.java.net/)。周围肯定有更强大的工具，但这个工具具有很好的可用性与功率比。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-05-26T17:48:06.923

这也很有用： [http ://burtbeckwith.com/blog/?p=73](http://burtbeckwith.com/blog/?p=73)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T08:14:33.647

[Eclipse Memory Analyzer](http://www.eclipse.org/mat/)是一个免费工具，至少和 Yourkit 一样好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T01:21:05.327

[YourKit](http://www.yourkit.com/overview/index.jsp)是一个很好的工具，我曾多次使用它来诊断内存问题。它是商业的，但它有一个免费的评估版，可用于一次性调试。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-03T01:24:54.617

您在开发或生产中遇到的问题是什么？

如果您正在开发中，请记住 Grails 会不断地重新编译应用程序的许多方面（不仅是域更改，还包括控制器更改以及其他类）。我也有 PermGen 问题，但大多数是由我正在处理的文件的稳定重新编译触发的。您可以关闭此功能

[http://www.grails.org/FAQ#Q:%20OMG%20I%20get%20OutOfMemoryErrors%20or%20PermGen%20Space%20errors%20when%20running%20Grails%20in%20development%20mode.%20What%20do%20I% 20做](http://www.grails.org/FAQ#Q:%20OMG%20I%20get%20OutOfMemoryErrors%20or%20PermGen%20Space%20errors%20when%20running%20Grails%20in%20development%20mode.%20What%20do%20I%20do)？

如果你在生产中，那么显然你有一个更严重的问题。PermGen 内存问题归因于构建 Grails 的许多框架，包括 Spring、Hibernate，甚至 Sun 自己的 JVM。您可以尝试调整 Web 容器（Tomcat 或 Jetty）的最大堆大小。

您还可以尝试不同的 JVM 实现，例如 Oracle 的 JRockit，它应该在垃圾收集和其他效率方面要好得多。我自己从未尝试过，但由于我也在开发和广泛的 Grails 项目中，我自己可能正在购买这些问题的解决方案。祝你好运！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-04T11:46:00.557

如果在您多次热重新部署应用程序后发生这种情况，您可能会受到[这个 Grails 错误](http://jira.codehaus.org/browse/GRAILS-2544)的影响。[Tomcat FAQ](http://wiki.apache.org/tomcat/FAQ/Memory)也有几个可能导致 PermGen 泄漏的原因。

# c# - 查找与 linq 不相交的数据集

> ID：712198
> 
> 赞同：20
> 
> 时间：2009-04-03T00:58:02.573
> 
> 标签：c#, linq

```
List<int> a = 1,2,3
List<int> b = 2,4,5

output
1,3,4,5 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-04-03T01:05:32.383

诀窍是使用[except](http://msdn.microsoft.com/en-us/library/bb300779.aspx)与两个列表的交集。

这应该为您提供非相交元素的列表：

```
var nonIntersecting = a.Union(b).Except(a.Intersect(b)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T01:00:13.287

尝试和测试：

```
List<int> a = new List<int>(){1, 2, 3};
List<int> b = new List<int>(){2, 4, 5};

List<int> c = a.Except(b).Union(b.Except(a)).ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T04:48:39.930

其他方式 ：

```
List<int> a = new List<int> { 1, 2, 3 };
List<int> b = new List<int> { 2, 4, 5 };
var nonIntersecting = a.Union(b)
    .Where(x => !a.Contains(x) || !b.Contains(x)); 
```

# iis - IIS 6 的最佳反向代理？

> ID：712199
> 
> 赞同：7
> 
> 时间：2009-04-03T00:58:24.180
> 
> 标签：iis, tomcat, iis-6, reverse-proxy

我想从我们的一个 Intranet IIS 站点设置一个反向代理，以指向另一个 tomcat 服务器。例如，我希望用户浏览到“ [http://our-iis-server/friendly-url](http://our-iis-server/friendly-url) ”并将其反向代理到“ [http://our-tomcat-server/ugly-url](http://our-tomcat-server/ugly-url) ”。

什么是最好的解决方案？我把它缩小到三个选项：

*   [http://www.managedfusion.com/products/url-rewriter/documentation.aspx](http://www.managedfusion.com/products/url-rewriter/documentation.aspx)
*   [http://www.isapirewrite.com/](http://www.isapirewrite.com/)
*   [http://www.codeplex.com/IIRF](http://www.codeplex.com/IIRF)

另外，这些工具可以重写html中的链接吗？例如，如果 tomcat 服务器的 html 有类似 'a href = [http://our-tomcat-server/ugly-url/product/widget](http://our-tomcat-server/ugly-url/product/widget) ' 我需要将其更改为 'a href = [http://our-iis -server/friendly-url/product/widget](http://our-iis-server/friendly-url/product/widget) '

提前致谢。所有好的答案都将被投票！！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T03:16:49.433

IIRF 很好而且免费。~~然而，它不是一个反向代理——*反正还不是*~~。[截至 2010 年 3 月，IIRF 可以充当反向代理] 相当于 Apache 的 mod `_`rewrite，您需要 mod `_`proxy。

看起来 Helicon ISAPI Rewrite 3.0 支持代理以及 URL 重写。

免费选项包括[Windows 上的 Apache](http://www.ricocheting.com/server/apache.html)，或者您也可以将 Squid 作为代理服务器运行。规范的 Microsoft 答案是[ISA Server](http://www.microsoft.com/forefront/edgesecurity/isaserver/en/us/default.aspx)。

# asp.net - 在 Windows Server 2008 IIS7 上的 ASP.NET 中写入事件日志

> ID：712203
> 
> 赞同：29
> 
> 时间：2009-04-03T00:59:39.857
> 
> 标签：asp.net, iis, iis-7

我正在尝试使用 log4net 在 Windows Server 2008 SP1 上的 IIS7 下写入客户事件日志。但是，帐户似乎无权写入事件日志。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-04-21T21:29:44.477

问题可能是您的事件源。您必须先创建一个事件源，然后才能写入事件日志（如果您不这样做，事件日志对象会在您第一次写入日志时尝试“自动”为您创建一个）。

您必须具有更高的权限才能创建事件日志源。在我的一些网络应用程序中，我已将用于创建事件源的代码放入我的设置中（设置以管理员身份运行，因此我始终保证能够创建源）。

您只需创建一次源。之后，您的 ASP.Net 应用程序应该有足够的权限来编写指定您创建的源（或源）的条目。

您可以在设置中使用 EventLogInstaller 来创建源，或者您可以编写一个小实用程序以管理员身份调用 EventLog.CreateEventSource()。

我将向您展示两种方式：

```
 // You would do this one from within an Installer class in a setup:
        private void InstallEventLog()
        {
            EventLogInstaller logInstaller;

            //Create an instance of an EventLogInstaller.
            logInstaller = new EventLogInstaller();

            //Set the source name of the event log.
            logInstaller.Source = "TheEventSourceName";
            Installers.Add(logInstaller);
        } 

```

方法2：只需以管理员身份调用一次CreateEventSource（例如，您可以将以下代码放入控制台应用程序中，并以管理员身份运行控制台应用程序

```
 EventLog.CreateEventSource("TheSourceName", "Application"); 

```

奖励：如果您在服务器上安装了 Powershell，则可以从 Powershell 命令提示符执行此操作：（确保您以管理员身份运行 Powershell）

```
 [system.Diagnostics.EventLog]::CreateEventSource("SourceName", "Application") 

```

有帮助的跳

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-03T01:08:06.183

向事件日志授予 ASPNET 权限。

运行 -> regedit -> 浏览到

```
HKEY_LOCAL_MACHINE
   \SYSTEM
      \CurrentControlSet
         \Services
            \Eventlog 
```

右键单击选择权限并授予 ASPNET 帐户完全控制权

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-06-11T08:04:05.597

IIS 8权限解决答案

我很懒，没有在我的代码中创建一个特殊的日志，而是我使用了：

> System.Diagnostics.EventLog.WriteEntry("MyAppName", "Bla Bla SQL ERROR: "+sx.Message);

只是为了完成迈克尔的回答在 IIS8 中，运行服务器端代码时 IIS 使用的用户是：IIS_IUSRS

（实际上它更复杂，因为 IIS_IUSRS 中有虚拟帐户，但它们从该帐户获得权限，请参阅[IIS8](https://stackoverflow.com/questions/14934006/iis-iusrs-and-iusr-permissions-in-iis8)表单中的 IIS_IUSRS 和 IUSR 权限更多详细信息）

该用户只需要此注册表节点的 READ 权限：

> HKLM\System\CurrentControlSet\Services\Eventlog\Security

这样做的原因是当一个新的日志源被写入时，在创建它之前，系统想要检查它是否不存在，所以它需要读取源名称。

另外，如果您使用的是visual studio的iis express，它将在您的个人凭据下运行，因此如果您没有对上述注册表节点的读取访问权限，则在Visual Studio下调试时也需要添加它。

（如果管理员对节点具有权限并且您在该组中，这还不够，您需要以“管理员身份”运行 Visual Studio - 这仅适用于 Visual Studio 快捷方式而不是 sln 快捷方式）

另一个注意事项：如果计算机在域中，并且在编辑注册表权限时找不到 IIS_IUSRS 帐户，则可能是您在错误的“位置”中查找，在域活动目录而不是本地搜索帐户电脑）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-23T13:54:29.107

我认为@Michael Kniskern 的好例子更安全的选择是：

注册...

HKEY_LOCAL_MACHINE \SYSTEM \CurrentControlSet \Services \Eventlog \your_new_application_log

完全控制为您的应用程序创建的特定应用程序日志（在此示例中，右键单击 your_new_application_log 并在此处设置权限）。创建新的日志名称后，它将出现在嵌套在上面的 eventlog 节点下的注册表中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-04T05:39:52.090

我正在使用 IIS 10，并将池标识设置为本地系统

见参考：[https ://stackoverflow.com/a/9067391/9975799](https://stackoverflow.com/a/9067391/9975799)

# compiler-construction - 除了实际破解代码之外，了解 VM 实现的最佳方法是什么？

> ID：712219
> 
> 赞同：7
> 
> 时间：2009-04-03T01:10:28.487
> 
> 标签：compiler-construction, programming-languages, vm-implementation

我想了解有关 VM 实现和优化的更多信息。现在我正在为 JRuby 做出贡献（以一种小的方式），并且正在使用我自己的在 VM 中运行的类似 lisp 的语言实现来玩/编写。

但是，我想获得有关使用 VM 和设计它们的更多信息。除了阅读/使用现有代码之外，是否有此类信息的良好资源？我不反对这样做，我只是想知道是否还有其他我可以调查的来源。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T03:01:15.290

还检查[Lua 5.0 的实现](http://www.tecgraf.puc-rio.br/~lhf/ftp/doc/jucs05.pdf)。它被广泛认为是同类中最快的虚拟机，也是最干净和最小的实现之一。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T05:44:05.677

阅读 Anton Ertl 的作品。还有大卫格雷格。此外，您可能还想阅读[Smalltalk 蓝皮书](https://rads.stackoverflow.com/amzn/click/com/0201113716)，其中包含有关 VM 的三章。[Smalltalk 绿皮书](http://www.iam.unibe.ch/~ducasse/FreeBooks/BitsOfHistory/)也很有趣，可以在线免费使用。

如果您可以访问 ACM 数字图书馆，那么技术性较低但仍然很有趣，它是所有便携式 VM 的祖父，[UCSD Pascal](http://portal.acm.org/citation.cfm?id=1500646)。

最后，我赞同 [Lua 5.0 的实现](http://www.tecgraf.puc-rio.br/~lhf/ftp/doc/jucs05.pdf)的建议。这是一部很棒的作品。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T01:47:27.027

看看[LLVM](http://en.wikipedia.org/wiki/Low_Level_Virtual_Machine)和[Parrot](http://www.parrot.org/)。

# asp.net - 您的下一个 ASP.NET 项目的选择是什么：Web 窗体还是 MVC？

> ID：712220
> 
> 赞同：45
> 
> 时间：2009-04-03T01:10:44.213
> 
> 标签：asp.net, asp.net-mvc, webforms

假设您明天将启动一个新的 ASP.NET 网站/应用程序。你会选择 Web 表单还是 MVC，为什么？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-04-03T01:32:05.753

MVC宝贝！和jQuery！

编辑：好的，可以说我的回答需要更多信息。

我选择 MVC 的原因如下：

1.  我曾在 Rails 工作过，发现它非常高效。ASP MVC 从 Rails 中借用了很多东西，以至于在某些方面感觉就像是一个直接端口（这在我看来是件好事）。
2.  AJAX 很重要，但我*讨厌*Microsoft “Atlas” 处理 AJAX 的方法（无论这些天的产品名称是什么）。如果你打算做 AJAX，你需要了解 HTML 和 JavaScript。对您隐瞒的框架对您的伤害大于对您的帮助（IMO）。
3.  就 JavaScript 框架而言，JQuery 似乎已经占领了世界。ASPMVC 与它很好地集成在一起。我想学习它，所以这里有很好的对齐。
4.  整个“控制”模型是一个巧妙的想法，但它比表面上看起来要复杂得多。例如，在 SO 上查看有关 UserControl 如何找到其包含控件的最高级别的问题等等。控制层次抽象有漏洞。如果网格可以做你想要的开箱即用的东西，那么它们会很棒，但是很难自定义它们来做一些他们没有做的事情。市场上最好的网格控件（高度可定制的）是大型、臃肿、过于复杂的野兽。也许这表明我们应该回到 HTML 并让视图中的循环为我们做这种事情。
5.  我相信我可以在 ASPMVC 中比在 ASP.Net 中更快地构建完整、漂亮的应用程序（而且我已经掌握了几年的 ASP.Net）。看看 StackOverflow ... 使用 JQuery 在 ASPMVC 上快速构建，它快速、可扩展且使用 IMO 是一种乐趣。
6.  哦，它是完全开源的！可以阅读源代码，写博客，甚至修改然后重新分发它！

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-04-03T01:16:09.940

我会选择 MVC 仅仅是因为它被设计为可测试和可模拟的。这将是我决定的主要因素。

WebForms 的单元测试要困难得多，因为它们植根于几个很难模拟的具体类。这些包括 HttpContext、HttpResponse、HttpRequest 和 HttpCookie。

MVC 被设计为可测试的，它的 API 极大地促进了这样做。

关于 MVC 可测试性的好文章：http: [//dotnetslackers.com/articles/aspnet/ASPNETMVCFrameworkPart2.aspx](http://dotnetslackers.com/articles/aspnet/ASPNETMVCFrameworkPart2.aspx)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-10-09T21:36:25.853

就个人而言，我决定同时使用这两个...

如果是网站（在线查看），我决定使用 ASP.NET MVC。如果它是一个应用程序（具有单一目的的 Web 应用程序），我决定使用 Web 表单。

此决定完全基于案例使用和您尝试提供的解决方案。如果您对良好的 SEO 和更快的网站感兴趣，MVC 比 Web 表单更干净且速度更快。

但是，如果您在同一页面上使用了具有大量过滤器、网格、回发的复杂功能，并且您在 Web 表单方面经验丰富，那就坚持下去。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-04-03T01:29:48.410

如果我从今天开始，我可能仍然会坚持使用网络表单，因为它有大量的知识和资源。

也就是说，我真的很想尝试一下 MVC，正如其他人提到的那样，社区内的兴奋意味着很快就会有很多支持。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-04-03T06:38:31.117

MVC FTW！，原因？

*   完全控制我的 HTML
*   没有 Web 表单魔法
*   没有复杂的页面生命周期
*   更接近金属
*   使用 HTTP 是很自然的事情

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-04-03T15:36:06.690

MVC 是“当下的味道”，还是具有持久力？

我曾与 MVC 合作过，并且拥有大量的 webform 经验。我经常想知道 MVC 的持久力。

在选择其中一个时，您应该考虑这一点。您想在整个产品生命周期内支持什么？

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-03T02:39:54.530

我不能说我还没有尝试过 MVC，我真的会选择哪个。但是我有点担心将它用于一个非常大的企业项目。

滚动通过问题，您会看到 MVC 有很多问题/问题（与好的 o' WebForms 相比）。仅这一点就让我很担心。很多问题似乎是针对特殊 UI 需求的。再次没有尝试过，我不知道它有多成熟，但我还是有点担心。

也许将它用于企业项目的人可以有所启发。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-04-07T01:22:40.890

虽然 MVC 是一个新手，但使用 Web 表单模型进行设计仍然有很多好处。

*   熟悉工具
*   外观/感觉与现有项目的一致性
*   工具/设计师
*   回发
*   事件驱动
*   控制抽象
*   第三方控制有效
*   快速发展
*   声明式

[Rachel Appel 在MIX](http://en.wikipedia.org/wiki/MIX_%28Microsoft%29)上就这个主题做了精彩的演讲。您可以在此处观看视频：
在 ASP.NET Web 窗体和 MVC 之间进行选择
[http://videos.visitmix.com/MIX09/T23F](http://videos.visitmix.com/MIX09/T23F)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-04-04T16:36:11.233

我会为具有丰富业务逻辑的本地/内部网应用程序选择 Webforms，而为公共/互联网站点（博客/论坛/演示文稿/简单服务）选择 MVC。“WebForms 应用程序模型”在富状态支持至关重要的领域更可取

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-04-06T09:01:45.100

一周前，我为我们自己的产品创建了一个新网站，我对 ASP.NET MVC 感到非常高兴。一切看起来都很自然，我总是知道去哪里看看如果有什么东西不起作用或看起来不像我想要的那样。

坦率地说，我花在 CSS 上的时间最多。编码，与 jQuery 集成......花生。

OTOH，如果您不是经验丰富的开发人员，ASP.NET**不会**吸引您，因为它鼓励您一路走来控制站点的各个方面 - HTML 标记、CSS 等，这反过来意味着没有控件、拖动和删除视觉编辑等。

与传统的 ASP.NET 不同，在传统 ASP.NET 中，您需要自己处理并经常在各个页面中混合各种 UI、持久性 (DB) 和业务逻辑代码，MVC 将指导您并帮助您更一致地构建应用程序。如果您不喜欢“自以为是”的框架和/或只是想完成工作而不关心站点的结构、可维护性、可扩展性等，这不会与您同在。

请注意，如果您要构建的只是一次性的 Intranet 站点，则完全有可能不关心这一点，但对于公共 Internet 站点，我每次都会选择 MVC 而不是经典的 ASP.NET。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-04-03T01:55:37.130

MVC

......看起来很明显这就是未来的所在

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-04-04T16:43:48.267

在 ASP.NET MVC 中，您牺牲了您的控件工具箱，URL 路由已经在 ASP.NET（Web 表单）中

所以我会坚持使用 ASP.NET Web 表单（我并不是说 MVC 不好。）

jQuery，您认为 IT 人员会让您使用它吗？

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-04-03T01:15:25.933

ASP.NET MVC，因为我想学习如何使用它。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-04-03T01:15:31.703

我想和 MVC 一起去。当我使用 WebForms 时，我总是希望与抽象作斗争。

要有效地使用 WebForms，您实际上需要比使用 PHP 之类的东西更多地了解 Web 的工作原理。我发现自己使用`<asp:Literal`而不是`<asp:Label`避免`<span>`在文本周围放置 a 并运行实验室来确定事件的顺序等。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-04-03T01:21:13.827

我目前选择 ASP.NET MVC 有两个原因：1）我想学习掌握它。2) 围绕 ASP.NET MVC 已经形成了一个很棒的社区，而且每个人似乎都对它的使用非常积极。我迫不及待地想看看这一切的结局，我想成为其中的一部分。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-04-03T01:47:39.490

这真的取决于项目，因为我没有用 MVC 构建任何东西，如果项目交付时间很短，我可能会在 MVC 中发现一些障碍，这可能使我无法及时交付项目。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-04-03T01:48:24.263

我在.net 上等待 MVC 很长时间。我认为超过 90% 的人会选择 MVC 而不是 webform。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-04-03T06:52:31.347

如果这是一个个人项目，那么我会使用 MVC。只是为了更多地了解它。如果它是一个工作中的项目，我会使用 WebForms，可能与 DynamicData 结合用于管理部分。原因是我会使用我知道的技术提高工作效率，并且使用 DynamicData 作为管理部分可以让我在几分钟内完成该部分的设置。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-04-03T08:00:41.840

与往常一样，这取决于您正在开发的应用程序类型和个人情况。我们的许多内部应用程序都是在 SharePoint 中开发的，因为这是我们为 Intranet 类型应用程序选择的内部平台。

这会自动将我们限制在标准模型上的 ASP.Net 上。

我真的很想掌握 MVC，但我在工作中没有理由这样做，而且我家里有 2 个孩子和一个妻子，所以没有时间在家发展。

有时情况会迫使您动手，如果我们都可以选择使用什么平台、框架等进行开发就好了。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-04-03T14:01:52.813

我目前正在使用 jQuery 和 jQuery-ui 在 Asp.net MVC 中开发一个项目，这很有趣。

如果您熟悉 html 和 javascript（或其他 MVC 框架，如 rails），则 MVC 比旧的 webforms 更有意义。你控制输出，而不是表单上的一些模糊控制，所以如果页面上有错误或者你想改变布局，你可以:)。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-04-05T13:45:21.917

MVC。我们将重做一个 SEO 密集型和 MVC 接缝的应用程序，以便开箱即用。另外，我想和操场上的酷孩子们一起出去玩。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-12-14T19:48:46.443

我刚刚在 MVC 平台上发布了一个主要的公共站点，在之前的所有项目中都使用了 webforms。毫无疑问，这是要走的路，IMO。

对于网络表单，我发现随着时间的推移，网站往往会变得一团糟，因为您在代码隐藏中拥有处理视图逻辑和控制器逻辑的代码块。随着站点的增长和逻辑变得更加复杂，很难追踪正在发生的事情以及发生在哪里。

我发现 MVC 迫使您以更合乎逻辑的方式分解事物。控制器和模型类允许您更好地控制应用程序的组织。此外，视图更灵活，因为有一种通过模型向视图提供数据的特定方式。

此外，就像其他人提到的那样，您可以更好地控制标记和 url，并且它与 mvc 等客户端库配合得更好。

我唯一会使用 MVC 的情况是，如果我正在构建一个专注于报告某种数据的 Intranet 站点，其中 asp.net 附带的内置控件可以节省开发时间，而且我并不关心外观和感觉。我再也不会在面向公众的主要网站上使用 asp.net 网络表单了。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2010-08-22T11:11:29.003

两个都！

我正在为 MVC 做长期工作。我有太多可以在 Web 窗体中使用的代码。MVC 非常棒，但它仍然在生产力领域留下了很多东西，例如模板化的网格和列表、基本的 UI 控件（日历、自动完成等）和脚手架。这些都是 Web Forms 擅长的领域，但如果您想要精确控制并且想要保持简单，那么它们就会偏离轨道。

如果MVC 3 和 EF Code-Only愿意弥合两者之间的鸿沟，它们可能是一个**很好的结合。**大多数使用 Ruby 的人都将它用于 Rails，而 ActiveRecord 使这很容易使用。

此外，我希望看到一个支持 MS 的 MVC 并行“功能包”项目，类似于他们使用 Microsoft Ajax Toolkit 的方式，即每季度更新一次。我发现 MVC Futures 和 MVCContrib 都缺乏。但我知道他们只有这么多预算。所以，希望 MVC 3 能改变这一切。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2010-11-11T20:03:41.377

如果您正在为 Intranet 开发，只需对 ASP.NET MVC 说“不”。对于互联网，当然。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-04-04T16:42:03.420

嗯.. 目前我和你一样困惑并且即将开始建立一个新网站:)。我本来打算从 Webforms 开始，但现在我看到了人群的发展方向，我想我现在要试一试 MVC。

感谢您提出这个问题。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-04-04T16:58:04.987

现在它是 RTMed 并且现在有一些非常好的资源，我会说 ASP.net MVC 将是我的强烈偏好，但它并没有被切割和干燥。

Web 表单并没有消失，它仍然存在，它仍然受到支持，我在几个主要站点上工作并非常成功地使用了 Web 表单，所以如果有其他外部因素，例如客户偏好，或者可能是一个团队扎实的 Web 窗体经验，那么我仍然很乐意使用 Web 窗体。也就是说，我已经使用 MVC 开展了一个项目（虽然它仍处于预览阶段），我更喜欢它——我的理由与上面给出的类似，所以我不会全部重复。我会说，如果可测试性不是最好的理由，那么它肯定是最重要的:)。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2010-04-29T23:11:07.173

我会选择 MVC，因为设计师和开发人员可以在同一个项目上并行工作。设计人员可以处理视图部分（JavaScript、CSS、HTML），而后端开发人员可以处理控制器代码。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-09-24T12:24:19.900

我想做 ASP.Net MVC，尽管我对 MVC 还是很陌生。但这不是在可预见的将来。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2010-05-12T15:17:50.253

实际上，我将在接下来的几周内开始重建一个用 ASP.NET 2.0 编写的网站，并且我将使用 ASP.NET MVC。出于许多与上述相同的原因。我宁愿不使用自定义 .NET 控件并自己处理 HTML/JavaScript（使用 jQuery）。我也做过很多 Java Web 开发，所以对底层 HTML/JavaScript/CSS 有很好的理解对我来说很重要。

# python - 如何解决需要更新字典的问题

> ID：712225
> 
> 赞同：3
> 
> 时间：2009-04-03T01:14:28.180
> 
> 标签：python, dictionary, runtime-error

我需要在循环中从字典中删除 ak/v 对。在`RuntimeError: dictionary changed size during iteration`删除 k/v 并在其中一个外部循环中我尝试重新打开新腌制/更新的字典后，我腌制了字典。然而，你们中的许多人可能都知道——我得到了同样的错误——我想当它到达循环的顶部时。我不在最外层循环中使用我的字典。

所以我的问题是——有人知道如何解决这个问题吗？我想从字典中删除 ak/V 对，并在循环的下一次迭代中使用调整大小的字典。

聚焦问题并使用 Cygil 的解决方案

```
list=[27,29,23,30,3,5,40]
testDict={}
for x in range(25):
    tempDict={}
    tempDict['xsquared']=x*x
    tempDict['xinverse']=1.0/(x+1.0)
    testDict[(x,x+1)]=tempDict

for item in list:
    print 'the Dictionary now has',len(testDict.keys()), ' keys'
    for key in testDict.keys():
        if key[0]==item:

        del testDict[key] 
```

我这样做是因为我必须让一些研究助理比较两个数据集的一些观察结果，这些数据集由于名称变体而无法匹配。这个想法是从一个数据集（比如集合 A）中抛出一个名称，然后根据键匹配在另一个数据集（集合 B）中找到附加到该键的所有名称。已经确定了一个匹配项，我不想再次显示 B 的值以加快他们的速度。因为有 6,000 次观察，我也不希望他们每次重新开始工作时都必须从 A 的开头开始。但是，我可以通过让他们选择输入他们使用的 A 中的最后一个键来解决这个问题。但是一旦确定匹配项，我真的需要减少 B

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T01:28:50.877

没有代码，我假设您正在编写如下内容：

```
for key in dict:
    if check_condition(dict[key]):
       del dict[key] 
```

如果是这样，你可以写

```
for key in list(dict.keys()):
    if key in dict and check_condition(dict[key]):
        del dict[key] 
```

`list(dict.keys())`返回键的副本，而不是视图，这使得可以从字典中删除（在这种情况下，您正在遍历键的副本，而不是字典本身中的键。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T01:23:22.340

删除所有值 > 15 的键：

```
for k in mydict.keys(): # makes a list of the keys and iterate
                        # over the list, not over the dict.
    if mydict[k] > 15:
        del mydict[k] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T02:10:49.060

改变：

```
for ansSeries in notmatched: 
```

到：

```
for ansSeries in notmatched.copy(): 
```

# java - Locale.getISOCountries() 的奇怪错误

> ID：712230
> 
> 赞同：2
> 
> 时间：2009-04-03T01:17:09.547
> 
> 标签：java, gwt, locale

我正在使用这段代码：

```
 for (final String code : Locale.getISOCountries())
    {
        //stuff here
    } 
```

但是在编译时我得到这个错误：

```
[ERROR] Line 21: No source code is available for type java.util.Locale; did you forget to inherit a required module? 
```

然后是编译器错误的堆栈跟踪。

我在课程开始时做了这两个导入：

```
package com.me.example;

import java.util.Locale;
import java.util.*; 
```

有什么问题？

在 Netbeans 中，我看到了自动完成选项，并且 Locale 对象没有语法错误......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T01:34:07.137

您的设置有些棘手，以下程序对我来说很好。

```
import java.util.*;
import java.util.Locale;
public class Donors {
    public static void main (String [] args) {
        for (final String code : Locale.getISOCountries()) {
            System.out.println (code);
        }
    }
} 
```

它要求*源*代码的事实使我相信它正在尝试以某种调试模式编译或运行它。您不需要编译 java.util.* 的源代码，这很奇怪。

看看我的简单测试程序是否适用于您的环境，然后尝试寻找类似的东西（调试选项）。最后一步：使用基线 javac（不是 NetBeans）编译**您的代码。**

**更新：**

其实，我发现了一些东西。如果您正在创建 GWT 应用程序，我认为`java.util.Locale`在客户端（只有服务器端）不可用。Web 上对这个错误消息的所有引用都指向 GWT 及其在客户端的限制，毕竟这些都已转换为 Javascript 好东西，因此不能指望支持整个 Java 库集。

这个页面[在这里](http://www.ociweb.com/mark/programming/GWT.html)展示了如何在 GWT 应用程序上做 i18n，并且没有提到`java.util.Locale`除了服务器端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T01:25:15.550

看起来你的构建环境中可能有一些可疑的东西，`Locale.getISOCountries()`应该可以正常工作。尝试手动编译一个小测试程序，看看你是否得到同样的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T01:33:18.043

绝对尝试将其简化为最少的三行程序（左右），从命令行编译，然后将该类放入您的 IDE 中，看看您是否仍然收到错误，如果没有，则更改/添加一次一行，直到你有原来的失败程序，寻找导致问题的原因。我在想您的代码中的其他一些导入可能正在导入 Locale 类？为什么它会寻找源代码？

看看当你从命令行编译它时会发生什么：

```
import java.util.*;

public class LocaleTest {
  public static void main(String[] args) {
    Locale.getISOCountries();
  }
} 
```

# java - 在 Java 中获取国家/地区列表的最佳方法

> ID：712231
> 
> 赞同：24
> 
> 时间：2009-04-03T01:18:53.273
> 
> 标签：java

除此之外`Locale.getISOCountries()`，因为我已经[收到了一些奇怪的错误](https://stackoverflow.com/questions/712230/weird-error-with-locale-getisocountries)。获取 2 个字母的国家代码以及完整的国家名称的最佳方法是什么？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-04-23T16:42:35.613

查看代码片段：

```
String[] countryCodes = Locale.getISOCountries();

for (String countryCode : countryCodes) {

    Locale obj = new Locale("", countryCode);

    System.out.println("Country Code = " + obj.getCountry() 
        + ", Country Name = " + obj.getDisplayCountry());

} 
```

有关更多示例，请参阅[Java](http://www.mkyong.com/java/display-a-list-of-countries-in-java/)中的此国家/地区列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T02:05:56.093

对于一个单独的项目，我从[ISO 站点](http://www.iso.org/iso/country_codes/iso_3166_code_lists.htm)获取了国家代码数据。

请注意以下事项：

*   名称全部大写。你可能想要调整它，所以它不是。
*   这些名称并不都是简单的 ASCII。
*   这些名字并不完全是政治中立的（任何声称的国家名单都可能是不可能的）。例如，“中国台湾省”是一个名称。了解这些问题的一个很好的起点是[这篇博](http://www.koziarski.net/archives/2008/9/24/countries-and-controversies)文。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T01:58:48.963

1.  从此页面创建地图[http://www.theodora.com/country_digraphs.html](http://www.theodora.com/country_digraphs.html)
2.  将其保存到文件中（我建议使用 XMLEncoder/XMLDecoder 类）
3.  创建一个从文件加载此 Map 的包装类（我将使用延迟初始化的单例）并允许访问 get(...) 方法。
4.  对上述网页上表格的每一列重复（或使用双向地图）这些步骤。
5.  花式时间：投入一些代码以将条目包装在 Reference 对象（SoftReference？）中，以便 Map 不会抛出 MemoryErrors

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-05T04:50:42.617

您可以像下面这样使用json

1.  json解析..

    ```
    String jsonString =JSON_DATA;
    ObjectMapper mapper = new ObjectMapper();    
    try {
            JsonNode rootNode = mapper.readTree(jsonString);              

            for (JsonNode node : rootNode) {
                String countrycode = node.path("code").asText();
                String dialnumber = node.path("dial_code").asText();
                String countryname = node.path("name").asText();

            }

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
    ```

2.  json字符串在这里

    ```
    public static String JSON_DATA="

     [
       {
        "name": "Afghanistan",
        "dial_code": "+93",
        "code": "AF"
       }, 

      {
       "name": "Aland Islands",
      "dial_code": "+358",
      "code": "AX"
      },

    {
      "name": "Albania",
     "dial_code": "+355",
     "code": "AL"
     },

    {
     "name": "Algeria",
     "dial_code": "+213",
     "code": "DZ"
     },

    {
       "name": "AmericanSamoa",
       "dial_code": "+1684",
       "code": "AS"
      }]"; 
    ```

3.  或者您可以从链接下载完整的 json：[https ://gist.github.com/Goles/3196253](https://gist.github.com/Goles/3196253)

# eclipse - 停止 Eclipse 在文件保存时重新启动我的 Web 应用程序

> ID：712232
> 
> 赞同：7
> 
> 时间：2009-04-03T01:19:04.737
> 
> 标签：eclipse, jsf, facelets

我正在 Eclipse 中创建一个 JSF/Facelets Web 应用程序。我已将我的项目配置为使用由 Eclipse 启动/停止的 Tomcat (6.0) 服务器。

每当我保存文件（例如 .xhtml）时，Eclipse 都会重新启动应用程序，从而破坏我的 HTTP 会话。这很烦人，因为我经常更新我的 .xhtml 文件，而应用程序不需要重新启动来检测更改。

有没有办法阻止 Eclipse 重新启动应用程序？具体来说，我可以将 Eclipse 配置为仅在保存某种类型的文件时重新启动应用程序吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-03T06:01:18.227

在服务器视图中，双击您的 Tomcat 实例。这将打开 Tomcat 服务器的属性。由于我不确定哪个参数可以帮助您解决问题，请在后一个视图中检查以下选项：

*   自动发布，选择“覆盖默认设置”选项，发布间隔为 1 秒。
*   在服务器选项中，取消选中选项“不发布的服务器模块”和“发布模块上下文以分隔 XML 文件”。
*   在模块选项卡中，对于部署的每个模块，检查是否启用了自动重新加载。

希望这会帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T08:13:13.387

我一直使用它，它对我来说很好用。仅当您更改类或 Web 描述符时才会重新加载上下文。

在您保留 .xhtml 文件的项目结构中，这会使 eclipse 在更改时重新加载上下文？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-03T02:36:03.897

关闭“自动构建”

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-07T11:58:43.187

如果您将 Eclipse 中的构建器设置为在保存时部署，则可能会发生这种情况。右键单击您的项目 -> 属性 -> 构建器

# c# - WCF新手问题：从JavaScript调用方法

> ID：712238
> 
> 赞同：3
> 
> 时间：2009-04-03T01:21:55.137
> 
> 标签：c#, asp.net, javascript, wcf

问候！

我是 WCF 的新手，我认为它类似于 ASP.NET Web 服务，但我无法从客户端 JavaScript 调用方法。我的网络表单如下所示：

```
<form id="form1" runat="server">
   <div>
      <asp:ScriptManager ID="ScriptManager1" runat="server">
         <Scripts>
            <asp:ScriptReference Path="~/test.js" />
         </Scripts>
         <Services>
            <asp:ServiceReference Path="~/MyService.svc" />
         </Services>
      </asp:ScriptManager>
   </div>
   <button onclick="test()">Click Me</button>
</form> 
```

我的服务界面如下所示：

```
namespace Test
{
    [ServiceContract(Namespace = "Test")]
    public interface IMyService
    {
        [OperationContract]
        void DoWork();

        [OperationContract]
        string SayHi();
    }
} 
```

这是它的实现：

```
namespace Test
{
    [AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
    public class MyService : IMyService
    {
        public void DoWork()
        {
        }

        public string SayHi()
        {
            return "Hello, World!";
        }
    }
} 
```

最后是 JavaScript：

```
function test() {
    Test.MyService.SayHi(SayHiSuccess, SayHiError);
}

function SayHiSuccess(result) {
    alert(result[0]);
}

function SayHiError(error) {
    alert(error.toString());
} 
```

服务的 SayHi() 方法似乎永远不会执行，尽管我不确定为什么或如何进行故障排除。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T02:28:41.577

您没有发布您的 web.config 内容。你用的是什么绑定？您可能应该使用[`webHttpBinding`](http://msdn.microsoft.com/en-us/library/bb412176.aspx).

此外，了解您的 .svc 文件内容可能会有所帮助。[`WebScriptServiceHostFactory`](http://msdn.microsoft.com/en-us/library/system.servicemodel.activation.webscriptservicehostfactory.aspx)虽然我从未尝试过，但我知道如果您用作服务主机工厂，则根本不需要修改 web.config 。这就像修改 .svc 文件一样简单，如下所示：

```
<%@ ServiceHost Service="MyService"
    Factory="System.ServiceModel.Activation.WebScriptServiceHostFactory"
 %> 
```

如果一切都失败了，这里有一些资源给你：

*   [从 Javascript 调用 WCF 服务](http://dotnetbyexample.blogspot.com/2008/02/calling-wcf-service-from-javascript.html)
*   [创建一个简单的 WCF Web...](http://peterkellner.net/2008/09/14/wcf-web-service-json-vs2008/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T02:01:25.637

您的代码看起来不错。应该正常工作。您也可以尝试添加 WebService 和 WebMethod 属性。

为了调试 WCF Web 服务，我通常使用[Fiddler](http://www.fiddler2.com/fiddler2/)来跟踪 HTTP 调用，同时运行带有调试器的 WCF 代码（大多数情况下在 Visual Studio 中运行）。

# asp.net - 在请求的生命周期中，何时执行 web.config 标签执行？

> ID：712268
> 
> 赞同：0
> 
> 时间：2009-04-03T01:34:37.510
> 
> 标签：asp.net, request, lifecycle

在请求的生命周期中，何时`<location path='The/Path'>`执行 web.config 标记？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T02:27:00.783

web.config 在应用程序启动时被解析。这将取决于位置标签中包含哪些元素，以及它将如何影响每个单独的请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T01:52:55.297

应用程序设置已在**OnInit()**方法上可用。你在 OnInit 之前需要它们吗？

# .net - 如何在 VS.NET 2005 中将源文件的默认编码设置为 UTF-8

> ID：712269
> 
> 赞同：2
> 
> 时间：2009-04-03T01:37:53.273
> 
> 标签：.net, tfs

我在评论和配置中使用中文。在我自动合并并签入源文件后，它们就变成了乱七八糟的代码。

我猜原因是 TFS 通过 UTF-8 编码合并它们，但我的 VS.NET 使用的是 gb2312 编码。我知道我可以从菜单 [file->advance save option] 获取和更改每个文件我不能设置 VS.NET 2005 总是以 UTF-8 编码创建和保存 C# 文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-15T11:53:34.967

在 VS 中创建文件时，VS 默认为 UTF-8。如果文件是在外部使用其他编码创建（或修改）的，它将遵循现有编码，除非您“另存为”-> UTF-8

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T01:41:29.537

奇怪：我在工作中的 VS2005 和我在家里的 vs2008 和 vs2005 副本都默认为 Utf-8。

# c - Linux 上的 GetTcpTable 等效项

> ID：712270
> 
> 赞同：1
> 
> 时间：2009-04-03T01:39:02.350
> 
> 标签：c, linux

Linux 上是否有返回系统上当前打开的 TCP 连接的 API 调用（如Windows 上的[GetTcpTable](http://msdn.microsoft.com/en-us/library/aa366026(VS.85).aspx)调用）？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T01:41:54.637

按照 UNIX 的“一切都是文件”的理念，你可以从阅读中得到你想要的`/proc/net/tcp`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T01:47:24.483

您应该查看 netstat -t （用于 TCP）。`Man netstat`会给你所有的选择。

# asp.net-mvc - MVC 中的页面渲染时间

> ID：712276
> 
> 赞同：8
> 
> 时间：2009-04-03T01:45:33.753
> 
> 标签：asp.net-mvc, performance, model-view-controller

问：如何计算渲染 MVC 页面并在母版页上显示时间所需的总时间。

在 Asp.net Web Form 中，我创建了一个基本页面类，如下所示：

```
public class PageBase : System.Web.UI.Page
{      
    private DateTime startTime = DateTime.Now;
    private TimeSpan renderTime;   
    public DateTime StartTime
    {
        set { startTime = value; }
        get { return startTime; }
    }  
    public virtual string PageRenderTime
    {
        get
        {
            renderTime = DateTime.Now - startTime;
            return renderTime.Seconds + "." + renderTime.Milliseconds + " seconds";
        }
    }       
} 
```

然后我会像这样在我的母版页上调用该方法：

```
<div id="performance">
     <% =PageRenderTime %>
</div> 
```

问：我如何使用 MVC 框架完成同样的事情？

问：在 MVC 框架中，我在哪里设置第一次创建页面时的开始时间？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-11-19T08:55:15.923

最好的方法是计算请求时间..开始请求和结束请求..查看这篇很棒的帖子：

[http://haacked.com/archive/2008/07/02/httpmodule-for-timing-requests.aspx](http://haacked.com/archive/2008/07/02/httpmodule-for-timing-requests.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T02:50:59.527

进入你的 web.config 并确保你有......

```
<system.web>
    <trace enabled="true" localOnly="false" />
</system.web> 
```

然后您可以转到[http://.../trace.axd](http://.../trace.axd)并查看发出的每个请求。

然后，您想查看 From First(s) 列，最后一个是呈现页面（服务器端）所花费的时间。

例子...

```
aspx.page   End Render  0.06121112  0.005297 
```

渲染页面需要 61.2 毫秒。

如果您正在寻找时间码本身，或者您想要手动进行一些诊断，您想要使用 System.Diagnostics.Stopwatch 类而不是 DateTime。

```
Stopwatch sw = Stopwatch.StartNew();
...
sw.Stop();
Trace.Write(sw.ElapsedMilliseconds); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T02:02:40.623

我可能会覆盖Controller 类上的[OnActionExecuting](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.onactionexecuting.aspx)和[OnActionExecuted方法。](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.onactionexecuted.aspx)

```
public class BaseController : Controller {
    // Called before the action is executed
    public override void OnActionExecuting(ActionExecutingContext ctx) {
        base.OnActionExecuting(ctx);
        // Start timing
    }

    // Called after the action is executed
    public override void OnActionExecuted(ActionExecutedContext ctx) {
        base.OnActionExecuted(ctx);
        // Stop timing
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T01:55:29.020

创建一个基本控制器并让您的控制器从中派生。在构造函数中设置开始时间并覆盖 Dispose() 并将总时间的计算放在那里。这应该为您提供整个行动生命周期的端到端。由于 Controller 实现了 IDisposable，我假设渲染引擎将在计算结果后处理它，您不必等待垃圾收集。如果我的假设被证明是错误的，您可以使用 OnResultExecuted() 代替。

**编辑**：要在页面上获得渲染时间会相对困难，因为根据定义，在您将时间放在页面上之前无法完成页面渲染，并且在页面完成渲染之前您没有时间。但是，您可以将渲染时间写入会话，然后使用 AJAX 返回并获取渲染时间以供稍后显示。您可以通过将开始时间放在 ViewData 中并在 View 本身中计算渲染时间来近似它。您可能想尝试记录渲染时间并进行视图近似，看看它有多接近。

此代码可用于记录渲染时间。

```
public class BaseController : Controller
{
   private DateTime StartTime { get; set; }
   public BaseController() : base()
   {
       StartTime = DateTime.Now;
   }

   public override void Dispose( bool disposing )
   {
       var totalTime = DateTime.Now - this.StartTime;
       ... write it out somewhere ...
   }
} 
```

# c++ - `enable_shared_from_this` 有什么用处？

> ID：712279
> 
> 赞同：392
> 
> 时间：2009-04-03T01:46:07.373
> 
> 标签：c++, boost, boost-asio, tr1

我在阅读 Boost.Asio 示例时遇到了`enable_shared_from_this`问题，在阅读了文档后，我仍然不知道应该如何正确使用它。有人可以给我一个例子和解释什么时候使用这个类是有意义的。

* * *

## 回答 #1

> 赞同：394
> 
> 时间：2009-04-03T02:00:52.390

它使您能够获得一个有效的`shared_ptr`实例`this`，当您拥有的是`this`. 没有它，您将无法获得`shared_ptr`to `this`，除非您已经拥有一个成员。此示例来自[enable_shared_from_this 的 boost 文档](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/enable_shared_from_this.html)：

```
class Y: public enable_shared_from_this<Y>
{
public:

    shared_ptr<Y> f()
    {
        return shared_from_this();
    }
}

int main()
{
    shared_ptr<Y> p(new Y);
    shared_ptr<Y> q = p->f();
    assert(p == q);
    assert(!(p < q || q < p)); // p and q must share ownership
} 
```

该方法`f()`返回一个 valid `shared_ptr`，即使它没有成员实例。请注意，您不能简单地这样做：

```
class Y: public enable_shared_from_this<Y>
{
public:

    shared_ptr<Y> f()
    {
        return shared_ptr<Y>(this);
    }
} 
```

此返回的共享指针将具有与“正确”的引用计数不同的引用计数，并且当对象被删除时，其中一个最终将丢失并持有一个悬空引用。

`enable_shared_from_this`已成为 C++ 11 标准的一部分。您也可以从那里以及从 boost 中获取它。

* * *

## 回答 #2

> 赞同：240
> 
> 时间：2011-04-05T07:00:06.777

来自 Dobbs 博士关于弱指针的文章，我认为这个例子更容易理解（来源：[http](http://drdobbs.com/cpp/184402026) ://drdobbs.com/cpp/184402026 ）：

...这样的代码将无法正常工作：

```
int *ip = new int;
shared_ptr<int> sp1(ip);
shared_ptr<int> sp2(ip); 
```

这两个`shared_ptr`对象都不知道另一个对象，所以当它们被销毁时，它们都会尝试释放资源。这通常会导致问题。

类似地，如果一个成员函数需要一个`shared_ptr`拥有被调用对象的对象，它就不能即时创建一个对象：

```
struct S
{
  shared_ptr<S> dangerous()
  {
     return shared_ptr<S>(this);   // don't do this!
  }
};

int main()
{
   shared_ptr<S> sp1(new S);
   shared_ptr<S> sp2 = sp1->dangerous();
   return 0;
} 
```

这段代码与前面的例子有同样的问题，尽管形式更微妙。当它被构造时，`shared_pt`r 对象`sp1`拥有新分配的资源。成员函数内部的代码`S::dangerous`不知道该`shared_ptr`对象，因此`shared_ptr`它返回的对象不同于`sp1`. 将新`shared_ptr`对象复制到`sp2`没有帮助；当`sp2`超出范围时，它将释放资源，当`sp1`超出范围时，它将再次释放资源。

避免这个问题的方法是使用类模板`enable_shared_from_this`。模板采用一个模板类型参数，即定义托管资源的类的名称。反过来，该类必须从模板公开派生；像这样：

```
struct S : enable_shared_from_this<S>
{
  shared_ptr<S> not_dangerous()
  {
    return shared_from_this();
  }
};

int main()
{
   shared_ptr<S> sp1(new S);
   shared_ptr<S> sp2 = sp1->not_dangerous();
   return 0;
} 
```

执行此操作时，请记住您调用的对象`shared_from_this`必须由某个`shared_ptr`对象拥有。这不起作用：

```
int main()
{
   S *p = new S;
   shared_ptr<S> sp2 = p->not_dangerous();     // don't do this
} 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2012-08-01T12:34:07.933

这是我的解释，从具体细节的角度来看（最佳答案并没有和我一起“点击”）。*请注意，这是调查 Visual Studio 2012 附带的 shared_ptr 和 enable_shared_from_this 的源代码的结果。也许其他编译器以不同的方式实现 enable_shared_from_this...*

`enable_shared_from_this<T>`**添加一个**私有`weak_ptr<T>`实例，其中`T`保存.**`T`**

 **因此，当您第一次`shared_ptr<T>`在新的 T* 上创建 a 时，T* 的内部 weak_ptr 将使用 1 的引用计数进行初始化。新的`shared_ptr`基本上回到了 this 上`weak_ptr`。

`T`然后可以在其方法中调用`shared_from_this`以获取一个实例，`shared_ptr<T>`该实例返回**到相同的内部存储的引用计数**。这样，您总是有一个`T*`存储 ref-count 的地方，而不是有多个`shared_ptr`彼此不知道的实例，并且每个实例都认为他们是`shared_ptr`负责 ref-counting`T`并在他们的 ref 时删除它-count 达到零。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2020-08-25T13:19:01.017

有一种特殊情况我觉得`enable_shared_from_this`非常有用：使用异步回调时的线程安全。

想象类`Client`有一个类型的成员`AsynchronousPeriodicTimer`：

```
struct AsynchronousPeriodicTimer
{
    // call this periodically on some thread...
    void SetCallback(std::function<void(void)> callback); 
    void ClearCallback(); // clears the callback
}

struct Client
{
    Client(std::shared_ptr< AsynchronousPeriodicTimer> timer) 
        : _timer(timer)

    {
        _timer->SetCallback(
            [this]
            () 
            {
                assert(this); // what if 'this' is already dead because ~Client() has been called?
                std::cout << ++_counter << '\n';
            }
            );
    }
    ~Client()
    {
        // clearing the callback is not in sync with the timer, and can actually occur while the callback code is running
        _timer->ClearCallback();
    }
    int _counter = 0;
    std::shared_ptr< AsynchronousPeriodicTimer> _timer;
}

int main()
{
    auto timer = std::make_shared<AsynchronousPeriodicTimer>();
    {
        auto client = std::make_shared<Client>(timer);
        // .. some code    
        // client dies here, there is a race between the client callback and the client destructor           
    }
} 
```

客户端类为周期性计时器订阅回调函数。一旦客户端对象超出范围，客户端的回调和计时器析构函数之间就会出现竞争条件。可以使用悬空指针调用回调！

解决方案：使用`enable_shared_from_this`在回调调用期间延长对象的生命周期。

```
struct Client : std::enable_shared_from_this<Client>
{
Client(std::shared_ptr< AsynchronousPeriodicTimer> timer) 
    : _timer(timer)

    {

    }

    void Init()
    {
        auto captured_self = weak_from_this(); // weak_ptr to avoid cyclic references with shared_ptr

        _timer->SetCallback(
        [captured_self]
        () 
        {
            if (auto self = captured_self.lock())
            {
                // 'this' is guaranteed to be non-nullptr. we managed to promote captured_self to a shared_ptr           
                std::cout << ++self->_counter << '\n';
            }

        }
        );
    }
    ~Client()
    {
        // the destructor cannot be called while the callback is running. shared_ptr guarantees this
        _timer->ClearCallback();

    }
    int _counter = 0;
    std::shared_ptr< AsynchronousPeriodicTimer> _timer;
} 
```

的机制`enable_shared_from_this`，结合`std::shared_ptr`引用计数固有的线程安全性，使我们能够确保`Client`在回调代码访问其内部成员时不会破坏对象。

请注意，该`Init`方法与构造函数是分开的，因为在`enable_shared_from_this`构造函数退出之前，初始化过程不会完成。因此，额外的方法。从构造函数中订阅异步回调通常是不安全的，因为回调可能会访问未初始化的字段。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-13T13:25:40.747

请注意，使用 boost::intrusive_ptr 不会遇到这个问题。这通常是解决此问题的更方便的方法。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-11-15T21:58:48.943

在 c++11 及更高版本中完全相同：它是为了启用`this`作为共享指针返回的能力，因为`this`它为您提供了一个原始指针。

换句话说，它允许您像这样转换代码

```
class Node {
public:
    Node* getParent const() {
        if (m_parent) {
            return m_parent;
        } else {
            return this;
        }
    }

private:

    Node * m_parent = nullptr;
}; 
```

进入这个：

```
class Node : std::enable_shared_from_this<Node> {
public:
    std::shared_ptr<Node> getParent const() {
        std::shared_ptr<Node> parent = m_parent.lock();
        if (parent) {
            return parent;
        } else {
            return shared_from_this();
        }
    }

private:

    std::weak_ptr<Node> m_parent;
}; 
```

# c++ - enqueue() 方法向队列中添加一个元素：如何在 C++ 中实现？

> ID：712282
> 
> 赞同：1
> 
> 时间：2009-04-03T01:47:19.867
> 
> 标签：c++, methods, queue

我很难尝试实现此方法，因为 C++ 中的数组下标从零开始。该方法将一个元素添加到队列中。您可以使用 f（前）和 r（后）指针以及大小为 n 的顺序列表。如果您发现需要额外的变量，请随意。谢谢。

那是我的尝试，但我知道它是错误的：

```
void QueueAr::enqueue(const Object& x){
    prov = (r % n) + 1;
    if(prov != f){
        r = prov;
        queueArray[r] = x;
        if(f = -1){
            f = 0
        }
    }else{
        //queue is full
    }
} 
```

如何使用指针？如果我开始他们指向 NULL 我不能使用指针算术。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T01:52:07.577

要使用普通数组实现队列，只需循环处理它 - 因此，一旦数组中的空间用完，就回绕到 0。正如您所指出的，您需要保留前后的记录。举个例子（其中 X 代表队列中的一个项目）：

```
// Rear is where to enqueue into, Front is where to dequeue from
Empty Array:
| - - - |
Front = -1, Rear = 0 

Enqueue()
| X - - |
Front = 0, Rear = 1

Enqueue()
| X X - |
Front = 0, Rear = 2

Dequeue()
| - X - |
Front = 1, Rear = 2

Enqueue()
| - X X |
Front = 1, Rear = 0 // Looped around

Dequeue()
| - - X |
Front = 2, Rear = 0

Enqueue()
| X - X |
Front = 2, Rear = 1 
```

你只需要使用模运算来环绕。当然，这在大小上是有限的（一旦元素用完，就必须分配更多内存），但这正是处理数组时得到的。

这是一些代码作为开始（我根本没有检查过）：

```
// Private class variables:
// These should be set in the constructor of your queue class
unsigned int rear = 0; // back of the queue
unsigned int front = -1; // front of the queue
unsigned int numStored = 0;
unsigned int length;
Object* array = new Object[length];

QueueAr::Enqueue(Object& obj)
{
    if (front == rear)
    {
        // Throw an exception: queue is full!
    }
    else
    {
        array[rear] = obj; // Insert the object at the back
        rear++;
        rear = rear % length;
        numStored++;
    }
}
// For kicks, here's the queue code
QueueAr::Dequeue(Object& obj)
{
    if (numStored == 0)
    {
        // Throw an exception: queue is empty!
    }
    front++;
    front = front % length;
    numStored--;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T01:50:01.137

如果您不使用 STL，则可能需要使用链表。要入队，请添加到列表的末尾。要出队，请从列表的开头删除。为了性能和方便，您应该存储列表两端的指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T01:52:13.690

如果您受限于特定的数组大小，则可以使用普通的 ol' C 数组轻松实现队列。您需要两个指针/索引：队列的开头和队列的结尾。您还需要数组本身。

您可以通过 (1) 包装或 (2) 在到达末尾时复制数组来防止队列溢出。这两种方法都相当简单，但包装更容易、更快捷。使用[循环缓冲区](http://en.wikipedia.org/wiki/Circular_buffer)调用包装数据元素，并且对于队列和音频缓冲区很常见。

```
Queue:  0 1 4 3 6 8 0 0 0 0 0
Start:      ^
End:                ^

Dequeue: return 4 (read, then move start to right)
Queue:  0 1 4 3 6 8 0 0 0 0 0
Start:        ^
End:                ^

Enqueue: 9 (write, then move end to right)
Queue:  0 1 4 3 6 8 9 0 0 0 0
Start:        ^
End:                  ^

Wrapping enqueue: 2 (write, then move to right and wrap to beginning)
Queue:  0 1 4 3 6 8 9 3 4 7 2
Start:        ^
End:    ^ 
```

# asp.net - 如何实施安全下载系统？

> ID：712295
> 
> 赞同：3
> 
> 时间：2009-04-03T01:55:05.620
> 
> 标签：asp.net, download

实现下载系统的最佳方式是什么？

它需要与 asp.net 应用程序集成。

我需要以下功能：

1.  传送大于 50mb 的文件
2.  只有asp.net登录页面授权的用户才能下载
3.  需要知道用户是下载了整个文件还是其中的一部分
4.  文件下载或取消后，相同的 url 将不再可用

我相信它类似于 rapidshare，但与 asp.net 应用程序集成。

你们有什么建议？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T02:03:03.573

如果您将文件托管在运行 modsecdownload 的 lighttpd 服务器上，并使用您的 asp.net 应用程序生成该服务器上文件的安全 URL，该怎么办？该方法应处理项目 1,2 和 4。

不确定如何从服务器端得知下载已成功完成，也许有一些解析服务器日志的逻辑？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T18:42:47.653

您还可以使用[nginx](http://wiki.nginx.org/)及其[X-Accel-Redirect](http://wiki.nginx.org/NginxXSendfile)功能。这很简单，而且 nginx 比 lighttpd 更快更轻量级。至少在 Ruby 和 Python 网络世界中，一个常见的设置是在 lighttpd 或 Apache 之前运行 nginx。nginx 将所有静态媒体和代理动态请求提供给它背后的 Web 服务器。

# c# - 跟随 Sprite 的 XNA 2D 相机引擎

> ID：712296
> 
> 赞同：36
> 
> 时间：2009-04-03T01:55:07.820
> 
> 标签：c#, xna, camera, sprite

在 XNA 游戏中创建视差效果的最佳方法是什么？我希望相机跟随我的精灵在世界各地移动，这样我就可以构建缩放、平移、抖动和其他效果等效果。任何人都有一个如何做到这一点的可靠例子，最好是在 GameComponent 中？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-04-07T01:55:27.097

所以我结合上面的教程想出了它，并创建了下面的类。它向您的目标补间并跟随它。试试看。

```
public interface IFocusable
{
    Vector2 Position { get; }
}

public interface ICamera2D
{
    /// <summary>
    /// Gets or sets the position of the camera
    /// </summary>
    /// <value>The position.</value>
    Vector2 Position { get; set; }

    /// <summary>
    /// Gets or sets the move speed of the camera.
    /// The camera will tween to its destination.
    /// </summary>
    /// <value>The move speed.</value>
    float MoveSpeed { get; set; }

    /// <summary>
    /// Gets or sets the rotation of the camera.
    /// </summary>
    /// <value>The rotation.</value>
    float Rotation { get; set; }

    /// <summary>
    /// Gets the origin of the viewport (accounts for Scale)
    /// </summary>        
    /// <value>The origin.</value>
    Vector2 Origin { get; }

    /// <summary>
    /// Gets or sets the scale of the Camera
    /// </summary>
    /// <value>The scale.</value>
    float Scale { get; set; }

    /// <summary>
    /// Gets the screen center (does not account for Scale)
    /// </summary>
    /// <value>The screen center.</value>
    Vector2 ScreenCenter { get; }

    /// <summary>
    /// Gets the transform that can be applied to 
    /// the SpriteBatch Class.
    /// </summary>
    /// <see cref="SpriteBatch"/>
    /// <value>The transform.</value>
    Matrix Transform { get; }

    /// <summary>
    /// Gets or sets the focus of the Camera.
    /// </summary>
    /// <seealso cref="IFocusable"/>
    /// <value>The focus.</value>
    IFocusable Focus { get; set; }

    /// <summary>
    /// Determines whether the target is in view given the specified position.
    /// This can be used to increase performance by not drawing objects
    /// directly in the viewport
    /// </summary>
    /// <param name="position">The position.</param>
    /// <param name="texture">The texture.</param>
    /// <returns>
    ///     <c>true</c> if the target is in view at the specified position; otherwise, <c>false</c>.
    /// </returns>
    bool IsInView(Vector2 position, Texture2D texture);
}

public class Camera2D : GameComponent, ICamera2D
{
    private Vector2 _position;
    protected float _viewportHeight;
    protected float _viewportWidth;

    public Camera2D(Game game)
        : base(game)
    {}

    #region Properties

    public Vector2 Position
    {
        get { return _position; }
        set { _position = value; }
    }
    public float Rotation { get; set; }
    public Vector2 Origin { get; set; }
    public float Scale { get; set; }
    public Vector2 ScreenCenter { get; protected set; }
    public Matrix Transform { get; set; }
    public IFocusable Focus { get; set; }
    public float MoveSpeed { get; set; }

    #endregion

    /// <summary>
    /// Called when the GameComponent needs to be initialized. 
    /// </summary>
    public override void Initialize()
    {
        _viewportWidth = Game.GraphicsDevice.Viewport.Width;
        _viewportHeight = Game.GraphicsDevice.Viewport.Height;

        ScreenCenter = new Vector2(_viewportWidth/2, _viewportHeight/2);
        Scale = 1;
        MoveSpeed = 1.25f;

        base.Initialize();
    }

    public override void Update(GameTime gameTime)
    {
        // Create the Transform used by any
        // spritebatch process
        Transform = Matrix.Identity*
                    Matrix.CreateTranslation(-Position.X, -Position.Y, 0)*
                    Matrix.CreateRotationZ(Rotation)*
                    Matrix.CreateTranslation(Origin.X, Origin.Y, 0)*
                    Matrix.CreateScale(new Vector3(Scale, Scale, Scale));

        Origin = ScreenCenter / Scale;

        // Move the Camera to the position that it needs to go
        var delta = (float) gameTime.ElapsedGameTime.TotalSeconds;

        _position.X += (Focus.Position.X - Position.X) * MoveSpeed * delta;
        _position.Y += (Focus.Position.Y - Position.Y) * MoveSpeed * delta;

        base.Update(gameTime);
    }

    /// <summary>
    /// Determines whether the target is in view given the specified position.
    /// This can be used to increase performance by not drawing objects
    /// directly in the viewport
    /// </summary>
    /// <param name="position">The position.</param>
    /// <param name="texture">The texture.</param>
    /// <returns>
    ///     <c>true</c> if [is in view] [the specified position]; otherwise, <c>false</c>.
    /// </returns>
    public bool IsInView(Vector2 position, Texture2D texture)
    {
        // If the object is not within the horizontal bounds of the screen

        if ( (position.X + texture.Width) < (Position.X - Origin.X) || (position.X) > (Position.X + Origin.X) )
            return false;

        // If the object is not within the vertical bounds of the screen
        if ((position.Y + texture.Height) < (Position.Y - Origin.Y) || (position.Y) > (Position.Y + Origin.Y))
            return false;

        // In View
        return true;
    }
} 
```

以下是您将如何使用它`SpriteBatch`：

```
spriteBatch.Begin(SpriteBlendMode.AlphaBlend,
                  SpriteSortMode.FrontToBack,
                  SaveStateMode.SaveState,
                  Camera.Transform);
spriteBatch.Draw(_heliTexture,
                 _heliPosition,
                 heliSourceRectangle,
                 Color.White,
                 0.0f,
                 new Vector2(0,0),
                 0.5f,
                 SpriteEffects.FlipHorizontally,
                 0.0f);
spriteBatch.End(); 
```

如果这对您有帮助，请告诉我，感谢 StackOverflow 和社区。哇！

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-03T01:58:00.933

以下是在 XNA 中实现 2D 相机的一些教程：

1.  [http://www.paradeofrain.com/?page_id=32](http://www.paradeofrain.com/?page_id=32)
2.  [http://gamecamp.no/blogs/tutorials/archive/2008/01/29/creating-a-simple-xna-camera-class.aspx](http://gamecamp.no/blogs/tutorials/archive/2008/01/29/creating-a-simple-xna-camera-class.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-02T13:04:23.860

这是另一个

[http://www.david-amador.com/2009/10/xna-camera-2d-with-zoom-and-rotation/](http://www.david-amador.com/2009/10/xna-camera-2d-with-zoom-and-rotation/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-22T19:38:48.650

我知道这是一个老问题，但我也有同样的问题，我发现了这个很棒的 Monogame 相机库，所以我想我应该分享...

[https://github.com/aloisdeniel/Comora](https://github.com/aloisdeniel/Comora)

它真的很容易安装和跟随你只需要添加的精灵

this.camera.Position = 你的精灵的位置；

# javascript - 如何设置 javascript 变量或重用另一个函数中的变量

> ID：712305
> 
> 赞同：1
> 
> 时间：2009-04-03T02:00:21.987
> 
> 标签：javascript

我在这里遇到了一个问题，没有详细介绍和混淆每个人，让我问一个简单的问题。

这里有两个功能。我还需要在 SubmitForm() 函数中使用“id”变量。有人可以告诉我该怎么做吗？这就是我对 js 的了解。:)

谢谢您的帮助。

```
 AC.chooseFunc = function(id,label)
  {
    document.qSearch.action = ".index.php?dc=2&id="+ id;
    //document.qSearch.action = "index.php?dc=2";
    document.qSearch.submit();
  }

  *** This one fails.
  function SubmitForm(id)
  {
    document.qSearch.action = "index.php?dc=2&id="+ id;
    document.qSearch.submit()
  } 
```

我需要的是附加到 SubmitForm 函数中的查询字符串的“id”var。有人可以告诉我该怎么做吗？谢谢您的帮助！

* * *

这不能做吗？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T13:40:59.697

首先，作为免责声明，我认为如果您发布一个示例页面来展示文档是如何组合在一起的，我们都可以为您提供更好的答案。

这是使它工作的一种方法。在脚本（或`<script>`标签）的顶部或附近声明一个变量：

```
var storedId; 
```

然后，在 AC.chooseFunc 的顶部，将 的值复制`id`到 storedId：

```
 AC.chooseFunc = function(id,label)
  {
    storedId = id;
    ... 
```

最后，从 SubmitForm 的参数中删除 id 并使用 storedId 代替：

```
 function SubmitForm()
  {
    document.qSearch.action = "index.php?dc=2&id="+ storedId;
    document.qSearch.submit();
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T02:35:56.440

我不知道你是否愿意这样做，但你可以使变量成为全局变量，换句话说，在两个函数之外声明它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T02:34:04.637

你能不能只使用一个隐藏的输入并让 PHP 将它添加到查询字符串中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T02:36:19.530

id 为空吗？检查 id 的值...

```
alert(id); 
```

第二个功能对我来说看起来不错。问题可能是您将 null 传递给它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T02:42:45.647

很明显，这两个函数的调用方式不同。

正如另一条评论中提到的，提醒值看看你在函数中真正得到了什么。该函数本身看起来*不错*，因此唯一的结论是它们不是使用相同的数据工作，或者它们以不同的方式调用。

我建议在调用树中发布更多代码

# .net - How can i code a program that works with a front end and some modules?

> ID：712313
> 
> 赞同：0
> 
> 时间：2009-04-03T02:03:56.113
> 
> 标签：.net, module, desktop

It will be a desktop application, coded in visual basic (vb.net) or c#.

The idea is to have just one main .exe as front end form. It will load all modules installed and display each in a different tab. This form should have functions to install a new module, update an installed module or delete.

As an example, think about a tabbed pane (with its firts tab as a "Manage Modules" tab) generate new tabs for each module installed. Think about a database aplication and the modules for this app are an Include module, a Delete, an Update and a Select one.

Is that a way to implement such thing easily in .net platform?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T02:15:50.170

What you need is a Composite Application Block:

1.  Winforms: [http://msdn.microsoft.com/en-us/library/aa480450.aspx](http://msdn.microsoft.com/en-us/library/aa480450.aspx)
2.  WPF/Silverlight: [http://www.codeplex.com/CompositeWPF/](http://www.codeplex.com/CompositeWPF/)

The Winforms version isn't really "easy", but it gets the job done.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T03:44:58.553

I think you would getter milage out of an MDI application that uses a plugin model to load modules that get initialised and enroll themselves in the MDI containers menu.

# windows - 关于 DirectInput 库中 guidInstance 的问题；还处理设备的枚举

> ID：712314
> 
> 赞同：0
> 
> 时间：2009-04-03T02:04:35.550
> 
> 标签：windows, winapi, directx

关于 DIDEVICEINSTANCE 中的 guidInstance

微软说：

> 设备实例的唯一标识符。应用程序可以将实例全局唯一标识符 (GUID) 保存到配置文件中，并在以后使用它。实例 GUID 特定于特定计算机。从一台计算机获取的实例 GUID 与另一台计算机上的实例 GUID 无关。

那么，如果我将设备连接到计算机并且我的程序进行枚举并找到 guid，我是否需要再次枚举？即使用户插拔设备。如果插入了另一个相同类型的设备，它是否仍然识别出第二个设备与第一个设备不同，因此需要不同的 guid？我应该在我的程序一直运行以查找我的设备时重新枚举所有接口，还是对于给定的 pc 一次就足够了？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-07T21:52:28.797

我实际上正在尝试解决类似的问题。根据[此处](http://msdn.microsoft.com/en-us/library/windows/desktop/ms835112.aspx)的 MSDN ，看起来 InstanceGUID 在同一台计算机上应该始终相同。我已经验证，如果我拔下我的 USB 设备并将其插入不同的端口，它确实会保留相同的实例 GUID。但是，如果不同的用户登录到同一台 PC，DirectInput 会显示具有不同 InstanceGUID 的同一设备！我找不到 Microsoft 承认这是一个已知问题。

所以，我可以部分回答你的问题。如果您有两个相同的设备，您将获得不同的 InstanceGUID 和相同的 ProductGUID。如果您拔下设备并将它们移动到不同的 USB 端口，这些 InstanceGUID 将保持一致。但是，如果其他用户登录，您将获得不同的 InstanceGUID。至少我可以验证这是 Windows 7 64 位上的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-20T10:44:21.283

InstanceGuid 将始终是每个插入设备的唯一标识符 - 但如果您删除安装信息（例如卸载 USB 设备），您也会丢失该 InstanceGuid。再次插入时，设备将获得一些新的不可预测的 Guid。

一个设备的 ProductGuid 将始终相同，因为它存储在设备 USB HID 芯片中。尽管完全相同类型的两个设备具有相同的 ProductGuid，但可能会发生这种情况。如果他们这样做，您只能通过他们的 InstanceGuid 来识别他们（在某些情况下可能会变得无效，如上所述......）。

# email - CakePHP 电子邮件无法在 Mosso 云站点上发送

> ID：712319
> 
> 赞同：0
> 
> 时间：2009-04-03T02:06:37.527
> 
> 标签：email, web-applications, cakephp, mosso

我已将一个正常工作的 Cakephp Web 应用程序上传到 Mosso Cloud Sites 托管。该应用程序运行良好，只是不再发送电子邮件。该站点是我以前的主机的精确副本，发送电子邮件工作正常。该应用程序使用内置的 Cakephp 电子邮件组件。我搜索了 Mosso 的知识库并按照[此处](http://help.mosso.com/article.php?id=295)的 php 电子邮件（htaccess 方法）的说明进行操作。我的脚本如下：

```
 $this->Email->reset();
    $this->Email->sendAs = 'html'; // both = html + plain text
    $this->Email->to = '"'.$data['Customer']['first_name'].' '.$data['Customer']['last_name'].'" <' . $data['Customer']['email']. '>';
    $this->Email->bcc = $this->_generateRecipients($data['Booking']['sales_associate_id']);
    $this->Email->from = '<noreply@'.env('HTTP_HOST').'>';
    $this->Email->replyTo = '<noreply@'.env('HTTP_HOST').'>';
    $this->Email->return = '<noreply@'.env('HTTP_HOST').'>';
    $this->Email->subject = 'Rental Receipt';

    // Select appropraite email template
    switch ($this->Session->read('site_id')) {
        case '100':
            $this->Email->template = 'vac_receipt1';
            break;
        case '200':
            $this->Email->template = 'vac_receipt2';
            break;
    }

    $this->Email->send(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T09:48:22.733

我会发表评论，但还没有声誉..

无论如何，您是否检查了 send() 返回值？您的日志文件中是否有任何错误？如果没有错误并且返回值很好，您可能应该联系主机的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T16:26:12.590

在与 Mosso 员工详细讨论了这个问题后，他们的一位 linux 管理员介入并在审查了代码后指出，Mosso 云站点电子邮件系统不支持代码生成的电子邮件的密件抄送或抄送。因此，由于我的代码使用 Bcc 向我们的员工和客户发送副本，因此我的电子邮件没有被发送，也没有抛出 PHP 错误。

因此，如果您使用 Mosso Cloud 站点，您将无法通过代码发送带有密件抄送或抄送的电子邮件。吸取的教训，但在他们的知识库中应该更容易找到。

# python - 给定 UTC 时间戳和 UTC 偏移量，是否可以在 Python 中获取时区？

> ID：712322
> 
> 赞同：3
> 
> 时间：2009-04-03T02:09:12.963
> 
> 标签：python, timezone, utc, dst, pytz

我有 UTC 偏移量和 UTC 时间的数据。鉴于此，在 Python 中是否有可能获取用户的本地时区（主要是为了确定是否是 DST 等。可能使用 pytz），类似于 PHP 中的函数`timezone_name_from_abbr`？

例如：

如果我的纪元时间是 1238720309，我可以得到 UTC 时间：

```
>>> d = datetime.utcfromtimestamp(1238720309)
>>> print d + dt.timedelta(0,-28800) #offset for pacific I think
2009-04-02 17:04:41.712143 
```

这是正确的，只是现在是 PDT，所以它应该是：

```
2009-04-02 18:04:41.712413 
```

我需要获取在 pytz 中使用的时区来确定它是否是夏令时，我想？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T02:14:04.293

因为，一般来说，对于给定的时区偏移，有多个可能的时区，所以一般的答案是“不，不是没有更多信息”。更多信息通常是时间适用的位置——哪个国家、哪个州或哪个城市。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T03:40:29.577

不。时区太复杂了，有太多是从 UTC 开始的 X 小时。

[http://en.wikipedia.org/wiki/List_of_time_zones](http://en.wikipedia.org/wiki/List_of_time_zones)

例如，来自 UTC 的 -5 可能是加拿大、纽约、古巴、牙买加、厄瓜多尔等。

赤道地区可能不使用 DST，因为它们的一天大约一年 12 小时。南美的，如果他们使用某种形式的夏令时，可能与北美的时间表相反，因为他们的夏季/冬季（即短日/长日）的时间表也相反。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T02:39:00.520

没有。 [http://en.wikipedia.org/wiki/List_of_U.S._states_by_time_zone](http://en.wikipedia.org/wiki/List_of_U.S._states_by_time_zone)

# c++ - dynamic_bit 设置打印？

> ID：712323
> 
> 赞同：0
> 
> 时间：2009-04-03T02:10:31.057
> 
> 标签：c++, boost, bitsets

```
std::string charBuff = "11010";
dbitset = boost::dynamic_bitset<unsigned char> (charBuff);
for (boost::dynamic_bitset<>::size_type i = 0; i < dbitset.size(); ++i) {
      std::cout << dbitset[i];
} 
```

它从 LSB 打印到 MSB。输出：01011。

我应该怎么做才能正确打印 bitset。我可以反转我知道的字符缓冲区:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T04:02:36.467

```
<unsigned car> 
```

应该：

```
<unsigned char> 
```

是什么`buffer`？你不应该用`charBuff`吗？

使用 s 的`operator<<`重载`dynamic_bitset`来实现你想要的。这是一个简化的解决方案：

```
#include <iostream>
#include <string>
#include <boost/dynamic_bitset.hpp>

int main()
{
    std::string charBuff("11010");
    boost::dynamic_bitset<> dbitset(charBuff);

    /* print LSB to MSB, in order */ 
    for (boost::dynamic_bitset<>::size_type i = 0; 
         i < dbitset.size(); ++i) {
        std::cout << dbitset[i];
    }
    std::cout << std::endl;

    /* print bits in the order you want */
    std::cout << dbitset << std::endl; 
    return 0;
} 
```

# php - 为什么我不能在我的 php 脚本中使用 session_start()？它说标头已经发送

> ID：712326
> 
> 赞同：4
> 
> 时间：2009-04-03T02:11:16.237
> 
> 标签：php, session, cookies, header

这是我页面的前几行：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<?php include_once "dblogin.php";
session_start();
$loggedIn = 0;
if(isset($_SESSION["login"])) {$loggedIn = 1;}
?> 
```

我收到以下错误：

无法发送会话 cookie - 标头已由第 2 行 /usr/www/users/simpleof/index.php 中的（输出开始于 /usr/www/users/simpleof/index.php:2）发送

从我在其他论坛上阅读的内容来看，这应该没问题，因为 session_start() 位于 php 代码的第一块中，但我仍然收到此错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T02:28:23.853

以下是[HTTP](http://en.wikipedia.org/wiki/HTTP)协议的工作原理：

您使用浏览器发送此类标头：

```
GET /questions/712326/why-cant-i-use-sessionstart-in-my-php-script-it-says-headers-are-already-sen HTTP/1.1
Host: stackoverflow.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; fi; rv:1.9.0.8) Gecko/2009032609 Firefox/3.0.8 (.NET CLR 3.5.30729)
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: fi-fi,fi;q=0.8,en-us;q=0.5,en;q=0.3
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Connection: keep-alive
Referer: http://stackoverflow.com/questions/tagged/php
Cookie: *censored*
Cache-Control: max-age=0 
```

第一个服务器向您发送标头：

```
HTTP/1.x 200 OK
Cache-Control: private
Content-Type: text/html; charset=utf-8
Content-Encoding: gzip
Expires: Fri, 03 Apr 2009 02:14:49 GMT
Vary: Accept-Encoding
Server: Microsoft-IIS/7.0
Set-Cookie: *censored*
Date: Fri, 03 Apr 2009 02:14:49 GMT
Content-Length: 9346 
```

然后服务器向您发送实际的页面数据

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd" >
<html>
<head>    

    <title>Why can't I use session_start() in my php script? It says headers are already sent. - Stack Overflow</title>
    <link rel="stylesheet" href="/Content/all.min.css?v=2743">
   ..snip.. 
```

所以你看到你不能先发送 HTML 数据（DOCTYPE），然后是标题数据，因为标题已经被处理了。您可以使用 PHP 的[输出控制](http://php.net/manual/en/ref.outcontrol.php)，但更推荐的是使用[MVC](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)设计，在其中缓冲用户最后看到的所有数据。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-28T19:40:41.720

你要么误读，要么其他论坛错了。仅仅因为`session_start()`它位于 PHP 代码的第一个“块”中并不意味着它会起作用。

`session_start()`需要在发送标头之前运行。

您的解决方案是：

`session_start();`上移`<!DOCTYPE html`...

# c++ - 邪恶的演员会被邪恶的编译器打败吗？

> ID：712334
> 
> 赞同：7
> 
> 时间：2009-04-03T02:20:15.263
> 
> 标签：c++

这不是学术代码或假设问题。最初的问题是将代码从 HP11 转换为 HP1123 Itanium。基本上它归结为 HP1123 Itanium 上的编译错误。在 Windows 上复制它以供学习时，我真的很摸不着头脑。除了最基本的方面之外，我已经剥离了所有方面......如果您按原样运行它，您可能必须按 control D 退出控制台窗口：

```
#include "stdafx.h"
#include <iostream>
using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{
    char blah[6];
    const int IAMCONST = 3;
    int *pTOCONST;
    pTOCONST = (int *)  &IAMCONST;
    (*pTOCONST) = 7;
    printf("IAMCONST %d \n",IAMCONST);
    printf("WHATISPOINTEDAT %d \n",(*pTOCONST));
    printf("Address of IAMCONST %x   pTOCONST %x\n",&IAMCONST, (pTOCONST));
    cin >> blah;    
    return 0;
} 
```

这是输出

```
IAMCONST 3
WHATISPOINTEDAT 7
Address of IAMCONST 35f9f0   pTOCONST 35f9f0 
```

我只能说这是什么鬼？这样做是不确定的吗？对于这样一个简单的例子，这是我见过的最违反直觉的事情。

**更新：**

事实上，在搜索了一段时间后，菜单调试 >> Windows >> 反汇编正是下面描述的优化。

```
 printf("IAMCONST %d \n",IAMCONST);
0024360E  mov         esi,esp 
00243610  push        3    
00243612  push        offset string "IAMCONST %d \n" (2458D0h) 
00243617  call        dword ptr [__imp__printf (248338h)] 
0024361D  add         esp,8 
00243620  cmp         esi,esp 
00243622  call        @ILT+325(__RTC_CheckEsp) (24114Ah) 
```

谢谢你们！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-03T02:27:35.993

看起来编译器正在优化

```
printf("IAMCONST %d \n",IAMCONST); 
```

进入

```
printf("IAMCONST %d \n",3); 
```

既然你*说*那`IAMCONST`是一个`const int`。

但是由于您要获取 的地址`IAMCONST`，因此它实际上必须位于堆栈上的某个位置，并且`const`无法强制执行，因此该位置 ( `*pTOCONST`) 处的内存毕竟是可变的。

简而言之：你抛弃了`const`本质，不要那样做。可怜的，手无寸铁的C...

### 附录

使用 GCC for x86，`-O0`（没有优化），生成的程序集

```
main:
    leal    4(%esp), %ecx
    andl    $-16, %esp
    pushl   -4(%ecx)
    pushl   %ebp
    movl    %esp, %ebp
    pushl   %ecx
    subl    $36, %esp
    movl    $3, -12(%ebp)
    leal    -12(%ebp), %eax
    movl    %eax, -8(%ebp)
    movl    -8(%ebp), %eax
    movl    $7, (%eax)
    movl    -12(%ebp), %eax
    movl    %eax, 4(%esp)
    movl    $.LC0, (%esp)
    call    printf
    movl    -8(%ebp), %eax
    movl    (%eax), %eax
    movl    %eax, 4(%esp)
    movl    $.LC1, (%esp)
    call    printf 
```

`*(bp-12)`从堆栈上复制到`printf`的参数。但是，使用`-O1`（以及`-Os`、`-O2`、`-O3`和其他优化级别），

```
main:
    leal    4(%esp), %ecx
    andl    $-16, %esp
    pushl   -4(%ecx)
    pushl   %ebp
    movl    %esp, %ebp
    pushl   %ecx
    subl    $20, %esp
    movl    $3, 4(%esp)
    movl    $.LC0, (%esp)
    call    printf
    movl    $7, 4(%esp)
    movl    $.LC1, (%esp)
    call    printf 
```

您可以清楚地看到使用的是常量`3`。

如果您使用的是 Visual Studio 的`CL.EXE`，则`/Od`禁用优化。这因编译器而异。

请注意，C 规范[允许](http://en.wikipedia.org/wiki/Type_punning)C 编译器假定任何`int *`指针的目标永远不会与 a 的内存位置重叠`const int`，因此如果您想要可预测的行为，您真的不应该这样做。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-03T02:25:43.907

常量值 IAMCONST 被内联到 printf 调用中。

您所做的充其量是错误的，并且很可能是 C++ 标准未定义的。我的**猜测**是 C++ 标准让编译器可以自由地内联一个函数声明本地的 const 原语。原因是该值不应该能够改变。

再说一次，在 C++ 中应该和可以是非常不同的词。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-03T03:00:35.557

你很幸运编译器正在做优化。另一种处理方法是将 const 整数放入只读内存中，然后尝试修改该值将导致核心转储。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T04:22:44.937

通过删除 const 的强制转换写入 const 对象是未定义的行为 - 所以在你这样做的时候：

```
(*pTOCONST) = 7; 
```

所有赌注都取消了。

来自 C++ 标准 7.1.5.1（cv-qualifiers）：

> 除了可以修改任何声明为 mutable (7.1.1) 的类成员外，任何在 const 对象的生命周期 (3.8) 期间修改它的尝试都会导致未定义的行为。

正因为如此，编译器可以自由地假设 的值`IAMCONST`不会改变，因此它可以优化对实际存储的访问。事实上，如果从不获取 const 对象的地址，编译器可能会完全取消该对象的存储。

另请注意（再次在 7.1.5.1 中）：

> 由整数常量表达式初始化的非易失性 const 限定的整数或枚举类型的变量可用于整数常量表达式 (5.19)。

这意味着 IAMCONST 可用于编译时常量表达式（即，为枚举或数组大小提供值）。在运行时更改它甚至意味着什么？

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-04-03T05:03:56.663

编译器是否优化并不重要。您自找麻烦，您很幸运自己遇到了麻烦，而不是等待客户向您报告。

“我只能说这到底是怎么回事？这样做是不确定的吗？对于这样一个简单的例子，这是我见过的最违反直觉的事情。”

如果您真的相信，那么您需要切换到您可以理解的语言，或者改变专业。为了您自己和您的客户，请停止使用 C 或 C++ 或 C#。

```
const int IAMCONST = 3; 
```

你说的。

```
int *pTOCONST;
pTOCONST = (int *)  &IAMCONST; 
```

如果你忽略了你的邪恶演员，猜猜为什么编译器会抱怨。在你撒谎之前，编译器可能一直在说真话。

“邪恶的演员会被邪恶的编译器打败吗？”

不，邪恶的演员自己被打败了。无论您的编译器是否试图告诉您真相，编译器都不是邪恶的。

# html - CSS div 的重叠

> ID：712336
> 
> 赞同：8
> 
> 时间：2009-04-03T02:22:17.677
> 
> 标签：html, css, css-float

我正在尝试为我的网站建立一个评论部分。在评论部分，我希望它采用 WordPress 风格的布局，头像在左侧。它可以工作，但正在发生的是评论文本环绕在下面的头像周围。例如，[这里](http://i40.tinypic.com/2m6jpd3.png). 这可能有一个简单的解决方案，但我是 CSS 业余爱好者。这是相关的 XHTML 和 CSS：

```
/*------- COMMENTS -------*/

#comments {
  width: 91px;
  height: 18px;
  background: url(images/comments.png) no-repeat;
  text-indent: -9000px;
  margin-bottom: 10px;
}

div.comment {
  padding: 5px 5px 30px 5px;
  background: url(images/commentbar.png) bottom center no-repeat;
  margin-bottom: 10px;
}

div.comment div.left {
  margin-left: 10px;
  float: left;
  width: 51px;
}

div.comment div.right {
  width: 482px;
}

div.comment div.right h3 {
  color: #e6267c;
  font-size: 18px;
  display: inline;
  text-transform: uppercase;
}
```

```
<div class="comment">
  <div class="left">
    <img src="images/noavatar.png" alt="No Avatar" />
  </div>

  <div class="right">
    <h3>Laura Brauman</h3>
    <span>12 March 09</span>
    <p>Nunc ultrices nisi ut tellus. In placerat tempus quam. Nulla dolor nulla,dictum eget, auctor a, rutrum sit amet, ante. Sed scelerisque est. Vestibulum arcu purus, dignissim nec, rhoncus id, sodales eu, quam. Nullam congue hendrerit enim. Phasellus
      risus. Pellentesque lacus sem, luctus tempus.</p>
  </div>
</div>
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-03T03:03:08.497

从[规格](http://www.w3.org/TR/CSS21/visuren.html#floats)：

> 由于浮动不在流中，因此在浮动框之前和之后创建的非定位块框垂直流动，就好像浮动不存在一样。

`display: block`这意味着没有定位的元素会忽略浮动。

> 但是，浮动旁边创建的行框被缩短，以便为浮动的边距框腾出空间。

这意味着内联元素确实围绕浮点数流动。这就是为什么你的`<span>`和里面的文本会在`<p>`周围流动`div.left`，即使`<p>`and`div.right`不会。

> 表格的边框框、块级替换元素或建立新块格式化上下文的正常流中的元素（例如具有“溢出”而不是“可见”的元素）不得与与元素本身相同的块格式化上下文。如有必要，实现应通过将其放置在任何先前的浮动下方来清除所述元素，但如果有足够的空间，可以将其放置在此类浮动附近。

而且，这 - 尽管它很迟钝 - 是你问题的答案。您必须插入“新的[块格式化上下文](http://www.w3.org/TR/CSS21/visuren.html#block-formatting)”。

> 浮动、绝对定位元素、内联块、表格单元格、表格标题和具有“溢出”而不是“可见”的元素（除非该值已传播到视口）建立新的块格式化上下文。

对你来说最简单的是[1](http://www.w3.org/TR/CSS21/visuren.html#floats)：

```
div.right { overflow: auto; } 
```

请注意，您可能*还*需要[1](http://www.w3.org/TR/CSS21/visuren.html#floats)：

```
div.comment { overflow: auto; } 
```

解决一个相关但不同的问题。如果您的`<p>`内容比您的图像短，则浮动`div.left`不会扩大`div.comment`. 添加将`overflow: auto;`带您进入规范中恰当命名的[复杂案例](http://www.w3.org/TR/CSS21/visudet.html#block-root-margin)部分：

> 如果 [在“溢出”不计算为“可见”时正常流中的块级、非替换元素] 元素具有任何浮动后代，其底部边距边缘低于底部，则高度增加以包括这些边缘

这基本上说浮动只扩展`overflow <> visible`包含的元素。

[1](http://www.w3.org/TR/CSS21/visuren.html#floats) `overflow: hidden;`也可以，但如果需要，会裁剪内容而不是抛出滚动条。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T02:29:56.330

您所看到的是内联元素会尊重浮点数，但块级元素不会。您必须手动在它们周围留出空间，否则浮动会与它们重叠。

或者浮动另一个块级元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T02:26:39.117

将此添加到 div.right

```
margin-left: 51px; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T02:30:21.260

```
div.right { float: left; width: 482px; } 
```

# security - 为什么检查错误的密码比检查正确的密码要花更长的时间？

> ID：712339
> 
> 赞同：86
> 
> 时间：2009-04-03T02:24:21.150
> 
> 标签：security, authentication, passwords

这个问题一直困扰着我。

在 Linux 上，当被要求输入密码时，如果您的输入正确，它会立即检查，几乎没有延迟。但是，另一方面，如果您输入了错误的密码，则需要更长的时间来检查。这是为什么？

我在我尝试过的所有[Linux 发行版](http://en.wikipedia.org/wiki/Linux_distribution)中都观察到了这一点。

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-04-03T02:35:27.690

它实际上是为了防止暴力攻击每秒尝试数百万个密码。这个想法是限制检查密码的速度，并且应该遵循许多规则。

*   成功的用户/密码对应立即成功。
*   可以检测到的故障原因不应有*明显差异。*

最后一个特别重要。这意味着没有有用的消息，例如：

```
Your user name is correct but your password is wrong, please try again 
```

或者：

```
Sorry, password wasn't long enough 
```

甚至没有响应“无效用户和密码”和“有效用户但无效密码”失败原因之间的时间差。

*每一次*失败都应该提供完全相同的信息，无论是文本的还是其他的。

一些系统更进一步，每次失败都会增加延迟，或者只允许三个失败然后在允许重试之前有很大的延迟。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-03T02:25:36.403

这使得猜测密码需要更长的时间。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-03T02:26:22.347

我不确定，但在输入错误密码后集成延迟以增加攻击难度是很常见的。这使得攻击实际上不可行，因为只检查几个密码需要很长时间。

甚至尝试几个密码——生日、猫的名字等等——都变得毫无乐趣可言。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-04-03T02:37:00.107

基本上是为了减轻蛮力和字典攻击。

来自[Linux-PAM 应用程序开发人员指南](http://www.kernel.org/pub/linux/libs/pam/Linux-PAM-html/old/pam_appl-3.html)：

> 计划延误
> 
> ```
> extern int pam_fail_delay(pam_handle_t *pamh, unsigned int micro_sec); 
> ```
> 
> 该函数由 Linux-PAM 提供，用于在对 pam_authenticate() 的调用失败之后以及在控制权返回给应用程序之前促进时间延迟。使用此功能时，应用程序程序员应检查它是否可用，
> 
> ```
> #ifdef PAM_FAIL_DELAY
>     ....
> #endif /* PAM_FAIL_DELAY */ 
> ```
> 
> 通常，应用程序通过调用 pam_authenticate() 或 pam_chauthtok() 请求 Linux-PAM 对用户进行身份验证。这些函数调用相关 Linux-PAM 配置文件中列出的每个堆叠身份验证模块。按照此文件的指示，一个或多个模块可能会失败，从而导致 pam_...() 调用返回错误。在应用程序继续之前也有一个暂停是可取的。这种延迟的主要原因是安全性：延迟主要用于阻止暴力字典攻击，但也有助于阻止定时（隐蔽通道）攻击。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-04-03T02:37:28.793

这是一种非常简单、几乎毫不费力的方法，可以大大提高安全性。考虑：

1.  系统`A`没有延迟。攻击者有一个创建用户名/密码组合的程序。以每分钟数千次尝试的速度，尝试每个组合并记录所有成功登录只需要几个小时。

2.  `B`每次猜错后，系统都会产生 5 秒的延迟。攻击者的效率已降低到每分钟 12 次尝试，有效地削弱了蛮力攻击。而不是几个小时，它可能需要几个月才能找到有效的登录。如果黑客是那样的耐心，他们就会变得合法。:-)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-03T02:47:41.483

失败的身份验证延迟可以降低登录尝试的速度。如果有人尝试对一个或可能的用户帐户进行字典或蛮力攻击，则攻击者将需要等待失败延迟，从而迫使他花费更多时间并让您有更多机会检测到它。

您可能还想知道，根据您使用的登录 shell，通常有一种方法可以配置此延迟。

在 GDM 中，延迟设置在 gdm.conf 文件中（通常在 /etc/gdm/gdm.conf 中）。您需要设置 RetryDelay=x 其中 x 是以秒为单位的值。

目前大多数 linux 发行版还支持在 /etc/login.defs 中定义 FAIL_DELAY，允许您在登录尝试失败后设置等待时间。

最后，PAM 还允许您在 auth 行上设置 nodelay 属性以绕过失败延迟。（[这是一篇关于 PAM 和 linux 的文章](http://www.enterprisenetworkingplanet.com/netsecur/article.php/3514511)）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-03T03:55:47.153

我不认为它可以像回复所暗示的那样简单。

如果对正确密码的响应是立即的（某个值），您是否只需要等到比该值更长的时间才能知道密码是错误的吗？（至少从概率上知道，这对于破解目的来说很好）而且无论如何你会并行运行这种攻击......这是一个大的 DoS 欢迎垫吗？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-07-05T17:09:54.790

我之前尝试过的方法似乎有效，但实际上没有；如果您在乎，您必须查看 wiki 编辑历史记录...

（对我而言）起作用的是，**既**降低**/etc/pam.d/login****中**pam_faildelay.so delay=X 的值（我将其降低到 500000，半秒），**又**添加 nodelay（前面有一个space) 到**common-auth**中的行尾，正如 Gabriel 在他的回答中所描述的那样。

`auth [success=1 default=ignore] pam_unix.so nullok_secure nodelay`

至少对我（debian sid）而言，仅进行其中一项更改不会将延迟明显缩短到默认的 3 秒以下，尽管可以通过仅更改 /etc/pam.d/login 中的值来延长延迟。

这种废话，足以让一个大人哭泣！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-06-01T22:20:48.037

在 Ubuntu 9.10 上，我也认为是新版本，您要查找的文件位于

> /etc/pam.d/login

编辑该行：

> auth 可选 pam_faildelay.so 延迟=3000000

将数字 3 更改为您可能想要的另一个数字。

请注意，要进行“nodelay”身份验证，我认为您应该编辑文件

> /etc/pam.d/common-auth

也。在线上：

> auth [success=1 default=ignore] pam_unix.so nullok_secure

将“nodelay”添加到最后（不带引号）。但我认为这是关于“nodelay”的最终解释。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-06-16T18:59:34.347

我想从开发人员的角度添加一个注释。虽然这对肉眼来说并不明显，但聪明的开发人员会在找到匹配项时打破匹配查询。在见证中，成功的匹配比失败的匹配完成得更快。因为，匹配函数会将凭据与所有已知帐户进行比较，直到找到正确的匹配项。换句话说，假设有 1,000,000 个按 ID 排列的用户帐户；001、002、003 等等。您的 ID 是 43,001。因此，当您输入正确的用户名和密码时，扫描会在 43,001 处停止并让您登录。如果您的凭据不正确，则会扫描所有 1,000,000 条记录。双核服务器上的处理时间差异可能以毫秒为单位。在具有 5 个用户帐户的 Windows Vista 上，它会在纳秒内完成。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-08-25T01:40:47.450

我同意。这是一个任意的编程决定。将延迟设置为一秒而不是三秒并不会真正损害密码的可破解性，而是使其更加用户友好。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-05-21T07:30:39.513

从技术上讲，这种**故意延迟**是为了防止像**“线性化攻击”这样的攻击** *（还有其他攻击和原因）*。

> 为了说明攻击，**考虑一个程序（没有这种故意延迟），它检查输入的序列以查看它是否匹配正确的序列，在这种情况下恰好是“ *xyba* ”**。为了提高效率，程序员决定一次检查一个字符，一旦发现不正确的字符就退出，然后开始检查长度。
> 
> **正确的序列长度比不正确的序列长度需要更长的处理时间。更好的是（对于攻击者），第一个字符正确的序列号将比第一个字符不正确的序列号花费更长的时间。等待时间的连续步骤是因为每次多循环一次，比较才能通过正确的输入。**
> 
> *   因此，攻击者可以选择一个*四字符的字符串，并且以**x*开头的字符串占用的时间最多。*（通过猜测工作）*
> *   然后攻击者可以将字符固定为*x*并改变第二个字符，在这种情况下，他们会发现*y*占用的时间最长。
> *   然后攻击者可以将前两个字符固定为*xy*并改变第三个字符，在这种情况下，他们会发现*b*占用的时间最长。
> *   然后攻击者可以将前三个字符固定为*xyb*并改变第四个字符，在这种情况下，他们会发现*a*占用的时间最长。
> 
> 因此，攻击者可以一次恢复连续一个字符。

**[线性化.java。](https://github.com/user501254/TE_IT_6_SWS/blob/master/attack_Linearization/Linearization.java)**

**[线性化.docx，样本输出](https://github.com/user501254/TE_IT_6_SWS/blob/master/attack_Linearization/Linearization.docx)**

> 序列号有四个字符长，每个字符有 128 个可能的值。**然后有 128 ⁴ = 2 ^(28) = 268,435,456 个可能的序列**。如果攻击者必须随机猜测完整的序列号，她将在大约 **2 ^(27) = 134,217,728 次尝试中猜出序列号，这是一项巨大的工作量**。另一方面，通过使用上面的线性化攻击，每个字母平均只需要 128/2 = 64 次猜测，总**预期工作量约为 4 * 64 = 2 ⁸ = 256 次猜测，** 这是一个微不足道的数量工作的。

*大部分书面武术都改编自此[（](https://bookstreet.in/questions/what-is-malware-explain-salami-and-linearization-attacks-10-marks-925)摘自 Mark Stamp 的“信息安全：原则与实践”）。此外，上述计算并未考虑计算出正确序列长度所需的猜测量。*

# forms - CodeIgniter：URI 和表单

> ID：712340
> 
> 赞同：1
> 
> 时间：2009-04-03T02:25:22.613
> 
> 标签：forms, codeigniter, uri

我正在使用 CodeIgniter 实现一个搜索框，但我不确定我应该如何传递搜索参数。我有三个参数：搜索字符串；产品分类; 和排序顺序。它们都是可选的。目前，我将参数发送`$_POST`到一个临时方法，该方法将参数转发到常规 URI 表单。这工作正常。不过，我使用的是一种奇怪的 URI 格式：

```
http://site.com/products/search=computer,sort=price,cat=laptop 
```

有没有人有更好/更清洁的传递方式？我正在考虑将它作为参数传递给 products 方法，但由于参数是可选的，所以事情会变得混乱。我应该把它吸起来，然后打开`$_GET`方法吗？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T08:47:44.660

# 查询字符串

您可以[在 CodeIgniter 中启用查询字符串](http://codeigniter.com/user_guide/general/urls.html)以允许更标准的搜索功能。

**配置文件**

```
$config['enable_query_strings'] = FALSE; 
```

启用后，您可以在应用中接受以下内容：

```
http://site.com/products/search?term=computer&sort=price&cat=laptop 
```

这样做的好处是用户会发现很容易编辑 URL 以快速更改他们的搜索，并且您的搜索使用常见的搜索功能。

这种方法的缺点是您违背了 CodeIgniter 开发团队的设计决策之一。但是，我个人的看法是，只要查询字符串不用于您的大部分内容，仅用于搜索查询等特殊情况，这是可以的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-27T17:32:48.203

一种更好的方法，也是 CI 开发人员想要的方法，是将所有搜索参数添加到 URI，而不是像这样的查询字符串：

```
http://site.com/products/search/term/computer/sort/price/cat/laptop 
```

`uri_to_assoc($segment)`然后，您将使用 URI 类中的函数将第 3 段（“术语”）中的所有 URI 段解析为键 => 值对数组。

```
Class Products extends Controller {
...

    // From your code I assume you are calling a search method.
    function search()
    {
        // Get search parameters from URI.
        // URI Class is initialized by the system automatically.
        $data->search_params = $this->uri->uri_to_assoc(3);
        ...
    }
    ...
} 
```

这将使您可以轻松访问所有搜索参数，并且它们可以在 URI 中按任何顺序排列，就像传统的查询字符串一样。

`$data->search_params`现在将包含一个 URI 段数组：

```
Array
(
    [term] => computer
    [sort] => price
    [cat] => laptop
) 
```

在此处阅读有关 URI 类的更多信息：http: [//codeigniter.com/user_guide/libraries/uri.html](http://codeigniter.com/user_guide/libraries/uri.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T04:48:25.733

如果您使用固定数量的参数，您可以为它们分配一个默认值并发送它，而不是根本不发送参数。例如

```
 http://site.com/products/search/all/somevalue/all 
```

接下来，在控制器中您可以忽略参数 if (parameter == 'all'.)

```
 Class Products extends Controller {
 ...

     // From your code I assume that this your structure.
     function index ($search = 'all', $sort = 'price', $cat = 'all')
     {
         if ('all' == $search)
         {
            // don't use this parameter
         }
         // or
         if ('all' != $cat)
         {
            // use this parameter
         }
         ...
     }
     ...
 } 
```

# c++ - 是否有任何使用 inpout.dll 的开源程序？

> ID：712350
> 
> 赞同：1
> 
> 时间：2009-04-03T02:27:47.817
> 
> 标签：c++, dll, import, parallel-port

是否有任何开源程序使用 inpout.dll 连接 parell 端口并打开和关闭 LED 我一直在寻找几乎整整一个月但还没有找到插孔。我想在没有任何微控制器的情况下做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T03:08:32.900

这些网站[http://www.lvr.com/parport.htm](http://www.lvr.com/parport.htm)和[http://lcdinterfacing.googlepages.com/](http://lcdinterfacing.googlepages.com/)有一些 VB 代码，用于在现实世界场景中测试和使用 inpout.dll，您可能可以对其进行定制C++。

[这个站点](http://logix4u.net/Legacy_Ports/Parallel_Port/A_tutorial_on_Parallel_port_Interfacing.html)，有一个关于使用它的 C++ 教程。

(* 奇怪，如果你点击那个链接，你会得到一个 404 但是，如果你只是在地址栏中点击 ENTER，它就可以工作 - 地址是：

```
http://logix4u.net/Legacy_Ports/Parallel_Port/A_tutorial_on_Parallel_port_Interfacing.html 
```

如果您想剪切和粘贴 - 它似乎与下划线/%5F 翻译 *) 有关。

请注意，如果您正在开发更安全的 Windows 平台（我猜是 Win98 之后的任何平台），您应该使用 inpout32 变体。

如果您只是在寻找能够编写自己的源代码，那么这些链接很好。如果，通过开源，您实际上是指“无语音”，我找不到任何内容（SourceForge，这是我使用 FOSS 的首选地点，返回零点击）。

# java - Eclipse 3.4 上 JBoss 的热部署：Ganymede

> ID：712353
> 
> 赞同：4
> 
> 时间：2009-04-03T02:28:40.780
> 
> 标签：java, eclipse, jboss, jakarta-ee, ganymede

我正在使用 Ganymede (Eclipse 3.4) 做一些基于 Java EE 的 Web 开发，目标是 JBoss 4.2 应用服务器。

我一直非常喜欢 Eclipse 作为 Java 编辑器。问题是，Java EE 并没有人们想象的那么有用。它有 bug，部署和调试非常慢，每次进行一点更改都必须重新部署 Java EE 应用程序。这使得开发难以忍受。

我的问题是：在开发 JBoss 应用程序时，是否有一个插件可以通过将 HOT DEPLOY 添加到 Ganymede 来让我的生活更轻松？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T02:37:14.707

是的，您可以使用 JBoss 工具：

[http://www.jboss.org/tools](http://www.jboss.org/tools)

我在使用 Eclipse 3.4 在 JBoss 上开发时使用过它，虽然插件中仍然存在一些错误，但它运行良好。总的来说，虽然它更好。

3.4.2 的更新站点是：

[http://download.jboss.org/jbosstools/updates/stable/](http://download.jboss.org/jbosstools/updates/stable/)

**编辑**：此外，如果您在 Redhat 上运行，您可以下载“保证”的 JBoss Developer Studio，以提供稳定且可部署的开发环境。我没有使用它，但有兴趣看看它是否符合这些要求：

[http://www.jboss.com/products/devstudio/](http://www.jboss.com/products/devstudio/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T08:01:21.947

您可以通过远程调试开箱即用地执行此操作。将 Eclipse 调试器连接到 JBoss，当您进行代码更改时，它将在可能的情况下进行热修补。

[这里](http://www.onjava.com/pub/a/onjava/2005/08/31/eclipse-jboss-remote-debug.html)有一个关于这样做的教程

# javascript - 使用 javascript Onclick 将数据传递到数据库

> ID：712355
> 
> 赞同：1
> 
> 时间：2009-04-03T02:29:08.737
> 
> 标签：javascript, jquery, ajax

当谈到 javascript/ajax 时，我是一个真正的菜鸟，所以任何帮助都将不胜感激。关于这个问题：

[通过 onClick javascript 函数使用 PHP 更新 MySql 数据库](https://stackoverflow.com/questions/638147/updating-a-mysql-database-using-php-via-an-onclick-javascript-function)

[但主要关心的是菲尔萨克](https://stackoverflow.com/users/7094/phill-sacre)留下的答案。我想知道是否有人可以详细说明我们是如何（如果可以的话？）通过他的示例使用 jquery 传递值/数据。他留下的代码示例如下：

```
 function updateScore(answer, correct) {

      if (answer == correct) {
$.post('updatescore.php');

  }
}

...

<a onclick="updateScore(this, correct)" ...> </a> 
```

例如，我们想用 php 将任意数量的值传递给数据库，有人能给我一个关于 javascript 函数所需内容的片段示例吗？或者请详细说明上面发布的内容？

再次感谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T02:40:59.160

我能想到的最简单的例子就是这个。在**if**块中进行 AJAX 调用，如下所示：

```
$.get('updatescore.php', {'score': '222'}, function(d) {
    alert('Hello from PHP: ' + d);
}); 
```

在您的“updatescore.php”脚本上，只需执行以下操作：**更新 score**。并返回一个*纯文本*，说明更新操作是否成功。

祝你好运。

PS：您也可以使用**POST**而不是**GET**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T02:43:04.897

你要做的是在 php 服务器端有一个页面，可以说它的 update.php。您的 javascript 将在 Ajax 请求中访问此页面，获取请求并将其放入数据库中。

php 可能看起来像这样：

```
<?php
mysql_connect(...)
mysql_query("INSERT INTO table 
(score) VALUES('$_GET["score"]') ") 
```

您的 javascript 将简单地在 update.php 上执行 ajax 请求并将变量作为获取值“分数”发送给它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T03:31:55.480

Phil 没有将任何值传递给脚本。他只是向脚本发送一个请求，该脚本很可能包含“更新”分数的逻辑。不过，一个精明的人可以简单地查看 HTML 源代码并通过检查锚点在做什么来查看答案。

为了进一步挑剔他的解决方案，应该使用一组单选按钮，并且在表单中，应该使用按钮或某种可点击元素通过 ajax 请求将值发送到服务器，并将值发送到服务器可以分析并将答案的状态发送回页面。

由于您使用的是 jQuery，因此可以使代码不显眼，如以下示例所示：

```
$('#submit_answer').click(function() {
    var answer = 'blah' // With blah being the value of the radio button
    $.get('updatescore.php',
    {'value': answer},
    function(d) {
        alert('Your answer is: ' + d') // Where d is the string 'incorrect' or 'correct'
    }
}); 
```

享受。

# wpf - WPF“换肤”即用完全不同的窗口布局替换

> ID：712359
> 
> 赞同：2
> 
> 时间：2009-04-03T02:31:21.553
> 
> 标签：wpf, xaml

WPF菜鸟问题：

WPF 应用程序可以在运行时更改其外观吗？我知道，通过样式，可以更改控件和 UI 元素的外观，但我设想的更多是拥有两个应用程序：一个“编辑器”应用程序和一个“游戏”应用程序，它们都运行基本相同的代码但具有完全不同的 UI 布局（后者具有更少的按钮、更简单的控件、菜单项等）。“游戏”UI 的布局可以由艺术家设计，通常是无权访问底层代码的人。

我该怎么做这样的事情？我只需要一个起点。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T03:54:40.107

您几乎可以灵活地在运行时管理 WPF 应用程序的外观，因此您的建议非常可行。

在不了解应用程序的全部细节的情况下，听起来您确实可以创建两组不同的 UI 控件，一组用于编辑器，一组用于游戏玩家，并且都使用相同的基础 biz 逻辑类。

要选择在运行时以哪种模式运行您的应用程序，您需要决定添加哪种类型的用户，并将编辑器或游戏玩家用户界面控件适当地放置在主布局容器上。

```
private void Window_Loaded(object sender, RoutedEventArgs e)
{
     if(user == editor) {
         this.LayoutRoot.Children.Add(editorUserControl);
     }
     else {
         this.LayoutRoot.Children.Add(gamerUserControl);
     }
} 
```

还有无数其他不同的方法你也可以做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-20T15:39:23.983

在不确切知道您的目标的情况下，我建议您使用 MVVM。你描述的是经典的MVVM。您有一个模型，但在您的案例 2 中，对于同一模型，您有很多视图。

因此，如果您使用某种 MVVM 框架，您可以利用依赖注入来根据您运行的上下文显示不同的视图。

我是 Prism 的忠实粉丝，但有许多 MVVM 框架可用。您甚至可以使用 1 个模型、1 个视图模型和 2 个视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T08:05:49.940

查看[PhotoSuru](http://windowsclient.net/appfeeds/SubscriptionCenter/Gallery/photosuru.aspx)以获取动态更改其布局（根据窗口大小）的应用程序示例

# database-design - 对于包含大量记录的审计表，这是一个好的设计吗？

> ID：712364
> 
> 赞同：1
> 
> 时间：2009-04-03T02:35:49.203
> 
> 标签：database-design, query-optimization, audit-tables

我有一个表格，可以按每件单品跟踪库存数据。这是表格的简化版本（排除了一些非关键字段）：

```
UniqueID,
ProductSKU, 
SerialNumber,
OnHandStatus,
Cost,
DateTimeStamp 
```

每次给定部分发生问题时，都会创建一个新的审计记录。例如，我的产品 ABC 第一次添加到库存时，我会得到如下记录：

```
1, ABC, 555, OnHand, $500, 01/01/2009 @ 02:05:22 
```

如果 ABC 序列号 555 的成本发生变化，我得到一个新记录：

```
2, ABC, 555, OnHand, $600, 01/02/2009 @ 04:25:11 
```

如果这件作品被售出，我会得到另一张唱片：

```
3, ABC, 555, Sold, $600, 02/01/2009 @ 5:55:55 
```

如果引入一条新的 ABC，我得到这个记录：

```
4, ABC, 888, OnHand, $600, 02/05/2009 @ 9:01:01 
```

我需要能够*在任何时间点*尽可能快地获得一组给定产品的现有库存价值。

使用上面的示例，如果我想获取 2009 年 1 月 2 日的产品 ABC 的库存值，我需要为每个唯一的产品/序列号组合选择01/03/**之前的****最新**记录2009 年，状态为“OnHand”，然后将费用加起来。（我不能 100% 确定这个 select 语句在这一点上会是什么样子，但我会做一些实验）。

 ****我的问题：**对于我所描述的审计表类型，这是一个好的结构吗？也就是说，如果索引得当，它是否适合快速查询？（我试图想象当这张表增长到数百万行时会发生什么。）

我是否应该将历史记录拆分到一个单独的表中，并且只将每个 ProductID/SerialNumber 组合的最新记录留在“活动”表中？

任何反馈/建议/评论/链接表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T02:40:39.487

将实时数据表与审计数据分开，您的生活会变得更加轻松，这是一个非常好的主意。对于正常的日常操作，您甚至不需要查看审计数据，因此将其与您的实时数据放在同一个表中只会让人头疼。

管理此问题的最简单方法是在活动表上放置一个触发器，以便每当插入/删除/更新记录时，它都会自动将新记录插入审计表中。

***编辑：***扩展[凯文](https://stackoverflow.com/questions/712364/is-this-a-good-design-for-an-audit-table-with-tons-of-records/712387#712387)对此的想法，我想无论序列号如何，共享相同 SKU 的所有部件都会有相同的价格？如果是这种情况，有一个单独的价格表也绝对是个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T02:44:59.727

并非所有值都会立即更新，为什么要复制所有静态信息？我认为你应该有不同的序列号、状态​​和成本表。这些表中的每一个也将具有产品 ID 和更新日期。

这样，您还可以轻松判断产品的哪个部分发生了变化。之前，您需要将产品的所有字段与在第一个字段之前保存的产品的所有字段进行比较。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-14T19:38:27.877

首先，一些定义（不是临床定义，只是我自己的概念分离命名法）：

==========

初始表：您添加和检索的日常表。

审计表：在其相关初始表中包含任何记录的多个版本的表。

==========

如果审计表的业务用途是能够在任何时间点分辨出记录的样子，我会说它的构造应该与初始表相同（加上唯一的审计 ID）。

如果更重要的是要知道字段值在任何时间点（而不是整个记录）是什么，那么请尝试更缩写的 table-field-value-date 方法。请注意，使用这种方法重建整个记录需要做更多的工作，所以如果可能需要整个记录检索，请忘记它。

总的来说，我认为在大多数情况下，使用最新版本记录的快速性能比使用审计数据的性能更重要。因此，我建议创建与初始表相同的审计表（加上自动编号的代理键），并在添加到初始表时触发将相同数据插入审计表。这使初始表中的记录数量保持相对静态，并且性能不会随着时间的推移而降低。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-08T14:47:07.243

您将需要分离您的审计数据。随着时间的推移，将当前数据与审计数据保存在一起会影响性能。

最简单的实现是创建一个与生产模式相同的单独数据库。为审计数据库中的每个表添加一个日期时间戳。从生产主键和新的日期时间戳创建一个复合主键。

在生产数据库上设置触发器，以便生产数据库中的每个插入/更新都会触发对审计数据库的插入。插入审计数据库的值将是新插入的值。

仅将审计数据库用于审计报告目的。

或者，您还可以考虑创建一个数据集市，该数据集市将负责跟踪随时间的变化。（但这需要很多时间和精力）

# java - 我可以使用类对象实例化一个类吗？构造函数呢？

> ID：712371
> 
> 赞同：15
> 
> 时间：2009-04-03T02:38:29.027
> 
> 标签：java, reflection

我正在通过 ( `Classname.class`) 存储一个类列表并想实例化一个？这可能吗？

`newInstance`似乎是我追求的方法，但它不支持构造函数？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-04-03T02:41:27.067

您可以使用[Class.getConstructors](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#getConstructors())（或 Class.getConstructor）来获取可用构造函数的列表，并使用[Constructor.newInstance](http://java.sun.com/javase/6/docs/api/java/lang/reflect/Constructor.html#newInstance(java.lang.Object...))调用它们中的任何一个，它接受参数。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-05T03:36:41.117

只是为了补充一点，我认为缺少：

如果对象具有公共 null 构造函数，则可以`newInstance`直接在对象上调用。`Class`（空构造函数是没有参数的构造函数。）

否则，您可以`Class.getConstructors()`像其他人所说的那样找到构造函数。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-03T02:54:46.037

Java[反射教程](http://java.sun.com/docs/books/tutorial/reflect/member/ctorInstance.html)很好地涵盖了这一点。但是，是的，基本上是 Class.getConstructors，然后是 Constructor.newInstance。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-03T13:09:57.963

Java 被设计成只要你使用 java.lang/java 就永远不能“欺骗”它。类或其他标准库。OOP 最重要的事情之一是对象应该处于已定义的状态，因此构造函数始终运行是安全的。即使您使用一些看起来很奇怪的反射库来完成您的工作。

因此，使用 Class.forName("me.Test").newInstance(); （或类似的）将在后台为您调用 Test() 构造函数。

如果要调用另一个构造函数，代码类似于：

```
Test test = (Test)Class.forName("Test").getConstructor(String.class).newInstance("Hello World"); 
```

这里 getConstructor 询问构造函数的样子（它需要一个字符串），然后你用一个字符串调用它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-05T08:43:44.590

您不能以这种方式构造新类。

如果您有一个类的名称，您可以使用 Class.forName(className) 来加载/引用一个类。

如果您有要创建的类的字节码，则可以让类加载器加载字节码并为您提供类。这可能比您预期的更先进。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-03T10:45:33.427

如果您有`Class`通过类文字获得的对象列表，那么您最好静态引用构造函数，而不是陷入反射的邪恶。

# c# - 关闭应用程序并运行外部应用程序

> ID：712380
> 
> 赞同：3
> 
> 时间：2009-04-03T02:41:34.947
> 
> 标签：c#

我正在为我的应用程序编写更新系统，我需要关闭应用程序以覆盖 exe，但在它关闭后我需要运行更新可执行文件，我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T02:44:45.577

您可以使用启动更新程序`Process.Start`并让它等到您的主程序关闭吗？我认为这将是最简单的解决方案。

或者您可以有一个单独的启动程序，在启动主应用程序之前检查更新和更新。但是，如果您必须更新启动器，这会导致同样的问题。

* * *

沿着这条线：

```
static void Main(string[] args)
{
  var haveToUpdate = ...;
  if (haveToUpdate)
  {
    Process.Start("update.exe");
    Environment.Exit(0);
  }
}

static void Main(string[] args)
{
  var processes = Process.GetProcessesByName("program.exe");

  if (processes.Length > 1)
    throw new Exception("More than one program.exe running");
  else if (processes.Length == 0)
    Update();
  else
    processes[0].Exited += new EventHandler(Program_Exited);
}

static void Program_Exited(object sender, EventArgs e)
{
  Update();
}

static void Update()
{
  // ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T03:41:41.510

反过来做。使用旧应用程序获取整个更新文件（临时存储），然后使用进程启动启动更新程序应用程序。更新所要做的就是将新文件复制到旧文件上并重新启动应用程序。

更新程序可以捕获访问被拒绝的异常并等待应用程序变得可用于被复制。复制完成后 - 它会删除临时新文件并在关闭之前再次启动应用程序。

然后，您可以根据需要更新更新程序（使用普通应用程序）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T02:46:03.063

我猜你需要另一个小的更新应用程序。你用 Process.Start() 启动它，让这个辅助进程替换可执行文件并用 Process.Start() 再次启动新的。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-03T02:44:45.813

在关闭应用程序之前运行更新可执行文件。

# php - 从 PHP 页面使用 GMail SMTP 服务器发送电子邮件

> ID：712392
> 
> 赞同：403
> 
> 时间：2009-04-03T02:47:59.907
> 
> 标签：php, email, smtp, gmail

我正在尝试从 PHP 页面通过 GMail 的 SMTP 服务器发送电子邮件，但出现此错误：

> 身份验证失败 [SMTP：SMTP 服务器不支持身份验证（代码：250，响应：mx.google.com 为您服务，[98.117.99.235] SIZE 35651584 8BITMIME STARTTLS ENHANCEDSTATUSCODES PIPELINING）]

任何人都可以帮忙吗？这是我的代码：

```
<?php
require_once "Mail.php";

$from = "Sandra Sender <sender@example.com>";
$to = "Ramona Recipient <ramona@microsoft.com>";
$subject = "Hi!";
$body = "Hi,\n\nHow are you?";

$host = "smtp.gmail.com";
$port = "587";
$username = "testtest@gmail.com";
$password = "testtest";

$headers = array ('From' => $from,
  'To' => $to,
  'Subject' => $subject);
$smtp = Mail::factory('smtp',
  array ('host' => $host,
    'port' => $port,
    'auth' => true,
    'username' => $username,
    'password' => $password));

$mail = $smtp->send($to, $headers, $body);

if (PEAR::isError($mail)) {
  echo("<p>" . $mail->getMessage() . "</p>");
 } else {
  echo("<p>Message successfully sent!</p>");
 }
?> 
```

* * *

## 回答 #1

> 赞同：364
> 
> 时间：2010-05-01T04:02:10.480

```
// Pear Mail Library
require_once "Mail.php";

$from = '<fromaddress@gmail.com>';
$to = '<toaddress@yahoo.com>';
$subject = 'Hi!';
$body = "Hi,\n\nHow are you?";

$headers = array(
    'From' => $from,
    'To' => $to,
    'Subject' => $subject
);

$smtp = Mail::factory('smtp', array(
        'host' => 'ssl://smtp.gmail.com',
        'port' => '465',
        'auth' => true,
        'username' => 'johndoe@gmail.com',
        'password' => 'passwordxxx'
    ));

$mail = $smtp->send($to, $headers, $body);

if (PEAR::isError($mail)) {
    echo('<p>' . $mail->getMessage() . '</p>');
} else {
    echo('<p>Message successfully sent!</p>');
} 
```

* * *

## 回答 #2

> 赞同：110
> 
> 时间：2012-09-07T12:10:18.800

使用[**Swift mailer**](http://swiftmailer.org/)，很容易通过 Gmail 凭据发送邮件：

```
<?php
require_once 'swift/lib/swift_required.php';

$transport = Swift_SmtpTransport::newInstance('smtp.gmail.com', 465, "ssl")
  ->setUsername('GMAIL_USERNAME')
  ->setPassword('GMAIL_PASSWORD');

$mailer = Swift_Mailer::newInstance($transport);

$message = Swift_Message::newInstance('Test Subject')
  ->setFrom(array('abc@example.com' => 'ABC'))
  ->setTo(array('xyz@test.com'))
  ->setBody('This is a test mail.');

$result = $mailer->send($message);
?> 
```

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2009-04-03T03:00:15.417

您的代码似乎没有使用 TLS (SSL)，这是[向 Google 发送邮件所必需的（并使用端口 465 或 587）](http://mail.google.com/support/bin/answer.py?hl=en&answer=13287)。

您可以通过设置来做到这一点

`$host = "ssl://smtp.gmail.com";`

你的代码看起来很像[这个例子](http://www.linuxquestions.org/questions/programming-9/php-pear-mail-packege-support-security-through-ssl-586976/)，它在主机名方案中引用了 ssl://。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2013-08-02T16:42:52.303

我不推荐梨邮件。自 2010 年以来一直没有更新。另请阅读源文件；源代码几乎已经过时，以 PHP 4 风格编写，并且已经发布了许多错误/错误（Google it）。我正在使用 Swift Mailer。

**Swift Mailer**集成到任何用 PHP 5 编写的 Web 应用程序中，提供了一种灵活而优雅的面向对象的方法来发送具有多种功能的电子邮件。

> 使用 SMTP、sendmail、postfix 或您自己的自定义传输实现发送电子邮件。
> 
> 支持需要用户名和密码和/或加密的服务器。
> 
> 在不剥离请求数据内容的情况下防止标头注入攻击。
> 
> 发送符合 MIME 的 HTML/多部分电子邮件。
> 
> 使用事件驱动插件来自定义库。
> 
> 处理内存使用量低的大型附件和内联/嵌入图像。

它是一个免费的开源软件，您可以[**下载 Swift Mailer**](http://swiftmailer.org/download)并上传到您的服务器。（功能列表是从所有者网站复制的）。

Gmail SSL/SMTP 和 Swift Mailer 的工作示例在这里...

```
// Swift Mailer Library
require_once '../path/to/lib/swift_required.php';

// Mail Transport
$transport = Swift_SmtpTransport::newInstance('ssl://smtp.gmail.com', 465)
    ->setUsername('username@gmail.com') // Your Gmail Username
    ->setPassword('my_secure_gmail_password'); // Your Gmail Password

// Mailer
$mailer = Swift_Mailer::newInstance($transport);

// Create a message
$message = Swift_Message::newInstance('Wonderful Subject Here')
    ->setFrom(array('sender@example.com' => 'Sender Name')) // can be $_POST['email'] etc...
    ->setTo(array('receiver@example.com' => 'Receiver Name')) // your email / multiple supported.
    ->setBody('Here is the <strong>message</strong> itself. It can be text or <h1>HTML</h1>.', 'text/html');

// Send the message
if ($mailer->send($message)) {
    echo 'Mail sent successfully.';
} else {
    echo 'I am sure, your configuration are not correct. :(';
} 
```

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2011-12-25T12:19:00.670

```
<?php
date_default_timezone_set('America/Toronto');

require_once('class.phpmailer.php');
//include("class.smtp.php"); // optional, gets called from within class.phpmailer.php if not already loaded

$mail             = new PHPMailer();

$body             = "gdssdh";
//$body             = eregi_replace("[\]",'',$body);

$mail->IsSMTP(); // telling the class to use SMTP
//$mail->Host       = "ssl://smtp.gmail.com"; // SMTP server
$mail->SMTPDebug  = 1;                     // enables SMTP debug information (for testing)
                                           // 1 = errors and messages
                                           // 2 = messages only
$mail->SMTPAuth   = true;                  // enable SMTP authentication
$mail->SMTPSecure = "ssl";                 // sets the prefix to the servier
$mail->Host       = "smtp.gmail.com";      // sets GMAIL as the SMTP server
$mail->Port       = 465;                   // set the SMTP port for the GMAIL server
$mail->Username   = "user@gmail.com";  // GMAIL username
$mail->Password   = "password";            // GMAIL password

$mail->SetFrom('contact@prsps.in', 'PRSPS');

//$mail->AddReplyTo("user2@gmail.com', 'First Last");

$mail->Subject    = "PRSPS password";

//$mail->AltBody    = "To view the message, please use an HTML compatible email viewer!"; // optional, comment out and test

$mail->MsgHTML($body);

$address = "user2@yahoo.co.in";
$mail->AddAddress($address, "user2");

//$mail->AddAttachment("images/phpmailer.gif");      // attachment
//$mail->AddAttachment("images/phpmailer_mini.gif"); // attachment

if(!$mail->Send()) {
  echo "Mailer Error: " . $mail->ErrorInfo;
} else {
  echo "Message sent!";
}

?> 
```

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2010-12-23T14:57:40.673

[SwiftMailer](http://www.swiftmailer.org)可以使用外部服务器发送电子邮件。

下面是一个展示如何使用 Gmail 服务器的示例：

```
require_once "lib/Swift.php";
require_once "lib/Swift/Connection/SMTP.php";

//Connect to localhost on port 25
$swift =& new Swift(new Swift_Connection_SMTP("localhost"));

//Connect to an IP address on a non-standard port
$swift =& new Swift(new Swift_Connection_SMTP("217.147.94.117", 419));

//Connect to Gmail (PHP5)
$swift = new Swift(new Swift_Connection_SMTP(
    "smtp.gmail.com", Swift_Connection_SMTP::PORT_SECURE, Swift_Connection_SMTP::ENC_TLS)); 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2010-04-16T01:50:49.610

问题中列出的代码需要两个更改

```
$host = "ssl://smtp.gmail.com";
$port = "465"; 
```

SSL 连接需要端口 465。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2016-09-26T10:17:58.350

通过 Gmail 使用 phpMailer 库发送邮件 请从[Github下载库文件](https://github.com/PHPMailer/PHPMailer)

```
<?php
/**
 * This example shows settings to use when sending via Google's Gmail servers.
 */
//SMTP needs accurate times, and the PHP time zone MUST be set
//This should be done in your php.ini, but this is how to do it if you don't have access to that
date_default_timezone_set('Etc/UTC');
require '../PHPMailerAutoload.php';
//Create a new PHPMailer instance
$mail = new PHPMailer;
//Tell PHPMailer to use SMTP
$mail->isSMTP();
//Enable SMTP debugging
// 0 = off (for production use)
// 1 = client messages
// 2 = client and server messages
$mail->SMTPDebug = 2;
//Ask for HTML-friendly debug output
$mail->Debugoutput = 'html';
//Set the hostname of the mail server
$mail->Host = 'smtp.gmail.com';
// use
// $mail->Host = gethostbyname('smtp.gmail.com');
// if your network does not support SMTP over IPv6
//Set the SMTP port number - 587 for authenticated TLS, a.k.a. RFC4409 SMTP submission
$mail->Port = 587;
//Set the encryption system to use - ssl (deprecated) or tls
$mail->SMTPSecure = 'tls';
//Whether to use SMTP authentication
$mail->SMTPAuth = true;
//Username to use for SMTP authentication - use full email address for gmail
$mail->Username = "username@gmail.com";
//Password to use for SMTP authentication
$mail->Password = "yourpassword";
//Set who the message is to be sent from
$mail->setFrom('from@example.com', 'First Last');
//Set an alternative reply-to address
$mail->addReplyTo('replyto@example.com', 'First Last');
//Set who the message is to be sent to
$mail->addAddress('whoto@example.com', 'John Doe');
//Set the subject line
$mail->Subject = 'PHPMailer GMail SMTP test';
//Read an HTML message body from an external file, convert referenced images to embedded,
//convert HTML into a basic plain-text alternative body
$mail->msgHTML(file_get_contents('contents.html'), dirname(__FILE__));
//Replace the plain text body with one created manually
$mail->AltBody = 'This is a plain-text message body';
//Attach an image file
$mail->addAttachment('images/phpmailer_mini.png');
//send the message, check for errors
if (!$mail->send()) {
    echo "Mailer Error: " . $mail->ErrorInfo;
} else {
    echo "Message sent!";
} 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2016-10-25T10:56:37.863

我也有这个问题。我设置了正确的设置并启用了不太安全的应用程序，但它仍然无法正常工作。最后，我启用了这个[https://accounts.google.com/UnlockCaptcha](https://accounts.google.com/UnlockCaptcha)，它对我有用。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-07-11T21:26:26.410

Gmail需要465端口，也是phpmailer的代码

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-04-11T11:08:08.690

要在 Ubuntu 中安装 PEAR 的 Mail.php，请运行以下命令集：

```
 sudo apt-get install php-pear
    sudo pear install mail
    sudo pear install Net_SMTP
    sudo pear install Auth_SASL
    sudo pear install mail_mime 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-09-01T15:20:46.637

对于没有“@gmail.com”后缀的 GSuite 帐户，我有一个解决方案。此外，我认为它适用于 @gmail.com 的 GSuite 帐户，但尚未尝试过。首先，您应该有权为您的 GSuite 帐户更改“allos¿w 不太安全的应用程序”选项。如果您有权限（您可以检查帐户设置-> 安全性），那么您必须停用“两步因素身份验证”，转到页面末尾并设置为“是”以允许不太安全的应用程序。就这样。如果您没有更改这些选项的权限，则此线程的解决方案将不起作用。检查[https://support.google.com/a/answer/6260879?hl=en](https://support.google.com/a/answer/6260879?hl=en)以更改“允许更少...”选项。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-10-09T05:19:38.480

我尝试了@shasi kanth 提供的建议，但没有成功。我阅读了文档，并且几乎没有进行任何更改。因此，我设法使用此代码通过 Gmail 发送邮件，其中 vendor/autoload.php 由作曲家使用 composer require "swiftmailer/swiftmailer:^6.0" 获得：

```
<?php
     require_once 'vendor/autoload.php';
     $transport = (new Swift_SmtpTransport('smtp.gmail.com', 465, 'ssl'))->setUsername ('SendingMail')->setPassword ('Password');

     $mailer = new Swift_Mailer($transport);

     $message = (new Swift_Message('test'))
      ->setFrom(['Sending mail'])
      ->setTo(['Recipient mail'])
      ->setBody('Message')
  ;

     $result = $mailer->send($message);
    ?> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-01-20T22:12:35.233

我知道这是一个老问题，但它仍然有效，我看到的所有答案都显示了基本身份验证，这已被弃用。下面是一个示例，展示了如何使用带有 XOAUTH2 身份验证的 PHPMailer 通过 Google 的 Gmail 服务器使用 SMTP 发送电子邮件：

```
//Import PHPMailer classes into the global namespace
use PHPMailer\PHPMailer\PHPMailer;
use PHPMailer\PHPMailer\SMTP;
use PHPMailer\PHPMailer\OAuth;
//Alias the League Google OAuth2 provider class
use League\OAuth2\Client\Provider\Google;

//SMTP needs accurate times, and the PHP time zone MUST be set
//This should be done in your php.ini, but this is how to do it if you don't have access to that
date_default_timezone_set('Etc/UTC');

//Load dependencies from composer
//If this causes an error, run 'composer install'
require '../vendor/autoload.php';

//Create a new PHPMailer instance
$mail = new PHPMailer();

//Tell PHPMailer to use SMTP
$mail->isSMTP();

//Enable SMTP debugging
//SMTP::DEBUG_OFF = off (for production use)
//SMTP::DEBUG_CLIENT = client messages
//SMTP::DEBUG_SERVER = client and server messages
$mail->SMTPDebug = SMTP::DEBUG_SERVER;

//Set the hostname of the mail server
$mail->Host = 'smtp.gmail.com';

//Set the SMTP port number:
// - 465 for SMTP with implicit TLS, a.k.a. RFC8314 SMTPS or
// - 587 for SMTP+STARTTLS
$mail->Port = 465;

//Set the encryption mechanism to use:
// - SMTPS (implicit TLS on port 465) or
// - STARTTLS (explicit TLS on port 587)
$mail->SMTPSecure = PHPMailer::ENCRYPTION_SMTPS;

//Whether to use SMTP authentication
$mail->SMTPAuth = true;

//Set AuthType to use XOAUTH2
$mail->AuthType = 'XOAUTH2';

//Fill in authentication details here
//Either the gmail account owner, or the user that gave consent
$email = 'someone@gmail.com';
$clientId = 'RANDOMCHARS-----duv1n2.apps.googleusercontent.com';
$clientSecret = 'RANDOMCHARS-----lGyjPcRtvP';

//Obtained by configuring and running get_oauth_token.php
//after setting up an app in Google Developer Console.
$refreshToken = 'RANDOMCHARS-----DWxgOvPT003r-yFUV49TQYag7_Aod7y0';

//Create a new OAuth2 provider instance
$provider = new Google(
    [
        'clientId' => $clientId,
        'clientSecret' => $clientSecret,
    ]
);

//Pass the OAuth provider instance to PHPMailer
$mail->setOAuth(
    new OAuth(
        [
            'provider' => $provider,
            'clientId' => $clientId,
            'clientSecret' => $clientSecret,
            'refreshToken' => $refreshToken,
            'userName' => $email,
        ]
    )
);

//Set who the message is to be sent from
//For gmail, this generally needs to be the same as the user you logged in as
$mail->setFrom($email, 'First Last');

//Set who the message is to be sent to
$mail->addAddress('someone@gmail.com', 'John Doe');

//Set the subject line
$mail->Subject = 'PHPMailer GMail XOAUTH2 SMTP test';

//Read an HTML message body from an external file, convert referenced images to embedded,
//convert HTML into a basic plain-text alternative body
$mail->CharSet = PHPMailer::CHARSET_UTF8;
$mail->msgHTML(file_get_contents('contentsutf8.html'), __DIR__);

//Replace the plain text body with one created manually
$mail->AltBody = 'This is a plain-text message body';

//Attach an image file
$mail->addAttachment('images/phpmailer_mini.png');

//send the message, check for errors
if (!$mail->send()) {
    echo 'Mailer Error: ' . $mail->ErrorInfo;
} else {
    echo 'Message sent!';
} 
```

参考：[PHPMailer 示例文件夹](https://github.com/PHPMailer/PHPMailer/blob/master/examples/gmail_xoauth.phps)

* * *

## 回答 #15

> 赞同：-5
> 
> 时间：2009-04-03T02:57:06.250

放

```
'auth' => false, 
```

另外，查看端口 25 是否有效。

# c# - C#反序列化未知抽象类

> ID：712393
> 
> 赞同：2
> 
> 时间：2009-04-03T02:48:18.563
> 
> 标签：c#, .net, serialization, abstract-class

我只熟悉序列化的基础知识，现在我有了它的用处。我有一个现有的报告系统，其中包含一个 ReportBase 抽象类和多个从基类派生的报告。这些每个都有在构造函数中指定的不同报告参数，有时还有额外的方法。是否可以序列化任何派生类，然后在不知道派生类类型的情况下反序列化。

或者，我可以通过反射做一些事情来实现它。我可能会将序列化的对象存储到数据库中，因此可以将报告类添加到我想的另一个字段中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T03:02:31.293

是的，当然**可以**在不知道对象的实际类型的情况下进行反序列化。事实上，为了反序列化，您不需要知道任何关于类型的信息。在二进制意义上，反序列化只是将字节数组转换为原始类型并将引用作为对象返回。之后，您可以自由地将其转换为实例的任何合法类型。

例如，以下代码会将流反序列化为对象并将引用转换为 ReportBase 类型。

```
public static void Deserialize(Stream stream)
{
    BinaryFormatter formatter = new BinaryFormatter();
    object obj = formatter.Deserialize(stream);
    ReportBase report= (ReportBase) obj;
} 
```

请注意上面我说这是可能的。为了使其工作，stream 必须指向 ReportBase 派生类的有效序列化实例，并且该类必须符合序列化规则。

创建一个预期但不可序列化的类非常容易：http: [//blogs.msdn.com/jaredpar/archive/2009/03/31/is-it-serializable.aspx](http://blogs.msdn.com/jaredpar/archive/2009/03/31/is-it-serializable.aspx)

# c# - Silverlight - 与 ObservableCollections 绑定

> ID：712398
> 
> 赞同：1
> 
> 时间：2009-04-03T02:52:59.647
> 
> 标签：c#, silverlight, data-binding, xaml

这无疑是一个新问题，但我一直在寻找无济于事的答案。我的设置很简单：我在 XAML 中定义了一个 ListBox 控件，并且`ObservableCollection<MyClass>`在同一个类中。我将 绑定`ObservableCollection<MyClass>`到 ListBox。

在 XAML 中此 ListBox 的层次结构中，我想绑定到给定的 MyClass 对象，而不是绑定到 MyClass 对象的子属性。

为了澄清，我有如下所示的 XAML（我在代码中绑定了 ObservableCollection）：

```
 <ListBox x:Name="MyListBox">
    <ListBox.ItemTemplate>
     <DataTemplate>
      <MyControls:SpecialControl MyClassObj="{Binding !!!}" />
     </DataTemplate>
    </ListBox.ItemTemplate>
  </ListBox> 
```

当然有一种方法可以获取 ObservableCollection 的对象，而不是被迫绑定到它的一个子属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T03:00:44.120

`Path`如果要使用绑定对象本身，则不必指定 a ：

```
<ListBox x:Name="MyListBox">
  <ListBox.ItemTemplate>
    <DataTemplate>
      <MyControls:SpecialControl MyClassObj="{Binding}" />
    </DataTemplate>
  </ListBox.ItemTemplate>
</ListBox> 
```

顺便说一句：您可以使用控件的`DataContext`属性将控件绑定到对象，而不是自定义属性：

```
<ListBox x:Name="MyListBox">
  <ListBox.ItemTemplate>
    <DataTemplate>
      <MyControls:SpecialControl DataContext="{Binding}" />
    </DataTemplate>
  </ListBox.ItemTemplate>
</ListBox> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T03:07:30.530

除了在 XAML 中指定绑定路径外，您还必须将集合绑定到 ListBox。

C＃

```
ObservableCollection<MyClass> myCollection = new ObservableCollection<MyClass>();
MyListBox.DataContext = myCollection; 
```

除非您重写了 MyClass 上的 ToString 方法，否则您使用的 XAML 不会特别有用。即使你说你不是你确定它不是你想要绑定的 MyClass 的属性？我不明白您为什么要直接绑定到集合对象。

XAML

```
<ListBox x:Name="MyListBox">  
    <ListBox.ItemTemplate>    
        <DataTemplate>      
            <MyControls:SpecialControl MyClassObj="{Binding Path=MyClassProperty}" />    
        </DataTemplate>  
     </ListBox.ItemTemplate>
</ListBox> 
```

# eclipse - Bazaar OS X 安装程序将可执行文件放在哪里？

> ID：712402
> 
> 赞同：2
> 
> 时间：2009-04-03T02:54:56.223
> 
> 标签：eclipse, macos, bazaar

我最近在我的 Mac 笔记本电脑上安装了 Bazaar，我正试图让 bzreclipse 工作。为此，我需要告诉它 bzr 可执行文件在哪里。我不知道安装程序把它放在哪里。有谁知道这个的默认位置是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T02:59:06.307

打开终端并执行`which bzr`. 那应该告诉您可执行文件的路径。

# objective-c - 创建简单的测试objective-c对象

> ID：712404
> 
> 赞同：1
> 
> 时间：2009-04-03T02:57:45.967
> 
> 标签：objective-c, xcode

是否可以在具有一些基本测试代码的 xcode 中创建一个简单的目标 C 对象，然后只执行这个对象，然后执行另一个 main()？

即我有一个 LdapWrapper 类，我想编写一个可以按需运行的 LdapWrapperTest 类（它不能成为构建过程的一部分，因为它取决于对 ldap 服务器的访问）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T03:36:07.157

[使用 OCUnit 测试您的代码](http://developer.apple.com/tools/unittest.html)

它有点旧，但基础知识可能没有太大变化。还可以从文档系统访问“XCode 单元测试指南”。本质上，您要做的是向您的项目添加另一个*目标。*这将与您的应用程序分开构建和运行。单元测试系统可能会处理您要问的大部分后续问题。

# shell - 删除它所在的所有文件夹的脚本

> ID：712405
> 
> 赞同：1
> 
> 时间：2009-04-03T02:57:54.500
> 
> 标签：shell, batch-file

这里的任何人都可以用一个脚本帮助我，让我在运行时删除它所在的任何文件夹中的所有文件夹及其内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T03:08:53.273

什么操作系统？您还想删除当前目录中的**文件吗？**

Windows下的cmd.exe下，对于文件，可以运行

```
del /s /q * 
```

或仅删除**文件夹**及其内容，

```
for /d %d in (*.*) do rmdir /s /q %d 
```

在大多数 Linux/UNIX shell 下，要删除**文件和文件夹**，您可以运行

```
rm -rf * 
```

或者正如derobert在下面指出的（并整理了一下），您可以**只使用文件夹**及其内容

```
find . -maxdepth 1 -not -name '.' -type d -exec rm -rf \{\} \; 
```

这将找到当前目录（maxdepth 1）中不包括当前目录“.”的所有目录，并在每个目录上运行 rm -rf。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T05:07:39.230

在 Unix 上，您可以执行以下操作：

```
find -type d -maxdepth 1 -not -name '.' -print0 | xargs -0 rm -Rf 
```

这将删除当前工作目录中的所有文件夹（及其内容），只留下不在文件夹中的文件。鉴于：

```
test/folder1
test/folder1/file1
test/file2 
```

如果您在 中运行它`test`，则只剩下 file2 。

# gridview - GridView 上的 TextBox 导致触发按钮单击事件

> ID：712407
> 
> 赞同：1
> 
> 时间：2009-04-03T02:58:18.167
> 
> 标签：gridview, textbox, onchange

我已经追了几天这个，它开始让我有点发疯。

我在 Gridview 上有一个文本框，我允许编辑一些数据。当按下回车键时，会发生 TextChanged 事件，正如我所期望的那样，但它也会触发表单上按钮的 OnClick 事件。

我尝试删除该按钮，它只是移动到表单上的下一个按钮，所以有一些关于这个的东西让它认为输入键正在按下按钮。

我试过用谷歌搜索它，但我看到的不多。我尝试在这里搜索，但这似乎很不寻常，以至于我的搜索词没有抓住它。任何帮助或建议都将受到欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T03:18:32.517

尝试设置`UseSubmitBehavior="False"`页面上的按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-06T11:48:38.417

`AutoPostBack`将文本框的属性更改为`true`. 通过这样做，您也不必担心任何按钮的提交行为。

```
txtbox.AutoPostBack = true; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T03:09:16.690

您的按钮具有称为 IsCancel 和 IsDefault 的属性。如果您禁用它们，它将解决您的问题。

这些属性允许将按钮视为单击输入和退出键的默认操作。

# domain-driven-design - 在 DDD 中将实体分解为更小的实体？

> ID：712408
> 
> 赞同：1
> 
> 时间：2009-04-03T02:58:47.697
> 
> 标签：domain-driven-design

如果您以不同的方式考虑它们在应用程序中的用法，那么制作实体的子集是否有意义？IE。我使用我的实体并定义一个新实体，其中只有第一个实体的一些属性。现在我有 2 个重叠但使用方式不同但最终保留在同一个数据表中的实体。这些实体将通过不同的存储库访问...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T03:15:01.357

我自己才开始学习 DDD，所以如果我错了，请发表评论并告诉我。以下是我的想法：

如果要通过不同的存储库访问实体，我认为它应该拥有自己的类。此外，现在重叠的位将来可能不会重叠，如果您使用共享基类，您可能更有可能在那时尝试调整事物，这会弄脏您的域。

如果这两个类是不同子域的一部分，它们可能应该是独立的。我的想法是基于我记得在[Rob Connery 在 Hanselminutes 上的采访中](http://www.hanselminutes.com/default.aspx?showID=158)听到的一个例子的一部分。产品具有对消费者很重要的几个属性（定价、描述等），以及对仓库人员很重要的几个属性（在仓库中的位置、重量、尺寸等）。在那一集中对我的暗示是，这两个产品应该在域中单独定义，而不是定义一次并共享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T07:07:33.807

如果“在应用程序中使用”是指您将在不同的视图中显示不同的部分，那么我建议您使用 Fowler 在其[演示模型](http://martinfowler.com/eaaDev/PresentationModel.html)中描述的演示模式（或者如果您开发 WPF 应用程序，您可以使用更多WPF 专用版本称为[Model-View-ViewModel (MVVM](http://joshsmithonwpf.wordpress.com/2008/12/01/the-philosophies-of-mvvm/) )。

但是，如果您所说的“使用”意味着您将在不同的子域或域的一部分中使用实体的不同属性，那么我同意 Chris 的观点；您最好将它们分成不同的实体。原因是在您的域模型中，您应该反映实体在该特定（子）域中的使用方式。如果您在不同情况下使用实体的不同部分，它们在这些设置中可能具有不同的含义，这再次应反映在实体的命名中。如果是我，我可能会为每个实体创建一个存储库。就我所经历的而言，在大多数情况下，实体和存储库之间的 1:1 映射似乎是有意义的。但话又说回来; 就像 Chris、Rob Conery 和 90% 尝试做 DDD 的开发人员一样；一世'

# .net - 小型大写字体属性？

> ID：712411
> 
> 赞同：3
> 
> 时间：2009-04-03T03:00:30.127
> 
> 标签：.net, fonts

我正在寻找一种方法来创建一个 .NET Font 对象，当您选中“Small Caps”复选框时，该对象可以像 Word 中一样格式化文本。我没有在 Font 对象上看到 Format Style 来执行此操作，我想知道是 A. 我缺少某些东西还是 B. 那里有一个第三方库（最好是免费的）可以做到这一点反而。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T03:09:52.320

如果您使用的是 WPF，请查看[Typography.Capitals](http://msdn.microsoft.com/en-us/library/system.windows.documents.typography.capitals.aspx)。还要看看这个问题的一些陷阱：[WFP/XAML: Typography.Capitals 似乎没有效果](https://stackoverflow.com/questions/636454/wfp-xaml-typography-capitals-seems-to-have-no-effect)。

我不确定它是否适合您，但您可能很幸运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T03:01:52.917

没有这样的财产。但是，您可以通过使用较小字体的普通大写字母来伪造小型大写字母。

# data-structures - 普通链表、链表和双链表：何时以及为什么？

> ID：712429
> 
> 赞同：5
> 
> 时间：2009-04-03T03:13:52.590
> 
> 标签：data-structures, language-agnostic, linked-list

在什么情况下我应该使用每种列表？各有什么优势？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-03T03:23:30.867

## 普通清单：

按顺序存储每个项目，因此随机查找非常快（即我可以立即说“我想要第 657415671567 个元素，然后直接去找它，因为我们知道它的内存地址将比第一个项目大 657415671567）。这几乎没有或者没有存储内存开销。但是，它无法自动调整大小 - 您必须创建一个新数组，复制所有值，然后删除旧数组。当您需要从任何地方查找数据时，普通列表很有用在列表中，并且您知道您的列表不会超过特定大小。

## 链表：

每个项目都有对下一个项目的引用。这意味着有一些开销（存储对下一项的引用）。此外，由于它们不是按顺序存储的，因此您不能立即转到第 657415671567 个元素 - 您必须从头部（第一个元素）开始，然后获取它的引用以转到第二个元素，然后获取它的引用，到第三个，...然后得到它的参考到第 657415671566th，然后得到它的参考到第 657415671567th。这样，对于随机查找来说，效率非常低。但是，它允许您修改列表的长度。如果您的任务是按顺序遍历每个项目，那么它与普通列表的值大致相同。如果您需要更改列表的长度，它可能比普通列表更好。如果你知道第 566 个元素，并且你 重新寻找第 567 个，那么您需要做的就是按照对下一个的参考。但是，如果您知道第 567 个并且正在寻找第 566 个，则找到它的唯一方法是再次从第一个元素开始搜索。这就是双链表派上用场的地方......

## 双链表：

双链表存储对前一个元素的引用。*这意味着您可以前后*遍历列表。这在某些情况下可能非常有用（例如链接列表部分中给出的示例）。除此之外，它们与链接列表具有大部分相同的优点和缺点。

## 评论区的回答：

**用作队列：** 您必须考虑所有这些优点和缺点：您可以自信地说您的队列将具有最大大小吗？如果您的队列长度可能在 1 到 10000000000 个元素之间，那么普通列表只会浪费内存（甚至可能不够大）。在这种情况下，我会使用链接列表。但是，与其存储前后的*索引，不如实际存储节点。*

*回顾：链表由“节点”组成，每个节点存储项目以及对下一个节点的引用*

因此，您应该存储对第一个节点和最后一个节点的引用。因此，当您入队时，您将一个新节点粘贴到后端（通过将旧后端连接到新后端），并记住这个新后端节点。而且，当你出队时，你删除了前节点，并记住第二个作为新的“前节点”。这样，您就不必担心任何中间元素。因此，您可以忽略队列的长度（尽管如果您真的想要也可以存储它）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T05:31:32.120

没有人提到我最喜欢的链表：带有指向最后一个元素的指针的循环链表。您可以在任一端获得恒定时间的插入和删除，以及恒定时间的破坏性追加。唯一的代价是空列表有点棘手。这是一个甜蜜的数据结构：列表、队列和堆栈合二为一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T03:18:02.003

使用单链表，您只能向前遍历。使用双向链表，您可以向后和向前遍历列表。一般来说，如果你要使用链表，真的没有充分的理由不使用双向链表。我在学校只使用过单链接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T06:04:31.027

双向链表的一个优点是删除指定指针的节点是 O(1)。

# tsql - TSQL 将多值报告服务参数传递到动态 SQL

> ID：712430
> 
> 赞同：0
> 
> 时间：2009-04-03T03:14:14.197
> 
> 标签：tsql, reporting-services, dynamic-sql, multivalue

**重复**：[TSQL varchar 字符串操作](https://stackoverflow.com/questions/712443/tsql-varchar-string-manipulation-problem/712453#712453)

我正在使用报告服务报告中的参数构建动态 SQL 语句。报告服务以基本 CSV 格式传递 MutiValue 参数。例如，状态列表可以表示如下：AL,CA,NY,TN,VA

在 SQL 语句中，这是可以的：

```
WHERE customerState In (@StateList) 
```

但是，动态变体不行：

```
SET @WhereClause1 = @WhereClause1 + 'AND customerState IN (' + @StateList + ') ' 
```

这是因为它转换为（无效 SQL）：

```
AND customerState IN (AL,CA,NY,TN,VA) 
```

要处理它需要这样的东西：

```
AND customerState IN ('AL','CA','NY','TN','VA') 
```

是否有一些很酷的表达式可以用来将单引号插入到我的动态 SQL 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-06-30T10:49:24.373

出于某种原因，与 IN 一起使用时，REPLACE 对我不起作用。我最终使用了[CHARINDEX](http://msdn.microsoft.com/en-us/library/ms186323.aspx)

```
WHERE CHARINDEX( ',' + customerState + ',', ',' + @StateList + ',' ) > 0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-24T00:16:21.167

对于任何试图在 where 子句中使用带有多值参数的动态 SQL 并使用它来运行 SSRS 报告的人，这就是我解决它的方法......

```
create table #temp
(id, FName varchar(100), LName varchar(100))

declare @sqlQuery (nvarchar(max))
set @sqlQuery =
'insert into #temp
select 
id, 
FName, 
LName 
from dbo.table'
exec (@sqlQuery)

select 
FName, LName
from #temp
where #temp.id in (@id) -- @id being an SSRS parameter!

drop table #temp 
```

诚然，这个查询的问题是动态 SQL 将从 dbo.table 中选择所有内容，然后从 #temp 中选择是过滤器开始的地方，所以如果有大量数据 - 它可能不是那么好。但是......我试图让 REPLACE 工作或其他人发布的任何其他解决方案感到沮丧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T03:33:59.860

这需要照顾中间：

SET @StateList = REPLACE(@StateList, ',', ''',''')

然后引用边缘：

SET @WhereClause1 = @WhereClause1 + 'AND customerState IN (''' + @StateList + ''') '

# c# - 我将如何使用 linq 查找数据集中出现次数最多的数据？

> ID：712432
> 
> 赞同：2
> 
> 时间：2009-04-03T03:16:35.890
> 
> 标签：c#, linq

```
List<int> a = 11,2,3,11,3,22,9,2

//output
11 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T03:24:19.897

这可能不是最有效的方法，但它会完成工作。

```
public static int MostFrequent(IEnumerable<int> enumerable)
{
    var query = from it in enumerable
                 group it by it into g
                 select new {Key = g.Key, Count = g.Count()} ;
   return query.OrderByDescending(x => x.Count).First().Key;
} 
```

还有有趣的单行版本...

```
public static int MostFrequent(IEnumerable<int> enumerable)
{
    return (from it in enumerable
                 group it by it into g
                 select new {Key = g.Key, Count = g.Count()}).OrderByDescending(x => x.Count).First().Key;

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T03:34:44.100

```
a.GroupBy(item => item).
  Select(group => new { Key = group.Key, Count = group.Count() }).
  OrderByDescending(pair => pair.Count).
  First().
  Key; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T04:27:08.703

另一个例子 ：

```
IEnumerable<int> numbers = new[] { 11, 2, 3, 11, 3, 22, 9, 2 };
int most = numbers
    .Select(x => new { Number = x, Count = numbers.Count(y => y == x) })
    .OrderByDescending(z => z.Count)
    .First().Number; 
```

# coldfusion - 在 ColdFusion 服务器之间共享登录凭据？

> ID：712437
> 
> 赞同：3
> 
> 时间：2009-04-03T03:19:07.930
> 
> 标签：coldfusion

如果我有多个 CF8 服务器，用户是否可以在一台服务器上登录，但在所有服务器之间共享登录凭据（无需重新登录）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T12:38:11.703

也许问题是关于共享会话？这可以使用序列化的[J2EE 会话](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=sharedVars_10.html)或使用共享[客户端变量](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=sharedVars_08.html)来完成。

例如，这可以通过以下方式完成。

在其中一台服务器上创建空数据库（我创建了 MySQL 一个）。在所有 CF 服务器上创建指向该数据库的数据源。将此数据源用作服务器设置 > 客户端变量 > 客户端会话存储，名称为*SharedSessions*（我们稍后将使用它）。

如果我们在*所有服务器*上的 Application.cfm 中使用 cflogin ，它的代码可以看起来像这样（简化）：

```
<cfapplication
    name="shared_session_test"
    sessionManagement="true"
    clientmanagement="true"
    clientstorage="SharedSessions" />

<cflogin>

    <cfif IsDefined( "cflogin" ) and cflogin.name eq "admin" and cflogin.password eq "admin">
        <cfset user_roles = "administrators" />
        <cfset user_name = cflogin.name />
        <cfset user_password = cflogin.password />
    </cfif>

    <cfif IsDefined( "user_roles" )>
        <!--- push login params into shared client scope --->
        <cfset CLIENT.user_roles = user_roles />
        <cfset CLIENT.user_name = user_name />
        <cfset CLIENT.user_password = user_password />
    <cfelseif IsDefined( "CLIENT.user_roles" )>
        <!--- restore login params from shared client scope --->
        <cfset user_roles = CLIENT.user_roles />
        <cfset user_name = CLIENT.user_name  />
        <cfset user_password = CLIENT.user_password  />
    </cfif>

    <cfif IsDefined( "user_roles" )>
        <cfloginuser name="#user_name#" password="#user_password#" roles="#user_roles#">
    <cfelse>
        <!--- authentication failed - send back 401 --->
        <cfsetting enablecfoutputonly="yes" showdebugoutput="no">
        <cfheader statuscode="401">
        <cfheader name="WWW-Authenticate" value="Basic realm=""MySecurity""">
        <cfoutput>Not authorized</cfoutput>
        <cfabort />
    </cfif>

</cflogin>

<cfoutput><p><a href="http://other.server.com/index.cfm?#CLIENT.urltoken#">other.server.com</a></p></cfoutput> 
```

现在这些在两台服务器上显示相同：

```
<cfdump var="#getAuthUser()#">
<cfdump var="#CLIENT#"> 
```

当然，这里有很多事情要做，以使流程更好、更安全，只是描述了总体思路。

希望这可以帮助。

# tomcat - Railo、Tomcat IIS7 和默认文档

> ID：712442
> 
> 赞同：3
> 
> 时间：2009-04-03T03:20:59.827
> 
> 标签：tomcat, iis-7, railo, cfml

我已经使用 Tomcat v6 在 Windows 2008（32 位）服务器上设置了 Railo v3.1。一切似乎都正常，除了无论我尝试什么，我都无法让它识别我的默认文档（index.cfm）

所以：
[http://localhost/index.cfm](http://localhost/index.cfm) = 很好
[http://localhost](http://localhost) = 404.3 错误

如果我查看错误，似乎 IIS7 正在使用静态文件处理程序来处理文件 - 据我所知，404 错误不是指文件本身，而是用于处理它的 ISAPI 处理程序. 这没有多大意义。

我尝试在 IIS7 中添加单独的处理程序，但无济于事。

我认为这是 IIS7 中的一个问题，因为我发现有类似问题的人使用不同的系统发布了几个博客和论坛帖子。（Tomcat、jBoss 等）

有人遇到过这个或有解决方法吗？

有关我的设置的详细信息，我严格遵循本指南：http:
[//www.hockeypfef.net/index.cfm/2009/3/12/Installing-Railo-3-on-Windows-200832bit-with-IIS7-and-雄猫](http://www.hockeypfef.net/index.cfm/2009/3/12/Installing-Railo-3-on-Windows-200832bit-with-IIS7-and-Tomcat)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T14:21:42.663

将 /*=wlb 放入 uriworkermap.properties 文件解决了这个问题。我安装了 jBoss MSI 安装程序版本并查看了它生成的属性文件，以找出答案！

简单的答案，但我们走了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-02T14:39:36.723

之前没有看到这篇文章，但想指出我已经为 Tomcat/Railo 和 IIS 创建了一个备用连接器。您可以使用它来代替 ISAPI 连接器。配置更加直接，因为您可以使用 IIS 工具来影响将哪些文件转发到 Tomcat/Railo，也可以在 IIS 端选择默认文档。该连接器可以从 Riaforge 下载：http: [//tomcatiis.riaforge.org](http://tomcatiis.riaforge.org) 手动安装说明，并且包中还包含一个自动安装程序。可以在 Riaforge 网站上留下反馈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T14:06:31.040

我知道您正在使用 tomcat，但如果您在 IIS 上，它不会自动将所有请求转发到 railo 服务器，只有您在工作配置中定义的请求（可能只是 .cfm/.cfc）。这就是为什么 .cfm 显式有效并且没有发送 404 的原因。

在默认本地主机站点属性下的 IIS 管理器和文档选项卡中，您是否设置了默认页面 index.cfm？

[通过微软的说明](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/dc6eb1b4-9028-4308-9935-52b64edfad36.mspx?mfr=true)

[编辑] 您也可以检查您的 uriworkermap.properties 设置 / *=wlb 而不是 /* .cfm，基本上将所有内容转发到 tomcat。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T20:49:49.890

您应该将您的评论标记为答案，因此该问题被标记为已回答。

顺便说一句，对于那些对在 Tomcat 上运行 Railo、CF 或 Open BD 感兴趣的人，Matt Woodward 将在本周 4 月 16 日星期四下午 6 点的[在线 ColdFusion Meetup上发表演讲。](http://www.coldfusionmeetup.com)

# tsql - TSQL varchar 字符串操作

> ID：712443
> 
> 赞同：2
> 
> 时间：2009-04-03T03:22:09.420
> 
> 标签：tsql, string-substitution

我有一个包含以下字符串的变量：AL,CA,TN,VA,NY

我无法控制我在该变量中获得的内容（来自报告服务）

我需要让它看起来像这样：'AL'，'CA'，'TN'，'VA'，'NY'

我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T03:28:35.817

```
declare @x varchar(50) = 'AL,CA,TN,VA,NY'

select '''' + REPLACE(@x, ',', ''',''') + '''' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T03:35:11.447

我最终做了一些非常相似的事情，我认为我会发布。（不过我会感谢米奇）

这需要照顾中间：

SET @StateList = REPLACE(@StateList, ',', ''',''')

然后引用边缘：

SET @WhereClause1 = @WhereClause1 + 'AND customerState IN (''' + @StateList + ''') '

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T03:33:46.443

对于更通用的答案，当您不知道您的输出到底是什么样子时，请使用[正则表达式](http://www.simple-talk.com/sql/t-sql-programming/tsql-regular-expression-workbench/)。

这将使您可以匹配 [AZ]{2} 之类的内容并将其替换为“$&”。

一位评论者建议这对于这项任务来说太过分了——同意，如果你能保证你总是会得到一个这样的字符串。但是，其他人稍后会发现这些问题页面存在类似但不准确的问题，因此拥有其他选项会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T06:50:12.757

不要打扰动态sql。

您需要将字符串转换为表格，以便 A、B、C、D

变成

价值 A B C D

使用类似 [http://www.sqlusa.com/bestpractices/training/scripts/splitcommadelimited/的函数](http://www.sqlusa.com/bestpractices/training/scripts/splitcommadelimited/)

那么你可以使用 CROSS APPLY （这就像加入一个表，但是一个由函数创建的表）或者你可以把它放在一个表变量中并加入到那个

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-14T11:52:00.513

我想知道下面的脚本是否在 SQL 中而不是在 T-SQL 中运行

* * *

DECLARE @tblName varchar(30) SET @tblName = CONVERT(VARCHAR(20),GETDATE(),112) + '表'

DECLARE @sql nvarchar(4000) SELECT @sql = 'CREATE TABLE "' + @tblName + '" (ID VARCHAR(15), Name VARCHAR(15))'

执行（@sql）

## 去

它给了你错误

消息 170，Sev 15：第 1 行：“20090714Table”附近的语法不正确。[SQL 状态 42000]

# javascript - 将业务对象序列化为 JSON

> ID：712447
> 
> 赞同：3
> 
> 时间：2009-04-03T03:24:00.210
> 
> 标签：javascript, json, domain-driven-design, business-objects

我正在尝试将我的业务对象序列化为 JSON 以供 Javascript 应用程序使用。问题是我试图保持我的业务对象“纯粹”，因为他们不知道数据访问或持久性。在我看来，用 toJSON() 函数“稀释”我的对象会违背这个目标。另一方面，使用外部对象来序列化我的业务对象是行不通的，因为我将所有实例变量都保密。

我是否以完全错误的方式接近这个？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T03:26:28.253

如果实例变量是私有的，它们不应出现在发送到 JavaScript 应用程序的序列化中。根据定义，如果您将它们序列化并将它们发送到单独的应用程序，它们是公共的。因此，外部对象应该有某种访问它们的方法，可能是通过某种 getter 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T07:54:48.000

序列化 JSON 中的数据有什么用途？纯粹是为了报道吗？如果是这样，那么 Brian 是正确的，那些变量应该有 getter 方法。

如果序列化的目的是将数据传输到可以对其进行操作的 JavaScript 应用程序，然后返回到原始应用程序，那么最好创建一个用于序列化目的的相关类，同时仍保持强封装.

例如，在 Java 中，您可以定义一个内部类。内部类实例可以直接访问封闭类实例的所有字段，而不需要 getter 方法。或者，您可以使用正确的访问修饰符与包（或命名空间）分组，以允许序列化程序访问，但不允许任何其他类访问。

或者你可以使用反射。或者劫持 toString 方法。（或者闪耀它并创建一个 toJson 方法。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T20:32:21.990

您是否正在考虑从非 JavaScript 代码（如服务器端 Java）生成 JSON？答案取决于：在 Javascript 和 Java 上处理 JSON 是完全不同的。已经有一个答案 wrt javascript-side，这似乎是正确的。

如果这是在 Java 上，那么有一些库可以提供帮助；例如 ( [Jackson](http://jackson.codehaus.org/Tutorial) ) 可以反序列化任何 bean，使用常规的 getX/setX 方法自省；加上额外的（和可选的）注释。

# sql-server-2008 - 如何将表移动到 SQL Server 2008 中的特定文件组

> ID：712449
> 
> 赞同：17
> 
> 时间：2009-04-03T03:26:01.453
> 
> 标签：sql-server-2008, filegroup

我刚刚创建了一个辅助文件组，并希望将一些表移到它上面，然后将其设为只读。

我不知道该怎么做？

我只用`ALTER blah blah TO MyFileGroup`吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-03T05:40:30.833

这样的事情应该会有所帮助：

```
CREATE UNIQUE CLUSTERED INDEX PK_YourTableName 
    ON dbo.YourTableName(YourPKFields)
    WITH (DROP_EXISTING = ON) ON [NewFilegroup] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T03:36:21.570

有两种方法；一个来自 SSMS，另一个使用 TSQL。

来自 SQL Server 2008 联机丛书：

> **将现有索引移动到不同的文件组或分区方案**
> 
> *   在对象资源管理器中，连接到 SQL Server 数据库引擎的一个实例，然后展开该实例。
>     
>     
> *   展开数据库，展开包含具有特定索引的表的数据库，然后展开表。
>     
>     
> *   展开索引所属的表，然后展开Indexes。
>     
>     
> *   右键单击要移动的索引，然后选择属性。
>     
>     
> *   在索引属性对话框中，选择存储页面。
>     
>     
> *   选择要在其中移动索引的文件组。
>     
>     
> 
> 您不能使用“索引属性”对话框移动使用唯一键或主键约束创建的索引。要移动这些索引，您需要使用带有 DROP CONSTRAINT 选项的 ALTER TABLE (Transact-SQL) 删除约束，然后使用带有 ADD CONSTRAINT 选项的 ALTER TABLE (Transact-SQL) 在所需文件组上重新创建约束。
> 
> 如果表或索引已分区，请选择要在其中移动索引的分区方案。

[Pre SQL Server 2008：将现有表放在不同的文件组 (SSMS)

*   展开数据库，展开包含表的数据库，然后单击表。
*   在详细信息窗格中，右键单击表，然后单击设计表。
*   右键单击任何列，然后单击“属性”。
*   在“表”选项卡上的“表文件组”列表中，选择要放置表的文件组。
*   *或者*，在文本文件组列表中，选择一个文件组，在该文件组上放置任何文本、图像和文本列。]

更有效的方法是

> 在表上创建聚集索引。如果表已经有聚集索引，您可以使用 CREATE INDEX 命令的 WITH DROP_EXISTING 子句重新创建聚集索引并将其移动到特定文件组。当表有聚集索引时，索引的叶级和表的数据页本质上是一回事。该表必须存在于聚集索引所在的位置，因此如果您创建或重新创建聚集索引（将索引放在特定文件组上），您也将表移动到新文件组。

信用：[布赖恩莫兰](http://www.sqlmag.com/Authors/AuthorID/58/58.html)

您可以创建（或重新创建）为 ON 子句指定新文件组的聚集索引，这将移动表（数据）。但是，如果您有非聚集索引并希望它们在另一个文件组上，则必须删除并重新创建它们，同时在 ON 子句中指定新文件组。[参考](http://www.sqlmag.com/Article/ArticleID/20642/sql_server_20642.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-29T13:39:20.763

我同意马克的观点。重建集群效果很好， 比 Tasks->Shrink Database->Files->*快得多*`Empty file by migrating data to another file.`

单独创建索引允许控制系统上的负载，而无需从`select * into [your.new.table.] from .....`

# c# - 专门实现 GenericType对于情况 A == B？

> ID：712452
> 
> 赞同：0
> 
> 时间：2009-04-03T03:27:32.683
> 
> 标签：c#, generics, overloading

我有一个泛型类，它接受两个类型参数，`Generic<A, B>`. 此类具有具有不同签名的方法，这些方法很长`A`并且`B`是不同的。但是，如果`A == B`签名完全匹配并且无法执行重载解决方案。是否有可能以某种方式为这种情况指定方法的专业化？还是强制编译器任意选择匹配的重载之一？

```
using System;

namespace Test
{
    class Generic<A, B>
    {
        public string Method(A a, B b)
        {
            return a.ToString() + b.ToString();
        }

        public string Method(B b, A a)
        {
            return b.ToString() + a.ToString();
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            Generic<int, double> t1 = new Generic<int, double>();
            Console.WriteLine(t1.Method(1.23, 1));

            Generic<int, int> t2 = new Generic<int, int>();
// Following line gives:
//     The call is ambiguous between the following methods
//     or properties: 'Test.Generic<A,B>.Method(A, B)' and
//     'Test.Generic<A,B>.Method(B, A)'
            Console.WriteLine(t2.Method(1, 2));   
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T03:31:12.610

鉴于纯泛型定义，无法强制编译器选择重载。它无法区分这两种方法的赢家。

只选择其中一个似乎是个好主意，但这个决定需要是确定性的。即使像文件中的第一个这样简单的东西也不是真正可行的，因为您必须考虑部分类。如果每个方法都在不同的文件中，编译器将如何选择第一种方法？

您可以做的是添加接受 int 的方法的非泛型版本。编译器将选择非通用版本而不是通用版本，并且它将在这种非常有限的情况下产生胜利。但是，您必须对可能存在冲突的每种类型重复此操作。

例如。添加此方法将解决您的编译错误，但仅适用于 int。

```
public string Method(int b, int a)
{
    return b.ToString() + a.ToString();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T04:44:02.453

感谢您提供好的答案，他们促使我采用了这个解决方案：

```
using System;

namespace Test
{
    class Generic<A, B>
    {
        public string Method(A a, B b)
        {
            return this.DefaultMethod(a, b);
        }

        protected string DefaultMethod(A a, B b)
        {
            return a.ToString() + b.ToString();
        }

        public string Method(B b, A a)
        {
            return b.ToString() + a.ToString();
        }
    }

    class Generic<A> : Generic<A, A>
    {
        public new string Method(A a, A b)
        {
            return base.DefaultMethod(a, b);
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            Generic<int, double> t1 = new Generic<int, double>();
            Console.WriteLine(t1.Method(1.23, 1));

            Generic<int> t2 = new Generic<int>();
            Console.WriteLine(t2.Method(1, 2));
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T03:49:29.917

我知道这有点违背泛型的目的，但是定义一次方法，采用两个类型的参数`object`呢？

在方法内部，您可以检查类型并确定要调用两个选项中的哪一个。

```
namespace Test
{
    class Generic<A, B>
    {
        public string Method(object a, object b)
        {
            if (a is A && b is B)
                return MethodOneTwo;
            else if (a is B && b is A)
                return MethodTwoOne;
            else
                throw new ArgumentException("Invalid Types");
        }

        private string MethodOneTwo(A a, B b)
        {
            return a.ToString() + b.ToString();
        }

        private string MethodTwoOne(B b, A a)
        {
            return b.ToString() + a.ToString();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T03:54:31.807

这将使用反射来获取方法并任意调用一个。您可以通过过滤获取方法时预期的参数和返回类型来使其更加健壮。

```
using System;
using System.Collections.Generic;
using System.Text;

namespace ConsoleApplication1
{
    using System;
    using System.Reflection;

    namespace Test
    {
        class Generic<A, B>
        {
            public string Method(A a, B b)
            {
                return a.ToString() + b.ToString();
            }

            public string Method(B b, A a)
            {
                return b.ToString() + a.ToString();
            }
        }

        class Program
        {
            static void Main(string[] args)
            {
                Generic<int, double> t1 = new Generic<int, double>();
                Console.WriteLine(t1.Method(1.23, 1));

                Generic<int, int> t2 = new Generic<int, int>();
                // Following line gives:
                //     The call is ambiguous between the following methods
                //     or properties: 'Test.Generic<A,B>.Method(A, B)' and
                //     'Test.Generic<A,B>.Method(B, A)'
               MethodInfo [] methods = t2.GetType().GetMethods();
                foreach(MethodInfo method in methods)
                {
                    if (method.Name == "Method")
                    {
                        method.Invoke(t2,new Object[2] {1,2});
                        break;
                    }
                }
            }
        }
    }
} 
```

编辑：这是一个关于您面临的问题的博客，其解决方案类似于 Jared 的。

[http://shiman.wordpress.com/2008/07/07/generic-method-overload-a-trap-for-c-net-library-developers/](http://shiman.wordpress.com/2008/07/07/generic-method-overload-a-trap-for-c-net-library-developers/)

我们真正需要的是在预编译或编译时生成具体签名的模板。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-03T03:31:00.817

不。

如果您希望编译器任意决定事情，那么您调用该方法的目的是什么？

# php - 将多个嵌入式 Flash 应用程序加载到 HTML 页面上 - 排序问题

> ID：712458
> 
> 赞同：1
> 
> 时间：2009-04-03T03:33:15.400
> 
> 标签：php, flash

我们需要在 HTML 页面上加载用 Flash 编写的网站的嵌入式版本，而不是最初设计为加载自身的多个实例。具体问题是如何让它们在嵌入时按顺序加载，因为它们都由同一个 Flash 播放器实例打开。

这是一个复杂的地图应用程序，目前，地图和数据混合在一起，因为会话变量被另一个实例覆盖，在前一个实例完成之前开始加载。我们需要一种方法让它们按顺序加载，一个在另一个开始加载之前完成。

我们可以在 URL 中指定的最多是 &order=1 或类似的。我们在后端有 PHP 和 SQL。

编辑：嵌入式版本正在加载到父站点的 iFrame 中。一个 php 文件加载一个 swf，根据父站点的需要多次加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T12:02:37.920

我会使用 Javascript 和[swfobject](http://code.google.com/p/swfobject/)将 Flash 应用程序按顺序加载到页面上。javascript 代码将包含它想要加载 Flash 应用程序的顺序，每个 Flash 应用程序应在完成加载时通知包含页面上的 javascript，方法是通过[ExternalInterface](http://livedocs.adobe.com/flex/3/langref/flash/external/ExternalInterface.html)调用 javascript 中的函数，然后触发加载列表中的下一个 Flash 应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T01:56:49.210

我很遗憾地告诉我，我的解决方案似乎不是最简单的，但可能是保持稳定版本最现实的方法，唉。可能您可能会花几天时间重构应用程序的设置核心，使其符合当前要求。

找出外部“黑客”来使其成为一种工作通常不是一件好事，因为它可能会被浪费并使事情进一步复杂化。根据经验，总而言之，你总是花更多的时间（和痛苦的时间）来调整这种“快速修复”，而不是坐下来思考一段时间。

# html - How to get rid of white space around an element?

> ID：712459
> 
> 赞同：2
> 
> 时间：2009-04-03T03:33:35.943
> 
> 标签：html, css, embed, quicktime

**SUMMARY: an embed with 100% width and height pushes its parents size to be 100% width and height of the grandparent. How do I get the embed element to collapse all the white space around it so that it fits the width and height of its parent perfectly?**

I have a page with an image, which upon being clicked gets replaced by an embed element that plays a quicktime movie.

The problem is that the embedded movie has a large amount of white space around it.

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head><title></title></head>
    <body>
        <div style="border:1px solid #000;">
        <embed id="iframeMovie" height="100%" width="100%" controller="true" target="myself" href="" src="http://images.apple.com/quicktime/troubleshooting/mov/qt_installed.mov" type="video/quicktime"></embed>
        </div>
    </body>
</html> 
```

The video is of unknown size so how do I get rid of this whitespace while leaving height and width at 100%?

EDIT: Though it doesn't show, I am actually clearing the padding and margins. The white space still remains.

EDIT 2: The white space in question is between the movie and the black border, not the black border and the browser.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T03:35:48.153

Are you clearing the default browser margin and padding? Otherwise, you need to do that.

Most people use CSS reset styles to normalize margin and padding across browsers. A good one to use is Eric Meyer's: [CSS Reset](http://meyerweb.com/eric/tools/css/reset/)

EDIT: To remove the space underneath the embed, set display: block on the embed. See: [http://media.nodnod.net/embed.html](http://media.nodnod.net/embed.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-14T11:11:53.707

WOOHOO,
I've searched a very long time for this answer and I finally found it!
You'll have to put the embed element in an object element which is in an iframe or a frame:
**The iframe page**

```
<html>
<body>
<iframe src="sample.html" height="100%" width="100%">
</iframe>
</body>
</html> 
```

**the iframe source**

```
<html>
<body>
<object height="100%" width="100%">
<embed src="sample.mov" height="100%" width="100%"/>
</object>
</body>
</html> 
```

Make sure that the height and width value in the iframe, object and embed element the same is.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T03:51:23.903

I am not familiar with embed elements, but it seems to me that when you set the width to 100%, you set it to the width of the parent element, which is a div in this case and a div occupies the whole available width as it is a block element.

So you can either float the surrounding div or display it inline to have its size adjust to the contents instead of the available space around it.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T04:07:49.433

Try setting float: left on both the div and the embedded element just like this. That will remove the extra white space.

```
<div style="border:1px solid #000; float: left; width: 100%; height: 100%;">
   <embed id="iframeMovie" height="100%" width="100%" style="float: left" controller="true" target="myself" href="" src="http://images.apple.com/quicktime/troubleshooting/mov/qt_installed.mov" type="video/quicktime"></embed>
</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T04:10:54.327

Hmm...

It's an ugly hack, but you could use a table:

```
<table width="100%" height="100%">
  <tr>
    <td align="center" valign="middle"><embed /></td>
  </tr>
</table> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T04:59:08.110

Have you used a DOM inspector to verify the whitespace isn't part of the embed?

Also, you can put it in a panel/div/etc and mess with the css:

```
position: relative; top: -10px; left: -10px; overflow: hidden; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-24T01:28:48.473

it turns out that theres no way of doing this other than making the movie scale to the size of the parent by using `scale="aspect"`.

While not the perfect solution, it will have to do for now.

# python - 在 Python 中解释数字范围

> ID：712460
> 
> 赞同：6
> 
> 时间：2009-04-03T03:33:41.327
> 
> 标签：python, numeric-ranges

在 Pylons webapp 中，我需要使用诸如“<3、45、46、48-51、77”之类的字符串并创建一个整数列表（实际上是对象的 ID）以进行搜索。

关于如何做到这一点的任何建议？我是 Python 的新手，我还没有找到任何可以帮助解决这种事情的东西。

该列表将是： [1, 2, 3, 45, 46, 48, 49, 50, 51, 77]

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-03T03:42:56.123

[从这里](http://thoughtsbyclayg.blogspot.com/2008/10/parsing-list-of-numbers-in-python.html)使用 parseIntSet

我也喜欢最后评论中的 pyparsing 实现。

parseIntSet 已在此处修改以处理“<3”类型的条目，并且仅在存在无效字符串时才吐出。

```
#! /usr/local/bin/python
import sys
import os

# return a set of selected values when a string in the form:
# 1-4,6
# would return:
# 1,2,3,4,6
# as expected...

def parseIntSet(nputstr=""):
    selection = set()
    invalid = set()
    # tokens are comma seperated values
    tokens = [x.strip() for x in nputstr.split(',')]
    for i in tokens:
        if len(i) > 0:
            if i[:1] == "<":
                i = "1-%s"%(i[1:])
        try:
            # typically tokens are plain old integers
            selection.add(int(i))
        except:
            # if not, then it might be a range
            try:
                token = [int(k.strip()) for k in i.split('-')]
                if len(token) > 1:
                    token.sort()
                    # we have items seperated by a dash
                    # try to build a valid range
                    first = token[0]
                    last = token[len(token)-1]
                    for x in range(first, last+1):
                        selection.add(x)
            except:
                # not an int and not a range...
                invalid.add(i)
    # Report invalid tokens before returning valid selection
    if len(invalid) > 0:
        print "Invalid set: " + str(invalid)
    return selection
# end parseIntSet

print 'Generate a list of selected items!'
nputstr = raw_input('Enter a list of items: ')

selection = parseIntSet(nputstr)
print 'Your selection is: '
print str(selection) 
```

这是示例运行的输出：

```
$ python qq.py
Generate a list of selected items!
Enter a list of items: <3, 45, 46, 48-51, 77
Your selection is:
set([1, 2, 3, 45, 46, 77, 48, 49, 50, 51]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-08-08T12:05:38.230

我创建了一个我觉得更易读的@vartec 解决方案版本：

```
def _parse_range(numbers: str):
    for x in numbers.split(','):
        x = x.strip()
        if x.isdigit():
            yield int(x)
        elif x[0] == '<':
            yield from range(0, int(x[1:]))
        elif '-' in x:
            xr = x.split('-')
            yield from range(int(xr[0].strip()), int(xr[1].strip())+1)
        else:
            raise ValueError(f"Unknown range specified: {x}") 
```

在这个过程中，函数变成了一个生成器:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T08:24:17.353

```
rng = "<3, 45, 46, 48-51, 77"
ids = []
for x in map(str.strip,rng.split(',')):
    if x.isdigit():
        ids.append(int(x))
        continue
    if x[0] == '<':
        ids.extend(range(1,int(x[1:])+1))
        continue
    if '-' in x:
        xr = map(str.strip,x.split('-'))
        ids.extend(range(int(xr[0]),int(xr[1])+1))
        continue
    else:
        raise Exception, 'unknown range type: "%s"'%x 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T03:45:14.747

首先，您需要弄清楚您将接受哪种语法。您当前的示例中有三个：

1.  单号：45、46

2.  小于运算符

3.  短跑范围：48-51

之后，只需将字符串拆分为标记，并检查标记的格式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T08:34:30.697

我最近也不得不为一个应用程序做类似的事情。

如果您不需要具体的数字，而只是一种查看给定数字是否在范围内的方法，则可以考虑将其解析为 Python 表达式，您可以将其 eval 为 lambda。例如`<3, 5-10, 12`可以是`func=(lambda x:x<3 or (5 <= x <= 10) or x==12))`. 然后你可以调用 lambda，`func(11)`看看 11 是否属于那里。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-03T03:56:23.487

```
>>> print range.__doc__
range([start,] stop[, step]) -> list of integers 
```

返回一个包含整数等差数列的列表。range(i, j) 返回 [i, i+1, i+2, ..., j-1]；start (!) 默认为 0。当给出 step 时，它指定增量（或减量）。例如，range(4) 返回 [0, 1, 2, 3]。终点省略！这些正是 4 个元素列表的有效索引。

```
>>> range(33,44)
[33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43]
>>> range(1,3)
[1, 2] 
```

我想你可以迭代你的列表，并适当地调用范围。

```
>>> def lessThan(n) :
...  return range(n+1)
...
>>> lessThan(4)
[0, 1, 2, 3, 4]
>>> def toFrom(n,m):
...  return range(n,m)
...
>>> toFrom(33,44)
[33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43] 
```

然后用逗号分割字符串，并为每一位解析它以找出要调用的函数，并将返回的列表连接起来。

还有什么，我会为你写的。

# c - 枚举中的元素数

> ID：712463
> 
> 赞同：49
> 
> 时间：2009-04-03T03:34:31.137
> 
> 标签：c, enums

在 C 中，有没有一种很好的方法来跟踪枚举中的元素数量？我见过

```
enum blah {
    FIRST,
    SECOND,
    THIRD,
    LAST
}; 
```

但这仅在项目是连续的并且从零开始的情况下才有效。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-06-18T19:50:25.950

如果您不分配枚举，则可以执行以下操作：

```
enum MyType {
  Type1,
  Type2,
  Type3,
  NumberOfTypes
} 
```

NumberOfTypes 将评估为 3，这是实际类型的数量。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-04-03T03:45:29.487

我不相信有。但是，如果它们不是连续的，并且您在某处还没有它们的列表，您将如何处理这样的数字？如果它们是连续的但从不同的数字开始，你总是可以这样做：

```
enum blah {
    FIRST = 128,
    SECOND,
    THIRD,
    END
};
const int blah_count = END - FIRST; 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2014-08-17T21:56:25.403

老问题，我知道。这是给有同样问题的谷歌人的。

你可以使用[X-Macros](http://www.drdobbs.com/the-new-c-x-macros/184401387)

例子：

```
//The values are defined via a map which calls a given macro which is defined later
#define ENUM_MAP(X) \
      X(VALA, 0)    \
      X(VALB, 10)   \
      X(VALC, 20)

//Using the map for the enum decl
#define X(n, v) [n] = v,
typedef enum val_list {
    ENUM_MAP(X) //results in [VALA] = 0, etc...
} val_list;
#undef X

//For the count of values
#define X(n, v) + 1
int val_list_count = 0 + ENUM_MAP(X); //evaluates to 0 + 1 + 1 + 1
#undef X 
```

这对 IDE 也是透明的，因此自动完成将正常工作（因为它全部在预处理器中完成）。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-04-03T03:37:56.793

很不幸的是，不行。那没有。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-01-27T06:59:35.133

我知道这是一个非常古老的问题，但由于接受的答案是错误的，我觉得有必要发表我自己的。我将重用已接受答案的示例，稍作修改。（假设枚举是顺序的。）

```
// Incorrect code, do not use!
enum blah {
  FIRST   =  0,
  SECOND, // 1
  THIRD,  // 2
  END     // 3
};
const int blah_count = END - FIRST;
// And this above would be 3 - 0 = 3, although there actually are 4 items. 
```

任何开发人员都知道原因：`count = last - first + 1`. 这适用于任何符号组合（两端均为负，均为正，或仅第一端为负）。你可以试试。

```
// Now, the correct version.
enum blah {
  FIRST   =  0,
  SECOND, // 1
  THIRD,  // 2
  END     // 3
};
const int blah_count = END - FIRST + 1; // 4 
```

编辑：再次阅读文本，我有疑问。这是否`END`意味着不属于所提供物品的一部分？这对我来说看起来很奇怪，但好吧，我想这可能是有道理的......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-03T03:50:06.623

好吧，由于枚举不能在运行时改变，你能做的最好的事情是：

```
enum blah {
    FIRST = 7,
    SECOND = 15,
    THIRD = 9,
    LAST = 12
};
#define blahcount 4 /* counted manually, keep these in sync */ 
```

但我发现很难想象这种信息会派上用场的情况。你到底想做什么？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-12-09T21:23:30.290

```
int enaumVals[] =
{
FIRST,
SECOND,
THIRD,
LAST
};

#define NUM_ENUMS sizeof(enaumVals) / sizeof ( int ); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-03-08T07:06:16.940

```
#include <stdio.h>

// M_CONC and M_CONC_ come from https://stackoverflow.com/a/14804003/7067195
#define M_CONC(A, B) M_CONC_(A, B)
#define M_CONC_(A, B) A##B

#define enum_count_suffix _count
#define count(tag) M_CONC(tag, enum_count_suffix)
#define countable_enum(tag, ...) \
  enum tag {__VA_ARGS__}; \
  const size_t count(tag) = sizeof((int []) {__VA_ARGS__}) / sizeof(int)

// The following declares an enum with tag `color` and 3 constants: `red`,
// `green`, and `blue`.
countable_enum(color, red, green, blue);

int main(int argc, char **argv) {
  // The following prints 3, as expected.
  printf("number of elements in enum: %d\n", count(color));
} 
```

# vb6 - VB6 默默地从表单中删除大量控制数据

> ID：712470
> 
> 赞同：3
> 
> 时间：2009-04-03T03:36:12.257
> 
> 标签：vb6, ide, corruption, frm

我的项目在 SSTab（4 个选项卡）中可能有 130 个控件（所有标签、文本框等的总和）。该项目加载正常，运行良好，我在任何时候都看不到任何错误或警告，但是当我保存带有 SStab 的表单时，SStab 数据没有保存（它完全消失了）。通常 .frm 文件的相关部分如下所示：

```
   开始 TabDlg.SSTab SSTab1
     身高 = 8895
     [所有控件的 1550 多行代码]
     宽度 = 540
   结尾
   开始 VB.Menu FileMenu
```

但最近它被裁剪为：

```
   开始 TabDlg.SSTab SSTab1
   开始 VB.Menu FileMenu
```

这非常令人沮丧！在我的 VB IDE 中，框架、sstab 和所有控件都在那里，可编辑，运行/编译正常，在任何时候都没有错误消息，但是当你保存文件时，1550 行宝贵的 sstab 数据就消失了 - 再次，没有警告或错误消息。因此，如果您退出并重新启动 IDE，则会收到表单加载错误，因为现在丢失了 60% 的代码。日志文件指向它发现的第一个错误（在这种情况下是一个没有 End 的 Begin TabDlg）——其中没有其他信息。（日志文件是在删除和保存代码后生成的，所以它没有帮助是有道理的。）

当我第一次发布这个问题时，我认为它与控件的数量有关，因为它出现在我添加控件之后，并且在我最初的几次测试中，当该控件（或其他控件）被删除时似乎消失了。现在我似乎在任何情况下都无法保存该表单，即使我删除了许多控件（使控件的数量远低于上次稳定时的数量）。

我还尝试删除 SStab 并将所有控件移动到 4 个不同的帧。我在 IDE 中成功地做到了这一点，但是当我保存时，大量数据（从滑块控件开始）丢失了。所以我不知道发生了什么。

该问题可以在两台不同的 PC 上重现，因此它似乎不是硬件/损坏的软件 VB 安装问题。

有没有其他人遇到过这样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T21:21:58.200

为每个选项卡创建一个 UserControl。这使得编辑更容易。它还允许您很好地模块化代码，因此每个选项卡都存在于自己的文件中，并且如果您愿意，它还允许您在其他地方重用选项卡。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T19:52:41.537

听起来很可怕，从来没有听说过这样的事情。

当您在表单被损坏之前将表单加载到 IDE 时，大概您没有从 VB6 获得错误日志文件？日志文件与表单文件具有相同的文件名，但文件扩展名为 .log。例如，如果加载 Myform.frm 时发生错误，Visual Basic 将创建一个名为 Myform.log 的日志文件。您可能会看到的错误消息[记录](http://msdn.microsoft.com/en-us/library/aa241679(VS.60).aspx)在手册中。

[查看 Windows 事件日志](http://support.microsoft.com/kb/308427)，看看它是否记录了针对 VB6 IDE 的任何有趣问题？

你在使用任何奇怪的控件吗？也许其中之一以某种方式破坏了 FRM 或 FRX。FRM 文件只是您显然知道的文本，格式记录在 VB6 手册中。您能在文本编辑器中看到 FRM 中的任何损坏吗？如果您删除 FRX 中定义的任何属性，它是否仍然会失败。

我想我会尝试创建一个新项目和一个新表单，然后使用 IDE 将所有控件定义复制并粘贴到其中 - 无需代码。玩一下新表格，看看是否有同样的问题。也许您可以以这种方式重新创建表单而不会出现问题。如果新表单确实存在问题，请执行相同的操作，但只使用一半的控件。也许你可以通过“二分查找”找到问题控制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-16T01:12:06.417

当 .FRM 可写但 .FRX 是只读时，我在尝试保存表单时遇到同样的问题

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T20:26:43.263

所以 SAVE 功能不起作用。

我怀疑您放置在标签条上的组件之一是罪魁祸首。

所以 ..

1) 盘点您放置在表单上的每一种组件

2）消除一个（种类），保存

3）它保存了吗？

-> 是 = 那是有问题的控制

-> 否 = 返回第 2 步，但选择另一种

当然，在第 2 步中删除某种特定类型的所有控件（例如，所有标签或所有文本框等）很重要。

然而，我从未听说过这种情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T14:23:12.247

不确定这是否是问题，但在 VB6 表单上，有 255 个（或者是 256 个）命名控件的限制。也许你遇到了这个？

绕过该限制的一种方法是使用控制数组。例如，如果您有 10 个标签，而不是 label1、label2、label3 等，您可以执行 label(0) 到 label(9)，并且只使用一个命名控件。

关于 SSTAB 值得一提的另一件事是它显示/隐藏控件的方式。虽然看起来控件位于单独的选项卡上，但实际发生的是控件正在向左移动（因此不在视图中）。也许有这么多组件，当 SSTAB 试图在设计视图中呈现控件时，它在 IDE 中对此感到窒息？

同样，不确定这是否是问题，但我知道这两个花絮相对不为人知。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-03T16:01:44.157

你不是一个人！我已经看到了这个问题。. .事实上，我现在正在处理它，这就是把我带到这个网站的原因。

自 94 年（VB3）以来我一直在使用 VB，大约 5 或 6 年前我在使用 VB6 时第一次看到这个问题。我的解决方案与您从上面回复的好人那里收到的一些建议没有什么不同：丢弃现有文件并在新文件中重建表单。我这样做了，从那以后受影响的表格一直有效。

我当前的问题以另一种更新的形式出现，替换/重建选项（大约一个月前执行）只工作了大约三周。现在问题又回来了，文件的每次新迭代都会很快损坏。根据上面关于允许控件总数的回复，我正在研究我有多少控件。. .而且，碰巧的是，我正在将主要的按钮和菜单整合到控制阵列中，仅仅是因为它会简化它们的管理。

我还可以确认您对将项目移至第二台 PC 的观察。. . 我也这样做了，问题仍然存在。此外，我可以补充一点，我已将项目从一个共享存储系统移动到另一个共享存储系统，但无济于事。（原来的存储位置在安装到 Win-tel 系统的驱动器上，而新位置在基于 UNIX 的 NAS 上！）

只是再次重建文件并检查：Controls.Count = 62，所以我没有接近前面提到的 255 控制限制。这确实很奇怪！（更不用说令人讨厌了！）

# html - 更改 flash 内容的 z 索引

> ID：712476
> 
> 赞同：2
> 
> 时间：2009-04-03T03:40:37.473
> 
> 标签：html, css, flash

基本上我的问题是我正在处理的网站有一个水平下拉菜单，我正在页面上实现一个闪存图表。

当您将鼠标悬停在菜单上时，项目会下拉到 Flash 图表后面并且不可点击。我能以某种方式解决这个问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T03:41:53.740

确保将 wmode 设置为对 Flash 内容透明。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T03:50:14.483

[bgiframe](http://plugins.jquery.com/project/bgiframe)是一个 jquery 插件，它可以让你做你所要求的；您可以在没有 jquery 的情况下执行此操作（显然），但该插件使其非常简单。技术基本上是在您想要在 Flash 顶部显示的内容周围添加一个 IFrame（这也适用于将内容悬停在下拉列表上）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-25T14:39:23.023

@Fábio Antunes - 谁仍然想知道这里是一个例子：

```
 <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/s...rsion=6,0,29,0" width="192" height="298">
          <param name="movie" value="flash/template2.swf">
          <param name="quality" value="high">
          <embed wmode="transparent"> <!--THIS IS NECESSARY TOO-->
          <param name="wmode" value="transparent">
          <embed src="flash/template2.swf" width="192" height="298" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" wmode="transparent"></embed>
        </object> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-24T20:50:04.927

但是，如果您正在实施可访问站点（现在是政府法律），则将 wmode 设置为透明/不透明将不起作用。将 wmode 设置为透明/opque 将解决覆盖问题，但会在可访问性方面产生更多问题，因为您无法进入 flash 内容，有时您可以进入它一次，但当您循环时，您将不会无法再次进入它...

# c - 如何允许两个并发进程进行通信？

> ID：712494
> 
> 赞同：8
> 
> 时间：2009-04-03T03:51:44.683
> 
> 标签：c, perl, pipe

我有两个独立的进程：一个 C 程序，它每秒输出逗号分隔的值，后跟一个换行符，以及一个接受数据（以相同格式）并处理这些数据的 Perl 程序。

C 程序输出（通过 printf）值如下：

```
1, 2, 3, 4, 5, 6  
7, 8, 9, 10, 11, 12  
... 
```

Perl 程序处于无限循环中，等待 STDIN 以处理这些数据：

```
while ($line = <STDIN>)
{
    chomp($line) # Line should now read "1,2,3,4,5,6"
    # Process data
} 
```

我希望这两个进程实时通信。标准 bash 管道不起作用（例如 process1 | process2），因为 Perl 程序在处理输入之前等待第一个程序完成。

有没有人对这个问题的解决方案有任何想法、建议或见解？先感谢您！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-03T04:02:12.663

管道应该没问题；您只需要控制何时刷新 C 程序的输出以使其可用于 perl 脚本。您可以在 C 程序中使用 来执行此操作[`fflush()`](http://www.opengroup.org/onlinepubs/007908775/xsh/fflush.html)，这将强制将 C 程序中的缓冲区推出，以便 perl 程序可以读取它。

管道本身并没有什么东西会导致 perl 程序在处理其输出之前等待 C 程序完成写入。你的 perl 程序是这样编写的，它一次处理`STDIN`一行：

```
while ($line = <STDIN>) { ... } 
```

`<>`在这种情况下，从 中读取一行`STDIN`，但如果没有可用的，它将阻塞，直到有。从 C 程序调用`fflush()`将实现这一点。

查看[有关 Pipelines 的 Wikipedia 文章](http://en.wikipedia.org/wiki/Pipeline_(Unix)#Implementation)。实现部分简要描述了管道是如何缓冲的，这将有助于您了解进程的通信方式。管道**确实**允许进程之间的并发，并且从管道读取和写入管道的进程由调度程序管理，就像其他进程一样。您的问题在于缓冲。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T03:58:04.747

C 程序应该明确地 fflush() 其输出缓冲区，或者使用 pty。后者更笨拙，但使 C 代码更简单。如果您不熟悉，请尝试“man 3 fflush”。

# passwords - 为小组存储生产密码的最佳实践

> ID：712504
> 
> 赞同：10
> 
> 时间：2009-04-03T03:59:13.230
> 
> 标签：passwords, storage, store

这不是一个技术问题。小型组织如何保护必须在几个人之间共享的敏感信息的安全，例如生产服务器的 root 密码？并非所有需要访问权限的人都在同一个位置工作。新密码可以通过电话分发，但是在存储密码时应该为团队成员强制执行哪些规则？

更新：这个问题与正确使用 root 密码无关——这只是一个例子。也许更好的例子是 SSL 密码或任何其他必须在执行管理任务的人之间共享的密码。事实是，需要生成和存储 root 密码等，并且通常需要不止一个人访问，有时这些人在不同的位置工作。问题是关于存储协议的。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T04:44:18.177

您不应该向任何服务器、生产服务器或其他服务器分发（或使用）root 密码。您不应该共享密码。

*人们应该使用自己的用户 ID 密码以自己的*身份登录（身份验证）；这是图片的一半。

正确登录后，他们应获得适当的权限（图片的授权方）。您可以将`sudo`其用于一般操作系统目的以及数据库内部的权限机制等。

这是两个不同的问题。不要越过溪流！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-03T04:14:52.600

我个人建议面临类似问题的人使用 keepass 或 roboform 之类的东西来存储密码。这些程序使用个人记住的主密码加密拇指驱动器上的密码，因此他们只需要记住主密码。如果有人丢失了他们的 U 盘，他们将有一个时间窗口来报告受损的 U 盘，并允许您更改密码。根据主密码的强度，窃取 U 盘的人将能够暴力破解主密码以获取所有其他存储的密码，这将需要一点时间。

**此外，如果有的话**，请避免超过 3 人共享任何帐户！相反，请考虑为每个人创建一个具有同等访问权限的帐户。如果恶意员工可以访问他们知道共享的帐户，他们可能更容易做恶意事情，因为他们知道您无法追究他们的责任，因为可能是多个人中的任何一个共享该帐户。

这也意味着您不必在每次有人退出时都更改密码。相反，您只需禁用/删除他们的帐户。因此，尽管您有更多帐户要管理，但当有人离开时，您的开销会更少，因为您不必通知所有人更改了密码。

编辑：哦，Roboform 还通过 SSL 提供在线密码同步服务。所以你可以让人们通过同步来检索密码。习惯了之后还挺爽的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T05:19:13.583

随着我们的出现，`sudo`我们很少需要再使用 root 密码了。在我的老店里，root 密码写在卡片上，密封在信封里，锁在系统管理员区的抽屉里。那些需要知道的人有打开抽屉的钥匙。

任何打开信封的人都必须更改密码并将新密码放入新的密封信封中。信封不经常打开。

这个系统可能是非常糟糕的专业实践，但在一个人人都认识的小商店里，它运作良好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-01T20:21:11.943

在我以前工作的原型和研发实验室中，有“标准”实验室密码，用于诸如 root、控制台、交换机等的管理访问权限等。这些密码简单易记，并且可以与任何需要它们的人口头共享。一般来说，如果您可以实际进入实验室，您就有权拥有这些密码。

在制造工厂中，为客户构建和配置了新系统。客户必须选择所有密码，然后将密码打印在一组附在系统机架上的表格上。根据需要提供远程访问，密码通过电子邮件发送或通过电话提供。一旦系统交付给客户，客户就会立即更改这些密码。

对于 IT 和生产实验室，几乎没有人拥有 root 访问权限。几乎每个人都有 sudo 访问权限，介于没有限制和只能挂载虚拟文件系统的能力之间……取决于人和系统。获得 sudo 访问权限以以 root 身份启动 shell 是非常罕见的。这留下了您以 root 身份运行的所有命令的非常清晰的日志跟踪。多年来，该日志被用于对不止一个人进行焦油和羽毛处理。

多年前，在我担任服务台/支持角色时，每个工具专家都选择了自己的管理密码。这些记录在一个信封中，该信封被锁在机房的保险箱中。如果有人需要管理员访问权限，他们可以打开信封，阅读密码，并在日志中注明他们知道密码，然后将密码重新密封在信封中。由工具所有者决定是否需要更改密码。该系统使用了 5 年多……在一个案例中，实际上帮助该项目通过了一名团队成员的“公共汽车测试”（心脏病发作）。

针对不同类型的系统和实验室的不同标准。这是合理的。我发现当需要对密码进行分片时，最好密码简单、简短并且可以口头交流（亲自或通过电话）。我发现唯一不应该共享的密码是我个人帐户的密码。任何特定于 root/admin/tool 的密码都应该至少在另一个头中备份……如果没有以某种方式记录的话。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T05:19:21.290

您可以使用 anypasswordpro 之类的程序来共享密码。它是加密的并且具有访问级别:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T05:27:51.833

现实点。不管你喜不喜欢，小团队的人都会在便签上写下密码，给他们发即时消息，或者想给他们发电子邮件，尤其是当他们认为没有威胁时。

我发现对小组有用的一项措施是建立混淆协议。

例如，所有通过语音邮件、电子邮件、IM 或纸张传送或存储的密码将具有 1) 颠倒其字符顺序 2) 放置在每个密码字符之间的随机字符或单词 3) 语音发音的密码字符。

例如：

密码：VMaccp@ss1

混淆：一个 2 es df es 23 at sd pee fd see dfs see fxz ay df EM sd VEE

关键是要建立某种编码，这种编码对于不了解协议的人来说几乎是不可能的，这很容易记住。

请记住，这适用于没有生死攸关的小团体。显然，对于较大的团体或那些保护极其敏感的财务数据的人来说，更繁琐的措施是合适的。

# eclipse - 帮助！恢复 Eclipse 文件

> ID：712505
> 
> 赞同：14
> 
> 时间：2009-04-03T04:01:27.017
> 
> 标签：eclipse, recovery

我正在使用 eclipse，当我关闭 eclipse 时，它​​会询问我保存文件，我按是并且 eclipse 关闭。当我打开我的电脑时，我看到驱动器只剩下 3 个字节，我有一种不好的感觉。我去我的文件，哦，天哪，它完全是空白的，大小是 0 字节！:(

我需要那个文件，免费的恢复程序可以在这种情况下工作吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-03T04:21:33.927

有时 Eclipse 会保留它对您编辑的文件所做的更改。并不总是有效，但值得一试：

*   在您的（包、项目、导航器）资源管理器中找到您的文件。
*   右键单击您的文件并查找要比较的菜单...（我建议比较，尽管在您的情况下它无关紧要，因为文件现在是空的）
*   从子菜单中选择本地历史...

如果您很幸运并且一直在使用 Eclipse 编辑该文件，您应该会在其中找到一些条目。查找它们，您很可能会找到内容。

这帮助了我无数次，并多次救了我的命。然而，每次我求助于它时，我总是觉得因为没有提前对源代码控制系统进行更改而用棒球棒击打我的头。

祝你好运，如果这不起作用，我担心 SO 对你没有多大帮助:-(

--- 编辑 --- 一些可以帮助使这个技巧更有用的东西。

您可以更改 Eclipse 在本地历史记录中保存的信息量，转到您的首选项，然后选择 general->Workspace->Local History（此处为 Indigo，其他版本可能不同）。如果您倾向于头昏眼花或过度燃烧午夜油，这将帮助您在第二天修复您坚持在睡觉前完成的错误修复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T04:22:17.980

如果您知道文件中的某些短语或不常见的单词，您可以在硬盘驱动器的原始扇区中搜索文本片段。这将在可能已写入的任何位置显示文本：作为分页的虚拟内存，作为仍然存在的文件（临时文件或保存的文件），或者作为已删除且空间尚未重写的临时或保存文件.

但它会很慢。如果该文件从未写入磁盘，它将不会产生任何结果。它产生的东西可能是零散的或不完整的。

启动 Knoppix CD 并开始 grepping！Knoppix 是一个从 CD 运行的 linux 安装程序，无需写入硬盘驱动器。

*   获取 knoppix：[http](http://www.kernel.org/pub/dist/knoppix/KNOPPIX_V6.0.1CD-2009-02-08-EN.iso) ://www.kernel.org/pub/dist/knoppix/KNOPPIX_V6.0.1CD-2009-02-08-EN.iso ）

*   启动它。启动终端。搜索硬盘：

    ```
    $ sudo grep "Four score and seven years" /dev/hda 
    ```

*   如果出现任何问题，请将其复制并粘贴到文本编辑器中，然后保存到 U 盘或通过基于 Web 的电子邮件发送给自己。

如果您有 SCSI 或 SATA 磁盘，则需要使用`/dev/sda`而不是`/dev/hda`

另一个答案是正确的，操作系统继续运行的每一刻都会降低您的恢复机会。拔掉电源并使用另一台计算机准备 knoppix CD。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T04:09:02.693

首先，关闭电脑。在这一点上，它打开并被使用的每一秒都会降低您恢复文件的机会。

# asp.net - 如何使用 ASP.NET AJAX 实现 Windows Live ID 操作

> ID：712506
> 
> 赞同：4
> 
> 时间：2009-04-03T04:01:58.170
> 
> 标签：asp.net, ajax, asp.net-ajax, sdk, windows-live

好的，所以我正在使用 AJAX 和 Windows Live ID SDK 开发 ASP.NET webapp。我已成功通过 Live 对其进行身份验证，但是...

Windows Live ID 规范表明我必须查找请求标头“login”、“logout”和“clearcookie”。推荐的代码示例包括一个 Response.Redirect，当您的页面大量使用 UpdatePanel 时，它似乎不起作用：

```
loginCookie = new HttpCookie(strLoginCookie);
loginCookie.Expires = DateTime.Now.AddYears(-10);
Response.Cookies.Add(loginCookie);
Response.Redirect("default.aspx");
Response.End(); 
```

此外，clearcookie 操作要求我直接写入响应：

```
public WindowsLiveLogin wll = new WindowsLiveLogin(key1, key2);

loginCookie = new HttpCookie(strLoginCookie);
loginCookie.Expires = DateTime.Now.AddYears(-10);
Response.Cookies.Add(loginCookie);

string type;
byte[] content;
wll.GetClearCookieResponse(out type, out content);
Response.ContentType = type;
Response.OutputStream.Write(content, 0, content.Length); 
```

结果，响应无法识别它并且 Windows Live 注销功能超时，无论是通过我的注销按钮（注销操作）还是 Windows Live 站点的注销功能（清除 cookie 操作）。如何使用标记中的静态 UpdatePanel 和其他 AJAX 控件来实现这一点？

我在以前的 AJAX 项目中使用过它。我决定没有注销功能，当然可以通过清除一个人的 cookie 来绕过它。请告诉我一个更优雅的方式！

# visual-studio - Visual Studio 2008 加载项检查层次结构项是否为解决方案文件夹

> ID：712507
> 
> 赞同：3
> 
> 时间：2009-04-03T04:02:11.850
> 
> 标签：visual-studio, debugging, add-in

我有一个由不再在公司工作并且不知道如何调试它的开发人员编写的 Visual Studio 插件。但我想添加一个功能，以便它可以递归到解决方案文件夹中。

听起来很简单，但我不确定 api 是否允许对此进行测试？好吧，必须有一种方法，因为 AnkhSVN 和 VisualSVN 与解决方案文件夹一起工作得很好。

StackOverflow 我正在就这个问题寻求一些帮助。

谢谢

**笔记**

- 我们正在使用解决方案文件夹来隐藏“依赖项目”，它们基本上是一个项目引用列表，我们在特定解决方案中可能不关心这些项目引用，并且默认情况下希望隐藏这些引用。

```
public class Connect : IDTExtensibility2, IDTCommandTarget
{

public void GetProjectLocations(DTE2 dte)
{

UIHierarchy UIH = dte.ToolWindows.SolutionExplorer;

try
{
     UIHierarchyItem UIHItemd = UIH.UIHierarchyItems.Item(1);
}
catch (Exception E)
{
  Debug.Write(E);
}

UIHierarchyItem UIHItem = UIH.UIHierarchyItems.Item(1);//this looks suspect to me

// Iterate through first level nodes.
for (int i = 1; i <= UIHItem.UIHierarchyItems.Count; i++)
{
  Project TempGeneralProjObj = dte.Solution.Item(i);  

  if (TempGeneralProjObj.Kind == PrjKind.prjKindCSharpProject)
  {
  }

}

}

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-13T14:00:13.843

到目前为止，从我的测试来看，解决方案文件夹似乎会令人惊讶地转换为 Project 类型，一旦完成，Project.ProjectItems 属性将保存一个可能存在于该文件夹下的项目列表。简而言之，这是至少获取有关事物结构信息的一种方式。然而，问题是位于解决方案文件夹下的每个 ProjectItem 似乎都将 find 转换为 ProjectItem 类型，但似乎无法转换为 Project。

这就是我目前在循环中检测解决方案文件夹的方式。

```
if(project.Kind == "{66A26720-8FB5-11D2-AA7E-00C04F688DDE}")
{
    // TODO: Do your thing
} 
```

这也让我感到沮丧，我还注意到[ActiveReports 如何处理解决方案文件夹](http://www.datadynamics.com/forums/125924/ShowPost.aspx)中的一个错误，这与同一问题有关。

更新！

好的，所以我找到了解决方案，但我不能 100% 声称它，因为我在[Macaw's Blog](http://weblogs.asp.net/soever/archive/2007/02/20/enumerating-projects-in-a-visual-studio-solution.aspx)找到了大部分。

因此，看来我最初的发现是正确的，但是为了获得解决方案项下每个 ProjectItem 的实际项目类型，您需要在**ProjectItem.SubProject**属性下查看。

现在 Macaw 采用递归方法来遍历项目结构，我认为我通常也会推荐这种方法，但是在我的情况下，我想要一个方法实现来简单地注销项目的 XML 表示以进行简单的研究，所以我最终使用了 Stack执行。作为参考，您可以在下面找到我的代码，该代码成功地处理了至少一级解决方案文件夹，其中仅包含项目，没有其他专业解决方案项目。

```
 XElement rootNode = new XElement("Solution");
        rootNode.Add(new XAttribute("Name", _applicationObject.Solution.FullName));

        Stack<Project> projectStack = 
            new Stack<Project>(_applicationObject.Solution.Projects.Cast<Project>());

        while(projectStack.Count > 0)
        {
            var project = (Project)projectStack.Pop();
            var solutionItemName = "Project";

            if(project.Kind == "{66A26720-8FB5-11D2-AA7E-00C04F688DDE}")
            {
                foreach(ProjectItem innerProject in project.ProjectItems)
                {
                    if(innerProject.SubProject != null)
                    {
                        projectStack.Push(innerProject.SubProject);
                    }
                }
                solutionItemName = "Folder";
            }

            var projectNode = new XElement(
                solutionItemName, 
                new XAttribute("Name", project.Name),
                new XAttribute("Kind", project.Kind)
                );
            rootNode.Add(projectNode);

            foreach(ProjectItem item in project.ProjectItems)
            {
                var itemNode = new XElement("Item", new XAttribute("Name", item.Name));
                projectNode.Add(itemNode);

                if(item.Properties == null)
                {
                    continue;
                }

                foreach(Property property in item.Properties)
                {
                    var propertyNode = new XElement(property.Name, property.Value);
                    itemNode.Add(propertyNode);
                }
            }
        } 
```

根据这篇文章的事实以及其他插件中明显的错误，很明显这不是最直观的设计，但这是我们必须忍受的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T05:51:44.707

若要调试 Visual Studio 加载项，请将源代码加载到未运行加载项的 Visual Studio 副本中。然后，将项目配置为在“运行”项目时启动 Visual Studio 的第二个副本，然后第二个副本将运行，第一个能够断点并对其进行调试。

确保你有一个批处理文件（或等效文件）要清理，这样你就可以在没有插件的情况下随时恢复运行 VS。

有用的资源...

*   [如何调试 Visual Studio .NET 2005 加载项](http://bloggingabout.net/blogs/mglaser/archive/2006/11/06/How-to-debug-a-Visual-Studio-.NET-2005-Add_2D00_In.aspx)
*   [演练：调试加载项项目](http://msdn.microsoft.com/en-us/library/f7fb383x.aspx)

# python - 使用 CSV 作为可变数据库？

> ID：712510
> 
> 赞同：4
> 
> 时间：2009-04-03T04:02:50.740
> 
> 标签：python, csv

是的，这听起来很愚蠢。由于一些非常烦人的托管限制和反应迟钝的技术支持，我不得不使用 CSV 文件作为数据库。

虽然我可以将 MySQL 与 PHP 一起使用，但由于主机的安装问题，我无法将它与我的程序的 Python 后端一起使用。由于更多的安装问题，我不能将 SQLite 与 PHP 一起使用，但可以使用它，因为它是 Python 内置的。

无论如何，现在的问题是：是否可以在 CSV 数据库中更新 SQL 样式的值？还是我应该继续打电话给服务台？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-03T04:11:14.620

**不要走路，马上跑去找新的宿主**。如果您的主机甚至无法为您提供最基本的免费数据库，那么是时候做出改变了。海里有很多鱼。

至少我会推荐 xml 数据存储而不是 csv。 [我的博客](http://chrisballance.com)使用了一个 xml 数据提供者，我根本没有遇到任何性能问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T04:37:43.310

看看这个： http: [//www.netpromi.com/kirbybase_python.html](http://www.netpromi.com/kirbybase_python.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T04:07:01.247

继续致电服务台。

虽然您可以将 CSV 用作数据库，但这通常不是一个好主意。您必须实现自己的锁定、搜索、更新，并且在写出它时要非常小心，以确保在断电或其他异常关机的情况下它不会被擦除。除非您自己编写，否则不会有交易，没有查询语言等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T04:12:56.193

我无法想象这是一个好主意。我继承的当前混乱将重要的计费信息写入 CSV，并在项目完成后对其进行更新。它运行得非常糟糕，每月错过数千美元。对于您当前的限制，我会考虑寻找更好的托管。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T04:40:30.153

您可能可以将 sqlite3 用于更真实的数据库。很难想象托管不允许您将其安装为 python 模块。

千万别想用 CSV，你的数据会比你说的“s#&t”更快被破坏和丢失

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-03T10:26:04.253

**“无论如何，现在的问题是：是否可以在 CSV 数据库中更新 SQL 样式的值？”**

从技术上讲，这是可能的。但是，这可能很难。

如果 PHP 和 Python 都在编写文件，则需要使用操作系统级别的锁定来确保它们不会相互覆盖。系统的每个部分都必须锁定文件，**使用所有更新从头开始重写**，然后解锁文件。

这意味着 PHP 和 Python 必须在重写之前将整个文件加载到内存中。

有几种方法可以处理操作系统锁定。

1.  使用相同的文件并实际使用一些操作系统锁模块。两个进程都始终打开文件。

2.  写入临时文件并重命名。这意味着每个程序都必须为每个事务打开并读取文件。非常安全可靠。有点慢。

或者。

您可以重新架构它，以便只有 Python 写入文件。前端在文件更改时读取文件，并丢弃小的事务文件以创建 Python 工作队列。在这种情况下，你没有多个作者——你只有一个读者和一个作者——而且生活要简单得多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T04:06:31.043

我会一直打电话给服务台。如果数据完全是关系的，您**就**不想将 CSV 用于数据。这将是一场噩梦。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T04:39:41.013

我同意。告诉他们 5 个随机的陌生人同意你被迫使用 CSV 是荒谬和不可接受的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-03T08:05:53.620

如果我理解正确：您需要从 python 和 php 访问同一个数据库，而您被搞砸了，因为您只能从 php 使用 mysql，而只能从 python 使用 sqlite？

你能进一步解释一下吗？也许您可以使用 xml-rpc 或带有 xml/json/... 的普通 http 请求来让 php 程序与 python 程序进行通信（或相反？），这样只有其中一个直接访问数据库。

如果不是这种情况，我不确定是什么问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-03T10:39:52.720

这在技术上是可行的。例如，Perl 有[DBD::CSV](http://search.cpan.org/~jzucker/DBD-CSV/lib/DBD/CSV.pm)，它提供了对 CSV 文件运行 SQL 查询的驱动程序。

*话虽*如此，为什么不在您的服务器上运行 SQLite 数据库呢？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-03T11:15:46.253

那postgresql呢？我发现它很好用，python 很好地支持它。

但我真的会寻找另一个供应商，除非它真的不是一个选择。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-09-08T22:05:28.427

不同意高贵的同事，我经常使用 Perl 的 DBD::CSV。有充分的理由这样做。最重要的是使用电子表格使数据更新变得简单。作为奖励，由于我使用的是 SQL 查询，因此可以轻松地将应用程序升级为真正的数据库引擎。请记住，这些是单用户应用程序中的极小数据库。

所以重新表述这个问题：是否有一个相当于 Perl 的 DBD:CSV 的 python 模块

# jquery - 使用jquery在项目列表中选择项目

> ID：712519
> 
> 赞同：0
> 
> 时间：2009-04-03T04:10:27.463
> 
> 标签：jquery

我有一个具有相同类名的 div 列表。我想知道如何使用 jquery 准确捕捉哪个 div 客户端点击它。我尝试了很多次，但我无法弄清楚。请帮助我，因为我是 jquery 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T04:14:15.830

```
$('.myClass').click(function(){
  $(this); //This is the clicked div
}); 
```

**编辑：**回应您的[新问题](https://stackoverflow.com/questions/712519/select-item-in-the-list-of-item-using-jquery/712541#712541)

您可以通过以下方式选择所有单选按钮：

```
$('input:radio:checked').each(function(){
   $(this); // Checked radio button element(s)...
}); 
```

在那里，您可以使用 访问元素值`$(this).val()`，也可以使用 访问 name 属性`$(this).attr('name')`。

推荐讲座：

*   [API/选择器](http://docs.jquery.com/Selectors)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T04:15:06.423

在您的点击回调中使用“this”：

`$("div.nameofclass").click(function(){$(this).css('border', '1px solid red')});`

# asp.net - 从当前日期时间查找 1 年前

> ID：712527
> 
> 赞同：-1
> 
> 时间：2009-04-03T04:17:21.003
> 
> 标签：asp.net, sql, datetime

我想执行此日期检查：

用户输入的日期**不得少于**当前日期的 12 个月前，例如

`if date_value > '03-apr-2009'`

如何编写 .NET 代码来执行此操作？

编辑：

我输入的日期值是字符串格式

[正如我所做的那样 *（（System.DateTime）date_value）.ToString（“dd-MMM-yyyy”）* ]

所以现在我想与这个字符串（date_value）和DateTime.Now.AddYears（-1）进行比较

那么两个字符串可以这样比较吗？？？（如果一个日期值大于另一个）

或者我应该为比较做任何铸造吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T04:25:52.607

你的意思是像下面的代码吗？

```
if(date_value > DateTime.Now.AddYears(-1))
{
    //enter code here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T04:23:39.677

DateTime.Now.AddYears(-1)

# java - Java中的向上转换是否隐藏了子类方法和字段？

> ID：712528
> 
> 赞同：8
> 
> 时间：2009-04-03T04:17:54.077
> 
> 标签：java, upcasting

在我正在编写的程序中，我有一个类`RestrictedUser`和一个`User`派生`RestrictedUser.`自我试图通过强制转换来隐藏用户特定方法的类，`RestrictedUser`但是当我进行强制转换时，用户方法仍然可用。此外，当我运行调试器时，变量的类型显示为`User`.

```
RestrictedUser restricted = regularUser; 
```

在 Java 中进行强制转换是否隐藏了子类方法和字段，还是我做错了什么？有解决方法吗？

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-03T04:23:59.753

如果您要尝试运行此代码：

```
User user = new User(...);
RestrictedUser restricted = user;
restricted.methodDefinedInTheUserClass(); // <-- 
```

你会得到一个编译错误。这在任何方式、形状或形式上都不会是安全的，因为即使您要传递`RestrictedUser`到另一个方法，例如，该方法也可以这样做：

```
if (restricted instanceof User) {
    User realUser = (User)restricted;
    realUser.methodDefinedInTheUserClass(); // !!
} 
```

并且您的“受限制”用户不再受限制。

对象在调试器中显示为`User`对象，因为它是`User`对象，即使对象引用存储在`RestrictedUser`变量中。基本上，将子类的实例放在具有父类类型的变量中确实会“隐藏”子类的方法和字段，但不安全。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T04:23:32.597

我不确定你到底在问什么，因为你使用的术语有点不清楚，但这里有。如果您有一个超类和一个子类，您可以通过将超类中的方法设置为私有来对子类隐藏超类中的方法。如果您需要超类上的公共方法不可见，那么您就不走运了。如果将子类转换为超类，则子类上的公共方法将不再可见。

一个可能对您有所帮助的建议是使用组合而不是继承，将敏感方法提取到单独的类中，然后根据需要将该类的适当实例插入到对象中。如果需要，您可以将类中的方法委托给注入的类。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T04:24:14.153

您混淆了静态类型和动态类型。

静态类型是引用的类型。当您从 Derived 向上转换为 Base 时，您是在告诉编译器，据您所知，指向的东西是 Base。也就是说，您承诺指向的对象要么是 null，要么是 Base，或者是从 Base 派生的东西。也就是说，它有Base的公共接口。

然后您将无法调用在 Derived（而不是在 Base）中声明的方法，但是当您调用任何被 Derived 覆盖的 Base 方法时，您将获得 Derived 的覆盖版本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-03T08:58:14.633

如果需要保护子类，可以使用委托模式：

```
public class Protect extends Superclass {  // better implement an interface here
  private final Subclass subclass;

  public Protect(Subclass subclass) {
    this.subclass = subclass;
  }

  public void openMethod1(args) {
    this.subclass.openMethod1(args);
  }

  public int openMethod2(args) {
    return this.subclass.openMethod2(args);
  }
  ...
} 
```

也可以考虑使用[java.lang.reflect.Proxy](http://java.sun.com/javase/6/docs/api/java/lang/reflect/Proxy.html)
[]]

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-03T04:52:11.810

[彼得的回答](https://stackoverflow.com/questions/712528/does-up-casting-in-java-hide-the-subclass-methods-and-fields/712537#712537)和[约翰的回答](https://stackoverflow.com/questions/712528/does-up-casting-in-java-hide-the-subclass-methods-and-fields/712537#712537)是正确的：如果对象的真实类型（客户端代码可以转换为，调用反射方法等）仍然可用，则仅转换静态类型将无济于事。您必须以某种方式掩盖真实类型（正如彼得的回答所提到的）。

实际上有一个这样做的模式：如果您可以访问 JDK 源代码，请查看类中的`unconfigurable*`方法。[`Executors`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/Executors.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-03T12:24:37.400

**爪哇**

在 Java 中，您永远无法从对象中“隐藏”某些内容。编译器可能会忘记您对特定实例的详细了解。（比如它是什么子类）调试器比编译器知道的多得多，所以它会告诉你当前实例是什么实际类型，这可能是你正在经历的。

**面向对象**

听起来您正在编写需要知道您正在使用的对象类型的逻辑，这在 OOP 中不推荐，但出于实际原因通常需要。

**限制形容词**

正如我在对该问题的评论中所说，您应该清楚这里的基类是什么。直觉上 RestrictedUser 应该是 User 的子类，因为名称暗示了一种更专业的类型。（名称上有一个额外的活动形容词。）在你的情况下，这很特别，因为这是一个限制形容词，它可以让你把 User 作为 RestrictedUser 的子类完全没问题。我建议将两者重命名为：BasicUser/UserWithId 和 NonRestrictedUser 以避免限制形容词，这是令人困惑的部分。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-03T05:00:12.787

另外，也不要认为可以在匿名类中隐藏方法。例如，这不会提供您期望的隐私：

```
Runnable run = new Runnable() {
    @Override
    public void run() {
        System.out.println("Hello, world!");
    }

    public void secretSquirrel() {
        System.out.println("Surprise!");
    }
} 
```

您可能无法命名的真实类型`run`（以便直接转换为），但您仍然可以使用 获取其类`getClass()`，并且可以`secretSquirrel`使用反射调用。（即使`secretSquirrel`是私有的，如果你没有`SecurityManager`，或者如果它被设置为允许可访问性，反射也可以调用私有方法。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T12:56:26.653

我认为您可能做出了一个糟糕的命名选择：我认为`RestrictedUser`将是 的子类`User`，而不是相反，所以我将`UnrestrictedUser`用作子类。

如果将 an 向上`UnrestrictedUser`转换为 a `RestrictedUser`，则您的引用将只能访问在 中声明的方法`RestrictedUser`。但是，如果您将其向下转换为`UnrestrictedUser`，您将可以访问所有方法。`UnrestrictedUser`由于 Java 对象知道它们真正是什么类型，因此无论您使用什么类型的引用（甚至是） ，任何实际上是 an 的东西都可以始终转换回它`Object`。有不可避免的和语言的一部分。但是，您可以将其隐藏在某种代理后面，但在您的情况下，这可能会违背目的。

此外，在 Java 中，所有非静态方法默认都是虚拟的。这意味着如果`UnrestrictedUser`覆盖在 中声明的某些方法`RestrictedUser`，则将使用该`UnrestrictedUser`版本，即使您通过`RestrictedUser`引用访问它也是如此。如果需要调用父类版本，可以通过调用来进行非虚调用`RestrictedUser.variableName.someMethod()`。但是，您可能不应该经常使用它（最不重要的原因是它破坏了封装）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-03T13:20:12.290

我也认为这个问题引出了另一个问题。你打算如何调用这个方法？似乎有一个类层次结构，其中子类化引入新的方法签名将需要在调用者中进行 instanceof 检查。

您能否更新您的问题以包含一个您会调用这些方法的场景？也许我们能提供更多帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-03T16:56:52.487

John Calsbeek 给出了技术答案。我想考虑设计问题。您要做的是阻止某些代码段或某些开发人员了解有关 User 类的任何信息。您希望他们将所有用户视为 RestrictedUser。

您这样做的方式是使用权限。您需要防止有问题的开发人员访问 User 类。您可以通过将其放入包中并限制对包的访问来做到这一点。

# c# - 我在哪里可以免费找到一个不错的 .NET 选项卡控件？

> ID：712530
> 
> 赞同：11
> 
> 时间：2009-04-03T04:20:36.160
> 
> 标签：c#, .net, winforms, tabcontrol, krypton

我正在使用免费的 Krypton Toolkit 在 C# 中执行此应用程序，但 Krypton Navigator 是一种付费产品，对我来说相当昂贵，并且此应用程序是在我的空闲时间开发的，它将免费提供给公众。

**所以，我正在寻找一种免费的控件，以便更好地集成到我的 Krypton 应用程序中，因为默认的控件不太适合，并且它会根据操作系统版本而有所不同......**

有什么建议么？

PS：我知道我可以拥有它，但我试图不做那种工作......如果它免费存在，我更喜欢已经完成的东西。

**编辑：** 我刚刚找到了我想要的东西：
[http ://www.angelonline.net/CodeSamples/Lib_3.5.0.zip](http://www.angelonline.net/CodeSamples/Lib_3.5.0.zip)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T12:13:33.870

我的第一个建议是与 ComponentFactory 的 Phil 交谈。我觉得他是一个非常通情达理的人。也许他可以给你一个特别的优惠，或者就如何自定义现有的选项卡控件提出设计建议。

但是您的问题更多的是一个设计/主观问题，我认为，这将受益于屏幕截图，以更好地传达您“更好地集成”所需的设计挑战。说“默认的不太合适”是很含糊的。

之后，人们将有一个更好的提出建议的起点。同时，我会查看[WindowsClient.NET 控制库](http://windowsclient.net/downloads/folders/controlgallery/default.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-08-28T05:06:40.227

如果您需要带有 Office 2010 调色板的更新库：[http ://www.angelonline.net/CodeSamples/Lib_4.2.0.zip](http://www.angelonline.net/CodeSamples/Lib_4.2.0.zip)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T05:27:37.573

我不知道任何开源或免费的选项卡控件，但我想知道您为什么不只使用框架的选项卡控件。您是否正在尝试做一些 Forms.TabControl 没有做的事情？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-10T04:54:10.167

1.  从 Code Project下载[平面选项卡控件](http://www.codeproject.com/KB/tabs/flattabcontrol.aspx)(.NET)。完成这项工作大约需要 30 秒，它让您远离默认的 Windows 选项卡控件外观。但它不是氪星化的。
2.  请参阅这篇关于基于您在步骤 1 中构建的平面选项卡控件的[自定义 Kryptonized 选项卡控件的帖子](http://www.advancedcomputing.ch/?TabId=73&EntryID=7)。您可以在[此下载页面上下载](http://www.advancedcomputing.ch/Downloads/tabid/62/Default.aspx)[控件程序集](http://www.advancedcomputing.ch/LinkClick.aspx?link=http%3a%2f%2fwww.angelonline.net%2fCodeSamples%2fTabControlNew%2fAC.ExtendedRenderer.Navigator.zip&tabid=62&mid=466)（有点难找）。据我所知，源代码不可用，但是，如果您对 Krypton-theming 是如何完成的感到好奇，Reflector 可以在这里使用。
3.  将 Flat Tab 显示逻辑（Paint 等）替换为 Krypton 感知显示逻辑。这很简单，因为Flat Tab 控件的代码并不*多。*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-30T13:14:42.890

如果有人正在寻找`AC.ExtendedRenderer.ToolKit`其他帖子中提到的最新版本，那么以下链接指向它们的中心来源。但是该网站已经死了....即使 WaybackMachine 也无法帮助我们获取 DLL :(！

*   [http://web.archive.org/web/20130725145918/http://www.advancedcomputing.ch/Downloads/tabid/62/Default.aspx](http://web.archive.org/web/20130725145918/http://www.advancedcomputing.ch/Downloads/tabid/62/Default.aspx)

我能在这里找到的最新版本是 4.1.6b：

*   [http://web.ticino.com/angelo/CodeSamples/Lib_4.1.6b.zip](http://web.ticino.com/angelo/CodeSamples/Lib_4.1.6b.zip)

如果有人知道在哪里可以下载更高版本，请告诉我们。

编辑：组件工厂氪组件已迁移到[https://github.com/ComponentFactory/Krypton](https://github.com/ComponentFactory/Krypton)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T12:40:01.730

您可以在 CodeProject 上查看[Magic TabControl 项目。](http://www.codeproject.com/KB/tabs/magictabcontrol.aspx)

# c# - 如何根据用户选择在 ASPX 中显示 XML 数据？

> ID：712551
> 
> 赞同：-3
> 
> 时间：2009-04-03T04:28:20.757
> 
> 标签：c#, asp.net, xml, ascx

我有下面给出的 XML。在这个 XML 中，在一个带有将包含数据的 ASCX 控件的 ASPX 页面中，我想要一个带有选项“GMAT”、“GRE”、“LSAT”和“MCAT”的下拉菜单。当我在下面选择 GMAT 时，它只会显示 GMAT 小册子，与其他小册子相同。

您能否为此提供一些代码？

```
<?xml version="1.0" encoding="utf-8"?>
<root>
    <data>
        <ImageId>tcm556662</ImageId>
        <ImageURL>/Images/2008_gmat_brochure_uk_thumb_tcm55-7311.gif</ImageURL>
        <ImageTitle>GMAT Brochure</ImageTitle>
        <Description>&lt;p xmlns="http://www.w3.org/1999/xhtml"&gt;Classroom
                     and Online Coursegrams.&lt;/p&gt;</Description>
        <FilePath>/Images/gmat_brochure_uk_tcm55-8064.pdf</FilePath>
    </data>
    <data>
        <ImageId>tcm5510981</ImageId>
        <ImageURL>/Images/practice-test-image_tcm55-10980.JPG</ImageURL>
        <ImageTitle>GMAT Problem Solving Questions and Answers</ImageTitle>
        <Description>Download Kaplan's GMAT Problem So to each question.</Description>
        <FilePath>/Images/gmat-sample-questions_tcm55-10979.pdf</FilePath>
    </data>
    <data>
        <ImageId>tcm5511066</ImageId>
        <ImageURL>/Images/practice-test-image_tcm55-10980.JPG</ImageURL>
        <ImageTitle>GMAT Sentence Correction Practice Questions</ImageTitle>
        <Description>&lt;p xmlns="http://www.w3.org/1999/xhtml"&gt;Tick the box to
                     download GMsee how you might do on this section of the GMAT
                     exam.&lt;/p&gt;</Description>
        <FilePath>/Images/gmat-sentence-correction_tcm55-11065.pdf</FilePath>
    </data>
    <data>
        <ImageId>tcm556663</ImageId>
        <ImageURL>/Images/gre_brochure_thumb_tcm55-7315.gif</ImageURL>
        <ImageTitle>GRE Brochure</ImageTitle>
        <Description>&lt;p xmlns="http://www.w3.org/1999/xhtml"&gt;Courses and
                     Tutoring for the Grprograms&lt;/p&gt;</Description>
        <FilePath>/Images/gre-brochure_tcm55-8065.pdf</FilePath>
    </data>
    <data>
        <ImageId>tcm5511219</ImageId>
        <ImageURL>/Images/practice-test-image_tcm55-10980.JPG</ImageURL>
        <ImageTitle>GRE Quantitative Questions Answers and Explanations</ImageTitle>
        <Description>Download the answers and exp with the correct answer. Tick
                    the box and click download now to start the process.</Description>
        <FilePath>/Images/gre-quantitative-practice-questions_tcm55-11214.pdf</FilePath>
    </data>
    <data>
        <ImageId>tcm5511220</ImageId>
        <ImageURL>/Images/practice-test-image_tcm55-10980.JPG</ImageURL>
        <ImageTitle>GRE Sentence Completion Practice Question Answers and Explanations</ImageTitle>
        <Description>&lt;p xmlns="http://www.w3.org/1999/xhtml"&gt;Complete the
                    sentence on the download now button to see how you did.&lt;/p&gt;</Description>
        <FilePath>/Images/gre-sentence-completions_tcm55-11213.pdf</FilePath>
    </data>
    <data>
        <ImageId>tcm558073</ImageId>
        <ImageURL>/Images/lsat_brochure_thumb_tcm55-7316.gif</ImageURL>
        <ImageTitle>LSAT Brochure</ImageTitle>
        <Description>Courses and Tutoring for the Law School Admission US law schools</Description>
        <FilePath>/Images/lsat-brochure_tcm55-8066.pdf</FilePath>
    </data>
    <data>
        <ImageId>tcm5511275</ImageId>
        <ImageURL>/Images/practice-test-image_tcm55-10980.JPG</ImageURL>
        <ImageTitle>LSAT Comparative Reading Practice Questions Answers and Explanations</ImageTitle>
        <Description>Try answering the LSAT Comparative Reading and click on
                     download now.</Description>
        <FilePath>/Images/comparative-reasoning_tcm55-11269.pdf</FilePath>
    </data>
    <data>
        <ImageId>tcm5511281</ImageId>
        <ImageURL>/Images/practice-test-image_tcm55-10980.JPG</ImageURL>
        <ImageTitle>LSAT Reading Comprehension Practice Questions Answers and Explanations</ImageTitle>
        <Description>&lt;p xmlns="http://www.w3.org/1999/xhtml"&gt;Read the passage
                     and try the questions as now Lion Practice Questions Answers
                     and Explanations.&lt;/p&gt;</Description>
        <FilePath>/Images/lsat-reading-comprehension_tcm55-11280.pdf</FilePath>
    </data>
    <data>
        <ImageId>tcm558074</ImageId>
        <ImageURL>/Images/mcat_brochure_thumb_tcm55-7317.gif</ImageURL>
        <ImageTitle>MCAT Brochure</ImageTitle>
        <Description>Courses and Tutoring for the Medical College Admission Test
                     (MCAT)</Description>
        <FilePath>/Images/mcat-brochure_tcm55-8067.pdf</FilePath>
    </data>
    <data>
        <ImageId>tcm5511278</ImageId>
        <ImageURL>/Images/practice-test-image_tcm55-10980.JPG</ImageURL>
        <ImageTitle>MCAT Biological Sciences Practice Questions Answers and Explanations</ImageTitle>
        <Description>Have you wri download now to find out how you've done.</Description>
        <FilePath>/Images/mcat-biological-sciences_tcm55-11271.pdf</FilePath>
    </data>
</root> 
```

下面是读取 XML 文件的函数：

```
private DataSet GenerateDatasetFromXml()
    {
        string xmlFile = string.Empty;
        DataSet xmlFileData = new DataSet();
        string selItem = string.Empty;
        xmlFile = @Server.MapPath("~/" + ConfigurationManager.AppSettings["BrochureXml"].ToString());
        string sfinalString = "";
        hdnIds.Value = "";
        try
        {
            if (File.Exists(xmlFile))
            {
                xmlFileData.ReadXml(xmlFile);
            }
        }
        catch (Exception ex)
        {
            throw ex;
        } 
        return xmlFileData; 
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T04:53:41.010

如果您有可用的 LINQ，您可以执行以下操作...我不确定 ImageTitle 元素是否是您的匹配元素，但是...

```
XDocument xml = XDocument.Load("MyXMLFile.xml");

string selectedItem = "GMAT"; //Wherever you get this string from

var matchedItems = xml.Root.Descendants("data")
                           .Where(ele => ele.Element("ImageTitle").Value.StartsWith(selectedItem)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T05:33:45.390

> 我想要一个带有选项“GMAT”、“GRE”、“LSAT”、“MCAT”的下拉列表

现在，您只能根据字符串解析 ImageTitle 并在其中找到子字符串来选择这些项目 - 不是最优的......

如果有任何机会，我建议在您的数据中添加一个标签（或任何您想调用的标签），如下所示：

```
<data>
  <ImageId>tcm556662</ImageId>
  <ImageURL>/Images/2008_gmat_brochure_uk_thumb_tcm55-7311.gif</ImageURL>
  <ImageTitle>GMAT Brochure</ImageTitle>
  <Type>GMAT</Type>
  <Description>&lt;p xmlns="http://www.w3.org/1999/xhtml"&gt;Classroom and Online Coursegrams.&lt;/p&gt;</Description>
  <FilePath>/Images/gmat_brochure_uk_tcm55-8064.pdf</FilePath>
</data> 
```

这样，选择合适的元素就像一个非常简单的 XPath 表达式一样简单：

```
XmlNodeList _list = myXmlDocument.SelectNodes("//data[Type = 'GMAT']); 
```

一旦您将数据文件加载到 XmlDocument 中（或者如果您愿意，您可以使用 Linq-to-XML 方式）。

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T04:35:28.900

查看您拥有的 XML 结构，无需以最简单的方式进行格式化即可开箱即用。

如果你有能力改变结构，我会添加一个“”或类似的节点，甚至可能是元素上的一个属性。在那里，您可以对每个项目进行分组，提供您想要的价值。

然后使用 XML 操作方法，您可以轻松地使用 XPath 从列表中选择项目，或创建可用项目的列表。

# database - 如何在 Zend 框架中通过查询获取字段名称

> ID：712554
> 
> 赞同：0
> 
> 时间：2009-04-03T04:32:13.603
> 
> 标签：database, zend-framework

如何在 Zend Framework 测试“Select * From Test1,Test2”中使用查询获取字段名称 如何在此查询 Zend Frame work cam 中获取所有字段名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T09:03:34.513

未经测试，但我相信查询作为关联数组返回（其中列名是键），因此您可以遍历第一条记录并获取列名，例如

```
$sql = 'Select * From Test1,Test2';

$result = $db->fetchAll($sql, 2);

foreach ($result[0] as $key => $value) {
 echo $key;
 ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T13:19:51.777

您还可以在查询之前或之后发出`$db->describeTable('Test1')`等，这将为您提供所需的所有元信息。不过，此查询非常昂贵，因此请确保缓存响应。

此外，如果您使用的是 extends 模型`Zend_Db_Table_Abstract`，那么您应该已经拥有所有这些信息。在这种情况下，您需要做的就是访问受保护的属性`$_metadata`。

高温高压

# sql - 将database2中的值放入我当前的数据库

> ID：712555
> 
> 赞同：0
> 
> 时间：2009-04-03T04:32:33.010
> 
> 标签：sql, sql-server, database, sql-server-2005

我有一个名为 database1 的数据库，它包含一个按员工姓名命名的表 在员工表中有许多字段，如员工、姓名、薪水等。

我错误地将所有员工的工资值更改为 0。

我正在按名称 database2 从备份中恢复数据库

现在我需要帮助来更新我当前的数据库，即 database1

我想将表employee 中的Salary 列的值从database2 放到我当前的数据库中，即database1 在同一个员工表salary 列中。

在两个员工表中都很常见，它包含常见的员工列。

sql 2005服务器使用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T04:37:16.900

```
UPDATE database1.employees
SET salary = e2.salary
FROM database1.employees AS e1
INNER JOIN database2.employees AS e2
    ON e2.employeecode = e1.employeecode 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T04:36:59.350

您将需要进行跨数据库查询，下面是一个示例。

**假设**

1.  这是使用有权访问 Database2 的帐户在 Database1 上运行的
2.  dbo 模式中 Database2 上的表
3.  您拥有所有内容的完整备份
4.  EmployeeId 字段是表上的主键

**查询** 此查询可在 MS SQL Server 上运行，并且已经过测试，但请务必备份以防万一！！

```
UPDATE Employee 
SET Salary = b.Salary
FROM Employee A
    INNER JOIN database2.dbo.Employee B
        ON (A.EmployeeId = B.EmployeeId) 
```

# batch-file - 如何使输出文件名等于文件夹名

> ID：712556
> 
> 赞同：3
> 
> 时间：2009-04-03T04:32:37.130
> 
> 标签：batch-file, dos, command-prompt

我创建了一个批处理文件以将文件夹内容输出到名称列表中。

```
@echo off
cd /d %1
Title %~f1
dir %1 /b /l > %1\..\file_list.txt 
```

如何使 file_list.txt 成为“目录名称”.txt？

例如，我在文件夹 ABC 中，我想输出目录列表，以便最终文本文件被命名为 ABC.txt 而不是 file_list.txt

编辑：感谢 Alconja，它完美地工作。由于这是一个信息和学习网站，您介意扩展您的答案以解释您添加的参数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T05:16:04.450

根据[此处](http://www.msfn.org/board/index.php?showtopic=56320)的讨论，我认为这就是您所追求的：

```
@echo off&setlocal enableextensions
Title %~f1
for %%* in (%1) do set MyDir=%%~n*
dir %1 /b /l > %1\..\"%MyDir%.txt"
endlocal&goto :eof 
```

给它一个快速测试&似乎做你想做的事

...按原样提供/无保证/等 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T04:56:07.807

我认为没有一种简单的方法可以仅通过批处理脚本从当前路径中获取最后一部分。

但是，如果你在你的机器上安装了[sed](http://gnuwin32.sourceforge.net/packages/sed.htm)，它就变得相对容易了：

```
@echo off
cd /d %1
Title %~f1
for /F "usebackq delims=" %%i in (`"pwd | sed -e ""{s/.*\\//g}"""`) do dir %1 /b /l > %1\..\%%i.txt 
```

* * *

更正：[Alconja 的答案](https://stackoverflow.com/questions/712556/how-to-make-output-filename-equals-to-folder-name/712628#712628)是正确的。显然，通过批处理脚本的扩展，这是可能的。（我现在也理解 ~f 了）。因此，您不再需要 sed，这可以简化为：

```
@echo off
cd /d %1
Title %~f1
for /F "usebackq delims=" %%i in (`pwd`) do dir %1 /b /l > %1\..\%%~ni.txt 
```

可以说，由于您更改目录，因此您不需要输出路径中的 %1 或 dir 命令，并且您应该能够将 %1 替换为路径，因此您可以尝试（未经测试）：

```
@echo off
cd /d %1
Title %~f1
dir /b /l > ..\%~n1.txt 
```

# php - 使用 Javascript 更新数据库

> ID：712566
> 
> 赞同：2
> 
> 时间：2009-04-03T04:38:33.153
> 
> 标签：php, javascript, jquery, ajax

希望这将是我需要问的最后一个问题..lol.. 我不能离工作解决方案太远（希望..lol）。关于这个问题：

[使用 javascript Onclick 将数据传递到数据库](https://stackoverflow.com/questions/712355/pass-data-to-database-using-javascript-onclick)

我正在尝试使用 javascript 将值传递给数据库。下面是我正在使用的代码。只是为了视觉帮助，我已经附上了这个输出的截图。希望它也有助于解释我试图实现的目标。我遇到的问题是javascript“投票”链接几乎什么也没做......大声笑......你点击它，没有任何反应。最好我希望链接文本简单地更改为“您投票！” 单击链接并发送/接收数据后，只要我可以使其正常工作并更新数据库，就可以发出警报。

谢谢大家：）

```
 <?php if(isset($_POST['score'])) {

mysql_query("INSERT INTO score (score_count) VALUES ($_POST[score])");
    }               $user_id = uid();
                $m = mysql_query("SELECT * FROM friends WHERE friend_user_id1 = '$user_id' AND friend_status != '0' LIMIT 15");
                while ($t = mysql_fetch_array($m))
                {
                        $fid = $t[friend_user_id2];
                        $f = mysql_query("SELECT * FROM users WHERE user_status != '' AND user_status_date != '0' AND user_id = '$fid' ORDER BY user_status_date ASC LIMIT 15") or die(mysql_error());

                        while ($rows = mysql_fetch_array($f))
                        {
    $date = parse_date($rows[user_status_date]);
                                echo "<div style='margin: 5px;'><table><tr><td valign='top' style='width:55px;'><a href='page.php?id=$rows[user_username]'>";
                                _photo($rows[user_id]);
                                echo '</a></td><td valign="top"> <a href="page.php?id='.$rows[user_username].'" class="blue"><b>'.$rows[user_username].'</b></a> - <span style="font-size:7pt;">'.$date.'</span><span style="font-size:7pt;"> - <a href="javascript:(void);" onclick="updateScore(this, correct)" class="blue">Vote</a></span>
    <br />'.$rows[user_status].'</td><td valign="top"></td></tr></table></div>';
                        }
                }
     ?>

    <script type="text/javascript">
    function updateScore(answer, correct) {
      if (answer == correct) {
    $.get('index.php', {'score': '1'}, function(d) {
        alert('Vote Accepted: ' + d);
    });

      }
    }

    </script> 
```

输出：

[替代文字 http://www.freeimagehosting.net/uploads/a7185475b8.png](http://www.freeimagehosting.net/uploads/a7185475b8.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-03T05:36:49.797

哇，我从哪里开始。好的，我修复了你的代码。这是更改列表

1.  为易读而格式化的代码（你需要一些严肃的纪律）
2.  在查询中使用它们之前对输入进行清理（防止 SQL 注入）
3.  为关联数组键查找添加了字符串分隔符（防止 E_NOTICE 错误）
4.  在打印为 HTML 之前转义潜在的危险值（防止 XSS）
5.  删除了笨拙`echo`的语句并改为用于大输出字符串的 HTML 模式
6.  更新了要使用的 javascript，`$.post()`而不是`$.get()`因为您从`$_POST`脚本顶部的数组中读取。

这是代码：

```
<?php

if ( isset( $_POST['score'] ) )
{
    $result = mysql_query( "INSERT INTO score (score_count) VALUES (" . mysq_real_escape_string( $_POST['score'] ) . " )" );
    echo $result ? 'Vote Succeeded' : 'Vote Failed: ' . mysql_error();
    exit;
}

$user_id = mysql_real_escape_string( uid() );
$m = mysql_query( "SELECT * FROM friends WHERE friend_user_id1 = '$user_id' AND friend_status != '0' LIMIT 15" );

while ( $t = mysql_fetch_array( $m ) )
{
    $fid = mysql_real_escape_string( $t['friend_user_id2'] );
    $f = mysql_query( "SELECT * FROM users WHERE user_status != '' AND user_status_date != '0' AND user_id = '$fid' ORDER BY user_status_date ASC LIMIT 15" ) or die ( mysql_error() );

    while ( $rows = mysql_fetch_array( $f ) )
    {
        $date = parse_date( $rows['user_status_date'] );
        ?>
        <div style="margin: 5px;">
            <table>
                <tr>
                    <td valign="top" style="width:55px;">
                        <a href="page.php?id=<?php echo escapeForHtml( $rows['user_username'] ); ?>">
                            <?php _photo( $rows['user_id'] ); ?>
                        </a>
                    </td>
                    <td valign="top">
                        <a href="page.php?id=<?php echo escapeForHtml( $rows['user_username'] ); ?>" class="blue">
                            <b><?php echo escapeForHtml( $rows['user_username'] )?></b>
                        </a> - <span style="font-size:7pt;"><?php echo escapeForHtml( $date )?></span>
                        <span style="font-size:7pt;"> - <a href="javascript:;" onclick="updateScore(this)" class="blue">Vote</a></span>
                        <br /><?php echo escapeForHtml( $rows['user_status'] ); ?></td><td valign="top">
                    </td>
                </tr>
            </table>
        </div>
        <?php 
    }
}

function escapeForHtml( $value )
{
    return htmlspecialchars( $value, ENT_COMPAT, 'UTF-8' );
}

?>

<script type="text/javascript">

function updateScore(answer, correct)
{
    if (answer == correct)
    {
        $.post('index.php', {'score': '1'}, function(d)
        {
            alert('Vote Accepted: ' + d);
        });
    }
}

</script> 
```

在我完成所有这些之后，我可以清楚地看到你的 POST 实际发生的成功条件对我来说是未知的。你比较`answer`，`correct`但这个代码片段并没有让我看到`correct`来自哪里。进入`updateScore()`函数后，我可以看到这`answer`是对被点击的 HTMLAnchorElement 的引用——但是发送到的值的来源是什么`correct`？

具体来说，我在这里讨论这个粗体部分

onclick="updateScore(这个，**正确**)"

## 编辑！

试试这个版本的函数，在成功投票后更新链接

```
<script type="text/javascript">

function updateScore( answer )
{
    if ( confirm( "Are you sure?" ) )
    {
        $.post('index.php', {'score': '1'}, function(d)
        {
            alert('Vote Accepted: ' + d);
            $(answer).after("<span>You Voted!</span>").remove();
        });
    }
}

</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T04:48:15.423

我注意到的第一件事是，在您的 JavaScript 代码中，您正在执行 Ajax 请求`$.get`，而在您的 PHP 代码中，您需要一个 POST 变量`if(isset($_POST['score']))`。

所以，如果你在服务器端使用 POST 变量，你应该[`$.post`](http://docs.jquery.com/Ajax/jQuery.post)在客户端使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T05:14:09.370

你没有清理你的输入。任何人，无论是否使用您的应用程序，都可以向您发送一个“分数”，您会愉快地将其放入您的数据库中。或者他们可以很容易地向您发送 SQL 注入攻击，通过在 score 字符串 "1) 中发布；在此处进行一些攻击；插入 score(score_count) 值（2"；

# sql - SQL LIKE 子句的特殊字符列表

> ID：712580
> 
> 赞同：129
> 
> 时间：2009-04-03T04:49:43.593
> 
> 标签：sql, special-characters, sql-like

SQL 的所有特殊字符的完整列表是什么（我对 SQL Server 感兴趣，但其他的也很好）LIKE 子句？

例如

```
SELECT Name FROM Person WHERE Name LIKE '%Jon%' 
```

**[SQL 服务器](http://msdn.microsoft.com/en-us/library/ms179859.aspx)：**

1.  %
2.  _
3.  [说明符] 例如 [az]
4.  [^说明符]
5.  ESCAPE 子句 例如 %30!%%' ESCAPE '!' 将评估 30% 为真
6.  ' 字符需要用 ' 例如他们变成他们''

[**MySQL：**](http://dev.mysql.com/doc/refman/5.0/en/string-comparison-functions.html#operator_like)

1.  `%`- 任何零个或多个字符的字符串。
2.  `_`- 任何单个字符
3.  ESCAPE 子句 例如 %30!%%' ESCAPE '!' 将评估 30% 为真

[**甲骨文：**](http://dev.mysql.com/doc/refman/5.0/en/string-comparison-functions.html#operator_like)

1.  `%`- 任何零个或多个字符的字符串。
2.  `_`- 任何单个字符
3.  ESCAPE 子句 例如 %30!%%' ESCAPE '!' 将评估 30% 为真

**赛贝斯**

1.  %
2.  _
3.  [说明符] 例如 [az]
4.  [^说明符]

**[进步：](http://www.progress.com)**

1.  `%`- 任何零个或多个字符的字符串。
2.  `_`- 任何单个字符

    [参考指南在这里](http://www.progress.com/progress/products/documentation/docs/sql92/e92/e92.pdf)[PDF]

**[PostgreSQL：](http://www.postgresql.org/docs/7.4/interactive/functions-matching.html)**

1.  `%`- 任何零个或多个字符的字符串。
2.  `_`- 任何单个字符
3.  ESCAPE 子句 例如 %30!%%' ESCAPE '!' 将评估 30% 为真

**[ANSI SQL92：](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)**

1.  %
2.  _
3.  *仅当指定时才*使用 ESCAPE 字符。

PostgreSQL 还具有`SIMILAR TO`添加以下内容的运算符：

3.  `[specifier]`
4.  `[^specifier]`
5.  `|`- 两种选择中的任何一种
6.  `*`- 前一项重复零次或多次。
7.  `+`- 重复上一个项目一次或多次。
8.  `()`- 将项目组合在一起

我们的想法是使它成为一个可以成为“一站式商店”的社区 Wiki。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-03T04:54:09.463

对于 SQL Server，来自[http://msdn.microsoft.com/en-us/library/ms179859.aspx](http://msdn.microsoft.com/en-us/library/ms179859.aspx)：

*   % 任何零个或多个字符的字符串。

    `WHERE title LIKE '%computer%'`查找书名中任何位置带有单词“计算机”的所有书名。

*   _ 任何单个字符。

    `WHERE au_fname LIKE '_ean'`查找所有以 ean 结尾的四个字母的名字（Dean、Sean 等）。

*   [ ] 指定范围 ([af]) 或集合 ([abcdef]) 内的任何单个字符。

    `WHERE au_lname LIKE '[C-P]arsen'`查找以 arsen 结尾并以 C 和 P 之间的任何单个字符开头的作者姓氏，例如 Carsen、Larsen、Karsen 等。在范围搜索中，范围中包含的字符可能会根据排序规则的排序规则而有所不同。

*   [^] 不在指定范围 ([^af]) 或集合 ([^abcdef]) 内的任何单个字符。

    `WHERE au_lname LIKE 'de[^l]%'`所有作者姓氏都以 de 开头，并且后面的字母不是 l。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-03T06:25:04.970

**[ANSI SQL92](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)：**

*   %
*   _
*   *仅当指定时才*使用 ESCAPE 字符。

令人失望的是，许多数据库不遵守标准规则并添加额外的字符，或者在缺少默认值 '\' 时错误地启用了 ESCAPE。就像我们已经没有足够的麻烦'\'！

在这里编写独立于 DBMS 的代码是不可能的，因为您不知道要转义哪些字符，并且标准规定您无法转义不需要转义的内容。（见第 8.5 节/一般规则/3.a.ii.）

谢谢你的SQL！gnnn

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-08-19T16:04:19.653

您应该补充一点，您必须在 SQL Server 中添加一个额外的 ' 来转义现有的 '：

史密斯 -> 史密斯的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T04:58:12.573

**赛基：**

```
%              : Matches any string of zero or more characters.
_              : Matches a single character.
[specifier]    : Brackets enclose ranges or sets, such as [a-f] 
                 or [abcdef].Specifier  can take two forms:

                 rangespec1-rangespec2: 
                   rangespec1 indicates the start of a range of characters.
                   - is a special character, indicating a range.
                   rangespec2 indicates the end of a range of characters.

                 set: 
                  can be composed of any discrete set of values, in any 
                  order, such as [a2bR].The range [a-f], and the 
                  sets [abcdef] and [fcbdae] return the same 
                  set of values.

                 Specifiers are case-sensitive.

[^specifier]    : A caret (^) preceding a specifier indicates 
                  non-inclusion. [^a-f] means "not in the range 
                  a-f"; [^a2bR] means "not a, 2, b, or R." 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-23T16:58:39.077

# SQL Server 的潜在答案

有趣的是，我刚刚使用带有 SQL Server 的 LinqPad 运行了一个测试，它应该只是在下面运行 Linq to SQL，它会生成以下 SQL 语句。

记录 .Where(r => r.Name.Contains("lkjwer--_~[]"))

```
-- Region Parameters
DECLARE @p0 VarChar(1000) = '%lkjwer--~_~~~[]%'
-- EndRegion
SELECT [t0].[ID], [t0].[Name]
FROM [RECORDS] AS [t0]
WHERE [t0].[Name] LIKE @p0 ESCAPE '~' 
```

所以我还没有测试它，但看起来`ESCAPE '~'`关键字可能允许自动转义字符串以在类似的表达式中使用。

# sql-server-2005 - Sql查询获取值的范围

> ID：712582
> 
> 赞同：0
> 
> 时间：2009-04-03T04:51:33.107
> 
> 标签：sql-server-2005

我有一个名为 TimeList 的表

```
 SlotID           SlotStartTime    SlotEndTime
  (int identity)   (varchar(10))    (varchar(10))
    1              8:00AM           8:15AM
    2              8:15AM           8:30AM 
    3              8:30AM           8:45AM
    4              8:45AM           9:00AM
    5              9:00AM           9:15AM
    6              9:15AM           9:30AM
    7              9:30AM           9:45AM  
    8              9:45AM           10:00AM 
```

如果我通过 SlotStartTime 和 SlotEndTime 我想获得介于两者之间的时间。我使用以下查询来获取黑白 slotStarttime 8:00AM 和 slotEndTime 9:00AM 中的时隙

```
select * from TimeList1 where StartTime >='8:00AM' and EndTime <= '9:00AM' 
```

结果如下：

```
SlotID     SlotStartTime    SlotEndTime
  1          8:00AM            8:15AM
  2          8:15AM            8:30AM 
  3          8:30AM            8:45AM
  8          9:45AM            10:00AM 
```

我想从上午 8:00 开始获得 slotstarttime 和结束于上午 9:00 的 slotendtime 意味着预期结果是：

```
SlotID     SlotStartTime    SlotEndTime
  1          8:00AM           8:15AM
  2          8:15AM           8:30AM 
  3          8:30AM           8:45AM
  4          8:45AM           9:00AM 
```

我必须在查询中进行哪些更改才能获得上述结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T05:05:31.310

当您使用 varchars（或大多数语言中的字符串）时，您会发现这`"10:00" < "9:00"`仅仅是因为字符排序规则（因为`"1" < "9"`）。

您应该将日期和时间值存储在日期和时间列中。如果您*必须*使用 varchars，则需要将它们转换为固定大小的 24 小时格式才能正确执行（例如，“01:30”、“12:15”、“18:25”）。

但我的建议是将它们存储为正确的数据库日期和时间值。您的查询将更加轻松快捷。

如果我了解您的数据存储（每季度一个条目），以下解决方案可能会为您提供您想要的东西，但我的专业意见是修复列类型，因为这将允许您的 select 语句中更具表现力的条件：

```
select * from TimeList1
where left(StartTime,1) = '8'
and   right(StartTime,2) = 'AM' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T05:07:45.343

您的查询是正确的。但这是您的数据类型错误。

考虑到它们是字符串，而不是日期时间值，上午 10:00 确实出现在上午 9:00 之前。

所以如果你现在不能改变数据类型，你最好的运气就是试试这个查询：

```
Select * from TimeList1
    where StartTime >= Cast('8:00AM' as datetime)
      and EndTime   <= Cast('9:00AM' as datetime)
//make sure StartTime and EndTime is type of datetime 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T05:17:03.950

如前所述，部分问题在于您使用字符串来表示时间。您问题的另一部分是 AM/PM 符号对于计算目的来说完全是可怕的。请记住，顺序是：

```
12:00AM
12:15AM
12:30AM
12:45AM
 1:00AM
 1:15AM
 ...
 9:45AM
10:00AM
10:15AM
 ...
11:30AM
11:45AM
12:00PM
12:15PM
12:30PM
12:45PM
 1:00PM
 1:15PM
 ... 
```

24 小时制有很多优点。如果您使用：

```
00:00
00:15
00:30
00:45
01:00
01:15
 ...
09:45
10:00
10:15
 ...
11:30
11:45
12:00
12:15
12:30
12:45
13:00
13:15
 ... 
```

（对于同一组数字）然后您的 VARCHAR 字符串可以制成 CHAR(5) 并且会自动按时间顺序正确排序。您仍然需要正确地表达您的查询，包括时间小于 10:00 的前导零，但这些值将正确排序并正确比较。

一些 DBMS 提供对时间子集的支持。在 IBM Informix Dynamic Server 中，您可以使用 DATETIME HOUR TO MINUTE 作为列的类型。这将使您恢复删除前导零的灵活性。

另请参阅[将 12 小时日期/时间转换为 24 小时日期/时间](https://stackoverflow.com/questions/440061/convert-12-hour-date-time-to-24-hour-date-time)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T04:54:52.833

```
select * 
from TimeList1 
where StartTime >= '8:00AM' 
  and EndTime   <= '9:00AM' 
```

小于等于，不大于等于。

虽然实际上，当您的列是 varchar 类型时，这并不像您期望的那样工作。使用时间或日期时间类型。

> 据我所知，前两段没有解释任何事情。最后一段包含对问题的简单解释。——乔纳森·莱弗勒

在原始帖子中，在您对其进行编辑之前，OP 将其作为选择语句，

```
select * 
from TimeList1 
where StartTime >= '8:00AM' 
  and EndTime   >= '9:00AM' 
```

我是这么回应的。

我的回答可能是“脆弱的”，但我想解决明显的问题并让这个人继续前进。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T06:11:00.807

尝试这个：

```
SELECT * 
FROM TimeList1 
WHERE (CONVERT(datetime, CONVERT(varchar, GETDATE(), 103) + ' ' + StartTime) >= 
       CONVERT(datetime, CONVERT(varchar, GETDATE(), 103) + ' ' + '8:00AM')) 
    AND 
     (CONVERT(datetime, CONVERT(varchar, GETDATE(), 103) + ' ' + EndTime) <= 
      CONVERT(datetime, CONVERT(varchar, GETDATE(), 103) + ' ' + '9:00AM')) 
```

# nhibernate - 我应该从我的域模型中去除 FK 吗？

> ID：712587
> 
> 赞同：1
> 
> 时间：2009-04-03T04:53:11.150
> 
> 标签：nhibernate, domain-driven-design

我正在开始一个新项目并计划使用 nhibernate。我正在为是否应该通过省略外键来保持域模型的持久性信息保持清洁而苦苦挣扎。我一直觉得我的一些“模型”并不是真正必要的，性能将成为一个问题。例如：

在我的数据库中，我有下表：

```
Posting
    Id
    StatusId
    ... 
```

与此表有 FK 关系：

```
PostingStatus
    Id
    Name 
```

在我的模型中，我定义了 2 个类：

```
class Posting
{
    virtual int Id { get; set; }
    virtual PostingStatus Status { get; set; }
    // ..
}

class PostingStatus
{
    virtual int Id { get; set; }
    virtual string Name { get; set; }
} 
```

PostingStatus 是否属于我的模型？在我提前知道 FK 的情况下，比如在提交后更新帖子，让 nhibernate 获取 PostingStatus 实例而不是设置 FK 不是对性能造成很大影响（或者只是无用的工作）吗？

我很确定这个问题之前已经讨论过，但我一直在寻找一些讨论的片段，这些讨论具有强烈的相关性。对此问题的想法或资源将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T04:58:08.270

如果域模型需要强制执行关系，那么您需要外键。

在您真正遇到性能问题之前，不要担心性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T05:01:47.730

米奇说的。NHibernate 是由彻底考虑过这些问题的人组成的。做正确的事，在遇到问题时担心优化。

（无论如何，nhibernate 可能会从缓存中获取发布状态。）

此外，根据您的设置方式，nhibernate 可能需要 FK 约束来将您的数据库映射到您的对象。

如果 PostingStatus 是域实体，则应保留它。如果不是，请出于该原因将其删除，而不是试图过早优化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T05:21:07.777

在这种非常特殊的情况下，您实际上可以将实体 PostingStatus 替换为 Enum。如果您正确地为枚举指定值，它们可以映射到表并由 FK 强制执行。

NH 不会“只缓存”东西。对于这种情况，我建议使用带有 PostingStatus 延迟加载的二级缓存。

# asp.net-mvc - MVC - RouteLink 和图像

> ID：712593
> 
> 赞同：11
> 
> 时间：2009-04-03T04:56:07.570
> 
> 标签：asp.net-mvc, routes

我想要这个输出：

```
<a href="\Catalog\Flooring">
    <img src="http://site.com/dot.jpg" width="100px" height="100px" alt="" />
    <span>Some text here</span>
</a> 
```

使用类似于以下的 RouteLink：

```
<%= Html.RouteLink(myFPV.ProductTypeName, "CatalogType", new { controller = "Catalog", action = "Types", group = myFPV.ProductGroupName, type = myFPV.ProductTypeName })%> 
```

我无法弄清楚如何在我的标签中添加一个`<img>`和`<span>`（带有文本）标签`<a>`。

有道理？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-03T06:18:41.290

RouteLink 方法的第一个参数是链接文本。但不幸的是，它会自动编码，因此您无法向其发送 <, > 字符。（嗯，你可以。但它们会被编码。）

看看[这个页面](http://stephenwalther.com/blog/archive/2009/03/03/chapter-6-understanding-html-helpers.aspx)。

> 路由值是自动编码的 URL。例如，字符串“Hello World！” 被编码为“Hello%20World！”。
> 
> ### 渲染图像链接
> 
> 不幸的是，您不能使用 Html.ActionLink() 帮助器来呈现图像链接。因为 Html.ActionLink() 帮助器 HTML 自动对其链接文本进行编码，所以您不能将标签传递给此方法并期望标签呈现为图像。
> 
> 相反，您需要使用 Url.Action() 帮助程序来生成正确的链接。以下是如何使用图像生成删除链接：
> 
> ```
> <a href="<%= Url.Action("Delete") %>">
>   <img src="../../Content/Delete.png" alt="Delete" style="border:0px" />
> </a> 
> ```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-21T17:04:59.947

我建议使用 Url.RouteUrl。

```
<a href="@Url.RouteUrl("Default", new { action = "Index", controller = "Department", id = 1 })">
 <img src="http://site.com/dot.jpg" width="100px" height="100px" alt="" />  </a> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-01T11:17:57.767

有一个更好的选择来做到这一点。你应该尝试一些类似的东西

```
<a href="@Url.RouteUrl("index-lang")">
  <img src="~/images/logo.png" alt="">
 </a> 
```

其中“index-lang”是路由映射表中的路由名称。

# .net - Cruise control.NET 调用 IDE

> ID：712598
> 
> 赞同：1
> 
> 时间：2009-04-03T04:57:56.273
> 
> 标签：.net, scripting

我有一个名为 VxWorks 653 2.2.3 开发 shell 的 IDE，当我注意到源文件有任何变化时，需要一直调用它。所以我通过一个 VB 脚本调用了这个 shell，它调用了另外两个 .bat（批处理文件）让这个shell弹出执行。现在我觉得由于我的IDE可以通过命令行调用，它也可以通过nant脚本使用如下语句调用

D:\WindRiver\wrenv.exe -p vxworks653-2.2.3 但我看到的是它根本没有调用。我尝试了所有不同的方法，但结果都是徒劳的。任何人都可以在 nant 脚本或巡航控制中以任何方式建议我，通过它可以调用我的 IDE。现在我正在使用 VB 脚本，这是一个非常漫长的过程。

感谢和问候麦迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T05:07:58.433

你试过nant中的exec任务吗？

如果是这样，请粘贴您尝试过的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T05:22:47.197

问题：

*   您确定要调用 IDE 作为 CC.NET 构建的一部分吗？如果 IDE 出于某种原因弹出模式对话框会怎样？然后，您的整个构建运行将停止，并且必须在超时后被 CC.NET 杀死。
*   当您尝试调用它时究竟会发生什么？例如，如果您使用 nant 的 exec 任务，并且您在 nant 中设置了调试模式，那么您在日志中看到了什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T05:44:42.307

在没有关于您尝试过的内容或收到的错误消息的信息的情况下，很难为您提供帮助*。*至少，您能否发布有效的 VB 脚本和批处理文件，以便我们可以尝试将它们转换为 NAnt 脚本？

对于它的价值，假设您的示例命令行有效，这就是它作为 NAnt 脚本的样子：

```
<?xml version="1.0" encoding="utf-8" ?>
<project xmlns="http://nant.sf.net/release/0.85/nant.xsd">

  <target name="vxworks">

    <exec program="D:\WindRiver\wrenv.exe">
      <arg value="-p"/>
      <arg path="vxworks653-2.2.3"/>
    </exec>

  </target>

</project> 
```

**更新**：请注意，您需要修改第二个参数以反映 vxworks 的完整路径。有关详细信息，请参阅[在线文档](http://nant.sourceforge.net/release/latest/help/tasks/exec.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T05:59:43.580

嗨，我的 nant 现在正在调用 VB，如下所示

```
<target name="build" description="compiles the source code">
    <exec program="WScript.exe" failonerror="false" >
        <arg value="C:\ThreePartition\RunExe.vbs"/>
    </exec>
</target> 
```

RunExe.vbs 如下所示

```
Set WshShell = WScript.CreateObject("WScript.Shell") 
WshShell.Run "test.bat" 
```

test.bat 如下所示

```
CALL C:\ThreePartition\exe.bat
PAUSE 
```

exe.bat 如下所示

```
D:\WindRiver\wrenv.exe -p vxworks653-2.2.3 run 
PAUSE 
```

我已经通过 test.bat 调用了 exe.bat，因为当我直接在我的 VB 中调用 exe.bat 时，它正在调用 IDE，但是在执行后我的 IDE jst 消失了。我希望我的 IDE 保留以便我可以看看我的结果。

谢谢麦迪

# asp.net - ASP.net JSON Webservice 响应类型的问题

> ID：712606
> 
> 赞同：4
> 
> 时间：2009-04-03T05:00:30.183
> 
> 标签：asp.net, jquery, web-services, json, asmx

我正在尝试编写一个 jQuery AJAX 调用将使用的 ASP.net Web 服务。我完全无计可施，试图让它发挥作用。我在网上看到了许多类似的问题，但我一直无法找到适合的解决方案。

当我尝试进行 ajax 调用（通过 jquery）时，我从服务器获得了成功的响应，但由于解析器错误，请求失败。

我已经验证了 web 服务返回的 json 并且它是有效的。这个问题似乎源于 asp.net 将 json 对象作为 xml 返回的事实。

我已经将返回类型指定为 json 使用

```
<Script.Services.ScriptMethod(responseFormat:=Script.Services.ResponseFormat.Json)> _ 
```

我添加了以下 http 处理程序，因为它被提及为潜在的修复

```
<httpHandlers>
    <remove verb="*" path="*.asmx" />
    <add verb="*" path="*.asmx" type="System.Web.Script.Services.ScriptHandlerFactory" validate="false" />
</httpHandlers> 
```

在我的 jquery ajax 设置中，内容类型设置为“application/json; charset=utf-8”，数据类型设置为“json”。请求类型似乎是正确的，但响应始终是 xml。

我可以通过删除 dataType 成功发出请求，但我非常想避免使用 eval 反序列化数据。

如果有人有任何建议，我将不胜感激。这几天我一直在拔头发。

* * *

JAVASCRIPT

```
(function($) {
  $.ajaxSetup({
    type: "POST",
    contentType: "application/json; charset=utf-8",
    global: false,
    dataType: "json"
  });

  function auto() {
    console.log("test");
    return;
  };

  $.fn.species = {
    test: function() {
      alert("test");
    },
    load: function() { //load and attach species list to element as dropdown
      $.ajax({
        url: "SpeciesService.asmx/List",
        success: function(msg) {
          console.log(msg);
        },
        error: function(xhr, desc, exceptionobj) {
          console.log(xhr.responseText);
          console.log(desc);
          console.log(exceptionobj);
        }
      });
      return this;
    }
  }; //Species Block
})(jQuery); //jQuery Alias Block 
```

ASP.NET 网络服务

```
<%@ WebService Language="VB" Class="SpeciesService" %>
Imports System.Web
Imports System.Web.Services
Imports System.Web.Services.Protocols
Imports Species
Imports System.Runtime.Serialization 
```

' 要允许使用 ASP.NET AJAX 从脚本调用此 Web 服务，请取消注释以下行。'_

_ _ 公共类物种服务

```
Inherits System.Web.Services.WebService
<WebMethod()> _
<Script.Services.ScriptMethod(responseFormat:=Script.Services.ResponseFormat.Json)> _
Public Function Data(ByVal id As Integer) As String
    Dim curSpecies As New Species(id)
    Return curSpecies.serialize
End Function

<WebMethod()> _
<Script.Services.ScriptMethod(responseFormat:=Script.Services.ResponseFormat.Json)> _
Public Function List() As String

    Return Species.list()
End Function 
```

结束类

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T05:32:00.620

尝试使用 JQuery 发布一个虚拟 json 数据，如下所示：

```
$.ajaxSetup({
    type: "POST",
    data : "{'foo':'bar'}"
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T05:18:07.767

这更像是一个提示而不是一个答案——我一直在使用 PageMethods 而不是 webservices，它工作得很好。如果它遇到同样的问题，我会尝试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T06:34:09.833

如果您查看标头，是否正在发送内容长度？IIS 需要帖子的内容长度，因此即使在帖子中添加空正文也可能会修复它。

而且我认为它与设置为 json 的数据类型一起工作的原因是 jquery 在这种情况下为您添加了一个空的帖子正文。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T02:04:38.520

好的 - 非常感谢你们的帮助。缺乏虚拟数据是问题的核心。当我尝试在它导致服务器错误之前添加它时，我转向了其他东西。

我什至无法弄清楚是什么解决了问题的服务器错误部分。我只是花了十分钟心不在焉地弄乱语法（修复缩进、大写、注释），因为我太沮丧了，无法专注于手头的问题。我刷新了页面，突然它工作正常了。所以答案是发布虚拟数据并修复随机神秘语法错误。

Anyways I can not thank you enough for getting me back on the right track.

# vim - Vim：需要帮助以突出显示微小的脚本代码

> ID：712616
> 
> 赞同：3
> 
> 时间：2009-04-03T05:06:47.343
> 
> 标签：vim, scripting, highlight

我需要一个脚本代码来突出显示“[Capítulo”和“]”以及它们之间的所有内容。谢谢你。

我希望它每次打开时都能正常工作，例如，一个 .txt 文件。就像代码高亮一样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T05:56:50.997

这是一个简单的方法：

在 vim 中，确保语法高亮显示为`:syn on`

运行命令`:highlight`以获取所有突出显示组名称的列表，以及它们的外观示例。该`Error`组看起来在我的配色方案中很突出，所以我将在我的示例中使用它（但您可以使用任何其他名称，例如`Todo`or `Search`）

```
:syntax match Error /\[Capítulo[^\]]*\]/ 
```

这种模式将防止你贪婪地匹配最大的块。即使其他人建议您使用正则表达式`/\[Capítulo.*\]/`- 它可能不是您想要的，因为如果一行中有两个或多个这样的模式，它将匹配中间的所有内容。

例如`/\[Capítulo.*\]/`将匹配这一整行：

> **[Capítulo foo] 这些词不应突出显示 [Capítulo bar]**

相同的示例，但`/\[Capítulo[^\]]*\]/`只会匹配 [] 内的内容：

> **[Capítulo foo]**这些词不应突出显示**[Capítulo bar]**

使用正则表达式，一个常见的技巧是创建一个匹配除您想要结束匹配的字符之外的所有内容的组，而不是使用`.*`which 将匹配尽可能多的字符。在这种情况下，我们将组`[^\]]*`- 表示“*匹配除 ] 之外的所有内容。* ”

如果这按您希望的方式工作，请将不带“ `:`”的语法匹配行添加到您的 .vimrc

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T05:11:48.860

正则表达式是您要查找的内容：

键入`/`以进入“搜索模式”并键入：

```
\[Capítulo.*\]/
```

# c++ - 如何在 C++ 中将指数与变量一起使用？

> ID：712623
> 
> 赞同：1
> 
> 时间：2009-04-03T05:10:39.190
> 
> 标签：c++, variables, exponent

所以我意识到#include 是必要的，并且有一个 pow(x,y) x^y 可以工作......但是当我尝试使用 pow(2,(num-1)) 时，它会返回一个错误...

errorC2668: 'pow' : 对重载函数的模糊调用

我的代码行如下

```
perfect = (pow(2,(num-1))) * (pow(2,num)-1); 
```

有什么建议吗？

提前致谢

编辑：

num 确实被声明为 int。

num 确实有一个值，从 1 开始到 UINT_MAX

在等式中添加了一个星号

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-03T05:19:10.777

编译器不知道要调用哪个 pow() 函数。[此处](http://en.cppreference.com/w/cpp/numeric/math/pow)列出的重载给出了以下列表：

```
 float pow (       float base,       float exponent );
     double pow (      double base,      double exponent );
long double pow ( long double base, long double exponent );
      float pow (       float base,         int exponent );
     double pow (      double base,         int exponent );
long double pow ( long double base,         int exponent ); 
```

编译器不会猜测使用哪一个。使用强制转换使其明确。

```
perfect = (pow(2.,(double)(num-1))) < (pow(2.,(double)num)-1); 
```

那里可能有一些额外的演员表，但他们不会伤害任何东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T05:19:57.950

这些是`pow()`C++ 中允许的函数。问题是您的代码有一个 int 作为第一个参数，而 C++ 不知道是将其提升为 double 还是 long double。

```
 double pow (      double base,      double exponent );
long double pow ( long double base, long double exponent );
      float pow (       float base,       float exponent );
     double pow (      double base,         int exponent );
long double pow ( long double base,         int exponent ); 
```

尝试放入`(double)2`而不是仅仅`2`.

```
perfect = (pow((double)2,(num-1))) * (pow((double)2,num)-1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T05:18:17.207

添加缺少的乘法（或您想要的），并且在行尾应该有分号：

```
perfect = (pow(2,(num-1))) * (pow(2,num)-1) ; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T05:21:15.700

从[错误 C2668: 'pow' : ambiguous call to VC++ 2005 only 中的重载函数](http://social.microsoft.com/Forums/en-US/vcgeneral/thread/ce3c5584-a2fc-4955-9f9c-d8b53ed1ed07/)，alex.m 写道，

> “pow”（任何重载）将浮点类型数（单精度、双精度或长双精度）作为第一个参数，而不是整数。这就是错误的来源，因为编译器无法猜测您希望转换长整数的方式。
> 
> 只需尝试编写一个强制转换表达式，如下所示：
> 
> 代码块
> 
> c = pow((double)numberOfScansCompleted, 2);

因此，如果您尝试`pow((double)2,(num-1))`，它应该可以工作。

* * *

有趣的旁注，当我在谷歌中输入它的开头时，“pow ambiguous call to overloaded function”出现在建议的搜索中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T08:26:18.080

请记住，您还可以使用移位运算符编写 2 的整数幂：

```
int perfect = (1<<(num-1)) * ((1<<num) - 1); 
```

或与[`ldexp`](http://www.cplusplus.com/reference/clibrary/cmath/ldexp.html)（也包括从`<cmath>`）：

```
double perfect = ldexp(1.0, num-1) * (ldexp(1.0, num) - 1); 
```

# mysql - 用于分析的数据库

> ID：712626
> 
> 赞同：4
> 
> 时间：2009-04-03T05:13:04.347
> 
> 标签：mysql, postgresql, indexing, infobright

我正在建立一个大型数据库，它将根据传入的数据生成统计报告。
该系统的大部分操作如下：

1.  每天早上将上传大约 400k-500k 行 - 大约 30 列，主要是 varchar(5-30) 和 datetime。它在平面文件形式时大约为 60MB，但在添加了合适的索引后在数据库中急剧增长。
2.  将从当天的数据生成各种统计数据。
3.  将生成并存储来自这些统计数据的报告。
4.  当前数据集将被复制到分区历史表中。
5.  在一天中，最终用户可以查询当前数据集（被复制，而不是移动），以获取不太可能包括常量但字段之间关系的信息。
6.  用户可以从历史表中请求专门的搜索，但查询将由 DBA 制作。
7.  在第二天的上传之前，当前数据表被截断。

这基本上是我们现有系统的第 2 版。

现在，我们正在使用 MySQL 5.0 MyISAM 表（Innodb 仅在空间使用上就被扼杀了）并且在 #6 和 #4 上遭受了很大的痛苦。#4 目前不是分区表，因为 5.0 不支持它。为了避免将记录插入历史记录所花费的大量时间（数小时和数小时），我们每天都将写入一个未索引的 history_queue 表，然后在我们最慢的时间的周末将队列写入历史表。问题是一周内生成的任何历史查询都可能晚几天。我们无法减少历史表上的索引，否则它的查询将变得不可用。

对于下一个版本，我们肯定会至少迁移到 MySQL 5.1（如果我们继续使用 MySQL），但强烈考虑使用 PostgreSQL。我知道辩论已经进行到死，但我想知道是否有人对这种情况有任何建议。大多数研究都围绕网站使用展开。索引确实是我们使用 MySQL 的主要优势，似乎 PostgreSQL 可以通过部分索引和基于函数的索引来帮助我们。

我已经阅读了数十篇关于两者之间差异的文章，但大多数都是旧的。PostgreSQL 长期以来一直被贴上“更高级但更慢”的标签 - 将 MySQL 5.1 与 PostgreSQL 8.3 进行比较还是普遍情况还是现在更平衡？

商业数据库（Oracle 和 MS SQL）根本不是一种选择——尽管我希望 Oracle 是。

对我们来说 MyISAM 与 Innodb 的注意事项：我们正在运行 Innodb，对我们来说，我们发现它慢得多，比如慢 3-4 倍。但是，我们对 MySQL 也较新，坦率地说，我不确定我们是否为 Innodb 适当调整了 db。

我们在正常运行时间非常长的环境中运行 - 电池备份、故障转移网络连接、备用发电机、完全冗余系统等。因此，MyISAM 的完整性问题被权衡并被认为是可以接受的。

关于 5.1：我听说过 5.1 的稳定性问题。一般来说，我认为任何最近（过去 12 个月内）的软件都不是坚如磐石的稳定。考虑到重新设计项目的机会，5.1 中的更新功能集实在是太多了，不容错过。

关于 PostgreSQL 陷阱：没有任何 where 子句的 COUNT(*) 对我们来说是非常罕见的情况。我不认为这是一个问题。COPY FROM 不如 LOAD DATA INFILE 灵活，但中间加载表可以解决这个问题。我最担心的是缺少 INSERT IGNORE。我们在构建一些处理表时经常使用它，这样我们就可以避免将多条记录放入两次，然后不得不在最后做一个巨大的 GROUP BY 来删除一些重复。我认为它的使用频率很低，以至于缺乏它是可以容忍的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T13:03:00.380

根据我的实际经验，我不得不说，postgresql 的性能从 7.x/8.0 到 8.1 有相当大的提升（对于我们的用例，在某些情况下要快 2 到 3 倍），从 8.1 到 8.2 的改进较小但仍然很明显。我不知道 8.2 和 8.3 之间的改进，但我希望也有一些性能改进，到目前为止我还没有测试过。

关于索引，我建议删除它们，并且仅在用您的数据填充数据库后再次创建它们，这样会快得多。

进一步改善您的 postgresql 设置的废话，从中获得很多好处。默认设置现在至少是明智的，在 8.2 倍之前，pg 已针对在 pda 上运行进行了优化。

在某些情况下，特别是如果您有复杂的查询，它可以帮助在您的设置中停用嵌套循环，这会迫使 pg 对您的查询使用性能更好的方法。

啊，是的，我有说你应该去postgresql吗？

（另一种选择是 firebird，它不太灵活，但根据我的经验，它在某些情况下的性能比 mysql 和 postgresql 好得多）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T22:49:02.813

我的工作尝试了一个从 ERP 设置迁移历史数据的试点项目。数据的大小偏小，只有 60Gbyte，覆盖超过 2100 万行，最大的表有 1600 万行。还有大约 1500 万行等待进入管道，但由于其他优先事项，试点已被搁置。该计划是使用 PostgreSQL 的“作业”工具来安排查询，这些查询将每天重新生成适合用于分析的数据。

在包含 1600 万条记录的大型表上运行简单的聚合，我注意到的第一件事是它对可用 RAM 量的敏感程度。RAM 在某一时刻的增加允许进行一年的聚合，而无需使用顺序表扫描。

如果您决定使用 PostgreSQL，我强烈建议您重新调整配置文件，因为它倾向于使用最保守的设置（以便它可以在 RAM 很少的系统上运行）。调整需要一点时间，可能需要几个小时，但一旦你将其调整到可以接受响应的程度，只需设置它并忘记它。

一旦你完成了服务器端的调优（这完全是关于内存的，惊喜！）你将把注意力转向你的索引。索引和查询计划也需要一些努力，但一旦设置，您会发现它是有效的。部分索引是一个很好的功能，可以隔离那些包含“边缘情况”数据的记录，如果您正在寻找类似数据的海洋中的异常，我强烈推荐这个功能。

最后，使用表空间功能将数据重新定位到快速驱动器阵列上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T05:25:35.113

根据我的经验，对于非常简单的查询，Inodb 稍微快一些，对于更复杂的查询使用 pg。Myisam 在检索方面可能比 Innodb 更快，但在索引/索引修复方面可能更慢。

这些主要是 varchar 字段，您是否使用 char(n) 索引对它们进行索引？

你能把它们中的一些标准化吗？重写会花费您，但可能会节省后续查询的时间，因为您的行大小会减小，从而一次将更多行放入内存中。

编辑：

好的，所以你有两个问题，查询时间和更新历史，是吗？

至于第二个：根据我的经验，mysql myism 不擅长重新索引。在每天大小的表上（0.5 到 1M 记录，具有相当宽的（非规范化平面输入）记录），我发现重写表比插入并等待重新索引和伴随的磁盘抖动更快。

所以这*可能*有帮助，也可能没有帮助：

```
create new_table select * from old_table ; 
```

复制表格但没有索引。

然后像往常一样插入新记录。然后在新表上创建索引，稍等片刻。删除旧表，并将新表重命名为旧表。

编辑：回应第四条评论：我不知道 MyIsam 总是那么糟糕。我知道在我的特殊情况下，我对复制表然后添加索引的速度有多快感到*震惊。*碰巧的是，我正在做与您所做的类似的事情，将大型非规范化平面文件复制到数据库中，然后重新规范化数据。但这是一个轶事，而不是数据。;)

（我还认为我发现整体 InnoDb 更快，因为我执行的插入和查询一样多。数据库使用的一个非常特殊的情况。）

请注意，使用 select a.*, b.value as foo join ... 进行复制也比更新 a.foo = b.value ... join 更快，因为更新是对索引列的更新。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T06:31:09.730

我不清楚的是分析处理有多复杂。在我看来，处理 50 万条记录应该不是什么大问题，就分析处理而言，它是一个小记录集。

即使这是一项复杂的工作，如果你可以让它过夜来完成（因为这是一个日常过程，正如我从你的帖子中理解的那样），它应该仍然足够了。

关于结果表，我不会减少表的索引。同样，您可以在夜间进行加载，包括刷新索引，并让生成的更新数据集准备好在早上使用，与原始表（非索引）相比，访问速度更快。

我看到 PosgreSQL 在类似数据仓库的环境中使用，在我描述的设置（夜间数据转换工作）上工作，并且没有性能投诉。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T09:19:34.303

我会选择 PostgreSQL。例如，您需要分区表，这些表至少从 2005 年开始就在稳定的 Postgres 版本中 - 在 MySQL 中这是一个新事物。我听说过[5.1 的新功能中的稳定性问题](http://www.mysqlperformanceblog.com/2008/12/10/mysql-51-went-to-ga-was-it-a-good-move/)。使用 MyISAM，您没有参照完整性，事务和并发访问会受到很大影响 - 阅读这篇博客文章“[在生产中使用 MyISAM](http://www.mysqlperformanceblog.com/2006/06/17/using-myisam-in-production/) ”了解更多信息。

Postgres 在复杂查询上要快得多，这对你的 #6 有好处。还有一个非常活跃和有用的[邮件列表](http://archives.postgresql.org/pgsql-general/)，您甚至可以从[核心 Postgres 开发人员](http://www.postgresql.org/community/contributors/)那里免费获得支持。但它有一些[问题](https://stackoverflow.com/questions/441168/migrating-mysql-to-postgresql-what-features-not-visible-in-sql-code-will-be-imp)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-03T22:55:16.683

Infobright 的人似乎在做一些有趣的事情：

[http://www.infobright.org/](http://www.infobright.org/)

--psj

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T23:07:47.433

如果由于成本问题不考虑使用 Oracle，则可以免费使用[Oracle Express Edition （如啤酒）。](http://www.oracle.com/technology/products/database/xe/index.html)它有大小限制，但如果您不将历史保留太久，则不必担心。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-04T01:24:41.113

检查你的硬件。你在最大化 IO 吗？您是否正确配置了缓冲区？您的硬件尺寸是否正确？用于缓冲和快速磁盘的内存是关键。

如果你有太多的索引，它会大大减慢插入速度。

你怎么做你的插入？如果您为每个 INSERT 语句做一条记录：

```
INSERT INTO TABLE blah VALUES (?, ?, ?, ?) 
```

并称它为 500K 次，你的表现会很糟糕。我很惊讶它会在几个小时内完成。使用 MySQL，您可以一次插入数百或数千行：

```
INSERT INTO TABLE blah VALUES
  (?, ?, ?, ?),
  (?, ?, ?, ?),
  (?, ?, ?, ?) 
```

如果您对每个 Web 请求进行一次插入，则应考虑登录到文件系统并在 crontab 上进行批量导入。我过去曾使用这种设计来加快插入速度。这也意味着您的网页不依赖于数据库服务器。

`LOAD DATA INFILE`使用它来导入 CSV 文件也快得多。见[http://dev.mysql.com/doc/refman/5.1/en/load-data.html](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)

我可以建议的另一件事是提防 SQL 锤子——你可能没有 SQL 钉子。您是否考虑过使用[Pig](http://wiki.apache.org/pig/PigOverview)或[Hive](http://wiki.apache.org/hadoop/Hive)等工具为您的报告生成优化的数据集？

*编辑*

如果您在批量导入 500K 记录时遇到问题，则需要在某处妥协。我会在您的主表上删除一些索引，然后为每个报告创建优化的数据视图。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-05-03T10:25:27.423

您是否尝试过使用 myisam_key_buffer 参数？它对索引更新速度非常重要。

此外，如果您有日期、id 等相关列的索引，您可以执行以下操作：

```
INSERT INTO archive SELECT .. FROM current ORDER BY id (or date) 
```

这个想法是按顺序插入行，在这种情况下索引更新要快得多。当然，这只适用于与 ORDER BY 一致的索引...如果您有一些相当随机的列，那么这些将无济于事。

> 但强烈考虑 PostgreSQL。

你绝对应该测试它。

> 似乎 PostgreSQL 可以通过部分索引和基于函数的索引来帮助我们。

是的。

> 我已经阅读了数十篇关于两者之间差异的文章，但大多数都是旧的。PostgreSQL 长期以来一直被贴上“更高级但更慢”的标签 - 将 MySQL 5.1 与 PostgreSQL 8.3 进行比较还是普遍情况还是现在更平衡？

那要看情况了。与任何数据库一样，

*   如果您不知道如何配置和调整它会很慢
*   如果你的硬件不能胜任这项任务，它会很慢

一些非常了解 mysql 并想尝试 postgres 的人并没有考虑到他们需要重新学习一些东西并阅读文档这一事实，因此对配置非常糟糕的 postgres 进行了基准测试，这可能会很慢。

对于网络使用，我在低端服务器（Core 2 Duo，SATA 磁盘）上使用我编写的自定义基准论坛对配置良好的 postgres 进行了基准测试，它每秒吐出超过 4000 个论坛网页，使数据库饱和服务器的千兆以太网链接。因此，如果您知道如何使用它，它可能会非常快（由于并发问题，InnoDB 速度要慢得多）。“MyISAM 对小型简单选择更快”是完全公牛，postgres 将在 50-100 微秒内完成“小型简单选择”。

现在，为了您的使用，您不在乎；）

你关心你的数据库计算大聚合和大连接的方式，一个正确配置的具有良好 IO 系统的 postgres 通常会在这些系统上胜过 MySQL 系统，因为优化器更聪明，并且有更多的连接/聚合类型从中选择。

> 我最担心的是缺少 INSERT IGNORE。我们在构建一些处理表时经常使用它，这样我们就可以避免将多条记录放入两次，然后不得不在最后做一个巨大的 GROUP BY 来删除一些重复。我认为它的使用频率很低，以至于缺乏它是可以容忍的。

您可以使用 GROUP BY，但如果您只想将不存在的记录插入表中，您可以这样做：

```
INSERT INTO target SELECT .. FROM source LEFT JOIN target ON (...) WHERE target.id IS NULL 
```

在您的用例中，您没有并发问题，因此效果很好。

# c++ - 理解术语和概念的含义 - RAII (Resource Acquisition is Initialization)

> ID：712639
> 
> 赞同：114
> 
> 时间：2009-04-03T05:21:53.390
> 
> 标签：c++, garbage-collection, raii, resource-management

各位 C++ 开发人员能否给我们一个好的描述 RAII 是什么，为什么它很重要，以及它是否可能与其他语言有任何关系？

我*知道*一点。我相信它代表“资源获取就是初始化”。然而，这个名字与我（可能不正确）对 RAII 的理解不符：我的印象是 RAII 是一种在堆栈上初始化对象的方式，这样，当这些变量超出范围时，析构函数将自动被调用导致资源被清理。

那么为什么不称为“使用堆栈触发清理”（UTSTTC:)？你如何从那里到达“RAII”？

你怎么能在堆栈上做一些东西来清理堆上的东西呢？另外，是否存在不能使用 RAII 的情况？您是否曾经发现自己希望进行垃圾收集？至少一个垃圾收集器可以用于某些对象，同时让其他对象得到管理？

谢谢。

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-04-03T12:51:29.520

> 那么为什么不称为“使用堆栈触发清理”（UTSTTC:)？

RAII 告诉您该做什么：在构造函数中获取您的资源！我要补充：一种资源，一种构造函数。UTSTTC 只是其中的一种应用，RAII 更多。

**资源管理很烂。**在这里，资源是使用后需要清理的任何东西。对跨平台项目的研究表明，大多数错误都与资源管理有关——在 Windows 上尤其严重（由于对象和分配器的类型很多）。

在 C++ 中，由于异常和（C++ 风格）模板的结合，资源管理特别复杂。有关引擎盖下的一瞥，请参阅[GOTW8](http://www.gotw.ca/gotw/008.htm)）。

* * *

C++ 保证**当且仅当**构造函数成功时才调用析构函数。依靠这一点，RAII 可以解决许多普通程序员甚至可能没有意识到的棘手问题。除了“我的局部变量将在我返回时被销毁”之外，这里还有一些示例。

`FileHandle`让我们从一个使用 RAII的过于简单的类开始：

```
class FileHandle
{
    FILE* file;

public:

    explicit FileHandle(const char* name)
    {
        file = fopen(name);
        if (!file)
        {
            throw "MAYDAY! MAYDAY";
        }
    }

    ~FileHandle()
    {
        // The only reason we are checking the file pointer for validity
        // is because it might have been moved (see below).
        // It is NOT needed to check against a failed constructor,
        // because the destructor is NEVER executed when the constructor fails!
        if (file)
        {
            fclose(file);
        }
    }

    // The following technicalities can be skipped on the first read.
    // They are not crucial to understanding the basic idea of RAII.
    // However, if you plan to implement your own RAII classes,
    // it is absolutely essential that you read on :)

    // It does not make sense to copy a file handle,
    // hence we disallow the otherwise implicitly generated copy operations.

    FileHandle(const FileHandle&) = delete;
    FileHandle& operator=(const FileHandle&) = delete;

    // The following operations enable transfer of ownership
    // and require compiler support for rvalue references, a C++0x feature.
    // Essentially, a resource is "moved" from one object to another.

    FileHandle(FileHandle&& that)
    {
        file = that.file;
        that.file = 0;
    }

    FileHandle& operator=(FileHandle&& that)
    {
        file = that.file;
        that.file = 0;
        return *this;
    }
} 
```

如果构造失败（有例外），则不会调用其他成员函数 - 甚至是析构函数 - 都不会被调用。

**RAII 避免使用处于无效状态的对象。**在我们使用该对象之前，它已经让生活变得更轻松了。

现在，让我们看一下临时对象：

```
void CopyFileData(FileHandle source, FileHandle dest);

void Foo()
{
    CopyFileData(FileHandle("C:\\source"), FileHandle("C:\\dest"));
} 
```

需要处理三种错误情况：无法打开文件、只能打开一个文件、两个文件都可以打开但复制文件失败。在非 RAII 实现中，`Foo`必须明确处理所有三种情况。

**RAII 会释放已获取的资源，即使在一个语句中获取了多个资源。**

现在，让我们聚合一些对象：

```
class Logger
{
    FileHandle original, duplex;   // this logger can write to two files at once!

public:

    Logger(const char* filename1, const char* filename2)
    : original(filename1), duplex(filename2)
    {
        if (!filewrite_duplex(original, duplex, "New Session"))
            throw "Ugh damn!";
    }
} 
```

`Logger`如果`original`' 的构造函数失败（因为无法`filename1`打开）、`duplex`的构造函数失败（因为`filename2`无法打开）或写入`Logger`' 的构造函数主体内的文件失败，则 的构造函数将失败。在任何这些情况下，都*不会*`Logger`调用' 的析构函数- 所以我们不能依赖' 的析构函数来释放文件。但是如果被构造，它的析构函数将在构造函数的清理过程中被调用。*`Logger``original``Logger`*

 ***RAII 简化了部分构建后的清理工作。**

* * *

**负面观点：**

负分？所有问题都可以通过 RAII 和智能指针解决；-)

当您需要延迟获取时，RAII 有时会很笨拙，将聚合对象推入堆中。
想象一下 Logger 需要一个`SetTargetFile(const char* target)`. 在这种情况下，仍需要成为 的成员的句柄`Logger`需要驻留在堆上（例如，在智能指针中，以适当地触发句柄的销毁。）

我从来没有真正希望垃圾收集。当我做 C# 时，我有时会感到一阵幸福，我只是不需要在意，但更想念所有可以通过确定性破坏来创造的酷玩具。（使用`IDisposable`只是不会削减它。）

我有一个可能受益于 GC 的特别复杂的结构，其中“简单”的智能指针会导致对多个类的循环引用。我们通过仔细平衡强指针和弱指针来糊里糊涂，但任何时候我们想改变一些东西，我们都必须研究一个大的关系图。GC 可能会更好，但是一些组件拥有应该尽快释放的资源。

* * *

关于 FileHandle 示例的注释：它并不打算完整，只是一个示例 - 但结果不正确。感谢 Johannes Schaub 指出并感谢 FredOverflow 将其转变为正确的 C++0x 解决方案。随着时间的推移，我已经习惯了[这里记录](http://www.codeproject.com/KB/stl/boostsp_handleref.aspx)的方法。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2011-01-19T21:24:40.777

那里有很好的答案，所以我只是添加一些忘记的东西。

## 0\. RAII 是关于范围的

RAII 是关于两者：

1.  在构造函数中获取资源（无论是什么资源），并在析构函数中取消获取它。
2.  在声明变量时执行构造函数，并在变量超出范围时自动执行析构函数。

其他人已经回答了，所以我不会详细说明。

## 1\. 使用 Java 或 C# 编码时，您已经使用 RAII...

> 乔丹先生：什么！当我说，“妮可，给我拖鞋，给我睡帽，”那是散文吗？
> 
> 哲学大师：是的，先生。
> 
> MONSIEUR JOURDAIN：四十多年来，我一直在说散文，但对此一无所知，我非常感谢你教会了我这一点。
> 
> *——莫里哀：中产阶级绅士，第 2 幕，第 4 场*

正如 Jourdain 先生对散文所做的那样，C# 甚至 Java 人已经在使用 RAII，但是以隐藏的方式。例如，以下 Java 代码（在 C# 中以相同的方式编写，用 替换`synchronized`）`lock`：

```
void foo()
{
   // etc.

   synchronized(someObject)
   {
      // if something throws here, the lock on someObject will
      // be unlocked
   }

   // etc.
} 
```

...已经在使用RAII：互斥量获取在关键字（`synchronized`或`lock`）中完成，退出范围时将完成取消获取。

它的符号非常自然，即使对于从未听说过 RAII 的人来说也几乎不需要解释。

在这里，C++ 相对于 Java 和 C# 的优势是可以使用 RAII 制作任何东西。`synchronized`例如，在 C++ 中没有等价于nor的直接内置`lock`函数，但我们仍然可以拥有它们。

在 C++ 中，它会这样写：

```
void foo()
{
   // etc.

   {
      Lock lock(someObject) ; // lock is an object of type Lock whose
                              // constructor acquires a mutex on
                              // someObject and whose destructor will
                              // un-acquire it 

      // if something throws here, the lock on someObject will
      // be unlocked
   }

   // etc.
} 
```

可以很容易地用 Java/C# 方式编写（使用 C++ 宏）：

```
void foo()
{
   // etc.

   LOCK(someObject)
   {
      // if something throws here, the lock on someObject will
      // be unlocked
   }

   // etc.
} 
```

## 2\. RAII 有其他用途

> 白兔：[唱歌]我迟到了/我迟到了/为了一个非常重要的约会。/ 没时间说“你好”。/ 再见。/ 我来晚了，我来晚了，我来晚了。
> 
> *——爱丽丝梦游仙境（迪士尼版，1951）*

你知道构造函数什么时候被调用（在对象声明处），你也知道它对应的析构函数什么时候被调用（在作用域的出口处），所以你可以只用一行代码编写几乎神奇的代码。欢迎来到 C++ 仙境（至少，从 C++ 开发人员的角度来看）。

例如，您可以编写一个计数器对象（我将其作为练习）并通过声明其变量来使用它，就像上面使用的锁定对象一样：

```
void foo()
{
   double timeElapsed = 0 ;

   {
      Counter counter(timeElapsed) ;
      // do something lengthy
   }
   // now, the timeElapsed variable contain the time elapsed
   // from the Counter's declaration till the scope exit
} 
```

当然，可以再次使用宏以 Java/C# 方式编写：

```
void foo()
{
   double timeElapsed = 0 ;

   COUNTER(timeElapsed)
   {
      // do something lengthy
   }
   // now, the timeElapsed variable contain the time elapsed
   // from the Counter's declaration till the scope exit
} 
```

## 3.为什么C++缺乏`finally`？

> [呼喊] 这是**最后**的倒计时！
> 
> *— 欧洲：最后的倒计时（对不起，我没有报价，在这里... :-)*

该`finally`子句在 C#/Java 中用于在范围退出（通过`return`异常或抛出异常）的情况下处理资源处置。

精明的规范读者会注意到 C++ 没有 finally 子句。这不是错误，因为 C++ 不需要它，因为 RAII 已经处理资源处理。（相信我，编写 C++ 析构函数比编写正确的 Java finally 子句，甚至是 C# 的正确 Dispose 方法要容易得多）。

不过，有时，一个`finally`条款会很酷。我们可以在 C++ 中做到这一点吗？[我们可以！](http://www.boost.org/doc/libs/1_41_0/libs/scope_exit/doc/html/index.html)再次使用 RAII。

## 结论：RAII 不仅仅是 C++ 中的哲学：它是 C++

> 雷伊？这是C++！！！
> 
> *—— C++ 开发者的愤怒评论，被一个不起眼的斯巴达国王和他的 300 位朋友无耻地抄袭*

当您在 C++ 方面达到一定程度的经验时，您会开始考虑**RAII**、**构造函数和析构函数的自动执行**。

您开始考虑**范围**，并且`{`和`}`字符成为您代码中最重要的字符。

几乎所有东西都适合 RAII：异常安全、互斥体、数据库连接、数据库请求、服务器连接、时钟、操作系统句柄等，最后但并非最不重要的是内存。

数据库部分是不可忽视的，因为如果你愿意付出代价，你甚至可以用“**事务性编程**”风格编写，执行一行又一行的代码，直到最后决定是否要提交所有更改，或者，如果不可能，则将所有更改还原（只要每行至少满足强异常保证）。（有关事务性编程，请参阅这篇[Herb 的 Sutter 文章](http://www.gotw.ca/gotw/061.htm)的第二部分）。

就像一个谜题，一切都合适。

RAII 是 C++ 的重要组成部分，没有它，C++ 就不可能是 C++。

这就解释了为什么有经验的 C++ 开发人员如此迷恋 RAII，以及为什么 RAII 是他们在尝试另一种语言时首先搜索的东西。

它还解释了为什么垃圾收集器虽然本身就是一项了不起的技术，但从 C++ 开发人员的角度来看并没有那么令人印象深刻：

*   RAII 已经处理了 GC 处理的大部分案件
*   GC 比 RAII 更好地处理纯托管对象的循环引用（通过智能使用弱指针来缓解）
*   仍然 GC 仅限于内存，而 RAII 可以处理任何类型的资源。
*   如上所述，RAII 可以做的很多很多……

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-03T05:28:39.507

RAII 使用 C++ 析构函数语义来管理资源。例如，考虑一个智能指针。你有一个指针的参数化构造函数，它用对象的地址初始化这个指针。您在堆栈上分配一个指针：

```
SmartPointer pointer( new ObjectClass() ); 
```

当智能指针超出范围时，指针类的析构函数会删除连接的对象。指针是堆栈分配的，对象是堆分配的。

在某些情况下，RAII 没有帮助。例如，如果您使用引用计数智能指针（如 boost::shared_ptr）并创建一个带有循环的类图结构，您将面临内存泄漏的风险，因为循环中的对象会阻止彼此被释放。垃圾收集将有助于解决这个问题。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-03T08:50:29.100

我想把它比以前的回答更强烈一些。

RAII，*Resource Acquisition Is Initialization*，意思是所有获取的资源都应该在对象初始化的上下文中获取。这禁止“裸”资源获取。基本原理是 C++ 中的清理工作基于对象，而不是基于函数调用。因此，所有清理都应该由对象完成，而不是函数调用。从这个意义上说，C++ 比 Java 更面向对象。Java 清理基于`finally`子句中的函数调用。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-04-03T07:45:31.440

我同意cpitis。但想补充一点，资源可以是任何东西，而不仅仅是内存。资源可以是文件、临界区、线程或数据库连接。

之所以称为资源获取即初始化，是因为在构造控制资源的对象时获取资源，如果构造失败（即由于异常），则不获取资源。然后，一旦对象超出范围，资源就会被释放。c++保证栈上所有构造成功的对象都会被销毁（这包括基类的构造函数和成员，即使超类构造函数失败）。

RAII 背后的合理性是使资源获取异常安全。无论哪里发生异常，所有获取的资源都会被正确释放。然而，这确实依赖于获取资源的类的质量（这必须是异常安全的，这很难）。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-04-03T05:34:56.543

垃圾收集的问题在于您失去了对 RAII 至关重要的确定性破坏。一旦变量超出范围，则由垃圾收集器决定何时回收该对象。对象持有的资源将继续持有，直到调用析构函数。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-03T06:08:25.883

RAII 来自 Resource Allocation Is Initialization。基本上，这意味着当构造函数完成执行时，构造的对象已完全初始化并可以使用。它还暗示析构函数将释放对象拥有的任何资源（例如内存、操作系统资源）。

与垃圾收集语言/技术（例如Java、.NET）相比，C++ 允许完全控制对象的生命周期。对于堆栈分配的对象，您将知道何时调用对象的析构函数（当执行超出范围时），这在垃圾收集的情况下不受真正控制。即使在 C++ 中使用智能指针（例如 boost::shared_ptr），您也会知道当没有对指向对象的引用时，将调用该对象的析构函数。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-03T15:21:38.193

> 你怎么能在堆栈上做一些东西来清理堆上的东西呢？

```
class int_buffer
{
   size_t m_size;
   int *  m_buf;

   public:
   int_buffer( size_t size )
     : m_size( size ), m_buf( 0 )
   {
       if( m_size > 0 )
           m_buf = new int[m_size]; // will throw on failure by default
   }
   ~int_buffer()
   {
       delete[] m_buf;
   }
   /* ...rest of class implementation...*/

};

void foo() 
{
    int_buffer ib(20); // creates a buffer of 20 bytes
    std::cout << ib.size() << std::endl;
} // here the destructor is called automatically even if an exception is thrown and the memory ib held is freed. 
```

当 int_buffer 的实例存在时，它必须具有大小，并且它将分配必要的内存。当它超出范围时，它的析构函数被调用。这对于诸如同步对象之类的东西非常有用。考虑

```
class mutex
{
   // ...
   take();
   release();

   class mutex::sentry
   {
      mutex & mm;
      public:
      sentry( mutex & m ) : mm(m) 
      {
          mm.take();
      }
      ~sentry()
      {
          mm.release();
      }
   }; // mutex::sentry;
};
mutex m;

int getSomeValue()
{
    mutex::sentry ms( m ); // blocks here until the mutex is taken
    return 0;  
} // the mutex is released in the destructor call here. 
```

> 另外，是否存在不能使用 RAII 的情况？

不，不是。

> 您是否曾经发现自己希望进行垃圾收集？至少一个垃圾收集器可以用于某些对象，同时让其他对象得到管理？

绝不。垃圾收集只解决了动态资源管理的一小部分。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-03T11:04:53.910

这里已经有很多好的答案了，但我想补充一下：
对 RAII 的简单解释是，在 C++ 中，分配在堆栈上的对象在超出范围时会被销毁。这意味着，将调用对象析构函数并可以进行所有必要的清理。
这意味着，如果创建的对象没有“new”，则不需要“delete”。这也是“智能指针”背后的理念——它们驻留在堆栈上，并且本质上包装了一个基于堆的对象。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-03T10:03:25.133

RAII 是 Resource Acquisition Is Initialization 的首字母缩写词。

这种技术对于 C++ 非常独特，因为它们支持构造函数和析构函数，并且几乎自动支持与传入的参数匹配的构造函数，或者在最坏的情况下调用默认构造函数，如果显式提供则调用析构函数，否则调用默认构造函数如果您没有为 C++ 类显式编写析构函数，则调用由 C++ 编译器添加的。这只发生在自动管理的 C++ 对象上——这意味着不使用空闲存储（使用 new,new[]/delete,delete[] C++ 运算符分配/释放的内存）。

RAII 技术利用这种自动管理的对象特性来处理在堆/空闲存储上创建的对象，方法是使用 new/new[] 显式请求更多内存，应该通过调用 delete/delete[] 显式销毁这些对象. 自动管理对象的类将包装在堆/空闲存储内存上创建的另一个对象。因此，当运行自动管理对象的构造函数时，将在堆/空闲存储内存上创建包装对象，并且当自动管理对象的句柄超出范围时，自动调用该自动管理对象的析构函数，其中包装对象使用 delete 销毁对象。使用 OOP 概念，如果您将此类对象包装在私有范围内的另一个类中，您将无法访问被包装的类成员和方法& 这就是设计智能指针（又名句柄类）的原因。这些智能指针将包装的对象作为类型化对象公开给外部世界，并允许调用公开的内存对象组成的任何成员/方法。请注意，智能指针根据不同的需求有不同的风格。您应该参考 Andrei Alexandrescu 的 Modern C++ Programming 或 boost 库的 (www.boostorg) shared_ptr.hpp implementation/documentation 以了解更多信息。希望这可以帮助您了解 RAII。您应该参考 Andrei Alexandrescu 的 Modern C++ Programming 或 boost 库的 (www.boostorg) shared_ptr.hpp implementation/documentation 以了解更多信息。希望这可以帮助您了解 RAII。您应该参考 Andrei Alexandrescu 的 Modern C++ Programming 或 boost 库的 (www.boostorg) shared_ptr.hpp implementation/documentation 以了解更多信息。希望这可以帮助您了解 RAII。

# c# - 查找视频卡

> ID：712641
> 
> 赞同：0
> 
> 时间：2009-04-03T05:24:18.907
> 
> 标签：c#

如何检测系统中所有可用的显卡？示例：像素视图

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T05:30:21.437

一种方法是使用[WMI](http://msdn.microsoft.com/en-us/library/aa394583(VS.85).aspx) [Win32_VideoController](http://msdn.microsoft.com/en-us/library/aa394512(VS.85).aspx)类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T05:29:48.893

[您可以使用AdapterInformation](http://msdn.microsoft.com/en-us/library/bb281503.aspx)类和 DirectX SDK检索此信息。

[这](http://www.geekpedia.com/tutorial127_List-display-adapters-using-DirectX-9.html)是一些示例代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T05:31:08.643

这不完全是您所需要的，但您可以使用 WMI 枚举所有硬件：

[代码项目 1](http://www.codeproject.com/KB/scripting/wmiadmin.aspx) [代码项目 2](http://69.10.233.10/KB/cs/EverythingInWmi03.aspx)

# ssh - sshfs EBCDIC 转 ASCII

> ID：712646
> 
> 赞同：2
> 
> 时间：2009-04-03T05:27:39.133
> 
> 标签：ssh, ascii, fuse, ebcdic, sshfs

我想要做的是能够通过 sshfs 在我的本地 PC 上通过 USS 在大型机上挂载一些文件。我可以这样做，但 sshfs 不会直接从 EBCDIC 转换为 ascii/unicode。有没有我可以设置的标志。

或者，有人知道将 EBCDIC 转换为 ASCII 以便我可以添加到 SSHFS 的库吗？

干杯

标记

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T11:25:03.220

请注意，尽管透明字符集转换是一种非常危险的游戏。你确定你*永远不会*通过 SSHFS 读取 EBCDIC 文件以外的任何东西吗？如果有二进制数据怎么办？

一些系统过去使用透明转换：

*   臭名昭著的 FTP 的“ASCII 模式”，它搞砸了许多二进制下载
*   Linux 中的 vfat 文件系统，其中指出：“执行计算 lseek 的程序不喜欢内核文本转换。有几个人的数据被这种翻译破坏了。小心！”

因此，我强烈建议您注意后果。

为什么不使用可以处理 EBCDIC 的编辑器？Vim eg 可以做到（如果它被编译）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T05:35:54.870

有几个用于字符集转换的库 — iconv（通常是 C 库的一部分；参见示例`iconv_open`）和[GNU recode](http://www.gnu.org/software/recode/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-23T10:31:45.803

我知道自从最初的问题以来已经过去了很多时间，但我会在这里留下信息：
我已经为 sshfs 编写了一个补丁，它添加了 ASCII 和 EBCDIC 之间的自动转换。可以在这里找到：[https ://github.com/vadimshchukin/sshfs-ebcdic](https://github.com/vadimshchukin/sshfs-ebcdic)

该补丁添加了“-t”命令行选项，该选项为应转换的文件定义正则表达式。例如`sshfs -t".*"` 定义所有文件的转换。

我不得不对转换表进行“硬编码”，因为 EBCDIC 有各种“风格”，并且 iconv 没有根据需要在我的系统上将 ASCII 之间的文本转换为 EBCDIC。这里的优点是有人可以根据需要轻松更改该翻译表。

顺便说一句，我为 win-sshfs 编写了相同的补丁。

# .net - 与 IIS7 的 LinkPoint 支付集成崩溃 w3wp.exe

> ID：712648
> 
> 赞同：3
> 
> 时间：2009-04-03T05:28:24.607
> 
> 标签：.net, visual-studio, iis-7, crash, linkpoint

我包装第三方 DLL 的程序集在我的 Windows 测试工具应用程序中运行良好，并且在以调试模式（VS 2008 Visual Studio 开发服务器）生成时，它们***在***Web 服务中***也运行良好！***但是，应用程序在本地 IIS 7 Web 服务器中运行时总是崩溃。以下是在本地 IIS 服务器上运行时事件日志中的崩溃详细信息：

> 错误应用程序 w3wp.exe，版本 7.0.6001.18000，时间戳 0x47919413，错误模块 ntdll.dll，版本 6.0.6001.18000，时间戳 0x4791a783，异常代码 0xc0000374，错误偏移量 0x000aada3，进程 id 0x990143392c

讨论：我围绕来自第三方的 .NET dll（来自 FirstData 的 LinkPointTransaction.dll）编写了一个包装器，并且我编写了一些引用该包装器的其他程序集。在代码运行时，对第三方的调用`LinkPointTransaction.LinkPointTxn.Send()`通过 Internet 成功将事务发送到 FirstData，但我的应用程序在调用***过程中的某个地方崩溃了 w3wp.exe，然后它到达下一行。***它不会抛出我可以看到的托管异常；它只是崩溃。除了在 IIS7 中之外，在我的机器上的任何地方都可以正常工作。

我正在运行 64 位 Vista Home Premium (IIS7)，但我在 IIS 中启用了 32 位应用程序，为此 Web 服务创建了一个单独的 AppPool，并将我的所有程序集强制为 x86。我尝试在具有管理员权限的用户帐户下运行应用程序池，而不是作为网络服务。UAC 已关闭。我尝试过集成和经典模式。我在本地防火墙中明确打开了 LinkPointTransaction.dll 用来与 FirstData 通信的 TCP/IP 端口。我什至关闭了我的防火墙（在路由器后面）。

使用我列出的任何这些变通方法，它***始终***可以在 Windows 应用程序和 VS 开发服务器内的 Web 服务中运行，但**不能**在本地 IIS 服务器中运行。

IIS 网站的 AppPool 处于经典模式。（回应吉顿）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T21:00:20.123

我认为这不再是一个编程问题，所以我正在“回答”它。

使用 WinDbg，我已将其追踪到供应商提供的 dll。当应用程序崩溃时，看起来 dll 取消分配内存的方式存在问题。调用堆栈显示 dll 中的内存释放操作，然后是内核中的“heap free”操作，然后是 ntdll 中的“free heap”操作，以及随后的“report heap failure”（然后是 RtlReportCriticalFailure）整件事情。

我仍然不明白为什么它在 Windows 窗体应用程序和 IIS 6 中有效，但在 IIS 7 中无效。但是，这已成为一个平台问题，而不是“编程”问题。此外，修复它可能是供应商的责任，而不是我来解决它。

**更新**：在向供应商提交技术支持票的两天内，他们提供了一组更新的集成 DLL，这些 DLL 使用您在 regsvr32 中注册的 COM 对象，如果您在 WOW64 中注册，它可以在 IIS7 64 位中运行目录。是的，第一个数据技术支持！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-08-15T15:23:23.557

我向 First Data 询问了有关 DLL 的信息以及能否在 IIS7/.NET 4/Win 2008 64 位上运行它。这是他们的回应：

> 感谢您最近对 First Data Global Gateway 的询问。Webservice API 是我们当前针对在 IIS 7 上运行的 64 位计算机的解决方案，因为没有任何 dll 文件（Linkpointtransaction.dll、LPICOM_6_.dll）将被更新以适用于 64 位服务器。Webservice API 将需要安装客户端证书并通过 SOAP 请求发送交易。有关 Web 服务 API 的更多信息，[请访问 http://www.firstdata.com/downloads/marketing-merchant/FDGG-Web-Service-API-v4.0.pdf](http://www.firstdata.com/downloads/marketing-merchant/FDGG-Web-Service-API-v4.0.pdf)。
> 
> 如果您需要进一步的说明或问题，请通过下面的电话号码联系我们的支持台。请注意，API 支持服务台时间为美国东部标准时间周一至周五上午 9:00 至下午 6:00。

这应该有助于其他人在未来寻找类似的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T07:03:20.340

IIS7中的网站是如何配置的？如果它在集成模式下运行，请切换到经典模式。请参阅[在 IIS 7.0 上以集成模式运行的 ASP.NET 2.0 应用程序的重大更改](http://mvolo.com/blogs/serverside/archive/2007/12/08/IIS-7.0-Breaking-Changes-ASP.NET-2.0-applications-Integrated-mode.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-29T17:48:42.790

我遇到了一个非常相似的问题，在搞砸了几天之后，我开始意识到，如果我在 MSTest 中一遍又一遍地运行相同的代码，有时它会失败并完全使测试过程崩溃，而其他时候它可以工作美好的。

真正奇怪的是，它最常发生在调试 MSTest 时，但是，如果我在测试方法内部单击，然后在主按钮栏上单击“在当前上下文中调试测试”，那么它几乎总是失败。如果我通过单击“测试结果”窗口中的“调试”来运行测试，那么它几乎总是正确通过。

如果我不在调试模式下运行，它也几乎总是可以正常工作，但有时仍然会失败。我什至在 2 个不同的 VisualStudio 2010 实例中的 2 个不同项目之间复制/粘贴完全相同的代码，其中一个代码将正常运行，而在另一个它将失败。

# c# - C#接口的隐式和显式实现之间的区别

> ID：712657
> 
> 赞同：8
> 
> 时间：2009-04-03T05:34:50.037
> 
> 标签：c#, interface

*显式实现接口*和*实现接口*有什么区别。

当你从一个接口派生一个类时，intellisense 建议你两者都做。

但是，有什么区别呢？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-03T05:47:01.397

这方面的另一个方面：

如果您*隐式*实现，则意味着您的类的用户可以访问接口成员，而无需他们进行强制转换。

如果它是*显式*实现的，则客户端必须先将您的类转换为接口，然后才能访问成员。这是一个显式实现的示例：

```
 interface Animal
{
    void EatRoots();
    void EatLeaves();
}

interface Animal2
{
    void Sleep();
}

class Wombat : Animal, Animal2
{
    // Implicit implementation of Animal2
    public void Sleep()
    {
    }

    // Explicit implementation of Animal
    void Animal.EatRoots()
    {

    }

    void Animal.EatLeaves()
    {
    }

} 
```

您的客户代码

```
Wombat w = new Wombat();
w.Sleep();
w.EatRoots();   // This will cause a compiler error because it's explicitly implemented
((Animal)w).EatRoots();  // This will compile 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-03T05:42:04.513

IDE 让您可以*选择*两者中的任何一个 - 两者都做是不寻常的。通过显式实现，成员不在（主要）公共 API 上；如果接口不直接与对象的意图相关联，这很方便。例如，`ICustomTypeDescriptor`成员对常规调用者并没有那么大的帮助——只对一些非常具体的代码有帮助，因此将它们放在公共 API 上造成混乱是没有意义的。

这在以下情况下也很有用：

*   `Foo`接口的方法和你自己的类型的方法有冲突`Foo`，它们的含义不同
*   其他接口之间存在签名冲突

最后一点的典型示例是`IEnumerable<T>`，它在接口层次结构中的两个级别上都有一个`GetEnumerator()`方法——通常`IEnumerator<T>`使用隐式实现来实现类型化 ( ) 版本，`IEnumerator`使用显式实现来实现非类型化 ( ) 版本。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-03T08:04:28.820

这是简单英语的区别：

假设你有一个接口`Machine`，它有一个函数`Run()`，另一个接口`Animal`也有一个名为 的函数`Run()`。当然，当机器运行时，我们谈论的是它的启动，但是当动物奔跑时，我们谈论的是它四处移动。那么当你有一个对象时会发生什么，让我们称它为`Aibo`a`Machine`和 an `Animal`？（顺便说一句，Aibo 是一只机械狗。）`Aibo`跑步时，他是启动还是四处走动？显式实现一个接口可以让您做出这种区分：

```
interface Animal
{
    void Run();
}
interface Machine
{
    void Run();
}

class Aibo : Animal, Machine
{
    void Animal.Run()
    {
        System.Console.WriteLine("Aibo goes for a run.");
    }
    void Machine.Run()
    {
        System.Console.WriteLine("Aibo starting up.");
    }
}
class Program
{
    static void Main(string[] args)
    {
        Aibo a = new Aibo();
        ((Machine)a).Run();
        ((Animal)a).Run();
    }
} 
```

这里的问题是我不能简单地调用`a.Run()`，因为我的两个函数实现都显式附加到接口。这是有道理的，否则编译器怎么知道该调用哪一个呢？相反，如果我想直接调用`Run()`my 上的函数`Aibo`，我**还**必须在没有显式接口的情况下实现该函数。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-03T05:38:53.630

显式将IInterfaceName。在所有接口实现的前面。如果您需要实现两个包含冲突的名称/签名的接口，这将很有用。

更多信息[在这里](http://msdn.microsoft.com/en-us/library/4taxa8t2(VS.80).aspx)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T05:45:48.077

显式实现将完全限定名称放在函数名称上考虑此代码

```
 public interface IamSam
    {
        int foo();
        void bar();
    }

    public class SamExplicit : IamSam
    {
        #region IamSam Members

        int IamSam.foo()
        {
            return 0;
        }

        void IamSam.bar()
        {

        }

        string foo()
        {
            return "";
        }
        #endregion
    }

    public class Sam : IamSam
    {
        #region IamSam Members

        public int foo()
        {
            return 0;
        }

        public void bar()
        {

        }

        #endregion
    }

IamSam var1;
var1.foo()  returns an int.
SamExplicit var2;
var2.foo() returns a string.
(var2 as IamSam).foo() returns an int. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T05:37:39.530

给你，直接来自[MSDN](http://msdn.microsoft.com/en-us/library/aa288461(VS.71).aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T05:38:50.683

不同之处在于您可以从多个接口继承一个类。这些接口可能具有相同的方法签名。显式实现允许您根据用于调用它的接口来更改您的实现。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T07:10:04.207

显式接口实现（除非您显式强制转换，否则该实现是隐藏的）在接口与类功能正交时最有用。也就是说，行为上不相关。

例如，如果您的类是 Person 并且接口是 ISerializable，那么处理 Person 属性的人通过 Intellisense 看到名为“GetObjectData”的奇怪东西就没有多大意义。因此，您可能希望显式实现该接口。

另一方面，如果您的 person 类碰巧实现了 IAddress，那么直接在 Person 实例上查看 AddressLine1、ZipCode 等成员（隐式实现）是非常有意义的。

# iphone - 用于 XSLT 的 iPhone 上 NSXMLDocument 的替代方案

> ID：712658
> 
> 赞同：1
> 
> 时间：2009-04-03T05:34:55.857
> 
> 标签：iphone, objective-c, xml, xslt

我知道之前有人问过（[就像这里](https://stackoverflow.com/questions/462440/version-of-xslt-in-iphone)），但是有没有办法在 iPhone 上本地使用 XSLT？如果没有，我需要使用[libxslt](http://xmlsoft.org/XSLT/)，是否有任何关于如何在 iPhone 上使用它的文档/教程？

**编辑：** 我决定使用[libxslt](http://xmlsoft.org/XSLT/)。需要包含哪些文件？我还没有找到任何在 iPhone 上使用示例的教程，我不确定如何处理它。任何帮助，将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-01-26T14:59:15.913

无法在 iPhone 上使用 libXSLT。不是今天。应用程序将被拒绝。libXSLT 内置在 iOS 中，可以调用 - 但这是 iPhone 的私有 API，会导致拒绝。如果您自己编译 libxslt 库并将其静态链接到您的应用程序，您仍然会被拒绝。许多人在应用程序审核过程中报告了此错误，但尚未发生任何变化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T13:13:43.960

这取决于您想如何使用 XSLT；不知道您所说的“本机”是什么意思。如果您只是嵌入浏览器，MobileSafari 将为您解释 XSLT。

如果您只是将一个 XML 文档转换为另一个进行处理，那么 libxslt 是一个不错的选择。在任何其他平台的 iPhone 上使用 libxslt 没有区别。鉴于 Apple 不包含它的标题，他们可能不希望您使用捆绑的副本。您最好根据提供的 libxml2 库将副本编译到您的应用程序中。

如果您想要更具体的答案，您可能希望提出更具体的问题。:-)

# windows - 用于信息提供的 COM 与 WMI

> ID：712663
> 
> 赞同：3
> 
> 时间：2009-04-03T05:36:39.860
> 
> 标签：windows, com, hardware, wmi, hardware-interface

如果我想向用户提供有关我的**硬件设备的一些信息，有什么更好的方法。**

我应该开发一个专有的 COM 库还是应该开发一个 WMI 提供程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T05:41:33.157

我认为这很简单：WMI 是 Microsoft 提供性能和硬件信息的一种方式。

这应该是您提供所描述信息的方式。Win32_Computer 和其他硬件类有很多先例，它们提供 CPU 详细信息、内存大小等（这些内容不会随着软件的运行而改变）。

我这么说是因为您专门标记了“硬件设备”。不要认为 WMI 仅用于报告软件类型的内容，例如内存使用情况或进程列表。

已经有大量软件专门用于查询 WMI（包括我的一个），因此不乏知道如何操作的人。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-04T14:21:03.103

WMI 非常好。使用这个工具玩一下[WMI Code Creator](http://www.microsoft.com/downloads/details.aspx?familyid=2cc30a64-ea15-4661-8da4-55bbc145c30e&displaylang=en)，有利于学习 WMI。

# php - PHP 和 htpasswd

> ID：712665
> 
> 赞同：0
> 
> 时间：2009-04-03T05:36:58.817
> 
> 标签：php, .htaccess, .htpasswd

我有这样的结构：

```
/home
/home/dir1
/home/dir2 
```

现在当有人去 /home 时，他被要求输入用户名和密码（在一个表单中），我在 PHP 中为 /home 的剩余文件设置会话信息。现在 /home/dir1 和 /home/dir2 受 htpasswd 保护，但用户名和密码相同。我不希望用户在转到 /home/dir1 时再次重新输入他们的用户名和密码......此外，当我从 /home 注销时，我也想从 /home/dir1 注销。您能否就如何实现这一目标提出建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T05:54:09.740

这应该是默认行为。

也就是说，如果您使用 Apache 和 .htaccess 文件来设置 HTTP 身份验证，则您应用于目录的任何规则也将应用于其子目录，并且浏览器会将其视为一次登录。

如果您希望它以不同的方式运行，即如果您希望站点的某些部分被视为需要完全独立的登录，您可以使用 .htaccess 中的 AuthName 指令为每个部分指定一个“领域”。 [更多信息在这里](http://httpd.apache.org/docs/2.0/mod/core.html#authname)。但是，如果您不这样做，它将始终被视为同一登录的所有部分。

关于 HTTP 身份验证的事情是没有办法“注销”，至少除非浏览器提供该功能，否则不会。大多数浏览器允许您注销的唯一方法是结束浏览器会话（即关闭浏览器）。是的，一旦您这样做了，您将退出 /home、/home/dir1、/home/dir2 以及所有站点/领域上的所有目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T15:59:47.713

在 Apache 中，只要两个文件夹具有相同的*AuthName*并且位于同一个站点上，它们就应该共享一个密码。

这两个目录可能都有一个 .htaccess 文件，如下所示：

```
AuthName "My Protect Folder"
AuthType basic
AuthUserFile /somewhere/htusers
require valid-user 
```

# windows - Windows中的中断处理

> ID：712678
> 
> 赞同：8
> 
> 时间：2009-04-03T05:43:43.387
> 
> 标签：windows, interrupt

我想知道哪些线程处理设备中断。当用户模式线程运行时出现中断时会发生什么？当系统处理中断时，其他用户线程是否也有机会运行？

请向我推荐一些描述窗口如何处理中断的参考资料。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T06:55:02.450

设备中断本身（通常）由任何具有 CPU 接受中断的线程处理，但在环 0 中并处于不同的保护级别。这限制了中断处理程序可以采取的一些操作，因为大多数时候当前线程与等待中断指示的事件发生的线程无关。

内核本身是封闭源代码，仅通过其内部 API 记录。该 API 向设备驱动程序作者公开，并在驱动程序开发工具包中进行了描述。

一些帮助您入门的资源：

*   Solomon 和 Russinovich的任何版本的[**Microsoft Windows Internals**](https://rads.stackoverflow.com/amzn/click/com/0735619174)。当前似乎是第 4 版，但即使是旧版也会有所帮助。

*   Windows DDK，现在更名为[WDK](http://www.microsoft.com/whdc/devtools/wdk/default.mspx)。它的文档也[可以在线获得](http://msdn.microsoft.com/en-us/library/aa972908.aspx)。请务必阅读[内核模式设计指南](http://msdn.microsoft.com/en-us/library/ms796245.aspx)...

*   [Sysinternals](http://technet.microsoft.com/en-us/sysinternals/default.aspx)有工具和文章来探究和解释内核的行为。这曾经是一个独立的站点，直到微软厌倦了 Mark Russinovich 似乎比他们更了解内核的工作原理。;-)

请注意，许多常见设备驱动程序的源代码都包含在示例中的 DDK 中。尽管生产版本几乎可以肯定不同，但即使您不想自己实现驱动程序，阅读示例驱动程序也可以回答一些问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T06:11:16.220

像任何其他操作系统一样，Windows 在内核模式下处理中断，具有更高的中断优先级（我认为他们称它们为 IRPL，但我不知道“R”代表什么）。任何运行在同一台机器上的用户线程或更低级别的Kernel线程都会在处理中断请求时被中断，并在ineterrupt处理完成后恢复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T06:34:01.750

为了更多地了解 Windows 上的设备中断，您需要学习设备驱动程序开发。这是一个小众话题，我认为您在网络上找不到很多有用的资源，您可能需要寻找书籍或培训课程。

无论如何，Windows 使用中断请求级别 (IRQL) 和[延迟过程调用](http://en.wikipedia.org/wiki/Deferred_Procedure_Call)来处理中断。中断在内核模式下处理，它以比用户模式更高的优先级运行。适当的中断处理程序需要非常快速地做出反应。它只执行绝对必要的操作并注册一个延迟过程调用以在将来运行。这将在系统处于中断请求级别时发生。

# java - 将 Midi 音符编号转换为名称和八度音阶

> ID：712679
> 
> 赞同：19
> 
> 时间：2009-04-03T05:44:00.000
> 
> 标签：java, audio, midi, javasound

有谁知道 Java 世界中存在将 midi 音符编号映射到特定音符名称和八度音阶编号的任何东西。例如，参见参考表：

[http://www.harmony-central.com/MIDI/Doc/table2.html](http://www.harmony-central.com/MIDI/Doc/table2.html)

我想将 60 号 midi 音符映射到 octave 4 中相应的音符名称 (MiddleC)。我可以为此编写一个实用程序类/枚举，但这会相当乏味。有人知道吗？

我专门用它来用 Java 编写 Tenori-On/Monome 克隆，到目前为止一切都很好......

**解决方案**

这就是我最终使用的：

```
String[] noteString = new String[] { "C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B" };

int octave = (initialNote / 12) - 1;
int noteIndex = (initialNote % 12);
String note = noteString[noteIndex]; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-03T05:48:04.967

我不相信你的建议是*那么*乏味。它实际上只是一个除模运算，一个得到八度，另一个得到音符。

```
octave = int (notenum / 12) - 1;
note = substring("C C#D D#E F F#G G#A A#B ",(notenum % 12) * 2, 2); 
```

在真正的 Java 中，与上面的伪代码相反，您可以使用如下内容：

```
public class Notes {
  public static void main(String [] args) {
    String notes = "C C#D D#E F F#G G#A A#B ";
    int octv;
    String nt;
    for (int noteNum = 0; noteNum < 128; noteNum++) {
      octv = noteNum / 12 - 1;
      nt = notes.substring((noteNum % 12) * 2, (noteNum % 12) * 2 + 2);
      System.out.println("Note # " + noteNum + " = octave " + octv + ", note " + nt);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-05T18:59:55.180

在[JFugue](http://www.JFugue.org)中，`Note`该类有一个实用方法可以做到这一点 - 请参阅`public static String getStringForNote(byte noteValue)`。

**编辑：**从 JFugue 5.0 及更高版本开始，`Note`该类有几个实用方法用于从 MIDI 音符值获取字符串表示：

*   `getToneString(byte noteValue)`将 的值转换为 `60`字符串`C5`
*   `getToneStringWithoutOctave(byte noteValue)`将 的值转换为`60`字符串`C`
*   `getPercussionString(byte noteValue)`将 的值转换为`60`字符串`"[AGOGO]"`

这些替换了原始`getStringForNote()`方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-02-06T03:34:56.570

```
public static String getNoteName(int noteNumber){
    noteNumber -= 21; // see the explanation below.
    String[] notes = new String[] {"A", "A#", "B", "C", "C#", "D", "D#", "E", "F", "F#", "G", "G#"};
    int octave = noteNumber / 12 + 1;
    String name = notes[noteNumber % 12];
    return name + octave;
} 
```

**解释：**

*   midi中的A0是第一个音符，编号为21。我们将索引调整为从0开始（因此`noteNumber -= 21;`在开头）。如果您的音符编号是从 0 开始的，例如在钢琴中从 0 到 88，那么您可以注释掉这一行。

*   请注意，在此解决方案中，数组中的音符名称从 A 到 G 开始。

*   八度是`noteNumber / 12 + 1`（或 num / 12 的上限）。

*   注释名称索引为`noteNumber % 12`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-10-18T01:17:46.187

这是没有太多命名常量的最短形式。也不需要任何循环。

```
public static String getNoteFromMidiNumber(int midiNote){
    String[] note_names = {"C","C#","D","D#","E","F","F#","G","G#","A","A#","B"};
    return note_names[midiNote % 12] + ((midiNote / 12) - 1);
 } 
```

# memory-management - 什么是惰性分配？

> ID：712683
> 
> 赞同：22
> 
> 时间：2009-04-03T05:45:35.987
> 
> 标签：memory-management

对象的延迟分配是什么意思，它有什么用处？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-03T06:16:56.270

延迟分配只是意味着在实际需要之前不分配资源。这在单例对象中很常见，但严格来说，只要尽可能晚地分配资源，您就有一个延迟分配的示例。

通过延迟分配资源直到您真正需要它，您可以减少启动时间，甚至在您从不实际使用该对象的情况下完全消除分配。相反，您可以预先分配您期望稍后需要的资源，这可以使以后的执行更加高效，但会花费启动时间，并且还可以避免在程序执行后期分配失败的可能性。

以下代码提供了一个延迟分配单例的示例：

```
public class Widget {
    private Widget singleton;

    public static Widget get() {
        if (singleton == null) {
            singleton = new Widget();
        }
        return singleton;
    }

    private Widget() {
        // ...
    }

    // ...
} 
```

请注意，此代码不是线程安全的。在大多数情况下，对`get()`方法的访问应该以某种方式同步。

一个类似的（也许更一般的）概念是[延迟初始化](http://en.wikipedia.org/wiki/Lazy_initialization)。

# serial-port - 自动检测串口的配置？

> ID：712687
> 
> 赞同：3
> 
> 时间：2009-04-03T05:48:06.887
> 
> 标签：serial-port, zeroconf

我正在围绕现有硬件产品设计软件。我完全控制了通信协议，但我不确定如何促进设备检测。

设备可能有一系列可能的配置（即波特率、数据位、奇偶校验位、停止位），必须在运行时检测。让软件找出它正在使用的配置的最简单、最可靠的方法是什么？同样，我完全控制了通信协议，因此我可以定义任何我希望的机制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T07:18:01.177

这是全双工还是半双工设备？您可以在串行线的两端控制请求发送和监控清除发送吗？串行线路是点对点（如 RS-232）还是多点（如 RS-485）？如果您在与新连接的设备协商时要干扰其他已连接的设备，这将产生（尽管很小）差异。

如果您将握手过程想象成调制解调器协商链路层协议，它使用一组标准消息来描述它想要进行的通信类型并等待来自另一端的“确认”。在您的情况下，我建议您的头端使用比特率范围生成“让我们谈谈”标准消息，并等待来自设备的确认。

我还建议减少设备的配置选项数量。忘记可变数据位、奇偶校验位和停止位。串行通信世界不再像 70 年代那样不稳定。只需使用 8 个数据位、无奇偶校验、一个停止位并改变比特率。消息末尾的 CRC 提供了大量的错误检查。

# css - CSS Div 拉伸 100% 页面高度

> ID：712689
> 
> 赞同：211
> 
> 时间：2009-04-03T05:50:07.737
> 
> 标签：css, height, max, stretch

我的页面左侧有一个导航栏，我希望它可以拉伸到页面高度的 100%。不仅是视口的高度，还包括在您滚动之前隐藏的区域。我不想使用 javascript 来实现这一点。

可以用 HTML/CSS 完成吗？

* * *

## 回答 #1

> 赞同：187
> 
> 时间：2012-05-17T16:12:33.747

这是我在使用 div 作为动态背景的容器时最终想到的解决方案。

*   删除`z-index`非背景用途。
*   删除`left`或`right`用于全高列。
*   删除`top`或`bottom`为全宽行。

**编辑 1：**下面的 CSS 已被编辑，因为它在 FF 和 Chrome 中没有正确显示。移动`position:relative`到 HTML 上并将正文设置为`height:100%`而不是`min-height:100%`.

**编辑 2：**向 CSS 添加了额外的注释。在上面添加了更多说明。

CSS：

```
html{
    min-height:100%;/* make sure it is at least as tall as the viewport */
    position:relative;
}
body{
    height:100%; /* force the BODY element to match the height of the HTML element */
}
#cloud-container{
    position:absolute;
    top:0;
    bottom:0;
    left:0;
    right:0;
    overflow:hidden;
    z-index:-1; /* Remove this line if it's not going to be a background! */
} 
```

的HTML：

```
<!doctype html>
<html>
<body>
    <div id="cloud-container"></div>
</body>
</html> 
```

为什么？

```
html{min-height:100%;position:relative;} 
```

如果没有这个，云容器 DIV 将从 HTML 的布局上下文中删除。`position: relative`确保绘制时 DIV 保留在 HTML 框内，以便`bottom:0`引用 HTML 框的底部。您也可以`height:100%`在云容器上使用，因为它现在指的是 HTML 标记的高度，而不是视口。

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2014-11-12T20:27:58.127

使用 HTML5，最简单的方法就是简单地执行`height: 100vh`. 其中“vh”代表浏览器窗口的视口高度。响应调整浏览器和移动设备的大小。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-06-14T18:08:10.903

我有一个类似的问题，解决方案是这样做：

```
#cloud-container{
    position:absolute;
    top:0;
    bottom:0;
} 
```

我想要一个以页面为中心的 div，高度为页面高度的 100%，所以我的总体解决方案是：

```
#cloud-container{
    position:absolute;
    top:0;
    bottom:0;
    left:0;
    right:0; 
    width: XXXpx; /*otherwise div defaults to page width*/
    margin: 0 auto; /*horizontally centers div*/
} 
```

您可能需要使父元素（或简称为“body”）具有`position: relative;`

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-04-03T06:06:23.113

[您可以使用Faux Columns](http://www.alistapart.com/articles/fauxcolumns/)作弊， 或者您可以使用一些[CSS 技巧](http://www.ejeliot.com/samples/equal-height-columns/example-7.html)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-06-06T21:10:36.330

使用绝对位置。请注意，这不是我们通常习惯于使用绝对位置的方式，它需要手动布局或使用浮动对话框。当您调整窗口或内容的大小时，这将自动拉伸。我相信这需要标准模式，但可以在 IE6 及更高版本中使用。

只需将 id 为 'thecontent' 的 div 替换为您的内容（此处指定的高度仅用于说明，您不必在实际内容上指定高度。

```
<div style="position: relative; width: 100%;">
      <div style="position: absolute; left: 0px; right: 33%; bottom: 0px; top: 0px; background-color: blue; width: 33%;" id="navbar">nav bar</div>
      <div style="position: relative; left: 33%; width: 66%; background-color: yellow;" id="content">
         <div style="height: 10000px;" id="thecontent"></div>
      </div>
</div> 
```

其工作方式是外部 div 充当导航栏的参考点。外部 div 被 'content' div 的内容拉长。导航栏使用绝对定位将自身伸展到其父级的高度。对于水平对齐，我们使内容 div 自身偏移导航栏的相同宽度。

使用 CSS3 flex box 模型，这变得更容易了，但这在 IE 中尚不可用，并且有一些它自己的怪癖。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-04-03T08:40:27.907

使用表格很简单：

```
<html>

<head>
    <title>100% Height test</title>
</head>

<body>
    <table style="float: left; height: 100%; width: 200px; border: 1px solid red">
        <tbody>
            <tr>
                <td>Nav area</td>
            </tr>
        </tbody>
    </table>
    <div style="border: 1px solid green;">Content blabla... text
        <br /> text
        <br /> text
        <br /> text
        <br />
    </div>
</body>

</html> 
```

当 DIV 被引入时，人们非常害怕桌子，以至于可怜的 DIV 成为了比喻性的锤子。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-04-18T05:29:17.290

我遇到了和你一样的问题。我想做一个`DIV`背景，为什么，因为它很容易通过javascript操作div。无论如何，我在 css 中为那个 div 做了三件事。

**CSS：**

```
{    
position:absolute; 
display:block; 
height:100%; 
width:100%; 
top:0px; 
left:0px; 
z-index:-1;    
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-10-20T02:51:28.377

我想在提示模态弹出窗口之前覆盖整个网页。我尝试了许多使用 CSS 和 Javascript 的方法，但在我找到以下解决方案之前，它们都没有帮助。它对我有用，我希望它对你也有帮助。

```
<!DOCTYPE html>
<html>
	<head>
		<style>
			html, body {
			    margin: 0px 0px;
			    height 100%;
			}

            div.full-page {
                position: fixed;
                top: 0;
                bottom: 0;
                width: 100%;
                height: 100%;
                background-color: #000;
                opacity:0.8;
                overflow-y: hidden;
                overflow-x: hidden;
            }

            div.full-page div.avoid-content-highlight {
                position: relative;
                width: 100%;
                height: 100%;
            }

            div.modal-popup {
                position: fixed;
                top: 20%;
                bottom: 20%;
                left: 30%;
                right: 30%;
                background-color: #FFF;
                border: 1px solid #000;
            }
		</style>
		<script>

			// Polling for the sake of my intern tests
			var interval = setInterval(function() {
				if(document.readyState === 'complete') {
					clearInterval(interval);
					isReady();
				}    
			}, 1000);

			function isReady() {
				document.getElementById('btn1').disabled = false;
				document.getElementById('btn2').disabled = false;

				// disable scrolling
                document.getElementsByTagName('body')[0].style.overflow = 'hidden';
			}

			function promptModalPopup() {
                document.getElementById("div1").style.visibility = 'visible';
                document.getElementById("div2").style.visibility = 'visible';

				// disable scrolling
                document.getElementsByTagName('body')[0].style.overflow = 'hidden';
            }

            function closeModalPopup() {
                document.getElementById("div2").style.visibility = 'hidden';  
                document.getElementById("div1").style.visibility = 'hidden';

				// enable scrolling
                document.getElementsByTagName('body')[0].style.overflow = 'scroll';
            }
		</script>

	</head>
	<body id="body">
		<div id="div1" class="full-page">
			<div class="avoid-content-highlight">

            </div>
		</div>
        <button id="btn1" onclick="promptModalPopup()" disabled>Prompt Modal Popup</button>
		<div id="demo">
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
			<h2>Original content</h2>
		</div>
        <div id="div2" class="modal-popup">
            I am on top of all other containers
            <button id="btn2" onclick="closeModalPopup()" disabled>Close</button>
        <div>
	</body>
</html>
```

祝你好运 ;-）

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2017-02-06T23:50:59.720

如果您的目标是更现代的浏览器，生活可能会非常简单。尝试：

```
.elem{    
    height: 100vh;
 } 
```

如果您在页面的 50% 处需要它，请将 100 替换为 50。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-04-26T11:34:56.807

```
* {
margin: 0;
}
html, body {
height: 90%;
}
.content {
min-height: 100%;
height: auto !important;
height: 100%;
margin: 0 auto ;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-10-06T08:31:40.007

```
 document.body.onload = function () {
                var textcontrol = document.getElementById("page");
                textcontrol.style.height = (window.innerHeight) + 'px';
            }
```

```
<html>
<head><title></title></head>
<body>

<div id="page" style="background:green;">
</div>
</body>
</html>
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-12-11T16:40:18.430

很简单，只需将其包装在一个表格 div 中...

**的HTML：**

```
<div class="fake-table">
   <div class="left-side">
     some text
   </div>
   <div class="right-side">
     My Navigation or something
   </div>
</div> 
```

**CSS：**

```
<style>

 .fake-table{display:table;width:100%;height:100%;}
 .left-size{width:30%;height:100%;}
 .left-size{width:70%;height:100%;}

</style> 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2021-04-05T10:09:12.110

我成功了

```
min-height: 100vh 
```

对于菜单和内容 div。

# c++ - 注册 COM 接口的实现

> ID：712691
> 
> 赞同：3
> 
> 时间：2009-04-03T05:51:21.010
> 
> 标签：c++, windows, com

我是 COM 编程的新手。我已经准备好一个 COM 对象（和关联的 IClassFactory），但我不知道如何注册生成的 DLL 以供其他程序使用。我还不清楚我需要使用的 GUID 数量。

我尝试注册的 COM 对象实现了 IAudioSessionEvents 接口。

我遇到过 DllRegisterServer 和 DllUnregisterServer 函数，但我没有找到任何关于它们用法的清晰演示。它们处理什么键，它们是如何调用的，由什么和何时调用等？

谢谢，
-凯文·蒙特罗斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T05:55:50.063

您需要为向 COM 公开的每个类提供一个 GUID，为您引入并希望通过 COM 提供的每个新接口都需要一个 GUID。

当您使用 regsvr32 实用程序（Windows 附带）注册您的 COM 公开类时，将调用 DllRegisterServer/DllUnregister 服务器。它为您公开给 COM 的每个类添加/删除 HKCR/CLSID 分支的键。CoCreateInstance() 使用这些键来找出要加载哪个 DLL 以创建具有给定 GUID 的类的实例。

如果您使用 ATL 或类似的东西，通常不需要完全实现 DllRegisterServer/DllUnRegisterServer，而是使用库提供的实现。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T06:08:11.360

从这篇文章中我不确定您是否正在实现或使用支持 IAudioSessionEvents 的 DLL。如果您正在使用此 DLL，则可以使用注释行实用程序 regsvr32 注册该组件。注册使用：

regsvr32

取消注册：

regsvr32 /u

regsvr32 应该在你的路径上，所以这个命令可以在任何目录下工作。

如果您正在实现有问题的 DLL，那么您必须提供 DllRegisterServer 和 DllUnRegisterServer 函数的实现。这些函数必须为您的组件设置和清理注册表项。注册表项的目的是提供 ProgID，将其映射到 CLSID，并为组件支持的接口提供接口 ID。例如，IAudioSessionEvent 的接口 ID。如果要实现 DLL，则必须提供代码来执行所有这些任务。

注意：这些函数由 regsvr32 调用以注册组件。

如果实际编写此代码非常不寻常，通常您会希望使用像 ATL 这样的框架，它会为您处理繁琐的工作。如果您真的想从头开始了解 COM，那么至少编写一次此代码是一个很好的练习。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T06:00:18.527

实现自我注册的最简单方法通常是使用 ATL 服务器类，拥有一个从 CComModule（或其他类似类）派生的全局变量，并在您的模块中定义一个 COM_MAP。然后，您要求 com 模块根据您添加到项目中的 .rgs 文件来处理注册。

# c# - FileUpload 在更新面板中不起作用

> ID：712695
> 
> 赞同：17
> 
> 时间：2009-04-03T05:55:20.300
> 
> 标签：c#, asp.net

所以我想做的是，让用户选择要上传的文件。由于我只接受图像，我将测试扩展。我还想将文件大小限制在 2mb 以下，因此我将对其进行测试（尚未在代码中实现）。如果他们选择的文件通过，那么我希望标签显示“文件已接受”，并存储文件上传信息以供稍后单击按钮。一旦用户填写完表格的其余部分，就会发生这种情况。最后，我将在页面上放置一个 UpdateProgress 控件，同时检查文件是否被允许。我宁愿不把它发回，所以如果我能让它工作，那就太好了。顺便说一句，如果我将标签从更新面板中取出，这一切都会正常工作。

当我运行它时会发生什么，它会转到第一个 if 的 else 语句并返回“请选择一个文件”。这意味着 FileUpload1.HasFile 返回 false。我可以看到发生这种情况的唯一原因是因为 UpdatePanel 无法从 FileUpload 控件访问该信息？

代码背后：

```
 Label SubmitButtonLabel2= (Label)UpdatePanel1.FindControl("SubmitButtonLabel");
    if (FileUpload1.HasFile)
    {
        string[] fileName = FileUpload1.FileName.Split('.');
        if ((fileName[fileName.Length - 1] == "jpg") ||
            (fileName[fileName.Length - 1] == "gif") ||
            (fileName[fileName.Length - 1] == "bmp") ||
            (fileName[fileName.Length - 1] == "jpeg") ||
            (fileName[fileName.Length - 1] == "png"))
        {
            SubmitButtonLabel2.Text = "File Accepted.";
        }
        else
        {
            SubmitButtonLabel2.Text = "File type not allowed.  Please choose another.";
        }
    }
    else
    {
        SubmitButtonLabel.Text = "Please select a file.";
    } 
```

页：

```
<body>
<form id="form1" runat="server">
<asp:ScriptManager ID="ScriptManager1" runat="server" />
    <div>
        <asp:FileUpload ID="FileUpload1" runat="server" />
        <asp:Button ID="SubmitButton" runat="server" Text="Submit File" OnClick=SubmitButton_Click />
        <asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="always">
            <ContentTemplate>
                <asp:Label ID="SubmitButtonLabel" runat="Server" />
            </ContentTemplate>
            <Triggers>
                <asp:PostBackTrigger ControlID="SubmitButton" />
            </Triggers>
        </asp:UpdatePanel>

    </div>
</form>
</body> 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-11-06T07:08:06.957

无需做任何事情，您只需向表单添加多部分数据属性。

```
Page.Form.Attributes.Add("enctype", "multipart/form-data"); 

```

有关详细信息，请参阅以下链接。

[http://knowledgebaseworld.blogspot.com/2009/02/file-upload-not-working-with-update.html](http://knowledgebaseworld.blogspot.com/2009/02/file-upload-not-working-with-update.html)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-12T09:03:02.173

```
<Triggers>
  <asp:PostBackTrigger ControlID="YourControlID" />
</Triggers> 
```

添加触发器`UpdatePanel`并给出`ControlID`. 如果您使用`TabContainer`，请使用选项卡容器的 ID。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-12-23T18:51:06.220

将此行添加到您的`page_load`

```
ScriptManager.GetCurrent(this).RegisterPostBackControl(this.Button); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-07-17T06:34:43.513

如果您在更新面板中使用 FileUpload 控件，则必须为您编写代码以保存上传文件的按钮设置 PostbackTrigger。

现在下面的代码我有 btnSave 按钮，用于将文件保存在上传文件夹中。所以我为它设置了回发触发器。

```
<Triggers>
            <asp:PostBackTrigger ControlID="btnSave" />
</Triggers> 
```

希望这会帮助你。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-11-06T08:35:53.250

默认的 asp.net FileUpload 控件永远不会与 UpdatePanel 一起使用。您需要AjaxControl Toolkit 中定义的特殊**[AsyncFileUpload控件。](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/AsyncFileUpload/AsyncFileUpload.aspx)**这个

**[http://www.asp.net/ajax/ajaxcontroltoolkit/samples/AsyncFileUpload/AsyncFileUpload.aspx](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/AsyncFileUpload/AsyncFileUpload.aspx)**

[替代文字 http://ruchitsurati.net/files/fileupload.png](http://ruchitsurati.net/files/fileupload.png)

```
 <ajaxToolkit:AsyncFileUpload OnClientUploadError="uploadError"
     OnClientUploadComplete="uploadComplete" runat="server"
     ID="AsyncFileUpload1" Width="400px" UploaderStyle="Modern"
     UploadingBackColor="#CCFFFF" ThrobberID="myThrobber" /> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-04-29T06:31:32.497

制作按钮上传文件作为上传面板的触发器像这样，

```
 <asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
<ContentTemplate>
<asp:Panel ID="pnlUploadImage" runat="server">
 <asp:FileUpload ID="fuldImage" runat="server"></asp:FileUpload>

       <asp:LinkButton ID="lnkbUpload" runat="server" onclick="lnkbUpload_Click">Add</asp:LinkButton>
</asp:Panel>

</ContentTemplate>
<Triggers>
<asp:PostBackTrigger   ControlID="lnkbUpload"/></Triggers>
</asp:UpdatePanel> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-03T06:47:38.943

不要忘记更改表单的类型，以允许文件上传（enctype 或类似的东西，我不在 Visual Studio 前面，所以不能那么精确。）

我有同样的问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-05-03T16:06:34.070

使用此处发布的两个解决方案后，我得到了它的工作。

我不得不同时添加

```
Page.Form.Attributes.Add("enctype", "multipart/form-data"); 
```

在 Page_Load 以及

```
<Triggers>
    <asp:PostBackTrigger ControlID="btnUpload" />
</Triggers> 
```

在更新面板的标记上。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-05-24T11:03:28.003

`Page.Form.Attributes.Add("enctype", "multipart/form-data");`

这样做将解决您的问题。

参考[这篇文章](http://knowledgebaseworld.blogspot.com/2009/02/file-upload-not-working-with-update.html)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-03T20:05:08.290

[你的答案可以在这里找到](http://geekswithblogs.net/ranganh/archive/2008/04/01/file-upload-in-updatepanel-asp.net-ajax.aspx)

由于 javascript 和浏览器安全原因，默认情况下基本上是不允许的。但这是一种解决方法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-03T06:08:54.667

我的猜测是 HasFile 只会在帖子完成后才会被填充，而不是在那之前。

您可能想在帖子完成之前检查 FileUpload1.FileName 是否已经填满，但我有点怀疑。

# performance - 是否有适合脚本的快速启动 Haskell 解释器？

> ID：712696
> 
> 赞同：18
> 
> 时间：2009-04-03T05:55:25.510
> 
> 标签：performance, scripting, haskell, interpreter

有谁知道适合用于编写 shell 脚本的快速启动的 Haskell 解释器？在我的旧笔记本电脑上使用 Hugs 运行“hello world”需要 400 毫秒，而在我当前的 Thinkpad X300 上需要 300 毫秒。这对于瞬时响应来说太慢了。使用 GHCi 的时间类似。

函数式语言不必很慢：Objective Caml 和 Moscow ML 都在 1 毫秒或更短的时间内运行 hello world。

**澄清**：我是 GHC 的重度用户，我知道如何使用 GHCi。我知道所有关于编译以快速完成任务的知识。解析成本应该完全不相关：如果 ML 和 OCaml 的启动速度可以比 GHCi 快 300 倍，那么还有改进的空间。

我在寻找

*   脚本编写的便利性：一个源文件，没有二进制代码，相同的代码在所有平台上运行
*   与其他解释器相当的性能，包括快速启动和执行简单程序，如

    ```
    module Main where
    main = print 33 
    ```

我*不是*在为更严肃的程序寻找编译性能。重点是看看 Haskell 是否对脚本有用。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2010-07-24T18:00:35.030

为什么不创建一个脚本前端来编译脚本，如果它以前没有或者编译的版本已经过时了。

这是基本的想法，这段代码可以改进很多——搜索路径而不是假设所有内容都在同一个目录中，更好地处理其他文件扩展名，等等。而且我在 haskell 编码（ghc-compiled-script。 hs):

```
import Control.Monad
import System
import System.Directory
import System.IO
import System.Posix.Files
import System.Posix.Process
import System.Process

getMTime f = getFileStatus f >>= return . modificationTime

main = do
  scr : args <- getArgs
  let cscr = takeWhile (/= '.') scr

  scrExists <- doesFileExist scr
  cscrExists <- doesFileExist cscr
  compile <- if scrExists && cscrExists
               then do
                 scrMTime <- getMTime scr
                 cscrMTime <- getMTime cscr
                 return $ cscrMTime <= scrMTime
               else
                   return True

  when compile $ do
         r <- system $ "ghc --make " ++ scr
         case r of
           ExitFailure i -> do
                   hPutStrLn stderr $
                            "'ghc --make " ++ scr ++ "' failed: " ++ show i
                   exitFailure
           ExitSuccess -> return ()

  executeFile cscr False args Nothing 
```

现在我们可以创建这样的脚本（hs-echo.hs）：

```
#! ghc-compiled-script

import Data.List
import System
import System.Environment

main = do
  args <- getArgs
  putStrLn $ foldl (++) "" $ intersperse " " args 
```

现在运行它：

```
$ time hs-echo.hs "Hello, world\!"     
[1 of 1] Compiling Main             ( hs-echo.hs, hs-echo.o )
Linking hs-echo ...
Hello, world!
hs-echo.hs "Hello, world!"  0.83s user 0.21s system 97% cpu 1.062 total

$ time hs-echo.hs "Hello, world, again\!"
Hello, world, again!
hs-echo.hs "Hello, world, again!"  0.01s user 0.00s system 60% cpu 0.022 total 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-03T17:32:59.327

using`ghc -e`几乎等同于调用`ghci`. 我相信 GHC`runhaskell`在运行之前会将代码编译为临时可执行文件，而不是像`ghc -e`/那样解释它`ghci`，但我不是 100% 确定。

```
$ time echo 'Hello, world!'
Hello, world!

real    0m0.021s
user    0m0.000s
sys     0m0.000s
$ time ghc -e 'putStrLn "Hello, world!"'
Hello, world!

real    0m0.401s
user    0m0.031s
sys     0m0.015s
$ echo 'main = putStrLn "Hello, world!"' > hw.hs
$ time runhaskell hw.hs
Hello, world!

real    0m0.335s
user    0m0.015s
sys     0m0.015s
$ time ghc --make hw
[1 of 1] Compiling Main             ( hw.hs, hw.o )
Linking hw ...

real    0m0.855s
user    0m0.015s
sys     0m0.015s
$ time ./hw
Hello, world!

real    0m0.037s
user    0m0.015s
sys     0m0.000s 
```

在运行它们之前简单地编译所有“脚本”有多难？

### 编辑

啊，为多种架构提供二进制文件确实很痛苦。我以前也走过那条路，但不是很有趣……

可悲的是，我认为不可能使任何 Haskell 编译器的启动开销更好。该语言的声明性意味着有必要在尝试对任何内容进行类型检查之前先阅读整个程序，更不用说执行了，然后您要么遭受严格分析的代价，要么遭受不必要的懒惰和重击。

流行的“脚本”语言（shell、Perl、Python 等）和基于 ML 的语言只需要一次通过......好吧，ML 需要一个静态类型检查通过，而 Perl 有这个有趣的 5-pass 方案（带有其中两个反向运行）；无论哪种方式，程序化意味着编译器/解释器可以更轻松地将程序的各个部分组装在一起。

简而言之，我认为不可能比这更好。我还没有测试过 Hugs 或 GHCi 是否具有更快的启动速度，但与非 Haskell 语言之间的差异仍然很大。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-03T06:49:14.680

如果您真的关心速度，您将受到每次启动时重新解析代码的阻碍。Haskell 不需要从解释器中运行，使用[GHC](http://www.haskell.org/ghc/)编译它，你应该会获得出色的性能。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-03T16:24:11.410

这个问题有两个部分：

*   你关心性能
*   你想要脚本

如果您关心性能，唯一严肃的选择是 GHC，它非常非常快：[http ://shootout.alioth.debian.org/u64q/benchmark.php?test=all&lang=all](http://shootout.alioth.debian.org/u64q/benchmark.php?test=all&lang=all)

如果你想为 Unix 脚本编写一些简单的东西，我会使用 GHCi。它比 Hugs 快大约 30 倍，而且还支持所有关于 hackage 的库。

所以现在安装 GHC（并免费获得 GHCi）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-11-20T07:02:38.453

拥有一个 ghci 守护进程和一个获取脚本路径和位置的馈送脚本怎么样？与已经运行的 ghci 进程通信以在正确的目录中加载和执行脚本并将输出通过管道传回馈送脚本以用于标准输出？

不幸的是，我不知道如何写这样的东西，但从 :l 在 ghci 中的速度来看，它似乎真的很快。看起来 runhaskell 的大部分成本都在启动 ghci，而不是解析和运行脚本。

**编辑：**经过一番尝试，我发现[Hint 包](http://hackage.haskell.org/package/hint)（GHC API 的包装器）在这里非常有用。下面的代码将加载传入的模块名称（这里假设在同一目录中）并执行 main 函数。现在剩下的就是让它成为一个守护进程，并让它接受管道或套接字上的脚本。

```
import Language.Haskell.Interpreter
import Control.Monad

run = runInterpreter . test

test :: String -> Interpreter ()
test mname = 
  do
    loadModules [mname ++ ".hs"]
    setTopLevelModules [mname]
    res <- interpret "main" (as :: IO())
    liftIO res 
```

**编辑2：**就stdout/err/in而言，使用[这个特定的GHC技巧](http://nominolo.blogspot.com/2010/04/haskell-tip-redirect-stdout-in-haskell.html)看起来可以将客户端程序的std重定向到feeder程序，然后到守护程序连接的一些命名管道（也许）一直到，然后将守护程序的标准输出返回到馈线程序正在侦听的另一个命名管道。伪示例：

```
grep ... | feeder my_script.hs | xargs ...
            |   ^---------------- <
            V                      |
         named pipe -> daemon -> named pipe 
```

在这里，馈线将是一个小型编译的线束程序，只需将标准重定向到守护程序然后返回守护程序，并将脚本的名称和位置提供给守护程序。

# php - JQuery 对复选框及其值的帮助

> ID：712701
> 
> 赞同：0
> 
> 时间：2009-04-03T06:00:35.513
> 
> 标签：php, javascript, jquery

我对 javascript 和 JQuery 非常陌生，但我设法让我的第一个 ajax 脚本几乎 100% 工作。也许今天是我的幸运日，我可以完成这件事。:)

让我给你们每个文件的样本，这样你们就知道是什么了。我相信我最后一次尝试解决这个问题并没有成功，因为我混淆了这些文件。它们都是 js 并且具有完全相同的语法。

我拥有的是 2 个 javascript 文件。一种称为 ajax.js，具有以下语法。它调用ajax.php。

```
$("#admEmpID").bind("change", function(e){
  $.getJSON("ajax.php?e=" + $("#admEmpID").val(),
        function(data)
        {
          $.each(data, function(i,item)
          {
            if (item.field == "admEmpStatus")
            {
              // ?? radio buttons
            }
            ............. etc 
```

我拥有的下一个文件是这个脚本，名为 admEmp.js。我*认为*这是用于我的表单验证的。

```
$(function() {
  $('.error').hide();
  $('input.text-input').css({backgroundColor:"#FFFFFF"});
  $('input.text-input').focus(function(){
    $(this).css({backgroundColor:"#FFDDAA"});
  });
  $('input.text-input').blur(function(){
    $(this).css({backgroundColor:"#FFFFFF"});
  });

  $(".admEmpBtn").click(function() {
        // validate and process form
        // first hide any error messages
    $('.error').hide();

      var admEmpID = $("input#admEmpID").val();
    var admEmpStatus = $("input[name='admEmpStatus']:checked").val();

        $.ajax({
  type: "POST",...............etc. 
```

我想做的是根据数据库结果切换我的复选框。如果数据库的结果为 = 1，则应选中该复选框，否则应取消选中该复选框。

我现在拥有的这些脚本将从数据库中的值填充我的文本框，因此对于像我这样不知道 JQuery 及其内部工作发生了什么的人来说，我很自然地假设复选框也将是填充开/关值。也许我不正确。上次我在 SO 上发帖寻求帮助时，有人提到我需要使用服务器端代码切换结果。这是正确的还是 JQuery 会为我做呢？

除了需要显示值的复选框之外，我还有单选按钮。顺便说一句，复选框没有分组；他们每个人都有自己的价值。

感谢你们提供的任何帮助。

* * *

好的。"dz" 说我应该放 ('#admCustRptDly').attr('checked', true); 进入我的脚本，看看是否可以让我看到选中的属性，但事实并非如此。数据库中该复选框的值为 0，因此我应该看不到复选标记。我把它放到 ajax.js 文件中。这是它现在的样子。

```
 else if (item.field == "admCustRptDly" && item.value == "1")
    {
    //  $("checkbox#admCustRptDly").attr("checked", "checked");
      $('#admCustRptDly').attr('checked', true);
    } 
```

* * *

这是我所做的，这让我认为我可能正在取得一些进展。我在条件中设置了警报，但没有收到警报。如果我去找一个确实将 db 值设置为 1 的客户，那么我会收到警报。这比我以前得到的要多。但同样，即使 db = '0' 中的数据，我仍然看到复选标记

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T06:41:50.983

复选框的行为与其他输入字段略有不同。例如，当您拥有`<input type="text" name="field1" value="foo" />`时，文本字段会自动填充“foo”。

但是，如果您有`<input type="checkbox" name="field2" value="1" />`，则该复选框没有任何要填充的内容。这是因为复选框有一个特殊的“checked”属性，它决定了它是否默认被选中。因此，填充文本框的脚本很可能为复选框输入了正确的值，但没有设置选中的属性。

要使用 jQuery 执行此操作，您可以执行`$('#checkboxid').attr('checked', true);`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T06:34:08.973

`#admEmpID`如果我理解正确，当您更改字段中的值（第一个 js 文件）时，您有一个通过 Ajax 调用异步更新的表单。

第二个 js 文件包含将您对表单所做的更改发布回服务器的代码。我认为它不是用于表单验证（至少不是您展示的部分）。

但我不确定问题是什么。当您更改某些文本字段 ( `#admEmpId`) 时，第一个 js 文件从服务器获取数据。该数据是否未正确显示？您提到文本框填充了正确的数据。应该选择的复选框和单选按钮是否没有被选中？在这种情况下，您必须首先确保您了解从服务器返回的数据（包含在`data`第一个 js 文件中的变量中）。然后，您必须验证脚本是否针对要更新的页面上的正确元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-12T12:41:09.353

当您想取消选中某个框时，您可能只需要 javascript 中的另一个 else if 子句：

```
else if (item.field == "admCustRptDly" && item.value == "0")
{
  $('#admCustRptDly').attr('checked', false);
} 
```

但是，您可以将这两种情况简化为一条语句，如下所示：

```
else if (item.field == "admCustRptDly")
{
  $('#admCustRptDly').attr('checked', ((item.value == "1") ? true : false));
} 
```

# spring - 在自定义 tomcat 错误 500 页面中获取一些堆栈跟踪信息

> ID：712716
> 
> 赞同：4
> 
> 时间：2009-04-03T06:09:28.223
> 
> 标签：spring, jsf, tomcat

获取一些堆栈跟踪信息的最佳方法是什么，也许是 Execution.message 到我的带有 tomcat、spring、jsf 的自定义错误 500 页面上？我只想显示异常的根本原因。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T10:03:18.830

这是我在 Struts 中使用的 JSP 语法。您可能可以使用 JSf 来实现此功能或类似功能。

```
<!-- Get the exception object -->
<c:set var="exception" value="${requestScope['javax.servlet.error.exception']}"/>

<!-- Exception message(s) -->
<p>${exception.message}</p>
<p><c:if test="${not empty exception.cause.message}">${exception.cause.message}</c:if></p>

<!-- Stack trace -->
<jsp:scriptlet>
exception.printStackTrace(new java.io.PrintWriter(out));
</jsp:scriptlet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-08T08:00:18.510

我对此的解决方案是——

使用以下命令将错误 jsp 页面声明为错误页面 -

```
<%@ page isErrorPage="true"%> 
```

稍后在同一个 jsp 页面中，您可以访问“异常”对象以将堆栈跟踪打印到您想要的任何位置。

```
<%exception.printStackTrace();%> 
```

# pdf - PDF 文件中的字符串是否意味着什么？

> ID：712727
> 
> 赞同：0
> 
> 时间：2009-04-03T06:18:13.367
> 
> 标签：pdf

我的程序每天从源位置下载 PDF 文件。当我在记事本中看到 PDF 文件的二进制文本时，我发现有时 PDF 文件末尾有字符串`<!-FTCACHE-1->`。有时 PDF 文件中缺少该词。

我的程序每天都会下载这个 PDF，并使用 Windiff 二进制比较将它与前一天的 PDF 文件进行比较。

99% 的情况下，Windiff 报告 PDF 文件中的差异只是因为一个 PDF 包含`<!-FTCACHE-1->`末尾的字符串。

有谁知道这背后的原因是什么？

谢谢， 普拉文

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T20:32:53.940

`<!--FTCACHE-1-->` is generated by FatWire Content Server, a web content management solution that is probably generating your URL. FTCACHE means FutureTenseCache, the name of the original product component. The text is a "footer" flag that indicates to the caching module whether or not the page was properly generated. If the page is supposed to be cached, a 1 indicates that the page was properly built, and so is cacheable. If 0 is returned, it indicates that the page was corrupted and should not be cached. The Satellite Server caching engine is supposed to strip this footer once it reads it.

In other words, the key that is there to ensure that the cache is not corrupted, is causing the corruption in your PDF.

This issue has been fixed in patches to FatWire ContentServer for quite some time now.

For your purposes, just ignore the string - strip it if you can.

Sorry about that. That was my bug. :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-12T19:57:28.703

生成 PDF 文件的应用程序存在错误，FTCACHE 标记不应该存在，它不是有效的 PDF 结构。如您所见，它的存在实际上会损坏 PDF 文件，它会使 PDF 文件中的 FastWebView 功能失效。在比较文件之前将其删除是安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T07:04:26.313

“FT”可以是[FreeType](http://www.freetype.org/index2.html)，开源字体引擎。评论可能来自生成 PDF 的软件。如果您能以某种方式确定这一点，您可以（假设它是开源的）也许可以查看它并查看导致它发出评论的原因。

FreeType 有一个专门用于缓存的[源文件夹](http://git.savannah.gnu.org/cgit/freetype/freetype2.git/tree/src/cache)，那里的根源文件称为[ftcache.c](http://git.savannah.gnu.org/cgit/freetype/freetype2.git/tree/src/cache/ftcache.c)。不过，它并没有做很多事情，只是`#include`s (!) 其他源文件。

谷歌搜索你看到的字符串，显示了几个或多或少随机的 PDF:s 似乎包含它。

# sql - 在 IF .. ELSE 语句中使用临时表

> ID：712731
> 
> 赞同：5
> 
> 时间：2009-04-03T06:21:57.537
> 
> 标签：sql, sql-server, sql-server-2005, tsql

为什么 SQL Server 坚持临时表已经存在！一种或另一种会发生！，所以永远不会这样。

```
declare @checkvar  varchar(10)
declare @tbl TABLE( colx varchar(10) )
set @checkvar ='a'

INSERT  INTO @tbl (colx) VALUES('a')
INSERT  INTO @tbl (colx) VALUES('b')
INSERT  INTO @tbl (colx) VALUES('c')
INSERT  INTO @tbl (colx) VALUES('d')

IF @checkvar  is null  select colx INTO #temp1 FROM @tbl
ELSE select colx INTO #temp1 FROM @tbl WHERE colx =@checkvar 
```

错误是：数据库中已经有一个名为“#temp1”的对象。

有没有一种优雅的方式来解决这个问题？如果@checkvar 为空，我想要整个表，否则，只给我@checkvar = something 的值

编辑：该列是 varchar，而不是 int。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-02-18T07:45:35.757

您可以使用创建具有所需结构的空临时表`WHERE 1=0`。然后使用您的原始代码插入所需的记录

```
SELECT colx INTO #temp1 
FROM   @tbl 
WHERE  1 = 0  // this is never true

IF @checkvar  IS NULL
BEGIN 
    INSERT INTO #temp1 (colName)   
    SELECT colx FROM @tbl 
END
ELSE 
BEGIN 
    INSERT INTO #temp1 (colName)   
    SELECT colx 
    FROM   @tbl 
    WHERE  colx = @checkvar 
END 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T06:29:55.270

你就不能重写声明吗？

```
SELECT colx INTO #temp1 FROM @tbl WHERE (@checkvar IS NULL) OR (colx = @checkVar) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T18:02:39.683

如果这是一个存储过程，SELECT .. INTO 将导致重新编译该过程。

据我了解，最好在程序顶部创建表，然后再进行正常的 INSERT。

所以，我建议：

```
CREATE TABLE #temp1 (colx ...)

DECLARE @checkvar  VARCHAR(10)
DECLARE @tbl TABLE( colx varchar(10) )
SET @checkvar ='a'

INSERT  INTO @tbl (colx) VALUES('a')
INSERT  INTO @tbl (colx) VALUES('b')
INSERT  INTO @tbl (colx) VALUES('c')
INSERT  INTO @tbl (colx) VALUES('d')

IF @checkvar IS NULL  
BEGIN
  INSERT INTO #temp1(colx)
  SELECT colx 
  FROM @tbl
END
ELSE 
BEGIN
  INSERT INTO #temp1(colx)
  SELECT colx 
   FROM @tbl WHERE colx =@checkvar
END 
```

此外，这样您就可以摆脱其他解决方案提到的 OR（OR 是邪恶的；）

/乙

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T07:09:14.553

```
drop table #temp1

select colx into #temp1 
from @tbl
where (ISNULL(@checkvar,'0')='0' or [colx] = @checkvar ) 
```

如果 @checkvar 存在，它将使用这个 where 语句，否则它将返回所有数据。您可以将“0”更改为您想要的任何内容，只要它永远不会是@checkvar 的初始值。

# c++ - 回调例程没有被触发

> ID：712737
> 
> 赞同：0
> 
> 时间：2009-04-03T06:25:02.350
> 
> 标签：c++, mfc, callback

我创建了一个非常简单的一键式 MFC 对话框应用程序，它尝试利用回调函数。该应用程序符合并运行得很好，但回调例程永远不会被触发。

为了让回调正确触发需要修改什么？

您可以在此处下载 test.zip 文件（测试应用程序在 VS 2003 中，以确保更多人可以试用）： [http ://tinyurl.com/testfile-zip](http://tinyurl.com/testfile-zip)

该代码使用 CodeProject 上的警报类，并且回调函数应该每 3 秒触发一次（由传入的代码确定）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T09:27:30.290

我查看了您的代码，我相信从按钮调用的函数是问题所在

```
void CTestDlg::OnBnClickedButton1()
{
    CAlarmClock clock;

    REPEAT_PARMS rp;
    ZeroMemory(&rp, sizeof(REPEAT_PARMS));

    rp.bRepeatForever = TRUE;
    rp.Type = Repeat_Interval;
    rp.ss = 3;

    clock.SetRepeatAlarm(0, 0, 0, rp, CallbackRtn);
} 
```

这会在函数堆栈上创建闹钟。因此，这个 CAlarmclock 对象在函数结束时连同其内容一起被销毁。

为了让它能够存在足够长的时间以实际执行回调，您需要将其添加为对话框类的成员变量，以便它存在并在对话框存在时回调。

有关如何正确使用此类的信息，请参阅 CAlarmclock 代码项目页面上的示例代码。

# database - 交易理论

> ID：712750
> 
> 赞同：1
> 
> 时间：2009-04-03T06:36:53.210
> 
> 标签：database, transactions

（我在 DAO 模式实现中有一个简单的 CRUD API。）所有操作（保存、加载、更新、删除）都有一个必须提供的事务 ID。所以例如。它可以这样做：

...

```
id = begintransaction();
dao.save(o, id);
sao.update(o2, id);
rollback(id); 
```

不包括加载调用的所有示例看起来都很直观。但是一旦你开始从数据库中加载对象，事情就会“感觉”有点不同。根据定义，加载操作是否与事务相关联？还是应该将我的加载操作算作单个工作量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T06:41:33.823

取决于您正在使用的事务隔离级别 ( [http://en.wikipedia.org/wiki/Isolation_(database_systems)](http://en.wikipedia.org/wiki/Isolation_(database_systems)) )，但通常它们应该是事务的一部分。如果其他人正在更新您尝试读取的数据怎么办？如果读取操作不是事务性的，您将获得旧数据，并且您可能对最新数据感兴趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T07:13:48.037

如果数据库设置为适当的隔离级别，则只能从创建它们的事务中读取未提交的写入。例如，在 Oracle 中，如果一个过程插入或更新一行，然后（不提交）调用另一个过程，该过程使用“pragma automatic_transaction”在单独的事务中运行，则其他过程看不到新行。（顺便说一句，这是一种很好的射击自己的方式）。

出于这个原因，您应该始终将您的加载操作视为与事务相关联。

# multithreading - 线程需要连续运行，即使发生异常

> ID：712751
> 
> 赞同：0
> 
> 时间：2009-04-03T06:38:01.460
> 
> 标签：multithreading

我的应用程序使用了一个应该连续运行的线程。如果有任何异常，它应该记录该异常并且不应该停止。目前我的代码如下所示。谁能帮我？

```
void methodname()
{
   try
     {
        while(1)
        executable statements
     }
   catch
     {
       log exception
     }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T06:45:33.067

它需要是这样的：

```
while(1)
{
 try
 {
 }
 catch()
 {
   //log the exception
 } 
 //continue looping
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T06:40:29.800

您必须尝试/捕获循环内的异常 - 现在您的代码在抛出异常时退出循环。

# jpa - JPQL createQuery 抛出非法ArgumentException

> ID：712754
> 
> 赞同：1
> 
> 时间：2009-04-03T06:39:24.827
> 
> 标签：jpa, jakarta-ee, ejb, jpql

以下简单代码引发异常：

```
entityManager.createQuery("SELECT c FROM Customer c"); 
```

但如果我写

```
entityManager.createNativeQuery("SELECT c.* FROM Customer c", Customer.class) 
```

然后它可以正常工作。可能有什么问题？我将 GlassFish v2.1 与 Toplink-essentials 一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T08:41:49.603

只要您将类 Customer 定义为实体，JPQL 查询“SELECT c FROM Customer c”就有效。该方法仅在查询由于某种原因“无效”时抛出异常，如果出现问题，任何体面的 JPA 实现都应该在异常消息中提供更多信息

——安迪（数据[核](http://www.datanucleus.org)）

# php - 如何在特定时区的php中查找星期几

> ID：712761
> 
> 赞同：99
> 
> 时间：2009-04-03T06:41:36.243
> 
> 标签：php, datetime, timezone

我在使用 php 处理日期/时间时感到困惑。

我要做的是：当用户访问我的页面时，我询问他的时区，然后在他的时区显示“星期几”。

我不想使用浏览器的一天。我想在 php.ini 中做这个计算。

这就是我试图实现它的方式：

1.  用户输入的时区
2.  由 php time() 函数计算的 Unix 时间戳。

但我不知道如何继续......我如何在这个时区获得“星期几”。

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2009-04-03T07:47:55.053

```
$dw = date( "w", $timestamp); 
```

其中 $dw 将为 0（星期日）到 6（星期六），您可以在此处看到： [http ://www.php.net/manual/en/function.date.php](http://www.php.net/manual/en/function.date.php)

* * *

## 回答 #2

> 赞同：118
> 
> 时间：2012-07-09T20:19:55.797

我的解决方案是这样的：

```
$tempDate = '2012-07-10';
echo date('l', strtotime( $tempDate)); 
```

输出是：`Tuesday`

```
$tempDate = '2012-07-10';
echo date('D', strtotime( $tempDate)); 
```

输出是：`Tue`

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2016-10-25T11:43:08.637

我认为这是正确的答案，只需更改`Europe/Stockholm`用户时区即可。

```
$dateTime = new \DateTime(
    'now',
    new \DateTimeZone('Europe/Stockholm')
);
$day = $dateTime->format('N'); 
```

> 星期几的 ISO-8601 数字表示（在 PHP 5.1.0 中添加） 1（周一）到 7（周日）

[http://php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)

有关支持的时区列表，请参阅 [http://php.net/manual/en/timezones.php](http://php.net/manual/en/timezones.php)

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-04-03T08:22:35.563

非常感谢你们的快速评论。

这就是我现在要使用的。在此处发布该功能，以便有人可以使用它。

```
public function getDayOfWeek($pTimezone)
{

    $userDateTimeZone = new DateTimeZone($pTimezone);
    $UserDateTime = new DateTime("now", $userDateTimeZone);

    $offsetSeconds = $UserDateTime->getOffset(); 
    //echo $offsetSeconds;

    return gmdate("l", time() + $offsetSeconds);

} 
```

如果您发现任何更正，请报告。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2010-10-18T23:22:45.533

另一种快速方法：

```
date_default_timezone_set($userTimezone);
echo date("l"); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-03T06:58:10.727

如果您可以获取他们的时区偏移量，您可以将其添加到当前时间戳，然后使用[gmdate](http://php.net/gmdate)函数获取他们的本地时间。

```
// let's say they're in the timezone GMT+10
$theirOffset = 10;  // $_GET['offset'] perhaps?
$offsetSeconds = $theirOffset * 3600;
echo gmdate("l", time() + $offsetSeconds); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-03T06:50:27.640

```
$myTimezone = date_default_timezone_get();
date_default_timezone_set($userTimezone);
$userDay = date('l', $userTimestamp);
date_default_timezone_set($myTimezone); 
```

这应该工作（没有测试它，所以YMMV）。它的工作原理是存储脚本的当前时区，将其更改为用户指定的时区，从指定时间戳的函数中获取星期几`date()`，然后将脚本的时区设置回最初的时区。

不过，您可能会对时区标识符进行一些冒险。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-03T07:41:50.153

“星期几”实际上是您可以直接从 php date() 函数中获取的内容，格式分别为“l”或“N”。看看 [说明书](http://de2.php.net/manual/en/function.date.php)

编辑：对不起，我没有正确阅读 Kalium 的帖子，他已经解释过了。我的错。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-12-24T04:36:20.390

**检查日期是周一或周日，然后是上周一或上周日**

```
 public function getWeek($date){
    $date_stamp = strtotime(date('Y-m-d', strtotime($date)));

     //check date is sunday or monday
    $stamp = date('l', $date_stamp);      
    $timestamp = strtotime($date);
    //start week
    if(date('D', $timestamp) == 'Mon'){            
        $week_start = $date;
    }else{
        $week_start = date('Y-m-d', strtotime('Last Monday', $date_stamp));
    }
    //end week
    if($stamp == 'Sunday'){
        $week_end = $date;
    }else{
        $week_end = date('Y-m-d', strtotime('Next Sunday', $date_stamp));
    }        
    return array($week_start, $week_end);
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-04-09T16:15:45.963

基于带有标志的其他解决方案之一，可在周日或周一开始的周之间切换

```
function getWeekForDate($date, $weekStartSunday = false){

    $timestamp = strtotime($date);

    // Week starts on Sunday
    if($weekStartSunday){
        $start = (date("D", $timestamp) == 'Sun') ? date('Y-m-d', $timestamp) : date('Y-m-d', strtotime('Last Sunday', $timestamp));
        $end = (date("D", $timestamp) == 'Sat') ? date('Y-m-d', $timestamp) : date('Y-m-d', strtotime('Next Saturday', $timestamp));
    } else { // Week starts on Monday
        $start = (date("D", $timestamp) == 'Mon') ? date('Y-m-d', $timestamp) : date('Y-m-d', strtotime('Last Monday', $timestamp));
        $end = (date("D", $timestamp) == 'Sun') ? date('Y-m-d', $timestamp) : date('Y-m-d', strtotime('Next Sunday', $timestamp));
    }

    return array('start' => $start, 'end' => $end);
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-05-10T13:57:18.923

日期部分的标准基于字母的表示非常棒，除了它们不是那么直观。更方便的方法是识别基本的抽象和一些具体的实现。此外，通过这种方法，您可以从自动完成中受益。

由于我们在这里讨论的是日期时间，因此基本抽象是`ISO8601DateTime`. 具体实现之一是当前日期时间，当 a 向您的后端发出请求时，您需要它，因此是`Now()`类。第二个对您有用的是调整到某个时区的日期时间。毫不奇怪，它被称为`AdjustedAccordingToTimeZone`. 最后，您需要在已通过的日期时间的时区中的一周中的一天：有一个`LocalDayOfWeek`类。所以代码如下所示：

```
(new LocalDayOfWeek(
    new AdjustedAccordingToTimeZone(
        new Now(),
        new TimeZoneFromString($_POST['timezone'])
    )
))
    ->value(); 
```

有关此方法的更多信息，[请查看此处](https://meringue.readthedocs.io/en/latest/quick_start.html)。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2016-10-25T08:40:56.203

```
echo date('l', strtotime('today')); 
```

# jquery - jQuery 垂直悬停手风琴

> ID：712763
> 
> 赞同：2
> 
> 时间：2009-04-03T06:42:01.670
> 
> 标签：jquery, hover, accordion

垂直悬停手风琴有哪些 jQuery 插件？我正在寻找一个用于菜单的插件，其中：

*   子菜单项只会在悬停一秒钟后展开（因此可能使用 hoverIntent 插件）；
*   如果关闭 Javascript，它可以优雅地降级；和
*   当鼠标完全离开它时，将折叠/关闭任何子菜单项。

十分感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T06:44:11.510

您可以尝试[jquery UI 手风琴](http://jqueryui.com/demos/accordion/)。它有很多选项，您也可以自定义它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-06T00:48:07.813

我可能是错的，但我认为使用 mouseover 或 mouseenter 事件来控制垂直手风琴可能存在固有问题——除非你*真的*知道子菜单会是什么样子。

问题在于假设：子菜单中有很长的项目列表，下面还有一些简短的子菜单或单个菜单项。像这样：

*   菜单
    *   1
    *   2
        *   一种
        *   b
        *   C
        *   d
        *   e
        *   F
    *   3
    *   4
    *   5
        *   一种
        *   b
        *   C

因此，当您从 #2 移动到 #3 时，#2 会折叠，将您的指针放在列表的下方。你触发了#3、#4、#5 的所有mouseover/out 或mouseenter/leave 事件......并且可能会移过整个菜单......事情可能会开始疯狂地弹跳。

也许可以让 hoverIntent 插件工作，但我认为只使用鼠标点击是一个更优雅的解决方案。至少对于一个抽象的列表，就是这样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-16T22:36:27.527

嘿，看看这个 Hover Accordion 插件，我一直在寻找相同的效果，我发现了这个。[http://berndmatzner.de/jquery/hoveraccordion/](http://berndmatzner.de/jquery/hoveraccordion/)

这可能有助于您使用 jquery 的原始手风琴进行悬停。 `$("#accordion").accordion({ event: "mouseover" });`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-11T04:28:26.547

试试这些：

*   [http://designreviver.com/tutorials/jquery-examples-horizo​​ntal-accordion/](http://designreviver.com/tutorials/jquery-examples-horizontal-accordion/)
*   [http://www.marghoobsuleman.com/jQuery-common-accordion](http://www.marghoobsuleman.com/jQuery-common-accordion)

# .net - 处理（嵌套）记录集的最佳方法是什么？

> ID：712768
> 
> 赞同：1
> 
> 时间：2009-04-03T06:45:04.893
> 
> 标签：.net, sql, ado.net

将一对多关系从数据库服务器传递到客户端的最佳（更清洁、更便宜）的方法是什么？

想象一下，我有一个 Author 表和一个 Book 表。我想检索名字以“a”开头的所有作者以及他们写过的所有书。然后，在客户端，生成一个对象数组“Author”，其“Books”字段是一个对象数组“Books”。

我想到的两个穷人解决方案是：

1.  检索所有作者，在客户端循环浏览它们并执行附加查询以获取所有书籍
2.  “选择 a.* FROM author a, book b WHERE a.name like 'A%' and b.author_id = a.id”

第一个解决方案实际上是数据库端密集型的（如果我有 1000 个作者，我必须执行 1001 个查询）。

第二个需要在客户端进行一些密集的工作，因为程序将解析结果，因为它具有在每一行上重复的 Author 共有的数据。

另一种解决方案是从存储过程中返回多个记录集。我从来没有处理过多个记录集，我不确定所有的语言/适配器类都支持它们。

当然，如果任何作者都可以拥有书籍*和*散文，并且每本书都可以有样页等等，情况会变得更糟。

任何想法？谢谢

编辑：我使用的是 .net，所以 ado 的数据关系是一个选项。他们支持我的 oracle 和 mysql 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T22:24:56.677

你的两个问题在这里。一是如何最有效地收集数据，二是如何处理收到的数据。

首先如何收集它：

```
SELECT a.* FROM Author a INNER JOIN Book b ON a.id=b.author_id WHERE left(a.name,1)='a' 
```

喜欢是非常昂贵的，如果可以的话，避免它。内连接是比较表的最便宜的方法 - 特别是如果您在主键 (id) 和外键 (author_id) 上有索引LEFT JOIN（相同的语法只是将 'inner' 更改为 'left'）

第二。如果您谈论的是 1000 条记录，您可能需要考虑在两个单独的 pull 中收集数据（就像我认为的您的第一选择），除非您希望用户永远等待页面加载。例如：用户选择所有以 a 开头的作者并收到一个列表 - 您甚至可以计算该作者的文章数量。

```
SELECT a.Name count(b.author_id) titles 
FROM Author a INNER JOIN Book b ON a.id=b.author_id 
WHERE left(a.name,1)='a'
GROUP BY a.Name 
```

他们会看到

```
John Adam:  35 Titles
Jane Acaba: 18 Titles
Jim Allan:  3 Titles 
```

然后用户点击作者，加载该作者的书籍列表。

```
Jim Allan's Titles:
   Froggy went a court'n
   Death on the Nile
   Life in Africa 
```

如果您希望它看起来像是一次拉动就完成了，但您希望它快速完成，请使用 xmlhttp 或 ajax 来显示作者列表。那是另一个话题。:)

我还应该补充一点，存储过程是必须的。这将显着增加应用程序的可移植性以及大多数数据库的性能。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T07:47:11.047

我们使用多个记录集。如果您有另一个实体链接到作者，只需添加另一个记录集。不确定 Oracle 和 MySQL，但如果 IDataReader 的相应实现 NextResult() 不抛出 NotSupportedException，这应该适用于他们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T06:57:48.183

我认为后者可能比前者更接近一个好的解决方案。

也就是说，您可能希望在客户端和数据库之间（在数据库机器上）引入一个层，该层可以将数据库中的行过滤并处理成您选择的数据结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T07:01:37.677

这可能取决于 RDBMS 的选择，其中一些可能支持启用所需功能的某些功能，尽管该功能可能无法移植到另一个 RDBMS。

例如，Microsoft SQL Server 从 SQL 2000 开始支持 SELECT FOR XML。如果仔细设计 XML 模式（例如 FOR XML EXPLICIT），这将完全符合您的要求——返回一个 XML，该 XML 为您提供数据的层次结构。如果您还使用 ADO.NET，并选择使用 SqlDataAdaptor 将其加载到 DataSet 中，则结果 DataSet 实际上会将所有数据设置到 DataTables 中，并在 DataTables 之间设置正确的 DataRelations。但是，这可能是 MS-SQL 特有的功能，在另一个 RDBMS 中工作可能需要一些其他技术。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T18:52:10.837

假设一个典型案例，您的数据量将主要在“Books”表中。采用最简单的解决方案，对于您希望对用户施加的任何显示尺寸而言，惩罚都是很小的 - 将两者连接在一起并返回单个行集，在“作者”列数据中具有一定量的冗余。其他解决方案需要多个查询，这在总体方案中在大多数情况下既昂贵又复杂。

我的优先顺序通常是：交付最佳 UI 体验所需的内容，为最简单的实施而构建（关于异常情况的正常免责声明决定了异常设计）。

这可能也是将数据策略与 UI 设计更改分离的最佳工作，因为所有内容都在一个易于导航的结果集中。

# design-patterns - 您是否曾经从大自然中获得过编程解决方案？

> ID：712769
> 
> 赞同：34
> 
> 时间：2009-04-03T06:45:07.077
> 
> 标签：design-patterns, architecture

当你退后一步看...

*   动物、昆虫、植物的本质及其有机解决的问题
*   甚至可能是宇宙的本质和平衡

您是否曾经能够通过从自然中获取方法来解决问题？

我听说[蚁群算法](http://en.wikipedia.org/wiki/Ant_colony_optimization)能够优化供应链等。[分形](http://en.wikipedia.org/wiki/Fractal)作为“自然几何”也被应用于广泛的问题。

现在春天又来了，世界恢复了生机，我想知道是否有人可以分享一些经验。

谢谢

PS 我建议您观看关于分形的“[狩猎隐藏维度](http://www.pbs.org/wgbh/nova/fractals/)”新星剧集。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-03T06:53:11.143

我记得读过一本数学家写的关于数学领域的书，他提到了一个自然界的例子。他在大自然中的榜样帮助我改进了我正在做的设计。

他的例子是这样的：他正在开车，他在电话线上看到了一些鸟。这些鸟被均匀地隔开。发生这种情况并不是因为有某种无所不能的鸟在告诉每个人该坐在哪里。相反，每只鸟都有自己的特定“算法”来决定当另一只鸟经过时该做什么。我猜鸟类更喜欢最大化它们的自由空间。

当我对 OO 还很陌生时，这对我很有帮助。我一直倾向于让事情变得程序化，并在“上帝对象”中拥有集中的智能。我读了这篇文章，意识到单个对象只能专注于他们需要知道和关心的事情，但在大局层面上的结果仍然可能是你想要的。正确的结果可以“出现”而不被“控制”。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T07:15:13.540

我个人从来没有通过应用自然的想法来解决问题。但是，我通过应用其他人受自然启发的解决方案来解决问题。

许多图形布局算法和一般的布局算法都是基于力学（弹簧、橡皮筋、重力）或简单的类似昆虫的行为（跟随你的领导者，最大化/最小化距离）。

而且，当然，我喜欢面向对象的编程，它由 Nygaard 和 Dahl 开发，用于模拟现实世界的物理对象，并由 Alan Kay 完善，他是一位微生物学家，他根据简单细胞可以形成复杂有机体的方式明确建模 OO能够进行复杂的行为。所以，从某种意义上说，每个做 OO 的人，都在间接地从自然中派生出他的程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T09:26:24.940

我从事图像处理工作，处理过于接近而无法通过简单阈值区分的斑点对象。我实现了一个分水岭算法——这个想法是，如果您将对象可视化为地图上的山丘，并计算两个山丘之间的分水岭线，您可以计算出一个对象结束的位置和另一个对象的开始位置。

我想改进这个算法，作为一个徒步旅行者，我发现自己在湖区的高处，用手指俯瞰着山丘和山谷的全景（这让我的另一半很尴尬）。众所周知，我也会向同行的步行者提出类似的问题，“这座山的尽头是哪里，下一座从哪里开始？为什么？你为什么不数那个小山？”

不过，我还没有把我的笔记本电脑带出去。:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-03T09:37:08.050

无论自然界中的任何概念，我们可以在哪里建立数学模型（微分方程），我们都可以将它们应用于编程，因为最后一个是基于逻辑和数学基础的，比其他的多。

我认为我们也可以倒过来思考，例如观察者模式，也有很多物种也实现了这种模式，责任链等等。

这是一种有趣的思考方式……

好一个朋友！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-05-13T09:05:59.157

我们以编程方式创建了一个“错误”......曾经......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-02-23T17:44:10.620

常常。

我有时会一边思考问题，一边在阿甘散步。而且我遇到的解决方案通常与树木有关。

我还致力于受物理学启发的 UI 创意。使用重力、磁力或电斥力等概念来组织显示器上的项目。

我也曾经听过一个关于 SOA 的有趣演讲，信不信由你。演讲的中心思想是 SOA 架构中的不同子系统应该以生物系统中细胞的方式进行协作。该主题对复杂系统如何实际工作具有高度启发性，即使它是由松散耦合的组件构成的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-03T07:32:07.133

其中最著名的是[神经网络](http://en.wikipedia.org/wiki/Neural_network)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-25T14:46:21.443

我的音乐软件（参见我的个人资料）使用进化过程来创作音乐，其方式有点类似于 Richard Dawkins 的*The Blind Watchmaker*（创作图像而不是音乐）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-25T19:47:20.113

自 70 年代以来，我所在大学的 CS 系就对受自然启发的算法产生了历史性的兴趣（我认为正确的学术术语是[自然计算](http://en.wikipedia.org/wiki/Natural_computation)。这就是我接触其中一些算法的方式，尤其是[进化策略](http://en.wikipedia.org/wiki/Evolution_strategy)，广泛 -已知的神经网络，以及[膜计算](http://en.wikipedia.org/wiki/Membrane_computing)的奇特艺术。我还上了数据挖掘课程，在那里我们研究了一些允许计算机系统从一组数据中学习的算法。

我想说，使计算机[“学习”](http://en.wikipedia.org/wiki/Machine_learning)某些东西的每一种算法都属于源自自然的类别。因此，即使是像朴素贝叶斯这样相当基本的算法也属于这一类，我们可能都以某种方式使用它们，例如过滤垃圾邮件。

就个人而言，我只在大学课堂或个人编程实验中实现过这种算法。我认为人们普遍认为它们很强大，尽管在许多情况下效率低于“经典”确定性算法。因此，应该始终首选确定性算法——如果有一个可以解决问题的算法！只有当问题太复杂而无法使用确定性算法解决时，自然计算才能提供更好的解决方案。从我个人的经验来看，这确实是真的。一个小例子：我为解决数独难题而实施的进化策略花了我半天的时间来实施，并运行了几个小时以找到与经典回溯算法在不到一秒的时间内找到的相同解决方案（我花了不到三十分钟的时间来写;-))

我只记得有一个同学用进化策略解决了如何将一组文件最优地分配到多张DVD上存档的问题，我认为这是背包问题或装箱问题的一个应用，并且效果很好. 显然，蚁群算法也可以用于此。无论如何，感谢这个有趣的问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-07-25T20:29:17.970

我还没有解决这个问题，但我认为声誉、“业力”或在一群人之间达成共识的任何变化的最终解决方案在于 Maynard Smith 在进化和博弈论中描述的工作。具体来说，他提出了进化稳定策略 (ESS) 的概念，这是一种对外部不良行为者具有鲁棒性的行为模式。

如果我们假设每个人都是利他的，那么事情就很简单了。梅纳德·史密斯（Maynard Smith）所说的“鸽派”策略总是顺从他人，这是一种有效的策略，因为没有人会浪费时间去战斗。但它不是 ESS，因为它可以被自私的演员从外部入侵。这类似于只有赞成票的网站。它会失败，因为任何人都可以投票给最高层。

Stack Overflow 和 Slashdot 等更复杂的系统主要鼓励赞成票，但允许反对票。他们对不“合作”的人更加强大，但他们仍然容易受到“游戏”的影响。在这两种情况下，通过成为第一个发帖者、发布有趣而不是有用的内容以及类似的操作，很容易快速提升声誉。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-05-13T09:02:02.557

我使用基于进化生物学的[遗传算法](http://en.wikipedia.org/wiki/Genetic_algorithm)来检测超大规模集成电路中的故障

以下链接将为您提供遗传算法的基本解释和遗传算法的 C++ 库。

[遗传算法简介](http://www.obitko.com/tutorials/genetic-algorithms/)

[遗传算法组件的 C++ 库](http://lancet.mit.edu/ga/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-03T07:05:48.883

黎明之星的威胁不断迫使我评估和重新评估我的算法以获得最大效率。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-03T07:40:00.487

[我从自然界的能量守恒](http://en.wikipedia.org/wiki/Conservation_of_energy)定律中很好地理解了一件事情，“*产品中的错误总数是恒定的。一个错误永远不会被修复。它只是被转换为另一个错误*”！:-)

开个玩笑，我真的很感激在我的工作中使用像 C++ 这样的语言，其中的概念（例如：继承、朋友）来自社会系统。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-07-25T15:07:59.050

“异常处理”这个极其简单的概念是任何软件中最强大、最直接的自然应用。

任何生物都会尽其所能适应周围不断变化的环境，并在生活中继续前进以实现其生存目标。许多特殊情况介于两者之间，阻止了它的目标，但有机体努力奋斗，并试图找到完成手头工作的最佳方式。我们的日常生活充满了这样的经历。

异常处理也有助于任何软件绕过遇到的任何困难实现其目标。

但是软件中缺少的一件事是我希望真正必须存在的东西。它是这样的：

人类不断从错误中学习，将遇到的一切都存储在脑海中，下次出现此类问题时，他们知道如何避免/解决它。但是当它第一次发生时，他们知道从他们的正常习惯中避免它（使用公共基类 Exception 处理异常），但后来他们知道有一种专门的方法来处理它（专门的异常类，如 FileDoesNotExistException ）。尽管他们会听取朋友的建议，但他们从不去维修店进行更新。我希望你们能明白我想说的话。

软件也应该在不向用户显示“正在升级的站点”消息并使用普通的异常类处理未知问题的情况下继续学习。虽然已经发布了新版本，但我希望我们应该开发一个始终运行和自我学习的软件，它可以自我升级，而不会出现故障。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-07-25T20:16:00.710

[我曾经和Terragen](http://www.planetside.co.uk)的作者做过一些工作，将他的一些大气渲染算法整合到我编写的景观渲染程序中。最让我印象深刻的是代码实际上模拟了大气——你输入黑色作为你的基色（因为天空在太空中是黑色的）和光源颜色（实际上是白色，可能是轻微的黄色），各种值大气高度、密度和红/绿/蓝衰减然后开始了整个事情——它产生了一个漂亮的蓝色渐变天空和一个发光的黄色太阳——或者如果你正确地定位了太阳，一个漂亮的红色到深蓝色的天空和日落。

实际上它并不是特别复杂——只是一些经过精心挑选的数学方程，最多可以模拟十几个不同参数的行为——但它被完美地组合在一起。之后我花了很多时间玩它——最终完全重写了它以用于 GLSL，但它确实教会了我一些关于如何解决某一类问题的知识。

# c# - 通过.net程序在SQL2005中创建表

> ID：712771
> 
> 赞同：1
> 
> 时间：2009-04-03T06:46:00.227
> 
> 标签：c#, .net, sql-server-2005

我需要在 C#.net 程序中动态创建表。任务是将excel文件导出到SQL数据库。如果列名和表名作为参数传递，如何编写创建表的存储过程？我试图写以下SP。

```
ALTER PROCEDURE dbo.CreateTempTable
@Param1 VarChar(50),
@Param2 VarChar(50),
@Param3 VarChar(50),
@Param4 VarChar(50)
AS
if exists(select * from sys.objects where object_id = OBJECT_ID('[dbo].[Temp]') AND type='U')
begin
Drop Table [dbo].[Temp]
end

Create Table [dbo].[Temp]([@CountryID] [int],
[@Param1] [VarChar](150),
[@Param2] [DateTime],
[@Param3] [VarChar](50),
[@Param4] [VarChar](50));

RETURN 
```

执行时，如果我输入为

```
@Param1 - 'CountryId'
@Param2 - 'CountryName'
@Param3 - 'CreateDate'
@Param4 - 'CreatedBy' 
```

创建为@Param1、@Param2、@Param3、@Param4 而不是 CountryId... 等的列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T06:52:35.840

你的 sproc 的主体应该是

```
 exec ('CREATE TABLE [dbo.Temp] (' + @param1 + ' int,' + @param2 + ' [DateTime], ' + @Param3 + ' VarChar, ' + @Param4 + ' VarChar)') 

```

虽然，当您从 .net 调用它时，您不妨在 .net 中构建一个字符串并将其作为内联 SQL 执行......

例如：

```
 string sql = string.Format("CREATE TABLE [dbo.Temp] ({0} int, {1} [DateTime], {2} VarChar, {3} VarChar)", fieldName1, fieldName2, fieldName3, fieldName4); 

```

然后将其作为 SQL 执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T06:51:51.567

您可以将[sp_executesql](http://msdn.microsoft.com/en-us/library/ms175170.aspx)系统存储过程与您必须在程序中构建的自定义字符串一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T06:54:39.563

您可以执行以下操作：

```
execute 'Create Table [dbo].Temp, ' +[@Param2]+' [DateTime], '+[@Param3]+' VarChar, '+[@Param4]+' VarChar);'; 
```

# sql - 使用自定义编码方案而不是 GUID 作为主键

> ID：712774
> 
> 赞同：3
> 
> 时间：2009-04-03T06:49:07.020
> 
> 标签：sql, sql-server, ms-access, database-design

我正在将后端 MS Access 数据库升级到 SQL Server。前端客户端暂时还是一个 Access 应用程序（大约有 30k 行代码）。

目的是最终允许跨多个服务器同步数据库（不使用复制，但可能使用同步框架）。
目前，Access 表中的所有主键都是自动增量整数代理项。

我不是在问升迁的过程，而是在问我是否应该使用 GUID 或其他编码来进行 PK（我知道我可以跨服务器拆分数字范围，但我不想这样做并允许 PK如有必要，在客户端上创建，例如在离线模式下）。

**图形用户界面**

*临：*

*   标准化格式。
*   确保唯一性（实际上无论如何）

*缺点：*

*   在 Access 中不容易操作，尤其是在将它们用作子窗体或控件的过滤器时。
*   由于它们的随机性而降低了 INSERT 性能。
*   具有不止一种表示形式：需要转换的字符串、规范形式、二进制。

**自定义编码方案**

我认为使用更统一的代码作为 PK 的方案可能会避免性能损失，最重要的是，确保 PK 在必要时在表单控件中仍然可用（并且不需要这些与字符串的转换）。

我对编码方案的想法是将 10 个字符的代码分成以下几行：

*   8 位时间戳
*   4 位数字代表唯一的客户 ID
*   2 位数字作为潜在冲突的随机数每个数字将以 34 为基数，由 AZ 和 2-9 的字母组成，避免`O`, `0`, `1`,`I`因为它们的相似性（以防我们需要手动处理这些 PK，例如在调试期间）。

*临：*

*   案件出现时更容易手动处理。
*   不需要在不同的表示之间进行转换，因为它基本上是一个字符串（因此现有的代码要适应的更少）。
*   确保唯一性（实际上）

*缺点：*

*   JOIN 的性能尚未得到证实
*   INSERT 中的性能应该比 GUID 快，但未经证实
*   每台服务器/客户端机器都必须设置自己的 UID，尽管这应该不是什么大问题。

那么，我应该为我的 PK 使用 GUID 还是其他方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T07:28:16.333

***在 Access 中不容易操作，尤其是在将它们用作子窗体或控件的过滤器时。***

-> Access 的 GUID 为 Number->Replication Identificator。我们在 Access 中使用每个 PK 作为 GUID 的应用程序，并且过滤器没有任何问题（以及子源的过滤器）。

***由于它们的随机性而降低了 INSERT 性能。***

-> 如果你有基于 od 的性能问题，你可以在另一列上有集群索引（例如时间戳）。但是 MSSQL 服务器有两个函数用于生成新的 GUID 值——“newid()”和“newsequenceid()”。第二种方法 - 顾名思义 - 按顺序生成新值，因此不应发生插入性能问题。

***具有不止一种表示形式：需要转换的字符串、规范形式、二进制。***

-> 在我看来它的“专业版”:)。但是对于用户-开发人员和用户-管理员在 Access 和 MSSQL 中以字符串形式表示和使用..

GUID 位于核心“仅”128 位数字中。我认为您不应该担心 JOIN 在 GUID 列上的有效性。例如，加入 GUID 列比文本列上的条件更有效。

我不认为自定义编码方案是个好主意，因为你必须解决很多事情。另一方面，GUID 是标准使用的，工具已准备好使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T06:55:17.193

你打算记录多少条记录？bigint 不够大吗？最多 9,223,372,036,854,775,807 条记录[（如果不包括负数）](http://msdn.microsoft.com/en-us/library/ms187745.aspx)

如果它仅用于插入，并且没有对数据进行选择，请选择任何方案（我仍然会说 bigint 或 GUID/uniqueidentifier）。如果您需要进行选择，int 或 bigint 比 GUID 或任何其他自定义 PK 快得多。

# visual-studio - 安装Visual Studio 2008遇到的问题

> ID：712780
> 
> 赞同：1
> 
> 时间：2009-04-03T06:52:21.863
> 
> 标签：visual-studio, visual-studio-2008, installation

我安装了 Visual Studio 2008 包 FULL 选项。它没有任何问题。我将 Vstudio 2008 和 MSDN 安装在 D 盘的单独文件夹中。2 天后，为了删除我的项目，我卸载了所有东西，还从 C:\Documents and Settings\IRCTC\My Documents 中删除了 Visual Studio 2008、Visual Studio 2005 文件夹。（我相信这两个文件夹是在我们安装 Visual Studio 时自动创建的）我还清除了 %path% 和路径（c/windows/path）。我再次安装了 VISUAL STUDIO 2008 但现在我无法创建窗口应用程序（其他 web，vb 也是），解决方案是什么......显示的错误是

c:/documents and settings/IRCTC/local settings/temp/g1zzsdl.bak/temp/windowsFormsApplication.csproj无法打开，因为这个版本的visual studio不支持项目类型（.csproj）......

是否有任何系统文件损坏（windows temp 或 Windows 中的 .net folber）.....
在我的系统中没有发现其他安装问题.....
请帮助.....
安装所需的文件/文件夹是什么……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T14:45:14.147

当您收到该错误时，通常是因为：

1.  **您正在尝试打开使用以前版本的 Visual Studio 创建的项目**（不是您的情况）
2.  **安装过程中出了点问题**（听起来像你的情况）

我会卸载这个东西并首先完全重新安装。

如果它仍然不起作用，它可能与 VS 模板有关，您可能想尝试从 Visual Studio 2008 命令提示符运行：

```
devenv /InstallVSTemplates 
```

如果它仍然不起作用，请打开 Visual Studio，在菜单中，打开工具->选项->项目和解决方案->常规。此时您会注意到项目模板的路径设置为“C:\Documents and Settings[yourUserName]\My Documents\Visual Studio 9\Templates\ProjectTemplates”或与此非常相似的内容。为了修复它，您必须将该路径设置为 C:\Program Files\Microsoft Visual Studio 9\Common7\IDE\Project Templates 或根据您安装 Visual Studio 的位置的相同路径

我认为这与 VS 项目模板无关 - 请参阅[此链接](http://www.discussweb.com/server-management/10317-csproj-not-supported-version-visual-studio-2008-a.html)

试试看会发生什么！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T07:08:07.770

您为什么不使用控制面板|添加/删除程序中提供的 Visual Studio 卸载功能？

我会如上所述卸载最新安装，然后重试。

# random - 模拟随机性

> ID：712785
> 
> 赞同：-3
> 
> 时间：2009-04-03T06:54:23.433
> 
> 标签：random, operating-system

我只是好奇...

你如何模拟随机性？它是如何在现代操作系统（Windows、Linux 等）中完成的？

编辑：好的，不仅仅是生成随机数，这可以通过调用`rand()`大多数高级编程语言中的函数来完成。

但是，我更关心它是如何在现代操作系统中实际完成的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-03T07:01:15.570

请参见：

[伪随机数发生器](https://stackoverflow.com/questions/584566/pseudo-random-number-generator)

[真随机数发生器](https://stackoverflow.com/questions/37702/true-random-number-generator)

[用于程序内容的快速伪随机数生成器](https://stackoverflow.com/questions/167735/fast-pseudo-random-number-generator-for-procedural-content)

[创建无重复的随机数序列](https://stackoverflow.com/questions/693880)

[如何在 C# 中生成随机数？](https://stackoverflow.com/questions/44408/how-do-you-generate-a-random-number-in-c)

[在 .NET 中播种随机数生成器](https://stackoverflow.com/questions/369636/seeding-a-random-number-generator-in-net)

[如何从随机字节数组值中获取随机双值？](https://stackoverflow.com/questions/403572/how-to-get-random-double-value-out-of-random-byte-array-values)

[用于程序内容的快速伪随机数生成器](https://stackoverflow.com/questions/167735/fast-pseudo-random-number-generator-for-procedural-content)

ETC...

# python - json 和 simplejson Python 模块有什么区别？

> ID：712791
> 
> 赞同：402
> 
> 时间：2009-04-03T06:56:13.243
> 
> 标签：python, json, simplejson

我见过许多项目使用**`simplejson`**模块而不是**`json`**标准库中的模块。此外，还有许多不同的`simplejson`模块。为什么要使用这些替代方案，而不是标准库中的替代方案？

* * *

## 回答 #1

> 赞同：416
> 
> 时间：2009-04-03T06:59:11.083

`json` [是](http://docs.python.org/whatsnew/2.6.html#the-json-module-javascript-object-notation) `simplejson`，添加到标准库。但是自从`json`在 2.6 中添加以来，`simplejson`它的优势在于可以处理更多的 Python 版本（2.4+）。

`simplejson`也比 Python 更频繁地更新，所以如果你需要（或想要）最新版本，最好尽可能使用`simplejson`它自己。

在我看来，一个好的做法是使用一个或另一个作为后备。

```
try:
    import simplejson as json
except ImportError:
    import json 
```

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2013-04-21T12:53:31.130

我不得不不同意其他答案：内置**`json`**库（在 Python 2.7 中）不一定比**`simplejson`**. 它也没有[这个烦人的 unicode 错误](https://code.google.com/p/simplejson/issues/detail?id=40)。

这是一个简单的基准：

```
import json
import simplejson
from timeit import repeat

NUMBER = 100000
REPEAT = 10

def compare_json_and_simplejson(data):
    """Compare json and simplejson - dumps and loads"""
    compare_json_and_simplejson.data = data
    compare_json_and_simplejson.dump = json.dumps(data)
    assert json.dumps(data) == simplejson.dumps(data)
    result = min(repeat("json.dumps(compare_json_and_simplejson.data)", "from __main__ import json, compare_json_and_simplejson", 
                 repeat = REPEAT, number = NUMBER))
    print "      json dumps {} seconds".format(result)
    result = min(repeat("simplejson.dumps(compare_json_and_simplejson.data)", "from __main__ import simplejson, compare_json_and_simplejson", 
                 repeat = REPEAT, number = NUMBER))
    print "simplejson dumps {} seconds".format(result)
    assert json.loads(compare_json_and_simplejson.dump) == data
    result = min(repeat("json.loads(compare_json_and_simplejson.dump)", "from __main__ import json, compare_json_and_simplejson", 
                 repeat = REPEAT, number = NUMBER))
    print "      json loads {} seconds".format(result)
    result = min(repeat("simplejson.loads(compare_json_and_simplejson.dump)", "from __main__ import simplejson, compare_json_and_simplejson", 
                 repeat = REPEAT, number = NUMBER))
    print "simplejson loads {} seconds".format(result)

print "Complex real world data:" 
COMPLEX_DATA = {'status': 1, 'timestamp': 1362323499.23, 'site_code': 'testing123', 'remote_address': '212.179.220.18', 'input_text': u'ny monday for less than \u20aa123', 'locale_value': 'UK', 'eva_version': 'v1.0.3286', 'message': 'Successful Parse', 'muuid1': '11e2-8414-a5e9e0fd-95a6-12313913cc26', 'api_reply': {"api_reply": {"Money": {"Currency": "ILS", "Amount": "123", "Restriction": "Less"}, "ProcessedText": "ny monday for less than \\u20aa123", "Locations": [{"Index": 0, "Derived From": "Default", "Home": "Default", "Departure": {"Date": "2013-03-04"}, "Next": 10}, {"Arrival": {"Date": "2013-03-04", "Calculated": True}, "Index": 10, "All Airports Code": "NYC", "Airports": "EWR,JFK,LGA,PHL", "Name": "New York City, New York, United States (GID=5128581)", "Latitude": 40.71427, "Country": "US", "Type": "City", "Geoid": 5128581, "Longitude": -74.00597}]}}}
compare_json_and_simplejson(COMPLEX_DATA)
print "\nSimple data:"
SIMPLE_DATA = [1, 2, 3, "asasd", {'a':'b'}]
compare_json_and_simplejson(SIMPLE_DATA) 
```

我的系统上的结果（Python 2.7.4，Linux 64 位）：

> 复杂的真实世界数据：
> json 转储 1.56666707993 秒
> simplejson 转储 2.25638604164 秒
> json 加载 2.71256899834 秒
> simplejson 加载 1.29233884811 秒
> 
> 简单数据：
> json 转储 0.370109081268 秒
> simplejson 转储 0.574181079865 秒
> json 加载 0.422876119614 秒
> simplejson 加载 0.270955085754 秒

对于倾销，`json`比`simplejson`. 对于加载，`simplejson`速度更快。

因为我目前正在构建一个 Web 服务，`dumps()`所以它更重要——并且总是首选使用标准库。

另外，`cjson`过去4年没有更新，所以我不会碰它。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2013-07-24T01:48:06.647

所有这些答案都不是很有帮助，因为它们是**时间敏感**的。

经过我自己的一些研究后，我发现它`simplejson`确实比内置更快，**如果**你将它更新到最新版本。

`pip/easy_install`想在 ubuntu 12.04 上安装 2.3.2，但是在发现最新`simplejson`版本实际上是 3.3.0 之后，我更新了它并重新运行了时间测试。

*   `simplejson``json`在加载时比内置快约 3 倍
*   `simplejson`比`json`转储时的内置速度快约 30%

### 免责声明：

上面的语句在 python-2.7.3 和 simplejson 3.3.0 中（带有 c 加速）并且为了确保我的答案也不是时间敏感的，你应该**运行自己的测试**来检查，因为它在版本之间差异很大；没有时间敏感的简单答案。

### 如何判断是否在 simplejson 中启用了 C 加速：

```
import simplejson
# If this is True, then c speedups are enabled.
print bool(getattr(simplejson, '_speedups', False)) 
```

**更新：**我最近遇到了一个名为[ujson](https://pypi.python.org/pypi/ujson)的库，它的执行速度比`simplejson`一些基本测试快约 3 倍。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2011-01-28T22:39:38.597

我一直在对 json、simplejson 和 cjson 进行基准测试。

*   cjson最快
*   simplejson 和 cjson 差不多
*   json 比 simplejson 慢大约 10 倍

[http://pastie.org/1507411](http://pastie.org/1507411)：

```
$ python test_serialization_speed.py 
--------------------
   Encoding Tests
--------------------
Encoding: 100000 x {'m': 'asdsasdqwqw', 't': 3}
[      json] 1.12385 seconds for 100000 runs. avg: 0.011239ms
[simplejson] 0.44356 seconds for 100000 runs. avg: 0.004436ms
[     cjson] 0.09593 seconds for 100000 runs. avg: 0.000959ms

Encoding: 10000 x {'m': [['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19], ['0', 1, '2', 3, '4', 5, '6', 7, '8', 9, '10', 11, '12', 13, '14', 15, '16', 17, '18', 19]], 't': 3}
[      json] 7.76628 seconds for 10000 runs. avg: 0.776628ms
[simplejson] 0.51179 seconds for 10000 runs. avg: 0.051179ms
[     cjson] 0.44362 seconds for 10000 runs. avg: 0.044362ms

--------------------
   Decoding Tests
--------------------
Decoding: 100000 x {"m": "asdsasdqwqw", "t": 3}
[      json] 3.32861 seconds for 100000 runs. avg: 0.033286ms
[simplejson] 0.37164 seconds for 100000 runs. avg: 0.003716ms
[     cjson] 0.03893 seconds for 100000 runs. avg: 0.000389ms

Decoding: 10000 x {"m": [["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19], ["0", 1, "2", 3, "4", 5, "6", 7, "8", 9, "10", 11, "12", 13, "14", 15, "16", 17, "18", 19]], "t": 3}
[      json] 37.26270 seconds for 10000 runs. avg: 3.726270ms
[simplejson] 0.56643 seconds for 10000 runs. avg: 0.056643ms
[     cjson] 0.33007 seconds for 10000 runs. avg: 0.033007ms 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-03-18T18:07:05.980

simplejson 和 json 之间的某些值的序列化方式不同。

值得注意的是， 的实例`collections.namedtuple`被序列化为数组，`json`但被序列化为对象`simplejson`。`namedtuple_as_object=False`您可以通过传递给来覆盖此行为`simplejson.dump`，但默认情况下行为不匹配。

```
>>> import collections, simplejson, json
>>> TupleClass = collections.namedtuple("TupleClass", ("a", "b"))
>>> value = TupleClass(1, 2)
>>> json.dumps(value)
'[1, 2]'
>>> simplejson.dumps(value)
'{"a": 1, "b": 2}'
>>> simplejson.dumps(value, namedtuple_as_object=False)
'[1, 2]' 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-10-14T18:19:40.753

我发现，Python 2.7 与 simplejson 3.3.1 的 API 不兼容在于输出是生成 str 还是 unicode 对象。例如

```
>>> from json import JSONDecoder
>>> jd = JSONDecoder()
>>> jd.decode("""{ "a":"b" }""")
{u'a': u'b'} 
```

对比

```
>>> from simplejson import JSONDecoder
>>> jd = JSONDecoder()
>>> jd.decode("""{ "a":"b" }""")
{'a': 'b'} 
```

如果偏好使用 simplejson，则可以通过将参数字符串强制为 unicode 来解决此问题，如下所示：

```
>>> from simplejson import JSONDecoder
>>> jd = JSONDecoder()
>>> jd.decode(unicode("""{ "a":"b" }""", "utf-8"))
{u'a': u'b'} 
```

强制确实需要知道原始字符集，例如：

```
>>> jd.decode(unicode("""{ "a": "ξηθννββωφρες" }"""))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
UnicodeDecodeError: 'ascii' codec can't decode byte 0xce in position 8: ordinal not in range(128) 
```

这是无法解决的[问题 40](https://code.google.com/p/simplejson/issues/detail?id=40)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-04-03T16:42:58.527

项目使用 simplejson 的另一个原因是内置 json 最初没有包含其 C 加速，因此性能差异很明显。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-04-03T06:57:44.800

内置`json`模块包含在 Python 2.6 中。任何支持 Python < 2.6 版本的项目都需要有一个回退。在许多情况下，回退是`simplejson`.

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-04-03T07:05:48.883

这是 Python json 库的（现已过时的）比较：

[比较 Python 的 JSON 模块](http://deron.meranda.us/python/comparing_json_modules/)（[存档链接](http://web.archive.org/web/20100814143114/http://deron.meranda.us/python/comparing_json_modules/)）

无论此比较的结果如何，如果您使用的是 Python 2.6，您都应该使用标准库 json。而且.. 还不如只使用 simplejson 。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-11-28T07:49:24.597

`json`似乎比`simplejson`最新版本的加载和转储都快

测试版本：

*   蟒蛇：3.6.8
*   json: 2.0.9
*   简单的json：3.16.0

结果：

```
>>> def test(obj, call, data, times):
...   s = datetime.now()
...   print("calling: ", call, " in ", obj, " ", times, " times") 
...   for _ in range(times):
...     r = getattr(obj, call)(data)
...   e = datetime.now()
...   print("total time: ", str(e-s))
...   return r

>>> test(json, "dumps", data, 10000)
calling:  dumps  in  <module 'json' from 'C:\\Users\\jophine.antony\\AppData\\Local\\Programs\\Python\\Python36-32\\lib\\json\\__init__.py'>   10000  times
total time:  0:00:00.054857

>>> test(simplejson, "dumps", data, 10000)
calling:  dumps  in  <module 'simplejson' from 'C:\\Users\\jophine.antony\\AppData\\Local\\Programs\\Python\\Python36-32\\lib\\site-packages\\simplejson\\__init__.py'>   10000  times
total time:  0:00:00.419895
'{"1": 100, "2": "acs", "3.5": 3.5567, "d": [1, "23"], "e": {"a": "A"}}'

>>> test(json, "loads", strdata, 1000)
calling:  loads  in  <module 'json' from 'C:\\Users\\jophine.antony\\AppData\\Local\\Programs\\Python\\Python36-32\\lib\\json\\__init__.py'>   1000  times
total time:  0:00:00.004985
{'1': 100, '2': 'acs', '3.5': 3.5567, 'd': [1, '23'], 'e': {'a': 'A'}}

>>> test(simplejson, "loads", strdata, 1000)
calling:  loads  in  <module 'simplejson' from 'C:\\Users\\jophine.antony\\AppData\\Local\\Programs\\Python\\Python36-32\\lib\\site-packages\\simplejson\\__init__.py'>   1000  times
total time:  0:00:00.040890
{'1': 100, '2': 'acs', '3.5': 3.5567, 'd': [1, '23'], 'e': {'a': 'A'}} 
```

对于版本：

*   蟒蛇：3.7.4
*   json: 2.0.9
*   简单的json：3.17.0

json 在转储操作期间比 simplejson 快，但在加载操作期间都保持相同的速度

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-08-23T01:01:02.170

simplejson 模块比 json 快 1.5 倍（在我的计算机上，使用 simplejson 2.1.1 和 Python 2.7 x86）。

如果您愿意，您可以尝试基准测试：[http](http://abral.altervista.org/jsonpickle-bench.zip) ://abral.altervista.org/jsonpickle-bench.zip 在我的 PC 上 simplejson 比 cPickle 快。我也想知道你的基准！

可能正如 Coady 所说，simplejson 和 json 之间的区别在于 simplejson 包含 _speedups.c。那么，为什么 python 开发人员不使用 simplejson 呢？

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-06-24T15:16:53.183

在python3中，如果你是一个字符串`b'bytes'`，`json`你必须`.decode()`在加载它之前使用内容。 `simplejson`照顾这个，所以你可以做`simplejson.loads(byte_string)`。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-07-07T12:51:06.257

我在为 Python 2.6 安装 simplejson 时遇到了这个问题。我需要使用 json.load() 的“object_pairs_hook”来将 json 文件加载为 OrderedDict。熟悉 Python 的更新版本后，我没有意识到 Python 2.6 的 json 模块不包含“object_pairs_hook”，因此我必须为此安装 simplejson。从个人经验来看，这就是我使用 simplejson 而不是标准 json 模块的原因。

# nhibernate - NHibernate：多对多关系不起作用

> ID：712802
> 
> 赞同：2
> 
> 时间：2009-04-03T07:00:58.067
> 
> 标签：nhibernate

我有以下数据库架构：

[http://lh4.ggpht.com/_SDci0Pf3tzU/SdM3XnAmmxI/AAAAAAAEps/Ie3xW3ZVNfQ/s400/styleerror.png](http://picasaweb.google.com/lh/photo/vbmcmlVEERL2NU159Sb_Vg?feat=embedwebsite)

这是我的映射文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="CodeSmithSampel.Generated.BusinessObjects" assembly="CodeSmithSampel">
    <class name="CodeSmithSampel.Generated.BusinessObjects.Store, CodeSmithSampel" table="store" lazy="true">
        <id name="Id" column="Id">
            <generator class="native" />
        </id>
        <property name="Name" column="Name" />
        <bag name="Employees" lazy="true" cascade="all-delete-orphan" inverse="true" >
            <key column="Store_id"></key>
            <one-to-many class="Employee"></one-to-many>
        </bag>
        <bag name="Products" table="storeproduct" lazy="true" cascade="all" inverse="true" >
            <key column="Store_id"></key>
            <many-to-many column="Product_id" class="Product" />
        </bag>
    </class>
</hibernate-mapping> 
```

这是我的商店实体类：

```
public partial class Store : BusinessBase<int>
{
    #region Declarations

        private string _name = String.Empty;

        private IList<Employee> _employees = new List<Employee>();
        private IList<Product> _products = new List<Product>();

        #endregion

    #region Constructors

    public Store() { }

    #endregion

    #region Methods

    public override int GetHashCode()
    {
        System.Text.StringBuilder sb = new System.Text.StringBuilder();

        sb.Append(this.GetType().FullName);
            sb.Append(_name);

        return sb.ToString().GetHashCode();
    }

    #endregion

    #region Properties

        public virtual string Name
    {
        get { return _name; }
            set
            {
                OnNameChanging();
                _name = value;
                OnNameChanged();
            }
    }
        partial void OnNameChanging();
        partial void OnNameChanged();

        public virtual IList<Employee> Employees
    {
        get { return _employees; }
        set
            {
                OnEmployeesChanging();
                _employees = value;
                OnEmployeesChanged();
            }
    }
        partial void OnEmployeesChanging();
        partial void OnEmployeesChanged();

        public virtual IList<Product> Products
    {
        get { return _products; }
        set
            {
                OnProductsChanging();
                _products = value;
                OnProductsChanged();
            }
    }
        partial void OnProductsChanging();
        partial void OnProductsChanged();

    #endregion
} 
```

产品类别：

```
 public partial class Product : BusinessBase<int>
    {
        #region Declarations

        private float _price = default(Single);
        private string _name = null;

        private IList<Store> _stores = new List<Store>();

        #endregion

        #region Constructors

        public Product() { }

        #endregion

        #region Methods

        public override int GetHashCode()
        {
            System.Text.StringBuilder sb = new System.Text.StringBuilder();

            sb.Append(this.GetType().FullName);
            sb.Append(_price);
            sb.Append(_name);

            return sb.ToString().GetHashCode();
        }

        #endregion

        #region Properties

        public virtual float Price
        {
            get { return _price; }
            set
            {
                OnPriceChanging();
                _price = value;
                OnPriceChanged();
            }
        }
        partial void OnPriceChanging();
        partial void OnPriceChanged();

        public virtual string Name
        {
            get { return _name; }
            set
            {
                OnNameChanging();
                _name = value;
                OnNameChanged();
            }
        }
        partial void OnNameChanging();
        partial void OnNameChanged();

        public virtual IList<Store> Stores
        {
            get { return _stores; }
            set
            {
                OnStoresChanging();
                _stores = value;
                OnStoresChanged();
            }
        }
        partial void OnStoresChanging();
        partial void OnStoresChanged();

        #endregion
    } 
```

Product 类的映射：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="CodeSmithSampel.Generated.BusinessObjects" assembly="CodeSmithSampel">
    <class name="CodeSmithSampel.Generated.BusinessObjects.Product, CodeSmithSampel" table="product" lazy="true">
        <id name="Id" column="Id">
            <generator class="native" />
        </id>
        <property name="Price" column="Price" />
        <property name="Name" column="Name" />
        <bag name="Stores" table="storeproduct" lazy="true" cascade="all" inverse="true" >
            <key column="Product_id"></key>
            <many-to-many column="Store_id" class="Store" />
        </bag>
    </class>
</hibernate-mapping> 
```

特别奇怪的是，当我将 Store 对象添加到其中一个产品时，数据库记录没有更新；尽管数据库中存在新的存储对象，但似乎没有添加：

```
 IManagerFactory managerFactory = new ManagerFactory();
        var productManager = managerFactory.GetProductManager();

        var myProduct= productManager.GetById(2);

        var myStore = new Store();
        myStore.Name = "new Store";  //a "new store" entry is created in the Store table
        myProduct.Stores.Add(myStore);  // but this "new store" is not linked to the myproduct, as it should.

       productManager.Session.CommitChanges(); 
```

有什么我想念的吗？

**注意：我使用 CodeSmith 生成上述代码。**

编辑：接受的答案有效。我遇到这个问题的原因是因为

1.  只有一个实体类应该有`inverse = true`，而不是两个。因此，Product 或 Store 都应将相反的值设置为 false。代码生成工具没有正确处理这个问题。
2.  下面解释了添加多对多关系的正确方法。您必须添加两次。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-03T07:04:16.467

这与您在 storeproducts 表中有代理键这一事实有关吗？

如果您删除此代理键列 Id，并将主键放在 product_id 和 store_id 列的组合上，会发生什么情况？

我相信，如果你想在 storeproducts 表上有一个代理键，你将不得不创建另一个实体。

如果要使用代理键，则必须使用 idbag 映射。

您的 Product 类和映射如何？我看到您在 Store 实体中 Products 集合的映射中指定了“逆”属性。

如果您这样做（因此您有一个双向关联），那么您也应该将 Store 添加到产品的 Stores 集合中。由于-来自 NH 文档-：

> 仅对关联的反向端所做的更改不会保留。这意味着 NHibernate 对于每个双向关联在内存中都有两种表示形式，一种是从 A 到 B 的链接，另一种是从 B 到 A 的链接。如果您考虑一下 .NET 对象模型以及我们如何创建多对对象，这将更容易理解-C#中的许多关系：

```
category.Items.Add(item);          // The category now "knows" about the relationship
item.Categories.Add(category);     // The item now "knows" about the relationship

session.Update(item);                     // No effect, nothing will be saved!
session.Update(category);                 // The relationship will be saved 
```

> 非逆侧用于将内存中的表示保存到数据库中。如果两者都会触发更改，我们将获得不必要的 INSERT/UPDATE 甚至可能违反外键！当然，双向一对多关联也是如此。
> 
> 您可以通过将一对多关联映射到与多对一关联一样的表列并声明多值端 inverse="true" 来映射双向一对多关联。

这意味着，只有一个末端应该是相反的。将产品添加到商店，应该这样做：

```
public class Store
{
   public void AddProduct( Product p )
   {
       if( _products.Contains (p) == false )
       {
             _products.Add (p);
             p.AddStore(this);
       }
   }
}
public class Product
{
    public void AddStore( Store s )
    {
       if( _stores.Contains (s) == false )
       {
          _stores.Add (s);
          s.AddProduct(this);
       }
    }
} 
```

（检查集合是否已经包含要添加的项目非常重要；否则您将陷入无限循环。

# .net - ADO.NET SQL Client Provider 默认数据库连接

> ID：712806
> 
> 赞同：0
> 
> 时间：2009-04-03T07:02:33.507
> 
> 标签：.net, sql-server, entity-framework, ado.net

.NET SQL 客户端 DataProvider 是否始终使用主数据库进行连接。我注意到，当我连接到数据库以执行 ADO.NET 查询然后查看 SQL Management Studio 中的活动连接时，.NET SQL 客户端提供程序的 SPID 始终使用主数据库

我的连接字符串中的初始目录是我连接的数据库的目录（这不是主目录）

“从 sys.sysprocesses 中选择 SPID、DB_NAME(dbid)、program_name，其中 program_name 像 '%.Net%'”

这是输出： [alt text http://www.freeimagehosting.net/uploads/1046babbc1.jpg](http://www.freeimagehosting.net/uploads/1046babbc1.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T10:30:04.570

SQL Server 具有默认数据库的每用户设置。登录后，您将立即进入该数据库，并且您需要对该数据库的权限才能登录。

连接字符串“初始目录”设置仅在登录后一段时间应用。

# logging - 事件源问题

> ID：712807
> 
> 赞同：1
> 
> 时间：2009-04-03T07:02:58.327
> 
> 标签：logging, event-log

为什么我的事件源名称 XXXXXXXXXXXX 中会附加一些字符？

事件查看器这样说：

找不到源 (XXXXXXXXXXXXtings\All Usõ) 中事件 ID (5) 的描述。本地计算机可能没有必要的注册表信息或消息 DLL 文件来显示来自远程计算机的消息。您可以使用 /AUXSOURCE= 标志来检索此描述；有关详细信息，请参阅帮助和支持。以下信息是事件的一部分：XXXXXXXXXXXXtings\All Usõ。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T07:30:04.270

您在将消息记录到 Windows 事件查看器时提供的 eventID 未在“消息 DLL”中定义。

# c# - 如何在列表框（asp.net）中添加复选框？

> ID：712809
> 
> 赞同：1
> 
> 时间：2009-04-03T07:03:29.667
> 
> 标签：c#, .net, asp.net

如何在列表框中添加复选框。我想在 asp.net 中制作它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T07:11:53.890

您可能想使用[CheckBoxList](http://www.w3schools.com/aspnet/control_checkboxlist.asp)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T07:13:24.527

也许[CheckBoxList](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.checkboxlist.aspx)可以解决问题？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T07:54:53.803

同意上述观点，但您的问题的具体答案（据我所知）是您不能。您只能添加从 ListItem 继承的项目。Definitley 查看 CheckBoxList。

# objective-c - 什么时候关闭 NSOutputStream？

> ID：712810
> 
> 赞同：2
> 
> 时间：2009-04-03T07:03:49.120
> 
> 标签：objective-c, cocoa, sockets, stream

我想通过套接字将 UIImage 的数据发送到服务器，所以我：

a) 打开 NSOutputStream

```
 - (IBAction)send:(id)sender {
    NSURL *website = [NSURL URLWithString:str_IP];
    NSHost *host = [NSHost hostWithName:[website host]];
    [NSStream getStreamsToHost:host port:1100 inputStream:nil outputStream:&oStream];
    [oStream retain];
    [oStream setDelegate:self];
    [oStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
    [oStream open];
} 
```

b) 当空间可用时将数据写入 oStream

```
 - (void) stream: (NSStream *) stream handleEvent: (NSStreamEvent) eventCode
{
switch(eventCode)
    {
    case NSStreamEventHasSpaceAvailable:
    {
            if(stream == oStream)
            {
                    NSData *data = UIImageJPEGRepresentation(drawImage.image, 90);
                    //Convert from host to network endianness
                    uint32_t length = (uint32_t)htonl([data length]);

                    [oStream write:(uint8_t *)&length maxLength:4];
                    [oStream write:[data bytes] maxLength:length];
            }
    }
    break;
} 
```

问题是数据不断地一次又一次地写入 oSream。发送完所有数据后如何停止它？

我在 Image 数据之前发送数据的长度，以便让服务器知道它何时到达末尾。我是否必须更改服务器端的代码才能在套接字结束时关闭它？我在哪里可以添加 [oStream close] 来关闭客户端的 oStream？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T10:37:33.507

> 问题是数据不断地一次又一次地写入 oSream。发送完所有数据后如何停止它？

看，这就是用被动语态思考的危险。用主动语态改写问题：

> 问题是数据不断地一次又一次地写入 oSream。发送完所有数据后如何停止它？

你几乎已经回答了你自己的问题。

问题的很大一部分是您的`HasSpaceAvailable`处理程序。这就是你正在做的事情：

1.  创建图像的完整 JPEG 表示（每次）
2.  发送表示的长度（每次）
3.  发送表示的第一部分（每次）

这是三个问题，您需要解决所有三个问题。

1.  一次创建 JPEG 表示。
2.  只发送一次表示的长度。
3.  跟踪您已经发送的内容，只发送您尚未发送的内容的第一部分。

要做到这三个，将长度放入 NSMutableData 并将 JPEG 表示附加到它。然后，保留这个新数据对象，并为字节指针和剩余长度添加额外的实例变量。在你到达州*之前*，你会做这一切`HasSpaceAvailable`。

然后，当您到达时`HasSpaceAvailable`，不要单独发送长度，因为您已将其放入数据对象中。您只需要从指针实例变量中发送字节，并将剩余长度作为最大长度。在检查发送的字节数不是 0 或 -1（请参阅[文档](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSOutputStream_Class/Reference/Reference.html#//apple_ref/occ/instm/NSOutputStream/write:maxLength:)）后，将其添加到指针并从剩余长度中减去它。

当剩余长度达到零时，您已发送所有内容。假设您不想跟踪 JPEG 数据，那么您可以关闭流。

# c# - 我怎么知道使用“使用”的最佳位置？

> ID：712815
> 
> 赞同：7
> 
> 时间：2009-04-03T07:06:19.333
> 
> 标签：c#, using-statement

我对 c# 有点陌生，更习惯于脚本语言。我喜欢“使用”的想法，你实例化一个对象，然后只要你需要它就在它的范围内操作，然后当它完成它的目的时让它自行处理。

但是，这对我来说并不自然。当人们向我展示使用它的示例时，我认为它是完成这项工作的好工具，但我从来没有想过在我自己的编程中用它来解决问题。

我如何识别使用的好地方`using`以及如何将它与 try-catch 块结合使用。它们是进入块内部，还是您通常想在 try 块中包含 using 语句？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-03T07:09:06.533

`using`只能与实现`IDisposable`;的类型一起使用 它保证`Dispose()`即使发生错误也会调用该方法。

这段代码：

```
using (MyDisposableType x = new MyDisposableType())
{  
    // use x
} 
```

相当于：

```
MyDisposableType x = new MyDisposableType();
try
{  
    // use x
}
finally 
{ 
    x.Dispose(); 
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-03T07:12:42.423

我很少编写 try/catch 块 - 大多数异常都会被抛出（接近）堆栈顶部。如果我*确实*需要一个 try/catch 块，我不确定将它放在`using`语句内部还是外部之间是否特别一致。这实际上取决于您是否希望在运行异常处理代码之前或之后处理资源。

如果您询问*何时*应该编写`using`语句 - 任何时候您“拥有”一个实现`IDisposable`（直接或间接通过继承）并控制其生命周期的对象。这通常是一个使用非托管资源（如文件句柄或网络连接）的对象。这并不总是非常明显，但你可以通过经验学习。几乎所有与 IO 相关的*东西都是一次性的，Windows 句柄（用于字体等）也是类似的。*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T07:13:48.457

我曾经认为它是“每次当类型实现 IDisposable 并且你不再需要这个特定实例时使用它”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T07:22:04.523

如果您想知道如何在自己的设计中创造性地使用它，请查看您自己的一些代码，以了解在退出封闭块之前绝对必须执行特定代码位的情况。这些是`try`/`finally`或`using`可以帮助您的情况。

特别是，如果你试图通过捕获所有异常来实现这一点，那么你真的必须改为`try`/`finally`或`using`改为。

如果该模式多次出现，您可以创建一个实现类`IDisposable`以捕获该模式，并允许您使用该`using`语句调用该模式。但是，如果您有一个似乎是一次性的特定案例，那么只需使用`try`/ `finally`。

两者非常相似，实际上 -`using`用`try`/指定`finally`，但即使我们只有`using`，我们也可以自己构建`try`/ `finally`：

```
public class DisposeAnything : IDisposable
{
    public Action Disposer;

    public void Dispose()
    {
        Disposer();
    }
} 
```

现在你可以说：

```
using (new DisposeAnything 
      {
          Disposer = () => File.Delete(tempFileName) 
      })
{
    // blah
} 
```

这与以下内容相同：

```
try
{
    // blah
}
finally
{
    File.Delete(tempFileName);
} 
```

只需将其视为在离开作用域时执行某些代码的一种方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T07:13:09.910

什么米奇说，加上..

您可以在 try..catch 块外部或内部使用 using 语句，这实际上取决于您要实现的目标，即您是否合理地期望在使用您计划从中恢复的特定对象时抛出异常，例如.

同样，如果需要，您还可以在 finally 块中处理实现 IDisposable 的对象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-03T07:14:01.437

当您需要确定性对象处理时使用*using 。*例如，如果您打开一个文件，该文件将被锁定。您通常希望尽快关闭文件，以便其他程序可以访问它。如果您不使用*using*和 write smth，例如：

```
System.IO.FileStream writeStream = new System.IO.FileStream( fileName, System.IO.FileMode.OpenOrCreate ) );
System.IO.BinaryWriter writer = new System.IO.BinaryWriter( writeStream ) );
//do smth 
```

并且在“do smth”期间发生异常，您不知道在文件上操作的对象何时真正被释放并且文件被关闭。使用*using*你肯定知道，一旦你离开*using*语句块——直接或通过异常，通过调用 IDisposable::Dispose 来处理*using语句中的对象：*

```
using( System.IO.FileStream writeStream = new System.IO.FileStream( fileName, System.IO.FileMode.OpenOrCreate ) ) {
    using( System.IO.BinaryWriter writer = new System.IO.BinaryWriter( writeStream ) ) {
        //do stmth
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-03T07:14:37.397

您可以将 using 包含在 try/catch 块中，也可以将 try/catch 块包含在 using 中。

使用很好的一种情况是当您使用 DBConnection 和 DBCommands 进行数据库操作时：

```
using (SqlConnection conn = new SqlConnection(connectionString))
using (SqlCommand command = new SqlCommand(sql, conn))
{
  // do something here
} 
```

现在，当您离开 using 块时，您的命令将被释放并关闭连接。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-03T07:16:26.610

米奇说的是对的。因此 using 的主要用途是确保 IDisposable 对象得到处理，*而*无需编写 try/catch 或 try/finally 语句。

现在，还有一个更高级的用法，您可能也会觉得有趣。当您使用 using 语句时，编译器会生成一个 try/finally，并且它还会在它生成的 finally 内部为您生成对 Dispose() 的调用。您可以将此 Dispose() 方法用作“钩子”来做任何您想做的事情……不必与释放资源相关。

例如，Jeffrey Richter 在他编写的计时器对象中使用了它。你可以用它做这样的事情（仅限概念）：

```
using(var x = new Timer())
{
  // Do the operation you want timed
}

// Now, the timer has been stopped, because the 
// compiler-generated call to Dispose() has already 
// occurred, and Jeffrey uses Dispose() to stop 
// the timer. 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-03T07:42:31.337

如果一个类实现了 IDisposable，这可能是有充分理由的。所以任何实现 IDisposable 的类都应该被释放。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-03T07:58:55.683

鉴于它是所谓的“语法糖”，并且会产生与 try/finally dispose 构造相同的 IL，它实际上只是一种“简化”此类代码的好方法。

我喜欢使用它来简化大量使用一次性对象的代码部分，即访问文件和图形对象等资源，并且我想确保我不会忘记处理资源对象的处理。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-03T08:00:31.747

我注意到，当已知 Dispose 方法会发出通知时，程序员不会费心调用它，因为它看起来毫无意义。但是，如果对象实现 IDisposable 它（希望）是有原因的，并且该对象的未来版本实际上可能在 Dispose 方法中有代码 - 所以总是调用它。

# c++ - APC 可以中断 WSAWaitForMultipleEvents 吗？

> ID：712822
> 
> 赞同：1
> 
> 时间：2009-04-03T07:08:19.423
> 
> 标签：c++, winapi, apc

APC（异步过程调用）可以中断 WSAWaitForMultipleEvents() 吗？(C++)

MSDN 没有在 APC 页面 ( [http://msdn.microsoft.com/en-us/library/ms681951.aspx](http://msdn.microsoft.com/en-us/library/ms681951.aspx) ) 上列出此 WSAWaitForMultipleEvents( )。

我现在没有视觉工作室来尝试它。

有人可以告诉我吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-15T18:01:05.260

好吧，WSAWaitForMultipleEvents ( [http://msdn.microsoft.com/en-us/library/ms742219.aspx](http://msdn.microsoft.com/en-us/library/ms742219.aspx) ) 的文档表明它可以进入警报状态；它还说当前实现调用 WaitForMultipleObjectsEx（显式 APC 函数之一），所以答案是肯定的。

# plugins - 具有“插件”能力的 ASP.NET 内网应用程序

> ID：712836
> 
> 赞同：0
> 
> 时间：2009-04-03T07:13:33.763
> 
> 标签：plugins, module, asp.net-3.5

我正在开发一个旨在成为 Intranet 应用程序的 ASP.NET 3.5 站点。怎么可能创建一种“插件”架构，这样我就可以在不重新编译站点的情况下向站点添加附加功能？我正在考虑将附加功能作为开发单独的*模块*，这些模块可以编译成可以“添加”到站点的 DLL。不知道这是否是处理这类事情的正确方法。我知道 DotNetNuke 可以满足这一点，您可以为此开发“模块”，但出于学习的目的，我想知道这是如何实现的？

我不知道这是否是要遵循的路线，或者我是否应该满足一切，并赋予某些功能*打开*或*关闭*的能力？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T07:22:38.203

这并不像听起来那么容易。

最简单的解决方案是使用框架和固定布局。然后每个框架将请求一个特定页面，该页面将被路由到一个插件。渲染单个页面的部分要困难得多。

对于插件的发现，最简单的解决方案是 IOC 框架，它可以为您提取依赖项（插件）。

# php - 您如何在基于 PHP 的典型 CMS 构建中存储数据库凭据？

> ID：712841
> 
> 赞同：1
> 
> 时间：2009-04-03T07:15:05.663
> 
> 标签：php, content-management-system, database-permissions

在 CMS 中存储数据库凭据的最佳做法是什么？现在我在我的数据库单例类中声明它们：

```
$this->credentials = array("hostname"=>"hostname", "username"=>"username","password"=>"password", "database"=>"database"); 
```

但是搜索在哪里更改它们并不是那么直观，而且我计划稍后为 cms 制作安装文件。

您在哪里以及如何存储您的连接偏好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T07:36:00.853

CakePHP 使用一个名为 database.php 的配置文件（在 /app/config/ 中），其中声明了一个 DATABASE_CONFIG 类：

```
class DATABASE_CONFIG {

    var $default = array(
        'driver' => 'mysql',
        'persistent' => false,
        'host' => 'localhost',
        'login' => 'user',
        'password' => 'password',
        'database' => 'database_name',
        'prefix' => '',
    );

    var $test = array(
        'driver' => 'mysql',
        'persistent' => false,
        'host' => 'localhost',
        'login' => 'user',
        'password' => 'password',
        'database' => 'test_database_name',
        'prefix' => '',
    );
} 
```

这创建了一个用户可以设置所有数据库配置的地方，而直观的目录结构使存储数据库配置的位置一目了然。并且您还可以为生产、开发和测试目的指定多种配置，它们之间很容易切换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T07:39:12.407

作为一般规则，我不会将凭据直接放入源代码中，而是将它们存储在配置文件中。这使得更改它们变得更加容易，例如当您从开发机器移动到测试机器时，它可能（应该）连接到不同的数据库。

此配置文件应存储在 webroot 目录之外的某个位置。

您还可以通过某种方式对密码进行加密，以便在配置文件被泄露的情况下更加安全。另一方面，如果有人可以物理访问您的服务器，那么您无论如何都会被搞砸，所以这可能不值得。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T04:38:38.883

正如您所提到的，您可以使用单例类或更简单的方法。

在我所有的 config.inc.php 文件中，我有一个标准的关联数组

```
$config['Main_Database'] = '';
$config['db_user'] = '';
$config['db_pass'] = '';
$config['db_host'] = ''; 
```

这个概念是相同的，你在正确的轨道上。作为人类，让它成为对你有意义的东西。如果有人可以访问您的服务器，那么无论如何您都搞砸了，所以就更安全而言，这并不是什么大问题。

至于安装文件，我见过很多应用程序打开配置文件，通过代码调整一些特定部分，然后实际将文件重新写入服务器（而不是“存储设置”）。它实现了相同的结果，但通过向导而不是手动完成。

# .net - .NET 中的环境对象

> ID：712844
> 
> 赞同：1
> 
> 时间：2009-04-03T07:16:37.547
> 
> 标签：.net, design-patterns

如何在 .NET 中创建可在整个方法链中使用的环境对象。例如 TransactionScope 对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T07:34:20.750

但是，如果您使用 ASP.NET，则应该查看[HttpContext.Items](http://www.odetocode.com/Articles/111.aspx)，因为 ASP.NET 引擎将在处理请求时切换线程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T07:23:28.060

查看 ThreadStaticAttribute 或 CallContext 类。

# c++-cli - C++/CLI-问题：是否有与 C#“is”关键字等效的方法，还是我必须使用反射？

> ID：712845
> 
> 赞同：15
> 
> 时间：2009-04-03T07:17:35.390
> 
> 标签：c++-cli

我在 MSDN 上的某处读到，与 C# 的“is”关键字等效的是 dynamic_cast，但这并不是真正等效的：它不适用于值类型或泛型参数。例如，在 C# 中，我可以编写：

```
void MyGenericFunction<T>()
{
    object x = ...
    if (x is T)
        ...;
} 
```

如果我尝试“等效”C++/CLI：

```
generic<class T>
void MyGenericFunction()
{
    object x = ...
    if (dynamic_cast<T>(x))
       ...;
} 
```

我收到编译器错误“错误 C2682：无法使用 'dynamic_cast' 将 'System::Object ^' 转换为 'T'”。

我唯一能想到的就是使用反射：

```
if (T::typeid->IsAssignableFrom(obj->GetType())) 
```

有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-03T08:02:30.057

它在 MSDN 上：

[如何：在 C++ 中实现 is 和 as C# 关键字](http://msdn.microsoft.com/en-us/library/85af44e9.aspx)

简而言之，您需要编写一个辅助函数，如下所示：

```
template < class T, class U > 
Boolean isinst(U u) {
   return dynamic_cast< T >(u) != nullptr;
} 
```

并这样称呼它：

```
Object ^ o = "f";
if ( isinst< String ^ >(o) )
    Console::WriteLine("o is a string"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T08:00:39.453

您可以使用在本机 C++ 中使用的`safe_cast`位置`dynamic_cast`并捕获 System::InvalidCastException。就*兼容类型*而言，询问是否可以转换类型的语义可以选择比检查身份更广泛的类型。您实际上可能想要 IsAssignableFrom 增加的灵活性。

我不认为有一个有效的等价于`dynamic_cast`我们习惯的古老成语，当然没有什么比这更紧凑了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-23T22:07:10.670

虽然一个简单的解决方法是使用`safe_cast<T>(x)`和 catch `System::InvalidCastException^`，但当类型不匹配时，这会产生明显的异常处理开销（展开堆栈和所有相关的乐趣）。

我试图想出一种不同的方法。虽然我不会完全称它为*simple*，但它在不使用异常的情况下完成了它的工作。

```
#using <System.Core.dll>

namespace detail
{
    generic <typename T> ref class is_instance_of_managed_helper sealed abstract
    {
    public:
        static initonly System::Func<System::Object^, bool>^ is_instance_of = build();

    private:
        static System::Func<System::Object^, bool>^ build()
        {
            using System::Linq::Expressions::Expression;
            auto param = Expression::Parameter(System::Object::typeid);
            return Expression::Lambda<System::Func<System::Object^, bool>^>(
                Expression::TypeIs(param, T::typeid),
                param)->Compile();
        }
    };

    template <typename T> struct is_instance_of_helper
    {
        static bool is_instance_of(System::Object^ obj)
        {
            return is_instance_of_managed_helper<T>::is_instance_of(obj);
        }
    };

    template <typename T> struct is_instance_of_helper<T^>
    {
        static bool is_instance_of(System::Object^ obj)
        {
            return dynamic_cast<T^>(obj) != nullptr;
        }
    };
}

template <typename T> bool is_instance_of(System::Object^ obj)
{
    return detail::is_instance_of_helper<T>::is_instance_of(obj);
} 
```

一点解释：

*   `is_instance_of_managed_helper`是一个托管类，它在运行时生成一个函数，相当于 C# 的`is`运算符。它用于[`Expression::TypeIs`](https://msdn.microsoft.com/en-us/library/system.linq.expressions.expression.typeis.aspx)以简单的方式实现这一目标。一个这样的函数将为每个生成*一次*`T`。

*   `template <typename T> struct is_instance_of_helper`是一个简单地使用上述解决方案的模板结构。这是一般情况。

*   `template <typename T> struct is_instance_of_helper<T^>`是上述结构的部分特化，`dynamic_cast`用于托管句柄类型。这样，当`T`可以简单地与`dynamic_cast`.

*   `template <typename T> bool is_instance_of(System::Object^ obj)`是选择要使用的模板的最终辅助函数。

# wcf - svcutil 从生成的接口代理中省略 ServiceKnownType 属性

> ID：712849
> 
> 赞同：5
> 
> 时间：2009-04-03T07:18:47.447
> 
> 标签：wcf, svcutil.exe

当我尝试从 MSDN 实现 ServiceKnownType 示例时遇到了一个问题。在示例中，它们提供以下类：

```
[DataContract()]
public class Widget
{
    [DataMember]
    public string Id;
    [DataMember]
    public string Catalog;
}

[DataContract()]
public class Machine : Widget
{
    [DataMember]
    public string Maker;
} 
```

以及如下界面：

```
[ServiceKnownType(typeof(Widget))]
[ServiceKnownType(typeof(Machine))]
[ServiceContract()]
public interface ICatalog
{
    [OperationContract]
    Hashtable GetItems();
} 
```

问题是在生成代理类时（使用“添加服务引用”/svcutil.exe），ICatalog 代理接口中省略了“ServiceKnownType”属性，导致出现异常“The formatter throw an exception while trying to反序列化消息：......将'Widget'对应的类型添加到已知类型列表中”为了解决这个问题，我必须手动将服务已知属性添加到生成的代理接口，这是一个非常糟糕的解决方案，因为代码会重新生成当我更新参考。在所有这种情况下，有趣的是，如果 GetItems 操作将返回对象而不是 Hashtable，或者将对象作为参数，那么问题将得到解决，即

```
[OperationContract]
object GetItems(); 
```

或者

```
[OperationContract]
Hashtable GetItems(object obj); 
```

导致 IATAlog 代理接口上存在“ServiceKnownType”属性。有谁知道如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-09-21T06:49:48.463

我今天花了几个小时，据我所知，这是完全相同的问题。我的解决方案是使用 IDesign 的 ServiceModelEx 库中的 AddGenericResolver 方法。

注意：需要 .NET 4.0，因为它使用[DataContractResolver](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractresolver.aspx)

您可以在[IDesign 下载页面](http://www.idesign.net/idesign/DesktopDefault.aspx?tabindex=5&tabid=11)上找到它。

在我的情况下，我所要做的就是添加以下代码行：

```
Client.AddGenericResolver( typeof ( K2Source ) ); 
```

我希望这可以帮助其他人节省几个小时！

您可以在 Juval Lowy 所著的《Programming WCF Services: Mastering WCF and the Azure AppFabric Service Bus》一书中找到更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T07:40:24.760

似乎是一个相关的[问题](http://social.msdn.microsoft.com/forums/en-US/wcf/thread/4911eb56-d683-4445-bfd8-cdac3ae18ea9)。

您是否尝试返回通用的小部件字典并放入`[KnownType(typeof(Machine))]`小部件类？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-21T12:40:47.930

svcutil 忽略 ServiceKnownType 的问题仍然存在。我的解决方案是以编程方式将“已知类型”添加到客户端合同参考：

```
var client = new ServiceReferenceClient("clientEndpoint");
foreach (var o in client.Endpoint.Contract.Operations)
{
   o.KnownTypes.Add(typeof(MyType01));
   o.KnownTypes.Add(typeof(MyType02));
   o.KnownTypes.Add(typeof(MyType03));
} 
```

这不是完美的解决方案（必须在客户端硬编码），但它对我有用。

# jquery - 如何将 jQuery 绑定到一个指向onclick 函数的链接？

> ID：712851
> 
> 赞同：6
> 
> 时间：2009-04-03T07:20:23.060
> 
> 标签：jquery

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-03T12:51:15.353

要扩展 Michael，您需要添加 return false；

```
$("#clicked_link").click(function(){
    $("#login").slidedown("slow");
    return false;
}); 
```

否则，当您单击该链接时，浏览器仍会尝试跟踪该链接，您将丢失 javascript 操作。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-03T07:25:31.237

使用 id 属性命名具有点击事件的锚点/链接。

例如：

```
<a href="..." id="clicked_link">...</a> 
```

然后使用下面的 jquery 语句：

```
$("#clicked_link").click(function(){ $("#login").slidedown("slow"); }); 
```

非常简单！

# html - 使用 XSLT 修改值

> ID：712853
> 
> 赞同：1
> 
> 时间：2009-04-03T07:21:47.517
> 
> 标签：html, xml, xslt

我有以 SI 单位 (m, N) 表示的值的 XML 文件。我使用 XSLT 文档将其转换为 HTML 页面，在该页面中我想用其他单位（嗯，mN）显示值。

有没有一种方法可以修改我使用 XSLT 从 XML 文档中提取的值，而无需在 XSLT 处理之前修改 XML 内容？

在此先感谢您的帮助

伯特兰

* * *

只是要注意其他有趣的人。我正在使用 Python 进行开发，并且 lxml 库允许您在 XSLT 中调用扩展。

[http://lxml.de/extensions.html](http://lxml.de/extensions.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T07:26:01.797

您可以[在 XPath 表达式中进行数学运算](http://www.w3.org/TR/xquery/#id-arithmetic)：

```
<!-- divide somevalue by 1000 --> 
<xsl:value-of select="somevalue div 1000.0" /> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-03T07:31:33.517

如果您使用 c# 运行 xslt 转换，并且 Xpath 的数学功能不足以满足您的要求，您可以从 xslt 调用 c# 类中的方法，这将允许您调用 c# 来执行您的数学，然后将值返回到您的 xslt。搜索 c# xslt 扩展。

# sql - SQL中的日期时间格式

> ID：712854
> 
> 赞同：0
> 
> 时间：2009-04-03T07:22:01.933
> 
> 标签：sql, sql-server, datetime, formatting

我需要以这样的方式编写 sql 查询，它将以以下格式检索日期 dd MM yyyy HH mm ss AM（或 PM）

例如 31 12 2009 12 45 06 AN

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T08:13:20.140

我建议在中间层/层或客户端格式化字符串。用各种格式化方法就简单多了……这是表示要求，那你为什么不在表示层格式化呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T07:28:54.693

您可以查看 MSDN 上的[CAST 和 CONVERT](http://msdn.microsoft.com/en-us/library/ms187928.aspx)。

```
SELECT CONVERT(VARCHAR(30), datetime_field, 130) AS formatted_date 
```

**130**会将日期转换为以下格式：dd mon yyyy hh:mi:ss:mmmAM（或 PM ）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T07:47:45.350

很难让它变得更加低效，但是这里有

```
DECLARE @GetDate DATETIME
SET @GetDate = '01-01-2009 13:10:20'
SELECT 
  CAST(DATEPART(dd, @GETDATE) AS VARCHAR(2)) + ' '
  + CAST(DATEPART(mm, @GETDATE) AS VARCHAR(2)) + ' '
  + CAST(DATEPART(yyyy, @GETDATE) AS VARCHAR(4)) + ' '
  + CAST(DATEPART(hh, @GETDATE)%12 AS VARCHAR(2)) + ' '
  + CAST(DATEPART(mi, @GETDATE) AS VARCHAR(2)) + ' '
  + CAST(DATEPART(ss, @GETDATE) AS VARCHAR(2)) + ' '
  + CASE WHEN DATEPART(hh, @GETDATE) > 12 THEN 'AM' ELSE 'PM' END 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T07:59:51.030

如果您使用的是 SQL 2005 和 2008，一个好方法是编写一个 CLR 过程来为您进行格式化。.NET 框架为各种数据类型提供了非常强大的格式化例程，当您想在数据库级别进行格式化时，利用它们是有意义的。

尽管这是否应该是这种情况当然值得商榷。鉴于数据库的主要工作是存储和检索数据，我可以理解 SQL Server 团队不向后弯腰以支持灵活格式的理由。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T07:23:54.173

使用 DATE_FORMAT 函数。这是格式的参考：http: [//dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-format](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-format)

# c# - 绑定到 UserControl 会导致 ManagedRuntimeError

> ID：712856
> 
> 赞同：0
> 
> 时间：2009-04-03T07:22:17.157
> 
> 标签：c#, silverlight, data-binding, xaml

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T07:37:53.127

MyClass 需要实现 INotifyPropertyChanged：[http ://weblogs.asp.net/joelvarty/archive/2008/11/17/silverlight-databinding-the-observable-collection.aspx](http://weblogs.asp.net/joelvarty/archive/2008/11/17/silverlight-databinding-the-observable-collection.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T00:01:27.303

事实证明，被绑定的属性必须是 a `DependencyProperty`。

# regex - 为什么我的非贪婪 Perl 正则表达式不匹配？

> ID：712867
> 
> 赞同：5
> 
> 时间：2009-04-03T07:27:56.147
> 
> 标签：regex, perl, greedy, regex-greedy

我以为我在合理程度上理解 Perl RE，但这让我感到困惑：

```
#!/usr/bin/perl
use strict;
use warnings;

my $test = "'some random string'";

if($test =~ /\'?(.*?)\'?/) {
       print "Captured $1\n";
       print "Matched $&";
}
else {
       print "What?!!";
} 
```

印刷

> 捕获
> 的匹配 '

似乎它与结尾 ' 单独匹配，因此没有捕获任何内容。
我原以为它会匹配整个事物，或者如果它完全不贪婪，则什么都没有（因为所有事物都有一个可选匹配）。
这中间的行为让我感到困惑，谁能解释发生了什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-03T08:19:03.840

`\'?`开头和结尾的意思是贪婪*地匹配 0 或 1 撇号*。（正如另一位海报所指出的那样，为了使其不贪婪，它必须是`\'??`）

中间`.*?`的意思*是非贪婪地匹配 0 个或多个字符*。

Perl 正则表达式引擎将查看字符串的第一部分。它将匹配开头，但如此贪婪，所以它拿起第一个撇号。然后它以非贪婪方式匹配（因此尽可能少地匹配），然后是一个可选的撇号。这与空字符串匹配。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T07:57:03.720

`pattern?`是贪婪的，如果你想让它不贪婪，你必须说`pattern??`：

```
#!/usr/bin/perl
use strict;
use warnings;

my $test = "'some random string'";

if($test =~ /\'?(.*?)\'?/) {
       print "Captured [$1]\n";
       print "Matched  [$&]\n";
}
if($test =~ /\'??(.*?)\'??/) {
       print "Captured [$1]\n";
       print "Matched  [$&]\n";
} 
```

来自 perldoc perlre：

> 识别以下标准量词：
> 
> ```
> *      Match 0 or more times
> +      Match 1 or more times
> ?      Match 1 or 0 times
> {n}    Match exactly n times
> {n,}   Match at least n times
> {n,m}  Match at least n but not more than m times 
> ```
> 
> 默认情况下，量化的子模式是“贪婪的”，也就是说，它会尽可能多地匹配（给定一个特定的起始位置），同时仍然允许模式的其余部分匹配。如果您希望它匹配尽可能少的次数，请在量词后面加上“？”。请注意，含义不会改变，只是“贪婪”：
> 
> ```
> *?     Match 0 or more times
> +?     Match 1 or more times
> ??     Match 0 or 1 time
> {n}?   Match exactly n times
> {n,}?  Match at least n times
> {n,m}? Match at least n but not more than m times 
> ```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T07:57:21.130

我认为你的意思是：

```
/'(.*?)'/      // matches everything in single quotes 
```

或者

```
/'[^']*'/      // matches everything in single quotes, but faster 
```

单引号不需要转义，AFAIK。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T07:58:56.383

注意不要让你的正则表达式的所有元素都是可选的（即所有元素都用 * 或 ? 量化）。这让 Perl 正则表达式引擎可以尽可能多地匹配（甚至不匹配），同时仍然认为匹配成功。

我怀疑你想要的是

```
/'(.*?)'/ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-16T19:33:19.383

我想说最接近您正在寻找的答案是

```
/'?([^']*)'?/ 
```

因此，“如果存在则获取单引号”，“获取不是单引号的任何内容”，“如果存在则获取最后一个单引号”。

除非你想匹配“'don't do this'” - 但是谁在单引号中使用撇号（并且长期使用它）？:)

# c# - 窗口服务

> ID：712870
> 
> 赞同：-3
> 
> 时间：2009-04-03T07:28:41.403
> 
> 标签：c#, windows-services

是否可以创建一个在机器关闭之前无法停止的 Windows 服务。因为我想与服务一起运行我的应用程序之一，是否可以这样做？

谢谢，请告诉我如何将我的应用程序与服务一起运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T14:21:02.080

您不能创建在 Windows 中不可终止的进程。否则 Windows 会对关键进程执行此操作（杀死 csrss.exe 以快速获得 BSOD）。通过仔细设置服务和进程 ACL，您可以使其变得更加困难，但这总是可以通过获取所有权和调试权限来解决。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T07:50:26.280

因此，您要求的是在 Windows 关闭之前无法终止的 Windows 服务，那么您想知道是否有办法将程序附加到该服务以便它也不能终止？

我可能是错的，但我怀疑 Windows 是否会给你机会来创建一个程序并将其附加到一个服务上，除非你拔掉插头，否则它不可能被杀死。我猜您将不得不编写某种额外的程序来监视当前的程序，以便在关闭时可以重新启动它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-02T07:03:09.913

通过将SERVICE_STATUS结构的dwControlsAccepted指定为只接受关闭，可以使Windows服务不可停止。然后使用setservicestatus来应用状态。但是进程可以被杀死。防止通过scm停止服务

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-24T08:02:51.650

正如其他人（尤其是 Richard）所指出的那样，几乎不可能使 Windows 进程“无法杀死”。

如果您的目标是 24/7 全天候运行您的应用程序，我建议使用[AlwaysUp 之](http://www.CoreTechnologies.com/products/AlwaysUp)类的产品，它会将您的应用程序作为服务启动，密切监视它，并在它因任何原因失败时迅速重新启动它。

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T07:49:23.943

一种方法是设置另一个服务或计划任务来监视服务并重新启动它。

这种方法的价值实际上取决于您的任务的性质。我已经看到这种方法用于保持稍微不稳定的服务存活（这是一个遗留系统，团队没有时间立即重写它，所以他们用它作为创可贴）。

# process - 保存进程的内存供以后使用？

> ID：712876
> 
> 赞同：33
> 
> 时间：2009-04-03T07:30:31.897
> 
> 标签：process, operating-system

是否可以暂停进程，将内存内容保存到文件，然后重新加载文件以便继续程序？

**编辑** 我一直在阅读这个：

[http://en.wikipedia.org/wiki/Setcontext](http://en.wikipedia.org/wiki/Setcontext)

是否可以转储结构的内容，并以某种方式强制 malloc 分配相同的内存区域？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-03T07:33:34.697

从技术上讲这是可能的，但它也需要保存所有系统分配的资源状态 - 例如文件描述符，然后恢复它们。所以这是一项具有挑战性的任务。

实现你想要的最简单的方法是使用像 VMWare 这样的虚拟机。当您暂停它时，您实际上保存了整个机器状态以及所有正在运行的程序。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-03T07:43:30.150

这通常称为[持久延续](http://en.wikipedia.org/wiki/Continuation)。一些语言，如 SmallTalk 和 SBCL，对持久延续具有一流的支持。大多数语言都没有。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-03T08:03:19.947

根据您的要求和操作系统，您可以尝试强制[核心转储](http://en.wikipedia.org/wiki/Core_dump)

除了在 gdb 中，我从未尝试过实际加载核心转储程序备份。正如Sharptooth指出的那样，您打开的任何文件或不在程序内存中的任何其他状态似乎都会丢失。

另一种方法是简单地序列化您需要在程序中存储的状态。这很糟糕，但它可能是最可靠的方法，除非你满足于暂停程序的执行。这可以通过您的操作系统的线程库来完成。或者正如一张海报用你的外壳指出的那样。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T07:37:06.717

那么java有序列化，它就在它附近的某个地方。尽管您不能将其执行到最低级别，例如 CPU 寄存器内存地址等，因为这将要求 os 处于与您“暂停”进程时相同的状态。

作为 linux 内核模块，这可能是一个很好的项目 :-)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-21T13:57:53.253

引用“[持久（休眠！）将进程状态保存到磁盘以进行更快的加载](http://social.msdn.microsoft.com/Forums/en-MY/vcgeneral/thread/19162dfa-f994-405d-8746-b5173c93d27b)”（原文如此）：

> 问：您能否详细解释一下这种交换是如何工作的，以便将进程状态保存在磁盘中并在需要时重复使用？
> 
> A. 这很简单。页面文件是磁盘上的一个特殊位置，非活动进程以高度优化的方式存储在其中。当此类进程恢复运行时，系统会自动将其读回内存，并从原来的位置继续。这有点像程序在 iPad 上的运行方式 :)
> 
> 所有这些功能都已内置在 Windows 中。当您的进程继续运行时，系统会确保它在内存中或在页面文件中（尽管有很少的例外，您可以忽略）。

换句话说，Windows 已经能够将进程休眠到页面文件。@MSalters 引用 Raymond Chen[的话“解释为什么不可能](http://blogs.msdn.com/b/oldnewthing/archive/2004/04/20/116749.aspx)”是完全错误的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-03T07:40:03.543

正如sharptooth 提到的那样，在处理本机代码时，它是混乱到不可能的地步。

但是，一些程序（例如 iirc emacs）使用“转储我自己的内存”技巧来保存配置，而不是处理配置文件。但是，这在 Windows 上不起作用，因为可执行文件在拒绝写入共享模式下运行。但这是 linux 或 DOS 上的一个可爱（尽管危险）的把戏 :)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T07:34:27.487

.NET 3.0 及更高版本中的 Workflow Foundation 允许停止和重新启动工作流。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T08:42:01.757

Raymond Chen[解释了](http://blogs.msdn.com/oldnewthing/archive/2004/04/20/116749.aspx)为什么这是不可能的。显然，并非所有 Microsoft 工程师都阅读此内容，因为 Visual Studio 编译器在预编译头文件时会这样做。它在第一次编译头文件后转储自己的状态，并恢复自己继续。

# django - 如何获取通用视图的反向 URL？

> ID：712878
> 
> 赞同：8
> 
> 时间：2009-04-03T07:32:01.877
> 
> 标签：django, reverse

这是我如何为通用视图 object_detail 使用反向的问题？

如果我像下面这样使用它，错误消息将是： NoReverseMatch at /comment/add/ Reverse for '' with arguments '()' and keyword arguments '{}' not found。

在views.py中：

```
urlresolvers.reverse('django.views.generic.list_detail.object_detail')
              return HttpResponseRedirect(resp) 
```

在 urls.py

```
common_info_dict = {
    'extra_context':{
         'blogtitle':"Thinking",
         'blogsubtitle':"- blog system",
         'articles_count':Entry.objects.count,
         'comments_count': 0,
         'visitors_count' : 0,
         'category_list':Category.objects.all,
         'tag_list':Tag.objects.all,
         'comment_form': CommentForm,
    },
}

object_detail_info_dict = {
    'queryset': Entry.objects.all(),
    'slug_field': 'slug',
    'template_object_name': 'post',
}

object_detail_info_dict.update(common_info_dict)

    urlpatterns += patterns('django.views.generic.list_detail',
       (r'^posts/(?P<slug>[-\w]+)/$', 'object_detail', object_detail_info_dict),
    ) 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-03T08:21:10.357

在通用视图中使用反向的唯一方法 -[命名 urls](http://docs.djangoproject.com/en/dev/topics/http/urls/#id2)配置。

```
urlpatterns += patterns('django.views.generic.list_detail',
  (r'^posts/(?P<slug>[-\w]+)/$', 'object_detail',
                          object_detail_info_dict, 'post_detail'),
)

reverse('post_detail', args=('foobar',)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-06T15:14:21.737

这个问题似乎是针对旧版本的 Django 的。我不熟悉旧的通用视图是如何工作的。但是新的基于类的通用视图也有同样的问题。

反向不能“开箱即用”，因为 View.as_view() 每次都返回一个不同的包装函数，并且它们之间的比较不相等，因此 reverse() 无法通过比较两个来找到反向路径不相等的函数。

还有另一种方法，虽然它是非标准的。这就是我为基于类的视图所做的：

```
class OrderView(LoginRequiredMixin, CreateView):
    model = Order
    form_class = OrderForm

OrderView.plain_view = staticmethod(OrderView.as_view()) 
```

在这种情况下，我用来表示不带参数`plain_view`返回的视图。`as_view()`如果您将参数传递给`as_view()`，那么它返回的包装器实际上将与普通包装器不同。因此，如果您需要两者，则必须将它们分配给不同的属性：

```
OrderView.plain_view = staticmethod(OrderView.as_view())
OrderView.bonk_view = staticmethod(OrderView.as_view(whee='bonk')) 
```

您可以链接到以下视图属性`urls.py`：

```
urlpatterns = patterns('',
    url(r'^order/$', views.OrderView.plain_view),
    url(r'^frob/$', views.OrderView.bonk_view), 
```

然后您可以通过反转视图属性来反转它们：

```
def get_success_url(self):
    return reverse(OrderView.plain_view)

def get_failure_url(self):
    return reverse(OrderView.bonk_view) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-02T02:46:07.487

我找到了最好的解决方案，使用 reverse_lazy()：

[https://docs.djangoproject.com/en/1.5/ref/urlresolvers/#reverse-lazy](https://docs.djangoproject.com/en/1.5/ref/urlresolvers/#reverse-lazy)

# wcf - WCF 性能 net.tcp 与命名管道

> ID：712882
> 
> 赞同：12
> 
> 时间：2009-04-03T07:34:20.280
> 
> 标签：wcf, performance

从 net.tcp 切换到命名管道绑定有什么性能优势？

询问，因为我们在让命名管道工作时遇到了一些问题，因此想知道是否值得付出努力。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-03T07:41:19.937

在[Programming WCF Services](https://rads.stackoverflow.com/amzn/click/com/1491944838)的第一章中，Juval Lowy 提供了选择正确绑定的流程图：

[![在此处输入图像描述](https://i.stack.imgur.com/rsh9q.jpg)](https://i.stack.imgur.com/rsh9q.jpg)

请参见：

*   [Windows Communication Foundation (WCF) 与现有分布式通信技术的性能比较](http://msdn.microsoft.com/en-us/library/bb310550.aspx)- MSDN 文章。

*   [.NET 进程间通信的最佳选择是什么？](https://stackoverflow.com/questions/84855/what-is-the-best-choice-for-net-inter-process-communication)

*   [WCF 绑定性能](https://stackoverflow.com/questions/561915/wcf-binding-performance)

# asp.net-mvc - ASP.Net MVC 和 Webservices/Ajax - 采取哪条路线？

> ID：712886
> 
> 赞同：3
> 
> 时间：2009-04-03T07:35:14.803
> 
> 标签：asp.net-mvc, wcf, asp.net-ajax

我正在开发一个 ASP.Net mvc 应用程序，它需要在没有整个页面回发的情况下执行一些小的原子操作。这样做的合乎逻辑的方法当然是使用 ajax 调用。

我的问题是 -**人们会建议实现这一目标的最佳方式是什么？**

据我所知，我可以按照以下方式进行：

*   WCF + ajax
*   mvc 应用程序中的控制器操作 - 可能作为 JSON 结果返回。
*   Webservices（单独/组合项目）+ ajax

我要求用户在使用 webservice/wcf/ajax 时登录，这目前是通过 cookie/session id 完成的，但据我所知，上述所有方法都允许这样做。

总的来说，无论我最终使用哪种方法，都将通过标准化的可访问方法调用来访问数据库，因此我不会将所有内容都保存在同一个项目/命名空间中。

很想听听人们对此的想法/经验！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T07:45:05.077

我建议将其作为控制器操作。原因如下：您可能最终能够使相同的操作返回几种不同的表示。例如，GetPerson() 操作可以将 Person 数据返回为 XML、JSON 或 HTML（可能还有其他表示形式）。

这是 Rails 和 ASPMVC 中的常用方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T15:15:32.153

你绝对应该使用控制器动作，这里有几个原因：

*   使用 WCF/Webservices 这样做就有点过头了（我的假设是您还没有任何每个人都使用的 WCF/Webservices 代码）
*   使用控制器动作自然适合这种情况
*   如果用户禁用了 Javascript 或浏览器不受支持，您可以轻松地进行回退。（只需创建几个返回完整视图的操作方法）
*   同样正如迈克尔提到的，您可以通过渲染部分来执行此原子更新

希望有帮助。

# iphone - 图像集：将其存储在 SQLite 中还是硬编码在集合中更好？

> ID：712894
> 
> 赞同：1
> 
> 时间：2009-04-03T07:39:04.933
> 
> 标签：iphone

我的应用有 5 张背景图片。我希望用户可以选择一个。我正在寻找将它们保存在我的应用程序中的最佳方式，以便我的应用程序能够循环它们并在用户单击“下一张图片”时将它们显示给用户。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T08:42:38.010

您可以将它们作为单独的文件放在您的项目中。将所有内容都放入数据库没有任何好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T09:57:28.627

将其实际图像保存在用户文档文件夹中的 iphone 文件系统中。将有关图像的任何元数据信息（如标签、位置等）保存在 sqlite 数据库中。通过某个键（可能是图像文件名）将数据库条目链接到图像

那么您需要做的就是从 sqlite 读取这些数据，将其填充到 nsarray 集合中，并在用户单击下一个/上一个时循环遍历它

请注意，仅在真正需要时（当用户请求时）加载图像，因为图像往往会占用大量宝贵的内存

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T14:54:58.817

在应用程序中创建一个 plist 并在用户选择图像时存储最后选择的图像。下次重新加载应用程序时，请阅读此 plist 并相应地显示图像。

我觉得 Sqlite 在你的情况下不会有任何优势。将所有 5 张图像打包到您的 .app 中（不要将其复制到 Documents 文件夹，除非您要更改图像或将新图像添加到列表中）。

# sql - 如何在 SQL Server 2005 数据库之间传输存储过程

> ID：712896
> 
> 赞同：5
> 
> 时间：2009-04-03T07:39:11.157
> 
> 标签：sql, sql-server-2005, deployment

我正在本地计算机上创建网站。我正在使用 SQL Server 2005 管理工作室。我需要将所有数据复制到目标服务器。目标服务器是 SQL Server 2005。我的问题是

1.  当我为管理工作室使用导入/导出数据时，这只复制表。
2.  当我使用备份和恢复时，表和存储过程显示如下

myuser.aspnet_application

myuser.aspnet_Membership ...等我需要这样创建

dbo.aspnet_application

dbo.aspnet_Membership

如何将存储过程和视图复制到目标服务器？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T07:48:11.807

在 SQL Server Management Studio 中导航到您的数据库。

右键单击它并选择“任务”->“生成脚本”
“下一步”
从列表中选择您的数据库
“下一步”选择“存储过程”“下一步”
“全选”“下一步”
“脚本到新的查询窗口”“下一步”
“完成”

给它一段时间。然后完成后，在脚本的最顶部放置“使用（您的数据库）”

执行使用语句。
执行整个脚本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T07:47:00.017

如果这是一项一次性工作，您可以轻松地编写所有脚本。

打开 SQL Management Studio，然后浏览到数据库的存储过程节点。如果尚未打开对象资源管理器，请打开它（单击 F7）并选择要复制的所有存储过程。右键单击列表并选择脚本存储过程为 -> 删除和创建 -> 到新查询窗口。

这将为您提供一个脚本，如果它们存在则删除这些过程，然后创建它们。

如果您获得了 myuser 架构或您在脚本中获得了 use [databasename] 语句，您可以通过执行以下操作来关闭这些语句：在菜单中选择工具 -> 选项。导航到 SQL Server 查询资源管理器 -> 脚本并将以下设置为 false：“脚本使用”和“架构限定对象名称”。

您获得的脚本可以在您的新数据库上运行，并且应该创建您需要的所有存储过程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T08:02:37.560

您还可以使用 RedGate [SQLCompare](http://www.red-gate.com/products/SQL_Compare/index.htm)和[SQLDataCompare](http://www.red-gate.com/products/SQL_Data_Compare/index.htm)等工具在数据库之间轻松移动数据和对象

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T08:01:58.700

看起来您正在使用 ASP.NET 成员资格提供程序。通过运行随 .NET 框架安装的工具 aspnet_regsql.exe，您可以轻松地重新创建 ASP.NET 提供程序使用的存储过程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-21T05:56:13.407

试试 DBSourceTools。
[http://dbsourcetools.codeplex.com](http://dbsourcetools.codeplex.com)
它是开源的，会将整个数据库的脚本
——表、视图、过程和数据写入磁盘，然后允许您通过部署目标重新创建该数据库。
它专门设计用于帮助开发人员将他们的数据库置于源代码控制之下。

# lisp - 在 Dr Scheme 中加载库

> ID：712905
> 
> 赞同：3
> 
> 时间：2009-04-03T07:40:41.343
> 
> 标签：lisp, scheme, sicp

我正在使用 Dr Scheme 通过 SICP 工作。

如何在 Dr Scheme 中加载外部库？假设我想使用数学库，那么我如何让 Dr Scheme 加载特定的库？

我尝试了以下方法：（ **需要（lib“math.ss”））**

得到以下错误： **对未定义标识符的引用：需要**

我选择了 R5RS 作为语言。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T08:09:33.923

将语言更改为相当大。'require' 不是[R5RS](http://www.schemers.org/Documents/Standards/R5RS/)功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-03-17T21:18:17.467

将此用于 r5rs：

```
(#%require (lib "math.ss")) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T08:09:37.903

我不知道如何在 R5RS 中做到这一点，但它可以在 Pretty Big 语言下工作。这对你的任务来说足够好了吗？

# asp.net - 我如何知道常规 for 是否是 ASP.ENT 中的回发（为什么 IsPostback 未在 ASP.NET 普通表单中设置）

> ID：712924
> 
> 赞同：0
> 
> 时间：2009-04-03T07:47:56.363
> 
> 标签：asp.net, html, forms, webforms

我正在使用 ASP.NET 处理普通表单，然后发回给自己。（我不想使用带有 runat="server 的 ASP.NET 表单）

当必须是回发时，未设置 To IsPostBack。

这是什么原因？

我不应该回帖给自己吗？

```
<form method="post" id="theForm" action="http://localhost/index.aspx">
  <input type="submit" value="submit" />
  <input ID="titleTB" type="text" />
  <input id="zipTB" type="text" /><br />
</form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T07:56:51.287

您需要设置 runat='server' 属性才能使回发正确地为您的表单和控件工作。

实际上，Olav，如果您真的想要对 HTML 及其处理进行绝对控制，我建议您查看考虑到这一点而设计的[ASP.NET MVC](http://www.asp.net/mvc/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T08:11:32.983

如果您不想使用 runat="server"，您可以随时使用其他方法，例如 Request.HttpMethod，在使用回发时将设置为“POST”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T08:02:09.950

就像康拉德说的……你不能拥有两全其美的东西。IsPostback 是 WebForms 功能的一部分，webforms 与 runat="server" 标签（以及一些 viewstate、eventvalidation 标签、长 dom id 的 :-) 一起出现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T08:16:05.033

'POST' = Request.HTTPMETHOD 之类的东西

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T08:17:41.970

虽然您不能在页面上没有 asp.net 的情况下使用 IsPostback，但您可能可以查看 http 标头变量 REFERRER - 它告诉您请求来自哪里 - 如果是您的页面，那么它*可能*是回发...

# c - 为列表节点分配内存的安全方法

> ID：712926
> 
> 赞同：3
> 
> 时间：2009-04-03T07:48:35.193
> 
> 标签：c, memory-management, list, portability

在一个简单的列表中，例如：

```
struct Node {  
    Node *next;  
    void *data;  
} 
```

如果我在单个分配中分配节点和数据有什么问题（假设我知道大小），比如

```
Node * t = (Node*)malloc(sizeof(Node) + DataSize)); 
```

并始终在分配块的末尾分配数据，

```
t->data = (BYTE*)t+ sizeof(Node); /* BYTE is byte length, can use char in gcc */ 
```

节点和数据将被一次性删除，因此将它们紧密耦合没有真正的问题（按设计）

我正在查看可移植性问题（特别是包装问题）或其他未知问题？

这种分配方式安全便携吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T08:03:30.337

正如 dirkgently 所说，不要`malloc()`在 C 中返回，这样做是没有用的，并且可以隐藏错误。

此外，为了计算 Node 标头之后的地址，我发现这样做更简洁：

```
t->data = t + 1; 
```

这是有效的，因为`t`它是一个类型化的指针，所以它的算术工作正常。加一会使它增加指向数据的大小，即`sizeof (Node)`在这种情况下。对于这种特殊情况，我发现这种用法习惯用法，即在刚编辑的东西之后立即计算地址`malloc()`（当那个“东西”是一个具有静态已知大小的明确定义的类型`Node`，当然在这种情况下是结构）。

这有以下好处：

*   没有重复类型名称。
*   不`sizeof`，这么短。
*   再次，没有演员表。
*   涉及非常简单的算术，易于阅读。

`Node`我意识到您在正确声明类型之前使用该类型也存在错误。我不同意 dirkgently 的解决方案，这是它在 C 中的外观：

```
/* This introduces the type name "Node", as an alias for an undefined struct. */
typedef struct Node Node;

struct Node {
  Node *next; /* This is OK, the compiler only needs to know size of pointer. */
  void *data;
}; 
```

为了完整起见，并且由于我从不厌倦展示我认为应该如何编写这样的代码，这里有一个创建新节点以保存 n 字节数据的函数示例：

```
Node * node_new(size_t n)
{
  Node *node;

  if((node = malloc(sizeof *node + n)) != NULL)
  {
    node->next = NULL;
    node->data = node + 1;
  }
  return node;
} 
```

而已。注意在调用中`sizeof`对*指针目标*`malloc()`的使用，以避免重复类型名称并在类型应该改变时产生易于忘记的依赖关系。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T08:37:47.727

从技术上讲，如果数据有对齐要求，这可能是不安全的。malloc() 返回一个适合所有类型对齐的指针，并且很可能`t+1`也对齐。可能，但不能保证。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T07:59:19.237

`Node`在创建别名之前，您不能将其用作类型。利用：

```
typedef struct Node {
   struct Node* n;
   void* data;
}Node; 
```

`malloc`如果您要坚持使用 C 编译器，则无需强制转换结果。我发现以下内容更易于维护和阅读：

```
Node* t = malloc(sizeof *t + DataSize); 
```

`BYTE`不是语言定义的标准类型，因此不可*移植*。以下行试图完成什么？

```
t->data = (BYTE*)t+ sizeof(Node); 
```

如果你想分配一些东西，以下就足够了：

```
t->data = pointer to some data ... 
```

如果要获取字节偏移量，请使用`offsetof`宏。

打包是特定于实现的。您必须参考适当的编译器文档并查看可用的内容。

此外，您可能希望有一个`head`对象来维护有关列表的一些内务信息（长度等）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T12:13:07.943

我同意@MSalters。只要你有一个间接级别（`data`指针），你还不如做正确的事情并为它分配一个单独的块。

现在，另一种方法是使用C99 中定义的*灵活数组成员：*

```
typedef struct Node {
    struct Node *next;
    char data[];
} Node;

Node *n = malloc(sizeof(*n) + DataSize * sizeof(*data));
//if (n != NULL), access data[0 ~ DataSize-1] 
```

`sizeof(struct Node)`补充了适当数量的填充（如果有的话），以满足 的对齐要求`data`，并且`data[]`就像它被声明为一个最大可能大小的数组，该数组将适合由 . 返回的内存块`malloc()`。这适用于所有类型`data`，而不仅仅是`char`（因此是第二个`sizeof`）。

# c# - 如何组合两个字典而不循环？

> ID：712927
> 
> 赞同：49
> 
> 时间：2009-04-03T07:48:45.083
> 
> 标签：c#, dictionary, collections

我`<string,object>`在 C# 中有两个类型的字典。如何在不应用循环的情况下将一个 Dictionary 对象的所有内容复制到另一个？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-04-03T08:58:42.807

```
var d3 = d1.Concat(d2).ToDictionary(x => x.Key, x => x.Value); 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-04-03T08:21:53.270

您可以使用[`Concat`](http://msdn.microsoft.com/en-us/library/bb302894.aspx)：

```
Dictionary<string, object> d1 = new Dictionary<string, object>();
d1.Add("a", new object());
d1.Add("b", new object());
Dictionary<string, object> d2 = new Dictionary<string, object>();
d2.Add("c", new object());
d2.Add("d", new object());

Dictionary<string, object> d3 = d1.Concat(d2).ToDictionary(e => e.Key, e => e.Value);

foreach (var item in d3)
{
    Console.WriteLine(item.Key);
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-03T08:41:13.037

首先，没有循环是不可能的。该循环是否在（扩展）方法中完成是无关紧要的，它仍然需要一个循环。

我实际上会建议手动进行。给出的所有其他答案都需要使用两种扩展方法（Concat - ToDictionary 和 SelectMany - ToDictionary），因此循环两次。如果您这样做是为了优化代码，那么对字典 B 进行循环并将其内容添加到字典 A 会更快。

**编辑：**经过进一步调查，Concat 操作只会在 ToDictionary 调用期间发生，但我仍然认为自定义扩展方法会更有效。

如果你想减少你的代码大小，那么只需做一个扩展方法：

```
public static class DictionaryExtensions
{
    public static IDictionary<TKey,TVal> Merge<TKey,TVal>(this IDictionary<TKey,TVal> dictA, IDictionary<TKey,TVal> dictB)
    {
        IDictionary<TKey,TVal> output = new Dictionary<TKey,TVal>(dictA);

        foreach (KeyValuePair<TKey,TVal> pair in dictB)
        {
            // TODO: Check for collisions?
            output.Add(pair.Key, Pair.Value);
        }

        return output;
    }
} 
```

然后你可以通过导入（'使用'） DictionaryExtensions 命名空间并编写：

```
IDictionary<string,objet> output = dictA.Merge(dictB); 
```

我已经使该方法表现得像对象是不可变的，但是您可以轻松地将其修改为不返回新字典并仅合并到 dictA 中。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-03T08:15:21.540

```
var result = dictionaries.SelectMany(dict => dict)
             .ToDictionary(pair => pair.Key, pair => pair.Value); 
```

# c# - 将企业库 (1.0) 升级到 LINQ 或实体框架

> ID：712930
> 
> 赞同：0
> 
> 时间：2009-04-03T07:49:23.053
> 
> 标签：c#, linq, entity-framework, enterprise-library, .net-1.1

我们正在开发一个带有**企业库 1.0**的 C# windows 项目，该项目需要更新为 LINQ 或实体框架。（.NET 3.5）

该应用程序主要使用 SQL 连接作为**存储过程**和**XML**文件来存储设置。

1.  在这种情况下， **LINQ**和**实体框架**的优缺点是什么 ？
2.  *LINQ 将停产的传言是真的吗？*
3.  考虑我们的设置，哪一个最有效？
4.  有什么好的起点吗？
5.  要避免什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T08:01:17.500

这是一个简短的概述..

1.  经常有人问这个问题-这是[以前的问答，我在](https://stackoverflow.com/questions/8676/entity-framework-vs-linq-to-sql)[此](https://stackoverflow.com/questions/349718/ado-net-entity-framework-decision-making-between-orm-solutions/349755#349755)之前基本上回答了同样的问题-但是要更具体地针对您的情况..除了您已经描述的内容之外，我还需要了解更多信息（即除了从企业库架构升级/迁移）。

2.  **我认为您的意思是“关于LINQ to SQL**将停止使用的传言是否属实？”.. 之前也曾在[这里](https://stackoverflow.com/questions/253263/has-microsoft-really-killed-linq-to-sql)讨论过，但简短的回答不会在不久的将来。

3.  你需要更多地讨论你更广泛的计划。恕我直言，两者都可以在您描述的架构中正常工作（随时提供更多细节）。再问一些问题，例如……您是否需要支持 SQL Server 以外的数据库？您会使用 eSQL（实体 SQL）还是只使用基于 LINQ 的查询？

4.  我建议首先使用您选择的 ORM 创建概念证明，然后迁移功能的“垂直切片”，例如 UI -> WS -> DAL，然后查看您遇到的问题类型。我的建议是您考虑如何在您的架构中使用 L2S 或 EF。尤其是关于实体本身 - 即更改跟踪。

5.  不要排除其他选项，例如 NHibernate 或使用 Codesmith 模板生成数据访问类，除非您已经决定使用 L2S 或 EF..

# silverlight - Silerlight MVVM 异常处理

> ID：712937
> 
> 赞同：2
> 
> 时间：2009-04-03T07:53:18.317
> 
> 标签：silverlight, mvvm, exception-handling

在 MMVM 应用程序中，应该如何处理和冒泡异常？

如果我在异步回调期间在我的模型中遇到异常并抛出异常，则这不会冒泡到 ViewModel。我怀疑这是因为回调没有在 UI 线程上运行。

这方面的最佳做法是什么？

标记

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T05:26:09.853

最佳实践是在异步回调中捕获异常并将其与事件一起传回。WebClient 事件对其进行了很好的建模（调用者必须在访问数据之前测试错误）。

# php - 将图像与文本合并

> ID：712945
> 
> 赞同：3
> 
> 时间：2009-04-03T07:56:29.587
> 
> 标签：php, image, merge, gd

有没有办法将文本放在 png 上，然后将其与 jpg / gif 图像合并？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T08:08:07.110

您可以使用 ttf 或 type1 字体使用 gd 在图像中或图像上绘制任何文本（如果它在 php 中的 gd 中启用）。

[http://hr.php.net/manual/en/image.examples-watermark.php](http://hr.php.net/manual/en/image.examples-watermark.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T09:20:13.083

这就是我的做法。

```
/* load the image */
$im = imagecreatefrompng("image.png");

/* black for the text */
$black = imagecolorallocate($im, 0, 0, 0);

/* put the text on the image */
imagettftext($im, 12, 0, 0, 0, $black, "arial.ttf", "Hello World");

/* load the jpg */
$jpeg = imagecreatefromjpeg("image.jpeg");

/* put the png onto the jpeg */
/* you can get the height and width with getimagesize() */
imagecopyresampled($jpeg,$im, 0, 0, 0, 0, $jpeg_width, $jpeg_height, $im_width, $im_height);

/* save the image */
imagejpeg($jpeg, "result.jpeg", 100); 
```

这是一个非常简单的例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T08:16:48.213

你没有说你使用的是什么语言，但[Imagemagick](http://www.imagemagick.org)有几种不同语言的 API ( [http://www.imagemagick.org/script/api.php](http://www.imagemagick.org/script/api.php) )。

# php - ZF：如何在 Form 方法中访问控制器的 Request 对象？

> ID：712949
> 
> 赞同：0
> 
> 时间：2009-04-03T07:57:05.373
> 
> 标签：php, zend-framework, request

如何在 Form 方法中访问 Request 对象？我认为在 Form 方法中使用 ActionHelper 访问控制器的请求对象是可能的，但是为这样的任务编写一个新类似乎是多余的。

或者我应该以某种方式将控制器的请求保存到 Zend_Registry 并访问表单中的注册表项？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T08:04:33.080

```
$request = Zend_Controller_Front::getInstance()->getRequest() 
```

?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T08:37:07.073

虽然注册表方法 (1) 以及访问单例前端控制器 (2) 都可以工作，但这两种方法都有一些主要缺点：它们引入了对 the`Zend_Controller_Front`或 the`Zend_Registry`和请求键以及`Zend_Controller_Request_Abstract`.

```
// (1)
// in bootstrap e.g.
Zend_Registry::set('request', Zend_Controller_Front::getInstance()->getRequest());

// in form method
$request = Zend_Registry::get('request');

// (2)
//in form method
$request = Zend_Controller_Front::getInstance()->getRequest(); 
```

我认为最好的方法是通过表单的构造函数或通过表单上的设置器将请求对象注入表单，或者甚至更好地将请求参数作为数组注入。

```
// form class (constructor-injection presumed)
class My_Form extends Zend_Form
{
    /**
     * @var Zend_Controller_Request_Abstract
     */
    protected $_request;

    public function __construct(Zend_Controller_Request_Abstract $request, $options = null)
    {
        parent:: __construct($options);
        $this->_request = $request;
    }       
}
// or inject only parameters
class My_Form extends Zend_Form
{
    /**
     * @var array
     */
    protected $_params;

    public function __construct(array $params, $options = null)
    {
        parent:: __construct($options);
        $this->_params= $params;
    }       
} 
```

# c++ - 如何使用 umdh.exe 在所有堆中跟踪内存泄漏？

> ID：712975
> 
> 赞同：5
> 
> 时间：2009-04-03T08:06:01.827
> 
> 标签：c++, memory-leaks

我有一个 c++ windows 应用程序，每个事务都会泄漏内存。使用 perfmon，我可以看到每个事务的私有字节数增加，当应用程序空闲时内存使用量是平稳的。

按照之前关于 stackoverflow 的答案，我使用了微软调试工具中的 umdh 来追踪一个内存泄漏。但是仍然有更多的泄漏，并且 umdh 的结果与我的 perfmon 结果不匹配。

首先 umdh 仍然报告此泄漏，堆栈跟踪是：

```
+   36192 ( 2082056 - 2045864)    251 allocs    BackTraceCB
+       4 (    251 -    247)    BackTraceCB allocations

    ntdll!RtlAllocateHeapSlowly+00000041
    ntdll!RtlAllocateHeap+00000E9F
    MSVCR80!malloc+0000007A 
```

这是没有用的，因为第一个调用是 malloc，它没有说明调用它的内容。我对这种泄漏表示怀疑，因为它在应用程序正在处理事务和空闲时都会报告。但是我可以清楚地看到空闲时没有内存泄漏。并且在处理事务时报告的内存泄漏与作为 perfmon 报告处理的事务不成比例。

umhd 没有显示任何其他泄漏，尽管我知道至少还有一个未显示。我刚刚从网上搜索得知一个 Windows 应用程序可以有多个堆。

*   难道 umhd 只报告这些堆之一的内存使用情况？例如默认或crt 堆？
*   如何跟踪其他堆中的内存使用情况？
*   以及如何找出哪些 dll / 模块正在使用其他堆？

由于我没有选择余地，我们将不胜感激地收到任何追踪此问题的指针。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T12:31:47.633

对我来说，在 umdh 失败的情况下——另一个名为[LeakDiag](http://thetweaker.wordpress.com/2009/04/09/native-memory-leaks-part-1-leakdiag/)的免费 MS 工具成功了。它允许拦截比 umdh 更多的分配器类型，包括它所谓的“MPHeap 分配器”，[我怀疑](http://msdn.microsoft.com/en-us/library/aa230637.aspx)它可能对您有用。如果您有空闲时间-我很好奇这是否确实有帮助..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T08:21:13.710

除非您的应用程序（或它使用的库）显式创建自己的堆，否则只有一个堆需要担心。大多数图书馆不这样做，所以我建议这不应该是你调查的主要途径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T08:27:09.390

也许 umdh 无法为您的代码定位调试符号？这可以解释为什么堆栈跟踪不完整。确保您已使用符号构建它并且可以找到它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T13:41:53.497

很抱歉回答我自己的问题，但我最终将问题归结为我如何使用 Orbix。

似乎 orbix 库在 Windows 平台上使用自己的堆。这意味着大多数内存泄漏检测不适用于 orbix 中的泄漏，我尝试了 boundschecker 和 umhd.exe。

为了隔离这个问题，我发现了一些代码可以转储应用程序中每个堆的内存：[http ://www.abstraction.net/content/articles/analyzing%20the%20heaps%20of%20a%20win32%20process.htm](http://www.abstraction.net/content/articles/analyzing%20the%20heaps%20of%20a%20win32%20process.htm)

我用它来转储每个事务之前和之后的堆使用情况，然后在每 500 个事务之后，这表明每次都在增长相同的堆。然后我列出了这个堆中每个条目的地址。检查这些区域的内存，我发现它们包含 orbix 编组数据。有了这些信息，我终于找到了一些没有被清理的对象引用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T09:09:43.937

我过去常常进行代码审查以寻找内存泄漏。

我一直在寻找的一些东西：

1.  继承问题：基类不提供虚析构函数，多态使用。
2.  在代码中搜索指针声明或指针分配（查找 * 声明、关键字 new 或 malloc 用法），并查看代码片段，针对动态分配对象的生命周期。

当然，代码审查可能很耗时，具体取决于您必须审查的代码库。但是，如果您可以限制需要查找指针分配/使用的区域，它可能会有所回报。在我的大多数情况下都是如此。

# iphone - UITableViewController 中的 EXC_BAD_ACCESS

> ID：712978
> 
> 赞同：0
> 
> 时间：2009-04-03T08:07:35.897
> 
> 标签：iphone, objective-c, cocoa-touch

我正在尝试使用 UITableViewController（视图的委托和数据源）来显示从 Plist 读取的简单表。Plist 包含一个 NSDictionary，它本身包含几个 NSDictionary 对象，这些对象代表我的应用程序中使用的对象。

其余代码看起来像这样（简化）：

```
- (void)viewDidLoad {
    [super viewDidLoad];
    [self loadObjectsFromPlist];
}

- (void)loadObjectsFromPlist {
    NSString *objectPlistFile = [[NSBundle mainBundle] pathForResource:@"Objects" ofType:@"plist"];
    NSDictionary *objectsDictionary = [NSDictionary dictionaryWithContentsOfFile:objectsPlistFile];

    objects = [[NSMutableArray alloc] init];
    NSEnumerator *objectEnumerator = [objectsDictionary objectEnumerator];
    NSDictionary *objectData;
    while(objectData = [objectEnumerator nextObject]) {
        [objects addObject:[MyObject objectFromDictionary:objectData]];
    }
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return [objects count];
} 
```

由于我没有使用控制器返回`1`的任何部分。`numberOfSectionsInTableView`

" "的`objectFromDictionary`方法`MyObject`将从 中读取的数据分配`NSDictionary`给一个新对象。我也尝试过保留、复制等，但这并没有改变任何东西。

打电话时我`EXC_BAD_ACCESS`进了。我尝试使用对象分配工具，但没有发现问题。我的 Plist 当前仅包含一个对象的数据。调试器以红色显示属性的“1 个对象”，所以我认为这与问题有关。`tableView:numberOfRowsInSection``[objects count]``objects`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T21:01:04.817

为确保在适当的时间加载数据，请尝试延迟初始化：

```
- (NSArray *)objectsFromPlist {
    if (!objects) {
       ... // initialize once here
    }
    return objects;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return [[self objectsFromPlist] count];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T16:13:13.447

如果调试器显示`EXC_BAD_ACCESS`发生在`[servers count]`，（假定的）ivar`servers`是否被正确初始化？我在您的示例代码中没有找到对它的任何引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T02:45:07.787

是什么`objects`？你能显示你的头文件吗？它可能会让我更好地理解。另外，你试过把`[super viewDidLoad]`你的`[self loadObjectsFromPlist]`? 这似乎是一个时间问题，或者`objects`是在您的一种方法中意外发布。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T02:08:17.707

我的猜测是您可能必须发布整个（相关）代码，而不是精简版本。在不知道您在代码和 plist 中还可能在做什么的情况下，很难确定这一点......我们都只是在这里盲目地开枪（诚然，这在 SO 上并不罕见；-）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T10:09:45.727

听起来它在调用 loadObjectsFromPlist 之前调用 numberOfRowsInSection 。

如果您以编程方式加载控制器，则可以尝试从 initWithFrame:Style: 而不是 viewDidLoad 调用 loadObjectsFromPlist。

如果我面前有一个 mac，我会自己做，但你可能想尝试设置断点并弄清楚这些方法被调用的顺序。整个地方的 NSLog 语句也可以工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-11T12:38:57.240

您可能已经释放了您的`UITableViewController`，这意味着该`objects`成员不再有效。确保您持有对`UITableViewController`某处的引用。检查是否是这种情况的一种简单方法是`[self retain]`在您的方法中添加一个调用`viewDidLoad`（暂时！）。如果这使问题消失，那么您需要仔细检查谁拥有控制器并确保他们没有释放它。

编辑：我想更好的测试方法是在你的 dealloc 方法中放置一个断点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-13T08:53:51.663

将 [self loadObjectsFromPlist] 放在 [super viewDidLoad] 之前。您的“对象”变量从未初始化，这就是您收到 EXEC_BAD_ACCESS 错误的原因。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-13T17:59:41.790

好的，在阅读了你所有的答案并试图找到我的错误之后，我几乎完全重写了我的代码。最后，我删除了第一次发生错误时添加的调试输出。

```
NSLog(@"Object count: %@", [objects count]); 
```

As `NSArray`'s`count`不返回一个对象，而是一个整数，这显然是错误的，应该是：

```
NSLog(@"Object count: %u", [objects count]); 
```

尽管如此，`EXC_BAD_ACCESS`之前没有这条线发生过，但它似乎减慢了我的调试速度。;) 可悲的是，我现在无法重现真正的问题。

我能说的：错误**不是**时间问题的结果。我现在仔细检查了这个。

# asp.net-mvc - 拦截 MVC 控制器的动作方法

> ID：712980
> 
> 赞同：0
> 
> 时间：2009-04-03T08:08:03.367
> 
> 标签：asp.net-mvc, modelbinders

我使用 O/R 映射器，它可以以通用方式从数据库中重新加载对象。我希望能够在创建映射对象*后*立即拦截请求，以便重新加载它们。

ActionFilters 当然存在，但问题是 ActionFilters（或我见过的示例）可以处理表单提供的数据，而不是在创建对象之后。

我查看了控制器的可覆盖方法，但没有发现任何明显的吸引我的眼球。有谁知道这样做的方法？

谢谢你的建议！

纳赛尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T12:49:22.053

如果我正确理解你需要这样的东西。

```
public class Navigate : ActionFilterAttribute, IActionFilter
{
    void IActionFilter.OnActionExecuted(ActionExecutedContext filterContext)
    {
        ViewResult view = filterContext.Result as ViewResult;

    }
} 
```

在视图中，您将找到属于当前控制器的 view.ViewData.Model，您可以使用此映射数据做所有您想做的事情。让我知道我是否正确:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T12:56:22.783

您需要的是自定义模型绑定器。您可以从默认的 ModelBinder 类继承并提供您想要的逻辑。

例如，如果你有这个：

```
public ActionResult Save([Bind(typeof(CustomModelBinder))] Customer customer)
{
   /* ... */
} 
```

模型绑定器将为您创建对象，但您可以选择首先从数据库中获取它（对于现有记录）。

# c# - 业务对象集合是否应该从 Collection 继承 当它不扩展时？

> ID：712990
> 
> 赞同：3
> 
> 时间：2009-04-03T08:12:23.293
> 
> 标签：c#, inheritance, oop

我有一个从 Collection 继承的业务对象集合（表示来自数据库的数据），并有一个调用存储过程的静态方法，然后用返回的数据填充其属性。

我的问题是；从 Collection 继承是错误的，因为它并没有真正扩展类吗？或者最好不要继承任何东西，而是维护一个 Collection 类型的私有变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T08:15:12.397

如果您的业务对象可以向世界提供常用的收集方法，那么从`Collection<T>`. 正如我猜想的那样，实际上你添加了一些东西 - 你指定`T`.

**Udate：**
根据作者的评论，所有集合方法的发布都会使对象可编辑，这是不可接受的。因此，他不会继承，而是创建私有字段并使类可枚举。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T09:08:26.687

如果没有看到有关您正在尝试做的事情的更多细节，很难给出答案。但是，我通常不会从 Collection 继承，因为它并没有真正提供足够的虚拟方法来覆盖。这可能会使将来更改班级的行为变得有些棘手。

继承的问题在于，如果您使用它，您将永远受制于 Collection 基类的行为，或者面临复杂的重构。例如，您可能想要添加过滤、搜索和排序操作，此时您需要从 Collection 切换到 List。您甚至可能想要在需要 BindingList 而不是 Collection 的情况下进行数据绑定。

一个不同的计划是从 ICollection 或更好的 IList<T> 继承，然后委托给私有 Collection 成员。这为您提供了最大的控制权，并允许您在不影响公共接口的情况下更改类的内部表示。这样做的问题是开发课程需要更长的时间。

因此，您面临的是更快的发展和未来的灵活性之间的权衡，正如我在开始时所说的那样，从原始帖子中提供的信息判断该走哪条路有点困难。

**PS：**要使 IList<T> 实现只读，只需从 IsReadOnly 返回 true，然后从更改列表的所有方法中抛出 NotSupportedException。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T08:25:38.690

实际上，最“纯粹”的方法是在继承对象时*不*添加任何内容。几乎没有人试图变得那么纯粹，但这被认为更纯粹。这个想法是您可能会覆盖某些方法来“填补空白”关于您的对象的行为方式，但您不会添加任何非私有成员。

我不主张试图变得那么纯洁。关键是，你所做的绝不是“不纯洁的”。（注意：我根本没有使用“纯”和“不纯”，因为它们与函数式语言一起使用。只是字典中单词定义的一般意义）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T08:34:44.723

是的，这是错误的。您应该只拥有一个可以恢复 Collection 的对象。此外，除非有迫切需要，否则不要将方法设为静态。new Blah().foo() 没有任何问题。任何体面的 JIT 都会内联对象创建。

另外，我认为在 99% 的情况下扩展 Collection 是错误的 :) 通常，当人们扩展 Collection 时，他们真正应该做的只是编写一个 List 并只公开客户真正需要的内容，或者只是使用一个普通的 List。

# c++ - 带有网络摄像机的 OpenCV

> ID：712998
> 
> 赞同：23
> 
> 时间：2009-04-03T08:15:29.543
> 
> 标签：c++, windows, networking, opencv, ffmpeg

我在 Windows 下使用 openCV 1.1pre1。我有一个网络摄像机，我需要从 openCV 抓取帧。该摄像机可以通过 RTSP 流式传输标准 mpeg4 流或通过 http 传输 mjpeg。我已经看到很多线程都在谈论将 ffmpeg 与 openCV 一起使用，但我无法使其工作。

如何使用 openCV 从 IP 摄像机中抓取帧？

谢谢

安德烈亚

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-01-03T21:57:37.787

我附上了用于抓取帧的 C++ 代码。它需要 OpenCV 2.0 或更高版本。该代码使用 cv::mat 结构，该结构优于旧的 IplImage 结构。

```
#include "cv.h"
#include "highgui.h"
#include <iostream>

int main(int, char**) {
    cv::VideoCapture vcap;
    cv::Mat image;

    const std::string videoStreamAddress = "rtsp://cam_address:554/live.sdp"; 
    /* it may be an address of an mjpeg stream, 
    e.g. "http://user:pass@cam_address:8081/cgi/mjpg/mjpg.cgi?.mjpg" */

    //open the video stream and make sure it's opened
    if(!vcap.open(videoStreamAddress)) {
        std::cout << "Error opening video stream or file" << std::endl;
        return -1;
    }

    //Create output window for displaying frames. 
    //It's important to create this window outside of the `for` loop
    //Otherwise this window will be created automatically each time you call
    //`imshow(...)`, which is very inefficient. 
    cv::namedWindow("Output Window");

    for(;;) {
        if(!vcap.read(image)) {
            std::cout << "No frame" << std::endl;
            cv::waitKey();
        }
        cv::imshow("Output Window", image);
        if(cv::waitKey(1) >= 0) break;
    }   
} 
```

**更新**您可以从 H.264 RTSP 流中抓取帧。查找您的相机 API 以获取详细信息以获取 URL 命令。例如，对于 Axis 网络摄像机，URL 地址可能是：

```
// H.264 stream RTSP address, where 10.10.10.10 is an IP address 
// and 554 is the port number
rtsp://10.10.10.10:554/axis-media/media.amp

// if the camera is password protected
rtsp://username:password@10.10.10.10:554/axis-media/media.amp 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-05-20T11:11:54.937

```
#include <stdio.h>
#include "opencv.hpp"

int main(){

    CvCapture *camera=cvCaptureFromFile("http://username:pass@cam_address/axis-cgi/mjpg/video.cgi?resolution=640x480&req_fps=30&.mjpg");
    if (camera==NULL)
        printf("camera is null\n");
    else
        printf("camera is not null");

    cvNamedWindow("img");
    while (cvWaitKey(10)!=atoi("q")){
        double t1=(double)cvGetTickCount();
        IplImage *img=cvQueryFrame(camera);
        double t2=(double)cvGetTickCount();
        printf("time: %gms  fps: %.2g\n",(t2-t1)/(cvGetTickFrequency()*1000.), 1000./((t2-t1)/(cvGetTickFrequency()*1000.)));
        cvShowImage("img",img);
    }
    cvReleaseCapture(&camera);
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-18T14:28:02.787

OpenCV 可以在 FFMPEG 支持下编译。从*./configure --help*：

```
--with-ffmpeg     use ffmpeg libraries (see LICENSE) [automatic] 
```

然后，您可以使用*cvCreateFileCapture_FFMPEG*创建一个 CvCapture，例如相机的 MJPG 流的 URL。

我使用它从 AXIS 相机中抓取帧：

```
CvCapture *capture = 
    cvCreateFileCapture_FFMPEG("http://axis-cam/mjpg/video.mjpg?resolution=640x480&req_fps=10&.mjpg"); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-02-11T11:48:15.187

我只是这样做：

```
CvCapture *capture = cvCreateFileCapture("rtsp://camera-address"); 
```

还要确保这个 dll 在运行时可用，否则 cvCreateFileCapture 将返回 NULL

```
opencv_ffmpeg200d.dll 
```

相机也需要允许未经身份验证的访问，通常通过其网络界面设置。MJPEG 格式通过 rtsp 工作，但 MPEG4 没有。

hth

硅

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-28T22:21:00.973

rtsp 协议对我不起作用。mjpeg 第一次尝试。我假设它内置在我的相机中（Dlink DCS 900）。

在这里找到语法：http: [//answers.opencv.org/question/133/how-do-i-access-an-ip-camera/](http://answers.opencv.org/question/133/how-do-i-access-an-ip-camera/)

我不需要编译带有 ffmpg 支持的 OpenCV。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-03T09:31:07.800

使用 ffmpeglib 连接到流。

这些功能可能很有用。但是看看文档

```
av_open_input_stream(...);
av_find_stream_info(...);
avcodec_find_decoder(...);
avcodec_open(...);
avcodec_alloc_frame(...); 
```

您需要一些算法来获得完整的框架，可在此处获得

```
http://www.dranger.com/ffmpeg/tutorial01.html 
```

一旦你得到一个帧，你可以将视频数据（如果需要的话，对于每个平面）复制到一个 IplImage 中，它是一个 OpenCV 图像对象。

您可以使用类似...的东西创建一个 IplImage

```
IplImage *p_gray_image = cvCreateImage(size, IPL_DEPTH_8U, 1); 
```

拥有 IplImage 后，您可以执行 OpenCV 库中可用的各种图像操作*****