# StackOverflow 问答 000918000-000918999

# wcf - 甚至可以在 WCF (.NET 3.0) 中进行 JSON 调用吗？

> ID：918000
> 
> 赞同：1
> 
> 时间：2009-05-27T21:03:33.480
> 
> 标签：wcf, json, .net-3.0

浏览网络，我找不到这个问题的答案。我看到有人问过这个问题，很多人都提到了 .Net 3.5；但是，在 WCF 3.0 (VS2005) 的受限环境中，我没有看到任何类似答案的东西。

如果您不能使用 .Net 3.5，我是否可以对 WCF 3.0 Web 服务进行 AJAX/JSON 调用，或者是使用 ASMX 的唯一选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T21:29:23.600

Microsoft 的[ASP.NET 2.0 AJAX Extensions 1.0](http://www.asp.net/ajax/downloads/archive/)包含用于为 .NET 2.0 和更新版本序列化和反序列化 JSON 的类。

执行此操作的类是[System.Web.Script.Serialization.JavaScriptSerializer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)。

请注意，尽管上面链接的文档适用于 3.5 版本，但 3.5 版本与 2.0 版本相同，因为它在 3.5 中已被[System.Runtime.Serialization.Json](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.aspx)中的类弃用和替换。

不过，我不确定如何将它与 WCF 一起使用……我唯一一次使用它是作为 ashx 处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T21:12:23.463

.NET 3.0 中没有开箱即用的绑定允许您发送 JSON 响应。您将需要自己实现它。有[一篇文章](http://msdn.microsoft.com/en-us/library/aa395208.aspx)展示了如何使用 POX 进行 REST。它可以很容易地适应 JSON，但正如您将看到的那样，工作量不可忽略。

# ruby-on-rails - 如何在 Rails 中实现这种渐进式参与/惰性注册？

> ID：918003
> 
> 赞同：5
> 
> 时间：2009-05-27T21:04:21.577
> 
> 标签：ruby-on-rails, user-experience, lazy-registration

很久以前，我遇到了一个网站（不幸的是，我丢失了地址，它是某种报纸网站），它允许您像注册用户一样使用一切。您可以对文章进行评分、收藏和评论，当您这样做时，它会显示一条谨慎的嵌入式消息，说明您必须在网站上注册才能保存您的贡献。然后它有一个链接，你可以看到如果你这样做了你的个人资料会是什么样子，我很惊讶地看到它在那里有我的所有活动；我阅读和保存的文章、评论等。我离开了该站点，后来出于好奇而返回该站点时，它仍然保存了我的活动。

我认为这是有史以来最伟大的事情，现在我正在建立一个具有社交功能的网站，我也想采用这种方法。但我仍然是一个菜鸟，所以我不知道如何去做。**你会怎么做？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T21:46:27.140

我会创建一个`Profile`模型，该模型会自动为访问您网站的任何用户创建并添加第一个收藏夹、对第一个项目进行评分等。`Profile`应该将其保存到您的数据库中，包括一个适当的随机且唯一的字符串。该字符串可以作为 cookie 存储在客户端，稍后将用于检索您的个人资料。它应该是随机的并且足够长，这样您就不会轻易篡改您的 cookie 并获取其他匿名人的个人资料，但这并非完全可以避免（因此请注意，您不要在匿名个人资料中存储敏感数据！）。

用户注册后，您可以将他们`Profile`与他们的新`User`记录相关联并删除 cookie 和唯一的字符串标识符。您现在可以在他们登录时根据他们的`User`记录简单地检索他们的个人资料。

该`Profile`模型可以包含您想要存储的任何信息。

如果您想区分注册用户和匿名用户，您可以创建一个`AnonymousProfile`模型和一个`Profile`模型（每个模型具有不同的属性），并在有人注册时简单地将所有数据从匿名配置文件复制到用户配置文件。

**更新：** 在您的整个应用程序中，您可以决定仅在用户登录时使用此信息。您可以定义`before_filter`获取当前用户的 a，并且仅当有实际用户登录时，您才使用配置文件数据：

```
class ApplicationController < ActionController::Base
  before_filter :fetch_user_data

  def fetch_user_data
    @current_user = ... # Work your magic to get current user
  end

  private

  def current_profile
    @current_user and @current_user.profile  # Use profile association
  end
end 
```

在控制器动作的某处：

```
if current_profile
  # Do stuff with current_profile
  # Only available to registered users...
end 
```

`current_profile`如果您改变主意并希望匿名配置文件对您的匿名用户生效，您可以稍后更改实施。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T21:47:01.600

识别用户的唯一方法是使用 cookie。您使用的网站可能正在做的事情是：

第一次用户在“用户”表中创建一个条目并将他们添加到“客人”组中。将标识符 cookie 保存到用户计算机，以便您以后可以再次查找它们。

如果用户决定注册，您可以在用户表中填写他们的其余详细信息（您甚至可能希望有一个单独的表用于用户详细信息和注册详细信息，如用户名/密码等......）并将它们添加到已注册用户组。

您管理组的方式可以像数据库中的标志一样简单。

因为这是一个rails问题......

我可能会在 application_controller.rb 的 before_filter 中处理大部分内容。这些步骤将类似于：

```
if has_cookie
   @user = lookup_user
else
   @user = create_new_guest_user
end 
```

您可以很容易地扩展现有的身份验证框架之一，例如acts_as_authenticated 或clearance 来执行此操作。

# security - 使用 IIS/Active Directory 控制对网站的访问

> ID：918004
> 
> 赞同：0
> 
> 时间：2009-05-27T21:04:44.697
> 
> 标签：security, web, active-directory, iis-6

我需要在我们的网络上保护一个指向世界的旧版帮助站点。理想情况下，我希望人们使用他们的活动目录登录进行身份验证，因为公司中的每个人都已经在那里，而且他们已经知道这些东西。理想情况下，我需要设置默认域，这样人们就不必键入它。

我有一个示例来模拟我的解决方案，但称它为怪异有点轻描淡写。匿名访问已启用，经过身份验证的访问仅限于集成 Windows 身份验证和基本身份验证，没有设置初始域或领域。网站中的 web.config 文件在其身份验证字段中只有这个：

`<authentication mode="Windows" /> <authorization> <deny users="?" /> <!-- Allow all users --> </authorization>`

当然，我要保护的网站是纯 HTML，所以我什至不确定 web.config 文件是否可以正常工作。有没有一种优雅、可持续的方式来解决这个问题？不幸的是，我在谷歌上找不到很多东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:09:06.543

在 IIS 中关闭匿名身份验证并启用集成 Windows 身份验证。这将在 asp.net 之外工作。如果是纯 html，则不会使用 web.config。

# iis-6 - 内部 SMTP 中继

> ID：918006
> 
> 赞同：1
> 
> 时间：2009-05-27T21:04:48.940
> 
> 标签：iis-6, smtp

在内部，我们的组织限制了哪些服务器和应用程序可以发送电子邮件。我希望能够让可以在任何服务器上运行的脚本在完成后发送电子邮件。是否可以在单个服务器上安装 IIS SMTP 并将服务器发送的所有邮件中继到我们的标准中继服务器？我在互联网上看到的所有建议都是关于为出站连接配置中继，但这仅供内部使用。流程会是这样的，我相信

[任何服务器] -->**我的 SMTP 中继**--> 公司 SMTP 中继 --> 内部邮件系统

这是可行的吗？如果是这样，有关如何配置的任何链接？我的 SMTP 知识几乎为零。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:22:54.283

可行，您应该在 google 中搜索“SMARTHOST SMTP”。如果您的邮件服务器将中继限制为特定的 HOSTS/IP 地址，您仍需要将新服务器添加到中继列表中。根据您的邮件服务器/版本（Exchange、IIS SMTP），设置会有所不同。

Exchange 智能主机： [http ://www.dnsexit.com/support/mailrelay/exchange/setup.htm](http://www.dnsexit.com/support/mailrelay/exchange/setup.htm)

我的设置与您描述的类似。您可能想检查您的 SMTP 服务器是否允许对经过身份验证的用户进行中继，因为这可能允许您当前的脚本使用域/电子邮件用户帐户发送电子邮件。

# javascript - 了解如何为我的用户制作 Flair（javascript 片段）

> ID：918007
> 
> 赞同：1
> 
> 时间：2009-05-27T21:05:37.097
> 
> 标签：javascript, html, ajax, iframe, code-snippets

我想为我的用户提供一小段 JavaScript 或 HTML 代码，他们可以将它们放在他们的网站上并显示有关他们的信息。有点像 StackOverFlows 的新功能[Flair](https://stackoverflow.com/users/flair)。

我有一个如何编码的想法。我打算给他们一些带有 DIV id="MySite_Info" 的 HTML 的 JS。然后 JS 会转到我的站点并提取一些 JSON 或 XML，然后用我在他们的站点上提供的 HTML 中的 DIV 填充数据。

**有一个更好的方法吗？**或者我应该遵循的在线示例？创建这些 javascript 片段的最佳方法是什么？（不知道正确的名字是什么）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:16:38.150

有两个基本选项。

1.  图片（和文字图片很烂）
2.  JavaScript - 正如你所描述的

我将采取的方法是：

1.  使用服务器端进程动态生成 JS。这将包括用户数据（使用 JSON 生成器轻松生成合适格式的数据）。
2.  使用标准 DOM 方法构建徽章
3.  找到具有文档 id 的元素并 appendChild 生成的徽章

# objective-c - NSTextFieldCell 坐标

> ID：918008
> 
> 赞同：2
> 
> 时间：2009-05-27T21:05:47.923
> 
> 标签：objective-c, cocoa

我正在尝试获取 NSTextFieldCell 的 NSPoint 坐标，但 NSTextFieldCell 没有从 NSView 继承，因此没有 frame 方法。关于如何解决这个问题的任何想法？

我正在尝试使用 Matt Gemmel 的 MAAttachedWindow 将小助手弹出窗口附加到某些元素。我想将它附加到窗口上的一个区域，除了通过手动弄乱 x 和 y 坐标来破解它之外，我不知道如何获得坐标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T21:19:33.323

您可以调用`[theCell controlView]`以获取对拥有特定单元格的控件的引用。如果`NSTextFieldCell`对象是简单控件的一部分，例如`NSTextField`，则以下内容就足够了：

```
NSRect cellFrame = [[theCell controlView] frame];
NSPoint origin = cellFrame.origin;
//.. 
```

但是，如果`NSTextFieldCell`是更复杂控件的一部分，例如`NSTableView`在多个位置使用单个单元格的 ，您将需要更多信息来确定正确的矩形。`NSCell`提供 方法`representedObject`，它可以帮助您确定在特定时刻单元格中的*哪个*对象。`NSTableView`在不了解您的具体情况的情况下，我不知道在这方面要提供多少细节。

这是一种可能的解决方案，假设您能够从存储在的对象中辨别行和列信息`representedObject`：

```
NSTableView * tableView = [theCell controlView];
id cellObject = [theCell representedObject];

NSInteger row = //... determine from representedObject
NSInteger col = //... determine from representedObject

NSRect cellFrame = [tableView frameOfCellAtColumn:col row:row]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T21:09:16.793

单元格是 NSControl（NSView 子类）拥有的可重用对象。它没有原点，因为它实际上并不代表屏幕上的一个位置，它取决于控件（具有特定的框架矩形）在需要的位置和时间绘制它。例如，考虑一个表格视图，它可能使用一个单元格，该单元格在每一行的多个位置重新绘制。

当单元格被绘制到屏幕上时，控件会传递一个框架矩形，在大多数情况下，这应该是您所需要的。您还可以利用 NSCell 的大小调整方法，它可以告诉您显示其内容需要多少空间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T21:55:14.093

对于使用 MAAttachedWindow，您是否可以改用控件的框架（如果它是单单元格控件），或者在具有特定行的表格视图的情况下使用 NSTableView 布局方法之一？`rectOfRow:`或者`rectOfColumn:`，例如。您可以覆盖 NSTextFieldCell 并将窗口定位在其中一种绘图方法中，但如果可能的话，我会将其保存为我绝对的最后选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T21:46:22.380

它没有坐标。没有可以得到的。单元格的工作方式是视图告诉单元格“<a href="http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSCell_Class/Reference/NSCell.html#//apple_ref/occ /instm/NSCell/drawWithFrame:inView:" rel="nofollow noreferrer">在这里画图"。

因此，如果您不在单元格的绘制方法之一中，并且您确实需要坐标，则需要询问拥有该单元格的视图。通常，这是`[cell controlView]`.

（也许您正在考虑 UIKit？UITableViewCells 与 NSCells 非常不同。）

# ruby-on-rails - 如何使用 capistrano deploy 定位特定的提交 SHA

> ID：918011
> 
> 赞同：38
> 
> 时间：2009-05-27T21:06:54.910
> 
> 标签：ruby-on-rails, ruby, deployment, capistrano

我想知道如何使用 Capistrano 在 Git 中针对特定提交 SHA 进行部署？它应该是这样的

```
cap deploy --version=<sha targeted> 
```

经过大量搜索似乎无法找到答案。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-05-27T21:34:38.957

**对于 Capistrano 2.9 到 3.0：**

```
cap -S revision=80655da8d80aaaf92ce5357e7828dc09adb00993 deploy 
```

**对于旧版本的 Capistrano**，您可以通过执行以下操作部署特定的 git commit/tree/branch/tag：

```
cap -s branch=80655da8d80aaaf92ce5357e7828dc09adb00993 deploy 
```

在某些情况下，可能还需要将 Environment 指定为参数。`production`只是一个例子。

```
cap production -S revision=80655da8d80aaaf92ce5357e7828dc09adb00993 deploy 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-08-17T17:05:56.213

molf 的回答对我不起作用（使用 capistrano 2.11.2）。我不得不使用“修订”而不是分支，如下所示：

```
cap -S revision=80655da8d80aaaf92ce5357e7828dc09adb00993 deploy 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-06-10T09:24:59.647

**卡皮斯特拉诺 3**

在您`deploy.rb`或特定于阶段的文件中，例如`config/deploy/production.rb`

```
set :branch, ENV.fetch('REVISION', 'master') 
```

这允许您指向特定的 git 版本。它接受 SHA，但也接受任何解析为真实版本的内容（例如 git 标签、带注释的标签或分支）。

`REVISION`通过设置环境变量在命令行上使用它，例如

```
bundle exec cap production deploy REVISION=80655da8d80aaaf92ce5357e7828dc09adb00993

bundle exec cap staging deploy REVISION=my-topic-branch 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-13T22:57:16.303

> 问：分支，“主人”

提示输入，但如果按回车，则默认为“主”。

# java - BlazeDS - AMFConnection.call 提供 HTTP 400 状态

> ID：918015
> 
> 赞同：0
> 
> 时间：2009-05-27T21:07:40.680
> 
> 标签：java, blazeds, pyamf

我正在尝试使用 BlazeDS 的 AMFConnection 类连接到 pyamf，但是当我调用 AMFConnection.call() 时，我得到 HTTP 状态 400（错误请求 - “请求正文无法成功解码。”）。我或多或少遵循这个例子：（pyamf.org/wiki/ClientHowTo ...抱歉，我是新用户，所以我想我不能使用超链接。如果你想关注他们）

这是我的代码：

```
package amfconnectiontest;
import flex.messaging.io.amf.client.AMFConnection;
import flex.messaging.io.amf.client.exceptions.*;

public class Main {

public static void main(String[] args) {
    AMFConnection amfConnection = new AMFConnection();

    String url = "http://demo.pyamf.org/gateway/recordset";
    String service = "service.getLanguages";
    try
    {
       amfConnection.connect(url);
    }
    catch (ClientStatusException cse)
    {
       System.out.println(cse);
       return;
    }
    // Make a remoting call and retrieve the result.
    try
    {
       Object result = amfConnection.call(service);
       System.out.println("results: " + result.toString());
    }
    catch (ClientStatusException cse)
    {
       System.out.println(cse);
    }
    catch (ServerStatusException sse)
    {
       System.out.println(sse);
    }

    // Close the connection.
    amfConnection.close();
}
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-21T09:04:57.120

编码/解码 BlazeDS 特定消息（实现 ISmallMessage）的能力已经登陆 PyAMF 主干（r2726 及更高版本）。查看相关票证 - [http://pyamf.org/ticket/581](http://pyamf.org/ticket/581)

这个版本或一个非常相似的版本很可能会变成 0.5。如果您需要连接到 BlazeDS 服务，我建议您检查主干。

# .net - .Net Regex 匹配分组和重复问题

> ID：918016
> 
> 赞同：0
> 
> 时间：2009-05-27T21:07:48.747
> 
> 标签：.net, asp.net, vb.net, regex, asp.net-2.0

我在 ASP.Net 应用程序中有以下 VB.Net 2.0：

```
output = Regex.Replace(output, "<p>(?:(?:\<\!\-\-.*?\-\-\>)|&(?:nbsp|\#0*160|x0*A0);|<br\s*/?>|[\s\u00A0]+)*</p>", String.Empty, RegexOptions.Compiled Or RegexOptions.CultureInvariant Or RegexOptions.IgnoreCase Or RegexOptions.Singleline) 
```

它匹配得很好的示例：

*   `<p></p>`
*   `<p> </p>`
*   `<p><br/><br/></p>`
*   `<p><!-- comment --><!-- comment --></p>`
*   `<p>&nbsp;&nbsp;</p>`
*   `<p><br/>&nbsp;</p>`
*   `<p><!-- comment --><br/><!-- comment --></p>`
*   `<p>&nbsp;<br/></p>`

我想匹配的东西的例子，但它没有：

*   `<p > <!--[if !supportLineBreakNewLine]--><br /> <!--[endif]--></p>`

我如何使小组和重复按照我的意愿工作？

**编辑：**哎呀，忘了评论组。 **编辑＃2：**哎呀，忘记了失败。 **编辑#3：**固定示例。 **编辑#4：**根据答案更新正则表达式

**结论：**

这是我对所有三个答案的基准测试结果。由于这三个现在都匹配了所有内容，因此我在一个文本块上运行了 10,000 次迭代：

```
Mine:
<p\s*>(?:(?:<!--.*?-->)|&(?:nbsp|\#0*160|x0*A0);|<br\s*/?>|[\s\u00A0]+)*</p>
6.312

Gumbo:
<p\s*>(?:[\s\u00A0]+|&(?:nbsp|\#0*160|x0*A0);|<br\s*/?>|<!--(?:[^-]+|-(?!-))*-->)*</p>
6.05

steamer25:
<p\s*>(?:(?:\&nbsp\;)|(?:\&\#0*160\;)|(?:<br\s*/?>)|\s|\u00A0|<!\-\-[^(?:\-\-)]*\-\->)*</p>
6.121 
```

Gumbo 是最快的，所以我将他标记为正确答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:16:24.110

试试这个正则表达式：

```
<p\s*>(?:[\s\u00A0]+|&(?:nbsp|\#0*160|x0*A0);|<br\s*/?>|<!--(?:[^-]+|-(?!-))*-->)*</p> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T21:20:42.883

```
<p\s*>(?:(?:\&nbsp\;)|(?:\&\#0*160\;)|(?:<br\s*/?>)|\s|\u00A0|<!\-\-[^(?:\-\-)]*\-\->)*</p> 
```

您不需要转义尖括号 <> 并且我已经添加了评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T21:53:03.600

啊！我看到了我的问题，它出在 P 标签本身，而不是分组中。

```
<p\s*>(?:(?:<!--.*?-->)|&(?:nbsp|\#0*160|x0*A0);|<br\s*/?>|[\s\u00A0]+)*</p> 
```

注意标签中的 \s*。给大家加分！

# .net - .net UrlEncode - 小写问题

> ID：918019
> 
> 赞同：30
> 
> 时间：2009-05-27T21:08:04.453
> 
> 标签：.net, urlencode

我正在为网关进行数据传输，该网关需要我以 UrlEncoded 形式发送数据。但是，.net 的 UrlEncode 会创建小写标签，并且会中断传输（Java 创建大写）。

任何想法如何强制.net 进行大写 UrlEncoding？

更新1：

.net 输出：

```
dltz7UK2pzzdCWJ6QOvWXyvnIJwihPdmAioZ%2fENVuAlDQGRNCp1F 
```

与 Java 的对比：

```
dltz7UK2pzzdCWJ6QOvWXyvnIJwihPdmAioZ%2FENVuAlDQGRNCp1F 
```

（它是一个base64d 3DES 字符串，我需要维护它的大小写）。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-27T21:44:41.277

我认为你被 C# 给你的东西困住了，并且得到错误表明 UrlDecode 函数在另一端实现得很差。

话虽如此，您应该只需要循环遍历字符串，并且只需将 % 符号后面的两个字符大写即可。这将保持您的 base64 数据完整，同时将编码字符转换为正确的格式：

```
public static string UpperCaseUrlEncode(string s)
{
  char[] temp = HttpUtility.UrlEncode(s).ToCharArray();
  for (int i = 0; i < temp.Length - 2; i++)
  {
    if (temp[i] == '%')
    {
      temp[i + 1] = char.ToUpper(temp[i + 1]);
      temp[i + 2] = char.ToUpper(temp[i + 2]);
    }
  }
  return new string(temp);
} 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-10-13T08:37:45.860

我知道这已经很老了，也许这个解决方案不存在，但这是我在尝试解决这个问题时在谷歌上找到的热门页面之一。

```
System.Net.WebUtility.UrlEncode(posResult); 
```

这编码为大写。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-12-16T16:52:41.973

将 HttpUtility.UrlEncode 中的小写百分比编码替换为正则表达式：

```
static string UrlEncodeUpperCase(string value) {
    value = HttpUtility.UrlEncode(value);
    return Regex.Replace(value, "(%[0-9a-f][0-9a-f])", c => c.Value.ToUpper());
}

var value = "SomeWords 123 #=/ äöü";

var encodedValue = HttpUtility.UrlEncode(value);
// SomeWords+123+%23%3d%2f+%c3%a4%c3%b6%c3%bc

var encodedValueUpperCase = UrlEncodeUpperCase(value);
// now the hex chars after % are uppercase:
// SomeWords+123+%23%3D%2F+%C3%A4%C3%B6%C3%BC 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-02-19T11:32:17.487

这很容易

```
Regex.Replace( encodedString, @"%[a-f\d]{2}", m => m.Value.ToUpper() )

```

即将所有十六进制字母数字组合替换为大写

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-07T15:52:03.660

如果其他人来这里寻找 perl 代码或 PCRE（与 perl 兼容的正则表达式）来解决问题，则将 url-encoding 转换为小写十六进制的 perl 表达式（最短的候选）是：

```
s/%(\X{2})/%\L$1\E/go 
```

和其他方式（小写到大写）

```
s/%(\x{2})/%\U$1\E/go 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-28T19:27:01.973

这是我在 Twitter 应用程序中用于 OAuth 的代码......

```
 Public Function OAuthUrlEncode(ByVal value As String) As String
    Dim result As New StringBuilder()
    Dim unreservedChars As String = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_.~"
    For Each symbol As Char In value
        If unreservedChars.IndexOf(symbol) <> -1 Then
            result.Append(symbol)
        Else
            result.Append("%"c + [String].Format("{0:X2}", AscW(symbol)))
        End If
    Next

    Return result.ToString()
End Function 
```

希望这可以帮助！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-03T10:47:30.160

[这是我对公共`OAuth.OAuthBase`](https://oauth.googlecode.com/svn/code/csharp/OAuthBase.cs)版本`UrlEncode`（适用于 .NET 2.0/3.5）的 VB.NET 转换：

```
' MEH: Made this ReadOnly because the range of unreserved characters is specified in the OAuth spec. Inheritors ought not change it.
Protected Shared ReadOnly unreservedChars As String = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_.~"
' MEH: Added. These are the other characters HttpUtility.UrlEncode does not convert to percent encoding itself.
Protected Shared ReadOnly reservedChars As String = " !'()*" ' If this moves to .NET 4+ ' can be removed.

''' <summary>
''' This is a different Url Encode implementation since the default .NET one outputs the percent encoding in lower case.
''' While this is not a problem with the percent encoding spec, it is used in upper case throughout OAuth.
''' Also the OAuth spec explicitly requires some characters to be unencoded.
''' </summary>
''' <param name="Value">The value to Url encode</param>
''' <returns>Returns a Url encoded string</returns>
''' <revisionhistory>
'''   140313 MEH Fixed to correctly cater for any characters between %80 and %ff, and the O(n^2) IndexOf call.
''' </revisionhistory>
Public Shared Function UrlEncode(ByVal Value As String) As String
    Dim result, buffer As New StringBuilder()

    For Each symbol As Char In Value
        If unreservedChars.IndexOf(symbol) <> -1 Then
            UrlEncodeAppendClear(result, buffer).Append(symbol)
        ElseIf reservedChars.IndexOf(symbol) = -1 Then
            'some symbols produce 2 or more octets in UTF8 so the system urlencoder must be used to get the correct data
            ' but this is best done over a full sequence of characters, so just store this one in a buffer.
            buffer.Append(symbol)
        Else ' These characters are not converted to percent encoding by UrlEncode.
            UrlEncodeAppendClear(result, buffer).AppendFormat(Globalization.CultureInfo.InvariantCulture, "%{0:X2}", AscW(symbol))
        End If
    Next
    UrlEncodeAppendClear(result, buffer)
    Return result.ToString()
End Function

Private Shared percentHex As New RegularExpressions.Regex("(%[0-9a-f][0-9a-f])", RegularExpressions.RegexOptions.Compiled)

''' <summary>
'''  Actually performs the UrlEncode on any buffered characters, ensuring the resulting percents are uppercased and clears the buffer.
''' </summary>
''' 
''' <param name="Result">The result of the UrlEncode is appended here.</param>
''' <param name="Buffer">The current buffer of characters to be encoded. Cleared on return.</param>
''' 
''' <returns>The <paramref name="Result">Result</paramref>, as passed in, with the UrlEncoding of the <paramref name="Buffer">buffer of characters</paramref> appended.</returns>
''' 
''' <remarks>Would like to be an extension method.</remarks>
''' 
''' <revisionhistory>
'''   140313 MEH Created.
''' </revisionhistory>
Private Shared Function UrlEncodeAppendClear(ByVal Result As StringBuilder, ByVal Buffer As StringBuilder) As StringBuilder
    If Buffer.Length > 0 Then
        Result.Append(percentHex.Replace(HttpUtility.UrlEncode(Buffer.ToString), Function(c) c.Value.ToUpperInvariant()))
        Buffer.Length = 0
    End If
    Return Result
End Function 
```

# wcf - WCF 错误：http://www.w3.org/2005/08/addressing/anonymous 需要流安全，但没有协商安全上下文

> ID：918022
> 
> 赞同：2
> 
> 时间：2009-05-27T21:08:57.590
> 
> 标签：wcf, security, binding

我们有一个 Windows 服务，我们正在尝试将其用作 WPF 应用程序的 WCF 主机。它在开发中运行良好，但是当我们尝试转移到生产环境时，我们除了问题什么都没有。通过阅读其他人的帖子，我们弄清楚了如何打开 WCF 日志记录，这是一个很大的帮助。事实证明，我们对服务和客户端的安全绑定不匹配。我们将它们都设置为使用 Windows 安全性，但现在我们尝试将安全模式设置为“无”仍然没有运气，但它仍然无法正常工作。这是我们的服务配置文件的绑定部分：

```
<system.serviceModel>
    <bindings>
      <netTcpBinding>
        <binding name="netTcp">
          <security mode='None'>
          </security>
        </binding>
      </netTcpBinding >
    </bindings>
    <services>

      <service name="CompanyService">
        <endpoint
          address= "our.url.com/CompanyService"
          binding="netTcpBinding"
          contract="CompanyServices.ICompanyService" />
      </service>
    </services>
  </system.serviceModel> 
```

这是我们客户端应用配置的 serviceModel 部分：

```
 <system.serviceModel>
    <bindings>
      <netTcpBinding>
        <binding name="NetTcpBinding_Config" >
          <security mode="None">
          </security>
        </binding>

      </netTcpBinding>
    </bindings>
    <client>
      <endpoint address="our.url.com/CompanyService" binding="netTcpBinding" bindingConfiguration="NetTcpBinding_Config" contract="CompanyServiceProxy.ICompanyService" name="NetTcpBinding_ICompanyService" />
    </client>
  </system.serviceModel> 
```

如果我需要提供额外的信息，请告诉我需要提供什么。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T21:11:31.343

标准的 net.tcp 绑定默认使用 Windows 凭据，而这些确实需要客户端和服务位于同一个 Windows 域中。这里有这种情况吗？？

好的，抱歉，您提到了 security=None（您的列表格式不正确，所以我只看到了实际配置的一小部分）。

我想你的问题真的在于使用的地址：

```
address= "our.url.com/CompanyService" 
```

使用 net.tcp 绑定时，您必须在地址之前指定，因此在客户端和服务器上将其更改为：

```
address= "net.tcp://our.url.com/CompanyService" 
```

另外，我不太明白的是您的标题：它提到了“流媒体”-您是否在任何地方指定了流媒体模式？在您的配置或服务合同中？

马克

# java - 列表

> ID：918026
> 
> 赞同：41
> 
> 时间：2009-05-27T21:10:08.367
> 
> 标签：java, list, generics, bounded-wildcard

我有一个关于泛型的 Java 问题。我宣布了一个通用列表：

```
List<? extends MyType> listOfMyType; 
```

然后在某种方法中，我尝试实例化并将项目添加到该列表中：

```
listOfMyType = new ArrayList<MyType>();
listOfMyType.add(myTypeInstance); 
```

Where`myTypeInstance`只是一个类型的对象`MyType`；它不会编译。它说：

> List<capture#3-of ? 类型中的方法 add(capture#3-of ? extends MyType) extends MyType> 不适用于参数 (MyType)

任何的想法？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-27T21:16:30.740

您不能对 extends 进行“放置”。查看[泛型 - 获取和放置规则](https://stackoverflow.com/questions/1292109/generics-get-and-put-rule)。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-27T21:29:49.077

考虑：

```
class MySubType extends MyType {
}

List<MySubType> subtypeList = new ArrayList<MySubType>();
List<? extends MyType> list = subtypeList;
list.add(new MyType());
MySubType sub = subtypeList.get(0); 
```

`sub`现在包含一个`MyType`非常错误的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-27T21:29:47.233

您不需要在您的情况下使用通配符捕获语法，只需声明

```
List<MyType> listOfMytype; 
```

应该足够了。如果你想确切地知道为什么，[Java 泛型教程](https://web.archive.org/web/20060203125557/http://java.sun.com/j2se/1.5/pdf/generics-tutorial.pdf)比你想知道的更多关于 Java 泛型的深奥疯狂。第 20 页针对您的具体情况。

至于为什么使用通配符捕获添加不起作用，这是因为编译器无法准确确定列表在每种情况下都是 MyType 的哪个子类，因此编译器会发出错误。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-03-23T13:16:05.267

这里有一个类似的线程： [如何将元素添加到通配符通用集合中？](https://stackoverflow.com/questions/176446/how-can-elements-be-added-to-a-wildcard-generic-collection)

要了解泛型的工作原理，请查看以下示例：

```
 List<SubFoo> sfoo = new ArrayList<SubFoo>();
    List<Foo> foo;
    List<? extends Foo> tmp;

    tmp = sfoo;
    foo = (List<Foo>) tmp; 
```

问题是，这不是为局部/成员变量设计的，而是为函数签名设计的，这就是它如此落后的原因。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-03-16T01:19:58.067

我不知道这是否真的对你有帮助，但这是我在调用 Spring Framework 的泛型方法并希望返回泛型列表时必须使用的东西：

```
public <T> List<T> findAll(String tableName,Class<?> table) {
    String sql = "SELECT * FROM "+ tableName ;
    List<?> entities = getSimpleJdbcTemplate().query(sql,
            ParameterizedBeanPropertyRowMapper.newInstance(table));
            return (List<T>) entities;
} 
```

似乎参数化需要您使用 ? 登录列表以接收结果，然后将列表转换为预期的返回类型。

我仍然对仿制药感到眼花缭乱......

# tfs - 基本 Team Explorer 使用问题

> ID：918029
> 
> 赞同：0
> 
> 时间：2009-05-27T21:10:55.323
> 
> 标签：tfs, explorer

我们正在建立一个新的 TFS 2008 实现，作为我们第一次使用 TFS 进行源代码控制。我们在 Visual Studio 2003、2005 和 2008 中有几个项目，以及其他基于脚本/非 Visual Studio 的项目。

我的问题是，对于 Visual Studio 2003 和 2005 项目，我们是否必须安装 Team Explorer 2003/2005 并使用它们将项目添加到源代码管理并签出/签入文件，或者，我们可以只使用 Team Explorer 2008添加项目和签入/签出文件？想法是开发人员可以使用 2008 来检查任何东西，然后打开适当的 Visual Studio 版本来处理他们的本地项目实例，然后在他们的本地 Visual Studio 2008 应用程序中使用 Team Explorer 2008 重新检查它。

令人担忧的是，通过使用 Team Explorer 2008，Visual Studio 2008 可能会对旧系统解决方案 dll 或控制细节进行更改。

感谢您的任何指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T21:25:28.850

这个有可能。我的同事正在使用 Team Explorer 处理非代码文件（Word 文档、帮助文件等），并像使用 VSS 或任何其他 SCC 一样使用它。

作为额外的奖励，我很确定 TFS Server 2008 至少向后兼容 2005 （有一段时间没有针对 2003 运行）。IIRC，我已经针对 2008 TFS 服务器运行了 VSTS 2005 For Developers。

我会为你仔细检查，但我最近重新映像了我的开发机器并且没有重新安装 2005（正在处理新的东西！）。

顺便说一句，就整个开发过程而言，我发现 TFS 可以节省大量时间。IDE 集成是一流的，链接的错误/任务跟踪和变更集，带有警报、注释、内置查询和报告，让我想知道没有它我是如何相处的。

HTH。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T09:37:51.573

VS 2005 和 VS 2008 的 Team Foundation 客户端可以并排安装，因此没有问题（VS 2003 没有，但您可能使用 MSSCCI 提供程序）。

但是，如果您愿意，您可以在 VS 2008（或最新的电动工具中的 Windows Explorer 扩展）中执行所有源代码控制操作，但在 VS 2003/2005 中处理项目时不会出现任何问题。您只需要确保不会意外地从 VS 2008 中打开项目文件，因为这会升级项目格式。

# client-server - 半条命 2 多人游戏协议如何运作？

> ID：918033
> 
> 赞同：22
> 
> 时间：2009-05-27T21:11:42.950
> 
> 标签：client-server, network-protocols

我想知道半条命 2 多人游戏协议如何在反恐精英：来源或失败之日：来源等模组中发挥作用。我相信他们使用了某种混淆和专有压缩算法。我想知道不同类型的消息是如何编码在一个数据包中的。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-27T21:51:26.567

半条命 2、反恐精英：来源等都使用 Valves Source 引擎。Valve 有一个[开发者 wiki](http://developer.valvesoftware.com/wiki/SDK_Docs)，它涵盖了很多东西（它很酷，看看吧！）...

这些文章可能会让您感兴趣：

[客户端/服务器游戏内协议、设计和优化中的延迟补偿方法](http://developer.valvesoftware.com/wiki/Latency_Compensating_Methods_in_Client/Server_In-game_Protocol_Design_and_Optimization)

[源多人网络](http://developer.valvesoftware.com/wiki/Source_Multiplayer_Networking)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-03T08:25:38.593

你应该查看关于半条命的[Luigi Auriemmas 论文。](http://aluigi.altervista.org/papers.htm)你也会在那里找到一个数据包解码器和一些反汇编的算法。

半条命 2 的逆向工程信息可能很难获得，因为它与作弊有关。我猜像[mpcforum](http://www.mpcforum.com)这样的板是你最好的选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T21:50:56.397

这是一个非常复杂的问题，我的建议是看一些开源网络游戏引擎：

*   [http://www.hawksoft.com/hawknl/](http://www.hawksoft.com/hawknl/)
*   [http://www.zoidcom.com/](http://www.zoidcom.com/)
*   [http://sourceforge.net/projects/opentnl](http://sourceforge.net/projects/opentnl)
*   [http://www.gillius.org/gne/](http://www.gillius.org/gne/)

您还可以查看原始半衰期引擎所基于的地震系列的源代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-02T19:08:14.543

尽管细节可能有所不同，但总体框架已经很老了。这是一个快速概述：

在诸如毁灭战士和雷神之锤等早期 fps 游戏中，玩家的位置仅在服务器对您的移动命令的响应时更新。也就是说，您按下前进按钮，客户端将其传达给服务器，服务器更新您在其内存中的位置，然后使用您的新位置将新的游戏状态传递给您的客户端。这导致了非常滞后的比赛：射击，甚至在狭窄的走廊中移动都是预测滞后的游戏。

较新的游戏让客户端自己处理玩家的射击和移动。尽管这导致了无延迟的移动和火灾，但它通过破解客户端代码打开了更多作弊的可能性。现在每个玩家都在自己的计算机上独立移动和射击，并将他们所做的事情传达给服务器。只有当两名玩家相互碰撞或试图同时获得能量时，这才会失效。

现在服务器拥有来自每个玩家的客户端状态流，并且必须同步它们并用它们制作一个连贯的游戏。诀窍是测量每个玩家的延迟。最终目标是能够向侧向移动的敌人发射非常低延迟的武器（例如狙击步枪或轨道炮）并使其正确命中。如果知道每个玩家的延迟，假设玩家 A（延迟 50 毫秒）向 B 开枪（延迟 60 毫秒）。要命中，必须击中 B，B 是 60 毫秒前的位置，而 A 是 50 毫秒前的位置。

这是一个非常粗略的概述，但应该给你一个大致的想法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-08-03T11:59:30.013

我建议您查看 Quake 1-3 引擎。它们与源代码一起提供。半条命的协议可能有点不同，但很可能足够接近。

# sql-server - 如果我将日期时间作为浮点数存储在数据库中，会受到什么影响？

> ID：918035
> 
> 赞同：2
> 
> 时间：2009-05-27T21:12:18.423
> 
> 标签：sql-server, datetime

如果我将日期时间作为浮点数存储在数据库中，会受到什么影响？我有一个很好的理由这样做，所以不要抱怨:)

编辑：我正在考虑将 convert(float, @thedate) 存储在 float 列中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-27T21:31:36.530

什么能咬你？那么第一个浮点数不是一个精确的数据类型，因此可能永远不应该用于任何需要精度的东西。接下来，float 不会自动拒绝错误的日期。接下来，如果您想执行任何日期功能，您首先必须将数据转换回日期时间数据类型，这会浪费服务器资源。

您说您有充分的理由想要这样做，但是有了关于可能是什么的线索，我认为日期应该存储在旨在处理它们的数据类型中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T21:18:31.720

艾伦所说的，加上……维护的根本问题；当其他人进入项目，并在数据库中看到日期时间的浮点数，并尝试对其做错事，或尝试将其重构为正确的类型，或者只是花费数小时仔细研究代码以找出什么是哎呀正在发生。通过广泛记录正在发生的事情以及为什么要这样做，可以在一定程度上缓解整个维护问题，我强烈建议这样做。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T21:21:30.980

这是一篇关于“揭秘 SQL Server DATETIME 数据类型”的好文章

[http://www.sql-server-performance.com/articles/dev/datetime_datatype_p1.aspx](http://www.sql-server-performance.com/articles/dev/datetime_datatype_p1.aspx)

从阅读中可以看出，日期时间似乎存储为 2 个 4 字节整数，或者您可以使用 binary(8)

正如其他人所说，存储为浮点数会导致您失去一些精度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T21:18:20.067

SQLite 使用具有（64 位）双浮点的时间格式（其中一种可用），使用整数部分表示自纪元以来的天数，小数部分表示一天的分数。它似乎运作良好。

请参阅[SQLite 日期和时间函数](http://www.sqlite.org/lang_datefunc.html)“格式 12 是表示为浮点值的儒略日数。”

使用[Julian Dates](http://en.wikipedia.org/wiki/Julian_day) 15 位十进制数字可以为您提供几千年的毫秒精度。

根据[这个 Julian Date Converter](http://aa.usno.navy.mil/data/docs/JulianDate.php)，JD 9999999.99999 是 CE 22666 December 20 11:59:59.1 UT Thursday

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T21:15:03.240

一个人的精度损失。缺乏分辨率是另一回事。

这是一个小问题，但浮点版本 IEEE 754 与 VAX 浮点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T21:21:05.567

你失去了一些精度。我在 SQL Server 中进行了测试：

```
select getdate(), cast(getdate() as float), cast(cast(getdate() as float) as datetime) 
```

你可以看到如果你重复运行这个，你可能会在转换中损失多达 4 毫秒。如果您的数据库支持 smalldatetime 之类的数据类型，并且您只需要精确到秒，那么您可以消除这种差异。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T21:17:03.907

如果您要将数据存储为浮点数，我认为您最好将自纪元以来的秒数存储为浮点数而不是日期时间作为浮点数

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T21:18:50.953

实际上，据我所知，MSSQL 和 Oracle 实际上在内部将日期时间存储为浮点数（如天数和小数天数）

```
select cast(0 as datetime), cast(0.5 as datetime)
1900-01-01 00:00:00.000 1900-01-01 12:00:00.000 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-27T21:19:02.187

无论精度如何 - 根据您选择的数字作为起点，您可能无法进行比较。

如果您无法为每个日期时间创建精确的浮点数，则您可能还有两个日期时间，如果它们解析为不同的浮点数，则可以同时比较一种方式和另一种方式。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-27T21:52:20.277

使用浮点数的一个潜在缺点是您无法使用系统内置的日期操作函数。如果您只进行间隔计算，浮点数可能没问题，但与日历相关的任何事情都可能需要重新发明一些轮子。

顺便说一句，似乎 Oracle 至少使用固定字段来表示其内部日期：

```
选择
  to_char(sysdate, 'YYYY-MM-DD HH24:MI:SS') 作为 Date_Value,
  转储（sysdate）作为内部
从双;

DATE_VALUE 内部                                                   
------- -------------------------------------------- -----------------------------------------
2009-05-28 09:51:12 Typ=13 Len=8: 217,7,5,28,9,51,12,0                          
已选择 1 行

```

# c# - 将 CodeDom 序列化为 XML

> ID：918037
> 
> 赞同：3
> 
> 时间：2009-05-27T21:12:31.997
> 
> 标签：c#, code-generation

有没有办法将 CodeCompileUnit 对象序列化为 XML。

问题是：

```
XmlSerializer xml = new XmlSerializer( typeof(CodeCompileUnit) ); 
```

抛出以下异常：

“无法序列化 System.Collections.IDictionary 类型的成员 System.CodeDom.CodeObject.UserData，因为它实现了 IDictionary。”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T21:24:35.637

XmlSerializer与 IDictionary存在[问题。](http://msdn.microsoft.com/en-us/magazine/cc164135.aspx)现在不推荐使用它，取而代之的是可以序列化 CodeCompileUnit 实例的[DataContractSerializer ：](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.aspx)

```
var serializer = new DataContractSerializer(typeof(CodeCompileUnit));
serializer.WriteObject(Console.OpenStandardOutput(), new CodeCompileUnit()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T21:21:59.887

这是 XML 序列化程序的一个限制：字典不能被序列化（尽管我看不出有什么好的理由）。实际上，如果它们实现 IXmlSerializable （顺便说一句，实现起来确实很痛苦），它们可以被序列化，但对于 UserData 属性来说，情况并非如此......所以你被卡住了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T22:26:11.007

这可能是一个很长的镜头，但是如何序列化它生成的代码，然后从生成的代码中重新隐藏代码域。

这个项目允许您从代码到代码域并返回。

[http://www.codeproject.com/KB/cs/codedom_assistant.aspx](http://www.codeproject.com/KB/cs/codedom_assistant.aspx)

# c# - 将当前鼠标位置传递给 ViewModel？

> ID：918040
> 
> 赞同：3
> 
> 时间：2009-05-27T21:13:03.930
> 
> 标签：c#, wpf, xaml, mvvm

在我的 MVVM 应用程序中，我有一个 Direct3d 渲染窗口，它在一个场景中显示一堆 3d 网格。在那个渲染窗口中，我希望能够单击场景中的一个 3d 网格并移动它，让它跟随鼠标光标。这是典型的 3d 编辑器，在屏幕空间中移动网格。所以我需要能够获得当前的鼠标位置，最好是相对于 Direct3d 渲染窗口。

有什么方法可以做到这一点？

谢谢！

编辑：更改措辞，因为它太笼统并导致混淆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T14:21:28.067

[InputManager.Current.PrimaryMouseDevice 可能是您最好的选择。](http://msdn.microsoft.com/en-us/library/system.windows.input.mousedevice_members.aspx)

将其封装在一个界面中，该界面公开您需要的信息，并使用您最喜欢的 IoC 框架将其注入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T23:29:21.020

我认为这是思考 MVVM 模式的错误方式。让我通过稍微改变你的问题来说明这一点。

*如果您有一些自定义文本编辑控件，将击键事件传递给 ViewModel 的最佳方式是什么？*

将数据绑定到控件，然后在操作控件时通过绑定更新数据不是更好吗？

那么，您有想要在 3D 视图中显示的对象列表吗？按原样传递对象，并使用模板绑定将每个对象类型绑定到描述 3D 对象的 DataTemplate，其中包括与对象中 X、Y、Z 项的绑定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T21:33:02.737

我会在视图模型上声明一个委托并让视图注册到它。这样 viewModel 不需要知道视图并且易于单元测试。

# cocoa - 制作 UILabel 封面并完全匹配 UITextField 内容的简单方法？

> ID：918041
> 
> 赞同：4
> 
> 时间：2009-05-27T21:13:27.470
> 
> 标签：cocoa, cocoa-touch, uitextfield, uilabel

除了用户界面犯罪......我希望在一些用户输入后让 UILabel 替换 UITextField 。有没有一种简单的方法可以做到这一点，所以当 UITextField 被隐藏时，它的值会被一个似乎没有移动的 UILabel 取代......可以这么说，似乎“设置”到了背景中？

我已经设法通过轻推 IB 中的字段并使字体相同来做到这一点，但是随着我慢慢对 Cocoa 感到满意，我想知道框架中的某个地方是否有一个快速的技巧？！？也许某种方法可以从 UITextField 中提取文本的视图？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T21:29:35.690

`UITextField`在to上设置borderStyle 属性`UITextBorderStyleNone`应该使它看起来很像一个`UILabel`.

基本上实现了两个 UITextFieldDelegate 方法，如下所示：

```
- (void)textFieldDidBeginEditing:(UITextField *)textField {
    textField.borderStyle = UITextBorderStyleRoundedRect;
}

- (void)textFieldDidEndEditing:(UITextField *)textField {
    textField.borderStyle = UITextBorderStyleNone;
} 
```

# reportviewer - 将 ReportViewer 从 v8 升级到 v9（VS2005 到 VS2009）

> ID：918043
> 
> 赞同：0
> 
> 时间：2009-05-27T21:14:40.697
> 
> 标签：reportviewer

我有一个 ASP.NET v2 应用程序，我刚刚升级到 ASP.NET v3.5，同时从 VS2005 迁移到 VS2008。该应用程序使用 Microsoft ReportViewer。新版本的 ReportViewer 包含在 VS2008 (v9.0.0.0) 中，但升级向导不会自动将报告从 v8 更新到 v9。

我可以手动更改参考，但想知道是否还有其他事情可以升级？

干杯，罗布。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T23:53:07.460

报告（rdl/rdlc 文件）不需要更新，它们可以正常工作。

# bug-tracking - 是否有无需安装和设置的免费错误跟踪系统

> ID：918053
> 
> 赞同：3
> 
> 时间：2009-05-27T21:18:08.037
> 
> 标签：bug-tracking

我知道以前有人问过这个问题，但我正在寻找免费且仅在线的错误跟踪系统。

我们不是在寻找任何花哨的东西，只是希望测试团队能够记录一些东西，以便测试人员可以回去检查错误。

我查看了 bugzilla，但必须安装它，而且安装过程似乎很长。基本上是在寻找快速而肮脏的东西......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T21:21:20.200

您可以使用[谷歌代码](http://code.google.com/)。它适用于开源项目，因此您的错误将是可见的，但它是免费使用的。

还有[这个](http://www.google.com/search?hl=en&q=free+hosted+bug+tracking&btnG=Search)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T21:24:43.097

如果这是一个班级项目（例如，大学课程项目），您可以在项目期间获得一个免费的[FogBugz](http://www.fogcreek.com/FogBugz/)帐户。[Joel 在Stack Overflow 播客](http://itc.conversationsnetwork.org/series/stackoverflow.html)中多次提到它。我只是建议这样做，因为您没有提供有关您正在从事的项目类型的任何详细信息。这可能不适用于您的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T21:44:10.340

你总是可以使用谷歌文档创建自己的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T21:24:58.633

我们使用[veoproject.com](http://www.veoproject.com)来跟踪我们的错误。这是一个功能齐全的项目管理系统，但非常适合我们的需求。他们有一个运行良好的基本免费帐户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T21:37:25.270

我喜欢[BugHost](http://www.bughost.com/)。

# c# - C# Containers -- 调整大小时垂直填充空间

> ID：918064
> 
> 赞同：1
> 
> 时间：2009-05-27T21:20:36.690
> 
> 标签：c#, user-interface, resize, containers, fill

我是 C# 新手，我一直在做一个小项目来感受 Visual Studio 2008。我正在用 C# 设计 GUI，我有一个带有三个 GroupBox 的 TabControl。这三个 GroupBox 锚定在屏幕的左侧和右侧，并且在水平调整大小时可以完美地工作。

我希望这三个盒子占据屏幕高度的 33%，并优雅地调整大小。我试过搞乱锚定，但我似乎找不到答案。我也一直在寻找类似的东西，但不幸的是，搜索定位容器会产生所有 CSS 和 HTML 内容。

这似乎是一件很常见的事情，但我似乎找不到一种简单的方法来做到这一点。如果有人能指出我正确的方向，我将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:28:43.977

这确实是在黑暗中拍摄，但也许您可以尝试使用拆分面板？

编辑：我刚刚检查了 Visual Studio，我认为 TableLayoutPanel 可能会做你想做的事。

Edit2：该死，被打败了 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T21:32:08.400

试试[TableLayoutPanel](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx)。我相信它完全符合您的要求。它允许您在其区域内定义列和行，以百分比或像素指定它们的宽度（对于列）和高度（对于行）。然后，您可以将一个组框放入每个单元格并将其 Dock 属性设置为 Fill，当 TableLayoutPanel 调整大小时，它会很好地与单元格一起调整大小（这可以通过使用停靠或锚定轻松实现）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T21:24:45.403

处理窗体的[Resize](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.resize.aspx)事件：添加代码以计算其中控件的新大小/位置。注意对控件的 Anchor 属性的干扰。您可能必须锚定到无并自己计算左右位置。

既然你在学习，我猜你不希望得到一个完整的解决方案，而是一个方向。那时我没有代码;-)

# ruby - 重复使用 Cucumber 步骤

> ID：918066
> 
> 赞同：104
> 
> 时间：2009-05-27T21:20:45.083
> 
> 标签：ruby, testing, cucumber

我想重用一些 Cucumber 步骤，但似乎找不到正确的方法。

我想写一个像这样的步骤：

```
Given /^I login with (.*) credentials$/ |type|
  # do stuff with type being one of "invalid" or "valid"
end 
```

但是还有另一个步骤，例如：

```
Given /^I login successfully$
  # call "Given I login with valid credentials"
end 
```

因此，在测试用户身份验证时，我可以使用前者，但在大多数其他地方，我可以使用后者，而实际上不必重新编写代码。

有没有办法调用其他步骤，或者我只是将逻辑放在辅助方法中，然后从每个任务中调用所述方法（基本上是方法提取重构，在阅读我的问题后，我相信这实际上是最好的方法反正）？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2011-12-06T05:24:59.653

请注意，在最新版本的 cucumber 中，在步骤中调用步骤的方法已更改，如果您收到类似“警告：在步骤定义中使用 'Given/When/Then' 已弃用，请使用 'step'改为调用其他步骤：/path/to/step_definitions/foo_steps.rb:631:in `block in '"。有关详细信息，请参阅[黄瓜 wiki](https://cucumber.io/docs/guides/anti-patterns/#support-for-conjunction-steps)。

更改的要点是您现在应该使用`step`or`steps`方法。

```
When /^I make all my stuff shiny$/
  step "I polish my first thing"
end

When /^I make all my stuff shiny$/
  steps %Q{
    When I polish my first thing
    When I shine my second thing
  }
end 
```

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2009-05-28T11:05:55.280

**更新**：下面描述的方法已被弃用。从另一个步骤中调用一个步骤的推荐方法现在如下所示：

```
Given /^I login successfully$/
    step "I login with valid credentials" 
end 
```

* * *

*旧的，不推荐使用的方法（供参考）：*

您可以从其他步骤调用步骤，如下所示：

```
Given /^I login successfully$/
  Given "I login with valid credentials"
  Then "I should be logged in"
end 
```

如果功能中的所有场景都需要此（或其他步骤），您还可以使用通用步骤为每个功能添加背景，如下所示：

```
Background:
  Given I log in with valid credentials

Scenario: Change my password
  Given I am on the account page 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2012-03-02T20:01:36.303

从步骤定义中调用步骤是一种不好的做法，并且有[一些缺点](https://groups.google.com/d/msg/cukes/Zi5IIAr4dJg/S9A0cnNc0G4J)：

1.  如果场景将失败并且存在嵌套的步骤调用，您将仅获得堆栈跟踪中最后调用的步骤定义。可能很难找到最后一个 stepdef 是从哪个地方调用的
2.  调用 stepdef 有时比 ruby​​ 方法更难找到和阅读
3.  Ruby 方法比从 step defs 调用步骤更强大

Aslak Hellesøy[建议](http://aslakhellesoy.com/post/11055981222/the-training-wheels-came-off#comment-414457061)将流行动作提取到[World](https://github.com/cucumber/cucumber/wiki/A-Whole-New-World)，而不是重用步骤。它将这些操作隔离在一个地方，使此代码更容易找到。您也可以将代码提取到常用的 Ruby 类或模块中。

```
#/support/world_extensions.rb
module KnowsUser
  def login
    visit('/login')
    fill_in('User name', with: user.name)
    fill_in('Password', with: user.password)
    click_button('Log in')
  end

  def user
    @user ||= User.create!(:name => 'Aslak', :password => 'xyz')
  end
end
World(KnowsUser)

#/step_definitions/authentication_steps.rb
When /^I login$/ do
  login
end

Given /^a logged in user$/ do
  login
end 
```

这是 Cucumber 邮件列表中有关该主题的有用讨论 -[链接](https://groups.google.com/forum/?hl=en&fromgroups=#!topic/cukes/DzE_kGZx94I)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-02-21T03:22:55.717

最好用 %{} 而不是引号将您的步骤包装起来。然后，您不需要转义需要经常使用的双引号。：

```
Given /^I login successfully$
  step %{I login with valid credentials}
end

Given /^I login with (.*) credentials$/ |type|
  # do stuff with type being one of "invalid" or "valid"
end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-30T22:29:13.740

在功能文件中重用关键字，这将提供代码可重用性。

强烈不建议在 step defs 中调用 step defs。

我会这样写我的功能文件，

```
Scenario Outline: To check login functionality
    Given I login with "<username>" and "<password>"
    Then I "<may or may not>" login successfully

Examples:
    |username|password|may or may not|
    |paul    |123$    |may           |
    |dave    |1111    |may not       | 
```

在我的步骤定义中，（这是 Java）

```
@Given(I login with \"([^\"]*)\" and \"([^\"]*)\"$)
public void I_login_with_and(String username, String password){

   //login with username and password

}

@Then(I \"([^\"]*)\" login successfully$)
public void I_login_successully_if(String validity){

    if(validity.equals("may")){
        //assert for valid login
    }
    else
    if(validity.equals("may not")){
        //assert for invalid login
    }
} 
```

这样一来，就有很多代码的复用性。你同样的 Given and Then 处理有效和无效的场景。同时，您的功能文件对读者有意义。

# python - Python中有没有办法通过容器的元素来索引容器列表（元组、列表、字典）？

> ID：918076
> 
> 赞同：1
> 
> 时间：2009-05-27T21:22:43.583
> 
> 标签：python, indexing, list, containers

我一直在寻找一个食谱/示例来索引元组列表，而无需修改装饰、排序、未装饰方法。

例如：

```
l=[(a,b,c),(x,c,b),(z,c,b),(z,c,d),(a,d,d),(x,d,c) . . .] 
```

我一直在使用的方法是使用第二个元素的 defaultdict 构建字典

```
from collections import defaultdict

tdict=defaultdict(int)

for myTuple in l:
    tdict[myTuple[1]]+=1 
```

然后我必须为列表中的每个项目构建一个仅包含元组中的第二个项目的列表。虽然有很多方法可以到达那里，但一个简单的方法是：

```
tempList=[myTuple[1] for myTuple in l] 
```

然后生成 tdict 中每个项目的索引

```
indexDict=defaultdict(dict)
for key in tdict:
    indexDict[key]['index']=tempList.index(key) 
```

显然，这似乎不是很 Pythonic。我一直在尝试寻找示例或见解，认为我应该能够使用一些神奇的东西来直接获取索引。到目前为止还没有这样的运气。

请注意，我知道我可以更直接地采取我的方法，而不会产生 tdict。

输出可以是带有索引的字典

```
indexDict={'b':{'index':0},'c':{'index':1},'d':{'index':4},. . .} 
```

在从 Nadia 的回答中学到了很多之后，我认为答案是否定的。

虽然她的反应有效，但我认为这比需要的要复杂。我会简单地

```
 def build_index(someList):
    indexDict={}
    for item in enumerate(someList):
        if item[1][1] not in indexDict:
           indexDict[item[1][1]]=item[0]
    return indexDict 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T21:44:16.533

这将产生你想要的结果

```
dict((myTuple[1], index) for index, myTuple in enumerate(l))

>>> l = [(1, 2, 3), (4, 5, 6), (1, 4, 6)]
>>> dict((myTuple[1], index) for index, myTuple in enumerate(l))
{2: 0, 4: 2, 5: 1} 
```

如果你坚持使用字典来表示索引：

```
dict((myTuple[1], {'index': index}) for index, myTuple in enumerate(l)) 
```

结果将是：

```
{2: {'index': 0}, 4: {'index': 2}, 5: {'index': 1}} 
```

* * *

**编辑** 如果您想处理密钥冲突，那么您必须像这样扩展解决方案：

```
def build_index(l):
    indexes = [(myTuple[1], index) for index, myTuple in enumerate(l)]
    d = {}
    for e, index in indexes:
        d[e] = min(index, d.get(e, index))
    return d

>>> l = [(1, 2, 3), (4, 5, 6), (1, 4, 6), (2, 4, 6)]
>>> build_index(l)
{2: 0, 4: 2, 5: 1} 
```

* * *

**编辑 2**

[以及更通用和更紧凑的解决方案（与sorted](http://docs.python.org/library/functions.html?highlight=sorted#sorted)的定义相似）

```
def index(l, key):
    d = {}
    for index, myTuple in enumerate(l):
        d[key(myTuple)] = min(index, d.get(key(myTuple), index))
    return d

>>> index(l, lambda a: a[1])
{2: 0, 4: 2, 5: 1} 
```

所以你的问题的答案是肯定的：在 Python 中有一种方法可以通过容器的元素来索引容器列表（元组、列表、字典），而无需预处理。但是您将结果存储在字典中的要求使得不可能成为单行。但是这里没有预处理。该列表仅迭代一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T21:32:25.437

如果我认为这就是你要问的...

```
l = ['asd', 'asdxzc']
d = {}

for i, x in enumerate(l):
    d[x] = {'index': i} 
```

# jquery - 在可排序的 jQuery 中选择文本框的内容

> ID：918088
> 
> 赞同：1
> 
> 时间：2009-05-27T21:26:09.300
> 
> 标签：jquery, jquery-ui, select, jquery-ui-sortable

我正在尝试在 jQuery 中的可排序项目中获取 textarea 的内容......我似乎无法弄清楚！这是我现在拥有的：

```
jQuery(document).ready(function() { 
    jQuery("#list").sortable({
        axis : 'y' ,
        revert : 'true' ,
    opacity : 0.5 ,
    stop : function (e, ui) {
        jQuery("input#output"); 
    }
    });                             
}); 
```

这必须如此简单，当我知道如何做到这一点时，我会打自己的头，但这么说，我就是想不通。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T21:31:57.573

只是想一些你可以尝试的东西（不看你的 html 标记）

```
jQuery(this).children('textarea#output').val();
jQuery(this).children('#output').val(); // this line may be all you need as well 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T21:29:46.393

**编辑：**对于文本区域，“输入#输出”选择器不起作用。这仅适用于文本框。要访问内容，只需添加 .val()

```
jQuery(this).children("textarea#output").val(); //for a textarea
jQuery(this).children("input#output").val(); //for a textbox 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T13:00:59.010

*stop 函数中的ui*将刚刚移动的可排序对象保存在*ui.item*中。

```
ui.item.children("textarea.output").val();  //whatever one you may need.
ui.item.children(".output").val();
ui.item.children("textarea").val(); 
```

我还将“#output”更改为“.output”，因为标准做法是不要有多个具有相同 id 的元素（假设在每个可排序项目中都有一个带有输出 id 的文本框。）如果它们相似元素，而是让它们成为同一个类。

# c# - Unit testing failing due to 0.000000001f inaccuarcy

> ID：918097
> 
> 赞同：4
> 
> 时间：2009-05-27T21:29:24.693
> 
> 标签：c#, unit-testing

A vector is out by 0.000000001f so the test is failing.

Doing the logic in my head yeilds -1.0f, -1.0f but when I wrote the code to pass the test (Using the built in Vector methods) the answer comes back as -0.999999999f, -0.999999999f which is still 'right'.

This is C# (Vector2 class provided by the XNA framework) by the way, so I tried adding an epsilon value to each the x and y parameter of the Vector but this didn't work.

The way I see it is that by coding the answer, I'm writing the production code. E.g. it would be the same. Surely this is not the right.

Any advice?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T21:34:29.393

Unit testing frameworks usually provide asserts for floats that take a precision. For example in Visual Studio Test you can write:

```
Assert.AreEqual(1.0f, 0.9999999999f, 1e-3); // passes
Assert.AreEqual(1.0f, 0.9f, 1e-3); // fails 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T21:31:29.633

Please see my answer [here](https://stackoverflow.com/questions/588004/is-javascripts-math-broken/588014#588014).

It is not about C#, but the same logic applies.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T21:32:59.863

Using an epsilon value should work, you could post the code that doesn't work to make your problem clearer. You should do something like this:

```
if ((TestSomething()->Vector.x - 1.0f) <= EPSILON) return true; 
```

instead of

```
if (TestSomething()->Vector.x = 1.0f) return true; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T21:32:49.677

Floating point numbers can have precision issues, besides comparison to 0 you rarely would want to compare two floating point numbers using ==.

Trying to add an epsilon value to the vectors won't work - you'll still fall for the same precision issues.

Instead, you need to see if the difference between the two is below some threshold:

```
if (Math.Abs(x - y) < epsilon)
{
     // Equal!
} 
```

# c# - 如何在不逐个单元格的情况下将数据从 DataSet 存储到 Excel？

> ID：918102
> 
> 赞同：0
> 
> 时间：2009-05-27T21:29:57.077
> 
> 标签：c#, visual-studio-2008, excel, dataset

**重复**：[将 System.Data.DataSet 导入 Excel 的最简单方法是什么？](https://stackoverflow.com/questions/524559/whats-the-simplest-way-to-import-a-system-data-dataset-into-excelb)

在 VS2008 下使用 c#，我们可以通过以下方式创建一个 excel 应用程序、工作簿和工作表：

```
Application excelApp = new Application();
Workbook excelWb = excelApp.Workbooks.Add(template);
Worksheet excelWs = (Worksheet)this.Application.ActiveSheet; 
```

然后我们可以通过“excelWs.Cells[i,j]”访问每个单元格并毫无问题地写入/保存。但是，对于大量的行/列，我们预计效率会下降。

有没有一种方法可以在不使用逐个单元格的方法的情况下将 DataSet 对象“数据绑定”到工作表中？我们看到的大多数方法在某些时候都会恢复为逐个单元格的方法。感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T22:09:53.800

您还可以将 GridView 呈现为字符串并将结果作为 HTML 或 XLS 保存到客户端。如果使用 XLS 文件扩展名将数据与 Excel 关联，则在 Excel 中打开文件时会看到错误。它不会伤害任何东西，您的 HTML 数据将在 Excel 中打开并看起来很完美......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T21:35:21.543

为什么不使用 OLEDB 提供程序来使用 ADO.NET？

请参阅：[使用 ADO.NET 阅读 Excel 电子表格的提示](http://blog.lab49.com/archives/196)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T21:35:57.270

这是一个重复的问题。

请参阅：[将数据集导入 Excel 的最简单方法是什么](https://stackoverflow.com/questions/524559/whats-the-simplest-way-to-translate-a-system-data-dataset-into-excel)

（答案是，使用 OleDbConnection 并从 Excel 中读取数据集）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T21:51:30.047

将二维对象数组设置为 excel 范围，而不是逐个单元格地进行。

```
object[][] values = ...
ws.Range("A1:F2000").Value = values; 
```

但是，OleDb 方式仍然比上面的要快得多。

# math - 计算机程序的结构和解释，需要什么水平的数学能力？

> ID：918119
> 
> 赞同：9
> 
> 时间：2009-05-27T21:33:18.647
> 
> 标签：math, sicp

遗憾的是，我从 16 岁（GCSE 级别）开始就没有学习数学，我现在是一名 27 岁的 C# 开发人员。尝试通过*[计算机程序的结构和解释](http://en.wikipedia.org/wiki/Structure_and_Interpretation_of_Computer_Programs)*(SICP) 进行工作会是徒劳的吗？

读者期望什么样的数学标准？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-31T17:22:58.767

在完成[了所有 SICP 之后](http://eli.thegreenplace.net/2008/04/18/sicp-conclusion/)，我可以自信地告诉你，你不需要很多数学背景来理解它。SICP 是（曾经是？）麻省理工学院的第一或第二学期课程，适用于几乎没有大学/大学数学水平的学生。每当它讨论数学主题时，它都为任何聪明的读者提供了足够的背景知识来理解。

从您对自己的了解来看，现在正是通过 SICP 工作的好时机。阅读本书并解决（至少一些）练习，并使用项目的代码，可以教你很多关于编程的知识。不要担心数学 - 你会毫无问题地处理它。真正需要的是对编程真正的、深刻的好奇心，以及一些耐心。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-31T17:17:05.170

开始 SICP 永远不会太晚。而且它根本不需要任何更高的数学，除了可能在具有无限流部分的信号处理中。可以跳过而不会损失太多。

阅读 SICP 时最重要的是解决问题，IMO。一些较难的可以扩展思维并迫使您**真正**理解该主题。如果您对某些解决方案有信心，您可以跳过它。解决方案可以在 - [http://eli.thegreenplace.net/category/programming/lisp/sicp/](http://eli.thegreenplace.net/category/programming/lisp/sicp/)

阅读 SICP 的危险在于，读完之后，你不会喜欢使用[Scheme](http://en.wikipedia.org/wiki/Scheme_%28programming_language%29)以外的任何编程语言。:)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T21:48:56.103

我对这本书很感兴趣。我的数学知识不是很好……但有一个关键：

为了理解这样的事情，只要你有**创造性的头脑**，并且很好地掌握了结构和数学原理的**抽象**本质，你应该没问题。以任何人的标准来看，我的心算都很差，但我喜欢阅读**离散数学**，因为它是抽象的。

在数字意义上，我不会认为自己是一个非常好的数学家，但作为一名软件开发人员，我喜欢认为我有数学（或机械）头脑。

我不会太担心你的**数字实力**，而是更担心数学的*本质*和支撑计算机科学的概念的个性。如果您有良好的编程头脑，也许可以尝试使用组合数学/离散数学/具体数学（除了计数理论，在许多情况下避免*干数*）来增强它。

我发现自己喜欢学习编译器的集合论之类的东西，而且我不想在没有大量死记硬背的情况下参加我的数学 A-level！

试一试，**你有什么损失？**

（我 22 岁，和你情况类似）

**祝你好运**

PS：我也发现视频讲座很有趣。你可以从

[http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/](http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T21:47:43.843

从这本书的记忆中，它谈到了一些矩阵计算，一开始可能很难理解。但它只是列表列表或数组数组......所以你迟早需要在编程中处理它。

如果有任何困难的数学，我想你可以跳过它。这本书在伯克利大学一年级的计算机科学课（很多学生在第一学期学习）中使用过（并且可能现在仍然使用过），根本不需要理解微积分，所以我认为对数学的一般理解足以理解书。

这本书谈到了一个函数是一个黑匣子……读完这本书后，我认为它也有助于一个人对数学的理解。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T21:52:39.403

这绝对不会是徒劳的练习，这是一本很棒的书。另一方面，这会有点困难，因为他们确实希望你有一些数学复杂性，如果不是大量的高级数学。

您可能会发现Felleisen 等人的[How to Design Programs](https://rads.stackoverflow.com/amzn/click/com/0262062186)，它的开始有点容易，同时使用 Scheme 和所有方法为您提供了几乎相同的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T21:47:44.297

数值编程部分可能需要一些更高的数学，但你应该能够用高中数学来消化本书的其余部分。

# perl - 如何使用 Perl 进行批量搜索和替换？

> ID：918128
> 
> 赞同：6
> 
> 时间：2009-05-27T21:35:28.127
> 
> 标签：perl, replace, bulk

我有以下脚本，它接收输入文件、输出文件并用其他字符串替换输入文件中的字符串并写出输出文件。

我想更改脚本以遍历文件目录，即不提示输入和输出文件，脚本应将目录路径作为参数，例如 C:\temp\allFilesTobeReplaced\ 并搜索字符串 x 并替换它用 y 表示该目录路径下的所有文件并写出相同的文件。

我该怎么做呢？

谢谢。

```
$file=$ARGV[0];

open(INFO,$file);
@lines=<INFO>;
print @lines;

open(INFO,">c:/filelist.txt");

foreach $file (@lines){
   #print "$file\n";
   print INFO "$file";
}

#print "Input file name: ";
#chomp($infilename = <STDIN>);

if ($ARGV[0]){
   $file= $ARGV[0]
}

print "Output file name: ";
chomp($outfilename = <STDIN>);
print "Search string: ";
chomp($search = <STDIN>);
print "Replacement string: ";
chomp($replace = <STDIN>);

open(INFO,$file);
@lines=<INFO>;
open(OUT,">$outfilename") || die "cannot create $outfilename: $!";

foreach $file (@lines){    
    # read a line from file IN into $_
    s/$search/$replace/g; # change the lines
    print OUT $_; # print that line to file OUT
}
close(IN);
close(OUT); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T23:09:25.753

perl 单行列的使用

```
perl -pi -e 's/original string/new string/' filename 
```

可以结合`File::Find`, 给出以下单个脚本（这是我用于许多此类操作的模板）。

```
use File::Find;

# search for files down a directory hierarchy ('.' taken for this example)
find(\&wanted, ".");

sub wanted
{
    if (-f $_)
    {
        # for the files we are interested in call edit_file().
        edit_file($_);
    }
}

sub edit_file
{
    my ($filename) = @_;

    # you can re-create the one-liner above by localizing @ARGV as the list of
    # files the <> will process, and localizing $^I as the name of the backup file.
    local (@ARGV) = ($filename);
    local($^I) = '.bak';

    while (<>)
    {
        s/original string/new string/g;
    }
    continue
    {
        print;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T16:30:05.593

您可以使用 -i 参数执行此操作：

只需正常处理所有文件，但包括 -i.bak：

```
#!/usr/bin/perl -i.bak

while ( <> ) {
   s/before/after/;
   print;
} 
```

这应该处理每个文件，并将原始文件重命名为 original.bak 当然，您可以将其作为@Jamie Cook 提到的单行

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T21:41:01.720

试试这个

```
#!/usr/bin/perl -w

@files = <*>;
foreach $file (@files) {
  print $file . '\n';
} 
```

还看一下 Perl 中的 glob：

*   [http://perldoc.perl.org/File/Glob.html](http://perldoc.perl.org/File/Glob.html)
*   [http://www.lyingonthecovers.net/?p=312](http://www.lyingonthecovers.net/?p=312)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T22:11:10.380

我知道您可以从命令行使用简单的 Perl 单行程序，其中文件名可以是单个文件名或文件名列表。您可能可以将此与 bgy 的答案结合起来以获得所需的效果：

```
perl -pi -e 's/original string/new string/' filename 
```

而且我知道这很陈词滥调，但这听起来很像 sed，如果您可以使用 gnu 工具：

```
for i in `find ./allFilesTobeReplaced`; do sed -i s/original string/new string/g $i; done 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-04-28T13:28:59.950

perl -pi -e 's#OLD#NEW#g' 文件名。您可以用适合您的文件列表的模式替换文件名。

# perl - 为什么我的 Perl if 条件总是评估为真？

> ID：918137
> 
> 赞同：1
> 
> 时间：2009-05-27T21:37:37.203
> 
> 标签：perl, file, if-statement, file-read

在 Perl 中，我需要读取一个包含 0 或 1 的 .conf 文件。如果值为 1，我需要执行 if 语句中的任何内容。这是我现在拥有的：

```
open(CONF, "/var/web/onhit.conf");
if(<CONF>) {
   print "Hello World!";
}
close(CONF); 
```

if 语句的内容总是评估，即使 .conf 文件包含 0。我知道文件读取是正确的，因为这段代码可以正确读取文件：

```
open(CONF, "/var/web/onhit.conf");
print <CONF>;
close(CONF); 
```

如果文件包含 1，则打印 1，反之亦然。有谁知道我的第一个片段有什么问题？抱歉，我是 Perl 的 n00b。:-)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T21:48:00.567

编辑：显然，你的帖子的真值倒置了，你的意思是说 if() 语句*总是*执行的。这是有道理的。发生的情况是`<CONF>`读取字符串`"1\n"`or `"0\n"`，而不是数字`1`or `0`。尾随换行符防止`"0"`评估为假，因此您需要`chomp()`它（或使用该`int()`函数，如另一篇文章中所述）。无论哪种方式都应该有效。

（请注意，不幸的是，`chomp()`它*不*返回`chomp()`ed 字符串，而是计算它删除了多少个字符，所以你不能只说`if(chomp(my $tmp = <CONF>))`并完成它。）

无论如何，这就是我所做的：

```
open(CONF, "/var/web/onhit.conf");
chomp(my $tmp = <CONF>);
if($tmp) {
  print "Hello, world!\n";
}
close CONF; 
```

一些建议：

*   考虑使用 的三参数形式`open()`，或者至少`"<"`在文件名前面指定。
*   考虑使用变量来保存文件句柄 ( `$conf`)，而不是使用旧的、笨拙的文件句柄形式 ( `CONF`)。

这是我会写的代码：

```
open my $conf, "<", "/var/web/onhit.conf";
chomp(my $tmp = <$conf>);
if($tmp) {
  print "Hello, world!\n";
}
close $conf; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T21:49:38.723

您只需使用 int 函数将字符串转换为整数。

```
open(CONF, "/var/web/onhit.conf");
if(int(<CONF>)) {
    print "Hello World!";
}
close(CONF); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T02:34:39.710

或者您可以在比较中包含换行符：

```
if (<CONF> =~ /^1$/) {
} 
```

# wcf - Windows 2008 x64 - WCF IIS - OracleException ORA-12154：TNS：无法解析指定的连接标识符

> ID：918142
> 
> 赞同：0
> 
> 时间：2009-05-27T21:38:56.593
> 
> 标签：wcf, oracle, iis, windows-server-2008, ora-12154

我有**WCF**服务托管在**Windows 2008 x64**机器上的**IIS中。**此 WCF 服务需要访问 Oracle 数据库，但当它尝试这样做时会遇到 OracleException 并显示以下错误消息：

 ****ORA-12154: TNS: 无法解析指定的连接标识符**

我尝试使用通用数据链接 (UDL) 文件测试与 Oracle 数据库的连接，并且工作正常。我可以假设我的 Windows 2009 服务器上正确安装了 Oracle 客户端吗？如果是这样，还有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-02T19:02:34.620

尝试对您的 oracle 服务器使用 TNSPING，它会告诉您是否可以建立连接。

还要检查您是否在该机器上安装了多个 Oracle 客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T21:48:14.653

检查您的[tnsnames 文件](http://www.orafaq.com/wiki/Tnsnames.ora)。更多关于[该错误的描述here](http://ora-12154.ora-code.com/)。

# asp.net - Asp.net sql server 2005 超时问题

> ID：918150
> 
> 赞同：2
> 
> 时间：2009-05-27T21:41:22.187
> 
> 标签：asp.net, sql-server, sql-server-2005

嗨，我们的 asp.net 应用程序正在超时。我们使用 sql server 2005 作为数据库。查询在查询分析器中运行得非常快。但是，当我们通过分析器检查时间时，它显示的时间是我们在查询分析器中获得的时间的许多倍。（参数sinffing不是原因）非常感谢任何帮助

谢谢

我们在 SAN 上清除了计数器。新的计数器是

ASYNC_NETWORK_IO 540 9812 375 78

写日志 70 1828 328 0

超时仅发生在具有特定参数集的特定 SP 上。如果我们更改参数并访问应用程序，它工作正常。我们运行了探查器，发现在 asp.net 端发生超时后，探查器中出现了 SP batchcompleted 语句。如果我们重新启动服务器一切正常

如果我们从缓存中删除计划，则应用程序可以正常工作。然而，我们已经考虑了 sp 中的参数嗅探。还有什么可能是原因

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-14T12:35:49.153

运行以下脚本来创建这个存储过程：

```
CREATE PROC [dbo].[dba_SearchCachedPlans]
    @StringToSearchFor VARCHAR(255)
AS
/*---------------------------------------------------------------------- 
Purpose: Inspects cached plans for a given string. 
------------------------------------------------------------------------ 
Parameters: @StringToSearchFor - string to search for e.g. '%<MissingIndexes>%'. 
Revision History: 
         03/06/2008  Ian_Stirk@yahoo.com Initial version 
Example Usage: 
1\. exec dba_SearchCachedPlans '%<MissingIndexes>%'
2\. exec dba_SearchCachedPlans '%<ColumnsWithNoStatistics>%'
3\. exec dba_SearchCachedPlans '%<TableScan%'
4\. exec dba_SearchCachedPlans '%CREATE PROC%MessageWrite%'    
-----------------------------------------------------------------------*/ 
BEGIN 
    -- Do not lock anything, and do not get held up by any locks. 
    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED 

    SELECT TOP 100
            st.TEXT AS [SQL],
            cp.cacheobjtype,
            cp.objtype,
            DB_NAME(st.dbid) AS [DatabaseName],
            cp.usecounts AS [Plan usage],
            qp.query_plan
    FROM    sys.dm_exec_cached_plans cp
            CROSS APPLY sys.dm_exec_sql_text(cp.plan_handle) st
            CROSS APPLY sys.dm_exec_query_plan(cp.plan_handle) qp
    WHERE   CAST(qp.query_plan AS NVARCHAR(MAX)) LIKE @StringToSearchFor
    ORDER BY cp.usecounts DESC 
END 
```

然后执行：

```
exec dba_SearchCachedPlans '%<MissingIndexes>%' 
```

并查看您是否缺少任何推荐的索引。

当 SQL Server 创建计划时，它会保存它以及任何推荐的索引。只需单击 query_plan 列文本即可显示图表。在顶部会有您应该实施的推荐索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T21:45:41.680

如果我猜测一下，我会假设来自网络服务器的后台数据库负载正在提升锁并导致整个事情变慢。然后你进行一个大型查询并运行它，这会导致锁（和资源）争用。

我经常看到公司*抱怨*他们的客户端-服务器应用程序从一个 SQL 服务器转移到一个集群时出现性能问题。在网络世界中，我们更早地得到这些问题。

解决方案（大多数时候）使用以下之一锁定问题： * 重构查询以更好地工作（例如，存储 SCOPE_IDENTITY 而不是调用它 5 次） *​​ 在任何有意义的地方使用[NO LOCK 语句。](http://www.sql-server-performance.com/articles/per/lock_contention_nolock_rowlock_p1.aspx)

编辑：

此外，尝试使用新的 2008 SQL Management Studio ['Activity Monitor'](http://www.sql-server-performance.com/articles/dba/%20New_Features_in%20_SSMSPart1_p1.aspx)查看服务器。您可以通过右键单击服务器并选择“活动监视器”来找到它。

*   转到进程部分并查看有多少进程正在“等待”。您的等待时间应该接近 0。如果您在“等待类型”下看到很多东西，请发布屏幕截图，我可以让您了解下一步是什么。
*   转到“资源等待”部分，看看那里的数字是什么样的。您的服务员应始终接近 0。
*   并且“最近的昂贵查询”非常棒，可以查看您可以采取哪些措施来提高您的总体表现。

编辑#2：

它慢了多少？您的 SAN 似乎占用了大约 10 秒的时间，但是如果您说的是 20 秒与 360 秒，那么这将无关紧要，并且没有等待锁定，所以我想我是在画一个空白。如果差异在 1 秒到 10 秒之间，那么它似乎与网络有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T20:21:57.293

我遇到过类似的问题，我的情况与 SP 重新编译有关。具体来说，这是我对临时表与表变量的使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-11T19:44:17.650

我以前有几次完全相同的问题。当特定用户在部署站点时，它似乎发生在我身上。当该用户使用他们的 ID 运行某些存储过程时，它会超时。当其他人运行它，或者我从数据库运行它时，它会立即运行。我们让我们的 DBA 尽其所能地观察，但他们从未得到答案。最后，每当我重新部署站点并且用户尚未登录时，一切都已修复。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-10T17:28:57.690

我没有你的答案，因为我不是大师。但我确实记得最近在一些 SQL 博客上读到，SQL 2008 有一些额外的东西可以添加到查询/存储过程中，因此它以不同的方式计算事物。我认为您可以尝试搜索的一件事称为“提示”。此外，SQL 如何使用当前的“统计信息”也会有所不同。看那个。以及如何仅为第一次运行生成执行计划——如果该计划不适用于不同的参数值，因为搜索/返回的内容会有很大差异，我认为它可以呈现这种行为。

抱歉，我不能提供更多帮助。我只是对这个级别的 SQL Server 性能感到兴奋。我敢打赌，如果你问像[Brent Ozar](https://serverfault.com/users/431/brent-ozar)这样的人，他可以为你指明正确的方向。

# sql-server - 安装 SQL Server 2008 时删除 Visual Studio 2008 安装的 SQL Server 2005 Express 是否安全？

> ID：918151
> 
> 赞同：4
> 
> 时间：2009-05-27T21:41:22.280
> 
> 标签：sql-server, visual-studio, visual-studio-2008, sql-server-2005, sql-server-2008

还是一切都会爆炸并杀死几只小猫？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T21:47:14.890

绝对地。引擎彼此隔离，因此，您可以并行运行，也可以根据需要删除/卸载组件。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T21:48:18.133

那应该是安全的。

我们遇到的问题是：如果我们先安装 SQL Express，那么当您安装 SQL Server 时，管理控制台将不会安装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T22:07:15.943

当我试图完全按照您的要求进行操作时，我的小猫零件四处飞溅。所以我把它全部烧掉并重新安装，首先安装 SQL Server 2008，然后确保取消选择 Visual Studio 安装中的数据库组件。

到目前为止一切顺利，但我的 SQL Server 安装使用很少。

# python - Python中的相对路径

> ID：918154
> 
> 赞同：355
> 
> 时间：2009-05-27T21:43:21.543
> 
> 标签：python, relative-path, path

我正在为工作构建一个简单的帮助脚本，它将我们代码库中的几个模板文件复制到当前目录。但是，我没有存储模板的目录的绝对路径。我确实有来自脚本的相对路径，但是当我调用脚本时，它会将其视为相对于当前工作目录的路径。有没有办法指定这个相对 url 来自脚本的位置？

* * *

## 回答 #1

> 赞同：472
> 
> 时间：2009-05-27T21:47:50.240

在包含脚本的文件中，您想要执行以下操作：

```
import os
dirname = os.path.dirname(__file__)
filename = os.path.join(dirname, 'relative/path/to/file/you/want') 
```

这将为您提供要查找的文件的绝对路径。请注意，如果您使用的是 setuptools，您可能应该改用它的[包资源 API](http://peak.telecommunity.com/DevCenter/PythonEggs#accessing-package-resources)。

**更新**：我在这里回复评论，以便粘贴代码示例。:-)

> 我认为`__file__`并不总是可用（例如，当您直接运行文件而不是导入文件时）是否正确？

`__main__`当您提到直接运行文件时，我假设您指的是脚本。如果是这样，我的系统上似乎不是这种情况（OS X 10.5.7 上的 python 2.5.1）：

```
#foo.py
import os
print os.getcwd()
print __file__

#in the interactive interpreter
>>> import foo
/Users/jason
foo.py

#and finally, at the shell:
~ % python foo.py
/Users/jason
foo.py 
```

但是，我确实知道`__file__`C 扩展存在一些怪癖。例如，我可以在我的 Mac 上执行此操作：

```
>>> import collections #note that collections is a C extension in Python 2.5
>>> collections.__file__
'/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/lib-
dynload/collections.so' 
```

但是，这会在我的 Windows 机器上引发异常。

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2012-03-19T10:24:27.563

您需要`os.path.realpath`（下面的示例将父目录添加到您的路径）

```
import sys,os
sys.path.append(os.path.realpath('..')) 
```

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2016-04-28T06:22:44.363

如接受的答案中所述

```
import os
dir = os.path.dirname(__file__)
filename = os.path.join(dir, '/relative/path/to/file/you/want') 
```

我只想补充一点

> 后一个字符串不能以反斜杠开头，事实上任何字符串都不应该包含反斜杠

它应该是这样的

```
import os
dir = os.path.dirname(__file__)
filename = os.path.join(dir, 'relative','path','to','file','you','want') 
```

在某些情况下，接受的答案可能会产生误导，请参阅[此](https://stackoverflow.com/questions/1945920/why-doesnt-os-path-join-work-in-this-case)链接了解详细信息

* * *

## 回答 #4

> 赞同：64
> 
> 时间：2018-07-03T07:40:46.683

现在是 2018 年，Python 已经进化到`__future__`很久以前了。那么如何使用[`pathlib`](https://docs.python.org/3/library/pathlib.html)Python 3.4 带来的惊人功能来完成任务，而不是为`os`, `os.path`, `glob`,`shutil`等而苦苦挣扎。

所以我们这里有 3 条路径（可能是重复的）：

*   `mod_path`: 这是*简单帮助脚本的路径*
*   `src_path`: 其中包含*几个*等待复制的模板文件。
*   `cwd`:*当前目录*，这些模板文件的目的地。

问题是：**我们没有**的完整路径`src_path`，只知道它的**相对路径**`mod_path`。

现在让我们用神奇的方法来解决这个问题[`pathlib`](https://docs.python.org/3/library/pathlib.html)：

```
# Hope you don't be imprisoned by legacy Python code :)
from pathlib import Path

# `cwd`: current directory is straightforward
cwd = Path.cwd()

# `mod_path`: According to the accepted answer and combine with future power
# if we are in the `helper_script.py`
mod_path = Path(__file__).parent
# OR if we are `import helper_script`
mod_path = Path(helper_script.__file__).parent

# `src_path`: with the future power, it's just so straightforward
relative_path_1 = 'same/parent/with/helper/script/'
relative_path_2 = '../../or/any/level/up/'
src_path_1 = (mod_path / relative_path_1).resolve()
src_path_2 = (mod_path / relative_path_2).resolve() 
```

未来，就这么简单。:D

* * *

此外，我们可以选择、检查和复制/移动这些模板文件[`pathlib`](https://docs.python.org/3/library/pathlib.html)：

```
if src_path != cwd:
    # When we have different types of files in the `src_path`
    for template_path in src_path.glob('*.ini'):
        fname = template_path.name
        target = cwd / fname
        if not target.exists():
            # This is the COPY action
            with target.open(mode='wb') as fd:
                fd.write(template_path.read_bytes())
            # If we want MOVE action, we could use:
            # template_path.replace(target) 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2015-10-06T15:17:35.927

考虑我的代码：

```
import os

def readFile(filename):
    filehandle = open(filename)
    print filehandle.read()
    filehandle.close()

fileDir = os.path.dirname(os.path.realpath('__file__'))
print fileDir

#For accessing the file in the same folder
filename = "same.txt"
readFile(filename)

#For accessing the file in a folder contained in the current folder
filename = os.path.join(fileDir, 'Folder1.1/same.txt')
readFile(filename)

#For accessing the file in the parent folder of the current folder
filename = os.path.join(fileDir, '../same.txt')
readFile(filename)

#For accessing the file inside a sibling folder.
filename = os.path.join(fileDir, '../Folder2/same.txt')
filename = os.path.abspath(os.path.realpath(filename))
print filename
readFile(filename) 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-05-27T21:47:16.280

请参见[sys.path](http://docs.python.org/library/sys.html#sys.path) 在程序启动时初始化，此列表的第一项路径 [0] 是包含用于调用 Python 解释器的脚本的目录。

[将此路径用作应用相对路径](http://docs.python.org/library/os.path.html#os.path.join)的根文件夹

```
>>> import sys
>>> import os.path
>>> sys.path[0]
'C:\\Python25\\Lib\\idlelib'
>>> os.path.relpath(sys.path[0], "path_to_libs") # if you have python 2.6
>>> os.path.join(sys.path[0], "path_to_libs")
'C:\\Python25\\Lib\\idlelib\\path_to_libs' 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-02-18T21:41:34.190

而不是使用

```
import os
dirname = os.path.dirname(__file__)
filename = os.path.join(dirname, 'relative/path/to/file/you/want') 
```

正如在接受的答案中一样，使用它会更健壮：

```
import inspect
import os
dirname = os.path.dirname(os.path.abspath(inspect.stack()[0][1]))
filename = os.path.join(dirname, 'relative/path/to/file/you/want') 
```

因为使用 __file__ 将返回加载模块的文件，如果它是从文件加载的，所以如果从其他地方调用带有脚本的文件，则返回的目录将不正确。

这些答案提供了更多详细信息：[https](https://stackoverflow.com/a/31867043/5542253) ://stackoverflow.com/a/31867043/5542253和[https://stackoverflow.com/a/50502/5542253](https://stackoverflow.com/a/50502/5542253)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-12-07T04:30:00.000

您好首先您应该了解函数**os.path.abspath(path)**和**os.path.relpath(path)**

简而言之**， os.path.abspath(path)**为**绝对路径**创建**相对**路径。如果提供的路径本身是绝对路径，则函数返回相同的路径。

 **同样**os.path.relpath(path)**为**相对路径**创建**绝对**路径。如果提供的路径本身是相对路径，则函数返回相同的路径。

 *****下面的例子可以让你正确理解上述概念***：

假设我有一个文件**input_file_list.txt**，其中包含要由我的 python 脚本处理的输入文件列表。

D:\conc\input1.dic

D:\conc\input2.dic

D:\Copyioconc\input_file_list.txt

如果您看到上面的文件夹结构，则**input_file_list.txt**存在于**Copyofconc**文件夹中，而要由 python 脚本处理的文件存在于**conc**文件夹中

但是文件**input_file_list.txt**的内容如下图：

..\conc\input1.dic

..\conc\input2.dic

我的 python 脚本存在于**D:**驱动器中。

并且**input_file_list.txt**文件中提供的相对路径是相对于 input_file_list.txt 文件的**路径**。

因此，当 python 脚本执行当前工作目录时（使用**os.getcwd()**获取路径）

由于我的相对路径是相对于**input_file_list.txt**的，即**"D:\Copyofconc"**，我必须将当前工作目录更改为**"D:\Copyofconc"**。

所以我必须使用**os.chdir('D:\Copyofconc')**，所以当前工作目录应该是**"D:\Copyofconc"**。

现在要获取文件**input1.dic**和**input2.dic**，我将阅读 "..\conc\input1.dic" 行，然后使用命令

**input1_path= os.path.abspath('..\conc\input1.dic')**（将相对路径更改为绝对路径。这里当前工作目录为“D:\Copyofconc”，文件为“.\conc\input1\. dic" 应相对于 "D:\Copyofconc" 访问)

所以**input1_path**应该是 "D:\conc\input1.dic"

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-03-24T20:03:52.453

此代码将返回主脚本的绝对路径。

```
import os
def whereAmI():
    return os.path.dirname(os.path.realpath(__import__("__main__").__file__)) 
```

这甚至可以在一个模块中工作。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-10-10T09:19:19.210

对我有用的替代方法：

```
this_dir = os.path.dirname(__file__) 
filename = os.path.realpath("{0}/relative/file.path".format(this_dir)) 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-09-10T15:09:24.330

# 最重要的命令摘要

```
>>> import os
>>> os.path.join('/home/user/tmp', 'subfolder')
'/home/user/tmp/subfolder'
>>> os.path.normpath('/home/user/tmp/../test/..')
'/home/user'
>>> os.path.relpath('/home/user/tmp', '/home/user')
'tmp'
>>> os.path.isabs('/home/user/tmp')
True
>>> os.path.isabs('/tmp')
True
>>> os.path.isabs('tmp')
False
>>> os.path.isabs('./../tmp')
False
>>> os.path.realpath('/home/user/tmp/../test/..') # follows symbolic links
'/home/user' 
```

详细说明可在[docs](https://docs.python.org/3/library/os.path.html)中找到。这些是 linux 路径。Windows 应该类似地工作。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2020-10-16T09:38:01.727

根据其他人的建议和[pathlib](https://docs.python.org/3/library/pathlib.html#basic-use)文档，一个简单而清晰的解决方案如下（假设我们需要参考的文件`Test/data/users.csv`：：

```
# This file location: Tests/src/long/module/subdir/some_script.py
from pathlib import Path

# back to Tests/
PROJECT_ROOT = Path(__file__).parents[4]
# then down to Test/data/users.csv
CSV_USERS_PATH = PROJECT_ROOT / 'data' / 'users.csv'  

with CSV_USERS_PATH.open() as users:
    print(users.read()) 
```

现在这对我来说有点奇怪，因为如果你四处`some_script.py`走动，我们项目根目录的路径可能会改变（我们需要修改`parents[4]`）。另一方面，基于相同的想法，我找到了我更喜欢的解决方案。

假设我们有以下目录结构：

```
Tests
├── data
│  └── users.csv
└── src
   ├── long
   │  └── module
   │     └── subdir
   │        └── some_script.py
   ├── main.py
   └── paths.py 
```

该`paths.py`文件将负责存储我们项目的根位置：

```
from pathlib import Path

PROJECT_ROOT = Path(__file__).parents[1] 
```

所有脚本现在都可以`paths.PROJECT_ROOT`用来表示项目根目录的绝对路径。例如，`src/long/module/subdir/some_script.py`我们可以有：

```
from paths import PROJECT_ROOT

CSV_USERS_PATH = PROJECT_ROOT / 'data' / 'users.csv'

def hello():
    with CSV_USERS_PATH.open() as f:
        print(f.read()) 
```

一切都按预期进行：

```
~/Tests/src/$ python main.py

/Users/cglacet/Tests/data/users.csv
hello, user

~/Tests/$ python src/main.py

/Users/cglacet/Tests/data/users.csv
hello, user 
```

`main.py`脚本很简单：

```
from long.module.subdir import some_script

some_script.hello() 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2021-10-28T16:38:11.317

### 例子

* * *

这是一个在 Python '3.9.5` 中测试的示例：

您的当前目录：`'c:\project1\code\'`
并且您想要访问以下文件夹：`'c:\project1\dataset\train\'`.
然后您可以使用以下地址访问该文件夹：`'../dataset/train/'`

### 参考

* * *

如果您想了解有关 的更多信息`path in Python`，请阅读以下内容：

*   [`PEP - 355`](https://www.python.org/dev/peps/pep-0355/)
*   [`PEP - 519`](https://www.python.org/dev/peps/pep-0519/)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-03-16T18:14:35.850

对我有用的是使用`sys.path.insert`. 然后我指定了我需要去的目录。例如，我只需要上一个目录。

```
import sys
sys.path.insert(0, '../') 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-10-15T00:08:18.487

我认为与所有系统一起使用“ntpath”而不是“os.path”。今天，它在 Windows、Linux 和 Mac OSX 上运行良好。

```
import ntpath
import os
dirname = ntpath.dirname(__file__)
filename = os.path.join(dirname, 'relative/path/to/file/you/want') 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-02-04T22:21:16.100

一个简单的解决方案是

```
import os
os.chdir(os.path.dirname(__file__)) 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-04-09T06:56:15.573

从`C:\Users\xyz\myFolder`到`C:\Users\xyz\testdata`:

```
import os
working_dir = os.path.abspath(os.path.dirname(os.path.dirname(__file__)))
# C:\Users\xyz\myFolder
print(working_dir)
updated_working_dir = os.path.join(os.path.realpath(working_dir + '/../'), 'testdata')
# C:\Users\xyz\testdata
print(updated_working_dir) 
```

> 输出

```
C:\Users\xyz\myFolder
C:\Users\xyz\testdata 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-11-11T01:57:09.210

这是我的总结：

首先，定义名为 的工具函数`relpath`，它将当前文件的相对路径转换为 ​​cwd 的相对路径

```
import os
relpath = lambda p: os.path.normpath(os.path.join(os.path.dirname(__file__), p)) 
```

然后我们用它来包装相对于当前文件的路径

```
path1 = relpath('../src/main.py') 
```

您还可以调用`sys.path.append()`相对于当前文件位置的导入文件

```
sys.path.append(relpath('..')) # so that you can import from upper dir 
```

完整示例代码：[https ://gist.github.com/luochen1990/9b1ffa30f5c4a721dab5991e040e3eb1](https://gist.github.com/luochen1990/9b1ffa30f5c4a721dab5991e040e3eb1)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-11-17T06:17:29.240

假设当前存档名为“Helper”，上层目录名为“Workshop”，模板文件在\Workshop\Templates，则Python中的相对路径为“..\Templates”。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2022-01-26T22:46:15.307

这是一种将**相对**路径添加到系统路径集的简单方法。例如，对于目标目录`'/../'`比工作目录高一级（因此，）的常见情况：

```
import os
import sys
workingDir = os.getcwd()
targetDir = os.path.join(os.path.relpath(workingDir + '/../'),'target_directory')
sys.path.insert(0,targetDir) 
```

此解决方案经过测试：

> Python 3.9.6 | conda-forge 打包| （默认，2021 年 7 月 11 日，03:37:25）[MSC v.1916 64 位 (AMD64)]

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2014-06-04T14:41:21.867

我不确定这是否适用于某些旧版本，但我相信 Python 3.3 具有原生相对路径支持。

例如，以下代码应在与 python 脚本相同的文件夹中创建一个文本文件：

```
open("text_file_name.txt", "w+t") 
```

（请注意，如果是相对路径，则开头不应有正斜杠或反斜杠）

# asp.net - 在 ASP.net 中“正确”实现 OpenID - 成员资格或身份验证提供程序？

> ID：918156
> 
> 赞同：13
> 
> 时间：2009-05-27T21:43:23.433
> 
> 标签：asp.net, authentication, asp.net-membership, openid

在 ASP.net 站点上使用 OpenID 有多种方法，但似乎没有一种方法使用现有的成员资格和身份验证提供程序机制。

我想知道创建一个完全依赖 OpenID 的网站的正确方法是什么？继续使用表单身份验证，但实现对 OpenID 进行查找的 SqlMembershipProvider 的变体？

还是我会更深入一层并编写自己的 FormsAuthenticationModule？这似乎有点太简单了，因为（据我所知）Forms Authentication 可以针对任何数据源进行查找。

还是有第三种方法，保留 FormsAuthenticationModule 但使其针对 OpenID 进行查找？

因为这是针对 ASP.net MVC 应用程序的，所以我没有使用内置的登录 WebForms 控件，如果这有所不同的话。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-28T19:43:10.837

ASP.NET 定义的 Membership API 与 OpenID 完全不匹配，这可能是您看不到很多系统使用它的原因。我还没有看到需要将 Membership 提供程序与 OpenID 一起使用，所以它还没有真正成为问题。[http://code.google.com/p/dotnet-membership-provider/](http://code.google.com/p/dotnet-membership-provider/)是一个试图使会员提供者模型适合 OpenID 的项目，但它看起来最近没有得到维护。

正如womp所说，您不需要重做FormsAuthenticationModule。它与 OpenID 完美配合。

查看[DotNetOpenAuth 附带的](http://www.dotnetopenauth.net/)[项目模板](http://www.ohloh.net/p/dotnetopenauth/download?package=DotNetOpenAuth+project+templates)，了解在没有会员提供程序的情况下如何工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T23:02:43.817

[OpenID Membership Provider](http://www.codeplex.com/OpenIDMembership/)项目可能是您正在寻找的 。

即使您没有使用登录控件，仍然建议利用 Membership Provider 模型进行身份验证。

通常不需要像实现 FormsAuthentication 特定功能那样深入，因为编写 MembershipProvider 非常简单，而且我从未发现它不够灵活以处理的情况。请注意，通常您只需要实现接口的一种方法 (ValidateUser()) 即可获得工作的提供者。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-23T16:44:35.390

这是一个老问题，但我没有看到我在搜索它时使用的方法，所以这里是。（它只在 Google 上进行了测试，因为我正在创建与我公司的 Google Apps for Business 帐户集成的外观，而不是完整的 OpenID 集成。）

我使用[DotNetOpenAuth](http://www.dotnetopenauth.net/)来声明 OpenID，确保需要电子邮件地址。

```
 request.AddExtension(new ClaimsRequest
        {
            BirthDate = DemandLevel.NoRequest,
            Email = DemandLevel.Require,
            FullName = DemandLevel.Require
        }); 
```

然后，当我收到经过验证的回复时，我会从电子邮件中查找用户名：

```
 case AuthenticationStatus.Authenticated:
                ClaimsResponse info = response.GetExtension<ClaimsResponse>();
                string username = Membership.GetUserNameByEmail(info.Email);
                FormsAuthentication.SetAuthCookie(username, true);
                return Redirect(ReturnUrl ?? "/"); 
```

假设您还设置了 Membership 和 Role 提供程序，为适当的用户名设置表单 Auth cookie 可以让您访问所有其他 Membership 和 Roles 优点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T21:52:28.077

[DotNetOpenId](http://code.google.com/p/dotnetopenid/)附带的 ASP.NET MVC 示例使用 FormsAuthentication 在用户通过 OpenID 身份验证后登录。据我所知，它没有与会员系统进行任何集成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-16T04:05:33.897

如果有人遇到一个好的 c# janrain 示例 - 请告诉我。

我有 dsn 指向 tumblr，然后对于登录小部件，它返回到一个子域，在该子域中我有它的路径到根目录下的文件夹。

所以我在那里有一个 app_code 文件夹，我正在使用这个 c# 助手类——我可以很好地取回令牌，它把我带到我的 members.domain.com，所以小部件正在工作——只需要获取用户详细信息在他们用来访问会员区的提供商上。

[http://groups.google.com/group/rpx-developers/web/c-helper-class?_done=/group/rpx-developers%3F](http://groups.google.com/group/rpx-developers/web/c-helper-class?_done=/group/rpx-developers%3F)

是助手类

错误

“/”应用程序中的服务器错误。意外的 API 错误 描述：在执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.Exception：意外的 API 错误

源错误：

第22行：第23行：Rpx feedit = new Rpx("apikey", " [https://learnbartending.rpxnow.com/](https://learnbartending.rpxnow.com/) "); 第 24 行：feedit.AuthInfo(justoken); 第 25 行：XmlElement xmlstuff = feedit.AuthInfo(justoken); 第 26 行：

源文件：c:\Inetpub\vhosts\learnbartending.com\httpdocs\members\Default.aspx.cs 行：24

堆栈跟踪：

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-24T01:25:10.157

如果您需要利用`userID(guid)`会员数据库中的密码，那么您将不得不在他们第一次登录时创建一个骨架帐户，然后找出一些在后续登录时轮换新密码的机制。这个密码显然是给您的会员提供者的，并且是透明的。

现在有趣的部分是找到常见的元数据？HMM电子邮件地址可能吗？

我也在使用 facebook connect 解决这个难题。我必须有一个用户 ID 才能将它们与我数据库中的分类帖子联系起来。

好玩的东西。

只是一个更新。我得到这个工作得很好。

我创建了一个表

```
CREATE TABLE [dbo].[OAuthUsers]
(
    [OuthUserID] [int] IDENTITY(1,1) NOT NULL,
    [UserID] [uniqueidentifier] NOT NULL,
    [access_token] [varchar](150) NULL,
    [expires_in] [datetime2](7) NULL,
    [refresh_token] [varchar](150) NULL,
    [issued_at] [datetime2](7) NULL,
    [user_id] [varchar](50) NOT NULL,
    [domain] [varchar](50) NULL,
    [scope] [varchar](150) NULL,
    CONSTRAINT [PK_OAuthUsers] PRIMARY KEY CLUSTERED
) 
```

为 facebook 或 openid存储`access_token`。OpenID 有一个你可以要求的刷新令牌，所以也要存储它

我有一个 ashx 处理程序作为我的 redirect_url。在该处理程序中，您可以为每种情况进行所有处理，用户已经在提供者数据库中拥有一个帐户，用户在提供者数据库中没有帐户，因此我们创建一个。所有这些整洁的废话:)

玩得开心。

# c# - Fluent NHibernate FluentMappings.AddFromAssemblyOf<> 问题

> ID：918157
> 
> 赞同：19
> 
> 时间：2009-05-27T21:43:51.760
> 
> 标签：c#, nhibernate, fluent-nhibernate, orm

我和一位同事最近正在使用 Fluent NHibernate 为一个小型应用程序做后端。我们编写了实体、映射文件、持久性管理器，但由于某种原因，我们无法将数据库模式导出到任何东西。

通过调试器，我们发现 FluentMappings.AddFromAssemblyOf 正在返回 0 个映射，即使它们明显存在并且明显正确。我们尝试了我们能想到的一切，最终不得不手动添加每个映射。

以下是不起作用的代码：

```
 return Fluently.Configure().Database(
            MsSqlConfiguration.MsSql2005
                .ConnectionString(c => c
                .TrustedConnection()
                .Server("localhost")
                .Database("LDTT")))
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<UserMap>())
            .ExposeConfiguration(BuildSchema)
            .BuildSessionFactory(); 
```

而这段代码确实有效：

```
 return Fluently.Configure().Database(
            MsSqlConfiguration.MsSql2005
                .ConnectionString(c => c
                .TrustedConnection()
                .Server("localhost")
                .Database("LDTT")))
                .Mappings(m => m.FluentMappings.Add<ClientMap>())
                .Mappings(m => m.FluentMappings.Add<ContactMap>())
                .Mappings(m => m.FluentMappings.Add<DepartmentMap>())
                .Mappings(m => m.FluentMappings.Add<DivisionMap>())
                .Mappings(m => m.FluentMappings.Add<FileMap>())
                .Mappings(m => m.FluentMappings.Add<FileTypeMap>())
                .Mappings(m => m.FluentMappings.Add<RegionMap>())
                .Mappings(m => m.FluentMappings.Add<TimeEntryMap>())
                .Mappings(m => m.FluentMappings.Add<UserMap>())
            .ExposeConfiguration(BuildSchema)
            .BuildSessionFactory(); 
```

有谁知道为什么会发生这种情况，以及如何解决？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-27T21:51:31.170

使 UserMap 成为**公共**类型。

# notepad++ - 如何删除 Notepad++ 中的特定行？

> ID：918158
> 
> 赞同：101
> 
> 时间：2009-05-27T21:43:53.323
> 
> 标签：notepad++

我正在清理一些代码文件 (C#) 并希望删除这些区域。我想删除所有具有字符串'#region'的行。这只是一个例子，我可以想到更多的用途，但这可能吗？

* * *

## 回答 #1

> 赞同：289
> 
> 时间：2009-05-27T22:00:30.573

**记事本++ v6.5**

1.  **Search** menu -> **Find...** -> **Mark** tab -> Find what: *your search text*，检查**Bookmark Line**，然后**Mark All**。这将使用搜索词为所有行添加书签，您会在边缘看到蓝色圆圈。

2.  然后**Search** menu -> **Bookmark** -> **Remove Bookmarked Lines**。这将删除所有带书签的行。

您还可以使用正则表达式进行搜索。这种方法不会产生像 John 那样的空行，实际上会删除该行。

**旧版本**

1.  **Search** menu -> **Find...** -> Find what: *your search text*，检查**Bookmark Line**并单击**Find All**。
2.  然后**搜索->书签->删除书签行**

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-05-27T21:47:42.237

您可以使用菜单*搜索*->*替换...* ( `Ctrl`+ H)。

它具有用于替换的正则表达式功能。您可以使用匹配#region 的正则表达式以及该行中的任何其他内容，并将其替换为空白。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-07-22T11:17:10.547

这是我用来更新代码的 Notepad++ 最常见的功能。

您需要做的就是：

*   选择所有行中都存在的公共字符串。
*   按`Ctrl`+`F`
*   在*标记*选项卡中，粘贴重复出现的字符串并选中*书签行*复选框。
*   点击`Mark All`
*   现在转到菜单*搜索*→*书签*→*删除书签行*

您可以参考此链接进行图片说明。

[http://www.downloadorinstall.com/best-notepad-tips-and-tricks-for-faster-work-and-development/](http://www.downloadorinstall.com/best-notepad-tips-and-tricks-for-faster-work-and-development/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-02-10T11:05:33.587

这是一种完全删除包含“YOURTEXT”的行的方法：

*   打开替换对话框
*   输入以下搜索字符串：（`.*YOURTEXT.*[\r]?[\n]`将 YOURTEXT 替换为您的文本）
*   启用“正则表达式”
*   禁用“。匹配换行符”

给定的正则表达式匹配 Windows 和 Unix 的行尾。

如果您的文本包含对正则表达式具有特殊含义的字符，例如反斜杠，您将需要对它们进行转义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-08-24T01:12:19.673

Jacob 对 John T 的回复完美地删除了整行，您可以使用它在文件中查找。确保检查底部的“正则表达式”。

解决方案：`^.*#region.*$`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-22T19:28:52.860

调查什么是您的 EOL，\n 或 \r\n。然后`.*#region.*\r\n`在正则表达式模式下替换为空。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T21:47:08.540

您可以尝试用\n 替换#region，打开扩展搜索模式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-18T15:39:32.620

使用 regex 和 find&replace，您可以删除所有包含 #region 的行，而不会留下空行。因为由于某种原因，Ray 的方法在我的机器上不起作用，所以我搜索`(.*#region.*\n)|(\n.*#region.*)`并将替换框留空。

该正则表达式确保`#region`在第一行找到 if ，则删除结束换行符，如果在最后一行找到它，则删除前面的换行符。

不过，如果 Ray 的解决方案适合您，它会是更好的解决方案。

# asp.net - jQuery 和 ASP.Net

> ID：918167
> 
> 赞同：1
> 
> 时间：2009-05-27T21:46:00.667
> 
> 标签：asp.net, jquery, json

好吧，我试图返回比字符串或布尔值更复杂的类型，但我失败了我做错了什么？JavaScript

```
<script language="javascript" type="text/javascript">
    ///<Reference Path="~/Script/jquery-1.3.2-vsdoc.js" />
    $(document).ready(function() {
        // Add the page method call as an onclick handler for the div.
        $("#Result").click(function() {
            $.ajax({
                type: "POST",
                url: "Test.aspx/GetDate",
                data: "{}",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function(msg) {
                    // Replace the div's content with the page method's return.
                    $("#Result").text(msg.Name);
                },
                failure: function() { alert("Failed") }
            });
        });
    });
</script> 
```

C#（这不是一个网络服务，只是一个普通的网页）

```
[WebMethod]
public static ImageDC GetDate()
{
    ImageDC dc = new ImageDC();
    dc.Id = 1;
    dc.Name = "Failwhale";
    dc.Description = "Hurry the failwale is going to eat us!";
    dc.IsPublic = true;
    return dc;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T21:53:56.873

我不确定您正在运行什么版本的 .NET，但是从 Web 服务返回的对象发生了重大变化。看看这篇文章。

[http://encosia.com/2009/02/10/a-break-change-between-versions-of-aspnet-ajax/](http://encosia.com/2009/02/10/a-breaking-change-between-versions-of-aspnet-ajax/)

如果您使用 fiddler 查看请求/响应，应该很容易判断这是否是问题所在。

[http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-27T21:52:57.640

您应该返回一个字符串。

```
return "dc = {Id:"+dc.Id+", Name:" + dc.Name +", Description: " +dc.Description  + ", IsPublic: " +dc.IsPublic "}"; 
```

# windows - 可以以编程方式将自动播放和 WIA 重置为默认的“问我吗？”？

> ID：918170
> 
> 赞同：1
> 
> 时间：2009-05-27T21:46:46.997
> 
> 标签：windows, winapi, wia, autoplay

我有代码广告自动播放和 WIA 处理程序分别从存储卡和数码相机读取图像文件，它工作正常。

但是，我想在我的应用程序第一次运行时将自动播放和 WIA 处理程序重置为“每次询问我要做什么”的默认值。为什么？因为如果用户将处理程序设置为其他内容，那么当他/她尝试使用我的应用程序时，他们的机器仍会执行其他操作，然后他/她会向我抱怨我的应用程序实际上无法运行机器只是尊重他们以前的设置。

那么有没有办法以编程方式重置自动播放和 WIA 处理程序？我假设有一些 API 调用（最好是 Win32 而*不是*.Net）或可以修改的注册表设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-15T14:40:22.870

看起来每个用户的自动播放首选项（对应于 Windows Vista 和 7 中的自动播放控制面板）保存在 HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\UserChosenExecuteHandlers 下。每个类别的自动播放设备或媒体类型都有一个子键；将子项的默认值更改为 MSPromptEachTime 应该会恢复“每次询问我要做什么”行为。（虽然自动播放控制面板是 Vista 和 7 的新功能，但 XP 中存在相同的注册表项，对于基于音量的自动播放，我认为它们的工作方式相同。）

[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc301341.aspx)详细介绍了自动播放的工作原理。

# python - 检测到 Swig / Python 内存泄漏

> ID：918180
> 
> 赞同：16
> 
> 时间：2009-05-27T21:48:03.733
> 
> 标签：python, memory-leaks, swig

我有一个非常复杂的类，我正在尝试在 SWIG 中制作 Python 包装器。但是，当我在 Python 中创建项目的实例时，我无法在没有收到消息的情况下初始化某些数据成员：

```
>>> myVar = myModule.myDataType()
swig/python detected a memory leak of type 'MyDataType *', no destructor found. 
```

有谁知道我需要做些什么来解决这个问题？有没有我可以用来生成析构函数的标志？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-28T13:59:41.777

SWIG 始终生成析构函数包装器（除非`%nodefaultdtor`使用指令）。但是，如果它对类型一无所知，它将生成一个不透明的指针包装器，这将导致泄漏（以及上述消息）。

请检查这`myDataType`是 SWIG 已知的类型。在打开调试消息的情况下重新运行 SWIG 并检查任何类似于

```
Nothing is known about Foo base type - Bar. Ignored 
```

接收到上述消息意味着 SWIG 不完全了解您的类型层次结构，因此对有限的信息进行操作——这可能导致它不生成 dtor。

* * *

## 回答 #2

> 赞同：-13
> 
> 时间：2009-05-28T01:37:46.720

错误消息对我来说很清楚，您需要为此类型定义一个析构函数。

# .net - WPF 的三大顶级博客是什么？

> ID：918184
> 
> 赞同：2
> 
> 时间：2009-05-27T21:49:15.557
> 
> 标签：.net, wpf, mvvm

我有几个书签，但一天只有这么多时间阅读/学习博客。如果我要每天阅读三个博客以深入了解 WPF，我应该阅读什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T22:01:24.130

乔什·史密斯的博客：http: [//joshsmithonwpf.wordpress.com/](http://joshsmithonwpf.wordpress.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T22:02:31.520

不知道每天阅读，但这些帮助很大：

*   [http://blogs.msdn.com/mikehillberg/default.aspx](http://blogs.msdn.com/mikehillberg/default.aspx)
*   [http://joshsmithonwpf.wordpress.com/](http://joshsmithonwpf.wordpress.com/)
*   [http://karlshifflett.wordpress.com/](http://karlshifflett.wordpress.com/)
*   [http://www.drwpf.com/blog/](http://www.drwpf.com/blog/)

好的——那就是 4。Bea Stollnitz 似乎不再更新太多，但它很好。Jaime Rodriguez 完善了我的名单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T22:10:08.447

Marlon Grech 的博客： http: [//marlongrech.wordpress.com/](http://marlongrech.wordpress.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T21:55:40.723

[http://blogs.msdn.com/jgoldb/default.aspx](http://blogs.msdn.com/jgoldb/default.aspx)

[http://karlshifflett.wordpress.com/](http://karlshifflett.wordpress.com/)

没有特别的顺序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T07:24:26.723

触摸选择，3 太少了 :) 我使用 jaime rodriguez 整理的博客列表。 [http://blogs.msdn.com/jaimer/pages/wpf-bloggers.aspx](http://blogs.msdn.com/jaimer/pages/wpf-bloggers.aspx)

像以前的海报一样，我同意 Josh smiths 的帖子对编码部分 WPF 有好处，但我也喜欢 Blend 团队博客的表达（kirupa 和 pete blois 个人博客也很棒）和 Robby Ingbretsens 博客（从那以后就有点不活跃了混合）。

哎呀。超过3个:)

# sharepoint - SharePoint 数据表视图只读自定义字段

> ID：918190
> 
> 赞同：2
> 
> 时间：2009-05-27T21:51:10.937
> 
> 标签：sharepoint

有什么方法可以将验证（即 SSN）添加到 SharePoint 字段并在数据表视图中仍然可以编辑？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T03:03:10.573

可能不会……您必须创建自己的数据表 ActiveX 控件。它存在于客户端，而不是服务器。

您可以将 SSN 设为标准列类型，并在列表中的 EventHandler 中验证其格式。如果不遵循确切的模板，这将使数据表视图中的行出错。我承认这不是最好的用户体验，但至少用户可以解决问题并继续，您的数据将是健全的。

# exchange-server - 查看所有交换 MAPI 文件夹的工具是什么？

> ID：918194
> 
> 赞同：1
> 
> 时间：2009-05-27T21:51:37.613
> 
> 标签：exchange-server, mapi

我正在做一些交换网络服务开发。

作为应用程序的一部分，我正在用户的交换邮箱中创建一个隐藏文件夹。我记得在某处读到有一个工具可以让您浏览*所有*交换文件夹……有点像 Outlook，但更侧重于开发。

我似乎无法用谷歌搜索答案。谁能指出我？

谢谢，彼得

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T21:55:12.800

有趣的是，问一个问题如何让你在谷歌上找到正确的答案：

这是工具 - [MFC Mapi](http://mfcmapi.codeplex.com/)

# hibernate - 带有会话范围 bean 的 LazyInitializationException

> ID：918196
> 
> 赞同：3
> 
> 时间：2009-05-27T21:51:52.680
> 
> 标签：hibernate, spring, jpa, struts

我在我的服务层中使用会话范围的 bean 获取 LazyInitializationException。如果我在我的方法中使用常规 dao 加载相同的 bean，我可以毫无问题地访问它的惰性集合。但是如果我将它注入到我的服务 bean 中，然后尝试访问它的惰性集合之一，我就会有一个 LazyInitializationException。

我正在使用 JPA + Hibernate + Spring + struts。我已经配置了 OpenEntityManagerInViewFilter。此外，我可以在日志中清楚地看到事务和会话已打开。

在为带有惰性集合的会话范围 bean 的配置中，我需要做些什么特别的事情吗？

以下是日志：

```
 org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter:lookupEntityManagerFactory:146 - Using EntityManagerFactory 'entityManagerFactory' for OpenEntityManagerInViewFilter
    org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter:doFilterInternal:101 - Opening JPA EntityManager in OpenEntityManagerInViewFilter
    org.springframework.orm.jpa.JpaTransactionManager:doGetTransaction:285 - Found thread-bound EntityManager [org.hibernate.ejb.EntityManagerImpl@17ab5c0] for JPA transaction
    org.springframework.transaction.support.AbstractPlatformTransactionManager:getTransaction:371 - Creating new transaction with name [com.xx.action.spring.service.SearchService.loadCurrencyCode]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly
    org.hibernate.impl.SessionImpl:<init>:247 - opened session at timestamp: 5093202578464768
    org.hibernate.transaction.JDBCTransaction:begin:82 - begin
    org.hibernate.jdbc.ConnectionManager:openConnection:444 - opening JDBC connection
    org.hibernate.transaction.JDBCTransaction:begin:87 - current autocommit status: true
    org.hibernate.transaction.JDBCTransaction:begin:90 - disabling autocommit
    org.springframework.orm.jpa.JpaTransactionManager:doBegin:348 - Exposing JPA transaction as JDBC transaction [SimpleConnectionHandle: com.mchange.v2.c3p0.impl.NewProxyConnection@9b537f]
    org.hibernate.LazyInitializationException:<init>:42 - could not initialize proxy - no Session
    org.hibernate.LazyInitializationException: could not initialize proxy - no Session
        at org.hibernate.proxy.AbstractLazyInitializer.initialize(AbstractLazyInitializer.java:86)
        at org.hibernate.proxy.AbstractLazyInitializer.getImplementation(AbstractLazyInitializer.java:140)
        at org.hibernate.proxy.pojo.javassist.JavassistLazyInitializer.invoke(JavassistLazyInitializer.java:190)
        at com.xxx.api.jpa.bean.CurrencyBean_$$_javassist_29.getHtmlSymbol(CurrencyBean_$$_javassist_29.java) 
```

这是bean的配置：

```
<bean id="currentUserBean" class="com.xxx.action.spring.CurrentUserBean" scope="session">
        <aop:scoped-proxy />    
</bean> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:55:22.393

看看这个线程：

[春季论坛讨论](http://forum.springsource.org/showthread.php?t=39370)

那么试试这个 - 真的是一样的答案

[更好的春天论坛讨论](http://forum.springsource.org/showthread.php?t=27993)

似乎最简单的解决方案是在您的休眠映射文件中设置lazy="false"，但是那里有一个完整的答案可以让您使用LazyInitialization

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-12T13:15:09.890

`@PersistenceContext(type=PersistenceContextType.EXTENDED)`作品:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T05:44:19.793

我认为你应该有要求的范围。原因是您的事务将仅对请求而不是会话有效。这就是为什么您会看到惰性初始化异常。

您还怀疑事务是否处于活动状态：我认为对此的解释是 UserBean 是在其他事务中创建的，并且当您在某些不同的事务中访问时，它说会话已关闭。由于会话将在首次交易完成时关闭。

# apache - mod_rewrite - 将 css/images/js 文件指向特定目录

> ID：918199
> 
> 赞同：2
> 
> 时间：2009-05-27T21:52:17.657
> 
> 标签：apache, mod-rewrite

在我的托管服务器上，文件位于此处：

/usr/home/user1/public_html

我必须使用以下方式访问文件：[http ://server1.example.com/user1/](http://server1.example.com/user1/)

但是，我所有的文件都使用绝对路径来引用 CSS/图像/JS 文件。

因此，我对这些资产的请求如下所示：

[http://server1.example.com/images/homepage/ver2/logo-black.png](http://server1.example.com/images/homepage/ver2/logo-black.png)

然而，他们没有被发现，因为他们住在这里：

[http://server1.example.com/user1/](http://server1.example.com/user1/)

我如何告诉 Apache 使用此路径来查找文件。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T06:38:17.690

您可以简单地去掉`user1`URL：

```
RewriteCond %{THE_REQUEST} ^[A-Z]+\ /user1/
RewriteRule ^/user1/(.*) /$1 [L,R=301]

RewriteRule !^/user1/ /user1%{REQUEST_URI} [L] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T22:02:09.620

如果您的资产目录将被称为`images`,`css`和`javascript`，您可以在 Apache 配置中使用以下内容：

```
RewriteEngine On
RewriteRule ^/(images|css|javascript)(/.*)$ /user1/$1$2 
```

# validation - 从本地机器的 IIS 5.1 部署到 Web 服务器的 IIS 6.0 的验证问题

> ID：918202
> 
> 赞同：0
> 
> 时间：2009-05-27T21:52:27.983
> 
> 标签：validation

我正在开发一个 VB.NET 1.1 Web 应用程序。*在使用 IIS 5.1 在我的本地*计算机上进行测试时，所有验证和 RegEx 控件都可以正常工作，但是当我使用 IIS 6.0 部署到我们的“租用”Web 服务器时，我要么得到“System.FormatException：字符串未被识别为有效的 DateTime” " 日期字段上的错误（在本地机器上工作），或其他非日期验证和 RegEx 控件直到提交表单后才会被识别，此时数据已经以某种方式发布到数据库。

我不知道一旦部署到测试/生产环境中我会使用不同版本的 IIS，并且不存在更高级别的帮助或知识较少。

同时，我添加了简化且编写时间更长的条件逻辑来绕过此验证问题，因为我在谷歌上搜索*正确的*解决方案时运气不佳，也没有在这里找到它。请告知我在验证方面可能遗漏了什么知识，或者 IIS 5.1 和 6.0 之间的功能差异可能是我可能会进一步研究的地方。

如果这对问题的描述过于宽泛，我深表歉意，我的思想现在已经失控了。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T15:58:47.180

我不记得这方面的确切细节，我可能不得不深入挖掘才能找到它。但根本原因是由于本地计算机与实际生产 Web 服务器之间的 .NET 1.1 框架上的内部版本号略有不同。

几年前我遇到过这个问题，我们同步了 .NET 补丁，然后我们让它工作了

# database - 物理硬件的数据库设计

> ID：918207
> 
> 赞同：3
> 
> 时间：2009-05-27T21:52:58.840
> 
> 标签：database, hardware, sqlite, physics

我必须为独特的环境开发一个数据库。我没有数据库设计经验，可以利用每个人的智慧。

我的小组正在为一块物理硬件和一个数据采集系统设计一个数据库。我们需要一个系统来存储所有硬件配置参数，并在用户更改这些参数时跟踪它们的变化。

设置：

*   我们有近 200 个检测器和大约 40 个与每个检测器相关的参数。在这 40 个参数中，我们预计只有少数会在实验过程中发生变化。大多数与单个检测器相关的参数都是静态的。
*   我们在定时运行中收集此实验的数据。在这些运行期间，加载到硬件中的参数不得更改，尽管我们应该能够随时编辑数据库以准备下一次运行。目前的计划：

    *   数据库将提供当前参数与上次运行期间使用的参数之间的差异。
    *   在新的运行开始时，最新的数据库更改被加载到硬件中。
    *   用于即将运行的设置必须标有运行编号和当前日期和时间。这是必不可少的。我需要实验设置的运行历史。
*   将有几个不同的客户端读取和写入数据库。尽管对数据库的更改并不频繁，但我不能保证这些更改不会同时发生。

*   必须是健壮且不可损坏的。实验系统的配置取决于硬件。数据库的任何故障都会阻止数据采集，而且我们的时间很昂贵。数据库备份？

我目前的计划是使用 sqlite 数据库来实现上述要求，尽管我不确定它是否可以支持我的所有要求。还有其他我应该研究的技术吗？有没有人做过类似的事情？我愿意学习任何技术，只要它成熟。

欢迎提示和建议。

谢谢，

肖恩

* * *

**更新 1**：

*数据库访问*：

三个轻量级应用程序可以写入和读取数据库，一个应用程序只能读取。

具有写访问权限的应用程序负责设置硬件参数的非重叠子集。具体来说，我们有一个应用程序（其中可能有多个副本）设置高电压，一个应用程序设置其余硬件参数，这些参数可能在实验期间发生变化，一个 GUI 设置其余参数它们几乎是静态的，仅对正确重建数据至关重要。

只读访问的程序是我们的数据分析软件。它需要访问数据库中几乎所有的参数，才能将传入的数据正确格式化为我们可以正确分析的内容。与数据库的连接数应大于 10。

*备份*：

我们实验室的另一个设置每次运行都会转储一个 xml 文件。尽管我认为 xml 不合适，但我计划每次运行都备份系统，以防万一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T22:09:46.467

关于设计的一些基本知识；您应该确保不要从任何表中删除数据；跟踪最新数据（可能最好使用最新更新的日期时间）；但是，当数据值发生变化时，不要删除旧数据。启动运行时，使用运行 ID 标记每个使用的表（在另一列中）；这样，您就可以维护每个设置的完整历史记录，并且可以准确地确定给定运行中使用的状态是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T22:32:43.083

向周围的同事询问。

你没有说你在做什么样的物理学，或者工作组有多大，但在我的学科（粒子物理学）中，只有建立和运行这种类型的系统（我们称之为“慢速控制”等）。与您一起工作的人很有可能已经这样做了，或者认识这样做的人。在某人的论文中可能有关于最后一次退出的详细描述。

我个人对此并没有太大的关系，但我确实知道这一点：一个共同的特征是具有不删除不覆盖设计。您只能*添加*数据，不能删除它。这可以保留您在遇到麻烦时弄清楚到底*发生了什么的机会*

* * *

Perhaps I should explain a little more. While this is an important task and has to be done right, it is not really related to physics, so you can't look it up on [Spires](http://www.slac.stanford.edu/spires/hep/) or on [arXive.org](http://arxiv.org/). No one writes papers on the design and implementation of medium sized slow controls databases. But they do sometimes put it in their dissertations. The easiest way to find a pointer really is to ask a bunch of people around the lab.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T22:08:47.030

从事物的声音来看，这并不是一个特别大的数据库。因此，您可能能够摆脱使用[Oracle 的免费数据库](http://www.oracle.com/technology/products/database/xe/index.html)，这将为您提供各种极大的灵活性，包括日记（不确定这是否是一个实际的词）和管理。

在您说“将有几个不同的客户端同时读取和写入数据库”之后，您就提到了“不可损坏”，这对我来说是一个危险信号。您是否打算创建某种具有此接口的应用程序？还是您打算通过 TOAD 之类的工具直接访问数据库？

为了保持您的数据完整性，您需要对您的权限非常严格。我只允许一个（和一个备份）人拥有管理员权限，能够在 GUI 之外进行数据操作（这将使您的生活更轻松）。

备份？是的，一点没错！您不仅应该进行每日、每周和每月备份，还应该进行完整备份和增量备份。此外，经常测试您的备份图像以确认它们确实有效。

至于数据结构，我需要更多关于您尝试存储的内容以及如何访问它的详细信息。但是根据您在这里的说明，我会说您需要以下表格（首先）：

```
Detectors
Parameters
Detector_Parameters 
```

一些附加说明：

由于您将进行如此多的更改，因此我建议使用[SVN](http://subversion.tigris.org/)之类的版本控制来跟踪您的所有 DDL 等。我还建议使用诸如[bugzilla](http://www.bugzilla.org/)之类的东西进行错误跟踪（如果需要）并使用[google docs](http://docs.google.com)进行团队文档管理。

希望有帮助。

# javascript - Vista gadget/javascript 传递变量问题

> ID：918210
> 
> 赞同：0
> 
> 时间：2009-05-27T21:53:21.883
> 
> 标签：javascript, windows-desktop-gadgets

我一直在为此苦苦挣扎，找不到一个关于似乎非常简单的想法的教程。

我已经使用以下命令写入了 settings.html 文件中的设置：

```
System.Gadget.Settings.writeString("Date1", month + "-" + day + "-" + year); 
```

这似乎奏效了。它在设置中正确显示。

现在，在主文件 gadget.html 中，我想提取数据并显示它（而不是在输入标签中）。执行此操作的完整代码是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T22:24:56.563

将其写入 xml 文件并使用 ajax 读取它。或者，将其写入 .js 文件并使用`<script src=...></script>`构造导入。

# .net - .Net 使用反射来定义 OfType

> ID：918217
> 
> 赞同：2
> 
> 时间：2009-05-27T21:55:16.917
> 
> 标签：.net, vb.net, reflection, types, oftype

我正在使用 System.Reflection 加载在设计时无法加载的类型。我需要在这种类型的集合中提取所有控件，但是，我 OfType 命令似乎不喜欢反射语法。这是我得到的“接近”。

```
Dim ControlType As Type = System.Reflection.Assembly.GetAssembly( _
                          GetType(MyAssembly.MyControl)) _
                         .GetType("MyAssembly.MyUnexposedControl")

Dim Matches as List(Of Control) = MyBaseControl.Controls.OfType(Of ControlType) 
```

所以那个代码是假的，它不起作用，但你明白我想要做什么。那么有没有办法使用反射并获取该类型的所有控件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T22:07:15.630

[OfType](http://msdn.microsoft.com/en-us/library/bb360913.aspx)是一个泛型方法，因此您可以给它一个静态类型（例如`OfType(Of String)`），而不是在运行时确定的 System.Type。

您可以执行以下操作：

```
Dim CustomControlType as Type = LoadCustomType()

MyBaseControl.Controls.Cast(Of Control)().Where(Function(ctrl) ctrl.GetType().IsAssignableFrom(CustomControlType)) 
```

`Cast(Of Control)`用于将( `ControlCollection`)`IEnumerable`转换为`IEnumerable<Control>`，然后获取所有 lambda 扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T22:08:26.767

试试这样：

```
Dim ControlType As Type = System.Reflection.Assembly.GetAssembly( _
                      GetType(MyAssembly.MyControl)) _
                     .GetType("MyAssembly.MyUnexposedControl")

Dim Matches as List(Of Control) = MyBaseControl.Controls.Where(Function(control) ControlType.GetType().IsAssignableFrom(control.GetType()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T22:08:46.983

为什么不将 OfType 替换为您在其中测试类型的 Where ？

```
Dim Matches as List(Of Control) = MyBaseControl.Controls.Where(Function(ctl) ctl.GetType() = ControlType) 
```

编辑：darin 更快......实际上他的解决方案更好，因为它处理派生类

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T22:09:26.267

你有没有尝试过这样的事情？

```
Dim query = From i In MyBaseControl.Controls Where i.GetType is ControlType 
```

# php - php 作为 apache 输入过滤器

> ID：918220
> 
> 赞同：1
> 
> 时间：2009-05-27T21:55:59.817
> 
> 标签：php, apache

php5apache_filter 可以用作[输入过滤器](http://httpd.apache.org/docs/2.2/mod/core.html#setinputfilter)吗？
还没有找到很多关于 php 的过滤器 sapi 的文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T22:30:41.293

filter 模块确实注册了一个输入过滤器*static int php_input_filter()...*。但除了获取所有可用的帖子数据之外，它并没有做太多事情。所以我*想*答案是：不，你不能按照你想要的方式将它用作输入过滤器。

# javascript - Looking for a web based, client side form editor

> ID：918226
> 
> 赞同：0
> 
> 时间：2009-05-27T22:00:40.073
> 
> 标签：javascript, jquery, jquery-plugins, webforms, client-side

I'm looking for a javascript library (could be based on jQuery) that will implement a client side Form Editor.

The perfect example is something like offered by [http://wufoo.com/](http://wufoo.com/)
You should play with their free version to get the feeling of what I'm trying to find.

Also see [this example](http://mikenovember.com/wp-content/uploads/2007/04/form-builder.html) someone made with jQuery. it is very basic, but a step in the right direction.

Do you know of any jQuery plugin or library that will give me the full functionality of form editing?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T06:46:32.963

I would recommend the awesome ExtJS framework to build such kind of application. Here's an example of what you can do.

[ext/formbuilder](http://tof2k.com/ext/formbuilder/)

Add a form panel, then drop a textbox and so on...dead simple. Ext JS 2.2 and 3.0 (not yet ready) are LGPL and GPL licensed, you have also commercial subscriptions available, I think it worth to have a look at it.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T22:38:01.980

Try the [jQuery Form Builder](http://experiments.botsko.net/tests/formbuilder/) plug-in from [Botsko](http://www.botsko.net/blog/2009/04/jquery-form-builder-plugin/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-02T10:16:48.963

I had the same problem and wrote one. Github link: [SpiffForm](https://github.com/knipknap/SpiffForm).

# cakephp - cakephp - 如何将控制器中的数据转发到另一个控制器？

> ID：918227
> 
> 赞同：1
> 
> 时间：2009-05-27T22:00:44.643
> 
> 标签：cakephp

我有一个注册表单发布到我的customers_controller，但现在他们希望注册表单也包含付款信息。我有一个 payment_controller，保存新用户后，我想将付款后数据转发到 payment_controller 中的操作。

我怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T23:29:15.527

我建议您将付款的实际逻辑放入付款或发票模型中。这样做，您可以链接两个模型（允许您进行 $this->Customer->Payment->process_charge(..) 调用），或者您可以在 Customers 控制器中定义 $uses 属性以允许调用支付模式。

我也是“胖模型，瘦控制器”思想流派的支持者，部分原因是这种情况。我尝试将控制器视为负责实际的 http 请求（访问控制、工作流属性等）并让模型完成大部分繁重的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T07:41:16.067

我建议在用户控制器的注册操作中，当用户注册（并登录）时，您重定向到使用正常支付模式的支付控制器并在那里查看自我发布。通过重定向从一个动作结束到另一个动作的通信方式是构建 url。但是，您不需要传递用户信息，因为 Payments 控制器应该能够在需要时获取用户的 id，即：

```
$this->data['Payment']['user_id'] = $this->Auth->user('id'); 
$this->Payment->create($this->data);
if ($this->Payment->save()) {
 // etc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-17T13:48:15.977

假设客户和付款以某种方式相关，您没有理由不能在您的 cusomters_controller 中记录付款信息。

```
$this->Customer->Payment->create()... 
```

没有规定必须为每个模型使用一个控制器。事实上，这在你现在所经历的绝大多数现实世界的应用程序中都行不通。

我通常通过逻辑功能分组来隔离我的控制器，而不是尝试将它们与模型配对。在您的情况下，我将构建一个 accounts_controller（即使我没有帐户表）并将登录、注册、注销、配置文件编辑等放在该控制器中。

我发现这种组织方式使应用程序更易于维护，并且也为最终用户提供了更多逻辑路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-16T16:25:55.583

最终，我认为尝试将数据移动到另一个控制器是愚蠢的。我创建了一个支付组件来处理来自任何控制器的请求。

# c++ - 有趣的范围问题，解释？

> ID：918236
> 
> 赞同：1
> 
> 时间：2009-05-27T22:04:20.333
> 
> 标签：c++, c, objective-c

我刚刚发现了一个错误，代码看起来像这样：

```
char *foo = malloc(SOME_NUM * sizeof(char));
if (!processReturnsTrueOrFalse(foo)) {
    free(foo);
    char *foo = malloc(SOME_NUM * sizeof(char));
    // More stuff, whatever
} 
```

这可以编译，但奇怪的是我被允许在同一个函数中定义两个变量，但编译器似乎对它们的范围不同。

如果是这种情况，我如何区分内部 foo 和外部 foo ？编译器怎么知道在我第二次声明之前的 free 中，我试图释放外部 foo，但是当我重新声明内部 foo 时，它没有给我一个错误？

感谢您提供任何信息。这可能是一个非常明显的新手问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T22:16:18.543

每次使用`{` `}`. 看看这个例子在这里。

```
const char *foo = "global";

int main(int argc, char* argv[])
{
    const char *foo = "hello";

    {
        cout << foo << endl;
        const char *foo = "world";
        cout << foo << endl;
        cout << ::foo << endl;
    }
    cout << foo << endl;
} 
```

当你运行它时，你会得到：

```
你好
 世界
 全球的
 你好

```

当您打开一个新作用域并声明一个与封闭作用域中的变量同名的变量时，只要您保持在当前作用域中，您就会在外部作用域中隐藏该变量。离开内部范围后，外部变量将再次可见。如果外部变量恰好是全局变量，则可以使用全局命名空间进行访问`::foo`。如果外部变量是类变量，则可以使用`className::foo`. 如果外部变量只是一个局部变量，则在您离开声明隐藏它的变量的范围之前，无法访问它。

我有一段时间没有使用 C，所以 C99 可能会有所不同，但在较旧的 C 中，无法访问隐藏名称。

```
const char *foo = "global";

int main(int argc, char* argv[])
{
    const char *foo = "hello";

    {
        char *foo = "world";
        printf("%s\n", foo);
    }
    printf("%s\n", foo);
    return 0;
} 
```

当你运行它时，你会得到：

```
世界
 你好

```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T06:36:42.563

正如其他海报所写，当在内部范围内声明具有相同名称的变量时，您会[隐藏变量，例如函数或块。](http://en.wikipedia.org/wiki/Variable_shadowing)

但是有一种方法可以访问 C 中的阴影**全局非静态**变量：

```
int foo = 1;                       // global

int bar(void) {

    printf ("%d", foo);            // print global
    {
        int foo = 2;               // global foo shadowed
        printf ("%d", foo);        // print local
        {
             extern int foo;       // local foo shadowed
             printf("%d", foo);    // print global
        }                          // global foo shadowed
        printf ("%d", foo);        // print local
    }                              // end of scope for local foo
} 
```

我制作了一些虚拟块，因为使用 C99 之前的编译器，您不能在块中间声明变量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T22:05:50.687

第二个 'foo' 的范围从它的声明开始，一直持续到它被声明的块的末尾。当你调用 free(foo) 时，它正在对第一个 'foo' 起作用，因为第二个 foo 还没有被声明.

在声明了第二个 'foo' 之后，就无法访​​问外部的 'foo'。你基本上掩盖了这个名字。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T22:06:39.580

这不是错误，可以在不同的范围内声明具有相同名称的变量。

编译器知道自由函数内部的 foo 是外部的，因为此时它是程序的唯一 foo。

在声明第二个 foo 之后，您应该使用

```
::foo = ... 
```

访问外部 foo，（编辑）如果外部 foo 被声明为全局（在任何函数之外）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T22:15:18.547

这是因为范围和符号表。

您在此处的示例比正常范围界定更连贯（我强烈建议不要使用此类构造）。但是解释是编译器会在您声明新变量时更新符号表，直到那时符号表查找才落入外部范围。

正如您在此示例中看到的那样，指针的地址发生了变化：

```
void *var = NULL;
{
    std::cout << "From outer scope: " << &var << std::endl;

    void *var = NULL;

    std::cout << "From inner scope: " << &var << std::endl;
} 
```

# javascript - 如果我没有 Mac 和 Safari，我将如何重现 Javascript 错误？

> ID：918249
> 
> 赞同：3
> 
> 时间：2009-05-27T22:08:35.097
> 
> 标签：javascript, html, macos, testing, safari

简单的问题...如果我没有 Mac 和 Safari，我将如何重现 Javascript 错误？是否可以在 VMWare 上运行 Mac OS 的合法副本，或者甚至更好……在 Windows 中运行 Safari？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-27T22:09:34.940

Apple 为 safari 提供了 Windows 下载，但它早已不复存在。

这已经过时了。无法删除此已接受的答案。:-(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T22:09:41.647

> 甚至更好...在 Windows 中运行 Safari？

当然： http: [//www.apple.com/safari/](http://www.apple.com/safari/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T02:32:31.977

我希望任何 JS 错误都可以在 Windows 版本的 Safari 中重复出现。但是，为了完整起见，有一些服务允许您在 OS X、Linux 和 Windows 上的大量浏览器中查看您的网页，例如 litmusapp.com。在这种情况下，您的问题表明您可能需要的不仅仅是屏幕截图——browsrcamp.com 提供了一项服务，可让您远程访问 Mac 并以交互方式使用 Web 浏览器。

（一粒盐：我自己没有使用过任何这些服务。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T22:09:55.297

这是一个非常奇怪的问题。Javascript 在任何平台上都可能存在错误。为什么不下载适用于 Windows 的 Safari，或者将 Firefox 与[Firebug](http://getfirebug.com/)结合使用？

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2009-05-27T22:10:13.567

如果它只是 Javascript，您可以在任何浏览器中重现它们。一定要使用像 FireBug 这样的东西来帮助你

# linker - 是什么导致链接器只给出“ld 返回 1 退出状态”消息？

> ID：918252
> 
> 赞同：2
> 
> 时间：2009-05-27T22:09:01.307
> 
> 标签：linker, ld

我正在为 ld 使用“--verbose”，试图获得一些对发现问题有用的东西，但它在打印正常的“--verbose”输出时会打印错误消息：

```
[...blah - dump of linker script...]
attempt to open blah1.o succeeded
blah1.o
attempt to open blah2.o succeeded
blah2.o
[...blah - more opens that succeeded...]
attempt to open blah9.o succeeded
blah9.o
attemcollect2: ld returned 1 exit status 
```

调用者：

```
gcc blah1.o [...blah...] blah9.o blahLib1.a blahLib2.a -g -lc -nostdlib -Wl,--warn-constructors -fpic -fno-pic -Wl,-q -Wl,-gc-sections -Wl,--verbose -T blahScript.ld -lm -o blahProgram.elf 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-04-05T10:39:26.453

Fwiw，我今天遇到了同样的问题。原因是磁盘空间不足。在这种情况下，“ld”似乎只返回一个退出代码 1，根本没有打印任何消息。增加可用磁盘空间解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T22:39:00.323

这是一个通用错误。通常由对符号的未定义引用引起。

我认为您不需要 --verbose 来查看错误。ld 在任何情况下都应该打印错误的原因。尝试在不使用 --verbose 的情况下运行它并仔细检查输出的每一行。

# c# - 如何编写 NullOrEmpty 合并运算符

> ID：918253
> 
> 赞同：3
> 
> 时间：2009-05-27T22:09:19.073
> 
> 标签：c#

是否可以向 String 类添加一个新的运算符，看起来像

```
string val = anotherVal ??? "Default Val"; 
```

和工作一样

```
string val = !String.IsNullOrEmpty(anotherVal) ? anotherVal : "Default Val"; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T22:14:18.080

您不能为字符串类定义自己的运算符并在 C# 中使用它们。（F# 允许您为任意类创建运算符，有点像扩展方法，但适用于其他成员类型。）

您*可以*做的是编写一个扩展方法：

```
public static string DefaultIfEmpty(this string original, string defaultValue)
{
    return string.IsNullOrEmpty(original) ? defaultValue : original;
} 
```

并调用它：

```
string val = anotherValue.DefaultIfEmpty("Default Val"); 
```

如果除非需要，否则您不想评估“默认”字符串，则可以使用一个函数进行重载：

```
public static string DefaultIfEmpty(this string original,
                                    Func<string> defaultValueProvider)
{
    return string.IsNullOrEmpty(original) ? defaultValueProvider() : original;
} 
```

并调用它：

```
string val = anotherValue.DefaultIfEmpty(() => "Default Val"); 
```

# .net - 在示例项目 .zip 或 svn 存储库中添加数据库

> ID：918255
> 
> 赞同：1
> 
> 时间：2009-05-27T22:09:30.430
> 
> 标签：.net, sql-server, visual-studio-2008

我经常想将示例应用程序发送给使用数据库的朋友和同事。

对于实际项目，我想在存储库中包含一些东西，允许人们快速重新创建数据库，以避免不得不依赖服务器 X 几年后仍然存在。

我不太擅长 MS SQL 服务器管理工​​作室，所以我想知道在一个文件中获取 MS SQL 2005+ 数据库的最简单、最快和最干净的过程是什么，该文件也很容易“解压缩”到一个真实的数据库中。

**最终目标是让其他人能够让数据库驱动的应用程序尽可能快地工作。**

我真的很喜欢将 .Net 成员表添加到您选择的数据库中的 .exe。真的很容易使用。有没有可用的工具可以做这样的事情？

我知道的其他选项是 .bak 文件，但我发现构建/解包并不特别容易。（需要太多步骤，比如启动 sql server management studio）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T22:16:11.557

[我是Microsoft SQL Server Database Publishing Wizard 1.1](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en)的忠实粉丝。此应用程序允许您使用简单的 UI 来选择所需的数据库。然后它将整个数据库（包括其结构和数据）转换为 SQL 文本文件。最终用户只需在空数据库中执行文件即可重新创建所有内容。

这是一个不错的方法，因为它可以在用户无法直接访问服务器以附加 mdf 文件的环境中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T22:13:00.470

对于直接 SQL Server，最快的方法是分离数据库，将其压缩，然后将其重新附加到目标服务器上。备份和恢复需要多点击几下。

如果您使用 SQL Compact 3.5，则无需执行任何操作 - 数据库只是与应用程序一起部署的单个文件。但是，Compact 中的功能受到严格限制，因此这可能不是每种情况下的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T22:13:26.197

如果您提供数据库 mdf 和 ldf 文件，您可以执行一行 Attach 命令。

如果您对数据库的要求不高，您可以尝试使用 SQL CE，它是一种无安装引擎（仅包括程序集），您的数据库将是一个文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T22:13:44.230

对于最终用户（而不是您）来说，最简单的方法是将整个数据库包含为 sql server 精简版。您甚至可以在没有任何本地安装的情况下执行此操作（通过将相关的 dll 放在应用程序的私有 bin 路径中），因此它是零努力。

如果他们希望在您的应用程序之外编辑数据库，普通的 sql server 工具可以做到这一点。

# asp.net - 更改 Web 应用项目的 IIS 6 应用程序池

> ID：918266
> 
> 赞同：0
> 
> 时间：2009-05-27T22:10:43.407
> 
> 标签：asp.net, iis-6

在最近的硬件问题之后，我尝试将我们的几个网站切换为使用新的、单独的应用程序池。在我们的登台服务器上运行的测试运行良好，并且没有产生明显的负面后果。

不幸的是，在我们的现场机器上尝试相同的操作让我们的一个关键应用程序陷入困境——我最好的猜测是会话状态中存在某种不匹配。我可以正常登录，但点击几下后会出现一个屏幕，该屏幕是部分登录屏幕，但所有菜单都可见。这向我表明系统的*一部分*认为会话已丢失（重定向到登录页面），但 IIS 本身并没有丢失会话（因此菜单显示在母版页上）。

我尝试回收所有应用程序池（新旧），以及使用 IIS 管理器的每个网站。我还尝试了对 web.config 文件的单空格更改，以及 dll 的完整版本。尽管如此，我仍然可以间歇性地使用系统，点击几下，做一些有用的事情，然后可能会再次进入登录屏幕或类似的界面。我们有一些日志记录，在某些情况下，我可以看到会话在几秒钟后超时，大大低于应用程序池上的设置（默认 20 分钟）。

一旦我将网站的应用程序池切换回默认值，一切都恢复正常。

我错过了什么？任何建议都感激不尽！

**编辑：**

只是想...在暂存环境中，我确实将应用程序池命名为与网站名称不同（例如 Xxxx_Dev、Xxx_Test 等），但在现场我只是将其命名为与网站相同的名称。这会导致问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T22:14:47.627

您的各种应用程序都使用表单身份验证吗？您是否在 Authentication 标签下的 web.config 中的每个表单标签中指定了唯一的路径属性？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T00:13:16.623

好的。我想我找到了问题所在。

我实际上使用的是由其他人设置的应用程序池 - 预期名称 - 但他们已经使用“属性”、“性能”选项卡 | 设置了它。使用 4 个工作进程的 Web Garden 选项。我现在已将其更改为 1。

由于会话状态被存储在“进程中”（默认值），每次连接到达一个新线程时，它基本上也会丢失任何存储的会话变量，正如我现在所理解的那样。

Its early days, but a simple switch to the newly altered Application Pool (no restarts or web.config saves necessary thus far) and everything appears to be behaving normally.

# c++ - 更改最近文件的总数

> ID：918268
> 
> 赞同：1
> 
> 时间：2009-05-27T22:12:27.553
> 
> 标签：c++, windows, mfc, recent-file-list

我希望用户能够编辑在我的 MFC 应用程序的文件菜单中显示的最近文件的数量。我使用了两个非常好的参考资料：

*   [http://www.codeproject.com/KB/menus/changemru.aspx](http://www.codeproject.com/KB/menus/changemru.aspx)
*   [http://www.microsoft.com/msj/0899/c/c0899.aspx](http://www.microsoft.com/msj/0899/c/c0899.aspx)

它涉及删除和重新创建`CRecentFileList`存储在`CWinApp::m_pRecentFileList`. 不幸的是，我发现在更换`CRecentFileList`. 请参阅下面的代码片段：

```
void CMyWinApp::SetMRUListSize( int size )
{
   // size guaranteed to be between 1 and 16
   delete m_pRecentFileList ;
   LoadStdProfileSettings( size ) ;
} 
```

在我重新创建对象后，我可以做些什么来确保绘制到文件菜单中的内容与之同步`m_pRecentFileList`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T07:49:22.043

My CApp derives from CWinApp. In initInstance, you have this line:

```
LoadStdProfileSettings(10); 
```

At the end of InitInstance, add this code:

```
m_pmf->m_pRecentFileList = m_pRecentFileList; 
```

Here m_pmf is my MainFrame class and I created a member CMainFrame::m_pRecentFileList of type CRecentFileList which is in the MFC source file filelist.cpp. m_pRecentFileList on the right is protected and CMainFrame doesn't have access to it from outside InitInstance, but you can make a functional copy here.

At the end of CMainFrame::OnClose, force a registry update by:

```
 m_pRecentFileList->WriteList(); 
```

// Force registry update on exit. This doesn't work without forcing.

I don't even have to rebuild m_pRecentFileList, the MRU mechanism updates it correctly. Example: 5 MRU items, the first is moved to another directory and can no longer be found. Stepping through the code in the debugger shows that the bad entry is removed from the list. For some reason, the updated list isn't saved correctly unless I force it as explained above. I originally thought the problem might have something to do with privileges (64-bit Win7), but running the app as admin didn't help.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T23:08:52.200

[Microsoft 的一些文档](http://msdn.microsoft.com/en-us/library/xbkh2k4h(VS.80).aspx)建议您应该`CWinApp::LoadStdProfileSettings`从内部调用`InitInstance`. 这向我表明，这是在初始化期间而不是在运行时完成的事情。

您是否尝试过完全实现您提供的两个链接中的第二个？我的猜测是您需要添加第二部分而不是调用`CWinApp::LoadStdProfileSettings`：

```
m_pRecentFileList = new CRecentFileList(0, strSection, strEntryFormat, nCount);
if(m_pRecentFileList)
{
    bReturn = TRUE;

    // Reload list of MRU files from registry
    m_pRecentFileList->ReadList();
} 
```

**[编辑]**显然`m_pRecentFileList`指向一个[CRecentFileList Class](http://msdn.microsoft.com/en-us/library/5a5b36d5(VS.80).aspx) 。您是否尝试过调用[CRecentFileList::UpdateMenu](http://msdn.microsoft.com/en-us/library/cs6te8ba(VS.80).aspx)？

还有[另一个 CodeProject 示例也可能有所帮助](http://www.codeproject.com/KB/menus/deletemenu.aspx?fid=39099&df=90&mpp=25&noise=3&sort=Position&view=Quick)。

# macos - MacOS 可以在 VMWare 类型的环境中运行吗？

> ID：918277
> 
> 赞同：7
> 
> 时间：2009-05-27T22:14:56.240
> 
> 标签：macos, vmware

MacOS 可以在 Windows 上的 VMWare 类型环境中运行吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T22:40:05.953

这可能是您正在寻找的。祝你好运！

[http://wiki.osx86project.org/wiki/index.php/Vmware_how_to](http://wiki.osx86project.org/wiki/index.php/Vmware_how_to)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T22:20:20.550

是的，OS X 可以在虚拟化环境中运行，但 OS X 客户端的许可证禁止这种使用。OS X Server 可以合法地在虚拟化环境中运行，但只能在 Mac OS X 主机上运行（不能在 Windows 上的 VMWare 下运行，抱歉）。我们使用运行 OS X 10.5 Server 的 VMWare Fusion 映像来测试部署。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T22:44:01.000

是的，我在 Windows 的 WMWare 虚拟环境中运行了 Mac OS。我会说这个练习不值得花时间。由此产生的操作系统非常缓慢，几乎无法使用。我实际上可以看到窗口在屏幕上慢慢绘制。

Mac OS 缺少无缝混合主机和来宾操作系统的 VMWare 好东西（例如驱动程序）（因为它不是受支持的来宾，因为它被禁止）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T22:23:52.837

Mac OS X*服务器在 VMWare* *Fusion*上运行良好，但尚未在其他 VMWare 产品上得到正式支持。可以将它安装在 VMWare Workstation 上，但我不确定它的稳定性如何。请参阅官方[来宾操作系统兼容性指南](http://www.vmware.com/pdf/GuestOS_guide.pdf)。

Mac OS X 客户端不能在任何 VMWare 产品上合法运行。

# qt - 如何在 Windows XP 上为 WinCE 编译 Qt 4.5.1？

> ID：918280
> 
> 赞同：2
> 
> 时间：2009-05-27T22:15:20.013
> 
> 标签：qt, qt4, windows-ce

我正在尝试在针对 wince50 的 Windows XP 上编译 Qt 4.5.1。

我安装了先决条件（VS2008、WinCE50SDK、ActivePerl 5.10）并下载了已安装在 c:\Qt\4.5.1 和 c:\Qt 中的 qt-embedded-wince-opensource-src-4.5.1.zip \4.5.1\bin 已添加到路径中。

在 VS 命令提示符下，我导航到 c:\Qt\4.5.1 并执行以下命令：

```
configure -platform win32-msvc2008 -xplatform wince50standard-armv4i-msvc2008 -qt-gif -qt-libjpeg -qt-libpng -webkit -openssl -arch windowsce -opensource -iwmmxt 
```

我收到以下错误：

```
c:\qt\4.5.1\include\qtcore\../../src/corelib/tools/qvector.h(758) : fatal error C1083: Cannot open include file: 'QtCore/QPointF': No such file or directory
NMAKE : fatal error U1077: '"C:\Program Files\Microsoft Visual Studio 9.0\VC\BIN\cl.EXE"' : return code '0x2'
Stop. 
```

我已经在 Qt 的早期版本（低至 4.4.3）和两台不同的 XP 机器（一个具有干净构建的机器）和各种不同的配置选项上尝试过这个。每次我得到同样的错误。

我错过了什么？

**更新：**
好的，我还有一点，虽然它可能是一个死胡同。

如果我使用 qt-all-opensource-src-4.5.1 作为基础，然后运行 ​​configure 它会成功构建 qmake，但会因缺少 wince 文件而失败。因此，我然后获取 src 并包含来自 qt-embedded-wince-opensource-src-4.5.1 的文件夹并将它们复制到 qt-all 文件夹的顶部，然后配置成功完成。

但随后 nmake 失败并出现以下错误：

```
tmp\obj\debug_shared\qtmain_win.obj : fatal error LNK1112: module machine type 'X86' conflicts with target machine type 'THUMB'
NMAKE : fatal error U1077: '"C:\Program Files\Microsoft Visual Studio 9.0\VC\BIN\lib.EXE"' : return code '0x458'
Stop.
NMAKE : fatal error U1077: '"C:\Program Files\Microsoft Visual Studio 9.0\VC\BIN\nmake.exe"' : return code '0x2'
Stop.
NMAKE : fatal error U1077: 'cd' : return code '0x2'
Stop. 
```

configure 使用这种方法的事实对我来说意味着 qt-embedded-wince-opensource-src-4.5.1 版本缺少内容。

任何关于下一步要尝试什么来编译它的建议都将非常受欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T14:27:04.000

您是否正确设置了环境变量？即，拥有一个带有相应 INCLUDE 和 LIB 定义的 .bat 通常会很好。如果您安装了 Qt，则安装了一个 Qt 命令外壳，它可以作为一个很好的模板，根据您要使用的 Qt 版本，为您提供具有正确环境变量的命令提示符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T00:09:45.177

我也是 - 确保您下载了 WinCE 包而不是 Windows 安装程序，因为它不支持 WinCE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-23T00:55:53.067

qt-embedded-wince-opensource-src-4.5.1.zip 似乎没有丢失文件，它`include\QtCore\QPointF`应该包含它。我测试了那个源包，我可以很好地配置。

解压源码包后文件是否`c:\Qt\4.5.1\include\QtCore\QPointF`存在？

我可能在这里抓住了稻草，但是：您使用什么程序来解压缩源代码？您的错误消息中的文件名全部以小写显示，您的解压缩程序是否将所有文件都转换为小写？您是否使用区分大小写的文件系统？（我不知道这在 Windows 上是否可行......）这可能是一个红鲱鱼，因为我知道 cl.exe 在错误消息中任意小写文件名。

如果这没有帮助，请发布更多错误，以便我们知道究竟是什么无法编译以及传递给 cl.exe 的参数是什么。

# asp.net - 动态注释 HTML？

> ID：918282
> 
> 赞同：2
> 
> 时间：2009-05-27T22:15:33.477
> 
> 标签：asp.net, javascript, annotations

我想在 ASP.NET 页面中为 Internet Explorer 和 Firefox 执行以下操作：

1.  在窗口中显示上传的 HTML 文档。
2.  允许用户使用标准文本光标突出显示任意部分，然后按“在此处留下评论”按钮。
3.  保存突出显示的确切起点和结束点——不仅仅是突出显示内容——并将它们与唯一 ID 相关联。
4.  通过覆盖 <span class="highlight"> 标记突出显示起点和终点之间的所有内容。

1和2没问题。但是对于 3 和 4……这可能吗？如果是这样，我该怎么做？

如果 HTML 文档无法做到这一点，那么纯文本呢？（对于 HTML，我们可以假设它相对简单。例如，我设想这个支持 word 文档保存为 HTML。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T22:45:53.587

好吧，你有问题。

假设这个文本：

```
Hello my
name is
Josh and
this is an
example for you 
```

下面是这样的：

```
<span>
  Hello my
  <span>
    name is<br/>
    Josh and
  </span>
  <span>
    this is an<br/>
    example for you
  </span>
</span> 
```

然后假设我选择：

```
Josh and
this is an 
```

我选择的 HTML 是：

```
 Josh and
</span>
<span>
  this is an 
```

因此，如果您围绕它包裹一个跨度，您最终会得到一些搞砸的 HTML。

所以，我会推荐以下内容：

*   使用 javascript 获取选定的文本
*   从选定的文本中去除 HTML 标签

你最终得到这个：

```
function getSelectedTextNoHtml() {
    return getSelectedText().replace(/(<([^>]+)>)/ig, "");
}

function getSelectedText() {
    if (window.getSelection)
        return window.getSelection();
    else if (document.getSelection)
        return document.getSelection();
    else if (document.selection)
        return document.selection.createRange().text;
    return "";
} 
```

然后，您可以获取整个文档的 HTML，去除 HTML 标记并在文档的文本版本中找到所选文本的索引。

我什至可以想到（丑陋但可行）在 HTML 中获取选择索引的方法。但我警告你，如果你想要它们，它们是丑陋的。

*甚至*有一些非常丑陋的方法可以用您想要的唯一 ID 整齐地围绕选定的文本进行跨度。当然，总有办法做事。一切都只是一个算法。但这将涉及磨练它的好日子！

我已经发布了足够多的内容，如果您要我详细说明，请问！

**更新：**

好的，你要求的:)

*   获取选定的文本并将其记录在某处
*   暂时用完全独特的东西替换选定的文本
*   找到那个完全独特的文本的索引
*   把文字改回来

如果你想谨慎地做到这一点，而不需要他们的文本闪烁和改变，你可以尝试利用 HTML 零宽度空间：

```
&#8203; 
```

在它前面粘贴 100 次，找到 100 个零宽度空格的索引！

当然，如果他们的文档有 100 个零宽度空格*和*他们在其他地方选择的文本，它将失败，但此时我说“让它失败”:)

怎么样？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T15:22:50.240

要添加到@cweiske 的列表中，还有 Annotator：

*   [https://github.com/edsu/annotator-okfn](https://github.com/edsu/annotator-okfn)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-27T08:34:05.823

有几种可用的 HTML 注释工具：

*   [http://code.google.com/p/adnotatio/](http://code.google.com/p/adnotatio/)
*   [http://code.softwarefreedom.org/projects/stet](http://code.softwarefreedom.org/projects/stet)
*   [http://code.google.com/p/adnotatio/wiki/References](http://code.google.com/p/adnotatio/wiki/References)

# java - 什么是仅称为 Beak! 的不可渲染错误？（或小于点）

> ID：918284
> 
> 赞同：7
> 
> 时间：2009-05-27T22:16:06.657
> 
> 标签：java, iis, coldfusion

我曾经在我工作的一家商店每隔几天就会收到一个错误，其中一位用户称它为“Beak”，因为她认为这让她想起了一个：

**<.**

...在源代码中，它看起来像：

`<P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><.</B>`

通过在 ColdFusion 服务器上弹跳 JRun 可以轻松地逆转“喙”，当我直接控制我的服务器时，这对我来说已经足够了，并且弹跳它不需要时间并且不会对任何人造成太大影响。

现在我在一家商店，我没有管理员访问网络服务器的权限，而且（从业务角度来看），服务器在任何给定时刻都在交易大美元符号，不能只是被退回。

谷歌无法搜索除了随机收集的 B 和 P 之外的任何东西，这永远挫败了我永恒的好奇心。

但是现在...现在我有...所以知道。

我不能说它是 CF，事实上，我怀疑它实际上是 Java……或者 IIS……或者宇宙用一根烦人的喙状棒戳我……

鸟嘴到底是什么，我该如何让它消失？

* * *

**为困惑的编辑...**

我不能说我可以使问题更清楚，但我可以说缺乏清晰度主要是错误的函数，而不是我缺乏包容性。

该错误不是来自一段代码...没有特定的行号...查看日志文件从未发现在问题发生之前运行的一个或多个模板。

一旦触发错误，就会影响从服务器请求的每个模板，其效果是返回此字符串，而不是其他任何内容，以响应 HTTP 请求：`<P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><B><P><.</B>`

重新启动 JRun 服务会导致问题消失...无需重置 Web 服务器（在所有情况下都是 IIS）或数据库服务器（MSSQL、MySQL 和 Access）或服务器本身（Windows、各种版本、各种硬件）。

老实说，我没想到以前没有看到这个确切错误的人甚至会做出回应。我很欣赏人们尝试过的好意，但这不是 Web 开发人员监督错误（在传统意义上），可能不需要代码片段来识别或解决它。

我希望这至少能在一定程度上澄清我缺乏信息，以阐明我为什么要求更多信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T22:04:18.180

查看生成此输出的页面的源代码会有所帮助。您所描述的不是任何程序语言的“错误”，而是函数的结果，或者可能是对某些资源有时不可用的期望。您可以采取的措施来解决此问题，包括尽可能多地收集有关导致问题发生的原因的信息。以下是调试未知问题时要遵循的一些一般准则。

1.  问题是否与相同的信息断断续续？如果是这样，那么很可能不是某些明确的代码行是错误的，而是对开发人员假设始终可用的某些外部资源（如数据库）的假设（您的代码必须考虑用户将体验到的情况，如果数据库不可用）。
2.  可以在不同的环境（例如您的工作站）上重现该问题吗？有时平台之间的细微变化（Debian 与 Red Hat，甚至 Java 1.6.10 与 Java 1.6.9）可能会带来意想不到的问题。
3.  可以用不同的信息重现问题吗？可能出现问题是因为开发人员认为某些无效值永远无法通过某个较早的过滤器，因此从不费心在产生错误的函数处捕获无效值，这在编写不佳的 Web 应用程序中很常见，因为人们倾向于假设HTML FORMs 只允许输入一组特定的值

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-29T09:15:06.083

奇怪的问题，所以一个奇怪的答案。

a) 小于点 ("<.") 是 J 编程语言中使用的符号，据我所知，它与 Java 底层 ColdFusion 没有任何关系。这意味着（我引用[了 Steven Phillips 在日本开设的关于 J 的课程](http://staff.aist.go.jp/steven.phillips/teaching/Assessment.html)

```
Monadic case: Returns the next integer less than y 
Dyadic case: Returns x if x is smaller than y, else y 
```

[b）这个精确的错误被用户kaht](http://www.tek-tips.com/viewthread.cfm?qid=1451364&page=6)在另一个论坛上用作签名，所以他们可能对此有所了解。签名中的链接会将您带到[lessthandot.com](http://www.lessthandot.com)，这是一个包含大量谜题的编程论坛。论坛名称由“Beak”提示。

如果您可以发布错误的完整输出，那么找出导致错误的原因还有很长的路要走；如您所知，重新启动 CF 服务器并不是永久的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-30T12:41:54.737

也许是内存泄漏？这可以解释它“随机”发生并通过重新启动 JRun 来修复的事实。

“喙” ( `<P><B><P><B><P><B><P>`...) 可以由应用程序中的[cferror模板生成。](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Tags_d-e_11.html)您应该尝试更改错误模板（如果没有，则创建一个），使其仅包含以下行。

```
<cfdump var="#cferror#"> 
```

根据您提供的信息，这是我的最佳猜测。人们要求提供更多信息，我认为拒绝是错误的。我可以根据经验告诉你，如果你坚持认为自己存在疏忽，你会更快、更频繁地找到此类问题的答案。

# sharepoint - 错误：在 TrackedRequests 中找不到请求。我们可能在不同的线程上创建和关闭网络

> ID：918293
> 
> 赞同：1
> 
> 时间：2009-05-27T22:17:36.047
> 
> 标签：sharepoint, workflow, infopath

这是我在将自定义工作流部署到表单库时从 Sharepoint 收到的错误。工作流程非常简单，并没有做任何花哨的事情。我正在阅读信息路径表单，但此后剥离了所有非必要代码以查看是否可以使其正常工作。据我所知，其他工作流程都很好（我在同一个盒子上开发了其他工作流程，它们完好无损且正常运行）。工作流的设计视图如下：

[替代文字 http://img5.imageshack.us/img5/7231/workflowv.jpg](http://img5.imageshack.us/img5/7231/workflowv.jpg)

成功创建任务后出现错误。这让我相信 while 循环存在问题，它正在等待一个布尔变量变为真（最初设置为假）。通常，当以任何方式更改任务时，将触发 changed 事件并将变量更改为 true，然后工作流将继续。我在此工作流程开始时收到此错误：

> 错误：在 TrackedRequests 中找不到请求。我们可能会在不同的线程上创建和关闭网络。ThreadId = 9，免费调用堆栈 = 在 Microsoft.SharePoint.SPRequestManager.Release(SPRequest request) 在 Microsoft.SharePoint.SPSite.Close()
> 在 Microsoft.SharePoint.SPSite.Dispose() 在 Microsoft.SharePoint.Workflow.SPWorkflowAutostartEventReceiver.AutoStartWorkflow （SPItemEventProperties 属性、Boolean bCreate、Boolean bChange、AssocType atyp）在 Microsoft.SharePoint.Workflow.SPWorkflowAutostartEventReceiver.ItemAdded(SPItemEventProperties properties) 在 Microsoft.SharePoint.Workflow.SPWorkflowAutostartEventReceiver.AutoStartWorkflow(SPItemEventProperties properties, Boolean bCreate, Boolean bChange) 在 Microsoft。 SharePoint.SPEventManager.RunItemEventRec...
> ...eiver（SPItemEventReceiver 接收器，SPItemEventProperties 属性，SPEventContext 上下文，字符串receiverData）在Microsoft.SharePoint.SPEventManager.RunItemEventReceiverHelper（对象接收器，对象属性，SPEventContext 上下文，字符串receiverData）在Microsoft.SharePoint.SPEventManager。<>c__DisplayClass8`1 .b__0() 在 Microsoft.SharePoint.SPSecurity.CodeToRunElevatedWrapper(Object state) 在 Microsoft.SharePoint.SPSecurity.RunAsUser(SPUserToken userToken, Boolean bResetContext, WaitCallback code, Object param)
> 在 Microsoft.SharePoint.SPSecurity.RunAsUser(SPUserToken userToken, CodeToRunElevated代码）
> 在 Microsoft.SharePoint.SPEventManager.InvokeEventReceivers[ReceiverType](SPUserToken userToken, RunEventReceiver runEventReceiver, Obj... ...ect 接收器, 对象属性, Boolean checkCancel) 在 Microsoft.SharePoint.SPEventManager.InvokeEventReceivers[ReceiverType](Byte[] userTokenBytes , RunEventReceiver runEventReceiver, Object receivers, Object properties, Boolean checkCancel) at Microsoft.SharePoint.SPEventManager.HandleEventCallback[ReceiverType,PropertiesType](Object callbackData) at Microsoft.SharePoint.Utilities.SPThreadPool.WaitCallbackWrapper(Object state) at System.Threading._ThreadPoolWaitCallback .WaitCallback_Context(Object state) 在 System.Threading.ExecutionContext.runTryCode(Object userData) 在 System.Runtime.CompilerServices.RuntimeHelpers。在 System.Threading.ExecutionContext.RunInternal(Execu..

我搜索了高低的解释，但找不到任何能具体解决这个问题的东西。这确实是一个简单的工作流程，没有什么特别的事情发生……也许是它所附加的表单库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-14T16:42:21.290

We had the same problem and found a [possible solution](http://www.muhimbi.com/blog/2009/07/solution-for-sharepoints-common.html).

Although we were disposing our SPSite and SPWeb objects properly, we forgot to dispose the BinaryStream we took of the SPFile object.

We are still seeing the same problem on SharePoint Designer workflows, even when they contain no actions. I have started [a separate thread for that issue](https://stackoverflow.com/questions/2021033/investigating-the-root-cause-behind-sharepoints-request-not-found-in-the-tracke).

# python - Mac os X终端中的Python unicode

> ID：918294
> 
> 赞同：8
> 
> 时间：2009-05-27T22:17:54.703
> 
> 标签：python, macos, unicode, terminal

有人可以向我解释这个奇怪的事情：

在 python shell 中，我输入以下西里尔文字符串：

```
>>> print 'абвгд'
абвгд 
```

但是当我输入：

```
>>> print u'абвгд'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
UnicodeEncodeError: 'ascii' codec can't encode characters in position 0-9: ordinal not in range(128) 
```

由于第一个字符串正确出现，我认为我的 OS X 终端可以表示 unicode，但事实证明在第二种情况下不能。为什么 ？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-27T23:12:40.227

```
>>> print 'абвгд'
абвгд 
```

当您输入一些字符时，您的终端决定这些字符如何呈现给应用程序。您的终端可能会将字符提供给编码为 utf-8、ISO-8859-5 甚至只有您的终端可以理解的应用程序。Python 将这些字符作为一些字节序列获取。然后 python 按原样打印出这些字节，您的终端以某种方式解释它们以显示字符。由于您的终端通常以与之前对其进行编码相同的方式解释字节，因此所有内容都会像您输入的那样显示。

```
>>> u'абвгд' 
```

在这里，您输入一些作为字节序列到达 python 解释器的字符，可能由终端以某种方式编码。使用`u`前缀 python 尝试将此数据转换为 unicode。要正确执行此操作，python 必须知道您的终端使用什么编码。在您的情况下，Python 猜测您的终端编码将是 ASCII，但接收到的数据不匹配，因此您收到编码错误。

因此，在交互式会话中创建 unicode 字符串的直接方法是这样的：

```
>>> us = 'абвгд'.decode('my-terminal-encoding') 
```

在文件中，您还可以使用特殊模式行指定文件的编码：

```
# -*- encoding: ISO-8859-5 -*-
us = u'абвгд' 
```

有关设置默认输入编码的其他方法，您可以查看`sys.setdefaultencoding(...)`或`sys.stdin.encoding`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-03-29T18:05:07.067

从 Python 2.6 开始，您可以使用环境变量`PYTHONIOENCODING`告诉 Python 您的终端支持 UTF-8。使其永久化的最简单方法是将以下行添加到您的`~/.bash_profile`:

```
export PYTHONIOENCODING=utf-8 
```

![Terminal.app 显示 Python 的 unicode 输出](https://i.stack.imgur.com/T3sID.png)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-27T22:52:42.590

除了确保您的 OS X 终端设置为 UTF-8 之外，您可能希望将您的 python sys 默认编码设置为 UTF-8 或更好。在`/Library/Python/2.5/site-packages`名为`sitecustomize.py`. 在这个文件中放：

```
import sys
sys.setdefaultencoding('utf-8') 
```

该`setdefaultencoding`方法仅在站点模块中可用，并且在[启动完成后从 sys 命名空间](http://docs.python.org/library/sys.html#module-sys)中删除。因此，您需要启动一个新的 python 解释器才能使更改生效。您可以在启动后随时验证当前的默认编码`sys.getdefaultencoding()`。

如果字符还不是 unicode 并且您需要转换它们，请`decode`在字符串上使用该方法以将文本从其他字符集解码为 un​​icode ...最好指定哪个字符集：

```
s = 'абвгд'.decode('some_cyrillic_charset') # makes the string unicode
print s.encode('utf-8') # transform the unicode into utf-8, then print it 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T22:30:55.253

另外，确保终端编码设置为 Unicode/UTF-8（而不是 ascii，这似乎是您的设置）：

[http://www.rift.dk/news.php?item.7.6](http://www.rift.dk/news.php?item.7.6)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T22:28:32.873

在某些控制台上显示 unicode 对象之前，需要对其进行编码。尝试

```
u'абвгд'.encode() 
```

而是将 unicode 编码为字符串对象（很可能使用 utf8 作为默认编码，但取决于您的 python 配置）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T23:14:40.657

'абвгд' 不是 unicode 字符串

u'абвгд' 是一个 unicode 字符串

不编码就不能打印 unicode 字符串。当您在应用程序中处理字符串时，您希望确保任何输入都被解码并且任何输出都被编码。这样，您的应用程序将仅在内部处理 unicode 字符串并以 UTF8 输出字符串。

以供参考：

```
>>> 'абвгд'.decode('utf8') == u'абвгд'
>>> True 
```

# python - 异步 Django 模型查询是否可行？

> ID：918298
> 
> 赞同：23
> 
> 时间：2009-05-27T22:19:00.053
> 
> 标签：python, mysql, django, multithreading, django-models

我是 Django 新手，但我想到的应用程序最终可能会具有如下所示的 URL：

```
http://mysite/compare/id_1/id_2 
```

其中“id_1”和“id_2”是两个不同模型对象的标识符。在“比较”的处理程序中，我想异步地、并行地查询和检索对象 id_1 和 id_2。

有没有办法使用标准的 Django 语法来做到这一点？我希望伪代码最终看起来像这样：

```
import django.async 

# Issue the model query, but set it up asynchronously.  
# The next 2 lines don't actually touch my database 
o1 = Object(id=id_1).async_fetch()
o2 = Object(id=id_2).async_fetch()

# Now that I know what I want to query, fire off a fetch to do them all
# in parallel, and wait for all queries to finish before proceeding. 

async.Execute((o2,o2))

# Now the code can use data from o1 and o2 below... 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T23:07:42.047

正如您所描述的那样，没有严格的异步操作，但我认为您可以通过使用 django 的[in_bulk](http://docs.djangoproject.com/en/dev/ref/models/querysets/#in-bulk)查询运算符来实现相同的效果，该运算符需要一个 id 列表进行查询。

像这样的东西`urls.py`：

```
urlpatterns = patterns('',
    (r'^compare/(\d+)/(\d+)/$', 'my.compareview'),
) 
```

这对于视图：

```
def compareview(request, id1, id2):
    # in_bulk returns a dict: { obj_id1: <MyModel instance>, 
    #                           obj_id2: <MyModel instance> }
    # the SQL pulls all at once, rather than sequentially... arguably
    # better than async as it pulls in one DB hit, rather than two
    # happening at the same time
    comparables = MyModel.objects.in_bulk([id1, id2])
    o1, o2 = (comparables.get(id1), comparables.get(id2)) 
```

# statistics - 网络用户最不常用的字符是什么？

> ID：918308
> 
> 赞同：1
> 
> 时间：2009-05-27T22:25:09.697
> 
> 标签：statistics

我需要将其用作分隔符，

有人知道这个统计数据吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-27T22:31:03.727

选择任何字符，然后选择一种机制来转义该字符以处理用户想要键入它的情况。例如，在逗号分隔的文件中，逗号是分隔符：

```
1,2，弗雷德，约翰
```

除非数据本身包含逗号，否则您引用它：

```
1,2，“博客，弗雷德”，约翰
```

如果您需要使用报价：

```
1,2,"Bloggs, Fred","Jean-Luc \"Make it so\"Picard"
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T22:32:06.860

我认为你使用什么字符并不重要，你不应该只希望没有人会输入你的分隔符。使用逗号并处理用户添加自己的逗​​号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T22:34:36.153

您可以在 Web 上的任何数据前面加上长度。这就是 HTTP-Chunked 编码通过 Web 发送内容的方式。

[http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T23:58:46.107

您听起来好像正在尝试将字符串列表转换为单个字符串，以便您以后可以将其转换回字符串列表。

有几种传统的方法可以解决这个问题，其中大部分已经在这个线程中提到：

*   使用不常见的字符作为分隔符，并且不允许在输入中使用它，方法是拒绝包含分隔符的输入，或者将分隔符替换为“？” 或者 ”。” 或类似的。为此，我同意建议竖线（|）的人
    *   优点：代码很简单，可以使用多种语言
    *   缺点：通过消除包含分隔符的输入的可能性，您失去了一些表达能力和未来扩展的机会。
*   当分隔符出现在输入中时，使用分隔符和转义机制。这实际上有几个变种：
    *   “就像 C 代码一样”方法，您可以在分隔符或转义字符的数据中的每次出现前添加一个转义字符。例如：字符串 « `Greetings,Hey,Hello\,World,Hello \\ Backslash`» 包含四个元素，`,`用作分隔符和`\`转义字符。（最后一个元素原本有一个反斜杠）
        *   这实际上是在许多语言中正确编码和实现的痛苦
        *   即使您确实实现了它，与其他方法相比，它通常也要慢得多
    *   您的转义机制是将定界符转换为不包含定界符的多字符序列的“类似 URL 参数”方法。然后，您还需要将分隔符变成的第一个字符转换为其自己的多字符序列。例如，如果您决定将其`,`用作分隔符，并决定表示`,`为« `\1`» 和`\`« `\2`»，您可以将最后一个示例写为：« `Greetings,Hey,Hello\1World,Hello \2 Backslash`»
        *   这通常不太难实现。优点是您可以在单独的步骤中执行从字符串到字符串列表的“拆分”和“取消转义”部分。取消转义过程可能有点棘手，因为您必须扫描每个字符串。
    *   就像 CSV 文件一样，在包含分隔符的项目周围加上引号，并且引号根据一些晦涩的机制进行了转义。（比如翻倍）
        *   避免这种情况，除非您可以将其扔到预先存在的库中。
        *   这具有“Like C 代码”方法的所有缺点，以及在实现它时会搞砸的额外混乱状态。
    *   上述方法之一，但带有多字符分隔符。这比你想象的要难；额外的字符实际上使应该转义的逻辑大大复杂化。
*   为每个项目加上其长度的前缀，然后包含未更改的项目
    *   HTTP 在其[“分块”编码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html)、[bencoding](http://en.wikipedia.org/wiki/Bencode)（bittorrent 使用的有线格式）和 Google 的[协议缓冲区](http://code.google.com/apis/protocolbuffers/docs/encoding.html#types)中使用了这一点。
    *   实现这一点可能有点棘手，并且很容易出现错误。我仍然认为它比“like C code”方法更容易实现，尤其是在低级语言中。
    *   一旦你正确地实现它，它通常比其他方案快得多，即使是只禁止包含分隔符的输入的有损方案。（例外情况是，如果您使用具有内置“拆分”例程的高级语言）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T23:14:59.817

在这种情况下，我喜欢使用竖线 | 特点。

*   查看文本文件时很容易发现。
*   它清楚地标志着分离。
*   它很少使用。
*   而且，由于它在英语语法中没有内在含义，如果它出现在列文本中，很容易要么直接禁止它，要么盲目地将其更改为其他内容（如破折号）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T22:29:11.047

使用字符串作为分隔符怎么样？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T22:27:53.920

我敢肯定有很多奇怪的 unicode 字符没有被太多使用，但这可能不是你要找的。

为什么你想要一些“稀有”的分隔符？它将如何使用？

# c# - 两种类型的回发事件

> ID：918313
> 
> 赞同：2
> 
> 时间：2009-05-27T22:28:42.107
> 
> 标签：c#, asp.net, events, gridview, postback

1）我找到了两篇文章，每篇文章对两种类型的回发事件进行了不同的分类：

> 一种资源说两种类型的回发事件是**Changed**事件（其中控件实现 IPostbackDataHandler ），当数据在回发之间发生更改时触发，然后是**Raised**事件（其中控件实现 IPostbackEventHandler ），无论出于何种原因由服务器控件引发控制认为合适
> 
> 另一篇文章说这两种类型是**立即响应**事件和**更改**事件。根据这篇文章，即时响应事件是实际触发回发的事件

a) 哪个分类是正确的？

b) 如果第二篇文章是正确的，那么如果 TextBox 控件具有 AutoPostBack=”true”，那么 TextChanged 是否也应该被视为即时响应事件？

2) 当页面由于某些用户操作而被提交回服务器时， *在事件处理阶段*，ASP.NET 引发自上次回发以来其数据发生更改的所有控件的事件。实际触发回发的事件（如 Click 事件）最后引发

a) 但是如果用户在 GridView 中选择一行导致回发怎么办？当 GridView 由于行选择而导致回发时，与更简单的控件（如 TextBox 或 Button ）不同，回发导致 GridView 在事件处理阶段（SelectedIndexChaning 和 SelectedIndexChanged）触发的不是一个，而是多个服务器端事件。

ASP.NET 认为哪些 GridView 事件是导致回发的事件？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T22:31:35.973

即使 Autopostback 属性为 false，SelectedIndexChanged 事件（在列表框上）和 TextChanged 事件（在文本框上）也会在回发时触发。

试着把它放在一个表格上：

```
 <asp:ListBox runat="server" ID="test" 
        onselectedindexchanged="test_SelectedIndexChanged">
<asp:ListItem >number1</asp:ListItem>
 <asp:ListItem >number2</asp:ListItem>     
</asp:ListBox>

<asp:TextBox runat="server" ID="text" ontextchanged="text_TextChanged" />
<asp:Button runat="server" Text="Click Me" /> 
```

这在后面的代码中：

```
 protected void test_SelectedIndexChanged(object sender, EventArgs e)
    {
        Response.Write("SelectedIndexChanged");
    }

    protected void text_TextChanged(object sender, EventArgs e)
    {
        Response.Write("TextChanged");
    } 
```

然后运行它，更改所选项目，输入一些文本，然后点击按钮 - 两个事件都会触发。您可以使用 Reflector 查看事件的顺序。对于文本框，RaisePostDataChangedEvent 方法是：

```
 protected virtual void RaisePostDataChangedEvent()
{
    if (this.AutoPostBack && !this.Page.IsPostBackEventControlRegistered)
    {
        this.Page.AutoPostBackControl = this;
        if (this.CausesValidation)
        {
            this.Page.Validate(this.ValidationGroup);
        }
    }
    this.OnTextChanged(EventArgs.Empty);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T22:32:53.877

SelectedIndexChanging 首先被调用，通常是我进行任何类型更新的地方。SelectedIndexChanged 发生在 SelectedIndexChanging 之后，因此从技术上讲，页面将 SelectedIndexChanging 视为导致回发的事件。请记住，回发还会调用页面的整个生命周期，从 Init 到 Page_Load 再到您的事件。

autopostback 属性只是让站点知道在发生任何更改后进行回发，无论是 textchanged、selectedindexchanged、checkedchanged 等。如果 autopostback 属性未设置为 true，则不会发生这些事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T23:43:25.797

首先，在我看来，这两种分类是兼容的，只是表达方式不同。我想你可以说引发事件等同于立即响应事件，这只能在实现 IPostbackEventHandler 的控件中实现。

所以关于 1b，当 AutoPostBack = true 时，我相信它只是设置了一个 javascript onchange 事件来进行回发调用。回发触发后，页面检测到文本框已更改并运行更改事件。因此，这仍然不是引发事件。（我可能是错的，但这是我的理解。）

引发事件将是在控件的 RaisePostBack 方法（IPostBackEventHandler 要求）中触发的事件——该事件发生在页面加载周期之后并触发每个更改事件。

在后台，回发可以通过以下两种方式之一发生：通过提交表单（带有提交行为的 asp:button）或通过 javascript _doPostBack 调用（发生在 AutoPostBack=true 的控件中或当您直接使用 Page.客户端脚本）。

# sql - SQL 字符串操作

> ID：918317
> 
> 赞同：0
> 
> 时间：2009-05-27T22:29:46.863
> 
> 标签：sql, stored-procedures, string, user-defined-functions

我有一个存储用户信息的表。该表中有一个用户 ID（身份）列。表数据由一个视图查询，该视图被许多存储过程引用，但我们引用了一个名为 auid 的东西，它由下面的 UDF 创建。UDF 在视图中被调用，sprocs 然后根据 auid 从视图中加入或查询。看起来这个例程被调用了很多次（数千次）并且在我们的 SQL Server 上造成了一些不必要的负载。有没有更好的方法来获取 user_id = 255 并将其转换为 varchar = 000000255 （9 个字符长）？

UDF 语法：

```
ALTER FUNCTION [dbo].[udf_AUID] (@user_id int)  
RETURNS char(9) 
with schemabinding
AS  
BEGIN 
DECLARE @user_id_string varchar(9)
DECLARE @rval char(9)

SELECT @user_id_string=CAST(@user_id as varchar(9))
SELECT @rval=LEFT('000000000',9-len(@user_id_string))+@user_id_string

RETURN @rval
END 
```

视图的基本语法是：

```
ALTER VIEW [dbo].[v_users]
AS
SELECT     
dbo.udf_AUID(dbo.users.user_id) AS auid, 
user_id, 
dbo.users.username 
FROM dbo.users 
```

存储过程中的示例调用如下所示：

```
DECLARE @auid CHAR(9)
SET @auid = '000002444'  --normally passed in, but set here for example
SELECT dealer_range FROM users WHERE auid = @auid

DECLARE @cat_access TINYINT, @mit_access TINYINT
SELECT @cat_access = chan_access & 1, @mit_access = chan_access & 2 
    FROM appian.dbo.v_users
WHERE auid = @auid 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T22:33:07.777

你有什么理由不能一开始就以这种方式存储用户标识？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T22:39:20.387

您可以使用两个功能来帮助您：[RIGHT](http://msdn.microsoft.com/en-us/library/ms177532.aspx)和[REPLICATE](http://msdn.microsoft.com/en-us/library/ms174383.aspx)

```
SELECT RIGHT(REPLICATE('0', 9) + '123456789', 9)    -- Result: 123456789
SELECT RIGHT(REPLICATE('0', 9) + '255', 9)          -- Result: 000000255
SELECT RIGHT(REPLICATE('0', 9) + '12', 9)           -- Result: 000000012
SELECT RIGHT(REPLICATE('0', 9) + '1', 9)            -- Result: 000000001 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T22:38:09.610

```
RIGHT('000000000' + CAST(@user_id as varchar(9)), 9) 
```

这样，您就不会进行多次演员表，也不必担心 LEN。

# jquery - 如何最好地在 .NET 服务器代码和 JavaScript 客户端代码之间共享逻辑类型？

> ID：918335
> 
> 赞同：0
> 
> 时间：2009-05-27T22:37:57.190
> 
> 标签：jquery, asp.net-mvc, marshalling

我有一个使用 jquery 的 ASP.NET MVC 服务器应用程序和客户端代码。我想使用 ajax 将对象从客户端传输到服务器并返回。在服务器上，我基本上只是验证和序列化它们。在客户端，我有一些 UI 代码来创建视觉表示和一些其他代码来管理一些对象属性。

我的问题是：对我来说，整理这些物体的最佳方式是什么？我目前的想法只是从我的控制器操作中传回一个包装为 JsonResult 的对象，但我不确定在客户端完成处理后将对象传回 MVC 世界的最佳方式。我可以构建一个 JSON 字符串并将其作为控制器操作的字符串参数传递回 MVC，我必须手动将 JSON 解压缩为 .NET 类型。有没有办法更自动地映射到 .NET 类型，或者其他一些可以帮助防止此处出现错误的“便利”机制（即使我必须编写那个便利机制）？

这似乎与 ModelBinder 的想法非常相似，也许我只是被我打算使用 jquery 将 JSON 推送回服务器而不是拥有“常规”表单帖子的想法所迷惑。我可以以某种方式使用 ModelBinder 将客户端提供的 JSON 转换为 .NET 端的快乐模型类型吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T23:03:00.340

您不必手动将 JSON 解压缩为 .NET 类型。您有各种库可以为您执行此操作。我个人更喜欢[JSON.NET](http://james.newtonking.com/projects/json-net.aspx)。你所要做的就是这样的：

```
var deserializedObject = JsonConvert.DeserializeObject<ObjectType>(json); 
```

如果您不想依赖第三方库，只需使用 Microsoft 的 JavaScriptSerializer：

```
var serializer = new System.Web.Script.Serialization.JavaScriptSerializer();
var deserializedObject = serializer.Deserialize<ObjectType>(json); 
```

[微软的 JavaScriptSerializer 文档](http://www.asp.net/AJAX/Documentation/Live/mref/T_System_Web_Script_Serialization_JavaScriptSerializer.aspx)

# c# - 单元测试私有 Setter 问题 (C#)

> ID：918341
> 
> 赞同：9
> 
> 时间：2009-05-27T22:38:58.233
> 
> 标签：c#, unit-testing, tdd

我正在尝试测试一个名为 AddItem 的 Order 实体方法，并且我正在尝试确保无法添加重复的项目。这是一些示例代码：

```
[Test]
public void ItemCannotBeAddedTwiceToOrder()
{
    Order o = new Order();
    Item i = new Item("Bike");

    o.AddItem(i);
    o.AddItem(i);

    Assert.AreEqual(o.ItemCount, 1, "A duplicate item was added.");
}

public void AddItem(Item newItem)
{
    if(!CheckForDuplicateItem(newItem))
       _items.Add(newItem);
}

public bool CheckForDuplicateItem(Item newItem)
{
    foreach(Item i in _items)
    {
        if(i.Id == newItem.Id)
          return true;
    }

    return false;
} 
```

所以这是我的问题：如何在测试方法中设置新项目的私有设置器 ID，以便 CheckForDuplicateItem 方法可以工作？我想我不想因为良好的编码实践而公开该成员。我只是愚蠢并且需要使实体 Item 具有公共 Id 设置器吗？还是我需要使用反射？谢谢

注意 - 我使用 NHibernate 进行持久化

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T22:41:57.697

我通常为此使用反射。像这样的东西会起作用：

```
typeof(Item).GetProperty(nameof(Item.Id)).SetValue(i, 1, null); 
```

其中 1 是您要为 newItem 实例设置的 id。

根据我的经验，您很少需要设置 Id，因此最好将 setter 保留为私有。在少数情况下，您确实需要为测试目的设置 Id，只需使用反射。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T22:57:27.823

由于您正在检查 Order 的行为，因此您可以使用模拟对象作为其项目。使用模拟对象，您可以定义模拟对象将要发生的事情的断言并测试它们。在这种情况下，您可以为每个项目定义两个模拟对象，并期望它们的 id getter 将被调用并返回一个唯一值。然后您可以测试 Order 行为并检查是否按预期调用了 item 的 id getter . 我推荐使用Ayende 的[Rhino Mocks](http://ayende.com/projects/rhino-mocks.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-09-03T18:00:22.233

虽然 Praveen 的答案是正确的，并且毫无疑问适用于单一用途，但它错过了一些类型安全性，以便在强域模型的测试中一遍又一遍地使用它。因此，我将它包装在一个扩展方法中，该方法允许您通过这种类型安全的调用来设置一个值：

```
var classWithPrivateSetters= new ClassWithPrivateSetters();
classWithPrivateSetters.SetPrivate(cwps => cwps.Number, 42); 
```

把它放到你的测试程序集中，你就可以开始了

```
public static class PrivateSetterCaller
{
    public static void SetPrivate<T,TValue>(this T instance, Expression<Func<T,TValue>> propertyExpression, TValue value)
    {
        instance.GetType().GetProperty(GetName(propertyExpression)).SetValue(instance, value, null);
    }

    private static string GetName<T, TValue>(Expression<Func<T, TValue>> exp)
    {
        MemberExpression body = exp.Body as MemberExpression;

        if (body == null)
        {
            UnaryExpression ubody = (UnaryExpression)exp.Body;
            body = ubody.Operand as MemberExpression;
        }

        return body.Member.Name;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T23:04:50.787

另一种解决方案是通过从类派生并在派生类中公开成员来使私有成员可访问。这对于测试来说是相当大的开销，并且 Visual Studio 仅[内置支持私有方法](http://msdn.microsoft.com/en-us/library/ms184796(VS.80).aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T17:51:58.573

我想你可能会错过这里的重点。您是否因为不想多次调用数据库而避免多次添加？我认为 NHibernate 免费为您提供。或者，您应该使用 Set 吗？可能会或可能不会添加项目对调用者有什么影响？

如果没有持久性问题，您可以添加两个具有相同 ID 的不同项目并确认您只有第一个。必须有某种方法来检测订单中的哪些项目，否则添加它们将毫无意义......

# c# - 如何在匿名方法中释放/处置/销毁捕获的变量？

> ID：918342
> 
> 赞同：1
> 
> 时间：2009-05-27T22:38:59.543
> 
> 标签：c#, com, dispose, anonymous-methods

我正在使用匿名方法来处理 COM 对象中的事件。一旦程序终止，我在匿名方法中使用的资源似乎没有被“正确关闭”，因为我看到的每个资源都会出现第一次机会异常 (InvalidComObjectException)。我想这没什么大不了的，但感觉并不“正确”。

我无法理解在匿名方法范围之外访问那些捕获的变量的方法（无论如何，你不应该这样做）。如何在退出应用程序之前关闭/处置资源？

编辑：经过简短的重新阅读后，我可能不清楚我在这里做什么。我正在编写一个使用 COM 对象的托管应用程序。

进一步编辑：我正在使用[ArcGIS Engine](http://www.esri.com/software/arcgis/arcgisengine/index.html)来操作 GIS 数据。在这种特殊情况下，我使用 ILayerEvents_Event 中的 VisibilityChanged 事件来监视 GIS 图层何时可见或不可见。该事件仅传递一个布尔值（可见或不可见）而不是图层名称，因此需要为每个图层创建一个方法来创建其可见性状态更改。由于我正在处理动态层，因此我需要一种以某种方式动态执行此操作的方法，因此需要匿名方法。

在 anonymoua 方法中，我有一个 ILayer 变量，它从外部循环（在 ILayer 上下文中）获取 ILayerEvents_Event，以便我知道我正在使用哪个层。正是在这一点上，我被困住了。在我退出应用程序之前，该功能正常工作，一切都很好，让这 20 多个引用挂在那里，无处可去，只有一个例外。

我不知道用户何时会最后一次隐藏/显示图层，因此无法在最后一次将内容归零。我想我可以保持原样（或者，也许有比匿名方法更好的方法），因为它似乎没有伤害任何东西。我只是觉得我错过了一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T22:50:40.660

尝试在 C# 中使用不安全模式，在堆上创建内容并在完成后将其删除。另一个想法是将资源的引用存储在匿名方法之外的变量中，并在程序终止时正确关闭它们。再说一次，您可能需要的只是调用 Dispose()。

多一点信息会有所帮助。什么时候抛出异常？资源和“正确关闭”是什么意思。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T22:43:36.867

如果您真的想要，您需要挂钩应用程序退出事件。但是，我认为做得比这更好。

你用匿名方法做什么？你能算出最后一次使用它的时间，然后处理COM对象吗？你可以让匿名方法获取 COM 对象*并*在同一个块中处理它们吗？

如您所见，魔鬼在细节中:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T23:04:59.553

从您如何描述它不太可能知道这一点，但也许您有一个持有对 C# 对象的引用的 COM 对象，因为这些对象上的方法被登记为 COM 对象上公开的事件的事件处理程序，当 COM 对象不再使用时，它会被最终确定。假设 COM 对象是基于“公寓”的，这意味着消息将从终结器线程发送到创建 COM 对象的线程的 Windows 消息队列，请求在 COM 对象上调用 Release。此时，COM 对象可能会在实现任何登记事件处理程序的 C# 对象上调用 Release。当应用程序的最后一个托管代码完成运行时，这一切都可能发生，因此 CLR 正处于尝试卸载自身的过程中。可能在关闭期间，CLR 必须通过允许在对象的引用计数降至零之前收集对象或将其置于无效状态来应对任何可能的引用计数泄漏。所以这可能（纯粹的猜想）解释了你所看到的。

如果是这样，您需要在您自己选择的时间关闭 COM 对象。解决方案是在一个循环中调用`Marshal.ReleaseComObject`，直到它在 COM 对象上返回零，作为应用程序正常关闭的一部分。

[http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.releasecomobject(VS.71).aspx](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.releasecomobject(VS.71).aspx)

**更新，基于更新的问题：**

好的，所以您有一些由匿名方法闭包引用的 COM 对象。这些 COM 对象唯一会发生的事情是 Release 将在它们上被调用。如果这引起了问题，很可能是由于它们已经处于无效状态。

因此，我建议当您创建一组包含对 COM 对象的引用的匿名方法闭包时，您还应该将这些 COM 对象添加到单独的列表中。这将允许您`Marshal.ReleaseComObject`在丢弃整个系统时调用它们。

# c# - C# Alpha Blend 透明图片框

> ID：918353
> 
> 赞同：2
> 
> 时间：2009-05-27T22:45:16.240
> 
> 标签：c#, transparency, alphablending

我的表单上显示了一个网络摄像头提要，并想在其上绘图。我打算使用图片框来做到这一点，我发现 PictureBox 不支持真正的透明度，而只是它所在表单的颜色。它也不支持字母混合，这是我希望它显示的方式，类似于表单的显示方式。

有谁知道如何做到这一点？或者有一个可以做到这一点的控件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T17:31:34.830

Windows 窗体中的透明度有点破损。正如您所发现的，它并不真正支持重叠控件。它只是通过透明部分显示表单的背景颜色。[正如Bob Powell](https://web.archive.org/web/20141227200000/http://bobpowell.net/transcontrols.aspx)的这篇文章所展示的，通过一些 Windows API 魔法，您可以使许多控件显示为真正透明并支持重叠。我已经能够使他的技术适用于标签和自定义控件，但我想我已经尝试使它适用于`PictureBox`令人失望的结果。一种解决方法是尝试创建一个手动绘制图像的自定义控件；我没试过。 [这是一个论坛帖子](http://www.xtremevbtalk.com/showthread.php?t=288178)我在其中演示了一个支持真正透明度的自定义控件（我在那个论坛上的句柄是 AtmaWeapon。）我的记忆似乎表明这对自定义控件最有效，因为 Microsoft 的控件在呈现时会发生一些明显的魔力。

或者，您可以使用 WPF 而不是 WinForms 来实现您的应用程序。WPF 的透明度工作并支持重叠控件。这是您如何开发应用程序的一个相当大的转变，但它从一开始就有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T07:54:09.080

在大多数情况下，OwenP 使用 Bob Powell 在 transcontrols 中演示的方法执行此操作的答案[将](https://web.archive.org/web/20141227200000/http://bobpowell.net/transcontrols.aspx)起作用。但是，因为它是网络摄像头的直接绘图界面，所以实时源似乎总是在其他控件之上。

为了解决这个问题，我做了一点小技巧，并创建了一个在视频源上打开的辅助表单——它没有边框，设置为始终在顶部，并且具有透明度——我直接在这个表单上绘图。然后，我只需要在这个辅助表单中处理一些事件，以将注意力集中在原始表单上，并在另一个程序正在使用时进行处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T17:24:13.177

您可以将 PictureBox 放在另一个单独的表单上，并使用 Windows 样式类别中的表单不透明度值。那行得通吗？

# asp.net-mvc - MVC 错误问题

> ID：918358
> 
> 赞同：1
> 
> 时间：2009-05-27T22:48:12.350
> 
> 标签：asp.net-mvc, gac

“/”应用程序中的服务器错误。

* * *

解析器错误描述：解析服务此请求所需的资源时发生错误。请查看以下特定的解析错误详细信息并适当地修改您的源文件。

解析器错误消息：'System.Web.Mvc.ViewMasterPage' 类型不明确：它可能来自程序集 'C:\Windows\assembly\GAC_MSIL\System.Web.Mvc\1.0.0.0__31bf3856ad364e35\System.Web.Mvc。 dll' 或来自程序集 'C:\Projects\Samples\JQuery\bin\JQuery.DLL'。请在类型名称中明确指定程序集。

源错误：

第 1 行：<%@ Master Language="C#" 第 2 行：Inherits="System.Web.Mvc.ViewMasterPage" 第 3 行：EnableTheming="true" %>

源文件：/Views/Shared/Site.Master 行：1

* * *

版本信息：Microsoft .NET Framework 版本：2.0.50727.4918；ASP.NET 版本：2.0.50727.4918

也许我只是对为什么这会突然出现在我身上感到困惑。我已经在这个测试应用程序上工作了 2 天了，然后按 F5 和 wham...</p>

-kb

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-24T21:10:55.090

我希望它对您有所帮助，在解决方案资源管理器中，右键单击解决方案文件/属性/配置属性，并检查解决方案中每个项目的蓝色选项，然后单击确定按钮并重新编译所有解决方案，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-21T17:26:12.817

用于构建的临时目录持有另一个程序集。删除临时构建目录并重建后，此错误消失了。

# java - 我的 python 程序比我的同一程序的 java 版本执行得更快。是什么赋予了？

> ID：918359
> 
> 赞同：15
> 
> 时间：2009-05-27T22:48:42.427
> 
> 标签：java, python, microbenchmark

**更新：2009-05-29**

感谢所有的建议和建议。 **我使用您的建议使我的生产代码的平均执行速度比几天前的最佳结果快 2.5 倍。** 最后，我能够使 java 代码最快。

教训：

*   我下面的示例代码显示了原始整数的插入，但生产代码实际上是存储字符串（我的错）。当我更正 python 执行时间从 2.8 秒变为 9.6 时。所以马上，java 在存储对象时实际上更快。

*   但它并不止于此。我一直在执行java程序，如下所示：

    java -Xmx1024m 速度测试

但是，如果您将初始堆大小设置如下，您将获得巨大的改进：

```
java -Xms1024m -Xmx1024m SpeedTest 
```

这个简单的更改将执行时间减少了 50% 以上。所以我的 SpeedTest 的最终结果是 python 9.6 秒。Java 6.5 秒。

**原始问题：**

我有以下python代码：

```
import time
import sys

def main(args):    
    iterations = 10000000
    counts = set()
    startTime = time.time();    
    for i in range(0, iterations):
        counts.add(i)
    totalTime = time.time() - startTime
    print 'total time =',totalTime
    print len(counts)

if __name__ == "__main__":
    main(sys.argv) 
```

它在我的机器上执行了大约 3.3 秒，但我想让它更快，所以我决定用 java 编程。我假设因为 java 是编译的并且通常被认为比 python 快，所以我会看到一些巨大的回报。

这是java代码：

```
import java.util.*;
class SpeedTest
{    
    public static void main(String[] args)
    {        
        long startTime;
        long totalTime;
        int iterations = 10000000;
        HashSet counts = new HashSet((2*iterations), 0.75f);

        startTime = System.currentTimeMillis();
        for(int i=0; i<iterations; i++)
        {
            counts.add(i);
        }
        totalTime = System.currentTimeMillis() - startTime;
        System.out.println("TOTAL TIME = "+( totalTime/1000f) );
        System.out.println(counts.size());
    }
} 
```

所以这个java代码和python代码做的事情基本上是一样的。但它在 8.3 秒而不是 3.3 秒内执行。

我从一个真实的例子中提取了这个简单的例子来简化事情。关键元素是我有（set 或 hashSet）最终有很多成员，就像这个例子一样。

以下是我的问题：

1.  为什么我的 python 实现比我的 java 实现快？

2.  有没有比 hashSet (java) 更好的数据结构来保存唯一的集合？

3.  什么会使 python 实现更快？

4.  什么会使java实现更快？

更新：

感谢所有迄今为止做出贡献的人。请允许我添加一些细节。

我没有包含我的生产代码，因为它非常复杂。并且会产生很多干扰。我上面介绍的案例是最简单的。我的意思是java put调用似乎比python set`s add()慢得多。

生产代码的 java 实现也比 python 版本慢 2.5 - 3 倍——就像上面一样。

我不关心 vm 预热或启动开销。我只想比较从我的 startTime 到我的 totalTime 的代码。请不要为其他事情操心。

我用足够多的桶初始化了哈希集，这样它就不必重新哈希了。（我总是会提前知道集合最终将包含多少元素。）我想有人可能会争辩说我应该将它初始化为迭代次数/0.75。但是，如果您尝试一下，您会发现执行时间并没有受到显着影响。

我为那些好奇的人设置了 Xmx1024m（我的机器有 4GB 的内存）。

我正在使用 java 版本：Java(TM) SE Runtime Environment (build 1.6.0_13-b03)。

在生产版本中，我在 hashSet 中存储了一个字符串（2-15 个字符），因此我不能使用原语，尽管这是一个有趣的案例。

我已经多次运行代码。我非常相信 python 代码比 java 代码快 2.5 到 3 倍。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-28T09:26:11.660

您并没有真正测试 Java 与 Python，而是`java.util.HashSet`使用自动装箱整数与 Python 的本机集合和整数处理进行测试。

显然，这个特定微基准测试中的 Python 端确实更快。

我尝试用`TIntHashSet`来自[GNU trove](http://trove4j.sourceforge.net/)的 HashSet 替换，并实现了 3 到 4 之间的加速因子，使 Java 略微领先于 Python。

真正的问题是您的示例代码是否真的像您想象的那样代表您的应用程序代码。您是否运行了分析器并确定大部分 CPU 时间都花在了将大量整数放入 HashSet 中？如果不是，则示例无关紧要。即使唯一的区别是您的生产代码存储了除 int 之外的其他对象，它们的创建和哈希码的计算也很容易支配集合插入（并完全破坏 Python 在专门处理 int 方面的优势），使整个问题变得毫无意义。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-28T08:46:54.967

我怀疑这是 Python 使用整数值本身作为其哈希值，而基于哈希表的 set 实现直接使用该值。从[源](http://svn.python.org/view/python/trunk/Objects/dictobject.c?revision=72958&view=markup)中的评论：

> 这不一定是坏事！相反，在大小为 2**i 的表中，将低位 i 位作为初始表索引非常快，并且对于由连续范围的 int 索引的 dicts 完全没有冲突。当键是“连续的”字符串时，情况大致相同。因此，这在常见情况下提供了优于随机的行为，这是非常可取的。

这个微基准测试在某种程度上是 Python 的最佳案例，因为它会导致零散列冲突。然而，如果 Java 的 HashSet 正在重新散列密钥，它必须执行额外的工作，并且还会因冲突而变得更糟糕。

如果您将范围（迭代）存储在一个临时变量中并在循环之前对其执行 random.shuffle ，即使在循环之外完成随机播放和列表创建，运行时也会慢 2 倍以上。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-27T23:04:37.917

根据我的经验，python 程序比 java 程序运行得更快，尽管 java 是一个有点“低级”的语言。顺便说一句，这两种语言都被编译成字节码（这就是那些 .pyc 文件的内容——你可以把它们想象成类似于 .class 文件）。两种语言都是在虚拟堆栈机器上解释的字节码。

您会期望 python 在诸如`a.b`. 在 java 中，这`a.b`将解析为取消引用。另一方面，Python 必须进行一个或多个哈希表查找：检查本地范围、检查模块范围、检查全局范围、检查内置函数。

另一方面，java 在某些操作方面出了名的糟糕，例如对象创建（这可能是您示例中的罪魁祸首）和序列化。

总之，没有简单的答案。对于所有代码示例，我不希望任何一种语言都更快。

*更正：有几个人指出，java 在对象创建方面不再那么糟糕了。因此，在您的示例中，这是另一回事。也许它的自动装箱很昂贵，也许在这种情况下python的默认散列算法更好。在我的实践经验中，当我将 java 代码重写为 python 时，我总是看到性能提升，但这可能是由于语言的原因，因为重写通常会导致性能提升。*

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-27T23:06:52.827

另一种可能的解释是 Python 中的集合是在 C 代码中本地实现的，而 Java 中的 HashSet 是在 Java 本身中实现的。因此，Python 中的集合本质上应该更快。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-28T09:53:03.367

我想消除我在答案中看到的几个神话：

是的，Java 被编译为字节码，但在大多数运行时环境中最终编译为本机代码。说 C 本质上更快的人并没有说出全部故事，我可以证明字节编译语言本质上更快，因为 JIT 编译器可以进行机器特定的优化，而这些优化对于提前编译器是不可用的。

可能产生差异的一些因素是：

*   Python 的哈希表和集合是 Python 中优化程度最高的对象，Python 的哈希函数旨在为类似的输入返回类似的结果：对整数进行哈希处理只返回整数，保证您永远不会在连续的哈希表中看到冲突Python 中的整数。
*   上述的第二个效果是 Python 代码将具有较高的引用局部性，因为您将按顺序访问哈希表。
*   当您将整数添加到集合中时，Java 会对整数进行一些精美的装箱和拆箱。在好处方面，这使得 Java 中的算术方式比 Python 更快（只要你远离 bignums），但不利的一面是它意味着比你习惯的分配更多。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-27T23:33:12.947

**编辑：对于实际用例，TreeSet 可能更快，具体取决于分配模式。我在下面的评论仅涉及这种简化的场景。但是，我不相信这会产生非常显着的差异。真正的问题在别处。**

这里有几个人建议用 TreeSet 替换 HashSet。对我来说，这听起来像是一个非常奇怪的建议，因为插入时间为 O(log n) 的数据结构不可能比预先分配足够的桶来存储所有元素的 O(1) 结构更快。

这是一些对此进行基准测试的代码：

```
import java.util.*;
class SpeedTest
{    
    public static void main(String[] args)
    {        
        long startTime;
        long totalTime;
        int iterations = 10000000;
        Set counts;

        System.out.println("HashSet:");
        counts = new HashSet((2*iterations), 0.75f);
        startTime = System.currentTimeMillis();
        for(int i=0; i<iterations; i++) {
            counts.add(i);
        }
        totalTime = System.currentTimeMillis() - startTime;
        System.out.println("TOTAL TIME = "+( totalTime/1000f) );
        System.out.println(counts.size());

        counts.clear();

        System.out.println("TreeSet:");
        counts = new TreeSet();
        startTime = System.currentTimeMillis();
        for(int i=0; i<iterations; i++) {
            counts.add(i);
        }
        totalTime = System.currentTimeMillis() - startTime;
        System.out.println("TOTAL TIME = "+( totalTime/1000f) );
        System.out.println(counts.size());
    }
} 
```

这是我机器上的结果：

```
$ java -Xmx1024M SpeedTest
HashSet:
TOTAL TIME = 4.436
10000000
TreeSet:
TOTAL TIME = 8.163
10000000 
```

一些人还认为，装箱不是性能问题，而且对象创建成本低廉。虽然对象创建确实很快，但它肯定不如原语快：

```
import java.util.*;
class SpeedTest2
{    
    public static void main(String[] args)
    {        
        long startTime;
        long totalTime;
        int iterations = 10000000;

        System.out.println("primitives:");
        startTime = System.currentTimeMillis();
        int[] primitive = new int[iterations];
        for (int i = 0; i < iterations; i++) {
            primitive[i] = i;
        }
        totalTime = System.currentTimeMillis() - startTime;
        System.out.println("TOTAL TIME = "+( totalTime/1000f) );

        System.out.println("primitives:");
        startTime = System.currentTimeMillis();
        Integer[] boxed = new Integer[iterations];
        for (int i = 0; i < iterations; i++) {
            boxed[i] = i;
        }
        totalTime = System.currentTimeMillis() - startTime;
        System.out.println("TOTAL TIME = "+( totalTime/1000f) );
    }
} 
```

结果：

```
$ java -Xmx1024M SpeedTest2
primitives:
TOTAL TIME = 0.058
primitives:
TOTAL TIME = 1.402 
```

此外，创建大量对象会导致垃圾收集器产生额外的开销。当您开始在内存中保存数以千万计的活动对象时，这变得很重要。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-27T23:20:36.293

我发现这样的基准毫无意义。我不解决看起来像测试用例的问题。这不是很有趣。

我更愿意看到使用 NumPy 和 JAMA 的有意义的线性代数解决方案的解决方案。也许我会尝试并报告结果。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-27T22:54:07.597

我对python不太熟悉，但我知道`HashSet`不能包含原语，所以当你说`counts.add(i)`有`i`自动装箱到`new Integer(i)`调用时。那可能是你的问题。

如果出于某种原因你真的需要一个介于 0 和某个大 n 之间的整数的“集合”，那么最好将其声明为“boolean[] set = new boolean[n]”。然后，您可以遍历数组并将集合中的项目标记为“真”，而不会产生创建 n 个整数包装器对象的开销。如果您想更进一步，您可以使用大小为 n/8 的 byte[] 并直接使用各个位。或者也许是 BigInteger。

编辑

停止投票我的答案。这是错的。

编辑

不，真的，它错了。如果我按照问题的建议进行操作，我会获得可比的性能，用 N 个整数填充集合。如果我用这个替换for循环的内容：

```
 Integer[] ints = new Integer[N];
    for (int i = 0; i < N; ++i) {
        ints[i] = i;
    } 
```

然后只需要2秒。如果您根本不存储整数，那么它需要不到 200 毫秒。强制分配 10000000 个 Integer 对象确实需要一些时间，但看起来大部分时间都花在了 HashSet put 操作中。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-27T23:21:41.503

这里有很多问题我想汇总一下。

首先，如果它是一个你只打算运行一次的程序，多花几秒钟有关系吗？

其次，这只是一个微基准。微基准对于比较性能毫无意义。

创业有很多问题。

Java 运行时比 Python 大得多，因此从磁盘加载需要更长的时间并占用更多内存，这在交换时可能很重要。

如果您还没有设置`-Xms`，您可能只是在运行 GC 来调整堆的大小。还不如在开始时正确调整堆大小。

Java 确实从解释开始然后编译。Sun 客户端 [C1] Hotspot 大约 1,500 次迭代，服务器 [C2] 大约 10,000 次。服务器热点最终会为您提供更好的性能，但会占用更多内存。我们可能会看到客户端 Hotspot 使用服务器来执行非常频繁的代码，以实现两全其美。但是，这通常不应该是几秒钟的问题。

**最重要的是，您可能会在每次迭代中创建两个对象。对于大多数代码，您不会为如此比例的执行创建这些微小的对象。TreeSet 在对象数上可能会更好，6u14 和 Harmony 会更好。**

Python 可能会通过在引用中存储小整数对象而不是实际拥有一个对象来获胜。这无疑是一个很好的优化。

许多基准测试的问题是您在一种方法中混合了许多不同的代码。你不会像那样写你关心的代码，对吗？那么，您为什么要尝试执行与您实际上想要快速运行的代码不同的性能测试呢？

更好的数据结构：类似的东西`BitSet`似乎是有道理的（尽管它有同步，这可能会或可能不会影响性能）。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-27T22:53:09.017

您需要多次运行它才能真正了解每次运行的“速度”。JVM 启动时间 [for one] 增加了 Java 版本的单次运行时间。

您还创建了一个初始容量较大的 HashSet，这意味着将使用许多可用插槽创建支持 HashMap，这与创建基本 Set 的 Python 不同。很难说这是否会阻碍，因为当你的 HashSet 增长时，它必须重新分配存储的对象。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-27T22:56:58.090

您是否在 jvm 中使用 -server 标志？没有它，您将无法测试性能。（在进行测试之前，您还必须预热 jvm。）

此外，您可能想使用`TreeSet<Integer>`. 从长远来看，HashSet 会变慢。

你使用的是哪个jvm？我希望是最新的。

**编辑**

当我说使用 TreeSet 时，我的意思是一般来说，不是为了这个基准。TreeSet 处理对象的非均匀散列的现实世界问题。如果您在 HashSet 的同一个 bin 中获得太多对象，您将执行大约 O(n)。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-05-28T09:30:18.170

如果您真的想将原始类型存储在一个集合中，并对其进行繁重的工作，请在 Java 中创建您自己的集合。通用类对于科学计算来说不够快。

正如 Ants Aasma 所提到的，Python 绕过散列并直接使用整数。Java 创建一个 Integer 对象（[autoboxing](http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html)），然后将其转换为 Object （在您的实现中）。该对象也必须经过哈希处理，才能在哈希集中使用。

为了有趣的比较，试试这个：

**爪哇**

```
import java.util.HashSet;
class SpeedTest
{ 
  public static class Element {
    private int m_i;
    public Element(int i) {
      m_i = i;
    }
  }

  public static void main(String[] args)
  {        
    long startTime;
    long totalTime;
    int iterations = 1000000;
    HashSet<Element> counts = new HashSet<Element>((int)(2*iterations), 0.75f);

    startTime = System.currentTimeMillis();
    for(int i=0; i<iterations; ++i)
    {
      counts.add(new Element(i));
    }
    totalTime = System.currentTimeMillis() - startTime;
    System.out.println("TOTAL TIME = "+( totalTime/1000f) );
    System.out.println(counts.size());
  }
} 
```

结果：

```
$java SpeedTest
TOTAL TIME = 3.028
1000000

$java -Xmx1G -Xms1G SpeedTest
TOTAL TIME = 0.578
1000000 
```

**Python**

```
#!/usr/bin/python
import time
import sys

class Element(object):
  def __init__(self, i):
    self.num = i

def main(args):    
    iterations = 1000000
    counts = set()
    startTime = time.time();    
    for i in range(0, iterations):
        counts.add(Element(i))
    totalTime = time.time() - startTime
    print 'total time =',totalTime
    print len(counts)

if __name__ == "__main__":
  main(sys.argv) 
```

结果：

```
$./speedtest.py 
total time = 20.6943161488
1000000 
```

'python 比 java 快' 怎么样？

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-28T01:53:24.287

Just a stab in the dark here, but some optimizations that Python is making that Java probably isn't:

*   The range() call in Python is creating all 10000000 integer objects at once, in optimized C code. Java must create an Integer object each iteration, which may be slower.
*   In Python, ints are immutable, so you can just store a reference to a global "42", for example, rather than allocating a slot for the object. I'm not sure how Java boxed Integer objects compare.
*   Many of the built-in Python algorithms and data structures are rather heavily optimized for special cases. For instance, the hash function for integers is, simply the identity function. If Java is using a more "clever" hash function, this could slow things down quite a bit. If most of your time is spent in data structure code, I wouldn't be surprised at all to see Python beat Java given the amount of effort that has been spent over the years hand-tuning the Python C implementation.

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-27T23:14:12.343

你用多少内存来启动 JVM？这取决于？当我使用 1 Gig RAM 的程序运行 JVM 时：

```
$ java -Xmx1024M -Xms1024M -classpath . SpeedTest 
TOTAL TIME = 5.682
10000000
$ python speedtest.py 
total time = 4.48310899734
10000000 
```

如果我以更少的内存运行 JVM，则需要更长的时间……更长的时间：

```
$ java -Xmx768M -Xms768M -classpath . SpeedTest 
TOTAL TIME = 6.706
10000000
$ java -Xmx600M -Xms600M -classpath . SpeedTest 
TOTAL TIME = 14.086
10000000 
```

我认为这`HashSet`是这个特定实例中的性能瓶颈。如果我`HashSet`用 a替换`LinkedList`，程序会变得更快。

最后——请注意，Java 程序最初是被解释的，只有那些被多次调用的方法才会被编译。因此，您可能将 Python 与 Java 的解释器进行比较，而不是编译器。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-06-02T13:53:25.490

一些用于更快 Python 的更改。

```
#!/usr/bin/python
import time
import sys

import psyco                 #<<<<  
psyco.full()

class Element(object):
    __slots__=["num"]        #<<<<
    def __init__(self, i):
        self.num = i

def main(args):    
    iterations = 1000000
    counts = set()
    startTime = time.time();
    for i in xrange(0, iterations):
        counts.add(Element(i))
    totalTime = time.time() - startTime
    print 'total time =',totalTime
    print len(counts)

if __name__ == "__main__":
  main(sys.argv) 
```

前

```
(env)~$ python speedTest.py
total time = 8.82906794548
1000000 
```

后

```
(env)~$ python speedTest.py
total time = 2.44039201736
1000000 
```

现在一些很好的旧作弊和...

```
#!/usr/bin/python
import time
import sys
import psyco

psyco.full()

class Element(object):
    __slots__=["num"]
    def __init__(self, i):
        self.num = i

def main(args):    
    iterations = 1000000
    counts = set()
    elements = [Element(i) for i in range(0, iterations)]
    startTime = time.time();
    for e in elements:
        counts.add(e)
    totalTime = time.time() - startTime
    print 'total time =',totalTime
    print len(counts)

if __name__ == "__main__":
  main(sys.argv)

(env)~$ python speedTest.py
total time = 0.526521921158
1000000 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-11-20T23:53:31.430

好吧，如果您要调整 Java 程序，那么您不妨也调整 Python 程序。

```
>>> import timeit
>>> timeit.Timer('x = set()\nfor i in range(10000000):\n    x.add(i)').repeat(3, 1)
[2.1174559593200684, 2.0019571781158447, 1.9973630905151367]
>>> timeit.Timer('x = set()\nfor i in xrange(10000000):\n    x.add(i)').repeat(3, 1)
[1.8742368221282959, 1.8714439868927002, 1.869229793548584]
>>> timeit.Timer('x = set(xrange(10000000))').repeat(3, 1)
[0.74582195281982422, 0.73061800003051758, 0.73396801948547363] 
```

只需使用`xrange`它就可以在我的机器上快 8% 左右。表达式`set(xrange(10000000))`构建完全相同的集合，但速度提高了**2.5 倍**（从 1.87 秒到 0.74 秒）。

我喜欢如何调整 Python 程序使其更短。:) 但是 Java 也可以做到这一点。众所周知，如果你想要 Java 中的一组密集的小整数，你不会使用哈希表。你用一个`java.util.BitSet`！

```
BitSet bits = new BitSet(iterations);

startTime = System.currentTimeMillis();
bits.set(0, iterations, true);
totalTime = System.currentTimeMillis() - startTime;
System.out.println("TOTAL TIME = "+( totalTime/1000f) );
System.out.println(bits.cardinality()); 
```

那应该相当快。不幸的是，我现在没有时间测试它。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-27T23:01:27.517

我同意 Gandalf 关于启动时间的观点。此外，您正在分配一个与您的 python 代码完全不同的巨大 HashSet。我想象如果你把它放在一个分析器下，很多时间会花在那里。此外，在这种尺寸下插入新元素确实会很慢。我会按照建议研究 TreeSet。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-28T01:59:17.143

您可能想看看您是否可以“启动” JIT 编译器来编译您感兴趣的代码部分，方法是预先将其作为函数运行一次并在之后短暂休眠。这可能允许 JVM 将函数编译为本机代码。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-27T23:24:43.493

最大的问题可能是给定的代码测量的是[墙上时间](http://en.wikipedia.org/wiki/Wall_time)——你的手表测量的是什么——但是为了比较代码运行时间应该测量的是[进程时间](http://en.wikipedia.org/wiki/Process_time)——CPU执行特定代码而不是其他代码所花费的时间任务。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-05-27T23:59:54.450

**只需添加**一些简单的额外功能，您就可以使 Java microbenchamrk 更快。

```
 HashSet counts = new HashSet((2*iterations), 0.75f); 
```

变成

```
 HashSet counts = new HashSet((2*iterations), 0.75f) {
        @Override public boolean add(Object element) { return false; }
    }; 
```

简单、快速并获得相同的结果。

# reporting-services - 如何让另一份报告成为报告服务的最后一页？

> ID：918360
> 
> 赞同：1
> 
> 时间：2009-05-27T22:50:08.663
> 
> 标签：reporting-services, reporting, ssrs-2008, subreport

我有 2 份报告需要一起打印。

*   第一个报告有一个**页眉和页脚，将在数据溢出时重复**（如有必要）。
*   最后一页，这是要发回的表单。

我基本上需要一种方法来打印最后一页，而不需要从第一个报告中重复页眉/页脚，并发送要在表单中使用的参数。

目前我有一个矩形，它在我的页脚之前放置一个分页符。在矩形内我有我的第二份报告（子报告）。我在最后一页上未选中打印页眉和页脚。

我可以把它缩小到 3 页（左上、右上和右下减去页眉/页脚）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T11:36:41.223

页眉和页脚有一个属性，称为 PrintOnLastPage

如果将其设置为 False，它将不会在报告的最后一页上打印页眉和页脚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-09T18:36:09.313

最近做了这个，这里是如何做到的。这个处理被严重缺乏特征的SSRS破坏了。首先，您不能在页脚中插入分页符。其次，为了打印最后一页，它不能在子报表中，因为子报表没有页眉或页脚。

因此，我最终找到的解决方案是将最后一页（在我的情况下是条款和条件表）与页眉和页脚（在各自的部分中）一起放在主报告的详细信息部分。然后添加应该出现在第一页的报告作为详细信息部分内的子报告，在最后一页上方，并用分页符与其分开，请记住，此报告中的任何页眉或页脚都不会显示（但将页眉和页脚复制/粘贴到新的“包装”报告中应该不会有太大问题）。

至于任何额外的白页，请检查您的页边距。如果您的报告比打印机支持的范围宽（包括边距），每页后都会出现一个空白页。我通常做的是设置顶部和左侧边距，并将右侧和底部边距设置为 0，然后从那里调整以使其居中。

微软真的应该咬紧牙关，对 SSRS 进行一些更新......与许多第三方报告包中的任何一个相比，Vanilla SSRS 多年来一直是一个低于标准的解决方案，没有充分的理由。仅仅通过浏览器管理报告文件是一件非常痛苦的事情，没有基于批处理的工具......

# bandwidth - if ($referer != "mysite.com") 不是防止其他网站硬链接我的图片或 swf 的好方法吗？

> ID：918363
> 
> 赞同：4
> 
> 时间：2009-05-27T22:52:38.690
> 
> 标签：bandwidth

有时，当浏览器查看 www.somesite.com/some_image.jpg 时，我会看到未提供图像——它会说您需要从页面中查看图像。

（比如用google的图片搜索，看一些结果的时候）

所以我认为他们的服务器正在使用类似的东西

```
# pseudo code
if ($referer not contain "mywebsite.com") then not serve the image / swf 
```

但这可能不是一个好方法，因为 HTTP_REFERER 不可靠？所以当引用信息丢失时，一些用户最终会看不到图像或 swf？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T22:56:34.640

它可能是可靠的，但有些防火墙将其剥离，所以你应该这样做

```
// psuedo code
if ($referer does not contain "example.com" and $referer is set and $referer is not equal to "") then do not serve image 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T23:01:17.860

如果您有权使用 .htaccess 文件，甚至更好，您可以执行以下操作：

```
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?example.com/.*$ [NC]
RewriteRule \.(gif|jpg|js|css|cur|png|jpeg)$ - [F] 
```

或者，如果您希望他们看到不同的图像，请执行以下操作：

```
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?example.com/.*$ [NC]
RewriteRule \.(gif|jpg)$ http://www.example.com/angryman.gif [R,L] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T23:04:13.987

就像另一种情况一样，我认为随便允许热链接引用者会更有趣，直到你得到一些每天推送数千个请求的小丑（没有任何真正的链接）。我所做的就是将图像重定向到***完全****不同的**东西***。**

 **想想山羊。只会更恶心。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T22:57:58.710

它并不完美，但如果它能够阻止 80% 的不知道如何破解referer 的观众抓取你的图像，那它可能总比没有好。您还应该将图像文件夹包含在随机命名的文件夹下，并定期重命名它们以防止直接链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T23:01:47.657

我会将这个数字升级到 99.something%。几乎所有人都不会拥有干扰引荐来源网址字符串的代理。

但是，是的，使用`wget`(et al) 设置引荐来源网址是微不足道的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T23:05:13.937

引用头只是文本，因此可以在http请求中伪造。正如之前的评论中所述，您应该照顾绝大多数人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T23:47:15.693

类似于亨利沃森，我在想

```
# pseudo code
if($referer not empty and $referer not contain "mywebsite.com") then don't serve it. 
```

仔细检查 3 种情况：
referer 为空 ==> 服务的
referer 不为空且包含“mywebsite.com”==> 服务
的referer 不为空且不包含“mywebsite.com”==> 未服务

那么进行硬链接的人很可能会发现以这种方式链接并立即更改它是行不通的。

# iphone - iPhone 调试转储

> ID：918372
> 
> 赞同：0
> 
> 时间：2009-05-27T22:57:42.847
> 
> 标签：iphone

我正在对 iPhone 上的应用程序进行单元测试，并且我正在尝试开发一种内置方法来记录用户为与我的应用程序交互而执行的特定操作。我希望这些数据以某种方式传回给我。最初，我有一种收集这些信息的方法，但我必须在身边。这是与 nc。

现在，我正在考虑格式化数据并将其作为电子邮件发送。

这纯粹是一个设计问题，但是有人对收集大量数据有其他建议吗？我曾想过将数据转储到 iPhone 文件系统中，并要求我的测试人员通过 SSH 礼貌地检索它们，但这需要所有测试设备都被越狱，这不是一个可行的解决方案。

我想出的最好的方法就是格式化这些数据，将其塞入电子邮件正文，然后将其发送到硬编码的电子邮件（我的）。

是否可以将此数据格式化为文件并作为附件发送？这也将是一个更方便的解决方案，因为它仅限于我的想法。

为了清楚起见，这个流程看起来像这样：

1.  分发测试版
2.  用户与 Beta 交互
3.  对于导致错误的每次使用，将数据转储为我的行业标准桌面应用程序可以读取的格式
4.  尝试通过使用收集的数据模拟算法来纠正 iPhone 上的这种行为

所以它不纯粹是为了使用分析，它纯粹是为了调试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T23:10:50.480

在 2.2 中从设备以这种方式发送电子邮件非常不方便。您只能使用 mailto: URL，不能使用附件。更糟糕的是，用户需要正确设置邮件。编写自己的 SMTP 客户端也好不到哪里去，尤其是考虑到 iPhone 臭名昭著的糟糕 DNS 库。

更好的解决方案是将信息发布到 Web 服务。非常简单，非常快，在后台运行。出于良好的品味，您当然必须获得用户许可才能执行此操作，但我们很幸运。

如果您尝试通过您的应用程序跟踪用户行为，我们可以直接在设备上使用 Google Analytics（分析）取得很好的效果。我们必须建立自己的系统来做到这一点，但这并不难。

# linq - 如何从实体框架导航属性创建 LINQ 表达式？

> ID：918373
> 
> 赞同：4
> 
> 时间：2009-05-27T22:57:53.720
> 
> 标签：linq, entity-framework, linq-to-entities, lambda

我有以下代码：

```
Expression<Func<Subscription, Service>> service2= subscription => (from relationship in subscription.ChildRelationships
    select relationship.SecondService).FirstOrDefault(); 
```

它创建了一个表达式，稍后我可以将其用作实体框架查询的一部分。我使用的实际代码有一个 where 子句，但为了便于阅读，我省略了它。这很好用，我可以在我用于测试的 LINQPad 中运行它。

如果我将代码更改为：

```
Expression<Func<Subscription, IQueryable<Service>>> service2= subscription => (from relationship in subscription.ChildRelationships
    select relationship.SecondService); 
```

它不再编译并出现以下错误：

> 无法将 lambda 表达式转换为委托类型“System.Func<Farmworks.Data.Subscription,System.Linq.IQueryable<Farmworks.Data.Service>>”，因为块中的某些返回类型不能隐式转换为委托返回类型

似乎是因为作为导航属性的 ChildRelationships 没有实现 IQueryable。它实际上是 EntityCollection 类型，它确实实现了 IEnumerable，但不适合创建与 EF 一起使用的表达式。

我想我理解为什么第二个代码块不起作用，并且想知道如何重写它以便它起作用。让我感到困惑的是为什么第一个代码块确实有效。它还使用 ChildRelationships 导航属性，但成为适用于 EF 的表达式没有任何问题。

任何人都可以解释一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T13:56:28.900

问题不在于 FirstOrDefault 以某种方式使 Expression 起作用；正如您所说，ChildRelationships 本身并没有实现 IQueryable。您可以根据需要以两种不同的方式解决这个问题。

您可以使用 IEnumerable.AsQueryable 方法。如果服务已经从上下文加载，这可能是最好的。

如果服务没有加载，您可以根据需要使用 Load 或 Include 方法在适当的时候加载它们，然后使用上面的解决方案。

如果您有对 ObjectContext 的引用，则可以使用 ObjectQuery，它确实实现了 IQueryable：

```
Expression<Func<Subscription, MyEntities, IQueryable<Service>>> service2 = 
    (subscription, context) => (
    from s in context.Subscriptions // here is the IQueryable
    where s.Id == subscription.Id
    from relationship in s.ChildRelationships
    select relationship.SecondService); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-13T19:40:01.187

你需要它是 IQueryable<Service> 吗？我认为 select 正在返回一个 IEnumerable<Service>。LINQ 直接在 IEnumerables 上运行，因此您可以将 service2 声明为 Expression<Func<Subscription, IEnumerable<Service>>>。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T23:27:28.497

我认为[`CompiledQuery`](http://msdn.microsoft.com/en-us/library/system.data.linq.compiledquery.aspx)在这种情况下课程可能会对您有所帮助：

```
Expression<Func<Subscription, IQueryable<Service>>> service2 = 
    CompiledQuery.Compile( 
        subscription => (
            from relationship in subscription.ChildRelationships
            select relationship.SecondService
        )
    ); 
```

# oop - 抽象类 vs. 接口 vs. mixins

> ID：918380
> 
> 赞同：83
> 
> 时间：2009-05-27T22:59:55.213
> 
> 标签：oop, interface, terminology, abstract-class, mixins

**有人可以向我解释一下抽象类**、**接口**和**mixins**之间的区别吗？我以前在我的代码中使用过每个，但我不知道技术差异。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2013-03-24T22:56:47.287

## 抽象类

抽象类是不被设计为实例化的类。抽象类可以没有实现、某些实现或全部实现。抽象类旨在允许其子类共享一个通用（默认）实现。抽象类的（伪编码）示例将是这样的

```
abstract class Shape {
    def abstract area();  // abstract (unimplemented method)
    def outline_width() = { return 1; }  // default implementation
} 
```

子类可能看起来像

```
class Rectangle extends Shape {
    int height = width = 5;
    def override area() = { return height * width; }  // implements abstract method
    // no need to override outline_width(), but may do so if needed
} 
```

可能的用途

```
def main() = {
    Shape[] shapes = { new Rectangle(), new Oval() };
    foreach (s in shapes) {
        print("area: " + s.area() + ", outline width: " + s.outline_width());
    }
} 
```

如果一个子类不覆盖未实现的方法，它也是一个抽象类。

## 界面

在一般计算机科学术语中，接口是暴露给客户端的程序部分。公共类和成员是接口的示例。

Java 和 C# 有一个特殊的`interface`关键字。这些或多或少是一个没有实现的抽象类。（关于常量、嵌套类、显式实现和访问修饰符有一些技巧，我不打算讨论。）虽然关于“无实现”的部分不再适合 Java，但它们添加了默认方法。`interface`关键字可以看作是接口概念的具体化。

回到形状示例

```
interface Shape {
    def area();  // implicitly abstract so no need for abstract keyword
    def outline_width();  // cannot implement any methods
}

class Rectangle implements Shape {
    int height = width = 5;
    def override area() = { return height * width; }
    def override outline_width() = { return 1; }  // every method in interface must be implemented
}

def main() = {
    Shape[] shapes = { new Rectangle(), new Oval() };
    foreach (s in shapes) {
        print("area: " + s.area() + ", outline width: " + s.outline_width());
    }
} 
```

Java 和 C# 不允许对具有实现的类进行多重继承，但它们确实允许多个接口实现。Java 和 C# 使用接口来解决在允许多重继承的语言中发现的[致命钻石问题](http://en.wikipedia.org/wiki/Diamond_problem#The_diamond_problem)（如果处理得当，这并不是那么致命）。

## 米信

mixin（有时称为特征）允许抽象类的多重继承。Mixin 没有多重继承所具有的可怕关联（由于 C++ 的疯狂），因此人们更愿意使用它们。它们具有完全相同的致命钻石死亡问题，但支持它们的语言具有比 C++ 更优雅的缓解方法，因此它们被认为更好。

Mixin 被誉为具有[行为重用](http://www.ibm.com/developerworks/java/library/j-scala04298/index.html#N101E3)、[更灵活](http://www.levinotik.com/2012/09/14/scala-abstract-classes-traits-and-self-types/)的接口和[更强大的](http://lalitpant.blogspot.com/2008/07/traits-in-scala-powerful-design-tool.html)接口的接口。您会注意到所有这些都包含术语`interface`，指的是 Java 和 C# 关键字。**Mixin 不是接口。**它们是多重继承。用一个更漂亮的名字。

*这并不是说 mixins 不好。多重继承也不错。C++ 解决多重继承的方式是每个人都在讨论的问题。*

到疲倦的、旧的 Shape 示例

```
mixin Shape {
    def abstract area();
    def outline_width() = { return 1; }
}

class Rectangle with Shape {
    int height = width = 5;
    def override area() = { return height * width; }
}

def main() = {
    Shape[] shapes = { new Rectangle(), new Oval() };
    foreach (s in shapes) {
        print("area: " + s.area() + ", outline width: " + s.outline_width());
    }
} 
```

您会注意到这与抽象类示例之间没有区别。

一个额外的花絮是 C# 从 3.0 版开始就支持 mixins。您可以使用接口上的扩展方法来做到这一点。这是具有真实（！）C＃代码混合样式的Shape示例

```
interface Shape
{
    int Area();
}

static class ShapeExtensions
{
    public static int OutlineWidth(this Shape s)
    {
        return 1;
    }
}

class Rectangle : Shape
{
    int height = 5;
    int width = 5;

    public int Area()
    {
        return height * width;
    }
}

class Program
{
    static void Main()
    {
        Shape[] shapes = new Shape[]{ new Rectangle(), new Oval() };
        foreach (var s in shapes)
        {
            Console.Write("area: " + s.Area() + ", outline width: " + s.OutlineWidth());
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-27T23:05:04.423

一般来说：

**接口**是指定操作的合约，但没有任何实现。一些语言（Java、C#）已经内置了对接口的支持，而在其他语言中，“接口”描述了一种约定，就像 C++ 中的纯虚拟类一样。

**抽象类**是一个类，它指定了至少一个没有实现的操作。抽象类还可以提供其实现的某些部分。同样，一些语言已经内置支持将类标记为抽象，而在其他语言中它是隐含的。例如，在 C++ 中，定义纯虚方法的类是抽象的。

**mixin**是一个类，它旨在使某些功能在子类中的实现更容易，但它并非旨在供其自身使用。例如，假设我们有一个用于处理请求的对象的接口

```
interface RequestHandler {
  void handleRequest(Request request);
} 
```

也许通过累积请求来缓冲请求直到我们有一些预定的数量然后刷新缓冲区是有用的。我们可以在不指定刷新行为的情况下使用**mixin**实现缓冲功能：

```
abstract class BufferedRequestHandlerMixin implements RequestHandler {
  List<Request> buffer = new List<Request>();

  void handleRequest(Request request) {
    buffer.add(request);

    if (buffer.size == BUFFER_FLUSH_SIZE) {
        flushBuffer(buffer);
        buffer.clear();
    }
  }

  abstract void flushBuffer(List<Request> buffer);
} 
```

这样，我们很容易编写一个请求处理程序，将请求写入磁盘、调用 Web 服务等，而无需每次都重写缓冲功能。这些请求处理程序可以简单地扩展`BufferedRequestHandlerMixin`和实现`flushBuffer`.

另一个很好的 mixin 示例是 Spring 中的众多支持类之一，即。[休眠道支持](http://static.springsource.org/spring/docs/2.5.1/api/org/springframework/orm/hibernate3/support/HibernateDaoSupport.html)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-07-29T09:39:41.430

对 Java 的引用和提供 mixin 的抽象类的示例具有误导性。首先，Java 默认不支持“mixins”。在 Java 术语中，抽象类和 Mixins 变得令人困惑。

mixin 是一个类除了它的“主要类型”之外还可以实现的类型，以表明它提供了一些可选的行为。用 Java 术语来说，一个例子是实现 Serializable 的业务价值对象。

Josh Bloch 说 - “抽象类不能用于定义 mixins - 因为一个类不能有多个父类”（记住 Java 只允许一个“扩展”候选者）

寻找像 Scala 和 Ruby 这样的语言来适当地实现“mixin”的概念

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-01-08T10:33:49.330

由于许多人已经解释了定义和用法，我只想强调重点

**界面：**

1.  定义合同（最好是无状态的——我的意思是没有变量）
2.  `has a`用“ ”能力链接不相关的类。
3.  声明公共常量变量（不可变状态）

***抽象类：***

1.  在几个密切相关的类之间共享代码。它建立了“ `is a`”关系。

2.  在相关类之间共享公共状态（可以在具体类中修改状态）

我用一个小例子来结束差异。

`Animal`可以是抽象类。`Cat`并且`Dog`，扩展这个抽象类建立“ `is a`”关系。

**猫** `is a`动物

**狗** `is a`动物。

**狗** `can`实现`Bark`接口。然后是狗`has a`的吠叫能力。

**Cat** `can`实现`Hunt`接口。然后猫`has a`的狩猎能力。

**Man**可以`not Animal`实现`Hunt`接口。然后男人`has a`的狩猎能力。

人和动物（猫/狗）是无关的。但是 Hunt 接口可以为不相关的实体提供相同的功能。

***混音：***

1.  如果你想要两者的`abstract class`混合`interface`。当你想在许多不相关的类上强制一个新的契约时特别有用，其中一些类必须重新定义新的行为，而其中一些应该坚持共同的实现。在 Mixin 中添加通用实现，并允许其他类在需要时重新定义合约方法

如果我想声明一个抽象类，我将遵循这两种方法之一。

1.  将所有抽象方法移至`interface`我的抽象类实现该接口。

    ```
    interface IHunt{
        public void doHunting();
    }
    abstract class Animal implements IHunt{

    }
    class Cat extends Animal{
        public void doHunting(){}
    } 
    ```

相关的 SE 问题：

[接口和抽象类有什么区别？](https://stackoverflow.com/questions/1913098/what-is-the-difference-between-an-interface-and-abstract-class/33957698#33957698)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-05-08T04:13:40.717

Joshua Bloch 在其有效的 Java 书籍中很好地定义了“混合”的含义。同一本书的摘录：

" *mixin 是一个类除了它的“主要类型”之外还可以实现的类型，以声明它提供了一些可选的行为。例如，Comparable 是一个 mixin 接口，它允许一个类声明它的实例相对于其他实例是有序的相互比较的对象。这样的接口称为 mixin，因为它允许可选功能“混入”到类型的主要功能中。* ”

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-27T23:01:37.610

基本上，抽象类是具有一些具体实现的接口。接口只是一个没有实现细节的合约。

如果您想在所有实现抽象类的对象中创建通用功能，您将使用抽象类。遵循 OOP 的 DRY（不要重复自己）原则。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T23:33:23.100

抽象类是一个并非所有成员都实现的类，它们留给继承者实现。它强制其继承者实现其抽象成员。抽象类不能被实例化，因此它们的构造函数不应该是公共的。]

这是 C# 中的一个示例：

```
 public abstract class Employee
    {
        protected Employee(){} 
        public abstract double CalculateSalary(WorkingInfo workingInfo);//no implementation each type of employee should define its salary calculation method.
    }

   public class PartTimeEmployee:Employee
  {
    private double _workingRate;
    public Employee(double workingRate)
    {
     _workingRate=workingRate;
    }
    public override double CalculateSalary(WorkingInfo workingInfo)
    {
      return workingInfo.Hours*_workingRate;
    } 
```

}

接口是一个类要实现的契约，它只是声明了实现类的成员的签名，它本身没有实现。我们通常使用接口来实现多态，以及解耦依赖的类。

这是 C# 中的一个示例：

```
public interface IShape
{
int X{get;}
int Y{get;}
void Draw();
}

public class Circle:IShape
{
public int X{get;set;}
public int Y{get;set;}

public void Draw()
{
//Draw a circle
}
}

public class Rectangle:IShape
{
public int X{get;set;}
public int Y{get;set;}

public void Draw()
{
//Draw a rectangle
}
} 
```

# c# - .NET 开发中的 Visual Studio 是否有真正的竞争者？

> ID：918388
> 
> 赞同：4
> 
> 时间：2009-05-27T23:02:32.977
> 
> 标签：c#, asp.net, visual-studio, ide

**编辑：**这篇文章最初是专门针对 ASP.NET 的，但经过思考后，我很想发现任何 .NET 开发的竞争者。

曾经有[sharpdevelop](http://www.icsharpcode.net/OpenSource/SD/) IDE，我什至不确定它是否支持ASP.NET（它支持WinForms）。我认为快递扼杀了它。

***编辑：**我对 SharpDevelop 的看法是错误的（感谢乔尔指出这一点）*

*为了我的辩护，我去查了一下，看到了一个看起来很旧的网站。我点击[新闻历史](http://www.icsharpcode.net/OpenSource/SD/NewsHistory.aspx)，最后一次更新是 2005 年，那是我最后一次查看它的时间！所以他们让我觉得它已经死了:)*

我喜欢 Visual Studio，它非常、非常强大——它经过几年的发展和成熟，背后的预算很大。

但我想知道是否有人以全新的视角了解任何事情？有没有被忽视的大型开源项目？

ps -1 对于任何说“记事本+命令提示符”的人！:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T23:05:51.423

[MonoDevelop](http://monodevelop.com/)是一个崭露头角的 IDE。它严格来说不是纯 ASPNET，但它对于*这么*新的东西来说非常好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T23:15:45.163

在撰写本文时，[SharpDevelop 3.1 beta 1](http://community.sharpdevelop.net/forums/t/9510.aspx)仅在 13 天前发布。对我来说听起来不是很死。事实上，如果您想要一个用于 Boo 编程语言的 IDE，它是 Windows 上的唯一选择。嘿，它甚至有一个内置的分析器！我可能需要检查一下，谢谢你提醒我再看一遍。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T23:41:12.447

+1 好问题乔希

我已经尝试过 Mono 的东西和 SharpDevelop，但我认为您的问题的答案可能只是**Visual Studio 2010**。

我理解离开微软围墙花园的愿望，我自己也感受到了，在那种情况下，你想在微软之外探索，那么当然有很多选择，但即使是那些也不像 Visual 那样完整Studio（我在想**Eclipse**、**XCode**、**Adobe Flash**环境等一些有趣的环境，玩起来很有趣）

但是在微软的世界里，我真的相信他们的发展态度是非常进步的，也是新鲜的。每次 Visual Studio 迭代都感觉很新鲜，不比 VS 2010 更新鲜，而且我认为目前 MS 世界中的其他替代品正​​在迎头赶上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T23:04:49.070

我不确定开源项目。但是，Microsoft 添加了支持 ASP.NET 开发的 Expression 系列应用程序。我认为最终目标是让开发团队和 ui 设计团队之间更好地集成……但是 Expression 工具非常好。（他们还在图形、silverlight 和 html 前端为 Adob​​e 产品提供了一些竞争……尽管还没有真正严重。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T23:06:07.260

您是仅限于 Windows 还是一般仅限于 ASP.NET？如果是后者，请查看[MonoDevelop](http://monodevelop.com/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T23:17:44.223

VS.NET Express 算不算？[http://www.microsoft.com/Express/](http://www.microsoft.com/Express/)。它也是 VS.NET，但更简单且免费。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T23:44:31.113

Embarcadero 不久前收购了 Borland 的工具部门，仍然发布 Delphi 和[CodeGear RAD Studio](http://www.embarcadero.com/products/rad_studio/)。

虽然它不是开源的，但它*确实*有预算和稍微不同的视角——以及用于 .NET 的不同语言选择。

# java - java中的interface和@interface有什么区别？

> ID：918393
> 
> 赞同：362
> 
> 时间：2009-05-27T23:03:31.773
> 
> 标签：java, interface, annotations, language-features

自从 90 年代后期在大学期间使用 JBuilder 后，我就没有接触过 Java，所以我有点脱节 - 无论如何，我本周一直在从事一个小型 Java 项目，并使用 Intellij IDEA 作为我的 IDE ，以改变我的常规 .Net 开发步伐。

我注意到它支持添加接口和@interface，什么是@interface，它与普通接口有什么不同？

```
public interface Test {
} 
```

对比

```
public @interface Test {
} 
```

我进行了一些搜索，但找不到大量有关@interface 的有用信息。

* * *

## 回答 #1

> 赞同：371
> 
> 时间：2009-05-27T23:10:24.800

*@*符号表示注释类型定义。

这意味着它**并不是**真正的接口，而是一种新的注解类型——用作函数修饰符，例如*@override*。

请参阅有关该主题的此[javadocs 条目](http://java.sun.com/j2se/1.5.0/docs/guide/language/annotations.html)。

* * *

## 回答 #2

> 赞同：130
> 
> 时间：2014-02-19T07:47:37.090

界面：

一般来说，一个接口暴露了一个契约而不暴露底层的实现细节。在面向对象编程中，接口定义了暴露行为但不包含逻辑的抽象类型。实现由实现接口的类或类型定义。

@interface : (注解类型)

以下面的例子为例，它有很多评论：

```
public class Generation3List extends Generation2List {

   // Author: John Doe
   // Date: 3/17/2002
   // Current revision: 6
   // Last modified: 4/12/2004
   // By: Jane Doe
   // Reviewers: Alice, Bill, Cindy

   // class code goes here

} 
```

取而代之的是，您可以声明一个注释类型

```
 @interface ClassPreamble {
   String author();
   String date();
   int currentRevision() default 1;
   String lastModified() default "N/A";
   String lastModifiedBy() default "N/A";
   // Note use of array
   String[] reviewers();
} 
```

然后可以如下注释一个类：

```
@ClassPreamble (
   author = "John Doe",
   date = "3/17/2002",
   currentRevision = 6,
   lastModified = "4/12/2004",
   lastModifiedBy = "Jane Doe",
   // Note array notation
   reviewers = {"Alice", "Bob", "Cindy"}
)
public class Generation3List extends Generation2List {

// class code goes here

} 
```

PS： **许多注释替换代码中的注释。**

参考：[http ://docs.oracle.com/javase/tutorial/java/annotations/declaring.html](http://docs.oracle.com/javase/tutorial/java/annotations/declaring.html)

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-05-27T23:16:15.833

`interface`关键字表示您在 Java 中声明一个传统的接口类。关键字用于声明一个新的注解类型
。`@interface`

有关语法的描述，请参阅有关注解的[docs.oracle 教程](http://docs.oracle.com/javase/tutorial/java/annotations/declaring.html)。如果您真的想了解详细信息，
请参阅[JLS](http://java.sun.com/docs/books/jls/third_edition/html/interfaces.html#9.6)`@interface`。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2017-09-05T07:49:40.153

`interface:` 定义实现它的类的契约

`@interface:`定义注解的契约

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2019-02-15T11:27:04.803

**Java 编程语言中的接口** 是一种抽象类型，用于指定类必须实现的行为。它们类似于协议。接口是使用 interface 关键字声明的

**@interface** 用于创建您自己的（自定义）Java 注释。注释在它们自己的文件中定义，就像 Java 类或接口一样。这是自定义 Java 注释示例：

```
@interface MyAnnotation {

    String   value();

    String   name();
    int      age();
    String[] newNames();

} 
```

这个例子定义了一个名为 MyAnnotation 的注解，它有四个元素。注意@interface 关键字。这向 Java 编译器发出信号，表明这是一个 Java 注释定义。

请注意，每个元素的定义类似于接口中的方法定义。它有一个数据类型和一个名称。您可以将所有原始数据类型用作元素数据类型。您还可以使用数组作为数据类型。您不能将复杂对象用作数据类型。

要使用上述注释，您可以使用如下代码：

```
@MyAnnotation(
    value="123",
    name="Jakob",
    age=37,
    newNames={"Jenkov", "Peterson"}
)
public class MyClass {

} 
```

参考 - [http://tutorials.jenkov.com/java/annotations.html](http://tutorials.jenkov.com/java/annotations.html)

# java - Axis 1.4：无法让 SOAP 请求工作

> ID：918395
> 
> 赞同：0
> 
> 时间：2009-05-27T23:04:15.813
> 
> 标签：java, axis

我真的很难让我的第一个 AXIS SOAP 客户端工作。我正在使用 Axis v1.4。

我们的 WSDL 包含以下内容：

```
....
<element name="GetParameters">
  <complexType>
    <sequence>
      <element name="param1" type="codeapi:SomeParam"/>
      <element name="param2" type="unsignedShort" minOccurs="0"/>
      <element name="param3" type="string" minOccurs="0"/>
      <element name="param4" type="unsignedShort" minOccurs="0"/>
      <element name="param5" type="unsignedShort" minOccurs="0"/>
      <element name="param6" type="string" minOccurs="0"/>
      <element name="param7" type="string" minOccurs="0"/>
      <element name="param8" type="string" minOccurs="0"/>
      <element name="param9" type="codeapi:AnotherParam" minOccurs="0"/>
    </sequence>
  </complexType>
</element>
.... 
```

我已经运行 wsdl2java 来生成代码。

--

我正在初始化端口：

```
SimpleProvider conf = new SimpleProvider(new BasicClientConfig());
conf.setGlobalRequest(new LoggingHandler(LOG, Level.FINE,
    "Request sent:\n"));
conf.setGlobalResponse(new LoggingHandler(LOG, Level.FINE,
    "Response received:\n"));

MyService = new MyServiceLocator(conf);

URL myServiceURL = "http://<removed>";

MyServicePort myServicePort = myService.getMyServiceSOAPPort(myServiceUrl); 
```

--

我第一次尝试访问请求：

```
SomeParam param1 = new SomeParam();
param1.setParamA("blah"); // this is the only needed parameter

Entry[] allEntries = myServicePort.getParameters(param1, null, null, null, null, null, null, null, null); 
```

这会导致 NullPointerException（在客户端），即使所有 null 参数都是可选的。

--

我的第二次尝试：

```
SomeParam param1 = new SomeParam();
param1.setParamA("blah");

Entry[] allEntries = myServicePort.listCodes(param1, new UnsignedShort(), new StringHolder(), new UnsignedShort(), new UnsignedShort(), new String(), new String(), new String(), new AnotherParam()); 
```

这不会导致任何异常，但会向 allEntries 返回空值，并且我不知道是否实际发送了 SOAP 请求（很可能没有）。

代码在 Oracle AS 之上运行。在任何一种情况下，Axis 都不会将一行调试信息写入日志，即使所有不同的调试类都已在 Oracle 中激活，并且 LoggingHandlers 已初始化。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T10:09:13.617

显然，如果一个参数是持有者类型的（即它的类是 *Holder），您需要创建一个持有者实例并将其作为参数值，即使该参数是可选的。否则，您将在生成的存根类中获得空指针异常。只是不要在支架内放任何东西。

# java - 如何在Java程序（J2EE + JSTL）中获取服务器文件夹的路径

> ID：918396
> 
> 赞同：3
> 
> 时间：2009-05-27T23:04:18.667
> 
> 标签：java, jakarta-ee

我想读取位于 Web 服务器文件夹内的基于 Web 的项目 (J2EE-JSP+Servlets) 中的 Excel 文件的内容。

我制作了一个 java 文件，我将使用 JSTL 库通过 JSP 页面调用该文件，但我需要在 Java 文件中获取 Excel 工作表的路径，以便我可以读取内容。

如何获取当前 Java 文件和 Excel 文件的路径？

另外，我将通过 POI 库读取 Excel 文件的内容。我能够在 J2SE 开发中做到这一点，但这里有可能吗？

```
POIFSFileSystem fs = null;
    try {
        fs = new POIFSFileSystem(new FileInputStream("**some path here of sheet**"));
    } catch (FileNotFoundException ex) {
        ex.printStackTrace();
    } catch (IOException ex) {
        ex.printStackTrace();
    }
    HSSFWorkbook wb = null;
    try {
        wb = new HSSFWorkbook(fs);
    } catch (IOException ex) {
        ex.printStackTrace();
    }
    HSSFSheet sheet = wb.getSheetAt(0);
    HSSFRow row;
    HSSFCell cell1,cell2,cell3; 

    int rows; // No of rows, stores the no. of rows for an excel sheet
    int cols; // No of columns, stores the no. of columns for an excel sheet

    rows = sheet.getPhysicalNumberOfRows();
    cols = 5;

    for(int r = 0; r < rows; r++) {
        row = sheet.getRow(r);

        if(row != null) {
            cell1 = row.getCell(1);
            cell2 = row.getCell(2);
            cell3 = row.getCell(4);

            //System.out.println(cell1.getStringCellValue()+" "+cell2.getStringCellValue()+" "+cell3.getStringCellValue());                
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T23:08:43.230

您可以要求 servlet 上下文相对于实际路径进行转换：

```
context.getRealPath("/"); 
```

如果您的 java 类是 servlet，您可能可以执行类似的操作

```
getServletConfig().getServletContext(); 
```

否则，jsp 页面是一个 servlet，因此您可以从那里传递它。

最后，您可以在启动应用程序时将其拾取一次：

```
public class AppStartup implements ServletContextListener {

    public void contextDestroyed(ServletContextEvent event) {
    }

    public void contextInitialized(ServletContextEvent event) {
        ServletContext context = event.getServletContext();
        // remember it in some static class for future use
    }
} 
```

说了这么多，最好创建一个 servlet，它有他的 servlet 上下文、解析路径，并用解析的文件路径调用你的类，然后最后将请求转发到 jsp 页面以显示结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T23:41:52.867

在一个基本的 JSP/Servlet 应用程序中，您将有一个支持 servlet，它将执行程序中的几乎所有逻辑，将模型*推*送到请求中，然后将用户重定向到 JSP 页面，该页面将从请求中*提取*模型并将仅对其进行格式化（如果需要，可以使用 JSTL）。如果您的方法需要使用 Excel 文件执行某种处理，它应该位于扩展 javax.servlet.http.HttpServlet 的类中，这样您就可以访问 ServletContext 及其方法

```
String physicalFolder = getContext().getRealPath("/"); 
```

如果您不想遵循这种方法并且仍然希望使用 JSTL（我猜您正在使用*<jsp:useBean />*标记），您可以使用如下方式初始化一个 bean 属性来设置您的 webapp 的物理文件夹：

```
<jsp:useBean id="excelBean" scope="request" class="yourpackage.YourClass" >
    <jsp:setProperty name="physicalPath" value="<%= application.getRealPath("/") %>" />
</jsp:useBean> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T23:48:08.250

这是错误的做法。

您应该通过将其放入 WEB-INF/classes 并使用 getResourceAsStream 使用文件名从上下文路径获取 InputStream 来读取该文件。

试着看看[这个](http://www.xyzws.com/servletfaq/how-to-use-servletcontextgetresourceasstreamjavalangstring-path/18)例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T23:33:19.777

我怀疑如果您正在寻找服务器上的本地文件系统路径，那可能是不可能的。尽管某些 Web 应用程序服务器（我认为尤其是 Tomcat）确实有一个包含所有应用程序文件的文件夹，但还有其他一些直接从压缩的 WAR 文件运行应用程序。在这种情况下，您的 Excel 文件可能没有路径，因为它在存档中。

一种独立于您正在运行的应用程序服务器的解决方法是将 Excel 文件打包到其中一个 JAR 中`WEB-INF/lib`，然后使用

```
getClass().getResourceAsStream("/class/path/to/file.xls") 
```

代替

```
new FileInputStream("/local/filesystem/path/file.xls") 
```

使用 getResourceAsStream("...") 时，您需要提供类路径，而不是文件系统路径。因此，如果您将 Excel 文件打包在一个 JAR 中，在一个名为 的包中`com.yourcompany.files`，您需要使用

```
getClass().getResourceAsStream("/com/yourcompany/files/file.xls") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T00:23:58.897

我第二个 duffymo 和 Martin McNulty，您必须使用 getResourceAsStream 并放置您的 Excel 文件，这里是示例：

你的 webapp 结构是这样的，对吧？

```
- Application Root
 |
 +- WEB-INF
     |
     +- classes/  <--- This is added to CLASSPATH
     |
     +- lib/      <--- Its contents are added to CLASSPATH
     |
     +- web.xml 
```

在这种结构中，您的应用程序类路径与位于*lib*文件夹和*classes*文件夹中的 JAR 文件一致。当您使用 IDE 进行编译时，位于源文件夹中的文件将被编译，并且*.class*文件被复制到*类*文件夹中，如果文件不是 Java 文件，它们只是被复制到文件夹中，但仍然在类路径中。

所以，简单地说......**您可以在类路径中添加非类文件，例如您的 Excel 文件**，并将其组织到包中，就像它是一个类一样。

如果您将 Excel 文件放在类路径中，您将获得一个优势，即可以独立于您的 JAR 文件或 WAR 文件位置访问该文件，只需知道它在类路径中的位置即可。

方法*Class.getResourceAsStream(String path)*让您可以访问类路径中的文件，只需传递用斜杠替换点的路径，例如：

```
getClass().getResourceAsStream("/yourpackage/YourExcelFile.xsl"); 
```

将为您提供文件 YourExcelFile.xsl 的 InputStream ，该文件*位于 yourpackage*包*内*。

我已尽力向您解释这一点，但如果您有疑问，可以查看[方法文档](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Class.html#getResourceAsStream(java.lang.String))。

# javascript - 尝试 for( var i in window.external ) 时出现 IE 错误

> ID：918400
> 
> 赞同：2
> 
> 时间：2009-05-27T23:04:56.730
> 
> 标签：javascript

我正在使用 JavaScript 构建对象/属性转储。此代码在 Internet Explorer 8 下中断（假设主题 = window.external）

```
// Gather the property names into the keys array.
var keys = Array(); for( var i in subject ){ keys.push(i); }

/* After this I sort the keys, then loop through to get the 
   property values in subject
*/ 
```

如果您尝试将主题打印到控制台（或警报），它会出现空白。但是，其他对象将打印 [object SomethingMeaningful]。

Microsoft 的文档表明该对象肯定具有属性。能够展示它们而不是跳过它们会很好。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T23:22:17.680

你是这个意思吗？

```
var keys = Array(); for( var i in subject ){ keys.push(subject[i]); } 
```

您可以在 JavaScript 中使用类似数组的语法访问对象属性

**编辑**

感谢您的编辑。我不确定为什么这对`window.external`对象不起作用。它可能只有方法，没有属性。它是否可以在其他浏览器下工作，例如 Firefox？

# c++ - QDBusAbstractAdaptor 与 QDBusAbstractInterface

> ID：918405
> 
> 赞同：1
> 
> 时间：2009-05-27T23:06:00.940
> 
> 标签：c++, qt, qt4, dbus

当使用 Qt D-Bus 绑定向 D-Bus 公开一些代码时，什么时候应该使用 Qt 适配器而不是 Qt 接口？我很难理解它们到底有什么不同，因为它们似乎提供了相同的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T23:54:03.263

根据[http://doc.trolltech.com/4.3/qdbusabstractinterface.html](http://doc.trolltech.com/4.3/qdbusabstractinterface.html)，“QDBusAbstractInterface 类是 QtDBus 绑定中所有 D-Bus 接口的基类”，而根据[http://doc.trolltech.com/4.3 /qdbusabstractadaptor.html](http://doc.trolltech.com/4.3/qdbusabstractadaptor.html) , “QDBusAbstractAdaptor 类是所有旨在使用 D-Bus 向外部世界提供接口的对象的起点”。因此，前者用于接口本身，后者用于提供接口，即“将一些代码暴露给 D-Bus”，您将编写一个继承适配器的类并“定义它的 D-Bus 接口”正在使用类定义中的 Q_CLASSINFO 宏来实现”（也是上述 URL 中第二个的引用）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-09-27T07:26:41.917

消费者要使用`QDBusAbstractInterface`，而生产者要使用`QDBusAbstractAdaptor`。也就是适配器（生产者）实现一些方法，暴露一些属性，发送一些信号，而消费者调用/接收这些东西。

# vb.net - File.Encrypt 抛出“参数不正确”

> ID：918408
> 
> 赞同：0
> 
> 时间：2009-05-27T23:06:18.740
> 
> 标签：vb.net, file-io, permissions, encryption

当我尝试在现有文件上调用 System.IO.File.Encrypt() 时，它会引发通用 IOException，并且消息是“参数不正确”。

> System.IO.File.Encrypt("C:\Project\StorageDirectory\file.txt")

运行该进程的当前用户对“StorageDirectory”文件夹具有完全控制权。有什么我缺少权限的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T23:11:49.400

[医生](http://msdn.microsoft.com/en-us/library/system.io.file.encrypt.aspx)说这可能是由于

> 打开文件时发生 I/O 错误。- 或 - 当前平台不支持此操作。

可能是该文件被另一个进程锁定，或者您没有修改它的权限。您可以在重现此错误时运行[ProcMon以查看这是否是您的问题。](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T23:11:24.517

好好阅读[MSDN 页面](http://msdn.microsoft.com/en-us/library/system.io.file.encrypt.aspx)，

> 打开文件时发生 I/O 错误。
> 
> -或者-
> 
> 当前平台不支持此操作。

两者都不是一个特别有用的陈述，但它们应该给你一个开始的地方。

*   你能读懂文件吗？您是否在您的应用程序中对其进行了测试？

*   您是否在其他地方进行过加密？我以前从未见过加密失败（但总有第一次！）

# c# - 从 C# 原型到 ASP.NET，我需要改变什么？

> ID：918411
> 
> 赞同：0
> 
> 时间：2009-05-27T23:08:29.063
> 
> 标签：c#, asp.net, porting

我想念这个地方。

这是我用 C# 编写的代码片段。我想知道我是否可以将其复制/粘贴到 asp.net 应用程序以及我可能需要更改的内容。我最担心语法会无效，因为不存在兼容的库。

```
struct MediaIdUserIdPair //is there a standard pair i can use?
{
    public long mediaId, userId;
};

class Media : Media_Base
{
    public long mediaId, auth;
    public DateTime currentDate;
    public List<MediaIdUserIdPair> derivedFrom, inspiredBy;
    public List<string> derivedFromStr, inspiredByStr;
    public List<string> inspiredByExt = new List<string>();
};

            command.CommandText =
                "CREATE TABLE if not exists tag_name( " +
                "tagid INTEGER PRIMARY KEY, " +
                "title TEXT UNIQUE);";
            command.ExecuteNonQuery();
                command.CommandText = 
                    "INSERT OR FAIL INTO tag_name(title) VALUES(@title); " +
                    "SELECT last_insert_rowid() AS RecordID;";
                command.Parameters.Add("@title", DbType.String).Value = tag;
                long tagid = (long)command.ExecuteScalar(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T23:12:50.473

我在代码示例中看不到任何需要更改的内容。

基本上，只要您的 asp.net 应用程序的目标框架版本与您的 c# 应用程序相同，您就可以开始使用了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T23:14:26.790

你关心哪一部分？对我来说，它看起来像标准的 C#；只要您引用相关库，它就没有理由不适用于您想要的任何应用程序类型。（系统.数据等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T23:15:00.987

您的部分片段不包含任何非 ASP.NET 兼容代码。您可以在 ASP.NET、WinForms 和 WPF 中使用任何自定义对象和 ADO.NET。因为它们都是在 .NET Framework 和 CLR 之上运行的库。

您可能想选择一本关于 ASP.NET 和/或 C# 的好书。听起来您对 .NET 还很陌生，并且有很多值得学习的东西。

# iphone - 使用谷歌地图 api 从 iPhone 进行反向地理编码纬度/经度

> ID：918423
> 
> 赞同：2
> 
> 时间：2009-05-27T23:11:53.020
> 
> 标签：iphone, maps, geocoding, reverse

我目前正在使用谷歌地图的反向地理编码 API 将从 iPhone 的 CoreLocation API 接收到的经纬度转换为谷歌应用引擎服务器上的城市/州信息。

这会被视为违反条款吗？我做了一些研究，找不到这个问题的直接答案。

现在，我们将免费分发我们的 iPhone 应用程序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T14:34:29.803

根据 Google 的[服务条款](http://code.google.com/apis/maps/terms.html#section_10_12)，您只能将地理编码器与 Google 地图结合使用。

你不可以：

> 在没有相应 Google 地图的情况下使用或显示内容，除非 Maps API 文档、Street View API 文档明确允许您这样做，或通过 Google 的书面许可（例如，您不得使用通过服务获得的地理编码除非与 Google 地图结合使用，但街景 API 文档明确允许您在没有相应 Google 地图的情况下显示街景图像）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-16T13:20:18.060

上述条款未出现在修订后的服务条款中。因此，即使是 Apple 坐标也应该能够从 Google Maps API 反转地理编码

# ruby-on-rails - Rails 中的多状态验证

> ID：918428
> 
> 赞同：7
> 
> 时间：2009-05-27T23:12:57.870
> 
> 标签：ruby-on-rails, validation

我正在开发一个现有用户可以邀请其他成员加入的 Rails 应用程序。这样做的问题是用户模型存在于不同的状态中，并且在这些不同的状态中，需要不同的信息集。

例如，John 是该站点的成员并邀请 Mary。John 输入 Mary 的姓名和电子邮件地址，在数据库中为 Mary 创建一个用户记录，并发送一封邀请电子邮件。然而，在她加入后，所需的数据集会发生变化，我们要求她输入其他信息（例如密码）。

我仍在学习 Ruby on Rails，我看不到任何使用标准验证技术来处理这个问题的方法`validates_presence_of`，`validates_format_of`等等。谁能指出我正确的方向

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T23:18:44.613

最简单的使用`:if`方法如下：

```
class User < ActiveRecord::Base
  validate_presence_of :name
  validate_presence_of :age, :if => Proc.new { |user| user.signup_step >= 2 }
  # ... etc
end 
```

或者：

```
class User < ActiveRecord::Base
  validate_presence_of :name
  validate_presence_of :age, :if => :registering?

  def registering?
    signup_step >= 2
  end
end 
```

您还可以使用该`validate`方法定义任何复杂的自定义逻辑。例如：

```
class User < ActiveRecord::Base
  validate :has_name_and_email_after_invitation
  validate :has_complete_profile_after_registration

  def has_name_and_email_after_invitation
    if ... # determine if we're creating an invitation
      # step 1 validation logic here
    end
  end

  def has_complete_profile_after_registration
    if ... # determine if we're registering a new user
      # step 2 validation logic here
    end
  end 
end 
```

（在上面的示例中，您实际上可以在`has_name_and_email_after_invitation`常规`validates_xxx_of`调用中定义验证规则，因为它们也必须在步骤 2 中应用，但是在单独的步骤中使用两种方法可以为您提供最大的灵活性。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-09-16T14:38:24.510

而且，对于 DRYin'up 你的代码，你可以使用`with_options`，像这样：

```
class Example < ActiveRecord::Base
  [...]
  def registering?
    signup_step >= 2
  end
  with_options(:if => :registering?) do |c|
    c.validates_presence_of :name
  end

  with_options(:unless => :registering?) do |c|
    c.validates_presence_of :contact_details
  end
  [...]
end 
```

在此处了解更多信息`with_options`：

[http://apidock.com/rails/v2.3.2/Object/with_options](http://apidock.com/rails/v2.3.2/Object/with_options)

甚至还有 RailsCasts 的截屏视频：

[http://railscasts.com/episodes/42-with-options](http://railscasts.com/episodes/42-with-options)

# extension-methods - MediaWiki recursiveTagParse 返回 false

> ID：918430
> 
> 赞同：1
> 
> 时间：2009-05-27T23:13:46.870
> 
> 标签：extension-methods, mediawiki

我正在为我的小组编写一个供内部使用的扩展。它需要一些参数，并且应该为我们正在处理的版本返回一个 DR 表。它查询我们的 ClearQuest，而且一切正常。但是，当表中的行数超过 606（很常见）时，根本不会返回任何输出。

我使用 wiki 标记 ( {|...|} ) 编写表格并将其发送到 recursiveTagParse。我检查并 recursiveTagParse 返回错误。已经尝试过一点点，但找不到它会返回 false 而不是输出的原因。

我假设 recursiveTagParse 不会处理大量输入。有谁知道我可以设置一些变量来强制 recursiveTagParse 这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T17:15:36.437

您的解决方案是最明智的方法；MediaWiki 中的解析器扩展应该返回 HTML。可以自己生成这个；实际上，如果您不需要，请不要调用解析器 - 这是一个非常昂贵的调用，并且需要一些花哨的步法才能在递归调用中不搞砸一切。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T00:24:44.823

为了解决我的问题，我只使用了常规 html，并且在返回之前没有通过 recursiveTagParse 运行它。

# firefox-addon - Flash 10 调试器 flashlog.txt

> ID：918436
> 
> 赞同：1
> 
> 时间：2009-05-27T23:14:29.643
> 
> 标签：firefox-addon, trace, flash-cs3

我已经为 Firefox 3 安装了[Adob​​e Flash Player 10 调试器](http://www.adobe.com/support/flashplayer/downloads.html)，除了显示重绘区域外，我无法找到 flashlog.txt 文件或在线使用调试器功能。我已经安装了 FireFox 扩展[“Flash Tracer”](http://www.sephiroth.it/firefox/flashtracer/)，它在理论上与我的 firefox 版本兼容，现在正试图让它工作。

我在 C:\Documents and Settings{user}\Application Data\Macromedia\Flash Player\ 下找不到 flashlog.txt 或日志目录，我确信我已正确安装调试器。我的 mm.cfg 文件不存在，我手动创建了它。Flash 跟踪器插件无法从 XP 组件应位于的位置读取文件。具体来说，它说

> flashlog.txt 文件不存在。首先打开设置对话框。

我该怎么办？我真的需要这个插件才能正常工作。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-03T04:44:11.813

查看我的使用 Flash Debug Player 10 安装和配置 Flash Tracer 插件的[指南](https://stackoverflow.com/questions/864155/see-trace-of-flash-when-running-in-browser/864346#864346)。

# character-encoding - 字符编码列表

> ID：918442
> 
> 赞同：7
> 
> 时间：2009-05-27T23:15:31.467
> 
> 标签：character-encoding

有没有教书或网站，还包括完整的字符编码列表，包括十六进制、十进制和名称版本？

如果你能说出几本书和网站的名字，那将非常有帮助，谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-03-14T05:16:04.097

[http://www.iana.org/assignments/character-sets](http://www.iana.org/assignments/character-sets)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T23:24:11.090

目前尚不清楚您想要什么字符集。对于 ASCII 字符，`man ascii`将在大多数 Unix 系统上执行。对于所有的 Unicode，都有一个[巨大的标准](http://www.unicode.org/standard/standard.html). 对于 HTML 实体，有[W3C](http://www.w3c.org/)。也许您可以更具体地了解您感兴趣的角色？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T23:28:01.193

1.  [拉丁字母 1：http://en.wikipedia.org/wiki/ISO_8859-1](http://en.wikipedia.org/wiki/ISO_8859-1)
2.  [UTF-8：http://www.utf8-chartable.de/](http://www.utf8-chartable.de/)
3.  [Unicode码表：http://www.unicode.org/versions/Unicode5.1.0/](http://www.unicode.org/versions/Unicode5.1.0/)

还有更多可用的在线资源，维基百科有指向最有用资源的链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T23:26:45.983

有太多的字符编码，没有一个详尽的来源。

你应该看看：

*   [统一码](http://www.unicode.org/)
*   [维基百科](http://en.wikipedia.org/wiki/Character_encoding)

在它们之间，它们可能接近于详尽无遗。

# objective-c - Objective-C 实例变量指针

> ID：918445
> 
> 赞同：9
> 
> 时间：2009-05-27T23:16:02.730
> 
> 标签：objective-c, pointers

我是 Objective C 的新手，我只是想大致了解一下在声明实例变量时何时使用指针，何时不使用。

我能想到的例子是 UIView 与 BOOL。UIView 我会做一个指针，BOOL 我不会（因为编译器对我大喊大叫）。

任何一般性的指导都会很棒。

干杯，

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-27T23:21:47.367

如果它是一个对象，则使用指针表示法。所有的 c 类型（int、BOOL、long 等）都不是对象，因此如果你想要一个指向它们的内存位置的指针，你只能使用一个指针：

```
NSObject *obj;
UIView<Protocol> *obj;
int integerVar;
BOOL isTrue; 
```

一个特例是`id`，它本身就是一个指向对象的指针，所以你不需要`*`:

```
id obj; 
```

有点棘手：

```
NSInteger int;
NSNumber *number; 
```

NSInteger 是适当的特定于平台的 int 类型，而 NSNumber 是一个可以包含 int、float 或您拥有的对象的对象。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T23:25:53.740

指针用于保存已分配内存的地址。当您在可可中创建对象时，您会分配内存并将地址存储在指针中。

BOOL、char、int 存储值。

当您创建一个类时，alloc 会分配内存，因此您需要存储指向该内存的指针才能访问它：

```
NSMutableArray * arr = [[NSMutableArray alloc] init]; 
```

如何从内存中清除 C 类型？

“简单”类型在堆栈上分配。当一个方法被调用时，会在堆栈上分配一个空间来保存所有方法变量（加上一些其他的东西，比如参数和返回地址等等）。所以堆栈增长。一旦方法返回堆栈缩小并且方法使用的空间现在被回收 - 所以是的，简单类型将被“清理”。

它实际上比听起来要简单得多。查看[维基百科堆栈条目 - 硬件堆栈部分](http://en.wikipedia.org/wiki/Stack_(data_structure))了解更多详细信息，以满足您的好奇心。

当您“分配内存”时，该内存是在堆上分配的。堆用于整个应用程序的执行。在堆上分配内存后，您将获得该内存的地址 - 您将此地址存储在指针中。指针只是一个存储内存地址的变量。

当您的方法返回时，您不再可以访问在方法中声明的“简单”变量（例如 BOOL、int、char 等），但堆上的内存仍然存在。如果您仍然有内存的地址（例如指针），您就可以访问它。

'简单'类型的实例变量呢（编辑：内部对象？）？

当您创建对象（我们在这里讨论的是目标 C 和 Cocoa）并分配它时，您会为整个对象分配空间。对象的大小是它所有变量的大小（不确定 obj-c 是否添加了其他东西）。所以实例变量是堆上对象内存的一部分。当您释放/删除对象时，它的内存被回收并且您不再有权访问存储在对象内部的变量（在 obj-c 中您调用释放，每个对象保持引用计数，当引用计数达到 0 时，对象被释放 -堆上的内存被回收）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T01:13:52.057

每个 Objective-C 类，如 NSString、NSObject、NSView 等，都需要是一个指针，除了一些特殊类型，如 NSUInteger，我相信它只是 int 的 typedef。

```
NSString *stringyString = @"THIS STRING IS STRINGY!!!11";
NSOpenPanel *openPanel;
NSObject *objectyObject;
NSUInteger integeryInteger = 7; 
```

唯一不会是 id，因为它是指向任何对象的指针。

```
id pointerThatCanBeSetToAnyObject = [NSString stringWithString:@"HEYYYY"]; 
```

只有像 int、float、BOOL 等 C 变量类型不需要指针，除了像 char 数组这样的 C 字符串。

```
int SEVEN = 7;
float SIXPOINTTWO = 6.2;
char *characterArray = "HEYYYYY"; 
```

最后，CoreFoundation 类有一种混合体；许多类将是指针，但对于某些类，如 CFString，CFStringRef 已经是指针。许多 CFString 函数作为 CFStringRef 返回。CFString * 和 CFStringRef 可以与 NSString * 互换（这称为免费桥接），尽管如果您先转换它，编译器可能会喜欢它。

```
CFString *veryStringyString = @"STRINGYNESS!!11!one";
CFStringRef especiallyStringyString = @"STRRRRRRINNNNNGGGGYYYYY";
NSString *STRINGYNESS = (NSString *)veryStringyString; 
```

# ruby - （一元）* 运算符在这段 Ruby 代码中做了什么？

> ID：918449
> 
> 赞同：186
> 
> 时间：2009-05-27T23:17:51.527
> 
> 标签：ruby, operators, splat

给定 Ruby 代码

```
line = "first_name=mickey;last_name=mouse;country=usa" 
record = Hash[*line.split(/=|;/)] 
```

除了 `*`操作员之外，我了解第二行中的所有内容 - 它在做什么以及文档在哪里？（正如您可能猜到的那样，寻找这个案例很困难......）

* * *

## 回答 #1

> 赞同：285
> 
> 时间：2009-05-27T23:27:33.783

是*splat*`*`运算符。

 *它将 an 扩展`Array`为参数列表，在本例中是`Hash.[]`方法的参数列表。（更准确地说，它扩展了任何响应`to_ary`/的对象`to_a`，或者`to_a`在 Ruby 1.9 中。）

为了说明，以下两个语句是相等的：

```
method arg1, arg2, arg3
method *[arg1, arg2, arg3] 
```

它也可以在不同的上下文中使用，以捕获方法定义中所有剩余的方法参数。在这种情况下，它不会扩展，而是结合：

```
def method2(*args)  # args will hold Array of all arguments
end 
```

[这里有一些更详细的信息](https://content.pivotal.io/blog/ruby-pearls-vol-1-the-splat)。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-05-27T23:28:21.007

splat 运算符解压缩传递给函数的数组，以便将每个元素作为单独的参数发送给函数。

一个简单的例子：

```
>> def func(a, b, c)
>>   puts a, b, c
>> end
=> nil

>> func(1, 2, 3)  #we can call func with three parameters
1
2
3
=> nil

>> list = [1, 2, 3]
=> [1, 2, 3]

>> func(list) #We CAN'T call func with an array, even though it has three objects
ArgumentError: wrong number of arguments (1 for 3)
    from (irb):12:in 'func'
    from (irb):12

>> func(*list) #But we CAN call func with an unpacked array.
1
2
3
=> nil 
```

就是这样！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-28T00:20:56.220

正如大家所说，这是一个“splat”。寻找 Ruby 语法是不可能的，我在其他问题中也问过这个问题。这部分问题的答案是您搜索

```
asterisk in ruby syntax 
```

在谷歌。谷歌随时为您服务，只需将您所见即所得。

Anyhoo，就像很多 Ruby 代码一样，这些代码非常密集。这

```
line.split(/=|;/) 
```

制作一个由六个元素组成的数组，`first_name, mickey, last_name, mouse, country, usa`. 然后使用 splat 将其变成哈希。现在 Ruby 人总是派你去看 Splat 方法，因为一切都暴露在 Ruby 中。我不知道它在哪里，但是一旦你有了它，你就会看到它`for`通过数组运行并构建散列。

[您将在核心](http://www.ruby-doc.org/core/)文档中查找代码。如果你找不到它（我找不到），你会尝试编写一些这样的代码（它有效，但不是类似 Ruby 的代码）：

```
line = "first_name=mickey;last_name=mouse;country=usa"
presplat = line.split(/=|;/)
splat = Hash.new
for i in (0..presplat.length-1)
    splat[presplat[i]] = presplat[i+1] if i%2==0
end

puts splat["first_name"] 
```

然后 Ruby 帮将能够告诉你为什么你的代码是愚蠢的、糟糕的或完全错误的。

如果您已经阅读了这么多，请阅读[Hash](http://ruby-doc.org/core-2.5.1/Hash.html#method-c-5B-5D)文档以进行初始化。

基本上，使用多个参数初始化的哈希将它们创建为键值对：

```
Hash["a", 100, "b", 200] #=> {"a"=>100, "b"=>200} 
```

因此，在您的示例中，这将导致以下哈希：

```
{"first_name"=>"mickey", "last_name"=>"mouse", "county"=>"usa"} 
```

# xml - DTD中PCDATA和CDATA的区别

> ID：918450
> 
> 赞同：89
> 
> 时间：2009-05-27T23:18:07.093
> 
> 标签：xml, dtd

`#PCDATA`DTD和`#CDATA`in **DTD**和有什么不一样？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-07-24T05:19:39.490

*   `PCDATA`是将由解析器解析的文本。文本内的标签将被视为标记，实体将被展开。
*   `CDATA`是*不会*被解析器解析的文本。文本内的标签 *不会*被视为标记，实体也不会被展开。

默认情况下，一切都是`PCDATA`. 在下面的例子中，忽略根，`<bar>`将被解析，它没有内容，只有一个孩子。

```
<?xml version="1.0"?>
<foo>
<bar><test>content!</test></bar>
</foo> 
```

当我们要指定一个元素只包含文本，不包含子元素时，我们使用关键字`PCDATA`，因为这个关键字指定元素必须包含可解析的字符数据——即除小于 ( `<`) 字符之外的任何文本，大于 ( `>`) 、与号 ( `&`)、引号 ( `'`) 和双引号 ( `"`)。

在下一个示例中，`<bar>`包含`CDATA`. 它的内容不会被解析，因此是`<test>content!</test>`.

```
<?xml version="1.0"?>
<foo>
<bar><![CDATA[<test>content!</test>]]></bar>
</foo> 
```

SGML 中有几个内容模型。内容`#PCDATA`模型说一个元素可能包含纯文本。它的“已解析”部分意味着其中的标记（包括 PI、注释和 SGML 指令）被解析而不是显示为原始文本。这也意味着实体引用被替换。

另一种允许纯文本内容的内容模型是`CDATA`. 在 XML 中，元素内容模型可能不会隐式设置为`CDATA`，但在 SGML 中，这意味着在元素的内容中忽略了标记和实体引用。然而，在类型属性中`CDATA`，实体引用被替换。

在 XML 中，`#PCDATA`是唯一的纯文本内容模型。如果您想在元素中允许文本内容，您可以使用它。内容`CDATA`模型可以通过 中的`CDATA`块标记显式使用`#PCDATA`，但元素内容可能未按`CDATA`默认定义。

在 DTD 中，包含文本的属性的类型必须是`CDATA`. 属性声明中的关键字与 XML 文档中`CDATA`的部分具有不同的含义。`CDATA`在一个部分中，`CDATA`所有字符都是合法的（包括、、、`<`和字符） `>`，除了结束标记。`&``'``"``]]>`

`#PCDATA`不适合属性的类型。它用于“叶子”文本的类型。

`#PCDATA`在内容模型中以散列开头，以将此关键字与命名的元素区分开来`PCDATA`（这将是完全合法的）。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2009-05-27T23:23:31.450

PCDATA - 解析的字符数据

XML 解析器通常解析 XML 文档中的所有文本。

CDATA -（未解析的）字符数据

CDATA 一词用于表示不应由 XML 解析器解析的文本数据。

“<”和“&”之类的字符在 XML 元素中是非法的。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2016-12-26T19:28:50.930

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-27T23:23:29.517

[从这里](http://lists.xml.org/archives/xml-dev/199906/msg00737.html)（[谷歌是你的朋友](http://www.google.co.uk/search?q=pcdata+vs+cdata)）：

> 在 DTD 中，PCDATA 和 CDATA 分别用于断言元素和属性的允许内容。在元素的内容模型中，#PCDATA 表示该元素包含（可能包含）“任何旧文本”。（除了下面提到的例外情况。）在属性的声明中，CDATA 是一种可以放在属性允许值上的约束（其他类型，所有互斥，包括 ID、IDREF 和 NMTOKEN）。允许值为 CDATA 的属性（如元素中的 PCDATA）可以包含“任何旧文本”。
> 
> 一个可能真正令人困惑的问题是还有*另一个*“CDATA”，也称为标记部分。标记部分是元素 (#PCDATA) 内容的一部分，用特殊字符串分隔：关闭它。如果您记得 PCDATA 是“已解析的字符数据”，那么 CDATA 部分实际上是相同的，没有“已解析”。解析器将标记部分的内容传输到下游应用程序，而不会在每次遇到特殊字符（如 < 和 &）时打嗝。当您编写包含大量这些特殊字符（如脚本和代码片段）的文档时，这很有用；它比相应的实体引用更容易输入数据，也更容易阅读。
> 
> 因此，您可以推断“任何旧文本”规则的例外是 PCDATA 不能包含任何这些未转义的特殊字符，除非它们属于 CDATA 标记部分的范围。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-02T13:43:43.663

PCDATA 和 CDATA 之间的主要区别是

PCDATA - 基本上用于 ELEMENTS 而

CDATA - 用于 XML 的属性，即 ATTLIST

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-12T13:55:53.077

CDATA（**C**字符**数据**）：类似于评论，但它是文档的一部分。即 CDATA 是一个数据，它是文档的一部分，但数据不能用 XML 解析。
**注意：**解析 XML 时省略 XML 注释，但 CDATA 显示为原样。

PCDATA ( **Parsed** **C** character DATA ) ：默认情况下，一切都是 PCDATA **。**PCDATA 是一个数据，可以用 XML 解析。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-20T04:58:09.660

# 个人电脑数据

PCDATA：（已解析字符数据）：XML 解析器用于解析 XML 文档中的所有文本。PCDATA 代表已解析字符数据。PCDATA 是将由解析器解析的文本。PCDATA 中的标签将被视为标记，实体将被扩展。

换句话说，您可以说解析的字符数据意味着 XML 解析器检查数据并确保它不包含将被替换的实体。

举个例子：

```
<?xml version="1.0"?>  
<!DOCTYPE employee SYSTEM "employee.dtd">  
<employee>  
  <firstname>vimal</firstname>  
  <lastname>jaiswal</lastname>  
  <email>vimal@javatpoint.com</email>  
</employee> 
```

在上面的示例中，employee 元素包含另外 3 个元素 'firstname'、'lastname' 和 'email'，因此它进一步解析以获取 firstname、lastname 和 email 的数据/文本，从而将employee 的值设为：

```
vimal jaiswal vimal@javatpoint.com 
```

# 数据中心

CDATA：（未解析的字符数据）：CDATA 包含未在 XML 文档中进一步解析的文本。CDATA 文本中的标签不被视为标记，实体不会被扩展。

让我们以 CDATA 为例：

```
<?xml version="1.0"?>  
<!DOCTYPE employee SYSTEM "employee.dtd">  
<employee>  
<![CDATA[  
  <firstname>vimal</firstname> 
  <lastname>jaiswal</lastname> 
  <email>vimal@javatpoint.com</email> 
]]>   
</employee> 
```

在上面的 CDATA 示例中，在元素employee 之后使用 CDATA 使数据/文本不被解析，因此它将给出employee 的值：

```
<firstname>vimal</firstname><lastname>jaiswal</lastname><email>vimal@javatpoint.com</email> 
```

# naming-conventions - 在 UI 中替换/避免匈牙利符号的命名建议？

> ID：918457
> 
> 赞同：2
> 
> 时间：2009-05-27T23:21:43.810
> 
> 标签：naming-conventions, fxcop, hungarian-notation

我已经停止在任何地方使用匈牙利符号，除了在 UI 中，我通常有一个用户名标签、一个用户名文本框、一个用户名本地变量、一个必填字段验证器、一个用户名属性和方法参数等等，通常都是在相同的上下文中。

当前：lblUser、txtUser、rfvUser、_User、用户、用户

如果我这样做很明显，UserLabel、UserTextBox、UserRequiredFieldValidator，似乎我只是用较长的后缀代替较短的前缀。

_ 表示字段，被 FxCop 标记，但没有前缀，它会与批准的用户/用户约定冲突。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T23:32:05.787

我仍然通常对 UI 对象使用匈牙利符号，因为我发现它使我的代码更具可读性。

我会为 UI 控件使用 m_firstNameTextBox 或 m_countryComboBox 之类的东西，然后将 m_firstName 和 m_country 用于这些控件的字符串值。

在一天结束时，您应该使用您喜欢的任何东西。避免使用匈牙利符号的一揽子规则与规定宗教使用它的规则一样糟糕。很明显，像 intCounter、strName 这样的东西是多余的，但在其他情况下，在变量名称中指示类的类型确实很有意义，而且我认为 UI 控件恰好是它确实有意义的情况之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T02:54:55.847

匈牙利表示法没有任何问题，只要它用于使代码更具可读性。如果您认为它对此没有帮助，请不要使用它。

啊，请不要同时使用“**用户**”和“**用户**”。它难以阅读、使用、维护和移植。如果两个不同的事物有两种不同的含义，那么匈牙利符号是一个比通过在大写/小写之间翻转字符来编码该条信息更好的选择。

我不知道是谁在程序语言中发明了区分大小写的功能，但他造成的破坏超出了当时任何人的想象。我讨厌出现编译器错误，因为我输入了 ' **ID** ' 而不是 ' **Id** ' 或 ' **UsbDrive** ' 而它应该是 ' **USBDrive** '。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T23:33:41.510

我更喜欢匈牙利语，即使它会导致 UI 中的名称很长（因为您提到的问题）。我唯一的建议是在整个团队中保持一致。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T02:58:02.750

使用所有小写和下划线，大小写问题就消失了。有些白痴在某个地方决定这是一个好方法，如果我找到他，我会杀了他。

# pdo - 在 PDO 查询中设置限制以希望具有更大的可移植性

> ID：918461
> 
> 赞同：1
> 
> 时间：2009-05-27T23:22:47.037
> 
> 标签：pdo

我开始使用 PDO 库而不是 Creole 并发现大多数类似的东西除了我找不到设置限制的函数。

我不认为我应该在查询字符串中包含限制语句，因为 MSSQL 和 MySQL 不共享相同的语法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T01:16:26.060

来自 PHP 手册[http://www.php.net/manual/en/ref.pdo-mysql.php](http://www.php.net/manual/en/ref.pdo-mysql.php)

> PDO 提供了一个数据访问抽象层，这意味着，无论您使用哪个数据库，您都可以使用相同的函数来发出查询和获取数据。PDO 不提供数据库抽象；它不会重写 SQL 或模拟缺失的功能。

由于它不会重写 SQL 语句，因此您将找不到进行通用分页的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T01:21:49.030

按照 Renato 的说法，您应该知道，只有函数调用才能运行您的 SQL 语句，并且您发送到服务器的任何 SQL 都是完全未修改的。为多个数据库编写 SQL 代码可能非常棘手。特别是如果你想从简单的 SQL 语句分支到更复杂的东西，比如存储过程。即使是函数调用（IsNull 与 IfNull）之类的基本操作也会使您的任务变得比实际需要的困难得多。

# apache-flex - Flex 数据绑定数组到画布作为对象，通用客户端架构

> ID：918463
> 
> 赞同：0
> 
> 时间：2009-05-27T23:23:30.093
> 
> 标签：apache-flex, architecture

我在 flex 中创建了一个分布式笔记应用程序，它基本上是一个我可以放在桌面托盘中的记事本。当我添加注释并返回服务器并将其保存在数据库中时。

为了努力正确设计应用程序，我想要一个同步服务来轮询网络服务器以获取更改并更新 Note 对象数组。问题是我的笔记对应的是 mxml 组件，也就是 SingleNote 组件。存在时有四种不同的情况，a。从服务器轮询中更新了一条注释，在这种情况下，我想单条注释来更新设置 b。一个注释从服务器添加到数组中，在这种情况下，需要创建一个新的 SingleNote c. 从客户端添加一个 SingleNote，在这种情况下，将一个 Note 添加到数组中，然后发送回服务器 d。SingleNote 是从客户端更改的，在这种情况下，Note 在数组中更新并发送回服务器

属性是 SingleNote(Width, X, Y, Text)。

你能推荐如何实现这种复杂的数据绑定吗？你会怎么设计这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-20T09:18:17.297

你的数据库是什么样的？里面有 Note 表吗？

如果您要求客户端架构，我猜服务端的服务已经完成。在那种情况下，您的客户端和服务器之间交换的数据的结构是什么？

最好的情况是，如果您已经有一个 DTO/VO 将笔记实体从您的数据库映射到一个类。在客户端，您可以使用每个对象的 id 字段来了解它是否已经保存到数据库中。

所以，我要做的是：

在客户端创建一个 NoteManager，它：

1.  存储您的 Note 对象数组
2.  有管理这个数组状态的方法：hasNote(idNote:int), addNote(note:Note), removeNote(idNote:int), updateNote(idNote:note),...

当您修改此数组的状态时，您必须更新您的视图。根据您使用的框架（如果您使用任何框架），这可以通过不同的方式完成，但总体思路是使用 Observable 模式在模型更改后更新您的视图。（在某个地方，您可能还有一个将笔记对象映射到其组件显示的 Map）

# algorithm - 你在编码之前用伪代码写出你的算法吗？

> ID：918480
> 
> 赞同：4
> 
> 时间：2009-05-27T23:28:38.010
> 
> 标签：algorithm

所以我知道有几个人在编码之前实际上用简单的英语（伪代码）写出他们的算法。我以前从来没有这样做过，但现在我想起来，这对于组织复杂的算法是有道理的。你这样做吗？它有帮助吗？如果没有，在编写程序之前你会做什么（如果有的话）来组织你的程序？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-27T23:35:42.427

[我之前提到过](https://stackoverflow.com/questions/852724/writing-pseudocode-best-practices/852928#852928)：

> 我倾向于发现自己在记事本中使用缩进编写小用例……在大约六行之后，我突然意识到我正在以一种基本上是 Python 的风格编写，但语法少了一点！所以我得出的结论是，Python 实际上是伪代码，是一种用您真正尝试编写的任何语言对您的想法进行原型制作的绝妙方法。这项技术的最佳之处在于您已经有了可以比较的参考在出现讨厌的错误的情况下，您完成的结果。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-27T23:31:08.190

我没有写太多的伪代码，但我发现如果我不能用简单的英语说出我想做什么，那么我对问题的理解还不够，无法开始编写代码。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-27T23:42:31.490

这些天我主要用 Python 编写。那是开始的伪代码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-27T23:45:18.380

我使用注释（在方法内和发布的接口中）作为伪代码。

在实现算法时，我按顺序遵循的步骤是：

*   确保 API 或接口正确。如果我无法确定正确的操作是什么，或者什么数据进出，那就是有问题。
*   在 Javadoc（或等效的）注释中描述每个操作；这通常指出算法或如何使用它的问题。
*   在一个或多个方法中以伪代码的形式写注释。我在开始编写代码之前或在编写代码时这样做。这有助于我记住我在写之前的想法，并记录我的想法以供将来参考。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-27T23:50:25.190

一般来说，不是真的。如果我在电脑前并且正在处理一些特别困难或乏味的事情，我可能会事先使用注释来完成并勾勒出一些东西，但它们往往更像是一种自然语言陈述，而不是适当的伪代码。一般来说，我唯一一次使用正确的伪代码是在课堂上。

然而，值得注意的是，对一个开发人员有用的东西可能对另一个开发人员不起作用，而且有些人发誓要事先编写伪代码。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-27T23:33:44.223

我已经尝试过，但是我发现很难做到，因为通常有很多事情我没有考虑到，直到我被迫用严格的语言写出算法。英语就是这样一种欺骗自己的好语言。

实际上，我发现它有害，因为我把时间花在了非问题上，而忽略了在尝试编写计算机代码之前我没有看到的真正问题。事实上，我已经编写了计算机代码来帮助整理我用英语写的东西的想法。

我发现画图和/或采用几何方法会很有帮助。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-27T23:30:46.850

如果它不是微不足道的，我将首先使用伪代码，然后在我为该特定组件生成任何正式文档时将该伪代码包含在我的文档中。

如果它是微不足道的，我只需用我的实现语言编写代码，然后在需要时查看并添加注释。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-27T23:30:48.160

如果这是一个非常棘手的问题，我会做一些伪代码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-27T23:44:58.943

通常对于一个函数，我会写一个很好的长标题描述它的作用（最好是 Doxygen 格式）。

如果它足够复杂，我会制作结构图（旧的 pre-UML pre-OO 设计），或者类似 UML 序列或活动图的东西。

对于整个系统，我当然从类图开始。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-27T23:29:47.383

我不写伪代码，但我通常会制作某种流程图来指导我。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-27T23:32:38.407

如果我知道我需要为另一部分编写代码，但我现在能想到方法或函数的大致轮廓，我会写出足够的内容，以便我以后能记住我对方法应该如何做的想法跑。通常我稍后会更改它，所以我很少发现它有帮助。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-27T23:50:22.833

那将是梦想。

只需编写伪代码，它就可以工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-28T00:37:31.490

我非常喜欢先用伪代码写出算法，只是为了让我的头脑围绕算法。从英语转换为代码相对容易（对我来说），所以我倾向于写更多的单词和更少的代码。对于足够复杂的算法，我可以轻松地将我的伪代码用作其他人的注释。

至于细节，我通常用旧纸/铅笔，我缩进循环/控制语句。其他一切都是我当时的想法。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-28T00:48:47.363

绝对......有一次，我有一些可靠的伪，我启动了“端口”。很容易以一种简单的方式完成复杂的事情，而不需要语言语义。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-28T01:27:26.303

My pseudocode, like others above, is basically Python. This is not a statement about my Python expertise, but about how intuitive the language is. My problem-solving skills have always been better than my memory for details like syntax, so it's great to work with a Language that lets me focus on the problem at hand without getting in my way by forcing me to look up syntax so much. Also, one of the benefits of pseudocode vs. other languages is in just writing the logic without stuff like type declarations - and you don't do that in Python anyway, so writing the code is essentially no more work or clutter than pseudocode logic.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-28T12:17:57.770

I write it in fortran - that's basically pseudocode which pretty much anyone can understand. I can't think of an easier way to write it.

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-28T12:35:47.767

It depends on the algorithm. If it's simple, then I can usually store all the logical paths in my head, if it's complex, then I'll sketch out each step with the relative logic.

# wpf - 如何在代码中绑定 WPF 网格列宽？

> ID：918481
> 
> 赞同：4
> 
> 时间：2009-05-27T23:28:44.170
> 
> 标签：wpf, binding, grid

在 WPF 中，我有一个定义了许多列的网格，并且每列的宽度都绑定到 DataGrid 列的宽度，如下所示：

```
<Grid.ColumnDefinitions>
   <ColumnDefinition Width="{Binding ElementName=dataGrid, Path=RowHeaderWidth}" />
   <ColumnDefinition Width="{Binding ElementName=Column0, Path=ActualWidth}" />
   <ColumnDefinition Width="{Binding ElementName=Column1, Path=ActualWidth}" />
   Etc.

<Controls:DataGrid BorderBrush="White"  ItemsSource="{Binding DataTable}"  
                   Name="datagrid1" Grid.Row="2" RowHeaderWidth="0">

    <Controls:DataGrid.Columns>
    <Controls:DataGridTextColumn  Header="Included"  Width="50" x:Name="Column0" />
    <Controls:DataGridTextColumn  Header="First" Width="100" x:Name="Column1" />
     Etc. 
```

当我运行程序并手动调整列大小时，我可以看到 Grid 列正在调整大小 (ShowGridLines = true)，并且与特定 Grid 列相关的元素会适当移动。

但是，当我尝试在代码中添加数据网格和网格列时，我无法使绑定工作（没有绑定错误）。这是一个例子：

```
 binding = new Binding()
 {
    Source = dataGrid.Columns[col],
    Path = new PropertyPath("ActualWidth"),
    Mode = BindingMode.OneWay, 
 };

 colDef.SetBinding(WidthProperty, binding); 
```

我尝试了其他变体（例如 ElementName = "DataGridColumn1", Path = new PropertyPath("ActualWidth") 但没有错误（也没有绑定）或“找不到绑定源”错误或 BindingExpression 路径错误。

必须有一种方法可以在代码中设置绑定...？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T06:09:16.587

我找到了答案。这一行：

```
 colDef.SetBinding(WidthProperty, binding); 
```

应改为：

```
 colDef.SetBinding(ColumnDefinition.WidthProperty, binding); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-21T09:19:18.117

```
DataGridTextColumn textColumn = new DataGridTextColumn();
textColumn.Width = DataGridLength.SizeToHeader; 
```

谷歌`DataGridLength`获得其他选择....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-15T10:02:21.873

在我的项目中，我确实喜欢这个 - 认为值得一提，因为在我得到它之前我遇到了很多问题：

```
 DataGridTextColumn c = new DataGridTextColumn
    {
          // Binding to my value (not directly related to the question)
          Binding = new Binding
          {
               Path = new PropertyPath(cd.Title + ".Value"),
               Mode = BindingMode.TwoWay
          }
     };

     // Binding the width 
     BindingOperations.SetBinding(c, DataGridTextColumn.WidthProperty, new Binding
     {
           Source = cd,                        // An INotifying object
           Path = new PropertyPath("Width"),   // A Property of that object
           Mode = BindingMode.TwoWay
      }); 
```

# css - Firefox 1.5 和 2 css 绝对位置错误

> ID：918483
> 
> 赞同：2
> 
> 时间：2009-05-27T23:29:00.677
> 
> 标签：css, firefox, firefox2

我有以下 html/css 在 Firefox 1.5 和 2 中导致问题，但在 IE6/7/8、Safari、Chrome、Opera 和 Firefox 1 和 3 中正常工作。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Firefox Bug</title>
<style type="text/css">
  * { border: 0; padding: 0; margin: 0; }
  #wrapper {
    width: 500px;
    min-height: 550px;
    height: auto !important;
    height: 550px;
    border: 5px solid blue;
    position: relative;
    display: inline;
    overflow: auto;
    float: left;
  }
  #content {
    border: 5px solid green;
  }
  #bottom {
    border: 5px solid red;
    position: absolute;
    bottom: 0;
    right: 0;
    width: 200px;
    height: 100px;
  }
</style>
</head>
<body>
  <div id="wrapper">
    <div id="content">
      Foo
    </div>
    <div id="bottom">
      Bar
    </div>
  </div>
</body>
</html> 
```

在正常工作的浏览器中，底部元素显示在包装器元素的右下角。但是，在 Firefox 2 中，底部元素位于内容元素的底部。我无法弄清楚为什么会这样，任何帮助将不胜感激。

**预期成绩**

![预期成绩](https://farm4.static.flickr.com/3417/3571798464_94955cc5f5_o.png)

**火狐 2 错误**

![火狐漏洞](https://farm3.static.flickr.com/2410/3570991369_1303035317_o.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T23:46:43.200

我能够找到解决方法，但我仍然不明白出了什么问题。我的解决方法不是灵丹妙药，但它适用于我的情况。

删除 IE 的最小高度工作似乎使它做正确的事情。这个解决方案的问题是，如果内容元素比高度大，溢出的内容会出现滚动条。

```
#wrapper {
  width: 500px;
  height: 550px;
  border: 5px solid blue;
  position: relative;
  display: inline;
  overflow: auto;
  float: left;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T23:34:05.987

要么脱掉

```
 float: left. 
```

或者尝试改变

```
 bottom: 0 
```

**到**

```
 top: 100%; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T02:27:49.240

从#wrapper 中删除溢出：自动。

众所周知，混合浮动和绝对定位对于所有浏览器来说都很难做到——它们似乎都实现了自己的小怪癖。

# ruby-on-rails - 处理 RSS/ATOM 提要的 Rails 库？

> ID：918488
> 
> 赞同：2
> 
> 时间：2009-05-27T23:30:16.540
> 
> 标签：ruby-on-rails, parsing, rss, atom-feed

什么是解析 RSS/ATOM 提要并在 Rails 视图中呈现内容的好解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T23:45:46.163

我在[http://www.robbyonrails.com/articles/2005/05/11/parsing-a-rss-feed](http://www.robbyonrails.com/articles/2005/05/11/parsing-a-rss-feed)（以及其中的链接）上看到了关于解析部分的好注释。一旦你解析了它们，如何最好地呈现它们可能是一个主观问题......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-11T19:44:31.543

最近的[Railscast 之一（2009 年 6 月 29 日）](http://railscasts.com/episodes/168-feed-parsing)推荐了 Feedzirra

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T18:59:37.710

id 推荐acts_as_feed，它负责自动解析，[充当 feed rails 插件](http://github.com/grosser/acts_as_feed)，可以添加到模型中。只要您只需要显示提要，另一种解决方案就是使用[google feed api 。](http://code.google.com/apis/ajaxfeeds/)

```
#HAML view example
- if feed.filled?
  %h2="Blog: #{feed.title}"
  - for item in feed.entries[0...5]
    -date = item.published_at.to_date.to_s(:long)

    %h2=link_to(h(item.title),h(item.url)) 
```

# applescript - 如何检查文本是否可以在 AppleScript 中转换为数字？

> ID：918493
> 
> 赞同：1
> 
> 时间：2009-05-27T23:31:10.080
> 
> 标签：applescript

我正在尝试编写一个简单的 AppleScript 来对剪贴板的内容进行一些文本操作。以下代码仅在剪贴板中的文本可以转换为数字时才有效：

```
set CB to the clipboard
set bugNum to CB as number 
```

但如果剪贴板中的文本不是数字，我会收到 AppleScript 错误：“无法将“foo”转换为类型数字。”

如何编写一个 if 条件来检查 CB（类文本）是否可以转换为数字（并将“将 bugNum 设置为 CB 作为数字”放入其中）？或者我能以某种方式“捕捉”错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T23:44:55.667

您是否已经阅读过 Applescript 指南中的[处理错误？](http://developer.apple.com/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_error_xmpls.html)

示例代码：

```
set CB to the clipboard
try
    set bugNum to CB as number
on error errStr number errNum
    set bugNum to -1
end try
display dialog "Number from the clipboard: " & bugNum 
```

我第一次跳过了代码，因为我认为指南非常清晰，而且比我在这里写的任何东西都要有用:)

# c# - 使用 ASP.NET MVC 入门项目出现 404 错误

> ID：918496
> 
> 赞同：0
> 
> 时间：2009-05-27T23:31:55.960
> 
> 标签：c#, asp.net-mvc, iis

我刚刚创建了一个 ASP.NET MVC 项目，并且能够使用 Visual Studio Development Server 构建和浏览它。

当我尝试在项目属性 Web -> 服务器下从 Visual Studio 开发服务器更改为我的本地 IIS (IIS 5.1) 时。我可以浏览到默认页面，但是当我浏览到任何其他页面时，我会收到 404 错误。

我的站点和虚拟目录的根是[http://localhost/MyMvcApplication](http://localhost/MyMvcApplication)

使用 IIS 时是否有不同的配置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T23:41:42.583

您必须设置通配符映射到 aspnet_isapi.dll（IIS 站点配置）。这意味着对服务器的每个请求都由 .NET DLL 解析，以便可以重写 URL（MVC 严重依赖 URL 重写）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T23:36:51.300

[在 IIS 5.1 (Windows XP) 上部署 ASP.NET MVC](https://stackoverflow.com/questions/301359/deploy-asp-net-mvc-on-iis-5-1-windows-xp)

# pdf - 我的 PDF 在打开时可以 ping 我的服务器吗？

> ID：918498
> 
> 赞同：2
> 
> 时间：2009-05-27T23:32:31.370
> 
> 标签：pdf, metrics

我每天都有一项将 PDF 发送给客户的 cron 工作。我想衡量打开这些 PDF 文件的数量。有哪些可用的技术？

网页中的标准技术是包含一个带有 src 引用的 img 标签，该标签指向记录 ping 的服务器端点。但似乎 PDF 不允许外部图像引用。

有什么方法可以完成我想要的吗？

更新：我们正在考虑让电子邮件包含指向 PDF 的链接，但有一些我们不想这样做的原因，所以我很想听听其他选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T23:35:40.133

要“打电话回家”，您需要一个[Adob​​e LiveCycle Policy Server](http://www.adobe.com/products/livecycle/rightsmanagement/)。

否则，如果有办法嵌入外部图像，那可能会用于记录目的，但我认为这是不可能的......

编辑，可能[有一些方法，包括 AcroJS](http://www.lessig.org/blog/2006/12/is_there_a_simple_way_to_make.html)。自己没有测试过，所以不知道好不好用。

编辑 2：作为 Linux 用户，我应该指出，这两种非标准方法都不适用于非 Acrobat Reader 用户。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T23:36:35.513

也许您可以采取稍微不同的方法 - 让您的 cron 作业在某处的 Web 服务器上提供 PDF，然后发送包含 PDF 链接的电子邮件。这样可以很容易地从 Web 服务器日志中检查实际查看了多少。

你可能已经想到了这一点并打了折扣；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T23:35:37.510

您可以拥有指向 pdf 本身的电子邮件链接，并将其用作您要查找的 ping。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T14:35:02.800

您可以查看 Adob​​e Acrobat JavaScript 参考[http://www.adobe.com/devnet/acrobat/javascript.html](http://www.adobe.com/devnet/acrobat/javascript.html)。你可以在你的 PDF 文档中使用一些 Ajax，这个[文档](http://www.adobe.com/devnet/acrobat/pdfs/js_api_reference.pdf)是一个很好的参考。

将一些 JavaScript 添加到您的 PDF 文档并监听 Doc Open 事件，然后（假设您的用户使用的是 Adob​​e Reader 版本 8 或更高版本）使用 Net.SOAP.request 方法对您的服务进行远程过程调用。我以前没有尝试过，我只使用 PDF javascript 将表单结果发布到网络服务，但我相信在连接 Adob​​e Reader 之前会提示用户让他们请求互联网连接。

# c# - 无法提交请求以进行后台处理？

> ID：918499
> 
> 赞同：0
> 
> 时间：2009-05-27T23:32:35.303
> 
> 标签：c#, .net, crystal-reports

在我的开发机器上使用 Crystal Reports 10.5 时出现以下错误。该报告今天早上在我的测试中运行良好，现在我收到此错误

> 文件 C:\DOCUME~1\UserNameHere\LOCALS~1\Temp\BarLabel {052E0DE7-59FA-4C55-B293-316F7DFE8531}.rpt 中的错误：无法提交请求以进行后台处理

我不确定是什么导致了问题或如何解决它。我已经删除了临时文件，但没有做任何事情。我还在计算机列表 priveleges 上提供了“网络服务”帐户，因为我看到在 CR 9.0 中修复了与此类似的错误，但这似乎也无济于事。

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T22:31:44.240

原来这个错误是 CrystalReports 的内部错误。我使用的是服务器上不存在的 BarCode 字体。该错误是非描述性的，但由于报告有问题而不是 CR 运行时

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-28T19:20:01.850

我会说完全取消 Crystal Reports 并尝试 Active Reports 或其他类似软件。根据我对这个问题的研究，似乎人们发现这是一个 CR 错误，而且 Business Objects 似乎不会很快解决这个问题。我说那个 CR 垃圾并采用真正的解决方案。

# web-services - 如何根据关键字获取网站谷歌排名？

> ID：918515
> 
> 赞同：1
> 
> 时间：2009-05-27T23:37:32.750
> 
> 标签：web-services, api

我搜索了 Google 搜索 API，但没有找到基于搜索关键字获得网站排名的方法，我认为这是不可能的。

但我幸运地找到了这个网站“ [http://www.tools4google.com/search-google-position/keyword_tracking.php](http://www.tools4google.com/search-google-position/keyword_tracking.php) ”，它和我想做的一样，所以我只想知道背后的想法，或者它是非法的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T23:47:12.417

它很可能只是从 Google 为您提供的所有页面中抓取结果。这就是为什么它允许您选择的最大“职位数”是 1000.. 因为这是您在 Google 中进行搜索时 Google 通常会向您显示的最大数量。另一件事是，他们在页面上给出的时间估计似乎呈线性增长......如果他们使用谷歌（或其他）提供的任何类型的 API，理想情况下它会提供基于关键字的索引查找。

我所说的抓取的意思是它使用了一个机器人，它会遍历谷歌的每一页结果（对于特定的关键字*）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-07T16:52:44.877

试试[rankog.com](http://www.rankog.com)它也做同样的事情

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T23:40:49.297

我想它会搜索关键字，然后在列表中打勾，直到它到达您的域。通过 API 非常激烈但非常简单。

# svn - SVN 不会提交未版本控制的文件，即使它们显示为 svn 状态

> ID：918516
> 
> 赞同：5
> 
> 时间：2009-05-27T23:37:49.957
> 
> 标签：svn, macos

我在将新项目设置为源代码控制时遇到了困难。我已经将一个项目导入到 subversion 中，从表面上看，一切似乎都运行良好。但是，每当我在项目中添加一个新文件时，即使它在我运行 svn status 时显示为未版本化，但在我尝试签入时它并没有签入，无论是使用 svn ci -m 'msg' 还是当我试试我的版本 OS X svn 客户端。

这是 svn status 的一些示例输出：

```
?      Assets/Placeholder Images/shopping_list_1.png 
```

当我尝试签入时，它只会签入那些已经版本化的文件。其余的都被默默忽略了！

关于我如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-27T23:39:03.417

您必须将该文件添加到您的工作副本中：

`svn add Assets/Placeholder Images/shopping_list_1.png`

然后您可以将其签入存储库：

`svn ci -m "Added shopping list placeholder image"`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T23:52:14.827

状态输出第一列中的问号表示该文件未被忽略，但也未被版本控制。这是 svn 的表达方式：“嗯？你想让我用这个做什么？”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T23:50:51.770

签出这个适用于 OS X 的插件。它就像适用于 Windows 用户的 TortoiseSVN。

[http://scplugin.tigris.org/](http://scplugin.tigris.org/)

# kml - 为什么我的 KML Google 地球位置打印在屏幕外？

> ID：918518
> 
> 赞同：0
> 
> 时间：2009-05-27T23:38:31.920
> 
> 标签：kml, excel, vba

我正在使用此代码制作 KML 文件：

```
Sub Create_KML()
' Builds KML from spread sheet
' Keyboard Shortcut: Ctrl+c
'
'Trash = Application _
'    .GetOpenFilename("Text Files (*.txt), *.txt")
'Open File For Random As #1 ' "c:\Users\mwilson\Desktop\Trash.txt
'Open "c:\Users\mwilson\Desktop\Test Google\Trash.txt" For Output As #1
Open "C:\Documents and Settings\eecoop\Desktop\10 day avg rssi Google kml\Trash.kml" For Output As #1
y = 9
Address = Range("B" & y) ' "203 Jordan, Tallassee, AL"
While Address <> ""
'**************
Print #1, "<?xml version=""1.0"" encoding=""utf-8""?>"         '1
Print #1, "<kml xmlns=""http://www.opengis.net/kml/2.2"">"     '2
Print #1, "   <Placemark>"                                        '3
Print #1, "     <name>George</name>"                           '4
Print #1, "        <Style>"                                     '5
Print #1, "           <IconStyle>"                              '6
Print #1, "               <scale>.3</scale>"                    '7
Print #1, "               <Icon>"                               '8
Print #1, "                  <href>Green.png</href>"             '9
Print #1, "               </Icon>"                             '10
Print #1, "            </IconStyle>"                            '11
Print #1, "        </Style>"                                     '12
Print #1, "     <address>" & Address & "</address>"    '13
Print #1, " </Placemark>"                                        '14
Print #1, "</kml>"                                               '15
Print #1, " "
'********
'    Range("A2").Select
        ID = ActiveCell.FormulaR1C1
'    Range("B2").Select
        Address = ActiveCell.FormulaR1C1
'    Range("C2").Select
'        RSSI = ActiveCell.FormulaR1C1
'    Trash.Write ("hi")

'    Print #1, ID
y = y + 1
Address = Range("B" & y)
Wend
    Close #1
End Sub 
```

在大多数情况下，它工作得很好，除了当我尝试设置`Address`等于`Range("B" & Y)`which 有字符串时：

> 203约旦，塔拉西，阿拉巴马州

当我这样做时，它会从谷歌地球的屏幕上打印出来，而如果我直接使用引用的地址，即：Address = "203 Jordan, Tallassee, AL"

它工作得很好，并绘制了它应该在哪里以及如何做。我试图确保`Address`从 Excel 单元格中提取时格式化为文本，但错误不断发生。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T23:47:32.073

尝试使用文本编辑器打开 KML，看看`<address>`在您的 2 种情况下该行的格式是否不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T23:50:04.003

我会尝试使用

```
Address("B" & y).Value
cstr(Address("B" & y)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T13:06:03.947

我想到了。输入的两个项目存在差异。

在我从老板那里得到的 Excel 文件中，他拼错了 Talassee。他只用了一个s。我也不得不改变：

```
> & Address & < 
```

到：

```
>; Address; "< 
```

现在它工作正常。此外，当您一次绘制大量点时，Google 地球尚未处理的点将显示为好像它们不在屏幕上一样。

# visual-studio - Visual Studio 2010 是否仍能使用 Visual Studio 2008 的所有插件？

> ID：918523
> 
> 赞同：3
> 
> 时间：2009-05-27T23:40:53.803
> 
> 标签：visual-studio, visual-studio-2008, visual-studio-2010

我在家里使用 Visual Studio 2k8 专业版，并为它加载了许多为我的开发定制的重要插件。

如果我得到VS2010 Pro Edition，所有这些插件都不能工作吗？这是与插件相关的问题还是与 Visual Studio 本身有关？例如，Visual Studio 2010 可能只是基于 2008 版本，但具有增强功能（是吗？）。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T23:57:21.680

您可以随时[下载测试版](http://msdn.microsoft.com/en-us/vstudio/dd582936.aspx)并试用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T23:46:37.397

没有在实践中看到它是不可能说的。严重地。我们不知道您正在使用哪些插件，所以我们不知道它们将如何对新的 VS 版本做出反应......

但是即使您告诉我们，只要在 VM 中安装 VS 2010 并试用您的插件，您就会为自己节省大量时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T23:47:50.733

不，至少 Resharper 4.5 在 VS2010 中不起作用

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T00:33:38.737

不可以。非托管插件是与 IDE 环境版本相关联的 COM 对象。在大多数情况下，插件只需要重新构建，只需进行微小的更改。

**编辑**：超出使用标准插件接口的插件可能需要为 VS2010 环境重新工具。

**编辑 2**：托管插件通常使用 .addin 文件部署，这些文件有时位于“%APPDATA%\Microsoft\MSEnvShared\Addins”中。.addin 文件是一个 xml 文件，可以手动编辑。您可以尝试将新的 HostApplication 元素添加到特定托管插件的文件中 - 并指定版本 10.0。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T19:23:54.823

以下是有关 resharper 兼容性的信息：

[http://blogs.jetbrains.com/dotnet/2009/05/preview-of-resharper-for-visual-studio-2010-coming-soon/](http://blogs.jetbrains.com/dotnet/2009/05/preview-of-resharper-for-visual-studio-2010-coming-soon/)

（基本上他们将在 6 月发布预览版）

# wcf - Silverlight WCF 服务绑定到网格 - 网格是空白的......我错过了什么吗？

> ID：918531
> 
> 赞同：0
> 
> 时间：2009-05-27T23:43:24.483
> 
> 标签：wcf, silverlight, model-view-controller, silverlight-2.0, wcf-binding

这是我的情况 - 我正在启动我的第一个 SL 应用程序，它来自 Windows 背景，其中我有 MVC 模式。我想我可以利用这种模式，所以我直接创建了一个包含 3 个项目的 SL 应用程序（解决方案）-> 1 个持有我的模型（之前的业务对象），SL 应用程序（当我选择 SL 时自动生成项目）和 1 个 SL.Web 项目（当我选择 SL 项目时自动生成）。

以下是我所做的步骤：我将一个空白网格放到我的 xaml 文件中，创建了一个服务，并且它被识别为没有任何问题。在我的 Web 项目中添加了“启用 Silverlight 的 WCF 服务”，并在我的项目中引用了我的“模型”项目。在 [OperationContract] 中，我创建了以下方法（服务）：

```
[OperationContract]
public EmployeeCollection GetEmployees()
{
     EmployeeCollection employees = Model.EmployeeCollection.GetAllEmployees();
     return employees;
} 
```

当我调试这个并设置断点时，我确实看到了员工返回的数据，所以我知道数据正在被返回。

现在，在我的 page.xaml.cs 文件中，似乎我的网格没有以某种方式填充，但不知道为什么。

我有以下片段：

```
void MyWebService_GetEmploteesCompleted(object sender, EmployeeWebService.GetEmployeesCompletedEventArgs e)
{
     dataGrid.ItemsSource = e.Result;
} 
```

我还应该去哪里寻找？我能错过什么？我是否必须添加其他代码片段才能与我的 BLL（模型）一起工作？

感谢您的任何建议。

==============================

顺便说一句，在调试时，在“自动”窗口中，我注意到 _GetEMployeesCompleted() 上出现以下值：

dataGrid.ItemSource ...... Count = 30 e.Result ...... Count = 30

为什么值没有显示在我的 DataGrid 上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T01:00:13.353

请原谅这个愚蠢的问题，但是由于我们看不到 Employee 类是如何实现的，那么您的 Employee 类是否公开了公共*属性*（不仅仅是公共成员）？您只能绑定到属性，这可能解释了 DataGrid 不自动生成列的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-22T00:30:52.170

这个问题有点老了，但我遇到了类似的问题......

你在使用主题引擎吗？我注意到在主题引擎中使用另一个控件（ChildWindow、Tab 等）内部的网格会导致子项无法呈现。我已经向工具包人员提出了一个错误，所以我们将看看它是否得到修复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T13:47:21.430

您是否在 DataGrid 上设置了 AutoGenerateColumns = true？EmployeeCollection 实现了哪些接口？

# regex - 正则表达式 - 多行问题

> ID：918537
> 
> 赞同：3
> 
> 时间：2009-05-27T23:44:45.497
> 
> 标签：regex

我想我已经筋疲力尽了，这就是为什么我看不到明显的错误。无论如何，我想要以下正则表达式：

#BIZ[.\s]*#ENDBIZ

抓住我的#BIZ 标签、#ENDBIZ 标签和标签之间的所有文本。例如，如果给定一些文本，我希望表达式匹配：

```
#BIZ
some text some test
more text
maybe some code
#ENDBIZ 
```

目前，正则表达式不匹配。我做错什么了？

# 额外细节

我在 PHP 中执行以下操作

preg_replace('/#BIZ[.\s]*#ENDBIZ/', '我的新文本', $strMultiplelines);

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T23:59:56.637

点在字符类中失去了它的特殊含义——换句话说，它`[.\s]`意味着“匹配周期或空白”。我相信你想要的是`[\s\S]`“匹配空白或非空白”。

```
preg_replace('/#BIZ[\s\S]*#ENDBIZ/', 'my new text', $strMultiplelines); 
```

**编辑：**关于点和字符类的一些信息：

默认情况下，点不匹配换行符。大多数（全部？）正则表达式实现都有一种方法来指定它也匹配换行符，但它因实现而异。以兼容的方式匹配（真正）任何字符的唯一方法是将速记类与其否定 - `[\s\S]`、`[\w\W]`或配对`[\d\D]`。以我个人的经验，第一个似乎是最常见的，可能是因为当您需要匹配换行符时使用它，并且包括`\s`清楚地表明您正在这样做。

此外，点并不是唯一在字符类中失去意义的特殊字符。事实上，在字符类中唯一特殊的字符是`^`、`-`、`\`和`]`。查看[Regular-Expressions.info 上字符类页面](http://www.regular-expressions.info/charclass.html)的“字符类中的元字符”部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T00:02:07.240

```
// Replaces all of your code with "my new text", but I do not think
// this is actually what you want based on your description.
preg_replace('/#BIZ(.+?)#ENDBIZ/s', 'my new text', $contents);

// Actually "gets" the text, which is what I think you might be looking for.
preg_match('/(#BIZ)(.+?)(#ENDBIZ)/s', $contents, $matches);
list($dummy, $startTag, $data, $endTag) = $matches; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T00:05:09.853

这应该工作

#BIZ[\s\S]*#ENDBIZ

你可以试试这个在线[正则表达式测试工具](http://gskinner.com/RegExr/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T23:47:42.230

根据您使用正则表达式的环境，可能需要特别注意正确解析多行文本，例如 Python 中的 re.DOTALL。那么那是什么环境呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T00:06:42.550

错误是`[.\s]`匹配点（不是任何字符）或空格的字符组。您可能也尝试`.*`使用`.`匹配的换行符。您可以通过启用单行选项来实现这一点（`(?s:)`在 .NET 正则表达式中执行此操作）。

```
(?s:#BIZ.*?#ENDBIZ) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T00:27:50.557

除非我遗漏了一些东西，否则你会像在[Perl](http://www.perl.com/pub/a/2003/06/06/regexps.html)中那样处理这个问题，最后加上[`/m`or`/s`](http://us2.php.net/manual/en/reference.pcre.pattern.modifiers.php)修饰符？奇怪的是，相当正确地指出这一点的[其他答案被](https://stackoverflow.com/questions/918537/whats-wrong-with-my-regex/918578#918578)[否决](https://stackoverflow.com/questions/918537/whats-wrong-with-my-regex/918558#918558)了？！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T01:23:27.450

您可以使用

```
preg_replace('/#BIZ.*?#ENDBIZ/s', 'my new text', $strMultiplelines); 
```

's' 修饰符表示“将点与任何内容匹配，甚至是换行符”。这 '？' 说不要贪心，例如：

```
foo

#BIZ
some text some test
more text
maybe some code
#ENDBIZ

bar

#BIZ
some text some test
more text
maybe some code
#ENDBIZ

hello world 
```

不贪心不会摆脱中间的“酒吧”。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-27T23:51:37.697

看起来你正在做一个 javascript 正则表达式，你需要通过`m`在表达式末尾指定标志来启用多行：

```
var re = /^deal$/mg 
```

# sql - SQL2005 + 根据内部连接表上的日期时间返回不同的结果

> ID：918551
> 
> 赞同：0
> 
> 时间：2009-05-27T23:49:13.910
> 
> 标签：sql, sql-server, sql-server-2005, tsql

我有一点时间，我想做的很简单，我认为我只是在寻找错误的解决方案。我想简单地返回一个根据相关表的日期戳排序的表。

IE：

```
Table 1:
200   MyStuff   OK
201   Other     Why
202   Flat      So

Table 2:
1  200  5/12/2009  MyValue1
2  200  5/11/2009  MyValue2
3  201  7/10/2009  MyValue3
4  201  7/08/2009  MyValue4 
```

我希望返回根据第二个表中的日期排序的第一个表，所以我的结果应该是

```
201  Other   Why
200  MyStuff OK
202  Flat    So 
```

我尝试过进行内部连接，但是我选择的不同之处在于我必须包含我排序的第二个表中的日期，因此我最终在返回表上得到了重复的 pk。

请在这里帮助我理解我的菜鸟错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T23:59:28.913

由于您可以在 Table2 中为 Table1 中的每一行设置多行，因此您必须决定如何处理日期至排序。

假设您想对最大日期戳进行排序，您可以执行以下操作：

```
select table1.*, t2.max_ds
from table1 
inner join (select id, max(datestamp) as max_ds from table2 group by id) t2
on t2.id = table1.id
order by t2.max_ds 
```

您显然必须添加一些空处理和诸如此类的东西，但这应该可以帮助您入门。

# .net - .NET 中的速度和 XML 解析 - 序列化 vs XML DOM vs？

> ID：918553
> 
> 赞同：4
> 
> 时间：2009-05-27T23:50:16.467
> 
> 标签：.net, xml, dom, parsing, xml-parsing

我以前做过 XML 解析，但从未大规模进行过。如果我正在处理许多类似于这种格式的文档：

```
<?xml version="1.0" ?>
<items comment="something...">
  <uid>6523453</uid>
  <uid>94593453</uid>
</items> 
```

解析这些文档的最快方法是什么？
1) XML DOM
2) XML 序列化 - 再水化为 .NET 对象
3) 其他一些方法

**更新**
我忘了提到平均大约有 8000 个 uid 元素。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T23:57:32.583

使用[`XmlReader`](http://msdn.microsoft.com/en-us/library/9d83k261.aspx)肯定是最快的方法，尽管你当然必须手动进行所有解析。它直接从流中读取而不缓存任何内容，尽管与 DOM 相比使用起来不太方便。

比较您建议的两个：序列化应该比使用 DOM 更快，因为（我相信）它不会将整个树缓存在内存中 - 如果您专门针对执行序列化，它当然也有一个更易于使用的界面.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T00:09:24.713

我会说 Xml 序列化将是两全其美的。您将获得易用性以及良好的速度。xml 序列化有一些额外的开销......但是，如果您手动使用 XmlReader，那么当您使用该阅读器重新创建对象图时，您至少会自行复制（如果不超过）该开销。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T02:07:26.597

根据您需要处理的数据，@Noldorin 提到的 XmlReader 是流式处理的最佳选择。如果您需要使用 XPath 对数据进行更多的 ad-hoc 样式访问，那么 XPathDocument 将比原始 XML 文档快得多。

[http://msdn.microsoft.com/en-us/library/eh3exdc4.aspx](http://msdn.microsoft.com/en-us/library/eh3exdc4.aspx)

# sql - 这是构建我的 Sql Server 数据库的坏方法吗？

> ID：918560
> 
> 赞同：1
> 
> 时间：2009-05-27T23:53:00.330
> 
> 标签：sql, architecture, views, join

我有一个表，其中包含几列，然后是 2 个最终（可为空）列，它们是 varbinary（实际上，它们是 SQL 2008 地理类型，但我想让这个帖子数据库不可知）。

我已经用大约 200K 行达到了大约 500mb。varbinary 是问题所在 - 我需要数据。

所以，我想知道如果我执行以下操作是否不好：-

*   创建一个单独的文件组：SpatialData.mdf
*   创建一个新表，分配给该新文件组。
*   将所有空间数据（读取：最后两个字段）从原始表中移出到新表中。新表具有针对原始表的外键。
*   创建一个表示两个表的视图。

现在，视图将是左外连接，因为关系是：新表与原始表的关系为零或一。

例如。

### 原始表

```
FooId INT PK NOT NULL IDENTITY
Blah VARCHAR(..) NOT NULL
Boo WHATEVER NOT NULL 
```

### 新表

```
FooID PK FK NOT NULL
Spatial_A VARBINARY(MAX)/GEOGRAPHY
Spatial_B VARBINARY(MAX)/GEOGRAPHY 
```

我想知道这是否不好的原因是视图以及视图如何在空间表上进行连接。我会经常使用视图。目前，我只是对原始表进行查询（因为新表还不存在）。通过添加此连接和 PK/FK 关系，这会影响性能吗？

为什么要拆分数据？我需要不时将实时数据库下载到我们的开发服务器。我们并不太关心这两个空间场，所以没有它们也可以。因此，要下载的数据库的大小会小很多。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T00:03:32.977

与创建第二个表、连接和创建视图不同，SQL Server 2005/2008 可能的更好解决方案是使用表分区。我记得，您可以对表进行垂直分区，并将一些列（即您的地理空间列）放在一个文件组中，而将其余列放在另一个文件组中。SQL Server 会为您处理其余的事情，您不需要为连接而烦恼，也不需要视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T02:30:15.630

您描述的方法实际上在我的经验中相当普遍。从技术上讲，如果您要将数据库规范化到最大程度，您将拥有很多这样的表，因为规范化中的一个（通常不使用）步骤包括确保没有列具有 NULL 值。

在实践中，它通常不会执行到那种程度，但是对于人口稀少的一列（或多列），将其分开并不是一个坏主意。只要表共享相同的主键（当然会被索引），性能应该不是问题。

# c# - IPostbackEventHandler 与 IPostbackDataHandler

> ID：918561
> 
> 赞同：6
> 
> 时间：2009-05-27T23:53:12.017
> 
> 标签：c#, .net, asp.net, events, postback

1）用户在*DropDownList*中选择一个项目被认为是回发数据，因此*DropDownList*实现*了 IPostbackDataHandler*。

a) 但是为什么用户不移动（在*日历*控件中）到另一个月也被视为回发数据？因此，为什么*Calendar*实现*IPostbackEventHandler*而不是*IPostbackDataHandler*？

2)
a) 我假设实现*IPostbackEventHandler*而不是*IPostbackDataHandler*的控件永远不会接收回发数据？

b) 如果控件实现*了 IPostbackDataHandler*，那么每次其数据更改时都会触发控件的回发事件，即使该控件没有导致回发

但是如果控件实现*了 IPostbackEventHandler*，那么只有该控件的回发事件才会被引发是该控件是否也触发了回发？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-28T00:18:47.597

1.  DropDownList 与日历事件接口：
    *   下拉列表中的选择被视为数据。您可以将下拉列表中的信息作为数据提交（在大多数情况下）。
    *   更改日历控件上的选择被视为一个事件，而不是提交数据的事件。它只是触发一个事件，以便代码知道更改控件的状态。
        这两者之间的区别非常微妙。
2.  文档中的文档[`IPostBackEventHandler`](http://msdn.microsoft.com/en-us/library/system.web.ui.ipostbackeventhandler.aspx)并[`IPostBackDataHandler`](http://msdn.microsoft.com/en-us/library/system.web.ui.ipostbackdatahandler.aspx)解释了它们的目的，但它们没有明确区分：
    *   `IPostBackEventHandler`用于触发不依赖于数据但依赖于用户操作的事件。例如，`Calendar`控件可以在单击日期时触发事件。此事件取决于用户的操作，而不是用户输入的数据。
    *   `IPostBackDataHandler`用于触发依赖于控件中数据的事件。例如，a`TextBox`有一个事件，只有在文本发生更改`OnTextChanged`时才应触发该事件。`TextBox`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-17T07:34:20.013

另外，实现 IPostbackDataHandler 的控件不依赖于视图状态来跨回发保留数据。

编辑：但所有控件都依赖于视图状态来保持可见性

# c# - 更新 来自自定义安装程序类操作的 .config 文件

> ID：918565
> 
> 赞同：5
> 
> 时间：2009-05-27T23:54:28.270
> 
> 标签：c#, .net, windows-installer

我尝试在安装程序期间更新我的应用程序的 .config 文件（**通过 .NET 安装程序类操作**）。但是，我似乎无法让 ConfigurationManager 列出任何属性或设置任何内容。

我从几个指向本指南的 stackoverflow 帖子中了解到这种方法：[http ://raquila.com/software/configure-app-config-application-settings-during-msi-install/](http://raquila.com/software/configure-app-config-application-settings-during-msi-install/)

我调查了我的项目和他的项目之间的差异，并注意到我的配置文件的格式不同。我相信这与我使用“设置”文件的事实有关。

指南中格式化的配置文件如下所示：

```
<?xml version="1.0" encoding="utf-8" ?>     
<configuration>     
  <appSettings>      
    <add key="Param1" value="" />      
    <add key="Param2" value="" />      
    <add key="Param3" value="" />      
  </appSettings>      
</configuration> 
```

我的样子：

```
 <?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <configSections>
        <sectionGroup name="userSettings" type="System.Configuration.UserSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
            <section name="MyAppName.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" allowExeDefinition="MachineToLocalUser" requirePermission="false" />
            <section name="MyAppName.Settings1" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" allowExeDefinition="MachineToLocalUser" requirePermission="false" />
        </sectionGroup>
        <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
            <section name="MyAppName.Settings1" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
        </sectionGroup>
    </configSections>
    <userSettings>
        <MyAppName.Properties.Settings>
            <setting name="TESTSETTING" serializeAs="String">
                <value>asdfasdfasdf</value>
            </setting>
        </MyAppName.Properties.Settings>
        <MyAppName.Settings1>
            <setting name="VerboseErrorMode" serializeAs="String">
                <value>False</value>
            </setting>
    <applicationSettings>
        <MyAppName.Settings1>
            <setting name="RunOnStartup" serializeAs="String">
                <value>True</value>
            </setting>
        </MyAppName.Settings1>
    </applicationSettings>
</configuration> 
```

为了阐明正在发生的事情......我尝试打印出这样的设置列表：

```
 Configuration config = ConfigurationManager.OpenExeConfiguration(exePath);               

            // Try getting the Settings1 Section
            AppSettingsSection appSettings = (AppSettingsSection)config.GetSection("Settings1");  // Also tried myNamespace.Settings1
            if (appSettings != null)
            {
                valList = "Settings1: ";
                foreach (string key in appSettings.Settings.AllKeys)
                {
                    string value = appSettings.Settings[key].Value;
                    valList += ("Key: '" + key + "' = '" + value + "'\n");
                }
            }
            else
            {
                valList = "appSettings was null";
            }
            MessageBox.Show(valList);

        MessageBox.Show(valList); 
```

我已经尝试了几种排列方式......并且在所有情况下输出都是“appSettings 为空”。

我还尝试以几种不同的方式初始化配置管理器......

```
 Configuration config = ConfigurationManager.OpenExeConfiguration(exePath);

            MessageBox.Show("Section Count: " + config.Sections.Count);
            MessageBox.Show("Has File: " + config.HasFile);
            MessageBox.Show("Namespace Declared: " + config.NamespaceDeclared);

            config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
            MessageBox.Show("Section Count: " + config.Sections.Count);
            MessageBox.Show("Has File: " + config.HasFile);
            MessageBox.Show("Namespace Declared: " + config.NamespaceDeclared); 
```

对于他们每个人，返回的节数都是 20。（我不知道 20 是从哪里来的……我本来希望它是 3）。
HasFile 在第一种情况下为真，在第二种情况下为假。
声明的命名空间在这两种情况下都是错误的。

谢谢！

**编辑（09 年 6 月 18 日）：**仍在调查这个问题。其他人有什么想法吗？谢谢。

搜索关键字：“对象引用未设置为未设置为实例”<- 尝试写入属性时会发生这种情况。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-08-05T07:11:32.353

我遇到了同样的问题，经过深入调查，我发现了更新配置文件（例如 app.config）的任何部分的最简单方法，那就是使用 XPath。我们有一个连接到 Web 服务的应用程序，在安装过程中，用户输入 Web 服务的 URL，这应该保存在以下 app.config 文件中：

```
 <?xml version="1.0"?>
    <configuration>
      <configSections>
        <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
          <section name="ApplicationServer.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
        </sectionGroup>
      </configSections>

      <applicationSettings>
        <ApplicationServer.Properties.Settings>
          <setting name="ApplicationServer_ApplicationServerUrl" serializeAs="String">
            <value>whatever comes from setup should go here</value>
          </setting>
        </ApplicationServer.Properties.Settings>
      </applicationSettings>
    </configuration> 
```

这是在安装程序类中执行此操作的代码：

```
public override void Install(System.Collections.IDictionary stateSaver)
    {
        base.Install(stateSaver);

        string targetDirectory = Context.Parameters["targetdir"];
        string param1 = Context.Parameters["param1"];

        string path = System.IO.Path.Combine(targetDirectory, "app.config");

        System.Xml.XmlDocument xDoc = new System.Xml.XmlDocument();

        xDoc.Load(path);

        System.Xml.XmlNode node = xDoc.SelectSingleNode("/configuration/applicationSettings/Intellisense.ApplicationServer.Properties.Settings/setting[@name='ApplicationServer_ApplicationServerUrl']/value");
        node.InnerText = (param1.EndsWith("/") ? param1 : param1 + "/");

        xDoc.Save(path); // saves the web.config file  
    } 
```

基本上，由于配置文件是基于 XML 的文档，我使用 XPath 表达式来定位特定节点并更改其值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T15:59:38.857

要尝试的一件事是将其从 install 移至 Commit 以确保在尝试访问之前先写入文件。或者，您可以使用自定义操作来编写自己的文件，只需更改配置文件以指向替代 xml 文件。

我在一个 Sharepoint 产品安装上进行了深入研究，我承认要正常工作非常乏味。我正在根据安装参数动态创建配置和批处理文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-25T16:33:23.843

您可以使用命名空间访问这些设置，`System.Configuration`但它并不像我想的那么简单，回想起来使用`System.Xml.Linq`要简单得多。无论如何，这就是我如何让它工作的。

重要的概念是，`applicationSettings`部分不是，它是由类型`AppSettings`支持的单独部分。`ClientSettingsSection`

```
//Open the application level config file
ExeConfigurationFileMap exeMap = new ExeConfigurationFileMap();
exeMap.ExeConfigFilename = String.Format("{0}.config", 
    Context.Parameters["assemblypath"]);
Configuration config = ConfigurationManager.OpenMappedExeConfiguration(exeMap,
    ConfigurationUserLevel.None);

//Get the settings section
ClientSettingsSection settingsSection =
    config.GetSectionGroup("applicationSettings").Sections
         .OfType<ClientSettingsSection>().Single();

//Update "TheSetting"
//I couldn't get the changes to persist unless
//I removed then readded the element.

SettingElement oldElement = settingsSection.Get("TheSetting");
settingsSection.Settings.Remove(oldElement);

SettingElement newElement = new SettingElement("TheSetting", 
    SettingSerializeAs.String);
newElement.Value = new SettingValueElement();
newElement.Value.ValueXml = oldElement.Value.ValueXml.CloneNode(true);
newElement.Value.ValueXml.InnerText = "Some New Value";
settingsSection.Add(newElement);

//Save the changes
config.Save(ConfigurationSaveMode.Full); 
```

所以，如您所见，很简单。:-S

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T04:59:14.553

您应该能够通过 Settings.Default 访问它，而不是通过 ConfigurationManager 访问您的设置配置。设置与其说是 .NET 功能，不如说是 Visual Studio 的一项功能……这种便利使您可以轻松地直观地设计应用程序配置，而不是在 appSettings 中手动编写或创建自定义配置部分。但是，使用设置时呈现的配置架构是非标准的，并且可能难以手动访问。

在您构建应用程序时，Visual Studio 应该已经为您生成了一个 Settings 类，并且您应该能够通过 Properties.Settings.Default 访问该类。它应该具有每个设置的属性，在您的情况下，如下所示：

```
Properties.Settings.Default.TESTSETTING
Properties.Settings.Default.VerboseErrorMode
Properties.Settings.Default.RunOnStartup 
```

您应该能够读取和写入这些设置。需要注意的关键事项...任何标记为“用户”设置的内容都不会写回 {yourapplication}.exe.config 文件...它将被写入用户隔离配置文件存储中的 User.config 文件区域。它位于 XP 上的 C:\Documents and Settings{username} 和 Vista 上的 C:\Users{username} 下的 AppData 文件夹中。根据操作系统和用户配置文件，AppData 下的子文件夹可能会发生变化，但它完全是唯一的，并且与特定版本的应用程序相关。安装较新版本将导致一组全新的配置设置存储在相同的密钥文件夹下，但版本子文件夹不同。

我希望这有帮助。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T23:50:53.293

这就是你需要的：[http ://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/f89a00eb-9400-48ce-af20-cef78002c14e](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/f89a00eb-9400-48ce-af20-cef78002c14e)

# c++ - 'size_t' 与 'container::size_type'

> ID：918567
> 
> 赞同：120
> 
> 时间：2009-05-27T23:56:56.657
> 
> 标签：c++, size-type, container-data-type

`size_t`和有区别`container::size_type`吗？

我的理解是`size_t`更通用，可以用于任何`size_type`s.

但是是否`container::size_type`针对特定类型的容器进行了优化？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2009-05-28T00:00:10.113

标准容器定义`size_type`为 typedef to `Allocator::size_type`（分配器是一个模板参数），它`std::allocator<T>::size_type`通常**被**定义为`size_t`（或兼容类型）。因此，对于标准情况，它们是相同的。

但是，如果您使用自定义分配器，则可以使用不同的底层类型。因此`container::size_type`对于最大的一般性来说是可取的。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-05-28T10:32:40.010

*   `size_t`被定义为用于对象大小的类型，并且**取决于平台**。
*   `container::size_type`是用于容器中元素数量的类型，并且**依赖于容器**。

所有`std`容器都`size_t`用作`size_type`，但每个独立的库供应商都会选择一种它认为适合其容器的类型。

如果您查看[qt](/questions/tagged/qt "显示标记为“qt”的问题")，您会发现`size_type`Qt 容器的 是依赖于版本的。在 Qt3 中它是`unsigned int`，在 Qt4 中它被更改为`int`.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-28T00:14:14.593

对于`std::[w]string`,`std::[w]string::size_type`等于`std::allocator<T>::size_type`, 等于`std::size_t`. 对于其他容器，它是一些实现定义的无符号整数类型。

有时，拥有确切的类型很有用，例如，知道类型环绕到 (like, to `UINT_MAX`) 的位置，以便可以使用它。或者对于模板，您确实需要将两个相同的类型传递给函数/类模板。

无论如何，我经常发现我使用`size_t`简洁或迭代器。在通用代码中，由于您通常不知道您的模板与哪个容器实例一起使用以及这些容器的大小，因此`Container::size_type`如果您需要存储容器大小，则必须使用 typedef。

# iis - 如何使用 Cassini 进行 IIS 样式压缩？

> ID：918579
> 
> 赞同：2
> 
> 时间：2009-05-28T00:03:04.930
> 
> 标签：iis, cassini

我在生产 IIS 框中打开了 http 压缩。有没有办法在 Cassini Web 服务器（VS200x 附带）中打开它？

这样做的原因是我得到了倾斜的性能结果，并且希望我的开发环境中的带宽能够反映生产环境的带宽。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T00:19:35.020

我知道如何做到这一点的唯一方法是，如果您实现自己的[压缩模块](http://madskristensen.net/post/HTTP-compression-in-ASPNET-20.aspx)来直接处理此问题，而不是依赖服务器，您就可以从 Cassini 中获得压缩。如果您希望服务器透明地为您处理此问题，我不认为 Cassini 是为此而构建或设计的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T00:28:10.057

您可以自己验证这是不可能的，[源代码是 public](http://weblogs.asp.net/scottgu/archive/2005/10/16/427648.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T02:44:33.833

显然，您没有遵循最佳实践。

您需要在开发阶段之后设置测试环境。此测试环境必须与您的部署框完全相同。然后您可以模拟到测试盒的流量以发现问题。测试完成后，您就可以开始部署了。

Cassini 仅用于开发目的，因此将其用于测试目的是没有意义的。

# version-control - 分支规范中的 Perforce 通配符问题

> ID：918583
> 
> 赞同：4
> 
> 时间：2009-05-28T00:04:16.610
> 
> 标签：version-control, branch, perforce

在分支规范中，我有以下观点：

```
//depot/dev/t/a/g/... //depot/dev/t/r/g/...
-//depot/dev/t/a/g/p/o*/... //depot/dev/t/r/g/p/... 
```

Perforce 为那里的第二条规则报告了“不兼容的通配符”。

我想做的是排除所有以“o”开头的目录。

我做错了什么，我该如何解决？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-28T00:11:58.000

我认为您需要在每个映射的两侧都有匹配的通配符。尝试：

```
//depot/dev/t/a/g/... //depot/dev/t/r/g/...
-//depot/dev/t/a/g/p/o*/... //depot/dev/t/r/g/p/o*/... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-18T22:59:32.107

虽然不是对这个问题的直接回答（上面已经回答），但我被同一条消息难住了，并在尝试寻找解决方案时发现了这篇文章。

就我而言，这是因为从另一个文件复制粘贴工作区映射时，放置了省略号字符而不是 Perforce“...”通配符。为了解决这个问题，我删除了省略号并通过键入三个句点来替换它。

# sql - （难题）如何将表的特定行存储在不同的 sql server 中？

> ID：918587
> 
> 赞同：0
> 
> 时间：2009-05-28T00:05:26.623
> 
> 标签：sql, sql-server, replication

我这里有一点架构问题。假设我有两个表**Teacher**和**Student**，它们都在不同的服务器上。由于这个表共享很多数据和功能，我想使用[这个继承方案](http://www.sqlteam.com/article/implementing-table-inheritance-in-sql-server)并创建一个**People**表；但是，我需要将**教师**表和与**教师相关的****人员**记录保存在一个服务器中，将**学生**表和与**学生相关的****人员**记录保存在另一台服务器中。这是主要开发人员提出的要求，因为我们有太多（我的意思是太多）**教师**和************Student**，并且包含所有 People 的单个数据库将崩溃。此外，客户端**需要**将它们放在不同的服务器上（叹气*）。**********

 ****我真的很想实现继承方案，因为很多功能可以在数据库之间共享。有没有办法做到这一点？任何其他可能适合此类问题的架构？我只是疯了吗？

- - 编辑 - -

好吧，我本身并没有真正的教师和学生，我只是用这些名字来简化我的解释。事实是，大约有 9 个子表会继承超级表，它们都在单独的服务器中用于单独的应用程序，不，我没有[这个](http://www.wintercorp.com/VLDB/2005%5FTopTen%5FSurvey/TopTenWinners%5F2005.asp)类型的数据库，但是对于我们拥有的交易量，我们有相当低端的服务器；）。你说得对，我的陈述有点夸张，对此我深表歉意，只是为了让你们更快地回答（对不起：P）。不同的服务器比其他任何东西都更像是一种业务限制（尽管主要开发人员确实说存储 SuperTable 的通用数据库会在它自己的重量下崩溃 - 他的话，不是我的：S）。我们的客户不喜欢他们的信息与其他客户的信息混合在一起，所以我们必须将他们的信息放在不同的服务器上——这很愚蠢，但是决策者已经说过:(。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T00:22:49.007

您在什么假设下确定您有太多数据？我很确定你可以列出世界上的每一位老师和学生，而不会让 SQL Server 感到悲伤。

这似乎是一个武断的决定，将对您设计的任何解决方案的复杂性产生重大影响。

看看[这里](http://www.wintercorp.com/VLDB/2005_TopTen_Survey/TopTenWinners_2005.asp)- 我敢肯定，您不会以接近本页所示规模的任何方式来衡量您的数据库，并且其中许多数据库都在 SQL Server 上运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T00:15:39.990

我不确定这是否可以专门用于 SQL Server，但它闻起来像是可以通过集群和表空间分区解决的问题。

我想知道的是这是否真的是一个很好的要求；它基于一个非常简单的断言（即数据过多）引入了许多技术复杂性。您是否尝试过验证这一点？一个简单的测试是创建一个简单的模式并用虚拟数据填充它，以获得您在生产中期望的行数。在您走得太远以实现此“要求”之前执行此测试可能符合您的最佳利益。

顺便说一句，您链接到的模式类型是[类表继承模式](http://www.martinfowler.com/eaaCatalog/classTableInheritance.html)的一个示例。

您可以为这个项目实现一个[域模型](http://www.martinfowler.com/eaaCatalog/domainModel.html)，其中的通用属性`Teacher`和`Student`由`Person`编写通用操作的接口或基类描述。如果您计划广泛使用存储过程，这可能不是一个有用的选项，但需要考虑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T00:19:19.000

我认为 Paul 是正确的——也许看看你的硬件基础设施而不是你的数据库模式。

使用集群、适当的索引以及可能的数据归档方案*应该可以*解决任何性能问题。继承方案似乎是最好的数据模型。

可以将数据拆分到多台服务器上并保留该方案，但我认为与查看集群/正确索引相比，您肯定会遇到更多的性能问题。通过设置链接服务器，您可以进行跨服务器查询。

例如学生查询

```
SELECT *
FROM SERVER_A.People.dbo.Persons P
    INNER JOIN SERVER_B.People.dbo.Students S
        ON P.PersonID = S.PersonID 
```

--EDIT-- 正如 Paul 所说，您可以在抽象层中执行数据库分离。

例如，让您的 Student 类扩展您的 Person 类。在您的 Person 类构造函数中，让它连接到服务器 A 以填充可用的字段。在您的学生类构造函数中，让它连接到服务器 B（Person 属性将已由 Person 构造函数填充）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T00:34:51.293

我和 Aaron 在一起 (sup Aaron)。将表移动到单个数据库中。SQL Server 可以轻松处理每个表的数十亿行（我在 6-7 年前在 SQL 2000 上完成过，所以现代版本和现代硬件都没有问题）。只要您的表被正确索引 世界上每所学校可能一直没有足够的学生来使 SQL Server 过载的情况在单一学校就更少了。

在这种情况下，您的最佳做法是将表放在同一数据库中的同一台服务器上，并为它们编制索引以获得更好的性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T00:37:25.623

太多记录导致“数据库崩溃”？那个首席开发者抽的是什么锅？给力的东西！

我建议你们先研究[分区表](http://msdn.microsoft.com/en-us/library/ms345146.aspx)。使应用程序分布式（实际上是两台服务器方法所暗示的）比您想象的要困难得多，而且它不**提供**可伸缩性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T00:50:42.633

是的，我必须同意这里的其他人，单数据库，单服务器就可以了。扩展您的硬件以支持工作负载比扩展到联合服务器要容易且便宜得多。我只知道一个地方有联合服务器，他们的工作量是惊人的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T00:59:03.647

链接服务器并创建视图

```
SELECT
  FirstName
    ,LastName
    ....
  FROM server.database.owner.Teachers
UNION
  FirstName
    ,LastName
    ....
  FROM server.database.owner.Students 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-28T01:24:10.053

你使用什么样的客户端？如果您使用的是 Java 客户端，并且正在使用 ORM，您可能需要查看[Hibernate Shards](https://www.hibernate.org/414.html)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-28T01:35:29.173

除了这里所有的好答案之外，问题背后的假设是非常值得怀疑的，如果我需要认真做这件事（并且如果我认为假设是真的）我会比较 Oracle 必须提供的东西，因为它是在这种类型的场景中它显示了一个好处（我是根据经验说的）。

但是在核心问题上，假设您概述的假设是正确的，我不会尝试组合表格。如果教师和学生不能在同一个数据库中，他们的身份信息就不太可能，如果数据量很大，那么将它们全部放在一个表中会更糟。

我怀疑的是，如果基本假设是真的，那是因为预计会有很多表上的争用以及表上的大量连接和活动，从而导致大量锁定。在这种情况下，添加一个 Person 表会使事情变得更糟。

话虽如此，如果您仍然真的想这样做，那么您可以通过链接数据库在查询中从另一个数据库引用一个数据库。

但是，如果真正的问题是表周围的连接数量、争用和死锁，那么这样的解决方案会使事情变得更糟。

编辑：对于那些质疑甲骨文会在这种情况下带来什么优势的人，我们将在联合数据库领域进行回应，该领域更加成熟。另一个是在您有大量争用的表中，它在某些情况下会复制数据，并且通常在处理争用时它的模型更加复杂。例如，在运行时间较长的查询中读取表的场景，会导致大量潜在的读锁。Oracle 可帮助您保持事务完整性，而无需锁定读取。在 MS-SQL 中，您必须求助于脏读。

MS-SQL 是一个很好的数据库，但它有其局限性（但是，没有关于读写量的任何特定参数的原始数据量并不是其中之一，这使得问题变得奇怪）。考虑到激烈的竞争，非企业版的甲骨文在价格上确实非常接近，值得一看。它最终可能会让你付出很多代价。

当然，如果您已经购买了 MS-SQL 许可证，Oracle 的成本因素更大，因此收益必须更加明显。

# javascript - Javascript 通过 ExternalInterface 闪烁

> ID：918588
> 
> 赞同：2
> 
> 时间：2009-05-28T00:05:52.117
> 
> 标签：javascript, flash, actionscript-3, externalinterface

我想知道是否有人可以查看我的代码。我正在尝试使用以下代码将虚拟变量从 javascript 传递到 actionscript 3：

HTML：
`<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
id="music_player" width="500" height="375"
codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab">
<param name="movie" value="music_player.swf" />
<param name="quality" value="high" />
<param name="bgcolor" value="#869ca7" />
<param name="allowScriptAccess" value="always" />
<embed src="music_player.swf" quality="high" bgcolor="#869ca7"
width="500" height="375" name="music_player" align="middle"
play="true" loop="false" quality="high" allowScriptAccess="always"
type="application/x-shockwave-flash"
pluginspage="http://www.macromedia.com/go/getflashplayer">
</embed>
</object>`

Javascript:
var nextTrackLocation = "dummyString";
getFlashMovie("music_player").jsAlert(nextTrackLocation);

```
function getFlashMovie(movieName) {
  var isIE = navigator.appName.indexOf("Microsoft") != -1;
  return (isIE) ? window[movieName] : document[movieName];  } 
```

和动作脚本：
ExternalInterface.addCallback("getNextTrack", jsAlert);

```
function jsAlert(mess){
ExternalInterface.call("alert", mess);
} 
```

有人看到错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T01:18:55.807

你的问题非常令人困惑。我认为你在这里犯了两个错误。

从 Javascript 中，您尝试在 Actionscript 中调用一个名为“jsAlert”的函数，但该函数在 Actionscript 中公开为“getNextTrack”。我认为应该是：

```
getFlashMovie("music_player").getNextTrack(nextTrackLocation); 
```

其次，在 Actionscript 中定义函数时，您忽略了 ExternalInterface.addCallback 实际上采用三个参数。

```
ExternalInterface.addCallback("getNextTrack", null, jsAlert); 
```

# scala - Scala 中的单撇号是什么意思？

> ID：918590
> 
> 赞同：63
> 
> 时间：2009-05-28T00:08:35.527
> 
> 标签：scala, actor

[在ScalaActors.pdf](http://lamp.epfl.ch/~phaller/doc/ScalaActors.pdf)上的这张幻灯片中，当消息发送到 pong actor 时，单引号表示什么？

```
class Ping(count: int, pong: Pong) extends Actor {
def act() {
   pong ! 'Ping // what does the single quote indicate???
      receive {
         case 'Pong =>
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-28T00:22:13.737

它表示一个符号。例如。cfr [http://www.scala-lang.org/docu/files/api/scala/Symbol.html](http://www.scala-lang.org/docu/files/api/scala/Symbol.html)：

> Scala 术语 'mysym 将以下列方式调用 Symbol 类的构造函数：Symbol("mysym")。

# sql - 针对一对多/多对一情况的推荐表设置

> ID：918593
> 
> 赞同：0
> 
> 时间：2009-05-28T00:08:58.910
> 
> 标签：sql, architecture, one-to-many

我需要创建一个脚本，有人会在其中发布职位空缺，任何有资格的人都会看到空缺，但任何不符合条件（或选择退出）的人都不会看到空缺。因此，两个人可以访问同一个页面并看到不同的内容，有些可能相同，有些则完全不同。我不确定在 MySQL 数据库/表中安排数据的最佳方式。

例如，我可以通过发布来安排它，但这看起来有点像：

```
 PostID   VisibleTo
 PostingA    user1,user2 
```

这似乎是错误的（列中的 CSV 样式）。或者我可以一个人去：

```
User   VisiblePosts 
```

用户 1 发帖 1，发帖 2

但这是同样的问题。有没有办法让用户的独特，发布独特，并让他们只在他们匹配的地方加入？

该决定最初是通过对另一组表进行一系列查询来做出的，但是一旦运行，当用户发布职位后它不会改变时，让一些代码块一次又一次地运行似乎效率低下。

...再想一想，它可能会改变，但如果我们假设它不会改变（因为它不太可能，并且如果用户看到他们不再有资格的东西，那么后果很小），是否有一个标准的解决方案设想？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T00:14:04.517

三张桌子...

用户：[UserId] [OtherField]

帖子：[PostId] [OtherFields]

用户帖子：[用户 ID] [帖子 ID]

User.UserId 加入 UserPost.UserId，Post.PostId 加入 UserPost.PostId

然后查找表格 UserPost，当您选择要显示的帖子时加入 Post

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T00:14:51.847

这是一个多对多关系或 n:m 关系。

You would create an additional table, say `PostVisibility`, with a column `PostID` and `UserID`. If a combination of `PostID` and `UserID` is present in the table, that post is visible to that user.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T00:14:48.570

编辑：抱歉，我认为您是在使用多对多的发布用户术语。我是从张贴“观看权”条款的角度考虑这一点的，这是一对多的。

~~除非我遗漏了什么，否则这是一对多的情况，需要两张表。例如，每个帖子都有 n 个可以查看的用户。帖子对单个用户来说是唯一的，因此您无需执行相反的操作。~~

*   带有 PostingID（和其他数据）的 PostingTable

*   带有 PostingID 和 UserID 的 PostingVisibilityTable

*   具有 UserID 和用户数据的 UserTable

独立于其可见性权限创建发布，然后针对可见性表单独添加/删除 PostingID/UserID 对。

选择当前用户可见的所有帖子：

```
SELECT * FROM PostingTable A INNER JOIN PostingVisibilityTable B ON A.PostingID = B.PostingID WHERE B.UserID = "currentUserID" 
```

# html - 各种网站分析方法的优缺点是什么？

> ID：918605
> 
> 赞同：3
> 
> 时间：2009-05-28T00:16:35.930
> 
> 标签：html, firefox, iframe, yql, add-on

我想编写一些代码来查看网站及其资产并创建一些统计数据和报告。资产将包括图像。我希望能够跟踪链接，或者至少尝试识别页面上的菜单。我还想根据类名等猜测一下 CMS 创建了该站点的原因。

我将假设该站点是相当静态的，或者由 CMS 驱动，但与 RIA 不同。

关于我如何进步的想法。

1) 将网站加载到 iFrame 中。这会很好，因为我可以用 jQuery 解析它。或者我可以吗？似乎我会受到跨站点脚本规则的阻碍。我已经看到解决这些问题的建议，但我假设浏览器将继续压制这些问题。小书签会有帮助吗？

2) 一个火狐插件。这可以让我解决跨站点脚本问题，对吗？似乎可行，因为 Firefox（和 GreaseMonkey，就此而言）的调试工具可以让你做各种各样的事情。

3) 在服务器端抓取网站。使用服务器上的库进行解析。

4) YQL。这不是为解析站点而构建的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T13:22:44.363

我的建议是：

a) 选择一种脚本语言。我建议 Perl 或 Python：还有 curl+bash，但没有异常处理很糟糕。

b) 通过脚本加载主页，使用 python 或 perl 库。试试 Perl [WWW::Mechanize](http://metacpan.org/pod/WWW::Mechanize::Examples)模块。

Python 有很多内置模块，试试看 www.feedparser.org

c) 检查服务器标头（通过 HTTP HEAD 命令）以查找应用程序服务器名称。如果幸运的话，您还会找到 CMS 名称（id WordPress 等）。

d) 使用 Google XML API 询问“link:sitedomain.com”之类的内容以查找指向该站点的链接：您将再次在 google 主页上找到 Python 的代码示例。向 Google 询问域名排名也会有所帮助。

e)您可以在 SQLite 数据库中收集数据，然后在 Excel 中对其进行后期处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T01:27:09.767

您应该简单地获取源代码 (XHTML/HTML) 并对其进行解析。你几乎可以用任何现代编程语言来做到这一点。从您自己的连接到 Internet 的计算机。

iframe 是用于显示 HTML 内容的小部件，它不是用于数据分析的技术。您可以在不显示任何地方的情况下分析数据。你甚至不需要浏览器。

对于您的任务，Python、Java、PHP 等语言的工具肯定比 Javascript 或您在那些 Firefox 扩展中拥有的任何工具更强大。

网站背后的技术也无关紧要。XHTML/HTML 只是一个字符串，不管浏览器如何呈现它。要找到您的“资产”，您只需查找特定的 HTML 标签，如“img”、“object”等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-31T09:10:20.573

我认为为[Firebug](http://getfirebug.com/)编写扩展可能是最简单的方法之一。例如， [YSlow](http://developer.yahoo.com/yslow/)是在 Firebug 之上开发的，它提供了一些您正在寻找的功能（例如图像、CSS 和 Javascript-summaries）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-05T17:39:50.717

我建议您首先尝试选项 #4 (YQL)：原因是它看起来可能会为您提供所需的所有数据，然后您可以将您的工具构建为网站，或者您可以在没有实际的情况下获取有关网站的信息必须转到浏览器中的页面。如果 YQL 可以满足您的需求，那么您似乎可以使用此选项获得最大的灵活性。

如果 YQL 没有成功，那么我建议您使用选项 #2（firefox 插件）。

我认为您可能应该*尝试*远离选项 #1（Iframe），因为您已经知道跨站点脚本问题。

此外，我使用了选项#3（在服务器端抓取网站），我过去遇到的一个问题是网站在使用 AJAX 调用之后被抓取加载内容。当时我没有找到一个很好的方法来获取使用 AJAX 的页面的全部内容——所以要小心那个障碍！这里的其他人也遇到过这种情况，请参阅：[Scrape a dynamic website](https://stackoverflow.com/questions/206855/scrape-a-dynamic-website)

**AJAX 动态内容问题：** 可能有一些解决 ajax 问题的方法，例如使用 AJAX 本身抓取内容并使用 evalScripts:true 参数。请参阅以下文章以获取更多信息以及您可能需要注意的有关从被抓取内容中评估 javascript 如何工作的问题：

原型库： http: [//www.prototypejs.org/api/ajax/updater](http://www.prototypejs.org/api/ajax/updater)

留言板：[http ://www.crackajax.net/forums/index.php?action=vthread&forum=3&topic=17](http://www.crackajax.net/forums/index.php?action=vthread&forum=3&topic=17)

或者如果你愿意花钱，看看这个： [http ://aptana.com/jaxer/guide/develop_sandbox.html](http://aptana.com/jaxer/guide/develop_sandbox.html)

这是一个丑陋（但可能有用）的示例，它使用称为 WebRobot 的 .NET 组件从支持动态 AJAX 的站点（例如 Digg.com）中抓取内容。 [http://www.vbdotnetheaven.com/UploadFile/fsjr/ajaxwebscraping09072006000229AM/ajaxwebscraping.aspx](http://www.vbdotnetheaven.com/UploadFile/fsjr/ajaxwebscraping09072006000229AM/ajaxwebscraping.aspx)

这里还有一篇关于使用 PHP 和 Curl 库从网页中删除所有链接的一般文章。但是，我不确定这篇文章和 Curl 库是否涵盖了 AJAX 内容问题： [http ://www.merchantos.com/makebeta/php/scraping-links-with-php/](http://www.merchantos.com/makebeta/php/scraping-links-with-php/)

我刚刚想到的一件事可能会起作用：

1.  抓取内容并使用 AJAX 对其进行评估。
2.  将内容发送到您的服务器。
3.  评估页面、链接等。
4.  [可选] 将内容保存为服务器上的本地页面。
5.  将统计信息返回到页面。
6.  [可选] 高亮显示缓存的本地版本。

^注意：如果保存本地版本，您将需要使用正则表达式将相对链接路径（尤其是图像）转换为正确的。

祝你好运！请注意 AJAX 问题。现在许多网站使用 AJAX 动态加载内容。Digg.com 有，MSN.com 有它的新闻提要，等等......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T15:19:22.087

这实际上取决于您的项目规模。如果它只是随意的，而不是完全自动化的，我强烈建议使用 Firefox 插件。

我正处于类似项目的中间。它必须分析使用 Javascript 生成的页面的 DOM。编写服务器端浏览器太难了，所以我们转向了其他一些技术：Adobe AIR、Firefox Addons、用户脚本等。

如果您不需要自动化，Fx 插件很棒。脚本可以分析页面，向您显示结果，要求您更正不确定的部分，最后将数据发布到某个后端。你可以访问所有的 DOM，所以你不需要编写一个 JS/CSS/HTML/任何解析器（那将是一个地狱般的工作！）

另一种方法是 Adob​​e AIR。在这里，您可以更好地控制应用程序——您可以在后台启动它，在没有您交互的情况下进行所有解析和分析。缺点是——您无法访问页面的所有 DOM。解决这个问题的唯一方法是设置一个简单的代理，它获取目标 URL，添加一些 Javascript（以创建一个受信任的不受信任的沙箱桥）……这是一个肮脏的 hack，但它有效。

*编辑：* 在 Adob​​e AIR 中，有两种方法可以访问国外网站的 DOM：

*   通过 Ajax 加载它，创建 HTMLLoader 对象，并将响应输入其中（`loadString`方法 IIRC）
*   创建一个 iframe，并将站点加载到不受信任的沙箱中。

我不记得为什么，但第一种方法对我来说失败了，所以我不得不使用另一种（我认为涉及一些安全原因，我无法解决）。而且我必须创建一个沙箱来访问站点的 DOM。这里有一些关于[处理沙盒桥](http://www.sitepen.com/blog/2008/08/21/building-on-air-working-with-the-sandbox-bridges/)的内容。这个想法是创建一个代理，添加一个简单的 JS，创建`childSandboxBridge`一些方法并将其公开给父级（在本例中：AIR 应用程序）。脚本内容类似于：

```
window.childSandboxBridge = {
   // ... some methods returning data
} 
```

（小心——通过沙箱桥传递的内容是有限制的——肯定没有复杂的对象！只使用原始类型）

因此，代理基本上篡改了所有返回 HTML 或 XHTML 的请求。所有其他都只是通过不变。我已经使用 Apache + PHP 完成了这项工作，但肯定可以使用带有一些插件/自定义模块的真正代理来完成。这样我就可以访问任何站点的 DOM。

*编辑结束*。

我知道的第三种方式，也是最难的方式——设置一个类似于[browsershots](http://browsershots.org/)的环境。然后，您将使用具有自动化功能的 Firefox。如果您的服务器上有 Mac OS X，您可以使用 ActionScript 来为您执行自动化操作。

## 所以，总结一下：

*   PHP/服务器端脚本——您必须实现自己的浏览器、JS 引擎、CSS 解析器等。完全在控制之下并实现自动化。
*   Firefox Addon — 可以访问 DOM 和所有东西。需要用户操作它（或至少一个具有某种自动重载功能的打开的 Firefox 会话）。用户界面很好，可以指导整个过程。
*   Adobe AIR — 需要一台可以工作的台式计算机，比创建 Fx 插件更困难，但更强大。
*   自动化浏览器 — 更多的是 Web 开发的桌面编程问题。可以在没有图形环境的linux终端上设置。需要掌握黑客技能。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-05T19:21:03.997

现在主要是 .Net 程序员，我的建议是使用 C# 或其他带有 .Net 绑定的语言。使用[WebBrowser](http://msdn.microsoft.com/en-us/library/system.windows.forms.htmldocument.aspx)控件加载页面，然后遍历文档中的元素（通过[GetElementsByTagName()](http://msdn.microsoft.com/en-us/library/system.windows.forms.htmldocument.getelementsbytagname.aspx)）以获取链接、图像等。通过一些额外的工作（解析 BASE 标记，如果可用），您可以解决src 和 href 属性添加到 URL 中，并使用[HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)为目标图像发送 HEAD 请求以确定它们的大小。这应该让您了解页面的图形密集程度，如果这是您感兴趣的内容。您可能有兴趣包含在统计信息中的其他项目可能包括反向链接/页面排名（通过 Google API），页面是否[验证为 HTML 或 XHTML](http://validator.w3.org/)，链接到同一域中的 URL 与非站点链接的百分比，以及如果可能的话，Google 对各种搜索字符串页面的排名（但不知道是否可以通过编程方式获得）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-05T20:57:49.090

我会使用一个脚本（或根据选择的语言编译的应用程序），该脚本是用一种对网络和文本解析/正则表达式有强大支持的语言编写的。

*   Perl
*   Python
*   .NET 语言选择
*   爪哇

任何您最熟悉的语言。一个基本的独立脚本/应用程序让您无需过多担心浏览器集成和安全问题。

# sql-server - 在我的数据库中搜索此数据的最有效设计？

> ID：918607
> 
> 赞同：0
> 
> 时间：2009-05-28T00:19:06.830
> 
> 标签：sql-server, architecture, full-text-search, views

我有以下数据库表和一个*表示*该数据的视图。这些表格是*分层*的（如果你是这样描述的）：-

> 编辑：我已经用 FAKE 表名称/数据（对于这篇文章）替换了我的 3 个表，因为我在 NDA 下不发布任何关于项目等的内容。所以是的.. 我并没有真正保存这样的人名:)

### 名字

```
FirstNameId INT PK NOT NULL IDENTITY
Name VARCHAR(100) 
```

### 中间名

```
MiddleNameId INT PK NOT NULL IDENTITY
Name VARCHAR(100) NOT NULL
FirstNameId INT FK NOT NULL 
```

### 姓氏

```
SurnameId INT PK NOT NULL IDENTITY
Name VARCHAR(100) NOT NULL
FirstNameId INT FK NOT NULL 
```

因此，名字是父表，其他两个表是子表。

景色看起来...

### 人名

```
FirstNameId
FirstName
MiddleNameId
MiddleName
SurnameId
Surname 
```

这是一些示例数据。

```
FNID FN   MNID    MN     SNID  SN
-----------------------------------
  1  Joe    1   BlahBlah   1  Blogs
  2  Jane   -    -         1  Blogs
  3  Jon    -    -         2  Skeet 
```

现在问题来了。**如何有效地搜索视图上的名称**？我本来打算有一个全文搜索/目录，但我不能把它放在一个视图上（或者至少我不能让它使用 GUI 对一个视图工作）。

编辑#2：以下是一些示例搜索查询：-

```
exec uspSearchForPeople 'joe blogs'  (1 result)
exec uspSearchForPeople 'joe'        (1 result)
exec uspSearchForPeople 'blogs'      (2 results)
exec uspSearchForPeople 'jon skeet'  (1 result)
exec uspSearchForPeople 'skeet'      (1 result) 
```

我应该用全名生成一个新表吗？那看起来怎么样？

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T01:55:16.607

I would have just one table with a name type column (first, middle, last) and an FK onto itself with the clustered index on the name column.

```
 CREATE TABLE [Name] (
        NameID INT NOT NULL IDENTITY,
        [Name] varchar(100) not null,
        NameType varchar(1) not null,
        FirstNameID int null,
    )

    ALTER TABLE [Name] ADD CONSTRAINT PK_Name  PRIMARY KEY NONCLUSTERED (NameID)
    ALTER TABLE [Name] ADD CONSTRAINT FK_Name_FirstNameID FOREIGN KEY (FirstNameID) REFERENCES [Name](NameID)
    CREATE CLUSTERED INDEX IC_Name ON [Name] ([Name], NameType)

    DECLARE @fid int
    INSERT [Name] ([Name], NameType, FirstNameID) VALUES ('Joe', 'F', NULL)
    SELECT @fid = scope_identity()
    INSERT [Name] ([Name], NameType, FirstNameID) VALUES ('BlahBlah', 'M', @fid)
    INSERT [Name] ([Name], NameType, FirstNameID) VALUES ('Blogs', 'L', @fid)

    INSERT [Name] ([Name], NameType, FirstNameID) VALUES ('Jane', 'F', NULL)
    SELECT @fid = scope_identity()
    INSERT [Name] ([Name], NameType, FirstNameID) VALUES ('Blogs', 'L', @fid)

    INSERT [Name] ([Name], NameType, FirstNameID) VALUES ('Jon', 'F', NULL)
    SELECT @fid = scope_identity()
    INSERT [Name] ([Name], NameType, FirstNameID) VALUES ('Skeet', 'L', @fid) 
```

You could then build a dynamic but paramterized WHERE clause based on the number of values to search (or hard-code them for that matter assuming there are only at most 3) using sp_executsql in a stored proc, linq to sql, or even ugly string manipulation in code.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-19T17:19:12.203

我认为你想要的是一个**索引表**。这些表中有多少表和列并不重要，因为将内容插入到它被索引的数据库中。前任。

我会为你的名字推荐一张桌子。

```
NameTable
----------
Id
FirstName
MiddleName
LastName 
```

您可以拥有任意数量的普通表...

```
IndexTable
----------
Id
Text 
```

您可以使用文本作为主键，但我总是有一个单独的 id 列作为主键（只是习惯）。

```
IndexItemTable
----------
Id
IndexId // Has a foreign key reference to IndexTable Id
ReferenceId // The record Id of where the text occures
ReferenceTable // The table where the  text occures 
```

然后，当您插入名称“Jim Barbarovic Fleming”时，您还将扫描您的索引并发现它为空并为 Jim、Barbarovich 和 Fleming 创建 3 个新记录，它们都将具有相同的 referenceId，并且 ReferenceTable 将是“NameTable”然后您插入另一条记录，例如“Jim Bradley Fleming”，您将扫描索引表并看到您已经拥有“Jim”和“Fleming”的值，因此您只需创建 IndexItem 的 referenceId 为 2，ReferenceTable 为“NameTable”。

通过构建和索引，您可以通过单个文本框搜索并查找数据库中具有这些值的所有记录/字段。

**注意：**当您将索引插入到大写或小写然后使用 equals(value, OrdinalIgnoreCase) 时，您会想要更改所有内容。

**编辑：** 我不能只上传图片。我想我必须将它托管在某个地方，但它与我上面放置的表格图没有任何不同。IndexTable 的唯一关系是与 IndexItemTable。我会在代码中完成其余的工作。前任。

在名称表中插入或更新新记录期间，您必须：

1.  扫描 IndexTable 并查看 NameTable 中的每个字段是否存在。

2.  如果他们不这样做，您将在索引表中添加一条新记录，其中包含未找到的文本。如果他们这样做，请继续执行第 3 步。

3.  在 IndexItemTable 中添加一条记录，带有 referenceId（NameTable 中记录的 id）和 ReferenceTable（NameTable），然后是在 IndexTable 中找到的文本的 IndexId。

然后，当他们通过您的单个文本框进行搜索时，您搜索索引表中的每个单词并从 NameTable 中返回在 IndexTable 中引用的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T01:17:40.863

疯狂的设计，可能是假表名让它变得比实际更奇怪。

根据选择使用情况创建索引。

如果您正在搜索像“Joe”这样的实际名字，您需要在 FirstNames.Name 上建立索引

如果您正在搜索像 123 这样的名字 id，您有一个索引：FirstNames.FirstNameId

如果您想在 FirstNames.name 和/或 MiddleNames.name 和/或 Surnames.name 上进行搜索，您需要对您将使用的组合进行索引，并且您所做的越多，查询就越难选择最佳组合.

放弃视图并为此目的编写专用查询：

追求第一/中间

```
select
  FirstNames.name
    ,MiddleNames.name
    ,Surnames.name
  FROM FirstNames
    INNER JOIN MiddleNames ON FirstNames.FirstNameId=MiddleNames.FirstNameId 
    INNER JOIN Surnames ON FirstNames.FirstNameId=Surnames.FirstNameId 
  WHERE FirstNames.Name='John'
    AND MiddleNames.Name='Q' 
```

最后一个

```
select
  FirstNames.name
    ,MiddleNames.name
    ,Surnames.name
  FROM Surnames 
    INNER JOIN FirstNames ON Surnames.FirstNameId =FirstNames.FirstNameId
    INNER JOIN MiddleNames ON FirstNames.FirstNameId=MiddleNames.FirstNameId 
  WHERE Surnames.Name='Public' 
```

只需确保您有索引来覆盖“where”子句中的主表

使用 SET SHOWPLAN_ALL ON 确保您使用的是索引（“扫描”是不好的“搜索”是好的“）

**如果可能，编辑**
在搜索之前将名称分开：

```
exec uspSearchForPeople 'joe',null,'blogs'  (1 result)
exec uspSearchForPeople 'joe',null,null     (1 result)
exec uspSearchForPeople  null,null,'blogs'  (2 results)
exec uspSearchForPeople 'jon',null,'skeet'  (1 result)
exec uspSearchForPeople null,null,'skeet'   (1 result) 
```

在存储过程中，有三个查询：

```
if @GivenFirstName is not null 
    --search from FirstNames where FirstNames.name=@value & join in other tables
else if @GivenMiddleName is not null 
    --search from MiddleNames where MiddleNames.name=@value & join in other tables
else if @GivenLastName is not null 
    --search from Surnames where Surnames.name=@value & join in other tables
else --error no names given 
```

在名称的所有三个表上都有一个索引。

如果您不能将名称分开，我认为您不走运，您将不得不对每个表中的每一行进行表扫描。

如果您不使用索引并且正在寻找名称，请考虑电话簿，您将需要阅读整本书

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T00:25:48.173

这似乎不是最合乎逻辑的设计决策。你为什么设计成这样？

您目前的索引结构是什么？3个表中每一个上的名称索引应该加快查询速度吗？

或者，进一步规范化并创建一个 Name 表并在三个表中的每一个中都有 NameID，然后索引 Name 表也应该会提高性能，但我认为索引 3 个表上的 name 字段会更容易并且也可以工作。

更新与选择的统计数据是什么，因为添加这些索引可能会导致性能下降。

# javascript - 我怎样才能让这个jQuery“收缩文本”功能更有效？使用二分搜索？

> ID：918610
> 
> 赞同：0
> 
> 时间：2009-05-28T00:19:46.050
> 
> 标签：javascript, jquery

我已经构建了 jQuery 函数，它接受一个文本字符串和一个宽度作为输入，然后缩小那段文本，直到它不大于宽度，如下所示：

```
function constrain(text, ideal_width){
    var temp = $('.temp_item');
    temp.html(text);
    var item_width = temp.width();
    var ideal = parseInt(ideal_width);
    var smaller_text = text;
    var original = text.length;

    while (item_width > ideal) {
        smaller_text = smaller_text.substr(0, (smaller_text.length-1));
        temp.html(smaller_text);
        item_width = temp.width();
    }

    var final_length = smaller_text.length;
    if (final_length != original) {
        return (smaller_text + '&hellip;');
    } else {
        return text;
    }
} 
```

这很好用，但是因为我在许多文本上调用该函数，在除 Safari 4 和 Chrome 之外的任何浏览器上，它真的很慢。

我尝试使用二进制搜索方法来提高效率，但到目前为止，我的浏览器中出现了一个缓慢的脚本对话框：

```
function constrain(text, ideal_width){
    var temp = $('.temp_item');
    temp.html(text);
    var item_width = temp.width();
    var ideal = parseInt(ideal_width);

    var lower = 0;
    var original = text.length;
    var higher = text.length;

    while (item_width != ideal) {

        var mid = parseInt((lower + higher) / 2);
        var smaller_text = text.substr(0, mid);
        temp.html(smaller_text);
        item_width = temp.width();

        if (item_width > ideal) {

            // make smaller to the mean of "lower" and this
            higher = mid - 1;

        } else {

            // make larger to the mean of "higher" and this
            lower = mid + 1;

        }
    }

    var final_length = smaller_text.length;
    if (final_length != original) {
        return (smaller_text + '&hellip;');
    } else {
        return text;
    }
} 
```

有谁知道我应该怎么做才能使这个功能尽可能高效？

谢谢！西蒙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T00:35:43.850

您的脚本的问题可能是`while`条件`(item_width != ideal)`可能永远不会中止循环。可能无法将输入文本修剪为精确的宽度`ideal`。在这种情况下，您的函数将永远循环，这将触发慢速脚本对话框。

为了避免这种情况，如果显示的文本足够小，您应该停止循环（也就是添加更多字符会使其太大）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-29T15:16:37.540

我用了 2 个 div

```
<div class="englober">
<div class="title"></div>
</div> 
```

.englober 有一个固定的 with 和 overflow:hidden, white-space:nowarp。

然后使用 jQuery，我从 .title 调整文本大小以适应 .englober：

```
while ($(".title").width() > $(".englober").width())
{
    var dFontsize = parseFloat($(".title").css("font-size"), 10);
    $(".title").css("font-size", dFontsize - 1);
} 
```

# css - css 'ex' 单位的价值是多少？

> ID：918612
> 
> 赞同：94
> 
> 时间：2009-05-28T00:21:35.233
> 
> 标签：css, specifications, units-of-measurement

（不要与流行的 .Net 单元测试库[Xunit](http://www.codeplex.com/xunit)混淆。）

今天，我无聊地开始检查 Gmail 的 DOM（是的，我很无聊）。

一切看起来都很简单，直到我注意到关于某些元素宽度的有趣规范。杰出的 Googlites 使用稀有的“前”单位指定了许多表列。

```
width: 22ex; 
```

起初我很困惑（“什么是'ex'？”），然后它又回到了我的脑海：我似乎记得几年前我第一次学习 CSS 时的一些事情。[来自 CSS3 规范](http://www.w3.org/TR/css3-values/#ex-unit)：

> [ **ex unit** is] 等于[第一个可用字体](http://www.w3.org/TR/css3-fonts/#first-available-font)的已用 x 高度。之所以称为 x 高度，是因为它通常等于小写字母“x”的高度。但是，即使对于不包含“x”的字体，也会定义“ex”。

好和好。但我以前从未真正见过它使用过（更不用说自己使用了）。我经常使用 ems，并欣赏它们的价值，但为什么是“ex”？与 em 相比，它的测量标准似乎要少得多，而且用处也少得多。

我发现讨论该主题的少数页面之一是 Stephen Poley 的[http://www.xs4all.nl/~sbpoley/webmatters/emex.html](http://www.xs4all.nl/~sbpoley/webmatters/emex.html)。斯蒂芬提出了很好的观点，但是，他的讨论对我来说似乎没有结论。

所以我的问题是：**“前”单位对网页设计有什么价值？**

（这个问题可以被标记为主观的，但我会把这个决定留给比我更有经验的 SO'ers。）

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-05-28T00:26:17.487

当您想根据文本小写字母的高度调整大小时，它很有用。例如，想象一下这样的设计：

![替代文字](https://upload.wikimedia.org/wikipedia/commons/thumb/3/39/Typography_Line_Terms.svg/410px-Typography_Line_Terms.svg.png)

在设计的排版维度中，字母的高度与其他元素具有重要的空间关系。上面源图像中的线条旨在帮助指出文本的 x 高度，但它们也显示了围绕该文本进行设计时的指导方针。

正如乔纳森在评论中指出的那样，ex 只是 em（宽度）的高度版本。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2014-09-14T01:03:31.790

要回答这个问题，一种用途是使用上标和下标。例子：

```
sup {
    font-size: 75%;
    height: 0;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
    bottom: 1ex;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-08T20:05:04.647

这里要考虑的另一件事是当用户增大或减小其字体大小时您的页面如何缩放（可能使用 ctrl+鼠标滚轮（Windows））。

我用 em 和.. padding-left: 2 em; 填充权：2 em；

和 ex with padding-bottom: 2 ex; padding-top: 2 ex;

因此，对垂直缩放属性使用垂直度量单位，对水平缩放属性使用水平度量单位。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-17T03:29:27.640

请注意，诸如“单/双行间距”之类的术语实际上是指两条相邻行之间的偏移量，由**em**测量。所以“双行距”意味着每行的高度为 2 **em**。

因此，如果要指定与“线”成比例的垂直距离，请使用 em。仅当您想要小写字母的实际高度时才使用 ex，我敢说，这是一个更罕见的例子。

更新：网络标准允许浏览器使用 0.5em 作为 ex 或从字体派生。

但是，无法在字体（OpenType 或 webfont）中可靠地嵌入任何“x 高度”信息。

因此，前一种可能性使前单位变得多余，而后者缺乏任何可靠的手段来发生。两者都可能的事实使得它更加不可靠。

因此，我主张前单位缺乏价值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T02:14:55.757

*在 CSS 规范*中拥有它的价值，如果那是你真正要问的，与拥有 em 单位的价值完全相同。

它使您能够将字体设置为*相对*大小。

你不知道我的基本字体大小是多少。所以网页设计的一个好策略是设置相对的字体大小，而不是绝对的；相当于“两倍于你的正常尺寸”或“比你的正常尺寸小一点”，而不是像“十像素”这样的固定尺寸。

# c# - 考虑 C# 中的“一次性”关键字

> ID：918614
> 
> 赞同：14
> 
> 时间：2009-05-28T00:22:15.890
> 
> 标签：c#, design-patterns, language-features, idisposable

您对如何在 .Net 中实现一次性对象有何看法？以及如何解决实现 IDisposable 类的重复性？

我觉得 IDisposable 类型不是他们应该成为的一等公民。太多的事情留给了开发商的摆布。

具体来说，我想知道是否应该在语言和工具中提供更好的支持，以确保正确实施和妥善处理一次性物品。

例如，在 C# 中，如果我的类需要实现一次性语义可以这样声明：

```
public class disposable MyDisposableThing
{
    ~MyDisposableThing()
    {
        // Dispose managed resources
    }
} 
```

在这种情况下，编译器可以轻松生成 IDisposable 接口的实现。析构函数 ~MyDisposableThing 可以转换为应该释放托管资源的实际 Dispose 方法。

中间 C# 代码如下所示：

```
public class MyDisposableThing : IDisposable
{
    private void MyDisposableThingDestructor()
    {
        // Dispose my managed resources
    }

    ~MyDisposableThing()
    {
        DisposeMe(false);
    }

    public void Dispose()
    {
        DisposeMe(true);
        GC.SuppressFinalize(this);
    }

    private bool _disposed;
    private void DisposeMe(bool disposing)
    {
        if (!_disposed)
        {
            if (disposing)
            {
                // Call the userdefined "destructor" 
                MyDisposableThingDestructor();
            }
        }
        _disposed = true;
    }
} 
```

这将使代码更简洁，更少的样板代码处置代码，以及处置托管资源的一致方式。对于边缘情况和非托管资源，仍然支持手动实现 IDisposable。

确保正确处理实例是另一个挑战。考虑以下代码：

```
private string ReadFile(string filename)
{
    var reader = new StreamReader();
    return reader.ReadToEnd(filename);
} 
```

reader 变量永远不会超出方法的范围，但必须等待 GC 处理它。在这种情况下，编译器可能会引发 StreamReader 对象未显式释放的错误。此错误会提示开发人员将其包装在 using 语句中：

```
private string ReadFile(string filename)
{
    using (var reader = new StreamReader())
    {
        return reader.ReadToEnd(filename);
    }
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-28T02:39:49.200

一个经常陈述的原则是“需要设计模式来解决语言缺陷”。这是该原则的一个例子。我们需要一次性模式，因为语言不会给你它。

我同意可处置性*可能*已经从“模式”世界提升到 C# 语言本身，就像我们对属性 getter 和 setter（它们是具有 getter 和 setter 方法的模式的标准化）或事件所做的那样（它标准化了存储委托并在发生有趣事情时调用它的想法。）

但是语言设计是昂贵的，并且可以应用在它上面的努力是有限的。因此，我们试图找到最有用、最引人注目的模式来正确地放入语言中。我们试图找到一种方式，不仅方便，而且实际上为语言增加了更多的表达能力。例如，LINQ 将过滤、投影、连接、分组和排序数据的概念转移到了适当的语言中，这为语言增加了很多表达能力。

虽然这当然是个好主意，但我认为它不符合标准。我同意，这将是一个很好的便利，但它不会启用任何真正丰富的新场景。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T17:41:48.593

除了其他答案之外，还有一个问题是这个应该实现多少以及人们应该从中得到什么？假设我这样声明我的班级：

```
public disposable class MyClass
{
    readonly AnotherDisposableObject resource = new AnotherDisposableObject();

    ~MyClass()
    {
        this.resource.Dispose();
    }

    public void DoStuff()
    {
        this.resource.SomeMethod();
    }
} 
```

那么，如果调用者`DoStuff` *在*实例被释放后调用，你会期望发生什么？编译器是否应该自动插入类似

```
if (this.disposed) throw new ObjectDisposedException(); 
```

在每个方法的开头，因为您已将类声明为一次性？

如果是这样，那么在释放对象后显式允许调用方法的情况（例如[MemoryStream.GetBuffer](http://msdn.microsoft.com/en-us/library/system.io.memorystream.getbuffer.aspx)）呢？您是否必须向编译器引入一个新的关键字来表明这一点，例如`public useafterdispose void ...`？

如果不是，那么你如何向人们解释 new 关键字为你实现了一些样板代码，但他们仍然需要编写代码来检查对象是否在每个方法中被释放？而且，他们怎么*能*检查这个，因为所有关于对象是否被释放的状态信息都是自动生成的！现在他们需要在`~MyClass`方法中跟踪他们自己的标志，这会取消编译器应该为你做的一半工作。

我认为作为一种特定的语言模式，这个概念有太多的漏洞，它只试图解决一个特定的问题。现在，*能*以通用方式解决这一类问题的是 mixin（即 Disposable mixin），并且这种语言特性通常可用于不同的概念（例如 Equatable mixin、Comparable mixin 等）。那就是我的钱要去的地方。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-28T00:32:30.017

`IDisposable`就个人而言，我认为在当前版本的 .NET 中对的支持相当不错。关键字的存在`using`几乎使它成为我的一流构造。

我承认涉及到一定数量的样板代码，但不足以保证新的语言特性。（自动实现的属性是一个很好的例子，它是一个很好的例子，它要求引入一个特性。）你在你的帖子中错过了一个重要的点，即这个“样板”代码并不*总是*你需要的。主要是，您需要在块之外处理*非托管资源。*`if (disposing)`

当然，析构函数 ( `~MyDisposableThing`) 和无参数`Dispose()`方法是真正的样板文件，并且可以由语言关键字的用户消除，正如您所建议的那样 - 但我再次不确定引入实际的新关键字对于少数人来说是必要的代码行。

我当然明白你在这里提出的观点，并且在某种程度上对此表示同情。（如果您的建议成为语言规范的一部分，我敢肯定没有编码人员会抱怨。）但是，无论如何，当代码行数相当有限时，它不太可能说服 .NET 开发团队，其中一些可以说是相当特定于上下文（因此不是样板文件）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-26T20:04:26.640

我完全同意`IDisposable`需要更好的语言支持。这是[我不久前的变种](http://smellegantcode.wordpress.com/2007/11/30/a-new-use-for-the-c-using-keyword/)。细节可能是错误的，但 C++/CLI 是一个很好的模型。不幸的是，当我向他们展示 C++/CLI 中的示例时，这让 C# 程序员感到困惑。但它在实施方面已经做了“正确的事情”；我们只需要 C# 中的新语法。

即使是最简单的 Windows 窗体应用程序也有一个`Dispose`方法，它是由向导生成的，面对不熟练的更改是脆弱的。将组件组合在一起使得一个组件可以“拥有”其他几个组件的想法是如此基本，以至于`IDisposable`实际上是不可避免的，不幸的是，大多数书籍似乎需要几页来解释如何正确实现它。

现有`using`语句负责客户端。我们需要更多语言支持的地方是在实施方面。

类的某些字段是对类“拥有”的事物的引用，而另一些则不拥有。所以我们必须能够将一个字段标记为拥有。

此外，自动生成终结器也是一个非常糟糕的主意。大多数情况下，一个类将拥有其他实现`IDisposable`. 并非所有的类都是线程安全的，它们也不应该是线程安全的。如果它们是从终结器调用的，那会发生在另一个线程上，迫使它们是线程安全的。这可能是`IDisposable`引起最大混乱的一个领域 - 很多人阅读书籍并得出错误的印象，即您*必须*在支持的对象上编写终结器`IDisposable`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-02-18T17:32:02.190

我意识到这是一个旧线程，但有些东西被忽略了。

C# 和 Java 中的 Dispose 模式打破了没有确定性析构函数的根本原因。

```
MyObject A = new MyObject()
MyObject B = A;
A.Dispose(); 
```

B现在是什么状态？如果 B 的所有者真的不想处理它怎么办。您现在在 C++ 中遇到了同样的问题，您必须跟踪您所持有的对象的所有引用。

`IDisposable``using()`只有在发生异常时才真正有效并确保资源清理。

有设计模式可以做到这一点，但事实并非如此`IDisposable`

**@Peter**是的，我认为 Dipsosable 模式有问题。当实现 Disposable 模式时，通常并不意味着仅仅为了能够继续使用已处置的对象而处置操作系统资源。通过在 Java 中的 try{} finally{} 或 .NET 中的 using() 之外使用 Disposable 模式，您可以打破使用 GC 的原因之一。我并不是说内存会泄漏。我是说您现在可以拥有对已处置对象的引用的代码的其他部分。现在，开发人员有责任在每次调用之前检查对象是否已被释放，或者至少捕获 ObjectDisposedException。

让我们看一个愚蠢的例子：

```
FileStream stream = new FileStream (@"c:\mylog.txt");
logger.setStream (stream); 
```

谁应该调用 .Dispose()？记录器现在正在获取文件流的所有权可能并不明显。假设流是在开发人员之外的其他地方创建的，知道它将被设置为日志流。

如果我们要添加一行，我们会破坏记录器

```
using (FileStream stream = new FileStream (@"c:\mylog.txt"))
    { logger.setStream (stream); } 
```

或者

```
FileStream stream = new FileStream (@"c:\mylog.txt");
logger.setStream (stream);
stream.Dispose(); 
```

Disposable 模式不引用资源的计数。开发人员现在必须清楚谁拥有该对象以及谁负责清理它。真正的问题是，当调用 Dispose() 时，正常行为是使整个对象无效，从而阻止它被使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-30T23:09:41.337

恕我直言，.net 语言在处理 iDisposable 时有一个主要缺点，即没有很好的方法来处理引发异常的初始化程序。除非“泄漏”正在构建的对象的副本或其中的一次性对象，否则无法清除在初始化程序抛出之前创建的任何 iDisposable 对象（在初始化程序中或基级构造函数中）。

为此，我希望看到两个功能：

1.  如果异常从其构造函数中抛出，将导致调用特定方法的类声明。
2.  如果在对象上使用了某些特殊的私有方法或关键字，则表明该字段应该调用 .Dispose 的字段声明。

顺便说一句，我还希望看到可用于结构方法的声明，这表明该方法会改变底层结构。将禁止在结构右值上使用此类方法，并且在结构属性上使用此类方法将生成读取-修改-写入序列。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-28T00:33:05.883

好的，您需要了解托管内存和非托管内存之间的区别。简而言之，c++ 风格的析构函数在 c# 的托管世界中不起作用，因为无法保证对象何时被垃圾收集，因此您永远不知道何时调用析构函数，这会使事情变得非常不可预测。

与 c++ 不同，当类超出范围时立即调用析构函数，因此您可以保证何时调用它。

这就是为什么 c# 不能有析构函数的原因。

# windows - 将批处理标准错误重定向到文件

> ID：918619
> 
> 赞同：10
> 
> 时间：2009-05-28T00:24:04.513
> 
> 标签：windows, batch-file, cmd, stderr

我有一个执行 java 应用程序的批处理文件。我正在尝试对其进行修改，以便每当发生异常时，它都会将 STDERR 写入文件。

它看起来像这样：

```
start java something.jar method %1 %2 2>> log.txt 
```

有没有办法也可以将参数 %1 和 %2 写入 log.txt 文件？每次调用此批处理文件时，我都不想将其写入日志文件，只有在发生异常时才将其写入日志文件。

我尝试寻找一种将 STDERR 重定向到变量的方法，但我无法弄清楚。理想情况下，我希望日志文件看起来像：

```
Batch file called with parameters:
- "first arg"
- "second arg"
Exception: 
java.io.exception etc...

------------------------------------

Batch file called with parameters:
- "first arg"
- "second arg"
Exception: 
java.io.exception etc... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-25T17:07:44.647

像这样的东西可能会起作用：

**javastart.cmd**

```
@echo off
set params=%*
for /f "delims=" %%e in ('java something.jar method %1 %2 ^>nul') do (
    echo Batch file called with parameters:>>log.txt
    echo - Args[]: %*>>log.txt
    echo - Arg[1]: %1>>log.txt
    echo - Arg[2]: %2>>log.txt
    echo Exception: %%e
) 
```

我自己不是 java 程序员，我无法测试这个输出/情况，但是：

**1：** **%***表示每个参数，从第一个到最后一个（即使是 %12 虽然它不是直接可用的.. ），无论格式如何。使用它可能比划定它们更好。即使间距/引用错误，您也将拥有完整的参数。我在日志中添加了一行，以显示整行，然后显示参数。如果这是一个糟糕的论点，你可以看到问题出在哪里。

**2：**将标准输出发送到 null (^>nul) 只会保留标准错误输出，设置为**%%e**

**3：****do**部分中的任何事情只会发生，**因为**测试语句实际上有任何输出，即如果设置了**%%e**。

话虽如此，您必须测试脚本并查看异常是否实际发送到stderr，或者像其他一些软件一样，即使发生错误也发送到stdout。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T01:42:15.557

I don't get exactly what you are asking, but here's some info that may help...

You can redirect stderr separately from stdout in a .cmd or .bat file. To redirect stderr, use something like this:

```
MyCommand.exe > command.stdout.txt  2> command.stderr.txt 
```

Then, you can check the command.stderr.txt for content, and if any is present, concatenate it to the command.stdout.txt into your log file. Or you could concat it in any case. If you like you could also echo the command that you ran, into the final log file.

You can also check for the exit code in a batch file, using the %ERRORLEVEL% env var. Exe files are expected to set ERRORLEVEL in case of an error. I don't know if java.exe does this. It should, if it is a good citizen on Windows. This might be an alternative way of finding out if the Java app exited with an error condition. But this is no guarantee that stderr got nothing. For example, a Java app might print out an exception and stack trace, and then exit with code 0, which indicates success. In which case stderr would have gunk in it, but ERRORLEVEL would be zero.

**EDIT**: s/ERROR_LEVEL/ERRORLEVEL

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T05:45:22.443

我看到的唯一可行的解​​决方案是将stderr重定向到一个临时文件

```
java blah.jar %1 %2 2>stderr 
```

然后查看是否已将某些内容写入文件并在这种情况下写入日志。

```
for %%i in (stderr) do if %%~zi GTR 0 (
    echo Parameters: %1 %2 >>log.txt
    type stderr >> log.txt
) 
```

如果批次不是按顺序运行而是同时运行，您需要找到一些东西来唯一化 temp 变量：

```
set file=%time::=%
set /a file=file
set file=%file%%random%
java blah.jar %1 %2 2>stderr_%file%
for %%i in (stderr) do if %%~zi GTR 0 (
    echo Parameters: %1 %2 >>log.txt
    type stderr >> log.txt
) 
```

这将避免多个运行批次之间的冲突。但是，您目前没有使用任何东西来锁定对日志文件的写入，并且当其他内容写入其中时，事情可能会显得不合适（对于其他批次，您可能会在`echo`and`type`命令中交错，或者当您重定向输出时java 到该文件，那么它可能会与 java 程序的常规输出混淆：

```
参数：foo bar
一些常规输出
参数：foo2 bar2
更多输出
Blah 的 NullPointerException：我们真正想要在参数之后立即拥有的东西
Blah 处的 IOException：此异常属于参数 foo2 bar2

```

您可以使用另一个文件作为信号量来写入日志以避免批处理输出混合：`copy nul file`当您想要写入日志时创建文件 []，然后删除它，然后在您尝试创建它之前检查它是否真的存在并等到它消失。但是，您不能对混合到文件中的标准输出日志做任何事情，除非您也对标准输出使用该临时文件方法（并且只是`type`将标准输出日志记录到`log.txt`Java 程序完成时，但是，再次使用信号量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T01:44:14.477

Try using [ERRORLEVEL](http://www.robvanderwoude.com/errorlevel.php)

```
java something.jar method %1 %2 2>> log.txt
IF %ERRORLEVEL% NEQ 0 GOTO Error

Error:
@ECHO There was an error
@ECHO Arg 1: %1 >> log.txt
@ECHO Arg 2: %2 >> log.txt 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T00:57:32.730

像这样的东西怎么样（未经测试）：

```
@echo off
@echo Batch file called with parameters: >> log.txt
@echo - %1 >> log.txt
@echo - %2 >> log.txt
start java something.jar method %1 %2 2>> log.txt 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-11T22:17:26.813

像这样的批处理文件应该可以解决问题。

**start_prog.cmd**

```
CALL :Start_Prog arg1 arg2
GOTO :EOF

:Start_Prog
    something.py %1 %2 2>&1 1>nul | "C:\Python26\python.exe" format_output.py %1 %2 >>log.txt
    GOTO :EOF 
```

在这里，我通过管道传递 stderr 并将参数作为参数传递。然后将输出附加到 log.txt 文件中。

扔掉标准输出

```
1>nul 
```

将标准错误重定向到标准输出

```
2>&1 
```

将 stderr 导入脚本以格式化输出，并将参数作为参数传递。

```
| "C:\Python26\python.exe" format_output.py %1 %2 
```

将输出附加到*"log.txt"*。

```
>>log.txt 
```

在我的系统上，我需要调用 python.exe 否则管道不起作用。

这是我使用的两个文件*"something.py"*和*"format_output.py"*。

**东西.py**

```
import sys
print >>sys.stdout, " ".join(sys.argv[1:])
print >>sys.stderr, "java.io.exception etc..." 
```

**格式输出.py**

```
import sys

print "Batch file called with parameters:"
for arg in sys.argv[1:]:
    print '- "{0}"'.format(arg)

print "Exception:"
for line in sys.stdin:
    print line 
```

最后是输出。

**日志.txt**

```
Batch file called with parameters:
- "arg1"
- "arg2"
Exception:
java.io.exception etc... 
```

唯一缺少的是总是将某些内容写入*“log.txt”*文件。

为了进一步整理，我会将日志文件写入*"format_output.py"*。

然后，您可以添加检查以查看程序中的 stderr 是否为空白。

# linq-to-sql - 如何在 LINQ 中每次更新类层次结构运行一次存储过程？

> ID：918624
> 
> 赞同：0
> 
> 时间：2009-05-28T00:26:53.897
> 
> 标签：linq-to-sql

我的数据库中有两个相关的表：Page 和 Tag。一页可以与许多标签相关。

每当修改这两个表中的任何一个时，都需要执行一个名为 BeforePageHierarchyUpdate 的存储过程（在我的例子中，这个存储过程在页面层次结构上执行一些日志记录和版本控制）。

给我带来问题的是这两个要求：

1.  如果更新了 Page 实例或 Tag 实例，则必须运行 SP。但是如果一个页面和它的一个相关标签都被更新了，那么 SP 应该只被调用一次。

2.  存储过程必须包含在与其他 LINQ 语句相同的事务中。如果 LINQ 语句失败，则需要回滚存储过程。如果存储过程失败，则不得执行 LINQ 语句。

有没有人对如何实现这样的事情有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T01:32:19.243

仅使用以下过程更新这些表：

```
create procedure UpdatePageAndOrTag
(
    @mode              char(1)  --"P"=page only, "T"=tag only, "B"=both
    ,@pageParam1 ...
    ,@pageParam2 ....
    ....
    ,@TagParam1.....
    ,@TagParam2....
    ....
)

as

EXEC BeforePageHierarchyUpdate

if @Mode="B" or @Mode="P"
Begin
    update Page....
END

IF @Mode="B" or @Mode="T"
Begin
    update tag...
END

return 0
go 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T18:29:04.310

在挖掘了一些代码之后，这是另一种选择。我对连接/事务代码是否正确并不完全满意（它主要是从基本的 SubmitChanges 实现逆向工程的）。

```
public override void SubmitChanges(System.Data.Linq.ConflictMode failureMode) {
    if (System.Transactions.Transaction.Current == null && this.Transaction == null) {
        bool connectionOpened = false;
        DbTransaction transaction = null;
        try {
            if (this.Connection.State == ConnectionState.Closed) {
                this.Connection.Open();
                connectionOpened = true;
            }
            transaction = this.Connection.BeginTransaction(IsolationLevel.ReadCommitted);
            this.Transaction = transaction;

            BeforeSubmitChanges();
            base.SubmitChanges(failureMode);

            transaction.Commit();
        }
        catch {
            if (transaction != null) {
                try {
                    transaction.Rollback();
                }
                catch {
                }
                throw;
            }
        }
        finally {
            this.Transaction = null;
            if (connectionOpened) {
                this.Connection.Close();
            }
        }
    }
    else {
        BeforeSubmitChanges();
        base.SubmitChanges(failureMode);
    }
}

private void BeforeSubmitChanges() {
    ChangeSet changes = this.GetChangeSet();
    HashSet<int> modifiedPages = new HashSet<int>();

    foreach (Page page in changes.Updates.OfType<Page>()) {
        modifiedPages.Add(page.PageId);
    }

    foreach(PageTag tag in changes.Updates.OfType<PageTag>()) {
        modifiedPages.Add(tag.PageId);
    }

    foreach (PageTag tag in changes.Inserts.OfType<PageTag>()) {
        //If the parent is being inserted, don't run the Update SP.
        if (!changes.Inserts.Contains(tag.Page)) {
            modifiedPages.Add(tag.PageId);
        }
    }

    foreach (PageTag tag in changes.Deletes.OfType<PageTag>()) {
        //If the parent is being deleted, don't run the Update SP.
        if (!changes.Deletes.Contains(tag.Page)) {
            modifiedPages.Add(tag.PageId);
        }
    }

    foreach (int pageId in modifiedPages) {
        this.BeforePageHierarchyUpdate(pageId);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T18:33:39.447

第三种可能的解决方案是将它放在存储库类（或其他包装实现）中。这大大简化了事务代码，但功能感觉更适合 DataContext 层。

```
public class PageRepository : IPageRepository {
    public void Save() {
        using(TransactionScope trans = new TransactionScope()) {
            BeforeSubmitChanges();
            mDataContext.SubmitChanges();
            trans.Complete();
        }
    }

    private void BeforeSubmitChanges() {
        ChangeSet changes = this.GetChangeSet();
        HashSet<int> modifiedPages = new HashSet<int>();

        foreach (Page page in changes.Updates.OfType<Page>()) {
            modifiedPages.Add(page.PageId);
        }

        foreach(PageTag tag in changes.Updates.OfType<PageTag>()) {
            modifiedPages.Add(tag.PageId);
        }

        foreach (PageTag tag in changes.Inserts.OfType<PageTag>()) {
            //If the parent is being inserted, don't run the Update SP.
            if (!changes.Inserts.Contains(tag.Page)) {
                modifiedPages.Add(tag.PageId);
            }
        }

        foreach (PageTag tag in changes.Deletes.OfType<PageTag>()) {
            //If the parent is being deleted, don't run the Update SP.
            if (!changes.Deletes.Contains(tag.Page)) {
                modifiedPages.Add(tag.PageId);
            }
        }

        foreach (int pageId in modifiedPages) {
            this.BeforePageHierarchyUpdate(pageId);
        }
    }
} 
```

# c# - SSL HttpWebRequest 到 Azure 上证书不匹配的站点？

> ID：918627
> 
> 赞同：1
> 
> 时间：2009-05-28T00:27:27.890
> 
> 标签：c#, ssl, httpwebrequest, azure

我们的客户在其 QA 环境中的 SSL 证书不匹配。我们正在从 Azure Web 角色中对这些受 SSL 保护的 Web 资源进行 HttpWebRequest 调用。为了绕过他们的证书，我们将 ServicePointManager.CertificatePolicy 设置为接受所有证书的新策略。这在完全信任的环境中有效，但当我们尝试在不太完全信任的 Azure 环境中设置 CertificatePolicy 时会失败并出现 SecurityPermission 异常。有没有一种方法可以让这些调用在我们的 Azure 服务中工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T19:42:43.207

我会回答我自己的问题！

显然，要完全信任地运行它，您只需要在 web 角色配置中启用NativeCodeExecution="true"。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-24T11:40:03.227

这可能是什么？

```
System.Net.ServicePointManager.ServerCertificateValidationCallback += delegate (
    object sender,
    X509Certificate cert,
    X509Chain chain,
    SslPolicyErrors sslPolicyErrors)
{
    if (sslPolicyErrors == SslPolicyErrors.None)
    {
        return true;   //Is valid
    }
    //Add the mismatched certificate hashstring below. 
    //That way only that resource will be affected and not all certificates will be trusted.
    if (cert.GetCertHashString() == "99E92D8447AEF30483B1D7527812C9B7B3A915A7")
    {
        return true;
    }

    return false;
}; 
```

# nhibernate - Fluent Nhibernate Nunit 测试错误

> ID：918633
> 
> 赞同：0
> 
> 时间：2009-05-28T00:30:27.387
> 
> 标签：nhibernate, fluent-nhibernate

我正在尝试使用流畅的 nhibernate 映射来学习 Nhibernate，并且我创建了一个小型测试应用程序。下面是代码：

用户类：

```
public class User
{
    public string UserName { get; set; }
    public string Password { get; set; }
    public string Role { get; set; }
    public string Email { get; set; }
    public DateTime JoinDate { get; set; }
} 
```

用户地图类：

```
public class UserMapping: ClassMap<User>
{
    public UserMapping()
    {
        WithTable("UserT");
        Not.LazyLoad();
        Id(u => u.UserName);
        Map(u => u.Password);
        Map(u => u.Role);
        Map(u => u.Email);
        Map(u => u.JoinDate);

    }
} 
```

DAL 用户类：

```
public class DALUser
{

    public User GetUserByUserName(string userName)
    {
        ISessionFactory sessionFactory = Fluently.Configure()
            .Database(MsSqlConfiguration.MsSql2005.ConnectionString(c => c.Server("ServerName").Database("DBName").TrustedConnection()))
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<UserMapping>()).BuildSessionFactory();

        ISession session = sessionFactory.OpenSession();
        return session.Get<User>(userName);
    }

} 
```

Nunit 测试类：

```
[TestFixture]
public class UserTest
{
    [Test]
    public void CanGetUserByUserName()
    {
        DALUser user1 = new DALUser();
        Assert.AreEqual("testUser", user1.GetUserByUserName("testUser").UserName);
    }

} 
```

当我尝试运行测试类时，出现以下错误：对象引用未设置为对象的实例。我在 GetUserByUserName 方法中放置了一个断点，并注意到它返回了一个空用户。但我无法弄清楚为什么会这样。谁能帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-11T18:30:10.207

看看你的数据库配置是否正确？你确定你的数据库服务器是“ServerName”并且你有现有的数据库“DBName”

# iphone - 为什么 iPhone 设备 ID 是 40 个字符？

> ID：918634
> 
> 赞同：4
> 
> 时间：2009-05-28T00:31:01.690
> 
> 标签：iphone, ipod-touch, uuid, udid

UUID 通常为 36 个字符。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-28T00:42:09.703

因为UDID≠UUID。iPhone 唯一设备标识符 (UDID) 是从手机芯片中提取的几个不同硬件标识符的哈希值。它不是软件对象的软件生成标识符。

它是 160 位，而不是 128 位，因此需要 40 个十六进制字符来表示，而不是 32 + 4 个连字符。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-28T00:34:05.037

它不是 UUID，而是 UDID。动态生成一个 UUID 以使其唯一，然后存储。但是，UDID 是根据手机上的硬件计算得出的，因此它永远不会生成。40 个字符的长度可能意味着它是一些硬件信息的 SHA1 哈希，或者它可能只是一个巧合。

# javascript - Javascript 中的两个字母变量名？

> ID：918635
> 
> 赞同：4
> 
> 时间：2009-05-28T00:31:07.027
> 
> 标签：javascript, optimization

我今天正在查看[一个 SO 问题的答案，其中变量名是 ua、rv 等](https://stackoverflow.com/questions/917252/how-to-detect-if-a-user-is-running-ie-6/917257#917257)。我想，“伙计，人们什么时候才能学会使用全尺寸变量名，内存不再是问题了”但是，**它是 Javascript**，所以它必须通过电线，也许长变量名甚至会减慢解释.

在 Javascript 过早优化中使用短变量名吗？

当我在这里时，是否有任何 Rails 或 PHP 库可以即时压缩 Javscript，所以我可以在服务器上保留长名称的 Javascript？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-28T00:33:00.483

在 JS 中使用短变量名的唯一原因是通过网络节省字节。然而，这样的发展是荒谬的。他们也写没有空格的 JS 吗？有一些工具可以优化成品 JS。[Crockford](http://www.crockford.com/javascript/jsmin.html)是最受欢迎的之一（尽管它不会缩短变量名）。~~我不记得有一个混淆/缩短变量名的临时工具，但它们确实存在，而且写一个也不难。~~ [Google Closure](http://code.google.com/closure/compiler/) 是一个非常令人印象深刻的 JavaScript*编译器*，它变成了这样：

```
var myFunction = function(arg1, arg2) {
    var foo = getValue(arg2);
    for(var count = 0; count < arg1.length; count++) {
        alert(foo);
    }
}; 
```

进入这个：

```
function a(b,c){var d=e(c);for(var f=0;f<b.length;f++){alert(d)}} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T00:33:18.330

在开发过程中不要使用短变量名进行优化。这将严重降低可读性。在编译/部署时压缩你的 JS/CSS 文件，使用类似[YUI Compressor](http://developer.yahoo.com/yui/compressor/)的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T00:32:24.090

人们在 javascript 中使用短变量名纯粹是为了节省带宽。它不会影响 javascript 的执行速度。而且我不知道 rails 或 PHP 库，但肯定有工具可以压缩你的 javascript 文件（通过将变量重命名为更短并删除不必要的空格）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T01:18:39.627

我们没有任何理由在开发中使用不可读的代码。

作为其他答案，我认为您有很多资源可以节省带宽并通过快速加载页面让用户满意。

检查这些文章：

[仔细查看包含 javascript 压缩](http://justtalkaboutweb.com/2008/03/10/close-look-into-include-javascript-compression-lib/)

[生产级JS](http://www.learn-javascript-tutorial.com/Production-Grade-JS.cfm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-27T12:16:05.683

我正常发展，这些答案大部分都是正确的。没有理由使用非描述性变量名称。

但是，在编写关于 SO 的答案和示例时，变量并不一定意味着什么特别的。它们只是用于演示目的，不需要任何语义。

# tortoisesvn - TortoiseSVN 修订图：合并 -> 线路连接回主干？

> ID：918638
> 
> 赞同：23
> 
> 时间：2009-05-28T00:32:18.647
> 
> 标签：tortoisesvn, merge, revision-graph

当我完成“合并”时，TortoiseSVN 修订图是否会从分支绘制一条线回到主干？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-28T01:52:50.480

采取一个分支是一个复制操作（这在 svn 中非常便宜），并且在日志中看起来很明显这就是发生的事情，因此该行。**这很*明显*（对于 svn/tortioiseSVN），因为如果不从您选择的修订版的主干中获取每一个人工制品，您就无法创建一个分支。**这就是为什么总是显示一行的原因——创建一个分支可以保证将你*所有*的文件从主干带到你的分支。重新合并是不同的，您可以*有选择地合并任何您想要*的。

重新合并不是副本，而是将*您的差异从 HEAD（当前最新的主干）提交到您自己的工作副本*（您的分支）。对 SVN 来说，看起来有人使用了最新的主干并立即更改了大量文件并将其提交。

IMO，**回到主干的行会产生误导，因为您可以合并并为每个文件选择您自己的主干版本**- 该行表示您已将所有更改都带入，但实际上并不能保证您带入任何更改。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-07-28T22:27:16.383

从“现实世界”的场景来看，如果有一条合并线，就像它有助于一条分支线一样，它确实有很大帮助。如果要查看日志，为什么还要为 barnch 添加一行……所有信息都在日志​​中。

但是，当您必须为不同的客户维护多个分支并将更改合并到主干时......如果没有图形表示，它几乎无法管理（我的意思是我们有工具可以让生活变得简单......如果你必须坐几个小时，为什么要使用它们阅读日志）。

因此，即使 SVN/Tortoise 无法决定何时划线，但如果用户可以强制划线，我认为这将有很大帮助。

确实，某些差异可能尚未合并或合并过程本身未正确执行，但这应该留给用户记录:-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-27T20:27:52.770

您可能希望查看[Subclipse Revision Graph](http://subclipse.tigris.org/graph.html)。

只要合并是由 1.5.x 和更高版本的客户端和服务器执行的，它就支持显示合并信息。（从 SVN 1.5 行开始，通过附加到文件夹的元数据添加合并信息跟踪）

Subclipse 工具试图显示这些信息，但我发现它在工作中非常受欢迎或错过。它不是高度抛光，但显示出极大的希望。特别是如果可以在某个时候将其带回 TortoiseSVN。

您可能还希望查看[Subversion 关于它的合并实现的注释。](http://subversion.tigris.org/merge-tracking/design.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T01:31:56.310

根据我的经验，答案是否定的，但您为什么不尝试并告诉我们。我相信您不会取消合并，因为 tortoise svn 可能会或可能不会以图形方式表示它。

**基于响应的更新** TSVN 只是表示 SVN 中内容的工具，因此他们可以完全自由地更改其表示方式，而不会对现实世界产生任何影响:) 我并不是说你的想法是一个坏想法，但实际上如果您添加到评论中，有关合并的信息仍然存在。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-20T20:09:21.323

TortoiseSVN（2014 年 1 月）仍然没有实现这一点，但可以使用 eclipse Subversive 插件[http://www.eclipse.org/subversive/documentation/teamSupport/revision_graph.php](http://www.eclipse.org/subversive/documentation/teamSupport/revision_graph.php)（以及之前的 Subclipse 插件）被提及）。

不幸的是，您必须单击每个节点才能显示它，而不是默认情况下能够在所有节点上显示它。

> 如果您选择显示合并信息并且存在合并，则合并信息会显示在图表上。每个修订节点可能具有传入和（或）传出合并，这些合并通过指向左侧或右侧的相应蓝色箭头显示在修订节点上。对于每种类型的合并，箭头附近都有一个数字，表示合并的数量，对于传入的合并，还显示了受合并影响的修订号（在括号中）。默认情况下，不显示节点之间的合并连接，因为可能存在大量合并连接，这会使图形表示和理解变得非常复杂。如果您想查看修订节点的合并连接，您可以单击修订节点上的蓝色合并箭头或从节点的上下文菜单中调用相应的操作，例如“显示传出合并”或“显示传入合并”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T01:36:25.647

在我自己尝试之后，答案是否定的。

这些是我的设置。

TortoiseSVN 1.6.2，内部版本 16344 - 64 位颠覆 1.6.2

虽然这根本没有意义......

如果 TSVN 显示一条分支线，为什么没有合并线？这背后的理由是什么？

# apache - 如何在不重定向的情况下使用 mod_proxy 设置反向代理？

> ID：918641
> 
> 赞同：3
> 
> 时间：2009-05-28T00:32:58.067
> 
> 标签：apache, .htaccess, mod-rewrite, reverse-proxy, mod-proxy

如何在不重定向到另一台服务器或 IP 的情况下使用 mod_proxy 设置反向代理？这将是一个虚拟主机环境。我想这样做的原因是 mod_proxy 处理与客户端浏览器的通信，从而释放 Web 服务器进程来服务下一个请求，而不是提供客户端的浏览器。这在将 mod_php 等语言模块与 MPM Prefork 一起使用时尤其重要。我试图实现的流程是： 1\. 流量解析到端口 80 上的 www.mydomain.com。 2\. 代理将请求发送到 Web 服务器。3\. Web 服务器将应答发送回代理并断开与代理的连接。4\. 代理向客户端浏览器提供数据。

一旦工作正常，我想将 nginx 添加到相同的 IP 地址，但用于端口 81 和对同一服务器上 nginx 的代理图像请求。我不希望 nginx 处理代理，也不想要 FCGI 任何东西。我希望我的标准 Apache mod_rewrite 和 .htaccess 工作。

谢谢吨！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T00:40:38.333

只需重定向到不同端口上的本地主机？在端口 8080 上托管您的应用程序，并用于`mod_proxy`转发请求：

```
ProxyPass /foo http://localhost:8080/foo
ProxyPassReverse /foo http://localhost:8080/foo 
```

如果您有正在处理请求的应用程序服务器并且您希望在一台机器上组合多个实例，这可能会很有帮助。每个应用程序服务器可以使用一个端口。

我不知道它是否真的会比直接使用更快`mod_php`。代理请求也会增加开销。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-29T22:00:08.643

确保您还使用加载这两个模块

```
LoadModule proxy_module bin/mod_proxy.so 
LoadModule proxy_http_module bin/mod_proxy_http.so

ProxyPass /TeamCity http://localhost/TeamCity
ProxyPassReverse /TeamCity http://localhost/TeamCity 
```

# c# - C# GUI 使用大量内存？

> ID：918649
> 
> 赞同：0
> 
> 时间：2009-05-28T00:34:42.493
> 
> 标签：c#, performance

我很好奇，这不是问题。通常我的 (C++) 应用程序使用很少的内存。我认为我当前的应用程序会占用很少的内存，但它使用 3.7mb 和 17.3mb 的 VM 大小。该应用程序在其资源文件中有 4 个图标，在本地（用户）设置中有 4 个整数，并且应用程序 LoC 是 <1k。当用户空闲（调用 windows 函数）时，它检测键盘输入并在列表框中写入一行。它将自己放在系统托盘中，并将计时器设置为 100 毫秒。

除了一些少于 256 字节的结构外，没有数组或任何存储。为什么我的应用程序使用 17mb+ 的 VM？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-28T00:43:45.907

因为它是一个托管应用程序，所以 CLR 的一部分也会被加载到内存中。此外，CLR 将分配一堆内存，以便它可以满足新的对象请求（它不会从系统中分配每个对象）。还有一堆其他的对象被分配给托管模型中的每个应用程序（例如线程池、垃圾收集器等）。

我不确定您可以做很多事情来减少它，但另一方面，您不会看到它与应用程序复杂性成线性关系（因为如果您将其复杂性增加一倍，它就不会使用两倍的内存）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T00:38:41.190

对于一个简单的 C# 应用程序来说，17 megs 听起来很合适。

我猜这是长期存在的“硬件使用与程序员生产力”的争论。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-28T00:47:56.837

如果您想知道究竟是什么占用了该内存，请使用[.NET 内存分析器。](http://memprofiler.com/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T00:48:08.067

使用 .NET 框架编写的程序本身就有更多的开销。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T00:46:49.117

需要记住的是，每个托管线程也有一个 1MB 的堆栈。如果你正在用线程做任何事情，那马上就是几个 MB。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T01:28:12.153

不用担心 Hello World 应用程序的内存消耗。

托管语言应用程序处理其内存使用的方式与 C 不同，其中每个内存分配都有未被释放的风险。在某些情况下，如果应用程序在 malloc/dealloc 中花费大量时间，.NET 应用程序甚至可能比用 C++ 编写的等效应用程序运行得更快，因为 CLR 可以推迟释放/垃圾收集，直到应用程序空闲。

# sql - 为什么这个 UPDATE 语句会更新每条记录？

> ID：918652
> 
> 赞同：0
> 
> 时间：2009-05-28T00:35:44.380
> 
> 标签：sql, sql-update

我有一个 UPDATE 语句，旨在为有限数量的记录更新状态字段。这是声明：

```
UPDATE warehouse_box
SET warehouse_box_status_id = wbsv.warehouse_box_status_id
FROM
    warehouse_box_status_vw wbsv INNER JOIN
    pallet_warehouse_box pwb ON wbsv.warehouse_box_id = pwb.warehouse_box_id INNER JOIN
    routing_shipment_pallet rsp ON pwb.pallet_id = rsp.pallet_id
WHERE
    rsp.date_removed IS NULL
    AND pwb.date_unpalletized IS NULL
    AND rsp.routing_shipment_id = 100002 
```

预期的结果是使与 WHERE 子句匹配的 6 条记录的状态得到更新。我看到的是所有 200,000 多条记录都已更新。就好像 WHERE 子句被完全忽略了。

任何人都可以帮我解释一下吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T00:40:51.843

FROM 子句中没有包含表warehouse_box。如果您添加warehouse_box 并将其加入warehouse_box_status，它应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T00:40:31.250

您似乎没有`warehouse_box`在`WHERE`and `INNER JOIN`s 中进行选择-仅从其他表中选择...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T00:41:12.713

当您使用相同的 FROM 和 WHERE 子句执行 SELECT 时会发生什么？

*   如果您获得所有 200K 行，则可以采取一些措施从那里追踪问题。

*   如果您只获得要更新的 6 条记录，那么是时候开始寻找可能会更新整个表的触发器了。

编辑：看起来更敏锐的眼睛已经发现了问题。

# c++ - 如何重新定义内置键盘快捷键的行为？

> ID：918668
> 
> 赞同：3
> 
> 时间：2009-05-28T00:41:37.770
> 
> 标签：c++, qt, keyboard-shortcuts

我正在尝试重新实现 QTextEdit 对象的复制行为。单击“复制”按钮时，我创建的自定义上下文菜单按预期工作，但没有正确处理`Ctrl`+ 。`C`由于上下文菜单没有任何问题，我将省略这部分代码。

```
// Create a text edit box for text editing
QTextEdit text_edit_box = new QTextEdit(getBaseWidget());

text_edit_copy_action = new QAction(QString("Copy"), getBaseWidget());
text_edit_copy_action->setShortcut(QKeySequence::Copy);

// Add custom copy action to the text edit box to ensure Ctrl+C uses our copy
// implementation
text_edit_box->addAction(text_edit_copy_action); 
```

当我将快捷方式设置为未使用的组合键（例如`Ctrl`+ `Q`）时，它可以正常工作。似乎`Ctrl`+`C`的处理方式有所不同，因为它是“内置的”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T10:08:09.030

副本不是虚拟的，所以这可能是有问题的。复制是通过私有文本控制 API 处理的，并且不容易访问。最好的方法可能是为文本编辑安装一个事件处理程序，并在复制键事件被传递到文本控件 processEvent 处理程序之前拦截它 - 这应该允许您自己的操作正确触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T01:26:28.770

派生`QTextEdit`和重新实现可能更简单[`QTextEdit::copy()`](http://doc.qtsoftware.com/4.5/qtextedit.html#copy)，具体取决于新行为是什么。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-28T18:12:26.697

我建议创建一个事件过滤器并将其安装在基本小部件（甚至是 QApplication 实例）上。您可以使用事件过滤器查看关键事件，并希望在其他地方处理之前看到 Ctrl+C 事件。

当您遇到要处理的`Ctrl`+`C`事件时，请确保接受该事件以防止它被进一步传播。

# java - 包 Bean 不存在

> ID：918671
> 
> 赞同：0
> 
> 时间：2009-05-28T00:42:30.137
> 
> 标签：java, netbeans

我是一名涉足 JSP 世界的 .NET 开发人员。我加载了 NetBeans 6.5.1 并在此页面中收到错误：

```
<%@page import="java.io" %>
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "w3.org/TR/html4/loose.dtd">;
<html>
 <head>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
 <title>JSP Page</title>
 </head>
 <body>
 <h1>Hello World!</h1>
 </body>
</html> 
```

错误是：

```
"Package Beans does not Exist" 
```

我应该补充一点，我创建了一个新的 Java Web 应用程序，然后复制并粘贴了一些需要上述导入的代码。然后我得到错误。

与任何教程或书籍一起帮助解决这个错误会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T00:54:33.797

类路径有问题。您的服务器配置，以及 WAR 文件中的设置，应与工作配置进行检查。

# javascript - 如何更改多个选定 html 值的名称？

> ID：918675
> 
> 赞同：0
> 
> 时间：2009-05-28T00:45:30.320
> 
> 标签：javascript, html, dom, javascript-events

我有大约 20 个复选框。当用户选择这些然后使用**备用**提交按钮时，我需要更改所选输入的名称/值对的名称。

为什么这个函数只改变*每个其他*选定输入的名称？

```
function sub_d()
{

    for (i = 0; i < document.checks.OGname.length; i++) //for all check boxes
    {
        if (document.checks.OGname[i].checked == true)
        {
            document.checks.OGname[i].name="newname"; //change name of input 

        }

    }

    document.checks.submit();
} 
```

输出：

```
newname
    '105' 
OGname
    '106' 
newname
    '107' 
OGname
    '108' 
newname
    '109' 
OGname
    '110' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T00:53:09.570

通过重命名列表的第一个元素，您将列表的长度减少了一个并删除了第一个元素。下一次通过循环之前的第二个元素现在是第一个，第二个是旧的第三个。

我不是 javascript 专家，但类似的东西可能会起作用。

```
function sub_d()
{
  i=0;
  while (document.checks.OGname.length > i)
  {
    if (document.checks.OGname[i].checked="true")
      {
        document.checks.OGname[i].name="newname";
      }else{
        i++;
      }
  }
  document.checks.submit();
} 
```

正如我所说，没有保证或保证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T01:00:18.200

如果您提供更详细的场景描述会很棒，但我希望我的回答有用。

```
function sub_d()
{    
    for (i = 0; i < document.checks.OGname.length; i++) //for all check boxes
    {
        if (document.checks.OGname[i].type == 'CHECKBOX')
            if (document.checks.OGname[i].checked)
               {
                   document.checks.OGname[i].name="newname"; //change name of input 

               }    
    }    
    document.checks.submit();
} 
```

我一般都是这样管理dom集合的：（不知道是不是最好的方式）

```
 function sub_d()
    {    
        var theInputs = document.checks.getElementsByTagName('input');
        for (var i = 0; i < theInputs.length; i++) 
        {
            if (theInputs[i].type == 'CHECKBOX')
                if (theInputs[i].checked)
                   {
                       theInputs[i].name="newname";         
                   }    
        }    
        document.checks.submit();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T17:47:31.960

在你们的帮助下，我想出了这个，似乎效果很好。让我知道它是否可以改进以供其他人使用...

```
function sub_d()
{

    for (i = 0; i < document.checks.OGname.length; i++) //for all check boxes
    {
        if (document.checks.OGname[i].checked == true)
        {
            document.checks.OGname[i].name="newname"; //change name of input data so we know it is for other function
            //By renaming the first element of the list, we have reduced the length of the list by one 
            //and deleted the first element. This is why we need to keep i at it's current position after a name change.
            i=i-1;  
        }
    }

    //When there is only one check box left it's propert length becomes undefined.
    //We will need this statement for the last undefined check box not covered in the for loop
    //We can no longer index user[0]
    document.checks.OGname.name="newname"; 

    document.checks.submit();//submit these checked values to the .exe

} 
```

# c++ - 使用 OpenSSL 库在 C++ 中生成 SHA 哈希

> ID：918676
> 
> 赞同：77
> 
> 时间：2009-05-28T00:45:42.550
> 
> 标签：c++, cryptography

如何使用[OpenSSL](https://openssl.org)库生成 SHA1 或 SHA2 哈希？

我搜索了谷歌，找不到任何函数或示例代码。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-05-28T05:54:37.233

从命令行，它很简单：

```
printf "compute sha1" | openssl sha1 
```

您可以像这样调用库：

```
#include <stdio.h>
#include <string.h>
#include <openssl/sha.h>

int main()
{
    unsigned char ibuf[] = "compute sha1";
    unsigned char obuf[20];

    SHA1(ibuf, strlen(ibuf), obuf);

    int i;
    for (i = 0; i < 20; i++) {
        printf("%02x ", obuf[i]);
    }
    printf("\n");

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2010-02-14T19:34:17.020

OpenSSL 有一个可怕的[文档](https://www.openssl.org/docs/manmaster/man3/SHA1.html)，没有代码示例，但你在这里：

```
#include <openssl/sha.h>

bool simpleSHA256(void* input, unsigned long length, unsigned char* md)
{
    SHA256_CTX context;
    if(!SHA256_Init(&context))
        return false;

    if(!SHA256_Update(&context, (unsigned char*)input, length))
        return false;

    if(!SHA256_Final(md, &context))
        return false;

    return true;
} 
```

用法：

```
unsigned char md[SHA256_DIGEST_LENGTH]; // 32 bytes
if(!simpleSHA256(<data buffer>, <data length>, md))
{
    // handle error
} 
```

之后，`md`将包含二进制 SHA-256 消息摘要。其他 SHA 家族成员也可以使用类似的代码，只需将代码中的“256”替换为“256”即可。

如果您有更大的数据，您当然应该在数据块到达时提供数据块（多次`SHA256_Update`调用）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-03-16T13:25:11.127

大文件的@AndiDog 版本适配：

```
static const int K_READ_BUF_SIZE{ 1024 * 16 };

std::optional<std::string> CalcSha256(std::string filename)
{
    // Initialize openssl
    SHA256_CTX context;
    if(!SHA256_Init(&context))
    {
        return std::nullopt;
    }

    // Read file and update calculated SHA
    char buf[K_READ_BUF_SIZE];
    std::ifstream file(filename, std::ifstream::binary);
    while (file.good())
    {
        file.read(buf, sizeof(buf));
        if(!SHA256_Update(&context, buf, file.gcount()))
        {
            return std::nullopt;
        }
    }

    // Get Final SHA
    unsigned char result[SHA256_DIGEST_LENGTH];
    if(!SHA256_Final(result, &context))
    {
        return std::nullopt;
    }

    // Transform byte-array to string
    std::stringstream shastr;
    shastr << std::hex << std::setfill('0');
    for (const auto &byte: result)
    {
        shastr << std::setw(2) << (int)byte;
    }
    return shastr.str();
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-04-29T21:58:07.983

命令行中的正确语法应该是

```
echo -n "compute sha1" | openssl sha1 
```

否则你也会散列尾随的换行符。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-10T12:18:23.527

这是使用*BIO*计算*sha-1*摘要的*OpenSSL*示例：

 **```
#include <openssl/bio.h>
#include <openssl/evp.h>

std::string sha1(const std::string &input)
{
    BIO * p_bio_md  = nullptr;
    BIO * p_bio_mem = nullptr;

    try
    {
        // make chain: p_bio_md <-> p_bio_mem
        p_bio_md = BIO_new(BIO_f_md());
        if (!p_bio_md) throw std::bad_alloc();
        BIO_set_md(p_bio_md, EVP_sha1());

        p_bio_mem = BIO_new_mem_buf((void*)input.c_str(), input.length());
        if (!p_bio_mem) throw std::bad_alloc();
        BIO_push(p_bio_md, p_bio_mem);

        // read through p_bio_md
        // read sequence: buf <<-- p_bio_md <<-- p_bio_mem
        std::vector<char> buf(input.size());
        for (;;)
        {
            auto nread = BIO_read(p_bio_md, buf.data(), buf.size());
            if (nread  < 0) { throw std::runtime_error("BIO_read failed"); }
            if (nread == 0) { break; } // eof
        }

        // get result
        char md_buf[EVP_MAX_MD_SIZE];
        auto md_len = BIO_gets(p_bio_md, md_buf, sizeof(md_buf));
        if (md_len <= 0) { throw std::runtime_error("BIO_gets failed"); }

        std::string result(md_buf, md_len);

        // clean
        BIO_free_all(p_bio_md);

        return result;
    }
    catch (...)
    {
        if (p_bio_md) { BIO_free_all(p_bio_md); }
        throw;
    }
} 
```

虽然它比从*OpenSSL*`SHA1`调用函数要长，但它更通用，可以重新设计用于文件流（从而处理任何长度的数据）。

 ** * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-02-21T19:36:38.337

**@Nayfe 代码的**C 版本，从文件生成 SHA1 哈希：****

 **```
#include <stdio.h>
#include <openssl/sha.h>

static const int K_READ_BUF_SIZE = { 1024 * 16 };
unsigned char* calculateSHA1(char *filename)
{
    if (!filename) {
        return NULL;
    }

    FILE *fp = fopen(filename, "rb");
    if (fp == NULL) {
        return NULL;
    }

    unsigned char* sha1_digest = malloc(sizeof(char)*SHA_DIGEST_LENGTH);
    SHA_CTX context;

    if(!SHA1_Init(&context))
        return NULL;

    unsigned char buf[K_READ_BUF_SIZE];
    while (!feof(fp))
    {
        size_t total_read = fread(buf, 1, sizeof(buf), fp);
        if(!SHA1_Update(&context, buf, total_read))
        {
            return NULL;
        }
    }
    fclose(fp);

    if(!SHA1_Final(sha1_digest, &context))
        return NULL;

    return sha1_digest;
} 
```

它可以按如下方式使用：

```
unsigned char *sha1digest = calculateSHA1("/tmp/file1"); 
```

**res**变量包含 sha1 哈希。

您可以使用以下 for 循环将其打印在屏幕上：

```
char *sha1hash = (char *)malloc(sizeof(char) * 41);
sha1hash[40] = '\0';
int i;
for (i = 0; i < SHA_DIGEST_LENGTH; i++)
{
    sprintf(&sha1hash[i*2], "%02x", sha1digest[i]);
}
printf("SHA1 HASH: %s\n", sha1hash); 
```

# iphone - 一台 Mac 上有两个 iPhone 开发许可证？

> ID：918678
> 
> 赞同：3
> 
> 时间：2009-05-28T00:46:58.443
> 
> 标签：iphone

我有一个奇怪的情况。我有一台用于工作的 macbook，并且我是经过批准的 iPhone 开发人员等。我想构建 iPhone 应用程序以我的名义发布（它们应该与我拥有的工作许可证分开保存和跟踪，因为那真的属于该组织而不是我），但我不想再购买一台 Mac。我可以在我的 Macbook 上创建另一个管理员用户帐户，该帐户将与另一个（个人）开发人员证书一起使用，还是每台机器只能有一个开发许可证？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T00:53:30.850

我也处于同样的情况。您可以在该机器上使用相同的 Mac 和相同的帐户。

为您的公司设置开发人员证书时，只需按照与之前相同的步骤操作即可。本质上，您的钥匙串将包含多个可用于签署应用程序的证书。

您使用的证书是通过 XCode 逐个应用程序选择的。

# jquery - 将 JQuery 与 JSF 集成

> ID：918682
> 
> 赞同：3
> 
> 时间：2009-05-28T00:50:02.323
> 
> 标签：jquery, json, jsf

我有一个主要使用 Richfaces 的 JSF 应用程序。我想介绍一个功能更丰富的网格控件，比如基于 jQuery 的[jqgrid](http://www.trirand.com/blog/)。是否可以从 JSF 支持 bean 获取 JSON 数据？如果没有，是否有替代方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T15:38:18.583

这里可能有几个选择。

1.  Bean 方法可以返回一个字符串，它只是一个 JSON 字符串

    ```
    public String getSearchResult(){ 
         results = SearchService.getResults();
         return JsonHelper.convertToJson(results);
    } 
    ```

    您可以使用 JsonLib 将 Java 对象转换为 Json。

2.  使用不同的 Servlet 为网格请求提供服务

    我会推荐这种方法。原因是您可以有一个 JSON 请求，然后是一个 JSON 响应，而无需打扰 JSF。因为我不认为当你使用 jQuery 时你需要使用 JSF。所以不要在其中混入 JSF，这种情况下可以直接绕过 JSF 层。因为在这里没有意义。这是我使用的方法。我可以与你分享代码来实现这一点。

3.  使用 JSF 阶段侦听器返回 Json 响应。

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-26T14:16:37.833

您还可以将 JAX-RS 用于返回 JSON 对象的 REST 服务。JAX-RS 和 JSF 都是 Java EE 6 的一部分。此外，通过新的 JEE6 依赖注入 (CDI)，您可以轻松地在 JSF 托管 bean 和 JAX-RS 服务之间共享会话状态 - JSF 托管 bean 可以@Inject 注入一个服务等级。

# mysql - 如何在 mysql 中创建唯一依赖项？

> ID：918694
> 
> 赞同：1
> 
> 时间：2009-05-28T00:54:44.107
> 
> 标签：mysql

我很难找到在表中创建唯一依赖项的文档，例如，有 2 列，每列可以有多个相似的值，但绝不能有 2 行，两列都具有相同的值（如在另一排）...

换句话说...

```
 colA       colB
row1  1          2  //this is ok
row2  1          3  //this is ok
row3  2          2  //this is ok
row4  2          2  //this would NOT be ok, because this is just like row 3, and that combination should be unique. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T01:20:00.313

听起来您只想对相关列进行 UNIQUE 约束。在 MySQL 中类似于：

```
ALTER TABLE MyTable ADD UNIQUE (colA, colB); 
```

# ajax - 如何为两个不同的 Web 应用程序创建一个选项卡式界面以显示为一个页面

> ID：918696
> 
> 赞同：0
> 
> 时间：2009-05-28T00:55:30.253
> 
> 标签：ajax, jsp

我们有两个独立的网络应用程序，比如“retailUI”和“bulkUI”。这两个基本上是两个独立的 Web 应用程序（在同一个业务域中）。现在，我们已经要求我们通过选项卡式界面（作为 PoC）使两者在一个页面中协同工作。
我的问题是这两个应用程序都跨越了许多用于导航的 JSP 页面。
有没有办法可以使用某种框架或其他方法来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T01:23:28.527

如果你想尽可能地保持这两个应用程序现在的样子，而不是完全重写它们，你必须使用 iframe。这意味着每个选项卡的内容实际上是一个 iframe。

对于这种情况，我发现 ExtJS 用户开发的组件 ManagedIFrame 非常有用，顾名思义，它是一个托管 iframe。使用它，您的 iframe 可以相互交互（例如从一个到另一个发送消息、侦听器等）。
仔细规划侦听器并通过检查对等方是否在那里进行注册，您可以构建此集成应用程序而无需渲染两个单独的应用程序独立运行时无法操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T01:15:43.097

听起来您最简单的选择是使用[Frames](http://www.htmlcodetutorial.com/frames/frames.html)。为此，您的两个 Web 应用程序中的每一个都将是包装器 Web 应用程序的框架。然后，您将根据要激活的框架隐藏或显示框架。

这将允许您在每个应用程序中拥有单独的导航，并且这两个应用程序不一定必须了解彼此的任何信息。

# visual-studio-2008 - 当我将项目添加到解决方案时，如何使 Visual Studio 自动添加引用？

> ID：918697
> 
> 赞同：3
> 
> 时间：2009-05-28T00:57:08.970
> 
> 标签：visual-studio-2008, reference, class-library

编程（到目前为止）对我来说只是一种爱好，所以我试图找到改进的方法，学习一些将来可能会派上用场的基本算法和编程技能。目前，我正在通过[Project Euler](http://www.projecteuler.net)以自己的方式工作并解决那里的难题。

我在 C# 中工作，并设置了一个名为 ProjecEuler 的解决方案，我在其中为每个问题添加了一个新的控制台应用程序项目。（我知道，考虑到内存效率等，也许不是最终设置，但它很容易做也很容易运行，我只是为自己做这个......）

然而，随着问题变得越来越复杂，我发现自己不断重复使用相同的代码，所以我添加了一个 ClassLibrary 项目，在其中放置了我可能在多个项目中需要的有用代码。但是每次我在解决方案中添加一个新项目时，我都必须手动添加对类库的引用。当我每工作小时添加几个项目时，它变得非常乏味。

**有没有办法告诉 Visual Studio 我希望解决方案中的*所有*项目都继承类库，并让 VS 自动添加引用？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T01:13:33.837

是的。您可以创建一个控制台项目，添加您需要的所有引用，然后将其导出（文件 > 导出模板）作为项目模板。在此之后，您的项目模板将在 Visual Studio 中可用。

这个 VS 功能非常有用，您可以自定义模板的许多方面。我鼓励你花一些时间玩这个！

希望这可以帮助！

# objective-c - 为什么 Objective-C 委托通常被赋予属性分配而不是保留？

> ID：918698
> 
> 赞同：176
> 
> 时间：2009-05-28T00:57:31.793
> 
> 标签：objective-c, ios, cocoa, delegates

我正在浏览由 Scott Stevenson 维护的精彩博客，我试图理解一个基本的 Objective-C 概念，即为代表分配“分配”属性与“保留”。请注意，两者在垃圾收集环境中是相同的。我最关心的是基于非 GC 的环境（例如：iPhone）。

直接来自 Scott 的博客：

“assign 关键字将生成一个 setter，它直接将值分配给实例变量，而不是复制或保留它。这最适合 NSInteger 和 CGFloat 等原始类型，或者您不直接拥有的对象，例如委托。”

您不直接拥有委​​托对象是什么意思？我通常会保留我的代表，因为如果我不希望他们陷入深渊，保留会为我解决这个问题。我通常将 UITableViewController 从其各自的数据源和委托中抽象出来。我也保留了那个特定的对象。我想确保它永远不会消失，所以我的 UITableView 总是有它的委托。

有人可以进一步解释我在哪里/为什么错了，这样我就可以理解 Objective-C 2.0 编程中使用委托而不是保留的分配属性的常见范例？

谢谢！

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2009-05-28T01:10:53.903

避免保留代表的原因是您需要避免保留周期：

A 创建 B A 将自己设置为 B 的委托人…… A 由其所有者释放

如果 B 保留了 A，A 将不会被释放，因为 B 拥有 A，因此 A 的 dealloc 将永远不会被调用，从而导致*A 和 B*都泄漏。

您不应该担心 A 会消失，因为它拥有 B 并因此在 dealloc 中摆脱了它。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-05-28T01:11:44.230

因为发送委托消息的对象并不拥有委托。

很多时候，情况正好相反，例如当控制器将自己设置为视图或窗口的委托时：控制器拥有视图/窗口，因此如果视图/窗口拥有它的委托，则两个对象将相互拥有。当然，这是一个保留循环，类似于具有相同后果的泄漏（应该死的对象仍然活着）。

其他时候，对象是对等的：没有一个拥有另一个，可能是因为它们都属于同一个第三个对象。

无论哪种方式，具有委托的对象都不应保留其委托。

（顺便说一句，至少有一个例外。我不记得是什么，而且我认为没有充分的理由。）

* * *

**附录**（2012-05-19 添加）：在 ARC 下，您应该`weak`使用`assign`. 弱引用会`nil`在对象死亡时自动设置，从而消除委托对象最终向死亡委托发送消息的可能性。

如果您出于某种原因远离 ARC，至少将`assign`指向对象的属性更改为`unsafe_unretained`，这明确表明这是对对象的未保留但非归零的引用。

`assign`仍然适用于 ARC 和 MRC 下的非对象值。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-28T15:17:46.473

请注意，当您有一个要分配的委托时，无论何时要解除分配对象，始终将该委托值设置为 nil 非常重要 - 因此，如果对象没有，则应始终小心在 dealloc 中将委托引用归零在其他地方这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-28T10:01:51.470

其背后的原因之一是避免保留周期。只是为了避免 A 和 B 两个对象相互引用并且它们都没有从内存中释放的情况。

Acutally **assign**最适合原始类型，如 NSInteger 和 CGFloat，或您不直接拥有的对象，如委托。

# html - 是否有可靠的方法将内容定位到 div 的两侧，并且仅在用户的分辨率允许时才显示？

> ID：918700
> 
> 赞同：4
> 
> 时间：2009-05-28T00:58:45.300
> 
> 标签：html, css

我有这样的标记（为了争论）

```
<div id="content"></div>
<div id="layout"></div>
<div id="layout2"></<div> 
```

然后我使用这个 CSS

```
#content {
    width: 800px;
    height: 600px;
    margin: 0 auto;
} /* place this attached to the top of the page */

#sidebar,
#sidebar2 {
    display: block;
    width: 139px;
    height: 100%;
    position: absolute;
    top: 0;
    background: url(../images/layout/pretty.png) repeat-y;
}

#sidebar {
    left: 50%;
    margin-left: -700px;
} /* at this point, it appears to the left, and does not trigger scrolling when the window is resized.. it just slides off to the left */

#sidebar2 {
    right: 50%;
    margin-right: -700px;
} /* now, when you resize, the scrollbar appears as if the content stretches from #sidebar to #sidebar2 */ 
```

有没有可靠的方法来做到这一点？我唯一的其他选择是有一个大的背景图像，也就是说 1200 像素宽，我的左右重复设计.. 但如果我能让它工作，这似乎很麻烦。

所以我的问题是，有没有办法定位 2 个不会影响浏览器对页面宽度的解释的 div（即，当您调整更窄或更小的分辨率时，这些 div 只是隐藏在视口之外？）

谢谢！

**编辑**

感谢您的答案，但没有人能够给我我想要的东西。重要的是这些出现在外面的 div 必须与 #content div 相关。它们需要出现在左侧和右侧，并与#content 对接。但是，一旦浏览器窗口的大小调整到无法容纳它们，它们就会消失*在*视口下。我宁愿不使用`overflow-x: hidden`，因为我希望具有小分辨率/窗口的人能够左右滚动以查看所有内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T02:02:28.400

这是可能的，因为我已经做到了。

诀窍是在绝对定位的 div 上使用负边距。由于某种原因，浏览器不会尝试以这种方式为从页面中拉出的对象提供滚动。

您也可以使用溢出：隐藏。当 div 本身缩小时，这将开始裁剪你的 div 内容（确保 div 使用百分比或自动宽度，这样它实际上会缩小）。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Cropped sides (no scrollbars)</title>
<style>
div.decor {
    border: 3px solid red;
    overflow: hidden;
    position: absolute;
    width: 48%;
    height: 500px;
    top: 2%;
}
div.content {
    width: 60%;
    height: 300px;
    margin: 100px auto;
    padding: 10px;
    background-color: #DDF;
    opacity: 0.7;
    position: relative; /*hmmm.. without this content goes behind decor regardless of z-index... why?*/
}
</style>
</head>

<body>

    <div class="decor" style="right:50%"><img src="images/teacher.jpg" width=400 style="position:absolute;right:0px;"></div>
    <div class="decor" style="left:50%"><img src="images/teacher.jpg" width=400></div>

    <div class="content">lorem ipsum</div>
</body>

</html> 
```

演示：[http ://test.dev.arc.net.au/cropped_sides.html](http://test.dev.arc.net.au/cropped_sides.html)

关键点：

*   溢出：隐藏在绝对定位的装饰 div 上
*   right:0 在左侧装饰 div 的内容上（强制从左侧裁剪）
*   无论z-index如何，未定位的内容都在装饰后面，但我不知道为什么。简单的解决方法是在内容包装器上使用相对位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T19:01:47.270

绝对定位非常简单。您可以绝对定位背景并为其分配比主要内容更低的 z-index。右侧示例 - 为清楚起见添加了背景颜色：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>Absolute Test</title>
<style type="text/css">
#content {
position: relative;
    width: 800px;
    height: 600px;
    margin: 0 auto;
background-color: blue;
z-index: 100;
} /* place this attached to the top of the page */
#layout2 {
height: 100px;
width: 100px;
z-index: 1;
position: absolute;
right: 50px;
top: 100px;
background-color: yellow;
}
</style>
</head>
<body>
<div id="content"></div>
<div id="layout"></div>
<div id="layout2"></<div>
</body>
</html> 
```

也适用于图片：

```
#layout2 {
height: 600px;
width: 100px;
z-index: 1;
position: absolute;
right: 50px;
top: 0;
background: url(right-side.gif) repeat-y; 
```

绝对定位会将其从流程中移除，因此浏览器不会将背景宽度添加到窗口大小。由于您的内容是固定宽度，因此它甚至适用于 IE6。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T01:59:24.303

当浏览器窗口足够宽以处理这两种情况时，您可以使用 JavaScript 使额外的 div 可见。我不知道让浏览器忽略布局的 div 而不实际隐藏它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T02:02:52.380

是的，您可以这样做，但只能在屏幕左侧。

如果右侧（视口之外）有任何内容，浏览器将添加水平滚动条。唯一的例外是如果您关闭滚动条，但这不能仅在所有浏览器中水平完成。

回到左侧的想法...位于视口左侧的元素不会导致水平滚动条。您可以有一个以屏幕为中心的固定宽度布局（任一侧的自动边距），然后在该区域内，您可以绝对在左侧空间中放置一个新列。如果浏览器视口很窄，您将看不到它，如果它很宽，它将完全可见且可用。唯一的问题是如果它在中间的一半——你的左栏会被砍掉——这看起来有点乱！

另一种选择是使用 JavaScript 检测视口的宽度，并且仅在有空间时才显示该列？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T23:56:56.017

或者，您可以将两个“浮动”div 放置在设置为最大宽度的容器 div 中，并将“溢出”设置为“隐藏”。

这是最简单的方法！

IE。有这样的效果：

```
<div id="wrap">
<div id="left></div>
<div id="center"></div>
<div id="right"></div>
</div> 
```

CSS：

```
#wrap{
    width:800px;
    overflow:hidden;
} 
```

# c++ - C+ 中的链表节点

> ID：918702
> 
> 赞同：0
> 
> 时间：2009-05-28T00:59:34.317
> 
> 标签：c++, linked-list

我正在学习一本关于数据结构的书，并在链表示例中编译了他们的节点，我收到了这个错误：

```
 and Everything.cpp|7|error: expected unqualified-id before "int"|
 and Everything.cpp|7|error: expected `)' before "int"|
||=== Build finished: 2 errors, 0 warnings ===| 
```

该节点的代码是：

```
typedef struct Node
{
    struct Node(int data)    //Compile suggest problem is here
    {
        this-> data = data;
        previous = NULL;
        next = NULL;
    }
    int data;
    struct Node* previous;
    struct Node* next;
} NODE; 
```

我不熟悉结构，我正在使用 Code::blocks 进行编译。有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T01:04:03.823

代码示例是错误的。`struct`构造函数声明前面不应该有关键字。它应该是：

```
typedef struct Node
{
    Node(int data)  // No 'struct' here
    {
        this-> data = data;
        previous = NULL;
        next = NULL;
    }
    int data;
    struct Node* previous;
    struct Node* next;
} NODE; 
```

# c# - 我可以详细检查 OOP 的示例项目

> ID：918704
> 
> 赞同：1
> 
> 时间：2009-05-28T01:00:12.800
> 
> 标签：c#, types, design-patterns

我一直在研究接口、类和结构类型，我真的很想学习高级而简单的模式来正确理解这些类型并有效地使用它们。

有没有你知道的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T01:19:28.627

总有企业 FizzBu​​zz。

[http://wolfbyte-net.blogspot.com/2007/09/if-something-is-worth-doing.html](http://wolfbyte-net.blogspot.com/2007/09/if-something-is-worth-doing.html)

说真的，我已经多次提到这个项目，以了解如何很好地进行设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T02:27:47.633

这可能有点矫枉过正，而且代码有点太多，但你可以看看微软的企业库（EntLib）。源代码可供下载。它由模式和实践团队组成，并且大多数肯定使用了许多 oop 原则。

它包括用于包含在您的项目中的应用程序块，例如缓存、密码学、数据访问、异常处理、日志记录、策略注入、安全性、验证和 Unity。

[EntLib 链接](http://msdn.microsoft.com/en-us/library/cc512464.aspx)

# c# - 什么样的情况下我需要使用 C# 的事件

> ID：918711
> 
> 赞同：0
> 
> 时间：2009-05-28T01:03:04.997
> 
> 标签：c#, .net, events

我正在研究 C# 中的事件，但没有太多文章或信息告诉我我需要在哪里或什么样的位置使用事件。

有人可以给我一个现实世界的例子，让他们更容易理解。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T09:26:59.020

正如 Chris Gray 所说，一种用途是在您的代码没有直接调用的事情发生时发出信号。这里最常见的原因可能是用户在 GUI 上的操作。另一个示例可能是在另一个线程上完成的异步操作。

使用事件的另一个原因是当您不知道谁可能对刚刚发生的事情感兴趣时。引发事件的类不需要知道（在设计时）有多少其他类可能感兴趣的实例。

```
class Raiser {

   public DoSomething() {
      //Do something long winded.
      OnDidSomething(new DidSomethingEventArgs());
   }

   public EventHandler<DidSomethingEventArgs> DidSomething;

   private OnDidSomething(DidSomethingEventArgs e) {
      if (DidSomething != null)
         DidSomething(this, e);
   }
} 
```

显然，您还需要定义传递有关事件的相关数据的 DidSomethingEventArgs 类。这也说明了事件的通用命名约定。如果事件被称为 X，那么事件只会在称为 OnX 的方法中引发，并且它传递的任何数据都是类 XEventArgs 的实例。请注意，如果没有订阅者订阅事件，则事件可以为 null，因此在我们引发事件之前进行检查。

请注意，此类对其他类可能对它做了某事这一事实感兴趣一无所知。它只是宣布它已经做到了这一事实。

然后多个类可以监听该事件：

```
class ListenerA {
   private Raiser r;

   ListenerA(Raiser r) {
      this.r = r;
      r.DidSomething += R_DidSomething;
   }

   R_DidSomething(object sender, DidSomethingEventArgs e) {
      //Do something with the result.
   }
} 
```

和：

```
class ListenerB {

   private Raiser r;

   ListenerB(Raiser r) {
      this.r = r;
      r.DidSomething += R_DidSomething;
   }

   R_DidSomething(object sender, DidSomethingEventArgs e) {
      //Do something with the result.
   }
} 
```

现在，当在 Raiser 实例上调用 DoSomething 方法时，ListenerA 和 ListenerB 的所有实例都将通过 DidSomething 事件得到通知。请注意，侦听器类可能很容易位于引发者的不同程序集中。他们需要引用返回者的程序集，但不需要引用其侦听器的程序集。

请注意，上述简单的 Raiser 示例可能会导致您在多线程程序中出现一些问题。一个更健壮的示例将使用以下内容：

```
class Raiser {

   public DoSomething() {
      //Do something long winded.
      OnDidSomething(new DidSomethingEventArgs());
   }

   #region DidSomething Event

   private object _DidSomethingLock = new object();
   private EventHandler<DidSomethingEventArgs> _DidSomething;

   public EventHandler<DidSomethingEventArgs> DidSomething {
      add { lock(_DidSomethinglock) _DidSomething += value; }
      remove { lock(_DidSomethinglock) _DidSomething -= value; }
   }

   OnDidSomething(DidSomethingEventArgs e) {
      EventHandler<DidSomethingEventArgs> handler;
      lock (_DidSomethingLock)
         handler = _DidSomething;
      if (handler == null)
         return;
      try {
         DidSomething(this, e);
      } catch (Exception ex) {
         //Do something with the exception
      }
   }

   #endregion
} 
```

这可确保在您引发事件的过程中，另一个线程添加或删除侦听器不会导致问题。

如果正在创建和销毁侦听器类的实例，则此处使用的简单侦听器也会导致内存泄漏。这是因为 Raiser 实例在订阅事件时会传递（并存储）对每个侦听器的引用。这足以防止垃圾收集器在删除所有显式引用时正确清理侦听器。解决此问题的最佳方法可能是使侦听器实现 IDisposable 接口并取消订阅 Dispose 方法中的事件。然后你只需要记住调用 Dispose 方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T01:11:10.937

我通常看到的最实际的例子是用户交互。让我们使用一个 Button 作为一个具体的例子。单击按钮时，您显然希望发生一些事情。假设我们调用“SaveSettings()”。但是，我们不想将“SaveSettings()”硬编码到按钮中。按钮将命令 SaveSettings() 发生。显然，这会阻止按钮可重用 - 除了设置对话框之外，我们不能在任何地方使用调用 SaveSettings() 的按钮。为了避免为每个按钮编写相同的按钮代码，每个按钮调用不同的函数，我们使用一个事件。

按钮不是直接*调用*函数，而是*宣布*它已被单击。从那里，按钮的责任就结束了。其他代码可以监听该公告或事件，并执行特定的操作。

因此，在我们的 SaveSettings 示例中，设置对话框代码找到“确定”按钮并监听其“我被点击”通知，当它被触发时，调用 SaveSettings()。

事件可以变得非常强大，因为任意数量的不同侦听器都可以等待同一个事件。事件可以调用很多东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T01:20:39.857

肯定的事。将事件视为在系统中完成您的代码未直接调用的某事时发生的通知。在 C# 中，当事件“触发”时运行代码真的很容易

例如，当用户按下按钮时，将引发事件或后台网络操作完成时。在 C# 中，您使用 += 语义附加到事件触发时将“发出信号”的事件。

我为您制作了一个简单的 C# winforms 程序——在其中我使用 Visual Studio“设计器”添加了一个按钮（我只是将一个按钮从工具箱拖到窗口中）。

你会看到“button1.Click”这一行——在这种情况下，我想在引发“Click”事件时做一些事情。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace events
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            button1.Click += new EventHandler(button1_Click);
        }

        void button1_Click(object sender, EventArgs e)
        {
            MessageBox.Show("Hi!");
        }
    }
} 
```

您还将在实践中看到其他类型的事件，例如：

*   网络操作已完成（[WebClient.DownloadFileCompleted](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)）
*   用户界面（例如调整窗口大小）
*   [定时器](http://msdn.microsoft.com/en-us/library/system.timers.timer(VS.71).aspx)（在 10 分钟内启动定时器）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T01:09:24.467

假设您正在开发一个 UI。您创建一个小部件并将其添加到主窗体。当您的小部件中发生某些事情时，您可以使用事件来触发表单上的某些操作 - 禁用其他按钮等。

就像按钮的点击事件是如何工作的一样。

# java - 在 Java 中的回调和匿名类方面需要帮助

> ID：918721
> 
> 赞同：6
> 
> 时间：2009-05-28T01:08:26.763
> 
> 标签：java, callback, scope, anonymous-class

我正在使用一些第三方库通过异步协议连接到服务器并获得响应。例如，通过用户名获取用户 ID 的方法如下所示：

```
public int getUserid(String username) {
        int userid = 0;

    connection.call("getUserid", new Responder() {
        public void onResult(final int result) {
            System.out.println("userid: " + result);
            //how to assign received value to userid and return it?
        }
    }, username);

    //wait for response
    while (userid == 0) {
            try{
                Thread.sleep(100);
            } catch (Exception e) {}
        }

        return userid;
} 
```

问题是我无法将服务器响应返回的“结果”分配给方法中的“userid”变量（以便之后返回）。如何解决这个问题？我可能可以将它分配给某个类变量而不是方法变量，但我想将它保留在方法范围内，这样我就不必处理并发问题。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T01:14:26.500

如果我正确理解了您的问题，那么您是在问如何从匿名类中编写变量。

匿名类只能访问最终变量，不能直接“写入”它们。

一个“足够好”的直接解决方案是创建一种具有单个值字段和一个 getter 和 setter 的 ValueBox 类。然后，您可以在函数中实例化一个新变量作为最终变量，并让您的匿名类访问它。匿名类将使用它的 getter 和 setter 来写入/读取。

变量是 final 的事实只是意味着您不能将引用指向其他任何地方，但您仍然可以从任一函数更改引用对象的内容。

您将遇到的更大问题是等待回调被调用。这种等待睡眠可能已经足够好了，但您可能需要考虑超时、线程等，具体取决于您要实现的目标。

此外，这一切都假设您永远不会在连接上调用它两次。否则，您需要向我们提供有关您的同步模型的更多信息。

这是一些示例代码：

```
public int getUserid(String username) {
        final ValueBox<Integer> userid = new ValueBox<Integer>();

        connection.call("getUserid", new Responder() {
                public void onResult(final int result) {
                        System.out.println("userid: " + result);
                        userId.setValue(result);
                        //how to assign received value to userid and return it?
                }
        }, username);

        //wait for response
        while (userid.isEmpty()) {
                try{
                        Thread.sleep(100);
                } catch (Exception e) {}
        }

      return userid.getValue();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T01:16:15.000

最简单的更改是使用类似`java.util.concurrent.SynchronousQueue`. 但可能您想自己提供一个事件驱动的接口。

# iphone - 带有 contentsRect 抖动的核心动画

> ID：918734
> 
> 赞同：2
> 
> 时间：2009-05-28T01:12:34.960
> 
> 标签：iphone, core-animation

在我的（拼图）游戏中，每件作品都使用 a 绘制在屏幕上`CALayer`。有 48 块（在 8x6 网格中），每块为 48x48 像素。我不确定这是否只是太多层，但如果这不是最好的解决方案，我不知道是什么，因为每帧使用 Quartz2D 重绘整个显示器似乎不会更快。

无论如何，这些片段的图像来自一个大的 PNG 文件，该文件具有 24 帧动画，用于 10 种不同的状态（因此尺寸为 1152 x 480 像素），动画是通过在我移动它时设置`contentsRect`每个属性来完成的。`CALayer`

这实际上似乎工作得很好，最多 7 个部件跟踪窗口中的一个触摸点，但奇怪的是，当我最初开始移动这些部件时，前 0.5 秒左右，它就像 CPU 一样非常生涩做其他事情，但之后它会以 40+ FPS 的速度跟踪和更新屏幕（根据 Instruments）。

那么有没有人知道什么可以解释最初的抽搐？

我能想出的唯一理论是将PNG文件的位解压缩到一个临时位置，然后在动画停止后丢弃它们，在这种情况下有没有办法阻止Core Animation这样做？

我显然可以将 PNG 文件分成 10 块，但我不相信这会有所帮助，因为它们都（可能）仍然需要立即存储在内存中。

**编辑：**好的，如第一个答案的评论中所述，我已将图像分成十块，现在为 576 x 96，以适应硬件的限制。尽管如此，它仍然没有应有的顺利，所以我对此给予了赏金。

**EDIT2：**我已经链接了下面的图片之一。本质上是跟踪用户的触摸，计算从跟踪开始的偏移量（他们可以水平或垂直移动一次，一次只能移动一个位置）。然后选择其中一个图像作为图层的内容（取决于它是什么类型的块以及它是水平移动还是垂直移动）。然后将`contentsRect`属性设置为从较大的图像中选择一个 48x48 帧，如下所示：-

```
layer.position = newPos;
layer.contents = (id)BallImg[imgNum];
layer.contentsRect = CGRectMake((1.0/12.0)*(float)(frame % 12), 
                                0.5 * (float)(frame / 12), 
                                1.0/12.0, 0.5); 
```

顺便提一句。我关于它每次都重新解压缩源图像的理论是不正确的。我编写了一些代码，在应用程序加载时将解码后的 PNG 文件中的原始像素复制到一个新的文件`CGImage`中，并且没有任何区别。

接下来我将尝试将每一帧复制到一个单独的帧中，这至少`CGImage`可以消除丑陋的计算。`contentsRect`

![示例图像](https://i.stack.imgur.com/Wxm6J.png)

**EDIT3：**进一步回归基础的调查表明这是触摸跟踪的问题，而不是核心动画的问题。我找到了一个跟踪触摸的基本示例应用程序，并注释掉了实际上导致屏幕重绘的代码，并且`NSLog()`显示了我一直遇到的完全相同的问题：第一个事件`touchesBegin`和第一个`touchesMoved`事件之间的延迟很长。

```
2009-06-05 01:22:37.209 TouchDemo[234:207] Begin Touch ID 0 Tracking with image 2
2009-06-05 01:22:37.432 TouchDemo[234:207] Touch ID 0 Tracking with image 2
2009-06-05 01:22:37.448 TouchDemo[234:207] Touch ID 0 Tracking with image 2
2009-06-05 01:22:37.464 TouchDemo[234:207] Touch ID 0 Tracking with image 2
2009-06-05 01:22:37.480 TouchDemo[234:207] Touch ID 0 Tracking with image 2 
```

事件之间的典型间隔`touchesMoved`为 20 毫秒。`touchesBegin`第一个和第一个之间的差距`touchesMoved`是那个的十倍。这根本不需要计算或屏幕更新，只是`NSLog`调用。叹。我想我会打开一个单独的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T01:53:32.647

我不认为这是内存问题。我认为这与核心动画方面拥有如此大的图像效率低下有关。

Core Animation 不能原生使用它，因为它超过了 GPU 上的最大纹理大小 (1024x1024)。**我会把它分解一些**；单个图像可能会为您提供最佳性能，但您必须进行测试才能找到答案。

IIRC，UIImageView 通过设置连续的单个图像来制作动画，所以如果它对 Apple 来说足够好......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T16:38:04.400

当涉及性能时，我绝对推荐使用 Shark（也超过 Instruments）。在“时间配置文件”中，您可以看到应用程序中的瓶颈是什么，即使它是 Apple 代码中的某些内容。在开发使用 OpenGL 和 Core Animation 的 iPhone 应用程序时，我经常使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T21:59:08.720

您是否尝试过使用 CATiledLayer？

它针对此类工作进行了优化。

# c++ - 产生幂律分布的随机数生成器？

> ID：918736
> 
> 赞同：31
> 
> 时间：2009-05-28T01:13:20.403
> 
> 标签：c++, math, random, power-law

我正在为 C++ 命令行 Linux 应用程序编写一些测试。我想生成一堆具有幂律/长尾分布的整数。意思是，我经常得到一些数字，但其中大多数相对不频繁。

理想情况下，我可以将一些魔术方程式与 rand() 或 stdlib 随机函数之一一起使用。如果没有，一个易于使用的 C/C++ 块会很棒。

谢谢！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-28T01:40:46.650

This [page at Wolfram MathWorld](http://mathworld.wolfram.com/RandomNumber.html) discusses how to get a power-law distribution from a uniform distribution (which is what most random number generators provide).

The short answer (derivation at the above link):

```
x = [(x1^(n+1) - x0^(n+1))*y + x0^(n+1)]^(1/(n+1)) 
```

where **y** is a uniform variate, **n** is the distribution power, **x0** and **x1** define the range of the distribution, and **x** is your power-law distributed variate.

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-28T01:24:31.567

如果您知道所需的分布（称为概率分布函数 (PDF)）并对其进行了适当的归一化，则可以将其积分以获得累积分布函数 (CDF)，然后反转 CDF（如果可能）以获得您的转换需要从均匀`[0,1]`分布到您想要的。

所以你首先定义你想要的分布。

```
P = F(x) 
```

（对于 [0,1] 中的 x）然后积分给出

```
C(y) = \int_0^y F(x) dx 
```

如果这可以反转，你会得到

```
y = F^{-1}(C) 
```

因此，像最后一行一样调用`rand()`并插入结果并使用 y。`C`

这个结果被称为抽样基本定理。由于规范化要求和分析反转函数的需要，这很麻烦。

或者，您可以使用拒绝技术：在所需范围内统一抛出一个数字，然后抛出另一个数字并在您第一次抛出指定的位置与 PDF 进行比较。如果第二次抛出超过 PDF，则拒绝。对于具有很多低概率区域的 PDF 来说往往效率低下，比如那些长尾的…

An intermediate approach involves inverting the CDF by brute force: you store the CDF as a lookup table, and do a reverse lookup to get the result.

* * *

The real stinker here is that simple `x^-n` distributions are non-normalizable on the range `[0,1]`, so you can't use the sampling theorem. Try (x+1)^-n instead...

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-10-27T22:52:29.403

I just wanted to carry out an actual simulation as a complement to the (rightfully) accepted answer. Although in R, the code is so simple as to be (pseudo)-pseudo-code.

One tiny difference between the [Wolfram MathWorld formula](http://mathworld.wolfram.com/RandomNumber.html) in the accepted answer and other, perhaps more common, equations is the fact that the **power law exponent** `n` (which is typically denoted as alpha) does not carry an explicit negative sign. So the chosen alpha value has to be negative, and typically between 2 and 3.

`x0` and `x1` stand for the lower and upper limits of the distribution.

So here it is:

```
set.seed(0)
x1 = 5           # Maximum value
x0 = 0.1         # It can't be zero; otherwise X^0^(neg) is 1/0.
alpha = -2.5     # It has to be negative.
y = runif(1e7)   # Number of samples
x  = ((x1^(alpha+1) - x0^(alpha+1))*y + x0^(alpha+1))^(1/(alpha+1))
plot(density(x), ylab="log density x", col=2) 
```

[![enter image description here](https://i.stack.imgur.com/i3j8X.png)](https://i.stack.imgur.com/i3j8X.png)

or plotted in logarithmic scale:

```
plot(density(x), log="xy", ylab="log density x", col=2) 
```

[![enter image description here](https://i.stack.imgur.com/c93VB.png)](https://i.stack.imgur.com/c93VB.png)

Here is the summary of the data:

```
> summary(x)
   Min.   1st Qu.  Median    Mean   3rd Qu.    Max. 
  0.1000  0.1208  0.1584    0.2590  0.2511   4.9388 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T02:51:24.900

I can't comment on the math required to produce a power law distribution (the other posts have suggestions) but I would suggest you familiarize yourself with the TR1 C++ Standard Library random number facilities in `<random>`. These provide more functionality than `std::rand` and `std::srand`. The new system specifies a modular API for generators, engines and distributions and supplies a bunch of presets.

The included distribution presets are:

*   `uniform_int`
*   `bernoulli_distribution`
*   `geometric_distribution`
*   `poisson_distribution`
*   `binomial_distribution`
*   `uniform_real`
*   `exponential_distribution`
*   `normal_distribution`
*   `gamma_distribution`

When you define your power law distribution, you should be able to plug it in with existing generators and engines. The book *The C++ Standard Library Extensions* by Pete Becker has a great chapter on `<random>`.

[Here is an article](http://www.johndcook.com/cpp_TR1_random.html) about how to create other distributions (with examples for Cauchy, Chi-squared, Student t and Snedecor F)

# c# - 唯一字符串 C# 的有效列表

> ID：918742
> 
> 赞同：91
> 
> 时间：2009-05-28T01:13:54.583
> 
> 标签：c#, unique-values

存储忽略任何重复的字符串列表的最有效方法是什么？我在想字典可能最好通过编写 dict[str] = false; 来插入字符串。并以列表的形式枚举键。这是一个好的解决方案吗？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-05-28T01:17:44.437

如果您使用的是 .NET 3.5，则[HashSet](http://msdn.microsoft.com/en-us/library/bb359438.aspx)应该适合您。

> HashSet<(Of <(T>)>) 类提供高性能的集合操作。集合是不包含重复元素且其元素没有特定顺序的集合。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-05-28T03:04:38.807

你可以看看做这样的事情

```
var hash = new HashSet<string>();
var collectionWithDup = new []{"one","one","two","one","two","zero"}; 

// No need to check for duplicates as the Add method
// will only add it if it doesn't exist already
foreach (var str in collectionWithDup)
    hash.Add(str); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-06-13T09:28:07.727

我不确定这是否算得上一个好的答案，但是当需要一个保持插入顺序的唯一集合时，我并排使用了 HashSet 和 List 妥协。在这种情况下，每当您添加到集合中时，请执行以下操作：

```
if(hashSet.Add(item))
    orderList.Add(item); 
```

删除项目时，请确保将它们从两者中删除。因此，只要您可以确定没有其他任何项目添加到列表中，您将拥有一个按插入排序的唯一集！

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2018-01-02T14:10:46.013

您还可以使用 Linq，如下所示：

```
using System.Linq;

var items = new List<string>() { "one", "one", "two", "one", "two", "zero" };

List<string> distinctItems = items.Distinct().ToList(); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-02-21T08:56:32.297

使用 HashSet，无需检查 .Contains() ，只需将您的项目添加到列表中，如果重复则不会添加。

```
 HashSet<int> uniqueList = new HashSet<int>();
   uniqueList.Add(1); // List has values 1
   uniqueList.Add(2);  // List has values 1,2
   uniqueList.Add(1);  // List has values 1,2
   Console.WriteLine(uniqueList.Count); // it will return 2 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T01:42:24.637

This is not part of the the system namespace but have used the Iesi.Collections from [http://www.codeproject.com/KB/recipes/sets.aspx](http://www.codeproject.com/KB/recipes/sets.aspx) with NHibernate. It has support for hashed set along with sorted set, dictionary set, and so on. Since it has been used with NHibernate it has been used extensively and very stable. This also does not require .Net 3.5

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-08-04T10:55:29.627

这是另一个不使用`HashSet`.

```
var items = new List<string>() { "one", "one", "two", "one", "two", "zero" };
var uniqueItems = items.Where((item, index) => items.IndexOf(item) == index); 
```

它是从这个线程中采用的：[javascript - 数组中的唯一值](https://stackoverflow.com/a/14438954/469829)

测试：

```
using FluentAssertions;

uniqueItems.Count().Should().Be(3);
uniqueItems.Should().BeEquivalentTo("one", "two", "zero"); 
```

和`List`的性能测试。100 万次迭代：`HashSet``SortedSet`

```
List: 564 ms
HashSet: 487 ms
SortedSet: 1932 ms 
```

[测试源代码（要点）](https://gist.github.com/alexeysolonets/e0b64c5b4f9496596f894f4efacb7f4f)

# ruby-on-rails - 单个 Rails 模型中引用的多个外键

> ID：918743
> 
> 赞同：1
> 
> 时间：2009-05-28T01:14:11.650
> 
> 标签：ruby-on-rails

我有一个典型的用户模型（用户名、密码、名称等）。我想允许用户将三个选择的类别附加到他们的帐户中。三个类别中的每一个都存在于类别模型中。

如何在不使用中间表进行跟踪的情况下将类别中的三个外键链接到单个用户？每个类别可以属于任意数量的用户，但每个用户只能拥有三个类别。

我玩过 has_many :through 但我真的不认为关系表是必要的，它会在我的最终产生*大量*编码来使用它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T01:47:59.710

从代码可维护性的角度来看，即使您现在可能希望将用户可以选择的类别数量限制为 3，但您可能不想使用此限制对其进行编码。稍后当您想将其增加到 5 或将其减少到 1 时，您会自责。我的建议是只使用`has_and_belongs_to_many`连接表（您不需要`:through`，因为据我所知，您不需要需要一个连接*模型*，只是一个连接表）。使用 HABTM 将自动使用连接表，因此您不必担心编写代码来处理它。只需确保正确命名连接表及其列即可。

至于实际上将用户限制为仅 3 个类别，只需在视图/控制器中实现该限制（即限制 UI，因此他们不能选择超过 3 个）。

我敢肯定你已经读过这篇文章，但如果你还没有读过，这里是 HABTM 的[文档](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#M001792)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T03:31:52.713

HABTM 是您最好的选择。要将用户限制为三个类别，请添加模型级别验证：

```
class User < ActiveRecord::Base
  has_and_belongs_to_many :categories
  validate :no_more_than_three_categories
protected
  def no_more_than_three_categories
    self.errors.add(:categories, "may not have more than three") if categories.size > 3
  end
end 
```

根据您的判断，将幻数 3 提取到类级别常量或配置设置。

不要害怕代码。做对了，代码会害怕你。

# asp.net - 我可以使用 ASP.NET 路由来做到这一点吗？

> ID：918745
> 
> 赞同：0
> 
> 时间：2009-05-28T01:15:08.467
> 
> 标签：asp.net, routing

我想接受一个像“www.mysite.com/1-2,3”这样的网址，然后把它变成这样的“www.mysite.com/page.aspx?a=1&b=2&c=3”。基本上我想知道使用路由是否有可能丢失 .aspx 部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T01:19:26.443

是的，这是可能的。

[http://msdn.microsoft.com/en-us/library/cc668201.aspx](http://msdn.microsoft.com/en-us/library/cc668201.aspx)

# javascript - 呈现不显眼的 javascript

> ID：918746
> 
> 赞同：0
> 
> 时间：2009-05-28T01:15:28.137
> 
> 标签：javascript, html, dom

在 wikipedia entry Unobtrusive JavaScript 中有一个 obtrusive JavaScript 的例子：

```
<input type="text" name="date" onchange="validateDate(this);" /> 
```

解决方案如下：

```
<input type="text" name="date" />

window.onload = function(){ //Wait for the page to load.
    var inputs = document.getElementsByTagName('input');
    for(var i=0,l=inputs.length;i<l;i++){ 
        input = inputs[i];
        if(input.name && input.name=='date'){ 
            input.onchange = function(){ 
                validateDate();
            }
        }
    }
};

function validateDate(){
    //Do something when the content of the 'input' element with the name 'date' is changed.
} 
```

有没有办法从第二个生成第一个代码示例？换句话说，是否有可能在 JavaScript 作用于页面之后“呈现”页面的 HTML？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T01:50:28.037

JavaScript 可用于呈现 HTML（将元素添加到 DOM），这基本上是解决方案的作用。但是，如果您在`onchange`添加事件后查看页面的源代码，您将看不到它 - 这是因为浏览器仅显示未更改的 DOM。

如果您想浏览更新后的 DOM，请下载[Firebug](http://getfirebug.com) for Firefox。我不能推荐这个工具！

# python - 有没有比 int( byte_buffer.encode('hex'), 16 ) 更好的方法

> ID：918754
> 
> 赞同：3
> 
> 时间：2009-05-28T01:16:47.150
> 
> 标签：python, integer, types, byte

在 Python 中，我经常使用以下序列从字节缓冲区中获取整数值（在 Python 中，这是一个 str）。

我从 struct.unpack() 例程中获取缓冲区。当我使用解压“char”时

```
byte_buffer, = struct.unpack('c', raw_buffer)
int_value = int( byte_buffer.encode('hex'), 16 ) 
```

有没有更好的办法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T01:21:52.697

[struct](http://docs.python.org/library/struct)模块擅长解包二进制数据。

```
int_value = struct.unpack('>I', byte_buffer)[0] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T02:36:26.833

> 限制为 1 个字节 – Noah Campbell 18 分钟前

最好的方法是实例化一个结构解包器。

```
from struct import Struct

unpacker = Struct("b")
unpacker.unpack("z")[0] 
```

请注意，如果您想要一个无符号字节，您可以将“b”更改为“B”。此外，不需要字节序格式。

对于任何想了解无界整数方法的人，请创建一个问题，并在评论中告诉我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T20:40:11.347

如果我们谈论的是获取一个字节的整数值，那么你想要这个：

```
ord(byte_buffer) 
```

不明白为什么还没有建议。

# algorithm - A* 启发式：在多个点中通过一次的最短路径

> ID：918758
> 
> 赞同：6
> 
> 时间：2009-05-28T01:18:15.353
> 
> 标签：algorithm, shortest-path, pacman

我正在尝试为清晰地图的吃豆人游戏提出一个好的和快速的启发式方法。

我的启发式方法是尝试计算 pacman 到达地图上每个点的食物所需的最小距离。我目前的算法基本上是 Prim 的 MST，它可以让我获得 O(n logn) 的运行时间，但不考虑 pacman 需要跟随边缘吃东西以及返回到前一个顶点的情况......

有更好的吗？

换一种说法：不用提笔连接几个点的最低成本是多少？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T02:11:41.940

在运行全对最短路径算法并用食物识别顶点后，这变成了[旅行商问题](http://en.wikipedia.org/wiki/Travelling_salesman_problem)。您无法有效地解决它，但您可以在多项式时间内构建任意好的近似解。除非您可以预先计算所有内容，否则您可能希望使用近似值。如果您可以预先计算事物（或以其他方式保证您有足够的时间来找到精确的解决方案），那么一旦您获得了所有对最短路径，您就可以简单地找到所有可能的最小总步行长度你吃食物的顺序的排列。通过注意两个食物块之间的最短路径何时穿过另一个食物块，这种蛮力方法可能会有所改进。

# batch-file - 命令中带括号的批处理循环

> ID：918759
> 
> 赞同：3
> 
> 时间：2009-05-28T01:18:32.077
> 
> 标签：batch-file, for-loop, escaping

我有一个包含以下代码的批处理文件：

```
for /f "tokens=*" %%a in ('dir /b /a-d') do (
 echo Processing %%a >>%LOG%
 dtsrun /S(local) /NNotesLoad /A"FilePath:8="%NOTESDIR%\%%a" /AClientID=%1 >>%LOG%

 echo Deleting %%a >>%LOG%
 del %%a /q
) 
```

这将返回“/NNotesLoad 此时意外”的错误消息，因为第二个括号有效地关闭了 FOR 块。

我必须将 (local) 保留为 /S 参数。
如何转义 dtsrun 行中的括号？

编辑：原来您可以在 dtsrun 中为本地指定服务器为 .

但我仍然希望得到括号转义的答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T03:08:42.027

转义括号字符的解决方案是使用插入符号 ^ 作为前缀

所以它会这样写：

```
/S^(local^) 
```

# regex - 用于从文件名中提取电影名称的正则表达式

> ID：918760
> 
> 赞同：3
> 
> 时间：2009-05-28T01:18:39.613
> 
> 标签：regex

想象一下，如果您将使用以下字符串：

“一部伟大的电影 (1999) DVDRip.avi”

我希望通过正则表达式从中提取字符串“A Great Movie”，但努力为此获取正确的正则表达式。

我也会使用它来解析各种长度的文件名。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T01:39:29.337

此语法是围绕 .NET 正则表达式解析器设计的（在其他正则表达式引擎中可能不同）：

```
^(?<MovieName>.+)\((?<Year>\d+)\)(?<AdditionalText>[^\.]*)\.(?<Extension>[^\.]*)$ 
```

您可以使用此语法来获取所需的数据：

```
string line = "Movie Text";
Match match = Regex.Match(line);
match.Groups["MovieName"].Value; 
```

如果需要，您还可以提取 Year、AdditionalText 和 Extension。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T01:21:11.557

假设括号前面有一个空格：

```
^(.+)\s\(.+ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T01:47:09.057

匹配到第一个括号的所有内容

```
^([^(]+) 
```

比 Ben 的选择更快（略微）

Python：

```
>>> import re
>>> re.compile("^([^(]+)").match("A Great Movie (1999) DVDRip.avi").groups()
('A Great Movie ',) 
```

# git - git 子模块是在工作副本中拥有工作副本的唯一安全方法吗？

> ID：918768
> 
> 赞同：18
> 
> 时间：2009-05-28T01:19:56.460
> 
> 标签：git, git-submodules

在我的场景中，我有一个程序可以分析数据输入文件并生成其他数据输出文件。我想对程序进行版本控制，并且我想对数据文件进行版本控制，并且根据偏好，我希望在程序的工作副本中拥有数据文件的工作副本。我希望程序和数据分别进行版本控制以减少“噪音”。该程序不依赖于数据文件。

如果我使用 git 子模块，那么当数据目录中发生事情时（我认为是提交的更新），程序的版本控制会注意到子模块有更新。如果程序依赖于数据，这将很有用，但事实并非如此。

在这种情况下，是否可以在不使用 git 子模块的情况下在另一个工作副本中拥有一个工作副本？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-28T02:21:39.673

可以在 Git 中简单地“嵌套”工作副本。因此，如果您克隆您的程序存储库，然后在其中克隆您的数据文件，那么您可以独立使用它们。当 Git 执行文件操作时，它会在目录树中查找*目录*`.git`，因此在数据存储库中执行的 Git 操作不会影响程序存储库。如果这样做，您可能需要添加数据目录的名称`.gitignore`以减少来自程序存储库的干扰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-30T07:39:36.567

在您有需要版本控制的插件的情况下，这也是使用 Heroku 和 rails 的一种有用的解决方法。目前，Heroku 不支持 git 子模块，因此嵌套工作副本似乎是最好的解决方案。在这种情况下，您不希望将插件目录添加到 .gitignore，因为在这种情况下，您将无法在推送到 heroku 时上传插件，但是请注意。希望 Heroku 最终会支持 git 子模块。

# unit-testing - 您如何使依赖于扩展方法的方法可测试？

> ID：918776
> 
> 赞同：4
> 
> 时间：2009-05-28T01:23:25.703
> 
> 标签：unit-testing, c#-3.0, tdd, extension-methods, rhino-mocks

我有一个具有以下签名的扩展方法（在 BuildServerExtensions 类中）：

```
public static IEnumerable<BuildAgent> GetEnabledBuildAgents(
                                          this IBuildServer buildServer,
                                          string teamProjectName)
{
    // omitted agrument validation and irrelevant code
    var buildAgentSpec = buildServer.CreateBuildAgentSpec(teamProjectName);
} 
```

还有另一个调用第一个方法（在 BuildAgentSelector 类中）：

```
public BuildAgent Select(IBuildServer buildServer, string teamProjectName)
{
    // omitted argument validation
    IEnumerable<BuildAgent> serverBuildAgents = 
        buildServer.GetEnabledBuildAgents(teamProjectName);

    // omitted - test doesn't get this far
} 
```

我正在尝试使用 MSTest 和 Rhino.Mocks (v3.4) 对其进行测试：

```
[TestMethod]
public void SelectReturnsNullOnNullBuildAgents()
{
    Mocks = new MockRepository();
    IBuildServer buildServer = Mocks.CreateMock<IBuildServer>();

    BuildAgentSelector buildAgentSelector = new BuildAgentSelector();
    using (Mocks.Record())
    {
        Expect.Call(buildServer.GetEnabledBuildAgents(TeamProjectName)).Return(null);
    }

    using (Mocks.Playback())
    {
        BuildAgent buildAgent = buildAgentSelector.Select(buildServer, TeamProjectName);

        Assert.IsNull(buildAgent);
    }
} 
```

当我运行这个测试时，我得到：

> *`System.InvalidOperationException`：*
> 
> *以前的方法`IBuildServer.CreateBuildAgentSpec("TeamProjectName");`需要返回值或抛出异常。*

这显然是在调用真正的扩展方法而不是测试实现。我的下一个倾向是尝试：

```
Expect.Call(BuildServerExtensions.GetEnabledBuildAgents(buildServer, TeamProjectName))
      .Return(null); 
```

然后我注意到我对 Rhino.Mocks 拦截它的期望可能是错误的。

问题是：如何消除这种依赖并使 Select 方法可测试？

请注意，扩展方法和 BuildAgentSelector 类在同一个程序集中，我宁愿避免更改它或不得不转向扩展方法之外的其他东西，尽管如果我知道它可以处理这种情况，我会考虑另一个模拟框架。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T05:55:37.860

您的扩展方法实际上写得很好。它是一种无副作用的方法，并且正在扩展一个接口，而不是一个具体的类。你快到了，但你只需要走得更远一点。您正在尝试模拟 .GetEnabledBuildAgents(...) 扩展方法...但这实际上并不是可模拟的（除了 TypeMock Isolator 之外的任何东西，这是目前唯一可以实际模拟静态的东西...但是它相当昂贵.)

您实际上对模拟您的扩展方法在内部调用的 IBuildAgent 方法感兴趣：.CreateBuildAgentSpec(...)。如果您考虑清楚，模拟 CreateBuildAgentSpec 方法将解决您的问题。扩展方法是“纯粹的”，所以真的不需要被嘲笑。它没有状态，也没有副作用。它在 IBuildAgent 接口上调用单个方法……这是引导您了解真正需要模拟的内容的第一条线索。

尝试以下操作：

```
[TestMethod]
public void SelectReturnsNullOnNullBuildAgents()
{
    Mocks = new MockRepository();
    IBuildServer buildServer = Mocks.CreateMock<IBuildServer>();

    BuildAgent agent = new BuildAgent { ... }; // Create an agent
    BuildAgentSelector buildAgentSelector = new BuildAgentSelector();
    using (Mocks.Record())
    {
        Expect.Call(buildServer.CreateBuildAgentSpec(TeamProjectName)).Return(new List<BuildAgent> { agent });
    }

    using (Mocks.Playback())
    {
        BuildAgent buildAgent = buildAgentSelector.Select(buildServer, TeamProjectName);

        Assert.IsNull(buildAgent);
    }
} 
```

通过创建 BuildAgent 实例并在 List<BuildAgent> 中返回它，您可以有效地返回您的 Select 方法可以操作的 IEnumerable<BuildAgent>。那应该让你继续前进。如果仅仅返回一个基本的 BuildAgent 实例是不够的，或者如果您需要多个实例，您可能需要做一些额外的模拟。当谈到要返回的模拟结果时，Rhino.Mocks 可能是一个真正的痛苦。如果您遇到麻烦（根据我的经验，您很可能会遇到），我建议您[尝试一下 Moq](http://code.google.com/p/moq/)，因为它是一个更好且对测试人员更友好的框架。它不需要存储库，并且消除了 Rhino.Mocks 所需的 Record/Playback 和 using() 语句重符号。Moq 还提供了其他框架尚未提供的额外功能，一旦您进入更繁重的模拟场景，您就会爱上（即 It.* 方法。）

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T06:23:32.913

在休息并带着新的头脑回来后，我意识到我实际上在 BuildAgentSelector 类中混合了一些关注点。我正在**获取**代理并**选择**它们。通过分离这两个关注点并将代理直接传递给 BuildAgentSelector 构造函数（或这样做的委托/接口），我能够分离关注点，删除对 buildServer 和 teamProjectName 参数的依赖，并简化接口进行中。它还实现了我在 BuildAgentSelector 类中寻找的可测试性结果。我也可以很好地单独测试扩展方法。

然而，最终，它只是将测试问题转移到了别处。更好，因为关注的位置更好，但是 jrista 的答案可以解决问题，无论关注的位置在哪里。

不得不模拟被测代码下面的第二层仍然有点难看。我基本上必须从我的扩展方法测试中模拟成功路径，并在我的其他测试中重用此代码 - 不难，但有点烦人。

我会尝试最小起订量，并小心不要对编写扩展方法过于满意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T05:43:25.093

测试调用真正的扩展方法，因为这是唯一的。模拟 IBuildServer 时不会创建测试实现，因为该方法不是 IBuildServer 的成员。

使用您现在的设置没有干净的解决方案。

理论上 TypeMock 将模拟静态类，但重构扩展方法将提供更大的可测试性。

# c - 32 位与各种 64 位数据模型的 sizeof(size_t) 是多少？

> ID：918787
> 
> 赞同：60
> 
> 时间：2009-05-28T01:27:06.397
> 
> 标签：c, 64-bit, sizeof, size-t

在 64 位系统上，`sizeof(unsigned long)`取决于系统实现的数据模型，例如 LLP64（Windows）上是 4 个字节，LP64（Linux 等）上是 8 个字节。`sizeof(size_t)`应该是什么？它是否像数据模型一样因数据模型而异`sizeof(long)`？如果是这样，怎么做？

* * *

参考：

[维基百科上的 64 位数据模型](http://en.wikipedia.org/wiki/64-bit#64-bit_data_models "64 位计算，64 位数据模型。 在维基百科上。")

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-05-28T02:13:59.563

size_t 由 C 标准定义为 sizeof 运算符 (C99 6.3.5.4.4) 的无符号整数返回类型，以及 malloc 和朋友 (C99 7.20.3.3 等) 的参数。实际范围设置为最大值 (SIZE_MAX) 至少为 65535 (C99 7.18.3.2)。

但是，这并不能让我们确定 sizeof(size_t)。该实现可以自由地使用它喜欢的任何 size_t 表示形式——因此大小没有上限——并且该实现也可以自由地将一个字节定义为 16 位，在这种情况下 size_t 可以等效于 unsigned char。

然而，撇开这一点不谈，一般来说，无论数据模型如何，32 位程序都有 32 位 size_t，64 位程序有 64 位。一般数据模型只影响静态数据；例如，在 GCC 中：

```
`-mcmodel=small'
     Generate code for the small code model: the program and its
     symbols must be linked in the lower 2 GB of the address space.
     Pointers are 64 bits.  Programs can be statically or dynamically
     linked.  This is the default code model.

`-mcmodel=kernel'
     Generate code for the kernel code model.  The kernel runs in the
     negative 2 GB of the address space.  This model has to be used for
     Linux kernel code.

`-mcmodel=medium'
     Generate code for the medium model: The program is linked in the
     lower 2 GB of the address space but symbols can be located
     anywhere in the address space.  Programs can be statically or
     dynamically linked, but building of shared libraries are not
     supported with the medium model.

`-mcmodel=large'
     Generate code for the large model: This model makes no assumptions
     about addresses and sizes of sections. 
```

您会注意到指针在所有情况下都是 64 位的。毕竟，拥有 64 位指针而不是 64 位大小毫无意义。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-28T01:32:18.290

它应该随架构而变化，因为它代表任何对象的大小。所以在 32 位系统`size_t`上可能至少有 32 位宽。在 64 位系统上，它可能至少为 64 位宽。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-28T01:35:36.410

size_t 通常在 64 位机器上为 64 位

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T01:30:40.307

**编辑：**感谢您的评论-我在[C99 标准](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)中查找了它，该标准在第 6.5.3.4 节中说：

> 结果的值是实现定义的，它的类型（**无符号整数类型**）是`size_t`，定义在`<stddef.h>`（和其他头文件）

因此，`size_t`没有指定大小，只是它必须是无符号整数类型。但是，可以在标准的第 7.18.3 章中找到一个有趣的规范：

> 限制`size_t`
> 
> `SIZE_MAX 65535`

这基本上意味着，无论 的大小如何`size_t`，允许的值范围是 0-65535，其余的取决于实现。

# jquery - 使用 jQuery 更改 HTML 标签？

> ID：918792
> 
> 赞同：138
> 
> 时间：2009-05-28T01:28:18.453
> 
> 标签：jquery

这可能吗？

例子：

```
$('a.change').click(function(){
//code to change p tag to h5 tag
});

<p>Hello!</p>
<a id="change">change</a> 
```

因此，单击更改锚点应该会导致该`<p>Hello!</p>`部分更改为（例如）一个 h5 标记，以便您`<h5>Hello!</h5>`在单击后结束。我意识到您可以删除 p 标签并用 h5 替换它，但是无论如何要实际修改 HTML 标签？

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2009-05-28T01:33:33.343

我相信，一旦创建了 dom 元素，标签就是不可变的。你必须做这样的事情：

```
$(this).replaceWith($('<h5>' + this.innerHTML + '</h5>')); 
```

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2013-12-09T11:49:19.033

这是一个扩展，可以以多种方式在尽可能多的元素上完成所有工作......

示例用法：

> 保留现有的类和属性：
> 
> > `$('div#change').replaceTag('<span>', true);`

或者

> 丢弃现有的类和属性：
> 
> > `$('div#change').replaceTag('<span class=newclass>', false);`

甚至

> 用 span 替换所有 div，复制类和属性，添加额外的类名
> 
> > `$('div').replaceTag($('<span>').addClass('wasDiv'), true);`

*插件来源：*

```
$.extend({
    replaceTag: function (currentElem, newTagObj, keepProps) {
        var $currentElem = $(currentElem);
        var i, $newTag = $(newTagObj).clone();
        if (keepProps) {//{{{
            newTag = $newTag[0];
            newTag.className = currentElem.className;
            $.extend(newTag.classList, currentElem.classList);
            $.extend(newTag.attributes, currentElem.attributes);
        }//}}}
        $currentElem.wrapAll($newTag);
        $currentElem.contents().unwrap();
        // return node; (Error spotted by Frank van Luijn)
        return this; // Suggested by ColeLawrence
    }
});

$.fn.extend({
    replaceTag: function (newTagObj, keepProps) {
        // "return" suggested by ColeLawrence
        return this.each(function() {
            jQuery.replaceTag(this, newTagObj, keepProps);
        });
    }
}); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-28T01:38:05.643

与其更改标记的类型，不如更改标记的样式（或者更确切地说，更改具有特定 id 的标记）。更改文档的元素以应用样式更改并不是一个好习惯。试试这个：

```
$('a.change').click(function() {
    $('p#changed').css("font-weight", "bold");
});

<p id="changed">Hello!</p>
<a id="change">change</a> 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-06-24T19:48:20.430

我注意到第一个答案并不是我所需要的，所以我做了一些修改，并想我会把它发回这里。

# **改进`replaceTag(<tagName>)`**

> `replaceTag(<tagName>, [withDataAndEvents], [withDataAndEvents])`

**论据：**

> *   标记名称：*字符串*
>     *   标签名称，例如“div”、“span”等。
> *   withDataAndEvents：*布尔值*
>     *   “一个布尔值，指示是否应将事件处理程序与元素一起复制。从 jQuery 1.4 开始，元素数据也将被复制。” [信息](http://api.jquery.com/clone/#clone-withDataAndEvents)
> *   deepWithDataAndEvents：*布尔值*，
>     *   一个布尔值，指示是否应复制克隆元素的所有子元素的事件处理程序和数据。默认情况下，它的值与第一个参数的值匹配（默认为 false）。”[信息](http://api.jquery.com/clone/#clone-withDataAndEvents-deepWithDataAndEvents)

**回报：**

> 一个新创建的 jQuery 元素

好的，我知道现在这里有一些答案，但我自己又写了一遍。

在这里，我们可以像使用克隆一样替换标签。[我们遵循与.clone()](http://api.jquery.com/clone/)相同的语法，如果使用`withDataAndEvents`，`deepWithDataAndEvents`它会复制*子*节点的数据和事件。

## ***例子：***

```
$tableRow.find("td").each(function() {
  $(this).clone().replaceTag("li").appendTo("ul#table-row-as-list");
}); 
```

## ***来源：***

```
$.extend({
    replaceTag: function (element, tagName, withDataAndEvents, deepWithDataAndEvents) {
        var newTag = $("<" + tagName + ">")[0];
        // From [Stackoverflow: Copy all Attributes](http://stackoverflow.com/a/6753486/2096729)
        $.each(element.attributes, function() {
            newTag.setAttribute(this.name, this.value);
        });
        $(element).children().clone(withDataAndEvents, deepWithDataAndEvents).appendTo(newTag);
        return newTag;
    }
})
$.fn.extend({
    replaceTag: function (tagName, withDataAndEvents, deepWithDataAndEvents) {
        // Use map to reconstruct the selector with newly created elements
        return this.map(function() {
            return jQuery.replaceTag(this, tagName, withDataAndEvents, deepWithDataAndEvents);
        })
    }
}) 
```

> 请注意，这**不会替换**所选元素，它会返回新创建的元素。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-05-24T18:59:32.277

想法是包装元素并打开内容：

```
function renameElement($element,newElement){

    $element.wrap("<"+newElement+">");
    $newElement = $element.parent();

    //Copying Attributes
    $.each($element.prop('attributes'), function() {
        $newElement.attr(this.name,this.value);
    });

    $element.contents().unwrap();       

    return $newElement;
} 
```

示例用法：

```
renameElement($('p'),'h5'); 
```

[演示](https://jsfiddle.net/shubanker/f6mc013z/2/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-12T02:03:59.180

我想出了一种方法，您可以使用 jQuery 对象的字符串表示，并使用正则表达式和基本 JavaScript 替换标记名称。您不会丢失任何内容，也不必遍历每个属性/属性。

```
/*
 * replaceTag
 * @return {$object} a new object with replaced opening and closing tag
 */
function replaceTag($element, newTagName) {

  // Identify opening and closing tag
  var oldTagName = $element[0].nodeName,
    elementString = $element[0].outerHTML,
    openingRegex = new RegExp("^(<" + oldTagName + " )", "i"),
    openingTag = elementString.match(openingRegex),
    closingRegex = new RegExp("(<\/" + oldTagName + ">)$", "i"),
    closingTag = elementString.match(closingRegex);

  if (openingTag && closingTag && newTagName) {
    // Remove opening tag
    elementString = elementString.slice(openingTag[0].length);
    // Remove closing tag
    elementString = elementString.slice(0, -(closingTag[0].length));
    // Add new tags
    elementString = "<" + newTagName + " " + elementString + "</" + newTagName + ">";
  }

  return $(elementString);
} 
```

最后，您可以按如下方式替换现有对象/节点：

```
var $newElement = replaceTag($rankingSubmit, 'a');
$('#not-an-a-element').replaceWith($newElement); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-11T16:00:35.823

这是我的解决方案。它允许在标签之间切换。

```
<!DOCTYPE html>
<html>
<head>
	<title></title>

<script src="https://code.jquery.com/jquery-1.11.3.js"></script>
<script type="text/javascript">

function wrapClass(klass){
	return 'to-' + klass;
}

function replaceTag(fromTag, toTag){

	/** Create selector for all elements you want to change.
	  * These should be in form: <fromTag class="to-toTag"></fromTag>
	  */
	var currentSelector = fromTag + '.' + wrapClass(toTag);

	/** Select all elements */
	var $selected = $(currentSelector);

	/** If you found something then do the magic. */
	if($selected.size() > 0){

		/** Replace all selected elements */
		$selected.each(function(){

			/** jQuery current element. */
			var $this = $(this);

			/** Remove class "to-toTag". It is no longer needed. */
			$this.removeClass(wrapClass(toTag));

			/** Create elements that will be places instead of current one. */
			var $newElem = $('<' + toTag + '>');

			/** Copy all attributes from old element to new one. */
			var attributes = $this.prop("attributes");
			$.each(attributes, function(){
				$newElem.attr(this.name, this.value);
			});

			/** Add class "to-fromTag" so you can remember it. */
			$newElem.addClass(wrapClass(fromTag));

			/** Place content of current element to new element. */
			$newElem.html($this.html());

			/** Replace old with new. */
			$this.replaceWith($newElem);
		});

		/** It is possible that current element has desired elements inside.
		  * If so you need to look again for them.
		  */
		replaceTag(fromTag, toTag);
	}
}

</script>

<style type="text/css">

	section {
		background-color: yellow;
	}

	div {
		background-color: red;
	}

	.big {
		font-size: 40px;
	}

</style>
</head>
<body>

<button onclick="replaceTag('div', 'section');">Section -> Div</button>
<button onclick="replaceTag('section', 'div');">Div -> Section</button>

<div class="to-section">
	<p>Matrix has you!</p>
	<div class="to-section big">
		<p>Matrix has you inside!</p>
	</div>
</div>

<div class="to-section big">
	<p>Matrix has me too!</p>
</div>

</body>
</html>
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-02-26T08:59:43.650

这是使用 jQuery 在 DOM 中更改 HTML 标签的快速方法。我发现这个[replaceWith()](https://api.jquery.com/replaceWith/)函数非常有用。

```
 var text= $('p').text();
   $('#change').on('click', function() {
     target.replaceWith( "<h5>"+text+"</h5>" );
   }); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-26T10:08:08.453

您可以在 jQuery 的帮助下通过`data-*`属性来实现，在获取值后通过方法获取&值，然后使用方法。 这种属性技术可以轻松管理任何标签替换，而无需更改以下内容（所有标签替换的通用代码）。 我希望下面的代码片段对你有很大帮助。`data-replace="replaceTarget,replaceBy"``replaceTarget``replaceBy``.split()``.replaceWith()`
`data-*`

```
$(document).on('click', '[data-replace]', function(){
  var replaceTarget = $(this).attr('data-replace').split(',')[0];
  var replaceBy = $(this).attr('data-replace').split(',')[1];
  $(replaceTarget).replaceWith($(replaceBy).html($(replaceTarget).html()));
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<p id="abc">Hello World #1</p>
<a href="#" data-replace="#abc,<h1/>">P change with H1 tag</a>
<hr>
<h2 id="xyz">Hello World #2</h2>
<a href="#" data-replace="#xyz,<p/>">H1 change with P tag</a>
<hr>
<b id="bold">Hello World #2</b><br>
<a href="#" data-replace="#bold,<i/>">B change with I tag</a>
<hr>
<i id="italic">Hello World #2</i><br>
<a href="#" data-replace="#italic,<b/>">I change with B tag</a>
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-02-26T21:58:22.023

以下函数可以解决问题并保留所有属性。例如，您可以像这样使用它：`changeTag("div", "p")`

```
function changeTag(originTag, destTag) {
  while($(originTag).length) {
    $(originTag).replaceWith (function () {
      var attributes = $(this).prop("attributes");
      var $newEl = $(`<${destTag}>`)
      $.each(attributes, function() {
        $newEl.attr(this.name, this.value);
      });  
      return $newEl.html($(this).html())
    })
  }
} 
```

为确保它有效，请检查以下示例

```
function changeTag(originTag, destTag) {
  while($(originTag).length) {
    $(originTag).replaceWith (function () {
      var attributes = $(this).prop("attributes");
      var $newEl = $(`<${destTag}>`)
      $.each(attributes, function() {
        $newEl.attr(this.name, this.value);
      });  
      return $newEl.html($(this).html())
    })
  }
}

changeTag("div", "p")

console.log($("body").html())
```

```
<body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<div class="A" style="font-size:1em">
  <div class="B" style="font-size:1.1em">A</div>
</div>
<div class="C" style="font-size:1.2em">
  B
</div>
</body>
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-05-28T01:37:42.803

是否有特定原因需要更改标签？如果您只想使文本更大，更改 p 标签的 CSS 类将是一个更好的方法。

像这样的东西：

```
$('#change').click(function(){
  $('p').addClass('emphasis');
}); 
```

# javascript - 插入 DOM 后保持对元素的引用

> ID：918795
> 
> 赞同：0
> 
> 时间：2009-05-28T01:29:51.977
> 
> 标签：javascript, dom

传统上，我将 JavaScript 用作“UI Glue”，并且（遗憾地）是那些将 JS 视为“玩具”的人之一。然而，我已经改变了路线，并且发现它的使用具有一些真正的力量——尤其是与 JSON/jQuery 结合使用。

我的问题涉及动态创建元素，然后将它们附加到 DOM。似乎当这种情况发生时，只有一个对象的副本被附加到 DOM 并且我失去了对它的引用。例如，如果我使用 createElement（比如“a”）创建一个全局对象，设置一些属性（“href”、“title”等），然后将其附加到 DOM 中，任何对我的全局对象的原始引用对附加元素没有影响。我确信我可以找到我刚刚插入的对象，但这似乎比它应该做的更多。我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-15T17:02:36.620

所有对象在 JavaScript 中都是通过引用传递的，HTMLNodes 也不例外。在您为其分配不同的值之前，您的原始参考应该始终有效。听起来你有一个范围问题。我们能看到代码吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T06:40:41.947

您使用的是库还是包装原生 DOM 对象的东西？，这可能是问题所在......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T03:06:01.410

```
var new_div = document.createElement('div');
new_div.id = 'foo'; 
```

编辑：只需重新阅读您的问题，您是说 new_div 在 appendChild 之后不起作用吗？我很确定它应该。您不是通过 innerHTML 或类似的奇怪东西添加它吗？

也许您的 var 超出了您尝试阅读的范围。（即，您在一个函数中创建它并从另一个函数中读取它？）。尝试全局声明对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T03:07:15.523

您的原始全球参考应该仍然可以正常工作。你想用它做什么？你有任何示例代码吗？

# regex - 正则表达式修饰符（或标志）“m”和“s”之间的区别？

> ID：918806
> 
> 赞同：20
> 
> 时间：2009-05-28T01:35:14.103
> 
> 标签：regex, modifier

我经常忘记正则表达式修饰符`m`及其`s`差异。有什么好的方法来记住它们？

据我了解，它们是：

> 'm' 用于多行，因此 将多次匹配字符串的开头和字符串的结尾`^`。`$`（除以`\n`）
> 
> 's' 使得点将匹配换行符

通常，我只是使用

```
/some_pattern/ism 
```

但相应地使用它们可能会更好（在我的情况下通常是“s”）。

你认为什么是记住它们的好方法，而不是每次都忘记哪个是哪个？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-28T03:29:45.167

多年来一直使用正则表达式但仍然不了解这两个修饰符如何工作的人并不罕见。正如您所观察到的，名称“多行”和“单行”并不是很有帮助。它们听起来一定是相互排斥的，但它们是完全独立的。我建议您忽略名称并专注于它们的作用：`m`更改锚点的行为（`^`和`$`），并`s`更改点的行为（`.`）。

混合模式的一位杰出人物是 Ruby 的作者。他在 Perl 的基础上创建了自己的正则表达式实现，但他决定拥有`^`并`$`始终作为行锚——也就是说，多行模式始终处于打开状态。不幸的是，他还错误地将 dot-matches-everything 模式命名为*multiline*。所以 Ruby 没有`s`修饰符，但它的`m`修饰符可以`s`做其他风格的事情。

至于总是使用`/ism`，我建议不要。正如您所发现的，它基本上是无害的，但它会向任何试图弄清楚正则表达式应该做什么的人（或者甚至是未来的你自己）发送一个令人困惑的信息。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-28T02:12:19.520

我喜欢“man perlre”中的解释：

**m** 将字符串视为**多**行。
**s** 将字符串视为单行**。**

对于多行，^ 和 $ 适用于单独的行（即在换行符之前和之后）。
使用单行，^ 和 $ 适用于整体，而 \n 只是成为您可以匹配的另一个字符。

**[错误]**通过使用您所描述的 m 和 s，我希望第二个优先，因此您将始终使用 /ism 处于多行模式。**[/错误的]**

我读得不够远：
“/s”和“/m”修饰符都覆盖了 $* 设置。也就是说，无论 $* 包含什么，没有 "/m" 的 "/s" 将强制 "^" 仅匹配字符串的开头，而 "$" 仅匹配末尾（或仅在换行符之前字符串的结尾）。一起，作为 /ms，他们让“。” 匹配任何字符，同时仍然允许 "^" 和 "$" 分别匹配字符串中的换行符之后和之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T02:23:38.407

## 2020 年更新：

我可以更清楚地写出它们是什么，以及一种记住它们的方法，并且我将其写成与 JavaScript 相关：

1.  传统上，JS 正则表达式没有`s`标志。它只有`m`国旗。截至 2020 年 1 月，Firefox 仍然没有它，而 Chrome 有它。NodeJS 拥有它。它在 ES2018 规范中。
2.  `s`也称为`dotall`or 。`singleline`它实际上只是为了`.`匹配任何 (ASCII) 字符，包括`\n`, `\r`, `\u2028`(换行符), `\u2029`(段符)。当人们问你，什么是`.`匹配的？如果你回答“任何字符”，那么它并不完全正确。它是除换行符`\r`和 unicode 换行符和分段符之外的所有 (ASCII) 字符。为了让它真正匹配所有 ASCII 字符，它需要打开`s`标志。
3.  为了克服 Firefox 或任何平台中缺少`s`标志，它可以是`[^]`, `[\s\S]`, `[\d\D]`, etc, 或`(.|\s)`.
4.  就这样。这就是`s`传统 JavaScript 中缺少的标志。
5.  现在是`m`国旗。它代表多行。它真的很简单：没有`m`标志，`^`and`$`将只匹配整个字符串的开头和结尾。所以`"John Doe\nMary Lee".match(/^John Doe$/)`不会匹配，`"John Doe\nMary Lee".match(/^John Doe$/m)`会匹配。就这样。不要以太复杂的方式考虑它。它只是改变了匹配方式`^`和`$`匹配方式。
6.  那么“单行”和“多行”是互斥的吗？不，他们不是。例如，如果我想匹配`a`任何字符，包括换行符和`f`, 但`a`必须在行首并且`f`必须在行尾，即使在 2000 行文本中，那么`"a b c \n d e f\nha".match(/^a.*f$/ms)`需要用过的。匹配,和`.`匹配行首和行尾。`\n``^``$`

就是这样。以上是在已经支持该`s`标志的 NodeJS 和 Chrome 上测试的。（并且该`m`标志长期以来一直受到支持）。请记住，您始终可以`s`使用以下方法修复标志丢失问题`[^]`

现在，为什么过去被`ms`或被`ism`大量使用？因为很多时候，当我们有一个非常长的字符串（例如 2000 行 HTML）时，例如我们返回的一些网页内容，我们很少希望匹配`^`整个字符串的开头和`$`结尾的整个字符串。所以这就是我们使用`m`标志的原因。现在，我们可能想要跨行匹配，因为（尽管不推荐使用正则表达式来匹配 HTML），例如，我们可能会使用`/<h1>.*?</h1>/`一个非贪婪的标题匹配。我们不介意`\n`内容中的 ，因为 HTML 的作者很可能有一个`\n`（或没有）。这就是我们使用“dotall”标志的原因`s`。

但是，如果您尝试从网页中提取一些信息，您可能不会关心某些内容是在行首还是行尾（因为 HTML 文件中可以有空格（或作为缩进），而且它不会' 不影响页面内容（通常，除非有`<pre>`等），所以你不需要使用`^`or `$`，因此你可以忘记`m`标志。如果你不介意使用`[^]*?`代替`.*?`，那么你也可以忘记`s`标志——故事结束。

Perl Cookbook 用两句话说：

> `/m`和之间的区别`/s`很重要：`/m`在换行符旁边生成`^`和`$`匹配，而在换行符旁边生成`/s`匹配`.`。您甚至可以一起使用它们——它们不是相互排斥的选项。

* * *

也许这样，我永远不会忘记：

当我想跨行匹配时（通常使用 .*? 来匹配跨多行无关紧要的东西），我自然会想到多行，因此，'m'。好吧，“m”实际上不是那个，所以它是“s”。

（因为我已经很好地记住了'ism'......所以我总是能记住它不是'm'，那么它一定是's'）。

其他蹩脚的尝试包括：

`s`用于 DOTALL，用于 DOT 匹配 ALL。
`m`是多行的——它用于`^`和`$`匹配很多次。

# delphi - Delphi - TWebBrowser 问题

> ID：918816
> 
> 赞同：3
> 
> 时间：2009-05-28T01:37:59.917
> 
> 标签：delphi

两个快速问题

1.  如何将焦点设置到 TWebBrowser？这样鼠标滚轮就可以滚动显示，而不必先在 TWebBrwoser 显示区域内单击。它有一个什么都不做（或似乎什么也不做）的 setfocus 方法。

2.  在 TWebBrowser 中，右键单击显示的链接并选择属性。OK 和 Cancel 按钮被禁用，您无法关闭对话框。您需要结束您的应用程序的任务才能杀死它。

有任何想法吗？

谢谢，杰森。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T01:55:38.837

Answer for Question 1 after much web hunting....

```
 with WebBrowser1 do
 if Document <> nil then
 with Application as IOleobject do
 DoVerb(OLEIVERB_UIACTIVATE, nil, WebBrowser1, 0, Handle, GetClientRect); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-09T14:02:04.390

这在 Peter Johnson 的以下文章中有所介绍，[How to make a TWebBrowser become the active control when clicked](http://delphidabbler.com/articles?article=19)。

总结一下，添加这个`OnCommandStateChange`事件：

```
procedure TWebBrowserFrame.CommandStateChange(Sender: TObject;
  Command: Integer; Enable: WordBool);
var
  Doc: IHTMLDocument2;        // document object
  Sel: IHTMLSelectionObject;  // current selection
begin
  // Check we have a valid web browser triggering this event
  if not Assigned(Sender) or not (Sender is TWebBrowser) then
    Exit;
  // Check we have required command
  if TOleEnum(Command) <> CSC_UPDATECOMMANDS then
    Exit;
  // Get ref to document object and check not nil
  Doc := Browser.Document as IHTMLDocument2;
  if not Assigned(Doc) then
    Exit;
  // Get ref to current selection
  Sel := Doc.selection as IHTMLSelectionObject;
  // If selection is of correct type then we have a mouse click
  if Assigned(Sel) and (Sel.type_ = 'Text') then
  begin
    // Make the web browser the form's active control
    (Sender as TWebBrowser).SetFocus;
    Doc.parentWindow.focus;
  end;
end; 
```

文章中还有很多细节，请务必阅读所有内容。

# asp.net - 无 cookie 会话临时 Internet 文件 (asp.net)

> ID：918819
> 
> 赞同：0
> 
> 时间：2009-05-28T01:39:25.313
> 
> 标签：asp.net, caching, session, cookieless

背景：我在公司 Intranet 上的 asp.net Web 应用程序上工作。cookieless="true" 在会话配置的 web.config 中设置。该应用程序在页面外启动，并且可以在几种不同的模式下运行（每种模式都有不同的链接）。可以同时运行应用程序的多个实例进行比较是一项业务需求，因此每个浏览器衍生品必须有一个新会话......无论如何......

检查我电脑上的 Temporary Internet Files 文件夹，正在查看的应用程序中使用的每个图像都被多次下载，因为会话 ID 在 url 中（我假设）并导致找不到缓存的图像。同一图像的 Internet 地址字段格式为[http://mywebserver/mywebapp/(S(......))/images/xxxxxxx.gif](http://mywebserver/mywebapp/(S(......))/images/xxxxxxx.gif)

要继续进行无 cookie 会话，将图像等移动到同一（或不同）服务器上 Web 应用程序外部目录的最佳方法是什么？例如[http://mywebserver/mywebappresource/images/xxxxxxx.gif](http://mywebserver/mywebappresource/images/xxxxxxx.gif)

欢迎提出任何建议！多谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T01:51:27.813

为什么 gif 的 URL 需要更改，因为它嵌入的页面发生了变化？如果您可以保持 gif URL 不变，那么它将如您所愿地被缓存。

这与您的建议几乎相同，将图像的目录更改为 Web 应用程序外部。如果在应用程序中这样做太尴尬，您总是可以在 Web 服务器中使用重定向规则来执行此操作。

我想我想说的是“是”。

# asp.net - What, if any, technology is going to replace ASP.NET?

> ID：918822
> 
> 赞同：2
> 
> 时间：2009-05-28T01:39:33.847
> 
> 标签：asp.net, wpf, mvvm

WinForms has given way to WPF and new models such as MVVM, that better enable Test Driven Development, work very nicely with WPF. Also, it seems to me that ASP.NET is very closely aligned with the WinForms way of doing things, for example event handlers in the code-behind which is linked using inheritance or partial classes. With WPF and MVVM, this mechanism falls out of favor and Data Binding is used to further de-couple the user interface to the point where it is just a skin.

So, I would bet that Microsoft is building something like a WPF-inspired, XAML-based replacement for ASP.NET. That is, HTML page views that are written in XAML so that they can take advantage of binding, but when run will render standards-based HTML. However, I can't find any reference online. (There is a [ASP.NET MVVM article at CodePlex](http://aspnetmvvm.codeplex.com/), but the binding there seems pretty manual.)

This is not intended as a community wiki question, I really do want to know what Microsoft is working on. However, I'm guessing that I can't stop the speculation (I've already done some).

Edit: Quite a few responses pointing to Silverlight have come through. I should have been more explicit. As cool as Silverlight is, I'm really looking for a standards-compatible technology that can be used in LOB applications.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T01:45:48.340

Silverlight is the closest thing that I can think of that matches your description. For the most part they are pushing MVC as a new way of doing Asp.Net.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T01:43:37.533

They did just release asp.net MVC which gives developers the choice of using MVC instead of web forms. I'm not familiar with MVVM so I'm not sure if they are doing anything in that area with asp.net.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T01:45:08.140

It seems to me the technology you're searching for is [Silverlight](http://silverlight.net/).

It's a web technology that supports a subset of XAML.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T02:31:30.120

我想说 ASP.net MVC 和/或 WCF+REST 是要研究的主要内容，就重新启动 Web 应用程序在服务器上的编写方式而言。如果你喜欢 MVC，但不喜欢 webforms，那么还有其他可以很容易插入的视图引擎。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T01:44:02.993

It would be either of [Asp.Net MVC](http://www.asp.net/mvc/) if you're a die hard Asp.Net fan, or if you love the WPF and/or the smart web approach [silverlight](http://silverlight.net/).

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T01:59:30.000

推测：云 (Azure) 和 SOA (WCF v.next)
在任何人（开发人员）赶上之前，他们不断想出新的方法来做同样的事情。

编辑：可悲的是，技术正在推动业务，而不是相反。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-28T19:42:04.770

据微软称，WebForms 不会消失。ASP.NET MVC 是人们现在使用 ASP.NET 开发 Web 应用程序的更改或选项。

请记住——Silverlight 3 即将到来，并将成为 LOB 领域的主要参与者。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-03T13:21:28.467

可能像[GWT](http://code.google.com/webtoolkit/)这样的东西可能会取代 ASP.NET 标记。因此，沿着[Script#](http://projects.nikhilk.net/ScriptSharp/)等思路思考，代码是用 C#/VB 编写的，并被翻译成客户端 JavaScript。

将其与某种基于浏览器的持久性（[Google Gears](http://gears.google.com/)等）相结合，您将获得一种新的 Web 编程范式。（断开连接的胖网络客户端有人吗？）

Webforms 在这种情况下会失败，因为它与页面回发高度耦合。
ASP.NET MVC 应该没问题，因为它主要不是面向页面回发。然后当然你会希望你的 WCF/Webservice/SOA/JSON/REST 端点与这种类型的应用程序对话。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-29T15:41:02.713

以某种方式相关：

Volta（来自现场实验室的一个用于拆分层的项目。因此，在 C# 中定义转换为 javascript（或 silverlight）的东西。虽然我不知道它是否[还活着？！](http://livelabs.com/blog/volta-offline/)。

它可与 Google Web Toolkit 相媲美。

来自[维基百科](http://en.wikipedia.org/wiki/Microsoft_Live_Labs_Volta)

> Volta 是一个用于构建多层 Web 应用程序的实验性开发工具集，由 Microsoft Live Labs 开发。它允许开发人员在整个开发生命周期中轻松地将他们的应用程序拆分为不同的客户端和服务器部分。Volta 与 Microsoft Visual Studio 和 .NET Framework 集成，支持 AJAX、JSON 等。它通过使用现有和熟悉的库、语言、工具和技术，将 .NET 平台扩展到软件即服务 (SaaS) 应用程序。[1](http://livelabs.com/blog/volta-offline/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-29T15:12:39.183

You are looking at ASP.NET MVC. Microsoft says it's not a replacement(but I believe most web developers will jump on it which will make it the defacto standard for .net web development), but it's a way to have a separation of concerns and isolate your business logic from your presentation. It renders to html, which is what you want.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-03T13:52:24.723

> 此外，在我看来，ASP.NET 与 WinForms 的处理方式非常接近，例如使用继承或部分类链接的代码隐藏中的事件处理程序。

在我看来，您更多地指的是 WebForms（即 System.Web.UI 中的类）而不是 ASP.NET。

我也掉进了这个陷阱。

虽然 WebForms 是在 ASP.NET 中执行 Web 应用程序的一种方式，但它**并不是**唯一的方式。

[ASP.NET MVC](http://www.asp.net/mvc/)是另一个，由 Microsoft 自己制作。ASP.NET MVVM 也存在（链接到另一个答案）。

说了这么多，我不知道有任何基于 XAML 的替代不使用浏览器插件的 WebForms。

# iphone - 如何从 GPS 坐标中查找邮政编码？

> ID：918826
> 
> 赞同：15
> 
> 时间：2009-05-28T01:40:31.817
> 
> 标签：iphone, gps, zipcode

假设我有一个接受邮政编码作为参数的 Web 服务 API，但我只能访问 GPS 坐标（纬度、经度）。如何动态查找坐标所属的邮政编码？

我在 iPhone 上做这项工作，所以希望有一种简单的方法可以在我在文档中忽略的 CoreLocation API 中执行此操作。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-28T08:04:47.860

此页面提供美国所有邮政编码的数据库（以 csv 格式）及其纬度和经度。 [http://zips.sourceforge.net/](http://zips.sourceforge.net/)

该文件已解压缩为 500k。这是前几行数据：

```
"35004", "AL", " 33.606379", " -86.50249", "Moody", "Alabama"
"35005", "AL", " 33.592585", " -86.95969", "Adamsville", "Alabama"
"35006", "AL", " 33.451714", " -87.23957", "Adger", "Alabama" 
```

将此数据转储到本地数据库中。使用 Haversine 公式比较您的坐标和数据库中的坐标以找到最近的点。CoreLocation 有一个你也可以使用的函数 getDistanceFrom。

```
- (CLLocationDistance)getDistanceFrom:(const CLLocation *)location 
```

此页面具有 c 中的 Haversine 函数和有关 zips 数据库的信息。

[http://www.jaimerios.com/?p=39](http://www.jaimerios.com/?p=39)

**编辑：**这是谷歌关于计算距离的一个很好的解释。它使用 MySQL 和 PHP，但用于查找最近点的 SQL 在这里也很有用。使用 SQL 而不是 getDistanceFrom 函数进行查询可能会更快。

[http://code.google.com/support/bin/answer.py?answer=87134&topic=11364](http://code.google.com/support/bin/answer.py?answer=87134&topic=11364)

找到距离 37, -122 坐标 25 英里半径内最近的 20 个位置：

```
SELECT id, ( 3959 * acos( cos( radians(37) ) 
 * cos( radians( lat ) ) * cos( radians( lng ) - radians(-122) ) 
 + sin( radians(37) ) * sin( radians( lat ) ) ) ) 
 AS distance FROM markers HAVING distance < 25 
 ORDER BY distance LIMIT 0 , 20; 
```

要按公里而不是英里搜索，请将 3959 替换为 6371。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-28T09:35:55.850

如果我是你，我会尝试查看 3.0 SDK 中反向地理编码器的文档。我不能说那里有什么，但你可能会说，发现反向地理编码返回一个 placeMark，然后如果你在 SDK 中查找那个 placeMark，你可能会发现它有一个 postcode 属性。谁知道？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T01:56:52.670

这种查找称为“反向地理定位”。

您需要做的第一件事是将纬度/经度数据从 CLocation 对象转换为度...

在 locationManager 函数中（一旦您收到位置更新就会调用该函数）......

代码：

```
[lat stringWithFormat:@"%+.6f", myLocation.coordinate.latitude];
[lng stringWithFormat:@"%+.6f", myLocation.coordinate.longitude]; 
```

从那里您将 lat 和 lng 字符串发送到后端 Web 服务，如“GeoNames.org”或 Google Maps API ......您可以获得最近的城市或街道地址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T01:56:55.010

有一个由美国人口普查局制作的数据库——老虎数据库。我相信有可能查找给定纬度/经度的邮政编码。

我敢打赌，如果您搜索[Tiger 邮政编码](http://www.google.com/search?hl=en&rls=com.microsoft%3A*&q=tiger+US+census+latitude+longitude&aq=f&oq=&aqi=)，您可能会找到一些东西。例如，请参见[此处](http://ribbs.usps.gov/files/addressing/pubs/tigerzip.txt)。看来 CPAN 上有一个 Perl 模块可以做到这一点，所以这应该不是不可能的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T22:08:55.077

Google 提供免费的反向地理编码服务。您可以直接使用它，也可以尝试 Temboo SDK，它提供多种语言的便捷访问，包括 Objective C（带有代码示例）。

查看[https://www.temboo.com/library/Library/Google/Geocoding/GeocodeByCoordinates/](https://www.temboo.com/library/Library/Google/Geocoding/GeocodeByCoordinates/)

# visual-studio - VS.NET 工具来命名表单上的所有控件

> ID：918828
> 
> 赞同：2
> 
> 时间：2009-05-28T01:41:00.723
> 
> 标签：visual-studio, ide

不久前，我在一个截屏视频中看到了一个可以在 VS.NET IDE 中运行的工具。执行时，它会提示为每个控件设置 Name 和 Text 属性。这似乎是个好主意，但我从来没有尝试过。

现在我不记得那是什么了。有谁知道可以做到这一点的工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T01:45:01.370

是[MZ-Tools 控件名称助手吗？](http://www.mztools.com/index.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T01:50:03.980

[锐器？](http://www.jetbrains.com/resharper/)

# version-control - Mercurial中的“bzr uncommit”等价物？

> ID：918833
> 
> 赞同：12
> 
> 时间：2009-05-28T01:43:26.943
> 
> 标签：version-control, mercurial, dvcs, bazaar

Bazaar 有一个很棒的`uncommit`命令，它可以简单地撤消最后一次提交。Mercurial中是否有任何等价物？

**编辑**：Bazaar 的 uncommit 命令不会修改文件——它会删除最后一次提交和相关数据（很有用，例如，当您发现提交消息中存在拼写错误或未添加本应添加的文件时为时已晚） .

例如：

```
$ bzr ci -m "Fixed a proooblem" <-- problem is misspelt
$ bzr uncommit
...
$ bzr ci -m "Fixed a problem" <-- Exactly as if the first commit was correct. 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-28T17:08:36.017

您需要该[`hg rollback`](http://www.selenic.com/mercurial/wiki/Rollback)命令，但如果您使用的是 Mercurial 2.2 或更高版本，请参见下文。

rollback 命令将从您的存储库中删除最后一个**事务。**提交是一个事务，因此您可以将其用作

```
% hg commit -m 'My elaburate bugfix.' foo.c foo.h
% hg rollback
% hg commit -m 'My elaborate bugfix.' foo.c foo.h 
```

回滚后，文件将再次被视为已修改，这意味着第二次提交将存储与第一次相同的更改，但提交信息更好。

**注意：** `hg rollback`比简单的“取消提交”功能更强大，如果您不小心，您可以使用它来**丢弃工作。**扔掉一个提交做

```
$ hg commit -m 'My big and very difficult bugfix'
$ hg pull --update
$ hg rollback 
```

您现在已经丢失了您所做的最后一次提交，并且由于您将工作副本更新为其他版本，因此该提交中的更改**已经消失**。`hg rollback`因此，如果您确定`hg commit`确实是在工作副本上操作的最后一个命令，则应该只使用撤消提交。

此外，如果您没有在命令行上给出提交消息，那么您不能只按两次向上箭头在回滚后重做提交。但是，Mercurial 1.5 及更高版本将保存您的最后一条提交消息，`.hg/last-message.txt`以便您在回滚后始终可以再次找到它。

Mercurial **`--amend`2.2**为`hg commit`. 这让您可以使用新的更改来修改最后一次提交。它只是将 列出的更改`hg status`合并到父提交中，就好像您已回滚并再次提交一样。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-28T01:53:56.407

也许`hg backout tip`？我推荐[http://hgbook.red-bean.com/read/finding-and-fixing-mistakes.html](http://hgbook.red-bean.com/read/finding-and-fixing-mistakes.html)了解有关 的所有详细信息`hg backout`、它与 的不同之处`hg revert`以及许多相关主题，但如果我不明白是什么`uncommit`，它似乎完全等同于`hg backout tip`。

编辑：在评论中你现在已经澄清你想“删除历史”——这很难（除非你在平局上非常快，也许;-)......再次根据红豆书：

> 由于 Mercurial 将历史视为累积的——每一个变化都建立在它之前的所有变化之上——你通常不能让灾难性的变化消失。一个例外是您刚刚提交了更改，并且尚未将其推送或拉入另一个存储库。那时您可以安全地使用 hg rollback 命令

因此，如果您只是想*尝试*“让它消失”（并且您很幸运，它还没有被推或拉到其他地方），那么`hg rollback`可能是一个更好的方法！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T01:47:44.127

“hg revert”不这样做吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T02:01:29.917

通过阅读评论，您似乎想要一种方法来简单地取消提交记录而不撤消对文件的更改。在 Mercurial 中，没有自动执行此操作的方法。`hg revert`与您将要获得的一样接近。

但是，您*可以*通过几个手动步骤来做到这一点。当您调用 时`hg revert`，它的默认行为是获取您正在恢复的变更集中的文件并将它们重命名为`filename.ext.orig`，其中`ext`是文件的原始扩展名。然后恢复的版本采用原始文件名。所以你可以做的是运行`hg revert`，删除具有原始名称的文件，并`.orig`从备份文件的名称中删除。然后使用更正后的日志消息重新提交。只是不要对除提示之外的任何修订执行此操作，因为您可能会得到很多已更改的文件而忘记哪些文件属于哪个变更集。

如果您已经将变更集推送到远程仓库，我也不建议您这样做。仅当一切仍然只是本地时才这样做。

如果您需要进一步解释，请告诉我。我有时不得不这样做，所以我熟悉这个过程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-31T13:17:32.483

还有来自“mq”扩展的“hg strip”命令。它几乎完全等同于“bzr uncommit”。但请注意，当您之前将错误提交推送到另一个存储库时，它将通过最近的拉取重新创建。

# silverlight - Trying to rotate text for a groupbox

> ID：918834
> 
> 赞同：0
> 
> 时间：2009-05-28T01:43:34.633
> 
> 标签：silverlight, xaml, rotation

I'm trying to create a groupbox-like element in XAML (for a Silverlight 2 app) but with a twist.

Normally a groupbox would consist of a border, with the main content placed inside the border, and a header content placed over the border itself.

What I'm trying to do is place the header text over the left side border, rotated 270 degrees and justified at the top. But my brain hurts from trying to figure out the rotate transform.

Here's my ControlTemplate for the existing Groupbox, which I'd like to change:

```
<ControlTemplate TargetType="Controls1:GroupBox">
  <Grid Background="{TemplateBinding Background}">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    <Border BorderThickness="{TemplateBinding BorderThickness}" Grid.Row="1" Grid.RowSpan="2" 
            BorderBrush="{TemplateBinding BorderBrush}" CornerRadius="3">
      <Border.Clip>
        <GeometryGroup FillRule="EvenOdd">
          <RectangleGeometry x:Name="FullRect" Rect="0,0,300,200"/>
          <RectangleGeometry x:Name="HeaderRect" Rect="6,0,100,100"/>
        </GeometryGroup>
      </Border.Clip>
    </Border>
    <ContentPresenter Grid.Row="2" ContentTemplate="{TemplateBinding ContentTemplate}" 
                      Content="{TemplateBinding Content}" Margin="{TemplateBinding Padding}"/>
    <ContentControl x:Name="HeaderContainer" Margin="6,0,0,0" Grid.Row="0" Grid.RowSpan="2" HorizontalAlignment="Left" IsEnabled="False" >
      <ContentPresenter Margin="3,0,3,0" ContentTemplate="{TemplateBinding HeaderTemplate}" Content="{TemplateBinding Header}" />
    </ContentControl>
  </Grid>
</ControlTemplate> 
```

Any help much appreciated!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T02:14:11.467

最简单的方法是使用 RenderTransform。举个例子：

```
<TextBlock Background="Red" Width="100" Height="50">
    <TextBlock.RenderTransform>
        <RotateTransform Angle="270"></RotateTransform>
    </TextBlock.RenderTransform>
    My title!
</TextBlock> 
```

您还可以使用属性 CenterX 和 CenterY 指定旋转中心

希望这可以帮助！

**编辑**

要调整标签位置，您可以使用这样的画布：

```
<Canvas Margin="0,45,0,-45">
    <Canvas.RenderTransform>
        <RotateTransform  Angle="270"></RotateTransform>
    </Canvas.RenderTransform>
    <TextBlock Background="Red">
        My title!
    </TextBlock>
</Canvas> 
```

# c++ - 使用 windowssdkver 命令安装 Windows SDK v6.1 时出错：输入字符串的格式不正确

> ID：918841
> 
> 赞同：1
> 
> 时间：2009-05-28T01:45:02.930
> 
> 标签：c++, visual-studio-2005, sdk

安装 Windows SDK v6.1 时，遵循 chromium 说明 ( [http://dev.chromium.org/developers/how-tos/build-instructions-windows](http://dev.chromium.org/developers/how-tos/build-instructions-windows) )

我运行以下命令：

```
windowssdkver -version:v6.1 -legacy 
```

我收到以下错误：

```
Input string was not in a correct format.
   at System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal)
   at System.Number.ParseInt32(String s, NumberStyles style, NumberFormatInfo info)
   at System.Version..ctor(String version)
   at WindowsSdkVer.Utility.GetInstalledProducts(String rootKey, String productVersionKey, String installationFolderKey)
   at WindowsSdkVer.VersionSelector.GetInstlledSdkVersions()
   at WindowsSdkVer.ConsoleSelectionManager.get_InstalledSdkVersions()
   at WindowsSdkVer.Program.Main(String[] args) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T01:46:31.070

我找到的解决方案是这样做：

*   首先重新启动（为了安全起见）
*   进入 Regedit -> HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SDKs\Windows\v6.0A
*   将键“ProductVersion”重命名为“-ProductVersion”
*   运行 windowssdkver 命令，然后它似乎可以工作
*   返回到 regedit，并将密钥重命名为其原始名称。

# url - URL for a user content site and SEO

> ID：918846
> 
> 赞同：0
> 
> 时间：2009-05-28T01:46:12.520
> 
> 标签：url, seo

I was thinking about how i should write my URLs. I want them to A) Be user friendly B) SEO C) allow fast DB queries. The information i have are username, category, mediaId, title and other data i dont feel is necessary (date, hash, etc).

Should i have the username before or after the domain name? (username.mysite.com/ vs mysite.com/username/).

Then i need to decide if i should use /media/The-Title-Of-Media or /media/mediaId/The-Title-Of-Media (media being 8 or 16 digit number) or any variants (such as media/The-Title-Of-Media-MediaId).

Do i want a mediaId in there? i was thinking it could speed up the db query but if i am validating it against the username (so mysite.com/deceptiveUserName/media/mediaId/title is not allowed) just using WHERE userid=expectedUserId may be a hairline less efficient then a query using a primary key? Also using a mediaId allows the title to not be unique but would it be a bad idea to allow users to lazily not give everything a unique title? if i allow lazyness users may look at a url before and after and think they are the name due to title. Or it become hard to find a link in a list of links?

-edit-

Hows this. mysite.com/username/media/mediaId/title. If the title happens to change i can update the URL and not break links bc the mediaId is still the same.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T01:49:44.853

Having subdomains can complicate things like SSL and cookies. Avoid them if possible.

Always supply the primary key if you can.

Don't over-engineer this. SEO comes from having well-structured and relevant content, not shenanigans with URL manipulation.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T02:16:19.247

**StackOverflow**在 Url 中包含问题 Id，因此它必须是一个好习惯。 **:)**

我同意你的最终想法：**mysite.com/username/media/mediaId/title**

# c# - 我应该使用 Ruby 构建什么类型的应用程序？

> ID：918865
> 
> 赞同：2
> 
> 时间：2009-05-28T01:54:04.003
> 
> 标签：c#, ruby-on-rails, ruby

我只是将我在 C# 方面的经验转移到 Ruby 中。Ruby 是一种非常有趣的编程语言，我非常喜欢它。我知道 Rails 是一个 Web 应用程序框架，被许多 Web 开发人员使用并使用 Ruby 语言。我们还应该在 ruby​​ 上构建哪些应用程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T04:38:26.840

Ruby 似乎擅长的应用程序类型是设计实现 DSL 的框架。Ruby 语法的松散结构和反射/元编程风格鼓励重新定义结构，而不必实现自己的解析器。诸如 Rake、Rails、Sinatra、Capistrano 和 RSpec 之类的东西都有一个非常特殊的 DSL，通过在 DSL 中添加 Ruby 语言的全部功能，它可以很好地扩展。当然，Ruby 最大的强大套件之一是快速开发，尤其是在像 Rails 这样的约定优于配置的框架中。显然，数据库驱动的动态 Web 应用程序在 Rails 中占有一席之地，但没有什么能阻止您构建[SMTP 的下一个 Rails](http://lamsonproject.org/)。

Ruby 擅长驱动高度可配置的应用程序，其中配置可以自行编程。我知道我看到[Zed Saw 谈到](http://htp://blog.cusec.net/2009/01/05/zed-shaw-the-acl-is-dead-cusec-2008/)在 Ruby 中编写业务规则样式的访问控制列表，以便对不断变化的法律和规则做出更动态的反应。 [Ruby Arduino Development](http://rad.rubyforge.org/)还可以帮助改变定制机器人和物理计算的面貌，方法是放置一个强大且易于使用的脚本框架来连接 Arduino 物理计算平台（“制造者”的梦想）。

您可能已经注意到软件中的敏捷性主题，而这正是 Ruby 所属的地方。

更新，桌面应用程序：目前似乎没有任何 Ruby 的杀手级桌面应用程序，主要是因为对 Web 应用程序的需求如此之大，并且通过 Web 提供丰富的应用程序体验[变得越来越容易](http://www.youtube.com/view_play_list?p=41F4CEB92D80C4B7)。虽然有 Ruby GUI 的框架。特别值得注意的是由[_why the luckystiff （Ruby 摇滚明星）编写的](http://whytheluckystiff.net/)[Shoes](http://shoooes.net/) ，因为它以特别 Ruby 的方式呈现 GUI 开发。除了鞋子，最近 支持原生 Cocoa 的[Macruby也](http://www.macruby.org/)[引起了一些关注](http://www.rubyinside.com/how-to-develop-cocoa-mac-app-with-macruby-xcode-1261.html)。然后你就有了带有 Ruby 包装器的 GUI 工具包：[WxRuby](http://wxruby.rubyforge.org)、[FXRuby](http://www.fxruby.org/)和[Ruby-GNOME2](http://ruby-gnome2.sourceforge.jp)。

仅仅因为现在没有 Ruby GUI 的杀手级应用程序并不意味着您不能创建下一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T02:25:18.777

一个博客引擎，就像其他人一样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T07:15:35.090

我认为 Ruby 适合编写我们每天使用的小型软件工具来提高我们的生产力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-22T03:53:41.303

下载 Wikipedia 的[XML 导出](http://en.wikipedia.org/wiki/Wikipedia_database)文件，并以某种新颖的方式对其进行分析。

# iphone - 在 cocos2d (iphone) 中，你将如何为精灵制作动画（逐帧）？

> ID：918881
> 
> 赞同：2
> 
> 时间：2009-05-28T02:01:34.550
> 
> 标签：iphone, cocos2d-iphone

最有效的方法是什么？我有四个图像，我想播放它们以成为动画精灵。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T21:27:11.967

查看此[示例代码](http://kwigbo.com/wp/2009/02/12/creating-an-animated-sprite-cocos2d-source-included/)。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-05-28T02:09:35.080

怎么样：

```
UIImageView *imageView = …
imageView.animationImages = <array of images> 
```

# sql-server-2008 - 需要帮助将 sql 2008 表上的字段分区到不同的文件组

> ID：918885
> 
> 赞同：0
> 
> 时间：2009-05-28T02:03:27.947
> 
> 标签：sql-server-2008, database-partitioning

在我问的上一个问题中，建议的答案是让我将我的字段分区到另一个文件组，将字段保持在同一个表中。

我不知道该怎么做。

我试过用谷歌搜索分区表、分区视图等。谁能给我一些链接或一些示例 sql 代码？

数据库服务器是 Sql 2008。

### 表架构

```
FooId  INT PK IDENTITY
Name   VARCHAR(100) NOT NULL
Boo    VARCHAR(100) NOT NULL
BlahId INT NOT NULL
Photo  VARBINARY(MAX)     <-- This field wants to go onto another filegroup.
                             Can be null. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T02:20:33.840

您需要在[CREATE TABLE](http://msdn.microsoft.com/en-us/library/ms174979.aspx)中使用 TEXTIMAGE ON 子句。

# bash - 如何在 Bash 的分隔符上拆分字符串？

> ID：918886
> 
> 赞同：2501
> 
> 时间：2009-05-28T02:03:43.983
> 
> 标签：bash, shell, split, scripting

我将此字符串存储在一个变量中：

```
IN="bla@some.com;john@home.com" 
```

现在我想用`;`分隔符分割字符串，这样我就有：

```
ADDR1="bla@some.com"
ADDR2="john@home.com" 
```

我不一定需要`ADDR1`and`ADDR2`变量。如果它们是数组的元素那就更好了。

* * *

根据以下答案的建议，我最终得到了以下结果：

```
#!/usr/bin/env bash

IN="bla@some.com;john@home.com"

mails=$(echo $IN | tr ";" "\n")

for addr in $mails
do
    echo "> [$addr]"
done 
```

输出：

```
> [bla@some.com]
> [john@home.com] 
```

有一个解决方案涉及将[Internal_field_separator](http://en.wikipedia.org/wiki/Internal_field_separator) (IFS) 设置为`;`. 我不确定该答案发生了什么，您如何重置`IFS`为默认值？

RE：`IFS`解决方案，我试过了，它有效，我保留旧的`IFS`然后恢复它：

```
IN="bla@some.com;john@home.com"

OIFS=$IFS
IFS=';'
mails2=$IN
for x in $mails2
do
    echo "> [$x]"
done

IFS=$OIFS 
```

顺便说一句，当我尝试

```
mails2=($IN) 
```

我在循环打印时只得到了第一个字符串，它周围没有括号`$IN`。

* * *

## 回答 #1

> 赞同：1491
> 
> 时间：2009-05-28T02:23:27.017

您可以设置[内部字段分隔符](http://en.wikipedia.org/wiki/Internal_field_separator)(IFS) 变量，然后让它解析成一个数组。当这发生在命令中时，分配 to`IFS`只发生在该单个命令的环境 (to `read`) 中。然后它根据`IFS`变量值将输入解析为一个数组，然后我们可以对其进行迭代。

此示例将解析由 分隔的一行项目`;`，并将其推入一个数组：

```
IFS=';' read -ra ADDR <<< "$IN"
for i in "${ADDR[@]}"; do
  # process "$i"
done 
```

另一个示例用于处理 的全部内容`$IN`，每次输入一行，由 分隔`;`：

```
while IFS=';' read -ra ADDR; do
  for i in "${ADDR[@]}"; do
    # process "$i"
  done
done <<< "$IN" 
```

* * *

## 回答 #2

> 赞同：1307
> 
> 时间：2011-03-10T09:00:43.977

取自*[Bash shell 脚本拆分数组](http://www.linuxquestions.org/questions/programming-9/bash-shell-script-split-array-383848/#post3270796)*：

```
IN="bla@some.com;john@home.com"
arrIN=(${IN//;/ })
echo ${arrIN[1]}                  # Output: john@home.com 
```

解释：

此构造用（单个空格）替换字符串中所有出现的`';'`（初始`//`表示全局替换），然后将空格分隔的字符串解释为数组（这就是周围括号的作用）。`IN``' '`

花括号内用于将每个`';'`字符替换为`' '`字符的语法称为[参数扩展](https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html)。

有一些常见的陷阱：

1.  如果原始字符串有空格，则需要使用[IFS](https://unix.stackexchange.com/questions/184863/what-is-the-meaning-of-ifs-n-in-bash-scripting)：

*   `IFS=':'; arrIN=($IN); unset IFS;`

2.  如果原始字符串有空格*并且*分隔符是新行，则可以使用以下方式设置[IFS](https://unix.stackexchange.com/questions/184863/what-is-the-meaning-of-ifs-n-in-bash-scripting)：

*   `IFS=$'\n'; arrIN=($IN); unset IFS;`

* * *

## 回答 #3

> 赞同：321
> 
> 时间：2009-05-28T02:09:44.237

如果您不介意立即处理它们，我喜欢这样做：

```
for i in $(echo $IN | tr ";" "\n")
do
  # process
done 
```

您可以使用这种循环来初始化数组，但可能有更简单的方法来完成它。

* * *

## 回答 #4

> 赞同：294
> 
> 时间：2013-04-13T14:20:09.927

## 兼容的答案

[在bash](/questions/tagged/bash "显示标记为“bash”的问题")中有很多不同的方法可以做到这一点。

但是，重要的是首先要注意它`bash`有许多在任何其他[shell中都不起作用的](/questions/tagged/shell "显示标记为“外壳”的问题")*特殊*功能（所谓的*[bashisms](http://mywiki.wooledge.org/Bashism)* ） 。

特别是，本文中的解决方案以及线程中的其他解决方案中使用的*数组*、*关联数组*和*模式替换是**bashism*，可能无法在许多人使用的其他*shell下工作。*

例如：在我的*Debian GNU/Linux 上*，有一个名为[dash的](/questions/tagged/dash "显示标记为“破折号”的问题")*标准*shell ；我知道很多人喜欢使用另一个叫做[ksh](/questions/tagged/ksh "显示标记为“ksh”的问题")的 shell ；还有一个叫做[busybox](/questions/tagged/busybox "显示标记为“busybox”的问题")的特殊工具，带有他自己的shell解释器（[ash](/questions/tagged/ash "显示标记为“灰”的问题")）。

### 请求的字符串

上述问题中要拆分的字符串是：

```
IN="bla@some.com;john@home.com" 
```

我将使用此字符串的修改版本来确保我的解决方案对包含空格的字符串具有鲁棒性，这可能会破坏其他解决方案：

```
IN="bla@some.com;john@home.com;Full Name <fulnam@other.org>" 
```

### [根据bash](/questions/tagged/bash "显示标记为“bash”的问题")中的分隔符拆分字符串（版本 >=4.2）

在*pure* `bash`中，我们可以创建一个*数组，其中元素被**[IFS](https://mywiki.wooledge.org/IFS)*的临时值（*输入字段分隔符*）分割。除其他外，IFS 告诉`bash`定义数组时应将哪些字符视为元素之间的分隔符：

```
IN="bla@some.com;john@home.com;Full Name <fulnam@other.org>"

# save original IFS value so we can restore it later
oIFS="$IFS"
IFS=";"
declare -a fields=($IN)
IFS="$oIFS"
unset oIFS 
```

在较新的版本中`bash`，使用 IFS 定义为命令添加前缀*只会*更改该命令的 IFS，然后立即将其重置为以前的值。这意味着我们可以在一行中完成上述操作：

```
IFS=\; read -a fields <<<"$IN"
# after this command, the IFS resets back to its previous value (here, the default):
set | grep ^IFS=
# IFS=$' \t\n' 
```

我们可以看到该字符串`IN`已存储到一个名为 的数组`fields`中，并以分号分隔：

```
set | grep ^fields=\\\|^IN=
# fields=([0]="bla@some.com" [1]="john@home.com" [2]="Full Name <fulnam@other.org>")
# IN='bla@some.com;john@home.com;Full Name <fulnam@other.org>' 
```

`declare -p`（我们也可以使用:)显示这些变量的内容

```
declare -p IN fields
# declare -- IN="bla@some.com;john@home.com;Full Name <fulnam@other.org>"
# declare -a fields=([0]="bla@some.com" [1]="john@home.com" [2]="Full Name <fulnam@other.org>") 
```

请注意，这`read`是进行拆分的*最快*方法，因为没有调用*分叉*或外部资源。

定义数组后，您可以使用一个简单的循环来处理每个字段（或者，更确切地说，处理您现在定义的数组中的每个元素）：

```
# `"${fields[@]}"` expands to return every element of `fields` array as a separate argument
for x in "${fields[@]}" ;do
    echo "> [$x]"
    done
# > [bla@some.com]
# > [john@home.com]
# > [Full Name <fulnam@other.org>] 
```

或者，您可以在使用*移位*方法处理后从数组中删除每个字段，我喜欢这种方法：

```
while [ "$fields" ] ;do
    echo "> [$fields]"
    # slice the array 
    fields=("${fields[@]:1}")
    done
# > [bla@some.com]
# > [john@home.com]
# > [Full Name <fulnam@other.org>] 
```

如果你只想要一个简单的数组打印输出，你甚至不需要循环它：

```
printf "> [%s]\n" "${fields[@]}"
# > [bla@some.com]
# > [john@home.com]
# > [Full Name <fulnam@other.org>] 
```

### 更新：最近的[bash](/questions/tagged/bash "显示标记为“bash”的问题") >= 4.4

在较新的版本中`bash`，您还可以使用以下命令`mapfile`：

```
mapfile -td \; fields < <(printf "%s\0" "$IN") 
```

此语法保留特殊字符、换行符和空字段！

如果您不想包含空字段，可以执行以下操作：

```
mapfile -td \; fields <<<"$IN"
fields=("${fields[@]%$'\n'}")   # drop '\n' added by '<<<' 
```

使用`mapfile`，您还可以跳过声明数组并隐式“循环”分隔元素，在每个元素上调用一个函数：

```
myPubliMail() {
    printf "Seq: %6d: Sending mail to '%s'..." $1 "$2"
    # mail -s "This is not a spam..." "$2" </path/to/body
    printf "\e[3D, done.\n"
}

mapfile < <(printf "%s\0" "$IN") -td \; -c 1 -C myPubliMail 
```

（注意：`\0`如果您不关心字符串末尾的空字段或它们不存在，则格式字符串的末尾是无用的。）

```
mapfile < <(echo -n "$IN") -td \; -c 1 -C myPubliMail

# Seq:      0: Sending mail to 'bla@some.com', done.
# Seq:      1: Sending mail to 'john@home.com', done.
# Seq:      2: Sending mail to 'Full Name <fulnam@other.org>', done. 
```

*或者*您可以使用`<<<`, 并在函数体中包含一些处理以删除它添加的换行符：

```
myPubliMail() {
    local seq=$1 dest="${2%$'\n'}"
    printf "Seq: %6d: Sending mail to '%s'..." $seq "$dest"
    # mail -s "This is not a spam..." "$dest" </path/to/body
    printf "\e[3D, done.\n"
}

mapfile <<<"$IN" -td \; -c 1 -C myPubliMail

# Renders the same output:
# Seq:      0: Sending mail to 'bla@some.com', done.
# Seq:      1: Sending mail to 'john@home.com', done.
# Seq:      2: Sending mail to 'Full Name <fulnam@other.org>', done. 
```

### [根据shell](/questions/tagged/shell "显示标记为“外壳”的问题")中的分隔符拆分字符串

如果你不能使用`bash`，或者如果你想写一些可以在许多不同的 shell 中使用的东西，你通常**不能**使用*bashisms——*这包括我们在上面的解决方案中一直使用的数组。

但是，我们不需要使用数组来循环字符串的“元素”。在许多 shell 中都有一种语法用于从模式的*第一次*或*最后一次*出现中删除字符串的子字符串。请注意，这`*`是一个代表零个或多个字符的通配符：

（到目前为止发布的任何解决方案都缺乏这种方法是我写这个答案的主要原因；）

```
${var#*SubStr}  # drops substring from start of string up to first occurrence of `SubStr`
${var##*SubStr} # drops substring from start of string up to last occurrence of `SubStr`
${var%SubStr*}  # drops substring from last occurrence of `SubStr` to end of string
${var%%SubStr*} # drops substring from first occurrence of `SubStr` to end of string 
```

正如[Score_Under](https://stackoverflow.com/posts/comments/47972612?noredirect=1)所解释的：

> `#`并分别从字符串的*开头*和*结尾*`%`删除可能的最短匹配子字符串，并且
> 
>  **`##`并`%%`删除可能最长的匹配子字符串。**

 **使用上述语法，我们可以创建一种方法，通过删除分隔符之前或之后的子字符串，从字符串中提取子字符串“元素”。

下面的代码块在[bash](/questions/tagged/bash "显示标记为“bash”的问题")（包括 Mac OS 的`bash`）、[dash](/questions/tagged/dash "显示标记为“破折号”的问题")、[ksh](/questions/tagged/ksh "显示标记为“ksh”的问题")和[busybox](/questions/tagged/busybox "显示标记为“busybox”的问题")的[ash](/questions/tagged/ash "显示标记为“灰”的问题")中运行良好：

（感谢[Adam Katz](https://stackoverflow.com/users/519360/adam-katz)的[评论](https://stackoverflow.com/posts/comments/120591261?noredirect=1)，让这个循环变得更加简单！）

```
IN="bla@some.com;john@home.com;Full Name <fulnam@other.org>"
while [ "$IN" != "$iter" ] ;do
    # extract the substring from start of string up to delimiter.
    iter=${IN%%;*}
    # delete this first "element" AND next separator, from $IN.
    IN="${IN#$iter;}"
    # Print (or doing anything with) the first "element".
    echo "> [$iter]"
done
# > [bla@some.com]
# > [john@home.com]
# > [Full Name <fulnam@other.org>] 
```

玩得开心！

* * *

## 回答 #5

> 赞同：288
> 
> 时间：2015-04-27T18:20:34.580

我已经看到几个引用该`cut`命令的答案，但它们都已被删除。没有人对此进行详细说明有点奇怪，因为我认为这是执行此类操作的更有用的命令之一，尤其是对于解析分隔的日志文件。

在将这个特定示例拆分为 bash 脚本数组的情况下，`tr`可能更有效，但`cut`可以使用，如果您想从中间拉出特定字段，则更有效。

**例子：**

```
$ echo "bla@some.com;john@home.com" | cut -d ";" -f 1
bla@some.com
$ echo "bla@some.com;john@home.com" | cut -d ";" -f 2
john@home.com 
```

您显然可以将其放入一个循环中，并迭代 -f 参数以独立提取每个字段。

当您有一个带有如下行的分隔日志文件时，这会变得更加有用：

```
2015-04-27|12345|some action|an attribute|meta data 
```

`cut`能够`cat`对该文件并选择特定字段进行进一步处理非常方便。

* * *

## 回答 #6

> 赞同：168
> 
> 时间：2016-08-11T20:45:25.073

这对我有用：

```
string="1;2"
echo $string | cut -d';' -f1 # output is 1
echo $string | cut -d';' -f2 # output is 2 
```

* * *

## 回答 #7

> 赞同：136
> 
> 时间：2013-01-14T06:33:40.037

我认为[AWK](http://en.wikipedia.org/wiki/AWK)是解决您的问题的最佳和有效的命令。几乎每个 Linux 发行版都默认包含 AWK。

```
echo "bla@some.com;john@home.com" | awk -F';' '{print $1,$2}' 
```

会给

```
bla@some.com john@home.com 
```

当然，您可以通过重新定义 awk 打印字段来存储每个电子邮件地址。

* * *

## 回答 #8

> 赞同：100
> 
> 时间：2009-05-28T10:31:16.910

这种方法怎么样：

```
IN="bla@some.com;john@home.com" 
set -- "$IN" 
IFS=";"; declare -a Array=($*) 
echo "${Array[@]}" 
echo "${Array[0]}" 
echo "${Array[1]}" 
```

[来源](http://antonolsen.com/2006/04/10/bash-split-a-string-without-cut-or-awk/)

* * *

## 回答 #9

> 赞同：81
> 
> 时间：2009-05-28T02:12:59.050

```
echo "bla@some.com;john@home.com" | sed -e 's/;/\n/g'
bla@some.com
john@home.com 
```

* * *

## 回答 #10

> 赞同：71
> 
> 时间：2012-09-08T05:01:42.753

这也有效：

```
IN="bla@some.com;john@home.com"
echo ADD1=`echo $IN | cut -d \; -f 1`
echo ADD2=`echo $IN | cut -d \; -f 2` 
```

请注意，此解决方案并不总是正确的。如果您只传递“bla@some.com”，它会将其分配给 ADD1 和 ADD2。

* * *

## 回答 #11

> 赞同：39
> 
> 时间：2014-06-26T09:11:21.740

在 Bash 中，这是一种防弹方式，即使您的变量包含换行符，它也可以工作：

```
IFS=';' read -d '' -ra array < <(printf '%s;\0' "$in") 
```

看：

```
$ in=$'one;two three;*;there is\na newline\nin this field'
$ IFS=';' read -d '' -ra array < <(printf '%s;\0' "$in")
$ declare -p array
declare -a array='([0]="one" [1]="two three" [2]="*" [3]="there is
a newline
in this field")' 
```

这个工作的诀窍是使用 (delimiter) 的`-d`选项`read`和一个空的分隔符，所以它`read`被迫读取它输入的所有内容。并且我们`read`准确地提供了变量的内容`in`，由于没有尾随换行符`printf`。请注意，我们还将分隔符放入`printf`以确保传递给的字符串`read`具有尾随分隔符。没有它，`read`将修剪潜在的尾随空字段：

```
$ in='one;two;three;'    # there's an empty field
$ IFS=';' read -d '' -ra array < <(printf '%s;\0' "$in")
$ declare -p array
declare -a array='([0]="one" [1]="two" [2]="three" [3]="")' 
```

尾随的空字段被保留。

* * *

# Bash≥4.4的更新

从 Bash 4.4 开始，内置函数`mapfile`(aka `readarray`) 支持`-d`指定分隔符的选项。因此，另一种规范的方式是：

```
mapfile -d ';' -t array < <(printf '%s;' "$in") 
```

* * *

## 回答 #12

> 赞同：38
> 
> 时间：2011-07-05T13:41:34.493

对[达伦的回答](https://stackoverflow.com/questions/918886/split-string-based-on-delimiter-in-bash/3704011#3704011)有不同的看法，这就是我的做法：

```
IN="bla@some.com;john@home.com"
read ADDR1 ADDR2 <<<$(IFS=";"; echo $IN) 
```

* * *

## 回答 #13

> 赞同：37
> 
> 时间：2010-09-13T20:10:42.723

如果您不使用数组，这一个衬里怎么样：

```
IFS=';' read ADDR1 ADDR2 <<<$IN 
```

* * *

## 回答 #14

> 赞同：32
> 
> 时间：2016-08-01T13:15:07.147

不设置 IFS

如果你只有一个冒号，你可以这样做：

```
a="foo:bar"
b=${a%:*}
c=${a##*:} 
```

你会得到：

```
b = foo
c = bar 
```

* * *

## 回答 #15

> 赞同：23
> 
> 时间：2015-09-11T20:54:49.903

这是一个干净的 3 衬里：

```
in="foo@bar;bizz@buzz;fizz@buzz;buzz@woof"
IFS=';' list=($in)
for item in "${list[@]}"; do echo $item; done 
```

其中`IFS`基于分隔符分隔单词并`()`用于创建[数组](http://www.linuxjournal.com/content/bash-arrays)。然后`[@]`用于将每个项目作为单独的单词返回。

如果之后有任何代码，还需要恢复`$IFS`，例如`unset IFS`.

* * *

## 回答 #16

> 赞同：14
> 
> 时间：2017-05-24T08:42:53.397

以下 Bash/zsh 函数将其第一个参数拆分为第二个参数给出的分隔符​​：

```
split() {
    local string="$1"
    local delimiter="$2"
    if [ -n "$string" ]; then
        local part
        while read -d "$delimiter" part; do
            echo $part
        done <<< "$string"
        echo $part
    fi
} 
```

例如，命令

```
$ split 'a;b;c' ';' 
```

产量

```
a
b
c 
```

例如，此输出可以通过管道传输到其他命令。例子：

```
$ split 'a;b;c' ';' | cat -n
1   a
2   b
3   c 
```

与给出的其他解决方案相比，该解决方案具有以下优点：

*   `IFS`未被覆盖：由于局部变量的动态范围，覆盖`IFS`循环会导致新值泄漏到循环内执行的函数调用中。

*   不使用数组：使用将字符串读入数组需要Bash 和zsh中`read`的标志。`-a``-A`

如果需要，可以将函数放入脚本中，如下所示：

```
#!/usr/bin/env bash

split() {
    # ...
}

split "$@" 
```

* * *

## 回答 #17

> 赞同：11
> 
> 时间：2018-01-20T15:54:29.427

您可以将 awk 应用于许多情况

```
echo "bla@some.com;john@home.com"|awk -F';' '{printf "%s\n%s\n", $1, $2}' 
```

你也可以用这个

```
echo "bla@some.com;john@home.com"|awk -F';' '{print $1,$2}' OFS="\n" 
```

* * *

## 回答 #18

> 赞同：9
> 
> 时间：2015-09-16T03:34:51.353

有一个简单而聪明的方法是这样的：

```
echo "add:sfff" | xargs -d: -i  echo {} 
```

但是你必须使用 gnu xargs，BSD xargs 不支持 -d delim。如果你像我一样使用苹果mac。您可以安装 gnu xargs ：

```
brew install findutils 
```

然后

```
echo "add:sfff" | gxargs -d: -i  echo {} 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2011-09-25T01:09:38.887

这是最简单的方法。

```
spo='one;two;three'
OIFS=$IFS
IFS=';'
spo_array=($spo)
IFS=$OIFS
echo ${spo_array[*]} 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2012-10-22T07:10:09.673

这里有一些很酷的答案（尤其是错误的），但是对于类似于在其他语言中拆分的东西——这就是我认为原始问题的意思——我决定了这一点：

```
IN="bla@some.com;john@home.com"
declare -a a="(${IN/;/ })"; 
```

现在`${a[0]}`,`${a[1]}`等，如您所料。用于`${#a[*]}`项数。或者迭代，当然：

```
for i in ${a[*]}; do echo $i; done 
```

重要的提示：

这适用于没有空间可担心的情况，这解决了我的问题，但可能无法解决您的问题。在这种情况下使用`$IFS`解决方案。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2013-04-24T13:13:57.663

如果没有空间，为什么不呢？

```
IN="bla@some.com;john@home.com"
arr=(`echo $IN | tr ';' ' '`)

echo ${arr[0]}
echo ${arr[1]} 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2016-10-25T12:41:51.933

```
IN="bla@some.com;john@home.com"
IFS=';'
read -a IN_arr <<< "${IN}"
for entry in "${IN_arr[@]}"
do
    echo $entry
done 
```

输出

```
bla@some.com
john@home.com 
```

系统：Ubuntu 12.04.1

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2013-04-30T03:10:43.010

使用`set`内置加载`$@`数组：

```
IN="bla@some.com;john@home.com"
IFS=';'; set $IN; IFS=$' \t\n' 
```

然后，让派对开始：

```
echo $#
for a; do echo $a; done
ADDR1=$1 ADDR2=$2 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2013-09-02T06:30:53.097

两个都不需要 bash 数组的 bourne-ish 替代方案：

**案例1**：保持简洁：使用NewLine作为记录分隔符......例如。

```
IN="bla@some.com
john@home.com"

while read i; do
  # process "$i" ... eg.
    echo "[email:$i]"
done <<< "$IN" 
```

注意：在第一种情况下，没有子进程被派生来帮助列表操作。

想法：也许值得在*内部广泛使用 NL，并且只在**外部*生成最终结果时转换为不同的 RS 。

**案例2**：使用“;” 作为记录分隔符...例如。

```
NL="
" IRS=";" ORS=";"

conv_IRS() {
  exec tr "$1" "$NL"
}

conv_ORS() {
  exec tr "$NL" "$1"
}

IN="bla@some.com;john@home.com"
IN="$(conv_IRS ";" <<< "$IN")"

while read i; do
  # process "$i" ... eg.
    echo -n "[email:$i]$ORS"
done <<< "$IN" 
```

在这两种情况下，可以在循环内组成的子列表在循环完成后是持久的。这在操作内存中的列表时很有用，而不是将列表存储在文件中。{ps保持冷静并继续B-)}

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2014-10-10T11:33:54.217

```
IN='bla@some.com;john@home.com;Charlie Brown <cbrown@acme.com;!"#$%&/()[]{}*? are no problem;simple is beautiful :-)'
set -f
oldifs="$IFS"
IFS=';'; arrayIN=($IN)
IFS="$oldifs"
for i in "${arrayIN[@]}"; do
echo "$i"
done
set +f 
```

输出：

```
bla@some.com
john@home.com
Charlie Brown <cbrown@acme.com
!"#$%&/()[]{}*? are no problem
simple is beautiful :-) 
```

说明：使用括号 () 的简单赋值将分号分隔的列表转换为数组，前提是您在执行此操作时具有正确的 IFS。标准 FOR 循环像往常一样处理该数组中的各个项目。请注意，为 IN 变量提供的列表必须是“硬”引用的，即带有单个刻度。

IFS 必须被保存和恢复，因为 Bash 不会以与命令相同的方式处理分配。另一种解决方法是将赋值包装在一个函数中，并使用修改后的 IFS 调用该函数。在这种情况下，不需要单独保存/恢复 IFS。感谢“Bize”指出这一点。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2015-01-08T10:21:45.897

除了已经提供的精彩答案之外，如果只是打印出您可能考虑使用的数据`awk`：

```
awk -F";" '{for (i=1;i<=NF;i++) printf("> [%s]\n", $i)}' <<< "$IN" 
```

这会将字段分隔符设置为`;`，以便它可以通过循环遍历字段`for`并相应地打印。

### 测试

```
$ IN="bla@some.com;john@home.com"
$ awk -F";" '{for (i=1;i<=NF;i++) printf("> [%s]\n", $i)}' <<< "$IN"
> [bla@some.com]
> [john@home.com] 
```

使用另一个输入：

```
$ awk -F";" '{for (i=1;i<=NF;i++) printf("> [%s]\n", $i)}' <<< "a;b;c   d;e_;f"
> [a]
> [b]
> [c   d]
> [e_]
> [f] 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2015-02-20T10:49:59.877

在 Android shell 中，大多数建议的方法都不起作用：

```
$ IFS=':' read -ra ADDR <<<"$PATH"                             
/system/bin/sh: can't create temporary file /sqlite_stmt_journals/mksh.EbNoR10629: No such file or directory 
```

起作用的是：

```
$ for i in ${PATH//:/ }; do echo $i; done
/sbin
/vendor/bin
/system/sbin
/system/bin
/system/xbin 
```

where`//`表示全局替换。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2016-04-04T19:54:13.807

好吧，伙计们！

这是我的答案！

```
DELIMITER_VAL='='

read -d '' F_ABOUT_DISTRO_R <<"EOF"
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=14.04
DISTRIB_CODENAME=trusty
DISTRIB_DESCRIPTION="Ubuntu 14.04.4 LTS"
NAME="Ubuntu"
VERSION="14.04.4 LTS, Trusty Tahr"
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME="Ubuntu 14.04.4 LTS"
VERSION_ID="14.04"
HOME_URL="http://www.ubuntu.com/"
SUPPORT_URL="http://help.ubuntu.com/"
BUG_REPORT_URL="http://bugs.launchpad.net/ubuntu/"
EOF

SPLIT_NOW=$(awk -F$DELIMITER_VAL '{for(i=1;i<=NF;i++){printf "%s\n", $i}}' <<<"${F_ABOUT_DISTRO_R}")
while read -r line; do
   SPLIT+=("$line")
done <<< "$SPLIT_NOW"
for i in "${SPLIT[@]}"; do
    echo "$i"
done 
```

为什么这种方法对我来说是“最好的”？

因为两个原因：

1.  您**不需要转义**分隔符；
2.  你不会有**空格的问题**。该值将在数组中正确分隔！

[]的

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2012-06-14T17:38:03.537

用于拆分由 ';' 分隔的字符串的单行 进入一个数组是：

```
IN="bla@some.com;john@home.com"
ADDRS=( $(IFS=";" echo "$IN") )
echo ${ADDRS[0]}
echo ${ADDRS[1]} 
```

这仅将 IFS 设置在子外壳中，因此您不必担心保存和恢复其值。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2016-02-26T12:20:31.403

也许不是最优雅的解决方案，但适用于`*`和空格：

```
IN="bla@so me.com;*;john@home.com"
for i in `delims=${IN//[^;]}; seq 1 $((${#delims} + 1))`
do
   echo "> [`echo $IN | cut -d';' -f$i`]"
done 
```

输出

```
> [bla@so me.com]
> [*]
> [john@home.com] 
```

其他示例（开头和结尾的分隔符）：

```
IN=";bla@so me.com;*;john@home.com;"
> []
> [bla@so me.com]
> [*]
> [john@home.com]
> [] 
```

基本上它会删除除`;`制作之外的所有字符`delims`。`;;;`. 然后它确实从到`for`循环，由计数。最后一步是使用.`1``number-of-delimiters``${#delims}``$i``cut`

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2022-02-28T14:29:01.590

```
ADDR1=${IN%%;*}
ADDR2=${IN##*;} 
```

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2021-08-22T01:15:32.580

**编辑：** 对不起，我在某处读过`perl`POSIX 要求的 SO，所以我认为使用它是合法的。但是在 unix.stackexchange.com 上，一些用户状态`perl`不是 POSIX 规范的一部分。

我的解决方案：使用`perl`'s`split`来完成工作的函数。

附有详细评论：

```
#!/bin/bash

# This function is a wrapper for Perl's split.\
# \
# Since we cannot return an array like in Perl,
# it takes the name of the resulting array as last
# argument.\
# \
# See https://perldoc.perl.org/functions/split for usage info
# and examples.\
# \
# If you provide a Perl regexp that contains e. g. an escaped token like \b,
# space(s) and/or capture group(s), it must be quoted, and e. g. /\b/ must
# be single-quoted.\
# Thus, it's best to generally single-quote a Perl regexp.
function split # Args: <Element separator regexp> <string> <array name>
{
    (($# != 3)) && echo "${FUNCNAME[0]}: Wrong number of arguments, returning." && return 1

    local elementSepRE=$1
    local string=$2
    local -n array=$3

    local element i=0

    # Attention! read does Word Splitting on each line!
    # I must admit I didn't know that so far.
    # This removes leading and trailing spaces, exactly
    # what we don't want.
    # Thus, we set IFS locally to newline only.
    local IFS=$'\n'

    while read element; do
        # As opposed to array+=($element),
        # this preserves leading and trailing spaces.
        array[i++]=$element
    done <<<$(_perl_split)
}

# This function calls Perl's split function and prints the elements of the
# resulting array on separate lines.\
# It uses the caller's $elementSepRE and $string.
function _perl_split
{
    # A heredoc is a great way of embedding a Perl script.
    # N.B.: - Shell variables get expanded.
    #         - Thus:
    #           - They must be quoted.
    #           - Perl scalar variables must be escaped.
    #       - The backslash of \n must be escaped to protect it.
    #       - Instead of redirecting a single heredoc to perl, we may
    #         use multiple heredocs with cat within a command group and
    #         pipe the result to perl.
    #         This enables us to conditionally add certain lines of code.

    {
        cat <<-END
            my \$elementSepRE=q($elementSepRE);
        END

        # If $elementSepRE is a literal Perl regexp, qr must be applied
        # to it in order to use it.
        # N.B.: We cannot write this condition in Perl because when perl
        # compiles the script, all statements are checked for validity,
        # no matter if they will actually be executed or not.
        # And if $elementSepRE was e. g. == ', the line below – although
        # not to be executed – would give an error because of an unterminated
        # single-quoted string.
        [[ $elementSepRE =~ ^m?/ && $elementSepRE =~ /[msixpodualn]*$ ]] && cat <<-END
            \$elementSepRE=qr$elementSepRE;
        END

        cat <<-END
            my @array=split(\$elementSepRE, q($string));

            print(\$_ . "\\n") for (@array);
        END
    } | perl
} 
```

对于那些一眼就知道发生了什么的人来说，同样没有评论；）

```
#!/bin/bash

# This function is a wrapper for Perl's split.\
# \
# Since we cannot return an array like in Perl,
# it takes the name of the resulting array as last
# argument.\
# \
# See https://perldoc.perl.org/functions/split for usage info
# and examples.\
# \
# If you provide a Perl regexp that contains e. g. an escaped token like \b,
# space(s) and/or capture group(s), it must be quoted, and e. g. /\b/ must
# be single-quoted.\
# Thus, it's best to generally single-quote a Perl regexp.
function split # Args: <Element separator regexp> <string> <array name>
{
    (($# != 3)) && echo "${FUNCNAME[0]}: Wrong number of arguments, returning." && return 1

    local elementSepRE=$1
    local string=$2
    local -n array=$3

    local element i=0

    local IFS=$'\n'

    while read element; do
        array[i++]=$element
    done <<<$(_perl_split)
}

function _perl_split
{
    {
        cat <<-END
            my \$elementSepRE=q($elementSepRE);
        END

        [[ $elementSepRE =~ ^m?/ && $elementSepRE =~ /[msixpodualn]*$ ]] && cat <<-END
            \$elementSepRE=qr$elementSepRE;
        END

        cat <<-END
            my @array=split(\$elementSepRE, q($string));

            print(\$_ . "\\n") for (@array);
        END
    } | perl
} 
```

* * *

## 回答 #33

> 赞同：-8
> 
> 时间：2011-10-12T11:09:41.987

有两种简单的方法：

```
cat "text1;text2;text3" | tr " " "\n" 
```

和

```
cat "text1;text2;text3" | sed -e 's/ /\n/g' 
```

* * *

## 回答 #34

> 赞同：-9
> 
> 时间：2018-06-13T15:58:57.890

又一个迟到的答案...如果您有 Java 思维，这里是**bashj** ( [https://sourceforge.net/projects/bashj/](https://sourceforge.net/projects/bashj/) ) 解决方案：

```
#!/usr/bin/bashj

#!java

private static String[] cuts;
private static int cnt=0;
public static void split(String words,String regexp) {cuts=words.split(regexp);}
public static String next() {return(cnt<cuts.length ? cuts[cnt++] : "null");}

#!bash

IN="bla@some.com;john@home.com"

: j.split($IN,";")    # java method call

while true
do
    NAME=j.next()     # java method call
    if [ $NAME != null ] ; then echo $NAME ; else exit ; fi
done 
```

# c# - 演示 C# Convoy 锁

> ID：918890
> 
> 赞同：2
> 
> 时间：2009-05-28T02:05:20.097
> 
> 标签：c#, locking

几年前，由于执行不正确的“Try Catch finally”块，开发团队遇到了运行时冻结问题，后来发现这是一个 Convoy Lock 问题。

我正在寻找一个简单的 C# 代码来向我的队友演示 Convoy Locking。

对代码示例的任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T02:12:24.683

Windows 上的并发编程在这个主题上有一些很棒的内容，您可以将它们带到团队中。

[http://www.amazon.com/gp/product/032143482X/ref=ox_ya_oh_product](https://rads.stackoverflow.com/amzn/click/com/032143482X)

# c# - 命名空间命名约定

> ID：918894
> 
> 赞同：54
> 
> 时间：2009-05-28T02:07:43.553
> 
> 标签：c#, .net, namespaces, design-guidelines

对于那些编写可重用组件的人，如果您要扩展 .NET 框架的功能，您认为最佳实践是什么？

例如，我目前正在创建一个 Pop3 库，因为 .NET 中不存在该库。我是创建自定义命名空间还是使用`System.Net.Mail`？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-05-28T02:14:53.463

从[命名空间命名指南](http://msdn.microsoft.com/en-us/library/893ke618(vs.71).aspx)：

> 命名命名空间的一般规则是使用公司名称，后跟技术名称以及可选的功能和设计，如下所示。复制代码
> 
> `CompanyName.TechnologyName[.Feature][.Design]`

通常，开始将内容包含到框架或库的默认命名空间中是一种非常糟糕的做法。这可能会导致混淆，即新命名空间是现有库的一部分，而现有库是分发给每个人的框架的一部分，还是属于其他人添加的自定义框架的一部分。

此外，命名约定尝试通过具有唯一标识符（例如`CompanyName`. 它还减少了新库来源方面的任何混淆和问题。

这不仅是微软的事情，Java 也是如此。Java 中的命名空间，称为“包”，具有[以下约定](http://www.oracle.com/technetwork/java/codeconventions-135099.html)：

> 唯一包名的前缀总是用全小写的ASCII字母写的，应该是顶级域名之一，目前是com、edu、gov、mil、net、org，或者是英文的两字母代码之一识别 ISO 标准 3166, 1981 中指定的国家/地区。
> 
> 包名称的后续组成部分根据组织自己的内部命名约定而有所不同。这样的约定可能会指定某些目录名称组件是部门、部门、项目、机器或登录名。

所以，如果我有一个超级棒的软件，它可能在`net.coobird.superawesomesoftware`包中。

并且使用包含默认`java.`, `javax.`,`com.sun.`包的包名称是一个很大的禁忌。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2011-01-07T08:49:23.060

另请查看以下 MSDN 文章，了解有关命名空间命名的指南

> [命名空间的名称](http://msdn.microsoft.com/en-us/library/ms229026.aspx)
> 
> 为命名空间选择的名称应表明命名空间中的类型提供的功能。例如，System.Net.Sockets 命名空间包含使开发人员能够使用套接字通过网络进行通信的类型。
> 
> 命名空间名称的一般格式如下：
> 
> `<Company>.(<Product>|<Technology>)[.<Feature>][.<Subnamespace>]`
> 
> 例如，`Microsoft.WindowsMobile.DirectX`。

# c# - 对于有经验的 C# 3.0 开发人员来说，学习 F# 有多难？

> ID：918908
> 
> 赞同：15
> 
> 时间：2009-05-28T02:13:58.033
> 
> 标签：c#, f#, c#-3.0, functional-programming

对于有经验的 C# 3.0 开发人员来说，学习 F# 有多难，和/或您认为学习 F# 最困难的部分是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-28T02:38:09.110

从 F# 开始（学习语法，了解如何以函数方式编程）并不难。熟悉 LINQ 并对 Lambda 表达式有深刻理解的优秀 C# 3 开发人员应该能够快速掌握基础知识。

很难说打破面向对象解决问题的习惯对他们来说有多难，但需要函数式解决方案的问题应该迫使他们实现这一飞跃。在我看来，除非你遇到一个新问题，否则很难改变你的想法。

总而言之，我会说我花了一周的时间在业余时间（每晚 2-3 小时）学习该语言的语法和基础知识。不过，您需要更多的时间才能真正感受函数式编程。

## 问题

我仍在与类型作斗争。我一直在做 Project Euler 问题来自学语法，所以到目前为止我不需要任何复杂的用户定义类型。

编译器所做的类型推断也需要一点时间来适应，因为何时需要指定类型以及何时才能解决它们并不总是很清楚。

## 学习

我肯定会建议为初学者尝试[Project Euler](http://projecteuler.net/)问题。数学问题始终是函数式编程的理想选择。

更笼统地说，数据处理问题也很好。列表处理在函数式语言中非常容易，并且是您应该学习 IMO 的第一件事。

## 图书

[真实世界的函数式编程](http://www.manning.com/petricek/)：我不久前完成了这本书，发现它非常适合学习如何将函数式编程原理应用于使用 C# 和 F# 的问题。本书中的大多数示例都是用两种语言完成的，使用了每种语言特有的函数式编程习语并解释了它们之间的区别。

## 资源

*   [http://codemiscellany.blogspot.com/search/label/f%23](http://codemiscellany.blogspot.com/search/label/f%23)（*归功于 Perpetualcoder*）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-28T02:50:06.933

对我来说，比较困难的部分之一是真正学习代数数据类型（可区分联合和元组）和模式匹配，因为我在其他语言中真的没有深入接触过这些概念。

至于加快速度，这里是我[最喜欢的学习 F# 的在线内容](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!1325.entry)。由于您来自 C#，您可能会发现“[这个 C# 代码在 F# 中是什么样子](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!725.entry)”很有用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-28T11:03:36.627

如其他答案所述，问题与其说是 C# 与 F#，不如说是面向对象/过程与功能。

话虽如此，如果您涉足过 Linq、lambdas、匿名委托，那么您已经在做一些函数式和/或函数式启发的东西，所以“函数作为变量”的第一个障碍已经过去了。

我非常期待一本书（[现实世界中的函数式编程）*，因为它用 C# 和 F# 示例解释了函数式编程。](http://www.manning.com/petricek/)我彻底推荐[作者的](https://stackoverflow.com/users/33518/tomas-petricek)[这个网络广播](http://tomasp.net/blog/fsharp-webcast-functional.aspx)，我认为这是一个很好的品尝者。他向您介绍了一个过程 C# 中的示例，然后将其转换为函数式 C#，然后跳到过程式 F# 中做同样的事情，然后是函数式 F#。非常好。

对我来说最困难的事情是破译神秘的类型推断错误消息，尽管显然他们正在努力改进它。

*旁注，关于堆栈溢出的F#问题相当多，但你搜索“ ”*找不到*`searchword f#`，*你必须搜索*“ `searchword [f#]`”*

 **其中[合著者/编辑](https://stackoverflow.com/users/22656/jon-skeet)在社区中相当知名；）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T02:42:29.960

您可以快速学习 F#，但问题是您将如何在其中编程。

F# 可以让你编写像 C# 一样的过程代码，但它更麻烦，而且你会错过函数式语言的要点。

根据我自己的经验，你将不得不放弃你信任的循环来换取列表推导。您还必须学习使用嵌套函数和递归。

模式匹配也有一些陷阱需要警惕。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T02:40:51.100

您可能会很快学习 F# 语言，但要按照应有的方式使用 F# 肯定需要一些时间。它可能类似于你从 C 到 C++ 的跳跃，只是增加了一种对眼睛来说陌生的语法和对大脑来说陌生的思维方式。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T02:46:13.273

我想说的是，在深入研究 F# 之前，先将你的脚趾浸入一点 Lisp 或 Haskell，甚至两者兼而有之。在对 Lisp 和 Haskell 有一些经验，并长期虔诚地使用 C# 之后，我对 F# 感到宾至如归。再说一次，我在 OCaml（F# 背后的主要影响之一）方面也有一些经验，所以这有很大帮助。函数式语言是用数学和科学方法看待事物的一种完全不同的方式。添加 C# 中可用的 .NET 库的强大功能，这些库是您之前有经验的，而且您是金子。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-08T23:31:49.223

如果你想学习F#，你需要熟悉Reflector或者至少阅读IL代码。

F# 做了很多表面上没有意义的奇怪事情。例子：

*   你有三种空值。CLR null、Nullable 和 Option。
*   它们可以组合。如果您看到 Option 您需要在使用字符串之前检查 None 和 Some(null) 。
*   您可以重载大多数运算符，例如加法 (+)、连接 (^) 和大于 (>)。
*   其他语言将在您的库中识别这些重载。
*   您不能使用 F# 中的重载连接运算符。
*   如果您使用 > 运算符，它不会尊重您的重载。相反，它会寻找 IComparable 接口。
*   编译器不会告诉您使用 > 而不实现 IComparable 将是运行时错误。

简而言之，F# 是一种极其不一致的语言，如果不深入研究它产生的代码，就无法真正理解它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-08-03T22:03:46.193

> 对于有经验的 C# 3.0 开发人员来说，学习 F# 有多难，

真的很容易。学习 F# 1 个月后，您应该能够认真工作。

> 和/或你会说学习 F# 最困难的部分是什么？

首先，学习使用记录和联合类型以及模式匹配来代替类。其次，学习使用一流的函数更积极地分解代码。

不过这些都是小问题。拿起任何一本不错的 F# 书籍，你就会很快地了解它们。然后你就可以开始真正多汁的东西线并行和异步工作流和......

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-28T02:20:37.117

最大的飞跃将是以下事实：

C# 是一种面向对象的编程语言

F# 是一种函数式编程语言

不熟悉函数式编程的开发人员需要了解两者的区别以及如何在两者之间进行转换。好消息是 F# 是 .NET 框架的一部分……许多熟悉的库都将在那里。

# qt - Qt 动画

> ID：918915
> 
> 赞同：2
> 
> 时间：2009-05-28T02:15:07.690
> 
> 标签：qt, animation

我无法理解 QGraphicsItemAnimation 的 setScaleAt 函数是如何工作的。这是我正在使用的代码：

```
 QGraphicsItem *item=scene.addEllipse(400, 300, 100, 100, QPen(), QBrush(Qt::SolidPattern));
    QTimeLine *timeline=new QTimeLine(3000);
    timeline->setFrameRange(0, 100);
    QGraphicsItemAnimation *animation=new QGraphicsItemAnimation;
    animation->setItem(item);
    animation->setTimeLine(timeline);
    for (int i=0; i<100; i++) {
        animation->setScaleAt(i/100.0, i/100.0, i/100.0);
    }
    connect(timeline, SIGNAL(valueChanged(qreal)), animation, SLOT(setStep(qreal)));
    timeline->start(); 
```

我想要它做的就是在屏幕中间显示一个点，然后让它在 3 秒内扩展为一个圆圈。这段代码给我的是一个出现在左上角的点，然后增长并同时移动到中间。我试图通过在每一步设置位置来进行补偿，但这似乎很复杂。必须有一种更清洁的方法来做到这一点。

另外，原始项目在动画开始前会显示一秒钟，有没有办法默认隐藏它，然后显示动画？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T08:43:26.177

这是因为变换的原点位于项目的左上角。您应该使用 addEllipse(-50, -50, 100, 100) 之类的东西，以便原点位于中心。当然，您需要将项目放置在有意义的地方。

# database - 从未标准化的宽表中彻底决裂

> ID：918918
> 
> 赞同：1
> 
> 时间：2009-05-28T02:16:21.087
> 
> 标签：database, database-design, domain-driven-design

我会尽量让这个例子简单。我正在尝试在不遵循 OOP 模式的旧 VB6 应用程序中实现域驱动设计（表示每个表的业务对象）。现有代码的编写方式与您对 10 年前的 VB 应用程序的预期一样（即使用 ADODB.Recordset，但字段没有智能感知）。现有代码是非 OOP 的，我对遵循其现有模式感到畏缩。我的挑战之一是如何在出现新需求时处理数据库更改，而不会给以后可能会查看数据库设计的任何开发人员造成太多混乱。

假设在这个应用程序中，我们有一个假设的“客户”表，该表显然负担过重：clientId ClientName ContactName Address City State Zip Phone CreditLimit CurBalance（并且不断地不断地......）

新的要求需要新的金融领域：利率条款

将 InterestRate 和 Terms 分成单独的“财务”表是否可以接受，这可能看起来像一个奇怪的拆分，因为现有的 2 个财务字段将存在于原始表中？

理想情况下，旧的财务字段（CreditLimit、CurBalance）将被重新定位到这个新表中，但是冒着破坏应用程序的许多部分的风险，不希望移动字段。我只是想停止当前使桌子越来越宽的做法。

基本上，我想我想单独留下旧代码/表设计，彻底打破新字段，并创建域对象来处理任何现有和新表，即客户端对象可以公开表示新财务表的财务属性。

尝试彻底打破或只是在现有的垃圾中添加新字段是个好主意吗？是否有一个聪明的命名方案来表示新表与旧表？DBA 如何在不破坏现有设计的情况下彻底决裂？

感谢您的任何想法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T02:22:28.877

你可以使用视图。您可以使客户视图不再公开财务信息，并创建财务视图以公开信息。他们共享同一个基表对最终用户来说并不重要，因为......

然后，您拒绝对表的所有访问，仅通过存储的过程和视图进行访问，然后您可以随时重构您的表。

或者，您可以重命名表并将其拆分并在旧表名下创建视图。

要记住的重要一点是业务对象不会将 1-1 映射到表。将有关系的链接表（例如，client_account 将客户链接到帐户），但不会有关系的业务对象，相反，客户对象通常会有一个帐户集合和/或反之亦然，具体取决于设计约束.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T04:58:41.667

根据您正在访问的数据库，涉及视图的另一个选项是用适当规范化的设置替换现有数据模型，然后使用旧表的名称创建视图。因此，如果您今天有一个 CLIENT 表，您可以将其拆分为任何合适的表集，并创建一个复制现有表结构的 CLIENT 视图。假设视图是可更新的（这可能需要 Oracle 的 INSTEAD OF 触发器之类的东西），现有代码将只访问视图而无需更改。新代码可以访问适当的数据模型（直接或通过另一组视图让您在未来自由地发展数据模型而不影响应用程序代码）。当您有时间重构现有代码时，您可以将其指向新的数据模型。

# asp.net - 检查生产 ASP.NET 进程的状态

> ID：918920
> 
> 赞同：0
> 
> 时间：2009-05-28T02:19:59.007
> 
> 标签：asp.net, production, strace

有没有办法检查生产环境中的 asp.net 进程在做什么？在 Linux 中，可以在进程 id 上运行 strace 并确切知道进程在做什么。可以在 asp.net 进程上做类似的事情吗？谷歌搜索告诉我你需要创建转储文件然后在那里分析问题，但如果我只想检查进程的当前状态怎么办？（如缓存大小、运行时间最长的线程、特定对象的#...等）。

任何帮助都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T02:21:32.590

您可以使用 PerfMon 查看问题中的大部分信息。

[这提供了使用 perfmon http://msdn.microsoft.com/en-us/library/3xxk09t8(VS.71).aspx](http://msdn.microsoft.com/en-us/library/3xxk09t8(VS.71).aspx)进行 ASP.Net 监控的概述

要查看托管内存使用情况，请查看 .Net Garbage Collector（您可以将其过滤到 asp.net 网站）。

查看进程计数器以获取有关 IIS 工作进程的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T03:04:33.127

正如 JD 所说，PerfMon 可以帮助您。您还应该查看[Windows Sysinternals 工具](http://technet.microsoft.com/en-us/sysinternals/default.aspx)。最能帮助您的两个 Sysinternal 工具是：

*   [进程浏览器](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)
*   [进程监视器](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)

# javascript - 使用 jquery 内联编辑链接 - 防止在编辑时单击它们

> ID：918930
> 
> 赞同：1
> 
> 时间：2009-05-28T02:23:12.540
> 
> 标签：javascript, jquery

我正在尝试使用 jQuery 编辑网站的部分内容，到目前为止一切正常，预计某些可编辑项目是链接。尝试编辑字段时，它会单击 href。

这是jQuery：

```
$(".button-edit").click(function(){
    $(".edit").each(function() {
       $(this).html('<input type="text" value="' + $(this).html() + '" />');
   });
}); 
```

和html片段：

```
<li class="list-item" id="list-item-229"><a href="http://test.com/" class="edit">My site</a>
<p class="edit">lorum ipsum description</p></li> 
```

单击编辑按钮后：

```
<li class="list-item" id="list-item-229"><a href="http://test.com/" class="edit"><input type="text" value="My Site"></a>
<p class="edit"><input type="text" value="lorum ipsum description"/></p></li> 
```

我试过使用类似的东西：

```
$('.edit > a').bind("click", function(){
    return false;
}); 
```

但是它会阻止编辑输入字段。有没有办法防止点击href，但保持输入可编辑？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T02:34:43.890

```
$('.edit > a').bind("click", function(e){
    e.preventDefault();
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T02:38:41.543

尝试这个：

```
var editing=false;

$(".button-edit").click(function(){
$(".edit").each(function() {
         editing=true;
         $(this).html('<input type="text" value="' + $(this).html() + '" />');
    });
});

$(".button-save").click(function(){
        editing=false;
        //and you pick text from input and put in <p>
});  

$('a.edit').bind("click", function(e){
    if(editing){
          e.preventDefault();
          return false;
     }
}); 
```

在 $(".button-save") 中，您可以在退出编辑时设置*editing=false 。*

# php - 测试是否使用 PHP 安装程序

> ID：918942
> 
> 赞同：1
> 
> 时间：2009-05-28T02:28:50.970
> 
> 标签：php, windows, linux, system

对于我正在处理的特定 PHP 脚本，我将使用对 Lynx Web 浏览器的系统调用将 HTML 转换为纯文本并捕获输出：

```
$text = `lynx -dump stackoverflow.com`;

/*
#[1]Stack Overflow [2]RSS

[3]login | [4]about | [5]faq
____________________________
[6]logo homepage
  * [7]Questions
  * [8]Tags
  * [9]Users
  * [10]Badges
*/ 
```

然而，我想做的是优雅地回退到另一种方法，以防 Lynx 在服务器上不可用。**如何检查 PATH 中是否存在程序？**哦，它需要同时在 Windows 和 Linux 上工作......：p

*我不是在写一个 SO 屏幕刮板，别担心......*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T02:39:58.857

在 Linux 中，我会使用**which**

```
which linx 
```

不知道窗户。您可能会看到调用不存在的应用程序时收到的错误消息是什么，我希望它是一个非常恒定的错误消息
（希望它不是蓝屏，那么您将不得不使用某种方式来选择屏幕颜色:-D)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T02:41:34.767

一种可能的解决方案是使用 popen 函数。尝试从 lynx 打开输入管道。如果它返回 false，您可以使用您的回退方法。查看[PHP popen 函数文档](http://php.net/popen "PHP popen 函数文档")以获取详细信息和实现示例。

我刚刚注意到这是针对 Windows 的，所以，我将不得不使用我的后备并说你的里程会有所不同。如果您想确保 lynx 实用程序可用，我建议您确保它在那里并且您（和您的脚本）知道它在哪里。指向脚本执行的先决条件位置的配置文件没有任何问题。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-28T09:33:49.943

为什么不使用**`curl_*`**函数**`fopen`**甚至**`fsockopen`**？

实际上，页面转储**`file_get_contents`**就足够了（`allow_url_fopen`应该在您的 php 配置中启用）。

阅读 php.net 上的相应手册以获取更多信息。

# php - PHP/JavaScript。浏览器永远“加载”，即使在所有资源下载完成后，加上 Opera/Chrome 问题

> ID：918946
> 
> 赞同：3
> 
> 时间：2009-05-28T02:30:23.837
> 
> 标签：php, javascript, cross-browser

我有一个执行以下操作的页面：

1.  浏览器加载一个非常简单的页面，该页面具有有效的头部和主体，只有一个脚本/noscript 对作为内容。

2.  在正文中，它有一个运行 onLoad 函数的脚本（脚本 a）。此函数动态包含第二个脚本（脚本 b），并在它可用时在其中运行一个函数。

3.  第二个脚本是一个执行各种工作的 .js 文件。

这两个脚本都由 PHP 解析并使用 application/x-javascript 内容类型。

现在，除了几个 JS 打嗝之外，我的一切工作都很好。JavaScript 不是我擅长的语言之一，所以我希望这些都是简单的问题，有人可以为我指明正确的方向。

**问题1：**如果我做一个简单的警报（'你在脚本b'）；在第二个脚本中，它按预期工作。但是，如果我做任何其他事情，它可以正常工作，然后浏览器会不断指示它正在永远加载。这是 Firefox 中的补间颜色，或 IE 中的旋转物体。

我试过以不同的方式结束脚本，但似乎没有任何帮助。知道如何向浏览器指示脚本已完全加载吗？这是一个强制通过 PHP 解析的 .js 文件。

**问题 2：**第二个脚本似乎根本不包含在 Opera 或 Google Chrome 中。在 FF/IE 中工作正常，除了加载问题。谁能看到我在加载第二个脚本时是否使用了不兼容的东西？

谢谢！

**更新：**

感谢您的回答。我实际上有萤火虫，这就是为什么我知道一切正常（至少在 FF 中）。我实际上并不知道该脚本在 Opera/Chrome 中不起作用，但没有任何反应。

这是相当多的代码=o）我将从萤火虫中复制实际响应并将其发布，这样您就可以确切地看到代码是什么。至于关闭连接的网络服务器，我也是这么想的，但是如果我将脚本 b 设置为 alert('whatever'); 似乎很奇怪。它会发出警报然后停止加载，但我所做的一切都完全相同，但制作脚本 document.write('whatever); 它将永远加载。

以下是脚本，更新，直接从 firebug 的 net 选项卡复制：

请注意，discoverfire.net 是一个内部域，因此您将无法从那里加载任何内容...

**初始 HTML 页面：**

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <title>Welcome!</title>
    <style>body { font-family:arial; }</style>
    <script language="JavaScript" type="text/javascript" src="http://www.discoverfire.net/analytics/l/a.js">
    </script>
    <script language="JavaScript" type="text/javascript">
        document.onload = Start();
        function Start(){
            TAFKing_version = '1.0';
            TAFKing_lkey = '19-8O-KKA8HV';
            TAFKing_Lander();
        }
    </script>
</head>
<body>
    <noscript>
        Oops!  We can't forward you properly because your JavaScript is turned off.<br /><br />
        <a href='http://www.discoverfire.net/analytics/l/noscript/19-8O-KKA8HV.html'>Please click here to continue.</a>
        <img src='http://www.discoverfire.net/analytics/l/imp/19-8O-KKA8HV.png' border='0' alt='tell a friend' />
    </noscript>
</body>
</html> 
```

** 脚本 A (...a.js)：[http](http://www.discoverfire.net/analytics/l/a.js) ://www.discoverfire.net/analytics/l/a.js **

```
function TAFKing_Lander(){

    version = TAFKing_version;
    lkey = TAFKing_lkey;

    var scrb = document.createElement('script');
    scrb.type = 'text/javascript';
    scrb.src = 'http://www.discoverfire.net/analytics/l/b.js?lkey='+lkey+'&version='+version+'&cb=4eohe8e65'
;

    document.getElementsByTagName('head')[0].appendChild(scrb);
    Interval = setInterval("Waiter()", 10);

    return;

}

function Waiter(){
    if(window.TAFKing_LanderB) {
        clearInterval(Interval);
        TAFKing_LanderB();
    }
} 
```

**脚本 B (...b.js)： [http ://www.discoverfire.net/analytics/l/b.js?lkey=19-8O-KKA8HV&version=1.0&cb=4eohe8e65](http://www.discoverfire.net/analytics/l/b.js?lkey=19-8O-KKA8HV&version=1.0&cb=4eohe8e65)**

```
function TAFKing_LanderB(){
    document.write("there are just a whole bunch of doc.writes here that build a simple table");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T03:22:55.370

我敢打赌，这与脚本无关，而是与网络服务器有关。您的描述，特别是它影响许多浏览器，其中一些甚至不运行脚本，让我相信网络服务器没有关闭连接。也许网络服务器没有正确处理 HTTP/1.1 Keep-alive 请求。

尝试在 Firefox 中使用[Firebug](http://getfirebug.com/)。安装它，为您的页面启用它，重新加载页面并检查“网络”选项卡以了解真正保持连接打开的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T03:32:29.593

这是很多代码要经过。您绝对应该让 Firebug 来帮助您诊断它。最新版本甚至会向您显示何时/是否发生 onload 事件。

Firebug 还允许您通过写入`console.log('somevar=',var);`来测试它们的值来简单地输出消息。您甚至可以在页面加载后使用控制台来测试值，因为您使用的是全局名称空间。

在我的脑海中，我会确保连接在 php.ini 中正确关闭。还

document.onload = Start();

会将 Start() 的结果分配给 onload，而不是稍后定义的 Start。

window.onload 也更兼容/标准。

您可能希望将 js 文件的输出保存为 outputphpA.js 和 outputphpB.js，直接获取这些文件并查看加载行为是否不同。这应该有助于诊断是否是 php 问题。

# sql-server - 在 SQL Server 集成服务 (SSIS) 中使用 Web 服务

> ID：918950
> 
> 赞同：0
> 
> 时间：2009-05-28T02:32:34.330
> 
> 标签：sql-server, web-services, ssis

大家好，谁能告诉我 Web 服务的实时使用情况？

**使用SSIS**中的**Web Service Task**调用 Web 服务后，我们如何使用该 Web 服务？

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T04:04:55.057

Web 服务可以提供您要带入数据库的数据（用于导入的流），或者它可以提供复杂的计算（运输成本），或者它可以提供参数信息（今天的汇率）。

您能否提供有关您的使用场景的更多信息？

# windows-vista - 有没有办法检测 vista 中的另一个进程是否以 32 位或 64 位模式运行？

> ID：918953
> 
> 赞同：2
> 
> 时间：2009-05-28T02:33:27.137
> 
> 标签：windows-vista, 64-bit, 32-bit, detection

我正在编写一个与 x64 Vista 机器上的其他进程交互的应用程序。为了做到这一点，它需要知道其他进程是在 32 位还是 64 位模式下运行。我怎样才能检测到这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T02:57:34.843

您需要先获取进程句柄，然后调用[IsWow64Process()](http://msdn.microsoft.com/en-us/library/ms684139(VS.85).aspx)。如果是 32 位进程，它将返回 false。

请注意，如果您甚至没有在 64 位 Windows 上运行，您还必须调用[GetProcAddress()](http://msdn.microsoft.com/en-us/library/ms683212(VS.85).aspx)以确保[IsWow64Process()甚至可用。](http://msdn.microsoft.com/en-us/library/ms684139(VS.85).aspx)

干杯!
肖恩

# mysql - MySQL字符串替换

> ID：918954
> 
> 赞同：1
> 
> 时间：2009-05-28T02:33:33.517
> 
> 标签：mysql, regex, replace, preg-replace

嘿，使用 MySQL 从特定列中的所有行中删除开始和结束斜杠的最有效方法是什么？

**前：**

```
/hello/world/
foo/bar/
/something/else
/one/more/* 
```

**后：**

```
hello/world
foo/bar
something/else
one/more/* 
```

...或者也许这应该在 PHP 中完成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T02:43:52.047

见[修剪（）](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_trim)

```
UPDATE MY_TABLE SET my_field=TRIM(BOTH '/' FROM my_field); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T02:37:42.230

您绝对不能使用[MySQL 字符串函数](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html)来完成这项工作，但我认为这最好在数据库之外使用 PHP 或您选择的任何编程语言来处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T02:45:18.987

您的 PHP 选项：（我假设获取的行位于`$row`）

```
$row['Field'] = explode('/', $row['Field']);
//Remove the empty elements
$row['Field'] = array_filter($row['Field']);
$row['Field'] = implode('/', $row['Field']); 
```

# iphone - 如何将分组的 UITableView 单元格的背景更改为黑色（或非白色）？

> ID：918968
> 
> 赞同：1
> 
> 时间：2009-05-28T02:40:04.207
> 
> 标签：iphone, cocoa-touch, uitableview

只是想确保我没有忽略一些明显的东西......似乎将 UITableView 的单元格的背景颜色（黑色很好）设置为白色或完全透明以外的其他颜色似乎是微不足道的，这样你就可以显示你的带有白色文本的数据。然而，随着我的尝试，我失去了分组表格视图的角落，这一切看起来都像废话。

我已经看到并理解了[Matt Gallagher](http://cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html)描述的关于使用奇异渐变等自定义 TableView 单元格的方法，但我想在沿着这条道路前进之前确定...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T06:11:23.603

我相信 Grouped 样式的圆角实际上是表格单元格的背景。因此，您不能只替换白色部分，因为它不是带有绘制边框的纯色 - 它是 ImageView 作为单元格的背景视图（根据单元格行和部分中的行数使用不同的图形）。

所以要么你尝试使用你自己的图形，这样你就可以保持圆度（我正在为自己尝试一些东西，还没有完全弄清楚）或者将每个 cell.backgroundView 设置为 nil 并使用 cell.backgroundColor = [UIColor blackColor];

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-25T04:09:27.873

如果您编辑 cell.backgroundColor 而不是 cell.contentView.backgroundColor 它应该适合您。

# asp.net - 如何在 ASP.NET MVC 中扩展 ValidationSummary HTML Helper？

> ID：918969
> 
> 赞同：15
> 
> 时间：2009-05-28T02:40:24.237
> 
> 标签：asp.net, asp.net-mvc, validation

我需要将验证摘要包装在*div*中。当出现错误时，如何设置验证摘要以用*div*包装它？

```
<div class="validation-summary"> 
  <%= Html.ValidationSummary("Login was unsuccessful. Please correct the errors and try again.") %>
</div> 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-28T05:19:38.303

我不得不在我的另一个项目中扩展验证摘要扩展，以处理页面上的多个表单。

尽管这有所不同，但您可以创建自己的扩展方法...

```
namespace System.Web.Mvc
{
    public static class ViewExtensions
    {
        public static string MyValidationSummary(this HtmlHelper html, string validationMessage)
        {
            if (!html.ViewData.ModelState.IsValid)
            {
                return "<div class=\"validation-summary\">" + html.ValidationSummary(validationMessage) + "</div>"
            }

            return "";
        }
    }
} 
```

然后打电话

```
<%= Html.MyValidationSummary(
    "Login was unsuccessful. Please correct the errors and try again.") %> 
```

HTH，查尔斯

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-28T04:34:26.077

你可以做的是：

```
<%if (!ViewData.ModelState.IsValid) { %>
<div class="validation-summary"> 
    <%= Html.ValidationSummary(
        "Login was unsuccessful. Please correct the errors and try again.") %>
</div>
<% } %> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-09-09T21:53:16.707

对于 MVC 2，ValidationSummary 是一个扩展方法，你必须添加

```
using System.Web.Mvc.Html; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-11T20:22:07.737

例如，将此 CSS 用于 li 标签...

```
.validation-summary-errors ul li {color:Red;} 
```

# seo - 我什么时候应该使用或避免使用子域？

> ID：918971
> 
> 赞同：5
> 
> 时间：2009-05-28T02:40:54.750
> 
> 标签：seo, subdomain

最近，一位用户告诉我尽可能避免使用子域。我记得阅读谷歌将子域视为一个独特的站点（这是真的吗？）。当我使用子域以及何时应该使用或不应该使用子域时，还会发生什么？

我听说 cookie 不在子域之间共享？我知道 2 张图片可以同时来自一个站点的 DL。如果我使用 sub1.mysite.com 和 sub2.mysite.com，我可以 DL 4 吗？

我还应该知道什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T02:44:57.300

您**可以**在子域之间共享 cookie，前提是您在 cookie 中设置了正确的参数。但默认情况下，它们不会被共享。

是的，如果您将图像存储在不同的子域中，您可以获得更多的同时下载。然而，规模的另一面是用户花费更多时间解析 DNS，因此拥有 25 个子域来获得 50 个同时下载是不切实际的。

子域发生的另一件事是 AJAX 请求不会不费吹灰之力（您可以使用 document.domain 技巧使它们工作，但这远非简单）。

然而，对 SEO 部分无能为力，尽管有些人不鼓励 yoursite.com 和 www.yoursite.com 工作并返回相同的内容，因为它“稀释了您的页面排名”。不知道那是多么真实。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T03:00:49.767

你把很多事情复杂化了。收集统计数据、控制蜘蛛、html5 存储、XSS、帧间通信、虚拟主机设置、第三方广告服务、与谷歌地图等远程 API 交互。

这并不是说这些事情无法解决，只是复杂性的增加增加了更多的工作，并且可能无法提供适当的好处来弥补。

我应该补充一点，我曾经为分类网站走这条路，添加了 porshe.site.com、ferrari.site.com 等域，希望提高这些关键字的排名。最后，我没有看到明显的改进，更糟糕的是，谷歌通过每个子域遍历整个站点，这意味着搜索 ferraris 可能会返回 porsche.site.com/ferraris 而不是 ferrari.site.com/ferraris。简而言之，谷歌认为每个站点都是重复的，但每次访问时它仍然会抓取每个站点。

同样，存在解决方法，但我选择了简单，我不后悔。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T03:04:56.200

如果您使用子域来存储您的网站图像、javascript、样式表等，那么您的页面可能会加载得更快。浏览器限制每个域名的同时连接数。您使用的子域越多，可以同时建立更多的连接来收集网页内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T03:10:51.023

> 最近，一位用户告诉我尽可能避免使用子域。我记得阅读谷歌将子域视为一个独特的站点（这是真的吗？）。当我使用子域以及何时应该使用或不应该使用子域时，还会发生什么？

我听到的关于谷歌优化的最后一件事是，域比子域的页面排名更重要。我也相信页面排名计算是按页面计算的，而不是按站点计算的（根据算法等）。虽然唯一能真正告诉你的是谷歌员工。

> 我听说 cookie 不在子域之间共享？

您应该能够为所有子域使用 cookie。www.mysite.com sub1.mysite.com sub2.mysite.com 都可以共享相同的 cookie，但不能与他们共享为 mysite.com 指定的 cookie。

> 我知道 2 张图片可以同时来自一个站点的 DL。如果我使用 sub1.mysite.com 和 sub2.mysite.com，我可以 DL 4 吗？

我不确定你所说的 DL 同时是什么意思。通常，具有单线程的浏览器会一次下载一个图像，即使来自不同的域也是如此。具有多线程配置的浏览器可以同时从不同的域下载多个项目。

# nhibernate - 我从哪里下载 Iesi.Collections？

> ID：918976
> 
> 赞同：6
> 
> 时间：2009-05-28T02:43:08.943
> 
> 标签：nhibernate, iesi-collections

试用 nHibernate，它说找不到 Iesi.Collections。

我可以从哪里得到这个？如果它如此重要，它不应该随 nHibernate 下载一起提供吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T11:48:07.960

NHibernate 提供的 Iesi.Collections 的来源在这里： [https ://github.com/nhibernate/nhibernate-core/tree/3.3.x/src](https://github.com/nhibernate/nhibernate-core/tree/3.3.x/src)

在 2012 年，它被移动到单独的存储库： [https](https://github.com/nhibernate/iesi.collections) ://github.com/nhibernate/iesi.collections 最近该存储库中的 master 进行了重大更改以适应 .Net 4，但在此之前，API 多年来基本上没有变化。

NuGet 上提供了新旧版本的二进制文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-03-08T03:24:52.840

这可能是一个老问题，但[可以通过 NuGet 获得](http://nuget.org/packages/Iesi.Collections)。

![在此处输入图像描述](https://i.stack.imgur.com/LvZfq.png)

# .net - LINQ to SQL 违反具有 NULL 列的 UNIQUE KEY 约束

> ID：918977
> 
> 赞同：0
> 
> 时间：2009-05-28T02:43:20.987
> 
> 标签：.net, sql-server, linq-to-sql

我有下表。当我尝试使用 LINQ to SQL 插入记录时，它工作正常，直到我尝试插入 UserId 为空的记录。当我尝试时，我收到以下错误

“UNIQUE KEY 约束不能在对象中插入重复键”

我只是想插入 1 条记录，表是空的，所以唯一约束绝对没有冲突。

```
CREATE TABLE [dbo].[QuickViewUserModule](
    [QuickViewUserModuleId] [int] IDENTITY(1,1) NOT NULL,
    [QuickViewModuleId] [int] NOT NULL,
    [UserId] [int] NULL,
    [SortOrder] [tinyint] NOT NULL,
... More key stuff ...
    CONSTRAINT [IX_QuickViewUserModule] UNIQUE NONCLUSTERED  (  
        [UserId] ASC,   
        [QuickViewModuleId] ASC)
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T02:48:41.287

它似乎与约束本身有关，而不是与 LINQ to SQL 有关。我不是专家，但也许 UNIQUE CONSTRAINT 不会让您在这些字段中有 NULL 值（例如，您不能在主键中有 null 值）

您是否尝试过使用 Management Studio 中的 NULL UserID 执行 INSERT，以查看问题出在 LINQ 端还是 SQL Server 端？此外，如果它在 Management Studio 中工作，请尝试为 LINQ 启用日志记录，并附加正在运行的实际 SQL 查询，这将有助于诊断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T02:50:41.830

那么第一个也是唯一一个插入`NULL UserId`失败？所以你应该能够设置一个简单的复制案例并发布 LINQ 代码？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T03:10:41.633

好的，问题实际上不是插入语句。事实上，当 UserId 为 NULL 时，我没有返回任何记录，因此再次插入相同的记录。所以... SQL Server 做的是正确的事情 :)

然而，在 LINQ 中处理空值时，我发现了一些奇怪的东西。我不得不改变以下

```
return (from dm in Context.DesktopModules
        join qvu in Context.QuickViewUserModules on dm.DesktopModuleID equals qvu.QuickViewModuleId
        where qvu.UserId == (userId == Null.NullInteger ? null : (int ?)userId)
        orderby qvu.SortOrder, dm.ModuleName ascending
        select dm).ToList(); 
```

对此

```
if(userId == Null.NullInteger)
{
    return (from dm in Context.DesktopModules
        join qvu in Context.QuickViewUserModules on dm.DesktopModuleID equals qvu.QuickViewModuleId
        where qvu.UserId == null
        orderby qvu.SortOrder, dm.ModuleName ascending
        select dm).ToList();
}
else
{
    return (from dm in Context.DesktopModules
        join qvu in Context.QuickViewUserModules on dm.DesktopModuleID equals qvu.QuickViewModuleId
        where qvu.UserId == userId
        orderby qvu.SortOrder, dm.ModuleName ascending
        select dm).ToList();
} 
```

当 (int) & (int ?) 混合在一起时，LINQ 似乎不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T03:17:14.913

我也总是与 null 值作斗争，最终在可空类型和不可空类型之间来回转换。我知道还有另一个与 FK 和 NULL 相关的问题，在删除时您可能会遇到：

[http://blogs.msdn.com/bethmassi/archive/2007/10/02/linq-to-sql-and-one-to-many-relationships.aspx](http://blogs.msdn.com/bethmassi/archive/2007/10/02/linq-to-sql-and-one-to-many-relationships.aspx)

# sql - 从列中的所有值中减去最小值

> ID：918987
> 
> 赞同：3
> 
> 时间：2009-05-28T02:52:57.363
> 
> 标签：sql

是否有另一种方法可以从列的所有值中减去最小值，从而有效地抵消这些值？

对于更复杂的查询，我发现的唯一方法变得非常复杂。

```
CREATE TABLE offsettest(value NUMBER);
INSERT INTO offsettest VALUES(100);
INSERT INTO offsettest VALUES(200);
INSERT INTO offsettest VALUES(300);
INSERT INTO offsettest VALUES(400);

SELECT value - (SELECT MIN(value) FROM offsettest) FROM offsettest;

DROP TABLE offsettest; 
```

如果可能的话，我想将其限制为单个查询（没有存储过程、变量等），并且首选标准 SQL（尽管我使用的是 Oracle）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T03:19:55.577

我相信这适用于 ANSI 1999。

`SELECT value - MIN(value) OVER() FROM offsettest;`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-28T03:45:58.923

不过，它会帮助您查看实际查询，因为取决于您是否需要以这种方式操作多个列，并且各种最小值来自不同的行，可能会有更有效的方法来执行此操作。如果 OVER() 对你有用，那很好。

# c# - C# - 捕获鼠标光标图像

> ID：918990
> 
> 赞同：31
> 
> 时间：2009-05-28T02:53:53.400
> 
> 标签：c#, icons, screenshot, mouse-cursor

## 背景

*   我正在编写一个屏幕捕获应用程序
*   我的代码基于此项目：[http ://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?display=Print](http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?display=Print)
*   请注意，代码也捕获鼠标光标（这对我来说是可取的）

## 我的问题

*   当鼠标光标是普通指针或手形图标时，代码工作正常 - 鼠标在屏幕截图上正确呈现
*   但是，当鼠标光标更改为插入点（“I-beam”光标）时 - 例如在 NOTEPAD 中键入 - 然后代码不起作用 - 结果是我得到了一个模糊的光标图像 - 就像一个它的非常半透明（灰色）版本，而不是预期的空白和白色。

## 我的问题

*   当图像是这些“工字梁”型图像之一时，如何捕获鼠标光标图像
*   注意：如果您点击有人提出建议的原始文章 - 它不起作用

## 来源

这是来自原始文章。

```
 static Bitmap CaptureCursor(ref int x, ref int y)
    {
        Bitmap bmp;
        IntPtr hicon;
        Win32Stuff.CURSORINFO ci = new Win32Stuff.CURSORINFO();
        Win32Stuff.ICONINFO icInfo;
        ci.cbSize = Marshal.SizeOf(ci);
        if (Win32Stuff.GetCursorInfo(out ci))
        {
            if (ci.flags == Win32Stuff.CURSOR_SHOWING)
            {
                hicon = Win32Stuff.CopyIcon(ci.hCursor);
                if (Win32Stuff.GetIconInfo(hicon, out icInfo))
                {
                    x = ci.ptScreenPos.x - ((int)icInfo.xHotspot);
                    y = ci.ptScreenPos.y - ((int)icInfo.yHotspot);

                    Icon ic = Icon.FromHandle(hicon);
                    bmp = ic.ToBitmap(); 
                    return bmp;
                }
            }
        }

        return null;
    } 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-06-20T02:54:40.753

虽然我无法准确解释为什么会发生这种情况，但我想我可以展示如何解决它。

ICONINFO 结构包含两个成员，hbmMask 和 hbmColor，分别包含光标的掩码和颜色位图（有关官方文档，请参阅[ICONINFO的 MSDN 页面）。](http://msdn.microsoft.com/en-us/library/ms929934.aspx)

当您为默认光标调用 GetIconInfo() 时，ICONINFO 结构包含有效的掩码和颜色位图，如下所示（注意：已添加红色边框以清楚显示图像边界）：

**默认光标遮罩位图** [![默认光标掩码位图图像](https://i.stack.imgur.com/QlCof.png)](https://i.stack.imgur.com/QlCof.png)

**默认光标颜色位图** [![默认光标颜色位图图像](https://i.stack.imgur.com/YyuI8.png)](https://i.stack.imgur.com/YyuI8.png)

当 Windows 绘制默认光标时，首先通过 AND 光栅操作应用遮罩位图，然后通过 XOR 光栅操作应用颜色位图。这会产生不透明的光标和透明的背景。

但是，当您为 I-Beam 光标调用 GetIconInfo() 时，ICONINFO 结构仅包含有效的掩码位图，没有颜色位图，如下所示（注意：再次添加红色边框以清楚显示图像边界):

**I-Beam 光标遮罩位图** [![ibeam 光标遮罩位图图像](https://i.stack.imgur.com/O5iAp.png)](https://i.stack.imgur.com/O5iAp.png)

根据 ICONINFO 文档，I-Beam 光标是单色光标。掩码位图的上半部分是 AND 掩码，掩码位图的下半部分是 XOR 位图。当 Windows 绘制 I-Beam 光标时，该位图的上半部分首先通过 AND 光栅操作绘制在桌面上。然后使用 XOR 光栅操作在顶部绘制位图的下半部分。在屏幕上，光标将显示为它后面的内容的反面。

您链接的原始文章的[评论之一提到了这一点。](http://www.codeproject.com/Messages/1408725/Have-you-solved-the-IBeam-cursor-problem.aspx)在桌面上，由于在桌面内容上应用了光栅操作，因此光标将正确显示。但是，当图像在没有背景的情况下绘制时，如在您发布的代码中，Windows 执行的光栅操作会导致图像褪色。

话虽如此，这个更新后的 CaptureCursor() 方法将同时处理彩色和单色光标，当光标为单色时提供纯黑色光标图像。

```
static Bitmap CaptureCursor(ref int x, ref int y)
{
  Win32Stuff.CURSORINFO cursorInfo = new Win32Stuff.CURSORINFO();
  cursorInfo.cbSize = Marshal.SizeOf(cursorInfo);
  if (!Win32Stuff.GetCursorInfo(out cursorInfo))
    return null;

  if (cursorInfo.flags != Win32Stuff.CURSOR_SHOWING)
    return null;

  IntPtr hicon = Win32Stuff.CopyIcon(cursorInfo.hCursor);
  if (hicon == IntPtr.Zero)
    return null;

  Win32Stuff.ICONINFO iconInfo;
  if (!Win32Stuff.GetIconInfo(hicon, out iconInfo))
    return null;

  x = cursorInfo.ptScreenPos.x - ((int)iconInfo.xHotspot);
  y = cursorInfo.ptScreenPos.y - ((int)iconInfo.yHotspot);

  using (Bitmap maskBitmap = Bitmap.FromHbitmap(iconInfo.hbmMask))
  {
    // Is this a monochrome cursor?
    if (maskBitmap.Height == maskBitmap.Width * 2)
    {
      Bitmap resultBitmap = new Bitmap(maskBitmap.Width, maskBitmap.Width);

      Graphics desktopGraphics = Graphics.FromHwnd(Win32Stuff.GetDesktopWindow());
      IntPtr desktopHdc = desktopGraphics.GetHdc();

      IntPtr maskHdc = Win32Stuff.CreateCompatibleDC(desktopHdc);
      IntPtr oldPtr = Win32Stuff.SelectObject(maskHdc, maskBitmap.GetHbitmap());

      using (Graphics resultGraphics = Graphics.FromImage(resultBitmap))
      {
        IntPtr resultHdc = resultGraphics.GetHdc();

        // These two operation will result in a black cursor over a white background.
        // Later in the code, a call to MakeTransparent() will get rid of the white background.
        Win32Stuff.BitBlt(resultHdc, 0, 0, 32, 32, maskHdc, 0, 32, Win32Stuff.TernaryRasterOperations.SRCCOPY);
        Win32Stuff.BitBlt(resultHdc, 0, 0, 32, 32, maskHdc, 0, 0, Win32Stuff.TernaryRasterOperations.SRCINVERT);

        resultGraphics.ReleaseHdc(resultHdc);
      }

      IntPtr newPtr = Win32Stuff.SelectObject(maskHdc, oldPtr);
      Win32Stuff.DeleteObject(newPtr);
      Win32Stuff.DeleteDC(maskHdc);
      desktopGraphics.ReleaseHdc(desktopHdc);

      // Remove the white background from the BitBlt calls,
      // resulting in a black cursor over a transparent background.
      resultBitmap.MakeTransparent(Color.White);
      return resultBitmap;
    }
  }

  Icon icon = Icon.FromHandle(hicon);
  return icon.ToBitmap();
} 
```

代码存在一些问题，可能是也可能不是问题。

1.  单色光标的检查只是测试高度是否是宽度的两倍。虽然这看起来合乎逻辑，但 ICONINFO 文档并没有强制要求只定义一个单色光标。
2.  可能有更好的方法来呈现我使用的方法调用的 BitBlt() - BitBlt() - MakeTransparent() 组合的光标。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-01-31T10:42:23.187

```
[StructLayout(LayoutKind.Sequential)]
struct CURSORINFO
{
    public Int32 cbSize;
    public Int32 flags;
    public IntPtr hCursor;
    public POINTAPI ptScreenPos;
}

[StructLayout(LayoutKind.Sequential)]
struct POINTAPI
{
    public int x;
    public int y;
}

[DllImport("user32.dll")]
static extern bool GetCursorInfo(out CURSORINFO pci);

[DllImport("user32.dll")]
static extern bool DrawIcon(IntPtr hDC, int X, int Y, IntPtr hIcon);

const Int32 CURSOR_SHOWING = 0x00000001;

public static Bitmap CaptureScreen(bool CaptureMouse)
{
    Bitmap result = new Bitmap(Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height, PixelFormat.Format24bppRgb);

    try
    {
        using (Graphics g = Graphics.FromImage(result))
        {
            g.CopyFromScreen(0, 0, 0, 0, Screen.PrimaryScreen.Bounds.Size, CopyPixelOperation.SourceCopy);

            if (CaptureMouse)
            {
                CURSORINFO pci;
                pci.cbSize = System.Runtime.InteropServices.Marshal.SizeOf(typeof(CURSORINFO));

                if (GetCursorInfo(out pci))
                {
                    if (pci.flags == CURSOR_SHOWING)
                    {
                        DrawIcon(g.GetHdc(), pci.ptScreenPos.x, pci.ptScreenPos.y, pci.hCursor);
                        g.ReleaseHdc();
                    }
                }
            }
        }
    }
    catch
    {
        result = null;
    }

    return result;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-23T17:09:19.180

这是 Dimitar 响应的修改版本（使用 DrawIconEx），它在多个屏幕上对我有用：

```
public class ScreenCapturePInvoke
{
    [StructLayout(LayoutKind.Sequential)]
    private struct CURSORINFO
    {
        public Int32 cbSize;
        public Int32 flags;
        public IntPtr hCursor;
        public POINTAPI ptScreenPos;
    }

    [StructLayout(LayoutKind.Sequential)]
    private struct POINTAPI
    {
        public int x;
        public int y;
    }

    [DllImport("user32.dll")]
    private static extern bool GetCursorInfo(out CURSORINFO pci);

    [DllImport("user32.dll", SetLastError = true)]
    static extern bool DrawIconEx(IntPtr hdc, int xLeft, int yTop, IntPtr hIcon, int cxWidth, int cyHeight, int istepIfAniCur, IntPtr hbrFlickerFreeDraw, int diFlags);

    private const Int32 CURSOR_SHOWING = 0x0001;
    private const Int32 DI_NORMAL = 0x0003;

    public static Bitmap CaptureFullScreen(bool captureMouse)
    {
        var allBounds = Screen.AllScreens.Select(s => s.Bounds).ToArray();
        Rectangle bounds = Rectangle.FromLTRB(allBounds.Min(b => b.Left), allBounds.Min(b => b.Top), allBounds.Max(b => b.Right), allBounds.Max(b => b.Bottom));

        var bitmap = CaptureScreen(bounds, captureMouse);
        return bitmap;
    }

    public static Bitmap CapturePrimaryScreen(bool captureMouse)
    {
        Rectangle bounds = Screen.PrimaryScreen.Bounds;

        var bitmap = CaptureScreen(bounds, captureMouse);
        return bitmap;
    }

    public static Bitmap CaptureScreen(Rectangle bounds, bool captureMouse)
    {
        Bitmap result = new Bitmap(bounds.Width, bounds.Height);

        try
        {
            using (Graphics g = Graphics.FromImage(result))
            {
                g.CopyFromScreen(bounds.Location, Point.Empty, bounds.Size);

                if (captureMouse)
                {
                    CURSORINFO pci;
                    pci.cbSize = Marshal.SizeOf(typeof (CURSORINFO));

                    if (GetCursorInfo(out pci))
                    {
                        if (pci.flags == CURSOR_SHOWING)
                        {
                            var hdc = g.GetHdc();
                            DrawIconEx(hdc, pci.ptScreenPos.x-bounds.X, pci.ptScreenPos.y-bounds.Y, pci.hCursor, 0, 0, 0, IntPtr.Zero, DI_NORMAL);
                            g.ReleaseHdc();
                        }
                    }
                }
            }
        }
        catch
        {
            result = null;
        }

        return result;
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-06-02T08:38:03.863

根据其他答案，我制作了一个没有所有 Windows API 内容（用于单色部分）的版本，因为这些解决方案不适用于所有单色光标。我通过组合两个蒙版部分从蒙版创建光标。

我的解决方案：

```
Bitmap CaptureCursor(ref Point position)
{
   CURSORINFO cursorInfo = new CURSORINFO();
   cursorInfo.cbSize = Marshal.SizeOf(cursorInfo);
   if (!GetCursorInfo(out cursorInfo))
      return null;

   if (cursorInfo.flags != CURSOR_SHOWING)
      return null;

   IntPtr hicon = CopyIcon(cursorInfo.hCursor);
   if (hicon == IntPtr.Zero)
      return null;

   ICONINFO iconInfo;
   if (!GetIconInfo(hicon, out iconInfo))
      return null;

   position.X = cursorInfo.ptScreenPos.x - iconInfo.xHotspot;
   position.Y = cursorInfo.ptScreenPos.y - iconInfo.yHotspot;

   using (Bitmap maskBitmap = Bitmap.FromHbitmap(iconInfo.hbmMask))
   {
      // check for monochrome cursor
      if (maskBitmap.Height == maskBitmap.Width * 2)
      {
         Bitmap cursor = new Bitmap(32, 32, PixelFormat.Format32bppArgb);
         Color BLACK = Color.FromArgb(255, 0, 0, 0); //cannot compare Color.Black because of different names
         Color WHITE = Color.FromArgb(255, 255, 255, 255); //cannot compare Color.White because of different names
         for (int y = 0; y < 32; y++)
         {
            for (int x = 0; x < 32; x++)
            {
               Color maskPixel = maskBitmap.GetPixel(x, y);
               Color cursorPixel = maskBitmap.GetPixel(x, y + 32);
               if (maskPixel == WHITE && cursorPixel == BLACK)
               {
                  cursor.SetPixel(x, y, Color.Transparent);
               }
               else if (maskPixel == BLACK)
               {
                  cursor.SetPixel(x, y, cursorPixel);
               }
               else
               {
                  cursor.SetPixel(x, y, cursorPixel == BLACK ? WHITE : BLACK);
               }
            }
         }
         return cursor;
      }
   }

   Icon icon = Icon.FromHandle(hicon);
   return icon.ToBitmap();
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-29T20:24:42.250

您对 I 型光束光标的半透明“灰色”版本的描述让我想知道您是否遇到图像缩放或光标位置错误的问题。

在该网站上发布的一个人提供了一个（损坏的）链接，指向我追踪到的具有特殊行为的报告：[http ://www.efg2.com/Lab/Graphics/CursorOverlay.htm](http://www.efg2.com/Lab/Graphics/CursorOverlay.htm)

该页面上的示例不在 C# 中，但 codeproject 解决方案的作者可能一直在做类似的事情，我知道我自己在很多场合使用图形对象时都搞砸了缩放：

> 在加载图像后的任何 ImageMouseDown 事件中，使用 Canvas.Draw 方法在位图顶部以透明度绘制 CusorBitmap。请注意，如果位图被拉伸以适合 TImage，则需要进行一些坐标调整（重新缩放）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-11-19T21:32:48.483

这是修补版本，其中包含此页面上显示的错误的所有修复：

```
public static Bitmap CaptureImageCursor(ref Point point)
{
    try
    {
        var cursorInfo = new CursorInfo();
        cursorInfo.cbSize = Marshal.SizeOf(cursorInfo);

        if (!GetCursorInfo(out cursorInfo))
            return null;

        if (cursorInfo.flags != CursorShowing)
            return null;

        var hicon = CopyIcon(cursorInfo.hCursor);
        if (hicon == IntPtr.Zero)
            return null;

        Iconinfo iconInfo;
        if (!GetIconInfo(hicon, out iconInfo))
        {
            DestroyIcon(hicon);
            return null;
        }

        point.X = cursorInfo.ptScreenPos.X - iconInfo.xHotspot;
        point.Y = cursorInfo.ptScreenPos.Y - iconInfo.yHotspot;

        using (var maskBitmap = Image.FromHbitmap(iconInfo.hbmMask))
        {
            //Is this a monochrome cursor?  
            if (maskBitmap.Height == maskBitmap.Width * 2 && iconInfo.hbmColor == IntPtr.Zero)
            {
                var final = new Bitmap(maskBitmap.Width, maskBitmap.Width);
                var hDesktop = GetDesktopWindow();
                var dcDesktop = GetWindowDC(hDesktop);

                using (var resultGraphics = Graphics.FromImage(final))
                {
                    var resultHdc = resultGraphics.GetHdc();

                    BitBlt(resultHdc, 0, 0, final.Width, final.Height, dcDesktop, (int)point.X + 3, (int)point.Y + 3, CopyPixelOperation.SourceCopy);
                    DrawIconEx(resultHdc, 0, 0, cursorInfo.hCursor, 0, 0, 0, IntPtr.Zero, 0x0003);

                    //TODO: I have to try removing the background of this cursor capture.
                    //Native.BitBlt(resultHdc, 0, 0, final.Width, final.Height, dcDesktop, (int)point.X + 3, (int)point.Y + 3, Native.CopyPixelOperation.SourceErase);

                    resultGraphics.ReleaseHdc(resultHdc);
                    ReleaseDC(hDesktop, dcDesktop);
                }

                DeleteObject(iconInfo.hbmMask);
                DeleteDC(dcDesktop);
                DestroyIcon(hicon);

                return final;
            }

            DeleteObject(iconInfo.hbmColor);
            DeleteObject(iconInfo.hbmMask);
            DestroyIcon(hicon);
        }

        var icon = Icon.FromHandle(hicon);
        return icon.ToBitmap();
    }
    catch (Exception ex)
    {
        //You should catch exception with your method here.
        //LogWriter.Log(ex, "Impossible to get the cursor.");
    }

    return null;
} 
```

此版本适用于：

1.  工字梁游标。
2.  黑色光标。
3.  普通游标。
4.  反转光标。

在这里查看工作：[https ://github.com/NickeManarin/ScreenToGif/blob/master/ScreenToGif/Util/Native.cs#L991](https://github.com/NickeManarin/ScreenToGif/blob/master/ScreenToGif/Util/Native.cs#L991)

# javascript - 如何在javascript中连接var名称？

> ID：918995
> 
> 赞同：3
> 
> 时间：2009-05-28T02:56:32.973
> 
> 标签：javascript

如何连接 var 名称以在 javascript 中声明新的 var？：

```
var foo = 'var';
var bar = 'Name'; 
```

如何声明变量 varName？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-28T03:05:12.207

尝试类似：

```
window[foo + bar] = "whatever"; 
alert(varName); 
```

不要使用 eval 函数，除非您完全确定其中的内容。如果您所做的只是变量访问，window[] 会更安全

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T03:02:46.703

警告：蒸汽代码！从我的头顶上...

```
window[foo + bar] = "contents of variable varName"; 
```

那样有用吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T03:11:46.000

要动态声明一个*局部*变量（即`var fooName`），我猜你可以使用`eval`：

```
eval('var ' + foo + bar); 
```

最好避免`eval`，如果你能避免的话（见[相关问题](https://stackoverflow.com/questions/86513/why-is-using-javascript-eval-function-a-bad-idea)）。

更好的方法是设置对象属性。定义一个全局变量等同于在全局对象上设置一个属性`window`：

```
window[foo+bar] = 'someVal'; 
```

`window`如果合适，您可以替换另一个对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T04:36:26.840

本地：

```
this[foo+bar] = true; 
```

在全球范围内：

```
window[foo+bar] = true; 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-05-28T03:03:19.403

可能有更好的方法，但 eval 应该这样做

```
eval('var ' + foo + bar); 
```

# objective-c - 如何将带有十六进制值的 NSString 转换为二进制 char*？

> ID：918997
> 
> 赞同：1
> 
> 时间：2009-05-28T02:57:19.273
> 
> 标签：objective-c, cocoa, nsstring

我有一个长的十六进制值存储为 NSString，类似于：

c12761787e93534f6c443be73be31312cbe343816c062a278f3818cb8363c701

如何将其转换回存储为 char* 的二进制值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T03:42:04.687

这有点草率，但应该让你走上正轨：

```
NSString *hexString = @"c12761787e93534f6c443be73be31312cbe343816c062a278f3818cb8363c701";
char binChars[128]; // I'm being sloppy and just making some room
const char *hexChars = [hexString UTF8String];
NSUInteger hexLen = strlen(hexChars);
const char *nextHex = hexChars;
char *nextChar = binChars;
for (NSUInteger i = 0; i < hexLen - 1; i++)
{
    sscanf(nextHex, "%2x", nextChar);
    nextHex += 2;
    nextChar++;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:24:58.200

几周前在一个 Cocoa 邮件列表上有一个关于这个（或非常相似的）十六进制转换主题的线程。

我无法合理地重现此处的完整讨论（长线程），但从线程开始的消息在这里：

[http://www.cocoabuilder.com/archive/message/cocoa/2009/5/9/236391](http://www.cocoabuilder.com/archive/message/cocoa/2009/5/9/236391)

我确实希望有一个 Cocoa 方法来完成这项任务，但是（等待发现或等待其实施）代码（由 Gecko 先生发布，发布于[http://www.cocoabuilder.com/archive/message/cocoa/2009/5 /10/236424](http://www.cocoabuilder.com/archive/message/cocoa/2009/5/10/236424)）看起来它可以在这里工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-12T07:19:49.147

```
static NSString* hexval(NSData *data) {
    NSMutableString *hex = [NSMutableString string];
    unsigned char *bytes = (unsigned char *)[data bytes];
    char temp[3];
    int i = 0;
    for (i = 0; i < [data length]; i++) {
        temp[0] = temp[1] = temp[2] = 0;
        (void)sprintf(temp, "%02x", bytes[i]);
        [hex appendString:[NSString stringWithUTF8String: temp]];
    }
    return hex;
} 
```***********************