# StackOverflow 问答 000467000-000467999

# mysql - 我有哪些选择可以让我的 ORDER BY 更快？

> ID：467002
> 
> 赞同：1
> 
> 时间：2009-01-21T21:07:20.730
> 
> 标签：mysql, query-optimization, sql-order-by

我有以下查询：

```
SELECT DISTINCT c.id
FROM clients AS c
LEFT JOIN client_project AS cp ON (cp.client_id = c.id)
WHERE cp.project_id = 1
    AND c.active_flag = 1
ORDER BY c.client_name 
```

如果我删除订单，查询需要 0.005 秒。使用 order by，查询需要 1.8-1.9 秒。我有一个索引`client_name`。

还有什么可以提高速度的？

**编辑：** c.id 是主键，但在 client_project 中可能有多个记录，因此每个 id 可能会导致多个记录。此外，删除 distinct 会在查询中产生 0.1 秒的差异。

**补充：**这是我的客户表：

```
CREATE TABLE IF NOT EXISTS `clients` (
  `id` int(11) NOT NULL auto_increment,
...
  `organization` varchar(255) character set utf8 collate utf8_bin NOT NULL,
  `client_name` varchar(255) character set utf8 collate utf8_bin NOT NULL,
  `active_flag` tinyint(1) NOT NULL,
...
  PRIMARY KEY  (`id`),
  KEY `active_flag` (`active_flag`),
...
  KEY `organization` (`organization`),
  KEY `client_name` (`client_name`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1; 
```

使用 MySQL 5.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T01:13:29.047

尝试将此密钥添加到`client_projects`：

```
KEY(client_name, id, active_flag) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T21:21:16.740

查看您的编辑

在这种情况下尝试使用 EXISTS

```
SELECT  c.id
FROM clients AS c
WHERE EXISTS (SELECT * FROM  client_project AS cp  
              WHERE cp.client_id = c.id and cp.project_id = 1)
AND c.active_flag = 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T22:33:01.347

我没有给你的解决方案，但我有一个解释。

MySQL 每个表只使用一个索引。您有两个表，其中使用的索引是其中一个的主键（WHERE cp.project_id = 1），并且连接强制使用第二个表索引来有效连接。

之后使用 ORDER BY，MySQL 就不可能使用索引进行排序。添加更多索引无济于事。EXPLAIN 将显示 MySQL 为每个表选择了哪些索引。强制索引会导致查询的其他部分变慢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T21:22:52.603

可能clients.id 和clients.active_flag 上有索引，因此优化器不需要转到完整表（或附加索引），除非您想对其进行排序。

检查优化器计划，我认为在 mySQL 中是 explain 。

client_name, id 上的索引可能会有所帮助（或者可能不会 - 检查计划）。

一些可能有帮助的附加问题/想法/评论...

*   如果您从选择中得到的只是 id，为什么要按名称排序
*   如果您有“cp.project_id”的where子句，为什么要左连接，所以无论如何都不会返回没有项目的客户
*   至于其他海报（paul, eppz），对于拥有多个项目的客户可能需要“不同”。所以另一个想法是做类似的事情

    从存在的客户端 c 中选择 id（从 client_project cp where c.id = cp.client_id 中选择 *）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T21:11:14.077

c.id 是主键吗？如果是这样，您不应该对其执行 DISTINCT，因为它已经是不同的，并且强制 DISTINCT 可能会导致它按 id 排序，然后按 client_name 排序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T21:16:23.443

一些优化是 DB 供应商中立的，而其他优化是 DB 供应商特定的。这里有几件事可以尝试。

*   按照其他地方的建议删除 DISTINCT。
*   考虑使用内连接。我意识到在您的情况下这可能不是一个可行的选择。

此外，运行执行计划以更好地了解查询的哪些部分占用了最多时间以及原因。有关详细信息，请参阅[EXPLAIN](http://dev.mysql.com/doc/refman/5.0/en/explain.html)关键字。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-18T15:15:50.463

您需要在以下位置强制使用索引`client_name`：

```
SELECT id
FROM (
  SELECT c.id,
    (
    SELECT 1
    FROM client_projects cp
    WHERE cp.client_id = c.id
      AND cp.project_id = 1
    LIMIT 1
    ) e
FROM clients c
FORCE INDEX (client_name)
WHERE c.active_flag = 1
ORDER BY
  client_name
) co
WHERE e IS NOT NULL 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-21T21:10:42.017

c.id 是身份列吗？如果是，我认为您不需要 DISTINCT ，因为每个 c.id 都是唯一的。

***编辑***

所以 c.id 可能在 cp 中有多个条目，即使 cp.project_id = 1？

***编辑***

只是好奇为什么在不选择客户名称时要按客户名称订购。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-01-21T21:14:23.400

如果您甚至不退货，为什么要按客户名称订购？

你还需要独特的吗？

如果您的 where 子句无论如何都会使其成为内部联接，那么您为什么要进行左联接

通过在 WHERE 子句之前使用 WHERE cp.project_id = 1 而不是 AND cp.project_id = 1 无论如何它都是一个 INNEr JOIN

# windows - 从网站启动可执行文件？

> ID：467004
> 
> 赞同：4
> 
> 时间：2009-01-21T21:07:46.830
> 
> 标签：windows, web, executable

我们正在开发一个只能在 Intranet 上运行的站点，并且可以访问此 Intranet 的计算机将安装此可执行文件。我们不能有任何“您要打开 [文件名].exe 吗？” 提示。单击一个链接，程序开始运行。

我意识到让网站能够在客户端机器上运行可执行文件是非常非常糟糕的，但管理层拒绝让步。

机器将安装带有 Firefox 3 的 Windows（XP 或更高版本）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-21T21:24:28.497

> 我们正在开发一个只能在 Intranet 上运行的站点，并且可以访问此 Intranet 的计算机将安装此可执行文件。

这是否意味着EXE已经安装在桌面上？你只是想从网站上启动它？

如果是这样，您可以将 EXE 与[MIME 内容类型](http://en.wikipedia.org/wiki/MIME#Content-Type)相关联，当用户单击它时，它将启动。

**为您的 EXE 名称选择内容类型和文件扩展名，例如：**

```
CauseChaos.exe
与 .chaos 文件扩展名相关联
内容类型将是：应用程序/混乱

```

**通过 EXE 安装将文件扩展名与您的 EXE 相关联。我在这里展示它，使用 InnoSetup**

```
[Registry]
Root: HKCR; Subkey: .chaos; ValueType: string; ValueData: CauseChaos; Flags: uninsdeletekey
Root: HKCR; Subkey: CauseChaos; ValueType: string; ValueData: CauseChaos Tool; Flags: uninsdeletekey 
Root: HKCR; Subkey: CauseChaos\DefaultIcon; ValueType: string; ValueData: {app}\CauseChaos.exe,0; Flags: uninsdeletekey
Root: HKCR; Subkey: CauseChaos\shell\open\command; ValueType: string; ValueData: "{app}\CauseChaos.exe ""%1"""; Flags: uninsdeletekey
```

**通过 EXE 安装将 MIME 内容类型与文件扩展名相关联。**

```
[Registry] (continued...)
Root: HKCR; Subkey: HKCR\Mime\Database\Content Type\application/chaos; ValueType: string; ValueName: Extension; ValueData: .chaos; Flags: uninsdeletevalue
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T13:44:26.957

去过也做过。MIME 类型（在我添加这个时接受的答案）需要在客户端和服务器上进行大量配置。这是一项相当多的工作，你最终会得到临时文件等。

我们的解决方案是添加我们自己的“自定义 URL 协议处理程序”。基本上，添加 URL 类型 x-our-intranet 并使您的公司应用程序成为它的 URL 处理程序。现在任何链接都将启动您的公司应用程序，将“x-our-intrenet:foo”作为命令行参数传递。它所需要的只是一个客户端注册表项，类似于 MIME 类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T21:19:16.230

试试这个 JavaScript：

```
function executeCommands(inputparms)
{
// Instantiate the Shell object and invoke its execute method.

var oShell = new ActiveXObject("Shell.Application");

var commandtoRun = "c:\windows\Notepad.exe";

// Invoke the execute method. 
oShell.ShellExecute(commandtoRun, commandParms, "", "open", "1"); 
} 
```

您必须相应地设置浏览器安全设置，这仅适用于 IE。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T21:10:39.367

我可以想象这种工作的唯一方法是通过某种 ActiveX 控件来运行您的可执行文件，但我不知道这对于 Firefox 有多可行。

这应该是你应该拒绝让步的事情之一，而不是管理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T21:13:34.650

我建议您看一下[Adob​​e Flex / Air](http://www.adobe.com/products/air/)，它的设计考虑了这种模型以及它打开的固有安全谷仓门。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T21:16:26.140

我同意其余的，我很确定你不能再这样做了（尤其是在 Firefox 中）。这就是当天安装了多少间谍软件/广告软件程序。你必须表明立场，告诉管理层这是不可能的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T21:16:43.783

主动 X 控件是最简单的方法。有一个用于 Firefox 的插件，允许您托管活动的 X 控件。或者你可以写一个 NS Plugin 来处理这个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-21T21:16:56.937

[这](http://msdn.microsoft.com/en-us/library/aa289511.aspx)是一篇关于可执行文件的 Web 部署的旧文章。我知道使用 Internet Explorer 可以做到这一点（由于我们分散的开发团队，我们仍然必须支持其中的一些）。我不知道Firefox的影响。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-21T23:18:56.907

在用于 IE 的链接中使用“file:///c:/Program Files/myprogs/myprog.exe” URL。但是，我已经很久没有尝试过了。

我会推荐上面的 MIME 类型方法或添加由该可执行文件处理的特殊 URI 前缀“chaos://myparams”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-26T23:45:27.880

我完全理解你想要什么。我在互联网上读到的只是人们提到这是一个重大的安全漏洞等......但是，我猜他们不明白你为什么要实施这个，我会解释为什么我需要这个并正在努力解决这个问题和我越来越近了。

我有许多不同的用户应用程序，例如。呼叫中心等...我目前正在使用以 Kiosk 模式运行的锁定桌面。用户将看到的只是一个带有一些计算机信息和一个 IE 图标的蓝屏。我的目标是从此页面运行 Microsoft Office 和一些内部客户端/服务器应用程序。它工作得很好，因为一切都还在那里，只是我的用户看不到它。不过，我和你有同样的问题。我的网络使用 MPLS、内部和外部托管路由器、防火墙/ASA 和大量安全专业人员非常安全。另外，这仅限于内部。所以，在我看来它完全没问题。因此，如果我为此提出某种解决方法，我会发布它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-01-15T15:01:50.197

如果您想运行计算机上已有的应用程序，您可以通过注册到注册表来实现，然后他们用 HTML 调用它，就像您发送电子邮件 (mailto) 一样。

因此，您只需要创建注册表：

```
using Microsoft.Win32;
using System;
using System.IO;
using System.Linq;

namespace WMConsole
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("Listening..");

            //Gets the current location where the file is downloaded
            var loc = System.Reflection.Assembly.GetExecutingAssembly().Location;
            if (!Directory.Exists(@"D:\Console\"))
            {
                System.IO.Directory.CreateDirectory(@"D:\Console\");
            }
            //Creates the Downloaded file in the specified folder
            if (!File.Exists(@"D:\Console\" + loc.Split('\\').Last()))
            {
                File.Move(loc, @"D:\Console\" + loc.Split('\\').Last());
            }
            var KeyTest = Registry.CurrentUser.OpenSubKey("Software", true).OpenSubKey("Classes", true);
            RegistryKey key = KeyTest.CreateSubKey("alert");
            key.SetValue("URL Protocol", "wnPing");
            key.CreateSubKey(@"shell\open\command").SetValue("", @"D:\Console\WMConsole.exe %1");
        }        
    }
} 
```

然后您可以通过以下方式在 HTML 中调用它：

```
<a href="alert:wmPing">Click to trigger</a> 
```

这是关于它的完整文章： [https ://www.codeproject.com/Articles/1168356/Run-an-EXE-from-Web-Application](https://www.codeproject.com/Articles/1168356/Run-an-EXE-from-Web-Application)

# javascript - 通过 JavaScript 的异步跨域 POST 请求？

> ID：467008
> 
> 赞同：8
> 
> 时间：2009-01-21T21:08:57.357
> 
> 标签：javascript, ajax, cross-domain

我可以创建一个表单并使用它向任何站点发出 POST 请求，事情是 FORM 方法不是异步的，我需要知道页面何时完成加载。我尝试使用内部带有表单的 iframe 来解决这个问题，但没有成功。

有任何想法吗？

**编辑**

不幸的是，我无法控制响应数据，它从 XML、json 到简单文本不等。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-21T21:21:09.453

您可以`onload`捕获`iframe`. 将您的目标定位`form`到 iframe 并监听 onload。但是，您将无法访问 iframe 的内容，只能访问事件。

尝试这样的事情：

```
<iframe id='RS' name='RS' src='about:blank' onload='loaded()'></iframe>

<form action='wherever.php' target='RS' method='POST'>...</form> 
```

脚本块：

```
var loadComplete = 0
function loaded() {
    //avoid first onload
    if(loadComplete==0) {
        loadComplete=1
        return()
    }
    alert("form has loaded")
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T16:10:27.460

如果您想发出跨域请求，您应该进行 JSON 调用或使用服务器端代理。服务器端代理很容易设置，不知道为什么人们如此避免它。在其中设置规则，这样人们就不能使用代理来请求其他东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T21:12:42.623

如果跨域post返回的数据是JSON，那么可以动态添加脚本标签，指向返回数据的URI。浏览器将加载该“脚本”，然后您可以从其他 javascript 访问该“脚本”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T21:25:46.277

[YUI3](http://developer.yahoo.com/yui/3/)的[IO](http://developer.yahoo.com/yui/3/io/)对象提供跨域请求，但是它使用嵌入在页面上的小型 Flash 控件来实现。

虽然 JavaScript 的安全跨域请求正在开展工作，但此时，您需要使用 Flash 或 Silverlight 之类的插件作为发出请求的桥梁。

* * *

## 回答 #5

> 赞同：-7
> 
> 时间：2009-01-21T21:14:36.567

您不能使用 javascript 跨域执行任何操作。您必须使用 PHP 或 asp 之类的后端语言。

# asp.net-mvc - Ajax ModalPopupExtender 与 ASP.NET MVC 中的编辑表单

> ID：467013
> 
> 赞同：1
> 
> 时间：2009-01-21T21:10:10.583
> 
> 标签：asp.net-mvc, modalpopupextender

我有一个事件日历，在日历中的每个事件上都有一个编辑链接，它打开 ajax`ModalPopupExtender`来编辑事件信息。我现在面临的问题是编辑必须采用一种形式，以便它可以更新服务器上的信息..

我该如何处理？最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T16:05:52.523

您可以使用 jQuery 来完成相同的功能。我最近不得不为一个项目这样做，因为我不喜欢 ModalPopupExtender 处理它的方式。不幸的是，虽然我没有构建拖动点击和拖动功能。

这是 ASP.NET 和 XHTML 的代码：

在页面的某处，您放置了触发按钮：

```
<input type="button" value="Trigger Action" class="popup-trigger-delete" /> 
```

面板代码：

```
<div class="popup-wrapper popup-wrapper-delete">
  <div class="popup-top"></div>
  <div class="popup-middle">
    <div class="content">Are you sure you want to delete this from your project?</div>
    <div class="controls">
      <asp:Button ID="btnDelete_Yes" runat="server" CssClass="left" OnClick="btnDelete_Yes_OnClick" />
      <input type="button" value="Cancel" class="right popup-background-delete-cancel" />
    </div>
  </div>
  <div class="popup-bottom"></div>
</div>
<div class="popup-background popup-background-delete-track"></div> 
```

Javascript / jQuery

```
var fadeInTime = 400;
var popupStatus = 0;

function loadPopup(wrapper){
    //loads popup only if it is disabled
    if(popupStatus==0){
        $(wrapper).fadeIn(fadeInTime);
        popupStatus = 1;
    }
}

function disablePopup(wrapper, background){
    if(popupStatus==1){
        $(background).fadeOut(fadeInTime);
        $(wrapper).fadeOut(fadeInTime);
        popupStatus = 0;
    }
}

function centerPopup(wrapper, background){
    //request data for centering
    var windowWidth = document.documentElement.clientWidth;
    var windowHeight = document.documentElement.clientHeight;
    var popupHeight = $(wrapper).height();
    var popupWidth = $(wrapper).width();
    //centering
    $(wrapper).css({ 
        "position": "fixed", 
        "top": (windowHeight/2-100)-popupHeight/2, 
        "left": windowWidth/2-popupWidth/2,
        "z-index" : "10000"
    });
    $(background).css({ "height": windowHeight });
}

//event handlers

var trigger = "input.popup-trigger-delete";
var wrapper = "div.popup-wrapper-delete";
var background = "div.popup-background-delete";
var dtpbc = "input.popup-background-delete-cancel";

$(document).ready(function(){
    $(trigger).click(function(){ centerPopup(wrapper,background); loadPopup(wrapper); });
    $(dtpbc).click(function(){ disablePopup(wrapper, background); });
    $(document).keypress(function(e){ if(e.keyCode==27 && popupStatus==1){ disablePopup(wrapper,background); } });
}); 
```

CSS

```
div.popup-background-delete { display:none; }
div.popup-wrapper-delete { display:none; }  

div.popup-wrapper { position:relative; display:none; display:block; width:350px; height:245px; padding:0; margin:0; z-index:5000; }
div.popup-top { position:relative; display:block; background-color:#ffffff;  width:350px; height:40px; padding:0; margin:0; z-index:5000; }
div.popup-middle { position:relative; display:block; background-color:#ffffff;  width:350px; min-height:165px; padding:0; margin:0; z-index:5000; }
div.popup-middle .content { position:relative; display:block; margin:0 auto; padding-top:20px; padding-bottom:10px; width:255px; z-index:5000; }
div.popup-middle .controls .left { position:absolute; top:0; left:80px; z-index:5000; }
div.popup-middle .controls .right { position:absolute; top:0; right:80px; z-index:5000;}
div.popup-bottom { position:relative; display:block; background-color:#ffffff; width:350px; height:40px; padding:0; margin:0; z-index:5000; }
div.popup-background { position:absolute; top:0; left:0; width:100%; height:100%; z-index:5000; background-color:#cbcbcb; opacity:0.2; -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=20)"; filter: alpha(opacity=20); -moz-opacity:0.2; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T14:45:12.977

为了使上述示例正常工作（抱歉，无法评论），请执行以下操作：

*   将 asp 按钮更改为 html 按钮
*   将“弹出背景删除轨道”更改为“弹出背景删除”
*   在 centerPopup 中，替换`$(background).css({ "height": windowHeight });`为`$(background).css({ "display": 'block' });`
*   删除`display:block`CSS 中的所有引用。

# c# - 我可以在加载事件时从 C# 的 div 标记中动态添加 HTML 吗？

> ID：467016
> 
> 赞同：44
> 
> 时间：2009-01-21T21:10:54.060
> 
> 标签：c#, asp.net, .net-3.5, master-pages

请注意，我正在使用母版页，但我可以在页面中找到一个 div 并在其中放入一些 html 吗？谢谢。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-01-21T21:18:49.897

您可以将带有 runat="server" 的 div 添加到页面：

```
<div runat="server" id="myDiv">
</div> 
```

然后从代码隐藏设置其 InnerHtml 属性：

```
myDiv.InnerHtml = "your html here"; 
```

如果你想在客户端修改 DIV 的内容，那么你可以使用类似这样的 javascript 代码：

```
<script type="text/javascript">
    Sys.Application.add_load(MyLoad);
    function MyLoad(sender) {
        $get('<%= div.ClientID %>').innerHTML += " - text added on client";
    }
</script> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-21T21:11:53.590

为此使用`asp:Panel`。它翻译成一个div。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-10T07:12:37.697

记得使用

```
myDiv.InnerHtml = "something"; 
```

将替换 myDIV 中的所有 HTML 元素。您需要附加文本以避免这种情况。因为这可能会有所帮助

```
myDiv.InnerHtml = "something" + myDiv.InnerText; 
```

myDiv 中的任何 html 控件，但不是 ASP html 控件（因为它们尚未呈现）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-21T21:21:30.763

您可以通过以下方式引用母版页内的控件：

```
void Page_Load()
{
    ContentPlaceHolder cph;
    Literal lit;

    cph = (ContentPlaceHolder)Master.FindControl("ContentPlaceHolder1");

    if (cph != null) {
        lit = (Literal) cph.FindControl("Literal1");
        if (lit != null) {
            lit.Text = "Some <b>HTML</b>";
        }
    }

} 
```

在此示例中，您必须在 ContentPlaceholder 中放置一个 Literal 控件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T21:41:22.703

您想将代码放在将 HTML 插入到使用该母版页的页面内容中的母版页代码中吗？

我不会通过 FindControl 搜索控件，因为这是一个脆弱的解决方案，如果控件的名称发生更改，很容易被破坏。

最好的办法是在母版页中声明一个任何子页都可以处理的事件。该事件可以将 HTML 作为 EventArg 传递。

# perl - 我可以自动发现 shell 或 Perl 脚本的参数来为它们“元”编程 WEB UI 吗？

> ID：467026
> 
> 赞同：1
> 
> 时间：2009-01-21T21:12:15.167
> 
> 标签：perl, shell, metaprogramming, scripting, cgi-bin

是否可以自动发现 shell/Perl 脚本的参数以便为它们“元”编程 WEB UI？

* * *

我有一堆“遗留”脚本，我想“web wrap”。到目前为止，我已经创建了一个 CGI-BIN Web 应用程序，其中包含大约 3 个可以调用 bash/Perl 报告脚本的参数。

但现在我想到也许有更快或自动的方法来包装这 100 多个脚本。

所以基本上我想了解元编程技术，在那里我会发现特定的 bash 或 Perl 脚本采用哪些输入参数，然后生成相应的 HTML FORM 元素，这些输入参数作为 TEXT INPUT 或 SELECT 下拉框等。

任何想法或示例链接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T01:39:31.103

没有办法查看随机的 Perl 源代码来确定它需要哪些参数、这些参数的含义或它们是如何受到约束的。

如果您处理的 Perl 脚本都使用公共库来处理参数，例如[GetOpt::Long](http://search.cpan.org/dist/GetOpt-Long)，那么您可以使用脚本传递给参数处理器的信息来获取大部分信息。

除此之外，你运气不好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T22:12:03.720

除了[Catalyst](http://www.catalystframework.org/)之外，CGI 有一种通过 GET 或 POST 发送参数的标准方法，而[CGI.pm 使它变得容易](http://search.cpan.org/dist/CGI.pm/CGI.pm#FETCHING_THE_NAMES_OF_ALL_THE_PARAMETERS_PASSED_TO_YOUR_SCRIPT:)。

* * *

您添加了要求“我想了解元编程技术，我会发现特定 bash 或 perl 脚本采用哪些输入参数，然后生成相应的 HTML FORM 元素，这些输入参数为 TEXT INPUT 或 SELECT drop羽绒盒等”

“发现特定 bash 或 perl 脚本采用哪些输入参数”没有标准方法，因为这些脚本没有标准方法来报告此信息。有接近标准的可能性（解析相应手册页的 troff 源，使用“--help”调用脚本并解析输出），或者您可以将此信息保存在某种数据库中。

有**一种**标准方法可以确定哪些参数被发送到 CGI 脚本，然后将这些参数显示为可设置的表单元素。CGI.pm 会将它们作为散列引入，您可以循环访问（将键显示为文本框的标签，将值显示为相应文本框中的文本）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T14:49:05.733

为了扩展 brian 所说的内容，如果您可以向我们提供一些代码示例，我们也许可以提供更多帮助。如果脚本使用相同（或相似）的方法来解析它们的参数，那么我们就有机会编写一些代码。

您很可能可以为“常规”的遗留脚本部分编写元编程解决方案，并为“不规则”脚本编写基于表的解决方案。

# sql-server - 您可以在 sql server 准备语句中参数化排序顺序吗？

> ID：467034
> 
> 赞同：3
> 
> 时间：2009-01-21T21:13:21.513
> 
> 标签：sql-server, ado.net, prepared-statement

我有一个带有 VB.Net 前端的 .Net Web 系统，它通过 ADO.Net 与 SQL Server 2005 后端通信。本质上，我想做的是：

```
Dim command As SqlCommand = New SqlCommand("", connection)
command.CommandText = "SELECT * FROM someTable ORDER BY orderValue @SortOrder"
Dim sortParam As SqlParameter = New SqlParameter("@SortOrder", SqlDbType.varChar, 3)
sortParam.Value = "ASC"
command.Parameters.Add(sortParam)
command.Prepare()
reader = command.ExecuteReader() 
```

排序顺序将通过查询字符串等传递。此代码抛出“'@SortOrder' 附近的语法不正确。无法准备语句。”

这甚至可能吗，还是我没有看到一些非常愚蠢的语法错误？

（而且，是的，客户端只运行 .net 2.0，所以遗憾的是，基于 LINQ 的解决方案无法工作。

谢谢大家！

更新/回应：

嗯，我就是这么想的。谢谢大家的理智检查。（在某些情况下，命令字符串当前正在动态构建，但我们正在将系统向更准备好的语句方向移动，这是我不知道可能的边缘情况之一。

再次感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T21:17:41.770

不，那行不通。

我可以立即想到两种可能性来做你想做的事情：

1.  动态构建 SQL 字符串
2.  从查询中返回数据表，然后使用视图进行排序。

* * *

凭借另外 6 年左右的经验（加上 SQL Server 版本），我有办法做到这一点。

```
DECLARE @SortByIdASC AS INT;
SET @SortByIdASC = 1;
WITH cte AS (
SELECT Id, Foo, Bar
      , ROW_NUMBER() OVER (ORDER BY Id ASC) AS IdSortAsc
      , ROW_NUMBER() OVER (ORDER BY Id DESC) AS IdSortDesc 
   FROM MyTable
)

SELECT Id, Foo, Bar
   FROM cte 
   ORDER BY CASE WHEN @SortByIdASC = 1 THEN IdSortAsc
                 WHEN @SortByIdASC = 2 THEN IdSortDesc 
                 ELSE ''
                 END 
           , Foo, Bar 
```

这也允许向上、向下排序，甚至从给定的排序顺序中排除该特定列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T21:25:59.757

虽然可以更新排序中使用的列。举个例子：

```
declare @fname int,@lname int

select @fname=1,@lname=0

select * from [user]
order by case when @Fname=1 then firstname when @lname=1 then lastname end 
```

我认为您不能使用这种技术来修改排序顺序，但您至少可以更改排序所在的列。至少当我尝试抱怨 SQL 2005 的语法时

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T21:37:06.177

您可以以与现有帖子类似的方式。

```
declare @firstSortField int, @secondSortField int
set @firstSortField = 1
set @secondSortField = 3

select firstName, lastName, phoneNumber
from customers
order by 
    case @firstSortField when 1 then firstName when 2 then lastName when 3 then phoneNumber else null end, 
    case @secondSortField when 1 then firstName when 2 then lastName when 3 then phoneNumber else null end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T21:14:19.437

我认为这是不可能的，只能准备参数值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T21:15:12.943

不，您每次都需要将其构建到 SQL 查询中，或者如果您有一组排序顺序，则缓存这些命令对象并作为套件重新使用。

不过，这个问题的简短答案是“不”

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T16:43:47.547

这完全符合您的要求，并且永远不会将用户输入的字符串放在数据库附近的任何地方。

```
//从查询字符串中获取请求的订单
字符串 sortOrderRequest = request["SortOrder"].ToUpper();
字符串排序参数 = "";
if (sortOrderRequest.Equals("ASC"))
  sortParam = " order by ordervalue ASC ";
否则 if (sortOrderRequest.Equals("DESC"))
  sortParam = " order by ordervalue DESC ";

暗淡命令 As SqlCommand = New SqlCommand("", connection)
command.CommandText = "SELECT * FROM someTable " + sortParam;
命令.准备（）
reader = command.ExecuteReader()

```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-28T16:50:07.627

当然可以。创建两个别名列，SortASC 和 SortDESC，用您想要的任何内容填充它们，然后对它们进行排序。

```
-- Testcase setup
DECLARE @OrderASC bit
SET @OrderASC = 0

-- Statement required
SELECT
    Users.*,
    CASE @OrderASC WHEN 1 THEN Users.Alias ELSE null END AS _SortASC,
    CASE @OrderASC WHEN 0 THEN Users.Alias ELSE null END AS _SortDESC
FROM Users
ORDER BY _SortASC, _SortDESC DESC 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-14T17:50:51.503

我扩展了接受的答案，以达到在 SQL 查询中参数化 order 子句的有效解决方案。这是一个示例代码：

```
DECLARE @Sorting VARCHAR(200) = 'CreationTime ASC'

SELECT v.*, 
CASE WHEN @Sorting = 'CreationTime ASC' THEN ROW_NUMBER() OVER (ORDER BY v.CreationTime ASC) 
     WHEN @Sorting = 'CreationTime DESC' THEN ROW_NUMBER() OVER (ORDER BY v.CreationTime DESC) 
                                         ELSE ROW_NUMBER() OVER (ORDER BY v.Id ASC) END AS rownum

FROM Vehicles v ORDER BY rownum 
```

# jsp - java CLASS/JSP 文件运行时部署

> ID：467056
> 
> 赞同：0
> 
> 时间：2009-01-21T21:17:32.533
> 
> 标签：jsp, jakarta-ee, ibatis

Oracle 10g 应用服务器，Java 1.5 + JSF（表示层）+ iBatis（数据库通信层）

在我目前工作的地方，有时会增加对部署目录进行小调整的必要性。我不否认这不是最佳做法（如果我在这个网站上停留的时间足够长，也许我最终会成为最糟糕做法的例子——但它也有好的一面：）

因此，我们调整的三个基本内容是：

*   重新编译的 Java 类文件
*   修改过的 JSP
*   修改了 XML 格式的 iBatis 查询“地图”

例如，当报告了一个错误，并且客户急于纠正它时，我们对 java 文件进行更正，重新编译该类，并将生成的 .CLASS 文件复制到旧版本所在的位置部署。同样，我们覆盖修改后的 JSP（我想应用服务器会神奇地理解新 JSP 何时到达，并在必要时重新编译它）。

在上述两种情况下，作为预防措施，我们还重启了Application Server。我从未尝试查看更改是否会在不重新启动的情况下工作 - 如果服务器以某种方式将类/JSP 缓存在内存中，情况就不会如此。所以，这是我的第一个问题 - 类/JSP 文件中的更改是由应用服务器跟踪？也许不需要重启？

在 iBatis XML 的情况下，我们已经看到新的查询是从更新的 XML 中获取的，并且不需要重新启动。尽管如此，有时在取消部署时，我们会看到一些 XML 文件保持锁定状态，这意味着 iBatis 缓存了某些内容（不确定是什么）。

我想知道，从长远来看，这些调整会如何影响系统的稳定性？除了我们这里的其他人会做这样的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T21:22:05.927

我们的生产服务器上有 Apache Tomcat，可以毫无问题地更换 JSP，服务器将读取新页面而无需重新启动。.properties、ibatis .xml、.class 等文件不能以这种方式使用，据我所知，这需要在 Tomcat 上重新启动。

# c++ - 相机输出，在执行功能时，从linux到windows（C++）的转换很慢

> ID：467060
> 
> 赞同：1
> 
> 时间：2009-01-21T21:18:20.693
> 
> 标签：c++, visual-studio, linux, optimization, webcam

我知道这可能是一般性的，请多多包涵！

我们有一个使用网络摄像头的程序，并根据摄像头看到的内容运行某些功能。该程序在 MacOS 和 Linux 上运行良好，它可以编译并且*确实可以*在 Windows 上运行，但是其中一些功能（包括逐像素迭代的功能，640x480）将 FPS 降至 1 或更低。偶尔放下它冻结几秒钟。

就像我说的，我知道这很笼统......我只是（绝望地）希望其他人就可能的解释提供意见？这些相同的功能在其他平台上也能正常工作。我很好奇相机是否可能在它自己的线程中运行，从而陷入困境？也许我们只是没有在正确的地方寻找优化？在将代码移植到 Windows 时，是否有关于优化什么的资源？

**非常感谢，非常**感谢任何输入！

<<< 编辑 >>>

至于视频源代码，我使用的是 ewclib 和

```
const char * m_buffer;

EWC_Open(MEDIASUBTYPE_RGB24, 640, 480, FPS, true);

    m_buffer = new unsigned char[EWC_GetBufferSize(0)];

EWC_GetImage(0, m_buffer); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T21:25:44.093

你用什么在 Windows 上编译程序？视觉工作室？赛格温？你确定你没有编译调试版本吗？你打开编译器优化了吗？您可能还想检查您的数据类型。您可能假设 int 是 64 位，而您可能使用的是 32 位 Windows，它是 32 位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T21:49:09.180

rmeador 的假设是因为*Windows 很慢*是荒谬的：除了抓取图片之外，所有操作都在用户空间中，不需要系统调用。因此，我建议您删除所有识别/功能代码并查看问题是否仍然存在。

如果是这种情况，请检查您的图像抓取机制。也许您每次拍照时都在获取并释放相机的手柄。

否则，请使用普通分析器来查找薄弱环节。如果您怀疑像素操作可能有问题，请确保您在用户空间中执行此操作。我不熟悉 Windows 编程，但我可以想象问题可能是您正在 Windows 资源上进行操作/读取和调用每个像素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T22:45:11.563

您是为每一帧调用 EWC_Open，还是只在开始时调用一次？如果库在 DirectShow 中实现并且 EWC_Open 启动图形，它会很慢。

# asp.net-mvc - MVC 助手扩展

> ID：467064
> 
> 赞同：1
> 
> 时间：2009-01-21T21:20:45.010
> 
> 标签：asp.net-mvc, extension-methods, html-helper

为什么我会收到错误“Expected class, interface, enum or struct”，字符串下划线？

```
 public static string IsSelected(this HtmlHelper helper, string A, string B)

    {
         return "wtf";

    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T21:24:52.003

您的扩展方法需要在静态类中：

```
public static class MyExtensions
{
    public static string IsSelected( this HtmlHelper helper, string A, string B)
    {
        return "wtf";

    }
} 
```

# php - 用于保存搜索结果的数据库结构

> ID：467075
> 
> 赞同：1
> 
> 时间：2009-01-21T21:23:07.017
> 
> 标签：php, mysql, data-structures

我目前在一个社交网站工作。

我的老板最近想到了随机显示搜索结果而不是正常结果（注册日期）的想法。这样做的问题是简单而明显的：如果您从一页转到另一页，每次都会显示不同的结果，因为每次列表都是随机的。

我有将结果存储在数据库 + cookie 中的想法，如下所示：

*   包含 $_POST 请求的序列化版本的 Cookie（如果我们想要重新排序，则需要）
*   将作为搜索 id => 搜索 (id,user `_id, creation`_date)基础的表
*   存储结果及其顺序的表 => 搜索`_results (search_id, order, user`_id)

流程图看起来像这样：

*   每次搜索后，我将“位置”存储到 cookie 或会话中
*   然后我在“搜索”中删除之前的搜索
*   然后我删除“searches_results”中的先前结果
*   然后我在键的“搜索”中插入一行
*   然后我将每个用户行插入“searches_results”
*   最后我将用户重定向到类似 ?search_id=[search_key]

这里有一个很大的缺陷：性能....绝对有可能使系统 OR 关闭或非常慢。

知道什么是最好的结构吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T21:27:07.990

如果不是随机排序，而是通过某个顺序已知且可重复但不明显的函数进行排序，该怎么办？您可以使用来自搜索查询的一些数据来植入这样的函数，以使其重复变得不那么明显。这样，您可以在结果中来回翻页，并始终得到您期望的结果。音乐播放器将这种功能用于他们的随机播放功能（因此，如果您单击返回，您将获得上一首歌曲，如果您再次单击下一首，您将回到开始的位置）。我敢肯定你可以猜到一些函数来完成这个......[按位异或](http://en.wikipedia.org/wiki/Bitwise_operation#XOR)带有一些常量（来自查询）的 ID 值，然后按结果数字排序可能就足够了。我随意选择了 XOR，因为它是一个非常简单的函数，可以为您提供可重复且不明显的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T21:32:53.190

可能会嗡嗡声，但是 xor 运算符不是只说它是否是 OR 独占吗？我的意思是，据我所知，这里没有数学运算。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T21:58:09.053

抱歉，我知道这无济于事，但我不明白为什么你的老板会想要这个？

我知道，如果我在社交网络上搜索一个人，那么我希望结果仅按相关性和相关性排序。我认为随机结果只会让用户感到沮丧，但也许这只是我。

例如，如果我搜索“John Smith”，那么第一批结果最好是名为“John Smith”的人。然后在结果末尾附近显示相似的名称。我不想搜索“John Smith”并将“Jon Smithers”作为我的第二个结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T00:29:36.873

好吧，我和马特一起问“为什么？”

I think rmeador has a good suggestion as well. You could randomly sort by a different field or some sort of algorithm. Just from the permutations of DESC / ASC on last updated or some other result field.

Other option would be to do an initial search the first time and return only related ID's and then store the full ID's string in the database and each subsequent page is then a lookup against those ID's.

My two cents.

I can see a scenario where a randomized result set is useful but not for searching but for browsing profiles or artists or local events. It offers more exposure to those that wouldn't show up in a traditionally directed search.

# .net - 搜索多个标签时按标签选择项目

> ID：467077
> 
> 赞同：0
> 
> 时间：2009-01-21T21:24:05.657
> 
> 标签：.net, linq

我在这里有点挣扎，所以我想为什么不问：

我系统中的每个实体都有一个标签列表（字符串列表），我希望能够一次搜索多个标签。

我有一个 IQueryable 可以使用。每个实体都有一个名为标签的 IList，我的输入参数是一个 IList。

我可以简单地遍历所有标签并执行 IQueryable.Where(p => p.Tags.Contains(currentTag)，但是对于许多标签作为输入，这不会很好地扩展，而且我觉得这可以在内部完成林Q。

希望任何人有一个想法。

编辑：问题的澄清：我寻找一种方法来只从我的 IQueryable 中选择包含所有提供的参数标签（IList）的项目。

问候丹尼尔 / Tigraine

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T05:38:58.233

从[这里开始](https://stackoverflow.com/questions/163887/sql-query-simulating-an-and-over-several-rows-instead-of-sub-querying#163907)，这是一些适合您的 sql：

```
SELECT entityID
FROM tags
WHERE tagID in (...) --taglist
GROUP BY entityID
HAVING COUNT(DISTINCT tagID) = ... --tagcount 
```

现在的诀窍是让 Linq 生成它......这是一些 LinqToSql 代码：

```
public List<int> GetEntityIds(List<int> tagIds)
{
  int tagCount = tagIds.Count;

  CustomDataContext myDC = new CustomDataContext();

  List<int> entityIds = myDC.Tags
    .Where(t => tagIds.Contains(t.TagId))
    .GroupBy(t => t.entityId)
    .Where(g => g.Select(t => t.TagId).Distinct().Count() == tagCount)
    .Select(g => g.Key)

  return entityIds;
} 
```

一些警告适用：

*   List(T).Contains 由 LinqToSql 翻译，但 LinqToEntities 不会翻译。相反，您将获得运行时异常。
*   IList.Contains...没有人翻译它。请改用 List(T)。
*   sql server 有一个参数计数限制。它大约有 2000 个参数（高于，但低于 2500）。如果您需要使用超过 2000 个标签，您应该寻求不同的解决方案。
*   午夜过后，我在没有工具的情况下写了这篇文章。它可能并不完美。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T21:31:39.573

不知道我真的明白你在问什么，但也许像下面这样的东西会起作用。

```
List<string> searchTags = ...

var query = db.MyEntity
              .Where( e => e.Tags.Intersect( searchTags ).Count() > 0 ); 
```

这应该为您提供一组实体，其中标签列表至少包含`searchTags`

# python - python：列表理解策略

> ID：467094
> 
> 赞同：8
> 
> 时间：2009-01-21T21:27:47.863
> 
> 标签：python, list-comprehension

我正在寻找一个字符串并创建一个构建原始字符串的字符串列表。

例如：

```
"asdf" => ["a", "as", "asd", "asdf"] 
```

我敢肯定有一种“pythonic”的方式来做到这一点；我想我只是在失去理智。完成这项工作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-21T21:30:19.780

一种可能：

```
>>> st = 'asdf'
>>> [st[:n+1] for n in range(len(st))]
['a', 'as', 'asd', 'asdf'] 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-21T21:47:34.690

如果您要循环遍历“列表”的元素，最好使用生成器而不是列表理解：

```
>>> text = "I'm a little teapot."
>>> textgen = (text[:i + 1] for i in xrange(len(text)))
>>> textgen
<generator object <genexpr> at 0x0119BDA0>
>>> for item in textgen:
...     if re.search("t$", item):
...         print item
I'm a lit
I'm a litt
I'm a little t
I'm a little teapot
>>> 
```

此代码从不创建列表对象，也从不（增量垃圾收集）创建多个额外的字符串（除了`text`）。

# linux - 让 Expect 交互直到程序终止

> ID：467099
> 
> 赞同：1
> 
> 时间：2009-01-21T21:29:22.790
> 
> 标签：linux, cygwin, tcl, expect

我正在使用 Expect Linux 工具，我必须与 shell 交互。但是，这不是真正的互动，我只是想看看发生了什么。交互程序退出后如何让 Expect 退出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T21:35:13.637

没关系，我找到了。

```
interact $ 
```

会导致expect遇到字符串时退出`$`。

# sql - MS SQL 仅日期没有时间

> ID：467103
> 
> 赞同：45
> 
> 时间：2009-01-21T21:30:50.527
> 
> 标签：sql, sql-server, tsql

## 问题

大家好，

很长一段时间以来，我一直对使用 T-SQL 构建 DateTime SQL 类型感到困惑。本质上，我想将 DateTime 值设为 2008-12-1 14:30:12 并将其设为 2008-12-1 00:00:00。我们为报告运行的许多查询在 WHERE 子句中使用日期值，但我要么有一天的开始和结束日期值并使用 BETWEEN，要么我找到其他方法。

目前我正在使用以下内容： `WHERE CAST(CONVERT(VARCHAR, [tstamp], 102) AS DATETIME) = @dateParam`

但是，这似乎有点笨拙。我希望会有更简单的东西，比如 `CAST([tstamp] AS DATE)`

网上有些地方推荐使用 DATEPART() 函数，但后来我得到了这样的结果：

```
 WHERE DATEPART(year, [tstamp]) = DATEPART(year, @dateParam)
AND DATEPART(month, [tstamp]) = DATEPART(month, @dateParam)
AND DATEPART(day, [tstamp]) = DATEPART(day, @dateParam) 

```

也许我过分关心一些小事，如果是这样，请告诉我。我只是想确保我写的东西尽可能高效。我想消除任何薄弱环节。

有什么建议么？

谢谢，
C

## 解决方案

感谢大家的反馈。很多有用的信息。我将围绕我们的功能进行更改，以消除运算符左侧的功能。尽管我们的大多数日期列不使用索引，但它可能仍然是一种更好的做法。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-01-21T21:38:14.943

如果您使用的是 SQL Server 2008，它现在已内置，请参阅[在线书籍](http://msdn.microsoft.com/en-us/library/bb630352.aspx)

`CAST(GETDATE() AS date)`

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-01-21T21:37:31.747

这对性能非常不利，看看[Only In A Database Can You Get 1000% + Improvement By changed a few lines of code](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/only-in-a-database-can-you-get-1000-impr)

运算符左侧的功能不好

这是你需要做的

```
declare @d datetime
select @d =  '2008-12-1 14:30:12'

where tstamp >= dateadd(dd, datediff(dd, 0, @d)+0, 0)
and tstamp < dateadd(dd, datediff(dd, 0, @d)+1, 0) 
```

运行它以查看它的作用

```
select dateadd(dd, datediff(dd, 0, getdate())+1, 0)
select dateadd(dd, datediff(dd, 0, getdate())+0, 0) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-21T21:47:45.673

其他人发布的 Date 函数是处理此问题的最正确方法。

然而，你提到“地板”这个词很有趣，因为有一个小技巧可以运行得更快一些：

```
CAST(FLOOR(CAST(@dateParam AS float)) AS DateTime) 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-11-09T18:35:18.077

`CONVERT(date, GETDATE())`并`CONVERT(time, GETDATE())`在 SQL Server 2008 中工作。我不确定 2005 年。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-06-06T18:45:27.173

这个怎么样？

```
SELECT DATEADD(dd, DATEDIFF(dd,0,GETDATE()), 0) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-21T21:35:28.537

```
DATEADD(d, 0, DATEDIFF(d, 0, [tstamp])) 
```

编辑：虽然这将删除您的日期时间的时间部分，但它也会使条件[non SARGable](http://en.wikipedia.org/wiki/Sargable)。如果这对这个查询很重要，索引视图或 between 子句更合适。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-21T21:35:34.247

是的，T-SQL 有时会让人觉得非常原始，正是这些事情常常促使我用我选择的语言（例如 C#）来做很多我的逻辑。

但是，当您出于性能原因绝对需要在 SQL 中执行其中一些事情时，最好的选择是创建函数来容纳这些“算法”。

看看这篇文章。他提供了很多方便的 SQL 函数，我认为这些函数会对您有所帮助。

[http://weblogs.sqlteam.com/jeffs/archive/2007/01/02/56079.aspx](http://weblogs.sqlteam.com/jeffs/archive/2007/01/02/56079.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-21T21:53:05.943

在这里要小心，如果你使用任何东西，`WHERE CAST(CONVERT(VARCHAR, [tstamp], 102) AS DATETIME) = @dateParam`它的行将强制对表进行扫描，并且该部分不会使用任何索引。

一种更简洁的方法是定义计算列

```
create table #t (
    d datetime, 

    d2 as 
        cast (datepart(year,d) as varchar(4)) + '-' +
        right('0' + cast (datepart(month,d) as varchar(2)),2) + '-' + 
        right('0' + cast (datepart(day,d) as varchar(2)),2) 
) 
-- notice a lot of care need to be taken to ensure the format is comparable. (zero padding)

insert #t 
values (getdate())

create index idx on #t(d2)

select d2, count(d2) from #t 
where d2 between '2008-01-01' and '2009-01-22'
group by d2
-- index seek is used 
```

这样，您可以直接检查 d2 列，并且将使用索引，而您不必乱搞转换。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-21T21:35:32.793

这是一个查询，它将返回几天范围内的所有结果。

```
DECLARE @startDate DATETIME
DECLARE @endDate DATETIME

SET @startDate = DATEADD(day, -30, GETDATE())
SET @endDate = GETDATE()

SELECT *
FROM table
WHERE dateColumn >= DATEADD(day, DATEDIFF(day, 0, @startDate), 0)
  AND dateColumn <  DATEADD(day, 1, DATEDIFF(day, 0, @endDate)) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-21T21:48:17.107

FWIW，多年来我一直在做和你一样的事情

```
CAST(CONVERT(VARCHAR, [tstamp], 102) AS DATETIME) = @dateParam 
```

在我看来，这是在灵活性、速度和可读性方面节省时间的更好方法之一。（对不起）。建议的某些 UDF 函数可能很有用，但 UDF 对于较大的结果集可能会很慢。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-11-19T15:59:47.997

或者你可以使用

```
declare @d datetimeselect
@d =  '2008-12-1 14:30:12'
where tstamp 
  BETWEEN dateadd(dd, datediff(dd, 0, @d)+0, 0) 
  AND dateadd(dd, datediff(dd, 0, @d)+1, 0) 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-21T21:39:13.910

```
WHERE DATEDIFF(day, tstamp, @dateParam) = 0 
```

如果您不关心时间，这应该可以让您到达那里。

这是为了回答当您不关心时间时比较两个值的日期的元问题。

# perl - 我的第一个 perl 脚本：在循环中使用“get($url)”方法？

> ID：467104
> 
> 赞同：2
> 
> 时间：2009-01-21T21:30:59.293
> 
> 标签：perl, geturl

所以这似乎很容易。使用一系列嵌套循环浏览大量按年/月/日排序的 URL 并下载 XML 文件。因为这是我的第一个脚本，所以我从循环开始；任何语言都熟悉的东西。我运行它只是打印构造的 URL，它运行良好。然后我编写了代码来下载内容并单独保存，并且在多个测试用例上使用示例 URL 也能完美运行。但是当我把这两段代码结合起来时，它就坏了，程序卡住了，什么也没做。因此，我运行了调试器，当我单步调试它时，它卡在了这一行：

> 警告::register::import(/usr/share/perl/5.10/warnings/register.pm:25):25:vec($warnings::Bits{$k}, $warnings::LAST_BIT, 1) = 0 ;

如果我只是按 r 从子例程返回，它会工作并继续返回调用堆栈的另一点，在那里类似的事情一遍又一遍地发生一段时间。堆栈跟踪：

> $ = warnings::register::import('warnings::register') 从文件 `/usr/lib/perl/5.10/Socket.pm' 第 7 行调用
> 
> $ = Socket::BEGIN() 从文件 `/usr/lib/perl/5.10/Socket.pm' 第 7 行调用
> 
> $ = eval {...} 从文件 `/usr/lib/perl/5.10/Socket.pm' 第 7 行调用
> 
> $ = 需要从文件 `/usr/lib/perl/5.10/IO/Socket.pm' 第 12 行调用的 'Socket.pm'
> 
> $ = IO::Socket::BEGIN() 从文件 `/usr/lib/perl/5.10/Socket.pm' 第 7 行调用
> 
> $ = eval {...} 从文件 `/usr/lib/perl/5.10/Socket.pm' 第 7 行调用
> 
> $ = 需要从文件“/usr/share/perl5/LWP/Simple.pm”第 158 行调用的“IO/Socket.pm”
> 
> $ = LWP::Simple::_trivial_http_get('www.aDatabase.com', 80, '/sittings/1987/oct/20.xml') 从文件 `/usr/share/perl5/LWP/Simple.pm' 调用第 136 行
> 
> $ = LWP::Simple::_get(' [http://www.aDatabase.com/1987/oct/20.xml](http://www.aDatabase.com/1987/oct/20.xml) ') 从文件 `xmlfetch.pl' 第 28 行调用

如您所见，它卡在了这个“get($url)”方法中，我不知道为什么？这是我的代码：

```
#!/usr/bin/perl

use LWP::Simple;

$urlBase = 'http://www.aDatabase.com/subheading/';
$day=1;
$month=1;
@months=("list of months","jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec");
$year=1987;
$nullXML = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<nil-classes type=\"array\"/>\n";

while($year<=2006)
    {
    $month=1;
    while($month<=12)
        {
        $day=1;
        while($day<=31)
            {
            $newUrl = "$urlBase$year/$months[$month]/$day.xml";
            $content = get($newUrl);
            if($content ne $nullXML)
                {
                $filename = "$year-$month-$day.xml";
                open(FILE, ">$filename");
                print FILE $content;
                close(FILE);
                }
            $day++;
            }
        $month++;
        }
    $year++;
    } 
```

我几乎肯定这是我不知道的微小的东西，但谷歌没有发现任何东西。

提前致谢，

B.

**编辑：**这是官方的，它只是在这个 get 方法中永远挂起，运行几个循环然后再次挂起一段时间。但它仍然是一个问题。为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T22:08:39.357

由于[http://www.adatabase.com/1987/oct/20.xml](http://www.adatabase.com/1987/oct/20.xml)是 404 （并且无论如何都不是可以从您的程序生成的东西（路径中没有“副标题”），我假设不是您使用的真实链接，这使我们难以测试。作为一般规则，请使用 example.com 而不是编造主机名，这就是保留它的原因。

你真的应该

```
use strict;
use warnings; 
```

在您的代码中 - 这将有助于突出您可能遇到的任何范围界定问题（如果是这种情况，我会感到惊讶，但有可能 LWP 代码的一部分与您的 $urlBase 或其他东西混淆了）。我认为更改初始变量声明（以及 $newUrl、$content 和 $filename）以将“my”放在前面以使您的代码严格就足够了。

如果使用 strict 和 warnings 不能让您更接近解决方案，您可以警告您将要使用每个循环的链接，以便当它粘住时，您可以在浏览器中尝试并查看会发生什么，或者使用数据包嗅探器（例如[Wireshark](http://www.wireshark.org/)）可以为您提供一些线索。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T22:45:06.790

[`(2006 - 1986) * 12 * 31`](http://www.google.com/search?hl=en&q=(2006-1986)*12*31)超过 7000。请求网页没有暂停是不好的。

稍微更像 Perl 的版本（代码风格明智）：

```
#!/usr/bin/perl
use strict;
use warnings;

use LWP::Simple qw(get);    

my $urlBase = 'http://www.example.com/subheading/';
my @months  = qw/jan feb mar apr may jun jul aug sep oct nov dec/;
my $nullXML = <<'NULLXML';
<?xml version="1.0" encoding="UTF-8"?>
<nil-classes type="array"/>
NULLXML

for my $year (1987..2006) {
    for my $month (0..$#months) {
        for my $day (1..31) {
            my $newUrl = "$urlBase$year/$months[$month]/$day.xml";
            my $content = "abc"; #XXX get($newUrl);
            if ($content ne $nullXML) {
               my $filename = "$year-@{[$month+1]}-$day.xml";
               open my $fh, ">$filename" 
                   or die "Can't open '$filename': $!";
               print $fh $content;
               # $fh implicitly closed
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T01:35:10.767

LWP 有一个`getstore`功能，可以为您完成大部分获取然后保存工作。您还可以查看[LWP::Parallel::UserAgent](http://search.cpan.org/dist/ParallelUserAgent)并更好地控制您访问远程站点的方式。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-21T21:45:34.913

我还没有使用 Perl，但乍一看我想知道是否由于 404 错误而引发了异常。我想如果 HTTP 响应是 404、403、重定向等，该函数只会返回 undef，但也许情况并非如此。

我可能会建议为此使用 wget。我认为像`wget $url`这样的东西会起作用。

无论如何，正如我所说，我不是 Prl 程序员，但由于您发布的链接实际上是 404，这是我的猜测。

如果您发现这是问题，请告诉我。

# r - R是编译语言吗？

> ID：467110
> 
> 赞同：8
> 
> 时间：2009-01-21T21:33:13.563
> 
> 标签：r, language-features

我在网络上的任何地方都找不到它（我不想安装它）。[R语言](http://en.wikipedia.org/wiki/R_(programming_language))是编译语言吗？它运行预先编写的脚本的速度有多快？它是否进行任何类型的编译，或者只是逐行执行指令？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-21T21:38:10.120

在大多数情况下，R 是一种在读取-评估-打印循环中运行的解释性语言。R 有许多扩展，它们是用 C 和 Fortran 等其他语言编写的，在这些语言中，速度或与本机库的接口很有帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-21T23:54:03.093

我经常用 C++ 重写 R 代码，让它运行速度提高 100 倍。循环在 R 中尤其低效。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-15T14:21:45.900

R 通常是一种解释型语言。但是，包`compiler`提供可以提高性能的字节码编译。你也可以从 R 中调用编译后的代码。

就多快而言，这取决于您要做什么以及您要如何去做。一些循环操作可能非常慢。然而，在许多情况下，如果代码编写良好，R 脚本的性能取决于底层内部基于 C 的库的速度和系统内存读写速度，因此 R 与其他任何东西一样快。

# http - 如何在 RESTful Web 应用程序中执行“不太流行”的 HTTP 操作？

> ID：467112
> 
> 赞同：4
> 
> 时间：2009-01-21T21:34:29.520
> 
> 标签：http, rest

我正在开发一个 Python Web 应用程序作为学习练习，并且我正在考虑使我的应用程序 RESTful。

为此，我希望能够处理适用的各种类型的 HTTP 操作/动词。例如，如果 ID 为 12 的小部件由 URI [http://domain/widget/12](http://domain/widget/12)表示，并且我想让最终用户能够删除此小部件，他们应该能够针对 / 发出 HTTP DELETE 请求小部件/12.

但是，据我所知，HTML 表单仅支持 GET 和 POST，那么我将如何使用“不太流行”的 HTTP 操作（例如 DELETE）发出 HTTP 请求？

假设在小部件 12 的视图页面（由 HTTP GET 返回）上，我想包含一个只有一个提交按钮的表单来删除该小部件。例如：

```
<form action="/widget/12" method="DELETE">
<input type="submit" value="Delete Me!" />
</form> 
```

但是，已经确定 HTML 表单不支持方法属性的 DELETE。那么在这种情况下，从客户端执行 DELETE 请求的 RESTful 方式是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-21T21:41:46.370

在浏览器中，您将需要对所描述的场景使用 XmlHttpRequest (Ajax)。如果您的客户端或服务器不支持其他方法，则通常使用自定义 X-HTTP-Method-Override 标头来指定操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T23:12:48.683

您可以通过 POST 隧道命令，或使用 Ajax，或两者兼而有之 - （当未找到 javascript 支持时，后隧道充当后备）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T02:18:22.037

Stephen Walther 今天就这个话题发表了一篇很棒的博文。

[http://stephenwalther.com/blog/archive/2009/01/21/asp.net-mvc-tip-46-ndash-donrsquot-use-delete-links-because.aspx](http://stephenwalther.com/blog/archive/2009/01/21/asp.net-mvc-tip-46-ndash-donrsquot-use-delete-links-because.aspx)

根据您希望遵守“RESTful”概念的严格程度，使用 POST 执行删除不会吸引您。

# model-view-controller - 胖模型、瘦控制器和 MVC 设计模式

> ID：467113
> 
> 赞同：75
> 
> 时间：2009-01-21T21:34:54.200
> 
> 标签：model-view-controller, cakephp, model, controller

我刚刚阅读了[一篇博客文章](http://teknoid.wordpress.com/2009/01/06/another-way-to-think-about-mvc/)，该文章用银行类比解释了 MVC。我有几个月的使用 MVC 框架（CakePHP）开发 Web 应用程序的经验，所以我掌握了基础知识，但我开始看到一个主题，让我认为我在放置逻辑的地方采用了一种有缺陷的方法：

*   胖模型，瘦控制器
*   在模型中保留尽可能多的业务逻辑

在我的应用程序中，模型患有厌食症，而控制器则肥胖。我在控制器中有所有业务逻辑，除了模型中的关联和验证规则之外什么都没有。

扫描我的控制器，我现在可以识别出很多应该包含在模型中的逻辑：

*   该应用程序具有包含项目的列表，并且可以对项目进行排名。将列表按排名顺序排列的排序逻辑位于控制器中。
*   同样，物品（Item model）也有图像（Image model）。每个项目可能有一个默认图像（由项目表中的 image_id 指定）。当一个项目与它的图像一起显示时，默认图像应该首先出现。我有在控制器中执行此操作的逻辑。
*   显示列表时，侧栏中会显示相关列表。确定哪些列表相关的逻辑在控制器中。

现在我的问题：

1.  通过上面给出的示例，我认为这些是当前属于模型的控制器中的逻辑实例，我是否走在正确的轨道上？
2.  Web 应用程序共有的其他一些逻辑领域应该纳入模型中吗？
3.  我确信发现这个问题并改变我的设计模式是成功的一半，但即使我决定采用上面给出的那些例子并尝试将这种逻辑转移到模型中，我也不知道从哪里开始。任何人都可以通过在此处发布一些代码或链接到一些好的学习资源来为我指明正确的方向吗？CakePHP 的特定帮助会很棒，但我确信任何 MVC 都足够了。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-21T23:03:18.313

给你“正确”的答案有点困难，因为其中一些涉及框架的细节（不管你正在使用的那些）。

至少在 CakePHP 方面：

1.  是的

2.  任何处理数据或数据操作的东西都应该在模型中。就 CakePHP 而言，一个简单的 find() 方法怎么样？...如果它有可能做一些“特殊”的事情（即回忆一组特定的“条件”），你可能在其他地方需要它，这是一个很好的借口来包装模型的方法。

3.  不幸的是，从来没有一个简单的答案，代码的重构是一个自然的过程。有时你只是醒了过来：“神圣的通心粉......应该在模型中！” （好吧，也许你不这样做，但我有:)）

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-21T22:33:17.123

我至少使用这两个“测试”来检查我的逻辑是否在正确的位置：

1）如果我编写一个单元测试，很容易只创建一个“真实”对象来进行测试（=您在生产中使用的对象）并且不包括很多其他对象，除了一些值对象。需要实际模型对象和实际控制器对象来进行测试可能是您需要移动功能的信号。

2）问自己一个问题：如果我添加了另一种使用这些类的方式，我是否需要以几乎复制粘贴的方式复制功能？...这也可能是移动该功能的一个很好的理由。

也很有趣： http: [//www.martinfowler.com/bliki/AnemicDomainModel.html](http://www.martinfowler.com/bliki/AnemicDomainModel.html)

# security - 如何在 GUI 应用程序中实现安全性？

> ID：467117
> 
> 赞同：2
> 
> 时间：2009-01-21T21:35:32.437
> 
> 标签：security

我正在编写一个具有用户登录功能的 GUI 应用程序。每个用户将属于（至少一个，可能不止一个）组，并且每个组将具有指示是否允许某些权限的属性。权限列表将涵盖诸如编辑过去的内容、打印、删除数据等。许多不同的操作可以由同一个权限处理（例如，可以从菜单和工具栏启动打印）。

我的问题是：实施这个安全系统的最佳方式是什么？每个动作都应该有一个布尔 isSecurable 属性和所需的权限列表吗？应该如何通过中央结构进行检查，或者每个动作应该检查所需的权利本身？

我的目标是这里的正确性。我知道我可以快速构建一个工作系统，但我想要一些不会在未来造成问题的东西。对于冗长的解释，我很抱歉，但我什至不知道该怎么称呼我正在寻找的东西。

编辑：我认为这并不是真正特定于 GUI 的，但我已经研究了很多关于这方面的信息，我发现的大部分内容都是针对 Web 应用程序或一般的“安全编程”技巧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T21:59:30.203

“BCS”是正确的，安全检查不应与 GUI 相关联，而应与您正在调用的底层操作/操作/方法相关联。在 MVC 框架中，这将在模型中，或者在其他地方，在模型调用的操作中。

如果您的操作的调度肯定会通过某种通用机制（例如，所有操作都共享某个基类），那么将安全检查放在那里是覆盖所有基类的好方法。

另一个想法：您所描述的组可能是也可能不是安全术语中的“角色”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T21:49:59.847

我会使用类似 MVC 系统的东西，并且不会在 GUI 代码中添加任何安全性内容。使其成为模型的一部分，这样它就不会影响用户如何触发操作，运行相同的安全代码路径。

我从来没有做过太多的 GUI 甚至更少的安全工作，但一种方法是拥有一个安全的代理对象来跟踪谁登录并只转发当前上下文中允许的请求。

如果您想要一个有趣的项目，该代理对象将是生成代码的理想候选者：

> 给定一个带有安全注释的接口，生成一个实现该接口的类，并根据传递给它的安全上下文阻止/转发调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T21:57:47.243

如果您将编写一个 .NET 应用程序，您可以考虑使用成员资格提供程序基础结构。您甚至可以使用此方法为 Web 和桌面客户端实现身份验证，如[MSDN 杂志文章中所述](http://msdn.microsoft.com/en-us/magazine/cc163807.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T22:01:27.827

你的问题听起来像状态模式。用户所属的每个组都是不同的状态对象。将每个适用的状态对象附加到用户。然后，当用户尝试做一些需要权限的事情时，询问状态对象。

由于一个用户可以在多个组中，您也可以从装饰器模式中受益。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-30T14:30:36.750

我知道这是一篇旧帖子，但想提供我的解决方案。这可能不是最好的方法，但它对我有用，并且可能对某人有用。

我有一个用 Delphi 7 编写的数据库应用程序（Windows GUI 和 MySQL）。

应用程序的管理员可以创建具有不同访问级别的用户。该应用程序管理工厂生产（原材料）、产品、销售和服务，以及为一家在 3 个国家/地区设有工厂和办事处的公司会计。

用户可以根据他们的安全权限访问选项卡、表格和功能。

基本上，某些功能根据权限被禁用或隐藏。在某些情况下，我会向用户显示一条消息，而在其他情况下，如果他们的权限不够，他们的行为就会被忽略。每个用户可以拥有单一或组合的权利。

例如，有人可能有；

*   *“只读销售和服务”*和*“读/写生产”*，
*   *“读/写销售与服务”*，
*   或者，任何或所有可用权利的任何组合。

**它是这样工作的；**

```
unit bitwise; // Found this unit on stackoverflow - All credit to original author

    interface

    Const // Added constants that suit me

      Adm = 01; // Administrator
      Rws = 02; // Read Write Sales
      Ros = 04; // Read Only Sale
      Rwp = 08; // Read Write Production
      Rop = 16; // Read Only Production 
      roa = 32; // Read Only All
      acc = 64; // Accounting

    function IsBitSet(const val: byte; const TheBit: Byte): Boolean;
    function BitOn(const val: byte; const TheBit: Byte): byte;
    function BitOff(const val: byte; const TheBit: Byte): byte;
    function BitToggle(const val: byte; const TheBit: Byte): byte;

    implementation

    function IsBitSet(const val: byte; const TheBit: Byte): Boolean;
    begin
      Result := (val and (TheBit)) <> 0;
    end;

    function BitOn(const val: byte; const TheBit: Byte): byte;
    begin
      Result := val or (TheBit);
    end;

    function BitOff(const val: byte; const TheBit: Byte): byte;
    begin
      Result := val and not (TheBit);
    end;

    function BitToggle(const val: byte; const TheBit: Byte): byte;
    begin
      Result := val xor (TheBit);
    end;

      end.  // End of Unit 
```

**如果我想在用户尝试他们无权访问的内容时显示一条消息，我使用以下函数。**

```
Function TForm1.HasRights(Need: Byte; Msg: String;): Boolean;
Begin

  If Not IsBitSet(rights, Need) Then
  Begin
    showdialog('Security', 'You have insufficient Security Rights!', 'You must have ' +
      Msg + ' access to perform the action you have attempted.', '', '', false, False, True);
    Result := False;
  End
  Else
    Result := True;

End; 
```

**我这样调用上面的函数；**

```
If HasRights(Rop Or Rwp Or Adm, '"Read Only Production" or "Read / Write Production"') Then
Begin

  // Do something they are allowed to do

End // else ignore them 
```

**如果我不需要显示消息框，我会像这样调用 IsBitSet；**

```
If IsBitSet(rights, Adm) Then
    Begin
      // Do stuff
    end; 
```

为了**清楚起见**，这里是**ShowDialog 函数。**它显示了一个我创建的自定义表单，它非常适合我的应用程序。

```
Function TForm1.showdialog(Const DialogTitle: WideString; Const FirstCaption: WideString;
  Const SecondCaption: widestring; Const ConfirmBCaption: widestring; Const CancelBCaption:
  widestring; LeftButton, RightButton, MiddleButton: Boolean): boolean;
Var
  whattheysaid: boolean;
  craigsdialog: Tcraigsdialog;
Begin

  // Modal1Button and Modal2Button can have modified captions whereas Modal3Button
  // is always "Ok". If the only button a user needs is "Ok" then make it visible
  // and receive a modalresult of 3 when clicked. This 3rd button is for appearance
  // only and just makes it a bit neater.

  Whattheysaid := False;
  Craigsdialog := Tcraigsdialog.Create(nil);
  With Craigsdialog Do
  Begin

  // Set the Dialog details as required

    Caption := DialogTitle;
    Label1.Caption := FirstCaption;
    Label2.Caption := SecondCaption;

    Modal1Button.Visible := leftbutton;
    Modal2Button.Visible := rightbutton;
    Modal3Button.Visible := Middlebutton;

    modal1button.Caption := ConfirmBCaption;
    modal2button.Caption := CancelBCaption;

    Case ShowModal Of
      1: whattheysaid := True
      2: whattheysaid := False
      3: whattheysaid := True
    End;
  End;
  FreeAndNil(craigsdialog);
  Result := whattheysaid;
End; 
```

正如我在开始时所说，这可能有用也可能没有用，但它对我来说非常有用。

# database-design - 企业搜索：有人在 FAST ESP 上开发过吗？你觉得呢？

> ID：467121
> 
> 赞同：5
> 
> 时间：2009-01-21T21:35:54.290
> 
> 标签：database-design, search, enterprise, feedback, fast-esp

我为斯堪的纳维亚黄页工作。该公司正在考虑将其定制搜索技术转移到 FAST ESP。

像所有安装相对较少的大型昂贵系统一样，很难获得有关系统优势和劣势的反馈。

有没有 FAST ESP 经验的 stackoverflowers 想要分享？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-10T04:02:42.713

:) 我是一名搜索架构师，从 1997 年作为 Lycos 软件工程师开始就一直在开发和集成搜索引擎技术。

我们使用 FAST ESP 作为支持[http://thomasnet.com](http://thomasnet.com)的搜索引擎。自 2003 年以来，我一直在使用 ESP（当时称为 FDS 3.2）。

FAST ESP 非常灵活，可以处理多种文档类型（html、pdf、word 等）的索引。它有一个非常强大的 Web 文档爬虫，您可以使用它们的中间 FastXML 格式将自定义文档格式加载到系统中或使用它们的 Content API。

该引擎中我最喜欢的部分之一是它的文档处理管道，它允许您使用数十个开箱即用的处理插件以及使用 Python API 来编写您自己的自定义文档处理阶段。我们编写的自定义阶段的一个示例是查看网站 URL 并尝试识别它属于哪个公司，以便可以将其他元数据附加到 Web 文档。

它有一个非常强大的编程/集成 SDK，支持多种流行语言（C++/C#/Java），用于添加内容和执行查询以及获取系统状态和管理集群服务。

ESP 有一种称为 FAST Query Language (FQL) 的查询语言，它非常健壮，允许您进行基本的布尔搜索（AND、OR、NOT）以及短语和术语邻近搜索。除此之外，它还有一种称为“范围搜索”的功能，可用于搜索文档元数据 (XML)，其格式因文档而异。

在性能方面，它的扩展相当线性。如果你对它进行基准测试以确定它在一台机器上的性能，如果你添加另一台机器，它通常可以使性能翻倍。您可以在一台机器（仅推荐用于开发）或多台机器（用于生产）上运行系统。它是容错的（如果您的负载平衡索引之一脱机，它仍然可以提供一些结果）并且它具有完整的故障转移支持（一台或多台关键机器可能会死机或脱机以进行维护，系统将继续运行正常运行）

所以，它非常强大。现在的文档非常好。所以，你问，有什么缺点？

好吧，如果您需要使其可搜索的数据具有经常更改的格式，那可能会很痛苦。ESP 有一个叫做“索引配置文件”的东西，它基本上是一个配置文件，它用来确定哪些文档字段是重要的并且应该用于索引。馈入 ESP 的所有内容都是“文档”，即使您将数据库表行加载到其中。每个文档都有几个字段，典型字段是：标题、正文、关键字、标题、文档向量、处理时间等。您可以根据需要指定任意数量的自定义字段。

如果您的内容基本上保持相同的格式（如 Web 文档），那不是什么大问题。但是，如果您必须对应该索引哪些字段以及应该如何处理它们进行重大更改，您可能需要编辑索引配置文件。对索引配置文件的一些更改是“热更新”，这意味着您可以进行更改而不会中断服务。但是，一些较大的更改是“冷更新”，它需要在更改生效之前重新提供完整的数据和索引。根据数据集的大小和集群中的机器数量，此操作可能需要数小时或数天。冷更新很难安排，除非您有足够的现金购买额外的硬件，而您的生产系统正在执行冷更新并重新加载数据。

对于您的情况，我怀疑您的数据格式会经常更改。如果您需要对其进行细微调整，您可以将额外的元数据添加到范围字段，以回避进行任何完整数据重新加载的需要。

您可能会遇到的大部分麻烦是使用该产品的初始学习曲线。一旦你得到一个开发集群（或节点）做你想做的事，并且如果不需要经常对索引字段配置进行重大更改，它是一个非常稳定和可靠的搜索引擎。对于您的应用程序来说，这听起来很合适，对于较小的公司或初创公司来说，有一些开源选项，如果您不需要那么多的性能或耐用性，那么这些选项并不那么昂贵。

我希望你觉得这个评估有帮助。:)

此致 Michael McIntosh 高级搜索架构师@TnR Global

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-09-07T10:09:00.430

2008-2009 年间，我在俄罗斯黄页 (yell.ru) 担任“搜索引擎工程师”的工作。我的主要职责是使用 FAST ESP 系统。我为我们的特定数据处理编写和维护自定义文档处理器（自定义阶段），用于数据推送管道的一些“胶水”代码。关于 FAST ESP。我对此有一种“混合”的感觉。这里有一些缺点。

1.  这是一种昂贵的产品。除了一次性初始付款外，您还必须支付年度（和值得注意的）许可费，否则您的服务器将停止工作。我们的错误是获取（相对）低成本许可证，该许可证具有非常有限的“每秒最大请求”速率（最大每秒查询 10 个）。虽然我们多次被告知这只是“业务限制”，但实际上这是服务器峰值吞吐量的硬技术限制。我们的性能被这个峰值限制破坏了，我们切换回临时“评估”许可证（令人惊讶！）没有任何性能限制（只是一个时间段限制）。

2.  文档很好，但技术细节不是很深入。仅仅通过阅读文档是不可能做一些真正棘手的事情的。细节不在这里。一旦我们被告知我们需要联系他们的“解决方案部门”（并购买“解决方案”），因为这并不意味着由客户完成。

3.  有些部分出奇地棘手和错​​误。一些例子：将自定义词典放在非英语符号的几个问题中。如果我们加载一堆具有自定义提升值的短语，有时系统会变得缓慢且不负责任。

4.  到处都有一些奇怪的技术限制。例如 - 我们只能为可搜索字段分配 8 个不同的提升值。

总的来说，我们很难满足用户的需求，将 FAST ESP 作为我们网站的基础搜索引擎。最后，系统被另一个（开源）解决方案取代，我被解雇了 ;-) 故事结束。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-08T11:15:21.163

@Michael McIntosh：为避免冷更新，您可以将通用字段添加到索引中。例如，您添加 5 个通用整数、5 个字符串和 5 个日期。当您需要突然引入一个新整数时，您可以使用已有的“填充”，例如 igeneric1。

一段时间后，您可能想要进行冷更新，然后合并这些字段并为其命名等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T19:33:24.307

FAST ESP 技术是可靠的，但您需要记住，它实际上是一个搜索平台（因此是“ESP”），而不是开箱即用的搜索体验。结果的质量与索引的质量直接相关，这意味着您确实需要针对您的内容调整文档处理管道和索引配置文件。

对此没有硬性规定；你真的需要了解平台和你的内容。这确实需要时间和大量的反复试验。此外，它资源匮乏，因此您不能吝啬硬件。如果你有时间和资源把它做好，它会很好用，但半途而废不会比开箱即用的东西甚至 Lucene 更好（甚至可能更糟）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-21T08:17:15.643

只是评论一个关于 filetraverser 没有接受 ACL 更改的先前答案（我没有足够的声誉直接回复答案）：

您可以通过启用 aclplugin 让文件遍历器获取文件权限更改

```
filetraverser -c <collection> -r <dir> -M -E -J $FASTSEARCH/etc/filetraverser/aclplugin.xml 
```

我们发现的唯一烦人的事情是你一次只能使用一个插件，所以你不能同时使用原生的 acl 和lazy 插件。我们通过创建自定义插件解决了这个问题，尽管它只是调用了它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-24T03:32:03.820

我已经支持 FAST ESP 好几年了。总体4/5。

迄今为止，我的经验是 FAST ESP 平台坚如磐石，但各种连接器都有一些怪癖。

Lotus Notes 连接器特别差，当索引超过 100,000 个文档时会定期中断。

其他怪癖可能相当大，例如文件遍历器在文件的 NTFS 权限更新时不反映文档更新。这意味着每个人都可以看到他们不应该看到的文档——糟糕的安全问题。

我在这里附和其他人的观点，FAST ESP 非常好，但它肯定不是一个“开箱即用”的解决方案。预计将花费 3 到 12 个月的时间来实施——但您将获得一个非常强大的引擎。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-04-01T13:02:56.887

我们已经实施了大量的 FAST ESP 应用程序，并且在所有情况下 ESP 都被证明是一个非常稳定的高性能平台，只要您预先投入相对较高的实施成本。关于黄页问题 - 我们使用 ESP 实施和管理美国最大的在线目录站点，它处理巨大的 QPS（每秒查询数）。正如其他人所提到的，关键的替代技术——例如谷歌、Solr/Lucene 也非常有能力，您的选择实际上取决于技术/用户要求和预算。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-10-31T03:18:44.343

I worked in projects for GE Search group for about 4 years, they use FAST ESP and I found that it is very flexible, powerful and multilingual document handling. It allowed me to search into documents with at least 20 different language inside included Japanese, Chinese and Korean with Latino languages and Greek. Also I was able to index documents from Databases, Crawlers (XML based), PDF, Office, etc. all mixed in a single search using different collection of data mixed by search engine. Also allowed me to crate different pipelines to approach different content ingestion.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-05T23:58:34.127

我正在为一些公司 Intranet 站点（大公司）实施 FAST ESP。我在搜索技术方面做了一些工作（90 年代后期的 Verity）。

幸运的是，在我们真正开始之前，我参加了 FAST ESP 开发人员课程。这些课程真的很简单，如果你学得很快，你可能只做在线课程。这些对我来说最大的好处是在项目开始之前就提前了解了 API。在快速浏览并使用 API 进行了一些编程实验室之后，我意识到我需要编写相当多的代码。

我对 API 很失望。不到一年前，MS 刚刚购买了 FAST ESP，因此希望他们能在清理 .NET API 方面获得一些帮助。.NET API 就像有人单击一个按钮并制作了一个 COM 包装器来与本机 Java servlet 交互一样。API 命名约定和方法很容易让您熟悉（只要您记住所有 FAST ESP 集合/数组都是从 1 开始的，而不是从 0 开始的）。但是，我相信他们可以在这里做很多工作。Java API 看起来很像我见过和使用过的所有其他 Java API。命名约定和结构看起来像标准的 Java API，可能是因为 FAST ESP 是一个基于 Java 的搜索引擎，其开发人员是 Java 软件工程师，而不是 .NET 软件工程师。

起初，由于我使用的是 ASP.NET，因此我开发了一组模仿 MS SharePoint Web 控件功能的 Web 控件。在课堂和所有 ASP.NET 示例中，所有内容都是内联 ASP.NET 编码，没有或很少有“代码隐藏”编码。雅虎！Developer Network 有一些很好的设计模式用于设计搜索界面、结果、寻呼机等。

总的来说，到目前为止，它运作良好。我们仍处于开发阶段，将在接下来的几周内开始对我们的网站进行 beta 测试。FQL（快速查询语言）有点过于复杂——我们的用户可能会抱怨这种语言对他们来说不够“类似于谷歌”。如果您搜索一些 FQL pdf 文件，您将能够预览该语言。您也可以只使用简单的搜索（所有术语、任何术语等）。

如果您想知道任何具体的信息，请询问，我会尽力获取信息。我们在 VM 环境中使用 FAST ESP - 他们说不支持，但它工作正常并且基准测试结果对我们来说还可以。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-30T22:50:12.527

FAST ESP 很好。至少与 Google Search Appliance 相比。但是，选择哪个企业搜索引擎完全取决于要求。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-02T20:53:25.217

@anand，您可以使用 FAST ESP .NET API。安装中有 PDF 文档、示例代码和 API 参考资料。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-09-21T15:13:12.183

关于编写高级文档处理插件的任何材料？例如，从内容中提取自定义信息？我听说它是​​用 Python 完成的，但似乎没有材料可以学习如何实际做到这一点。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-07-08T11:10:57.630

@anand：您可以在 .NET Content API 之间进行选择，也可以通过 HTTP/XML 进行所有操作，并根据需要设置 XML 样式。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-06-03T22:35:06.140

除了 FAST ESP，您只有两个其他可能的选择，Autonomy 的 IDOL 平台 (AFAIK) 和 Apache Solr。

# c# - 这是对 Singleton 的合法使用吗？

> ID：467122
> 
> 赞同：0
> 
> 时间：2009-01-21T21:35:59.067
> 
> 标签：c#, singleton

（**免责声明：**这个问题**不是**特定于 ASP.NET）

我有一个可以模板化的控件，类似于登录控件：

```
public abstract class TemplatedControl : CompositeControl
{
    public ITemplate Template { get; set; }

    protected override void CreateChildControls()
    {
        var template = this.Template ?? CreateDefaultTemplate();

        // ...
    }

    protected virtual ITemplate CreateDefaultTemplate()
    {
        return null;
    }
} 
```

模板化控件如下所示：

```
public class FooControl : TemplatedControl
{
    public override ITemplate CreateDefaultTemplate()
    {
        return new FooTemplate();
    }
} 
```

我的问题是：单身人士在这里是否合适？

```
public override ITemplate CreateDefaultTemplate()
{
    return FooTemplate.Instance;
} 
```

单例与全局变量相关联；在这种情况下，没有状态。

单例也与硬编码的依赖关系相关联。在这种情况下，需要了解特定类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T21:44:28.580

在这种情况下，我会说不是。在您提出的模式中，只有一个 FooTemplate，它将在多个控件、页面和线程之间共享。您必须非常小心，模板不包含任何请求或用户特定信息，并且还要同步任何方法调用。每次实例化它要容易得多，而且性能稍差。

我看到这样做的唯一原因是实例化控件需要很长时间。在这种情况下，我会采用工厂模式，其中任何初始化都完成一次，但所有数据每次都复制到一个新实例中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T21:45:18.283

如果您只想为控件创建一次模板，则可以使用延迟初始化来代替并达到几乎相同的效果。

```
private ITemplate defaultTemplate;
public override ITemplate CreateDefaultTemplate()
{
     if (defaultTemplate == null)
     {
         defaultTemplate = new FooTemplate();
     }
     return defaultTemplate;
} 
```

如果您确定您的应用程序中只需要任何特定对象的一个​​实例，您应该只使用 Singleton 实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T21:42:01.660

您真的想为模板控件使用完全相同的实例吗？我们可能需要更多关于您要完成的工作的信息。`TemplatedControl`在同一个应用程序中使用了多少个地方？

# python - 如何防止覆盖其他人修改过的对象

> ID：467134
> 
> 赞同：2
> 
> 时间：2009-01-21T21:38:39.950
> 
> 标签：python, django, django-models, locking, blocking

我想找到一种通用方法来防止在我签出对象后保存对象。

我们可以假设对象有一个`timestamp`包含上次修改时间的字段。如果我在 处签出（例如使用 ModelForm 访问了视图）`t1`并且对象再次保存在 处`t2`，假设`t2`>`t1`我应该无法保存它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T21:47:10.977

覆盖将首先检查最后一个时间戳的保存方法：

```
def save(self):
    if(self.id):
        foo = Foo.objects.get(pk=self.id)
        if(foo.timestamp > self.timestamp):
            raise Exception, "trying to save outdated Foo" 
    super(Foo, self).save() 
```

# asp.net - 无法在 WSS 下运行的 aspx 页面中设置断点

> ID：467136
> 
> 赞同：2
> 
> 时间：2009-01-21T21:38:51.900
> 
> 标签：asp.net, sharepoint, debugging

在我的 SharePoint 应用程序中，我将一些 aspx 页面部署到该`[12 Hive]\TEMPLATE\LAYOUTS`文件夹​​。
这些页面是在调试模式下编译的，我正在复制 .apsx 和 .cs 文件。
我曾经能够附加到 w3wp.exe 并在 .cs 文件中设置断点并很好地命中它们。今天不行。我收到可怕的“断点当前不会被命中。没有为此文档加载任何符号”消息。
我确定只有一个 w3wp 正在运行。
我可以部署对代码的更改（所以我知道它是正确的位置）。

我的下一步是什么？
谢谢。

*更新*：我想通了。不知道“debug=false”是什么，`C:\Inetpub\wwwroot\wss\VirtualDirectories\80\web.config`但它现在正在工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T22:31:39.903

检查以确保您的 web.config 部分没有将调试值设置为“false”。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T16:46:56.087

值得注意的是，您可以一次将 VS2008（不确定 2005）中的调试器附加到多个进程，因此如果您不确定哪个 w3wp.exe 是正确的，则附加到所有进程。

# c++ - C++ 中的可移植 wchar_t

> ID：467139
> 
> 赞同：5
> 
> 时间：2009-01-21T21:39:21.647
> 
> 标签：c++, windows, portability, wchar-t, wstring

C++ 中有可移植的 wchar_t 吗？在 Windows 上，它的 2 个字节。其他一切都是4个字节。我想在我的应用程序中使用 wstring，但是如果我决定移植它，这将导致问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T21:52:08.173

如果您正在处理程序内部的使用，请不要担心；A 类中的 wchar_t 与 B 类中的相同。

如果您计划在 Windows 和 Linux/MacOSX 版本之间传输数据，那么您需要担心的不仅仅是 wchar_t，您还需要想出处理所有细节的方法。

您可以定义一个您将在任何地方定义为四个字节的类型，并实现您自己的字符串等（因为 C++ 中的大多数文本处理都是模板化的），但我不知道这对您的需求有多好。

就像是`typedef int my_char; typedef std::basic_string<my_char> my_string;`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T21:50:42.483

“便携式 wchar_t”是什么意思？到处都有一种 16 位宽的`uint16_t`类型，这通常是可用的。但这当然还不能构成一个字符串。字符串必须知道其编码才能理解诸如 等函数`length()`（`substring()`因此在使用 utf8 或 16 时，它不会在代码点中间剪切字符）。我知道您可以使用一些与 unicode 兼容的字符串类。所有这些都可以免费用于商业程序（当 Qt 4.5 发布时，Qt 将在几个月内免费与商业程序兼容）。

[`ustring`](http://www.gtkmm.org/docs/glibmm-2.4/docs/reference/html/classGlib_1_1ustring.html)从[`gtkmm`](http://www.gtkmm.org/)项目。如果您使用 gtkmm 编程或使用 glibmm，那应该是首选，它在`utf-8`内部使用。[`Qt`](http://qt.nokia.com/)还有一个字符串类，叫做QString。它被编码在`utf-16`. [`ICU`](http://www.icu-project.org/)是另一个创建可移植 unicode 字符串类的项目，并且有一个`UnicodeString`内部似乎以 utf-16 编码的类，如 Qt。不过没用过那个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-20T13:08:53.337

提议的 C++0x 标准将具有`char16_t`和`char32_t`类型。在那之前，您将不得不使用整数作为非`wchar_t`字符类型。

```
#if defined(__STDC_ISO_10646__)
    #define WCHAR_IS_UTF32
#elif defined(_WIN32) || defined(_WIN64)
    #define WCHAR_IS_UTF16
#endif

#if defined(__STDC_UTF_16__)
    typedef _Char16_t CHAR16;
#elif defined(WCHAR_IS_UTF16)
    typedef wchar_t CHAR16;
#else
    typedef uint16_t CHAR16;
#endif

#if defined(__STDC_UTF_32__)
    typedef _Char32_t CHAR32;
#elif defined(WCHAR_IS_UTF32)
    typedef wchar_t CHAR32;
#else
    typedef uint32_t CHAR32;
#endif 
```

根据标准，您需要专门[`char_traits`](http://gcc.gnu.org/onlinedocs/libstdc++/manual/bk01pt05ch13s03.html)针对整数类型。但是在 Visual Studio 2005 上，我`std::basic_string<CHAR32>`没有进行任何特殊处理就成功了。

> 我打算使用 SQLite 数据库。

然后你需要使用 UTF-16，而不是`wchar_t`.

SQLite API 也有一个 UTF-8 版本。您可能想要使用它而不是处理`wchar_t`差异。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-20T13:16:06.633

我的建议。使用 UTF-8 和 std::string。宽弦不会给你带来太多的附加值。无论如何，您不能将宽字符解释为字母，因为某些字符是从几个 unicode 代码点创建的。

所以在任何地方使用 UTF-8 并使用好的库来处理自然语言。例如 Boost.Locale。

坏主意：定义像 typedef 这样的东西`uint32_t mychar;`是不好的。由于您不能将 iostream 与它一起使用，因此您不能基于此字符创建例如 stringstream，因为您将无法在其中写入。

例如，这将不起作用：

```
std::basic_ostringstream<unsigned> s;
ss << 10; 
```

不会为您创建一个字符串。

# php - PHP中数组的最大密钥大小是多少？

> ID：467149
> 
> 赞同：70
> 
> 时间：2009-01-21T21:43:45.557
> 
> 标签：php, arrays, key

我正在生成关联数组，键值是 1..n 列的字符串连接。

会回来咬我的钥匙是否有最大长度？如果是这样，我可能会停下来做不同的事情。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-01-21T21:55:07.607

它似乎仅受脚本内存限制的限制。

快速测试让我得到了 128mb 的密钥，没问题：

```
ini_set('memory_limit', '1024M');

$key = str_repeat('x', 1024 * 1024 * 128);

$foo = array($key => $key);

echo strlen(key($foo)) . "<br>";
echo strlen($foo[$key]) . "<br>"; 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-21T21:53:08.953

PHP 中的字符串大小没有实际限制。根据[手册](http://us.php.net/manual/en/language.types.string.php)：

> 注意：字符串变得非常大是没有问题的。PHP 对字符串的大小没有限制；唯一的限制是运行 PHP 的计算机的可用内存。

可以安全地假设这也适用于将字符串用作数组中的键，但是根据 PHP 处理其查找的方式，您可能会注意到字符串变大时性能会受到影响。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-03-26T02:54:17.867

在 zend_hash.h 中，您可以找到`zend_inline_hash_func()`可以显示如何在 PHP 中对 key 字符串进行哈希处理的方法，因此使用字符串长度小于 8 个字符的 key 对性能更好。

```
static inline ulong zend_inline_hash_func(char *arKey, uint nKeyLength) {

register ulong hash = 5381;

/* variant with the hash unrolled eight times */
for (; nKeyLength >= 8; nKeyLength -= 8) {
    hash = ((hash << 5) + hash) + *arKey++;
    hash = ((hash << 5) + hash) + *arKey++;
    hash = ((hash << 5) + hash) + *arKey++;
    hash = ((hash << 5) + hash) + *arKey++;
    hash = ((hash << 5) + hash) + *arKey++;
    hash = ((hash << 5) + hash) + *arKey++;
    hash = ((hash << 5) + hash) + *arKey++;
    hash = ((hash << 5) + hash) + *arKey++;
}
switch (nKeyLength) {
    case 7: hash = ((hash << 5) + hash) + *arKey++; /* fallthrough... */
    case 6: hash = ((hash << 5) + hash) + *arKey++; /* fallthrough... */
    case 5: hash = ((hash << 5) + hash) + *arKey++; /* fallthrough... */
    case 4: hash = ((hash << 5) + hash) + *arKey++; /* fallthrough... */
    case 3: hash = ((hash << 5) + hash) + *arKey++; /* fallthrough... */
    case 2: hash = ((hash << 5) + hash) + *arKey++; /* fallthrough... */
    case 1: hash = ((hash << 5) + hash) + *arKey++; break;
    case 0: break;  EMPTY_SWITCH_DEFAULT_CASE()
}
    return hash;   
} 
```

# c++ - 有哪些好的 C++ 资源可以有效地使用 Apache XML Security？

> ID：467150
> 
> 赞同：1
> 
> 时间：2009-01-21T21:44:21.683
> 
> 标签：c++, xml, security, apache, resources

我正在寻找一些资源，让我了解如何使用这个库，特别是用于签署 XML。我发现的大部分内容都与 Java 相关，我更愿意在 C++ 库上获取文档/常见问题解答/教程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T10:40:44.227

我有同样的问题。我能找到的最好信息是在 Apache 网站本身 ( [http://santuario.apache.org/c/programming.html)、API](http://santuario.apache.org/c/programming.html)文档以及查看他们提供的示例和工具的代码（如 templatesign） .

这些信息与一些实验相结合，足以让我签署和验证 XML 文档。基本上我只是使用 templatesign 和 checksig 作为起点。

我遇到的最大问题是 C14N，所以如果有什么不工作尝试转储 Apache 在内部使用的原始数据流，并检查它是否真的签署/验证了你的期望。

# delphi - 如何在 Windows 中挂钩全局快捷方式？

> ID：467152
> 
> 赞同：5
> 
> 时间：2009-01-21T21:44:43.913
> 
> 标签：delphi, winapi, hotkeys

我记得几年前使用过一个程序，它允许我通过自定义伽马斜坡和其他调整来微调显示器的设置。它能够为不同的用途创建不同的屏幕设置配置文件，并设置全局热键快捷方式来激活它们，而无需退出您所在的程序。

我的问题是，您如何为此设置挂钩？当我只想在一个屏幕上访问桌面并且想继续在另一个屏幕上工作时，我厌倦了 WINDOWS-D 最小化所有内容。（我有两台显示器是有原因的！）所以我认为破解一个小的 Delphi 应用程序应该不难，它将最小化一台显示器上的所有内容。唯一的问题是将其连接到热键。有谁知道这个API是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-21T21:47:56.840

[http://www.swissdelphicenter.ch/torry/showcode.php?id=147](http://www.swissdelphicenter.ch/torry/showcode.php?id=147)

基本上分为三个步骤：

**登记**

```
// Register Hotkey Win + A
id1 := GlobalAddAtom('Hotkey1');
RegisterHotKey(Handle, id1, MOD_WIN, VK_A); 
```

**处理**

```
procedure WMHotKey(var Msg: TWMHotKey); message WM_HOTKEY;

{ .... }

// Trap Hotkey Messages
procedure TForm1.WMHotKey(var Msg: TWMHotKey);
begin
  if Msg.HotKey = id1 then
    ShowMessage('Win + A pressed !'); 
```

**注销**

```
UnRegisterHotKey(Handle, id1);
GlobalDeleteAtom(id1); 
```

# sql-server - 您使用什么来分析 SQL Server 2005 Express？

> ID：467153
> 
> 赞同：2
> 
> 时间：2009-01-21T21:44:45.960
> 
> 标签：sql-server, debugging, sql-server-2005-express, sql-server-profiler

我在 SQL Server 2005 Express 实例上遇到问题，我需要查看正在运行的确切内容，因为当我从 Management Studio 运行它时，*我认为*正在运行的内容可以正常运行。

Profiler 似乎不适用于 SQL Server 2005 Express。当我尝试针对 2005 Express 版本运行 SQL Server 2000 Profiler 时，我收到以下消息：“要连接到此服务器，您必须使用 SQL Server Management Studio 或 SQL Server Management Objects (SMO)。” 但是，在搜索 Express Management Studio 的菜单以执行类似于我需要的操作时，我找不到任何东西。我发现第三方分析器仿冒 Express，但我不想在我客户的服务器上安装客户端应用程序。

您如何找出 SQL Server 2005 Express 中正在运行的内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T22:11:34.470

我使用[这个](http://sqlprofiler.googlepages.com/)sql server profiler。它是免费的，它是开源的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T19:41:22.407

[您可以从http://www.xsqlsoftware.com/Product/xSQL_Profiler.aspx](http://www.xsqlsoftware.com/Product/xSQL_Profiler.aspx)使用 xSQL Profiler 它最多可免费用于 2 个实例。

# dom - Dojo addOnLoad，但 Dojo 是否已加载？

> ID：467166
> 
> 赞同：11
> 
> 时间：2009-01-21T21:48:48.540
> 
> 标签：dom, dojo, onload

我遇到了看似鸡和蛋的问题，并且有我认为合乎逻辑的解决方案。但是，我突然想到其他人一定遇到过类似的事情，所以我想我会把它浮出水面给大众。

情况是我想使用 dojo 的 addOnLoad 函数来排队一些回调，这些回调应该在 DOM 在客户端完成渲染后执行。所以我正在做的事情如下：

```
<html>
    <head>
        <script type="text/javascript" src="dojo.xd.js"></script>
        ...
    </head>
    <body>
        ...
        <script type="text/javascript">
            dojo.addOnLoad( ... );
            dojo.addOnLoad( ... );
            ...
        </script>
    </body>
</html> 
```

现在，问题是我似乎在将整个 Dojo 库下载到浏览器之前调用了 dojo.addOnLoad。这在某种程度上是有道理的，因为内联 SCRIPT 内容应该在整个 DOM 加载*之前*执行（并且触发正常的正文 onload 回调）。

我的问题是 - 我的方法是否合理，或者注册一个普通/标准主体 onload JavaScript 回调来调用一个函数是否更有意义，该函数与每个 dojo.addOnLoads 在 SCRIPT 块中所做的工作相同。当然，这引出了一个问题，如果您不能保证 Dojo 库会在使用库之前被加载，为什么还要使用 dojo.addOnLoad？

希望这种情况对我以外的人有意义。似乎其他人可能遇到过这种情况。

想法？

最好的问候，亚当赖斯

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-23T16:20:52.540

你做对了。外部 Javascript 文件按顺序同步加载和执行，因此当它到达您的`dojo.addOnLoad( ... );`Dojo 时已经加载。使用`dojo.addOnLoad`而不是有`window.onload`两个原因：

*   它触发得更早，因为它利用了[DOMContentLoaded](http://dojotoolkit.org/2006/08/21/domcontentloaded-now-onload-event-dojo)
*   它通过推迟执行来处理异步加载，`dojo.require`直到已读取所有必需的脚本

在 DojoCampus 中解释为 ( [dojo.addOnLoad](http://docs.dojocampus.org/dojo/addOnLoad) )：

> dojo.addOnLoad 是使用 Dojo 的一个基本方面。传递 addOnLoad 一个函数将注册该函数以在 Dom 准备好时运行。这与 document.ready 和 body.onload 略有不同，因为 addOnLoad 等到所有 dojo.require() （以及它们的递归依赖项）在触发之前都已加载。

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2010-03-28T05:10:05.773

这可能与您的问题无关，但我只是有一个案例，我有相同的症状。对我来说，一切都适用于 Firefox、Chrome 等，但不适用于 IE8。

我得到了看起来像 dojo 没有被加载的东西，IE8 中的一个错误说 dojo 是未定义的（但不是所有时间），我可以将所有内容简化为样式表并导入 dojo，但仍然得到错误。

我正在运行一个本地谷歌应用引擎开发服务器。这看起来是基于 python 的 SimpleHTTPServer，而后者又使用了 SocketServer.BaseServer。这有 BaseServer.request_queue_size 默认为 5 - 我在应用引擎中找不到任何覆盖这个值的东西，所以我猜开发谷歌应用引擎服务器的上限为 5 个连接。

使用 regedit 并转到 HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings

“MaxConnectionsPerServer”=dword:00000010 “MaxConnectionsPer1_0Server”=dword:0000010

这表明 IE 将尝试打开最多 10 个同时连接。我编辑了这两个键并将它们设为 2 并重新启动计算机，问题就消失了。

# hibernate - Hibernate Criteria API - HAVING 子句变通方法

> ID：467172
> 
> 赞同：10
> 
> 时间：2009-01-21T21:50:43.887
> 
> 标签：hibernate, criteria, having

我使用 Hibernate Criteria API 编写了一个查询来获取特定值的总和，现在我需要能够将结果限制为总和大于或等于特定值的行。

通常我会在我的 SQL 中使用 HAVING 子句来执行此操作，但 Criteria API 目前似乎不支持它。

在原始 SQL 中，这是我需要它做的事情：

```
SELECT user_pk, sum(amount) as amountSum
FROM transaction
GROUP BY user_pk
HAVING amountSum >=50; 
```

我想到的一种解决方法是在 FROM 子句中使用一个子查询来获取这个总和值，并使用一个外部查询来使用 WHERE 子句来限制它。

因此，在原始 SQL 中，它看起来像：

```
SELECT user_pk, amountSum
FROM (SELECT user_pk, sum(amount) as amountSum
      FROM transaction
      GROUP BY user_pk)
WHERE amountSum > 50; 
```

谁能指出我如何使用 Criteria API 编写此代码的正确方向，或者我可以用来解决 HAVING 问题的任何其他建议/解决方法？

这是我为上述示例提供的 Criteria API 代码

```
DetachedCriteria criteria = DetachedCriteria.forClass(Transaction.class,"transaction");
criteria.setProjection(criteria.setProjection(Projections.projectionList().add(
        Projections.groupProperty("user.userPK").as("user_pk")).add(
            Projections.sum("transaction.amount").as("amountSum"))); 
```

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T05:38:45.707

我不知道 Hibernate/NHibernate 在 FROM 子句中使用子查询的方法，但您可以在 WHERE 子句中使用它们。对于任何 Java/Hibernate 代码错误，我深表歉意，我更熟悉 C#/NHibernate。

```
 DetachedCriteria subQuery = DetachedCriteria.forClass(Transaction.class);
subQuery.setProjection(Projections.sum("amount"));
subQuery.add(Expression.eqProperty("userPk", "tOuter.userPk"));

DetachedCriteria outerQuery = DetachedCriteria.forClass(Transaction.class, "tOuter");
outerQuery.setProjection(Projections.projectionList()
    .Add(Projections.sum("amount").as("sumAmount"))
    .Add(Projections.groupProperty("userPk").as("user_pk"));
outerQuery.add(Subqueries.le(50, subQuery)); 

```

此代码应产生类似于以下内容的 SQL：

```
 SELECT tOuter.userPk as user_pk, sum(tOuter.amount) as sumAmount
FROM transaction tOuter
WHERE 50 <= (SELECT sum(amount) FROM transaction WHERE userPk = tOuter.userPk)
GROUP BY tOuter.userPk 

```

这种方法的缺点是它计算每个总和两次，这可能会对性能产生不利影响，具体取决于所涉及的数据量 - 在这种情况下，您将需要使用支持 HAVING 子句的 HQL 查询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-04T09:25:12.180

HHH-1700 被标记为 HHH-1043 的副本，因此不会被修复。[您会在HHH-1043](http://opensource.atlassian.com/projects/hibernate/browse/HHH-1043?focusedCommentId=35459&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#action_35459)上找到我的解决方案和解决方法，以及其他人的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-14T02:31:13.910

[http://opensource.atlassian.com/projects/hibernate/browse/HHH-1700](http://opensource.atlassian.com/projects/hibernate/browse/HHH-1700)

# c# - 从 XSD 生成 SQL Server DB

> ID：467176
> 
> 赞同：3
> 
> 时间：2009-01-21T21:52:05.007
> 
> 标签：c#, .net, sql-server, xsd

**重复**：[从 XML 生成 SQL 模式](https://stackoverflow.com/questions/263836/generating-sql-schema-from-xml)

* * *

在我正在进行的项目中，我需要支持强类型数据集以将数据存储为 XML，或将数据存储在 sql server 中。现在我已经创建了 XSD 架构，我希望能够使用 XSD 中定义的表和关系创建一个 sql server 数据库。

这可能吗？如果是这样，解决这个问题的最佳方法是什么？

* * *

**澄清**：我正在寻找的是一种在运行时使用 C# 和 SQL Server 通过代码执行上述操作的方法。这可以做到吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T18:41:54.237

我设法提出了基于 SQL Server 管理对象的以下类：

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.SqlClient;
using System.IO;
using System.Text;
using Microsoft.SqlServer.Management.Common;
using Microsoft.SqlServer.Management.Smo;
using Rule=System.Data.Rule;

namespace XSD2SQL
{
public class XSD2SQL
{
    private readonly Server _server;
    private readonly SqlConnection _connection;
    private Database _db;
    private DataSet _source;
    private string _databaseName;

    public XSD2SQL(string connectionString, DataSet source)
    {
        _connection = new SqlConnection(connectionString);
        _server = new Server(new ServerConnection(_connection));
        _source = source;
    }

    public void CreateDatabase(string databaseName)
    {
        _databaseName = databaseName;
        _db = _server.Databases[databaseName];
        if (_db != null) _db.Drop();
        _db = new Database(_server, _databaseName);
        _db.Create();
    }

    public void PopulateDatabase()
    {
        CreateTables(_source.Tables);
        CreateRelationships();
    }

    private void CreateRelationships()
    {
        foreach (DataTable table in _source.Tables)
        {
            foreach (DataRelation rel in table.ChildRelations)
                CreateRelation(rel);
        }
    }

    private void CreateRelation(DataRelation relation)
    {
        Table primaryTable = _db.Tables[relation.ParentTable.TableName];
        Table childTable = _db.Tables[relation.ChildTable.TableName];

        ForeignKey fkey = new ForeignKey(childTable, relation.RelationName);
        fkey.ReferencedTable = primaryTable.Name;

        fkey.DeleteAction = SQLActionTypeToSMO(relation.ChildKeyConstraint.DeleteRule);
        fkey.UpdateAction = SQLActionTypeToSMO(relation.ChildKeyConstraint.UpdateRule);

        for (int i = 0; i < relation.ChildColumns.Length; i++)
        {
            DataColumn col = relation.ChildColumns[i];
            ForeignKeyColumn fkc = new ForeignKeyColumn(fkey, col.ColumnName, relation.ParentColumns[i].ColumnName);

            fkey.Columns.Add(fkc);
        }

        fkey.Create();

    }

    private void CreateTables(DataTableCollection tables)
    {
        foreach (DataTable table in tables)
        {                
            DropExistingTable(table.TableName);
            Table newTable = new Table(_db, table.TableName);

            PopulateTable(ref newTable, table);                
            SetPrimaryKeys(ref newTable, table);
            newTable.Create();

        }
    }

    private void PopulateTable(ref Table outputTable, DataTable inputTable)
    {
        foreach (DataColumn column in inputTable.Columns)
        {
            CreateColumns(ref outputTable, column, inputTable);
        }
    }

    private void CreateColumns(ref Table outputTable, DataColumn inputColumn, DataTable inputTable)
    {
        Column newColumn = new Column(outputTable, inputColumn.ColumnName);
        newColumn.DataType = CLRTypeToSQLType(inputColumn.DataType);
        newColumn.Identity = inputColumn.AutoIncrement;
        newColumn.IdentityIncrement = inputColumn.AutoIncrementStep;
        newColumn.IdentitySeed = inputColumn.AutoIncrementSeed;
        newColumn.Nullable = inputColumn.AllowDBNull;
        newColumn.UserData = inputColumn.DefaultValue;

        outputTable.Columns.Add(newColumn);
    }

    private void SetPrimaryKeys(ref Table outputTable, DataTable inputTable)
    {
        Index newIndex = new Index(outputTable, "PK_" + outputTable.Name);
        newIndex.IndexKeyType = IndexKeyType.DriPrimaryKey;
        newIndex.IsClustered = false;

        foreach (DataColumn keyColumn in inputTable.PrimaryKey)
        {                                
            newIndex.IndexedColumns.Add(new IndexedColumn(newIndex, keyColumn.ColumnName, true));                
        }
        if (newIndex.IndexedColumns.Count > 0)
            outputTable.Indexes.Add(newIndex);
    }

    private DataType CLRTypeToSQLType(Type type)
    {
        switch (type.Name)
        {
            case "String":
                return DataType.NVarCharMax;

            case "Int32":
                return DataType.Int;

            case "Boolean":
                return DataType.Bit;

            case "DateTime":
                return DataType.DateTime;

            case "Byte[]":
                return DataType.VarBinaryMax;

        }

        return DataType.NVarCharMax;
    }

    private ForeignKeyAction SQLActionTypeToSMO(Rule rule)
    {
        string ruleStr = rule.ToString();

        return (ForeignKeyAction)Enum.Parse(typeof (ForeignKeyAction), ruleStr);
    }

    private void DropExistingTable(string tableName)
    {
        Table table = _db.Tables[tableName];
        if (table != null) table.Drop();
    }

}
} 
```

它尚未经过严格测试，需要映射出更多 SQL 到 CLR 类型，但它确实创建了一个新数据库，包含所有表、列、主键和外键。

要使此代码正常工作，需要引用一些程序集：

```
Microsoft.SqlServer.ConnectionInfo
Microsoft.SqlServer.Management.Sdk.Sfc
Microsoft.SqlServer.Smo
Microsoft.SqlServer.SqlEnum 
```

希望这可以帮助其他人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T05:03:10.910

我会编写一些 XSLT 来将 XSD 转换为 SQL 创建语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T09:07:29.043

如果您正在使用 SQL2005，您可以创建一个具有强类型 XML 列的表，以便根据 XML 模式集合（即 XSD）验证每个值。但是，我无法告诉您有关性能、可扩展性等的任何信息。

如果你尝试将一个 XSD 翻译成一组关系表，你会发现 XSD 元素和 SQL 表之间没有唯一的映射关系：

XSD 子元素可以实现为详细信息表、表示元素的一组列（如果只允许一个子元素）或强制/可选的 1:1/1:n 关系。

XSD 子元素的集合可以是主从关系，也可以是与属性一起存储在单独表中的 n:m 关系。

IIRC 在 XSD 中没有定义主要约束和唯一约束，这给自动模式生成带来了另一个问题。

这一切并不意味着没有人费心为这样的任务开发工具。但这肯定意味着任务不能完全自动化。

# .net - 使用 COM 对象的 Web 服务出现问题

> ID：467178
> 
> 赞同：0
> 
> 时间：2009-01-21T21:52:16.567
> 
> 标签：.net, com, interop, service

我有一个调用 Interop COM 对象的 VB.NET Web 服务。当我同时多次调用 Web 服务时，Web 服务处理正常，直到调用 COM 对象的第一个方法。在这一点上，似乎对 COM 对象的调用被放入堆栈并在 FIFO 基础上进行处理。因此，每个 Web 服务调用都会等待前一个调用完成。

在调用使用 COM 库的类库之前，我在控制台应用程序端做了同样的事情，您可以同时使用同一个 Interop COM 对象运行多个控制台应用程序，没有问题。

我需要做什么才能使其在 Web 服务端正常工作？Web 服务不必等待 COM 在之前的 Web 服务调用中完成以继续处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T22:26:39.120

您的多个控制台实例都是各自的进程，因此它们拥有自己的 COM 对象副本。

IIS 和您的 Web 服务位于一个进程中，因此您将受制于 COM 线程规则。您使用的 COM 对象可能被标记为单线程。或者它实现了一个单例模式，这样每个进程只存在一个副本，并且它是易于线程化的。无论对于 apt 线程 COM 对象，一次只能有一个线程访问它。

围绕 COM 和线程的规则相当复杂，您使用的 COM 对象可能没有编写为在 IIS 下运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T00:01:59.100

I'm of course, unfamiliar with the object you deal with, but just an idea: is it possible for you to proxy calls to the COM object through a COM+ application? This way you might be able to set desired threading model, also make it out-of-process (hosted in dllhost.exe), so IIS will not have to fight with it as in-process server

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T16:11:57.923

经过进一步调查，我发现这是 MTA 公寓中运行的 Web 服务的问题，而 COM 位于 STA 公寓中。这篇文章很好地解释了它...... [http://msdn.microsoft.com/en-us/magazine/cc163544.aspx](http://msdn.microsoft.com/en-us/magazine/cc163544.aspx)并提供了一个解决方案，但是，当我实现它时，它似乎并没有将 Web 服务移动到STA公寓。

# xml - 在 VB6 中第一次验证 DTD 后如何解析 XML 文档

> ID：467180
> 
> 赞同：1
> 
> 时间：2009-01-21T21:52:27.830
> 
> 标签：xml, vb6, dtd

我正在尝试在 VB6 中编写 XML 解析器。
XML 所基于的标准带有一个 DTD，用于在开始解析之前验证 XML。我还编写了一个示例 XML 文件，以便我可以进行测试。

我能够通过 vb6 代码加载 XML

```
Dim objXMLDoc As MSXML.DOMDocument
Set objXMLDoc = New MSXML.DOMDocument  
If Not objXMLDoc.Load("sample.xml") Then  
----Goto ErrorHandler  
End If 
```

工作 XML

```
<?xml version = "1.0"?>  
<Root>  
...  
</Root> 
```

尝试使用我的 DTD 进行验证

```
<?xml version = "1.0"?>  
<!DOCTYPE sample SYSTEM "sample.dtd">  
<Root>  
...  
</Root> 
```

我所做的研究使我相信，如果 XML 通过 doc 类型指向 DTD，则 Load 将验证 XML。
我做了很多研究，无法弄清楚我哪里出错了。它可能就像提供的 DTD 在语法上不正确一样简单，我现在正在查看它。我找到的资源主要在 MSDN 和这里[http://www.jalix.org/ressources/internet/dom/~vrac/articles/XML%20DOM.html](http://www.jalix.org/ressources/internet/dom/~vrac/articles/XML%20DOM.html)。
xml 和 dtd 都位于同一个目录中，我让它解析没有 doctype 标记的 XML。

我得到的错误是：
错误＃：-2146697211：系统找不到指定的资源。错误处理资源“sample.dtd”

任何额外的资源或建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T23:38:41.813

我无法重现您的错误。它适用于我在同一个文件夹中的两个文件。

这也不是 DTD 格式不正确的问题。这会引发另一个错误。如果它找不到 DTD，我会收到与您相同的错误，而`-1072896757`如果它确实找到了我的（完全伪造的）DTD，我会收到错误（“在 DTD 中找到无效字符。”）。

您是否尝试过使用不同的*Microsoft XML*版本，或者您是否与旧**版本 2.0**绑定？如果可能，请尝试**v6.0 。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T10:13:36.477

一个明显的建议，但是您是否尝试过完全限定 dtd 文件名（即 c:\blahblah...\sample.dtd？

# asp.net - 为什么aspx文件会返回404（“找不到页面”）

> ID：467188
> 
> 赞同：35
> 
> 时间：2009-01-21T21:55:08.573
> 
> 标签：asp.net

为什么当我通过 IE6 访问一个 aspx（例如，[http](http://www.example.com/foo.aspx) ://www.example.com/foo.aspx - 不是真实站点）时，我会在 IIS6 中收到 404 错误（即“找不到该页面”）

我已经为网站启用了脚本，并且我也尝试过启用可执行文件。

这是完整的错误：

```
The page cannot be found
The page you are looking for might have been removed, had its name changed, or
is temporarily unavailable. 
------------------------------------------------------------------------------

Please try the following:

Make sure that the Web site address displayed in the address bar of your 
browser is spelled and formatted correctly. 
If you reached this page by clicking a link, contact the Web site 
administrator to alert them that the link is incorrectly formatted. 
Click the Back button to try another link. 
HTTP Error 404 - File or directory not found.
Internet Information Services (IIS)

------------------------------------------------------------------------------

Technical Information (for support personnel)

Go to Microsoft Product Support Services and perform a title search for the 
words HTTP and 404\. 
Open IIS Help, which is accessible in IIS Manager (inetmgr), and search for 
topics titled Web Site Setup, Common Administrative Tasks, and About Custom 
Error Messages. 
```

我可以访问同一目录中的 Default.htm，所以我知道路径是正确的。我已经（暂时）向所有人开放，所以我知道权限是正确的。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-01-22T00:47:15.933

这可能是很多事情。`aspnet_regiis -i -enable`我今天遇到了这个问题，因为在安装 IIS（或等效项） 后没有重新初始化 .NET 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-21T21:59:38.487

检查运行站点的匿名用户是否对文件 foo.aspx 具有读取权限。

IIS6 及更高版本使用 404 响应，因此不会让攻击者知道这样的文件是否存在。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-10-26T22:18:09.100

我只是碰巧找到了这个问题的另一个罪魁祸首。我的`foo.aspx`页面引用了一个特定的母版页，该母版页具有`<%@ Register %>`指向不存在的用户控件的指令。删除对不存在的用户控件的引用导致我`foo.aspx`加载而不是 404。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-13T23:37:52.680

我在[这里](http://www.sitepoint.com/forums/net-141/asp-net-mvc-custom-error-page-statuscode-404-throws-500-a-663415.html)找到了解决方案。真正的收获是使用这个：

```
Response.TrySkipIisCustomErrors = true; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T21:56:31.287

该站点指向该页面所在的不同目录。

它可能是权限，但是我认为您会收到访问错误。

我假设您正在运行 IIS。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T22:02:50.807

检查 www.example.com 是否会访问您认为的站点。

如果您使用主机标头在同一个 IP 上托管多个站点，您可能需要仔细检查您使用的名称是否指向您认为的站点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T01:15:58.357

雷和乔可能有它。为了服务于任何文件类型，IIS 必须有一个映射。Aspx 文件要求将它们映射到 AspNet ISAPI dll，由 .Net 安装通常负责处理。如果您在 .Net 之后安装 IIS（我确信还有其他情况），您必须自己通过运行 aspnet_regiis 来启动它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-25T04:36:44.067

替代解决方案（相同的错误可能不同的原因）。

我安装了没有 SQL Express 的 Visual Studio 2008 Pro，它导致了同样的错误。重新安装包含 sql express 的 VS2008 似乎已经纠正了问题，或者安装可能采取了其他措施。我之前确实尝试过多次注册 ASP.net，但没有运气，但这绝对是最可能的原因，只是将我的经验发布给那些像我一样拉头发的人..

谢谢

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-17T14:43:21.083

如果你注册了.NET 4 版本的IIS，你可能会发现它抢了aspx 扩展的注册。如果禁止 ASP.NET v4，则将返回 404

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-10-10T17:38:45.697

我遇到了这个问题，有些客户报告了 404.0，有些客户根本没有问题（同一页面）。我能够在我的机器上毫无问题地导航到任何页面。一些客户会刷新，它会消失。我正在使用 .Net 4.5.2 和 IIS 7.5。

查看 IIS 日志文件，我会看到：

sc-status sc-substatus sc-win32-status
404 0 2

sc-status.sc-substatus：404.0 - 未找到
sc-win32-status：2 - ERROR_FILE_NOT_FOUND
[https://msdn.microsoft.com/en-us/library/windows/desktop/ms681382(v=vs.85)。 aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/ms681382(v=vs.85).aspx) [https://en.wikipedia.org/wiki/HTTP_404](https://en.wikipedia.org/wiki/HTTP_404)

我发现问题是我部署了一个新版本的网站，其中旧版本的网站通过使用 Web 表单模板创建项目来设置 RouteConfig.cs/FriendlyUrlSetting。新版本是使用空模板创建的。现在对我来说很明显.. 没有 URL 路由。客户的机器上的某些页面存在缓存问题（没有 .aspx 扩展名），让他们清除浏览器数据最终解决了这个问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-28T08:25:36.823

当我尝试使用不同的驱动器来托管我的应用程序时，我遇到了这个问题。我最终将它们移动到 wwwroot 文件夹，因为它在那里工作，我没有时间弄清楚为什么它不能在 E:\ 驱动器上工作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-08-16T13:25:50.667

我缺少**bin\roslyn**编译器。添加这一切都很好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-07-12T03:27:30.853

检查双引号错误。我开始在单个页面上收到 404，因为我不小心遇到了这个：

`<asp:TemplateField HeaderText="ImageURL"">`

而不是这个：

`<asp:TemplateField HeaderText="ImageURL">`

# sql - SQL Server 不会对 XML 列执行正则表达式验证

> ID：467190
> 
> 赞同：0
> 
> 时间：2009-01-21T21:55:52.160
> 
> 标签：sql, xml, regex

我的表中有一个 XML 列，其中包含此 xsd 片段：

```
<xsd:element name="Postcode" minOccurs="0">
    <xsd:simpleType>
        <xsd:restriction base="xsd:string">
            <xsd:pattern value="^[0-9]{4}$" />
        </xsd:restriction>
    </xsd:simpleType>
</xsd:element> 
```

正则表达式应该需要一个包含 4 个数字的字符串。它在 Visual Studio 中完美验证并且是正确的正则表达式。

另一方面，SQL Server 不会接受它。我收到的错误信息是：

```
XML Validation: Invalid simple type value: '1234'. Location: / * : Donor[1]/*:Postcode[1]. 
```

我有一个电子邮件地址正则表达式工作正常，但无法让这个简单的数字正则表达式工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T22:17:47.170

您的源 XML 是否如下所示：

```
<Postcode>1234</Postcode> 
```

或像这样：

```
<Postcode>
    1234
</Postcode> 
```

由于您正在修剪字符串（使用`^`and `$`），请确保您的 XML 看起来像前者而不是后者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T23:33:59.140

XML Schema regex 风格不支持开始和结束锚点；所有比赛都固定在两端，总是。它可能试图从字面上匹配 '^' 和 '$'。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T21:43:21.560

不，字符串周围没有空格。

我确实有一个完美运行的电子邮件地址正则表达式。

# javascript - 一个元素可以代表另一个元素接受可排序的 droppable 吗？

> ID：467196
> 
> 赞同：0
> 
> 时间：2009-01-21T21:57:25.480
> 
> 标签：javascript, jquery, jquery-ui

我有两个连接的可排序列表，但每个列表都在一个更大的块元素中。就像是：

```
<div class="items_box">
    <ul class="items">
        <li>Item</li>
        <li>Item</li>
        <li>Item</li>
    </ul>
</div>

<div class="items_box">
    <ul class="items">
        <li>Item</li>
        <li>Item</li>
        <li>Item</li>
    </ul>
</div> 
```

使用这个 Javascript：

```
$(".items").sortable({connectWith: [".items"]}); 
```

`.items_box`div 比列表高。我想让整个 div 代表其列表接受项目。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-01T15:02:27.967

解决方案是使**容器**可排序，并更改**.items**属性以在列表中查找您的项目。

```
$('.items_box').sortable({ 
  connectWith: '.items_box', 
  items: '> .items > li' 
}); 
```

我已经为您发布了一个[工作示例](http://jsbin.com/oyeyi/edit)（尽管拖入空列表存在问题，但这是一个新问题；）

另请注意，**connectWith**不再允许选择器数组。而是用逗号分隔它们。

# javascript - dojo.require 问题

> ID：467200
> 
> 赞同：2
> 
> 时间：2009-01-21T21:58:07.710
> 
> 标签：javascript, dojo

我在配置我的 dojo 初始安装以正确包含小部件框架时遇到问题。

按照我看到的大部分代码，包括 dijit 应该是这样的：

```
dojo.require("dijit"); 
```

就是这样。不幸的是，这似乎不起作用。

使用它可以正确初始化小部件，但是标准 dijit 方法中有一些奇怪的行为让我认为我做错了：

```
dojo.require("dijit.dijit"); 
```

是否有我缺少的配置 dojo 的元素？这些文件都按照它们在 1.2.3 发行版中的状态放置在另一个 javascript 文件夹下。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T16:09:02.267

您实际上*不必*包含 dijit，只需直接指向您要使用的小部件：`dojo.require("dijit.Dialog");`. 奇怪的小部件行为也可以通过以下方式解释：

*   缺少主题 css 文件：检查 FireBug 是否已加载所有内容
*   缺少主题类属性：添加`class="tundra"`到`body`元素
*   失踪`djConfig="parseOnLoad: true"`

# .net - 为 Intellisense 的注释添加换行符

> ID：467202
> 
> 赞同：78
> 
> 时间：2009-01-21T21:58:46.413
> 
> 标签：.net, intellisense, intellisense-documentati

有谁知道如何在摘要注释中插入换行符以使换行符反映在 Intellisense 文档中？

为了澄清，假设代码文档..

```
/// <summary>
/// Some text documentation
///  - a line break - 
/// Some more documentation
/// </summary>
public void SomeMethod() { } 
```

因此，当使用此方法时，Intellisense 会提供该方法的摘要，格式如下：

> 一些文本文档
> 
> 更多文档

**（注意 - 'para' 标签不会创建空换行符 - 我已经尝试过了！）**

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-01-21T22:01:05.770

尝试使用这个。

```
/// <summary>
/// <para>Paragraph 1.</para>
/// <para>Paragraph 2.</para>
/// </summary> 
```

但我不认为你可以有一个真正的空行。空的 para 标记被忽略。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-05-10T20:49:28.117

尝试这个：

```
/// <summary>
/// <para> [Non-Breaking Space] </para>
/// </summary> 
```

`[Non-Breaking Space]`使用`Alt`+获得`255`（使用数字键盘）。

它将显示为一个空的新行。我知道这是旧的，但它今天对我有用。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-03-25T14:58:55.173

```
/// <summary><br />
/// <para>To treat comment line like a DIV tag, surround them with PARA tags.</para><br />
/// <para>To add a break with whitespace, add the following line:</para><br />
/// <para>&#160;</para><br />
/// </summary> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-21T22:20:11.783

你唯一的希望可能是像这样笨拙的东西：

```
/// <summary>
/// <para>line one</para>
/// <para>_</para>
/// <para>line two</para>
/// </summary> 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-01-21T22:16:07.907

嗯，它是 Xml。也许`&#10;&#13;`

# ruby - 如何将编辑框的光标定位在鞋子中？

> ID：467205
> 
> 赞同：2
> 
> 时间：2009-01-21T21:59:20.967
> 
> 标签：ruby, user-interface, shoes

鞋子是非常方便的 GUI 工具。我想做一个搜索表单，以便帮助用户浏览更大的文本进行编辑。为此，我需要在编辑框元素内移动光标。

在这里，您将在代码中看到我的问题：

```
Shoes.app do

  stack do
    p=para "After pressing 'search' a question will arise"
    box=edit_box  
    box.text="One\nof\nthe\nmost\nstriking\ndifferences\nbetween\na\ncat\nand\na\nlie\nis\nthat\na\ncat\nhas\nonly\nnine lives."
    flow :margin_top=>0.1 do
      search=edit_line

      button("search") do
        pos=box.text.index search.text 
        y = box.text[0..pos].split.size-1 if pos

        if not y.nil?
          #For example if you searched "only" then 
          #cursor should jump/scroll to line 17.
          #
          #Anything there for cursor positioning, 
          #like: box.cursor=[0,y]
          #
          p.text="How can I move editbox's cursor in line #{y+1}?"
        else
          alert "'#{search.text}' not found"
        end        
      end
    end
  end
end 
```

有没有办法改变编辑框光标的位置？如果没有，您知道另一种实施方式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T23:33:22.227

不幸的是，Shoes 似乎没有提供任何方法来做到这一点。这些是在 EditBox 上定义的唯一方法（它继承自 Native，它有几个方法，但同样没有重新定位光标）。

```
rb_define_method(cEditBox, "text", CASTHOOK(shoes_edit_box_get_text), 0);
rb_define_method(cEditBox, "text=", CASTHOOK(shoes_edit_box_set_text), 1);
rb_define_method(cEditBox, "draw", CASTHOOK(shoes_edit_box_draw), 2);
rb_define_method(cEditBox, "change", CASTHOOK(shoes_control_change), -1); 
```

[http://github.com/why/shoes/blob/cea39a8bf9a5b7057b1824a9fab868d1f8609d69/shoes/ruby.c](http://github.com/why/shoes/blob/cea39a8bf9a5b7057b1824a9fab868d1f8609d69/shoes/ruby.c)

# mstest - mstest 无法启动

> ID：467208
> 
> 赞同：0
> 
> 时间：2009-01-21T22:00:00.187
> 
> 标签：mstest

该`run.mstest`命令已启动，但显示以下错误消息。不会生成日志，也不会运行任何测试，但会报告构建成功。

```
 [exec] 'C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\MSTest.exe' failed to start. 
```

这是什么意思？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-21T22:07:16.210

您需要找到更多信息。您能否打开 Visual Studio 命令提示符并针对您的测试程序集运行“mstest”以查看您得到的输出？

# web-applications - 可以从不受信任的来源安全地执行 TeX 代码吗？

> ID：467214
> 
> 赞同：6
> 
> 时间：2009-01-21T22:01:50.683
> 
> 标签：web-applications, latex, tex, trusted-vs-untrusted

MediaWiki 允许嵌入 TeX 数学代码，这些代码呈现为图像并发布到 Wiki 页面。这安全吗？如果允许不受信任的用户输入要由运行在 Web 服务器中的解释器执行的 TeX 程序，它是否会通过使用 TeX 解释器从服务器磁盘读取文件来打开服务器被黑客攻击？有没有办法安全地执行不受信任的 TeX 代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T22:17:54.957

显然，TeX 能够通过正常操作打开和写入文件，这是一个可能的攻击向量。将执行放入[沙盒](http://en.wikipedia.org/wiki/Sandbox_(computer_security))或[监狱](http://en.wikipedia.org/wiki/Jail_(computer_security))中应该可以解决这个问题。

一定要[禁用](http://wiki.contextgarden.net/write18) `\write18`，它允许 TeX 源文件执行操作系统命令。没有充分的理由允许这种机制。

至于 TeX 解释器本身，我想说没有什么好担心的，因为它可能是有史以来所有功能齐全的解释器中最不重要的错误计数。你的堆栈的其他部分将是一个更大的目标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T07:24:44.773

如果您的 TeX 发行版使用 Kpathsea 库（它可能会使用），请参阅其文档中[的安全部分](http://www.tug.org/texinfohtml/kpathsea.html#Security)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-21T22:09:08.827

理论上，是的。
这取决于您的 TeX 解释器。如果在您使用的解释器中发现安全漏洞，并且该安全漏洞意味着用户可以执行任意代码，那么您就有问题了。

# drupal - 在 Drupal 中，如何使浏览器页面和嵌入式 XMLRPC 客户端之间的登录状态保持一致？

> ID：467223
> 
> 赞同：1
> 
> 时间：2009-01-21T22:06:22.093
> 
> 标签：drupal, drupal-6, xml-rpc

我有一个带有用户登录名的 Drupal 站点。该站点中嵌入了一个 Flash 应用程序，该应用程序向所有人显示一些数据，但如果用户登录，则允许使用额外的功能。在 Flash 中，我使用 XMLRPC 访问 system.check 方法（确定用户是否已登录）和 user.login 方法（从 Flash 中登录用户）。

在 Flash 中，一切正常。但是，Flash 登录状态似乎与站点的其余部分不对应。例如，如果我通过 XMLRPC 调用 user.login，随后对 system.check 的调用显示我已登录，但 Drupal 用户页面仍然显示我已注销。或者，如果我在这两个地方都登录了，然后通过 Drupal 用户页面注销，下一次调用 system.check 仍然表明我已登录。

如何使 Drupal GUI 和我的嵌入式 Flash 应用程序之间的登录状态保持一致？

（注意：我没有使用任何 XMLRPC 库，我只是手动构建必要的 XML 并使用 URLRequest 对象发送 POST 方法。）

编辑：我已经通过[这个问题](https://stackoverflow.com/questions/467449/when-posting-a-form-with-urlrequest-how-to-include-cookies-from-browser-session)以及通过 Web 代理测试确认用户登录页面返回的 SESS cookie 正在被 Flash 应用程序拾取并发送回。

编辑：现在我已经通过实验证明，即使 Flash（通过 Safari）发送相同的 cookie，它在连接到 XMLRPC 服务时会返回一个不同的 cookie，而不是在请求和 HTML 页面时。换句话说，Drupal 就是不支持这种同步，我被卡住了。我接受下面的答案，使我走上正轨。

编辑：在撰写本文时，AMHPHP 尚未完全针对 Drupal6 发布，但事实证明它已安装在网站上。使用[DrupalSite](http://thirdavedesign.com/drupalsite/)库，我可以非常轻松地从 flash 登录和登出站点，并且登录在 flash 和 HTML 之间保持一致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T22:57:56.670

我对 Flash 不是很熟悉，但是 URLRequest 对象是否从浏览器会话“继承”状态，包括用户登录 cookie？如果没有，您将需要在您手动构建的请求中显式发送登录 cookie，否则 Drupal 会认为它只是来自具有相同 IP 地址的另一个 Web 浏览器。

如果您不太确定，使用[Firebug](http://getfirebug.com)插件可能会很有用。它允许您检查通过浏览器传输的任何请求，检查它们的标头，并查看返回的原始 HTTP 响应对象。

*更新：比获取会话 cookie 的 Flash 小部件更重要的是获取与 Web 浏览器本身相同的会话 cookie 的 Flash 小部件。Drupal 允许用户同时从多台机器登录，因此如果浏览器正在创建一个会话而 flash 小部件正在创建另一个会话，您会看到您所描述的行为......*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T02:03:35.233

这是不可能的。

（有关详细信息，请参阅我对原始问题的最终编辑以及我对@Eaton 的评论中的等效信息。）

# java - 在 Java 中重命名线程

> ID：467224
> 
> 赞同：15
> 
> 时间：2009-01-21T22:06:46.537
> 
> 标签：java, multithreading, naming

我正在开发一个项目，该项目正在慢慢变得越来越大，并且许多不同进程使用的活动线程数量正在增加。最近，我一直在仔细查看调试器中正在运行的线程，我注意到我的很多第三方库都给他们的线程起了很差的名字——Timer-0、qtp0 等。我希望其他开发人员不熟悉使用名称不佳的线程可以立即知道正在运行的内容。

有谁知道如何重命名正在运行的线程，而不是为我们正在使用的库编写补丁？或者如果这甚至是一个好主意？任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-21T22:15:32.980

[是的，您可以使用setName()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.html#setName(java.lang.String))方法更改线程的名称。

至于这是否是一个好主意，目前尚无定论，但是除了人类可读的描述之外，依赖线程名称是一个非常糟糕的决定，而且大多数库都不会这样做。因此，如果您重命名它们，则不太可能破坏任何东西。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-09-27T06:24:54.523

**更改 Java 线程名称**

```
Thread.currentThread().setName("MyThread"); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-22T05:02:26.293

如果问题出在开源库中，那么最好的解决方案是为这些产品提供补丁，以便更好地命名线程。除非运行安全管理器，否则您可以通过枚举线程（正如其他人提到的那样）并为每个线程应用任意名称来重命名任何线程，但这是一种命名不属于您自己的线程的脆弱方式。如果第 3 方库更改了它们的命名，您将不得不更改您的代码。

我同意带有名称不佳的线程的 3rd 方库会使您更难以理解您的应用程序中正在发生的事情。但是从 3rd 方库中重命名线程是有风险的。如果他们的下一个版本改变了他们命名线程的方式会发生什么？以及如何处理根本不尝试命名线程的第 3 方库？

编辑：添加从末尾以某种方式消失的文本

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-26T05:00:16.037

我命名我创建的所有线程。我有太多的应用程序泄漏线程，或者让线程失去控制。

你越把java当作一个操作系统，它就越容易管理。:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-21T22:13:36.603

您可以使用`Thread.enumerate()`或`Thread.getAllStackTraces()`来获取正在运行的线程列表。然后，您可以调用`Thread.setName()`每个。

我不能告诉你这是否是一个好主意，但我可能倾向于“不”。您编写的代码越多，您必须维护的代码就越多。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-21T22:18:22.647

`setName()`可用于更改线程的名称，但您必须有某种方法来确定应该调用什么线程。
`getAllStackTraces()`将允许程序示例堆栈跟踪并使用类/方法/文件名作为调用线程的提示。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-17T13:25:53.533

这就引出了围绕线程命名约定的最佳实践问题。在这方面，我没有看到任何社区指导。

# rest - 使用层次结构建模 REST

> ID：467225
> 
> 赞同：3
> 
> 时间：2009-01-21T22:06:54.417
> 
> 标签：rest

如何对分层的资源进行建模？例如，假设一个人有一个“留言板”并且“消息”是一种资源。假设“消息”可以有回复，从而形成一个讨论*线程*。如何为线程的概念建模？

“消息”是否包括它的孩子？“线程”是它自己的资源吗？最后，什么样的 REST URI 可以在这种情况下工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T00:58:10.903

如果您认为对消息的所有回复也是消息，我会为每个回复提供一个 id 并使用这些 URI：

```
#message {id}  (only the message, no replies)
/messages/{id}

#replies to the {id} message (a list of the id's of the replies)
/messages/{id}/replies 
```

要创建一条新消息，请在 uri 上发帖

```
 /messages 
```

要创建对消息 {id} 的回复，请发帖到

```
/messages/{id}/replies 
```

**更新**

我将在这里修改我之前的答案。希望这次是正确的 Restful 风格。

你有一个入口点 uri，我们称之为 {messages}。

GET {messages} -> 所有消息的 uri 列表，{message1}、{message2} 等。

GET {message1} -> 响应 message1 文档，例如在 xml 中它可能是：

```
<message responses="{link to message1 responses}">
    <date>...</date>
    <body>...</body>
</message> 
```

{link to message1 response} 是客户端必须遵循的链接才能获取响应的 uri 列表。

如果一条消息是对另一个消息的响应，它将包含在他的内容中，例如

```
<message responses="{link to message1 responses}" inResponseTo="{uri}" >
    <date>...</date>
    <body>...</body>
</message> 
```

现在要添加新消息，只需将其发布到原始 {messages} uri。如果消息是对其他消息的响应，只需将其包含在其内容中（请注意，这是对您将回复发布到特殊 uri 的初始答案的有效更改）。

要修改某些消息，请对其 uri 执行 PUT。

所有uris都可以遵循答案第一部分的内容，但这不是必需的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-20T18:40:32.573

到目前为止，每个响应都不是 RESTful 的。REST 不需要是分层的。只需有一个像 /threads/ 这样的入口点，它提供每个线程资源的完整 URI，每个线程资源将使用每个消息本身的 URI，或者顶部消息加上其回复的 URI，等等。只要可以从入口点通过超文本发现这些 URI，生成这些 URI 的方式并不重要。

# asp.net-mvc - 如何轻松地向 ASP.NET-MVC 应用程序添加大量“愚蠢”的 html 页面

> ID：467232
> 
> 赞同：1
> 
> 时间：2009-01-21T22:09:59.403
> 
> 标签：asp.net-mvc

假设我正在将一大堆内容页面（愚蠢的 HTML）转换为 MVC 模型。

我想将所有纯 HTML 文件粘贴在一个目录中，并根据控制器“查找”它们。

这种似乎是标准 ASP.NET-MVC 中的“HomeController”正在做的事情，但我必须明确添加每个页面。

```
[HandleError]
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            ViewData["Title"] = "Home Page";
            ViewData["Message"] = "Welcome to ASP.NET MVC!";

            return View();
        }

        public ActionResult About()
        {
            ViewData["Title"] = "About Page";

            return View();
        }

        public ActionResult About2()
        {
            ViewData["Title"] = "About Page 2";

            return View();
        }
    } 
```

我在“Home”目录中添加了一个 About2.aspx 页面，并且必须在 HomeController 中添加一个 About2 方法以启用 URL [http://localhost:51234/Home/About2](http://localhost:51234/Home/About2)。

但是假设我有 50 个 HTML 页面，我想根据 URL 找到它们。

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T22:16:40.433

更新 global.asax 中的路由处理程序以忽略静态页面的路由。为了使这更容易，我会将它们放在单独的目录中。

```
routes.IgnoreRoute("static/myfile.htm"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T04:26:31.530

很久以前，在一个遥远的星系中，我向 Castle monorail 提交了一个补丁来实现[DefaultAction](http://www.castleproject.org/MonoRail/documentation/trunk/manual/mrattrdocs/Generated_DefaultActionAttribute.html)功能，这样做的原因是为了完成几乎完全相同的事情。不同之处在于设计人员仍然需要访问视图中的登录名等动态数据。看起来MVC Contrib 中的[ConventionController支持相同的功能。](http://www.codeplex.com/MVCContrib/Wiki/View.aspx?title=ConventionController&referringTitle=Documentation)

基本上，它允许您拥有一个在没有找到其他匹配方法时调用的方法。此方法可以查看请求并确定要呈现的视图。正如我所说，这个解决方案的美妙之处在于，设计师不需要为他们想要向用户展示的每个页面编写控制器操作方法，但他们仍然可以访问您通过模型提供给他们的可用数据。

# java - 从 JBoss 中的 servlet 访问 Spring bean

> ID：467235
> 
> 赞同：25
> 
> 时间：2009-01-21T22:11:11.553
> 
> 标签：java, spring, jakarta-ee, servlets, jboss

我想在 JBoss 中编写一个简单的 servlet，它将调用 Spring bean 上的方法。目的是允许用户通过点击 URL 来启动内部工作。

在 servlet 中获取对 Spring bean 的引用的最简单方法是什么？

JBoss Web 服务允许您使用 @Resource 注释将 WebServiceContext 注入到您的服务类中。有什么类似的东西可以在普通的 servlet 中工作吗？解决此特定问题的 Web 服务将使用大锤来粉碎坚果。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2010-03-26T12:48:33.870

有一种更复杂的方法可以做到这一点。`SpringBeanAutowiringSupport`里面有`org.springframework.web.context.support`允许你构建这样的东西：

```
public class MyServlet extends HttpServlet {

  @Autowired
  private MyService myService;

  public void init(ServletConfig config) {
    super.init(config);
    SpringBeanAutowiringSupport.processInjectionBasedOnServletContext(this,
      config.getServletContext());
  }
} 
```

这将导致 Spring 查找与之`ApplicationContext`相关的`ServletContext`（例如通过 创建`ContextLoaderListener`）并注入其中可用的 Spring bean `ApplicationContext`。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-01-21T23:07:51.237

您的 servlet 可以使用 WebApplicationContextUtils 来获取应用程序上下文，但是您的 servlet 代码将直接依赖于 Spring Framework。

另一种解决方案是配置应用程序上下文以将 Spring bean 作为属性导出到 servlet 上下文：

```
<bean class="org.springframework.web.context.support.ServletContextAttributeExporter">
  <property name="attributes">
    <map>
      <entry key="jobbie" value-ref="springifiedJobbie"/>
    </map>
  </property>
</bean> 
```

您的 servlet 可以使用从 servlet 上下文中检索 bean

```
SpringifiedJobbie jobbie = (SpringifiedJobbie) getServletContext().getAttribute("jobbie"); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-21T22:28:38.833

我找到了一种方法：

```
WebApplicationContext context = WebApplicationContextUtils.getWebApplicationContext(getServletContext());
SpringifiedJobbie jobbie = (SpringifiedJobbie)context.getBean("springifiedJobbie"); 
```

# asp.net - 在 ASP.NET 中请求后延迟操作的最佳方法是什么？

> ID：467242
> 
> 赞同：1
> 
> 时间：2009-01-21T22:12:34.653
> 
> 标签：asp.net

我正在编写一个 ASP.NET 应用程序。当处理特定类型的请求时，我想安排一个方法在处理请求后的特定分钟内调用。推迟的方法不需要与发出原始请求的客户端进行通信，它只是为了做一些“家务”工作。在 ASP.NET 上下文中执行此操作的最佳方法是什么？（如果应用程序域由于某种原因死亡，可以不触发事件）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T22:18:26.857

在检查该请求是否需要它之后，您可以从 global.asax.cs 中的一个应用程序事件（例如在 Application_BeginRequest 中）启动一个计时器（System.Timers.Timer）。

然后，在计时器的 Elapsed 事件的处理程序中，确保停止计时器。

例如，将这样的内容放入 global.asax.cs 中：

```
System.Timers.Timer _timer = null;    
void Application_BeginRequest(object sender, EventArgs e)
{
  // check if cleanup must be initiated
  bool mustInitCleanup = RequestRequiresCleanup();
  if ((_timer == null) && mustInitCleanup)
  {
    _timer = new System.Timers.Timer(5000);
    _timer.Elapsed += new System.Timers.ElapsedEventHandler(_timer_Elapsed);            
    _timer.Start();                     
  }     
}

void _timer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
{
  _timer.Stop();
  _timer = null;        
  // do cleanup task
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T22:28:59.130

在 Global.asax 中使用它来检查您的传入请求：

```
 protected void Application_BeginRequest(object sender, EventArgs e)
    {
        CheckRequest(HttpContext.Current.Request);
    } 
```

如果您的请求有效，请注册一个缓存条目：

```
 private void CheckRequest(HttpRequest request)
    {
        if (request)
            RegisterCacheEntry();
    }

    private void RegisterCacheEntry()
    {
        if (HttpRuntime.Cache[CacheItemKey] == null)
        {
            HttpRuntime.Cache.Add(CacheItemKey, "your key", null, 
                DateTime.Now.AddSeconds(60), //change to fire in whatever time frame you require
                Cache.NoSlidingExpiration, 
                CacheItemPriority.NotRemovable,
                new CacheItemRemovedCallback(CacheItemRemovedCallback));
        }
    } 
```

然后在回调中处理您的函数：

```
 private void CacheItemRemovedCallback(string key, object value, CacheItemRemovedReason reason)
    {
        // execute your function

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T22:42:00.227

只需创建一个新线程来做家务工作，并在开始时让它休眠，无论您希望服务器在执行操作之前等待多长时间。

例如，在特定请求中的某处您想调用 DoSomething：

```
 aNewThread = new Thread(Foo);
        aNewThread.Start(); 
```

* * *

```
 public void Foo()
    {
        Thread.Sleep(5000);
        DoSomething();
    } 
```

# java - 有没有办法将 Knuth shuffle 应用于 Stack 数据结构？

> ID：467244
> 
> 赞同：4
> 
> 时间：2009-01-21T22:14:04.357
> 
> 标签：java, data-structures, stack, shuffle

对于编程课，我正在为第一个家庭作业创建一个二十一点程序。教授给了我们一个示例 Card 类，其中包括将它们添加到卡片组的方法。对于她的套牌，她使用了一个 ArrayList，您可以使用 Collections.shuffle() 方法轻松地进行 Knuth Shuffle。

尽管（显然）该方法不适用于堆栈，但我认为堆栈结构最适合该程序，因为您可以将卡片弹出和推入和推出牌组。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-21T22:19:07.713

两者都[`java.util.ArrayList<E>`](http://java.sun.com/javase/6/docs/api/java/util/ArrayList.html)实现[`java.util.stack<E>`](http://java.sun.com/javase/6/docs/api/java/util/Stack.html)了[`java.util.List<E>`](http://java.sun.com/javase/6/docs/api/java/util/List.html)接口，并[`Collections.shuffle()`](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#shuffle(java.util.List))以a`java.util.List<?>`为参数。您应该能够将 a 传递给`Stack`，`Collections.shuffle()`除非您使用的是未实现的不同堆栈实现`java.util.list<E>`。如果你是，我会建议你切换到不同的堆栈实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T22:19:07.480

我想在 ArrayList 上进行堆栈操作要容易得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T22:23:25.867

堆栈是一个列表，因此您可以在堆栈上调用 Collections.shuffle()。

也就是说，Stack 是一个古老的类，就像 Vector 一样，有点过时了。现在你会使用[Dequeue](http://java.sun.com/javase/6/docs/api/java/util/Deque.html)（作为队列或堆栈工作的双端队列）而不是堆栈，**但是**，Dequeue 不是列表，所以它们不能被洗牌。

此外，您始终可以将您的卡片放入列表中，将它们洗牌，然后将它们全部添加到出列队列中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T22:18:07.013

没有理由为什么堆栈结构也不应该是随机访问的（java.util.Stack 确实如此，尽管这有其自身的问题）。除此之外，您可以将堆栈的元素弹出到 ArrayList 中，随机播放，然后将它们推回堆栈。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T22:23:23.620

不，Fisher-Yates shuffle 依赖于对数据集的随机访问。您需要一些允许 get(int index) 的 Collection。如果您需要一个堆栈，只需使用一个列表。push 和 pop 只需调用 get(0) 和 add(0)。这比实现一些自定义堆栈类要好。使用你所拥有的，不要发明新的课程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T22:29:09.630

亚当的答案最适合堆栈。对于纸牌游戏，我通常使用的是一个简单的数组列表并删除随机元素。无需改组。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T22:31:58.860

只需在将牌放入堆栈之前/时洗牌。由于正确实施的 Knuth 洗牌不允许替换已经遍历的牌组部分中的牌，因此您可以在进行时将它们简单地放入堆栈中......

由于 java 不会让您将堆栈视为随机访问列表，因此只需从堆栈复制到 ArrayList 以进行洗牌阶段（额外的 52 个元素 ArrayList 敲击没什么大不了的）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-21T23:36:24.830

Collections.shuffle() 方法为您执行此操作，您不必明确说明。

“如果指定的列表没有实现 RandomAccess 接口并且很大，则 shuffle() 的这种实现在对其进行混洗之前将指定的列表转储到一个数组中，并将经过混洗的数组转储回列表中。这避免了会导致的二次行为从将“顺序访问”列表改组到位。”

这就是 java 文档中关于 Collections.shuffle() 方法实现的内容，因此传递 java.util.Stack （java.util.List 接口的实现）应该可以工作......

# design-patterns - 域对象应该包含它的映射器吗？

> ID：467249
> 
> 赞同：2
> 
> 时间：2009-01-21T22:15:26.257
> 
> 标签：design-patterns, orm, data-mapping

给定一个域对象（例如，Person），该对象是否应该包含它的数据映射器（Person_Mapper）？

例如，我可以通过以下两种不同的方式进行停用操作：

```
$mapper = new Person_Mapper();

$person = $mapper->load(1);

$person->active = false;
$mapper->save($person); 
```

或者像这样：

```
$mapper = new Person_Mapper();

$person = $mapper->load(1);

$person->inactivate();

class Person
{
    public function inactivate()
    {
            $this->active = false;
            $this->_mapper->save($this);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T22:21:22.250

Person 类应该只知道 Person 的东西，因此不应该包含与数据映射有关的任何内容。

见[http://en.wikipedia.org/wiki/Single_responsibility_principle](http://en.wikipedia.org/wiki/Single_responsibility_principle)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T15:49:16.407

我有点不清楚 DAO 模式和 Data Mapper 模式之间的关系，但是使用 DAO，Person 对象将返回一个将非活动字段设置为 true 的传输对象，并将其交给 Person DAO 来处理的。person 对象根本不应该从持久性中知道。

# javascript - 使用 javascript 优雅地退化锚标签

> ID：467255
> 
> 赞同：1
> 
> 时间：2009-01-21T22:17:30.713
> 
> 标签：javascript, jquery, html, graceful-degradation

我目前依靠锚标记在我的 Web 应用程序上执行 AJAX 请求（使用 jQuery）。例如：

```
<script type="text/javascript">
    $(document).ready(function() {
        $("#test").click(function() {
            // Perform AJAX call and manipulate the DOM
        });
    });

    <a id="test" href="">Click me!</a>
</script> 
```

但是，如果用户在他们的浏览器中禁用了 javascript，这些锚标记几乎就变得毫无用处了。处理这些锚标记的优雅降级的最佳方法是什么？我唯一的选择是将它们全部切换到表单标签内的按钮吗？

编辑：我应该更清楚，并指定我的 AJAX 调用是对一个 URL 的 HTTP POST，出于安全原因，我不能向正常的 HTTP GET 公开（例如，考虑删除 URL“/items/delete/1”）。考虑到这一点，我不能将锚的 href 更改为“/items/delete/1”，以满足关闭 javascript 的用户，因为它会带来安全风险。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-21T22:34:58.573

一种选择（我相信我会被否决）是不要打扰那些关闭了 javascript 的人。在标签中显示一条消息，`<noscript>`通知用户您的网站需要 Javascript。

它会影响两组人：那些故意禁用 javascript 并且大概知道如何重新打开它的人，以及那些在较旧的移动设备上查看您的网站的人。

在您花费数小时为他们开发之前，请考虑这些人的重要性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T22:25:07.233

很简单，不要使用 javascript: URI 语法作为 href，至少不要在交付给客户端的 HTML 中使用。

从服务器传递 HTML 并使用 href 将用户带到您想要获取的任何页面，然后替换锚标记的 href（或捕获 onclick 事件）并做任何您想做的事情，确保防止默认操作对于事件火灾。

```
<script type="text/javascript">
    $(document).ready(function() {
        $("#test").click(function(e) {
            // Perform AJAX call and manipulate the DOM
            e.preventDefault();
        });
    });

    <a id="test" href="/Proper/URI">Click me!</a>
</script> 
```

我完全同意阅读 Unobtrusive JavaScript 的建议。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-21T22:46:06.070

我一直在寻找的答案隐藏在其中一条评论中：

> 您使用`<a>`标签执行 HTTP POST 操作是有冲突的。`<a>`专为 HTTP GET 设计。如果您将操作的语义嵌入`<a>`标签中，您将不会在这里找到满意的答案。见 [http://www.w3.org/2001/tag/doc/whenToUseGet.html](http://www.w3.org/2001/tag/doc/whenToUseGet.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T22:22:59.640

阅读[Unobtrusive JavaScript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)以了解如何将 JS 行为与您的实际标记分开。我发布的任何其他内容都只是对其他人在其他地方说得更好的话的重述

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T23:11:12.773

没有 JS 的最佳选择可能是有一个带有提交按钮的表单，并将表单的操作指向您的 URL。

您可以设置按钮的样式，使其看起来像一个链接（或其他任何东西）：

```
<button class="linkstyle" type="submit">Foo</button>
<style type="text/css">
button.linkstyle { border:none; background:none; padding:0; }
<style> 
```

Particletree 的文章中有一个很好的按钮样式示例：[重新发现按钮元素](http://particletree.com/features/rediscovering-the-button-element/)

# asp.net-mvc - ASP.NET MVC 模板应用程序中的“HomeController”是一个坏名字吗？

> ID：467262
> 
> 赞同：1
> 
> 时间：2009-01-21T22:19:04.720
> 
> 标签：asp.net-mvc

我刚刚进入 ASP.NET MVC 并且在示例应用程序中有点困惑为什么“HomeController”被称为“HomeController”。

似乎更好的名称是“DefaultController”或“ContentController”。

它确实有点误导，因为它的名字暗示它与控制主页有关，但它确实没有。

控制器的内容是这样的，它加载在“主”目录中定义的内容页面。

```
 [HandleError]
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            ViewData["Title"] = "Home Page";
            ViewData["Message"] = "Welcome to ASP.NET MVC!";

            return View();
        }

        public ActionResult About()
        {
            ViewData["Title"] = "About Page";

            return View();
        }

        public ActionResult AnotherPage()
        {
            ViewData["Title"] = "About my other page";

            return View();
        }
    } 
```

同意还是不同意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T22:30:22.997

主页在网络上无处不在（主页）。我认为默认控制器的名称是一个非常合理的选择。实际上，我更喜欢它而不是默认值或内容，因为默认值意味着有一些替代方案，并且在我看来，内容完全适用于我的所有应用程序或每个页面上呈现的特定 HTML，具体取决于上下文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T23:46:42.313

I think the name is OK. Not great. They could have done a lot worse.

This is what I would consider a "framework quirk" - Just something you have to buy into to get the good stuff (patterns/productivity/reuse/etc) from a framework.

# delphi - 为什么有时我需要重新启动 Delphi 7 才能使调试器工作

> ID：467265
> 
> 赞同：1
> 
> 时间：2009-01-21T22:19:09.837
> 
> 标签：delphi, ide, crash, debugging

每天至少 4 次我需要重新启动 Delphi 以使调试器再次在断点处停止。有时我可以通过在重建代码后附加到进程来欺骗它再次工作。但大多数时候我做不到，这让我花费了大量时间返回并重新打开我想要的所有文件。

几乎每次发生这种情况时，我在尝试关闭 Delphi 时都会遇到某种致命错误。有什么解决办法吗？我有“最新”的 Delphi 7，在 WinXP 上运行，内存充足。我办公室的大多数其他人也遇到了这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T23:37:02.050

Our experience with Delphi 7 is similar to yours: Fairly constant crashes within the IDE, with abstract errors, invalid pointer references, and exceptions in the VCL library.

It seems to depend on the complexity of the project you have loaded: Our main project is a 200,000+ line program with multiple MDI forms and third-party libraries. Virtually whenever we'd exit Delphi we'd have to deal with catastrophic fatal errors. We got very adept at using the task manager to hunt down the Delphi32 process and kill it -- virtually the only way to get out sometimes.

We've since upgraded to Delphi 2009 and it has significantly better stability. My feeling is that Delphi 7 has numerous bugs, and you will either have to live with them, or upgrade.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T22:41:05.113

调试时是正常退出程序，还是使用IDE强制调试停止/杀死应用程序？我发现使用 IDE 强制关闭应用程序会在一段时间后导致问题（通过重新启动 IDE 解决），而从应用程序内退出程序不会导致此类问题。

警告：我的经验是使用 Delphi 6。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T09:59:34.100

好的，根据我之前对这个问题的回答，这是一个示例 DSK 文件。我不能将此作为对我的回复的评论，否则我会。:-)

他们真的没什么，他们很简单，浏览一下应该可以帮助你看到这一点。我实际上建议您只需加载 Delphi，打开“自动保存桌面”选项（它在环境或编辑器中，我忘了哪个），根据需要安排 IDE（打开各种源文件等），然后保存/关闭项目。您将在项目目录中找到一个 MyProject.dsk (etc) 文件 - 只需将其设为只读（或按照您在评论中链接到的文章中的建议，并在您可以随时携带的地方制作它的备份副本需要时回来）。

无论如何，这里有一个示例 DSK，可以让您了解您正在玩什么。它们只是 INI 类型的文本文件，如果您愿意，可以在记事本中破解它们。:-)

```
[模块]
Module0=C:\Projects\GUIPlay\src\du_FrameUtils.pas
Module1=C:\Projects\GUIPlay\src\du_BaseDialogs.pas
Module2=C:\Projects\GUIPlay\src\dm_DataMain.pas
Module3=C:\Projects\GUIPlay\src\du_Main.pas
计数=4
EditWindowCount=1

[C:\Projects\GUIPlay\src\du_FrameUtils.pas]
ModuleType=SourceModule
表单状态=1
窗体顶部=0

[C:\Projects\GUIPlay\src\du_BaseDialogs.pas]
ModuleType=SourceModule
表单状态=1
窗体顶部=0

[C:\Projects\GUIPlay\src\dm_DataMain.pas]
ModuleType=SourceModule
表单状态=1
FormOnTop=1

[C:\Projects\GUIPlay\src\du_Main.pas]
ModuleType=SourceModule
表单状态=1
FormOnTop=1

[C:\Program Files\Borland\Delphi7\Projects\ProjectGroup1.bpg]
表单状态=0
窗体顶部=0

[C:\Projects\GUIPlay\src\GUIPlay.dpr]
表单状态=0
窗体顶部=0

[C:\Projects\GUIPlay\src\GUIPlay.todo]
表单状态=0
窗体顶部=0

[编辑窗口0]
观看次数=4
当前视图=2
查看0=0
视图1=1
视图2=2
视图3=3
CodeExplorer=CodeExplorer@EditWindow0
MessageView=MessageView@EditWindow0
创建=1
可见=1
状态=0
左=212
顶部=157
宽度=1127
身高=757
最大左=-1
最大顶部=-1
客户端宽度=1119
客户高度=723
左面板大小=140
LeftPanelClients=CodeExplorer@EditWindow0
LeftPanelData=0000040000000000000000000000000000000000000000000000100000000000000000C000000436F64654578706C6F726572FFFFFFFF
RightPanelSize=0
底部面板大小=0
BottomPanelClients=MessageView@EditWindow0
底部面板数据=00000400010000000B0000004D6573736167655669657700000000000000000000000000000000000100000000000000000B0000004D6576957616FFFFFFFF5766

[查看0]
模块=C:\Projects\GUIPlay\src\du_FrameUtils.pas
光标X=1
光标Y=1
顶线=1
左列=1

[查看1]
模块=C:\Projects\GUIPlay\src\du_BaseDialogs.pas
光标X=1
光标Y=1
顶线=1
左列=1

[视图2]
模块=C:\Projects\GUIPlay\src\dm_DataMain.pas
光标X=1
光标Y=1
顶线=1
左列=1

[视图3]
模块=C:\Projects\GUIPlay\src\du_Main.pas
光标X=1
光标Y=1
顶线=1
左列=1

[手表]
计数=0

[断点]
计数=0

[地址断点]
计数=0

[主窗口]
创建=1
可见=1
状态=2
左=0
顶部=0
宽度=1571
身高=143
最大左=-1
最大顶部=-1
最大宽度=1579
最大高度=143
客户端宽度=1571
客户高度=109

[专案经理]
创建=1
可见=1
状态=0
左=1188
顶部=135
宽度=345
高度=762
最大左=-1
最大顶部=-1
客户端宽度=337
客户高度=736
待定高度=305
LRDockWidth=438
可停靠=1

[对齐调色板]
创建=1
可见=0
状态=0
左=200
顶部=144
宽度=156
高度=84
最大左=-1
最大顶部=-1
客户端宽度=150
客户高度=60

[物业检查员]
创建=1
可见=1
状态=0
左=3
顶部=147
宽度=272
身高=783
最大左=-1
最大顶部=-1
客户端宽度=264
客户高度=757
待定高度=783
LRDockWidth=272
可停靠=1
拆分位置=85
排列方式=名称
SelectedItem=名称
扩展项目=
隐藏类别=

[对象树]
创建=1
可见=0
状态=0
左=0
顶部=142
宽度=190
高度=314
最大左=-1
最大顶部=-1
客户端宽度=182
客户高度=288
待定高度=314
LRDockWidth=190
可停靠=1

[CodeExplorer@EditWindow0]
创建=1
可见=1
状态=0
左=0
顶部=12
宽度=140
身高=711
最大左=-1
最大顶部=-1
客户端宽度=140
客户高度=711
待定高度=305
LRDockWidth=140
可停靠=1

[MessageView@EditWindow0]
创建=1
可见=0
状态=0
左=12
顶部=0
宽度=1107
高度=66
最大左=-1
最大顶部=-1
客户端宽度=1107
客户高度=66
待定高度=66
LRDockWidth=443
可停靠=1

[码头主机]
DockHostCount=0

```

正如您所看到的，它实际上是要重新打开的文件列表，以及对窗口位置/大小和打开文件顺序的一些了解。

祝你好运！:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T09:36:11.467

我在 D7 中也有过这种情况——但实际上只有一个特定的项目（诚然非常大，许多形式和自制的自定义组件）。其他项目（一些同样大）很好。

我的感觉是，它在某种程度上与使用从其他框架/表单子类化的框架和/或表单有关，您可以在 IDE/调试器中打开后代表单，而不是祖先表单。

因为，就像你一样，我觉得每天关闭并重新启动 IDE 六次是一种巨大的痛苦，所以我不厌其烦地为项目创建了一个 .DSK 文件，其中包含所有父表单的内容，因此当 Delphi 启动该项目时，它会“自动”打开所有其他表单。一旦我确定 DSK 的内容正确，我将 .DSK 文件设为只读...！

这意味着编辑器会“忘记”我当时打开了哪些文件，但至少它总是会自动打开所有似乎使 IDE“正常运行”的东西。如果我要在几天内处理特定的少数文件，我只需手动将它们添加到 .DSK 文件中。

我似乎记得 Delphi 会抱怨该文件是只读的，但这种方法消除了我们每天大约 80% 的痛苦。

然后我做的另一件事是让任务管理器加载，最小化，作为我系统启动的一部分。至少那时这是一个简单的 ALT-TAB 案例，可以找到可能杀死 IDE 的东西。:-)

# regex - 为什么这个 Perl 正则表达式会失败？

> ID：467267
> 
> 赞同：-1
> 
> 时间：2009-01-21T22:19:21.507
> 
> 标签：regex, perl

我有以下 Perl 代码：

```
my $progName = shift ;

open(IPLAYERLIST, "iplayer-list.html") or die "Cannot open iplayer index file iplayer-list.html\n" ;
while (<IPLAYERLIST>) {

    if ( /($progName)/is ) {
    #if ( /Just A Minute/is ) { <-- This works!
        my $iplayerID = $1 ;
        print "IPlayer program id for $progName is $iplayerID\n" ;

        #  === do stuff here ===
    }
    else
    {
        print "Failed to match $progName in $_\n";
    }
} 
```

IPLAYERLIST 是一个 BBC IPlayer 列表，因此它正在搜索特定的程序名称。

如果我用 调用`$progName = "Just A Minute"`它，即使字符串在文件中，它也无法匹配。如果我用单个字符（例如“M”）调用它，那么它会成功。如果我用`$progName`常量字符串（“Just A Minute”）替换变量，那么它会成功。当它打印时，`$progName`它总是打印正确的字符串，所以我看不出正则表达式有什么不同。

我已剪切代码并将其粘贴到测试脚本中：

```
#!/usr/bin/perl
use strict ;

my $searchstr = "foo bar Just A Minute baz boo" ;
my $progName = $ARGV[0] ;
print "searching for [$progName] in [$searchstr]\n" ;
if ( $searchstr =~ /$progName/is ) {
    print "Well the test worked\n" ;
} else {
    print "Failed to match [$progName] in [$searchstr]\n";
} 
```

这很好用。那么为什么第一个示例在包含“Just A Minute”的文件中找不到“Just A Minute”？！？！？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T22:41:07.827

你的程序（第一个）对我来说很好。

请注意，您必须引用参数 sting（因为它包含空格），否则您只是在寻找与“Just”匹配的内容。所以像这样运行它......

perl yourprog.pl "只需一分钟"

我用这个输入文件运行它：

```
Foo
Just A Minute
Bar 
```

哪个输出...

```
Failed to match Just A Minute in Foo

IPlayer program id for Just A Minute is Just A Minute
Failed to match Just A Minute in Bar 
```

注意 Foo 和 Bar 行之后的空白行。那是因为您没有从从文件中读取的行中删除换行符。所以“Foo\n”和“Bar\n”的末尾有一个“\n”，它会打印在输出中。但这并不影响匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T22:35:44.890

您的示例似乎没有任何问题。它在我的测试中运行良好。

您能否给我们您看到的完整错误输出，如“无法匹配 Y 中的 X”输出？

我唯一能想到的`$progName`就是没有设置正确的值。看到完整的错误输出将排除这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T22:41:40.867

检查您的 html 文件。

我跑了以下

```
my $progName = shift ;

open(IPLAYERLIST, "list.txt") or die "Cannot open iplayer index file\n" ;
while (<IPLAYERLIST>) {

        if ( /($progName)/is ) {
        #if ( /Just A Minute/is ) { <-- This works!
                my $iplayerID = $1 ;
                print "IPlayer program id for $progName is $iplayerID\n" ;

                #  === do stuff here ===
        }
        else
        {
                print "Failed to match $progName in $_\n";
        }
} 
```

使用以下文件`list.txt`：

```
egg
spam
foo bar Just A Minute baz boo
egg spam Just A Minute spam egg
foo
bar 
```

它似乎有效，输出`perl prog.pl "just a minute"`为

```
Failed to match just a minute in egg

Failed to match just a minute in spam

IPlayer program id for just a minute is Just A Minute
IPlayer program id for just a minute is Just A Minute
Failed to match just a minute in foo

Failed to match just a minute in bar 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T23:40:07.253

I will try to post a better test with results etc tomorrow. I will need to extract the function and wrap it first. Right now it is time for bed!

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T01:08:15.813

如果您的列表是 HTML 格式，您如何保证您在浏览器中看到的“Just A Minute”实际上是源代码中的“Just A Minute”？

它可能是

```
Just    A    Minute (extra spaces)
Just  
A  
Minute
Just <!--comment-->A Minute
Just[the nbsp entity]A Minute 
```

等等等等。

向我们展示 HTML。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-23T08:54:10.537

我将整个函数提取到一个测试程序中，它运行得很好！在我重新发布这个问题之前，我将不得不花一些时间来隔离这个问题。目前看来我必须发布整个 700 行程序，以及支持文件和说明以允许人们对其进行测试，这超出了 stackoverflow 的范围。

--- 阿利斯泰尔。

# .net - System.Guid.NewGuid() 有多随机？

> ID：467271
> 
> 赞同：54
> 
> 时间：2009-01-21T22:20:24.390
> 
> 标签：.net, random, guid

我知道这听起来像是一个毫无意义的问题，但请听我说...

我基本上想知道我是否可以信任 GUID 生成一个 100% 的时间唯一且无法预测的值。

我基本上是在为一个网站滚动我的登录系统，并想知道 GUID 对于会话 cookie 是否足够安全。

在评估答案时，将非常感谢任何有关如何生成 GUID 的背景。

**感谢您提供重复问题的链接，但是，我的问题特定于 .Net 框架。**

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-21T22:23:43.120

[这是Raymond Chen的精彩细分](https://devblogs.microsoft.com/oldnewthing/20080627-00/?p=21823)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-21T22:25:06.237

没有固定长度的值可以保证 100% 唯一（只要调用它足够多次，给予或接受宇宙结局；-p） - 但它可能非常、非常、非常不可能复制。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-21T22:25:08.343

我不能说序列号的可预测性，但它会是独一无二的。不过，我认为您最好使用 System.Security.Cryptography 中的随机数生成器。将随机数与单调递增的值（时间）联系起来以生成您的唯一密钥，您可以确定它是唯一的且不可预测的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-22T00:51:46.800

System.Guid.NewGuid() 的文档不保证随机性，因此虽然当前的实现基于随机数生成器（它是算法的第 4 版，它是在使用 MAC 的第 1 版出现隐私问题后设计的地址；其他系统（例如 Apple 的 OS X）仍使用该算法的版本 1）。

因此，虽然 System.Guid.NewGuid() 生成唯一值的概率非常高，但您不能对其可预测性做出任何假设，因为文档中没有指定。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-21T22:25:14.987

我不知道 .NET，但[UUID 算法](http://en.wikipedia.org/wiki/UUID)的定义相当精确。

编辑：如果您查看适当的位（请参阅维基百科条目），那应该解释正在使用哪个版本的 UUID。

编辑2：您使用“安全”一词的危险信号，它告诉我您最好使用定义明确的加密方法。例如，当在服务器上生成会话 ID 时，为什么不做一些简单的事情，比如将 MD5 哈希应用于以下适当子集的连接：{客户端计算机 IP 地址、顺序递增的计数器、您选择的固定秘密常量、您选择的随机数生成器的输出等} ?

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-21T22:26:01.210

假设 System.Guid.NewGuid 使用 CoCreateGuid，它根本不是随机的。从历史上看，用于创建 guid 的算法是结合来自网络适配器的 MAC 地址，以及时间等其他一些内容。我不确定算法是否已经改变。虽然它肯定不是随机的，但它保证是唯一的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-02-27T17:21:01.183

> 我基本上想知道我是否可以信任 GUID 生成一个**100% 的时间唯一且无法预测**的值。
> 
> 我基本上是在为一个网站滚动我的登录系统，并想知道*GUID 对于会话 cookie 是否足够安全*。

简短的回答：**根本没有**。需要注意的是，*唯一*性和*随机性*是完全不同的。如果你有一个通用计数器（比如在熟食店取一个数字），这些数字是独一无二的，但完全可以预测。

正如 Bochu 上面所说，Raymond 的帖子在这里谈到了它： [https ://blogs.msdn.microsoft.com/oldnewthing/20120523-00/?p=7553/](https://blogs.msdn.microsoft.com/oldnewthing/20120523-00/?p=7553/)

> GUID 生成算法是为唯一性而设计的。**它不是为随机性或不可预测性而设计的。**确实，如果您查看之前的讨论，您会发现所谓的算法 1 是非随机的且完全可预测的。...即使是第 4 版 GUID 算法（基本上说“将版本设置为 4 并用随机或伪随机数填充其他所有内容”）也不能保证是不可预测的，因为该算法没有指定随机数的质量数发生器。

对于安全随机数，您需要一个加密安全的随机数生成器。

顺便说一句，“滚动我自己的登录系统”是一个安全危险信号——如果我没有指出这一点，我就会失职。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-21T22:25:02.413

根据定义，GUID 在所有方面都是唯一的。曾几何时，有一些生成顺序 GUID 的 GUID0 生成例程，但这些都是...... Win98 中的问题，我认为，并且由 Microsoft 修复。

您应该能够相信生成的 GUID 是唯一的，并且永远不会重复或重新生成。

（编辑：话虽如此，我们都知道，如果字符串长度固定，则字母数字字符串具有固定数量的排列。但在 GUID 的情况下，排列的数量是经济的*。）

（*该死，XKCD 的提议“天文”数字在哪里还不够大？）

# .net - How do I map a one-to-one association with NHibernate using foreign key generator?

> ID：467276
> 
> 赞同：0
> 
> 时间：2009-01-21T22:20:57.227
> 
> 标签：.net, nhibernate, orm, foreign-keys

So far the association works fine (the `User` class loads the appropriate `UserRoles` instance when present), but when creating a new `User` and setting its `Roles` property to a new instance of `UserRoles`, the `UserRoles` object is not saved.

Here is my abridged User.hbm.xml:

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class name="DistrictObservations.User, DistrictObservations" table="users">
    <cache usage="read-write" region="all" />

    <id name="ID" column="id" type="int" unsaved-value="0">
      <generator class="identity" />
    </id>

    <!-- snip -->

    <one-to-one name="Roles" class="DistrictObservations.UserRoles, DistrictObservations" lazy="false" />

  </class>
</hibernate-mapping> 
```

And here is the UserRoles mapping:

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class name="DistrictObservations.UserRoles, DistrictObservations" table="user_roles">
    <cache usage="read-write" region="all" />

    <id name="UserID" column="user_id" type="int" >
      <generator class="foreign">
        <param name="property">User</param>
      </generator>
    </id>

    <!-- snip -->

    <one-to-one name="User" class="DistrictObservations.User, DistrictObservations" lazy="false" constrained="true" foreign-key="FK_user_roles_users" />

  </class>
</hibernate-mapping> 
```

Anyone got an idea how to have the UserRoles object saved with the User.ID as its primary key? I've been looking at the documentation, and to be honest, it is not particularly helpful.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T01:19:57.537

通常你不需要一对一的，除非你被一个不可变的遗留数据库模式困住了。大多数用户-角色映射允许用户具有多个角色，并且角色可以被任意数量的用户使用，这意味着用于多对多关联的关联表。

如果您的应用程序只需要每个用户一个角色，那么我建议将 RoleId 作为 FK 直接放在 Users 表中。

话虽如此，如果您出于某种原因坚持一对一，请确保在不会进行更新的那个（“子”实体）上使用 inverse="true"。（有关 inverse 属性的更多信息，请参阅 Hibernate 一对一文档——它应该对此进行足够的解释。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T22:34:39.853

我可能遗漏了一些东西，但是您需要在 User 和 UserRoles 之间建立一对一的关系吗？你不能在用户和角色之间建立一对多的关系吗？UserRoles 似乎是多余的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T00:15:21.973

我发现很少需要一对一的映射。我通常认为的一对一映射通常是一对多映射。两个表上的主键值相同并不常见。

从类名的外观来看，您似乎正在尝试将角色与用户相关联？在我看来，这不像是一对一的。

也就是说，看起来外国类的生成器应该做你需要的。

# java - JPA/Hibernate 最大连接数？

> ID：467282
> 
> 赞同：3
> 
> 时间：2009-01-21T22:22:43.213
> 
> 标签：java, hibernate, jpa, join

JPA/Hibernate 查询中允许的连接数是否有限制？

由于 Hibernate[不会自动加入](http://www.hibernate.org/118.html#A23)，因此我必须在 JPA/Hibernate 查询中明确指定联接。例如，人有地址，地址有状态。以下查询检索地址和状态已满载的人员：

```
select p, a, s from person p left join p.address a left join a.state s where ... 
```

随着我不断添加连接，我最终（在 12-13 个左连接之后）达到了 Hibernate 生成无效 SQL 的限制：

```
Caused by: java.sql.SQLException: Column 'something69_2_' not found. 
```

我确实为我的数据库实现 MySQL 设置了 Hibernate 的方言：

```
<property name="hibernate.dialect">org.hibernate.dialect.MySQLInnoDBDialect</property> 
```

Hibernate 在单个查询中可以处理的连接数是否有限制？

**编辑1：**日志文件中包含以下内容：

```
could not read column value from result set: something69_2_; Column 'something69_2_' not found. 
```

但是，`something69_2_`不会出现在 SQL 查询中。这就像 Hibernate 生成了一个 SQL 查询并期望`something69_2_`在结果中，但事实并非如此。

**编辑 2：**类似问题记录为未修复的[Hibernate 错误 HHH-3035](http://opensource.atlassian.com/projects/hibernate/browse/HHH-3035)

**编辑 3：**这是一个记录在案的[Hibernate 错误 HHH-3636](http://opensource.atlassian.com/projects/hibernate/browse/HHH-3636)，已修复但尚未包含在任何版本中。

**编辑 4：**我构建了 hibernate-core 3.3.2-SNAPSHOT，其中包括错误修复 HHH-3636，但它没有解决这个问题。

**编辑 5：**错误行为似乎是由`LEFT JOIN FETCH`ManyToMany 或 OneToMany 关系上的多个触发的。一个会起作用，两个或三个会导致错误。

**编辑 6：**这是堆栈跟踪：

```
javax.persistence.PersistenceException: org.hibernate.exception.SQLGrammarException: could not execute query
        at org.hibernate.ejb.AbstractEntityManagerImpl.throwPersistenceException(AbstractEntityManagerImpl.java:629)
        at org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:73)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute query
        at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:67)
        at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)
        at org.hibernate.loader.Loader.doList(Loader.java:2214)
        at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2095)
        at org.hibernate.loader.Loader.list(Loader.java:2090)
        at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:388)
        at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:338)
        at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:172)
        at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1121)
        at org.hibernate.impl.QueryImpl.list(QueryImpl.java:79)
        at org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:64)
        ... 69 more
Caused by: java.sql.SQLException: Column 'something69_2_' not found.
        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1055)
        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:956)
        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:926)
        at com.mysql.jdbc.ResultSetImpl.findColumn(ResultSetImpl.java:1136)
        at com.mysql.jdbc.ResultSetImpl.getInt(ResultSetImpl.java:2777)
        at org.hibernate.type.IntegerType.get(IntegerType.java:28)
        at org.hibernate.type.NullableType.nullSafeGet(NullableType.java:113)
        at org.hibernate.type.NullableType.nullSafeGet(NullableType.java:102)
        at org.hibernate.loader.Loader.getKeyFromResultSet(Loader.java:1088)
        at org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:553)
        at org.hibernate.loader.Loader.doQuery(Loader.java:689)
        at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:224)
        at org.hibernate.loader.Loader.doList(Loader.java:2211)
        ... 77 more 
```

**编辑 7：**所有这些连接的原因是为了避免 Hibernate 执行 n+1 查询，请参阅[Hibernate FAQ 关于如何在运行 Hibernate 查询时避免 n+1 SQL SELECT 查询？](http://www.hibernate.org/118.html#A23)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T22:14:01.550

我曾经使用 Hibernate 达到 MySQL 5.0 61 表的限制：

```
ERROR 1116 (HY000)：表太多；MySQL 在一个连接中只能使用 61 个表
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T22:04:12.533

问题是您为什么首先尝试进行如此复杂的查询？

您是否考虑过不同的方法？关于[提高性能](http://www.hibernate.org/hib_docs/v3/reference/en-US/html/performance.html)的文档提出了一些建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T22:26:57.900

Hibernate 代码中没有限制连接数量的内容。这可能是方言中的错误，也可能是数据库引擎的限制。但是我的钱花在了一个与加入数量无关的错误上！您是否尝试过在交互式查询会话中直接运行 SQL？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T16:36:55.270

您是否尝试过使用实际使用的 jdbc 驱动程序执行？可能是 jdbc 驱动的问题。

虽然从列的名称来看，它正在寻找，我猜名称的一些修剪/构造出错了。绝对看起来更像是一个错误而不是预期的限制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T15:03:49.433

*您是否正在为所有*内部连接起别名？并使用这些别名？当您尝试在子句中使用隐式别名来执行以下操作时，我已经看到 Hibernate 的一些非常奇怪的行为`SELECT`（极其简化的示例）：

```
select p.address.state from person p 
```

但是，如果您明确声明所有别名，它就可以正常工作。像这样：

```
select s from person p join p.address a join a.state s 
```

...甚至是这个：

```
select s from person p join p.address.state s 
```

# web-services - Spring Web 服务中的 Hibernate 会话处理

> ID：467290
> 
> 赞同：1
> 
> 时间：2009-01-21T22:24:56.283
> 
> 标签：web-services, hibernate, spring, spring-ws

我正在使用带有 Jaxb2Marshaller、PayloadRootAnnotationMethodEndpointMapping 和 GenericMarshallingMethodEndpointAdapter 的 spring-ws 通过 @Endpoint 和 @PayloadRoot 注释配置我的 Web 服务。

当我尝试使用我的项目的 DAO 时，我能够从数据库中加载对象，但是当我尝试访问服务中应该延迟加载的属性时，我得到一个 org.hibernate.LazyInitializationException - 无法初始化代理 -没有会话。

在我的 spring-mvc Web 应用程序中，OpenSessionInViewInterceptor 处理会话。如何配置我的 Web 服务项目以自动为每个 Web 服务调用创建 Hibernate 会话？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T22:41:19.947

将 org.springframework.aop.framework.ProxyFactoryBean 包裹在需要存在休眠会话的 spring 上下文中的对象周围。

这篇文章[http://springtips.blogspot.com/2007/06/spring-and-hibernate.html](http://springtips.blogspot.com/2007/06/spring-and-hibernate.html)展示了如何做到这一点。

如果您在以这种方式使用会话时由于延迟加载集合而遇到问题，则至少有 2 个可能的修复方法：

*   在可用 Hibernate 会话执行的代码中向集合添加 Hibernate.initialize() 调用 - [http://www.hibernate.org/hib_docs/v3/api/org/hibernate/Hibernate.html#initialize(java.语言.对象）](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/Hibernate.html#initialize(java.lang.Object))
*   通过在映射中添加lazy="false" 来使用非惰性集合 - 使用此选项时要小心，您可以通过几个放置不当的lazy="false" 选项轻松强制休眠加载整个数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T09:21:56.663

与此同时，我找到了解决方案。这个论坛条目给了我提示：

[http://forum.springframework.org/showthread.php?t=50284](http://forum.springframework.org/showthread.php?t=50284)

基本上，我将@Transactional 注释添加到我的Web 服务实现类中。棘手的部分是告诉 spring 使用我通过使用以下配置实现的原始类（不是由 tx:annotation-driven 创建的代理）：

```
<bean class="org.springframework.ws.server.endpoint.mapping.PayloadRootAnnotationMethodEndpointMapping" >
    <property name="order" value="1" />
</bean>

<tx:annotation-driven mode="proxy" order="200" proxy-target-class="true" /> 
```

配置语句的顺序似乎也很重要。

# c++ - 如何在 Visual Studio 2008 Express（无 ATL 类）中使用 msxml 而不会变得疯狂？

> ID：467300
> 
> 赞同：6
> 
> 时间：2009-01-21T22:25:31.023
> 
> 标签：c++, xml, visual-studio-2008, msxml

这不是一个真正的问题，因为我已经找到了解决方案。我花了很多时间，这就是为什么我想在这里解释一下。

Msxml 基于 COM，因此在 C++ 中使用它并不容易，即使您有有用的类来处理内存分配问题。但是编写一个新的 XML 解析器要困难得多，所以我想使用 msxml。

**问题：**

我能够在 Internet 上找到足够的示例来使用 msxml，借助`CComPtr`（智能指针避免必须手动为每个 IXMLDOMNode 调用 Release()）、`CComBSTR`（将 C++ 字符串转换为字符串的 COM 格式）和`CComVariant`. 这 3 个有用的类是 ATL 类，需要一个`#include <atlbase.h>`.

问题：Visual Studio 2008 Express（免费版）不包括 ATL。

**解决方案：**

使用`comutil.h`and `comdef.h`，其中包括一些简单的辅助类：

*   `_bstr_t`或多或少地替换`CComBSTR`
*   `_variant_t`或多或少地替换`CComVariant`
*   `_com_ptr_t``CComPtr`通过使用间接替换`_COM_SMARTPTR_TYPEDEF`

**小例子：**

```
#include <msxml.h>
#include <comdef.h>
#include <comutil.h>

// Define some smart pointers for MSXML
_COM_SMARTPTR_TYPEDEF(IXMLDOMDocument,     __uuidof(IXMLDOMDocument));     // IXMLDOMDocumentPtr
_COM_SMARTPTR_TYPEDEF(IXMLDOMElement,      __uuidof(IXMLDOMElement));      // IXMLDOMElementPtr
_COM_SMARTPTR_TYPEDEF(IXMLDOMNodeList,     __uuidof(IXMLDOMNodeList));     // IXMLDOMNodeListPtr
_COM_SMARTPTR_TYPEDEF(IXMLDOMNamedNodeMap, __uuidof(IXMLDOMNamedNodeMap)); // IXMLDOMNamedNodeMapPtr
_COM_SMARTPTR_TYPEDEF(IXMLDOMNode,         __uuidof(IXMLDOMNode));         // IXMLDOMNodePtr

void test_msxml()
{
    // This program will use COM
    CoInitializeEx(NULL, COINIT_MULTITHREADED);

    {
        // Create parser
        IXMLDOMDocumentPtr pXMLDoc;
        HRESULT hr = CoCreateInstance(__uuidof (DOMDocument), NULL, CLSCTX_INPROC_SERVER, IID_IXMLDOMDocument, (void**)&pXMLDoc);
        pXMLDoc->put_validateOnParse(VARIANT_FALSE);
        pXMLDoc->put_resolveExternals(VARIANT_FALSE);
        pXMLDoc->put_preserveWhiteSpace(VARIANT_FALSE);

        // Open file
        VARIANT_BOOL bLoadOk;
        std::wstring sfilename = L"testfile.xml";
        hr = pXMLDoc->load(_variant_t(sfilename.c_str()), &bLoadOk);

        // Search for node <testtag>
        IXMLDOMNodePtr pNode;
        hr = pXMLDoc->selectSingleNode(_bstr_t(L"testtag"), &pNode);

        // Read something
        _bstr_t bstrText;
        hr = pNode->get_text(bstrText.GetAddress());
        std::string sSomething = bstrText;
    }

    // I'm finished with COM
    // (Don't call before all IXMLDOMNodePtr are out of scope)
    CoUninitialize();
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-21T22:40:37.280

也许尝试使用该`#import`语句。

我已经在我闲逛的一个 VS6 项目中使用它，你做这样的事情（仅用于说明目的；这对我有用，但我不声称是防错的）：

```
#import  "msxml6.dll"

  ...

MSXML2::IXMLDOMDocument2Ptr pdoc;
HRESULT hr = pdoc.CreateInstance(__uuidof(MSXML2::DOMDocument60));
if (!SUCCEEDED(hr)) return hr;

MSXML2::IXMLDOMDocument2Ptr pschema;
HRESULT hr = pschema.CreateInstance(__uuidof(MSXML2::DOMDocument60));
if (!SUCCEEDED(hr)) return hr;

pschema->async=VARIANT_FALSE;
VARIANT_BOOL b;
b = pschema->loadXML(_bstr_t( /* your schema XML here */ ));

MSXML2::IXMLDOMSchemaCollection2Ptr pSchemaCache;
hr = pSchemaCache.CreateInstance(__uuidof(MSXML2::XMLSchemaCache60));
if (!SUCCEEDED(hr)) return hr;

_variant_t vp=pschema.GetInterfacePtr();
pSchemaCache->add(_bstr_t( /* your namespace here */ ),vp); 

pdoc->async=VARIANT_FALSE;
pdoc->schemas = pSchemaCache.GetInterfacePtr();
pdoc->validateOnParse=VARIANT_TRUE;
if (how == e_filename)
    b = pdoc->load(v);
else
    b = pdoc->loadXML(bxmldoc);

pXMLError = pdoc->parseError;
if (pXMLError->errorCode != 0)
    return E_FAIL; // an unhelpful return code, sigh.... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T22:36:55.730

另一种选择是使用另一个已经完成的 XML 解析器，[例如 eXpat](http://expat.sourceforge.net/)。它避免了必须使用 ATL 和 COM 的复杂性，并且比实现自己的要容易得多。我建议这样做只是因为您已经说过您查看 msxml 的原因是因为您不想实现自己的解析器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T01:17:05.640

您可以使用 TinyXML。它是开源的，并且更独立于平台。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T19:28:33.190

我很高兴我发布了我的问题，尽管我已经有了一个解决方案，因为我有几个替代解决方案。感谢您的所有回答。

使用另一个解析器，如[eXpat](http://expat.sourceforge.net/)或可能更小的（不是那么强大，但足以满足我的需要）[TinyXML](http://www.grinninglizard.com/tinyxml)实际上可能是一个好主意（并且可以更容易地将程序移植到另一个操作系统）。

使用[`#import`](http://msdn.microsoft.com/en-us/library/8etzzkb6%28VS.80%29.aspx)指令，显然是微软特定的扩展来简化 COM 的使用，也很有趣，并把我带到了下面的网页[`MSXML in C++ but as elegant as in C#`](http://blogs.microsoft.co.il/blogs/davids/archive/2008/12/24/msxml-in-c-but-as-elegant-as-in-c-part-3.aspx)，它解释了如何尽可能简化 msxml 的使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T23:00:09.503

为什么不使用一些 MSXML 包装器来保护您形成 COM，例如[Arabica](http://sourceforge.net/projects/arabica/)？

# c# - C# 中的 ++i 和 i++ 之间是否存在性能差异？

> ID：467322
> 
> 赞同：53
> 
> 时间：2009-01-21T22:33:12.880
> 
> 标签：c#, operators, performance

使用类似的东西之间是否有任何性能差异

```
for(int i = 0; i < 10; i++) { ... } 
```

和

```
for(int i = 0; i < 10; ++i) { ... } 
```

或者编译器是否能够以在功能相同的情况下同样快的方式进行优化？

编辑：之所以问这个问题是因为我与一位同事讨论过它，而不是因为我认为它在任何实际意义上都是有用的优化。它主要是学术性的。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-22T03:19:29.027

在这种情况下，生成的 ++i 和 i++ 中间代码没有区别。鉴于此程序：

```
class Program
{
    const int counter = 1024 * 1024;
    static void Main(string[] args)
    {
        for (int i = 0; i < counter; ++i)
        {
            Console.WriteLine(i);
        }

        for (int i = 0; i < counter; i++)
        {
            Console.WriteLine(i);
        }
    }
} 
```

两个循环生成的 IL 代码相同：

```
 IL_0000:  ldc.i4.0
  IL_0001:  stloc.0
  // Start of first loop
  IL_0002:  ldc.i4.0
  IL_0003:  stloc.0
  IL_0004:  br.s       IL_0010
  IL_0006:  ldloc.0
  IL_0007:  call       void [mscorlib]System.Console::WriteLine(int32)
  IL_000c:  ldloc.0
  IL_000d:  ldc.i4.1
  IL_000e:  add
  IL_000f:  stloc.0
  IL_0010:  ldloc.0
  IL_0011:  ldc.i4     0x100000
  IL_0016:  blt.s      IL_0006
  // Start of second loop
  IL_0018:  ldc.i4.0
  IL_0019:  stloc.0
  IL_001a:  br.s       IL_0026
  IL_001c:  ldloc.0
  IL_001d:  call       void [mscorlib]System.Console::WriteLine(int32)
  IL_0022:  ldloc.0
  IL_0023:  ldc.i4.1
  IL_0024:  add
  IL_0025:  stloc.0
  IL_0026:  ldloc.0
  IL_0027:  ldc.i4     0x100000
  IL_002c:  blt.s      IL_001c
  IL_002e:  ret 
```

也就是说，JIT 编译器有可能（尽管极不可能）可以在某些上下文中进行一些优化，从而使一个版本优于另一个版本。但是，如果有这样的优化，它可能只会影响循环的最终（或者可能是第一次）迭代。

简而言之，您描述的循环结构中控制变量的简单预增量或后增量的运行时间没有区别。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-22T03:31:49.270

如果你问这个问题，你是在试图解决错误的问题。

要问的第一个问题是“如何通过提高软件运行速度来提高客户对软件的满意度？” 答案几乎从不“使用 ++i 而不是 i++”，反之亦然。

来自 Coding Horror 的帖子“[硬件很便宜，程序员很贵](http://www.codinghorror.com/blog/archives/001198.html)”：

> 优化规则：
> 规则 1：不要这样做。
> 规则 2（仅适用于专家）：暂时不要这样做。
> ——[马杰克逊](http://en.wikipedia.org/wiki/Michael_A._Jackson)

我读到规则 2 的意思是“首先编写满足客户需求的干净、清晰的代码，然后在速度太慢的地方加快速度”。`++i`vs.不太可能`i++`成为解决方案。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-22T00:05:41.713

啊……又开了。好的。这是交易。

ILDASM 是一个开始，但不是结束。关键是：JIT 将为汇编代码生成什么？

这就是你想要做的。

拿几个你想看的样本。显然，如果您愿意，您可以对它们进行挂钟计时 - 但我假设您想知道的不仅仅是这些。

这是不明显的。C# 编译器会生成一些 MSIL 序列，这些序列在很多情况下都不是最优的。它调整为处理这些和其他语言的怪癖的 JIT。问题：只有有人注意到的“怪癖”被调整了。

您真的想制作一个示例，让您的实现可以尝试，返回到 main（或任何地方）、Sleep() 或您可以附加调试器的地方，然后再次运行例程。

您不想在调试器下启动代码，否则 JIT 将生成未优化的代码 - 听起来您想知道它在真实环境中的行为方式。JIT 这样做是为了最大化调试信息并最小化当前源位置的“跳来跳去”。永远不要在调试器下启动性能评估。

好的。因此，一旦代码运行一次（即：JIT 已为其生成代码），然后在睡眠期间附加调试器（或其他）。然后查看为这两个例程生成的 x86/x64。

我的直觉告诉我，如果您按照您的描述使用 ++i/i++ - 即：在不重复使用右值结果的独立表达式中 - 不会有区别。但是，去发现并查看所有整洁的东西会不会很有趣！:)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-22T06:07:53.120

正如 Jim Mischel[所示](https://stackoverflow.com/questions/467322/is-there-any-performance-difference-between-i-and-i-in-c#467944)，编译器将为两种编写 for 循环的方式生成相同的 MSIL。

但就是这样：没有理由推测 JIT 或执行速度测量。如果两行代码生成相同的 MSIL，它们不仅执行相同，而且实际上是相同的。

任何可能的 JIT 都无法区分循环，因此生成的机器代码也必须相同。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-22T00:29:26.360

有一段具体的代码和 CLR 版本吗？如果是这样，对其进行基准测试。如果没有，那就算了。微优化等等……此外，您甚至不能确定不同的 CLR 版本会产生相同的结果。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-22T06:30:20.360

除了其他答案之外，*如果您`i`的不是`int`*. **在 C++**中，如果它是具有运算符`++()`和`++(int)`重载的类的对象，那么它可能会产生影响，并且可能会产生副作用。在这种情况下，性能`++i` *应该*更好（取决于实现）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T22:38:28.113

根据[这个答案](https://stackoverflow.com/questions/437026/in-c-what-is-the-difference-between-myint-and-myint#437123)，i++ 使用的 CPU 指令比 ++i 多。但这是否会导致性能差异，我不知道。

由于任何一个循环都可以很容易地重写为使用后增量或前增量，我猜编译器将始终使用更有效的版本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-22T00:50:29.267

```
 static void Main(string[] args) {
     var sw = new Stopwatch(); sw.Start();
     for (int i = 0; i < 2000000000; ++i) { }
     //int i = 0;
     //while (i < 2000000000){++i;}
     Console.WriteLine(sw.ElapsedMilliseconds); 
```

3 次运行的平均值：
对于使用 i++：1307 对于使用 ++i：1314

使用 i++ 时：1261 使用 ++i 时：1276

那是 2,53 Ghz 的赛扬 D。每次迭代大约需要 1.6 个 CPU 周期。这要么意味着 CPU 每个周期执行超过 1 条指令，要么意味着 JIT 编译器展开了循环。i++ 和 ++i 之间的差异仅为每次迭代 0.01 个 CPU 周期，可能是由后台的 OS 服务造成的。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-11-04T16:27:34.167

两者之间没有区别，原因是循环比较是在递增/递减语句之后的单独语句。例子 ;

```
for(int i=0; i<3; i++){
    System.out.println(i)
} 
```

这如下所示，

步骤初始化：`i = 0`

Step Compare :`i < 3`为真则执行`loop`块

步进增量：`i = i++;`或`i = ++i;`

Step Copmare Again : 由于 Java 在下一步中进行比较。i++ 和 ++i 都给出相同的结果。例如，如果 i = 0，则递增后 i 将变为 1。

这就是为什么前增量或后增量在循环中的行为相同的原因。

# java - Spring JdbcTemplate 和线程

> ID：467324
> 
> 赞同：4
> 
> 时间：2009-01-21T22:33:31.010
> 
> 标签：java, multithreading, swing, jdbc, spring-jdbc

`JdbcTemplate`在 Swing 中使用 a 分叉线程以执行插入是否安全？

这是一个日志事件，我尽可能不希望它影响感知性能。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-02-27T04:23:33.607

另请注意，它的线程安全性[在 Spring 3.1 参考文档中得到了很好的解释](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/jdbc.html#jdbc-JdbcTemplate-idioms)：

**13.2.1.2 JdbcTemplate 最佳实践**

> JdbcTemplate 类的实例在配置后是线程安全的。这很重要，因为这意味着您可以配置 JdbcTemplate 的单个实例，然后安全地将这个共享引用注入到多个 DAO（或存储库）中。JdbcTemplate 是有状态的，因为它维护对 DataSource 的引用，但这种状态不是会话状态。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-21T23:36:58.307

[这个](http://forum.spring.io/forum/spring-projects/data/16972-jdbctemplate-thread-safety)来自 Spring 论坛的答案是 yes.t=25965

JdbcTemplate 是一个单例，一旦设置就不会改变状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T22:40:24.490

为什么你会认为它不会？

我没有`JdbcTemplate`直接从 Swing 中使用过，但我有几个 Web 应用程序（每个请求都有一个单独的线程），而且我从来没有遇到过任何线程问题。在这种情况下，模板在应用程序启动时配置一次，并使用不同的参数重复调用。

如果您担心线程问题，您可以随时为每个日志线程创建一个新模板...

# c++ - 升级到 SQL Server 2005：无法将 QNAN 插入浮点列？

> ID：467327
> 
> 赞同：2
> 
> 时间：2009-01-21T22:33:57.653
> 
> 标签：c++, sql-server-2005, sqlncli

**背景：**
我正在从 SQL Server 2000 迁移到 SQL Server 2005。这是为使用 SQL Native Client 通过 ODBC 与 SQL Server 通信的 C++ 应用程序提供 DB 服务。

**问题：**
我正在尝试将 QNAN 插入数据库中的浮点列。在我的应用程序中，此值存储为双精度值（值：1.#QNAN00000000000）并作为参数发送到数据库中。这在 SQL Server 2000 中不是问题，但相同的代码在 SQL Server 20005 中给了我以下错误：

> 传入的表格数据流 (TDS) 远程过程调用 (RPC) 协议流不正确。参数 3 ("")：提供的值不是浮点数据类型的有效实例。检查源数据中的无效值。无效值的一个示例是小数位数大于精度的数值类型数据。

**问题**：
是否可以让 SQL Server 2005 接受 QNAN？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T22:46:33.760

sql 2005 不支持 QNAN。NAN 也不支持

从技术上讲，SQL 2000 也不支持它们。然而，他们奏效了。

您可能需要查看以下内容：

SQL 2005 下的 DATA_PURITY 检查 [http://support.microsoft.com/kb/923247](http://support.microsoft.com/kb/923247)

您可能想访问的另一个地方是： [http ://www.mssqltips.com/tip.asp?tip=1119](http://www.mssqltips.com/tip.asp?tip=1119)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T22:47:23.383

根据[对此错误报告](https://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=239674)的回复，SQL Server 2005 不接受 NaN 或无穷大，这显然是设计使然（由于排序/比较问题）。

# sql - 从三列中选择不同的值，其中最大值为四分之一，其中有重复项

> ID：467329
> 
> 赞同：1
> 
> 时间：2009-01-21T22:34:47.590
> 
> 标签：sql, oracle, distinct, max

我有一个包含一个数值 (n) 和三个字符串值 (a,b,c) 的表。如何查询此表以便仅获得 (a,b,c) 的不同值，如果存在重复值，则取对应的一组 n 值中的最大值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T22:36:59.003

```
select max(n), a, b, c
from mytable
group by a, b, c 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-21T22:37:30.657

使用`GROUP BY`：

```
select a, b, c, max(n) 
from table 
group by a, b, c; 
```

这将仅显示唯一或不同的集合，`a, b, c`并显示在该集合中找到的最大值`n`。

`MAX`是设计用于与 一起使用的聚合函数`GROUP BY`。其他可能有用的聚合函数包括`MIN`、`AVERAGE`和`COUNT`。

# .net - WPF 中的抗锯齿伪影

> ID：467331
> 
> 赞同：3
> 
> 时间：2009-01-21T22:35:09.570
> 
> 标签：.net, wpf, antialiasing

当我尝试在 WPF 中使用抗锯齿图形时，我遇到了一个奇怪的渲染问题。

这是一个简化版本。

如果我使用以下 XAML

```
<Window x:Class="RenderingBug.Window1" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Title="Window1" Width="300" Height="300">
    <Grid Name="myGrid" Background="AntiqueWhite" Width="250" Height="250">
        <ScrollViewer Name="myScrollViewer" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
            <Canvas Height="500" Width="500" Name="myCanvas" />
        </ScrollViewer>        
    </Grid>
 </Window> 
```

以及以下cs

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace RenderingBug
{
    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            PathFigureCollection pfc = new PathFigureCollection();
            PathFigure pf = new PathFigure();
            pf.StartPoint = new Point(100, 20);
            LineSegment ls = new LineSegment();
            ls.Point = new Point(20, 100);
            PathSegmentCollection psc = new PathSegmentCollection();
            psc.Add(ls);
            pf.Segments = psc;
            pfc.Add(pf);
            PathGeometry pg = new PathGeometry(pfc);

            RectangleGeometry clippingRectangle = new RectangleGeometry(new Rect(0, 0, 80, 80));

            Path p1 = new Path();
            p1.ClipToBounds = true;
            p1.Clip = clippingRectangle;
            p1.StrokeDashCap = PenLineCap.Square;
            p1.Stroke = Brushes.Black;
            p1.StrokeThickness = 30;
            p1.Data = pg;
            myCanvas.Children.Add(p1);

            Path p2 = new Path();
            p2.ClipToBounds = true;
            p2.Clip = clippingRectangle;
            p2.StrokeDashCap = PenLineCap.Square;
            p2.Stroke = Brushes.White;
            p2.StrokeThickness = 10;
            p2.Data = pg;
            myCanvas.Children.Add(p2);
        }
    }
} 
```

我在裁剪矩形边缘所在的抗锯齿上遇到了一个奇怪的渲染问题（运行程序，这将是相当明显的，但它是一条模糊的灰线，裁剪矩形截断了路径。）

我尝试了各种技术，例如将控件与特定像素对齐，并在各种控件上设置 SnapsToDevicePixels，希望这可以解决这个问题（删除额外的模糊灰色带），但似乎没有任何帮助。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T19:32:33.110

事实证明，这是因为尽管窗口当然是在像素边界上对齐的，但窗口内的网格可能不是。解决这个问题并不太难，但可能需要一段时间才能弄清楚该怎么做。

有一个很好的功能叫做 SnapsToDevicePixels 应该让所有东西都正确对齐。而且，可悲的是，无论出于何种原因，它似乎根本不起作用（这似乎是一个可以理解的错误）。那么该怎么办？

首先，网格必须在像素边界处对齐（即不居中，或类似的东西，因为如果窗口在水平或垂直方向上具有奇数个像素，则网格以及网格内容将不对齐.)

但是，还有其他问题需要处理……一旦您开始滚动滚动条，工件就会重新出现！这是因为滚动条不一定将内容滚动整数个像素。为了解决这个问题，我在 ScrollViewer 中捕获了一些事件，以将滚动位置设置为整数值。

```
private void workingAreaScrollViewer_SizeChanged(object sender, SizeChangedEventArgs e)
{
    double w = e.NewSize.Width;
    double h = e.NewSize.Height;
    workingAreaScrollViewer.Width = Math.Round(w);
    workingAreaScrollViewer.Height = Math.Round(h);
}

private void Window_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.A)
    {
        workingAreaCanvas.Children.Remove(p2);
    }
    if (e.Key == Key.Z && p2.Parent != workingAreaCanvas)
    {
        workingAreaCanvas.Children.Add(p2);
    }
} 
```

这样做，一切似乎都很好。

（作为旁注，对于在 ScrollViews 中遇到图像问题的人......如果您遇到同样的问题，这也应该解决这个问题，只要图像没有缩放、旋转等。 .只要您只是尝试将图像与像素边界对齐，这应该可以完成。）

# .net - Windows 设计指南和 Visual Studio

> ID：467333
> 
> 赞同：14
> 
> 时间：2009-01-21T22:35:28.680
> 
> 标签：.net, winforms

有没有人有一个很好的策略来遵守[Windows 设计指南](http://www.microsoft.com/whdc/System/platform/pcdesign/XPguidelines.mspx)和 Visual Studio (2008) 中的 Windows 窗体开发

例如，只是在 Windows XP 中遵守字体建议，您必须知道系统默认字体应该是 Tahoma，浮动窗口中的标题栏应该使用 Verdana，Windows 的标题栏应该使用 Trebuchet MS。叹息...我认为 Vista 完全不同 :-(

当然，Visual Studio 默认提供的是一个脑残的 Microsoft Sans Serif。

那么最好的设计方式是什么，是否有可用的插件可以帮助我，我是否只需要忍受打开设计指南并手动执行此操作。（痛苦）

编辑：感谢视觉样式的建议，但不幸的是，这不会减少芥末（实际上启用视觉样式是 Visual Studio 2008 中的默认设置）XP 外观和感觉 winforms 控件默认情况下仍使用 microsoft sans serif 字体。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T05:34:45.480

您可以通过在正确的位置调用 Application.EnableVisualStyles() 让您的 Windows 窗体使用 Windows 主题字体/颜色/大小等。您的表单将采用您当前选择的 Windows 主题中设置的属性。

MSDN 页面：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.application.enablevisualstyles.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.enablevisualstyles.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T00:46:56.170

据我所知，没有可用的插件（我可能是错的，可能是），但我通常做的是为任何项目创建几个副本，并为 Vista 使用所有字体，另一个用于 XP . 希望这可以帮助

# c++ - 部分专业化问题

> ID：467335
> 
> 赞同：1
> 
> 时间：2009-01-21T22:36:04.780
> 
> 标签：c++

我需要一双新鲜的眼睛。

这显然是非法的，但它显示了我正在尝试做的事情：

```
template <typename T, T> struct Foo
{
};

template <typename T> struct Foo <T, 0> //Obviously I can't do this.
{
}; 
```

有什么方法可以包装 T 或做一些棘手的事情以便这种事情可以工作？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-21T22:50:05.937

是的，你可以使用这个技巧：

```
template <typename T, T, T=0> struct Foo {
};

template <typename T, T t> struct Foo <T, t, t> {
}; 
```

如果 t 在特化中为 0，它将匹配默认参数，并采用特化。否则，将采用主模板。

**编辑**：第三个参数到底是什么意思？嗯，这是一个默认值，它是 0。例如，当我们命名专业化时，它将被传递`Foo<int, 5>`。但实际上，我们用 arguments 实例化了一个模板`Foo<int, 5, 0>`，因为最后一个是默认参数。偏特化匹配，当第三个参数匹配第三个参数时，默认为零，如果第三个和第二个参数相同，因为两者都是`t`.

上面的技巧有一个缺点，它也`Foo<int, 9, 9>`使用了我们的专业化。但另一方面，上述内容非常简单，因此您可能会逃脱惩罚。如果您不希望它起作用，那么您可以使用`enable_if`，这有点复杂：

```
template <typename T, T, typename = void> struct Foo {
};

template <typename T, T t> 
struct Foo <T, t, typename boost::enable_if_c< t == 0 >::type> {
}; 
```

现在，即使您说`Foo<int, 9, void>`，也不会选择我们的部分特化，因为条件`t == 0`不正确，`::type`因此不可用。SFINAE当时没有选择专业化。当然，使用此 enable_if 解决方案，您不仅限于 t 为零。任何条件都可以。作为参考，这里是 enable_if 的代码，如果你不使用 boost。然后剪掉`_c`上面的后缀，我们不需要下面的版本：

```
template<bool C, typename T = void>
struct enable_if {
  typedef T type;
};

template<typename T>
struct enable_if<false, T> { }; 
```

# jquery - 如何在表格行上使用 slideDown（或显示）功能？

> ID：467336
> 
> 赞同：217
> 
> 时间：2009-01-21T22:36:54.370
> 
> 标签：jquery, animation, html-table, slidedown

我正在尝试向表格添加一行并让该行滑入视图，但是下滑功能似乎正在向表格行添加一个 display:block 样式，这会弄乱布局。

任何想法如何解决这个问题？

这是代码：

```
$.get('/some_url', 
  { 'val1': id },

  function (data) {
    var row = $('#detailed_edit_row');
    row.hide();
    row.html(data);
    row.slideDown(1000);
  }
); 
```

* * *

## 回答 #1

> 赞同：298
> 
> 时间：2009-05-28T11:49:53.397

表格行不支持动画。

来自 Chaffer 和 Swedberg 的“Learning jQuery”

* * *

> 表格行对动画提出了特殊的障碍，因为浏览器对其可见显示属性使用不同的值（表格行和块）。没有动画的 .hide() 和 .show() 方法始终可以安全地用于表格行。从 jQuery 版本 1.1.3 开始，也可以使用 .fadeIn() 和 .fadeOut()。

* * *

您可以将 td 内容包装在 div 中并在其上使用 slideDown 。您需要确定动画是否值得额外标记。

* * *

## 回答 #2

> 赞同：158
> 
> 时间：2010-08-05T00:39:16.423

我只是动态地包装 tr，然后在 slideUp/slideDown 完成后将其删除。添加和删​​除一个或几个标签然后在动画完成后删除它们是一个非常小的开销，我根本看不到任何明显的滞后。

**上滑**：

```
$('#my_table > tbody > tr.my_row')
 .find('td')
 .wrapInner('<div style="display: block;" />')
 .parent()
 .find('td > div')
 .slideUp(700, function(){

  $(this).parent().parent().remove();

 }); 
```

**滑下：**

```
$('#my_table > tbody > tr.my_row')
 .find('td')
 .wrapInner('<div style="display: none;" />')
 .parent()
 .find('td > div')
 .slideDown(700, function(){

  var $set = $(this);
  $set.replaceWith($set.contents());

 }); 
```

我必须向 fletchzone.com 致敬，因为我拿走了他的插件并将其剥离回上面，干杯伙伴。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2010-12-09T20:48:52.430

这是我为此编写的一个插件，它从 Fletch 的实现中需要一点，但我的仅用于向上或向下滑动一行（不插入行）。

```
(function($) {
var sR = {
    defaults: {
        slideSpeed: 400,
        easing: false,
        callback: false     
    },
    thisCallArgs: {
        slideSpeed: 400,
        easing: false,
        callback: false
    },
    methods: {
        up: function (arg1,arg2,arg3) {
            if(typeof arg1 == 'object') {
                for(p in arg1) {
                    sR.thisCallArgs.eval(p) = arg1[p];
                }
            }else if(typeof arg1 != 'undefined' && (typeof arg1 == 'number' || arg1 == 'slow' || arg1 == 'fast')) {
                sR.thisCallArgs.slideSpeed = arg1;
            }else{
                sR.thisCallArgs.slideSpeed = sR.defaults.slideSpeed;
            }

            if(typeof arg2 == 'string'){
                sR.thisCallArgs.easing = arg2;
            }else if(typeof arg2 == 'function'){
                sR.thisCallArgs.callback = arg2;
            }else if(typeof arg2 == 'undefined') {
                sR.thisCallArgs.easing = sR.defaults.easing;    
            }
            if(typeof arg3 == 'function') {
                sR.thisCallArgs.callback = arg3;
            }else if(typeof arg3 == 'undefined' && typeof arg2 != 'function'){
                sR.thisCallArgs.callback = sR.defaults.callback;    
            }
            var $cells = $(this).find('td');
            $cells.wrapInner('<div class="slideRowUp" />');
            var currentPadding = $cells.css('padding');
            $cellContentWrappers = $(this).find('.slideRowUp');
            $cellContentWrappers.slideUp(sR.thisCallArgs.slideSpeed,sR.thisCallArgs.easing).parent().animate({
                                                                                                                paddingTop: '0px',
                                                                                                                paddingBottom: '0px'},{
                                                                                                                complete: function () {
                                                                                                                    $(this).children('.slideRowUp').replaceWith($(this).children('.slideRowUp').contents());
                                                                                                                    $(this).parent().css({'display':'none'});
                                                                                                                    $(this).css({'padding': currentPadding});
                                                                                                                }});
            var wait = setInterval(function () {
                if($cellContentWrappers.is(':animated') === false) {
                    clearInterval(wait);
                    if(typeof sR.thisCallArgs.callback == 'function') {
                        sR.thisCallArgs.callback.call(this);
                    }
                }
            }, 100);                                                                                                    
            return $(this);
        },
        down: function (arg1,arg2,arg3) {
            if(typeof arg1 == 'object') {
                for(p in arg1) {
                    sR.thisCallArgs.eval(p) = arg1[p];
                }
            }else if(typeof arg1 != 'undefined' && (typeof arg1 == 'number' || arg1 == 'slow' || arg1 == 'fast')) {
                sR.thisCallArgs.slideSpeed = arg1;
            }else{
                sR.thisCallArgs.slideSpeed = sR.defaults.slideSpeed;
            }

            if(typeof arg2 == 'string'){
                sR.thisCallArgs.easing = arg2;
            }else if(typeof arg2 == 'function'){
                sR.thisCallArgs.callback = arg2;
            }else if(typeof arg2 == 'undefined') {
                sR.thisCallArgs.easing = sR.defaults.easing;    
            }
            if(typeof arg3 == 'function') {
                sR.thisCallArgs.callback = arg3;
            }else if(typeof arg3 == 'undefined' && typeof arg2 != 'function'){
                sR.thisCallArgs.callback = sR.defaults.callback;    
            }
            var $cells = $(this).find('td');
            $cells.wrapInner('<div class="slideRowDown" style="display:none;" />');
            $cellContentWrappers = $cells.find('.slideRowDown');
            $(this).show();
            $cellContentWrappers.slideDown(sR.thisCallArgs.slideSpeed, sR.thisCallArgs.easing, function() { $(this).replaceWith( $(this).contents()); });

            var wait = setInterval(function () {
                if($cellContentWrappers.is(':animated') === false) {
                    clearInterval(wait);
                    if(typeof sR.thisCallArgs.callback == 'function') {
                        sR.thisCallArgs.callback.call(this);
                    }
                }
            }, 100);
            return $(this);
        }
    }
};

$.fn.slideRow = function(method,arg1,arg2,arg3) {
    if(typeof method != 'undefined') {
        if(sR.methods[method]) {
            return sR.methods[method].apply(this, Array.prototype.slice.call(arguments,1));
        }
    }
};
})(jQuery); 
```

**基本用法：**

```
$('#row_id').slideRow('down');
$('#row_id').slideRow('up'); 
```

**将幻灯片选项作为单独的参数传递：**

```
$('#row_id').slideRow('down', 500); //slide speed
$('#row_id').slideRow('down', 500, function() { alert('Row available'); }); // slide speed and callback function
$('#row_id').slideRow('down', 500, 'linear', function() { alert('Row available'); }); slide speed, easing option and callback function
$('#row_id').slideRow('down', {slideSpeed: 500, easing: 'linear', callback: function() { alert('Row available');} }); //options passed as object 
```

基本上，对于向下滑动动画，插件将单元格的内容包装在 DIV 中，对其进行动画处理，然后将其删除，反之亦然，对于向上滑动（需要一些额外的步骤来消除单元格填充）。它还返回您调用它的对象，因此您可以像这样链接方法：

```
$('#row_id').slideRow('down').css({'font-color':'#F00'}); //make the text in the row red 
```

希望这可以帮助某人。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-12-20T16:46:39.700

我需要一个带有隐藏行的表格，这些行在行单击时滑入和滑出视图。

```
$('.tr-show-sub').click(function(e) {  
    var elOne = $(this);
    $('.tr-show-sub').each(function(key, value) {
        var elTwoe = $(this);

        if(elOne.get(0) !== elTwoe.get(0)) {
            if($(this).next('.tr-sub').hasClass('tr-sub-shown')) {
                elTwoe.next('.tr-sub').removeClass('tr-sub-shown');
                elTwoe.next('tr').find('td').find('div').slideUp();
                elTwoe.next('tr').find('td').slideUp();
            }
        }

        if(elOne.get(0) === elTwoe.get(0)) {
            if(elOne.next('.tr-sub').hasClass('tr-sub-shown')) {
                elOne.next('.tr-sub').removeClass('tr-sub-shown');
                elOne.next('tr').find('td').find('div').slideUp();
                elOne.next('tr').find('td').slideUp();
            } else {
                elOne.next('.tr-sub').addClass('tr-sub-shown');
                elOne.next('tr').find('td').slideDown();
                elOne.next('tr').find('td').find('div').slideDown();
            }
        }
    })
});
```

```
body {
        background: #eee;
    }

    .wrapper {
        margin: auto;
        width: 50%;
        padding: 10px;
        margin-top: 10%;
    }

    table {
        background: white;
        width: 100%;
    }

    table th {
        background: gray;
        text-align: left;
    }

    table th, td {
        border-bottom: 1px solid lightgray;
        padding: 5px;
    }

    table .tr-show-sub {
        background: #EAEAEA;
        cursor: pointer;
    }

    table .tr-sub td {
        display: none;
    }

    table .tr-sub td .div-sub {
        display: none;
    }
```

```
<script src="https://code.jquery.com/jquery-3.2.1.js"></script>
<div class="wrapper">
    <table cellspacing="0" cellpadding="3">
        <thead>
            <tr class="table">
                <th>col 1</th>
                <th>col 2</th>
                <th>col 3</th>
            </tr>
        </thead>
        <tbody>
            <tr class="tr-show-sub">
                <td>col 1</td>
                <td>col 2</td>
                <td>col 3</td>
            </tr>
            <tr class="tr-sub">
                <td colspan="5"><div class="div-sub">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis auctor tortor sit amet sem tempus rhoncus. Etiam scelerisque ligula id ligula congue semper interdum in neque. Vestibulum condimentum id nibh ac pretium. Proin a dapibus nibh. Suspendisse quis elit volutpat, aliquet nisi et, rhoncus quam. Quisque nec ex quis diam tristique hendrerit. Nullam sagittis metus sem, placerat scelerisque dolor congue eu. Pellentesque ultricies purus turpis, convallis congue felis iaculis sed. Cras semper elementum nibh at semper. Suspendisse libero augue, auctor facilisis tincidunt eget, suscipit eu ligula. Nam in diam at ex facilisis tincidunt. Fusce erat enim, placerat ac massa facilisis, tempus aliquet metus. Fusce placerat nulla sed tristique tincidunt. Duis vulputate vestibulum libero, nec lobortis elit ornare vel. Mauris imperdiet nulla non suscipit cursus. Sed sed dui ac elit rutrum mollis sed sit amet lorem. 
                </div></td>
            </tr>
            <tr class="tr-show-sub">
                <td>col 1</td>
                <td>col 2</td>
                <td>col 3</td>
            </tr>
            <tr class="tr-sub">
                <td colspan="5"><div class="div-sub">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis auctor tortor sit amet sem tempus rhoncus. Etiam scelerisque ligula id ligula congue semper interdum in neque. Vestibulum condimentum id nibh ac pretium. Proin a dapibus nibh. Suspendisse quis elit volutpat, aliquet nisi et, rhoncus quam. Quisque nec ex quis diam tristique hendrerit. Nullam sagittis metus sem, placerat scelerisque dolor congue eu. Pellentesque ultricies purus turpis, convallis congue felis iaculis sed. Cras semper elementum nibh at semper. Suspendisse libero augue, auctor facilisis tincidunt eget, suscipit eu ligula. Nam in diam at ex facilisis tincidunt. Fusce erat enim, placerat ac massa facilisis, tempus aliquet metus. Fusce placerat nulla sed tristique tincidunt. Duis vulputate vestibulum libero, nec lobortis elit ornare vel. Mauris imperdiet nulla non suscipit cursus. Sed sed dui ac elit rutrum mollis sed sit amet lorem. 
                </div></td>
            </tr>
            <tr>
                <td>col 1</td>
                <td>col 2</td>
                <td>col 3</td>
            </tr>
        </tbody>
    </table>
</div>
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-21T22:47:02.807

您可以尝试将行的内容包装在 a 中`<span>`并让您的选择器成为`$('#detailed_edit_row span');`- 有点骇人听闻，但我刚刚测试过它并且它有效。我也尝试了`table-row`上面的建议，但似乎没有用。

**更新**：我一直在解决这个问题，从所有迹象来看，jQuery 需要它执行 slideDown 的对象作为块元素。所以，没有骰子。我能够变出一个表格，在其中我在单元格上使用了 slideDown 并且它根本不影响布局，所以我不确定你的设置是如何设置的。我认为您唯一的解决方案是重构表格，使该单元格可以成为一个块，或者只是`.show();`该死的东西。祝你好运。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-06-09T20:17:44.500

像这样选择行的内容：

```
$(row).contents().slideDown(); 
```

[.contents()](https://api.jquery.com/contents/) - 获取匹配元素集中每个元素的子元素，包括文本和注释节点。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-02-28T16:23:50.137

我在回答这个问题时有点落后，但我找到了一种方法:)

```
function eventinfo(id) {
    tr = document.getElementById("ei"+id);
    div = document.getElementById("d"+id);
    if (tr.style.display == "none") {
        tr.style.display="table-row";
        $(div).slideDown('fast');
    } else {
        $(div).slideUp('fast');
        setTimeout(function(){tr.style.display="none";}, 200);
    }
} 
```

我只是在表格数据标签内放了一个 div 元素。当它设置为可见时，随着 div 的扩展，整行都会下降。然后告诉它在再次隐藏表格行之前淡出（然后超时，以便您看到效果）:)

希望这对某人有帮助！

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-07-15T06:22:37.817

有一个带有嵌套表的表行：

```
<tr class='dummyRow' style='display: none;'>
    <td>
        <table style='display: none;'>All row content inside here</table>
    </td>
</tr> 
```

* * *

## [向下滑动](https://api.jquery.com/slidedown/)该行：

```
$('.dummyRow').show().find("table").slideDown(); 
```

**注意：**该行和它的内容（这里是`"table"`）都应该在动画开始之前[隐藏。](https://api.jquery.com/hide/)

* * *

## 向上[滑动](https://api.jquery.com/slidedown/)行：

```
$('.dummyRow').find("table").slideUp('normal', function(){$('.dummyRow').hide();}); 
```

第二个参数 ( `function()`) 是一个回调。

* * *

*简单的！！*

请注意，还有几个[**选项**](https://api.jquery.com/slidedown/#slideDown-options)可以作为向上/向下滑动功能的参数添加（最常见的是`'slow'`和的持续时间`'fast'`）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-03-21T23:24:14.857

我确实使用了这里提供的想法并遇到了一些问题。我把它们都修好了，并有一个我想分享的流畅的单线。

```
$('#row_to_slideup').find('> td').css({'height':'0px'}).wrapInner('<div style=\"display:block;\" />').parent().find('td > div').slideUp('slow', function() {$(this).parent().parent().remove();}); 
```

它在 td 元素上使用 css。它将高度降低到 0px。这样，只有每个 td 元素内新创建的 div-wrapper 内容的高度很重要。

slideUp 速度很慢。如果你让它更慢，你可能会意识到一些小故障。开始时的小跳跃。这是因为提到的 css 设置。但如果没有这些设置，该行的高度不会降低。只有它的内容会。

最后， tr 元素被删除。

整行只包含 JQuery，没有原生 Javascript。

希望能帮助到你。

这是一个示例代码：

```
 <html>
            <head>
                    <script src="https://code.jquery.com/jquery-3.2.0.min.js">               </script>
            </head>
            <body>
                    <table>
                            <thead>
                                    <tr>
                                            <th>header_column 1</th>
                                            <th>header column 2</th>
                                    </tr>
                            </thead>
                            <tbody>
                                    <tr id="row1"><td>row 1 left</td><td>row 1 right</td></tr>
                                    <tr id="row2"><td>row 2 left</td><td>row 2 right</td></tr>
                                    <tr id="row3"><td>row 3 left</td><td>row 3 right</td></tr>
                                    <tr id="row4"><td>row 4 left</td><td>row 4 right</td></tr>
                            </tbody>
                    </table>
                    <script>
    setTimeout(function() {
    $('#row2').find('> td').css({'height':'0px'}).wrapInner('<div style=\"display:block;\" />').parent().find('td > div').slideUp('slow',         function() {$(this).parent().parent().remove();});
    }, 2000);
                    </script>
            </body>
    </html> 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-03-28T13:08:23.663

我已经通过使用行中的 td 元素解决了这个问题：

```
$(ui.item).children("td").effect("highlight", { color: "#4ca456" }, 1000); 
```

动画行本身会导致奇怪的行为，主要是异步动画问题。

对于上面的代码，我突出显示了在表格中拖放的一行，以突出显示更新已成功。希望这可以帮助某人。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-08-20T11:30:00.017

我想滑动整个身体，我通过结合淡入淡出和幻灯片效果来解决这个问题。

我分 3 个阶段完成了此操作（如果您想向下或向上滑动，则替换第 2 和第 3 步）

1.  为 tbody 分配高度，
2.  淡化所有 td 和 th，
3.  滑动体。

上滑示例：

```
tbody.css('height', tbody.css('height'));
tbody.find('td, th').fadeOut(200, function(){
    tbody.slideUp(300)
}); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-08-31T19:59:26.433

我对提供的所有其他解决方案都有问题，但最终做了这个像黄油一样光滑的简单事情。

像这样设置您的 HTML：

```
<tr id=row1 style='height:0px'><td>
  <div id=div1 style='display:none'>
    Hidden row content goes here
  </div>
</td></tr> 
```

然后像这样设置你的javascript：

```
function toggleRow(rowid){
  var row = document.getElementById("row" + rowid)

  if(row.style.height == "0px"){
      $('#div' + rowid).slideDown('fast');
      row.style.height = "1px";   
  }else{
      $('#div' + rowid).slideUp('fast');
      row.style.height = "0px";   
  } 
} 
```

基本上，使“不可见”行高 0px，里面有一个 div。
在 div（不是行）上使用动画，然后将行高设置为 1px。

要再次隐藏该行，请在 div 上使用相反的动画并将行高设置回 0px。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-11-04T04:18:19.413

我喜欢 Vinny 编写并一直在使用的插件。但是对于滑动行内的表格（tr/td），即使向上滑动，嵌套表格的行也总是隐藏起来。所以我在插件中做了一个快速简单的 hack，不隐藏嵌套表的行。只需更改以下行

```
var $cells = $(this).find('td'); 
```

到

```
var $cells = $(this).find('> td'); 
```

它只找到直接的 td，而不是嵌套的。希望这可以帮助使用该插件并拥有嵌套表的人。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-02-27T11:25:13.737

我想在#Vinny 的帖子中添加评论，但没有代表，所以必须发布答案...

发现你的插件有一个错误 - 当你只传递一个带有参数的对象时，如果没有传入其他参数，它们会被覆盖。通过更改处理参数的顺序轻松解决，代码如下。我还添加了一个选项，用于在关闭后销毁该行（仅当我需要它时！）： $('#row_id').slideRow('up', true); // 销毁行

```
(function ($) {
    var sR = {
        defaults: {
            slideSpeed: 400,
            easing: false,
            callback: false
        },
        thisCallArgs: {
            slideSpeed: 400,
            easing: false,
            callback: false,
            destroyAfterUp: false
        },
        methods: {
            up: function (arg1, arg2, arg3) {
                if (typeof arg2 == 'string') {
                    sR.thisCallArgs.easing = arg2;
                } else if (typeof arg2 == 'function') {
                    sR.thisCallArgs.callback = arg2;
                } else if (typeof arg2 == 'undefined') {
                    sR.thisCallArgs.easing = sR.defaults.easing;
                }
                if (typeof arg3 == 'function') {
                    sR.thisCallArgs.callback = arg3;
                } else if (typeof arg3 == 'undefined' && typeof arg2 != 'function') {
                    sR.thisCallArgs.callback = sR.defaults.callback;
                }
                if (typeof arg1 == 'object') {
                    for (p in arg1) {
                        sR.thisCallArgs[p] = arg1[p];
                    }
                } else if (typeof arg1 != 'undefined' && (typeof arg1 == 'number' || arg1 == 'slow' || arg1 == 'fast')) {
                    sR.thisCallArgs.slideSpeed = arg1;
                } else if (typeof arg1 != 'undefined' && (typeof arg1 == 'boolean')) {
                    sR.thisCallArgs.destroyAfterUp = arg1;
                } else {
                    sR.thisCallArgs.slideSpeed = sR.defaults.slideSpeed;
                }

                var $row = $(this);
                var $cells = $row.children('th, td');
                $cells.wrapInner('<div class="slideRowUp" />');
                var currentPadding = $cells.css('padding');
                $cellContentWrappers = $(this).find('.slideRowUp');
                $cellContentWrappers.slideUp(sR.thisCallArgs.slideSpeed, sR.thisCallArgs.easing).parent().animate({
                    paddingTop: '0px',
                    paddingBottom: '0px'
                }, {
                    complete: function () {
                        $(this).children('.slideRowUp').replaceWith($(this).children('.slideRowUp').contents());
                        $(this).parent().css({ 'display': 'none' });
                        $(this).css({ 'padding': currentPadding });
                    }
                });
                var wait = setInterval(function () {
                    if ($cellContentWrappers.is(':animated') === false) {
                        clearInterval(wait);
                        if (sR.thisCallArgs.destroyAfterUp)
                        {
                            $row.replaceWith('');
                        }
                        if (typeof sR.thisCallArgs.callback == 'function') {
                            sR.thisCallArgs.callback.call(this);
                        }
                    }
                }, 100);
                return $(this);
            },
            down: function (arg1, arg2, arg3) {

                if (typeof arg2 == 'string') {
                    sR.thisCallArgs.easing = arg2;
                } else if (typeof arg2 == 'function') {
                    sR.thisCallArgs.callback = arg2;
                } else if (typeof arg2 == 'undefined') {
                    sR.thisCallArgs.easing = sR.defaults.easing;
                }
                if (typeof arg3 == 'function') {
                    sR.thisCallArgs.callback = arg3;
                } else if (typeof arg3 == 'undefined' && typeof arg2 != 'function') {
                    sR.thisCallArgs.callback = sR.defaults.callback;
                }
                if (typeof arg1 == 'object') {
                    for (p in arg1) {
                        sR.thisCallArgs.eval(p) = arg1[p];
                    }
                } else if (typeof arg1 != 'undefined' && (typeof arg1 == 'number' || arg1 == 'slow' || arg1 == 'fast')) {
                    sR.thisCallArgs.slideSpeed = arg1;
                } else {
                    sR.thisCallArgs.slideSpeed = sR.defaults.slideSpeed;
                }

                var $cells = $(this).children('th, td');
                $cells.wrapInner('<div class="slideRowDown" style="display:none;" />');
                $cellContentWrappers = $cells.find('.slideRowDown');
                $(this).show();
                $cellContentWrappers.slideDown(sR.thisCallArgs.slideSpeed, sR.thisCallArgs.easing, function () { $(this).replaceWith($(this).contents()); });

                var wait = setInterval(function () {
                    if ($cellContentWrappers.is(':animated') === false) {
                        clearInterval(wait);
                        if (typeof sR.thisCallArgs.callback == 'function') {
                            sR.thisCallArgs.callback.call(this);
                        }
                    }
                }, 100);
                return $(this);
            }
        }
    };

    $.fn.slideRow = function (method, arg1, arg2, arg3) {
        if (typeof method != 'undefined') {
            if (sR.methods[method]) {
                return sR.methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
            }
        }
    };
})(jQuery); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-12-08T22:49:49.813

如果您需要同时滑动和淡入表格行，请尝试使用这些：

```
jQuery.fn.prepareTableRowForSliding = function() {
    $tr = this;
    $tr.children('td').wrapInner('<div style="display: none;" />');
    return $tr;
};

jQuery.fn.slideFadeTableRow = function(speed, easing, callback) {
    $tr = this;
    if ($tr.is(':hidden')) {
        $tr.show().find('td > div').animate({opacity: 'toggle', height: 'toggle'}, speed, easing, callback);
    } else {
        $tr.find('td > div').animate({opacity: 'toggle', height: 'toggle'}, speed, easing, function(){
            $tr.hide();
            callback();
        });
    }
    return $tr;
};

$(document).ready(function(){
    $('tr.special').hide().prepareTableRowForSliding();
    $('a.toggle').toggle(function(){
        $button = $(this);
        $tr = $button.closest('tr.special'); //this will be specific to your situation
        $tr.slideFadeTableRow(300, 'swing', function(){
            $button.text('Hide table row');
        });
    }, function(){
        $button = $(this);
        $tr = $button.closest('tr.special'); //this will be specific to your situation
        $tr.slideFadeTableRow(300, 'swing', function(){
            $button.text('Display table row');
        });
});
}); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-08-02T07:15:23.543

```
function hideTr(tr) {
  tr.find('td').wrapInner('<div style="display: block;" />').parent().find('td > div').slideUp(50, function () {
    tr.hide();
    var $set = jQuery(this);
    $set.replaceWith($set.contents());
  });
}

function showTr(tr) {
  tr.show()
  tr.find('td').wrapInner('<div style="display: none;" />').parent().find('td > div').slideDown(50, function() {
    var $set = jQuery(this);
    $set.replaceWith($set.contents());
  });
} 
```

您可以使用这些方法，例如：

```
jQuery("[data-toggle-tr-trigger]").click(function() {
  var $tr = jQuery(this).parents(trClass).nextUntil(trClass);
  if($tr.is(':hidden')) {
    showTr($tr);
  } else {
    hideTr($tr);
  }
}); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-10-10T09:45:57.953

如果您将行中的 td 设置为不显示任何内容，同时您开始为行上的高度设置动画，我可以完成

```
tbody tr{
    min-height: 50px;
}
tbody tr.ng-hide td{
    display: none;
}
tr.hide-line{
    -moz-transition: .4s linear all;
    -o-transition: .4s linear all;
    -webkit-transition: .4s linear all;
    transition: .4s linear all;
    height: 50px;
    overflow: hidden;

    &.ng-hide { //angularJs specific
        height: 0;
        min-height: 0;
    }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-11-10T08:33:08.817

[http://jsfiddle.net/PvwfK/136/](http://jsfiddle.net/PvwfK/136/)

```
<table cellspacing='0' cellpadding='0' class='table01' id='form_table' style='width:100%;'>
<tr>
    <td style='cursor:pointer; width:20%; text-align:left;' id='header'>
        <label style='cursor:pointer;'> <b id='header01'>▲ Customer Details</b>

        </label>
    </td>
</tr>
<tr>
    <td style='widtd:20%; text-align:left;'>
        <div id='content' class='content01'>
            <table cellspacing='0' cellpadding='0' id='form_table'>
                <tr>
                    <td>A/C ID</td>
                    <td>:</td>
                    <td>3000/A01</td>
                </tr>
                <tr>
                    <td>A/C ID</td>
                    <td>:</td>
                    <td>3000/A01</td>
                </tr>
                <tr>
                    <td>A/C ID</td>
                    <td>:</td>
                    <td>3000/A01</td>
                </tr>
            </table>
        </div>
    </td>
</tr> 
```

```
$(function () {
$(".table01 td").on("click", function () {
    var $rows = $('.content01');
    if ($(".content01:first").is(":hidden")) {
        $("#header01").text("▲ Customer Details");
        $(".content01:first").slideDown();
    } else {
        $("#header01").text("▼ Customer Details");
        $(".content01:first").slideUp();
    }
}); 
```

});

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-12-06T20:40:43.667

此代码有效！

```
<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <title></title>
        <script>
            function addRow() {
                $('.displaynone').show();
                $('.displaynone td')
                .wrapInner('<div class="innerDiv" style="height:0" />');
                $('div').animate({"height":"20px"});
            }
        </script>
        <style>
            .mycolumn{border: 1px solid black;}
            .displaynone{display: none;}
        </style>
    </head>
    <body>
        <table align="center" width="50%">
            <tr>
                <td class="mycolumn">Row 1</td>
            </tr>
            <tr>
                <td class="mycolumn">Row 2</td>
            </tr>
            <tr class="displaynone">
                <td class="mycolumn">Row 3</td>
            </tr>
            <tr>
                <td class="mycolumn">Row 4</td>
            </tr>
        </table>
        <br>
        <button onclick="addRow();">add</button>    
    </body>
</html> 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-01-25T10:12:21.340

Vinny 提供的插件*非常*接近，但我发现并修复了几个小问题。

1.  它贪婪地瞄准 td 元素，而不仅仅是隐藏行的子元素。如果它在显示这一行时找到了那些孩子，那就没问题了。当它接近时，它们都以“显示：无”结束，使它们隐藏起来。
2.  它根本没有针对子元素。
3.  对于具有大量内容的表格单元格（例如具有大量行的嵌套表格），调用 slideRow('up')，无论提供的 slideSpeed 值如何，它会在填充动画完成后立即折叠该行的视图. 我修复了它，因此填充动画在包装上的 slideUp() 方法完成之前不会触发。

    ```
    (function($){
        var sR = {
            defaults: {
                slideSpeed: 400
              , easing: false
              , callback: false
            }
          , thisCallArgs:{
                slideSpeed: 400
              , easing: false
              , callback: false
            }
          , methods:{
                up: function(arg1, arg2, arg3){
                    if(typeof arg1 == 'object'){
                        for(p in arg1){
                            sR.thisCallArgs.eval(p) = arg1[p];
                        }
                    }else if(typeof arg1 != 'undefined' && (typeof arg1 == 'number' || arg1 == 'slow' || arg1 == 'fast')){
                        sR.thisCallArgs.slideSpeed = arg1;
                    }else{
                        sR.thisCallArgs.slideSpeed = sR.defaults.slideSpeed;
                    }

                    if(typeof arg2 == 'string'){
                        sR.thisCallArgs.easing = arg2;
                    }else if(typeof arg2 == 'function'){
                        sR.thisCallArgs.callback = arg2;
                    }else if(typeof arg2 == 'undefined'){
                        sR.thisCallArgs.easing = sR.defaults.easing;    
                    }
                    if(typeof arg3 == 'function'){
                        sR.thisCallArgs.callback = arg3;
                    }else if(typeof arg3 == 'undefined' && typeof arg2 != 'function'){
                        sR.thisCallArgs.callback = sR.defaults.callback;    
                    }
                    var $cells = $(this).children('td, th');
                    $cells.wrapInner('<div class="slideRowUp" />');
                    var currentPadding = $cells.css('padding');
                    $cellContentWrappers = $(this).find('.slideRowUp');
                    $cellContentWrappers.slideUp(sR.thisCallArgs.slideSpeed, sR.thisCallArgs.easing, function(){
                        $(this).parent().animate({ paddingTop: '0px', paddingBottom: '0px' }, {
                            complete: function(){
                                $(this).children('.slideRowUp').replaceWith($(this).children('.slideRowUp').contents());
                                $(this).parent().css({ 'display': 'none' });
                                $(this).css({ 'padding': currentPadding });
                            }
                        });
                    });
                    var wait = setInterval(function(){
                        if($cellContentWrappers.is(':animated') === false){
                            clearInterval(wait);
                            if(typeof sR.thisCallArgs.callback == 'function'){
                                sR.thisCallArgs.callback.call(this);
                            }
                        }
                    }, 100);                                                                                                    
                    return $(this);
                }
              , down: function (arg1, arg2, arg3){
                    if(typeof arg1 == 'object'){
                        for(p in arg1){
                            sR.thisCallArgs.eval(p) = arg1[p];
                        }
                    }else if(typeof arg1 != 'undefined' && (typeof arg1 == 'number' || arg1 == 'slow' || arg1 == 'fast')){
                        sR.thisCallArgs.slideSpeed = arg1;
                    }else{
                        sR.thisCallArgs.slideSpeed = sR.defaults.slideSpeed;
                    }

                    if(typeof arg2 == 'string'){
                        sR.thisCallArgs.easing = arg2;
                    }else if(typeof arg2 == 'function'){
                        sR.thisCallArgs.callback = arg2;
                    }else if(typeof arg2 == 'undefined'){
                        sR.thisCallArgs.easing = sR.defaults.easing;    
                    }
                    if(typeof arg3 == 'function'){
                        sR.thisCallArgs.callback = arg3;
                    }else if(typeof arg3 == 'undefined' && typeof arg2 != 'function'){
                        sR.thisCallArgs.callback = sR.defaults.callback;    
                    }
                    var $cells = $(this).children('td, th');
                    $cells.wrapInner('<div class="slideRowDown" style="display:none;" />');
                    $cellContentWrappers = $cells.find('.slideRowDown');
                    $(this).show();
                    $cellContentWrappers.slideDown(sR.thisCallArgs.slideSpeed, sR.thisCallArgs.easing, function() { $(this).replaceWith( $(this).contents()); });

                    var wait = setInterval(function(){
                        if($cellContentWrappers.is(':animated') === false){
                            clearInterval(wait);
                            if(typeof sR.thisCallArgs.callback == 'function'){
                                sR.thisCallArgs.callback.call(this);
                            }
                        }
                    }, 100);
                    return $(this);
                }
            }
        };

        $.fn.slideRow = function(method, arg1, arg2, arg3){
            if(typeof method != 'undefined'){
                if(sR.methods[method]){
                    return sR.methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
                }
            }
        };
    })(jQuery); 
    ```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-11-22T19:11:20.210

快速/轻松修复：

使用 JQuery [.toggle()](http://api.jquery.com/toggle/)显示/隐藏单击行或锚点的行。

需要编写一个函数来识别您想要隐藏的行，但切换会创建您正在寻找的功能。

# .net - 返回 POCO 而不是 SubSonic 的 ActiveRecord 对象的 SubSonic 数据层

> ID：467344
> 
> 赞同：1
> 
> 时间：2009-01-21T22:38:23.150
> 
> 标签：.net, orm, subsonic, n-tier-architecture, decoupling

我想在我正在构建的应用程序中使用 SubSonic (2.2)，因为我喜欢它的简单性，并且它可以处理我可以预见需要的任何类型的查询。同时，我想让我的应用程序的上层与 Subsonic 类型分离。我想只返回普通的旧 C# 对象，并传入要保存的 POCO。

但这里有个问题：我希望我的 POCO 根据 FK 关系为子集合和父对象延迟加载属性。我想我需要以某种方式将 Subsonic SqlQuery 对象放在我的 POCO 的私有成员中，并在 getter 内部使用它来获取延迟加载的属性。

关于如何使用 SubSonic 专门实现这一点的任何想法？以前有人做过吗？

我确实意识到 SubSonic 的下一个主要版本将立即执行此操作，但这看起来至少需要几个月的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T10:26:59.000

我在 SubSonic 中使用 RepositoryRecord，它“主要是”poco。然后，我为那些在选择属性时加载另一个类的类制作部分内容。

```
Partial Public Class Book

Private _Author as Database.Author 
Property Author() as Database.Author
  Get
     If _Author is nothing then
       ' Load the author class here.
     End if
     return _Author
  End get
  Set
     ....
  End Set
End Property
End Class 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T03:38:50.800

您可以使用以下属性：

> tableBaseClass="RepositoryRecord"

恐怕我不知道这如何处理延迟加载。您可以查看[Rob Conery 的帖子](http://blog.wekeroad.com/2008/01/16/subsonic-21-pakala-preview-part-2/)了解更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T02:55:13.160

你想要的不在版本 2.x 中。您可以通过编辑模板来获得大部分方法（我的[博客上](http://john-sheehan.com/blog)有延迟加载属性的示例）。另一种选择是构建您的 pocos，然后构建类以从 SubSonic 生成的类和查询映射到您的模型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T22:18:23.977

一直想不出一个好方法来做到这一点。Subsonic 3 看起来很不错，可以解决问题，但与此同时，我们只[使用了 NHibernate](https://stackoverflow.com/questions/508035/t4-template-for-nhibernate-not-fuent-nhibernate)。

# .net - 在 iis6 中上传图片时出现 413 http 错误

> ID：467355
> 
> 赞同：1
> 
> 时间：2009-01-21T22:41:16.390
> 
> 标签：.net, asp.net, iis-6

使用 asp.net 表单上传图像（特定图像是 275kb PNG）时，我不断收到 413 错误“实体太大”。我对此进行了彻底的研究，并进行了更改：

此处建议的 AspMaxRequestEntityAllowed 为 1000000 - [http://www.banmanpro.com/support2/File_Upload_limits.asp](http://www.banmanpro.com/support2/File_Upload_limits.asp)

UploadReadAheadSize 到 1000000 建议这里 - [http://technet.microsoft.com/en-us/library/cc737382.aspx](http://technet.microsoft.com/en-us/library/cc737382.aspx)

包含脚本的目录上的 web.config 的 maxRequestLength 为 1550000

这些都没有解决问题。其他人可以帮助我吗？我已经在另一台服务器上的开发站点上对此进行了测试，并且脚本运行良好，因此它似乎与脚本无关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T05:12:47.457

试试这个：

```
cscript adsutil.vbs set w3svc/1/uploadreadaheadsize 204800 
```

看来，当使用 3rd 方上传控件时，我假设您是，IIS 在将数据传递给 ISAPI 扩展时出现问题。上述命令会将 UploadReadAheadSize 设置为 204800KB。您可能需要调整设置的参数以匹配您所在的网络 ID。希望您可以访问服务器。

[在此处](http://technet.microsoft.com/en-us/library/cc737382.aspx)阅读更多相关信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-12T04:13:03.460

老问题，但我今天需要这个，上面的命令行不适合我，所以我发现了这个：

**IIS 7**： -http: [//msdn.microsoft.com/en-us/library/aa347568 (v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/aa347568(v=vs.90).aspx)

**上传ReadAheadSize**

Specifies the number of bytes that a Web server will read into a buffer and pass to an ISAPI extension or module. This occurs once per client request. The ISAPI extension or module receives any additional data directly from the client. The value must be between 0 and 2147483647.

The default value is 49152/48k.

**Solution**

1.  Stop IIS

2.  Edit the file: C:\Windows\System32\inetsrv\config\applicationHost.config set serverRuntime overrideModeDefault param to allow.

3.  Edit the file: C:\inetpub\wwwroot\web.config set uploadReadAheadSize to new value.

4.  Restart IIS

**applicationHost.config**

```
<section name="serverRuntime" overrideModeDefault="Allow" /> 
```

**web.config**

```
<configuration>
  <system.webServer>
    <serverRuntime maxRequestEntityAllowed="2072576000" uploadReadAheadSize="536870912"/>
    </system.webServer>
</configuration> 
```

# java - 将报告链接到 Java？或 Find 意味着在 Paradox 4.5 中应用 BOLD 格式？

> ID：467361
> 
> 赞同：0
> 
> 时间：2009-01-21T22:42:30.850
> 
> 标签：java, sql, netbeans, paradox

我需要阅读 Paradox 的 Java 报告，但我不知道该怎么做。可以使用工作驱动程序通过 netbeans 导入报告吗？我已将表格链接到 Java，但没有链接到报告。我需要应用一些富文本（即，使句子粗体 - 因此需要连接）。如果无法使用 Paradox 打印 BOLD，您对如何打印 BOLD 有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T09:47:34.097

Paradox 4.5 不会打印 BOLD，因为它是一个 16 位应用程序并且无法处理它。
我建议使用像 RaveReport 这样的程序，因为它与 Paradox 有很好的连接性。您需要从头开始创建表单并将您创建的标签分配给相关数据集。您也可以通过这种方式应用 RTF 和图形。如果您要构建许多报告，则需要做大量工作，但是与 PDOX 相比，它是一种可以更新报告外观的解决方案。

祝你好运

# mod-rewrite - 我如何修改不包括几个子目录的整个站点？

> ID：467364
> 
> 赞同：1
> 
> 时间：2009-01-21T22:43:48.163
> 
> 标签：mod-rewrite

我有一个小问题。我有一个很好的设置，mod 重写了对站点的所有请求——唯一的事情是它也重写了我不想被包括在内的目录。

我在我的 .htaccess 文件中使用此代码：

```
RewriteEngine on
RewriteRule ^([^/\.]+)/?$ index.php?section=$1 [L]
RewriteRule ^([^/\.]+)/([^/\.]+)/?$ index.php?section=$1&page=$2 [L]
RewriteRule ^([^/\.]+)/([^/\.]+)/([^/\.]+)/?$ index.php?section=$1&page=$2&split=$3 [L] 
```

理想情况下，我希望能够排除两个目录-访问/和编辑/-编辑/也需要有自己的规则集：

```
RewriteRule ^([^/\.]+)/?$ index.php?action=$1 [L] 
```

我可以通过直接链接到任一目录中的 .php 文件来解决此问题，但这并不理想。

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T22:47:50.247

使用[RewriteCond](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewritecond)

```
RewriteEngine on
RewriteCond %{REQUEST_URI} !^/(access|edit)/
RewriteRule ^([^/\.]+)/?$ index.php?section=$1 [L]
... 
```

（这是未经测试的，但应该很接近）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T23:04:19.277

An alternate idea (also untested):

```
RewriteEngine on
RewriteRule ^/access/ - [L]
RewriteRule ^/edit/([^/\.]+)/?$ /edit/index.php?action=$1 [L]
... (other rules) 
```

which would save you from having to repeat the `RewriteCond` before every rule.

# ruby - 在 Merb 中测试基本的 HTTP 身份验证请求

> ID：467365
> 
> 赞同：0
> 
> 时间：2009-01-21T22:44:23.653
> 
> 标签：ruby, merb, merb-auth

[Merb Open Source Book](http://book.merbist.com)有一[章是关于身份验证](http://book.merbist.com/merb-more/authentication)的。但是，[测试经过身份验证的请求部分](http://book.merbist.com/merb-more/authentication#testing_an_authenticated_request)示例仅显示了您可以对基于表单的身份验证执行哪些操作。我有一个要使用 HTTP 基本身份验证测试的 Web 服务。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-21T23:06:34.110

发布我的问题后，我尝试了更多的东西并找到了自己的答案。您可以执行以下操作：

```
response = request('/widgets/2222', 
                   :method => "GET", 
                   "X_HTTP_AUTHORIZATION" => 'Basic ' + ["myusername:mypassword"].pack('m').delete("\r\n")) 
```

我可能会花时间更新这本书，但至少这些信息可供 Google 查找并可能帮助其他人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T01:37:13.510

以下是控制器内部 HTTP 基本身份验证的示例：

```
class MyMerbApp < Application
  before :authenticate, :only=>[:admin]

  def index
    render
  end

  def admin
    render
  end

  protected 

  def authenticate 
    basic_authentication("Protected Area") do |username, password| 
      username == "name" && password == "secret"  
    end 
  end

end 
```

如果还没有为您完成，您需要在*config/router.rb中定义 merb_auth_slice：*

```
Merb::Router.prepare do
  slice(:merb_auth_slice_password, :name_prefix => nil, :path_prefix => "")
end 
```

# windows-services - 如何以编程方式在远程机器上停止/启动 Windows 服务？

> ID：467367
> 
> 赞同：28
> 
> 时间：2009-01-21T22:45:05.807
> 
> 标签：windows-services

我想编写一个控制台或 Click Once WinForms 应用程序，它将以编程方式停止和/或启动远程框上的 Windows 服务。

两个盒子都在运行 .NET 3.5 - 有哪些 .NET API 可用于完成此任务？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-01-21T23:54:32.653

在 C# 中：

```
var sc = new System.ServiceProcess.ServiceController("MyService", "MyRemoteMachine");
sc.Start();
sc.WaitForStatus(System.ServiceProcess.ServiceControllerStatus.Running);
sc.Stop();
sc.WaitForStatus(System.ServiceProcess.ServiceControllerStatus.Stopped); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-21T23:11:25.207

您也可以使用以下`sc`命令从命令控制台执行此操作：

```
 sc <server> start [service name]
 sc <server> stop [service name] 
```

采用

```
sc <server> query | find "SERVICE_NAME" 
```

获取服务名称列表。

该选项`<server>`具有以下形式`\\ServerName`

## 例子

`sc \\MyServer stop schedule`将停止调度程序服务。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-21T22:51:56.290

[服务控制器](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicecontroller(v=vs.110).aspx)。

您需要有权管理远程盒子上的服务。

正如 Mehrdad 所说，您也可以使用 WMI。这两种方法都适用于启动和停止，但 WMI 需要更多编码，并且可以让您更多地访问其他资源

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-21T23:09:22.700

如果您不想自己编写代码， Microsoft/Sysinternals 的[PsService](http://technet.microsoft.com/en-us/sysinternals/bb897542.aspx)是一个命令行工具，可以满足您的需求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-21T22:51:46.463

您可以使用`System.Management`API (WMI) 远程控制服务。WMI 是执行管理任务的通用 API。

但是，对于这个问题，我建议您使用更易于使用的`System.ServiceProcess.ServiceController`类。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-11-17T16:46:20.553

如果您需要获取服务的名称：

从命令行运行它：

sc查询

例如，您将看到 SQL Server 的服务名称是“MSSQL$SQLEXPRESS”。

因此，要在 C# 中停止 SQL Server 服务：

```
 ServiceController controller = new ServiceController();
        controller.MachineName = "Machine1";
        controller.ServiceName = "MSSQL$SQLEXPRESS";

        if(controller.Status == ServiceControllerStatus.Running)
            controller.Stop();

        controller.WaitForStatus(ServiceControllerStatus.Stopped); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-06-09T13:11:49.067

我做了如下：

**笔记：**

1.  如果您在尝试停止时没有启动服务，则会引发异常。
2.  如果你在你的 web.config 中配置这些东西，配置相关的异常就不会出现。无需在 IIS 中执行任何操作。

`Web.Config`在下_`<configuration>`

```
 <appSettings>
    <add key="ServiceName" value="YourServiceName" />
    <add key="MachineName" value="YourMachineName" />
  </appSettings>
  <system.web>
    <authentication mode="Windows"/>
    <identity impersonate="true" userName="YourUserName" password="YourPassword"/>
  </system.web> 
```

**在我的服务类中：**

```
private void RestartService()
{
    string serviceName = System.Configuration.ConfigurationSettings.AppSettings["ServiceName"];
    string machineName = System.Configuration.ConfigurationSettings.AppSettings["MachineName"];

    try
    {
        var service = new ServiceController(serviceName, machineName);
        if (service.Status != ServiceControllerStatus.Stopped)
        {
            service.Stop();
            service.WaitForStatus(System.ServiceProcess.ServiceControllerStatus.Stopped);
        }

        service.Start();
        service.WaitForStatus(System.ServiceProcess.ServiceControllerStatus.Running);

    }
    catch (Exception)
    {
    }
} 
```

希望这可以帮助。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-12-23T17:21:52.483

上面的 galets 代码片段是一个很好的开始。但是，请记住，它假定服务已经启动，或者更重要的是，

```
sc.Status == System.ServiceProcess.ServiceControllerStatus.Running 
```

此外，在代码执行期间的某个时刻，调用

```
sc.Refresh(); 
```

因为属性值（例如 ServiceControllerStatus）可能无法反映服务的实际属性。例如，您可以调用

```
sc.Start(); 
```

并在此命令执行时无限期等待

```
sc.WaitForStatus(System.ServiceProcess.ServiceControllerStatus.Running) 
```

这是我在考虑这些因素的情况下编写的此代码的一个版本。

```
 //Restart Content Service on DEV. 
        String svcName = "TheServiceName";
        String machineName = "TheMachineName";
        var sc = new System.ServiceProcess.ServiceController(svcName, machineName);
        Console.WriteLine("Stopping Service '{0}' on machine '{1}", svcName, machineName);
        sc.Stop();
        sc.WaitForStatus(System.ServiceProcess.ServiceControllerStatus.Stopped);          

        //sc.WaitForStatus(System.ServiceProcess.ServiceControllerStatus.Running);
        do
        {
            try
            {
                sc.Refresh();
                if (sc.Status == System.ServiceProcess.ServiceControllerStatus.Running)
                {
                    Console.WriteLine("Code has detected that servive start is pending, waiting 5 seconds to see if status changes..");
                    System.Threading.Thread.Sleep(5000);
                }
                else
                {
                    Console.WriteLine("waiting 5 seconds and retrying start..");
                    System.Threading.Thread.Sleep(5000);
                    Console.WriteLine("Attempt Starting Service '{0}' on machine '{1}", svcName, machineName);
                    sc.Start();
                }
            }

            catch(Exception ex)
            {
                //If it is already running, then abort do while
                if (ex.InnerException.Message == "An instance of the service is already running")
                {
                    Console.WriteLine(ex.InnerException.Message);
                    continue;
                }
                Console.WriteLine(ex.InnerException.ToString());
            }
        } while (sc.Status != System.ServiceProcess.ServiceControllerStatus.Running); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-09-27T17:01:21.517

这是一个可以在远程 pc 上启动和停止服务的 ServiceExtension。

并且可以设置服务的启动类型，甚至可以设置为“自动（延迟）”

[此答案](https://stackoverflow.com/questions/23270920/set-existing-service-to-auto-delayed-start#answer-32589671)的修改版本可在远程机器上工作。

```
using System;
using System.ComponentModel;
using System.Runtime.InteropServices;
using System.ServiceProcess;

namespace Helpers
{
    public enum ServiceStartModeEx
    {
        Automatic = 2,
        Manual = 3,
        Disabled = 4,
        DelayedAutomatic = 99
    }
    /// <summary>
    /// Extensions to the ServiceController class.
    /// </summary>
    public static class ServiceControlerExtensions
    {
        /// <summary>
        /// Set the start mode for the service.
        /// </summary>
        /// <param name="serviceController">The service controller.</param>
        /// <param name="mode">The desired start mode.</param>
        public static void SetStartMode(this ServiceController serviceController, ServiceStartModeEx mode)
        {
            IntPtr serviceManagerHandle = OpenServiceManagerHandle(serviceController);
            IntPtr serviceHandle = OpenServiceHandle(serviceController, serviceManagerHandle);

            try
            {
                if (mode == ServiceStartModeEx.DelayedAutomatic)
                {
                    ChangeServiceStartType(serviceHandle, ServiceStartModeEx.Automatic);
                    ChangeDelayedAutoStart(serviceHandle, true);
                }
                else
                {
                    // Delayed auto-start overrides other settings, so it must be set first.
                    ChangeDelayedAutoStart(serviceHandle, false);
                    ChangeServiceStartType(serviceHandle, mode);
                }
            }
            finally
            {
                if (serviceHandle != IntPtr.Zero)
                {
                    CloseServiceHandle(serviceHandle);
                }
                if (serviceManagerHandle != IntPtr.Zero)
                {
                    CloseServiceHandle(serviceManagerHandle);
                }
            }
        }

        private static IntPtr OpenServiceHandle(ServiceController serviceController, IntPtr serviceManagerHandle)
        {
            var serviceHandle = OpenService(
                                            serviceManagerHandle,
                                            serviceController.ServiceName,
                                            SERVICE_QUERY_CONFIG | SERVICE_CHANGE_CONFIG);

            if (serviceHandle == IntPtr.Zero)
            {
                throw new ExternalException("Open Service Error");
            }
            return serviceHandle;
        }

        private static IntPtr OpenServiceManagerHandle(ServiceController serviceController)
        {
            var machineName = string.IsNullOrWhiteSpace(serviceController.MachineName)
                ? null
                : serviceController.MachineName;
            IntPtr serviceManagerHandle = OpenSCManager(machineName, null, SC_MANAGER_ALL_ACCESS);
            if (serviceManagerHandle == IntPtr.Zero)
            {
                throw new ExternalException("Open Service Manager Error");
            }
            return serviceManagerHandle;
        }

        private static void ChangeServiceStartType(IntPtr serviceHandle, ServiceStartModeEx mode)
        {
            bool result = ChangeServiceConfig(
                                             serviceHandle,
                                             SERVICE_NO_CHANGE,
                                             (uint)mode,
                                             SERVICE_NO_CHANGE,
                                             null,
                                             null,
                                             IntPtr.Zero,
                                             null,
                                             null,
                                             null,
                                             null);

            if (result == false)
            {
                ThrowLastWin32Error("Could not change service start type");
            }
        }

        private static void ChangeDelayedAutoStart(IntPtr hService, bool delayed)
        {
            // Create structure that contains DelayedAutoStart property.
            SERVICE_DELAYED_AUTO_START_INFO info = new SERVICE_DELAYED_AUTO_START_INFO();

            // Set the DelayedAutostart property in that structure.
            info.fDelayedAutostart = delayed;

            // Allocate necessary memory.
            IntPtr hInfo = Marshal.AllocHGlobal(Marshal.SizeOf(typeof(SERVICE_DELAYED_AUTO_START_INFO)));

            // Convert structure to pointer.
            Marshal.StructureToPtr(info, hInfo, true);

            // Change the configuration.
            bool result = ChangeServiceConfig2(hService, SERVICE_CONFIG_DELAYED_AUTO_START_INFO, hInfo);

            // Release memory.
            Marshal.FreeHGlobal(hInfo);

            if (result == false)
            {
                ThrowLastWin32Error("Could not set service to delayed automatic");
            }
        }

        private static void ThrowLastWin32Error(string messagePrefix)
        {
            int nError = Marshal.GetLastWin32Error();
            var win32Exception = new Win32Exception(nError);
            string message = string.Format("{0}: {1}", messagePrefix, win32Exception.Message);
            throw new ExternalException(message);
        }

        [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Auto)]
        private static extern IntPtr OpenService(
            IntPtr hSCManager,
            string lpServiceName,
            uint dwDesiredAccess);

        [DllImport("advapi32.dll", EntryPoint = "OpenSCManagerW", ExactSpelling = true, CharSet = CharSet.Unicode,
            SetLastError = true)]
        private static extern IntPtr OpenSCManager(
            string machineName,
            string databaseName,
            uint dwAccess);

        [DllImport("advapi32.dll", CharSet = CharSet.Unicode, SetLastError = true)]
        private static extern Boolean ChangeServiceConfig(
            IntPtr hService,
            UInt32 nServiceType,
            UInt32 nStartType,
            UInt32 nErrorControl,
            String lpBinaryPathName,
            String lpLoadOrderGroup,
            IntPtr lpdwTagId,
            [In] char[] lpDependencies,
            String lpServiceStartName,
            String lpPassword,
            String lpDisplayName);

        [DllImport("advapi32.dll", CharSet = CharSet.Unicode, SetLastError = true)]
        [return: MarshalAs(UnmanagedType.Bool)]
        private static extern bool ChangeServiceConfig2(
            IntPtr hService,
            int dwInfoLevel,
            IntPtr lpInfo);

        [DllImport("advapi32.dll", EntryPoint = "CloseServiceHandle")]
        private static extern int CloseServiceHandle(IntPtr hSCObject);

        private const uint SERVICE_NO_CHANGE = 0xFFFFFFFF;
        private const uint SERVICE_QUERY_CONFIG = 0x00000001;
        private const uint SERVICE_CHANGE_CONFIG = 0x00000002;
        private const uint SC_MANAGER_ALL_ACCESS = 0x000F003F;

        private const int SERVICE_CONFIG_DELAYED_AUTO_START_INFO = 3;

        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
        private struct SERVICE_DELAYED_AUTO_START_INFO
        {
            public bool fDelayedAutostart;
        }
    }
} 
```

您可以启动这样的服务

```
 using System.ServiceProcess; 
```

serviceName = "服务的名称"

machineName = "远程/本地主机的名称"

```
 var service = new ServiceController(serviceName, machineName);
 try
 {
     service.SetStartMode(ServiceStartModeEx.DelayedAutomatic);
     service.Start();
 }

 finally
 {
     service.Close();
 } 
```

您可以停止这样的服务

```
var service = new ServiceController(serviceName, machineName);
try
{
    if (service.CanStop)
    {
        service.SetStartMode(ServiceStartModeEx.Disabled);
        service.Stop();

    }
}

finally
{
    service.Close();
} 
```

要授予用户在远程 PC 上启动和停止服务的权限，您必须设置一些服务权限，您可以谷歌搜索 subinacl.exe 是什么以及在哪里下载它。

```
C:\Program Files (x86)\Windows Resource Kits\Tools>subinacl.exe /service SERVICENAME /grant=MACHINENAME\USERNAME=F 
```

# java - Hibernate 相当于 EclipseLink 的批量查询提示？

> ID：467375
> 
> 赞同：5
> 
> 时间：2009-01-21T22:47:21.450
> 
> 标签：java, hibernate, jpa, ejb, eclipselink

我喜欢[EclipseLink](http://www.eclipse.org/eclipselink/)的一件事是有一个很棒的东西，称为[批处理查询提示](http://wiki.eclipse.org/Using_EclipseLink_JPA_Extensions_(ELUG)#Batch)，我还没有找到与之对应的 Hibernate。

基本上，做一大堆连接会很快变得一团糟，你最终查询的数据比你想要的要多（请记住，如果你将人员连接到 6 个地址，则人员信息将返回 6 次；现在继续将其乘以额外的连接） .

想象一个 Person 实体，它具有 0:M 的 Address、Email、Phone 和 OrderHistory 集合。加入所有不好但使用批处理方法：

```
List persons = entityManager.createQuery("select p from Person p"
  .setHint(QueryHints.BATCH, "p.address")
  .setHint(QueryHints.BATCH, "p.email")
  .setHint(QueryHints.BATCH, "p.phone")
  .setHint(QueryHints.BATCH, "p.orderHistory")
  .getResultList(); 
```

这将对 Person 表进行查询，仅此而已。当您第一次访问地址记录时，它将对**整个**地址表进行**一次查询。**如果您在 Person 表上指定了 where 子句，则同样的条件也将用于 Address 加载。

 **所以不是做 1 个查询，而是做 5 个。

如果您使用连接来执行此操作，您**可能**会在一个查询中获得所有信息，但由于连接，您很可能会加载更多数据。

无论如何，我已经在 Hibernate 文档中寻找与此等效的文档，但没有看到。有吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-26T08:14:25.520

没有一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T00:43:12.807

我知道有两件事可能会有所帮助：

1)`hibernate.default_batch_fetch_size`

2) Criteria.setFetchMode 和 Criteria.setFetchSize

# visual-studio - 你在 Visual Studio 中最常用的快捷键是什么？

> ID：467383
> 
> 赞同：7
> 
> 时间：2009-01-21T22:49:43.207
> 
> 标签：visual-studio, visual-studio-2008

最近，我发现一些以前从未使用过的快捷键非常有用。在编辑和调试时，像`F7`, `F3`, `Ctrl`+这样的键`g`对我有很大帮助。你在 Visual Studio 中最常用的快捷键是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-21T22:54:59.890

包括 Resharper 的快捷方式：

*   `Ctrl`- `Shift`- `B`（构建）
*   `F12`（去定义）
*   `Shift`- `F12`（查找用法）
*   `Ctrl`- `-`（转到最后一个位置）
*   `Alt`- `Shift`- `L`（在解决方案资源管理器中转到当前文件）
*   `Alt`- `\`（寻找会员）
*   `Ctrl`- `T`（查找类型）
*   `Ctrl`- `Shift`- `T`（查找文件）
*   `Shift`- `Esc`（关闭当前对话框）
*   `Ctrl`- `Shift`- `S`（保存所有文件 - VS 往往会忘记）

编辑：添加解释

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-21T23:28:29.087

我总是使用调试键盘快捷键 - `F9`(toggle breakpoint)、`F10`(step over) 和`F11`(step into)。我不敢相信我的一些同事实际上为此使用了工具栏按钮 - 使用快捷方式效率更高。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-22T00:16:42.097

标准 VS 键`F12`用于转到定义，然后`CTRL`+`-`回到我之前的位置。

可能是这两个让我更快地了解 VS 和我的代码的快捷方式。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-21T23:23:35.540

`Ctrl`+`.`用于调出智能标签以添加命名空间、重命名/重构等。

我还将`Ctrl`+重新映射`B`为构建，`Ctrl`++重新映射为构建选择（在某种意义上，构建项目）和+`Shift`以关闭窗口。`P``Ctrl``W`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-21T23:00:57.723

最常用的键盘快捷键是`Ctrl`-`Tab`在选项卡之间切换。

我经常使用的另一个是`Ctrl`-`I`开始增量搜索。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-22T00:22:15.360

`CTRL`++用于注释选择，`K` `CTRL`++用于取消注释选择（在某些标准键盘映射中，它们可能被映射到++ 和 ++ ，但前两个通常仍然可以工作...... ）`C``CTRL``K` `CTRL``U``CTRL``E` `CTRL``C``CTRL``E` `CTRL``C`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-12T09:41:32.123

还有两个：

*   `Alt`++`Ctrl`用于`C`调用堆栈
*   `Alt`+ `Ctrl`+`I`用于即时窗口

（在调试时都有帮助）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-21T22:58:32.003

`CTRL`+`D`然后 ">of $filename"（打开文件名），

`CTRL`+ `K`+ `C`（评论选择），

`CTRL`+ `K`+ `F`（格式），

`CTRL`+`X`和`CTRL`+`C`在一条线上进行剪切

或复制整行

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-21T22:58:59.583

名单是无穷无尽的。为了最大化可读代码空间，我删除了所有工具栏。如果我想这样做，我必须知道它的键盘快捷键。

除了基础知识，我经常使用诸如`Ctrl-M`, `O`, `Ctrl-K`, `C`, `Ctrl-K`, `U`, `Ctrl-K`, `D`, `Ctrl-Alt-E`,之类的东西`Ctrl-Alt-P`。我还为“删除和排序使用”制作了一个小笑脸按钮，因为在右键菜单中导航需要很长时间，而且它没有我知道的热键。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-21T23:18:29.593

我使用了很多，但我认为最有用的是 `CTRL`+`K` `K`用于设置书签，`CTRL`+`K` `N`用于转到下一个书签，`CTRL`+`K` `P`用于上一个

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-21T23:23:59.737

`Shift`+`F6`构建当前项目，`Shift`+`F5`停止调试

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-22T00:57:38.130

`Ctrl`++`Shift`删除`F9`解决方案中的所有断点。当人们把它们溅到整个解决方案上时，非常方便！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-21T22:55:53.023

`Ctrl`+`B` 对我来说是构建当前项目。我在 VS2008 SP1 中较少使用它，错误突出显示所以 `Ctrl`+`D` 对我来说是 Go To Definition 开始将它排除在外。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-21T23:48:46.660

我永远记不起快捷方式，但是`Ctrl`+ `-` 。是我能记住和经常使用的少数几个之一。安装 Resharper 后，`Alt`+ `Enter`为`Ctrl`. 关于类固醇。两者都智能地解决了各种错误或重构。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-22T00:03:31.623

我经常使用书签快捷方式：`Ctrl-K` `Ctrl-K`创建书签，`Ctrl-K` `Ctrl-N`循环浏览它们。

`Ctrl-Shift-B`构建可能是执行最多的。

# c# - Resharper 的代码建议使代码的可读性降低？

> ID：467389
> 
> 赞同：36
> 
> 时间：2009-01-21T22:52:13.593
> 
> 标签：c#, resharper

在尝试全绿时，我得到了 Resharper 的以下建议。

原始代码：

```
 static public string ToNonNullString(this XmlAttribute attr)
    {
        if (attr != null)
            return attr.Value;
        else
            return string.Empty;
    } 
```

建议：删除多余的“else”，结果如下：

```
 static public string ToNonNullString(this XmlAttribute attr)
    {
        if (attr != null)
            return attr.Value;
        return string.Empty;
    } 
```

对我来说，建议的版本似乎比原来的可读性差。Resharper 的建议是否反映了良好可维护代码的定义？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-01-21T23:00:00.567

从技术上讲，Resharper 是正确的，因为“else”是不必要的，但我更喜欢前一个版本，因为意图更明显。

话虽如此，我宁愿选择：

```
return attr != null ? attr.Value : string.Empty; 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-01-21T23:08:30.983

啊，代码美学。圣战时期。*（鸭子）*

我会选择一个 ?: 表达式：

```
return attr != null ? attr.Value : String.Empty 
```

或反转 if 并删除换行符以生成[保护子句](http://www.refactoring.com/catalog/replaceNestedConditionalWithGuardClauses.html)：

```
if (attr == null) return String.Empty;

return attr.Value; 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-01-22T07:31:07.443

我认为如果您反转 if，新版本会更好

```
static public string ToNonNullString(this XmlAttribute attr)
{
    if (attr == null)
        return string.Empty;

    return attr.Value;
} 
```

因为您的原始版本过于对称，而 null-case 是一种特殊情况。

新版本在“它大部分时间返回什么？”方面更具可读性。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-21T22:58:17.403

我同意您的代码的第一个版本更具可读性。

在这些情况下，我发现 Resharper 的建议并不总是有帮助，尽管有时它可以清理问题。这就是为什么我将 Resharper 配置为将更改显示为“提示”而不是“建议”。这会导致绿色下划线不太明显，并且不会在右侧边栏中突出显示。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-25T15:38:41.553

如果您不喜欢 ReSharper 建议的方式，**只需禁用特定建议**（斜线警告斜线提示）。编码风格也是如此，我认为它是**高度可配置**的。声称 ReSharper 无法使用（引用“我很高兴地说它无法生存，这里没有人再使用它了”）只是因为您不需要 5 分钟来了解如何配置它，这简直是**愚蠢**的。

当然，您不应该让某些工具支配您的编码风格的某些部分，如果您告诉 ReSharper 不这样做，它就不会这样做。就是这么简单。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-21T23:12:42.117

您的原始代码更具可读性和可理解性 - 一目了然，您可以准确地看到导致`string.Empty`返回的条件。如果没有，您必须看到在此之前的块`else`中有返回。`if`

请记住，您是人类，天生比机器更聪明。如果它告诉你某件事更好，而你不同意，那就不要听它。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-08-25T07:10:16.793

我的编码标准*总是*使用括号（即使 if 命令之后只有一条指令）
这需要一点努力（更多的打字），但我经常相信这是非常值得的！

最常见的错误之一（并且自相矛盾地难以找到）是在 if 语句之后添加额外的指令并忘记添加括号......

所以我喜欢 Resharper 的提议。特别是在嵌套 if 语句时：

假设我们有这个代码：

```
 if (condition1)  {
      instruction1;
   }
   else {
       if (condition2) {
           instruction2;
       }
   } 
```

它可以更改为如下所示：

```
 if (condition1)  {
      instruction1;
   }       
   else if (condition2) {
      instruction2;
   } 
```

这对我来说比以前更具可读性。
*（当您有超过 2 级的嵌套语句时，它也会更加明显）*

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-21T23:18:27.673

我注意到 ReSharper 也有同样的事情，所以我很欣赏它能够关闭某些项目或降低其警告级别。我也对这个建议感到困惑：

SomeClass varName = new SomeClass();

建议更改为：

var varName = new SomeClass();

是的，我知道我*不需要*初始声明类型，但建议 var 形式在某种程度上比另一种*更好，这感觉很奇怪。*是否有人熟悉该建议背后的基本原理，或者您是否同意我的观点，即这个建议也很奇怪？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-21T23:23:09.520

当您使用小样本量时，所有情况都会出现异常的经典示例。将一个巨大的 if-elseif-else 块重构为保护子句布局使代码更具可读性，但是，正如您所说，如果您将相同的规则应用于单个 if-else，它就没有那么有用了。我什至可以说，reshaper 开发人员（略微）缺乏远见，不要跳过像这样的非常小的块，但它是无害的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-25T15:31:29.900

作为 C# 的菜鸟，更习惯于 C 和 Java，我仍然无法习惯在 C# .NET 和 VS 中放置尖括号。抛开所有这些，我同意安德烈的观点，即颠倒“如果”更具可读性。另一方面，我个人发现省略“else”会降低可读性（稍微）。我会亲自去：

```
static public string ToNonNullString(this XmlAttribute attr)
{    
    if (attr == null)
        return string.Empty;
    else
        return attr.Value;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-08-23T15:23:42.703

我唯一要补充的是所涉及的表达式的长度。就个人而言，我喜欢三元表达式的紧凑性，但转而类似于

```
if (testDateTime > BaseDateTime)
    return item.TransactionDate <= testDateTime && item.TransactionDate >= BaseDateTime;

return item.TransactionDate >= testDateTime && item.TransactionDate <= BaseDateTime; 
```

变成类似的东西

```
return testDateTime > BaseDateTime ? item.TransactionDate <= testDateTime && item.TransactionDate >= BaseDateTime : item.TransactionDate >= testDateTime && item.TransactionDate <= BaseDateTime; 
```

似乎对我没有帮助。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-10-06T11:39:22.477

当谈到最佳实践和编码标准时，它总是有争议的。原因之一是它们不能很容易地使用像 Visual Studio 这样的 IDE 来实施。有可用的工具，如 FxCop 和 StyleCop，可用于分析标准代码。FxCop 用于编译代码分析，StyleCop 用于源代码分析。

您可以将 StyleCop 配置到分钟级别，以决定您希望将哪种格式应用于代码。有一个名为 StyleCop for Resharper 的加载项，它在 Visual Studio 中提供建议。我在 [http://nileshgule.blogspot.com/2010/10/refactoring-clean-code-using-resharper.html有一篇关于相同内容的详细博客文章](http://nileshgule.blogspot.com/2010/10/refactoring-clean-code-using-resharper.html)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-02-22T15:10:30.533

resharper 版本更好，因为 'attr != null' 条件可以被视为早期救助（或用例异常路径），允许函数继续其主要任务。（也没有赢得我的击掌，我讨厌多次回报）。

在这种情况下，我会说 MrWiggles 单线是最好的选择。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-22T07:52:41.253

我的一些同事从那一刻开始在他们编辑的页面上使用 Resharper，但页面的布局和可读性很糟糕。我很高兴地说它没有生存下来，这里没有人再使用它了。

关于手头的陈述，我同意 Jeffrey Hantin 的观点，inline-if 非常适合这种类型的陈述，而且 Whatsit 的解决方案非常适合。除了一些例外，我（个人）说方法/函数应该只有 1 个返回语句。

此外，如果你（几乎）总是用你的 if 实现 else （即使它只是一个注释行，说明你在 else 语句中什么都不做）它会迫使你考虑这种情况，通常情况下它可以防止错误。

这两句话都应该用作“思考”而不是规则，就像大多数此类问题一样，请始终使用您的大脑:) 大多数错误发生在您不这样做时。

结论：对 Resharper 说不！（是的，我真的不喜欢 Resharper，抱歉。）

# security - 阻止未经所有者许可复制和使用应用程序的最佳方法是什么？

> ID：467391
> 
> 赞同：9
> 
> 时间：2009-01-21T22:52:42.513
> 
> 标签：security, delphi, piracy, remote-control

避免在所有者不知情的情况下复制和使用应用程序的最佳方法是什么？

有什么方法可以追踪使用情况吗？这意味着应用程序会定期进行通信，并提供足够的信息，以便我们知道它在哪里，以及它是否合法。接下来，当然，如果它不合法，就将其关闭。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-21T23:19:33.660

“打电话回家”的软件将很快被绝大多数用户回避。只需适当许可并出售即可。

专业使用您的软件的人要么会为此付费，要么不会使用它。公司往往对潜在的诉讼不屑一顾。

尽管您尽最大努力抵制他们，但想要不付费使用您的软件的人将继续这样做。一旦软件在他们手中，它就不再是你的了。在不激怒您的用户的情况下，您唯一的办法是合法的。

如果您的产品定价合理，有些人会为此买单，而有些人则不会。这只是您需要预先处理的事情，应该将其纳入您的业务计划。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-21T23:36:49.680

*不要这样做，不要尝试，甚至不要考虑它。*

这是一场你赢不了的战斗。如果人们想盗版你的软件，他们会的。聪明的逆向工程师可以编写一个单字节的二进制补丁来破坏您的*所有*保护方案，这会让您感到羞耻。

想要盗版您的软件的人会这样做，而您构建的所有这些“安全功能”最终可能只会给您真正的支持者带来不便：合法购买您软件的人。这些严厉的 DRM / 反盗版计划只会在软件用户中 *引起不满。*

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-09-18T05:43:14.123

如果您真的担心盗版 IMO，硬件加密狗是最好的方法。查看价值数千或数万的大型工业 CAD/CAM 软件包，或 AV/音乐制作软件，它们几乎都有加密狗保护。加密狗可以被模拟或逆转，但并非没有大量的时间投资，不仅仅是在您的装配中将几个 JE 更改为 JNE。

**打电话回家不是办法**除非您提供的服务需要订阅和不断更新（例如防病毒产品）作为您业务模型的一部分。您需要尊重您的用户及其隐私。您可能有完全无辜的意图，但如果法院命令您的公司交出该信息（就像美国政府正在对 Google 及其搜索词所做的那样），您会/会反对吗？如果您在未来某个时间出售了您的公司，而新所有者决定将所有这些历史信息出售给一家营销公司怎么办？隐私不仅仅是信任一家公司不会滥用您的数据，而是信任该公司会竭尽全力保护您的数据。对于大多数公司来说，这远远低于优先事项列表。所以基本上，

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T00:50:22.213

可靠地防止盗版的最好的（也是几乎唯一的）方法是拥有一个客户端/服务器应用程序而不是独立的应用程序，其中不重要的部分工作由服务器完成，用户需要注册。然后，您至少可以检测并阻止同时使用同一帐户。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-18T15:14:44.697

您可以采取多种方法，但其中三种方法比其他任何一种方法都更有效。

A. 不要创建它。

不存在的软件永远不会遭受未经授权的使用。

B. 不要释放它。

如果您拥有唯一的副本，并且保持这种状态，那么极有可能不会出现未经授权的使用。

C. 允许每个人使用它。

如果您不希望任何人未经许可使用它，那么您可以授予所有人权限，并且不会有未经授权的用户。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-21T23:09:33.743

有可能跟踪使用情况。您可以通过让您的工具回家并发送您需要的信息来完成此操作。这样做的问题是，首先没有人喜欢为此打电话回家的软件，其次使用简单的应用程序级网关，您可以阻止应用程序打电话回家！您在问题中描述的是软件分销商的常见问题，解决起来并不容易！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-18T15:04:47.273

还有一件事我还没有看到：您可以将大量设置添加到应用程序的配置文件中，并从可笑的默认值开始。然后亲自进行安装和配置，所以没有人可以弄清楚应该如何设置所有内容。对于那些刚刚尝试副本是否足够的人来说，这可能是市长的贬低。（请务必添加依赖于各种系统设置的设置，例如应该加载的与操作系统版本相关的 DLL 版本等）。不是很人性化 ;-)

# sdk - 任何控制台上的 PlayStation 2 游戏开发？

> ID：467394
> 
> 赞同：11
> 
> 时间：2009-01-21T22:53:28.160
> 
> 标签：sdk, playstation, video-game-consoles

我有兴趣为 Sony PlayStation 2 游戏机创建软件/游戏，因为它们包含**强大**的图形处理器 (GPU)、浮点计算和通用 CPU。

我买了一个**PS2 控制台**和它的**PS2 SDK v3.07**，据说是随 PS2 开发工具包一起提供的（售价 8,000 美元）。虽然我没有**PS2 Dev Kit 控制台**。

我可以使用我的**普通 PS2 游戏机来开发原生程序和游戏吗？**我是否需要 PS2 开发套件随附的特殊 PS2，或者我可以重新编程我的 PS2 以使其行为如此？只要我可以**编写代码**并**让它**在 PS2 上运行，我不介意缺少调试功能！

此外，随 PS2 开发套件提供的 PS2 是否是具有额外/**不同硬件的特殊产品？**或者只是为了拥有调试设施等而使用**不同的操作系统？**

这是我在 PS2 SDK 中得到的：

*   PlayStation 2 程序员工具工具链 EE 3.2-ee-030926
*   PlayStation 2 程序员工具运行时库版本 3.0.2
*   PlayStation 2 Programmer Tool Runtime Library NTGUI 包 Release 3.0
*   PlayStation 2 CD/DVD-Rom 发生器 1.5
*   PlayStation 2 CD/DVD-Rom 发生器 2.0
*   适用于 PlayStation 2 的 ProDG
*   ProDG 工具许可证 (PlayStation 2)
*   ProDG 目标管理器和 ProDG NDK 分析器的许可证
*   GCC ee 3.2 ee Cygwin
*   硬件文档（例如指令集手册、用户指南等）

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T00:37:03.943

[在您的 PS2 上](http://en.wikipedia.org/wiki/Linux_for_PlayStation_2)安装Linux ，然后以**PS2 Linux**为目标，类似于**Red Hat Linux 6**。

> 该 Linux 套件的文档将提供有关索尼为其授权游戏开发商提供的 PS2 硬件的所有相同信息，以及有关 PS2 专有的**情感引擎**核心指令集、**图形合成器**和**矢量处理单元**的完整详细信息。~[使用 Linux 打开 PlayStation 2](http://www.linuxdevcenter.com/pub/a/linux/2002/03/21/linuxps2.html)

[从 Sony 的PlayStation 2 开发者网络](http://playstation2-linux.com/)开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T11:22:51.017

我认为[linuxdevcenter.com 上的这篇文章](http://www.linuxdevcenter.com/pub/a/linux/2002/03/21/linuxps2.html)涵盖了您所询问的所有内容以及更多内容。

祝你好运！

# c - 服务器可以使用相同的套接字将响应发送给客户端吗？如何？

> ID：467396
> 
> 赞同：12
> 
> 时间：2009-01-21T22:54:48.983
> 
> 标签：c, deadlock, sockets

我正在使用 Berkeley 套接字（包括：Internet 域和 Unix 域），我想知道服务器是否可以使用相同的套接字来读取请求并将响应写入客户端。或者客户端应该创建另一个套接字来等待重播，服务器在处理收到的消息后连接到它。

顺便说一句，我说的是面向连接的套接字（流套接字，TCP，...）。

这是简化的服务器代码（为了简单起见，我在这里省略了对系统调用的错误检查）：

```
int main() {

    int server_socket, connected_socket;
    struct sockaddr_in server_addr;
    char buf[1024];
    char aux[256];
    int bytes_read;

    server_socket = socket(AF_INET, SOCK_STREAM, 0);    

    server_addr.sin_family = AF_INET;
    server_addr.sin_addr.s_addr = INADDR_ANY;
    server_addr.sin_port = htons(1234);
    bind(server_socket, &server_addr, sizeof(server_addr))

    listen(server_socket, 5)

    connected_sodket = accept(server_socket, 0, 0);
    do {
        bzero(buf, sizeof(buf));
        bytes_read = read(connected_socket, buf, sizeof(buf));        
    } while (bytes_read > 0);          

    /* Here I want to use connected_socket to write the reply, can I? */

    close(connected_socket);       

    close(server_socket);

    return (EXIT_SUCCESS);
} 
```

这是简化的客户端代码（为了简单起见，我在这里省略了对系统调用的错误检查）：

```
int main() {

    int client_socket;
    struct sockaddr_in server_addr;

    client_socket = socket(AF_INET, SOCK_STREAM, 0);

    hp = gethostbyname("myhost");
    server_addr.sin_family = AF_INET;
    memcpy(&server_addr.sin_addr, hp->h_addr_list[0], hp->h_length);
    server_addr.sin_port = htons(1234);

    connect(client_socket, &server_addr, sizeof(server_addr));

    write(client_socket, MSG, sizeof(MSG));

    /* Here I want to wait for a response from the server using client_socket, can I? */

    close(client_socket);

    return (EXIT_SUCCESS);
} 
```

我可以`connected_socket`在服务器和`client_socket`客户端中使用来传回响应消息吗？或者我应该使用“接受”时在服务器中获得的客户端地址连接到客户端中的套接字？

我尝试在显示评论的客户端/服务器中使用读/写，但这样两个程序都被阻止，这似乎是一个死锁。

提前感谢ins！问候。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-21T23:07:16.137

您*应该*使用相同的套接字！

您的应用程序协议明确定义了客户端和服务器何时应该等待数据或相互发送消息；假设一个协议只有一个来自客户端的请求和一个来自服务器的响应，以下应该成立：

* * *

*   客户端与服务器建立连接；
*   客户端发送其请求（使用 send()）；
*   客户端通过协议*知道服务器会回复；*因此它在同一个套接字上等待数据（recv()）；
*   验证响应后，客户端可以关闭套接字。

* * *

*   服务器接受来自客户端的连接；
*   服务器*知道*第一步取决于客户端，因此它等待数据（recv()）；
*   服务器验证请求；
*   服务器现在从协议中*知道*客户端正在等待数据；因此它使用 send() 发送响应；
*   服务器从协议中*知道*没有进一步的步骤；因此它可以关闭套接字。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-21T23:29:38.993

您可以使用相同的套接字，但您的程序设置为让服务器在尝试回复之前读取客户端发送的所有内容。因此，在客户端关闭其套接字的写入端之前，服务器中的循环不会完成，因此服务器会获得 EOF（读取 0 字节），因此服务器将永远不会发回其响应。

有几种方法可以解决这个问题。

1.  您可以在看到整个请求后中断服务器中的循环，而不是读取直到 EOF。这要求客户端发送的数据以某种方式自定界，以便服务器可以知道它何时读取所有数据。
2.  您可以使用第二个连接进行回复。可能不是最好的。
3.  您可以使用套接字的不对称关闭。让客户端`shutdown(client_socket, SHUT_WR)`半关闭套接字。然后服务器将看到 EOF（并且循环将完成），但套接字上的另一个方向仍将打开以进行回复。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-21T23:04:04.333

是的，这是可能的。查看[此页面](http://www.beej.us/guide/bgnet/output/html/singlepage/bgnet.html#simpleserver)以获取简单服务器（和简单客户端）的示例。请注意，服务器通常将“接受”文件描述符传递给新进程，以便它可以继续侦听更多传入连接

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T23:31:13.467

您不仅应该使用相同的套接字（如 Federico 所说），实际上*还必须*使用相同的套接字才能让返回的数据包通过防火墙。

防火墙知道 TCP 连接，如果防火墙内的机器启动了连接，它会自动允许返回的数据通过。相反，如果您尝试从外部创建一个新的 TCP 套接字，防火墙将阻止它，除非该流量被特别允许。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T23:01:12.747

是的，SOCK_STREAM 套接字是双向的。您应该能够在连接的每一侧读取和写入相同的套接字。手册页`socket(2)`对此有更多详细信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-21T23:01:31.903

是的你可以。TCP 套接字是双向的。只需使用相同的 read() 和 write() 函数。还要确保检查对 connect()、read()、write() 等的所有调用的错误情况，因为您无法控制网络上发生的情况。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-21T23:14:52.733

对不起; 我没有说，但我确实像这样尝试过

注释所在的服务器中的此代码：

```
write(connected_socket, "Ok, I got it", sizeof("Ok, I got it")); 
```

以及注释所在的客户端中的此代码：

```
read(client_socket, buf, sizeof(buf)); 
```

两个程序都被阻止，当我杀死客户端时，服务器会显示它收到的消息（在服务器调用**read**之后我有一个 printf ）。

我尝试使用 send 和 recv （都带有 0 标志）而不是 read 和 write 并且它没有改变。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-21T23:26:42.103

在您当前的设置中，服务器会尝试读取，直到客户端关闭套接字，而客户端在服务器应答之前不会关闭套接字。因此，您有一种“僵局”。服务器没有停下来读取，希望有更多的数据到达，而客户端无法告诉服务器它已经完成了。

您需要某种方式让服务器识别请求已完成，而连接仍处于打开状态。例如，如果您通过换行符终止您的请求，服务器可以检查它是否收到完整的行，然后停止阅读并发送答案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-21T23:00:42.297

你试过了吗？当您实际将代码放在指示的位置时，它看起来应该可以工作

# java - 我可以从网页执行 shell 脚本吗？

> ID：467399
> 
> 赞同：2
> 
> 时间：2009-01-21T22:56:41.600
> 
> 标签：java, jsp, shell, cron

我的网页上传了一个文件。目前，它将该文件放在一个由 cron 作业轮询的目录中。如果该文件存在，则 bash 脚本将作用于该文件。我讨厌我正在投票的事实。上传可能每周发生一次，但用户希望在几分钟内从他们的文件中看到结果，所以我最终每 5 分钟轮询一次。

因此，我不想轮询，而是想在上传完成后调用脚本。如何让我的网页启动 bash 脚本。网页是用 JSP 编码的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T23:06:37.713

So long as you haven't got a `SecurityManager` set, you can use `Runtime.exec` to call an executable program. In particular you can run `/bin/bash` (or whatever path it is to your shell). Note the `-c` option for shells.

As LFSR points out, this is the sort of thing likely to be full of security flaws.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-01-21T23:37:05.000

Why don't you do this from your app? It won't be very hard to implement an FTP client in Java. Surely there are open/free libraries to accomplish this somewhere. I don't believe this script does anything that you can't do in Java. A message driven bean with the FTP code should be enough. Your server is not FTP? Well, installing FTP isn't that hard either.

# asp.net-mvc - 创建 ViewPage 服务器端代码片段

> ID：467401
> 
> 赞同：0
> 
> 时间：2009-01-21T22:57:07.700
> 
> 标签：asp.net-mvc, .net-3.5, c#-3.0, code-snippets

我正在处理一个 ASP.NET MVC 项目，并且我有许多节点片段需要插入到多个页面中。我非常想知道是否有可能有一段代码可以放在外部文件中并从 ViewPage 中调用。在某种程度上，这类似于从 class.cs 文件中调用一个类。

这是一个示例代码片段：

```
<% Amazon.ECS.Model.Cart leftCart = ViewData["leftCart"] as Amazon.ECS.Model.Cart %>
<strong>Total: </strong>
<%= leftCart.SubTotal.FormattedPrice%><br />
<strong>Items: </strong>
<%= leftCart.CartItems.CartItem.Count%>
<center>
<a href="<%= leftCart.PurchaseURL %>">
<img style="float: right; margin-top: 20px;" src="/../../Content/Images/checkout.gif"
/></a></center> 
```

是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T23:00:58.240

您可以使用查看用户控件。它们本质上是`ascx`文件，其行为与其对应的 Web 表单大致相同。主要区别在于它们继承自`System.Web.Mvc.ViewUserControl`而不是`System.Web.UI.UserControl`.

您可以使用`<% @Register %>`标签`<prefix:Name runat="server" />`或使用`Html.RenderPartial`方法嵌入它们。

# c# - 如何动态添加或删除数据网格视图中的列

> ID：467402
> 
> 赞同：3
> 
> 时间：2009-01-21T22:57:24.877
> 
> 标签：c#, winforms

我的 .NET 应用程序中有一个 DataGridView 表单，我希望能够在运行时根据布尔值显示或隐藏其他列。

在代码中显示/隐藏这些列的最佳方式是什么（而不是在表单设计器中）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T23:07:25.887

最简单的选项（如果提前知道列）是像往常一样添加它们，然后[`Visible`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcolumn.visible.aspx)在运行时（在每个上）适当地设置。

您还可以在运行时完全添加额外的列（如果您无法预测架构） - 但请注意，根据您是否使用数据绑定（即 a [`DataSource`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.datasource.aspx)），这可能会有所不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-21T23:08:04.527

DataGridView 包含一个属性Columns，它是一个DataGridViewColumnCollection。

我相信在这个集合中，您可以设置哪些列存在，以及它们是否可见。

有关更多信息，请从此处开始：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.columns.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.columns.aspx)

# delphi - 如何在自定义 TGraphicControl 上拉伸绘制两个并排的图形？

> ID：467403
> 
> 赞同：3
> 
> 时间：2009-01-21T22:57:25.530
> 
> 标签：delphi, paint

我正在编写我的 Delphi TGraphicControl 绘制程序。

我创建了一个画布并将其拉伸到图形区域。它运作良好。

然后我在图形区域上使用另一个 Stretchdraw 重复此操作，但它是在第一个 Stretchdraw 的区域中绘制的，而不是在我引导它时绘制到图形区域上。

有没有一种方法可以在 TGraphicControl 的画布中将两个拉伸绘制并排放置？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-21T23:20:08.263

[`TCanvas.StretchDraw`](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/Graphics_TCanvas_StretchDraw.html) paints a graphic onto a canvas in a given rectangular area. The rectangle should, but does not need to be, within the bounds of the canvas. The owner of the canvas determines those bounds. In your case, it sounds like the canvas owner is the `TGraphicControl` object.

If you want two graphics to be painted beside each other, then the `TRect` you use to draw the first graphic should represent a rectangle that is adjacent to the `TRect` you use for the second graphic. You haven't shown any code yet, so it's hard to tell what's going wrong.

If you use the same `TRect` variable for both calls to `StretchDraw`, then you need to make sure you *modify* the rectangle's position between the calls — change the `Left` property, for starters.

For example:

```
var
  r: TRect;
begin
  r := ClientRect;
  // First rectangle takes up left half of control
  r.Right := r.Right div 2;
  Canvas.StretchDraw(r, graphic1);

  // Shift the rectangle to the right half
  r.Left := r.Right;
  r.Right := ClientRect.Right;
  Canvas.StretchDraw(r, graphic2);
end; 
```

# cocoa-touch - How to create a font with CGFontCreateWithFontName?

> ID：467404
> 
> 赞同：1
> 
> 时间：2009-01-21T22:57:31.133
> 
> 标签：cocoa-touch, fonts, core-graphics

I want to have a greater control on how and when fonts are loaded and released, therefore I'm interested in getting CGFontCreateWithFontName() to work.

```
GContextRef ctx = UIGraphicsGetCurrentContext();
CGContextSelectFont(ctx, "Georgia", 20.0, kCGEncodingMacRoman);
// DRAWING WITH CGContextShowTextAtPoint() IS WORKING... 
```

* * *

```
GContextRef ctx = UIGraphicsGetCurrentContext();
CGFontRef fontRef = CGFontCreateWithFontName((CFStringRef)@"Georgia");
CGContextSetFont(ctx, fontRef);
CGContextSetFontSize(ctx, 20.0);
// DRAWING WITH CGContextShowTextAtPoint() IS NOT WORKING... 
```

Any clue on what's wrong with the 2nd block?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T00:45:10.047

看看[文档](https://developer.apple.com/documentation/coregraphics/1586505-cgcontextshowtextatpoint)：

> Quartz 使用 Apple Type Services (ATS) 提供的字体数据，通过当前字体的编码向量映射数组的每个字节，得到要显示的字形。请注意，必须使用 CGContextSelectFont 设置字体。**不要将 CGContextShowTextAtPoint 与 CGContextSetFont 结合使用**。

您想改用[CGContextSelectFont](https://developer.apple.com/documentation/coregraphics/1586511-cgcontextselectfont?language=objc)。

# .net - WCF 在负载下失败 - MessageSecurityException

> ID：467410
> 
> 赞同：1
> 
> 时间：2009-01-21T23:00:00.113
> 
> 标签：.net, wcf, load-testing, stress-testing

我正在对我的网站进行负载测试。该站点使用 clientCredentialType="Windows" 调用在同一机器上运行的 WCF 服务。一切正常，直到我达到一定的负载（甚至不是很高），然后我收到以下错误：

> System.ServiceModel.Security.MessageSecurityException：HTTP 请求被客户端身份验证方案“匿名”禁止。----> System.Net.WebException：远程服务器返回错误：（403）禁止。

每次通话时，我都会创建一个频道：

```
var proxy = (IClientChannel)channelFactory.CreateChannel(); 
```

成功后，我关闭：

```
proxy.Close(); 
```

出错时，我中止：

```
proxy.Abort(); 
```

有什么想法吗？我可以做些什么来更好地处理负载？要找什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T23:15:44.200

您的服务是会话服务还是您不担心在调用之间保持状态？如果您没有状态，您可能希望将您的服务标记为 PerCall 服务。这将确保服务实例仅在客户端调用正在进行时才存在。

Juval Lowy 的优秀著作“Programming WCF Services”第 2 版的第 4 章涵盖了这个主题。

默认值为 PerSession，这可能不是您想要的。

另外，请参阅 MSDN：如何：[控制服务实例化](http://msdn.microsoft.com/en-us/library/ms734715.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T00:26:52.667

谢谢特里。不，我的服务不保持状态。我尝试用以下方式装饰我的服务类：

```
[ServiceBehaviorAttribute(InstanceContextMode = InstanceContextMode.PerCall)] 
```

没有帮助。故障点似乎是大约 4 个并发调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T02:48:27.877

问题是，啊，我在我的开发机器上运行测试，它是 XP，它使用 IIS 5，它有 10 个连接的限制。

# database - 就数据共享而言，解耦数据库设计的最佳方法是什么？

> ID：467420
> 
> 赞同：3
> 
> 时间：2009-01-21T23:02:56.003
> 
> 标签：database, oracle, database-design, plsql

我有一系列需要访问彼此数据的 Oracle 数据库。最有效的方法是使用数据库链接——设置几个数据库链接，我可以轻松地从 A 到 B 获取数据。对我来说，问题是你最终会得到一个紧密耦合的设计，如果一个数据库出现故障，它可以带来耦合的数据库（或者可能是这些数据库上应用程序的一部分）。

您尝试过哪些替代方法在 Oracle 数据库之间共享数据？

**几个回复后更新...**

我并没有考虑太多的复制，更多的是访问“主数据”。例如，如果我有一个包含货币兑换率的中央数据库，并且我想将汇率提取到单独的数据库（应用程序）中。对于这样一个小数据集，igor-db 对 DB 链接的物化视图的建议会很好地工作。但是，当您从一个非常大的数据集中动态采样时，本地缓存的选项开始变得更加棘手。在这种情况下你会选择什么选择。我想知道 XML 服务，但 tuinstoel（在对 le dorfier 的回复的评论中）正确地质疑所涉及的开销。

**回复摘要...**

总的来说，我认为 igor-db 是最接近的，这就是我接受这个答案的原因，但我想我会添加一些以提出其他一些答案。

出于我的目的，我只关注数据复制，看起来 Oracle BASIC 复制（而不是 ADVANCED）复制适合我。在主站点上使用物化视图日志并在快照站点上使用物化视图看起来是一种很好的前进方式。

如果这不是一个选项，也许是数据量使全表复制成为问题，那么消息传递解决方案似乎是最合适的 Oracle 解决方案。Oracle Advanced Queuing 似乎是设置消息传递解决方案的最快、最简单的方法。

最不受欢迎的方法似乎是滚动您自己的 XML Web 服务，但只有在高级队列的相对简单性不是一个选项的情况下。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T01:01:34.687

Streams 是 Oracle 复制技术。您可以在数据库链接上使用 MV（因此数据库“A”具有数据库“B”中数据的物化视图。如果“B”出现故障，则无法刷新 MV，但数据仍在“A”中） .

里程可能取决于数据库容量、更改容量......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T23:31:27.180

如果您需要同时同步访问多个数据库，它在我看来就像定义上的紧密耦合。

例如，如果这是关于传输数据的，并且它可以是异步的，您可以在两者之间安装一个消息队列并拥有两个进程，一个从源读取，另一个写入接收器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T09:43:25.837

OP提供了更多信息。他说数据集非常大。那么大有多大？主表多久更改一次？

使用物化视图日志，Oracle 只会传播主表中所做的更改。不需要完全刷新数据。Oracle 流也只将修改传达给另一方。

购买存储很便宜，那么为什么不使用本地缓存呢？比编写自己的解决方案便宜得多。

当数据库不可用时，XML 服务对您没有帮助，所以我不明白为什么它会有所帮助？Oracle 有许多复制选项，请探索它们。

**编辑**

我已经构建了 xml 服务。它们通过清晰的接口（合同）在不同系统之间提供互操作性。您可以在 C# 中构建 xml 服务并使用 Java 使用该服务。然而 xml 服务并不快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T18:55:02.497

为什么不使用高级队列？为什么推出您自己的 XML 服务来在 Oracle 实例之间移动消息 (DML) - 它已经存在。当它们都启动时，您可以让传播将消息从一个实例移动到另一个实例。您可以根据需要在目标服务器中处理它们。AQ 的设置和使用非常简单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T10:20:25.540

为什么它们需要是单独的数据库？

拥有具有多个模式的单个数据库/实例可能会更容易。

保持一个数据库（使用适当的备用数据库等）比保持 N 更容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T19:20:52.273

您需要什么样的即时性以及多少双向性？如果数据可能有点旧并且可以从一个“主源”中提取，请创建一系列按计划运行的简单 ETL 脚本，以将数据从“源”数据库中提取到其他数据库中。

然后，您可以定制数据结构以更精确地满足客户端数据库的需求，并且您可以更改源数据的结构，直到您脸色发青。

# javascript - top.document 是跨浏览器吗？

> ID：467421
> 
> 赞同：1
> 
> 时间：2009-01-21T23:03:09.263
> 
> 标签：javascript, cross-browser

我正在编写一个依赖于 top.document 的 javascript，但我不确定是否可以假设所有主要浏览器都支持它。

top.document 是否跨浏览器兼容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T23:07:17.587

根据[W3Schools](http://www.w3schools.com/htmldom/dom_obj_window.asp)的说法，window.top 在 IE（自 v4 起）、FF (v1) 和 Opera (v9) 中受支持。我可以亲自担保它在 Safari 中工作，因为我刚刚在我自己的浏览器中尝试了他们的示例代码。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T23:07:33.840

我从未使用过它，但我相信它是。

嵌套框架是如此过时。

查看有关该主题的这篇方便的[Quirksmode 文章。](http://www.quirksmode.org/js/frameintro.html)

# asp.net-mvc - 我应该调用我的每个 MVC 视图 Index.aspx 吗？

> ID：467438
> 
> 赞同：2
> 
> 时间：2009-01-21T23:08:12.357
> 
> 标签：asp.net-mvc, convention

如果我没记错的话 - ASP.NET MVC 的约定似乎希望我为控制器视图执行以下操作。

就在今天，我创建了“产品”目录，并在其中放置了“索引”视图。然后我创建一个“ProductsController”并在其上创建一个返回视图的“索引”方法。仅返回不带参数的 View() 将去获取“Index.aspx”页面，因为它与方法名称相同。

```
 public class ProductsController : Controller
    {
        public ActionResult Index()
        {
            return View();   // looks for Index.aspx in Products directory
        }
    } 
```

现在就好了。但是我最终会得到 10 亿个 Index.aspx 页，而且我是那些从不关闭任何文件的人之一，所以我最终会发疯。

或者，我可以创建 Products/Products.aspx 并将我的控制器更改为以下内容：

```
 public class ProductsController : Controller
    {
        public ActionResult Index()  // my default routing goes to Index (from sample project)
        {
            return View("Products");
        }
    } 
```

我了解它是如何工作的，并且在 MVC 设计模式中完全可以做到这一点。它不是黑客或类似的东西。

我的问题（在听了[这个](http://channel9.msdn.com/pdc2008/PC21/)PDC 视频之后）是 MVC 中优先考虑可定制性的约定（或者任何正确的短语）。

所以我想知道我是否错过了第三种方式，或者人们是否可以在 Visual Studio 中使用 50 个索引选项卡？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T23:27:47.233

我认为你应该在动作之后命名方法并命名视图（如果它有意义并且它不在动作之间共享，则与动作相同）。您可能应该更改您的路由机制，因为`Index`它并不是一个真正的描述性名称。动作名称应该代表它的作用（就像任何方法一样）并且不应该被硬编码`Index`或类似的东西。应改为编辑路由。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T23:05:27.900

让每个控制器的默认操作具有相同的名称只会简化路由（检查 global.asax）。此外，所有事物（产品、书籍、联系人……）都使用具有相同名称的操作/视图来实现相同的功能，这样代码就变得更易于导航和理解。当作为团队的一部分工作时，这种约定的使用尤其重要，因为它将鼓励开发人员之间的代码一致。

在查看另一个问题时，我在 codeplex 的 MVCContrib 项目中遇到了[SimplyRestfulRouting](http://www.codeplex.com/MVCContrib/Wiki/View.aspx?title=SimplyRestfulRouting)。这可能会给你一些想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T23:18:04.537

这只是一个模式。使用模式，但让它为你工作。就我个人而言，我喜欢按其功能命名我的视图，并且我没有很多 Index.aspx 页面，因为我没有很多索引。

# random - 创建唯一的 10 个字母数字字符串

> ID：467444
> 
> 赞同：8
> 
> 时间：2009-01-21T23:10:22.557
> 
> 标签：random, unique

我正在寻找创建一个简单的短期预订系统，我想生成确认号码

*   独特
*   随机的
*   字母数字
*   短，至少比 sha1 返回的 32 个字符长的字符串短得多

我只希望有大约 500 个预订，所以我不认为*碰撞*的可能性很大。

我的一个想法是根据日期时间戳和用户名生成一个 sha1 哈希，然后将其截断为前 10 个字符。对于处理约 500 个预订的目的，这样的东西是否足够可靠？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T23:14:46.883

SHA-1 哈希的任何给定位的随机性应该没有区别，所以这是可能的。另一种方法是使用 XOR 将哈希折叠到自身中，直到您拥有 60 位的数据，然后使用[Base 64](http://en.wikipedia.org/wiki/Base64)对其进行编码以获得主要是字母数字的结果。

仅当您希望能够为相同的输入数据重复生成相同的 Id 时，才需要这样做。否则，如果您生成一次随机 id，并在此之后保留，请使用 Anders 的建议。如果您遇到冲突，只需生成另一个。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T23:19:50.667

你可以使用任何东西，甚至是一个普通的随机数生成器；但是，您应该检查预订代码是否已存在。如果是这种情况，请在字符串 (date+user) 中添加字符 ('x')，直到获得新的 random/sha1/etc。

> 我只希望有大约 500 个预订，所以我不认为碰撞的可能性很大。

另一个愚蠢的想法：生成 1000 或 2000 个具有所需属性的唯一随机数，将它们存储在某个地方，并在用户注册时将它们分配给用户 :)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T23:14:30.660

这是在 Perl 中执行此操作的一种方法：

```
子 get_random_name()
{
  我的@chars=('a'..'z','A'..'Z');
  我的 $random_string;foreach (1..22)
  {
    # rand @chars 会随机生成一个
    # 介于 0 和标量之间的数字 @chars
    $random_string .= $chars[rand @chars];
  }
  返回 $random_string 。“-”。时间（）;
}

```

我不记得 time() 部分有多长，因此您可能需要调整数字以适合您的长度。如果不需要，也可以删除该部分。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T00:26:04.947

如果真的只有 500 个，那么将其中的 20,000 个预先生成到一个表中，然后在需要时获取“下一个未使用的”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T00:15:42.767

关于这个问题的一些好的提示：[如何在 C++ 中创建随机字母数字字符串？](https://stackoverflow.com/questions/440133/how-do-i-create-a-random-alpha-numeric-string-in-c)

我会避免在您的字符串中包含“1”、“l”和“O”、“0”和“5”、“S”和“Z”、“2”等字符，以方便客户使用当他们需要通过电话读取您的预订代码时。该链接上提供的算法应该可以帮助您做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T23:54:24.277

使用指南？16 个字符，不过如果你真的不关心碰撞，你可以选择前 n 个字符。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-04T13:01:20.673

在 C# 中，您可以使用[http://www.dotnetfunda.com/forums/thread1357-how-do-generate-unique-alpha-numeric-random-number-in-aspnet.aspx](http://www.dotnetfunda.com/forums/thread1357-how-do-generate-unique-alpha-numeric-random-number-in-aspnet.aspx)（他们说超级简单的方法）

# c# - C# 委托和线程！

> ID：467446
> 
> 赞同：4
> 
> 时间：2009-01-21T23:11:05.113
> 
> 标签：c#

我到底需要什么委托和线程？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-21T23:19:16.377

委托充当函数指针的逻辑（但安全）等价物；它们允许您以抽象的方式谈论操作。典型的例子是事件，但我将使用更“函数式编程”的例子：在列表中搜索：

```
List<Person> people = ...
Person fred = people.Find( x => x.Name == "Fred");
Console.WriteLine(fred.Id); 
```

这里的“lambda”本质上是一个委托的实例——一个类型的委托`Predicate<Person>`——即“给定一个人，是真还是假”。使用委托允许非常灵活的代码 - 即该`List<T>.Find`方法可以根据调用者传入的委托找到各种事物。

通过这种方式，它们在很大程度上类似于 1-method 接口 - 但更简洁。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-21T23:15:43.450

[委托](http://msdn.microsoft.com/en-us/library/ms173171(VS.80).aspx)：基本上，委托是一种引用方法的方法。它就像一个指向方法的指针，您可以将其设置为与其签名匹配的不同方法，并使用它来传递对该方法的引用。

[线程](http://en.wikipedia.org/wiki/Thread_(computer_science))是一个连续的指令流，它们一个接一个地执行以完成计算。您可以同时运行不同的线程来完成特定任务。线程在单个逻辑处理器上运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T23:14:26.073

委托用于动态地向事件添加方法。

线程在进程内部运行，并允许您一次运行 2 个或更多共享资源的任务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T23:17:59.483

我建议搜索这些术语，那里有很多信息。它们是非常基本的概念，wiki 是一个高层次的起点：

[http://en.wikipedia.org/wiki/Thread_(computer_science)](http://en.wikipedia.org/wiki/Thread_(computer_science))
[http://en.wikipedia.org/wiki/C_Sharp_(programming_language)](http://en.wikipedia.org/wiki/C_Sharp_(programming_language))

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T23:22:59.630

具体的例子总是对我有帮助，所以这里是一个线程。考虑您的网络服务器。当请求到达服务器时，它们被发送到 Web 服务器进程进行处理。它*可以*在到达时处理每个请求，完全处理请求并在转向下一个页面之前生成页面。但是请考虑在响应完成之前从磁盘中提取请求的页面（或从数据库中提取数据）时，有多少处理是以硬盘驱动器速度（而不是 CPU 速度）进行的。

通过从线程池中提取线程并为每个请求提供自己的线程，我们可以在磁盘为第一个请求返回数据之前处理数百个请求的非磁盘需求。这将允许一定程度的虚拟并行性，可以显着提高性能。请记住，Web 服务器性能还有很多其他方面，但这应该为您提供一个具体的模型来说明线程如何发挥作用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-21T23:24:40.390

它们有用的原因与高级语言有用的原因相同。您不需要它们来做任何事情，因为实际上它们只是对实际发生的事情的抽象。它们确实使事情变得更容易和更快地编程或理解。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-23T03:24:43.307

Marc Gravell 为“什么是代表”提供了一个很好的答案。

Andrew Troelsen 将线程定义为

> ...进程中的执行路径。“Pro C# 2008 和 .NET 3.5 平台，”APress。

在您的系统上运行的所有进程都至少有一个线程。我们称之为主线程。您可以出于各种原因创建其他线程，但说明线程用途的最明显示例是打印。

假设您打开您最喜欢的文字处理应用程序 (WPA)，键入几行，然后想要打印这些行。如果您的 WPA 使用主线程打印文档，则 WPA 的用户界面将被“冻结”，直到打印完成。这是因为主线程必须在处理任何用户界面事件之前打印这些行，即按钮单击、鼠标移动等。就好像代码是这样编写的：

```
 do
    {
        ProcessUserInterfaceEvents();
        PrintDocument();
    } while (true); 
```

显然，这不是用户想要的。用户希望用户界面在文档打印时能够响应。

答案当然是在第二个线程中打印这些行。这样，用户界面可以专注于处理用户界面事件，而辅助线程专注于打印行。

错觉是这两个任务同时发生。在单处理器机器上，这是不可能的，因为处理器一次只能执行一个线程。但是，线程之间的切换发生得如此之快，以至于通常会保持这种错觉。在多处理器（或多核）机器上，这实际上是正确的，因为主线程可以在一个处理器上运行，而辅助线程可以在另一个处理器上运行。

在 .NET 中，线程是轻而易举的事。您可以利用 System.Threading.ThreadPool 类、使用异步委托或创建自己的 System.Threading.Thread 对象。

如果您不熟悉线程，我会提出两个警告。

首先，如果您选择了错误的线程模型，您实际上会损害应用程序的性能。小心避免使用太多线程或尝试线程化真正应该按顺序发生的事情。

其次（更重要的是），请注意，如果您在线程之间共享数据，您可能需要同步访问该共享数据，例如，使用 C# 中的 lock 关键字。网上有很多关于这个主题的信息，所以我不会在这里重复。请注意，如果您不仔细执行此操作，您可能会遇到间歇性的、并非总是可重复的错误。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-21T23:24:14.587

你的问题含糊其辞...

但是您可能只是想知道如何使用它们以便有一个窗口、一个耗时的进程运行和一个进度条......

所以创建一个线程来做耗时的过程并使用委托来增加进度条！:)

# flash - 使用 URLRequest 发布表单时，如何包含来自浏览器会话的 cookie？

> ID：467449
> 
> 赞同：4
> 
> 时间：2009-01-21T23:12:09.900
> 
> 标签：flash, cookies, urlrequest

（参考[这个答案](https://stackoverflow.com/questions/467223/in-drupal-how-to-make-login-state-consistent-between-browser-pages-and-embedded#467405):)

当我使用 URLRequest 发布时，它是否会自动包含来自托管 Flash 的浏览器会话的 cookie？如果没有，我怎样才能让它包含它们，或者如果有必要检索它们并自己包含它们？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-21T23:53:23.890

如果 cookie 域（托管 Flash 控件的页面和您发布的 URL）匹配，那么是的，浏览器 cookie 默认随请求一起发送。作为一个简单的示例（[此处的工作版本](http://test.enunciato.org/cookietest.cfm)），我整理了一个简单的 ColdFusion 页面，该页面托管了一个包含以下代码的 SWF：

```
<mx:Script>
    <![CDATA[

        private function btn_click():void
        {
            var req:URLRequest = new URLRequest("http://test.enunciato.org/test.cfm");
            req.method = URLRequestMethod.POST;

            var postData:URLVariables = new URLVariables();
            postData.userName = "Joe";
            postData.userCoolness = "very-cool";

            req.data = postData;
            navigateToURL(req);
        }

    ]]>
</mx:Script>

<mx:Button click="btn_click()" label="Submit" /> 
```

...在该页面中，我设置了一个名为“USERID”的cookie，其值为“12345”。单击提交并导航到另一个 CFM 后，我的服务器日志显示请求中传递的 cookie：

> POST /test.cfm HTTP/1.1 Mozilla/5.0
> ASPSESSIONIDAASRDSRT=INDFAPMDINJLOOAHDELDNKBL;
> JSESSIONID=60302395a68e3d3681c2;
> **USERID=12345**
> test.enunciato.org 200

如果您自己进行测试，您也会在其中看到 postData。

有道理？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-14T13:05:20.487

我假设您只是不想在服务器端包含会话 id 之类的内容以进行身份​​验证。

从 AS 获取浏览器 cookie（需要启用 javascript，对大多数用户来说应该不是问题）

```
public var cookieStr:String;
public var cookieHeader:URLRequestHeader;
ExternalInterface.call('eval','window.cookieStr = function () {return  document.cookie};')
cookieStr = ExternalInterface.call('cookieStr'); 
cookieHeader = new URLRequestHeader("Cookie",cookieStr); 
```

然后，在使用您的 URLRequest 对象时：

```
var urlRequest:URLRequest = new URLRequest(...blah blah, url here, etc etc);
urlRequest.requestHeaders.push(cookieHeader); 
```

请注意，Firefox**不会**将会话的 cookie 与 URLRequest 一起发送，您将需要与上述类似的解决方案来解决此问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T23:54:10.940

不确定闪存。但是你不能序列化 cookie 并将其放入 URL 中吗？

也许您想加密数据或以纯文本形式传输它，但它可能看起来像：

网址：

```
www.example.com?newurl&cookiesession=true&cookieusername=bob 
```

ETC

（或者我错过了什么？）

# mysql - 从命令行将 mysql 数据库转储到纯文本 (CSV) 备份

> ID：467452
> 
> 赞同：97
> 
> 时间：2009-01-21T23:13:15.127
> 
> 标签：mysql, command-line, csv, backup

我想避免使用 mysqldump，因为它以只方便 mysql 读取的形式输出。CSV 似乎更通用（每个表一个文件就可以了）。但是，如果 mysqldump 有优势，我会全力以赴。另外，我想要一些可以从命令行（linux）运行的东西。如果那是一个 mysql 脚本，那么指向如何制作这样的东西的指针会很有帮助。

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2009-01-21T23:18:03.400

如果您可以一次处理一张表，并且您的数据不是二进制的，请使用该命令的`-B`选项。`mysql`使用此选项，它将生成 TSV（制表符分隔）文件，这些文件可以很容易地导入 Excel 等：

```
% echo 'SELECT * FROM table' | mysql -B -uxxx -pyyy database 
```

或者，如果您可以直接访问服务器的文件系统，请使用[`SELECT INTO OUTFILE`](http://dev.mysql.com/doc/refman/5.0/en/select.html)它可以生成真正的 CSV 文件：

```
SELECT * INTO OUTFILE 'table.csv'
    FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
    LINES TERMINATED BY '\n'
FROM table 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-01-21T23:38:59.567

在 MySQL 本身中，您可以指定 CSV 输出，例如：

```
SELECT order_id,product_name,qty
FROM orders
INTO OUTFILE '/tmp/orders.csv'
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n' 
```

来自[http://www.tech-recipes.com/rx/1475/save-mysql-query-results-into-a-text-or-csv-file/](http://www.tech-recipes.com/rx/1475/save-mysql-query-results-into-a-text-or-csv-file/)

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-05-09T18:00:39.677

您可以使用`mysqldump's --tab`选项一次性转储整个数据库。您提供一个目录路径，它会创建一个`.sql`包含`CREATE TABLE DROP IF EXISTS`语法的`.txt`文件和一个包含内容的文件，制表符分隔。要创建逗号分隔的文件，您可以使用以下命令：

```
mysqldump --password  --fields-optionally-enclosed-by='"' --fields-terminated-by=',' --tab /tmp/path_to_dump/ database_name 
```

该路径需要 mysql 用户和运行命令的用户都可写，所以为了简单起见，我`chmod 777 /tmp/path_to_dump/`首先推荐。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-10-16T06:21:57.113

select into outfile 选项对我不起作用，但下面通过 SED 管道制表符分隔文件的迂回方式确实：

```
mysql -uusername -ppassword -e "SELECT * from tablename" dbname | sed 's/\t/","/g;s/^/"/;s/$/"/' > /path/to/file/filename.csv 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-10-16T07:59:59.370

这是最简单的命令

```
mysql -h<hostname> -u<username> -p<password> -e 'select * from databaseName.tableNaame' | sed  's/\t/,/g' > output.csv 
```

如果列值中有逗号，那么我们可以使用以下命令生成 .tsv 而不是 .csv

```
mysql -h<hostname> -u<username> -p<password> -e 'select * from databaseName.tableNaame' > output.csv 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-22T01:36:23.790

如果您真的需要“备份”，那么您还需要数据库模式，例如表定义、视图定义、存储过程等。数据库的备份不仅仅是数据。

mysqldump 格式用于备份的价值在于它非常易于使用它来恢复mysql 数据库。不容易恢复的备份的用处要小得多。如果您正在寻找一种可靠地将 mysql 数据备份到的方法，以便您可以恢复到 mysql 服务器，那么我认为您应该坚持使用 mysqldump 工具。

Mysql 是免费的，可以在许多不同的平台上运行。设置一个我可以恢复到的新 mysql 服务器很简单。我一点也不担心无法设置mysql，所以我可以进行恢复。

我会更担心基于 csv/tsv 等脆弱格式的自定义备份/恢复失败。您确定数据中的所有引号、逗号或制表符都会正确转义，然后由您的还原工具正确解析吗？

如果您正在寻找一种提取数据的方法，请在其他答案中查看几个。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-10-10T16:59:21.813

您可以使用以下脚本将输出获取到 csv 文件。每个表一个文件，带有标题。

```
for tn in `mysql --batch --skip-page --skip-column-name --raw -uuser -ppassword -e"show tables from mydb"`
do 
mysql -uuser -ppassword mydb -B -e "select * from \`$tn\`;" | sed 's/\t/","/g;s/^/"/;s/$/"/;s/\n//g' > $tn.csv
done 
```

user 是您的用户名，如果您不想继续为每个表输入密码，password 是密码，mydb 是数据库名称。

脚本说明： sed 中的第一个表达式将用“，”替换制表符，因此您的字段用双引号括起来并用逗号分隔。第二个在开头插入双引号，第三个在末尾插入双引号。最后一个负责\n。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-06-11T11:04:08.427

如果要将整个数据库转储为 csv

```
#!/bin/bash

host=hostname
uname=username
pass=password

port=portnr
db=db_name
s3_url=s3://buckera/db_dump/

DATE=`date +%Y%m%d`
rm -rf $DATE

echo 'show tables' | mysql -B -h${host} -u${uname} -p${pass} -P${port} ${db} > tables.txt
awk 'NR>1' tables.txt > tables_new.txt

while IFS= read -r line
do
  mkdir -p $DATE/$line
  echo "select * from $line" | mysql -B -h"${host}" -u"${uname}" -p"${pass}" -P"${port}" "${db}" > $DATE/$line/dump.tsv
done < tables_new.txt

touch $DATE/$DATE.fin

rm -rf tables_new.txt tables.txt 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-21T23:41:31.183

查看[mk-parallel-dump](http://www.maatkit.org/doc/mk-parallel-dump.html)，它是非常有用的[maatkit 工具套件的](http://www.maatkit.org/)一部分。这可以使用 --csv 选项转储逗号分隔的文件。

这可以在不指定单个表的情况下完成整个数据库，并且您可以在备份集表中指定表组。

请注意，它还将表定义、视图和触发器转储到单独的文件中。除了以更普遍可访问的形式提供完整备份之外，它还可以通过[mk-parallel-restore立即恢复](http://www.maatkit.org/doc/mk-parallel-restore.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-09-14T19:12:13.940

两行 PowerShell 答案：

```
# Store in variable
$Global:csv = (mysql -uroot -p -hlocalhost -Ddatabase_name -B -e "SELECT * FROM some_table") `
| ConvertFrom-Csv -Delimiter "`t"

# Out to csv
$Global:csv | Export-Csv "C:\temp\file.csv" -NoTypeInformation 
```

咚咚咚

`-D`=您的数据库的名称

`-e`= 查询

`-B`= 制表符分隔

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-04-14T12:12:11.363

有一种稍微简单的方法可以让所有表格快速进入制表符分隔：

```
#!/bin/bash
tablenames=$(mysql your_database -e "show tables;" -B |sed "1d")

IFS=$'\n'

tables=($tablenames)

for table in ${tables[@]}; do
        mysql your_database -e "select * from ${table}" -B > "${table}.tsv"
done 
```

# c# - 一起添加列表

> ID：467467
> 
> 赞同：1
> 
> 时间：2009-01-21T23:18:13.603
> 
> 标签：c#

我有多个字符串列表`IList<string>`，我想将它们合并到一个列表中，显示每个项目的不同字符串和计数（如字典）。最有效的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T23:23:36.447

LINQ（在代码类型和维护方面肯定是最有效的；整体性能将与任何其他方法*大致*相同）：

如果列表位于单独的变量中：

```
var qry = from s in listA.Concat(listB).Concat(listC) // etc
          group s by s into tmp
          select new { Item = tmp.Key, Count = tmp.Count() }; 
```

如果列表都在（列表的）父列表中：

```
var qry = from list in lists
          from s in list
          group s by s into tmp
          select new { Item = tmp.Key, Count = tmp.Count() }; 
```

那么如果你真的想要一个列表：

```
var resultList = qry.ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T23:21:21.410

```
Dictionary<string, int> count = new Dictionary<string, int>();

foreach(IList<int> list in lists)
  foreach(int item in list) {
    int value;
    if (count.TryGetValue(item, out value)) 
      count[item] = value + 1;
    else
      count[item] = 1;
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T23:24:53.587

```
List<List<string>> source = GetLists();
//    
Dictionary<string, int> result = source
  .SelectMany(sublist => sublist)
  .GroupBy(s => s)
  .ToDictionary(g => g.Key, g => g.Count()) 
```

# sql-server - 以编程方式检索与 SQL Server Management Studio gui 返回的源相同的 SQL Server 存储过程源？

> ID：467482
> 
> 赞同：67
> 
> 时间：2009-01-21T23:24:08.020
> 
> 标签：sql-server, stored-procedures, smo

关于如何以编程方式从 SQL Server 2005 中获取完全相同的存储过程源的任何指针，就像我在 SQL Server Management Studio 中右键单击该存储过程并选择修改时一样？

我正在尝试使用 SMO，但存在一些文本差异。该过程始终具有 CREATE，而不是 ALTER，并且标头中存在一些差异，例如我以编程方式获得的版本中缺少 GO。我可以解决这些问题，但也许有更好的方法？

同样，我在 SQL Server 2005 中，使用 SMSE。通过 Visual Studio 8 2008 使用 SMO。

**更新**：得到了一些答案，告诉了如何检索存储过程的基础知识。我正在寻找的是检索与 GUI 生成的文本相同（或几乎相同）的文本。

示例：对于 sp_mysp，在 Management Studio 中单击鼠标右键，选择修改。这会产生：

```
    使用 [MY_DB]  
    去  
    /****** 对象：StoredProcedure [dbo].[sp_mysp] 脚本日期：01/21/2009 17:43:18 ******/  
    设置 ANSI_NULLS ON  
    去  
    设置 QUOTED_IDENTIFIER ON  
    去  
    -- ===============================================
    -  作者：      
    -- 创建日期：
    -  描述：
    -- ===============================================
    更改程序 [dbo].[sp_mysp]

```

我想以编程方式获得相同的东西（注意标题中的 GO，以及它是一个 ALTER PROCEDURE 的事实。理想情况下，我希望通过对检索到的源进行最少的编程修复来获得它。

我很乐意只得到与 Script Date details 不同的东西。. .

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-01-21T23:33:25.037

```
EXEC sp_helptext 'your procedure name'; 
```

这避免了 INFORMATION_SCHEMA 方法的问题，即存储过程如果太长就会被切断。

更新：大卫写道，这与他的存储过程不同......也许是因为它将行作为“记录”返回以保留格式？如果您想以更“自然”的格式查看结果，您可以先使用 Ctrl-T（输出为文本），它应该完全按照您输入的格式打印出来。如果您在代码中执行此操作，那么执行 foreach 以完全相同的方式将您的结果放在一起是微不足道的。

更新 2：这将为源提供“CREATE PROCEDURE”而不是“ALTER PROCEDURE”，但我不知道没有办法让它使用“ALTER”。不过，这是一件微不足道的事情，不是吗？

更新 3：有关如何在源代码控制系统中维护 SQL DDL（数据库结构）的更多信息，请参阅评论。这确实是这个问题的关键。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-22T00:04:53.413

您将不得不手动编写代码，SQL Profiler 显示以下内容。

SMSE 在生成语句时会执行相当长的查询字符串。

以下查询（或类似的内容）用于提取文本：

```
SELECT
NULL AS [Text],
ISNULL(smsp.definition, ssmsp.definition) AS [Definition]
FROM
sys.all_objects AS sp
LEFT OUTER JOIN sys.sql_modules AS smsp ON smsp.object_id = sp.object_id
LEFT OUTER JOIN sys.system_sql_modules AS ssmsp ON ssmsp.object_id = sp.object_id
WHERE
(sp.type = N'P' OR sp.type = N'RF' OR sp.type='PC')and(sp.name=N'#test___________________________________________________________________________________________________________________00003EE1' and SCHEMA_NAME(sp.schema_id)=N'dbo') 
```

它返回纯 CREATE，然后在某处的代码中用 ALTER 替换。

SET ANSI NULL 内容和 GO 语句和日期都在此前面。

使用 sp_helptext，它更简单......

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-02T04:56:19.610

你说的是程序化的，对吧？我希望 C# 没问题。我知道您说过您尝试了 SMO，但它并没有完全满足您的要求，因此这可能不适合您的请求，但它会以编程方式读出合法的 SQL 语句，您可以运行这些语句来重新创建存储过程。如果它没有`GO`你想要的语句，你可以假设每个字符串后面`StringCollection`都有一个`GO`。您可能没有得到包含日期和时间的评论，但在我类似的听起来项目（必须单独备份所有内容的大屁股部署工具）中，这做得相当好。如果您有一个想要工作的先前基础，并且您仍然有原始数据库来运行它，我会考虑放弃最初的努力并重新标准化这个输出。

```
using System.Data.SqlClient;
using Microsoft.SqlServer.Management.Common;
using Microsoft.SqlServer.Management.Smo;
…
string connectionString = … /* some connection string */;
ServerConnection sc = new ServerConnection(connectionString);
Server s = new Server(connection);
Database db = new Database(s, … /* database name */);
StoredProcedure sp = new StoredProcedure(db, … /* stored procedure name */);
StringCollection statements = sp.Script; 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-21T23:27:48.620

使用以下 select 语句获取整个定义：

```
select ROUTINE_DEFINITION 
  from INFORMATION_SCHEMA.ROUTINES 
 where ROUTINE_NAME = 'someprocname' 
```

我猜 SSMS 和其他工具会读出来并在必要时进行更改，例如将 CREATE 更改为 ALTER。据我所知，SQL 不存储过程的其他表示形式。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-21T23:43:21.103

我同意马克。我将输出设置为文本模式，然后设置 sp_HelpText 'sproc'。我将此绑定到 Crtl-F1 以使其变得容易。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-22T05:34:05.090

[数据库发布向导](http://www.codeplex.com/sqlhost/Wiki/View.aspx?title=Database%20Publishing%20Wizard)可以从命令行转储架构（和其他对象）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-02-03T13:34:24.037

我只想注意，不要使用查找和替换来更改创建过程以更改过程，您也可以使用 drop，您可以将其放在顶部，并且确实需要文本搜索。

```
IF exists (SELECT * FROM sys.objects 
        WHERE object_id = OBJECT_ID(N'sp_name')
            and type in ('P','V') --procedure or view
        )
    DROP sp_name
GO 
```

如果你确定它在那里，我想你也可以放弃它，但我不建议这样做。不要忘记 go，因为 create procedure 必须是批处理中的第一个也是唯一的语句。

或懒惰的方法：

```
IF OBJECT_ID(N'sp_name') is not null
    DROP sp_name
GO 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-06T09:32:44.853

我通过[链接](https://database.guide/4-ways-to-get-a-stored-procedures-definition-using-transact-sql/)看到了一篇文章。有四种方法，我这里只是做了一个简短的总结，以帮助其他程序员。

1.  执行 sp_helptext 'sp_name';

2.  SELECT OBJECT_ID('sp_name')

3.  选择 OBJECT_DEFINITION( OBJECT_ID('sp_name') ) 作为 [定义];

4.  SELECT * FROM sys.sql_modules WHERE object_id = object_id('sp_name');

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2010-03-18T09:36:29.703

要更改存储过程，下面是 C# 代码：

```
SqlConnection con = new SqlConnection("your connection string");
con.Open();
cmd.CommandType = System.Data.CommandType.Text;
string sql = File.ReadAllText(YUOR_SP_SCRIPT_FILENAME);
cmd.CommandText = sql;   
cmd.Connection = con;
cmd.ExecuteNonQuery();
con.Close(); 
```

注意事项：

1.  确保连接字符串中的 USER 有权更改 SP
2.  从脚本文件中删除所有`GO,SET ANSI_NULLS XX,SET QUOTED_IDENTIFIER`语句。（如果不这样做，SqlCommand 将抛出错误）。

# asp.net - 在哪里设置会话超时？

> ID：467494
> 
> 赞同：1
> 
> 时间：2009-01-21T23:28:26.763
> 
> 标签：asp.net, session, timeout

应用程序在 Application_AcquireRequestState 事件处理程序中设置 session.timeout。

在会话到期之前，会弹出通知窗口。它通过 Application_AcquireRequestState 将会话超时重置为 3 分钟（通常为 30 分钟）。

该通知为用户提供了将会话再延长 30 分钟的选项。如果用户单击是，它将通过先前的事件处理程序将会话超时重置 30 分钟。

问题是，尽管用户单击是，并且会话超时设置正确，但会话似乎在设置时间之前超时。这仅在通知后发生。

怀疑是当它到达 Application_AcquireRequestState 时，已经为此请求计算了超时。新的超时值将用于下一个请求。因此，当用户单击“是”以延长会话时，当前请求的超时时间不是 30 分钟，而是只有 3 分钟，因为通知窗口设置了超时。只有当用户发送另一个请求时，yes 才会生效。

（通知窗口有自己的计时对象）

任何人都可以验证这一点吗？或者给我一个很好的资源来解释asp.net是如何管理这个的？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T23:54:30.160

Session.Timeout 是应用程序中的全局设置。

如果您在弹出通知用户他们即将注销的窗口时将用户超时设置为 3 分钟，并且他们没有响应，则您的 Session.Timeout 将保持在三分钟，直到另一个用户重置它 -这有可能发生吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T18:06:31.047

Zhaph，问题是当用户单击“是”以延长会话时，然后走开。

我想我终于解决了这个问题。

正如我所怀疑的那样，但仅限于“SQLServer”模式。当请求进入 Application_AcquireRequestState 时，会话已经扩展（可以在 ASPState 数据库、ASPStateTempSessions 表中验证）。如果用户单击“是”，虽然设置了新的超时值，但直到下一次服务器请求才会生效。如果用户没有再次点击就离开了，会话超时，之前设置的超时值是 3 分钟。

在“InProc”或“StateServer”模式下，会话对象由缓存管理，其到期只能在未来进一步重置，但不能缩回到更当前的时间（否则将被忽略）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T23:50:46.733

我使用了一个更简单的机制。我根本没有弹出窗口扩展会话。我使用带有滑动窗口的会话，当用户单击会话到期通知中的“确定”按钮时，它会向服务器发出 AJAX 请求以更新滑动窗口。

# apache-flex - Adobe Flex reposition scrollbar slider programatically

> ID：467497
> 
> 赞同：2
> 
> 时间：2009-01-21T23:29:08.883
> 
> 标签：apache-flex, adobe, slider

I need to reposition the slider on a scrollbar programatically (not move the scrollbar, just the slider; i.e. reset it to top or left, etc.). Anybody figured this out?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T05:26:50.347

我本来要提到程序化蒙皮，但再想一想，听起来你想要做的只是设置组件的滚动位置。那正确吗？如果是这样，这取决于您正在使用哪种控件，以及您想要执行哪种滚动（例如，到列表中的项目，或者只是到水平或垂直位置）：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">

    <mx:Script>
        <![CDATA[

            private function scrollToIndex():void
            {
                ls.scrollToIndex(15);
            }

            private function scrollToPoint():void
            {
                cv.verticalScrollPosition += 20;
            }

        ]]>
    </mx:Script>

    <mx:VBox width="300">
        <mx:List id="ls" width="100%" rowCount="5">
            <mx:dataProvider>
                <mx:Array>
                    <mx:String>Item 1</mx:String>
                    <mx:String>Item 2</mx:String>
                    <mx:String>Item 3</mx:String>
                    <mx:String>Item 4</mx:String>
                    <mx:String>Item 5</mx:String>
                    <mx:String>Item 6</mx:String>
                    <mx:String>Item 7</mx:String>
                    <mx:String>Item 8</mx:String>
                    <mx:String>Item 9</mx:String>
                    <mx:String>Item 10</mx:String>
                    <mx:String>Item 11</mx:String>
                    <mx:String>Item 12</mx:String>
                    <mx:String>Item 13</mx:String>
                    <mx:String>Item 14</mx:String>
                    <mx:String>Item 15</mx:String>
                    <mx:String>Item 16</mx:String>
                    <mx:String>Item 17</mx:String>
                    <mx:String>Item 18</mx:String>
                    <mx:String>Item 19</mx:String>
                    <mx:String>Item 20</mx:String>
                </mx:Array>
            </mx:dataProvider>
        </mx:List>
        <mx:Button label="Scroll" click="scrollToIndex()" />
        <mx:Canvas id="cv" width="100%" height="200">
            <mx:TextArea width="100%" height="600" verticalScrollPolicy="off">
                <mx:text>
                    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed 
                    do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
                    Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris 
                    nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in 
                    reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla 
                    pariatur. Excepteur sint occaecat cupidatat non proident, sunt in 
                    culpa qui officia deserunt mollit anim id est laborum.

                    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed 
                    do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
                    Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris 
                    nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in 
                    reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla 
                    pariatur. Excepteur sint occaecat cupidatat non proident, sunt in 
                    culpa qui officia deserunt mollit anim id est laborum.

                    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed 
                    do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
                    Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris 
                    nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in 
                    reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla 
                    pariatur. Excepteur sint occaecat cupidatat non proident, sunt in 
                    culpa qui officia deserunt mollit anim id est laborum.

                    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed 
                    do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
                    Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris 
                    nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in 
                    reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla 
                    pariatur. Excepteur sint occaecat cupidatat non proident, sunt in 
                    culpa qui officia deserunt mollit anim id est laborum.              
                </mx:text>
            </mx:TextArea>
        </mx:Canvas>
        <mx:Button label="Scroll" click="scrollToPoint()" />
    </mx:VBox>  

</mx:Application> 
```

verticalScrollPosition 和 Horizo​​ntalScrollPosition 属性（可用于 Container 类的所有实现）和 scrollToIndex 方法（用于列表）可能是您正在寻找的。这个例子说明了两者。希望能帮助到你！

# c# - Linq to SQl 查询扩展

> ID：467502
> 
> 赞同：2
> 
> 时间：2009-01-21T23:30:35.573
> 
> 标签：c#, linq-to-sql

```
query = query.Where(m => m.People.Contains(s)).Select(m => m).ToList(); 
```

在上面，“People”是字符串的 IList。如果我用带有字符串的对象列表替换 People 作为该对象的字段，我如何获得相同的结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T23:35:24.753

怎么样：

```
query = query.Where(m => m.People.Any(p => p.SomeProp == s)).ToList(); 
```

# sql - 在您使用 SQL Server 的职业生涯中的某个阶段，参数嗅探是否会突然出现并发起攻击？

> ID：467513
> 
> 赞同：5
> 
> 时间：2009-01-21T23:35:32.757
> 
> 标签：sql, sql-server, sql-server-2005, parameter-sniffing

今天，我又遇到了一个重大问题，似乎是 SQL Server 2005 中的参数嗅探。

我有一个查询将一些结果与已知的良好结果进行比较。我在结果和已知的好结果中添加了一个列，这样每个月，我都可以在两边加载一个新的月份结果，并且只比较当前月份。新列在聚集索引中排在第一位，因此新的月份将添加到末尾。

我在我的子句中添加了一个条件`WHERE`- 这是代码生成的，所以它是一个字面常量：

`WHERE DATA_DT_ID = 20081231`-- 这是多余的，因为所有 DATA_DT_ID 现在都是 20081231。

性能进入底池。从 7 秒比较大约 150 万行到 2 小时，但什么也没完成。在 SSMS 中运行生成的 SQL - 没有 SP。

我使用 SQL Server 已有 12 年了，自 10 月以来，我从未在此生产服务器上遇到过如此多的参数嗅探问题（构建版本 9.00.3068.00）。在每种情况下，这都不是因为它第一次运行时使用了不同的参数或表发生了变化。这是一个新表，它仅使用此参数运行或根本没有`WHERE`子句。

而且，不，我没有 DBA 访问权限，而且他们没有给我足够的权限来查看执行计划。

以至于我不确定我是否能够将这个系统交给只有几年经验的 SQL Server 用户处理。

**UPDATE**事实证明，尽管统计数据声称是最新的，但运行 UPDATE STATISTICS WITH FULLSCAN 可以解决问题。

**最终更新**即使使用 WITH RECOMPILE 和 UPDATE STATISTICS 重新创建 SP，结果还是必须以不同的方式重写查询，以使用 NOT IN 而不是 LEFT JOIN 和 NULL 检查。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-12-05T10:04:52.623

不是很完整的答案，但我会分享我的经验。

参数嗅探花了几年的 SQL Server 来咬我，当我离开主要从事生产 DBA 工作后回到开发人员 DBA 时。我更了解引擎、SQL 的工作原理、什么最好留给客户端等等，我是一个更好的 SQL 编码器。

例如，动态 SQL 或 CURSOR 或只是简单的坏 SQL 代码可能永远不会遭受参数嗅探。但是更好的集合编程或如何避免动态 SQL 或更优雅的 SQL 更有可能会。

我注意到它用于复杂的搜索代码（大量条件）和参数默认影响计划的复杂报告。当我看到经验不足的开发人员如何编写此代码时，它就不会遭受参数嗅探。

无论如何，我更喜欢参数屏蔽而不是 WITH RECOMPILE。无论如何更新统计信息或索引都会强制重新编译。但是为什么总是重新编译呢？我已经在其他地方回答了您的一个问题，其中提到了在编译期间嗅探参数的链接，所以我也不相信它。

参数屏蔽是一种开销，是的，但它允许优化器逐个评估查询，而不是全面重新编译。尤其是 SQL Server 2005 的语句级重新编译

SQL Server 2008 中的 OPTIMIZE FOR UNKNOWN 似乎也与屏蔽完全相同。我和我的 SQL Server MVP 同事花了一些时间调查并得出了这个结论。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-21T23:59:11.367

我怀疑您的问题是由数据统计不足引起的。由于您没有对服务器的 DBA 访问权限，我建议您询问 DBA 上次更新统计信息的时间。这会对性能产生巨大影响。听起来您的表也没有很好地索引。

基本上，这“感觉”不像是参数嗅探问题，而更像是一个“健康”的数据库问题。

本文介绍如何确定上次更新统计信息的时间： [统计信息更新时间](http://weblogs.sqlteam.com/joew/archive/2007/09/06/60322.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T15:12:33.143

我支持关于检查统计信息的评论 - 我已经看到了几个查询性能下降的情况，特别是因为统计信息已经过时。

具体来说，如果您的 PK 中有一个日期，并且 SQL Server 认为在特定日期之后只有 10 或 100 条记录，而实际上有数千条记录，它可能会选择非常低效的查询计划，因为它认为数据集要小得多比实际情况。

高温下，

*   安德鲁

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T19:14:09.547

我有一个完全像这样的生产问题。应用程序中调用存储过程的选项卡不会显示。我对特定的过程进行了跟踪并看到了调用。应用程序在 30 秒内超时，并且 proc 将需要接近 40 - 50 秒才能完成（完全按照从跟踪中调用的方式运行 proc）。

下一步是找出导致我在执行过程中注意到的扫描的语句。所以我编写了 proc 脚本，删除了过程语法和声明的变量并在查询分析器中运行。它在 3 秒内运行！！！

我写这篇文章是为了让任何在那里寻找答案的人都知道这可能发生在 SQL 中。它源于参数嗅探问题。我找不到这个线程，因为我指出原因是缓存查询计划错误！我读过帖子，他们说它发生在一个特定的用户/价值上。但它可以发生在任何值上，一旦开始，它就可以是一个连续的事情。

我的解决方案是编写 proc 并再次运行它。是的。就这么简单。改变工作正常。无需删除和重新创建。这会导致 SQL 刷新缓存的计划，一切都很好。我还没有弄清楚如何在服务器级别禁用它。清理所有的procs太麻烦了。希望这可以帮助

# ruby-on-rails - 如何使用 Shoulda 测试引用类属性的 named_scope？

> ID：467516
> 
> 赞同：0
> 
> 时间：2009-01-21T23:36:12.473
> 
> 标签：ruby-on-rails, ruby, unit-testing, shoulda

我有以下 ActiveRecord 类：

```
class User < ActiveRecord::Base
  cattr_accessor :current_user
  has_many :batch_records
end

class BatchRecord < ActiveRecord::Base
  belongs_to :user

  named_scope :current_user, lambda {
    { :conditions => { :user_id => User.current_user && User.current_user.id } }
  }
end 
```

我正在尝试测试`named_scope :current_user`使用[应该](http://shoulda.thoughtbott.com/ "应该")，但以下不起作用。

```
class BatchRecordTest < ActiveSupport::TestCase
  setup do
    User.current_user = Factory(:user)
  end

  should_have_named_scope :current_user,
                          :conditions => { :assigned_to_id => User.current_user }
end 
```

它不起作用的原因是因为在定义类时正在评估方法中的调用，并且在运行测试时我在块中更改了`User.current_user`之后的值。`should_have_named_scope``current_user``setup`

这是我为测试这个 named_scope 所做的：

```
class BatchRecordTest < ActiveSupport::TestCase
  context "with User.current_user set" do
    setup do
      mock_user = flexmock('user', :id => 1)
      flexmock(User).should_receive(:current_user).and_return(mock_user)
    end

    should_have_named_scope :current_user,
                            :conditions => { :assigned_to_id => 1 }
  end
end 
```

那么你将如何使用[Shoulda](http://shoulda.thoughtbott.com/ "应该")进行测试呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T00:24:08.010

我认为你正在以错误的方式解决这个问题。首先，为什么需要使用命名范围？这不就行了吗？

```
class BatchRecord < ActiveRecord::Base
  belongs_to :user

  def current_user
    self.user.class.current_user
  end
end 
```

在这种情况下，测试将是微不足道的。但！WTF 您是否将其定义`current_user`为类属性？现在 Rails 2.2 是“线程安全的”，如果你在两个单独的线程中运行你的应用程序会发生什么？一位用户将登录，`current_user`为所有`User`实例设置。现在另一个具有管理员权限的用户登录并`current_user`切换到他们的实例。当第一个用户进入下一页时，他/她将可以使用其他人的管理员权限访问帐户！震惊！恐怖！

在这种情况下，我建议做的是创建一个新的控制器方法`current_user`，该方法返回当前用户的 User 实例。您还可以更进一步，创建一个包装器模型，例如：

```
class CurrentUser

  attr_reader :user, :session

  def initialize(user, session)
    @user, @session = user, session
  end

  def authenticated?
    ...
  end

  def method_missing(*args)
    user.send(*args) if authenticated?
  end

end 
```

~~哦，顺便说一句，现在我再次查看您的问题，也许它不起作用的原因之一是该行将`User.current_user && User.current_user.id`返回一个布尔值，而不是您想要的整数。~~ **编辑**我是个白痴。

命名范围确实是绝对错误的做法。命名范围旨在返回集合，而不是单个记录（这是失败的另一个原因）。它还会对数据库进行不必要的调用，从而导致您不需要的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T01:04:36.883

我才意识到答案正盯着我看。我应该从协会的另一端工作，这将是`current_user.batch_records`。然后我只是`named_scope`在`User`模型上测试一下，一切都很好。

@ [Chris Lloyd](https://stackoverflow.com/users/42413/chris-lloyd) - 关于线程安全问题，该`current_user`属性由`before_filter`my中的 a 设置`ApplicationController`，因此根据请求进行修改。我知道如果我选择在多线程环境中运行（目前不是这种情况），仍然有可能发生灾难。我认为该解决方案将完全是另一个主题。

# windows-mobile - How to "Connect via Bluetooth" in WM programmatically?

> ID：467524
> 
> 赞同：0
> 
> 时间：2009-01-21T23:38:33.170
> 
> 标签：windows-mobile, bluetooth, activesync

Does anybody know how do I programmatically emulate a click on ActiveSync "Connect via Bluetooth" menu? I need my smartphone to periodically attempt to check/reestablish connect via bluetooth, but I couldn't find anything in WM SDK, which would do that

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T00:00:26.370

Take a look at the [32feet.net bluetooth SDK](http://inthehand.com/content/32feet.aspx).

# ide - 富文本会帮助注释代码吗？

> ID：467532
> 
> 赞同：10
> 
> 时间：2009-01-21T23:40:20.407
> 
> 标签：ide, comments

我一直想知道为什么我必须在文本编辑器中编写富文本代码注释，也就是**伪代码**（来吧，粗体，下划线！）然后回到 IDE（集成？）来编写实际程序，更不用说确保这些文档位于代码附近。

所以问题是，**如果 IDE 允许富文本代码注释会怎样。**它会帮助任何人吗？**考虑到您可以强调**或*强调重点*并使用标题和子标题，也许会使模糊的图片更清晰易懂？

（是的，我知道我们可以使用 *important point* 和 ****** HEADER ****** 进行管理，但让我们暂时开箱即用！

**我说的是集成在 IDE 中的 RTF 代码编辑器。**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-22T06:49:42.597

这是一个有趣的问题，因为除了它*现在*是否真的是一个好主意之外，它还突破了我们工作方式的界限。

*不*混合富文本和代码的所有原因都没有解决这是否会帮助任何人的问题 - 是否还有弥补缺点的好处。如果没有人问过这种问题并发明了网络，也许我们都还在使用 gopher。

至于源代码注释，一些富文本功能会比其他功能更有用：

*   **超链接**肯定会很有用，因为代码文档经常需要引用代码之外的文档，以及代码中其他地方的文档链接以避免重复
*   **图像**会很有用，因为在很多情况下，最明智的代码文档是图表——例如，有些人确实使用 UML
*   **列表**会很有用 - 例如，这个列表在其富文本版本（即 HTML）中比 Markdown 源更容易阅读
*   **字体格式**不太重要 - 粗体和斜体有时可用于强调，如果代码片段（例如 a `variableName`）在格式不同时更易于阅读，则文本更具可读性；不同的颜色意义不大
*   **标题**通常不会有用，因为如果代码注释太长以至于需要标题来介绍结构，它可能应该在代码之外。

具有讽刺意味的是，当您在 Stack Overflow 上发布富文本注释时，在代码中反对富文本注释更难——您必须诉诸富文本“有时”可以的论点。

即使在此处的简短评论中，富文本也很有用，并且当您看不到格式化版本时，Markdown 源仍然是明智的。因此，对于 IDE 来说，一个好的折衷方案是将 Markdown 注释块呈现为富文本，并在光标位置位于注释块中时立即显示 Markdown 源。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-21T23:52:14.610

通常，注释代码的想法是解释您的各个例程（或组件部分）打算实现的操作。你不需要用额外的格式和其他人可能认为混乱的东西来标记这些评论。

如果特定部分需要图像、强调或以其他方式需要更深入的解释，则表明需要发行说明或支持文档。开发人员的克星，我知道，但最好保持整洁并易于支持。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-21T23:56:21.433

史蒂夫·麦康奈尔（Steve McConell）为复杂格式的评论引用的问题是，由于它们需要进行更多的更改，因此它们更有可能变得陈旧。

如果整个团队都采用了富文本编辑 IDE，或许可以解决这个问题。但是你会开始一种勇敢的、新的代码创建方法，这是大多数团队为了适应当前的最佳实践而明智地倾向于避免的。

实际的嵌入式文档是另一个问题，我不确定处理这个问题的最佳方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-22T00:05:31.337

实际上，*真正*有助于注释代码的是语言采用最常用的注释模式并将它们转化为语言特性：

`final`关键字可以取消这种类型的注释：

```
// Don't extend this class! Ever! 
```

抽象方法取代了这个：

```
// make sure you implement foo() bar() and baz() in all child classes 
```

良好的面向对象编程将组织代码，这样您就不需要大的烦人的标题：

```
// *******************************************
// ***** Input Handling here *****************
// *******************************************
// * This next section has all the functions *
// * dealing with keyboard input.            *
// ******************************************* 
```

……变成……

```
class InputHandler {
    // This class deals with keyboard input.
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-21T23:51:07.967

不，因为如果没有您的特殊 IDE 添加，查看您的代码的用户可能无法阅读注释。

但是，我可以理解为您的 IDE*定制的自动格式化*。例如，您的 IDE 可以配置为在 Markdown（StackOverflow 使用）下处理注释，这具有可读“代码”的好处。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-21T23:54:39.660

在过去的十年中，Javadoc 允许 HTML 标记和一堆自定义标记（例如链接到其他类或方法）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-21T23:55:44.087

我想要的文档结构与源代码的结构不匹配。

例如，功能规范是功能列表：每个功能都在一个地方进行描述……但功能的实现，例如作为通过 DAL 从 UI 到数据库的事务，不在一个地方在源代码中。

此外，不同的人需要不同类型的文档：

*   功能规格是什么？
*   什么是用户界面？
*   什么是数据设计？
*   软件设计是怎样的？
*   开发项目/流程是什么？
*   测试用例是什么？
*   测试结果如何？

将文档放在与源代码相同的源文件中没有帮助，imo。

但是，另请参阅“文学编程”。我不知道“文学编程”是什么或本来应该是什么，但它至少在一种狭隘的情况下看起来很有用，也就是说，当你试图写软件时（例如写一篇关于某些软件的文章） .

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-21T23:44:25.140

绝对不！我根本不相信任何人会在我的代码中乱用“特殊字符”，这可能会在某天给我带来另一个头疼的来源。

更新：Jeremy 指出，在文件提交给编译器之前，注释（包括任何格式）总是会被删除。这很好，但我仍然不喜欢在我的代码中放置控制字符的想法。

一种有效的方法是 ReSharper 所做的*。*当它“查看”您的代码时，它会将任何以“**注意**：”开头的注释加粗并变为蓝色。这很有用，因为没有人弄乱我的文本格式——他们只是使用基于内容的颜色编码。

再说一遍：*不要*更改我的文件格式。但是根据内容突出显示内容很好。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-21T23:51:11.727

如果你让这个想法流行起来，有一天你会发现嵌入在某人代码中的 Excel 电子表格或视频。不，请让源代码，至少是源代码！，是普通的旧文本。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-22T00:03:46.630

我真正希望在评论中出现的唯一富文本是引用其他代码的超链接。使用 Javadoc 样式的注释或仅使用 ctags 很容易做到这一点。

如果纯文本注释不清楚，您可能需要更好的文档，而不是更好的文档格式。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-22T00:05:24.583

我有点喜欢这个主意。由于注释已经是一种颜色，它可能需要有所限制，而不是真正的富文本，或者很难从代码中挑选出注释。但是，如果它只允许粗体、下划线，也许还有字体大小，那么它会有助于强调您知道代码是杂乱无章的，或者是“永远不要编辑这个”类型的注释。

但是，除非它成为通用且广泛使用的 IDE 的一部分，否则它不会起作用。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-30T08:32:00.343

查看 Visual Studio 2010，它有一个示例扩展，可将图像插入代码文件。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-21T23:49:41.977

您可以检查使用的[phpdoc](http://www.phpdoc.org/features.php)格式 - 基本上它使用标签来标记内容，但可以包含链接等。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-22T07:31:33.763

我宁愿只拥有 javadoc 丰富的元素，例如，以富文本方式呈现的类、标题等的链接。这将透明地转换为 javadoc html。我认为这是一个 ide 的好主意。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-08-22T15:54:08.383

已经可以将富文本放入 Python 代码中： [sphinx](http://sphinx.pocoo.org/)。至少以RST的形式。而且也没有必要为此使用 IDE（尽管我认为一些格式化帮助很有用）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-08-22T16:45:24.707

早在 NeXT 维护自己的 GCC 私有分支的时候，它就允许在源代码中使用 RTF 标签。不仅在评论中，而且无处不在。它从来都不是一个高度使用的功能，最终被放弃了。一个问题是 RTF 很难用纯文本编辑器阅读，因此只有团队中的每个人都使用支持 RTF 的编辑器（和差异工具）才能工作。

我认为在评论中保留某种格式可能会很有用，但我认为比 RTF 更易于阅读的东西可能是一个更好的主意。Markdown 可能工作得很好。

# asp.net-mvc - 是否可以在 ASP.NET MVC 中实现 X-HTTP-Method-Override？

> ID：467535
> 
> 赞同：5
> 
> 时间：2009-01-21T23:41:23.603
> 
> 标签：asp.net-mvc, rest, http-headers, http-method

我正在使用 ASP.NET MVC 实现一个 RESTful API 的原型，除了这里和那里的奇怪错误之外，我已经实现了我在开始时提出的所有要求，除了调用者能够使用`X-HTTP-Method-Override`自定义标头覆盖HTTP 方法。

我想要的是以下请求......

```
GET /someresource/123 HTTP/1.1
X-HTTP-Method-Override: DELETE 
```

...将被分派到实现`DELETE`功能而不是该`GET`操作的功能的控制器方法（假设有多个方法实现该操作，并且它们标记有不同的`[AcceptVerbs]`属性）。因此，鉴于以下两种方法，我希望将上述请求发送到第二种方法：

```
[ActionName("someresource")]
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult GetSomeResource(int id) { /* ... */ }

[ActionName("someresource")]
[AcceptVerbs(HttpVerbs.Delete)]
public ActionResult DeleteSomeResource(int id) { /* ... */ } 
```

有人知道这是否可能吗？这样做需要做多少工作......？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T07:06:25.437

您将无法按原样使用 [AcceptVerbs] 属性，因为它与请求的实际 HTTP 动词相关联。幸运的是 [AcceptVerbs] 属性非常简单；您可以在以下位置查看自己的来源[http://www.codeplex.com/aspnet/SourceControl/changeset/view/21528#266431](http://www.codeplex.com/aspnet/SourceControl/changeset/view/21528#266431)。

简而言之，子类 AcceptsVerbsAttribute 并覆盖 IsValidForRequest() 方法。实现将类似于以下内容：

```
string incomingVerb = controllerContext.HttpContext.Request.Headers["X-HTTP-Method-Override"] ?? controllerContext.HttpContext.Request.Method;
return Verbs.Contains(incomingVerb, StringComparer.OrdinalIgnoreCase); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-02-18T00:40:44.910

利威尔的回答很棒。此外，我在自定义 AcceptsVerbsAttribute 中添加了一个检查，该检查还检查了 FORM 集合，因此您可以简单地放置一个隐藏的输入来触发 DELETE（类似于 MVC 2 的`Html.HttpMethodOverride(HttpVerbs.Delete)`）。

```
<input name="X-HTTP-Method-Override" type="hidden" value="DELETE" /> 
```

将incomingVerb 赋值更改为：

```
string incomingVerb = controllerContext.HttpContext.Request.Headers["X-HTTP-Method-Override"] ?? controllerContext.HttpContext.Request.Form["X-HTTP-Method-Override"] ??controllerContext.HttpContext.Request.HttpMethod; 
```

小心这种方法！请参阅 Stephen Walther 的[相关帖子](http://stephenwalther.com/blog/archive/2009/01/21/asp.net-mvc-tip-46-ndash-donrsquot-use-delete-links-because.aspx)。

希望这可以帮助某人。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-06-07T04:03:09.563

插入表格：

```
<%= Html.HttpMethodOverride(HttpVerbs.Delete) %> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-10-21T20:12:46.583

这个对话有点老了，但我想分享一下我使用 mvc 2 发现的内容：

浏览器支持两个 HTTP 动词：GET 和 POST，但 ASP.NET MVC 2 允许您使用 Html.HttpMethodOverride 辅助方法模拟 Put、Get 和 Delete。在内部，这是通过在 X-HTTP-Method-Override 表单字段中发送动词来实现的。[AcceptVerbs] 属性以及新的较短动词属性使用 HttpMethodOverride 的行为：

例如，动作声明：

```
[ActionName("someresource")]
[HttpDelete]
public ActionResult DeleteSomeResource() 
```

应该对将 X-HTTP-Method-Override 设置为 Delete 的 get 请求负责。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-31T14:09:36.623

我很惊讶这还没有被提及，但是 ASP.NET MVC 本身就支持 X-HTTP-Method-Override 并且至少从版本 2 开始就已经这样做了。不需要编写自定义代码来处理这个问题。

它以下列方式工作：

在 AcceptVerbsAttribute（也由 [HttpPut]、[HttpPost] 等代理）内部，有一个 IsValidForRequest 方法。在该方法中，它使用 Request.GetHttpMethodOverride() 进行检查，该方法返回具有以下条件的正确覆盖的 HTTP 方法：

*   仅在 POST 请求中支持覆盖。所有其他都被忽略。
*   如果 X-HTTP-Method-Override 值为 GET 或 POST，则会被忽略。这是有道理的，因为您永远不需要覆盖这些值。
*   它在此优先级的以下位置查找 X-HTTP-Method-Override：1）HTTP 标头 2）表单正文 3）查询字符串

如果你真的很好奇，下面是 GetHttpMethodOverride() 的样子（来自 MVC 3 的源代码）：

```
public static class HttpRequestExtensions {
    internal const string XHttpMethodOverrideKey = "X-HTTP-Method-Override";

    public static string GetHttpMethodOverride(this HttpRequestBase request) {
        if (request == null) {
            throw new ArgumentNullException("request");
        }

        string incomingVerb = request.HttpMethod;

        if (!String.Equals(incomingVerb, "POST", StringComparison.OrdinalIgnoreCase)) {
            return incomingVerb;
        }

        string verbOverride = null;
        string headerOverrideValue = request.Headers[XHttpMethodOverrideKey];
        if (!String.IsNullOrEmpty(headerOverrideValue)) {
            verbOverride = headerOverrideValue;
        }
        else {
            string formOverrideValue = request.Form[XHttpMethodOverrideKey];
            if (!String.IsNullOrEmpty(formOverrideValue)) {
                verbOverride = formOverrideValue;
            }
            else {
                string queryStringOverrideValue = request.QueryString[XHttpMethodOverrideKey];
                if (!String.IsNullOrEmpty(queryStringOverrideValue)) {
                    verbOverride = queryStringOverrideValue;
                }
            }
        }
        if (verbOverride != null) {
            if (!String.Equals(verbOverride, "GET", StringComparison.OrdinalIgnoreCase) &&
                !String.Equals(verbOverride, "POST", StringComparison.OrdinalIgnoreCase)) {
                incomingVerb = verbOverride;
            }
        }
        return incomingVerb;
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T14:13:37.913

你看过[简单的宁静路由](http://www.codeplex.com/MVCContrib/Wiki/View.aspx?title=SimplyRestfulRouting)吗？它已经这样做了。

2010 年 2 月编辑添加：方法覆盖内置于 MVC 2 中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-21T23:57:49.513

这`X-HTTP-Method-Override`是一个自定义标头，您的 Web 容器很可能不支持。

你是从网页调用这个吗？如果是这样，您可能应该使用`XmlHttpRequest`with `DELETE`（或任何您想要的动词）。更好的是，使用 JS 框架为您完成繁重的工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-22T00:05:41.883

您可以创建一个实现的 ActionFilter `OnActionExecuting`，它在调用控制器操作之前触发。然后，您可以询问请求标头，并根据标头的值进行重定向`X-HTTP-Method-Override`（如果存在）。

# hook - 编程中的“钩子”一词是什么意思？

> ID：467557
> 
> 赞同：326
> 
> 时间：2009-01-21T23:52:51.987
> 
> 标签：hook

我最近在与一些人谈论我正在编写的程序时听到了“钩子”这个词。尽管我从对话中推断出钩子是一种函数，但我不确定这个术语究竟意味着什么。我搜索了一个定义，但找不到一个好的答案。有人能给我一个关于这个术语的一般含义的想法，也许还有一个小例子来说明这个定义吗？

* * *

## 回答 #1

> 赞同：184
> 
> 时间：2009-01-21T23:55:28.270

本质上，它是代码中的一个位置，允许您进入模块以提供不同的行为或在发生某些事情时做出反应。

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2009-01-22T00:12:25.007

挂钩是软件提供的功能，供该软件的用户在某些情况下调用自己的代码。该代码可以增加或替换当前代码。

在计算机真正属于个人并且病毒不那么流行的过去（我说的是 80 年代），它就像修补操作系统软件本身以调用您的代码一样简单。我记得在 Apple II 上编写了 Applesoft BASIC 语言的扩展，它通过在处理任何行之前注入对我的代码的调用，将我的代码简单地连接到 BASIC 解释器中。

一些计算机具有预先设计的挂钩，例如 Apple II 上的 I/O 流。它使用这样的钩子来注入整个磁盘子系统（Apple II ROM 最初是在磁带是 PC 的主要存储介质的时代构建的）。您通过*打印*ASCII 代码 4 ( `CTRL-D`) 后跟要执行的命令来控制磁盘，然后是 a `CR`，它被磁盘子系统拦截，该子系统已将自身挂接到 Apple ROM 打印例程中。

例如，这些行：

```
PRINT CHR(4);"CATALOG"
PRINT CHR(4);"IN#6" 
```

将列出磁盘内容然后重新初始化机器。这允许通过将第一行设置为来保护您的 BASIC 程序等技巧：

```
123 REM XIN#6 
```

然后使用`POKE`将`CTRL-D`字符插入到`X`原来的位置。然后，任何试图列出您的源的人都会通过磁盘子系统检测到的输出例程发送重新初始化序列。

这通常是我们不得不求助的那种诡计，以获得我们想要的行为。

如今，随着操作系统更加安全，它为挂钩本身提供了便利，因为您不再应该在“运行中”或在磁盘上修改操作系统。

他们已经存在了*很长时间*。大型机拥有它们（称为出口），即使是现在，大量大型机软件也使用这些设施。例如，z/OS 附带的免费源代码控制系统（称为 SCLM）允许您通过简单地将自己的代码放在出口处来完全替换安全子系统。

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2009-01-22T00:18:18.410

在一般意义上，“钩子”是让您（程序员）查看和/或与之交互和/或更改系统/程序中已经发生的事情的东西。

例如，Drupal CMS 为开发人员提供了钩子，让他们可以在创建“内容节点”后采取额外的行动。如果开发人员没有实现钩子，则按正常方式创建节点。如果开发人员实现了一个钩子，他们可以在创建节点时运行一些额外的代码。此代码可以做任何事情，包括回滚和/或更改原始操作。它也可以做一些与节点创建完全无关的事情。

回调可以被认为是一种特定的钩子。通过在系统中实现回调功能，该系统允许您在操作完成后调用一些额外的代码。然而，钩子（作为一个通用术语）并不局限于回调。

另一个例子。有时，Web 开发人员会将元素上的类名和/或 ID 称为挂钩。这是因为通过将 ID/类名放在元素上，他们可以使用 Javascript 修改该元素，或“挂钩”到页面文档。（这个是拉长意思，但是很常用，值得一提）

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2016-08-02T14:36:17.083

简单说道：

钩子是一种在现有代码之前、之后或代替现有代码执行自定义代码（函数）的方法。例如，可以编写一个函数来“挂钩”登录过程，以便在继续正常登录过程之前执行验证码功能。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2016-01-25T15:57:42.383

Hooks 是一类函数，允许基本代码调用扩展代码。这在核心开发人员想要提供可扩展性而不暴露其代码的情况下很有用。

钩子的一种用途是在视频游戏模组开发中。游戏可能不允许模组开发人员扩展基本功能，但核心模组库开发人员可以添加挂钩。通过这些钩子，独立开发人员可以在任何所需事件上调用他们的自定义代码，例如游戏加载、库存更新、实体交互等。

一个常见的实现方法是给一个函数一个空的回调列表，然后公开扩展回调列表的能力。基本代码将始终在相同和适当的时间调用该函数，但是，对于一个空的回调列表，该函数什么也不做。这是设计使然。

然后，第三方有机会编写额外的代码并将他们的新回调添加到钩子的回调列表中。仅仅参考了可用的钩子，它们就以最小的风险扩展了基本系统的功能。

钩子不允许开发人员做任何其他结构和接口无法完成的事情。它们是在考虑任务和用户（第三方开发人员）的情况下做出的选择。

为了澄清：钩子允许扩展并且可以使用回调来实现。回调一般无非就是一个函数指针；函数的计算地址。其他答案/评论似乎存在混淆。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2009-01-21T23:58:52.507

[编程中的挂钩](http://en.wikipedia.org/wiki/Hooking)是一种使用所谓的挂钩来制作一系列过程作为事件处理程序的技术。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-04-05T05:05:27.387

Hook 表示代码中的一个位置，您可以在其中调度某种类型的事件，如果该事件之前已使用适当的回调函数注册，那么它将由该注册函数处理，否则不会发生任何事情。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-22T00:00:41.877

遇到某些条件时可以执行钩子。例如，某些变量更改或某些操作被调用或某些事件发生。钩子可以进入过程并改变事物或对改变做出反应。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-22T00:05:53.850

挂钩通常指的是[Win32 消息挂钩](http://msdn.microsoft.com/en-us/library/ms997537.aspx)或 Linux/OSX 等价物，但更一般的挂钩只是通知另一个对象/窗口/程序/等，您希望在发生指定操作时得到通知。例如：让系统上的所有窗口在它们即将关闭时通知您。

作为一般规则，挂钩有点危险，因为在不了解它如何影响系统的情况下进行挂钩可能会导致不稳定或至少是意外行为。在某些情况下，它也可能非常有用，我想。例如：[FRAPS](http://www.fraps.com/)使用它来确定应该在哪些窗口上显示它的 FPS 计数器。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-22T00:24:51.470

钩子链是一组函数，其中每个函数调用下一个函数。钩子链的重要之处在于程序员可以在运行时向链中添加另一个函数。一种方法是寻找一个已知位置，其中保存了链中第一个函数的地址。然后保存该函数指针的值，并用希望插入钩子链的函数的地址覆盖初始地址的值。然后调用该函数，执行其业务并调用链中的下一个函数（除非您另有决定）。当然，还有许多其他方法可以创建挂钩链，从直接写入内存到使用 Ruby 或 Python 等语言的元编程工具。

挂钩链的一个示例是 MS Windows 应用程序处理消息的方式。处理链中的每个函数要么处理一条消息，要么将其发送到链中的下一个函数。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-22T00:35:15.833

在 Drupal 内容管理系统中，“钩子”具有相对特定的含义。当内部事件发生时（例如内容创建或用户登录），模块可以通过实现特殊的“挂钩”功能来响应事件。这是通过命名约定来完成的——例如，用户登录事件的 [your-plugin-name]_user_login()。

由于这种约定，底层事件被称为“钩子”，并在 Drupal 的 API 文档中以“hook_user_login”和“hook_user_authenticate()”之类的名称出现。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-08-18T07:39:23.053

简而言之，您可以更改 API 调用的代码，例如`MessageBox`它执行您编辑的不同功能的位置（全局将在系统范围内工作，在本地将在进程范围内工作）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-05-28T09:59:19.740

许多答案，但没有示例，因此添加一个虚拟答案：以下`complicated_func`提供了两个钩子来修改其行为

```
from typing import List, Callable

def complicated_func(
    lst: List[int], hook_modify_element: Callable[[int], int], hook_if_negative=None
) -> int:
    res = sum(hook_modify_element(x) for x in lst)
    if res < 0 and hook_if_negative is not None:
        print("Returning negative hook")
        return hook_if_negative
    return res

def my_hook_func(x: int) -> int:
    return x * 2

if __name__ == "__main__":
    res = complicated_func(
        lst=[1, 2, -10, 4],
        hook_modify_element=my_hook_func,
        hook_if_negative=0,
    )
    print(res) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-11-12T09:38:01.313

一个函数，它允许您提供另一个函数，而不仅仅是一个值作为参数，本质上是扩展它。

# c# - 犀牛模拟，虚空和属性

> ID：467579
> 
> 赞同：2
> 
> 时间：2009-01-21T23:59:13.723
> 
> 标签：c#, tdd, mocking, rhino-mocks

刚从 Rhino Mocks 开始，我遇到了一个非常简单的问题，我如何模拟一个带有设置属性的 void 的类？

```
class SomeClass : ISomeClass
{
    private bool _someArg;

    public bool SomeProp { get; set; }

    public SomeClass(bool someArg)
    {
        _someArg = someArg; 
    }

    public void SomeMethod()
    {
        //do some file,wcf, db operation here with _someArg
        SomeProp = true/false;
    }
} 
```

显然这是一个非常人为的例子，谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T12:17:40.377

在您的示例中，您将不需要 RhinoMocks，因为您显然正在测试被测类的功能。简单的单元测试将代替：

```
[Test]
public void SomeTest()
{
    var sc = new SomeClass();
        // Instantiate SomeClass as sc object
    sc.SomeMethod();
        // Call SomeMethod in the sc object.

    Assert.That(sc.SomeProp, Is.True );
        // Assert that the property is true... 
        // or change to Is.False if that's what you're after...
} 
```

当你有一个依赖于其他类的类时，测试模拟会更有趣。在您的示例中，您提到：

> //在这里用_someArg做一些文件、wcf、db操作

即您希望其他一些类设置`SomeClass`' 的属性，这对模拟测试更有意义。例子：

```
public class MyClass {

    ISomeClass _sc;

    public MyClass(ISomeClass sc) {
        _sc = sc;
    }

    public MyMethod() {
        sc.SomeProp = true;
    }

} 
```

所需的测试将是这样的：

```
[Test]
public void MyMethod_ShouldSetSomeClassPropToTrue()
{
    MockRepository mocks = new MockRepository();
    ISomeClass someClass = mocks.StrictMock<ISomeClass>();

    MyClass classUnderTest = new MyClass(someClass);

    someClass.SomeProp = true;
    LastCall.IgnoreArguments();
        // Expect the property be set with true.

    mocks.ReplayAll();

    classUndertest.MyMethod();
        // Run the method under test.

    mocks.VerifyAll();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T00:30:39.617

取决于您希望模拟对象的保真度。最简单的方法是不用担心它并写出一些愚蠢的期望语句。

```
[Test]
public void SomeTest()
{
   MockRepository mocks = new MockRepository();
   ISomeClass mockSomeClass = mocks.StrictMock<ISomeClass>();
   using(mocks.Record())
   {
      using(mocks.Ordered())
      {
         Expect.Call(MockSomeClass.SomeProp).Return(false);
         Expect.Call(delegate{MockSomeClass.SomeMethod();});
         Expect.Call(MockSomeClass.SomeProp).Return(true);
      }
   }
} 
```

如果你想要一些更像真实对象的东西，而不需要一组固定的有序响应，你将不得不在 expect 上使用 do 方法设置委托。

```
delegate bool propDelegate();
delegate void methodDelegate();
private bool m_MockPropValue = false;

[Test]
public void SomeTest()
{
   MockRepository mocks = new MockRepository();
   ISomeClass mockSomeClass = mocks.StrictMock<ISomeClass>();
   using(mocks.Record())
   {
      SetupResult.For(MockSomeClass.SomeProp).Do(new propDelegate(delegate
      {
         return this.m_MockPropValue;
      }));
      Expect.Call(delegate{MockSomeClass.SomeMethod();}).Do(new methodDelegate(delegate
      {
         this.m_MockPropValue = true;
      }));
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T00:34:12.870

当你准备东西时，`SetupResult.For`你`Expect.Call`需要确保它们是**virtual**，否则 RhinoMocks 将无法进行自己的实现。

否则，就像**Scott Pedersen**所展示的那样，只需设置结果并进行预期调用即可

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T11:43:18.760

从这个问题中您要测试的对象是什么并不完全清楚 - 如果您只是想检查 SomeClass.SomeMethod() 设置了一个属性，那么您不需要模拟，因为您可以做一个简单的基于状态的测试：

```
[TestMethod]
public void SomeMethodTest()
{
    SomeClass s = new SomeClass();
    s.SomeMethod();

    Assert.AreEqual(expectedValue, s.SomeProp);
} 
```

或者，如果 SomeClass 是某个其他类的依赖项，并且您想测试该类与 SomeClass 之间的交互，那么您可以使用 RhinoMock 在测试的“记录”部分设置方法调用的期望，如下所示：

```
[TestMethod]
    public void CheckInteractionWithSomeClass()
    {
        MockRepository mocks = new MockRepository();
        ISomeClass someClass = mocks.StrictMock<ISomeClass>();

        using (mocks.Record())
        {
            //record expection that someClass.SomeMethod will be called...
            someClass.SomeMethod();
        }

        using (mocks.Playback())
        {
            //setup class under test - ISomeClass is injected through the constructor here...
            ClassUnderTest o = new ClassUnderTest(someClass);

            o.MethodOnClassUnderTestThatShouldCallSomeClass.SomeMethod();

            //any other assertions...
        }
    } 
```

# sockets - 不接受的连接会发生什么？

> ID：467583
> 
> 赞同：3
> 
> 时间：2009-01-22T00:00:57.383
> 
> 标签：sockets, networking, network-programming

假设 localhost:80 上的侦听套接字和使用以下连接的客户端： telnet localhost 80

问题是我只想接受有限数量的并发客户端，假设只有一个。在那之后，我根本不接受任何。

我看到的问题是：netstat -a 是建立了下一个客户端连接。是的，我不处理它，但是在系统级别上它显示为 ESTABLISHED，客户端可以发送数据并可能给系统带来额外的开销。

我看到的唯一方法是继续接受客户端但断开它们。我对吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T00:05:47.703

该`listen()`函数有一个`backlog`参数，该参数指定允许在操作系统内核中等待服务器到`accept()`它们的未完成套接字的数量。

在我的 Linux 系统上，手册页`listen()`说大多数时候客户端会收到`connection refused`错误 - 就像套接字根本没有监听一样。

如果您只想处理一个连接，那很好，您可以这样做：

```
listen(s, 0);
while ((new_fd = accept(s)) >= 0) {
    process(new_fd);
} 
```

如果你想处理多个，这会有点困难。您不能只将`backlog`参数设置为并发连接数，因为该参数不考虑有多少连接已经处于活动状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T00:05:32.507

如果您停止侦听该端口，则不应再允许任何传入连接。确保侦听器在接受第一个连接后关闭。

另外两个选项：

使用原始套接字（如果您的操作系统支持它们）。并手动处理 TCP 连接。不过，这将涉及大量额外的代码和处理。

使用 UDP。它们是无状态连接，但是您将不得不根据其他内容接受/拒绝数据包。不过，这没有 TCP 连接的开销。此外，您将无法使用 telnet 之类的东西进行测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T11:49:42.007

当您不再希望接受更多连接时，您应该简单地关闭侦听套接字，并在您确实希望接受连接时再次打开它。侦听积压对您根本没有帮助，因为它只是用于 TCP/IP 堆栈已接受但应用程序尚未接受的“半开”连接。

# visual-studio-2008 - Visual Studio 2008 中的目标文件丢失

> ID：467586
> 
> 赞同：0
> 
> 时间：2009-01-22T00:03:21.967
> 
> 标签：visual-studio-2008

我的解决方案主要是 C#，但我有一个 C++ 项目，它创建了一个我的 C# 代码调用的 DLL。这是布局：

[编辑：有两个级别的间接，这会导致问题]

我们将解决方案称为 MySolution。它有四个项目：

```
  我的解决方案
    MyCppDll（创建非托管 DLL）
    MyCSharpWrapper（非托管 DLL 的托管包装器）
    MyCSharpLibrary（包含访问包装器的类）
    MyCSharpProgram（从 MyCSharpLibrary 创建类）

```

我正确设置了依赖项，以便首先编译 MyCppDll，然后编译包装器、库和程序。但是，在 IDE 中构建时，MyCppDll 的输出不会复制到 MyCSharpLibrary 的输出目录中。

我可以通过为 MyCSharpLibrary 创建一个构建后步骤来解决该问题，使其将 MyCppDll.dll 复制到 MyCSharpLibrary\bin\Debug（或 \Release）目录。

但是当编译 MyCSharpProgram 时，它会获取与包装器和库关联的文件，但它没有获取 DLL。同样，我可以创建一个构建后步骤来执行此操作，但这并不理想，原因有几个。

真正的解决方案有几十个项目，其中很多都引用了 MyCSharpLibrary。可以想象，为每个步骤创建一个后期构建步骤是令人厌烦且容易出错的。每次我添加一个引用该程序集的新项目时，我都必须创建另一个构建后步骤。

它不应该是必要的。当我从命令行构建该解决方案时，DLL 会按预期从 MyCSharpLibrary 目录中复制。也就是说，从 IDE 构建，目录 MyCSharpProgram\bin\Debug 包含 MyCSharpProgram.exe、MyCSharpLibrary.dll、MyCSharpWrapper.dll（以及相关的 .pdb 文件）。但是，如果我从命令行构建（使用 MSBuild），则该目录包含所有内容和 MyCppDll.dll。

有没有其他人遇到过这个问题？我正在使用 Visual Studio 2008，但尚未升级到 SP1。

[编辑 - 问题似乎是文件没有被复制，除非程序项目直接引用到 Wrapper 项目。也就是说，如果我在 MyCSharpProgram 项目中添加对 MyCSharpWrapper 的引用，则会复制 DLL。同样，这只发生在 IDE 中。从命令行构建时，如果没有该参考，它可以正常工作。]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T11:26:42.653

在使用 Build 时，我们遇到了 Visual Studio 以及混合 C++ 和 C# 项目的问题。然后我们切换到只使用 Rebuild 并且它起作用了。您可能从命令行重新构建并在 IDE 中构建。

顺便说一句，难道不是这个引用需要在那里，因为项目以某种方式依赖它吗？

# c# - 如何进入亚音速？

> ID：467591
> 
> 赞同：7
> 
> 时间：2009-01-22T00:05:05.567
> 
> 标签：c#, sql, orm, subsonic

一个月前，我搜索了一些可以为我的 SQL 数据库/表生成 C# 类的工具。所以我不必手动编写 DAL 类并节省大量时间。

我遇到了“ORM”和亚音速。[我在主页http://subsonicproject.com/](http://subsonicproject.com/)上观看了网络广播，**对它印象深刻**。

但是我仍然缺少更多的文档/知识，无法在我们的项目中使用亚音速。今天我在某处读到了“迁移”功能——偶然。

如何进入亚音速？如何让它更舒服？如何了解它提供的所有功能/可能性？亚音速有什么好的博客/教程/任何东西吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T00:51:02.587

不幸的是，最好的 SubSonic“文档”是以截屏视频的形式出现的，但它们很容易理解。

[在 Rob Conery（原始创建者）的博客http://blog.wekeroad.com/tags/subsonic/](http://blog.wekeroad.com/tags/subsonic/)上有很多关于 SubSonic 的信息。

个人发现最好的事情是（就像马特说的）只是使用它，在 VS 的外部工具中设置它，对连接字符串和其他一些配置设置进行排序，然后你就可以开始了。您可以在一个下午了解基础知识。

该论坛非常活跃[http://forums.subsonicproject.com/forums/](http://forums.subsonicproject.com/forums/)，如果您遇到困难，这是一个好地方。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T00:21:29.887

SubSonic 的文档非常短缺（这是我放弃它的原因之一）。Scott Kuhl 写了一个“SubSonic 入门”文档（只是谷歌他的名字和 SubSonic），但其中的一部分似乎已经过时了。

这是[Scott 的博客](http://geekswithblogs.net/scottkuhl/Default.aspx)- 至少是一个开始的地方。

这是[文档的主页](http://geekswithblogs.net/scottkuhl/archive/2006/12/09/subsonicdoc.aspx)。我很好奇该文档是否确实已过时，我认为是：该网页的最后更新日期为 2006 年。

不幸的是，我不知道其他文档，我*确实*寻找过它。

更新：请参阅 Rob Conery 在他的回答中提供的文档链接。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-30T19:48:56.313

我承认 - 我们的文档很烂 :(。我确实尝试将一个网站放在一起： [http ://subsonicproject.com](http://subsonicproject.com)

希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T00:24:58.693

刚开始使用它。

它非常简单而且非常直接。有几个关于如何使用副指挥官生成课程的截屏视频，一旦你点击了。看看你能用它们做什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T08:39:29.327

我整理了一个引用从 Northwind 数据库生成的 SubSonic 的模板项目。一个非常简单的项目，但应该足以开始您的第一个项目。在这里查看：

[http://ajondeck.net/post/2008/12/29/ASPNET-20-SubSonic-Project-Template-With-SQL-Server-2005-Northwind-DB.aspx](http://ajondeck.net/post/2008/12/29/ASPNET-20-SubSonic-Project-Template-With-SQL-Server-2005-Northwind-DB.aspx)

# python - 如何在 OS X 上读取 Python 中的系统信息？

> ID：467600
> 
> 赞同：1
> 
> 时间：2009-01-22T00:08:19.507
> 
> 标签：python, macos, operating-system

根据这个与[操作系统无关的问题](https://stackoverflow.com/questions/466684/how-can-i-return-system-information-in-python)，特别是[这个响应](https://stackoverflow.com/questions/466684/how-can-i-return-system-information-in-python#467291)，类似于 Linux 上的 /proc/meminfo 等提供的数据，我如何使用 Python 从 OS X 读取系统信息（包括但不限于内存使用情况）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T00:54:13.377

您可以从命令行实用程序[`sysctl`](http://developer.apple.com/DOCUMENTATION/Darwin/Reference/ManPages/man8/sysctl.8.html)和[`vm_stat`](http://developer.apple.com/DOCUMENTATION/DARWIN/Reference/ManPages/man1/vm_stat.1.html)（以及`ps`，如在[这个问题](https://stackoverflow.com/questions/276052/how-to-get-current-cpu-and-ram-usage-in-python)中）获取大量系统信息。

如果您没有找到更好的方法，您可以随时使用[`subprocess`](http://docs.python.org/library/subprocess.html).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T01:04:24.543

唯一可以从平台模块中获得非常好的东西，但它非常有限（cpu、操作系统版本、架构等）。对于 cpu 使用和正常运行时间，我认为您必须包装命令行实用程序“uptime”和“vm_stat”。

我为 vm_stat 构建了一个，另一个由你决定；-)

```
import os, sys

def memoryUsage():

    result = dict()

    for l in [l.split(':') for l in os.popen('vm_stat').readlines()[1:8]]:
        result[l[0].strip(' "').replace(' ', '_').lower()] = int(l[1].strip('.\n '))

    return result

print memoryUsage() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T00:52:59.293

我做了更多的谷歌搜索（寻找“OS X /proc”）——看起来 sysctl 命令可能是你想要的，虽然我不确定它是否会给你所需的所有信息。这是手册页：http: [//developer.apple.com/DOCUMENTATION/Darwin/Reference/ManPages/man8/sysctl.8.html](http://developer.apple.com/DOCUMENTATION/Darwin/Reference/ManPages/man8/sysctl.8.html)

另外，[维基百科](http://en.wikipedia.org/wiki/Sysctl)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T01:42:18.240

这是一个基于 MacFUSE 的 /proc fs：

[http://www.osxbook.com/book/bonus/chapter11/procfs](http://www.osxbook.com/book/bonus/chapter11/procfs)

如果您可以控制在其上运行 python 程序的盒子，那么它可能是一个合理的解决方案。无论如何，有一个 /proc 来查看是件好事！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-20T17:32:58.830

我正在寻找同样的东西，我注意到这个问题没有公认的答案。在最初提出问题后的中间时间，发布了一个名为 psutil 的 python 模块：

[https://github.com/giampaolo/psutil](https://github.com/giampaolo/psutil)

对于内存利用率，您可以使用以下内容：

```
>>> psutil.virtual_memory()
svmem(total=8374149120L, available=2081050624L, percent=75.1, used=8074080256L, free=300068864L, active=3294920704, inactive=1361616896, buffers=529895424L, cached=1251086336)
>>> psutil.swap_memory()
sswap(total=2097147904L, used=296128512L, free=1801019392L, percent=14.1, sin=304193536, sout=677842944)
>>> 
```

还有cpu利用率、进程管理、磁盘和网络等功能。模块中唯一遗漏的是一个用于检索平均负载的函数，但如果您在类 UNIX 系统上，python stdlib 具有 os.getloadavg() 。

psutil 声称支持 Linux、Windows、OSX、FreeBSD 和 Sun Solaris，但我只尝试过 OSX mavericks 和 fedora 20。

# iphone - 显示 iPhone 键盘

> ID：467601
> 
> 赞同：5
> 
> 时间：2009-01-22T00:09:01.800
> 
> 标签：iphone, ios, cocoa-touch

我遇到了 UITextView 的问题，该问题似乎与在可滚动视图中具有可滚动视图有关。

为了解决这个问题，我想我会尝试编写自己的多行（但不可滚动）文本视图。鉴于核心图形方法和 UITextInputTraits 类，这似乎应该是可行的。我唯一想不通的是它是否可以为系统范围的键盘显示（和捕获事件）。

这甚至可以使用 SDK 吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T05:10:25.730

我在类似情况下所做的是隐藏 UITextField，并将其委托设置为您的类，您可以在其中实现适当的 UITextFieldDelegate 方法来拦截按下的键。

像这样的东西：

```
UITextField *myHiddenTextField = [[UITextField alloc] initWithFrame: cgRectZero()];
myHiddenTextField.delegate = self;
[myHiddenTextField becomeFirstResponder];

- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
//use string here for the text input
return false;
} 
```

# python - 如何在 Windows 上读取 Python 中的系统信息？

> ID：467602
> 
> 赞同：3
> 
> 时间：2009-01-22T00:09:44.480
> 
> 标签：python, windows, operating-system

根据这个与[操作系统无关的问题](https://stackoverflow.com/questions/466684/how-can-i-return-system-information-in-python)，特别是[这个响应](https://stackoverflow.com/questions/466684/how-can-i-return-system-information-in-python#467291)，类似于 Linux 上的 /proc/meminfo 等提供的数据，我如何使用 Python 从 Windows 读取系统信息（包括但不限于内存使用情况）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T20:11:41.763

在 Windows 中，如果您想从 SYSTEMINFO 命令中获取信息，您可以使用[WMI 模块。](https://pypi.python.org/pypi/WMI/)

```
import wmi

c = wmi.WMI()    
systeminfo = c.Win32_ComputerSystem()[0]

Manufacturer = systeminfo.Manufacturer
Model = systeminfo.Model 
```

...

同样，操作系统相关信息可以从[系统信息](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394102%28v=vs.85%29.aspx)`osinfo = c.Win32_OperatingSystem()[0]` 的完整列表中获取，[操作系统信息在此处](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394239%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T00:32:16.073

有人问了一个类似的问题：

[如何在 Python 中获取当前的 CPU 和 RAM 使用情况？](https://stackoverflow.com/questions/276052/how-to-get-current-cpu-and-ram-usage-in-python)

有很多答案告诉您如何在 Windows 中完成此操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-03T19:53:01.150

您可以尝试使用我不久前创建的 systeminfo.exe 包装器，它有点不正统，但它似乎很容易做到这一点，而且不需要太多代码。

这应该适用于 2000/XP/2003 服务器，并且应该适用于 Vista 和 Win7，前提是它们带有 systeminfo.exe 并且它位于路径上。

```
import os, re

def SysInfo():
    values  = {}
    cache   = os.popen2("SYSTEMINFO")
    source  = cache[1].read()
    sysOpts = ["Host Name", "OS Name", "OS Version", "Product ID", "System Manufacturer", "System Model", "System type", "BIOS Version", "Domain", "Windows Directory", "Total Physical Memory", "Available Physical Memory", "Logon Server"]

    for opt in sysOpts:
        values[opt] = [item.strip() for item in re.findall("%s:\w*(.*?)\n" % (opt), source, re.IGNORECASE)][0]
    return values 
```

您可以轻松地将其余数据字段附加到 sysOpts 变量中，不包括那些为其结果提供多行的字段，例如 CPU 和 NIC 信息。正则表达式行的一个简单模型应该能够处理这个问题。

享受！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-14T15:01:32.623

如果操作系统语言不是母语英语，则给出的一些答案可能会造成麻烦。我搜索了一种方法来包装`systeminfo.exe`并找到以下解决方案。为了使它更舒服，我将结果打包在字典中：

```
import os
import tempfile

def get_system_info_dict():

    tmp_dir=tempfile.gettempdir()
    file_path=os.path.join(tmp_dir,'out')
    # Call the system command that delivers the needed information
    os.system('powershell -Command gcim WIN32_ComputerSystem -Property * >%s'%file_path)

    with open(file_path,'r') as fh:
        data=fh.read()
    os.remove(file_path)

    data_dict={}
    for line in data.split('\n'):
        try:
            k,v=line.split(':')
        except ValueError:
            continue
        k = k.strip(' ')
        v = v.strip(' ')
        if v!='':
            data_dict[k]=v

    return data_dict 
```

结果字典的每个键都是一个属性（英文！），相关的值是为该属性存储的数据。

# css - 带 img 的 CSS 列标题 - 如何将 img/div 停靠在右侧？

> ID：467603
> 
> 赞同：2
> 
> 时间：2009-01-22T00:11:04.243
> 
> 标签：css, html-table, cell, ellipsis, dock

我有一个 HTML 表格，用作网格视图的列标题。单击列标题会触发使网格视图排序的 javascript，并且显示列已排序的图标显示在列文本旁边，类似于以下内容：

```
|---------------------------------------------------------------------------------|
| <span> Column 1 </span> <div class="sortImgSprite" /> | <span> Column 2 </span> |
|---------------------------------------------------------------------------------| 
```

该表格具有表格布局：固定，文本范围具有溢出：隐藏，文本溢出：省略号，空白：nowrap。

当文本很长时，我确实得到了我想要的省略号效果，但是排序图标精灵（设置了宽度和背景的 div）被从表格单元格的右侧剪掉了。有什么建议可以通过 CSS 确保排序图标优先于省略文本的空间？如果一列是“排序的”，我希望排序 img 始终存在并且具有文本椭圆而不是文本将 img 推出单元格的可见空间：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T00:15:11.397

我不确定您要向图像添加什么浮动，但是您是否尝试过向右浮动并添加大约 5 px 的右边距？那会把它推进去。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T00:21:43.100

为什么不直接将“sortImgSprite”类添加到`<span>`标签中呢？既然你是通过 JavaScript 进行排序，你必须有一个表列的句柄？

当用户对列进行排序时，将“sortImgSprite”类添加到左侧或右侧（如果需要，可以添加一点填充）并在该列不再排序时将其删除。

...或者我错过了什么？

啊。我错过了一些东西。认为溢出的文本在列标题下方的行中，而不是在标题本身中。

好的，那么如果您要将类添加到表头怎么办？您的`<th>`标签（如果这是您使用的）可以使图像与单元格右侧对齐，然后您的`<span>`标签可以继承该类并添加其他格式（例如文本溢出等）？

同样，您可能需要在 span 的右侧进行填充，以便可以在任何文本后面清楚地看到表格标题单元格的背景图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T01:17:26.933

感谢您的建议！这是我最终通过 CSS 获得我想要的东西：

```
<html>
<head>
<style type="text/css">
table
{
   table-layout:fixed;
   width: 300px;
}

div.foo
{
   float:right;
   width:25px;
   height:1.2em;
   background-color:green;
}

.bar
{
   margin-right:30px;
   white-space:nowrap;
   overflow:hidden;
   text-overflow:ellipsis;
}
</style>
</head>

<body>
<table border="1">
   <tr>
      <td>
         <div class="foo"></div>
         <div class="bar" title="This is some text. This is some text. This is some text. This is some text.">This is some text. This is some text. This is some text.</div>
      </td>
   </tr>
</table>
</body>  
</html> 
```

# c# - Parse 诉 TryParse

> ID：467613
> 
> 赞同：116
> 
> 时间：2009-01-22T00:16:38.600
> 
> 标签：c#, parsing, integer, tryparse

Parse() 和 TryParse() 有什么区别？

```
int number = int.Parse(textBoxNumber.Text);

// The Try-Parse Method
int.TryParse(textBoxNumber.Text, out number); 
```

是否有某种形式的错误检查，例如 Try-Catch 块？

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2009-01-22T00:20:11.933

`Parse`如果它无法解析该值，则抛出异常，而`TryParse`返回一个`bool`指示它是否成功。

`TryParse`不只是`try`/`catch`内部 - 它的全部意义在于它没有例外地实现，因此它很快。事实上，它最有可能实现的方式是，该`Parse`方法将在内部调用`TryParse`，然后在返回时抛出异常`false`。

简而言之，`Parse`如果您确定该值有效，请使用；否则使用`TryParse`.

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-01-22T00:18:31.763

如果字符串不能转换为整数，则

*   `int.Parse()`会抛出异常
*   `int.TryParse()`将返回 false（但不会抛出异常）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-22T00:18:52.107

TryParse 方法允许您测试某些内容是否可解析。如果您在第一个实例中使用无效的 int 尝试 Parse，则在 TryParse 中会出现异常，它会返回一个布尔值，让您知道解析是否成功。

作为脚注，将 null 传递给大多数 TryParse 方法将引发异常。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-22T00:23:34.500

[TryParse 和例外税](http://www.codinghorror.com/blog/archives/000358.html)

如果从字符串到指定数据类型的转换失败，Parse 会引发异常，而 TryParse 会显式避免引发异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T00:19:16.740

TryParse 不返回值，它返回一个状态码来指示解析是否成功（并且不抛出异常）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-18T16:43:57.953

作为记录，我正在测试两个代码：这只是尝试从字符串转换为数字，如果失败则将数字分配为零。

```
 if (!Int32.TryParse(txt,out tmpint)) {
            tmpint = 0;
        } 
```

和：

```
 try {
            tmpint = Convert.ToInt32(txt);
        } catch (Exception) {
            tmpint = 0;
        } 
```

对于 c#，最好的选择是使用 tryparse，因为 try&Catch 替代抛出异常

```
A first chance exception of type 'System.FormatException' occurred in mscorlib.dll 
```

这是痛苦的缓慢和不可取的，但是，除非调试的异常被解决，否则代码不会停止。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-31T09:13:25.343

我知道这是一篇非常古老的帖子，但我想分享更多关于 Parse 与 TryParse 的细节。

我有一个需要将 DateTime 转换为 String 的场景，如果 datevalue 为 null 或 string.empty，我们将面临异常。为了克服这个问题，我们将 Parse 替换为 TryParse 并将获得默认日期。

旧代码：

```
dTest[i].StartDate = DateTime.Parse(StartDate).ToString("MM/dd/yyyy");
dTest[i].EndDate = DateTime.Parse(EndDate).ToString("MM/dd/yyyy"); 
```

新代码：

```
DateTime startDate = default(DateTime);
DateTime endDate=default(DateTime);
DateTime.TryParse(dPolicyPaidHistories[i].StartDate, out startDate);
DateTime.TryParse(dPolicyPaidHistories[i].EndDate, out endDate); 
```

必须声明另一个变量并用作 TryParse 的 Out。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2011-07-22T00:58:13.200

double.Parse("-"); 引发异常，而 double.TryParse("-", out parsed); 解析为 0 所以我猜 TryParse 做了更复杂的转换。

# apache-flex - 如何从 swf 实例化类？

> ID：467622
> 
> 赞同：3
> 
> 时间：2009-01-22T00:20:33.053
> 
> 标签：apache-flex, flash, actionscript-3, loader

我有一个 FLA 文件，其中包含我设置为“类”的库中的对象（在 CS3 中，右键单击库中的一个项目选择属性，确保它设置为导出为动作脚本，并具有类名）

对于本练习，我们将类命名为“MyClass”

如果我将该 FLA 发布到 SWC 和 SWF：

我可以静态加载 SWC，并通过简单地执行以下操作来实例化“MyClass”：

```
var inst:MyClass = new MyClasS(); 
```

现在，问题是：我希望能够在运行时通过使用加载器对象加载 SWF 文件来执行此操作。

我了解如何访问在发布之前在 FLA 中手动创建的实例，但我想要做的是创建“MyClass”类的新实例。

我可以得到一个代表 swf 文件的“MovieClip”，我可以将它添加到我的显示列表中，但我似乎无法获得其中包含的类。（我希望这是有道理的）

任何有关如何解决此问题的建议将不胜感激。

编辑：格式代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T08:14:22.223

完成克里斯蒂安的回答：

```
var cls : Class = loader.contentLoaderInfo.applicationDomain.getDefinition("ClassName");

var instance : Object = new cls(); 
```

此外，值得注意的是，除非该类实现了也在您的主应用程序中定义的接口，否则您不会获得强类型（即，它必须声明为 Object）。然后，您将能够将实例变量声明为接口并在编译时访问它的成员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T05:54:56.077

[看看这里](http://newmovieclip.wordpress.com/2007/08/23/access-load-library-assets-from-another-swf-in-flash-cs3/)；您应该能够使用 Loader.contentLoaderInfo.applicationDomain.getDefinition("MyClass") 提取类引用。

# django - 如何将 django 应用服务器部署为一个鸡蛋，在 fastcgi 后面运行？

> ID：467630
> 
> 赞同：0
> 
> 时间：2009-01-22T00:24:44.700
> 
> 标签：django, fastcgi, setuptools, egg

我想在 apache/fastcgi 后面运行一个 django appserver。没问题，django 开箱即用。

我希望这个 appserver 可以通过 setuptools 进行部署。也就是我把它做成鸡蛋，用easy_install安装。这部分我也可以处理，即使 setuptools 不是 django appserver 的标准补充。

但我想不通的是 dispatch.fcgi 是如何实际调用这个 my_app.egg 来“启动”服务器进程的。有没有人曾经在这个配置中运行过？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T09:17:37.057

您可能想要做的是使用[Paste](http://pythonpaste.org/)之类的东西来委托给您的 Egg（请参阅[此处](http://pythonpaste.org/deploy/#the-config-file)的示例粘贴部署配置文件）；这意味着`flup`手动执行这些操作（将 FastCGI 转换为 WSGI），因为您将指向`flup`Paste 而不是 Django，但您可以查看 Django 管理脚本以了解它是如何工作的。

# c++ - 将 dll 引用添加到托管 c++ 项目时出现编译器错误

> ID：467640
> 
> 赞同：0
> 
> 时间：2009-01-22T00:27:09.360
> 
> 标签：c++, compiler-errors, managed-c++, tlbimp

我正在使用 VS 2008 并且在我的 C++ 项目中添加对托管 c++ 文件的 dll 引用时偶尔会出现编译器错误。我正在尝试添加对 dll 的引用，以便能够使用智能指针。 **例如：#import items.tlb**

问题是编译器在**items.tlh**内的零星地方崩溃，几乎就像删除了缺失的字节块一样，但是当我打开文件时，我找不到对上述错误的任何引用。

我多次尝试重建整个项目，在不同的机器上尝试过，但是虽然编译器错误不一致并且有时会一起消失，但重新重建有时会带来问题。有人告诉我，生成的**.tlh**文件的大小可能是一个原因，但它并不能真正解决我的问题或为我指明正确的方向。

有没有人经历过同样的症状？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T00:51:47.470

每当我遇到这个问题时，它都是由将调试版本链接到发布 DLL 或将发布版本链接到调试 DLL 引起的。

# c# - VB.NET：什么是 VB.NET 中的静态 T (C#)？

> ID：467642
> 
> 赞同：6
> 
> 时间：2009-01-22T00:29:18.030
> 
> 标签：c#, .net, c#-to-vb.net

考虑：

```
public static T GetValueOrDefault<T>(this IDataReader reader, string columnName)

 T returnValue = default(T); 
```

我想实现这样的东西[来](http://weblogs.asp.net/skillet/archive/2008/06/18/idatareader-extension-methods.aspx)检查 DBNull。我可以很好地遵循代码，但我不太明白 VB.NET 中的静态 T 是什么。有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-22T00:45:14.050

相当于`static`VB 中的`Shared`. 共享方法通常放在 Helper 类中，因为它们不需要类的实例来运行。

类型 T 表示这是一个泛型方法（这是 VB 9 和 C# 3 中的新功能）。泛型方法有效地将类型作为参数或返回泛型类型。

扩展方法在 VB 9/C# 3 中也是新的。它们允许您通过添加方法来扩展现有类型。您所需要的只是一个共享方法，该方法与您的代码在同一命名空间中可用，而在 VB 中，代码必须位于模块中，而不是普通类中。

模块是不能实例化的类，（因此）只有共享方法。它是用 Module 关键字代替 class 关键字声明的。这是您在 VB 中的代码。

（对于那些知道“幕后”发生了什么的人，奇怪地将值类型设置为`Nothing`在 VB 中编译，并且是获取值类型默认值的受支持方式）。

```
Imports System.Runtime.CompilerServices
<Extension()> _
Public Shared Function GetValueOrDefault(Of T)(ByVal reader As IDataReader, ByVal columnName As String) As T
Dim returnValue As T = Nothing

End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T00:40:21.767

他正在创建一个扩展方法。在 C# 中，这是通过创建静态方法（在 Visual Basic 中为 Shared）来完成的。

在 Visual Basic 中创建扩展方法的机制似乎与在 C# 中的创建方式大不相同。您可能想在这里阅读有关扩展方法的 MSDN 条目：http: [//msdn.microsoft.com/en-us/library/bb384936.aspx](http://msdn.microsoft.com/en-us/library/bb384936.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T00:45:57.870

这是该方法在 VB 中的样子：

```
Imports System.Runtime.CompilerServices 

<Extension()> _
Public Shared Function GetValueOrDefault(Of T)(ByVal reader As IDataReader, ByVal columnName As String) as T
    Dim returnvalue As T = Nothing
End Function 
```

我不确定如何在 VB 中执行 default(T)，所以我把它省略了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T00:36:01.590

您正在查看的不是“静态 T”，而是两个独立的部分。

*   public 表示该方法是公开可见的。
*   static 表示该方法是静态的。这意味着它为类运行，而不是为实例运行。
*   T - 是返回类型。

有关[静态函数](http://msdn.microsoft.com/en-us/library/79b3xss3.aspx)的更多信息。

VB.NET 中的静态函数称为共享函数。

有关[共享功能](http://www.developerfusion.com/article/1047/new-objectoriented-capabilities-in-vbnet/5/)的更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T00:39:34.077

C# 的 static 关键字与 VB 的 Shared 关键字相同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T00:45:08.747

您示例中的 T 是通用方法中的类型参数。

在 VB 中：

```
Public Function GetValueOrDefault(Of T)(ByVal reader as IDataReader, ByVal columnName as string) as T 
```

意味着当你调用方法时，你提供一个类型参数（告诉方法调用的类型 T ）

不过，不确定用于创建扩展方法的 VB 语法。（这就是第一个参数上的“this”关键字所表示的内容。）

# c# - SQL Server 2005 浏览器服务

> ID：467644
> 
> 赞同：0
> 
> 时间：2009-01-22T00:29:33.630
> 
> 标签：c#, sql, sql-server

我一直在使用 SQL Server 和 C# 做一些工作，每次运行该死的东西时，连接都会超时，除非我启动 services.msc 并手动重新启动服务（SQL Browser 服务）。它已经设置为自动，有人知道为什么会这样做吗？我不是高级程序员，更像是中级程序员。一旦我重新启动此服务，只要我继续使用它就可以正常工作。如果我停止使用它超过 30 分钟，我必须重新启动它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-31T03:36:42.517

你检查过 SQl 服务器日志和 windows 事件日志吗？

您能否提供更多信息，例如您用于打开/关闭连接的 C# 代码、连接字符串等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-31T12:13:05.763

[自动关闭](http://msdn.microsoft.com/en-us/library/ms190249(SQL.90).aspx)开始了吗？

SQL 2005 Express 版本默认为 ON，但其他版本可能已设置。数据库应该会自动打开...

是来自应用程序的查询超时吗？或者只是尝试连接到服务器以运行，例如 SELECT @@SERVERNAME？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-31T03:37:16.117

您能否通过 SSMS 按名称连接到 SQL Server 而无需摆弄浏览器服务（我什至不确定这是否真的需要浏览器服务，具体取决于您的连接方式）？即它似乎运行良好，除非您的程序导致它崩溃？一旦您重新启动它，它是否可以反复正常工作，或者您是否必须在使用程序时继续重新启动它？

您使用的是什么版本的 SQL Server 2005（以及什么服务包级别）？

# c++ - 解析数组 C++ 的内容

> ID：467649
> 
> 赞同：-1
> 
> 时间：2009-01-22T00:32:42.470
> 
> 标签：c++

我有这个代码：

```
cout << "Your Value is: ";

for ( int x = nStart + 1; x < sBuffer.length(); x++ )
          {

              if ( sBuffer[ x ] == ',' )
              {    
                   nStart = x;
                   break;
                   }
              cout << sBuffer[ x ];
          }
// setprecision doesnt work right when used with [] but i try anyway..

       cout << setprecision(2) << sBuffer[ x ]; 
```

我的 sBuffer[ x ] 包含一个双精度值，例如 4.1415679

我想使用 setprecision(2) 只显示 4.14

我卡住了，我该怎么办？

* * *

它不包含双精度，因为我正在阅读一个文本文件，我忘了说抱歉。

我的文本文件具有以下格式：

字符串，一些字符串，49.59494、29.4094944

将逗号前的每个字段存储到 sBuffer[x​​] 中。

所以我实际上确实有一个双。我认为它不起作用的原因是编译器将其解释为字符串或字符，而不是双精度值。

正确的？

继承人我的完整代码可以随意在 dev 或其他东西中编译，但一定要使用这种格式的文本文件：

字符串，一些字符串，54.2345,34.6654 ...

```
#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <iomanip>
#include <cstdlib>

using namespace std;

int main()
{
    string usrFileStr,
    fileStr = "test.txt",  // declaring an obj string literal
    sLine,                        // declaring a string obj
    sBuffer;

    int lineCount = 1;

    fstream inFile;                  // declaring a fstream obj
    // cout is the name of the output stream
    cout << "Enter a file: ";
    cin >> usrFileStr;

    inFile.open( usrFileStr.c_str(), ios::in ); 
    // at this point the file is open and we may parse the contents of it

    while ( getline ( inFile, sBuffer ) && !inFile.eof() )
    {
          int nStart = -1 ;
          cout << "First String " << lineCount << " (";
          for ( int x = nStart + 1; x < sBuffer.length(); x++ )
          {
              if ( sBuffer[ x ] == ',' )
              {
                   nStart = x;
                   break;
                   }
              cout << sBuffer[ x ];
          }
          cout << ") ";
          for ( int x = nStart + 1; x < sBuffer.length(); x++ )
          {

              if ( sBuffer[ x ] == ',' )
              {    
                   nStart = x;
                   break;
                   }
              cout << sBuffer[ x ];
          }
          cout << " (First dValue";
          for ( int x = nStart + 1; x < sBuffer.length(); x++ )
          {

              if ( sBuffer[ x ] == ',' )
              {
                   nStart = x;
                   break;
                   }
              cout << setprecision(2) << sBuffer[ x ];
          }
          cout << ", Second dValue: ";
          for ( int x = nStart + 1; x < sBuffer.length(); x++ )
          {
              if ( sBuffer[ x ] == ',' )
              {
                   nStart = x;
                   break;
                   }
              cout << sBuffer[ x ];
          }
          cout << ") \n";
          lineCount++;
    }

    cout << "There are a Total of: " <<  lineCount << " line(s) in the file."
    << endl;

    inFile.clear();           // clear the file of any errors
    inFile.close();  // at this point we are done with the file and we close it

    fgetc( stdin );
    return 0;
}

// use a funnction 
```

是的，我知道我可以使用函数原型来处理过度循环（4），但我想首先解决这个价值问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T00:50:19.627

看起来 sBuffer 是一个字符串或字符数组，因此当您打印 sBuffer[x​​] 时，它会将其视为字符而不是浮点数。

您需要将数字的字符串表示形式转换为双精度。您可以使用 C 中的`atof`or`strtod`函数，或`boost::lexical_cast<double>`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T00:58:49.170

看起来您`sBuffer[x]`不会包含双精度数，`','`毕竟您将其与它进行比较。那么`sBuffer`字符缓冲区呢？然后`sBuffer[x]`只是“4.1415679”中的一个字符，如果只输出这个字符，setprecision 不会做你想做的事。

您可以使用 stringstreams 从字符串中读取双精度：

```
#include <sstream>

istringstream strm("4.1415679");
double d;

if (strm >> d) {
  cout << "Your number: " << setprecision(2) << d << endl;
}
else {
  cout << "Not a number." << endl;
} 
```

如果你安装了[boost](http://boost.org/)库（总是一个好主意），你也可以使用`boost::lexical_cast<double>("...")`，就像 Matthew Crumley 说的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T00:44:42.273

你可能想要[`std::fixed`](http://www.cplusplus.com/reference/iostream/manipulators/fixed.html)：

```
cout << fixed << setprecision(2) << sBuffer[ x ];
//      ^^^^^ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T00:46:20.290

如果 sBuffer 是一个字符数组，那么它不包含双精度数。

# c# - 内存限制

> ID：467653
> 
> 赞同：1
> 
> 时间：2009-01-22T00:34:35.147
> 
> 标签：c#, memory

我创建了一个应用程序，用于从一个域复制用户（10,000+）并在另一个域中创建具有自定义属性的用户。

该应用程序似乎运行良好，直到达到 1.7gb 内存，我知道 32 位机器上每个进程的限制为 2gb，但我在具有 24gb RAM 的 Windows Server 2008 x64 副本上运行它。

我的应用程序没有崩溃，但在它应该完成之前完成（大约 3000 个用户），也许内存限制不是我的问题，但是当我的应用程序与一个更简单的应用程序进行比较时，这是第一个脱颖而出的应用程序，它只在循环时计算用户数通过。

我将我的项目设置为“任何 CPU”，它在没有 *32 标志的任务管理器中显示。

谁能帮我理解发生了什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T00:48:00.770

您的程序中是否有任何单个数据结构超过 2 GB？.NET 运行时可以访问超过 2gb，但任何单个对象的大小都不能超过 2gb。例如，您不能分配大于 2 GB 的字节数组。

在使用 .NET 集合时，这可能会让您大吃一惊。特别是通用 Dictionary 和 HashSet 集合类型。

尝试将某些内容添加到集合时，您是否遇到内存不足异常？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T01:43:50.203

无论您是否应该达到限制，在我看来，您都在持有对一些您并不真正需要的对象的引用。

如果您不知道为什么要消耗这么多内存，您可能想尝试分析您的内存使用情况，看看您是否真的需要所有这些内存。有很多选择，但 Microsoft CLR Profiler 是免费的，可以满足您的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T00:58:26.643

我的大部分应用程序正在使用 DirectorySearcher 遍历所有 10000 多个用户，然后对于找到的每个 DirectoryEntry，我使用以下命令创建一个帐户：

```
using(DirectoryEntry newUser = root.Children.Add("LDAPPATH"))
{
      //Assign properties to the newUser
      newUser.CommitChanges();
      //write the new username to a file using a streamwriter.
} 
```

然后我关闭 streamwriter 并报告显示已创建的用户数。

我将 DirectorySearcher 的页面大小设置为 110000 以获取所有结果。我的应用程序刚刚完成，因为它应该只报告创建了 3500 个用户。

我为 DirectorySearcher 使用相同的代码创建了一个简单的测试，而不是创建帐户，我只是增加了一个计数器，计数器达到了我预期的数字，所以我认为必须是帐户创建或日志记录到文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T01:22:21.837

您的记录来源是什么？您可以使用连接的 DataReader 类型模型而不是断开连接的 DataTable/DataSet 类型模型来避免在内存中保留超过当前记录吗？

我怀疑你只是碰巧有一个 24GB 内存的服务器，*没有做任何其他事情*。它必须有一些工作需要 RAM 可用于此目的。仅仅因为你的机器上有这么多内存并不一定意味着它可用，或者依赖它是个好主意。

# vb.net - WinForms多行文本框，Enter键坚持将焦点移出文本框

> ID：467656
> 
> 赞同：-1
> 
> 时间：2009-01-22T00:36:28.950
> 
> 标签：vb.net, winforms, textbox, multiline

我有一个多行文本框和它下面的按钮。

VB.NET、WinForms、.NET 2.0

System.Windows.Forms.Textbox

多行 = 真

接受返回 = 真

AcceptsTab = 假

CausesValidation = False

没有明确编码的事件。

我希望 Enter 键插入换行符，并且永远不要将焦点移动到下一个控件（按钮）。

我希望 Tab 键始终将焦点移动到 Tab 键顺序中的下一个控件（按钮）。

相反，Enter 键插入一个换行符，然后将焦点移到下一个控件（按钮）。它也可以使用 Ctrl-Enter 来完成，这真的让我感到困惑！

通过阅读帮助文件和广泛的谷歌搜索，它应该按照我需要的方式工作。但显然我错过了一些东西。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T03:46:06.150

我经常用于解决此类问题的一种方法是迭代地添加和减去代码，直到我可以将其缩小到导致问题的一件事。

例如，您可以先创建一个只有一个编辑框和一个其他控件的非常简单的项目，然后看看它做了什么。如果此代码按照您希望的方式运行，那么您可以开始一点一点地添加代码，使简单项目越来越接近预期的最终产品，直到出现错误。然后查看您添加的最后一点代码，看看您是否可以从中减去一些代码，直到错误消失。重复几次可能会帮助您找到罪魁祸首。

或者，您可以从现有的（行为不端的）代码开始，然后开始对其进行简化，直到错误消失。然后你添加回你删除的最后一个东西的一部分，并像上面那样迭代。

最后，在这种情况下，您还可以尝试为编辑控件的[Leave](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.leave.aspx)事件添加事件处理程序，并在处理程序中放置一个断点。当 BP 命中时，检查调用堆栈，看看您是否可以了解哪些代码促成了焦点更改。为此，您的调试器可能需要配置为显示您没有源代码的代码（即禁用调试器中的 Just My Code 选项）。如果您想获得小组的帮助来破译它，您甚至可以将（修剪过的）调用堆栈粘贴到问题中。

**ps**有人知道上述迭代调试方法的名称吗？如果不是，我可以建议称它为牛顿法（或者可能是牛顿法），因为它类似于牛顿法，用于迭代地寻找数学函数的根。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T00:53:42.537

它绝对不应该那样做。我唯一能想到的是它没有足够的高度来容纳多条线。尝试添加...

```
textBox1.ScrollBars = ScrollBars.Vertical 
```

如果不是我不知道。尝试创建一个空白项目并创建一个带有一个文本框的表单，一个按钮设置属性，看看会发生什么......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T14:21:35.587

原来我忘记了我在其他地方以相同的形式完成了这个（下面）：

```
'http://duncanmackenzie.net/blog/Enter-Instead-of-Tab/default.aspx
Protected Overrides Sub OnKeyUp(ByVal e As System.Windows.Forms.KeyEventArgs)
    If e.KeyCode = Keys.Enter Then
        e.Handled = True
        Me.ProcessTabKey(Not e.Shift)
    Else
        e.Handled = False
        MyBase.OnKeyUp(e)
    End If
End Sub 
```

# java - java中的纯轻量级应用

> ID：467657
> 
> 赞同：1
> 
> 时间：2009-01-22T00:36:33.973
> 
> 标签：java, swing

是否可以在 java 中编写“纯”轻量级代码？Swing 是轻量级的，但即使它也有重量级的组件，如 JWindow、JFrame、JDialog 和 JApplet。所以即使是 Swing 应用程序也不是 100% 独立于底层操作系统

是否有可能在 java 中拥有完全独立于图形显示的底层操作系统的轻量级应用程序？是否可以用java编写这样的代码？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-22T00:40:45.993

嗯...是的，那些是“100% 独立于”操作系统的。

至少到了所有 JVM 都必须支持它们的程度。

我想我不明白你所说的 100% 独立是什么意思。在它的核心，Swing 只需要访问核心窗口管理器和一个 blitter，尽管它显然可以（并且确实）使用的远不止这些。

简单地说，移植 JVM 的一部分包括移植 Swing 所需的核心图形功能。某些端口比其他端口更好地利用操作系统，但在高级 Swing 级别，您通常不会担心这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T00:56:13.357

不，如果你想在屏幕上绘图，你需要让操作系统为你做这件事。

如果您担心 Swing 的性能或臃肿，请查看 SWT。它的重量更轻，更接近于原生外观和感觉（因为它或多或少是围绕 OS GUI 的包装）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T00:56:04.637

最后，只有操作系统知道存在哪些图形硬件以及如何告诉它绘制 UI，而抽象层的数量无法改变这一点——也不应该：这正是拥有操作系统的初衷。

我想理论上您可以拥有某种帧缓冲设备并让 Swing 直接绘制到该设备上，但是 A）正如您所指出的，Swing 基于 AWT，而 AWT 不能那样工作，并且 B）它仍然是操作系统实现帧缓冲设备。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T13:23:03.553

您需要某种与显示器的接口。显然，您可以在内存中创建位图，而无需任何图形硬件。有许多网络显示协议，特别是 X Windows (X11) 和 VNC 使用的协议。您还可以让服务器通过小程序和 WebStart/JNLP 显示界面。我了解 Opera Mini 使用 midlet 来显示位图并将输入返回到在远程服务器上运行的 Web 浏览器（可能基于桌面 Opera）。IBM 很久以前就有一个远程 AWT（在 Swing、IIRC 之前）。

# c# - 使用实体框架多次连接到同一个表

> ID：467661
> 
> 赞同：1
> 
> 时间：2009-01-22T00:38:34.547
> 
> 标签：c#, asp.net, linq, entity-framework

如果我有一个表有两个外键字段到另一个表，IE

```
Table: User 
Field: FK_PrimaryItem_ID
Field: FK_SecondaryItem_ID

Table: Item 
Field: ItemID 
```

当我使用实体框架时，生成的对象变为：

User.Item 和 User.Item1

我无法区分他们两个。我可以映射回外键的名称，但这是一个困难的方法。我怎样才能找出哪个，Item1 或 Item 是哪个字段？

如果可能，我想让我的 EDMX 文件自动生成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T09:41:25.450

一旦我在设计图面上更改了导航属性的名称，我没有发现更新模型有任何问题。

通常，User.Item 将表示模型使用该外键到达的第一列，而 User.Item1 将表示第二列。

但正如我所说，我只是进入模型，并根据 Mapping Details 中列出的关联将 Navigation Properties 的名称更改为更可用的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T17:49:29.990

我在使用自引用键时遇到了同样的问题：

```
PageID
Parent_PageID  (refers to PageID) 
```

直到我将导航属性分别重命名为“父”和“子”。最困难的部分是弄清楚哪个是哪个，我通过注意 NavigationProperty 对象上的 Multiplicity 属性来做到这一点（父级为 0..1，子级为 *）

# jquery - WCF 上公开的 REST 服务未填充参数值

> ID：467668
> 
> 赞同：1
> 
> 时间：2009-01-22T00:40:13.483
> 
> 标签：jquery, ajax, rest, wcf

我有一个 WCF 服务，它将字符串值“名称”作为参数。这个服务接口是这样的……

```
[ServiceContract(Name = "ContactLookup", Namespace = "Search")]
public interface IAjaxResultSearcherService
{
    [OperationContract]
    [WebGet(RequestFormat = WebMessageFormat.Json)]
    Result[] SearchResultsWithNameLike(string name);
} 
```

该服务使用以下配置公开...

```
<system.serviceModel>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
    <behaviors>
        <serviceBehaviors>
            <behavior name="AjaxServiceBehavior">
                <serviceDebug
                       includeExceptionDetailInFaults="true" 
                       httpHelpPageEnabled="true"/>
                <serviceMetadata httpGetEnabled="true" httpGetUrl=""/>
                <serviceCredentials>
                    <serviceCertificate findValue="localhost" 
                                 storeLocation="LocalMachine" 
                                 storeName="My" x509FindType="FindBySubjectName"/>
                </serviceCredentials>
            </behavior>
        </serviceBehaviors>
        <endpointBehaviors>
            <behavior name="JsonBehavior">
                <enableWebScript/>
            </behavior>
        </endpointBehaviors>
    </behaviors>
    <services>
        <service name="HelloIndigo.AjaxResultSearcherService" 
                             behaviorConfiguration="AjaxServiceBehavior">
            <endpoint address="json"
                      binding="webHttpBinding"
                  behaviorConfiguration="JsonBehavior"
                      contract="Contract.IAjaxResultSearcherService" />
        </service>
    </services>
</system.serviceModel> 
```

我的 .svc 文件使用 WebScriptServiceHostFactory。这似乎有效，这意味着我可以从我的 jquery 客户端连接到服务，但即使我通过 ajax 调用设置了参数值，当消息到达服务实现时，参数值为 null。

我像这样通过jquery调用服务......

```
$.ajax({
    url: url,
    data: { "name":"test" },
    type: "GET",
    processData: false,
    contentType: "application/json",
    timeout: 10000,
    dataType: "text",
    success: function(res) {
        alert('function successful! returned: ' + res.toString());
    },
    error: function(xhr) {
        alert('an error occurred: ' + xhr.responseText);
    }
}); 
```

我没有从服务调用中得到任何错误，但是当我调试进程时，参数值为 null。为什么 WCF 不会像我期望的那样传递参数值？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T22:34:44.157

在我的试验中，我试图使用 JSON.org 的 JSON2 来“字符串化”我的 json 对象并将其作为数据对象传递给 ajax 调用，并将 processData 参数设置为 false。一旦我决定将数据元素保留为本机 JSON 对象并将 processData 设置为 true，我的参数值就会被填充。

我仍然不确定为什么 JSON2.js 的 stringify 没有使 data 参数有效，但至少这是有效的。

所以，以前我有以下内容：

```
var json = JSON.stringify({ "name":"test" });
$.ajax({
    url: url,
    data: json,
    type: "GET",
    processData: false,
    contentType: "application/json",
    timeout: 10000,
    dataType: "text",
    success: function(res) {
        alert('function successful! returned: ' + res.toString());
    },
    error: function(xhr) {
        alert('an error occurred: ' + xhr.responseText);
    }
}); 
```

工作版本，但是看起来像这样......

```
var json = { "name":"test" };
$.ajax({
    url: url,
    data: json,
    type: "GET",
    processData: true,
    contentType: "application/json",
    timeout: 10000,
    dataType: "text",
    success: function(res) {
        alert('function successful! returned: ' + res.toString());
    },
    error: function(xhr) {
        alert('an error occurred: ' + xhr.responseText);
    }
}); 
```

# linux - ubuntu 和虚拟 PC

> ID：467674
> 
> 赞同：2
> 
> 时间：2009-01-22T00:42:40.997
> 
> 标签：linux, virtualization, virtual-pc

有没有办法在 VPC 2007 中安装 ubuntu 7.04-8.04？我不能这样做，因为它只是变黑了。:-(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T00:46:15.030

我不能说 VPC，但我建议获取免费提供的 VMWare Player - 它可以很好地运行这两个版本的 Ubuntu（和 8.1）。您需要从网上下载一个小型 VMX（请参阅[EasyVMX](http://www.easyvmx.com/)），但这相当轻松。

我保留 VPC 的唯一原因是因为它是我所知道的唯一一个仍在运行 OS/2 的 :-)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T00:52:18.810

老实说，您可能永远不会喜欢 Virtual PC。（它的开发只考虑了各种版本的 Windows，根据我的经验，在它下运行任何 linux 发行版总是存在某种问题。）我会推荐 VMWare Player，如上所述，或者[VirtualBox](http://www.virtualbox.org/)，它运行得很好过去对我来说（它运行某些Linux发行版最好，虽然我不记得哪些）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T00:52:47.453

嗯...我在 Virtual PC 中安装了 7.10。

我不太记得了，但我想我也遇到了 7.04 的问题，所以我放弃了。7.10 发布后我回来了，它从 ISO 安装，没有出现重大问题（我记得）。

# vb6 - 需要使用存储在字符串 vb6 中的值来引用变量

> ID：467692
> 
> 赞同：0
> 
> 时间：2009-01-22T00:51:01.510
> 
> 标签：vb6, pass-by-reference

我正在使用 For 循环遍历一些代码。迭代变量是“i”。在 For 循环之前，我已经确定了以下变量的尺寸。L1、L2、L3、L4 作为字符串。我想通过某种方式引用“L”和char（i）来在For循环中引用这些字符串。因此，就像值“Foo”<>“L”和 Char(i) 的比较一样，结果应该是在 i=1 时针对存储在变量 L1 中的字符串测试“Foo”。或者当 i=2 时针对 L2 等等。

我以前的编程经验是 Visual FoxPro，我所要做的就是在字符串前面加上一个 & 前缀，然后它引用了名称存储在字符串中的变量。

因此，如果 L1 存储“Bar”，并且我想比较我可以写 &L1 == “Bar”。我需要能够用 VB6 做到这一点。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T00:58:11.310

我建议您创建一个数组，而不是创建 4 个变量。前任：

```
Dim L(1 To 4) As String

For i = 1 to 4
    L(i) = "Whatever"
Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T00:57:21.343

你真正想要的是一个数组，像这样：

```
Dim L(3) As String  ''// index begins at 0, 4 total elements

For Each i As String In L
    If "Foo" <> i Then
        ''// ...
    End If
Next i 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T08:47:12.877

这适用于类（例如 VB 表单）：

```
Option Explicit

Public L1 As String
Public L2 As String
Public L3 As String
Public L4 As String

Sub Main()

  L1 = "Foo"
  L2 = "Bar"
  L3 = "Go"
  L4 = "Figure"

  Dim i As Long
  For i = 1 To 4
    Debug.Print CallByName(Me, "L" & CStr(i), VbGet)
  Next

End Sub 
```

# php - PHP：尝试连接到内存缓存服务器，但得到“权限错误 (13)”

> ID：467703
> 
> 赞同：0
> 
> 时间：2009-01-22T00:54:32.097
> 
> 标签：php, memcached

当我尝试连接到我的 memcache 服务器时，我的 PHP 错误日志中出现“... Permission Error (13) ...”。我可以通过 telnet 连接，甚至得到响应，但无法通过 PHP 连接。

该脚本在从命令行运行时有效，但在通过 Apache 运行时会失败。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T01:07:39.590

这很像 SELinux 或防火墙的问题。

[http://www.linuxforums.org/forum/redhat-fedora-linux-help/46840-fsockopen-error-13-permission-denied.html](http://www.linuxforums.org/forum/redhat-fedora-linux-help/46840-fsockopen-error-13-permission-denied.html)

# hibernate - 休眠每日构建

> ID：467704
> 
> 赞同：1
> 
> 时间：2009-01-22T00:55:58.210
> 
> 标签：hibernate, jpa

我可以下载 Hibernate 的每日版本吗？我需要最新版本来[修复](http://opensource.atlassian.com/projects/hibernate/browse/HHH-3636)不在已发布版本中的错误。我目前正在尝试构建最新版本，但遇到各种测试用例失败。如果有我只是下载和使用的每日构建，如果会更快。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T01:02:39.850

如果有测试用例失败，我会说你可能不想要每晚构建。谁知道它还会有什么问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T01:03:33.437

当然。只需使用主站点下载页面中的源代码控制存储库：[http ://www.hibernate.org/6.html#A4](http://www.hibernate.org/6.html#A4)

# ide - Develop for PlayStation 3 Linux

> ID：467711
> 
> 赞同：13
> 
> 时间：2009-01-22T00:57:41.687
> 
> 标签：ide, sdk, playstation, ps3

I'm interested in developing software for [Sony PlayStation 3](http://en.wikipedia.org/wiki/PlayStation_3) consoles which contains a **multi-core Cell processor**, targeting any [PS3-compatible Linux](http://en.wikipedia.org/wiki/Linux_for_PlayStation_3) distribution.

> *"A single PS3 performs **better** than the highest-end desktops available and compares to as many as **25 nodes** of an IBM Blue Gene **supercomputer**."* ~ [PlayStation3 Gravity Grid](http://gravity.phy.umassd.edu/ps3.html)

Most importantly:

1.  **CPU** - Any Linux OS [has access to 6](http://www.ps3source.net/content/view/17/33/) of the 7 [Synergistic Processing Elements](http://en.wikipedia.org/wiki/Cell_(microprocessor)#Synergistic_Processing_Elements_.28SPE.29)
2.  **GPU** - Sony implements a hypervisor restricting access to the [RSX](http://en.wikipedia.org/wiki/RSX_%27Reality_Synthesizer%27)
3.  **Parallel** - IBM provides an [introduction to programming parallel applications](http://www.ibm.com/developerworks/power/library/pa-linuxps3-1/index.html) on the PS3

So to get started:

1.  Install [Linux on the PS3](http://en.wikipedia.org/wiki/Linux_for_PlayStation_3):
    *   For **[YDL Linux](http://www.terrasoftsolutions.com/products/ydl/)** - installation guide [here](http://www.terrasoftsolutions.com/support/installation/ydl6.0_ps3_guide.pdf)
    *   For **[Fedora 8](http://fedoraproject.org/)** - installation guide [here](http://www.gnuradio.org/trac/wiki/PS3FC8Install) and [here](http://www.bohmer.net/ps3_stuff/install-fedora-8-on-PS3.html).
    *   For **[Ubuntu 8](http://www.ubuntu.com/)** - compiling and installation guide [here](http://psubuntu.com/wiki/IntrepidReleaseNotes).
    *   For **[OpenSUSE](http://www.opensuse.org/)**- any guides?
    *   For **[Debian](http://www.debian.org/)** - any guides?
2.  Get an IDE with a compiler suitable for that Linux. *..(help!)*
    *   **C++ IDE**: [KDevelop](http://www.kdevelop.org/), [Eclipse CDT](http://www.eclipse.org/cdt/), [Code::Blocks](http://www.codeblocks.org/)
    *   [**GCC 4.3**](http://gcc.gnu.org/) with [Binutils 4.1](http://www.gnu.org/software/binutils/)
    *   **IBM XL** for the Cell - available as part of [IBM's Cell SDK](http://www.ibm.com/developerworks/power/cell/)
    *   [**OpenMPI**](http://openmpi.org/) for PowerPC Linux *..(what?)*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T01:22:00.903

You might also try Ubuntu 8.10 (Intrepid Ibex). Their PS3 support is pretty good, and instructions for installation and a rough primer on compilation can be found [here](http://psubuntu.com/wiki/IntrepidReleaseNotes). GCC 4.3 and binutils 4.18 include targets for the Cell PPU (a generic PowerPC target) and SPUs, and there are packages available in the Ubuntu repositories (e.g. spu-gcc, spu-g++, spu-binutils, ppu-gdb, spu-newlib, etc) which will compile binaries for you.

As far as a proper IDE, the above utilities should integrate fine with about any IDE (i.e. KDevelop, Eclipse CDT, Code::Blocks), so long as you can find syntax highlighting files (available for most popular IDEs). The Cell SDK is available as well, and could potentially provide better integration, and packages are available for RHEL 5.2 and Fedora 9 (should be able to use *alien* to pull these into Debian/Ubuntu, but not sure on that).

OpenMPI is a fine idea, they've been able to compile it for Cell-based blades ([here](http://www.open-mpi.de/faq/?category=building#build-qs22)) so I don't think it should be an issue. You could also roll your own message passing, as low overhead is key in extracting good performance on the Cell (though I don't know how well-suited OpenMPI is for this, it could be great).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T00:33:50.367

Matthew Scarpino's book, **Programming the Cell Processor**, is pretty up to date and has a lot of good information. Also, the [website for the book](http://www.informit.com/authors/bio.aspx?a=75896942-4A52-45AE-82BD-2D3C34691117) has a lot of example code available for download.

There was also an [MIT course](http://www.cag.csail.mit.edu/ps3/) on parallel programming via the Cell processor that has some good info, although some of it is out of date, namely, it uses the old cell mechanics where libspe provided its own threads. With the newest version of the library, you will need to get your threads from elsewhere (pthreads, boost, whatever) in order to run parallel programs.

As for OS and compiler, I've been using Yellow Dog Linux 6.1\. YDL has worked out pretty well so far, much better than Fedora 9 anyway, although that is likely a result of the fact that YDL comes with a super-lightweight window manager and Fedora 9 doesn't. I had a few problems with networking, but those are most likely a product of the slightly bizarre network environment that I have the system set up in.

Once I had YDL up and running, I then installed the cell sdk fedora packages on top of (this takes a little bit of work, as the cellsdk install script falsely recognizes YDL as RHEL, not Fedora). YDL does have most of the SDK available in one of their package repos, but by default not much of it is installed, just the compilers (of course, I didn't figure this out until I had already hacked the IBM installer to do the right thing). I'm just using the basic IBM compilers (not the XL stuff).

There is also a ton of information scattered around the [IBM site](http://www.ibm.com/developerworks/power/cell/), but it can be a bit hard to make sense of.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-26T23:41:34.847

You may want to try [Offload C++](http://offload.codeplay.com/) from Codeplay Software. It provides an extended dialect of C++ easing development of software on multicore hardware like the Cell processor.

A cross compiler toolchain allows compilation of code for the PS3 on Windows, which can be useful given the resource constraints (e.g. system memory) on a PS3 console running Linux, which can impact compile times and make the use of a PS3 as a desktop awkward.

Versions of the Offload C++ compiler and tools are available targeting the PS3 GameOS and Linux on Cell with the Cell BE SDK. The Cell Linux version integrates with the Eclipse CDT for an IDE.

Disclaimer: I am a developer at Codeplay.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-24T19:32:44.880

Be mindful when running code on the SPEs of their special design -- the default stack size varies widely from compiler to compiler, and can cause all sorts of issues when you overflow. It's usually a good practice to declare most data globally in SPE code, and avoid the stack except for very small variable allocations.

Since there's no cache (or... its all L2 cache, in a sense), there's no real performance penalty to doing this, and you'll never run into problems like trying to DMA data to or from a memory address that is no longer valid, etc.

The IBM SPE compiler is generally considered the best, afaik, although I have never used it, personally.

# c# - 平台生成器和 C#

> ID：467712
> 
> 赞同：1
> 
> 时间：2009-01-22T00:58:04.227
> 
> 标签：c#, command-line, windows-ce, platform-builder

Platform Builder 是一种用于在您的计算机上构建 Windows CE 操作系统，然后将其加载到 Windows CE 设备上的工具。

所有这些都是通过 Platform Builder 完成的。我通过 Microsoft Visual Stuido 开发环境 (IDE) 完成这一切。

我想自动化使用 Platform Builder 的过程。到目前为止，我只知道如何通过 IDE 使用 Platform Builder。我想通过另一个用 C# 编写的程序来使用 Platform Builder。

实现此目标的另一种方法是学习如何从命令行使用 Platform Builder。如果可以通过命令行完成，那么也可以通过 C# 程序完成。我在这里和那里看到一些链接说您可以从命令行构建平台构建器，但到目前为止，它们并不是那么好。

有小费吗？

此链接： http: [//msdn.microsoft.com/en-us/library/ms924536.aspx](http://msdn.microsoft.com/en-us/library/ms924536.aspx) 谈论“如何使用命令行创建、自定义和构建运行时映像”，但它有关于创建的链接需要使用 IDE 的ai 操作系统设计 ( [http://msdn.microsoft.com/en-us/library/aa448498.aspx )。](http://msdn.microsoft.com/en-us/library/aa448498.aspx)

很高兴找到有关此主题的良好链接。如果我可以使用 IDE 做我需要做的事情，我应该能够从命令行做我需要做的事情。如果我可以从命令行执行我需要执行的操作，那么我应该能够从 C# 程序执行我需要执行的操作。那是我的目标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T01:19:38.973

[命令行工具](http://msdn.microsoft.com/en-us/library/ms938334.aspx)包含所有 Platform Builder 命令行命令的完整列表。

注意：“IDE 和命令行环境是相互独立的”。

另外，您需要使用“开始”/“所有程序”/...下的Visual Studio命令行，否则环境会出错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T18:37:04.777

此链接提到了设置 Windows CE 构建环境的 Windows CE 构建环境工具 (Wince.bat)。 [http://msdn.microsoft.com/en-us/library/ms938334.aspx](http://msdn.microsoft.com/en-us/library/ms938334.aspx)

此链接描述了如何使用 Windows CD 构建环境工具：http: [//msdn.microsoft.com/en-us/library/ms930978.aspx](http://msdn.microsoft.com/en-us/library/ms930978.aspx)

基本上，当您使用 wince.bat 时，您会传递三个参数：CPU；项目和平台。我已经弄清楚了为 CPU 和平台输入的内容。但是“PROJECT”用什么让我有点困惑。似乎对于这个参数，你可以给它任何你想要的项目名称。这不起作用。所以我尝试了一些现有项目文件夹的名称。这也不起作用。所以现在我想我应该在调用 wince.bat 之前定义一个项目名称。我该怎么做呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-10T23:27:23.833

不是您问题的真正答案，但您可能想查看并关注[Bruce Eitman 的](http://geekswithblogs.net/BruceEitman/Default.aspx)博客，因为他涵盖了 Platform Builder 问题和解决方案。

# javascript - 是否可以获得 json 文件的“模式”？

> ID：467715
> 
> 赞同：0
> 
> 时间：2009-01-22T00:58:22.573
> 
> 标签：javascript, json

所以，我有一个 json 文件，我想使用 javascript 获取文件中所有字段的名称。除了使用 eval 然后对结果对象使用反射之外，还有更好的方法吗？或者这没有任何意义？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T01:05:45.007

您应该执行某些框架使用的操作，例如：

[http://www.prototypejs.org/api/string/evalJSON](http://www.prototypejs.org/api/string/evalJSON)

它检查 JSON 是否已清理。但除此之外，它最后只是使用旧的普通 eval()。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T01:01:12.677

除非您想以某种方式解析文本，否则我建议最简单的方法是评估它并通过循环来获取所有字段名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T05:45:17.813

注意，有一个[JSON Schema](http://www.json.com/json-schema-proposal/)的提议，在 JSON 中定义。他们甚至在 Google 代码上有一个[验证器](http://jsonschema.googlecode.com/files/jsonschema-b2.js)，所以你现在可能会发现它的用途。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T01:02:10.583

好吧，由于嵌套等原因，它会变得很棘手。这取决于你的结构。并且 javascript 的“反射”没有任何性能影响，所以请随意浏览对象的成员。或者您可以根据 JSON 规范推出自己的解析器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T06:14:13.903

JSON 文件并不需要遵循一致的模式。可能有参差不齐的行；元素的顺序可以跨行变化；任何行都可以有任何元素（或没有元素）。全部采用分层节点方式。因此，通过临时检查（反射）提出你想要的东西可能是相当冒险的。

并不是说参与使用 JSON 格式的任何一方都无法提出更多的结构性要求，但是您可以从架构开始。

# sql-server-2005 - SQL Server Reporting Services 2005 许可

> ID：467717
> 
> 赞同：2
> 
> 时间：2009-01-22T00:58:44.820
> 
> 标签：sql-server-2005, reporting-services, licensing

在 Reporting Services 2005 中使用订阅是否需要特殊许可？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T01:11:59.410

订阅（通过电子邮件）免费包含在 SSRS 中，但是每个查看报告的客户都必须有一个 SQL 校准，除非你有 CPU 版本。如果您只打算通过 HTML（网页）提供报告，而跟踪用户数量几乎是不可能的，那么报告需要 CPU 许可证。

[这是微软的 SSRS 许可方案](http://www.microsoft.com/sqlserver/2005/en/us/Special-Considerations.aspx)

# python - 在 Python 中实现“规则引擎”

> ID：467738
> 
> 赞同：23
> 
> 时间：2009-01-22T01:11:24.653
> 
> 标签：python, parsing, rules

我正在用 Python 编写一个日志收集/分析应用程序，我需要编写一个“规则引擎”来匹配和处理日志消息。

它需要具有：

*   消息本身的正则表达式匹配
*   消息严重性/优先级的算术比较
*   布尔运算符

我设想一个示例规则可能是这样的：

```
(message ~ "program\\[\d+\\]: message" and severity >= high) or (severity >= critical) 
```

我正在考虑使用[PyParsing](http://pyparsing.wikispaces.com/)或类似方法来实际解析规则并构造解析树。

我想到的当前（尚未实现）设计是为每种规则类型设置类，并根据解析树构造并将它们链接在一起。然后每个规则将有一个“匹配”方法，该方法可以返回一个消息对象，无论它是否匹配规则。

很快，类似：

```
class RegexRule(Rule):
    def __init__(self, regex):
         self.regex = regex

    def match(self, message):
         return self.regex.match(message.contents)

class SeverityRule(Rule):
    def __init__(self, operator, severity):
         self.operator = operator

    def match(self, message):
         if operator == ">=":
             return message.severity >= severity
         # more conditions here...

class BooleanAndRule(Rule):
    def __init__(self, rule1, rule2):
         self.rule1 = rule1
         self.rule2 = rule2

    def match(self, message):
          return self.rule1.match(message) and self.rule2.match(message) 
```

然后，这些规则类将根据消息的解析树链接在一起，并在顶部规则上调用 match() 方法，该方法将向下级联，直到所有规则都被评估。

我只是想知道这是否是一种合理的方法，或者我的设计和想法是否完全不合时宜？不幸的是，我从来没有机会在大学学习编译器设计课程或类似的课程，所以我几乎是自己想出了这些东西。

在这些事情上有一些经验的人可以插话并评估这个想法吗？

**编辑：** 到目前为止有一些很好的答案，这里有一些澄清。

该程序的目的是从网络上的服务器收集日志消息并将它们存储在数据库中。除了收集日志消息外，收集器还将定义一组规则，这些规则将根据条件匹配或忽略消息，并在必要时标记警报。

我看不到规则的复杂性超过中等，它们将被应用在一个链（列表）中，直到匹配的警报或忽略规则被命中。但是，这部分与问题不太相关。

就语法接近 Python 语法而言，是的，这是真的，但是我认为很难将 Python 过滤到用户不会无意中使用不希望的规则做一些疯狂的事情的程度。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-01-22T11:22:15.387

不要发明另一种规则语言。

要么使用 Python，要么使用其他现有的、已经调试过的工作语言，如 BPEL。

只需用 Python 编写规则，导入并执行它们。生活更简单，更容易调试，而且您实际上已经解决了实际的日志读取问题，而不会产生另一个问题。

想象一下这个场景。你的程序中断了。现在是规则解析、规则执行或规则本身。您必须调试所有三个。如果你用 Python 编写规则，那就是规则，就是这样。

“我认为很难将 Python 过滤到用户不会无意中使用非预期的规则做一些疯狂的事情的程度。”

这主要是“我想编写一个编译器”的论点。

1）您是主要用户。您将编写、调试和维护规则。真的有一群疯狂的程序员会做疯狂的事情吗？真的吗？如果有任何潜在的疯狂用户，*请与他们交谈*。教他们。不要通过发明一种新语言来对抗它们（然后你将不得不永远维护和调试它。）

2）这只是日志处理。*这种疯狂*并没有真正的代价。没有人会用错误的日志处理来颠覆世界经济体系。不要将几十行 Python 的小任务放到一个 1000 行的解释器上来解释一些规则语言的几十行。只需编写几十行 Python。

只需尽可能快速清晰地用 Python 编写它，然后继续下一个项目。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-12-18T01:07:25.163

您可能还想查看[PyKE](http://pyke.sourceforge.net/logic_programming/index.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T01:20:11.563

与 Python 语法本身唯一不同的地方就是该`message ~ "program\\[\d+\\]: message"`部分，所以我想知道您是否真的需要一种新语法。

**更新：**好的，你有可用性或安全问题——这是合理的。几个建议：

*   从 Awk 中获取提示并简化模式匹配语法，例如，`/program\[\d+\]: message/`而不是`message ~ "program\\[\d+\\]: message"`.

*   我将通过在解析输入时转换为 Python 表达式来实现它，而不是构建要评估的对象树，除非您希望对这些事情执行比评估更多的操作。这应该需要更少的代码并且运行得更快。顶层可能类似于：

    ```
    def compile(input):
        return eval('lambda message, severity: %s' % parse(input)) 
    ```

另一个更远的想法：用 Lua 编写你的应用程序。它是为非程序员设计的，可以安全地合理扩展程序，而无需学习很多东西。（我被告知，它已经成功地使用了这种方式，并且您可以进行沙箱评估，因此用户的代码无法获得您没有明确传递给它的任何功能。）

我现在就闭嘴。：-） 祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T02:56:07.360

在不知道应用程序范围的情况下回答这个问题有点困难。

*   你想推理什么？
*   你说的是什么级别的分析？
*   您认为规则变得多么复杂？
*   不同规则之间的相互作用有多复杂？

一方面是您提出的一种简单的一次性方法。如果规则很少，相对简单，并且您没有做任何比聚合与指定规则匹配的日志消息更复杂的事情，这很好。

另一方面是重量级的推理系统，例如具有[Python 接口的](http://pyclips.sourceforge.net/web/)[CLIPS](http://en.wikipedia.org/wiki/CLIPS)。这是一个具有推理功能的真正规则引擎，并提供进行复杂推理的能力。如果您正在构建类似诊断引擎的东西，它可以根据程序日志运行，这可能更合适。

**编辑：**

我会说当前的实现思路很适合你正在做的事情。还有更多，我认为您可能会冒过度设计解决方案的风险。它似乎捕获了您想要的内容，仅根据几个不同的标准匹配日志消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-03T22:02:12.617

您可能还想看看[pyDMNrules](https://pypi.org/project/pyDMNrules/)。它从决策模型表示法 (DMN) 规则表构建规则引擎。

# vim - 如何让 vim 在不插入换行符的情况下显示换行？

> ID：467739
> 
> 赞同：16
> 
> 时间：2009-01-22T01:11:33.513
> 
> 标签：vim, word-wrap

由于一个计划外的 MacBook 母板崩溃（我的紧急备份 Linux 机器无法运行 TextMate），我正在与我的内部 (g)vim 重新取得联系。总而言之，我对 vim 的效率和功能感到满意，但我对获得那种即使是愚蠢的 HTML 文本区域也毫不费力就能实现的自动换行感到羞愧。

考虑文本

```
Etiam ornare mollis 侵权。暂停 sed neque。纳拉姆在精英。暨社会空虚。
```

默认情况下，使用 80 个字符宽度的 vim 将其显示为

```
Etiam ornare mollis 侵权。暂停 sed neque。纳拉姆在精英。暨社会 nu
拉姆。
```

这种包装不关心空格，所以有时它只是将单词切成碎片（在这种情况下为 nullam）。当然，你可以打开自动换行，得到这个：

```
Etiam ornare mollis 侵权。暂停 sed neque。纳拉姆在精英。暨社会
努拉姆。
```

问题是 vim 在*换行符*处插入了一个换行符，这是我最*不*想要的。换句话说，我希望文本在打开自动换行的情况下完全显示为 vim 显示的内容，但不插入换行符。（通过这种方式，它可以粘贴到 HTML 文本区域和电子邮件程序等其他地方。）

尽管付出了辛勤的努力，但网络搜索却毫无用处；我希望 StackOverflow 能在我的 Google-fu 失败的地方取得成功。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-22T01:21:41.607

要打开自动换行：

```
:set wrap
:set linebreak 
```

复制和粘贴原始文本而不是任何填充适用于 gvim。但是，对于 xterm 中的 vim，它会在 EOL 处复制空格填充（尽管不是换行符）。我认为这应该有效，但它没有：

```
:set mouse=a 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-09-21T05:46:19.567

我发现[这](http://contsys.tumblr.com/post/491802835/vim-soft-word-wrap)很有帮助 - 就像一个魅力。

基本上我只是在我的 vimrc 中添加了这些行

```
" not to break on words
set formatoptions=1
set linebreak

" fixing up moving line by line in the paragraph
nnoremap j gj
nnoremap k gk
vnoremap j gj
vnoremap k gk 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-22T01:41:03.907

如果 vim 正在添加换行符（不仅仅是换行），那么你可能打开了 textwidth ...

```
:set textwidth=0 
```

# c# - 范围的集合

> ID：467746
> 
> 赞同：1
> 
> 时间：2009-01-22T01:16:49.523
> 
> 标签：c#, range, collections

想象一个场景，使用 xml，用户能够以灵活的方式指定范围，使用“gte”、“gt”、“lte”、“lt”或“eq”的任意组合。

这里有些例子

```
<rangeElement gte="0" lt="5" ... />
<rangeElement gt="3" lte="7" ... />
<rangeElement eq="5" ... />
<rangeElement gt="10.5" ... /> 
```

现在我需要两个可以处理这些的类，Range 和 RangeCollection。

Range 类可能看起来像这样：

```
public class Range
{
   public LowerBoundInclusive { get; set; }
   public LowerBoundExclusive { get; set; }
   public UpperBoundInclusive { get; set; }
   public UpperBoundExclusive { get; set; }
   public object Data { get; set; }

   public Range(XElement xmlElement)
   {
      ....
   }
} 
```

RangeCollection 类应该有一些对其范围进行排序、检测重叠并返回给定值的相应范围的基本方法。

我玩过这个，但事情很快变得非常复杂。有没有其他人看到过这个的实现，或者想试一试？

顺便提一句。我知道有类似的线程可以处理范围，但它们没有充分处理“小于或等于”和“小于”之间的区别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T01:26:28.197

你需要的是[区间树](http://en.wikipedia.org/wiki/Interval_tree)。[在 C# 中找到实现](http://www.koders.com/csharp/fidAECCF1ACC07C26A4B6836EE7DF8C4EB0F19129C8.aspx?s=mdef%3Acompute)并对其进行修改以使其适合您的需求并不难。我认为“<=”或“<”关系没有任何问题。

# java - 通过随机访问在网络上流式传输文件 - java

> ID：467761
> 
> 赞同：0
> 
> 时间：2009-01-22T01:27:16.587
> 
> 标签：java, sockets, stream, seek

因此，我需要在 java 客户端应用程序中从网络上的服务器播放音乐文件。我在想套接字 - 让服务器将音乐文件作为流打开，并让客户端连接到该文件并将其作为 InputStream 读取和播放。这会起作用 - 除了 AFAICS 用户将无法查找文件（他们目前可以查找本地文件），因为我看不到 Sockets 流如何支持它。

有更好的想法吗？或者有办法使用Sockets来寻求？

杰尼？我对此知之甚少，不知道它是否有帮助。

（完全蹩脚的）最后手段是使用映射的网络驱动器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T01:43:36.367

在您实现自己的协议之前，看看[Java Media Framework](http://java.sun.com/javase/technologies/desktop/media/jmf/)是值得的。它支持流式音频、视频等。如果您想要由人类编写的描述，[这里是 Wikipedia 条目。](http://en.wikipedia.org/wiki/Java_Media_Framework)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T01:37:45.257

您需要定义某种允许随机访问的协议。最简单的解决方案可能是使用 HTTP 及其“Range”标头，并以短片形式请求数据。

诸如[RTSP](http://en.wikipedia.org/wiki/Real_Time_Streaming_Protocol)之类的“真实”流协议要复杂得多，通常使用 UDP 而不是 TCP。

# c# - 根据以下标准开发桌面应用程序的语言/平台

> ID：467762
> 
> 赞同：6
> 
> 时间：2009-01-22T01:27:25.963
> 
> 标签：c#, java, .net, c++, desktop-application

面对您可以自由设计的新应用程序的挑战，组建一个团队来开发和管理：

1.  您会选择哪种语言/平台？
2.  为什么？

**背景：**桌面应用程序将控制硬件设备并执行计算、分析和显示它返回的数据。

**要求**：（重要性：10=最重要）

*   将需要使用 USB 和/或以太网与设备通信 (9)
*   拥有相关技能的工程师 (8)
*   高质量 IDE/工具的可用性 (8)
*   IDE/工具的成本 (7)
*   资源、教程、支持的可用性 (9)
*   语言/API/平台/框架的生命周期 - 即对该应用程序的投资将如何面向未来？...产品的生命周期*很长(10)*
*   跨平台 (3)
*   可用库的丰富性和广度 (9)
*   应用程序需要能够解释脚本语言 (6)
*   单元测试 (9)

**假设**：

*   对于设备的 USB 变体，设备驱动程序将使用 C/C++ 编写
*   申请将是一项全新的尝试——从头开始
*   现有工程师背景为C/C++，具有很强的OO能力。现有工程师愿意采用最好的语言/平台，并将招聘具有适当技能的新工程师。

**候选清单**（您可以添加到其中）：

*   Java/J2SE
*   C#/.NET
*   C++/wxWidgets
*   C++/QT
*   等等

期待听到你的想法！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-22T01:37:31.917

我的第一选择是 C++

1.  “语言的生命周期”......我认为 C/C++ 不会很快消失。
2.  支持与 USB/以太网/其他的低级通信
3.  您已经拥有团队中的知识/技能
4.  许多优质的库/IDE等可用

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-22T01:56:02.770

老实说，根据您的要求，出于以下原因，我会选择 Java（带有一小部分 C）。

*   `Lifetime of language/API/platform/framework- i.e., how future-proof will the investment in this application be?... the product has a long life-cycle (10).`这真的取决于你的意思是长。我真的无法想象 Java 会因为其*庞大的*安装基础而消失。C 或 C++ 也没有消失，但在考虑 C# 的未来时，我总是想到 VB6 到 VB.net 的迁移问题。

*   `Will need to communicate with devices using USB and/or ethernet (9).`虽然 Java 并不直接适用于此，但它有 JNI 来完成繁重的工作。您仍然需要一个 C 组件来执行此操作（并且它会针对每个平台进行更改，但最好将大部分代码编写一次 - 使用 C，您可能会针对每个平台更改*大部分*代码，并且对于 C#，它*真的*在 Windows 以外的平台上受支持吗？）。另一种选择是[JNA](https://github.com/twall/jna/)，它看起来像`"Python ctypes"`Java（访问共享库和 DLL，无需 JNI 接口层）。

*   `Availability of resources, tutorials, support (9).`所有语言在网络上都有巨大的资源横截面。

*   `Richness and breadth of libraries available (9).`你有 C++ 和跨平台 GUI 的 Boost，但它们是必须添加的东西 - 开发环境中没有内置任何东西，如 Eclipse/Java。

*   `Unit testing (9).`与以下工具的可用性相同的响应 - 有很多（免费）Eclipse 插件可以自动化单元测试。

*   `Availability of engineers with relevant skills (8).`你提到的所有语言都有大量（我喜欢使用这个词）能够完成这项工作的人。

*   `Availability of quality IDE/tools (8).`这是日食。在我看来，没有两种方法。它的插件数量确实是巨大的。NetBeans 可能看起来更好，但我宁愿拥有功能而不是外观（我的妻子也是，所以这很幸运 :-)。

*   `Cost of IDE/tools (7).`Eclipse 是免费的。

*   `The application will need to be able to interpret a scripting language (6).` 上次我听说，Java 现在包括内置的 JavaScript 以及开发人员[添加自己的脚本引擎](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/javase6/beta2.html)的能力。

*   `Cross-platform (3).`C#，不（尽管存在 Mono，但我仍然看到有一天它会与 MS 发生冲突的风险，而且由于它的 MS 协会，FOSS 世界不会有多少人会致力于它）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-22T01:57:46.773

为此，我将使用 C#，原因如下：

*   在语法方面与 C++ 最接近；
*   `unsafe`如果需要使用块直接访问内存；
*   开发成本低于任何 C++ UI 框架的现代 UI；
*   高技能可用性；
*   感谢 Microsoft 和其他人，提供几乎任何东西（包括 USB）的库；
*   Visual Studio 相对便宜；
*   预期寿命长：.Net 既相当成熟（7 年以上），也是“字节码平台”（主要包括 Java）中具有最佳长期前景的一个；
*   通过 DLL 轻松集成本机代码。Java/JNI（根据经验）就更尴尬了；和
*   单元测试框架。

老实说，我认为 C++ 桌面应用程序的时代已经过去了。它们太容易出错和昂贵（相比之下）开发。

C#/.Net 解决方案唯一缺少的是跨平台（尽管是 Mono）。我不知道这对您有多大影响，但您只将其列为 3。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-22T01:43:43.963

就个人而言，我会选择 C++ 或 C（[甚至可能是 D](http://digitalmars.com/d)）作为低级硬件接口，但是我会将该代码包装在一个漂亮、干净的 API 中，然后我会编写所有面向用户的带有 WPF 和 XAML 的 C# 中的 GUI 内容。

编写设备驱动程序所需的技能组将与 GUI 开发人员的技能组完全不同（尤其是如果您想提供丰富的图形图表和报告。所以无论如何您可能会有两个不同的团队（即使他们是非常小的团队），并且以不同（但兼容）的语言实现这两个层将提供一个很好的机制来强制这些层之间的关注点分离。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-22T02:39:38.033

如果我现在发布一些东西，C++/wxWidgets 会胜出。该组合非常便携，并且可以满足您的所有可用性和成本问题。

下月初，如果我没记错的话，Qt 将在 LGPL 许可下发布。我自己从未使用过它，但我听过几个人对它赞不绝口；许可证要求是唯一让我看不到它的东西。对于您的需求，它可能与 wxWidgets 一样好。

据我所知，这些都不处理脚本或单元测试。

我会考虑使用 Python 作为脚本语言。它作为其他程序的嵌入式脚本语言而享有盛誉。

我从来没有找到我喜欢的单元测试框架，所以我不能推荐一个。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-22T01:42:00.193

> *桌面应用程序将控制**硬件**设备*

C++

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-22T07:24:21.547

我看到这里有很多 C# 人，- C#: 在 Windows 以外的其他平台上运行不佳。所以这是个坏主意。忘了它。- Java：不适合设备驱动程序，并且仍然比 C 或 C++ 慢。Java 有一些不错的特性，但也有很多人对它有很高的评价。- VB：你为什么要使用它？

我可能会使用 C++/Qt，唯一的缺点是，如果 Qt 是商业产品，它会花钱，如果不是，它是免费的。您说您的团队已经有 C++ 经验，因此学习如何使用 Qt 应该不难。这在 Windows、Linux 和 mac 上都可以工作并且看起来非常好。Ide 不是 Qt 的问题，Trolltech 正在开发一个您可以使用的跨平台 ide，或者您可以使用 Visual Studio、eclips 或其他 C++ ide。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-22T01:33:51.910

我会投票给 C#。即使有从 C++ 迁移出来的学习曲线，您的开发人员也应该更有效率，并且工具和库也很棒。

我看到 C# 增加项目复杂性的唯一地方是与 USB 设备的接口，但是使用 P/Invoke 和 /C++/CLI 将 C/C++ 驱动程序公开给 .NET 相当容易。

# visual-c++ - IConnectionPoint::Advise 调用返回 E_NOTIMPL

> ID：467763
> 
> 赞同：0
> 
> 时间：2009-01-22T01:29:07.410
> 
> 标签：visual-c++, com

**注意**：

*   没有 MFC
*   无 ATL
*   使用 Visual C++

尝试在连接点和调用者的接收器之间建立连接时，返回了**E_NOTIMPL** (0x80004001)。

如下图所示：

```
hresult = pConnection->Advise(
                             pSinkUnk,
                             &dwAdvise); 
```

**问题**：

*   这是怎么发生的？

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-25T22:43:27.780

根据[MSDN](http://msdn.microsoft.com/en-us/library/ms694318(VS.85).aspx)，它声明只允许一个连接的连接点可以`E_NOTIMPL`从它的`EnumConnections()`方法返回。是否可能已经为此连接点建立了连接？也许在这种情况下这个特定的实现`E_NOTIMPL`也会返回`Advise()`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T04:01:51.440

在我看来，这听起来像是您想要事件的连接和/或对象没有实现您期望的事件接口。如果那是您的对象，也许可以验证您是否`QueryInterface()`为该接口返回了对象的实例？

# php - PHP 的 Twitter/PayPal 框架

> ID：467765
> 
> 赞同：0
> 
> 时间：2009-01-22T01:32:53.220
> 
> 标签：php, twitter, paypal

是否有任何框架可以让我将贝宝与推特集成，例如在收到商品付款后发送推文。我将使用 PHP 进行编程。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T01:35:11.017

[PayPal 有一个 API](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/howto_api_overview)，它可以提供您正在寻找的关于了解事件的内容。

至于 Twitter 方面，[Twitter API Wiki](http://apiwiki.twitter.com/)展示了几种在 Twitter 上发布消息的方法。

这只是将两者粘合并可能将其与您的系统集成的问题。

# ssis - 集成服务和隔离级别

> ID：467786
> 
> 赞同：2
> 
> 时间：2009-01-22T01:43:42.637
> 
> 标签：ssis, transactions, isolation

我们有一个数据仓库包，我们的客户在白天针对他们的实时交易系统运行。在大多数客户端上，这似乎工作正常，但在繁忙的客户端上，我们会遇到死锁错误。

默认情况下，SSIS 以 Serializable 隔离级别运行，这是 SQL 2005 上的最高隔离级别。

SSIS 包仅读取数据，但由于查询的大小和锁升级为页面锁，而其他进程正在更新/插入，因此会创建死锁。

客户端通常运行 SQL 2005 的标准版，因此这是我们可以使用的唯一功能。

有谁知道将包的 IsolationLevel 更改为 ReadCommitted（或其他 Isolation 级别）是否会解决这些锁定问题。如果它可以解决它们是否有任何副作用（幻读、不可重复读取等）

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T05:21:24.087

对已提交读和可重复读隔离级别以及它们可能产生的潜在问题进行了很好的讨论：

[http://blogs.msdn.com/craigfr/archive/2007/04/25/read-committed-isolation-level.aspx](http://blogs.msdn.com/craigfr/archive/2007/04/25/read-committed-isolation-level.aspx) [http://blogs.msdn.com/craigfr/archive/2007/05/09/repeatable -读取隔离级别.aspx](http://blogs.msdn.com/craigfr/archive/2007/05/09/repeatable-read-isolation-level.aspx)

它是否会影响您，取决于表架构和系统上运行的更新类型。

如果您只读取数据，最好的选择可能是快照隔离。SSIS 不支持它，但您可以避免 SSIS 事务并在 SQL 代码中发出 BEGIN TRANSACTION。

# .net - VB6 有什么好的 TDD 工具或资源吗？

> ID：467789
> 
> 赞同：12
> 
> 时间：2009-01-22T01:44:15.303
> 
> 标签：.net, unit-testing, vb6, tdd, richedit

是的，我知道我已经落后于时代，但我在这里得到的是一个古老的 VB6 编辑器应用程序，我相信没有人会很快升级到 .NET。它使用了几个第三方 DLL 工具，并且由于它仍在使用旧的 RichEdit 控件，因此我基本上可以仅使用这个工具来建立我自己的 Bug 农场。

足够了，我正在尝试看看我是否可以使用 TDD，这样我就可以开始为我需要修复的每个行为/功能编写单元测试，所以迟早我可以为这个工具提供一个完整的回归测试套件。即使将来我们升级到.NET，我认为我编写的大多数测试都应该有助于验证正确的行为，并且应该也可以升级到.NET 版本，我猜。

一些基本的谷歌搜索将我发送到这个工具调用[simpleVBunit](http://simplyvbunit.sourceforge.net/)，但我找不到足够的指南等来让我开始，是的，我对 VB6 也不是那么精通 :(

1.  那么有人知道我有什么好的工具/资源可以在这个 VB6 应用程序中使用 TDD 吗？[最好以后升级到 .NET，以防万一。]
2.  或者我实际上可以通过解决方法使用那些用于 .NET 的单元测试框架，即 NUnit 等？
3.  还是有更棒的方法来完成这项工作？

谢谢 ：）

## 编辑：

我试过弄乱vbunit，但我发现没有简单的方法可以将它添加到现有应用程序中，或者至少我不知道如何。因此，我发现它也可以使用[vb-lite-unit](http://sourceforge.net/projects/vb-lite-unit)和这个[comunit](http://comunit.sourceforge.net/?page=download.html)。另外，有人说我们可以将[NUnit 与 vb6 一起](http://integralpath.blogs.com/thinkingoutloud/2004/12/nunit_with_vb6.html)使用，但是这方面的资源更少。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T06:36:35.153

我使用 SimplyVBUnit 获得了非常流畅的 TDD 体验。我认为代码附带的示例非常不言自明。

您在启动时最初加载的表单包含该控件。然后在 Form_Load 子中你：

```
 AddTest New TestDifferentAsserts 
```

TestDifferentAsserts 是一个 vb 类。它看起来像这样：

```
Public Sub TestFloatCompareTolerance()
   ' we will use the default tolerance of 0.00001
   Assert.AreEqual 9#, 9.000001, "Should be equal!"

   ' The Expected value must be a Double or Single
   ' for the tolerance to be used in the comparison.
   Assert.AreEqual 9, 9.000001, "This will fail because we didn't use a float for the expected value."
End Sub 
```

事实上，明天我将在我的计算机上重新加载 vb6，以便使用 simplevbunit 在我的计算机上进行破解。

[添加编辑]

这是我在 VB6 中的项目资源管理器：

![项目浏览器](https://i.stack.imgur.com/RAOtC.png)

Form1 是 simplevbunit 控件所在的位置。

该项目的[源代码](http://www.box.net/shared/ycfp3jpea7)。

如果您有第三方控制，谁在乎。用门面包裹它们。然后从外观创建一个存根。

如果您需要进一步的帮助，请发表评论。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-22T01:50:46.430

[VBUnit](http://www.vbunit.com/)在 VB6 项目的前客户中为我工作得很好。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-22T10:44:03.093

我的情况是我们有一个巨大的 VB6 应用程序正在迁移到 .NET。迁移的版本是完全单元测试的。

我们采用的方法是通过 COM 互操作从 .NET 对 VB6 应用程序进行单元测试。到目前为止，我们发现的主要优势是 VB6 开发人员最终学习了 TDD（以及它所暗示的所有内容）：

*   方法：先测试，后编码..
*   架构：SoC、凝聚力、DRY、...
*   技术：测试和模拟框架、IoC 容器……

该解决方案极大地提高了迁移版本的代码质量，因为他们了解如何以使测试更容易的方式构建事物。此外，还有可能在 VB6 和 .NET 版本上使用相同的测试。

不确定此解决方案是否针对您的问题过度架构。您应该评估是否适用或适合您的情况。

问候。

# c++-cli - 您如何处理 C++/CLI 中的句柄？

> ID：467791
> 
> 赞同：2
> 
> 时间：2009-01-22T01:44:24.993
> 
> 标签：c++-cli

我知道我问的也不对。请帮助我更好地提出我的问题。

我有点难以将注意力集中在句柄上——在某些方面，它看起来像指针。但与指针不同，似乎我可以直接将值分配给句柄变量，它会影响底层数据值，而不是句柄本身。

测试代码清楚地表明，无论我使用句柄还是“取消引用”句柄来获取数据，我都会得到相同的值。显然，这不适用于非托管指针。我不明白什么？

```
#include <iostream>

int main()
{

  int ^y;
  int ^a, ^b, ^c;
  long x;

   y= gcnew int(100);
   a=y;
   b=y;
   c=y;

   c= gcnew int(200);
   b= 300;

   System::Console::WriteLine(y); // returns 100 (instead of something pointer-like)
   System::Console::WriteLine(*y); // also returns 100

   System::Console::WriteLine(a); // 100
   System::Console::WriteLine(b); // 300
   System::Console::WriteLine(c); // 200 

   x = static_cast<long>(y);
   *y = 10;

   System::Console::WriteLine(x); // 10
   System::Console::WriteLine(y); // 10
   System::Console::WriteLine(*y); // 10

  } 
```

编辑添加——我怀疑 WirteLine 可能已经为我完成了取消引用，但我预计静态转换不会长。这也与自动拆箱有关吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T03:02:02.760

C++/CLI 允许这种语法有点令人遗憾。int 类型是值类型，帽子用于引用类型。您的“y”变量不存储 int，它存储 System::Object。分配时编译器会自动生成装箱指令。Console::WriteLine() 显示一个装箱的 int 对象的值没有问题。

经验法则：当它是类对象时使用帽子，对于简单的值类型省略它。避免引用类型的堆栈语义（省略帽子，以便在作用域结束时自动调用析构函数），直到您真正理解值和引用类型之间的区别以及为什么 Dispose() 很重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T02:15:35.460

使用 WriteLine 的副作用。

只是'y'被视为'对象引用'并且可能被询问IFormattable，然后调用ToString（）。'*y' 正在传递一个 int。

要对此进行测试，请调用另一个函数 Foo(int ^) 并查看允许传入的内容，然后将其更改为 'Foo(int)'。

我认为您只是被 WriteLine 的“可变参数”性质所愚弄。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T02:18:19.870

不要依赖 WriteLine 告诉您 *y 和 y 是什么，从调试器中运行它并自己检查 *y 和 y 以查看差异。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T04:10:13.813

将值类型的句柄视为您可能自己编写的智能句柄，它具有用于转换的运算符重载。这样，使用可以提供 int 的句柄（通过转换运算符）以及取消引用句柄以获取对象中包含的 int 都可以。

关于 Writeline，我认为它就像隐式调用许多转换的流输出运算符。正如您可以安全地使用 cout << y，您可以编写 System::Console::WriteLine(y)。

# logic - 你如何帮助人们学习逻辑？

> ID：467792
> 
> 赞同：14
> 
> 时间：2009-01-22T01:46:28.607
> 
> 标签：logic

不是 IT 的人，更具体地说是程序员，没有解决问题的好方法。他们根本不像我们这些有良好[逻辑](http://en.wikipedia.org/wiki/Logic)的程序员那样思考。我被问过太多次了，我会推荐他们什么来改进他们的逻辑，这最终将有助于解决日常的专业问题。我想到的事情是很好的谜题，数学问题等。

话虽如此，你会推荐什么，为什么？书籍、网站、文章？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T03:02:10.547

[codinghorror.com](http://codinghorror.com)上的相关文章：

[将编程绵羊与非编程山羊分开](http://www.codinghorror.com/blog/archives/000635.html)

> 所有的编程教师都发现他们的结果呈现出“双峰”。就好像有两个群体：可以[编程] 和不能[编程] 的群体，每个群体都有自己独立的钟形曲线。几乎所有关于编程教与学的研究都集中在教学上：改变语言、改变应用领域、使用 IDE 和研究动机。**它都不起作用，双峰持续存在。**

从上面的摘录中快速得出结论：推测是，如果一个人一开始就不会编程，那么无论你做什么都是行不通的。

> 要编写一个计算机程序，你必须接受这一点，接受无论你想让程序表达什么意思，机器都会盲目地遵循它无意义的规则，得出一些无意义的结论。在测试中，一致性组表现出对这个事实的预先接受：他们能够从规则的角度看待数学计算问题，并且可以在任何可能导致的地方遵循这些规则。另一方面，不一致的组 **在它不存在的地方寻找意义**。空白组知道自己在看无意义，拒绝处理。

我提出的半开玩笑的解决方案：将它们转变为无神论/虚无主义。这样一来，他们就不会试图在不存在的地方寻找意义 [原文如此]，然后也许会与二进制达成协议。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T01:52:28.143

大多数不像极客那样思考的人也不想像极客一样思考。

但是解决问题的一部分是将其分解成更小的部分，每个部分都是一个容易解决的问题。如果他们能够学习如何将问题分解为可管理的部分，那么他们至少会在解决类似极客的问题的某些部分方面做得很好。

至于逻辑，请提醒他们不矛盾定律：A != !A。一个事物不可能同时是真的和假的。我们花费了太多时间，甚至没有努力思考。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-26T02:56:16.377

I had flunked first semester programming about 3 times,then I tried an online course employing "programmed" learning methods in desperation.

It helped me get over the "hump" by helping me understand programming (I believe) by providing the context and motivations for some of the more common (really simple to you folks) programming logic constructs.

Hours of practice "running" toy programs on paper for different problems afterwards finally ended my absolute confusion on this subject matter.

The link to the free, CS intro course employing this programmed approach that I had used (while ditching my regular lecturer) is :

[http://chortle.ccsu.edu/CS151/cs151java.html](http://chortle.ccsu.edu/CS151/cs151java.html)

Still stumped though by exam level problems using stacks and queues and recursion (we used C in our courses but I think it didn't really matter in the final analysis).

In the end, I didn't bother with a CS major as I would have taken forever (probably 2 to 3 yrs more) given my skill level.

I should have paid attention to those puzzle books when I was little. I was more of a LEGO geek then :)

CS instructors (those who only talk and talk) need to be a little more patient, some of us folks aren't good verbal learners.

Parting thought, we all can't be be great writers, but that doesn't stop one from learning (or teaching one) how to write well. I think the same goes for computer programming in the information age.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T01:51:16.570

我向大多数非程序员推荐数独和像[Brain Age这样的游戏。](http://www.brainage.com/launch/what.jsp)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T03:28:03.487

人们总是可以通过实践来提高他们解决问题的能力，但（imo）只是在一定程度上。有些人永远不会那样想。他们只是从出生就不是这样的。我不认为我们对我们与生俱来的潜力有很多控制权，只是我们用它做什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T01:55:05.050

我发现，如果你一直在思考并且总是试图以一种整洁、有趣、优化、巨大、小型、​​几乎任何方式来解决谜题，即使是愚蠢的小孩，那么你就会让自己保持敏锐。还阅读其他解决方案有助于指出您不会想到的事情，从长远来看，这些事情会为您提供可以应用于类似甚至不同情况的方法的“工具箱”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T03:54:54.260

我怀疑这种接线是遗传的，它更有可能在童年时期在大脑上留下社会印记。有些孩子会做谜题，有些孩子不会，那些做很多谜题的孩子会准备得更好，但正如蜥蜴比尔提到的，我认为任何人都可以重新训练他们的大脑来解决抽象的谜题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-06T19:19:26.460

我不太擅长逻辑，我曾经记得我遇到了一个问题，我想从数组中删除一些东西，有人来告诉我*“你为什么不创建一个新的但不包括你想要删除的项目？ "* . 我真的很惭愧，我的意思是，这个解决方案是完美的，毕竟，每种方法都需要迭代每个元素，为什么不简单地这样做并将这些复制到一个新数组中，但排除不需要的数组呢？

但回到这个问题，我推荐的一些事情是：

*   **下国际象棋**（这对你的生活很有帮助，如果你经常下棋，你会自动开始考虑不同问题的不同替代方案，并将它们减少到最好的方案）
*   **解数独**（这对演绎技巧很有好处）

另一个*真正*提高我的逻辑能力的练习是设置一个简单的编程任务，然后尝试用 3-5 种不同的方式解决它。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-12-09T23:14:38.850

这是我在网上找到的最好的逻辑谬误网站之一。

[逻辑谬误](http://www.nizkor.org/features/fallacies/)

我会向任何对语言的随意性感兴趣的人推荐这个网站。网站上每种逻辑谬误的例子大部分都非常好，我保证你会学到一些东西。一起转发。

核磁共振

# php - 如何在 PHP 中将 PDF 文档转换为预览图像？

> ID：467793
> 
> 赞同：213
> 
> 时间：2009-01-22T01:47:25.610
> 
> 标签：php, image, pdf, lamp

将 PDF 文档的一部分呈现为图像文件需要哪些库、扩展等？

我发现的大多数 PHP PDF 库都以创建 PDF 文档为中心，但是有没有一种简单的方法可以将文档呈现为适合 Web 使用的图像格式？

我们的环境是一个 LAMP 堆栈。

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2009-01-22T01:57:08.460

你需要[`ImageMagick`](http://us3.php.net/imagick)并且[`GhostScript`](https://www.ghostscript.com/download.html)

```
<?php
$im = new imagick('file.pdf[0]');
$im->setImageFormat('jpg');
header('Content-Type: image/jpeg');
echo $im;
?> 
```

`[0]`手段`page 1`。_

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2011-03-07T15:10:52.023

对于那些出于某种原因没有 ImageMagick 的人，GD 函数也可以与 GhostScript 一起使用。运行 ghostscript 命令`exec()`将 PDF 转换为 JPG，并使用`imagecreatefromjpeg()`.

运行 ghostscript 命令：

```
exec('gs -dSAFER -dBATCH -sDEVICE=jpeg -dTextAlphaBits=4 -dGraphicsAlphaBits=4 -r300 -sOutputFile=whatever.jpg input.pdf') 
```

要进行操作，请创建一个新的占位符图像，`$newimage = imagecreatetruecolor(...)`然后引入当前图像。`$image = imagecreatefromjpeg('whatever.jpg')`，然后您可以使用`imagecopyresampled()`来更改大小，或任何数量的其他内置非`imagemagick`命令

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-01-24T08:25:37.363

您还可以使用获取页数

```
$im->getNumberImages(); 
```

然后，您可以使用循环创建所有页面的缩略图，例如。

```
'file.pdf['.$x.']' 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2014-11-17T18:57:21.237

使用 php 扩展[Imagick](http://php.net/imagick)。要控制光栅输出图像的所需大小，请使用[setResolution 函数](http://php.net/manual/en/imagick.setresolution.php)

```
<?php    
$im = new Imagick();
$im->setResolution(300, 300);     //set the resolution of the resulting jpg
$im->readImage('file.pdf[0]');    //[0] for the first page
$im->setImageFormat('jpg');
header('Content-Type: image/jpeg');
echo $im;
?> 
```

（Paolo Bergantino 他的回答和 Luis Melgratti 他的评论的扩展。您需要在加载图像之前设置分辨率。）

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2011-06-14T04:23:33.727

如果您从 blob 加载 PDF，这是获取第一页而不是最后一页的方式：

```
$im->readimageblob($blob);
$im->setiteratorindex(0); 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-05-17T13:17:10.063

您还可以尝试执行 imagemagick 附带的“转换”实用程序。

```
exec("convert pdf_doc.pdf image.jpg");
echo 'image-0.jpg'; 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-08-22T03:03:47.713

我是[PDFlib](https://github.com/imalhasaranga/PDFLib)的作者，它是 php 的[GhostScript](http://sourceforge.net/projects/ghostscript/) 包装器，使用这个库的好处是，它已经过测试并且不需要`ImageMagic`

总是`GhostScript`命令比 pdf 更快`ImageMagic`，因此您应该选择 GhostScript 包装器或纯 GhostScript 命令

```
$pdflib = new ImalH\PDFLib\PDFLib();
$pdflib->setPdfPath($pdf_file_path);
$pdflib->setOutputPath($folder_path_for_images);
$pdflib->convert(); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-03-29T17:58:36.457

换个思路，您可以使用以下库将 pdf 转换为使用 javascript 的图像

[http://usefulangle.com/post/24/pdf-to-jpeg-png-with-pdfjs](http://usefulangle.com/post/24/pdf-to-jpeg-png-with-pdfjs)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-04-07T15:05:49.920

我安装完毕！成功了！

您可能会在 Windows 上[安装 imagemagick 。](http://thinktibits.blogspot.com/2008/09/installing-imagemagick-on-windows-setup.html)

在`php (local)`使用调用`exec(<command line>)` 前：

```
<?php
$pdf = "filename.pdf";
$info = pathinfo($pdf);
$file_name =  basename($pdf,'.'.$info['extension']);
echo $file_name;
$pdf = "filename.pdf[0]";
exec("convert $pdf convert-img/$file_name.jpg");    
?> 
```

此外，您可能会`class imagick`在[PHP Imagick 类中使用](http://www.php.net/manual/de/class.imagick.php)

谢谢大家帮助我！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-05-11T17:01:57.470

这是我在几个项目中编写和使用的一个简单类。它只是包装`imagick`并处理将每个页面写入磁盘。如果有人仍在寻找一种简单的方法来做到这一点，[这个链接](https://github.com/snyderp/PES_File_PDF_Splitter)可能会有所帮助。

# 64-bit - XML-RPC：64 位整数的最佳选择？

> ID：467794
> 
> 赞同：3
> 
> 时间：2009-01-22T01:48:12.973
> 
> 标签：64-bit, xml-rpc, biginteger

遗憾的是，XML-RPC 在官方标准中不支持 64 位整数。似乎有几个扩展添加了这种支持。

它们中的任何一个似乎更受欢迎或得到更好的支持吗？您使用哪个扩展程序？

所有语言的答案表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-07T00:30:14.107

好吧，这似乎没有很好的答案，所以我们只是做了一个内部扩展，说“整数类型是无界的”。

在我们的 python 库中，我注释掉了这个检查：

```
def dump_int(self, value, write):
    # in case ints are > 32 bits
    ## extension: ints can be arbitrarily sized
    ## if value > MAXINT or value < MININT:
    ##    raise OverflowError, "int exceeds XML-RPC limits" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T02:12:18.493

这有关系吗？如果您谈论的是“不兼容”的更改，那么您谈论的是两个实际上与标准“不兼容”的系统，所以......只需调整您正在使用的 XML RPC 库并完成用它。

否则，如果您想保持兼容，欢迎来到 Strings 的美妙世界。

*（由 Mark Harrison 更新）这确实很重要，因为如果其他人也这样做，我们希望遵循最常用的方法。*

# optimization - 移动计算：再次重视效率？

> ID：467796
> 
> 赞同：0
> 
> 时间：2009-01-22T01:50:51.437
> 
> 标签：optimization, mobile

最近我一直在忙于 iPhone 的开发。在这个平台上的开发增加了（我确信在其他平台上）为台式计算机开发时不存在的考虑因素

1.  **电池寿命**（需要将 cpu/网络或任何硬件的使用保持在最低限度以保持电池寿命）
2.  **减少网络流量**（大多数人按网络流量付费）
3.  **减少内存占用**（手机没有我们在桌面上使用的 GB 的 RAM 和 GB 的交换空间）
4.  **快速加载和退出时间**（使用手机应用程序的人通常只运行很短的时间，所以不能像在桌面上那样等待）

既然移动计算如今风靡一时，这是否意味着设计和编写高效的软件将再次成为软件开发人员必须具备的必备技能，就像在个人计算早期一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T01:59:46.520

好吧，我会胡思乱想地建议它曾经或应该很重要，但是是的，我认为如此。内存规则，以及 iPhone（和其他移动设备）用户不希望他们的手机崩溃、挂起和其他行为不端的事实应该意味着，生产快速、高质量软件且不消耗大量资源的人将拥有有市场优势。

这应该告诉我们什么？基本上，有三个规则：

*   把事情简单化
*   把事情简单化
*   把事情简单化。

试图让一个复杂的桌面应用程序适合 iPhone 是错误的，最终会伤害到你。

为您希望用例花费的时间制定预算，例如，应用程序在 ≤ 10 秒内启动。逐步构建软件，并随时测试这些东西。您应该将所有优化保存到最后，这是一种都市神话；到那时你可能已经走错路了。但是通过增量构建和预算，您可以*有效地*在考虑性能的情况下进行开发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T02:00:38.937

并非特别是：最大的影响仅仅是它限制/约束了您对框架和/或高级编程语言的选择。

我认为任何手机已经拥有*比*早期个人电脑更多的内存和计算能力。

# python - 是否有 Python 的 re.findall/re.finditer（迭代正则表达式结果）的 Perl 等价物？

> ID：467800
> 
> 赞同：6
> 
> 时间：2009-01-22T01:52:54.023
> 
> 标签：python, regex, perl, iterator

在 Python 中编译的正则表达式模式[有一个`findall`方法](http://docs.python.org/library/re.html#re.findall)可以执行以下操作：

> 返回字符串中模式的所有非重叠匹配，作为字符串列表。从左到右扫描字符串，并按找到的顺序返回匹配项。如果模式中存在一个或多个组，则返回组列表；如果模式有多个组，这将是一个元组列表。空匹配包含在结果中，除非它们触及另一个匹配的开始。

在 Perl 中执行此操作的规范方法是什么？我能想到的一个天真的算法是“当搜索并用空字符串替换成功时，执行 [suite]”。我希望有更好的方法。:-)

提前致谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-22T02:04:14.110

在比赛中使用`/g`修饰符。从`perlop`手册：

> " `/g`" 修饰符指定全局模式匹配——即在字符串中匹配尽可能多的次数。它的行为方式取决于上下文。在列表上下文中，它返回与正则表达式中的任何捕获括号匹配的子字符串列表。如果没有括号，则返回所有匹配字符串的列表，就好像整个模式都有括号一样。
> 
> 在标量上下文中，每次执行 " `m//g`" 都会找到下一个匹配项，如果匹配则返回 true，如果没有进一步匹配则返回 false。可以使用该`pos()`函数读取或设置最后一次匹配后的位置；见“ `pos`”中`perlfunc`。失败的匹配通常会将搜索位置重置为字符串的开头，但您可以通过添加“ `/c`”修饰符（例如“ `m//gc`”）来避免这种情况。修改目标字符串也会重置搜索位置。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-22T02:35:09.837

`//g`为了建立克里斯的回应，将正则表达式封装在一个`while`循环中可能最相关，例如：

```
my @matches;
while ( 'foobarbaz' =~ m/([aeiou])/g )
{
    push @matches, $1;
} 
```

粘贴一些快速的 Python I/O：

```
>>> import re
>>> re.findall(r'([aeiou])([nrs])','I had a sandwich for lunch')
[('a', 'n'), ('o', 'r'), ('u', 'n')] 
```

为了在 Perl 中获得类似的东西，构造可能是这样的：

```
my $matches = [];
while ( 'I had a sandwich for lunch' =~ m/([aeiou])([nrs])/g )
{
    push @$matches, [$1,$2];
} 
```

但总的来说，无论您要迭代什么功能，您都可以在`while`循环本身内完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T02:36:28.070

不错的初学者参考，内容与[@kyle](https://stackoverflow.com/questions/467800/is-there-a-perl-equivalent-of-pythons-re-findall-re-finditer-iterative-regex-re#467874)的答案类似：[Perl 教程：使用正则表达式](http://perldoc.perl.org/perlretut.html#Using-regular-expressions-in-Perl)

# dependency-injection - 约定优于配置反对松散耦合？

> ID：467807
> 
> 赞同：2
> 
> 时间：2009-01-22T01:57:47.757
> 
> 标签：dependency-injection, inversion-of-control, convention-over-configur

许多程序员似乎都在遵守配置约定。在 IoC 的上下文中，这意味着使用 API 而不是 XML 配置。

当您必须引用包含抽象接口/类的具体实现的 DLL 以使用配置约定时，您应该如何保持 DI/IoC 背后的松散耦合思想？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T02:03:16.793

通过代码 API 进行配置不是“惯例”。它是“配置”。

例如，约定优于配置意味着特定的应用程序框架（如 Rails 或 CodeIgniter）可能要求将某些类型的代码放置在某些目录中。您不需要通过配置*告诉*应用程序框架这些文件在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T02:02:14.240

这意味着你必须平衡它们；不要被任何/或想法所困。

另一方面，如果您*确实*需要配置文件，请不要认为它们*必须*是 XML。XML 是一种相对重量级的表示；JSON、YAML 等广泛可用且更易于用于大多数配置文件类型的存储。

# flash - Flash if 语句满足真假

> ID：467813
> 
> 赞同：0
> 
> 时间：2009-01-22T02:01:10.887
> 
> 标签：flash, actionscript, actionscript-2, conditional

我有以下代码：

```
if(pickedUp == true){
    trace("released and picked up" + pickedUpNum);
    this.storedClick = false;
    this.onMouseMove = null;
    this.onMouseDown = null;
    this.onMouseUp = null;
    this.onEnterFrame = this.refresh;
    pickedUpNum++;
    if( pickedUpNum > 60) pickedUp = false;
}

if(pickedUp == false){
    trace("released and not picked up");
    this.storedClick = false;
    this.onEnterFrame = this.refresh;
    this.onMouseDown = this.onStoreDrag;
    this.onMouseUp = this.onClearStoreDrag;
    this.onMouseMove = null;
} 
```

我得到这个输出大约 60：

```
released and picked up59
released and picked up60
released and not picked up
released and picked up61
released and not picked up 
```

这怎么可能？我一定错过了一些简单的东西。

我正在进行的项目实际上是在尝试模拟拿起一张纸并移动它，然后将其放回原处。我正在尝试修改 Flash 页面翻转代码以创建此效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T02:23:08.877

Take a look at a trace for the initial conditions (`pickedUpNum`, `pickedUp`) = (`59`, `true`). We'll execute the first conditional, and add `1` to `pickedUpNum`. After adding `1`, `pickedUpNum = 60`, so we don't execute the internal conditional and `pickedUp` remains set to `true`. With this value, we skip the second conditional.

So we're at (`pickedUpNum`,`pickedUp`) = (`60`,`true`). We again execute the first conditional, and add `1` to `pickedUpNum`. Now, `pickedUpNum = 61`, so we execute the internal conditional and set `pickedUp = false`. With this new value, the second conditional will execute.

(sorry if I'm being pedantic, sometimes it's best to be explicit :) )

**edit: thanks, David, for catching my logical typo**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T02:19:58.523

我不确定我是否完全理解您要完成的工作，因为您没有解释您期望发生的事情。但你不是打算这样做吗？

```
if(pickedUp == true){

}
else
if(pickedUp == false){

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T09:47:38.013

Ok, couple of things. Firstly, you don't need to say "== true" for booleans. Secondly, in general don't use "==false" use "!" (the NOT symbol), but in your case just use an "else"

```
 if(pickedUp){
                trace("released and picked up" + pickedUpNum);
                this.storedClick = false;
                this.onMouseMove = null;
                this.onMouseDown = null;
                this.onMouseUp = null;
                this.onEnterFrame = this.refresh;
                pickedUpNum++;
                if( pickedUpNum > 60) pickedUp = false;
        }  else {
            trace("released and not picked up");
            this.storedClick = false;
            this.onEnterFrame = this.refresh;
            this.onMouseDown = this.onStoreDrag;
            this.onMouseUp = this.onClearStoreDrag;
            this.onMouseMove = null;
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T18:16:44.240

If the code you wrote is in a loop, somehow pickedUp is being set to true AFTER the check for (pickedUp == false). So, what would happen is the next time through the loop (say when pickedUpNum == 61), pickedUp would be true, the true statements would run, and then pickedUp would be set to false again (at the end of the "true" check) allowing the false check statements to run.

Make sure you're not resetting pickedUp to true after the false check (and when pickedUpNum > 60, per your code) and it should work as you intend.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T05:21:16.020

I suspect your code is resetting the flag each time through the loop.

```
wile (true)
{
    boolean pickedUp = true // Move this outside the loop ^^

    if (pickedUp == true)
    ....
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T08:37:36.563

What's it supposed to do when it reaches 61 and executes the second conditional?

If your code is not in a loop, check if pickedUp and pickedUpNum are being changed somewhere else than in the first conditional.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T18:09:34.660

To answer all of your questions

*   Yes, the code is in a loop. (onEnterFrame)

*   I know I can use "else if", but if I did use else the second conditional would never execute.

*   I know I don't need to use == and can use not operator (!), but since I was having problems I decided to be explicit

*   I don't understand how Kyle explained the solution in his code and why other people believe it is a solution (+2).

The question remains how are both conditionals being satisfied ( pickedUp is true and false) once pickedUpNum reaches 61 and pickedUp is set to false..

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-27T07:25:21.173

Bryan - I stared at this for some time wondering why you couldn't accept Kyle's answer, then it hit me that you actually *did* want it to do this bit:

```
released and picked up60
released and not picked up 
```

And the question was about what happened *after*. At first glance your question was being misinterpreted, as a fairly Textbook Example of a Mistake Someone Might Make With Conditionals. Micheal seems to have the right idea, as there is nothing in the code given that should explain it, but I also just wanted to add that the debugger in the flash IDE, while not perfect, is awesome for tracking down this kind of thing.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-27T09:12:33.173

way not use debugger ? build your code with flex builder and use a friendly programing environment (eclipse) that have an easy way to debug the code

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-27T10:27:00.853

I agree with Shvilam. Learning how to use a step-through debugger is such a valuable skill and it makes bugs significantly easier to diagnose. I'd recommend Flex's debugger over Flash's, but either is better than none.

# java - 具有相同名称的类方法和变量，在 C++ 中编译错误而不是在 Java 中？

> ID：467815
> 
> 赞同：47
> 
> 时间：2009-01-22T02:01:32.680
> 
> 标签：java, c++

```
class Test {

      bool isVal() const {
          return isVal;
      }

  private:

      bool isVal;
}; 
```

在编译这个文件时它说

> testClass.cpp:9: `bool Test::isVal' 的声明
> 
> testClass.cpp:3: 与之前的声明 `bool Test::isVal()' 冲突

虽然同样适用于java

```
class Test {

  private boolean isVal;

  public boolean isVal() {
      return isVal;
  }

} 
```

为什么编译错误发生在 C++ 而不是 Java 中？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-01-22T02:07:27.223

因为 C++ 不是 Java。您可以获取成员的地址：

```
&Test::isVal 
```

所以你不能有两个成员有相同的名字，除了你可以重载成员函数。即使你可以通过某种类型的演员来消除歧义，下一个问题也会在其他地方出现。

在 C++ 中，包括我在内的很多人通常都特别称呼数据成员，比如`m`在他们的名字前加一个。这避免了这个问题：

```
class Test {
public:
    bool IsVal() const { return mIsVal; }
private:
    bool mIsVal;
}; 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-02-23T19:04:49.327

C++ 将名称修饰应用于函数名称和全局变量。局部变量没有被破坏。出现问题是因为在 C 中您可以访问变量或函数的地址（因此在 C++ 中也是如此），例如：

```
struct noob{
    bool noobvar;
    void noobvar(){};
}; 
```

可以说，为什么不对局部变量也应用名称修饰，然后使用内部局部表示，例如

```
bool __noobvar_avar;
void __noobvar_void_fun; 
```

并假设它们在执行期间分别接收到地址 0x000A 和 0x00C0。

但是，如果我们在代码中的某处写：

```
&noob::noobvar 
```

程序应该做什么？

1.  返回变量 noobvar 的地址，即 0x000A
2.  返回 noobvar 函数的地址，即 0x00C0

您可以看到，由于在 C 中，因此在 C++ 中，您可以发出“地址”，因此在相同的解析范围内具有相同名称的变量和函数是不合法的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-22T02:07:57.673

c/c++ 中的函数只是指向代码所在内存位置的指针，因此 isVal（作为布尔值）和 isVal（作为函数）是不明确的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-22T02:09:16.940

快速的回答是“因为这就是 C++ 的工作方式”。C++ 没有单独的名称空间用于成员变量和成员函数（即“方法”），而 Java（显然，因为我没有尝试过）有。

无论如何，请记住关于那个去看医生并说“医生，我这样做时很痛”的老*故事*。医生回答说：“好吧，不要那样*做*！” 这是成为哑程序员技巧的一种语言特性。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-10-06T15:44:04.417

C++ 标准草案 N3337 中的以下部分指定了何时可以重载名称。

> **13 重载**
> 
> 1 当在同一范围内为单个名称指定两个或多个不同的声明时，称该名称为*重载*。通过扩展，在同一范围内声明相同名称但具有不同类型的两个声明称为*重载声明*。只能重载函数和函数模板声明；变量和类型声明不能重载。

当您将类定义为：

```
class Test {

      bool isVal() const {
          return isVal;
      }

  private:

      bool isVal;
}; 
```

您正在`isVal`类范围内重载名称。`isVal`只有当是成员函数时才允许这样的重载。`isVal`当是成员变量时是不允许的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-21T09:28:27.320

好吧，如果你真的需要它，你可以这样做：

```
#include <iostream>

struct TestBase {
      bool isVal;
};

struct Test : TestBase {
      bool isVal() const {
          return TestBase::isVal;
      }
};

int main() {
  Test t;
  std::cout << static_cast<TestBase&>(t).isVal << std::endl;
  std::cout << t.isVal() << std::endl;
} 
```

[https://replit.com/@Konard/SameNameVariableAndFunction#main.cpp](https://replit.com/@Konard/SameNameVariableAndFunction#main.cpp)

这样，您就有了同名但地址不同的成员。尽管`isVal`变量在派生结构中被`isVal`函数隐藏，但如果您将结构转换为`TestBase`引用，您仍然可以访问此变量。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2011-12-18T14:16:14.560

如果您有某些理由对变量和方法使用相同的名称（可能会减少对具有几乎相同目的的事物的命名等？？），我建议只用不同的大小写命名它们：

```
class Test 
{
    private bool isVal;
    public bool ISVAL() 
    {   return isVal;  }
} 
```

# .net - .Net 和 Javascript 的测试运行程序/框架？

> ID：467833
> 
> 赞同：1
> 
> 时间：2009-01-22T02:08:32.353
> 
> 标签：.net, javascript, testing, automation, automated-tests

我的团队使用多种语言开发软件。我们在 .Net 中有一个服务器应用程序，我们的大部分客户端代码都是用 JavaScript 编写的。（客户端代码实际上是针对 xulrunner 应用程序的，目前还没有好的测试工具，但我希望有一天能克服。）

不过，我喜欢这样的想法，即拥有一个可以为我们所有代码运行测试的测试工具。现在抛出 xulrunner 问题，只**考虑 .net 和 Javascript - 是否有任何测试和自动化选项可以涵盖这两个领域？** 我见过的大多数流行的测试工具似乎都是以 .Net 为中心的。

还是**我应该放弃拥有一个测试工具来统治所有这些工具的愿望，而只是为每个工具选择最好的品种？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T19:58:23.067

我在一个有点相似的场景中使用了一个测试框架——使用 NUnit 来测试 .Net 和非托管 C++ 代码。我只是在托管 C++ 中为以后编写测试。这比使用 CppUnit IMO 更好。

但就您而言，.Net 和 JavaScript 世界之间没有您可以使用的类似桥梁。因此，您最好为每个平台使用专用的测试框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-07T00:53:35.547

我在搜索可用的 JS TDD 运行器时偶然发现了这篇文章。.NET 似乎有一个，称为 JSTest.NET [http://jstest.codeplex.com/](http://jstest.codeplex.com/)（如果还有其他的，请告诉我）。但是，我非常喜欢 JS-Test-driver [http://code.google.com/p/js-test-driver/wiki/GettingStarted](http://code.google.com/p/js-test-driver/wiki/GettingStarted)。这是我的想法：一个自动化的 javascript 测试运行器，它有一个 QUnit 适配器，针对多个浏览器，并且可以用作 CI 的一部分（还有什么可以要求的！）

# vb.net - VB.NET 暗淡与新

> ID：467843
> 
> 赞同：2
> 
> 时间：2009-01-22T02:15:26.147
> 
> 标签：vb.net, memory-management, new-operator

以下构造之间有什么区别？为什么偏爱一个而不是另一个？

第一：

```
Dim byteArray(20) as Byte 
```

第二：

```
Dim byteArray() as Byte = new Byte(20) {} 
```

任何帮助，将不胜感激。

谢谢你。

**编辑**- 我更正了一些代码。“ReDim”应该是“Dim”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T02:26:19.103

这是同一件事。

给猫剥皮的方法总是不止一种。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T02:42:06.217

它们都在托管堆上分配 20 个字节。

他们都将标识符“byteArray”设置为指向这些字节。

带有“new”运算符（子句）的语句允许对数组元素进行初始化。

```
 Dim byteArray() as Byte = new Byte(20) { 1, 2, 3, 4, 5, 6, ... } 
```

顺便说一句，要分配一个没有元素的数组，请为其中一个维度指定 -1 的大小。如果您需要在不引发错误的情况下访问长度等属性，这将非常有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T02:45:12.420

是的，一样。第二条语句是要避免的，很少有人会猜到它实际上创建了一个包含 21 个元素的数组。从第一个陈述中也不是那么明显......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-14T03:41:45.673

两者都是一样的。

`Dim byteArray(20) as Byte`将创建一个包含 21 个元素的数组

`Dim byteArray() as Byte = new Byte(20) {}`将创建一个包含 20 个元素的数组

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T02:17:48.450

没有区别。Redim 是 vb 6 开发人员熟悉的继承语法。

# flash - 对 ActionScript 的行话调用不起作用

> ID：467844
> 
> 赞同：1
> 
> 时间：2009-01-22T02:15:28.703
> 
> 标签：flash, actionscript, lingo

我的 Director 项目中有一个 Flash 精灵。在该精灵的属性下，在成员和精灵选项卡下，它的名称为“评估”。在我的 Lingo 脚本中，我有以下调用：

```
sprite("Assessment").displayGrade(75, 3, 4) 
```

其中 displayGrade 是一个在 Flash 对象的 ActionScript 中定义的函数，它是一个以 3 个数字为参数的方法。但是，我在这一行收到错误，无法确定原因。我是否错误地调用了 Flash 对象的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T19:22:32.467

我浏览了一下，发现了这个：

[http://groups.google.com/group/macromedia.director.basics/browse_thread/thread/85203d2879267fe1?pli=1](http://groups.google.com/group/macromedia.director.basics/browse_thread/thread/85203d2879267fe1?pli=1)

这也是：

[http://dreamweaverforum.info/director/23160-director-11-actionscript-3-a.html](http://dreamweaverforum.info/director/23160-director-11-actionscript-3-a.html)

当然，您应该通过浏览 Director 11 文档进行验证。

问候，维格

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T15:39:52.743

我对导演方面一无所知，但是由于这还没有解决，我会问：你在Flash方面是怎么做的？

*   您说您的 SWF 使用的是 AS3，但是 AS2 和 AS3 使用完全不同的引擎，所以很可能 Director 可以调用一个而不能调用另一个，或者方法不同。使用简单的 AS2 SWF 进行测试可能会有所帮助。
*   你在哪里定义你在 Flash 中的函数？如果您的成员 Sprite 指的是 SWF，那么我认为您可能希望该功能位于 Flash 文件的主时间线上。但是，如果您的成员 Sprite 指的是 Flash 电影中的实际 Sprite，那么这是行不通的，您需要在 Sprite 内部定义该函数（或者可能是附加到该 sprite 的类）。
*   如果对 Flash 方面有任何疑问，您是否尝试过调用内置的 flash 方法（因此保证存在）？如果影片的顶层有多个帧，您可以尝试调用 play()、stop() 或 gotoAndStop(n:Number) 等方法。如果只有一帧，那就没那么容易了，因为大多数其他方法都没有明显的视觉效果。

如果您已经确定 Flash 部分没问题，请提前道歉。这些只是猜测。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T18:05:25.947

试试这个：

设置对您的 swf 的容器内容引用，即 Flash 主时间线：

```
global swfTL
on beginSprite me
swfTL = getvariable(sprite('yourFlashSprite'),'_level0',False)
end 
```

然后打电话

`swfTL.displayGrade(75, 3, 4)`

希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-01T12:12:23.843

我的 Director 项目中有一个 Flash 精灵。在该精灵的属性下，在成员和精灵选项卡下，它的名称为“first”。在我的 Lingo 脚本中，我有以下调用：

sprite("first").number1

其中 number1 是在 Flash 对象的 ActionScript3 中定义的变量：a=25 in flash。但是，在director中返回，但是如果ActionScript2中的swf cteate返回25！as3中从director内部的flash（swf）获取变量的语法是什么（如果在as3中创建了swf）？

# c++ - 为什么我们不能在课堂上使用“this”？

> ID：467851
> 
> 赞同：2
> 
> 时间：2009-01-22T02:19:10.053
> 
> 标签：c++

例如

```
class Test {
  public:
      void setVal(const std::string& str) {
           this.isVal = str; //This will error out
      }

  private:

      string isVal;
}; 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-22T02:21:12.327

在 C++ 中，`this`是指针（与引用相反）。所以你不得不说`this->isVal`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-22T02:23:56.520

添加到[克里斯的答案](https://stackoverflow.com/questions/467851/why-cant-we-use-this-inside-the-class#467853)中，您还可以执行以下操作：

```
(*this).isVal = str; 
```

不过，还是按克里斯说的做比较好，因为这样比较正统。这只是说明您需要在调用方法之前取消引用指针。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-22T02:35:48.960

您也不需要`this`显式使用来访问成员变量/方法。你可以简单地说：

```
isVal = str; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T12:29:10.517

对于设计范围，您可以使用：

测试::isVal = str;

# foxpro - 我可以从 foxpro 通用字段中提取文件吗？

> ID：467854
> 
> 赞同：3
> 
> 时间：2009-01-22T02:21:24.480
> 
> 标签：foxpro, visual-foxpro

我正在将 VFP 9 应用程序移植到 SQL Server。VFP 应用程序有一些表，其中包含“常规”字段。我在查询字段时得到一个字节数组，当我将它保存到磁盘时，我可以查看它是一个 word 文档，或者一个 Paint BMP 等。

通过阅读，我发现通用字段是一种专有格式，并包含文档预览的缩略图（除其他外，我敢肯定）。

有人可以指点我一些代码，这些代码首先会提取文件的类型，然后是我可以保存为原始文件的实际文件数据。（获取预览图像也很好。）

显然，在过去，有人在 foxpro 中编写了一个名为 GENTOFIL.PRG 的程序，这听起来像是将一般字段转换为文件。但是，谷歌在试图找到它时并没有多大帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-07T18:20:14.103

如果您知道 General 字段的内容是 Word 文档，那么我有一些 Visual FoxPro 代码由应该提取它的人推荐。

```
* 首先以编程方式创建一个表单
loForm = CREATEOBJECT("表格")

* 使用常规字段打开您的 VFP 表。根据需要更改名称
在 0 ALIAS WordData 中使用 CustomerDocs.DBF

loForm.AddObject("oleWordDoc", "oleBoundControl")
loForm.oleWordDoc.AutoSize = .T.

* 将通用字段绑定到 oleboundcontrol
loForm.oleWordDoc.ControlSource = "WordData.gen1"

lnCounter = 1

扫描
   * 文件名全部相同，计数器在末尾
   * 您可能在表格的另一列中有文件名。
   lcFileName = "docfromgeneralfield" + TRANSFORM(lnCounter)
   lcFileName = FORCEEXT(lcFileName, "doc")

   * 将数据从通用字段保存到 .doc 文件
   loForm.oleWordDoc.SaveAs("lcFileName")

   lnCounter = lnCounter + 1
ENDSCAN

发布 loForm

使用 (SELECT("WordData"))

返回

```

如果您需要帮助从表格中提取图像，您可以查看我过去使用过的 Microsoft 知识库文章。

[http://support.microsoft.com/kb/894819](http://support.microsoft.com/kb/894819)

Rick Schummer Visual FoxPro MVP

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T16:34:02.107

VFP 中的“常规”字段类型有点奇怪……

从 VFP 帮助文档：

> General 字段包含对该字段实际内容的十字节引用：由另一个应用程序创建的电子表格、文字处理器文档或图片。但是，实际的数据类型和数量取决于创建对象的自动化服务器以及您是链接还是嵌入 OLE 对象。
> 
> 如果您链接一个 OLE 对象，您的表只包含对数据和创建它的应用程序的引用。如果您嵌入 OLE 对象，则该表包含数据的副本以及对创建它的应用程序的引用。常规字段的大小仅受可用磁盘空间量的限制。

这里要注意的关键是 VFP 的“通用”字段类型处理 Microsoft OLE 对象，它们可以是***链接***的或***嵌入***的。此外，VFP 直接操作 OLE 对象的能力似乎很小，因为在对包含的 OLE 对象调用操作时，关联的应用程序实际上是在运行以打开/编辑 OLE 绑定的“常规”字段的内容。

如您所说，如果您能够手动提取文件，那可能是获取文件的最佳方式，因为即使是 VFP 也提供了与一般类型字段中包含的数据交互的最少方式。

# c# - ASP.NET 母版页是否应该从视图中获取其数据？

> ID：467855
> 
> 赞同：4
> 
> 时间：2009-01-22T02:21:48.693
> 
> 标签：c#, .net, asp.net-mvc

我一直在使用包含母版页的站点来使用 ASP.NET MVC。

我创建了一个名为`ProductThumbnailControl`. 用户控件显示一个产品和一个小缩略图。视图是`ViewProduct`显示完整产品信息的视图 - 用户控件只是站点的 UI 元素。

```
 public partial class ProductThumbnailControl :
                      System.Web.Mvc.ViewProductControl<ViewProductsModel>
 {

 } 
```

[我阅读了一篇博客文章](http://blog.matthidinger.com/2008/02/21/ASPNETMVCUserControlsStartToFinish.aspx)，其中展示了用户控件如何使用`ViewData`. 我了解到用户控件可以*自动*从父视图中获取其模型。由于它使用相同的数据，因此 View 不需要显式地将任何内容传递给用户控件，从而使标记和代码更清晰。

所以现在我了解到母版页`ViewData`与页面使用相同。这意味着母版页本身并没有真正的模型来帮助呈现自己。

### 问题

母版页首先获取其数据的正确方法是什么？

我想过尝试以下？

你可以有一个`SiteModel`：

```
//Arbitrary properties for example
class SiteModel 
{
    public string PartnerId {get; set;}
    public ShoppingCart ShoppingCartContents {get; set;}    
    public string CurrentUserId {get; set;}
} 
```

View 继承自它：

```
class ViewProductModel : SiteModel 
{
    public Product Product {get; set;}
} 
```

`SiteModel`将被母版页使用。如果需要，视图可以使用其中的数据——如果他们需要在某处显示当前用户的电子邮件。

这是一个可怕的想法吗？

母版页是否应该从需要的地方获取数据？

如果我想在 中包含用户控件`masthead`怎么办？

由于整个页面`ViewData`只有一个对象，它从哪里得到它？`ViewData`

我是否必须使用我讨厌的这种可怕的语法并将母版页的用户控件传递给显式模型？

```
Html.RenderUserControl("~/Views/Account/UserControls/Header.ascx",
  null, new { SelectedItem = "Profile" }) 
```

解决这种情况的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T04:04:20.077

我们的母版页从视图中获取数据。我们为视图使用[强类型视图名称](http://oddiandeveloper.blogspot.com/2008/11/strongly-typed-view-names.html)，并且在该实现的方法中，我们还添加了每个页面都需要从我们的持久对象中获取的标准视图数据（如应用程序菜单结构信息、要在屏幕上显示的用户信息等）。

这确实有一个缺点，即我们的母版页视图数据不像 Model 对象那样是强类型的，但它对我们来说非常有效。

你的想法也不错。由于母版页的想法类似于继承的想法，为什么不使用继承来设置模型对象。您可以更进一步，创建一个模型工厂来生成模型对象并在执行此操作时设置基类数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T07:28:33.737

看起来我的解决方案与 Microsoft 的建议非常相似，但有一个关键例外。我正在创建一个 ViewData 基类，他们创建了一个 Controller 基类——这更有意义。

然而，这两种想法似乎可以（并且应该）协同工作。下面的 MS 教程使用字典来存储视图数据，所以如果你有一个强类型模型，你还需要一个基类。

[微软 MVC 教程](http://www.asp.net/learn/mvc/tutorial-13-cs.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T22:58:47.977

我将创建一个 ShoppingCart 控制器（或为每个关注点创建单独的控制器）并渲染用户控件，这些用户控件与可以从 www.codeplex.com/asp.net 下载的 Futures DLL 中的 RenderAction 一起使用它们。它是 ASP.NET MVC 源代码的一部分。

使用基本控制器或“站点模型”将太多东西结合在一起，造成测试和维护的噩梦。

# .net - 如何从 ASP.NET MVC 中的控制器构造函数中找到文件夹的路径？

> ID：467859
> 
> 赞同：13
> 
> 时间：2009-01-22T02:23:13.150
> 
> 标签：.net, asp.net-mvc

我正在尝试获取网站根目录中文件夹的路径，并在调用控制器构造函数时将其保存到类属性中：

```
public TestController:Controller{
    string temp;

    public TestController(){
        temp = "";
        }

    } 
```

我尝试了以下方法：

```
temp = Server.MapPath("~/TheFolder/"); // Server is null - error.
temp = Request.PhysicalApplicationPath + @"TheFolder\"; // Request is null - error. 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-22T05:58:39.237

AppDomain.CurrentDomain.BaseDirectory 将为您提供站点的根目录。所以：

```
temp = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "TheFolder"); 
```

（感谢 Marc Gravell 的评论更新）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-22T08:37:23.880

在构造函数期间你真的需要这条路径吗？如果您在主页周期开始之前不需要它，请考虑推迟它 - 只需使用常规属性；就像是

```
public string BasePath {
    get { return Server.MapPath("~/TheFolder/"); }
} 
```

然后在页面周期中使用它时，应该没问题。如果你*真的*想缓存它，你可以缓存它，但我不认为这会成为瓶颈：

```
private string basePath;
public string BasePath {
    get {
        if(basePath == null) basePath = Server.MapPath("~/TheFolder/");
        return basePath;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T07:02:31.230

尝试通过 ControllerContext。原谅我的语法，但它应该是这样的：

```
base.[Controller?]Context.HttpContext.Server.MapPath(); 
```

如果在这种情况下 Server*仍然*为空，您是否在 Web 请求之外运行（即在测试中）？

# .net - 依赖注入启动性能

> ID：467865
> 
> 赞同：10
> 
> 时间：2009-01-22T02:26:25.937
> 
> 标签：.net, dependency-injection, benchmarking

我最近被要求解决使用 Microsoft 的 Composite UI Application 块构建的应用程序中的一些性能问题 - 特别是加载时间过长。

这是围绕 Microsoft 的 ObjectBuilder 依赖注入框架构建的，该框架使用反射/属性来注册类。分析表明，在启动时，应用程序花费大量时间进行反射，因为 ObjectBuilder 会扫描每个加载程序集中的每个类型，以搜索要注册的内容。

替代 DI 框架似乎也都使用属性、XML 配置或纯代码。
似乎没有任何其他基于属性的框架会更好，而且我对必须解析成堆的 XML 等的启动时间持怀疑态度。
基于纯代码的框架似乎应该快得多，但它们的灵活性也低得多，所以看起来并不是一个明确的好选择......

这导致我搜索 DI 容器基准，但我唯一能找到的是这个： http: [//www.codinginstinct.com/2008/04/ioc-container-benchmark-unity-windsor.html](http://www.codinginstinct.com/2008/04/ioc-container-benchmark-unity-windsor.html)。
虽然它是一个很好的基准，但它只衡量使用容器创建 100 万个对象的速度。我对创建 100 万个对象没有兴趣，我只是希望应用程序尽快启动，所以我正在寻找有关 DI Container*启动的任何信息*成本的任何信息，无论是博客文章、轶事，甚至是诸如就像“这是一种使 ObjectBuilder 更快的方法”一样简单。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T03:01:11.420

您是否尝试过在所有组件都经过 NGEN 处理后测量启动时间？我发现（至少在 IronScheme 中）它在反射场景中有很大帮助（在我的情况下从 1.5 秒到 0.1 秒）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-22T15:45:25.710

关于让它更快...

我在想可能有一种方法可以缓存启动结果。也许应用程序花费更多时间进行反射，然后缓存结果，但是在您第二次启动时，如果没有任何变化，您可以从缓存中加载（这可能会更快）。

至于这个缓存的性质，可能是对象被序列化到磁盘上。作为“没有改变”的问题，初创公司可以查看校验和。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-22T17:56:10.667

我不了解 ObjectBuilder，但最近的依赖注入框架通常支持延迟加载以提高启动性能。例如，请参阅[使用 Autofac2 闲逛](http://nblumhardt.com/2009/12/lazing-around-with-autofac2/)。

或者您可以像 Ploeh 的[LazyOrderShipper](http://blog.ploeh.dk/2010/01/20/RebuttalConstructorOverinjectionAntipattern.aspx)示例中那样手动完成。

# python - python中的排列，有点扭曲

> ID：467878
> 
> 赞同：1
> 
> 时间：2009-01-22T02:38:17.443
> 
> 标签：python

我有一个对象列表（例如，假设为 5）。我想要一些可能的排列列表。具体来说，鉴于有些对不在一起，有些三元组不做三明治，我如何生成所有其他排列？我意识到我首先生成所有它们并检查它们是否有效，但我认为甚至不考虑不起作用的对和三元组会更快。

我错了，先检查然后再生成会更快吗？

我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T03:09:38.737

您必须找到一种算法，在一次检查后切断多个不需要的排列，以获得任何东西。显而易见的策略是按顺序构建排列，例如在树中。然后每次切割都会消除整个分支。

*编辑：*
示例：在集合（ABCD）中，假设B和C，A和D不允许成为邻居。

```
       （A B C D）
     / | \ / | \ / | \ / | \
 AB AC AD BA BC BD CA CB CD DA DB DC
 | \ | \X/\X/\/\X/\X/\/\
ABC ABD ACB ACD BAC 坏 BDA BDC CAB CAD CDA CDB DBA DBC DCA DCB
 X | X | | XX | | XX | | X | X
    ABDC ACDB BACD BDCA CABD CDBA DBAC DCAB
     vvvvvvv

```

每个没有括号的字符串都需要检查。如您所见，X（子树已被切断）保存检查，如果它们在第三行，则保存检查，但如果在第二行，则保存检查。我们在这里保存了 60 次检查中的 24 次，然后降到了 36 次。但是，无论如何，总共只有 24 次排列，所以如果检查限制（而不是构建列表）是瓶颈，我们最好只构建所有排列并在最后检查它们......如果我们这样做时无法优化检查。

现在，如您所见，只需对每个列表的新部分执行检查。这使得检查更加精简；实际上，我们将完整排列所需的检查分成小块。在上面的例子中，我们只需要查看添加的字母是否允许站在最后一个之外，而不是之前的所有字母。

然而，同样如果我们先构造然后过滤，一旦遇到“否”，检查就可以被缩短。因此，在检查时，与先构建后过滤算法相比，没有真正的收益；通过更多的函数调用存在更多开销的危险。

我们节省的是构建列表的时间和内存消耗的峰值。构建列表通常相当快，但如果对象数量变大，可能需要考虑峰值内存消耗。对于先构建后过滤器，两者都随着对象数量线性增长。对于树版本，它的增长速度较慢，具体取决于约束。从一定数量的对象和规则上，还有实际的支票保存。

一般来说，我认为您需要尝试一下并为这两种算法计时。如果您真的只有 5 个对象，请坚持使用简单的`(filter rules (build-permutations set))`. 如果您的对象数量变大，树算法在某些时候会表现得更好（你知道，大 O）。

嗯。抱歉，我进入了演讲模式；忍受我。

# java - 带有 slf4j 和 log4j 的休眠 3.4

> ID：467879
> 
> 赞同：23
> 
> 时间：2009-01-22T02:38:57.567
> 
> 标签：java, hibernate, maven-2, log4j, slf4j

我正在尝试从 Hibernate 3.2 升级到 3.4，这显然使用了 slf4j。我们的项目目前使用 log4j。所以我的假设是我应该使用 slf4j-log4j12 包装的实现。

Maven slf4j 依赖项是：

```
<dependency>
    <groupId>org.slf4j</groupId>
     <artifactId>slf4j-log4j12</artifactId>
    <version>1.5.6</version>
</dependency> 
```

而 log4j 依赖项是：

```
<dependency>
    <groupId>log4j</groupId>
    <artifactId>log4j</artifactId>
    <version>1.2.15</version>
</dependency> 
```

slf4j-log4j12 和 log4j 都引用了最新版本（我可以在 Maven 存储库中找到）。当我运行我的应用程序时，Hibernate 的日志记录失败：

```
java.lang.NoSuchFieldError: name
    at org.slf4j.impl.Log4jLoggerAdapter.<init>(Log4jLoggerAdapter.java:75)
    at org.slf4j.impl.Log4jLoggerFactory.getLogger(Log4jLoggerFactory.java:75)
    at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:103)
    at org.hibernate.cfg.Configuration.<clinit>(Configuration.java:163)
    ... 
```

我错过了什么？

**编辑 1：**如果我从 pom.xml 中删除 log4j 依赖项，则会收到错误消息：

```
java.lang.IllegalAccessError: tried to access field org.slf4j.impl.StaticLoggerBinder.SINGLETON from class org.slf4j.LoggerFactory
    at org.slf4j.LoggerFactory.<clinit>(LoggerFactory.java:60)
    at org.hibernate.cfg.Configuration.<clinit>(Configuration.java:163)
    ... 
```

**编辑 2：** [此博客](http://www.innis.ca/blog/?p=6)声称问题是由带有错误版本的 slf4j-api.jar 的休眠注释引起的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-04T01:09:07.087

我没有问题

```
 <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>3.3.1.GA</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-annotations</artifactId>
        <version>3.4.0.GA</version>
    </dependency> 
```

和

```
 <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.5.6</version>
    </dependency>
    <!-- concrete Log4J Implementation for SLF4J API-->
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>1.5.6</version>
    </dependency> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-05T12:52:16.807

SLF4J FAQ 回答了这个问题。请参见

[http://slf4j.org/faq.html#compatibility](http://slf4j.org/faq.html#compatibility) 和 [http://slf4j.org/faq.html#IllegalAccessError](http://slf4j.org/faq.html#IllegalAccessError)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-06T16:05:46.550

I think you need to exclude the built-in SLF4J dependency from each of the Hibernate dependencies.

I use Hibernate with JPA, so my config isn't identical, but I think the crucial thing is to explicitly include log4j and SLF4J and explicitly exclude slf4j-api from all org.hibernate dependencies:

```
 <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.15</version>
        <scope>compile</scope>
        <exclusions>
            <exclusion>
                <groupId>com.sun.jmx</groupId>
                <artifactId>jmxri</artifactId>
            </exclusion>
            <exclusion>
                <groupId>javax.jms</groupId>
                <artifactId>jms</artifactId>
            </exclusion>
            <exclusion>
                <groupId>com.sun.jdmk</groupId>
                <artifactId>jmxtools</artifactId>
            </exclusion>
        </exclusions>
    </dependency>

    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-annotations</artifactId>
        <version>3.4.0.GA</version>
        <exclusions>
            <exclusion>
                <groupId>org.slf4j</groupId>
                <artifactId>slf4j-api</artifactId>
            </exclusion>
        </exclusions>
        <scope>compile</scope>
    </dependency>

    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>3.4.0.GA</version>
        <exclusions>
            <exclusion>
                <groupId>org.slf4j</groupId>
                <artifactId>slf4j-api</artifactId>
            </exclusion>
        </exclusions>
        <scope>compile</scope>
    </dependency>

    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>1.5.6</version>
        <scope>runtime</scope>
    </dependency> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T04:41:37.363

在检查 slf4j-log4j（然后是 slf4j-parent）的 1.5.6 POM 版本后，您应该使用 log4j-1.2.14。slf4j-log4j POM 使用依赖管理从 slf4j-parent POM 继承适当版本的 log4j。

但是，您不应该将 log4j 作为特定依赖项包含在内，因为它已经是 slf4j-log4j 的依赖项。那可能是你造成问题的地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T03:11:24.723

谷歌搜索发现了这个：

[http://marc.info/?l=slf4j-user&m=122218775201271&w=2](http://marc.info/?l=slf4j-user&m=122218775201271&w=2)

也许您应该检查您的 JAR 版本以确保它们兼容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-01T20:40:46.140

我对包含旧 slf4j 的 displaytag 1.2 版也有同样的问题。更改显示标签以排除：

```
<dependency>
  <groupId>displaytag</groupId>
  <artifactId>displaytag</artifactId>
  <version>1.2</version>
  <exclusions>
    <exclusion>
      <groupId>org.slf4j</groupId>
      <artifactId>jcl104-over-slf4j</artifactId>
    </exclusion>
  </exclusions>
</dependency> 
```

并添加正确的依赖项：

```
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-api</artifactId>
    <version>1.5.6</version>
</dependency>
<!-- concrete Log4J Implementation for SLF4J API-->
<dependency>
   <groupId>org.slf4j</groupId>
   <artifactId>slf4j-log4j12</artifactId>
   <version>1.5.6</version>
</dependency> 
```

似乎解决了这个问题。

# cocoa-touch - 你如何改变 UIControl 并专注于 iPhone？

> ID：467881
> 
> 赞同：7
> 
> 时间：2009-01-22T02:39:40.573
> 
> 标签：cocoa-touch

我正在尝试做一些我认为很简单的事情。

我有一个带有两个 UITextFields 的表单。我在第一个上使用 UIReturnKeyNext 样式。这个想法是当用户填写第一个字段时，他们单击下一步，我将它们转换到下一个 UITextField。我见过其他应用程序可以做到这一点，而且效果非常好。但我不知道如何将焦点设置到下一个字段。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-22T05:13:46.753

简单的。将 becomeFirstResponder 消息发送到您的其他文本字段。当另一个文本字段接受第一响应者状态时，它将接收来自键盘的信息。

例如：

```
//called when the next button is pressed
//Assume textField1, 2, and 3 are instances of UITextField
-(IBAction) nextPressed: (id) sender {
      if ([textField1 isFirstResponder]) {
         [textField2 becomeFirstResponder];
      }
      if ([textField2 isFirstResponder]) {
         [textField3 becomeFirstResponder];
      }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T09:18:30.013

上面的答案很有效，但您希望从原始文本字段中退出FirstResponder。

如果您不辞去第一响应者，则当下一个字段成为第一响应者时，IOS 自动滚动调整将不起作用。（键盘可能会覆盖下一个文本字段。）

```
-(IBAction) nextPressed: (id) sender {

    //Resign first so that when the next field becomes firstResponder 
    //the text field will scroll into place if covered by the keyboard
    [sender resignFirstResponder];      

    if ([textField1 isFirstResponder]) {
       [textField2 becomeFirstResponder];
    }
    if ([textField2 isFirstResponder]) {
       [textField3 becomeFirstResponder];
    }
} 
```

# c# - 用于加载和保存对象的构造函数或静态方法？

> ID：467882
> 
> 赞同：2
> 
> 时间：2009-01-22T02:40:22.307
> 
> 标签：c#, .net, design-patterns, architecture

我正在尝试决定是使用静态方法来加载/保存对象，还是使用构造函数/实例方法更好。

因此，对于 object `Project`，实例版本将是

```
public Project(path) { // Load project here }
public void Save(path) { // Save project here } 
```

静态版本是

```
public static Project Load(path) { // Load project and return result }
public static void Save(path, proj) { // Save project } 
```

那么，你更喜欢哪个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T02:50:50.490

两者都不。倾向于从您的领域模型中提取持久性逻辑并放入单独的类层中。

（来自 ChrisW 回答中留下的评论）关于域对象泄漏到另一个类的详细信息：如果您的语言允许，您可以通过使用包隐私/内部访问来限制这些详细信息的可见性。或者，您可以使用 DTO 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T02:45:40.983

如果没有要维护的状态，只有行为，则使用静态方法。但是，如果 Project 对象需要有状态，则应使用构造函数/实例方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T02:51:08.087

为了节省，我认为制作`Save`静态方法没有任何好处。

对于加载，如果是抽象基类，`Load`最好定义一个静态方法；`Project`但除此之外，定义和调用构造函数更惯用。

或者，我同意 moffdub 的回答，当且仅当功能足够大以使持久性逻辑值得拆分/分离到其他类时。但是，如果您这样做，则其中包含的数据的详细信息`Project`不再是私有的（相反，这些详细信息必须与加载和保存 Project 实例的类共享）。

# javascript - 开发小书签时需要考虑哪些设计和安全注意事项？

> ID：467885
> 
> 赞同：2
> 
> 时间：2009-01-22T02:43:05.013
> 
> 标签：javascript, security, bookmarklet

我现在正在尝试设计一些书签，它们连接回服务器（比如木兰），但就其本质而言，书签似乎与已建立的互联网安全背道而驰，它们基本上是跨站点脚本根据定义，它们也是强大而酷的工具，并且符合我的需求，所以我想使用它们。

然而，由于它们可能是 Javascript 使用的丑小鸭，我想知道在它们的设计和安全性方面应该应用哪些特殊考虑和常识。

谢谢！

**编辑：**我的一项政策是，如果用户在 https 页面内，小书签根本不会启动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T03:03:46.253

用户必须担心的是*其他人的书签。*如果它来自不受信任的来源，您不知道它在激活时可能会做什么（窃取 cookie 或抓取敏感信息。）由于您的代码是跨站点注入的，因此对您没有真正的危险，只会对您的用户造成危险如果你故意把它们放在那里。

编辑：

我会避免可能会干扰主机页面的全局范围的代码，例如重新定义全局对象和原型。您可以将所有书签代码放在一个功能块中以限制其范围：

```
(function(){

// your code

})() 
```

该块中定义的任何变量和函数都不会干扰主机页面，除非您深入研究全局对象和原型、DOM 等。如果您发布一个可能需要这样做的示例，我们可能会帮助重构。

# javascript - 如何隐藏“脚本”HTML 标签？

> ID：467897
> 
> 赞同：1
> 
> 时间：2009-01-22T02:53:16.583
> 
> 标签：javascript, jquery, html

我正在使用 HTML，我想`script`从用户的视图中隐藏标签。当用户查看页面源时，不应出现定义。我该如何做到这一点？

### 例子

```
<script type="text/javascript" src="My1.js"></script>
<script type="text/javascript" src="My2.js"></script>
<script type="text/javascript" src="jquery.js"></script> 
```

我想隐藏定义，知道吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-22T02:54:44.740

您不能隐藏 HTML。如果您想要一个闭源解决方案，请使用专有格式，例如[Flash](http://en.wikipedia.org/wiki/Adobe_Flash)或[Flex](http://en.wikipedia.org/wiki/Adobe_Flex)。

但是，您可以混淆您的 JavaScript 代码（无论如何您都应该对其进行收缩包装或缩小），这会使阅读变得更加困难。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T02:54:59.997

您可以通过制作一个引用其他脚本的包含文件来将其限制为一个脚本标签。

除此之外，没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T02:58:40.833

在我看来，他想完全消除它，而不是混淆它。

话虽如此，选项 #2 是不使用包含，并将混淆的 javascript 放在他的 HTML 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-15T00:32:49.243

您也可以将脚本直接写入 DOM。这也不会消除它（并且编写脚本的脚本会在那里），但是用户必须使用 DOM 检查器（例如 Firebug）才能看到它；它不会通过“查看源代码”可见。

正如其他人所说，这只是混淆，只是将问题排除在外。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-08-07T14:12:01.900

在我上一个答案中，我误解了您隐藏代码的意思。

正如我们的其他朋友所说，没有办法从源代码中隐藏脚本。

但是如果你害怕有人想要窃取你的代码，你可以简单地编写你的 javascript 而不是隐藏它。

如果您需要一个工具来编写您的 Javascript，您可以使用：[Shell Tool Online](http://www.shell-tools.net/index.php?op=base64_enc)

并且可以安全地添加您的脚本。如果有人试图复制您的脚本，他们将一无所获。

我希望它有所帮助。

# c++ - C++ 中 const 的优点？

> ID：467899
> 
> 赞同：13
> 
> 时间：2009-01-22T02:53:36.770
> 
> 标签：c++, constants

对于外行来说，C++（和 C）中的[const](http://en.wikipedia.org/wiki/Const_correctness)有什么优势？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-22T02:58:53.610

const 对于传递给函数的指针或引用特别有用——它是一种立即可以理解的“API 契约”，函数不会更改传递的对象。

另见： http: [//www.parashift.com/c++-faq-lite/const-correctness.html#faq-18.4](http://www.parashift.com/c++-faq-lite/const-correctness.html#faq-18.4)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-22T02:57:59.383

当在函数中用作 const 引用时，它让*调用者*知道传入的东西不会被修改。

```
void f(Foo &foo, const Bar &bar) { ... } 
```

在这种情况下，调用者会知道`foo`可能会被修改，但`bar`不会。编译器将在编译 的主体时强制执行此操作`f()`，因此`bar`永远不会修改它，也永远不会传递给可能修改它的另一个函数。

使用 可以绕过所有上述保护措施`const_cast`，这就是为什么这样的演员被认为是“危险的”（或至少是可疑的）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-22T02:55:36.847

看起来很明显——它可以防止你修改不应该修改的东西。

编辑：要获得更多指导，请始终查看[Herb Sutter](http://www.gotw.ca/gotw/006.htm)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-22T03:31:26.117

我不太相信 const 的“安全”方面（有利也有弊）....但是，它确实允许的是某些语法，如果没有 const，您将无法做到

```
void blah(std::string& x)
{} 
```

只能采用 std::string 对象...但是，如果您将其声明为 const :-

```
void blah(const std::string& x) {} 
```

你现在可以做

```
blah("hello"); 
```

它将调用适当的构造函数来创建一个 std::string

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-22T04:04:42.230

此外，通过使用 const，您可以说明使用变量或参数的*意图*。这是一种很好的编程习惯（“ [C/C++ 编码风格和标准](http://www.shift-right.com/openrepo/codingstandard.htm)”，第 2.3 条）。

此外，通过避免使用#define 来定义常量并使用 const，您可以提高代码的类型安全性。 [C++ 编程实践指南](http://geosoft.no/development/cpppractice.html)- 项目 2.1

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-22T03:34:54.443

const 的契约方面对于编译器的优化器也很重要。使用某些 const 声明，涉及循环不变量的优化更容易被优化器发现。这就是 const_cast 真正危险的原因。

# sql - 如何在第三个查询中包含来自其他两个表的过滤行数？

> ID：467903
> 
> 赞同：1
> 
> 时间：2009-01-22T02:55:01.293
> 
> 标签：sql, mysql, rowcount

我有一个 MySql 数据库，其中包含三个需要在查询中组合的表：计划、注册和候补名单。他们正在实施一个基本的班级注册系统。

时间表包含预定的课程。当用户注册一个班级时，他们的用户帐户 id 和预定班级的 id 存储在注册中。如果某个班级已满员，则将它们存储在候补名单中。所有三个表共享一个 scheduleId 列，该列标识每个类。

当我查询日程表时，我还需要返回已注册和等待列表列，这些列表示已注册并等待特定 scheduleId 的用户数。

我提出的一个初步查询是：

```
select s.id, s.classDate, s.instructor, COUNT(e.id) as enrolled
from schedule as s
left outer join enrolled as e
on s.id = e.scheduleId
group by s.id 
```

这适用于其中一个或另一个，但显然我无法以这种方式获取已注册和候补表的值。任何人都可以建议这样做的好方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T03:16:55.023

使用嵌套的 SELECT 查询。假设您的架构有点，像这样的东西怎么样（可能不适用于某些 SQL 风格）：

```
select s.id, s.classDate, s.instructor, 
       (select COUNT(e.id) from enrolled e where e.scheduleId = s.id) as enrolled,
       (select COUNT(w.id) from waitlist w where w.scheduleId = s.id) as waiting
from schedule as s
group by s.id 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T04:56:04.777

我会用另一个左连接和两个内联计数（不同）来做到这一点

```
select s.id, s.classDate, s.instructor ,
count(distinct e.id) as enrolled,
count(distinct w.id) as waiting
from schedule as s
left outer join enrolled as e
on s.id = e.scheduleID
left outer join waitlist as w
on s.id = w.scheduleID
group by s.id 
```

当我运行这种方法与子查询相比时，它的执行速度大约是它的两倍，但我正在查看一个非常小的结果集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T03:10:53.117

两种快速方法：

1-`COUNT(DISTINCT e.id), COUNT(DISTINCT w.id)`用于获取每个表中唯一实例的数量，然后加入两者。这可能是非常低效的。

2- 在`FROM`子句中使用子查询（仅适用于 MySQL 5.0 及更高版本）：

```
SELECT s.id, s.classDate, s.instructor, tmpE.c AS enrolled, tmpW.c AS waiting
FROM
  schedule AS s,
  ( SELECT scheduleID, COUNT(*) AS c FROM enrolled GROUP BY scheduleID ) AS tmpE,
  ( SELECT scheduleID, COUNT(*) AS c FROM waiting GROUP BY scheduleID ) AS tmpW
WHERE
    s.id = e.scheduleID
    AND s.id = w.scheduleID
GROUP BY s.id 
```

不过，我可能错过了那里的左连接。

# c# - Windows服务器上的Hadoop

> ID：467911
> 
> 赞同：15
> 
> 时间：2009-01-22T02:58:02.580
> 
> 标签：c#, windows, hadoop, mapreduce, cluster-computing

我正在考虑使用 hadoop 在我现有的 windows 2003 服务器上处理大型文本文件（大约 10 台四核机器和 16gb 的 RAM）

问题是：

1.  有没有关于如何在 Windows 上配置 hadoop 集群的好教程？

2.  有什么要求？java + cygwin + sshd ？还要别的吗？

3.  HDFS，它在 Windows 上玩得好吗？

4.  我想在流模式下使用 hadoop。在 C# 中开发我自己的映射器/减速器有什么建议、工具或技巧吗？

5.  您使用什么来提交和监控作业？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-20T19:40:44.477

从[Hadoop 文档](http://hadoop.apache.org/core/docs/r0.19.0/quickstart.html#Supported+Platforms)：

> 支持 Win32 作为*开发平台*。分布式操作在Win32上没有经过很好的测试，所以不支持作为*生产平台*。

我认为这可以转化为：“你靠自己。”

[也就是说，根据Hadoop wiki](http://wiki.apache.org/hadoop/GettingStartedWithHadoop)的 Getting Started 页面，如果您对安装 Cygwin 和 Java shim 并不感到不安，那么可能会有希望：

> 也可以使用 Java 服务包装器将 Hadoop 守护程序作为 Windows 服务运行（单独下载）。这仍然需要安装 Cygwin，因为 Hadoop 需要其 df 命令。

我想底线是这听起来并非不可能，但你会一直逆流而上。我现在已经完成了一些 Hadoop 安装（在 Linux 上用于生产，Mac 上用于开发），当它在其他平台上如此简单时，我不会打扰 Windows。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-23T00:37:11.193

虽然不是您可能想听到的答案，但我强烈建议将机器重新用作 Linux 服务器，并在那里运行 Hadoop。您将受益于在该平台上执行的教程、经验和测试，并花时间解决业务问题而不是运营问题。

但是，您仍然可以使用 C# 编写作业。由于 Hadoop 支持“流”实现，因此您可以使用任何语言编写作业。使用 Mono 框架，您应该能够获取在 Windows 平台上编写的几乎任何 .NET 代码，并在 Linux 上运行相同的二进制文件。

您还可以相当轻松地从 Windows 访问 HDFS —— 虽然我不建议在 Windows 上运行 Hadoop 服务，但您当然可以从 Windows 平台运行 DFS 客户端来将文件复制进和复制出分布式文件系统。

对于提交和监控作业，我认为您主要是靠自己……我认为目前还没有为 Hadoop 作业管理开发的任何好的通用系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-16T01:57:26.493

如果您正在寻找 map/reduce，您可以尝试查看在 windows 上运行的 MySpace 新的 map/reduce 框架[http://qizmt.myspace.com/](http://qizmt.myspace.com/)

# python - 在什么情况下应该在python中使用内置的'operator'模块？

> ID：467920
> 
> 赞同：52
> 
> 时间：2009-01-22T03:03:46.720
> 
> 标签：python, operators

我说的是这个模块： [http ://docs.python.org/library/operator.html](http://docs.python.org/library/operator.html)

来自文章：

> operator 模块导出一组用 C 实现的函数，对应于 Python 的内在运算符。例如，operator.add(x, y) 等价于表达式 x+y。函数名称是用于特殊类方法的名称；为方便起见，还提供了没有前导和尾随 __ 的变体。

我不确定我是否了解此模块的好处或目的。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-22T03:19:40.963

可能最流行的用法是 operator.itemgetter。给定一个`lst`元组列表，您可以通过以下方式按第 i 个元素排序：`lst.sort(key=operator.itemgetter(i))`

当然，您可以通过定义自己的键函数来在没有操作符的情况下做同样的事情，但是操作符模块使它稍微整洁一些。

至于其余的，python 允许一种函数式编程风格，因此它可以出现——例如，Greg 的 reduce 示例。

你可能会争辩说：“当我能做的时候，为什么我需要`operator.add`：`add = lambda x, y: x+y`？” 答案是：

1.  `operator.add`（我认为）稍微快一点。
2.  它使您或稍后查看代码的其他人更容易理解代码。他们不需要寻找 add 的定义，因为他们知道 operator 模块的作用。
3.  `operator.add`是可腌制的，而`lambda`不是。这意味着该函数可以保存到磁盘或在进程之间传递。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-01-22T03:15:07.103

一个例子是`reduce()`函数的使用：

```
>>> import operator
>>> a = [2, 3, 4, 5]
>>> reduce(lambda x, y: x + y, a)
14
>>> reduce(operator.add, a)
14 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-11-16T02:53:05.543

例如获取列表中成员为元组的列，按列排序：

```
def item_ope():
    s = ['h', 'e', 'l', 'l', 'o']
    print operator.getitem(s, 1)
    # e
    print operator.itemgetter(1, 4)(s)
    # ('e', 'o')

    inventory = [('apple', 3), ('banana', 2), ('pear', 5), ('orange', 1)]
    get_count = operator.itemgetter(1)
    print map(get_count, inventory)
    # [3, 2, 5, 1]

    print sorted(inventory, key=get_count)
    # [('orange', 1), ('banana', 2), ('apple', 3), ('pear', 5)] 
```

看一个更实际的例子，我们想按键或值对字典进行排序：

```
def dict_sort_by_value():
    dic_num = {'first': 11, 'second': 2, 'third': 33, 'Fourth': 4}

    # print all the keys
    print dic_num.keys()
    # ['second', 'Fourth', 'third', 'first']

    # sorted by value
    sorted_val = sorted(dic_num.items(), key=operator.itemgetter(1))
    # [('second', 2), ('Fourth', 4), ('first', 11), ('third', 33)]
    print sorted_val

    # sorted by key
    sorted_key = sorted(dic_num.items(), key=operator.itemgetter(0))
    print sorted_key
    # [('Fourth', 4), ('first', 11), ('second', 2), ('third', 33)] 
```

当我们想要获取最大值并且它是列表中的索引时的另一个示例：

```
def get_max_val_idx():
    lst = [1, 7, 3, 5, 6]
    max_val = max(lst)
    print max_val
    # 7
    max_idx = lst.index(max_val)
    print max_idx
    # 1

    # simplify it by use operator
    index, value = max(enumerate(lst), key=operator.itemgetter(1))
    print index, value
    # 1 7 
```

更多演示如下：

```
import operator

def cmp_fun():
    a, b = 5, 3
    print operator.le(a, b)
    # False
    print operator.gt(a, b)
    # True

def lst_ope():
    lst = [1, 2, 3]
    print operator.indexOf(lst, 2)
    # 1
    lst1 = [1, 2, 3, 2]
    print operator.countOf(lst1, 2)
    # 2

def cal_ope():
    lst1 = [0, 1, 2, 3]
    lst2 = [10, 20, 30, 40]
    print map(operator.mul, lst1, lst2)
    # [0, 20, 60, 120]

    print sum(map(operator.mul, lst1, lst2))
    # 200

    a, b = 1, 3
    print operator.iadd(a, b)
    # 4 
```

[从python 文档](https://docs.python.org/2/library/operator.html)中查看更多信息

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-07-01T10:58:31.157

当您需要将函数作为参数传递给某物时，该模块很有用。然后有两个选项：使用`operator`模块，或定义一个新函数（使用`def`或`lambda`）。如果你动态定义一个函数，如果你需要pickle这个函数，或者将它保存到磁盘或在进程之间传递它，这可能会产生问题。虽然`itemgetter`是可腌制的，但动态定义的函数（带有`def`或`lambda`）不是。在以下示例中，用表达式替换`itemgetter`将`lambda`导致`PicklingError`.

```
from operator import itemgetter

def sort_by_key(sequence, key):
    return sorted(sequence, key=key)

if __name__ == "__main__":
    from multiprocessing import Pool

    items = [([(1,2),(4,1)], itemgetter(1)),
             ([(5,3),(2,7)], itemgetter(0))]

    with Pool(5) as p:
        result = p.starmap(sort_by_key, items)
    print(result) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-07-21T18:53:13.823

一般来说，这个模块的目的（正如上面的一些答案所暗示的）是为您提供罐头函数，用于简单的操作，否则您必须自己编写并传递给高阶函数，例如`sort()`or `reduce()`。

例如，如果没有运算符，要对列表中的数字求和，您必须执行以下操作：

```
from functools import reduce

l = list(range(100))
f = lambda x, y: x + y
result = reduce(f, l)
print(result) 
```

使用 operator 模块，您可以`add()`像这样使用它的功能：

```
from operator import add

result = reduce(add, l)
print(result) 
```

从而避免了创建 lambda 表达式的需要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-18T09:23:33.127

我不记得确切的用例，但我在某个地方有一个需要动态进行一些计算的需求，这可能会使用不同的运算符，具体取决于它的来源。

一个非常简单的例子是这样的：

```
import operator

def add_or_subtract(x, y, op):
    return op(x, y)

x = 3
y = 10
o = operator.add #operator.sub

add_or_subtract(x, y, o) 
```

# python - 对正在运行的 Python 应用程序进行示例

> ID：467925
> 
> 赞同：3
> 
> 时间：2009-01-22T03:07:25.417
> 
> 标签：python, performance, sample

我习惯于对基于 C 的应用程序进行采样，每隔几毫秒就会看到当时正在调用什么函数堆栈。

这让我可以看到大部分时间花在应用程序上的地方，以便我对其进行优化。

然而，在使用 python 时，sample 并没有太大帮助，因为它采样的是 python 解释器的 C 函数，而不是 python 代码本身。

python有没有有用的采样工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T03:11:30.323

Python 包含一组内置的[分析工具](http://docs.python.org/library/profile.html)。特别是，您可以从命令行对任意 python 脚本运行 cProfile：

```
$ python -m cProfile myscript.py 
```

通过直接调用 API 可以获得更精细的用法。请注意，cProfile 模块是在 Python 2.5 中添加的。在早期版本中，您可以使用纯 Python，但速度较慢的“配置文件”模块。

# html - 单击时如何使缩略图显示全尺寸图像？

> ID：467927
> 
> 赞同：15
> 
> 时间：2009-01-22T03:09:13.980
> 
> 标签：html, image, tags

通常，您有一个图像标签，其中**src**作为图像的来源，**alt**作为替代文本：

```
<img src="image1.gif" alt="Image 1" /> 
```

你能有类似的东西吗？：

```
<img src="image1.gif" alt="image2.gif" /> 
```

这意味着**src**有一个图像源，而**alt**也有一个图像源。

我想要做的是使用 flickr api（拇指图像和正常大小的图像）从 flickr 中提取 2 个图像，当用户单击拇指时，会显示正常大小的图像。

我尝试过这样的事情：

```
<a href="image2.gif" ><img src="image1.gif"/></a> 
```

...但我得到默认的“[未找到](https://stackoverflow.com/users/50214/geowa4)”图像作为拇指（即使图像确实存在）。

我正在使用 JQuery/Javascript。

欢迎和赞赏任何帮助、建议甚至替代方案。

谢谢

* * *

谢谢山姆的回复，

我不喜欢灯箱，因为我觉得它太慢太花哨。

但我喜欢[geowa4](https://stackoverflow.com/users/50214/geowa4)的想法。

但请保持你的答案...

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-22T04:57:06.647

这

```
<a href="image2.gif" ><img src="image1.gif"/></a> 
```

技术一直对我有用。我在超级碗日记中使用它效果很好，但我发现我使用的脚本被破坏了。修复它们后，我将在 URL 中进行编辑。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-22T03:13:52.567

`alt`是当图像无法加载或用户的浏览器不支持图像时显示的文本（例如盲人阅读器）。

尝试使用灯箱之类的东西：

[http://www.lokeshdhakar.com/projects/lightbox2/](http://www.lokeshdhakar.com/projects/lightbox2/)

更新：这个库可能更好，因为它基于 jQuery，你说过你使用 [http://leandrovieira.com/projects/jquery/lightbox/](http://leandrovieira.com/projects/jquery/lightbox/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-22T03:19:54.283

```
<img src='thumb.gif' onclick='this.src="full_size.gif"' /> 
```

当然，您可以更改 onclick 事件以将图像加载到您想要的任何位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T03:18:17.503

这不会做你所期望的：

```
<img src="image1.gif" alt="image2.gif" /> 
```

ALT 属性是纯文本的——如果你给它一个图像 URL，它不会做任何特别的事情。

如果您想最初显示低分辨率图像，然后用高分辨率图像替换它，您可以执行一些 javascript 编码来换出图像。或者，也许将图像加载到具有填充低分辨率图像的背景图案的 div 中。然后，当高分辨率图像加载时，它将加载到背景之上。

不幸的是，没有直接的方法可以做到这一点。

您的第二次尝试将创建一个指向 image2 的链接，但实际上显示的是 image1。

```
<a href="image2.gif" ><img src="image1.gif"/></a> 
```

如果您想弹出更高的分辨率版本，@Sam 的建议是个好主意。

* * *

这个 CSS 可能对你有用（它在 Firefox 3 中对我有用）：

```
<html>
<head>
    <style>
        .lowres { background-image: url('low-res.png');}
    </style>
</head>
<body>
    <div class="lowres" style="height:500px; width:500px">
        <img src="hi-res.png" />
    </div>
</body>
</html> 
```

在该示例中，您必须将 div 高度/宽度设置为图像的高度/宽度。它实际上会同时加载两个图像，但假设低分辨率的图像加载速度很快，您可能会在下载高分辨率图像时首先看到它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T04:06:15.610

一种无脚本、仅 CSS 的实验方法，带有图像预加载^(奖励！)并且仅适用于 Firefox：

```
<style>
a.zoom .full { display: none; }
a.zoom:active .thumb { display: none; }
a.zoom:active .full { display: inline; }
</style>

<a class="zoom" href="#">
<img class="thumb" src="thumbnail.png"/>
<img class="full" src="fullsize.png"/>
</a> 
```

默认显示缩略图。单击并按住鼠标按钮时显示全尺寸图像。释放按钮后立即返回缩略图。我绝不建议使用这种方法。它只是一个纯 CSS 方法的演示，[非常] 部分解决了问题。通过一些 z-index + 相对位置调整，它也可以在其他浏览器中工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-03T11:46:52.553

这是 LightBox 的 Angular 版本。太棒了:)

*注意：我已经给出了这个答案，因此标签下没有提到任何 Js 库。*

**[角引导灯箱](https://github.com/compact/angular-bootstrap-lightbox)**

```
<ul ng-controller="GalleryCtrl">
  <li ng-repeat="image in images">
    <a ng-click="openLightboxModal($index)">
      <img ng-src="{{image.thumbUrl}}" class="img-thumbnail">
    </a>
  </li>
</ul> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-13T07:08:54.063

以此为例

[https://www.w3schools.com/jquerymobile/tryit.asp?filename=tryjqmob_popup_image](https://www.w3schools.com/jquerymobile/tryit.asp?filename=tryjqmob_popup_image)

```
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
</head>
<body>

<div data-role="page">
  <div data-role="header">
    <h1>Welcome To My Homepage</h1>
  </div>

  <div id="pageone" data-role="main" class="ui-content">
    <p>Click on the image to enlarge it.</p>
    <p>Notice that we have added a "back button" in the top right corner.</p>
    <a href="#myPopup" data-rel="popup" data-position-to="window">
    <img src="https://lh3.googleusercontent.com/8XQPMmZImaDsSyEPbAptXOHQYZKP_rggu_tr9EPl3jpPnuXOd5gGP5kQKqFT0ZLXQ36-=s136" alt="Skaret View" style="width:200px;"></a>

    <div data-role="popup" id="myPopup">
      <p>This is my picture!</p> 
      <a href="#pageone" data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a><img src="https://lh3.googleusercontent.com/8XQPMmZImaDsSyEPbAptXOHQYZKP_rggu_tr9EPl3jpPnuXOd5gGP5kQKqFT0ZLXQ36-=s136" style="width:800px;height:400px;" alt="Skaret View">
    </div>
  </div>

  <div data-role="footer">
    <h1>Footer Text</h1>
  </div>
</div> 

</body>
</html>
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-22T03:17:25.397

这种功能需要一些 Javascript，但可能只使用 CSS（在 IE6 和 7 以外的浏览器中）。

# linker - 64 位 Ubuntu 上的 PhysX 链接器问题

> ID：467934
> 
> 赞同：2
> 
> 时间：2009-01-22T03:13:48.307
> 
> 标签：linker, physics

我在让我的项目与 64 位机器上的 PhysX 库链接时遇到问题。它编译得很好。我使用了与我的 32 位机器上完全相同的设置（除了一些调试标志），它们的链接非常好。这是构建输出：

> g++ -L/usr/lib/PhysX/v2.8.1 -L/usr/lib -o"PhysXTest" ./main.o -lPhysXLoader -lglut
> 
> /usr/bin/ld：在搜索 -lPhysXLoader 时跳过不兼容的 /usr/lib/libPhysXLoader.so
> 
> /usr/bin/ld：在搜索 -lPhysXLoader 时跳过不兼容的 /usr/lib/gcc/x86_64-linux-gnu/4.2.3/../../../../lib/libPhysXLoader.so
> 
> usr/bin/ld：在搜索 -lPhysXLoader 时跳过不兼容的 /usr/lib/../lib/libPhysXLoader.so
> 
> /usr/bin/ld：在搜索 -lPhysXLoader 时跳过不兼容的 /usr/lib/gcc/x86_64-linux-gnu/4.2.3/../../../libPhysXLoader.so
> 
> /usr/bin/ld：在搜索 -lPhysXLoader 时跳过不兼容的 /usr/bin/../lib/libPhysXLoader.so
> 
> /usr/bin/ld：在搜索 -lPhysXLoader 时跳过不兼容的 /usr/lib64/libPhysXLoader.so
> 
> /usr/bin/ld：在搜索 -lPhysXLoader 时跳过不兼容的 /usr/lib/libPhysXLoader.so
> 
> /usr/bin/ld: 找不到 -lPhysXLoader

另外，如果有任何后果，我已经设置了指向 usr/lib 的符号链接。有谁知道发生了什么？如果您需要更多详细信息，请告诉我。与往常一样，提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T07:45:06.230

正如 Robert Gould 所说，您不能将 32 位和 64 位对象或共享库链接在一起；它们根本不兼容链接。

由于您只有 32 位 PhysX，因此您*必须*`-m32`以 32 位模式（使用gcc 标志）编译将链接到可执行文件（示例中为 main.o）的所有其他代码，*并*安装 32 位版本的所有其他库（glut、libGL、libX11、libc 等）。

RedHat 让这一切变得简单——它们为所有东西提供 32 位和 64 位软件包，并将它们分成 /usr/lib32 和 /usr/lib64 ...

AFAICT，Ubuntu 没有：amd64 和 i386 软件包都包含 /usr/lib/libglut.so.3.8.0。您需要下载所有内容的 32 位版本，然后“手动”将它们安装到 /usr/lib32 而不是 /usr/lib 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T03:22:39.693

看起来您的 PhysiX 共享对象是用 32 位编译的。您不能将 32 位 .so 链接到 64 位应用程序，精灵是不同的。你下载了64位版本的库吗？我什至不确定 PhysX 是否支持 64 位。这不是我上次看的时候，但那是差不多 2 年前的事了。

**编辑：** PhysX 使用了一些严重的数组处理和组装以及其他非常低级的内存技巧，这些技巧依赖于 32 位架构。要让它在 64 位上运行需要大量的工作。现在，由于他们针对的是主机游戏制造商（他们真正的付费客户），而且还没有主机是 64 位的，而且他们可能需要一段时间才能发布 64 位版本，所以你将无法链接，即使你确实欺骗编译器链接它们，它会立即转储核心

# c - Linux上C中的标准输出线程安全？

> ID：467938
> 
> 赞同：45
> 
> 时间：2009-01-22T03:16:25.290
> 
> 标签：c, linux, unix, operating-system

`printf`在 Linux 上使用线程安全写入标准输出吗？使用较低级别的`write`命令怎么样？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-01-22T05:07:06.237

它不是由 C 标准指定的——它取决于您对 C 标准库的实现。事实上，C 标准甚至根本没有提到线程，因为某些系统（例如嵌入式系统）没有多线程。

在 GNU 实现 ( `glibc`) 中，stdio 中处理对象的大多数高级函数`FILE*`都是线程安全的。`unlocked`名字中通常没有的那些（例如`getc_unlocked(3)`）。但是，线程安全是在每个函数调用级别：`printf(3)`例如，如果您对 进行多次调用，则每个调用都保证以原子方式输出，但其他线程可能会在您对 的调用之间打印出一些内容`printf()`。如果您想确保一系列 I/O 调用以原子方式获得输出，您可以在它们周围加上一对`flockfile(3)/funlockfile(3)`锁定`FILE`句柄的调用。请注意，这些函数是可重入的，因此您可以安全地`printf()`在它们之间调用，即使认为`printf()`自己调用`flockfile()`.

低级 I/O 调用（例如`write(2)`应该是线程安全的），但我不能 100% 确定这一点 -`write()`对内核进行系统调用以执行 I/O。这究竟是如何发生的取决于您使用的内核。它可能是旧系统上的`sysenter`指令或`int`（中断）指令。一旦进入内核，就由内核来确保 I/O 是线程安全的。在我刚刚对 Darwin Kernel Version 8.11.1 进行的测试中，它`write(2)`似乎是线程安全的。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2010-07-26T13:54:51.690

您是否将其称为“线程安全”取决于您对线程安全的定义。POSIX 要求函数使用锁定，因此如果您从多个线程同时`stdio`使用，您的程序不会崩溃、破坏`FILE`对象状态等。~~但是，所有操作都是根据对~~~~and~~~~的重复调用正式指定的~~~~，因此无法保证更大规模的原子性。~~~~也就是说，如果线程 1 和 2 尝试同时打印~~~~，~~~~则不能保证输出是~~~~or 或~~~~。~~~~它也可以是~~`printf`~~`stdio``fgetc``fputc``"Hello\n"``"Goodbye\n"``"Hello\nGoodbye\n"``"Goodbye\nHello\n"``"HGelolodboy\ne\n"`. 在实践中，大多数实现将为整个更高级别的写入调用获取单个锁，仅仅是因为它更有效，但您的程序不应该这样假设。可能存在不这样做的极端情况；例如，一个实现可能会完全忽略对无缓冲流的锁定。~~

**编辑：**上面关于原子性的文字不正确。POSIX 保证所有`stdio`操作都是原子的，但保证隐藏在以下文档中`flockfile`： http: [//pubs.opengroup.org/onlinepubs/9699919799/functions/flockfile.html](http://pubs.opengroup.org/onlinepubs/9699919799/functions/flockfile.html)

> 所有引用 ( FILE *) 对象的函数的行为就像它们在内部使用flockfile() 和funlockfile() 来获得这些( FILE *) 对象的所有权一样。

您可以自己使用`flockfile`、`ftrylockfile`和`funlockfile`函数来实现大于单个函数调用的原子写入。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-01-22T03:20:29.807

它们都是线程安全的，以至于如果多个线程在同一个文件描述符上调用它们，您的应用程序不会崩溃。但是，如果没有一些应用程序级别的锁定，任何写入的内容都可以交错。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-12-13T21:56:20.483

自从提出这个问题（并最后回答）以来，C 得到了一个新标准。

C11 现在带有多线程支持并解决了流的多线程行为：

> **§7.21.2 流**
> 
> **¶7**每个流都有一个关联的锁，用于***防止***多个执行线程访问流时的数据竞争，并限制多个线程执行的流操作***的交错。***一次只能有一个线程持有这个锁。锁是可重入的：单个线程可以在给定时间多次持有锁。
> 
> **¶8**所有读取、写入、定位或查询流位置的函数在访问流之前都会锁定流。当访问完成时，它们会释放与流关联的锁。

因此，使用 C11 线程的实现必须保证 using`printf`是线程安全的。

乍一看，是否保证原子性（如没有交错^([1](https://stackoverflow.com/a/3335444/1257035)) *）对我来说并不是那么清楚，因为该标准谈到了限制*交错，而不是*防止*它强制要求数据竞争。

我倾向于保证它。该标准谈到了*限制*交织，因为仍然允许发生一些不改变结果的交织；*例如* `fwrite`，一些字节，`fseek`再返回一些，`fwrite`直到原始偏移量，这样两个`fwrite`s 都是背靠背的。该实现可以自由地重新排序这 2 个`fwrite`并将它们合并到一个写入中。

* * *

[1 ：例如，请参阅](https://stackoverflow.com/a/3335444/1257035)[R.. 的答案](https://stackoverflow.com/a/3335444/1257035)中的删除线文本。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-22T03:19:56.797

它是线程安全的；printf 应该是可重入的，你不会在你的程序中造成任何奇怪或损坏。

您不能保证一个线程的输出不会在另一个线程的输出中途开始。如果您关心这一点，则需要开发自己的锁定输出代码以防止多次访问。

# c# - 将两个形状连接在一起，Silverlight 2

> ID：467951
> 
> 赞同：4
> 
> 时间：2009-01-22T03:21:02.880
> 
> 标签：c#, wpf, silverlight, expression

我正在寻找用一条线将两个形状或对象连接或粘合在一起。这些形状将动态生成，这意味着我将在后端调用 Web 服务来确定需要创建多少对象/形状。一旦确定了这一点，我需要将对象/形状连接在一起。

方法签名可能如下所示（类似于 Visio 的绘图功能）：

```
GlueTogether(objButton1, objButton2); 
```

我可能需要获取每个 Rectangle 形状或 Button 的位置来确定起始 Line 点的位置。然后确定第二个形状/对象的位置来画线。

任何帮助或建议都会很棒！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-22T07:10:05.223

1.  在堆叠顺序或 z 索引中使用形状下方的路径或线条
2.  使用 instance.TransformToVisual() 获取每个形状的变换
3.  使用变换来变换每个形状的中心点
4.  在两个中心点之间画一条线。

* * *

```
var transform1 = shape1.TransformToVisual(shape1.Parent as UIElement);
var transform2 = shape2.TransformToVisual(shape2.Parent as UIElement);

var lineGeometry = new LineGeometry()
{
  StartPoint = transform1.Transform(new Point(shape1.ActualWidth / 2, shape1.ActualHeight / 2.0)),
  EndPoint = transform2.Transform(new Point(shape2.ActualWidth / 2.0,    shape2.ActualHeight / 2.0))
};

var path = new Path()
{
Data = lineGeometry
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-14T14:31:09.700

我正在尝试相同的方法，但不是从一个中心到另一个中心的线，我希望这些线停在两个形状的边缘。特别是我在线条的末端有箭头，箭头需要停在形状的边界处，而不是在形状的内部/后面到达它的中心。

我的形状是一个带有网格和矩形的用户控件，以及一些标签和其他东西。我找不到任何方法可以为我提供形状边缘的几何形状（圆角矩形）。

我想出了一个解决方案，它使用边界框和交点通过线在其近似边缘处连接我的元素，并且使用箭头结束的线对我来说效果很好。

请参阅[通过一条线连接两个 WPF 画布元素，而不使用锚点？](https://stackoverflow.com/questions/1737509/connecting-two-wpf-canvas-elements-by-a-line-without-using-anchors/1737536#1737536)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-24T11:33:15.810

看看这个： http: [//www.graphspe.com/Main.aspx#/Solution/graphviz-xaml-renderer](http://www.graphspe.com/Main.aspx#/Solution/graphviz-xaml-renderer)

您所要做的就是将 printf 打印到一个字符串，然后您就可以得到 Silverlight[2|3] 图。

采洪

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-14T17:53:23.657

此外......我没有连接到对象的中心点，而是将 Michael S. 的相同代码修改为：

```
var lineGeometry = new LineGeometry()
{
    StartPoint = transform1.Transform(new Point(1 , b1.ActualHeight / 2.0)),
    EndPoint = transform2.Transform(new Point(b2.ActualWidth , b2.ActualHeight / 2.0))
}; 
```

这将在每个对象的外部连接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-25T16:54:33.223

我正在使用上面的代码来绘制两个按钮，我想要在这两个按钮之间有一条线，但我得到的只是两个看起来像小圆圈并且没有线的按钮。

代码：

```
Button b1 = new Button();
Button b2 = new Button();
canvas1.Children.Add(b1);
canvas1.Children.Add(b2);
Canvas.SetLeft(b1, 300);

var transform1 = b1.TransformToVisual(b1.Parent as UIElement);
var transform2 = b2.TransformToVisual(b2.Parent as UIElement);

var lineGeometry = new LineGeometry()
{
    StartPoint = transform1.Transform(new Point(1, b1.ActualHeight / 2.0)),
    EndPoint = transform2.Transform(new Point(b2.ActualWidth, b2.ActualHeight / 2.0))
};

var path = new Path()
{
    Data = lineGeometry
};

canvas1.Children.Add(path); 
```

# sharepoint - 如何使用来自连接查询的数据在 Sharepoint 中创建数据视图？

> ID：467952
> 
> 赞同：5
> 
> 时间：2009-01-22T03:21:08.587
> 
> 标签：sharepoint, dataview

我在 Sharepoint 中有 3 个列表。

我想创建一个连接 3 个表的数据视图。

Table1 与 FieldA 上的 Table2 连接 表 2 与 FieldB 上的 Table3 连接

Table1 在 FieldA 中有重复的值，所以我只需要返回一个值来加入 Table2。

在 Access 中，我的查询如下所示：SELECT DISTINCT WRK_InputWorkOrders.WorkOrder, Production1.[Part Number], Production1.[Work Order], Production1.Location, StationItems.Station, Production1.Description, Production1.Revision, WRK_InputWorkOrders.Status FROM StationItems INNER JOIN (WRK_InputWorkOrders INNER JOIN Production1 ON WRK_InputWorkOrders.WorkOrder = Production1.[Work Order]) ON StationItems.Item = Production1.[Part Number] WHERE (((WRK_InputWorkOrders.Status)<>"已关闭"));

有没有办法为数据视图编写类似 sql 的查询？

我有 Sharepoint Designer 2007 和 Access。

目标是获取用户可以在 Internet Explorer 中查看的报告。我试过使用[这种](http://office.microsoft.com/en-us/sharepointdesigner/HA100991441033.aspx)方法。但它返回重复的记录，我发现[了这个](http://blogs.msdn.com/timpash/archive/2005/11/23/XPATH-Filtering-Distinct-Values.aspx)建议。它建议不要使用 XPath 过滤器（@yourvalue = previous-sibling::dfs:YourRepeatingRowName/@yourvalue）

但无法让它工作。我不知道作为 YourRepeatingRowName 输入什么

我找到[了这个](http://blogs.msdn.com/sharepointdesigner/archive/2007/04/24/spdatasource-and-rollups-with-the-data-view.aspx)链接。有谁知道它是否可以用来执行这样的加入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T21:13:59.047

您的问题更像是 ADO.NET 问题。不幸的是，ADO.NET 没有简单的方法来做到这一点，这就是为什么像竹解决方案这样的公司构建他们的交叉列表 Web 部件： [http ://store.bamboosolutions.com/pc-42-1-cross-list-web-零件.aspx](http://store.bamboosolutions.com/pc-42-1-cross-list-web-part.aspx)

否则我会尝试使用 LINQ 来查询表。你这样做可能会有更多的运气。

下面是 MS 提供的 JOIN 查询示例（我只更改了前两行 DataTable 以表示用 SPListItemCollection 对象填充 DataTable）

```
DataTable orders = spListCol1.ToDataTable();
DataTable details = spListCol2.ToDataTable();

var query =
    from order in orders.AsEnumerable()
    join detail in details.AsEnumerable()
    on order.Field<int>("SalesOrderID") equals
        detail.Field<int>("SalesOrderID")
    where order.Field<bool>("OnlineOrderFlag") == true
    && order.Field<DateTime>("OrderDate").Month == 8
    select new
    {
        SalesOrderID =
            order.Field<int>("SalesOrderID"),
        SalesOrderDetailID =
            detail.Field<int>("SalesOrderDetailID"),
        OrderDate =
            order.Field<DateTime>("OrderDate"),
        ProductID =
            detail.Field<int>("ProductID")
    };

DataTable orderTable = query.CopyToDataTable(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T17:40:52.533

微软有一个视频演示和一篇文章，可能正是你想要的：

在单个数据视图中显示来自多个来源的数据 [http://office.microsoft.com/en-us/sharepointdesigner/HA103511401033.aspx](http://office.microsoft.com/en-us/sharepointdesigner/HA103511401033.aspx)

*使用 Microsoft Office SharePoint Designer 2007，您可以链接两个或多个包含相关数据的数据源，然后创建一个显示来自这些链接数据源的数据的数据视图。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T16:20:32.493

我发现这第三部分添加

> Enesys RS Data Extension 允许您从任何 SharePoint 列表中查询（检索、连接、合并...）数据，并使用结果来构建“Reporting Services”报告，就像您对任何其他数据源所做的那样。[http://www.enesyssoftware.com/](http://www.enesyssoftware.com/)

我无法使用它，因为我目前正在运行使用内部数据库的基本 Sharepoint 版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T07:35:53.923

想要在 SharePoint Designer 中显示查询结果？我相信，SPD 已经合并了数据源。调查一下。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T17:41:03.333

我做过类似的事情，但我无法使用数据视图。我最终编写了一个自定义 Web 部件来完成它。方法是：

1.  使用一个`SPQuery`对象`SPListItemCollection`为每个列表获取一个。使用 CAML 查询来限制返回的项目。
2.  使用`SPListItemCollection`对象的`GetDataTable()`方法检索`DataTable`每个列表的 ADO.NET 对象。
3.  将表添加到`DataSet`对象。
4.  创建表之间的关系。
5.  以您喜欢的方式渲染数据，使用`DataList`或`Repeater`其他方式。

这是一些显示粗略笔划的代码：

```
protected DataTable GetDataTableFromQuery(string camlQry, SPList theList) {
  SPQuery listQry = new SPQuery();  
  listQry.Query = camlQry;  
  SPListItemCollection listItems = theList.GetItems(listQry);  
  return listItems.GetDataTable();
}

protected void BuildDataSet() {  
  // get SPList objects for the lists in questions ... left as an exercise for the dev -- call them list1, list2, and list3  
  string camlQry = "the CAML necessary to retreive the ites from list1";  
  DataTable table1 = GetDataTable(camlQry, list1);  
  table1.TableName = "Table1";  
  camlQry = "the CAML necessary to retreive the ites from list2";  
  DataTable table2 = GetDataTable(camlQry, list2);  
  table1.TableName = "Table2";  
  camlQry = "the CAML necessary to retreive the ites from list3";  
  DataTable table3 = GetDataTable(camlQry, list3);  
  table1.TableName = "Table3";  

  // now build the DataSet
  DataSet ds = new DataSet();  
  ds.Tables.Add(table1);  
  ds.Tables.Add(table2);  
  ds.Tables.Add(table3);  
  ds.Relations.Add("Table1_2", ds.Tables["Table1"].Columns["FieldA"], ds.Tables["Table2"].Columns["FieldA"]);  
  ds.Relations.Add("Table2_3", ds.Tables["Table2"].Columns["FieldB"], ds.Tables["Table3"].Columns["FieldB"]);  

  // now you can do something with these, like store them in the web part class and bind them to repeaters in the web part's Render() method
} 
```

# ruby - 如何确定指定方法源自的类？

> ID：467965
> 
> 赞同：7
> 
> 时间：2009-01-22T03:30:33.140
> 
> 标签：ruby

我从[这个讨论](https://stackoverflow.com/questions/466048/array-find-method-problem)中得到了这个问题。一个方法调用like`object.m`并不总是意味着“object”的类有一个“m”方法，就像对Array对象的find方法不是直接来源于Array对象，而是来源于混入的Enumerable模块。我的问题是，给定一个方法，我们如何确定该方法源自哪个类？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T06:28:57.990

任何类/对象方法都是 Ruby 中的对象，并且有一些它自己的方法。

所以你可以这样做：

```
[].method(:count).inspect
=> "#<Method: Array#count>"

[].method(:detect).inspect
=> "#<Method: Array(Enumerable)#detect>" 
```

快速一点 RegEx，你就完成了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-01T11:57:26.873

tobyhede 的回答很棒，但我只是做了一些研究，`irb`没有必要对`#inspect`. `Method`班级_

```
>> Object.new.method(:inspect)
=> #<Method: Object(Kernel)#inspect> 
```

有一些自己有用的方法：

```
>> Object.new.method(:inspect).methods - Object.methods
=> ["owner", "call", "to_proc", "unbind", "arity", "receiver", "[]"] 
```

特别是`#owner`返回所有者作为正确对象的方法：

```
>> [].method(:count).owner
=> Array
>> [].method(:detect).owner
=> Enumerable 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T06:11:02.987

也许你使用 caller() 给你回溯看看：

[http://www.ruby-doc.org/core/classes/Kernel.html#M005955](http://www.ruby-doc.org/core/classes/Kernel.html#M005955)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T06:25:25.050

我在想这样的事情可以工作

```
def print_ancestor_definitions(cl,method)
  ancestors = cl.ancestors
  p ancestors.join(' < ') #Print heirarchy
  p "Searching..."
  ancestors.each do |c|
    if c.instance_methods.include? method
      p "#{c} defines #{method} as an instance method!"
    elsif c.singleton_methods.include? method
      p "#{c} defines #{method} as a singleton method"
    else
      p "#{c} doesn't define #{method}"
    end
  end
end

print_ancestor_definitions(Array,'find')
# >> "Array < Enumerable < Object < Kernel"
# >> "Searching..."
# >> "Array defines find as an instance method!"
# >> "Enumerable defines find as an instance method!"
# >> "Object doesn't define find"
# >> "Kernel doesn't define find" 
```

我想最后一个拥有该方法的人是定义它的人？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T06:27:55.480

我不确定我们是否可以准确地找到方法的来源，当您包含一个 mixin 时，所有方法都会成为您的类的一部分，就好像您确实将它们放在那里一样。请参阅 dylanfm 的答案大约。

# data-structures - 你如何在数据结构中表示音乐？

> ID：467979
> 
> 赞同：11
> 
> 时间：2009-01-22T03:43:26.857
> 
> 标签：data-structures, music-notation

您将如何为以常规标准符号编写的单个乐器建模简单的乐谱？当然，有很多图书馆可以做到这一点。我主要对在数据结构中表示音乐的不同方式感到好奇。什么效果好，什么效果不好？

忽略动态等一些更棘手的方面，显而易见的方法是将所有内容字面翻译为对象 - 分数由测量组成，由注释组成。我想，合成意味着弄清楚每个音符的开始/结束时间并混合正弦波。

显而易见的方法是好方法吗？还有什么其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-31T06:49:13.720

许多从事新的常见西方音乐符号项目的人都使用 MusicXML 作为起点。它提供了乐谱的完整表示，您可以对其进行子集化以满足您的需求。现在有一个 XSD 模式定义，像 ProxyMusic 这样的项目用来创建 MusicXML 对象模型。ProxyMusic 在 Java 中创建这些，但您应该能够使用其他语言的其他 XML 数据绑定工具执行类似的操作。

正如一位 MusicXML 客户所说：

“就我而言，您在 MusicXML 上所做的所有辛勤工作的一个非常重要的好处是，我将它用作音乐‘是’的清晰、结构化和非常‘现实世界实用’的规范，以便设计和实现我的应用程序的内部数据结构。”

有更多可用信息 - XSD 和 DTD、示例文件、教程、支持的应用程序列表、出版物列表等 - 在

[http://www.makemusic.com/musicxml](http://www.makemusic.com/musicxml)

对于标准符号的简单乐谱，MIDI 不是一个很好的模型。MIDI 缺少许多乐谱的基本概念。它被设计为一种表演格式，而不是一种符号格式。

的确，音乐符号不是分层的。由于 XML 是分层的，MusicXML 使用成对的开始-停止元素来表示非分层信息。原生数据结构可以更直接地表示事物，这也是 MusicXML 只是数据结构起点的原因之一。

如需更直接的方式来表示同时捕捉其水平和垂直结构的音乐符号，请查看[Humdrum](http://musiccog.ohio-state.edu/Humdrum/)格式，它使用更多的电子表格/格子模型。Humdrum 特别用于音乐学和音乐分析应用程序，其数据结构工作得特别好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-22T04:16:09.630

MIDI 文件将是执行此操作的常用方法。MIDI 是一种标准格式，用于存储有关音符的数据，包括开始和结束时间、音符音量、演奏的乐器以及各种特殊特性；您可以找到大量用于读取和写入文件并以数组或对象表示其中的数据的预编写库（包括一些开源库），尽管它们通常不会通过为每个音符设置一个对象来做到这一点，这将增加了大量的内存开销。

MIDI 中定义的乐器只是从 1 到 128 的数字，它们具有象征性的名称，例如小提琴或小号，但 MIDI 本身并没有说明乐器的实际声音应该是什么样子。这就是合成器的工作，它将高级 MIDI 数据转换成声音。原则上，是的，您可以通过叠加正弦波来创建任何声音，但这在实践中效果不佳，因为一旦您并行播放几首曲目，它就会变得计算密集；此外，当您试图重现乐器的真实声音和演奏乐器的表现力时，简单的傅立叶频谱（正弦波的相对强度）是不够的。（我已经写了一个简单的合成器来做到这一点，所以我很难知道它可以产生一个不错的声音）那里'

此外，这可能仅与问题内容相关，但您可能对名为[ChuckK](http://chuck.cs.princeton.edu)的音频编程语言感兴趣。它是由处于编程和音乐十字路口的人们设计的，您可以通过玩弄它来很好地了解声音合成的当前状态。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-18T11:53:09.920

数据结构中的音乐，标准符号，......

听起来你会对[LilyPond](http://lilypond.org)感兴趣。

Most things about musical notation are almost purely mechanical (there are rules and guidelines even for the complex, non-trivial parts of notation), and LilyPond does a beautiful job of taking care of all those mechanical aspects. What's left is input files that are simple to write in any text editor. In addition to PDFs, LilyPond can also produce Midi files.

If you felt so inclined, you could generate the text files algorythimically with a program and call LilyPond to convert it to notation and a midi file for you.

I doubt you could find a more complete and concise way to express music than an input file for LilyPond.

**Please understand** that **music** and musical notation **is not hierarchical** and can't be modelled(well) by strict adherence to hierarchical thinking. [Read this](http://lilypond.org/web/about/automated-engraving/problem-statement) for mor information on that subject.

Have fun!

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T04:00:48.447

嗯，有趣的问题。

实际上，我很想将它与 Composite 一起变成命令模式。这有点颠覆了正常的 OO 方法，因为您在某种意义上使建模对象成为动词而不是名词。它会是这样的：

Note 是一个具有一种方法的类，`play(), and a ctor taking`长度`and`音调。

你需要一个仪器来定义合成器的行为：音色、起音等等。

然后你会得到一个分数，它有一个时间签名，是一个包含度量的复合模式；措施包含注释。

实际上玩它意味着解释一些其他的东西，比如重复和尾声，它们是其他容器。要播放它，您需要解释 Composite 的层次结构，将音符插入队列；当音符根据节奏在队列中移动时，每个音符都会`play()`调用其方法。

嗯，可能会颠倒过来；每个音符都作为仪器的输入，仪器通过根据需要合成波形来解释它。这又回到了你原来的计划。

分解的另一种方法是应用帕纳斯定律：分解是为了保留需求可能发生变化的秘密位置。但我认为最终会出现类似的分解；你可以改变拍号和调音，你可以改变乐器——一个音符不管你是在小提琴、钢琴还是马林巴琴上演奏。

有趣的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-22T04:02:46.633

我的音乐创作软件（请参阅我的个人资料以获取链接）使用音符作为主要单位（具有起始位置、长度、音量、平衡、释放持续时间等属性）。音符被分组为 Patterns（有自己的起始位置和重复属性），这些 Patterns 被分组为 Tracks（有自己的乐器或乐器）。

混合正弦波是合成声音的一种方法，但它非常罕见（它很昂贵而且听起来不太好）。波表合成（我的软件使用）计算成本低且相对容易编码，并且它可以产生的各种声音基本上是无限的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-31T09:04:58.807

The usefulness of a model can only be evaluated within a given context. What is it you are trying to do with this model?

Many respondents have said that music is non-hierarchical. I sort of agree with this, but instead suggest that music can be viewed hierarchically from many different points of view, each giving rise to a different hierarchy. We may want to view it as a list of voices, each of which has notes with on/off/velocity/etc attributes. Or we may want to view it as vertical sonorities for the purpose of harmonic analysis. Or we may want to view it in a way suitable for contrapuntal analysis. Or many other possibilities. Worse still, we may want to see it from these different points of view for a single purpose.

Having made several attempts to model music for the purposes of generating species counterpoint, analysing harmony and tonal centers, and many other things, I have been continuously frustrated by music's reluctance to yield to my modelling skills. I'm beginning to think that the best model may be relational, simply because to a large extent, models based on the relational model of data strive not to take a point of view about the context of use. However, that may simply be pushing the problem somewhere else.

# python - 将通用图像字段添加到 django 中的 ModelForm

> ID：467985
> 
> 赞同：3
> 
> 时间：2009-01-22T03:45:49.053
> 
> 标签：python, django, django-forms

我有两个模型，`Room`和`Image`。 `Image`是一个通用模型，可以附加到任何其他模型上。我想在用户发布有关房间的信息时为用户提供一个表单来上传图像。我已经编写了有效的代码，但恐怕我已经以一种艰难的方式完成了它，特别是以违反 DRY 的方式。

希望对django表单更熟悉的人能指出我哪里出错了。

**更新：**

我试图澄清为什么我在对当前答案的评论中选择了这个设计。总结一下：

我并没有简单地`ImageField`在`Room`模型上放置一个，因为我想要多个与 Room 模型相关联的图像。我选择了一个通用的 Image 模型，因为我想将图像添加到几个不同的模型中。我考虑的替代方案是单个`Image`类上的多个外键，这看起来很混乱，或者多个`Image`类，我认为这会使我的架构混乱。我在第一篇文章中没有说清楚，对此我深表歉意。

看到到目前为止没有一个答案解决了如何使这个更干燥的问题，我确实提出了自己的解决方案，即将上传路径作为类属性添加到图像模型上，并在每次需要时引用它。

```
# Models
class Image(models.Model):
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    content_object = generic.GenericForeignKey('content_type', 'object_id')
    image = models.ImageField(_('Image'),
                                height_field='',
                                width_field='',
                                upload_to='uploads/images',
                                max_length=200)
class Room(models.Model):
    name = models.CharField(max_length=50)
    image_set = generic.GenericRelation('Image') 

# The form
class AddRoomForm(forms.ModelForm):
    image_1 = forms.ImageField()

    class Meta:
        model = Room

# The view
def handle_uploaded_file(f):

    # DRY violation, I've already specified the upload path in the image model
    upload_suffix = join('uploads/images', f.name)
    upload_path = join(settings.MEDIA_ROOT, upload_suffix)
    destination = open(upload_path, 'wb+')
    for chunk in f.chunks():
        destination.write(chunk)
    destination.close()
    return upload_suffix

def add_room(request, apartment_id, form_class=AddRoomForm, template='apartments/add_room.html'):
    apartment  = Apartment.objects.get(id=apartment_id)

    if request.method == 'POST':
        form = form_class(request.POST, request.FILES)
        if form.is_valid():
            room = form.save()
            image_1 = form.cleaned_data['image_1']

            # Instead of writing a special function to handle the image, 
            # shouldn't I just be able to pass it straight into Image.objects.create
            # ...but it doesn't seem to work for some reason, wrong syntax perhaps?

            upload_path = handle_uploaded_file(image_1)
            image = Image.objects.create(content_object=room, image=upload_path)
            return HttpResponseRedirect(room.get_absolute_url())
    else:
        form = form_class()
    context = {'form': form, }
    return direct_to_template(request, template, extra_context=context) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T11:39:09.097

你为什么不直接使用`ImageField`？我不认为需要`Image`上课。

```
# model
class Room(models.Model):
    name = models.CharField(max_length=50)
    image = models.ImageField(upload_to="uploads/images/")

# form
from django import forms

class UploadFileForm(forms.Form):
    name = forms.CharField(max_length=50)
    image  = forms.FileField() 
```

查看[基本文件上传](http://docs.djangoproject.com/en/dev/topics/http/file-uploads/#basic-file-uploads)和[如何使用图像和文件字段？](http://docs.djangoproject.com/en/dev/faq/usage/#how-do-i-use-image-and-file-fields)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T12:12:45.270

您不必使用 Image 类。正如[DZPM](https://stackoverflow.com/users/30300/dzpm)建议的那样，将图像字段转换为 ImageField。您还需要对视图进行一些更改。

您可以使用上传的数据创建一个 Image 对象，并将 Image 对象附加到 Room 对象，而不是使用上传处理程序。

要保存 Image 对象，您需要在视图中执行以下操作：

```
from django.core.files.base import ContentFile

if request.FILES.has_key('image_1'):
    image_obj = Image()
    image_obj.file.save(request.FILES['image_1'].name,\
                        ContentFile(request.FILES['image_1'].read()))
    image_obj.save()
    room_obj.image_set.create(image_obj)
    room_obj.save() 
```

另外，我认为您应该使用 ManyToManyField 而不是 GenericRelation，在这种情况下，将图像添加到 Room 的语法会略有变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T08:28:03.543

在页面上使用两种形式怎么样：一种用于房间，一种用于图像？

您只需要使图像表单的通用外键字段不需要，并在保存房间后在视图中填写它们的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T08:38:50.193

Django 至少在一定程度上支持您的用例：

*   表单集显示重复的表单
*   模型表单集处理重复的模型表单
*   内联表单集将模型表单集绑定到实例的相关对象
*   *通用内联表单集*对通用关系做同样的事情

[在变更集 [8279]](http://code.djangoproject.com/changeset/8279)中引入了通用内联表单集。查看[单元测试的更改以](http://code.djangoproject.com/changeset/8279#file4)了解它们是如何使用的。

使用通用内联表单集，您还可以在表单中显示多个已保存的现有房间图像。

内联表单集似乎期望`instance=`参数中有一个现有的父实例。管理界面确实允许您在保存父实例之前填写内联，因此必须有一种方法来实现这一点。我自己从未尝试过。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-14T23:26:50.080

我发现这个页面寻找解决同样问题的方法。

这是我的信息-希望对一些人有所帮助。

模型：图像、评论、制造商、简介

我希望 Review、Manufacturer、Profile 与 Image 模型有关系。但是您必须能够为每个对象提供多个图像。（即，一个评论可以有 5 张图片，而不同的评论可以有 3 张，等等）

最初我做了一个

```
images = ManyToManyField(Image) 
```

在其他每个模型中。这很好用，但对管理员来说很糟糕（组合选择框）。不过，这可能是您的解决方案。我不喜欢我正在尝试做的事情。

我现在正在做的另一件事是拥有多个外键。

```
class Image(models.Model):
    description = models.TextField(blank=True)
    image = models.ImageField(upload_to="media/")
    user_profile = models.ForeignKey(UserProfile)
    mfgr = models.ForeignKey(Manufacturer)
    review = models.ForeignKey(Review) 
```

但就像你说的。这看起来很草率，我只是不喜欢它。

我刚刚发现的另一件事，但我的大脑并没有完全包裹（并且不确定实施后它有多透明是通用关系（或通用外键），这可能是一个解决方案。好吧，一旦我理解了这一切。需要更多的咖啡因。

[http://www.djangoproject.com/documentation/models/generic_relations/](http://www.djangoproject.com/documentation/models/generic_relations/)

让我知道您是否解决了这个问题或有任何帮助。谢谢！

让我知道这是否有帮助，或者您有不同的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-15T02:10:21.480

好的，我通过更多阅读找到了答案……我觉得您想做的正是我所做的，所以就在这里。

我将为此使用 GenericForeignKeys。

首先是进口`models.py`

```
from django.contrib.contenttypes.models import ContentType
from django.contrib.contenttypes import generic 
```

现在将以下内容添加到您的图像模型中

```
class Image(models.Model):
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    content_object = generic.GenericForeignKey() 
```

这让这个模型成为任意数量模型的通用外键。然后将以下内容添加到您想要拥有相关图像的所有模型中

```
images = generic.GenericRelation(Image) 
```

现在在 admin.py 中，您需要添加以下内容。

```
from django.contrib.contenttypes.generic import GenericTabularInline

class ImageInline(GenericTabularInline):
    model = Image
    extra = 3
    ct_field_name = 'content_type'
    id_field_name = 'object_id' 
```

然后将其包含在管理员声明中

```
class ReviewAdmin(admin.ModelAdmin):
    inlines = [ImageInline] 
```

就是这样。它在这里工作得很好。希望这对男人有帮助！。亚当。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-08T11:49:47.897

使用两种形式，一种用于房间，一种用于图像：

类图像（模型。模型）

```
content_type = models.ForeignKey(ContentType)
object_id = models.PositiveIntegerField()
content_object = generic.GenericForeignKey('content_type', 'object_id')
image = models.ImageField(upload_to='') 
```

类 UploadImage(forms.ModelForm):

```
class Meta:
    model = Image
    fields = ('image') 
```

教室（models.Model）：

```
name = models.CharField(max_length=50)
images = models.ManyToManyField(Image) 
```

类 RoomForm(forms.ModelForm):

```
class Meta:
    model = Room 
```

在视图中

如果 request.method == "POST":

```
 ##2 form, una per l'annuncio ed una per la fotografia
    form = RoomForm(request.POST)
    image_form = UploadImage(request.POST, request.FILES)
    #my_logger.debug('form.is_valid() : ' + str(form.is_valid()))
    if form.is_valid() and image_form.is_valid():
        ##save room
        room = room.save()

        ##save image
        image = image_form.save()

        ##ManyToMany
        room.images = [image]
        room.save() 
```

# c# - 在哪里可以找到免费的 C# 电子书？

> ID：467986
> 
> 赞同：20
> 
> 时间：2009-01-22T03:45:58.383
> 
> 标签：c#

有谁知道适合中级程序员的好（免费）C# 电子书？我想要一些涵盖泛型、线程、事件、委托等的东西。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-22T03:51:15.097

以下是一些开源书籍：

*   [C# 黄皮书](http://www.csharpcourse.com/)
*   [C Sharp 编程](http://en.wikibooks.org/wiki/C_Sharp_Programming)
*   [程序员的天堂C#教科书](http://www.programmersheaven.com/2/csharpbook)
*   [C#中的线程](http://www.albahari.com/threading/)
*   [C# 要点](http://www.techotopia.com/index.php/C_Sharp_Essentials)
*   [.NET 零书](http://www.charlespetzold.com/dotnet/)
*   [C# 中具有面向对象设计模式的数据结构和算法](http://www.brpreiss.com/books/opus6/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-22T03:52:29.400

我发现这两本书相当有用。

[The C# School Book](http://www.programmersheaven.com/2/CSharpBook) - 这本书几乎涵盖了您所询问的所有内容，尽管它有点过时了。

当然还有 Rob Miles 的[C# 黄皮书](http://www.robmiles.com/c-yellow-book/)**