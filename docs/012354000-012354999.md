# StackOverflow 问答 12354000-12354999

# python - Python 串行 readline 是否会中断 Arduino 循环？

> ID：12354003
> 
> 赞同：4
> 
> 时间：2012-09-10T14:40:50.060
> 
> 标签：python, arduino, delay

我正在尝试从与 Arduino 接口的传感器发布 Twitter 更新。Adruino 回路在读取传感器电压之间有 1 秒的延迟。Python 代码在 Twitter 更新之间有 1 小时的延迟。

似乎 Python 脚本实际上会*中断*Arduino 循环，直到它在串行端口上读取新行。它是否正确？

例如，尽管 Arduino 程序循环运行 1 小时，但它只会显示`millis()`计数器值 1001，2 小时后它将显示 2002。没有运行 Python 脚本并仅观察串行监视器，Arduino 代码计数毫秒正如预期的那样。

这通常不是问题，但如果您想同时运行数据记录器并`millis()`以高采集率连续运行，这将是一个问题。很难知道发生了什么，因为串行监视器不能与 Python 程序共享相同的端口。

这是 Arduino 代码的示例

```
void loop() {
    unsigned long ms=millis();
    // read the input on analog pin 1:
    int sensorValue = analogRead(A1);
    float Temp = sensorValue * Vref * (100.0/1023.0); 
    // print out the value you read:
    Serial.print(Temp); 
    Serial.print(" degC");
    Serial.print(" , ");
    Serial.print(ms);
    Serial.println(" milliseconds");
    delay(1000);        // delay in miliseconds between reads for stability
} 
```

这是有问题的 Python 代码部分：

```
arduino = serial.Serial('COM6', 9600)

while 1:  ##Infinite Loop
    status = arduino.readline() ##Wait for new line to come across Serial
    api.PostUpdate(status) ##Post message to Twitter
    time.sleep(3600) ##Wait 3600 seconds 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T14:52:52.793

`Serial.write`（以及任何依赖它的函数，例如`Serial.print`）如果输出缓冲区已满，则将阻塞。仅当另一端（即您的 Python 脚本或串行监视器）从端口读取时，才能耗尽输出缓冲区。

串行监视器不断读取串行端口输出，因此缓冲区不会填满。*但是，由于您的 Python 脚本每小时*只读取一行输出，因此缓冲区一直是满的。因为串行端口是缓冲的，所以每小时读取下一秒*的*输出。

这里发生的情况是，您的 Arduino 代码运行 10 次循环并在其缓冲区填满之前写入 10 行。您的 Python 代码将读取 10 行，每小时一次。10 小时后，Arduino 放入缓冲区的较新行将具有不同的时间戳。

因此，解决方案是从 Arduino 发送每小时更新（`arduino.readline`在 Python 中让阻塞一个小时）或从 Python 不断（每秒）读取更新并每小时触发您的 Twitter 更新（例如，使用两个线程，一个用于读取和更新温度，另一个使用最新的本地数据每小时发布一次更新）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:10:40.890

我会使用类似 twisted 的东西，它具有通过串行端口接收数据的非阻塞机制。（Twisted 有一个事件循环）当接收到数据时，一个注册的处理程序被调用，所以你不会得到完整的缓冲区和你正在经历的阻塞行为。

我用它来接收/发送数据到/从 arduino 和馈送 cosm。

您可以在此处查看示例[http://twistedmatrix.com/documents/current/core/examples/](http://twistedmatrix.com/documents/current/core/examples/)

# c++ - 图像拼接闭环

> ID：12354010
> 
> 赞同：0
> 
> 时间：2012-09-10T14:41:07.753
> 
> 标签：c++, image-processing, boost, opencv, image-stitching

我已经编写了一个 OpenCV 程序，用于在 C++ 中拼接航拍图像，这是通过计算这些图像的 Homography 并将“tobe”拼接图像变形为原始图像来完成的。

> 这个拼接过程是通过使用 SIFT 或 SURF 特征检测器、提取器计算这些图像中的特征点来完成的。
> 
> 我如何拼接多个图像的过程是通过迭代查找特征点来完成的，image1（缩放到 image2 的扭曲）+ 图像 2（扭曲）= imageStitch（组合/缝合）；（上面的结果）ImageStitch + image3 = imageStitch 等等！

我想知道通过了解图像特征点来检测“LOOP CLOSURE”的方式或方法。

我希望这很清楚谢谢你的回复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T17:53:35.883

您不能使用图像之间的单应性来关闭循环，因为单应性会将图像扭曲到单个平面。
您应该只使用 2D 旋转和 2D 平移，这相当于扭曲到圆柱体或球体的表面。

# sql - Oracle - 可以在 sum 函数中使用别名吗？

> ID：12354014
> 
> 赞同：1
> 
> 时间：2012-09-10T14:41:13.907
> 
> 标签：sql, oracle, sum

```
SELECT c.customer_name,
        sc.customer_id,
        SUM(
                (nvl(sc.year_1_new, 0) + nvl(sc.year_2_new, 0) + nvl(sc.year_3_new, 0) + 
                nvl(sc.year_4_new, 0) + nvl(sc.year_5_new, 0)) * sc.suggested_net
            ) AS ttl_new,
        SUM(
                (nvl(sc.year_1_nl, 0) + nvl(sc.year_2_nl, 0) + nvl(sc.year_3_nl, 0) + 
                nvl(sc.year_4_nl, 0) + nvl(sc.year_5_nl, 0)) * sc.suggested_net
            ) AS ttl_exist,
        SUM(ttl_new - ttl_exist) AS ttl_delta
FROM scenario_customers sc,
        customers c
WHERE sc.scenario_id = 10
        AND sc.customer_id = c.customer_id
GROUP BY sc.customer_id,
        c.customer_name
ORDER BY c.customer_name 
```

我希望能够从 ttl_exist col 中减去 ttl_new col，当我使用动态名称时出现错误，但如果只是将两个 sum 函数的全部内容粘贴到第三个 sum 函数中作品。所以只是想知道这是否可能，它肯定会更容易阅读。

**这适用于 Oracle 8i**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T14:47:34.393

大多数数据库的范围规则不允许您在同一 SELECT 语句中使用别名。您可以使用子查询来执行此操作：

```
select c.customer_name, sc.customer_id, ttl_new, ttl_exist, (ttl_new - ttl_exist) as ttl_delta
from (SELECT c.customer_name, sc.customer_id,
             SUM((nvl(sc.year_1_new, 0) + nvl(sc.year_2_new, 0) + nvl(sc.year_3_new, 0)  + nvl(sc.year_4_new, 0)  + nvl(sc.year_5_new, 0)) * sc.suggested_net) AS ttl_new, 
             SUM((nvl(sc.year_1_nl, 0) + nvl(sc.year_2_nl, 0) + nvl(sc.year_3_nl, 0) + nvl(sc.year_4_nl, 0) + nvl(sc.year_5_nl, 0)) * sc.suggested_net) AS ttl_exist
      FROM scenario_customers sc join
           customers c
           on sc.customer_id = c.customer_id
      WHERE sc.scenario_id = 10 
      GROUP BY sc.customer_id, c.customer_name
     ) t
ORDER BY c.customer_name 
```

我还修复了您的连接语法。

# vbscript - VBS 检查多个用户的应用程序数据文件夹

> ID：12354015
> 
> 赞同：0
> 
> 时间：2012-09-10T14:41:16.200
> 
> 标签：vbscript, userappdatapath

在我的工作中，我们有一个我们使用的应用程序 (Mikogo)，它安装到 App Data 文件夹中的用户目录中，而不是安装到 Program Files 文件夹中。

Mikogo 发布了更新，所以我想知道它安装在哪些计算机上，以便更新软件。为此，我想解析计算机列表并检查计算机上每个用户的 App Data 文件夹中是否存在“Mikogo 4”文件夹。

我知道如何解析计算机列表，我知道如何检查文件夹是否存在，我什至知道如何获取 App Data 文件夹的位置......我的问题是我不知道如何获取我当前正在检查的计算机上每个用户的 App Data 文件夹的位置。

有没有办法让我检查每个单独的 App Data 文件夹？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T17:06:18.927

这样的事情可能会做：

```
Const regProfilesDir = "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\ProfilesDirectory"
Const appDataDir     = "AppData\Roaming"

Set sh  = CreateObject("WScript.Shell")
Set fso = CreateObject("Scripting.FileSystemObject")

profilesDir = sh.ExpandEnvironmentStrings(sh.RegRead(regProfilesDir))

For Each user In fso.GetFolder(profilesDir).SubFolders
  If fso.FolderExists(fso.BuildPath(user.Path, appDataDir & "\Mikogo 4")) Then
    WScript.Echo "Application folder exists for user " & user & "."
  End If
Next 
```

但是，Vista 之前的 Windows 版本对 AppData 文件夹使用了不同的名称，并且该名称也已本地化。如果您的环境中有较旧的 Windows 版本，您也必须处理它。

# excel - Excel中的单引号和年份格式

> ID：12354024
> 
> 赞同：-1
> 
> 时间：2012-09-10T14:42:03.770
> 
> 标签：excel

如何`yy`从excel中的组合名称中删除单引号和？
例如，我想要：
`Francis B. and Edith Campbell`from`Francis B. '42 and Edith Campbell`
和
`Pimmett E. Dusharm`from`Pimmett E. Dusharm '42`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T14:49:53.830

如果年份始终是每个字符串的最后一个，您可以删除最后 4 个字符：

```
=LEFT(A2,LEN(A2)-4) 
```

另一种选择可能是简单地进行查找和替换以删除所有数字和单引号。

# android - 对话框启动时未调用 onKeyDown

> ID：12354026
> 
> 赞同：1
> 
> 时间：2012-09-10T14:42:21.760
> 
> 标签：android, android-dialog

我有一个带有自定义视图的对话框，当单击列表项时会弹出​​该对话框。我重写了`onKeyDown`我的活动的功能，以查看按下后退按钮时对话框是否已启动，但如果对话框已启动，`onKeyDown`则不会被调用。

如果我在对话框消失后点击后退按钮，它会被调用没有问题，但我需要知道在对话框处理时是否点击了后退按钮，如果我需要在设备旋转时重新弹出它。

我搜索了一下，似乎它与调用`setContentView`我的自定义对话框布局有关，但我没有找到的是如何`okKeydown`使用该对话框

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:13:32.853

对于对话框，我们有单独的 setOnKeyListener 所以尝试下面的代码和......你可以像我一样跟踪任何按键......

*   keyCode == KeyEvent.KEYCODE_CAMERA
*   keyCode == KeyEvent.KEYCODE_SEARCH 等。

    ```
     mProgressDialog.setOnKeyListener(new Dialog.OnKeyListener() {

                @Override
                public boolean onKey(DialogInterface dialog, int keyCode, KeyEvent event) {
                    if ((keyCode == KeyEvent.KEYCODE_CAMERA)) {
                        return true;
                    }
                    if ((keyCode == KeyEvent.KEYCODE_SEARCH)) {
                        return true;
                    }
                    return false;
                }
            }); 
    ```

# asp.net - 在 ASP.NET 4.0 中绘制折线图线

> ID：12354033
> 
> 赞同：2
> 
> 时间：2012-09-10T14:42:45.077
> 
> 标签：asp.net, charts

asp.net 图表总是绘制列，我想将我的数据表示为线条。但是，我在 asp.net 页面中添加了这段代码：

```
<asp:Series Name="Series1" XValueType="String" XValueMember="Date" YValueMembers="Utilization" IsValueShownAsLabel="True" YValueType="Auto" ChartType="Point" BorderWidth="5" Palette="BrightPastel"> </asp:Series> 
```

在 aspx.cs 中

```
chart1.Series["Series1"].ChartType = System.Web.UI.DataVisualization.Charting.SeriesChartType.Line; 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T14:44:46.230

我建议改用谷歌图表。他们有折线图以及许多其他图表[https://developers.google.com/chart/interactive/docs/gallery](https://developers.google.com/chart/interactive/docs/gallery)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T14:46:13.323

可以看看这篇文章： http: [//www.dotnettutorials.com/tutorials/charts/ms-chart-line-graph-cs.aspx](http://www.dotnettutorials.com/tutorials/charts/ms-chart-line-graph-cs.aspx)

或者我建议使用 ZedGraph。它非常灵活，我发现它易于使用。

[http://sourceforge.net/projects/zedgraph/](http://sourceforge.net/projects/zedgraph/)

本文向您展示了如何使用 ZedGraph，并且是帮助您入门的好方法。

[http://www.codeproject.com/Articles/5431/A-flexible-charting-library-for-NET](http://www.codeproject.com/Articles/5431/A-flexible-charting-library-for-NET)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-06T07:58:44.490

您只需更改属性中的设置：

1.  转到图表的属性
2.  转到系列
3.  单击“...”按钮
4.  转到图表 > 图表类型
5.  点击线

# java - DUPLICATE KEY UPDATE 上的 Derby JavaDB 查询

> ID：12354038
> 
> 赞同：3
> 
> 时间：2012-09-10T14:43:07.347
> 
> 标签：java, mysql, derby, javadb

我知道`MySQL`支持这个查询（`ON DUPLICATE KEY UPDATE`）例如：

```
INSERT INTO UserFailure (Realm, Username, DateOfFailure, CountOfFailure) VALUES (?,?,?,?) ON DUPLICATE KEY UPDATE CountOfFailure=?; 
```

当我在嵌入式上运行它时，`Derby DB`它给了我：

```
PreparedStatementCallback; bad SQL grammar [INSERT INTO UserFailure (Realm, Username, DateOfFailure, CountOfFailure) VALUES (?,?,?,?) ON DUPLICATE KEY UPDATE CountOfFailure=?;]; nested exception is java.sql.SQLSyntaxErrorException: Syntax error: Encountered "ON" at line 1, column 91. 
```

我假设`Derby`不支持此功能。

是否有一个查询可以用来更新来自`Derby`和来自重复键的数据库记录`MySQL`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T02:41:48.060

您可以自己捕获重复键异常，然后发出更新。

# android - 如何测试扩展文件而不在android市场上发布应用程序

> ID：12354039
> 
> 赞同：12
> 
> 时间：2012-09-10T14:43:06.327
> 
> 标签：android

我需要测试扩展文件而不在 android 市场上发布应用程序。我试图谷歌但没有找到任何方法来做到这一点。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-10T20:32:27.957

显然，您必须手动完成。检查[安卓文档](http://developer.android.com/google/play/expansion-files.html#Testing)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-09T06:27:10.213

是的，您可以使用以下说明测试扩展文件功能，而无需在 Android PlayStore 上发布您的应用程序：

> 因为您的应用程序有时必须在首次打开时手动下载扩展文件，所以测试此过程以确保您的应用程序可以成功查询 URL、下载文件并将它们保存到设备中，这一点很重要。
> 
> 要测试您的应用程序对手动下载过程的实现，您必须将您的应用程序作为“草稿”上传到 Google Play，以使您的扩展文件可供下载：
> 
> 1.  使用 Google Play 开发者控制台上传您的 APK 和相应的扩展文件。
> 2.  填写必要的应用程序详细信息（标题、屏幕截图等）。您可以在发布应用程序之前返回并最终确定这些详细信息。
> 3.  单击保存按钮。不要单击发布。这会将应用程序保存为草稿，这样您的应用程序就不会发布给 Google Play 用户，但您可以使用扩展文件来测试下载过程。使用 Eclipse 工具或 adb 在您的测试设备上安装应用程序。
> 4.  启动应用程序。
> 
> 如果一切正常，您的应用程序应该会在主要活动开始后立即开始下载扩展文件。

参考链接：[Android 文档](http://developer.android.com/google/play/expansion-files.html#TestingReading)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-24T19:29:33.047

> 对于那些阅读这篇文章的更新，您现在必须以 alpha 或 beta 模式发布您的 apk，然后扩展文件才能工作并且您可以测试您的应用程序。我还包括了一些可能会派上用场的信息。

**注1**

您不能再使用草稿，因为获取扩展文件的链接尚未激活。您必须先使用扩展文件将版本上传到 Alpha 或 Beta。（只能从您上传的第二个 apk 开始添加扩展文件）因此，请确保在单击 APK 下的开发者发布部分中的详细信息时看到列出的 apk 扩展文件。

**笔记2**

如果您使用的是 android studio 并且想要使用下载器库，请不要将包名和 java 文件复制到您自己的应用程序 src 目录中。在eclipse中导入下载器库，选择export => gradle build files。之后，您可以将库作为模块导入 android studio。

**注3**

不确定这一点，但我也认为有必要通过 Play 商店至少下载一次应用程序，并使用测试设备上的帐户访问它。因此，如果您正在使用 alpha，请创建一个 google+ 测试组并将您自己或其他测试设备添加到其中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-24T10:04:40.583

我进行了很多搜索，最后得出的结论是Android没有这种设施。:(

# android - 在 Android 上的 Google 地图中指明北方

> ID：12354040
> 
> 赞同：-1
> 
> 时间：2012-09-10T14:43:08.137
> 
> 标签：android, google-maps, orientation

问题是我制作了一个指示当前位置的覆盖图，但现在我希望覆盖图指示手机的方向，并通过单击它来旋转地图以指示方向（就像在谷歌地图应用程序中一样）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T14:51:04.050

检查这个问题[如何将指南针添加到地图视图](https://stackoverflow.com/questions/5750897/how-to-add-compass-to-mapview)及其答案

如有其他问题，请发布您迄今为止尝试过的内容。另外，请考虑谷歌。这个答案是查询“android add compass to mapview”的第一个结果

这现在可能正是您想要的，所以如果不是，请考虑更新您的问题以更好地解释。

还可以查看[Adding Compass to Rotate MapView](https://stackoverflow.com/questions/10177426/adding-compass-to-rotate-mapview)，那里有一个示例项目。

编辑：

[https://stackoverflow.com/a/753847/975959](https://stackoverflow.com/a/753847/975959) 这似乎回答了你的问题。

# .net - 在 MVC 中验证模型

> ID：12354042
> 
> 赞同：1
> 
> 时间：2012-09-10T14:43:08.357
> 
> 标签：.net, asp.net-mvc

> **可能重复：**
> [自定义验证属性 ASP.NET MVC](https://stackoverflow.com/questions/5483027/custom-validation-attribute-asp-net-mvc)

我设置了一个 Attribute.cs 文件和一个 Models.cs 文件。

在 Models.cs 中，我有：

```
[Required(ErrorMessage = "*")]
[Display(Name = "DOB")]
public DateTime DOB { get; set; }

[Required(ErrorMessage = "*")]
[Display(Name = "Age")]
[Range(7,12,ErrorMessage = "Age must be between 7-12")]
[DOB()]
public string Age { get; set; } 
```

我在 Attribute.cs 文件中创建了一个自定义验证（`DOB`函数）。

在该功能中，如何检查该`DOB`字段并自动分配年龄值？我不确定如何获取 DOB 值。

我的 attribute.cs 中有以下内容，当我在其中放置断点时，它可以很好地执行此功能：

```
namespace SF.Validation
{
    public class DOBAttribute : ValidationAttribute
    {
        public DOBAttribute(string dob)
        {
            //not sure how to grab DOB value?? Need to do it here.
            //this just validates user input, but need to change to automatically 
            //assign the age based on DOB
            DateTime now = DateTime.Today;
            int age = now.Year - DOB.Year; //DOB.Year isn't grabbing anything
            DateTime birthday = new DateTime(DOB.Year, DOB.Month, DOB.Day);

            if (now < birthday.AddYears(age)) age--;

            if (age < 7 || age > 12)
            {
                IsValid(false);
            }
            else
            {
                IsValid(true);
            }
        }

    }

} 
```

# c# - 在多对多数据库Sql Server的过渡表中添加项目和更新关系

> ID：12354046
> 
> 赞同：0
> 
> 时间：2012-09-10T14:43:16.330
> 
> 标签：c#, sql-server, entity-framework, many-to-many, entityobject

-- 这里是错误的模型，AB 之间没有关联 manyTOmany。更正的是在 EDIT2--

`A`存在于数据库中，`B`存在于数据库中。我只需要输入`C`带有一些 Properties1 和 Properties2 的新元素（并更新现有`C`元素的集合）`A``B`

我尝试了很多选项，例如这个，但仍然有问题（使用 ObjectOCntext 和存在的 Key 等）

```
void SaveNewC(C newC)
{
    using (var context = new MyEntities(connectionString))
    {
        var dbA = context.A.Where(a => a.Id == newC.A.Id).SingleOrDefault();
        var dbB = context.B.Where(b => b.Id == newC.B.Id).SingleOrDefault();

        newC.A = dbA;
        newC.B = dbB;
        context.AddObject(newC);

        context.SaveChanges();
    }
} 
```

**编辑**

我得到的例外：`"An object with the same key already exists in the ObjectStateManager. The ObjectStateManager cannot track multiple objects with the same key."`

**EDIT2** 更新模型

![在此处输入图像描述](../Images/3b4de7827d879176d54a057b256d04e1.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:41:52.427

显然您`newC`已经填充了导航属性`A`并`B`使用了正确`Id`的 s. 然后，您可以将导航属性引用的实体附加到上下文：

```
void SaveNewC(C newC)
{
    using (var context = new MyEntities(connectionString))
    {
        context.A.Attach(newC.A);
        context.B.Attach(newC.B);

        context.C.AddObject(newC);

        context.SaveChanges();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T14:45:13.477

```
context.Entry(dbA).State = EntityState.Unchanged;
context.Entry(dbB).State = EntityState.Unchanged;
context.AddObject(newC);
context.SaveChanges(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T13:28:54.940

您需要映射连接表吗？如果你想要的只是从 A->B 的多对多，你可以用更简单的方式来做。

如果您将 C 表创建为真正的联结 - 并将 A 和 B 的 FK 设置为它在 sql 中的 PK，如下所示：

![在此处输入图像描述](../Images/d7299a7f73ddfcb5124624450135515f.png)

然后，当您从模型创建 edmx 时，它将创建以下内容：

![在此处输入图像描述](../Images/23ed58370189f3e7a8369ce5f06a6f13.png)

现在，如果您想在代码中添加关系，只需将其添加到您的集合中，EF 会自动在您的 C 表中为您创建关系：

```
 var A = new A();
        var b = new B();
        var b2 = new B();

        A.B.Add(b);
        A.B.Add(b2); 
```

# python - 使用 paramiko 进行 x11 转发

> ID：12354047
> 
> 赞同：18
> 
> 时间：2012-09-10T14:43:31.503
> 
> 标签：python, x11, paramiko, x11-forwarding

我正在尝试运行一个`paramiko`应该能够打开 X 窗口的命令。我使用的脚本如下：

```
import paramiko                                    

ssh_client = paramiko.SSHClient()
ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
ssh_client.connect('192.168.122.55', username='user', password='password')
transport = ssh_client.get_transport()
session = transport.open_session()

session.request_x11()
stdin = session.makefile('wb')
stdout = session.makefile('rb')
stderr = session.makefile_stderr('rb')
session.exec_command('env; xterm')
transport.accept()

print 'Exit status:', session.recv_exit_status()
print 'stdout:\n{}'.format(stdout.read())
print 'stderr:\n{}'.format(stderr.read())
session.close() 
```

不幸的是，当我运行上面的脚本时，我得到了这个输出：

```
Exit status: 1
stdout:
SHELL=/bin/bash
XDG_SESSION_COOKIE=8025e1ba5e6c47be0d2f3ad6504a25ee-1347286654.617967-1932974971
SSH_CLIENT=192.168.122.1 58654 22
USER=user
MAIL=/var/mail/user
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
PWD=/home/user
LANG=en_US.UTF-8
SHLVL=1
HOME=/home/user
LOGNAME=user
SSH_CONNECTION=192.168.122.1 58654 192.168.122.55 22
DISPLAY=localhost:10.0
_=/usr/bin/env

stderr:  
xterm: Xt error: Can't open display: localhost:10.0 
```

如果我在终端中运行以下命令：

```
ssh -X user@192.168.122.55 'env; xterm' 
```

然后我得到相同的环境变量（虽然有些端口发生了变化），所以我会说我的环境是正确的。但是，我仍然缺少`paramiko`使用 x11 转发的东西。

我尝试过的几件事是：

*   使用`handler`参数 in `request_x11`: 除了打印值之外，我没有比使用默认处理程序更进一步。
*   Use the `auth_cookie`parameter in : 尝试硬编码根据输出`request_x11`正在使用的 cookie 值。`xauth list`这样做的想法是避免根据文档字符串`paramiko`本身可能发生的问题：

> 如果省略 auth_cookie，将生成、使用和返回一个新的安全随机 128 位值。您将需要使用此值来验证传入的 x11 请求并将其替换为实际的本地 x11 cookie（这需要一些 x11 协议的知识）。

我还能做些什么来使其正常工作或解决问题吗？

注意：这已经在之前被问过：

*   [superuser](https://superuser.com/q/217420/117041)：唯一的响应指向`request_x11`我已经尝试使用无济于事的文档。
*   [stackoverflow](https://stackoverflow.com/q/4448089/183066)：接受的响应建议使用`handler`参数，但它是错误的。
*   [github](https://github.com/paramiko/paramiko/issues/40)：一年多没有提供答案。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-15T20:56:06.593

阅读 paramiko 代码，我意识到 paramiko 只是实现了一种建立 x11 通道的方法。它不会将通道连接到本地 x11 显示器。那是留给你的。

这是我刚刚编写的一个小实现：

```
#!/usr/bin/env python

import os
import select
import sys

import paramiko
import Xlib.support.connect as xlib_connect

local_x11_display = xlib_connect.get_display(os.environ['DISPLAY'])
local_x11_socket = xlib_connect.get_socket(*local_x11_display[:3])

ssh_client = paramiko.SSHClient()
ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
ssh_client.connect('server', username='username', password='password')
transport = ssh_client.get_transport()
session = transport.open_session()
session.request_x11(single_connection=True)
session.exec_command('xterm')
x11_chan = transport.accept()

session_fileno = session.fileno()
x11_chan_fileno = x11_chan.fileno()
local_x11_socket_fileno = local_x11_socket.fileno()

poller = select.poll()
poller.register(session_fileno, select.POLLIN)
poller.register(x11_chan_fileno, select.POLLIN)
poller.register(local_x11_socket, select.POLLIN)
while not session.exit_status_ready():
    poll = poller.poll()
    if not poll: # this should not happen, as we don't have a timeout.
        break
    for fd, event in poll:
        if fd == session_fileno:
            while session.recv_ready():
                sys.stdout.write(session.recv(4096))
            while session.recv_stderr_ready():
                sys.stderr.write(session.recv_stderr(4096))
        if fd == x11_chan_fileno:
            local_x11_socket.sendall(x11_chan.recv(4096))
        if fd == local_x11_socket_fileno:
            x11_chan.send(local_x11_socket.recv(4096))

print 'Exit status:', session.recv_exit_status()
while session.recv_ready():
    sys.stdout.write(session.recv(4096))
while session.recv_stderr_ready():
    sys.stdout.write(session.recv_stderr(4096))
session.close() 
```

一些注意事项：

*   我正在使用 python-Xlib 中的一些辅助函数。这是 Xlib 的纯 python 实现。有关安装它的详细信息，请参阅此问题：[How do you install Python Xlib with pip?](https://stackoverflow.com/questions/10054745/how-do-you-install-python-xlib-with-pip)

*   我如何实现它的一些细节让我相信它只适用于 1 x11 连接（因此`session.request_x11(single_connection=True)`。）我想继续努力让它处理多个连接，但这将不得不等待另一天.

*   此代码实质上使用以下方式以异步方式将以下通道/套接字连接在一起[`select.poll`](http://docs.python.org/library/select.html)：

    *   `session.stdout`->`sys.stdout`
    *   `session.stderr`->`sys.stderr`
    *   `x11channel`->`local_x11_socket`
    *   `local_x11_socket`- >`x11channel`
*   模块向`paramiko`模块输出大量有用的调试信息`logging`。您可以通过配置日志记录模块来查看：

    ```
    import logging
    logging.basicConfig(level=logging.DEBUG) 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T19:30:17.403

*   该`x11`请求可能使用`MIT-MAGIC-COOKIE-1`您可能无法正确处理的
*   直接使用 ssh 我看到它需要确认 x11 请求（cookie 挑战？）
*   该`.Xauthority`文件也可能是一个问题
*   您可以尝试`strace`ssh 进程并查看正常流程
*   在您的脚本中，您可以替换`xterm`为`strace xterm`并与上述内容进行比较。

一些链接：

*   [http://en.wikipedia.org/wiki/X_Window_authorization](http://en.wikipedia.org/wiki/X_Window_authorization)
*   [http://tech.groups.yahoo.com/group/ssh/message/6747](http://tech.groups.yahoo.com/group/ssh/message/6747)
*   [http://answers.tectia.com/questions/523/how-do-i-enable-x11-forwarding-for-users-without-a-home-directory](http://answers.tectia.com/questions/523/how-do-i-enable-x11-forwarding-for-users-without-a-home-directory)

祝你好运。

编辑：建立**在加里的答案之上**，有多个 x11 连接。

```
#!/usr/bin/env python

import os
import select
import sys
import getpass
import paramiko
import socket
import logging
import Xlib.support.connect as xlib_connect
LOGGER = logging.getLogger(__name__)

# connection settings
host = '192.168.122.55'
user = 'user'
password = getpass.getpass()

ssh_client = paramiko.SSHClient()
ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
ssh_client.connect(host, username=user, password=password)
del password

# maintain map
# { fd: (channel, remote channel), ... }
channels = {}

poller = select.poll()
def x11_handler(channel, (src_addr, src_port)):
    '''handler for incoming x11 connections
    for each x11 incoming connection,
    - get a connection to the local display
    - maintain bidirectional map of remote x11 channel to local x11 channel
    - add the descriptors to the poller
    - queue the channel (use transport.accept())'''
    x11_chanfd = channel.fileno()
    local_x11_socket = xlib_connect.get_socket(*local_x11_display[:3])
    local_x11_socket_fileno = local_x11_socket.fileno()
    channels[x11_chanfd] = channel, local_x11_socket
    channels[local_x11_socket_fileno] = local_x11_socket, channel
    poller.register(x11_chanfd, select.POLLIN)
    poller.register(local_x11_socket, select.POLLIN)
    LOGGER.debug('x11 channel on: %s %s', src_addr, src_port)
    transport._queue_incoming_channel(channel)

def flush_out(session):
    while session.recv_ready():
        sys.stdout.write(session.recv(4096))
    while session.recv_stderr_ready():
        sys.stderr.write(session.recv_stderr(4096))

# get local disply
local_x11_display = xlib_connect.get_display(os.environ['DISPLAY'])
# start x11 session
transport = ssh_client.get_transport()
session = transport.open_session()
session.request_x11(handler=x11_handler)
session.exec_command('xterm')
session_fileno = session.fileno()
poller.register(session_fileno, select.POLLIN)
# accept first remote x11 connection
transport.accept()

# event loop
while not session.exit_status_ready():
    poll = poller.poll()
    # accept subsequent x11 connections if any
    if len(transport.server_accepts) > 0:
        transport.accept()
    if not poll: # this should not happen, as we don't have a timeout.
        break
    for fd, event in poll:
        if fd == session_fileno:
            flush_out(session)
        # data either on local/remote x11 socket
        if fd in channels.keys():
            channel, counterpart = channels[fd]
            try:
                # forward data between local/remote x11 socket.
                data = channel.recv(4096)
                counterpart.sendall(data)
            except socket.error:
                channel.close()
                counterpart.close()
                del channels[fd]

print 'Exit status:', session.recv_exit_status()
flush_out(session)
session.close() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T05:15:08.063

鉴于您要求使用*最小*版本，我认为它尽可能易于使用。这是基于两种代码的版本，但这将 x11 会话命令与通用代码分开，使主程序简单且会话代码可重用：

```
import paramiko
import os
import select
import sys
import Xlib.support.connect as xlib_connect

def run(transport, session, command):
    def x11_handler(channel, (src_addr, src_port)):
        x11_fileno = channel.fileno()
        local_x11_channel = xlib_connect.get_socket(*local_x11_display[:3])
        local_x11_fileno = local_x11_channel.fileno()

        # Register both x11 and local_x11 channels
        channels[x11_fileno] = channel, local_x11_channel
        channels[local_x11_fileno] = local_x11_channel, channel

        poller.register(x11_fileno, select.POLLIN)
        poller.register(local_x11_fileno, select.POLLIN)

        transport._queue_incoming_channel(channel)

    def flush_out(channel):
        while channel.recv_ready():
            sys.stdout.write(channel.recv(4096))
        while channel.recv_stderr_ready():
            sys.stderr.write(channel.recv_stderr(4096))

    local_x11_display = xlib_connect.get_display(os.environ['DISPLAY'])

    channels = {}
    poller = select.poll()
    session_fileno = session.fileno()
    poller.register(session_fileno)

    session.request_x11(handler=x11_handler)
    session.exec_command(command)
    transport.accept()

    # event loop
    while not session.exit_status_ready():
        poll = poller.poll()
        if not poll: # this should not happen, as we don't have a timeout.
            break
        for fd, event in poll:
            if fd == session_fileno:
                flush_out(session)
            # data either on local/remote x11 channels/sockets
            if fd in channels.keys():
                sender, receiver = channels[fd]
                try:
                    receiver.sendall(sender.recv(4096))
                except:
                    sender.close()
                    receiver.close()
                    channels.remove(fd)

    flush_out(session)
    return session.recv_exit_status()

if __name__ == '__main__':
    ssh_client = paramiko.SSHClient()
    ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    ssh_client.connect('192.168.122.55', username='user', password='password')
    transport = ssh_client.get_transport()
    session = transport.open_session()
    run(transport, session, 'xterm') 
```

我知道你可以自己做。但是，只要复制该功能，`run`任何人都可以轻松使用它。

正确答案是[https://stackoverflow.com/a/12903844/278878](https://stackoverflow.com/a/12903844/278878)。这个例子是为了让新手更容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-03T16:11:36.923

感谢 **Gary van der Merwe**和**dnozay**的代码。下面的代码严重依赖它并用于在 Windows 上运行 X 程序。显着的区别是使用 select.select 而不是 poll，因为 poll 在 Windows 中不可用。欢迎任何改进或更正。

```
import select
import sys
import paramiko
import Xlib.support.connect as xlib_connect
import os
import socket
import subprocess

# run xming
XmingProc = subprocess.Popen("C:/Program Files (x86)/Xming/Xming.exe :0 -clipboard -multiwindow")
ssh_client = paramiko.SSHClient()
ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
ssh_client.connect(SSHServerIP, SSHServerPort, username=user, password=pwd)
transport = ssh_client.get_transport()
channelOppositeEdges = {}

local_x11_display = xlib_connect.get_display(os.environ['DISPLAY'])
inputSockets = []

def x11_handler(channel, (src_addr, src_port)):
    local_x11_socket = xlib_connect.get_socket(*local_x11_display[:3])
    inputSockets.append(local_x11_socket)
    inputSockets.append(channel)
    channelOppositeEdges[local_x11_socket.fileno()] = channel
    channelOppositeEdges[channel.fileno()] = local_x11_socket
    transport._queue_incoming_channel(channel)

session = transport.open_session()
inputSockets.append(session)
session.request_x11(handler = x11_handler)
session.exec_command('xterm')
transport.accept()

while not session.exit_status_ready():
    readable, writable, exceptional = select.select(inputSockets,[],[])
    if len(transport.server_accepts) > 0:
        transport.accept()
    for sock in readable:
        if sock is session:
            while session.recv_ready():
                sys.stdout.write(session.recv(4096))
            while session.recv_stderr_ready():
                sys.stderr.write(session.recv_stderr(4096))   
        else: 
            try:
                data = sock.recv(4096)
                counterPartSocket  = channelOppositeEdges[sock.fileno()]
                counterPartSocket.sendall(data)
            except socket.error:
                inputSockets.remove(sock)
                inputSockets.remove(counterPartSocket)
                del channelOppositeEdges[sock.fileno()]
                del channelOppositeEdges[counterPartSocket.fileno()]
                sock.close()
                counterPartSocket.close()

print 'Exit status:', session.recv_exit_status()
while session.recv_ready():
    sys.stdout.write(session.recv(4096))
while session.recv_stderr_ready():
    sys.stdout.write(session.recv_stderr(4096))
session.close()
XmingProc.terminate()
XmingProc.wait() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T20:54:37.827

对于那些在 Mac OS X Leopard 中工作的人，没有 select.poll()。这是使用 kqueue 而不是 poll的[dnozay 答案](https://stackoverflow.com/a/12876252/1824948)的修改版本。对此的任何改进/更正将不胜感激。

```
#!/usr/bin/env python

import os
import select
import sys
import paramiko
import socket
import Xlib.support.connect as xlib_connect

# get local display
local_x11_display = xlib_connect.get_display(os.environ['DISPLAY'])

ssh_client = paramiko.SSHClient()
ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
ssh_client.connect('hostname', port=22, username='username', password='password')

channels = {}
kq = select.kqueue()

def x11Handler(x11_chan, (src_addr, src_port)):
    x11_chan_fileno = x11_chan.fileno()
    local_x11_socket = xlib_connect.get_socket(*local_x11_display[:3])
    local_x11_socket_fileno = local_x11_socket.fileno()
    channels[x11_chan_fileno] = x11_chan, local_x11_socket
    channels[local_x11_socket_fileno] = local_x11_socket, x11_chan

    ev = [select.kevent(x11_chan_fileno, filter=select.KQ_FILTER_READ, flags=select.KQ_EV_ADD), select.kevent(local_x11_socket_fileno, filter=select.KQ_FILTER_READ, flags=select.KQ_EV_ADD)]
    kevents = kq.control(ev, 0, None)
    transport._queue_incoming_channel(x11_chan)

def flushOut(session):
    while session.recv_ready():
        sys.stdout.write(session.recv(4096))
    while session.recv_stderr_ready():
        sys.stderr.write(session.recv_stderr(4096))

# start x11 session
transport = ssh_client.get_transport()
session = transport.open_session()
session.request_x11(handler=x11Handler)
session.exec_command('xterm')

# accept first remote x11 connection
x11_chan = transport.accept()
session_fileno = session.fileno()

session_ev = [select.kevent(session_fileno, 
    filter=select.KQ_FILTER_READ,
    flags=select.KQ_EV_ADD)] 

kevents_session = kq.control(session_ev, 0, None)

# event loop
while not session.exit_status_ready():
    r_events = kq.control(None, 4)
    # accept subsequent x11 connections if any

    if len(transport.server_accepts) > 0:
        transport.accept()
    if not r_events: # this should not happen, as we don't have a timeout.
        break
    for event in r_events:
        print event
        if event.ident & session_fileno:
            flushOut(session)
        # data either on local/remote x11 socket
        if event.ident in channels.keys():
            x11_chan, counterpart = channels[event.ident]
            try:
                # forward data between local/remote x11 socket.
                data = x11_chan.recv(4096)
                counterpart.sendall(data)
            except socket.error:
                x11_chan.close()
                counterpart.close()
                del channels[event.ident]

flushOut(session)
kq.close()
session.close() 
```

# java - 用 Weka 计算矩阵 \inverse

> ID：12354048
> 
> 赞同：0
> 
> 时间：2012-09-10T14:43:39.353
> 
> 标签：java, matrix, weka

可以向我简要解释一下如何使用 Weka 系统计算给定 n × n 矩阵的逆矩阵。我想将它用于Java项目，我正在尝试弄清楚如何去做。

非常欢迎任何建议。

我的第二个问题是我检查了网站，看起来 Weka 3 的要求是 java 1.6 JVM，但我的机器上有一个 Java 1.7 JVM 是否有解决方法，以便我可以在我的机器上使用 iWeka 3 尽管1.6JVM要求..

谢谢大家。

# jtable - JTable 单元格内的 JLabel 不会更改标签的光标

> ID：12354053
> 
> 赞同：2
> 
> 时间：2012-09-10T14:43:53.507
> 
> 标签：jtable, tablecellrenderer

在创建一个`JTable`通过 显示标签的位置后`getTableCellRenderers`，我想将光标设置在标签上以显示手形图标，但是实际表格中没有显示任何更改。

我找到了许多解决方案，指的是整个列上的光标更改，但不是在其中一个标签的级别。

即，表格单元格内的超链接标签应仅在光标实际位于其上时才显示手形图标，而不仅仅是在单元格内。

# oracle - 从 A 到 K 查询 oracle Name 列

> ID：12354054
> 
> 赞同：0
> 
> 时间：2012-09-10T14:43:57.703
> 
> 标签：oracle, oracle10g

我在其中一张表中有一个名称列。我希望在 UI 中有 3 个复选框，例如 AK、LS、TZ。

有没有办法使用带有三个单独 SQL 的 Oracle 10g 过滤数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:30:40.477

您可以通过使用`REGEXP_LIKE`. 例如。

```
select n
  from T1
 where regexp_like(n, '^[A-K]') 
```

要使匹配过程不区分大小写，只需在正则表达式后添加“i”

```
select n
  from T1
 where regexp_like(n, '^[A-K]', 'i') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T07:20:39.013

谢谢尼古拉斯。

顺便说一句，我在尝试过一段时间后找到了答案。

```
select empName from emp where empName between 'A%' and 'S%' 
```

不区分大小写的查询：

```
select empName from emp where upper(empName) between 'A%' and 'S%' 
```

# javascript - iOS mouseenter 绑定只工作一次

> ID：12354055
> 
> 赞同：3
> 
> 时间：2012-09-10T14:43:58.633
> 
> 标签：javascript, jquery

iOS 上的鼠标事件有一些问题。用户点击一个项目，然后可以点击以删除出现的下拉菜单。由于我客户的网站需要代表大量项目，因此我使用下拉菜单至关重要。这是该网站在 iOS 上也能正常运行的具体要求。问题是，当用户点击该项目时它可以正常工作，但是当他们点击并尝试点击完全相同的下拉菜单时，它就不起作用了。但是，如果他们打开一个项目，而不是再次打开它，而是打开另一个项目，然后打开第一个项目，它确实有效。

正如您从脚本中看到的那样，我试图解除所有事件的绑定，然后重新绑定它们，希望它会导致脚本再次开始工作。它在桌面上也可以正常工作，尽管有一些错误。非常感谢任何帮助使其在 iOS 上运行，我已将其附加为 jsFiddle。*也感谢对​​我的代码的任何评论 - 一直在寻求改进！*

[http://jsfiddle.net/andrewkhan1/pLp2X/54/](http://jsfiddle.net/andrewkhan1/pLp2X/54/)

提前喝彩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T10:23:53.610

您可以尝试执行以下操作：

1) 不要`:hover`在你的 iOS CSS 中使用导航

2) 使用 CSS`.hover`类使下拉切换 onclick

3) 处理导航外的点击。像这样的东西：

```
$(document).bind('touchstart', function(e) {
    var target = (e.originalEvent.changedTouches ? e.originalEvent.changedTouches[0] : e).target;
    if(!$(target).parents('#navigation').length) {
        // hide dropdowns
        $('#navigation').find('.hover').removeClass('hover');
    }
}); 
```

# css - 无法让 facebook like 按钮坐到右边

> ID：12354060
> 
> 赞同：0
> 
> 时间：2012-09-10T14:44:14.383
> 
> 标签：css, facebook-like

见[http://unlockinglg.com/beta3/index.html#](http://unlockinglg.com/beta3/index.html#)

我尝试检查，但似乎找不到会产生影响的边距和填充。

![在此处输入图像描述](../Images/e78ac6fca121b552e91855f8e09676a4.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T16:00:39.883

我只能看到一个解决方案的“黑客”。在整个元素上使用负数`margin-right`来抵消渲染引擎中明显的错误，该错误使`<div>`8 像素大于`<table>`.

# visual-studio - 适用于 Visual Studio 2012 的生产力工具

> ID：12354061
> 
> 赞同：32
> 
> 时间：2012-09-10T14:44:22.760
> 
> 标签：visual-studio, visual-studio-2012, productivity-power-tools

是否有适用于 Visual Studio 2012 的 Productivity Power Tools 的新版本可用？我想念增强的滚动条、解决方案导航器和左侧（而不是顶部）的选项卡以及“快速查找”等其他一些次要功能。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-11T01:57:42.200

Visual Studio 2012 的生产力工具已于 2012 年 11 月 7 日发布 - 正如[Visual Studio 博客](http://blogs.msdn.com/b/visualstudio/archive/2012/11/07/productivity-power-tools-2012.aspx)上所宣布的那样。除了 2010 年的功能外，还有几个新功能：

*   快速任务（立即执行常见任务 - 使用`Quick Launch`）。
*   电源命令（加快您与代码的交互方式）
*   彩色打印（现在您不需要单独的扩展）

这是[扩展库页面的链接](http://visualstudiogallery.msdn.microsoft.com/3a96a4dc-ba9c-4589-92c5-640e07332afd)。

**注意：** `Ctrl+Click`工作方式有点不同。新版本减少了标签混乱，这通常会发生在积极的`Ctrl+Click`ing 之后。VS 2010 将保持所有代码文件打开，VS 2012 只保留当前文件，并且它是右对齐的（与其他选项卡左对齐相反）。如果需要，可以选择使其永久化。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-20T19:00:28.137

增强的滚动条不是 Visual Studio 2012 中的 OOTB 功能。但是，Productivity Power Tools 的更新版本定于 10 月初发布。[来源](http://connect.microsoft.com/VisualStudio/feedback/details/728679/useful-features-from-productivity-power-tools-missing)

# jquery - jQuery：从结果列表中排除“this”

> ID：12354063
> 
> 赞同：0
> 
> 时间：2012-09-10T14:44:26.883
> 
> 标签：jquery

当拖动事件停止时，我必须确定我的 div 是否与任何其他节点发生冲突。因此，在“停止”事件中，我编写了一个循环来检查与相同类型项目的冲突。

```
$('.article').draggable({

    stop: function(event, ui){

        $(".article").each(function (i) {

            if(this == ui.helper){
                return;
            }

            // Test collisions
        });         
    }
}); 
```

现在，我找不到将自己从该循环中排除的方法。我希望这和 ui.helper 相同，但它们被认为是独立的元素。我该怎么做？

谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T14:47:18.890

我想你想`this`从`$('.article')`. 如果是这样，这可以通过以下[`not`](http://api.jquery.com/not)方法轻松实现：

```
$('.article').not(this).each(function (i) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T14:52:51.677

当结果是同一父级中的兄弟姐妹时的另一种可能方式

```
$(this).index() == $(ui.helper).index() 
```

# c# - C# smtp asyncsend 不发送

> ID：12354064
> 
> 赞同：0
> 
> 时间：2012-09-10T14:44:28.500
> 
> 标签：c#, smtp, sendasync

我正在尝试通过 sendasync 发送电子邮件。问题是它似乎没有进入 sendcompleted 事件处理程序。我在那里添加了一个断点，但它永远不会触发。该程序只是等待我的信号量。有任何想法吗？该程序是一个 Windows 窗体应用程序。

```
if (send)
          {
                    print("Starting to send mail to " + Globalcls.projects[i].name);
                    mailSendSemaphore = new Semaphore(0, 1);
                    System.Net.Mail.MailMessage msg = new System.Net.Mail.MailMessage();
                    msg.To.Add(Globalcls.projects[i].email);
                    msg.From = new MailAddress(Globalcls.settings.server_email);
                    msg.Subject = "Data";
                    msg.SubjectEncoding = System.Text.Encoding.UTF8;
                    msg.Body = "Please see attached data";
                    msg.BodyEncoding = System.Text.Encoding.UTF8;
                    msg.IsBodyHtml = false;
                    msg.Priority = MailPriority.High;

                    foreach (string fileName in files)
                    {
                       msg.Attachments.Add(new System.Net.Mail.Attachment(fileName));
                    }

                    SmtpClient client = new SmtpClient();
                    client.Credentials = new System.Net.NetworkCredential(Globalcls.settings.username, Globalcls.settings.password);
                    client.Port = Convert.ToInt32(Globalcls.settings.portS);//or use 587 

                    client.Host = "smtp.xdsl.co.za";

                    client.SendCompleted += new SendCompletedEventHandler(MailSendCallback);

                    client.SendAsync(msg,null);
                    mailSendSemaphore.WaitOne();
                   // if (Globalcls.error_message != "")
                      //  throw Exception
                    //client.Dispose();
                    print("email sent to " + Globalcls.projects[i].name);
                    client.Dispose();
                    mailSendSemaphore.Dispose();
                    msg.Dispose();

                }

                //Array.ForEach(Directory.GetFiles(GlobalClass.projects[i].foldero), delegate(string path) { File.Delete(path); });
                System.IO.DirectoryInfo directory = new System.IO.DirectoryInfo(Globalcls.projects[i].foldero);
                foreach (System.IO.FileInfo file in directory.GetFiles()) file.Delete();
                foreach (System.IO.DirectoryInfo subDirectory in directory.GetDirectories()) subDirectory.Delete(true);

            } 
```

这是我的 onsendcomplete 偶数处理程序

```
 private static void MailSendCallback(object sender, AsyncCompletedEventArgs arg)
    {
        // oncomllete event for async send.
        if (arg.Error != null)
        Globalcls.error_message = arg.Error.ToString();

        // Release the main thread
        mailSendSemaphore.Release();
    } 
```

编辑

我想使用 sendasync 的原因是 send async 显然会等待文件上传完成。当前的问题是有时附件太大以至于上传时间比超时时间长。我可以延长超时时间，但我不知道我应该做多长时间。大多数电子邮件很容易达到 3mb。而且我们的 adsl 产品线并不总是最稳定的。

等待发送异步的原因是每个客户端不能有多个发送。这就是为什么我等待它完成。

我的问题与超时有关。我想要一个超时，只有当 smtp 和 smtp 客户端之间没有通信时才会超时。

编辑 2

这就是我的代码最初的样子。我想尽量避免这种大规模的超时。让它多线程只会使 gui 不会挂起。

```
if (send)
                {
                    print("Starting to send mail to " + Globalcls.projects[i].name);
                  //  mailSendSemaphore = new Semaphore(0, 1);
                    System.Net.Mail.MailMessage msg = new System.Net.Mail.MailMessage();
                    msg.To.Add(Globalcls.projects[i].email);
                    msg.From = new MailAddress(Globalcls.settings.server_email);
                    msg.Subject = "Data";
                    msg.SubjectEncoding = System.Text.Encoding.UTF8;
                    msg.Body = "Please see attached data";
                    msg.BodyEncoding = System.Text.Encoding.UTF8;
                    msg.IsBodyHtml = false;
                    msg.Priority = MailPriority.High;

                    foreach (string fileName in files)
                    {
                       msg.Attachments.Add(new System.Net.Mail.Attachment(fileName));
                    }

                    SmtpClient client = new SmtpClient();
                    client.Credentials = new System.Net.NetworkCredential(Globalcls.settings.username, Globalcls.settings.password);
                    client.Port = Convert.ToInt32(Globalcls.settings.portS);//or use 587 

                   // client.Host = "127.0.0.1";
                    client.Host = "smtp.xdsl.co.za";
                    client.Timeout = 400000;
                    client.Send(msg);

                   /* client.SendCompleted += new SendCompletedEventHandler(MailSendCallback);

                    client.SendAsync(msg,null);
                    mailSendSemaphore.WaitOne();*/
                   // if (Globalcls.error_message != "")
                      //  throw Exception

                    print("email sent to " + Globalcls.projects[i].name);
                    client.Dispose();
                   //mailSendSemaphore.Dispose();
                    msg.Dispose();

                }

                //Array.ForEach(Directory.GetFiles(GlobalClass.projects[i].foldero), delegate(string path) { File.Delete(path); });
                System.IO.DirectoryInfo directory = new System.IO.DirectoryInfo(Globalcls.projects[i].foldero);
                foreach (System.IO.FileInfo file in directory.GetFiles()) file.Delete();
                foreach (System.IO.DirectoryInfo subDirectory in directory.GetDirectories()) subDirectory.Delete(true);

            }
            catch (Exception ex)
            {
                print("Error with " + Globalcls.projects[i].name);
                print(ex.ToString());
                timer1.Enabled = false;
                timer1.Stop();
                btn_start.Enabled = true;
                string contents = "There was an error in sending mail to " + Globalcls.projects[i].name;
                string heading = " Anxo error";
                string subject = "Anxo error";
                errormail(heading, subject, contents, ex.ToString(), Globalcls.projects[i].sos);
                result = false;
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T06:03:30.563

安装 IIS/SmtpService 并让它处理上传。即用于`SmtpClient`将电子邮件发送到`localhost:25`= 本地 IIS。

恕我直言，您这样做会得到更可靠的解决方案。因为如果出现故障，IIS 将继续尝试上传消息。

**更新**

像这样的东西：

```
public class EmailSender
{
    ConcurrentQueue<MailMessage> _queue = new ConcurrentQueue<MailMessage>();
    private Thread _worker;
    ManualResetEvent _trigger = new ManualResetEvent(false);
    private bool _shutdown;

    public EmailSender()
    {
        _worker = new Thread(SendEmails);
        _worker.Start();
    }
    public void Enqueue(MailMessage message)
    {
        _queue.Enqueue(message);
        _trigger.Set();
    }

    public void Shutdown()
    {
        _shutdown = true;
        _trigger.Set();
        _worker.Join();
    }

    private void SendEmails(object state)
    {
        while (true)
        {
            _trigger.WaitOne(Timeout.Infinite);
            if (_shutdown)
                return; // you might want to send all emails instead.

            MailMessage msg;
            if (!_queue.TryDequeue(out msg))
            {
                _trigger.Reset();
                continue;
            }

            SendEmail(msg);
        }
    }

    private void SendEmail(MailMessage msg)
    {
        var client = new SmtpClient(); // configure
        try
        {
            client.Send(msg);
        }
        catch(SmtpException)
        {
            // try again. You might not want to retry forever = fix
            _queue.Enqueue(msg);
        }

    }
} 
```

# windows-8 - Win 8 上的 Windows Indentity Foundation

> ID：12354068
> 
> 赞同：5
> 
> 时间：2012-09-10T14:44:38.053
> 
> 标签：windows-8, wif

我[在 StackOverflow 上关注了这个讨论，](https://stackoverflow.com/q/3001598/911182)并按照建议前往[Windows Identity Foundation](http://www.microsoft.com/en-us/download/details.aspx?id=17331)下载 WIF。最适合我的操作系统的是 Win 8，所以我下载了文件`Windows6.1-KB974405-x64.msu`. 到目前为止，这对司机等都有效，所以值得一试。

但是，当我开始安装过程时，计算机抱怨遇到错误 0x80096002：“消息签名者的证书无效或找不到”。

它与错误的操作系统版本有关吗？我怎样才能绕过这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T17:27:47.813

WIF 已集成在 System.IdentityModel 和 System.IdentityModel.Services dll 下的 Net 4.5 操作系统中。无需下载其他任何东西。

更多详细信息：http: [//blogs.msdn.com/b/vbertocci/archive/2012/03/15/windows-identity-foundation-in-the-net-framework-4-5-beta-tools-samples-claims -everywhere.aspx](http://blogs.msdn.com/b/vbertocci/archive/2012/03/15/windows-identity-foundation-in-the-net-framework-4-5-beta-tools-samples-claims-everywhere.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T16:05:17.140

今天这个给我修好了。。。

[http://www.stratospher.es/blog/post/installing-windows-identity-foundation-on-windows-8-the-certificate-for-the-signer-of-the-message-is-invalid-or-未找到](http://www.stratospher.es/blog/post/installing-windows-identity-foundation-on-windows-8-the-certificate-for-the-signer-of-the-message-is-invalid-or-not-found)

我在说明中发现的一个问题是，在第 3 步中显示“Windows Identity Framework 3.5”，而在我的机器上显示“Windows Identity Foundation 3.5”。

除此之外，它就像一个魅力。

# php - PHP 正则表达式匹配 oh [URL] 和 [IMG] BBCode 之外的单词？

> ID：12354069
> 
> 赞同：1
> 
> 时间：2012-09-10T14:44:40.113
> 
> 标签：php, regex, forum, bbcode

希望有人能帮助我。我正在为我的论坛制作一个 PHP 插件。目标是每当有人在帖子中输入亚马逊这个词时，它都会自动将其变成亚马逊的链接。

我需要编辑保存在数据库中的文本，然后再将其转换为 HTML 并且仍为 BBCode 格式。

示例文本：

我真的很喜欢在亚马逊购物。这是一个链接：[URL="http:www.amazon.com"]链接到亚马逊[URL]，这是一个图片：[img]http://images.amazon.com/amazon/image/zzz.jpg [/img]。这是另一个简单的链接：[url]http://www.amazon.net[/url]。请记住，亚马逊很棒！

--

在上面的例子中，只有“Amazon”的第一个和最后一个实例应该被匹配，所有其他的都需要被忽略。

我试图改变一个正则表达式，它除了在 HTML 标签中做类似的事情，但没有运气。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T17:30:48.773

解决它，这似乎工作-

```
Amazon(?![^\[]*(\[/url]|"]|\[/img])) 
```

这将跳过任何 URL 标签（长或短）和所有 IMG 标签中的亚马逊。

# dotnetnuke-6 - DotNetNuke 6.2.3 意外的 Windows 身份验证登录框

> ID：12354082
> 
> 赞同：0
> 
> 时间：2012-09-10T14:45:29.860
> 
> 标签：dotnetnuke-6

我的问题很容易被复制。首先，我进行了 DotNetNuke 6.2.3 的全新安装 选择了一个空白网站作为模板（英文） 安装完成后，我现在在我的主页是空白的。在“主页”之后添加了一个新页面当我尝试访问新添加页面的页面设置（管理菜单栏 -> 页面 -> 页面设置）时，我会得到一个 DNN 模式弹出窗口，试图加载页面设置。在那之后，我得到了一个 Windows 身份验证登录框（如果你使用的是 Internet Explorer，你知道，那个小窗口会显示“Windows 安全”）。我不记得我启用了这样的功能。我不知道用户名和密码。我尝试输入我的 Windows 凭据，但它不正确。在 3 次尝试失败后，DNN 模态弹出窗口停留在那里，但它是空的。

我已经在两台不同的机器上进行了干净的安装并遇到了同样的问题。我不希望出现此 Windows 身份验证登录框。我在以前的版本中从未遇到过这样的问题。

请帮忙。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T17:16:10.743

经过 6 个小时的艰苦努力，我终于找到了问题所在。如果您将新添加的页面命名为“报告”，则会出现此问题。作为“报告”的子级创建的任何页面也无法访问，并且将显示 Windows 身份验证登录框。但是我不知道为什么我们不能用“报告”来命名我们的页面

# php - 通过电子邮件发送动态表格

> ID：12354083
> 
> 赞同：0
> 
> 时间：2012-09-10T14:45:31.713
> 
> 标签：php, mysql

我正在开发这个需要发送特定报告的 Web 应用程序。然而，该报告是动态的，并且是表格格式。我现在希望做的事情是通过电子邮件将整个表通过电子邮件发送给某人。有什么办法可以做到吗？

脚本

```
 <?php
    $con = mysql_connect("localhost", "root", "");
    if (!$con) 
      {
      die('Could not connect: ' . mysql_error());
      }

    mysql_select_db("mydb", $con);
    $input = $_POST['id'];
    $query = mysql_query("SELECT * FROM table WHERE ID = '$input'");

    echo "<table border='5' align=center>
    <tr>
    <th>ID</th>
    <th>Type</th>
    <th>Setting</th>
    <th>Value</th>
    <th>Actual</th>
    </tr>";

    while($row = mysql_fetch_array($query)) 
        { 
         echo "<tr>";
      echo "<td>" . $row['ID'] . "</td>";
      echo "<td>" . $row['Type'] . "</td>";
      echo "<td>" . $row['Setting'] . "</td>";
      echo "<td>" . $row['Value'] . "</td>";
      echo "<td>" . $row['Actual'] . "</td>";
      echo "</tr>"; 

            if($row['Value'] != $row['Actual']) 
                { 
                echo "<td bgcolor='#FD2911'>" . "X" . "</td>";
                } 
            else 
                { 
                echo "<td bgcolor='#1CDC15'>" . "O" . "</td>";
                } 
        }
    echo "<br>";

    mysql_close($con);
    ?> 
```

html代码

```
 <form action="query1.php" method="POST">
    Enter the choice: <input type="varchar" name="id" /><br />
    <input type="submit" value="Audit" />
    </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T14:47:44.490

您连接整个表：

```
$table = '';
$table .= "<table border='5' align=center>
<tr>
<th>ID</th>
<th>Type</th>
<th>Setting</th>
<th>Value</th>
<th>Actual</th>
</tr>";

while($row = mysql_fetch_array($query)) 
    { 
     $table .= "<tr>";
  $table .= "<td>" . $row['ID'] . "</td>";
  $table .= "<td>" . $row['Type'] . "</td>";
  $table .= "<td>" . $row['Setting'] . "</td>";
  $table .= "<td>" . $row['Value'] . "</td>";
  $table .= "<td>" . $row['Actual'] . "</td>";
  $table .= "</tr>"; 

        if($row['Value'] != $row['Actual']) 
            { 
            $table .= "<td bgcolor='#FD2911'>" . "X" . "</td>";
            } 
        else 
            { 
            $table .= "<td bgcolor='#1CDC15'>" . "O" . "</td>";
            } 
    }
$table .= "</table><br>";

mail('to@example.com', 'My Subject', $table); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:00:12.020

如果您想做的不仅仅是表格，您可以使用输出缓冲；

```
<?php
ob_start();

# all your code/page/table(s) with echos and all

$toBeSent = ob_get_contents();
ob_end_clean();
?> 
```

然后通过电子邮件发送 ob_start 和 ob_end_clean 之间的全部内容，方法是将 Mihai 帖子的 mail() 行中的 $table 替换为 $toBeSent。

# sql - 在多个数据库中加入查询

> ID：12354086
> 
> 赞同：2
> 
> 时间：2012-09-10T14:45:50.217
> 
> 标签：sql, sql-server, performance, sql-server-2008, join

我有一个包含数百万条记录的数据库，由于某些问题，我们计划将一些特定的表放入不同的（新）数据库中。

如果我将表放入不同的数据库（在同一台服务器上）并在当前数据库和新数据库之间应用连接，是否会影响性能（与数据库中的连接相比）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:36:55.547

IIRC 的原始性能没有什么不同，除了查询优化器一次只适用于一个数据库中的一个表。所以你的查询变成了两个优化的查询，在后面的步骤中数据库之间的连接。在某些情况下，这可能会导致高度未优化的查询，在其他情况下没有区别

只需获得 SSD 并忘记它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T03:45:52.520

假设所有其他事情都相同，那么我不认为多个数据库与单个数据库之间的 JOIN 本身不会导致性能损失。

但是，您的提案提出了太多变数和问题。你在做任何标准化吗？新表将如何被索引？外键？这是一个高事务服务器/数据库吗？之前和之后如何设置您的物理文件？诸如磁盘 I/O、事务日志等之类的东西都可能是一个因素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T14:51:02.083

不是真的，不会对性能造成影响。但是在 sql server 2008 中，您可以使用文件组来实现与您尝试通过分离表来实现相同的目的。您还可以将它们放在不同的磁盘上，这样有助于提高性能。

# haskell - 模棱两可的类型变量

> ID：12354089
> 
> 赞同：2
> 
> 时间：2012-09-10T14:45:59.383
> 
> 标签：haskell, type-constraints

我写了一个小程序，它只计算一个数字（Int）中有多少个。当我尝试执行它时，haskell 抱怨变量约束模棱两可。我知道它来自地板的使用。我还阅读了有关 stackoverflow 的一些答案。但我并没有真正找到解决方法。这是我的代码：

```
count_ones = count_ones' 0

count_ones' m 0 = m
count_ones' m n | n-10*n_new == 1 = count_ones' (m+1) n_new
                | otherwise         = count_ones' m n_new
                 where n_new = floor (n/10) 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T14:52:27.143

```
count_ones' m n | n-10*n_new == 0.1 = count_ones' (m+1) n_new
                | otherwise         = count_ones' m n_new
                 where n_new = floor (n/10) 
```

在第一行中，您与`n - 10*n_new`小数字面量进行比较`0.1`，因此`n`and的类型`n_new`必须是`Fractional`该类的成员。

在`where`子句中，您 bind `n_new = floor (n/10)`，因此类型 of`n_new`必须是`Integral`类的成员。

由于没有标准类型是两个类的成员（有充分的理由），编译器无法解析约束

```
(Fractional a, Integral a) => a 
```

当函数被调用时。

如果为函数提供类型签名，编译器通常会生成更有用的错误消息。

解决您的问题的最简单方法是将绑定更改`n_new`为

```
n_new = fromIntegral (floor $ n/10) 
```

考虑到您在评论中说这`0.1`是一个错误并且您应该使用它`1`，您可能只想使用`Integral`类型，并且您的代码最接近的转录是

```
count_ones' :: Integral a => Int -> a -> Int
count_ones' m 0 = m
count_ones' m n
    | n - 10*n_new == 1 = count_ones' (m+1) n_new
    | otherwise         = count_ones' m n_new
      where
        n_new = n `div` 10 
```

但`n - 10*n_new == 1`用. 替换条件可能更清楚`n `mod` 10 == 1`。

但是，这将需要每步进行两次划分，这可能效率较低。使用`divMod`应该只用一个除法指令给你除法的商和余数，

```
count_ones' m n = case n `divMod` 10 of
                    (q,1) -> count_ones' (m+1) q
                    (q,_) -> count_ones' m q 
```

如果你能保证你只会用非负数调用函数`n`，使用`quot`和`rem`resp。`quotRem`而不是`div`和`mod`resp。`divMod`. 前者函数直接使用机器除法指令的结果，而后者需要一些后处理来保证结果`mod`是非负的，所以`quot`和朋友比`div`和公司效率更高。

# javascript - Javascript GetElementByID 没有价值

> ID：12354090
> 
> 赞同：2
> 
> 时间：2012-09-10T14:45:59.657
> 
> 标签：javascript, jquery

我的表单 ID 是“requestquote”。当我提交表单时，我在控制台中收到一个错误（'formSub 没有值'）。表单过程正在通过我的 PHP 操作文件完成，但我也需要运行这段 javascript。任何建议，将不胜感激。

```
<script> 
_opt.push(['instrument','requestquote']);

var formSub = $('requestquote');
console.log(formSub);

formSub.submit(function(){

_opt.modifyFormParameters = function(parameters){

parameters["_orig_action"] = document.getElementById("_orig_action").value;
parameters["_opt_vid"] = document.getElementById("_opt_vid").value;
parameters["_opt_visit"] = document.getElementById("_opt_visit").value;
parameters["_opt_cid"] = document.getElementById("_opt_cid").value;
parameters["_opt_url"] = document.getElementById("_opt_url").value;
parameters["_opt_paget"] = document.getElementById("_opt_paget").value;
parameters["first_name"] = document.getElementById("name").value;
parameters["company"] = document.getElementById("company").value;
parameters["website"] = document.getElementById("url").value;
parameters["email"] = document.getElementById("email").value;
parameters["phone"] = document.getElementById("phone").value;

return parameters;
};
_opt.push(['submit', 'requestquote']);
_opt.the_form = this;

setTimeout(function(){ _opt.the_form.submit(); } , 1000);
return false;
});
</script> 
```

这是表格代码

```
<form id="requestquote" action="/quote-process/contact_pr_EPH.php" method="post"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:11:48.883

如果它是表单的 ID，那么它应该是：

`$('#requestquote');`甚至`$('form#requestquote');`。

`$()`不仅仅是`GetElementByID`。阅读 jQuery（真正的 Sizzle）选择器：http: [//api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T14:47:50.400

这通常是由以下原因之一引起的：

*   文档中根本没有具有给定 id 的元素
*   在脚本运行时文档中没有具有给定 id 的元素（例如，当`<script>`出现在`<form>`源顺序中的之前时）

您可以通过重新排列源顺序或将 gEbId 调用包装在调用 onload / ondomready / 否则在表单元素存在后调用的函数中来处理时间问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T14:54:03.703

从示例代码中很难看出。但是 JavaScript 可以在`requestquote`元素生成之前执行吗？

`onLoad`可以使用事件之类的东西来使 JavaScript 在所有 HTML 元素加载后执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T15:17:28.380

在脚本的第三行，`var formSub = $('requestquote');`应该是`var formSub = $('#requestquote');`

# 向 jQuery 指示您要搜索 id 而不是标签名称。

# c - 从 C 中的多个线程接收值

> ID：12354091
> 
> 赞同：1
> 
> 时间：2012-09-10T14:46:00.480
> 
> 标签：c, multithreading, pthreads, return-value, pthread-join

```
#include<pthread.h>
#include<stdio.h>
#include<sys/stat.h>
#include<errno.h>

#define SIZE 3

/***I'm trying to send name of each file in a thread and trying to receive their respective size in main *******/

void *doit(void *name)
{
        int *size;
        struct stat st;
        char temp_name[30];
        memset(temp_name, '\0', sizeof(temp_name));
        strcpy(temp_name, (char *)name); //type casted
        stat(temp_name, &st);
        *size = st.st_size; //calculated the size

        printf("File name is: %s\n", temp_name);
        printf("File size is: %d\n", *size);
        pthread_exit((void *)size); //exited from thread
}

int main(int argc, char *argv[])
{
        pthread_t th_id[SIZE];
        int ret_val;
        int i;
        void **size[SIZE];
        for(i=0; i<SIZE;i++)
        {
                size[i] = (void **)malloc(30*sizeof(void *)); //allocated memory to void double pointer
                if(size[i] == NULL)
                {
                        printf("Memory not allocated to %dth member of size\n", (i+1));
                }
        }
        for(i=0; i<3; i++)
        {
          /*****Creating Thread**********/
                ret_val = pthread_create(&th_id[i], NULL, &doit, (void *)argv[1+i]);
                if(ret_val != 0)
                {
                        perror("Thread creation error\n");
                        exit(0);
                }
                pthread_join(th_id[i], size[i]);
                printf("Size is %d\n",**(int **)size[i]); //typecasted and printed
        }
        pthread_exit(NULL);
        return 0;
} 
```

在这个程序中，我在第一次调用 pthread_join 后遇到了分段错误。传递第一个文件时，我在 main.js 中获得了正确的大小。但是在调用第二个文件期间，我遇到了分段错误。使用 gdb，我了解到“**size[1] 和 **size[2] 尽管 malloc 为 NULL。但是在 main 开始时，我在分配内存时没有收到错误消息。这应该意味着内存是最初分配的。请帮助我该怎么办。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T14:50:53.690

```
 int *size;
    struct stat st;
    char temp_name[30];
    memset(temp_name, '\0', sizeof(temp_name));
    strcpy(temp_name, (char *)name); //type casted
    stat(temp_name, &st);
    *size = st.st_size; //calculated the size 
```

您正在取消引用一个未初始化的指针。你从不`size`指出任何事情。

# php - php json_encode 格式化结果？

> ID：12354092
> 
> 赞同：-1
> 
> 时间：2012-09-10T14:46:02.163
> 
> 标签：php, json, jquery-plugins

我有：

```
$all = array(
    array('id'=>1, 'cat'=>'Main','type'=>'Name0'),
    array('id'=>2, 'cat'=>'Main','type'=>'Name1'),
    array('id'=>3, 'cat'=>'Main','type'=>'Name3'),
    array('id'=>4, 'cat'=>'Main','type'=>'Name4'),
    array('id'=>5, 'cat'=>'Secondary','type'=>'Name5'),
    array('id'=>6, 'cat'=>'Secondary','type'=>'Name6'),
    array('id'=>7, 'cat'=>'Secondary','type'=>'Name7'),
    array('id'=>8, 'cat'=>'Other','type'=>'Name8'),
    array('id'=>9, 'cat'=>'Other','type'=>'Name9'),
    array('id'=>10, 'cat'=>'Other','type'=>'Name10'),
    array('id'=>11, 'cat'=>'Other','type'=>'Name11'),
);

$result = array();
    foreach($all as $array){
    $result[$array['cat']][] = array('id'=>$array['id'],'type'=>$array['type']);
}

$json_type = json_encode($result); 
```

返回：

```
{"Main":[{"id":"1","type":"name1"},{"id":"2","type":"name2"},{"id":"3","type":"name3"},{"id":"4","type":"name4"}],"Secondary":[{"id":"5","type":"name5"},{"id":"6","type":"name6"},{"id":"7","type":"name7"}],"Other":[{"id":"8","type":"name8"},{"id":"9","type":"name9"},{"id":"10","type":"name10"},{"id":"11","type":"name11"}]} 
```

但我需要它返回为：

```
[
{
    "text": "Main",
    "children": [
        {
            "id": "1",
            "text": "name1"
        },
        {
            "id": "2",
            "text": "name2"
        },
        {
            "id": "3",
            "text": "name3"
        },
        {
            "id": "4",
            "text": "name4"
        }
    ]
},
{
    "text": "Secondary",
    "children": [
        {
            "id": "5",
            "text": "name5"
        },
        {
            "id": "6",
            "text": "name6"
        },
        {
            "id": "7",
            "text": "name7"
        }
    ]
},
{
    "text": "Other",
    "children": [
        {
            "id": "8",
            "text": "name8"
        },
        {
            "id": "9",
            "text": "name9"
        },
        {
            "id": "10",
            "text": "name10"
        },
        {
            "id": "11",
            "text": "name11"
        }
    ]
} 
```

]

为了使用 select2 JQuery 插件，我正在使用。“孩子”的名字无关紧要，我认为这只是一个占位符，因此可以正确解析。我不知道我会怎么做，我一直在尝试`str_replace()`，但即使这样也没有那么好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T14:54:00.873

我会在 2 个循环中完成它。第一个按类别对结果进行分组，第二个按您的需要对其进行格式化：

```
$temp = array();
foreach($all as $array){    
    if (!isset($temp[$array['cat']])) {
        $temp[$array['cat']] = array();
    }

    $temp[$array['cat']][] = array('id'=>$array['id'], 'type'=>$array['type']);
}

$result = array();
foreach ($temp as $key=>$value) {
    $result[] = array('text'=>$key, 'children'=>$value);
}

echo json_encode($result); 
```

这会产生以下输出：

```
[{"text":"Main","children":[{"id":1,"type":"Name0"},{"id":2,"type":"Name1"},{"id":3,"type":"Name3"},{"id":4,"type":"Name4"}]},{"text":"Secondary","children":[{"id":5,"type":"Name5"},{"id":6,"type":"Name6"},{"id":7,"type":"Name7"}]},{"text":"Other","children":[{"id":8,"type":"Name8"},{"id":9,"type":"Name9"},{"id":10,"type":"Name10"},{"id":11,"type":"Name11"}]}] 
```

# android - 取消 textchange 监听事件

> ID：12354093
> 
> 赞同：0
> 
> 时间：2012-09-10T14:46:04.850
> 
> 标签：android

我有一个带有 textchange 侦听器的 edittext。在侦听器中，我测试用户的输入是否是我想要测试输入是否在最小-最大边界内的地方。

```
valueText.addTextChangedListener(new TextWatcher() {
    String backup = "0";

    public void onTextChanged(CharSequence s, int start, int before, int count) {
        if (count > 0 && !s.equals(backup)) {
            if (Integer.parseInt(s.toString()) > getMaximum()) {
                valueText.setText(backup);
            }
        }
    }

    public void beforeTextChanged(CharSequence s, int start, int count, int after) {
        backup = s.toString();
    }

    public void afterTextChanged(Editable s) {
    }
}); 
```

目前我有这个，但是有没有一种简单的方法来“取消” textchange 事件，所以当值高于最大值时什么都不会发生？

或者我可以使用输入过滤器来设置最小和最大输入吗？

谢谢 ：）

编辑：我在这里找到了一个解决方案：http: [//tech.chitgoks.com/2011/06/27/android-set-min-max-value-an-edittext-accepts/](http://tech.chitgoks.com/2011/06/27/android-set-min-max-value-an-edittext-accepts/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T14:50:26.763

您可以在 EditText XML 定义上使用 android:maxLength。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:07:24.390

```
 InputFilter.LengthFilter mLenthFilter=new InputFilter.LengthFilter(25); // pls define yr max length mine was 25.
        valueText.setFilters(new InputFilter[]{mLenthFilter}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T06:48:43.877

[http://tech.chitgoks.com/2011/06/27/android-set-min-max-value-an-edittext-accepts/](http://tech.chitgoks.com/2011/06/27/android-set-min-max-value-an-edittext-accepts/)，您可以设置编辑文本的最小值和最大值。

# html - 如何在表达式引擎中创建内部链接？

> ID：12354094
> 
> 赞同：1
> 
> 时间：2012-09-10T14:46:05.253
> 
> 标签：html, expressionengine

我有一个条目列表，我试图在顶部创建一个可以单击的标题列表，以便页面滚动到正文。以下内容不起作用，因为当我使用 entry_id 时，它正在写出整个 URL/entry_id

```
<div class="list">
    {exp:channel:entries channel="mychan" category="2"}    
        <div class="mytitle"><a href="{entry_id}">{title}</a></div>
    {/exp:channel:entries} 
</div>

{exp:channel:entries channel="mychan" category="2"}    
    <div class="ele">
        <div class="mytitle"><a href="#entry_id">{title}</a></div>
        <div class="mybody">{mybody}</div>
     </div>
{/exp:channel:entries} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:59:57.943

It's not writing out the entire URL/entry_id. The href is only the entry_id, which the *browser* automatically converts to `http://your-site.com/entry_id`. For an internal link, it needs have a `#` symbol.

Also, internal link names have [some other requirements](https://stackoverflow.com/questions/70579/what-are-valid-values-for-the-id-attribute-in-html):

> ID and NAME tokens must begin with a letter ([A-Za-z]) and may be followed by any number of letters, digits ([0-9]), hyphens ("-"), underscores ("_"), colons (":"), and periods (".").

So they can't just be a number; you need to start with a letter at least.

So in your first `{exp:channel:entries}` loop linking to the entry, change the link href to this (or something similar):

```
<a href="#entry_{entry_id}">{title}</a></div> 
```

And in the second loop, repeat that (without the `#`) as an ID on your wrapping `div`:

```
<div class="ele" id="entry_{entry_id}">
  ...
</div> 
```

# eclipse - 编辑器的 Eclipse GMF 背景图像

> ID：12354096
> 
> 赞同：2
> 
> 时间：2012-09-10T14:46:09.640
> 
> 标签：eclipse, eclipse-gmf

我想在我的 GMF 图表编辑器的背景上平铺一个 GIF 图像（作为背景纹理），就像 Graphiti 的背景样式一样。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:11:05.870

这是方法：

[http://wiki.eclipse.org/GMF_Newsgroup_Q_and_A#How_to_scroll_a_background_image.3F](http://wiki.eclipse.org/GMF_Newsgroup_Q_and_A#How_to_scroll_a_background_image.3F)

# django - 覆盖 Django admin 中的默认查询集

> ID：12354099
> 
> 赞同：87
> 
> 时间：2012-09-10T14:46:13.167
> 
> 标签：django, django-models, django-admin

我的一个模型有一个已删除的标志，用于全局隐藏对象：

```
class NondeletedManager(models.Manager):
    """Returns only objects which haven't been deleted"""

    def get_query_set(self):
        return super(NondeletedManager, self).get_query_set().exclude(deleted=True)

class Conversation(BaseModel):
    ...
    deleted = models.BooleanField(default=False)
    objects = NondeletedManager()
    all_conversations = models.Manager() # includes deleted conversations 
```

如何覆盖 Django 管理模块使用的默认查询集以包含已删除的对话？

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2012-09-10T14:56:16.120

您可以在模型管理类中[覆盖](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.get_queryset) `get_queryset`方法。

```
class MyModelAdmin(admin.ModelAdmin):
    def get_queryset(self, request):
        qs = super(MyModelAdmin, self).get_queryset(request)
        if request.user.is_superuser:
            return qs
        return qs.filter(author=request.user) 
```

请注意，在 Django<=1.5 中，该方法被命名为`queryset`.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-10T15:26:00.337

Konrad 是正确的，但这比文档中给出的示例更难。

已删除的对话不能包含在已经排除它们的查询集中。因此，除了完全重新实现 admin.ModelAdmin.queryset 之外，我没有看到其他选项。

```
class ConversationAdmin (admin.ModelAdmin):

    def queryset (self, request):
        qs = Conversation.all_conversations
        ordering = self.get_ordering(request)
        if ordering:
            qs = qs.order_by(*ordering)
        return qs 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-10T14:51:01.640

以下内容会有什么问题：

```
class Conversation(BaseModel):
    ...
    deleted = models.BooleanField(default=False)
    objects = models.Manager() # includes deleted conversations
    nondeleted_conversations = NondeletedManager() 
```

因此，在您自己的应用程序/项目中，您可以使用`Conversation.nondeleted_conversations()`并让内置的管理应用程序来做这件事。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-02-01T00:36:17.593

您可以使用 Django[代理模型](https://docs.djangoproject.com/en/2.1/topics/db/models/#proxy-models)来做到这一点。

```
# models.py
class UnfilteredConversation(Conversation):
    class Meta:
        proxy = True

    # this will be the 'default manager' used in the Admin, and elsewhere
    objects = models.Manager() 

# admin.py
@admin.register(UnfilteredConversation)
class UnfilteredConversationAdmin(Conversation):
    # regular ModelAdmin stuff here
    ... 
```

或者，如果您有一个想要重用的现有 ModelAdmin 类：

```
admin.site.register(UnfilteredConversation, ConversationAdmin) 
```

这种方法避免了在原始对话模型上覆盖默认管理器时可能出现的问题 - 因为默认管理器也用于多对多关系和反向 ForeignKey 关系。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-09-04T00:34:10.020

接受的解决方案对我来说非常有用，但我需要更多的灵活性，所以我最终扩展了更改列表视图以添加自定义查询集参数。我现在可以像这样配置我的默认查询集/过滤器，它仍然可以通过使用不同的过滤器（获取参数）进行修改：

```
def changelist_view(self, request, extra_context=None):
    if len(request.GET) == 0 :
        q = request.GET.copy()
        q['status__gt'] = 4
        request.GET = q
        request.META['QUERY_STRING'] = request.GET.urlencode()

    return super(WorksheetAdmin,self).changelist_view(request, extra_context=extra_context) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-05-30T20:50:11.937

Natan Yellin 是正确的，但是您可以更改经理的顺序，第一个将是默认值，然后是管理员使用的：

```
class Conversation(BaseModel):
    ...
    deleted = models.BooleanField(default=False)

    all_conversations = models.Manager() # includes deleted conversations
    objects = NondeletedManager() 
```

`get_queryset()`use的`._default_manager`管理实现`.objects`，如下所示

```
qs = self.model._default_manager.get_queryset() 
```

参考[Django github BaseModelAdmin 实现](https://github.com/django/django/blob/master/django/contrib/admin/options.py)

这只能确保每次使用 YourModel.objects 时都不会包含已删除的对象，但通用视图和其他视图也使用 ._default_manager。然后，如果您不覆盖 get_queryset 不是解决方案。我刚刚检查了 ListView 和管理员。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-01T10:54:08.497

用我认为最简洁和有用的东西来扩展其中的一些答案。

我假设您有一个像“名称”这样的字段来显示条目。

```
# admin.py

from django.contrib import admin

@admin.register(Conversation)
class ConversationAdmin(admin.ModelAdmin):
    list_display = ('name', '_is_deleted')

    # Nice to have but indicates that an object is deleted
    @admin.display(
        boolean=True,
        ordering='deleted'
    )
    def _is_deleted(self, obj):
        return obj.deleted

    def get_queryset(self, request):
        return Conversation.all_conversations 
```

这将为您提供如下界面：

[![带有已删除标志的 Django 管理员列表](../Images/bf6fbb3475164a0df5dbfcaa68d427e9.png)](https://i.stack.imgur.com/hp4Nl.png)

我发现对模型进行子类化的问题是它导致了元继承和反向路径查找的问题。

# c# - Linq to Xml：根据可选属性对 xml 节点进行排序

> ID：12354101
> 
> 赞同：1
> 
> 时间：2012-09-10T14:46:20.683
> 
> 标签：c#, linq-to-xml

我想根据可选属性对下面描述的一些 xml 节点进行排序

```
<ncx xmlns="http://www.daisy.org/z3986/2005/ncx/">
<head>
    <meta name="dtb:uid" content="http://www.hxa7241.org/articles/content/epup-guide_hxa7241_2007_1.epub" />
</head>
<docTitle>
    <text>Roméo et Juliette</text>
</docTitle>
<navMap>
    <navPoint id="toc" playOrder="2">
        <navLabel>
            <text>Table des Matières</text>
        </navLabel>
        <content src="9789999997049_toc.html" />
    </navPoint>
    <navPoint id="tp" playOrder="1">
        <navLabel>
            <text>Page de Titre</text>
        </navLabel>
        <content src="9789999997049_tp.html" />
    </navPoint>
    <navPoint id="p01" playOrder="3">
        <navLabel>
            <text>ACTE PREMIER</text>
        </navLabel>
        <content src="9789999997049_p01.html" />
        <navPoint id="ch02" playOrder="5">
        <navLabel>
          <text>Sc&#232;ne 2</text>
        </navLabel>
        <navPoint id="ch01" playOrder="4">
            <navLabel>
                <text>Scène première</text>
            </navLabel>
            <content src="9789999997049_ch01.html" />
        </navPoint>
        <content src="9789999997049_ch02.html"/>
     </navPoint>
    </navPoint>
</navMap> 
```

如果 playOrder 属性函数存在，如何对 navpoint 节点进行排序，如果不存在，如何正常检索 xml？我应该先测试 playOrder 是否存在，然后进行不同的 Linq 查询，还是可以用一条语句处理所有事情（可能有一个案例）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T14:50:15.743

最简单的方法是转换为可为空的类型并按以下顺序排序：

```
var sorted = navPoints.OrderBy(x => (int?) x.Attribute("playOrder")); 
```

如果属性不存在，这将给出 null 值；所有这些条目最终都会在排序集合中排在第一位（IIRC）。

# javascript - 从 HTML 字符串中解析和选择

> ID：12354105
> 
> 赞同：2
> 
> 时间：2012-09-10T14:46:28.217
> 
> 标签：javascript, jquery, html, ajax

使用 ajax 调用，我返回了页面的 partialView HTML，但在显示它之前，我希望从主 div 中提取信息。这个数据只是大小信息，如果我创建一个浮动窗口。

代码：

```
<div class="window-details" data-height="500px" data-width="500px">more data here</div>

this.PopUp = function (url, title) {
  $.ajax(url)
  .success(function (partialViewHtml) {
     var partialViewDom = $(partialViewHtml);
     var thisDiv = $(".window-details", partialViewDom); 
```

将鼠标悬停在 partialViewDom 上时，我可以在 chromes 调试器中看到数据，但类选择似乎不起作用。有什么线索吗？它解析不正确吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T14:48:40.377

尝试`.filter()`改用，您的元素很可能`.window-details`是 dom 片段中的顶级元素。

```
var thisDiv = partialViewDom.filter(".window-details"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T14:48:26.203

您的代码在返回的 div`.window-details`的*子*项中搜索具有 的元素。

# c# - 如何伪造 Active Directory？

> ID：12354107
> 
> 赞同：13
> 
> 时间：2012-09-10T14:46:47.920
> 
> 标签：c#, authentication, active-directory

我正在用 C# 开发一个需要针对 Active Directory 进行身份验证的应用程序。我有 Windows 7，无法在本地安装 Active Directory。我无法使用 Active Directory 访问现有服务器（除非通过十个步骤连接到 VPN）。我宁愿不创建虚拟机来运行 Windows Server。有没有什么东西可以在内存中运行并拦截 AD 调用以返回伪造的数据？如果它不存在，理论上需要什么来实现它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T14:59:23.527

我认为您最好的解决方案是安装虚拟服务器进行开发。我不建议将您的工作站加入工作站内的域，但您可以使用远程调试器来调试虚拟机内的应用程序。只需在您的访客上进行网络共享，然后配置您的调试项目以将构建输出到此目录中。然后在“调试”选项卡或项目属性中指定“使用远程机器”，您就可以在那里进行调试。您可能需要创建一个与您的主机具有相同名称和密码的本地管理员帐户，以启用无缝身份验证。在这样的配置中，虚拟客户系统中的调试与本地调试没有太大区别。

如果您只需要这样的东西进行单元测试，或者需要从 AD 解除绑定以进行单元测试，那么关于模拟的另一个答案将是合乎逻辑的方法。

我想创建一个成熟的虚假 AD 实现是没有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T14:47:52.670

您可以使用依赖注入，然后在单元测试中模拟 Active Directory 调用。

# protobuf-net - 使用 DataContract 属性时 ProtoBuf.NET 未序列化

> ID：12354108
> 
> 赞同：8
> 
> 时间：2012-09-10T14:46:50.660
> 
> 标签：protobuf-net

我在 NuGet (2.0.0.480) 上使用最新版本的 ProtoBuf，它不会序列化标有`DataContract`/`DataMember`属性的类型：

```
[DataContract]
public class Person
{
    [DataMember]
    public string Firstname { get; set; }
}

class Program
{
    static void Main(string[] args)
    {
        var outputFile = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "person.dat");

        var person = new Person { Firstname = "ben" };

        using (var fs = new FileStream(outputFile, FileMode.OpenOrCreate)) {
            Serializer.Serialize(fs, person);
        }

        using (var fs = File.OpenRead(outputFile))
        {
            var result = Serializer.Deserialize<Person>(fs);
            Console.WriteLine(result.Firstname);
        }

        Console.ReadLine();
    }
} 
```

但是，如果我使用 ProtoBuf 特定属性装饰我的类：

```
[ProtoContract]
public class Person
{
    [ProtoMember(1)]
    public string Firstname { get; set; }
} 
```

它按预期工作。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-10T14:52:29.890

它需要该`Order`属性来获得唯一且可靠的密钥编号：

```
[DataContract]
public class Person
{
    [DataMember(Order=1)]
    public string Firstname { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T14:51:45.743

`[DataMember]` **当使用Order must be specified**时，我应该更仔细地阅读文档。

例如

`[DataMember(Order = 1)]`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T12:39:11.667

除了 Marc 和 Ben 的回答之外，请注意，您必须将 order 值设置为大于 0。
我们曾经在使用 BCL 序列化程序时从 0 开始 order，但 protobuf-net 忽略 order 为 0 的数据成员。

# asp.net - JuiceUI 和 AjaxToolkit 产生运行时错误：'$' is undefined

> ID：12354109
> 
> 赞同：1
> 
> 时间：2012-09-10T14:46:51.150
> 
> 标签：asp.net, drag-and-drop, juice-ui

我在带有 Masterpage 的 aspx 页面中有以下代码：

```
<script>
    $(function () {
        $('#_Default').droppable({
            drop: function (event, ui) {
                debugger;
                var sender = ui.draggable;
                var pageId = '<%=  Page.UniqueID %>';
                __doPostBack('<%=TriggerDraggable.UniqueID%>', 
                  'Draggable#' + sender[0].id);
            }
        });
        $('#_Source').droppable({
            drop: function (event, ui) {
                debugger;
                var sender = ui.draggable;
                var pageId = '<%=  Page.UniqueID %>';
                __doPostBack('<%=TriggerDraggable.UniqueID%>', 
                  'Selected#' + sender[0].id);
            }
        });
    });
</script> 
```

如果页面不包含 Ajax-Toolkit 控件，一切都很好 - 但如果有，例如，`ConfirmButtonExtender`我会收到上述错误。

所以似乎 ajax 工具包以某种方式处理了这个功能。这就是为什么我在我的实际脚本标签前面插入了以下标签：

```
<script type="text/javascript" src="Scripts/jquery-1.8.0.js"></script>
<script type="text/javascript" src="Scripts/jquery-ui-1.8.23.js"></script>
<script type="text/javascript" src="Scripts/amplify.js"></script>
<script type="text/javascript" src="Scripts/juice.js"></script> 
```

这样可以防止错误，并且我还可以拖动一些生成的元素，但是现在永远不会调用 drop 事件 - 这在以前有效。

有没有办法确保在 AJAX 工具包的函数调用之前首先调用我的脚本？还是我错过了更多的脚本参考？

两者都是需要的，AJAX 工具包和 JuiceUI。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T14:54:43.797

您确定浏览器控制台中没有JS脚本错误吗？在上面的脚本中，您的意思是在两个不同的地方在同一代码中使用 uniqueid 和 clientid 吗？即 `var pageId = '<%= Page.UniqueID %>';`和 `var pageId = '<%= Page.ClientID %>';`

# php - Wordpress：使用不同的循环

> ID：12354114
> 
> 赞同：0
> 
> 时间：2012-09-10T14:47:05.487
> 
> 标签：php, html, css, wordpress

我正在制作在线杂志。现在我正在尝试显示我发布的帖子。我已经做到了，但我想要的是，如果一个帖子被归类为“街头风格”，那么如果它被归类为“摄影”，那么循环将完全不同。我已经设法对一个类别做到这一点，我怎样才能对其他类别做同样的事情，并以另一种方式对其进行样式设置？我尝试使用与 相同的代码`<?php if (is_category( 'Streetstyle' ) || in_category( 'Streetstyle' ) ) { ?>`，但随后主题被窃听并且帖子显示了两次。你知道更好的方法吗？

这是我的代码：

```
<?php query_posts('posts_per_page=9' . '&orderby=date'); 
        while ( have_posts() ) : the_post(); ?>         
            <?php if (is_category( 'Streetstyle' ) || in_category( 'Streetstyle' ) ) { ?>
                <div <?php post_class('pin streetstyle'); ?>>
                <a href="<?php the_permalink(); ?>">
                <div class="heading">
                <h1>Fashion</h1>
                </div>
                <?php if ( has_post_thumbnail() ) {
                    the_post_thumbnail();
                } 
                ?> 
                <div class="heading">
                <h1><?php the_title(); ?></h1>
                </div>
                </a>
                </div>
             <?php } else { ?>   
                <div <?php post_class('pin'); ?>>
                <h1>
                    <a href="<?php the_permalink(); ?>"><?php the_title(); ?></a>
                </h1>
                <?php if ( has_post_thumbnail() ) {
                    the_post_thumbnail();
                } 
                the_content('Les mer <br><br>'); ?> 
                </div>
             <?php } ?>           
        <?php endwhile;
        // Reset Query
        wp_reset_query(); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T16:01:36.157

我已经瘦了一点，但这可能是你所追求的

```
<?php query_posts('posts_per_page=9' . '&orderby=date'); 
    while(have_posts()) : the_post(); ?>         
    <?php if(is_category('Streetstyle') || in_category('Streetstyle')) : ?>
        <div <?php post_class('pin streetstyle'); ?>>
            <a href="<?php the_permalink(); ?>">
                <div class="heading">
            <h1><?php the_title(); ?></h1>
                </div>
            </a>
        </div>
        <?php if(has_post_thumbnail()) the_post_thumbnail(); ?>
    <?php else : ?>   
        <div <?php post_class('pin'); ?>>
            <h1><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h1>
            <?php 
                if(has_post_thumbnail()) the_post_thumbnail();
                the_content('Les mer <br><br>');
            ?> 
        </div>
    <?php endif; ?>           
<?php endwhile; wp_reset_query(); ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T14:53:35.950

如果您有很多类别，我建议您使用 switch，它将节省您的时间，并且您的代码看起来会更干净。

[http://php.net/manual/en/control-structures.switch.php](http://php.net/manual/en/control-structures.switch.php)

# wpf - Horizo ntalAlignment 更改时如何淡入

> ID：12354115
> 
> 赞同：2
> 
> 时间：2012-09-10T14:47:05.900
> 
> 标签：wpf

我有一个控件，它可以显示在窗口的左侧或右侧，具体取决于 viewmodel 属性的值（由于在 UI 中的其他位置单击按钮而更改）。我正在使用 DataTriggers 来实现这个定位：

```
<DataTrigger Binding="{Binding ShowOnLeft}" Value="True">
    <Setter Property="HorizontalAlignment" Value="Left"/>
</DataTrigger>
<DataTrigger Binding="{Binding ShowOnLeft}" Value="False">
    <Setter Property="HorizontalAlignment" Value="Right"/>
</DataTrigger> 
```

我现在想让控件在它的位置改变时淡入，所以我添加了这些触发器：-

```
<Trigger Property="HorizontalAlignment" Value="Left">
    <Trigger.EnterActions>
        <BeginStoryboard>
            <Storyboard>
                <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0.0" To="0.8" Duration="0:0:0.2"/>
            </Storyboard>
        </BeginStoryboard>
    </Trigger.EnterActions>
</Trigger>

<Trigger Property="HorizontalAlignment" Value="Right">
    <Trigger.EnterActions>
        <BeginStoryboard>
            <Storyboard>
                <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0.0" To="0.8" Duration="0:0:0.2"/>
            </Storyboard>
        </BeginStoryboard>
    </Trigger.EnterActions>
</Trigger> 
```

然而，它会产生一些奇怪的结果。淡入淡出在第一次水平对齐更改为“左”时起作用，但在随后的尝试中不起作用。但是，每次 Horizo​​ntalAlignment 更改为“Right”时，淡入淡出都会很高兴地工作。部分似乎取决于触发顺序 - 如果我交换两个触发器，则会发生相反的情况（淡入淡出仅在我第一次将 Horizo​​ntalAlignment 设置为“Right”时有效，但每次都适用于“Left”）。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T14:58:54.943

也许是一个疯狂的猜测，但我前段时间也有过类似的（不想要的）行为。最后，我成功使用`FillBehavior`了`DoubleAnimation`set to的属性`Stop`（默认为`HoldEnd`）。

[阅读本文](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.fillbehavior.aspx)以了解有关此属性/枚举的更多信息。

# python - HTTPConnection 发出 DELETE 请求：505 响应

> ID：12354118
> 
> 赞同：0
> 
> 时间：2012-09-10T14:47:11.667
> 
> 标签：python, http, version, httpconnection, http-status-code-505

令人沮丧的是，我需要在 Python 2.6.4 上开发一些东西，并且需要向似乎只支持 http 1.1 的服务器发送删除请求。这是我的代码：

```
httpConnection = httplib.HTTPConnection("localhost:9080")
httpConnection.request('DELETE', remainderURL)
httpResponse = httpConnection.getresponse() 
```

然后我得到的响应代码是：505（不支持 HTTP 版本）

我已经测试过通过 Firefox 的 RESTClient 将删除请求发送到相同的 URL，并且可以正常工作。

我不能使用 urllib2 因为它不支持 DELETE 请求。HTTPConnection 对象是否只有 http 1.0？还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-19T20:22:44.103

您可以使用**urllib2**：

```
req = urllib2.Request(query_url)
req.get_method = lambda: 'DELETE'   # creates the delete method
url = urllib2.urlopen(req) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:00:28.007

该类`HTTPConnection`始终使用 HTTP/ [1.1，505](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.6)似乎表明它是无法处理 HTTP/1.1 请求的*服务器。*

但是，如果您需要发出`DELETE`请求，为什么不使用[Requests 包](https://requests.readthedocs.io/)呢？A`DELETE`很简单：

```
import requests

requests.delete(url) 
```

这不会神奇地解决您的 HTTP 版本不匹配问题，但您可以启用详细日志记录以找出发生了什么：

```
import sys
requests.delete(url, config=dict(verbose=sys.stderr)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T14:52:49.383

httplib 使用 HTTP/1.1（参见 HTTPConnection.putRequest 方法文档）。

检查 httpResponse.version 以查看服务器使用的版本。

# javascript - 如何动态创建多个 Jquery 颜色选择器（eyecon）？

> ID：12354120
> 
> 赞同：0
> 
> 时间：2012-09-10T14:47:21.127
> 
> 标签：javascript, jquery

我正在为 CMS 主题创建者使用这个 jQuery 颜色选择器：[http ://www.eyecon.ro/colorpicker/](http://www.eyecon.ro/colorpicker/)

它们目前为每个颜色选择器设置如下：

```
<div class="colorSelector" id="colorSelector3"><div style="background-color: #0000ff"></div></div> 
```

有了这个用于javascript：

```
$('#colorSelector3').ColorPicker({
color: '#0000ff',
onShow: function (colpkr) {
    $(colpkr).fadeIn(500);
    return false;
},
onHide: function (colpkr) {
    $(colpkr).fadeOut(500);
    return false;
},
onChange: function (hsb, hex, rgb) {
    $('#colaAlpha a').css('color', '#' + hex);
    $('#colorSelector3 div').css('backgroundColor', '#' + hex);
} 
```

});

问题是我需要创建大量的颜色选择器，如果有一个函数可以传入选择器的 id 和要更改的元素的 id，那就太好了。这可能吗？

这没有用：

```
function colorPickMulti(itemid, cp){
$(cp).ColorPicker({
color: '#0000ff',
onShow: function (colpkr) {
    $(colpkr).fadeIn(500);
    return false;
},
onHide: function (colpkr) {
    $(colpkr).fadeOut(500);
    return false;
},
onChange: function (hsb, hex, rgb) {
$(itemid).css('color', '#' + hex);
$(cp + ' div').css('backgroundColor', '#' + hex);
}
});
} 
```

我可以以某种方式动态创建函数吗？任何帮助都会很棒！谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:47:17.707

```
<div class="colorSelector" id="colorSelector3"><div style="background-color: #0000ff"></div></div>
<div class="colorSelector" id="colorSelector4"><div style="background-color: #0000ff"></div></div>

<script type="text/javascript">
function colorPickMulti(itemid, cp){
    $(cp).ColorPicker({
        color: '#0000ff',
        onShow: function (colpkr) {
            $(colpkr).fadeIn(500);
            return false;
        },
        onHide: function (colpkr) {
            $(colpkr).fadeOut(500);
            return false;
        },
        onChange: function (hsb, hex, rgb) {
            $(itemid).css('color', '#' + hex);
            $(cp + ' div').css('backgroundColor', '#' + hex);
        }
    });
}

$('#colorSelector3').click(function(){
    colorPickMulti('itemid', 'cp');
});

$('#colorSelector4').click(function(){
    colorPickMulti('itemid', 'cp');
});

</script> 
```

# c - Linux内核模块奇怪的行为

> ID：12354122
> 
> 赞同：2
> 
> 时间：2012-09-10T14:47:40.500
> 
> 标签：c, linux-kernel

我正在研究一个linux内核，所以我尝试编写一个简单的模块。

以下代码应该控制调用`read()`的次数：`/proc/proc_test`

```
#include <linux/init.h>
#include <linux/module.h>
#include <linux/proc_fs.h>
#include <linux/kernel.h>
#include <asm/current.h>

static int __init init(void);
static void __exit stop(void);
static int proc_read(char *buffer, char **start, off_t offset, int size, int *eof, void *data);

static int counter = 0;

static int proc_read(char *buffer, char **start, off_t offset, int size, int *eof, void *data) {
    if (size < 256) return -ENOMEM;
    return sprintf(buffer, "counter = %d\n", counter++); <-- supposed to be incremented once
}

static int __init init() {
    if (create_proc_read_entry("proc_test", 0, NULL, proc_read, NULL) == 0) {
        printk(KERN_ERR "Can not creat entry\n");
        return -ENOMEM;
    }
    printk("Entry created!\n");
    return 0;
}

static void __exit stop() {
    remove_proc_entry("proc_test", NULL);
    printk("Entry removed!\n");
    return;
}

module_init(init);
module_exit(stop);

MODULE_LICENSE("GPL"); 
```

我面临的问题是，当我从`/proc/proc_test/`using `cat`or读取时`tail`，计数器增加 3 而不是 1。

输出：

```
cat /proc/proc_test 
counter = 0

cat /proc/proc_test 
counter = 3

cat /proc/proc_test 
counter = 6 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T14:52:47.543

试试这个：

```
static int proc_read(char *buffer, char **start, off_t offset, int size, int *eof, void *data) {
    if (size < 256) return -ENOMEM;
    int count= sprintf(buffer, "counter = %d\n", counter++);
    *eof = 1;
    return count;
} 
```

设置 *eof=1，您的驱动程序会通知内核（以及想要读取您的 proc 文件的应用程序）您的驱动程序已到达 EOF。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-10T14:52:55.873

唯一错误的是你有一个不合理的期望。是什么让你认为`cat /proc/proc_test`只会调用`read`一次？

```
$ strace cat /proc/self/stat | grep read
read(3, "17423 (cat) R 17420 17420 13224 "..., 32768) = 238
read(3, "", 32768)                      = 0
$ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T15:12:37.493

Even though [this answer](https://stackoverflow.com/a/12354224/912144) has a good hint, I have been having this issue too. Setting `*eof = 1` theoretically should have solved the problem but somehow it doesn't.

My fix was to **also** add this on the top of the function:

```
if (offset > 0)    // even though I set *eof = 1, the kernel is still calling me, so return 0 for it to stop
    return 0; 
```

The comment above is in fact what I had written in my own module.

What this does is to make sure only the first call to your function (in which `offset` is 0) does anything.

# c# - 用于动态网格视图模板的 SqlDatasource 的旧值

> ID：12354134
> 
> 赞同：0
> 
> 时间：2012-09-10T14:47:57.417
> 
> 标签：c#, asp.net, sql, sqldatasource

对于动态 Gridview，我在运行时生成列，如下所示：

```
TemplateField tf = new TemplateField();
tf.HeaderText = colName;
tf.ItemTemplate = new GenericItem(ListItemType.Item, colName, "Command");
tf.EditItemTemplate = new GenericItem(ListItemType.EditItem, 
Gridview1.Columns.Add(tf); 
```

GenericItem 实现 IBindableTemplate：

```
public class GenericItem : IBindableTemplate 
```

这很好用，但是当我尝试更新某些列时，我需要访问旧值。我以为我可以使用这个：

```
<asp:SqlDataSource runat="server" ID="dsGridview" OldValuesParameterFormatString="old_{0}" ConflictDetection="CompareAllValues" /> 
```

但是当我想在 Gridview 的 RowUpdating 事件中访问我的数据源的 oldvalues 属性时，我注意到 oldvalues 集合是空的（newvalues 集合填充得很好）

有人知道我怎样才能得到这些旧值吗？

最好的问候， r3try

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T05:34:54.583

好的，这不是我想要解决的方法 - 但由于这里没有其他建议，所以我是如何解决我的问题的。也许其他人也有同样的问题：

```
protected void GridView1_RowEditing(object sender, GridViewEditEventArgs e)
    {
        //GET THE OLD VALUES
        myOldValues.Clear();
        GridView gv = (GridView)sender;
        gv.EditIndex = e.NewEditIndex;
        gv.DataBind();

        //populate 
        for (int i = 0; i < Gridview1.Columns.Count; i++)
        {
            DataControlFieldCell cell = gv.Rows[e.NewEditIndex].Cells[i] as DataControlFieldCell;
            gv.Columns[i].ExtractValuesFromCell(myOldValues, cell, DataControlRowState.Edit, true);
        }

        Session["MyOldValues"] = myOldValues;

    } 
```

# java - Android 是否支持 Sun PKCS#11 提供程序？

> ID：12354137
> 
> 赞同：5
> 
> 时间：2012-09-10T14:48:03.210
> 
> 标签：java, android, security, pkcs#11

Android 是否支持 Sun PKCS#11 提供程序？还是可以以某种方式将其移至Android？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T03:07:21.360

不，Sun==Oracle => 复制不好 :)

不过说真的，它在 Android 中不可用，也没有标准的 PKCS#11 支持（尽管 JB 确实在某些事情上使用了专有的 PKCS#11 提供程序）。不确定代码是否在 OpenJDK 中，但如果是，您可以尝试移植它。但是，由于您实际上不太可能需要使用完整的 PKCS#11 API，因此仅为您需要的功能（叹息、验证、散列等）编写 JNI 包装器会容易得多。

# android - Android，仅更改按钮的单击颜色

> ID：12354140
> 
> 赞同：1
> 
> 时间：2012-09-10T14:48:25.830
> 
> 标签：android, button, colors, pressed

我想更改有人按下 Android 按钮时出现的默认橙色。我进行了很多搜索，但我发现的只是使用`selectors`. 我了解原理，但我不想修改普通按钮的灰色方面（未按下）。但是使用`selectors`武力来定义所有方面的所有特征（按下或不按下）。

我不知道如何获得灯光主题中按钮的默认外观，所以谁能告诉我在哪里可以找到灯光的原始参数，`theme`或者至少给我另一种方法来简单地改变按钮的颜色?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T14:59:59.193

您可以将 Android 的选择器复制到您的项目中，即 Android 默认将其设置为按钮的选择器，并且仅通过更改一个可绘制对象来修改按下按钮时的状态。

你可以在`\android-sdk\platforms\android-10\data\res\drawable\btn_default.xml`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T14:58:55.950

对不起兄弟............我想只有选择器会帮助你......你必须使用选择器......并且选择器是可重用的xml，你可以在所有按钮中使用...... ..:) 你可以参考下面的链接。:) [http://developer.android.com/guide/topics/resources/drawable-resource.html#StateList](http://developer.android.com/guide/topics/resources/drawable-resource.html#StateList)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T15:02:53.383

我试图找到解决这个问题的方法，但没有成功。也许这会有所帮助： [如何在不影响按下和选择状态的情况下修改 Android 中的默认按钮状态？](https://stackoverflow.com/questions/3859144/how-to-modify-the-default-button-state-in-android-without-affecting-the-pressed)

[具有不同颜色的标准 Android 按钮](https://stackoverflow.com/questions/1521640/standard-android-button-with-a-different-color)

# c++ - 在 autoconf 中使用 doxygen 宏

> ID：12354144
> 
> 赞同：0
> 
> 时间：2012-09-10T14:48:32.167
> 
> 标签：c++, build-automation, doxygen, autotools, autoconf

我正在尝试使用 doxygen 来记录我的项目的源代码，并且我正在使用自动工具来构建系统。我已经`ax_prog_doxygen.m4`从 autoconf-archive 存储库下载了宏，对 aminclude.am 进行了更改，并确保调用 DX_INIT_DOXYGEN 和 configure.ac 中的其余部分。

生成配置脚本和生成文件的所有命令都可以正常工作，但我实际上无法再制作项目了，并出现以下错误：

```
Makefile:833: *** missing separator.  Stop 
```

完整代码在[https://gist.github.com/3690227](https://gist.github.com/3690227)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:40:04.943

This often happens when you copy/download macros from a different OS. Check the format of the files (**unix/windows**) and also use a consistent indentation policy (either **tabs or spaces**), especially on the Makefiles.

Good luck!

# xcode - 带有 Xcode 的 SVNBridge 给出“200 OK”错误

> ID：12354147
> 
> 赞同：0
> 
> 时间：2012-09-10T14:48:42.980
> 
> 标签：xcode, svn, xcode4, svnbridge

我正在尝试使用 SVNBridge，以便我的团队可以使用我们现有的 TFS 服务器作为我们的 Xcode 存储库。

SVNBridge 似乎在 TFS 服务器上设置正确，我可以从 Xcode 连接到它作为 SVN 存储库以获取所有内容并提交更改。

但是，当我让团队的其他成员更新以获取我刚刚提交的文件时，他们会收到以下错误：

svn: '/!svn/bc/36163/-TFS 文件夹结构-'的报告: 200 OK (http://-tfs server url-:8081)

当他们更新文件时也会发生这种情况，然后我尝试更新。

我们都拥有对 TFS 结构的完全读/写访问权限。

TFS 服务器上的 SVNBride 日志文件夹中没有任何内容。

关于错误的任何想法，或者我应该为此使用更好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T14:18:52.447

y0-1，一直发生在我身上。

可能的原因是 1) urlscan，检查日志 2) ..svnbridge 文件夹，我通常使用本机客户端连接到 TFS 并删除它们，这很痛苦，因为它们通常有很多。删除 ..svnbridge 文件夹后，您可能需要重新签出项目中删除它们的部分，有时需要重新启动 svnbridge。

此外 svnbridge 日志通常包含非常有用的信息；）

ps刚刚意识到，您说您的svnbridge日志是干净的，这很奇怪，可能是配置不正确（通常是文件夹权限）

fe 我的 svnbridge 日志在更新时出现类似错误 -

消息：指定版本中不存在项目“blah-blah-blah”。用户：请求：报告 /!svn/vcc/default HTTP/1.1

# mysql - 创建和删除索引后 MySQL 性能提升

> ID：12354153
> 
> 赞同：3
> 
> 时间：2012-09-10T14:48:54.777
> 
> 标签：mysql, sql, caching, indices

我有一个大型 MySQL、MyISAM 表，大约有 400 万行，运行在一个 core 2 duo、8G RAM 笔记本电脑上。

该表有 30 列，包括 varchar、decimal 和 int 类型。

我在 varchar(16) 上有一个索引。让我们将此列称为：“indexed_varchar_column”。

我的查询是

```
SELECT 9 columns FROM the_table WHERE indexed_varchar_column = 'something'; 
```

对于我查询的每个“东西”，它总是返回大约 5000 行。

查询的解释返回：

```
+----+-------------+-------------+------+----------------------------------------------------+--------------------------------------------+---------+-------+------+-------------+
| id | select_type | table       | type | possible_keys                                      | key                                        | key_len | ref   | rows | Extra       |
+----+-------------+-------------+------+----------------------------------------------------+--------------------------------------------+---------+-------+------+-------------+
|  1 | SIMPLE      | the_table   | ref  | many indexes including indexed_varchar_column      | another_index NOT: indexed_varchar_column! | 19      | const | 5247 | Using where |
+----+-------------+-------------+------+----------------------------------------------------+--------------------------------------------+---------+-------+------+-------------+ 
```

首先我不确定为什么选择 another_index。实际上，它选择了一个索引，该索引是 indexed_varchar_column 和另外 2 列（构成所选列的一部分）的复合索引。也许这是有道理的，因为不必读取查询中的 2 列可能会使事情变得更快一些。真正的问题是**以下**问题：

对于我匹配的每个“东西”，查询需要 5 秒。第二次我查询“某事”需要 0.15 秒（我猜是因为查询正在被缓存）。当我对“something_new”运行另一个查询时，又需要 5 秒。所以，是一致的。

问题是：我发现创建一个索引（另一个复合索引，包括我的 indexed_varchar_column）并再次删除它会产生对新的“something_other”的所有进一步查询只需要 0.15 秒。请注意 1) 我创建了一个索引 2) 再次删除它。所以一切都处于相同的状态。

我猜想构建和删除索引所需的所有操作都会使 SQL 引擎缓存一些东西，然后再重用。当我在所有这些之后对查询运行 EXPLAIN 时，我得到的结果与以前完全相同。

如何继续了解创建-删除索引过程中缓存的内容，以便在不操作索引的情况下对其进行缓存？

**更新：**

根据 Marc B 的评论，建议当 mySQL 创建索引时，它会在内部执行 SELECT ... 我尝试了以下操作：

```
SELECT * FROM my_table; 
```

它花了 30 秒并返回了 400 万行。好消息是所有进一步的查询再次非常快（直到我重新启动系统）。请注意，重新启动后查询又变慢了。我猜这是因为 mySQL 正在使用某种操作系统缓存。

任何的想法？如何显式缓存我猜的表？

**更新2：** 也许我应该提到这个表可能严重碎片化。它有 400 万行，但我会定期删除很多旧字段。我还添加了新的。由于我每天的 ID （删除的行）有很大的差距，我删除了主索引 (ID) 并用连续的数字再次创建它。该表可能非常分散，因此 IO 一定是一个问题......不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:07:53.613

复合索引中列的顺序是什么。

您必须在查询中使用（至少）列的左关联子集

如果您在 foo、bar 和 baz 上有一个索引，那么它们自己将*不能*用作针对 bar 或 baz 的索引。只有 (foo)、(foo,bar) 和 (foo,bar,baz)。

`EXPLAIN`是你的朋友吗？它将告诉您查询正在使用哪个索引（如果有）。

*编辑*这是一个简单的左连接查询的postgres解释，用于比较。

```
Nested Loop Left Join  (cost=0.00..16.97 rows=13 width=103)
    Join Filter: (pagesets.id = pages.pageset_id)
      ->  Index Scan using ix_pages_pageset_id on pages  (cost=0.00..8.51 rows=13 width=80)
              Index Cond: (pageset_id = 515)
      ->  Materialize  (cost=0.00..8.27 rows=1 width=23)
          ->  Index Scan using pagesets_pkey on pagesets  (cost=0.00..8.27 rows=1 width=23)
                Index Cond: (id = 515) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:22:17.693

您有多少包含 indexed_varchar_column 的索引？您是否只有 indexed_varchar_column 的单个索引？

你有没有试过： `SELECT 9 columns FROM USE INDEX (name_of_index) the_table WHERE indexed_varchar_column = 'something';`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T09:21:36.423

谢谢大家的帮助。

最后我发现（感谢 Marc B 的提示）我的表在多次 INSERT 和 DELETE 之后严重碎片化。几个小时前，我用这个信息更新了这个问题。有两件事有帮助：

1)

```
ALTER TABLE my_table ORDER BY indexed_varchar_column; 
```

2）运行：

```
myisamchk --sort-records=4 my_table.MYI  (where 4 corresponds to my index) 
```

我相信这两个命令是等效的。即使在系统重新启动后查询也很快。我已将此 A​​LTER TABLE ORDER BY 命令放在每天运行的 cron 上。这需要 2 分钟，但这是值得的。

# java - NumberFormatException 未在 try/catch 中被捕获

> ID：12354155
> 
> 赞同：5
> 
> 时间：2012-09-10T14:48:57.147
> 
> 标签：java, jsp, try-catch

我正在创建的 .jsp 页面有问题。对于那些担心的人来说，该网站是用于家庭作业的，但是，我试图超越要求的范围，并且不询问与评分有关的任何事情。这完全是为了我自己的利益。

言归正传：我正在从用户那里获得输入，执行 method="post" 并刷新页面，并且在理想情况下它可以工作（这是家庭作业。）但是，我正在尝试尝试/捕获在用户将字符串输入 int 字段的情况下阻止。

```
int Svolt = 0;
double Amperes = 0.0;
double LEDdrop = 0.0;

if (request.getParameter("Svolt") != null) {
try {
    Svolt = Integer.parseInt(request.getParameter("Svolt")); 
} catch ( NumberFormatException e ) {
    %>
    <script type ="text/javascript">
        alert("The source voltage must be an integer. Please fix this.");
    </script>
    <%                                                    
} 
```

我尝试将“NumberFormatException”切换为“Exception”，但它返回了相同的错误代码。早些时候，我在 if() 语句之前有我的 try catch，它起作用了，但没有显示我想要的警报框。

该代码如下：

```
final double MA_TO_A = 0.001;
int Svolt = 0;
double Amperes = 0.0;
double LEDdrop = 0.0;

try {
    if (request.getParameter("Svolt") != null) {
        try {
            Svolt = Integer.parseInt(request.getParameter("Svolt"));
        } catch (Exception e) 
        {
            %>
            <script type ="text/javascript">
                alert("The source voltage must be an integer. Please fix this.");
            </script>
            <%
        }
        Amperes = Double.parseDouble(request.getParameter("Amperes"));
        LEDdrop = Double.parseDouble(request.getParameter("LEDdrop"));

        out.println("Ideal resistance is: " + ((Svolt - LEDdrop) / (Amperes * MA_TO_A)) + " Ohms.");   
    }
} catch (Exception e) {
        out.println("Please make sure your inputs are correct.");
} 
```

任何帮助表示赞赏，您的时间也是如此。非常感谢你！

编辑：对不起，意思是复制粘贴错误代码：

```
org.apache.jasper.JasperException: java.lang.NumberFormatException: For input string: "a" 
```

测试输入是字符串“a”

EDIT2：备份/编辑/测试@Nambari 的建议

```
final double MA_TO_A = 0.001;
int Svolt = 0;
double Amperes = 20.0;
double LEDdrop = 1.8;

try {
    if (request.getParameter("Svolt") != null) {
        try {
            Svolt = Integer.parseInt(request.getParameter("Svolt"));
        } catch (Exception e) 
        {
            %>
            <script type ="text/javascript">
                alert("The source voltage must be an integer. Please fix this.");
            </script>
        <%
        }
        out.println("Ideal resistance is: " + ((Svolt - LEDdrop) / (Amperes * MA_TO_A)) + " Ohms.");   
    }
} catch (Exception e) {
    out.println("Please make sure your inputs are correct.");
} 
```

输出：理想电阻为：-90.0 Ohms

警告框说（“源电压必须是整数。请解决这个问题。”）

没有错误代码。

没有 out.println 说（“请确保您的输入正确”）。

最终编辑：

代码现在几乎可以按预期工作，但已经足够好了。

```
 final double MA_TO_A = 0.001;
                    int Svolt;
                    double Amperes;
                    double LEDdrop;

                    if (request.getParameter("Svolt") != null) 
                    {
                        try 
                        {

                            try 
                            {
                                Svolt = Integer.parseInt(request.getParameter("Svolt"));
                            } catch (Exception e) 
                            {
                            %>
                            <script type ="text/javascript">
                                alert("The source voltage must be an integer. Please fix this.");
                            </script>
                            <%  
                            Svolt = 0;
                            }
                            try 
                            {
                                Amperes = Double.parseDouble(request.getParameter("Amperes"));
                            } catch (Exception e) 
                            {
                                %>
                                <script  type = "text/javascript"> 
                                    alert("The source voltage must be an integer. Please fix this.");
                                </script> 
                                <% 
                                Amperes = 0.0;
                            }
                            try 
                            {
                                LEDdrop = Double.parseDouble(request.getParameter("LEDdrop"));
                            } catch (Exception e) 
                            {
                            %>
                                <script  type = "text/javascript"> 
                                    alert("The source voltage must be an integer. Please fix this.");
                                </script> 
                            <%
                            LEDdrop = 0.0;
                            }
                            out.println("Ideal resistance is: " + ((Svolt - LEDdrop) / (Amperes * MA_TO_A)) + " Ohms.");
                        } catch (Exception e)
                        { 
                            out.println("Please make sure your inputs are correct."); 
                        }   
                    } 
```

我知道很多行话，但这就是最终结果。不知何故，这一切正常。感谢所有帮助过的人！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:46:17.363

首先，不建议在java servlet页面中嵌入java代码，你应该只关心jsp中的表示层，没有业务逻辑，你需要一个servlet来接受http请求，做你的逻辑，把响应结果，然后重定向到jsp。

另一方面，JSP 页面抛出的异常类型是 org.apache.jasper.JasperException，而不是 NumberFormatException，apache jasper JSP 引擎正在捕获数字格式异常，并向 Tomcat 抛出 JasperException。

另外，请清除您的 tomcat 缓存以确保您的 JSP 正在部署到最新版本，为此，请删除以下文件夹和文件（包括 war）：
{tomcat 安装路径}\work\Catalina\localhost(your app )
{tomcat 安装路径}\webapps(你的应用)

如果你捕捉到通用的 java.lang.Exception，它应该可以工作。

也试试这个：

* * *

```
 final double MA_TO_A = 0.001;
    int Svolt = 0;
    double Amperes = 0.0;
    double LEDdrop = 0.0;
    try {
        if (request.getParameter("Svolt") != null) {
            try {
                Svolt = Integer.parseInt(request.getParameter("Svolt"));
             } catch (Exception e) 
            {
                //Changed to avoid the message if no exception, or for some other reason it fails to execute the conditions
                out.println("<script type =\"text/javascript\">")
                out.println("alert(\"The source voltage must be an integer. Please fix this.\");") ;
                out.println("</script>")
            }
            Amperes = Double.parseDouble(request.getParameter("Amperes"));
            LEDdrop = Double.parseDouble(request.getParameter("LEDdrop"));

            out.println("Ideal resistance is: " + ((Svolt - LEDdrop) / (Amperes * MA_TO_A)) + " Ohms.");   
        }
    } catch (Exception e) {
            out.println("Please make sure your inputs are correct.");
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T14:54:33.650

这是根据我的评论发布的答案：

我建议删除表单上除 Svolt 相关代码之外的所有内容并尝试。我认为除了这个文件之外还有其他事情搞砸了。备份现有代码。删除除 Svolt 之外的所有内容，看看，我们可以确定问题。

确保 try/catch 块与上述注释中建议的代码流正确同步。

# gwt - 将序列化对象从服务器发送到 GWT

> ID：12354157
> 
> 赞同：0
> 
> 时间：2012-09-10T14:48:58.210
> 
> 标签：gwt, serialization, deserialization

我正在寻找一种将自定义类从 ActionBean 响应发送到 GWT 客户端的简单方法。

有人可以通过一个简单而具体的例子来帮助我如何做到这一点。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T19:18:59.190

You should probably use RequestFactory as it does not require that the bean be serializable as the GWT RPC service does. You would create a value proxy on the client side and make sure it maps getters/setters that you need.

[https://developers.google.com/web-toolkit/doc/latest/DevGuideRequestFactory](https://developers.google.com/web-toolkit/doc/latest/DevGuideRequestFactory)

# node.js - 如何使用 MongoDB 查找包含某个值的所有文档

> ID：12354160
> 
> 赞同：-3
> 
> 时间：2012-09-10T14:49:17.513
> 
> 标签：node.js, mongodb

我正在使用 nodejs 和 mongodb。x 是一个包含字符串（某种颜色）的变量。现在，我想创建一个查询（在 nodejs 中），它检索其颜色字段（这是一个字符串列表，在本例中为颜色列表）包含字符串 x 的所有文档。我应该如何在nodejs中编写它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:40:34.723

您的问题有点令人困惑，因为在第一段中您要求 OR 关系，但您的示例描述了 AND 关系。

当您想查找所有具有红色或绿色的文档时，您必须使用 $in 运算符：

```
db.collection.find({ colors: { $in:[ "red", "green" ]} }); 
```

当您想查找所有具有红色和绿色的文档（可能还有其他文档）时，您必须使用 $all：

```
db.collection.find({ colors: { $all:[ "red", "green" ]} }); 
```

来源：[http ://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries)

# jquery-mobile - 使用 knockout.js 处理 jQuery Mobile ajax 页面转换背后的数据

> ID：12354161
> 
> 赞同：0
> 
> 时间：2012-09-10T14:49:18.847
> 
> 标签：jquery-mobile, knockout.js

我有一个概念证明，在这里彻底彻底地打破了：

[http://jsfiddle.net/floyd_may/FAmxj/](http://jsfiddle.net/floyd_may/FAmxj/)

我希望这背后的意图很明显。基本上，我想一次用一个`#editPage`来编辑元素`#mainPage`。但是，一旦您单击“返回主页”按钮，主页就为空。

我可以在这里获得一些关于如何完成这项工作的指导吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T16:36:31.773

尝试使用该`pageinit`事件而不是：http `pagebeforeshow`: [//jsfiddle.net/FAmxj/11/](http://jsfiddle.net/FAmxj/11/)

有了`pagebeforeshow`，就必然会有多个模型`#mainpage`。

# bash - 检索保存 bash 脚本的文件系统位置

> ID：12354163
> 
> 赞同：1
> 
> 时间：2012-09-10T14:49:29.190
> 
> 标签：bash

> **可能重复：**
> [在 bash 脚本中，我如何知道脚本文件名？](https://stackoverflow.com/questions/192319/in-the-bash-script-how-do-i-know-the-script-file-name)

我经常需要 bash 脚本的文件系统来引用其他需要的资源。通常在 shebang 行之后使用以下代码。它设置了一个名为“scriptPos”的变量，其中包含脚本的当前路径

```
scriptPos=${0%/*} 
```

它工作得很好，但是有没有更直观的东西来替换 shell 扩展？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:02:47.690

有`dirname`，但它需要一个`fork`：

```
scriptPos=$(dirname "$0") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:05:33.863

一种选择是

```
scriptPos=$(dirname $0) 
```

这是以额外过程为代价的，但更具自我描述性。如果脚本直接在当前脚本中，则输出会有所不同（我认为更好）：

```
#!/bin/bash
scriptPos=$(dirname $0)

echo '$0:' $0
echo 'dirname:' $scriptPos
echo 'expansion:' ${0%/*}

$ bash tmp.bash
$0: tmp.bash
dirname: .
expansion: tmp.bash 
```

更新：试图解决 jm666 指出的缺点。

```
#!/bin/bash
scriptPos=$( v=$(readlink "$0") && echo $(dirname "$v") || echo $(dirname "$0") ) 
```

# php - 提交时url显示两次

> ID：12354169
> 
> 赞同：1
> 
> 时间：2012-09-10T14:49:35.783
> 
> 标签：php, codeigniter

现在第一次使用 codeigniter，并尝试他们在[这里](http://codeigniter.com/user_guide/libraries/file_uploading.html)描述的上传文件类。现在发生的事情很奇怪，因为一旦我提交选择图像的表单，它就会显示错误 404，这是可以理解的，由于某种原因，地址栏中显示的 url 原来是：

> [http://mydomain.com/index.php/www.mydomain.com/index.php/do_upload](http://mydomain.com/index.php/www.mydomain.com/index.php/do_upload)

所以它在重复！这导致了 404 的问题，但我不知道为什么会这样？

用于控制器的代码是：

```
<?php

class Upload extends CI_Controller {

    function __construct()
    {
        parent::__construct();
        $this->load->helper(array('form', 'url'));
        //form_upload('userfile'); 
    }

    function index()
    {
        $this->load->view('upload_form', array('error' => ' ' ));
    }

    function do_upload()
    {
        $config['upload_path'] = '/uploads/';
        $config['allowed_types'] = 'gif|jpg|png';
        $config['max_size'] = '100';
        $config['max_width']  = '1024';
        $config['max_height']  = '768';

        $this->load->library('upload', $config);

        if ( ! $this->upload->do_upload())
        {
            $error = array('error' => $this->upload->display_errors());

            $this->load->view('upload_form', $error);
        }
        else
        {
            $data = array('upload_data' => $this->upload->data());

            $this->load->view('upload_success', $data);
        }
    }
}
?> 
```

感谢支持:)

编辑：提交表格：

```
<html>
<head>
<title>Upload Form</title>
</head>
<body>

<?php echo $error;?>

<?php echo form_open_multipart('upload/do_upload');?>

<input type="file" name="userfile" size="20" />

<br /><br />

<input type="submit" value="upload" />

</form>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:08:27.187

这个问题的答案是在配置文件的基本 URL 中的域地址之前添加 http://。这解决了问题。感谢大家

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T14:51:58.447

该错误可能在您的上传表单中。如果操作不是相对 URL 或以 开头`http://`，例如您已指定“www.mydomain.com/index.php/do_upload”作为操作，您将获得该行为。

要解决此问题，请在前面加上“http://”或创建一个相对 URL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T15:04:50.493

尝试这个：

```
<?php echo form_open_multipart('/upload/do_upload');?> 
```

不是“上传”之前的“/”

# facebook - 丢失访问令牌

> ID：12354170
> 
> 赞同：0
> 
> 时间：2012-09-10T14:49:39.807
> 
> 标签：facebook, access-token, facebook-access-token

有时我的 Facebook 对象来自以下内容：

```
[fb] => Facebook Object
    (
      [appId:protected] => 350348105029704
      [appSecret:protected] => 9e84****************************
      [user:protected] => 
      [signedRequest:protected] => 
      [state:protected] => 
      [accessToken:protected] => AAACQm6g*****************
      [fileUploadSupport:protected] => 
    ) 
```

变成这样的东西：

```
[fb] => Facebook Object
    (
      [appId:protected] => 350348105029704
      [appSecret:protected] => 9e84****************************
      [user:protected] => 
      [signedRequest:protected] => 
      [state:protected] => 
      [accessToken:protected] => 350348105029704|9e84****************************
      [fileUploadSupport:protected] => 
    ) 
```

appSecret 当然是被屏蔽的，访问令牌也是如此。但正如您所看到的，在第二个对象中，它不是有效的访问令牌，而是由 appId|appSecret 制成的。

它随机发生，我似乎无法在它发生时抓住它，这可能是什么原因？

# javascript - 是否有任何 Javascript 函数可以从指定索引进行正则表达式匹配

> ID：12354171
> 
> 赞同：1
> 
> 时间：2012-09-10T14:49:42.100
> 
> 标签：javascript, regex

是否有以下功能：

```
var regex=/\s*(\w+)/;
var s="abc def ";
var m1=regex.exec(s,0); // -> matches "abc"
var m2=regex.exec(s,3); // -> matches "def" 
```

我知道替代方案是：

```
var regex=/\s*(\w+)/;
var s="abc def ";
var m1=regex.exec(s); // -> matches "abc"
var m2=regex.exec(s.substring(3)); // -> matches " def" 
```

但是我担心如果 s 很长并且 s.substring 被多次调用，某些实现可能会在多次复制长字符串时效率低下。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T15:01:36.907

是的，如果正则表达式具有全局修饰符，您可以`exec`从特定索引开始。`g`

```
var regex=/\s*(\w+)/g; // give it the "g" modifier

regex.lastIndex = 3;   // set the .lastIndex property to the starting index

var s="abc def ";

var m2=regex.exec(s); // -> matches "def" 
```

如果您的第一个代码示例具有`g`修饰符，那么它将按照您编写的方式工作，原因与上述相同。使用`g`，它会自动将 设置为`.lastIndex`最后一次匹配结束后的索引，因此下一次调用将从那里开始。

所以这取决于你需要什么。

如果你不知道会有多少匹配，常用的方法是`exec`循环运行。

```
var match,
    regex = /\s*(\w+)/g,
    s = "abc def ";

while(match = regex.exec(s)) {
    alert(match);
} 
```

或作为`do-while`.

```
var match,
    regex = /\s*(\w+)/g,
    s = "abc def ";

do {
    match = regex.exec(s);
    if (match)
        alert(match);
} while(match); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T14:57:26.383

我认为没有任何正则表达式方法可以做到这一点。如果您担心性能，我只会存储完整的字符串和剪断的字符串，因此`substring`只调用一次：

```
var regex=/\s*(\w+)/;
var s="abc def ";
var shorts = s.substring(3);
var m1=regex.exec(s); // -> matches "abc"
var m2=regex.exec(shorts); // -> matches " def" 
```

# matlab - 在Matlab中将大于52位的二进制字符串转换为单个字符串？

> ID：12354174
> 
> 赞同：2
> 
> 时间：2012-09-10T14:49:52.933
> 
> 标签：matlab, numerical-methods

我正在尝试将非常长的二进制字符串（通常大于 52 位）转换为数字。我不能有一个固定的前瞻窗口，因为我这样做是为了计算神经数据的 Lempel-Ziv 复杂度的一个版本。

当我尝试转换任何长字符串时，bin2dec 会抛出二进制字符串必须为 52 位或更少的错误。

有没有办法绕过这个尺寸限制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T14:58:31.843

`dec2bin`抛出该错误，因为单个无法存储那么高的精度。你的问题是不可能的。您有两个选择：将值存储在浮点值以外的其他值中，或者在转换之前丢弃一些精度。

或者更完整地描述你想要完成的事情。

编辑：

根据您的其他信息，我更加确定转换为浮点数不是您想要做的。如果您想将存储大小减小到更有效的程度，请转换为字节向量 (uint8)，它尽可能密集。只需使用 reshape 将二进制字符串分成 N 行，每行 8 位。这似乎是生物数据的公认方法。

```
str = char((rand(1, 100)>0.5) + '0');    % test data
data = uint8(bin2dec(reshape(str(1:end-mod(end,8)), [], 8))); 
```

在这段代码中，我将所有不均匀分成 8 的位扔掉。或者，跳过 uint8 步骤，只对结果向量执行处理，其中每个双精度浮点数代表序列中的一个 8 位字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T16:08:51.207

您可以推出自己的实现：

```
len = 60;

string = [];
for i = 1:len
  string = [string sprintf('%d', randi([0 1]))];
end

% error
% bin2dec(string);

% roll your own...
value = 0;
for i = length(string):-1:1
  value = value + str2num(string(i))*2^(length(string)-i);
end 
```

我只是遍历字符串并添加一些值。最后， value 将包含字符串的十进制值。这对你有用吗？

**注意：**这个解决方案很*慢*。您可以通过预先分配字符串来加快速度，这是我在自己的机器上所做的。此外，如果您的号码达到 1e6 位，也会出现问题。此时，您需要可变精度算术来跟踪它。并将其添加到计算中*确实*减慢了速度。`.mex`如果我是你，如果你需要 MATLAB 中的功能，我会强烈考虑从文件中编译它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T17:26:17.123

归功于@aardvarkk，但这是他算法的加速版本（+- 100x 快）：

```
N=100;
strbin = char(randi(2,1,N)+'0'-1);

pows2 = 2.^(N-1:-1:0);
value=pows2*(strbin-'0')'; 
```

`double`的范围只上升到`1.79769e+308`哪个是`2^1024`给予或接受。从那里开始，`value`将是`Inf`or `NaN`。所以你仍然需要找到另一种存储结果数字的方法。

该算法的最后一个专家：您可以缓存`pows2`大量数据，然后将其中的一部分用于长度为 N 的任何新 strbin：

```
Nmax = 1e8; % already 700MB for pows2, watch out!
pows2 = 2.^(Nmax-1:-1:0); 
```

然后使用

```
value = pows2(Nmax-N+1:end)*(strbin-'0')'; 
```

## matlab数值上界的解法

File Exchange 上有一个名为 vpi 的工具：http: [//www.mathworks.com/matlabcentral/fileexchange/22725](http://www.mathworks.com/matlabcentral/fileexchange/22725)

它允许您使用非常大的整数（`2^5000`？没有概率）。在计算所有内容时它只会更慢（很多），我不建议使用我上面的方法。但是，嘿，你不能拥有一切！

下载软件包，`addpath`它和以下可能会起作用：

```
N=3000;
strbin = char(randi(2,1,N)+'0'-1);

binvals=strbin-'0';
val=0;
twopow=vpi(1);
for ii=1:N
    val=val+twopow*binvals(N-ii+1);
    twopow=twopow*2;
end 
```

# c# - 基于配置的多个 .settings 文件

> ID：12354176
> 
> 赞同：2
> 
> 时间：2012-09-10T14:49:53.253
> 
> 标签：c#, .net

我想知道是否有一种方法可以`.settings`根据运行时尊重的配置来拥有多个文件。所以，目前我在文件夹下有一个`Settings.settings`和一个文件。我并不是说这无论如何都是正确的，我只是说这就是我目前所拥有的。`Release.settings``Properties`

但是，在运行这行代码时，我总是从`Settings.settings`文件中获取值。

```
Properties.Settings.Default.Setting 
```

我意识到该`Settings`行的一部分明确定义了我想要的文件，但我正在尝试找到一种方法来获取抽象的代码行，该代码行将根据配置将其拉出。

因此，与可用于在部署时简单地生成文件的不同版本的配置转换不同，我需要能够根据我正在运行的配置在运行时实际看到不同的值。

希望有人能帮忙，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-01-23T12:34:32.410

是的，有可能。我只是想自己做同样的事情。

*   从项目菜单中，选择添加新项目。“添加新项目”对话框打开。

*   在“添加新项目”对话框中，选择“设置文件”，输入文件名称，然后单击“添加”以将新设置文件添加到您的解决方案中。

*   在解决方案资源管理器中，将新的设置文件拖到属性文件夹中。这允许您的新设置在代码中可用。

*   在此文件中添加和使用设置，就像在任何其他设置文件中一样。您可以通过 Properties.Settings 对象访问这组设置。

然后您可以通过前缀引用每个设置文件。

```
 Config config = new Config();
            if (Debugger.IsAttached)
            {
                config = new Config()
                {
                    Interval = Dev.Default.Interval,
                    Username = Dev.Default.Username,
                    Password = Dev.Default.Password,
                    Directory = Dev.Default.Directory
                };
            }
            else
            {
                config = new Config()
                {
                    Interval = Settings.Default.Interval,
                    Username = Settings.Default.Username,
                    Password = Settings.Default.Password,
                    Directory = Settings.Default.Directory
                };
            } 
```

# php - 清理表单数据

> ID：12354177
> 
> 赞同：1
> 
> 时间：2012-09-10T14:49:55.460
> 
> 标签：php, mysql, sql, input-sanitization

在使用 HTML/CSS 构建网站后，我只是在学习 PHP 和脚本的基础知识。我正在尝试制作一个提交到数据库的简单表单，只是为了收集电子邮件地址和姓名。以下是我正在使用的基本代码。我对它进行了一些调整，但没什么大不了的。我知道我需要清理这些数据，并且我已经阅读了数十篇关于如何执行此操作的帖子、文章等，我只是不知道如何向其中添加 escape_string 或 PHP 函数。我以为我做到了，我已经尝试了几十种方法，但是当我测试时，它们似乎没有任何区别。我知道这样做只是我的新手无知，但我有点拉扯我的头发，所以任何帮助都会很棒。

```
 <?php
    $con = mysql_connect("localhost","peter","abc123");
    if (!$con)
   {
   die('Could not connect: ' . mysql_error());
   }

    mysql_select_db("my_db", $con);

    $sql="INSERT INTO Persons (FirstName, LastName, Age)
    VALUES
    ('$_POST[firstname]','$_POST[lastname]','$_POST[age]')";

    if (!mysql_query($sql,$con))
    {
    die('Error: ' . mysql_error());
    }
    echo "1 record added";

    mysql_close($con);
    ?> 
```

@rwhite35 这是最终结果的样子吗？

```
<?php
// sanitize a string in prep for passing a single argument to system() (or similar)
function sanitize_system_string($string, $min='', $max='')
{
  $pattern = '/(;|\||`|>|<|&|^|"|'."\n|\r|'".'|{|}|[|]|\)|\()/i'; 
  // no piping, passing possible environment variables ($),
  // seperate commands, nested execution, file redirection, 
  // background processing, special commands (backspace, etc.), quotes
  // newlines, or some other special characters
 $string = preg_replace($pattern, '', $string);
 //make sure this is only interpreted as ONE argument
 $string = '"'.preg_replace('/\$/', '\\\$', $string).'"'; 
 $len = strlen($string);
  if((($min != '') && ($len < $min)) || (($max != '') && ($len > $max)))
    return FALSE;
    return $string;
  }

$con = mysql_connect("localhost","root","root");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("form-try", $con);

$firstname = sanitize_system_string($_POST['firstname'],2,44);
$lastname = sanitize_system_string($_POST['lastname'],2,44);

$sql="INSERT INTO Persons (FirstName, LastName, Age)
VALUES
('$_POST[firstname]','$_POST[lastname]','$_POST[age]')";

if (!mysql_query($sql,$con))
  {
  die('Error: ' . mysql_error());
  }
echo "1 record added";

mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T14:51:33.463

您的代码很容易发生**[SQL 注入](http://bobby-tables.com/)**。使用**[PDO](http://php.net/manual/en/book.pdo.php)**或**[MYSQLI](http://php.net/manual/en/book.mysqli.php)**

使用 PDO 扩展的示例：

```
<?php

    $stmt = $dbh->prepare("INSERT INTO Persons (FirstName, LastName, Age) VALUES (?,?,?)");
    $stmt->bindParam(1, $_POST[firstname]);
    $stmt->bindParam(2, $_POST[lastname]);
    $stmt->bindParam(3, $_POST[age]);

    $stmt->execute();

?> 
```

这将允许您使用单引号插入记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T19:44:40.410

我认为 John Woo 指的是您将 $_POST[firstname] 直接传递给您的 INSERT 语句。那很危险。这是我用来清理输入的简单函数，然后我将使用 mysqli 进行查询。这是一种“腰带和吊带”的方法。

```
// sanitize a string in prep for passing a single argument to system() (or similar)
function sanitize_system_string($string, $min='', $max='')
{
  $pattern = '/(;|\||`|>|<|&|^|"|'."\n|\r|'".'|{|}|[|]|\)|\()/i'; 
  // no piping, passing possible environment variables ($),
  // seperate commands, nested execution, file redirection, 
  // background processing, special commands (backspace, etc.), quotes
  // newlines, or some other special characters
 $string = preg_replace($pattern, '', $string);
 //make sure this is only interpreted as ONE argument
 $string = '"'.preg_replace('/\$/', '\\\$', $string).'"'; 
 $len = strlen($string);
  if((($min != '') && ($len < $min)) || (($max != '') && ($len > $max)))
    return FALSE;
    return $string;
  } 
```

然后稍后在处理表单数据的代码中......

```
$firstname = sanitize_system_string($_POST['firstname'],2,44);
$lastname = sanitize_system_string($_POST['lastname'],2,44); 
```

此过程将使用函数 sanitize_system_string 的结果实例化变量 $firstname 和 $lastname；正在删除诸如“{,<,&,`,;”之类的字符 在您的 $_POST 变量中。这些可以被 mysql 引擎作为命令读取。此外，它设置最小和最大字符数。输入必须是最少 2 个字符且不超过 44 个字符。祝你好运

# sql-server-2008 - SQL Azure 作为链接服务器 -> 获取插入行的标识

> ID：12354185
> 
> 赞同：6
> 
> 时间：2012-09-10T14:50:27.490
> 
> 标签：sql-server-2008, azure, azure-sql-database, linked-server

我已经将我们的 Azure 云数据库设置为连接到我们的“SQL server 2008 R2”服务器的链接服务器，如下所述：http: [//blogs.msdn.com/b/sqlcat/archive/2011/03/08 /linked-servers-to-sql-azure.aspx](http://blogs.msdn.com/b/sqlcat/archive/2011/03/08/linked-servers-to-sql-azure.aspx) 我启用了 RPC 和 RPC Out，因为我在某处读到了它。

现在的问题是我无法获取刚刚插入的记录的 ID。请看一下这个测试表：

```
CREATE TABLE dbo.TEST
(
   ID INT IDENTITY(1, 1) NOT NULL
   CONSTRAINT PK_TEST_ID PRIMARY KEY CLUSTERED ( [ID] ASC )WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON)
) 
```

我还创建了这个存储过程：

```
CREATE PROCEDURE test_create @ID INT OUTPUT
AS
  BEGIN
      -- SET NOCOUNT ON added to prevent extra result sets from
      -- interfering with SELECT statements.
      SET NOCOUNT ON;

      INSERT INTO TEST
      DEFAULT VALUES

      SELECT @ID = SCOPE_IDENTITY()
  END 
```

我试图通过多种方式获取最后插入的值，但它们都不起作用：

```
DECLARE @ID INT

EXEC AZURE01.TestDB.dbo.test_create @ID OUTPUT
SELECT @ID

INSERT INTO AZURE01.TestDB.dbo.TEST DEFAULT VALUES
SELECT @ID = SCOPE_IDENTITY();
SELECT @ID

INSERT INTO AZURE01.TestDB.dbo.TEST DEFAULT VALUES
SELECT @ID = @@IDENTITY
SELECT @ID

SELECT * FROM OPENQUERY(AZURE01, 'INSERT INTO TestDB.dbo.TEST DEFAULT VALUES; SELECT SCOPE_IDENTITY() AS ID');

DECLARE @ScopeIdentity TABLE (ID int);
INSERT INTO @ScopeIdentity
EXEC AZURE01.master..sp_executesql N'
  INSERT TestDB.dbo.TEST DEFAULT VALUES;
  SELECT SCOPE_IDENTITY()';
SELECT * FROM @ScopeIdentity;

INSERT AZURE01.TestDB.dbo.TEST 
OUTPUT inserted.ID
INTO @ScopeIdentity
DEFAULT VALUES
SELECT * FROM @ScopeIdentity 
```

我理解为什么 SCOPE_IDENTITY() 和 @@IDENTITY 不起作用（因为它们是本地函数/变量，没有来自链接服务器的信息）但是带有输出参数的存储过程应该起作用，对吗？（在它工作的服务器上本地）

任何人？:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T02:58:20.700

--在 azure 数据库上创建 proc

```
create proc xxp_GetId

as

begin

--exec xxp_GetId

DECLARE @ID INT

INSERT INTO dbo.bit_CubeGetParameter DEFAULT VALUES 

SELECT @ID = SCOPE_IDENTITY();

SELECT @ID

end 
```

-- 现在在你的 sql server 上运行这个查询

```
exec <"Link Server">.<"Azure Database Name">.dbo.xxp_GetId 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T22:34:00.360

您是否考虑过使用 GUID( `uniqueidentifier`) 字段代替 或 以及`int`？

然后，您可以在客户端生成 ID（有许多工具可以生成 GUID）并将其直接传递到您的插入中。

然后，您可以选择基于 GUID 列重新选择行以获取新的 int 值，或者仅使用 GUID 字段作为您的 PK 并完成它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-07T13:52:01.550

问题是远程服务器执行。

你可以尝试的是：

在 LinkedServer 执行 @TSqlBatch

这样做是告诉另一端的数据库在本地执行 tsql。这有很多用途。也许它也可以在这种情况下使用，因为 Scope_Identity() 应该与插入一起在本地执行。

# macos - 尝试在 OS X 上链接 OpenMP 程序时 ld 返回错误

> ID：12354186
> 
> 赞同：3
> 
> 时间：2012-09-10T14:50:34.407
> 
> 标签：macos, 64-bit, openmp, linker-errors

我目前正在开发一个在 Linux (openSUSE 12.2) 和 OS X (10.8.1) 上运行的 OpenMP 程序，两者都是 x86_64。在 Linux 上链接没问题，在 OS X 上但是我收到以下错误：

```
Undefined symbols for architecture x86_64:
  "_gomp_tls_key", referenced from:
      _GOMP_barrier in libgomp.a(barrier.o)
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status
make[2]: *** [src/resolma_t] Error 1
make[1]: *** [src/CMakeFiles/resolma_t.dir/all] Error 2
make: *** [all] Error 2 
```

我该如何解决？g++ 是用 -fopenmp 调用的，所以这显然不是原因。我的 gcc 版本是`i686-apple-darwin11-llvm-gcc-4.2`，其他 OpenMP 程序链接并在同一台机器上完美运行。

# python - Shopify webhook 在产品更新/删除时不起作用

> ID：12354189
> 
> 赞同：2
> 
> 时间：2012-09-10T14:50:45.867
> 
> 标签：python, django, shopify, webhooks

**背景：**正在使用 shopify 提供的测试商店构建一个 shopify 应用程序。#Python #Django-

**问题：**我使用 python API 为我的测试商店设置了 shopify webhooks，主题为“products/update”和“products/delete”。但是当我手动更新或删除测试商店中的产品时，shopify 不会调用我的端点。

**到目前为止我的侦探工作：**我检查了以下内容：

1.  我已经确认使用 API 成功创建了 webhook。我只是使用商店的 API 列出了所有现有的 webhook，我的就在那里。

2.  我在 webhook 中为 shopify 在产品更新或删除时调用的地址/URL 是公共 url，因为它不在我的本地主机上。（不是 127.0.0.1:8000 等）

3.  我的 webhook 端点很好。当我在测试用例中手动调用我的端点时，它会做它应该做的事情。

4.  我联系了 shopify 应用程序支持人员，并被要求在此处发布此问题。

另一个小问题是，我无法在 shopify API 文档中准确找到 webhook 应该发布到我的 URL 的 JSON/XML。所以我不知道那个 JSON 会是什么样子......

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T13:51:22.917

我显然没有评论的信用，所以我会把它放在一个“答案”中 - 使用这个词非常松散 - 相反。我在 Python API 中遇到了类似的问题，但很快意识到我做错了。在我的例子中，它切换了履行状态，然后触发一封电子邮件，通知客户媒体的下载位置。

我做错的是：我直接修改了订单对象的履行属性。相反，正确的方法是获取/创建一个实现*对象*，修改它，将 order 属性指向这个对象，而不是 save() 它。这行得通。

我不知道这是否是您的问题，因为没有发布代码，但我希望这会有所帮助。

——马特

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T11:27:14.047

谢谢大家的回答，但我发现问题是别的。

I forgot to make a CSRF exemption for the POST request URL that Shopify calls and also forgot to add a trailing slash '/' at the end of the URL I told the webhook to call.

I guess I would have caught these errors if I used something like postcatcher.in as suggested in the comments above. I din't bother doing that as it looked like too much of a hassle.

# php - PHP-EWS 2010，如何设置 IsRead 标志

> ID：12354190
> 
> 赞同：5
> 
> 时间：2012-09-10T14:50:45.040
> 
> 标签：php, set, exchangewebservices, exchange-server-2010

我已经能够使用 php-ews API 从 Exchange 2010 收件箱中成功检索未读电子邮件。但是，在我获取电子邮件后，我想将电子邮件的 IsRead 属性设置为 true，以便下次获取电子邮件时不会出现这些消息。

以前有人做过吗？

编辑 ：

这就是我尝试设置 IsRead 标志的方式：

```
$message_id = ''; //id of message
$change_key = ''; //change key   
$response = $ews->GetItem($request);
        //print_r($response);exit;
        if( $response->ResponseMessages->GetItemResponseMessage->ResponseCode == 'NoError' &&
            $response->ResponseMessages->GetItemResponseMessage->ResponseClass == 'Success' ) {

            $a = array();
            $message = $response->ResponseMessages->GetItemResponseMessage->Items->Message;

            $a['message_body'] = $message->Body->_;
            $a['sender'] = $message->From->Mailbox->EmailAddress;
            $a['subject'] = $message->ConversationTopic;

            $data[] = $a;
            //process the message data.

            $messageType = new EWSType_MessageType();
            $messageType->IsRead = true;

            $path = new EWSType_PathToUnindexedFieldType();
            $path->FieldURI = 'message:IsRead';

            $setField = new EWSType_SetItemFieldType();
            $setField->Message = $messageType;
            $setField->FieldURI = $path;

            $u = new EWSType_ItemChangeType();
            $u->Updates = new EWSType_NonEmptyArrayOfItemChangeDescriptionsType();
            $u->Updates->SetItemField = $setField;
            $u->ItemId = new EWSType_ItemIdType();
            $u->ItemId->Id = $message_id;
            $u->ItemId->ChangeKey = $change_key;

            $updatedItems = new EWSType_NonEmptyArrayOfItemChangesType();
            $updatedItems->ItemChange = $u;

            $updateMessenger = new EWSType_UpdateItemType();
            $updateMessenger->ItemChanges = $updatedItems;
            $updateMessenger->MessageDisposition = 'SaveOnly';
            $updateMessenger->ConflictResolution = 'AutoResolve';

            try {
                $update_response = $ews->UpdateItem($updateMessenger);
            }catch (Exception $e){
                echo $e->getMessage();
            }
        } 
```

当我运行该文件时，出现以下错误：

```
An internal server error occurred. The operation failed. 
```

经过一段时间的调试，我得出的结论是错误发生在 NTLMSoapClient.php 文件中的 curl_exec 函数处。

我不知道从这里开始。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:31:55.057

在更新日历事件和设置 IsAllDayEvent 标志时，我遇到了类似的问题。这是对我有用的代码：

```
$ews = new ExchangeWebServices(...);

$request = new EWSType_UpdateItemType();
$request->ConflictResolution = 'AlwaysOverwrite';
$request->ItemChanges = array();

$change = new EWSType_ItemChangeType();
$change->ItemId = new EWSType_ItemIdType();
$change->ItemId->Id = $id;
$change->ItemId->ChangeKey = $changeKey;

$field = new EWSType_SetItemFieldType();
$field->FieldURI = new EWSType_PathToUnindexedFieldType();
$field->FieldURI->FieldURI = "calendar:IsAllDayEvent";
$field->CalendarItem = new EWSType_CalendarItemType();
$field->CalendarItem->IsAllDayEvent = true;

$change->Updates->SetItemField[] = $field;

$request->ItemChanges[] = $change;
$response = $ews->UpdateItem($request); 
```

我在这里看到的最大区别是您这样做`$u->Updates->SetItemField = $setField;`，而我的代码使用`$u->Updates->SetItemField[] = $setField;`.

我希望这有帮助。

编辑：您可能已经看过这个，但我的代码基于[php-ews wiki](https://github.com/jamesiarmes/php-ews/wiki/Calendar%3a-Update-Event)中的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T10:07:36.907

我尝试了包括 PathToExtendedFieldType 在内的所有方法，但它在下面为我工作的最终代码中不起作用

```
$ews = new ExchangeWebServices('red', 'red', 'red',ExchangeWebServices::VERSION_2007_SP1);

$request = new EWSType_UpdateItemType();

$request->SendMeetingInvitationsOrCancellations = 'SendToNone';
$request->MessageDisposition = 'SaveOnly';
$request->ConflictResolution = 'AlwaysOverwrite';
$request->ItemChanges = array();

// Build out item change request.
$change = new EWSType_ItemChangeType();
$change->ItemId = new EWSType_ItemIdType();
$change->ItemId->Id = $contact_id;
$change->ItemId->ChangeKey = $contact_change_key;
#$change->Updates = new EWSType_NonEmptyArrayOfItemChangeDescriptionsType();

#$change->Updates->SetItemField = array();

// Build the set item field object and set the item on it.
$field = new EWSType_SetItemFieldType();
$field->FieldURI = new EWSType_PathToUnindexedFieldType();
$field->FieldURI->FieldURI = "message:IsRead";
$field->Message = new EWSType_MessageType();
$field->Message->IsRead = true;

$change->Updates->SetItemField[] = $field;
$request->ItemChanges[] = $change;

$response = $ews->UpdateItem($request);
var_dump($response); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-05-14T11:53:42.053

好吧，我不知道它在 php 中如何，但在 C# 中还有另一个字段，必须设置：IsReadSpecified = true。

```
email.IsRead = true;
email.IsReadSpecified = true; 
```

# jpa-2.0 - 为什么需要实体管理器 clear()？- Spring3 @Transactional，JPA2/Hibernate3

> ID：12354202
> 
> 赞同：1
> 
> 时间：2012-09-10T14:51:27.573
> 
> 标签：jpa-2.0, spring-3, transactional, hibernate3

我有一个使用 JPA2/Hibernate 和 Spring @Transactional 的 JSF2 应用程序。UI（支持 bean）中没有 @Transactional 语句，只有在服务层中。（我在 DAO 中使用 @Transactional(propagation=Propagation.MANDATORY) 来确保每个调用都发生在事务中。）这一切都很好，除了......

当我通过事务服务方法打开和更新实体时，有时检索到的实体是旧的。在同一个会话中它是同一个用户并不重要，偶尔，JPA“读取”方法会返回已经（应该）已经被替换的旧实体。这让我困惑了很长时间，但事实证明这是由实体管理器中的缓存引起的。DAO 使用 @Repository 进行注释，因此注入的 EntityManager 正在被重用。本来以为交易完成后，实体管理器会自动清零。但事实并非如此。通常实体管理器会返回正确的值，但通常它会返回并返回来自较早事务的旧值。

作为一种解决方法，我在 DAO 读取方法中添加了战略 entityManager.clear() 语句，但这很难看。entityManagers 应该在每次交易后被清除。

有没有人经历过这个？有合适的解决方案吗？实体管理器可以在每次交易后清零吗？

非常感谢。

我正在使用：org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean 和 org.springframework.orm.jpa.JpaTransactionManager

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T19:47:25.057

@Transactional 注解存在于服务层。标有@Transactional 的服务方法将遵循 ACID 属性，无论在其中进行了多少 DAO 调用。

这意味着您不需要将 DAO 方法注释为@Transactional。

我正在做类似的事情，这就是我的做法，我的数据是一致的。

试试这个，看看你是否仍然得到不一致的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-20T13:16:48.603

您是否将`@PersistenceContext`注释（在 DAO 中的 EntityManager 上方）与bean 结合使用（如果您正在使用和XML 标签，则`PersistenceAnnotationBeanPostProcessor`不必定义bean）？如果没有，我想这就是你的问题的原因。`PersistenceAnnotationBeanPostProcessor``<context:annotation-config/>``<context:component-scan/>`

# c++ - 遍历一个集合

> ID：12354205
> 
> 赞同：0
> 
> 时间：2012-09-10T14:51:35.157
> 
> 标签：c++, pointers, iterator, set

我有一组整数设置一些东西；长度为 52。我正在使用循环来遍历集合，如下所示：

```
for(iterator A from 1st to 48th element)
 for(iterator B from A+1 to 49th element)
  for(iterator C from B+1 to 50th element)
   for(iterator D from C+1 to 51th element)
    for(iterator E from D+1 to 52th element)
    {
       //save the values from the actual positions in set in array[5]
    } 
```

首先，我尝试使用迭代器来实现它，但后来我意识到不可能从`position of another iterator +1`. 然后我尝试使用指针并跳过这些值，但我只正确分配了第一个值，然后我不能跳到第二个等等。

我的代码是：

```
set<int> tableAll;
for(int i=4; i!=52; ++i) 
  tableAll.insert(i);

const int * flop1 = & * tableAll.begin();
cout << * flop1 << endl;
flop1++;
cout << * flop1 << endl; 
```

当我得到`cout`指针的值时`flop1`，我得到 4 并且没关系，但是当我一次又一次地增加它时`cout`在屏幕上再次增加它时，我得到 0，然后是 49，然后是 0，然后是 1，然后是 0，而不是 5、6、7、8 和 9 .

那么如何正确地遍历我的集合呢？我假设使用指针会比一些迭代器解决方案更快。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T15:02:12.750

您绝对可以从另一个迭代器的偏移量进行迭代：

```
for (auto a(std::begin(mySet)), a_end(std::prev(std::end(mySet), 4));
        a != a_end; ++a)
    for (auto b(std::next(a)), b_end(std::next(a_end); b != b_end; ++b)
        ... 
```

在 C++03 中，您可以编写`next`和`begin`为了兼容性：

```
template<typename Iterator> Iterator next(Iterator it, int n = 1) {
    std::advance(it, n);
    return it;
}

template<typename Iterator> Iterator prev(Iterator it, int n = 1) {
    std::advance(it, -n);
    return it;
}

for (std::set<int>::const_iterator a(mySet.begin()),
        a_end(std::prev(mySet.end(), 4)); a != a_end; ++a)
    for (std::set<int>::const_iterator b(std::next(a)),
            b_end(std::next(a_end)); b != b_end; ++b)
        ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:19:17.600

这段代码不是最优的，因为它不需要迭代器比较，但是可以工作并且很简单：

```
set<int> tableAll;
for(int i=0; i!=52; ++i)
  tableAll.insert(i);

for( set<int>::iterator iA=tableAll.begin(); iA != tableAll.end(); ++iA  )
    for( set<int>::iterator iB=iA; ++iB != tableAll.end();  )
        for( set<int>::iterator iC=iB; ++iC != tableAll.end();  )
            for( set<int>::iterator iD=iC; ++iD != tableAll.end();  )
                for( set<int>::iterator iE=iD; ++iE != tableAll.end();  ) 
{
   cout<<*iA<<' '<<*iB<<' '<<*iC<<' '<<*iD<<' '<<*iE<<endl;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T16:04:22.597

我建议将 复制`set`到临时`std::vector`. 您在循环中执行的所有操作对于向量和 O(1) 来说都是自然的（当然循环本身除外）这更容易阅读、编写，并且应该运行得**更快**。

# sql - SQL，在多列中计数，然后分组

> ID：12354207
> 
> 赞同：6
> 
> 时间：2012-09-10T14:51:46.293
> 
> 标签：sql, ms-access, count, group-by

我试图在多列中计数，然后按总和分组，其中相同的数据出现在任何列中

```
Source data table:

P1  P2  P3
-----------
a   b   
a   a   a
b   c   
a   b   b
b   a 
```

我希望它显示如下内容：

```
Desired query output:

     Total
   -------------
a |    6
b |    5
c |    1 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-10T14:53:40.863

您可以使用联合查询

```
SELECT x.f1,Count(x.f1) FROM
(SELECT p1 As F1 FROM table
 UNION ALL
 SELECT p2 As F1 FROM table
 UNION ALL
 SELECT p3 As F1 FROM table) x
GROUP BY x.f1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-10T14:53:53.433

您可以`union all`在子查询和外部查询中记录`count`每个值。

```
SELECT b.a, COUNT(b.a)
FROM
    (
        SELECT P1 a
        FROM tableName
        UNION ALL
        SELECT P2 a
        FROM tableName
        UNION ALL
        SELECT P3 a
        FROM tableName
    ) b
GROUP BY b.a 
```

# java - Java - 在 UNC 中找不到带有 ö 或 ü 的文件

> ID：12354208
> 
> 赞同：2
> 
> 时间：2012-09-10T14:51:54.687
> 
> 标签：java, file-io

我正在使用[java.io.File](http://docs.oracle.com/javase/6/docs/api/java/io/File.html)来处理外部存储上的一些 PDF 文件。我正在加载它们，并在我的日志中注意到我得到了一些`File NotFoundExceptions`. 我正在查看 Exception 并注意到一个奇怪的标志（一个黑色正方形，`?`里面有 = �）[UNC](http://en.wikipedia.org/wiki/Path_%28computing%29#Uniform_Naming_Convention)。

这就是我制作文件的方式。如果这有所不同，我会从缓冲的阅读器中获取字符串。

```
 File myPathFile
    FileReader fr = new FileReader(myPathFile);
    BufferedReader br = new BufferedReader(fr)
    String o = br.readLine();
    File f = new File(o) 
```

我认为它与以下内容相同：

```
 File f = new File("\\test\ö\myFile.pdf"); //When the UNC looks like this it won't work. (the ö is �)
     File f2 = new File("\\test\myFile.pdf");   //This works 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:13:48.600

首先，它不是 URL，而是 UNC。

然后，它不是正确的 UNC，因为您忘记了一些非常重要的部分。

```
\\ComputerName\SharedFolder\Resource 
```

分组在哪里

```
[\\] flag to suggest it's a UNC
[ComputerName] The name of the remote computer
[\] separator character
[SharedFolder] The shared folder name
[\Resource] The path name of the remote file 
```

最后，您没有正确转义字符串中的特殊字符，因此您甚至可能没有离开您的机器，更不用说到达您想要的地方了。

要`\`在 Java 中键入 ，您需要知道它`\`用于*特殊*字符，如 null、退格等。因此，要获得单个正常的字符，`\`您必须键入`\\`. 这将成为你的第一个例子。

在非 Microsoft 系统上，请记住远程路径名可能使用`/`而不是`\`，并且这`/`不是转义字符，因此无需键入两次。

```
 File f = new File("\\\\test\\ö\\myFile.pdf"); 
```

这不起作用，因为您没有名为的共享文件夹`ö`

和你的第二个例子

```
 File f2 = new File("\\\\test\\myFile.pdf"); 
```

您的第二个示例不起作用，因为它缺少要打开的资源。

假设你不想离开你的机器，你会丢失本地文件名的一部分。在 Windows 上，完整路径包括通常`C:`或类似的“卷名”。

```
 File f = new File("c:\\test\\myFile.pdf"); 
```

有时人们会忽略卷名，在这种情况下，您需要依靠操作系统的好意来尝试为您查找文件。一般来说，这不是一个好主意。

```
 File f = new File("\\test\\myFile.pdf"); 
```

但即使这看起来与您的第二个示例相似，它也包含一个额外的正斜杠来转义正斜杠。虽然您的实际示例没有。

# c++ - 模板中的数组和指针

> ID：12354216
> 
> 赞同：0
> 
> 时间：2012-09-10T14:52:22.410
> 
> 标签：c++, arrays, pointers

我正在尝试编写一个具有一些功能的模板/类，但我遇到了一个看起来相当新手的问题。我有一个简单的插入函数和一个显示值函数，但是每当我尝试显示值时，我总是收到看起来像内存地址的东西（但我不知道），但我想接收存储的值（在这个特别的例子，int 2）。我不确定如何将其取消引用为一个值，或者我是否完全搞砸了。我知道向量是一个更好的选择，但是我需要在这个实现中使用一个数组——老实说，我想对代码和正在发生的事情有更透彻的理解。任何有关如何完成此任务的帮助将不胜感激。

示例输出（每次都以相同的方式运行程序）：003358C0

001A58C0

007158C0

代码：

```
#include <iostream>
using namespace std;

template <typename Comparable>
class Collection
{
public: Collection() {
    currentSize = 0;
    count = 0;
    }
    Comparable * values;
    int currentSize; // internal counter for the number of elements stored
    void insert(Comparable value) {
        currentSize++; 
                // temparray below is used as a way to increase the size of the 
                // values array each time the insert function is called
        Comparable * temparray = new Comparable[currentSize];
        memcpy(temparray,values,sizeof values);

                // Not sure if the commented section below is necessary, 
                // but either way it doesn't run the way I intended

        temparray[currentSize/* * (sizeof Comparable) */] = value; 
        values = temparray;
    }
    void displayValues() {
        for (int i = 0; i < currentSize; i++) {
            cout << values[i] << endl;
        }
    }
};

int main()
{
Collection<int> test;
int inserter = 2;
test.insert(inserter);
test.displayValues();
cin.get();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T14:59:26.473

这一行是错误的：

```
memcpy(temparray,values,sizeof values); 
```

第一次运行此行时，`values`指针未初始化，因此将导致未定义的行为。此外，使用`sizeof values`是错误的，因为它总是会给出指针的大小。

另一个问题：

```
temparray[currentSize] = value; 
```

这也将导致未定义的行为，因为您只在 中分配`currentSize`了项目`temparray`，因此您只能`0`访问`currentSize-1`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T15:30:26.813

好吧，如果你坚持，你可以编写和调试你自己的有限版本的`std::vector`.

首先，不要`memcpy`来自未初始化的指针。在构造函数中设置`values`为`new Comparable[0]`。

二、`memcpy`正确的字节数：`(currentSize-1)*sizeof(Comparable)`.

第三，完全不要`memcpy`。这假设`Comparable`类型都可以逐字节复制，这在 C++ 中是一个严重的限制。反而：

编辑：更改`uninitialized_copy`为`copy`：

```
std::copy(values, values + currentSize - 1, temparray); 
```

第四，在不再使用时删除旧数组：

```
delete [] values; 
```

第五，除非代码**很少**插入，否则将数组扩展不止一个。`std::vector`通常将其大小增加 1.5 倍。

`currentSize`第六，在大小改变之前不要增加。这会将所有这些`currentSize-1`s 更改为`currentSize`，这将不那么烦人。`<g>`

第七，一个大小数组的`N`索引从`0`到`N-1`，所以新数组的顶部元素在`currentSize - 1`，而不是`currentSize`。

第八，我有没有提到，你**真的**应该使用`std::vector`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T15:03:21.730

您的阵列访问也有错误。

```
temparray[currentSize/* * (sizeof Comparable) */] = value; 
```

请记住，数组从索引零开始。因此，对于长度为 1 的数组，您可以设置 temparray[0] = value。由于您在插入函数的顶部增加 currentSize，因此您需要这样做：

```
temparray[currentSize-1] = value; 
```

# ruby - RMagick - 如何将网格图像裁剪成图像数组？

> ID：12354222
> 
> 赞同：2
> 
> 时间：2012-09-10T14:52:29.407
> 
> 标签：ruby, imagemagick, rmagick

下面的 imageMagick 命令将一个精灵图像裁剪成几张等分的图像：

`convert image.png -crop 2x3-40-20@ +repage +adjoin tile-%d.jpg`

我用 Rmagick 做这个很热吗？但是我需要返回一组图像，而不是创建多个文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T17:40:56.430

设法通过一次裁剪每个图像来完成它：

```
def split_images
  #'image' is a ImageMagick Object
  width  = image.cols/number_cols
  height = image.rows/nubmer_rows
  images = []
  0.upto(number_rows-1) do |x|
    0.upto(number_cols-1) do |y|
      images << image.crop( Magick::NorthWestGravity, x*width, y*height, width, height, true)
    end
  end
end 
```

# objective-c - 在 Objective-C MRR 中，如果 foo 是一个保留属性，那么 self.foo = [[Foo alloc] init] 是否需要立即释放？

> ID：12354230
> 
> 赞同：1
> 
> 时间：2012-09-10T14:52:57.167
> 
> 标签：objective-c, memory-management

我正在使用 ARC，但正在阅读 Objective-C 的 MRR 部分，并且似乎`ViewController`是（对于非 ARC）的属性：

```
@property (retain, nonatomic) Foo *foo; 
```

那么`viewDidLoad`of`ViewController`将需要在and`release`之后做一个：`alloc``init`

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    self.foo = [[Foo alloc] init];
    [self.foo release];

} 
```

否则，`retain`Foo 对象在分配给`_foo`（实例变量）时会增加一次引用计数，并且`alloc`还会增加一次引用计数，因此它声称拥有两次所有权，因此，`release`在`alloc`和`init`？

我只是觉得它看起来有点奇怪，因为 an`alloc`后面紧跟着 a`release`这种方式。

（如果我们这样做是 a `self.foo = [Foo fooByString: @"hello"]`，那么自动释放池声明了一个所有权，ViewController 声明了一个所有权，并且在事件循环结束时，自动释放池耗尽，并取消声明一个所有权，因此 Foo 对象被正确拥有仅一次。（但如果 Foo 没有这样的方法并且只有`alloc`and `init`，那么就`release`需要立即数。））

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T14:58:49.753

您基本上是正确的，尽管通常有几种方法可以使它看起来不那么尴尬：

```
Foo* someFoo = [[Foo alloc] init];
self.foo = someFoo;
[someFoo release]; 
```

或者更简洁地说：

```
self.foo = [[[Foo alloc] init] autorelease]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T14:59:41.153

如果您在 viewController 的构造函数/init 上，您需要做的是：

```
_foo=[[Foo alloc] init]; 
```

为了避免不必要的释放调用，因为 alloc/init 创建了一个非自动释放的 foo 实例。此外，它将不再需要自动释放池来处理我们可以完全控制其初始化的对象。您知道您希望 foo 成为您的 viewController 的所有者。不必为了在运行循环返回时减少保留计数而两次声明所有权。

# c# - 事件仅在构建后发生？

> ID：12354231
> 
> 赞同：3
> 
> 时间：2012-09-10T14:53:00.773
> 
> 标签：c#, .net, winforms, events

我试图理解为什么我不能在构造函数的最后一行邀请事件？施工结束后是否会发生“formload”事件？

```
public Form1()
    {
        InitializeComponent();
        button1.Text = "a";
        button1.PerformClick();
    }

private void button1_Click(object sender, EventArgs e)
    {
        button1.Text = "b";
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:00:46.427

这种行为是因为如果控件是在 windows 消息上构建的，那么它仅在表单实例存在并且具有句柄时才有效，而在它仍然构建时则无效。

必须打开表单以确保控件正常工作。

在构造函数上引发事件并不是最佳实践

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:33:55.580

经测试。不依赖于创建的控件。

```
public Form1()
{
    InitializeComponent();
    button1.Text = "A";
    button1_Click_helper();
}

private void button1_Click(object sender, EventArgs e)
{
    button1_Click_helper();
}

private void button1_Click_helper()
{
    button1.Text = "B";
} 
```

# mysql - MySql 可以直接从 XML 加载吗

> ID：12354232
> 
> 赞同：1
> 
> 时间：2012-09-10T14:53:03.483
> 
> 标签：mysql, xml

我知道批量加载 XML 技术，例如[加载 XML 更新表——MySQL](https://stackoverflow.com/questions/5924973/load-xml-update-table-mysql)

MySql 可以直接从 xml 插入/替换行吗？我想将一个 XML 字符串传递给 MySQL。

像替换到用户 XML VALUES 之类的东西甚至可能使用 as 将标签映射到列名？

主要的是我不想在我的代码中解析 XML，我希望 MySql 来处理这个。我没有文件，我将 XML 作为字符串。

我查看并发现有一些 XML 函数： [12.11。XML 函数](http://dev.mysql.com/doc/refman/5.5/en/xml-functions.html)

XML 函数可以执行 XPath，但我认为这有点繁琐，因为我有一个从 XML 到表结构的 1:1 映射，所以我希望能够说，嘿 MySql，在 xml 中插入值串到表中。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:02:16.253

简而言之，没有。

您正在寻找的是用于 MySQL 的 XML 存储引擎。从来没有正式创建过，我也从未见过第三方的（但请随意谷歌）。

如果您真的想实现这一点，那么您最接近的方法是寻找替代 (R)DMS，但这可能不支持您希望执行的查询类型，可能需要一些学习曲线，毫无疑问，要求您使用具有超级用户访问权限的服务器，并且可能意味着重构大量代码。

# javascript - 冲突prototype.js 和另一个库

> ID：12354235
> 
> 赞同：1
> 
> 时间：2012-09-10T14:53:23.797
> 
> 标签：javascript, jquery

我该如何解决两个库之间的冲突问题（包括prototype.js一旦放入所有其他库的tailspin），这使我整个脚本无用？如何在不引起问题的情况下包含prototype.js？我知道 jquery.noconflict () 但我不知道将它包含在prototype.js 中的哪个位置（因为它是导致冲突的最后一个文件）。提前谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T14:57:30.580

有一个原型版本叫做[ProtoSafe](http://ajaxian.com/archives/protosafe-eases-compatibility-for-prototype)。

自从，

> ..问题是Prototype扩展了各种元素的（小p）原型来发挥它的魔力，你不能取消它（这是在这种情况下所需要的）。

来自 Protosafe 的描述

> Prototype 扩展了本机数据类型原型，这对开发人员来说非常方便，但是当与不是为 Prototype 编写的第 3 方代码交互时，这些原型扩展可能会导致兼容性问题。最常见的是数组 for-in 循环问题，通过对数组执行 for in 循环，您可以获得其索引值以及所有添加的辅助方法的方法名称。
> 
> **> ProtoSafe 提供的好处是它允许 Prototype 与 3rd 方代码一起使用，而不会导致这些兼容性问题。它还可以针对多个框架运行，这在小部件环境中是很好的。**

# windows-phone-7 - 画布元素子元素的坐标

> ID：12354237
> 
> 赞同：0
> 
> 时间：2012-09-10T14:53:28.087
> 
> 标签：windows-phone-7, canvas, coordinates

里面有几个矩形`canvas`。如何使用中的矩形获取矩形 wrt 画布的`Name`坐标`C#`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:05:36.610

您可以使用 TransformToVisual 执行此操作。这里有一个很好的例子：[Visual.TransformToVisual MSDN](http://msdn.microsoft.com/en-us/library/system.windows.media.visual.transformtovisual.aspx)

从后代页面：

```
<StackPanel Name="myStackPanel" Margin="8">
  <TextBlock Name="myTextBlock" Margin="4" Text="Hello, world" />
</StackPanel>

// Return the general transform for the specified visual object.
GeneralTransform generalTransform1 = myStackPanel.TransformToVisual(myTextBlock);

// Retrieve the point value relative to the child.
Point currentPoint = generalTransform1.Transform(new Point(0, 0)); 
```

# android - 如何在 2 个 android 应用程序之间共享数据

> ID：12354245
> 
> 赞同：0
> 
> 时间：2012-09-10T14:53:47.470
> 
> 标签：android, android-ndk

我正在开发 2 个 android parallaly 应用程序。现在我想从另一个应用程序访问一个应用程序数据，即来自文件夹 data/data/com.sampleApp1 的数据。因为这两个应用程序都将由我开发，所以可以访问一个应用程序的数据如果可能，请从另一个应用程序申请解决方案。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:00:55.097

如果您同时开发这两个应用程序，则可以使用共享用户 ID。两个应用程序将共享权限和文件。请小心并检查您是否需要/想要这个。

[http://developer.android.com/guide/topics/security/permissions.html#userid](http://developer.android.com/guide/topics/security/permissions.html#userid)

另一种选择是 ContentProvider。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:02:59.197

**请参考 developer.android 的标准内容提供者培训教程** 请在以后不会遇到任何关于内容提供者的问题后通过 [http://developer.android.com/guide/topics/providers/content-providers.html](http://developer.android.com/guide/topics/providers/content-providers.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T14:55:51.970

我不知道如何访问不同的文件夹以及是否可能。我认为对你来说最好的主意是使用内容提供者。

检查这个网站： [http ://www.vogella.com/articles/AndroidSQLite/article.html](http://www.vogella.com/articles/AndroidSQLite/article.html)

# c# - 从 C# 中的列表中获取引用/地址

> ID：12354249
> 
> 赞同：9
> 
> 时间：2012-09-10T14:53:54.790
> 
> 标签：c#, list, collections, reference

我知道 C# 不处理指针，但我想知道当我知道列表的第一个元素时是否可以获取列表的引用？例如：假设我有一个定义为的列表

```
List<T> abc 
```

如果我有 abc[0]，我可以得到 abc 的参考吗？我是 C# 新手，如果我的问题看起来很奇怪，我深表歉意。在 C/C++ 中，我可以使用 &abc[0] 获取数组 abc 的地址。当我们知道集合中的一项时，C# 是否为我们提供了类似的工具来帮助我们参考集合本身？谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-10T15:17:17.703

集合在 C# 中的工作方式与在 C++ 中的工作方式不同，例如，您可以将相同的对象添加到多个不同的集合中，因此要求获取对象所在列表的引用实际上没有意义包含在，因为它可能在许多列表中（或没有，甚至在同一个列表中多次）

```
object myObject = new object();

List<object> list = new List<object>();
list.Add(myObject);

object[] someArray = new object[] { myObject  };
Assert.AreEqual(list[0], someArray[0]); 
```

如果它对您有所帮助，您可以将 C# 中的列表视为指针列表，这些~~指针~~引用存储在指针本身对您隐藏的位置的对象，尽管要了解实际上实现可能更复杂（并且也无关紧要）。

如果列表中的对象与该列表的列表内容之间存在关系，则由您来明确声明并跟踪该 realtionsip 是什么，例如通过`Parent`列表中对象的属性

```
List<T> myList = new List<T>();

// Whenever an item is added to myList set the Parent property
myList.Add(item);
item.Parent = myList; 
```

这是 Windows 窗体为了维护容器中的控件与包含这些控件的容器之间的关系而执行的操作。显然，如果有人试图将同一个对象添加到多个列表中，您应该决定该怎么做。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2021-10-31T17:01:48.623

现在可以使用该[`System.Runtime.InteropServices.CollectionsMarshal.AsSpan`](https://docs.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.collectionsmarshal.asspan)方法，从 .NET 5.0 开始。

如文档所示，在使用跨度或从跨度中获取的项目引用时，不应将项目添加到列表中或从列表中删除。从技术上讲，这也应该扩展为`Capacity`不应该更改也不应该`TrimExcess()`调用的。如果在主动使用 span 或其引用时使用这些操作，则列表的内部内存可能不再与 span 中的内存相同。

```
// Create a simple list with three items.
var list = new List<int>();
list.Add(123);
list.Add(456);
list.Add(789);

// Print list to console.
Console.WriteLine("List items:");
foreach (var item in list)
    Console.WriteLine(item);
Console.WriteLine();

// Get a reference to the second item in the list.
// WARNING: DO NOT ADD/REMOVE ITEMS FROM THE LIST WHILE USING THIS SPAN
// OR ANY REFERENCES DERIVED FROM THIS SPAN!
var listSpan = CollectionsMarshal.AsSpan(list);
ref var secondItem = ref listSpan[1];
Console.WriteLine($"Referenced value (original): {secondItem}");

// Change the referenced list item.
secondItem = 0;
Console.WriteLine($"Referenced value (modified): {secondItem}");
Console.WriteLine();

// Print the list to console.
Console.WriteLine("List items:");
foreach (var item in list)
    Console.WriteLine(item);
Console.WriteLine(); 
```

你应该得到这样的输出：

```
List items:
123
456
789

Referenced value (original): 456
Referenced value (modified): 0

List items:
123
0
789 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-10T14:57:21.247

如果您正在设计集合中项目的类型，那么您可以向项目的类型添加一个“指向”包含列表的属性；当您构造每个项目时，传入包含列表并将其保存在属性中。

像这样的东西：

```
class ListItem
{
    public List<ListItem> Parent { get; set; }

    public ListItem(List<ListItem> parent)
    {
        Parent = parent;
    }
}

ListItem listItem = new ListItem(abc);
abc.Add(listItem);

// Get collection from item.
List<T> def = listItem.Parent; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-10T15:02:02.710

除非 abc[0] 的类型明确包含对列表的引用。事实上，如果没有明确的引用，你也不能在 C++ 中做到这一点。

想一想，在 C++ 中，如果你能预料`firstElemPtr == arrayPtr`到，这仅仅是因为数组以这种方式存储元素，而且它只适用于数组；其他一切都只是偶然。

现在考虑在指向第一个元素的指针之前分配其他东西（可能是元素计数）的任何列表结构。你的假设将不再有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-10T15:27:05.503

考虑：

```
unsafe static void Main() {
    int[] arr = new int[100];
    fixed(int* ptr = arr) {
        // ptr is a pointer to the zeroth item in the array

    }
} 
```

但是，不安全代码在 c# 中并不常见，应仅限于性能关键区域（即使在那时也要谨慎使用）。特别是，请注意我们已经通过这样做“固定”了阵列 - 请注意，只有在固定*时*`ptr`才是可靠的。在块之外，GC 可以自由地重新定位数组，使其无效。*`fixed``ptr`*

 *澄清：我不建议你这样做，但是：这样的事情是完全可能的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-10T15:07:53.223

List 的定义有点像这样：

```
public class List<T> : IList<T> blabla
{
    private T [] data;

    public T this[int index] { 
        get { return data[index]; } 
        set { data[index]=value; }
    }
    ... blabla
} 
```

是的，它不是任何类型的链表。所以你必须相应地使用它。尽管由于 .NET 值类型很小并且类类型都是引用，但通常没有繁重的数组复制操作，例如使用 C++ 就可以实现，因此通用 puprose 集合的这种实现已经足够好（除非被滥用）。从学术角度来看，Vector 可能是一个更好的名称，但事实并非如此。

您将无法获得对数据数组的引用，因为它是私有变量。你也不需要这个。如果您需要枚举器，请显式使用 GetEnumerator 或 foreach 进行隐式使用。*

# ruby-on-rails - Bootstrap-sass 支持 Bootstrap 2.1.0 中的彩色表格行标记吗？

> ID：12354253
> 
> 赞同：0
> 
> 时间：2012-09-10T14:54:08.293
> 
> 标签：ruby-on-rails, twitter-bootstrap

我正在创建一个新站点，并以此为借口使用 sass-bootstrap。在创建站点的主要布局的过程中，我发现我无法使用“可选行类”下列[出的示例对行进行着色。](http://twitter.github.com/bootstrap/base-css.html#tables)具体来说`<tr class="success">`或`="error"`。

这是 raid 控制器监视器的视图代码：

```
<div class="container">
<div class="span12 row">&nbsp;</div>

<div class="span12 row">
    <table class="table">
        <thead>
            <tr><th>Server</th><th>Status</th><th>Spare</th><th>Last Update</th></tr>
        </thead>
        <tbody>
            <% @raids.each do |raid| %>
                <% if raid.status == "OK" && raid.spare == "OK" %>
                    <tr class="success">                    
                <% else %>
                    <tr class="error">
                <% end %>
                    <td><%= raid.hostname %></td>
                    <td><%= raid.status %></td>
                    <td><%= raid.spare %></td>
                    <td><%= time_ago_in_words(raid.update_time) %> ago</td>
                </tr>
            <% end %>
        </tbody>
    </table>
</div>
</div> 
```

我的宝石：

```
 Using rake (0.9.2.2) 
    Using i18n (0.6.0) 
    Using multi_json (1.3.5) 
    Using activesupport (3.2.3) 
    Using builder (3.0.0) 
    Using activemodel (3.2.3) 
    Using erubis (2.7.0) 
    Using journey (1.0.3) 
    Using rack (1.4.1) 
    Using rack-cache (1.2) 
    Using rack-test (0.6.1) 
    Using hike (1.2.1) 
    Using tilt (1.3.3) 
    Using sprockets (2.1.3) 
    Using actionpack (3.2.3) 
    Using mime-types (1.18) 
    Using polyglot (0.3.3) 
    Using treetop (1.4.10) 
    Using mail (2.4.4) 
    Using actionmailer (3.2.3) 
    Using arel (3.0.2) 
    Using tzinfo (0.3.33) 
    Using activerecord (3.2.3) 
    Using activeresource (3.2.3) 
    Using addressable (2.2.8) 
    Using annotate (2.4.1.beta1) 
    Using bcrypt-ruby (3.0.1) 
    **Using bootstrap-sass (2.1.0.0)**
    Using nokogiri (1.5.2) 
    Using ffi (1.0.11) 
    Using childprocess (0.3.2) 
    Using libwebsocket (0.1.3) 
    Using rubyzip (0.9.8) 
    Using selenium-webdriver (2.21.2) 
    Using xpath (0.1.4) 
    Using capybara (1.1.2) 
    Using coffee-script-source (1.3.1) 
    Using execjs (1.3.2) 
    Using coffee-script (2.2.0) 
    Using rack-ssl (1.3.2) 
    Using json (1.7.3) 
    Using rdoc (3.12) 
    Using thor (0.14.6) 
    Using railties (3.2.3) 
    Using coffee-rails (3.2.2) 
    Using diff-lcs (1.1.3) 
    Using factory_girl (3.2.0) 
    Using factory_girl_rails (3.2.0) 
    Using faker (1.0.1) 
    Using guard (1.0.3) 
    Using guard-rspec (0.5.5) 
    Using jquery-rails (2.0.2) 
    Using libnotify (0.5.9) 
    Using libv8 (3.3.10.4) 
    Using mysql (2.8.1) 
    Using bundler (1.1.4) 
    Using rails (3.2.3) 
    Using rb-readline (0.4.2) 
    Using rspec-core (2.9.0) 
    Using rspec-expectations (2.9.1) 
    Using rspec-mocks (2.9.0) 
    Using rspec (2.9.0) 
    Using rspec-rails (2.9.0)  
    Using sass (3.1.18) 
    Using sass-rails (3.2.5) 
    Using sqlite3 (1.3.6) 
    Using therubyracer (0.10.1) 
    Using uglifier (1.2.4) 
```

# jquery - 更改没有 AJAX 获取请求的图像的 src 属性

> ID：12354255
> 
> 赞同：0
> 
> 时间：2012-09-10T14:54:18.280
> 
> 标签：jquery

这是另一个问题的延续：[jquery automatic image reload on src attribute update?](https://stackoverflow.com/questions/12352499/jquery-automatic-image-reload-on-src-attribute-update)

使用以下代码，即使图像似乎不在 DOM 中，我也会收到新图像 src 位置的 AJAX GET 调用：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready( function(){
            $('#button').click( function(){
                var $container = $('#container');
                var string = $container.html();
                string = string.toString();
              var $string = $(string);
                $string.attr('src', 'foo');
            });
        });
    </script>
</head>
<body>
    <div id='container'><img src='pointIcon.png'/></div>
        <button id='button'>Go!</button>
</body>
</html> 
```

关于如何在不触发 AJAX 调用的情况下操作 $string 对象的任何想法？已经尝试过.toString()、.stopPropogation()，到目前为止没有运气...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T14:59:56.633

您可以尝试将其包装在 <div style='display:none'> 中，以便在将字符串解析为 DOM 元素时不可见，这可能会阻止浏览器加载图像。如果没有，您将不得不使用字符串操作而不是 jQuery 来操作它，因为 $(string) 将为您创建 DOM 元素，这会导致创建图像然后请求图像

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:01:39.230

尝试：

```
var string=$("#container img");
string.attr('src', 'foo'); 
```

代替：

```
var string = $container.html();
string = string.toString();
var $string = $(string);
$string.attr('src', 'foo'); 
```

演示：http: [//jsbin.com/igitox/1/edit](http://jsbin.com/igitox/1/edit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T15:03:13.403

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready( function(){
            $('#button').click( function(){
                var image = $('#container img');
                image.attr('src', 'foo');
            });
        });
    </script>
</head>
<body>
<div id='container'><img src='pointIcon.png'/></div>
    <button id='button'>Go!</button>
</body>
</html> 
```

# windows-8 - Windows 8 将漫游应用数据文件保存在哪里？

> ID：12354262
> 
> 赞同：4
> 
> 时间：2012-09-10T14:54:44.777
> 
> 标签：windows-8, microsoft-metro, appdata, roaming

我正在阅读有关管理应用程序生命周期和状态的 Windows 8 教程，该教程将介绍为我的应用程序创建漫游应用程序数据的代码，这使我可以跨会话保留应用程序的数据 - 所以如果我关闭（完全关闭）我的应用程序，下次我运行它时，数据可以加载回来。

Windows 实际上将其保存在文件中的什么位置？我无法在 C:\users\username\appData\roaming 中找到它

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-10T14:59:11.573

> C:\Users\*用户名*\AppData\Local\Packages\*包号*\RoamingState

简单地调试您的应用程序并查看此实例以获取位置会更容易：

```
Windows.Storage.ApplicationDataContainer roamingFolder = Windows.Storage.ApplicationData.Current.RoamingFolder; 
```

或更确切地说：

```
var path = Windows.Storage.ApplicationData.Current.RoamingFolder.Path 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-08-17T15:04:54.423

```
String path=Environment.GetFolderpath(Environment.SpecialFolder.ApplicationData) 
```

# java - PDFBox - 获取单词位置（而不仅仅是字符）

> ID：12354266
> 
> 赞同：7
> 
> 时间：2012-09-10T14:54:55.867
> 
> 标签：java, pdf, text, extraction, pdfbox

是否可以使用 PDFBox 获取单词的位置，类似于“processTextPosition”？似乎 processTextPosition 仅在单个字符上调用，并且将它们合并为单词的代码是 PDFTextStripper （在“规范化”中）方法的一部分，它确实返回了文本的位置。是否有一种方法/实用程序也可以提取位置？（对于那些想知道动机是什么的人 - 信息实际上是一个表格，我们想检测空单元格）谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-03-10T15:57:23.213

要在从 pdf 文件中提取的文本中获取单词及其 x 和 y 位置，您必须扩展 PdfTextStripper 类并使用自定义类从 pdf 文件中提取文本，例如

```
public class CustomPDFTextStripper extends PDFTextStripper{

    public CustomPDFTextStripper() throws IOException {

    }

    /**
    * Override the default functionality of PDFTextStripper.
    */

    @Override
    protected void writeString(String text, List<TextPosition> textPositions) throws IOException{
        TextPosition firstProsition = textPositions.get(0);
        writeString(String.format("[%s , %s , %s]", firstProsition.getTextPos().getXPosition(),
                firstProsition.getTextPos().getYPosition(), text));

    }
} 
```

创建此自定义类的对象并提取文本

```
PDFTextStripper pdfStripper = new CustomPDFTextStripper();
String text = pdfStripper.getText(*pdf file wrapped as a PDDocument object*); 
```

结果文本字符串采用 [xposition, yposition, word] 的形式，由默认的单词分隔符分隔

# xmlhttprequest - 如何让 WinJS.xhr 不在 Windows 8 中缓存响应

> ID：12354267
> 
> 赞同：2
> 
> 时间：2012-09-10T14:54:58.227
> 
> 标签：xmlhttprequest, windows-8

我无法控制我正在调用的 Web 服务，因此添加标头属性不是一种选择。我尝试在 url 中添加时间戳，但没有奏效。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T15:44:57.787

一个完整的技巧是向 URL 请求添加随机参数..

```
var URL = URL + "&rnd=" + someRandomString 
```

服务器端将忽略这些参数，但 WinJS.xhr 会认为您正在发出新请求。抱歉，我没有更多时间深入研究，看看是否有更好的方法……但这是我脑海中浮现的第一件事。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-10T14:57:31.203

您可以将`If-Modified-Since`标题添加到`WinJS.xhr`函数的 options 参数的 headers 属性。

```
WinJS.xhr({ 
    url: "http://www.microsoft.com",
    headers: {
        "If-Modified-Since": "Mon, 27 Mar 2012 00:00:00 GMT"
    } })
    .done(function complete(result) {
        // Report download.
        xhrDiv.innerText = "Downloaded the page";
        xhrDiv.style.backgroundColor = "#00FF00";
}); 
```

[在这里检查。](http://msdn.microsoft.com/en-us/library/windows/apps/hh868281.aspx)

# ruby - 使用 SublimeREPL 的 irb 语法高亮

> ID：12354268
> 
> 赞同：0
> 
> 时间：2012-09-10T14:55:07.850
> 
> 标签：ruby, syntax-highlighting, sublimetext2, irb

我使用 Sublime Text 2 作为文本编辑器，使用 SublimeREPL 来获取 Ruby REPL。问题是 irb 喜欢给出如下输出：

```
irb(main):008:0> hello
NameError: undefined local variable or method `hello' for main:Object
    from (irb):8
    from /usr/bin/irb:12:in `<main>' 
```

这会混淆语法突出显示（因为末尾有额外的 ' ）。我能想出的唯一“解决方案”是导致*另一个*错误，因此 ' 匹配（或完全关闭语法突出显示，这将破坏首先将 REPL 带到 ST 的点）。

虽然只是一个小问题，但它仍然是一个烦恼。这里有人知道解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T20:03:53.827

解决这个问题的正确方法是创建一个 IRB Console.tmLanguage 来正确标记和解析 irb 的输出。

至于快速修复/解决方法，评估这将重新平衡'

```
irb(main):015:0> 0 #' 
```

# ios - UrbanAirship 通知未发送

> ID：12354269
> 
> 赞同：0
> 
> 时间：2012-09-10T14:55:12.450
> 
> 标签：ios, urbanairship.com

我收到此错误“iOS 有效负载，但没有可交付的内容（缺少 device_tokens、标签、段或别名）。”

当我尝试发送此有效负载时： {"alias": "my_alias", "aps": {"alert": "Besm Allah!"}}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T12:59:20.617

似乎 Urbanairship 在没有通知的情况下更改了 json 格式。"alias" 现在是一个数组，所以 {"aliases": ["my_alias"], "aps": {"alert": "Besm Allah!"}} 现在可以正常工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-22T22:23:53.110

根据[此链接](https://support.urbanairship.com/entries/70139918-API-FAQs)，您需要将其包含在您的 HTTP 标头中：

```
Accept: application/vnd.urbanairship+json; version=3; 
```

我遇到了同样的错误并添加此标头为我修复了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T14:58:50.183

那么您可能在 JSON 对象中缺少这些属性。

# layout - 如何在隐藏时自动调整 GTK# 窗口的大小？

> ID：12354273
> 
> 赞同：2
> 
> 时间：2012-09-10T14:55:23.993
> 
> 标签：layout, resize, window, gtk, gtk#

在我的应用程序中，我有两个可以更改窗口布局的切换按钮。他们将删除或添加按钮，从而有效地改变请求的总大小。由于该窗口的 Resizeable 属性设置为 false，通常窗口会自动调整大小以适应其内容，无论它们比以前大还是小。

但是，如果我在窗口隐藏时更改布局，则在使其可见后，窗口的尺寸将不会更改以适应布局。我移动它后它会自动调整大小。

```
//Code example
Window.Hide();
ChangeLayout(Window);
Window.Show(); 
```

我假设 GTK 在容器不可见时跳过检查大小变化。有没有办法强制它重新计算它的大小？

谢谢你。

PS：似乎只发生在Windows中。也许这与操作系统有关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:18:33.540

我没有 Windows 机器来测试它，但试试这个作为一种解决方法：

```
Window.Hide();
ChangeLayout(Window);
Window.Unrealize();
Window.Show(); 
```

您也可以尝试在更改布局之前将窗口设置为可调整大小，然后将其设置为不可调整：

```
Window.Hide();
Window.Resizable = true;
ChangeLayout(Window);
Window.Resizable = false;
Window.Show(); 
```

# python - python中的Unicode编码

> ID：12354278
> 
> 赞同：2
> 
> 时间：2012-09-10T14:55:33.760
> 
> 标签：python, unicode

> **可能重复：**
> [在 Python 中将 XML/HTML 实体转换为 Unicode 字符串 在 Python 字符串中](https://stackoverflow.com/questions/57708/convert-xml-html-entities-into-unicode-string-in-python)
> [解码 HTML 实体？](https://stackoverflow.com/questions/2087370/decode-html-entities-in-python-string)

我正在使用 Python 2.7，并且在 unicode 类型中迷失了方向。我查找了各种帮助文件和教程，因为我无法让它在我需要的上下文中实际工作。 [http://docs.python.org/howto/unicode.html](http://docs.python.org/howto/unicode.html)

我有一个带有名称的库，它被解码保存，例如。亚伦的我需要将名称编码为用户友好的方式似乎是编码的基本答案

```
a ='aaron&#39;s,'
unicode(a)
a.encode('ascii', 'replace') 
```

返回：

```
'aaron&#39;s,' 
```

这不是我要找的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T14:58:46.543

您正在寻找*HTML 实体解码*，而不是 Unicode（或编解码器）解码。

请参阅[在 Python 字符串中解码 HTML 实体？](https://stackoverflow.com/questions/2087370/decode-html-entities-in-python-string)方法来做到这一点。

# php - 如何实现基于关系的 Doctrine2 过滤器？

> ID：12354285
> 
> 赞同：6
> 
> 时间：2012-09-10T14:55:59.597
> 
> 标签：php, symfony, doctrine-orm, symfony-2.1

我有一个 Doctrine2 侦听器和过滤器，作为过滤掉任何未批准/草稿实体的一种手段，它在它所应用的实体上运行良好，但是，我不知道如何让它适用于它的关系。

假设该实体称为类别，然后我有与该类别相关的产品，当我`findBy()`为产品执行时，我需要查询以检查它们相关的类别是否已获得批准。

> `select * from products p`
> **`left join category c on p.category_id = c.id`**
> `where p.id = 5` **`and c.approved = true`**

粗体字是我的过滤器或等效物需要注入的。

我该如何实施呢？

到目前为止，我在过滤器中注入了一个子查询作为 where 的一部分，但这看起来很糟糕，我认为必须有更好的方法：

```
class ApprovableFilter extends SQLFilter
{
    protected $listener;
    protected $entityManager;

    public function addFilterConstraint(ClassMetadata $targetEntity, $targetTableAlias)
    {
        $config = $this->getListener()->getConfiguration($this->getEntityManager(), $targetEntity->name);

        /* this bit works fine for the category */

        if (isset($config['approvable']) && $config['approvable']) {
            $column = $targetEntity->columnNames[$config['fieldName']];

            return $targetTableAlias.'.'.$column.' = true';
        }

        /* this bit works for products.. but seems like a pretty poor solution */

        if (isset($targetEntity->associationMappings['category'])) {
            $config = $this->getListener()->getConfiguration(
                $this->getEntityManager(),
                $targetEntity->associationMappings['category']['targetEntity']
            );

            return '(
                select d.id from dealership d
                where d.id = '.$targetTableAlias.'.dealership_id
                and d.'.$config['fieldName'].' = true
            ) is not null';
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-04-14T07:51:34.653

使用注释可以使您的解决方案更加通用。我写了一个关于它的要点：[https ://gist.github.com/technetium/0c62164400a411e9ffc3713260448b25](https://gist.github.com/technetium/0c62164400a411e9ffc3713260448b25)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T20:28:07.040

我能想到的最好的方法是通过 Category 对象检索您的 Products。
这样你只需要过滤 category.approved 字段。

例如：

```
public function addFilterConstraint(ClassMetadata $targetEntity, $targetTableAlias)
{
    $config = $this->getListener()->getConfiguration($this->getEntityManager(), $targetEntity->name);

    /* this bit works fine for the category */

    if (isset($config['approvable']) && $config['approvable']) {
        $column = $targetEntity->columnNames[$config['fieldName']];

        return $targetTableAlias.'.'.$column.' = true';
    }
} 
```

然后你的 Category 实体应该有一个 products 集合（假设你有一个双向关系）。

```
use Doctrine\Common\Collections\ArrayCollection;

class Category {
    /**
     * @var ArrayCollection $products
     * @ORM\OneToMany(targetEntity="Product", mappedBy="category")
     */
    private $products;

    public function __construct()
    {
        $this->products = new ArrayCollection;
    }

    public function getProducts()
    {
        return $this->products;
    }
} 
```

这样您就可以首先检索您的类别

```
$category = $this->get('doctrine')->getRepository('SomeBundle:Category')->find(5);
if( $category ) {
    //Here you now the category is approved
    $products = $category->getProducts();
} 
```

希望这可以帮助。

# 编辑：

回答@lracicot 问题并举例说明单向关系：我将创建一个 ProjectRepository 方法，例如：

```
...
findByCategoryApproved( $product_id, $approved = true )
{
    $query =
        'SELECT p
         FROM AcmeBundle:Product
         LEFT JOIN p.categories c
         WHERE p.id = :id AND c.approved = :approved';

    return $this
        ->getEntityManager()
        ->createQuery( $query )
        ->setParameter( 'id', $product_id )
        ->setParameter( 'approved', $approved )
        ->getOneOrNullResult();
} 
```

...

```
$product = $doctrine
     ->getRepository('AcmeBundle:Product')
     ->findByCategoryApproved(5); 
```

# android - TextView 上的 Swipe/Fling 也会随机运行其 onLongClick

> ID：12354286
> 
> 赞同：1
> 
> 时间：2012-09-10T14:56:02.407
> 
> 标签：android, textview, swipe, touch-event, onlongclicklistener

我有一项活动，我希望能够在其中收听滑动。我的活动内部有一个`ScrollView`活动，并且一个很大的活动`TextView`已填满了该 ScrollView 的所有区域。为了在我的整个活动上启用滑动，我扩展了`Activity`类并定义`SwipeActivity`如下：

```
public abstract class SwipeActivity extends Activity {

private static final int SWIPE_MIN_DISTANCE = 120;
private static final int SWIPE_MAX_OFF_PATH = 250;
private int SWIPE_THRESHOLD_VELOCITY;
private GestureDetector gestureDetector;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    gestureDetector = new GestureDetector(new SwipeDetector());
    ViewConfiguration configuration = ViewConfiguration.get(this);
    SWIPE_THRESHOLD_VELOCITY = configuration.getScaledMinimumFlingVelocity();
}

private class SwipeDetector extends SimpleOnGestureListener {
    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
            float velocityY) {

        // Check movement along the Y-axis. If it exceeds
        // SWIPE_MAX_OFF_PATH,
        // then dismiss the swipe.
        if (Math.abs(e1.getY() - e2.getY()) > SWIPE_MAX_OFF_PATH)
            return false;

        // Swipe from right to left.
        // The swipe needs to exceed a certain distance (SWIPE_MIN_DISTANCE)
        // and a certain velocity (SWIPE_THRESHOLD_VELOCITY).
        if (e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE
                && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
            leftSwipe();
            return true;
        }

        // Swipe from left to right.
        // The swipe needs to exceed a certain distance (SWIPE_MIN_DISTANCE)
        // and a certain velocity (SWIPE_THRESHOLD_VELOCITY).
        if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE
                && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
            rightSwipe();
            return true;
        }

        return false;
    }
}

@Override
public boolean dispatchTouchEvent(MotionEvent ev) {
    // TouchEvent dispatcher.
    if (gestureDetector != null) {
        if (gestureDetector.onTouchEvent(ev))
            // If the gestureDetector handles the event, a swipe has been
            // executed and no more needs to be done.
            return true;
    }
    return super.dispatchTouchEvent(ev);
}

@Override
public boolean onTouchEvent(MotionEvent event) {
    return gestureDetector.onTouchEvent(event);
}

protected abstract void rightSwipe();

protected abstract void leftSwipe();
} 
```

现在我可以捕获任何扩展 SwipeActivity 的活动`rightSwipe()`。`leftSwipe()`所以，我这样宣布我的主要活动：

```
public class ContentActivity extends SwipeActivity implements OnLongClickListener {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // Here I add a TextView programmatically to my Vertical ScrollView and set this activity to listen to its long clicks (touches)
        ScrollView scrollView = (ScrollView) findViewById(R.id.content_scroll);
        TextView textView = new TextView(ContentActivity.this);
        textView.setText("Some Really Long Text!");
        textView.setOnLongClickListener(this);
        scrollView.addView(textView);
    }      

    @Override
    public boolean onLongClick(View v) {
        return doLongClickAction();
    }

    @Override
    public void rightSwipe() {
        doSwipeAction();
    }

    @Override
    public void leftSwipe() {
        doSwipeAction();
    }

} 
```

现在，一切看起来都很好，垂直`scrollView`滚动正确，滑动动作和长按可以正常工作`textView`，除了一件事：

**从我在 上滑动大约 10 次，`textView`它启动了 3 次，`doLongClickAction()`这`doSwipeAction()`对用户根本不友好。**

我知道我的问题与触摸事件的碰撞有关，但是经过数小时的研究和测试，我无法解决它。你能告诉我我的错误在哪里吗？

*（我应该补充一点：当我捕获点击而不是长按 TextView 时，一切正常，但是当用户点击 textview 内的链接时，会启动 textview 的 onClick 事件，然后打开浏览器！）*

# log4j - Procrun 和 log4 配置

> ID：12354287
> 
> 赞同：0
> 
> 时间：2012-09-10T14:56:03.337
> 
> 标签：log4j, procrun

我正在`procrun`为我的 java 进程启动 Windows 服务。我可以启动服务，但我设置的 log4j 配置似乎不起作用。这是我在创建的`stderr`文件中看到的`procrun`：

```
log4j:WARN No appenders could be found for logger (com.jar.aa.MainEntry).
log4j:WARN Please initialize the log4j system properly. 
```

这是我指定的用于安装服务的命令：

`%INSTALL_SERVICE_CMD% //IS//SERVICEAGENT --DisplayName="DispName" --Install=%SERVICE_EXE_HOME%\prunsrv.exe --LogPath=%INSTALLER_HOME% --LogLevel=Info --StdOutput=auto --StdError=auto --StartMode=Java --StopMode=Java --Jvm=auto --Startup=auto --JvmMx=512 ++JvmOptions=-XX:MaxPermSize=128m --StartPath=%START_CLASS_PATH%\ --Classpath=%CLASSPATH%;MyJar.jar --StartClass=com.jar.aa.MainEntry --StopClass=com.jar.aa.ExitEntry ++StopParams=--stop ++JvmOptions=-Dfile.encoding=UTF8 ++JvmOptions=-Dlog4j.configuration=log4j.properties ++JvmOptions=-Dorg.apache.commons.logging.LogFactory=org.apache.commons.logging.impl.LogFactoryImpl`

我将我的 log4j 属性放置在与此安装脚本相同的目录中。

谁能告诉我我可能会错过什么？任何帮助将不胜感激。

谢谢，
克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T21:37:53.117

我不确定我的记忆是否正确，但我认为我遇到了同样的问题并通过在我的 jar 文件中包含 log4j 配置文件来解决它。在你的情况下 MyJar.jar。

如果仍然出现问题，请尝试将您的 jar 放在类路径定义的开头。高温高压

# java - 扩展Java类时在Scala中实例化嵌套类

> ID：12354288
> 
> 赞同：0
> 
> 时间：2012-09-10T14:56:07.767
> 
> 标签：java, scala

我有抽象 java 类，其中包含声明为的嵌套类`protected static`：

```
public abstract class AbstractJavaClass {
  // contains nested class
  protected static class InnerClass {
  ...
  }
} 
```

当我尝试在扩展 AbstractJavaClass 的 Scala 类中实例化它时，就像我在 java 中所做的那样（即仅在方法 new InnerClass 中引用名称）：

```
class ScalaClass extends AbstractJavaClass {
   def method = new InnerClass()
} 
```

我收到错误：*类型 InnerClass 不是 ScalaClass 的成员*。我究竟做错了什么？java中的相同工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:07:28.620

在这里偶然发现：[在scala中访问java基类的静态成员](https://stackoverflow.com/questions/12034017/access-java-base-classs-static-member-in-scala)

它说

```
This isn't possible in Scala. Since Scala has no notation of static you can't
access protected static members of a parent class. This is a known limitation. 
```

虽然我无法解决最初的问题（当 class 为 时`protected static`），但当我将其更改为`public static`定义时，`AbstractJavaClass`我可以这样使用它：

```
class ScalaClass extends AbstractJavaClass {
  import AbstractJavaClass.InnerClass

  def method = new InnerClass
} 
```

使用`new InnerClass`不导入会产生同样的错误。

# jquery - 来自 ajax 的 JSON 解析在 IE8 中不起作用

> ID：12354294
> 
> 赞同：0
> 
> 时间：2012-09-10T14:56:15.200
> 
> 标签：jquery, ajax, json, internet-explorer-8

我正在使用 jQuery 1.8，并且我有一个返回 JSON 的 ajax 调用。如果有错误，它只会返回`{ "status": "there was an error" }`，否则它会返回一个文档，该文档是 ajax 请求意味着要加载的数据，看起来像`{ "document": { ... } }`

在 Firefox 和 Chrome 上，以下代码有效，但在 IE8 上，我收到一条错误消息`data.status is null or not an object`（当请求的 URL 明确返回文档而不仅仅是状态时），这会导致脚本崩溃。有人知道如何绕过 IE8 上的此错误消息吗？

```
$.ajax({
    url: "GanttLoader.ashx?action=loadGantt&gantt=" + current_selected_gantt + "&userId=" + userId,
    context: document.body,
    type: "GET",
    dataType: "json",
    success: function (data) {
        if (data.status != null) {
            if (data.status == "none") {
                alert("no gantts found when attempted to load");
            } else if (data.status == "locked") {
                alert("this gantt is locked");
            }
        } else if (data.document != null) {
            /* process the gantt */
        }
    },
    error: function () {
        alert("couldn't load gantt charts");
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:01:54.450

确保您的响应的 Content-Type 是 application/json

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:10:02.577

会不会是 data.status 不是 null，而是“未定义”？也许用 undefined 测试 data.status 会做正确的工作。

```
if (data.status != undefined)
{
...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T17:43:49.560

JSON 响应实际上没有发送任何内容，因为在 IE8`userId`中为空，破坏了我的 .ashx 处理程序。因为我的 cookie 解析代码（未显示）在 Chrome / FF 上有效，但在 IE 上无效，所以我认为 URL 输入正确。我搬到了 jquery cookie 插件，问题得到了解决（为什么 cookie 解析和设置在 jQuery 中不是标准的？）。感谢您的所有帮助，即使这是我的错误。

# apache-flex - 将弹出面板中的三角形添加到一个点

> ID：12354298
> 
> 赞同：2
> 
> 时间：2012-09-10T14:56:34.293
> 
> 标签：apache-flex, dictionary, geometry, shape

我正在尝试将弹出窗口“地址详细信息”中的三角​​形形状添加到我在地图上的定位点。尝试使其具有地址详细信息来自精确点的效果。我试着弄乱 Abode 的一些代码来显示一个三角形，但它所做的只是让我的地址详细信息消失。这是我尝试使用的 Abode 的网站。[http://livedocs.adobe.com/flex/3/html/help.html?content=Drawing_Vector_Graphics_4.html](http://livedocs.adobe.com/flex/3/html/help.html?content=Drawing_Vector_Graphics_4.html)

如果有人可以帮助我弄清楚如何做三角形，或者对我想要完成的工作提出其他建议，将不胜感激。

![在此处输入图像描述](../Images/3010026adf8b9867b2e601d506a43839.png)

编辑：显示我尝试过的代码

```
 // green triangle, starting at point 200, 0
triangle.graphics.beginFill(0x00FF00);
triangle.graphics.moveTo(200 + triangleHeight/2, 0);
triangle.graphics.lineTo(200 + triangleHeight, triangleHeight);
triangle.graphics.lineTo(200, triangleHeight);
triangle.graphics.lineTo(200 + triangleHeight/2, 0);

this.addChild(triangle);

    var line:Graphics;
                        line.moveTo(100,100);
                        line.lineTo(200,200); 
```

以上是我尝试过的两种不同的方法。我没有尝试完全匹配这些点，只是试图让它首先显示。但是，如果我添加了其中的任何一个，我就不会看到任何形状，也不会出现任何错误，而且我的地址详细信息面板将简单地显示蓝色标题，仅此而已。

这是我想尝试做的。 ![在此处输入图像描述](../Images/90513831cbb293edffce4f91611bc71d.png)

# java - Hibernate UserType 将@Formula 结果映射到非实体自定义对象

> ID：12354299
> 
> 赞同：4
> 
> 时间：2012-09-10T14:56:34.477
> 
> 标签：java, oracle, hibernate, hibernate-mapping

使用休眠 3.5.3：

数据库中有一个函数（使用 Oracle 的流水线表函数），它在提供实体 ID 时返回许多行和值。（此功能是无法更改的遗留代码的一部分）。

结果示例：

```
select * from table(DateOptions_Function('ID_OF_ENTITY'));

OPTION       DATE       
-----------------------
startDate    2012/09/01    
endDate      2013/04/01
otherDate    2011/01/01 
```

我想将 a `@Formula`（包含上述 SQL）的结果映射到实体上的对象。

```
 public class DateOptions {
     private LocalDate startDate;
     private LocalDate endDate;
     private LocalDate otherDate;

     // getters and setters omitted
 } 
```

我想在实体中像这样映射它：

```
@Formula("(select * from table(DateOptions_Function(ENTITY_ID)))")
@Type(type = "mypackage.DateOptionsUserType")
public DateOptions getDateOptions() {
    return dateOptions;
} 
```

我尝试创建一个 Hibernate `UserType`，希望使用in创建一个`DateOptions`对象。`ResultSet``nullSafeGet(...)`

我在我的`DateOptionsUserType`

```
public int[] sqlTypes() {
    return new int[] {Types.VARCHAR, Types.DATE}; 
} 
```

我在启动时不断收到以下异常：（ `org.hibernate.MappingException: property mapping has wrong number of columns: mypackage.MyEnity.dateOptions type: mypackage.DateOptionsUserType`我也尝试`CompositeUserType`过相同的结果）。

知道可能导致问题的原因吗？是否有可能（将 a 映射`@Formula`到自定义非实体对象）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T08:30:04.977

因为您基本上有 3 个带有公式的字段，所以我会看看执行该函数 3 次是否仍然足够快

```
@Formula("(select DATE from table(DateOptions_Function(ENTITY_ID))) WHERE option='startDate'")
private LocalDate startDate;

@Formula("(select DATE from table(DateOptions_Function(ENTITY_ID))) WHERE option='endDate'")
private LocalDate endDate;

@Formula("(select DATE from table(DateOptions_Function(ENTITY_ID))) WHERE option='otherDate'")
private LocalDate otherDate; 
```

# android - Location#distanceTo(Location) 是否考虑 Location#getAccuracy() ？

> ID：12354301
> 
> 赞同：1
> 
> 时间：2012-09-10T14:56:35.963
> 
> 标签：android, location

我想写一个`LocationListener`以最近最准确和最精确的位置作为它的位置。我打算在我的`LocationListener`：

```
 @Override
    public void onLocationChanged(Location location) {
        if(location.distanceTo(mLocation)>location.getAccuracy()){
            mLocation = location;
        }
    } 
```

如果用户的旧位置在新位置指示的“可能位置”圈*之外，我打算这样做是更新位置。*因此，例如，如果我们上次测量的是 GPS 信号，而新的信号是手机信号塔，而旧位置在手机信号塔的范围内，我们不会更新；另一方面，如果手机信号塔足够远，我们就知道用户已经移动并记录下来。

但是，该`distanceTo(Location)`函数声明它返回位置之间的*近似*距离（以米为单位）。它是否已经考虑到准确性？它会给我一个足够精确的数字让我以这种方式使用吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T21:23:52.150

简短的回答是否定的，在测量距离时`Location.distanceTo(Location)`不考虑值。`Location.getAccuracy()`

这是来自 Android 平台的用于计算距离的实际代码`Location.distanceTo(Location)`： [https ://github.com/android/platform_frameworks_base/blob/master/location/java/android/location/Location.java#L272](https://github.com/android/platform_frameworks_base/blob/master/location/java/android/location/Location.java#L272)

它根据给定的纬度和经度（不考虑准确性）使用 Vincenty 的逆公式（[http://www.ngs.noaa.gov/PUBS_LIB/inverse.pdf](http://www.ngs.noaa.gov/PUBS_LIB/inverse.pdf) - 第 4 节）。

至于您更新“真实”用户位置的方法是否“足够精确”，这实际上取决于 GPS 灵敏度、准确度和精度，这可能因设备而异。

来自 OEM 的准确度估计值`Location.getAccuracy()`也可能有很大差异，通常我见过的设备会高估准确度（即，设备给出的准确度值大于真实准确度）而不是低估准确度。

您可能想查看我创建的“GPS Benchmark”（[http://www.gpsbenchmark.com/](http://www.gpsbenchmark.com/)）应用程序，该应用程序有助于在 Android 设备上快速对位置提供程序的准确性（GPS 和网络）以及“估计准确性”准确性进行基准测试. 我还根据一些 Java ME 设备的 GPS 基准测试结果与人合着了一篇关于这个主题的论文 ( [http://journals.cambridge.org/repo_A82eaJIy](http://journals.cambridge.org/repo_A82eaJIy) )，其中大部分材料也与 Android 相关。

# c++-amp - 未来会出现哪些新的 C++ AMP 加速器？

> ID：12354303
> 
> 赞同：4
> 
> 时间：2012-09-10T14:56:48.757
> 
> 标签：c++-amp

我一直在学习 C++ AMP，我所看到的一切都强调 AMP 在“加速器”上工作，而不仅仅是 GPU。我认为今天所有的加速器都是GPU，但未来可能会有不同类型的加速器。那么还有什么可以作为加速器呢？是现在正在开发新型加速器，还是 AMP 只是想成为未来的证明？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-10T16:22:02.583

加速器代表可以执行 C++ AMP 代码的设备。你是对的，在大多数情况下它将是一个 GPU，但即使在 Visual Studio 2012 中也有其他类型的加速器可用。

此类加速器的一个示例是 Windows 高级光栅化平台 (WARP) 设备，它是利用多核和 SSE2 的 CPU 回退。有关 WARP 的更多信息，请参阅：

*   [http://msdn.microsoft.com/en-us/library/gg615082(v=VS.85).aspx](http://msdn.microsoft.com/en-us/library/gg615082(v=VS.85).aspx)
*   [http://www.danielmoth.com/Blog/Running-C-AMP-Kernels-On-The-CPU.aspx](http://www.danielmoth.com/Blog/Running-C-AMP-Kernels-On-The-CPU.aspx)

还有一个是软件参考设备，一个对调试有用的仿真器。有关参考设备的更多信息，请参阅：http: [//blogs.msdn.com/b/nativeconcurrency/archive/2012/03/11/direct3d-ref-accelerator-in-c-amp.aspx](http://blogs.msdn.com/b/nativeconcurrency/archive/2012/03/11/direct3d-ref-accelerator-in-c-amp.aspx)

在 Visual Studio 2012 中，需要可以执行放大器限制代码的 C++ AMP 加速器来支持 DirectX11。请注意，此类要求并不意味着所有加速器都是 GPU，例如 WARP、参考设备、AMD Fusion 或 Intel Ivy Bridge。未来我们可能会放宽 DirectX11 要求，以允许更多能够执行数据并行算法的加速器。

# java - Wicket - 当 TextField 为空时，IValidator 不调用验证

> ID：12354305
> 
> 赞同：2
> 
> 时间：2012-09-10T14:56:52.107
> 
> 标签：java, forms, validation, wicket

我有一个实现`IValidator`. 我将此验证器类添加到我的中，并调用`TextField`了覆盖的方法。`validate(Invalidatable<T>)`但是，如果`TextField`为空，则不会调用该方法，并且不会进行验证。为什么会这样？这是预期的行为吗？

**验证器类**

```
public class CorporateNameValidator implements IValidator<String> {

        private static final String ERROR_EMPTY = "Error";

        @Override
        public void validate(IValidatable<String> validatable) {

            //Method not called when TextField has blank value.

            final String name = validatable.getValue();

            info("NAME: " + name);
        }
    } 
```

**实例化文本域**

`corporateNameInput = new TextField<String>(CORPORATE_NAME_INPUT_ID, new PropertyModel<String>(this, ""));`

**设置文本字段属性**

`corporateNameInput.add(new CorporateNameValidator());` `corporateNameInput.setOutputMarkupPlaceholderTag(true);`

然后我将 TextField 添加到表单中。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-10T15:09:17.340

从 JavaDoc 的`IValidator`：

> 表示可以验证`IValidatable`对象的验证器的接口。
> 
> 除非验证器`INullAcceptingValidator`也实现了接口，否则 Wicket 不会将`null`值传递给`IValidator#validate(IValidatable)`方法。

它是按设计的，您应该实施`INullAcceptingValidator`。

# wpf - WPF 数据库应用程序的最佳部署策略

> ID：12354310
> 
> 赞同：0
> 
> 时间：2012-09-10T14:57:05.600
> 
> 标签：wpf, database

我有一个 WPF 应用程序，它与本地 sql server db 交互（每个用户都是本地的，这也更适合这个 .mdf 或 .sdf ??）。我只是将安装程序提供给用户。

所以需要的是，如果用户是第一次安装应用程序，那么应该创建数据库，但是当更新新版本时，数据（特定于用户）不应该被覆盖，它应该是保留而应合并对数据库的更改（如果以编程方式完成，则可以）。

那么我该怎么做呢？我已经浏览了很多 WPF DB 应用程序示例，但没有一个提到在更新应用程序时如何保留用户数据....请建议我最好的方法或我应该知道的最佳实践？

# jquery - 上一个/下一个的 JQuery 循环图像图标

> ID：12354321
> 
> 赞同：0
> 
> 时间：2012-09-10T14:57:42.603
> 
> 标签：jquery, css, image, cycle

我试图找出如何用实际图像替换链接“上一个”和“下一个”（我想使用小箭头图标）。

```
$('#s2').cycle({ 
    fx:     'fade', 
    speed:  'fast', 
    timeout: 0, 
    next:   '#next2',    <-- use small PNG image instead? 
    prev:   '#prev2'     <-- use small PNG image instead?
}); 
```

我在这里指的是 Malsup 示例：http: [//jquery.malsup.com/cycle/int2.html](http://jquery.malsup.com/cycle/int2.html)。有没有办法做到这一点？那些 next2, prev2 类是我可以在 CSS 中单独设置样式的类吗？

谢谢JM

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:06:33.223

下一个和上一个链接附有 ID，而不是类，因此只需使用这些 ID 来设置链接样式。

```
a#prev2 {
    // some styles here
}

a#next2 {
    // some styles here
} 
```

# javascript - CSS nth-child 调节使用 LESS？

> ID：12354322
> 
> 赞同：0
> 
> 时间：2012-09-10T14:57:50.267
> 
> 标签：javascript, css, less

假设我有一个列表，其中包含由类确定的默认状态和活动状态，例如：

```
<li class="item">
    item1
</li>
<li class="item active">
    item2 active
</li>
<li class="item active">
    item3 active
</li>
<li class="item">
    item4
</li> 
```

**我需要根据列表中的活动项目是否彼此相邻添加一些额外的样式**- 在上面的情况下，对于 item2 和 item3 都是如此，它们都是活动的，但如果它是 item2 则不会是真的和第 4 项。

我知道如何使用纯 JavaScript 来确定这一点，但不确定它是否可以成为 LESS 生成的样式表的一部分（我更喜欢它，因此这个问题）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:06:14.503

CSS 中没有任何内容可以涵盖这两个方面：[http](http://www.w3.org/TR/css3-selectors/#combinators) ://www.w3.org/TR/css3-selectors/#combinators 。LESS 可能提供的任何东西都是 js 扩展。

# ruby-on-rails - 为什么 Ruby on Rails 的 AssociationProxy 被弃用，是什么取代了它？

> ID：12354331
> 
> 赞同：1
> 
> 时间：2012-09-10T14:58:37.980
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

根据 API Dock，[`ActiveRecord::Associations::AssociationProxy`](http://apidock.com/rails/ActiveRecord/Associations/AssociationProxy)现在已“弃用或移动”。我很好奇这堂课发生了什么。如果它真的不再存在，Rails 现在如何处理关联？根据该站点上的其他几篇文章（例如[这个](https://stackoverflow.com/questions/1529606/how-do-rails-association-methods-work)），`AssociationProxy`对于允许诸如`User.find(1).groups << Group.find_by_id(13)`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T16:18:07.387

根据版本 3.1.0 的 ActiveRecord 更改日志：

> *   ActiveRecord::Associations::AssociationProxy 已拆分。现在有一个 Association 类（和子类）负责对关联进行操作，然后是一个名为 CollectionProxy 的单独的瘦包装器，它代理集合关联。
>     
>     
>     
>     这可以防止命名空间污染，分离关注点，并允许进一步重构。
>     
>     
>     
>     奇异关联（has_one、belongs_to）根本不再有代理。他们只是返回相关的记录或 nil。这意味着您不应该使用未记录的方法，例如 bob.mother.create - 请改用 bob.create_mother。

# xul - 如何从 xulrunner 中的浏览器内容页面调用 chrome 函数

> ID：12354336
> 
> 赞同：1
> 
> 时间：2012-09-10T14:58:50.590
> 
> 标签：xul, xulrunner

我正在将最初在 Firefox 中作为远程签名 jar 文件运行的代码转换为使用 XULRunner。有几个报告被实现为带有输出选项的网页。选项包括 HTML 页面或用 XUL 和 Javascript 编写的报告查看器。

当用户提交表单并选择报表查看器时，我需要打开一个 chrome 窗口。显然，出于安全原因，这不能直接完成。我想提供一个函数或使用某种消息传递方法向包含的 chrome 发出信号，表明需要发生什么。

这可以做到吗？如果可以，怎么做？我正在考虑的事情：1）向内容窗口的窗口或文档对象添加一个函数 2）某种消息传递函数 3）某种客户事件发送/接收 4）一个带有处理程序的特殊 URL 表单，例如 repviewer：/ /repname/参数

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T06:45:08.467

[MDN 上有一篇关于这个主题](https://developer.mozilla.org/en-US/docs/Code_snippets/Interaction_between_privileged_and_non-privileged_pages#Sending_data_from_unprivileged_document_to_chrome)的相当详尽的文章。在不危及安全的情况下实现此目的的最佳方法是从您的网页发送一个通用事件。顶部 XUL 文档应该调用`addEventListener()`第四个参数集，`true`这将允许它接收此类不受信任的事件。数据可以通过事件目标的属性传递，然后 XUL 文档可以检查该属性。

# axapta - 企业门户开发 - 将 AXDropdownBoundField 控件绑定到枚举

> ID：12354340
> 
> 赞同：0
> 
> 时间：2012-09-10T14:58:56.663
> 
> 标签：axapta, dynamics-ax-2012, enterprise-portal

我是 EP 开发的新手。我需要将`AXDropdownBoundField`控件绑定到`enum`后面的代码。

我在这里没有看到 ItemDataBound 事件。

可能吗？我不想在这里使用 asp:dropdownlist。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:59:40.530

你是对的，只有[3 个事件](http://msdn.microsoft.com/en-us/library/cc619841.aspx)可用于`dynamics:AxDropDownBoundField`：

1.  数据已更改
2.  格式化值
3.  抬头

# google-apps-script - Google Apps 脚本 - 访问单元格注释和评论

> ID：12354343
> 
> 赞同：1
> 
> 时间：2012-09-10T14:58:58.677
> 
> 标签：google-apps-script, cell, google-sheets

大家好，感谢您花时间查看我的问题。我是一名 9 年级的老师，正在制作一个定制的成绩单，刚刚完成了一个 GUI，让父母可以看到他们孩子的成绩。然而，在实际成绩单上，我使用单元格注释（以前是评论）来存储特定于成绩的信息（即 Jimmy 缺少作业的 b 部分）。我希望能够访问这些笔记中的数据。

我想认为自己是一名优秀的研究人员，但无法找到与单元格评论或注释交互的应用程序脚本的单一参考。对此的任何帮助将不胜感激。

此外，如果没有支持这一点的基础设施，我对如何存储相关信息的其他想法持开放态度，同时仍或多或少地保持我的界面不变。

我的界面：[https ://docs.google.com/spreadsheet/ccc?key=0AuptsBCDJBomdGtjc0xBcDctZ3FENmlsdlpRQmdkNkE](https://docs.google.com/spreadsheet/ccc?key=0AuptsBCDJBomdGtjc0xBcDctZ3FENmlsdlpRQmdkNkE)

父接口是一个简单的表单，它接受一个学生 ID 号并返回一个带有年级标题的弹性表，并且只有学生信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T16:34:49.497

您可以使用 Range.getComments() 方法来访问单元格上的评论。

[https://developers.google.com/apps-script/class_range#getComment](https://developers.google.com/apps-script/class_range#getComment)

* * *

更新（原作者：[西蒙](https://stackoverflow.com/users/1730189/simon)）：

Google Docs Comments 于 2012 年 9 月 5 日作为讨论式评论重新启动。所有旧的评论都被重命名为笔记。请参阅[此通知](https://cloud.googleblog.com/2012/09/google-spreadsheets-now-with-discussions.html)。奇怪的是，谷歌保留了旧的简单笔记，但没有提供任何文档。

# data-access-layer - 在 web2py 中复制记录及其引用

> ID：12354353
> 
> 赞同：0
> 
> 时间：2012-09-10T14:59:32.827
> 
> 标签：data-access-layer, web2py

在我的 web2py 应用程序中，我需要复制一条记录及其所有引用。例如，一个用户有一个产品（sponserid 是用户）。而且这个产品有很多存储在其他表中的特性（参考产品ID）。

我的要求是，如果另一个用户正在复制这个产品，新的记录将在产品表中生成新的 productid 和新的 sponserid。并且所有参考表记录也将与新产品 id 重复。实际上，在所有表中都创建了一个重复条目，唯一的变化是产品 ID 和赞助商 ID。

产品表字段将更改。所以我必须写一个动态查询。

如果我可以编写如下代码

```
product = db(db.tbl_product.id==productid).select(db.tbl_product.ALL).first()
newproduct = db.tbl_product.insert(sponserid=newsponserid)
for field,value in product.iteritems():
    if field!='sponserid':
        db(db.tbl_product.id==newproduct).update(field=value) 
```

但是我不能在更新函数中引用这样的字段名。

另外我想知道是否有任何其他更好的逻辑来实现这一要求。我将不胜感激任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T20:53:47.577

对于字段名存储在变量中时使用方法的具体问题`.update()`，可以这样做：

```
db(db.tbl_product.id==newproduct).update(**{field: value}) 
```

但更简单的方法是这样的：

```
product = db(db.tbl_product.id==productid).select(db.tbl_product.ALL).first()
product.update(sponserid=newsponserid)
db.tbl_product.insert(**db.tbl_product._filter_fields(product)) 
```

`.update()`应用于对象的方法`Row`只更新`Row`对象，而不是数据库中的原始记录。table的`._filter_fields()`方法接受一条记录（`Row`、`Storage`或 plain `dict`）并返回一个 dict ，其中仅包含属于该表的字段（它还过滤掉该`id`字段，数据库将自动生成该字段）。

# ios-simulator - 在 Xcode 4.4.1 或 4.5 中，是否包含 Simulator IOS 6？

> ID：12354356
> 
> 赞同：0
> 
> 时间：2012-09-10T14:59:43.450
> 
> 标签：ios-simulator, xcode4.4, ios6, xcode4.5

在 Xcode 4.4.1 或 4.5 中，是否包含 Simulator IOS 6？或者除了越狱之外，还有官方的方式来安装 ios 6 吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:04:59.183

*   要为 iOS 6 开发，您需要 xcode 4.5。Xcode 4.4.1 仅支持 5.1 iOS 版本
*   如果您注册了苹果 ios 开发者计划，您可以从苹果开发网站下载 iOS6 固件

# java - 日期的 SWT 文本字段

> ID：12354358
> 
> 赞同：0
> 
> 时间：2012-09-10T14:59:47.800
> 
> 标签：java, swt

我使用常规 SWT 文本字段来表示日期。

问题是我有这个文件的默认值，但是我添加了一个监听器来弹出一个 SWT 日历来选择新的日期。

它工作正常，但是是否有一个选项可以使用户无法编辑该字段，并且 CALENDAR 的侦听器仍然有效。

我不希望用户手动编辑此字段，只是为了使用 SWT 日历。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:04:17.843

以下不起作用吗？

```
final Text text = new Text(parent, SWT.BORDER);
text.setEditable(false);

text.addListener(SWT.MouseUp, new Listener() {

    @Override
    public void handleEvent(Event arg0) {
        System.out.println("Event");
        text.setText("new text");
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:05:47.903

简单的答案 - 不要使用文本字段，而是使用带有按钮的标签。

否则你将不得不惹恼听众

# jquery - 将 jqPlot 图转换为 PNG 时出错

> ID：12354360
> 
> 赞同：0
> 
> 时间：2012-09-10T14:59:49.923
> 
> 标签：jquery, jqplot

我开发了一个页面，其中包含几个在页面加载后（在某些特定事件上）动态生成的图表。我已在所有浏览器中成功生成图表。但我必须为这些图表提供打印功能。为此，我必须将图形画布转换为 PNG inage。在所有浏览器中都可以正常工作，但在 IE7 和 IE8 中则无法正常工作。

我已经使用此功能将图形画布转换为 PNG

```
jqplotToImageElem() 
```

在所有其他浏览器中它工作正常，但在 IE7 和 IE8 中我收到此错误

```
SCRIPT438: Object doesn't support property or method 'getContext' 
```

我还设置了所有 jqPlot js 文件和 css。谁能指出我的原因是什么？

谢谢， 安维什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:05:08.090

我想这是因为他们不支持`canvas`元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:05:57.920

IE7 和 IE8 不支持画布元素。

这就是为什么你得到：
`SCRIPT438: Object doesn't support property or method 'getContext'`

阅读有关[Explorer Canvas](http://code.google.com/p/explorercanvas/)的信息。

# wolfram-mathematica - 当我尝试在 Mathematica 8 中包含 Combinatorica 包时出现以下错误

> ID：12354364
> 
> 赞同：2
> 
> 时间：2012-09-10T15:00:00.873
> 
> 标签：wolfram-mathematica, kernel, combinatorics

我在终端（Ubuntu 12.04）中输入了以下命令：

```
In[41]:= << Combinatorica`;

General::compat: 
   Combinatorica Graph and Permutations functionality has been superseded by
   preloaded functionaliy. The package now being loaded may conflict with
   this. Please see the Compatibility Guide for details. 
```

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T14:19:10.900

# jsf-2 - selectOneMenu 上的 PrettyFaces 导航更改

> ID：12354365
> 
> 赞同：2
> 
> 时间：2012-09-10T15:00:05.443
> 
> 标签：jsf-2, primefaces, prettyfaces

我有一个使用 PrettyFaces 和 PrimeFaces 的应用程序。使用 URL 模式访问一页`/#{ location : navigationBean.location }/#{ year : navigationBean.year }`。

在该页面上，我有一个`p:selectOneMenu`包含位置的可能值。如果我更改此菜单，我希望页面在同一年和新位置刷新。

我已经使用 AJAX 对此进行了测试，以在 navigationBean 中设置位置，然后按`p:commandButton`结果`pretty:view`（`view`作为 url-mapping id）。这有效，但我想摆脱按钮。

我尝试了以下方法，但遗憾的是方法中的返回字符串不执行导航。

JSF：

```
<p:selectOneMenu value="#{navigationBean.location}">
    <p:ajax listener="#{navigationBean.navigate}"/>
    <f:selectItems value="#{locationBean.locations}"/>
</p:selectOneMenu> 
```

支持豆：

```
public String navigate(AjaxBehaviorEvent event)
{
    return (location != null) ? "pretty:view" : null;
} 
```

PrettyFaces 配置：

```
<url-mapping id="view">
    <pattern value="/#{ location : navigationBean.location }/#{ /\\d{4}/ year : navigationBean.year }/"/>
    <view-id value="/view.xhtml"/>
</url-mapping> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:20:55.580

您不能从 (ajax) 操作侦听器返回导航结果。您只能从 中使用的实际操作方法返回它`<h:commandButton action>`。

改为使用[`NavigationHandler#handleNavigation()`](http://docs.oracle.com/javaee/6/api/javax/faces/application/NavigationHandler.html#handleNavigation%28javax.faces.context.FacesContext,%20java.lang.String,%20java.lang.String%29)。

```
public void navigate() {
    FacesContext context = FacesContext.getCurrentInstance();
    context.getApplication().getNavigationHandler()
        .handleNavigation(context, null, (location != null) ? "pretty:view" : null);
} 
```

# java - 控制对 Eclipse Window Builder 创建的 GUI 对象的引用的放置位置

> ID：12354378
> 
> 赞同：5
> 
> 时间：2012-09-10T15:00:59.357
> 
> 标签：java, eclipse, jakarta-ee, eclipse-indigo, windowbuilder

**摘要**：我正在寻找一种方法来配置 Eclipse Window Builder 的代码生成器，以将其对象引用放置在类主体中，而不是本地放置在`initalize()`方法中。

**详细**：

Window builder 有一个内置的代码生成器/代码分析器，它可以从“图形表单设计器”生成 GUI 代码，反之亦然。它对于快速设计 GUI 和了解各种框架如何在 java 中工作（尤其是对于 java 初学者）非常有用。但是，当我转向更复杂的 GUI 设置时，我无法在设计中使用生成的代码。问题是大多数生成的代码都被放置在`initialize()`方法中，这使得对象驻留在本地范围内并且难以从“外部”获取引用。

到目前为止，我一直在*手动*`initialize()`将方法中的类型声明复制/粘贴到类主体中，以便可以访问它们，但这似乎是一种错误的方法。只要我不从图形设计器中重新组织 GUI，它就可以正常工作。在这种情况下，代码生成器将其类型声明再次放入方法中。*`initialize()`*

 *自动生成的代码如下所示：

```
 // AUTO-GENERATED CODE
   public class MyGUI {
      private void initialize() {
          // gui objects declared AND created in this scope by Window Builder
          JFrame frame = new JFrame();
          JPanel panel_1 = new JPanel();
          frame.getContentPane().add(panel_1);
    }
  } 
```

我想要的是：

```
 public class MyGUI {
          // accessible from outside
          public Frame frame = null;
          public JPanel panel_1 = null;

       private void initialize() {
          // gui objects only created in this scope
          frame = new JFrame();
          panel_1 = new JPanel();
          frame.getContentPane().add(panel_1);
    }
  } 
```

我一直在寻找解决方案的文档（关于这方面的文档很少），并且还研究了各种 Window Builder 偏好，但到目前为止还没有运气。有“数据绑定”，但它似乎实现了 MVC（将 gui 元素绑定到模型）并且相当过分。

是否有我遗漏的设计模式，或者我应该以`initialize()`某种方式将引用“钓”出本地范围？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T13:23:16.627

在 Preferences 窗口中，展开 WindowBuilder 和 Swing（或 SWT），然后展开 Code Generation。有一些选项可以在本地声明变量，作为类级别的字段，并延迟初始化。您还可以选择平面或块语句。WindowBuilder Pro User Guide > Preferences > Swing 下的文档中有[一些示例，](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.wb.doc.user/html/index.html)说明要查找的内容。*

# iphone - 无法重现应用审查发现的崩溃。任何人都可以帮助理解这个崩溃报告吗？

> ID：12354383
> 
> 赞同：5
> 
> 时间：2012-09-10T15:01:17.080
> 
> 标签：iphone, ios, crash-reports

Apple 拒绝了我们的 iphone 应用程序，表明它在 iPad 上崩溃了。我们无法在 3 台不同的 iPad 上重现崩溃，并要求他们确认。苹果回来说他们在 iPhone 4 上造成了崩溃（尽管日志显示的是 iPhone 3）。我们无法重现它...

> 他们通过以下方式产生崩溃：启动应用程序。选择让我先环顾四周。应用程序崩溃。

他们发回给我们的日志似乎没有显示任何应用程序自己的方法，称为：

```
ncident Identifier: 8B5E90DE-99FD-4279-B634-2C777209F2B3
CrashReporter Key:   6e9ccd0fcdc29915ebe22fb7376bd343cdcc252a
Hardware Model:      iPhone3,1
Process:         Snug [297]
Path:            /var/mobile/Applications/DB3EFF00-7E5E-492A-9108-1341B6371B0D/Snug.app/Snug
Identifier:      Snug
Version:         ??? (???)
Code Type:       ARM (Native)
Parent Process:  launchd [1]

Date/Time:       2012-09-09 13:00:32.642 -0700
OS Version:      iPhone OS 5.1.1 (9B206)
Report Version:  104

Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x00000000, 0x00000000
Crashed Thread:  6

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0:
0   libsystem_kernel.dylib          0x319e7660 __semwait_signal_nocancel + 24
1   libsystem_c.dylib               0x3410b4da nanosleep$NOCANCEL + 118
2   libsystem_c.dylib               0x340dd3a0 usleep$NOCANCEL + 44
3   libsystem_c.dylib               0x340dd2b6 abort + 118
4   Snug                            0x001f8760 uncaught_exception_handler + 12
5   CoreFoundation                  0x37830950 __handleUncaughtException + 68
6   libobjc.A.dylib                 0x3553533e _objc_terminate + 122
7   libc++abi.dylib                 0x36f683be safe_handler_caller(void (*)()) + 70
8   libc++abi.dylib                 0x36f6844a std::terminate() + 14
9   libc++abi.dylib                 0x36f6981e __cxa_rethrow + 82
10  libobjc.A.dylib                 0x355352a2 objc_exception_rethrow + 6
11  CoreFoundation                  0x37786506 CFRunLoopRunSpecific + 398
12  CoreFoundation                  0x37786366 CFRunLoopRunInMode + 98
13  GraphicsServices                0x33f45432 GSEventRunModal + 130
14  UIKit                           0x31532cce UIApplicationMain + 1074
15  Snug                            0x000f590c main (main.m:16)
16  Snug                            0x000f58c0 start + 32

Thread 1 name:  Dispatch queue: com.apple.libdispatch-manager
Thread 1:
0   libsystem_kernel.dylib          0x319d73a8 kevent + 24
1   libdispatch.dylib               0x3095cea4 _dispatch_mgr_invoke + 708
2   libdispatch.dylib               0x3095cbc2 _dispatch_mgr_thread + 30

Thread 2:
0   libsystem_kernel.dylib          0x319e7cd4 __workq_kernreturn + 8
1   libsystem_c.dylib               0x3409ff36 _pthread_wqthread + 610
2   libsystem_c.dylib               0x3409fcc8 start_wqthread + 0

Thread 3:
0   libsystem_kernel.dylib          0x319e7cd4 __workq_kernreturn + 8
1   libsystem_c.dylib               0x3409ff36 _pthread_wqthread + 610
2   libsystem_c.dylib               0x3409fcc8 start_wqthread + 0

Thread 4 name:  WebThread
Thread 4:
0   libsystem_kernel.dylib          0x319d7004 mach_msg_trap + 20
1   libsystem_kernel.dylib          0x319d71fa mach_msg + 50
2   CoreFoundation                  0x378043ec __CFRunLoopServiceMachPort + 120
3   CoreFoundation                  0x37803124 __CFRunLoopRun + 876
4   CoreFoundation                  0x3778649e CFRunLoopRunSpecific + 294
5   CoreFoundation                  0x37786366 CFRunLoopRunInMode + 98
6   WebCore                         0x3312fc9c RunWebThread(void*) + 396
7   libsystem_c.dylib               0x340a572e _pthread_start + 314
8   libsystem_c.dylib               0x340a55e8 thread_start + 0

Thread 5 name:  com.apple.NSURLConnectionLoader
Thread 5:
0   libsystem_kernel.dylib          0x319d7004 mach_msg_trap + 20
1   libsystem_kernel.dylib          0x319d71fa mach_msg + 50
2   CoreFoundation                  0x378043ec __CFRunLoopServiceMachPort + 120
3   CoreFoundation                  0x37803124 __CFRunLoopRun + 876
4   CoreFoundation                  0x3778649e CFRunLoopRunSpecific + 294
5   CoreFoundation                  0x37786366 CFRunLoopRunInMode + 98
6   Foundation                      0x38016bb2 +[NSURLConnection(Loader) _resourceLoadLoop:] + 302
7   Foundation                      0x38016a7a -[NSThread main] + 66
8   Foundation                      0x380aa58a __NSThread__main__ + 1042
9   libsystem_c.dylib               0x340a572e _pthread_start + 314
10  libsystem_c.dylib               0x340a55e8 thread_start + 0

Thread 6 Crashed:
0   libsystem_kernel.dylib          0x319e7cd4 __workq_kernreturn + 8
1   libsystem_c.dylib               0x3409ff36 _pthread_wqthread + 610
2   libsystem_c.dylib               0x3409fcc8 start_wqthread + 0

Thread 7:
0   libsystem_kernel.dylib          0x319e7cd4 __workq_kernreturn + 8
1   libsystem_c.dylib               0x3409ff36 _pthread_wqthread + 610
2   libsystem_c.dylib               0x3409fcc8 start_wqthread + 0

Thread 8:
0   libsystem_kernel.dylib          0x319e7cd4 __workq_kernreturn + 8
1   libsystem_c.dylib               0x3409ff36 _pthread_wqthread + 610
2   libsystem_c.dylib               0x3409fcc8 start_wqthread + 0

Thread 9 name:  com.apple.CFSocket.private
Thread 9:
0   libsystem_kernel.dylib          0x319e7570 __select + 20
1   CoreFoundation                  0x3780863a __CFSocketManager + 726
2   libsystem_c.dylib               0x340a572e _pthread_start + 314
3   libsystem_c.dylib               0x340a55e8 thread_start + 0

Thread 6 crashed with ARM Thread State:
    r0: 0x00000004    r1: 0x00000000      r2: 0x00000000      r3: 0x00000000
    r4: 0x0c8cc800    r5: 0x0036a08c      r6: 0x04339000      r7: 0x04338fe0
    r8: 0x3f29fd30    r9: 0x00000000     r10: 0x3f29fd50     r11: 0x00000000
    ip: 0x00000170    sp: 0x04338fc0      lr: 0x3409ff3d      pc: 0x319e7cd4
  cpsr: 0x40000010 
```

谁能用这个崩溃报告启发我们？

更新：

我们催促应用审查团队向我们发送控制台跟踪信息，他们做到了。在跟踪中，很明显正在调用一个不存在的 String 类别方法。

错误在于特定类别实现文件未添加到我们的发布目标中。所以一切都很完美，但是当应用程序被归档时，一个实现文件丢失了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T13:01:47.903

不幸的是，这个日志看起来并不太有用——它只是显示了主线程正在处理一个从另一个线程重新抛出的异常；在记录日志时，该线程已经开始执行其他操作。

`RestKit`您提到您对循环的怀疑，并且有可能`NSOperation`抛出异常。这是可能的并且值得检查（并祈祷它不会破坏其他东西......），但现在可能是时候请求应用审查团队为您提供更好的重现步骤了。看看你是否能确定你们都在做什么不同的事情。我希望我有一个更好的答案给你，但我认为在应用程序的这一部分探索你在后台所做的一切，并试图找出重现的缺失步骤将是你最好的选择. 祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T16:32:51.137

崩溃发生在线程 0 中最顶部的 Snug 行 4

```
 Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0:
0   libsystem_kernel.dylib          0x319e7660 __semwait_signal_nocancel + 24
1   libsystem_c.dylib               0x3410b4da nanosleep$NOCANCEL + 118
2   libsystem_c.dylib               0x340dd3a0 usleep$NOCANCEL + 44
3   libsystem_c.dylib               0x340dd2b6 abort + 118
4   Snug                            0x001f8760 uncaught_exception_handler + 12
5   CoreFoundation                  0x37830950 __handleUncaughtException + 68
6   libobjc.A.dylib                 0x3553533e _objc_terminate + 122
7   libc++abi.dylib                 0x36f683be safe_handler_caller(void (*)()) + 70
8   libc++abi.dylib                 0x36f6844a std::terminate() + 14
9   libc++abi.dylib                 0x36f6981e __cxa_rethrow + 82
10  libobjc.A.dylib                 0x355352a2 objc_exception_rethrow + 6
11  CoreFoundation                  0x37786506 CFRunLoopRunSpecific + 398
12  CoreFoundation                  0x37786366 CFRunLoopRunInMode + 98
13  GraphicsServices                0x33f45432 GSEventRunModal + 130
14  UIKit                           0x31532cce UIApplicationMain + 1074
15  Snug                            0x000f590c main (main.m:16)
16  Snug                            0x000f58c0 start + 32 
```

该应用程序导致了一个未被捕获的异常。要对报告进行符号化，只需将其拖入 xCode - 您需要具有已审核版本的 dSYM 文件。然后 xCode 将向您显示发生问题的确切行。要获得 dSym，您需要“构建和归档”。

此外，由于崩溃代码是

```
Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x00000000, 0x00000000 
```

崩溃的原因是内存访问问题。在许多情况下会生成此类崩溃报告，即尝试将 nil 对象插入到数组或字典中。（因为崩溃发生在主线程中，而不是报告的线程 6 中）

在您的情况下，我没有看到任何明显的插入，但是我会检查从主文件第 16 行开始的逻辑以及所有后续内容。我假设您正在访问一个在此调用时不再存在的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T08:33:06.870

您可以使用以下内容分析崩溃报告

从苹果分析崩溃报告的步骤：

将推送到应用商店的发布 .app 文件、发布时创建的 .dSYM 文件和从 APPLE 接收的崩溃报告复制到文件夹中。

打开终端应用程序并转到上面创建的文件夹（使用 CD 命令）

atos -arch armv7 -o YOU​​RAPP.app/YOURAPP MEMORY_LOCATION_OF_CRASH。根据报告，内存位置应该是应用程序崩溃的位置。

例如：atos -arch armv7 -o 'app name.app'/'app name' 0x0003b508

这将向您显示导致崩溃的确切行、方法名称。

例如：[类名函数名：]；-510

象征国际音标

如果我们使用 IPA 进行符号化 - 只需将扩展名 .ipa 重命名为 .zip ，将其解压缩，然后我们可以获得一个包含应用程序的有效负载文件夹。在这种情况下，我们不需要 .dSYM 文件。

此[符号化 iPhone 应用程序崩溃报告的链接](https://stackoverflow.com/questions/1460892/symbolicating-iphone-app-crash-reports)

# php - 使用 header php 函数后是否可以自动调用 JS 函数？

> ID：12354395
> 
> 赞同：-2
> 
> 时间：2012-09-10T15:02:11.713
> 
> 标签：php, javascript, header

是否可以在使用 header php 函数（或单击任何链接）重定向位置后自动调用 JS 函数（或执行任何语句）？以及如何做到这一点？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:17:58.447

如果包含正确使用的标头函数重定向的 PHP 文件有任何其他 HTML 代码，则该 HTML 代码将不会被解释，因为它永远不会到达浏览器。[这是，根据定义， header 是如何工作的，并且您的 PHP 页面甚至不应该在 header 被function 的定义](http://php.net/manual/en/function.header.php "标头定义")调用之前发送任何输出。

调用仅在访问者使用此标头重定向访问页面时才应执行的 JS 函数的一种方法是将参数添加到页面并在目标页面上检测参数是否存在。

例如。如果 www.example1.com/original.php 是使用标头重定向到 www.example2.com/redirect.php 的页面，您可以将标头重定向到[http://www.example2.com/redirect.php？重定向](http://www.example2.com/redirect.php?redirected)。在redirect.php 中，您检查redirect 参数是否存在，如果存在，则定义一个JS 函数并使其执行您想要的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:09:18.013

这没有多大意义。您正在重定向*或*正在输出包含 Javascript 的 HTML 页面*。*不能同时做这两件事。*重定向完成后*，您可以在其中输出带有 Javascript 的 HTML 页面，即在您要重定向到的下一页上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T15:05:35.200

在 php 中，您可以执行以下操作：

```
header("Location: http://mydomain.com/test.php"); 
```

或者在页面上打印一些 JS：

```
print "<script type='text/javascript'>window.location = 'test.php';</script>"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T15:06:58.480

> 是否可以在使用 header php 函数重定向位置后自动调用 JS 函数（或执行任何语句）？

`<script>`仅通过在被重定向到的页面中插入一个元素。

> （或点击任何链接）重定向位置？

您可以将事件处理程序绑定到给定页面上的所有链接。这将在单击它们时运行（但在浏览器离开页面之前）。

# iphone - 使用 NSKeyValueCoding 将复杂的 JSON API 响应消耗到 NSObjects

> ID：12354399
> 
> 赞同：0
> 
> 时间：2012-09-10T15:02:22.470
> 
> 标签：iphone, ios, json, nsobject, key-value-coding

博客文章将[JSON 保存到核心数据](http://www.cimgf.com/2011/06/02/saving-json-to-core-data/)中提供了一些将 JSON 响应转换为核心数据实体的重要技巧。我想做的是更具体一点。我想获取 JSON 响应，并使用博客文章中的方法将对象转换为 NSObject，其属性表示响应对象。我遇到的问题是对象的嵌套属性。以这个 JSON 响应为例：

[http://us.battle.net/api/d3/profile/rnystrom-1254/](http://us.battle.net/api/d3/profile/rnystrom-1254/)

使用博客文章中描述的方法，像“name”和“level”这样的简单属性很容易转换为 NSString 和 NSNumber 对象。但是，当查看响应的更复杂部分时会出现问题：嵌套数组/字典。

我发现的唯一解决方案是手动编码所有这些属性的查找和转换，我觉得这是一种非常糟糕的做法。这是我正在做的事情的摘录：

```
 NSDictionary *skillsDictionary = json[@"skills"];
    if ([skillsDictionary isKindOfClass:[NSDictionary class]]) {
        NSArray *activeArray = skillsDictionary[@"active"];
        NSArray *passiveArray = skillsDictionary[@"passive"];

        NSMutableArray *mutActives = [NSMutableArray array];
        NSMutableArray *mutPassives = [NSMutableArray array];

        if ([activeArray isKindOfClass:[NSArray class]]) {
            [activeArray enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
                if ([obj isKindOfClass:[NSDictionary class]]) {
                    NSDictionary *activeJSON = (NSDictionary*)obj;
                    D3Skill *skill = [D3Skill activeSkillFromJSON:activeJSON];
                    if (skill) {
                        [mutActives addObject:skill];
                    }
                }
            }];
        }

        if ([passiveArray isKindOfClass:[NSArray class]]) {
            [passiveArray enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
                if ([obj isKindOfClass:[NSDictionary class]]) {
                    NSDictionary *passiveJSON = (NSDictionary*)obj;
                    D3Skill *skill = [D3Skill passiveSkillFromJSON:passiveJSON];
                    if (skill) {
                        [mutPassives addObject:skill];
                    }
                }
            }];
        }

        self.activeSkills = mutActives;
        self.passiveSkills = mutPassives;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:48:44.203

我使用 SBJSON 库和 ASIHttpRequest 从我自己设计的 Web 服务中获取和使用 JSON，如果我正确理解您的问题，您只需要执行以下操作：

```
NSString *responseJSONasString = [fetchRequest responseString]; 
NSDictionary *itemResponseArray = [responseJSONasString JSONValue]; 
```

**SBJSON 库将为您转换为**NSObjects 并使用 JSON 元素上的 key:value 编码将它们放入数组/字典中，因此使用您提供的 JSON，我可以获得第一个英雄的名字：

```
NSArray *heroes = [itemResponseArray objectForKey:@"heroes"];
NSDictionary *firstHero = [heroes objectAtIndex:0];
NSString *heroName = [firstHero objectForKey:"name"]; 
```

SBJson 可以在这里找到：[http ://stig.github.com/json-framework/](http://stig.github.com/json-framework/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-29T03:58:15.163

[BWJSONMatcher](https://github.com/BurrowsWang/BWJSONMatcher)是我在项目中使用的一个轻量级库，用于将 JSON 数据从 RESTful api 转换为我的业务数据模型。它是这样的：

```
...
NSString *jsonString = @"{your-json-string}";
YourValueObject *dataModel = [YourValueObject fromJSONString:jsonString];

NSDictionary *jsonObject = @{your-json-object};
YourValueObject *dataModel = [YourValueObject fromJSONObject:jsonObject];
...
YourValueObject *dataModel = instance-of-your-value-object;
NSString *jsonString = [dataModel toJSONString];
NSDictionary *jsonObject = [dataModel toJSONObject];
... 
```

# apache - 如何将一个简单的 dart webService 部署到 apache 服务器？

> ID：12354405
> 
> 赞同：1
> 
> 时间：2012-09-10T15:02:39.437
> 
> 标签：apache, dart

我有一个非常简单的 dart webService，我想将它部署到 apache webServer。

```
#import('dart:io');
void main() {
  HttpServer server = new HttpServer();
  server.listen('127.0.0.1', 8080);

  server.defaultRequestHandler = (HttpRequest request, HttpResponse response){
 // response.outputStream.write("hello World".charCodes());
 // response.outputStream.close(); 

    File f = new File("test.txt");
    //File f = new File("index.html");
    f.exists().then((bool exist){
      f.openInputStream().pipe(response.outputStream);
    });
  };
} 
```

当您从浏览器调用 GET 127.0.0.1:8080 时，它会读取文件 test.txt 并在浏览器中显示输出。

我如何将其部署到在线某处的 apache 网络服务器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:27:15.777

mod_dart 可能有效，但您也可以在 Dart 服务器前将 Apache 作为代理运行。许多 node.js 部署在前面都有一个代理，用于负载平衡、缓存等。同样的技术也适用于 Dart。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T01:10:29.920

试试 mod_dart ( [https://github.com/sam-mccall/mod_dart](https://github.com/sam-mccall/mod_dart) )。

# build - 在 TFSBuild.proj 中设置代码分析设置

> ID：12354412
> 
> 赞同：7
> 
> 时间：2012-09-10T15:03:05.700
> 
> 标签：build, tfs, msbuild, code-analysis

我正在尝试在 TFS 的 TEST 安装中设置/覆盖一些设置，以在构建过程中强制进行代码分析和相关设置（无论项目文件中的设置如何）

我们目前在 TEST TFS 安装中使用：

*   我们的开发人员机器和构建服务器上的 Visual Studio 2012 Ultimate
*   在一台服务器上安装 TFS 2012（应用程序和数据层）
*   将 TFS 2012 构建服务（控制器和代理）安装在另一台服务器上

我们可以按预期编译示例 .net 4.5 项目（类库 (DLL)、Web 应用程序等）。这仅与覆盖关联的代码分析设置有关（希望如此）。

场景 1 - 在我们开发人员机器上的示例应用程序中，当您选择项目设置时（右键单击 -> 解决方案资源管理器中的属性），如果我打开“在构建时启用代码分析”并选择规则，请转到代码分析选项卡下拉菜单中的设置按预期执行，因此会产生一些警告。`<RunCodeAnalysis>false</RunCodeAnalysis>`如果在记事本中打开，此技术将添加到 *.csproj 文件中。如果执行构建以编译示例项目/解决方案，则按预期执行代码分析。我不想在每个项目上都这样做，因为开发人员可以将其关闭（尽管我希望有签入政策和/或私人/门控签入以及强制执行此操作）。

场景 2 - 我可以禁用“在构建时启用代码分析”复选框并在我们的 TFSBuild.proj 文件中强制进行代码分析（我们（将）使用默认的 upgradetemplate.xaml 作为我们的流程定义，因为我们将从 TFS 2008 升级到我们的LIVE TFS 安装）通过具有：

> `<RunCodeAnalysis>Always</RunCodeAnalysis>`

这是可行的，这就是我们将如何强制（仍有待学习的课程:-)）对我们的构建进行代码分析。

然后在设置其他相关的代码分析设置时出现问题。例如，应用/使用哪些默认规则集或将 CA 警告视为错误。其中一些设置可以在 VS 中设置，也可以通过在记事本中编辑 *.csproj 来设置。如果我编辑 *.csproj，那么这些值将按预期在构建中使用（以及在开发人员机器上本地使用）。这并不理想，因为我想在 TFSBuild.proj 中集中执行此操作，而无需编辑每个项目文件。我相信我可以使用 TFSbuild.proj 文件中的设置：

```
<PropertyGroup>
    <RunCodeAnalysis>Always</RunCodeAnalysis>
    <CodeAnalysisRuleSet>AllRules.ruleset</CodeAnalysisRuleSet>
    <CodeAnalysisTreatWarningsAsErrors>true</CodeAnalysisTreatWarningsAsErrors>
</PropertyGroup> 
```

但它们似乎不起作用，或者我把它们放在错误的地方？如何正确修复/使用它们？

仅供参考，我通过以下方式在 TFSBuild.proj 中构建我的解决方案：

```
<Project DefaultTargets="DesktopBuild" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="4.0">

  <Import Project="$(MSBuildExtensionsPath)\Microsoft\VisualStudio\TeamBuild\Microsoft.TeamFoundation.Build.targets" />
          <ItemGroup>
            <SolutionToBuild Include="/some folder/some solution.sln" />
            <ConfigurationToBuild Include="Debug|Any CPU">
               <FlavorToBuild>Debug</FlavorToBuild>
               <PlatformToBuild>Any CPU</PlatformToBuild>
             </ConfigurationToBuild>
          </ItemGroup>
</Project> 
```

在构建服务器上，我确实在 c:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v11.0\CodeAnalysis 找到了对代码分析目标文件的引用，但我不想更改构建服务器上的默认行为（虽然当我这样做时它确实有效）。例如 CodeAnalysisTreatWarningsAsErrors 的条件必须被评估为假。就像我的值不是从 TFSBuild.proj 读取的，而是从 .csproj 文件中读取的。

如有任何问题，请随时提出并提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T02:56:51.440

`CODE_ANALYSIS`即使在 VS.Net 中检查了“在构建时启用代码分析（定义 CODE_ANALYSIS 常量）”，我也遇到了类似的问题，即 Cruise Control 没有使用编译符号进行编译。

看起来是不是check，`CODE_ANALYSIS`实际上并没有显式添加到csproj中的编译符号列表中（即使出现在文本框“条件编译符号”中），只是`<RunCodeAnalysis>true</RunCodeAnalysis>`添加了。

通过 VS.Net 编译时，`CODE_ANALYSIS`会自动添加，但在使用 Cruise Control 使用的 MSBuild 时不会。

我最终在 VS.Net 中将“条件编译符号”从“CODE_ANALYSIS;MySymbol”更改为“MySymbol;CODE_ANALYSIS”。这样做被迫`CODE_ANALYSIS`也出现在 csproj 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T06:57:30.363

我记得有一个类似的问题 - 但没有时间调查它，我通过使用 exec 任务直接调用 FxCop 来解决它。我只是给你重点介绍，省略了一些属性的说明，我希望名称清楚。

我创建了一个输出 dll 的 ItemGroup，即 FilesToAnalyze，并以类似于以下方式将其提供给 FxCop：

```
<PropertyGroup>
      <FxCopErrorLinePattern>: error</FxCopErrorLinePattern>
      <FxCopCommand>"$(FxCopPath)" /gac /rule:"$(FxCopRules)" /ruleset:="$(FxCopRuleSet)"  @(FilesToAnalyze->'/file:"%(identity)"', ' ') /out:$(FullFxCopLog) /console | Find "$(FxCopErrorLinePattern)" > "$(FxCopLogFile)"</FxCopCommand>
</PropertyGroup>    

<Exec Command="$(FxCopCommand)"
      ContinueOnError="true">
  <Output TaskParameter="ExitCode" PropertyName="FxCopExitCode"/>
</Exec>

<ReadLinesFromFile File="$(FxCopLogFile)">
    <Output TaskParameter="Lines" ItemName="AllErrorLines"/>
</ReadLinesFromFile> 
```

然后我可以使用扩展包任务确定输出中的错误数量：

```
<MSBuild.ExtensionPack.Framework.MsBuildHelper TaskAction="GetItemCount" InputItems1="@(AllErrorLines)">
    <Output TaskParameter="ItemCount" PropertyName="FxErrorCount"/>
</MSBuild.ExtensionPack.Framework.MsBuildHelper> 
```

并为每个错误创建一个失败的构建步骤：

```
<BuildStep TeamFoundationServerUrl="$(TeamFoundationServerUrl)"
        BuildUri="$(BuildUri)"
        Id="$(FxCopStep)"
        Status="Failed"
        Message="FxCop Failed: $(FxErrorCount) errors."/>

<BuildStep TeamFoundationServerUrl="$(TeamFoundationServerUrl)"
                BuildUri="$(BuildUri)"
                Status="Failed"
                Message="%(AllErrorLines.Identity)"/> 
```

通过以这种方式在构建服务器上进行代码分析，我们还避免了必须单独配置每个项目。我们将所有这些隔离在一个单独的 .targets 文件中，因此将代码分析添加到解决方案中只需导入该文件，并可能通过设置适当的属性来调整行为。

# c - 如果分配了该区域，则访问超出其末尾的数组是否是未定义的行为？

> ID：12354413
> 
> 赞同：5
> 
> 时间：2012-09-10T15:03:08.013
> 
> 标签：c, undefined-behavior

> **可能重复：**
> [“struct hack”在技术上是未定义的行为吗？](https://stackoverflow.com/questions/3711233/is-the-struct-hack-technically-undefined-behavior)

通常在 C 中访问超出数组末尾的数组是未定义的行为。例如：

```
int foo[1];
foo[5] = 1; //Undefined behavior 
```

如果我知道已经分配了数组末尾之后的内存区域，使用 malloc 还是在堆栈上，它仍然是未定义的行为吗？这是一个例子：

```
#include <stdio.h>
#include <stdlib.h>

typedef struct
{
  int len;
  int data[1];
} MyStruct;

int main(void)
{
  MyStruct *foo = malloc(sizeof(MyStruct) + sizeof(int) * 10);
  foo->data[5] = 1;
} 
```

我已经看到这个模式在几个地方被用来制作一个可变长度的结构，它似乎在实践中有效。它在技术上是未定义的行为吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T15:04:17.063

您所描述的内容被亲切地称为[“*结构黑客*”](http://c-faq.com/struct/structhack.html)。目前尚不清楚它是否完全可以，但它曾经并且被广泛使用。

最近（C99），它已经开始被“*灵活数组成员*`int data[];`”取代，如果它是结构中的最后一个字段，您可以在其中放置一个字段。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-10T15:22:14.767

在**6.5.6 加法运算符**下：

> 语义
> 
> 8 - [...] 如果指针操作数指向数组对象的元素，并且数组足够大，则结果指向与原始元素偏移的元素，使得结果和原始下标的差异数组元素等于整数表达式。[...]如果结果指向数组对象的最后一个元素，则不应将其用作`*`评估的一元运算符的操作数。

如果此时分配了内存`malloc`：

> ### 7.22.3 内存管理功能
> 
> 1 - [...] 如果分配成功，则返回的指针经过适当对齐，以便可以将其分配给指向具有基本对齐要求的任何类型对象的指针，然后用于访问此类对象或此类对象的数组在分配的空间中（直到空间被显式释放）。已分配对象的生命周期从分配一直延伸到解除分配。

然而，这并不支持在没有适当强制转换的情况下使用此类内存，因此`MyStruct`如上定义的，只能使用对象的声明成员。这就是添加*灵活数组成员*(6.7.2.1:18) 的原因。

另请注意，附录**J.2 未定义行为**调用了数组访问：

> 1 - 在以下情况下行为未定义： [...]
> - 将指针添加或减少到数组对象或仅超出数组对象和整数类型会产生不指向或仅超出数组对象的结果相同的数组对象。
> — 对数组对象和整数类型的指针进行加法或减法运算会产生刚好超出数组对象的结果，并用作计算的一元运算符的操作数`*`。
> — 数组下标超出范围，即使对象显然可以使用给定的下标访问（如在`a[1][7]`给定声明的左值表达式中） `int a[4][5])`。

因此，正如您所注意到的，这将是未定义的行为：

```
 MyStruct *foo = malloc(sizeof(MyStruct) + sizeof(int) * 10);
  foo->data[5] = 1; 
```

但是，您*可以*执行以下操作：

```
 MyStruct *foo = malloc(sizeof(MyStruct) + sizeof(int) * 10);
  ((int *) foo)[(offsetof(MyStruct, data) / sizeof(int)) + 5] = 1; 
```

C++ 在这方面比较宽松；**3.9.2 复合类型 [basic.compound]**有：

> 3 - [...]如果一个类型的对象`T`位于一个地址`A`，那么一个类型的指针，`cv T*`其值为地址的指针`A`被称为指向该对象，而不管该值是如何获得的。

`restrict`考虑到 C 对指针的更积极的优化机会，例如使用限定符，这是有道理的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-10T15:48:38.620

C99 基本原理文档在第 6.7.2.1 节中讨论了这一点。

> *C99 的一个新特性：*有一个常见的习语称为“struct hack”，用于创建包含可变大小数组的结构：
> 
> ...
> 
> 这种结构的有效性一直值得怀疑。在对一份缺陷报告的回复中，委员会决定这是未定义的行为，因为该数组`p->items`仅包含一项，而与空间是否存在无关。建议了另一种构造：使数组大小大于可能的最大情况（例如，使用`int items[INT_MAX];`），但由于其他原因，这种方法也未定义。
> 
> 委员会认为，尽管没有办法在 C89 中实现“struct hack”，但它仍然是一个有用的工具。因此引入了“灵活数组成员”的新特性。除了空括号和`malloc`调用中删除“-1”之外，这与 struct hack 的使用方式相同，但现在是明确有效的代码。

struct hack 是未定义的行为，不仅支持 C 规范本身（我确信其他答案中有引用），而且委员会甚至记录了它的意见。

所以答案是**肯定**的，根据标准文档，它是未定义的行为，但根据*事实上*的C 标准，它是很好定义的。我想大多数编译器作者都非常熟悉 hack。来自 GCC 的`tree-vrp.c`：

```
 /* Accesses after the end of arrays of size 0 (gcc
      extension) and 1 are likely intentional ("struct
      hack").  */ 
```

我认为您甚至很有可能在编译器测试套件中找到 struct hack。

# html - 在 IE7 中显示为管道的零宽度非连接符 (‌)

> ID：12354414
> 
> 赞同：4
> 
> 时间：2012-09-10T15:03:10.730
> 
> 标签：html, internet-explorer-7

我拼命地尝试向列表元素添加一些空格（下面的简化版本）

```
<ul>
  <li>&zwnj;&#160;&#160;A1</li>
  <li>&zwnj;&#160;&#160;&#160;&#160;A1.1</li>
  ...
</ul> 
```

我的问题是，IE7 忽略了空格，所以我添加了零宽度非连接符 ( `&zwnj;`)。下一个问题来了。IE7 将其渲染`&zwnj;`为管道（垂直条）。

任何提示我如何解决这个问题？我的目标是打算使用空格（或其他）的列表元素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T17:08:11.107

从技术上讲，IE 7 显示“管道”的原因是它表示了一个不可表示的字符。IE 7 不知道 ZWNJ 是一个控制字符并试图在字体中找到它，这对于大多数字体来说都失败了。您可以通过将字体设置为包含 ZWNJ 的字体来规避这种情况，例如

```
li { font-family: "Arial Unicode MS", "Lucida Sans Unicode" } 
```

这当然会影响一般字体，但您可以将 ZWNJ 字符包装在`span`元素内并仅在它们上设置样式。

然而，这看起来是一种完全错误的方法。ZWNJ 可防止连字行为，此处根本不需要。IE 将不间断空格视为不可折叠（正如您可以通过单独测试代码看到的那样）。如果没有，那么还有其他事情发生，从您发布的代码中看不到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:14:16.790

用空格缩进是个坏主意。改用 CSS `margin-left`。

# android - Android HTML5将快捷方式图标添加到主屏幕不一致

> ID：12354418
> 
> 赞同：1
> 
> 时间：2012-09-10T15:03:13.363
> 
> 标签：android, html

我们有 HTML5 移动网站，当我们尝试通过添加到主屏幕图标将网站添加到“主屏幕”时。它不能始终如一地工作。它有时会显示应用程序图标，有时会显示默认的星形图标。

为什么android浏览器会这样？有什么方法可以使这种行为保持一致。

我们已经尝试过， [http://www.mollerus.net/tom/blog/2010/06/web_app_homescreen_icons_in_android.html](http://www.mollerus.net/tom/blog/2010/06/web_app_homescreen_icons_in_android.html) [Android | 主屏幕上的书签图标](https://stackoverflow.com/questions/4215047/android-bookmark-icons-on-homescreen) [配置 Android Web 应用程序](https://stackoverflow.com/questions/1951381/configuring-android-web-applications)

没有成功:(

# sql-server - 在 SQL Server 中使用 XQuery 从 XML 中获取同名元素

> ID：12354419
> 
> 赞同：1
> 
> 时间：2012-09-10T15:03:12.677
> 
> 标签：sql-server, sql-server-2008, tsql, xquery

我有以下 XML

```
DECLARE @ruleXML XML
SET @RuleXML = '<questionnaire xmlns:xsi="http://schema1" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://schem2" title="Sample">
  <sections>
    <section id="24" title="Section Title" help="" url="">
      <questions />
    </section>
    <section id="23" title="Information" help="" url="">
      <questions />
    </section>
    <section id="25" title="Section Title1" help="" url="">
      <questions>
        <question id="3" title="Question Text">
          <display-rules />
          <questions />
        </question>
        <question id="4" title="Question Text" >
          <response-set type="inline" />
          <display-rules />
          <questions />
        </question>
      </questions>
    </section>
  </sections>
</questionnaire>' 
```

如何在 SQL Server 中使用 XQUERY 从所有问题节点获取带有问题 ID 和标题的表，无论它们的级别如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T15:27:42.227

```
; with  xmlnamespaces (default 'http://schem2')
select  tbl.col1.value('@id', 'int')
,       tbl.col1.value('@title', 'varchar(100)')
from    @RuleXML.nodes('//question') tbl(col1) 
```

[SQL Fiddle 的工作示例。](http://sqlfiddle.com/#!6/d41d8/234/0)

# ember.js - Ember.js - 代码使用 0.9.5 但不是 1.0.pre

> ID：12354421
> 
> 赞同：2
> 
> 时间：2012-09-10T15:03:33.063
> 
> 标签：ember.js

`ember.js 1.0.pre`我试图弄清楚为什么下面的小提琴在工作时不起作用`0.9.5`。

### 版本 0.9.5（工作）

[http://jsfiddle.net/tPfNQ/1/](http://jsfiddle.net/tPfNQ/1/)

### 版本 1.0.pre（不工作）

[http://jsfiddle.net/hSzrZ/1/](http://jsfiddle.net/hSzrZ/1/)

我知道这`handlebars.js`不包含在最新版本中`ember.js`，我必须自己包含它。

这是我正在使用的代码：

```
<script type="text/x-handlebars">
    {{#view Ember.Button target="Welcome.booksController" action="loadBooks"}}
        Load Books
    {{/view}}

    {{#collection contentBinding="Welcome.booksController"}}
        <i>Genre: {{content.genre}}</i>
    {{/collection}}
</script>

Welcome = Ember.Application.create();

Welcome.Book = Ember.Object.extend({
    title: '',
    author: '',
    genre: ''
});

var data = [ { "title": "Ready Player One", "author": "Ernest Cline", "genre": "Science Fiction" }, { "title": "Starship Troopers", "author": "Robert Heinlein", "genre": "Science Fiction" }, { "title": "Delivering Happiness", "author": "Tony Hsieh", "genre": "Business" } ];

Welcome.booksController = Ember.ArrayController.create({
    content: [],
    loadBooks: function(){
        var self = this;
        data.forEach(function(item){
            self.pushObject(Welcome.Book.create(item));
        });
    }
});​ 
```

来源是：[http ://www.andymatthews.net/read/2012/03/07/Getting-Started-With-EmberJS](http://www.andymatthews.net/read/2012/03/07/Getting-Started-With-EmberJS)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T15:21:49.950

这是人们升级到 1.0 时最常见的问题。

默认视图上下文现在已更改为视图的上下文，`context`而不是视图本身。
因此，要访问视图内容中的值，您需要通过`view.content.xxx`.

```
{{#collection contentBinding="Welcome.booksController"}}
    <i>Genre: {{view.content.genre}}</i>
{{/collection}} 
```

在这种特殊情况下，您也可以根据`#each`需要使用帮助程序。

```
{{#each Welcome.booksController}}
    <i>Genre: {{genre}}</i>
{{/each}} 
```

我认为有人谈论改变`#collection`助手以类似地工作。

# mysql - MySQL Query tableA order by if has post in tableB with this month

> ID：12354423
> 
> 赞同：0
> 
> 时间：2012-09-10T15:03:50.243
> 
> 标签：mysql, join

我有两张桌子。

我想对tableA进行查询并按tableB排序。

这是一个会计系统。

TableA 包含客户。表 B 包含客户支付的款项。

我想`select *`从 TableA 订单中，他在 TableB 中首先支付了本月的日期，然后是没有付款的其余部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:14:41.550

```
SELECT
    *
FROM TableA
LEFT JOIN TableB
    ON TableB.customer_id = TableA.customer_id
ORDER BY COALESCE(TableB.payDate, '1900-01-01') DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:19:03.573

您可以外连接两个表，按表 A 中的标识信息分组，并按表 B 中的最大付款日期排序，如下所示：

```
select customer.customer_id, customer.first_name, customer.last_name, 
  max(payment.payment_date)
from customer
  left outer join payment on payment.customer_id = customer.customer_id
group by customer.customer_id, customer.first_name, customer.last_name
order by max(payment.payment_date) desc 
```

# asp.net-mvc - 在负载均衡器上托管 MVC4 Web Api 应用程序是否有任何额外配置？

> ID：12354425
> 
> 赞同：1
> 
> 时间：2012-09-10T15:03:53.710
> 
> 标签：asp.net-mvc, iis, asp.net-web-api, load-balancing

我们在 server1 上获得了 Mvc4 Web 应用程序，调用 server2 上的 Restfull Mvc4 Web APIs，两者都托管在 IIS 7.5 上。这种架构工作正常。当我们将每个应用程序放在负载均衡的服务器上时，Web 应用程序可以正常工作，但是 Web api 项目不会在负载均衡器上的第二台服务器上运行。我们刚刚克隆了环境，因此它们都具有相同的代码和配置，但服务器名称和映射。

在负载均衡器上托管 MVC4 Web Api 应用程序是否有任何额外配置？

有没有人真正让 MVC4 Web Api 在负载平衡环境中工作？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T16:37:15.460

> 在负载均衡器上托管 MVC4 Web Api 应用程序是否有任何额外配置？

如果您的 Web API 是无状态的并且您没有使用任何 ASP.NET 会话，则不需要。如果您使用的是 ASP.NET 会话，则可能需要使用进程外会话状态而不是默认的内存中会话状态。

> 有没有人真正让 MVC4 Web Api 在负载平衡环境中工作？

是的，我有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-07T11:58:50.947

我发现了问题！该死的问题是我们的防火墙阻止了网络请求

# mongodb - Couchdb 是否支持分区

> ID：12354427
> 
> 赞同：2
> 
> 时间：2012-09-10T15:04:03.297
> 
> 标签：mongodb, couchdb

我正在考虑在我的下一个项目中使用 couchdb 或 mongodb。我知道 mongodb 支持分片和复制，但我找不到任何说明 couchdb 支持分区的文档。那么，你知道 couchdb 是否支持分区吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T16:00:34.323

CouchDB 不支持分区，但 BigCouch (http://bigcouch.cloudant.com/use) 支持。BigCouch 的分区功能以及其他功能将在接下来的几个版本中整合到 CouchDB 中，但 BigCouch 现在可以使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T17:26:24.813

[CouchBase](http://www.couchbase.com/couchbase-server/overview)也支持分片。为了提高效率，其中一些是用 C 重写的，并且 SDK 可用于各种语言。CouchDB 仅支持 REST，客户端库必须使用它。虽然，我不相信 CouchBase 的理念，我把希望寄托在 BigCouch 上。

请注意，CouchBase 有自己的 amin 应用程序，不使用[futon](http://guide.couchdb.org/draft/tour.html#welcome)。可以预期，因为引擎支持额外的服务（分片）——功能集更大。但是蒲团对于开发视图（沙发查询）很有用。BigCouch 和 CouchBase 大多与 CouchDB 兼容，您应该可以使用前者进行开发。当需要部署您的应用程序并且 BigCouch 补丁尚未在 CouchDB 中时，您可以切换到其中一个分支 :) 请注意它们之间的细微差别：[BigCouch 与 CouchDB](http://bigcouch.cloudant.com/api)以及[CouchBase 与 CouchDB](http://www.couchbase.com/couchdb)。

# php - 如何在任务完成时显示友好消息

> ID：12354428
> 
> 赞同：-1
> 
> 时间：2012-09-10T15:04:10.057
> 
> 标签：php, ajax, codeigniter

我不知道我是否正确地提出了这个问题，但我有一个 codeigniter 应用程序，它在后端有些提升。当应用程序忙于执行命令（ajax 命令）时，我想显示某种状态/消息框/div。任务完成后，我想清除 div / box。我需要什么谷歌才能找到这样的解决方案？

谢谢。

**编辑：** 这就是我的 jquery / ajax 调用现在的样子......

```
 $('#availVLANS').click(function()  {
  $(this).attr("disabled","disabled");
  $.ajax({
    url:"<?php echo site_url('controller/methodABC/');?>",
    type:'POST',
    dataType:'json',
    success: function(returnDataFromController) {
    var htmlstring;
    var submitFormHTML;
    htmlstring = "<br><br><B>To reassign the port to a new vlan, click on a VlanId below and then click on the OK button</B><br><table class='table table-bordered table-striped'>";
    htmlstring = htmlstring + "<th>VlanId</th><th>Name</th>";
    for(i = 0; i < returnDataFromController.length; i++) {
        //alert(returnDataFromController[i].VlanId);
        htmlstring = htmlstring +  "<tr><td><a href=>"+returnDataFromController[i].VlanId+"</a></td><td>"+ returnDataFromController[i].Name+"</td></tr>";   

    }
    submitFormHTML = "<form method='post' accept-charset='utf-8' action='" + BASEPATH + "index.php/switches/changeportvlan/"+ $('#ip').val() +"/" + $('#hardwaremodel').val() +"/" + $('#port').val() + "'><input type='text' name='newVlanID' id='newVlanID' style='width:5em;height:1.5em'/>&nbsp;&nbsp;<button type='submit' class='btn' name='saveVlan' id='saveVlan' style='width:10em;height:2em'>Reassign Vlan</button></form>";
    //alert(submitFormHTML);
    $('#clientajaxcontainer').html(htmlstring);
    $('#newvlanform').html(submitFormHTML);                     

  }
});
$(this).removeAttr("disabled");
  }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:08:59.993

只需在覆盖在整个页面顶部的绝对定位的 DIV 中使用动画 GIF 图像。只需确保在整个页面顶部覆盖一个不可见的 DIV，以防止点击进度窗口后面的界面元素。像这样的东西；

```
╔════════════════════╗
║  #progress-overlay ║
║ ╔════════════════╗ ║
║ ║ #progress-indicator
║ ╚════════════════╝ ║
╚════════════════════╝ 
```

#progress-overlay 是指示器的背景，您想要的效果类似于 LightBox2 效果，但在屏幕中间使用进度指示器和小框。

您可以从这里获得动画 gif； [http://preloaders.net/](http://preloaders.net/)

确保您的进度/正在发生的 div 位于文档结构的顶层，因此位于正文顶部的某个位置，在您的任何其他容器 DIV 之前。这样做是为了使#progress-overlay 在 DOM 中呈现在与您网站的顶级元素相同的级别。当您绝对定位#progress-overlay 时，它将出现在页面上所有其他内容的**上方。**

```
<html>
<head>
....
</head>
<body>
<div id="progress-overlay">
    <div id="progress-indicator">
        <img src="images/myprogress.gif" /> Please Wait...
    </div>
</div><!--progress-overlay-->
<div id="website-wrapper">
.... web site, layout, content, etc...
</div>
</body>
</html> 
```

#progress-overlay 默认隐藏，然后在需要时显示在顶部。就像是;

```
#progress-overlay{
position: absolute;
width: 100%;
height: 100%;
background: #000;
opacity: 0.2;
}

#progress-indicator{
position: relative;
margin: 0 auto;
top: 40%;
width: 200px;
height: 50px;
} 
```

使用 JQuery，您可以轻松地按需使用；

```
$(document).ready(function(){
    $('#progress-overlay').hide();
    });
function showProgressIndicator()
{
    $('#progress-overlay').show();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:07:17.890

您可以使用 onreadystatechange 事件： [http ://www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp](http://www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T15:09:19.233

如果您是通过 jquery 进行的，只需显示一个带有消息和/或微调器的 div。

```
jQuery.ajaxSetup({
  beforeSend: function() {
     $('#loader').show();
  },
  complete: function(){
     $('#loader').hide();
  }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T16:19:51.663

如果您使用的是 jQuery，我提出以下解决方案：

## jQuery：

```
$(document).ready(function(){
    $("#the_button").click(function(){
        var url = "the_controller/the_method"
        var data = {the: "data"}
        //before the POST takes place, fade-in the message
        $("#the_message").fadeIn();
        $.post(url, data, function(r){
            if(r.success){
                //when the post is finished, and it was successful, fade-out the message.
                $("#the_message").fadeOut();
            }
            else console.log("something bad happened");
        }, 'json');
    });
}); 
```

## 的HTML：

```
<!-- HIDE IT BY DEFAULT -->
<div id='the_message' style='display:none;'>
    Please wait.
</div> 
```

## 控制器：

```
class The_controller extends CI_Controller{
    function the_method(){
        $p = $this->input->post();
        the_task($p);
        if(the_task_success) return json_encode(array("success" => true));
        else return json_encode(array("success" => false));
    }
} 
```

# javascript - 尝试使用 HTML5/CSS3/JS 创建带有 z-index 的堆叠菜单

> ID：12354432
> 
> 赞同：0
> 
> 时间：2012-09-10T15:04:19.840
> 
> 标签：javascript, html, css, onclick, z-index

我到处寻找解决方案，但找不到任何具体的东西，我知道这是非常可行的，但我认为我缺乏 JavaScript 经验限制了我。基本上我有 5 个 div，每个 div 都像一个按钮。我希望每个按钮都使另一个与 5 个按钮无关的 div 出现。我称它们为“Menubox1/2/3/4”，每一个都链接到每一个。我的第一个想法是将所有菜单堆叠在一起，顶部有一个空白菜单，z-index 为 5。

然后通过在 div 按钮上使用“onclick”方法，我会告诉它获取其各自菜单的元素并将其 z-index 增加到 6，以进入堆栈顶部。我还会告诉它让所有其他菜单转到 4，低于其余菜单。

如此有效地，每个按钮都会使与其关联的菜单出现在具有最高 z-index 的顶部，并隐藏其他菜单框，以便没有其他框位于同一级别。

我找到了一种让它与这个 JS 一起工作的方法

```
//Shows the current menu on top
  function showstuff(boxid) {
            document.getElementById(boxid).style.zIndex="5";
        }
//Hides the rest of them.
        function hidestuff(boxid) {
            document.getElementById(boxid).style.zindex="3";
        }

<div onclick="showstuff('Menu1'); hidestuff('Menu2'); hidestuff('Menu3');" ;style="cursor:pointer;"> 
```

通过将相应的 boxid 放在 "onclick" 中，一切正常，但问题是它只能工作一次，每次单击每个 boxid 时我都需要它工作。

如果有人需要更多信息，我会提供。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:09:55.747

为什么不只`visibility:hidden/visible`在要隐藏/显示的窗格上使用？它需要在每次单击时重置每个窗格上的该属性，但您不必担心浏览器如何呈现 z-index，或者在渲染中是否有任何时候您会得到一个奇怪的显示多个 div 渲染时只有一个应该。

# shell - 使用 java 执行 shell 脚本时出现语法错误

> ID：12354442
> 
> 赞同：3
> 
> 时间：2012-09-10T15:05:02.660
> 
> 标签：shell, apache-commons, processbuilder

我有一个要在 Java 类中执行的 shell 脚本。shell 脚本接受一个输入文件并从中生成一个输出文件。

要执行它，我使用 apache commons exec。这是我的小代码：

```
CommandLine cmdLine = CommandLine.parse("/bin/sh ./generate_void_description.sh ./n3file ./voidfile");

int exitValue = executor.execute(cmdLine); 
```

结果，我收到此错误消息：

```
./generate_void_description.sh: 44: ./generate_void_description.sh: Syntax error: "(" unexpected
org.apache.commons.exec.ExecuteException: Process exited with an error: 2 (Exit value: 2) 
```

当然，我可以阅读并且我理解该消息意味着脚本中存在语法错误，但是。

1）我没有编写脚本，也不熟悉 bash 脚本语法 2）当我在 ubuntu 的终端上运行该脚本时，该脚本运行良好，没有任何错误

它与用户权限有关吗？我需要创建一个输出文件，如果如果我没有这样做的权限

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:45:45.203

该脚本使用 bash 功能，最明显的是第 44 行中的一个数组。您必须使用`/bin/bash`，而不是`/bin/sh`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:11:48.773

似乎 bash 脚本正在退出，返回码为 2。如果这是正常的，请在执行执行调用之前尝试此操作。

```
executor.setExitValue(2); 
```

# sql-server - 通过子域连接到 SQL Database 2008R2

> ID：12354445
> 
> 赞同：0
> 
> 时间：2012-09-10T15:05:15.003
> 
> 标签：sql-server, iis, sql-server-2008-r2, windows-server-2008-r2, remote-server

我实际上通过 TCP/IP 访问了远程数据库

我在网上搜索过，但我只能通过 IP 获得有关远程 SQL 的结果。

那么，有没有办法让我的 IP 可以从子域（eq bd.domain.com）访问？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T10:12:57.383

同意，这是一个 DNS 解析问题，您需要确保您的客户端可以将 server.bd.domain.com 名称解析为正确的 IP。您需要 bd 域的 DNS 中的 A 记录才能正常工作。

# css - 如何使用 CSS 从动画 png 中获取框架？

> ID：12354446
> 
> 赞同：0
> 
> 时间：2012-09-10T15:05:18.403
> 
> 标签：css

CSS是否提供了一种从动画png（APNG，PNG）中获取特定帧的方法，或者甚至仅将（A）PNG从帧A循环到帧B？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:10:51.147

就 CSS 而言，APNG 不是一个考虑因素，大多数浏览器甚至不支持它（除了 firefox）

您最好将 APNG 转换为 PNG spritesheet，使用 Javascript 对其进行动画处理，并使用 CSS 中的 background-position 来获取特定帧。

# html - li 元素的下边框

> ID：12354456
> 
> 赞同：5
> 
> 时间：2012-09-10T15:05:46.453
> 
> 标签：html, css, html-lists

我正在尝试为我的 li 元素添加底部边框。这是我的CSS：

```
.menu{
    text-align:right;
}
.menu li{
    padding:5px;
    text-transform: uppercase;
    display:inline; 
    list-style-type:none;
    list-style-position: inside;

    border-bottom: 1px solid red;
} 
```

还有我的 HTML：

```
 <div class="menu">
        <ul>
            <li>Home</li>
            <li>Home</li> 
            <li>Home</li> 
            <li>Home</li> 
            <li>Testimonials</li>
            <li>About Us</li>
            <li>Contact Us</li>
        </ul>
    </div> 
```

由于某种原因，没有添加底部边框。我可以在左右两侧添加边框，但不能在底部添加边框。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T16:08:19.080

尝试添加；

```
html, body{
  margin: 0;
  padding: 0;
} 
```

您的代码在***[这里](http://jsfiddle.net/blasteralfred/HAZKh/)***运行良好，无需任何更改。

* * *

## 回答 #2

> 赞同：-6
> 
> 时间：2012-09-10T16:38:38.270

我很清楚你的需要。下面给出了解决方案，只需将底部更改为正确。请测试并提供反馈。

```
.menu li{    
    padding:5px;
    text-transform: uppercase;
    display:inline;
    list-style-type:none;
    list-style-position: inside;
    border-right: 1px solid red;
} 
```

# javascript - 使用jquery从整数中减去

> ID：12354458
> 
> 赞同：0
> 
> 时间：2012-09-10T15:05:49.840
> 
> 标签：javascript, jquery

每次用户按**j**键时，我都想滚动到一个 div 。这是它的代码。

```
$(function() {
    function scroll(direction) {

        var scroll, i,
                positions = [],
                here = $(window).scrollTop(),
                collection = $('.message_box');

        collection.each(function() {
            positions.push(parseInt($(this).offset()['top'],0));
        });

        for(i = 0; i < positions.length; i++) {
            if (direction == 'next' && positions[i] > here) { scroll = collection.get(i); break; }
            if (direction == 'prev' && i > 0 && positions[i] >= here) { scroll = collection.get(i); break; }
        }

        if (scroll) {
        $('html, body').animate({"scrollTop": $(scroll).offset().top-50});
            $(scroll).css('color', 'blue');
            $(scroll).mouseleave(function() {
            $(this).css('color', 'black');
            });
        }

        return false;
    }

    $("#next,#prev").click(function() {        
        return scroll($(this).attr('id'));        
    });
$('body').keyup(function(event) {
  if (event.which == 74) {
     return scroll('next');
   }
});
$('body').keyup(function(event) {
  if (event.which == 75) {
     return scroll('prev');
   }
});

}); 
```

我需要从 div 的 offest 中减去 50 才能滚动到它。

```
$('html, body').animate({"scrollTop": $(scroll).offset().top-50}); 
```

它会在第一次滚动，但不会在其余时间滚动。我总是得到整数**218**，这是要滚动到的第一个 div 的偏移量。演示 - [http://jsfiddle.net/XP5sP/6/](http://jsfiddle.net/XP5sP/6/) 有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:10:36.227

`$(scroll).offset().top-50`完全有效，`.top`将返回一个整数值。因此，问题不在于您的这部分代码。

我怀疑问题与函数中的`scroll`变量有关`scroll`。在同一范围内，我总是避免将变量命名为与函数名称相同的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:22:27.720

尝试在减号之间放置一些空格，这样它就不会被误认为是破折号。

```
$('html, body').animate({"scrollTop": $(scroll).offset().top - 50}); 
```

或先将数学保存在变量中

```
var scrollMinusFifty = $(scroll).offset().top - 50;
$('html, body').animate({"scrollTop":scrollMinusFifty}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T15:29:23.380

问题是您总是将值移动到第一个匹配元素**之前**`scrollTop`的50 像素，因此它总是将该元素标识为您需要在语句中滚动到的元素，因为它的位置**大于**当前值。**`if`**`scrollTop`****

 ****将代码的相关部分修改为：

```
if (direction == 'next' && positions[i] > here + 50) {
    scroll = collection.get(i);
    break;
} 
```

这样，它说明窗口被滚动到当前元素上方 50 像素。****

# python - 在python中使用OR与正则表达式匹配元素

> ID：12354465
> 
> 赞同：0
> 
> 时间：2012-09-10T15:06:20.900
> 
> 标签：python, regex, logical-operators

我在 python 中使用正则表达式从 html 中提取数据。我写的正则表达式是这样的：

```
result = re.findall(r'<td align="left"  csk="(\d\d\d\d)\d\d\d\d"><a href=.?*>(.*?)</a></td>\s+|<td align="lef(.*?)" >(.*?)</td>\s+', webpage) 
```

假设这将遵循以下任一格式的 td -

```
<td align="left"  csk="(\d\d\d\d)\d\d\d\d"><a href=.?*>(.*?)</a></td>\s+ 
```

或者

```
<td align="lef(.*?)" >(.*?)</td> 
```

这是因为 td 可以在该特定单元格中采用不同的格式（或者有带有链接的数据，或者甚至根本没有数据）。

我假设我使用的 OR 条件不正确 - 相信 OR 仅匹配正则表达式前面的“just”和正则表达式后面的“just”，而不是两个完整的 td 标签之间。

我的问题是，我如何对它进行分组（例如用括号），以便 OR 在整个 td 标签之间匹配。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:07:59.973

您正在使用正则表达式，但是将 XML 与此类表达式匹配变得太复杂、太快。

改用 HTML 解析器，Python 有几个可供选择：

*   [ElementTree](http://docs.python.org/library/xml.etree.elementtree.html)是标准库的一部分
*   [BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)是一个流行的第三方库
*   [lxml](http://lxml.de/)是一个快速且功能丰富的基于 C 的库。

元素树示例：

```
from xml.etree import ElementTree

tree = ElementTree.parse('filename.html')
for elem in tree.findall('tr'):
    print ElementTree.tostring(elem) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:41:01.200

In `<td align="left" csk="(\d\d\d\d)\d\d\d\d"><a href=.?*>(.*?)</a></td>\s+` the `.?*` should be replaced with `.*?`.

And, to answer your question, you can use non-capturing grouping to do what you want as follows:

```
(?:first_regex)|(?:second_regex) 
```

BTW. You can also replace `\d\d\d\d` with `\d{4}`, which I think is easier to read.

# php - 如何使用 zend 框架（如命名空间时尚）自动加载文件

> ID：12354469
> 
> 赞同：1
> 
> 时间：2012-09-10T15:06:33.693
> 
> 标签：php, zend-framework, autoload

我正在从头开始开发一个新应用程序，我需要递归地自动加载文件。但是，我需要使用 Zend Framework 之类的命名空间。

例如，`LibraryName_Http_Request`将加载`LibraryName/Http/Request.php`文件。无论我尝试过什么，`LibraryName_Http_Request`如果我命名文件，我只能使用 class `LibraryName_Http_Request.php`。

我不知道如何更改我的代码，以便我可以以相同的 Zend 方式加载类文件......

这是我的代码：

```
class Autoloader
{

    public function __construct()
    {
        spl_autoload_register( array( $this, 'autoload' ) );
    }

    public function autoload( $class )
    {
        $iterator = new RecursiveDirectoryIterator( LIBRARY_PATH );

        foreach( new RecursiveIteratorIterator( $iterator ) as $file=>$meta ) {

            if( ( $class . '.php' ) === $meta->getFileName() ) {

                if( file_exists( $file ) ) {
                    require_once $file;
                }
                break;
            }
        }        

        unset( $iterator, $file );
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:50:25.173

您应该查看[**PSR-0 可以满足**](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md)您的需求。您可以在建议的末尾找到[PSR-0 加载器实现的链接。](https://gist.github.com/221634)

* * *

**更新：**由于您使用的是 PHP 5.2，因此上述加载程序不能完全满足您的需求。这是我基于 PSR-0 编写的一个简单的自动加载器，没有命名空间支持：

```
class SimpleClassLoader
{
    /**
     * Installs this class loader on the SPL autoload stack.
     */
    public function register()
    {
        spl_autoload_register(array($this, 'loadClass'));
    }

    /**
     * Uninstalls this class loader from the SPL autoloader stack.
     */
    public function unregister()
    {
        spl_autoload_unregister(array($this, 'loadClass'));
    }

    /**
     * Loads the given class or interface.
     *
     * @param string $className The name of the class to load.
     * @return void
     */
    public function loadClass($className)
    {
        require str_replace('_', DIRECTORY_SEPARATOR, $className) . '.php';
    }
} 
```

然后注册加载器：

```
$loader = new SimpleClassLoader();
$loader->register(); 
```

现在引用`LibraryName_Http_Request`将包括`LibraryName/Http/Request.php`.

# ruby-on-rails - Ruby：比较哈希和哈希值的麻烦

> ID：12354470
> 
> 赞同：0
> 
> 时间：2012-09-10T15:06:36.637
> 
> 标签：ruby-on-rails, ruby

我有这样一部分“看起来像鬼”的代码（但它必须如此，因为 db 很大并且有很多表）：

```
def search_group
    @search_trees = SearchTree.all
    @designation = Designation.find(:all, :conditions => { :DES_ID => @search_trees.map(&:STR_DES_ID)})
    @text = DesText.find(:all, :conditions => { :TEX_ID => @designation.map(&:DES_TEX_ID)})
    @search_result = @text.find_all{|item| item.TEX_TEXT.include?(params[:search_group_text])}
    @designation_back = @designation.find_all{|item| item.DES_TEX_ID == @search_result.TEX_ID}
    @search_trees_back = @search_trees.find_all{|item| item.STR_DES_ID == @designation_back.DES_ID}
    respond_to do |format|
      format.html
    end
  end 
```

我试着比较

```
 @designation_back = @designation.find_all{|item| item.DES_TEX_ID == @search_result.TEX_ID} 
```

但我得到错误，一些不好的东西......未定义的方法'TEX_ID'。我认为，这是通过我以不好的方式比较哈希和哈希...我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T16:36:38.093

```
 @search_result = @text.find_all{|item| item.TEX_TEXT.include?(params[:search_group_text])}
  @designation_back = @designation.find_all{|item| item.DES_TEX_ID == @search_result.TEX_ID} 
```

这是因为它`@search_result`是一个数组，而不是一个可以调用该方法的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T17:51:44.080

@search_results 是一个数组。如果您知道它只返回一个结果，您可以执行@search_results[0].Tex_Id，否则必须循环遍历@search_results 的每个值。

尝试 'pry' gem 来调试您从每个作业中获得的结果。

# xml - xslt 1.0 中的 xml 节点分组

> ID：12354471
> 
> 赞同：0
> 
> 时间：2012-09-10T15:06:37.827
> 
> 标签：xml, xslt, xslt-1.0

输入 ：

输入 XML

```
<Root>
    <Number>1</Number>
    <Reference>100</Reference>

    <Number>2</Number>
    <Reference>101</Reference>

    <Number>3</Number>
    <Reference>100</Reference>

    <Number>4</Number>
    <Reference>102</Reference>

    <Number>5</Number>
    <Reference>100</Reference>
</Root> 
```

预期输出：

```
<Root>
    <Number>1</Number>
    <Reference>100</Reference>
    <RefNumber>1</RefNumber>

    <Number>2</Number>
    <Reference>101</Reference>
    <RefNumber>1</RefNumber>

    <Number>3</Number>
    <Reference>100</Reference>
    <RefNumber>2</RefNumber>

    <Number>4</Number>
    <Reference>102</Reference>
    <RefNumber>1</RefNumber>

    <Number>5</Number>
    <Reference>100</Reference>
    <RefNumber>3</RefNumber>
</Root> 
```

如何在 xslt 1.0 的输出中基于 Root/Reference 进行分组并将序号添加到 RefNumber？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:22:29.340

一种方法是使用**xsl:number**。每当您匹配一个**Reference**元素时，复制该元素，并添加一个**RefNumber**元素，该元素具有相同值的 Reference 元素的数量：

```
<xsl:template match="Reference">
    <xsl:copy-of select="." />
    <xsl:variable name="Ref" select="." />
    <RefNumber><xsl:number count="Reference[. = $Ref]" /></RefNumber>
</xsl:template> 
```

这是完整的 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="Reference">
        <xsl:copy-of select="." />
        <xsl:variable name="Ref" select="." />
        <RefNumber><xsl:number count="Reference[. = $Ref]" /></RefNumber>
    </xsl:template>

    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>
</xsl:stylesheet> 
```

当应用于您的示例 XML 时，将输出以下内容：

```
<Root>
    <Number>1</Number>
    <Reference>100</Reference>
    <RefNumber>1</RefNumber>

    <Number>2</Number>
    <Reference>101</Reference>
    <RefNumber>1</RefNumber>

    <Number>3</Number>
    <Reference>100</Reference>
    <RefNumber>2</RefNumber>

    <Number>4</Number>
    <Reference>102</Reference>
    <RefNumber>1</RefNumber>

    <Number>5</Number>
    <Reference>100</Reference>
    <RefNumber>3</RefNumber>
</Root> 
```

请注意使用身份转换模板来复制其他现有节点。

# android - 如何在 Android 中使用基本样式？

> ID：12354472
> 
> 赞同：1
> 
> 时间：2012-09-10T15:06:38.790
> 
> 标签：android, android-styles

我很难让 Android Styles 工作。作为测试，我创建了一个 EditText 控件并将其与名为“CodeFont”的样式相关联，如下所示：

```
 EditText et = new EditText(this, null, Resource.Style.CodeFont); 
```

接下来，我定义了一个继承自标准样式的样式，并将文本颜色更改为红色，如下所示：

```
 <resources>
      <style name="CodeFont" parent="@android:style/TextAppearance.Medium">
        <item name="android:layout_width">fill_parent</item>
        <item name="android:layout_height">wrap_content</item>
        <item name="android:textColor">#FF0000</item>
        <item name="android:typeface">monospace</item>
      </style>
    </resources> 
```

我究竟做错了什么？当 EditText 出现时，它不再具有焦点上的橙色边框。这让我觉得造型很有效。但是，文本颜色仍为黑色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:19:46.077

除非您需要动态生成 EditText，否则您应该使用 XML，然后通过 XML 定义样式。这将您的 GUI 与您的代码分开，这可以带来很多好处。

像这样，您可以像这样简单地指定样式：

```
style="@style/CodeFont" 
```

有关详细信息，请参阅[Android 开发者网站](http://developer.android.com/guide/topics/ui/themes.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:58:16.940

由于您将`"@android:style/TextAppearance.Medium"`其用作父样式，因此边框未显示。TextAppearance.Medium 是 textAppearance 属性样式，而不是小部件样式。如果您希望橙色边框和所有内容仍然显示但具有中等文本大小，那么您需要执行以下操作：

```
<style name="CodeFont" parent="@android:style/Widget.EditText">
    <item name="android:layout_width">fill_parent</item>
    <item name="android:layout_height">wrap_content</item>
    <item name="android:textColor">#FF0000</item>
    <item name="android:textAppearance">@android:style/TextAppearance.Medium</item>
    <item name="android:typeface">monospace</item>
</style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T20:46:19.430

行。我终于找到了解决方案。我不得不从一些资源中拼凑起来。

1.  在 Android 4.0 (Ice Cream Sandwich) 中，在 Activity 的属性部分指定主题名称存在一个已知问题： [Cannot Resolve @style/Theme.Sherlock](https://stackoverflow.com/questions/10352628/cannot-resolve-style-theme-sherlock)。如果您使用该属性来设置主题，那么编译器将返回*"No resource found that match the given name (at 'theme' with value '@style/blah-blah'"*。所以你想使用 SetTheme( ) Activity 的 OnCreate( ) 中的 API。
2.  创建样式时，样式需要是您在第 1 步中引用的主题的一部分。确保您在主题中对样式进行分组（如果您愿意，可以从标准 Android 主题继承）。对于您的每个样式名称，您将需要创建一个属性引用，如步骤 1 中的链接中所述。以下链接是定义样式名称资源属性的“正确”方法： [如何创建自己的资源名称？](https://stackoverflow.com/questions/2268039/how-do-i-create-my-own-resource-names)
3.  您需要通过在步骤 2 中定义的属性从主题中引用您的样式。例如： EditText et1 = new EditText(this, null, Resource.Attribute.CodeFontRef);

# jquery - 显示表单的弹出窗口

> ID：12354475
> 
> 赞同：0
> 
> 时间：2012-09-10T15:06:53.220
> 
> 标签：jquery, forms

我正在使用 google api 开发一个处理日历中事件的应用程序。我有一个 jquery 函数，它在浏览器页面的底部显示一个表单（函数 .show()）。我想做的就像谷歌日历中的内容。当您单击日历上的日期时，会显示一个显示表单的弹出窗口。我读到 window.open 几乎做了我想做的事，但问题是我不知道在 url 中放什么：

```
window.open('url', 'window name', 'window settings') 
```

实际上，表单和我的 jquery 函数在同一个文件中：

```
<div id="addEvent" style="display:none" >
            <form id="addEventForm">

                <label>Titre :</label>
                <input type="text" value="" placeholder="Titre de l'event" id="title" name="title" />

                <label>Date de début :</label>
                <input type="text" value="" placeholder="Date de l'event" id="start_date" name="start_date" />

                <a href="#" onclick="add_event()">Ajouter l'event</a>
            </form>
        </div> 
```

这是我显示表格的方式：

```
$(document).ready(function() {
        $('#calendar').fullCalendar({
            dayClick: function(date, allDay, jsEvent, view)
            {     
                 date_format = $.fullCalendar.formatDate(date,"yyyy-MM-dd");
                 display_form(date_format);

            },
         events: 'https://www.google.com/calendar/feeds/myLogin%40gmail.com/public/basic'
        });
    });

 function display_form(s_date)
           {$('#addEvent').show();
            $('#start_date').val(s_date);
           } 
```

# ruby - 在 ruby 中使用 openpgp gem 进行三重加密和解密

> ID：12354479
> 
> 赞同：2
> 
> 时间：2012-09-10T15:06:59.560
> 
> 标签：ruby, encryption, tripledes

我需要在 ruby​​ 中进行三重 DES 加密和解密。我是否可以使用 openpgp gem 或任何其他专用 gem 来进行三重 DES 加密/解密。请建议我。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T22:31:29.567

您可能正在考虑openssl，而不是openpgp。[这是 ruby​​ 中的 openssl 加密函数的文档。](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL/Cipher.html)您还可以使用更简单的[乱码](https://github.com/mdp/gibberish#readme)模块。无论哪种方式，您都需要使用 openssl 支持编译 Ruby；要么自己编译，要么找一个可以下载的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T12:19:46.310

如果它绝对必须是三重 DES，以下是获取具有 OpenSSL 扩展的实例的方法：

```
cipher = OpenSSL::Cipher::Cipher.new("des-ede-cbc")
cipher.encrypt
key = cipher.random_key
iv = cipher.random_iv
... 
```

请确保致电`random_key`并`random_iv`按照此处和 SilverbackNet 已经提到的文档中的说明进行操作。在那里，您还将找到有关如何进行实际加密和解密的示例。

如果您可以自由选择算法，您可能希望选择 AES 而不是 Triple DES，它要快得多，并且通常被认为是更现代的密码。

# java - Java - 列出设备并知道何时连接

> ID：12354480
> 
> 赞同：3
> 
> 时间：2012-09-10T15:07:04.250
> 
> 标签：java, usb

我最近正在编写一些`File.listRoots()`在 Java 中使用的代码，以便在程序启动时获取连接的设备。这在 Windows 中工作得非常好，但是我读到它在 Linux 中不起作用，而且我不是 Linux 用户，所以我只能通过我目前无法访问的大学计算机访问 Linux。所以我想问两件事：

**首先**如何使它成为驱动检测的跨平台解决方案。

**其次**，如何在程序运行时“监听”插入的设备，例如插入计算机的 USB 必须由程序“监听”并运行事件。

我不能提供任何代码，因为它真的无关紧要，而且我还没有真正实现这个功能，所以请询问任何可能需要回答的关于我的代码的问题。我敢打赌，“监听”设备连接也会“监听”设备断开连接，但如果不是这种情况，我也想知道解决方案。

如果这有帮助的话，我会在 JFrame 中工作，我宁愿使用原生 Java 包来实现它，而不是使用其他包（如果可能），即使原生实现可能需要更多的代码和努力！

*请注意，我使用引号内的侦听，因为我知道这可能不会像我怀疑的那样。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-28T08:45:50.007

**看看[JavaHIDAPI](https://code.google.com/p/javahidapi/)**

这是一个跨平台的人机接口设备 (HID) 库，适用于 Windows、Mac 和 Linux。它为每个库提供了所有本地库，并在 Java 中具有易于使用的界面。文档有点稀疏，但它应该可以让您快速启动并运行。

在您的情况下，您可以维护一个后台线程来监视已连接设备的列表。当列表在一个快照和下一个快照之间发生变化时，您可以向您的应用程序发送一个事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-24T10:56:51.667

使用 javax.usb 库，我们可以获得有关 UsbHostManager 的信息，但不容易获得正在连接的设备。

```
 import java.util.*;
    import javax.usb.*;

    public class USBLister {

      public static void main(String[] args) throws UsbException {
        //Get UsbHub
        UsbServices services = UsbHostManager.getUsbServices();
        UsbHub root = services.getRootUsbHub();

        listPeripherique(root);
      }

     public static void listPeripherique(UsbHub hub) {
        //List all the USBs attached
        List perepheriques = hub.getAttachedUsbDevices();
        Iterator iterator = perepheriques.iterator();

        while (iterator.hasNext()) {

          UsbDevice perepherique = (UsbDevice) iterator.next();
          System.out.println(perepherique);

          if (perepherique.isUsbHub())
            listPeripherique((UsbHub) perepherique);

        }
      }
    } 
```

# c# - 授予 NTFS 权限时继承的权限丢失

> ID：12354481
> 
> 赞同：6
> 
> 时间：2012-09-10T15:07:07.327
> 
> 标签：c#, permissions

我试图为特定用户在 UNC 路径上授予 NTFS 权限，但我看到不同的行为取决于 UNC 路径。下面是我用来授予权限的代码（来自[MSDN ）以及每种情况下的结果，](http://msdn.microsoft.com/en-us/library/c1f66bc2.aspx)

```
static void GiveNTFSPermissions(string folderPath, 
                                string ntAccountName, 
                                FileSystemRights accessRights)
{
    DirectorySecurity dirSecurity = Directory.GetAccessControl(folderPath);

    FileSystemAccessRule newAccessRule =
         new FileSystemAccessRule(
               ntAccountName,
               accessRights,
               AccessControlType.Allow);

    dirSecurity.AddAccessRule(newAccessRule);

    Directory.SetAccessControl(folderPath, dirSecurity);
} 
```

假设我在本地机器上有一个名为“<em>RootShare”的共享，其中还有另一个文件夹“<em>InsideRootShare”。

**场景1：** 当我打电话时，

```
GiveNTFSPermissions(@"\\sri-devpc\RootShare",
                    @"domain\username",
                    FileSystemRights.Write); 
```

**共享路径上的继承权限丢失，**

**场景2：** 当我打电话时，

```
GiveNTFSPermissions(@"\\sri-devpc\RootShare\InsideRootShare", 
                    @"domain\username", 
                    FileSystemRights.Write); 
```

**继承的权限完好无损。**

我尝试过不同的构造函数，`FileSystemAccessRule`但没有运气。

**这种行为背后的原因是什么，以及任何解决方法？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T16:57:44.910

在使用 Dropkick 的安全模块时，我们遇到了使用文件系统权限的类似问题。我们提出的解决方案如下。这将成功设置任何文件夹的权限，而不会更改文件夹的继承规则。

```
 public void SetFileSystemRights(string target, string group, FileSystemRights permission)
    {
        if (!IsDirectory(target) && !IsFile(target))
            return;

        var oldSecurity = Directory.GetAccessControl(target);
        var newSecurity = new DirectorySecurity();

        newSecurity.SetSecurityDescriptorBinaryForm(oldSecurity.GetSecurityDescriptorBinaryForm());

        var accessRule = new FileSystemAccessRule(group,
                                                  permission,
                                                  InheritanceFlags.None,
                                                  PropagationFlags.NoPropagateInherit,
                                                  AccessControlType.Allow);
        bool result;
        newSecurity.ModifyAccessRule(AccessControlModification.Set, accessRule, out result);

        if (!result) Log.AddError("Something wrong happened");

        accessRule = new FileSystemAccessRule(group,
                                              permission,
                                              InheritanceFlags.ContainerInherit |
                                              InheritanceFlags.ObjectInherit,
                                              PropagationFlags.InheritOnly,
                                              AccessControlType.Allow);

        result = false;
        newSecurity.ModifyAccessRule(AccessControlModification.Add, accessRule, out result);
        if (!result) Log.AddError("Something wrong happened");

        Directory.SetAccessControl(target, newSecurity);

        if (result) Log.AddGood("Permissions set for '{0}' on folder '{1}'", group, target);

        if (!result) Log.AddError("Something wrong happened");
    } 
```

找到[了我最初用来解决这个问题的链接](http://www.west-wind.com/weblog/posts/4072.aspx)。

# javascript - 更改图层中单个矢量特征的图标

> ID：12354483
> 
> 赞同：0
> 
> 时间：2012-09-10T15:07:21.003
> 
> 标签：javascript, icons, openlayers

目前我正在尝试更改用户关注的矢量图层的特定特征的图标。我将每个功能添加到地图中，如下所示：

```
var point = new OpenLayers.Geometry.Point(pt.lon, pt.lat);
var markerStyle = OpenLayers.Util.extend(OpenLayers.Feature.Vector.style['default'],  {
    externalGraphic: iconURL
});
var marker = new OpenLayers.Feature.Vector(point, attributes, markerStyle); 
```

稍后我执行以下操作来更新功能的图标：

```
var marker = this.findSelectedMarker();
if (marker) {
    marker.style.externalGraphic = newIconUrl;
    this.layer.redraw();             
} 
```

但是当图层重绘时，我图层中的所有功能都使用`newIconUrl`，而不仅仅是我尝试更新的选定标记。

如何更改图层的一个选定功能的图标？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T17:03:18.460

为了解决这个问题，我需要解决两个问题。第一个与使用多个 OpenLayers 样式有关，无论是在图层级别还是在单个功能级别。我删除了每个单独功能的样式，因此只实现了以下图层样式：

```
this.layerStyle = new OpenLayers.StyleMap({ 
    'default': {
        externalGraphic: media_url + '${iconURL}',
        graphicHeight: 32,
        graphicWidth: 32,
        graphicXOffset: -16,
        graphicYOffset: -32,
        fillOpacity: 0.75
    }
}); 
```

我所做的第二个更改是使用属性替换语法来指定具有名为`'${iconURL}'`. 这使我可以通过简单地更改所选功能的属性并重绘图层来更改图标 url：

```
focusedMarker.attributes.iconURL = this.focusedURL;
this.layer.redraw(); 
```

# c++ - 更改程序的扩展

> ID：12354490
> 
> 赞同：-1
> 
> 时间：2012-09-10T15:07:57.280
> 
> 标签：c++, c, visual-studio-2008

我下载了 Visual C++ express edition 2008，但问题是文件没有任何扩展名。我不知道如何运行它才能安装它。有没有办法可以执行此程序以将其安装在我的计算机上..

我会非常感谢你..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:14:30.207

Visual Studio 2008 Express 版可从[该地址](http://www.microsoft.com/visualstudio/en-us/products/2008-editions/express)@Microsoft 以多种下载形式获得。默认的 Visual C++ 下载是网络安装程序 (vcsetup.exe)。还可以下载完整的 ISO 安装文件或可刻录到光盘。

如果你走这条路，ISO 大约是 784.9 MB，只是为了帮助你评估你是否获得了虚假下载并需要重新获取。

# javascript - jQuery 加载功能 - 不可见的图像

> ID：12354496
> 
> 赞同：0
> 
> 时间：2012-09-10T15:08:16.087
> 
> 标签：javascript, jquery, function

我正在使用`load()`函数来检查图像是否已加载。如果是，那么我正在使用其他两个功能。代码如下所示：

```
$('#img-1').load(function(){        
     someFunction1();
     loadIcons();       
}); 
```

`someFunction1()`工作正常，但`loadIcons()`有类，它在 CSS 文件中声明了背景图像并且这个图像是不可见的（就像它还没有加载一样）

加载图标（）：

```
function loadIcons(){
        $('#gallery').append('<div class="icon" id="icon-1">');
        $('#icon-1').append('<span></span>');
        $('#icon-1').css({
            'top': parseInt(top),
            'left': parseInt(left)
        });
} 
```

这些元素 ( `div`, `span`) 在 Firebug 中是可见的，但`.icon`类中的图像是不可见的。知道如何解决吗？

```
 $(document).ready(function(){

    someFunction1()
    {       
            $('#spinner').remove();
            $('#spinner-transparent').css({
                'opacity' : 0
            });
    }

    function loadIcons()
    {
        //code above
    }

    $('#img-1').one('load', function(){     
          someFunction1();
          loadIcons();       
        }).each(function() {
  if(this.complete) $(this).load();
}); 
```

**注意：**微调器是一个内部`<div>`加载`.gif`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T16:26:01.627

我曾经在使用 $.load 时遇到过麻烦，最后却做了这样的事情：

```
var img_load_callback = function () {...};
var img = new Image();
img.onload = img_load_callback; // this must be set before img.src
img.src = 'whatever.jpg'; 
```

# javascript - 使用 javascript 更改 span 元素的属性，其中类动态更改

> ID：12354499
> 
> 赞同：0
> 
> 时间：2012-09-10T15:08:30.567
> 
> 标签：javascript, html, dom

这就是问题所在，每当我们生成时，我们的 span 元素的 css 类名都会不断变化。所以为了简化，我们有一个 span 元素

```
<tr>
   <td>
       <span class=1234>My Name is BouncingHippo</span>
   </td>
        ....other well-defined DOM elements with id etc...
 </tr> 
```

我在 html 上的某处有一个单选按钮，onchange 将更改 span 元素的字体颜色。

span 元素没有 id，没有名称，并且有一个随时变化的 span 类。我当前的方法是蛮力使用for each`getElementsByTagName()`返回特定行并以这种方式插入样式属性。`innerHTML``<tr>`

有没有更好的方法呢？跨代类更改每一代的原因是出于我们客户规定的安全目的。

**编辑 1**

关于蛮力方法的jsfiddle的一个粗略概念，我还没有让它工作.. [http://jsfiddle.net/3jVnJ/1/](http://jsfiddle.net/3jVnJ/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:32:39.240

这是基于您的 jsFiddle 中的想法的一个选项：

```
function findParentTag(obj, tag) {
    tag = tag.toUpperCase();
    while (obj && obj.tagName !== tag) {
        obj = obj.parentNode;
    }
    return(obj);
}

function changeColor(obj){
    var table = findParentTag(obj, "table");
    var spans = table.getElementsByTagName("span");
    for (var i = 0; i < spans.length; i++) {
        if (spans[i].className) {
            spans[i].style.color = "red";
            break;
        }
    }
}                
    ​ 
```

工作演示：http: [//jsfiddle.net/jfriend00/kZQJq/](http://jsfiddle.net/jfriend00/kZQJq/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:20:42.713

您可以在生成时从服务器打印出带有变量的 js 脚本标记，该变量是当前生成的类名。然后在需要知道 span 是什么类的地方使用变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T15:32:22.163

我的假设是：具有属性 A dom=for each (e in document.gEBTN('E')) if (eA) e 的元素选择

所以对你来说就像smth`for each (e in document.gEBTN('span')) if (e.class=="1234") e.className=”changedFont”;`

# objective-c - UIView 边框模糊

> ID：12354500
> 
> 赞同：6
> 
> 时间：2012-09-10T15:08:36.280
> 
> 标签：objective-c, ios, core-graphics

有没有办法模糊/淡出 UIView 的边框？

到目前为止，我对核心图形几乎没有做任何事情。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-10T16:18:30.900

您可以尝试将 UIView 的 CALayer 设置为具有较大的阴影半径和透明度。就像是：

```
 #include <QuartzCore/QuartzCore.h> 
```

...

```
 CALayer *layer = myView.layer;
    layer.shadowOpacity = .5;
    layer.shadowColor = [[UIColor blackColor] CGColor];
    layer.shadowOffset = CGSizeMake(0,0);
    layer.shadowRadius = 10; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-06-14T10:05:02.537

使用 swift 版本添加示例：

```
 btnSignIn.layer.cornerRadius = btnSignIn.frame.height * 0.5
    btnSignIn.layer.shadowColor = UIColor.darkGray.cgColor
    btnSignIn.layer.shadowRadius = 4.0
    btnSignIn.layer.shadowOpacity = 1.0
    btnSignIn.layer.shadowOffset = CGSize(width: 0, height: 0) 
```

结果：

[![在此处输入图像描述](../Images/4081a3cf9b9e7f27f44b4b7646c4c3fc.png)](https://i.stack.imgur.com/pgYRa.png)

请记住，如果您在 ib 编辑器中更改阴影设置，它将更改文本的阴影，而不是视图的边框。

您也可以创建一个类并在 IB Builder 中设置它：

```
class UIRoundedWhiteButton: UIButton {

required init?(coder aDecoder: NSCoder) {
    super.init(coder: aDecoder)

    layer.cornerRadius = frame.height * 0.5
    layer.shadowColor = UIColor.darkGray.cgColor
    layer.shadowRadius = 4.0
    layer.shadowOpacity = 1.0
    layer.shadowOffset = CGSize(width: 0, height: 0)
}... 
```

# format - Fortran 90 中的读取格式

> ID：12354503
> 
> 赞同：4
> 
> 时间：2012-09-10T15:08:46.783
> 
> 标签：format, fortran

我有一个巨大的文件要读取，其结构是：

```
 [...]
 (0,0,0,0,0): 5.00634e-33, 5.59393e-33, 6.24691e-33, 7.29338e-33,
 (0,0,0,0,4): 7.77607e-33, 8.95879e-33, 9.65316e-33, 1.07434e-32,
 (0,0,0,0,8): 1.20824e-32, 1.34983e-32, 1.49877e-32, 1.73061e-32,
 (0,0,0,0,12): 1.919e-32, 2.15391e-32, 2.3996e-32, 2.67899e-32,
 [...] 
```

我有兴趣阅读“：”之后的值，`format`如果我使用 Fortran90，我应该在 read 语句中使用哪个值？

我试过了

```
 read(1,'("(",I6,",",I6,",",I6,",",I6,",",I6,"):",F10.4,F10.4,F10.4,F10.4)')idx1,idx2,idx3,idx4,idx5,dummy1,dummy2,dummy3,dummy4 
```

但我有一个`forrtl: severe (64): input conversion error`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-10T15:29:47.400

由于项目似乎没有按列排列，因此与格式有关。我会这样处理：

```
read (55, '(A)')  string
colon_pos = index (string, ":")
read (string (colon_pos+1:len_string), * ) real1, real2, real3, real4 
```

将每一行读入一个字符串，定位冒号，然后使用list-directed IO处理冒号后面的字符串中的数值。

# sql-server - 多表如何加入存储过程？

> ID：12354504
> 
> 赞同：0
> 
> 时间：2012-09-10T15:08:47.493
> 
> 标签：sql-server, stored-procedures, join, left-join, inner-join

我想要多表连接。它显示 1 条数据/显示 2 条记录，但实际上是 1 条数据/1 条记录。

```
select acl.Person_ID as 'CODE'
,pnr.FullName as 'FullName'
,case acl.persontype when 'normal' then 'normal' end as 'Type'
From tbl_aculog acl left join tbl_PerNR pnr On acl.Person_ID=pnr.Person_ID

union

select acl.Person_ID as 'CODE'
,ps.FullName as 'FullName'
,case acl.persontype when 'blacklist' then 'blacklist' end as 'Type'
From tbl_aculog acl left join tbl_Person ps On acl.Person_ID=ps.NPerson_ID 
```

结果：

```
个人ID | 全名 | 类型
00010132 | 斯汀| 普通的
00010132 | 空 | 空值
00000579 | 普洛姆 | 普通的
00000579 | 空 | 空值
00001081 | 华生 | 普通的
00001081 | 空 | 空值
5211080 | 索比特 | 黑名单
5211080 | 空 | 空值
```

**字段 Person_ID & FullName & Type 为 NULL VALUE。

**我想要结果：**

```
个人ID | 全名 | 类型
00010132 | 斯汀| 普通的
00000579 | 普洛姆 | 普通的
00001081 | 华生 | 普通的
5211080 | 索比特 | 黑名单
```

非常感谢您的时间：D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:11:21.770

要从结果中删除`NULL`s，您需要指定`WHERE acl.persontype IS NOT NULL`忽略空的“persontype”。

```
select acl.Person_ID as 'CODE'
,pnr.FullName as 'FullName'
,case acl.persontype when 'normal' then 'normal' end as 'Type'
From tbl_aculog acl left join tbl_PerNR pnr On acl.Person_ID=pnr.Person_ID
WHERE acl.persontype IS NOT NULL

union

select acl.Person_ID as 'CODE'
,ps.FullName as 'FullName'
,case acl.persontype when 'blacklist' then 'blacklist' end as 'Type'
From tbl_aculog acl left join tbl_Person ps On acl.Person_ID=ps.NPerson_ID
WHERE acl.persontype IS NOT NULL 
```

**编辑 1**

使用 an`INNER JOIN`将删除`NULLS`.

```
select acl.Person_ID as 'CODE'
,pnr.FullName as 'FullName'
,case acl.persontype when 'normal' then 'normal' end as 'Type'
From tbl_aculog acl inner join tbl_PerNR pnr On acl.Person_ID=pnr.Person_ID

union

select acl.Person_ID as 'CODE'
,ps.FullName as 'FullName'
,case acl.persontype when 'blacklist' then 'blacklist' end as 'Type'
From tbl_aculog acl inner join tbl_Person ps On acl.Person_ID=ps.NPerson_ID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T16:07:34.517

不是结果

**更多的：**

```
Result:

Person_ID |    FullName |    Type
00010132 |  Stin|         normal
00010132 |  NULL |        NULL
00000579 |  Plom |        normal
00000579 |  NULL |        NULL
00001081 |  Watson |          normal
00001081 |  NULL |        NULL
5211080 |   SOPIT |       blacklist
5211080 |   NULL |        NULL
NULL | NULL |        NULL
NULL | NULL |        NULL

I want Result:

Person_ID |    FullName |    Type
00010132 |  Stin|         normal
00000579 |  Plom |        normal
00001081 |  Watson |          normal
5211080 |   SOPIT |       blacklist
NULL | NULL |        NULL
NULL | NULL |        NULL 
```

我很抱歉数据相关。

到“njk”代码结果没有空值但我想在不重复值时显示空值​​。

非常感谢您再次光临。:)

# django - 在 Django 中迁移用户组和权限？

> ID：12354508
> 
> 赞同：3
> 
> 时间：2012-09-10T15:09:14.760
> 
> 标签：django, migration, django-permissions

我已经构建了一个应用程序，我想将它从我的开发服务器移动到我的生产服务器。在这个应用程序中，我定义了 3 个自定义组`auth.group`，每个组都有特定的权限。

我试图从 auth.group 转储数据 - 它似乎也包括权限 ID。问题是，这些 ID 在我的开发环境和生产环境之间不匹配。似乎还有一个`content_type_id`in auth.permission 我不知道它是如何关联的。

我的问题是，有没有办法使用`dumpdata`或其他方法来迁移组和我的应用程序的所有相关权限？我在生产服务器上导入多个灯具没有问题，但我确实希望设置所有组，而不必通过 UI 并为每个组选择适当的权限。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T15:16:24.317

`django.contrib.auth` **取决于** `django.contrib.contenttypes`因为`auth.models.Permission.content_type` **是一个** `ForeignKey(ContentType)`。

*解决方案*：**在您的数据转储中添加 ContentType**，即。具有以下参数的转储数据：`auth.group contenttypes.contenttype auth.permission`

# multithreading - Action Script 3.0 中的异步

> ID：12354509
> 
> 赞同：1
> 
> 时间：2012-09-10T15:09:14.997
> 
> 标签：multithreading, actionscript-3, actionscript, asynchronous, thread-safety

我想知道，AS3 中的异步是如何实现的？来`Timer`上课吧 计时器异步运行并分派一些事件。似乎它为自己创造了一个新的线程。当定时器事件发生时调用的函数是如何线程安全的？AS3 中的线程安全是如何实现的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T15:29:38.653

AS3 现在支持在最新版本中使用“ActionScript Workers”的多线程。您可以在此预览中看到它是如何使用的……

[http://www.bytearray.org/?p=4423](http://www.bytearray.org/?p=4423)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-10T15:20:17.160

AS3 [曾经是][不是多线程](http://blogs.adobe.com/aharui/2008/01/threads_in_actionscript_3.html)的。

在 Flash Player 11.4 之前，一切都在主（单）线程上运行，这就是为什么如果 CPU 因一些繁重的处理而陷入困境，`Timer`类之类的东西可能会变得[非常不准确。](http://www.bit-101.com/blog/?p=910)

从 Flash Player 11.4 开始，[`Worker`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/Worker.html)引入了对象，提供了创建多个线程的能力。

# awk - 如何在 awk 中迭代两个不同数组中的项目？

> ID：12354513
> 
> 赞同：0
> 
> 时间：2012-09-10T15:09:17.667
> 
> 标签：awk

我想做类似的事情：

```
for (x in {a,b}) {
  ...
} 
```

有没有办法在 awk 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T20:38:38.543

两种选择：

1)

```
for (x in a)
   u[x]

for (x in b)
   u[x]

for (x in u)
   print "Union Index:",x 
```

2)

```
for (x in a)
   print "Union Index:",x

for (x in b)
   if (!(x in a))
      print "Union Index:",x 
```

如果你想要一些东西，你可以在 for 循环中简洁地使用：

```
$ cat tst.awk
function indices(a,b,u, x,c)
{
   for (x in a) {
      u[++c] = x
   }

   for (x in b) {
      if (!(x in a)) {
         u[++c] = x
      }
   }

   return c
}

BEGIN {
   a[3]="foo"
   a[9]=3

   b[5]=7
   b[15]=45

   for (i=1; i<=indices(a,b,u); i++) {
      print u[i]
   }
}
$ awk -f tst.awk
9
3
5
15 
```

# ios - 如何在运行 iOS 应用程序时查看源代码？

> ID：12354514
> 
> 赞同：0
> 
> 时间：2012-09-10T15:09:37.667
> 
> 标签：ios

我有一个`UIViewController`叫简单的`ViewController`。我想要它，以便当用户按下屏幕上的按钮时，它会向他们显示`ViewController.m`. 我怎样才能做到这一点？我试过了

```
NSString *contents = [NSString stringWithContentsOfFile:@"ViewController.m" encoding:NSUTF8StringEncoding error:nil];
NSLog(@"%@",contents); 
```

但它不断返回`null`任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:12:53.673

您需要将 .m 文件打包为要在适当的构建阶段复制到应用程序的主包中的资源，然后从包中读取它以显示。

# python - Python中的集合和列表有什么区别？

> ID：12354515
> 
> 赞同：53
> 
> 时间：2012-09-10T15:09:41.343
> 
> 标签：python, list, set

Python中集合和列表之间的唯一区别是您可以使用并集、相交、差异、对称差异函数来比较两个集合吗？为什么这些函数不能简单地应用于列表？在什么情况下集合比列表更有用？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-09-10T15:11:41.130

有很大的不同。

1.  集合不能包含重复项
2.  集合是无序的
3.  为了在集合中查找元素，使用哈希查找（这就是集合无序的原因）。这使得`__contains__`( `in`operator) 对于集合比列表更有效。
4.  集合只能包含可散列项（参见#3）。如果你尝试：`set(([1],[2]))`你会得到一个`TypeError`.

在实际应用中，列表非常适合排序和排序，而当您不想重复并且不关心顺序时，集合很适合使用。

*另请注意，如果您不关心订单等，您可以使用*

```
new_set = myset.intersection(mylist) 
```

*得到 a`set`和 a之间的交集`list`。*

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-10T15:12:30.420

[`sets`](https://docs.python.org/2/library/sets.html)— 独特元素的无序集合

[`lists`](https://docs.python.org/2/faq/design.html#how-are-lists-implemented)- 有序的元素集合

`sets`允许您进行诸如`intersection`、`union`、`difference`和`symmetric difference`之类的运算，即数学集合论的运算。Sets 不允许索引并且在哈希表上实现。

`lists`实际上是可变长度数组，而不是 Lisp 样式的链表。在列表中，元素通过索引访问。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-12-04T08:59:02.430

**放**

集合是无序和无索引的集合，并且不允许重复。在 Python 中，集合是用大括号编写的。

```
# example set
newset = {"one", "two", "three"} 
```

*   您不能通过引用索引来访问集合中的项目
*   集合是可变的
*   它们对于检查重复项很有用

**列表**

列表是有序且可变的集合。在 Python 中，列表是用方括号编写的。

```
# example list
newlist =["one", "two", "three"] 
```

*   您通过引用索引号访问列表项
*   列表是可变的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-09-12T07:35:25.657

Set 表示不同元素的集合。在 python 中，集合主要用于两个原因（书籍：Data Science from Scratch，Joel Gruce）：

1.  为了更快的操作： **in**是一个非常快速的集合操作。如果我们有大量元素并且我们希望执行成员资格测试，那么在这种情况下使用集合而不是列表是合适的。

2.  在集合中查找不同的项目。程序员使用集合的频率远低于字典和列表。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-08-31T03:56:02.463

还有一些区别是：

1.  列表可以是二维的，而集合不能。
2.  由于列表是有序的（即有序列号），列表执行起来相对较慢，而集合执行得很快。
3.  python中的列表就像java或c的数组。
4.  打印一组几乎总是提供不同的输出顺序。
5.  Set 用于`hash function`查找元素，而 list 是一个数组。因此查找元素 in`Set`比 in 更快`list`。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-12-16T12:39:51.630

实际上python中有四种集合数据类型：

> **List**是一个有序且可变的集合。允许重复成员。
> 
> **元组**是一个有序且不可更改的集合。允许重复成员。
> 
> **Set**是一个无序和无索引的集合。没有重复的成员。
> 
> **字典**是一个无序、可变和索引的集合。没有重复的成员。

您可以通过引用其索引来访问**列表项。**但是，在**sets**中，您需要遍历 set 项目才能访问它。

来源：[https ://www.w3schools.com/python/python_sets.asp](https://www.w3schools.com/python/python_sets.asp)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-10-25T16:00:22.100

集合和列表之间的区别在这里，我们将讨论Python中集合和列表之间的区别。

**列表** 1) 列表按元素插入的顺序保存元素。2) 列表支持索引。3）我们可以改变存储在列表中的元素的值。4) 列表可以存储重复值。5) 列表使用方括号声明。6) 示例：A = [1, 2, 3, 4, 5, 1, 2, 3]

**集合** 1) 集合不按插入顺序保存元素。2) 集合不支持索引。3）我们不能改变存储在集合中的元素的值。4) 集合不能存储重复值。5) 使用大括号声明集合。6) 示例：A = {1, 2, 3, 4, 5}

在下面给出的链接 [https://tutorialsimpact.com/python/sets-in-python上了解有关带有示例的集合的更多信息](https://tutorialsimpact.com/python/sets-in-python)

# html - Firefox 拖动到文件表单元素不触发更改事件侦听器

> ID：12354516
> 
> 赞同：0
> 
> 时间：2012-09-10T15:09:44.033
> 
> 标签：html, forms, file, firefox, coffeescript

如您所知，在 HTML 表单文件字段中，您可以将文件拖放到“选择文件”按钮或显示所选文件的文本字段中。这将选择文件而不使用对话框。我正在使用这种行为，使用不可见且放大的文件字段区域来模拟“拖放区”，无需 HTML5 即可即时上传。

我刚刚更新到 Firefox 15.0.1，发现当从桌面删除文件时，我的文件字段 HTML 表单元素不再触发更改事件。这在 Chrome 21.0.1180.89 和 Safari 5.1.6 中继续为我工作，并且在我更新之前的上周五在 Firefox 中工作。

咖啡脚本

```
$ ->
    fileField = document.getElementById 'file-field'
    fileField.addEventListener 'change', file_changed, false 
```

有趣的是，Firefox 允许进行拖放，从而用我的文件填充文件字段，但由于没有触发“更改”事件，我无法自动提交表单以获得即时上传效果。如果有人知道发生了什么，或者可以提出一个精简的替代方案，我将不胜感激:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T17:10:14.730

在向 Mozilla 提交错误后，我被告知该错误已被报告，应该在未来的版本中修复。很高兴他们没有故意删除此功能！

# tinymce - 在 TInyMCE 中强制使用绝对 URL

> ID：12354517
> 
> 赞同：1
> 
> 时间：2012-09-10T15:09:45.753
> 
> 标签：tinymce, umbraco

> **可能重复：**
> [Umbraco TinyMCE - 未在插入/更新链接中显示绝对 URL](https://stackoverflow.com/questions/12353953/umbraco-tinymce-not-showing-absolute-urls-in-insert-update-link)

嗨，我正在使用 Umbraco，由于某种原因，我无法让 TinyMCE 使用绝对网址。我已经更改了 tinymce 配置，但似乎没有任何效果。有没有人有任何想法？

我正在使用 umbraco 4.7

# nhibernate - 使用 NHibernate 映射自反多对多关系？

> ID：12354518
> 
> 赞同：1
> 
> 时间：2012-09-10T15:09:48.880
> 
> 标签：nhibernate, nhibernate-mapping

我正在尝试将 NHibernate 与现有数据库一起使用。数据库记录用户之间的单向关系：

```
Users
    UserId              PK
    Name

Relationships
    RelationshipId      PK
    ParentId            FK:Users_UserId
    ChildId             FK:Users_UserId 
```

我想用 NHibernate 来表示这个。目前，我有以下 POCO 对象：

```
class User {
    public virtual int Id { get; set; }
    public virtual string Name { get; set; }

    public ICollection<User> ParentUsers {get; set;}
    public ICollection<User> ChildUsers {get; set;}
} 
```

我也有这个映射文件：

```
<class name="User" table="Users">
    <id name="Id"></id>
    <property name="Name"></property>
</class> 
```

我查看了网络上的指南，但我无法确定需要在映射文件中放入什么来连接我的两个`ICollection`属性。

我应该如何映射这个数据结构？我目前的方法是正确的，还是创建第二个 POCO 类并只使用两个`many-to-one`关系更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:08:43.180

我可能遗漏了一些东西，但这应该让你开始：

```
<idbag name="ParentUsers" table="Relationships">
  <collection-id column="RelationshipId" type="...">
    <generator class="..."/>
  </collection-id>
  <key column="ChildId"/>
  <many-to-many column="ParentId" class="User"/>
</idbag>
<idbag name="ChildUsers" table="Relationships">
  <collection-id column="RelationshipId" type="...">
    <generator class="..."/>
  </collection-id>
  <key column="ParentId"/>
  <many-to-many column="ChildId" class="User"/>
</idbag> 
```

此外，其中一个集合应标记为`inverse`。

# c# - TextBox.Focus() 仅在我后面有 MessageBox.Show() 时才有效？

> ID：12354524
> 
> 赞同：0
> 
> 时间：2012-09-10T15:10:02.253
> 
> 标签：c#, .net, wpf, textbox, focus

好的，显然还有更多内容，但这是基础知识。这似乎是一件很简单的事情，但它不起作用。

我有一个标签。我有一个文本框。

标签的 ZIndex = "1" TextBox 的 ZIndex = "0"

即它们彼此重叠并且TextBox 是不可见的。

当用户单击 LABEL（现在通过 PreviewMouseLeftButtonDown，但在此“工作”之后将成为 ViewModel 中的命令）时，应用程序应将焦点设置到 TextBox。

简单吧？错误的...

如果我有这个代码......它不起作用。

```
 private void inVisTxtBox_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
        {
            inVisTxtBox.Focus();
//            TextBox_MouseDown(sender, e);
        } 
```

如果我有这个代码......它确实有效

```
 private void inVisTxtBox_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
        {
            inVisTxtBox.Focus();
//            TextBox_MouseDown(sender, e);
            MessageBox.Show("This is ridiculous");
        } 
```

最后是 XAML：

```
 <Ctrls:AControl x:Class="<location of class>"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:CommandControls="clr-namespace:<location of custom controls>" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
    <Grid Margin="0,15,15,15">
        <!--<Button Height="50" Click="Button_Click">FOC</Button>-->
        <TextBox x:Name="inVisTxtBox" Focusable="True" Grid.ZIndex="0" Width="100" Margin="5"/>
        <Label Grid.ZIndex="1" Margin="5" Content="243234234234234" HorizontalAlignment="Left" Width="100" PreviewMouseLeftButtonDown="inVisTxtBox_PreviewMouseLeftButtonDown" 
               x:Name="KeyPress_TextBox"/>
    </Grid>
</Ctrls:AControl> 
```

**编辑**

如果我将标签制作成带有标签的模板按钮，它的模板就可以工作：

```
<Button x:Name="KeyPress_TextBox" Grid.ZIndex="1" Margin="5" Content="243234234234234" HorizontalAlignment="Left" Width="100" Click="KeyPress_TextBox_Click">
    <Button.Template>
        <ControlTemplate TargetType="Button">
            <Label Content="{TemplateBinding Content}"/>
        </ControlTemplate>
    </Button.Template>
</Button> 
```

这是为什么？

一定与事件路线/泡沫的方式有关吗？

我现在这样做了……但我更好奇发生了什么。

另外......以下都不起作用：

```
Keyboard.Focus(inVisTxtBox);
FocusManager.SetFocusedElement(MainGrid,inVisTxtBox);
Keyboard.Focus(inVisTxtBox); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:35:18.800

我复制了你的代码，它对我来说很好，即使使用 previewmouseclick，其他问题似乎也是问题所在。

在 PreviewMouseLeftButtonDown 事件触发后，可能将消息框向上抛出会阻止焦点转移到它将转移到的任何位置。也许 UserControl 本身正在获得焦点？

# connection - Websphere MQ 队列连接工厂无法创建队列连接

> ID：12354526
> 
> 赞同：0
> 
> 时间：2012-09-10T15:10:07.277
> 
> 标签：connection, websphere, message-queue

我使用 WebSphere MQ 消息传递提供程序在 Websphere 中创建了一个队列连接工厂。使用 JNDI 获取此资源，并尝试在同一主机上创建队列连接。第一次，一切正常，但是当我第二次时，它会抛出一个 JMS 异常：

```
javax.jms.JMSException: Failed to create queue connection
    at com.ibm.ejs.jms.JMSCMUtils.mapToJMSException(JMSCMUtils.java:141)
    at com.ibm.ejs.jms.JMSQueueConnectionFactoryHandle.createQueueConnection(
         JMSQueueConnectionFactoryHandle.java:90) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T23:59:25.113

帖子中的信息很少，除了猜测之外很难做任何事情。我首先要查找的是应用程序或队列是否设置为独占使用。当然，这假设您正在打开输入队列，并且问题中没有提到该细节。拥有将提供实际 WMQ 原因和完成代码的链接异常可以肯定地告诉您，但问题中也没有提供这些。

如果 JMS 代码不打印链接异常，许多商店将其视为 Sev-1 缺陷。这不是特定于 WMQ 的事情，而是打印出所有可用诊断信息的情况，而不管传输提供商如何。如果您想了解更多信息，请参阅 WMQ Ifocenter [JMS 异常处理主题](http://pic.dhe.ibm.com/infocenter/wmqv7/v7r5/topic/com.ibm.mq.doc/jm35210_.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-13T10:22:23.980

最大连接在 WAS 控制台中。如果连接数超过最大连接数且未释放资源（QueueConnection、QueueSender 和 QueueSession），则在下一次连接时将无法从连接池中获取连接。只有重新启动服务器后，您才能释放连接。这可以通过在代码中正确关闭所有资源（QueueConnection、QueueSender 和 QueueSession）来解决。

# ruby - Perl Net::CIDR::Lite 的 Ruby 版本？

> ID：12354529
> 
> 赞同：0
> 
> 时间：2012-09-10T15:10:11.633
> 
> 标签：ruby, perl

我正在将旧的 Perl 脚本更新为 Ruby，但在寻找替代 Perl 库时遇到了问题。

在我们使用的 Perl 脚本中`Net::CIDR::Lite`，它接受一个开始和结束 IP 地址范围并输出一个 CIDR 字符串。

这是一个显示功能的 Perl 示例：

```
#!/usr/bin/perl

use Net::CIDR::Lite;
$cidrblocks = Net::CIDR::Lite->new;
$cidrblocks->add_range("109.152.0.0-109.152.7.255");

$coveragezone = "";

@cidrlist = $cidrblocks->list();

$cidrcount=0;
    while ( defined $cidrlist[$cidrcount] ) {
            $coveragezone .= "$cidrlist[$cidrcount]";
    }
    continue {
            $cidrcount++;
    }

print "$coveragezone"; 
```

此脚本返回一个字符串：

```
=> 109.152.0.0/21 
```

有谁知道我可以用来复制`add_range`调用功能的 Ruby lib 或 gem？

```
$cidrblocks = Net::CIDR::Lite->new;
$cidrblocks->add_range("109.152.0.0-109.152.7.255"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T14:47:15.710

找不到合适的宝石？顺其自然——在 Ruby 中重新实现 Perl 模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:54:16.103

我更喜欢[NetAddr](http://netaddr.rubyforge.org/classes/NetAddr.html) gem，尤其是它的[NetAddr::CIDR](http://netaddr.rubyforge.org/classes/NetAddr/CIDR.html)类。

这是一个非常丰富的 IPv4/IPv6 gem。

* * *

查看我所知道的三个模块，Ruby 的内置 IPAddr、NetAddr 和 IPAddress，@holgerjust 提到，它们都没有让我们能够提供起始 IP 和结束 IP 并返回结果网络。它们都假定网络的 CIDR 形式，然后努力测试各个 IP 以查看它们是否适合子网，或者使用该子网定义自己生成 IP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T20:51:00.333

虽然这可能与您的问题并不完全相关，但我将部分 CIDR::Lite 移植到了 Ruby：

[https://github.com/noahhaon/cidr-lite-ruby](https://github.com/noahhaon/cidr-lite-ruby)

在合并非常大的重叠 CIDR 集时，我发现它的性能远优于可用的 ruby​​ 替代品。

高温高压

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T15:21:17.483

您可以使用也处理 CIDR 网络的内置 [`IPAddr`类](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/ipaddr/rdoc/IPAddr.html)，或者使用提供一些额外帮助程序的[ipaddress gem 。](http://rubygems.org/gems/ipaddress)

一个简单的例子是：

```
cidrblocks = []
cidrblocks << IPAddr.new("109.152.0.0/21")

included = cidrblocks.find{|net| net.include?("109.152.6.123") } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-11T19:34:22.613

我找到了一个 ruby​​ 模块，它的翻译见

[http://wejn.org/stuff/cidr.rb.html](http://wejn.org/stuff/cidr.rb.html)

已将其包含在我的 Rails 应用程序中，非常完美

# build - 如何使用 Automake 创建一个特定目录？

> ID：12354533
> 
> 赞同：0
> 
> 时间：2012-09-10T15:10:32.610
> 
> 标签：build, makefile, directory, automake

我只想知道我需要写什么`Makefile.am`来创建一个`build`在同一个目录中调用的目录`Makefile.am`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T03:09:29.830

仔细想想你的问题：你真的想`build`在同一个目录中创建`Makefile.am`，还是在调用时在当前工作目录中创建`configure`？这些并不总是一回事：GNU 构建系统旨在支持树外构建（可能是只读的`$srcdir`），因此最终用户应该期望以下工作：

```
$ tar xf autofoo-1.2.tar.gz
$ mkdir autofoo-build
$ cd autofoo-build
$ ../autofoo-1.2/configure
$ make
$ sudo make install 
```

现在，我发现创建目录的最简单方法是根本不使用 Makefile.am ，而是使用 make 来完成`config.status`它（这是一个 shell 脚本，它在等等）。在中，输入以下内容：`configure``Makefile.in``Makefile``config.h.in``config.h``configure.ac`

```
AC_CONFIG_COMMANDS([mkdir], [$MKDIR_P build]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T16:50:02.467

你需要写：

```
build:
    test -d ${srcdir}/build || mkdir ${srcdir}/build 
```

但你真的不想那样做。源目录应该被认为是只读的。如果您只是想在构建目录中创建一个名为 build 的目录，只需执行

```
build:    
    test -d build || mkdir build 
```

# android - 何时清除android中状态通知的通知计数

> ID：12354538
> 
> 赞同：0
> 
> 时间：2012-09-10T15:10:42.033
> 
> 标签：android, notifications

我有一种创建通知的方法。我想在`number`用户单击状态通知后立即清除通知。

```
public void createNotification(){

        NotificationManager notificationManager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);
        Notification notification=null;
        notification = new Notification(R.drawable.ic_launcher, "You have a new message", System.currentTimeMillis());

        notification.flags |= Notification.FLAG_AUTO_CANCEL;
        notification.number = **count**++;
        Intent intent = new Intent();
            intent.setClass(TabInterfaceActivity.this, TabInterfaceActivity.class);

        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);
        PendingIntent activity = PendingIntent.getActivity(this, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);
        notification.contentIntent = activity;
        notification.setLatestEventInfo(this, " New Message", message, notification.contentIntent);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:39:11.043

If by "*I want to clear notification number*" you mean you want to keep the notification itself still displayed, but you want just to update/remove counter, then you should set your notification PendingIntent to point to your code that would handle this scenario for you, and when it completes it shall redirect to your target `TabInterfaceActivity` (or you can make it more flexible and pass target in PendingIntent's Bundle).

# python - 查找字符串的最佳匹配

> ID：12354541
> 
> 赞同：-2
> 
> 时间：2012-09-10T15:10:57.637
> 
> 标签：python

我有两本词典。

```
mydict1 ={                                                                                           
    'Better' : {'vara1':'vala1', 'varb1':'valb1'},                                                                                   
    'BetterThanBest' : {'vara2':'vala2', 'varb2':'valb2'} }

mydict2 = {                                                                                                                                                            
    '/check12/BetterThanBest':'/dir3/BetterThanBest' }                                                                                                                                                                

for i in mydict2 :                                                                                                                                                     
    for pattern in mydict1.keys() :                                                                                                                                    
        if pattern in i : 
           print pattern, i                                                                                                  
           # Do something for i, 
           # but don't want multiple matches to i, just the best 
```

这返回：

```
 Better /check12/BetterThanBest
 BetterThanBest /check12/BetterThanBest 
```

我想找到 mydict1 的键的完全匹配，即在上述情况下为“BetterThanBest”。可能吗 ？

感谢您的任何回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:26:00.433

```
In [43]: mydict1 ={                                                                                           
   ....:     'Better' : {'vara1':'vala1', 'varb1':'valb1'},                                                                                   
   ....:     'BetterThanBest' : {'vara2':'vala2', 'varb2':'valb2'} }

In [44]: mydict2 = {                                                                                                                                                            
   ....:     '/check12/BetterThanBest':'/dir3/BetterThanBest' }

In [51]: keys1=sorted(list(mydict1),key=len,reverse=True) #sort the keys by length, descending order

In [52]: keys2=sorted(list(mydict2),key=len,reverse=True) #sort the keys by length, descending order

In [54]: [x for x in keys1 for y in keys2 if x in y][0]
Out[54]: 'BetterThanBest' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:15:38.873

`startswith`您可以尝试使用and进行穷人的锚定`endswith`，但实际上，您可能希望使用正则表达式或完全相等性检查以及候选字符串的标记化来完全匹配您想要的方式。或者使用有序的密钥库，根据超集>子集>子集组织您的搜索词，然后在第一次查找时打破搜索例程。做几个假设：

```
pattern_dict = {'Better' : {'vara1':'vala1', 'varb1':'valb1'},                                                                                   
                'BetterThanBest' : {'vara2':'vala2', 'varb2':'valb2'}}
candidate_dict = {'/check12/BetterThanBest':'/dir3/BetterThanBest' } 
for candidate, candidate_value in candidate_dict.iteritems():
    try:
        match_pattern = pattern_dict[candidate.rsplit('/', 1)[-1]]
    except KeyError:
        pass
    else:
        # do stuff for each matched candidate and it's matched pattern dict 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T15:47:14.330

好的，我不知道为什么所有这些负面因素都指向这个问题，但我尝试了以下方法，它做了我想要的：

```
mydict1 ={                                                                                                                                                             
    'Better' : {'var1':'vala1', 'var2':'valb1'},                                                                                                                       
    'BetterThanBest' : {'var1':'vala2', 'var2':'valb2'}                                                                                                                
    }                                                                                                                                                                  
mydict2 = {                                                                                                                                                            
   '/check12/BetterThanBest':'/dir3/BetterThanBest'                                                                                                                   
   }                                                                                                                                                                  

for i in mydict2 :                                                                                                                                                     
    pat ='a'                                                                                                                                                           
    for pattern in mydict1.keys() :                                                                                                                                    
        if pattern in i and pattern.__len__() > pat.__len__():                                                                                                         
            pat = pattern                                                                                                                                              

    print pat
    print mydict1[pat]["var1"] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T15:25:41.397

恐怕您的要求对我来说不是很清楚，但是假设您要做的是将 的键与键中`mydict1`的最后一个单词匹配`mydict2`（`/`作为单词分隔符），这就是我可能会采用的方法。

```
d2_keys = dict((k.rsplit('/', 1)[-1], k) for k in mydict2)
for k in my_dict1:
  if k in d2:
    print k, d2[k] 
```

这是做什么的：

1.  首先，我们创建一个新的字典`d1`，它将从每个键中提取的单词映射`mydict2`到原始值。这使我们能够快速将键与提取的单词进行比较，并将其映射到原始值。

    ```
    >>> d2 = dict((k.rsplit('/', 1)[-1], k) for k in mydict2)
    >>> d2
    {'BetterThanBest': '/check12/BetterThanBest'} 
    ```

2.  接下来我们遍历 的键`mydict1`并将键与 进行比较`d2`。

`mydict2`警告：如果输入的键导致重复的单词，这现在将按预期工作。

# html - 元素相对位置向右：元素的0

> ID：12354542
> 
> 赞同：1
> 
> 时间：2012-09-10T15:10:59.337
> 
> 标签：html, css

我正在尝试在 1000px 固定宽度页面的左侧和右侧实现虚线（自定义）无聊。

左边的很好，这是一种享受：

```
#border-left{
position: absolute;
float:left;
top: 0px;
bottom: 0;
width: 5px;
background-image: url('../img/border.gif');
background-repeat:repeat-y;
} 
```

但是，当我在右侧重新执行此操作时，它不会完全起作用。我需要它相对定位在 1000px 的右侧而不是窗口的右侧。

```
#border-right{
position: relative;
right: 0;
top: 0;
bottom: 0;
margin-top: -90px;
width: 5px;
background-image: url('../img/border.gif');
background-repeat:repeat-y;
} 
```

父元素：

```
#container{
width:1000px;
display: block;
margin:0px auto;
text-align:left;
padding-top:90px;
} 
```

那是行不通的。我能做到这一点吗？我需要它基本上浮动：正确（但是我不能使浏览器窗口的高度为 100%）。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:18:04.700

演示：http: [//jsfiddle.net/iambriansreed/sAhmc/](http://jsfiddle.net/iambriansreed/sAhmc/)

删除了绝对元素上的浮动。向父级添加绝对位置并使用左侧和边距居中。删除了右边框上不需要的 margin-top。用类替换了边框 ID。

边框位于 1000 像素宽度之外。

```
#container>.border{
    position: absolute;
    top: 0;
    bottom: 0;
    width: 5px;
    background-image: url('../img/border.gif');
    background-repeat:repeat-y;
}
#container>.border.left{
    left: -5px;
    background-color: red; /* demo */
}
#container>.border.right{
    right: -5px;
    background-color: blue; /* demo */
}
#container{
    position: absolute;
    top: 0;
    bottom: 0;
    width: 100px; /* demo */
    left: 50%;
    margin-left: -50px; /* half of width */
    text-align: left;
    padding-top: 90px;
    overflow: visible;
    background: #eee; /* demo */
}​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:15:09.207

我认为添加一个“位置：相对；” #container 元素的规则应该适合您。

# c# - winform中的组合框和许多条目

> ID：12354545
> 
> 赞同：0
> 
> 时间：2012-09-10T15:11:10.523
> 
> 标签：c#, winforms, combobox, addrange

我试图在 winform 中获得一个包含大约 5'000 个条目的组合框。我之前遇到过一个问题 - addrange 挂起这么多条目。我创建了一个单独的控件来为自己执行此操作而不会滞后，但我正在将此功能添加到现有的组合框。

在尝试查看是否可以解决此问题时，我正在查找 WPF 的 VirtualizingStackPanel。

有没有办法为几千个字符串条目提高 addrange 的性能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T15:15:24.300

您是否尝试过使用`ComboBox.BeginUpdate`and `ComboxBox.EndUpdate`？使用这些方法可以提高添加项目时的性能。

当然，如果您有 5000 个项目，那么使用 ComboBox 可能不是正确的控件（拥有超过 200 个项目左右会使滚动变得不可能，这违背了拥有下拉选择器的意义）。您是否考虑过使用普通文本框但使用自动完成提供程序？

# .net - 数据库磁盘映像格式错误的sqlite

> ID：12354546
> 
> 赞同：2
> 
> 时间：2012-09-10T15:11:15.810
> 
> 标签：.net, sqlite, system.data.sqlite

我已将我的`.net 2.0`项目迁移到`.net 4.0`. 有了这个，我不得不将`system.data.sqlite`库升级到可用的最新版本`1.0.81`。

现在，当我尝试使用查询大表时`select * from table`出现**`The database disk image is malformed`**错误。这只发生在有很多记录的表上，小表返回记录。

请注意，如果我返回`.net 2.0`并且`system.data.sqlite 1.0.66`相同的数据库文件可以完美运行。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T16:51:11.057

最近也遇到了类似的问题。即使使用以下查询将 ATable 表中的所有 AColumn 值更新为新值，例如 2

```
UPDATE ATable SET AColumn = 2; 
```

以下选择不同的查询

```
SELECT DISTINCT AColumn from ATable; 
```

返回旧值，例如 1,2,3，和

```
SELECT * FROM ATable WHERE AColumn = 1 
```

导致**“数据库磁盘映像格式错误的 sqlite”** 错误。

ATable 在 AColumn 上有一个索引，所有通过该索引的查询都返回了错误的结果。使用以下 PRAGMA 运行完整性检查证明某些索引已损坏。

```
PRAGMA integrity_check; 
```

IDX_AColumn 缺少很多行，索引也包含错误数量的条目。幸运的是，所有表中的数据都完好无损，只有少数索引损坏。重新索引损坏的索引解决了问题。

```
REINDEX ATable; http://www.sqlite.org/lang_reindex.html 
```

如果很多索引已损坏，您可以使用命令同时重新索引所有索引：

```
REINDEX; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T21:06:32.897

您的数据库文件*已*损坏，较旧的 SQLite 版本无法检测到这一点。

使用备份中的数据（或尽可能多地从旧数据库中刮取的数据）创建一个新的数据库文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-17T17:26:27.587

我做了一些测试，发现实际上它只是解决它的一个小操作。

1.  用任何软件打开数据库
2.  删除数据库密码
3.  保存数据库
4.  打开数据库
5.  再次设置密码

很愚蠢。

希望这有助于任何遇到同样问题的机构。

# c++ - 存储一组不同类型的数组

> ID：12354556
> 
> 赞同：0
> 
> 时间：2012-09-10T15:11:52.660
> 
> 标签：c++

有趣的是，假设我有以下课程：

```
class Data
{
public:
    template<class T>
    std::vector<T> getData(std::string& dataName);
private:
    ...
}: 
```

所以这个类存储了一组任意类型的向量。每个向量都有一个名称，我在检索它时知道它的类型。我可以使用什么容器在 Data 类中存储这些数据？一个`std::vector<std::pair<std::string,std::vector<T>>>`？

**更新**：

我还需要遍历这个类，并且这些项目必须与我添加它们的顺序相同。

例如，我可能有：

```
ownerNames: std::vector<std::string>;
ipAddress: std::vector<char>; 
```

在我的店里。所以当我迭代时，我需要按这个顺序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:16:10.023

如果您在检索时知道类型，请使用`boost::any`：

```
struct Data
{
    std::map<std::string, boost::any> store;

    template <typename T>
    std::vector<T> & get(std::string const & s)
    {
        boost::any & a = store.find(s)->second;       // check existence!
        return boost::any_cast<std::vector<T> &>(a);  // try/catch bad cast!
    }

    template <typename T>
    bool put(std::string const & s, std::vector<T> v)
    {
        return store.emplace(s, std::move(v)).second;
    }
}; 
```

用法：

```
void f(Data & d)
{
    try
    {
        auto & v = d.get<int>("MyNumbers");
    }
    catch (boost::bad_any_cast const & e)
    {
        std::cout << "'MyNumbers' is not an int-vector.\n";
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-10T15:16:12.007

我想你想要`boost::any`。

```
typedef std::vector<boost::any> any_vector;

std::map<std::string, any_vector> data; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-10T15:45:23.943

好的，根据最新的评论，我建议这样的课程：-

```
class Server
{
public:
  const IPAddress GetIPAddress ();
  vector <std::string> &GetOwners ();
}; 
```

where`IPAddress`是一个帮助类，用于存储 IP 地址并以各种方式（四个字符、字符串、int 等）访问它。

我真的不会尝试对两个不同的数据集合（IP 地址、所有者名称）强制使用相同的访问方式。

# c# - 为什么 StringWriter.ToString 返回 `System.Byte[]` 而不是数据？

> ID：12354558
> 
> 赞同：3
> 
> 时间：2012-09-10T15:12:03.350
> 
> 标签：c#, stream, stringwriter

`UnZipFile`方法将数据从`inputStream`写入`outputWriter`。为什么`sr.ToString()`返回`System.Byte[]`而不是数据？

```
using (var sr = new StringWriter())
{
    UnZipFile(response.GetResponseStream(), sr);
    var content = sr.ToString();
}

public static void UnZipFile(Stream inputStream, TextWriter outputWriter)
{
    using (var zipStream = new ZipInputStream(inputStream))
    {
        ZipEntry currentEntry;
        if ((currentEntry = zipStream.GetNextEntry()) != null)
        {
            var size = 2048;
            var data = new byte[size];
            while (true)
            {
                size = zipStream.Read(data, 0, size);
                if (size > 0)
                {
                    outputWriter.Write(data);                       
                }
                else
                {
                    break;
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T15:17:02.053

问题就出在这条线上：

```
outputWriter.Write(data); 
```

`StringWriter.Write`没有期望 a 的重载`byte[]`。因此，`Write(Object)`改为调用。根据[MSDN](http://msdn.microsoft.com/en-us/library/dfc2b8zk.aspx)：

> 通过调用该对象的 ToString 方法，将对象的文本表示形式写入文本字符串或流。

调用`ToString`字节数组返回`System.byte[]`，解释如何在`StringWriter`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:16:18.740

原因很简单：

`data`是类型`byte[]`。`byte[]`on没有重载，`StringWriter`因此它使用[object 的重载](http://msdn.microsoft.com/en-us/library/dfc2b8zk.aspx)。然后调用`ToString()`仅打印类型的盒装字节数组。

您的代码等效于：

```
outputWriter.Write(data.ToString()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T15:38:25.553

无神论者，

看看这里的其他答案，我将不得不同意“ToString（）”返回 System.Byte [] 的原因是因为这是您放入其中的内容，并且放入 StringWriter 的所有内容都称为它自己的这样做时的“ToString”方法。（即 byte[].toString() = "System.byte[]"）。事实上，整个想法是 StringWriter 仅用于写入字符串“缓冲区”（StringBuilder），因此理论上如果您的文件足够大（大于 2048），您的输出将是“System.Byte [] System .Byte[]”（等等）。尝试将其压缩为内存流，然后从该流中读取，可能会更好地了解您正在查看的内容。（代码未经测试，只是示例）。

```
using (Stream ms = new MemoryStream())  
{
    UnZipFile(response.GetResponseStream(), ms);

    string content;

    ms.Position = 0;
    using(StreamReader s = new StreamReader(ms))
    {
        content = s.ReadToEnd();
    } 
}

public static void UnZipFile(Stream inputStream, Stream outputWriter)
{      
    using (var zipStream = new ZipInputStream(inputStream))
    {
        ZipEntry currentEntry;
        if ((currentEntry = zipStream.GetNextEntry()) != null)
        {
            int size = 2048;
            byte[] data = new byte[size]; 
            while (true)
            {
                size = zipStream.Read(data, 0, size);
                if (size > 0)
                {
                    outputWriter.Write(data);
                }
                else
                {
                    break;
                }
            }
        }
    }
} 
```

另一个想法实际上是使用 endcoding 来获取字符串

```
public string UnZipFile(Stream inputStream)
{
    string tmp;

    using(Stream zipStream = new ZipInputStream(inputStream))
    {
        ZipEntry currentEntry;

        if(currentEntry = zipStream.GetNextEntry()) != null)
        {
            using(Stream ms = new MemoryStream())
            {
                int size = 2048;
                byte[] data = new byte[size];
                while(true)
                {
                    if((size = zipStream.Read(data,0,size)) > 0)
                        ms.Write(data);
                    else
                        break;
                }
                tmp = Encoding.Default.GetString(ms.ToByteArray());
                }
            }
        }
    }
    return tmp;
} 
```

或者作为最后一个想法，您实际上可以将原始代码更改为

```
outputWriter.Write(Encoding.Default.GetString(data)); 
```

代替

```
outputWriter.Write(data); 
```

顺便说一句，请避免在帖子中使用 var 关键字，这可能只是我的小毛病，但使用弱类型时代码的可读性较差。

[StringWriter.Write:MSDN](http://msdn.microsoft.com/en-US/library/system.io.stringwriter.write%28v=vs.80%29) [StringWriter.ToString:MSDN](http://msdn.microsoft.com/en-US/library/system.io.stringwriter.tostring%28v=vs.80%29)

# .net - 哪个 .NET API 将允许我以编程方式重命名 zip 文件的内容，而无需解压缩和重新压缩 zip 文件？

> ID：12354560
> 
> 赞同：0
> 
> 时间：2012-09-10T15:12:29.087
> 
> 标签：.net, api, zip

我正在寻找一个 .NET 开源 API，它允许我打开一个 zip 文件（无需实际提取其内容），获取文件列表，然后重命名它们，所有这些都无需解压缩并重新压缩 zip文件。

有这样的API吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:13:01.740

DotNetZip - [http://dotnetzip.codeplex.com/](http://dotnetzip.codeplex.com/)

您可以编辑 ZipEntry 的 Filename 属性。

# sql - SQL Server 2008 Express R2 格式查询输出到文本文件

> ID：12354561
> 
> 赞同：0
> 
> 时间：2012-09-10T15:12:32.627
> 
> 标签：sql, sql-server

我有一个大表（~ 6GB），它比我的计算机 RAM 大，我试图从 SQL Server 数据库输出到特定格式的文本文件，以用作另一个程序的输入。

数据库看起来像这样：

```
bought    month     day
   0        11       01
   0        10       07
   1        01       06
   1        04       03
   0        08       03
   0        07       03
   0        02       03
   0        11       05
   1        09       02
  ...       ...     ... 
```

我需要像这样格式化输出文件：

```
0 | month:11 day:01
0 | month:10 day:07
1 | month:01 day:06
1 | month:04 day:03
0 | month:08 day:03
0 | month:07 day:03
0 | month:02 day:03
0 | month:11 day:05
1 | month:09 day:02
... 
```

关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:15:35.250

如果您正在运行 SQL Server 管理工作室，则可以输出到文件。

转到工具-> 选项-> 查询结果，您应该能够选择“结果到文件”- 指定下面的目录，然后运行您的查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:20:05.767

应该只需要一些字符串连接。

```
SELECT bought + ' | month:' + month + ' day:' + day
FROM tablename 
```

我必须承认，我从来没有在这么大的数据集上尝试过这个，所以我不能告诉你它会如何执行，但是一旦你输入了查询，你可以告诉 SSMS 将输出发送到一个文本文件布里奇的回答。

# java - 交替法

> ID：12354566
> 
> 赞同：0
> 
> 时间：2012-09-10T15:12:48.467
> 
> 标签：java, methods

我有一个递归函数，它在其中调用一个方法。我希望能够在同一个测试方法中调用我的其他排序方法。我有 4 种其他方法（`mergeSort`例如）。我将如何循环通过方法调用，以便测试人员在一个方法（）上运行所有排序测试（所有不同大小的数组），`selectionSort`然后移动到下一个方法（`mergeSort`）并继续从头开始测试它`size = 100`和从那里继续？

```
public void testSorts(){

    for(int size = 100; size<=100000; size = size*10){
        String[] data;
        long start;
        long time;

        UI.println("\n\n======Selection Sort=======\n");

        data = createArray(size);
        //printData(data);
        start = System.currentTimeMillis();

        selectionSort(data);
        //             insertionSort(data);
        //             bubbleSort(data);
        //             mergeSort(data);
        //             quickSort(data);
        //             quickSort2(data);
        time =  System.currentTimeMillis() - start;

        UI.printf("Number of items:  %,d\n", data.length);
        UI.printf("Sorted correcetly: %b\n", testSorted(data));
        UI.printf("Time taken:       %.2f s\n", time/1000.0);

        UI.println("\n=======DONE=========\n");

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:16:35.760

简而言之：使用策略模式。

`Sorter`使用方法创建接口`sort`。

为每个排序方法创建类。

创建`Sorter[]`并旋转它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:15:47.233

创建一个*接口* `SortingAlgorithm`，它将有一个`sort(String[])`方法，并将由不同的类实现 - 每个算法一个。

现在，使用一个接受作为参数的方法 a`SortingAlgorithm`并调用`algorith.sort(data)`。
（例如，您可以拥有`public void testSorts(SortingAlgorithm algorithm)`将调用单个算法的方法，该算法作为参数传递）。

将调用相关算法。

# cuda - 共享内存带宽 Fermi vs Kepler GPU

> ID：12354573
> 
> 赞同：9
> 
> 时间：2012-09-10T15:13:12.613
> 
> 标签：cuda, gpu, gpgpu, nvidia

在访问共享内存时，Kepler 的带宽是 Fermi 的 2 倍还是 4 倍？

编程指南指出：“每个 bank 的带宽为每*两个时钟*周期 32 位”（对于 2.X），并且“每个 bank 的带宽为每*时钟*周期 64 位”（3.X），所以暗示 4x？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-10T16:50:48.817

在 Fermi 上，每个 SM 有 32 个存储体，每两个时钟周期提供 32 位。

在 Kepler 上，每个 SMX 有 32 个存储体，每个时钟周期提供 64 位。然而，由于 Kepler 的 SMX 从根本上重新设计为节能，并且由于运行快速时钟会消耗大量功率，因此 Kepler 使用慢得多的核心时钟运行。查看大约 8 分钟后来自 GTC 的[Inside Kepler](http://www.gputechconf.com/gtcnew/on-demand-gtc.php?searchByKeyword=s0642&submit=)演讲，了解更多信息。

所以这个问题的答案是开普勒有大约 2 倍，而不是 4 倍。

文档的下一版本（CUDA 5.0）应该更好地解释这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T16:50:29.140

如给出的

**编程指南 4.2：**共享内存有 16 个存储区，这些存储区被组织成连续的 32 位字映射到连续的存储区。每个存储体的带宽为每两个时钟周期 32 位。

**Kepler 白皮书：**与 Fermi SM 相比，64b 和更大负载操作的共享内存带宽也翻了一番，达到每个核心时钟 256B。

对于小负载操作，它是 4 倍。

# node.js - NodeJS 需要模块

> ID：12354574
> 
> 赞同：5
> 
> 时间：2012-09-10T15:13:18.510
> 
> 标签：node.js, node-modules

首先，关于 Node.js，我是一个全新的开发人员。

我已经开始创建一个示例 express 应用程序，并且我想使用一个附加模块来了解它的更多信息。我已经通过 npm 安装了“mysql”模块，一切正常。

我在 app.'s 的开头添加了它，如下所示：

```
var mysql = require('mysql'); 
```

现在，如您所知，express 在目录路由中创建了一个 index.js 文件：我希望能够访问 mysql 变量以从此 index.js 页面连接到数据库，但是，使用命令

```
var connection = mysql.createConnection({
    host     : 'localhost',
    user     : 'root',
    password : 'root',
}); 
```

显然不起作用，给出“500 ReferenceError：mysql is not defined”。

当然，我确定我需要传递这个变量，但我真的没有头绪，有没有好的灵魂可以启发我？我知道这是一件非常小而基本的事情，但我已经尝试过了，但似乎没有用：

```
... app.get('/', routes.index, mysql); ... 
```

在 index.js 上：

```
exports.index = function(req, res, mysql){ ... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T16:22:21.570

在 Node.js 中，您应该将`require`模块放在需要使用它们的文件中；因此，如果您想在文件中使用该`mysql`包，请`routes/index.js`在该文件的顶部执行

```
var mysql = require('mysql'); 
```

您最终可能需要在多个文件中使用一个模块；这是正常的，并且在很多方面都是一件好事（没有命名空间问题等）

如果您想了解更多关于模块和包的信息，您可能会对这两个截屏视频感兴趣：

*   模块： http: [//nodecasts.net/episodes/3-modules](http://nodecasts.net/episodes/3-modules)
*   包和 npm： http: [//nodecasts.net/episodes/4-packages-and-npm](http://nodecasts.net/episodes/4-packages-and-npm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T16:24:59.633

让`mysql`物体通过`app.get()`是正常的反应，但我很确定你想多了。

它就像包含`var mysql = require('mysql');`在顶部一样简单`routes/index.js`。`app.js`事实上，如果所有数据库交互都在您的路由中完成，您可能会发现甚至不需要 mysql in 。

# java - 嵌套 for() 循环 && 使用第二个循环中第一个循环的“i”计数，所以 i 只使用该值循环一次？

> ID：12354575
> 
> 赞同：-3
> 
> 时间：2012-09-10T15:13:19.657
> 
> 标签：java, math, for-loop, helper, factorial

我试图不导入要使用的数学类，但我仍在尝试估计常数“e”。据说 e= 1+(1/1!)+(1/2!)+(1/3!)+(1/4!)+(1/5!)+.....

这些是我在顶部的 int

> ```
> String userInput;
> int uIp; // this converts the string into int type 
> double e = 2; 
> ```

然后我问一些问题然后我检查看看不是零退出并且非负继续

> ```
> While(uIp >0){
>   final int endTheLoop = 15;
>   int factorialNumber = 1;
>   double e2TheUserInput=0;
> 
>   for(int i = 2; i < endTheLoop; i++){
>     for(int j = 1; j < i; j++){  
>       factorialNumber = ((i - 1) * factorialNumber);
>     }
>     e = (1/factorialNumber) + e;
>     e2TheUserInput = Math.pow(e,uIp);
>   }
> } 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:19:42.163

你正在做整数除法（但 e 是双倍的吗？）：

```
e = (1/factorialNumber) + e; 
```

更正为：

```
e = (1.0/(double)factorialNumber) + e; 
```

它正在计算所有循环，但根据整数除法变化为零。:)

e= 2+(0)+(0)+(0)+(0)+.....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:43:35.893

我不确定你的代码试图做什么，但如果你想计算 exp(x) 这就是我会做的。

```
public static void main(String... args) {
    for (int i = -4; i <= 4; i++)
        System.out.println(i + ": " + exp(i) + " cf " + Math.exp(i));
}

private static double exp(double d) {
    if (d < 0)
        return 1 / exp(-d);
    double e = 1, term = 1;
    for (int i = 1; i < 20 || term > e * 1e-16; i++) {
        term *= d / i;
        e += term;
    }
    return e;
} 
```

* * *

对于大指数，在不使用泰勒级数的情况下评估积分幂会更有效。

```
public static final double E = 2.7182818284590452354;

private static double exp(double d) {
    if (d < 0)
        return 1 / exp(-d);
    long num = (long) d;
    double numE = 1;
    double mult = E;
    while (num > 0) {
        if ((num & 1) != 0)
            numE *= mult;
        num >>>= 1;
        mult *= mult;
    }
    double fract = d - (long) d;
    double fractE = 1, term = 1;
    for (int i = 1; i < 20; i++) {
        term *= fract / i;
        fractE += term;
    }
    return numE * fractE;
} 
```

# php - 一个产品的多个 Magento 属性

> ID：12354578
> 
> 赞同：0
> 
> 时间：2012-09-10T15:13:29.407
> 
> 标签：php, database, magento, e-commerce

我的 Magento 商店中的每个产品都有用作过滤器的属性。我想知道是否可以为一个产品提供相同类型的多个属性，或者是否有扩展使之成为可能。

一个具体的例子是：我正在销售保险箱，我的产品需要根据它们可以容纳的对象类型进行过滤。例如，一个特定的保险箱可能设计用于存放现金、文件和贵重物品。我的问题是我目前正在使用产品管理下的常规设置，并且我只能为每个产品添加一个这样的属性。

基本上，按照我现在的做法，保险箱可以用来存放现金、文件或贵重物品，但不能同时存放这三者。我正在寻找扩展或编程方式来完成这项工作。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:24:25.657

嗨，Dean，您的问题已经解决了我的 Magento。您需要做的就是将“保留对象”属性的类型从“下拉”更改为“多选”。

坏消息是 - 您实际上无法直接在管理属性管理屏幕中更改属性类型（目录 -> 属性 -> 管理属性）。因此，您必须为“保留对象”创建新属性并选择属性类型“多选”。

# r - 从其他数据框的功能创建新的数据框

> ID：12354581
> 
> 赞同：0
> 
> 时间：2012-09-10T15:13:35.810
> 
> 标签：r

我是 R 的新手，我可能很难问我的问题。请多多包涵。

我有两个数据框。为了解释，我们假装：

**df1**

列代表收益类型：玉米、燕麦、小麦等。行代表一年中的月份、一月、二月等。元素代表在该特定月份购买的该收益类型的每吨价格。

**df2**

代表国家的列：西班牙、智利、墨西哥等。此框架的行代表与该国家打交道的额外成本，可能是：每个国家的包装成本、运输成本、国家进口税、检验费等。

现在我想构建第三个数据框：

**df3**

它表示所有国家/地区每月谷物组合的总成本（例如 10% 玉米、50% 燕麦……）以及相关的运输、税收等成本 假设有一个等式（使用来自 df1 和 df2 的数据）计算给定谷物组合每个国家每月的总成本以及每个国家的额外成本。

为简洁起见，让我们假设 3 月份总成本等式的一部分，而西班牙是

```
cost <- .10 * df1[ “mar”,”oats”]  + df2[“tax”,”Spain”]  + ..... 
```

选择第二个数据帧的元素并对第一个数据帧的列进行算术运算以获得结果对我来说是直截了当的。对于特定国家：

```
cost <- .10 * df1[ ,”oats”]  + df2[“tax”,”Spain”]  + ..... 
```

这给了我西班牙每个月的费用

问题是：我必须对每个国家重复相同的算术。

另一个版本：

```
 cost <- .10 * df1[ ,”oats”]  + df2[“tax”,]  + ..... 
```

给我每个国家/地区的费用，但仅适用于 1 月份

我想要一组方程式，它可以为我提供所有县每月的总成本。换句话说，`df3`行数与`df1`(months) 相同，列数与`df2`(countries) 相同。

编辑...粘贴在已关闭问题中发布的示例中：

```
# build df1 - cost of grains (with goofy data so I can track the arithemetic)
  v1 <- c(1:12)
  v2 <- c(13:24)
  v3 <- c(25:36)
  v4 <- c(37:48)
  grain <- data.frame("wheat"=v1,"oats"=v2,"corn"=v3,"rye"=v4)

  grain

# build df2 - additional costs (again, with goofy data to see what is being used where and when)
  w1 <- c(1.3:4.3)
  w2 <- c(5.3:8.3)
  w3 <- c(9.3:12.3)
  w4 <- c(13.3:16.3)
  cost <- data.frame("Spain"=w1,"Peru"=w2,"Mexico"=w3,"Kenya"=w4)
  row.names(cost) <- c("packing","shipping","tax","inspection")

  cost

# assume 10% wheat, 30% oats and 60% rye with some clown-equation for total cost
# now for my feeble attempt at getting a dataframe that has 12 rows (months) and 4 column (countries)

  total_cost <- data.frame( 0.1*grain[,"wheat"] +
                            0.3*grain[,"oats"] +
                            0.6*grain[,"rye"] +
                            cost["packing","Mexico"] +
                            cost["shipping","Mexico"] +
                            cost["tax","Mexico"]  +
                            cost["inspection","Mexico"] )
  total_cost 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:59:55.247

You have a couple of choices: one would be to use the `outer` function supplying inputs of the 'month' vector and the 'country' vector from the colnames of df2 and using a function that would pull the 'cost' components from df1 and df2\. (Could not get that approach to work.) You would get a 'month' x 'country' matrix. Another would be to transpose the df2 dataframe and merge using all=TRUE with df1 getting a "long" format dataframe from which you could do column operations with your formulas, and then reshape to a format that is "wide" in 'countries'. Details will depend on the specific data setup and you have not offered an example yet.

This will give you a 12 x 4 grid of combinations of months and countries:

```
 dfrm <- expand.grid(grain$months,  colnames(cost) ) 
```

This will give you a function that takes a month value and a country value and calculates the expression above:

```
 costcros <- function(x) { sum(grain[ grain[, 'months'] == x[1], c(1,2,4)]*c(0.1,0.3,0.6) ) + 
                           sum( cost[, x[2]]) } 
```

This adds the calculation to each row of dfrm:

```
 dfrm$crosscost <- apply(expand.grid(grain$months,  colnames(cost) ), 1,  costcros) 
```

# php - 将时间戳显示为 1 天前的 1d、43 秒的 43 秒等的 PHP 函数

> ID：12354584
> 
> 赞同：-5
> 
> 时间：2012-09-10T15:13:48.303
> 
> 标签：php, time

> **可能重复：**
> [PHP：从时间戳生成相对日期/时间](https://stackoverflow.com/questions/2690504/php-producing-relative-date-time-from-timestamps)

就像标题所说的那样，对于我的网站来说是完美的，并且在谷歌上看过但没有运气。有人知道我如何制作/找到一个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:18:54.820

谷歌（前 php）给了我这个：[http ://css-tricks.com/snippets/php/time-ago-function/](http://css-tricks.com/snippets/php/time-ago-function/)

对我来说看起来很简单但很可靠（未经测试）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:22:29.847

你可以通过一些基本的数学轻松地做到这一点。找出 time() 和您的时间戳之间的差异。一年为60 * 60 * 24 * 365；一个月是60 * 60 * 24 * 30；一天是 60 * 60 * 24；一小时是60 * 60；一分钟是60。

只需找出您有多少年，然后从总数中减去它们并将它们存储在一个变量中。

然后找出您有多少个月，并将它们从总数中减去并将它们存储在一个变量中。

然后找出你有多少天，从总数中减去它们并将它们存储在一个变量中。

然后找出你有多少小时，并将它们从总数中减去并将它们存储在一个变量中。

然后找出你有多少分钟，并将它们从总数中减去并将它们存储在一个变量中。

剩下的就是你有多少秒；将它们存储在一个变量中。

然后使用所有这些变量打印出所需的字符串，或者如果它在函数或类方法中，则只需返回该字符串（或者，更好的是，一个包含年、月、日、小时、分钟和秒的数组）。

# python - Python：与 winsound.Beep 最接近的 Linux 和 OSX 等价物是什么？

> ID：12354586
> 
> 赞同：30
> 
> 时间：2012-09-10T15:14:01.863
> 
> 标签：python, linux, macos, audio

如果想在 Windows 上发出提示音，Python 2 显然提供了一个有用的功能：`winsound.Beep()`. 这个函数的巧妙之处在于它接受参数来指定哔声的确切频率和持续时间。这正是我想要做的，除了我不使用 Windows。所以...

`winsound.Beep()`for`Linux`和的最接近的等价物是什么`OSX`，尽可能少地引入依赖项？

请注意，我希望能够直接对扬声器发出哔哔声，而不是播放声音文件。另外，我需要能够控制哔声的频率和持续时间，所以`curses.beep()`不`print '\a'`会这样做。最后，我知道它`PyGame`提供了广泛的声音功能，但鉴于我不需要 PyGame 的任何其他功能，这似乎就像使用大锤来破解坚果一样（无论如何，我正试图消除依赖项，因为尽可能）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-10T15:58:00.363

winsound 仅适用于 Windows，除了打印“/a”之外，我找不到任何跨平台方式来执行此操作。但是，您不能使用此设置频率和持续时间。

但是，您可以尝试使用 os.system 命令对系统命令[beep](http://www.chiark.greenend.org.uk/~sgtatham/utils/beep.html)执行相同的操作。这是一个片段，它以独立于平台的方式定义了函数 playsound

```
try:
    import winsound
except ImportError:
    import os
    def playsound(frequency,duration):
        #apt-get install beep
        os.system('beep -f %s -l %s' % (frequency,duration))
else:
    def playsound(frequency,duration):
        winsound.Beep(frequency,duration) 
```

有关更多信息，请查看[此博客](http://www.answermysearches.com/how-to-make-a-beep-sound-in-linux-and-a-fun-program-that-uses-it/295/)

编辑：您需要在 linux 上安装 beep 包才能运行 beep 命令。你可以通过给出命令来安装

```
sudo apt-get install beep 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-10T15:25:57.327

我在这里找到了一个潜在的解决方案：http: [//bytes.com/topic/python/answers/25217-beeping-under-linux](http://bytes.com/topic/python/answers/25217-beeping-under-linux)

它涉及直接写入/dev/audio。不确定它的便携性，或者它是否可以工作——我不在 Linux 机器 atm 上。

```
def beep(frequency, amplitude, duration):
    sample = 8000
    half_period = int(sample/frequency/2)
    beep = chr(amplitude)*half_period+chr(0)*half_period
    beep *= int(duration*frequency)
    audio = file('/dev/audio', 'wb')
    audio.write(beep)
    audio.close() 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-10-05T18:40:06.983

## 这适用于mac：

```
import numpy as np
import simpleaudio as sa

def sound(x,z):
 frequency = x # Our played note will be 440 Hz
 fs = 44100  # 44100 samples per second
 seconds = z  # Note duration of 3 seconds

 # Generate array with seconds*sample_rate steps, ranging between 0 and seconds
 t = np.linspace(0, seconds, seconds * fs, False)

 # Generate a 440 Hz sine wave
 note = np.sin(frequency * t * 2 * np.pi)

 # Ensure that highest value is in 16-bit range
 audio = note * (2**15 - 1) / np.max(np.abs(note))
 # Convert to 16-bit data
 audio = audio.astype(np.int16)

 # Start playback
 play_obj = sa.play_buffer(audio, 1, 2, fs)

 # Wait for playback to finish before exiting
 play_obj.wait_done()

sound(300,2)

sound(200,1) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-01T03:25:52.857

我能看到的最轻量级的跨平台层是“PortAudio”。例如，R 在他们的包中使用它来将特定于平台的驱动程序调用包装到数字化波形的简单播放/记录中作为数组。MIT 的优秀人员为此生成了 Python 绑定，但您需要包含已编译的 .dll/.so 才能使其工作。[http://people.csail.mit.edu/hubert/pyaudio/](http://people.csail.mit.edu/hubert/pyaudio/)

（ libao 与 Ogg/Vorbis 的制造商 Xiph 类似，存在包装 pyao 但这似乎不太广泛使用）

SoX 是一套优秀的跨平台工具，具有更多的格式转换和读取文件等功能。

使用 ctypes 从 Python 调用驱动程序是可行的，但非常混乱，即使是最简单的传统 WinMM。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-11T08:35:20.460

我找到了 3 种适用于 Linux 的方法：

*   使用 Linux evdev API 的新方法，适用于`input`组中的任何用户（[示例源代码](https://gist.github.com/zed/9af4ebc7136348721677a35d7fd8cc84)）
*   `fcntl`使用and的旧方法`/dev/console`（需要 root 权限）（[示例源代码](https://gist.github.com/shimarin/2358720)）
*   `beep`直接使用`subprocess`or调用命令`os.system`（速度较慢，必须安装在系统中）。

另请参阅[我的tone() 函数以及所有替代方法](http://eadmaster.altervista.org/pub/prj/cliapps/rtttl2beep.py)。

# java - 如何从卡片列表中生成所有唯一卡片对？

> ID：12354588
> 
> 赞同：0
> 
> 时间：2012-09-10T15:14:17.250
> 
> 标签：java, data-structures, poker

我正在实施一个手牌强度评估器，它是在处理一手牌和翻牌后评估剩余 47 张牌中所有可能的对子。

我已经实现了评估器，但我错过了所有可能的比较组合。我很想为 Hand 创建一个类，它由两张卡片组成，并将每个组合存储在一个集合 HashSet 中。我应该选择哪种数据结构？如果 HashSet 是最好的，那么我如何强制 Hand 的每个实例化都是唯一的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:24:30.667

`HashSet`似乎是合理的，尽管由于稍后订购可能很重要，您可能需要考虑使用`TreeSet`. 如果你实现了`equals`and `compareTo`/`Comparable`方法，`Hand`将`Set`强制唯一性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:22:32.297

我会给卡片编号或将它们放在列表中。

如果你使用列表，你可以做

```
Set<Card> inHand = ...
for(int i=0;i<list.size();i++) {
  Card card1 = list.get(i);
  if (inHand.contains(card1)) continue;

  for(int j=i+1;j<list.size();j++) {
      Card card2 = list.get(j);
      if (inHand.contains(card2)) continue;

      // process card1 and card2 
```

# excel - Excel VBA：正则表达式 - 获取文件名

> ID：12354592
> 
> 赞同：1
> 
> 时间：2012-09-10T15:14:32.633
> 
> 标签：excel, vba

如何 从以下完整路径中 获取
像“MyFileName”这样 的文件名（没有路径和扩展名）？ C:\A_B\CD\E_\F0123456789\G\MyFileName.txt

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:29:23.053

`InStrRev`将查找字符串中最后一次出现的字符。在那里搜索`\`并拆分它

```
FullFileName="C:\A_B\C.D\E_\F0123456789\G\MyFileName.txt"
FileName=mid(FullFileName,instrrev(FullFileName,"\")+1) 
```

现在取消扩展

```
FileNameWithoutExt=left(FileName,instrrev(FileName,".")-1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T15:30:52.517

```
Public Function GetFileNameWithoutExt(ByVal fullPath As String) As String
Dim fileName As String
Dim fileNameWithoutExt As String

Dim lastSlash As Integer
Dim positionOfDot As Integer

lastSlash = InStrRev(fullPath, "\")
fileName = Mid(fullPath, lastSlash + 1)

positionOfDot = InStr(1, fileName, ".")
fileNameWithoutExt = Mid(fileName, 1, positionOfDot - 1)

GetFileNameWithoutExt = fileNameWithoutExt
End Function 
```

使用即时窗口

```
?GetFileNameWithoutExt("C:\A_B\C.D\E_\F0123456789\G\MyFileName.txt") 
```

**编辑**：另一种方法

```
Public Function GetFileNameWithoutExt2(ByVal fullPath As String) As String
Dim fileName As String
Dim splittedData
Dim fileNameWithoutExt As String

splittedData = Split(fullPath, "\")
fileName = splittedData(UBound(splittedData))

fileNameWithoutExt = Split(fileName, ".")(0)

GetFileNameWithoutExt2 = fileNameWithoutExt
End Function 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T18:30:23.700

If it's a real file that you have access to, you can use Dir

```
sFileOnly = Dir(sPathAndFile) 
```

If it's not a real file or you don't have access to it, this will return an empty string.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T15:39:37.840

```
 Sub Test()
        Dim fileNameOnly As String
        fileNameOnly = Left$(Split("C:\A_B\C.D\E_\F0123456789\G\MyFileName.txt", "\")(UBound(Split("C:\A_B\C.D\E_\F0123456789\G\MyFileName.txt", "\"))), InStrRev(Split("C:\A_B\C.D\E_\F0123456789\G\MyFileName.txt", "\")(UBound(Split("C:\A_B\C.D\E_\F0123456789\G\MyFileName.txt", "\"))), ".") - 1)
        Debug.Print Strtf    
    End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-10T15:22:09.777

```
Set regEx = New RegExp
regEx.Pattern = ".*\\"
regEx.IgnoreCase = True
filename = regEx.Replace(fullpath, "") 
```

# php - PHP SoapClient 长请求字符串抛出“错误请求”异常

> ID：12354600
> 
> 赞同：0
> 
> 时间：2012-09-10T15:15:09.803
> 
> 标签：php, soap-client

所以我使用 PHP 的 SoapClient 通过 Web 服务导入订单数据。我们在 Windows Server 2008 上安装了 PHP 5.2，并且 Web 服务本身位于 .NET 环境中。

对于几乎任何订单，一切正常，但是非常大的订单可能有太多的订单项目，以至于我们发送的请求字符串很长。在这些情况下，请求失败，几乎没有有用的信息。

*   故障码是`"HTTP"`
*   故障串是`"Bad Request"`
*   故障信息是`null`。
*   为`__getLastResponse()`空。

这可能是由于 PHP 设置，而不是 SoapClient 中的错误。

# google-apps-script - Google 何时需要重新进行身份验证？

> ID：12354602
> 
> 赞同：1
> 
> 时间：2012-09-10T15:15:18.497
> 
> 标签：google-apps-script

我正在使用一个脚本，该脚本在用户提交表单时发送电子邮件。由于该脚本使用我的 Google 帐户发送电子邮件，因此我必须对其进行授权，这是有道理的。但是，我的脚本最终（看似）随机停止工作，需要重新验证。最近发生的事情发生在今天，我的一个脚本需要身份验证，即使它声明最后一次编辑发生在 4 天前。

基本上，我明白为什么我必须进行身份验证，但是是什么让我必须重新进行身份验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T07:35:13.400

使用 Gmail 等更敏感 API 的脚本将强制对每次代码更改进行重新验证。否则，除非您使用新的 api，或者如果您在过去只是阅读时开始写作（基本上，如果您做了超出先前授权范围的事情），否则您不需要重新授权。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T16:30:34.213

对脚本的更改将需要您重新授权。像在代码中添加空格这样简单的事情也算作更改。很多时候，这些都是无意的。

# activerecord - Ruby On Rails：在链接控制器中调用 Active Recode 方法 Save 时未定义，

> ID：12354606
> 
> 赞同：1
> 
> 时间：2012-09-10T15:15:36.703
> 
> 标签：activerecord, methods, ruby-on-rails-3.1, save, undefined

我正在开发一个 Ruby On Rails 应用程序，当我尝试从 Active Record 调用 Save 方法以填充到数据库的新链接时，出现以下错误。这是出错的代码，它在我的 LinksController 类的 Create 方法中：

```
def create
  @link = Link.new(params[:link])
  respond_to do |format|
    if @product.save
      format.html { render :action => "create" }
      format.json { render :json => @link }
    else
      format.html { render :action => "new" }
      format.json { render :json => @product.errors, :status => :unprocessable_entity }
    end
  end
end 
```

当我去

```
http://localhost:3000/links/new 
```

并尝试使用此表单创建一个新链接：

```
<%= form_for(@link) do |f| %>
<% if @link.errors.any? %>
  <div id="error_explanation">
    <h2><%= pluralize(@link.errors.count, "error") %> prohibited this link from being saved:</h2>
    <ul>
      <% @link.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<div class="field">
  <%= f.label :title %><br />
  <%= f.text_field :title %>
</div>
<div class="field">
  <%= f.label :url %><br />
  <%= f.text_field :url %>
</div>
<div class="actions">
  <%= f.submit %>
</div> 
```

并单击提交，我收到以下错误：

```
undefined method `save' for nil:NilClass 
```

我不知道发生了什么，所以如果有人有答案，甚至是指点，我将非常感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T16:34:38.233

```
 @link = Link.new(params[:link])
  respond_to do |format|
    if @product.save 
```

那么是`@product`从哪里来的呢？

# java - 在 MultiSpliPane 中安排新叶子的问题（使用 SSCCE）

> ID：12354608
> 
> 赞同：1
> 
> 时间：2012-09-10T15:15:41.720
> 
> 标签：java, swing, jtable, swingx, jxmultisplitpane

我正在创建一个应用程序，它将表格添加到表单并以特定布局排列它们。每次需要将新表添加到表单时，我都会在 MultiSplitPane 中创建一个新叶，并且我正在将新表添加到叶中。一切正常**，直到我移动一个分隔线，然后尝试在里面添加一个带有表格的新叶子**。

有谁知道是什么导致了这个混乱以及我该如何解决它？

这是您可以复制的有效 SSCCE：

```
import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.Event;
import java.awt.GraphicsConfiguration;
import java.awt.PopupMenu;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;
import org.jdesktop.swingx.MultiSplitLayout;
import org.jdesktop.swingx.MultiSplitPane;

/**
 * @author Igor
*/
public class Example extends javax.swing.JFrame {

/**
 * Creates new form Example
 */
@Override
public void add(Component cmpnt, Object o) {
    super.add(cmpnt, o);
}

@Override
public void add(PopupMenu pm) {
    super.add(pm);
}

@Override
public boolean action(Event event, Object o) {
    return super.action(event, o);
}

public Example(GraphicsConfiguration gc) {
    super(gc);
}

@Override
public Component add(Component cmpnt, int i) {
    return super.add(cmpnt, i);
}

@Override
public Component add(Component cmpnt) {
    return super.add(cmpnt);
}
// Initialize a MultiSplitPane
MultiSplitPane multiSplitPane = new MultiSplitPane();
int boxCount = 0;
String left = " (LEAF name=left0 weight=1)";
String right = "(LEAF name=right0 weight=0)";
String layoutDef = "(ROW" + left + " " + right + ")";
MultiSplitLayout.Node modelRoot = MultiSplitLayout.parseModel(layoutDef);

public Example() {
    initComponents();

    multiSplitPane.getMultiSplitLayout().setModel(modelRoot);
    setLayout(new BorderLayout());
    add(new JScrollPane(multiSplitPane), BorderLayout.CENTER);
    add(new JButton("Go") {
        {
            addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    Example.this.addNode();
                }
            });
        }
    }, BorderLayout.SOUTH);

    setDefaultCloseOperation(EXIT_ON_CLOSE);
    pack();

}
//a function that adds a new Leaf to the multiSplitPane
private void addNode() {

    if (boxCount == 1) {
        left = " (LEAF name=left0 weight=0.5)";
        right = " (LEAF name=right0 weight=0.5)";
    } else if (boxCount == 2) {
        left = "(COLUMN weight=0.5 left0 left" + new Integer(boxCount - 1).toString() + ")";
    } else if (boxCount == 3) {
        right = "(COLUMN weight=0.5 right0 right" + new Integer(boxCount - 2).toString() + ")";
    } else if ((boxCount % 2 == 0) && (boxCount != 0)) {
        left = left.substring(0, left.length() - 1);
        left += " left" + new Integer(boxCount / 2).toString() + ")";
    } else if ((boxCount % 2 != 0)) {
        right = right.substring(0, right.length() - 1);
        right += " right" + new Integer(boxCount / 2).toString() + ")";
    }
    String layoutDef = "(ROW " + left + " " + right + ")";
    MultiSplitLayout.Node modelRoot = MultiSplitLayout.parseModel(layoutDef);
    multiSplitPane.getMultiSplitLayout().setModel(modelRoot);

    JTable t = new JTable(1, 1);
    t.getColumnModel().getColumn(0).setHeaderValue("Box Title" + boxCount);
    Dimension dimension = new Dimension(190, 190);
    t.setPreferredScrollableViewportSize(dimension);
    t.setRowHeight(800);

    if (boxCount == 0) {
        multiSplitPane.add(new JScrollPane(t), "left0");
    } else if (boxCount == 1) {
        multiSplitPane.add(new JScrollPane(t), "right0");
    } else if (boxCount == 2) {
        multiSplitPane.add(new JScrollPane(t), "left1");
    } else if (boxCount == 3) {
        multiSplitPane.add(new JScrollPane(t), "right1");
    } else if (boxCount % 2 == 0) {
        multiSplitPane.add(new JScrollPane(t), "left" + new Integer(boxCount / 2).toString());
    } else if (boxCount % 2 != 0) {
        multiSplitPane.add(new JScrollPane(t), "right" + new Integer(boxCount / 2).toString());
    }

    multiSplitPane.revalidate();
    boxCount++;
}// End of AddNode *****************

/**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">
private void initComponents() {

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
    getContentPane().setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 400, Short.MAX_VALUE)
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 300, Short.MAX_VALUE)
    );

    pack();
}// </editor-fold>

/**
 * @param args the command line arguments
 */
public static void main(String args[]) {
    /* Set the Nimbus look and feel */
    //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
    /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
     * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
     */
    try {
        for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
            if ("Nimbus".equals(info.getName())) {
                javax.swing.UIManager.setLookAndFeel(info.getClassName());
                break;
            }
        }
    } catch (ClassNotFoundException ex) {
        java.util.logging.Logger.getLogger(Example.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (InstantiationException ex) {
        java.util.logging.Logger.getLogger(Example.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (IllegalAccessException ex) {
        java.util.logging.Logger.getLogger(Example.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        java.util.logging.Logger.getLogger(Example.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    }
    //</editor-fold>

    /* Create and display the form */
    java.awt.EventQueue.invokeLater(new Runnable() {
        public void run() {
            new Example().setVisible(true);
        }
    });
}
// Variables declaration - do not modify
// End of variables declaration
} 
```

PS 运行应用程序时增加窗口大小（或最大化）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T09:10:53.517

SwingX 与 Swing 不同。Swing（javax.swing 包）是 Java 的一部分，SwingX（org.jdesktop.swingx 包）是一个提供附加组件的开源库。

根据你的进口

```
import org.jdesktop.swingx.MultiSplitPane; 
```

您正在尝试使用 SwingX。最近的版本没有 org.jdesktop.swingx.MultiSplitPane，它们有 JXMultiSplitPane。检查您的 SwingX 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T15:58:24.550

我认为 multiSplitPane.setFloatingDividers(false) 解决了这个问题。

# javascript - 当 jqgrid 中的可排序选项设置为 true 时，如何维护过滤器行？

> ID：12354612
> 
> 赞同：1
> 
> 时间：2012-09-10T15:15:53.950
> 
> 标签：javascript, jquery, jquery-ui, jqgrid

我使用 JQgrid 并将可排序选项设置为 true 并过滤工具栏。问题是当我更改列顺序时，过滤器工具栏保持原始位置。

例子：

我有 2 列：ID、名称

我改变了地方，你得到了名字，身份证。

当我按名称过滤时，e 参数具有 ID="john"

我使用 jqgrid 4.4.0。

我从 UI 中用鼠标更改列顺序。

jqgrid代码：

```
 grilla.jqGrid({
    datatype: function (e) {
        dataTypeGrillaEnServerConSort(grilla, actualizarDatos, e, getDatos, !primeraCarga);
    },
    rowNum: Math.max,
    colNames: ['id', 'Apellido Y Nombre', 'Mail', 'Documento', 'Edad', 'Foto'],
    colModel: [
                    { name: 'id', index: 'id', align: 'right', hidden: true },
                    { name: 'nombre', index: 'nombre', width: 60, align: 'left', sorttype: 'text' },
                    { name: 'mail', index: 'mail', width: 60, align: 'left', sorttype: 'text' },
                    { name: 'documento', index: 'documento', width: 10, align: 'left', sorttype: 'text' },
                    { name: 'edad', index: 'edad', width: 10, align: 'right', sorttype: 'number' },
                    { name: 'foto', index: 'foto', width: 30, align: 'left', sorttype: 'number', formatter: eliminarFormatter }
                ],
    sortname: 'nombre',
    sortorder: "asc",
    sortable: true,
    caption: "Personas",
    emptyrecords: "No hay ninguna persona cargada.",
    loadtext: "Cargando...",
    autowidth: false,
    height: 300,
    cellsubmit: 'clientArray',
    width: 1200,
    pager: "#pager",
    rowNum: CANTIDADDEFILASPORPAGINA,
    viewrecords: true,
    gridComplete: function () {
        //mostrar la barra de filtros
        grilla.filterToolbar();
        grilla.find("img").error(function () {
            $(this).attr('src', pathFotoNoEncontrada);
        });
    }
}); 
```

# java - 如何在 JSP 中包含 JFreeChart servlet 图像

> ID：12354614
> 
> 赞同：2
> 
> 时间：2012-09-10T15:16:00.360
> 
> 标签：java, jsp, servlets, jfreechart

我已经看到了几个使用 Servlet 使用 JFreeChart 动态生成图表的示例，然后使用 img 标记将该图像包含在 JSP 中。例如：

```
<img src="/MyChartServlet" width="400" height="300" border="0" alt="" /> 
```

我的 servlet 使用 JFreeChart 生成图像效果很好，如果我直接在浏览器中调用它，我可以看到图像，如下所示：

```
http:/myurl/MyChartServlet?id=274 
```

问题是我的 JSP 不显示图像。事实上，JSP 甚至没有调用 servlet。我知道这一点，因为我没有看到调用 servlet 时出现的日志中的调试条目。

在 Servlet 中我使用 JFreeChart`ChartUtilities.writeChartAsJPEG()`方法将图像写入响应的输出流，因为我不想将图像写入磁盘。如前所述，servlet 在直接调用时可以正常工作。

我错过了什么？还是有更好的方法来做到这一点？也许一个普通的旧对象可以生成图表，我可以将它包含在 JSP 中？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:30:08.787

你正在以正确的方式去做。从您所处的上下文中，您可能遇到某种相对路径问题。尝试

```
<img src="http://<full path to your servlet>" ... 
```

此外，您的示例中有一个 ?id=274 ，但在您的 img src 中没有。如果需要，也将其放在那里。

如果您发布了您的 servlet 代码，这可能会有所帮助，但也要确保您在 servlet 中正确设置了内容类型

```
response.setContentType("image/jpeg"); 
```

# wix - 在 wix 安装程序中自动更新版本信息

> ID：12354617
> 
> 赞同：4
> 
> 时间：2012-09-10T15:16:08.597
> 
> 标签：wix, installation, windows-installer, version

嗨，我有一个 C/C++ 头文件，其中包含我的产品版本信息 init，如下所示：

```
#define nMajorVersion 4
#define nMinorVersion 4
#define nPointVersion 8
#define nBuildVersion 33
#define s_szFileVersion "4.4.8.33"
#define s_szProductVersion "4.4.8.33" 
```

有什么方法可以自动从此文件中读取以更新我的 wix 3.6 安装程序中的版本号？目前我已经对其进行了硬编码，这对于它发布时并不理想。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T11:01:57.483

您可以做的是创建 ac/c++ 程序，该程序会生成一个`Version.wxi`如下所示的文件：

```
<?xml version="1.0" encoding="utf-8"?>
<Include>
  <?define ProductVersion.Major="4"?>
  <?define ProductVersion.Minor="4"?>
  <?define ProductVersion.Revision="8"?>
  <?define ProductVersion.Build="33"?>
  <?define ProductVersion="4.4.8.33"?>
  ....
</Include> 
```

然后您可以在主 wxs 文件中包含并使用这些版本号：

```
<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <?include Version.wxi ?>
  <?define UpgradeCode="GUID"?>
  <Product Id="*" 
        Name="$(var.ProductName) $(var.ProductVersion.Major).$(var.ProductVersion.Minor)" 
        Version="$(var.ProductVersion)" Language="1033" 
        Manufacturer="$(var.Company)" UpgradeCode="$(var.UpgradeCode)"> 
```

在编译 wix 项目之前生成 Version.wxi。例如，修改 .wixproj 文件以添加执行此操作的目标。

# html - 向蜘蛛隐藏页面内容的最佳方法是什么？

> ID：12354618
> 
> 赞同：1
> 
> 时间：2012-09-10T15:16:08.383
> 
> 标签：html, search-engine, seo

我的网站上有大量页面，每个页面都有独特的内容，而且围绕该内容的侧边栏通常是多余的。我担心这个侧边栏内容会通过稀释结果来拖累我在 Google、Bind 等中的网站。我能做些什么来有效地向网络蜘蛛隐藏这些内容，而不是我的用户？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:19:38.767

您可以做的一件事是不将其包含在页面标记中，并在页面加载后使用 AJAX 将其加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:25:22.133

侧边栏不会影响您的 SEO 工作，因为它不是重复的内容。站点导航应该出现在每个页面上（这显然很常见）。从搜索引擎的角度来看，重复内容是指页面的主要内容与另一个页面的内容相同或几乎相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-06T02:45:11.183

这只是我的一种姿态，但谷歌足够聪明，可以找出导航元素在哪里以及内容在哪里。
但是，您的网站失去职位可能有多种原因。我将从阅读此[帮助提示](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=35291)开始，还请记住，Google 搜索结果是动态的，一旦您到达第一位置并不能保证您会留在那里，有人可能只是提供与当前主题匹配的更多独特内容，他会被推送向上。

如果您想确保搜索引擎了解您的文档结构，并指出什么是使用[微数据](http://schema.org/docs/documents.html)标记。

例如，您可以按以下格式包装导航：

```
<ul itemscope itemtype="http://schema.org/SiteNavigationElement">
    <li>
        <a href="index.html" title="Homepage">Home</a>
    </li>
    ...
</ul> 
```

之后，您的导航项将出现在：
**Google 网站管理员工具 > 优化 > 结构化数据**

此外，使用 AJAX/JavaScript 隐藏您的内容更有可能伤害已禁用 JavaScript 或由于您的库中可能存在错误的访问者，[事实上](http://googlewebmastercentral.blogspot.co.uk/2011/11/get-post-and-safely-surfacing-more-of.html)Google 可以理解和索引异步请求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T12:04:06.397

更好的解决方案是将您的内容移至页面顶部，将导航代码移至底部。用 CSS 重新定位东西。

否则，Ajax 或将文本放入图像中。

# visual-studio-2010 - 如何更改 VS.NET 项目中的 Resgen 命令行？

> ID：12354625
> 
> 赞同：1
> 
> 时间：2012-09-10T15:16:18.980
> 
> 标签：visual-studio-2010, msbuild, tracker, resgen

在 Visual Studio .NET 2010 中构建 .NET 2.0 项目期间， [ResGen](http://msdn.microsoft.com/en-us/library/ccec7sz1%28v=vs.80%29.aspx)调用出现问题，[该线程](http://social.msdn.microsoft.com/Forums/en/msbuild/thread/e5900710-9849-4d10-aa28-48b734d06bf2)建议：

> 将此添加到您的 MSBUILD 命令行： `/p:ResGenExecuteAsTool=true;ResGenToolArchitecture=ManagedIL;ResGenTrackerSdkPath="%programfiles(x86)%\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools\x64"`

我已经搜索了几个小时，但没有成功，试图从我的 Visual Studio .NET 项目中找到一种方法来做到这一点。

**因此我的问题是：**

如何在 Visual Studio 2010 中更改 .NET 2.0（类库）项目的 MSBUILD 命令行？

我不担心更改我的“.csproj”文件，如果可能的话，我*不*希望更改 Visual Studio 附带的 MSBuild 文件。

**更新和解决方案：**

感谢 Oded 的[评论](https://stackoverflow.com/questions/12354625/how-to-change-the-resgen-command-line-in-a-vs-net-project#comment16590033_12354625)和[回答](https://stackoverflow.com/a/12354819/107625)，我添加了以下两行：

```
<ResGenTrackerSdkPath>%programfiles(x86)%\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools\x64</ResGenTrackerSdkPath>
<TrackFileAccess>false</TrackFileAccess> 
```

就在我的“.csproj”文件的第一`<PropertyGroup>`部分（即第 3 行之后）。这使得文件编译成功！

我现在检查它是否也成功*运行*。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:28:40.740

与 MSBuild 中的所有属性一样，您可以通过命令行传入的内容可以改为以 XML 元素的形式添加到项目文件中。

例如：

```
<ResGenTrackerSdkPath>%programfiles(x86)%\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools\x64</ResGenTrackerSdkPath> 
```

和：

```
<ResGenExecuteAsTool>true</ResGenExecuteAsTool> 
```

ETC...

# wpf - 在 wpf 中使用 convertback 时，复选框列无法保持其选中状态

> ID：12354626
> 
> 赞同：0
> 
> 时间：2012-09-10T15:16:21.540
> 
> 标签：wpf, user-controls, wpf-controls, wpfdatagrid

我有一个数据网格，我正在以编程方式向其中添加一个复选框列。在此列中，我有一个需要绑定的枚举，但由于 checkboxcolumn 将仅采用 bool 值，因此我正在使用转换器。当我的目标复选框更改时，我还需要更新我的源。虽然当我选中复选框时我的代码正在更新我的源代码，但是一旦我失去焦点，选中的（勾号）就会消失。如何使复选框的检查保持不变？

我尝试了其他`UpdateSourceTrigger`值，但它不起作用。

以下是复选框列的代码

```
 Binding binding = new Binding("GridCRUDStatus") { Converter = new CheckBoxColConverter(), Mode = BindingMode.TwoWay, UpdateSourceTrigger = UpdateSourceTrigger.Explicit };
        DataGridCheckBoxColumn chkCol = new DataGridCheckBoxColumn() { Header = "Select", Binding = binding }; 
```

转换器类

```
internal class CheckBoxColConverter : IValueConverter
{
    #region IValueConverter Members

    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        GridCRUDStatus status;
        if (Enum.TryParse<GridCRUDStatus>(value.ToString(), out status))
        {
            if (status == GridCRUDStatus.Selected)
                return true;
        }

        return false;
        //throw new NotImplementedException();
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        bool chkValue;
        if (Boolean.TryParse(value.ToString(), out chkValue))
        {
            if (chkValue)
                return GridCRUDStatus.Delete;
        }
        return GridCRUDStatus.Read;

        //return null;
    }

    #endregion
} 
```

我尝试在网上搜索但无法找到解决方案。如果您需要我提供的任何进一步信息，请告诉我。

请帮忙！提前致谢。

问候，

萨马尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T06:36:33.260

我得到了我的问题的解决方案。在“Convert”方法中，我检查是否选择了 GridCRUDStatus，然后返回 true，在“ConvertBack”方法中，我正在检查值是否为 true，然后返回 GridCRUDStatus.Delete，这是再次调用“Convert”方法并再次返回 false，这是取消选中复选框。

问候，

达瓦尔小号

# python - 使用 opencv-2.4.2 安装 pyopencv 2.1.0 时遇到错误

> ID：12354628
> 
> 赞同：1
> 
> 时间：2012-09-10T15:16:27.817
> 
> 标签：python, opencv

我在使用 opencv-2.4.2 安装 pyopencv 2.1.0 时遇到了一些错误，我的 python 版本是 2.7.3，我的操作系统是 OS X Mountain Lion，

过程信息如下，我发现一些错误表明'Mat'类被重新定义，但我不知道如何修复它，有没有朋友可以帮助我？感谢！

```
sudo python setup.py install
running install
running bdist_egg
running egg_info
writing requirements to package/pyopencv.egg-info/requires.txt
writing package/pyopencv.egg-info/PKG-INFO
writing top-level names to package/pyopencv.egg-info/top_level.txt
writing dependency_links to package/pyopencv.egg-info/dependency_links.txt
reading manifest file 'package/pyopencv.egg-info/SOURCES.txt'
writing manifest file 'package/pyopencv.egg-info/SOURCES.txt'
installing library code to build/bdist.macosx-10.8-x86_64/egg
running install_lib
running build_py
creating build/lib.macosx-10.8-x86_64-2.7
creating build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/__init__.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/common.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/config.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/cv_h.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/cv_hpp.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/cvaux.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/cvtypes_h.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/cvver_h.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/cxcore_h.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/cxcore_hpp.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/cxcore_hpp_point.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/cxcore_hpp_vec.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/cxerror_h.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/cxtypes_h.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/highgui.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/info.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/interfaces.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/ml.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
copying package/pyopencv/sdopencv.py -> build/lib.macosx-10.8-x86_64-2.7/pyopencv
running build_ext
building 'pyopencv.pyopencv_extras' extension
creating build/temp.macosx-10.8-x86_64-2.7
creating build/temp.macosx-10.8-x86_64-2.7/package
creating build/temp.macosx-10.8-x86_64-2.7/package/extras
creating build/temp.macosx-10.8-x86_64-2.7/package/extras/core
creating build/temp.macosx-10.8-x86_64-2.7/package/extras/sdopencv
/usr/bin/clang -fno-strict-aliasing -fno-common -dynamic -pipe -O2 -fwrapv -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -dynamiclib -I/System/Library/Frameworks/Python.framework/Headers -I/opt/local/include -I/opt/local/include/opencv -I/opt/local/include -I~/Downloads/pyopencv-2.1.0.wr1.2.0/package -I~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras -I~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core -I~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv -I/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/numpy/core/include/numpy -I/opt/local/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c package/extras/core/ndarray.cpp -o build/temp.macosx-10.8-x86_64-2.7/package/extras/core/ndarray.o -O3 -DNDEBUG
clang: warning: argument unused during compilation: '-dynamiclib'
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:58:13: error: 
      redefinition of 'Mat'
inline Mat::Mat()
            ^
/opt/local/include/opencv2/core/mat.hpp:67:13: note: previous definition is here
inline Mat::Mat() : size(&rows)
            ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:59:35: warning: 
      field 'step' will be initialized after field 'data' [-Wreorder]
    : flags(0), rows(0), cols(0), step(0), data(0), refcount(0), ...
                                  ^
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:58:13: error: 
      constructor for 'cv::Mat' must explicitly initialize the member 'size'
      which does not have a default constructor
inline Mat::Mat()
            ^
/opt/local/include/opencv2/core/core.hpp:1961:11: note: member is declared here
    MSize size;
          ^
/opt/local/include/opencv2/core/core.hpp:1933:23: note: 'cv::Mat::MSize'
      declared here
    struct CV_EXPORTS MSize
                      ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:61:13: error: 
      redefinition of 'Mat'
inline Mat::Mat(int _rows, int _cols, int _type)
            ^
/opt/local/include/opencv2/core/mat.hpp:72:13: note: previous definition is here
inline Mat::Mat(int _rows, int _cols, int _type) : size(&rows)
            ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:62:35: warning: 
      field 'step' will be initialized after field 'data' [-Wreorder]
    : flags(0), rows(0), cols(0), step(0), data(0), refcount(0), ...
                                  ^
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:61:13: error: 
      constructor for 'cv::Mat' must explicitly initialize the member 'size'
      which does not have a default constructor
inline Mat::Mat(int _rows, int _cols, int _type)
            ^
/opt/local/include/opencv2/core/core.hpp:1961:11: note: member is declared here
    MSize size;
          ^
/opt/local/include/opencv2/core/core.hpp:1933:23: note: 'cv::Mat::MSize'
      declared here
    struct CV_EXPORTS MSize
                      ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:68:13: error: 
      redefinition of 'Mat'
inline Mat::Mat(int _rows, int _cols, int _type, const Scalar& _s)
            ^
/opt/local/include/opencv2/core/mat.hpp:78:13: note: previous definition is here
inline Mat::Mat(int _rows, int _cols, int _type, const Scalar& _s) : size(&rows)
            ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:69:35: warning: 
      field 'step' will be initialized after field 'data' [-Wreorder]
    : flags(0), rows(0), cols(0), step(0), data(0), refcount(0),
                                  ^
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:68:13: error: 
      constructor for 'cv::Mat' must explicitly initialize the member 'size'
      which does not have a default constructor
inline Mat::Mat(int _rows, int _cols, int _type, const Scalar& _s)
            ^
/opt/local/include/opencv2/core/core.hpp:1961:11: note: member is declared here
    MSize size;
          ^
/opt/local/include/opencv2/core/core.hpp:1933:23: note: 'cv::Mat::MSize'
      declared here
    struct CV_EXPORTS MSize
                      ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:79:13: error: 
      redefinition of 'Mat'
inline Mat::Mat(Size _size, int _type)
            ^
/opt/local/include/opencv2/core/mat.hpp:85:13: note: previous definition is here
inline Mat::Mat(Size _sz, int _type) : size(&rows)
            ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:80:35: warning: 
      field 'step' will be initialized after field 'data' [-Wreorder]
    : flags(0), rows(0), cols(0), step(0), data(0), refcount(0),
                                  ^
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:79:13: error: 
      constructor for 'cv::Mat' must explicitly initialize the member 'size'
      which does not have a default constructor
inline Mat::Mat(Size _size, int _type)
            ^
/opt/local/include/opencv2/core/core.hpp:1961:11: note: member is declared here
    MSize size;
          ^
/opt/local/include/opencv2/core/core.hpp:1933:23: note: 'cv::Mat::MSize'
      declared here
    struct CV_EXPORTS MSize
                      ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:87:13: error: 
      redefinition of 'Mat'
inline Mat::Mat(Size _size, int _type, const Scalar& _s)
            ^
/opt/local/include/opencv2/core/mat.hpp:91:13: note: previous definition is here
inline Mat::Mat(Size _sz, int _type, const Scalar& _s) : size(&rows)
            ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:88:31: warning: 
      field 'step' will be initialized after field 'data' [-Wreorder]
: flags(0), rows(0), cols(0), step(0), data(0), refcount(0),
                              ^
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:87:13: error: 
      constructor for 'cv::Mat' must explicitly initialize the member 'size'
      which does not have a default constructor
inline Mat::Mat(Size _size, int _type, const Scalar& _s)
            ^
/opt/local/include/opencv2/core/core.hpp:1961:11: note: member is declared here
    MSize size;
          ^
/opt/local/include/opencv2/core/core.hpp:1933:23: note: 'cv::Mat::MSize'
      declared here
    struct CV_EXPORTS MSize
                      ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:98:13: error: 
      redefinition of 'Mat'
inline Mat::Mat(const Mat& m)
            ^
/opt/local/include/opencv2/core/mat.hpp:111:13: note: previous definition is
      here
inline Mat::Mat(const Mat& m)
            ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:99:51: warning: 
      field 'step' will be initialized after field 'data' [-Wreorder]
    : flags(m.flags), rows(m.rows), cols(m.cols), step(m.step), data(m.data),
                                                  ^
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:98:13: error: 
      constructor for 'cv::Mat' must explicitly initialize the member 'size'
      which does not have a default constructor
inline Mat::Mat(const Mat& m)
            ^
/opt/local/include/opencv2/core/core.hpp:1961:11: note: member is declared here
    MSize size;
          ^
/opt/local/include/opencv2/core/core.hpp:1933:23: note: 'cv::Mat::MSize'
      declared here
    struct CV_EXPORTS MSize
                      ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:106:13: error: 
      redefinition of 'Mat'
inline Mat::Mat(int _rows, int _cols, int _type, void* _data, size_t _step)
            ^
/opt/local/include/opencv2/core/mat.hpp:129:13: note: previous definition is
      here
inline Mat::Mat(int _rows, int _cols, int _type, void* _data, size_t _step)
            ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:108:5: warning: 
      field 'step' will be initialized after field 'data' [-Wreorder]
    step(_step), data((uchar*)_data), refcount(0),
    ^
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:106:13: error: 
      constructor for 'cv::Mat' must explicitly initialize the member 'size'
      which does not have a default constructor
inline Mat::Mat(int _rows, int _cols, int _type, void* _data, size_t _step)
            ^
/opt/local/include/opencv2/core/core.hpp:1961:11: note: member is declared here
    MSize size;
          ^
/opt/local/include/opencv2/core/core.hpp:1933:23: note: 'cv::Mat::MSize'
      declared here
    struct CV_EXPORTS MSize
                      ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:126:13: error: 
      redefinition of 'Mat'
inline Mat::Mat(Size _size, int _type, void* _data, size_t _step)
            ^
/opt/local/include/opencv2/core/mat.hpp:151:13: note: previous definition is
      here
inline Mat::Mat(Size _sz, int _type, void* _data, size_t _step)
            ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:128:5: warning: 
      field 'step' will be initialized after field 'data' [-Wreorder]
    step(_step), data((uchar*)_data), refcount(0),
    ^
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:126:13: error: 
      constructor for 'cv::Mat' must explicitly initialize the member 'size'
      which does not have a default constructor
inline Mat::Mat(Size _size, int _type, void* _data, size_t _step)
            ^
/opt/local/include/opencv2/core/core.hpp:1961:11: note: member is declared here
    MSize size;
          ^
/opt/local/include/opencv2/core/core.hpp:1933:23: note: 'cv::Mat::MSize'
      declared here
    struct CV_EXPORTS MSize
                      ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:146:13: error: 
      constructor for 'cv::Mat' must explicitly initialize the member 'size'
      which does not have a default constructor
inline Mat::Mat(const Mat& m, const Range& rowRange, const Range& colRange)
            ^
/opt/local/include/opencv2/core/core.hpp:1961:11: note: member is declared here
    MSize size;
          ^
/opt/local/include/opencv2/core/core.hpp:1933:23: note: 'cv::Mat::MSize'
      declared here
    struct CV_EXPORTS MSize
                      ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:149:10: error: 
      'operator=' is a protected member of 'cv::Mat::MStep'
    step = m.step; refcount = m.refcount;
    ~~~~ ^ ~~~~~~
/opt/local/include/opencv2/core/core.hpp:1958:16: note: declared protected here
        MStep& operator = (const MStep&);
               ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:182:5: warning: 
      field 'step' will be initialized after field 'data' [-Wreorder]
    step(m.step), data(m.data + roi.y*step), refcount(m.refcount),
    ^
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:180:13: error: 
      constructor for 'cv::Mat' must explicitly initialize the member 'size'
      which does not have a default constructor
inline Mat::Mat(const Mat& m, const Rect& roi)
            ^
/opt/local/include/opencv2/core/core.hpp:1961:11: note: member is declared here
    MSize size;
          ^
/opt/local/include/opencv2/core/core.hpp:1933:23: note: 'cv::Mat::MSize'
      declared here
    struct CV_EXPORTS MSize
                      ^
In file included from package/extras/core/ndarray.cpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/ndarray.hpp:18:
In file included from ~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/core/opencv_headers.hpp:9:
~/Downloads/pyopencv-2.1.0.wr1.2.0/package/extras/sdopencv/sdcxmat.hpp:197:35: warning: 
      field 'step' will be initialized after field 'data' [-Wreorder]
    rows(m->rows), cols(m->cols), step(m->step), data(m->data.ptr), refcount(0),
                                  ^
fatal error: too many errors emitted, stopping now [-ferror-limit=]
10 warnings and 20 errors generated.
error: command '/usr/bin/clang' failed with exit status 1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T14:10:22.257

根据 pyopencv 的第 47 期，OpenCV 2.3.1 或更高版本似乎与它不兼容。

[http://code.google.com/p/pyopencv/issues/detail?id=47](http://code.google.com/p/pyopencv/issues/detail?id=47)

考虑尝试 cv2.so 而不是 pyopencv。

它在我的 Mountain Lion 上运行良好。请务必制作本说明中描述的一些符号链接。

[https://github.com/ingenuitas/SimpleCV#installation](https://github.com/ingenuitas/SimpleCV#installation)

玩得开心！

# php - PHP BBCode 解析 youtube 网址

> ID：12354635
> 
> 赞同：1
> 
> 时间：2012-09-10T15:16:54.287
> 
> 标签：php, regex, bbcode

我已经研究了这个问题将近 5 个小时，我能想到的最好的就是 Stackoverflow 帖子中的这段代码：

```
<?php
$pattren = '%(?:youtube(?:-nocookie)?\.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu\.be/)([^"&?/]{11})%i';
?> 
```

我想要完成的是我有一个由其他人编写的定制网络论坛，我想添加直接在论坛主题中观看 YouTube 视频的能力，我尝试了不同的代码和模式，最好的一个是我发布的那个在这篇文章中，它几乎可以匹配任何 YouTube 链接，但是我无法用这段代码解决一个问题，论坛中使用的 BBCode 标签是`[yt]youtubelink[/yt]`，我尝试在模式前加上

```
<?php
$pattren = '%\[yt\](?:youtube(?:-nocookie)?\.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu\.be/)([^"&?/]{11})[\/yt]%i';
?> 
```

但它只是不起作用，没有任何错误报告表明模式存在问题

我使用的完整代码

```
<?php

$testmessage = "test youtube links [yt]http://www.youtube.com/watch?v=ZCLAwp2HbW4&feature=player_embedded[/yt] more text";
$pattren1    = '%(?:youtube(?:-nocookie)?\.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu\.be/)([^"&?/ ]{11})%i';
$pattren2    = '%\[yt\](?:youtube(?:-nocookie)?\.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu\.be/)([^"&?/ ]{11})[\/yt]%i';

echo '<h1>works:-</h1>';
echo preg_replace($pattren1, '<iframe width="350" height="250" sandbox="" src="http://www.youtube.com/embed/$1" frameborder="0" allowfullscreen></iframe>', $testmessage);
echo '<h1>doesnt work:-</h1>';
echo preg_replace($pattren2, '<iframe width="350" height="250" sandbox="" src="http://www.youtube.com/embed/$1" frameborder="0" allowfullscreen></iframe>', $testmessage);
?> 
```

同样，虽然第一个模式部分有效，但它也会留下一些 URL 查询字符串，例如第一个模式在它确实有效并获取视频 ID 时，它将这部分留在文本消息中`&feature=player_embedded`

**更新：**

我无法让它直接使用 preg_replace，所以我想出了不同的方法来解决这个问题，我会发布代码，它可能对某人有用，这样他就不会浪费 6 小时的生命又是这个问题！

```
<?php
$test = "test youtube links [yt]http://www.youtube.com/watch?v=ZCLAwp2HbW4&feature=player_embedded[/yt] more text";
echo preg_replace_callback('#\[yt\](.*)\[/yt\]#i', function ($matches) {
    $regex = '#(?:youtube(?:-nocookie)?\.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu\.be/)([^"&?/ ]{11})#i';
        preg_match($regex, $matches[1], $found);
        if ($found[1])
            return '<iframe width="350" height="250" sandbox="" src="http://www.youtube.com/embed/'.$found[1].'" frameborder="0" allowfullscreen></iframe>';

}, $test);
?> 
```

此代码适用于 PHP 5.3 以使其适用于 < PHP5.3 将匿名函数移动到单独的函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T22:10:31.773

如果这真的是解决方案，你会打自己的耳光！你错过了最后方括号的转义：`[/yt]`应该是`\[/yt\]`

# java - 使用Java从日志中提取特定模式

> ID：12354642
> 
> 赞同：0
> 
> 时间：2012-09-10T15:17:33.370
> 
> 标签：java, extract, file-read

我想从日志文件中提取一条信息。我使用的模式是节点名和命令的提示。我想提取命令输出的信息并进行比较。考虑如下示例输出

```
 NodeName > command1

    this is the sample output 

    NodeName > command2  

    this is the sample output 
```

我已经尝试了以下代码。

```
public static void searchcommand( String strLineString) 
    {

             String searchFor = "Nodename> command1";
             String endStr = "Nodename";
             String op="";
             int end=0;
              int len = searchFor.length();
              int result = 0;
              if (len > 0) {  
              int start = strLineString.indexOf(searchFor);
              while(start!=-1){
      end = strLineString.indexOf(endStr,start+len);

              if(end!=-1){
                  op=strLineString.substring(start, end);

              }else{
                  op=strLineString.substring(start, strLineString.length());
              }
              String[] arr = op.split("%%%%%%%"); 
              for (String z : arr) {
                  System.out.println(z);
                }

                  start = strLineString.indexOf(searchFor,start+len);

              }

              }

    } 
```

问题是代码太慢而无法提取数据。还有其他方法吗？

编辑 1 它是我在上面的代码中作为字符串读取的日志文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T16:18:10.163

这是我的建议：

使用正则表达式。这是一个：

```
 final String input = "    NodeName > command1\n" +
            "\n" +
            "    this is the sample output1 \n" +
            "\n" +
            "    NodeName > command2  \n" +
            "\n" +
            "    this is the sample output2";

    final String regex = ".*?NodeName > command(\\d)(.*?)(?=NodeName|\\z)";

    final Matcher matcher = Pattern.compile(regex, Pattern.DOTALL).matcher(input);

    while(matcher.find()) {
        System.out.println(matcher.group(1));
        System.out.println(matcher.group(2).trim());
    } 
```

输出：

```
1
this is the sample output1
2
this is the sample output2 
```

因此，分解正则表达式：

首先，它会跳过所有符号，直到找到第一个“NodeName > command”，然后是一个数字。我们要保留这个数字，以了解哪个命令创建了输出。接下来，我们抓住所有以下标志，直到我们（使用前瞻）找到另一个 NodeName，或者输入的结尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:32:27.750

我的建议..

```
public static void main(String[] args) {
        String log = "NodeName > command1 \n" + "this is the sample output \n"
                + "NodeName > command2 \n" + "this is the sample output";

        String lines[] = log.split("\\r?\\n");
        boolean record = false;
        String statements = "";
        for (int j = 0; j < lines.length; j++) {
            String line = lines[j];         
            if(line.startsWith("NodeName")){

                if(record){
                    //process your statement
                    System.out.println(statements);
                }

                record = !record;
                statements = ""; // Reset statement
                continue;
            }

            if(record){             
                statements += line;
            }
        }
    } 
```

# android - Android BluetoothSocket OutputStream 无限写入阻塞

> ID：12354643
> 
> 赞同：6
> 
> 时间：2012-09-10T15:17:51.897
> 
> 标签：android, sockets, bluetooth, outputstream

我需要以编程方式将 1 到 100 MB 的数据以 1024 字节的块写入远程蓝牙设备。两者都是安卓设备。这是我的客户端程序中用于传输数据的示例代码片段 –</p>

```
bTSocket.connect(); //connect to remote BT device
DataOutputStream outStream = new DataOutputStream(bTSocket.getOutputStream());
byte[] buffer = new byte[1024];
int bytesToTransfer = 1000000;
while (bytesToTransfer > 0) {
    outStream.write(buffer);
    outStream.flush();
    bytesToTransfer -= 1024;
}
outStream.close(); 
```

在 Android 2.2(Froyo) 上运行这段代码时，它运行良好。然而，在 Android 2.3.4 和 4.0.4 的情况下，outStream.write(buffer) 在传输一些数据（比如 100 KB）后会无限阻塞。值得一提的是，远程设备未配置为监听数据。可以写入的数据量有什么限制吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T17:30:37.597

蓝牙套接字以阻塞模式运行，用于读取和写入。

`.write()`如果您填满了发送缓冲区，那么阻止您尝试发送更多数据的唯一方法就是阻止。它阻塞的替代方法是返回一个“操作将阻塞！” 错误代码，就像 TCP 套接字在非阻塞模式下可以做的一样。但是蓝牙套接字不提供任何这样的非阻塞模式。

您声明远程蓝牙设备未从其套接字读取。在这种情况下，本地发送缓冲区和远程接收缓冲区，每个都只有一定的有限大小，最终将被填满。此时，您的`.write()`操作将被阻塞，直到远程端从其套接字中读取某些内容。您不能只是不断地输入数兆字节的数据，并期望它只是在某处缓冲所有数据。

您在不同 Android 平台之间体验到的差异可能归结为相关蓝牙堆栈中可用的缓冲区空间量不同。

# frameworks - Tivoli Common Reporting 和 Cognos 的领先优势

> ID：12354649
> 
> 赞同：0
> 
> 时间：2012-09-10T15:18:04.763
> 
> 标签：frameworks, reporting, cognos, tivoli

我刚刚开始使用 cognos 使用 Tivoli Common Reporting 2.1.1。

已经安装了 TCR 并将数据源配置到 db2 数据库，方法是：报告-使用报告-连接-配置-Ds 连接。

我想制作一个连接到该数据库的小型测试报告，但由于我是这项技术的新手，我不知道如何去做。

在某处阅读我需要让 Framework Manager 创建模型，然后使用 Report 或 Query Studio 使用该模型创建报告。谁能帮助我指导我如何开始制作第一份测试报告？

从这些我假设我需要这个框架，然后我必须在那个软件中配置一些东西来指向我的 db2，然后创建一些模型。然后使用报告或查询来处理这个模型并创建一个报告。我已经阅读手册几天了，但似乎无法让它正常工作。无论如何要获得已经制作的报告并将它们配置为使用我的数据库而不使用框架管理器？因为我认为框架只适用于 Windows，我将它安装在 SUSE 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T19:32:50.257

Tivoli Common Reporting 不是可以单独购买的独立产品。它始终与具有某些报告功能的其他 IBM Tivoli 产品一起提供。这意味着您应该有一些随您购买的 Tivoli 产品一起提供的开箱即用的报告。您可以在 Report Studio 中打开这些报告并尝试修改它们。这样，您将使用这些报告的模型，因此您不需要 Framework Manager。

但是，当您想要报告模型中未包含的数据时，您需要使用 Framework Manager。您说 FM 仅适用于 Windows 是正确的，但这应该不是问题。它连接到另一台机器上的 TCR/Cognos 服务器。

另请注意，存在许可证限制：TCR 随其他 Tivoli 产品免费提供，但仅用于 Tivoli 数据。如果您想报告您的销售数据，那么您需要单独购买 Cognos。

# soundcloud - 创建 soundcloud 应用程序时上传图像时出错

> ID：12354651
> 
> 赞同：0
> 
> 时间：2012-09-10T15:18:10.717
> 
> 标签：soundcloud, uploading

我正在尝试将图像上传到 SoundCloud，以在开发人员部分创建一个新应用程序，但每当我尝试上传徽标和一些屏幕截图时：“上传失败，请重试”。已经这样一周了，我想上传我们的应用程序 deej() 但在上传图像之前我无法提交应用程序，并且无法上传（我尝试使用 Chrome、IE、Mac、PC 但是它总是同样的问题）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T12:51:45.337

您应该就此事联系 Soundcloud 支持，这不是支持论坛，而是与编程问题有关。

# ruby-on-rails - 有没有办法覆盖 AtomFeedBuilder updated_at 值？

> ID：12354652
> 
> 赞同：1
> 
> 时间：2012-09-10T15:18:20.267
> 
> 标签：ruby-on-rails, ruby, actionview, actionviewhelper

根据[文档](http://api.rubyonrails.org/classes/ActionView/Helpers/AtomFeedHelper/AtomFeedBuilder.html)，我试图覆盖一个条目的`updated`值，但是我在我的 RSS 提要中获得了两个字段。`Defaults to the updated_at attribute on the record if one such exists.``updated``updated`

如果我用这个（截断的）示例设置不同的更新值......

```
feed.entry(item) do |entry|
  entry.updated(item.not_the_updated_at_value.strftime("%Y-%m-%dT%H:%M:%SZ"))
end 
```

`updated`...然后我的 RSS 提要中有两个字段：

```
<entry>
    <id>1</id>
    <published>2010-03-30T13:11:07-07:00</published>
    <updated>2010-03-30T13:11:07-07:00</updated>
    <link rel="alternate" type="text/html" href="http://example.com/1"/>
    <title>Title</title>
    <content type="html">Content</content>
    <url>http://example.com/1/</url>
    <updated>2012-07-10T11:05:32Z</updated>
    <author>
      <name>Author</name>
    </author>
  </entry> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T22:42:25.003

您必须将已发布和更新的选项传递到条目中。

```
feed.entry(item, :published => item.published_at, 
                   :updated => item.published_at) do |entry|
  entry.content item.body, :type => 'html'
end 
```

# java - 在 Wicket 中，用 HTML 手动编写什么以及生成什么？

> ID：12354653
> 
> 赞同：1
> 
> 时间：2012-09-10T15:18:20.977
> 
> 标签：java, wicket

这是我第一次使用检票口，所以请多多包涵。

wicket 中的大多数示例展示了如何使用 wicket id 自动将内部 HTML 替换为不同的内容。利用这些知识，我用 HTML 手写了一个表单，其中包含许多格式和 JQuery 用于不同的事物，并且只使用 Wicket 自动生成 2 个选择框的信息。但是，当我尝试在 Wicket 端解析提交的信息时，我感到困惑。

我发现这很容易的唯一方法是使用`RequestCycle.get().getRequest().getRequestParameters().`获取所有传递的信息。它有效，但我认为这不是使用 Wicket 的理想方式。请求处理程序似乎也有一种方法，但我不知道从哪里开始，特别是因为很多文档在新的 6.0.0 版本中已经过时了。

我应该以什么方式将 Wicket 与表单一起使用？我是否手写了大部分表格，只让 Wicket 自动生成一些信息，并使用 RequestCycle？我是否编写了一个框架表单，让 Wicket 自动生成其余部分，并使用大量提交处理程序？这在易于理解的初学者教程中记录在哪里？

注意：我的表单有几个动态创建的字段（想想“单击此处添加更多选项”），并在后台使用 AJAX 提交，验证，然后清除。这可能会使 Wicket 方面的事情复杂化，但这是一个功能要求

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T15:25:30.327

使用 Wicket，您可以将 HTML 标记视为模板。标记实际上是几乎标准的 HTML。您可以（并且应该）`wicket:id`为将附加特定行为或逻辑（表单、按钮、链接）或需要一些服务器端处理（例如表单组件或嵌套自定义组件或面板）的所有内容定义属性。其他所有内容都将在响应中输出，就像在标记中一样。

Wicket 将处理表单提交并为您处理请求。在 Wicket 中，表单组件通常在服务器端定义，并添加到`Form`组件中。在`Form`组件的`onSubmit()`中，Wicket 已经处理了请求，提交的值将在`FormComponent`的模型中可用。

因此，Wicket 处理表单提交的理想方式是在服务器端创建表单中的任何组件。

以下 Wicket 示例页面显示了`Form`其中的一些基本`FormComponents`内容：[Wicket 示例 - forminput](http://www.wicket-library.com/wicket-examples/forminput/)。你甚至可以看到它的[源代码](http://www.wicket-library.com/wicket-examples/forminput/wicket/bookmarkable/org.apache.wicket.examples.source.SourcesPage?0&SourcesPage_class=org.apache.wicket.examples.forminput.FormInput)。

此外，您可能会发现以下 Wicket wiki 页面很有用：[How to do things in Wicket - Forms](https://cwiki.apache.org/WICKET/forms.html)。

关于动态组件的创建，每当必须创建一个新的动态组件时，您可以例如发出一个创建组件服务器端的 Ajax 请求（`ListView`例如，包装在 中），并在 ajax 回调中刷新标记。

这里有一个这样的列表示例：[Wicket in action - Building a ListEditor form component](http://wicketinaction.com/2008/10/building-a-listeditor-form-component/)

补充一点，我发现[Wicket in Action](https://rads.stackoverflow.com/amzn/click/com/1932394982)这本书是学习 Wicket 的绝佳资源。*第 6 章 - 使用表单处理用户输入*详细阐述了该主题。

# jsf - CommandButton 动作在加载时自动执行多次

> ID：12354655
> 
> 赞同：1
> 
> 时间：2012-09-10T15:18:22.407
> 
> 标签：jsf, primefaces

我正在写一个 JSF 页面，但是，一个命令按钮在页面加载时多次调用它的动作，但没有人点击它......这搞砸了我的整个进度......

HTML：

```
<h:panelGrid columns="2" cellpadding="10">  
<h:form>
    <table>
        <tr>
            <td>姓名：&lt;/td>
            <td><p:inplace editor="true"><p:inputText value="#{user.name}"/></p:inplace></td>
        </tr>
        <tr>
            <td>联系方式：&lt;/td>
            <td><p:inplace editor="true"><p:inputText value="#{user.phone}"/></p:inplace></td>
        </tr>
        <tr>
            <td>性别：&lt;/td>
            <td><h:outputText value="#{user.gender}"/></td>
        </tr>
        <tr>
            <td>身份证号：&lt;/td>
            <td><p:inplace editor="true"><p:inputText value="#{user.pid}"/></p:inplace></td>
        </tr>
        <tr>
            <td style="position:absolute; right:30px;"><p:commandButton value="删除" action="#{info.removeUser()}"/></td>
        </tr>
    </table>

</h:form> 
```

爪哇：

```
public void removeUser(){
    System.out.println("Current tab:"+index +" Removed............");
    users.remove(Integer.parseInt(index));
} 
```

这里的“索引”是手风琴面板中的当前选项卡，它是一个字符串......

第一次在这里提问，也许我遗漏了一些信息......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T18:33:47.060

如果您忘记`p`在视图中声明 XML 名称页，就会发生这种情况。

```
xmlns:p="http://primefaces.org/ui" 
```

如果您忘记声明`p`XML 命名空间，则所有`p:xxx`标记都将被视为纯文本。属性中的所有 EL 表达式都会立即执行，就好像它们嵌入在纯文本中一样。这也包括`#{info.removeUser()}`表达式。“很多次”很可能与视图中出现的 EL 表达式相同。

# c - 在内核中访问用户空间结构的成员会给出错误的值

> ID：12354657
> 
> 赞同：2
> 
> 时间：2012-09-10T15:18:30.343
> 
> 标签：c, linux, linux-kernel, kernel-module, ioctl

我在代码的输出中看到了一个我不理解的奇怪之处。我在头文件中定义了一个结构。我在用户空间中填充一个结构，然后通过 ioctl 将其发送到内核模块。内核模块应该从用户那里复制它，然后报告用户存储的值。

结构定义为：

```
typedef struct Command_par {
    int cmd;            /**< special driver command */
    int target;         /**< special configuration target */
    unsigned long val1;     /**< 1\. parameter for the target */
    unsigned long val2;     /**< 2\. parameter for the target */
    int error;          /**< return value */
    unsigned long retval;   /**< return value */
} Command_par_t ; 
```

用户空间代码只是一个快速测试程序：

```
#include <stdio.h>
#include <errno.h>
#include <string.h>
#include <fcntl.h>
#include <sys/stat.h>
#include "can4linux.h"  //can4linux is the standard can driver that comes
                        //with the uCLinux kernel (where this code was originally
                        //running before this port to a desktop machine

#define CAN_COMMAND 0
void main()
{
  long ret;
  Command_par_t cmd;
  int fd;
  //set and open the file descriptor to the device

  cmd.cmd = 2;
  cmd.target = 9; 
  cmd.val1 = 8;
  cmd.val2 = 7;
  cmd.error = 6;
  cmd.retval = 5;
  ret = ioctl(fd, CAN_COMMAND, &cmd); 
```

通过 ioctl 获取打开/发送数据的内核模块：

```
long can_ioctl(struct file *file, unsigned int cmd, unsigned long arg)
{
  Command_par_t *myptr;
  myptr = (void *)kmalloc(sizeof(Command_par_t)+1,GFP_KERNEL );

  copy_from_user((void *)myptr, (void *)arg, sizeof(Command_par_t));

  printk("cmd = %d, target = %d, val1 = %d, val2 = %d, error = %d, retval = %d\n", 
         myptr->cmd, myptr->target, myptr->val1, myptr->val2, myptr->error, myptr->retval); 
```

这是在 can4linux.h 头文件中定义可能的 IOCTL 命令的地方：

```
---------- IOCTL requests */

#define COMMAND      0  /**< IOCTL command request */
#define CONFIG       1  /**< IOCTL configuration request */
#define SEND         2  /**< IOCTL request */
#define RECEIVE      3  /**< IOCTL request */
#define CONFIGURERTR     4  /**< IOCTL request */ 
```

所以显然这只是测试代码，我正在尝试调试一个更大的问题，但现在即使这也不能正常工作......我得到的输出是：

```
[217088.860190] cmd = 2, target = 1, val1 = 3, val2 = 134514688, error = 134514480, retval = 0 
```

cmd 设置正确，之后其他所有内容都被扭曲了......看起来它只传递了一个 int 然后我正在访问我的结构之外的内存？有人看到我在这里做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T16:17:16.767

问题是如何定义 ioctl 编号。这是从运行在某些嵌入式硬件上的 uCLinux (2.4) 到 OpenSUSE 发行版 (3.1) 的移植。我猜正在发生的事情是在我们幸运的较小的嵌入式平台上，并且 ioctl 数被定义为简单的整数：

```
#define COMMAND      0  /**< IOCTL command request */ 
#define CONFIG       1  /**< IOCTL configuration request */ 
#define SEND         2  /**< IOCTL request */ 
#define RECEIVE      3  /**< IOCTL request */ 
#define CONFIGURERTR     4  /**< IOCTL request */ 
```

足够独特，不会引起问题。现在我正试图在完整的 linux 发行版上重新编译代码，系统中发生了太多其他事情，我们的命令被践踏了。现在重新定义 ioctl 编号，如下所示：

```
#define GC_CAN_IOC_MAGIC  'z'       //!< Magic number - I guess this magic number can be chosen freely
#define GC_CAN_IOC_WRITE_COMMAND        _IOW(GC_CAN_IOC_MAGIC,  0, Command_par_t) 
```

从用户空间传递的值被正确记录：

```
[220546.535115] cmd = 2, target = 9, val1 = 8, val2 = 7, error = 6, retval = 5 
```

如果有人能给我一个比“践踏”更好的答案，我很乐意对这个问题有更清晰的理解。另外，如果我仍然错误地设置了 IOCTL 号码，请有人纠正我。

# linux - 如何从文件中选择随机行

> ID：12354659
> 
> 赞同：2
> 
> 时间：2012-09-10T15:18:38.900
> 
> 标签：linux, bash, text, random, sed

我有一个包含 10 百行，长度不同的文本文件。现在我想随机选择N行，保存在另一个文件中，然后从原始文件中删除。我已经找到了这个问题的一些答案，但大多数都使用了一个简单的想法：对文件进行排序并选择第一行或最后 N 行。不幸的是，这个想法对我不起作用，因为我想保留行的顺序。我尝试了这段代码，但它非常慢并且需要几个小时。

```
FILEsrc=$1;
FILEtrg=$2;
MaxLines=$3;
let LineIndex=1;
while [ "$LineIndex" -le "$MaxLines" ]
do
# count number of lines
NUM=$(wc -l $FILEsrc | sed 's/[ \r\t].*$//g');
let X=(${RANDOM} % ${NUM} + 1);
echo $X;
sed -n ${X}p ${FILEsrc}>>$FILEtrg; #write selected line into target file
sed -i -e  ${X}d ${FILEsrc};       #remove selected line from source file
LineIndex=`expr $LineIndex + 1`;
done 
```

我发现这一行代码中最耗时的一行：

```
sed -i -e  ${X}d ${FILEsrc}; 
```

有什么办法可以克服这个问题并使代码更快？既然我很着急，我可以请你发给我完整的 C/C++ 代码来做这件事吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T15:38:36.457

一个简单的 O(n) 算法描述如下：

[http://en.wikipedia.org/wiki/Reservoir_sampling](http://en.wikipedia.org/wiki/Reservoir_sampling)

```
array R[k];    // result
integer i, j;

// fill the reservoir array
for each i in 1 to k do
    R[i] := S[i]
done;

// replace elements with gradually decreasing probability
for each i in k+1 to length(S) do
    j := random(1, i);   // important: inclusive range
    if j <= k then
        R[j] := S[i]
    fi
done 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-10T15:39:57.763

Generate all your offsets, then make a single pass through the file. Assuming you have the desired number of offsets in `offsets` (one number per line) you can generate a single `sed` script like this:

```
sed "s!.*!&{w $FILEtrg\nd;}!" offsets 
```

The output is a `sed` script which you can save to a temporary file, or (if your `sed` dialect supports it) pipe to a second `sed` instance:

```
... | sed -i -f - "$FILEsrc" 
```

Generating the `offsets` file left as an exercise.

Given that you have the Linux tag, this should work right off the bat. The default `sed` on some other platforms may not understand `\n` and/or accept `-f -` to read the script from standard input.

Here is a complete script, updated to use `shuf` (thanks @Thor!) to avoid possible duplicate random numbers.

```
#!/bin/sh

FILEsrc=$1
FILEtrg=$2
MaxLines=$3

# Add a line number to each input line
nl -ba "$FILEsrc" | 
# Rearrange lines
shuf |
# Pick out the line number from the first $MaxLines ones into sed script
sed "1,${MaxLines}s!^ *\([1-9][0-9]*\).*!\1{w $FILEtrg\nd;}!;t;D;q" |
# Run the generated sed script on the original input file
sed -i -f - "$FILEsrc" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-10T15:54:17.533

[我已经更新了每个解决方案以从输入中删除选定的行，但我不肯定这`awk`是正确的。我`bash`自己偏爱这个解决方案，所以我不会花任何时间调试它。如有错误，请随时编辑。]

这是一个简单的`awk`脚本（使用浮点数更容易管理概率，它不能很好地与 混合`bash`）：

```
tmp=$(mktemp /tmp/XXXXXXXX)
awk -v total=$(wc -l < "$FILEsrc") -v maxLines=$MaxLines '
    BEGIN { srand(); }
    maxLines==0 { exit; }
    { if (rand() < maxLines/total--) {
        print; maxLines--;
      } else {
        print $0 > /dev/fd/3
      }
    }' "$FILEsrc" > "$FILEtrg" 3> $tmp
mv $tmp "$FILEsrc" 
```

当您将一行打印到输出时，您会递减`maxLines`以减少选择更多行的概率。但是当你消耗输入时，你会减少`total`以增加概率。在极端情况下，概率达到零`maxLines`，因此您可以停止处理输入。在另一个极端，命中 1 一次的概率`total`小于或等于`maxLines`，您将接受所有后续行。

* * *

这是相同的算法，`bash`使用整数算术（几乎）纯实现：

```
FILEsrc=$1
FILEtrg=$2
MaxLines=$3

tmp=$(mktemp /tmp/XXXXXXXX)

total=$(wc -l < "$FILEsrc")
while read -r line && (( MaxLines > 0 )); do
    (( MaxLines * 32768 > RANDOM * total-- )) || { printf >&3 "$line\n"; continue; }
    (( MaxLines-- ))
    printf "$line\n"
done < "$FILEsrc" > "$FILEtrg" 3> $tmp
mv $tmp "$FILEsrc" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-10T15:38:23.537

这是一个完整的 Go 程序：

```
package main

import (
    "bufio"
    "fmt"
    "log"
    "math/rand"
    "os"
    "sort"
    "time"
)

func main() {
    N := 10
    rand.Seed( time.Now().UTC().UnixNano())
    f, err := os.Open(os.Args[1]) // open the file
    if err!=nil { // and tell the user if the file wasn't found or readable
        log.Fatal(err)
    }
    r := bufio.NewReader(f)
    var lines []string // this will contain all the lines of the file
    for {
        if line, err := r.ReadString('\n'); err == nil {
            lines = append(lines, line)
        } else {
            break
        }
    }
    nums := make([]int, N) // creates the array of desired line indexes
    for i, _ := range nums { // fills the array with random numbers (lower than the number of lines)
        nums[i] = rand.Intn(len(lines))
    }
    sort.Ints(nums) // sorts this array
    for _, n := range nums { // let's print the line
        fmt.Println(lines[n])
    }
} 
```

如果你把 go 文件放在一个名为`randomlines`你的目录中`GOPATH`，你可以像这样构建它：

```
go build randomlines 
```

然后这样称呼它：

```
 ./randomlines "path_to_my_file" 
```

这将在您的文件中打印 N（此处为 10）随机行，但不会更改顺序。当然，即使是大文件，它也几乎是瞬时的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-10T16:50:00.437

这是一个使用 coreutils、sed 和 awk 的有趣的两遍选项：

```
n=5
total=$(wc -l < infile)

seq 1 $total | shuf | head -n $n                                           \
| sed 's/^/NR == /; $! s/$/ ||/'                                           \
| tr '\n' ' '                                                              \
| sed 's/.*/   &  { print >> "rndlines" }\n!( &) { print >> "leftover" }/' \
| awk -f - infile 
```

一个随机数列表被传递给 sed，它会生成一个 awk 脚本。如果 awk 从上面的管道中删除，这将是输出：

```
{ if(NR == 14 || NR == 1 || NR == 11 || NR == 20 || NR == 21 ) print > "rndlines"; else print > "leftover" } 
```

所以随机行保存在`rndlines`，其余的保存在`leftover`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-30T15:34:26.883

提到的“10 百”行排序应该很快，所以这是 Decorate、Sort、Undecorate 模式的一个很好的例子。它实际上创建了两个新文件，从原始文件中删除行可以通过重命名来模拟。

注意：不能使用 head 和 tail 代替 awk，因为它们在给定行数后关闭文件描述符，使 tee 退出，从而导致 .rest 文件中的数据丢失。

```
FILE=input.txt
SAMPLE=10
SEP=$'\t'

<$FILE nl -s $"SEP" -nln -w1 | 
  sort -R |
  tee \
    >(awk "NR >  $SAMPLE" | sort -t"$SEP" -k1n,1 | cut -d"$SEP" -f2- > $FILE.rest) \
    >(awk "NR <= $SAMPLE" | sort -t"$SEP" -k1n,1 | cut -d"$SEP" -f2- > $FILE.sample) \
>/dev/null

# check the results
wc -l $FILE*

# 'remove' the lines, if needed
mv $FILE.rest $FILE 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-09-11T06:14:48.820

这可能对你有用（GNU sed、sort 和 seq）：

```
n=10
seq 1 $(sed '$=;d' input_file) |
sort -R |
sed $nq | 
sed 's/.*/&{w output_file\nd}/' | 
sed -i -f - input_file 
```

`$n`要提取的行数在哪里。

# php - 如何获取用户的最新推文

> ID：12354664
> 
> 赞同：-1
> 
> 时间：2012-09-10T15:18:55.907
> 
> 标签：php, twitter

我正在尝试获取我的客户最新的推文。在谷歌搜索后，我得到了一些代码。不幸的是，代码在本地主机中工作，但在托管服务器中不工作。它的说法**是找不到服务器**。我正在发布代码快照..

```
<?php

            function getTwitterStatus($userid){
            $url = "http://twitter.com/statuses/user_timeline/$userid.xml?count=1";

            $xml = simplexml_load_file($url) or die("could not connect");

            foreach($xml->status as $status){
            $text = $status->text;
            }
            echo $text;
            }

            //my user id AmitEducation
            getTwitterStatus("AmitEducation");

            ?> 
```

请帮帮我。如果有人有更好的建议，请帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:29:05.067

使用[Twitter 搜索 API](https://dev.twitter.com/docs/api/1/get/search)，它真的很棒。它是 JSON。[+1]

```
$tweets = json_decode(file_get_contents("http://search.twitter.com/search.json?q=php&rpp=5&include_entities=true&result_type=mixed"));

foreach($tweets->results as $t){

  echo "Username: {$t->from_user_name}";
  echo "Tweet: {$t->text}" . PHP_EOL;

} 
```

请阅读文档以了解如何使用并查看示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:43:49.100

更改链接中的用户名

```
 <?php
      $json = file_get_contents("http://twitter.com/status/user_timeline/username.json?count=10", true); //getting the file content
      $decode = json_decode($json, true); //getting the file content as array
      print_r($decode);
    ?> 
```

# jsf-2 - Prime Faces 3.3.1 今天按钮已禁用

> ID：12354668
> 
> 赞同：0
> 
> 时间：2012-09-10T15:19:14.417
> 
> 标签：jsf-2, primefaces

我的 xhtml 中有日历小部件：

```
<p:calendar pattern="MM/dd/yyyy" navigator="true" id="endDate" for="endDate" readonlyInput="true"
                        mindate="#{manageMarketingProgramsBean.currentDate}" showOn="button" showButtonPanel="true">
                        <f:convertDateTime pattern="MM/dd/yyyy" timeZone="America/New_York" />
                    </p:calendar> 
```

“今天”和“完成”按钮出现，但今天按钮被禁用，您能告诉我可能是什么问题吗？

Prime Faces 日历：

![在此处输入图像描述](../Images/97ba7665b413415508e60ad6009f7529.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T08:29:02.190

实际上，当您单击“今天”按钮时，今天所在的颜色会发生变化，以便于识别。我的意思是它会从蓝色变为黑色。但它从不将日期写入 '' 标签。

# testing - Jacoco 和 Arquillian 在多模块 Maven 项目中

> ID：12354669
> 
> 赞同：1
> 
> 时间：2012-09-10T15:19:17.173
> 
> 标签：testing, integration, jboss-arquillian, jacoco

我正在关注这篇文章： http: [//www.softwarepassion.com/it-coverage-with-arquillian-jacoco-extension/](http://www.softwarepassion.com/it-coverage-with-arquillian-jacoco-extension/)以获得 arquillian 集成测试的测试覆盖率。我的项目虽然是一个多模块，但我不知道将插件和依赖项放在哪里。是在顶级pom，神器制作模块还是集成测试模块？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T02:46:48.733

在某种程度上，这取决于您的 Maven 设置的详细信息，这不是您的问题。以下是一些一般性建议。

1）您应该将 arquillian-jacoco 和 jacoco 依赖项放在哪里？

这些依赖关系可能应该去任何你的 Arquillian 依赖关系的其余部分。我的理解是，只是这些依赖项触发了 Arquillian 使用 JaCoCo，而不是插件声明；即使这些依赖项位于具有实际 Arquillian 测试的 POM 的父级中，仍应检测 Arquillian 测试类。您不会将这些依赖项放在带有测试的模块的兄弟模块中，因为它们需要由集成测试模块继承（当然，除非该兄弟模块已被声明为测试模块的依赖项）。

2) 你应该把 JaCoCo 插件声明放在哪里？

如上所述，您甚至可能不需要此声明，具体取决于您要实现的目标。如果你想生成一个报告，而不仅仅是 jacoco.exec 文件，那么你需要声明插件和一个带有报告目标的执行。如果您希望使用 JaCoCo 进行其他测试，例如单元测试，您可能还希望使用 prepare-agent 目标声明插件。

如果你要声明插件，它可以像任何其他 Maven 插件一样被对待。如果您想在默认情况下跨多个模块运行 JaCoCo，您可以选择将插件声明放在常规“插件”标签内的父 POM 中，并让它由所有子模块继承，或者您可能希望将它放在父 POM 中在 'pluginManagement' 元素中，因此可以继承配置（请参阅[http://maven.apache.org/pom.html#Plugin_Management](http://maven.apache.org/pom.html#Plugin_Management)）。或者，如果您只想在集成测试模块中运行 Arquillian 测试，您也可以简单地在此模块的 POM 中声明插件（假设您需要报告，并且如果您只是检测 Arquillian 测试，则没有 prepare-agent 目标）。

希望有帮助！

# ios - 在 iOS 中以编程方式生成视图

> ID：12354672
> 
> 赞同：-1
> 
> 时间：2012-09-10T15:19:24.513
> 
> 标签：ios, uitableview, core-data, automatic-ref-counting

# 更新：

谢谢大家的提示。该教程提到提供了一个 XIB 文件（我没有），所以我在创建项目的方式上做错了。

* * *

我正在关注 Apple 的[iOS 核心数据教程](https://developer.apple.com/library/ios/#documentation/DataManagement/Conceptual/iPhoneCoreData01/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008305-CH1-SW1)。本教程尚未针对 ARC 进行更新——显然是针对 Xcode 4，因为它要求“使用 iOS 部分中的基于窗口的应用程序模板创建一个新项目”。

由于 Xcode 4.4.1 下不存在该选项，因此我环顾 Stack Overflow 并读到我应该创建一个空应用程序。根据教程说明，我没有创建 Storyboard 或 NIB 文件。

除了更新 ARC 的代码（使用`strong`而`retain`不是实现提供的`dealloc`方法）之外，我确信我的项目中的代码与教程中的代码相匹配，直到“表格视图控制器”一章的末尾。此时，教程说我应该能够[运行项目并获得视图](http://cl.ly/image/1r240S2z460b)。

相反，我得到一个空白的黑屏。

也许我的问题在这里无法解决，但我应该使用不同的项目模板吗？哪一个？

我只有两个类：一个 RootViewController 和一个 AppDelegate。AppDelegate 导入 RootViewController 并包含一个 UIWindow 属性。同样，项目中没有 Storyboard 或 NIB。

如果有特定的地方可以查看，我也可以提供任何代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:24:33.690

如果您想检查您的设置是否正确，请执行以下操作：

1.  为您的窗口添加背景颜色

    `self.window.backgroundColor = [UIColor whiteColor];`

2.  确保你告诉窗口显示自己

    `[self.window makeKeyAndVisible];`

3.  确保您的视图控制器是窗口的`rootViewController`

    `self.window.rootViewController = myViewControllerInstance;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:26:29.963

选择单一视图应用程序，并取消选中“使用故事板”字段。其余的应该是一样的。

# gwt - GWT maven 编译器输出目录

> ID：12354673
> 
> 赞同：6
> 
> 时间：2012-09-10T15:19:34.067
> 
> 标签：gwt, gwt-maven-plugin

我需要使用 maven 插件为 GWT 编译器设置输出目录位置。

我调查了 GWT 编译器和 gwt-maven-plugin 文档，但没有找到任何选项。

例如：

我有两个名为`editor`and的模块`console`，gwt-maven-plugin 将它们编译到`%ROOT%/editor`和`%ROOT%/console`目录。

但我需要将这些模块编译到`%ROOT%/ria/editor`目录`%ROOT%/ria/console`中，以减少维护基于 URL 的安全性和其他内容的工作。

是否可以在插件配置中设置`ria`目录以避免创建不必要的新 ANT 任务以将已编译的模块内容移动到需要的位置？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-10-14T11:10:41.050

我必须取消选中以下屏幕截图中突出显示的复选框![在此处输入图像描述](../Images/eb232397e1444bd1371385d122e2cba0.png)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-10T16:51:04.863

```
<plugin>
  <artifactId>gwt-maven-plugin</artifactId>
  <configuration>
    <webappDirectory>${project.build.directory}/${project.build.finalName}/ria</webappDirectory>
  </configuration>
</plugin> 
```

见[http://mojo.codehaus.org/gwt-maven-plugin/compile-mojo.html#webappDirectory](http://mojo.codehaus.org/gwt-maven-plugin/compile-mojo.html#webappDirectory)

除非您在模式下运行，否则它不会与 DevMode 配合得很好`-noserver`（无论如何我都会推荐任何中型/大型项目）

# informatica-powercenter - 减少会话的日志大小

> ID：12354674
> 
> 赞同：2
> 
> 时间：2012-09-10T15:19:35.990
> 
> 标签：informatica-powercenter, informatica

我们有一个处理数百万行的会话。问题是它创建了一个包含两个主要问题的巨大日志：

1.  日志大小使其难以处理和分析。
2.  日志大小会减慢进程（我们猜测，因为日志大于 55 GB）。

有没有办法减少日志的大小？例如，我们不需要每次应用程序执行提交时都知道。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T04:57:04.397

您可以将日志级别设置为**Terse**，这将使您的日志大小最小化。（在会话配置中设置）。

**设置Terse**的缺点是，当出现问题并且您想在日志中查找某些内容时，您将无法获得大量信息。

要更改日志级别：

*   打开您的会话（在您的工作流程中双击它，除非它是可重用的会话）
*   转到*配置对象*选项卡
*   从*覆盖跟踪*下拉列表中选择适当的值（它允许您控制整个会话的日志记录级别；如果需要，您可以在*组件*选项卡中覆盖各个组件的日志级别）

# c# - 属性应用到的成员的DataMember信息

> ID：12354678
> 
> 赞同：1
> 
> 时间：2012-09-10T15:19:44.870
> 
> 标签：c#, reflection, attributes

如何从应用到它的属性中获取**数据成员（MethodInfo、PropertyInfo 等）的信息。**

```
[Custom]
public void MethodA()
{

}

[AttributeUsage(AttributeTargets.Method, Inherited = false, AllowMultiple = false)]
sealed class PluginInitAttribute : Attribute
{
    public CustomAttribute()
    {
         //Get MethodA's MethodInfo here
    }
} 
```

}

前进！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:21:47.850

你不能。属性不知道它附加到哪个成员（如果有）。但是，成员可以访问装饰它的属性。

通常，调用代码（检查属性的代码）将负责告诉属性任何必要的上下文，例如 this，但这完全是特定于实现的。

# java - Spring XML 错误：无法解析占位符“cas.server.host”

> ID：12354680
> 
> 赞同：3
> 
> 时间：2012-09-10T15:19:47.657
> 
> 标签：java, spring, spring-security, spring-webflow

我正在尝试设置我的 Spring CAS.XML 文件，但我不知道为什么该文件没有看到我在文件中设置的值：

有人可以告诉我我收到以下错误：

```
2012-09-10 11:16:00,396 ERROR org.springframework.web.context.ContextLoader - Context initialization failed
org.springframework.beans.factory.BeanDefinitionStoreException: Invalid bean definition with name 'requestSingleLogoutFilter' defined in ServletContext resource [/WEB-INF/spring/CAS-Local.xml]: Could not resolve placeholder 'cas.server.host'
    at org.springframework.beans.factory.config.PlaceholderConfigurerSupport.doProcessProperties(PlaceholderConfigurerSupport.java:209) 
```

如果您看，我确实在文件末尾设置了值...

这是我的 CAS-Local.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
    xmlns:tx="http://www.springframework.org/schema/tx" xmlns:jdbc="http://www.springframework.org/schema/jdbc"
    xmlns:security="http://www.springframework.org/schema/security"
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:util="http://www.springframework.org/schema/util"

    xsi:schemaLocation="http://www.springframework.org/schema/beans 
                            http://www.springframework.org/schema/beans/spring-beans.xsd
                            http://www.springframework.org/schema/context 
                            http://www.springframework.org/schema/context/spring-context-3.1.xsd
                            http://www.springframework.org/schema/tx
                            http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
                            http://www.springframework.org/schema/jdbc
                            http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd
                            http://www.springframework.org/schema/security
                            http://www.springframework.org/schema/security/spring-security-3.1.xsd
                            http://www.springframework.org/schema/util 
                            http://www.springframework.org/schema/util/spring-util-3.1.xsd">

        <security:http entry-point-ref="casEntryPoint"
        use-expressions="true">
        <security:intercept-url pattern="/" access="permitAll" />

        <security:intercept-url pattern="/index.jsp"
            access="permitAll" />
        <security:intercept-url pattern="/cas-logout.jsp"
            access="permitAll" />
        <security:intercept-url pattern="/casfailed.jsp"
            access="permitAll" />

        <security:intercept-url access="hasRole('ROLE_MEMBER_INQUIRY')"
            pattern="/visit**" />

        <security:custom-filter ref="requestSingleLogoutFilter"
            before="LOGOUT_FILTER" />
        <security:custom-filter ref="singleLogoutFilter"
            before="CAS_FILTER" />
        <security:custom-filter ref="casFilter"
            position="CAS_FILTER" />

        <security:logout logout-success-url="/cas-logout.jsp" />
    </security:http>

    <security:authentication-manager alias="authManager">
        <security:authentication-provider
            ref="casAuthProvider" />
    </security:authentication-manager>

    <security:ldap-server id="ldapServer"
        url="ldaps://dvldap01.uftwf.dev:636/dc=uftwf,dc=dev" manager-dn="cn=xxx,dc=uftwf,dc=dev"
        manager-password="xxx" />

    <security:ldap-user-service id="userServiceLDAP"
        server-ref="ldapServer" user-search-base="ou=webusers"
        user-search-filter="(uid={0})" group-search-base="ou=groups"
        group-role-attribute="cn" group-search-filter="(uniqueMember={0})"
        role-prefix="ROLE_" />

    <!-- This filter handles a Single Logout Request from the CAS Server -->
    <bean id="singleLogoutFilter" class="org.jasig.cas.client.session.SingleSignOutFilter" />
    <!-- This filter redirects to the CAS Server to signal Single Logout should 
        be performed -->
    <bean id="requestSingleLogoutFilter"
        class="org.springframework.security.web.authentication.logout.LogoutFilter"
        p:filterProcessesUrl="/j_spring_cas_security_logout">
        <constructor-arg
            value="https://${cas.server.host}/cas-server-webapp/logout" />
        <constructor-arg>
            <bean
                class="org.springframework.security.web.authentication.logout.SecurityContextLogoutHandler" />
        </constructor-arg>
    </bean>

    <bean id="serviceProperties" class="org.springframework.security.cas.ServiceProperties"
        p:service="http://wcmisdlin07.uftmasterad.org:8080/SchoolVisitLocked/j_spring_cas_security_check"
        p:authenticateAllArtifacts="true" />

    <bean id="casEntryPoint"
        class="org.springframework.security.cas.web.CasAuthenticationEntryPoint"
        p:serviceProperties-ref="serviceProperties"
        p:loginUrl="https://6dvews01.uftwf.dev:8443/cas-server-webapp/login" />

    <bean id="casFilter"
        class="org.springframework.security.cas.web.CasAuthenticationFilter"
        p:authenticationManager-ref="authManager" p:serviceProperties-ref="serviceProperties"
        p:proxyGrantingTicketStorage-ref="pgtStorage"
        p:proxyReceptorUrl="/j_spring_cas_security_proxyreceptor">
        <property name="authenticationDetailsSource">
            <bean
                class="org.springframework.security.cas.web.authentication.ServiceAuthenticationDetailsSource" />
        </property>

        <property name="authenticationFailureHandler">
            <bean
                class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler"
                p:defaultFailureUrl="/casfailed.jsp" />
        </property>

        <property name="authenticationSuccessHandler">
            <bean
                class="org.springframework.security.web.authentication.SavedRequestAwareAuthenticationSuccessHandler"
                p:defaultTargetUrl="/visit" />
        </property>
    </bean>
    <!-- NOTE: In a real application you should not use an in memory implementation. 
        You will also want to ensure to clean up expired tickets by calling ProxyGrantingTicketStorage.cleanup() -->
    <bean id="pgtStorage"
        class="org.jasig.cas.client.proxy.ProxyGrantingTicketStorageImpl" />
    <bean id="casAuthProvider"
        class="org.springframework.security.cas.authentication.CasAuthenticationProvider"
        p:serviceProperties-ref="serviceProperties" p:key="casAuthProviderKey">
        <property name="authenticationUserDetailsService">
            <bean
                class="org.springframework.security.core.userdetails.UserDetailsByNameServiceWrapper">
                <constructor-arg ref="userServiceLDAP" />
            </bean>
        </property>

        <property name="ticketValidator">
            <bean class="org.jasig.cas.client.validation.Cas20ServiceTicketValidator">
                <constructor-arg index="0"
                    value="https://6dvews01.uftwf.dev:8443/cas-server-webapp" />
            </bean>
        </property>
    </bean>

    <!-- Configuration for the environment can be overriden by system properties -->
    <context:property-placeholder
        system-properties-mode="OVERRIDE" properties-ref="environment" />

    <util:properties id="environment">
        <prop key="cas.service.host">wcmisdlin07.uftmasterad.org:8443</prop>
        <prop key="cas.server.host">6dvews01.uftwf.dev:8443</prop>
    </util:properties>
</beans> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:30:46.793

您对“${cas.server.host}”之类的属性使用占位符，这些属性必须在属性文件中定义并由 spring 解析。在您的类路径中创建一个新的属性文件“your.properties”并将其添加到您的上下文中：

```
<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
<property name="location">
    <value>your.properties</value>
</property>
</bean> 
```

你的属性：

cas.server.host=http://localhost/abc

# ant - 如何仅将 Cobertura 结果加载到 Sonar 中？

> ID：12354682
> 
> 赞同：0
> 
> 时间：2012-09-10T15:19:58.640
> 
> 标签：ant, sonarqube, cobertura

> **可能重复：**
> [SONAR - 使用 Cobertura 测量代码覆盖率](https://stackoverflow.com/questions/7747587/sonar-measure-code-coverage-using-cobertura)

我已将我们的 ant 构建配置为使用声纳插件，它运行静态分析工具并将结果正确加载到声纳中。我们的测试小组正在运行系统级测试并使用 Cobertura 收集代码覆盖率，这工作正常，我们可以生成 xml 或 html cobertura 报告来查看结果。

我们现在想将生成的 coverage.xml 文件加载到 Sonar 中。当我设置 Ant 目标以使用现有的 xml 报告时，sonar 还想运行 findbugs。

由于系统级测试是独立于构建完成的，我怎样才能将 Cobertura 结果加载到 Sonar 中？我同意将“覆盖”结果存储在单独的声纳项目中（与静态分析结果分开）

谢谢

# c# - 我能否只获得自上次检查以来的新 Facebook 评论，而不是每次都获得所有评论？

> ID：12354688
> 
> 赞同：1
> 
> 时间：2012-09-10T15:20:45.807
> 
> 标签：c#, facebook, facebook-c#-sdk, facebook-comments

现在我有一个应用程序，允许用户安排/发布 Facebook 帖子，然后监控喜欢/评论。我预见的问题之一是，目前我正在提取每一条评论/比如它是否已被处理。相反，我想做的是能够说“给我自 XYZdate/XYZcomment 以来的所有新评论。” 这目前可能吗？

```
 var accessToken = existingUserNode.Attributes["accessToken"].Value;
            var facebookAPIMgr = new FacebookWrapper.FacebookAPIManager();
            var msg = new FacebookWrapper.FacebookMessage()
            {
                AccessToken = accessToken,
                FacebookMessageId = facebookPost.FacebookMessageId
            };

            //Get Facebook Message Comments
            // Need to find a way to limit this to only new comments/likes
            var comments = facebookAPIMgr.RetrieveComments(msg); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:27:18.890

您可以将[基于时间的分页](https://developers.facebook.com/docs/reference/api/pagination/)作为图形 API 查询的一部分。如果您保留上次轮询事物时的 unix 时间戳，则可以简单地执行`https://graph.facebook.com/{whatever}?since={last run}`.

这在我今年早些时候大量使用 Graph API 时奏效了，并且仍然在文档中，但考虑到 Facebook 多么喜欢在不告诉任何人你可能仍然遇到问题的情况下改变东西。所以只是一个警告，YMMV。

# android - Android ExpandableListView 关于数组

> ID：12354689
> 
> 赞同：2
> 
> 时间：2012-09-10T15:20:50.173
> 
> 标签：android

我打算在我的活动中添加可扩展列表视图。我在互联网上做了一些研究，但没有一个符合我想要的。我还读到 expandablelistview 有父元素和子元素。我想做的是父类是类别，假设它是水果，然后它的子类是 Apple、Lemon、Almonds 等。我想通过使用数组来尝试，但对 List 和 Hash 不太熟悉..请给我一些代码片段开始..感谢任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T16:19:07.950

可扩展列表视图很容易实现。您可以轻松地创建两个包含要添加到列表中的项目的数组。如需更多详细信息和深入了解可扩展列表视图的复杂性，您可以查看此链接： [简单可扩展列表视图示例](http://www.coderzheaven.com/2011/04/10/expandable-listview-in-android-using-simpleexpandablelistadapter-a-simple-example/)

此外，如果您需要创建自定义可扩展列表视图，那么您可以在此链接上找到一个很好的教程： [自定义可扩展列表视图](http://shenhengbin.wordpress.com/2012/03/25/android-practice-custom-expandablelistview-sample-2/)

# android - Android GCM time_to_live 问题

> ID：12354690
> 
> 赞同：9
> 
> 时间：2012-09-10T15:20:51.437
> 
> 标签：android, google-cloud-messaging, push-notification

我有一个与`time_to_live`. 我在设备打开时收到消息，但在设备离线时我没有收到消息，或者至少在前 15 分钟内没有发送消息。我在空闲为真和`time_to_live`2419200 时延迟发送消息。任何想法发生了什么，也许我误读了文档。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-11T07:02:43.397

从文档中：

> **delay_while_idle**：如果包含，表示如果设备空闲，则不应立即发送消息。服务器将等待设备变为活动状态，然后仅发送每个 collapse_key 值的最后一条消息。可选的。默认值为 false，并且必须是 JSON 布尔值。
> 
> **time_to_live**：如果设备离线，消息应该在 GCM 存储中保留多长时间（以秒为单位）。可选（默认生存时间为 4 周，并且必须设置为 JSON 数字）。如果使用此参数，还必须指定一个 collapse_key。

您不需要将 time_to_live 的值设置为 2419200。它是默认值。但是，如果您设置了它，您还应该设置 collapse_key。

> **collapse_key**：一个任意字符串（例如“Updates Available”），用于在设备离线时折叠一组类似消息，以便仅将最后一条消息发送到客户端。这是为了避免在手机重新联机时向手机发送太多消息。请注意，由于无法保证消息发送的顺序，因此“最后一个”消息实际上可能不是应用程序服务器发送的最后一条消息。有关此主题的更多讨论，请参阅高级主题。可选的，除非您使用 time_to_live 参数——在这种情况下，您还必须指定一个 collapse_key。

有关更多详细信息，请再次查看[教程](http://developer.android.com/guide/google/gcm/gcm.html)。

# php - Sonata Admin Bundle 和 Doctrine 问题：如何从反面更新实体？

> ID：12354694
> 
> 赞同：1
> 
> 时间：2012-09-10T15:21:02.703
> 
> 标签：php, symfony, doctrine-orm, sonata-admin

我有两个实体之间的多对多关系。让我们称之为 `User`And `Group`。

我已经决定在创建/更新界面上，因为它们可以关联，您可以直接将用户从组表单或组从用户表单关联起来。请注意，关系的拥有方是`User`

现在问题来了。如果我从用户表单界面关联组，一切都很好并且工作完美（教义寻找拥有方的变化）。如果我尝试`User`从组表单界面关联，则没有任何效果。

显然，我完全知道我必须将用户“添加”到组对象中，并将组（this）添加到我从表单传递的每个用户对象中。事实上这是我的代码片段到`Group`实体

```
public function setUsers(\Doctrine\Common\Collections\ArrayCollection $utente)
{
    /* snippet of code for removing old association , didn't reported */

    foreach($utente as $u){
        $this->users[] = $u;
        $u->addGroups($this);
    }
} 
```

进入创作形式这个片段做好他的工作。进入更新，它没有。
所以我想这一定是一首奏鸣曲问题，或者是我目前错过的东西。

有什么建议吗？

**更新**

在花了一些时间了解这里发生了什么之后，我发现它`setUser()`没有被调用到更新操作中（读作提交构建在现有实体上的表单）。所以我的代码只有在我创建新条目时才会运行（我仍然没有解决方案）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T10:50:03.633

我刚刚找到了如何更新实体。
我想这是与 Symfony2 相关的行为，而不是 Sonata Admin 的行为。

简而言之，你必须告诉 Symfony2 调用你想要更新的对象的 setter。

对于该用途：

```
by_reference => false 
```

在 Sonata Admin Bundle 案例中：

```
$formMapper
            ->add('nome')
            ->add('canali', 'sonata_type_model', array('required' => false))
            ->add('utenti', 'sonata_type_model', array('required' => false,
                                                       'by_reference' => false))
        ; 
```

在纯 Symfony2 Form 案例中：

```
->add('utenti', 'collection', array(
                'type' => new User(),
                'allow_add' => true,
                'allow_delete' => true,
                'prototype' => true,
                'by_reference' => false,
            ))
        ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T06:23:33.343

不清楚你的意思是更新它不能很好地工作。根据您的代码，我假设它会在用户和组之间添加新关系，但不会删除旧关系。

```
public function setUsers(\Doctrine\Common\Collections\ArrayCollection $utente)
{
    // to synch internal and external collections, remove relation between users and groups if user is not in the new collection
    foreach ($this->users as $u) {
        if (!$utente->contains($u)) {
            // add this function to user object, it's trivial, just remove give group from internal groups collection
            $u->removeGroup($this); 
        }
    }
    foreach ($utente as $u) {
        if (!$this->users->contains($u)) {
            $this->users[] = $u;
            $u->addGroups($this);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-30T11:54:00.657

尝试将以下内容添加到您的管理类

```
public function prePersist($group)
{
    $group->setUsers($group->getUsers());
    parent::prePersist($testQuestion);
}

public function preUpdate($group)
{
    $group->setUsers($group->getUsers());
    parent::preUpdate($testQuestion);
} 
```

# sql - SQL 中 DateTime 字段的时间部分

> ID：12354699
> 
> 赞同：55
> 
> 时间：2012-09-10T15:21:28.803
> 
> 标签：sql, sql-server, sql-server-2008, tsql, datetime

如何在 SQL 中提取 DateTime 字段的时间部分？对于我的项目，无论日期是什么，我都必须返回 DateTime 字段的时间戳为下午 5 点的数据

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-09-10T15:23:50.110

这将返回 time-Only

对于 SQL Server：

```
SELECT convert(varchar(8), getdate(), 108) 
```

**解释：**

`getDate()`正在给出当前日期和时间。
`108`正在格式化/给我们所需的部分，即在这种情况下的时间。
`varchar(8)`给我们该部分的字符数。
**喜欢：**
如果你在`varchar(7)`那里写，它会给你`00:00:0`
如果你在`varchar(6)`那里写，它会给你`00:00:`
如果你在那里写`varchar(15)`，它仍然会给你，`00:00:00`因为它只给出时间部分的输出。 `[SQLFiddle Demo](http://sqlfiddle.com/#!6/d41d8/236)`

~~对于 MySQL：~~

 ~~```
SELECT DATE_FORMAT(NOW(), '%H:%i:%s') 
```~~ 

~~`[~~SQLFiddle Demo~~](http://sqlfiddle.com/#!2/d41d8/1880)`~~

 ~~* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-09-10T15:26:23.410

在 SQL Server 中，如果您只需要`hh:mi`，您可以使用：

```
DECLARE @datetime datetime

SELECT @datetime = GETDATE()

SELECT RIGHT('0'+CAST(DATEPART(hour, @datetime) as varchar(2)),2) + ':' +
       RIGHT('0'+CAST(DATEPART(minute, @datetime)as varchar(2)),2) 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2012-09-10T15:24:37.857

如果您只想要日期时间的小时，那么您可以使用`DATEPART()`- SQL Server：

```
declare @dt datetime
set @dt = '2012-09-10 08:25:53'

select datepart(hour, @dt) -- returns 8 
```

在 SQL Server 2008+ 中，您可以`CAST()`：

```
declare @dt datetime
set @dt = '2012-09-10 08:25:53'

select CAST(@dt as time) -- returns 08:25:53 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-09-10T17:56:59.263

在 SQL Server 2008 中试试这个：

```
select *
from some_table t
where convert(time,t.some_datetime_column) = '5pm' 
```

如果您想获取一个随机的日期时间值并对其进行调整以使时间部分为下午 5 点，那么在 SQL Server 2008 中有多种方法。首先，您需要一天的开始（例如，2011-09-30 00:00:00.000）。

*   适用于所有版本的 Microsoft SQL Server 以及所有版本的 Sybase 的一种技术是`convert/3`将 datetime 值转换为缺少时间组件的 varchar，然后再转换回 datetime 值：

    ```
    select convert(datetime,convert(varchar,current_timestamp,112),112) 
    ```

以上为您提供了当天的开始时间。

*   但是，在 SQL Server 2008 中，您可以这样说：

    ```
    select start_of_day =               t.some_datetime_column
                        - convert(time, t.some_datetime_column ) ,
    from some_table t 
    ```

    这可能更快。

一旦你开始了一天，到下午 5 点就很容易了。只需将 17 小时添加到您的开始时间值：

```
select five_pm = dateadd(hour,17, t.some_datetime_column
                   - convert(time,t.some_datetime_column)
                   )
from some_table t 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-11-11T09:12:37.953

我知道这是一个老问题，但由于其他答案都是

*   返回字符串（而不是日期时间），
*   依赖日期的内部表示（转换为 float、int 和 back）或
*   需要 SQL Server 2008 或更高版本，

我想我会添加一个“纯”选项，它只需要日期时间操作并适用于 SQL Server 2005+：

```
SELECT DATEADD(dd, -DATEDIFF(dd, 0, mydatetime), mydatetime) 
```

这将计算日期零 (1900-01-01) 和给定日期之间的差异（以天为单位），然后从给定日期中减去该天数，从而将其日期部分设置为零。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-06-18T10:53:40.137

请注意，从 MS SQL 2012 起，您可以使用`FORMAT(value,'format')`

例如`WHERE FORMAT(YourDatetime,'HH:mm') = '17:00'`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-09-10T16:08:52.330

“对于我的项目，无论日期是什么，我都必须返回 DateTime 字段的时间戳为下午 5 点的数据。”

所以我认为你的意思是你需要日期，而不是时间。您可以执行以下操作来获取以 5:00 为时间的日期：

```
SELECT CONVERT(VARCHAR(10), GetDate(), 110) + ' 05:00:00' 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-07-15T18:12:33.470

这应该去掉日期部分：

```
select convert(datetime,convert(float, getdate()) - convert(int,getdate())), getdate() 
```

并返回默认日期为 1900-01-01 的日期时间。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-04-30T14:41:04.610

您可以`CONVERT(TIME,GETDATE())`在这种情况下使用：

```
INSERT INTO infoTbl
(itDate, itTime)
VALUES (GETDATE(),CONVERT(TIME,GETDATE())) 
```

或者如果你想打印它或返回那个时间，像这样使用：

```
DECLARE @dt TIME
SET @dt = CONVERT(TIME,GETDATE())
PRINT @dt 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-10-10T14:21:20.997

选择演员（getdate（）作为时间（0））

例如返回：- 15:19:43

将 getdate() 替换为您要从中提取时间的日期时间！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-02-25T07:33:27.973

```
SELECT DISTINCT   
                 CONVERT(VARCHAR(17), A.SOURCE_DEPARTURE_TIME, 108)  
FROM  
      CONSOLIDATED_LIST AS A  
WHERE   
      CONVERT(VARCHAR(17), A.SOURCE_DEPARTURE_TIME, 108) BETWEEN '15:00:00' AND '15:45:00' 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-03-28T17:58:36.217

年份：

```
SELECT DATEPART(YEAR, '2021-03-21' ); 
```

小时：

```
SELECT DATEPART(HOUR, '2021-03-21 08:50:30' ); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-09-22T09:34:34.097

```
declare @datetime as datetime
set @datetime = getdate()
select cast(cast(@datetime as time) as varchar(8)) 
```~~

# javascript - 如何使用 Windows 8 JSON.parse 将 JSON 文本反序列化为日期类型？

> ID：12354702
> 
> 赞同：2
> 
> 时间：2012-09-10T15:21:29.107
> 
> 标签：javascript, json, windows-8

我正在使用 JSON Web 服务的 HTML5/JavaScript 中构建一个 Windows 8 Metro 应用程序（又名“现代 UI 样式”或“Windows 商店应用程序”），我遇到了以下问题：**我的 JSON Web 服务应该以哪种格式序列化Windows 8 Metro *JSON.parse*方法的日期以反序列化日期类型中的日期？**

我试过：

*   [使用ISO-8601 格式](http://en.wikipedia.org/wiki/ISO_8601)发送日期，（JSON.parse 返回一个字符串），
*   发送日期，如“/Date(1198908717056)/”，如此[处所述](http://weblogs.asp.net/bleroy/archive/2008/01/18/dates-and-json.aspx)（结果相同）。

我开始怀疑 Windows 8 的 JSON.parse 方法是否支持日期，因为即使解析其自己的 JSON.stringify 方法的输出也不返回日期类型。

例子：

```
 var d = new Date(); // => a new date
    var str = JSON.stringify(d); // str is a string => "\"2012-07-10T14:44:00.000Z\""
    var date2 = JSON.parse(str); // date2 is a string => "2012-07-10T14:44:00.000Z" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T15:40:22.507

以下是我如何以通用方式实现此功能（尽管我宁愿找到 Windows 8 的 JSON.parse 方法支持的开箱即用格式）：

在服务器上，我正在使用以下命令序列化我的字符串：

```
date1.ToString("s"); 
```

这使用始终相同的 ISO 8601 日期格式，无论使用何种文化或提供的格式提供程序（[有关更多信息，请参见此处](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx)）。

在客户端，我为 JSON.parse 指定了一个“reviver”回调，它使用正则表达式查找日期并将它们自动转换为日期对象。

最后，反序列化的对象将包含实际的 JavaScript 日期类型，而不是字符串。

这是一个代码示例：

```
 var responseResult = JSON.parse(request.responseText, function dateReviver(key, value) {
if (typeof value === 'string') {
    var re = /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)$/
    var result = re.exec(value);
    if (result) {
        return new Date(Date.UTC(+result[1], +result[2] - 1, +result[3], +result[4],+result[5], +result[6]));
    }
}); 
```

希望这会有所帮助，卡尔

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T18:20:52.427

这不是 Windows 8 独有的`JSON.parse`——它是[ECMA 标准 JSON 解析器](https://developer.mozilla.org/en-US/docs/Using_native_JSON)的设计行为。因此，日期没有（并且可能）没有“开箱即用的支持”。

根据[规范](http://json.org/)，JSON 值只能是字符串、数字、布尔值、数组、对象或`null`. **不支持日期。** （IMO，这是对规范的疏忽，但这是我们必须忍受的。）

由于没有日期类型，您的应用程序必须自己解决如何处理日期。处理此问题的最佳方法是将日期发送为 ISO 8601 字符串 (yyyy-MM-dd'T'HH:mm:ss'Z') 或自纪元以来的毫秒数（1970 年 1 月 1 日 00:00:00 UTC）。这里的重要部分是确保时间是 UTC。

如果性能很重要，我**不会**使用带有`JSON.parse`. [我做了很多测试](http://jsperf.com/json-date-parsing-methods)，为对象中的每个属性调用函数所涉及的开销将性能降低**了一半**。

另一方面，我真的很惊讶针对每个字符串值测试正则表达式与仅解析已知属性名称相比的效果如何。只需确保*在循环之外*定义一次正则表达式！

显然，将 JSON 值转换为日期的绝对最快的方法是，如果您确切知道需要为日期解析哪些属性。但是，鉴于基于正则表达式的搜索方法的出色性能，我认为不值得额外的复杂性，除非您真的需要额外的性能。

关于使用 ISO 字符串与自纪元以来的毫秒数的说明：独立测试，[毫秒胜出](http://jsperf.com/date-instantiation-iso-string-vs-ticks)。在 IE 中，没有区别，但 Firefox 似乎确实在处理 ISO 字符串。另请注意，`Date`构造函数在所有浏览器中都需要毫秒。它也需要一个 ISO 字符串，但不是 IE ≤ 8。

# tfs - TFS 签入误报？

> ID：12354703
> 
> 赞同：0
> 
> 时间：2012-09-10T15:21:32.227
> 
> 标签：tfs, tfs-power-tools

这就是我所做的：

1.  签入更改
2.  回滚更改（TFS 检出文件并恢复原始状态，但保持文件检出）。目前很好。
3.  我将所有文件签入到它们的回滚状态，除了 web.config。
4.  我验证 web.config 是我希望它的外观，然后将其签入。

星期一进来，意识到我的零钱不在那里。除了我的回滚之外，该文件没有任何历史记录。

我不排除人为错误，但 TFS 是否存在已知的误报签到问题？

我通常使用 TFS 电动工具并从资源管理器中签入（例如，我喜欢返回的消息框并显示“您的变更集编号为 1000”。）

星期五是忙碌的一天，我不记得我是如何签到的（IDE 或 explorer Power 工具）。然而，这次登记在我的脑海中没有任何异常突出。

没有运气谷歌搜索“TFS 已知问题”和“TFS 误报”，所以我的查询必须关闭，或者它按预期工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T16:30:53.553

没有您描述的已知问题。

使用本地工作区，您所做的任何更改都应该仍然在您的系统上，即使您没有将它们签入。

# css - Sprockets + Less @import 问题？

> ID：12354705
> 
> 赞同：1
> 
> 时间：2012-09-10T15:21:39.957
> 
> 标签：css, ruby, less, assets, sprockets

它没有找到我的@import 文件。如果我对它们使用 //=require ，它将不会跟踪我在其他文件中定义的变量，因此 @import 是唯一的选择。

我什至尝试过使用完整的物理路径，例如 @import "/Users//Sites/project/stylesheets/test.less"; 它仍然找不到文件。

它们在同一个目录中...

Sprockets + LESS 似乎有一个奇怪的问题。

我没有使用 RAILS，只是一个带链轮的基本机架服务器......

`Less::ParseError: 'activity.less' wasn't found. (in /Users/rountrjf/Sites/ce-platform/app/assets/stylesheets/app.less)`

有谁知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T16:56:24.277

我发现的一个快速修复是在导入时给出文件的相对路径

例如：

```
@import "app/assets/stylesheets/app.less"; 
```

它对我有用。

**更新**：我发现的正确灵魂是：

使用这个[无链轮的](https://github.com/lloeki/sprockets-less)宝石

像魅力一样工作，不需要相对路径

[在这里](https://gist.github.com/3693101)查看我的示例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T16:59:24.547

您是将文件命名为 .css.less 还是仅命名为 .less？尝试添加 .css.less，这是我发现需要使用 Rails 资产管道（链轮）做的事情。由于您没有使用导轨，因此此解决方案也可能适用于您，因为您使用的是链轮。

# ios - 切换uitextf时停止键盘关闭

> ID：12354723
> 
> 赞同：0
> 
> 时间：2012-09-10T15:22:37.943
> 
> 标签：ios, uitextfield, becomefirstresponder

我正在使用一个带有一个部分和五个单元格的 uitableview，每个 tableCell 上有两个不同的 uitextfields。

我的问题是：当用户在第一个表格行的第一个文本字段上标签时，键盘出现，然后用户点击第二个文本字段。键盘DISMISS和SHOW。

那么当用户在文本字段上切换焦点时，如何保持键盘而不是 DISMISS 和 SHOW 呢？

谢谢。

**第一次编辑：** 很抱歉对此的回复晚了，这里显示的代码有点复杂。我不会在任何 textField 委托方法中放弃FirstResponder/becomeFirstResponder。您能否提出任何想法。感谢你的帮助。

**第二次编辑：** 对不起我的错误，我完全误解了我的问题。我会在一分钟内重新链接这里的新帖子。

**第三次编辑：** [这是我的新问题](https://stackoverflow.com/questions/12356814/stop-popoverviewcontroller-resignfirstresponder-after-dismissed)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T16:48:57.287

通常，当您切换字段时，键盘不会自行关闭。
如果您正在使用文本字段委托并通过 resigningFirstResponder 响应“editingDidEnd”，那么您将看到该行为。

如果是这样的话，在你离开该字段后，它正在调用其中一个方法并退出键盘，然后当你触摸另一个字段时，它正在调用 firstResponder。

因此，请查找一些代码，在其中设置文本字段委托以调用文本字段选择器方法之一。找到正在调用的方法，看看它是否是 resigingFirstResponder。

如果是，那么您可能需要将其删除或将其包装在一些适当的逻辑中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:42:44.240

这应该对你有用......只是我的猜测工作，因为你没有发布任何代码：

```
-(BOOL)textFieldShouldReturn:(UITextField *)textField 
{
    if(textField == firstTextfield)
    {
        if([[firstTextfield stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceCharacterSet]] length] == 0)
        return NO;

        [firstTextfield resignFirstResponder];
        [secondTextField becomeFirstResponder];

        return YES;
     }

     else if(textField == secondTextField)
     {
         //Anything u want here
         return YES;
     }
    return NO;
 } 
```

# android - Android如何捕获搜索键

> ID：12354725
> 
> 赞同：1
> 
> 时间：2012-09-10T15:22:47.920
> 
> 标签：android, search, key, onkeydown

在旧版本中，我能够捕捉到搜索键

`(keyCode == KeyEvent.KEYCODE_SEARCH)`

当我使用 onKeyDown 方法时。但是现在随着新版本的android它不再工作了。还有另一种可能来捕捉搜索键吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T16:12:51.973

也许您需要改写[Activity.onSearchRequested()](http://developer.android.com/reference/android/app/Activity.html#onSearchRequested%28%29)？

# jquery - jQuery 验证 .after()

> ID：12354726
> 
> 赞同：0
> 
> 时间：2012-09-10T15:22:48.957
> 
> 标签：jquery, jquery-validate

我希望能够在 $("form").validate 期间将星号添加到文本框的末尾。我可以用 $(element).after(" *"); 但是如果键入的文本或条目正确，我该如何优雅地删除它。jQuery dosent 有一个 $(element).remove("* "); 对此的任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:30:25.107

您可以尝试将其放入一个元素中，然后将其删除：

```
$(element).after('<span id="remove_me">*</span>'); 
```

并用它来删除它

```
$('#remove_me').remove(); 
```

您还可以让元素已经存在但用 css 隐藏，`display:none;`然后`.show()`在验证表单需要它时使用它来显示它并`.hide()`删除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:30:08.683

**html**

```
<input type="text" /><span id="error">*</span> 
```

**css**

```
#error { display:none; } 
```

**js**

```
if( valid ) ? $('#error').hide() : $('#error').show(); 
```

就像评论说的那样，您可以通过任何`js`事件检查此验证；最受欢迎的可能是`keyup`或在表格上`submit`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T15:33:52.693

举个例子，您必须在需要时在验证中插入添加和删除：

[jsfiddle](http://jsfiddle.net/dReqD/)

```
$('.required').on('click', function() {
    $(this).next().remove();
}).after('<span>*</span>'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T15:34:44.777

检查此解决方案

```
$('#btn1').on('click', function() {
    $('.error').remove();
    $('#txt1').after('<span class="error">*</span> ');
    hideError();
});

$('#txt1').on('change', function() {
    hideError();
});

function hideError() {
    if ($('#txt1').val() == 'hello') {
        $('.error').hide();
    }

} 
```

检查此[FIDDLE](http://jsfiddle.net/sushanth009/cwAEA/1/)以获取工作示例..​</p>

# sql - 查找产品占客户总数的百分比

> ID：12354727
> 
> 赞同：1
> 
> 时间：2012-09-10T15:22:49.713
> 
> 标签：sql, sql-server, select, percentage

我有一个 sql 表，它有 2 列用户 ID 和产品，用户 ID 是唯一的，而产品将有 3 个值 [0,1,-1] -1 代表没有购买产品，1 代表当前正在使用的产品，而 0 代表产品已经用过的。

我想要的是对表
产品中使用的总用户的百分比查询（％）：？
目前使用的产品（%）： ?
产品未售出（%）：？

任何建议或帮助将不胜感激谢谢

![在此处输入图像描述](../Images/62526b2cf187c8026166232e451796aa.png)
到目前为止我尝试了什么？

```
Select count(userId) * 100 / (select count(products) Where products = 1) AS perc 
from product group by userid 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T15:29:17.823

试试这个：

```
SELECT SUM(CASE WHEN products = 1 THEN 1 ELSE 0 END) * 100   /
Count(DISTINCT Products.UserID) AS 'Currently used products%',
SUM(CASE WHEN products = 0 THEN 1 ELSE 0 END) * 100   /
Count(DISTINCT Products.UserID) As 'Used products%',
SUM(CASE WHEN products = -1 THEN 1 ELSE 0 END) * 100   /
Count(DISTINCT Products.UserID) AS 'Not sold products%'
FROM Products 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:48:43.457

```
SELECT SUM(CASE WHEN Products = 1 THEN 1 ELSE 0 END) * 100 
       / COUNT(DISTINCT UserID) AS product_currently_in_use_pct
     , SUM(CASE WHEN Products = 0 THEN 1 ELSE 0 END) * 100 
        / COUNT(DISTINCT UserID) AS product_used_pct
     , SUM(CASE WHEN Products = -1 THEN 1 ELSE 0 END) * 100 
       / COUNT(DISTINCT UserID) AS product_not_sold_pct
  FROM MyTable 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T15:45:59.400

```
SELECT products,
(convert(numeric(5,2),count(products))/(SELECT convert(numeric(5,2),count(products)) FROM product)) * 100
AS "Percentage"
FROM product GROUP BY products 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T16:04:50.990

你也可以这样试试。

[小提琴](http://sqlfiddle.com/#!2/2cf0b/7)

```
select count(*) total
,count(p1.products)/count(*)*100 as currentlyused
,count(p2.products)/count(*)*100 as used
,count(p3.products)/count(*)*100 as not_sold

from products p
left join products p1 on p1.products=1 and p1.id=p.id
left join products p2 on p2.products=0 and p2.id=p.id
left join products p3 on p3.products=-1  and p3.id=p.id 
```

# jquery - jQuery Mobile 触发页面刷新（phonegap）

> ID：12354728
> 
> 赞同：0
> 
> 时间：2012-09-10T15:22:51.180
> 
> 标签：jquery, jquery-mobile

我在 Phonegap 应用程序中使用 jQuery Mobile 1.1.1。

我正在尝试触发我正在使用的当前页面的重新加载。用户在页面的一部分中删除了某些内容，它会影响页面的另一部分。因此，重新加载。

我遇到了一些建议，但到目前为止没有任何效果。

```
$.mobile.changePage( '#shopping-list', { allowSamePageTranstion: true, reloadPage: true, transition:"none" }); 
```

上面的代码将不起作用，因为它们不是单独的 HTML 页面，因此不会执行 reloadPage。我需要通过“pageshow”将页面推回。

提前致谢！

缺口

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T01:50:14.333

为了重新加载页面，您可以尝试使用：

```
$(location).attr('href',"your_html.html"); 
```

（`your_html`包含您的页面的 HTML 文件在哪里`#shopping-list`）而不是：

```
$.mobile.changePage( '#shopping-list', { allowSamePageTranstion: true, reloadPage: true,transition:"none" }); 
```

但是，如果您使用此解决方案，我建议您在 HTML 文件中只有一页`your_html`，即：`#shopping-list`.

希望这对您有所帮助。

你可以问我问题。

# javascript - d3.js：限制画笔大小

> ID：12354729
> 
> 赞同：6
> 
> 时间：2012-09-10T15:22:51.860
> 
> 标签：javascript, range, scale, d3.js, brush

有没有办法限制画笔的大小，即使范围更大？

我把只有一个可以移动和调整大小的 x 比例的画笔放在一起。我希望能够限制用户可以调整大小的程度（基本上只能到某个点）。

在以下示例中，当画笔大于最大范围的一半时，画笔功能停止更新。但是，刷子本身仍然可以扩展。有没有办法防止这种情况发生？或者有没有更好的方法来处理这个？

非常感谢！

在此处查看此代码：http: [//bl.ocks.org/3691274](http://bl.ocks.org/3691274)（**编辑**：此演示现在有效）

```
bar = function(range) {

      var x_range = d3.scale.linear()
          .domain([0, range.length])
          .range([0, width]); 

      svg.selectAll("rect.items").remove();

      svg.selectAll("rect.items")
          .data(range)
        .enter().append("svg:rect")
          .attr("class", "items")
          .attr("x", function(d, i) {return x_range(i);})
          .attr("y", 0)
          .attr("width",  width/range.length-2)
          .attr("height", 100)
          .attr("fill", function(d) {return d})
          .attr("title", function(d) {return d});
}

var start = 21;
bar(data.slice(0, start), true);

var control_x_range = d3.scale.linear()
    .domain([0, data.length])
    .range([0, width]); 

controlBar = svg.selectAll("rect.itemsControl")
    .data(data)
  .enter().append("svg:rect")
    .attr("class", "itemsControl")
    .attr("x", function(d, i) {return control_x_range(i);})
    .attr("y", 110)
    .attr("width",  width/data.length-2)
    .attr("height", 20)
    .attr("fill", function(d) {return d});

svg.append("g")
    .attr("class", "brush")
    .call(d3.svg.brush().x(d3.scale.linear().range([0, width]))
    .extent([0,1*start/data.length])
    .on("brush", brush))
  .selectAll("rect")
    .attr("y", 110)
    .attr("height", 20);

function brush() {
    var s = d3.event.target.extent();

    if (s[1]-s[0] < 0.5) {
        var start = Math.round((data.length-1)*s[0]);
        var end = Math.round((data.length-1)*s[1]);

        bar(data.slice(start,end));
    };

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T08:53:51.397

我最终通过在超过大小时将画笔重新绘制到其最大允许大小来解决它：

```
function brush() {
    var s = d3.event.target.extent();
    if (s[1]-s[0] < 0.5) {
        var start = Math.round((data.length-1)*s[0]);
        var end = Math.round((data.length-1)*s[1]);

        bar(data.slice(start,end));
    }
    else {d3.event.target.extent([s[0],s[0]+0.5]); d3.event.target(d3.select(this));}
} 
```

演示：[http ://bl.ocks.org/3691274](http://bl.ocks.org/3691274)

我仍然有兴趣阅读更好的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-08-03T07:07:54.637

这是使用 d3.v4 和 ES6 的另一种策略：

```
brush.on('end', () => {
    if (d3.event.selection[1] - d3.event.selection[0] > maxSelectionSize) {
        // selection is too large; animate back down to a more reasonable size
        let brushCenter = d3.event.selection[0] + 0.5 * (d3.event.selection[1] - d3.event.selection[0]);
        brushSel.transition()
            .duration(400)
        .call(brush.move, [
            brushCenter - 0.49 * maxSelectionSize,
            brushCenter + 0.49 * maxSelectionSize
        ]);
    } else {
        // valid selection, do stuff
    }
}); 
```

如果当用户放开画笔选区时画笔选区过大，它会以动画方式返回到指定的最大尺寸 ( `maxSelectionSize`)。此时，`'end'`事件将再次触发，并具有可接受的选择大小。

注意`0.49`标量：这是防止浮点/舍入错误所必需的，如果画笔`move()`的尺寸*仍然*太大，可能会导致无限循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-20T14:29:41.450

这是限制画笔的最小宽度为 100px 和最大宽度为 200ps 的示例。我在 d3.v4.js 中添加了几行，用于设置画笔宽度的限制。

添加了 Brush.limit([min, max]) 来设置限制：

```
var _limit = null;
brush.limit = function (l) {
  _limit = l;
} 
```

在 move() 函数中中断鼠标移动事件：

```
if (_limit && e1 - w1 < _limit[0]) {
  return;
} 
```

（[演示](https://s3-us-west-2.amazonaws.com/s.hoebus.idv.tw/examples/brush-min-width/index.html)）（[源代码](https://github.com/yihua1218/learn-d3js/tree/master/brush-min-width)）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-05-29T21:55:49.450

一段不错的代码，但我发现了一个小错误。它会在任何时候锁定你的画笔`s[1]-s[0] < 0.5`，但是如果你一直按下调整大小并将所有画笔移到相反的方向，它就会开始“移动”画笔而不做任何动作（即它的行为不应该如此）。

我很确定我能想出一个合理的解决方案。如果是这样，我会在这里重新发布。

（很抱歉在这里发布它作为答案，但由于您已经回答过一次，我想我不能发表评论）。

# c# - 如何编写对 XElement 的简单查询？

> ID：12354735
> 
> 赞同：0
> 
> 时间：2012-09-10T15:23:24.567
> 
> 标签：c#, linq-to-xml

第一次尝试使用 Linq to XML 并遇到一些问题。我有这个 XML 文件需要读取并用于各种任务。该文件包含一个名为“接口”的实体列表。首先，我想显示这些接口的名称列表。

这是 XML 文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<InterfaceList>
  <Interface>
    <InterfaceName>Account Lookup</InterfaceName>
    <RequestXSD>ALREQ.xsd</RequestXSD>
    <ResponseXSD>ALRES.xsd</ResponseXSD>
  </Interface>
  <Interface>
    <InterfaceName>Balance Inquiry</InterfaceName>
    <RequestXSD>BIREQ.xsd</RequestXSD>
    <ResponseXSD>BIRES.xsd</ResponseXSD>
  </Interface>
</InterfaceList> 
```

下面是查询代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Xml.Linq;

namespace Stub {
    public class InterfaceList : XElement {

        public void GetInterfaceNameList() {
            var v = from interface in this.Elements("Interface")
                select interface.Element("InterfaceName").Value;
        }
    }
} 
```

这个想法是从文件中加载 InterfaceList，然后使用它来查询我可能需要的任何内容。问题是我收到查询中所有内容的错误消息。这里有几个：

*   错误 14 当前上下文中不存在名称“from”
*   错误 15 找不到类型或命名空间名称“select”（您是否缺少 using 指令或程序集引用？）错误
*   错误 16“System.Xml.Linq.XElement.Value”是“属性”，但用作“类型”

这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:29:49.917

如果你想调用你的变量“接口”（这是一个保留字），你需要将它转义，如下所示：

```
var v = from @interface in this.Elements("Interface")
        select @interface.Element("InterfaceName").Value; 
```

可能最好只是重命名它....

# c++ - 如何在 WinRT 中的 C++ 中创建新的 GUID？

> ID：12354737
> 
> 赞同：4
> 
> 时间：2012-09-10T15:23:28.793
> 
> 标签：c++, windows-runtime

C++ WinRT中的 C# 方法[Guid.NewGuid()的等价物是什么？](http://msdn.microsoft.com/en-us/library/system.guid.newguid.aspx)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T15:26:17.823

我相信你在寻找[http://msdn.microsoft.com/en-us/library/windows/desktop/ms688568%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms688568%28v=vs.85%29.aspx)

```
CoCreateGuid(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-10T15:50:00.787

如果您正在编写 Windows Store 应用程序（也称为 Metro Style），则必须使用[CoCreateGuid](http://msdn.microsoft.com/en-us/library/windows/desktop/ms688568%28v=vs.85%29.aspx)，因为[UuidCreate](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379205%28v=vs.85%29.aspx)仅适用于桌面应用程序。

来自 MSDN：

**CoCreateGuid：**

> 适用于：桌面应用程序 | Windows 应用商店应用程序
> 创建一个 GUID，一个用于 CLSID 和接口标识符的唯一 128 位整数。

```
HRESULT CoCreateGuid(  _Out_  GUID *pguid ); 
```

**Uuid创建：**

> 适用于：仅桌面应用程序

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-10T15:29:18.353

我知道关于 Windows 8 的杰克，但如果您仍然可以访问常规的 Win32/64 API，您可以为此使用许多机制。`UuidCreate`rpcrt4 库中的 ()是一个，oleaut 库中的`CoCreateGuid`() 是另一个（仅转发到前者）。后者具有最后将结果直接放入 GUID 结构的优点。

# symfony - 不需要电子邮件用户

> ID：12354738
> 
> 赞同：5
> 
> 时间：2012-09-10T15:23:45.213
> 
> 标签：symfony, fosuserbundle

我想在我的用户实体上将电子邮件设置为不需要。怎么办？我在 FOSUserBundle/config/ 中进行了搜索，但没有找到任何关于电子邮件的“必需”参数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T12:11:40.233

按照 Tib 的回答，这就是我的做法。它工作正常：

```
/**
 * User
 *
 * @ORM\Table(name="user")
 * @ORM\Entity
 * @ORM\AttributeOverrides({
 *      @ORM\AttributeOverride(name="email", column=@ORM\Column(type="string", name="email", length=255, unique=false, nullable=true)),
 *      @ORM\AttributeOverride(name="emailCanonical", column=@ORM\Column(type="string", name="email_canonical", length=255, unique=false, nullable=true))
 * })
 */
class User extends BaseUser {
    // ...
} 
```

# 编辑 ：

以前的解决方案很容易实现并且运行良好，但是在将 Symfony 更新到版本 2.1.8 并且没有更改我的应用程序中的任何内容后，生成实体失败并抛出 Doctrine 映射异常（无效的字段覆盖......）

尽管浪费了很多时间试图解决这个问题，但我还是被困住了。

然后我终于意识到 FOSUserBundle 提供了很多我不使用的功能，但并不能真正满足我的需求，这些功能非常基本。

我需要禁用电子邮件要求，因为我的应用程序用户管理是“类似软件”：没有注册，没有电子邮件发送，没有配置文件，用户和角色仅由管理员管理，等等......

我正在调整一个不是为我的需要而设计的工具。所以我决定自己实现 Symfony 安全性。

工作量有点大，但难度不是很大，而且结果比适配 FOSUserBundle 要好得多，也更灵活。当然，对于“经典”网站或 Web 应用程序，FOSUserBundle 是最好的。

如果你也是这种情况，我建议你这样做。这是开始的文档：[书中的](http://symfony.com/doc/current/book/security.html)安全性[和食谱中的安全性](http://symfony.com/doc/current/cookbook/security/index.html)

我希望这可以帮助你。

*对不起我的英语不好，我希望它是可以理解的*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T14:48:46.340

检查此 PR [https://github.com/doctrine/orm-documentation/pull/117/files](https://github.com/doctrine/orm-documentation/pull/117/files)并查看@AttributeOverrides

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-09-10T21:29:54.623

您需要覆盖实体用户中的以下方法。

```
class User extends BaseUser // inheritance from fos
{
   /**
   * @var string
   * @ORM\column(type="string", name="email", length=255, unique=true, )
   * @Assert\Email(
   *     checkMX = true
   * )*/
   protected $email
}
} 
```

您需要将表定义更改为：

```
class User extends BaseUser // inheritance from fosUserBundle
    {
       /**
       * @var string
       * @ORM\column(type="string", name="email", length=255, unique=false, nullable=true )
       */
       protected $email
    }
} 
```

emailCanonical 属性也需要同样的东西。

如果那不通过。您需要将整个模型从 FOS 复制到您的捆绑包中，然后按照我的说明进行更改。

检查文档：[https ://github.com/FriendsOfSymfony/FOSUserBundle/blob/1.2.0/Resources/doc/doctrine.md](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/1.2.0/Resources/doc/doctrine.md)

问候马克斯

# java - 使用 JConsole 查找 JMX 服务器 URL

> ID：12354740
> 
> 赞同：0
> 
> 时间：2012-09-10T15:23:49.900
> 
> 标签：java, jmx

我在以编程方式连接到本地 JMX 服务器时遇到问题。我仔细检查了 JMX 服务器，它似乎很好，但我仍然无法连接。

但是，使用 JConsole，我没有问题。

无论如何可以从 JConsole 中找到正确的服务器 URL 吗？

顺便说一下，这是我要连接的服务器：

```
String jmxServer = "service:jmx:rmi:///jndi/rmi://localhost:" + DEFAULT_PORT + "/jmxrmi"; 
```

这些是我启动进程的 JVM 选项：

```
-Dcom.sun.management.jmxremote
-Dcom.sun.management.jmxremote.port=DEFAULT_PORT
-Dcom.sun.management.jmxremote.authenticate=false
-Dcom.sun.management.jmxremote.ssl=false 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T12:03:00.707

在您的代码中，您并打印出系统属性

`com.sun.management.jmxremote.localConnectorAddress`

这应该给你本地连接器地址。

然后从你的客户那里得到类似的东西

```
final JMXServiceURL jmxURL = new JMXServiceURL(localConnectorAddress);
final JMXConnector connector = JMXConnectorFactory.connect(jmxURL);
final MBeanServerConnection mbsc = connector.getMBeanServerConnection(); 
```

应该这样做......（做得很好，就像我做的那样）

# objective-c - 带有绿色的自定义 UItabBarItem

> ID：12354741
> 
> 赞同：-1
> 
> 时间：2012-09-10T15:23:54.723
> 
> 标签：objective-c, ios

我想在我的标签栏按钮（项目）上放一个绿色图像。我可以这样做还是苹果禁止这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:28:05.160

Apple 并没有禁止它，自 iOS5 开始使用 UIAppearance 协议鼓励它。我建议查看 WWDC 2011 和 2012 的“外观定制”视频。

# c++ - 在可执行文件中实现静态方法是否安全，该方法已经在共享库中实现？

> ID：12354742
> 
> 赞同：2
> 
> 时间：2012-09-10T15:23:57.717
> 
> 标签：c++, unit-testing, mocking

我们在代码中使用了很多共享库。在这种特殊情况下，在这些库之一中实现了一个静态方法。我们在代码的不同位置调用此方法。但是，如果我们想测试，我们想隔离进程，所以模拟该方法的实现。

我们正在考虑这样做的方式是通过在测试二进制文件中重新实现该方法。然后，这将确保我们的实现被采用而不是 lib 中的实现。

这里的主要问题是：这是纯粹的邪恶吗？如果是这样，这种情况下的首选解决方案是什么？

一个例子...

共享库的标头：

```
static const bool theMethod(...); 
```

共享库中方法的实现：

```
static const bool theMethod(...){
  //The real implemetation does some fancy stuff here
  return theRealValue;
} 
```

我们的测试用例：

```
#include <headerOfTheMethod.hpp>

//Our own "mocked" implementation
static const bool theMethod(...){
  return true; //Lets say we always return true for the purpose of our test
}

//Here comes our code testing the class which is using that particular method 
```

旁注：我们使用 gcc 作为编译器，库是动态链接的。

更新： *如果这适用于静态方法。这将是一个很好的开始，但如果它是一个类的成员函数会发生什么？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T16:24:16.343

是的，它是安全的，只要：

1.  您的方法与您在外部覆盖的方法相同
2.  您可以避免链接器错误。检查您的编译器文档，但应该有一种方法可以将符号设置为“弱”，因此它不会抱怨多个定义。这是为了测试目的而覆盖系统库中的函数以挂钩调用的标准方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T15:30:50.230

您将违反[单一定义规则](http://en.wikipedia.org/wiki/One_definition_rule)。链接器的工作方式可能对您有用，但这是一场赌博，无法保证。

# gzip - 当源文件是.gz 时，你应该如何编写准备阶段？

> ID：12354743
> 
> 赞同：0
> 
> 时间：2012-09-10T15:24:03.200
> 
> 标签：gzip, rpm

设置宏无法处理 .gz 文件。我想我应该提取源.gz文件而不删除它（用gzip解压正常删除文件），然后手动cd进入未压缩的目录。

我想知道这是否是一个好的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T18:46:34.517

您不能仅从 .gz 文件中提取目录。那将是一个 .tar.gz 文件。.tar.gz 文件的提取通常*不会*删除 .tar.gz 文件。

# android - 使用 DialogFragment 从布局 xml 调用方法。它是如何工作的？

> ID：12354748
> 
> 赞同：3
> 
> 时间：2012-09-10T15:24:26.343
> 
> 标签：android, android-fragments, android-dialogfragment

假设我有这个按钮：

```
<Button
android:id="@+id/idone"
android:layout_width="0dip"
android:layout_height="wrap_content"
android:layout_weight="1"
android:text="D2"
android:onClick="myMeth"/> 
```

我曾多次使用它来调用布局 xml 中的方法，因为它从扩展此类视图的活动中调用方法。

最近使用 DialogFragments，它根本不起作用。我不断收到错误消息，告诉我这种方法不存在。那么它在哪里寻找这种方法呢？我已将其添加到 DialogFragment 类中：

```
public class myActivity extends DialogFragment {

public DiceDialog() {
    // empty constructor
}

 @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.myDialog, container);
        getDialog().setTitle("Hello");
        return view;
    }

public void myMeth(View view) {
//...
    } 
```

以及在实例化 FragmentManager 并调用对话框的活动中：

```
public Class MainActiviry Extends  FragmentActivity {

//...
public void onCreate(Bundle savedInstanceState) {
// ..
FragmentManager fm = getSupportFragmentManager();
MyActivity dialog = new AddDiceDialog();
dialog.show(fm, "tag");
}

public void myMeth(View view){
//...
} 
```

消息仍然是 MyMeth 没有找到。

我已经[读过](https://stackoverflow.com/questions/10867425/communication-between-fragments-dialogs-in-android)使用接口和侦听器是在活动和对话片段之间进行通信的正确方法，但我在这里试图弄清楚的是 myMeth 调用的位置，因为它被调用了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T16:01:40.443

你可以`public myMeth(View view)`在你的中实现`Activity`，然后检查当前可见的`Fragment`，并调用它的方法。

如果您想在 中使用多个可调用方法`Fragment`，可以利用调用视图的 id 并实现 a `switch`，根据`View`.

# c# - TextBox.TextChanged 和“CTRL-a”

> ID：12354753
> 
> 赞同：5
> 
> 时间：2012-09-10T15:24:46.283
> 
> 标签：c#, winforms

我写了简单的代码：

```
using System.Windows.Forms;

namespace Test01
{
    partial class Form1
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.textBox1 = new System.Windows.Forms.TextBox();
            this.checkBox1 = new System.Windows.Forms.CheckBox();
            this.SuspendLayout();
            // 
            // textBox1
            // 
            this.textBox1.Location = new System.Drawing.Point(33, 32);
            this.textBox1.Name = "textBox1";
            this.textBox1.Size = new System.Drawing.Size(186, 20);
            this.textBox1.TabIndex = 0;
            this.textBox1.Text = "Text";
            this.textBox1.TextChanged += new System.EventHandler(this.textBox1_TextChanged);
            // 
            // checkBox1
            // 
            this.checkBox1.AutoSize = true;
            this.checkBox1.Location = new System.Drawing.Point(38, 65);
            this.checkBox1.Name = "checkBox1";
            this.checkBox1.Size = new System.Drawing.Size(80, 17);
            this.checkBox1.TabIndex = 1;
            this.checkBox1.Text = "checkBox1";
            this.checkBox1.UseVisualStyleBackColor = true;
            // 
            // Form1
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(234, 86);
            this.Controls.Add(this.checkBox1);
            this.Controls.Add(this.textBox1);
            this.Name = "Form1";
            this.Text = "Form1";
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        void textBox1_TextChanged(object sender, System.EventArgs e)
        {
            if (this.checkBox1.Checked)
                this.checkBox1.CheckState = CheckState.Unchecked;
            else
                this.checkBox1.CheckState = CheckState.Checked;
        }

        #endregion

        private System.Windows.Forms.TextBox textBox1;
        private System.Windows.Forms.CheckBox checkBox1;
    }
} 
```

和：

```
namespace Test01
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
    }
} 
```

我得到一个带有文本框（“文本”）和复选框的窗口。当我专注于文本框并按下`Ctrl``A`复选框切换状态时，因为 TextBox.TextChanged 引发并 textBox1_TextChanged 执行。但是，我不明白为什么会引发 TextChanged 事件`Ctrl``A`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-22T09:37:29.813

我遇到了同样的问题，使用下面的代码：

```
private void textBox1_TextChanged(Object sender, EventArgs e) 
{
    if (textBox1.SelectedText == textBox1.Text && textBox1.Text != "")
        return;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:44:23.750

您可以通过添加以下条件来抑制此行为：

```
 void textBox1_TextChanged(object sender, System.EventArgs e) 
    {
        if (ModifierKeys == Keys.Control)
            return;

        //rest of the code
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T10:29:52.270

我的问题的解决方法：

```
void textBox1_TextChanged(object sender, System.EventArgs e)
{
    if (_oldText.Equals(this.textBox1.Text))
        return;
    _oldText = this.textBox1.Text;
    //rest of code
} 
```

我找不到更好的解决方案。

# zend-framework - Zend Bootstrap 如何自动加载模型？

> ID：12354756
> 
> 赞同：0
> 
> 时间：2012-09-10T15:24:54.883
> 
> 标签：zend-framework, model, bootstrapping

我有一个身份验证插件工作。我正在尝试根据[http://www.youtube.com/watch?v=b6qsSnLfcmE&feature=relmfu](http://www.youtube.com/watch?v=b6qsSnLfcmE&feature=relmfu)上的优秀视频系列为其添加 ACL 。

我的问题是，当我尝试在 Bootstrap 中注册模型以便可以将实例传递给插件时，出现服务器 500 错误。我的引导程序看起来像这样......

```
class Bootstrap extends Zend_Application_Bootstrap_Bootstrap
{
protected function _initAutoload()
{
    $modelLoader = new Zend_Application_Module_AutoLoader(array(
        'namespace' => '',
        'basePath'  => APPLICATION_PATH));

    $acl = new Model_SystemAcl;
    $auth = Zend_Auth::getInstance();

    $fc = Zend_Controller_Front::getInstance();
    $fc->registerPlugin(new Plugin_AccessCheck($acl,$auth));

    return $modelLoader;
}

} 
```

这是行：

```
$acl = new Model_SystemAcl; 
```

这就是问题所在。如果我将其注释掉（以及传递的 $acl 参数），它工作正常。似乎我的系统没有正确配置以加载模型。这是教程中显示的整个引导程序顺便说一句。也许 Application.ini 中有我需要的东西？

编辑：是的，SystemAcl.php 存在并且在 [applicationdir]/models

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:33:50.427

尝试实例化可能尚未加载的资源，这不是一个好习惯。

您应该改用控制器插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T16:20:41.973

这是从应用程序命名空间“Application”加载模型的完整示例

```
$resourceLoader = new Zend_Loader_Autoloader_Resource(
    array(
         'basePath'  => APPLICATION_PATH,
         'namespace' => 'Application',
    )
);
$resourceLoader->addResourceType('model', 'models/', 'Model');

$autoloader = Zend_Loader_Autoloader::getInstance();
$autoloader->pushAutoloader($resourceLoader); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T16:46:39.887

根据您的设置，您的类的文件名应该是`SystemAcl.php`，而不是`Model_SystemAcl.php`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T16:15:10.857

如果它在应用程序/模型中，那么我会认为脚本应该是 Models_SystemAcl 而不是 Model_SystemAcl（没有's'）。话虽如此，从长远来看，最好使用插件，而不是将这类东西粘在引导程序中。这些教程虽然很好:)

# android - 测试版应用程序的 Google 应用程序许可？

> ID：12354763
> 
> 赞同：1
> 
> 时间：2012-09-10T15:25:40.070
> 
> 标签：android

这就是我想要做的：

*   将应用程序放入免费测试版

*   让用户有一个时间限制，他们可以使用它进行“Beta测试”（定时炸弹，但这很容易解决）

*   在用户进入应用程序时（例如 30 天）用户测试时间结束后[或者更好的是，他们在启动手机时会弹出一个屏幕]如果您喜欢我们的产品请购买付费版。

所以我正在做的是对我的申请进行 30 天的试用期。

（我几乎可以肯定这是以前做过的，我想知道自己怎么做）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:49:36.153

检测试用结束的最简单方法可能是在应用程序首次启动时使用首选项存储当前日期，然后在每次后续启动时将该存储日期与当前日期（来自手机或互联网）进行比较。

但是，用户可以从“设置”中清除应用程序的数据，或者卸载并重新安装该应用程序，它会重新开始工作。

一个解决方案是让应用程序在首次启动时使用您的服务器注册设备或用户的谷歌帐户，应用程序连接到该服务器，以在每次后续启动时请求许可。

更便宜的解决方案是设计您的应用程序，以便清除其数据或卸载并重新安装它足以阻止用户这样做；例如，防止在试用期间从应用程序中导出数据，这样用户就必须在付费或卸载应用程序之间做出选择，从而失去所有工作。

# cocos2d-x - Cocos2d-x 调度错误

> ID：12354773
> 
> 赞同：3
> 
> 时间：2012-09-10T15:25:56.787
> 
> 标签：cocos2d-x, schedule

`allyMonser`是一个`CCSprite`（继承）。当我使用时间表时`allyMonster`，`NULL`在`action()`. 但是，当我`action()`直接调用时，`allyMonster`is Not `NULL`，这是正常的。

当我运行此代码时，日志显示：

```
1, 0x23ds566
2, 0xfffffff 
```

我想知道原因`1, 0x23ds566`-> `2, 0xfffffff`。为什么会改变？

```
void AMS_Moving::runAction()
{
    allyMonster->unscheduleAllSelectors();
    allyMonster->stopAllActions();
    allyMonster->schedule( schedule_selector( AMS_Moving::action ) );

    CCLog("1\. %x", allyMonster);
}

void AMS_Moving::action()
{
    CCLog("2\. %x", allyMonster);
    ...
    ...
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T23:06:36.550

我猜原因是，当你运行预定的函数时，它不是指向你想要的函数，而是指向别的东西，因为

```
void AMS_Moving::action() 
```

是错的。默认情况下，所有调度函数都应该接受一个输入 ccTime dt，它应该是

```
void AMS_Moving::action(ccTime dt) 
```

# jquery - jquery ajax 调用失败，未找到

> ID：12354777
> 
> 赞同：0
> 
> 时间：2012-09-10T15:26:03.613
> 
> 标签：jquery, ajax

我运行了一个ajax请求

```
$.ajax({
            type: 'POST',
            url: '../validateAcct.php',
            data: $("#createaccount").serialize(),
            success: function(response){
                var data = $.parseJSON(response);
                $("#errormessage").html(data);

            },
            error: function(data, status, error){
                alert(error);

            }

        }); 
```

找不到它抛出的错误。我将我的 php 文件与 js 和 css 文件分开，只是为了让我的 localhost 看起来更干净，更容易处理。这里的问题是我没有使用正确的方法来调用楼上的文件-“../validateAcct.php”还是js文件需要与php位于同一文件夹中？

# php - 如何使用mysql中的数据下载保存在服务器文件夹中的文件

> ID：12354778
> 
> 赞同：-1
> 
> 时间：2012-09-10T15:26:04.490
> 
> 标签：php, mysql, html

所以我有一个上传页面，您可以在其中将文件添加到数据库中，文件保存在“cursuri/”中，并在 mysql 表中插入 varchar。

现在我想下载文件但我不能（我检查过，上传的文件在文件夹中），我一直得到一个空的 .htm 文件。

我检查了 mysql 表 preda.material(varchar) 中的数据，它包含一个 binary_file.dat 和里面的文件名。

现在脚本：

```
<?php
session_start();
include_once('scripts/connect_to_mysql.php');
$ID_material = (int) $_GET['ID_material'];  
$sql = "SELECT material FROM `preda` WHERE `ID_material` = '$ID_material' "; 
$result = mysql_query($sql);
while($info = mysql_fetch_array($result)) 
{ 
header("Content-disposition: attachment; filename=". $info['material']);        

/* print "Cursuri/".$info['material'] ." <br>"; */
}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:29:34.080

```
header("Content-disposition: attachment; filename=". $info['material']); 
```

这只会设置一个 HTTP 标头，告诉接收者（浏览器）HTTP 响应的正文包含名为 XYZ 的文件的文件数据。它本身并不附加文件或使浏览器能够从某处获取文件。您仍然需要自己输出实际的文件数据。见[`readfile`](http://php.net/readfile)。

# java - 用于从网站解析 JSON 的 Android 应用

> ID：12354781
> 
> 赞同：0
> 
> 时间：2012-09-10T15:26:19.667
> 
> 标签：java, android, json

好的，所以第一个障碍在几分钟内就被清除了，让我们看看这个障碍是怎么做的。

正如我在日志中看到的那样，该代码正在从网站上提取 JSON 数据，但现在 JSONParser 失败了。我认为问题在于 JSONObject 与 JSONArray，但我无法弄清楚。

以下是从 JSON 站点提取的数据，如日志中所示：

```
09-10 09:45:00.175: I/log_tag(785): {"stoker":{"sensors":[{"id":"620000116F01CA30","name":"SS2","al":0,"ta":66,"th":75,"tl":65,"tc":66.3,"blower":null},09-10 09:45:00.175: I/log_tag(785): {"id":"E20000116F0CDB30","name":"brskt2","al":0,"ta":203,"th":32,"tl":32,"tc":70.6,"blower":null}],09-10 09:45:00.175: I/log_tag(785): "blowers":[{"id":"37000000119D8B05","name":"party","on":0}]}} 
```

这是尝试解析数据的代码：

```
 try{
            JSONArray jArray = new JSONArray(result);
            for(int i=0;i<jArray.length();i++){
                JSONObject json_data = jArray.getJSONObject(i);
                Sensor resultRow = new Sensor();
                resultRow.id = json_data.getString("id");
                resultRow.name = json_data.getString("name");
                resultRow.current = json_data.getString("tc");
                resultRow.target = json_data.getString("ta");
                arrayOfWebData.add(resultRow);
            }
        }
        catch(JSONException e){
                Log.e("log_tag", "Error parsing data "+e.toString());
        } 
```

这是失败时日志文件中的条目：

```
09-10 09:45:00.314: E/log_tag(785): Error parsing data org.json.JSONException: Value {"stoker":{"sensors":[{"id":"620000116F01CA30","al":0,"tl":65,"tc":66.3,"ta":66,"name":"SS2","blower":null,"th":75},{"id":"E20000116F0CDB30","al":0,"tl":32,"tc":70.6,"ta":203,"name":"brskt2","blower":null,"th":32}],"blowers":[{"id":"37000000119D8B05","on":0,"name":"party"}]}} of type org.json.JSONObject cannot be converted to JSONArray 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:31:28.790

您不能在不指定 Object 或 Array 的情况下使用 Java API 解析 JSON — JSON 文档都可以。由于您在日志中的数据显示了一个对象，因此您需要在第二行请求一个 JSONObject。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:45:55.177

So long as the JSON string in your logcat is accurate, there are two things that need to change. First, your result is a JSONObject that contains a JSONArray. You'll have to make an object first and extract the array from that object. Secondly, tc and ta are shown as doubles and integers respectively in the output and would need to be retrieved as such. It'd all look something like this:

```
 try {
        JSONObject obj = new JSONObject(result);
        JSONObject stoker = obj.getJSONObject("stoker");
        JSONArray jArray = stoker.getJSONArray("sensors");
        for(int i = 0; i < jArray.length(); i++) {
            JSONObject json_data = jArray.getJSONObject(i);
            Sensor resultRow = new Sensor();
            resultRow.id = json_data.getString("id");
            resultRow.name = json_data.getString("name");
            resultRow.current = json_data.getDouble("tc");
            resultRow.target = json_data.getInt("ta");
            arrayOfWebData.add(resultRow);
        }
    }
    catch(JSONException e){
        Log.e("log_tag", "Error parsing data "+e.toString());
    } 
```

Based on the provided JSON string, this should work. For future reference, anything contained within {} is a JSONObject while anything inside of [] is a JSONArray. Any second value in a key/value pair that has quotes around it is likely a string while values without quotes are retrieved as numbers.

# loops - Symfony 2.1 FOSFacebookBundle 登录后无限循环

> ID：12354783
> 
> 赞同：1
> 
> 时间：2012-09-10T15:26:21.430
> 
> 标签：loops, symfony, login, symfony-2.1, fosuserbundle

我在将 FOSFacebookBundle 集成到我的网站时遇到了一点问题。当我点击“Connexion”按钮时，用户被重定向到/facebook/login_check，并且一些随机令牌被添加到url（状态和代码）。但是每秒都会给这些令牌一个新的值，并且页面仍然是空白的。

这是我的代码：

[配置.yml]

```
security:
providers:
    fos_userbundle:
        id: fos_user.user_manager
    my_fos_facebook_provider:
        id: my.facebook.user
firewalls:
    public:
        pattern:   ^/facebook
        fos_facebook:
            app_url: "http://www.facebook.com/apps/application.php?id=[MY_APP_ID]"
            server_url: "http://localhost/[MY_APP]/app_dev/"
            login_path: /facebook/login
            check_path: /facebook/login_check
            provider: my_fos_facebook_provider
            default_target_path: /
        anonymous: true
        logout:
            handlers: ["fos_facebook.logout_handler"]
    main:
        form_login:
            login_path:  /login
            check_path:  /login_check
            provider:  fos_userbundle 
```

[路由.yml]

```
_security_check:
    pattern:  /facebook/login_check
_security_logout:
    pattern:  /logout 
```

[layout.html.twig]

```
<script>
      function goLogIn(){
          window.location.href = "{{ path('_security_check') }}";
      }

      function onFbInit() {
          if (typeof(FB) != 'undefined' && FB != null ) {
              FB.Event.subscribe('auth.statusChange', function(response) {
                  if (response.session || response.authResponse) {
                      setTimeout(goLogIn, 500);
                  } else {
                      window.location.href = "{{ path('fos_user_security_logout') }}";
                  }
              });
          }
      }
</script> 
```

你知道为什么吗 ？

提前致谢。

PS：我使用 Symfony 2.1 和 FOSUserBundle。

# sql - 使用 `REPLACE` 函数的 Oracle UPDATE 语句

> ID：12354785
> 
> 赞同：10
> 
> 时间：2012-09-10T15:26:23.393
> 
> 标签：sql, oracle, syntax, sql-update

我试图记住如何`REPLACE`在 Oracle SQL 中形成正确的语句。

本质上，我需要执行`REPLACE`几千条记录，其中`column1`可能`column2`包含`'14'`. 如果他们这样做，我只需要用一个空格字符替换它。

我知道语法类似于以下内容，但我似乎无法完全正确：

```
UPDATE TABLE
SET ('column1', 'column2') = REPLACE(?????????????)
WHERE 'column1' IN ('14') AND 'column2' NOT LIKE ('4%') 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-10T15:32:51.237

查询应该类似于：

```
UPDATE table1
SET column1 = REPLACE(column1, '14', ' '),
    column2 = REPLACE(column2, '14', ' ')
WHERE column1 LIKE '%14%' OR column2 LIKE '%14%' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T15:52:47.490

```
UPDATE TABLENAME
  SET COLUMN1 = ' ',
  SET COLUMN2 = ' '
WHERE COLUMN1='14' OR COLUMN2='14'; 
```

假设 Column[1,2] 是字符类型。

# asp.net-mvc-3 - jQuery UI 重叠/屏蔽 MvcSiteMap 菜单

> ID：12354793
> 
> 赞同：0
> 
> 时间：2012-09-10T15:26:51.290
> 
> 标签：asp.net-mvc-3, jquery-ui, asp.net-mvc-sitemap

请看下面的图片。jQuery UI 控件是重叠/屏蔽 MvcSitemap 下拉菜单。我相信这是一个快速修复（更改 UI 主题的 CSS 属性等），但我很难找到如何覆盖 UI 控件的这种行为。希望有人能帮助解决这个问题。

1.  与菜单重叠的 UI 按钮 ![与菜单重叠的 UI 按钮](../Images/9845469d47e565bccd140d5a80d221b5.png)

2.  选项卡控件与菜单重叠 ![选项卡控件与菜单重叠](../Images/803fbcdaacb14fc6085b669cc92f545e.png)

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T02:13:16.363

向 MvcSitemap 下拉 css 添加高 z-index css 样式。类似的东西`z-index: 1000;`将是一个合理的开始。

jQUery UI 控件并没有故意遍历任何内容，而是在其下方的内容下方呈现菜单。这是因为它的 html 位于文档布局中的其他小部件之前。

# iphone - 在 iPad 上使用 Core Plot 的多个图表

> ID：12354794
> 
> 赞同：0
> 
> 时间：2012-09-10T15:27:03.427
> 
> 标签：iphone, objective-c, xcode, ipad, core-plot

我有一个应用程序需要显示未知数量的图表，具体取决于连接到 iPad 的传感器数量。我有 X 个`NSArray`包含 X`NSNumber`的 s 正在实时更新；图表需要与数据一起更新（即实时）。

当我使用[Core Plot](http://code.google.com/p/core-plot/wiki/HighLevelDesignOverview)时会出现我的问题。如何动态创建多个图表？我是 Objective-C 的新手，所以也许这只是我的一个问题。

如果我创建一个图表和添加数据所需的相应委托方法？有人可以概述如何执行此操作吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T22:58:32.910

您可以根据需要创建任意数量的图表。为每个人创建一个托管视图，然后根据需要进行布置。托管视图是 的子类，`UIView`因此您可以使用所有标准布局技术和容器视图。

根据您想要实现的外观，另一种方法是使用一个包含多个图的图表。正常创建每个并使用`-addPlot:`将它们添加到图表中。

您的所有地块都可以共享一个数据源，尽管它们不是必须的。将`identifier`每个图上的 设置为唯一值。在数据源方法中，检查`identifier`参数`plot`并使用它来决定返回什么数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T21:19:42.823

> 如果您想将多个图表添加到一个视图中，此代码将很有帮助。您可以通过调用简单地添加图表：
> 
> CGRect 矩形 = CGRectMake(160, 99, 864, 223); plot1 = [self getGraphWithRect:rect identifier:@"1"];

```
//
//  ViewController.m
//  sense01
//
//  Created by Morten Ydefeldt on 8/16/12.
//  Copyright (c) 2012 ydefeldt. All rights reserved.
//

#import "ViewController.h"
#import "SenseManager.h"
#import "Sensor.h"

@interface ViewController ()

@end

@implementation ViewController

@synthesize statusIndicator;
@synthesize values;
@synthesize recordButton;
@synthesize plot;

-(void)senseIsConnected:(BOOL)status
{
    if(status)
    {
        statusIndicator.text = @"Connected";
        [recordButton setImage:[UIImage imageNamed:@"record_inactive.png"] forState:UIControlStateNormal];
    }
    else
    {
        statusIndicator.text = @"Disconnected";
        [recordButton setImage:[UIImage imageNamed:@"record_notactive.png"] forState:UIControlStateNormal];

    }

}

- (void)newDataFromSensor:(id)sensor{

    for(id key in sensor) {
        id value = [sensor objectForKey:key];

        //textView.text = [value description];

        [self pointReceived:[NSNumber numberWithInt:[[value getRealWorldData] intValue]]];
    }}

-(CGPoint)plotSpace:(CPTPlotSpace *)space willDisplaceBy:(CGPoint)proposedDisplacementVector
{

    return CGPointMake(proposedDisplacementVector.x, 0);
}

-(CPTPlotRange *)plotSpace:(CPTPlotSpace *)space willChangePlotRangeTo:(CPTPlotRange *)newRange forCoordinate:(CPTCoordinate)coordinate
{
    if (coordinate == CPTCoordinateY) {
        newRange = ((CPTXYPlotSpace*)space).yRange;
    }
    return newRange;

}

-(void)viewDidAppear:(BOOL)animated{

    CAGradientLayer *gradient = [CAGradientLayer layer];
    gradient.frame = self.view.bounds;
    gradient.colors = [NSArray arrayWithObjects:(id)[UIColor colorWithRed:0.2 green:0.2 blue:0.2 alpha:1].CGColor, (id)[UIColor colorWithRed:0.05 green:0.05 blue:0.05 alpha:1].CGColor, nil];
    [self.view.layer insertSublayer:gradient atIndex:0];
}

- (void)viewDidLoad
{

    [super viewDidLoad];
    manager = [[SenseManager alloc] init];
    manager.delegate  = self;
    [manager openConnection];

    CAGradientLayer *gradient = [CAGradientLayer layer];
    gradient.frame = CGRectMake(0, 0, 1024, 99);
    gradient.colors = [NSArray arrayWithObjects:(id)[UIColor colorWithRed:0.2 green:0.2 blue:0.2 alpha:1].CGColor, (id)[UIColor colorWithRed:0.05 green:0.05 blue:0.05 alpha:1].CGColor, nil];
    [self.view.layer insertSublayer:gradient atIndex:0];

    CGRect rect = CGRectMake(160, 99, 864, 223);
    plot1 = [self getGraphWithRect:rect identifier:@"1"];

    rect = CGRectMake(160, 322, 864, 223);
    plot2 = [self getGraphWithRect:rect identifier:@"2"];

    rect = CGRectMake(160, 545, 864, 223);
    plot3 = [self getGraphWithRect:rect identifier:@"3"];

    NSMutableArray *ContentArray = [NSMutableArray arrayWithCapacity:200];
    self.values = ContentArray;
}

-(CPTXYGraph *)getGraphWithRect:(CGRect)rect identifier:(NSString*)identifier{

    plot = [[CPTXYGraph alloc] initWithFrame:rect];
    CPTGraphHostingView *layerHostingView = [[CPTGraphHostingView alloc] initWithFrame:rect];
    layerHostingView.collapsesLayers = NO;
    layerHostingView.hostedGraph = plot;

    CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace* )plot.defaultPlotSpace;
    plotSpace.allowsUserInteraction = YES;
    plotSpace.xRange = [CPTPlotRange plotRangeWithLocation: CPTDecimalFromDouble(0.0) length: CPTDecimalFromDouble(60.0)];
    plotSpace.yRange = [CPTPlotRange plotRangeWithLocation: CPTDecimalFromDouble(0.0) length: CPTDecimalFromDouble(50.0)];

    CPTScatterPlot *line = [[CPTScatterPlot alloc]init];
    CPTMutableLineStyle *lineStyle = [CPTMutableLineStyle lineStyle];

    //Fill colors
    float c= 0.2;
    plot.fill = [CPTFill fillWithColor:[CPTColor colorWithComponentRed:c green:c blue:c alpha:1]];
    plot.plotAreaFrame.fill = [CPTFill fillWithColor:[CPTColor colorWithComponentRed:c green:c blue:c alpha:1]];
    plot.plotAreaFrame.borderLineStyle = nil;

    //Plot border
    lineStyle.lineColor = [CPTColor grayColor];
    lineStyle.lineWidth = 1.2;
    plot.borderLineStyle = lineStyle;

    //Plot padding
    plot.paddingBottom = 5;
    plot.paddingLeft = 5;
    plot.paddingRight = 5;
    plot.paddingTop = 5;

    //axis range
    CPTXYAxisSet *axisSet = (CPTXYAxisSet *)plot.axisSet;
    CPTXYAxis *y = axisSet.yAxis;
    CPTXYAxis *x = axisSet.xAxis;
    x.orthogonalCoordinateDecimal = CPTDecimalFromString(@"0.0");
    y.orthogonalCoordinateDecimal = CPTDecimalFromString(@"0.0");

    y.labelingPolicy = CPTAxisLabelingPolicyAutomatic;
    x.labelingPolicy = CPTAxisLabelingPolicyAutomatic;

    x.axisConstraints = [CPTConstraints constraintWithLowerOffset:15.0];
    y.axisConstraints = [CPTConstraints constraintWithLowerOffset:25.0];

    y.minorTickLength = 0;
    y.majorTickLength = 0;
    x.minorTickLength = 0;
    x.majorTickLength = 0;

    //axis theming
    c = 0.4;
    lineStyle.lineColor = [CPTColor colorWithComponentRed:c green:c blue:c alpha:1];
    lineStyle.lineWidth = 0.7f;
    y.axisLineStyle = lineStyle;
    x.axisLineStyle = lineStyle;

    //label theming
    CPTMutableTextStyle *textStyle = [CPTMutableTextStyle textStyle];
    textStyle.color = [CPTColor whiteColor];
    textStyle.fontName = @"Helvetica-Bold";
    x.labelTextStyle = textStyle;
    y.labelTextStyle = textStyle;

    //grid theming
    c = 0.3;
    lineStyle.lineColor = [CPTColor colorWithComponentRed:c green:c blue:c alpha:1];
    lineStyle.lineWidth = 0.1f;
    x.minorGridLineStyle = lineStyle;
    y.minorGridLineStyle = lineStyle;

    //curve theming
    lineStyle.miterLimit = 1.0f;
    lineStyle.lineWidth = 1.5f;
    lineStyle.lineColor = [CPTColor whiteColor];
    line.dataLineStyle = lineStyle;
    line.identifier = identifier;
    line.dataSource = self;

    //plotsymbol
    CPTPlotSymbol *plotSymbol = [CPTPlotSymbol ellipsePlotSymbol];
    CPTGradient *blueGradient = [CPTGradient gradientWithBeginningColor:[CPTColor colorWithComponentRed:62.0f/255.0f green:112.0/255.0f blue:184.0f/255.0f alpha:1] endingColor:[CPTColor colorWithComponentRed:43.0f/255.0f green:63.0/255.0f blue:153.0f/255.0f alpha:1]];
    lineStyle.lineColor = [CPTColor whiteColor];
    lineStyle.lineWidth = 1.0f;
    plotSymbol.lineStyle = lineStyle;
    plotSymbol.fill = [CPTFill fillWithGradient:blueGradient];
    plotSymbol.size = CGSizeMake(11.0, 11.0);
    line.plotSymbol = plotSymbol;

    [plot addPlot:line];

    [self.view addSubview:layerHostingView];

    return plot;

}

#pragma mark

-(void)pointReceived:(NSNumber *) point{

    [self.values addObject:point];

    self.statusIndicator.text = [NSString stringWithFormat:@"%@", point];
    self.statusIndicator.text = [NSString stringWithFormat:@"%d", [self.values count]];

    CPTPlot *first = [plot plotWithIdentifier:@"2"];
    [first insertDataAtIndex:self.values.count-1 numberOfRecords:1];

    CPTPlot *secondPlot = [plot plotWithIdentifier:@"3"];
    [secondPlot insertDataAtIndex:self.values.count-1 numberOfRecords:1];

    NSLog(@"LOL");

}

-(NSUInteger)numberOfRecordsForPlot:(CPTPlot *)plot{

    return [values count];

}

-(NSNumber *)numberForPlot:(CPTPlot*)plot field:(NSUInteger)fieldEnum recordIndex:(NSUInteger)index{
    if (fieldEnum == CPTScatterPlotFieldX){
        return [NSNumber numberWithInteger:index];

    }else{
        return [self yValueForIndex:index];
    }

}

-(NSNumber *) yValueForIndex:(NSUInteger)index{

    return [self.values objectAtIndex:index];

}

- (void)viewDidUnload
{
    statusIndicator = nil;
    recordButton = nil;
    [self setRecordButton:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (void) portStatusChanged
{

}

- (void) readBytesAvailable:(UInt32)length
{

//    myString = [NSMutableString stringWithString:@""];
//    int bytesRead = [rscMgr read:rxBuffer Length:length];
//    for (int i = 0; i < bytesRead; i++) {
//        [myString appendString:[NSString stringWithFormat:@"%c",((char *)rxBuffer)[i]]];
//    }
//    textView.text = myString;
//    //textView.text = [NSString stringWithFormat:@"%@%@",textView.text,myString];
//    //    NSArray *arrayValues = [myString componentsSeparatedByString:@","];
//    //    textView.text = [arrayValues objectAtIndex:1];
//    //    statusIndicator.text = [NSString stringWithFormat:@"%i",[arrayValues count]];
//    //  arrayValues = nil;

}

-(IBAction)Write:(id)sender{

    [self pointReceived:[NSNumber numberWithInt:20]];

}

- (IBAction)recordButton:(id)sender {

    if (record) {
        record = NO;
        [recordButton setImage:[UIImage imageNamed:@"record_inactive.png"] forState:UIControlStateNormal];
        [manager activateDataFromSense:NO];
    }
    else{

        [recordButton setImage:[UIImage imageNamed:@"record_active.png"] forState:UIControlStateNormal];
        [manager activateDataFromSense:YES];
        record = YES;
    }

}

@end 
```

# c# - c# - DataSet 和 DataGridView

> ID：12354797
> 
> 赞同：0
> 
> 时间：2012-09-10T15:27:14.047
> 
> 标签：c#

我制作了一个基本程序来向数据集添加值并将其显示到 dataGridView：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        DataTable table1 = new DataTable("People");
        table1.Columns.Add("id");
        table1.Columns.Add("Name");
        table1.Columns.Add("Age");
        table1.Rows.Add(1, "Jack", 18);
        table1.Rows.Add(2, "Tim", 18);

        DataSet set = new DataSet("SetPeople");
        set.Tables.Add(table1);

        dataGridView1.DataSource = set;
        dataGridView1.Update();
    }
} 
```

当我尝试它时，似乎什么都没有发生。dataGridView 保持空白。知道我哪里出错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:28:29.320

尝试这个

```
 dataGridView1.DataSource = table1; 
```

您不需要 Ds 来仅在 Gridview 中显示数据表

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T15:59:05.957

Massimiliano Peluso is correct. The GridView will reference a"Table", but more specifically, when using ADO.NET in a Disconnected fashion you will be filling the GridView with DataColumn objects that are part of a DataTable object. You will also want to bind your dataTable to the GridView.

A bit of Detail: ADO.Net's DataSet construct allows you to represent your database in a "table" like manner and allow those tables to share references. All of this comes at the cost of additional memory overhead, but if this is not going to be a highly scalable applicaiton and you want to give the users the ability to edit rows without having to go to the database every time, DataSet is a good option.

If you are not using the featuers of DataSet (e.g. table relationships) you can save yourself a little overhead by just using DataTable objects and populating them.

To answer your questions:

A GridView expects to recieve a DataTable as a data source. That table can contain several columns (which will fill the columns of the grid). You can write the following code to specifically access your data table:

```
dataGridView1.DataSource = set.Tables["table1"]; // or by index if you prefer as there are several overloads. 
```

Additionally, I would bind the data by adding the following line of code after the one perscribed above:

```
dataGridView1.DataBind(); 
```

The fact you are missing your DataBind() method call is part of your issue.

There is a very good example at C sharp corner site: [Example](http://www.c-sharpcorner.com/uploadfile/abhikumarvatsa/using-a-disconnected-datatable-to-display-records-in-gridview-in-Asp-Net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-15T13:12:50.107

> 你也可以这样做：

```
dataGridView1.DataSource = set;
dataGridView1.DataMember = set.Tables["People"].TableName;
dataGridView1.Update(); 
```

# database - activeadmin 中的 i18n 错误

> ID：12354798
> 
> 赞同：1
> 
> 时间：2012-09-10T15:27:15.583
> 
> 标签：database, ruby-on-rails-3, internationalization, yaml, activeadmin

我正在使用活动的 activeAdmin 将我的源代码文件 yaml 翻译成葡萄牙语：

```
"pt-PT":
  activerecord:
    models:
      position:
        one: "Posição"
        other: "Posições" 
```

痕迹：

```
Encoding::CompatibilityError in Admin::PositionsController#index

incompatible character encodings: ASCII-8BIT and UTF-8

activeadmin (0.4.4) lib/activeadmin/arbre/html/collection.rb:20:in join'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:intos'
activeadmin (0.4.4) lib/active_admin/arbre/html/element.rb:115:in content'
activeadmin (0.4.4) lib/active_admin/arbre/html/tag.rb:76:into_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:21:in block in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:incollect'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/element.rb:115:incontent'
activeadmin (0.4.4) lib/active_admin/arbre/html/tag.rb:76:in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:21:inblock in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:in collect'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:into_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/element.rb:115:in content'
activeadmin (0.4.4) lib/active_admin/arbre/html/tag.rb:76:into_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:21:in block in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:incollect'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/element.rb:115:incontent'
activeadmin (0.4.4) lib/active_admin/arbre/html/tag.rb:76:in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:21:inblock in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:in collect'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:into_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/element.rb:115:in content'
activeadmin (0.4.4) lib/active_admin/arbre/html/tag.rb:76:into_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:21:in block in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:incollect'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/element.rb:115:incontent'
activeadmin (0.4.4) lib/active_admin/arbre/html/tag.rb:76:in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:21:inblock in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:in collect'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:into_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/element.rb:115:in content'
activeadmin (0.4.4) lib/active_admin/arbre/html/tag.rb:76:into_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/document.rb:25:in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:21:inblock in to_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:in collect'
activeadmin (0.4.4) lib/active_admin/arbre/html/collection.rb:20:into_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/element.rb:115:in content'
activeadmin (0.4.4) lib/active_admin/arbre/html/element.rb:135:into_s'
activeadmin (0.4.4) lib/active_admin/arbre/html/element.rb:131:in to_str'
rack (1.4.1) lib/rack/etag.rb:56:injoin'
rack (1.4.1) lib/rack/etag.rb:56:in digest_body'
rack (1.4.1) lib/rack/etag.rb:26:incall'
rack (1.4.1) lib/rack/conditionalget.rb:25:in call'
actionpack (3.2.3) lib/action_dispatch/middleware/head.rb:14:incall'
actionpack (3.2.3) lib/action_dispatch/middleware/params_parser.rb:21:in call'
actionpack (3.2.3) lib/action_dispatch/middleware/flash.rb:242:incall'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:incall'
actionpack (3.2.3) lib/action_dispatch/middleware/cookies.rb:338:in call'
activerecord (3.2.3) lib/active_record/query_cache.rb:64:incall'
activerecord (3.2.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:467:in call'
actionpack (3.2.3) lib/action_dispatch/middleware/callbacks.rb:28:inblock in call'
activesupport (3.2.3) lib/active_support/callbacks.rb:405:in `_run765012194call948180406_callbacks'
activesupport (3.2.3) lib/active_support/callbacks.rb:405:in `_run_callback'
activesupport (3.2.3) lib/active_support/callbacks.rb:385:in _run_call_callbacks'
activesupport (3.2.3) lib/active_support/callbacks.rb:81:inrun_callbacks'
actionpack (3.2.3) lib/action_dispatch/middleware/callbacks.rb:27:in call'
actionpack (3.2.3) lib/action_dispatch/middleware/reloader.rb:65:incall'
actionpack (3.2.3) lib/action_dispatch/middleware/remote_ip.rb:31:in call'
actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:16:incall'
actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in call'
railties (3.2.3) lib/rails/rack/logger.rb:26:incall_app'
railties (3.2.3) lib/rails/rack/logger.rb:16:in call'
actionpack (3.2.3) lib/action_dispatch/middleware/request_id.rb:22:incall'
rack (1.4.1) lib/rack/methodoverride.rb:21:in call'
rack (1.4.1) lib/rack/runtime.rb:17:incall'
activesupport (3.2.3) lib/active_support/cache/strategy/local_cache.rb:72:in call'
rack (1.4.1) lib/rack/lock.rb:15:incall'
actionpack (3.2.3) lib/action_dispatch/middleware/static.rb:62:in call'
railties (3.2.3) lib/rails/engine.rb:479:incall'
railties (3.2.3) lib/rails/application.rb:220:in call'
rack (1.4.1) lib/rack/content_length.rb:14:incall'
railties (3.2.3) lib/rails/rack/log_tailer.rb:14:in call'
rack (1.4.1) lib/rack/handler/webrick.rb:59:inservice'
/home/ruby/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:138:in service'
/home/ruby/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:94:inrun'
/home/ruby/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

该错误是由于在数据库中的两个文件 yaml 中使用特殊字符引起的，有人可以帮我解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:37:45.133

你能检查你的编辑器是否以 UTF8 保存你的文件吗？

如果它仍然不起作用，请尝试在文件顶部添加这一行（你是正确的，它在 yml 文件中没有用，只是在 rb 文件中）：# encoding: utf-8

编辑：更多配置

确保您有：

在您的 application.rb 中：

```
config.encoding = "utf-8" 
```

在您的 config/environment.rb 中：

```
Encoding.default_external = Encoding::UTF_8
Encoding.default_internal = Encoding::UTF_8 
```

# classpath - 使用 Jena 创建新的本体

> ID：12354800
> 
> 赞同：3
> 
> 时间：2012-09-10T15:27:19.933
> 
> 标签：classpath, jena, ontology

我正在尝试使用耶拿。为了创建一个新的本体，我的代码是：

```
 String SOURCE = "http://www.w3.org/2002/07/owl#";
    String NS = SOURCE + "#";
    OntModel ontology = ModelFactory.createOntologyModel();
    ontology.read( SOURCE, "OWL/XML" ); 
```

但它给了我这个错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/slf4j/LoggerFactory
    at com.hp.hpl.jena.util.Metadata.<clinit>(Metadata.java:26)
    at com.hp.hpl.jena.JenaRuntime.<clinit>(JenaRuntime.java:25)
    at com.hp.hpl.jena.rdf.model.impl.RDFReaderFImpl.<clinit>(RDFReaderFImpl.java:85)
    at com.hp.hpl.jena.rdf.model.impl.ModelCom.<clinit>(ModelCom.java:42)
    at com.hp.hpl.jena.rdf.model.ModelFactory.createDefaultModel(ModelFactory.java:122)
    at com.hp.hpl.jena.rdf.model.ModelFactory.createDefaultModel(ModelFactory.java:116)
    at com.hp.hpl.jena.vocabulary.OWL.<clinit>(OWL.java:37)
    at com.hp.hpl.jena.ontology.ProfileRegistry.<clinit>(ProfileRegistry.java:48)
    at com.hp.hpl.jena.ontology.OntModelSpec.<clinit>(OntModelSpec.java:54) 
```

有什么问题？我找不到任何解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T07:53:32.723

如果你使用 Jena 发行版，所有需要的 jars 都在 lib/ 目录中。你需要它们都在类路径上。

在 Windows/cygwin 上：

```
javac -cp '<install dir>\lib\*;' MyClass.java 
```

在 Linux 上：

```
javac -cp '<install dir>/lib/*' MyClass.java 
```

要运行，创建的`.class`也需要在您的路径中：

```
java -cp '.:<install dir>/lib/*' MyClass 
```

如果使用 maven 获取 Jena，会自动拉入依赖项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T16:38:20.640

您的 Java 类路径缺少 Jena 所需的 jar 文件之一。看起来它是其中一个`slf4j`罐子。您需要在类路径中包含 Jena 附带的所有 jar 文件。如何设置类路径取决于您的操作系统和/或 IDE，但 Google 可以提供帮助。

# r - 不使用for循环的数组之间的交叉差异

> ID：12354802
> 
> 赞同：1
> 
> 时间：2012-09-10T15:27:38.653
> 
> 标签：r

使用以下代码：

```
a <- seq(1, 10, 1)
b <- seq(2, 20, 2) 
```

我想`a[i - 1]`从`b[i]`for each中减去`i`，以获得类似的东西

```
c <- NULL
for(i in 1:length(b)) {
   c[i] <- b[i] - a[i - 1]
} 
```

但我想在**不**使用`for()`循环的情况下做到这一点。

任何人都知道如何在**一个**命令行中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:29:48.163

由于你的`a`和`b`长度相同，我假设你想先修剪最后一个元素`b`。（试着`b - a[-1]`看看为什么这可能是可取的。）

```
b[-length(b)] - a[-1]
# [1] 0 1 2 3 4 5 6 7 8 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T17:10:09.400

您可以使用时间序列执行此操作：

```
 a <- ts(seq(1, 10, 1))
 b <- ts(seq(2, 20, 2))
 b- lag(a,1) 
##-----
Time Series:
Start = 1 
End = 9 
Frequency = 1 
[1] 0 1 2 3 4 5 6 7 8 
```

并不是说我一定要推荐这个。基本时间序列形式主义是一个广为担心的混乱来源。大多数人避免它，优先考虑 zoo 和 xts 类对象。

# c++ - 在 C++ 中使用文件时出现分段错误

> ID：12354806
> 
> 赞同：-3
> 
> 时间：2012-09-10T15:27:48.103
> 
> 标签：c++, c, segmentation-fault

我正在使用 ubuntu 12.04。我一直在为简单的 C++ 学校项目尝试一些 IDE。但是，使用 codelite、anjuta 和 kdevelop 我遇到了一个问题：当我试图读/写文件时，我得到了分段错误：核心转储。

我正在使用一个基本来源：

```
#include<stdio.h>

FILE*f=fopen("test.in","r");
FILE*g=fopen("test.out","w");

int main () {

    int a,b;
    fscanf(f,"%d %d",&a,&b);
    fprintf(g,"%d\n",a+b);

    fclose(f);
    fclose(g);

    return 0;
} 
```

我不得不说带有标准输入/标准输出的程序运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:41:01.107

The most likely problem is that the calls to `fopen` are not succeeding, perhaps because your program isn't being run from the same directory that contains the files. In that case, the pointers `f` and `g` will be null, and you must check for that before passing them to any C library functions.

You also need to check whether `fscanf` succeeded, otherwise using `a` and `b` will result in undefined behaviour (although that will most likely just cause the program to output garbage rather than crash).

You might be better off using `std::fstream` from the C++ library; but even then, you'll need to check whether the file streams were opened and the input read successfully.

# actionscript-3 - 公共功能访问失败

> ID：12354807
> 
> 赞同：0
> 
> 时间：2012-09-10T15:27:49.720
> 
> 标签：actionscript-3, flash

我有这种情况，我在我的主类中声明了一个如下所示的函数：

```
public class Main extends MovieClip
{

    public static var instance:Main;

    public function Main()
    {
        // constructor code
        welcomeScreen();
        instance = this;
    }

    public final function welcomeScreen():void
    {
        //some code in here
    }

    public final function startLevelOne():void 
    {
        //some other code here
    }

} 
```

在其他一些类中，我使用此语句来触发重置：

```
restart.addEventListener('click', function() {                                      
     Main.instance.welcomeScreen();
}); 
```

不知何故，在另一个类中，我尝试对“startLevelOne”使用相同的语句，但它似乎不起作用并给出了休闲错误：

```
1195: Attempted access of inaccessible method startLevelOne through a reference with static type Main. 
```

有任何想法吗？

**更新#1**

我尝试访问该函数的类是完整的这个类：

```
public class LevelBrief extends MovieClip
{

    public function LevelBrief()
    {
        // constructor code
        startBut.addEventListener('click', function() {
            Main.instance.startLevelOne();
        });
    }
} 
```

**更新#2**

我在这里粘贴了主要定义的完整代码[http://pastebin.com/s6hGv7sT](http://pastebin.com/s6hGv7sT)

其他类也可以在这里找到[http://pastebin.com/s6h3Pwbp](http://pastebin.com/s6h3Pwbp)

**更新#3**

即使通过解决方法解决了问题，我仍然无法理解问题出在哪里。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T07:46:28.390

我建议保留静态实例（单例），并基于事件工作。现在您将所有功能公开，这是不可取的。使用自定义事件并不难。看看这就是你的*Main*类的样子：

```
public class Main extends MovieClip
{
    public function Main()
    {
        this.addEventListener(Event.ADDED_TO_STAGE, handleAddedToStage);
    }

    public function handleAddedToStage(event:Event)
    {
        this.removeEventListener(Event.ADDED_TO_STAGE, handleAddedToStage);

        this.showWelcomeScreen();

        stage.addEventListener(ScreenEvent.SHOW_WELCOME_SCREEN, handleScreenEvent);
        stage.addEventListener(ScreenEvent.SHOW_LEVEL, handleScreenEvent);
    }

    private function handleScreenEvent(event:ScreenEvent):void
    {
        switch (event.type)
        {
            case ScreenEvent.SHOW_WELCOME_SCREEN:
            {
                this.showWelcomeScreen()
                break;
            }
            case ScreenEvent.SHOW_LEVEL:
            {
                // event.data contains level number
                this.startLevel(event.data);
                break;
            }
            default:
            {
                trace("Main.handleScreenEvent :: Cannot find event.type '" + event.type + "'.");
                break;
            }
        }
    }

    private function showWelcomeScreen():void
    {
        trace("show WelcomeScreen")
        //some private code in here
    }

    private function startLevel(level:int):void 
    {
        trace("start level: " + level)
        //some other private code here
    }
} 
```

这就是自定义事件类的外观（*ScreenEvent.as*）。请注意，它有一个名为*data*的可选参数。您可以将任何值（对象、数字、字符串等）传递给它。为了使示例尽可能清晰，我对两个动作都使用了一个事件类，您还可以选择为具有更详细参数的其他动作制作更具体的自定义事件，您可以使用*ScreenEvent*、*LevelEvent*、*PlayerEvent*、*GameEvent*等名称..

在类的顶部定义了（静态常量）类型。一个事件应该只有吸气剂。

```
package 
{
    import flash.events.Event;

    public class ScreenEvent extends Event
    {
        public static const SHOW_WELCOME_SCREEN:String = "ScreenEvent.showWelcomeScreen";
        // event.data contains level number
        public static const SHOW_LEVEL:String = "ScreenEvent.showLevel";

        private var _data:String;

        public function ScreenEvent(type:String, data:String):void 
        { 
            super(type);
            this._data = data;
        }

        public function get data():String
        {
            return this._data;
        }

        override public function clone():Event 
        { 
            return new ScreenEvent(this.type, this._data);
        }
    }
} 
```

.. 在您的代码中的任何地方，您都可以将事件*发送*到舞台。

```
// dispatch event to Main (stage). Should show welcome screen in our case
stage.dispatchEvent(new ScreenEvent(ScreenEvent.SHOW_WELCOME_SCREEN));

// show level 2
stage.dispatchEvent(new ScreenEvent(ScreenEvent.SHOW_LEVEL, 2)); 
```

我知道，它的代码有点多，一开始看起来更困难，但如果项目发展壮大，它将有很大帮助。与事件的区别是“*这可能发生，当它发生时，做这个*”而不是“*在这里做这个，在那里做那个*”的优点是，如果你在 Main 类中删除事件监听器，什么都不会中断（松散地耦合）。这使得维护更容易，它节省了一个单例，*如果*你愿意，你可以扩展 Main 类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:36:10.710

唔。鉴于您的代码，只有一个严重的问题 - PerwollGame 是什么？你在那里`public static var instance:PerwollGame;`，你给它分配了一个 Main 类型的对象。也许 PerwollGame 有一个`startLevelOne()`具有不同签名的函数，这会掩盖您在 Main 类中的函数。另外，回答你的其他人也是对的，你永远不应该在你的代码中使用嵌套函数，真的把你的那个监听器从内联声明中去掉。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T15:31:12.583

我想你写的

```
Main.startLevelOne(); 
```

代替

```
Main.instance.startLevelOne(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T05:17:58.257

我假设当您注册监听器时 Main.instance 尚未分配。您是否尝试在此处跟踪 Main 实例？

```
public function LevelBrief()
{
    // constructor code
    startBut.addEventListener('click', function() {
        Main.instance.startLevelOne();
    });
    trace(Main.instance); // I assume Main.instance is null
} 
```

如果您在 LevelBrief 的另一个方法中添加侦听器会怎么样：

```
public function registerListeners():void{
        trace("Main.instance == null? -> " + (Main.instance == null)); //not null here if called later.
        startBut.addEventListener('click', function() {
        Main.instance.startLevelOne();
        });
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-10T18:25:39.947

从您的编码风格和报告的错误来看，我假设您这样做了。

```
public static function startLevelOne():void 
```

静态方法和实例化对象之间有一条细线。

也永远不要使用嵌套函数

```
public class LevelBrief extends MovieClip
{

    public function LevelBrief()
    {
        // constructor code
        startBut.addEventListener('click', onMyClick )
    }

    public functiononMyClick (e:Event) {
            Main.instance.startLevelOne();
        });
    }
} 
```

# android - android谷歌地图填充（）VS无效（）

> ID：12354809
> 
> 赞同：3
> 
> 时间：2012-09-10T15:27:59.807
> 
> 标签：android, google-maps

我正在构建我的交互式地图，我发现自己真的很困惑：

我有一个 ItemizedOverlay 类的扩展，我正在管理覆盖。

当 shell 我使用它的 populate() 函数来更新 mapView 中的覆盖时，我什么时候应该使用 invalidate() 或 postInvalidate() 来更新地图。

我发现有时这是可行的，有时是另一个。

如果有人愿意解释每个功能的确切作用 - 我会非常感谢，因为我找不到一个像样的解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:44:38.827

当您想要填充叠加层时，应该使用 populate()。如果您只想重新绘制它，那么如果您在 UI 线程上，则应使用 invalidate()，如果您在另一个线程上，则应使用 postInvalidate()。无效方法适用于任何视图，无论是按钮还是文本视图或任何东西。他们基本上告诉 Android 一些与视图相关的变化，比如显示的数据或按钮的状态或颜色等等。然后，Android 将通过调用 View 的 onDraw() 方法尽快尝试重绘 View。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:32:38.620

我总是使用 invalidate() 并且从来没有遇到过问题......（即总是刷新）

# haskell - Haskell 嵌套循环累加器

> ID：12354810
> 
> 赞同：0
> 
> 时间：2012-09-10T15:27:59.687
> 
> 标签：haskell, loops, functional-programming, accumulator

我正在将我的服务器端编程语言从 PHP 修改为 Haskell，因此我并不完全熟悉函数式语言设计。

在这里，我想将类似以下 php 函数的部分处理代码转换为 Haskell：

```
function loop($A) {
  $array1 = array();
  $num = (int)$A;
  if ($num == 0)
    $array1 = "0";
  for (int $i=0; $i<$num; $i++)
    foreach (loop($i-$num) as &$value)
      $array1[] = "+ ".$value." ";  //concat
  return $array1;
} 
```

我想会大量使用 map/mapM_ 函数，但是累积将如何工作？我开始认为在这一点上增加的安全性不值得转型。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T00:08:31.290

这是我回答时的php：

```
function loop($A) {
  $array1 = array();
  $num = (int)$A;
  if ($num == 0)
    $array1 = "0";
  for (int $i=0; $i<$num; $i++)
    foreach (loop($i-$num) as &$value)
      $array1[] = "+ ".$value." ";  //concat
  return $array1;
} 
```

将上述代码直译为 Haskell 将是：

```
loop :: Int -> [String]
loop 0 = ["0"]
loop num = ["+ " ++ value ++ " " | i <- [0..num], value <- loop (i - num)] 
```

它仍然没有实现任何目标，但它确实给了您在列表推导中 Haskell 的“循环”或迭代的味道。

首先要注意的是，类型签名`loop :: Int -> [String]`立即提醒我写`loop 0 = ["0"]`，而不是`loop 0 = "0"`更确切地说是你所拥有的，但 Haskell 发现如果循环的输出有时是字符串列表，有时只是一个字符串，它的输出会不一致. 我认为这是一种值得学习的错误检查-也许您在修改时编写的所有代码都会在php中编译，但是由于设计不一致，Haskell*不会*-它迫使您在编写时思考清楚并修复错误在编译时间之前。

我将解释我的代码，而不是作为对 Haskell 的完整解释，而是作为品尝者并将其与您的代码相关联：

```
loop :: Int -> [String] 
```

`loop`是一个接受`Int`eger 并返回字符串列表的函数。Haskell 现在不允许您将其与任何其他数据类型一起使用，这意味着它是类型安全的，并且您可以直接从盒子中得到保护，避免各种讨厌的错误。类型系统实际上非常灵活、富有表现力和强大，这也是我们喜欢 Haskell 的原因之一，但在这里我使用它来锁定功能。

（列表在 Haskell 中被广泛使用，而不是数组。它们*非常*方便并且可以快速地进行顺序访问。有数组数据类型，但它们不那么可爱/Haskellish - 首先习惯于列表。）

```
loop 0 = ["0"] 
```

这意味着如果您`loop`使用 Int调用`0`，它应该返回带有一个字符串“0”的列表。

```
loop num = [ something | stuff... ] 
```

意味着您可以在其中获取变量的值`stuff`并将它们返回`something`，因此

```
loop num = [ "+ " ++ value ++ " " | stuff... ] 
```

意味着我们将返回 (Haskell 的版本) `"+ ".$value." "`。这里我们使用`++`而不是 php 的`.`.

```
i <- [0..num] 
```

这意味着 let `i`range from`0`到`num`。它必须是`Int`因为`num`是因为`loop :: Int -> ...`。

```
value <- loop (i - num) 
```

这意味着 let `value`range 跨越`loop`使用 number调用的结果`i - num`。 `value`必须是`String`因为`loop :: Int -> [String]`。

在 Haskell 中，就像递归调用被实现为表达式重写一样，因此它们在被调用时消失并且不会使堆栈混乱，除非您的计算本身会使堆栈变得混乱。

把它放在一起给出：

```
loop num = ["+ " ++ value ++ " " | i <- [0..num], value <- loop (i - num)] 
```

如果这个符号感觉很奇怪，你可能会更喜欢命令式的语法：

```
loop :: Int -> [String]
loop 0 = ["0"]
loop num = do
    i <- [0..num]
    value <- loop (i - num)
    return ("+ " ++ value ++ " ") 
```

当然它*仍然*没有做任何有用的事情，但至少它很容易跟踪。

为什么不通过h​​ttp: [//learnyouahaskell.com/](http://learnyouahaskell.com/)上的*Learn You a Haskell for Great Good*或[http://book.realworldhaskell.org/上的](http://book.realworldhaskell.org/)*Real World Haskell*学习，这两个教程开始简单但深入。我认为您会发现 Haskell 是一种编写少量正确代码来替换大量 OK 代码的好方法。想得更清楚，写得更少！

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-10T16:09:41.470

看起来你有某种字典。字典的典型 Haskell 数据结构是由`Map`提供的`Data.Map`。因此，如果您的键是`String`s 而您的值是`Int`s，那么您的 Map 将具有 type `Map String Int`。

现在，从您的代码来看，您似乎将键和值混合在同一个数组中，因此首先我们必须将它们分成键值对。我会假装你的起始输入是一个列表而不是一个数组，尽管我在这里写的所有东西都适用于 Haskell 数组：

```
fix :: [a] -> [(a, a)]
fix [] = []
fix [_] = []
fix (k:v:xs) = (k, v):fix xs 
```

您可以选择在关联列表处停止，在这种情况下，您可以将其转换为描述性字符串列表：

```
describe :: (Show k, Show v) => [(k, v)] -> [String]
describe xs = map (\(k, v) -> "Stored On: " ++ show k ++ ", item: " ++ show v) xs 
```

或者我们可以直接打印出来：

```
printPairs :: (Show k, Show v) => [(k, v)] -> IO ()
printPairs xs = mapM_ putStrLn (describe xs) 
```

现在，为了更有效的查找，您通常希望将关联列表存储为`Map`，因此您将使用的只是 中的`fromList`函数`Data.Map`：

```
fromList :: Ord k => [(k, v)] -> Map k v 
```

并且任何时候您想将列表从地图中取出（即打印它），您只需使用`toList`：

```
toList :: Map k v -> [(k, v)] 
```*

# scala - 自动为类参数制作吸气剂（以避免案例类）？

> ID：12354812
> 
> 赞同：13
> 
> 时间：2012-09-10T15:28:05.880
> 
> 标签：scala

在 Scala 中，如果我们有

```
class Foo(bar:String) 
```

我们可以创建一个新对象但不能访问`bar`

```
val foo = new Foo("Hello")
foo.bar // gives error 
```

但是，如果我们声明这`Foo`是一个`case class`这样的作品：

```
case class Foo(bar:String) 
val foo = Foo("hello")
foo.bar // works 
```

因此，我被迫将我的许多课程作为案例课程。否则，我必须编写样板代码来访问`bar`：

```
class Foo(bar:String) {
  val getbar = bar
} 
```

所以我的问题是：

1.  有没有办法在不使用案例类或样板代码的情况下“解决”这个问题？
2.  在这种情况下使用案例类是个好主意吗？（或者案例类的缺点是什么？）

我想第二个值得一个单独的问题。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-10T15:32:48.740

只需在构造函数中使用 val 关键字即可公开访问：

```
class Foo(val bar:String) {

} 
```

至于您的问题：如果这是您需要的唯一功能，请不要使用案例类，只需使用`val`.

*但是，很高兴知道为什么案例类不好。*

在案例类中，**所有**参数默认都是公共的，而在普通类中它们都是私有的。但是您可以调整此行为：

```
scala> class Foo(val bar:String, baz: String)
defined class Foo

scala> new Foo("public","private")
res0: Foo = Foo@31d5e2

scala> res0.bar
res1: String = public

scala> res0.baz
<console>:10: error: value baz is not a member of Foo
              res0.baz 
```

甚至像这样：

```
class Foo(private[mypackage] val bar:String) {
  // will be visible only to things in `mypackage`
} 
```

对于案例类（感谢@JamesIry）：

```
case class Bar(`public`: String, private val `private`: String) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-10T15:31:58.483

您可以使用 BeanProperty 注解自动生成类似 java 的 getter

```
import scala.reflect.BeanProperty
case class Foo(@BeanProperty bar:String) 
```

现在 Foo 有一个返回`bar`值的 getBar 方法。

请注意，这仅在您有充分的理由使用类似 java 的 getter 时才有用（典型的原因是您需要您的类是正确的 java bean，以便与期望 java bean 并使用反射的 java 库一起工作访问 bean 的属性）。

否则，直接访问`bar`值，这就是“scala 方式”。

见[http://www.scala-lang.org/api/current/index.html#scala.reflect.BeanProperty](http://www.scala-lang.org/api/current/index.html#scala.reflect.BeanProperty)

# jquery - pinterest 类型滚动

> ID：12354814
> 
> 赞同：0
> 
> 时间：2012-09-10T15:28:21.510
> 
> 标签：jquery, html

有谁知道[pinterest](http://pinterest.com/)是如何滚动的。是否有任何 jquery 组件或类似的东西可以处理这种延迟加载设置。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:33:14.673

干得好：

[http://isotope.metafizzy.co/demos/infinite-scroll.html](http://isotope.metafizzy.co/demos/infinite-scroll.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:35:39.403

只需要一点创意：

第 1 步：在内容堆栈的底部放置一个元素。

第 2 步：编写一个函数来检测该元素何时位于或靠近视口底部。

第 3 步：编写一个加载更多内容的函数

第 4 步：使用第 2 步中的函数触发第 3 步中的函数。

# c# - 将徽标准确地居中对齐

> ID：12354818
> 
> 赞同：0
> 
> 时间：2012-09-10T15:28:34.410
> 
> 标签：c#, asp.net, html, css

```
 CSS:
 #header_bar
{
background-repeat: repeat-x;
width:100%;
}

.langpnl
{
float:right;
padding-top: 2px;
padding-right: 0px;
position:relative;
width:45px; 
height:16px; 
font-size:7pt;
}

#imgLogo
{
width: 156px; 
height: 42px;
}

<!-- header.ascx -->
<div id="header_bar">
<div align="center">
    <a href="<%=AppPath%>" target="_parent" >
        <img id="imgLogo" runat="server" src="~/images/UI/logo.jpg"   border="0" /></a>
       <asp:DropDownList ID="ddlLanguage"  class="langpnl" runat="server" AutoPostBack="True" OnSelectedIndexChanged="ddlLanguage_SelectedIndexChanged">
        <asp:ListItem Value="">EN</asp:ListItem>
        <asp:ListItem Value="es-ES">ES</asp:ListItem>
    </asp:DropDownList>
  </div>
 </div>
 <!-- /header.ascx --> 
```

我正在尝试将中心的图像和下拉框对齐到右上角。目前我可以做到，但图像稍微偏左。如果我只删除下拉框，它就会进入中心。在系统浏览器中您无法弄清楚，但这是一个移动网站，在移动视图中您可以找出差异。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T15:39:02.053

这是实现您正在寻找的东西的一种方法：

[http://jsfiddle.net/NzZak/](http://jsfiddle.net/NzZak/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:39:29.027

您绝对可以定位下拉菜单 -[**演示**](http://dabblet.com/gist/3691612)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T15:39:54.707

```
<!-- header.ascx -->
<div id="header_bar">
<div id="header_logo_holder">
    <a href="<%=AppPath%>" target="_parent" >
        <img id="imgLogo" runat="server" src="~/images/UI/logo.jpg"   border="0" /></a>
       <asp:DropDownList ID="ddlLanguage"  class="langpnl" runat="server" AutoPostBack="True" OnSelectedIndexChanged="ddlLanguage_SelectedIndexChanged">
        <asp:ListItem Value="">EN</asp:ListItem>
        <asp:ListItem Value="es-ES">ES</asp:ListItem>
    </asp:DropDownList>
  </div>
 </div>
 <!-- /header.ascx --> 
```

“header_logo_holder”的 CSS 代码

```
#header_logo_holder {
width: 156px;
margin:0px auto 0px auto;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T15:39:56.657

由于您`.langpnl`有一个`position:relative`，它仍然在您的定位流程中占据空间。
尝试：

```
.langpnl { 
  position:absolute; 
  right: 0;
}
#header_bar {
  position: relative;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-10T16:27:06.257

```
#header_bar {
  background-repeat: repeat-x;
  width: 100%;
  padding: 0;
  margin: 0; /* New */
}

.langpnl {
  float: right;
  padding-top: 2px;
  padding-right: 0px;
  position: relative;
  width: 45px;
  height: 16px; 
  font-size: 7pt;
  vertical-align: top; /* New */
}

#imgLogo {
  width: 130px;
  height: 35px;
  text-align: center;
  border:0px; /* New */
} 
```

这解决了这个问题。

# javascript - 如何在异步函数中使用javascript对象

> ID：12354820
> 
> 赞同：0
> 
> 时间：2012-09-10T15:28:46.033
> 
> 标签：javascript, npapi

提前致谢 。

我正在创建一个函数，如下所示。//requestFile 在 NPAPI 插件中实现，当任务完成时将 initFS 作为 NPObject 我在此对象上调用 NPN_InvokeDefault。

```
window.requestFile("test",true,initFS);
//After this function initFS is getting called.
function initFS(fs) {
 alert('Inside initFS'); //alert is coming.
 //testFunc is implemented in NPAPI Plugin, it will return true if it is get called
 alert(fs.testFunc());   // It is not getting called.
 alert(fs.testCall());   //It is not getting called.
 }
function testCall() {
alert('Inside testCall function');
} 
```

在调用 NPN_InvokeDefault 后，我​​没有得到它从插件返回的对象类型。以及如何在 javascript 中使用它。具体来说，我想专门为我的插件返回 NPObject，并想从 javascript 调用插件方法。

如何将异步 Javascipt 函数与 NPAPI 插件一起使用？任何样品将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:49:30.627

使用这个（[小提琴](http://jsfiddle.net/sJHyN/1/)）作为起点：

```
 var testcall=function() {
    alert('Inside testCall function');
    }

    var fs={
        testFunc: function(){console.log("succes")},
        testCall:testcall
    }

    //After this function initFS is getting called. 

    initFS(fs) //<--PASS in fs also

function initFS(fs) {
     alert('Inside initFS');
     //testFunc is implemented in NPAPI Plugin, it will return true if it is get called
     fs.testFunc();   // It is not getting called.
     fs.testCall();   //It is not getting called.
     } 
```

您需要将`fs`对象传入`initFS`

# c# - MVC 处理站点的 CorpId

> ID：12354821
> 
> 赞同：1
> 
> 时间：2012-09-10T15:28:51.537
> 
> 标签：c#, asp.net-mvc, razor

我不确定我是否以正确的方式处理这个问题，但由于我遇到了问题，我想我不是。

加载登录屏幕时，我必须发送一个公司 ID。

看起来像这样：

```
public ActionResult LogOn(string id)
{
  var sb = new StringBuilder();
  sb.AppendLine(string.Format("CorpID: {0}", id));

  if(ViewBag.CorpID != null)
    sb.AppendLine(string.Format("ViewBag.CorpID: {0}", ViewBag.CorpID));

  Guid corpIdGuid;
  if (!Guid.TryParse(id, out corpIdGuid) && string.IsNullOrEmpty(ViewBag.CorpID))
    return null;

  // the id passed in will take presidence over the 
  // viewbag unless it is blank then we use viewbag
  // one way or the other viewbag.corpid should not
  // be blank
  if(!string.IsNullOrEmpty(id))
    ViewBag.CorpID = id;

  // Session["CorpId"] = id;
  //Not a junk guid.. continue.
  return View();
} 
```

我需要这个来确定我们将在本次会议期间与哪家公司合作。

我遇到的问题是，当 cookie 超时发生时，设置为 10 分钟，它将它们引导回此登录，我不再有 corpid。

我试过了`viewbag`，它正在被重置。

我尝试了一个cookie，但由于它过期，数据不再存在。

我尝试了一个配置文件管理器，但由于他们记录了它，这让我一无所获。

`CorpId`当用户超时并重新回到登录屏幕时，我该如何维护？我也需要为每个屏幕提供此信息。

任何投入将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:33:40.123

您需要创建一个单独的 cookie，用于标识不会随用户会话过期的**公司 ID 。**`Session["CorpId"]`将随着用户会话过期并且无法工作。

```
var corpCookie = new HttpCookie("CorpID", id);
corpCookie.Expires = DateTime.Now.AddDays(30.0);
HttpContext.Current.Response.Cookies.Set(corpCookie); 
```

每次用户登录时，您都可以更新到期时间以使其成为滑动到期时间。要检索 cookie 值，请使用以下命令：

```
var corpID = HttpContext.Current.Request.Cookies.Get("CorpID").Value; 
```

# haskell - Haskell - 列表理解谓词优化

> ID：12354824
> 
> 赞同：9
> 
> 时间：2012-09-10T15:29:16.797
> 
> 标签：haskell

这是Learn you a Haskell中的一个例子：

```
ghci> [ x*y | x <- [2,5,10], y <- [8,10,11], x*y > 50]  
[55,80,100,110] 
```

那么，这里发生了什么，会`x*y`计算两次还是一次呢？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-10T15:43:07.433

除非发生公共子表达式消除，否则它将计算两次。

根据内联和您的优化级别，GHC 可能会对列表理解做一些非常激进的事情。

通常，您应该明确共享常用表达式以保证共享。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-09-10T15:42:51.087

为了确定编译器的行为，更喜欢：

```
[ product | x <- [2, 5, 10]
          , y <- [8, 10, 11]
          , let product = x * y
          , product > 50] 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-10T16:22:14.577

使用 -O2 选项编译时查看核心，它具有以下几行（相关和简化）

```
 case (y_aAD * sc_s1Rq) > 50 of 
            False -> go_XB2 sc1_s1Rr;
            True -> (y_aAD * sc_s1Rq):(go_XB2 sc1_s1Rr) 
```

这清楚地表明乘法计算了两次，因此最好使用通用表达式以防止重新计算。

# ios - UIAccessibilityAnnouncementNotification 异步问题

> ID：12354828
> 
> 赞同：4
> 
> 时间：2012-09-10T15:29:21.503
> 
> 标签：ios, synchronization, notifications, voiceover, uiaccessibility

我注意到 UIAccessibility 发布通知方法是某种异步调用。这对我来说听起来很正确，因为您需要听到最后的事件，而不是昨天发生的事件......但是请看这个例子：

```
UIAccessibilityPostNotification( UIAccessibilityAnnouncementNotification, @"String 1");
UIAccessibilityPostNotification( UIAccessibilityAnnouncementNotification, @"String 2"); 
```

您只能听到“字符串 2”。

这个例子很简单，你可以回答可以将“string 2”附加到“string 1”，问题就解决了。但我处于这种情况，但我不能附加两个字符串。

我的问题是：有没有同步通知的方法？

另一个例子如下。假设您有一个标签栏应用程序。当您切换到特定栏时，我希望 VoiceOver 说出特定文本。您可能知道，当您选择一个选项卡时，VoiceOver 会说自己类似于“已选择 Bar1 栏”。

所以... VoiceOver 公告涵盖了我自己的特定文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T08:40:46.983

对于 iOS 6.0+，您可以使用 UIAccessibilityAnnouncementDidFinishNotification 来同步您的公告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-06T16:46:12.003

自 iOS 11 以来，引入了新的[属性辅助功能属性](http://a11y-guidelines.orange.com/mobile_EN/dev-ios-wwdc-17215.html#AttributedProperties)，包括一个特定的`accessibilitySpeechQueueAnnouncement`键，可以将公告排队或中断当前语音。

但是，如果您发送了许多通知并且 VoiceOver 需要接管*（例如，用户轻弹以聚焦新元素）*，则一旦系统发出元素的属性（[stackoverflow answer](https://stackoverflow.com/a/52459406/3825084)） ，未发出声音的通知将被删除.

在我看来，这是目前**同步通知的最佳方式**。

对于您关于标签栏的第二个请求，可以编写一个新的专门问题......

# c# - Jenkins - 仅使用从机进行回归测试

> ID：12354832
> 
> 赞同：0
> 
> 时间：2012-09-10T15:29:23.380
> 
> 标签：c#, build, jenkins, jenkins-plugins

我有一台输出 MSI 的 Jenkins 构建机器。

我需要将它安装在远程机器上并在那里运行几个测试（假设我有可执行的回归测试解决方案）。

我想也许有一台回归机器，在那里安装 Jenkins 作为奴隶，使用所有正确的路径创建回归作业来调用回归解决方案。

可行吗？从站会向主站报告失败的断言吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T14:39:51.567

您指定的配置是有效的，并且应该可以工作，
但请注意，您的回归测试工具应该在失败的情况下返回*非零*结果。

如果这对于您计划拥有的测试机制来说不是微不足道的，
您可以使用其中一个插件来扫描测试日志
（在屏幕上或在日志文件中）并捕获任何错误
以将其标记为运行失败”或“不稳定”：

*   **[文本查找器插件](https://wiki.jenkins-ci.org/display/JENKINS/Text-finder+Plugin)**- 配置更简单，但选项更少

*   **[日志解析器插件](https://wiki.jenkins-ci.org/display/JENKINS/Log+Parser+Plugin)**- 需要一个配置文件，但提供更多控制
    （可以为同一作业定义不同的“失败”和“不稳定”规则）

# java - 如何通过 java 实现和使用命令提示符命令并在 java 中查看结果？

> ID：12354834
> 
> 赞同：0
> 
> 时间：2012-09-10T15:29:27.687
> 
> 标签：java, cmd

如何通过 java 实现和使用命令提示符命令并在 java 中查看结果？命令提示符命令如下：

1.  `cd Desktop\nikto-2.1.4`
2.  `nikto.pl -h www.cirt.net -ssl .`

为了能够在 java 中使用这些命令并查看结果，我应该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T15:31:56.003

我将使用 ProcessBuilder 设置当前目录并使用`cmd.exe`. 我会将错误和输出结合起来，并将输出读入您的 Java 程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T20:33:55.500

运行命令的一种简单方法是使用*Process*对象。

```
String[] commands = { "cd Desktop\nikto-2.1.4", "nikto.pl -h www.cirt.net -ssl ." }
Process process = Runtime.getRuntime().exec( commands );
try {
    InputStream is = process.getInputStream();
    try {
        //.... do something        
    } 
    finally { is.close(); }
}
finally { process.destroy(); } 
```

现在处理所有这些不同的流可能会很麻烦，因此 - > Lawrey 先生建议的 java.lang.ProcessBuilder。它是 JVM 提供的一个实用程序类，旨在简化 Process 对象的使用。这将使给定的示例更容易忍受。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T12:58:57.470

以下代码将显示 的输出`nikto.pl -h www.cirt.net -sslb`，允许您捕获和操作它。

```
cd Desktop\nikto-2.1.4
for /f "tokens=*" %%x in ('nikto.pl -h www.cirt.net -sslb') do echo %%x 
```

# mysql - 创建mysql索引

> ID：12354836
> 
> 赞同：0
> 
> 时间：2012-09-10T15:29:32.830
> 
> 标签：mysql

我有疑问：

```
EXPLAIN SELECT * FROM _mod_news USE INDEX ( ind1 )  WHERE show_lv =1 AND active =1 AND START <= NOW( ) 
AND ( END >= NOW( )  OR END =  "0000-00-00 00:00:00" ) AND id <>  "18041" AND category_id =  "3" AND leta =1 ORDER BY sort_id ASC , DATE DESC  LIMIT 7 
```

结果：

```
id  select_type table   type    possible_keys   key key_len ref rows    Extra
1   SIMPLE  _mod_news   ref ind1    ind1    2   const,const 11386   Using where; Using filesort 
```

mysql正在执行全表扫描

ind1 =

```
ALTER TABLE `_mod_news` ADD INDEX ind1 ( `show_lv`, `active`,  `start`, `end`, `id`, `category_id`, `leta`, `sort_id`, `date`); 
```

我在以下索引上进行了测试，但没有任何变化

```
ALTER TABLE `_mod_news` ADD INDEX ind1 ( `show_lv`, `active`,  `start`, `end`, `id`, `category_id`, `leta`); 
```

问题是：我可以在哪里学习如何在许多条件下创建索引？或者有人可以解释如何告诉mysql使用和索引而不是扫描整个表。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T19:10:21.873

我建议不要强制索引。Mysql 擅长选择最佳索引，除非您对正在查询的数据有更好的理解。

您不能使用 ORDER BY 优化，因为您在该部分中混合了 ASC 和 DESC。

因此，您唯一的选择是创建索引，以便：

*   范围前的常数值
*   日期前的整数，字符串前的日期，较大尺寸值前的较小尺寸值

创建一个大索引也会增加存储和插入更新时间的开销，所以我不会添加到没有消除很多行的索引字段（即 90% 或行的值为 1 或 ie`id<>"18041"`但很可能会消除< 1% 的行）。

如果您想了解有关优化的更多信息：http: [//dev.mysql.com/doc/refman/5.0/en/select-optimization.html](http://dev.mysql.com/doc/refman/5.0/en/select-optimization.html)

创建多个不同的索引（根据您希望在表中看到的适当大小的数据），查看哪个 mysql 选择，通过强制每个索引对它们进行基准测试，然后使用您的常识来减少索引空间的使用。

您可以从 EXPLAIN 输出中看到它实际上没有执行全表扫描，因为在这种情况下，即使您强制它，它也不会使用索引显示它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:38:42.630

您可以尝试使用 USE INDEX 或[FORCE INDEX](http://dev.mysql.com/doc/refman/5.1/en/index-hints.html)

# c++ - C++ 散列算法

> ID：12354841
> 
> 赞同：0
> 
> 时间：2012-09-10T15:29:47.683
> 
> 标签：c++, hash, sha1

我有以下算法（基于 SHA-1 哈希函数实现）。它产生“abc”的哈希值。结果是未签名的`char*`摘要。

```
#define BYTES "abce"
SHA1* sha1 = new SHA1();
sha1->addBytes( BYTES, strlen( BYTES ) );
unsigned char* digest = sha1->getDigest(); 
```

我想重新整理结果摘要。我正在按以下方式执行此操作，但不起作用。定义的`char* S`东西不同于?`#define BYTES "abce"`

```
char* S = reinterpret_cast<char*>(digest);
sha1 = new SHA1();
sha1->addBytes( S, strlen( S ) );           
unsigned char* digest1 = sha1->getDigest(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T15:32:24.590

`strlen`除了 C 风格的字符串之外，不要使用任何东西。

```
 sha1->addBytes( S, strlen( S ) ); 
```

这是没有意义的。您可能需要 20，即 SHA 摘要的大小。

# spring - IOC 设计模式是否独立于工厂设计模式？

> ID：12354845
> 
> 赞同：4
> 
> 时间：2012-09-10T15:30:07.523
> 
> 标签：spring, design-patterns, dependency-injection, inversion-of-control

我在某处读到，IOC 与工厂模式不同。由于工厂设计模式更具侵入性，而依赖注入则不然。

有人可以详细说明一下吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T16:23:36.183

是的，IoC 和 Factory 是两个不同的东西。IoC 实际上是一个更通用的术语，很多东西都可以称为 IoC，因此它有助于进一步完善您所指的内容。例如，从技术上讲，任何回调或事件都被视为 IoC 的实现。然而，大多数人在谈论 IoC 时指的是依赖注入。

您可以使用工厂来实现控制反转，就像您可以使用依赖注入来实现它一样。

您可能想到的是一个依赖注入容器，例如 Unity、Windows 或 Ninject。DI 容器是一种被美化的抽象泛型工厂，但它做的远不止这些，包括对象生命周期管理、条件绑定等……

将模式（IoC 或 DI）与实现（工厂、DI 容器、Poor mans DI 等）分开很重要，即使实现本身也可能是模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T05:09:09.657

控制容器的反转主要不用于依赖注入。这是让容器控制你的对象的生命周期。因此`inversion of control`.

这就是为什么在容器中注册东西时总是指定生命周期（或者只使用默认生命周期）

但是，由于容器会为您创建对象，因此它还可以提供依赖注入作为额外功能。所以这真的是一个奖金。

另一方面，工厂模式应该总是创建一个新对象。工厂模式的目的只是为您创建正确的实现。

# php - cakephp 选择多个只通过第一个值

> ID：12354848
> 
> 赞同：2
> 
> 时间：2012-09-10T15:30:10.413
> 
> 标签：php, cakephp, select

我已经生成了一个表单，其中一些字段是多选的。这些值是从 foreach 生成的（由于所需的格式）：

```
echo '<select name="data[formdata]['.$question['PrPageQuestion']['ID'].']" id="formdata'.$question['PrPageQuestion']['ID'].'" multiple="multiple">';
foreach($contacts as $contact):
    echo '<option value="'.$contact['PrDataContact']['ID'].'">'.$contact['PrDataContact']['Name'].' ('.$contact['PrDataContact']['Email'].')</option>';
endforeach;
echo '</select>'; 
```

但是，当我选择多个并提交表单时，我运行调试时只传递了一个值，而不是预期的字符串。

html输出为：

```
<select name="data[formdata][2]" id="formdata2" multiple="multiple">
    <option value="13">A Contact (a.contact@email.com)</option>
    <option value="14">A. Nother-Contact (a.n.contact@email.com)</option>
    <option value="15">A. New. Contact (anc@email.com)</option>
    <option value="17">New Conti (new@conti.com)</option>
</select> 
```

var_dump 的输出是：

```
array(2) { 
    ["_method"]=> string(4) 
    "POST" ["data"]=> array(1) { 
        ["formdata"]=> array(8) { 
        //other data was here
        [1]=> string(1) "1" 
        [2]=> string(2) "15" 
        [3]=> string(1) "4" 
        [4]=> string(0) "" 
        } 
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:54:15.757

需要在名字后面加上 [ ] 告诉 html 这是一个要提交的值的数组

```
echo '<select name="data[formdata]['.$question['PrPageQuestion']['ID'].'][]" id="formdata'.$question['PrPageQuestion']['ID'].'" multiple="multiple">';
foreach($contacts as $contact):
    echo '<option value="'.$contact['PrDataContact']['ID'].'">'.$contact['PrDataContact'['Name'].' ('.$contact['PrDataContact']['Email'].')</option>';
endforeach;
echo '</select>'; 
```

然后你应该得到：

```
array(2) { 
    ["_method"]=> string(4) 
    "POST" ["data"]=> array(1) { 
        ["formdata"]=> array(8) { 
        //other data was here
        [1]=> string(1) "1" 
        [2]=> array(2) {
           [0]=>string(2) "15"
           [1]=>string(2) "17"
        },
        [3]=> string(1) "4" 
        [4]=> string(0) "" 
        } 
    }
} 
```

# objective-c - 如何在目标c中取两个字符串的联合和交互？

> ID：12354849
> 
> 赞同：-3
> 
> 时间：2012-09-10T15:30:09.750
> 
> 标签：objective-c, union, intersection

我有一个要求，比如在目标 c 的字符级别上使用 UNION 和 INTERSECTION。

“字符串A”，“字符串B”

上述字符串的（UNION）情况下的结果：“StringAB” 上述字符串的（交集）情况下的结果：“String”

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T11:12:23.417

在stackoverflow成员的帮助下，我终于解决了这些问题

路口：

```
NSMutableSet *set1 = [NSMutableSet setWithArray: array1];
NSSet *set2 = [NSSet setWithArray: array2];
[set1 intersectSet: set2];
NSArray *resultArray = [set1 allObjects]; 
```

UNION：连接两个字符串并从该字符串中删除重复的字符，最后你会得到 UNION :)

```
SString *input = @"addbcddaa";
NSMutableSet *seenCharacters = [NSMutableSet set];
NSMutableString *result = [NSMutableString string];
[input enumerateSubstringsInRange:NSMakeRange(0, input.length) options:NSStringEnumerationByComposedCharacterSequences usingBlock:^(NSString *substring, NSRange substringRange, NSRange enclosingRange, BOOL *stop) {
    if (![seenCharacters containsObject:substring]) {
        [seenCharacters addObject:substring];
        [result appendString:substring];
    }
}];
NSLog(@"String with duplicate characters removed: %@", result);
NSLog(@"Sorted characters in input: %@", [seenCharacters.allObjects sortedArrayUsingSelector:@selector(compare:)]); 
```

谢谢！

# web-services - prestashop api 安全性

> ID：12354850
> 
> 赞同：0
> 
> 时间：2012-09-10T15:30:11.667
> 
> 标签：web-services, security, access-token, prestashop

我即将构建一个 iOS 电子商务应用程序。此应用程序将查询现有 prestashop 安装的 prestashop webservice api。我一直在使用 prestashop 网络服务，到目前为止它似乎工作得相当好，除了缺乏安全性：没有类似令牌的架构可以用来跟踪用户的身份验证。是我遗漏了什么还是 Prestashop 没有这个功能？你的方法是什么？有没有我可以安装和解决这个问题的模块？我真的很想手动限制 prestashop 的尽可能多的编码扩展。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T07:13:29.950

Prestashop Web 服务使用身份验证密钥进行保护：http: [//doc.prestashop.com/display/PS14/Chapter+1+-+Creating+Access+to+Back+Office](http://doc.prestashop.com/display/PS14/Chapter+1+-+Creating+Access+to+Back+Office)

# java - Antlr 3.4.0 生成的解析器的输入不匹配，而不是在解释器中

> ID：12354852
> 
> 赞同：1
> 
> 时间：2012-09-10T15:30:21.040
> 
> 标签：java, antlr, grammar, antlr3

我知道这已经被讨论过一千次，但我仍然无法弄清楚为什么遵循语法失败。在解释器中，一切正常，没有任何错误或警告。但是，在运行生成的代码时，我得到的输入不匹配，如下所示。

对于这个语法：

```
grammar xxx;

options {
    language = Java;
    output = AST;
}

@members {
  @Override
    public String getErrorMessage(RecognitionException e,
    String[] tokenNames)
    {
        List stack = getRuleInvocationStack(e, this.getClass().getName());
        String msg = null;
        if ( e instanceof NoViableAltException ) {
            NoViableAltException nvae = (NoViableAltException)e;
            msg = " no viable alt; token="+e.token+
            " (decision="+nvae.decisionNumber+
            " state "+nvae.stateNumber+")"+
            " decision=<<"+nvae.grammarDecisionDescription+">>";
        }
        else {
          msg = super.getErrorMessage(e, tokenNames);
        }
        return stack+" "+msg;
    }

  @Override
    public String getTokenErrorDisplay(Token t) {
      return t.toString();
    }
}

obj
      : first=subscription 
      (COMMA other=subscription)*
      ;

subscription
      : ID
      (EQUALS arguments_in_brackets)?
      filters
      ;

arguments_in_brackets
      : LOPAREN arguments ROPAREN
      ;

arguments
      : (arguments_body)
      ;

arguments_body
      : argument (arguments_more)?
      ;

arguments_more
      : SEMICOLON arguments_body
      ;

argument
    : id_equals argument_body
    ;

argument_body
    :   STRING
    |   INT
    |   FLOAT
    ;

filters
      : LSPAREN expression RSPAREN
      ;

expression
      :  or
      ;

or
    : first=and
    (OR^ second=and)*
    ;

and        : first=atom
    (AND^ second=atom)*
    ;

atom
    : filter
    | atom_expression
    ;

atom_expression
    : LCPAREN
    expression
    RCPAREN
    ;

filter
    : id_equals arguments_in_brackets
    ;

id_equals
    : WS* ID WS* EQUALS WS*
    ;

COMMA: WS* ',' WS*;
LCPAREN : WS* '(' WS*;
RCPAREN : WS* ')' WS*;
LSPAREN : WS* '[' WS*;
RSPAREN : WS* ']' WS*;
LOPAREN : WS* '{' WS*;
ROPAREN : WS* '}' WS*;
AND: WS* 'AND' WS*;
OR: WS* 'OR' WS*;
NOT: WS* 'NOT' WS*;
EQUALS: WS* '=' WS*;
SEMICOLON: WS* ';' WS*;

ID  :   ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*
    ;

INT :   '0'..'9'+
    ;

FLOAT
    :   ('0'..'9')+ '.' ('0'..'9')* EXPONENT?
    |   '.' ('0'..'9')+ EXPONENT?
    |   ('0'..'9')+ EXPONENT
    ;

//    :  '"' ( ESC_SEQ | ~('\\'|'"') )* '"'
//    :   '"' (~'"')* '"'
STRING
    :   '"' (~'"')* '"'
    ;

fragment
EXPONENT : ('e'|'E') ('+'|'-')? ('0'..'9')+ ;

fragment
HEX_DIGIT : ('0'..'9'|'a'..'f'|'A'..'F') ;

fragment
ESC_SEQ
    :   '\\' ('b'|'t'|'n'|'f'|'r'|'\"'|'\''|'\\')
    |   UNICODE_ESC
    |   OCTAL_ESC
    ;

fragment
OCTAL_ESC
    :   '\\' ('0'..'3') ('0'..'7') ('0'..'7')
    |   '\\' ('0'..'7') ('0'..'7')
    |   '\\' ('0'..'7')
    ;

fragment
UNICODE_ESC
    :   '\\' 'u' HEX_DIGIT HEX_DIGIT HEX_DIGIT HEX_DIGIT
    ;

NEWLINE:    '\r'? '\n' {skip();} ;

WS:     (' '|'\t')+ {skip();} ; 
```

对于这个输入：

```
status={name="Waiting";val=5}[ownerEmail1={email="dsa@fdsf.ds"} OR internalStatus={status="New"}],comments={type="fds"}[(internalStatus={status="Owned"} AND ownerEmail2={email="dsa@fds.ds"}) OR (role={type="Contributor"} AND status={status="Closed"})] 
```

我越来越：

```
line 1:67 [obj, subscription, filters, expression, or, and, atom, filter, arguments_in_brackets] mismatched input [@18,67:80='internalStatus',<11>,1:67] expecting  ROPAREN
line 1:157 [obj, subscription, filters, expression, or, and, atom, atom_expression, expression, or, and, atom, filter, arguments_in_brackets] mismatched input [@42,157:167='ownerEmail2',<11>,1:157] expecting ROPAREN 
```

有人可以给我任何线索，为什么会失败？我尝试以多种方式重写它，但错误仍然相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T07:49:45.953

问题是您`WS`在其他词法分析器规则中使用标记，因此跳过这些标记。这会导致词法分析器完全丢弃这些标记，然后不能在解析器规则中使用。

所以，如果你有这样的规则：

```
WS : ' ' {skip();}; 
```

然后在`NOT`：

```
NOT : WS* 'NOT' WS*; 
```

它也会导致`NOT`令牌被跳过。

如果您已经跳过这些`WS`字符，则不需要将它们包含在其他词法分析器规则中：只需删除所有`WS*`其他规则：

```
...
NOT : 'NOT';
... 
```

*（也从解析器规则中删除它们：`skip`来自词法分析器的所有 ped 标记在解析器规则中永远不可用！）*

# javascript - 如何在谷歌网站中使用 javascript 获取当前页面的 url？

> ID：12354855
> 
> 赞同：2
> 
> 时间：2012-09-10T15:30:30.947
> 
> 标签：javascript

如何在 Google 协作平台中使用 javascript 获取当前页面的 url？我需要使用所有参数获取当前页面的完整 url。 `window.location.href`返回`http://nosuchhost.invalid:80`。它只发生在 Google 网站中，在 Google 博客中`window.location.href`运行良好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:38:45.210

[You can't run javascript in a google site](http://productforums.google.com/forum/#!topic/sites/0tIPJ_qFaW0).

> It won't work as I don't think Google Sites will ever offer JavaScript.
> 
> What you have to remember is that your Google Site is always at a google.com address and, therefore, many people, firewalls and virus checkers automatically trust everything at a google.com address: Javacript can deliver malicious code, so it's never going to happen. You should be able to add the javascript through a gadget.

and...

> As Steegle has noted, we won't be adding JavaScript anytime soon to the capabilities of Sites.

# spring - Spring 配置和运行时分离

> ID：12354856
> 
> 赞同：3
> 
> 时间：2012-09-10T15:30:34.110
> 
> 标签：spring, architecture

使用 Spring 时，将运行时数据合并到 bean 构造中是相当麻烦的。虽然有一些技术可以规避这种分离，但我觉得它是有原因的。我的问题是这是否是一个已知的范式，以及是否有任何文献讨论它。我个人发现它既有优点也有缺点，具体取决于应用程序的动态性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:16:38.757

您至少有五个众所周知的方法可以将运行时数据传递给 bean 配置：

*   用于`ApplicationContextInitializer`添加`PropertySources`到`Enviroment`.
*   使用 SPEL 注入依赖项。
*   利用`FactoryBeans.`
*   使用`factory-bean`和`factory-method`属性。
*   如果你编写需要运行时数据的类，你只需要注入提供它的协作者。

例如

```
 <bean id="requestAttributeReader" class="example.RequestAttributeReader" />

    <bean id="requestInjectedBean" class="example.RequestInjectedBean" scope="request">
        <property name="a" value="#{requestAttributeReader.a}" />
    </bean>

    Class RequestAttributeReader {

          public String getA() {
               return RequestContextHolder.getAttributes().getAttribute("a");
         }
    } 
```

**编辑**

IoC 容器的 bean 描述文件允许您在应用程序 bean 上配置实现器。这通常是您要用于具体配置的实现类的静态定义，因此 xml 对它有好处。

如果你需要根据运行时选择一个实现者，那么你需要编写代码来选择它们，然后通知容器。

例如，使用`PropertySources`and `PropertyPlaceholderConfigurer`：

```
 String service = "example.NormalService";

    if (BOSS_USERNAME.equals(System.getProperty("user.name")))
        service = "example.BossService";     

    ctx.getEnvironment().getPropertySources().addFirst(new PropertiesPropertySource("service", service)); 

    <bean id="service" class="${service}" /> 
```

ServiceFactoryBean、外部 ServiceFactory、SPEL 等也可以这样做......

也许，您对在运行时替换实现感兴趣，即更改所有 bean 中的 Service 实现，这取决于容器何时刷新。（没有破坏和刷新）。

据我所知，该框架没有提供明确的方法来做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T00:30:03.173

听起来你应该看看弹簧绑定，例如：

```
public String create(@Valid Market market, BindingResult bindingResult, Model uiModel, HttpServletRequest httpServletRequest) { 
```

因此，这将采用与 Market 对象中的字段匹配的请求参数并将它们设置在该对象中。它还将验证参数/对象，因为有 @Valid 注释。可以使用 PropertyEditors 或 Converters 自定义此绑定。

如果市场对象被注解为@Configurable，那么它可以在spring创建它时使用@Autowired和@Value注解来配置bean。

# msbuild - 具有多个 DefineConstant 值的 msbuild，包括嵌入的分号

> ID：12354859
> 
> 赞同：1
> 
> 时间：2012-09-10T15:30:44.537
> 
> 标签：msbuild

我有一个 msbuild 脚本，它使用 Exec 标记启动另一个 MSBuild 命令，包括具有多个值的 DefineConstants 属性。由于该属性有多个值，因此我使用[此问题](https://stackoverflow.com/questions/506687/passing-multiple-values-to-wix-defineconstants-property-with-msbuild)中描述的技术直接调用 MSBuild.exe（不使用 MSBuild 标记）并将值括在引号中。

但是，我现在需要在其中一个值中嵌入一个特殊符号，我正在尝试使用代码`&#175;`（注册商标®）

问题是特殊字符代码必须以分号结尾，但是当我嵌入分号时，msbuild 将其读取为值分隔符。我似乎找到了一种有效的方法来转义分号并让它仍然显示在 end 参数值中。

**我的问题是：如何将特殊字符嵌入到我的构建参数中？**

为了提高可读性，我在示例中将值移动到变量中，但这不是必需的。

文件：TopLevelBuildScript.proj

```
 <Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <Target Name="BuildWithSpecialChar">
    <ItemGroup>
      <!-- Note: %3B is the escape code for semicolon -->
      <MyProductName Include="Trademarked&amp;#174%3B Product" />
      <OtherProperty Include="foo" />
    </ItemGroup>

   <Exec Command="msbuild.exe subBuildScript.proj /p:DefineConstants=&quot;MyProductName=@(MyProductName);OtherVar=@(foo);AnotherVar=asdf;&quot; " />
    </Target>
  </Project> 
```

执行时，上面会产生命令行：

```
msbuild.exe subBuildScript.proj /p:DefineConstants="MyProductName=Trademarked&#174; Product;OtherVar=foo;AnotherVar=asdf;" 
```

最终定义了在分号处拆分产品名称的常量：

```
MyProductName=Trademarked&#174
Product
OtherVar=foo
AnotherVar=asdf 
```

注意：我也尝试使用 %25 作为百分号：

```
<MyProductName Include="Trademarked&amp;#174%253B Product" /> 
```

但这给了我：

```
MyProductName=Trademarked&#174B Product
OtherVar=foo  
AnotherVar=asdf 
```

**更新**

事实证明，问题不在于 MSBuild，而在于 WiX 解析参数的方式（我的 subBuildScript 使用 WiX）。我没有考虑到这一点，所以在我的原始帖子中没有提到它。

最终，我根据[另一个问题的答案提出](https://stackoverflow.com/a/4280454/682840)了一个解决方案：

```
<PropertyGroup>   
  <WixValues>
    <MyProductName>Trademarked® Product<MyProductName>
    <OtherProperty>foo"</OtherProperty>
  </WixValues>
</PropertyGroup>
<MSBuild
    Projects="subProjectScript.proj"
    Properties="Configuration=Release;WixValues=$([MSBuild]::Escape($(WixValues)))"
    Targets="Clean;Rebuild"
    ContinueOnError="false"
    StopOnFirstFailure="true">
</MSBuild> 
```

并取消转义 subProjectScript.proj 中的值，如另一个答案中所述。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:08:09.247

首先，MSBuild 文件是 XML，您可以将其编码为 UTF-8，因此您应该能够直接在 MSBuild 脚本中复制/粘贴商标字符，**而无需转义**.

如果您不能采用这种方法，**请不要逃避 & 符号**。MSBuild 脚本中有两个级别的转义内容。第一个是 XML 编码，以便可以使用对 XML 敏感的字符（`<`和`&`），并且您仍然可以拥有安全的 XML。当 MSBuild 读入文件时，XML 转义序列不会转义。在该过程之后，MSBuild 然后执行它自己的反转义（即`%3B`分号）。

因为您在`&amp;`XMl 转义序列的开头使用，所以 XML 处理器将其解释为*文字*& 符号，而不是表示转义序列的特殊 XML & 符号。将`MyProductName`项目组的值更改为：

```
<MyProductName Include="Trademarked&#174; Product" /> 
```

由于`MyProductName`似乎是一个标量值，而不是一个列表，我会使用一个属性来代替：

```
<PropertyGroup>
  <MyProductName>Trademarked® Product</MyProductName>
</PropertyGroup> 
```

在您的`Exec`任务中，您可以像这样使用它：

```
<Exec Command="msbuild.exe subBuildScript.proj /p:DefineConstants=&quot;MyProductName=$(MyProductName);OtherVar=@(foo);AnotherVar=asdf;&quot; " /> 
```

# firefox - 小程序部署 javafx 2.2、firefox、ubuntu

> ID：12354864
> 
> 赞同：1
> 
> 时间：2012-09-10T15:31:02.930
> 
> 标签：firefox, ubuntu, applet, javafx, java-7

我尝试使用 JDK 1.7u10 b06 x64 让我的 javafx 小程序在 Firefox、Ubuntu 12.04 x64 下运行

*此页面上的测试有效*（但不使用 javafx）： [http ://technonstop.com/install-java-plugin-ubuntu-linux](http://technonstop.com/install-java-plugin-ubuntu-linux)

*这个没有*： http: [//privatewww.essex.ac.uk/~wsomba/ParticleFx.html](http://privatewww.essex.ac.uk/~wsomba/ParticleFx.html) => 我被要求安装 Java。

我想我正确设置了 Firefox 插件 (amd64) *Firefox about:plugins*：

```
Java Plug-in 1.7.0_10

Fichier : libnpjp2.so
Version : 
Java plug-in for NPAPI-based browsers.

Type MIME     Description     Suffixes
application/x-java-vm     Java™ Plug-in     
application/x-java-applet     Java™ Plug-in Applet     
application/x-java-bean     Java™ Plug-in JavaBeans     
application/x-java-applet;version=1.1     Java™ Plug-in     
application/x-java-bean;version=1.1     Java™ Plug-in     
application/x-java-applet;version=1.1.1     Java™ Plug-in     
application/x-java-bean;version=1.1.1     Java™ Plug-in     
application/x-java-applet;version=1.1.2     Java™ Plug-in     
application/x-java-bean;version=1.1.2     Java™ Plug-in     
application/x-java-applet;version=1.1.3     Java™ Plug-in     
application/x-java-bean;version=1.1.3     Java™ Plug-in     
application/x-java-applet;version=1.2     Java™ Plug-in     
application/x-java-bean;version=1.2     Java™ Plug-in     
application/x-java-applet;version=1.2.1     Java™ Plug-in     
application/x-java-bean;version=1.2.1     Java™ Plug-in     
application/x-java-applet;version=1.2.2     Java™ Plug-in     
application/x-java-bean;version=1.2.2     Java™ Plug-in     
application/x-java-applet;version=1.3     Java™ Plug-in     
application/x-java-bean;version=1.3     Java™ Plug-in     
application/x-java-applet;version=1.3.1     Java™ Plug-in     
application/x-java-bean;version=1.3.1     Java™ Plug-in     
application/x-java-applet;version=1.4     Java™ Plug-in     
application/x-java-bean;version=1.4     Java™ Plug-in     
application/x-java-applet;version=1.4.1     Java™ Plug-in     
application/x-java-bean;version=1.4.1     Java™ Plug-in     
application/x-java-applet;version=1.4.2     Java™ Plug-in     
application/x-java-bean;version=1.4.2     Java™ Plug-in     
application/x-java-applet;version=1.5     Java™ Plug-in     
application/x-java-bean;version=1.5     Java™ Plug-in     
application/x-java-applet;version=1.6     Java™ Plug-in     
application/x-java-bean;version=1.6     Java™ Plug-in     
application/x-java-applet;version=1.7     Java™ Plug-in     
application/x-java-bean;version=1.7     Java™ Plug-in     
application/x-java-applet;jpi-version=1.7.0_10     Java™ Plug-in     
application/x-java-bean;jpi-version=1.7.0_10     Java™ Plug-in     
application/x-java-applet;deploy=10.10.2     Java™ Plug-in     
application/x-java-applet;javafx=2.2.2     Java™ Plug-in 
```

*Javascript平台验证*：

```
function check(){
var platform = new dtjava.Platform(
       {
           jvm : '1.7.0_06+',
           javafx : '2.2+',
       }
    );
    if (dtjava.validate(platform)!=null){
      alert(dtjava.validate(platform));
    }
} 
```

==> 警报：

```
MISMATCH [os=false, browser=false, jre=none, fx=ok, relaunch=false, platform=Platform [jvm=1.7.0_06+, javafx=2.2+, plugin=*, jvmargs=null]] 
```

我阅读了许多建议以使其发挥作用，其中大多数都已过时……知道吗？

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T00:06:57.763

7u10 中的小程序暂时中断，等待集成：http: [//javafx-jira.kenai.com/browse/RT-24875](http://javafx-jira.kenai.com/browse/RT-24875) “无法使用 7u10 构建加载 javafx 小程序”

> 问题是 dtjava.js 将 7u10 视为低于 7u6 的东西（由于字典比较）。

# javascript - image.onload 事件和浏览器缓存

> ID：12354865
> 
> 赞同：135
> 
> 时间：2012-09-10T15:31:04.773
> 
> 标签：javascript, image-loading

我想在加载图像后创建一个警报框，但是如果图像保存在浏览器缓存中，`.onload`则不会触发该事件。

无论图像是否已缓存，如何在加载图像时触发警报？

```
var img = new Image();
img.src = "img.jpg";
img.onload = function () {
   alert("image is loaded");
} 
```

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2012-09-10T15:41:59.900

当您动态生成图像时，请`onload`在`src`.

```
var img = new Image();
img.onload = function () {
   alert("image is loaded");
}
img.src = "img.jpg"; 
```

[**Fiddle**](http://jsfiddle.net/ult_combo/GKFxP/3/) - 在最新的 Firefox 和 Chrome 版本上测试。

您还可以使用这篇[文章](https://stackoverflow.com/questions/3877027/jquery-callback-on-image-load-even-when-the-image-is-cached)中的答案，我针对单个动态生成的图像进行了调整：

```
var img = new Image();
// 'load' event
$(img).on('load', function() {
  alert("image is loaded");
});
img.src = "img.jpg"; 
```

[**小提琴**](http://jsfiddle.net/ult_combo/GKFxP/5/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-07-24T19:52:26.923

如果 src 已设置，则事件在缓存案例中触发，甚至在您绑定事件处理程序之前。因此，您也应该触发基于 off 的事件`.complete`。

代码示例：

```
$("img").one("load", function() {
   //do stuff
}).each(function() {
   if(this.complete || /*for IE 10-*/ $(this).height() > 0)
     $(this).load();
}); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-10T15:36:59.390

对于这种情况，有两种可能的解决方案：

1.  使用[这篇文章中建议的解决方案](https://stackoverflow.com/questions/3877027/jquery-callback-on-image-load-even-when-the-image-is-cached)
2.  为图像添加唯一后缀以`src`强制浏览器再次下载它，如下所示：

    ```
    var img = new Image();
    img.src = "img.jpg?_="+(new Date().getTime());
    img.onload = function () {
        alert("image is loaded");
    } 
    ```

在此代码中，每次将当前时间戳添加到图像 URL 的末尾时，您都会使其唯一，浏览器将再次下载图像

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-03T06:05:04.773

我今天遇到了同样的问题。在尝试了各种方法后，我意识到只需将调整大小的代码放在里面`$(window).load(function() {})`而不是`document.ready`解决部分问题（如果你没有对页面进行 ajax 处理）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-02-01T08:15:31.407

我发现您可以在 Chrome 中执行此操作：

```
 $('.onload-fadein').each(function (k, v) {
    v.onload = function () {
        $(this).animate({opacity: 1}, 2000);
    };
    v.src = v.src;
}); 
```

将 .src 设置为自身将触发 onload 事件。

# caching - 在后台更新 WordPress 提要缓存

> ID：12354873
> 
> 赞同：0
> 
> 时间：2012-09-10T15:31:24.147
> 
> 标签：caching, background-process, wordpress, simplepie

我正在寻找一种在后台刷新提要缓存的方法。

为了演示我面临的问题，下面的代码会有所帮助。当页面被访问和加载时，它每 30 秒更新一次缓存。因为它有很多 url 需要一次获取，所以当缓存需要重建时它会变得非常慢。

```
$urls = array(
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=w&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=n&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=b&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=el&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=tc&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=ir&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=s&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=snc&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=m&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=e&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&q=topic:bagram&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&q=topic:syria&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&q=topic:baghdad&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&q=topic:bernard_arnault&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&q=topic:senkaku_islands&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&q=topic:alps&output=rss'
    );

    $feed = fetch_feed_modified($urls);
    foreach ($feed->get_items() as $item):
    ?>

        <div class="item">
            <h2><a href="<?php echo $item->get_permalink(); ?>"><?php echo $item->get_title(); ?></a></h2>
            <p><?php echo $item->get_description(); ?></p>
            <p><small>Posted on <?php echo $item->get_date('j F Y | g:i a'); ?></small></p>
        </div>

    <?php endforeach; 

function fetch_feed_modified($url) {
    require_once (ABSPATH . WPINC . '/class-feed.php');

    $feed = new SimplePie();
    $feed->set_feed_url($url);
    $feed->set_cache_class('WP_Feed_Cache');
    $feed->set_file_class('WP_SimplePie_File');
    $feed->set_cache_duration(apply_filters('wp_feed_cache_transient_lifetime', 30, $url)); // set the cacne timeout to 30 seconds
    do_action_ref_array( 'wp_feed_options', array( &$feed, $url ) );
    $feed->init();
    $feed->handle_content_type();

    if ( $feed->error() )
        return new WP_Error('simplepie-error', $feed->error());

    return $feed;
} 
```

所以我想知道如何修改它，以便它在超时时在后台静默更新缓存。我的意思是尽管超时超过了，但它会正常显示页面并保存缓存；另一方面，它在访问后开始在后台建立一个新的缓存。这样，访问者永远不会看到页面变慢。

是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T16:22:45.893

好的，这行得通。

```
<?php
/* Plugin Name: Sample Feed Cache Renew Crawler */

    $urls = array(
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=w&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=n&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=b&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=el&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=tc&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=ir&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=s&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=snc&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=m&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=e&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&q=topic:bagram&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&q=topic:syria&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&q=topic:baghdad&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&q=topic:bernard_arnault&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&q=topic:senkaku_islands&output=rss',
        'http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&q=topic:alps&output=rss'
    );
    $cache_renew_interval = 30; // every thirty seconds

    // admin page
    add_action('admin_menu', 'sample_feed_cache_renew_crawler_menu');
    function sample_feed_cache_renew_crawler_menu() {
        add_options_page(
            'Sample Feed Cache Renew Crawler', 
            'Sample Feed Cache Renew Crawler', 
            'manage_options',
            'sample_feed_cache_renew_crawler', 
            'sample_feed_cache_renew_crawler_admin');
    }
    function sample_feed_cache_renew_crawler_admin() {
        global $urls, $cache_renew_interval;
        ?>
        <div class="wrap">
        <?php       

            $feed = fetch_feed_with_custom_lifetime($urls, 60*60*24 );  // lifetime for 24 hours

            if ( $feed->error() )
                return new WP_Error('simplepie-error', $feed->error());         

            $feed = fetch_feed($urls);

            $i = 0;
            foreach ($feed->get_items() as $item):  
                if (++$i==20) break;
            ?>

                <div class="item">
                    <h2><a href="<?php echo $item->get_permalink(); ?>"><?php echo $item->get_title(); ?></a></h2>
                    <p><?php echo $item->get_description(); ?></p>
                    <p><small>Posted on <?php echo $item->get_date('j F Y | g:i a'); ?></small></p>
                </div>

            <?php endforeach;    
        ?>
        </div>      
        <?php
        wp_clear_scheduled_hook( 'sample_feed_cache_renew_crawler_event' );
        add_action('sample_feed_cache_renew_crawler_event','sample_feed_cache_renew_crawler_function');
        wp_schedule_single_event(time() + $cache_renew_interval, 'sample_feed_cache_renew_crawler_event');

}
// wp_clear_scheduled_hook( 'sample_feed_cache_renew_crawler_event' );
require_once (ABSPATH . WPINC . '/class-feed.php');
function fetch_feed_with_custom_lifetime($url, $lifetime) {
    $feed = new SimplePie();
    $feed->set_feed_url($url);
    $feed->set_cache_class('WP_Feed_Cache');
    $feed->set_file_class('WP_SimplePie_File');
    $feed->set_cache_duration(apply_filters('wp_feed_cache_transient_lifetime', $lifetime, $url)); // set the cacne timeout to 30 seconds
    do_action_ref_array( 'wp_feed_options', array( &$feed, $url ) );
    $feed->init();
    $feed->handle_content_type();
    if ( $feed->error() ) return new WP_Error('simplepie-error', $feed->error());
    return $feed;
}   

add_action('sample_feed_cache_renew_crawler_event','sample_feed_cache_renew_crawler_function');
function sample_feed_cache_renew_crawler_function() {
    $file = __DIR__ . '/log.txt';
    $current = date('l jS \of F Y h:i:s A') . ": cache cleared" . PHP_EOL;
    file_put_contents($file, $current, FILE_APPEND);

    global $urls, $cache_renew_interval;
    fetch_feed_with_custom_lifetime($urls, 0);  // renew the cache right away
    wp_schedule_single_event(time() + $cache_renew_interval, 'sample_feed_cache_renew_crawler_event');

} 
```

我不清楚的一件事是，即使我将时间间隔设置为 30 秒，它并不总是`sample_feed_cache_renew_crawler_function()`在正确的时间调用该函数。日志文件显示有时需要 2 分钟，有时需要 4 分钟，尽管我一直按浏览器的重新加载按钮超过这些分钟。

根据 Codex，[http://codex.wordpress.org/Function_Reference/wp_schedule_single_event](http://codex.wordpress.org/Function_Reference/wp_schedule_single_event)，

> 请注意，在同名事件发生后 10 分钟内安排事件将被忽略，除非您将 $args 的唯一值传递给每个已安排的事件。

但是日志文件告诉函数在 2 分钟左右的时间间隔内被调用。所以这没有意义。

# oracle - 使用 Rtools 2.15 在 R 2.15.1 上安装 ROracle 失败

> ID：12354874
> 
> 赞同：0
> 
> 时间：2012-09-10T15:31:25.293
> 
> 标签：oracle, r

我正在尝试使用 R 2.15.1 和 Rtools 2.15 在 Windows 下编译 ROracle 包版本 1.1-4

```
install.packages('ROracle',type='source') 
```

但似乎`ocimingw.c`缺少（见下面的输出）。我使用`R CMD INSTALL --build`.

**编辑 2012-09-11**：问题显然是 1.1-4 特有的，因为我设法正常构建和安装 1.1-1。

知道解决方案可能是什么吗？

```
trying URL 'http://stat.ethz.ch/CRAN/src/contrib/ROracle_1.1-4.tar.gz'
Content type 'application/x-gzip' length 156924 bytes (153 Kb)
opened URL
downloaded 153 Kb

* installing *source* package 'ROracle' ...
** package 'ROracle' successfully unpacked and MD5 sums checked
looking for Instant Client c:/instantclient/x64/instantclient_11_2
cygwin warning:
  MS-DOS style path detected: C:\instantclient\x64\instantclient_11_2
  Preferred POSIX equivalent is: /cygdrive/c/instantclient/x64/instantclient_11_2
  CYGWIN environment variable option "nodosfilewarning" turns off this warning.
  Consult the user's guide for more details about POSIX paths:
    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
found Instant Client C:\instantclient\x64\instantclient_11_2
found Instant Client SDK c:/instantclient/x64/instantclient_11_2/sdk/include
generating ocimingw.lib from ocimingw.def
x86_64-w64-mingw32-dlltool: not found
copying from c:/instantclient/x64/instantclient_11_2/sdk/include
** libs
Warning: this package has a non-empty 'configure.win' file,
so building only the main architecture

cygwin warning:
  MS-DOS style path detected: C:/R/R-215~1.1/etc/x64/Makeconf
  Preferred POSIX equivalent is: /cygdrive/c/R/R-215~1.1/etc/x64/Makeconf
  CYGWIN environment variable option "nodosfilewarning" turns off this warning.
  Consult the user's guide for more details about POSIX paths:
    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
gcc -m64 -I"C:/R/R-215~1.1/include" -DNDEBUG -I./oci    -I"d:/RCompile/CRANpkg/extralibs64/local/include"     -O2 -Wall  -std=gnu99 -mtune=core2 -c rodbi.c -o rodbi.o
rodbi.c: In function 'rociResExec':
rodbi.c:1169:14: warning: unused variable 'drv' [-Wunused-variable]
rodbi.c: In function 'rociResFetch':
rodbi.c:1187:16: warning: unused variable 'drv' [-Wunused-variable]
rodbi.c: In function 'rociResInfo':
rodbi.c:1256:16: warning: unused variable 'drv' [-Wunused-variable]
rodbi.c: In function 'rociResTerm':
rodbi.c:1323:14: warning: unused variable 'drv' [-Wunused-variable]
rodbi.c: In function 'rodbiCheck':
rodbi.c:2348:25: warning: pointer targets in passing argument 1 of 'snprintf' differ in signedness [-Wpointer-sign]
c:\rtools\gcc-4.6.3\bin\../lib/gcc/i686-w64-mingw32/4.6.3/../../../../i686-w64-mingw32/include/stdio.h:505:15: note: expected 'char * restrict' but argument is of type 'text *'
rodbi.c: In function 'rawToStrhexCall':
rodbi.c:2573:7: warning: pointer targets in passing argument 1 of 'Rf_mkChar' differ in signedness [-Wpointer-sign]
C:/R/R-215~1.1/include/Rinternals.h:628:6: note: expected 'const char *' but argument is of type 'unsigned char *'
rodbi.c:2557:26: warning: unused variable 'seglen' [-Wunused-variable]
rodbi.c: In function 'rociResInit':
rodbi.c:1121:3: warning: 'qry_encoding' may be used uninitialized in this function [-Wuninitialized]
gcc -m64 -I"C:/R/R-215~1.1/include" -DNDEBUG -I./oci    -I"d:/RCompile/CRANpkg/extralibs64/local/include"     -O2 -Wall  -std=gnu99 -mtune=core2 -c rooci.c -o rooci.o
In file included from C:/R/R-215~1.1/include/R.h:44:0,
                 from rodbi.h:37,
                 from rooci.c:47:
C:/R/R-215~1.1/include/R_ext/RS.h:43:0: warning: "ERROR" redefined [enabled by default]
c:\rtools\gcc-4.6.3\bin\../lib/gcc/i686-w64-mingw32/4.6.3/../../../../i686-w64-mingw32/include/wingdi.h:70:0: note: this is the location of the previous definition
rooci.c: In function 'roociInitializeRes':
rooci.c:620:32: warning: 'cnvcid' may be used uninitialized in this function [-Wuninitialized]
gcc -m64 -shared -s -static-libgcc -o ROracle.dll tmp.def rodbi.o rooci.o -L. ocimingw.lib -Ld:/RCompile/CRANpkg/extralibs64/local/lib/x64 -Ld:/RCompile/CRANpkg/extralibs64/local/lib -LC:/R/R-215~1.1/bin/x64 -lR
gcc.exe: error: ocimingw.lib: No such file or directory
ERROR: compilation failed for package 'ROracle'
* removing 'C:/R/R-2.15.1/library/ROracle' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T16:28:23.713

这个问题显然是 1.1-4 特有的，因为我设法正常构建和安装 1.1-1。我会等待 1.1-5 版本再试一次。感谢所有贡献者！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T16:26:55.937

[在 Windows 中从源代码安装ROracle](http://cran.r-project.org/web/packages/ROracle/index.html)非常容易，如果您想从源代码中使用 ROracle，请尝试使用 Linux，这是[我的安装日志](http://blog.cloud-mes.com/2012/09/16/install-r-and-rstudio-in-ubuntu/)。

[如果仍然喜欢 windows，您可以从Oracle](http://www.oracle.com/technetwork/database/options/advanced-analytics/r-enterprise/ore-downloads-1502823.html)获取已编译的 ROracle 包，它包含在“客户端支持包”中。

# c# - 使用 LINQ 合并 2 个 Xml 文件

> ID：12354878
> 
> 赞同：1
> 
> 时间：2012-09-10T15:31:52.953
> 
> 标签：c#, xml, linq, merge

我需要将 2 个 xml 文件“合并”在一起，但要考虑两者中出现的元素并合并每个不同的属性。这是我的意思的一个例子：

输入：Xml1

```
<?xml version="1.0"?>
<Style Width="1024" Height="768">
    <BaseStyle Width="1024" Height="768" BackgroundPath="./Images/BackgroundAAA.png"/>
    <Styles>
        <LabelStyle ID="Label1" Font="Tahoma" Bold="false" /> <!-- exists in both -->
        <LabelStyle ID="Label2" Font="Tahoma" Bold="false" /> <!-- exists in both -->
        <LabelStyle ID="Label3" Font="Tahoma" Bold="false" /> <!-- unique -->
  </Styles>
</Style> 
```

输入：Xml2

```
<?xml version="1.0"?>
<Style Width="1024" Height="768">
    <BaseStyle Width="1024" Height="768" BackgroundPath="./Images/BackgroundBBB.png"/>
    <Styles>
        <LabelStyle ID="Label1" Font="Arial" Bold="true" /> <!-- exists in both -->
        <LabelStyle ID="Label2" Font="Arial" /> <!-- exists in both -->
        <LabelStyle ID="Label4" Font="Arial" Bold="false" /> <!-- unique -->
    </Styles>
</Style> 
```

我需要得到以下输出： -

结果：Xml3

```
<?xml version="1.0"?>
<Style Width="1024" Height="768">
    <BaseStyle Width="1024" Height="768" BackgroundPath="./Images/BackgroundBBB.png"/> <!-- has overwritten Xml1 -->
    <Styles>
        <LabelStyle ID="Label1" Font="Arial" Bold="true" /> <!-- has merged Xml1 & Xml2 with Xml2 taking precedence -->
        <LabelStyle ID="Label2" Font="Arial" Bold="false" /> <!-- has merged Xml1 & Xml2 with Xml2 taking precedence (note Bold attribute is present) -->
        <LabelStyle ID="Label3" Font="Tahoma" Bold="false" /> <!-- unique -->
        <LabelStyle ID="Label4" Font="Arial" Bold="false" /> <!-- unique -->
    </Styles>
</Style> 
```

您会从上面注意到，任何唯一的东西都会被合并，而任何常见的东西（使用 ID 作为键）都会使用 Xml2 值进行更新。

我一直在阅读有关如何使用 LINQ 合并 2 个 xml 文件的许多重要问题，但没有一个真正满足我的要求。他们似乎都在谈论拿 A 和 B 并以 A + B 结束。

有没有一种简单的方法可以使用 LINQ 做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T16:07:28.613

例如：

```
class Program {
    static void Main(string[] args) {
        StringReader sr = new StringReader("<?xml version=\"1.0\"?><Style Width=\"1024\" Height=\"768\"><BaseStyle Width=\"1024\" Height=\"768\" BackgroundPath=\"./Images/BackgroundBBB.png\"/><Styles><LabelStyle ID=\"Label1\" Font=\"Arial\" Bold=\"true\" /> <!-- exists in both --><LabelStyle ID=\"Label2\" Font=\"Arial\" /> <!-- exists in both --><LabelStyle ID=\"Label3\" Font=\"Arial\" Bold=\"false\" /> <!-- unique --></Styles></Style>"); 
        XDocument xdoc1 = XDocument.Load(sr);
        sr.Close();
        sr = new StringReader("<?xml version=\"1.0\"?><Style Width=\"1024\" Height=\"768\"><BaseStyle Width=\"1024\" Height=\"768\" BackgroundPath=\"./Images/BackgroundBBB.png\"/><Styles><LabelStyle ID=\"Label1\" Font=\"Arial\" Bold=\"true\" /> <!-- exists in both --><LabelStyle ID=\"Label2\" Font=\"Arial\" /> <!-- exists in both --><LabelStyle ID=\"Label4\" Font=\"Arial\" Bold=\"false\" /> <!-- unique --></Styles></Style>");
        XDocument xdoc2 = XDocument.Load(sr);
        sr.Close();

        sr = new StringReader("<?xml version=\"1.0\"?><Style Width=\"1024\" Height=\"768\"><BaseStyle Width=\"1024\" Height=\"768\" BackgroundPath=\"./Images/BackgroundBBB.png\"/><Styles></Styles></Style>");
        XDocument xDocDest = XDocument.Load(sr);
        sr.Close();
        XElement xeDest = xDocDest.Root.Descendants("Styles").Single();

        XElement[] x2s = (from x in xdoc2.Root.Descendants("LabelStyle") orderby x.Attribute("ID").Value select x).ToArray() ;

        Int32 iCurrentX2 = 0;
         XElement xeCurrentX2 = (x2s.Count() > 1) ? x2s[0] : null;
        foreach (XElement x1 in from x in xdoc1.Root.Descendants("LabelStyle") orderby x.Attribute("ID").Value select x) {
            if (xeCurrentX2 == null || String.Compare(x1.Attribute("ID").Value, xeCurrentX2.Attribute("ID").Value) < 0) {
                xeDest.Add(x1);
            } else {
                while (iCurrentX2 < x2s.Count() && String.Compare(x1.Attribute("ID").Value, xeCurrentX2.Attribute("ID").Value) >= 0) {
                    xeDest.Add(xeCurrentX2);
                    xeCurrentX2 = (++iCurrentX2 < x2s.Count()) ? x2s[iCurrentX2] : null;
                }
            }
        }
        while (iCurrentX2 < x2s.Count()) {
            xeDest.Add(x2s[iCurrentX2++]);
        }

        Console.WriteLine(xDocDest.ToString());
    }
} 
```

这还没有完全确定，但我认为结构就在这里

# c++ - 将字符串流中的数字转换为具有设定精度的字符串

> ID：12354881
> 
> 赞同：4
> 
> 时间：2012-09-10T15:31:55.213
> 
> 标签：c++, precision, significant-digits

我想从 stringstream 获取一个数字并将其设置为 5 个有效数字。我该怎么做呢？到目前为止，这是我设法提出的：

```
double a = 34.34566535
std::stringstream precisionValue;
precisionValue.precision(6) << a << std::endl; 
```

但是，这不是编译。谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-10T15:35:07.553

它不会编译，因为`ios_base::precision()`返回`streamsize`（它是一个整数类型）。

您可以使用[流操纵器](http://en.cppreference.com/w/cpp/io/manip)：

```
precisionValue << std::setprecision(6) << a << std::endl; 
```

您需要包括`<iomanip>`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-10T15:34:40.687

`std::stringstream::precision()`返回 a `streamsize`，而不是对流本身的引用，如果要对`<<`运算符进行排序，则需要这样做。这应该有效：

```
double a = 34.34566535;
std::stringstream precisionValue;
precisionValue.precision(6);
precisionValue << a << std::endl; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-10T15:36:42.227

成员函数返回当前精度，而不是对字符串流的[`precision`](http://en.cppreference.com/w/cpp/io/ios_base/precision)引用，因此您不能像在代码段中所做的那样链接调用。

```
precisionValue.precision(6);      
precisionValue << a;
std::cout << precisionValue.str() << std::endl; 
```

或者使用[`setprecision`](http://en.cppreference.com/w/cpp/io/manip/setprecision)IO 操纵器链接调用：

```
precisionValue << setprecision(6) << a;
std::cout << precisionValue.str() << std::endl; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-10T15:36:35.177

您可以使用`std::setprecision`来自标题`<iomanip>`

```
#include <string>
#include <sstream>
#include <iomanip>
#include <iostream>

int main()
{
  double a = 34.34566535;
  std::stringstream precisionValue;
  precisionValue << std::setprecision(6);
  precisionValue << a << std::endl;
  std::cout << precisionValue.str();
} 
```

# c# - 如何优雅地停止 System.Threading.Timer？

> ID：12354883
> 
> 赞同：17
> 
> 时间：2012-09-10T15:32:03.083
> 
> 标签：c#, .net, multithreading

我有一个用 C# 实现的 Windows 服务，它需要经常做一些工作。我已经使用`System.Threading.Timer`一个回调方法实现了这一点，该方法负责安排下一个回调。我无法优雅地停止（即处置）计时器。这是一些可以在控制台应用程序中运行的简化代码，可以说明我的问题：

```
const int tickInterval = 1000; // one second

timer = new Timer( state => {
                       // simulate some work that takes ten seconds
                       Thread.Sleep( tickInterval * 10 );

                       // when the work is done, schedule the next callback in one second
                       timer.Change( tickInterval, Timeout.Infinite );
                   },
                   null,
                   tickInterval, // first callback in one second
                   Timeout.Infinite );

// simulate the Windows Service happily running for a while before the user tells it to stop
Thread.Sleep( tickInterval * 3 );

// try to gracefully dispose the timer while a callback is in progress
var waitHandle = new ManualResetEvent( false );
timer.Dispose( waitHandle );
waitHandle.WaitOne(); 
```

问题是我在阻塞时`ObjectDisposedException`从`timer.Change`回调线程上得到一个。`waitHandle.WaitOne`我究竟做错了什么？

`Dispose`我正在使用的重载[文档说：](http://msdn.microsoft.com/en-us/library/b97tkt95.aspx)

> 在所有当前排队的回调完成之前，不会释放计时器。

**编辑：看来文档中的此声明可能不正确。有人可以验证吗？**

我知道我可以通过在回调和处置代码之间添加一些信号来解决这个问题，正如 Henk Holterman 下面建议的那样，但除非绝对必要，否则我不想这样做。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-10T15:45:38.090

使用此代码

```
 timer = new Timer( state => {
                   // simulate some work that takes ten seconds
                   Thread.Sleep( tickInterval * 10 );

                   // when the work is done, schedule the next callback in one second
                   timer.Change( tickInterval, Timeout.Infinite );
               },
               null,
               tickInterval, // first callback in one second
               Timeout.Infinite ); 
```

几乎可以肯定，您会在定时器处于休眠状态时对其进行处置。

您必须在 Sleep() 之后保护代码以检测 Disposed 计时器。由于没有 IsDisposed 属性，因此快速而肮脏的方法`static bool stopping = false;`可能会奏效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-04T11:29:33.470

保护回调方法不使用已处理的计时器的可能解决方案：

```
ManualResetEvent waitHandle = new ManualResetEvent(false);
if (!timer.Dispose(waitHandle) || waitHandle.WaitOne((int)timeout.TotalMilliseconds)
{
    waitHandle.Close();  // Only close when not timeout
} 
```

另请参阅：[https ://stackoverflow.com/a/15902261/193178](https://stackoverflow.com/a/15902261/193178)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-10T16:43:01.340

如“Windows 上的并发编程”中所述：
创建一个虚拟类 InvalidWaitHandle，继承自 WaitHandle：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.ComponentModel;
using System.Data;
using System.Diagnostics;
using System.Threading;

namespace MyNameSpace
{
    class InvalidWaitHandle : WaitHandle
    {

    }
} 
```

因此，您可以像这样正确处理 System.Threading.Timer：

```
public static void DisposeTimer()
{
   MyTimer.Dispose(new InvalidWaitHandle());
   MyTimer = null;
} 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-09-10T15:44:21.103

您无需处理计时器即可停止它。您可以调用`Timer.Stop()`或设置`Timer.Enabled`为`false`，其中任何一个都会停止计时器运行。

# orchardcms - 果园：主从页面

> ID：12354886
> 
> 赞同：0
> 
> 时间：2012-09-10T15:32:16.090
> 
> 标签：orchardcms

这太尴尬了……我在经典的 ASP 和 ASP.NET 中已经做了几十次了……

我有 1:n 主从表（例如部门、工作），其中

```
 Department: ID
  Marketing : 1
  Sales     : 2
  HR        : 3 
```

和

```
 Job     : DepartmentID
  Job 1   : 1
  Job 2   : 2
  Job x   : 1 
```

所以每个部门列出了 0 到 n 个工作。

现在我只想要一个列出部门的页面。（这是到另一个页面的链接）这个另一个页面显然显示了所选部门的所有工作。

```
 "MASTER PAGE":          .--> "DETAILS PAGE after click on Marketing"
                          |
  Departments:            |    Jobs in Marketing
  Marketing --------------'    Job 1
  Sales --->                   Job x
  HR ---> 
```

很容易......但我不知道如何在果园里创造这个。

我已经设置了分类法，我尝试过查询...

像分类学

```
 Department
        Marketing
        Sales
        HR 
```

我设置了一个 ContentType “Job”，添加了 Tax-Field “Department” - 这很好。

我可以将 {Content.Fields.Job.Department}/ 添加到 Autoroute - 但它不会显示在保存的作业中。（slug 总是 .../Title-of-Job）不是（.../Marketing/Title-of-Job）

此外，我只在.../Department 之类的 URL 上列出我的所有工作 - 而我想列出我的部门，而不是其中的工作（所以这应该是链接到 . ../Department/(eg)Marketing 这一项列出了工作。

有人可以给我一个详细的指南 - 或链接 - 关于如何在 ORCHARD 中为数据驱动的网站完成这项基本而琐碎的任务！

# java - 手动触发 Spring 参数映射？

> ID：12354887
> 
> 赞同：0
> 
> 时间：2012-09-10T15:32:21.180
> 
> 标签：java, spring

我的参数有一个工作良好的 Spring 参数映射，不幸的是，我有一个组件没有通过 DispatcherServlet 传递，我很难找到一种方法让映射以某种方式手动运行。

一个示例如下所示：

```
public class Bar {
    public Bar(@RequestParam("map") String map) {
        System.out.println("Found: " + map); // Expected result "Found: value
    }
}
public class Foo {
   public static void main(String[] args) {
          context = new ClassPathXmlApplicationContext("META-INF/context.xml");
          String pseudoUrl = "/?map=value"
          Bar bar = context.getBeans('bar', pseudoUrl);
   }
} 
```

它可以以某种方式起作用吗？正如您可以想象的那样，传递的数据具有更复杂的结构，因此我想避免自己编写解析器。

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:55:04.540

[`DispatcherServlet.doDispatch()`您基本上可以遵循相同](https://github.com/SpringSource/spring-framework/blob/v3.1.2.RELEASE/org.springframework.web.servlet/src/main/java/org/springframework/web/servlet/DispatcherServlet.java#L873)的算法：

1.  对于上下文中的每个`HandlerMapping`，（spring-webmvc.jar 3.1.2-RELEASE 中 DispatcherServlet 的第 1058 行），测试是否`HandlerMapping.getHandler(request)`返回非 null
2.  对于上下文中的每个 HandlerAdapter，（第 1091 行）测试是否`HandlerAdapter.supports(handlerMapping)`返回 true
3.  执行`HandlerAdapter.handle(request, ...)`并处理输出（第 923 行）

这将要求您将您的 pseudoUrl 捆绑到一个伪 HttpServletRequest 等中。

另一方面，如果您知道总是想从`main()`方法中的上下文中获取特定的 bean，我只会向 Spring 请求该 bean 并显式调用该方法，而不是处理将 bean 映射到 URL（我假设不变）。

# c - 分配给类型'struct compartido'时不兼容的类型

> ID：12354890
> 
> 赞同：2
> 
> 时间：2012-09-10T15:32:25.877
> 
> 标签：c, pointers, multiprocessing

我对这段代码有一个问题。我应该创建一个结构并在父亲创建的 5 个新进程中共享它：

```
#include <stdio.h>
#include <stdlib.h>
#include <sys/wait.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/shm.h>
#include <sys/sem.h>
#include <time.h>

struct compartido {
    int pid1, pid2, pid3, pid4, pid5;   
    int propietario;            
    int contador;                   
    int pidpadre;
};

struct compartido var;  

int main(int argc, char *argv[]) {

    key_t llave1,llavesem;
    int idmem,idsem;    
    llave1=ftok("/tmp",'a');

    idmem=shmget(llave1,sizeof(int),IPC_CREAT|0600);
    if (idmem==-1) {
       perror ("shmget");
       return 1;
    }

var=shmat(idmem,0,0); /*This line is giving the error*/

/*rest of the code*/
} 
```

给出的确切错误是：错误：从类型'void *'分配给类型'struct compartido'时不兼容的类型

我需要将此结构放在共享变量中，以便能够查看和修改来自 6 个进程（5 个孩子和父亲）的所有这些数据。

我在做什么坏事？在此先感谢并致以最诚挚的问候，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:35:57.767

您可能应该声明一个指针

```
 struct compartido* var; 
```

然后初始化它

```
 var= (struct compartido*) shmat(idmem,0,0); 
```

您应该处理错误情况

```
 if ((void*)var == (void*)-1) {
    perror("shmat failed");
    exit(1);
 } 
```

因为[shmat(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/shmat.2.html)是（在 Linux 上）一个可能失败的[系统调用。](http://en.wikipedia.org/wiki/Syscall)

最后，使用指针字段表示法来访问字段，例如`var->propietario`或`var->pidpatre`等...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:37:45.017

您正在尝试为结构 var 分配 shmat() 的返回值，它是一个 void *

我怀疑你错过了间接？

[参见更详细的 Basile 的“snap”帖子]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T15:39:09.140

您正在分配一个指向结构变量的指针。我会做以下事情：

```
idmem=shmget(llave1,sizeof(struct compartido),IPC_CREAT|0600);
if (idmem==-1) {
   perror ("shmget");
   return 1;
}
struct compartido *var=shmat(idmem,0,0); 
```

请注意，您在示例中分配的空间小于 struct compartido 大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T15:42:08.093

是的，你做的很糟糕：

这一行是在声明一个结构——

```
struct compartido var; 
```

然后你分配一个指向它的指针：

```
var=shmat(idmem,0,0); //returns a void* 
```

查看[shmat 的](http://linux.die.net/man/2/shmat)工作原理

# c# - 当属性名称是每个节点上的属性时，将 XML 反序列化为类

> ID：12354897
> 
> 赞同：0
> 
> 时间：2012-09-10T15:32:47.250
> 
> 标签：c#, xml, xml-serialization, datacontractserializer, asp.net-web-api

我正在尝试与第 3 方 REST API 集成。此 API 始终将其所有资源作为 Asset 类型返回，并将其属性作为 Attribute 类型返回。它使用属性节点上的属性来提供属性名称。xml 内容如下：

```
<Assets>
    <Asset>
        <Attribute name="AssetType">Story</Attribute>
        <Attribute name="OwnerName">Fred Blogs</Attribute>
        <Attribute name="Name">The Lord of the Rings</Attribute>
        ...
    </Asset>
    ...
</Assets> 
```

我想使用 DataContractSerializer （或 XmlSerializer 可能？）将其转换为 Story 类型的 pocos 列表。

```
[DataContract(Name="Asset")]
    public class Story
    {
        public string OwnerName { get; set; }
        public string Name { get; set; }
    } 
```

据我所知，DataMember 属性适用于节点的名称，而不是节点属性的值。有没有办法解决这个问题？

我想最终得到一个这样的WebAPI客户端阅读..

```
 var client = new HttpClient();
    var result = client.GetAsync(uri).Result;
    var stories = r.Content.ReadAsAsync<List<Story>>().Result; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:42:32.847

用 Linq2Xml 解析它怎么样？

```
XDocument xDoc = XDocument.Parse(xml);
var assets = xDoc.Descendants("Asset")
                    .Select(a=>a.Descendants("Attribute")
                                .ToDictionary(x => x.Attribute("name").Value, 
                                              x => x.Value))
                    .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:43:01.973

您将不得不编写一个自定义序列化程序来实现这一点。在此处查看更多信息：

[http://msdn.microsoft.com/en-us/library/ty01x675(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ty01x675(v=vs.80).aspx)

# backbone.js - Backbone.js MVC 方法在从服务器接收到数据后呈现视图？

> ID：12354900
> 
> 赞同：0
> 
> 时间：2012-09-10T15:32:55.923
> 
> 标签：backbone.js

我希望`Collection`在更新之前读取整个数据库表来填充 Backbone.js `View`。

我正在使用`fetch`并收听该`reset`事件。

我的问题是在向服务器发出 http 请求之前会触发重置事件。

我的问题是：如何在从服务器接收回数据后呈现视图？

这是一个显示问题的 jsfiddle（在重置时放置了一个调试器）：

[http://jsfiddle.net/GhaPF/16/](http://jsfiddle.net/GhaPF/16/)

编码：

```
$(document).ready(function() {

    var Item = Backbone.Model.extend({
        urlRoot : './items'
    });

    var ItemList = Backbone.Collection.extend({
        model: Item,
        url: './items/',
    });

    var ItemListView = Backbone.View.extend({
        el: 'body',
        initialize: function(myitemList) {
            this.itemlist = myitemList;
            this.itemlist.bind('reset', this.debuggThis());
        },
        debuggThis: function() {
            debugger;
        },
        render: function() {

        },
        events: {
            "keypress #new-item":  "createOnEnter"
        },
        createOnEnter: function(e) {
        }
    });

    $("#new-item").focus();
    var itemlist = new ItemList();
    var myitemListView = new ItemListView(itemlist);
    itemlist.fetch();
});​ 
```

以下代码有效，但感觉不像是正确的主干.js (MVC) 代码，因为它会被放置在视图定义之外：

```
itemlist.fetch().complete(function(){ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T16:40:18.767

也许问题是这一行：

```
this.itemlist.bind('reset', this.debuggThis()); 
```

实际上应该是：

```
this.itemlist.bind('reset', this.debuggThis); 
```

您的 debugThis 函数在您为“重置”事件设置侦听器时运行 - 而不是在触发事件时。这告诉 JavaScript 你希望 debugThis 返回一个回调函数，而不是让 debugThis “成为”回调函数。

此外，orangewarp 关于将“this”作为第三个参数传递的评论也可能是相关的。所以它最终会变成：

```
this.itemlist.bind('reset', this.debuggThis, this); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T16:04:51.650

那很奇怪。当您`fetch()`的集合被填充后，应该触发重置事件。所以我认为在 http 请求启动之前发生的重置现象可能不是你想象的那样。

而不是使用完整的...你总是可以像这样使用成功回调选项：

```
itemlist.fetch({
    success: function() {
        // Whatever code you want to run.
        itemlist.debuggThis();
    }
}); 
```

此外，在绑定你的时候，`reset`你可能想要这个：

```
this.itemlist.bind('reset', this.debuggThis, this); 
```

# php - 在 Expression Web 3 中预览 php 页面突然停止工作

> ID：12354906
> 
> 赞同：0
> 
> 时间：2012-09-10T15:33:35.620
> 
> 标签：php, iis, expression-web

在 Windows 7 开发机器上，我安装了表达式 web 3、PHP 5

我一直在使用表达式 web 和 PHP，并在按 F12 时预览 php 页面等（使用本地服务器预览）。突然在 F12 上所有 PHP 页面显示为空白，甚至是一个`phpinfo()`文件。标准 html 页面在 F12 上继续正常工作。

如果我将相同的页面 php 放在默认网站上`inetpub`并使用 localhost 浏览，则该`phpinfo()`文件有效。所以我知道 php 已为 IIS 正确安装和配置。

我检查过的事情：

*   进入 Expression web 中的站点设置并确认 php 被选中并且它指向 php 可执行文件
*   重新安装php
*   检查 iis 是否注册了 php 扩展。
*   将文件复制到安装了表达式 web 和 php 的另一台机器上，它可以运行。
*   奇怪的是，它在表达式 web 中提供了一个空白（没有错误）页面，但在 inetpub 中确实有效
*   这一直工作到最近，然后突然无缘无故停止了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T12:12:12.283

我找到了解决我的特定问题的方法。

php.ini 文件已被编辑，但保存它的格式有问题。删除 php.ini 并获取一个新文件使 php 恢复生机。

奇怪的是，根本没有报告任何错误来说明它为什么不起作用。

# grails - 在grails中将对象从视图传递到对象

> ID：12354911
> 
> 赞同：0
> 
> 时间：2012-09-10T15:33:53.937
> 
> 标签：grails

> **可能重复：**
> [填充域实例的 Grails](https://stackoverflow.com/questions/12358212/grails-populating-a-domain-instance)

在我这样做的时候，我想将一个 childInstance 对象从我的视图传递给控制器

```
<g:formRemote url="[action: 'updateStatus']" update="messages" name="updateStatusForm" onSuccess="document.updateStatusForm.message.value='';"> 
```

updateStatus 方法如下

```
def updateStatus(String message) {
        def status = new Post(message: params.message, author: lookupPerson())
        System.out.println("status: " + status.message + " : " + status.author)
        status.save(flush: true, failOnError: true)
        def messages = currentUserTimeline()
        render template: 'profileMessages', collection: messages, var: 'profileMessage'
    } 
```

我想从我的视图中添加一个 childInstance 到 updateStatus。但是如果我不将 childInstance 传递给更新状态，我也想工作。

我希望这是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T18:37:15.107

您不能将对象实例作为请求参数传递给控制器​​。请求参数是字符串。因此，您可以将对象 ID 作为参数传递，然后在控制器中按 ID 加载此对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T13:47:26.280

将此添加到网址

```
url="[action: 'updateStatus' params:[id:'obj.id']]" 
```

并在您的控制器方法中调用它

```
object = Obj.get(params.id) 
```

# jquery - 在 jQuery 中解析 XML

> ID：12354916
> 
> 赞同：1
> 
> 时间：2012-09-10T15:34:24.800
> 
> 标签：jquery, html, xml, parsing, xml-parsing

我今天早些时候发布（[旧问题](https://stackoverflow.com/questions/12350245/jquery-help-parse-xml-into-array)）寻求帮助以解析 XML。我当时并没有意识到该解决方案并没有完全解决我的问题。

我的问题是，虽然我可以通过查找单个元素来解析 XML，但我需要记下每个项目所在的级别。每个 XML 文档的项目和类别的数量各不相同，但结构都相同。

```
<?xml version="1.0"?>
<config>
<game>
    <title>Dementia</title>
        <cat>
            <catTitle>Mild</catTitle>
            <item>mild-1</item>
            <item>mild-2</item>
            <item>mild-3</item>
        </cat>
        <cat>
            <catTitle>Moderate</catTitle>
            <item>Moderate-1</item>
            <item>Moderate-2</item>
            <item>Moderate-3</item>
        </cat>
        <cat>
            <catTitle>Severe</catTitle>
            <item>Severe-1</item>
            <item>Severe-2</item>
        </cat>
</game> 
```

例如，当使用 'find("item")' 时，我需要它还记下它在 (0,1,2,3,4 等) 下的哪个位置。catTitle 也需要这样做。

然后我想将此数字分配为属性。这将允许我轻松比较该项目是否与其类别匹配，基于 .

目前我有以下内容：

```
 //XML Array
///////////////////////////////////////
function loadXML(){
  $.ajax({
        type: "GET",
        url: XML_PATH,
        dataType: "xml",
        success: parseXMLtoArray
        }); 
}

function parseXMLtoArray(xml){

$(xml).find("cat").each(function(idx, v) {
    categoryArrays[idx] = [];

    $(v).find("item").each(function( i , vi) {
        categoryArrays[idx].push( $(vi).text() );
    });             
});
console.log(categoryArrays);
}
/////////////////////////////////////// 
```

为了更好地理解这样做的目的，我附上了截图：

用户将“项目”拖到底部的正确类别，然后根据它是否正确，它是可放置的。 ![交互式 jQuery 测试](../Images/fa83b32cbe76d31a0588d979fdf5c2af.png)

**任何帮助将不胜感激！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:06:25.460

我想到了。我将 XML 解析为数组并为每个项目创建了一个对象，添加了其类别的属性 (.attr)，以便以后可以调用它。

```
//XML Array
///////////////////////////////////////
function loadXML(){
  $.ajax({
        type: "GET",
        url: XML_PATH,
        dataType: "xml",
        success: parseXMLtoArray
        }); 
}

function parseXMLtoArray(xml){

$(xml).find("cat").each(function(idx, v) {
    categoryArrays[idx] = [];

    $(v).find("catTitle").each(function(){

        //$(xml).find('title:contains("Dimentia")').each(function(){
        numberofCategories = numberofCategories+1;
        tmpCategory = $(this).text();
        categoryNames.push(tmpCategory);

        var $item = $('<div>' + tmpCategory + '</div>').fadeIn('slow').appendTo('#catPile').attr('categoryName', tmpCategory).attr('categoryNum', idx).droppable({
            containment: '#content',
            stack: '#catPile div',
            cursor: 'move',
            drop: handleDropEvent
        });

    });

    //ITEM PARSING
        $(v).find("item").each(function( i , vi) {
            categoryArrays[idx].push( $(vi).text() );

            numberofItems = numberofItems+1;
            tmpItem = $(this).text();

            //Add Item to Array
            itemNames.push(tmpItem);

                   //UI CREATION and Atrribute setting
                    var $item = $('<div>' + tmpItem + '</div>').fadeIn('slow').appendTo('#itemPile').attr('itemName', tmpItem).attr('categoryNum', categoryArrayNum).draggable({
                        containment: '#content',
                        stack: '#itemPile div',
                        cursor: 'move',
                        revert: true
                    });

                    console.log("Item Created: " + tmpItem + " // Item's Category:" + categoryArrayNum) ;

        });

    console.log('-- Category Array Num: ' + categoryArrayNum + ' contains: ' + categoryArrays[categoryArrayNum]);
    categoryArrayNum++;
});

console.log("// ITEMS ASSIGNED TO CATEGORIES");
} 
```

希望这对某人有帮助！

# html - WHATWG html5 标准文档中的 idl 属性是什么意思？

> ID：12354918
> 
> 赞同：49
> 
> 时间：2012-09-10T15:34:27.670
> 
> 标签：html, standards, idl

在阅读 WHATWG 的 HTML5——[面向 Web 开发人员的技术规范时，](http://developers.whatwg.org)我看到了许多参考资料，例如：

> # 在 IDL 属性中反映内容属性
> 
> 一些 IDL 属性被定义为反映特定的内容属性。这意味着在获取时，IDL 属性返回内容属性的当前值，在设置时，IDL 属性将内容属性的值更改为给定值。

和：

> 在符合性文件中，只有一个正文元素。document.body IDL 属性使脚本可以轻松访问文档的正文元素。
> 
> body 元素将 Window 对象的许多事件处理程序作为事件处理程序内容属性公开。它还反映了它们的事件处理程序 IDL 属性。

我（诚然是模糊的）理解来自 Windows 世界。我认为 .idl 文件用于映射 n 层分布式应用程序中的远程过程调用。我会假设内容属性是指 html 元素属性。

*我可以看到*标准中没有任何地方可以解释术语“内容属性”和“IDL 属性”的这种用法。谁能解释这些术语的含义以及这两种属性之间的关系？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-09-10T15:52:20.393

IDL（[接口定义语言](https://en.wikipedia.org/wiki/Interface_description_language)）来自[Web IDL](http://dev.w3.org/2006/webapi/WebIDL/)规范：

> 本文档定义了一种接口定义语言 Web IDL，可用于描述旨在在 Web 浏览器中实现的接口。Web IDL 是一种 IDL 变体，具有许多功能，可以更容易地指定 Web 平台中常见脚本对象的行为。本文档还详细介绍了使用 Web IDL 描述的接口如何对应于 ECMAScript 执行环境中的构造。

内容属性是出现在标记中的属性：

```
<div id="mydiv" class="example"></div> 
```

在上面的代码中`id`和`class`都是属性。通常一个内容属性会有一个对应的 IDL 属性。

例如，以下 JavaScript：

```
document.getElementById('mydiv').className = 'example' 
```

相当于设置`class`内容属性。

在 JavaScript 文本中，IDL 属性通常被称为属性，因为它们作为 DOM 对象的属性暴露给 JavaScript。

虽然通常有一对对应的内容属性和 IDL 属性/属性，但它们不一定可以互换。例如，对于一个`<option>`元素：

*   content 属性`selected`表示选项的*初始*状态（当用户更改选项时不会改变），
*   该属性`selected`反映控件的*当前*状态

# iphone - 将选择器添加到动态添加的 UIScrollView 视图上的按钮

> ID：12354919
> 
> 赞同：-2
> 
> 时间：2012-09-10T15:34:39.793
> 
> 标签：iphone, objective-c, ios, uiscrollview

我有一个 UIScrollView，其中 n 个视图从归档存储的元数据中动态添加。我有一个 PressGesture 来制作**摆动**动画（如 iOS 删除应用程序的方式），我想在 ScrollView 上的每个子视图中添加一个按钮，以便从 ScrollView 和文件中删除它。

我的问题是将目标添加到按钮。当它们被按下时，选择器（在 UIScrollView 的 UIViewController 父级上）不会被调用。

我怎样才能完成这项工作？建议任何其他方法？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T19:25:26.173

当您为视图设置动画时，它会停止响应用户输入。如果您的按钮位于动画视图内，它肯定不会调用选择器。

解决方案是将摆动的视图包装到透明的超级视图中，然后将删除按钮放在该超级视图中。如果您需要您的按钮也“摇摆”，那么您需要在您的摇摆视图中放置一个代表按钮的图像。并且在包装器内部放置了一个透明的自定义按钮，它实际上会在用户点击时做出反应。

# ruby-on-rails - 如何将轮胎（elasticsearch）中的构面添加到 has_many 关联

> ID：12354921
> 
> 赞同：3
> 
> 时间：2012-09-10T15:34:43.060
> 
> 标签：ruby-on-rails, ruby-on-rails-3, lucene, elasticsearch, tire

我想向 has_many 关联添加方面。

我正在从 PostgreSQL 全文搜索迁移到弹性搜索。

目前我有以下 SQL 查询来进行搜索（PostgreSQL 方式）：

```
rt = "#{Rule.table_name}"
Sentence.
  joins(:rules).joins(:regulations).joins(:speakers).
  where(:authority_name => params[:authority_name], :authority_detail_1 => params[:authority_detail_1]).
  where(:regulations => {:regulation_name => params[:regulation_name]}).
  where("#{rt}.description @@ #{Sentence.sanitize(words)} OR #{rt}.headline @@ #{Sentence.sanitize(words)}") 
```

我查看了关于类似问题的 SO 答案（HABTM 协会）

[查询上的 Elasticsearch 方面的问题](https://stackoverflow.com/questions/9895941/facet-troubles-with-elasticsearch-on-query)

并用类似的方法实现了代码

-Sentence AR类

```
class Sentence < ActiveRecord::Base
  # other staff

  include Tire::Model::Search
  include Tire::Model::Callbacks

  mapping do
    indexes :id
    indexes :authority_name, :type => :string, :index => "not_analyzed"
    indexes :authority_detail_1, :type => :string, :index => "not_analyzed"
    indexes :authority_detail_2, :type => :string, :index => "not_analyzed"
    indexes :regulations, :type => :object, :properties => {
      :regulation_name => { :type => :string, :index => "not_analyzed" }
    }
  end

  def to_indexed_json
    to_json(:include => [:rules, :regulations, :speaker])
  end

  def self.search(params)
    tire.search(page: params[:page], per_page: 5, load: true) do
      query do
        boolean do
          must { string params[:query], default_operator: "AND" } if params[:query].present?
          must { term :authority_name, params[:authority_name] } if params[:authority_name].present?
          must { term :authority_detail_1, params[:authority_detail_1] } if params[:authority_detail_1].present?
          must { term :authority_detail_2, params[:authority_detail_2] } if params[:authority_detail_2].present?

          must { terms 'regulations.regulation_name', params[:regulation_name] } if params[:regulation_name].present?
        end
      end
      facet 'authorities' do
        terms :authority_name
        terms :authority_detail_1
        terms :authority_detail_2
      end
      facet 'regulations' do
        terms 'regulations.regulation_name'
      end
      # raise to_curl
    end
  end

  # other staff

end # end of Class 
```

但是这段代码不起作用。

调用 API 后出现错误：

```
Tire::Search::SearchRequestFailed in SentencesController#search 
```

{

```
"error": "SearchPhaseExecutionException[Failed to execute phase [query], total failure; shardFailures {[-ocpucv-TwGCmLfPd3U9hQ][sentences][4]: SearchParseException[[sentences][4]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\"query\":{\"bool\":{\"must\":[{\"query_string\":{\"query\":\"appalto\",\"default_operator\":\"AND\"}},{\"terms\":{\"regulations.regulation_name\":\"Cod. civ.\"}}]}},\"facets\":{\"authorities\":{\"terms\":{\"field\":\"authority_detail_2\",\"size\":10,\"all_terms\":false}},\"regulations\":{\"terms\":{\"field\":\"regulations.regulation_name\",\"size\":10,\"all_terms\":false}}},\"size\":5,\"from\":0}]]]; nested: }{[-ocpucv-TwGCmLfPd3U9hQ][sentences][0]: SearchParseException[[sentences][0]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\"query\":{\"bool\":{\"must\":[{\"query_string\":{\"query\":\"appalto\",\"default_operator\":\"AND\"}},{\"terms\":{\"regulations.regulation_name\":\"Cod. civ.\"}}]}},\"facets\":{\"authorities\":{\"terms\":{\"field\":\"authority_detail_2\",\"size\":10,\"all_terms\":false}},\"regulations\":{\"terms\":{\"field\":\"regulations.regulation_name\",\"size\":10,\"all_terms\":false}}},\"size\":5,\"from\":0}]]]; nested: }{[-ocpucv-TwGCmLfPd3U9hQ][sentences][1]: SearchParseException[[sentences][1]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\"query\":{\"bool\":{\"must\":[{\"query_string\":{\"query\":\"appalto\",\"default_operator\":\"AND\"}},{\"terms\":{\"regulations.regulation_name\":\"Cod. civ.\"}}]}},\"facets\":{\"authorities\":{\"terms\":{\"field\":\"authority_detail_2\",\"size\":10,\"all_terms\":false}},\"regulations\":{\"terms\":{\"field\":\"regulations.regulation_name\",\"size\":10,\"all_terms\":false}}},\"size\":5,\"from\":0}]]]; nested: }]",
"status": 500 
```

}

在这里，JSON 错误被解析为更“人性化的可读形式”：

```
SearchPhaseExecutionException[Failed to execute phase [query], total failure; shardFailures {[-ocpucv-TwGCmLfPd3U9hQ][sentences][4]: SearchParseException[[sentences][4]: from[-1],size[-1]: Parse Failure [Failed to parse source
[{"query":
   {"bool":
     {"must": [
       {"query_string":{"query":"appalto","default_operator":"AND"}},
       {"terms":{"regulations.regulation_name":"Cod. civ."}}
     ]}
   },
    "facets":
     {"authorities":
       {"terms":
         {"field":"authority_detail_2","size":10,"all_terms":false}
       },
      "regulations":
       {"terms":
         {"field":"regulations.regulation_name","size":10,"all_terms":false}
       }
     },
     "size":5,"from":0}]
]];
nested: }{[-ocpucv-TwGCmLfPd3U9hQ][sentences][0]: SearchParseException[[sentences][0]: from[-1],size[-1]: Parse Failure [Failed to parse source [{"query":{"bool":{"must":[{"query_string":{"query":"appalto","default_operator":"AND"}},{"terms":{"regulations.regulation_name":"Cod. civ."}}]}},"facets":{"authorities":{"terms":{"field":"authority_detail_2","size":10,"all_terms":false}},"regulations":{"terms":{"field":"regulations.regulation_name","size":10,"all_terms":false}}},"size":5,"from":0}]]];
nested: }{[-ocpucv-TwGCmLfPd3U9hQ][sentences][1]: SearchParseException[[sentences][1]: from[-1],size[-1]: Parse Failure [Failed to parse source [{"query":{"bool":{"must":[{"query_string":{"query":"appalto","default_operator":"AND"}},{"terms":{"regulations.regulation_name":"Cod. civ."}}]}},"facets":{"authorities":{"terms":{"field":"authority_detail_2","size":10,"all_terms":false}},"regulations":{"terms":{"field":"regulations.regulation_name","size":10,"all_terms":false}}},"size":5,"from":0}]]];
nested: }] 
```

知道如何在轮胎中正确实现 has_many 关联吗？

**PS**是的，我在更改轮胎映射后运行了 rake 任务。

* * *

***编辑：***

好的。我`500`通过更改代码中的一行来修复错误（术语 => 术语）。

```
 must { term 'regulations.regulation_name', params[:regulation_name] } if params[:regulation_name].present? 
```

但是现在我的搜索结果是空的？有人知道怎么修这个东西吗？也许我应该使用其他类型的匹配（我目前正在使用`boolean`+`must`组合）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T12:20:37.590

我有一个错字。当我解决这个问题时，一切正常。

我将为其他用户发布清晰的代码

-映射

```
 mapping do
    indexes :id
    indexes :authority_name, :type => :string, :index => "not_analyzed"
    indexes :authority_detail_1, :type => :string, :index => "not_analyzed"
    indexes :authority_detail_2, :type => :string, :index => "not_analyzed"

    indexes :regulations do
      indexes :name, :type => :string, :index => "not_analyzed"
    end
  end

  def to_indexed_json
    to_json(:include => [:rules, :regulations, :speaker])
  end 
```

-搜索方法

```
 def self.search(params)
    empty_params = false
    if params[:query].blank? && params[:authority_name].blank? &&
      params[:authority_detail_1].blank? && params[:authority_detail_2].blank? &&
      params[:regulation_name].blank? && params[:regulation_number].blank? &&
      params[:regulation_year].blank? && params[:regulation_article].blank?
      empty_params = true
    end

    unless empty_params
      tire.search(page: params[:page], per_page: 5, load: true) do
        query do
          boolean do
            must { string params[:query], default_operator: "AND" } if params[:query].present?
            must { term :authority_name, params[:authority_name] } if params[:authority_name].present?
            must { term :authority_detail_1, params[:authority_detail_1] } if params[:authority_detail_1].present?
            must { term :authority_detail_2, params[:authority_detail_2] } if params[:authority_detail_2].present?

            must { term "regulations.name", params[:regulation_name] } if params[:regulation_name].present?
            must { term "regulations.norm_number", params[:regulation_number] } if params[:regulation_number].present?
            must { term "regulations.year", params[:regulation_year] } if params[:regulation_year].present?
            must { term "regulations.article_number", params[:regulation_article] } if params[:regulation_article].present?
          end
        end
        # raise to_curl
      end
    else
      tire.search(page: params[:page], per_page: 5, load: true) do
        query do
          all
        end
      end
    end
  end 
```

# macos - 如何以编程方式读取 Mac OSX 的双击持续时间？

> ID：12354923
> 
> 赞同：0
> 
> 时间：2012-09-10T15:34:43.870
> 
> 标签：macos, operating-system, mouseevent

我需要阅读和使用操作系统双击持续时间设置。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:49:18.510

```
NSTimeInterval doubleClickInterval = [NSEvent doubleClickInterval]; 
```

# jsf - 全方位：IllegalArgumentException FullAjaxExceptionHandler

> ID：12354929
> 
> 赞同：1
> 
> 时间：2012-09-10T15:35:14.923
> 
> 标签：jsf, omnifaces

我尝试使用 FullAjaxExceptionHandler 来捕获来自 ajax 请求的异常。不幸的是，当视图过期时，我得到了 IllegalArgumentException。在堆栈跟踪下方：

```
java.lang.IllegalArgumentException: Either HTTP 500 or java.lang.Throwable error page is required in web.xml or web-fragment.xml. Neither was found.
at org.omnifaces.exceptionhandler.FullAjaxExceptionHandler.findErrorPageLocations(FullAjaxExceptionHandler.java:263)
at org.omnifaces.exceptionhandler.FullAjaxExceptionHandler.findErrorPageLocation(FullAjaxExceptionHandler.java:228)
at org.omnifaces.exceptionhandler.FullAjaxExceptionHandler.handle(FullAjaxExceptionHandler.java:165)
at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:119)
at com.sun.faces.lifecycle.RestoreViewPhase.doPhase(RestoreViewPhase.java:113)
at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
at javax.faces.webapp.FacesServlet.service(FacesServlet.java:409)
at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1534)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)
at jsf.filter.MetaTagFilter.doFilter(MetaTagFilter.java:35)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)
at jsf.filter.ServletExceptionFilter.doFilter(ServletExceptionFilter.java:28)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:98)
at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:91)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162)
at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:326)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:227)
at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:170)
at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:822)
at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:719)
at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1013)
at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)
at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
at java.lang.Thread.run(Thread.java:722) 
```

它只发生在 ajax 请求上。在完整请求的情况下，页面 (timeout.jsp) 将显示。

我的 web.xml 中的一些片段：

```
<error-page>
    <exception-type>javax.faces.application.ViewExpiredException</exception-type>
    <location>/WEB-INF/timeout.jsp</location>
</error-page>

<error-page>
    <error-code>500</error-code>
    <location>/WEB-INF/error.html</location>
</error-page> 
```

Webapp 运行于：Glassfish 3.1、JSF 2.1.0 (Mojarra)、primefaces 3.3.1、omnifaces 1.1

* * *

更新：

当我使用 facelets 而不是 jsp 或 html 作为错误页面时，我在非 ajax 请求上收到 IllegalStateException。这就是我使用html页面的原因。

```
Warnung: StandardWrapperValve[Faces Servlet]: PWC1406: Servlet.service() for servlet Faces Servlet threw exception
javax.faces.application.ViewExpiredException: viewId:/faces/main.xhtml - Ansicht /faces/main.xhtml konnte nicht wiederhergestellt werden.
at com.sun.faces.lifecycle.RestoreViewPhase.execute(RestoreViewPhase.java:202)
at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
at com.sun.faces.lifecycle.RestoreViewPhase.doPhase(RestoreViewPhase.java:113)
at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
at javax.faces.webapp.FacesServlet.service(FacesServlet.java:409)
at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1534)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)
at jsf.filter.MetaTagFilter.doFilter(MetaTagFilter.java:35)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)
at jsf.filter.ServletExceptionFilter.doFilter(ServletExceptionFilter.java:28)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:98)
at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:91)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162)
at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:326)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:227)
at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:170)
at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:822)
at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:719)
at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1013)
at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)
at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
at java.lang.Thread.run(Thread.java:722)

Warnung: ApplicationDispatcher[/bpv-editor] PWC1231: Servlet.service() for servlet Faces Servlet threw exception
 java.lang.IllegalStateException: Context is already active
at org.jboss.weld.context.AbstractConversationContext.activate(AbstractConversationContext.java:301)
at org.jboss.weld.jsf.WeldPhaseListener.activateConversations(WeldPhaseListener.java:110)
at org.jboss.weld.jsf.WeldPhaseListener.beforePhase(WeldPhaseListener.java:84)
at com.sun.faces.lifecycle.Phase.handleBeforePhase(Phase.java:228)
at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:99)
at com.sun.faces.lifecycle.RestoreViewPhase.doPhase(RestoreViewPhase.java:113)
at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
at javax.faces.webapp.FacesServlet.service(FacesServlet.java:409)
at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1534)
at org.apache.catalina.core.ApplicationDispatcher.doInvoke(ApplicationDispatcher.java:787)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:649)
at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:485)
at org.apache.catalina.core.ApplicationDispatcher.doDispatch(ApplicationDispatcher.java:454)
at org.apache.catalina.core.ApplicationDispatcher.dispatch(ApplicationDispatcher.java:350)
at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:474)
at org.apache.catalina.core.StandardHostValve.dispatchToErrorPage(StandardHostValve.java:671)
at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:295)
at org.apache.catalina.core.StandardHostValve.postInvoke(StandardHostValve.java:220)
at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:328)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:227)
at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:170)
at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:822)
at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:719)
at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1013)
at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)
at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
at java.lang.Thread.run(Thread.java:722)

Warnung: org.apache.catalina.core.StandardHostValve@12d5d7d: Exception Processing    ErrorPage[exceptionType=javax.faces.application.ViewExpiredException, location=/WEB-INF/errorpages/timeout.xhtml]
javax.servlet.ServletException: Context is already active
at javax.faces.webapp.FacesServlet.service(FacesServlet.java:422)
at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1534)
at org.apache.catalina.core.ApplicationDispatcher.doInvoke(ApplicationDispatcher.java:787)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:649)
at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:485)
at org.apache.catalina.core.ApplicationDispatcher.doDispatch(ApplicationDispatcher.java:454)
at org.apache.catalina.core.ApplicationDispatcher.dispatch(ApplicationDispatcher.java:350)
at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:474)
at org.apache.catalina.core.StandardHostValve.dispatchToErrorPage(StandardHostValve.java:671)
at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:295)
at org.apache.catalina.core.StandardHostValve.postInvoke(StandardHostValve.java:220)
at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:328)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:227)
at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:170)
at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:822)
at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:719)
at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1013)
at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)
at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.IllegalStateException: Context is already active
at org.jboss.weld.context.AbstractConversationContext.activate(AbstractConversationContext.java:301)
at org.jboss.weld.jsf.WeldPhaseListener.activateConversations(WeldPhaseListener.java:110)
at org.jboss.weld.jsf.WeldPhaseListener.beforePhase(WeldPhaseListener.java:84)
at com.sun.faces.lifecycle.Phase.handleBeforePhase(Phase.java:228)
at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:99)
at com.sun.faces.lifecycle.RestoreViewPhase.doPhase(RestoreViewPhase.java:113)
at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
at javax.faces.webapp.FacesServlet.service(FacesServlet.java:409)
... 27 more
----- Root Cause -----
java.lang.IllegalStateException: Context is already active
at org.jboss.weld.context.AbstractConversationContext.activate(AbstractConversationContext.java:301)
at org.jboss.weld.jsf.WeldPhaseListener.activateConversations(WeldPhaseListener.java:110)
at org.jboss.weld.jsf.WeldPhaseListener.beforePhase(WeldPhaseListener.java:84)
at com.sun.faces.lifecycle.Phase.handleBeforePhase(Phase.java:228)
at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:99)
at com.sun.faces.lifecycle.RestoreViewPhase.doPhase(RestoreViewPhase.java:113)
at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
at javax.faces.webapp.FacesServlet.service(FacesServlet.java:409)
at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1534)
at org.apache.catalina.core.ApplicationDispatcher.doInvoke(ApplicationDispatcher.java:787)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:649)
at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:485)
at org.apache.catalina.core.ApplicationDispatcher.doDispatch(ApplicationDispatcher.java:454)
at org.apache.catalina.core.ApplicationDispatcher.dispatch(ApplicationDispatcher.java:350)
at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:474)
at org.apache.catalina.core.StandardHostValve.dispatchToErrorPage(StandardHostValve.java:671)
at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:295)
at org.apache.catalina.core.StandardHostValve.postInvoke(StandardHostValve.java:220)
at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:328)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:227)
at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:170)
at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:822)
at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:719)
at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1013)
at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)
at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
at java.lang.Thread.run(Thread.java:722) 
```

# asp.net - Twitter bootstrap + asp.net masterpages，如何在用户选择导航栏项目时将其设置为活动？

> ID：12354935
> 
> 赞同：14
> 
> 时间：2012-09-10T15:35:44.503
> 
> 标签：asp.net, twitter-bootstrap, master-pages, navbar

[我们处于与Make Twitter Bootstrap navbar link active](https://stackoverflow.com/questions/11813498/make-twitter-bootstrap-navbar-link-active)问题相同的情况，但在我们的例子中，我们使用的是 ASP.net 和 MasterPages ......

问题是导航栏是在母版页上定义的，当您单击菜单项时，您将被重定向到相应的子页面，那么如何在不复制每个子页面中的逻辑的情况下连续更改导航栏活动项？（最好没有会话变量和仅在母版页上的 javascript）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-11T06:50:35.107

我们在 Master Page 使用以下功能解决了这个问题：

```
 <script type="text/javascript">
        $(document).ready(function () {
            var url = window.location.pathname;
            var substr = url.split('/');
            var urlaspx = substr[substr.length-1];
            $('.nav').find('.active').removeClass('active');
            $('.nav li a').each(function () {
                if (this.href.indexOf(urlaspx) >= 0) {
                    $(this).parent().addClass('active');
                }
            });
        });
    </script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-11T22:42:29.013

这是我在 Razor 中使用的：

```
<li class="@(Model.PageName == "DataEntryForms" ? "active" : "")">
  <a href="DataEntryForms">     
    Data Entry Forms
  </a>
</li>
<li class="@(Model.PageName == "UserAdmin" ? "active" : "")">
  <a href="UserAdmin">      
    User Administration
  </a>
</li> 
```

只需将页面名称定义为模型中的属性，然后为您拥有的每个 li 完成测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-12-09T09:47:11.910

```
 <script type="text/javascript">
     $(document).ready(function () {
         var url = window.location;
         $('ul.nav li a').each(function () {
             if (this.href == url) {
                 $("ul.nav li").each(function () {
                     if ($(this).hasClass("active")) {
                         $(this).removeClass("active");
                     }
                 });
                 $(this).parent().parent().parent().addClass('active');
                 $(this).parent().addClass('active');                     
             }
         });
     });
</script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-14T23:57:22.027

假设 ASP.net 正确设置了活动类，我会推荐一个更简单的解决方案：

```
// Add the class to the parent li element of the active a element:
$('#NavigationMenu ul li a.active').parent().addClass('active');

// Remove the active class from the a element:
$('#NavigationMenu ul li a.active').removeClass('active'); 
```

使用 ASP.net 路由，这个解决方案可以在我当前的项目中顺利运行。

如果你想操作菜单的活动项，我建议在后面的代码中使用菜单控件的 MenuItemDataBound 。但就我而言，这不是必需的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-28T08:16:06.077

“sujit kinage”的解决方案对我来说效果最好，但是我不得不改变一行：

```
var url = window.location.origin + window.location.pathname; 
```

# java - 使用 Android Async HTTP 时没有得到响应（来自 loopj）

> ID：12354936
> 
> 赞同：1
> 
> 时间：2012-09-10T15:35:54.723
> 
> 标签：java, android, http

我正在使用来自 loopj.com 的 Async Http 库以及来自该站点的示例代码。

问题是当请求发出时我没有得到响应。我什至重写了 onFinish() 函数，该函数也没有起火。

我正在使用他们网站上的示例代码，如下所示：

```
import com.loopj.android.http.AsyncHttpClient;
import com.loopj.android.http.AsyncHttpResponseHandler;

    Log.v("bopzy_debug", "Testing HTTP Connectivity");
    System.out.println("123");
    AsyncHttpClient client = new AsyncHttpClient();

    client.get("http://www.google.com",
            new AsyncHttpResponseHandler() {
                @Override
                public void onSuccess(String response) {
                    Log.v("bopzy_debug", response);
                }
                @Override
                public void onFinish() {
                    Log.v("bopzy_debug", "Finished..");
                }
            }); 
```

任何关于如何解决的想法都将不胜感激，不确定这里发生了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T15:51:10.403

您需要添加`<uses-permission android:name="android.permission.INTERNET"/>`到您的`AndroidManifest`

*注意：这个需要在`<application>`标签外面加上*

# django - Django，要上传图像（ImageField）或文件（FileField）

> ID：12354941
> 
> 赞同：3
> 
> 时间：2012-09-10T15:36:23.523
> 
> 标签：django, django-models, django-forms

我的 html 页面中有一个表单，提示用户将文件或图像上传到服务器。我希望能够上传以太文件或图像。假设用户选择文件，图像应该为空，反之亦然。现在我只能上传他们两个，没有错误。但是如果我选择只上传其中一个（假设我选择图片），我会收到一个错误：

```
"Key 'attachment' not found in <MultiValueDict: {u'image': [<InMemoryUploadedFile: police.jpg (image/jpeg)>]}>" 
```

![在此处输入图像描述](../Images/2a6019d2d67bdaa3914565e2f49ca040.png)

# 模型.py：

```
#Description of the file 
class FileDescription(models.Model):

    TYPE_CHOICES = (
        ('homework', 'Homework'),
        ('class', 'Class Papers'),
        ('random', 'Random Papers')                    
    )

    subject = models.ForeignKey('Subjects', null=True, blank=True)
    subject_name = models.CharField(max_length=100, unique=False)

    category = models.CharField(max_length=100, unique=False, blank=True, null=True)

    file_type = models.CharField(max_length=100, choices=TYPE_CHOICES, unique=False) 
    file_uploaded_by = models.CharField(max_length=100, unique=False)
    file_name = models.CharField(max_length=100, unique=False)
    file_description = models.TextField(unique=False, blank=True, null=True)
    file_creation_time = models.DateTimeField(editable=False)
    file_modified_time = models.DateTimeField()

    attachment = models.FileField(upload_to='files', blank=True, null=True, max_length=255)
    image = models.ImageField(upload_to='files', blank=True, null=True, max_length=255)

    def __unicode__(self):
        return u'%s' % (self.file_name)

    def get_fields(self):
        return [(field, field.value_to_string(self)) for field in FileDescription._meta.fields]

    def filename(self):
        return os.path.basename(self.image.name)

    def category_update(self):
        category = self.file_name
        return category

    def save(self, *args, **kwargs):
        if self.category is None:
            self.category = FileDescription.category_update(self)
        for field in self._meta.fields:
            if field.name == 'image' or field.name == 'attachment':
                field.upload_to = 'files/%s/%s/' % (self.file_uploaded_by, self.file_type)
        if not self.id:
            self.file_creation_time = datetime.now()
        self.file_modified_time = datetime.now()
        super(FileDescription, self).save(*args, **kwargs) 
```

# 表格.py

```
class ContentForm(forms.ModelForm):
    file_name =forms.CharField(max_length=255, widget=forms.TextInput(attrs={'size':20}))
    file_description = forms.CharField(widget=forms.Textarea(attrs={'rows':4, 'cols':25}))

    class Meta:
        model = FileDescription 
        exclude = ('subject',
                   'subject_name',
                   'file_uploaded_by',
                   'file_creation_time',
                   'file_modified_time',
                   'vote')

    def clean_file_name(self):
        name = self.cleaned_data['file_name']
        # check the length of the file name
        if len(name) < 2:
            raise forms.ValidationError('File name is too short')
        # check if file with same name is already exists
        if FileDescription.objects.filter(file_name = name).exists():
            raise forms.ValidationError('File with this name already exists')
        else:
            return name 
```

# 视图.py

```
if request.method == "POST":
        if "upload-b" in request.POST:
            form = ContentForm(request.POST, request.FILES, instance=subject_id)       
            if form.is_valid(): # need to add some clean functions
               # handle_uploaded_file(request.FILES['attachment'],
               #                      request.user.username,
               #                      request.POST['file_type'])
                form.save()
                up_f = FileDescription.objects.get_or_create(
                    subject=subject_id,
                    subject_name=subject_name,
                    category = request.POST['category'],
                    file_type=request.POST['file_type'],
                    file_uploaded_by = username,
                    file_name=form.cleaned_data['file_name'],
                    file_description=request.POST['file_description'],
                    image = request.FILES['image'],
                    attachment = request.FILES['attachment'],
                )
                return HttpResponseRedirect(".") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:52:43.237

> 假设用户选择文件，图像应该为空，反之亦然。

你可以：

1.  做一个 SQL 约束，

2.  `model.save()`如果文件或图像为空白，则覆盖失败，

3.  如果文件或图像为空白，请定义`ContentForm.clean()`引发 a ，请参阅[清理和验证相互依赖的字段](https://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-and-validating-fields-that-depend-on-each-other)。`ValidationError`

还要注意 up_f 将是一个元组：

```
up_f = FileDescription.objects.get_or_create( 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-07T21:09:33.523

我有同样的问题。由于某种原因，键值字典仅采用一个键对值。像这样保存附件

附件=form.data['附件']

与

附件=request.FILES['附件']

它应该运行，但很好奇它是否会保存为文件。
我知道这个问题很老，但遇到同样的问题很困难

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-29T12:48:20.487

为用户创建单选按钮以选择他/她要上传的内容，并在模型中仅使用一个 FileField 属性。您可以将其他字段转换为 BooleanField 或 CharField 以指示用户选择的内容。

# vba - 如何在 Word Doc 中嵌入 PDF，并使用 VBA 访问该 PDF？

> ID：12354945
> 
> 赞同：1
> 
> 时间：2012-09-10T15:36:41.653
> 
> 标签：vba, pdf, excel, embed, ms-word

我有一个带有一些 ActiveX 按钮的 word 文档。当按下其中一个按钮时，会弹出一个 UserForm 并显示相应的 PDF，如下所示：

![在此处输入图像描述](../Images/6b77d601c86d7d35a0b5f5a3d1d6a16f.png) 这正是我想要的行为。但是，问题在于，要使其正常工作，word doc 的用户还需要将每个 PDF 保存在他们的机器上。这是其中一个按钮的代码：

```
Private Sub AC1Button_Click()

    DisplayForm.AcroPDF1.LoadFile ("C:\Users\arose\Desktop\Security Control Doc\Sub PDFs\AC1.pdf")
    DisplayForm.Show

End Sub 
```

如您所见，路径是硬编码的。我需要能够分发这个word doc而不需要分发一堆PDF，所以有没有办法将PDF嵌入到word文档中VBA可以访问它们吗？

我在[这里](http://office.microsoft.com/en-us/word-help/add-a-pdf-to-your-office-file-HA102351554.aspx)发现在任何办公文档中嵌入 PDF 相当容易。我试过了：

![在此处输入图像描述](../Images/7e2f3054ae29c9d1cbc05d922fa8f145.png)

但我不知道如何在我的 VBA 代码中访问该 PDF 对象，以便在用户窗体上显示它。

任何见解表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T18:46:46.967

嵌入文件（并显示为图标以阻止它们接管您的文档）

要激活文档中的第一个 OLE 对象，

```
ThisDocument.InlineShapes(1).OLEFormat.Activate 
```

是命令。

# mysql - 如何在 MySQL 中构建一个非常简单的博客的表？

> ID：12354947
> 
> 赞同：15
> 
> 时间：2012-09-10T15:36:55.587
> 
> 标签：mysql, database, database-design, blogs

我想在我现有的一个 LAMP 网站上添加一个非常简单的博客功能。它将与用户现有的个人资料相关联，他们将能够简单地为博客中的每篇文章输入标题和正文，提交时会自动设置日期。他们将被允许随时编辑和删除任何博客文章和标题。该博客将从最近到最旧的顺序显示，一个页面可能有 20 个帖子，上面有适当的分页。其他用户可以对每篇文章发表评论，博客所有者可以删除这些评论，但不能预先审核。基本上就是这样。就像我说的，非常简单。

**我应该如何为此构建 MySQL 表？**

我假设由于会有博客文章和评论，我需要为每个单独的表格，对吗？但是每个表中我需要哪些列，我应该使用哪些数据结构，以及我应该如何将两个表链接在一起（例如任何外键）？

我找不到任何类似这样的教程，我想做的是真正为我的用户提供最简单的博客版本。没有标签，没有审核，没有图像，没有花哨的格式等。只是一个简单的日记类型，纯文本博客，有其他用户的评论。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-10T15:58:04.570

我会说你需要以下表格

```
Posts
  PostID (identity)
  PostTitle (varchar)
  PostDate (datetime)
  Deleted (int)
  OwnerID (int FK to Users)

PostDetails
  PostDetailID (identity)
  PostID (FK to Posts)
  Sequence (int) -> for long posts you order by this
  PostText (text)

Comments
  CommentID (identity)
  Comment (text)
  CommenterID (int FK to Users)
  CommentDate (datetime)
  Deleted (int)

Users
  UserID (identity)
  UserNAme (varchar)
  UserEmail (varchar)
  CreatedDate (datetime)
  Active (int) 
```

所有日期时间字段默认为当前时间，所有身份字段均为 PK 帖子详细信息中的序列字段，以防您不使用文本类型并使用 varchar，以便您可以将帖子拆分为多条记录。

除此之外，我会查看任何开源博客系统，看看他们做了什么，并减去我不需要的东西。

希望有帮助

# mongodb - MongoDB db.serverStatus() 在使用针对 api.cloudfoundry.com 的隧道运行时出错

> ID：12354949
> 
> 赞同：-1
> 
> 时间：2012-09-10T15:37:00.810
> 
> 标签：mongodb, cloud-foundry, tunnel

以下是控制台会话...

```
C:\Users\xxx>vmc tunnel myMongoDB
Getting tunnel connection info: OK

Service connection info:
  username : uuuu
  password : pppp
  name     : db
  url      : mongodb://uuuu:pppp@172.30.xx.xx:25200/db

Starting tunnel to myMongoDB on port 10000.
1: none
2: mongo
3: mongodump
4: mongorestore
Which client would you like to start?: 2
Launching 'mongo --host localhost --port 10000 -u uuuu -p pppp db'

MongoDB shell version: 2.0.6
connecting to: localhost:10000/db
> db.serverStatus()
{ "errmsg" : "need to login", "ok" : 0 }
> 
```

我应该使用哪些凭据来登录（假设应该使用 db.auth）以消除错误“ **{“errmsg”：“需要登录”，“ok”：0 }** “。

当我在我的机器上的 micro CF 中运行相同的程序时，它工作正常并给了我预期的输出。

PS我正在尝试这个来了解我的应用程序上的当前连接，用node.js编写。尝试调试与数据库连接的一些问题。如果我可以使用任何其他替代方法，请也提出建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T15:59:37.307

this *should* work! Not sure why your tunnel isn't connecting, my immediate suggestion is to try another instance of MongoDB and see if the same error occurs.

If you are trying to inspect the bound services on you node.js app you should be able to inspect them in the VCAP_SERVICES environment variable. For example;

```
var http = require('http');
var util = require('util');

http.createServer(function (req, res) {
  res.writeHead(200, {'Content-Type': 'text/plain'});
  res.write(util.inspect(process.env.VCAP_SERVICES));
  res.write("\n\n************\n\n");
  res.end(util.inspect(req.headers));

}).listen(3000); 
```

This code is currently running at [http://node-headers.cloudfoundry.com/](http://node-headers.cloudfoundry.com/) to serve as an example. However, mongodb connections for node.js applications should automatically configure to the bound service. If this does not work for you, then please do let me know.

# templates - MS Access (2010) 启用设计视图

> ID：12354951
> 
> 赞同：1
> 
> 时间：2012-09-10T15:37:16.270
> 
> 标签：templates, ms-access, designview

我下载了下面的访问模板来做一个家庭清单：

[http://office.microsoft.com/en-us/templates/results.aspx?qu=home%20inventory&ex=1&queryid=0d245f2a%2Dacdc%2D4161%2D92c8%2D8ba16a52ab32&AxInstalled=1&c=0#ai:TC101918100|](http://office.microsoft.com/en-us/templates/results.aspx?qu=home%20inventory&ex=1&queryid=0d245f2a%2Dacdc%2D4161%2D92c8%2D8ba16a52ab32&AxInstalled=1&c=0#ai:TC101918100|)

设计视图是不可见的，这有点令人讨厌。

我尝试过的事情：1）在选项/选项/当前数据库/复选框（启用布局视图和启用数据表视图中的表的设计更改）都是灰色的。2) 我已经使用右键单击-> 属性解除了对文件的阻止。
3) 我尝试将对象复制/导出到另一个数据库。但只能复制/导出表格。4）我尝试在打开数据库时按住 shift 键。5）启用所有信任权限等。

这些都不起作用

有没有人有什么建议。（我使用的是 Office 2010）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-13T04:27:21.300

我知道这是一个旧线程，但以防万一有人仍在寻找答案，[这对我有用](http://www.access-programmers.co.uk/forums/showthread.php?t=219350)。我转换了 Projects Web 数据库。

过程如下：

*   创建一个空白的“客户端”accdb 数据库。

*   将模板 Web 数据库中的所有 Web 表、客户端表单、客户端报告导入空白客户端 accdb 数据库。

*   关闭客户端数据库并打开模板 Web 数据库。

（现在，您必须从每个 Web 对象单独创建一个客户端对象。这可能有点乏味。）

*   突出显示要创建相应客户端对象的 Web 对象（例如 Web 表单）。单击文件选项卡，然后单击保存并发布，然后将对象另存为，最后单击另存为客户端对象按钮。为客户端对象指定一个与 Web 对象不同的名称（例如，将客户端添加到名称的末尾）。

*   您需要对模板 Web 数据库中的每个 Web 查询、Web 表单、Web 报表和 Web 宏重复这些步骤。

*   一旦每个 Web 对象在模板 Web 数据库中都有对应的客户端对象，打开“客户端”数据库并导入您刚刚创建的所有客户端对象。将对象重命名为其原始名称（如果您接受我上面的建议，请删除“客户”一词）。

现在您应该有一个可以更改为您喜欢的工作模板数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:40:48.530

Home inventory is set up as web forms and these do not have the same design view as the "normal" Access forms.

[Albert Kallal](http://social.msdn.microsoft.com/Forums/en-US/accessdev/thread/aded6487-1183-49aa-ab9d-5be62a05587b) says:

> Unfortunately , there is no conversion utility.
> 
> However, you can use those web forms with VBA or so called Access client forms.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:38:46.043

解决方案：

1.  创建一个新的空白数据库
2.  使用导入向导导入所有表、查询、报告、宏等

# java - Hibernate 生成随机实体

> ID：12354952
> 
> 赞同：3
> 
> 时间：2012-09-10T15:37:18.283
> 
> 标签：java, hibernate, random, hibernate-tools

使用休眠可以轻松生成随机实体的强文本。例如，我有一个带有 2 个字段（姓名和姓氏）的简单实体用户，我需要创建 100 个不同的实体。

是否可以使用 Hibernate 创建具有随机字段的不同实体？当我有一个与用户有关联的电话时，我还可以创建 10 个不同的随机电话吗？

**Hibernate 是否有一个类或函数来执行此操作？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:45:01.553

这不是 Hibernate 试图解决的问题，因为它是一个 ORM。

这是一个完全不同的问题，对于您描述的简单情况，您自己应该很容易做到。

但是，当您开始谈论大量表格和验证等时，这根本不是一个很容易的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T17:45:08.017

您应该将 Hibernate 视为对象世界和关系世界之间的转换器。它不想操作对象、创建新对象等等。它的唯一任务是在使用 OO 进行编码和坚持使用 Relational 时简化程序员的生活。所以简短的回答是否定的，它不是为此目的而建造的。

# android - android content provider - 隐藏内部复杂性但允许复杂查询的设计模式

> ID：12354953
> 
> 赞同：3
> 
> 时间：2012-09-10T15:37:19.280
> 
> 标签：android, database, design-patterns

我有一个关于使用内容提供者实现复杂查询的最佳实践的问题。正如我从 android 联系人内容提供商看到的，建议使用字段*selection*、*selectionArgs*等来发出特定请求。

我现在正在塑造我的第一个自己的内容提供商。它背后有一个相当复杂的野兽，带有规范化表的数据库的所有连接、全文表等结构。当然，我想对内容提供者的用户隐藏这种复杂性，但我只是还不知道如何实现它。*如果用户使用selection*，*selectionArgs*等指定他的请求，内容提供者似乎必须解析这些并将其映射到底层结构。是否有一些用于此解析的工具，或者我最终会编写自己的*选择*字符串解析器等。

恐怕这是要走的路，但在实施之前，我想听听周围 android 专业人士的一些建议。

非常感谢

马丁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T12:40:19.737

这就是我现在所处的位置，至少我想快速分享一些解决方案，以获得鼓舞人心的专家反馈，并可能为周围的其他血腥新手提供一些提示。一开始我的基本错误似乎是没有引入内容提供商向其用户提供的“虚拟”数据库之类的层。一旦完成，隐藏背后的复杂性并且可以使用查询的正常语法。

所以我所做的是在内容提供者合同类中有一个“虚拟”数据库层，

```
public class JustDharmaQuotesContract {

public class Quote {

    public static final String TABLE_NAME = QuoteTable.TABLE_NAME;

    public static final String _ID = TABLE_NAME + "." + QuoteTable._ID;
    public static final String AUTHOR = TABLE_NAME + "." + QuoteTable.AUTHOR;
    public static final String AUTHOR_FULL_NAME = TABLE_NAME + "." + QuoteTable.AUTHOR_FULL_NAME;
    public static final String TITLE = TABLE_NAME + "." + QuoteTable.TITLE;
    public static final String QUOTE = TABLE_NAME + "." + QuoteTable.QUOTE;
    public static final String QUOTE_LENGTH = TABLE_NAME + "." + QuoteTable.QUOTE_LENGTH;
    public static final String BLOG_POST_LINK = TABLE_NAME + "." + QuoteTable.BLOG_POST_LINK;
} 

public class QuoteFTS {

    public static final String TABLE_NAME = QuoteFtsTable.TABLE_NAME;

    public static final String _ID = TABLE_NAME + "." + QuoteFtsTable._ID;
    public static final String TITLE = TABLE_NAME + "." + QuoteFtsTable.TITLE;
    public static final String QUOTE = TABLE_NAME + "." + QuoteFtsTable.QUOTE;
    public static final String SNIPPET = "snippet";

    public static final String AUTHOR = Quote.TABLE_NAME + "." + QuoteTable.AUTHOR;
    public static final String AUTHOR_FULL_NAME = Quote.TABLE_NAME + "." + QuoteTable.AUTHOR_FULL_NAME;
    public static final String QUOTE_LENGTH = Quote.TABLE_NAME + "." + QuoteTable.QUOTE_LENGTH;
    public static final String BLOG_POST_LINK = Quote.TABLE_NAME + "." + QuoteTable.BLOG_POST_LINK;

}

} 
```

Quote 层基本上一对一地映射到数据库的 QuoteTable 和 QuoteFTS 层表示 FTS 表和 Quote 表之间的连接。（相应 fts 片段结果的片段列）这里我使用与数据库列名相同的列名，以便用户的投影和选择适合数据库。（包括表名，以便连接正常工作）

内容提供者的用户现在可以对提供的这两个虚拟数据库层进行各种查询，例如

```
Uri uri = QuoteContentProvider.FTS_URI;

switch (order) {
    case 1: {
        sortOrder = QuoteFTS.TITLE + " COLLATE NOCASE";
        break;
    }
    case 2: {
        sortOrder = QuoteFTS.AUTHOR + ", " + QuoteFTS.TITLE
                + " COLLATE NOCASE";
        break;
    }
    case 3: {
        sortOrder = QuoteFTS.QUOTE_LENGTH;
        break;
    }
}

String[] projection = new String[] { QuoteFTS._ID,
            QuoteFTS.TITLE, QuoteFTS.AUTHOR, QuoteFTS.SNIPPET}; 

String selection = titleOnly ? QuoteFTS.TITLE + " MATCH ? " : QuoteFTS.TABLE_NAME + " MATCH ? ";
String[] selectionArgs = {appendWildcard(query)};

Loader<Cursor> loader = CursorLoader(this, uri, projection,selection, selectionArgs, sortOrder); 
```

仍然需要正确了解如何使用 MATCH 语法等才能使其正常工作。这一点让我感到有点不舒服，我非常感谢对此的反馈。

谢谢哥们

马丁

# git - Git - 将代码推送到现有仓库

> ID：12354956
> 
> 赞同：-3
> 
> 时间：2012-09-10T15:37:25.273
> 
> 标签：git, bitbucket, git-push

我的朋友在 BitBucket 上创建了一个项目。我将它下载为 ZIP 文件，然后进行处理并将代码部署到 Heroku。现在我需要将我目前在我机器上的这段代码推送到 BitBucket 上的原始存储库。

怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:41:08.013

创建自己的分叉并创建拉取请求。

# database - 在 where 子句中调用 oracle 函数

> ID：12354958
> 
> 赞同：0
> 
> 时间：2012-09-10T15:37:38.823
> 
> 标签：database, oracle

> **可能重复：**
> [是否有在 plsql 中拆分字符串的函数？](https://stackoverflow.com/questions/3710589/is-there-a-function-to-split-a-string-in-plsql)

我有以下 oracle 功能

```
create or replace
function FUN_CUSTID(t in varchar2)
  RETURN VARCHAR2
IS
  TYPE str_array2 IS TABLE OF VARCHAR2(100);
  v_names str_array2;
  v_condition varchar2(1000);
BEGIN
   v_condition := '(';
   select REGEXP_SUBSTR(t, '[^ ,]+', 1, rownum) 
      bulk collect into v_names
      from DUAL
      connect by level <= length (regexp_replace(t, '[^ ,]+'))  + 1;

  FOR indx in v_names.FIRST..v_names.LAST LOOP 

    if (indx = v_names.LAST) then
     v_condition := v_condition || '''' || v_names(indx) ||'''';
    else
      v_condition := v_condition || '''' || v_names(indx) ||''',';
    end if;
  v_condition := v_condition || ')';
   END LOOP;

   return v_condition;
end FUN_CUSTID;
/ 
```

现在我想从 where 子句中调用这个函数

```
SELECT customer_id,
       name_remark,
       wbs_id,
       service_circuit_id,
       sum(actual_minutes) TOTAL_USAGE,
       min(first_connection_time) DATE_FROM,
       max(first_connection_time) DATE_TO,
       sum(amount) AMOUNT
  FROM temp
  FROM customer_id IN (SELECT FUN_CUSTID('CUST00001,CUST00002') FROM DUAL)
  GROUP BYcustomer_id, name_remark, wbs_id, service_circuit_id
  ORDER BY customer_id; 
```

当我直接运行此函数并替换值以代替上层查询中的函数调用时，它可以完美地处理某些记录，但上层查询无法正常工作。

如何在where子句中调用函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T16:07:08.783

您的函数在其中生成其输出，`v_condition`因为`('A','B',.....)`这是`select`查询中 Oracle 的一个完整字符串，并且不适用于`IN`. 考虑为此使用动态 SQL。Oracle 将函数的输出视为一个单一值，`('A','B',.....)`因此该`IN`子句将被解析为 -

```
IN ('('A','B',.....)',...) 
```

这不是你想要的。你想要像下面这样的东西

```
IN ('A','B',.....) 
```

而这可以通过动态 SQL 来实现。

# ios - UIPinchGestureRecognizer在水平和垂直方向上的比例分别是

> ID：12354959
> 
> 赞同：11
> 
> 时间：2012-09-10T15:37:39.213
> 
> 标签：ios, scale, pinch, uipinchgesturerecognizer, pinchzoom

使用 UIPinchGestureRecognizer 时，分别检测/读取水平和垂直方向的捏合比例的最佳方法是什么？我看到了这个帖子

[UIPinchGestureRecognizer 在不同的 x 和 y 方向缩放视图](https://stackoverflow.com/questions/5349907/uipinchgesturerecognizer-scale-view-in-different-x-and-y-directions)

但我注意到有很多人来回做这样一个看似例行的任务，我不确定这是最好的答案/方式。

如果不为此目的完全使用 UIPinchGestureRecognizer 就是答案，那么在两个不同方向上检测捏合比例的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-07-12T00:52:27.173

基本上做到这一点，

```
func _mode(_ sender: UIPinchGestureRecognizer)->String {

    // very important:
    if sender.numberOfTouches < 2 {
        print("avoided an obscure crash!!")
        return ""
    }

    let A = sender.location(ofTouch: 0, in: self.view)
    let B = sender.location(ofTouch: 1, in: self.view)

    let xD = fabs( A.x - B.x )
    let yD = fabs( A.y - B.y )
    if (xD == 0) { return "V" }
    if (yD == 0) { return "H" }
    let ratio = xD / yD
    // print(ratio)
    if (ratio > 2) { return "H" }
    if (ratio < 0.5) { return "V" }
    return "D"
} 
```

该函数将为您返回 H、V、D .. 水平、垂直、对角线。

你会像这样使用它......

```
func yourSelector(_ sender: UIPinchGestureRecognizer) {

    // your usual code such as ..
    // if sender.state == .ended { return } .. etc

    let mode = _mode(sender)
    print("the mode is \(mode) !!!")

    // in this example, we only care about horizontal pinches...
    if mode != "H" { return }

    let vel = sender.velocity
    if vel < 0 {
        print("you're squeezing the screen!")
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-08T15:00:05.330

在我的 C# 中，我执行以下操作

```
 private double _firstDistance = 0;
    private int _firstScaling = 0;
    private void PinchHandler(UIPinchGestureRecognizer pinchRecognizer)
    {
        nfloat x1, y1, x2, y2 = 0;
        var t1 = pinchRecognizer.LocationOfTouch(0, _previewView);
        x1 = t1.X;
        y1 = t1.Y;
        var t2 = pinchRecognizer.LocationOfTouch(1, _previewView);
        x2 = t2.X;
        y2 = t2.Y;

        if (pinchRecognizer.State == UIGestureRecognizerState.Began)
        {
            _firstDistance = Math.Sqrt(Math.Pow((x2 - x1), 2) + Math.Pow((y2 - y1), 2));
            _firstScaling = _task.TextTemplates[_selectedTextTemplate].FontScaling;
        }
        if (pinchRecognizer.State == UIGestureRecognizerState.Changed)
        {
            var distance = Math.Sqrt(Math.Pow((x2 - x1), 2) + Math.Pow((y2 - y1), 2));
            var fontScaling = Convert.ToInt32((distance - _firstDistance) / _previewView.Frame.Height * 100);
            fontScaling += _firstScaling;
            _task.TextTemplates[_selectedTextTemplate].FontScaling = fontScaling;
            UpdateBitmapPreview();
        }
    } 
```

我计算捏“开始”时两点之间的距离并将该值保存在两个私人中。然后我根据第一个测量距离和第二个测量距离（在“更改”中）计算缩放（fontScaling）。我使用自己的视图 (_previewView) 设置为基础 (100%)，但您可以使用 View.Bounds.height 或宽度来代替。就我而言，我总是有一个方形视图，所以我的应用程序中的高度 == 宽度。

# excel - ms-excel：提取数字的小数和整数部分并禁用字段更改

> ID：12354962
> 
> 赞同：3
> 
> 时间：2012-09-10T15:37:43.867
> 
> 标签：excel, field, protection, cells

我有一个数字字段（比如 A）。我必须在另一个字段（比如 B）中提取它的整数部分，在另一个字段（比如 C）中提取它的小数部分。我希望用户在更改 A 单元格时可以看到 B 和 C 单元格中的值，但同时我不希望用户可以更改 B 和 C 单元格中的值。

可能吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-10T15:44:09.040

假设您在单元格 A1 中有 10.6。从那里，这样做：

*   在单元格 B1 中，输入`=INT(A1)`。这将显示**10**。
*   在单元格 C1 中，输入`=A1 - INT(A1)` 这将显示**0.6**。

    或者，根据您的示例，如果您希望**0.6**显示为**6**，或**0.56**显示为**56**，请在单元格 C1 中使用：

    `=(A1 - B1) * (10 ^ (LEN(ROUND(A1-B1, 2))-2))`

    我`ROUND`到小数点后两位，因为当你因为浮点计算而得到奇怪的长度时（`LEN(8.8-8)`例如尝试）。

*   根据需要复制 B1 和 C1 中的公式。

*   通过选择所有单元格，右键单击表格并选择“格式化单元格...”，单击“保护”选项卡并取消选中“锁定”来解锁所有单元格。

*   右键单击要锁定的范围（B和c），再次右键单击它们，返回并选择“锁定”
*   转到工具 > 保护和保护工作表

# javascript - 将 jquery 选择器转换为数组

> ID：12354965
> 
> 赞同：5
> 
> 时间：2012-09-10T15:37:56.610
> 
> 标签：javascript, jquery, arrays, selector

我需要能够将当前选择器存储在当前视口中，然后 10 秒检查它们是否仍在用户当前视口中。

我对此的解决方案是将选择器存储在一个数组中，然后在 10 秒内将旧选择器与新选择器进行比较，看看是否有任何匹配。如果他们这样做……做点什么。

所以我相信使用 .each 并构建数组，除非有人对此有更优雅的解决方案？

```
$('.gridContainers:in-viewport') 
```

这将返回一个标准选择器。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-10T15:39:37.130

Calling $(selector) returns an array-like jQuery object, not an actual JavaScript array, though for the purposes of what they're trying to do converting it to an actual array may be unnecessary.

This is how one would turn a selector into an native Javascript array.

```
$(selector).toArray() 
```

[Jquery.toArray()](http://api.jquery.com/toArray/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-05T10:52:00.553

使用**ES6**：

```
Array.from($(selector)); // return JS array 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T15:45:27.090

试试下面的 FIND 方法：

```
$('element').find('selection'); 
```

这会将所有选定的元素提供给 Array。希望这可以帮助

# c# - Window CE 6 奇怪的文件 IO 问题

> ID：12354967
> 
> 赞同：1
> 
> 时间：2012-09-10T15:38:00.617
> 
> 标签：c#, windows-ce

我有一个计时器函数，它每分钟将一个对象序列化为一个 xml 文件。它工作了一段时间，但大约 38 小时后，它出现了下面的 IO 异常。![在此处输入图像描述](../Images/eee65944f87c9d56d023504c89c3a588.png)

我可以看到目录在那里，正如您在我的屏幕截图中看到的那样。此外，当此问题发生时，我什至可以在 dos 中键入以下命令： echo "test" > test.xml 并且可以在该确切目录位置创建 test.xml 文件。

我的代码如下：

```
try
  {
    if (!Directory.Exists(filePath))
      this.log.Write(LogLevel.Fatal, this.componentName, "Directory not exists: " + filePath);

     lock (lockObject)
        {
          filepath = filepath + "ApplicationState.xml";
          if (File.Exists(filePath))
             File.Delete(filePath);

          if (this.StateObject != null && !File.Exists(filePath))
          {
             using (Stream sWrite = File.Create(filePath))
             {
                this.Serializer = new XmlSerializer(typeof(State));
                this.Serializer.Serialize(sWrite, this.StateObject);
             }
           }
        }
     }catch (Exception ex)
     {
        if (this.log != null)
        {
           this.log.Write(ex, this.componentName);
        }
     }
     finally
     {
        if (this.StreamWriter != null)
        {
             this.StreamWriter.Close();
        }
        bRun = true;

      } 
```

我尽力检查代码以确保没有任何挂起的 IO 资源，在这一点上，老实说，我很迷茫……window CE 或 C# 是否有某种类型的锁定资源除了我用来打开和读取文件的 IO 之外的通用 IO？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T18:08:16.467

I see that you're writing to something called "\Hard Disk" which makes me think you're likely writing to some persistent storage volume (e.g. on-board flash, a USB disk, CF card or whatever). Bear in mind that these peripherals require a device driver and likely some interrrupt handlers, which are provided by the device OEM and not Microsoft as part of the OS.

There's always the possibility that there's a bug in the driver chain somewhere that's causing the issue - it smells like a concurrency lock failure. Remember, when working with an embedded OS, never assume a failure you see is always your code. The OEM could easily have a bug in their code.

I'd attack this two ways:

1.  Report the issue to the OEM and see if they can repro/fix it
2.  尝试将重试逻辑添加到您自己的代码中，以查找并处理此问题作为解决方法。

# jquery - 在 Asp.Net MVC3 中使用 Twitter Bootstrap 时的下拉问题

> ID：12354968
> 
> 赞同：1
> 
> 时间：2012-09-10T15:38:01.273
> 
> 标签：jquery, asp.net, asp.net-mvc-3, jquery-plugins, twitter-bootstrap

我正在使用 MVC3 Asp.Net 并尝试将 Twitter Bootstrap 实施到项目中。我得到了基本的东西，但不是下拉菜单。我有以下html代码

```
<%@ Master Language="C#" Inherits="System.Web.Mvc.ViewMasterPage" %>
<!DOCTYPE html>
<html lang="en">
<head runat="server">
<title><asp:ContentPlaceHolder ID="TitleContent" runat="server" /></title>
<script src="../../Scripts/jquery-1.5.1.js" type="text/javascript"></script>
<script src="../../Scripts/bootstrap.js" type="text/javascript"></script>
<link href="../../Content/bootstrap.css" rel="stylesheet" type="text/css" />
<link href="../../Content/bootstrap-responsive.css" rel="stylesheet" type="text/css" />
</head>
 <body>
<div class="navbar navbar-inverse navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
       <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="#">Test Project</a>
      <div class="nav-collapse">
        <ul class="nav">
          <li class="active"><a href="#">Main Menu</a></li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Main Menu with SubMenu<b class="caret"></b></a>
            <ul class="dropdown-menu">
                <li>First Menu</li>
                <li>Second Menu</li>
                <li>Third Menu</li>
            </ul>
          </li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </div>
</div>
<script type="text/javascript">
    jQuery(function ($) {
        alert("Starting Dropdown");
        $('.dropdown-toggle').dropdown();
    });
</script>
<asp:ContentPlaceHolder runat="server" ID="MainContent" ></asp:ContentPlaceHolder>
 </body>
 </html> 
```

出于某种原因，下拉菜单没有出现，我尝试了几件事，但它不起作用。我不确定它是否与我使用的版本有关。他们是

ASP.NET MVC3

jQuery 1.5.1 Bootstrap CSS - v2.1.1 Bootstrap 下载 JS - v2.1.1

我将不胜感激这方面的任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T16:18:01.163

Twitter Bootstrap 使用 jQuery[`on()`](http://api.jquery.com/on/)函数来委派事件，该函数是在 1.7 版中引入的。您需要至少升级到该版本才能使 jQuery 插件（例如**bootstrap-collapse.js**）运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:59:48.950

You are ommiting the dropdown for collapsed state:

```
<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
</a> 
```

And you are forcing that collapsed state with class `collapse`, delete it:

```
<div class="nav-collapse"> 
```

# webpage - 静态页面和动态页面的区别？

> ID：12354972
> 
> 赞同：1
> 
> 时间：2012-09-10T15:38:16.083
> 
> 标签：webpage, dynamic-pages, static-pages

我正在对可用的网页类型进行一些研究，我遇到了这两种类型：静态和动态。但是，我从中阅读它的网站并没有为我提供太多信息，让我了解这些类型的页面的作用以及首选哪些类型的网站/功能。谁能向我解释这两种网页类型中的每一种的功能并告诉我它们的区别/何时使用它们？谢谢！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T15:44:01.757

来自维基百科：

> 与由 Web 应用程序生成的动态网页相比，静态网页（有时称为平面页面）是完全按存储方式交付给用户的网页。

这是一个很好的比较： [静态与动态网站 - 有什么区别？](http://www.edinteractive.co.uk/article/?id=4)

# coldfusion - ColdFusion - 如何读取用户名而不是登录名

> ID：12354973
> 
> 赞同：0
> 
> 时间：2012-09-10T15:38:20.010
> 
> 标签：coldfusion

我继承了一个 ColdFusion 应用程序（我是 ColdFusion 中的菜鸟），它使用 GetAuthUser() 读取登录用户的名称，然后附加 @mycompany.com 以发送电子邮件。

我们将迁移到一个新域，在该域​​下我们收到的用户名与我们的电子邮件地址不匹配。

例如，我以 rickhodder 登录，我的电子邮件地址是 rickhodder@mycompany.com，我在新域下的登录名是 C12345，但我的电子邮件地址仍然是 rickhodder@mycompany.com。

从一些在线研究中，我看到 ColdFusion 不反对活动目录，它反对 NT 域。

ColdFusion 下有没有办法读取与用户关联的电子邮件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T16:04:27.630

我认为 CF 不会“开箱即用”地为您提供这些信息。您可能希望查看 CFLDAP 功能并使用它从您的 AD 服务器中查找用户信息，其中应该包含您需要的信息。

如果您走这条路，您可以使用自己的详细信息来连接以进行开发，但请确保您创建了一个帐户以在生产中进行 LDAP 连接。它应该将密码设置为不过期，并且无权登录或执行其他操作。您的域管理员可能会比我能解释的更清楚您的目标。

# java - 如何创建需要动态参数的对象

> ID：12354975
> 
> 赞同：4
> 
> 时间：2012-09-10T15:38:23.773
> 
> 标签：java, spring

从我使用 spring 的第一天开始，我总是有一个问题。如果一个类有一个构造函数需要两个参数，但是这2个参数不固定，是根据输入请求生成的，每次都不一样，但是我需要spring容器来管理类的实例，在spring中如何实现? 例如

```
 Class A{
     A(int x,int y){//omit}
} 
```

但是x和y不是固定的，我们需要通过我们的程序计算x和y，然后我们可以用普通的java代码为A创建实例，如下所示

```
 int x=calculate(request);
    int y=calculate(request);
    A a=new A(x,y); 
```

但是如何让spring管理A类的实例创建呢？

附加信息：为什么我需要 A 类由 spring 管理，因为 A 依赖于一些由 spring 管理的其他类。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-10T15:59:32.057

*   最直接的方法是使用`ApplicationContext.getBean(String name, Object... args)`- 它可以创建一个`prototype`-scoped bean，将给定的参数传递给它的构造函数。显然，`ApplicationContext`直接在任何使用`A`.

*   更优雅的方法是将创建隐藏在`A`工厂后面。该工厂可以在内部使用以前的方法，或者它可以以常规方式（`Provider<A>`等）获取 bean 的实例，然后调用非`public`初始化方法来传递该参数（而不是通过使用构造函数传递参数）。

*   另一个方法是使用[`@Configurable`和加载时编织](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/aop.html#aop-atconfigurable)，它允许 Spring 初始化使用`new`. 虽然它需要一些额外的运行时环境配置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T15:50:17.570

> 它们是根据输入请求生成的，每次都不一样，但是我需要spring容器来管理类的实例，在spring中如何实现呢？

你没有。您需要实例化以响应用户输入的类并不意味着由 Spring 管理。

仅仅因为您使用 Spring 来管理一些 bean，并不意味着*所有 bean/类*都应该由 Spring 管理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T15:55:50.163

您希望将 Spring Bean 定义为 a`prototype`而不是 a `singleton`。这样，在每个新请求上，您的 Spring 上下文都会创建一个新的 bean 实例。

在 Java 配置中，它看起来像这样：

`@Scope("prototype") @Bean public MyBean myBean() { ... }`

在 xml 中：

`<bean id="myBean" class="whatever.MyBean" scope="prototype"> ...`

还有一些范围可以绑定到 HTTP 会话。看：

[http://static.springsource.org/spring/docs/3.0.0.M3/reference/html/ch04s04.html](http://static.springsource.org/spring/docs/3.0.0.M3/reference/html/ch04s04.html)

而且，正如其他人指出的那样，您必须为您的 bean 定义一个工厂方法：

请参阅：[Spring 和在运行时将参数传递给工厂方法](https://stackoverflow.com/questions/6784960/spring-and-passing-parameters-to-factory-method-in-runtime)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T15:52:04.087

也许您必须将构造函数更改为：

```
Class A{
 A(Request request){ this.x=calculate(request); ....}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-10T15:54:08.610

我假设它`int`可以被某个`Object`实例替换。实现这一点的一种方法是使用[Spring 的 FactoryBean](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-factory-extension-factorybean)功能来自定义 bean 的初始化：

```
class AFactory implements o.s.b.f.FactoryBean {

  private SomeObject firstParam;
  private OtherObject secondParam;

  public Object getObject() {
    return new A(firstParam, secondParam);
  }

  public Class getObjectType() {
    return A.class;
  }

  public boolean isSingleton() {
    return false; 
    // i.e. every time #getObject() is called a new instance is created === prototype scope
  }

  public void setFirstParam(SomeObject firstParam){}
  public void setSecondParam(OtherObject secondParam){}

} 
```

**请注意**，如果`SomeObject`并且`OtherObject`实际上可以是其他`FactorBean`s 的依赖项的工厂`A`，那么每次调用 时`AFactory#getObject()`，您实际上都会收到一个`A`使用其所需依赖项的新实例的新实例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-10T15:55:17.500

您可以尝试在 BeanFactory 类中使​​用此方法（由 ApplicationContext 扩展）

Object getBean(String name, Object... args) throws BeansException;

在您的情况下： context.getBean("A", x, y);

其中“A”是类 A 的 bean 名称。

# google-plus - 如何获取用户在列出的商家 - Google + 本地上传的照片

> ID：12354979
> 
> 赞同：0
> 
> 时间：2012-09-10T15:38:37.660
> 
> 标签：google-plus, google-places-api, google-places

嗨，我正在尝试获取本地企业（Google + 中列出的企业）用户上传的照片。

例如

从下面指向班加罗尔 REX 剧院的 URL，我想获取用户上传的照片。

[https://plus.google.com/111678408090599994953/photos](https://plus.google.com/111678408090599994953/photos)

我曾尝试使用 google places api 和 Place details api，但它们似乎都没有提供任何与照片相关的信息。

如果我能在 Google 用户上传的地方获取照片，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:49:46.897

**编辑：** Places API 现在支持返回一张地方照片（如果可用于[地方搜索请求](https://developers.google.com/places/documentation/search)）和最多十张地方照片用于[地方详情请求](https://developers.google.com/places/documentation/details)。

如果您的请求返回了照片数组，您可以将`photo_reference`包含的照片对象中的和/或,和参数传递给[放置照片请求：](https://developers.google.com/places/documentation/photos)`maxheight``maxwidth``sensor``key`

```
https://maps.googleapis.com/maps/api/place/photo?maxwidth=400&photoreference=CnRvAAAAwMpdHeWlXl-lH0vp7lez4znKPIWSWvgvZFISdKx45AwJVP1Qp37YOrH7sqHMJ8C-vBDC546decipPHchJhHZL94RcTUfPa1jWzo-rSHaTlbNtjh-N68RkcToUCuY9v2HNpo5mziqkir37WU8FJEqVBIQ4k938TI3e7bf8xq-uwDZcxoUbO_ZJzPxremiQurAYzCTwRhE_V0&sensor=false&key=AddYourOwnKeyHere 
```

有关详细信息，请参阅[文档。](https://developers.google.com/places/documentation/photos)

# javascript - 如何在页面侧面的浮动框中显示我的用户脚本的输出？

> ID：12354989
> 
> 赞同：4
> 
> 时间：2012-09-10T15:39:10.640
> 
> 标签：javascript, button, greasemonkey, webpage

我正在为[Unicreatures 编写](http://unicreatures.com/)一个用户脚本，用于在探索期间跟踪事件。它正在工作（好吧，它可以工作，但仍然需要一些工作，哈哈），但我需要一种方法来显示我正在收集的信息，而不涉及每个步骤的弹出警报。

## 如何在页面上创建一个框并在其中显示内容？

我希望在此页面的菜单左侧创建一个框架、窗口等任何内容，并在我的脚本运行时将各种变量的值写入其中。

我在 localStorage 中收集这些数据，所以我的脚本将首先更新各种 localStorage 属性，然后以某种方式在此框中显示结果：

```
localStorage.steps = Number(localStorage.steps) + 1;
displayValueInFloatingBox(localStorage.steps + ' in Sargasso' ); 
```

我还想在这个框中添加一个按钮来重置这些属性的值，这样我就可以选择永远跟踪还是只跟踪一两个会话，而不必每次都编辑脚本（特别是如果我决定分享脚本）。我假设这只会将变量设置为零，所以我只需要知道如何创建按钮并让它做某事......这可能会以某种方式使用 eventListener。

请坚持使用纯 JavaScript，不要使用 jQuery ......我现在仍然几乎没有得到 JavaScript。并且请解释答案，以便我了解某些东西是如何工作的——我不只是想要让我回到类似问题的代码片段，因为我不明白为什么使用了一些代码。

### 附录 A：我当前的脚本

```
// ==UserScript==
// @name Unicreatures Egg pop-up
// @namespace Unicreatures Egg pop-up
// @description Unicreatures Egg pop-up
// @include http://unicreatures.com/explore.php*
// @include http://www.unicreatures.com/explore.php*
// ==/UserScript==
var regexp = /You find an? (Exalted )?(.*?) egg nearby/;
var match = regexp.exec( document.body.innerHTML );
if ( match ) {
  if ( match[1] ) {
      alert( "Exalted egg found: " + match[2] );
  } else {
      alert( "Normal egg found: " + match[2] );
  }
}
var y = document.body.innerHTML;
var links = document.getElementsByTagName( 'a' );

for ( var i = 0; i < links.length; i++ ) {
var link = links[i];
if ( /area=sea(?!\&gather)/.test( link.href )) {
      link.addEventListener( 'click', function () {
      localStorage.steps=Number(localStorage.steps)+1
      // alert(localStorage.steps + ' in Sargasso' );
    }, true );
  }
}

//document.addEventListener('click', function(){alert('page clicked')}, true);

if(y.indexOf("You find a Noble")> 0)
{
  alert('Noble Egg Alert');
}

if(y.indexOf("You find an Exalted")> 0)
{
  localStorage.exaltedEggCount=Number(localStorage.exaltedEggCount)+1;
  alert('Exalted Egg Alert '+localStorage.exaltedEggCount);
}

if(y.indexOf("egg nearby!")> 0)
{
  localStorage.eggCount=Number(localStorage.eggCount)+1;

  alert('Egg Alert '+localStorage.eggCount);
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-10T18:28:22.940

这是将框添加到页面左上角的一种简单方法。首先，我们需要创建一个`div`元素来充当盒子。（其他 HTML 元素也可以，但`div`它是一个不错的选择，因为它没有特殊含义，它只是一个简单的容器。）

```
var box = document.createElement( 'div' ); 
```

我们将给我们的盒子一个 ID，以便我们以后可以找到它`document.getElementsById()`，以便我们可以[使用 CSS 对其进行样式设置](https://developer.mozilla.org/en-US/docs/CSS)：

```
box.id = 'myAlertBox'; 
```

现在我们需要设置盒子的样式。由于我们使用的是 GreaseMonkey，我们可以使用[`GM_addStyle`](http://wiki.greasespot.net/GM_addStyle)向文档添加 CSS 样式规则：

```
GM_addStyle( 
    ' #myAlertBox {             ' +
    '    background: white;     ' +
    '    border: 2px solid red; ' +
    '    padding: 4px;          ' +
    '    position: absolute;    ' +
    '    top: 8px; left: 8px;   ' +
    '    max-width: 400px;      ' +
    ' } '
); 
```

请注意在 JavaScript 中包含[多行字符串](http://wiki.greasespot.net/Multi_Line_Strings)的笨拙语法。（还有其他方法来设置盒子的样式，也可以在 GreaseMonkey 之外使用。我将在下面展示其中的一些。）

查看 CSS 样式规则本身，前三行只是说我们的盒子应该有一个白色背景和一个 2 像素宽的红色边框，并且边框和内容之间应该有 4 个像素的填充。所有这些只是[让它看起来像](https://developer.mozilla.org/en-US/docs/CSS/Getting_Started/Boxes)一个典型的简单警报框。

下面一行说我们的盒子应该[绝对定位](https://developer.mozilla.org/en-US/docs/CSS/position)在页面上——也就是说，不管页面上还有什么，总是在一个固定的位置——下面的那个指定我们想要给它的位置：这里，四个像素从页面的左上角。最后一行只是说，无论我们在其中塞入多少内容，框的宽度都不应超过 400 像素。

说到这，当然我们也需要添加一些内容。我们可以只使用纯文本：

```
box.textContent = "Here's some text! This is not HTML, so <3 is not a tag."; 
```

或者我们可以使用 HTML：

```
box.innerHTML = "This <i>is</i> HTML, so &lt;3 needs to be escaped."; 
```

最后，我们需要将框添加到页面以使其显示：

```
document.body.appendChild( box ); 
```

你去吧！页面上的一个框。

* * *

好的，但是我们如何摆脱它呢？好吧，最简单的方法是让它在点击时消失：

```
box.addEventListener( 'click', function () {
    box.parentNode.removeChild( box );
}, true ); 
```

或者，我们可以为该框创建一个单独的关闭按钮，并仅为该框设置点击处理程序：

```
var closeButton = document.createElement( 'div' );
closeButton.className = 'myCloseButton';
closeButton.textContent = 'X';

GM_addStyle( 
    ' .myCloseButton {           ' +
    '    background: #aaa;       ' +
    '    border: 1px solid #777; ' +
    '    padding: 1px;           ' +
    '    margin-left: 8px;       ' +
    '    float: right;           ' +
    '    cursor: pointer;        ' +
    ' } '
);

box.insertBefore( closeButton, box.firstChild );
closeButton.addEventListener( 'click', function () {
    box.parentNode.removeChild( box );
}, true ); 
```

在框中的任何其他内容之前插入关闭按钮，并为其赋予样式`float: right`使其浮动到右上角并使文本围绕它流动。该`cursor: pointer`规则使鼠标光标在按钮上方时看起来像一只手，表明它是可点击的。

您还可以以相同的方式将其他按钮添加到框（或页面上的其他位置）。我给按钮一个类名而不是一个 ID，这样，如果你愿意，你可以给你所有的按钮一个相同的类，它们的样式也一样。

也可以只将按钮的 HTML 代码放入 中`box.innerHTML`，找到结果元素，例如 with`box.getElementById()`并以这种方式为它们添加点击处理程序。

* * *

我说我会提到其他样式元素的方式。一种简单的方法是将 CSS 规则直接写入其`style`属性：

```
box.style.cssText =
    ' background: white;     ' +
    ' border: 2px solid red; ' +
    ' padding: 4px;          ' +
    ' position: absolute;    ' +
    ' top: 8px; left: 8px;   ' +
    ' max-width: 400px;      ' ; 
```

（这样，我们甚至不需要给盒子一个 ID。）也可以一次设置（和读取）样式：

```
box.style.background = 'white';
box.style.border = '2px solid red';
box.style.padding = '4px';
box.style.position = 'absolute';
box.style.top = '8px';
box.style.left = '8px';
box.style.maxWidth = '400px'; 
```

您会注意到有些名称是不同的；例如，`max-width`它不是一个有效的 JavaScript 属性名称，所以它变成`maxWidth`了。相同的规则适用于其他带有连字符的 CSS 属性名称。

不过，我更喜欢它，`GM_addStyle`因为它更灵活。例如，如果你想让你的盒子里的所有链接都变成红色，你可以这样做：

```
GM_addStyle( 
    ' #myAlertBox a {  ' +
    '    color: red;   ' +
    ' } '
); 
```

* * *

顺便说一句，这里有一个巧妙的技巧：如果你替换`position: absolute`为`position: fixed`，那么框将不会随着页面滚动——相反，即使你向下滚动，它也会固定在浏览器的角落。

另一个提示：如果您还没有[Firebug](http://getfirebug.com/)，请安装它。它将使检查页面内容和调试 JavaScript*变得*更加容易。

# asp.net - 在 asp.net 中继器之间显示一条消息

> ID：12354994
> 
> 赞同：1
> 
> 时间：2012-09-10T15:39:45.190
> 
> 标签：asp.net, .net, vb.net, visual-studio-2010, asprepeater

我有一个数据集，它返回一组与某些评论相关的数据。数据集中的一些数据从另一个数据库迁移到我正在使用的数据库中。因此数据集包含公司 A 和公司 B 的数据。

我正在使用转发器来显示数据集，我需要在转发器之间显示一条消息，说明这是 A 公司评论，这是 B 公司评论。我不想重复这个消息。一个简单的例子，

```
Company A reviews
Review 1- I am recommending this company, 10 out of 10
Review 2- I am recommending this company, 9 out of 10

Company B reviews
Review 3- I am recommending this company, 10 out of 10
Review 4- I am recommending this company, 9 out of 10 
```

只是想知道这是否可能使用单个中继器。或者我必须为此使用 2 个不同的中继器并分别显示它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:47:45.860

据我所知，ASP.net 中继器不支持分组。完成您想要的事情的理想解决方案（假设您的数据以典型的父子关系结构化）是使用嵌套转发器。外部转发器将绑定到您拥有的公司列表，然后内部转发器将绑定到每个公司的评论。

以下是 Microsoft 提供的关于典型嵌套中继器场景的示例文章：

[http://support.microsoft.com/kb/306154](http://support.microsoft.com/kb/306154)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T18:27:27.280

您可以通过在转发器内使用额外的渲染来做到这一点，这些渲染在更改时渲染标题。这是一个完整的例子：

```
<asp:Repeater ID="Repeater1" runat="server">
    <ItemTemplate>
        <%#GetHeader(Container.DataItem)%>
        <%#GetData(Container.DataItem)%>
    </ItemTemplate>
</asp:Repeater> 
```

和后面的代码：

```
public int cLastGroup = 1;

protected void Page_Load(object sender, EventArgs e)
{
    Repeater1.DataSource = new List<int> { 2, 3, 4, 5, 6, 7 , 8 };
    Repeater1.DataBind();
}

public string GetHeader(object oItem)
{
    // some how like that I will made yours
    // if(cLastGroup != current) {cLastGroup = current; return string.format()}

    // but now for test I make the 3 and 7 as header
    if (((int)oItem) == 3 || ((int)oItem) == 7)
        return string.Format("<br><br> Header :{0}", (int)oItem);
    else
        return string.Empty;
}

public string GetData(object oItem)
{
    return string.Format("<br> data :{0}", ((int)oItem));
} 
```

并给出这个输出

```
data :2 

Header :3 
data :3 
data :4 
data :5 
data :6 

Header :7 
data :7 
data :8 
```

Ps，为了让它按你喜欢的方式工作，唯一的事情是**你的数据必须按“公司”排序**

也可能有帮助：[在绑定到中继器时希望每页有 10 行](https://stackoverflow.com/questions/12122440/want-10-rows-in-every-page-while-binding-to-a-repeater)

希望这可以帮助您继续前进。

# .net - .net 中的高级授权策略

> ID：12354995
> 
> 赞同：1
> 
> 时间：2012-09-10T15:39:46.173
> 
> 标签：.net, authorization

我正在寻找.net 中高级授权（不是身份验证）的现有解决方案。要求如下：

1.  在应用程序实体上定义自定义应用程序操作。对“会议”实体说“更新”操作。
2.  授予用户“User1”仅对 ID = 1 的实体“会议”执行“更新”操作。
3.  执行“更新”操作时，检查当前用户（“User1”）是否有权访问 ID = 1 的“会议”实体。

所以我需要一些现有的解决方案来授权特定的对象进行操作。据我所知，一些解决方案（AzMan）提供授权能力，但仅适用于作为单元的操作（不适用于具体对象）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T17:51:10.037

您可以使用`PrincipalPermissionsAttribute`. 如果您正在处理 Windows 授权和 AzMan 之类的事情，您可以简单地创建用户并为其分配角色并将他们登录到您的应用程序（或使用当前登录的用户信息）。如果您想使用自定义身份验证，您必须自己处理角色并`Thread.CurrentPrincipal`使用类似`GenericPincipal`. 然后，您可以使用`PrincipalPermissionsAttribute`on 方法来确保只有具有特定角色的主体并执行该方法。例如：

```
[PrincipalPermission(SecurityAction.Demand, Role = @"UserUpdater")]
public void UpdateUserName(string name)
{
//...
} 
```

如果您想自己进行授权，一旦您授权了用户，您可以使用以下内容设置主体：

```
var identity = new GenericIdentity("Bill");
var roles = new[] { @"UserUpdater" };
var principal = new GenericPrincipal(identity, roles);
Thread.CurrentPrincipal = principal; 
```

`SecurityException`当没有该角色的用户调用该方法时，您将不得不处理。假设是其他东西检查角色并且根本不执行该方法......