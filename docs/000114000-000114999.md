# StackOverflow 问答 000114000-000114999

# winapi - Win32 TreeView 中使用 NM_CUSTOMDRAW 的可变高度项目

> ID：114005
> 
> 赞同：1
> 
> 时间：2008-09-22T09:40:17.633
> 
> 标签：winapi, treeview

使用 NM_CUSTOMDRAW 时 WIn32 TreeView 控件中的项目是否可以具有可变高度？

现在，我可以在 NM_CUSTOMDRAW 的 dc 中成功选择可变大小的字体，但项目文本被剪裁了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T09:56:19.123

您需要使用插入项目时指定的 TVITEMEX 结构的 iIntegral 成员设置每个项目的高度。

# c# - 在 C# 中通过反射创建匿名对象

> ID：114010
> 
> 赞同：10
> 
> 时间：2008-09-22T09:42:11.123
> 
> 标签：c#, silverlight, reflection, anonymous-objects

有没有办法在 .NET 3.5 中通过反射在运行时创建 C# 3.0 匿名对象？我想在我的序列化方案中支持它们，所以我需要一种以编程方式操作它们的方法。

*稍后编辑以阐明用例*

一个额外的限制是我将在 Silverlight 应用程序中运行所有这些，因此额外的运行时不是一个选项，并且不确定动态生成代码将如何工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T10:07:36.723

就在这里。从记忆里：

```
public static T create<T>(T t)
{
    return Activator.CreateInstance<T>();
}

object anon = create(existingAnonymousType); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T10:55:33.793

这是另一种方式，似乎更直接。

```
object anon = Activator.CreateInstance(existingObject.GetType()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T09:46:06.183

使用反射获取类型，对类型使用 GetConstructor，对构造函数使用 Invoke。

编辑：感谢 Sklivvz 指出我回答了一个没有被问到的问题；）

实际问题的答案：我发现生成 C# 代码，然后使用 CodeDomProvider（但不是 CodeDOM 本身 - 太糟糕了），然后将其编译下来并从中反映类型是执行“匿名”对象的最简单方法运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T10:02:43.337

您可能想查看 DLR。我自己（还）还没有这样做，但是 DLR（动态语言）的用例听起来很像您正在尝试做的事情。

根据您想要做什么，Castle 框架的动态代理对象也可能很合适。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-22T11:36:30.647

您可以使用 Reflection.Emit 动态生成所需的类，尽管编写代码非常讨厌。

如果您决定采用这条路线，我建议您下载适用于[.NET Reflector的](http://www.red-gate.com/products/reflector/)[Reflection Emit Language Addin](http://www.codeplex.com/reflectoraddins)，因为这可以让您了解如何使用 Reflection.Emit 构建现有类，因此是学习框架这一角落的好方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-22T21:10:22.280

您可能还想查看 FormatterServices 类：[MSDN entry on FormatterServices](https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatterservices)

它包含将创建该类的空实例的 GetSafeUninitializedObject 以及在进行序列化时的其他几个方便的方法。

*回复 Michael 的评论：如果您没有类型 T 的 Type 实例，您始终可以从 typeof(T) 获取它。如果您有一个未知类型的对象，您可以在其上调用 GetType() 以获取 Type 实例。*

# c - 如何在 OpenGL 中获取矩阵堆栈的当前大小？

> ID：114011
> 
> 赞同：10
> 
> 时间：2008-09-22T09:43:14.757
> 
> 标签：c, opengl, graphics, matrix

如何在 OpenGL 中获取矩阵堆栈（GL_MODELVIEW、GL_PROJECTION、GL_TEXTURE）的当前大小？

我想要这个，以便我可以进行一些错误检查，以确保在代码的某些部分我可以检查矩阵堆栈是否保持在原始状态。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-22T09:47:54.323

尝试：

```
 GLint depth;
  glGetIntegerv (GL_MODELVIEW_STACK_DEPTH, &depth); 
```

其他堆栈的枚举是：

```
 GL_MODELVIEW_STACK_DEPTH       
  GL_PROJECTION_STACK_DEPTH      
  GL_TEXTURE_STACK_DEPTH 
```

如果您使用多重纹理，则需要查询多个纹理矩阵堆栈。为此，请通过 设置当前纹理单元`glActiveTexture();`。

# usability - 模态弹出窗口 - 可用性

> ID：114024
> 
> 赞同：0
> 
> 时间：2008-09-22T09:46:23.000
> 
> 标签：usability, modalpopups

在哪些情况下您会使用模态弹出窗口？如果它突然在他的脸上打开，它会打断用户的流程吗？你会避免一般的模式弹出窗口吗？或者什么时候应该小心使用它们？

**编辑：**

更具体地说，这里的情况是这样的：

我在右侧有一个菜单（VisualStudio 风格），当用户想要添加一个元素时，我应该向下展开菜单并让他们从中选择一些东西，然后必须按下 OK 按钮，或者显示一个 Modal 弹出窗口强迫他们选择。

（选择步骤是强制性的。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-22T09:50:07.250

来自[维基百科](http://en.wikipedia.org/wiki/Modal_window)：

模态窗口的常见用途包括：

*   提请注意重要信息。这种用法被批评为无效。

*   阻止应用程序流程，直到输入继续所需的信息，例如登录过程中的密码。

*   在集中式对话框中收集应用程序配置选项。在这种情况下，通常会在关闭对话框时应用更改，并且在进行编辑时禁用对应用程序的访问。

*   警告当前操作的影响是不可逆的。这是模态对话框的常见交互模式，但可用性专家也批评它对其预期用途（防止破坏性操作中的错误）无效，并且存在更好的替代方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-22T09:58:42.410

就个人而言，我认为总是可以避免模态弹出窗口。模态弹出窗口最常见的用途是指示错误，或寻求用户输入以继续。这两个动作都可以“内联”完成，即通过在同一页面本身上创建合适的动作而无需模式弹出窗口。

例如，文本字段输入中的错误可以通过将背景设置为红色来指示，或者通过在字段旁边制作一个小的错误图标及其下方的错误文本来指示。

弹出窗口对用户来说总是很烦人，在我看来可以巧妙地替换而不会丢失任何功能。

**编辑：在您的情况下，一个简单的解决方案是禁用提交按钮，直到用户做出选择。这将确保用户仅在做出选择后点击 OK**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T10:00:24.637

如果您确实走模态弹出路线，请在接受输入之前添加延迟。很少有事情像在某些应用程序中输入并看到暗示弹出某些内容的对话框闪现，接受您当时碰巧按下的任何随机键作为其输入并开始采取一些随机操作一样令人讨厌.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T09:48:41.200

*IMO，除了您绝对确定需要立即引起用户注意*的东西之外，避免使用它们。否则，他们只是无缘无故地中断流程

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T09:50:00.433

我不认为避免模式弹出窗口是有用的。考虑关闭未保存的工作、文件打开对话框等的确认。

我认为当用户忙于其他事情时，您不应该突然显示它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T09:54:23.060

最小化。使用状态栏或一些非面对面的机制来通知用户。

当您想要进行自动化测试时，您应该小心。模态对话框喜欢玩“show stopper”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T09:58:07.043

更具体地说，这里的情况是这样的：

我在右侧有一个菜单（VisualStudio 风格），当用户想要添加一个元素时，我应该向下展开菜单并让他们从中选择一些东西，然后必须按下 OK 按钮，或者显示一个 Modal 弹出窗口强迫他们选择。

（选择步骤是强制性的。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-22T12:45:46.593

模式对话框长期以来一直受到可用性专家的谴责，因为它们对用户工作流程具有破坏性。例如，请参阅 Jef Raskin 的“Humane Interface”一书以讨论无模式接口。

# linq - 动态 LINQ 和动态 Lambda 表达式？

> ID：114029
> 
> 赞同：14
> 
> 时间：2008-09-22T09:47:20.033
> 
> 标签：linq, .net-3.5, dynamic, lambda

动态编写 LINQ 查询和 Lambda 表达式的最佳方式是什么？

我正在考虑最终用户可以设计业务逻辑规则的应用程序，然后必须执行这些规则。

如果这是一个新手问题，我很抱歉，但是从经验中获得最佳实践会很棒。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-22T10:22:56.470

我不能推荐比你阅读 Bart De Smet ( [http://community.bartdesmet.net/blogs/bart/](http://community.bartdesmet.net/blogs/bart/) ) 的帖子更高的建议，他在 Lambda 方面非常出色。

他最近的系列涵盖了动态 Lambda，从[http://community.bartdesmet.net/blogs/bart/archive/2008/08/26/to-bind-or-not-to-bind-dynamic-expression-trees-part -0.aspx](http://community.bartdesmet.net/blogs/bart/archive/2008/08/26/to-bind-or-not-to-bind-dynamic-expression-trees-part-0.aspx)

绝对漂亮的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-22T10:05:22.237

另一种可能性是将脚本运行时集成到您的程序中，以便您的用户可以在 DSL 中编写业务逻辑。[IronPython](http://www.codeplex.com/IronPython)将是候选人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T10:00:25.010

我可以看到两种动态生成 lambda 的方法。您可以尝试 Reflection.Emit 直接生成 IL（.Net 字节码）并将它们作为 lambda 调用，或者您可以使用 System.CodeDom 和 Microsoft.CSharp.CSharpCodeProvider 从更高级别的构造生成代码。您想要做什么取决于您希望用户如何输入这些内容。如果您希望用户编写 C#，那么您可以使用内置的编译器。

动态生成 Linq 应该更容易。您应该能够在运行时将 LINQ 查询生成为表达式树，然后将它们传递给 IQueryable 以执行。我建议您查看有关 IQueryable 的文档以了解更多信息。另一种方法是预先定义几个 linq 查询，然后允许用户将它们链接在一起。这应该是可行的，因为任何 Linq 查询都会返回一个 IEnumerable，可以由下一个 Linq 查询使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T10:12:40.830

可以通过 System.Linq.Expressions 命名空间轻松创建 Lambda 表达式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-22T21:49:28.780

[System.Linq.Expressions](http://msdn.microsoft.com/en-us/library/system.linq.expressions.aspx)是您所需要的。我编写了一个不错的 UI，它允许用户以表达式树的形式动态定义和构建查询。然后，您可以将其交给 Linq2SQL 或您选择的客户端。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-22T10:06:17.197

我不明白你说的“最好的方法”是什么意思。最好提供您想要实现的简单示例。编写动态 LINQ 表达式并不难，但很棘手。

以下是动态 linq 表达式创建的示例：

[如何编写现有的 Linq 表达式](https://stackoverflow.com/questions/53597/how-do-i-compose-existing-linq-expressions)

# c# - 错误 1150 genasm.exe(1) ：错误 最终类型出错。方法“DoParse”

> ID：114031
> 
> 赞同：2
> 
> 时间：2008-09-22T09:47:20.580
> 
> 标签：c#, .net, compact-framework

oOo 一个非常令人兴奋的构建问题。紧凑的框架在构建时偶尔会变得有趣。通常在处理 xmta 文件时，但这是我第一次看到它在这种情况下出错。

我用抽象方法创建了一个抽象基类。把它放在我的一个核心 dll 中。这很好。然后，我在一个“后来”的 .dll 中继承了它。现在我得到这个错误：

> 错误 1150 genasm.exe(1) ：错误 最终类型出错。来自程序集“UICore.WindowsCE.asmmeta，版本=1.0.3187.17348，文化=中性，PublicKeyToken=null”的“MyComanyName.PlatformName.ProductName.Configuration.ConfigurationParser”类型中的方法“DoParse”没有实现。UICore

是的，我已经在这个类中实现了这个方法。我还尝试了完全清理和重建以及关闭并重新启动 VS。

出于兴趣，我还有一个警告，即“对象未设置为对象实例”，这有点不寻常。

**更新：**如果我将方法设为虚拟而不是抽象，问题就会消失。

**更新：**

*   CF 2.0 SP1
*   视觉工作室 2005 SP1
*   该方法不是通用的
*   但是，我确实为该对象的构造函数提供了一个具有通用方法的对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-22T12:44:21.607

这是 Visual Studio 2005/2008 中 genasm 的一个问题，它必须实例化类型才能生成 asmmeta 文件，因此很遗憾，您不能拥有公共抽象类型。

检查这个[MSDN 线程](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=96477&SiteID=1)有类似的问题，（使用泛型）。还讨论了一些解决方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T10:04:38.413

不确定这是否相关，但如果您包含 DesignTimeAttributes.xmta 文件，您会遇到类似的问题。

如果您使用基本表单并为其继承，您将获得该 DesignTimeAttributes。设计器中存在一个错误，这意味着您根本看不到继承的表单，因此这是作为修复的一部分生成的。

您可以通过从项目中排除文件来解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T02:59:17.583

如果我将方法设为虚拟而不是抽象，问题就会消失。

# ruby-on-rails - Rails 中 CGI::Session::CookieStore::TamperedWithCookie 异常的可能原因是什么

> ID：114052
> 
> 赞同：3
> 
> 时间：2008-09-22T09:52:56.043
> 
> 标签：ruby-on-rails, security, cookies

`CGI::Session::CookieStore::TamperedWithCookie`更改应用程序的设置后，我收到了异常`config.action_controller.session.secret`（作为全面部署准备的一部分。

我是否正确假设在测试人员设置了 cookie 时更改秘密是导致此问题的原因，以及可能存在的其他原因（均由于安全攻击和编码问题）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T14:18:40.600

您的异常的原因肯定是在测试人员设置了 cookie 时更改了秘密。cookie 使用秘密进行加密签名，以防止用户篡改其 cookie。例如，他们可能会尝试更改他们存储的用户 ID 以提升他们的权限。

您可以要求测试人员清除他们的 cookie。或者，您可以捕获异常并删除应用程序的 cookie。一些站点更喜欢使用[ActiveRecordSession](http://api.rubyonrails.org/classes/ActionController/Base.html)存储来更好地控制其会话，因此它们会在需要时删除所有会话，但会以性能为代价。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T09:55:06.147

是的，测试人员应该清除他们的 cookie。任何时候无法使用指定的秘密解密 cookie，您都会收到该错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-06T02:35:09.153

我[在 Github 上找到了一个插件，](http://github.com/mhartl/catch_cookie_exception)它会捕获错误并将其写入日志，而不会将错误暴露给用户。我在 Rails 2.1 实例上被这个问题困扰，它成功了。

# vbscript - 异常处理

> ID：114054
> 
> 赞同：1
> 
> 时间：2008-09-22T09:53:56.540
> 
> 标签：vbscript

您能否澄清以下查询？我不确定我尝试编码的方式是否正确。如果我朝着正确/错误的方向前进，请告诉我。

我正在尝试使用测试工具[QuickTest Professional开发自动化框架。](http://en.wikipedia.org/wiki/HP_QuickTest_Professional)

*   有一个 Excel 工作表，根据存储在另一个 Excel 工作表的数组中的 ID（两个 Excel 工作表中都有相同的 ID），从中获取数据以执行执行。
*   我正在尝试通过函数调用来处理特殊情况。该函数将捕获页面发生错误的屏幕截图，然后退出整个循环。
*   我需要一个场景，其中存储在数组中的下一个 ID 继续执行，这需要从函数调用中处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T10:19:00.240

好吧，听起来您已经有了答案..您只需要处理在主循环中读取数据时发生的期望并使其停在那里..

现在，我已经很长时间没有做过 VBScript 了，所以要伪一下：

```
While Not EndOfExcelSheet
    ReadDataFromExcel();
    If errOccurred Then TakeScreenPrint();
    'NOTE: We have caught the error and requested the screen print
    'is taken, but we have NOT bubbled the exception up!
End While 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T10:32:56.820

根据您写的内容很难回答您的问题，但我想到的第一件事是在您的异常处理函数中添加一个布尔参数（我们称之为 ExceptionHandler）。说，如果参数（我们称之为 ExitLoop）为真，你将退出“整个循环”，否则，继续。现在，对于函数的旧调用（没有新参数的调用）更改它可能太乏味了——我不确定 VB 是否支持函数重载。如果是这种情况，您可以将您的 ExceptionHandler 重命名为 ExceptionHandler2，添加新参数 (ExitLoop) 和逻辑，并创建一个（现在是新的）函数 ExceptionHandler，该函数使用其参数调用 ExceptionHandler2，并为 ExitLoop 加上 true。

希望能帮助到你。

# windows - 操作系统崩溃的常见原因

> ID：114081
> 
> 赞同：3
> 
> 时间：2008-09-22T10:02:49.450
> 
> 标签：windows, linux, macos, unix, operating-system

我有兴趣了解：操作系统崩溃（不限于 Windows 崩溃）最常见的技术原因（从操作系统编程的角度来看）是什么？我正在寻找一个不像“打开太多应用程序”这样的答案，而是当打开太多应用程序导致崩溃时具体会发生什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-22T10:07:35.773

在我看来

1.  坏司机
2.  内核错误
3.  硬件故障
4.  资源结束

现代操作系统不会让单纯的应用程序崩溃。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-22T10:07:03.420

导致操作系统崩溃的是错误驱动程序。只有操作系统本身和驱动程序才能损害系统。

对您的建议：

1.  如果应用程序访问与操作系统相同的内存，则操作系统不会出现问题。内存可访问或不可访问。如果应用程序试图访问它不应该的内存，CPU 会生成分段错误。操作系统将其交给应用程序，问题就解决了。（99% 的应用程序会在之后崩溃，但这不是操作系统的错）。

2.  您是在建议较慢的程序更安全。这不是真的。操作系统不需要知道你的程序到底在做什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-22T10:11:41.583

在现代操作系统中，应用程序代码和操作系统代码在不同的地址空间中运行。应用程序代码不能使操作系统崩溃。看这里：

[http://en.wikipedia.org/wiki/Ring_(computer_security)](http://en.wikipedia.org/wiki/Ring_(computer_security))

最常见的崩溃阅读是作为操作系统一部分的代码与作为操作系统一部分的其他代码相互干扰。一个常见的原因是存在于操作系统地址空间中的设备驱动程序编写不当。

不太常见的是，崩溃是由硬件故障引起的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-28T12:03:48.040

由于以下两个主要原因之一，可能会发生任何**操作系统崩溃：**

1.  **硬件问题**。
2.  **软件问题**。

# **硬件问题：**

1.  **电源相关问题**：系统电源功能不正常会导致系统立即关闭。

2.  **RAM 过热：RAM**过热可能会导致其中的数据损坏。这可能会导致必须重置的明确崩溃。

3.  **不正确的超频**：导致过热。某些硬件组件对热敏感。当自动发生过热时，系统会关闭。

4.  **硬盘中的坏扇区**：硬盘分为存储数据的扇区。一些部门成为坏部门。 **原因**： **一**。长时间使用 - 多次写入和读取。 **乙**。制造缺陷。如果硬盘中存储重要系统信息的扇区变成坏扇区，则很难加载这些文件，从而导致崩溃。

5.  **RAM 问题**： 原因：无法检索数据。这非常重要，因为这会导致**致命异常错误**

**主要误解**：系统中的应用程序崩溃并不总是导致系统崩溃。通常，操作系统“什么都没有”发生。它只是向您发送报告，说明某某应用程序已崩溃。

# 软件问题：

1.  **损坏的注册表**：在启动任何应用程序之前，操作系统会查看其注册表。Registry 是一个小型数据库，其中存储了有关内核、驱动程序和有关应用程序的所有信息。由于应用程序卸载不当、注册表编辑不慎、安装的应用程序过多等 [原因，注册表可能会损坏。注册表损坏的更多原因](http://www.streetdirectory.com/travel_guide/136313/registry_problems/corrupt_windows_registry___causes_signs_and_the_remedy.html)。这会导致常规应用程序拒绝启动，从而导致显示**蓝屏死机**。
2.  **不正确的驱动程序**：为了使用额外的硬件，我们需要驱动程序，通常是从互联网上下载的。这些驱动程序可能包含错误。这些错误会导致操作系统崩溃。现代操作系统发布时带有“安全模式启动”选项。安全模式引导仅加载重要的驱动程序（最少）而不是全部。安全模式引导用于诊断目的，以查找有错误的驱动程序。
3.  **病毒和木马**：操作系统崩溃的常见原因。病毒和特洛伊木马会破坏系统文件，“吃掉”内存，当程序停止时不允许操作系统检索它，更改管理设置，频繁重启而没有任何迹象等
4.  **Thrashing**：当两个正在运行的程序需要控制特定资源时，就会发生死锁。有时在死锁期间，操作系统会尝试在两个程序之间来回切换。这最终会导致抖动，其中硬盘驱动器通过在系统内存和虚拟内存之间移动信息过度导致系统崩溃而过度工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T10:04:53.517

不，你很遥远。通常，应用程序无法执行任何可能导致操作系统崩溃的操作。操作系统崩溃通常是由错误的设备驱动程序和硬件故障引起的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T10:07:27.380

试图访问锁定区域的两个不同来源是一个问题。让所有互斥锁、监视器和锁 100% 工作并非易事。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T10:25:38.397

如果我们以 Vista 为例 - 驱动程序... NVidia 特别是[http://arstechnica.com/news.ars/post/20080325-vista-capable-lawsuit-paints-picture-of-buggy-nvidia-drivers.html](http://arstechnica.com/news.ars/post/20080325-vista-capable-lawsuit-paints-picture-of-buggy-nvidia-drivers.html) . 决定内存分配的是操作系统，而不是应用程序。嗯，这就是理论。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-24T12:06:09.630

操作系统崩溃也可能由于硬盘中的某些扇区崩溃而导致，这是因为我所有的 pc 操作系统都存在于硬盘的主驱动器中。

# c++ - 具有低冲突率的 32 位整数的快速字符串散列算法

> ID：114085
> 
> 赞同：69
> 
> 时间：2008-09-22T10:03:50.947
> 
> 标签：c++, algorithm, string, hash

我有很多不相关的命名事物，我想对其进行快速搜索。“土豚”总是到处都是“土豚”，因此散列字符串并重用整数可以很好地加快比较速度。整个名称集是未知的（并且随着时间的推移而变化）。什么是快速字符串散列算法，它将生成小（32 或 16）位值并具有低冲突率？

我希望看到特定于 C/C++ 的优化实现。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-09-22T10:17:20.290

[Murmur Hash](http://murmurhash.googlepages.com/)很不错。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-09-22T10:08:32.340

[FNV 变体](http://isthe.com/chongo/tech/comp/fnv/)之一应满足您的要求。它们速度很快，并且产生相当均匀分布的输出。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-09-22T10:13:21.017

对于固定的字符串集，请使用 gperf。

如果您的字符串集发生更改，您必须选择一个哈希函数。这个话题之前已经讨论过：

[使用 hash_map 时在 stl 字符串上使用的最佳散列算法是什么？](https://stackoverflow.com/questions/98153/)

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-12-16T22:25:09.100

在[everlyconfuzzled.com](http://eternallyconfuzzled.com/)上也有[一篇不错的文章](http://eternallyconfuzzled.com/tuts/algorithms/jsw_tut_hashing.aspx)。

Jenkins 的字符串一次一次哈希应该是这样的：

```
#include <stdint.h>

uint32_t hash_string(const char * s)
{
    uint32_t hash = 0;

    for(; *s; ++s)
    {
        hash += *s;
        hash += (hash << 10);
        hash ^= (hash >> 6);
    }

    hash += (hash << 3);
    hash ^= (hash >> 11);
    hash += (hash << 15);

    return hash;
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-22T11:02:46.780

根据您的用例，另一个可能更好的解决方案是**[interned strings](http://en.wikipedia.org/wiki/String_intern_pool)**。这就是符号的工作方式，例如在 Lisp 中。

实习字符串是一个字符串对象，其值是实际字符串字节的地址。因此，您通过签入全局表来创建一个内部字符串对象：如果该字符串在其中，则将内部字符串初始化为该字符串的地址。如果没有，则插入它，然后初始化您的实习字符串。

这意味着从同一字符串构建的两个内部字符串将具有相同的值，即一个地址。因此，如果 N 是系统中的留存字符串数，则特征为：

*   建设缓慢（需要查找和可能的内存分配）
*   在并发线程的情况下需要全局数据和同步
*   比较是 O(1)，因为您正在比较地址，而不是实际的字符串字节（这意味着排序效果很好，但它不会是字母排序）。

干杯，

卡尔

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-09-26T12:22:05.477

一个好的主题永远不会迟到，我相信人们会对我的发现感兴趣。

我需要一个哈希函数，在阅读了这篇文章并对此处给出的链接进行了一些研究之后，我想出了 Daniel J Bernstein 算法的这种变体，我曾经做过一个有趣的测试：

 `````
unsigned long djb_hashl(const char *clave)
{
    unsigned long c,i,h;

    for(i=h=0;clave[i];i++)
    {
        c = toupper(clave[i]);
        h = ((h << 5) + h) ^ c;
    }
    return h;
} 
````  `这种变体忽略大小写对字符串进行哈希处理，这适合我对用户登录凭据进行哈希处理的需要。“clave”在西班牙语中是“key”。我为西班牙语感到抱歉，但它是我的母语，程序是写在上面的。

好吧，我编写了一个程序，它将生成从“test_aaaa”到“test_zzzz”的用户名，并且-为了使字符串更长-我在这个列表中添加了一个随机域：“cloud-nueve.com”、“yahoo.com” '、'gmail.com' 和 'hotmail.com'。因此，他们每个人看起来像：

```
test_aaaa@cloud-nueve.com, test_aaab@yahoo.com,
test_aaac@gmail.com、test_aaad@hotmail.com 等等。

```

这是测试的输出 -'Colision entre XXX y XXX' 表示'碰撞 XXX 和 XXX'。“palabras”的意思是“单词”，而“Total”在两种语言中都是一样的——。

```
    布斯坎多·科利西内斯...
    碰撞进入 'test_phiz@hotmail.com' y 'test_juxg@cloud-nueve.com' (1DB903B7)
    冲突进入 'test_rfhh@hotmail.com' y 'test_fpgo@yahoo.com' (2F5BC088)
    碰撞进入 'test_wxuj@hotmail.com' y 'test_pugy@cloud-nueve.com' (51FD09CC)
    碰撞进入 'test_sctb@gmail.com' y 'test_iohw@cloud-nueve.com' (52F5480E)
    碰撞进入 'test_wpgu@cloud-nueve.com' y 'test_seik@yahoo.com' (74FF72E2)
    冲突进入 'test_rfll@hotmail.com' y 'test_btgo@yahoo.com' (7FD70008)
    碰撞进入 'test_wcho@cloud-nueve.com' y 'test_scfz@gmail.com' (9BD351C4)
    碰撞进入 'test_swky@cloud-nueve.com' y 'test_fqpn@gmail.com' (A86953E1)
    冲突进入 'test_rftd@hotmail.com' y 'test_jlgo@yahoo.com' (BA6B0718)
    冲突进入 'test_rfpp@hotmail.com' y 'test_nxgo@yahoo.com' (D0523F88)
    碰撞进入 'test_zlgo@yahoo.com' y 'test_rfdd@hotmail.com' (DEE08108)
    总de Colisones：11
    总 de Palabras : 456976

```

这还不错，456,976 次中有 11 次冲突（当然使用完整的 32 位作为表长度）。

使用 5 个字符运行程序，即从“test_aaaaa”到“test_zzzzz”，实际上会耗尽构建表的内存。下面是输出。'No hay memoria para insertar XXXX (insertadas XXX)' 的意思是'没有内存可以插入 XXX (XXX 插入)'。基本上 malloc() 在那一点上失败了。

```
    没有干草记忆 para insertar 'test_epjcv' (insertadas 2097701)。

    Buscando Colisiones...

    ...451 'colision' strings...

    Total de Colisiones: 451
    Total de Palabras  : 2097701

```

Which means just 451 collisions on 2,097,701 strings. Note that in none of the occasions, there were more than 2 collisions per code. Which I confirm it is a great hash for me, as what I need is to convert the login ID to a 40 bit unique id for indexing. So I use this to convert the login credentials to a 32 bit hash and use the extra 8 bits to handle up to 255 collisions per code, which lookign at the test results would be almost impossible to generate.

Hope this is useful to someone.

**EDIT:**

Like the test box is AIX, I run it using LDR_CNTRL=MAXDATA=0x20000000 to give it more memory and it run longer, the results are here:

Buscando Colisiones... Total de Colisiones: 2908 Total de Palabras : 5366384

That is 2908 after 5,366,384 tries!!

**VERY IMPORTANT**: Compiling the program with -maix64 (so unsigned long is 64 bits), the number of collisions is 0 for all cases!!!

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-24T04:13:00.273

[Hsieh](http://www.azillionmonkeys.com/qed/hash.html)散列函数非常好，并且有一些基准/比较，作为 C 中的一般散列函数。根据您想要的（这并不完全明显），您可能想要考虑类似[cdb](http://en.wikipedia.org/wiki/Cdb_(software))的东西。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-16T21:11:27.517

为什么不直接使用[Boost 库？](http://www.boost.org/doc/libs/1_37_0/doc/html/hash/tutorial.html)它们的散列函数使用简单，Boost 中的大部分内容很快就会成为 C++ 标准的一部分。其中一些已经是。

Boost hash 就像

```
#include <boost/functional/hash.hpp>

int main()
{
    boost::hash<std::string> string_hash;

    std::size_t h = string_hash("Hash me");
} 
```

您可以在[boost.org上找到提升](http://www.boost.org)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-16T21:30:58.723

[Bob Jenkins 有许多可用的哈希函数](http://burtleburtle.net/bob/hash/index.html)，所有这些函数都很快并且碰撞率低。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-22T10:06:20.597

看看 GNU [gperf](http://www.gnu.org/software/gperf/)。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-09T21:29:21.210

[在上一个问题](https://stackoverflow.com/questions/251346/best-hashing-algorithm-in-terms-of-hash-collisions-and-performance)中有一些很好的讨论

以及如何选择散列函数的一个很好的概述，以及关于[这里几个常见函数分布的统计信息](http://bretmulvey.com/hash/)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-16T21:34:14.567

您可以使用 Reflector 查看 .NET 在 String.GetHashCode() 方法上的使用情况。

我会冒险猜测微软花了相当多的时间来优化这个。他们也打印在所有 MSDN 文档中，因此它随时可能发生变化。很明显，这是在他们的“性能调整雷达”上；-)

我想移植到 C++ 也很简单。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-04-17T03:33:27.270

Described here is a simple way of implementing it yourself: [http://www.devcodenote.com/2015/04/collision-free-string-hashing.html](http://www.devcodenote.com/2015/04/collision-free-string-hashing.html)

A snippet from the post:

if say we have a character set of capital English letters, then the length of the character set is 26 where A could be represented by the number 0, B by the number 1, C by the number 2 and so on till Z by the number 25\. Now, whenever we want to map a string of this character set to a unique number , we perform the same conversion as we did in case of the binary format

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2008-09-22T10:06:47.397

[CRC-32](http://en.wikipedia.org/wiki/Cyclic_redundancy_check)。谷歌上有大约一万亿个链接。

# build-process - 在自动构建中生成文档

> ID：114095
> 
> 赞同：8
> 
> 时间：2008-09-22T10:06:44.963
> 
> 标签：build-process, build-automation, documentation

有没有办法在自动构建期间生成项目文档？

我想要一组带有用户手册的源文件（HTML？），并从中生成：

*   PDF文件
*   CHM 帮助
*   HTML 版本的帮助

三种格式的内容基本相同。

目前我正在使用 msbuild 和 CCNET，但如果需要，我可以更改它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-22T10:11:43.173

是的！

*   使用[SandCastle](http://www.codeplex.com/SHFB)构建 API 的 CHM/HTM 文档。
*   使用[DocBook](http://www.docbook.org/) + [FOP](http://xmlgraphics.apache.org/fop/)和其他工具生成其他类型的 PDF、RTF、HTML 等文档...

它们可以通过[NAnt](http://nant.sourceforge.net/)轻松地与 CruiseControl.NET 集成。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-22T10:16:00.713

你试过[doxygen](http://www.doxygen.nl/index.html)吗？它也可用于 Windows，并且应该很容易将其集成到任何构建脚本/过程中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-22T10:12:51.610

Apache Forrest 项目可能会以某种方式为您提供您想要的东西。

通常最好用 XML 编写文档。从那里你应该能够生成你需要的任何东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T10:49:24.457

帮助和手册可以从单一来源生成高质量的 PDF、HTML 和 CHM（以及其他格式）。它还有一个命令行界面。我有第 4 版，我非常喜欢它。作为构建 .bat/.csh 文件的一部分，我使用条件语句（如 #ifdefs）以各种格式生成我的文档的 Windows 和 Mac 版本。版本 5 现在可用。

[http://www.ec-software.com/](http://www.ec-software.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T14:44:03.487

如果您也希望记录您的 api，并且您正在使用 msbuild，那么请考虑使用[DocProject](http://www.codeplex.com/DocProject)来控制[SandCastle](http://www.codeplex.com/SHFB)构建。（这些工具不适用于最终用户文档...）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T14:47:17.820

我有使用 Doxygen 的经验。它既好又简单，但它让您想要过度注释代码以简化以后的文档工作。

# asp.net-mvc - ASP.NET MVC Preview 5 - Html.Image 助手已移动命名空间

> ID：114108
> 
> 赞同：5
> 
> 时间：2008-09-22T10:10:24.597
> 
> 标签：asp.net-mvc, web-config, html-helper

`Html.Image`我们刚刚将 ASP.NET 从 Preview 3 更新到 Preview 5，并且在我们的 aspx 页面中遇到了 HtmlHelper 的问题。

似乎`Html.Image`已经从`System.Web.Mvc`into移动了`Microsoft.Web.Mvc`，我们现在发现访问帮助器的唯一方法是向每个使用它的 .aspx 页面添加一个 import 语句。所有其他帮助程序都可以`using System.Web.Mvc;`在视图母版页的 C# 代码隐藏中访问，但是这个似乎需要`<@Import Namespace="Microsoft.Web.Mvc">`在每个 .aspx 页面中。

有谁知道解决这个问题的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-22T10:21:30.637

您可以在 Web 配置中将命名空间添加到 System.Web 中的页面。

```
<pages validateRequest="false">
    <namespaces>
        <add namespace="Microsoft.Web.Mvc"/>        
    </namespaces>
</pages> 
```

# python - 部署 Django：你是怎么做的？

> ID：114112
> 
> 赞同：11
> 
> 时间：2008-09-22T10:11:48.743
> 
> 标签：python, django-deployment

我已经尝试过像[这样的](http://docs.djangoproject.com/en/dev/howto/deployment/modpython/)指南，但它对我不起作用。

**所以我的问题是：**什么是部署 Django 的好指南，以及如何部署 Django。

我一直听说 capastrano 非常好用，但我不知道如何使用它或它的作用（除了部署代码的自动化），或者即使我想要/是否需要使用它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-22T11:06:01.217

`mod_wsgi`结合`virtualenv`所有依赖项、对 virtualenv 的反复检查和`fabric`检查服务器上更改的配方。

我写了一篇关于我常用工作流程的文章：[部署 Python Web 应用程序](http://lucumr.pocoo.org/2008/7/17/deploying-python-web-applications/)。希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T19:48:45.050

在我之前的工作中，我们有一个真正的天才人物负责部署，他将应用程序（Python、SQL、Perl 和 Java 代码）部署为为 Ubuntu 构建的一组 deb 文件。不幸的是，我现在没有这样的支持。我们正在手动将应用程序部署到 virtualenv-ed 环境中，并为 FastCGI 使用单独的 nginx 配置。我们使用[paver](http://www.blueskyonmars.com/projects/paver/)部署到远程服务器。这很痛苦，但它有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T10:55:39.853

我在[mod_wsgi上取得了成功](http://code.google.com/p/modwsgi/wiki/IntegrationWithDjango)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T10:17:53.017

这看起来是一个不错的起点：[http ://www.unessa.net/en/hoyci/2007/06/using-capistrano-deploy-django-apps/](http://www.unessa.net/en/hoyci/2007/06/using-capistrano-deploy-django-apps/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-09T22:44:18.440

我使用 mod_python，并且在 git 存储库中的每个站点都包含以下子目录：

*   我的网站
*   模板
*   媒体

我有`mysite/settings.py`，`.gitignore`并且像这样工作：

1.  在我的本地机器上进行开发
2.  在网络服务器上创建远程存储库
3.  将我的更改推送到网络服务器存储库
4.  设置 apache vhost 配置文件，调整实时服务器 settings.py
5.  在 webserver repo 上运行`git checkout && git reset --hard && sudo /etc/init.d/apache2 restart`以获取其工作副本的最新版本并重新启动 apache
6.  每当更改请求出现时重复步骤 1、3 和 5

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-22T10:20:42.420

最简单的方法是使用[http://djangofriendly.com/hosts/](http://djangofriendly.com/hosts/)上的一个站点，该站点将为您提供托管和设置，但即使您想自己动手，它也会让您看到其他网站正在使用什么设置。

# javascript - 为电子邮件编码用户输入

> ID：114148
> 
> 赞同：1
> 
> 时间：2008-09-22T10:25:31.207
> 
> 标签：javascript, email

在网站上，如果我有一个用户可以输入一些文本的表单，然后是一个显示用户输入内容的页面。我知道对用户输入的值进行 html 编码以防止脚本攻击。如果表单正在发送电子邮件地址，我想我也会这样做，但是电子邮件是否有任何特殊情况，电子邮件客户端会运行注入电子邮件中的任何脚本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T13:16:07.410

虽然在发送之前从文档中去除标签仍然是一个好主意，`<script>`但我认为威胁很小。我相信您很难找到在呈现电子邮件之前不剥离脚本的电子邮件客户端（仍在获得支持）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T10:28:45.613

我相信通过将电子邮件正文标记为 text/plain 可以避免 javascript 和/或 html 攻击（但我不相信 Outlook 会遵循标题的建议）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T10:57:37.027

您应该使用一个 SMTP 库来承担由重复或丢失的转义引起的任何负担（和潜在的错误）。然后，仅使用纯文本邮件（文本/纯文本）。

为了避免错误邮件客户端的安全问题，您还可以发送几乎空的邮件，并将文本作为附件（文件扩展名“.txt”，内容类型“text/plain”）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T14:09:14.677

在将发布的内容分配给电子邮件的 HTML 正文之前，您绝对应该进行 HTML 编码。您的代码应该已经拒绝诸如“<script>”之类的无效内容，不仅在电子邮件的情况下，而且在所有情况下。

您无需担心其他问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T14:42:14.817

我强烈建议使用现有的、经过测试的解决方案来发送邮件。例如，如果您将用户输入传递给 PHP mail() 函数——即使使用 HTML 编码——攻击者也有可能制作一个实际包含标题的“正文”来创建多部分消息。

# c# - C# 中的“常量正确性”

> ID：114149
> 
> 赞同：82
> 
> 时间：2008-09-22T10:25:31.487
> 
> 标签：c#, theory, const-correctness

const 正确性的重点是能够提供用户无法更改或删除的实例视图。编译器通过指出何时从 const 函数中破坏 const 或尝试使用 const 对象的非 const 函数来支持这一点。因此，在不复制 const 方法的情况下，有没有可以在 C# 中使用的具有相同目的的方法？

我知道不变性，但这并没有真正延续到容器对象的名称中，只是一个例子。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-09-22T13:19:36.140

我也遇到过很多次这个问题，最终使用了接口。

我认为放弃 C# 是任何形式，甚至是 C++ 的演变的想法很重要。它们是两种不同的语言，具有几乎相同的语法。

我通常通过定义一个类的只读视图来表达 C# 中的“常量正确性”：

```
public interface IReadOnlyCustomer
{
    String Name { get; }
    int Age { get; }
}

public class Customer : IReadOnlyCustomer
{
    private string m_name;
    private int m_age;

    public string Name
    {
        get { return m_name; }
        set { m_name = value; }
    }

    public int Age
    {
        get { return m_age; }
        set { m_age = value; }
    }
} 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-09-22T10:45:44.840

为了获得 const-craziness（或函数式编程术语中的纯粹性）的好处，您需要以一种不可变的方式设计您的类，就像 c# 的 String 类一样。

这种方法比仅仅将对象标记为只读要好得多，因为使用不可变类，您可以在多任务环境中轻松传递数据。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2008-09-23T13:40:33.990

我只是想提醒您，许多 System.Collections.Generics 容器都有一个 AsReadOnly 方法，该方法将为您返回一个不可变的集合。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-22T10:30:01.367

C# 没有这样的功能。您可以按值或按引用传递参数。*[除非您指定ref](http://msdn.microsoft.com/en-us/library/14akc2c7(VS.71).aspx)*修饰符，否则引用本身是不可变的。但是引用的数据不是一成不变的。所以如果你想避免副作用，你需要小心。

MSDN：

[传递参数](http://msdn.microsoft.com/en-us/library/0f66670z(VS.71).aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-22T17:33:42.237

接口就是答案，实际上比 C++ 中的“const”更强大。const 是针对“const”被定义为“不设置成员或调用设置成员的东西”的问题的一刀切解决方案。在许多情况下，这是 const-ness 的一个很好的简写，但不是所有情况。例如，考虑一个基于某些成员计算值但也缓存结果的函数。在 C++ 中，这被认为是非常量，尽管从用户的角度来看，它本质上是 const。

接口使您可以更灵活地定义要从类中提供的特定功能子集。想要常量吗？只需提供一个没有变异方法的接口。想要允许设置一些东西而不是其他东西？提供一个只包含这些方法的接口。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-25T11:26:05.373

同意其他人的观点，即使用您在构造函数中初始化的只读字段来创建不可变对象。

```
 public class Customer
    {
    private readonly string m_name;
    private readonly int m_age;

    public Customer(string name, int age)
    {
        m_name = name;
        m_age = age;
    }

    public string Name
    {
        get { return m_name; }
    }

    public int Age
    {
        get { return m_age; }
    }
  } 
```

或者，您还可以在属性上添加访问范围，即公共获取和保护集？

```
 public class Customer
    {
    private string m_name;
    private int m_age;

    protected Customer() 
    {}

    public Customer(string name, int age)
    {
        m_name = name;
        m_age = age;
    }

    public string Name
    {
        get { return m_name; }
        protected set { m_name = value; }
    }

    public int Age
    {
        get { return m_age; }
        protected set { m_age = value; }
    }
  } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-22T12:32:18.483

*   **const**关键字可用于编译时常量，例如原始类型和字符串
*   **readonly**关键字可用于运行时常量，例如引用类型

**readonly**的问题在于它只允许引用（指针）保持不变。引用（指向）的事物仍然可以修改。这是棘手的部分，但没有办法绕过它。实现常量对象意味着使它们不公开任何可变方法或属性，但这很尴尬。

另请参阅[有效的 C#：50 种改进 C# 的特定方法](http://www.amazon.co.uk/gp/product/toc/0321245660)（第 2 项 - 首选只读而不是 const。）

# wpf - XAML 定义如何变成对象实例？

> ID：114154
> 
> 赞同：4
> 
> 时间：2008-09-22T10:29:04.317
> 
> 标签：wpf, xaml

XAML 允许您使用包含大括号的字符串来指定属性值。下面是一个创建*Binding*实例并将其分配给*TextBox*元素的*Text*属性的示例。

 *```
<TextBox Text="{Binding ElementName=Foo, Path=Bar}"/> 
```

我想扩展 XAML，以便开发人员可以将其输入为有效...

```
<TextBox Text="{MyCustomObject Field1=Foo, Field2=Bar}"/> 
```

这将创建我的类的一个实例并根据需要设置 Field1/Field2 属性。这可能吗？如果是这样，你怎么做？

如果这是可能的，我有一个后续问题。我可以获取一个字符串*“{Binding ElementName=Foo, Path=Bar}”*并要求框架处理它并返回它指定的*绑定*实例吗？这必须在某个地方已经完成才能使上述 XAML 工作，因此必须有一种方法来要求处理相同的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-22T10:43:32.787

该类`Binding`是一个[标记扩展](http://msdn.microsoft.com/en-us/library/ms747254.aspx)。您可以通过派生来编写自己的`System.Windows.Markup.MarkupExtension`.

`ElementName`并且`Path`只是对象上的`Binding`属性。

至于后续，您可以`Binding`通过实例化`Binding`对象来创建新的代码。我不知道处理字符串的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T10:36:49.573

看看标记扩展 [http://blogs.msdn.com/wpfsdk/archive/2007/03/22/blogpost-text-creatingasimplecustommarkupextension.aspx](http://blogs.msdn.com/wpfsdk/archive/2007/03/22/blogpost-text-creatingasimplecustommarkupextension.aspx)

# sql - CASCADE Delete 是否作为事务执行？

> ID：114163
> 
> 赞同：12
> 
> 时间：2008-09-22T10:33:11.517
> 
> 标签：sql, cascade

我想对数据库中的某些表执行级联删除，但我对删除某些内容失败时会发生什么感兴趣。一切都会回滚吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-22T10:35:59.497

一般来说¹，是的，级联删除是在与原始删除相同的事务（或子事务）中完成的。不过，您应该阅读 SQL 服务器的文档。

¹ 例外情况是，如果您使用的数据库不支持事务，例如带有 MyISAM 表的 MySQL。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-22T10:45:11.970

级联删除确实是原子的，如果没有该属性，它们将毫无用处。它在文档中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T13:13:06.467

值得指出的是，*任何*级联事件都应该是原子的（即在事务中）。但是，正如 Joel Coehoorn 指出的那样，请检查数据库的文档。

# installation - 如何实现 WiX 安装程序升级？

> ID：114165
> 
> 赞同：243
> 
> 时间：2008-09-22T10:34:12.450
> 
> 标签：installation, wix, windows-installer

在工作中，我们使用[WiX](http://en.wikipedia.org/wiki/WiX)来构建安装包。我们希望产品 X 的安装会导致在该机器上卸载该产品的先前版本。

我在 Internet 上的几个地方阅读了有关重大升级的信息，但无法使其正常工作。任何人都可以指定将卸载以前版本功能添加到 WiX 需要采取的确切步骤吗？

* * *

## 回答 #1

> 赞同：225
> 
> 时间：2008-09-22T13:03:32.667

最后我找到了一个解决方案 - 我在这里为可能有同样问题的其他人（你们 5 个人）发布它：

*   将产品 ID 更改为 *
*   在产品下添加以下内容：

    ```
    <Property Id="PREVIOUSVERSIONSINSTALLED" Secure="yes" />
    <Upgrade Id="YOUR_GUID">  
       <UpgradeVersion
          Minimum="1.0.0.0" Maximum="99.0.0.0"
          Property="PREVIOUSVERSIONSINSTALLED"
          IncludeMinimum="yes" IncludeMaximum="no" />
    </Upgrade> 
    ```

*   在 InstallExecuteSequence 添加：

    ```
    <RemoveExistingProducts Before="InstallInitialize" /> 
    ```

从现在开始，每当我安装产品时，它都会删除以前安装的版本。

**注意：**将升级 ID 替换为您自己的 GUID

* * *

## 回答 #2

> 赞同：210
> 
> 时间：2010-08-26T13:57:27.633

在最新版本中（从 3.5.1315.0 测试版开始），您可以使用[MajorUpgrade 元素](http://wixtoolset.org/documentation/manual/v3/xsd/wix/majorupgrade.html "重大升级")而不是使用您自己的元素。

例如，我们使用此代码进行自动升级。它可以防止降级，提供本地化错误消息，还可以防止升级已经存在的相同版本（即仅升级较低版本）：

```
<MajorUpgrade
    AllowDowngrades="no" DowngradeErrorMessage="!(loc.NewerVersionInstalled)"
    AllowSameVersionUpgrades="no"
    /> 
```

* * *

## 回答 #3

> 赞同：89
> 
> 时间：2009-04-07T04:05:23.947

以下是我用于重大升级的语法：

```
<Product Id="*" UpgradeCode="PUT-GUID-HERE" Version="$(var.ProductVersion)">
 <Upgrade Id="PUT-GUID-HERE">
    <UpgradeVersion OnlyDetect="yes" Minimum="$(var.ProductVersion)" Property="NEWERVERSIONDETECTED" IncludeMinimum="no" />
    <UpgradeVersion OnlyDetect="no" Maximum="$(var.ProductVersion)" Property="OLDERVERSIONBEINGUPGRADED" IncludeMaximum="no" />
</Upgrade>

<InstallExecuteSequence>
    <RemoveExistingProducts After="InstallInitialize" />
</InstallExecuteSequence> 
```

正如@Brian Gillespie 所指出的，还有其他地方可以根据所需的优化安排 RemoveExistingProducts 。请注意 PUT-GUID-HERE 必须相同。

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2008-10-18T05:56:37.167

Product 元素中的 Upgrade 元素与适当的操作调度相结合，将执行您所追求的卸载。请务必列出您要删除的所有产品的升级代码。

```
<Property Id="PREVIOUSVERSIONSINSTALLED" Secure="yes" />
<Upgrade Id="00000000-0000-0000-0000-000000000000">
  <UpgradeVersion Minimum="1.0.0.0" Maximum="1.0.5.0" Property="PREVIOUSVERSIONSINSTALLED" IncludeMinimum="yes" IncludeMaximum="no" />
</Upgrade> 
```

请注意，如果您对构建非常小心，您可以防止人们意外地安装旧版本的产品而不是新版本的产品。这就是最大字段的用途。当我们构建安装程序时，我们将 UpgradeVersion Maximum 设置为正在构建的版本，但 IncludeMaximum="no" 以防止出现这种情况。

您可以选择有关 RemoveExistingProducts 的计划。我更喜欢在 InstallFinalize 之后安排它（而不是像其他人推荐的那样在 InstallInitialize 之后）：

```
<InstallExecuteSequence>
  <RemoveExistingProducts After="InstallFinalize"></RemoveExistingProducts>
</InstallExecuteSequence> 
```

这会在复制新文件和注册表项之前一直安装先前版本的产品。这让我可以将数据从旧版本迁移到新版本（例如，您已将用户首选项的存储从注册表切换到 XML 文件，但您想保持礼貌并迁移他们的设置）。此迁移在 InstallFinalize 之前的延迟自定义操作中完成。

另一个好处是效率：如果有未更改的文件，当您在 InstallFinalize 之后安排时，Windows Installer 不会再次复制它们。如果在 InstallInitialize 之后调度，则先完全删除以前的版本，然后再安装新版本。这会导致不必要的文件删除和重新复制。

有关其他计划选项，请参阅 MSDN 中的 RemoveExistingProducts 帮助主题。本周，链接为：http: [//msdn.microsoft.com/en-us/library/aa371197.aspx](http://msdn.microsoft.com/en-us/library/aa371197.aspx)

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-09-22T13:14:56.633

你最好在[WiX 用户邮件列表](https://wixtoolset.org/documentation/mailinglist/)上问这个问题。

最好在充分了解 Windows Installer 正在做什么的情况下使用 WiX。您可以考虑获取“ [Windows Installer 权威指南](https://rads.stackoverflow.com/amzn/click/1590592972)”。

删除现有产品的操作是[RemoveExistingProducts 操作](https://docs.microsoft.com/en-us/windows/desktop/Msi/removeexistingproducts-action)。因为它所做的事情的后果取决于它的计划位置 - 即故障是否导致旧产品被重新安装，以及是否再次复制未更改的文件 - 您必须自己安排它。

`RemoveExistingProducts`处理`<Upgrade>`当前安装中的元素，将`@Id`属性与系统上所有已安装产品的`UpgradeCode`（在元素中指定）相匹配。`<Product>`定义了`UpgradeCode`一系列相关产品。任何具有此 UpgradeCode 的产品，其版本在指定范围内，以及该`UpgradeVersion/@OnlyDetect`属性所在`no`（或被省略）的位置，都将被删除。

`RemoveExistingProducts`提及设置`UPGRADINGPRODUCTCODE`属性的文档。这意味着*要删除的产品*的卸载过程会收到该属性，该属性的值是`Product/@Id`要安装的产品的值。

如果您的原始安装不包含`UpgradeCode`，您将无法使用此功能。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-09-24T15:56:01.177

我使用这个网站来帮助我了解有关 WiX 升级的基础知识：

[http://wix.tramontana.co.hu/tutorial/upgrades-and-modularization](http://wix.tramontana.co.hu/tutorial/upgrades-and-modularization)

之后我创建了一个示例安装程序（安装了一个测试文件），然后创建了升级安装程序（安装了 2 个示例测试文件）。这将使您对该机制的工作原理有一个基本的了解。

正如迈克在 Apress 的书“Windows 安装程序权威指南”中所说，它将帮助您理解，但它不是使用 WiX 编写的。

另一个很有帮助的网站是这个：

[http://www.wixwiki.com/index.php?title=Main_Page](http://web.archive.org/web/20110209022712/http://wixwiki.com/index.php?title=Main_Page)

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2011-12-16T12:19:44.153

我阅读了[WiX](http://en.wikipedia.org/wiki/WiX)文档，下载了示例，但我仍然遇到很多升级问题。尽管可以指定这些卸载，但次要升级不会执行以前产品的卸载。我花了更多的时间进行调查，发现 WiX 3.5 引入了一个新的升级标签。这是用法：

```
<MajorUpgrade Schedule="afterInstallInitialize"
        DowngradeErrorMessage="A later version of [ProductName] is already installed. Setup will now exit." 
        AllowDowngrades="no" /> 
```

但问题的**主要原因**是文档说使用“ **REINSTALL=ALL REINSTALLMODE=vomus** ”参数进行次要和小型升级，但并没有说这些参数**对于重大升级**是禁止的- 它们只是停止工作。因此，您不应将它们用于重大升级。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-06-25T06:52:23.583

我建议看看 Alex Shevchuk 的教程。[他在From MSI to WiX, Part 8 - Major Upgrade](http://blogs.technet.com/alexshev/archive/2008/02/15/from-msi-to-wix-part-8-major-upgrade.aspx)中通过一个很好的动手示例解释了通过 WiX 进行的“重大升级” 。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2010-12-24T10:52:46.050

我从教程中错过了一段时间（从[http://www.tramontana.co.hu/wix/lesson4.php](http://www.tramontana.co.hu/wix/lesson4.php)窃取）导致“已安装此产品的另一个版本”错误的一件重要事情：

***小幅更新** *是指对一个或几个文件进行小幅改动，而这些改动不需要更改产品版本（major.minor.build）。您也不必更改产品 GUID。请注意，当您创建一个在任何方面都与以前不同的新 .msi 文件时，您始终必须更改包 GUID。安装程序会跟踪您已安装的程序，并在用户想要使用这些 GUID 更改或删除安装时找到它们。对不同的包使用相同的 GUID 会使安装程序感到困惑。*

**次要升级** *表示产品版本已经更改的更改。修改 Product 标签的 Version 属性。产品将保持不变，因此您无需更改产品 GUID，但当然可以获取新的包 GUID。*

**重大升级** *表示重大变化，例如从一个完整版本升级到另一个完整版本。更改所有内容：版本属性、产品和包 GUID。*

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2010-03-09T07:57:55.073

我正在使用最新版本的 WiX (3.0) 并且无法使上述工作正常进行。但这确实有效：

```
<Product Id="*" UpgradeCode="PUT-GUID-HERE" ... >

<Upgrade Id="PUT-GUID-HERE">
  <UpgradeVersion OnlyDetect="no" Property="PREVIOUSFOUND"
     Minimum="1.0.0.0"  IncludeMinimum="yes"
     Maximum="99.0.0.0" IncludeMaximum="no" />
</Upgrade> 
```

请注意，PUT-GUID-HERE 应该与您在产品的 UpgradeCode 属性中定义的 GUID 相同。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-12-04T22:52:08.310

下面为我​​工作。

```
<Product Id="*" Name="XXXInstaller" Language="1033" Version="1.0.0.0" 
    Manufacturer="XXXX" UpgradeCode="YOUR_GUID_HERE">
<Package InstallerVersion="xxx" Compressed="yes"/>
<Upgrade Id="YOUR_GUID_HERE">
    <UpgradeVersion Property="REMOVINGTHEOLDVERSION" Minimum="1.0.0.0" 
        RemoveFeatures="ALL" />
</Upgrade>
<InstallExecuteSequence>
    <RemoveExistingProducts After="InstallInitialize" />
</InstallExecuteSequence> 
```

请确保 Product 中的 UpgradeCode 与 Upgrade 中的 Id 匹配。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-03-24T19:40:40.187

这对我有用，即使是主要的**DOWN**等级：

```
<Wix ...>
  <Product ...>
    <Property Id="REINSTALLMODE" Value="amus" />
    <MajorUpgrade AllowDowngrades="yes" /> 
```

# windows - 包装可执行文件以诊断它的调用

> ID：114172
> 
> 赞同：2
> 
> 时间：2008-09-22T10:36:19.447
> 
> 标签：windows, scripting

我有一个 Windows 可执行文件 (whoami)，它经常崩溃。从另一个进程调用它以获取有关当前用户和域的详细信息。我想知道失败时传递了哪些参数。

有谁知道包装进程并将其命令行参数写入日志同时仍调用进程的适当方法？

假设命令是这样使用的：'whoami.exe /all'

我希望存在一个脚本，而不是 whoami.exe （具有相同的文件名），它将将此调用写入日志，然后将调用传递给实际进程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T10:45:12.063

您没有注意哪种编程语言。如果这是您想要的，则无法从 .bat 文件中执行此操作，但您可以使用任何编程语言执行此操作。C中的示例：

```
int main(int argc, void **argv)
{
    // dump contents of argv to some log file
    int i=0;
    for (i=0; i<argc; i++)
        printf("Argument #%d: %s\n", argv[i]);
    // run the 'real' program, giving it the rest of argv vector (1+)
    // for example spawn, exec or system() functions can do it
    return 0; // or you can do a blocking call, and pick the return value from the program
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T10:47:54.490

我不认为使用“脚本”会起作用，因为中间体应该有一个 .exe 扩展名才能让你的策略起作用。

我会编写一个非常小的命令行程序来做到这一点；类似于以下内容（用 Delphi/Virtual Pascal 编写，因此它将生成 Win32 可执行文件，但任何编译语言都应该这样做）：

```
program PassThrough;

uses
  Dos; // Imports the Exec routine

const
  PassTo = 'Original.exe'; // The program you really want to call

var 
  CommandLine: String;
  i: Integer;
  f: Text;

begin
  CommandLine := '';
  for i := 1 to ParamCount do
    CommandLine := CommandLine + ParamStr(i) + ' ';

  Assign(f,'Passthrough.log');
  Append(f);
  Writeln(f, CommandLine);      // Write a line in the log
  Close(f);

  Exec(PassTo, CommandLine);    // Run the intended program
end. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T10:51:13.953

你不能只改变调用程序来记录它用来调用进程的参数和退出代码吗？这比尝试深入研究 whoami.exe 要容易得多

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T10:57:10.693

从批处理文件：

```
echo Parameters: %* >> logfile.txt
whoami.exe %* 
```

需要注意的是，如果参数包含空格（并且您使用“转义传递 in”），您可能会遇到问题，因为命令行解析器基本上会取消转义它们，并且在传递给其他可执行文件之前应该重新转义它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T10:45:47.273

查找 whoami.exe，备份它，用您自己的可执行文件替换它，然后查看使用它的参数做任何您喜欢的事情（也许将它们保存在文本文件中）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T11:38:31.063

如果您可以重现崩溃，请在崩溃的进程终止之前使用 Process Explorer 查看其命令行。

[http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)

# c# - 更新对正在使用的成员变量的引用

> ID：114179
> 
> 赞同：0
> 
> 时间：2008-09-22T10:37:44.297
> 
> 标签：c#, .net, singleton

我得到了这个单例缓存对象，它公开了一个 IEnumerable 属性，它只返回一个私有 IEnumerable 变量。

我的单例对象上有一个静态方法，用于更新此成员变量（存在于此缓存对象的单个“实例”实例上）。

假设某个线程当前正在迭代这个 IEnumerable 变量/属性，而我的缓存正在更新。我这样做是为了让缓存更新一个新的局部变量，最后将暴露的私有变量设置为指向这个新的局部变量。

我知道我只是在更新一个引用，而将另一个（旧）对象留在内存中等待 GC 拾取，但我的问题是 - 我不是 100% 确定设置新引用后会发生什么？另一个线程会突然遍历新对象还是通过 IEnumerable 接口传递的旧对象？如果它是一个正常的参考，我会说'不'。调用线程将在旧对象上运行，但我不确定 IEnumerable 是否也是这种情况？

这是剥离的类：

```
internal sealed class SektionCache : CacheBase
{
    public static readonly SektionCache Instance = new SektionCache();
    private static readonly object lockObject = new object();
    private static bool isUpdating;

    private IEnumerable<Sektion> sektioner;

    static SektionCache()
    {
        UpdateCache();
    }

    public IEnumerable<Sektion> Sektioner
    {
        get { return sektioner; }
    }

    public static void UpdateCache()
    {
    // SNIP - getting data, locking etc.
    Instance.sektioner = newSektioner;
    // SNIP
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T10:42:16.877

由于`{ return sektioner; }`在将新值放入字段之前调用了 getter，因此返回了旧值。然后，循环`foreach (Sektion s in cache.Sektioner)`使用调用 getter 时收到的值，即旧值。该值将在整个 foreach 循环中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T10:47:14.867

当前正在枚举 sektioner 的线程将继续枚举它，即使您更新了单例中的引用。实现 IEnumerable 的对象没有什么特别之处。

您可能应该将[volatile](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/volatile)关键字添加到 sektioner 字段，因为您没有提供读锁定并且多个线程正在读/写它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T10:45:23.560

首先我看不到对象锁定，未使用的 lockObject 变量让我很难过。IEnumerable 并不特殊。每个线程都有自己的对 sektioner 对象实例的引用副本。您不能以这种方式影响其他线程。sektioner 字段指向的旧版本数据会发生什么很大程度上取决于呼叫方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T12:05:54.193

我认为，如果你想要线程安全，你应该使用这种方式：

```
internal sealed class SektionCache : CacheBase
{
    //public static readonly SektionCache Instance = new SektionCache();

    // this template is better ( safer ) than the previous one, for thread-safe singleton patter >>>
    private static SektionCache defaultInstance;
    private static object readonly lockObject = new object();
    public static SektionCach Default {
        get {
            SektionCach result = defaultInstance;
            if ( null == result ) {
                lock( lockObject ) {
                    if ( null == result ) {
                        defaultInstance = result = new SektionCache();
                    }
                }
            }

            return result;
        }
    }
    // <<< this template is better ( safer ) than the previous one

    //private static readonly object lockObject = new object();
    //private static bool isUpdating;
    //private IEnumerable<Sektion> sektioner;

    // this declaration is enough
    private volatile IEnumerable<Sektion> sektioner;

    // no static constructor is required >>>
    //static SektionCache()
    //{
    //    UpdateCache();
    //}
    // <<< no static constructor is required

    // I think, you can use getter and setter for reading & changing a collection
    public IEnumerable<Sektion> Sektioner {
        get {
            IEnumerable<Sektion> result = this.sektioner;
            // i don't know, if you need this functionality >>>
            // if ( null == result ) { result = new Sektion[0]; }
            // <<< i don't know, if you need this functionality
            return result;
        }
        set { this.sektion = value; }
    }

    //public static void UpdateCache()
    //{
    //// SNIP - getting data, locking etc.
    //Instance.sektioner = newSektioner;
    //// SNIP
    //}
} 
```

# c++ - 指针与参考

> ID：114180
> 
> 赞同：270
> 
> 时间：2008-09-22T10:38:32.110
> 
> 标签：c++, variables, pointers, reference

为函数提供要使用的原始变量时，有什么更好的做法：

```
unsigned long x = 4;

void func1(unsigned long& val) {
     val = 5;            
}
func1(x); 
```

或者：

```
void func2(unsigned long* val) {
     *val = 5;
}
func2(&x); 
```

IOW：有什么理由选择一个而不是另一个吗？

* * *

## 回答 #1

> 赞同：296
> 
> 时间：2008-09-22T10:40:15.977

我的经验法则是：

如果您想对指针进行指针运算（例如，递增指针地址以逐步遍历数组）或者您必须传递一个 NULL 指针，请使用指针。

否则使用参考。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2008-09-22T11:37:17.337

我真的认为您将从建立以下函数调用编码指南中受益：

1.  与所有其他地方一样，始终保持`const`正确。

    *   注意：这意味着，除其他外，只有输出值（参见第 3 项）和按值传递的值（参见第 4 项）可以缺少说明`const`符。
2.  如果值 0/NULL 是当前上下文中的有效输入，则仅通过指针传递值。

    *   理由 1：作为**调用者**，您看到您传入的任何内容都*必须*处于可用状态。

    *   理由 2：正如**所谓**的那样，您知道进来的任何东西都处于*可用*状态。因此，不需要对该值进行 NULL 检查或错误处理。

    *   理由 3：理由 1 和 2 将由*编译器强制执行*。如果可以的话，总是在编译时捕获错误。

3.  如果函数参数是输出值，则通过引用传递它。

    *   理由：我们不想破坏第 2 项...
4.  [仅当值是 POD（普通旧数据结构](https://stackoverflow.com/questions/146452/what-are-pod-types-in-c)）或足够小（内存方面）或以其他方式足够便宜（时间方面）进行复制时，才选择“按值传递”而不是“按 const 引用传递” 。

    *   理由：避免不必要的副本。
    *   注意：*足够小*和足够*便宜*并不是绝对可衡量的。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-09-22T13:11:31.400

这最终是主观的。到目前为止的讨论很有用，但我认为对此没有正确或决定性的答案。很大程度上取决于风格指南和您当时的需求。

虽然指针有一些不同的功能（是否可以为 NULL），但输出参数的最大实际差异是纯语法。例如， Google 的 C++ 样式指南 ( [https://google.github.io/styleguide/cppguide.html#Reference_Arguments](https://google.github.io/styleguide/cppguide.html#Reference_Arguments) ) 只要求输出参数的指针，并且只允许 const 引用。推理是可读性之一：具有值语法的东西不应该具有指针语义。我并不是说这一定是对还是错，但我认为这里的重点是风格问题，而不是正确性问题。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-03-13T12:43:18.407

**指针**

*   指针是保存内存地址的变量。
*   指针声明由基类型、* 和变量名组成。
*   指针可以指向生命周期内任意数量的变量
*   当前未指向有效内存位置的指针被赋予值 null（为零）

    ```
    BaseType* ptrBaseType;
    BaseType objBaseType;
    ptrBaseType = &objBaseType; 
    ```

*   & 是一个一元运算符，它返回其操作数的内存地址。

*   解引用运算符 (*) 用于访问存储在指针指向的变量中的值。

    ```
     int nVar = 7;
       int* ptrVar = &nVar;
       int nVar2 = *ptrVar; 
    ```

**参考**

*   引用 (&) 类似于现有变量的别名。

*   引用 (&) 类似于自动取消引用的常量指针。

*   它通常用于函数参数列表和函数返回值。

*   引用必须在创建时进行初始化。

*   一旦一个引用被初始化为一个对象，就不能改变它来引用另一个对象。

*   您不能有 NULL 引用。

*   一个 const 引用可以引用一个 const int。它是使用具有 const 值的临时变量完成的

    ```
    int i = 3;    //integer declaration
    int * pi = &i;    //pi points to the integer i
    int& ri = i;    //ri is refers to integer i – creation of reference and initialization 
    ```

[![在此处输入图像描述](https://i.stack.imgur.com/eWoBz.jpg)](https://i.stack.imgur.com/eWoBz.jpg)

[![在此处输入图像描述](https://i.stack.imgur.com/nhMdc.jpg)](https://i.stack.imgur.com/nhMdc.jpg)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-22T15:28:12.210

如果要修改变量的值，则应该传递一个指针。尽管在技术上传递引用或指针是相同的，但在您的用例中传递指针更具可读性，因为它“宣传”了值将被函数更改的事实。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-17T21:53:19.640

如果您有一个可能需要指示缺少值的参数，通常的做法是将该参数设为指针值并传入 NULL。

在大多数情况下（从安全角度来看）更好的解决方案是使用[boost::optional](http://www.boost.org/doc/libs/1_35_0/libs/optional/doc/html/index.html)。这允许您通过引用传递可选值，也可以作为返回值。

```
// Sample method using optional as input parameter
void PrintOptional(const boost::optional<std::string>& optional_str)
{
    if (optional_str)
    {
       cout << *optional_str << std::endl;
    }
    else
    {
       cout << "(no string)" << std::endl;
    }
}

// Sample method using optional as return value
boost::optional<int> ReturnOptional(bool return_nothing)
{
    if (return_nothing)
    {
       return boost::optional<int>();
    }

    return boost::optional<int>(42);
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-03-01T18:59:47.783

尽可能使用引用，必要时使用指针。来自[C++ FAQ：“什么时候应该使用引用，什么时候应该使用指针？”](https://isocpp.org/wiki/faq/references#pointers-and-references)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-22T15:23:53.097

引用是隐式指针。基本上，您可以更改引用指向的值，但不能更改引用以指向其他内容。所以我的 2 美分是，如果您只想更改参数的值，请将其作为引用传递，但如果您需要更改参数以指向不同的对象，请使用指针传递它。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-17T22:22:19.550

考虑 C# 的 out 关键字。编译器要求方法的调用者将 out 关键字应用于任何 out args，即使它已经知道它们是否存在。这是为了提高可读性。尽管使用现代 IDE，我倾向于认为这是语法（或语义）突出显示的工作。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-22T11:43:55.497

通过 const 引用传递，除非您有理由希望更改/保留您传入的内容。

在大多数情况下，这将是最有效的方法。

确保在您不想更改的每个参数上使用 const，因为这不仅可以防止您在函数中做一些愚蠢的事情，而且可以很好地向其他用户表明该函数对传入的值做了什么。这包括当您只想更改指向的内容时创建一个指针 const...

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-10-29T13:09:06.943

指针：

*   可以赋值`nullptr`（或`NULL`）。
*   在调用站点，`&`如果您的类型本身不是指针，则必须使用，明确表示您正在修改您的对象。
*   三分球可以反弹。

参考：

*   不能为空。
*   一旦绑定，无法更改。
*   调用者不需要显式使用`&`. 这有时被认为是不好的，因为你必须去函数的实现看看你的参数是否被修改。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-04-26T14:35:09.560

引用类似于指针，不同之处在于您不需要使用前缀 * 来访问引用所引用的值。此外，在初始化后不能引用另一个对象。

引用对于指定函数参数特别有用。

有关更多信息，请参阅“Bjarne Stroustrup”（2014 年）第 11-12 页的“C++ 之旅”

# .net - 从 /bin 目录加载 DLL

> ID：114187
> 
> 赞同：1
> 
> 时间：2008-09-22T10:40:12.357
> 
> 标签：.net, asp.net

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T17:23:50.340

有时，虚拟目录中存在（或不存在）web.config 文件会导致您描述的奇怪行为。我还看到虚拟目录不会在 virtual-directory/bin 下查找，而是在 base/bin 下查找相应的 dll。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T10:58:38.083

一个原因可能是，bin 目录不是标记为应用程序的目录**的直接子文件夹。**检查 IIS Web 设置以查看您的目录是否是“应用程序”目录而*不是*另一个应用程序的简单虚拟目录。

另一个原因可能是部署的程序集版本与在其他程序集中用作引用的程序集不对应。

还要检查服务器上该文件的安全设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T10:45:21.970

默认情况下不 IIS 在 Project/bin 文件夹（而不是 /bin/Debug）中查找 DLL。检查您是否在 IIS 中设置了正确的 dotNET 版本以及同一文件夹中的所有引用库。

# ruby-on-rails - 如何在 Ruby on Rails 中处理必须保存在数据库中但不是正确模型的数据？

> ID：114192
> 
> 赞同：5
> 
> 时间：2008-09-22T10:41:34.443
> 
> 标签：ruby-on-rails, ruby, persistence

想象一个用 Ruby on Rails 编写的 Web 应用程序。该应用程序的部分状态以不符合模型描述的数据表示。此状态描述符需要与模型保存在同一数据库中。它与模型的不同之处在于它的类只需要一个实例，并且它与其他类没有关系。

有没有人遇到过这样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T11:06:54.243

如果它是数据，并且在数据库中，那么它就是模型的一部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-22T13:35:01.733

根据您的描述，我认为 rails-settings 插件应该可以满足您的需求。

从自述文件：

“Settings 是一个插件，可以轻松管理全局键、值对表。把它想象成存储在数据库中的全局哈希，它使用简单的 ActiveRecord 之类的方法进行操作。跟踪您不想使用的任何全局设置硬编码到您的 Rails 应用程序中。您可以存储任何类型的对象。字符串、数字、数组或任何对象。

[http://github.com/Squeegy/rails-settings/tree/master](http://github.com/Squeegy/rails-settings/tree/master)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T11:09:07.030

这并不是真正的 RoR 问题。这是一个一般的OO设计问题。

如果是我，我可能会找到一种方法将数据概念化为模型，然后使用工厂方法和私有构造函数使其成为单例。

或者，您可以将其视为一种日志记录形式。在这种情况下，您只需要一个 Logger 类（也是一个单例）直接读取/写入数据库并在每个请求的开始和结束时调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T11:22:57.497

在 Rails 中，如果数据在数据库中，那么它就在模型中。在这种情况下，模型可能被称为“配置”，但它仍然映射到 Rails 系统中的 ActiveRecord 类。

如果这些数据确实是静态的，那么您可能根本不需要数据库。您可以在应用程序控制器中使用（例如）一个变量：

```
class ApplicationController < ActionController::Base
  helper :all 
  @data = "YOUR DATA HERE"   
end 
```

有许多方法可用于实例化用于 Rails 应用程序的数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T13:24:24.490

我不确定我是否理解您为什么说它不适合 Rails 模型。

如果它只是一个复杂的数据结构，只需将一堆 Ruby 代码保存在数据库的文本字段中即可:-)

例如，如果您要保存一个复杂的嵌套哈希，请将以下内容分配给您的“数据”文本字段：

```
ComplexThing.data = complex_hash.inspect 
```

当你想读回来时，只需

```
complex_hash = eval ComplexThing.data 
```

让我指出有关此解决方案的另外两件事：

*   如果您的数据结构不是标准的 Ruby 类，简单的检查可能无法做到。如果您在任何地方看到 #<MyClass:0x4066e3c>，则说明某些内容没有正确序列化。
*   这是一个幼稚的实现。如果您冒着拥有 unicode 数据的风险，或者您确实要保存大量定制类，您可能需要查看真正的编组解决方案。

# windows-vista - 在 vista 安装程序中将所有用户共享的可写数据存储在哪里？

> ID：114194
> 
> 赞同：4
> 
> 时间：2008-09-22T10:42:26.080
> 
> 标签：windows-vista, installation, nsis, acl

我的应用程序是通过 NSIS 安装的。

我希望安装程序为所有用户安装程序。

我可以通过安装到“程序文件”目录来做到这一点。

有一个数据库文件（firebird），系统上的所有用户帐户都应该共享。

如果我将此数据库文件存储在“程序文件”目录中，它将是只读的。

如果我将它存储在用户的 APPDATA 目录中，他们每个人都会有一个不同的副本，当一个用户添加数据时，其他人不会看到它。

选项 1 - 在我的“程序文件”下的应用程序目录中创建一个“数据”目录，在我的安装程序中使这个目录对所有人都是可读写的，这样用户“程序文件”虚拟化将不会启动并且所有用户都可以更新文件并查看彼此的更改。

还有其他选择吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-22T11:02:06.530

所有用户的数据应该存储在 %ALLUSERSPROFILE% 中，或者调用 SHGetFolderPath() 参数 CSIDL_COMMON_APPDATA 来获取所有用户的存储区域。

有关详细信息，请参阅[http://www.deez.info/sengelha/2006/02/28/windows-vista-changes/ 。](http://www.deez.info/sengelha/2006/02/28/windows-vista-changes/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-22T10:57:59.287

所有用户配置文件下的某处将是明显的位置。我认为默认情况下谁可以读/写有一些规则，但是如果您需要不同的东西来创建子目录并在安装程序中正确设置 ACL，MS 文档建议您这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T11:11:02.127

这是一个安全漏洞，请参阅：http: [//blogs.msdn.com/oldnewthing/archive/2004/11/22/267890.aspx](http://blogs.msdn.com/oldnewthing/archive/2004/11/22/267890.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T14:52:50.040

具体来说，我会使用：

```
SetShellVarContext all
SetOutPath $APPDATA
File "MyInsecurelySharedFile.txt" 
```

有关详细信息，请参阅[NSIS 脚本参考](http://nsis.sourceforge.net/Docs/Chapter4.html#4.2.3)。

# http - 你如何在 Erlang 中对参数进行 URL 编码？

> ID：114196
> 
> 赞同：20
> 
> 时间：2008-09-22T10:44:07.900
> 
> 标签：http, url, encoding, erlang

我正在使用[`httpc:request`](http://erlang.org/doc/man/httpc.html#request-1)将一些数据发布到远程服务。我有帖子工作，但帖子的 body() 中的数据按原样通过，没有任何 URL 编码，这会导致帖子在被远程服务解析时失败。

Erlang 中是否有类似于[`CGI.escape`](https://apidock.com/ruby/CGI/escape/class)Ruby 中用于此目的的函数？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-01T17:49:02.217

我也遇到了 HTTP 模块中缺少此功能的情况。

事实证明，这个功能实际上在 erlang 发行版中是可用的，你只需要仔细研究一下。

```
> edoc_lib:escape_uri("luca+more@here.com").
"luca%2bmore%40here.com" 
```

这与 Ruby 中的 CGI.escape 类似，但 URI.escape 的行为略有不同：

```
> CGI.escape("luca+more@here.com")
 => "luca%2Bmore%40here.com" 
> URI.escape("luca+more@here.com")
 => "luca+more@here.com" 
```

[edoc_lib](http://www.erlang.org/doc/man/edoc_lib.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-27T14:26:15.037

至少在 R15 中有[http_uri:encode/1](http://www.erlang.org/doc/man/http_uri.html#encode-1)可以完成这项工作。我也不建议使用 edoc_lib:escape_uri 将 '=' 转换为 %3d 而不是 %3D，这给我带来了一些麻烦。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-23T07:17:03.833

你可以在这里找到[YAWS url_encode 和 url_decode 例程](https://github.com/klacke/yaws/blob/d371b828eb26c1ded9f6110c764b7f42da773e2b/src/yaws_api.erl#L786)

它们相当简单，尽管注释表明所有标点字符的编码并不是 100% 完成的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-08-17T16:16:46.560

这是一个完成这项工作的简单函数。它旨在直接与 inets httpc 一起使用。

```
%% @doc A function to URL encode form data.
%% @spec url_encode(formdata()).

-spec(url_encode(formdata()) -> string()).
url_encode(Data) ->
    url_encode(Data,"").

url_encode([],Acc) ->
    Acc;

url_encode([{Key,Value}|R],"") ->
    url_encode(R, edoc_lib:escape_uri(Key) ++ "=" ++ edoc_lib:escape_uri(Value));
url_encode([{Key,Value}|R],Acc) ->
    url_encode(R, Acc ++ "&" ++ edoc_lib:escape_uri(Key) ++ "=" ++ edoc_lib:escape_uri(Value)). 
```

示例用法：

```
httpc:request(post, {"http://localhost:3000/foo", [], 
                    "application/x-www-form-urlencoded",
                    url_encode([{"username", "bob"}, {"password", "123456"}])}
             ,[],[]). 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-09-28T23:15:26.223

如果有人需要在 erlang 中使用 utf-8 编码 uri：

[https://gist.github.com/3796470](https://gist.github.com/3796470)

前任。

```
Eshell V5.9.1  (abort with ^G)

1> c(encode_uri_rfc3986).
{ok,encode_uri_rfc3986}

2> encode_uri_rfc3986:encode("テスト").
"%e3%83%86%e3%82%b9%e3%83%88"

3> edoc_lib:escape_uri("テスト").
"%c3%86%c2%b9%c3%88" # output wrong: Æ¹È 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-22T11:07:10.450

回答我自己的问题...我在 ibrowse 中找到了这个库！

[http://www.erlware.org/lib/5.6.3/ibrowse-1.4/ibrowse_lib.html#url_encode-1](http://www.erlware.org/lib/5.6.3/ibrowse-1.4/ibrowse_lib.html#url_encode-1)

```
url_encode/1

url_encode(Str) -> UrlEncodedStr

Str = string()
UrlEncodedStr = string() 
```

URL 编码基于 RFC 1738 的字符串。返回一个平面列表。

我想我可以使用它来进行编码并仍然使用 http：

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-09-18T20:11:31.207

这是函数的“分支”，`edoc_lib:escape_uri`它改进了对 UTF-8 的支持并且还支持二进制文件。

```
escape_uri(S) when is_list(S) ->
    escape_uri(unicode:characters_to_binary(S));
escape_uri(<<C:8, Cs/binary>>) when C >= $a, C =< $z ->
    [C] ++ escape_uri(Cs);
escape_uri(<<C:8, Cs/binary>>) when C >= $A, C =< $Z ->
    [C] ++ escape_uri(Cs);
escape_uri(<<C:8, Cs/binary>>) when C >= $0, C =< $9 ->
    [C] ++ escape_uri(Cs);
escape_uri(<<C:8, Cs/binary>>) when C == $. ->
    [C] ++ escape_uri(Cs);
escape_uri(<<C:8, Cs/binary>>) when C == $- ->
    [C] ++ escape_uri(Cs);
escape_uri(<<C:8, Cs/binary>>) when C == $_ ->
    [C] ++ escape_uri(Cs);
escape_uri(<<C:8, Cs/binary>>) ->
    escape_byte(C) ++ escape_uri(Cs);
escape_uri(<<>>) ->
    "".

escape_byte(C) ->
    "%" ++ hex_octet(C).

hex_octet(N) when N =< 9 ->
    [$0 + N];
hex_octet(N) when N > 15 ->
    hex_octet(N bsr 4) ++ hex_octet(N band 15);
hex_octet(N) ->
    [N - 10 + $a]. 
```

请注意，由于使用了 unicode:characters_to_binary，它仅适用于 R13 或更新版本。

示例用法是：

```
9> httpc:request("http://httpbin.org/get?q=" ++ mylib_app:escape_uri("☺")).
{ok,{{"HTTP/1.1",200,"OK"},
     [{"connection","keep-alive"},
      {"date","Sat, 09 Nov 2019 21:51:54 GMT"},
      {"server","nginx"},
      {"content-length","178"},
      {"content-type","application/json"},
      {"access-control-allow-credentials","true"},
      {"access-control-allow-origin","*"},
      {"referrer-policy","no-referrer-when-downgrade"},
      {"x-content-type-options","nosniff"},
      {"x-frame-options","DENY"},
      {"x-xss-protection","1; mode=block"}],
     "{\n  \"args\": {\n    \"q\": \"\\u263a\"\n  }, \n  \"headers\": {\n    \"Host\": \"httpbin.org\"\n  }, \n  \"origin\": \"11.111.111.111, 11.111.111.111\", \n  \"url\": \"https://httpbin.org/get?q=\\u263a\"\n}\n"}} 
```

我们发送一个带有转义查询参数的请求，并看到我们得到了正确的 Unicode 代码点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-22T10:54:43.587

AFAIK 标准库中没有 URL 编码器。认为我从 YAWS 或其他 Erlang Web 服务器之一“借用”了以下代码：

```
% Utility function to convert a 'form' of name-value pairs into a URL encoded
% content string.

urlencode(Form) ->
    RevPairs = lists:foldl(fun({K,V},Acc) -> [[quote_plus(K),$=,quote_plus(V)] | Acc] end, [],Form),
    lists:flatten(revjoin(RevPairs,$&,[])).

quote_plus(Atom) when is_atom(Atom) ->
    quote_plus(atom_to_list(Atom));

quote_plus(Int) when is_integer(Int) ->
    quote_plus(integer_to_list(Int));

quote_plus(String) ->
    quote_plus(String, []).

quote_plus([], Acc) ->
    lists:reverse(Acc);

quote_plus([C | Rest], Acc) when ?QS_SAFE(C) ->
    quote_plus(Rest, [C | Acc]);

quote_plus([$\s | Rest], Acc) ->
    quote_plus(Rest, [$+ | Acc]);

quote_plus([C | Rest], Acc) ->
    <<Hi:4, Lo:4>> = <<C>>,
    quote_plus(Rest, [hexdigit(Lo), hexdigit(Hi), ?PERCENT | Acc]).

revjoin([], _Separator, Acc) ->
    Acc;

revjoin([S | Rest],Separator,[]) ->
    revjoin(Rest,Separator,[S]);

revjoin([S | Rest],Separator,Acc) ->
    revjoin(Rest,Separator,[S,Separator | Acc]).

hexdigit(C) when C < 10 -> $0 + C;
hexdigit(C) when C < 16 -> $A + (C - 10). 
```

# apache - 如何使用 Apache/WebDAV 作为经过身份验证的用户进行读/写？

> ID：114204
> 
> 赞同：0
> 
> 时间：2008-09-22T10:45:50.673
> 
> 标签：apache, authentication, webdav

我已经在 apache2 中设置了 DAV，效果很好。问题是，所有读/写操作都是使用 apache 用户的凭据完成的。相反，我想使用经过 HTTP 身份验证的用户的凭据。如果我以“john”身份进行身份验证，则所有读写操作都应使用系统用户 john 的凭据（来自 /etc/passwd）。 [suEXEC](http://httpd.apache.org/docs/2.2/suexec.html)似乎有点矫枉过正，因为我没有执行任何东西，但我可能错了......

这是当前的配置：

```
<VirtualHost *:80>
        DocumentRoot /var/www/webdav
        ServerName webdav.mydomain.com
        ServerAdmin webmaster@mydomain.com

       <Location "/">
               DAV On
               AuthType Basic
               AuthName "WebDAV Restricted"
               AuthUserFile /etc/apache2/extra/webdav-passwords
               require valid-user

               Options +Indexes
       </Location>
        DAVLockDB /var/lib/dav/lockdb

        ErrorLog /var/log/apache2/webdav-error.log
        TransferLog /var/log/apache2/webdav-access.log
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-22T11:07:54.427

射击答案，据我所知：你没有。

长答案：可以使用适当的 mpm 实现这样的功能，并且有[各种](http://httpd.apache.org/docs/2.0/mod/perchild.html) [尝试](http://www.telana.com/peruser.php)这样做，但它们似乎没有得到非常积极的支持，并且至少不在主线 Apache 代码库中。

细读：

> 问：peruser 准备好用于生产了吗？
> 
> A. 一般来说，不会。

生孩子：

> 该模块不起作用。此模块的开发尚未完成，当前未激活。除非您是愿意帮助修复它的程序员，否则不要使用 perchild。

这太糟糕了，真的；WebDav 的大多数用途我见过在应用程序层存储所有权信息，在数据库中，无论如何。做文件共享的共识是改用 Samba；我承认，这并不是真正的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-10T19:45:02.200

多年来，我们一直使用 davenport ( [http://davenport.sourceforge.net/](http://davenport.sourceforge.net/) ) 通过 webdav 提供对 Windows/samba 共享的访问。Samba/Windows 对这类事情提供了很多控制，而 Davenport 只是使它可以在没有 VPN 的情况下通过 SSL 在 Web 上使用

# c# - 使用 StarUML 逆向工程 C# 代码

> ID：114205
> 
> 赞同：1
> 
> 时间：2008-09-22T10:46:16.960
> 
> 标签：c#, reverse-engineering

我正在尝试使用 StarUML 将我的 C# 代码转换为设计（Reverese Engineering）。执行逆向工程时出现错误

> “逆向工程过程中发生错误。消息：灾难性故障”。

错误发生后，应用程序崩溃了。

有人可以为此提出解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-01T17:18:57.727

staruml 的问题之一是它显然不支持泛型，并且当文件具有“<”时，会发生解析器错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T11:45:53.383

我对 StarUML 尤其不熟悉，尽管它可以通过多种方式来处理记录程序集的过程。最可能的方法是 .Net 反射。

许多应用程序都在为最近的 C# 优化而苦苦挣扎。

反射代码的最佳应用程序是[Reflector](http://www.red-gate.com/products/reflector)，并且有一些插件可以为您生成 UML。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T05:02:51.223

这似乎是 StarUML 的解析器错误。您可以尝试其他 UML 软件，例如 ModelMaker for C#。

# php - 在linux中重新初始化系统范围的环境变量

> ID：114207
> 
> 赞同：5
> 
> 时间：2008-09-22T10:47:41.963
> 
> 标签：php, linux, variables, environment

我只想让我的 apache 注册一些我的预定义环境，以便我可以使用 php 中的 getenv 函数检索它。我怎样才能做到这一点？我尝试使用 root 添加 /etc/profile.d/foo.sh 和 export FOO=/bar/baz 并重新启动 apache。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-22T10:56:23.863

环境变量由 Unix 中的进程继承。/etc/profile.d 中的文件仅在您登录时执行（在当前 shell 中，而不是在子 shell 中）。仅更改那里的值然后重新启动进程不会更新环境。

可能的修复：

*   注销/登录，然后启动 apache
*   源文件：`# . /etc/profile.d/foo.sh`，然后重新启动apache
*   在 apache 初始化脚本中获取文件

您还需要确保它`/etc/profile.d/`是由 Apache 启动`init`而不是您自己启动的。

最好的修复可能还取决于您使用的发行版，因为它们使用不同的配置方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T16:03:18.133

您可以在配置文件（/etc/httpd/conf.d/*.conf、.htaccess ...）中使用[SetEnv 。](http://httpd.apache.org/docs/2.2/mod/mod_env.html#setenv)此外，您应该能够在 /etc/sysconfig/httpd 中定义它们（在基于 RPM 的发行版上）并*导出*它们（注意：未经测试）。

注意：如果某些发行版试图尽可能多地隐藏系统配置，这不会让我感到惊讶，就系统配置而言，可以从公开访问的服务（例如 Apache）中隐藏。如果他们不这样做，他们可能会在未来的版本中开始这样做。因此，我建议您明确地执行此操作。如果您需要在 Apache 和您的 shell 之间共享这样的设置，您可以尝试从*/etc/sysconfig/httpd获取**/etc/profile.d/yourprofile.sh*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T18:24:31.973

Apache 配置文件允许您基于每个站点设置环境变量。

因此，如果您的 Web 服务器正在为来自两个逻辑站点的页面提供服务，您可以为每个站点设置不同的相同环境变量，从而让您的 PHP 做出不同的反应。

有关详细信息，请参阅[Apache mod_env](http://httpd.apache.org/docs/1.3/mod/mod_env.html)：

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-08T07:33:12.547

如果您只需要 Apache 的环境变量，那么对我有用的是编辑`/etc/apache2/envvars`和重新启动 Apache。我添加了这些设置：

```
export LANG='en_US.UTF-8'
export LC_ALL='en_US.UTF-8' 
```

# asp.net - 如何在 Web 服务器上的某个文件夹中列出一些特定的图像？

> ID：114208
> 
> 赞同：0
> 
> 时间：2008-09-22T10:47:49.780
> 
> 标签：asp.net, vb.net

让我解释一下：这是该文件夹的路径：>`www.my_site.com/images`

并且图像是由创建的`user_id`，例如，图像`user_id = 27`是 `27_1.jpg`、、、！如何列出和打印以 开头的图像？我希望你能理解我！PS。我完全是 ASP.NET (VB) 的初学者，请给我详细的信息`27_2.jpg``27_3.jpg``27_%.jpg`

这里开始我的循环

```
while dbread.Read()

'and then id user_id
dbread('user_id') 
```

下一个？？？

* * *

我需要创建 XML，到目前为止，我是这样创建的：

act.WriteLine("") act.WriteLine(" [http://www.my_site.com/images/](http://www.my_site.com/images/) "&dbread("user_id")&"_1.jpg") act.WriteLine("")

但这不是答案，因为我需要创建这个节点，这个用户有多少图像存在？

在数据库中不存在此图像的列表，所以这就是我必须将它们计入文件夹的原因。（这不是我的网站，但我需要在这个网站上创建 XMl）

你了解我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T10:50:32.800

最好的方法是遍历目录中的所有文件。

```
While dbRead.Read
  dim sUserId as String= dbread('user_id')
  For Each sFile As String In IO.Directory.GetFiles("C:\")
    if sFile.StartsWith (sUserId) Then
        'Do something.
    End If
  Next
Loop 
```

但是，要实际显示图像，最好的办法是创建这些图像的数据表，然后使用数据列表或中继器控件来显示它们。

```
Dim dtImages as new DataTable
dtImages.Columns.Add("Filename")
If dbRead.Read
  dim sUserId as String= dbread('user_id')
  For Each sFile As String In IO.Directory.GetFiles("C:\")
    if sFile.StartsWith (sUserId) Then
        Dim drImage as DataRow = dtImages.NewRow
        drImage("Filename") = sFile
        dtImages.Rows.add(drImage)
    End If
  Next
End If
dlImages.DataSource = dtImages
dlImages.DataBind 
```

然后，在您的 ASPX 页面上，您将拥有一个名为 dlImages 的数据列表控件，其定义如下：

```
 <asp:datalist id="dlImages" RepeatDirection="Horizontal" runat="server" RepeatLayout="Flow" Height="100%">
        <ItemTemplate>
            <asp:Image ID="Image1" Runat=server ImageUrl='<%# Server.MapPath("photos") & Container.DataItem("FileName") %>'>
            </asp:Image>
        </ItemTemplate>
    </asp:datalist> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T14:57:30.630

适当的方法是执行以下操作

1.  使用 System.IO.Directory.GetFiles("YourPath", UserId + "_*.jpg") 获取文件列表
2.  循环浏览此清单并构建您的 XML，然后将其呈现给用户。

基本上，GetFiles 方法接受一个路径和一个允许您进行通配符搜索的“过滤器”参数！

**编辑：** GetFiles 操作返回代表完整文件名的字符串列表，然后您可以使用 System.IO.Path.GetFileName() 方法操作这些值以获取实际文件名。

如果您想实际构建文档，可以使用 XmlDocument 类，或者您可以使用简单的循环和字符串构建器来完成。类似于以下内容。

```
StringBuilder oBuilder = new StringBuilder();
oBuilder.Append("<root>");
string[] ofiles = Directory.GetFiles("YourPath", "yourMask");
foreach(string currentString in oFiles)
{
    oBuilder.AppendLine("<file>http://yourpath/" + Path.GetFileName(currentString) + "</file>");
}
oBuilder.Append("</root"); 
```

# c++ - 提升 shared_ptr 容器问题

> ID：114211
> 
> 赞同：1
> 
> 时间：2008-09-22T10:48:59.310
> 
> 标签：c++, boost, smart-pointers

假设我有一个多线程应用程序使用的指针容器（std::vector）。在向容器添加新指针时，代码使用临界区 (boost::mutex) 进行保护。一切都很好。代码应该能够将这些指针之一返回给线程以进行处理，但另一个单独的线程可以选择删除这些指针之一，该指针可能仍在使用中。例如：

```
thread1()
{
    foo* p = get_pointer();
    ...
    p->do_something();
}

thread2()
{
    foo* p = get_pointer();
    ...
    delete p;
} 
```

所以thread2可以在thread1使用它时删除指针。讨厌。

因此，我想使用 Boost 共享 ptrs 的容器。IIRC 这些指针将被引用计数，因此只要我返回共享 ptrs 而不是原始指针，从容器中删除一个不会真正释放它，直到最后一次使用它超出范围。IE

```
std::vector<boost::shared_ptr<foo> > my_vec;

thread1()
{
    boost::shared_ptr<foo> sp = get_ptr[0];
    ...
    sp->do_something();
}

thread2()
{
    boost::shared_ptr<foo> sp = get_ptr[0];
    ...
    my_vec.erase(my_vec.begin());
}

boost::shared_ptr<foo> get_ptr(int index)
{
    lock_my_vec();
    return my_vec[index];
} 
```

在上面的例子中，如果thread1在thread2调用erase之前获得了指针，那么指向的对象是否仍然有效？当thread1完成时它实际上不会被删除？**请注意，对全局向量的访问将通过临界区进行。**

我认为这就是 shared_ptrs 的工作方式，但我需要确定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T10:53:10.780

对于 boost::shared_ptr 的线程安全，您应该检查[此链接](http://www.boost.org/doc/libs/1_36_0/libs/smart_ptr/shared_ptr.htm#ThreadSafety)。它不能保证安全，但在许多平台上它都有效。修改 std::vector 是不安全的 AFAIK。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T12:15:58.303

> 在上面的例子中，如果thread1在thread2调用erase之前获得了指针，那么指向的对象是否仍然有效？当thread1完成时它实际上不会被删除？

在您的示例中，如果 thread1 在 thread2 之前获取指针，则 thread2 将不得不在函数的开头等待（因为锁）。所以，是的，指向的对象仍然有效。但是，您可能需要确保 my_vec 在访问其第一个元素之前不为空。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T11:40:33.477

此外，如果您同步对向量的访问（如在您的原始原始指针提案中），则您的使用是安全的。否则，您可能会违反其他受访者提供的链接中的示例 4。

# design-patterns - 设计思考——核心控制逻辑和渲染层

> ID：114212
> 
> 赞同：1
> 
> 时间：2008-09-22T10:49:10.417
> 
> 标签：design-patterns, architecture

我只是想看看我是否可以对我目前正在做的一些工作的设计有你的想法。

## 这是目前的情况 - 基本上：

*   我正在为我们的应用程序开发一系列控件。
*   其中一些可用于 WinForms 和 ASP.NET Web 应用程序。
*   我一直在努力改进我的代码的测试和可测试性。

## 所以，这就是我所做的：

*   在没有 UI 概念的类中创建核心控制逻辑。它只是在有关它的事情发生变化时引发事件。所有数据都存储为需要与其他对象区分开来的自定义类型对象（例如，我有一个`PagingControl`它拥有的地方`SelectedPage`和`PageNumber`项目）。
*   然后我创建了一个抽象类作为渲染“引擎”的接口。这可确保引擎处理使用（并可能添加）到核心逻辑的任何自定义类型。按照上面的例子，它包含一个抽象方法`RenderSelectedPage`。
*   然后我创建了抽象渲染引擎的具体实现（例如`ConsoleRenderingEngine`，`HtmlRenderingEngine`等等）。然后，这会处理这些方法并将它们呈现给它们各自的 UI/输出。

## 我发现这种方法有以下优点和缺点：

### 专业人士

*   有用。很好，它很容易实现一个新的渲染机制，你所做的就是子类化抽象引擎并渲染输出（它将所需的引用传递给你）。
*   它确实将 UI 与核心代码分开，使其**更容易测试**。
*   显然，由于核心/渲染逻辑的封装，问题出现时很明显。

    ### 骗局

*   它*可能*看起来令人困惑/臃肿。尽管每个类中没有大量代码，但有 3x 个类可以将其渲染到 1 个输出（1x 核心，1x 接口，1x 渲染器）。但是，当创建 WinForms/WebForms 控件时，它也意味着另一个类（因为需要 sublcas`Control`以及`AbstractRenderingEngine`）。

...好吧，这是我真正能想到的唯一“骗局”，也是这个问题的主要原因^_^

所以，

# 你对这个“模式”有什么看法？你会如何改变/改进它？

* * *

**这个问题可能会随着我的更多想法而更新，或者可能需要澄清（我知道这是一个沉重的阅读！）。**

* * *

## 更新

谢谢你们的回答，你说MVP很有趣，我以为我在某个地方看到过这样的东西，但我一生都记不起它是什么了！一看到“MVP”，我就想“该死”。:D

谢谢你们的回应。我会更多地研究 MVP，看看我是否可以进一步改进我所拥有的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-22T13:08:24.357

从你的描述来看，这有点像我做 MVP 的方式，但事情却是相反的。

我通常有一个非常薄的视图，它隐藏在界面后面，并且对演示者一无所知。视图是在用户操作上引发事件的视图。通常，视图所做的只是将 UI 特定于原语或有时来自模型的值对象（ddd 意义上的值对象，而不是 .net 结构）有时我嵌套视图以用于更复杂的情况和重用。UserControls 有时有自己的视图和演示者结构。当您开始嵌套视图和演示者时，对象的实例化开始得到大量工作，所以这通常是我开始寻找 IoC 容器的时候。

演示者通过其界面了解视图并直接与之对话。它对查看事件做出反应并执行大部分逻辑。视图和模型被注入到演示器中，因此其中的所有逻辑都是可测试的。

我看到的另一种方法是视图了解演示者，而演示者仅通过界面了解视图。由于视图可以直接与演示者对话，因此不必为视图操作引发事件。（我认为这在 smalltalk 世界中曾经被称为 MVC）presenter 仍然是可测试的，这使您能够从视图到 Presenter 进行数据绑定。我通常不使用数据绑定，所以对我来说这不是一个很大的优势。我在第一个例子中解耦的东西有点像。

# python - Python中类方法的区别：绑定、未绑定和静态

> ID：114214
> 
> 赞同：250
> 
> 时间：2008-09-22T10:49:43.190
> 
> 标签：python, static-methods

以下类方法有什么区别？

是不是一个是静态的，另一个不是？

```
class Test(object):
  def method_one(self):
    print "Called method_one"

  def method_two():
    print "Called method_two"

a_test = Test()
a_test.method_one()
a_test.method_two() 
```

* * *

## 回答 #1

> 赞同：430
> 
> 时间：2008-09-22T11:05:54.620

*在 Python 中，绑定*方法和*未绑定*方法是有区别的。

基本上，调用成员函数（如`method_one`），绑定函数

```
a_test.method_one() 
```

被翻译成

```
Test.method_one(a_test) 
```

即对未绑定方法的调用。因此，对您的版本的调用`method_two`将失败并显示`TypeError`

```
>>> a_test = Test() 
>>> a_test.method_two()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: method_two() takes no arguments (1 given) 
```

您可以使用装饰器更改方法的行为

```
class Test(object):
    def method_one(self):
        print "Called method_one"

    @staticmethod
    def method_two():
        print "Called method two" 
```

装饰器告诉内置的默认元类`type`（类的类，参见[这个问题](https://stackoverflow.com/questions/100003/what-is-a-metaclass-in-python)）不要为`method_two`.

现在，您可以在实例或类上直接调用静态方法：

```
>>> a_test = Test()
>>> a_test.method_one()
Called method_one
>>> a_test.method_two()
Called method_two
>>> Test.method_two()
Called method_two 
```

* * *

## 回答 #2

> 赞同：203
> 
> 时间：2008-09-22T11:12:36.350

一旦您了解了描述符系统的基础知识，Python 中的方法就是一件非常非常简单的事情。想象一下下面的类：

```
class C(object):
    def foo(self):
        pass 
```

现在让我们看看 shell 中的那个类：

```
>>> C.foo
<unbound method C.foo>
>>> C.__dict__['foo']
<function foo at 0x17d05b0> 
```

正如您所看到的，如果您访问`foo`类上的属性，您将获得一个未绑定的方法，但是在类存储（dict）内部有一个函数。为什么？这样做的原因是您的类的类实现了`__getattribute__`解析描述符的 a 。听起来很复杂，其实不然。 `C.foo`在这种特殊情况下大致相当于这段代码：

```
>>> C.__dict__['foo'].__get__(None, C)
<unbound method C.foo> 
```

那是因为函数有一种`__get__`方法可以使它们成为描述符。如果你有一个类的实例，它几乎是一样的，那`None`就是类实例：

```
>>> c = C()
>>> C.__dict__['foo'].__get__(c, C)
<bound method C.foo of <__main__.C object at 0x17bd4d0>> 
```

现在为什么 Python 会这样做呢？因为方法对象将函数的第一个参数绑定到类的实例上。这就是自我的来源。现在有时您不希望您的类将函数作为方法，这就是`staticmethod`发挥作用的地方：

```
 class C(object):
  @staticmethod
  def foo():
   pass 
```

`staticmethod`装饰器包装您的类并实现一个虚拟对象，该虚拟对象`__get__`将包装的函数作为函数而不是作为方法返回：

```
>>> C.__dict__['foo'].__get__(None, C)
<function foo at 0x17d0c30> 
```

希望能解释一下。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-22T10:56:27.497

当你调用一个类成员时，Python 会自动使用对该对象的引用作为第一个参数。该变量`self`实际上没有任何意义，它只是一个编码约定。如果你愿意，你可以打电话给它`gargaloo`。也就是说，调用`method_two`会引发 a `TypeError`，因为 Python 会自动尝试将参数（对其父对象的引用）传递给定义为没有参数的方法。

要使其真正起作用，您可以将其附加到您的类定义中：

```
method_two = staticmethod(method_two) 
```

或者你可以使用`@staticmethod` [函数 decorator](https://docs.python.org/2/library/functions.html#staticmethod)。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-04-23T03:25:12.067

```
>>> class Class(object):
...     def __init__(self):
...         self.i = 0
...     def instance_method(self):
...         self.i += 1
...         print self.i
...     c = 0
...     @classmethod
...     def class_method(cls):
...         cls.c += 1
...         print cls.c
...     @staticmethod
...     def static_method(s):
...         s += 1
...         print s
... 
>>> a = Class()
>>> a.class_method()
1
>>> Class.class_method()    # The class shares this value across instances
2
>>> a.instance_method()
1
>>> Class.instance_method() # The class cannot use an instance method
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unbound method instance_method() must be called with Class instance as first argument (got nothing instead)
>>> Class.instance_method(a)
2
>>> b = 0
>>> a.static_method(b)
1
>>> a.static_method(a.c) # Static method does not have direct access to 
>>>                      # class or instance properties.
3
>>> Class.c        # a.c above was passed by value and not by reference.
2
>>> a.c
2
>>> a.c = 5        # The connection between the instance
>>> Class.c        # and its class is weak as seen here.
2
>>> Class.class_method()
3
>>> a.c
5 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-22T11:00:29.873

method_two 不起作用，因为您正在定义一个成员函数，但没有告诉它该函数是什么成员。如果你执行最后一行，你会得到：

```
>>> a_test.method_two()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: method_two() takes no arguments (1 given) 
```

如果要为类定义成员函数，则第一个参数必须始终为“self”。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-09-18T22:51:16.327

上面Armin Ronacher的准确解释，扩展了他的答案，以便像我这样的初学者很好地理解它：

类中定义的方法的差异，无论是静态方法还是实例方法（还有另一种类型 - 类方法 - 此处未讨论，因此跳过它），在于它们是否以某种方式绑定到类实例。例如，说方法是否在运行时接收到对类实例的引用

```
class C:
    a = [] 
    def foo(self):
        pass

C # this is the class object
C.a # is a list object (class property object)
C.foo # is a function object (class property object)
c = C() 
c # this is the class instance 
```

类对象的`__dict__`字典属性保存对类对象的所有属性和方法的引用，因此

```
>>> C.__dict__['foo']
<function foo at 0x17d05b0> 
```

方法 foo 可以像上面那样访问。这里需要注意的重要一点是，python 中的所有内容都是一个对象，因此上面字典中的引用本身也指向其他对象。让我将它们称为类属性对象 - 或为简洁起见，在我的回答范围内称为 CPO。

如果 CPO 是描述符，则 python 解释器调用`__get__()`CPO 的方法来访问它包含的值。

为了确定 CPO 是否是描述符，python 解释器检查它是否实现了描述符协议。实现描述符协议就是实现3个方法

```
def __get__(self, instance, owner)
def __set__(self, instance, value)
def __delete__(self, instance) 
```

例如

```
>>> C.__dict__['foo'].__get__(c, C) 
```

在哪里

*   `self`是 CPO（它可以是列表、str、函数等的实例）并且由运行时提供
*   `instance`是定义此 CPO 的类的实例（上面的对象“c”），需要我们明确提供
*   `owner`是定义此 CPO 的类（上面的类对象“C”），需要我们提供。然而，这是因为我们在 CPO 上调用它。当我们在实例上调用它时，我们不需要提供它，因为运行时可以提供实例或其类（多态性）
*   `value`是 CPO 的预期值，需要由我们提供

并非所有 CPO 都是描述符。例如

```
>>> C.__dict__['foo'].__get__(None, C)
<function C.foo at 0x10a72f510> 
>>> C.__dict__['a'].__get__(None, C)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'list' object has no attribute '__get__' 
```

这是因为列表类没有实现描述符协议。

因此，参数 self in`c.foo(self)`是必需的，因为它的方法签名实际上是 this `C.__dict__['foo'].__get__(c, C)`（如上所述，不需要 C，因为它可以被发现或多态化）这也是如果你不传递所需的实例参数，你会得到 TypeError 的原因。

如果您注意到该方法仍然通过类 Object C 引用，并且与类实例的绑定是通过将​​实例对象形式的上下文传递给此函数来实现的。

这非常棒，因为如果您选择不保留上下文或不绑定到实例，则所需要做的就是编写一个类来包装描述符 CPO 并覆盖其`__get__()`方法以不需要上下文。这个新类就是我们所说的装饰器，通过关键字应用`@staticmethod`

```
class C(object):
  @staticmethod
  def foo():
   pass 
```

新包装的 CPO 中缺少上下文`foo`不会引发错误，可以通过以下方式进行验证：

```
>>> C.__dict__['foo'].__get__(None, C)
<function foo at 0x17d0c30> 
```

静态方法的用例更多的是命名空间和代码可维护性（将其从类中取出并使其在整个模块中可用等）。

尽可能编写静态方法而不是实例方法可能会更好，除非您当然需要对方法进行上下文化（如访问实例变量、类变量等）。一个原因是通过不保留对对象的不需要的引用来简化垃圾收集。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-22T11:00:59.157

对 method_two 的调用将抛出一个异常，因为 Python 运行时将自动传递它不接受 self 参数。

如果要在 Python 类中创建静态方法，请使用`staticmethod decorator`.

```
Class Test(Object):
  @staticmethod
  def method_two():
    print "Called method_two"

Test.method_two() 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-22T11:10:01.613

这是一个错误。

首先，第一行应该是这样的（注意大写）

```
class Test(object): 
```

每当您调用类的方法时，它都会将自身作为第一个参数（因此名称为 self），并且 method_two 会给出此错误

```
>>> a.method_two()
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
TypeError: method_two() takes no arguments (1 given) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-22T11:11:49.783

第二个不起作用，因为当你像那样调用它时，python 在内部尝试使用 a_test 实例作为第一个参数来调用它，但是你的 method_two 不接受任何参数，所以它不起作用，你会得到一个运行时错误。如果您想要等效于静态方法，则可以使用类方法。与 Java 或 C# 等语言中的静态方法相比，Python 中对类方法的需求要少得多。大多数情况下，最好的解决方案是在模块中使用类定义之外的方法，这些方法比类方法更有效。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-01-19T06:18:41.820

请阅读 Guido [First Class 中的所有](http://python-history.blogspot.in/2009/02/first-class-everything.html)文档，清楚地解释了 Unbound, Bound 方法是如何诞生的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-01-18T19:08:10.367

的定义`method_two`无效。当你打电话时`method_two`，你会`TypeError: method_two() takes 0 positional arguments but 1 was given`从口译员那里得到。

当您调用实例方法时，实例方法是一个有界函数`a_test.method_two()`。它自动接受`self`指向 的实例的`Test`，作为它的第一个参数。通过`self`参数，实例方法可以在同一个对象上自由地访问属性和修改属性。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-02-13T10:28:26.013

**未绑定方法**

未绑定方法是尚未绑定到任何特定类实例的方法。

**绑定方法**

绑定方法是绑定到类的特定实例的方法。

正如其[在此处](https://medium.com/@gumussoyku/bound-unbound-methods-in-python-cb4f124a6482)记录的那样，self 可以根据函数是绑定的、未绑定的还是静态的来引用不同的事物。

看看下面的例子：

```
class MyClass:    
    def some_method(self):
        return self  # For the sake of the example

>>> MyClass().some_method()
<__main__.MyClass object at 0x10e8e43a0># This can also be written as:>>> obj = MyClass()

>>> obj.some_method()
<__main__.MyClass object at 0x10ea12bb0>

# Bound method call:
>>> obj.some_method(10)
TypeError: some_method() takes 1 positional argument but 2 were given

# WHY IT DIDN'T WORK?
# obj.some_method(10) bound call translated as
# MyClass.some_method(obj, 10) unbound method and it takes 2 
# arguments now instead of 1 

# ----- USING THE UNBOUND METHOD ------
>>> MyClass.some_method(10)
10 
```

由于我们没有使用类实例——`obj`在最后一次调用中，我们可以说它看起来像一个静态方法。

`MyClass.some_method(10)`如果是这样，调用和调用用装饰器装饰的静态函数有什么区别`@staticmethod`？

通过使用装饰器，我们明确地表明该方法将在没有首先为其创建实例的情况下被使用。通常人们不会期望在没有实例的情况下使用类成员方法，并且访问它们可能会导致可能的错误，具体取决于方法的结构。

此外，通过添加`@staticmethod`装饰器，我们也可以通过对象进行访问。

```
class MyClass:    
    def some_method(self):
        return self    

    @staticmethod
    def some_static_method(number):
        return number

>>> MyClass.some_static_method(10)   # without an instance
10
>>> MyClass().some_static_method(10)   # Calling through an instance
10 
```

你不能用实例方法做上面的例子。您可能会在第一个（就像我们之前所做的那样）中幸存下来，但第二个将被转换为一个未绑定的调用`MyClass.some_method(obj, 10)`，这将引发 a`TypeError`因为实例方法接受一个参数并且您无意中尝试传递两个参数。

然后，你可能会说，“如果我可以通过实例和类调用静态方法，`MyClass.some_static_method`并且`MyClass().some_static_method`应该是相同的方法。” 是的！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-05-01T15:17:46.860

绑定方法=实例方法

未绑定方法 = 静态方法。

# linq - 使用 IQueryable 的设计模式

> ID：114222
> 
> 赞同：14
> 
> 时间：2008-09-22T10:53:33.323
> 
> 标签：linq, design-patterns, .net-3.5, iqueryable

随着 .NET 3.5 和`IQueryable<T>`接口的引入，将会出现新的模式。虽然我已经看到了规范模式的许多实现，但我还没有看到使用这种技术的许多其他模式。Rob Conery 的 Storefront 应用程序是另一个具体示例，使用`IQueryable<T>`它可能会导致一些新模式。

**`IQueryable<T>`从有用的界面中出现了哪些模式？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-22T12:39:40.463

它当然也使存储库模式更易于实现。您基本上可以创建一个通用存储库：

```
public class LinqToSqlRepository : IRepository
{
   private readonly DataContext _context;

   public LinqToSqlRepository(DataContext context)
   {
       _context = context;
   }

   public IQueryable<T> Find<T>()
   {
       return _dataContext.GetTable<T>(); // linq 2 sql
   }

   /** snip: Insert, Update etc.. **/
} 
```

然后将其与 linq 一起使用：

```
var query = from customers in _repository.Find<Customer>() 
            select customers; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-14T14:09:42.760

我喜欢存储库过滤器模式。它允许您在不牺牲性能的情况下将关注点与中间层和数据端层分开。

您的数据层可以专注于简单的 list-get-save 样式操作，而您的中间层可以利用 IQueryable 的扩展来提供更强大的功能：

存储库（数据层）：

```
public class ThingRepository : IThingRepository
{
    public IQueryable<Thing> GetThings()
    {
        return from m in context.Things
               select m; // Really simple!
    }
} 
```

过滤器（服务层）：

```
public static class ServiceExtensions
{
    public static IQueryable<Thing> ForUserID(this IQueryable<Thing> qry, int userID)
    {
        return from a in qry
               where a.UserID == userID
               select a;
    }
} 
```

服务：

```
public GetThingsForUserID(int userID)
{
    return repository.GetThings().ForUserID(userID);
} 
```

这是一个简单的示例，但可以安全地组合过滤器来构建更复杂的查询。性能得到了保存，因为在所有过滤器都内置到查询中之前列表没有具体化。

我喜欢它，因为我不喜欢特定于应用程序的存储库！

# php - PHP：对象上的array_map？

> ID：114229
> 
> 赞同：9
> 
> 时间：2008-09-22T10:56:07.670
> 
> 标签：php, oop

我正在尝试编写一个函数来格式化对象中的每个（字符串）成员/变量，例如使用回调函数。我不知道变量名，所以它必须适用于所有类的对象。

我怎样才能实现与对象相似`array_map`或`array_walk`具有对象的东西？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-22T10:57:57.430

使用[get_object_vars()](http://nl3.php.net/manual/en/function.get-object-vars.php)获取成员的关联数组，并使用您提到的函数。

顺便说一句，您也可以像在数组上一样对对象执行 foreach，这有时也很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T11:06:58.767

您可以使用`get_object_vars()`，但如果您需要更多控制，请尝试使用[反射](http://web.archive.org/web/20090228224836/http://www.php.net:80/manual/en/language.oop5.reflection.php)。它比`get_object_vars()`（或`get_class_methods()`就此而言）慢，但它更强大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T11:00:00.547

您正在寻找[get_object_vars](http://www.php.net/manual/en/function.get-object-vars.php) / [get_class_methods](http://www.php.net/manual/en/function.get-class-methods.php)（第一个获取变量，第二个获取方法名称）。

# gdb - Solaris 核心转储分析

> ID：114236
> 
> 赞同：20
> 
> 时间：2008-09-22T10:57:11.737
> 
> 标签：gdb, solaris, coredump, dbx

我使用 pstack 分析 Solaris 中的核心转储文件

我还能如何分析来自 solaris 的核心转储？

可以使用哪些命令来执行此操作？

从转储中可以获得哪些其他信息？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-22T11:44:40.983

您可以使用 Solaris 模块化调试器、mdb 或 dbx。mdb 附带 SUNWmdb（或 SUNWmdb x，对于 64 位版本）软件包。

核心文件是您正在运行的进程在崩溃时的映像。

根据您的应用程序是否使用调试标志编译，您将能够查看堆栈的图像，从而了解哪个函数导致核心，获取传递给该函数的参数的值，值变量，分配的内存区域......

在最近的 Solaris 版本上，您可以使用 coreadm 命令配置核心文件将包含的内容；例如，您可以将进程附加到映射的内存段。

请参阅[MDB 文档](http://docs.oracle.com/cd/E19082-01/817-2543/)和[dbx 文档](http://docs.oracle.com/cd/E19422-01/819-3683/)。一旦您了解了 GDB的基础知识， [GDB 快速参考](http://users.ece.utexas.edu/~adnan/gdb-refcard.pdf)卡也会很有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T06:02:31.340

如果核心转储来自您编写或构建的程序，则使用您通常用来调试正在运行的应用程序的任何调试器。他们都应该能够加载核心文件。如果您对调试器不挑剔，并且您使用的是 Solaris，我会推荐 dbx。这将有助于获得带有补丁的最新 FCS 版本的 Sun Studio，或者最新的 Express 版本的 Sun Studio。如果您可以将核心文件加载到创建核心文件的同一系统上的调试器中，这也非常有帮助。如果库中的代码与创建核心文件时不同，则堆栈跟踪在通过库时将无用。调试器还使用 OS 帮助程序库来理解 libthread 和运行时链接器数据结构，因此如果您需要在不同的机器上加载核心文件，您 我要确保安装在操作系统上的帮助程序库与操作系统中的系统数据结构相匹配。您可以在几年前编写的白皮书中找到您从未想知道的关于这些系统库的所有信息。

[http://developers.sun.com/solaris/articles/DebugLibraries/DebugLibraries_content.html](http://developers.sun.com/solaris/articles/DebugLibraries/DebugLibraries_content.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T06:04:31.443

我想这个问题的任何答案都应该从一个简单的食谱开始：

对于 dbx，配方是：

```
% dbx a.out core
(dbx) where
(dbx) threads
(dbx) thread t@3
(dbx) where 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T05:09:40.520

pflags命令还可用于确定每个线程在核心转储时所处的状态*。*通过这种方式，您通常可以查明问题所在。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-04-09T14:04:05.363

我建议先尝试 gdb，因为在我看来，它比原生 Solaris 调试器更容易学习基本任务。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-22T11:39:39.157

可以使用 GDB。

它可以发出在转储之前尝试的调用。

[http://sourceware.org/gdb/](http://sourceware.org/gdb/)

[http://en.wikipedia.org/wiki/GDB](http://en.wikipedia.org/wiki/GDB)

拥有源代码很棒，如果您可以更好地重现错误，因为您可以使用它来调试它。

过去对我很有帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T10:54:25.353

使用 dbx 调试器附加到进程映像：

dbx [executable_file_name] [coredump_file_name]

重要的是，自从核心被转储（即它没有被重建）以来，可执行文件没有任何变化。

您可以通过 dbx 命令“where”查看堆栈跟踪以了解程序在何处崩溃。

您可以使用命令“up”和“down”在堆栈上上下移动，或者使用“frame [number]”跳转到确切的堆栈帧，数字在“where”的输出中看到。

您可以使用“print [expr]”命令打印变量或表达式的值。

玩得开心。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-01-30T17:04:49.863

我在我的 solaris x86 机器上找到了 dbx

```
/opt/SUNWspro/bin/dbx 
```

干杯!

# java - 考虑到对象封装，getter 是否应该返回一个不可变的属性？

> ID：114237
> 
> 赞同：18
> 
> 时间：2008-09-22T10:57:30.053
> 
> 标签：java, oop

当 getter 返回一个属性（例如返回`List`其他相关对象的 a）时，该列表及其对象是否应该是不可变的，以防止类外部的代码在主父对象不知道的情况下更改这些对象的状态？

例如，如果一个`Contact`对象有一个`getDetails`getter，它返回一个对象，那么任何调用该 getter 的代码`List`：`ContactDetails`

1.  可以在对象不知道的`ContactDetail`情况下从该列表中删除对象。`Contact`
2.  可以在对象不知道的情况下更改每个`ContactDetail`对象。`Contact`

那么我们应该在这里做什么呢？我们应该只信任调用代码并轻松返回可变对象，还是硬着头皮为每个可变类创建一个不可变类？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-22T11:04:55.353

这是您是否应该在代码中“防御”的问题。如果您是您班级的（唯一）用户并且您信任自己，那么绝对不需要不变性。然而，如果这段代码无论如何都需要工作，或者你不信任你的用户，那么让所有外部化的东西都变得不可变。

也就是说，我创建的大多数属性都是可变的。一个偶尔的用户搞砸了这个，但又是他/她的错，因为它清楚地记录了突变不应该通过通过 getter 接收的可变对象发生。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-22T11:16:20.193

这取决于上下文。如果列表打算是可变的，那么当 List 有自己的完美 API 时，用改变它的方法来混淆主类的 API 是没有意义的。

但是，如果主类无法处理突变，那么您将需要返回一个不可变列表 - 并且列表中的条目本身也可能需要是不可变的。

但是不要忘记，您可以返回一个自定义 List 实现，该实现知道如何安全地响应突变请求，无论是通过触发事件还是直接执行任何所需的操作。事实上，这是一个使用内部类的好时机的经典例子。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-22T10:59:54.273

如果您可以控制调用代码，那么最重要的是您所做的选择在所有正确的地方都有很好的记录。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-24T17:56:30.433

Joshua Bloch 在其出色的“Effective Java”一书中说，在返回此类内容时，您应该始终制作防御性副本。这可能有点极端，尤其是在 ContactDetails 对象不可克隆的情况下，但这始终是安全的方法。如果有疑问总是倾向于代码安全而不是性能 - 除非分析表明克隆是一个真正的性能瓶颈。

实际上，您可以添加多个级别的保护。您可以简单地返回成员，这实质上是让任何其他类访问您的类的内部。非常不安全，但公平地说，它被广泛使用。如果您想更改内部结构以便将 ContactDetails 存储在 Set 中，这也会给您带来麻烦。您可以返回一个新创建的列表，其中包含对内部列表中相同对象的引用。这更安全——另一个类不能删除或添加到列表中，但它可以修改现有对象。第三，返回一个新创建的列表，其中包含 ContactDetails 对象的副本。这是安全的方法，但可能很昂贵。

**我会以更好的方式做到这一点。**根本不返回列表 - 而是返回列表上**的迭代器**。这样您就不必创建新列表（List 具有获取迭代器的方法），但外部类不能修改列表。它仍然可以修改项目，除非您编写自己的迭代器来根据需要克隆元素。如果您稍后切换到在内部使用另一个集合，它仍然可以返回一个迭代器，因此不需要外部更改。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-22T13:41:56.490

在 Java 中的 Collection、List、Set 或 Map 的特定情况下，很容易使用以下方法将不可变视图返回给类`return Collections.unmodifiableList(list);`

当然，如果支持数据仍有可能被修改，那么您需要制作列表的完整副本。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-22T11:04:50.550

取决于上下文，真的。但一般来说，是的，应该尽可能编写防御性代码（返回**数组副本**，返回**集合周围的只读包装器**等）。无论如何，都应该**清楚地记录在案**。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-22T11:03:12.457

我曾经返回列表的只读版本，或者至少返回一个副本。但是列表中包含的每个对象都必须是可编辑的，除非它们在设计上是不可变的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-22T11:08:04.550

我想你会发现每个 gettable 都是不可变的是非常罕见的。

您可以做的是在此类对象中更改属性时触发事件。也不是完美的解决方案。

文档可能是最实用的解决方案；）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-22T12:00:29.043

您的首要任务应该是遵循得墨忒耳法则或“告诉不要问”；告诉对象实例做什么，例如

```
contact.print( printer ) ;  // or
contact.show( new Dialog() ) ; // or
contactList.findByName( searchName ).print( printer ) ; 
```

面向对象的代码告诉对象做事。程序代码获取信息，然后根据该信息进行操作。要求一个对象揭示其内部细节会破坏封装，它是过程代码，而不是健全的 OO 编程，正如 Will 已经说过的那样，这是一个有缺陷的设计。

如果您遵循得墨忒耳法则方法，对象状态的任何变化都是通过其定义的接口发生的，因此副作用是已知和可控的。你的问题消失了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-22T11:17:29.600

当我刚开始的时候，我仍然深受 HIDE YOUR DATA OO PRINCIPALS LOL 的影响。我会坐下来思考如果有人改变了一个属性暴露的对象的状态会发生什么。我应该让它们只读给外部调用者吗？我不应该暴露他们吗？

收藏品将这些焦虑发挥到了极致。我的意思是，有人可以在我不看的时候删除集合中的所有对象！

我最终意识到，如果你的对象对它们的外部可见属性和它们的类型持有如此紧密的依赖关系，以至于如果有人在一个不好的地方触摸它们，你就会繁荣起来，那么你的架构就有缺陷。

有正当理由使您的外部属性只读且它们的类型不可变。但这是极端情况，不是典型的情况，恕我直言。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-23T20:33:12.983

首先，setter 和 getter 表示糟糕的 OO。通常，OO 的想法是您要求对象为您做某事。设置和获取是相反的。Sun 应该想出一些其他方法来实现 Java bean，这样人们就不会接受这种模式并认为它是“正确的”。

其次，你拥有的每个对象本身都应该是一个世界——通常，如果你要使用 setter 和 getter，它们应该返回相当安全的独立对象。这些对象可能是不可变的，也可能不是，因为它们只是一等对象。另一种可能性是它们返回始终不可变的本机类型。所以说“应该 setter 和 getter 返回不可变的东西”并没有太大的意义。

至于制作不可变对象本身，您实际上应该始终将对象中的成员设为 final，除非您有充分的理由不这样做（Final 应该是默认值，“mutable”应该是覆盖该默认值的关键字）。这意味着只要有可能，对象将是不可变的。

至于您可能传递的预定义准对象，我建议您将诸如集合和值组之类的东西用自己的方法包装到自己的类中。我几乎从不绕过未受保护的集合，仅仅因为您没有就如何使用它提供任何指导/帮助，而精心设计的对象的使用应该是显而易见的。安全性也是一个因素，因为允许某人访问您类中的集合几乎不可能确保该类始终有效。

# c++ - 托管 C++ 和 C++ 之间的区别

> ID：114238
> 
> 赞同：53
> 
> 时间：2008-09-22T10:57:33.140
> 
> 标签：c++, visual-c++, programming-languages, managed-c++

第二个问题是：我什么时候使用这两者中的哪一个？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2008-09-22T11:05:01.593

如果未指定，C++ 是非托管 C++，编译为机器代码。在非托管 C++ 中，您必须手动管理内存分配。

托管 C++ 是 Microsoft 发明的一种语言，可编译为由 .NET Framework 运行的字节码。它使用与 C++ 基本相同的语法（因此得名），但编译方式与 C# 或 VB.NET 相同；基本上只有语法改变，例如使用'->'指向对象的成员（而不是C#中的'.'），使用'::'作为命名空间等。

托管 C++ 旨在简化从经典 C++ 到 .NET Framework 的转换。它不适用于启动新项目（首选 C#）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-22T11:30:46.993

“托管 C++”是指包含在 Visual Studio.NET/Visual Studio.NET 2003 中的一种语言。它已[被弃用](https://en.wikipedia.org/wiki/Managed_Extensions_for_C%2B%2B#.E2.80.A6to_C.23)，最新的 .NET C++ 是 C++/CLI。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-22T20:01:25.487

您可以使用两种不同的方式编写原生 C++ 代码。*第一种是直接编译为机器代码，只在您和平台*（*硬件*）之间使用操作系统。第二个本机编码是使用[MFC](https://en.wikipedia.org/wiki/Microsoft_Foundation_Class_Library)（Microsoft 基础类）完成的。除了使用 MFC 之外，这与第一个示例相同。

托管 C++ 使用 CLR（公共语言运行时）。CLR 与 .NET 框架类库组成了 .NET 框架。此托管 C++/CLI 标准使用 .NET 框架和[CIL](https://en.wikipedia.org/wiki/Common_Intermediate_Language)（Microsoft 中间语言）。该标准仅在使用即时编译器执行程序时通过映射到机器代码来工作。如果您的代码将在不同的硬件平台上运行，则托管代码的使用会容易得多。与所有事情一样，为了方便需要付出一点代价，因为本机代码会运行得更快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-22T11:04:45.510

我想你应该看看[这个问题](https://stackoverflow.com/questions/57923/what-exactly-is-managed-code)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-22T14:51:15.390

当您想从托管代码中使用本机 C++ 类库时，您将使用托管 C++。在这种情况下，您将非托管类包装在托管 C++ 中，然后在任何 CLR 语言中使用它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T10:59:45.740

托管 C++ 意味着内存分配、管理、垃圾收集由虚拟机处理。而在“常规”C++ 中，您将不得不分配和释放内存。

# sql - SQL：别名列上的内连接

> ID：114242
> 
> 赞同：4
> 
> 时间：2008-09-22T10:58:22.983
> 
> 标签：sql, inner-join

以前我曾要求从字段中删除文本并将其转换为 int，这可以成功。但是现在，我想对这个新值进行 INNER JOIN。

所以我有这个：

```
SELECT CONVERT(int, SUBSTRING(accountingTab.id, PATINDEX('%[0-9]%', accountingTab.id), 999)) 
AS 'memId',  userDetails.title, userDetails.lname 
FROM accountingTab INNER JOIN
(SELECT id, title, first, last FROM memDetTab) AS userDetails ON memID = userDetails.id 
```

然后我得到 Invalid Column Name`memID`错误。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-22T11:09:47.870

您可以重复整个表达式或反转您的联接：

```
 SELECT *
FROM memDetTab
    JOIN (SELECT CONVERT(int, SUBSTRING(accountingTab.id, PATINDEX('%[0-9]%', accountingTab.id), 999)) AS 'memId', userDetails.title, userDetails.lname
FROM accountingTab) subquery
    ON subquery.memID = memDetTab.ID 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-22T11:02:23.550

代替 memId，重复整个表达式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T11:05:48.800

如果你必须这样做，你就有设计问题。如果可以的话，我建议您需要重构您的表格或关系。

# asp.net - 如何在经典 asp、.NET 和 javascript 之间共享变量值？

> ID：114260
> 
> 赞同：0
> 
> 时间：2008-09-22T11:04:32.673
> 
> 标签：asp.net, session, asp-classic, httphandler

我`IHttpHandler`在 .NET C# 中创建了一个将 html 片段返回到经典 asp 页面的方法。

经典的 asp 页面`IHttpHandler`通过使用 vbscript 中的基本 http 请求`ServerXMLHTTP`或 JavaScript 中的 Ajax 调用与通信。

现在，我需要一种方法来与 .NET 应用程序共享我在 vbscript 中但在 javascript 中没有的变量。

首先，在经典的 asp 和 .net 之间共享一个变量不是问题，因为我可以将它添加到 http 请求中。因为该变量在 javascript 中不可用，但是在这种情况下我不能这样做。

我的想法是，我可以将变量缓存在 .NET 应用程序中，并将缓存的版本用于 javascript 调用。但要使其正常工作，我需要一种方法来唯一标识 .NET 中的“客户端”......

我尝试添加`System.Web.SessionState.IRequiresSessionState`到我的 HttpHandler 并使用 SessionId 但这不起作用，因为对 HttpHandler 的每次调用似乎都会获得一个新 ID。

我的想法正确吗？我在这里有什么选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T03:54:23.593

您可以将您的值放入 cookie 中，然后您可以使用 javascript 读取并用它做任何事情，包括将其发送到 .net 应用程序的请求中......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T11:16:52.160

如何在页面上有一个隐藏变量，您可以在其中存储来自您的 asp 页面的服务器端 vb 脚本的变量值。

然后，您可以使用 Javascript 查询此变量以通过您的 ajax 调用发送到 Asp.Net 处理程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T07:43:00.277

最后我对这个问题的解决方案如下：

1.  我将变量与正常的 ws 请求一起发送到我的网络服务
2.  我将变量值存储在 web 服务上的哈希表中，并在隐藏的 html 对象中将哈希键返回给客户端（为此我使用了 head`<meta>`元素）
3.  在 javascript 中，我读取了该哈希值并将其作为标头值附加到 http-request。
4.  当 Web 服务看到该哈希键时，他会在持久哈希表中查找相应的变量值。

可能不是最好的解决方案，但在我的情况下似乎效果很好......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-30T03:47:01.090

我也推荐一个饼干。您也可以从数据库中加载值，但这太过分了。

# asp.net - 验证视图状态时生成 Http 异常

> ID：114266
> 
> 赞同：1
> 
> 时间：2008-09-22T11:05:53.167
> 
> 标签：asp.net

每当我单击回发控件时，我都会收到以下错误

```
HttpException (0x80004005): Validation
of viewstate  MAC failed. If this
application is hosted by a Web  Farm
or cluster, ensure that  configuration
specifies the same validationKey and
validation  algorithm. AutoGenerate
cannot be used in a cluster. 
```

我没有使用 Web Farm 或集群服务器。我什至尝试将页面属性***EnableViewStateMac***设置为 false，但它会更改错误消息说明

```
The state information is invalid for 
this page and might be corrupted. 
```

什么可能是错的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T11:13:29.750

这里有一篇关于此的文章：http: [//blogs.msdn.com/tom/archive/2008/03/14/validation-of-viewstate-mac-failed-error.aspx](http://blogs.msdn.com/tom/archive/2008/03/14/validation-of-viewstate-mac-failed-error.aspx)。

基本问题是您的页面在执行回发之前尚未完成加载。

上面列出的文章中提供了几种不同的解决方案： 1\. 将 enableEventValidation 设置为 false 并将 viewStateEncryptionMode 设置为 Never 2\. 将表单标记为禁用，然后在加载完成后在脚本中启用它。3.覆盖页面的渲染事件，将加密视图状态和事件验证的隐藏字段放置在表单顶部。

但主要问题是页面加载缓慢，应该修复（如果可能的话尽快）。应用上面的解决方案 2 也是很好的，并且总会有触发快乐的用户，无论页面加载速度有多快，他们都会更快地点击页面加载:-)。

/安德烈亚斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T11:36:35.450

我在自定义构建 ASP.NET 控件时遇到了同样的问题，该控件在每个 POST / GET 请求上动态重新加载和重建。因此，发送 POST 请求的页面与接收响应的页面不同。如果您使用任何自定义或数据绑定控件，请仔细查看它们在 POST 后的行为。

# asp.net - 是否有任何实用程序可以帮助我重构 CSS

> ID：114272
> 
> 赞同：23
> 
> 时间：2008-09-22T11:07:05.677
> 
> 标签：asp.net, css, refactoring

我正在使用一些写得很糟糕的 CSS，至少可以这么说。我不是设计/CSS 专家，但我至少了解CSS 中的**C。**虽然 VS-2008 内部的内置 CSS 支持比以前的版本有了很大改进，但它仍然不能完全满足我的要求。

我想知道是否有人知道一个好的程序或实用程序可以帮助我重构和清理我的 CSS，就像 ReSharper 允许用 C# 做的那样。

一些很不错的功能：

*   检查 CSS 文件并确定提取常用样式（如字体样式、颜色等）的方法...
*   VS-2008 的插件会很棒！
*   检查标记文件并就改进当前使用的类和样式提出一些建议。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-22T11:19:17.100

[Dust-Me Selectors Firefox 扩展](https://addons.mozilla.org/en-US/firefox/addon/5392)可以扫描网站并告诉您使用了哪些 CSS，哪些没有使用。删除未使用的 CSS 是重构的第一步。

我经常发现，当从网站中删除某些部分时，HTML 会被删除，但 CSS 不会。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-22T11:15:19.527

[TopStyle](http://www.newsgator.com/Individuals/TopStyle/Default.aspx)很受欢迎，而且一直是我听到推荐的。它有关于样式等的建议。

我使用[Aptana](http://www.aptana.com/)，但这不会进行重构，只是标记错误并允许您针对某些浏览器。使用这本不错的 CSS 书籍可能会有所帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-22T11:13:27.393

[Firebug](http://getfirebug.com/)是一个非常好的 Firefox 扩展，它允许您检查哪些 CSS 声明对文档树中的哪个 DOM 元素是活动的。

虽然它没有提出任何改进建议，但它在手动调试/简化 CSS 代码时有很大帮助。

[Web Developer](http://chrispederick.com/work/web-developer/)扩展也是一个很大的帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-22T11:17:02.813

如果您使用的是 ASP.NET 2.0，那就有[ReFactor！对于 ASP.NET](http://www.devexpress.com/Products/Visual_Studio_Add-in/RefactorASP/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-22T12:56:08.880

过去我在使用 [Stylizer](http://www.skybound.ca/stylizer/)时运气不错。它更好，只需 TopStyle 的 1/6。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-22T14:17:21.553

有一个名为 HAML 的 Ruby gem 附带一个名为 css2sass 的可执行文件。该可执行文件将 CSS 翻译成[SASS](http://haml.hamptoncatlin.com/docs/rdoc/classes/Sass.html)，这是一种基于 CSS 的元语言，可以更容易地重构（通过更好地说明选择器之间的关系）。可能值得一看。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-22T13:11:40.447

我曾经使用 WestCiv 的[StyleMaster](http://www.westciv.com/style_master/index.html)，这是一个非常好的 CSS 编辑器/检查器/调试器应用程序。将它与前面提到的 Firebug 结合起来，您就会情不自禁地掌握 CSS。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-09-29T20:11:02.227

我尝试使用[Less for .NET](http://www.dotlesscss.com)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-05-05T17:57:43.997

我可能有点晚了，但是 ReSharper 6 早期访问预览版 (EAP) 可以为您做到这一点！

在 CSS 文件中，输入“#”将自动完成项目中的每个 ID。与句号“。”相同。列出你所有的课程。

最好的部分：当您重命名选择器时，它将在项目范围内重命名。它使重构 CSS 更快，即使不是很愉快。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-22T11:19:04.277

我喜欢 Expression Web 的 CSS 工具。但它对于最小化或统一你的 CSS 并没有多大作用。您必须了解 CSS 的工作原理才能正确使用它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-22T11:22:48.307

Firefox 的 EditCSS 非常棒。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-22T13:12:37.607

这个网站至少有助于整理和最小化你的规则：[http](http://www.cleancss.com/)
://www.cleancss.com/ 它不会让你到达你想去的地方，但这是一个很好的第一步。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-22T13:21:31.843

也许[CssTidy](http://floele.flyspray.org/csstidy/css_optimiser.php)或[CssOptimiser](http://www.cssoptimiser.com/)可以帮助清理和缩小

# python - 保存确认页面在哪里可以挂接到 Django 管理员？（类似于删除确认）

> ID：114283
> 
> 赞同：9
> 
> 时间：2008-09-22T11:11:12.390
> 
> 标签：python, django

我想在管理员中保存某些模型之前模拟删除确认页面的行为。就我而言，如果我更改一个对象，则应删除某些其他对象，因为它们取决于对象现在已过时的状态。

我知道在哪里实现实际的级联更新（在父模型的保存方法内），但我没有看到一种快速的方法来要求用户确认（如果他们决定不保存则回滚）。我想我可以直接在 save 方法中实现一些奇怪的确认逻辑（有点像两阶段保存），但这似乎......丑陋。

有什么想法，甚至是对 django 代码库的一般指针？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-22T11:42:42.177

您可以重载`get_form`模型管理员的方法，并在生成的表单中添加一个额外的复选框，该表单必须是票证。或者，您可以覆盖`change_view`并拦截请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T11:36:43.313

我绝不是 Django 专家，所以这个答案可能会误导你。

开始四处寻找`django.contrib.admin.options.ModelAdmin`，尤其是`render_change_form`和`response_change`。我猜你需要为你的模型继承 ModelAdmin 并围绕这些方法提供所需的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T15:37:06.033

Have you considered overriding the administrative templates for the models in question? This [link](http://www.unessa.net/en/hoyci/2006/12/custom-admin-templates/) provides an excellent overview of the process. In this particular situation, having a finer-grained level of control may be the best way to achieve the desired result.

# mysql - 优化大型表的 SQL 查询

> ID：114284
> 
> 赞同：3
> 
> 时间：2008-09-22T11:11:49.270
> 
> 标签：mysql, sql, optimization

首先，这个问题是关于 MySQL 3.23.58 的，所以请注意。

我有 2 个具有以下定义的表：

```
Table A: id INT (primary), customer_id INT, offlineid INT

Table B: id INT (primary), name VARCHAR(255) 
```

现在，表 A 包含 65k+ 条记录，而表 B 包含约 40 条记录。除了2个主键索引外，A表的*offlineid*字段上也有一个索引。每个表的字段比较多，但是对于这个查询来说，它们是不相关的（我看到了，如果需要的话问一下）。

我首先看到了以下查询（*查询时间：~22 秒*）：

```
SELECT b.name, COUNT(*) AS orders, COUNT(DISTINCT(a.kundeid)) AS leads
FROM katalogbestilling_katalog a, medie b
WHERE a.offlineid = b.id
GROUP BY b.name 
```

现在，medie 中的每个 id 都与不同的名称相关联，这意味着您可以按 id 和名称进行分组。一些来回的测试让我解决了这个问题（*查询时间：~6 秒*）：

```
SELECT a.name, COUNT(*) AS orders, COUNT(DISTINCT(b.kundeid)) AS leads
FROM medie a
INNER JOIN katalogbestilling_katalog b ON a.id = b.offline
GROUP BY b.offline; 
```

有什么办法可以将它调低到“即时”时间（最坏的情况下最多 1 秒）？我在offlineid上添加了索引，但除此之外和查询的重新安排，我不知道该怎么办。EXPLAIN 查询显示查询正在使用 fileshort（原始查询也使用临时表）。欢迎所有建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T11:36:28.603

我猜你的主要问题是你使用的是旧版本的 MySQL。也许 MySQL 3 不喜欢 COUNT(DISTINCT())。

或者，它可能只是系统性能。你有多少内存？

尽管如此，MySQL 3 真的很老了。我至少会组装一个测试系统，以查看更新版本是否更快地运行该查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T12:10:34.557

不幸的是，mysql 3 不支持子查询。我怀疑通常是旧版本导致性能下降。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T11:37:15.510

kundeid是如何定义的？查看两个表的完整模式（由 MySQL 生成，即带有索引）以及 EXPLAIN 的输出以及上面的查询会很有帮助。

调试此问题并找出瓶颈的最简单方法是开始从查询中逐个删除字段并测量运行需要多长时间（请记住在运行每个查询之前运行 RESET QUERY CACHE）。在某些时候，您会看到执行时间显着下降，然后您就确定了瓶颈。例如：

```
SELECT b.name, COUNT(*) AS orders, COUNT(DISTINCT(a.kundeid)) AS leads
FROM katalogbestilling_katalog a, medie b
WHERE a.offlineid = b.id
GROUP BY b.name 
```

可能会变成

```
SELECT b.name, COUNT(DISTINCT(a.kundeid)) AS leads
FROM katalogbestilling_katalog a, medie b
WHERE a.offlineid = b.id
GROUP BY b.name 
```

消除“订单”成为瓶颈的可能性，或

```
SELECT b.name, COUNT(*) AS orders
FROM katalogbestilling_katalog a, medie b
WHERE a.offlineid = b.id
GROUP BY b.name 
```

从等式中消除“线索”。这将引导您朝着正确的方向前进。

***更新***：我不建议从最终查询中删除任何数据。只需删除它们以减少变量的数量，同时寻找瓶颈。鉴于你的评论，我明白了

```
SELECT b.name
FROM katalogbestilling_katalog a, medie b
WHERE a.offlineid = b.id
GROUP BY b.name 
```

还是表现不佳？这显然意味着它要么是未优化的联接，要么是分组依据（您可以通过删除分组依据进行测试 - 联接仍然很慢，在这种情况下，这是您需要解决的问题，或者它不会- 在这种情况下，显然是 GROUP BY)。你可以发布的输出

```
EXPLAIN SELECT b.name
FROM katalogbestilling_katalog a, medie b
WHERE a.offlineid = b.id
GROUP BY b.name 
```

以及表模式（以便于调试）？

***更新#2***

还有一种可能是您的所有索引都已正确创建，但是当涉及到最大内存使用量或其他类似的东西迫使它使用磁盘排序时，您的 mysql 安装配置错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T11:57:24.557

如果删除内部连接并用嵌套的 select 语句替换它，同时删除 count(*) 并将其替换为 PK，则性能可能会略有提高。

`SELECT a.name, COUNT(*) AS orders, COUNT(DISTINCT(b.kundeid)) AS leads FROM medie aINNER JOIN katalogbestilling_katalog b ON a.id = b.offline GROUP BY b.offline;`

将会

`SELECT a.name, COUNT(a.id) AS orders, (SELECT COUNT(kundeid) FROM katalogbestilling_katalog b WHERE b.offline = a.id) AS Leads FROM medie a;`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T12:12:49.327

好吧，如果查询运行的频率足以保证开销，请在表 A 上创建一个索引，其中包含查询中使用的字段。然后可以从索引中读取所有结果，而不必扫描表。

也就是说，我所有的经验都是基于 MSSQL，所以可能行不通。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T13:17:05.600

您的第二个查询很好，65k+40k 行不是很大:)

在 katalogbestilling_katalog.offline 列上放置一个新索引，它会为您运行得更快。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T14:59:36.040

您可以尝试确保在每个表上定义了覆盖索引。覆盖索引只是一个索引，其中在选择中请求或在连接中使用的每一列都包含在索引中。这样，引擎只需读取索引条目，而不必执行相应的行查找来获取任何未包含在索引中的请求列。我在 Oracle 和 MS SqlServer 中成功使用了这种技术。

查看您的查询，您可以尝试：

medie.id、medie.name 的
一个索引katalogbestilling_katalog.offlineid、katalogbestilling_katalog.kundeid 的一个索引

应按这些顺序为索引定义列。是否可以使用索引会有所不同。

更多信息在这里：

[涵盖索引信息](http://peter-zaitsev.livejournal.com/6949.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-22T15:13:53.057

尝试向 (offlineid, kundeid) 添加索引

我在目录中添加了 180,000 个 BS 行，在 medie 中添加了 30,000 个 BS 行（katalog offlineid's 对应于 medie id's 和一些重叠的 kundeid's 以确保区分计数有效）。请注意，这是在 mysql 5 上，所以如果你没有类似的结果，mysql 3 可能是你的罪魁祸首，但据我回忆，mysql 3 应该能够很好地处理这个问题。

我的桌子：

```
CREATE TABLE `katalogbestilling_katalog` (
  `id` int(11) NOT NULL auto_increment,
  `offlineid` int(11) NOT NULL,
  `kundeid` int(11) NOT NULL,
  PRIMARY KEY  (`id`),
  KEY `offline_id` (`offlineid`,`kundeid`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=60001 ;

CREATE TABLE `medie` (
  `id` int(11) NOT NULL auto_increment,
  `name` varchar(255) NOT NULL,
  PRIMARY KEY  (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=30001 ; 
```

我的查询：

```
SELECT b.name, COUNT(*) AS orders, COUNT(DISTINCT(a.kundeid)) AS leads
FROM medie b
INNER JOIN katalogbestilling_katalog a ON b.id = a.offlineid
GROUP BY a.offlineid
LIMIT 0 , 30

"Showing rows 0 - 29 (30,000 total, Query took 0.0018 sec)" 
```

并解释：

```
id:  1
select_type:    SIMPLE
table: a
type: index
possible_keys:  NULL
key:    offline_id
key_len:    8
ref: NULL
rows: 180000
Extra: Using index

id: 1
select_type:    SIMPLE
table: b
type: eq_ref
possible_keys:  PRIMARY
key:    PRIMARY
key_len:    4
ref: test.a.offlineid
rows: 1
Extra: 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-22T16:54:33.237

尝试优化服务器本身。有关最重要的变量，请参阅[Peter Zaitsev 的这篇文章。](http://www.mysqlperformanceblog.com/2006/09/29/what-to-tune-in-mysql-server-after-installation/ "安装后在 MySQL 服务器中调整什么")有些是 InnoDB 特定的，而另一些是针对 MyISAM 的。您没有提到您使用的引擎在这种情况下可能相关（例如，MyISAM 中的 count(*) 比 InnoDB 中的快得多）。 [这是来自同一个博客的另](http://www.mysqlperformanceblog.com/2006/06/08/mysql-server-variables-sql-layer-or-storage-engine-specific/ "MySQL 服务器变量 - 特定于 SQL 层或存储引擎。")一篇文章，以及来自[MySQL Forge的一篇文章](http://forge.mysql.com/wiki/ServerVariables "服务器变量")

# unit-testing - 您会为 J2ME 推荐哪些单元测试框架？

> ID：114288
> 
> 赞同：2
> 
> 时间：2008-09-22T11:12:22.763
> 
> 标签：unit-testing, testing, java-me

我对 J2ME 比较陌生，并且即将开始我的第一个严肃项目。我的测试经验也不是很深。我正在寻找 J2ME 的单元测试框架。

到目前为止，我已经看到了 J2MEUnit，但我现在不知道它的支持程度如何。我见过 JavaTest Harness，但我不知道这是否是矫枉过正。

请告诉我您建议的框架：
* 实施测试的简单性
* 支持的社区和工具
* 与应用程序认证过程的兼容性
* 与 IDE（Eclipse、NetBeans）的集成
* 您认为重要的其他方面......

谢谢，阿萨夫。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-22T12:31:40.933

[这是一家制作游戏的西班牙公司的博客条目](http://eskasiunblog.blogspot.com/2007/09/test-unitarios-en-j2me.html)。比较了很多框架，结论是（翻译过来的）：

*   MoMEUnit 提供有关测试的非常有用的信息。易于移植且与 Ant 兼容。一个缺点（或者可能没有），它需要每个测试类都有一个独特的测试方法，使用大量的继承。

*   JMEUnit。（J2MEUnit 和 JMUnit 的未来合并） JMUnit 不支持 Ant，但接口类似于 MoMEUnit。J2MEUnit 没有为测试提供非常有用的信息。两种框架中的测试创建都有些复杂。J2MEUnit 确实支持 Ant；这就是为什么两个框架的合并会非常有趣（他们已经在 int 上工作了一年多或少）

我的经验：我使用过 J2ME 单元，并且由于 J2ME 中缺少“反射”而设置测试装置很痛苦，但它们总是以相同的方式构建，因此模板可以节省大量时间。我打算这周试用 MoME Unit，只是为了检查它更简单的模型

J2ME 的一些测试单元框架：

*   [JMUnit](http://sourceforge.net/projects/jmunit/)
*   [MoME单元](http://momeunit.sourceforge.net/)
*   [J2ME 单元](http://j2meunit.sourceforge.net/)
*   [索尼爱立信 Movil Java 单元](https://developer.sonyericsson.com/getDocument.do?docId=85608)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-23T10:37:33.290

也看看 MockME。

www.mockme.org

来自他们的网站：“MockME 是 Java SE 的 Java ME 模拟对象。MockME 让您无需在手机上运行它们即可编写真正的单元测试。您甚至可以使用动态模拟对象框架，例如 EasyMock，它使您能够模拟任何对象Java ME! MockME 集成了同类最佳的单元测试工具，包括 JUnit、EasyMock 和 DDSteps。通过使 Java ME API 可模拟，您可以按照您真正想要的方式为您的 Java ME 应用程序编写单元测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-06T18:51:09.130

**J2SE 上的 MicroEmulator + JUnit**

我开始使用 JMUnit 之类的工具，但最近我切换到 J2SE 上的标准 JUnit + [MicroEmulator](http://www.microemu.org "微模拟器")。这类似于使用 MockME，但使用的是 MicroEmulator。我更喜欢 MicroEmulator，因为它具有组件的实际实现，并且您可以在其上运行整个 MIDlet。不过，我自己从未使用过 MockME。

我所有的非 GUI 单元测试都是通过简单地使用 MicroEmulator 作为库来运行的。这样做的好处是所有 JUnit 工具都可以无缝工作，特别是 Ant、Maven、大多数 IDE 和持续集成工具。由于它在 J2SE 上运行，因此您还可以使用泛型和 JUnit 注释等功能，这使得编写单元测试变得更好一些。

像 RecordStore 这样的一些组件在工作之前需要一些设置。这是通过 MIDletBridge.setMicroEmulator() 完成的。

使用 MicroEmulator 的另一个好处是可以自定义一些组件的实现，例如 RecordStore。我使用内存中的 RecordStore，它在每次测试之前重新创建，所以我确定测试独立运行。

**真实设备**

上述方法不会在任何真实设备上运行。但是，在我看来，只有 GUI 和验收测试需要在真实设备上运行。为此，像[mVNC](http://www.m-shell.net/products/mvnc.aspx "MVNC")和[T-Plan Robot](http://www.t-plan.com/robot/ "T-Plan 机器人")这样的工具可以在 Symbian 设备上使用（感谢[这篇博](http://mobileqa.blogspot.com/2008/04/automated-midlet-testing-on-symbian.html)文）。但是，我只能让 mVNC 通过蓝牙工作，而且速度很慢。

另一种方法可能是使用[诺基亚论坛远程设备访问 (RDA) 之](http://www.forum.nokia.com/Technology_Topics/Application_Quality/Testing/Remote_Device_Access/Instructions_for_RDA_Usage.xhtml "RDA")类的服务。我仍然需要调查这样的平台是否适合自动化测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T11:29:11.223

嗯...我自己还没有开发过移动应用程序，但我认为 J2MEUnit 是更好的选择，因为它基于原始的 JUnit，它有一个很大的社区并且得到大多数 IDE 的支持，所以它应该很容易运行至少那些测试它不直接依赖于 IDE 中的移动硬件。

更重要的可能是 J2MEUnit 与 ANT 集成，因此您可以在每次构建时运行您的测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T13:43:03.213

我发现的相关文档（发布问题后）是[Testing Wireless Java Applications](http://developers.sun.com/mobility/midp/articles/test/index.html)。它在文档结尾处描述了 J2MEUnit。

# testing - 我可以使用我的 WatiN 测试来进行压力测试吗？

> ID：114296
> 
> 赞同：2
> 
> 时间：2008-09-22T11:15:56.887
> 
> 标签：testing, watin, mbunit, stress-testing

[在我当前的项目中，我们正在使用WatiN](http://watin.sourceforge.net/)和[Mbunit](http://www.mbunit.com/)测试我们的 ASP.NET GUI 。

当我编写测试时，我意识到如果我们也可以将所有这些用于压力测试，那就太好了。目前我们正在使用[Grinder](http://grinder.sourceforge.net/)进行压力测试，但随后我们必须重新编写我们的案例脚本，这出于许多原因并不是那么好。

我一直在尝试找到一种工具，可以使用我现有的测试来在网站上创建负载并记录统计信息，但到目前为止我发现注意到了。有这样的工具还是有一种简单的方法来创建一个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T11:20:27.703

在运行 WatiN 测试时，我们的构建服务器出现问题，因为它经常会在尝试访问 Internet Explorer COM 组件时引发超时。在等待整个页面加载时，它似乎随机挂起。

鉴于此，我不建议将其用于压力测试，因为结果会不准确并且测试可能会很慢。

我会推荐[JMeter](http://jakarta.apache.org/jmeter/)对您的 GUI 发出的 HTTP 请求进行线程调用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-18T08:22:41.960

对于负载测试，有一个看起来很有前途的工具——LoadStorm。25 位用户免费。它具有零部署需求，因为这是基于云的服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T18:37:22.710

您可以为压力测试构建负载控制器。它可以进行您的 watin 测试并以多线程/多处理的方式运行它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T19:51:40.443

如果您习惯使用 Selenium 而不是 WatiN，请查看 BrowserMob 以[进行基于浏览器的负载测试](http://browsermob.com)。我是 Selenium RC 的作者之一，并启动了 BrowserMob 以提供一种新的负载测试方法。通过使用真实的浏览器，而不是模拟流量，测试最终更容易编写脚本和维护。

# database - Win32 API 函数定义是否以“数据库”/XML 格式提供？

> ID：114302
> 
> 赞同：3
> 
> 时间：2008-09-22T11:17:25.077
> 
> 标签：database, winapi

我正在寻找一些“数据库”/XML 格式的 win32 API 列表。

我需要它来轻松地在 win32 API 和我正在使用的高级语言（harbour/xharbour）之间创建一个“转换层”。由于这运行 Pcode，因此有必要将参数转换为 C 标准...

而不是手动编写代码，我想自动化这个过程......

例如，windows API 定义（取自 MSDN）

```
DWORD WINAPI GetSysColor(
  __in  int nIndex
); 
```

应该转化为

```
HB_FUNC( GETSYSCOLOR )
{
    hb_retnl( (LONG) GetSysColor( hb_parni( 1 ) ) );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T12:03:37.163

Of course, you have Microsoft Platform SDK, but it is in raw .h C code, so hard to parse!

Similar work have been done by VB users (and Delphi users and probably for some other languages), for example [ApiViewer](http://www.activevb.de/rubriken/apiviewer/index-apiviewereng.html "ActiveVB - ApiViewer (en)") has such database, but in some proprietary binary format (.apv extension), so you might have to reverse-engineer it.
Similarly, there is an API-Guide, which was hosted at Allapi.net but the later seems to be a parking site now. It used .api files (again binary-proprietary).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T11:42:06.560

AFAIK，pinvoke.net 仅存储带有呼叫定义的 PInvoke 文本数据。如果您想要的是用作 API 的预解析数据库的东西，那么它不是很有用。

可能您可以创建一个小型解析器，它将获取包含文件并将其转换为您需要的内容。在这种情况下，我建议使用[lcc-win32](http://www.cs.virginia.edu/~lcc-win32/)的包含文件，因为它们几乎是 SDK 标头的无脂肪/无 BS 版本（它们不带有一堆你想要的特殊保留字必须忽略等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T11:19:00.563

关于我所知道的最接近的事情是： http: [//pinvoke.net/](http://pinvoke.net/) 也许他们会与你分享他们的数据？他们有一个访问这些数据的 VS 工具，所以它可能是一个网络服务。你甚至可以嗅出它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-02T22:32:18.760

似乎有一些数据库（以及使用它的应用程序，名为“ [PInvoke Interop Assistant](https://github.com/jaredpar/pinvoke) ”）位于：

[https://github.com/jaredpar/pinvoke/tree/master/StorageGenerator/Data](https://github.com/jaredpar/pinvoke/tree/master/StorageGenerator/Data)

虽然我现在不确定许可证是什么——因此[我问了作者](https://github.com/jaredpar/pinvoke/issues/19)。

# .net - 监控正在运行的 .net 应用程序

> ID：114305
> 
> 赞同：2
> 
> 时间：2008-09-22T11:18:46.833
> 
> 标签：.net, monitoring

例如，我运行了一些需要监视的 .net 应用程序，然后在 App1 中调用 MethodA，我的监视应用程序应该检测到这一点。我有很多正在运行的应用程序，这里提出的解决方案是重新编译所有这些应用程序，并在我们想要监控的所需方法中包含一个新行。我只想在绝对没有办法的情况下这样做。那么有人做过这样的事情吗？基本上，我需要创建一个新应用程序，当我单击它上的按钮时，它会告诉我：在 App1 中实时调用了 MethodA...

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T11:24:52.903

有几种方法可以做到这一点。一种是使用 log4Net，通过调用 log4Net 的 write 方法“散布”您的方法。您可以选择各种日志记录附加程序（目的地），例如电子邮件或数据库，但一个鲜为人知的技巧是下载独立程序[DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)（SysInternals -> 现在是 Microsoft），它会侦听默认消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T12:13:47.420

[PostSharp](http://www.postsharp.org/)交付方式，如何编辑已编译的 .net 代码。编辑是用编译（属性）或配置代码的 C# 代码编写的。Thay 有一种机制，可以记录（或填充或其他任何内容）方法/事件调用等等。

我想，这是你需要的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T11:22:18.713

System.Diagnostics.PerformanceCounter 是一个很好的起点。您可以创建可以在性能控制面板小程序中查看的新计数器。一开始它们有点令人困惑，但是当您意识到平均计数器需要两个组件来计算百分比时，它会变得容易得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T11:22:55.967

我不知道 .NET 是否有匹配机制，但 Java 允许您指定代理 JAR 文件，即在加载每个类时通知/调用的类。然后，通过仪器/字节码操作，您可以拦截此类方法调用。也许您可以在 .NET 中以某种方式替换类加载器。没有把握。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T11:24:11.860

反射是您在 .NET 中寻找的东西，但我不确定您想要做什么背后的实现细节。

# plugins - 如何在 Trac 中快速添加工单？

> ID：114306
> 
> 赞同：9
> 
> 时间：2008-09-22T11:18:54.387
> 
> 标签：plugins, trac, bug-tracking

将多张票添加到 Trac 或将其作为您自己的待办事项列表是非常痛苦的。这导致人们使用他们自己的任务管理工具，然后将任务分散到各处。

是否有任何插件或宏可以加快添加工单的过程？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-08-28T04:11:14.630

以下允许您键入快速注释。该便条成为分配给您自己的 Trac 票证。我将它用于非常快速的错误和/或我不想忘记的功能。或者，如果我编造了一个功能，我打开然后关闭它的票，所以我得到了完整的信用:) - j

```
#!/usr/bin/env python

'''
trac-bug: add bug/feature to current Trac project, from the command line.
Specify Trac project directory in TRAC_ENV environment variable.
'''

import os, sys

TRAC_ENV = os.environ.get('TRAC_ENV') or os.path.expanduser('~/trac/projectenv')
if not os.path.isdir(TRAC_ENV):
    print >>sys.stderr, "Set TRAC_ENV to the Trac project directory."
    sys.exit(2)

from trac.env import open_environment
from trac.ticket import Ticket
t = Ticket(open_environment(TRAC_ENV))

desc = ' '.join(sys.argv[1:])
info = dict(
    status='open', 
    owner=os.environ['USER'], reporter=os.environ['USER'],
    description = desc, summary=desc
)

t.populate(info)
num = t.insert()
if not num:
    print >>sys.stderr, "Ticket not created"
    print >>sys.stder, vals
    sys.exit(1)

print "Ticket #%d: %s" % (num,desc)
sys.exit(0)                 # all is well 
```

用法很简单：

$ trac-bug 啤酒

票#9：没有啤酒

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-22T11:21:49.200

如果您使用的是 Eclipse：[Mylyn](http://www.eclipse.org/mylyn/)是完美的。

否则，您总是可以获得 XML RPC 插件。[http://trac-hacks.org/wiki/XmlRpcPlugin](http://trac-hacks.org/wiki/XmlRpcPlugin)并推出您自己的小工具。

为了快速创建类似的票证，您可以使用克隆插件：[http ://trac-hacks.org/wiki/CloneTicketPlugin](http://trac-hacks.org/wiki/CloneTicketPlugin)

**编辑**我用 SVN [checkin hook](http://trac.edgewall.org/browser/trunk/contrib/trac-post-commit-hook)支持 Espen 的想法，它对我们也很有用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-22T11:26:49.407

您可以尝试使用[EmailtoTrack](http://trac-hacks.org/wiki/EmailtoTracScript)，这样您就可以通过发送电子邮件来创建工单。

（另一个巧妙的跟踪提示，如果与您的问题没有直接关系，是在您的版本控制系统中使用提交挂钩，这样您就可以通过提交关闭票证。我只为 SVN 尝试过[这个](http://trac.edgewall.org/browser/trunk/contrib/trac-post-commit-hook)，但它不应该是很难移植。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-26T11:07:55.107

track-hacks 上还有一个命令行 trac 票证创建器，您必须在 trac repo 所在的同一台机器上运行它。我发现命令行添加比基于 Web 的添加要快得多。

[http://trac-hacks.org/wiki/TicketToTracScript](http://trac-hacks.org/wiki/TicketToTracScript)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-04T07:33:34.183

同时，一个编程[的 TicketImportPlugin](http://trac-hacks.org/wiki/TicketImportPlugin)可以在 Excel 表的一次用户交互中创建或更新多个工单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T01:20:09.357

如果 Mylyn 为您工作，请考虑查看[http://tasktop.com](http://tasktop.com)。Tasktop 通过强大的生产力功能扩展了 Mylyn，例如自动时间跟踪、Web 浏览支持、电子邮件和日历集成等。

# scheme - 使用 Scheme 创建自定义 GnuCash 报告

> ID：114320
> 
> 赞同：6
> 
> 时间：2008-09-22T11:26:26.847
> 
> 标签：scheme

是否有任何资源显示如何创建自定义 GnuCash 报告？我不知道 Scheme 的复杂性，但我知道 Lisp 的基础知识，基于修补 Emacs。是否有一个网站为 GnuCash 报告提供 API，最好还对 Scheme 进行一些解释？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-22T11:37:58.957

看来他们的 wiki[在这里](http://wiki.gnucash.org/wiki/Custom_Reports)有一些信息。

# authentication - 处理网络应用程序中会话超时的最佳方法？

> ID：114321
> 
> 赞同：11
> 
> 时间：2008-09-22T11:26:29.390
> 
> 标签：authentication, web-applications, session

我目前正在构建一个用于工厂/仓库类型位置的内部 Web 应用程序。用户将在几个人之间共享一台 PC，因此我们需要有一个相当短的会话超时时间，以防止人们四处走动并让应用程序处于登录状态，这样其他人就可以来到 PC 并使用前一个用户的用户名进行操作。

这样做的问题是，当用户当前正在将信息输入表单时，会话可能会超时，尤其是当他们需要很长时间时。

您将如何以用户友好的方式处理这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T11:29:23.847

使用 AJAX 定期存储部分填写的表单的内容，这样他们在被系统引导时不会丢失他们的工作。哎呀，一旦你这样做了，如果他们花时间打字，请使用 AJAX 来防止他们的会话超时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-22T11:30:31.067

让服务器了解用户正在积极输入信息的事实。例如，如果用户按下 TAB 键或用鼠标单击字段，则向服务器发送消息。最终解决方案取决于您。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-22T11:28:51.287

最好的建议可能是要求用户在完成后关闭浏览器窗口。使用会话cookies，会话将在浏览器关闭或30分钟超时时自动结束（可以更改afaik）。

由于默认情况下，一旦加载页面，浏览器和服务器之间就没有交互，因此您必须让 javascript 在表单页面的后台联系服务器以刷新会话，但这似乎有点太麻烦了这么小的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-22T11:34:53.083

如果会话超时时间太短以至于用户没有时间填写表格，我会放置一个 AJAX 脚本，每隔几分钟向服务器发出一个 http 请求，以保持会话处于活动状态。我只会在用户必须填写某些内容或已经开始填写某些内容的页面上这样做。

另一种解决方案是使用会话超时提醒脚本，该脚本会弹出一个对话框来提醒用户会话即将超时。弹出窗口应显示“注销”和“继续使用应用程序”，发出 ajax 请求以更新会话超时。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-22T11:29:26.717

也许在这种情况下，保持活动状态的 javascript 进程可能会有所帮助。如果脚本捕获了一些关键触发器，它会向服务器发送“我仍在输入”消息以保持会话处于活动状态。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-22T11:41:46.500

你有没有考虑把表格分成更小的块？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-22T12:19:42.553

监控超时并发布一个弹出窗口以通知用户他们当前的会话将过期并显示“确定”或“取消”按钮。OK 让会话继续进行（即，将计数器重置为另外 5 分钟或 10 分钟 - 无论您需要什么） - 或 - 取消以允许会话继续倒计时至零，从而结束。
这是处理它的许多方法之一。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-22T12:50:48.500

对我来说，使用 JavaScript“线程”来保持会话打开是一个坏主意。

如果应用程序前面没有用户，则存在用于释放一些资源的会话超时的想法。

我认为您应该使用更准确的时间调整会话超时，以便以“典型的正常使用”填写表格。

您也可以通过以下方式积极主动：

1.  在超时到期之前有一个 JavaScript 警报向用户显示非侵入性警告（不是弹出窗口），这表示会话将很快到期（并提供一个链接以发送 ajax 请求以重置超时并删除该警告 -这将避免用户丢失他当前正在输入的表单），
2.  并且还有第二个 JavaScript “线程”，如果会话已过期，它会重定向到登录页面，并显示会话现已过期的消息。

它认为这是最好的，因为它避免了用户填写复杂的表格，并在用户离开时处理情况。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-22T11:43:12.110

作为技术解决方案的替代方案，您可以使您的应用程序在每次完成特定工作（例如填写表格）时询问用户他是否想继续做另一份工作或者他是否已经完成。Yould 可以有一个带有菜单选项的开始屏幕，如果用户选择一个选项，他首先必须输入他的凭据。

或者在表单上输入密码字段。取决于他们必须在一个会话中填写多少表格。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-22T12:15:15.390

当用户发布表单并且他们的会话超时时，您应该确保将表单值保存在某处，然后要求用户再次登录。一旦他们重新验证了您的身份，他们就可以重新提交表单（因为他们的数据都不会丢失）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-22T12:37:06.163

我开发了一些需要很长时间的东西。用户坐在机器上时登录页面，完成工作后退出。现在他可能会使用系统几分钟或几个小时。为了让会话保持活跃直到他注销，我使用了带有 javascript 的计时器，它转到服务器并用服务器上的当前时间更新了[国歌标签。](http://anthemdotnet.com)

# ms-access - 将 MS Access“OLE 对象”转换回纯 JPEG——最好的方法？

> ID：114326
> 
> 赞同：5
> 
> 时间：2008-09-22T11:28:24.783
> 
> 标签：ms-access, image

背景：我们有一个旧的（但对业务至关重要的）SQL Server 数据库和一个 MS Access ADP 前端；这最初是从一系列 Access 数据库升级到 SQL Server 的。

该数据库为我们的客户跟踪危险材料，并存储大量图像。这些图像是从 MS Access 插入的，并作为 OLE 对象放入数据库中。

问题是：

*   除了 Access/Office 之外的任何内容都很难阅读
*   存在巨大的存储开销 - 约 10GB 的图像占用 600+ GB 的存储空间（！）

我的问题是：你建议用什么方法将这些臃肿的对象转换回简单的 JPEG？一旦我们这样做了，我们最终可以将我们的前端从 Access 迁移到一个简单的基于 Web 的系统上，我们的备份时间将再次变得易于管理！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-22T11:42:27.917

从这里获取 *.bas 文件[http:http://stackoverflow.com/Content/img/wmd/ul.png//www.access-im-unternehmen.de/index1.php?BeitragID=337&id=300](http://www.access-im-unternehmen.de/index1.php?BeitragID=337&id=300)（不幸的是是德语）。

它使用 MS 的 GDI+ 库（包含在 Win 标准安装中）将图片导入/导出到 Access OLE。

界面粗略翻译：

*   IsGDIPInstalled：检查 GDI+ 的安装
*   InitGDIP：GDI+的初始化。
*   ShutDownGDIP：GDI+ 的 Deinit（重要且要使用！）
*   LoadPictureGDIP：在 StdPicture 对象（bmp、gif、jp(e)g、tif、png、wmf、emf 和 ico）中加载图片。
*   ResampleGDIP：将图片缩放到新的尺寸并在需要时锐化。
*   MakeThumbGDIP：制作缩略图并用颜色填充边框。
*   GetDimensionsGDIP：以像素为单位获取 TSize-Struktur 中的尺寸。
*   SavePicGDIPlus：将文件中的图片对象保存为 BMP、GIF、PNG 或 JPG（具有给定质量的 jpg）
*   ArrayFromPicture：返回图片的字节数组，将图片放入表的OLE字段
*   ArrayToPicture：创建包含图片的表的 OLE 字段的字节数组

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T11:59:22.867

Use Access MVP Stephen Lebans ExtractInventoryOLE tool to extract the OLE objects from a table to separate files.

[http://www.lebans.com/oletodisk.htm](http://www.lebans.com/oletodisk.htm)

According to Lebans: "Does NOT require the original application that served as the OLE server to insert the object. Supports all MS Office documents, PDF, All images inserted by MS Photo Editor, MS Paint, and Paint Shop Pro. Also supports extraction of PACKAGE class including original Filename."

Also, Access 2007 stores OLE objects much more efficiently than the historical BMP formats of previous versions, so you would have a smaller storage space and be able to keep your Access app if you converted it from the 600+GB storage of SQL Server to Access 2007 accdb format. Your backup times would be manageable and you wouldn't need to spend time converting an Access front end to a web front end.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T11:44:10.563

这里又是链接：[http ://www.access-im-unternehmen.de/index1.php?BeitragID=337&id=300](http://www.access-im-unternehmen.de/index1.php?BeitragID=337&id=300)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T11:41:15.843

我认为您的数据库变得如此臃肿的原因是 JPG 也作为位图存储在“OLE 对象”结构中，或者我已经看到，这取决于插入 JPEG 的方法。

这不是最佳的，但是：对于数据库中的每个图像，我将以编程方式创建一个仅包含图像的虚拟 .doc，然后通过 OpenOffice 转换传递它，并从生成的 OpenOffice 文档的图像子文件夹中提取 JPEG（即一个 ZIP 文件）。

然后我会用原始 JPEG 数据替换数据库中的 OLE 文档，但是我无法让您在自定义应用程序中清楚地显示它们（除非它是一个 Web 应用程序）。

# .net - 滥用 XmlReader ReadSubtree()

> ID：114327
> 
> 赞同：4
> 
> 时间：2008-09-22T11:28:29.120
> 
> 标签：.net, xml, xmlreader

我需要解析一个 xml 文件，它实际上是一个非常大的树结构的图像，所以我使用 XmlReader 类来“动态”填充树。每个节点仅通过 ReadSubtree() 函数从其父节点传递它期望的 xml 块。这样做的好处是不必担心节点何时消耗了它的所有子节点。但现在我想知道这是否真的是一个好主意，因为可能有数千个节点，并且在阅读 .NET 源文件时，我发现每次调用 ReadSubtree 都会创建几个（可能更多）新对象，并且没有缓存可重用对象（我见过）。

也许 ReadSubtree() 没有被认为被大量使用，或者我只是什么都不担心，我只需要在解析文件后调用 GC.Collect() ......

希望有人可以对此有所了解。

提前致谢。

### 更新：

感谢您提供的精彩而有见地的答案。

我深入研究了 .NET 源代码，发现它比我最初想象的要复杂。我终于放弃了在这种情况下调用这个函数的想法。正如 Stefan 指出的那样，xml 阅读器永远不会传递给外人，我可以信任解析 xml 流的代码（由我自己编写），所以我宁愿强制每个节点对它们的数据量负责从流中窃取而不是使用最终不那么薄的 ReadSubtree() 函数来节省几行代码。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-22T11:58:22.527

ReadSubTree() 为您提供了一个包装原始 XmlReader 的 XmlReader。这种新阅读器在消费者看来是一个完整的文档。如果您传递子树的代码认为它正在获取独立的 xml 文档，这可能很重要。例如，新 Reader 的 Depth 属性从 0 开始。它是一个非常薄的包装器，因此与直接使用原始 XmlReader 相比，您不会使用更多资源，在您给出的示例中，它是很可能您并没有真正从子树阅读器中获得太多。

在您的情况下，最大的优势是子树阅读器不会意外读取子树。由于子树阅读器不是很昂贵，因此这种安全性可能就足够了，尽管当您需要子树看起来像一个文档或者您不相信代码只能读取它自己的子树时，它通常会更有帮助。

正如 Will 所说，你永远不想调用 GC.Collect()。它永远不会提高性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-22T12:05:48.627

假设所有对象都是在普通托管堆上创建的，而不是大型对象堆（即小于 85k），这里应该没有问题，这正是 GC 旨在处理的问题。

我建议也没有必要在进程结束时调用 GC.Collect，因为在几乎所有情况下，允许 GC 自行安排收集允许它以最佳方式工作（有关详细信息，请参阅[此博客文章](http://vineetgupta.spaces.live.com/blog/cns!8DE4BDC896BEE1AD!1104.entry?4b246970)GC 的解释比我能解释得更好）。

# visual-studio - Visual Studio 设置问题 - '加载设置组件时遇到问题。取消设置。

> ID：114332
> 
> 赞同：152
> 
> 时间：2008-09-22T11:30:01.160
> 
> 标签：visual-studio, visual-studio-2008, visual-studio-2005, installation, maintenance

我的 Visual Studio 2008 设置存在*严重*问题。我收到非常有用的错误“加载设置组件时遇到问题。取消设置。每当我尝试卸载、重新安装或修复 Visual Studio 2008（团队系统版本）时。如果我不能解决这个问题，我别无选择，只能彻底擦除我的电脑并重新开始，这将需要一整天的时间！我最近在尝试构建有关内存不足的组件的项目时收到了非常奇怪的错误（尽管当时有大约 2gb 的物理内存可用），这使得我当前的 VS 安装无用。

*注意我在安装 VS2008后*使用 SQL Server 文件夹中的 vs_setup.msi 文件安装了 VS2005 shell 版本，以便在 Business Intelligence Development Studio 中访问 SQL Server 2005 Reporting Services 设计器（这在 VS2008 中莫名其妙地不可用）。

有没有人有解决这个问题的方法？

**PS**：我知道这与编程没有直接关系，但是我觉得这*很*适合 SO，因为它与我的编程*能力*直接相关！

**注意**：一位同事找到了解决此问题的方法，希望这可以帮助其他人解决此问题。

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2008-09-22T13:13:28.573

一位同事发现了这个[MS 自动卸载工具](http://go.microsoft.com/fwlink/?LinkId=105801)，它为我成功卸载了 VS2008，为我节省了数小时的工作时间！！

希望这可能对其他人有用。不高度评价 MS 对他们通常的 VS 维护工具的信心，他们也必须提供这个！

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2008-11-12T13:22:11.537

我有同样的错误信息。对我来说，这是因为我试图从 DVD 运行安装程序，而不是从添加/删除程序运行安装程序。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-11T02:08:28.887

就我而言，从添加和删除程序中卸载不起作用。相反，问题是由于最近通过自动更新安装的修补程序。VS 2008（在我的情况下）的修补程序编号为 KB952241，因此我使用添加/删除程序检查显示更新选项将其卸载。卸载后问题就没有了。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-23T17:17:31.003

我遇到了同样的问题，找到了一个非常简单的解决方案。转到以下链接：http: [//msdn.microsoft.com/en-us/vs2008/bb968856.aspx](http://msdn.microsoft.com/en-us/vs2008/bb968856.aspx)

并运行 VS AutoUninstall 工具。这将自动删除 VS 2008 的所有组件。

干杯

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-08-13T20:36:27.237

果然，对我来说，这是修补程序。在添加/删除程序中，选中“显示更新”框，然后删除与您的 VS2008 版本相关的所有修补程序。然后尝试“更改/删除”按钮 - 现在应该可以顺利进行。

好吧，无论如何，它对我有用...... ;-)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-12-01T16:19:05.890

我有**Visual Studio Team System 2008 Development Edition**，并且必须删除所有更新和修补程序：

*   更新`KB972221`
*   修补程序`KB973674`
*   修补程序`KB971091`

重新启动，然后出现以下修补程序，然后我根据@riaraos 的[回答](https://stackoverflow.com/questions/114332/visual-studio-setup-problem-a-problem-has-been-encountered-while-loading-the-s/633076#633076)将其删除：

*   修补程序`KB952241`

在更改/删除工作之前！

希望对其他人有所帮助。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-02-15T19:16:55.387

卸载与vs2008相关的修补程序，然后重试。它对我有用，希望对你也有用。

谢谢，泽拉勒姆

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-04-01T06:53:21.777

删除以下热修复和更新

*   更新 KB972221
*   修补程序 KB973674
*   修补程序 KB971091

重新启动 PC 并立即尝试卸载。这对我来说没有问题。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-05-10T14:21:52.767

Microsoft 自己发布了一篇关于此的知识库文章，并且该文章有一个他们声称可以解决问题的服务包。见下文。

[http://support.microsoft.com/kb/959417/](http://support.microsoft.com/kb/959417/)

相关更新需要一段时间才能自行安装，但一旦安装完成，我就能够从“添加/删除程序”控制面板成功运行 Visual Studio 安装程序。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-22T11:59:29.873

您应该在系统的临时目录中查找 MSI 设置日志。它们将包含有关设置失败原因的详细信息。我在使用 Visual Studio 2008 时遇到了类似的安装问题，我可以通过研究日志来解决这个问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-22T11:47:27.390

我认为这类问题完全适合论坛，特别是如果可以找到一个简单的解决方案，这样可以节省其他人几个小时的痛苦。

不幸的是我没有解决方案，但会建议（如果你还没有）

1.  运行[FileMon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)以查看安装程序是否正在寻找不再存在的特定文件 - 这可能会提供一些线索。

2.  痛苦，但先尝试卸载其他基于VS shell（例如2005）的应用程序。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-09T13:52:19.760

谢谢，riaraos，卸载 KB952241 也是我的解决方案。在此之前，我尝试从“程序和功能”和安装 DVD 运行安装程序，但没有成功。我不想完全删除 VS 2008 安装，而只想添加一些组件。

我的系统注意事项：

Windows 7 测试版 1 Visual Studio 2008 SP1

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-07-17T23:48:17.800

好的，我首先遇到了同样的问题，我的 VS2008 出现了问题，所以我尝试卸载它，但它没有用...我在网上看到使用 MS 的 AutoUninstall 可以做到这一点，但留下了很多后面有讨厌的文件..

所以我使用“Windows Install Clean Up”并清理了更多与VS有关的东西。然后回到控制面板中的添加和删除删除KB952241...然后打开Ccleaner并扫描注册表发现很多VB2008留下的废话在完成后删除了所有这些。

我继续从 CD 重新启动安装程序，然后 BAM 开始工作。

我做了所有这一切而无需重新启动我的电脑..

希望这可以帮助那些被困的人......就像我一样

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-10-21T00:16:00.373

就我而言，安装 Visual Studio SP1 会破坏卸载/修复功能。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-03-01T15:16:40.617

在错误消息中点击“确定”后，Windows 7 建议“使用推荐设置卸载”。它解决了这个问题。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-02-26T17:44:47.687

解决方案是

[http://www.dotnetzone.gr/cs/forums/48758/ShowThread.aspx#48758](http://www.dotnetzone.gr/cs/forums/48758/ShowThread.aspx#48758)

# .net - .NET 项目中的 HTML 标记 ClientID

> ID：114339
> 
> 赞同：7
> 
> 时间：2008-09-22T11:32:21.857
> 
> 标签：.net, asp.net

如果我想在基于母版页的 aspx 页面中操作服务器上的 HTML 标记的属性，即

```
<a href="#" runat="server" ID="myLink">My Link</a> 
```

例如，根据当前页面给链接一个不同的类，即

```
if (Path.GetFileName(Request.PhysicalPath) == "MyPage")
{
myLink.Attributes.Add("class","active");
} 
```

.NET 将链接的 ID 属性更改为类似

```
<a href="#" ID="ct100-foo-myLink">My Link</a> 
```

有没有办法阻止这种情况发生并保留原始 ID？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-22T11:44:07.960

直接是不可能的。您可以创建一个继承链接并覆盖其 ClientID 以直接返回 ID 的新控件。但这似乎是矫枉过正。您可以简单地使用 HTML 标记并在需要时使用 <%# GetClass() %> 添加类。

关于 Javascript 的 ClientID 的使用：

```
<a ID="myLink" runat="server">....

var ctrl = document.getElementById('<%# myLink.ClientID %>'); 
```

当然，您需要在代码中的某处使用 DataBind。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-22T11:41:45.437

AFAIK没有办法。

它显示了实际的控制树，在本例中为 masterpage-content-control。

但是，如果您向母版页添加一个 ID (this.ID = "whatever")，那么您将看到“whatever”而不是 ctl00（这意味着控制索引 0）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T20:14:23.067

如果您使用 jQuery，我刚刚发现了一种简单的方法。

```
var mangled_name = $("[id$=original_name]").attr("id"); 
```

因此，如果您有这样的服务器控件：

```
<asp:TextBox ID="txtStartDate" runat="server" /> 
```

您可以使用以下方法在 jQuery/Javascript 中获取损坏的名称：

```
var start_date_id = $("[id$=txtStartDate]").attr("id"); 
```

由于它是一个字符串，您也可以使用它“内联”而不是分配它，例如将它与选择器的其他元素连接起来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T11:38:39.253

我不这么认为。

但是，您可能希望保留原始名称，以便您可以使用 javascript 操作控件....如果是这种情况，您应该查看 ClientID；它将在运行时返回分配的 ID。

**编辑：**

看起来有一种方法可以做到这一点，但需要做一些工作......看看[ASP.NET 控件 - 改进自动 ID 生成：架构更改（第 3 部分）](http://weblogs.asp.net/nunogomes/archive/2008/06/04/asp-net-controls-improving-automatic-id-generation-architectural-changes-part-3.aspx)

我没有阅读完整的帖子，但看起来他创建了自己的容器和自己的命名提供程序。我认为，如果您想保持控件的名称不变，则只需将名称返回

```
public abstract string SetControlID(string name, System.Web.UI.Control control); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T11:40:52.537

我从来没有想过如何阻止.NET 这样做，但我开始做的是放置 asp:Literals 并使用 c# 向它们添加 WebControl。如果您编写 WebControl，您可以设置各种属性而无需获取 .NET 的唯一 ID。例如：

```
<asp:Literal ID="myLink" /> 
```

...

```
WebControl a = new WebControl(HtmlTextWriterTag.A);
a.CssClass = "active";
a.Attributes["href"] = "#";
Literal text = new Literal();
text.Text = "click here";
a.Controls.Add(text);
myLink.Controls.Add(a); 
```

这将导致以下html：

```
<a href="#" class="active">click here</a> 
```

总的来说，这是一个非常肮脏的解决方案，但我当时不知道还能做什么，而且我有一个截止日期。;)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T11:42:21.130

没错，出于 JavaScript 和 CSS 的原因，我们需要保留原始 ID。我注意到 ClientId 属性，但它是只读的，无法分配，所以我不确定我将如何使用它？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T11:43:02.627

这篇**博文**可能会有所帮助： [从 ASP.Net 母版页中删除名称修饰（取回您的 ID！）](http://gathadams.com/2008/08/18/remove-name-mangling-from-aspnet-master-pages-get-your-id-back/)

帖子中的解决方案覆盖了该`.getElementById`方法，允许您仅使用普通 ID 搜索元素。也许您可以根据自己的需要进行调整。

**免责声明：** ASP.NET 行为是设计使然，这样很好，即使对于 HTML 服务器控件（例如您的示例中的控件）也是如此。Server-ID 和 Client-ID 是两个非常不同的东西，不应该混用。如果没有这种机制，使用母版页或用户控件可以以相同的客户端 ID 结束。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T06:24:59.987

为什么不只使用标准的 a 标签，并使用渲染块来修改它，然后您将其行为锁定在客户端。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-07-05T08:43:38.047

ASP.NET 4 具有控制 ClientID 呈现的属性*ClientIDMode 。*

此外，还有一个[技巧是如何为任何非回发控件](http://clientidless.codeplex.com/)（ASP.NET 2.0+）禁用 ClientID 呈现。

# sql-server - IIS 错误：无法连接到配置数据库

> ID：114398
> 
> 赞同：4
> 
> 时间：2008-09-22T11:48:35.483
> 
> 标签：sql-server, iis, windows-server-2003

使用 IIS 重新启动 Windows 2003 服务器后，我收到以下错误消息：

> 无法连接到配置数据库

在浏览器中。该错误发生在不同的页面和不同的客户端上。我认为这是一个服务器问题。

我能做些什么来解决这个错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-22T12:58:01.010

快速网络搜索表明此错误消息可能来自 SharePoint Services，并表明 SharePoint 无法连接到其数据库。

似乎有几个原因建议：

*   SQL 数据库未运行、已被删除，或者您无法连接到它（防火墙、登录凭据、网络故障）
*   IIS 以错误的模式运行

后者可以是为 IIS 5.0 兼容模式配置的 IIS 6.0，也可以是为 64 位系统上的 32 位工作进程配置的应用程序池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T07:30:25.280

我遇到了同样的问题，并且确实发生在 Windows 更新之后，嗯...首先，有人（Windows 更新）更改了服务“Windows 内部数据库（MICROSOFT##SSEE）”上的用户帐户。改回正确的帐户，WSS 开始工作，但出现错误（应用程序/错误或其他东西）

这个新问题是我在运行 Exchange Analyzer 工具并对我的系统进行了一些修改后免费得到的，这是该工具推荐的。

如果我改变了我的 web.config 也看起来像这样（c:/inetpub/wss-dir/web.config）：

```
<!-- Web.Config Configuration File -->
<configuration>
  <system.web>
    <customErrors mode="RemoteOnly"/>
  </system.web>
</configuration> 
```

我发现了问题所在，这是一个访问/安全问题。错误信息告诉我：

拒绝访问路径“C:\WINDOWS\Microsoft.NET\Framework\v1.1.4322\Temporary ASP.NET Files\root\8c91a6b5\649b28ba”。

但这不是事实......访问被拒绝不是 ..\Temporary ASP.NET Files\root\8c91a6b5\649b28ba 文件夹，而是 %TEMP% 文件夹，我刚刚移动了来自 Exchange 分析工具的建议。

祝你今天过得愉快！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T05:26:35.803

我对sharepoint有这个问题我用它来修复sql数据库 [http://heresjaken.com/sharepoint-cannot-connect-to-configuration-database-error-after-installing-kb2687442-update-on-sbs-server- 2008/](http://heresjaken.com/sharepoint-cannot-connect-to-configuration-database-error-after-installing-kb2687442-update-on-sbs-server-2008/)

# eclipse-emf - 将 JET 与 EMF 结合使用

> ID：114415
> 
> 赞同：0
> 
> 时间：2008-09-22T11:55:14.097
> 
> 标签：eclipse-emf, eclipse-m2t-jet

我需要在 EMF 模型元数据上运行 JET 模板 - 即模型本身（不是数据）输入到我的 JET 模板中。

更实际 - 我想基于 EMF 模板生成非 Java 代码。

我怎么做？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T15:10:50.303

我不确定我是否正确，但您可以像将任何其他对象一样将模型传递到 JET 模板中（如[JET 教程](http://www.eclipse.org/articles/Article-JET/jet_tutorial1.html)中所述）。此外，使用 JET 生成 Java 或任何其他文本也没有区别。作为一个额外的指针，您可能需要考虑使用 Xpand（openArchitectureWare 的一部分[）](http://www.eclipse.org/gmt/oaw/doc/)进行非常舒适的模型到文本生成（包括模板编辑器中模型的内容辅助等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T15:21:24.177

对于代码生成，您可以使用 Acceleo。这就像 Xpand 非常舒适的模型到文本生成（Acceleo 语言对于模型浏览非常直观）并且也比 JET 不那么痛苦。

# javascript - 在页面加载时选择性地执行 JavaScript

> ID：114417
> 
> 赞同：1
> 
> 时间：2008-09-22T11:55:17.277
> 
> 标签：javascript

在我们的 SAP BW Web 应用程序中修复一个错误，我需要在页面加载时从 Web 框架库中调用两个 javascript 函数。问题是这些函数中的每一个都会重新加载页面作为副作用。另外，我无权修改这些功能。

关于如何在“真实”页面加载时执行一段代码，然后在此函数引起的后续加载中执行另一段代码，然后在第三次重新加载时不执行任何代码的任何好主意？

到目前为止，我最好的想法是在每次运行时设置一个 cookie 以确定要运行的内容。我不太喜欢这个解决方案。任何更好的东西都会非常受欢迎。顺便说一句，我确实意识到加载一个页面三次是绝对荒谬的，但这就是我们使用 SAP 的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-22T11:58:34.383

一个cookie就可以了。或者您可以每次使用“mode=x”或“load=x”参数修改查询字符串。

但是，如果用户尝试为最后一页添加书签，这将出现问题。如果这是一个选项，cookie 解决方案很好。我猜他们需要启用 cookie 才能在应用程序中走得那么远？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T12:01:24.877

一个 cookie，或传递一个查询字符串参数，指示已运行的 javascript 函数。我们必须按照这些思路做一些事情来测试我们的软件。这真的是我得到的最好的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T12:02:00.367

使用 cookie 或设置隐藏字段值。我的投票将是字段值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T16:02:15.530

这可能是使用 window.name 的一个很好的案例，“在页面重新加载后仍然存在的属性”。

# c# - ++ 何时不会产生与 +1 相同的结果？

> ID：114419
> 
> 赞同：27
> 
> 时间：2008-09-22T11:55:40.600
> 
> 标签：c#, stack, increment

以下两个 C# 代码片段产生不同的结果（假设变量 level 在递归调用之前和之后都使用）。为什么？

```
public DoStuff(int level)
{
  // ...
  DoStuff(level++);
  // ...
} 
```

,

```
public DoStuff(int level)
{
  // ...
  DoStuff(level+1);
  // ...
} 
```

在阅读了下面的一些回复后，我认为发布 level++、++level 和 level+1 的堆栈跟踪是值得的，以突出这个问题的欺骗性。

我已经为这篇文章简化了它们。递归调用序列从 DoStuff(1) 开始。

// 级别++

```
DoStuff(int level = 1)
DoStuff(int level = 2)
DoStuff(int level = 2)
DoStuff(int level = 2) 
```

// ++级

```
DoStuff(int level = 4)
DoStuff(int level = 4)
DoStuff(int level = 3)
DoStuff(int level = 2) 
```

// 等级+1

```
DoStuff(int level = 4)
DoStuff(int level = 3)
DoStuff(int level = 2)
DoStuff(int level = 1) 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-09-22T12:08:36.543

To clarify all the other responses:

+++++++++++++++++++++

```
DoStuff(a++); 
```

Is equivalent to:

```
DoStuff(a);
a = a + 1; 
```

+++++++++++++++++++++

```
DoStuff(++a); 
```

Is equivalent to:

```
a = a + 1;
DoStuff(a); 
```

+++++++++++++++++++++

```
DoStuff(a + 1); 
```

Is equivalent to:

```
b = a + 1;
DoStuff(b); 
```

+++++++++++++++++++++

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-09-22T12:00:51.197

Because the first example is really equivalent to:

```
public DoStuff(int level)
{  
  // ...
  int temp = level;
  level = level + 1;
  DoStuff(temp);
  // ...
} 
```

Note that you can also write ++level; that would be equivalent to:

```
public DoStuff(int level)
{  
  // ...
  level = level + 1;
  DoStuff(level);
  // ...
} 
```

It's best not to overuse the ++ and -- operators in my opinion; it quickly gets confusing and/or undefined what's really happening, and modern C++ compilers don't generate more efficient code with these operators anyway.

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-09-22T11:58:07.927

**level++** will pass **level** into **DoStuff** and then increment **level** for use in the rest of the function. This could be a fairly nasty bug as the recursion will never end (from what is shown **DoStuff** is always being passed the same value). Perhaps **++level** is meant instead, as this is the opposite of **level++** (increments level and passes the incremented value into **DoStuff**)?

**level+1** will pass **level+1** into **DoStuff** and leave **level** unchanged for the rest of the function.

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-22T12:08:08.010

the return value of `level++` will be `level` and `therefore` pass `level` into `DoStuff`. This could be a fairly nasty bug as the recursion will never end (from what is shown `DoStuff` is always being passed with the same value). Perhaps `++level` or `level + 1` is meant instead?

`level + 1` will pass `level + 1` into `DoStuff` and leave `level` unchanged for the rest of the function.

* * *

The post-increment operator (variable++) is precisely equivalent to the function

```
int post_increment(ref int value)
{
    int temp = value;
    value = value + 1
    return temp;
} 
```

while the pre-increment operator (++variable) is precisely equivalent to the function

```
int pre_increment(ref int value)
{
    value = value + 1;
    return value;
} 
```

* * *

Therefore, if you expand the operator inline into the code, the operators are equivalent to:

```
DoStuff(a + 1)

int temp = a + 1;
DoStuff(temp); 
```

* * *

```
DoStuff(++a)

a = a + 1;
DoStuff(a); 
```

* * *

```
DoStuff(a++);

int temp = a;
a = a + 1;
DoStuff(temp); 
```

* * *

It is important to note that post-increment is **not** equivalent to:

```
DoStuff(a);
a = a + 1; 
```

* * *

Additionally, as a point of style, one shouldn't increment a value unless the intention is to use the incremented value (a specific version of the rule, "don't assign a value to a variable unless you plan on using that value"). If the value `i + 1` is never used again, then the preferred usage should be `DoStuff(i + 1)` and not `DoStuff(++i)`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-22T11:58:39.593

The first is using the value in level and THEN incrmenting it.

The latter is using level+1 as a passed variable.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-22T11:59:56.847

`level++` returns the current value of `level`, then increments `level`. `level+1` doesn't change `level` at all, but `DoStuff` is called with the value of `(level + 1)`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-22T12:11:16.863

```
public DoStuff(int level)
{

  // DoStuff(level);
  DoStuff(level++);
  // level = level + 1;
  // here, level's value is 1 greater than when it came in
} 
```

It actually increments the value of level.

```
public DoStuff(int level)
{
  // int iTmp = level + 1;
  // DoStuff(iTmp);
  DoStuff(level+1);
  // here, level's value hasn't changed
} 
```

doesn't actually increment the value of level.

Not a huge problem before the function call, but after the function call, the values will be different.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-22T13:05:45.953

在 level++ 中，您使用的是后缀运算符。该运算符在使用变量后起作用。也就是说，在它被放入被调用函数的堆栈之后，它就会递增。另一方面，level + 1 是简单的数学表达式，它被评估并将结果传递给被调用的函数。如果要先递增变量，然后将其传递给被调用函数，可以使用前缀运算符：++level

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-22T11:58:51.620

The first code snippet uses the post-operation increment operator, so the call is made as DoStuff(level);. If you want to use an increment operator here, use DoStuff(++level);.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-22T12:02:38.523

level+1 sends whatever level+1 is to the function. level++ sends level to the function and then increments it.

You could do ++level and that would likely give you the results you want.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-22T12:02:49.177

The first example uses the value of 'index', increments the value and **updates** 'index'.

The second example uses the value of 'index' plus 1 but does not change the content of 'index'.

So, depending on what you are wanting to do here, there could be some surprises in store!

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-22T12:13:31.460

Whilst it is tempting to rewrite as:

```
DoStuff(++level); 
```

I personally think this is less readable than incrementing the variable prior to the method call. As noted by a couple of the answers above, the following would be clearer:

```
level++;
DoStuff(level); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-22T12:49:42.670

当您使用允许运算符重载的语言时，'+ <integer>' 已被定义为执行后置和前缀 '++' 之外的其他操作。

再说一次，我只在学校项目中看到过这种可憎的事*，如果你在野外遇到这种情况，你可能有一个非常好的、有据可查的理由。

[* 一堆整数，如果我没记错的话。'++' 和 '--' 推送和弹出，而 '+' 和 '-' 执行正常算术]

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-09-14T21:46:26.660

用最简单的方式来说，`++var`它是一个前缀运算符，它将在计算表达式的其余部分**之前递增变量。**，一个后缀运算符，在计算表达式的其余部分**后**`var++`递增一个变量。当然，正如其他人所提到的，它只创建一个临时变量（在内存中单独），它以 constant 启动并递增。**`var+1``var``1`**

 *** * *

## 回答 #15

> 赞同：-2
> 
> 时间：2008-09-22T12:05:08.673

As far as my experience goes, the parameter expression is evaluated first, and gets a value of level. The variable itself is incremented before the function is called, because the compiler doesnt care whether you are using the expression as a parameter or otherwise... All it knows is that it should increment the value and get the old value as the result of the expression.

However in my opinion, code like this is really sloppy, since by trying to be clever, it makes you have to think twice about what is really happening.

# vim - Vim 中的快速字数统计功能

> ID：114431
> 
> 赞同：36
> 
> 时间：2008-09-22T11:58:22.560
> 
> 标签：vim

我正在尝试在 vim 状态行中显示实时字数。为此，我在 .vimrc 中设置状态行并在其中插入一个函数。这个函数的想法是返回当前缓冲区中的单词数。这个数字随后会显示在状态行上。这应该可以很好地工作，因为几乎每一个可能的机会都会更新状态行，因此计数将始终保持“实时”。

问题是我当前定义的函数很慢，所以当 vim 用于除最小文件之外的所有文件时，它显然很慢；由于此功能执行如此频繁。

总而言之，有没有人有一个聪明的技巧来生成一个函数，该函数在计算当前缓冲区中的单词数并返回结果时非常快？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2011-01-03T20:39:25.360

我真的很喜欢上面迈克尔邓恩的回答，但我发现当我编辑它导致我无法访问最后一列。所以我对函数做了一个小改动：

```
function! WordCount()
   let s:old_status = v:statusmsg
   let position = getpos(".")
   exe ":silent normal g\<c-g>"
   let stat = v:statusmsg
   let s:word_count = 0
   if stat != '--No lines in buffer--'
     let s:word_count = str2nr(split(v:statusmsg)[11])
     let v:statusmsg = s:old_status
   end
   call setpos('.', position)
   return s:word_count 
endfunction 
```

我已将它包含在我的状态行中，没有任何问题：

`:set statusline=wc:%{WordCount()}`

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-16T13:13:01.353

这是 Rodrigo Queiro 想法的可用版本。它不会更改状态栏，而是恢复 statusmsg 变量。

```
function WordCount()
  let s:old_status = v:statusmsg
  exe "silent normal g\<c-g>"
  let s:word_count = str2nr(split(v:statusmsg)[11])
  let v:statusmsg = s:old_status
  return s:word_count
endfunction 
```

这似乎足够快，可以直接包含在状态行中，例如：

```
:set statusline=wc:%{WordCount()} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-22T12:09:42.157

为当前行保留一个计数，为缓冲区的其余部分保留一个单独的计数。当您在当前行键入（或删除）单词时，仅更新该计数，但显示当前行计数和其余缓冲区计数的总和。

当您更改行时，将当前行数添加到缓冲区计数中，计算当前行中的字数，然后 a) 设置当前行数，然后 b) 从缓冲区数中减去它。

定期重新计算缓冲区也是明智的（请注意，您不必一次计算整个缓冲区，因为您知道在哪里进行编辑）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-22T18:04:59.790

`updatetime`这将在您停止输入一段时间（特别是ms）时重新计算字数。

```
let g:word_count="<unknown>"
fun! WordCount()
    return g:word_count
endfun
fun! UpdateWordCount()
    let s = system("wc -w ".expand("%p"))
    let parts = split(s, ' ')
    if len(parts) > 1
        let g:word_count = parts[0]
    endif
endfun

augroup WordCounter
    au! CursorHold * call UpdateWordCount()
    au! CursorHoldI * call UpdateWordCount()
augroup END

" how eager are you? (default is 4000 ms)
set updatetime=500

" modify as you please...
set statusline=%{WordCount()}\ words 
```

享受！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-22T12:51:53.773

所以我写了：

```
函数计数字（）
    exe“正常g\”
    让单词=替换（v：statusmsg，“^.*单词[^]* of”，“”，“”）
    让单词 = 替代（单词，“;.*”，“”，“”）
    回话
结束函数

```

但它会将信息打印到状态栏，所以我认为它不适合您的用例。不过，它非常快！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-24T09:25:54.677

为此，我使用了稍微不同的方法。我没有确保字数统计功能特别快，而是仅在光标停止移动时调用它。这些命令将执行此操作：

```
:au CursorHold * exe "normal g\<c-g>"
:au CursorHoldI * exe "normal g\<c-g>" 
```

也许不是提问者想要的，但比这里的一些答案要简单得多，而且对于我的用例来说已经足够好了（在输入一两个句子后向下看字数）。

设置`updatetime`为较小的值在这里也有帮助：

```
set updatetime=300 
```

字数统计没有巨大的开销轮询，因为`CursorHold`并且`CursorHoldI`仅在光标停止移动时触发*一次*`updatetime`，而不是每毫秒触发一次。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-09-19T13:17:01.143

这是对 Abslom Daak 答案的改进，它也适用于视觉模式。

```
function! WordCount()
  let s:old_status = v:statusmsg
  let position = getpos(".")
  exe ":silent normal g\<c-g>"
  let stat = v:statusmsg
  let s:word_count = 0
  if stat != '--No lines in buffer--'
    **if stat =~ "^Selected"
      let s:word_count = str2nr(split(v:statusmsg)[5])
    else
      let s:word_count = str2nr(split(v:statusmsg)[11])
    end**
    let v:statusmsg = s:old_status
  end
  call setpos('.', position)
  return s:word_count 
endfunction 
```

像以前一样包含在状态行中。这是一个右对齐的状态行：

`set statusline=%=%{WordCount()}\ words\`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-02-19T22:47:21.973

# 从`vim`版本 7.4.1042

从`vim`版本 7.4.1042 开始，可以简单地更改`statusline`如下：

```
set statusline+=%{wordcount().words}\ words
set laststatus=2    " enables the statusline. 
```

# 字数统计`vim-airline`

字数是[`vim-airline`](https://github.com/vim-airline/vim-airline#vim-airline---)许多文件类型的标准，在撰写本文时： [`asciidoc, help, mail, markdown, org, rst, tex ,text`](https://github.com/vim-airline/vim-airline/blob/master/autoload/airline/extensions/wordcount.vim#L90)

如果 中未显示字数`vim-airline`，则通常这是由于文件类型无法识别。例如，[至少目前](https://github.com/vim-airline/vim-airline/pull/2075)，复合文件类型[`markdown.pandoc`](https://github.com/vim-pandoc/vim-pandoc-syntax#standalone)无法被`vim-airline`字数识别。这可以通过`.vimrc`如下修改来轻松解决：

```
let g:airline#extensions#wordcount#filetypes = '\vasciidoc|help|mail|markdown|markdown.pandoc|org|rst|tex|text'
set laststatus=2    " enables vim-airline. 
```

该`\v`语句覆盖默认`g:airline#extensions#wordcount#filetypes`变量。最后一行确保`vim-airline`启用。

如有疑问，`&filetype`在发出以下命令时会返回已打开文件的 ：

```
:echo &filetype 
```

这是一个元示例：

![vim-航空公司字数](https://i.imgur.com/9RynwBY.png)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-05-08T23:14:37.873

我从有关编写函数的 vim 帮助页面中获取了大部分内容。

```
function! WordCount()
  let lnum = 1
  let n = 0
  while lnum <= line('$')
    let n = n + len(split(getline(lnum)))
    let lnum = lnum + 1
  endwhile
  return n
endfunction 
```

当然，和其他人一样，您需要：

```
:set statusline=wc:%{WordCount()} 
```

我确信有人可以清理它以使其更具活力（s：n 而不仅仅是 n？），但我相信基本功能就在那里。

编辑：

再看一遍，我真的很喜欢 Mikael Jansson 的解决方案。我不喜欢炮轰`wc`（不便携，也许很慢）。如果我们用`UpdateWordCount`我上面的代码替换他的函数（将我的函数重命名为`UpdateWordCount`），那么我认为我们有更好的解决方案。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-05-11T04:38:57.817

我的建议：

```
function! UpdateWordCount()
  let b:word_count = eval(join(map(getline("1", "$"), "len(split(v:val, '\\s\\+'))"), "+"))
endfunction

augroup UpdateWordCount
  au!
  autocmd BufRead,BufNewFile,BufEnter,CursorHold,CursorHoldI,InsertEnter,InsertLeave * call UpdateWordCount()
augroup END

let &statusline='wc:%{get(b:, "word_count", 0)}' 
```

我不确定这与其他一些解决方案的速度相比如何，但它肯定比大多数解决方案简单得多。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-01-07T22:01:03.740

我是 Vim 脚本的新手，但我可能会建议

```
function WordCount()
    redir => l:status
    exe "silent normal g\<c-g>"
    redir END
    return str2nr(split(l:status)[11])
endfunction 
```

因为它不会覆盖现有的状态行，所以更清洁。

我发帖的原因是指出这个函数有一个令人费解的错误：即它破坏了 append 命令。点击`A`应该让您进入插入模式，光标位于该行最后一个字符的右侧。但是，启用此自定义状态栏后，它会将您置于最后一个字符的左侧。

有人知道是什么原因造成的吗？

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-08-16T18:57:22.083

这是对[Michael Dunn 版本](https://stackoverflow.com/a/553257/1604120)的改进，缓存了字数，因此需要的处理更少。

```
function! WC()
    if &modified || !exists("b:wordcount") 
            let l:old_status = v:statusmsg  
            execute "silent normal g\<c-g>"
            let b:wordcount = str2nr(split(v:statusmsg)[11])
            let v:statusmsg = l:old_status  
            return b:wordcount
    else
            return b:wordcount
    endif
endfunction 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-02-20T18:26:29.927

由于 vim 现在本机支持此功能：

```
:echo wordcount().words 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-23T11:19:05.547

使用史蒂夫莫耶提供的答案中的方法，我能够产生以下解决方案。恐怕这是一个相当不雅的hack，我觉得必须有一个更简洁的解决方案，但它有效，并且比每次更新状态行时简单地计算缓冲区中的所有单词要快得多。我还应该注意，此解决方案与平台无关，并且不假定系统具有“wc”或类似的东西。

我的解决方案不会定期更新缓冲区，但 Mikael Jansson 提供的答案将能够提供此功能。到目前为止，我还没有发现我的解决方案不同步的情况。然而，我只是简单地测试了这一点，因为准确的实时字数对我的需求并不重要。我用于匹配单词的模式也很简单，适用于简单的文本文档。如果有人对模式或任何其他建议有更好的想法，请随时发布答案或编辑这篇文章。

我的解决方案：

```
"returns the count of how many words are in the entire file excluding the current line 
"updates the buffer variable Global_Word_Count to reflect this
fu! OtherLineWordCount() 
    let data = []
    "get lines above and below current line unless current line is first or last
    if line(".") > 1
        let data = getline(1, line(".")-1)
    endif   
    if line(".") < line("$")
        let data = data + getline(line(".")+1, "$") 
    endif   
    let count_words = 0
    let pattern = "\\<\\(\\w\\|-\\|'\\)\\+\\>"
    for str in data
        let count_words = count_words + NumPatternsInString(str, pattern)
    endfor  
    let b:Global_Word_Count = count_words
    return count_words
endf    

"returns the word count for the current line
"updates the buffer variable Current_Line_Number 
"updates the buffer variable Current_Line_Word_Count 
fu! CurrentLineWordCount()
    if b:Current_Line_Number != line(".") "if the line number has changed then add old count
        let b:Global_Word_Count = b:Global_Word_Count + b:Current_Line_Word_Count
    endif   
    "calculate number of words on current line
    let line = getline(".")
    let pattern = "\\<\\(\\w\\|-\\|'\\)\\+\\>"
    let count_words = NumPatternsInString(line, pattern)
    let b:Current_Line_Word_Count = count_words "update buffer variable with current line count
    if b:Current_Line_Number != line(".") "if the line number has changed then subtract current line count
        let b:Global_Word_Count = b:Global_Word_Count - b:Current_Line_Word_Count
    endif   
    let b:Current_Line_Number = line(".") "update buffer variable with current line number
    return count_words
endf    

"returns the word count for the entire file using variables defined in other procedures
"this is the function that is called repeatedly and controls the other word
"count functions.
fu! WordCount()
    if exists("b:Global_Word_Count") == 0 
        let b:Global_Word_Count = 0
        let b:Current_Line_Word_Count = 0
        let b:Current_Line_Number = line(".")
        call OtherLineWordCount()
    endif   
    call CurrentLineWordCount()
    return b:Global_Word_Count + b:Current_Line_Word_Count
endf

"returns the number of patterns found in a string 
fu! NumPatternsInString(str, pat)
    let i = 0
    let num = -1
    while i != -1
        let num = num + 1
        let i = matchend(a:str, a:pat, i)
    endwhile
    return num
endf 
```

然后通过以下方式将其添加到状态行：

```
:set statusline=wc:%{WordCount()} 
```

我希望这可以帮助任何在 Vim 中寻找实时字数统计的人。尽管并不总是准确的。或者，当然 g ctrl-g 将为您提供 Vim 的字数统计！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-07-03T18:16:59.637

万一其他人从谷歌来到这里，我修改了 Abslom Daak 的答案以与[Airline](https://github.com/bling/vim-airline)合作。我将以下内容保存为

`~/.vim/bundle/vim-airline/autoload/airline/extensions/pandoc.vim`

并添加

`call airline#extensions#pandoc#init(s:ext)`

到`extensions.vim`

```
let s:spc = g:airline_symbols.space

function! airline#extensions#pandoc#word_count()
if mode() == "s"
    return 0
else
    let s:old_status = v:statusmsg
    let position = getpos(".")
    let s:word_count = 0
    exe ":silent normal g\<c-g>"
    let stat = v:statusmsg
    let s:word_count = 0
    if stat != '--No lines in buffer--'
        let s:word_count = str2nr(split(v:statusmsg)[11])
        let v:statusmsg = s:old_status
    end
    call setpos('.', position)
    return s:word_count 
end
endfunction

function! airline#extensions#pandoc#apply(...)
if &ft == "pandoc"
    let w:airline_section_x = "%{airline#extensions#pandoc#word_count()} Words"
endif
endfunction

function! airline#extensions#pandoc#init(ext)
call a:ext.add_statusline_func('airline#extensions#pandoc#apply')
endfunction 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-06-13T18:47:54.573

Guy Gur-Ari[改进](https://stackoverflow.com/a/18895724/3528522)的一种变体

*   仅在启用拼写检查时才计算单词，
*   在可视模式下计算所选单词的数量
*   在插入和正常模式之外保持静音，并且
*   希望对系统语言更加不可知（与英语不同时）

```
function! StatuslineWordCount()
  if !&l:spell
    return ''
  endif

  if empty(getline(line('$')))
    return ''
  endif
  let mode = mode()
  if !(mode ==# 'v' || mode ==# 'V' || mode ==# "\<c-v>" || mode =~# '[ni]')
    return ''
  endif

  let s:old_status = v:statusmsg
  let position = getpos('.')
  let stat = v:statusmsg
  let s:word_count = 0
  exe ":silent normal g\<c-g>"
  try
    if mode ==# 'v' || mode ==# 'V'
      let s:word_count = split(split(v:statusmsg, ';')[1])[0]
    elseif mode ==# "\<c-v>"
      let s:word_count = split(split(v:statusmsg, ';')[2])[0]
    elseif mode =~# '[ni]'
      let s:word_count = split(split(v:statusmsg, ';')[2])[3]
    end
  " index out of range
  catch /^Vim\%((\a\+)\)\=:E\%(684\|116\)/
    return ''
  endtry
  let v:statusmsg = s:old_status
  call setpos('.', position)

  return "\ \|\ " . s:word_count . 'w'
endfunction 
```

可以附加到状态行，比如说，

```
 set statusline+=%.10{StatuslineWordCount()}     " wordcount 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-05-27T13:27:38.100

基于[https://stackoverflow.com/a/60310471/11001018](https://stackoverflow.com/a/60310471/11001018)，我的建议是：

```
"new in vim 7.4.1042
let g:word_count=wordcount().words
function WordCount()
    if has_key(wordcount(),'visual_words')
        let g:word_count=wordcount().visual_words."/".wordcount().words
    else
        let g:word_count=wordcount().cursor_words."/".wordcount().words
    endif
    return g:word_count
endfunction 
```

进而：

```
set statusline+=\ w:%{WordCount()}, 
```

# java - 在不同的 JRE 上运行 Java 类文件的后果？

> ID：114457
> 
> 赞同：3
> 
> 时间：2008-09-22T12:05:06.473
> 
> 标签：java, java1.4

在 JRE 1.6 或 1.5 上运行用 JDK 1.4.2 编译的 Java 类文件有什么后果？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-22T12:31:40.827

[Java SE 6 兼容性](http://java.sun.com/javase/6/webnotes/compatibility.html)页面列出了 Java SE 6 与 Java SE 5.0 的兼容性。此外，还有一个指向[J2SE 5.0（自 1.4.2 起）](http://java.sun.com/j2se/1.5.0/compatibility.html)中的不兼容性的链接。通过查看这两个文档，应该可以找出在 JDK 1.4.2 和 Java SE 6 下编写的程序是否存在不兼容问题。

在 Java 类文件的二进制兼容性方面，Java SE 6 兼容性页面有以下说法：

> Java SE 6 与 J2SE 5.0 向上二进制兼容，除了 下面列出的[不兼容性。](http://java.sun.com/javase/6/webnotes/compatibility.html#incompatibilities)除了提到的不兼容性之外，使用 5.0 版编译器构建的类文件将在 JDK 6 中正确运行。

因此，一般来说，正如[workmad3 所](https://stackoverflow.com/questions/114457/consequences-of-running-a-java-class-file-on-different-jres#114473)指出的，在旧 JDK 上编译的 Java 类文件仍将与最新版本兼容。此外，正如[Desty](https://stackoverflow.com/questions/114457/consequences-of-running-a-java-class-file-on-different-jres#114480)所指出的，对 API 的任何更改通常都会被弃用而不是被删除。

从[源兼容性](http://java.sun.com/javase/6/webnotes/compatibility.html#source)部分：

> 不推荐使用的 API 是仅支持向后兼容的接口。每当使用其中之一时，javac 编译器都会生成一条警告消息，除非使用了 -nowarn 命令行选项。建议修改程序以消除对已弃用 API 的使用，尽管目前没有计划从系统中完全删除此类 API，但 JVMDI 和 JVMPI 除外。

[Java SE 6 性能白皮书](http://java.sun.com/performance/reference/whitepapers/6_performance.html)中有很长的性能改进列表。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-22T12:28:28.867

Java 类是**前向**兼容的，例如使用 1.5 编译器生成的类将在 JRE 1.6 上成功加载和执行**而不会出现任何问题。**一般来说，今天的 java 编译器生成的类将与未来的 JRE 兼容（例如 Java7）

反过来不成立：您不能在较旧的 JRE（1.3、1.4 等）上运行 1.6 生成的类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T12:30:38.753

Java 编译器指定源和目标合规级别。这样，您可以从任何其他更高版本的 JRE 编译任何 JRE。您需要确保使用这些合规级别，因为 JRE 之间存在 API 差异。例如，JRE 1.5 在编译器级别引入了 StringBuilder。这意味着任何时候你这样做：

```
String s = "string1" + "string2"; 
```

编译器将其更改为：

```
String s = new StringBuilder("string1").append("string2").toString(); 
```

显然，当您尝试构造 StringBuilder 时，这将因 NoClassDefFoundError 而中断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T12:08:08.900

理论上，没什么。JVM 应该是向后兼容的。我自己，在那个方向上我从来没有遇到过问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T12:09:13.623

完全取决于您使用的 java 库的哪些部分。它可以是从“绝对没问题，没有任何区别”到“天哪！！为什么它刚刚格式化了我的硬盘？？（好吧，也许不是第二个，但它有助于支持它从无到有可能变得糟糕 :)）。

您的课程也可以在库中修复错误，这意味着琐碎的错误会消失（或者可以根据您是否依赖错误行为来引入）。

AFAIK 虽然，java 字节码是向后兼容的，所以你不应该遇到任何问题，只是什么都不做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T12:11:18.940

一个积极的结果是 1.4 类仍将利用对 JVM 的速度改进（尽管对库类没有必要的改进）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T12:21:23.987

我自己也遇到了这样的问题。我正在编写应该与 1.6 一起使用的代码，但学院安装了 1.3。很多方法都行不通，即

input = ""+ JOptionPane.showInputDialog(null,"输入一个四位数字到" + (b?"encrypt":"decrypt")+".",(b?"4086":"5317"));

行不通，但是

input = ""+ JOptionPane.showInputDialog(null,"输入一个四位数字到" + (b?"encrypt":"decrypt")+".");

将。接受三个参数的 inputdialog 方法在 1.3 中并不存在。

这只是说在 1.3 上使用 1.6 api 会导致头部撞击事件。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-09-22T12:10:52.450

它应该工作。我不记得遇到过任何问题，除非 Java API 的某些部分已被弃用，在这种情况下，它会解释它们是什么，您可以希望编写一个解决方法。当然，在 JRE 1.5 中运行使用 JDK 1.6 编译的类文件会导致问题——即使是 JRE 仅较小的构建版本较旧也会引发错误。

# sql-server-2008 - Upgrade MSDE to SQL Server 2008

> ID：114472
> 
> 赞同：0
> 
> 时间：2008-09-22T12:09:03.237
> 
> 标签：sql-server-2008, msde

I am trying to upgrade an named instance of MSDE to SQL Server 2008 Express. When I get to the "Select Features" page of the 2008 installer there are no instances listed. The upgrade to SQL Server 2005 Express (on the same VM image) however works fine.

It seems to be a supported scenario ([http://msdn.microsoft.com/en-us/library/ms143393.aspx](http://msdn.microsoft.com/en-us/library/ms143393.aspx)), yet I am finding that it does not work. Has anyone successfully done this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T12:16:18.897

It looks to be supported: [http://msdn.microsoft.com/en-us/library/ms143393.aspx](http://msdn.microsoft.com/en-us/library/ms143393.aspx)

There are also comments you might find useful.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-21T19:11:18.217

我刚刚遇到了同样的问题，所以我会为在这个线程上发生的任何人发布我的解决方案；

您可能会在该屏幕上看到您的命名实例，但它是灰色的。检查您是否拥有适用于 MSDE 的 SP4，即版本 8.0.2039。

# unit-testing - 如何为 MS Test 创建自定义属性？

> ID：114478
> 
> 赞同：12
> 
> 时间：2008-09-22T12:10:39.363
> 
> 标签：unit-testing, mstest

如果你想为 MS 测试创建一个自定义属性（比如 [Repeat(3)] 你会怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T14:09:46.470

我认为您不会喜欢答案：没有受支持的方式。但是，有一个 codeplex 项目[MSTestExtensions](http://www.codeplex.com/MSTestExtensions)实现了一个变通方法和一篇关于 MSTestExtensions 如何工作的[博客文章。](http://callumhibbert.blogspot.com/2008/01/extending-mstest.html)（使用 ContextBoundObject）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T18:39:09.210

Roy，如果您使用 Typemock Isolator，您可以使用 AOP 装饰器来扩展任何测试框架。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-22T12:22:10.303

查看更多，这里是一个可能的起点： [Peli 的博客](http://blog.dotnetwiki.org/IntroducingYUnitAMicroscopicUnitTestFrameworkForTeamTest.aspx)

我仍在寻找其他好的资源或示例。

# vba - 确定范围内的行数

> ID：114493
> 
> 赞同：17
> 
> 时间：2008-09-22T12:15:03.750
> 
> 标签：vba, excel

我知道列表开头的范围名称 -`1`列宽和`x`行深。

我该如何计算`x`？

该列中的数据不仅仅是此列表。但是，此列表是连续的 - 在其上方或下方或旁边的任何一侧的任何单元格中都没有任何内容。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-08-05T14:35:11.070

```
Sheet1.Range("myrange").Rows.Count 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-22T12:21:54.810

```
Function ListRowCount(ByVal FirstCellName as String) as Long
    With thisworkbook.Names(FirstCellName).RefersToRange
        If isempty(.Offset(1,0).value) Then 
            ListRowCount = 1
        Else
            ListRowCount = .End(xlDown).row - .row + 1
        End If
    End With
End Function 
```

但是，如果您确定列表中没有任何内容，那么只需`thisworkbook.Names(FirstCellName).RefersToRange.CurrentRegion.rows.count`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-24T12:21:22.643

为什么不使用 Excel 公式来确定行？例如，如果您要查找 A 列中有多少单元格包含数据，请使用以下命令：

=COUNTIFS(A:A,"<>")

您可以将 <> 替换为任何值，以获取其中包含该值的行数。

=COUNTIFS(A:A,"2008")

这也可以用于查找连续填充的单元格。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-22T14:19:22.563

您还可以使用：

```
Range( RangeName ).end(xlDown).row 
```

从您的命名范围开始查找包含数据的最后一行。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-22T12:36:56.647

我相信您可能想要@GSerg 给出的答案。还有一个名为的工作表函数`rows`，它将为您提供行数。

因此，如果您有一个名为`Data`7 行的命名数据范围，则`=ROWS(Data)`该单元格中将显示 7。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-22T12:41:04.327

最后一行完美地工作@GSerg。

另一个功能是我一直在研究的功能，但除非绝对必要，否则我不喜欢求助于 UDF。

我一直在尝试将 excel 和 vba 结合起来，并让它发挥作用——但与你的答案相比，它显得笨拙。

```
strArea = Sheets("Oper St Report CC").Range("cc_rev").CurrentRegion.Address
cc_rev_rows = "=ROWS(" & strArea & ")"
Range("cc_rev_count").Formula = cc_rev_rows 
```

# css - 如何将背景位置设置为从右开始的绝对距离？

> ID：114501
> 
> 赞同：26
> 
> 时间：2008-09-22T12:18:03.447
> 
> 标签：css

我想为 div 设置背景图像，使其位于div 的**右上方**`10px`，但与顶部和右侧的距离固定。

**如果想要它在div**的左上角，我会这样做：

```
背景：url(images/img06.gif) no-repeat 10px 10px;
```

有没有办法达到相同的结果，但在**右上方**显示背景？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-03-30T12:34:30.587

[在所有现代浏览器和 IE 甚至版本 9 中，您都可以使用CSS3](http://www.w3.org/TR/css3-background/#background-position)中指定的四值语法：

```
background-position: right 10px top 10px; 
```

来源：[MDN](https://developer.mozilla.org/en/CSS/background-position)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-22T12:47:19.697

使用前面提到的规则以及顶部和右侧边距：

```
background: url(images/img06.gif) no-repeat top right;
margin-top: 10px;
margin-right: 10px; 
```

背景图像仅出现在填充内，而不是边距内。如果添加边距不是一个选项，您可能不得不求助于另一个 div，尽管我建议您仅将其用作最后的手段，以尽量使您的标记保持精简和语义。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-22T12:23:39.377

有几种方法可以做到这一点。

1.  如果可能的话，自己做数学。您已经知道图像的尺寸。如果你知道 div 的尺寸，你可以把图像放在 (div width - image width - 10, div height - image height - 10)。

2.  使用 Javascript 为您完成繁重的工作。与上面的方法几乎相同，只是您不需要知道 div 本身的尺寸。Javascript可以告诉你。

3.  一个更骇人听闻的方法是在图像的顶部和右侧放置一个 10 像素的透明边框，并将位置设置为`top right`.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-22T12:22:38.210

不知道纯css是否可以，可以试试

```
background: url(images/img06.gif) no-repeat top right; 
```

并修改您的图像以在顶部和右侧以透明颜色合并一个 10 像素的边框

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-22T12:49:10.720

您可以使用百分比：

```
background: url(...) top 98% no-repeat; 
```

如果您知道父 div 的宽度，则应该很容易确定您需要使用的百分比。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T12:23:41.717

一种解决方案是绝对定位一个空的`div`，并为其提供背景。我不相信有一种方法可以纯粹用 CSS 来完成，不改变图像，并且在流畅的布局中没有额外的标记。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-04T01:22:12.140

您可以用像素边框伪造右侧的空间（大多数时候是白色的，或者可能是其他东西）

```
 background-image: url(../images/calender.svg) center right
  border-right: 5px white solid 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-02-03T18:21:48.173

正确的格式是：

```
background: url(YourUrl) 0px -50px no-repeat; 
```

where`0px`是水平位置，`-50px`是垂直位置。

CSS`background-position`接受负值。

# .net - 是否可以将 ID 集合作为 ADO.NET SQL 参数发送？

> ID：114504
> 
> 赞同：20
> 
> 时间：2008-09-22T12:19:10.090
> 
> 标签：.net, sql, ado.net

例如。我可以写这样的代码吗：

```
public void InactiveCustomers(IEnumerable<Guid> customerIDs)
{
    //...
    myAdoCommand.CommandText =
        "UPDATE Customer SET Active = 0 WHERE CustomerID in (@CustomerIDs)";
    myAdoCommand.Parameters["@CustomerIDs"].Value = customerIDs;
    //...
} 
```

我知道的唯一方法是加入我的 IEnumerable，然后使用字符串连接来构建我的 SQL 字符串。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-22T12:52:25.860

通常，您执行此操作的方法是传入一个逗号分隔的值列表，然后在您的存储过程中，解析该列表并将其插入到一个临时表中，然后您可以将其用于连接。从**Sql Server 2005 开始**，这是处理需要保存数组的参数的标准做法。

这是一篇关于处理此问题的各种方法的好文章：

[将列表/数组传递给 SQL Server 存储过程](http://vyaskn.tripod.com/passing_arrays_to_stored_procedures.htm)

但是对于**Sql Server 2008**，我们最终将表变量传递到过程中，首先将表定义为自定义类型。

本文对此（以及更多 2008 功能）有很好的描述：

[SQL Server 2008 中新的 T-SQL 可编程功能简介](http://technet.microsoft.com/en-us/library/cc721270.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-22T12:56:05.073

您可以使用[SQL 2008](http://blog.benhall.me.uk/2007/07/sql-server-2008-table-value-parameters.html)。出来的时间不长，但它是可用的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-29T08:07:47.980

正如[评论中提到的](https://stackoverflow.com/questions/114504/is-it-possible-to-send-a-collection-of-ids-as-a-ado-net-sql-parameter#comment1039858_114685)，Erland Sommarskog 写了一系列关于这个主题的文章（链接到下面）。文章很透彻，可以作为参考资料。虽然它们特定于 SQL Server (T-SQL)，但其中提到的一些技术也可能适用于其他 RDBMS（例如使用`XML`数据类型）：

*   **[SQL Server 2008 中使用表值参数的数组和列表](http://www.sommarskog.se/arrays-in-sql-2008.html)**：

    *   表值参数 (TVP)
*   **[SQL Server 2005 及更高版本中的数组和列表，当 TVP 不删除它时](http://www.sommarskog.se/arrays-in-sql-2005.html)**：

    *   标量值的字符串序列化和反序列化
    *   SQLCLR
    *   通过 XML 数据类型传递结构化列表数据
    *   动态 SQL
*   **[SQL Server 2000 及更早版本中的数组和列表](http://www.sommarskog.se/arrays-in-sql-2000.html)**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T13:00:21.817

您可以使用 xml 参数类型：

```
CREATE PROCEDURE SelectByIdList(@productIds xml) AS

DECLARE @Products TABLE (ID int) 

INSERT INTO @Products (ID) SELECT ParamValues.ID.value('.','VARCHAR(20)')
FROM @productIds.nodes('/Products/id') as ParamValues(ID) 

SELECT * FROM 
    Products
INNER JOIN 
    @Products p
ON    Products.ProductID = p.ID 
```

[http://weblogs.asp.net/jgalloway/archive/2007/02/16/passing-lists-to-sql-server-2005-with-xml-parameters.aspx](http://weblogs.asp.net/jgalloway/archive/2007/02/16/passing-lists-to-sql-server-2005-with-xml-parameters.aspx)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-09-22T12:29:05.433

没有。参数就像遵循[第一范式](http://www.anaesthetist.com/mnm/sql/normal.htm)的 SQL 值，基本上只能有一个...

您可能知道，生成 SQL 字符串是有风险的业务：您让自己面临[SQL 注入攻击](http://en.wikipedia.org/wiki/Sql_injection)。只要您正在处理真正的 GUID，您应该没问题，但否则您需要确保清理您的输入。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-22T12:31:09.047

您不能将列表作为单个 SQl 参数传递。您可以 string.Join(',') 诸如“0000-0000-0000-0000, 1111-1111-1111-1111”之类的 GUIDS，但这会增加数据库开销并且确实不是最佳的。而且您必须将整个字符串作为单个连接的动态语句传递，您不能将其添加为参数。

问题：

您从哪里获得代表不活跃客户的 ID 列表？

我的建议是用不同的方式处理这个问题。将所有这些逻辑移到数据库中，例如：

```
 Create procedure usp_DeactivateCustomers 
    @inactive varchar(50) /*or whatever values are required to identify inactive customers*/
    AS    
    UPDATE Customer SET c.Active = 0 
    FROM Customer c JOIN tableB b ON c.CustomerID = b.CustomerID 
    WHERE b.someField = @inactive 
```

并将其称为存储过程：

```
public void InactiveCustomers(string inactive)
{
    //...
    myAdoCommand.CommandText =
        "usp_DeactivateCustomers";
    myAdoCommand.Parameters["@inactive"].Value = inactive;
    //...
} 
```

* * *

如果数据库中存在 GUID 列表，我为什么需要：找到它们；将它们放在一个通用列表中；将列表展开为 CSV/XML/Table 变量，只是为了再次将它们呈现回 DB ????? 他们已经在那里了！我错过了什么吗？

# c# - Hide a gridView row in asp.net

> ID：114521
> 
> 赞同：2
> 
> 时间：2008-09-22T12:23:36.803
> 
> 标签：c#, asp.net

I am creating a `gridView` that allows adding new rows by adding the controls necessary for the insert into the `FooterTemplate`, but when the `ObjectDataSource` has no records, I add a dummy row as the `FooterTemplate` is only displayed when there is data.

How can I hide this dummy row? I have tried setting `e.row.visible = false` on `RowDataBound` but the row is still visible.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-11-06T03:42:57.483

请尝试以下

```
 protected void GridView1_DataBound(object sender, EventArgs e)
    {
        GridView1.Rows[0].Visible = false;
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-22T13:03:52.277

您可以处理 gridview 的数据绑定事件并隐藏虚拟行。（不要忘记在 aspx 代码中分配事件属性）：

```
protected void GridView1_DataBound(object sender, EventArgs e)
    {
        if (GridView1.Rows.Count == 1)
            GridView1.Rows[0].Visible = false;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T12:54:51.707

我认为这是你需要的：

```
<asp:GridView ID="grid" runat="server" AutoGenerateColumns="false" ShowFooter="true" OnRowDataBound="OnRowDataBound">
    <Columns>
        <asp:TemplateField HeaderText="headertext">
            <ItemTemplate>
                itemtext
            </ItemTemplate>
            <FooterTemplate>
                insert controls
            </FooterTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

和代码隐藏：

```
protected void OnRowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        e.Row.Attributes["style"] = "display:none";
    }
} 
```

但我不明白您为什么要将“插入控件”添加到页脚而不是将它们放在网格下方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T12:45:26.283

也许使用 CSS 来设置不显示？！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T12:22:17.563

要使其可见，只需使用：

```
Gridview.Rows.Item(i).Attributes.Add("style", "display:block") 
```

并让它不可见

```
Gridview.Rows.Item(i).Attributes.Add("style", "display:none") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T12:35:48.570

这是 GridView 控件的错误使用。GridView 控件有一个特殊的 InsertRow，这是您的控件应该去的地方。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T12:40:50.523

也许尝试：

```
e.Row.Height = Unit.Pixel(0); 
```

这不是正确的答案，但在您得到正确答案之前它可能会起作用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-22T14:09:36.783

GridView 有一个特殊的属性可以访问 Footer Row，名为“FooterRow”

然后，你冷试试 yourGrid.FooterRow.Visible = false;

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-22T14:20:05.417

我在以前的工作中这样做了，但是由于您可以添加行，所以我总是让它在页脚行中可见。为了使网格显示出来，我绑定了一个通常绑定类型的空行

```
dim row as Datarow = table.NewRow()
table.AddRow(row)
gridView.DataSource = table
gridView.Databind() 
```

然后它有所有的列，然后你需要。你可以通过拉这个来访问页脚：

```
'this will get the footer no matter how many rows there are in the grid.

Dim footer as Control = gridView.Controls(0).Controls(gridView.Controls(0).Controls.Count -1) 
```

然后要访问页脚中的任何控件，您将执行以下操作：

```
Dim cntl as Control = footer.FindControl(<Insert Control Name Here>) 
```

我假设您可以执行以下操作：

```
footer.Visible = false 
```

使页脚行不可见。

我希望这有帮助！

*编辑*我刚刚明白你说的是什么。当我添加新行时，我基本上会删除该行，但要执行此操作，您需要检查是否有任何其他行，如果有，请检查其中是否有值。

要删除虚拟行，请执行以下操作：

```
If mTable.Rows.Count = 1 AndAlso mTable.Rows(0)(<first column to check for null value>) Is DBNull.Value AndAlso mTable.Rows(0)(<second column>) Is DBNull.Value AndAlso mTable.Rows(0)(<thrid column>) Is DBNull.Value Then  
mTable.Rows.Remove(mTable.Rows(0))  
End If
mTable.Rows.Add(row)
gridView.Datasource = mTable
gridView.Databind() 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-29T13:39:30.960

为什么不使用 EmptyDataTemplate？即使我只使用了几天，它似乎也很有效......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-07-28T13:04:32.993

您应该在 GridView 中使用 DataKeyNames：

`<asp:GridView ID="GridView1" runat="server" DataKeyNames="FooID">`

然后在您的代码中检索它： `GridView1.DataKeys[0].Value.ToString()`

其中“0”是您想要获取“FooID”的行号

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-10-05T02:28:07.540

如果您不想在列/行为空时显示数据：

```
if (!String.IsNullOrEmpty(item.DataName))
{
    e.Row.Visible = false;
} 
```

* * *

## 回答 #13

> 赞同：-5
> 
> 时间：2012-03-23T18:31:36.737

可以通过 SQL 轻松完成

```
USE YourdatabaseName select * from TableName where Column_Name <> '' 
```

# javascript - 两个函数的区别？（“函数 x”与“var x = 函数”）

> ID：114525
> 
> 赞同：56
> 
> 时间：2008-09-22T12:24:06.583
> 
> 标签：javascript

> **可能重复：**
> [JavaScript：var functionName = function() {} vs function functionName() {}](https://stackoverflow.com/questions/336859/javascript-var-functionname-function-vs-function-functionname)

有什么区别：

```
function sum(x, y) {
  return x+y;
}

// and 

var sum = function (x, y) {
    return x+y;
} 
```

为什么使用一个而不是另一个？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-09-22T12:36:17.727

第一个称为命名函数，第二个称为匿名函数。

关键的实际区别在于何时可以使用 sum 函数。例如：-

```
var z = sum(2, 3);
function sum(x, y) {
    return x+y;
} 
```

`z`被分配 5 而这个：-

```
var z = sum(2, 3);
var sum = function(x, y) {
    return x+y;
} 
```

将失败，因为在第一行执行时变量 sum 尚未分配给函数。

命名函数在执行开始之前被解析并分配给它们的名称，这就是为什么命名函数可以在其定义之前的代码中使用的原因。

通过代码分配给函数的变量显然只能在执行通过分配后才能用作函数。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-22T12:36:48.130

第一个倾向于使用有几个原因：

1.  名称“sum”出现在堆栈跟踪中，这使得在许多浏览器中调试更容易。
2.  名称“sum”可以在函数体内使用，这使得递归函数更容易使用。
3.  函数声明在 javascript 中是“提升”的，因此在第一种情况下，保证函数只定义一次。
4.  分号插入原因

    ```
    var f = function (x) { return 4; }

    (f) 
    ```

    将 4 分配给`f`.

不过，有一些注意事项需要牢记。不要做

```
 var sum = function sum(x, y) { ... }; 
```

在 IE 6 上，因为它会导致创建两个函数对象。如果你这样做尤其令人困惑

```
 var sum = function mySym(x, y) { ... }; 
```

根据标准，函数 sum(x, y) { ... } 不能出现在 if 块或循环体中，因此不同的解释器会处理

```
 if (0) {
    function foo() { return 1; }
  } else {
    function foo() { return 2; }
  }
  return foo(); 
```

不同。在这种情况下，你应该这样做

```
 var foo;
  if (0) {
    foo = function () { return 1; }
  } ... 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-22T12:32:27.343

第一个是命名函数语句，第二个将匿名函数表达式分配给变量。

函数语句会立即添加到它的作用域中——您不需要在调用它之前运行它，所以它可以工作：

```
var y = sum(1, 2);

function sum(x, y) {
   return x + y;
} 
```

但是函数表达式只在代码执行时才赋值给变量，所以这行不通：

```
// Error here because the function hasn't been assigned to sum yet.
var y = sum(1, 2);

var sum = function(x, y) {
   return x + y;
} 
```

表达式形式的一个优点是您可以使用它在不同的点为表达式分配不同的函数 - 因此您可以更改函数，或在不同的条件下使用不同的函数（例如取决于所使用的浏览器）。

命名函数语句的一个优点是调试器将能够显示名称。虽然，您可以命名函数表达式：

```
var sum = function sum(x, y) {
   return x + y;
} 
```

但这可能会令人困惑，因为这两个名称实际上是在不同的范围内并指代不同的事物。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-04-20T04:31:40.093

对于几乎所有目的，您在此处发布的两个代码片段的行为方式都相同。

但是，行为上的不同在于，对于第二种变体，该函数只能在代码中的该点之后调用。

对于第一个变体，该函数可用于在声明函数的位置之上运行的代码。

这是因为对于第二个变体，函数在运行时被分配给变量 foo。首先，函数在解析时被分配给标识符 foo。

**更多技术信息**

Javascript 有三种定义函数的方式。

1.  您的第一个示例是**函数声明**。这使用*“function”语句*来创建一个函数。该函数在解析时可用，并且可以在该范围内的任何地方调用。您仍然可以稍后将其存储在变量或对象属性中。
2.  您的第二个片段显示了一个**函数表达式**。这涉及使用*“函数”运算符*创建一个函数 - 该运算符的结果可以存储在任何变量或对象属性中。这样，函数表达式就很强大了。函数表达式通常被称为“匿名函数”，因为它不必有名字，
3.  定义函数的第三种方法是**“Function()”构造函数**，您的原始帖子中没有显示。不建议使用它，因为它的工作方式与 eval() 相同，但存在问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-22T12:47:31.427

不同的是...

这是一个无名功能

```
var sum = function (x, y) {
    return x+y;
} 
```

所以如果你提醒（总和）；你得到 "function (x, y) { return x + y; }" (nameless) 虽然这是一个命名函数：

```
function sum(x, y) {
        return x+y;
} 
```

如果您警告（总和）；现在你得到 "function **sum** (x, y) { return x + y; }" (名字是 sum)

如果您使用探查器，命名函数会有所帮助，因为探查器可以告诉您函数**sum**的执行时间......等等，而不是未知函数的执行时间......等等

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T13:51:43.597

这是另一个例子： function sayHello(name) { alert('hello' + name) }

现在，假设您要修改按钮的 onclick 事件，例如“hello world”

你不能写：

yourBtn.onclik = sayHello('world')，因为你必须提供一个函数引用。

那么你可以使用第二种形式：yourBtn.onclick = function() { sayHello('workld'); }

Ps：对不起我的英语不好！

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2008-09-22T12:33:52.647

它们的意思完全相同。这只是语法糖。后者是 IMO 更能揭示 JavaScript 真正在做什么；即“sum”只是一个变量，用函数对象初始化，然后可以用其他东西代替：

```
$ js
js> function sum(x,y) { return x+y; }
js> sum(1,2);
3
js> sum=3
3
js> sum(1,2);
typein:4: TypeError: sum is not a function
js> sum
3 
```

# .net - 在 Windows 窗体 C# 应用程序中拥有配置文件的最简单方法

> ID：114527
> 
> 赞同：91
> 
> 时间：2008-09-22T12:24:59.670
> 
> 标签：.net, xml, winforms, configuration

我真的是 .NET 的新手，但我仍然不了解配置文件的工作原理。

每次我在谷歌上搜索它时，我都会得到关于 web.config 的结果，但我正在编写一个 Windows 窗体应用程序。

我发现我需要使用 System.Configuration 命名空间，但文档没有帮助。

如何定义我的配置文件是 XYZ.xml？或者它是否有配置文件的“默认”名称？我还是没明白。

另外，我如何定义一个新的部分？我真的需要创建一个继承自 ConfigurationSection 的类吗？

我只想有一个具有如下值的配置文件：

```
<MyCustomValue>1</MyCustomValue>
<MyCustomPath>C:\Some\Path\Here</MyCustomPath> 
```

有没有简单的方法来做到这一点？您能否以简单的方式解释如何读取/写入一个简单的配置文件？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2008-09-22T12:29:32.623

您想使用 App.Config。

当您向项目中添加新项目时，会有一个称为应用程序配置文件的东西。添加那个。

然后在 configuration/appsettings 部分添加键

像：

```
<configuration>
 <appSettings>
  <add key="MyKey" value="false"/> 
```

通过做访问成员

```
System.Configuration.ConfigurationSettings.AppSettings["MyKey"]; 
```

这适用于 .NET 2 及更高版本。

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2008-09-22T12:53:48.510

澄清以前的答案...

1.  向您的项目添加一个新文件（*添加*→*新项目*→*应用程序配置文件*）

2.  新的配置文件将在解决方案资源管理器中显示为*App.Config*。

3.  使用以下作为模板将您的设置添加到此文件中

    ```
    <configuration>
      <appSettings>
        <add key="setting1" value="key"/>
      </appSettings>
      <connectionStrings>
        <add name="prod" connectionString="YourConnectionString"/>
      </connectionStrings>
    </configuration> 
    ```

4.  像这样检索它们：

    ```
    private void Form1_Load(object sender, EventArgs e)
    {
        string setting = ConfigurationManager.AppSettings["setting1"];
        string conn = ConfigurationManager.ConnectionStrings["prod"].ConnectionString;
    } 
    ```

5.  构建后，您的输出文件夹将包含一个名为 <assemblyname>.exe.config 的文件。这将是*App.Config*文件的副本。开发人员无需进行任何进一步的工作即可创建此文件。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-09-23T00:56:10.520

从快速阅读前面的答案来看，它们看起来是正确的，但似乎没有人提到 Visual Studio 2008 中的新配置工具。它仍然使用*app.config*（在编译时复制到 YourAppName.exe.config），但是有一个 UI 小部件可以设置属性并指定它们的类型。双击项目“属性”文件夹中的*Settings.settings*。

最好的部分是从代码中访问这个属性是类型安全的——编译器会发现一些明显的错误，比如错误地输入了属性名。例如，*app.config*中名为 MyConnectionString 的属性将被访问为：

```
string s = Properties.Settings.Default.MyConnectionString; 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-22T12:39:17.937

您应该创建一个*App.config*文件（非常类似于*web.config*）。

您应该右键单击您的项目，添加新项目，然后选择新的*“应用程序配置文件”*。

确保在项目中使用 System.Configuration 添加。

然后您可以为其添加值：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <appSettings>
    <add key="setting1" value="key"/>
  </appSettings>
  <connectionStrings>
    <add name="prod" connectionString="YourConnectionString"/>
  </connectionStrings>
</configuration> 
```

* * *

```
 private void Form1_Load(object sender, EventArgs e)
    {
        string setting = ConfigurationManager.AppSettings["setting1"];
        string conn = ConfigurationManager.ConnectionStrings["prod"].ConnectionString;
    } 
```

* * *

请注意：[根据 Microsoft](http://msdn.microsoft.com/en-us/library/system.configuration.configurationsettings.aspx)，您应该使用 ConfigurationManager 而不是 ConfigurationSettings （请参阅备注部分）：

> “ConfigurationSettings 类仅提供向后兼容性。对于新应用程序，您应该改用 ConfigurationManager 类或 WebConfigurationManager 类。”

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-22T12:46:49.713

配置文件的默认名称是 [yourexe].exe.config。因此notepad.exe 将有一个名为notepad.exe.config 的配置文件，与程序位于同一文件夹中。这是 CLR 和 Framework 各个方面的通用配置文件，但它可以包含您自己的`<appSettings>`节点下的设置。

该`<appSettings>`元素创建了一个名称-值对的集合，可以作为`System.Configuration.ConfigurationSettings.AppSettings`. 但是，无法将更改保存回配置文件。

也可以将您自己的自定义元素添加到配置文件中 - 例如，定义结构化设置 - 通过创建实现的类`IConfigurationSectionHandler`并将其添加到`<configSections>`配置文件的元素中。然后，您可以通过调用来访问它`ConfigurationSettings.GetConfig`。

.NET 2.0 添加了一个新类 ，`System.Configuration.ConfigurationManager`它支持多个文件，每个用户覆盖每个系统数据。它还支持将修改后的配置保存回设置文件。

Visual Studio 会创建一个名为`App.config`的文件，并在生成项目时使用正确的名称将其复制到 EXE 文件夹中。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-22T12:30:17.100

关于 .NET 应用程序配置的最佳（恕我直言）文章位于 CodeProject，*[揭开 .NET 2.0 配置的奥秘](http://www.codeproject.com/KB/dotnet/mysteriesofconfiguration.aspx)*。我下一篇关于 .NET 配置文件中部分的最喜欢（较短）的文章是*[理解部分处理程序 - App.config 文件](http://www.codeproject.com/KB/aspnet/ConfigSections.aspx)*。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-22T12:33:27.187

在 Windows 窗体中，您拥有与`app.config`文件非常相似的`web.config`文件。但由于我认为您需要的是自定义值，因此我建议使用*Settings*。

为此，请打开您的项目属性，然后转到设置。如果设置文件不存在，您将有一个链接来创建一个。然后，您可以将设置添加到您在那里看到的表中，这将生成适当的 XML 和可用于加载和保存设置的*Settings类。*

设置类将命名为`DefaultNamespace.Properties.Settings`. 然后，您可以使用类似以下的代码：

```
using DefaultNamespace.Properties;

namespace DefaultNamespace {
    class Class {
        public int LoadMySettingValue() {
            return Settings.Default.MySettingValue;
        }
        public void SaveMySettingValue(int value) {
            Settings.Default.MySettingValue = value;
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-22T13:17:33.290

我同意将您指向 app.config 的其他答案。但是，您应该创建一个实用程序类（AppSettings 是我使用的名称）来读取它们并将它们作为属性公开，而不是直接从 app.config 读取值。AppSettings 类可用于聚合来自多个存储的设置，例如来自 app.config 的值和来自程序集（AssemblyVersion 和 AssemblyFileVersion）的应用程序版本信息。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-01T02:25:24.797

一个非常简单的方法是使用您[自己的自定义`Settings`类](https://stackoverflow.com/questions/577782/where-to-store-configuration-information/597835#597835)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-28T15:44:32.440

采用：

```
System.Configuration.ConfigurationSettings.AppSettings["MyKey"]; 
```

AppSettings 已被弃用，现在被认为已过时（[链接](http://msdn.microsoft.com/en-us/library/system.configuration.configurationsettings.appsettings(VS.80).aspx)）。

此外，*app.config*的 appSettings 部分已替换为*applicationSettings*部分。

正如其他人提到的，您应该使用 System.Configuration.ConfigurationManager ( [link](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager(VS.80).aspx) )，它是 .NET 2.0 的新功能。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-22T12:29:29.397

您使用的是什么版本的 .NET 和 Visual Studio？

创建新项目时，您的解决方案中应该有一个名为*app.config*的文件。那是默认的配置文件。

# database - 可视化设计数据库结构

> ID：114538
> 
> 赞同：9
> 
> 时间：2008-09-22T12:27:12.037
> 
> 标签：database, language-agnostic, database-design

我很高兴在创建数据库时手动编写表格，但这并不是将有关数据库的信息传达给其他人的最简单方法，尤其是那些不太习惯通过脚本对表格进行编码的人，而是会在 phpMyAdmin 上使用类似的东西.

因此是否有一个免费程序（对我来说，它必须在 Mac 上运行，但可以随意向其他具有相同 Q 的人推荐 PC 应用程序）或脚本（最好是 PHP 或 Python），允许您设计数据库结构，然后将输出用户选择的基本图表或代码？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-22T12:31:36.020

那么在 PC 上，您可以使用**MS Visio**生成**DB 实体图**。

它甚至可以对现有数据库中的一个进行逆向工程。

第一次使用时设置起来很痛苦，但此后非常方便。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-22T18:12:20.773

[开放系统架构师](http://www.codebydesign.com/)有一些潜力。它与 Visio 非常相似。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-22T12:35:44.670

我是来自 Tigris.org的[ARGO UML的忠实粉丝。](http://argouml.tigris.org/)使用标准 UML 表示法绘制漂亮的图片。它会生成一些代码，但主要是 Java 类，它们不是 SQL DDL，因此可能与您想要做的不够接近。

您可以查看[数据建模工具](http://www.databaseanswers.com/modelling_tools.htm)列表，看看是否有比 Argo UML 更好的东西。此列表中的许多项目都是免费或便宜的。

此外，如果您使用的是[Eclipse](http://www.eclipse.org/)或[NetBeans](http://www.netbeans.org/)，则有许多设计插件，其中一些可能具有您正在寻找的功能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-22T12:37:24.960

我使用恰当命名的[Database Design Tool](http://www.visi.com/~jjanssens/)。然而，它非常简单，不幸的是它已经被开发了。这是我遇到的最好的免费工具，在设计表的最后，它会为您生成 T-SQL。它也与语言无关。

![替代文字](https://i.stack.imgur.com/JGF93.jpg)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-22T12:31:18.597

您可以尝试源自开源 dbdesigner 的[MySQL Workbench 。](http://www.mysql.com/products/workbench/)有一个免费的社区版可用。您可以通过 er 图表设计数据库或对现有数据库进行反向工程。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-02-08T16:07:30.610

MySQL Workbench 是我尝试过的最好的数据库设计工具

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-12-14T09:52:03.277

我目前正在检查 SQL Power Architect（包括 PostgreSQL 和 Mysql——但它也支持其他供应商），它看起来肯定很有希望。执行正向和反向 SQL 工程。社区版是开源和跨平台 (Java)。您可以自己查看：[http ://code.google.com/p/power-architect/](http://code.google.com/p/power-architect/)

[到目前为止，当严格使用 MySQL 时，我使用了 MySQL Workbench， http:](http://wb.mysql.com/) //wb.mysql.com/， 它的性能可靠。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-22T12:36:42.093

我一直很喜欢 Eclipse。有[一些插件](http://www.eclipse-plugins.info/eclipse/plugins.jsp?category=Database)看起来像他们会做你想做的事。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-28T10:51:56.967

[SchemaBank](http://schemabank.com/)（基于 Web 的 SaaS 供应商）可以将您的 ER 设计转换为 MySQL 和 PG 的 SQL 语句。虽然还不能做图形导出。好消息是你不需要安装任何东西（因为它是基于浏览器的），而且几乎没有任何成本。您也应该能够与其他人分享您的设计。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-07-08T03:57:49.487

Oracle 的 SQLDeveloper 可以使用 Oracle 和 MySQL 数据库。

[http://www.oracle.com/us/corporate/press/020861](http://www.oracle.com/us/corporate/press/020861)

# macos - 如何在 Mac OS X 中访问（收听）多媒体键（播放/暂停）？

> ID：114541
> 
> 赞同：8
> 
> 时间：2008-09-22T12:27:37.917
> 
> 标签：macos, xul, songbird

我想写一个[Songbird](http://getsongbird.com/)扩展绑定所有 Apple Mac OS X 平台上可用的多媒体键。不幸的是，这不是一个简单的谷歌搜索，我找不到任何文档。

谁能指出我访问这些密钥的资源或告诉我该怎么做？

我有丰富的编程经验，但这将是我第一次在 MacOSX 和[XUL](http://wiki.songbirdnest.com/Developer/Developer_Intro/Extensions)（Firefox 等）中编码，所以欢迎任何关于两者的提示。

请注意，这些不是常规的关键事件。我认为它必须是我需要挂钩或订阅的不同类型的系统事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T07:42:37.573

这篇博文有一个解决方案：

[http://www.rogueamoeba.com/utm/posts/Article/mediaKeys-2007-09-29-17-00.html](http://www.rogueamoeba.com/utm/posts/Article/mediaKeys-2007-09-29-17-00.html)

您基本上需要 subclass`NSApplication`和 override `sendEvent`，
寻找特殊的扫描码。我不知道鸣禽是什么，但如果它
不是一个真正的应用程序，那么我怀疑你能做到这一点。

或者也许你可以，一个简单的类别就足够了：

```
@implementation NSApplication(WantMediaKeysCategoryKBye)
- (void)sendEvent: (NSEvent*)event
{
    // intercept media keys here
}
@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T19:01:19.850

您确定您的多媒体密钥在您的安装中正常工作吗？每个键都会生成一个扫描码，该扫描码由内核翻译成一个键码。如果 xev 没有向您显示任何键码，我猜这些扫描码没有被映射，因此内核不知道它们。

[http://gentoo-wiki.com/HOWTO_Use_Multimedia_Keys](http://gentoo-wiki.com/HOWTO_Use_Multimedia_Keys)对查找密钥代码有很好的解释，并提供有关如何找到原始扫描代码并将其转换为密钥代码的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T15:02:29.637

[`xev`](http://www.manpagez.com/man/1/xev/)如果您想了解多媒体键正在发送哪些代码，可能会对您有所帮助。

# html - 如何水平居中元素

> ID：114543
> 
> 赞同：4787
> 
> 时间：2008-09-22T12:27:57.510
> 
> 标签：html, css, alignment, centering

如何使用 CSS`<div>`在另一个中水平居中？`<div>`

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div> 
```

* * *

## 回答 #1

> 赞同：5252
> 
> 时间：2008-09-22T12:29:07.710

您可以将此 CSS 应用于内部`<div>`：

```
#inner {
  width: 50%;
  margin: 0 auto;
} 
```

当然，您不必将 to 设置`width`为`50%`. 任何小于包含的宽度`<div>`都可以。这`margin: 0 auto`就是实际的居中。

如果您的目标是[Internet Explorer 8](https://en.wikipedia.org/wiki/Internet_Explorer_8)（及更高版本），则最好改为：

```
#inner {
  display: table;
  margin: 0 auto;
} 
```

它将使内部元素水平居中，并且无需设置特定的`width`.

这里的工作示例：

```
#inner {
  display: table;
  margin: 0 auto;
  border: 1px solid black;
}

#outer {
  border: 1px solid red;
  width:100%
}
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div>
```

* * *

## 编辑

使用`flexbox`它可以很容易地设置 div 水平和垂直居中的样式。

```
#inner {  
  border: 1px solid black;
}

#outer {
  border: 1px solid red;
  width:100%;
  display: flex;
  justify-content: center;
}
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div>
```

要使 div 垂直居中对齐，请使用属性`align-items: center`.

* * *

## 回答 #2

> 赞同：1351
> 
> 时间：2011-01-20T22:55:26.767

如果您不想在内部设置固定宽度，`div`可以执行以下操作：

```
#outer {
  width: 100%;
  text-align: center;
}

#inner {
  display: inline-block;
}
```

```
<div id="outer">  
    <div id="inner">Foo foo</div>
</div>
```

这使得内部`div`成为一个可以以 . 为中心的内联元素`text-align`。

* * *

## 回答 #3

> 赞同：426
> 
> 时间：2012-08-30T12:05:25.450

最好的方法是使用[CSS 3](http://www.w3schools.com/css/css3_intro.asp)。

### 盒子型号：

```
#outer {
  width: 100%;
  /* Firefox */
  display: -moz-box;
  -moz-box-pack: center;
  -moz-box-align: center;
  /* Safari and Chrome */
  display: -webkit-box;
  -webkit-box-pack: center;
  -webkit-box-align: center;
  /* W3C */
  display: box;
  box-pack: center;
  box-align: center;
}

#inner {
  width: 50%;
}
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div>
```

根据您的可用性，您也可以使用这些`box-orient, box-flex, box-direction`属性。

**弹性**：

```
#outer {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
} 
```

### 阅读有关使子元素居中的更多信息

*   [链接 2](http://www.w3.org/TR/css3-box/)

*   [链接 3](http://www.w3.org/TR/CSS2/box.html)

*   [链接 4](https://developer.mozilla.org/en-US/docs/Web/CSS/box-align)

这**解释了为什么盒子模型是最好的方法**：

*   *[为什么认为 W3C 盒子模型更好？](https://stackoverflow.com/questions/2429819/why-is-the-w3c-box-model-considered-better)*

* * *

## 回答 #4

> 赞同：281
> 
> 时间：2011-12-01T19:52:29.317

```
#centered {
  position: absolute;
  left: 50%;
  margin-left: -100px;
}
```

```
<div id="outer" style="width:200px">
  <div id="centered">Foo foo</div>
</div>
```

确保父元素是[定位](https://developer.mozilla.org/en-US/docs/Web/CSS/position)的，即相对的、固定的、绝对的或粘性的。

如果你不知道你的 div 的宽度，你可以用`transform:translateX(-50%);`负边距代替。

使用[CSS calc()](https://developer.mozilla.org/en-US/docs/Web/CSS/calc)，代码可以变得更加简单：

```
.centered {
  width: 200px;
  position: absolute;
  left: calc(50% - 100px);
} 
```

原理还是一样的；将物品放在中间并补偿宽度。

* * *

## 回答 #5

> 赞同：261
> 
> 时间：2013-09-11T11:32:31.527

我创建了[这个示例](http://codepen.io/tom-maton/pen/oqsEJ)来展示如何**垂直**和**水平地** `align`.

代码基本上是这样的：

```
#outer {
 position: relative;
} 
```

和...

```
#inner {
  margin: auto;
  position: absolute;
  left:0;
  right: 0;
  top: 0;
  bottom: 0;
} 
```

`center`即使您**调整**屏幕大小，它也会保持不变。

* * *

## 回答 #6

> 赞同：245
> 
> 时间：2013-04-22T10:32:07.340

一些张贴者提到了使用`display:box`.

此语法已过时，不应再使用。[另见[这篇文章]](http://css-tricks.com/old-flexbox-and-new-flexbox/)。

**[因此，为了完整起见，这里是使用灵活框布局模块](http://www.w3.org/TR/css3-flexbox/)**以 CSS 3 为中心的最新方法。

因此，如果您有简单的标记，例如：

```
<div class="box">
  <div class="item1">A</div>
  <div class="item2">B</div>
  <div class="item3">C</div>
</div> 
```

...并且您想将您的项目集中在框中，这是您在父元素 (.box) 上需要的内容：

```
.box {
    display: flex;
    flex-wrap: wrap; /* Optional. only if you want the items to wrap */
    justify-content: center; /* For horizontal alignment */
    align-items: center; /* For vertical alignment */
} 
```

```
.box {
  display: flex;
  flex-wrap: wrap;
  /* Optional. only if you want the items to wrap */
  justify-content: center;
  /* For horizontal alignment */
  align-items: center;
  /* For vertical alignment */
}
* {
  margin: 0;
  padding: 0;
}
html,
body {
  height: 100%;
}
.box {
  height: 200px;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  align-items: center;
  border: 2px solid tomato;
}
.box div {
  margin: 0 10px;
  width: 100px;
}
.item1 {
  height: 50px;
  background: pink;
}
.item2 {
  background: brown;
  height: 100px;
}
.item3 {
  height: 150px;
  background: orange;
}
```

```
<div class="box">
  <div class="item1">A</div>
  <div class="item2">B</div>
  <div class="item3">C</div>
</div>
```

如果您需要支持使用旧语法的旧浏览器，那么[这里是](http://the-echoplex.net/flexyboxes/)一个不错的选择。

* * *

## 回答 #7

> 赞同：161
> 
> 时间：2012-05-12T23:45:31.703

如果您不想设置固定宽度并且不想要额外的边距，请添加`display: inline-block`到您的元素中。

您可以使用：

```
#element {
    display: table;
    margin: 0 auto;
} 
```

* * *

## 回答 #8

> 赞同：136
> 
> 时间：2014-05-17T18:38:48.260

## 将未知高度和宽度的 div 居中

水平和垂直。它适用于相当现代的浏览器（Firefox、Safari/WebKit、Chrome、Internet & Explorer & 10、Opera 等）

```
.content {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}
```

```
<div class="content">This works with any content</div>
```

[在Codepen](http://codepen.io/storypixel/pen/Dbdiq)或[JSBin](http://jsbin.com/zureq/1)上进一步修改它。

* * *

## 回答 #9

> 赞同：113
> 
> 时间：2009-07-24T22:00:04.437

设置和`width`设置`margin-left`和`margin-right`。`auto`不过，这**仅适用于水平**。如果你想要两种方式，你就两种方式都做。不要害怕尝试；这不像你会破坏任何东西。

* * *

## 回答 #10

> 赞同：108
> 
> 时间：2008-09-22T12:30:08.253

如果你不给它一个宽度，它就不能居中。否则，默认情况下，它将占用整个水平空间。

* * *

## 回答 #11

> 赞同：102
> 
> 时间：2012-03-11T13:37:51.707

[CSS 3 的 box-align 属性](http://www.w3schools.com/cssref/css3_pr_box-align.asp)

```
#outer {
    width: 100%;
    height: 100%;
    display: box;
    box-orient: horizontal;
    box-pack: center;
    box-align: center;
} 
```

* * *

## 回答 #12

> 赞同：78
> 
> 时间：2011-06-23T21:42:53.133

我最近不得不将一个“隐藏”的 div（即`display:none;`）居中，其中有一个表格形式，需要在页面上居中。我编写了以下 jQuery 代码来显示隐藏的 div，然后将 CSS 内容更新为自动生成的表格宽度并将边距更改为居中。（显示切换是通过单击链接触发的，但此代码不是显示所必需的。）

**注意：**我正在分享这段代码，因为谷歌把我带到了这个 Stack Overflow 解决方案，除了隐藏元素没有任何宽度并且在它们显示之前不能调整大小/居中之外，一切都会正常工作。

```
$(function(){
  $('#inner').show().width($('#innerTable').width()).css('margin','0 auto');
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div id="inner" style="display:none;">
  <form action="">
    <table id="innerTable">
      <tr><td>Name:</td><td><input type="text"></td></tr>
      <tr><td>Email:</td><td><input type="text"></td></tr>
      <tr><td>Email:</td><td><input type="submit"></td></tr>
    </table>
  </form>
</div>
```

* * *

## 回答 #13

> 赞同：78
> 
> 时间：2013-04-07T08:22:07.357

我通常这样做的方式是使用绝对位置：

```
#inner{
  left: 0;
  right: 0;
  margin-left: auto;
  margin-right: auto;
  position: absolute;
} 
```

外部 div 不需要任何额外的属性来工作。

* * *

## 回答 #14

> 赞同：69
> 
> 时间：2012-05-31T15:32:44.763

对于 Firefox 和 Chrome：

```
<div style="width:100%;">
  <div style="width: 50%; margin: 0px auto;">Text</div>
</div>
```

对于 Internet Explorer、Firefox 和 Chrome：

```
<div style="width:100%; text-align:center;">
  <div style="width: 50%; margin: 0px auto; text-align:left;">Text</div>
</div>
```

该`text-align:`属性对于现代浏览器是可选的，但在 Internet Explorer Quirks Mode 中对于旧版浏览器支持是必需的。

* * *

## 回答 #15

> 赞同：65
> 
> 时间：2013-07-19T10:21:28.800

采用：

```
#outerDiv {
  width: 500px;
}

#innerDiv {
  width: 200px;
  margin: 0 auto;
}
```

```
<div id="outerDiv">
  <div id="innerDiv">Inner Content</div>
</div>
```

* * *

## 回答 #16

> 赞同：61
> 
> 时间：2015-03-12T14:01:38.540

无需为其中一个元素设置宽度的另一种解决方案是使用 CSS 3`transform`属性。

```
#outer {
  position: relative;
}

#inner {
  position: absolute;
  left: 50%;

  transform: translateX(-50%);
} 
```

诀窍是`translateX(-50%)`将`#inner`元素设置在其自身宽度左侧的 50% 处。您可以使用相同的技巧进行垂直对齐。

这是一个显示水平和垂直对齐的[**小提琴。**](http://jsfiddle.net/bfedqjz4/ "小提琴")

更多信息请[参见 Mozilla 开发者网络](https://developer.mozilla.org/en-US/docs/Web/CSS/transform "MDN")。

* * *

## 回答 #17

> 赞同：56
> 
> 时间：2013-10-25T11:53:59.677

Chris Coyier在他的博客上写了一篇关于“以未知为中心”的[优秀文章。](http://css-tricks.com/centering-in-the-unknown/)这是多种解决方案的综合。我发布了一个未在此问题中发布的内容。它比[Flexbox](https://en.wikipedia.org/wiki/CSS_Flexible_Box_Layout)解决方案有更多的浏览器支持，而且你没有使用`display: table;`它可能会破坏其他东西。

```
/* This parent can be any width and height */
.outer {
  text-align: center;
}

/* The ghost, nudged to maintain perfect centering */
.outer:before {
  content: '.';
  display: inline-block;
  height: 100%;
  vertical-align: middle;
  width: 0;
  overflow: hidden;
}

/* The element to be centered, can
   also be of any width and height */
.inner {
  display: inline-block;
  vertical-align: middle;
  width: 300px;
} 
```

* * *

## 回答 #18

> 赞同：52
> 
> 时间：2013-05-27T16:12:43.473

我最近找到了一种方法：

```
#outer {
    position: absolute;
    left: 50%;
}

#inner {
    position: relative;
    left: -50%;
} 
```

两个元素必须具有相同的宽度才能正常工作。

* * *

## 回答 #19

> 赞同：45
> 
> 时间：2013-12-04T07:30:31.860

例如，请参阅[此链接](http://jsfiddle.net/uCdPK/)和下面的代码段：

```
div#outer {
  height: 120px;
  background-color: red;
}

div#inner {
  width: 50%;
  height: 100%;
  background-color: green;
  margin: 0 auto;
  text-align: center; /* For text alignment to center horizontally. */
  line-height: 120px; /* For text alignment to center vertically. */
}
```

```
<div id="outer" style="width:100%;">
  <div id="inner">Foo foo</div>
</div>
```

如果您在父母下有很多孩子，那么您的 CSS 内容必须像[fiddle 上的这个示例](http://jsfiddle.net/uCdPK/2/)。

HTML 内容如下所示：

```
<div id="outer" style="width:100%;">
    <div class="inner"> Foo Text </div>
    <div class="inner"> Foo Text </div>
    <div class="inner"> Foo Text </div>
    <div class="inner"> </div>
    <div class="inner"> </div>
    <div class="inner"> </div>
    <div class="inner"> </div>
    <div class="inner"> </div>
    <div class="inner"> Foo Text </div>
</div> 
```

[然后在 fiddle 上](http://jsfiddle.net/uCdPK/2/)查看这个示例。

* * *

## 回答 #20

> 赞同：40
> 
> 时间：2016-02-19T16:57:54.530

# 仅水平居中

以我的经验，将盒子水平居中的最佳方法是应用以下属性：

## 容器：

*   应该有`text-align: center;`

## 内容框：

*   应该有`display: inline-block;`

## 演示：

```
.container {
  width: 100%;
  height: 120px;
  background: #CCC;
  text-align: center;
}

.centered-content {
  display: inline-block;
  background: #FFF;
  padding: 20px;
  border: 1px solid #000;
}
```

```
<div class="container">
  <div class="centered-content">
    Center this!
  </div>
</div>
```

另见[**这个小提琴**](https://jsfiddle.net/zmw77awd/1/)！

* * *

# 水平和垂直居中

根据我的经验，将盒子垂直和水平居中的最佳方法**是**使用额外的容器并应用以下属性：

## 外容器：

*   应该有`display: table;`

## 内部容器：

*   应该有`display: table-cell;`
*   应该有`vertical-align: middle;`
*   应该有`text-align: center;`

## 内容框：

*   应该有`display: inline-block;`

## 演示：

```
.outer-container {
  display: table;
  width: 100%;
  height: 120px;
  background: #CCC;
}

.inner-container {
  display: table-cell;
  vertical-align: middle;
  text-align: center;
}

.centered-content {
  display: inline-block;
  background: #FFF;
  padding: 20px;
  border: 1px solid #000;
}
```

```
<div class="outer-container">
  <div class="inner-container">
    <div class="centered-content">
      Center this!
    </div>
  </div>
</div>
```

另见[**这个小提琴**](https://jsfiddle.net/zmw77awd/2/)！

* * *

## 回答 #21

> 赞同：38
> 
> 时间：2017-06-09T08:34:30.470

# 弹性盒

[**`display: flex`**](https://developer.mozilla.org/en-US/docs/Web/CSS/display?v=control)其行为类似于块元素，并根据 flexbox 模型布置其内容。它适用于[**`justify-content: center`**](https://developer.mozilla.org/en-US/docs/Web/CSS/justify-content?v=control).

**请注意：** Flexbox 兼容除 Internet Explorer 之外的所有浏览器。有关浏览器兼容性的完整和最新列表，请参阅[display: flex not working on Internet Explorer 。](https://stackoverflow.com/questions/43979702/display-flex-not-working-on-internet-explorer/43979973#43979973)

```
#inner {
  display: inline-block;
}

#outer {
  display: flex;
  justify-content: center;
}
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div>
```

* * *

# 文本对齐：居中

应用[**`text-align: center`**](https://developer.mozilla.org/en-US/docs/Web/CSS/text-align?v=control)内联内容在行框中居中。但是，由于默认情况下内部 div 具有`width: 100%`您必须设置特定宽度或使用以下之一：

*   [**`display: block`**](https://developer.mozilla.org/en-US/docs/Web/CSS/display?v=control)
*   [**`display: inline`**](https://developer.mozilla.org/en-US/docs/Web/CSS/display?v=control)
*   [**`display: inline-block`**](https://developer.mozilla.org/en-US/docs/Web/CSS/display?v=control)

```
#inner {
  display: inline-block;
}

#outer {
  text-align: center;
}
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div>
```

* * *

# 保证金：0自动

使用[**`margin: 0 auto`**](https://developer.mozilla.org/en/docs/Web/CSS/margin?v=example)是另一种选择，它更适合旧浏览器的兼容性。它与[**`display: table`**](https://developer.mozilla.org/en-US/docs/Web/CSS/display?v=control).

```
#inner {
  display: table;
  margin: 0 auto;
}
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div>
```

* * *

# 转换

[**`transform: translate`**](https://developer.mozilla.org/en-US/docs/Web/CSS/transform?v=control)允许您修改 CSS 视觉格式化模型的坐标空间。使用它，可以平移、旋转、缩放和倾斜元素。要水平居中，它需要[**`position: absolute`**](https://developer.mozilla.org/en/docs/Web/CSS/position?v=example)和[**`left: 50%`**](https://developer.mozilla.org/en/docs/Web/CSS/left)。

```
#inner {
  position: absolute;
  left: 50%;
  transform: translate(-50%, 0%);
}
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div>
```

* * *

# `<center>`（已弃用）

标签[**`<center>`**](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/center)是[**`text-align: center`**](https://developer.mozilla.org/en-US/docs/Web/CSS/text-align?v=control). 它适用于旧浏览器和大多数新浏览器，但由于此功能已[过时](https://www.w3.org/TR/html5/obsolete.html)并且已从 Web 标准中删除，因此不被认为是一种好的做法。

```
#inner {
  display: inline-block;
}
```

```
<div id="outer">
  <center>
    <div id="inner">Foo foo</div>
  </center>
</div>
```

* * *

## 回答 #22

> 赞同：36
> 
> 时间：2016-09-23T06:49:46.857

此方法也可以正常工作：

```
div.container {
  display: flex;
  justify-content: center; /* For horizontal alignment */
  align-items: center;     /* For vertical alignment   */
} 
```

对于 inner `<div>`，唯一的条件是它的`height`and`width`不能大于它的容器。

* * *

## 回答 #23

> 赞同：35
> 
> 时间：2014-08-22T12:10:48.360

最简单的方法：

```
#outer {
  width: 100%;
  text-align: center;
}
#inner {
  margin: auto;
  width: 200px;
}
```

```
<div id="outer">
  <div id="inner">Blabla</div>
</div>
```

* * *

## 回答 #24

> 赞同：33
> 
> 时间：2014-01-17T18:18:26.417

**如果内容的宽度未知，您可以使用以下方法**。假设我们有这两个元素：

*   `.outer`- 全屏宽度
*   `.inner`-- 没有设置宽度（但可以指定最大宽度）

假设计算出的元素宽度分别为 1000 像素和 300 像素。进行如下操作：

1.  包裹`.inner`在里面`.center-helper`
2.  制作`.center-helper`一个内联块；它的大小与`.inner`使其宽 300 像素相同。
3.  `.center-helper`相对于其父级向右推50%；这将其左侧放置在 500 像素处。外。
4.  `.inner`相对于其父级向左推50%；这将其左侧放置在 -150 像素处。中心助手，这意味着它的左边是 500 - 150 = 350 像素 wrt。外。
5.  将溢出设置`.outer`为隐藏以防止水平滚动条。

演示：

```
body {
  font: medium sans-serif;
}

.outer {
  overflow: hidden;
  background-color: papayawhip;
}

.center-helper {
  display: inline-block;
  position: relative;
  left: 50%;
  background-color: burlywood;
}

.inner {
  display: inline-block;
  position: relative;
  left: -50%;
  background-color: wheat;
}
```

```
<div class="outer">
  <div class="center-helper">
    <div class="inner">
      <h1>A div with no defined width</h1>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.<br>
          Duis condimentum sem non turpis consectetur blandit.<br>
          Donec dictum risus id orci ornare tempor.<br>
          Proin pharetra augue a lorem elementum molestie.<br>
          Nunc nec justo sit amet nisi tempor viverra sit amet a ipsum.</p>
    </div>
  </div>
</div>
```

* * *

## 回答 #25

> 赞同：32
> 
> 时间：2017-04-03T20:12:59.610

Flex 拥有超过 97% 的浏览器支持覆盖率，并且可能是在几行内解决此类问题的最佳方法：

```
#outer {
  display: flex;
  justify-content: center;
} 
```

* * *

## 回答 #26

> 赞同：30
> 
> 时间：2013-10-14T12:09:57.280

你可以做这样的事情

```
#container {
   display: table;
   width: <width of your container>;
   height: <height of your container>;
}

#inner {
   width: <width of your center div>;
   display: table-cell;
   margin: 0 auto;
   text-align: center;
   vertical-align: middle;
} 
```

这也将`#inner`垂直对齐。如果您不想这样做，请删除`display`and`vertical-align`属性；

* * *

## 回答 #27

> 赞同：28
> 
> 时间：2014-01-28T09:55:54.967

这是你想要的最短的方式。

**[JSFIDDLE](http://jsfiddle.net/8qYcn/)**

```
#outer {
  margin - top: 100 px;
  height: 500 px; /* you can set whatever you want */
  border: 1 px solid# ccc;
}

#inner {
  border: 1 px solid# f00;
  position: relative;
  top: 50 % ;
  transform: translateY(-50 % );
} 
```

* * *

## 回答 #28

> 赞同：26
> 
> 时间：2018-06-10T15:53:54.750

您可以使用`display: flex`您的外部 div 并水平居中您必须添加`justify-content: center`

```
#outer{
    display: flex;
    justify-content: center;
} 
```

或者您可以访问[w3schools - CSS flex 属性](https://www.w3schools.com/cssref/css3_pr_flex.asp)以获得更多想法。

* * *

## 回答 #29

> 赞同：24
> 
> 时间：2014-02-11T15:51:03.233

好吧，我设法找到了一个可能适合所有情况的解决方案，但使用 JavaScript：

这是结构：

```
<div class="container">
  <div class="content">Your content goes here!</div>
  <div class="content">Your content goes here!</div>
  <div class="content">Your content goes here!</div>
</div> 
```

这是 JavaScript 片段：

```
$(document).ready(function() {
  $('.container .content').each( function() {
    container = $(this).closest('.container');
    content = $(this);

    containerHeight = container.height();
    contentHeight = content.height();

    margin = (containerHeight - contentHeight) / 2;
    content.css('margin-top', margin);
  })
}); 
```

如果您想在响应式方法中使用它，可以添加以下内容：

```
$(window).resize(function() {
  $('.container .content').each( function() {
    container = $(this).closest('.container');
    content = $(this);

    containerHeight = container.height();
    contentHeight = content.height();

    margin = (containerHeight - contentHeight) / 2;
    content.css('margin-top', margin);
  })
}); 
```

* * *

## 回答 #30

> 赞同：22
> 
> 时间：2013-11-16T19:56:08.663

我发现存在一个选项：

每个人都说使用：

```
margin: auto 0; 
```

但还有另一种选择。为父 div 设置此属性。它随时都可以完美运行：

```
text-align: center; 
```

看，孩子去中心。

最后为您提供 CSS：

```
#outer{
     text-align: center;
     display: block; /* Or inline-block - base on your need */
}

#inner
{
     position: relative;
     margin: 0 auto; /* It is good to be */
} 
```

* * *

## 回答 #31

> 赞同：19
> 
> 时间：2014-09-20T07:22:04.833

如果有人想要一个用于中心对齐这些 div 的 jQuery 解决方案：

```
$(window).bind("load", function() {
    var wwidth = $("#outer").width();
    var width = $('#inner').width();
    $('#inner').attr("style", "padding-left: " + wwidth / 2 + "px; margin-left: -" + width / 2 + "px;");
}); 
```

* * *

## 回答 #32

> 赞同：19
> 
> 时间：2019-04-04T11:59:58.177

你可以像这样简单地使用[Flexbox](https://en.wikipedia.org/wiki/CSS_Flexible_Box_Layout)：

```
#outer {
    display: flex;
    justify-content: center
}
```

```
<div id="outer">
    <div id="inner">Foo foo</div>
</div>
```

为所有浏览器支持应用 Autoprefixer：

```
#outer {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    width: 100%;
    -webkit-box-pack: center;
    -ms-flex-pack: center;
    justify-content: center
} 
```

# 要不然

使用**变换**：

```
#inner {
    position: absolute;
    left: 50%;
    transform: translate(-50%)
}
```

```
<div id="outer">
    <div id="inner">Foo foo</div>
</div>
```

使用自动前缀：

```
#inner {
    position: absolute;
    left: 50%;
    -webkit-transform: translate(-50%);
    -ms-transform:     translate(-50%);
    transform:         translate(-50%)
} 
```

* * *

## 回答 #33

> 赞同：18
> 
> 时间：2013-11-05T15:21:21.100

尝试玩弄

```
margin: 0 auto; 
```

如果您也想将文本居中，请尝试使用：

```
text-align: center; 
```

* * *

## 回答 #34

> 赞同：18
> 
> 时间：2019-07-12T18:09:27.927

我们可以使用**[Flexbox](https://en.wikipedia.org/wiki/CSS_Flexible_Box_Layout)**轻松实现这一点：

```
<div id="outer">
    <div id="inner">Foo foo</div>
</div> 
```

*将 div水平*居中在 div 内：

```
#outer {
   display: flex;
   justify-content: center;
} 
```

[![在此处输入图像描述](https://i.stack.imgur.com/sT5Rb.png)](https://i.stack.imgur.com/sT5Rb.png)

*将 div垂直*居中在 div 内：

```
#outer {
    display: flex;
    align-items: center;
} 
```

[![在此处输入图像描述](https://i.stack.imgur.com/a7vse.png)](https://i.stack.imgur.com/a7vse.png)

并且，要在垂直和水平方向上完全居中 div：

```
#outer{
    display: flex;
    justify-content: center;
    align-items: center;
} 
```

[![在此处输入图像描述](https://i.stack.imgur.com/0J9dv.png)](https://i.stack.imgur.com/0J9dv.png)

* * *

## 回答 #35

> 赞同：17
> 
> 时间：2020-01-06T06:44:18.760

只需将此 CSS 内容添加到您的 CSS 文件中。它会自动将内容居中。

在 CSS 中水平居中对齐：

```
#outer {
    display: flex;
    justify-content: center;
} 
```

在 CSS 中垂直对齐 + 水平居中：

```
#outer {
    display: flex;
    justify-content: center;
    align-items: center;
} 
```

* * *

## 回答 #36

> 赞同：14
> 
> 时间：2019-02-12T02:47:31.730

水平居中的一个非常简单且跨浏览器的答案是将此规则应用于父元素：

```
.parentBox {
    display: flex;
    justify-content: center
} 
```

* * *

## 回答 #37

> 赞同：11
> 
> 时间：2013-06-06T05:30:29.967

我已将内联样式应用于内部 div。使用这个：

```
<div id="outer" style="width:100%">  
    <div id="inner" style="display:table;margin:0 auto;">Foo foo</div>
</div> 
```

* * *

## 回答 #38

> 赞同：10
> 
> 时间：2020-07-27T21:10:48.597

**带网格**

一个非常简单和现代的方法是使用`display: grid`：

```
div {
    border: 1px dotted grey;
}

#outer {
    display: grid;
    place-items: center;
    height: 50px; /* not necessary */
}
```

```
<!DOCTYPE html>
<html>
    <head>
    </head>

    <body>
        <div id="outer">
            <div>Foo foo</div>
        </div>
    </body>
</html>
```

* * *

## 回答 #39

> 赞同：9
> 
> 时间：2013-10-31T19:56:49.160

我最近发现的一件好事，混合使用`line-height`+`vertical-align`和`50%`左技巧，您可以`center`使用纯 CSS 在水平和垂直方向上将一个动态大小的框放入另一个动态大小的框内。

请注意，您必须使用跨度（和`inline-block`），在现代浏览器 + Internet Explorer 8 中进行了测试。 **HTML：**

```
<h1>Center dynamic box using only css test</h1>
<div class="container">
  <div class="center">
    <div class="center-container">
      <span class="dyn-box">
        <div class="dyn-head">This is a head</div>
        <div class="dyn-body">
          This is a body<br />
          Content<br />
          Content<br />
          Content<br />
          Content<br />
        </div>
      </span>
    </div>
  </div>
</div> 
```

**CSS：**

```
.container {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  overflow: hidden;
}

.center {
  position: absolute;
  left: 50%;
  top: 50%;
}

.center-container {
  position: absolute;
  left: -2500px;
  top: -2500px;
  width: 5000px;
  height: 5000px;
  line-height: 5000px;
  text-align: center;
  overflow: hidden;
}

.dyn-box {
  display: inline-block;
  vertical-align: middle;
  line-height: 100%;
  /* Purely asthetic below this point */
  background: #808080;
  padding: 13px;
  border-radius: 11px;
  font-family: arial;
}

.dyn-head {
  background: red;
  color: white;
  min-width: 300px;
  padding: 20px;
  font-size: 23px;
}

.dyn-body {
  padding: 10px;
  background: white;
  color: red;
} 
```

[请参见此处的示例](http://jsfiddle.net/7mQS5/16/)。

* * *

## 回答 #40

> 赞同：9
> 
> 时间：2017-03-11T14:14:33.377

**CSS 3：**

您可以在父容器上使用以下样式将子元素水平均匀分布：

```
display: flex;
justify-content: space-between;  // <-- space-between or space-around 
```

关于. [_](https://www.w3schools.com/cssref/playit.asp?filename=playcss_justify-content&preval=space-between) _`justify-content`

[![在此处输入图像描述](https://i.stack.imgur.com/H3tJq.png)](https://i.stack.imgur.com/H3tJq.png)

CanIUse：[浏览器兼容性](http://caniuse.com/#search=justify-content)

**尝试一下！：**

```
#containerdiv {
  display: flex;
  justify-content: space-between;
}

#containerdiv > div {
  background-color: blue;
  width: 50px;
  color: white;
  text-align: center;
}
```

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>JS Bin</title>
</head>
<body>
  <div id="containerdiv">
    <div>88</div>
    <div>77</div>
    <div>55</div>
    <div>33</div>
    <div>40</div>
    <div>45</div>
  </div>
</body>
</html>
```

* * *

## 回答 #41

> 赞同：8
> 
> 时间：2013-10-01T18:14:09.197

`#inner`对div使用以下 CSS 内容：

```
#inner {
  width: 50%;
  margin-left: 25%;
} 
```

我主要使用这个 CSS 内容来居中*div*。

* * *

## 回答 #42

> 赞同：8
> 
> 时间：2015-05-15T10:26:00.363

```
#inner {
    width: 50%;
    margin: 0 auto;
} 
```

* * *

## 回答 #43

> 赞同：8
> 
> 时间：2016-11-01T13:41:38.627

您可以使用**CSS Flexbox**来实现这一点。您只需将 3 个属性应用于父元素即可让一切正常工作。

```
#outer {
  display: flex;
  align-content: center;
  justify-content: center;
} 
```

看看下面的代码，这将使您更好地理解这些属性。

进一步了解**[CSS Flexbox](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)**

```
#outer {
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid #ddd;
  width: 100%;
  height: 200px;
 }
```

```
<div id="outer">  
  <div id="inner">Foo foo</div>
</div>
```

* * *

## 回答 #44

> 赞同：8
> 
> 时间：2017-01-13T12:13:54.890

可以使用**CSS 3 Flexbox**。使用 Flexbox 时有两种方法。

1.  设置父元素`display:flex;`并将属性添加`{justify-content:center; ,align-items:center;}`到父元素。

```
#outer {
  display: flex;
  justify-content: center;
  align-items: center;
}
```

```
<div id="outer" style="width:100%">
  <div id="inner">Foo foo</div>
</div>
```

2.  设置父级`display:flex`并添加`margin:auto;`到子级。

```
#outer {
  display: flex;
}

#inner {
  margin: auto;
}
```

```
<div id="outer" style="width:100%">
  <div id="inner">Foo foo</div>
</div>
```

* * *

## 回答 #45

> 赞同：7
> 
> 时间：2022-01-03T18:14:35.370

> 如何使用 CSS`<div>`在另一个中水平居中？`<div>`

以下是居中方法的非详尽列表，使用：

*   `margin`和`auto`
*   `margin`和`calc()`
*   `padding`并且`box-sizing`和`calc()`
*   `position: absolute`和*消极的* `margin-left`
*   `position: absolute`和*消极的* `transform: translateX()`
*   `display: inline-block`和`text-align: center`
*   `display: table`和`display: table-cell`
*   `display: flex`和`justify-content: center`
*   `display: grid`和`justify-items: center`

## `auto`1\. 使用水平边距使块级元素居中

```
.outer {
  width: 300px;
  height: 180px;
  background-color: rgb(255, 0, 0);
}

.inner {
  width: 150px;
  height: 180px;
  margin: 0 auto;
  background-color: rgb(255, 255, 0);
}
```

```
<div class="outer">
  <div class="inner"></div>
</div>
```

## `calc`2\. 使用水平边距使块级元素居中

```
.outer {
  width: 300px;
  height: 180px;
  background-color: rgb(255, 0, 0);
}

.inner {
  width: 150px;
  height: 180px;
  margin: 0 calc((300px - 150px) / 2);
  background-color: rgb(255, 255, 0);
}
```

```
<div class="outer">
  <div class="inner"></div>
</div>
```

## `calc`3\. 使用水平填充使块级元素居中+`box-sizing`

```
.outer {
  width: 300px;
  height: 180px;
  padding: 0 calc((300px - 150px) / 2);
  background-color: rgb(255, 0, 0);
  box-sizing: border-box;
}

.inner {
  width: 150px;
  height: 180px;
  background-color: rgb(255, 255, 0);
}
```

```
<div class="outer">
  <div class="inner"></div>
</div>
```

## `position: absolute`4\. 使用with`left: 50%`和*negative*将块级元素居中 *`margin-left`*

 *```
.outer {
  position: relative;
  width: 300px;
  height: 180px;
  background-color: rgb(255, 0, 0);
}

.inner {
  position: absolute;
  left: 50%;
  width: 150px;
  height: 180px;
  margin-left: -75px;
  background-color: rgb(255, 255, 0);
}
```

```
<div class="outer">
  <div class="inner"></div>
</div>
```

## `position: absolute`5\. 使用with`left: 50%`和*negative*将块级元素居中 *`transform: translateX()`*

 *```
.outer {
  position: relative;
  width: 300px;
  height: 180px;
  background-color: rgb(255, 0, 0);
}

.inner {
  position: absolute;
  left: 50%;
  width: 150px;
  height: 180px;
  background-color: rgb(255, 255, 0);
  transform: translateX(-75px);
}
```

```
<div class="outer">
  <div class="inner"></div>
</div>
```

## 6\. 使用`display: inline-block`and将元素居中`text-align: center`

```
.outer {
  position: relative;
  width: 300px;
  height: 180px;
  text-align: center;
  background-color: rgb(255, 0, 0);
}

.inner {
  display: inline-block;
  width: 150px;
  height: 180px;
  background-color: rgb(255, 255, 0);
}
```

```
<div class="outer">
  <div class="inner"></div>
</div>
```

## 7\. 使用`display: table`,`padding`和`box-sizing`

```
.outer {
  display: table;
  width: 300px;
  height: 180px;
  padding: 0 75px;
  background-color: rgb(255, 0, 0);
  box-sizing: border-box;
}

.inner {
  display: table-cell;
  background-color: rgb(255, 255, 0);
}
```

```
<div class="outer">
  <div class="inner"></div>
</div>
```

## 8\. 使用`display: flex`and将元素居中`justify-content: center`

```
.outer {
  display: flex;
  justify-content: center;
  width: 300px;
  height: 180px;
  background-color: rgb(255, 0, 0);
}

.inner {
  flex: 0 0 150px;
  background-color: rgb(255, 255, 0);
}
```

```
<div class="outer">
  <div class="inner"></div>
</div>
```

## 9\. 使用`display: grid`and将元素居中`justify-items: center`

```
.outer {
  display: grid;
  justify-items: center;
  width: 300px;
  height: 180px;
  background-color: rgb(255, 0, 0);
}

.inner {
  width: 150px;
  background-color: rgb(255, 255, 0);
}
```

```
<div class="outer">
  <div class="inner"></div>
</div>
```

* * *

## 回答 #46

> 赞同：6
> 
> 时间：2019-03-26T15:27:12.380

让它变得简单！

```
#outer {
  display: flex;
  justify-content: center;
}
```

```
<div id="outer">  
  <div id="inner">Foo foo</div>
</div>
```

* * *

## 回答 #47

> 赞同：6
> 
> 时间：2019-11-23T10:54:34.220

**这是水平居中 <div> 的最佳示例**

```
#outer {
    display: flex;
    align-items: center;
    justify-content: center;
}
```

```
<!DOCTYPE html>
<html>
    <head>

    </head>

    <body>
        <div id="outer">
            <div id="inner">Foo foo</div>
        </div>
    </body>
</html>
```

* * *

## 回答 #48

> 赞同：5
> 
> 时间：2019-07-30T12:44:48.990

**最简单的方法之一...**

```
<!DOCTYPE html>
<html>
    <head>
        <style>
            #outer-div {
                width: 100%;
                text-align: center;
                background-color: #000
            }
            #inner-div {
                display: inline-block;
                margin: 0 auto;
                padding: 3px;
                background-color: #888
            }
        </style>
    </head>

    <body>
       <div id ="outer-div" width="100%">
           <div id ="inner-div"> I am a easy horizontally centered div.</div>
       <div>
    </body>
</html> 
```

* * *

## 回答 #49

> 赞同：5
> 
> 时间：2021-03-02T07:59:32.180

**使元素居中而不需要具有动态高度和宽度的包装器/父级**

**无副作用：**在居中元素内使用 Flexbox 中的边距时，它不会限制居中元素的宽度小于视口宽度

```
position: fixed;
top: 0; left: 0;
transform: translate(calc(50vw - 50%)); 
```

水平+垂直居中，如果其高度与宽度相同：

```
position: fixed;
top: 0; left: 0;
transform: translate(calc(50vw - 50%), calc(50vh - 50%)); 
```

* * *

## 回答 #50

> 赞同：4
> 
> 时间：2014-09-19T21:26:23.647

我只是使用最简单的解决方案，但它适用于所有浏览器：

```
<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>center a div within a div?</title>
        <style type="text/css">
            *{
                margin: 0;
                padding: 0;
            }

            #outer{
                width: 80%;
                height: 500px;
                background-color: #003;
                margin: 0 auto;
            }

            #outer p{
                color: #FFF;
                text-align: center;
            }

            #inner{
                background-color: #901;
                width: 50%;
                height: 100px;
                margin: 0 auto;

            }

            #inner p{
                color: #FFF;
                text-align: center;
            }
        </style>
    </head>

    <body>
        <div id="outer"><p>this is the outer div</p>
            <div id="inner">
                <p>this is the inner div</p>
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #51

> 赞同：4
> 
> 时间：2016-12-20T08:22:40.503

您可以使用[CSS Flexbox](https://en.wikipedia.org/wiki/CSS_Flexible_Box_Layout)。

```
#inner {
    display: flex;
    justify-content: center;
} 
```

您可以在此链接上了解更多信息：[https ://css-tricks.com/snippets/css/a-guide-to-flexbox/](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)

* * *

## 回答 #52

> 赞同：4
> 
> 时间：2017-02-11T08:11:15.223

最简单的答案：添加**边距：自动；**向内。

```
<div class="outer">
  <div class="inner">
    Foo foo
  </div>
</div> 
```

### CSS 代码

```
.outer{
    width: 100%;
    height: 300px;
    background: yellow;
}

.inner{
    width: 30%;
    height: 200px;
    margin: auto;
    background: red;
    text-align: center
} 
```

检查我的[CodePen](https://en.wikipedia.org/wiki/CodePen)链接：[http ://codepen.io/feizel/pen/QdJJrK](http://codepen.io/feizel/pen/QdJJrK)

[![在此处输入图像描述](https://i.stack.imgur.com/IeKcF.png)](https://i.stack.imgur.com/IeKcF.png)

* * *

## 回答 #53

> 赞同：4
> 
> 时间：2017-05-10T02:56:52.143

它也可以使用绝对定位水平和垂直居中，如下所示：

```
#outer{
    position: relative;
}

#inner{
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%)
} 
```

* * *

## 回答 #54

> 赞同：4
> 
> 时间：2017-05-20T10:30:09.157

在包括旧浏览器在内的**许多浏览器**中广泛使用并工作的最著名的方法是使用`margin`如下：

```
#parent {
  width: 100%;
  background-color: #CCCCCC;
}

#child {
  width: 30%; /* We need the width */
  margin: 0 auto; /* This does the magic */
  color: #FFFFFF;
  background-color: #000000;
  padding: 10px;
  text-align: center;
}
```

```
<div id="parent">
  <div id="child">I'm the child and I'm horizontally centered! My daddy is a greyish div dude!</div>
</div>
```

运行代码，看看它是如何工作的。此外，当您尝试以这种方式居中时，您不应该在 CSS 中忘记两件重要的事情：`margin: 0 auto;`. 这使它成为所需的 div 中心。另外不要忘记`width`孩子，否则它不会像预期的那样居中！

* * *

## 回答 #55

> 赞同：4
> 
> 时间：2017-09-23T16:58:15.977

### 在 div 中居中 div

```
.outer {
  display: -webkit-flex;
  display: flex;

  //-webkit-justify-content: center;							
  //justify-content: center;

  //align-items: center;

  width: 100%;
  height: 100px;
  background-color: lightgrey;
}

.inner {
  background-color: cornflowerblue;
  padding: 2rem;
  margin: auto;  

  //align-self: center;						
}
```

```
<div class="outer">  
  <div class="inner">Foo foo</div>
</div>
```

* * *

## 回答 #56

> 赞同：4
> 
> 时间：2017-09-27T13:55:23.677

采用：

```
<div id="parent">
  <div class="child"></div>
</div> 
```

风格：

```
#parent {
   display: flex;
   justify-content: center;
} 
```

如果你想水平居中，你应该写如下：

```
#parent {
   display: flex;
   justify-content: center;
   align-items: center;
} 
```

* * *

## 回答 #57

> 赞同：4
> 
> 时间：2017-10-06T10:50:05.317

您可以使用 calc 方法。用法适用于您要居中的 div。如果您知道它的宽度，假设它是 1200 像素，请选择：

```
.container {
    width:1200px;
    margin-left: calc(50% - 600px);
} 
```

所以基本上它会增加 50% 的左边距减去已知宽度的一半。

* * *

## 回答 #58

> 赞同：4
> 
> 时间：2017-12-19T11:05:06.660

这是另一种使用**[Flexbox](https://en.wikipedia.org/wiki/CSS_Flexible_Box_Layout)**水平居中的方法，无需为内部容器指定任何宽度。这个想法是使用伪元素从左右推动内部内容。

使用`flex:1`on 伪元素将使它们填充剩余的空间并采用相同的大小，并且内部容器将居中。

```
.container {
  display: flex;
  border: 1px solid;
}

.container:before,
.container:after {
  content: "";
  flex: 1;
}

.inner {
  border: 1px solid red;
  padding: 5px;
}
```

```
<div class="container">
  <div class="inner">
    Foo content
  </div>
</div>
```

我们也可以通过简单地将 flex 的方向更改为 column 来考虑垂直对齐的相同情况：

```
.container {
  display: flex;
  flex-direction: column;
  border: 1px solid;
  min-height: 200px;
}

.container:before,
.container:after {
  content: "";
  flex: 1;
}

.inner {
  border: 1px solid red;
  padding: 5px;
}
```

```
<div class="container">
  <div class="inner">
    Foo content
  </div>
</div>
```

* * *

## 回答 #59

> 赞同：4
> 
> 时间：2018-08-07T10:01:52.337

我在各种项目中使用过的最好的是

```
<div class="outer">
    <div class="inner"></div>
</div>
.outer{
  width: 500px;
  height: 500px;
  position: relative;
  background: yellow;
}
.inner{
  width: 100px;
  height: 100px;
  background:red;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
} 
```

[小提琴链接](https://jsfiddle.net/jaisonjjames/phacnvf4/)

* * *

## 回答 #60

> 赞同：4
> 
> 时间：2018-09-07T21:55:36.603

这肯定会`#inner`在水平和垂直方向上居中。这在所有浏览器中也兼容。我只是添加了额外的样式来显示它是如何居中的。

```
#outer {
  background: black;
  position: relative;
  width:150px;
  height:150px;
}

#inner { 
  background:white;
  position: absolute;
  left:50%;
  top: 50%;
  transform: translate(-50%,-50%);
  -webkit-transform: translate(-50%,-50%);
  -moz-transform: translate(-50%,-50%); 
  -o-transform: translate(-50%,-50%);
} 
```

```
<div id="outer">  
  <div id="inner">Foo foo</div>
</div>
```

但是当然，如​​果您只希望它水平对齐，这可能会对您有所帮助。

```
#outer {
  background: black;
  position: relative;
  width:150px;
  height:150px;
}

#inner { 
  background:white;
  position: absolute;
  left:50%;
  transform: translate(-50%,0);
  -webkit-transform: translate(-50%,0);
  -moz-transform: translate(-50%,0); 
  -o-transform: translate(-50%,0);
} 
```

```
<div id="outer">  
  <div id="inner">Foo foo</div>
</div>
```

* * *

## 回答 #61

> 赞同：4
> 
> 时间：2018-09-10T23:06:24.317

你可以使用[Flexbox](https://en.wikipedia.org/wiki/CSS_Flexible_Box_Layout)来做到这一点，这在当今是一种很好的技术。

`display: flex;`为了使用 Flexbox ，你应该给`align-items: center;`你的父元素或`#outer`div 元素。代码应该是这样的：

```
#outer {
  display: flex;
  align-items: center;
}
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div>
```

这应该使您的孩子或`#inner`div 水平居中。但你实际上看不到任何变化。因为我们的`#outer`div 没有高度，或者换句话说，它的高度设置为 auto，所以它的高度与其所有子元素的高度相同。所以经过一点视觉造型后，结果代码应该是这样的：

```
#outer {
  height: 500px;
  display: flex;
  align-items: center;
  background-color: blue;
}

#inner {
  height: 100px;
  background: yellow;
}
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div>
```

您可以看到`#inner`div 现在居中。Flexbox 是使用 CSS 在水平或垂直堆栈中定位元素的新方法，它具有 96% 的全球浏览器兼容性。所以你可以自由使用它，如果你想了解更多关于 Flexbox 的信息，请访问[CSS-Tricks](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)文章。在我看来，这是学习使用 Flexbox 的最佳场所。

* * *

## 回答 #62

> 赞同：4
> 
> 时间：2019-03-07T14:10:28.250

```
.outer
{
  background-color: rgb(230,230,255);
  width: 100%;
  height: 50px;
}
.inner
{
  background-color: rgb(200,200,255);
  width: 50%;
  height: 50px;
  margin: 0 auto;
}
```

```
<div class="outer">
  <div class="inner">
    margin 0 auto
  </div>
</div>
```

* * *

## 回答 #63

> 赞同：4
> 
> 时间：2019-12-10T09:07:51.023

如果您有某个身高的父母，`body{height: 200px}` 或者像下面这样有高度为 200px 的父母 div#outer，那么添加 CSS 内容如下

HTML：

```
<div id="outer">
  <div id="centered">Foo foo</div>
</div> 
```

CSS：

```
#outer{
  display: flex;
  width: 100%;
  height: 200px;
}
#centered {
  margin: auto;
} 
```

然后子内容，比如 div#centered 内容，将垂直或水平居中，而不使用任何位置 CSS。要删除垂直中间行为，只需修改以下 CSS 代码：

```
#centered {
  margin: 0px auto;
} 
```

或者

```
#outer{
  display: flex;
  width: 100%;
  height: 200px;
}
#centered {
  margin: auto;
}

<div id="outer">
  <div id="centered">Foo foo</div>
</div> 
```

演示：[https ://jsfiddle.net/jinny/p3x5jb81/5/](https://jsfiddle.net/jinny/p3x5jb81/5/)

仅添加边框以显示内部 div 默认情况下不是 100%：

```
#outer{
  display: flex;
  width: 100%;
  height: 200px;
  border: 1px solid #000000;
}
#centered {
  margin: auto;
  border: 1px solid #000000;
}
```

```
<div id="outer">
  <div id="centered">Foo foo</div>
</div>
```

演示：http: [//jsfiddle.net/jinny/p3x5jb81/9](http://jsfiddle.net/jinny/p3x5jb81/9)

* * *

## 回答 #64

> 赞同：4
> 
> 时间：2020-02-07T15:12:40.783

使用[Sass](https://sass-lang.com/)（SCSS 语法），您可以使用[mixin](https://sass-lang.com/documentation/at-rules/mixin)执行此操作：

## 带*翻译*

```
// Center horizontal mixin
@mixin center-horizontally {
  position: absolute;
  left: 50%;
  transform: translate(-50%, -50%);
}

// Center horizontal class
.center-horizontally {
    @include center-horizontally;
} 
```

在 HTML 标记中：

```
<div class="center-horizontally">
    I'm centered!
</div> 
```

**记得**添加`position: relative;`到父 HTML 元素。

* * *

## 使用弹性盒

使用*flex*，您可以这样做：

```
@mixin center-horizontally {
  display: flex;
  justify-content: center;
}

// Center horizontal class
.center-horizontally {
    @include center-horizontally;
} 
```

在 HTML 标记中：

```
<div class="center-horizontally">
    <div>I'm centered!</div>
</div> 
```

试试[这个 CodePen](https://codepen.io/alessandroinfo/pen/oNXgXyM)！

* * *

## 回答 #65

> 赞同：4
> 
> 时间：2020-02-19T13:12:16.207

我使用[了 Flexbox](https://en.wikipedia.org/wiki/CSS_Flexible_Box_Layout)或[CSS 网格](https://en.wikipedia.org/wiki/CSS_grid_layout)

1.  弹性盒

    ```
    #outer{
        display: flex;
        justify-content: center;
    }
    ```

2.  CSS 网格

    ```
    #outer {
        display: inline-grid;
        grid-template-rows: 100px 100px 100px;
        grid-template-columns: 100px 100px 100px;
        grid-gap: 3px;
    }
    ```

您可以通过多种方式解决问题。

* * *

## 回答 #66

> 赞同：4
> 
> 时间：2020-06-22T13:35:31.107

要在中间的 div 中对齐 div -

```
.outer{
  width: 300px; /* For example */
  height: 300px; /* For example */
  background: red;
}
.inner{
  position: relative;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 200px;
  height: 200px;
  background: yellow;
}
```

```
<body>
  <div class='outer'>
    <div class='inner'></div>
  </div>
</body>
```

这将在中间垂直和水平对齐内部 div。

* * *

## 回答 #67

> 赞同：4
> 
> 时间：2021-04-12T06:21:17.537

只需这样做：

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div> 
```

CSS

```
#outer{
  display: grid;
  place-items: center;
} 
```

* * *

## 回答 #68

> 赞同：4
> 
> 时间：2021-05-04T18:11:04.033

这可以通过使用很多方法来完成。许多男人/女孩给出的答案是正确的并且工作正常。我再给出一种不同的模式。

在**HTML**文件中

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div> 
```

在**CSS**文件中

```
#outer{
  width: 100%;
}

#inner{
  margin: auto;
} 
```

* * *

## 回答 #69

> 赞同：3
> 
> 时间：2015-09-01T10:13:16.137

试试下面的 CSS 代码：

```
<style>
    #outer {
        display: inline-block;
        width: 100%;
        height: 100%;
        text-align: center;
        vertical-align: middle;
    }

    #outer > #inner {
        display: inline-block;
        font-size: 19px;
        margin: 20px;
        max-width: 320px;
        min-height: 20px;
        min-width: 30px;
        padding: 14px;
        vertical-align: middle;
    }
</style> 
```

通过下面的 HTML 代码应用上面的 CSS，水平居中和垂直居中（又名：在中间垂直对齐）**：**

```
<div id="outer">
    <div id="inner">
    ...These <div>ITEMS</div> <img src="URL"/> are in center...
    </div>
</div> 
```

应用 CSS 并使用上述 HTML 后，网页中的该部分将如下所示：

```
BEFORE applying code:
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃V..Middle & H..Center        ┣━1
┃                             ┣━2
┃                             ┣━3
┗┳━━━━━━┳━━━━━━┳━━━━━━┳━━━━━━┳┛
 1      2      3      4      5

AFTER:
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                             ┣━1
┃    V..Middle & H..Center    ┣━2
┃                             ┣━3
┗┳━━━━━━┳━━━━━━┳━━━━━━┳━━━━━━┳┛
 1      2      3      4      5 
```

要在“外部”包装器中水平居中“内部”元素，“内部”元素（DIV、IMG 等类型）需要具有“内联”CSS 属性，例如：display:inline 或 display:inline-block等，然后“外部”CSS 属性 text-align:center 可以在“内部”元素上工作。

如此接近最少的 CSS 代码是：

```
<style>
    #outer {
        width: 100%;
        text-align: center;
    }

    #outer > .inner2 {
        display: inline-block;
    }
</style> 
```

通过下面的 HTML 代码将上面的 CSS 应用到中心（水平）**：**

```
<div id="outer">
    <img class="inner2" src="URL-1"> <img class="inner2" src="URL-2">
</div> 
```

应用 CSS 并使用上述 HTML 后，网页中的该行将如下所示：

```
BEFORE applying code:
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃┍━━━━━━━━━━┑                     ┃
┃│ img URL1 │                     ┃
┃┕━━━━━━━━━━┙                     ┃
┃┍━━━━━━━━━━┑                     ┃
┃│ img URL2 │                     ┃
┃┕━━━━━━━━━━┙                     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

AFTER:
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃    ┍━━━━━━━━━━┑ ┍━━━━━━━━━━┑    ┣━1
┃    │ img URL1 │ │ img URL2 │    ┣━2
┃    ┕━━━━━━━━━━┙ ┕━━━━━━━━━━┙    ┣━3
┗┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳┛
 1       2       3       4       5 
```

如果您想避免每次为每个“内部”元素指定 class="inner2" 属性，请尽早使用此类 CSS：

```
<style>
    #outer {
        width: 100%;
        text-align: center;
    }

    #outer > img, #outer > div {
        display: inline-block;
    }
</style> 
```

所以上面的 CSS 可以像下面这样应用，在“外部”包装器内（水平）居中：

```
<div id="outer">
    <img src="URL-1"> Text1 <img src="URL-2"> Text2
</div> 
```

应用 CSS 并使用上述 HTML 后，网页中的该行将如下所示：

```
BEFORE applying code:
┏━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃┍━━━━━━━━┑                ┃
┃│img URL1│                ┃
┃┕━━━━━━━━┙                ┃
┃Text1                     ┃
┃┍━━━━━━━━┑                ┃
┃│img URL2│                ┃
┃┕━━━━━━━━┙                ┃
┃Text2                     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━┛

AFTER:
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃   ┍━━━━━━━━━┑     ┍━━━━━━━━┑        ┣━1
┃   │img URL1 │     │img URL2│        ┣━2
┃   ┕━━━━━━━━━┙Text1┕━━━━━━━━┙Text2   ┣━3
┗┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳┛
 1        2        3        4        5 
```

“id”属性的唯一名称/值只能用于一个网页中的一个 HTML 元素，因此同一“id”名称的 CSS 属性不能在多个 HTML 元素上重复使用，（某些网络浏览器错误地允许使用多个元素上的相同 ID）。
因此，当您在同一网页中需要多行时，需要在该行的中心（水平）显示内部元素/项目，那么您可以使用这样的 CSS“类”（又名：CSS 组、CSS 中继器）**：**

```
<style>
    .outer2 {
        width: 100%;
        text-align: center;
    }

    .outer2 > div, .outer2 > div > img {
        display: inline-block;
    }
</style> 
```

所以上面的 CSS 可以像下面这样应用，在“outer2”包装器中居中（水平地）项目：

```
<div class="outer2">
    <div>
        Line1: <img src="URL-1"> Text1 <img src="URL-2">
    </div>
</div>
...
<div class="outer2">
    <div>
        Line2: <img src="URL-3"> Text2 <img src="URL-4">
    </div>
</div> 
```

应用 CSS 并使用上述 HTML 后，网页中的这些行将如下所示：

```
BEFORE applying code:
┏━━━━━━━━━━━━━━━━━━━━━━┓
┃Line1:                ┃
┃┍━━━━━━━━┑            ┃
┃│img URL1│            ┃
┃┕━━━━━━━━┙            ┃
┃Text1                 ┃
┃┍━━━━━━━━┑            ┃
┃│img URL2│            ┃
┃┕━━━━━━━━┙            ┃
┗━━━━━━━━━━━━━━━━━━━━━━┛
........................
┏━━━━━━━━━━━━━━━━━━━━━━┓
┃Line2:                ┃
┃┍━━━━━━━━┑            ┃
┃│img URL3│            ┃
┃┕━━━━━━━━┙            ┃
┃Text2                 ┃
┃┍━━━━━━━━┑            ┃
┃│img URL4│            ┃
┃┕━━━━━━━━┙            ┃
┗━━━━━━━━━━━━━━━━━━━━━━┛

AFTER:
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃         ┍━━━━━━━━┑     ┍━━━━━━━━┑   ┣━1
┃         │img URL1│     │img URL2│   ┣━2
┃   Line1:┕━━━━━━━━┙Text1┕━━━━━━━━┙   ┣━3
┗┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳┛
 1        2        3        4        5
.......................................
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃         ┍━━━━━━━━┑     ┍━━━━━━━━┑   ┣━1
┃         │img URL3│     │img URL4│   ┣━2
┃   Line2:┕━━━━━━━━┙Text2┕━━━━━━━━┙   ┣━3
┗┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳┛
 1        2        3        4        5 
```

要在中间垂直对齐，我们需要使用下面的 CSS 代码**：**

```
<style>
    .outer2 {
        width: 100%;
        text-align: center;
        vertical-align: middle;
    }

    .outer2 > div, .outer2 > div > img {
        display: inline-block;
        vertical-align: middle;
    }
</style> 
```

所以上面的 CSS 可以像下面这样应用，将项目水平居中并在“outer2”包装器的中间垂直对齐：

```
<div class="outer2">
    <div>
        Line1: <img src="URL-1"> Text1 <img src="URL-2">
    </div>
</div>
...
<div class="outer2">
    <div>
        Line2: <img src="URL-3"> Text2 <img src="URL-4">
    </div>
</div> 
```

应用 CSS 并使用上述 HTML 后，网页中的这些行将如下所示：

```
BEFORE applying code:
┏━━━━━━━━━━━━━━━━━━━━━━┓
┃Line1:                ┃
┃┍━━━━━━━━┑            ┃
┃│img URL1│            ┃
┃┕━━━━━━━━┙            ┃
┃Text1                 ┃
┃┍━━━━━━━━┑            ┃
┃│img URL2│            ┃
┃┕━━━━━━━━┙            ┃
┗━━━━━━━━━━━━━━━━━━━━━━┛
........................
┏━━━━━━━━━━━━━━━━━━━━━━┓
┃Line2:                ┃
┃┍━━━━━━━━┑            ┃
┃│img URL3│            ┃
┃┕━━━━━━━━┙            ┃
┃Text2                 ┃
┃┍━━━━━━━━┑            ┃
┃│img URL4│            ┃
┃┕━━━━━━━━┙            ┃
┗━━━━━━━━━━━━━━━━━━━━━━┛

AFTER:
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃         ┍━━━━━━━━┑     ┍━━━━━━━━┑   ┣━1
┃   Line1:│img URL1│Text1│img URL2│   ┣━2
┃         ┕━━━━━━━━┙     ┕━━━━━━━━┙   ┣━3
┗┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳┛
 1        2        3        4        5
.......................................
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃         ┍━━━━━━━━┑     ┍━━━━━━━━┑   ┣━1
┃   Line2:│img URL3│Text2│img URL4│   ┣━2
┃         ┕━━━━━━━━┙     ┕━━━━━━━━┙   ┣━3
┗┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳┛
 1        2        3        4        5 
```

* * *

## 回答 #70

> 赞同：3
> 
> 时间：2017-06-02T22:38:22.637

您可以使用一行代码，只需`text-align:center`.

这是一个例子：

```
#inner {
  text-align: center;
  }
```

```
<div id="outer" style="width:100%">
  <div id="inner"><button>hello</button></div>
</div>
```

* * *

## 回答 #71

> 赞同：3
> 
> 时间：2017-07-22T06:42:20.803

很抱歉，这个 1990 年代的婴儿*对*我有用：

```
<div id="outer">  
  <center>Foo foo</center>
</div> 
```

我会因为这个罪而下地狱吗？

* * *

## 回答 #72

> 赞同：3
> 
> 时间：2018-11-14T09:25:59.420

```
div{
    width: 100px;
    height: 100px;
    margin: 0 auto;
} 
```

如果您以静态方式使用 div ，则通常是这样。

如果您希望 div 在 div 对其父级是绝对的时居中，这里是示例：

```
.parentdiv{
    position: relative;
    height: 500px;
}

.child_div{
   position: absolute;
   height: 200px;
   width: 500px;
   left: 0;
   right: 0;
   margin: 0 auto;
} 
```

* * *

## 回答 #73

> 赞同：3
> 
> 时间：2018-11-25T08:40:10.047

这对我有用：

```
#inner {
    position: absolute;
    margin: 0 auto;
    left: 0;
    width: 7%;
    right: 0;
} 
```

在此代码中，您确定元素的宽度。

* * *

## 回答 #74

> 赞同：3
> 
> 时间：2019-07-18T18:06:45.247

您可以添加另一个与#inner 大小相同的div，并将其向左移动-50%（#inner 宽度的一半）和#inner 50%。

```
#inner {
    position: absolute;
    left: 50%;
}

#inner > div {
    position: relative;
    left: -50%;
}
```

```
<div id="outer">
  <div id="inner"><div>Foo foo</div></div>
</div>
```

* * *

## 回答 #75

> 赞同：2
> 
> 时间：2015-11-14T12:08:48.273

```
#outer {postion: relative}
#inner {
    width: 100px; 
    height: 40px; 
    position: absolute;
    top: 50%;
    margin-top: -20px; /* Half of your height */
} 
```

* * *

## 回答 #76

> 赞同：2
> 
> 时间：2015-12-20T21:45:58.430

根据您的情况，最简单的解决方案可能是：

```
margin: 0 auto; float: none; 
```

* * *

## 回答 #77

> 赞同：2
> 
> 时间：2015-12-23T09:39:26.890

是的，这是用于水平对齐的简短而干净的代码。

```
.classname {
   display: box;
   margin: 0 auto;
   width: 500px /* Width set as per your requirement. */;
} 
```

* * *

## 回答 #78

> 赞同：2
> 
> 时间：2016-03-28T09:45:42.190

就是这么简单。

只需决定要给内部 div 的宽度并使用以下 CSS。

### CSS

```
.inner{
  width: 500px; /* Assumed width */
  margin: 0 auto;
} 
```

* * *

## 回答 #79

> 赞同：2
> 
> 时间：2016-05-08T04:50:41.463

```
<div id="outer" style="width:100%;margin: 0 auto; text-align: center;">  
  <div id="inner">Foo foo</div>
</div>
```

* * *

## 回答 #80

> 赞同：2
> 
> 时间：2016-06-09T20:21:25.203

阅读完所有答案后，我没有看到我喜欢的答案。这就是您可以将一个元素居中于另一个元素的方式。

jsfiddle - [http://jsfiddle.net/josephtveter/w3sksu1w/](http://jsfiddle.net/josephtveter/w3sksu1w/)

```
<p>Horz Center</p>
<div class="outterDiv">
    <div class="innerDiv horzCenter"></div>
</div>
<p>Vert Center</p>
<div class="outterDiv">
    <div class="innerDiv vertCenter"></div>
</div>
<p>True Center</p>
<div class="outterDiv">
    <div class="innerDiv trueCenter"></div>
</div>
.vertCenter
{
    position: absolute;
    top:50%;
    -ms-transform: translateY(-50%);
    -moz-transform: translateY(-50%);
    -webkit-transform: translateY(-50%);
    transform: translateY(-50%);
}

.horzCenter
{
    position: absolute;
    left: 50%;
    -ms-transform: translateX(-50%);
    -moz-transform: translateX(-50%);
    -webkit-transform: translateX(-50%);
    transform: translateX(-50%);
}

.trueCenter
{
    position: absolute;
    left: 50%;
    top: 50%;
    -ms-transform: translate(-50%, -50%);
    -moz-transform: translate(-50%, -50%);
    -webkit-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);
}

.outterDiv
{
    position: relative;
    background-color: blue;
    width: 10rem;
    height: 10rem;
    margin: 2rem;
}
.innerDiv
{
    background-color: red;
    width: 5rem;
    height: 5rem;
} 
```

* * *

## 回答 #81

> 赞同：2
> 
> 时间：2016-11-08T06:04:37.950

给`width`内部一些`div`并添加`margin:0 auto;`CSS 属性。

* * *

## 回答 #82

> 赞同：2
> 
> 时间：2017-01-18T07:16:19.073

**CSS**

```
#inner {
  display: table;
  margin: 0 auto; 
} 
```

**HTML**

```
<div id="outer" style="width:100%">  
  <div id="inner">Foo foo</div>
</div> 
```

* * *

## 回答 #83

> 赞同：2
> 
> 时间：2017-05-17T09:07:03.950

使用下面的代码。

### HTML

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div> 
```

### CSS

```
#outer {
  text-align: center;
}
#inner{
  display: inline-block;
} 
```

* * *

## 回答 #84

> 赞同：2
> 
> 时间：2017-08-04T15:08:49.627

您可以添加以下代码：

```
#inner {
  width: 90%;
  margin: 0 auto;
  text-align:center;
}
```

```
<div id="outer">  
  <div id="inner">Foo foo</div>
</div>
```

* * *

## 回答 #85

> 赞同：2
> 
> 时间：2017-09-23T17:48:56.540

我们可以使用下一个 CSS 类，它允许垂直和水平居中任何元素与其父元素：

```
.centerElement{
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
} 
```

* * *

## 回答 #86

> 赞同：2
> 
> 时间：2017-10-14T07:09:12.610

使用此代码：

```
<div id="outer">
    <div id="inner">Foo foo</div>
</div>

#inner {
  width: 50%;
  margin: 0 auto;
  text-align: center;
} 
```

* * *

## 回答 #87

> 赞同：2
> 
> 时间：2017-10-18T09:51:37.220

采用：

```
<style>
  #outer{
    text-align: center;
    width: 100%;
  }
  #inner{
    text-align: center;
  }
</style> 
```

* * *

## 回答 #88

> 赞同：2
> 
> 时间：2018-03-15T18:18:19.143

这使您的内部 div 水平和垂直集中：

```
#outer{
    display: flex;
}
#inner{
    margin: auto;
} 
```

仅水平对齐，更改

```
margin: 0 auto; 
```

对于垂直，改变

```
margin: auto 0; 
```

* * *

## 回答 #89

> 赞同：2
> 
> 时间：2018-09-07T21:56:14.400

最简单的方法之一是使用`display: flex`. 外层 div 只需要显示 flex，内层需要`margin: 0 auto`使其水平居中。

要垂直居中并仅将 div 居中在另一个 div 中，请查看下面 .inner 类的注释

```
.wrapper {
  display: flex;
  /* Adding whatever height & width we want */
  height: 300px;
  width: 300px;
  /* Just so you can see it is centered */
  background: peachpuff;
}

.inner {
  /* center horizontally */
  margin: 0 auto;
  /* center vertically */
  /* margin: auto 0; */
  /* center */
  /* margin: 0 auto; */
}
```

```
<div class="wrapper">
  <div class="inner">
    I am horizontally!
  </div>
</div>
```

* * *

## 回答 #90

> 赞同：2
> 
> 时间：2020-04-22T14:10:19.270

在前面的示例中，他们使用了`margin: 0 auto`，`display:table`而其他答案使用了“with transform and translate”。

仅使用标签又如何呢？每个人都知道有一个`<center>`HTML5 不支持的标签。但它适用于 HTML5。例如，在我的旧项目中。

它正在工作，但现在不仅是[MDN Web Docs](https://en.wikipedia.org/wiki/MDN_Web_Docs)，而且其他网站都建议不要再使用它。在*[Can I use](https://caniuse.com/#info_about)*你可以看到来自 MDN Web Docs 的注释。但无论如何，有这样的方法。这只是要知道。总是被注意到某事是如此有用。

[![在此处输入图像描述](https://i.stack.imgur.com/aNDMQ.png)](https://i.stack.imgur.com/aNDMQ.png)

* * *

## 回答 #91

> 赞同：2
> 
> 时间：2020-09-22T18:08:56.827

试试这个：

```
<div style="position: absolute;left: 50%;top: 50%;-webkit-transform: translate(-50%, -50%);transform: translate(-50%, -50%);"><div>Foo foo</div></div> 
```

* * *

## 回答 #92

> 赞同：2
> 
> 时间：2020-11-03T23:46:52.677

在我的情况下，我需要在一个可以垂直具有不同位置的按钮下方居中（在屏幕上）一个下拉菜单（使用 flexbox 作为它的项目）。在我将位置从绝对位置更改为固定位置之前，这些建议都不起作用，如下所示：

```
 margin: auto;
  left: 0;
  right: 0;
  position: fixed; 
```

上面的代码使下拉菜单始终位于所有尺寸设备的屏幕中心，无论下拉按钮垂直位于何处。

* * *

## 回答 #93

> 赞同：2
> 
> 时间：2021-04-16T21:55:15.443

我看过很多很多答案，它们都已经过时了。谷歌已经为这个常见问题实施了一个解决方案，无论发生什么，它都会将对象放在中间，是的，它是响应式的。所以永远不要再做`transform()`或`position`手动了。

## .HTML

```
...
<div class="parent">
   <form> ... </form>
   <div> ... </div>
</div> 
```

## .CSS

```
.parent {
   display: grid;
   place-items: center;
} 
```

* * *

## 回答 #94

> 赞同：2
> 
> 时间：2021-10-27T05:38:53.253

有几种方法可以实现：使用“flex”、“positioning”、“margin”等。假设`#outer`和`#inner`问题中给出的 div：

**我建议使用“flex”**

```
#outer {
   display: flex;
   justify-content: center;
   align-items: center;  /* if you also need vertical center */
} 
```

使用定位水平对齐

```
#outer {
  position: relative;
}
#inner {
  position: absolute;
  left: 50%;
  translate: transformX(-50%)
} 
```

使用定位水平和垂直对齐

```
#outer {
  position: relative;
}
#inner {
  position: absolute;
  left: 50%;
  top: 50%;
  translate: transform(-50%, -50%)
} 
```

使用边距水平对齐

```
#inner {
 width: fit-content;
 margin: 0 auto;
} 
```

* * *

## 回答 #95

> 赞同：1
> 
> 时间：2014-03-08T19:19:59.820

我知道我回答这个问题有点晚了，而且我没有费心阅读每一个答案，所以这*可能*是重复的。[这是我的看法](http://jsfiddle.net/spikey/FLL5Z/)：

```
inner { width: 50%; background-color: Khaki; margin: 0 auto; } 
```

* * *

## 回答 #96

> 赞同：1
> 
> 时间：2014-08-13T13:20:22.447

试试这个：

```
<div id="a">
    <div id="b"></div>
</div> 
```

CSS：

```
#a{
   border: 1px solid red;
   height: 120px;
   width: 400px
}

#b{
   border: 1px solid blue;
   height: 90px;
   width: 300px;
   position: relative;
   margin-left: auto;
   margin-right: auto;
} 
```

* * *

## 回答 #97

> 赞同：1
> 
> 时间：2014-09-27T08:29:03.617

首先：您需要为第二个 div 指定宽度：

例如：

### HTML

```
<div id="outter">
    <div id="inner"Centered content">
    </div
</div> 
```

### CSS：

```
 #inner{
     width: 50%;
     margin: auto;
} 
```

请注意，如果您不给它一个宽度，它将占用该行的整个宽度。

* * *

## 回答 #98

> 赞同：1
> 
> 时间：2015-01-15T14:31:34.443

这个简单的解决方案对我有用，而不是多个包装器和/或自动边距：

```
<div style="top: 50%; left: 50%;
    height: 100px; width: 100px;
    margin-top: -50px; margin-left: -50px;
    background: url('lib/loading.gif') no-repeat center #fff;
    text-align: center;
    position: fixed; z-index: 9002;">Loading...</div> 
```

它将 div 放在视图的中心（垂直和水平），调整大小并调整大小，居中背景图像（垂直和水平），居中文本（水平），并将 div 保持在视图中和内容的顶部。只需放置在 HTML 中即可`body`享受。

* * *

## 回答 #99

> 赞同：1
> 
> 时间：2016-02-12T08:15:29.567

最好的方法是使用表格单元格显示（内部），它恰好位于带有显示表格（外部）的 div 之后，并为内部 div 设置垂直对齐（带有表格单元格显示）和您在内部 div 中使用的每个标签放置在 div 或页面的中心。

注意：您必须将指定的高度设置为外部

这是你知道的最好的方法，没有相对或绝对位置，你可以在每个浏览器中使用它。

```
#outer{
  display: table;
  height: 100vh;
  width: 100%;
}

#inner{
  display: table-cell;
  vertical-align: middle;
  text-align: center;
}
```

```
<div id="outer">
    <div id="inner">
      <h1>
          set content center
      </h1>
      <div>
        hi this is the best way to align your items center
      </div>
    </div>
</div>
```

* * *

## 回答 #100

> 赞同：1
> 
> 时间：2016-07-03T13:24:03.617

HTML：

```
<div id="outer">
  <div id="inner">
  </div>
</div> 
```

CSS：

```
#outer{
  width: 500px;
  background-color: #000;
  height: 500px
}
#inner{
  background-color: #333;
  margin: 0 auto;
  width: 50%;
  height: 250px;
} 
```

[小提琴](https://jsfiddle.net/78gu7vwv/)。

* * *

## 回答 #101

> 赞同：1
> 
> 时间：2016-07-30T11:38:24.820

**添加`text-align:center;`到父 div**

```
#outer {
    text-align: center;
} 
```

[https://jsfiddle.net/7qwxx9rs/](https://jsfiddle.net/7qwxx9rs/)

或者

```
#outer > div {
    margin: auto;
    width: 100px;
} 
```

[https://jsfiddle.net/f8su1fLz/](https://jsfiddle.net/f8su1fLz/)

* * *

## 回答 #102

> 赞同：1
> 
> 时间：2017-02-20T13:16:12.063

简单地说`Margin:0px auto`：

```
#inner{
  display: block;
  margin: 0px auto;
  width: 100px;
}
```

```
<div id="outer" style="width:100%">  
  <div id="inner">Foo foo</div>
</div>
```

* * *

## 回答 #103

> 赞同：1
> 
> 时间：2017-12-02T05:28:36.803

你可以用不同的方式来做。请参阅以下示例：

```
1\. First Method
#outer {
   text-align: center;
   width: 100%;
}
#inner {
   display: inline-block;
}

2\. Second method
#outer {
  position: relative;
  overflow: hidden;
}
.centered {
   position: absolute;
   left: 50%;
} 
```

* * *

## 回答 #104

> 赞同：1
> 
> 时间：2018-01-25T06:45:04.570

```
#inner {
  display: table;
  margin: 0 auto;
}
```

```
<div id="outer" style="width:100%">
  <div id="inner">Foo foo</div>
</div>
```

* * *

## 回答 #105

> 赞同：1
> 
> 时间：2018-01-25T07:09:19.307

居中 div 的主要属性是`margin: auto`并`width:`根据要求：

```
.DivCenter{
    width: 50%;
    margin: auto;
    border: 3px solid #000;
    padding: 10px;
} 
```

* * *

## 回答 #106

> 赞同：1
> 
> 时间：2018-08-14T14:49:52.880

```
#outer {
  width: 160px;
  padding: 5px;
  border-style: solid;
  border-width: thin;
  display: block;
}

#inner {
  margin: auto;
  background-color: lightblue;
  border-style: solid;
  border-width: thin;
  width: 80px;
  padding: 10px;
  text-align: center;
}
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div>
```

* * *

## 回答 #107

> 赞同：1
> 
> 时间：2018-12-29T21:02:52.120

我找到了与 类似的方法`margin-left`，但也可以`left`。

```
#inner {
    width: 100%;
    max-width: 65px; /* To adapt to screen width. It can be whatever you want. */
    left: 65px; /* This has to be approximately the same as the max-width. */
} 
```

* * *

## 回答 #108

> 赞同：1
> 
> 时间：2019-05-29T13:17:41.380

```
#inner {
  width: 50%;
  margin: 0 auto;
} 
```

* * *

## 回答 #109

> 赞同：1
> 
> 时间：2020-08-18T13:02:12.817

### CSS *justify-content*属性

它在容器的中心*对齐*Flexbox 项目：

```
#outer {
    display: flex;
    justify-content: center;
} 
```

* * *

## 回答 #110

> 赞同：1
> 
> 时间：2020-09-04T18:26:09.083

```
#outer
{
 display: grid;
 justify-content: center;

}
```

```
<div id="outer">
  <div id="inner">hello</div>
</div>
```

`enter code here`

* * *

## 回答 #111

> 赞同：1
> 
> 时间：2021-03-22T03:02:09.527

# 要使[元素水平居中，](https://www.tutorialstonight.com/how-to-center-a-div-in-css.php)您可以使用以下方法：

## **方法一：使用边距属性**

如果元素是块级元素，则可以使用 margin 属性使元素居中。设置`margin-left`为`margin-right`自动（简写 - `margin: 0 auto`）。

这会将元素水平对齐到中心。如果元素不是块级元素，则向其添加`display: block`属性。

```
#outer {
  background-color: silver;
}
#inner {
  width: max-content;
  margin: 0 auto;
  background-color: #f07878;
}
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div>
```

## **方法二：使用[CSS flexbox](https://www.tutorialstonight.com/css/css-flexbox.php)**

创建一个 flexbox 容器并使用`justify-content`属性并将其设置为`center`. 这会将所有元素水平对齐到网页的中心。

```
#outer {
  display: flex;
  justify-content: center;
  background-color: silver;
}
#inner {
  background-color: #f07878;
}
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div>
```

## 方法3：使用绝对位置技术

这是使元素居中的经典方法。设置`postion:relative`为外部元素。将内部元素的位置设置为绝对和`left: 50%`。这将推动内部元素从外部元素的中心开始。现在使用 transform 属性并设置`transform: translateX(-50%)`它会使元素水平居中。

```
#outer {
  position: relative;
  background-color: silver;
}
#inner {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  background-color: #f07878;
}
```

```
<div id="outer">
  <center>
    <div id="inner">Foo foo</div>
  </center>
</div>
```

* * *

## 回答 #112

> 赞同：1
> 
> 时间：2022-02-16T08:28:54.940

```
<html>
```

```
*{
        margin: 0;
        padding: 0;
    }
    #outer{
        background: red;
        width: 100%;
        height: 100vh;
        display: flex;
        /*center For  vertically*/
        justify-content: center;
        flex-direction: column;
        /*center for horizontally*/
        align-items: center;
    }
    #inner{
        width: 80%;
        height: 40px;
        background: grey;
    margin-top:5px;
    }
```

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>horizontally center an element</title>
</head>

<body>
<div id="outer">
  <div id="inner">1</div>
  <div id="inner" style="background: green;">2</div>
  <div id="inner" style="background: yellow;">3</div>
</div>
</body>
</html>
```

* * *

## 回答 #113

> 赞同：0
> 
> 时间：2017-01-13T23:10:40.147

将 CSS 添加到您的内部 div。设置`margin: 0 auto`并设置它的宽度小于100%，也就是外层div的宽度。

```
<div id="outer" style="width:100%"> 
    <div id="inner" style="margin:0 auto;width:50%">Foo foo</div> 
</div> 
```

这将给出预期的结果。

* * *

## 回答 #114

> 赞同：0
> 
> 时间：2021-01-20T06:29:55.763

Flexbox 水平居中和垂直居中对齐元素

```
.wrapper {border: 1px solid #678596; max-width: 350px; margin: 30px auto;} 

.parentClass { display: flex; justify-content: center; align-items: center; height: 300px;}

.parentClass div {margin: 5px; background: #678596; width: 50px; line-height: 50px; text-align: center; font-size: 30px; color: #fff;}
```

```
<h1>Flexbox Center Horizontally and Vertically Center Align an Element</h1>
<h2>justify-content: center; align-items: center;</h2>

<div class="wrapper">

<div class="parentClass">
  <div>c</div>
</div>

</div>
```

* * *

## 回答 #115

> 赞同：0
> 
> 时间：2021-03-30T07:45:19.943

```
button {
  margin: 0 auto;
  width: fit-content;
  display: block;
}
// container should have set width (for example 100%) 
```

* * *

## 回答 #116

> 赞同：0
> 
> 时间：2021-05-15T13:32:47.303

```
#outer {
display:grid;
place-items:center;
}
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div>
```

* * *

## 回答 #117

> 赞同：0
> 
> 时间：2021-10-30T09:07:31.893

我只是建议`justify-content: center;`在容器显示为 flex 时使用。`text-align: center;`当它是关于文本元素时。

检查下面的代码并根据要求进行修改。

```
#content_block {
  border: 1px solid black;
  padding: 10px;
  width: 50%;
  text-align: center;
}

#container {
  border: 1px solid red;
  width:100%;
  padding: 20px;
  display: flex;
  justify-content: center;
}
```

```
<div id="container">
  <div id="content_block">Foo foo check</div>
</div>
```

* * *

## 回答 #118

> 赞同：0
> 
> 时间：2022-01-20T11:43:37.717

```
#outer{
  display: flex;
  width: 100%;
  height: 200px;
  justify-content:center;
  align-items:center;
} 
```

* * *

## 回答 #119

> 赞同：-1
> 
> 时间：2017-07-26T09:29:50.050

您可以使用链接[https://plnkr.co/edit/MQD5QHJe5oUVKEvHCz8p?p=preview](https://plnkr.co/edit/MQD5QHJe5oUVKEvHCz8p?p=preview)

```
.outer{
      display: table;
      width: 100%;
      height: 100%;
}
.inner {
    vertical-align: middle;
} 
```

参考[https://v4-alpha.getbootstrap.com/examples/cover/](https://v4-alpha.getbootstrap.com/examples/cover/)

* * *

## 回答 #120

> 赞同：-1
> 
> 时间：2019-05-23T12:50:57.837

对于水平居中的 DIV：

```
#outer {
  width: 100%;
  text-align: center;
}
#inner {
  display: inline-block;
} 
```

```
<div id="outer">
  <div id="inner">Foo foo</div>
</div> 
```

* * *

## 回答 #121

> 赞同：-3
> 
> 时间：2018-07-15T15:00:52.370

```
<!DOCTYPE html>
<html>
  <head>
    <title>Center</title>
    <style>
    .outer{
          text-align: center;
           }
    .inner{
          width: 500px;
          margin: 0 auto;
          background: brown;
          color: red;
    }

</style>

  </head>

  <body>

    <div class="outer">
      <div class="inner">This DIV is centered</div>
    </div>

  </body>
</html>
```

请试试这个。它可以在没有 HTML 中心标签的情况下工作。

* * *

## 回答 #122

> 赞同：-4
> 
> 时间：2016-12-09T11:13:58.110

```
.outer {
    text-align: center;
    width: 100%
} 
```

* * *

## 回答 #123

> 赞同：-4
> 
> 时间：2017-01-31T07:45:32.977

```
<div id="outer" style="width:100%">  
  <div id="inner" style="text-align:center">Foo foo</div>
</div> 
```

* * *

## 回答 #124

> 赞同：-5
> 
> 时间：2013-12-02T22:48:36.703

```
<center> 
```

我被已知的最简单的中心宠坏了？

```
</center> 
```

* * *

## 回答 #125

> 赞同：-12
> 
> 时间：2013-03-14T15:00:00.553

居中：自动宽度边距

此框通过将其左右边距宽度设置为“自动”来水平居中。这是使用 CSS 实现水平居中的首选方式，并且在大多数支持 CSS 2 的浏览器中效果很好。不幸的是，Internet Explorer 5/Windows 不响应这种方法——这是该浏览器的缺点，而不是技术的缺点。

有一个简单的解决方法。（在你抵抗那个词引起的恶心时停顿了一下。）准备好了吗？Internet Explorer 5/Windows 错误地将 CSS“文本对齐”属性应用于块级元素。为包含的块级元素（通常是 BODY 元素）声明“text-align:center”会使 Internet Explorer 5/Windows 中的框水平居中。

这种变通方法有一个副作用：继承了 CSS“text-align”属性，使内联内容居中。通常需要为居中的框显式设置“文本对齐”属性，以抵消 Internet Explorer 5/Windows 变通方法的影响。相关的 CSS 如下。

```
body {
    margin: 50px 0px;
    padding: 0px;
    text-align: center;
}

#Content {
    width: 500px;
    margin: 0px auto;
    text-align: left;
    padding: 15px;
    border: 1px dashed #333;
    background-color: #EEE;
} 
```

[http://bluerobot.com/web/css/center1.html](http://bluerobot.com/web/css/center1.html)

# php - 在 Red Hat 系统上设置 Subversion

> ID：114555
> 
> 赞同：1
> 
> 时间：2008-09-22T12:30:26.553
> 
> 标签：php, svn, redhat

我对版本控制的世界还很陌生，但我想将 Subversion 引入我们的小型开发团队，因为我们发现越来越多的人正在处理相同的项目/文件。`PHP`我们主要在`LAMP`环境（红帽企业）中编码。

我正在寻找一些让我启动和运行的起点，例如 Red Hat 的安装/配置指南。我使用 Dreamweaver `CS3`（我看到将在 中介绍 Subversion 功能`CS4`），因此愿意查看其他具有 Subversion 集成的 PHP IDE，您有什么偏好吗？我愿意接受建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T12:49:38.847

这取决于您运行的 RHEL 版本。一般来说，设置 Subversion 非常容易，您只需安装二进制文件并运行 svnserve 或调整 Apache 配置。

1.  得到它：[http ://subversion.tigris.org/getting.html](http://subversion.tigris.org/getting.html)
2.  安装它
3.  `svnadmin create --fs-type=fsfs`

之后，您就有了一个可以通过 apache 或 svnserve 服务的存储库。我可以推荐 Apache，因为它可以更好地扩展，更易于维护，并且允许您通过 DAV 访问存储库。

示例配置在这里：[http ://svnbook.red-bean.com/en/1.0/ch06s04.html](http://svnbook.red-bean.com/en/1.0/ch06s04.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T13:21:01.657

安装 subversion 可能不会是最困难的部分，困难的部分是您如何访问存储库。有多种选择（网络上的文件共享、通过 SSH 的颠覆、通过 http 连接）。每个人都有自己的优点和缺点。您目前的发展情况如何？例如，如果你们都使用相同的 webroot，版本控制将无济于事，因为您仍然会更改彼此的文件，因此您必须为每个开发人员创建单独的站点。

至于 IDE，以[TortoiseSVN](http://tortoisesvn.tigris.org/)的形式为 Windows 提供了一个很好的 shell 集成，它仍然允许您使用自己喜欢的工具，并且仍然可以轻松访问 SVN 功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T08:29:08.043

在 RHEL 系统上，安装 subversion 最简单的方法是使用 yum：

百胜安装颠覆

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T13:16:14.417

这些对 Linux + Subversion 有好处：
[http](http://articles.slicehost.com/subversion)
://articles.slicehost.com/subversion 加上它进入多个存储库、WebDAV 和许多其他东西。对 Windows 开发人员也很有用，因为大多数信息也可以在 Windows 中使用。

# winapi - 通过 WINE / Crossover 的 Mac 工具栏

> ID：114559
> 
> 赞同：1
> 
> 时间：2008-09-22T12:30:48.800
> 
> 标签：winapi, macos, wine

有谁知道是否可以让 Win32 应用程序在 wine/crossover 下运行，但主工具栏显示为 Mac 工具栏（即在 wine/crossover 应用程序之外）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T13:25:15.500

什么是“主工具栏”？在 Win32 中，窗口不需要菜单栏（即：IE），甚至不需要主窗口（！），所以这显然是不可能的。如果您真的想要，您可以将[GetMenu()](http://msdn.microsoft.com/en-us/library/ms647640(VS.85).aspx)发送到第一个创建的窗口，然后在应用程序获得焦点时使用（类似的东西？我没有经常使用菜单 API）[GetMenuItemInfo()](http://msdn.microsoft.com/en-us/library/ms647980(VS.85).aspx)来填充 mac 工具栏，但我认为对于一个 80% 的最佳解决方案来说，这将是很多工作，更不用说我不知道​​从哪里开始将它与 WINE 或交叉集成。

# java - Java中的序列化日期

> ID：114575
> 
> 赞同：8
> 
> 时间：2008-09-22T12:32:37.377
> 
> 标签：java, web-services, serialization, date

我正在通过 Web 服务传递一些对象，其中一些包含 java.sql.Date。因为 Date 没有空的构造函数，所以它不想被序列化。

问题的第一部分很简单：在客户和服务之间传递日期的最佳方式是什么？

第二部分有点棘手：一旦我决定如何传递日期，我显然可以声明日期瞬态并制作一些包装类以将日期作为 String 或其他方式传递，但是如何将相同的解决方案尽可能透明地应用于包括 Date 的几个类?

（我有一种预感，DynamicProxy thingy 可能是一个解决方案，但阅读 Sun 网站上的文档并不是很有帮助，所以如果它确实是朝那个方向发展的，将不胜感激）

编辑：我问错了问题，对不起（我和同事之间有些误解，实际上是什么问题）。由于反序列化而出现问题。因此，一旦我有 xml 格式的日期，它就会尝试将自己反序列化为 GregorianCalendar。问题的其他部分仍然存在：接收某些东西（长时间戳或 GregorianCalendar）并将其转换为 sql 日期的最佳方式是什么，而不为 10 个不同的类制作 10 个不同的包装器。我正在使用 NetBeans 进行代码和 wsdl 生成。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-22T12:52:54.423

# 乔达时间

Date 类有一个笨拙的 API。更好的实现是[Joda-Time](http://www.joda.org/joda-time/)。

# ISO 8601

Joda-Time 还允许您将日期转换为[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)标准格式 (yyyy-mm-ddTHH:MM:SS.SSS)。在将日期从服务器移动到客户端时使用此标准具有以可读格式包含完整日期的优势。例如，当您使用[JAXB](http://docs.oracle.com/javase/tutorial/jaxb/intro/)时，日期的 XML 表示也是这个 ISO 标准。（参见 XMLGregorianCalendar 类）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-22T12:45:34.193

按照之前的建议序列化 Date.getTime() 返回的 long 将起作用。但是，您应该注意，如果您的服务器与客户端位于另一个时区，那么您将在另一端重建的日期将有所不同。如果您想重建完全相同的日期对象，您还需要发送您的时区 (TimeZone.getID()) 并使用它来重建另一边的日期。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-22T13:08:19.240

为了回答您问题的第一部分，我建议使用 iso 8601 格式的字符串（这是编码日期的标准）。

对于第二部分，我不确定您为什么需要代理类？或者为什么你必须扩展日期类来支持这一点。例如。您的 Web 服务不会知道某个字段是日期并进行从日期到字符串的转换并返回自身吗？我需要更多信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-22T12:34:35.123

java.sql.Date 扩展 java.util.Date

只需使用 getTime() 从中获取长值。这可以被序列化，并在另一端从它构造一个新的 java.sql.Date(long) 或 new java.util.Date(long)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-22T12:47:06.263

我研究了 java.sql.Date 的实现，我认为 java.sql.Date 是可序列化的，是 java.util.Date 的扩展。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-22T18:26:50.720

java.sql.Date 最近对我有一个警告，它不只存储日期部分的时间部分（小时、分钟、秒等）。如果你想要完整的时间戳，你必须使用 java.util.Date 或 java.sql.Timestamp

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-01-20T03:52:58.657

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-22T12:45:53.693

您可以使用编码器和解码器来序列化和反序列化您的对象。

这是一个序列化 SWT Rectangle 类的示例：

```
XMLEncoder encoder = new XMLEncoder(new FileOutputStream(file));
encoder.setPersistenceDelegate(
    Rectangle.class, 
    new DefaultPersistenceDelegate(new String[]{"x", "y", "width", "height"}));
encoder.writeObject(groups);
encoder.close(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-22T13:43:10.153

java.sql.Date 已经实现了 Serializable 所以不需要实现它:-)

就您的主要问题而言，我非常喜欢 JAXB，因为我几乎可以将任何 XML 转换为对象，因此可能值得您花时间研究它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-22T12:36:26.057

首先，如果您使用 Web 服务，这意味着您正在序列化为 XML，而不是常规的 Java 序列化（而是一些其他用于编组和解组的库）。所以这个问题缺乏一些信息。

其次，如果您可以控制 InputStream 和 OutputStream，请尝试扩展 ObjectOutputStream 和 ObjectInputStream 并覆盖*replaceObject()*和*resolveObject()*，然后您可以为 java.sql.Date 实现序列化。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-22T12:43:40.843

您不需要默认构造函数（空）来序列化/反序列化日期（java.sql.Date 或 java.util.Date）。在反序列化期间，不调用构造函数，而是将对象的属性直接设置为序列化数据中的值，并且您可以按原样使用对象，因为它已反序列化。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-22T14:22:24.350

嗯......想不出任何理由为什么任何序列化的对象实例（通过默认的java机制序列化）应该将自己反序列化为另一个类的实例，因为类信息应该是序列化数据的固有部分。

因此，这要么是您的（反）序列化框架的问题，要么是框架在“发送端”（日历、java.util.Date 等）上接受任何“类似日期”的对象 - 因此 java.sql.Date 也是它扩展了 java.util.Date），将其“序列化”为某种常见日期格式的字符串（因此类型信息丢失），并将其“反序列化”回接收端的 Calendar 对象。

所以我认为获取 java.sql.Date 的最简单方法是执行

```
java.sql.Date date = new java.sql.Date(calendar.getTimeInMillis);
```

你需要一个 java.sql.Date 但从“反序列化”中获取 GregorianCalendar 。

# math - 了解 lambda 演算有多大帮助？

> ID：114581
> 
> 赞同：74
> 
> 时间：2008-09-22T12:34:26.247
> 
> 标签：math, functional-programming, computer-science, lambda-calculus

致所有了解[lambda 演算](http://en.wikipedia.org/wiki/Lambda_calculus)的人：关于编程，它给你带来了什么好处？你会建议人们学习它吗？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2008-12-17T08:06:36.100

lambda演算的好处是它是一个非常简单的计算模型，相当于一个图灵机。但是，虽然图灵机更像是汇编语言，但 lambda 演算更像是一种高级语言。如果您学习**Church 编码**，这将帮助您学习称为**continuation-passing style**的编程技术，这对于实现回溯搜索和其他巧妙的技巧非常有用。

lambda 演算在实践中的主要用途是**它是研究新的编程语言思想的一个很好的实验室工具**。如果你对新的语言特性有想法，你可以**将新特性添加到 lambda 演算中**，你会得到一些**表达能力足以编程的**东西，同时又足够**简单，可以深入研究**。这种用途实际上更多地用于语言设计者和理论家，而不是程序员。

Lambda演算本身也很酷：就像了解汇编语言一样，它将**加深您对计算的理解**。在 lambda 演算中*编写通用图灵机*特别有趣。但这是基础数学，而不是实际编程。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-09-22T12:55:18.693

如果您想使用任何[函数式编程语言](http://en.wikipedia.org/wiki/Functional_programming)进行编程，这是必不可少的。我的意思是，了解图灵机有多大用处？好吧，如果你写 C，语言范式非常接近图灵机——你有一个指令指针和一个当前指令，机器在当前状态下采取一些行动，然后慢慢进入下一条指令。

在函数式语言中，你根本不能那样思考——这不是语言范式。您必须回想一下 lambda 演算，以及那里如何评估术语。如果您不了解 lambda 演算，那么您将很难在函数式语言中发挥作用。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2010-05-18T06:16:34.580

老实说，在函数式编程之前学习 lambda 演算让我意识到这两者与 C 与任何命令式编程一样无关紧要。

Lambda 演算是*一种*函数式编程语言，一种深奥的语言，如果你喜欢的话，它是一个 Turing tarpit；不小心也是第一个。

大多数函数式编程语言根本不需要您“学习” lambda 演算，无论如何，lambda 演算非常小，您可以在一小时内“学习”它的公理。要知道它的结果，就像不动点定理一样，Church-Rosser 定理等与函数式编程无关。

此外，lambda-abstractions 通常被认为是“函数”，我不同意这一点，它们是算法，而不是函数，一个微小的区别，大多数“函数式语言”更多地以经典数学的方式处理它们的函数。

但是，例如要有效地使用 Haskell，您确实需要了解某些*类型系统*，这与 lambda 演算无关，System F 类型系统可以应用于所有“函数”并且根本不需要 lambda 抽象。通常在数学中我们说 f : R^2 -> R : f (x) = x^2。我们可以说：f (x) = x^2 :: R -> R -> R。事实上，Haskell 非常接近这种表示法。

Lambda 演算是一种理论形式，Haskell 的函数实际上并不比 f 更多的“lambda 抽象”： f(x) = x^2 实际上，使 lambda 抽象有趣的是它使我们能够定义通常被视为“常量”的东西作为“函数”，由于计算开销巨大，没有函数式语言可以做到这一点。Haskell 等只是 System F*类型系统*的一种受限形式，适用于日常经典数学中使用的函数。Haskell 中的函数当然不是 lambda 演算中的匿名形式符号化约申请者。大多数函数式编程语言不是基于符号归约的重写系统。Lisp 在某种程度上是一种范式，但它本身就是一种范式，它的“lambda 关键字”确实没有

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-09-22T13:35:30.000

我认为在实践中使用 lambda 演算进行编程是因为它是一个非常小的系统，可以捕捉抽象的本质（或者“匿名函数”或闭包，如果你愿意的话）。除此之外，我认为这通常不是必需的，除非您需要自己实现抽象（如 Tetha ( [114646](https://stackoverflow.com/questions/114581/how-helpful-is-knowing-lambda-calculus#114646) ) 所述）。

我也完全不同意 Denis Bueno ( [114701](https://stackoverflow.com/questions/114581/how-helpful-is-knowing-lambda-calculus#114701) ) 的说法，他说函数式编程是必不可少的。完全可以在没有任何 lambda 演算的情况下定义、使用或理解函数式语言。为了理解函数式语言中术语的评估（在我看来，这在某种程度上与函数式语言的使用相矛盾），您很可能会更好地学习术语重写系统。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-09-25T12:28:07.580

我同意那些说理论上可以在不学习 lambda 演算的情况下学习函数式编程的观点——但是不学习 lambda 演算有什么好处*呢*？这似乎并不需要大量的时间投资。

最有可能的是，它将帮助您更好地理解函数式编程。但即使没有，它仍然是一件很酷的事情，值得学习。[Y-combinator](http://en.wikipedia.org/wiki/Fixed_point_combinator)是一个美丽的东西。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-12-23T14:53:27.287

如果你只想做技术员，写程序做事，那么你真的不需要了解 lambda 演算、有限状态机、下推自动机、正则表达式、上下文无关文法、离散数学等。

但是，如果您对这些东西背后的更深奥秘感到好奇，您可能会开始想知道如何回答这些问题。这些概念很漂亮，会扩展你的想象力。我也认为他们，顺便说一句，使一个更好的练习者。

让我着迷的是明斯基的书《计算：有限与无限机器》。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-22T12:46:10.120

λ演算是一种计算模型，就像图灵机一样。因此，如果您需要为基于此模型的语言实现某个评估器，它会很有用，但是，在实践中，您只需要基本思想（呃。将参数在语义上正确地放在函数体中？）这就是它。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-22T13:06:23.987

学习 lambda 演算的一种可能方法是

[http://en.wikipedia.org/wiki/Lambda_Calculus](http://en.wikipedia.org/wiki/Lambda_Calculus)

或者，如果你想要更多，这里是我的博客，专门讨论 lambda 演算之类的东西

[http://weblogs.manas.com.ar/lziliani/](http://weblogs.manas.com.ar/lziliani/)

作为计算的每个抽象，使用 lambda 演算，您可以对大多数编程语言中使用的东西进行建模，例如子类型化。有关这方面的更多信息，从这个意义上讲，λ演算的实际用途最好的书之一是

[http://www.amazon.com/Types-Programming-Languages-Benjamin-Pierce/dp/0262162091/ref=sr_1_1?ie=UTF8&s=books&qid=1222088714&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/0262162091)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-09-23T00:27:39.617

我发现 Lambda 演算有助于更深入地理解函数式编程的工作原理。尤其是如何实现函数式语言。

它使我更容易理解类型系统和评估策略等高级概念（例如，按名称调用与按值调用）。

我认为使用基本的函数式编程技术不需要了解任何关于 Lambda 演算的知识。然而**，理解 lambda 演算可以更容易地学习高级编程理论**。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-11T06:06:29.977

我还想提一下，如果你在 NLP 领域做任何事情，lambda 演算是组合语义中大量工作的基础。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-22T12:45:58.483

对我来说，好处是更紧凑的协同编程。东西倾向于水平流动而不是垂直流动。此外，它对于制作简单算法的原型非常有用。不知道我是否充分利用了它，但我发现它非常有用。

# math - 数学解析器的智能设计？

> ID：114586
> 
> 赞同：59
> 
> 时间：2008-09-22T12:35:33.420
> 
> 标签：math, parsing, calculator

设计数学解析器最聪明的方法是什么？我的意思是一个接受数学字符串（如：“2 + 3 / 2 + (2 * 5)”）并返回计算值的函数？很久以前我确实在VB6中写过一个，但它最终变得臃肿而且不是很便携（或者就此而言很聪明......）。一般的想法，伪代码或真实代码表示赞赏。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2008-09-22T12:37:46.677

一个非常好的方法将涉及两个步骤。第一步包括[将表达式从中缀转换为后缀](http://scriptasylum.com/tutorials/infix_postfix/algorithms/infix-postfix/index.htm)（例如，通过[Dijkstra 的 shunting yard](http://en.wikipedia.org/wiki/Shunting-yard_algorithm)）表示法。[一旦完成，编写一个postfix evaluator](http://scriptasylum.com/tutorials/infix_postfix/algorithms/postfix-evaluation/index.htm)就很简单了。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-22T14:36:27.993

我写了几篇关于设计数学解析器的博客文章。有一个一般性的[介绍、有关](http://lukaszwrobel.pl/blog/math-parser-part-1-introduction)[语法](http://lukaszwrobel.pl/blog/math-parser-part-2-grammar)的基本知识、[用 Ruby 编写的示例实现](http://lukaszwrobel.pl/blog/math-parser-part-3-implementation)和一个[测试套件](http://lukaszwrobel.pl/blog/math-parser-part-4-tests)。也许您会发现这些材料很有用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-22T12:38:28.687

你有几种方法。您可以生成动态代码并执行它以获得答案，而无需编写太多代码。只需在 .NET 中搜索运行时生成的代码，周围就有很多示例。

或者，您可以创建一个实际的解析器并生成一个小解析树，然后用于评估表达式。同样，这对于基本表达式来说非常简单。查看 codeplex，因为我相信他们那里有一个数学解析器。或者只是查找将包含示例的 BNF。任何介绍编译器概念的网站都会将此作为基本示例。

[Codeplex 表达式评估器](http://www.codeplex.com/Flee)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-22T12:47:33.767

如果你有一个“永远在线”的应用程序，只需将数学字符串发布到谷歌并解析结果。简单的方法，但不确定这是否是你所需要的——但我想在某种程度上很聪明。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-04-26T04:55:12.443

我知道这很旧，但我在尝试开发一个计算器作为更大应用程序的一部分时遇到了这个问题，并使用公认的答案遇到了一些问题。这些链接对理解和解决这个问题非常有帮助，不应小看。我正在用 Java 编写一个 Android 应用程序，对于表达式“字符串”中的每个项目，当用户在键盘上键入时，我实际上将一个字符串存储在 ArrayList 中。对于中缀到后缀的转换，我遍历了 ArrayList 中的每个字符串，然后评估了新排列的字符串的后缀 ArrayList。这对于少数操作数/运算符来说非常棒，但更长的计算始终没有，尤其是当表达式开始计算为非整数时。在提供的中[缀到后缀转换的链接中](http://scriptasylum.com/tutorials/infix_postfix/algorithms/infix-postfix/index.htm)，如果扫描的项目是运算符并且 topStack 项目具有更高的优先级，则建议弹出堆栈。我发现这几乎是正确的。如果 topStack 项目的优先级高于或等于扫描的运算符，则弹出 topStack 项目最终使我的计算结果正确。希望这将有助于解决此问题的任何人，并感谢 Justin Poliey（和 fas？）提供了一些宝贵的链接。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-22T12:57:15.913

相关问题[Equation (expression) parser with priority?](https://stackoverflow.com/questions/28256/equation-expression-parser-with-precedence) 也有一些关于如何开始的很好的信息。

-亚当

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-22T12:41:34.420

假设您的输入是字符串格式的中缀表达式，您可以将其转换为[后缀](http://en.wikipedia.org/wiki/Reverse_Polish_notation)，并使用一对堆栈：一个运算符堆栈和一个操作数堆栈，从那里解决解决方案。您可以在 Wikipedia 链接上找到一般算法信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-31T14:14:27.110

ANTLR 是一个非常好的 LL(*) 解析器生成器。我强烈推荐它。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-08-31T05:07:51.463

开发人员总是希望有一个干净的方法，并尝试从头开始实现解析逻辑，通常以[Dijkstra Shunting-Yard 算法](http://en.wikipedia.org/wiki/Shunting-yard_algorithm)结束。结果是看起来很整洁的代码，但可能充满了错误。我已经开发了这样一个 API，[JMEP](https://code.google.com/p/jmep/)，它可以完成所有这些，但是我花了很多年才拥有稳定的代码。

即使完成了所有这些工作，您甚至可以从那个项目页面中看到我正在认真考虑切换到使用 JavaCC 或 ANTLR，即使在所有工作已经完成之后也是如此。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-04-25T15:49:16.930

从被问到这个问题的 11 年后：如果你不想重新发明轮子，那里有许多奇特的数学解析器。

我几年前写过一个，它支持算术运算、方程求解、微积分、积分、基本统计、函数/公式定义、绘图等。

它被称为[ParserNG](https://github.com/gbenroscience/ParserNG)并且它是免费的。

评估表达式很简单：

```
 MathExpression expr = new MathExpression("(34+32)-44/(8+9(3+2))-22"); 
    System.out.println("result: " + expr.solve());

    result: 43.16981132075472 
```

或者使用变量并计算简单的表达式：

```
 MathExpression expr = new MathExpression("r=3;P=2*pi*r;"); 
System.out.println("result: " + expr.getValue("P")); 
```

或使用功能：

```
MathExpression expr = new MathExpression("f(x)=39*sin(x^2)+x^3*cos(x);f(3)"); 
System.out.println("result: " + expr.solve());

result: -10.65717648378352 
```

或评估给定点的导数（注意它在幕后进行符号微分（不是数值），因此准确性不受数值近似误差的限制）：

```
MathExpression expr = new MathExpression("f(x)=x^3*ln(x); diff(f,3,1)"); 
System.out.println("result: " + expr.solve());

 result: 38.66253179403897 
```

它在 x=3 处微分**`x^3 * ln(x)`**一次。您现在可以区分的次数是 1。

或数值积分：

```
MathExpression expr = new MathExpression("f(x)=2*x; intg(f,1,3)"); 
System.out.println("result: " + expr.solve());

result: 7.999999999998261... approx: 8 
```

这个解析器速度相当快并且有很多其他的功能。

通过绑定到 Objective C 将它移植到 Swift 的工作已经结束，我们已经在其他迭代用例中使用它来绘制应用程序。

**免责声明：ParserNG 由我编写。**

# php - 与 Jabber/Aim 集成的简单网络“实时聊天”软件（LAMP 堆栈）

> ID：114590
> 
> 赞同：6
> 
> 时间：2008-09-22T12:35:52.203
> 
> 标签：php, ajax, chat, xmpp

我过去曾多次寻找这个，但无济于事。我想要一个简单的`php/ajax`网络聊天界面，这是关键部分，它将`IM client (Pidgin)`通过 Jabber 或 Aim 与我的……交互。`Plugoo`几乎是我想要的，除了它是托管的，并且是基于 Flash 的。如果不理想，基于 Flash 的也可以，但托管则不是。

请注意，我不仅需要通知，而且我希望网站的用户单击“实时聊天”来获得聊天界面，并且我的 IM 客户端允许我与他们进行交互。

对于我们这些想要为不使用 IM 的客户提供实时支持的人来说，这非常方便。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-22T15:19:11.407

（免责声明：我为[Jabber, Inc.](http://www.jabber.com/)工作，这是我即将拉皮条的产品背后的商业公司。）

[![JabberWerx AJAX](https://i.stack.imgur.com/tuKFA.png)](https://i.stack.imgur.com/tuKFA.png)
[（来源：[jabber.com](http://www.jabber.com/images/GroupChatAJAXThumb.png)）]

JabberWerx [AJAX](http://www.jabber.com/CE/JabberWerxAJAXLibrary)库完全符合您的要求。您包含对 Javascript 库的引用，在您希望聊天的位置添加 div 标记，并添加几行配置 javascript 以将两者挂钩。还有一对一的模式。如果您愿意，也可以即时创建用户帐户。

对不起广告，但我认为这正是你想要的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-22T13:30:24.163

如果您实现 AIM 使用的 Oscar 协议，这不会那么难。它不是很复杂，这将允许您为您的网站构建一个不错的基于 Web 的 AIM 客户端。您可能会使用第 3 方解决方案，但据我所知，Oscar 非常微不足道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T09:01:14.093

我认为[http://www.plupper.com](http://www.plupper.com)正是您正在寻找的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-03T16:08:26.797

如果您使用[Strophe](http://code.stanziq.com/strophe/)，应该很容易让它工作，特别是如果您有[Jack Moffitt的](http://en.wikipedia.org/wiki/Jack_Moffitt)[Professional XMPP Programming with JavaScript and jQuery](http://amzn.to/9zlZsK)的副本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T19:16:48.167

这个产品要多少钱？回复Joe Hildebrand 的[回复。](https://stackoverflow.com/questions/114590/simple-web-live-chat-software-lamp-stack-that-integrates-with-jabber-aim/115453#115453)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T11:29:50.063

到目前为止，我能想到的最快方法是将[Google Talk 小工具](http://www.google.com/support/talkgadget/bin/answer.py?answer=86171)添加到您的页面。您自己需要一个 gmail 帐户，但您页面的访问者不需要，他们可以开始聊天。Google Talk 非常适合 Pidgin。

如果您想自己动手，Jabber Wiki 提供了 Jabber 的 Web 客户端列表：

*   [http://www.jabber.org/web/Clients#Web_Browser](http://www.jabber.org/web/Clients#Web_Browser)

[JWChat](http://blog.jwchat.org/jwchat/)可能会做你想做的事。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-26T13:36:03.307

对于基于 PHP 的解决方案，您可以尝试使用[Jaxl 库](http://jaxl.net)构建您的应用程序。我们完全使用这个库在[Jaxl IM](http://jaxl.im)上构建一个托管服务，它与任何类型的平台（移动、桌面、Web）上的所有 XMPP 客户端（pidgin、psi、gtalk）集成。

我们用于构建 Jaxl IM 解决方案的所有内容都以 Jaxl 库的形式公开，可用于构建您自己的自定义解决方案。如果您的项目需要任何咨询/帮助，请告诉我们。

# python - 在 Python 中缩放和显示图像的最快方法是什么？

> ID：114597
> 
> 赞同：6
> 
> 时间：2008-09-22T12:36:53.183
> 
> 标签：python, animation, matplotlib, image-scaling

我需要以 20fps 左右的速度显示 int16 的二维 numpy.array。使用 Matplotlib 的 imshow 阻塞任何高于 10fps 的内容。缩放和插值显然存在一些问题。我应该补充一点，数组的尺寸是未知的，但可能是 30 乘 400 左右。

这些是来自应该具有实时显示的传感器的数据，因此必须动态重新采样数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-22T12:43:30.297

显示 30x400 数据点的最快方法是：

## 使用 OpenGL 颜色数组

如果您可以快速将数据转换为 OpenGL 所理解的颜色数组，您可以创建一个描述四边形的顶点数组，每个传感器一个，然后更新您的颜色数组并在屏幕上正交绘制。

## 使用 OpenGL 纹理

如果您可以快速将数据点转换为 opengl 纹理，则可以绘制一个绑定到该纹理的具有固定 UV 坐标的四边形。

## 使用 pygame

Pygame 支持将 Numpy/Numarray 转换为表面，然后 Pygame 可以转换涉及重新采样的此类表面，重新采样后您可以在屏幕上对其进行 blit。

## 杂项

[pyglet](http://pyglet.org/)使处理 opengl 变得非常容易

# delphi - 如何复制包含其计算字段的 Delphi TTable？

> ID：114619
> 
> 赞同：1
> 
> 时间：2008-09-22T12:41:47.727
> 
> 标签：delphi

我已经定义了一个带有计算字段的 Delphi TTable 对象，它用于表单的网格中。我想制作 TTable 对象的副本，包括计算字段，打开该副本，使用副本对数据进行一些更改，关闭副本，然后刷新原始副本，从而刷新网格视图。有没有一种简单的方法来获取 TTable 对象的副本以这种方式使用？

理想的答案将是尽可能一般地解决问题的答案，即一种获得如下内容的方法：

```
newTable:=getACopyOf(existingTable); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T01:39:29.887

您可以使用**TBatchMove**组件来复制表及其结构。

设置 Mode 属性以指定所需的操作。Source 和 Destination 属性指示添加、删除或复制其记录的数据集。联机帮助包含更多详细信息。

（尽管我认为您应该研究 TClientDataSet 方法 - 它肯定更具可扩展性和更快）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T13:45:12.847

让我提出几件事：

让我们假设您想以编程方式进行更改。然后，您可以使用 TTable 的 DisableControls 和 EnableControls 方法在此期间禁止屏幕更新。

如果你想拥有两个具有相同数据的屏幕（fe 用于在在线更改期间比较数据），你实际上可以创建两次相同的屏幕，TTable 对象位于屏幕本身上。它将具有完全相同的配置（但不会继承先前在第一个屏幕上所做的更改，而是从数据库中读取数据）。在一个屏幕上所做的更改不会在另一个屏幕上自动刷新。

另一种方法：尝试使用 TDataSetProvider 和 TTable 作为数据集（源）提供 TClientDataSet。ApplyUpdates 会将更改反馈到 TTable。由于计算字段是只读的，因此它们不受影响。（未经测试，但应该可以）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T13:18:10.353

您应该能够选择表单上的表格，使用`Ctrl`-将其复制`C`，然后将其粘贴到任何文本编辑器中。您将获得对象属性的文本版本，然后可以根据需要对其进行编辑。完成后，再次选择所有文本，您可以将其复制到剪贴板并将其粘贴回表单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T14:15:56.253

我相信第二种方法（TClientDataset）可能是在这种情况下使用的最佳方法。另一种方法是使用内存表（例如[kbmMemTable](http://www.components4programmers.com/products/kbmmemtable/index.htm)）。无论哪种方式，您都将克隆您的原始表，然后在进行更改后循环通过数据集的内存版本并更新您的原始表。

# sharepoint - 如何对 Sharepoint 工作流程进行故障排除？

> ID：114632
> 
> 赞同：2
> 
> 时间：2008-09-22T12:44:51.747
> 
> 标签：sharepoint, workflow

我在这里有点迷路，找不到太多文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T12:49:56.990

.NET 工作流还是使用 SharePoint 设计器创建的工作流？

我只有后一种经验，而且它们并不容易调试，你真的只需要一次做一个步骤并测试每个步骤。

当您转到列表设置时，您也可以在 SharePoint 中查看工作流状态（抱歉，我目前没有 WSS 机器可供查看）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T12:51:53.007

同意@Slace。确保您在 SP Designer 中创建您的工作流以在浏览器中执行，即使最终它们只会因状态更改而启动。这本身将使故障排除变得更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T13:06:59.540

假设您在谈论 SharePoint Designer 工作流？[您可以按照这些步骤](http://sergeluca.spaces.live.com/blog/cns!E8A06D5F2F585013!1256.entry)将它们转换为 .NET 工作流。从那里，您可以调试它们。我自己（还）没有尝试过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T15:11:46.277

如前所述，调试 SharePoint Designer 工作流的唯一真正选择是经历将它们转换为 .NET 工作流的痛苦过程，或者在每一步之后执行诸如写出历史列表之类的操作，以便查看失败的原因。

然而，即使是 .NET 工作流在 VS2005 中也很难调试。在 VS2008 中，他们增加了更轻松地调试使用该环境开发的工作流的能力。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T17:44:25.580

我猜你已经看过了 :-)
[排查工作流错误](http://technet.microsoft.com/en-us/library/cc298927.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-10T14:39:14.187

没有人提到 SharePoint 调试的明显资源——ULS 日志。以“意外”级别过滤的 ULS 查看器通常会向您显示记录的失败原因。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-05T21:05:51.507

[本文](http://blog.thekid.me.uk/archive/2007/07/25/debugging-tips-for-sharepoint-and-wss-exceptions.aspx)提供了一些很棒的 SharePoint 调试技巧。它为开发/调试提供了一个很好的通用方法。以下是一些被引用的工具：

*   [反射器](http://www.red-gate.com/products/reflector/)
*   [提琴手](http://www.fiddler2.com/fiddler2/)
*   [DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)（实际上是所有 SysInternals 工具）
*   [IE 开发工具栏](http://www.microsoft.com/downloads/details.aspx?familyid=e59c3964-672d-4511-bb3e-2d5e1db91038&displaylang=en)
*   [XsltMajic](http://support.microsoft.com/kb/331026)
*   [数据库](http://www.microsoft.com/whdc/devtools/debugging/installx86.mspx)

# c# - ASP.NET：如何创建单选按钮并在 DetailsView 中对它们进行数据绑定？

> ID：114633
> 
> 赞同：0
> 
> 时间：2008-09-22T12:44:52.917
> 
> 标签：c#, asp.net, web-user-controls

我在 DetailsView 中有一个 TemplateField，它的输入应该是查找表中的几个选择之一。目前它是一个文本字段，但我希望它是一组单选按钮，它应该在插入和编辑模式下都可以工作（应该在编辑模式下选择正确的当前值）。

如何在 DetailsView TemplateField 中创建互斥单选按钮并将它们数据绑定？

我在使用 Oracle 数据库作为数据源的 ASP.NET 3.5 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-22T12:45:10.060

```
<EditItemTemplate>
    <asp:RadioButtonList ID="RadioButtonList1" runat="server" 
        DataSourceID="LookupSqlDataSource" DataTextField="LOOKUPITEM_DESCRIPTION" 
        DataValueField="LOOKUPITEM_ID" SelectedValue='<%# Bind("ITEM_ID")%>'>
    </asp:RadioButtonList>
</EditItemTemplate>

<InsertItemTemplate>
    <asp:RadioButtonList ID="RadioButtonList1" runat="server" 
        DataSourceID="LookupSqlDataSource" DataTextField="LOOKUPITEM_DESCRIPTION" 
        DataValueField="LOOKUPITEM_ID" SelectedValue='<%# Bind("ITEM_ID")%>'>
    </asp:RadioButtonList>
</InsertItemTemplate> 
```

# serialization - 使用 Microsoft WF 序列化版本化工作流

> ID：114656
> 
> 赞同：4
> 
> 时间：2008-09-22T12:47:59.757
> 
> 标签：serialization, workflow, versioning, workflow-foundation

我有一个简单的业务工作流程，具有以下条件

1.  用户需要使用设计器更改工作流程本身
2.  工作流程是一个长时间的rinning工作流程，所以会被序列化

有没有办法自动执行不同工作流程序集的版本控制任务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T13:39:08.807

不同工作流程序集的版本控制不是一项简单的任务，并且有很多复杂性。[在这里](http://msmvps.com/blogs/theproblemsolver/archive/2008/09/10/versioning-long-running-workfows.aspx)，您可以找到一系列与此相关的帖子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-22T16:44:27.877

您可以在自己的应用程序中重新托管 WF 设计器，以让最终用户更改工作流程。当您托管设计师时，您几乎可以控制他们可以做什么。例如，您可以阻止他们删除或禁用活动，只允许他们在工作流的预定义区域中添加特定的新活动。最好的方法是将这些工作流保存为 XOML 文件并以此方式启动它们。这确实意味着您不能将代码添加到工作流本身，但您可以自由定义从 SequentialWorkflowActivity（或状态等效项）派生的工作流基类并将其用作工作流基类。这允许您添加代码和属性。例如，您仍然可以添加 CodeActivity，但需要链接到基类中的代码。

工作流程序列化或所谓的脱水与正在运行的工作流程一起使用，以将它们保存到磁盘。这使用标准的 .NET 二进制序列化，并且由于工作流的长期运行性质，可能会很棘手。但是，一旦您知道要寻找什么，就没什么大不了的。有关一系列博客文章的开头，请参阅[http://msmvps.com/blogs/theproblemsolver/archive/2008/09/10/versioning-long-running-workfows.aspx 。](http://msmvps.com/blogs/theproblemsolver/archive/2008/09/10/versioning-long-running-workfows.aspx)

不确定您是否需要它，但也可以更改已经执行的工作流程。这使用 WorkflowChanges 对象。有关更多详细信息，请参见此处[http://wiki.windowsworkflowfoundation.eu/default.aspx/WF/RuntimeModificationOfWorkflows.html](http://wiki.windowsworkflowfoundation.eu/default.aspx/WF/RuntimeModificationOfWorkflows.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-12T13:13:31.063

这是另一篇关于工作流版本控制的文章：

[http://www.adefwebserver.com/DotNetNukeHELP/Workflow/VacationRequest3.htm](http://www.adefwebserver.com/DotNetNukeHELP/Workflow/VacationRequest3.htm)

基本上，您可以在以下情况下对使用程序集的工作流进行版本化：

*   与工作流一起使用的任何程序集都必须是强命名的。
*   如果程序集使用接口，它也必须是强命名的并放置在单独的程序集中。
*   web.config 中的一个条目可以指示asp.net 在哪里可以找到正确的程序集。

# c# - 在 .NET 中捕获基异常类

> ID：114658
> 
> 赞同：19
> 
> 时间：2008-09-22T12:48:47.697
> 
> 标签：c#, exception

我一直听到

```
catch (Exception ex) 
```

但是，这是不好的做法，我经常在事件处理程序中使用它，例如，操作可能会进入网络，从而可能导致许多不同类型的故障。在这种情况下，我会捕获所有异常并在消息框中向用户显示错误消息。

这被认为是不好的做法吗？对于这个例外，我无能为力：我不希望它停止应用程序，用户需要知道发生了什么，而且我处于代码的顶层。我还应该做什么？

编辑：

人们说我应该查看调用堆栈并专门处理错误，因为例如无法有意义地处理 StackOverflow 异常。然而，停止这个过程是**最坏**的结果，我想不惜一切代价阻止这种情况。如果我无法处理 StackOverflow，那就这样吧 - 结果不会比不捕获异常更糟糕，而且在 99% 的情况下，就我而言，通知用户是最不坏的选择。

此外，尽管我尽最大努力找出所有可能引发的异常，但在大型代码库中，我很可能会错过一些。而对于他们中的大多数人来说，最好的防御仍然是通知用户。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-09-22T12:54:21.613

不好的做法是

```
catch (Exception ex){} 
```

和变体：

```
catch (Exception ex){ return false; } 
```

等等

在顶层捕获所有异常并将它们传递给用户（通过记录它们或在消息框中显示它们，具体取决于您是在编写服务器应用程序还是客户端应用程序），这完全是正确的去做。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-09-22T13:56:39.687

我发现通用捕获总是不好的论点过于教条。他们和其他一切一样，都有一席之地。

那个地方**不是**你的库代码，也不是你为你的应用定制开发的类。正如许多人所提到的，那个地方是应用程序的最顶层，如果**出现任何**异常，很可能是出乎意料的。

这是我的一般规则（和所有规则一样，它被设计为在适当的时候被打破）：

我使用类和定制库来完成应用程序中的大部分工作。这是基本的应用程序架构——非常基本，请注意。这些人试图处理尽可能多的异常，如果他们真的无法继续，则将最具体的可用类型返回给 UI。

在 UI 上，我倾向于总是从事件处理程序中捕获所有内容。如果对捕获特定异常有合理的期望，**并且**我可以对此做一些事情，那么我会捕获特定异常并优雅地处理它。但是，这必须在全部捕获之前，因为 .NET 只会使用与您的异常匹配的第一个异常处理程序。（总是从最具体到最通用的顺序！）

如果除了错误输出之外我对异常无能为力（例如，数据库处于脱机状态），或者如果异常确实是意外的，catch all 将接受它，记录它并快速安全地进行故障处理，并显示一般错误消息在死前显示给用户。（当然，有些类型的错误几乎总是会不正常地失败——OutOfMemory、StackOverflow 等。我很幸运没有处理那些在产品级代码中的错误......到目前为止！）

抓住一切都有它的位置。那个地方不是隐藏异常，那个地方不是尝试和恢复（因为如果你不知道你抓到了什么，你怎么可能恢复），那个地方不是为了防止错误显示给用户，同时允许您的应用程序继续在未知和错误的状态下执行。

万无一失的地方是作为最后的手段，一个陷阱，以确保如果有任何东西通过你精心设计和严密防守的防御，至少它被适当地记录下来，并且可以干净地离开。如果您在较低级别没有精心设计和保护良好的防御，这是不好的做法，在较低级别也是非常**不好****的**做法，但作为最后的手段（在我看来）不仅可以接受，但往往是正确的做法。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-22T13:01:09.583

当我看见

```
catch (Exception ex) 
```

我的手开始摸索一把锤子。几乎没有任何借口可以捕获基本异常。我想到的唯一有效案例是：
1）第 3 方组件抛出异常（该死的作者）
2）非常顶级的异常处理（作为最后的手段）（例如在 WinForms 应用程序中处理“未处理”异常）

如果您发现可能会发生许多不同类型的异常的情况，那么这是糟糕设计的好兆头。

我不同意阿明·罗纳赫的观点。如果引发 StackOverflow 异常，你会怎么做？尝试执行额外的操作可能会导致更糟糕的后果。仅当您可以以有意义且安全的方式处理异常时才捕获异常。捕获 System.Exception 以涵盖可能的异常*范围*是非常错误的。即使你重新扔它。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-22T12:54:48.553

在代码的最高级别捕获异常是完全有意义的。只要您不需要根据异常类型执行任何不同的逻辑，就可以捕获基本异常类型。

**此外，请确保您显示的是友好的一般错误消息，而不是显示实际异常的消息。这可能会导致安全漏洞。**

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-22T14:03:50.900

**是的，可以在应用程序的顶层**捕获基本的 Execption ，这就是您正在做的事情。

您得到的强烈反应可能是因为在*任何其他级别*，捕获 Base 异常几乎总是错误的。特别是在图书馆中，这将是非常糟糕的做法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-22T12:51:48.920

从某种意义上说，您不应该在任何地方都这样做，这是一种不好的做法。

在这种情况下，我认为这是唯一合理的解决方案，因为您的例外可能真的是任何事情。唯一可能的改进是在捕获所有特定错误情况之前添加额外的处理程序，您可以对异常做一些事情。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-22T12:51:27.843

如果您重新引发无法正确处理的异常，那是完全可以的。如果您只是捕获异常，您可以隐藏代码中您不期望的错误。如果您捕获异常以显示它们（并绕过 die-and-print-traceback-to-stderr 行为），这是完全可以接受的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-22T13:28:47.787

我认为海报指的是这样的异常处理：

```
try {something} catch (SqlException) {do stuff} catch (Exception) {do other stuff} 
```

这里的想法是您希望首先捕获更具体的错误（如 SqlException）并适当地处理它们，而不是总是依赖于包罗万象的一般异常。

传统观点认为这是进行异常处理的正确方法（并且单独的 Catch (Exception ex) 是不好的）。在实践中，这种方法并不总是有效，尤其是当您使用其他人编写的组件和库时。

根据组件在开发环境中的行为方式，这些组件通常会在生产环境中引发与您的代码所期望的不同类型的异常，即使两种环境中的潜在问题是相同的。这是 ASP.NET 中一个非常常见的问题，并且经常导致我使用裸 Catch (Exception ex) 块，它不关心抛出什么类型的异常。

结构化异常处理在理论上是一个好主意。实际上，在您控制的代码域中，它仍然是一个好主意。一旦你引入了第三方的东西，它*有时*就不能很好地工作。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-22T13:42:54.493

我们经常使用 Catch ex 作为异常（VB.Net 变体）。我们记录它，并定期检查我们的日志。追查原因，解决。

我认为*一旦*您处理生产代码，Catch ex as Exception 是完全可以接受的，并且您有一种通用的方法来优雅地处理未知异常。就我个人而言，在我完成一个模块/新功能并针对我在测试中发现的任何异常进行专门处理之前，我不会使用通用捕获。这似乎是两全其美。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-22T12:51:49.560

不; 在这种情况下，如果您不想停止程序，那么您无能为力，并且在顶层是正确的地方，只要您正确登录并且没有将其隐藏在希望的*笑容中*

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-22T12:59:19.260

重要的是要了解异常通过应用程序的路径，而不是随意抛出或捕获它们。例如，如果您捕获的异常是内存不足怎么办？您确定在这种情况下会显示您的对话框吗？但是定义一个最后的异常点并说你*永远不*希望错误传播到那个点肯定是好的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-22T13:08:01.097

您应该捕获与您正在做的事情相关的异常。如果您查看您调用的方法，您会看到它们抛出了哪些异常，并且您希望更具体地处理这些异常。您应该有权了解您调用的方法可能引发哪些异常，并适当地处理它们。

而且... 比一次大的尝试捕获更好，在需要捕获的地方尝试并捕获。

```
try {
   myThing.DoStuff();
}
catch (StuffGoneWrongException ex) {
   //figure out what you need to do or bail
} 
```

也许不是那么紧密，但这取决于你在做什么。请记住，这项工作不仅仅是编译它并将其放在某人的桌面上，您还想知道如果发生了什么问题以及如何修复它。（在这里插入关于追踪的咆哮）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-22T14:25:03.033

很多时候异常被捕获以释放资源，是否（重新）抛出异常并不重要。在这些情况下，您可以避免 try catch：

1) 对于 Disposable 对象，您可以使用“using”关键字： using(SqlConnection conn = new SqlConnection(connStr)) { //code } 一旦超出使用范围（通常或通过 return 语句或通过异常），Dispsose方法会自动在对象上调用。换句话说，它就像 try/finally 构造。

2) 在asp.net 中，您可以拦截Page 对象的Error 或UnLoad 事件来释放您的资源。

我希望我能帮助你！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-03T15:38:36.303

我正在回应“但是，停止该过程是**最糟糕**的结果......”

如果您可以通过运行不同的代码（使用 try/catch 作为控制流）、重试、等待和重试、使用不同但等效的技术（即回退方法）重试来处理异常，那么一定要这样做。

进行错误消息替换和记录也很不错，除非是那种伪礼貌的被动攻击性“联系您的管理员”（当您知道没有管理员并且管理员对此无能为力时！ ) 但是在你这样做之后，应用程序应该结束，即你得到一个未处理的异常的相同行为。

*另一方面，如果您打算通过将用户返回到可能破坏其状态的代码线程来处理异常，我会说这*比结束应用程序并让用户重新开始更糟糕。用户一开始就必须重新启动更好还是让用户销毁数据更好？

如果我在决定我可以从哪些账户取款的模块中遇到意外异常，我真的要记录并报告异常并将用户返回到取款屏幕吗？据我们所知，我们刚刚授予他从所有账户提取资金的权利！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-01T04:59:40.470

这对于捕获可以处理的异常非常有用。但有时也会发生由于环境不稳定或用户只是正确执行该过程，应用程序会遇到意外异常。您尚未在代码中列出或处理。有没有办法从 app.config 文件中捕获未处理的异常并显示常见错误？

还将该详细异常消息放入日志文件中。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-07-28T15:15:19.090

我一直在处理异常情况，这是我目前正在遵循的实现结构：

1.  在 Try / Catch 之外将所有内容调暗为 Nothing / String.Empty / 0 等。
2.  将 Try / Catch 中的所有内容初始化为所需的值。
3.  首先捕获最具体的异常，例如 FormatException，但在最后的手段中保留基本异常处理（你可以有多个 catch 块，记住）
4.  几乎总是抛出异常
5.  让 global.asax 中的 Application_Error 子程序优雅地处理错误，例如调用自定义函数将错误的详细信息记录到文件中并重定向到某个错误页面
6.  杀死你在 finally 块中变暗的所有对象

我认为最近不“正确”处理异常是可以接受的一个例子是使用通过 HTTP GET 传递到页面的 GUID 字符串 (strGuid)。我本*可以*在调用 New Guid(strGuid) 之前实现一个函数来检查 GUID 字符串的有效性，但这样做似乎相当合理：

```
Dim myGuid As Guid = Nothing

Try
    myGuid = New Guid(strGuid)
    'Some processing here...

Catch ex As FormatException
    lblError.Text = "Invalid ID"

Catch ex As Exception 
    Throw

Finally
    If myGuid IsNot Nothing Then
        myGuid = Nothing
    End If

End Try 
```

# language-agnostic - 任何不寻常的技术经验？

> ID：114659
> 
> 赞同：1
> 
> 时间：2008-09-22T12:48:53.187
> 
> 标签：language-agnostic

[99 瓶啤酒](http://99-bottles-of-beer.net/)让我意识到 ADA、Erlang 和 Smalltalk 并不是那么奇怪的语言。

有很多不寻常的工具，我想其中很多甚至都被使用了:-)

您曾经使用过非常原始的技术吗？如果是，请告诉我们在哪种情况下，以及您对此有何看法。强烈期待有趣的片段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T13:28:46.960

我已经在**[Dyalog](http://www.dyalog.com/) [APL](http://en.wikipedia.org/wiki/APL_(programming_language))**专业工作了近三年了。学习一门完全不同的语言总是很有趣也很有挑战性，而且这种语言有它的优势。但我现在对它的兴趣多于烦恼。

一些特别的缺点：

*   办公室外几乎没有人问你是否被困住了。网上几乎没有可用的资源、提示和技巧。无论如何，世界上可能没有其他人做过你正在做的事情。
*   你必须一直重新发明轮子，因为真的没有类/函数库可以使用。（对于像我这样的极客来说，这可能很有趣，但效率并不高。）
*   您必须经常编写解决方法或避免使用“现代”功能，因为 IDE 和解释器是闭源的，而且供应商太小而没有资源来修复所有错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T12:51:40.357

我没有使用任何不寻常的技术，但我相信 Ada 在国防/航空航天/高可靠性领域仍然非常活跃。这是我想有一天捡起的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T12:53:26.203

我认为我“工作”过的*最奇怪*的事情是在高中 11 年级。我们正在学习神经网络中的反向传播，我们必须用老师想出的一些奇怪的假设语言来做作业。

# add-in - Word 2007 加载项

> ID：114663
> 
> 赞同：1
> 
> 时间：2008-09-22T12:49:40.127
> 
> 标签：add-in, ribbon, word-2007

好的，这个问题来自从未编写过 CSS、HTML 和一些 php 之外的任何代码的人……

我几乎整天都在使用 Word，并且经常需要参考网络上的几个站点和资源。

我想在 Word 的功能区中创建一个小插件。

我有完整的 VB 2008 专业版。

几乎我想做的只是有一个新标签，上面有一些易于访问的按钮，这些按钮链接到特定的 URL，尽管理想的情况是推送这些链接也会同时自动让我登录到网站.

可能的？

从此我希望能够在我了解更多信息时继续工作......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-22T12:56:23.900

是的，有可能，检查[VSTO](http://msdn.microsoft.com/en-us/office/aa905533.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-28T12:58:21.357

您可以明确地将其作为单词加载项来执行（自动登录部分可能很棘手......）。以下是一些资源：

*   [http://download.microsoft.com/download/a/6/1/a61dd5df-f52c-42d5-a95c-7a7fb7a6a466/ExtendedRibbon.wmv](http://download.microsoft.com/download/a/6/1/a61dd5df-f52c-42d5-a95c-7a7fb7a6a466/ExtendedRibbon.wmv)
*   [http://msdn.microsoft.com/en-us/library/aa338198.aspx](http://msdn.microsoft.com/en-us/library/aa338198.aspx)

但是，有更简单的方法可以做到这一点。我宁愿在我的 Windows 任务窗格中创建一个工具栏。

# winforms - ReportViewer - LocalReport - 合并报告？

> ID：114692
> 
> 赞同：3
> 
> 时间：2008-09-22T12:54:14.890
> 
> 标签：winforms, reportviewer, rdlc, localreport

我正在使用 ReportViewer WinForms，并且由于创建封面不是一种简单的方法，所以我想知道，是否可以呈现两个报告并将它们连接起来？所以它们显示为一个报告？

如果我只打印，那么我可以依次执行两个报告，但是由于用户希望在打印之前查看报告（你知道，这里没有环境浪费），所以它们必须出现在同一个查看器中。

或者，还有其他制作封面的方法吗？今天我使用了一个子报表，但是边距等方面存在一些问题，这不容易解决。

> 澄清一下，我们谈论的是使用 RDLC 文件的 ReportViewer，不涉及 Crystal Reports。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T05:45:29.653

您是否需要在 reportViewer 控件中将 2 个报告显示为 1，或者将它们都导出为 PDF 并显示包含两个报告的单个 PDF 是否令人满意？

我一直在寻找，但使用 Web ReportViewer 并找到了将报告导出到多个 PDF 的示例，然后使用 PDFtk 将 PDF 连接为 1（免费）

*   [关于使用 PDFtk 和 Reporting Services 的博客文章](http://spacefold.com/lisa/post/A-Tad-More-About-PDF-and-Reports-as-Document-Sections.aspx)
*   [同时显示多个 RDLC 报告](http://social.msdn.microsoft.com/Forums/en-US/vsreportcontrols/thread/add116eb-b907-4f34-a190-3127a3cc531c/)
*   [PDFtk 网站](http://www.accesspdf.com/pdftk/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T13:13:11.927

我创建了一个听起来像您正在尝试做的报告...首先澄清一下，我猜您在 VS2005/2008 中使用 Crystal Reports。

如果是这种情况，您需要在主报告中做的就是在包含“封面”布局/数据的部分之后创建一个附加部分。在“封面”部分的部分专家中（在布局视图中，右键单击部分标题栏，在弹出菜单中选择部分专家..），选中“之后新建页面”选项。

编辑：在您更新后，我看到您正在使用 RDLC 报告，并且由于我对这些报告的了解有限，我想不起来有一种简单的方法可以到达您想去的地方。虽然我很确定您可以在代码中将多个报表传递给同一个报表查看器。

# git - How do I create a readable diff of two spreadsheets using git diff?

> ID：114698
> 
> 赞同：175
> 
> 时间：2008-09-22T12:54:49.897
> 
> 标签：git, version-control, merge, diff, xls

We have a lot of spreadsheets (xls) in our source code repository. These are usually edited with gnumeric or openoffice.org, and are mostly used to populate databases for unit testing with [dbUnit](http://www.dbunit.org/). There are no easy ways of doing diffs on xls files that I know of, and this makes merging extremely tedious and error prone.

I've tried to converting the spreadsheets to xml and doing a regular diff, but it really feels like it should be a last resort.

I'd like to perform the diffing (and merging) with `git` as I do with text files. How would I do this, e.g. when issuing `git diff`?

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2008-09-22T13:09:32.497

Quick and easy with no external tools, works well as long as the two sheets you are comparing are similar:

*   Create a third spreadsheet
*   Type **`=if(Sheet1!A1 <> Sheet2!A1, "X", "")`** in the top left cell (or equivalent: click on the actual cells to automatically have the references inserted into the formula)
*   `Ctrl+C` (copy), `Ctrl+A` (select all), `Ctrl+V` (paste) to fill the sheet.

If the sheets are similar, this spreadsheet will be empty except for a few cells with X in them, highlighting the differences. Unzoom to 40% to quickly see what is different.

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2012-07-01T15:45:01.457

We faced the exact same issue in our co. Our tests output excel workbooks. Binary diff was not an option. So we rolled out our own simple command line tool. Check out the [ExcelCompare project](https://github.com/na-ka-na/ExcelCompare). Infact this allows us to automate our tests quite nicely. Patches / Feature requests quite welcome!

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-10-17T07:07:48.280

You can try this free online tool - [www.cloudyexcel.com/compare-excel/](http://www.cloudyexcel.com/compare-excel/)

It gives a good visual output online, in terms of rows added,deleted, changed etc.

![enter image description here](https://i.stack.imgur.com/0B37o.png)

Plus you donot have to install anything.

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-09-22T14:14:02.793

I've done a lot of comparing of Excel workbooks in the past. My technique works very well for workbooks with many worksheets, but it only compares cell contents, not cell formatting, macros, etc. Also, there's some coding involved but it's well worth it if you have to compare a lot of large files repeatedly. Here's how it works:

A) Write a simple dump program that steps through all worksheets and saves all data to tab-separated files. Create one file per worksheet (use the worksheet name as the filename, e.g. "MyWorksheet.tsv"), and create a new folder for these files each time you run the program. Name the folder after the excel filename and add a timestamp, e.g. "20080922-065412-MyExcelFile". I did this in Java using a library called [JExcelAPI](http://jexcelapi.sourceforge.net/). It's really quite easy.

B) Add a Windows shell extension to run your new Java program from step A when right-clicking on an Excel file. This makes it very easy to run this program. You need to Google how to do this, but it's as easy as writing a *.reg file.

C) Get [BeyondCompare](http://www.scootersoftware.com/). It has a very cool feature to compare delimited data by showing it in a nice table, [see screenshot](http://www.scootersoftware.com/moreinfo.php?zz=screenshot&shot=DataCompare).

D) You're now ready to compare Excel files with ease. Right-click on Excel file 1 and run your dump program. It will create a folder with one file per worksheet. Right-click on Excel file 2 and run your dump program. It will create a second folder with one file per worksheet. Now use BeyondCompare (BC) to compare the folders. Each file represents a worksheet, so if there are differences in a worksheet BC will show this and you can drill down and do a file comparison. BC will show the comparison in a nice table layout, and you can hide rows and columns you're not interested in.

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2010-05-04T22:55:28.480

I have found [xdocdiff WinMerge Plugin](http://freemind.s57.xrea.com/xdocdiffPlugin/en/index.html). It is a plugin for WinMerge (both **OpenSource** and **Freeware**, you doesn't need to write a VBA nor save an excel to csv or xml). It works just for the celd's contains.

This plugin supports also:

*   .rtf Rich Text
*   .docx/.docm Microsoft WORD 2007(OOXML)
*   .xlsx/.xlsm Microsoft Excel 2007(OOXML)
*   .pptx/.pptm Microsoft PowerPoint 2007(OOXML)
*   .doc Microsoft WORD ver5.0/95/97/2000/XP/2003
*   .xls Microsoft Excel ver5.0/95/97/2000/XP/2003
*   .ppt Microsoft PowerPoint 97/2000/XP/2003
*   .sxw/.sxc/.sxi/.sxd OpenOffice.org
*   .odt/.ods/.odp/.odg Open Document
*   .wj2/wj3/wk3/wk4/123 Lotus 123
*   .wri Windows3.1 Write
*   .pdf Adobe PDF
*   .mht Web Archive
*   .eml Exported files from OutlookExpress

Regard, Andres

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-22T23:01:39.610

Hmmm. From the Excel menu choose Window -> Compare side by side?

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-22T13:05:00.557

Do you use TortoiseSVN for doing your commits and updates in subversion? It has a diff tool, however comparing Excel files is still not really user friendly. In my environment (Win XP, Office 2007), it opens up two excel files for side by side comparison.

Right click document > Tortoise SVN > Show Log > select revision > right click for "Compare with working copy".

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-09-01T11:01:45.770

Newer versions of MS Office come with [Spreadsheet Compare](https://support.office.com/en-gb/article/Compare-two-versions-of-a-workbook-by-using-Spreadsheet-Compare-0e1627fd-ce14-4c33-9ab1-8ea82c6a5a7e), which performs a fairly nice diff in a GUI. It detects most kinds of changes.

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-07-09T18:53:05.043

There is a library [daff](https://github.com/paulfitz/daff) (short for data diff) which helps in comparing tables, producing a summary of their diffs, and using such a summary as a patch file.

It is written in Haxe, so it can be compiled in major languages.

I have made an [Excel Diff Tool](https://www.textcompare.org/excel/) in Javascript with help of this library. It works well with numbers & small strings but the output is not ideal for long strings (e.g. a long sentence with with minor character change).

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-08-05T15:43:35.200

I know several responses have suggested exporting the file to csv or some other text format, and then comparing them. I haven't seen it mentioned specifically, but Beyond Compare 3 has a number of additional file formats that it supports. See [Additional File Formats](http://www.scootersoftware.com/support.php?zz=kb_moreformats). Using one of the Microsoft Excel File Formats you can easily compare two Excel files without going through the export to another format option.

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-22T13:05:02.790

I would use the SYLK file format if performing diffs is important. It is a text-based format, which should make the comparisons easier and more compact than a binary format. It is compatible with Excel, Gnumeric, and OpenOffice.org as well, so all three tools should be able to work well together. [SYLK Wikipedia Article](http://en.wikipedia.org/wiki/SYmbolic_LinK_(SYLK) "SYLK Wikipedia Article")

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-02-07T16:47:35.443

Use [Altova DiffDog](http://www.altova.com/diffdog.html)

Use diffdog's XML diff mode and Grid View to review the differences in an easy to read tabular format. Text diff'ing is MUCH HARDER for spreadsheets of any complexity. With this tool, at least two methods are viable under various circumstances.

1.  Save As .xml

    To detect the differences of a simple, one sheet spreadsheet, save the Excel spreadsheets to compare as XML Spreadsheet 2003 with a .xml extension.

2.  Save As .xlsx

    To detect the differences of most spreadsheets in a modularized document model, save the Excel spreadsheets to compare as an Excel Workbook in .xlsx form. Open the files to diff with diffdog. It informs you that the file is a ZIP archive, and asks if you want to open it for directory comparison. Upon agreeing to directory comparison, it becomes a relatively simple matter of double-clicking logical parts of the document to diff them (with the XML diff mode). Most parts of the .xslx document are XML-formatted data. The Grid View is extremely useful. It is trivial to diff individual sheets to focus the analysis on areas that are known to have changed.

Excel's propensity to tweak certain attribute names with every save is annoying, but diffdog's XML diff'ing capabilities include the ability to filter certain kinds of differences. For example, Excel spreadsheets in XML form contain `row` and `c` elements that have `s` attributes (style) that rename with every save. Setting up a filter like `c:s` makes it much easier to view only content changes.

diffdog has a lot of diff'ing capability. I've listed the XML diff modes only simply because I haven't used another tool that I liked better when it comes to differencing Excel documents.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-13T21:54:21.713

I found an openoffice macro [here](http://www.oooforum.org/forum/viewtopic.phtml?p=207623#207623) that will invoke openoffice's compare documents function on two files. Unfortunately, openoffice's spreadsheet compare seems a little flaky; I just had the 'Reject All' button insert a superfluous column in my document.

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-06-17T04:00:02.300

xdocdiff plugin for SVN

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-09-10T21:04:24.397

If you're using Java, you could try [simple-excel](https://github.com/tobyweston/simple-excel).

It'll diff spreadsheets using Hamcrest matchers and output something like this.

```
java.lang.AssertionError:
Expected: entire workbook to be equal
     but: cell at "C14" contained <"bananas"> expected <nothing>,
          cell at "C15" contained <"1,850,000 EUR"> expected <"1,850,000.00 EUR">,
          cell at "D16" contained <nothing> expected <"Tue Sep 04 06:30:00">
    at org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20) 
```

I should qualify that we wrote that tool (like the ticked answer rolled their own).

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-04-09T09:30:32.257

If you have TortoiseSVN then you can `CTRL` click the two files to select them in Windows Explorer and then right-click, TortoiseSVN->Diff.

This works particularly well if you are looking for a small change in a large data set.

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-03-13T01:40:47.297

I got the problem like you so I decide to write small tool to help me out. Please check [ExcelDiff_Tools](https://github.com/kokichi88/ExcelDiff_MergeTool). It comes with several key points:

*   Support xls, xlsx, xlsm.
*   With formula cell. It will compare both formula and value.
*   I try to make UI look like standard diff text viewer with : modified, deleted, added, unchanged status. Please take a look with image below for example: [![enter image description here](https://i.stack.imgur.com/4Qryg.png)](https://i.stack.imgur.com/4Qryg.png)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-08-22T08:13:56.627

I'm the co-author of a free, open-source Git extension:

[https://github.com/ZoomerAnalytics/git-xltrail](https://github.com/ZoomerAnalytics/git-xltrail)

It makes Git work with any Excel workbook file format without any workarounds.

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-22T12:59:29.527

[Diff Doc](http://www.softinterface.com/MD%5CDocument-Comparison-Software.htm) may be what you're looking for.

> *   Compare documents of MS Word (DOC, DOCX etc), Excel, PDF, Rich Text (RTF), Text, HTML, XML, PowerPoint, or Wordperfect and retain formatting
> *   Choose any portion of any document (file) and compare it against any portion of the same or different document (file).

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-22T13:02:04.153

I don't know of any tools, but there are two roll-your-own solutions that come to mind, both require Excel:

1.  You could write some VBA code that steps through each Worksheet, Row, Column and Cell of the two Workbooks, reporting differences.

2.  If you use Excel 2007, you could save the Workbooks as Open-XML (*.xlsx) format, extract the XML and diff that. The Open-XML file is essentially just a .zip file of .xml files and manifests.

You'll end up with a lot of "noise" in either case if your spreadsheets aren't structurally "close" to begin with.

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-05-04T23:23:55.980

Convert to cvs then upload to a version control system then diff with an advanced version control diff tool. When I used perforce it had a great diff tool, but I forget the name of it.

# c# - C# WinForms 的可编辑数据网格

> ID：114707
> 
> 赞同：7
> 
> 时间：2008-09-22T12:56:49.470
> 
> 标签：c#, winforms, user-interface, editing

我需要向用户展示一个矩阵，其中一列是可编辑的。最适合使用的控件是什么？

我不能使用 ListView，因为您只能编辑第一列（标签），这对我没有好处。

DataGridView 是要走的路，还是有第三方替代组件做得更好？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-22T12:58:21.307

DataGridView 是最佳选择，因为它是免费的，并且附带 .NET WinForms 2.0。您可以定义可编辑列或只读列。另外，如果需要，您可以自定义外观。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T13:06:57.387

DataGridView 很好。

如果您喜欢更漂亮的界面，[Telerik 控件](http://www.telerik.com/products/winforms/overview.aspx)会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T13:41:14.747

如果 DataGridView 能够满足您的需求，那么它就是正确的答案。另一种选择（尽管这些部分似乎不受欢迎！）是[Infragistics NetAdvantage](http://www.infragistics.com/dotnet/netadvantage/winforms.aspx)。Infragistics 的缺点主要是成本高且学习曲线有些陡峭。好处是这些是您能找到的一些最强大的控件 - 所以如果您需要它们的灵活性，那就去吧。

我没有使用 Telerik 的经验（这里的其他人已经提到过），但它们看起来确实不错。由于我的公司在 Infragistics 上投入了大量资金，因此我们不会很快改变...

# vb6 - 如何使用 VB6 连接到 LDAP 存储

> ID：114725
> 
> 赞同：2
> 
> 时间：2008-09-22T13:00:21.880
> 
> 标签：vb6, ldap

我在将 Visual Basic (6) 与 LDAP 结合使用时遇到了问题。当我尝试连接到 LDAP 存储时，我总是会收到诸如“路径名错误”或“表不存在”之类的错误（取决于代码的样子）。

这是我编写的连接代码的一部分：

```
path = "LDAP://xx.xxx.xxx.xxx:xxx/"
Logging.WriteToLogFile "Test1", logINFO

Set conn = CreateObject("ADODB.Connection")
conn.Provider = "ADsDSOObject"
conn.Properties("User ID") = "USER_ID"
conn.Properties("Password") = "PASSWORD"
conn.Properties("Encrypt Password") = True
conn.Properties("ADSI Flag") = 34

Logging.WriteToLogFile "Test2", logINFO
conn.Open "Active Directory Provider"
Logging.WriteToLogFile "Test3", logINFO

Set rs = conn.Execute("<" & path & "ou=Some,ou=Kindof,o=Searchbase>;(objectclass=*);name;subtree")

Logging.WriteToLogFile "Test4", logINFO 
```

日志文件显示“Test1”、“Test2”、“Test3”，然后是“表不存在”，因此出现问题的是“Set rs = conn.Execute(...)”行（很明显...）。

在我的代码中，我尝试以安全的方式进行连接。我发现它与 SSL/证书无关，因为也无法建立匿名的不安全连接。有趣的是：我在 .NET 中用五分钟编写了一个小型测试应用程序。使用该应用程序，我能够（匿名）连接并从 LDAP 存储读取结果，完全没有问题。

有没有人对 LDAP 和 VB6 的组合有任何经验，也许知道可能是什么问题？我用谷歌搜索并看到了一些示例代码片段，但不幸的是它们都不起作用（与结果相同的错误消息）。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T13:16:01.343

我不确定这会有多大帮助，但我使用此代码访问 Active Directory 对象。

```
 Set oinfo = New ADSystemInfo
    sDomain = Split(oinfo.DomainDNSName, ".")
    '-- Get Datasets from the Active Directory

    '-- Connect to Active Directory in logged in domain
    con.Open "Provider=ADsDSOObject;Encrypt Password=False;Integrated Security=SSPI;Data Source=ADSDSOObject;Mode=Read;Bind Flags=0;ADSI Flag=-2147483648"

    '-- Query all serviceConnectionPoints in the Active Directory 
    '-- that contain the keyword "urn://tavis.net/TM/Database" 
    '--  and return the full path to the object

    Set rst = con.Execute("<LDAP://DC=" & sDomain(0) & ",DC=" & sDomain(1) & ">;(&(objectCategory=serviceConnectionPoint)(keywords=urn://tavis.net/TM/Database));Name, AdsPath;subTree") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T13:19:32.710

2件事：

*   方法调用需要额外的`Open()`参数，服务器/用户名/密码
*   您传递给的 LDAP 查询`Execute()`应该是：

    ```
    "<" & path & "ou=Some/ou=Kindof/o=Searchbase>;(objectclass=*);name;subtree" 
    ```

# sql-server - 如何在表中查找行大小

> ID：114728
> 
> 赞同：6
> 
> 时间：2008-09-22T13:01:16.497
> 
> 标签：sql-server, tsql

我的一个数据库已经接近允许的大小。

为了找出包含最大数据的表，我使用了以下查询：

```
exec sp_MSforeachtable @command1="print '?' exec sp_spaceused '?'" 
```

它返回了包含最大数据的罪魁祸首表。

作为下一步，我想根据大小清理行。为此，我想根据大小对行进行排序。

如何使用查询来实现这一点？有什么工具可以做到这一点吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-22T13:54:53.510

这将为您提供按大小排列的行列表，只需相应地设置 @table 和 @idcol （如所写，它将针对 Northwind 示例运行）

```
declare @table varchar(20)
declare @idcol varchar(10)
declare @sql varchar(1000)

set @table = 'Employees'
set @idcol = 'EmployeeId'
set @sql = 'select ' + @idcol +' , (0'

select @sql = @sql + ' + isnull(datalength(' + name + '), 1)' 
    from syscolumns where id = object_id(@table)
set @sql = @sql + ') as rowsize from ' + @table + ' order by rowsize desc'

exec (@sql) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T13:22:04.527

对于所有表大小，一个更简单的方法是使用[此站点上](http://www.mitchelsellers.com/blogs/articletype/articleview/articleid/121/determing-sql-server-table-size.aspx)的存储过程。您可以将该存储过程的 select 语句更改为：

```
SELECT * 
FROM #TempTable
Order by dataSize desc 
```

让它按大小排序。

你想怎么清理？清理特定表的最大行？不确定我是否理解这个问题。

**编辑**（回复评论）

假设您的事件日志与我的（DNN 事件日志）具有相同的布局：

```
SELECT     LEN(CONVERT(nvarchar(MAX), LogProperties)) AS length
FROM         EventLog
ORDER BY length DESC 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T13:31:53.957

您还可以使用它来获取索引和键的大小：（编辑：对不起，文本墙，无法使格式正常工作）

```
 WITH table_space_usage
( schema_name, table_name, index_name, used, reserved, ind_rows, tbl_rows )
AS (
SELECT s.Name
     , o.Name
     , coalesce(i.Name, 'HEAP')
     , p.used_page_count * 8
     , p.reserved_page_count * 8
     , p.row_count
     , case when i.index_id in ( 0, 1 ) then p.row_count else 0 end
FROM sys.dm_db_partition_stats p
  INNER JOIN sys.objects as o
    ON o.object_id = p.object_id
  INNER JOIN sys.schemas as s
    ON s.schema_id = o.schema_id
  LEFT OUTER JOIN sys.indexes as i
    on i.object_id = p.object_id and i.index_id = p.index_id
 WHERE o.type_desc = 'USER_TABLE'
   and o.is_ms_shipped = 0
)
 SELECT t.schema_name
     , t.table_name
     , t.index_name
     , sum(t.used) as used_in_kb
     , sum(t.reserved) as reserved_in_kb
     , case grouping(t.index_name) 
    when 0 then sum(t.ind_rows) 
    else sum(t.tbl_rows) end as rows
 FROM table_space_usage as t
 GROUP BY
       t.schema_name
     , t.table_name
     , t.index_name
 WITH ROLLUP
 ORDER BY
      grouping(t.schema_name)
    , t.schema_name
    , grouping(t.table_name)
    , t.table_name
    , grouping(t.index_name)
    , t.index_name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T13:27:07.197

也许这样的事情会起作用

```
delete table where id in 
(
    select top 100 id
    from table
    order by datalength(event_text) + length(varchar_column) desc
) 
```

（因为您正在处理事件表，它可能是您正在查看排序的文本列，因此 datalength sql 命令是这里的关键）

# reportviewer - ReportViewer - 修改工具栏？

> ID：114733
> 
> 赞同：7
> 
> 时间：2008-09-22T13:03:12.870
> 
> 标签：reportviewer, toolbar, rdlc

有没有人有关于如何修改 ReportViewer 工具栏的 WinForms 版本的工具栏的好主意？也就是说，我想删除一些按钮和变量，但看起来解决方案是创建一个全新的工具栏，而不是修改那里的工具栏。

就像，我不得不删除导出到 excel，并这样做：

```
 // Disable excel export
  foreach (RenderingExtension extension in lr.ListRenderingExtensions()) {
    if (extension.Name == "Excel") {
      //extension.Visible = false; // Property is readonly...
      FieldInfo fi = extension.GetType().GetField("m_isVisible", BindingFlags.Instance | BindingFlags.NonPublic);
      fi.SetValue(extension, false);
    }
  } 
```

如果你问我有点棘手.. 对于删除工具栏按钮，一种可能的方法是遍历 ReportViewer 中的 Control 数组并更改按钮的 Visible 属性以隐藏，但它一直被重置，所以它不是好办法..

顺便说一句，MS 什么时候发布新版本？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-10T11:05:05.587

是的。你可以用一个有点棘手的方式做到这一点。我的任务是为缩放报告添加更多比例因子。我是这样做的：

```
 private readonly string[] ZOOM_VALUES = { "25%", "50%", "75%", "100%", "110%", "120%", "125%", "130%", "140%", "150%", "175%", "200%", "300%", "400%", "500%" };
    private readonly int DEFAULT_ZOOM = 3;
    //--

    public ucReportViewer()
    {
        InitializeComponent();   
        this.reportViewer1.ProcessingMode = ProcessingMode.Local;

        setScaleFactor(ZOOM_VALUES[DEFAULT_ZOOM]);

        Control[] tb = reportViewer1.Controls.Find("ReportToolBar", true);

        ToolStrip ts;
        if (tb != null && tb.Length > 0 && tb[0].Controls.Count > 0 && (ts = tb[0].Controls[0] as ToolStrip) != null)
        {
            //here we go if our trick works (tested at .NET Framework 2.0.50727 SP1)
            ToolStripComboBox tscb = new ToolStripComboBox();
            tscb.DropDownStyle = ComboBoxStyle.DropDownList;

            tscb.Items.AddRange(ZOOM_VALUES);                
            tscb.SelectedIndex = 3; //100%

            tscb.SelectedIndexChanged += new EventHandler(toolStripZoomPercent_Click);

            ts.Items.Add(tscb);
        }
        else
        {                
            //if there is some problems - just use context menu
            ContextMenuStrip cmZoomMenu = new ContextMenuStrip();

            for (int i = 0; i < ZOOM_VALUES.Length; i++)
            {
                ToolStripMenuItem tsmi = new ToolStripMenuItem(ZOOM_VALUES[i]);

                tsmi.Checked = (i == DEFAULT_ZOOM);
                //tsmi.Tag = (IntPtr)cmZoomMenu;
                tsmi.Click += new EventHandler(toolStripZoomPercent_Click);

                cmZoomMenu.Items.Add(tsmi);
            }

            reportViewer1.ContextMenuStrip = cmZoomMenu;
        }                    
    }

    private bool setScaleFactor(string value)
    {
        try
        {
            int percent = Convert.ToInt32(value.TrimEnd('%'));

            reportViewer1.ZoomMode = ZoomMode.Percent;
            reportViewer1.ZoomPercent = percent;

            return true;
        }
        catch
        {
            return false;
        }
    }

    private void toolStripZoomPercent_Click(object sender, EventArgs e)
    {
        ToolStripMenuItem tsmi = sender as ToolStripMenuItem;
        ToolStripComboBox tscb = sender as ToolStripComboBox;

        if (tscb != null && tscb.SelectedIndex > -1)
        {
            setScaleFactor(tscb.Items[tscb.SelectedIndex].ToString());
        }
        else if (tsmi != null)
        {
            if (setScaleFactor(tsmi.Text))
            {
                foreach (ToolStripItem tsi in tsmi.Owner.Items)
                {
                    ToolStripMenuItem item = tsi as ToolStripMenuItem;

                    if (item != null && item.Checked)
                    {
                        item.Checked = false;
                    }
                }

                tsmi.Checked = true;
            }
            else
            {
                tsmi.Checked = false;
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-11-05T19:43:43.910

从 ReportViewer 控件获取工具栏：

```
ToolStrip toolStrip = (ToolStrip)reportViewer.Controls.Find("toolStrip1", true)[0] 
```

添加新项目：

```
toolStrip.Items.Add(...) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-22T13:16:43.370

有很多属性可以设置您希望看到哪些按钮。

例如[ShowBackButton](http://msdn.microsoft.com/en-us/library/microsoft.reporting.winforms.reportviewer.showbackbutton(VS.80).aspx)、[ShowExportButton](http://msdn.microsoft.com/en-us/library/microsoft.reporting.winforms.reportviewer.showexportbutton(VS.80).aspx)、[ShowFindControls](http://msdn.microsoft.com/en-us/library/microsoft.reporting.winforms.reportviewer.showfindcontrols(VS.80).aspx)等。[在帮助](http://msdn.microsoft.com/en-us/library/microsoft.reporting.winforms.reportviewer_members(VS.80).aspx)中查看它们，都以“显示”开头。

但你是对的，你不能添加新按钮。为此，您必须创建自己的工具栏。

新版本是什么意思？它已经有一个[2008 SP1](http://www.microsoft.com/downloads/details.aspx?FamilyID=bb196d5d-76c2-4a0e-9458-267d22b6aac6&DisplayLang=en)版本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-11-06T18:48:16.310

另一种方法是在运行时通过 javascript 操作生成的 HTML。它不是很优雅，但它确实让您可以完全控制生成的 HTML。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-03-31T15:45:10.907

对于VS2013 web ReportViewer V11（表示为rv），下面的代码添加了一个按钮。

```
private void AddPrintBtn()
    {           
        foreach (Control c in rv.Controls)
        {
            foreach (Control c1 in c.Controls)
            {
                foreach (Control c2 in c1.Controls)
                {
                    foreach (Control c3 in c2.Controls)
                    {
                        if (c3.ToString() == "Microsoft.Reporting.WebForms.ToolbarControl")
                        {
                            foreach (Control c4 in c3.Controls)
                            {
                                if (c4.ToString() == "Microsoft.Reporting.WebForms.PageNavigationGroup")
                                {
                                    var btn = new Button();
                                    btn.Text = "Criteria";
                                    btn.ID = "btnFlip";
                                    btn.OnClientClick = "$('#pnl').toggle();";
                                    c4.Controls.Add(btn);
                                    return;
                                }
                            }
                        }
                    }
                }
            }
        }
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-12-27T12:49:46.613

我有这个问题很长时间了，我在打了很长一段时间后找到了答案，我使用的知识的主要来源是这个 webpega：我要感谢你们所有人添加了允许我这样做的代码和一张图片结果。

您需要创建一个新类，而不是使用 ReportViewer 类，在我的例子中，我将其命名为 ReportViewerPlus，它是这样的：

```
using Microsoft.Reporting.WinForms;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace X
{
    class ReportViewerPlus : ReportViewer
    {
        private Button boton { get; set; }

        public ReportViewerPlus(Button but) {
            this.boton = but;
            testc(this.Controls[0]);
        }
        public ReportViewerPlus()
        {
        }
        private void testc(Control item){
            if(item is ToolStrip)   
            {       
                ToolStripItemCollection tsic = ((ToolStrip)item).Items;
                tsic.Insert(0, new ToolStripControlHost(boton));       
                return;   
            }   
            for (int i = 0; i < item.Controls.Count; i++)   
            {      
                testc(item.Controls[i]);  
            }   
        }
    }
} 
```

您必须直接在类的构造函数中添加按钮，并且可以在设计器中配置按钮。

这是结果的图片，不完美，但足够了（我发誓安全链接，但我不能发布自己的照片，没有足够的声誉）。

[http://prntscr.com/5lfssj](http://prntscr.com/5lfssj)

如果您仔细查看该类的代码，您会或多或少地看到它是如何工作的，并且您可以进行更改并使其可以在工具栏的其他站点中建立。

非常感谢您过去对我的帮助，我希望这可以帮助很多人！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T13:10:33.057

通常，如果您想修改它，您应该创建自己的工具栏。如果您只需要这样做，您删除按钮的解决方案可能会起作用，但如果您想添加自己的按钮，您可能应该咬紧牙关并构建一个替代品。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-04T13:25:11.703

您可以通过 CustomizeReportToolStrip 方法修改报表查看器控件。此示例删除 WinForm 中的页面设置按钮、页面布局按钮

```
public CustOrderReportForm() {
  InitializeComponent();
  CustomizeReport(this.reportViewer1);
}

private void CustomizeReport(Control reportControl, int recurCount = 0) {
  Console.WriteLine("".PadLeft(recurCount + 1, '.') + reportControl.GetType() + ":" + reportControl.Name);
  if (reportControl is Button) {
    CustomizeReportButton((Button)reportControl, recurCount);
  }
  else if (reportControl is ToolStrip) {
    CustomizeReportToolStrip((ToolStrip)reportControl, recurCount);
  }
  foreach (Control childControl in reportControl.Controls) {
    CustomizeReport(childControl, recurCount + 1);
  }
}

//-------------------------------------------------------------

void CustomizeReportToolStrip(ToolStrip c, int recurCount) {
  List<ToolStripItem> customized = new List<ToolStripItem>();
  foreach (ToolStripItem i in c.Items) {
    if (CustomizeReportToolStripItem(i, recurCount + 1)) {
      customized.Add(i);
    }
  }
  foreach (var i in customized) c.Items.Remove(i);
}

//-------------------------------------------------------------

void CustomizeReportButton(Button button, int recurCount) {
}

//-------------------------------------------------------------

bool CustomizeReportToolStripItem(ToolStripItem i, int recurCount) {
  Console.WriteLine("".PadLeft(recurCount + 1, '.') + i.GetType() + ":" + i.Name);
  if (i.Name == "pageSetup") {
    return true;
  }
  else if (i.Name == "printPreview") {
    return true;
  }
  return false; ;
} 
```

# xmpp - jabber 服务器的其他潜在用途

> ID：114735
> 
> 赞同：13
> 
> 时间：2008-09-22T13:03:28.953
> 
> 标签：xmpp

除了明显的个人对个人即时消息聊天之外，您还使用 Jabber 服务器的功能启用了哪些功能？

编辑：真正展示它的工作代码的链接特别有用 - 并且更有可能被投票。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-25T16:37:29.050

XMPP/Jabber 有无限的用途。

将您想要发送到其他地方的任何消息/数据，您可以使用 jabber。为分布式服务运行集中式日志记录服务？你可以胡说八道按摩。您想检查您的服务/程序是否正在运行？XMPP 的存在会告诉你。如果您添加自定义状态消息，您可以确切地看到正在发生的事情。

这就是思科参与其中的原因。想象一个服务器场，其中每个刀片都有一个内置的 mini jabber 客户端。在启动时，它将向中央服务器注册它的存在作为等待工作。中央服务器在其方向启动一些工作，然后将其状态更改为“忙碌”。另一个刀片完成了它的工作并将其状态更改回“可用”......冲洗并重复。

当您将实际的 jabber 消息与其带外功能结合起来时，这些服务器可以发布可以找到工作结果的位置。

在某种程度上，您认为需要传递消息的任何事情都可以使用 XMPP 完成。成为这个人对人，程序对程序，或任何组合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T10:12:04.163

我们使用 XMPP 和 BOSH 使用户能够通过手机直接和实时地与网络浏览器进行通信。

例如代码你可以查看我们的[开源API](http://github.com/PaulKinlan/vooices.us/tree/master)

vooices 网站也有现场示例，您可以在其中通过网络浏览器使用手机控制地图和玩游戏：[http ://www.vooices.us/](http://www.vooices.us/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T03:31:22.697

You might want to look at [Vertebra](http://www.engineyard.com/vertebra) which is...

> a framework for orchestrating complex processes in a Cloud. It is designed with an emphasis on security, fault tolerance, and portability.

From the knowledge base:

[Why was XMPP chosen for Vertebra?](http://vertebra-support.engineyard.com/faqs/xmpp/why_xmpp_for_vertebra)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T18:12:07.430

我打算用它来接收来自我的系统的通知，例如：

*   进程未完成
*   报告未按时生成
*   用户需要帮助

我已经以电子邮件的形式收到了许多此类消息。但是接收即时消息可能会更有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-04T23:17:51.850

[我们在http://superfeedr.com](http://superfeedr.com)上使用 xmpp 作为“总线”和实时 API

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-22T13:09:09.550

您可以使用 Jabber 服务器来处理/代理客户端应用程序和另一个服务器应用程序之间的消息。

它实际上可以非常有效。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-22T13:10:18.830

不是我，而是 Martin Woodward 使用 jabber 来控制显示构建服务器当前状态的“构建兔子”。

[http://www.woodwardweb.com/gadgets/000434.html](http://www.woodwardweb.com/gadgets/000434.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-22T13:21:51.283

XMPP 非常适合在不需要分成块的计算机之间来回发送消息。它们也不能太大。如果您使用正确的库，则设置起来非常容易。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-22T13:35:44.197

Apple 使用 Jabber/XMPP 的订阅服务来实现[mobileme](http://me.com)的推送服务来发送推送通知。这是我所知道的用于非 IM 用途的最广泛使用的 Jabber。[这篇文章](http://samj.net/2008/07/apple-iphone-20-real-story-behind-push.html)有更多细节。

我的朋友们还构建了一个 Jabber python 机器人，它有点可爱但不是*很有*用:-)

**编辑**

最新的 Next Big Thing，[Google Wave](http://wave.google.com/)，在底层使用了 Jabber。进一步说明了协议的力量。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-22T13:37:55.097

向网页发送消息。概念验证：[esagila.com](http://www.esagila.com/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-01T10:47:24.847

基于 XMPP 的即时消息可以作为搜索引擎的一个很好的替代方案，用于搜索小型、自身完整且经常重复需要的信息。例如，你的每日星座运势——你每天都需要它，而且它并不大。

要查看此示例，请将 astro@askme.im 添加到您的 jabber 客户端（Gmail Chat/Gtalk/或任何其他 Jabber 客户端）中的联系人列表中，然后通过发送“帮助”一词来启动与该联系人的聊天。

另请参阅[www.askme.im](http://www.askme.im/)，了解基于聊天的解决方案的完整列表。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-07T14:35:04.733

我过去使用 Jabber 来获取电子邮件通知。现在我将它用于低优先级的[nagios 通知](http://www.gridpp.ac.uk/wiki/Nagios_jabber_notification)，它非常有用并且比 SMS 便宜得多：

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-20T02:09:38.283

爱荷华州立大学农学系用 Jabber 创建了这个：http: [//mesonet.agron.iastate.edu/iembot/](http://mesonet.agron.iastate.edu/iembot/)

如果你像我一样是个天气怪胎，这是**非常**酷的东西！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-09-28T19:28:40.803

我一直认为 XMPP 是传递 SNMP 数据的好方法。OID 真的很痛苦，系统的大部分内容都不安全，而且 SNMP 陷阱永远不会像您希望的那样工作。中间有一个 XMPP 服务器和一个智能组件来做出一些选择，您可以使用它来发送 jabber 或其他通知、启动重新启动作业、更新网页或其他任何您需要的东西。

在这种情况下，XML 数据非常小，您可以让一个 XMPP 服务器同时与消息节中的人类或具有相同协议的计算机对话。

# java - 切换菜单项的状态

> ID：114764
> 
> 赞同：3
> 
> 时间：2008-09-22T13:10:21.933
> 
> 标签：java, eclipse

我有一个正在开发的 Eclipse RCP 应用程序。它有一些特定于视图的菜单，其中一个菜单项是我想在启用相应功能时在旁边显示一个勾号的项目。同样，下次选择该项目时，该项目应取消勾选以反映相应的功能已禁用。

我的问题是：如何设置这些菜单项的切换状态？我有一个 IHandler 来处理选择菜单项时的事件，但我不确定如何更新 GUI 元素本身。

StackOverflow 社区对我如何解决这个问题有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T13:43:15.410

该解决方案涉及让命令处理程序实现 IElementUpdater 接口。然后可以这样更新 UI 元素：

```
public void updateElement(UIElement element, Map parameters) 
{
    element.setChecked(isSelected);     
} 
```

updateElement 作为 UI 刷新的一部分被调用，可以从处理程序的执行命令中调用，如下所示：

```
 ICommandService service = (ICommandService) HandlerUtil
       .getActiveWorkbenchWindowChecked(event).getService(
           ICommandService.class);
   service.refreshElements(event.getCommand().getId(), null); 
```

[此处](http://wiki.eclipse.org/Menu_Item_Placement_Examples#Updating_the_menu_and_toolbar_appearance)有更多信息（请参阅*单选按钮命令*和*更新检查状态*条目）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T05:51:08.173

也许事情发生了变化，也许 RCP 和 Eclipse 插件之间存在差异，但我只是将我的动作样式设置为`toggle`，它会自动处理切换。[您可以在github.com](https://github.com/donkirkby/live-py-plugin/blob/fdbe1131e18c1ff119ad09a23406b9b24da5d9aa/plugin/plugin.xml#L28)上查看源代码。

```
 <action
           class="live_py.EnableAction"
           id="live-py.enable.action"
           label="Li&amp;ve Coding"
           menubarPath="pyGeneralMenu/pyNavigateGroup"
           state="false"
           style="toggle"> 
```

要查看当前是否启用了该功能，我只需通过其 id 查找操作，然后调用`isChecked()`.

# c# - 添加自定义标题

> ID：114772
> 
> 赞同：4
> 
> 时间：2008-09-22T13:12:16.407
> 
> 标签：c#, asp.net, http, header

我需要创建自定义标头并将其添加到 ASP.NET 2.0 应用程序。该案例是在我们的开发/测试环境中模拟 SSO 登录。

当我尝试添加标题时，我遇到了“此平台不支持”。错误。BigJim 在这里有一篇关于这个主题的好帖子：http: [//bigjimindc.blogspot.com/2007/07/ms-kb928365-aspnet-requestheadersadd.html](http://bigjimindc.blogspot.com/2007/07/ms-kb928365-aspnet-requestheadersadd.html)

我的问题的根源在于我需要模拟各种人登录到我的应用程序。不仅仅是在 HttpModule 中添加静态数据。我需要从几个 TextBox 中获取值并将这些信息传输到自定义标题中，然后重定向用户。HttpModule 的东西发生在管道的早期......

如果存在可以在开发环境中使用的简单重定向/代理解决方案，现在有人吗？或者有简单/漂亮的方式在代码中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T13:40:10.177

[我以前使用过的一种方法是NUnitASP](http://nunitasp.sourceforge.net/)，虽然是一种冗长的方法。

这基于 NUnit 框架，但用于 ASP.NET UI 测试。

它基本上在内存中启动浏览器，并且能够像用户一样操作内容。使用它，您可以查看您的页面，将数据输入文本框并提交页面。

希望这可以帮助您进行所需的测试。我用它来测试负载，并通过我的站点蜘蛛来收集数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T13:13:56.547

如果您使用 IIS 7，您可以将管道模式设置为**集成**

此设置可在 App-Pool 属性中找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T13:47:29.787

我可能是错的，但`Response.AddHeader()`方法仍然有效吗？

虽然，我同意[Oscar](https://stackoverflow.com/questions/114772/adding-custom-headers#114913)的观点，即像[NUnitASP](http://nunitasp.sourceforge.net/)这样的正式测试解决方案是个好主意。虽然，NUnitASP 有点过时了。我仍然将它用于我的一些项目，只是因为它仍然有效；它只是不像[WaTiN](http://watin.sourceforge.net/)或类似项目那样精致或简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T14:03:46.190

如果您执行 Response.AddHeader()，浏览器会丢弃标头...必须将标头添加到原始请求中...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T14:06:26.120

为什么不使用 ASP.NET 表单身份验证模型？

你定义你的“私人文件夹”。如果您尝试在没有登录的情况下访问私人文件夹，您将自动被重定向到您的自定义登录页面。

这是几个链接：http: [//support.microsoft.com/kb/301240](http://support.microsoft.com/kb/301240)

[http://www.asp.net/learn/security/tutorial-02-cs.aspx](http://www.asp.net/learn/security/tutorial-02-cs.aspx)

# asp.net - 使用 WCAT 对 ASP.NET/IIS 进行压力测试

> ID：114787
> 
> 赞同：9
> 
> 时间：2008-09-22T13:15:02.780
> 
> 标签：asp.net, iis, stress-testing, wcat

我正在尝试使用 IIS 资源中包含的 WCAT 工具包设置压力/负载测试。

使用 LogParser，我处理了一个带有配置的 UBR 文件。它看起来像这样：

```
 [Configuration]
NumClientMachines:  1        # number of distinct client machines to use
NumClientThreads:     100     # number of threads per machine
AsynchronousWait:     TRUE     # asynchronous wait for think and delay
Duration:             5m      # length of experiment (m = minutes, s = seconds)
MaxRecvBuffer:        8192K      # suggested maximum received buffer
ThinkTime:            0s       # maximum think-time before next request
WarmupTime:           5s      # time to warm up before taking statistics
CooldownTime:         6s      # time to cool down at the end of the experiment 

[Performance]

[Script]
SET RequestHeader = "Accept: */*\r\n"
APP RequestHeader = "Accept-Language: en-us\r\n"
APP RequestHeader = "User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705)\r\n"
APP RequestHeader = "Host: %HOST%\r\n"

NEW TRANSACTION
    classId = 1
    NEW REQUEST HTTP
    ResponseStatusCode = 200
    Weight = 45117
    verb = "GET"
    URL = "http://Url1.com" 

NEW TRANSACTION
    classId = 3
    NEW REQUEST HTTP
    ResponseStatusCode = 200
    Weight = 13662
    verb = "GET"
    URL = "http://Url1.com/test.aspx" 
```

它看起来好吗？

我用这个命令执行控制器：`wcctl -z StressTest.ubr -a localhost`

客户端执行如下：`wcclient localhost`

执行客户端时，我收到此错误：`main client thread Connect Attempt 0 Failed. Error = 10061`

这个世界上有人用过WCAT吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T18:22:04.967

I'd look at updating to WCat 6.3 - available [here for x86](http://www.iis.net/downloads/default.aspx?tabid=34&i=1466&g=6) and [here for x64](http://www.iis.net/downloads/default.aspx?tabid=34&i=1467&g=6)

They've changed the settings/scenario file strucutures, which is a little painful, but should suit your needs.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-26T11:14:34.200

我刚刚开始评估 wcat 6.3，恐怕我的经验在在线支持/社区方面有点令人失望。

wcat.wsf 脚本中还有一个主要错误 - 请参阅：

[http://forums.iis.net/t/1153312.aspx](http://forums.iis.net/t/1153312.aspx)

我现在正在努力让性能计数器测量工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T22:07:42.253

尽管我在模拟 NTLM 连接方面遇到了困难，但我在 WCAT 方面取得了很好的成功。

我使用的是 6.3，所以我的配置文件看起来和你的很不一样。我在此过程中注意到的一些问题：
+ 确保您已关闭防火墙，或者为 WMI 打了洞。
+ 您在请求标头中设置的每一件事都会对吞吐量产生巨大影响。苹果到苹果必须具有相同的请求标头。
+ 只有在纠正了 shorogood 确定的错误后，才能与多个客户端进行远程调用。

一旦我跨越了这些障碍，我就从 WCAT 获得了很好的成绩。它可以快速、可重复和积极地进行测试。

祝你好运，

凯文

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T13:27:59.317

我没有给你答案，但你是否考虑过使用其他工具进行测试？WCAT 工具似乎非常有限且使用起来很复杂。

OpenSTA 和 JMeter 是用于负载/压力/性能测试的优秀开源工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T13:33:43.250

OpenSTA 和 JMeter 看起来很像 Apache。我在 Windows Server 2003 上运行 IIS。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T14:16:34.927

您看过[Microsoft Web 应用程序压力工具](http://www.microsoft.com/downloads/details.aspx?FamilyID=e2c0585a-062a-439e-a67d-75a89aa36495&DisplayLang=en)吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-09T04:56:58.177

对于性能计数器，您可以在控制器运行的同一命令中定义 -p .prf：wcctl -c config.txt -d distribution.txt -s script.txt -a localhost -p performance.prf

# c - 从混杂的网络设备中读取

> ID：114804
> 
> 赞同：10
> 
> 时间：2008-09-22T13:18:16.563
> 
> 标签：c, linux, sockets, wireless, promiscuous-mode

我想写一个无线流量的实时分析工具。

有谁知道如何从 C 中的混杂（或嗅探）设备中读取数据？

我知道您需要具有 root 访问权限才能执行此操作。我想知道是否有人知道执行此操作需要哪些功能。普通套接字在这里似乎没有意义。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-22T14:31:56.980

在 Linux 上，您使用 PF_PACKET 套接字从原始设备读取数据，例如在混杂模式下运行的以太网接口：

```
s = socket(PF_PACKET, SOCK_RAW, htons(ETH_P_ALL)) 
```

这会将收到的每个数据包的副本发送到您的套接字。不过，您很可能并不真正想要每个数据包。[内核可以使用 BPF（伯克利包过滤器](http://en.wikipedia.org/wiki/Berkeley_Packet_Filter)）执行第一级过滤。BPF 本质上是一个基于堆栈的虚拟机：它处理一小组指令，例如：

```
ldh = load halfword (from packet)  
jeq = jump if equal  
ret = return with exit code 
```

BPF 的退出代码告诉内核是否将数据包复制到套接字。可以使用 setsockopt(s, SOL_SOCKET, SO_ATTACH_FILTER, ) 直接编写相对较小的 BPF 程序。（警告：内核采用 struct sock_fprog，而不是 struct bpf_program，不要混淆它们，否则您的程序将无法在某些平台上运行）。

对于任何相当复杂的东西，你真的想使用 libpcap。BPF 的功能受到限制，特别是每个数据包可以执行的指令数量。[libpcap](http://www.tcpdump.org/pcap.htm)将负责将复杂的过滤器分成两部分，内核执行第一级过滤，而功能更强大的用户空间代码会丢弃它实际上不想看到的数据包。

libpcap 还从您的应用程序代码中抽象出内核接口。Linux 和 BSD 使用类似的 API，但 Solaris 需要 DLPI，而 Windows 使用其他东西。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-23T10:47:37.623

我曾经不得不收听原始以太网帧并最终为此创建了一个包装器。通过使用设备名称调用函数，例如，`eth0`我得到了一个处于混杂模式的套接字。您需要做的是创建一个原始套接字，然后将其置于混杂模式。这是我的做法。

```
int raw_init (const char *device)
{
    struct ifreq ifr;
    int raw_socket;

    memset (&ifr, 0, sizeof (struct ifreq));

    /* Open A Raw Socket */
    if ((raw_socket = socket (PF_PACKET, SOCK_RAW, htons (ETH_P_ALL))) < 1)
    {
        printf ("ERROR: Could not open socket, Got #?\n");
        exit (1);
    }

    /* Set the device to use */
    strcpy (ifr.ifr_name, device);

    /* Get the current flags that the device might have */
    if (ioctl (raw_socket, SIOCGIFFLAGS, &ifr) == -1)
    {
        perror ("Error: Could not retrive the flags from the device.\n");
        exit (1);
    }

    /* Set the old flags plus the IFF_PROMISC flag */
    ifr.ifr_flags |= IFF_PROMISC;
    if (ioctl (raw_socket, SIOCSIFFLAGS, &ifr) == -1)
    {
        perror ("Error: Could not set flag IFF_PROMISC");
        exit (1);
    }
    printf ("Entering promiscuous mode\n");

    /* Configure the device */

    if (ioctl (raw_socket, SIOCGIFINDEX, &ifr) < 0)
    {
        perror ("Error: Error getting the device index.\n");
        exit (1);
    }

    return raw_socket;
} 
```

然后，当您拥有套接字时，您可以使用 select 在数据包到达时对其进行处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-22T13:55:46.910

您可以使用tcpdump 和 Wireshark 也使用的 pcap 库（参见[http://www.tcpdump.org/pcap.htm ）。](http://www.tcpdump.org/pcap.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T13:21:10.783

你为什么不使用像[WireShark](http://www.wireshark.org/)这样的东西？

它是开源的，所以如果你不想仅仅使用它，至少你可以从中学到一些东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-22T20:06:22.877

Linux 上的 WireShark 具有捕获 PLCP（物理层汇聚协议）头信息的能力。

# javascript - 我应该学习/精通 Javascript 吗？

> ID：114807
> 
> 赞同：13
> 
> 时间：2008-09-22T13:18:52.177
> 
> 标签：javascript

我是一个使用 ASP.NET、C# 等的 .NET webdev ......我 5 年前在大学里“学习”了 javascript，并且可以用它做基本的工作。但是我想知道精通它是否有用。

我为什么要学习 Javascript？[比学习 JQuery 或其他库](https://stackoverflow.com/questions/913/what-javascript-library-would-you-choose-for-a-new-project-and-why)更有利吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-09-22T13:20:32.347

是的，在学习其中一个库之前一定要学习 Javascript。这是整个先走后你才能跑的事情。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-22T14:17:11.197

确保将这些网站添加到您的书签中：

[Mozilla 的开发者站点](http://developer.mozilla.org/En)：这包含对 Mozilla 中的 Javascript API 的引用。这将帮助您确保您正在编写 Firefox 可以理解的代码。

[IE 在 Microsoft Developer Network 中的站点](http://msdn.microsoft.com/en-us/ie/default.aspx)：对于 IE，相同。

[W3 对 HTML 的 DOM 引用](http://www.w3.org/TR/DOM-Level-2-HTML/html.html)：在当今的大多数 Web 应用程序中，Javascript 代码操作 DOM，这是对屏幕上显示的对象的内部跟踪（但您已经知道了，对吗？）这是对 DOM API 的引用. 它是语言中立的，这意味着它不针对 Javascript，但这些方法也存在于 Javascript 中。

[Douglas Crockford 的网站](http://javascript.crockford.com/)：Doug Crockford 是 Javascript 的佼佼者。他页面上的文章是必读的。因为 Javascript 有闭包和一流的函数，他认为它比其他语言更接近 Lisp 和 Scheme。他还教你如何使用这些语言特性极大地改进你的代码。

[雅虎开发者网络](http://developer.yahoo.com/)：您可能还想检查一下。不过，我不是这个网站的常客，所以我不能说太多。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-22T13:21:50.267

是的，如果您正在做 Web 开发，那么您绝对应该学习 JavaScript。我强烈推荐Doug Crockford[的 JavaScript: The Good Parts](https://rads.stackoverflow.com/amzn/click/com/0596517742)。而且，JQuery 是一个很好的使用框架（这个网站使用它）——它有点取决于你想要做什么——YUI 和 ExtJS 也非常好。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-10-09T13:17:10.590

[答案很简单。](http://shouldilearnjavascript.com)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-22T13:55:08.783

放下手是的。[谷歌对 Chrome 的 V8 JS 引擎](http://searchsoa.techtarget.com/news/article/0,289142,sid26_gci1328625,00.html)如此大惊小怪是有原因的，为什么 Mozilla 正在为 Firefox 开发[TraceMonkey](http://arstechnica.com/news.ars/post/20080822-firefox-to-get-massive-javascript-performance-boost.html)以及为什么 Webkit 已经在[Squirrelfish](http://webkit.org/blog/214/introducing-squirrelfish-extreme/)上工作了一段时间（现在是 Squirrelfishextreme）。这是因为 JS 变得越来越流行。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-22T13:24:05.957

Javascript 是那些花几个小时学习的语言之一，它可能会教给你 99% 的你将真正使用的东西。我想你在学习 javascript 的时候已经了解得足够多，现在只学习一个或多个框架。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-22T13:28:06.617

我建议先复习一下你的非框架 javascript。刷新/学习 dom 操作的基本概念等等。就像在学习如何使用 STL（标准模板库）之前学习如何在 C++ 中构建链表、堆栈或队列一样。

除了复习直接的 javascript 之外，最好进入一个不会抽象和改变工作方式的框架，例如 Prototype。您使用它进行编码的方式与使用直接 javascript 编码的方式非常相似。通读 Prototype 代码，学习如何制作类，并做一些花哨的事情。根据经验，我可以说阅读 Prototype.js 帮助我学到了很多东西。

在搞砸了一点之后，我会说去 jQuery。如果 jQuery 没有从字面上改变你编写代码的方式，我会说先去做，但是学习如何构建类和 js 继承以及其他对于想要精通 JS 的人来说可能是非常重要的一课.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-22T14:20:32.670

建议任何 Web 应用程序开发人员学习 javascript。为什么？

*   您将更好地了解与开发 Web 应用程序相关的**可能性、限制和危险**
*   如果您正在开发具有**用户界面**的 Web 应用程序，那么这对您的职业生涯有很大帮助。

然而，学习 javascript 通常是一种编程语言和另一种编程语言之间的**权衡。**您应该考虑 javascript 是否与您的职业或项目相关。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-22T13:20:56.853

除非您想真正进入 javascript，否则我认为您最好学习足够的 JS 以利用其中一个久经考验的 javascript 库。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-22T13:24:04.647

JavaScript 的优点之一是它与 C#、VB.NET 或 Java 等主流语言完全不同。学习它，特别是如果你有机会使用它，会让你对编程有另一种见解，这总是好的。我觉得值得学习。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-22T13:30:50.137

如果你正在做 Web 开发，那么在你职业生涯的某个时刻，由于多种原因中的任何一个，你都会接触到 Javascript 或[ECMAScript 。](http://en.wikipedia.org/wiki/ECMAScript)至少你应该知道足够多的 Javascript 能够验证用户输入；但是，Web 正在朝着使用更多 Ajax 的方向发展，因此您还应该了解足够的 Javascript 以正确利用其中一个主要库，例如[jQuery](http://jquery.com/)。

正如其他一些用户所指出的那样，您可以在一天或几个下午内了解您每天需要的 Javascript 的大部分内容。如果你想更高级地使用 Javascript，那么你将不得不投入更多的时间来学习这门语言，但很可能除非你寻找这种类型的工作，否则你不会遇到预先存在的库没有的东西' t 已经存在。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-23T12:00:44.043

如果你只想做一些简单的 UI 效果之类的，我建议你选择一个库并去做！

使用库可以消除 JavaScript 的所有有缺陷的实现，并为您提供在所有浏览器中都相同的 API。如果您与其他人一起工作，这也是实施代码标准和最佳实践的好方法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-22T13:22:12.980

学习第二种编程语言总是好的。听上去，JavaScript 是一种你可以使用的语言，它也会有实际用途。作为一名网络开发人员，我在一篇评论中建议我至少学习基本的 JavaScript。

如今，像 jQuery 这样的库对于 Web 开发来说是必不可少的，所以你也可以学习它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-22T13:23:06.257

我认为大量刻意学习没有意义（但当然你需要一些基础知识），但我也认为经过几年的网络开发，你无论如何都会变得相当精通这门语言:)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-22T13:25:44.067

如果您是 Web 开发人员，那么是的，您应该精通 Javascript。Javascript 是使 Web 应用程序与桌面应用程序一样具有交互性的主要部分。

话虽如此，学习使用跨浏览器兼容库之一，如 JQuery、Prototype 等。我们不需要再使用 Javascript 创建任何单个浏览器 crud，因为任何真正的男人/女人都会自己滚动。

在 Javascript 中需要学习的一些东西： 1\. 基本语法 2\. 各种风格的函数声明。3\. 传递函数以及如何使用传入函数。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-22T13:26:56.653

我推荐 Jeremy Keith 的书：[DOM Scripting](https://rads.stackoverflow.com/amzn/click/com/1590595335)和[Bulletproof Ajax](http://bulletproofajax.com/)。在你熟练掌握 JS 之后，我会推荐一个 JS 库（我使用 jQuery，但这并不重要）。

学习JS很重要。如果没有正确理解框架的工作原理，就无法使用框架。那就是倒着做事。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-22T13:44:46.343

我觉得你应该有一个很好的语言规范和 DOM（文档对象模型）的知识基础。这意味着，您应该知道如何查找/创建“页面对象”和编辑属性。此外，您应该对“面向对象”的 javascript 技术有一个概念，这是很多框架的起点。如果你不使用它，你不需要学习特定的框架。简单记住通用基本概念！

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-10-09T13:20:19.477

我会选择大多数人提出的相反答案。如今，作为开发人员学习 javascript 几乎毫无意义。该语言与 java/C# 非常相似，因此您不应该忘记它的语法和语义。

你应该学习的是jQuery。

当您使用 jQuery 时，无论如何您都会从 javascript 中获得最常见的东西。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-10-09T13:25:18.830

如果您无论如何都参与了 Web，那么答案是“是的，总是”。也许嵌入式或系统的程序员可以在没有 JavaScript 的情况下过日子，但不是 webdev。

大多数库旨在减轻与众多浏览器交互的一些痛苦。它们不会抽象出核心的 JavaScript 功能。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-10-09T13:28:45.190

是的，你应该学习 JavaScript。迟早你将需要使用它！

# bash - 计算 bash 中的（非空白）代码行数

> ID：114814
> 
> 赞同：166
> 
> 时间：2008-09-22T13:20:42.283
> 
> 标签：bash, unix, count, lines, nonblank

在 Bash 中，我如何计算项目中非空白代码行的数量？

* * *

## 回答 #1

> 赞同：208
> 
> 时间：2008-09-22T13:23:10.327

```
cat foo.c | sed '/^\s*$/d' | wc -l 
```

如果您考虑评论空行：

```
cat foo.pl | sed '/^\s*#/d;/^\s*$/d' | wc -l 
```

虽然，这取决于语言。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-09-22T13:28:48.550

```
#!/bin/bash
find . -path './pma' -prune -o -path './blog' -prune -o -path './punbb' -prune -o -path './js/3rdparty' -prune -o -print | egrep '\.php|\.as|\.sql|\.css|\.js' | grep -v '\.svn' | xargs cat | sed '/^\s*$/d' | wc -l 
```

以上将为您提供项目（当前文件夹和所有子文件夹递归）的代码行总数（删除空白行）。

在上面的 "./blog" "./punbb" "./js/3rdparty" 和 "./pma" 是我列入黑名单的文件夹，因为我没有在其中编写代码。.php、.as、.sql、.css、.js 也是正在查看的文件的扩展名。任何具有不同扩展名的文件都将被忽略。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2008-09-22T13:25:43.910

如果你想使用 shell 脚本以外的东西，试试[CLOC](http://cloc.sourceforge.net/)：

> cloc 计算许多编程语言中源代码的空白行、注释行和物理行。它完全用 Perl 编写，不依赖于 Perl v5.6 及更高版本的标准分发（来自一些外部模块的代码嵌入在 cloc 中），因此非常可移植。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2008-09-22T13:27:42.017

有很多方法可以做到这一点，使用常见的 shell 实用程序。

我的解决方案是：

```
grep -cve '^\s*$' <file> 
```

这会在 <file> 中搜索与模式 (-e) '^\s*$' 匹配的不匹配 (-v) 行，它是行的开头，后跟 0 个或多个空格字符，然后在一行的末尾（即除空格外没有其他内容），并显示匹配行的计数（-c）而不是匹配行本身。

与涉及到管道的方法相比，此方法的一个优点`wc`是您可以指定多个文件并为每个文件获取单独的计数：

```
$ grep -cve '^\s*$' *.hh

config.hh:36
exceptions.hh:48
layer.hh:52
main.hh:39 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2014-06-04T09:51:04.147

此命令计算非空行的数量。
`cat fileName | grep -v ^$ | wc -l`
grep -v ^$ 正则表达式功能是忽略空行。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-09-22T13:24:30.107

'wc' 计算行数、单词数、字符数，因此要计算所有行（包括空白行），请使用：

```
wc *.py 
```

要过滤掉空行，可以使用 grep：

```
grep -v '^\s*$' *.py | wc 
```

'-v' 告诉 grep 输出除匹配的行以外的所有行 '^' 是行首 '\s*' 是零个或多个空白字符 '$' 是行尾您希望计算的所有文件（当前目录中的所有 python 文件）管道输出到 wc。就行了。

我正在回答我自己的（真正的）问题。找不到涵盖此内容的 stackoverflow 条目。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2019-10-28T15:01:18.123

```
cat file.txt | awk 'NF' | wc -l 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-22T13:28:15.917

```
cat 'filename' | grep '[^ ]' | wc -l 
```

应该做得很好

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-02-14T08:08:36.177

```
grep -cvE '(^\s*[/*])|(^\s*$)' foo

-c = count
-v = exclude
-E = extended regex
'(comment lines) OR (empty lines)'
where
^    = beginning of the line
\s   = whitespace
*    = any number of previous characters or none
[/*] = either / or *
|    = OR
$    = end of the line 
```

我发布这个是因为其他选项给了我错误的答案。这适用于我的 java 源代码，其中注释行以 / 或 * 开头（我在多行注释的每一行都使用 *）。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-09-22T13:23:10.280

```
awk '/^[[:space:]]*$/ {++x} END {print x}' "$testfile" 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-04-01T00:01:52.237

这是一个计算项目中代码行数的 Bash 脚本。它递归地遍历源代码树，并排除使用“//”的空行和单行注释。

```
# $excluded is a regex for paths to exclude from line counting
excluded="spec\|node_modules\|README\|lib\|docs\|csv\|XLS\|json\|png"

countLines(){
  # $total is the total lines of code counted
  total=0
  # -mindepth exclues the current directory (".")
  for file in `find . -mindepth 1 -name "*.*" |grep -v "$excluded"`; do
    # First sed: only count lines of code that are not commented with //
    # Second sed: don't count blank lines
    # $numLines is the lines of code
    numLines=`cat $file | sed '/\/\//d' | sed '/^\s*$/d' | wc -l`

    # To exclude only blank lines and count comment lines, uncomment this:
    #numLines=`cat $file | sed '/^\s*$/d' | wc -l`

    total=$(($total + $numLines))
    echo "  " $numLines $file
  done
  echo "  " $total in total
}

echo Source code files:
countLines
echo Unit tests:
cd spec
countLines 
```

这是[我的项目](https://github.com/curran/phd/tree/f1ab3319a27c2bd3283df3402e568ce69be670de/prototype)的输出：

```
Source code files:
   2 ./buildDocs.sh
   24 ./countLines.sh
   15 ./css/dashboard.css
   53 ./data/un_population/provenance/preprocess.js
   19 ./index.html
   5 ./server/server.js
   2 ./server/startServer.sh
   24 ./SpecRunner.html
   34 ./src/computeLayout.js
   60 ./src/configDiff.js
   18 ./src/dashboardMirror.js
   37 ./src/dashboardScaffold.js
   14 ./src/data.js
   68 ./src/dummyVis.js
   27 ./src/layout.js
   28 ./src/links.js
   5 ./src/main.js
   52 ./src/processActions.js
   86 ./src/timeline.js
   73 ./src/udc.js
   18 ./src/wire.js
   664 in total
Unit tests:
   230 ./ComputeLayoutSpec.js
   134 ./ConfigDiffSpec.js
   134 ./ProcessActionsSpec.js
   84 ./UDCSpec.js
   149 ./WireSpec.js
   731 in total 
```

享受！——[柯伦](https://github.com/curran/portfolio)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-10-01T00:59:15.487

最简洁的命令是

```
grep -vc ^$ fileName 
```

有`-c`选项，你甚至不需要`wc -l`

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-22T13:28:34.887

这有点取决于您在项目中拥有的文件数量。理论上你可以使用

```
grep -c '.' <list of files> 
```

您可以在其中使用 find 实用程序填写文件列表。

```
grep -c '.' `find -type f` 
```

会给你每个文件的行数。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-08-14T01:07:44.693

递归计算当前目录中具有特定文件扩展名的所有非空行的脚本：

```
#!/usr/bin/env bash
(
echo 0;
for ext in "$@"; do
    for i in $(find . -name "*$ext"); do
        sed '/^\s*$/d' $i | wc -l ## skip blank lines
        #cat $i | wc -l; ## count all lines
        echo +;
    done
done
echo p q;
) | dc; 
```

示例用法：

```
./countlines.sh .py .java .html 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-12-02T06:56:06.897

如果您想要整个项目中给定文件扩展名的所有文件的所有非空行的总和：

```
while read line
do grep -cve '^\s*$' "$line"
done <  <(find $1 -name "*.$2" -print) | awk '{s+=$1} END {print s}' 
```

第一个 arg 是项目的基本目录，第二个是文件扩展名。示例用法：

```
./scriptname ~/Dropbox/project/src java 
```

它只不过是以前解决方案的集合。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-01-03T16:44:59.700

```
grep -v '^\W*$' `find -type f` | grep -c '.' > /path/to/lineCountFile.txt 
```

给出当前目录及其子目录中所有文件的总计数.

！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-02-23T11:56:02.770

这给出了行数而不计算空行：

```
grep -v ^$ filename wc -l | sed -e 's/ //g' 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-12-08T12:43:51.623

```
rgrep . | wc -l 
```

给出当前工作目录中非空行的计数。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2022-01-14T02:28:15.737

试试这个：

```
> grep -cve ^$ -cve '^//' *.java 
```

它很容易记住，它还排除了空白行和注释行。

* * *

## 回答 #20

> 赞同：-3
> 
> 时间：2012-05-05T02:02:45.507

在 linux 上已经有一个名为“wc”的程序。

只是

```
wc -l *.c 
```

它为您提供总行数和每个文件的行数。

# php - 在两个 PHP 脚本之间发送数据

> ID：114816
> 
> 赞同：4
> 
> 时间：2008-09-22T13:20:52.203
> 
> 标签：php, xml

我想让`PHP script`一个`XML`格式化的字符串发送到另一个`PHP script`驻留在城镇不同地区的不同服务器上的字符串。

有什么好的，干净的方法吗？

`(PHP5 and all the latest software available)`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-22T13:22:09.410

查看[cURL](http://au2.php.net/curl)以在页面之间发布数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-22T13:25:13.333

如果是我，我只会将 xml 数据发布到另一个脚本。您可以使用 PHP 的套接字，或使用 CURL。我认为这是最干净的解决方案，尽管如果您不介意 SOAP 请求的开销以及使用库，那么 SOAP 也是可行的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-22T14:27:36.523

我强烈建议使用您自己的 RESTful API 并完全避免 SOAP 的复杂性。您只需要 curl 扩展来处理 HTTP 请求/响应，以及 simple_xml 来构建/处理 XML。如果您的数据格式合理，您应该很容易将其推送到 XML 字符串中并将其作为 POST 提交给其他服务器。该服务器将通过将 POST var 中的 XML 字符串读回对象来响应请求，瞧！你不应该花一整天的时间来解决这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T13:23:24.587

[XML-RPC](http://phpxmlrpc.sourceforge.net/)或[SOAP](http://www.php.net/soap)或只是一个[RESTful API](http://developer.yahoo.com/php/howto-reqRestPhp.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T08:53:01.153

您可以使用[cURL](http://php.net/curl)（复杂 API）、[http](http://php.net/http)扩展（更简洁），或者如果您需要做更复杂的事情，您甚至可以使用simpletest[中的](http://www.lastcraft.com/simple_test.php)[Scriptable Browser](http://www.lastcraft.com/browser_documentation.php)。

# c++ - 获取向量 进入一个需要向量的函数

> ID：114819
> 
> 赞同：28
> 
> 时间：2008-09-22T13:21:02.547
> 
> 标签：c++, stl, vector, covariance

考虑这些类。

```
class Base
{
   ...
};

class Derived : public Base
{
   ...
}; 
```

这个函数

```
void BaseFoo( std::vector<Base*>vec )
{
    ...
} 
```

最后是我的矢量图

```
std::vector<Derived*>derived; 
```

我想传递`derived`给 function `BaseFoo`，但编译器不让我。我如何解决这个问题，而不将整个向量复制到 a `std::vector<Base*>`？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-09-22T13:31:38.607

`vector<Base*>`并且`vector<Derived*>`是不相关的类型，所以你不能这样做。[这在此处](http://www.parashift.com/c++-faq-lite/proper-inheritance.html#faq-21.3)的 C++ 常见问题解答中进行了解释。

您需要将变量从 a 更改`vector<Derived*>`为 a`vector<Base*>`并将`Derived`对象插入其中。

此外，为避免`vector`不必要地复制，您应该通过 const-reference 传递它，而不是按值传递：

```
void BaseFoo( const std::vector<Base*>& vec )
{
    ...
} 
```

最后，为了避免内存泄漏，并使您的代码异常安全，请考虑使用旨在处理堆分配对象的容器，例如：

```
#include <boost/ptr_container/ptr_vector.hpp>
boost::ptr_vector<Base> vec; 
```

或者，将向量更改为保存智能指针而不是使用原始指针：

```
#include <memory>
std::vector< std::shared_ptr<Base*> > vec; 
```

或者

```
#include <boost/shared_ptr.hpp>
std::vector< boost::shared_ptr<Base*> > vec; 
```

在每种情况下，您都需要`BaseFoo`相应地修改您的功能。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-09-22T14:10:54.767

与其传递容器对象 ( `vector<>`)，不如传入`begin`和`end`迭代器，就像其他 STL 算法一样。接收它们的函数将被模板化，并且传入 Derived* 或 Base* 都没有关系。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-09-22T17:06:28.793

此问题发生在具有可变容器的编程语言中。你不能把一袋可变的苹果当作一袋水果来传递，因为你不能确定其他人没有将柠檬放入那袋水果中，之后它就不再符合一袋苹果的条件。如果这袋苹果不是可变的，那么将它作为一袋水果传递就可以了。搜索协方差/逆变。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-22T13:23:07.923

一种选择是使用模板

```
template<typename T>
void BaseFoo( const std::vector<T*>& vec)
{
 ...
} 
```

缺点是实现必须在头文件中，你会得到一点代码膨胀。您最终会为每种类型实例化不同的函数，但代码保持不变。根据用例，这是一个快速而肮脏的解决方案。

编辑，我应该注意我们在这里需要一个模板的原因是因为我们正试图为不相关的类型编写与其他几位海报所指出的相同的代码。模板允许您解决这些确切的问题。我还更新了它以使用 const 引用。当您不需要副本时，您还应该通过 const 引用传递“重”对象，例如向量，这基本上总是如此。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-22T13:27:17.430

通常你会从一个基指针容器开始，而不是相反。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-22T13:39:43.813

如果您与第三方库打交道，这是您唯一的希望，那么您可以这样做：

```
BaseFoo (*reinterpret_cast<std::vector<Base *> *>(&derived)); 
```

否则，请使用其他建议之一修复您的代码。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-22T15:06:48.283

从上面获取[Matt Price 的](https://stackoverflow.com/questions/114819/how-get-a-vectorderived-into-a-function-that-expects-a-vectorbase-as-argument#114833)答案，假设您事先知道要在函数中使用哪些类型，您可以在头文件中声明函数模板，然后为这些类型添加显式实例化：

```
// BaseFoo.h
template<typename T>
void BaseFoo( const std::vector<T*>& vec);

// BaseFoo.cpp
template<typename T>
void BaseFoo( const std::vector<T*>& vec);
{
 ...
}

// Explicit instantiation means no need for definition in the header file.
template void BaseFoo<Base> ( const std::vector<Base*>& vec );
template void BaseFoo<Derived> ( const std::vector<Derived*>& vec ); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-22T15:00:02.810

如果`std::vector`支持您的要求，则可以在不使用任何强制转换的情况下击败 C++ 类型系统（编辑：ChrisN 到 C++ FAQ Lite 的链接讨论了相同的问题）：

```
class Base {};
class Derived1 : public Base {};
class Derived2 : public Base {};

void pushStuff(std::vector<Base*>& vec) {
    vec.push_back(new Derived2);
    vec.push_back(new Base);
}

...
std::vector<Derived1*> vec;
pushStuff(vec); // Not legal
// Now vec contains a Derived2 and a Base! 
```

由于您的`BaseFoo()`函数按值获取向量，因此它无法修改您传入的原始向量，所以我写的内容是不可能的。但是，如果它需要一个非常量引用并且您使用它`reinterpret_cast<std::vector<Base*>&>()`来传递您的`std::vector<Derived*>`，您可能无法获得您想要的结果，并且您的程序可能会崩溃。

Java 数组支持[协变子类型](http://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science))，这需要 Java[每次在数组中存储值时都进行运行时类型检查](http://www.pmg.csail.mit.edu/papers/popl97/node19.html)。这也是不可取的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-22T13:23:09.780

它们是不相关的类型——你不能。

# python - Python 字典是哈希表的一个例子吗？

> ID：114830
> 
> 赞同：235
> 
> 时间：2008-09-22T13:22:28.987
> 
> 标签：python, hash, dictionary, hashmap, hashtable

Python 中的基本数据结构之一是字典，它允许记录“键”以查找任何类型的“值”。这是在内部作为哈希表实现的吗？如果不是，那是什么？

* * *

## 回答 #1

> 赞同：293
> 
> 时间：2008-09-22T13:23:00.203

是的，它是一个哈希映射或哈希表。[您可以在此处](http://mail.python.org/pipermail/python-list/2000-March/048085.html "蒂姆·彼得斯")阅读 Tim Peters 所写的对 python 的 dict 实现的描述。

这就是为什么你不能使用“不可散列”的东西作为字典键的原因，比如列表：

```
>>> a = {}
>>> b = ['some', 'list']
>>> hash(b)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: list objects are unhashable
>>> a[b] = 'some'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: list objects are unhashable 
```

您可以[阅读有关哈希表的更多信息](http://en.wikipedia.org/wiki/Hash_table "维基百科上的哈希表")或[检查它是如何在 python 中实现的，](https://hg.python.org/cpython/file/10eea15880db/Objects/dictobject.c "Python 源代码中的字典对象")以及[它为什么以这种方式实现](https://hg.python.org/cpython/file/10eea15880db/Objects/dictnotes.txt "在 CPython 发行版中优化字典的注意事项")。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2015-11-01T04:01:49.343

Python 字典必须比 hash() 上的表查找更多。通过蛮力实验，我发现了这种**哈希冲突**：

```
>>> hash(1.1)
2040142438
>>> hash(4504.1)
2040142438 
```

然而它并没有破坏字典：

```
>>> d = { 1.1: 'a', 4504.1: 'b' }
>>> d[1.1]
'a'
>>> d[4504.1]
'b' 
```

完整性检查：

```
>>> for k,v in d.items(): print(hash(k))
2040142438
2040142438 
```

可能除了 hash() 之外还有另一个查找级别，可以避免字典键之间的冲突。或者也许 dict() 使用不同的哈希。

（顺便说一下，这在 Python 2.7.10 中。在 Python 3.4.3 和 3.5.0 中的情况相同，但在`hash(1.1) == hash(214748749.8)`.）

（我在 Python 3.9.6 中没有发现任何冲突。由于哈希值更大——`hash(1.1) == 230584300921369601`我估计我的桌面需要一千年才能找到一个。所以我会在这个问题上回复你。）

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-09-22T13:25:27.700

是的。在内部，它被实现为基于 Z/2 上的原始多项式的开放散列（[source](https://mail.python.org/pipermail/python-list/2000-February/036421.html)）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-22T15:09:43.677

扩展 nosklo 的解释：

```
a = {}
b = ['some', 'list']
a[b] = 'some' # this won't work
a[tuple(b)] = 'some' # this will, same as a['some', 'list'] 
```

# .net - .NET 中的分散/收集异步套接字 I/O

> ID：114847
> 
> 赞同：2
> 
> 时间：2008-09-22T13:25:25.813
> 
> 标签：.net, asynchronous, stream

我正在尝试使用 .NET 中的 Stream.BeginWrite Async I/O API 来处理具有许多短消息的高吞吐量情况。因此，分散/收集 API 将极大地减少上下文切换（和 CPU 使用）的数量。这个 API 是否完全使用 LPBUFFERS Win32 API？是否有用于 Scatter/Gather I/O 的替代 API？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-06-01T04:05:56.297

查看 .net 来源，接受的答案似乎是错误的。

`SocketAsyncEventArgs`有一个[`BufferList`](https://msdn.microsoft.com/en-us/library/system.net.sockets.socketasynceventargs.bufferlist%28v=vs.90%29.aspx)属性。当使用它时`Buffer`，操作可以使用分散/聚集 DMA，而不是只能保存单个连续内存块的属性，就像内部[`Socket.SendAsync(SocketAsyncEventArgs)`](http://referencesource.microsoft.com/#System/net/System/Net/Sockets/Socket.cs,102e8374338a49cb)使用的那样，[`WSASend`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms742203(v=vs.85).aspx)

> 允许指定多个发送缓冲区，使其适用于 scatter/gather 类型的 I/O

并[`Socket.SendAsync(SocketAsyncEventArgs)`](http://referencesource.microsoft.com/#System/net/System/Net/Sockets/Socket.cs,194ae41217fbaf74)使用[`WSARecv`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms741688%28v=vs.85%29.aspx)，即

> 允许指定多个接收缓冲区，使其适用于 scatter/gather 类型的 I/O

我手边没有 .net 3.5 源，但`BufferList`自 .net 3.5 起就存在，因此自 .net 3.5 起可能已支持分散/聚集。WSASend 和 WSARecv 的最低操作系统要求记录为 Windows Vista / Server 2003。

注意我不知道您使用的是什么流，但`NetworkStream.BeginWrite`将单个缓冲区发送到 WSASend，因此您不能将其用于分散/收集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T13:29:07.647

如果你能从 BCL 获得分散/收集 api，我会感到惊讶（它用于 l33t w1n32 haxx0rz，你知道吗？），但总是有 P/Invoke（我发现它非常容易使用）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T14:29:23.803

如果您想深入了解框架的内容，有几种方法可以做到：

1) 反射器

2）MS最近为调试目的打开了源代码，如果您启用了Debugging/Options/General下的选项，您可以使用VS2008进入它

3) Koders.com 似乎也在托管框架源代码：

[http://www.koders.com/csharp/fidCE09E83BE706D0BD370658C3785E82D3A13FC2CE.aspx?s=flush()#L109](http://www.koders.com/csharp/fidCE09E83BE706D0BD370658C3785E82D3A13FC2CE.aspx?s=flush()#L109)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-07-13T09:59:59.513

在 .NET 中无法进行套接字分散/收集 I/O。根据 MSFT 博客文章，.NET 4.5 中可能有类似的 API（不管是什么......）

# .net - 如何将 DataTable.Select() 的结果绑定到 ListBox 控件？

> ID：114851
> 
> 赞同：12
> 
> 时间：2008-09-22T13:25:51.630
> 
> 标签：.net, data-binding, listbox, datatable, datarow

我有以下代码：

```
ListBox.DataSource = DataSet.Tables("table_name").Select("some_criteria = match")
ListBox.DisplayMember = "name" 
```

该[`DataTable.Select()`方法](http://msdn.microsoft.com/en-us/library/system.data.datatable.select(VS.80).aspx)返回一个对象数组[`System.Data.DataRow`](http://msdn.microsoft.com/en-us/library/system.data.datarow(VS.80).aspx)。

无论我在`ListBox.DisplayMember`属性中指定什么，我所看到的只是列表框，其中项目的正确数量全部显示为，`System.Data.DataRow`而不是`"name"`列中我想要的值！

是否可以从 绑定到结果数组`DataTable.Select()`，而不是循环遍历它并将每个数组添加到`ListBox`？

（我对循环没有问题，但似乎不是一个优雅的结局！）

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-22T13:32:45.077

请改用[DataView](http://msdn.microsoft.com/en-us/library/hy5b8exc(VS.71).aspx)。

```
ListBox.DataSource = new DataView(DataSet.Tables("table_name"), "some_criteria = match", "name", DataViewRowState.CurrentRows);
ListBox.DisplayMember = "name" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T14:05:18.213

Josh 在 DataView 上做得很好。如果您需要一个非常大的锤子，您可以从任何 DataTable.Select("...") 中获取行数组并合并到不同的 DataSet 中。

```
 DataSet copy = new DataSet();
 copy.Merge(myDataTable.Select("Foo='Bar'"));
 // copy.Tables[0] has a clone 

```

That approach for what you're trying to do is most probably overkill but there are instances when you may need to get a datatable out of an array of rows where it's helpful.

# c# - 如何防止在级联运算符中创建中间对象？

> ID：114859
> 
> 赞同：2
> 
> 时间：2008-09-22T13:27:25.137
> 
> 标签：c#, .net, operators

我在我的应用程序中使用了一个自定义的 Matrix 类，并且我经常添加多个矩阵：

```
Matrix result = a + b + c + d; // a, b, c and d are also Matrices 
```

但是，这会为每个加法运算创建一个中间矩阵。由于这是简单的加法，因此可以避免中间对象并通过一次添加所有 4 个矩阵的元素来创建结果。我怎样才能做到这一点？

注意：我知道我可以定义多个函数，如`Add3Matrices(a, b, c)`,`Add4Matrices(a, b, c, d)`等，但我想保持`result = a + b + c + d`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-22T13:49:02.900

您可以通过使用惰性评估将自己限制在一个小型中间体。就像是

```
public class LazyMatrix
{
    public static implicit operator Matrix(LazyMatrix l)
    {
        Matrix m = new Matrix();
        foreach (Matrix x in l.Pending)
        {
            for (int i = 0; i < 2; ++i)
                for (int j = 0; j < 2; ++j)
                    m.Contents[i, j] += x.Contents[i, j];
        }

        return m;
    }

    public List<Matrix> Pending = new List<Matrix>();
}

public class Matrix
{
    public int[,] Contents = { { 0, 0 }, { 0, 0 } };

    public static LazyMatrix operator+(Matrix a, Matrix b)
    {
        LazyMatrix l = new LazyMatrix();
        l.Pending.Add(a);
        l.Pending.Add(b);
        return l;
    }

    public static LazyMatrix operator+(Matrix a, LazyMatrix b)
    {
        b.Pending.Add(a);
        return b;
    }
}

class Program
{
    static void Main(string[] args)
    {
        Matrix a = new Matrix();
        Matrix b = new Matrix();
        Matrix c = new Matrix();
        Matrix d = new Matrix();

        a.Contents[0, 0] = 1;
        b.Contents[1, 0] = 4;
        c.Contents[0, 1] = 9;
        d.Contents[1, 1] = 16;

        Matrix m = a + b + c + d;

        for (int i = 0; i < 2; ++i)
        {
            for (int j = 0; j < 2; ++j)
            {
                System.Console.Write(m.Contents[i, j]);
                System.Console.Write("  ");
            }
            System.Console.WriteLine();
        }

        System.Console.ReadLine();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-22T13:34:38.023

在 C++ 中，可以使用[模板元](http://en.wikipedia.org/wiki/Template_metaprogramming)程序，也可以[在这里](http://ubiety.uwaterloo.ca/~tveldhui/papers/Template-Metaprograms/meta-art.html)使用模板来做到这一点。但是，模板编程并非易事。我不知道 C# 中是否有类似的技术，很可能没有。

在 c++ 中，这种技术完全符合您的要求。缺点是如果某些地方不太正确，那么编译器错误消息往往会跑到好几页，而且几乎不可能破译。

如果没有这些技术，我怀疑您仅限于 Add3Matrices 等函数。

但对于 C#，此链接可能正是您所需要的：[Efficient Matrix Programming in C#](http://www.codeproject.com/KB/recipes/dynmatrixmath.aspx)尽管它的工作方式似乎与 C++ 模板表达式略有不同。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-22T13:37:43.037

至少可以避免痛苦的东西

```
Matrix Add3Matrices(a,b,c) //and so on 
```

将会

```
Matrix AddMatrices(Matrix[] matrices) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-22T13:40:42.953

您无法避免创建中间对象。

[但是，您可以使用此处](http://ubiety.uwaterloo.ca/~tveldhui/papers/Expression-Templates/exprtmpl.html)描述的表达式模板来最小化它们并对模板进行奇特的惰性求值。

在最简单的层面上，表达式模板可以是一个对象，它存储对多个矩阵的引用并在赋值时调用适当的函数，如 Add3Matrices()。在最高级的级别，表达式模板将根据请求以惰性方式计算最小信息量。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-22T13:53:01.783

这不是最干净的解决方案，但如果您知道评估顺序，则可以执行以下操作：

```
result = MatrixAdditionCollector() << a + b + c + d 
```

（或具有不同名称的相同事物）。然后 MatrixCollector 将 + 实现为 +=，也就是说，从一个未定义大小的 0 矩阵开始，一旦对第一个 + 求值，然后将所有内容加在一起（或复制第一个矩阵），就会获取一个大小。这会将中间对象的数量减少到 1（甚至 0，如果您以一种好的方式实现分配，因为 MatrixCollector 可能会立即/包含结果。）
我不完全确定这是丑陋的地狱还是其中之一更好的黑客可能会做。一个特定的优势是正在发生的事情很明显。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-22T14:01:38.097

我认为您可以使所需的就地添加行为明确：

```
Matrix result = a;
result += b;
result += c;
result += d; 
```

但正如 Doug 在这篇文章的评论中指出的那样，编译器将这段代码视为我写的：

```
Matrix result = a;
result = result + b;
result = result + c;
result = result + d; 
```

因此仍然会创建临时对象。

我只是删除这个答案，但似乎其他人可能有同样的误解，所以把它当作一个反例。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-22T14:09:18.360

我可以建议一个行为很像 StringBuilder 的 MatrixAdder。您将矩阵添加到 MatrixAdder，然后调用 ToMatrix() 方法，该方法将在惰性实现中为您执行添加操作。这会给你你想要的结果，可以扩展到任何类型的 LazyEvaluation，但也不会引入任何可能混淆其他代码维护者的聪明实现。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-22T14:30:22.740

Bjarne Stroustrup 有一篇名为[Abstraction, libraries, and efficiency in C++](http://www.research.att.com/~bs/abstraction.pdf)的短论文，他提到了用于实现您所寻找的技术的技术。具体来说，他提到了[Blitz++](http://www.oonumerics.org/blitz/)库，这是一个用于科学计算的库，它也具有高效的矩阵运算，以及其他一些有趣的库。另外，我建议您阅读[artima.com](http://www.artima.com/intv/abstreffi.html)上与 Bjarne Stroustrup 就该主题进行的对话。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-22T13:31:17.187

这是不可能的，使用运算符。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-22T14:00:58.677

我的第一个解决方案是这样的（如果可能的话，添加到 Matrix 类中）：

```
static Matrix AddMatrices(Matrix[] lMatrices) // or List<Matrix> lMatrices
{
    // Check consistency of matrices

    Matrix m = new Matrix(n, p);

    for (int i = 0; i < n; i++)
        for (int j = 0; j < n; j++)
            foreach (Maxtrix mat in lMatrices)
                m[i, j] += mat[i, j];

    return m;
} 
```

我在 Matrix 类中有它，因为您可以依赖私有方法和属性，这些方法和属性可能对您的函数有用，以防矩阵的实现发生变化（例如，非空节点的链表而不是大的双数组）。

当然，你会失去`result = a + b + c + d`. 但是你会有类似的东西`result = Matrix.AddMatrices(new Matrix[] { a, b, c, d });`。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-30T12:29:05.107

有几种方法可以实现惰性评估来实现这一点。但重要的是要记住，并非总是您的编译器能够获得所有代码中最好的代码。

我已经做出了在 GCC 中运行良好的实现，甚至超越了传统的几个 For unreadable code 的性能，因为它们导致编译器观察到数据段之间没有别名（随着数组的出现而难以掌握）。但其中一些在 MSVC 中完全失败，在其他实现中反之亦然。不幸的是，这些内容太长了，无法在此处发布（不要认为数千行代码适合此处）。

用于科学计算的 Blitz++ 库是一个非常复杂的库，其中包含大量嵌入式知识。

# javascript - 在不出现性能缺陷的情况下打包 JavaScript 代码的最佳方法是什么？

> ID：114860
> 
> 赞同：6
> 
> 时间：2008-09-22T13:27:25.713
> 
> 标签：javascript, iphone, compression

我正在寻找一种压缩 iPhone 的 JavaScript 代码的方法。有没有办法避免在小型且速度较慢的设备上使用大量 CPU 时间？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-22T13:29:02.543

使用[YUI 压缩器](http://www.julienlecomte.net/yuicompressor/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-22T13:31:27.530

使用[JSMin](http://www.crockford.com/javascript/jsmin.html)并避免使用更消耗 CPU 且“放气”速度更慢的[打包程序](http://dean.edwards.name/packer/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-22T14:04:15.267

我喜欢[ShrinkSafe](http://shrinksafe.dojotoolkit.org/)。它在 Rhino 中解释您的代码，然后返回压缩代码。因为它在真正的解释代码上运行（而不是复杂的字符串评估），所以它永远不会混淆代码或找不到公共变量和私有变量之间的差异。

这是一款质量上乘的工具。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-22T18:02:17.037

我们已经使用[js_compactor](http://search.cpan.org/dist/JavaScript-Squish/bin/js_compactor)和[JavaScriptLint](http://www.javascriptlint.com/)在我们的自动构建过程中“编译”和压缩我们的 JavaScript。进一步的构建步骤将压缩 JavaScript 并将相关文件合并到一个包中。性能提升是显着的，但请注意，您正在放弃调试能力。

当有多个文件时，减少传输到客户端的文件数量将大大提高性能。通常，浏览器一次只会打开 2 个与单个服务器的连接，因此即使您正在传输压缩和最小化的文件，浏览器也会花费大量开销检查其缓存。 [yslow](http://developer.yahoo.com/yslow/)帮助我们[确定](http://developer.yahoo.com/performance/)了页面加载时间过长的原因，并帮助我们集中精力进行优化。我们检测我们的环境以使用[原始文件](http://lh6.ggpht.com/john.naegle/SNf4cbll33I/AAAAAAAACVg/irsjeJWVfyA/s800/raw.jpg)或最小化和[压缩版本](http://lh6.ggpht.com/john.naegle/SNf4coq4vEI/AAAAAAAACVo/dGfDyadX2Tg/s800/compress.jpg)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-22T13:41:15.090

我相信 iPhone 上的 Safari 支持 gzip 输出，所以你可以使用类似 mod_deflate 的东西。使用这种方法，我得到了最好的结果。相当多的 JavaScript 压缩内容绝对是垃圾，并且解压缩所需的时间比下载更大的文件所需的时间要长。不过，JSMin 看起来还不错。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-22T20:05:19.423

[您可以在The JavaScript CompressorRater](http://compressorrater.thruhere.net/)尝试不同的工具。据我所知，除了打包器之外的所有工具都不会影响 javascript 的执行速度——它们只会删除空格、重命名变量等。

我自己认为[YUI Compressor](http://developer.yahoo.com/yui/compressor/)是最好的。

[首先验证JSLint](http://www.jslint.com/)中的代码以确保压缩器正确理解它总是有用的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T16:06:04.740

当客户端支持它时，确保您的网络服务器正确地提供压缩/放气的东西通常比缩小程序代码本身更有效。当然，同时使用两者往往会产生更小的尺寸。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T06:05:06.907

I just went through this little dance in the last few days. We tried using [Packer](http://dean.edwards.name/packer/), but found that our packed JavaScript was taking over 2 seconds to execute (not to mention blocking other downloads). Based on [this article](http://www.julienlecomte.net/blog/2007/08/11/) we've switched to [YUI Compressor](http://en.wikipedia.org/wiki/Yahoo!_UI_Library#Build_tools). Not only are our gzipped file sizes smaller, execution times are under 300 ms.

# javascript - JS 函数调用有多贵（与为变量分配内存相比）？

> ID：114872
> 
> 赞同：12
> 
> 时间：2008-09-22T13:29:03.573
> 
> 标签：javascript, function, optimization

在这里给定一些类似的JS代码：

```
 for (var i = 0; i < document.getElementsByName('scale_select').length; i++) {
    document.getElementsByName('scale_select')[i].onclick = vSetScale;
  } 
```

如果我们在循环之前将 getElementsByName 的结果放入变量中，然后在循环之后使用该变量，代码会更快吗？

我不确定在现实生活中的影响有多大，结果`getElementsByName`通常少于 10 个项目。无论如何，我想了解潜在的机制。

另外，如果这两个选项还有什么值得注意的地方，请告诉我。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-22T13:37:13.803

确实。存储它所需的内存只是一个指向 DOM 对象的指针，这***比***每次需要使用某些东西时进行 DOM 搜索要痛苦得多！

理想化代码：

```
var scale_select = document.getElementsByName('scale_select');
for (var i = 0; i < scale_select.length; i++)
    scale_select[i].onclick = vSetScale; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-22T20:06:50.717

缓存属性查找可能会有所帮助，但[事实证明在开始循环之前缓存数组的长度更快。](http://www.robertnyman.com/2008/04/11/javascript-loop-performance/)

因此，在循环中声明一个包含 scale_select.length 值的变量会加快整个循环的速度。

```
var scale_select = document.getElementsByName('scale_select');
for (var i = 0, al=scale_select.length; i < al; i++)
    scale_select[i].onclick = vSetScale; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-22T13:59:44.763

DOM 的智能实现会自己做缓存，当某些东西发生变化时使缓存失效。但是今天并不是所有的 DOM 都可以这么聪明（*咳嗽*IE*咳嗽*），所以最好自己做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T13:33:53.173

> 原则上，如果我们在循环之前将 getElementsByName 的结果放入变量中，然后在循环之后使用该变量，代码会更快吗？

是的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-22T13:37:45.550

使用变量。它们在 JavaScript 中不是很昂贵，而且函数调用肯定更慢。如果您在 document.getElementById() 上循环至少 5 次，请使用变量。这里的想法不仅是函数调用很慢，而且这个特定的函数也很慢，因为它试图在 DOM 中定位具有给定 id 的元素。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-23T12:10:18.183

**@奥利**

缓存在变量中获取的元素的长度属性也是一个好主意：

```
var scaleSelect = document.getElementsByName('scale_select');
var scaleSelectLength = scaleSelect.length;

for (var i = 0; i < scaleSelectLength; i += 1)
{
    // scaleSelect[i]
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-26T14:41:38.297

There's no point storing the scaleSelect.length in a separate variable; it's actually already in one - scaleSelect.length is just an attribute of the scaleSelect array, and as such it's as quick to access as any other static variable.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-22T13:35:01.703

我认同。每次循环时，引擎都需要重新评估 document.getElementsByName 语句。

另一方面，如果该值保存在变量中，则它已经具有该值。

# c++ - 如何确定socket listen() backlog 参数的值？

> ID：114874
> 
> 赞同：38
> 
> 时间：2008-09-22T13:29:07.787
> 
> 标签：c++, c, sockets, tcp, listen

我应该如何确定监听套接字的 backlog 参数使用什么？简单地指定一个非常大的数字是否有问题？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-09-22T13:56:26.720

[Winsock Programmer's FAQ](http://tangentsoft.net/wskfaq/advanced.html#backlog)中有一个很长的答案。它详细介绍了标准设置，以及在 NT 4.0 的修补程序中添加的动态积压功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-22T14:03:42.943

我第二次使用 SOMAXCONN，除非您有特定原因使用短队列。

请记住，如果队列中没有空间用于新连接，则不会发送 RST，允许客户端通过重新传输 SYN 自动继续尝试连接。

此外， backlog 参数在不同的套接字实现中可能具有不同的含义。

*   在大多数情况下，它意味着半开连接队列的大小，在某些情况下，它意味着完成连接队列的大小。
*   在许多实现中，积压参数将相乘以产生不同的队列长度。
*   如果指定的值太大，所有实现都会默默地将值截断为最大队列长度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T13:37:06.423

从[文档](http://msdn.microsoft.com/en-us/library/ms739168(VS.85).aspx)：

> SOMAXCONN 的 backlog 值是一个特殊的常量，它指示负责 socket 的底层服务提供者将挂起连接的队列长度设置为最大合理值。

# macos - 有没有办法在不安装 Xcode 的情况下在 OSX 中安装 gcc？

> ID：114884
> 
> 赞同：45
> 
> 时间：2008-09-22T13:31:41.040
> 
> 标签：macos, gcc, compiler-construction

我已经用谷歌搜索了它，似乎没有安装 Xcode（至少需要 1.5GB 空间）就无法在 OS X 上安装 gcc。我所需要的只是 gcc 而不是 Xcode 附带的其他垃圾。在这一点上，我将采用任何其他类型的 C 编译器。

我知道我可以简单地安装 Xcode，但这并不重要，因为我既没有原始安装光盘，也没有快速的互联网连接。

那么……有人有什么建议吗？

编辑：对不起，如果我不清楚，但我也需要标题。我目前正在通过 fink 安装 gcc4，它也在下载共享库。我会更新进展。

编辑 2：好的，所以我使用 fink 成功安装了 gcc。但是，它几乎没用：“错误：C 编译器无法创建可执行文件”。谷歌搜索后，我发现没有安装 Apple 的开发者工具是错误的原因。可能是因为我需要所有只能通过 Xcode 获得的库、头文件等。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-02-17T03:08:21.270

[从apple](http://developer.apple.com/downloads)签出 Xcode 的命令行工具。苹果官方支持只创建命令行工具。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2011-07-31T02:38:39.013

试试github 上[的 osx-gcc-installer 。](https://github.com/kennethreitz/osx-gcc-installer)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-09-04T18:09:05.110

我已经这样做了很长时间，我也做过这样的事情，我得出的结论是，它根本不值得做。:-(

原因是没有人期望你做这样的事情，所以整个系统都假设“一切”都在那里。您今天可能不会遇到这种情况 - 或者更糟糕的是，您以后甚至可能没有意识到这是您的问题的原因。

不要把聪明的时间浪费在像这样实际上不会产生任何可以使用的工作代码的事情上，按照批准的方法，在一夜之间运行下载，然后把时间花在计划和编写顶级代码上（你应该无论如何都不需要编译器！）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-22T13:55:37.863

我相当肯定这是不可能的。但是，我也不确定您是否需要整个开发人员套件来安装开发人员工具。与 XCode 一起安装了相当多的工具，这些工具可能是可选的。但是，我认为您不走运，因为您不需要硬着头皮使用 wget 或 DownThemAll 或其他一些下载管理器，它们可以让您慢慢下载开发人员工具。

每当我安装 OS XI 时，通常都会安装开发人员工具，因为它极大地打开了可用软件的世界。也许您将来也应该考虑这样做。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-22T14:36:05.410

你想尝试的第一件事叫做[Pacifist](http://www.charlessoft.com/) ——Pacifist 让你做的是打开一个大包（比如 XCode）并直接访问它的一部分。我很确定您将能够在只有 gcc 的 XCode 包中找到一个较小的包。

**但是**我不清楚这是最好的路线。如果您打算进行 Cocoa 或 Carbon 开发，我*强烈*建议您安装整个软件包，因为您将需要所有文档和标题。如果你只打算做命令行的事情，你仍然可能会发现你需要在 XCode 中四处寻找你需要的所有包——比如库、标题、手册页等等。

总而言之，您最好还是安装整个东西-如果高清空间真的很紧（例如，因为您使用的是一台很小的旧 iMac），那么请查看 Monolingual 之类的工具[-Monolingual](http://monolingual.sourceforge.net/)删除了所有国际支持各种 OS X 应用程序，可以轻松将应用程序的大小减少 50%。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-22T13:33:37.900

如果您想要一个简单的安装程序/更新程序，可以使用 fink 和 MacPorts。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T14:22:10.123

从 Xcode 磁盘映像中的 Packages 目录安装 GCC 包，您将拥有 GCC。请注意，您当然不会有自动工具或其他标准构建工具，您必须从该文件夹安装更多软件包。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-22T14:23:29.980

我发现[这个](http://gcc.gnu.org/ml/gcc/2003-01/msg00013.html)谷歌搜索似乎在没有 XCode 的情况下安装它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-09-20T16:24:00.110

单独安装命令行工具。

参考

1.  [http://osxdaily.com/2014/02/12/install-command-line-tools-mac-os-x](http://osxdaily.com/2014/02/12/install-command-line-tools-mac-os-x)
2.  [http://osxdaily.com/2012/07/06/install-gcc-without-xcode-in-mac-os-x/](http://osxdaily.com/2012/07/06/install-gcc-without-xcode-in-mac-os-x/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-01-01T21:02:33.087

是的，我可以用端口来做，但你至少需要接受代码许可证。

# flash - Flash/ActionScript 中的类似 QTVR 的全景图？

> ID：114892
> 
> 赞同：0
> 
> 时间：2008-09-22T13:33:59.287
> 
> 标签：flash, actionscript, graphics, quicktime

自从我使用 Actionscript 已经有几年了。过去，我制作了一个模拟 QTVR 全景图的项目（在我使用 Flash 的时候，你只能嵌入非常基本的 mov 文件），只需将一个很长的扁平全景图像向左或向右移动到蒙版后面。效果还可以，但不如真正的全景，因为视角太扭曲了。所以现在已经开发了几个 Flash 迭代，我很好奇......

现在有没有办法更接近真正的 QTVR？...或者现在可以嵌入真正的 QTVR 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T17:21:59.347

[FlashPanoramas](http://flashpanoramas.com/player/)过去对我来说非常有用。它的新功能之一是能够直接加载 QTVR 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-13T07:57:26.260

最好的解决方案是使用 krpano，这是我目前日常使用的在我开发的网站上展示待售土地的最佳解决方案。它是迄今为止最好的——基于闪存的、基于 XML 的、非常可定制的、支持插件的，是最好的。

[http://www.krpano.com/](http://www.krpano.com/)

它有一个 Flash 查看器以及创建全景图所需的所有工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T14:45:40.660

我的建议是 - 下载[PaperVision](http://blog.papervision3d.org/)，将您的图像切成条状，然后将它们排列成 3d 平面。

# oracle - 如何在 TOAD 中传递数组参数

> ID：114910
> 
> 赞同：3
> 
> 时间：2008-09-22T13:39:28.697
> 
> 标签：oracle, associative-array, toad

使用 toad 和 oracle 数据库，我如何调用 sp 并通过将数组传递给 sp 的参数之一来查看结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T14:45:19.490

在编辑器选项卡中，您可以这样称呼它：

```
begin
    myproc (my_array_type(1,4,7,9));
end; 
```

# java - 您如何解决 Hudson 中的“打开文件过多”问题？

> ID：114914
> 
> 赞同：7
> 
> 时间：2008-09-22T13:40:14.357
> 
> 标签：java, exception, continuous-integration, build-automation, hudson

我们使用[Hudson](http://hudson-ci.org/)作为持续集成系统来执行我们许多项目的自动构建（每晚并基于 CVS 轮询）。

有些项目每 15 分钟轮询一次 CVS，有些项目每 5 分钟轮询一次，有些则每小时轮询一次。

每隔几周，我们就会得到一个失败的构建，输出如下：

```
FATAL: java.io.IOException: Too many open files
java.io.IOException: java.io.IOException: Too many open files
    at java.lang.UNIXProcess.<init>(UNIXProcess.java:148) 
```

下一个构建始终有效（有 0 次更改），因此我们总是将其归结为同时运行 2 个构建作业，并且在此过程中碰巧打开了太多文件。

这个周末我们在周五晚上构建失败（自动夜间构建）并显示消息，并且每隔一个夜间构建也失败。不知何故，这促使 Hudson 不断构建每个失败的项目，直到问题得到解决。这导致每个项目每 30 分钟左右构建一次，直到周六晚上某个时候问题神奇地消失了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-16T17:39:32.393

这是哈德逊问题 715 ( ~~[http://issues.hudson-ci.org/browse/HUDSON-715](http://issues.hudson-ci.org/browse/HUDSON-715)~~ )。当前的建议是设置“同时轮询线程的最大数量”以保持轮询活动停止。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-22T16:42:46.350

请参阅[https://wiki.jenkins-ci.org/display/JENKINS/I%27m+getting+too+many+open+files+error](https://wiki.jenkins-ci.org/display/JENKINS/I%27m+getting+too+many+open+files+error)了解我们需要您提供什么来解决此类问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T13:45:00.463

更改每个进程最大打开文件描述符的系统限制？至于`ulimit -n`Java进程？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-16T17:54:49.867

我在 Debian 上运行的另一个 Java 应用程序遇到了这个问题，当我们降级到 Java 版本 1.6.0.0 时它就消失了。Java 从不关闭未使用的连接，导致它抛出异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-13T07:58:58.330

导致“打开的文件过多”的最常见问题之一是在 Jenkins 中启用和配置了 Active Directory 插件。此插件存在已知问题，这些问题会导致显示大量线程以及日志中出现“打开的文件过多”错误。禁用它并切换到 LDAP 身份验证后，我不再体验 Jenkins 挂起。

# c# - .NET Process.Start 默认目录？

> ID：114928
> 
> 赞同：124
> 
> 时间：2008-09-22T13:44:33.833
> 
> 标签：c#

我正在从 C# [.NET](http://en.wikipedia.org/wiki/.NET_Framework)控制台应用程序内部启动 Java 应用程序。它适用于 Java 应用程序不关心“默认”目录是什么的情况，但对于只在当前目录中搜索支持文件的 Java 应用程序却失败了。

是否可以设置进程参数来指定启动进程的默认目录？

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2008-09-22T13:46:44.077

是的！ProcessStartInfo 有一个名为*WorkingDirectory*的属性，只需使用：

```
...
using System.Diagnostics;
...

var startInfo = new ProcessStartInfo();

  startInfo.WorkingDirectory = // working directory
  // set additional properties 

Process proc = Process.Start(startInfo); 
```

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2008-09-22T14:54:46.160

使用[*ProcessStartInfo.WorkingDirectory*](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.workingdirectory.aspx "链接到 ProcessStartInfo.WorkingDirectory 上的 MSDN 文档")属性在启动进程之前对其进行设置。如果未设置该属性，则默认工作目录为 %SYSTEMROOT%\system32。

您可以使用以下方法确定 %SYSTEMROOT% 的值：

```
string _systemRoot = Environment.GetEnvironmentVariable("SYSTEMROOT"); 
```

下面是一些使用 %ProgramFiles% 工作目录打开 Notepad.exe 的示例代码：

```
...
using System.Diagnostics;
...

ProcessStartInfo _processStartInfo = new ProcessStartInfo();
  _processStartInfo.WorkingDirectory = @"%ProgramFiles%";
  _processStartInfo.FileName         = @"Notepad.exe";
  _processStartInfo.Arguments        = "test.txt";
  _processStartInfo.CreateNoWindow   = true;
Process myProcess = Process.Start(_processStartInfo); 
```

还有一个环境变量可以控制您的进程的当前工作目录，您可以通过[*Environment.CurrentDirectory*](http://msdn.microsoft.com/en-us/library/system.environment.currentdirectory.aspx "关于 Environment.CurrentDirectory 的 MSDN 文档")属性直接访问它。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2014-04-04T19:13:20.077

只是在尝试实现这一点后打了我的头。如果将“UseShellExecute”设置为 false，则设置 WorkingDirectory 值不起作用。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-22T13:46:46.463

使用 ProcessStartInfo.WorkingDirectory 属性。

文档[在这里](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.workingdirectory.aspx)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-22T13:47:43.887

Process.Start 方法有一个采用 ProcessStartInfo 实例的重载。此类有一个名为“WorkingDirectory”的属性。

将该属性设置为您要使用的文件夹，这应该使其在正确的文件夹中启动。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-22T13:47:46.850

使用`ProcessStartInfo`类并为属性赋值`WorkingDirectory`。

# flash - 将视频添加到站点

> ID：114931
> 
> 赞同：1
> 
> 时间：2008-09-22T13:44:55.453
> 
> 标签：flash, video, web

在您看来，假设将视频呈现为 FLV，将视频添加到网站的最佳选择是什么。主要考虑因素是什么？

您会使用第三方服务（youtube.com、vimeo.com 等）还是自己托管？为什么？如果您使用了一项服务，是哪一项？如果您自己托管，是否就像使用现有的可嵌入 Flash FLV 播放器通过 HTTP 访问 FLV 文件一样简单，还是在内容管理等方面您会做更多的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T14:02:25.600

我想问题归结为你是否需要完全控制视频，以及你是否有钱投入到这个项目上。如果您在 youtube 等网站上托管，您必须遵守他们的服务条款，并且需要在他们的品牌限制范围内工作。

当我需要为客户完全控制 Flash 视频剪辑时，我使用了[JW-FLV](http://www.jeroenwijering.com/?item=JW_FLV_Player)播放器。它会很高兴地从 HTTP 服务器上提供 FLV 文件。可以将播放器嵌入到另一个 Flash 电影中，但大多数情况下，您将通过 HTML 链接控制播放列表。托管视频文件可能会变得非常昂贵，因此需要支付高额的带宽费用。

如果我正在为具有某种营销方面的公共消费创建视频，我会使用第 3 方服务。将其托管在 YouTube 上，您可以获得很好的曝光率，人们有机会找到您的视频。这些服务在其网络中也具有全球影响力，因此您可以在全球范围内获得更好的性能。

Google 最近为 Google Apps 客户发布了视频。这使您可以保护属于您组织的用户的 Google 视频。这弥补了一些传统上使用自托管的项目的差距。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T13:53:41.563

您是否决定自己托管视频很大程度上取决于您的要求、托管环境和您使用的技术。如果它是一个小型个人网站，那么在 youtube 或其他托管服务上托管它是完全可以的，但如果你正在制作一个公司网站，如果你自己托管它看起来会更专业。或者，如果视频不会经常更改，则自己托管也很容易。
要自己托管它，只需将其放入服务器上的 Web 可访问目录并在播放器中设置 URL。
如果您需要进行内容管理，请记住服务器上可能存在的上传限制，以及 HTTP 不是上传大文件的理想协议这一事实。
如果您必须在服务器上重新编码视频，请不要忘记在编码运行时它会严重影响性能。
要在服务器上重新编码视频，我更喜欢使用 FFMPEG 或 mencoder（都有 windows 和 linux/unix 版本）。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-09-22T14:44:50.380

如果您要使用第 3 方网站，请使用 vimeo - 这是一种出色的用户体验和出色的视频质量。

# scroll - foxpro 的垂直滚动选框

> ID：114946
> 
> 赞同：0
> 
> 时间：2008-09-22T13:47:45.727
> 
> 标签：scroll, visual-foxpro, foxpro, marquee

谁能给我指出一些代码/给我一些关于如何为 VFP 8 或 9 创建平滑滚动垂直选取框的想法？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-22T14:23:31.023

您可以使用可[滚动容器](http://www.ctl32.com.ar/ctl32_scontainer.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-02T21:58:41.617

这是一个滚动消息的快速程序。将以下内容放入 prg 文件并运行它。

我会让 containerScrollArea 成为一个封装计时器、标签和滚动代码的类。给它 GetNextMessage 方法，您可以覆盖该方法以检索消息。

```
* Put a container on the screen to hold our scroller
_screen.AddObject("containerScrollArea", "container")

WITH _Screen.containerScrollArea
    * Size it
    .Visible = .t.
    .Width = 100
    .Height = 100

    * Add two labels, one to hold each scrolling message
    .AddObject("labelScroll1", "Label") 
    .AddObject("labelScroll2", "Label") 

    * This timer will move the labels to scroll them
    .AddObject("timerScroller", "ScrollTimer")
ENDWITH

WITH _Screen.containerScrollArea.labelScroll1
    * The labels are positioned below the margin of the container, so they're not initially visible
    .Top = 101
    .Height = 100
    .Visible = .t.
    .WordWrap = .t.
    .BackStyle= 0
    .Caption = "This is the first scrolling text, which is scrolling."
ENDWITH

WITH _Screen.containerScrollArea.labelScroll2
    * The labels are positioned below the margin of the container, so they're not initially visible
    .Top = 200
    .Height = 100
    .Visible = .t.
    .WordWrap = .t.
    .BackStyle= 0
    .Caption = "This is the second scrolling text, which is scrolling."
ENDWITH

* Start the timer, which scrolls the labels
_Screen.containerScrollArea.timerScroller.Interval = 100

DEFINE CLASS ScrollTimer AS Timer
    PROCEDURE Timer

        * If the first label is still in view, move it by one pixel
        IF This.Parent.labelScroll1.Top > -100
            This.Parent.labelScroll1.Top = This.Parent.labelScroll1.Top - 1
        ELSE
            * If the first label has scrolled out of view on the top of the container, move it back to the bottom.
            This.Parent.labelScroll1.Top = 101
            * Load some new text here
        ENDIF

        IF This.Parent.labelScroll2.Top > -100
            * If the second label is still in view, move it by one pixel
            This.Parent.labelScroll2.Top = This.Parent.labelScroll2.Top - 1
        ELSE
            * If the second label has scrolled out of view on the top of the container, move it back to the bottom.
            This.Parent.labelScroll2.Top = 101
            * Load some new text here
        ENDIF
    ENDPROC
ENDDEFINE 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T21:17:26.093

不幸的是，我的工作性质让我没有时间玩弄图形，但如果我这样做了，我会考虑使用 GDI+ 和 VFP。这是[一篇](http://msdn.microsoft.com/en-us/library/ms947605.aspx)让您入门的文章

# php - 如何从 PHP 获取电子邮件及其附件

> ID：114953
> 
> 赞同：17
> 
> 时间：2008-09-22T13:49:13.917
> 
> 标签：php, email

我正在为朋友的婚礼编写一个照片库 web 应用程序，他们想要一个照片库供客人提交他们当天拍摄的数码照片。

在评估了所有选项之后，我决定对用户来说最简单的事情是让他们使用熟悉的界面（他们的电子邮件），然后让他们将图片作为附件发送。

我已经创建了一个邮箱，但现在我需要连接和检索这些附件，以便自动处理以添加到图库系统。但是怎么做？您是否看过任何教程或预制课程？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-22T14:03:50.120

我以前经常这样做，但我找不到代码，这是我找到的缩小版本。它应该让你走上正确的道路。我曾经从 cronjob 运行这种类型的脚本。抱歉，我找不到最终版本。;(

```
// Open pop mailbox
if (!$mbox = imap_open ("{localhost:110/pop3/notls}INBOX", "user", "tester")) {
  die ('Cannot connect/check pop mail! Exiting');
}

if ($hdr = imap_check($mbox)) {
  $msgCount = $hdr->Nmsgs;
} else {
  echo "Failed to get mail";
  exit;
}

$MN=$msgCount;
$overview=imap_fetch_overview($mbox,"1:$MN",0);

for ($X = 1; $X <= $MN; $X++) {

  $file = imap_fetchbody($mbox, $X, 1);

  imap_delete($mbox, $X);
}

imap_expunge($mbox);
imap_close($mbox); 
```

祝你好运！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-22T14:11:45.513

如果您为此目的创建一个专用邮箱，那么使用过滤机制几乎绝对不是您想要的。相反，您希望邮箱成为应用程序的管道，并让应用程序简单地从标准输入读取消息，解析出正文，然后 MIME 解析正文以获取附件。

我所知道的所有流行的基于 unix 的 MTA 都支持将邮箱作为管道，例如 sendmail、postfix 和 qmail。通常，您在别名文件中定义它，如下所示：

# sendmail 或后缀语法
msgsubmit: "| /usr/bin/php ~path/to/example.php"

然后发送到 msgsubmit@ 的邮件被路由到一个 php 程序进行传递。

这样做的好处是不依赖于 IMAP 服务器或 MTA 之外的任何其他服务器处于活动状态，并且只要您可以控制目标主机的 MTA，它就可以正常工作。如果您希望脚本检查系统上的所有消息，那么过滤就是您想要的，我猜事实并非如此。

如果您希望将副本保存在某处的邮箱中（不是一个坏主意），只需定义别名以转到多个地址，如下所示：

```
 msgsubmit: "| /usr/bin/php ~path/to/example.php", msgsubmit-box 
```

或后缀虚拟格式：

```
 msgsubmit
    "| /usr/bin/php ~path/to/example.php"
    msgsubmit-box 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-22T14:14:58.940

您是否考虑过使用 Google 的[Picasa 网络相册](http://picasaweb.google.com)？您可以设置一个电子邮件地址来发送照片并在线共享它们。然后，您可以获得这些照片的 RSS 提要，大多数程序员比 MTA 更熟悉这些提要。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-22T13:54:08.193

你用的是什么MTA？如果您使用 postfix + maildrop，您可以创建一个过滤规则，通过 PHP 脚本处理某些消息，然后处理传入的邮件。（谷歌邮件投递和`xfilter`）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-22T13:53:14.560

我想你想要一个 MIME 消息解析器。

我以前用过[这个](http://www.phpclasses.org/browse/package/3169.html)，它似乎工作得很好，虽然我还没有在非常大的附件上测试过它（即你可能从数码相机得到的 2-3MB 文件）。

您是否已经有了读取 POP3/IMAP 邮箱的系统？在同一个站点上还有[另一个类](http://www.phpclasses.org/browse/package/2.html)也适用于 POP3（我相信还有一个 IMAP 类） - 但是，如果您要下载相当数量的文件，也许您会想要研究一些基于 C 的解决方案，因为我相信一种是纯PHP。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-06T21:46:56.607

`Majordomo`，可能是处理电子邮件的替代方法，但文件附件处理存在一些限制。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2008-12-15T09:06:15.157

```
<?php
//make sure that submit button name is 'Submit'
if(isset($_POST['Submit'])){

       $name = $_POST['visitorname'];
       $email = $_POST['visitoremail'];
       $message = $_POST['visitormessage'];

            $to="youremail@yourdomain.com";

          $subject="From ".$name;

          $from = $email;

          // generate a random string to be used as the boundary marker
          $mime_boundary="==Multipart_Boundary_x".md5(mt_rand())."x";

          // now we'll build the message headers
          $headers = "From: $from\r\n" .
          "MIME-Version: 1.0\r\n" .
             "Content-Type: multipart/mixed;\r\n" .
             " boundary=\"{$mime_boundary}\"";

          // next, we'll build the invisible portion of the message body
          // note that we insert two dashes in front of the MIME boundary
          // when we use it
          $message = "This is a multi-part message in MIME format.\n\n" .
             "--{$mime_boundary}\n" .
             "Content-Type: text/plain; charset=\"iso-8859-1\"\n" .
             "Content-Transfer-Encoding: 7bit\n\n" .
          $message . "\n\n";

 foreach($_FILES as $userfile)
          {
             // store the file information to variables for easier access
             $tmp_name = $userfile['tmp_name'];
             $type = $userfile['type'];
             $name = $userfile['name'];
             $size = $userfile['size'];

             // if the upload succeded, the file will exist
             if (file_exists($tmp_name))
             {

                // check to make sure that it is an uploaded file and not a system file
                if(is_uploaded_file($tmp_name))
                {

                   // open the file for a binary read
                   $file = fopen($tmp_name,'rb');

                   // read the file content into a variable
                   $data = fread($file,filesize($tmp_name));

                   // close the file
                   fclose($file);

                   // now we encode it and split it into acceptable length lines
                   $data = chunk_split(base64_encode($data));
                }

                // now we'll insert a boundary to indicate we're starting the attachment
                // we have to specify the content type, file name, and disposition as
                // an attachment, then add the file content.
                // NOTE: we don't set another boundary to indicate that the end of the
                // file has been reached here. we only want one boundary between each file
                // we'll add the final one after the loop finishes.
                $message .= "--{$mime_boundary}\n" .
                   "Content-Type: {$type};\n" .
                   " name=\"{$name}\"\n" .
                   "Content-Disposition: attachment;\n" .
                   " filename=\"{$fileatt_name}\"\n" .
                   "Content-Transfer-Encoding: base64\n\n" .
                $data . "\n\n";
             }
          }

$ok = @mail($to, $subject, $message , $headers);
if ($ok) {
if (($_FILES["file"]["type"] == "image/gif")
|| ($_FILES["file"]["type"] == "image/jpeg")
|| ($_FILES["file"]["type"] == "image/pjpeg")
&& ($_FILES["file"]["size"] < 20000))
  {
  if ($_FILES["file"]["error"] > 0)
    {
    echo "Return Code: " . $_FILES["file"]["error"] . "<br />";
    }
  else
    {

if (file_exists("upload/" . $_FILES["file"]["name"]))
      {
      echo $_FILES["file"]["name"] . " already exists. ";
      }
    else
      {
      move_uploaded_file($_FILES["file"]["tmp_name"],
      "upload/" . $_FILES["file"]["name"]);

      }
    }
  }
else
  {

  }
echo "<span class='red'>E-mail has been sent successfully from $mail_name to $to</span>"; }
else{
echo "<span class='red'>Failed to send the E-mail from $from to $to</span>";
}
}
?> 
```

p / s：我使用了这个代码。希望它的工作和帮助你。只需复制和粘贴。确保您的文本字段名称与此页面中的相同。它适用于所有类型的文件。如有其他问题，请通过 shah 给我发电子邮件@mc-oren.com.anyway，我也在学习过程中。=）谢谢。

# cocoa - 如何在调用 resizeSubviewsWithOldSize 期间触发动画代理上的核心动画？

> ID：114970
> 
> 赞同：3
> 
> 时间：2008-09-22T13:53:48.117
> 
> 标签：cocoa, core-animation

我有一些 NSView，我根据窗口的大小将它们放入两种布局之一。

当相关的 superview 收到 resizeSubviewsWithOldSize 方法时，我正在调整布局。

这行得通，但我想动画变化。所以很自然地，我在设置新帧时尝试调用动画代理，但是当用户仍在拖动时动画不会运行。如果我在动画计划完成之前释放鼠标，我可以看到动画的结尾，但在那之前什么都看不到。我尝试确保将 kCATransactionDisableActions 设置为 NO，但这并没有帮助。

是否可以开始一个新动画并在调整大小期间实际运行它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T04:00:09.603

我认为您不能轻松做到这一点，因为 CA 的动画是通过计时器运行的，并且在用户拖动时处于活动状态的 runloop 模式期间计时器不会触发。

如果您可以在用户拖动时控制运行循环，请使用运行循环模式。这会让它工作。我认为您无法在 CA 方面进行更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-28T21:39:52.477

这确实不是一个答案，但我建议不要在拖动以调整窗口大小时对任何内容进行动画处理。屏幕已经开始动画了（从窗口移动） - 进一步的动画可能会在视觉上令人困惑和无关紧要。

CoreAnimation 效果最好用于从一种已知状态移动到另一种状态 - 例如，当首选项窗口正在调整大小以配合新窗格的内容时，并且您知道旧大小和新大小，或者当您淡入或淡出对象时（或两者）。在窗口调整大小时做动画会在视觉上造成混乱，并使用户更难专注于获得他们想要的窗口大小。

# c# - 给定一个 DateTime 对象，如何获取字符串格式的 ISO 8601 日期？

> ID：114983
> 
> 赞同：940
> 
> 时间：2008-09-22T13:56:08.797
> 
> 标签：c#, datetime, datetime-format, iso8601

鉴于：

```
DateTime.UtcNow 
```

如何以[符合 ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)的格式获取代表相同值的字符串？

请注意，ISO 8601 定义了许多类似的格式。我正在寻找的具体格式是：

```
yyyy-MM-ddTHH:mm:ssZ 
```

* * *

## 回答 #1

> 赞同：919
> 
> 时间：2008-09-22T14:00:17.320

> **读者注意：**几位评论者指出了这个答案中的一些问题（特别是与第一个建议有关）。有关更多信息，请参阅评论部分。

```
DateTime.UtcNow.ToString("yyyy-MM-ddTHH\\:mm\\:ss.fffffffzzz"); 
```

使用[自定义日期时间格式](https://docs.microsoft.com/dotnet/standard/base-types/custom-date-and-time-format-strings)，这将为您提供类似于
**2008-09-22T13:57:31.2311892-04:00**的日期。

另一种方法是：

```
DateTime.UtcNow.ToString("o"); 
```

它使用标准[的“往返”样式](https://docs.microsoft.com/dotnet/standard/base-types/standard-date-and-time-format-strings#Roundtrip)（ISO 8601）为您提供
**2008-09-22T14:01:54.9571247Z**。

要获取指定的格式，您可以使用：

```
DateTime.UtcNow.ToString("yyyy-MM-ddTHH:mm:ssZ") 
```

* * *

## 回答 #2

> 赞同：463
> 
> 时间：2008-09-22T14:06:48.913

`DateTime.UtcNow.ToString("s", System.Globalization.CultureInfo.InvariantCulture)`应该为您提供您正在寻找的内容，因为“s”格式说明符被描述为可排序的日期/时间模式；符合 ISO 8601。

**编辑：**要`Z`在最后获得 OP 要求的附加值，请使用`"o"`而不是`"s"`.

* * *

## 回答 #3

> 赞同：104
> 
> 时间：2008-09-22T13:59:20.367

```
DateTime.UtcNow.ToString("s") 
```

返回类似 2008-04-10T06:30:00 的内容

`UtcNow`显然会返回一个[UTC](https://en.wikipedia.org/wiki/Coordinated_Universal_Time)时间，所以在以下方面没有害处：

```
string.Concat(DateTime.UtcNow.ToString("s"), "Z") 
```

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2012-09-17T22:10:00.750

利用：

```
private void TimeFormats()
{
    DateTime localTime = DateTime.Now;
    DateTime utcTime = DateTime.UtcNow;
    DateTimeOffset localTimeAndOffset = new DateTimeOffset(localTime, TimeZoneInfo.Local.GetUtcOffset(localTime));

    //UTC
    string strUtcTime_o = utcTime.ToString("o");
    string strUtcTime_s = utcTime.ToString("s");
    string strUtcTime_custom = utcTime.ToString("yyyy-MM-ddTHH:mm:ssK");

    //Local
    string strLocalTimeAndOffset_o = localTimeAndOffset.ToString("o");
    string strLocalTimeAndOffset_s = localTimeAndOffset.ToString("s");
    string strLocalTimeAndOffset_custom = utcTime.ToString("yyyy-MM-ddTHH:mm:ssK");

    //Output
    Response.Write("<br/>UTC<br/>");
    Response.Write("strUtcTime_o: " + strUtcTime_o + "<br/>");
    Response.Write("strUtcTime_s: " + strUtcTime_s + "<br/>");
    Response.Write("strUtcTime_custom: " + strUtcTime_custom + "<br/>");

    Response.Write("<br/>Local Time<br/>");
    Response.Write("strLocalTimeAndOffset_o: " + strLocalTimeAndOffset_o + "<br/>");
    Response.Write("strLocalTimeAndOffset_s: " + strLocalTimeAndOffset_s + "<br/>");
    Response.Write("strLocalTimeAndOffset_custom: " + strLocalTimeAndOffset_custom + "<br/>");

} 
```

### 输出

```
UTC
    strUtcTime_o: 2012-09-17T22:02:51.4021600Z
    strUtcTime_s: 2012-09-17T22:02:51
    strUtcTime_custom: 2012-09-17T22:02:51Z

Local Time
    strLocalTimeAndOffset_o: 2012-09-17T15:02:51.4021600-07:00
    strLocalTimeAndOffset_s: 2012-09-17T15:02:51
    strLocalTimeAndOffset_custom: 2012-09-17T22:02:51Z 
```

### 资料来源：

*   *[标准日期和时间格式字符串](https://docs.microsoft.com/en-us/dotnet/standard/base-types/standard-date-and-time-format-strings)*(MSDN)

*   *[自定义日期和时间格式字符串](https://docs.microsoft.com/en-us/dotnet/standard/base-types/custom-date-and-time-format-strings)*(MSDN)

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2013-10-13T13:05:08.947

```
System.DateTime.UtcNow.ToString("o") 
```

=>

```
val it : string = "2013-10-13T13:03:50.2950037Z" 
```

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2015-07-06T16:11:29.530

您有几个选项，包括“往返 ("O") 格式说明符”。

```
var date1 = new DateTime(2008, 3, 1, 7, 0, 0);
Console.WriteLine(date1.ToString("O"));
Console.WriteLine(date1.ToString("s", System.Globalization.CultureInfo.InvariantCulture)); 
```

输出

```
2008-03-01T07:00:00.0000000
2008-03-01T07:00:00 
```

但是，DateTime + TimeZone 可能会出现其他问题，如博客文章*[DateTime and DateTimeOffset in .NET: Good practice and common pitfalls](https://engy.us/blog/2012/04/06/datetime-and-datetimeoffset-in-net-good-practices-and-common-pitfalls/)*中所述：

> DateTime 中有无数的陷阱，旨在给您的代码错误：
> 
> 1.- 带有 DateTimeKind.Unspecified 的 DateTime 值是坏消息。
> 
> 2.- DateTime 在进行比较时不关心 UTC/Local。
> 
> 3.- DateTime 值不知道标准格式字符串。
> 
> 4.- 使用 DateTime 解析具有 UTC 标记的字符串并不能保证 UTC 时间。

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2014-09-17T14:31:35.567

您可以使用以下代码获得“Z”（[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601) **UTC**）：

```
Dim tmpDate As DateTime = New DateTime(Now.Ticks, DateTimeKind.Utc)
Dim res as String = tmpDate.toString("o") '2009-06-15T13:45:30.0000000Z 
```

原因如下：

ISO 8601 有一些不同的格式：

**DateTimeKind.Local**

```
2009-06-15T13:45:30.0000000-07:00 
```

**DateTimeKind.Utc**

```
2009-06-15T13:45:30.0000000Z 
```

**DateTimeKind.Unspecified**

```
2009-06-15T13:45:30.0000000 
```

.NET 为我们提供了一个带有这些选项的枚举：

```
'2009-06-15T13:45:30.0000000-07:00
Dim strTmp1 As String = New DateTime(Now.Ticks, DateTimeKind.Local).ToString("o")

'2009-06-15T13:45:30.0000000Z
Dim strTmp2 As String = New DateTime(Now.Ticks, DateTimeKind.Utc).ToString("o")

'2009-06-15T13:45:30.0000000
Dim strTmp3 As String = New DateTime(Now.Ticks, DateTimeKind.Unspecified).ToString("o") 
```

**注意**：如果您将 Visual Studio 2008“监视实用程序”应用于*toString("o")*部分，您可能会得到不同的结果，我不知道这是否是一个错误，但在这种情况下，使用 String 变量可以获得更好的结果如果你正在调试。

来源：*[标准日期和时间格式字符串](http://msdn.microsoft.com/en-us/library/az4se3k1%28v=vs.110%29.aspx)*(MSDN)

* * *

## 回答 #8

> 赞同：27
> 
> 时间：2019-05-16T16:49:30.683

很惊讶没有人建议：

```
System.DateTime.UtcNow.ToString("u").Replace(' ','T') 
```

```
# Using PowerShell Core to demo

# Lowercase "u" format
[System.DateTime]::UtcNow.ToString("u")
> 2020-02-06 01:00:32Z

# Lowercase "u" format with replacement
[System.DateTime]::UtcNow.ToString("u").Replace(' ','T')
> 2020-02-06T01:00:32Z 
```

[UniversalSortableDateTimePattern](https://docs.microsoft.com/en-us/dotnet/api/system.globalization.datetimeformatinfo.universalsortabledatetimepattern)几乎可以让你得到你想要的（这更像是RFC [3339](https://www.rfc-editor.org/rfc/rfc3339.html#section-5.8)表示）。

* * *

补充：我决定使用答案[https://stackoverflow.com/a/43793679/653058](https://stackoverflow.com/a/43793679/653058)中的基准来比较它的性能。

tl：博士；它处于昂贵的一端，但在我那破旧的笔记本电脑上仍然只有半毫秒多一点:-)

执行：

```
[Benchmark]
public string ReplaceU()
{
   var text = dateTime.ToUniversalTime().ToString("u").Replace(' ', 'T');
   return text;
} 
```

结果：

```
// * Summary *

BenchmarkDotNet=v0.11.5, OS=Windows 10.0.19002
Intel Xeon CPU E3-1245 v3 3.40GHz, 1 CPU, 8 logical and 4 physical cores
.NET Core SDK=3.0.100
  [Host]     : .NET Core 3.0.0 (CoreCLR 4.700.19.46205, CoreFX 4.700.19.46214), 64bit RyuJIT
  DefaultJob : .NET Core 3.0.0 (CoreCLR 4.700.19.46205, CoreFX 4.700.19.46214), 64bit RyuJIT

|               Method |     Mean |     Error |    StdDev |
|--------------------- |---------:|----------:|----------:|
|           CustomDev1 | 562.4 ns | 11.135 ns | 10.936 ns |
|           CustomDev2 | 525.3 ns |  3.322 ns |  3.107 ns |
|     CustomDev2WithMS | 609.9 ns |  9.427 ns |  8.356 ns |
|              FormatO | 356.6 ns |  6.008 ns |  5.620 ns |
|              FormatS | 589.3 ns |  7.012 ns |  6.216 ns |
|       FormatS_Verify | 599.8 ns | 12.054 ns | 11.275 ns |
|        CustomFormatK | 549.3 ns |  4.911 ns |  4.594 ns |
| CustomFormatK_Verify | 539.9 ns |  2.917 ns |  2.436 ns |
|             ReplaceU | 615.5 ns | 12.313 ns | 11.517 ns |

// * Hints *
Outliers
  BenchmarkDateTimeFormat.CustomDev2WithMS: Default     -> 1 outlier  was  removed (668.16 ns)
  BenchmarkDateTimeFormat.FormatS: Default              -> 1 outlier  was  removed (621.28 ns)
  BenchmarkDateTimeFormat.CustomFormatK: Default        -> 1 outlier  was  detected (542.55 ns)
  BenchmarkDateTimeFormat.CustomFormatK_Verify: Default -> 2 outliers were removed (557.07 ns, 560.95 ns)

// * Legends *
  Mean   : Arithmetic mean of all measurements
  Error  : Half of 99.9% confidence interval
  StdDev : Standard deviation of all measurements
  1 ns   : 1 Nanosecond (0.000000001 sec)

// ***** BenchmarkRunner: End ***** 
```

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2011-06-02T15:19:15.353

我只会使用[`XmlConvert`](https://docs.microsoft.com/en-us/dotnet/api/system.xml.xmlconvert)：

```
XmlConvert.ToString(DateTime.UtcNow, XmlDateTimeSerializationMode.RoundtripKind); 
```

它将自动保留时区。

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2014-12-05T17:11:39.060

这些答案中的大多数都有毫秒/微秒，ISO 8601 显然不支持。正确的答案是：

```
System.DateTime.Now.ToString("yyyy-MM-ddTHH:mm:ssK");
// or
System.DateTime.Now.ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ssK"); 
```

参考：

*   [ISO 8601 规范](http://en.wikipedia.org/wiki/ISO_8601)
*   [“K”说明符](https://docs.microsoft.com/en-us/dotnet/standard/base-types/custom-date-and-time-format-strings#KSpecifier)

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2018-08-30T19:05:03.463

```
DateTime.Now.ToString("yyyy-MM-dd'T'HH:mm:ss zzz");

DateTime.Now.ToString("O"); 
```

注意：根据您最终进行的转换，您将使用第一行（最喜欢它）或第二行。

确保仅在本地时间应用格式，因为“zzz”是用于 UTC 转换的时区信息。

![图片](https://i.stack.imgur.com/NFhkW.png)

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2008-11-26T21:55:50.210

要将 DateTime.UtcNow 转换为*yyyy-MM-ddTHH:mm:ssZ*的字符串表示形式，您可以将 DateTime 结构的 ToString() 方法与自定义格式字符串一起使用。当使用带有 DateTime 的自定义格式字符串时，请务必记住您需要使用单引号转义分隔符。

以下将返回您想要的字符串表示形式：

```
DateTime.UtcNow.ToString("yyyy'-'MM'-'dd'T'HH':'mm':'ss'Z'", DateTimeFormatInfo.InvariantInfo) 
```

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2012-09-12T10:12:02.593

> `"s"`标准格式说明符表示由[DateTimeFormatInfo.SortableDateTimePattern](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.sortabledatetimepattern.aspx)属性定义的自定义日期和时间格式字符串。该模式反映了定义的标准 ( **ISO 8601** )，并且该属性是只读的。因此，无论使用的文化或提供的格式提供程序如何，它总是相同的。自定义格式字符串是`"yyyy'-'MM'-'dd'T'HH':'mm':'ss"`.
> 
> 使用此标准格式说明符时，格式化或解析操作始终使用不变区域性。

– 来自[MSDN](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx#Sortable)

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2017-05-04T22:21:24.513

有趣的是，自定义格式“yyyy-MM-ddTHH:mm:ssK”（没有 ms）是最快的格式方法。

有趣的是，“S”格式在 Classic 上速度很慢，在 Core 上速度很快......

当然数字非常接近，某些行之间的差异是微不足道的（带后缀的测试与`_Verify`没有后缀的测试相同，证明了结果的可重复性）

```
BenchmarkDotNet=v0.10.5, OS=Windows 10.0.14393
Processor=Intel Core i5-2500K CPU 3.30GHz (Sandy Bridge), ProcessorCount=4
Frequency=3233539 Hz, Resolution=309.2587 ns, Timer=TSC
  [Host] : Clr 4.0.30319.42000, 64bit RyuJIT-v4.6.1637.0
  Clr    : Clr 4.0.30319.42000, 64bit RyuJIT-v4.6.1637.0
  Core   : .NET Core 4.6.25009.03, 64bit RyuJIT

               Method |  Job | Runtime |       Mean |     Error |    StdDev |     Median |        Min |        Max | Rank |  Gen 0 | Allocated |
--------------------- |----- |-------- |-----------:|----------:|----------:|-----------:|-----------:|-----------:|-----:|-------:|----------:|
           CustomDev1 |  Clr |     Clr | 1,089.0 ns | 22.179 ns | 20.746 ns | 1,079.9 ns | 1,068.9 ns | 1,133.2 ns |    8 | 0.1086 |     424 B |
           CustomDev2 |  Clr |     Clr | 1,032.3 ns | 19.897 ns | 21.289 ns | 1,024.7 ns | 1,000.3 ns | 1,072.0 ns |    7 | 0.1165 |     424 B |
     CustomDev2WithMS |  Clr |     Clr | 1,168.2 ns | 16.543 ns | 15.474 ns | 1,168.5 ns | 1,149.3 ns | 1,189.2 ns |   10 | 0.1625 |     592 B |
              FormatO |  Clr |     Clr | 1,563.7 ns | 31.244 ns | 54.721 ns | 1,532.5 ns | 1,497.8 ns | 1,703.5 ns |   14 | 0.2897 |     976 B |
              FormatS |  Clr |     Clr | 1,243.5 ns | 24.615 ns | 31.130 ns | 1,229.3 ns | 1,200.6 ns | 1,324.2 ns |   13 | 0.2865 |     984 B |
       FormatS_Verify |  Clr |     Clr | 1,217.6 ns | 11.486 ns | 10.744 ns | 1,216.2 ns | 1,205.5 ns | 1,244.3 ns |   12 | 0.2885 |     984 B |
        CustomFormatK |  Clr |     Clr |   912.2 ns | 17.915 ns | 18.398 ns |   916.6 ns |   878.3 ns |   934.1 ns |    4 | 0.0629 |     240 B |
 CustomFormatK_Verify |  Clr |     Clr |   894.0 ns |  3.877 ns |  3.626 ns |   893.8 ns |   885.1 ns |   900.0 ns |    3 | 0.0636 |     240 B |
           CustomDev1 | Core |    Core |   989.1 ns | 12.550 ns | 11.739 ns |   983.8 ns |   976.8 ns | 1,015.5 ns |    6 | 0.1101 |     423 B |
           CustomDev2 | Core |    Core |   964.3 ns | 18.826 ns | 23.809 ns |   954.1 ns |   935.5 ns | 1,015.6 ns |    5 | 0.1267 |     423 B |
     CustomDev2WithMS | Core |    Core | 1,136.0 ns | 21.914 ns | 27.714 ns | 1,138.1 ns | 1,099.9 ns | 1,200.2 ns |    9 | 0.1752 |     590 B |
              FormatO | Core |    Core | 1,201.5 ns | 16.262 ns | 15.211 ns | 1,202.3 ns | 1,178.2 ns | 1,225.5 ns |   11 | 0.0656 |     271 B |
              FormatS | Core |    Core |   993.5 ns | 19.272 ns | 24.372 ns |   999.4 ns |   954.2 ns | 1,029.5 ns |    6 | 0.0633 |     279 B |
       FormatS_Verify | Core |    Core | 1,003.1 ns | 17.577 ns | 16.442 ns | 1,009.2 ns |   976.1 ns | 1,024.3 ns |    6 | 0.0674 |     279 B |
        CustomFormatK | Core |    Core |   878.2 ns | 17.017 ns | 20.898 ns |   877.7 ns |   851.4 ns |   928.1 ns |    2 | 0.0555 |     215 B |
 CustomFormatK_Verify | Core |    Core |   863.6 ns |  3.968 ns |  3.712 ns |   863.0 ns |   858.6 ns |   870.8 ns |    1 | 0.0550 |     215 B | 
```

代码：

```
 public class BenchmarkDateTimeFormat
    {
        public static DateTime dateTime = DateTime.Now;

        [Benchmark]
        public string CustomDev1()
        {
            var d = dateTime.ToUniversalTime();
            var sb = new StringBuilder(20);

            sb.Append(d.Year).Append("-");
            if (d.Month <= 9)
                sb.Append("0");
            sb.Append(d.Month).Append("-");
            if (d.Day <= 9)
                sb.Append("0");
            sb.Append(d.Day).Append("T");
            if (d.Hour <= 9)
                sb.Append("0");
            sb.Append(d.Hour).Append(":");
            if (d.Minute <= 9)
                sb.Append("0");
            sb.Append(d.Minute).Append(":");
            if (d.Second <= 9)
                sb.Append("0");
            sb.Append(d.Second).Append("Z");
            var text = sb.ToString();
            return text;
        }

        [Benchmark]
        public string CustomDev2()
        {
            var u = dateTime.ToUniversalTime();
            var sb = new StringBuilder(20);
            var y = u.Year;
            var d = u.Day;
            var M = u.Month;
            var h = u.Hour;
            var m = u.Minute;
            var s = u.Second;
            sb.Append(y).Append("-");
            if (M <= 9)
                sb.Append("0");
            sb.Append(M).Append("-");
            if (d <= 9)
                sb.Append("0");
            sb.Append(d).Append("T");
            if (h <= 9)
                sb.Append("0");
            sb.Append(h).Append(":");
            if (m <= 9)
                sb.Append("0");
            sb.Append(m).Append(":");
            if (s <= 9)
                sb.Append("0");
            sb.Append(s).Append("Z");
            var text = sb.ToString();
            return text;
        }

        [Benchmark]
        public string CustomDev2WithMS()
        {
            var u  = dateTime.ToUniversalTime();
            var sb = new StringBuilder(23);
            var y  = u.Year;
            var d  = u.Day;
            var M  = u.Month;
            var h  = u.Hour;
            var m  = u.Minute;
            var s  = u.Second;
            var ms = u.Millisecond;
            sb.Append(y).Append("-");
            if (M <= 9)
                sb.Append("0");
            sb.Append(M).Append("-");
            if (d <= 9)
                sb.Append("0");
            sb.Append(d).Append("T");
            if (h <= 9)
                sb.Append("0");
            sb.Append(h).Append(":");
            if (m <= 9)
                sb.Append("0");
            sb.Append(m).Append(":");
            if (s <= 9)
                sb.Append("0");
            sb.Append(s).Append(".");
            sb.Append(ms).Append("Z");
            var text = sb.ToString();
            return text;
        }
        [Benchmark]
        public string FormatO()
        {
            var text = dateTime.ToUniversalTime().ToString("o");
            return text;
        }
        [Benchmark]
        public string FormatS()
        {
            var text = string.Concat(dateTime.ToUniversalTime().ToString("s"),"Z");
            return text;
        }

        [Benchmark]
        public string FormatS_Verify()
        {
            var text = string.Concat(dateTime.ToUniversalTime().ToString("s"), "Z");
            return text;
        }

        [Benchmark]
        public string CustomFormatK()
        {
            var text = dateTime.ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ssK");
            return text;
        }

        [Benchmark]
        public string CustomFormatK_Verify()
        {
            var text = dateTime.ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ssK");
            return text;
        }
    } 
```

使用了[https://github.com/dotnet/BenchmarkDotNet](https://github.com/dotnet/BenchmarkDotNet)

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2019-05-20T07:23:59.233

使用 Newtonsoft.Json，你可以做到

```
JsonConvert.SerializeObject(DateTime.UtcNow) 
```

示例：[https ://dotnetfiddle.net/O2xFSl](https://dotnetfiddle.net/O2xFSl)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2013-03-27T10:17:13.423

如果您在[SharePoint 2010](https://en.wikipedia.org/wiki/SharePoint#Notable_changes_in_SharePoint_2010)或更高版本下进行开发，您可以使用

```
using Microsoft.SharePoint;
using Microsoft.SharePoint.Utilities;
...
string strISODate = SPUtility.CreateISO8601DateTimeFromSystemDateTime(DateTime.Now) 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2018-06-22T13:22:18.367

要像**2018-06-22T13:04:16**这样可以在 API 的 URI 中传递的格式，请使用：

```
public static string FormatDateTime(DateTime dateTime)
{
    return dateTime.ToString("s", System.Globalization.CultureInfo.InvariantCulture);
} 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2019-09-06T16:33:14.883

如其他答案所述，`DateTime`设计存在问题。

## 野田时间

我建议使用[NodaTime](https://nodatime.org/)来管理日期/时间值：

*   本地时间、日期、日期时间
*   全球时间
*   时区时间
*   时期
*   期间

### 格式化

因此，要创建和格式化`ZonedDateTime`，您可以使用以下代码片段：

```
var instant1 = Instant.FromUtc(2020, 06, 29, 10, 15, 22);

var utcZonedDateTime = new ZonedDateTime(instant1, DateTimeZone.Utc);
utcZonedDateTime.ToString("yyyy-MM-ddTHH:mm:ss'Z'", CultureInfo.InvariantCulture);
// 2020-06-29T10:15:22Z

var instant2 = Instant.FromDateTimeUtc(new DateTime(2020, 06, 29, 10, 15, 22, DateTimeKind.Utc));

var amsterdamZonedDateTime = new ZonedDateTime(instant2, DateTimeZoneProviders.Tzdb["Europe/Amsterdam"]);
amsterdamZonedDateTime.ToString("yyyy-MM-ddTHH:mm:ss'Z'", CultureInfo.InvariantCulture);
// 2020-06-29T12:15:22Z 
```

对我来说，`NodaTime`代码看起来很冗长。但是类型真的很有用。它们有助于正确处理日期/时间值。

### 牛顿软件.Json

> 要与您一起使用`NodaTime`，`Newtonsoft.Json`您需要添加对`NodaTime.Serialization.JsonNet`NuGet 包的引用并配置 JSON 选项。

```
services
    .AddMvc()
    .AddJsonOptions(options =>
    {
        var settings=options.SerializerSettings;
        settings.DateParseHandling = DateParseHandling.None;
        settings.ConfigureForNodaTime(DateTimeZoneProviders.Tzdb);
    }); 
```

# php - PHP 和 MS 访问

> ID：114996
> 
> 赞同：0
> 
> 时间：2008-09-22T13:58:50.647
> 
> 标签：php, ms-access

我们如何将`PHP`脚本连接到`MS Access (.mdb)`文件？

我尝试包含以下`PHP`代码：

```
$db_path = $_SERVER['DOCUMENT_ROOT'] . '\WebUpdate\\' . $file_name . '.mdb';
$cfg_dsn = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" . $db_path;
$odbcconnect = odbc_connect($cfg_dsn, '', ''); 
```

但它失败了，我收到以下错误消息：

```
 Warning: odbc_connect() [function.odbc-connect]: SQL error: [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified, SQL state IM002 in SQLConnect in C:\web\WebUpdate\index.php on line 41 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-22T14:02:12.917

这是一个连接示例和一个简单的选择...

```
<?php
$db_conn = new COM("ADODB.Connection");
$connstr = "DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=". realpath("./Northwind.mdb").";";
$db_conn->open($connstr);
$rS = $db_conn->execute("SELECT * FROM Employees");
$f1 =  $rS->Fields(0);
$f2 =  $rS->Fields(1);
while (!$rS->EOF)
{
    print $f1->value." ".$f2->value."<br />\n";
    $rS->MoveNext();
}
$rS->Close();
$db_conn->Close();
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T14:05:18.150

在文件名中，我正在查看 '\WebUpdate\' - 看起来您的开头有一个反斜杠，结尾有两个。您可能在开头缺少反斜杠吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T14:06:00.473

```
$db_path = $_SERVER['DOCUMENT_ROOT'] . '\WebUpdate\\' . $file_name . '.mdb'; 
```

用斜杠替换反斜杠 use . '/WebUpdate/' 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T14:09:42.617

看起来路径分隔符有问题。ISTR 你必须通过反斜杠而不是正斜杠

以下对我有用 - 在 webroot 中有一个名为 db4 的 MDB 文件

```
    $defdir = str_replace("/", "\\", $_SERVER["DOCUMENT_ROOT"]);
    $dbq = $defdir 。"\\db4.mdb";
if (!file_exists($dbq)) { die("数据库文件 $dbq 不存在"); }

    $dsn = "DRIVER=Microsoft Access 驱动程序 (*.mdb);UID=admin;UserCommitSync=Yes;Threads=3;SafeTransactions=0;PageTimeout=5;MaxScanRows=8;MaxBufferSize=2048;FIL=MS Access;DriverId= 25;DefaultDir=$defdir;DBQ=$dbq";
    $odbc_conn = odbc_connect($dsn,"","")
        or die("Could not connect to Access database $dsn");

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T14:28:45.113

我不确定这是否违反了最佳实践或安全性，但我想放弃这个建议：

设置 ODBC 连接并在 odbc 高级设置中包含数据库的密码。给 odbc conn 一个 DSN 名称，然后保存。

在您的代码中，只需设置如下连接：

```
try {
  $conn = @odbc_connect("DSNName", "", "", "SQL_CUR_USE_ODBC");
  // un and pw parameters are passed as empty strings since the DSN 
  // has knowledge of the password already.
  // 4th parameter is optional

  $exec = @odbc_exec($conn, $insert) or die ("exec error");
  echo "success!";
}
catch (Exception $e) {
  echo $e->getMessage();
} // end try catch 
```******``