# StackOverflow 问答 12117000-12117999

# django - 在 django 中检索图像，在 django 中更新/替换图像

> ID：12117001
> 
> 赞同：2
> 
> 时间：2012-08-24T21:38:35.347
> 
> 标签：django, image, django-models

嗨，我在模型的帮助下使用我的 django 项目保存了一张图像

```
 Image =  models.ImageField(upload_to="images/profileimages/")
    name = models.CharFiled(max_length=20) 
    #rest of the fileds. 
```

保存此信息后，我想更改/更新它。为此，我使用了一个视图作为

```
 def Information_change(request):
       instance = get_object_or_404(information,pk=request.user.id)
         if request.method == 'POST':
              iform = informationForm(instance=instance, data=request.POST,          files=request.FILES)
               if iform.is_valid():
                     instance = iform.save()
                     return HttpResponseRedirect('/')
    else:
         iform = informationForm(instance=instance)
         return render_to_response('registration/information_change.html',{'iform':iform}, RequestContext(request)) 
```

在我的模板中，我正在获取相关字段中的所有信息，例如名称字段包含我的姓名，并且所有字符字段都显示信息，但图像文件未显示图像/路径或任何其他内容。其余字段可以更改，我可以编辑我的姓名文件，但无法使用此代码替换/更改图像。我怎样才能解决这个问题。任何帮助将不胜感激。我的 .html 文件包含

```
 {% block content %}
{% if iform.errors %}
    <p style="color: red;">
    Please correct the error{{ iform.errors|pluralize }} below.
    </p>
{% endif %}
<form method="post" action=".", enctype="multipart/form-data>
    {{ iform.as_p }}    
    <input type="submit" value="Submit" />
</form> 
```

{% 端块 %}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T04:00:13.937

`form`我在您的标签中看到 2 个问题：

*   逗号 ',' 在*操作*属性之后
*   `enctype`属性值没有结束引号

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T09:19:14.337

首先做你`@Rohan`建议的事情。在您看来，您有一个错误，如果您的表单无效怎么办？那么您`view`将不会返回 an ，`HTTP response`因为您尚未处理该问题。只需删除以下两行的`else`of`if request.Method == 'POST'`和缩进：

```
iform = informationForm(instance=instance)
return render_to_response('registration/information_change.html',{'iform':iform}, RequestContext(request)) 
```

这将修复我提到的错误。可能会显示一些与图像字段相关的表单错误。

# vb.net - VB.Net - 删除 image.PropertyItems 数据

> ID：12117008
> 
> 赞同：0
> 
> 时间：2012-08-24T21:39:18.560
> 
> 标签：vb.net, image, metadata

如何成功删除图像属性项？我尝试加载图像，然后使用 image.ProperyIdList 循环，然后调用 .RemovePropertyItem 然后将图像保存到新文件，但新文件仍然包含所有元数据。我还尝试将每个 propertyItem.value 的所有字节归零，但这会在我保存时导致通用 gdi+ 错误。我还尝试将图像推入内存流并返回，认为它会清除元数据。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T19:26:58.637

通过使用下面的代码，我能够完成以下操作。它不是最快的，但它确实有效。我基本上剥离了我想要的元数据，然后为网络创建一个没有属性的新图像，从而确保个人数据不在照片中。

```
Using img As Image = Image.FromFile(fileName)
            Using newImage As New Bitmap(img.Width, img.Height)

                Using gr As Graphics = Graphics.FromImage(newImage)
                    gr.InterpolationMode = Drawing2D.InterpolationMode.Bilinear
                    gr.DrawImage(img, New Rectangle(0, 0, img.Width, img.Height))
                End Using
                newImage.Save(newFileName)
            End Using
        End Using 
```

# solr - 替换 SOLR 输出字段值

> ID：12117011
> 
> 赞同：0
> 
> 时间：2012-08-24T21:39:20.983
> 
> 标签：solr

我在下面提到了 SOLR 查询，它工作正常。

*查询*：“复杂条件 1”或*查询*：“复杂条件 2”

我在结果中得到 4 个文档 - 来自 condition1 的 2 个和来自 condition2 的 2 个。我需要知道文件属于哪个条件。我无法从结果中弄清楚，因为条件太复杂了。我想要做的是更改输出中“状态”字段的值。可以说，对于条件 1，状态 = 活动，对于条件 2，状态 = 已过期。

状态的当前值不准确，因为状态是根据我使用的条件决定的。

有没有办法覆盖 SOLR 中任何字段的输出值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T03:19:14.737

您是否尝试过使用突出显示来确定哪些文档符合哪个条件？如果您打开突出显示 ( `&hl=on&hl.fl=<fields_you're_trying_to_match>`)，则 Solr 将在结果结构的末尾返回一个称为“突出显示”的结构（无论您是返回 JSON 还是 XML 格式的结果）。反过来，此结构将包含根据索引的唯一键（如果有的话）命名的结构，其中包含匹配的元素。

```
<lst name="highlighting">
    <lst name="1">
        <arr name="title">
            <str>Bob <em>Jones</em></str>
        </arr>
        <arr name="category">
            <str><em>Jones</em> Family</str>
        </arr>
        <arr name="description">
            <str>This is a book about Bob <em>Jones</em>, the patriarch of the <em>Jones</em> Family.</str>
        </arr>
    <lst>
<lst> 
```

更多信息： [如何返回与 Solr 中的查询匹配的列..？](https://stackoverflow.com/questions/9629147/how-to-return-column-that-matched-the-query-in-solr)

现在我很抱歉，这并没有回答您问题的后半部分，但为您提供了第一部分的帮助。

# powershell - 如何使用 powershell 脚本检索 Outlook 2010 配置文件？

> ID：12117012
> 
> 赞同：0
> 
> 时间：2012-08-24T21:39:23.863
> 
> 标签：powershell, outlook, mapi

如何使用 powershell 脚本检索 Outlook 2010 配置文件？

通过在脚本中使用 MAPI 函数

```
ProviderAdmin.GetProviderTable
ProviderAdmin.OpenProfileSection 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T06:38:23.427

您可以使用[Profman](http://www.dimastr.com/redemption/profman.htm) ( [http://www.dimastr.com/redemption/profman.htm](http://www.dimastr.com/redemption/profman.htm) ) - 它带有 Redemption 的可分发版本。

# java - Grails 2.1.0 不自动重新加载/自动重新编译

> ID：12117013
> 
> 赞同：7
> 
> 时间：2012-08-24T21:39:25.813
> 
> 标签：java, grails

似乎 Grails 会自动重新编译我的 GSP 页面，但不会自动重新编译我的控制器。它曾经与以前版本的 Grails 一起工作。知道我可以寻找什么吗？

在 OSX Snow Leopard 上使用 Grails 2.1.0。

注意：这与[此问题类似](http://jira.grails.org/browse/GRAILS-8951)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T18:23:20.790

免责声明：自动重新加载在我的 Mac 上一直对我有用。

我发现了一些可能有用的东西。

首先，运行自定义环境（不是开发环境）似乎会禁用自动重新加载（[请参阅此 stackoverflow 帖子](https://stackoverflow.com/questions/1325734/grails-auto-reload-functionality-in-run-app-on-a-custom-environment "看到这个stackoverflow帖子")），因此如果您以这种方式运行应用程序，则需要按照该帖子中的说明进行操作。

其次，如果您将应用程序作为战争运行，请确保自动重新加载已关闭。（[请参阅 Grails 自动重新加载页面](http://grails.org/Auto+Reloading "Grails 自动重新加载文档")）

第三，我发现使用 Grails IDE（例如 IntelliJ 或 SpringSource）确实为 Grails 开发环境增加了很多稳定性。例如，IntelliJ 不使用二进制下载附带的 Grails shell 文件。它手动调用 Grails jar 和引导程序。

我对你的问题是：

您的其他环境是什么样的？您如何运行您的应用程序（run-app 或其他容器）？

你安装了哪些 Grails 插件（Grails 文档说 tomcat 插件配置为优化自动重新加载）？

您的计算机上是否下载了任何其他 Grails 二进制文件（在尝试加载时可能会导致混淆）？

最后，您是否能够在干净的环境中重现此问题（即新的 Grails 二进制文件、新的 Grails 创建应用程序）？

我还建议阅读 Grails 文档的部署部分（[在此处找到](http://grails.org/doc/latest/guide/deployment.html "Grails 部署文档")）。它有一些关于重新加载的相关信息。

对于冗长且可能没有回答的答案，我深表歉意，但我希望这引发了一两个想法。让我知道事情的结果！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-24T15:54:28.137

如果您在控制器上错误地命名包名称（如文件夹结构与包声明不一致），应用程序仍将运行并且不会报告错误，但自动重新加载将不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-25T08:10:44.900

当我有一个从中派生其他控制器的 BaseController 类时，我遇到了这个问题。如果我对 BaseController 类进行更改，例如添加方法或闭包、更改方法名称、导入一些类等，Grails 中的整个类重新加载功能将停止运行。

**对我有用的唯一解决方案是删除编译所有类的目标目录**。至少这样我就不必每次都重新启动服务器，这让我不必等待大约 30 秒来显示起始页面。当类重新加载功能无法按预期工作时，这可能会很烦人。

Grails 自动重新加载功能并非没有怪癖。其中一些怪癖最终与 java 以及类加载在 servlet 容器环境中的工作方式有关。我希望 Grails 团队将优先考虑为 Grails 提供无缝的类重载，就像其他脚本环境（ruby、PHP、python 或 play 框架）一样，因为处理这个框架的其他一些方面非常有趣。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-09T13:50:49.357

奇怪，我从来没有遇到过这个问题。你确定你的控制器编译正确，没有错别字吗？我发现通常只需要一两秒钟就能看到控制器中反映的变化。域对象更改需要重新启动（它们通常会擦除您保存的数据），我发现*有时*对 Spring 托管资源（如注入服务）的更改不会“采取”。但是控制器和 GSP 页面在 97% 的时间内重新编译 :)

我在 GGTS (eclipse) 和命令行运行应用程序之间切换，它几乎总是对我有用。您是否正在做任何类型的缓存？我在 Lion 上运行 JDK 1.6，grails 2.1.1

通常你会看到输出告诉你文件已经在点击保存后的一两秒内重新编译。

# concurrency - SQLite中并发读/写和读的策略

> ID：12117016
> 
> 赞同：11
> 
> 时间：2012-08-24T21:39:43.753
> 
> 标签：concurrency, sqlite

我有一个 SQLite 数据库，我在进程 A 中保持打开并写入它。我希望能够在进程 B 中以只读方式使用它。

根据[文件](http://www.sqlite.org/lockingv3.html)，

*   如果数据库未锁定，则可能无法读取（或写入）数据库 -**不合适**
*   如果数据库是共享的，那么两个进程可以读取它但第一个不能写入 -**不合适**
*   如果一个进程想要写它需要一个独占锁，这意味着没有其他进程可以写 -**不合适**

进程 A 将进行大量小写入，因此我认为在每个事务提交上制作副本不会是有效的。

我能看到的唯一方法是让读者等到数据库进入 UNLOCKED 状态，在读取期间获得一个 SHARED 锁，然后释放它。同时，进程 A 将要写入并将被阻塞，直到锁可用 - 如果它曾经可用（如果进程 B 崩溃怎么办？）。这意味着进程 A 和进程 B 将争夺锁 - B 想要 SHARED 而 A 想要 EXCLUSIVE，这会减慢速度甚至导致并发问题。

有什么方法可以实现我的同时写作和阅读的目标吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-24T23:32:25.447

使用[WAL 模式](http://www.sqlite.org/wal.html)。它支持并发读取器和一个写入器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-17T09:48:33.283

至于 Android，您可以使用 WAL 模式。API 11 （严重）支持它。更好的支持从 API 16 开始。使用此代码将您的数据库连接切换到 WAL 模式：

```
int flags = SQLiteDatabase.CREATE_IF_NECESSARY;
if(walModeEnabled) {
   if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {
       flags = flags | SQLiteDatabase.ENABLE_WRITE_AHEAD_LOGGING;
   }
}

SQLiteDatabase db = SQLiteDatabase.openDatabase(databasePath.getPath(), null, flags);

// backward compatibility hack to support WAL on pre-jelly-bean devices
if(walModeEnabled) {
   if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB &&
           Build.VERSION.SDK_INT < Build.VERSION_CODES.JELLY_BEAN) {
       db.enableWriteAheadLogging();
   } else {
       Log.w(TAG, "WAL is not supported on API levels below 11.");
   }
} 
```

有关 SQLiteOpenHelper 和更深入的解释 WAL 模式如何在后台工作，请参阅我的文章：

[https://www.skoumal.net/en/parallel-read-and-write-in-sqlite/](https://www.skoumal.net/en/parallel-read-and-write-in-sqlite/)

* * *

## 回答 #3

> 赞同：-7
> 
> 时间：2014-06-04T13:32:14.693

您的问题的简单答案是 - “不可能”

即使你成功了 - 意味着你得到了错误的结果。

我认为您应该了解数据库的基础知识-

为什么数据库比文件处理和其他数据存储方法更好。

简单的回答——

您不能同时执行 WW、WR、RW 操作。

（W-写，R-读）

但是，您可以同时执行无限 RR 操作。

想想网上银行系统或铁路预订系统。

其中使用了数据库的一个特殊功能，即事务。

它遵循酸。

即原子性、一致性、隔离性、持久性。

原子性 - 完整或不完整。

一致性 - 在每个事务系统将从一个一致状态转到另一个一致状态之后。

隔离 - 每个事务都将彼此隔离执行。

（意味着如果写查询首先出现，它将首先执行）没有办法同时进行写和读操作。即使有纳秒的差异系统也会检测到它。但是，如果您成功的话。db 简单地拒绝它或执行具有更高优先级的操作。

耐用性 - 系统必须及时耐用。

--也许它比一个简单的数据库非常广泛，但它可能会帮助你理解。--

2.

SQLite 数据库文件被组织为页面。每页的大小是 512 和 SQLITE_MAX_PAGE_SIZE 之间的 2 的幂。SQLITE_MAX_PAGE_SIZE 的默认值为 32768。

SQLITE_MAX_PAGE_COUNT 参数通常设置为 1073741823，是单个数据库文件中允许的最大页数。尝试插入会导致数据库文件变得大于此大小的新数据将返回 SQLITE_FULL。

所以我们有 32768 * 1073741823，即 35,184,372,056,064（35 万亿字节）！

您可以在源代码中修改 SQLITE_MAX_PAGE_COUNT 或 SQLITE_MAX_PAGE_SIZE，但这当然需要为您的应用程序自定义构建 SQLite。据我所知，除了在编译时，没有办法以编程方式设置限制（但我很高兴被证明是错误的）。

# javascript - 如何将 jQuery each() 变成常规的 javascript 循环

> ID：12117018
> 
> 赞同：12
> 
> 时间：2012-08-24T21:40:06.047
> 
> 标签：javascript, loops, jquery

几个问题：

1.  常规的 javascript 循环（循环一系列元素）是否比使用 jQuery 更快/更有效`each()`？

2.  如果是这样，将以下代码编写为常规 javascript 循环的最佳方法是什么？

`$('div').each(function(){ //... })`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-24T21:42:10.837

是的，删除`each()`会给您带来更好的性能。这就是您可以为元素列表编写 for 循环的方式。

```
var divs = $('div');

for(var i = 0; i < divs.length; i++){
    var thisDiv = divs[i]; // element

    var $thisDiv = $(divs[i]); // jquery object

    // do stuff
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-24T21:44:01.180

```
var divs = document.getElementsByTagName('div'),
    l = divs.length, i, cur;

for(i=0; i<l; i++) {
    cur = divs[i];
    // do stuff with cur here
} 
```

请继续以效率的名义删除 jQuery。这段代码比 jQuery 等价代码快大约 50 倍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-20T10:55:51.623

回答你的第二个问题，因为第一个问题已经被回答；

我对此也很感兴趣，因此决定使用 Gabe 的示例对两者进行基准测试以找出差异。答案是，在想要一个 jQuery 对象作为最终结果的情况下：

它们的表现完全相同。

[http://jsperf.com/jquery-each-vs-native-selectors](http://jsperf.com/jquery-each-vs-native-selectors)

显然，Firefox 实际上更快地找到了 jQuery 版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-20T12:10:24.203

而不是使用jquery`.each()`

```
$('div').each(function(){ //... }) 
```

您可以使用`document.querySelectorAll()`，然后将 HTMLCollection 转换为 JavaScript 数组。然后，您可以映射元素数组。

```
 const elems = document.querySelectorAll('.my-elements')
 const $elems = [].slice.call(elems)
 $elems.map( (elem) => { console.log(elem) }) 
```

# jquery - 如何优先于 SQL 中的一条 like 语句

> ID：12117019
> 
> 赞同：0
> 
> 时间：2012-08-24T21:40:06.547
> 
> 标签：jquery, mysql, sql, search, sql-like

我正在构建一个搜索框，用于查询数据库并自动填充下面的建议。

我希望能够按以下顺序对结果进行优先排序：

**1 - 完全匹配**

**2 - 以相同的几个字母开头**

**3 - 包含数据库中某处的字符串**

我有一条 SQL 语句

```
SELECT * 
FROM Products 
WHERE ProductName LIKE ? 
OR ProductName LIKE ? 
GROUP BY ProductName 
ORDER BY ProductName ASC 
LIMIT 10 
```

在搜索单词“computer”的示例中

键入“co”时应显示

*   **可可**_
*   **电脑**_
*   **电脑**桌
*   帐户**_** _

但是当进一步搜索“计算机”时

*   **电脑**
*   **电脑**桌

第一个绑定参数包含 %computer%，第二个包含 c%computer%

感谢您的帮助，如果您需要任何澄清，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T21:55:49.857

```
SELECT * FROM Products WHERE ProductName = ? LIMIT 10 UNION
SELECT * FROM Products WHERE ProductName LIKE ? LIMIT 10 UNION
SELECT * FROM Products WHERE ProductName LIKE ? LIMIT 10 
```

这很好用，第一个？持有'co'第二个？持有 'co%' 和第三个？持有“%co%”

这首先优先考虑精确匹配，然后从字符串开始，然后包含字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T21:53:47.603

在 MYSQL 中使用[UNION](http://dev.mysql.com/doc/refman/5.0/en/union.html)为您的条件组合每个单独的查询。拥有一个可以让您进入前 10 名的超级选择。

```
select * 
from (
  -- exact macth
  SELECT 1 as prio, *  
  FROM Products  
  WHERE ProductName = ?  
  GROUP BY ProductName  
  ORDER BY ProductName ASC  
  LIMIT 10 
  UNION
  -- start with
  SELECT 2 as prio, *  
  FROM Products  
  WHERE ProductName LIKE ?*  
  GROUP BY ProductName  
  ORDER BY ProductName ASC  
  LIMIT 10 
  UNION
  -- anywhere -- 
  SELECT 3 as prio, *  
  FROM Products  
  WHERE ProductName LIKE *?*  
  GROUP BY ProductName  
  ORDER BY ProductName ASC  
  LIMIT 10 
)
ORDER BY prio, ProductName ASC  
LIMIT 10 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T22:40:22.570

不知道这是否可行，因为我不是 SQL-Guru，而且我从未使用过 MySQL，但如果你看看这篇文章

[SQL: ORDER BY 在特定列中使用子字符串...可能吗？](https://stackoverflow.com/questions/8187828/sql-order-by-using-a-substring-within-a-specific-column-possible)

也许这样的事情会起作用：

```
ORDER BY
CAST(SUBSTRING(ProductName, 1, @ProductName.Count()) AS INT) DESC,  -- Year
CASE
    WHEN issue LIKE @productName THEN 1
    WHEN issue LIKE @productName + '%' THEN 2
    WHEN issue LIKE '%' + @productName THEN 3
END
LIMIT 10 
```

无论如何祝你好运，希望你能解决问题！对我来说太晚了，所以上床睡觉，如果它不起作用，我明天也会试试我的大脑是否正常工作，如果你还没有解决它:)

# asp.net-mvc-2 - MVC 2 - 嵌入式资源是否需要 Sattelite 程序集？嵌入式资源不起作用

> ID：12117022
> 
> 赞同：1
> 
> 时间：2012-08-24T21:40:10.260
> 
> 标签：asp.net-mvc-2, localization, wix, wix3.5, satellite-assembly

您好，我一直在开发 MVC 2.0 Web 应用程序。这需要在两种语言之间切换。

现有解决方案效果不佳，因为 MVC [DisplayName] 属性和数据注释错误消息等无法正常工作，因为它们在 MVC 2.0 中不具备文化意识。

我在这里遵循了示例： [http://adamyan.blogspot.co.uk/2010/02/aspnet-mvc-2-localization-complete.html#!/2010/02/aspnet-mvc-2-localization-complete。 html](http://adamyan.blogspot.co.uk/2010/02/aspnet-mvc-2-localization-complete.html#!/2010/02/aspnet-mvc-2-localization-complete.html)

通过一些调整，它在我的 Visual Studio 环境中都能完美运行，并且现在可以切换语言并使用 MVC 显示名称等。我正在使用嵌入式资源并且有一个英文 resx 文件（例如 MyPage.resx）和文化版本（例如 MyPage.cy-GB.resx）。

问题是当我将它安装到生产环境中时，它不会切换语言。我很困惑，因为我认为这些嵌入式资源将是主 Web 应用程序 dll 的一部分，所以它应该可以轻松找到匹配的资源？

我知道这肯定会改变当前线程的文化。它只是没有加载匹配的资源。

该应用程序是使用 WIX 安装的，但我已包含所有文件（aspx 等）。以前它使用附属程序集并在 bin 文件夹中使用文化名称创建资源 dll。我删除了这个，因为我只是使用提到的嵌入式资源。卫星组件是否对此有要求？我很高兴他们被嵌入。

我真的很困惑如何解决这个问题，所以任何建议都会非常受欢迎。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T21:47:38.090

MyPage.cy-GB.resx 嵌入在附属程序集中。这是必要的，事实上嵌入式资源就是卫星程序集中的全部内容。

# android - Android 图标大小

> ID：12117023
> 
> 赞同：9
> 
> 时间：2012-08-24T21:40:21.133
> 
> 标签：android, android-ui

我知道有一些指南可以为 Android 中的特定区域（Tab、List 等）创建图标，以及如何根据 ldpi、mdpi、hdpi 等设置它们的大小。

关于如何缩放其他应用内图标是否有任何规则？

我在我的 mdpi 开发手机上使用了一个 10x10 像素的“小”图标，创建该图标的 ldpi、hdpi 和 xhdpi 版本的缩放规则是什么？

谢谢

戴夫

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-09-30T05:34:30.060

我会为每个创建单独的图像：

```
Res     Px     
ldpi    36 x 36
mdpi    48 x 48
hdpi    72 x 72
xhdpi   96 x 96
xxhdpi  144x144
xxxhdpi 192x192 
```

然后只需将它们中的每一个放在可绘制文件夹的单独茎中。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-24T21:43:31.700

比率为 0.75|1|1.33|1.5|2.|3.|4。（或 3:4:6:8:12:16）也就是说，对于您的 10x10px 位图，图形将是

```
ldpi    - 10x10 * 0.75 = 7x7
mdpi    - 10x10 * 1    = 10x10
tvdpi   - 10x10 * 1.33 = 13x13
hdpi    - 10x10 * 1.5  = 15x15
xhdpi   - 10x10 * 2    = 20x20
xxhdpi  - 10x10 * 3    = 30x30
xxxhdpi - 10x10 * 4    = 40x40 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-30T06:58:57.410

支持多个屏幕的像素值的通用规则基于设备屏幕密度的基线配置。密度为 160 像素的基线，mdpi 在此范围内。因此，通过计算 dpi 值，您可以将这些值放在不同的 dimens.xml 中以支持各种设备。一般公式为：

结果 = 值（dpi）* 设备密度（pi）/160（dpi）

所以首先检查你的设备密度，然后根据上面的公式计算dimens.xml的值。对于标准，我们通常假设：

对于 mdpi 密度 = 160，hdpi - 240，xhdpi - 320，ldpi - 120

与您的情况一样，如果值为 10*10，则不同屏幕的结果将是：

对于 ldpi：

结果 = 10*120/160 = 7.5 ，即 7 个​​像素

对于 mdpi：

结果 = 10*160/160 = 10 像素

对于 hdpi：

结果 = 10*240/160 = 15 像素

对于 xhdpi：

结果 = 10*320/160 = 20 像素

你也可以参考这个[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html) 和[http://developer.android.com/training/multiscreen/screendensities.html](http://developer.android.com/training/multiscreen/screendensities.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-16T08:54:55.247

根据 Android-Iconography 指南，图标应遵循 **2:3:4:6 的比例**，分别用于不同的屏幕密度，**中、高、x-high 和 xx-high**。

![在此处输入图像描述](../Images/06cec85caa73e307b2b88a3b09d39fa1.png)

您还可以查看 Android 设计指南以了解图标。[http://developer.android.com/design/style/iconography.html](http://developer.android.com/design/style/iconography.html)

# regex - 十进制数正则表达式，其中小数点后的数字是可选的

> ID：12117024
> 
> 赞同：139
> 
> 时间：2012-08-24T21:40:23.957
> 
> 标签：regex

我需要一个验证数字的正则表达式，但不需要小数点后的数字。IE。

```
123
123.
123.4 
```

都是有效的

```
123.. 
```

将是无效的

任何将不胜感激！

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2012-08-24T21:43:44.617

使用以下内容：

```
/^\d*\.?\d*$/ 
```

*   `^`- 行首；
*   `\d*`- 0 个或多个数字；
*   `\.?`- 一个可选的点（转义，因为在正则表达式中，`.`是一个特殊字符）；
*   `\d*`- 0 位或更多位（小数部分）；
*   `$`- 队伍的尽头。

这允许 0.5 小数，而不需要前导零，例如 0.5

* * *

## 回答 #2

> 赞同：138
> 
> 时间：2012-08-24T21:43:41.667

```
/\d+\.?\d*/ 
```

一位或多位数字 ( `\d+`)、可选句点 ( `\.?`)、零位或多位数字 ( `\d*`)。

根据您的使用情况或正则表达式引擎，您可能需要添加开始/结束行锚点：

```
/^\d+\.?\d*$/ 
```

![正则表达式可视化](../Images/0bdfa5e0d71f6a047798f1667eaf384b.png)

[调试演示](https://www.debuggex.com/r/4OwPfvp8lhwV_GZC)

* * *

## 回答 #3

> 赞同：90
> 
> 时间：2014-05-26T14:10:18.450

你需要一个像下面这样的正则表达式才能正确地做到这一点：

```
/^[+-]?((\d+(\.\d*)?)|(\.\d+))$/ 
```

带有空格的相同表达式，使用扩展修饰符（Perl 支持）：

```
/^  [+-]? ( (\d+ (\.\d*)?)  |  (\.\d+) ) $/x 
```

或评论：

```
/^           # Beginning of string
 [+-]?       # Optional plus or minus character
 (           # Followed by either:
   (           #   Start of first option
     \d+       #   One or more digits
     (\.\d*)?  #   Optionally followed by: one decimal point and zero or more digits
   )           #   End of first option
   |           # or
   (\.\d+)     #   One decimal point followed by one or more digits
 )           # End of grouping of the OR options
 $           # End of string (i.e. no extra characters remaining)
 /x          # Extended modifier (allows whitespace & comments in regular expression) 
```

例如，它将匹配：

*   123
*   23.45
*   34.
*   .45
*   -123
*   -273.15
*   -42。
*   -.45
*   +516
*   +9.8
*   +2。
*   +.5

并将拒绝这些非数字：

*   . （一个小数点）
*   -。（负小数点）
*   +。（加上小数点）
*   （空字符串）

更简单的解决方案可能会错误地拒绝有效数字或匹配这些非数字。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2013-09-05T11:11:33.743

这符合所有要求：

```
^\d+(\.\d+)?$ 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2012-08-24T21:43:33.820

试试这个正则表达式：

```
\d+\.?\d* 
```

> \d+ 可选小数之前的数字
> .? 可选小数（可选由于 ? 量词）
> \d* 小数后可选数字

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-02-11T22:24:11.377

我最终使用了以下内容：

```
^\d*\.?\d+$ 
```

这使得以下内容无效：

```
.
3. 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-11-06T09:45:03.457

你可以使用这个：

```
^\d+(\.\d)?\d*$ 
```

比赛：
11
11.1
0.2

不匹配：
.2
2\.
2.6.9

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-10-08T06:33:36.500

```
^[+-]?(([1-9][0-9]*)?[0-9](\.[0-9]*)?|\.[0-9]+)$ 
```

应该反映人们通常认为的格式良好的十进制数。

小数点前的数字可以是单个数字，在这种情况下可以是 0 到 9，也可以是多个数字，这种情况下不能以 0 开头。

如果小数点符号前有任何数字，则小数点及其后面的数字是可选的。否则，必须存在小数点后跟至少一位数字。请注意，小数点后允许有多个尾随 0。

```
grep -E '^[+-]?(([1-9][0-9]*)?[0-9](\.[0-9]*)?|\.[0-9]+)$' 
```

正确匹配以下内容：

```
9
0
10
10.
0.
0.0
0.100
0.10
0.01
10.0
10.10
.0
.1
.00
.100
.001 
```

以及它们的签名等价物，而它拒绝以下内容：

```
.
00
01
00.0
01.3 
```

及其签名的等价物，以及空字符串。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-02-07T21:27:31.980

这就是我所做的。它比上述任何一个都更严格（并且比某些更正确）：

```
^0$|^[1-9]\d*$|^\.\d+$|^0\.\d*$|^[1-9]\d*\.\d*$ 
```

通过的字符串：

```
0
0.
1
123
123.
123.4
.0
.0123
.123
0.123
1.234
12.34 
```

失败的字符串：

```
.
00000
01
.0.
..
00.123
02.134 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-08-24T21:50:21.847

什么语言？在 Perl 风格中：`^\d+(\.\d*)?$`

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-06-26T15:44:02.620

您所问的问题已经得到解答，因此如果输入可选小数点，这只是对于那些只想要 2 个小数位的人的附加信息：

```
^\d+(\.\d{2})?$ 
```

^ : 字符串的开头
\d : 一个数字 (等于 [0-9])
+ : 一次和无限次

正在捕获组 (.\d{2})？
? : 零次和一次。： 特点 。
\d : 一个数字 (等于 [0-9])
{2} : 正好是 2 倍
$ : 字符串结尾

1：匹配
123：匹配
123.00：匹配
123.：不匹配
123..：不匹配
123.0：不匹配
123.000：不匹配
123.00.00：不匹配

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-03-21T10:50:09.450

```
(?<![^d])\d+(?:\.\d+)?(?![^d]) 
```

干净简单。

这使用了后缀和前缀、RegEx 功能。

对于 IsMatch 条件，它直接返回 true - false

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-02-12T10:12:35.403

```
^\d+(()|(\.\d+)?)$ 
```

想出了这个。允许整数和小数，但如果您决定输入小数，则强制使用完整的小数（前导和尾随数字）。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-02-04T19:32:04.200

尝试这个。`^[0-9]\d{0,9}(\.\d{1,3})?%?$`它经过测试并为我工作。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-09-09T03:17:33.610

# 正则表达式：

```
^\d+((.)|(.\d{0,1})?)$ 
```

如果您想允许多于一个数字，请使用而不是`\d+`如果您想在昏迷后最多允许两个数字，请使用而不是。请参阅下面的示例以供参考：`\d{0,1}``\d{0,2}``\d{0,1}`

[![在此处输入图像描述](../Images/46b8b3adcf92e59b022bb87c21174f16.png)](https://i.stack.imgur.com/FrIpJ.png)

或者

```
^\d+((.)|(.\d{0,2})?)$ 
```

[![在此处输入图像描述](../Images/a868b9243f712ae43f232bbf533d827b.png)](https://i.stack.imgur.com/LyK6K.png)

或者

```
^\d+((.)|(.\d+)?)$ 
```

[![在此处输入图像描述](../Images/5bbeb2e90127c5948834b144be1ba7f3.png)](https://i.stack.imgur.com/1fu0t.png)

## 解释

`^` 断言行首的位置
`\d` 匹配一个数字（相当于 `[0-9]`）
`+` 匹配前一个标记一次到无限次，尽可能多次，返回为需要（贪婪）
第一个捕获组 `((.)|(.\d{0,1})?)`
第一个替代 `(.)`
第二个捕获组 `(.)`
`.` 匹配任何字符（除了行终止符)
2nd Alternative `(.\d{0,1})?`
3rd Capturing Group `(.\d{0,1})?`
`?` 匹配前一个标记 0 到 1 次，多次尽可能根据需要返回（贪婪）
`.` 匹配任何字符（行终止符除外）
`\d` 匹配数字（相当于 [0-9]）
`{0,1}` 匹配前一个标记 0 到 1 次，尽可能多次，根据需要返回（贪婪）
`$` 在行尾断言位置

## 沙盒

在这里玩正则表达式：[https ://regex101.com/](https://regex101.com/)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-09-05T12:08:07.207

在 Perl 中，使用 Regexp::Common 可以为您的特定数字格式组装一个经过微调的正则表达式。如果您不使用 Perl，生成的正则表达式通常仍然可以被其他语言使用。

打印在 Regexp::Common::Number 中生成示例正则表达式的结果：

```
$ perl -MRegexp::Common=number -E 'say $RE{num}{int}'
(?:(?:[-+]?)(?:[0123456789]+))

$ perl -MRegexp::Common=number -E 'say $RE{num}{real}'
(?:(?i)(?:[-+]?)(?:(?=[.]?[0123456789])(?:[0123456789]*)(?:(?:[.])(?:[0123456789]{0,}))?)(?:(?:[E])(?:(?:[-+]?)(?:[0123456789]+))|))

$ perl -MRegexp::Common=number -E 'say $RE{num}{real}{-base=>16}'
(?:(?i)(?:[-+]?)(?:(?=[.]?[0123456789ABCDEF])(?:[0123456789ABCDEF]*)(?:(?:[.])(?:[0123456789ABCDEF]{0,}))?)(?:(?:[G])(?:(?:[-+]?)(?:[0123456789ABCDEF]+))|)) 
```

# grails - 使用 Grails Resources 插件，如何根据用户的语言环境加载 Javascript 文件？

> ID：12117025
> 
> 赞同：2
> 
> 时间：2012-08-24T21:40:41.250
> 
> 标签：grails, localization, internationalization, grails-2.0

我正在使用带有 jQ​​uery 验证的 Grails Resources 插件。jQuery 验证具有声明为 JS 文件的特定于语言环境的文本：

```
/localization
    messages_ar.js
    messages_bg.js
    messages_ca.js 
```

等等等等。在我的`ApplicationResources.groovy`文件中，我声明了以下块：

```
form {
    resource url: '/js/jquery/jquery.validate.js'
    resource url: '/js/jquery/jquery.validate.additional-methods.js'
    resource url: '/js/jquery/localization/messages_es.js'
} 
```

但这是一个硬编码的值。有什么方法可以配置资源插件以根据用户的语言环境加载正确的 JS 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:44:15.150

以下是我过去的做法：

*   定义一些外部包并以接受语言标头结束它们（例如messages_en.js或messages_es.js）
*   在您布置资源时，您可以添加如下内容：

    <r:external uri="js/messages_${RequestContextUtils.getLocale(request).getLanguage()}.js"/>

这应该根据本地正确提取资源。

希望有帮助！

# android - 当启动活动在它仍在运行时停止/销毁时，AsyncTask 会发生什么？

> ID：12117031
> 
> 赞同：9
> 
> 时间：2012-08-24T21:41:05.727
> 
> 标签：android, android-asynctask, background-process, ui-thread

我见过几个几乎与我相同的问题，但我找不到满足我所有疑问的完整答案..所以我在这里..假设你有一个内部类的活动，它扩展了这样的`AsyncTask`类：

```
public class MyActivity extends Activity {            
    private class DownloadImageTask extends AsyncTask<String, Void, Bitmap> { 
        protected Bitmap doInBackground(String... urls) {
            return DownloadImage(urls[0]); 
        }
        protected void onPostExecute(Bitmap result) {
            ImageView img = (ImageView) findViewById(R.id.img); 
            img.setImageBitmap(result);
        }  
    }

    @Override
    public void onCreate(Bundle savedInstanceState) { 
        super.onCreate(savedInstanceState); 
        setContentView(R.layout.main);
        new DownloadImageTask().execute("http://mysite.com/image.png")
    }
} 
```

假设 Activity 暂停或销毁（可能两种情况不同），而 Activity`DownloadImageTask`仍在后台运行。那么，`DownloadImageTask`运行在 Activity UI 线程上的方法可以被触发，并且`DownloadImageTask`可能会尝试访问 Activity 的方法（它是一个内部类，因此它可以通过暂停或销毁的 Activity 访问外部类的方法和实例变量，就像`findViewByID`下面示例中的调用一样。然后会发生什么？它会默默地失败吗？它会产生任何异常吗？是否会通知用户出现问题？

如果我们应该注意在调用 UI 上运行的方法时启动线程（在本例中为 Activity）仍然处于活动状态，我们如何在`AsyncTask`?

如果您发现这是一个重复的问题，我很抱歉，但也许这个问题更加清晰，有人可以更详细地回答

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T16:10:18.690

考虑这个任务（其中 R.id.test 指的是我活动布局中的有效视图）：

```
public class LongTaskTest extends AsyncTask<Void, Void, Void>{
    private WeakReference<Activity> mActivity;
    public LongTaskTest(Activity a){
        mActivity = new WeakReference<Activity>(a);
    }
    @Override protected Void doInBackground(Void... params) {
        LogUtil.d("LongTaskTest.doInBackground()");
        SystemClock.sleep(5*60*1000);
        LogUtil.d("mActivity.get()==null " + (mActivity.get()==null));
        LogUtil.d("mActivity.get().findViewById(R.id.frame)==null " + (mActivity.get().findViewById(R.id.test)==null));
        return null;
    }
} 
```

如果我像这样从 Activity 的 onCreate 运行此任务：

```
public class Main extends Activity {
    @Override
    public void onCreate(Bundle state) {
        super.onCreate(state);
        setContentView(R.layout.testlayout);
        new LongTaskTest(this).execute();
        finish();
    }
} 
```

无论我在后台线程休眠多久，我的日志总是显示：

```
LongTaskTest.doInBackground()
mActivity.get()==null false
mActivity.get().findViewById(R.id.frame)==null false 
```

也就是说，活动及其视图似乎仍然存在（即使我通过 DDMS 手动发出 GC）。如果我有更多时间，我会查看内存转储，但否则我真的不知道*为什么*会这样......但在回答你的问题时，似乎：

*   它会默默地失败吗？不
*   它会产生任何异常吗？不
*   是否会通知用户出现问题？不

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-18T10:21:33.283

即使您的 Activity 被破坏（即您的主线程被破坏），doInBackground() 仍将继续运行，因为 doInBackground() 方法在工作线程/后台线程上运行。运行 onPostExecute() 方法会出现“问题”，因为它在主/UI 线程上运行，您可能会遇到不相关的数据，但不会向用户显示异常。因此，当您的活动被破坏时取消 AsyncTask 总是更好，因为当活动不再存在时没有理由运行 AsyncTask。如果即使组件/活动被破坏，您仍想继续从网络下载内容，请使用 android 服务。谢谢。

# python-c-extension - 从 python 调用遗留的 c 函数

> ID：12117032
> 
> 赞同：0
> 
> 时间：2012-08-24T21:41:20.900
> 
> 标签：python-c-extension

我想从 python 调用遗留的 c 第三方函数。我创建了一个 C api 来简化函数调用。在我的 python 文件中，我尝试为与旧代码库链接的 api 导入 *.so。但我一直看到 libxxx（遗留的 c 库）未找到错误。我尝试同时导入两者，但仍然看到相同的错误。然后我尝试使用 ctypes，但得到错误 ctypes not found。有什么建议么 ？

```
# python
Python 2.4.2 (#1, Apr 20 2012, 19:31:49)
[GCC 4.1.2 20070115 (SUSE Linux)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import ctypes
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
ImportError: No module named ctypes
>>> quit 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T21:47:04.327

[ctypes](http://docs.python.org/library/ctypes.html)仅在 2.5 版本中进入标准库，因此 2.4 没有它。我还听说有些人在为分发或嵌入特定应用程序构建 Python 时将其排除在外，因为使用它很容易使进程崩溃，甚至破坏主机应用程序的堆。但我自己从未遇到过这种情况，我怀疑完整安装是否会这样做。

至于找不到您的 C 库，我们需要更多详细信息。

# python - 文件读取和正则表达式 - Python

> ID：12117035
> 
> 赞同：1
> 
> 时间：2012-08-24T21:41:29.160
> 
> 标签：python, regex, string, file

我读了一个有一行的文件：`Fixes: Saurabh Likes python`

我想删除`Fixes:`上面一行的部分。我为此使用正则表达式，但下面的代码片段返回输出，如

```
Saurabh Likes python\r 
```

我想知道从哪里来`\r`。我尝试了所有删除它的剥离选项，例如`rstrip()`,`lstrip()`等。但没有任何效果。任何人都可以建议我摆脱`\r`.

```
patternFixes ='\s*'+'Fixes'+':'+'\s*'
matchFixes= re.search(patternFixes,line, re.IGNORECASE)
        if matchFixes:
                    patternCompiled = re.compile(patternFixes)
                    line=patternCompiled.sub("", line)
                    #line=line.lstrip()
                    relevantInfo = relevantInfo+line
                    continue 
```

提前致谢！-Saurabh

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:48:24.443

'\r' 是一个回车 - [http://en.wikipedia.org/wiki/Carriage_return](http://en.wikipedia.org/wiki/Carriage_return)，它是从您的文件中提取的。

我会注意到，如果您需要“修复”的所有行实际上都以“修复：”开头，而这就是您想要更改的全部内容，您可以执行以下操作：

```
line = line[line.find('Fixes: ')+7:-1] 
```

为您节省所有正则表达式的东西。不过，不确定性能。这应该同时杀死你的 '\r's。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T21:43:40.877

您可能以二进制模式（`open(filename, "rb")`或类似的方式）打开了文件。如果您正在处理文本文件，请不要这样做。

改为使用`open(filename)`。`\n`现在，无论当前平台如何，Python 都会自动将所有换行符标准化为。

另外，为什么不简单`patternFixes = r'\s*Fixes:\s*'`呢？为什么都是`+`es？

然后，您正在做很多不必要的事情，例如一遍又一遍地重新编译正则表达式。

所以，我的建议（它和你的代码做同样的事情（加上文件处理）：

```
r = re.compile(r'\s*Fixes:\s*')
with open(filename) as infile:
    relevantInfo = "".join(r.sub("", line) for line in infile if "Fixes:" in line) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T22:33:35.867

建议摆脱`\r`：

我想您已经使用`open(filename)`. 按照打开的[手册](http://docs.python.org/library/functions.html#open)：

> 如果省略 mode，则默认为 'r'。...除了标准 fopen() 值模式可能是“U”或“rU”。Python 通常是用通用换行支持构建的；提供 'U' 将文件作为文本文件打开，但行可能被以下任何一种终止：Unix 行尾约定 '\n'、Macintosh 约定 '\r' 或 Windows 约定 '\ r\n'。所有这些外部表示都被 Python 程序视为“\n”。

所以，简而言之，请尝试使用打开您的文件`'rU'`并查看是否`\r`消失：

```
with open(filename, "rU") as f:
    # do your stuff here.
    ... 
```

你的`\r`输出中消失了吗？

当然，您的代码看起来相当笨拙，但其他人已经对此部分发表了评论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T21:49:28.890

```
>>> import re
>>> re.sub('Fixes:\s*', '', 'Fixes: Saurabh Likes python')
'Saurabh Likes python' 
```

没有'\r'

```
>>> re.sub('\s*'+'Fixes'+':'+'\s*', '', 'Fixes: Saurabh Likes python')
'Saurabh Likes python' 
```

再次没有'\r'

您能否提供有关如何复制的更多详细信息？

**编辑**它也不能用你的代码重现

```
>>> line = 'Fixes: Saurabh Likes python'
>>> patternFixes ='\s*'+'Fixes'+':'+'\s*'
>>> matchFixes= re.search(patternFixes,line, re.IGNORECASE)
>>> if matchFixes:
...     patternCompiled = re.compile(patternFixes)
...     line=patternCompiled.sub("", line)
...     print line
...     line=line.lstrip()
...     print line
... 
Saurabh Likes python
Saurabh Likes python
>>> 
```

# vba - 我可以获取 Excel 剪贴板数据的源范围吗？

> ID：12117040
> 
> 赞同：6
> 
> 时间：2012-08-24T21:42:09.743
> 
> 标签：vba, clipboard, excel-2003, clipboarddata

如果剪贴板包含 Excel 工作表范围，您可以使用 DataObject 对象访问该范围的数据

您还可以找到该数据的实际**源范围**（即工作表、行和列）吗？

或者，您能找到**最后复制**的范围，它用虚线轮廓边框（**不是**所选范围）表示吗？

最好使用 Excel 2003 VBA

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2020-02-03T05:29:41.403

此代码在 Excel 2019 64 位中用于获取剪贴板上的单元格范围，而不是单元格的内容。

fGetClipRange 返回 Excel 范围的范围对象，该范围对象被剪切或复制到剪贴板上，包括书籍和工作表。它使用“链接”格式直接从剪贴板中读取它，并且需要此格式的 ID 号。与注册格式关联的 ID 可以更改，因此 fGetFormatId 从格式名称中查找当前格式 ID。使用 Application.CutCopyMode 确定单元格是否被剪切或复制。

该站点对于在 VBA 中使用剪贴板很有用：[https ://social.msdn.microsoft.com/Forums/office/en-US/ee9e0d28-0f1e-467f-8d1d-1a86b2db2878/a-clipboard-object-for- vba-包括-microsoft-word?forum=worddev](https://social.msdn.microsoft.com/Forums/office/en-US/ee9e0d28-0f1e-467f-8d1d-1a86b2db2878/a-clipboard-object-for-vba-including-microsoft-word?forum=worddev)

```
Private Declare PtrSafe Function lstrcpy Lib "kernel32" (ByVal lpString1 As Any, ByVal lpString2 As Any) As LongPtr
Private Declare PtrSafe Function GlobalLock Lib "kernel32" (ByVal hMem As LongPtr) As LongPtr
Private Declare PtrSafe Function GlobalUnlock Lib "kernel32" (ByVal hMem As LongPtr) As Long
Private Declare PtrSafe Function OpenClipboard Lib "user32" (ByVal hwnd As LongPtr) As Long
Private Declare PtrSafe Function CloseClipboard Lib "user32" () As Long
Private Declare PtrSafe Function GetClipboardData Lib "user32" (ByVal lngFormat As Long) As LongPtr
Private Declare PtrSafe Function EnumClipboardFormats Lib "user32" (ByVal wFormat As Long) As Long
Private Declare PtrSafe Function GetClipboardFormatNameA Lib "user32" (ByVal wFormat As Long, ByVal lpString As String, ByVal nMaxCount As Long) As Long

'2020-02-11 get excel copy or cut range from clipboard
Function fGetClipRange() As Range
Dim strGetClipRange As String    'return range
Dim lptClipData As LongPtr  'pointer to clipboard data
Dim strClipData As String   'clipboard data
Dim intOffset As Integer    'for parsing clipboard data
Dim lngRangeLink As Long  'clipboard format
Const intMaxSize As Integer = 256   'limit for r1c1 to a1 conversion
    lngRangeLink = fGetFormatId("Link") 'we need the id number for link format
    If OpenClipboard(0&) = 0 Then GoTo conDone  'could not open clipboard
    lptClipData = GetClipboardData(lngRangeLink)    'pointer to clipboard data
    If IsNull(lptClipData) Then GoTo conDone    'could not allocate memory
    lptClipData = GlobalLock(lptClipData)   'lock clipboard memory so we can reference
    If IsNull(lptClipData) Then GoTo conDone    'could not lock clipboard memory
    intOffset = 0   'start parsing data
    strClipData = Space$(intMaxSize)    'initialize string
    Call lstrcpy(strClipData, lptClipData + intOffset)  'copy pointer to string
    If strClipData = Space$(intMaxSize) Then GoTo conDone   'not excel range on clipboard
    strClipData = Mid(strClipData, 1, InStr(1, strClipData, Chr$(0), 0) - 1)    'trim null character
    If strClipData <> "Excel" Then GoTo conDone     'not excel range on clipboard
    intOffset = intOffset + 1 + Len(strClipData)    'can't retrieve string past null character
    strClipData = Space$(intMaxSize)    'reset string
    Call lstrcpy(strClipData, lptClipData + intOffset)  'book and sheet next
    strClipData = Mid(strClipData, 1, InStr(1, strClipData, Chr$(0), 0) - 1)
    strGetClipRange = "'" & strClipData & "'!"  'get book and sheet
    intOffset = intOffset + 1 + Len(strClipData)    'next offset
    strClipData = Space$(intMaxSize)    'initialize string
    Call lstrcpy(strClipData, lptClipData + intOffset)  'range next
    strClipData = Mid(strClipData, 1, InStr(1, strClipData, Chr$(0), 0) - 1)
    strGetClipRange = strGetClipRange & strClipData 'add range
    strGetClipRange = Application.ConvertFormula(strGetClipRange, xlR1C1, xlA1)
    Set fGetClipRange = Range(strGetClipRange)  'range needs a1 style
conDone:
    Call GlobalUnlock(lptClipData)
    Call CloseClipboard
End Function

'2020-02-11 clipboard format id number changes so get it from format name
Function fGetFormatId(strFormatName As String) As Long
Dim lngFormatId As Long
Dim strFormatRet As String
Dim intLength As Integer
    If OpenClipboard(0&) = 0 Then Exit Function   'could not open clipboard
    intLength = Len(strFormatName) + 3  'we only need a couple extra to make sure there isn't more
    lngFormatId = 0 'start at zero
    Do
        strFormatRet = Space(intLength) 'initialize string
        GetClipboardFormatNameA lngFormatId, strFormatRet, intLength    'get the name for the id
        strFormatRet = Trim(strFormatRet)   'trim spaces
        If strFormatRet <> "" Then  'if something is left
            strFormatRet = Left(strFormatRet, Len(strFormatRet) - 1)    'get rid of terminal character
            If strFormatRet = strFormatName Then    'if it matches our name
                fGetFormatId = lngFormatId  'this is the id number
                Exit Do 'done
            End If
        End If
        lngFormatId = EnumClipboardFormats(lngFormatId) 'get the next used id number
    Loop Until lngFormatId = 0  'back at zero after last id number
    Call CloseClipboard 'close clipboard
End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T22:31:43.160

不直接，不 - 剪贴板对象似乎只包含单元格的值（尽管 Excel 显然以某种方式记住了边框）：

```
Sub testClipborard()

    Dim test As String
    Dim clipboard As MSForms.DataObject
    Set clipboard = New MSForms.DataObject

    clipboard.GetFromClipboard
    test = clipboard.GetText

    MsgBox (test)

End Sub 
```

请注意，您需要参考 Microsoft Forms 2.0 库才能运行它（如果单元格中没有值，它也会失败）。

* * *

话虽如此，您可以尝试以下操作 - 将其添加到 VBA 编辑器中的模块中。

```
Public NewRange As String 
Public OldRange As String 
Public SaveRange As String 
Public ChangeRange As Boolean 
```

并在工作表对象中使用以下内容

```
Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range) 

     'save previous selection
    OldRange = NewRange 

     'get current selection
    NewRange = Selection.Address 

     'check if copy mode has been turned off
    If Application.CutCopyMode = False Then 
        ChangeRange = False 
    End If 

     'if copy mode has been turned on, save Old Range
    If Application.CutCopyMode = 1 And ChangeRange = False Then 
         'boolean to hold "SaveRange" address til next copy/paste operation
        ChangeRange = True 
         'Save last clipboard contents range address
        SaveRange = OldRange 
    End If 

End Sub 
```

它似乎有效，但是，它也可能相当容易出现不同的错误，因为它试图解决剪贴板的问题。 [http://www.ozgrid.com/forum/showthread.php?t=66773](http://www.ozgrid.com/forum/showthread.php?t=66773)

# ruby-on-rails - 维护迁移文件的最佳实践

> ID：12117045
> 
> 赞同：0
> 
> 时间：2012-08-24T21:42:35.583
> 
> 标签：ruby-on-rails, database, migration

目前，对于我数据库中的每个表，我分几个步骤添加列（即，我通过多次迁移新文件来添加列）。这会导致大量迁移文件（约 50 个左右？）。这似乎很不干燥。

我最终得到了与单个条目“add_(column_name)_to”文件混合的大型“add-details_to”文件，这使得很难分辨哪个文件用于迁移哪个列。

有没有办法干燥迁移文件，以便每个表都有一个迁移文件？

例如，如果我在一次迁移中添加了多个列，然后决定要删除其中一个列，那么最佳做法是什么？

1）为我要删除的一列创建向下迁移

2）回滚整个多列迁移，然后只使用我想要的列创建一个新的向上迁移。

我目前遵循 1，但在我看来，2 可以让我摆脱最初的错误迁移文件，从而避免很多迁移文件的问题。

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:02:02.840

我认为总的来说，让您的迁移文件增长并通过测试管理不断增长的需求是一个不错的选择。[`shoulda-matchers`](https://github.com/thoughtbot/shoulda-matchers)是一个很好的工具。

我绝对不喜欢`down`迁移的想法，尤其是在它`up`在服务器上运行之后（如果`down`反对立即迁移，则很少有例外）。我宁愿创建另一个迁移来完成在`down`. 虽然，我承认有时`down`是要走的路。

但最终这一切都取决于您在应用程序中的位置。如果在本地开发一个功能并想要整合，我可以看到你这样做，你在哪里做，`db:migrate:redo`直到你得到你当前迁移所需的东西。但是，一旦您将某些东西（尤其是生产）推高，我会添加另一个迁移。

# c# - 如何防止 MS Exchange 用户转发或复制通过 System.Net.Mail 发送的邮件？

> ID：12117061
> 
> 赞同：0
> 
> 时间：2012-08-24T21:43:42.980
> 
> 标签：c#, .net, email, smtpclient, exchange-server-2010

如何防止 MS Exchange 用户转发或复制通过 System.Net.Mail 发送的邮件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T21:50:14.287

除非您编写 Outlook 插件，否则这是不可能的，即使您这样做，坚定的用户将始终能够以一种或另一种方式做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T23:34:24.763

你不能。如果电子邮件是通过 Exchange 而不是 SMTP 发送的，您也许可以...使用服务器端 Exchange 插件/扩展。但是，如果邮件是通过 SMTP 发送的并且位于 Exchange 服务器之外，那么您就是 SOL。邮件消息只不过是一个简单的文本文件。参见[RFC 5322: Internet Message Format](http://tools.ietf.org/pdf/rfc5322.pdf)。

此外， [SMTP](http://tools.ietf.org/pdf/rfc5321.pdf)本身是一种存储转发协议。将消息从发件人转移到收件人所涉及的每个邮件服务器都会获得该邮件的副本并可以保留它。

# asp.net-mvc-3 - ASP.NET MVC3 和 Entity Framework v4.1 出现错误实体对象不能被多个 IEntityChangeTracker 实例引用

> ID：12117072
> 
> 赞同：2
> 
> 时间：2012-08-24T21:44:42.277
> 
> 标签：asp.net-mvc-3, entity-framework, entity-framework-4

目前，当将产品添加到我的购物车时，我的 Add 操作`CartController`是使用`orderEntryDisplayViewModel`（订单行对象）调用的。

```
 [HttpPost]
    public RedirectToRouteResult Add(Cart cart, OrderEntryDisplayViewModel orderLine)
    {
        if (!ModelState.IsValid)
        { return RedirectToAction("Display", "OrderEntry", new { Product = orderLine.Line.PartNum }); }
        CompleteProduct product = null;
        orderLine.Line.RequestedShipDate = orderLine.RequestedShipDate;
        if (orderLine.Line.NewMyPartNum != null)
        { orderLine.Line.MyPartNum = orderLine.Line.NewMyPartNum; }
        try
        {
            product = _inventoryRepo.FetchByPartNum(orderLine.Line.PartNum, User.Identity.Name);
            orderLine.Line.Product = product;
            cart.AddItem(orderLine.Line);
            //_cartRepo.Save();
        }
        catch (DbUpdateException e)
        { throw; }
        catch
        {
            ModelState.AddModelError("", "Problem adding part to cart");
            return RedirectToAction("Index", new { returnUrl = Url.Action("Index", "OrderEntry") });
        }
        return RedirectToAction("Index", new { returnUrl = Url.Action("Index", "OrderEntry") });
    } 
```

在到达之前，`CartModelBinder`要么从会话中创建或获取购物车。

```
public class CartModelBinder : IModelBinder
{
    private const string sessionKey = "Cart";

    public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        CartRepository cartRepo = new CartRepository();
        Cart cart = (Cart)controllerContext.HttpContext.Session[sessionKey];
        if (cart == null)
        {
            cart = cartRepo.CreateCart(true);
            cartRepo.DetachCart(cart);
            controllerContext.HttpContext.Session[sessionKey] = cart;
            cartRepo.AttachCart(cart);
        }
        else
        { cartRepo.AttachCart(cart); }
        return cart;
    }
} 
```

如果会话中当前不存在购物车`CartRepository` `CreateCart`，则通过将新创建的购物车添加到上下文的方法创建一个新的购物车。

```
 public Cart CreateCart(bool saveCart = false)
    {
        Cart cart = new Cart();
        context.Carts.Add(cart);
        if (saveCart)
        { context.SaveChanges(); }
        return cart;
    } 
```

在将购物车对象添加到会话之前，我使用 将其从上下文中分离出来`CartRepository` `DetachCart`，将其添加到会话中，然后再次将其附加到上下文中。

```
public void DetachCart(Cart cart)
{
    ((IObjectContextAdapter)context).ObjectContext.Detach(cart);
} 
```

从以下`CartRepository`位置获取上下文`ContextHelper`：

```
public static class ContextHelper
{
    public static InsideIIMAKContext InsideIIMAK
    {
        get
        {
            if (HttpContext.Current.Items["InsideIIMAKContext"] == null)
            { HttpContext.Current.Items.Add("InsideIIMAKContext", new InsideIIMAKContext()); }
            return (InsideIIMAKContext)HttpContext.Current.Items["InsideIIMAKContext"];
        }
    } 
```

如果`CartModelBinder`在会话中找到购物车，则它会尝试通过`CartRepsitory`方法附加购物车`AttachCart`。

```
 public void AttachCart(Cart cart)
    {
        context.Carts.Attach(cart);
    } 
```

在添加操作结束时，`CartController`我重定向到索引操作以显示购物车视图。index 操作也需要 Cart 对象，因此`CartModelBinder`第二次调用该对象，这次调用该`CartRepository` `AttachCart`方法。我的错误发生在`AttachCart`方法上

> “一个实体对象不能被多个 IEntityChangeTracker 实例引用。”

我已经对此问题进行了大量研究，但似乎我没有将购物车对象添加到上下文的两个实例中的情况，这似乎通常是错误的原因。似乎存储在会话中的购物车对象正在使用跟踪信息进行修改，因此当我尝试在下一个 HTTP 请求中附加它时，EF 认为它已附加到活动上下文，但实际上它是上一个请求的上下文。我发现一个论坛建议我需要在将实体对象添加到会话之前将其分离，但我已经这样做了，但仍然遇到同样的问题。

希望我在这个解释中没有遗漏任何内容。

**答案**感谢 Mark Oreta

```
 public void DetachCart(Cart cart)
    {
        var objectContext = ((IObjectContextAdapter)context).ObjectContext;
        objectContext.Detach(cart.Customer);
        foreach (var item in cart.Lines)
        { objectContext.Detach(item); }
        objectContext.Detach(cart);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:09:26.207

当您将购物车放入会话时，您是否将对象从该上下文中分离出来？实体对象将携带上下文，因此您需要在添加之前显式分离它。

# javascript - 使用来自另一个页面上的表单的文本创建链接

> ID：12117075
> 
> 赞同：0
> 
> 时间：2012-08-24T21:45:36.627
> 
> 标签：javascript, html, forms, hyperlink

我的情况是这样的：我能够在不同的 html 页面中从表单中编写文本。但我想做的是只使用该表单中的文本创建一个链接。最初我使用 javascript，尤其是 widget.preferences（一种保存表单中所做更改的方法）和“var”标签：

```
<script>

addEventListener
(
'DOMContentLoaded',
function()
{

// get the var elements with an id and set their textContent to the corresponding  widget.preferences
    var vars = document.querySelectorAll( 'var[id]' );
    for( var i=0,element=null; element=vars[i++]; )
    {
        element.textContent = widget.preferences[ element.id ];
    }

},
false
);

</script>
</head>
<body>

<h1>Popup window</h1>
<p>Here is a list of preferences and their associated value:</p>
<ul>
    <li><var id="foo"></var>
    <li><var id="bar"></var>
    <li><var id="baz"></var>
    <li><var id="check"></var>
    <li><var id="group1"></var>
    <li><var id="myMultipleSelect"></var>
</ul>

</body> 
```

但是，正如我在开始时所说的，我的目标是使用其他页面上表单中的文本创建链接。表格如下：

```
<fieldset>
  <p>
    <input id="text1" name="foo" type="text"></input>
    <label for="text1">foo</label>
  </p>
  <p>
    <input id="text2" name="bar" type="text"></input>
    <label for="text2">bar</label>
  </p>
  <p>
    <input id="text3" name="baz" type="text"></input>
    <label for="text3">baz</label>
  </p>
</fieldset> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:03:26.567

我不确定您的问题到底是什么，但是对于使用 javascript 从其他页面检索信息，答案是 ajax。

这个答案有一个重要的警告：为此，您的页面和您尝试从中获取数据的表单页面需要位于同一域中。现代浏览器具有针对 XSS（跨站点脚本）的安全措施，因此您将无法获得该信息。

要获取表单的内容，请对带有该表单的页面发出 ajax 请求，然后将其 html 内容解析为 XML。然后，您可以浏览其 DOM 或使用 jQuery 之类的框架来提取链接所需的信息。

如果您是 ajax 新手，请尝试[http://www.w3schools.com/ajax/default.asp上的 w3c 学校教程](http://www.w3schools.com/ajax/default.asp)

如果您尝试访问的网页位于另一个域中，那么您可能不走运。有几种提出友好的跨站点请求的解决方案，例如微软的 XDR 对象，但是没有标准，所以要让它全面工作将是相当多的工作（如果可能的话） .

此外，对 XSS 的限制是在当前运行 js 的浏览器中进行的，因此如果您可以访问服务器端语言，您可以将来自某种处理程序的请求“穿梭”到您的页面中。

# python - 如何从另一个字典创建字典？

> ID：12117080
> 
> 赞同：31
> 
> 时间：2012-08-24T21:46:22.797
> 
> 标签：python, dictionary

在 Python 中从另一个创建`dict`具有某些属性的 的最佳方法是什么？`dict`

例如，假设我有以下内容`dict`：

```
dict1 = {
    name:          'Jaime',
    last_name:     'Rivera',
    phone_number:  '111111',
    email:         'test@gmail.com',
    password :     'xxxxxxx',
    token:         'xxxxxxx',
    secret_stuff:  'yyyyyyy'   
} 
```

我想获得

```
dict2 = {
    name:          'Jaime',
    last_name:     'Rivera',
    phone_number:  '111111',
    email:         'test@gmail.com'
} 
```

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-08-24T21:48:59.803

例如：

```
keys = ['name', 'last_name', 'phone_number', 'email']
dict2 = {x:dict1[x] for x in keys} 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-08-24T21:49:21.490

使用 dict 理解：

```
required_fields = ['name', 'last_name', 'phone_number', 'email']
dict2 = {key:value for key, value in dict1.items() if key in required_fields} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-08-24T21:49:13.783

```
for key in d1:
    if key in wanted_keys:
        d2[key] = d1[key] 
```

**更新**

我最近发现有一种更简洁的方法可以通过`dict`理解来做到这一点

```
wanted_keys = set(['this_key', 'that_key'])
new_dict = {k: d1[k] for k in d1.keys() & wanted_keys} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2019-01-05T16:05:23.540

对于任何想要 dict1 的完整副本而不制作键列表的人：

`dict2 = {k: v for k, v in dict1.items()}`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2021-02-11T20:00:13.297

不知道怎么有人没有回答这个问题。

您可以使用双星号来解构一个字典，而巧合的是，它也可以在另一个字典中工作。

```
someweirddata = {"hello":"world"}
print({"initial data":"yati yati yata",**someweirddata}) 
```

输出：

```
{'initial data': 'yati yati yata', 'hello': 'world'} 
```

这与 Javascript 的 ... 相同，只是它是 **

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-24T21:49:19.397

```
def removekey(mydict, key):
    r = dict(mydict)
    del r[key]
    return r 
```

传递 mydict 字典和要删除的键，返回剩余字典

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-08T04:53:28.150

someweirddata = {"hello":"world"} print({"初始数据":"yati yati yata",**someweirddata})

输出：

```
{'initial data': 'yati yati yata', 'hello': 'world'} 
```

**但是，如果您有 2 深度字典并且它们具有相同的键，则该函数会返回错误的输出而没有错误！**

someweirddata = {"hello":{"world":[0,0,0]}} print({"hello":{"world":[1,1,1]},**someweirddata})

输出：

```
{'hello': {'world': [0, 0, 0]}} 
```

# python - 使用 __ 的 Python“隐藏”方法

> ID：12117087
> 
> 赞同：6
> 
> 时间：2012-08-24T21:47:39.693
> 
> 标签：python, oop, inheritance

今天我看到 - python 添加`_$CLASSNAME$`到名称为`__`.

简单的例子：

```
>>> class A:  
...     def a(self):  
...         self.b()  
...     def b(self):  
...         print('A.b')  
...           
>>> class B(A):  
...     def b(self):  
...         print('B.b')  
...           
>>> B().a()  
B.b 
```

那工作，但是：

```
>>> class A:  
...     def a(self):  
...         self.__b()  
...     def __b(self):  
...         print('A.b')  
...           
>>> class B(A):  
...     def __b(self):  
...         print('B.b')  
...           
>>> B().a()  
A.b 
```

为什么？我不知道，所以我做了它。这里是：

```
>>> print([fn for fn in dir(B) if fn[-2:] != '__'])
['_A__b', '_B__b', 'a'] 
```

为什么蟒蛇这样做？有没有办法绕过它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-24T21:50:28.103

它被称为名称修改，以防止与父类和子类发生意外的名称冲突。你不能（也不应该，很多完美的代码都使用它）禁用它。你可以绕过它，但你也不应该这样做（它非常难看，你可以避免它，当你需要访问它时，你不应该首先允许名称修改）。只需对要在类中的任何位置使用的私有函数使用单个下划线即可。

请参阅[教程](http://docs.python.org/py3k/tutorial/classes.html#private-variables)，但忽略对此表示“私有”变量的任何引用。这不是它的用途，除非您`private`在 C++/Java/C#/... 意义上使用对子类隐藏的`private`变量（与`protected`子类可见的变量相反）。即使这样，这也是一个有缺陷的类比。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-24T21:57:56.303

虽然 python 没有严格执行这些，但双下划线的命名约定意味着“私有”，而单下划线意味着“受保护”。

双下划线是为了保护子类不会因为使用相同的名称而导致错误。通过按类名对它们进行命名空间，定义类可以确保其变量将保持有效。

单个下划线意味着子类可以自由访问和修改这些相同的属性，并与超类共享。

这两种形式都**表明**任何外部类都不应该访问这些。

```
class A(object):

    __private = 'private'
    _protected = 'protected'

    def show(self):
        print self.__private 
        print self._protected

class B(A):
    __private = 'private 2'
    _protected = 'protected 2'

a = A()
a.show()
#private
#protected

b = B()
b.show()
#private
#protected 2 
```

这个例子表明，即使 class`B`定义了一个 new `__private`，它也不影响继承的`show`方法，它仍然访问原始的超类属性。`_protected`然而，被修改并且超类`show`方法反映了这一点，因为它们是相同的属性。

# java - 在 Hadoop Map-Reduce 中，是否有任何类在排序之后和分区之前看到整个键列表？

> ID：12117088
> 
> 赞同：7
> 
> 时间：2012-08-24T21:47:45.833
> 
> 标签：java, hadoop, mapreduce, partitioning, partitioner

我正在使用 Hadoop 分析非常不均匀的数据分布。有些键有数千个值，但大多数只有一个。例如，与 IP 地址相关联的网络流量将有许多数据包与一些健谈的 IP 相关联，而只有少数与大多数 IP 相关联。另一种说法是[基尼指数](http://en.wikipedia.org/wiki/Gini_index)非常高。

为了有效地处理这个问题，每个reducer 应该获得一些高音量键或大量低音量键，以便获得大致均匀的负载。如果我正在编写分区过程，我知道该怎么做：我将获取`keys`映射器生成的（包括所有重复键）的排序列表以及减速器的数量，`N`并将拆分放在

```
split[i] = keys[floor(i*len(keys)/N)] 
```

Reducer`i`将获得`k`诸如`split[i] <= k < split[i+1]`for`0 <= i < N-1`和`split[i] <= k`for 的键`i == N-1`。

我愿意用 Java 编写自己的分区器，但[Partitioner<KEY,VALUE>](http://hadoop.apache.org/mapreduce/docs/r0.21.0/api/org/apache/hadoop/mapreduce/Partitioner.html)类似乎一次只能访问一个键值记录，而不是整个列表。我知道 Hadoop 对映射器生成的记录进行排序，所以这个列表必须存在于某个地方。它可能分布在几个分区器节点中，在这种情况下，我会在其中一个子列表上执行拆分过程，并以某种方式将结果传达给所有其他分区器节点。（假设选择的分区节点看到一个随机子集，结果仍然是近似负载平衡的。） **有谁知道排序的键列表存储在哪里，以及如何访问它？**

我不想编写两个 map-reduce 作业，一个是查找拆分，另一个是实际使用它们，因为这看起来很浪费。（映射器必须做两次相同的工作。）这似乎是一个普遍的问题：不均匀分布很常见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T14:52:42.247

I've been thinking about this problem, too. This is the high-level approach I would take if someone forced me.

*   In addition to the mapper logic you have in place to solve your business problem, code some logic to gather whatever statistics you'll need in the partitioner to distribute key-value pairs in a balanced manner. Of course, each mapper will only see some of the data.
*   Each mapper can find out its task ID and use that ID to build a unique filename in a specified hdfs folder to hold the gathered statistics. Write this file out in the cleanup() method which runs at the end of the task.
*   use lazy initialization in the partitioner to read all files in the specified hdfs directory. This gets you all of the statistics gathered during the mapper phase. From there you're left with implementing whatever partitioning logic you need to correctly partition the data.

This all assumes that the partitioner isn't called until all mappers have finished, but that's the best I've been able to do so far.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T12:24:51.663

据我所知 - MR 处理中没有一个地方存在所有密钥。不仅如此 - 不能保证单台机器可以存储这些数据。我认为这个问题在当前的 MR 框架中没有理想的解决方案。我这么认为是因为要获得理想的解决方案 - 我们必须等待最后一个映射器的结束，然后才能使用这些知识分析密钥分布和参数化分区器。
这种方法将使系统显着复杂化并增加延迟。
我认为好的近似值可能是对数据进行随机抽样以了解密钥分布的概念，然后让分区器根据它工作。
据我了解，Terasort 实现正在做一些非常相似的事情：[http ://sortbenchmark.org/YahooHadoop.pdf](http://sortbenchmark.org/YahooHadoop.pdf)

# qt - Qt QDataWidgetMapper 未映射到小部件

> ID：12117101
> 
> 赞同：0
> 
> 时间：2012-08-24T21:49:34.733
> 
> 标签：qt

我很难将模型映射到 Qt 中的小部件。相关代码如下：

头文件声明：

```
Ui::Widget *ui;
QStringList list;
QStringListModel *model;
QDataWidgetMapper *mapper; 
```

cpp 文件实现（在构造函数中）：

```
ui->setupUi(this); //only creates a QComboBox called comboBox
model = new QStringListModel(this);
mapper = new QDataWidgetMapper(this);
list << "Item 1" << "Item 2" << "Item 3";
model->setStringList(list);
mapper->setModel(model);
mapper->addMapping(ui->comboBox, 0);
mapper->toFirst(); 
```

由于某种原因，组合框没有填充 QStringList 列表中的项目。请帮助并告诉我我做错了什么！完全不使用映射器可以正常工作（将模型直接提供给小部件），但这也有学习方面的问题，所以请不要建议不要使用映射器。

非常感谢您的时间和努力。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:00:51.470

`QComboBox`不能直接用`QDataWidgetMapper`. 您需要为其使用单独的模型。查看[Combo Widget Mapper](http://qt-project.org/doc/qt-5.0/itemviews-combowidgetmapper.html)示例，了解如何操作。

或者你只是想用一个模型驱动一个组合框？那不是`QDataWidgetMapper`目的。为此使用[`QComboBox::setModel()`](http://qt-project.org/doc/qt-4.8/qcombobox.html#setModel)。

# ruby-on-rails - 查询数据时，如何使用rails进行分组，避免重复？

> ID：12117103
> 
> 赞同：1
> 
> 时间：2012-08-24T21:49:53.803
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有以下查询：

```
@items = AddressBook.select('email').where(:domain => 'hospital.com'). 
```

这会返回大约 100 封重复的电子邮件。如何使用 Rails 只取回唯一的电子邮件？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:16:44.823

```
 @items = AddressBook.select(:email).where(:domain => 'hospital.com').uniq 
```

生成相同的 sql 但语法不同

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T21:52:41.033

试试这个？

```
@items = AddressBook.select('DISTINCT email').where(:domain => 'hospital.com') 
```

# jquery - Jquery 平滑滚动到元素偏移量

> ID：12117109
> 
> 赞同：0
> 
> 时间：2012-08-24T21:50:24.013
> 
> 标签：jquery, smooth-scrolling

我已经使 scrollingHotSpot 左右区域不透明，这意味着当我加载页面时，第一个图像被切到左边。当我使用 scrollToElement 函数时会发生同样的问题。

为了修复被切断的第一张图像，我使用了这个，效果很好：

```
#makeMeScrollable div.scrollableArea img{
padding: 0 30 0 30;} //as my scrollinghotspots are 30px wide 
```

我的 scrollToElement 图像仍然被切断到左侧：

```
$("#jumpToPrint").click(function () {
        $("div#makeMeScrollable").smoothDivScroll("scrollToElement", "id", "imgPrint");
    }); 
```

尝试使用以下方法，但没有解决问题：

```
$("div#makeMeScrollable").smoothDivScroll("scrollToElement", "id", "imgPrint").offset().left - 30; 
```

非常感谢任何帮助，干杯！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:21:22.823

由于`min-width`您的热点是 75px，看起来它忽略了您为它们设置的 30px。因此，30px 不足以填充您的图像。它应该与`padding: 0 75px`或通过将`min-width`of`.scrollinghotspotleft`和设置`.scrollinghotspotright`为 30px 来工作。

# objective-c - 在 Cocoa 的屏幕上观察全局鼠标位置？

> ID：12117111
> 
> 赞同：4
> 
> 时间：2012-08-24T21:50:42.353
> 
> 标签：objective-c, cocoa, nswindow, nsevent

我希望在鼠标移动并获取屏幕上的位置时收到通知。我试过这个：

```
[NSEvent addGlobalMonitorForEventsMatchingMask:NSMouseMovedMask handler:^(NSEvent *event) {
    CGPoint location = [NSEvent mouseLocation];
    NSLog(@"Position: %@", NSStringFromPoint(location));
}]; 
```

然而，这似乎只在鼠标在我的应用程序窗口中时才有效。只要离开它，我就没有通知。直到我再次进入窗口。这个事件不应该是全球性的吗？

**更新：**

我提取了有问题的代码并制作了一个单独的示例项目（[Dropbox-Link](https://dl.dropbox.com/u/45291509/MouseMoveTest.zip)）。可以肯定的是，没有其他任何东西可以干扰它。这是一个干净的项目，只有上面的代码`applicationDidFinishLaunching:`。我得到相同的结果，这真的很奇怪。我将视频上传到 youtube：[http](http://www.youtube.com/watch?v=I3AKgmURaMk) ://www.youtube.com/watch?v=I3AKgmURaMk 。

这些是我的观察：

1.  启动应用程序后，无论我将鼠标移动到何处，都不会立即传递任何事件。
2.  单击应用程序的窗口将以某种方式激活事件传递。现在我收到 NSMouseMovedMask 事件，无论我在哪里移动鼠标（这是我想要实现的）。
3.  单击返回 Xcode 不会改变任何内容。我不断收到事件。
4.  但是，将焦点移回我的应用程序会导致奇怪的行为。当我将鼠标移到 Xcode 上时，我只会在窗口的某些部分上获得事件，而某些部分似乎会吸收事件。更具体地说，我没有通过编辑器或日志视图接收事件。我只在将鼠标移到灰色拆分视图分隔符区域（其中嵌入了标签栏）时才收到它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-30T16:52:03.290

它应该可以工作，当窗口打开但不在前台时，我看到了奇怪的行为。我注意到，如果应用程序在后台但不在 Dock 中，则只有当鼠标在前台窗口之间转换时才会收到事件。最小化应用程序似乎可以解决这个问题。我是 cocoa dev/ObjC 的新手。我可能错了，但我注意到当我最小化我的应用程序时，我得到了所有事件。

# r - 在 R 中创建空间数据

> ID：12117113
> 
> 赞同：3
> 
> 时间：2012-08-24T21:51:00.690
> 
> 标签：r, spatial

我有一个 100 x 200 米区域内的物种及其大致位置的数据集。数据框的位置部分不是我认为可用的格式。在这个 100 x 200 米的矩形中，有两百个 10 x 10 米的正方形，命名为 A 到 CV。在每个 10 x 10 方格内，有四个 5 x 5 平方米的方格，分别命名为 1、2、3 和 4（1 在 2 的南边和 3 的西边。4 在 2 的东边和 3 的北边）。我想让 R 知道 A 是角在 (0 ,0)、(10,0)、(0,0) 和 (0,10) 处的正方形，B 就在 A 的北边并且有角 ( 0,10), (0,20), (10,10), 和 (10,20)，K 就在 A 的东边，在 (10,0), (10,10), (20, 0) 和 (20,10) 等所有 10 x 10 平方米。此外，我想让 R 知道每个 5 x 5 平方米在 100 x 200 米地块中的位置。

所以，我的数据框看起来像这样

```
10x10    5x5     Tree    Diameter
A    1     tree1    4
B    1     tree2    4
C    4     tree3    6
D    3     tree4    2
E    3     tree5    3
F    2     tree6    7
G    1     tree7    12
H    2     tree8    1
I    2     tree9    2
J    3     tree10   8
K    4     tree11   3
L    1     tree12   7
M    2     tree13   5 
```

最终，我希望能够绘制 100 x 200 米的区域，并让每个 10 x 10 平方米的区域显示树木数量、物种数量或总生物量 什么是转换我拥有的数据的最佳方式到 R 可用于绘图和分析的空间数据？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T22:10:40.080

这是一个开始。

```
## set up a vector of all 10x10 position tags
tags10 <- c(LETTERS,
            paste0("A",LETTERS),
            paste0("B",LETTERS),
            paste0("C",LETTERS[1:22])) 
```

将（例如）转换`{"J",3}`为相应子正方形中心的函数。

```
convpos <- function(pos10,pos5) {
    ## convert letters to major (x,y) positions
    p1 <- as.numeric(factor(pos10,levels=tags10))  ## or use match()
    p1.x <- ((p1-1) %% 10) *10+5    ## %% is modulo operator
    p1.y <- ((p1-1) %/% 10)*10+5    ## %/% is integer division
    ## sort out sub-positions
    p2.x <- ifelse(pos5 <=2,2.5,7.5)   ## {1,2} vs {3,4} values
    p2.y <- ifelse(pos5 %%2 ==1 ,2.5,7.5)  ## odd {1,3} vs even {2,4} values
    c(p1.x+p2.x,p1.y+p2.y)
} 
```

用法：

```
convpos("J",2)
convpos(mydata$tenbytenpos,mydata$fivebyfivepos) 
```

重要笔记：

*   这是一个概念证明，我几乎可以保证我没有完全正确地得到 x 和 y 坐标的对应关系。但是您应该能够逐行跟踪并查看它在做什么...
*   它应该在向量上正常工作（参见上面的第二个用法示例）：我从 切换`switch`到`ifelse`出于这个原因
*   `10x10`你的列名`X10.10`（`?data.frame``?check.names`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-24T22:40:34.730

与@Ben Bolker 所做的类似，这里有一个查找功能（尽管您可能需要转置一些内容以使标签与您描述的内容相匹配）。

```
tenbyten <- c(LETTERS[1:26], 
  paste0("A",LETTERS[1:26]), 
  paste0("B",LETTERS[1:26]), 
  paste0("C",LETTERS[1:22]))

tenbyten <- matrix(rep(tenbyten, each = 2), ncol = 10)
tenbyten <- t(apply(tenbyten, 1, function(x){rep(x, each = 2)}))
# the 1234 squares
squares <- matrix(c(rep(c(1,2),10),rep(c(4,3),10)), nrow = 20, ncol = 20)
# stick together into a reference grid
my.grid <- matrix(paste(tenbyten, squares, sep = "-"), nrow = 20, ncol = 20)

# a lookup function for the site grid
coordLookup <- function(tbt, fbf, .my.grid = my.grid){
  x <- col(.my.grid) * 5 - 2.5
  y <- row(.my.grid) * 5 - 2.5
  marker <- .my.grid == paste(tbt, fbf, sep = "-")
  list(x = x[marker], y = y[marker])
}

coordLookup("BB",2)
$x
[1] 52.5

$y
[1] 37.5 
```

如果这不是您要寻找的，那么也许您更喜欢`SpatialPolygonsDataFrame`具有正确多边形 ID 的 ，并且您将数据附加到等等。在这种情况下，只需谷歌搜索如何从头开始制作并操作和函数来获取你的多边形角`row()`，`col()`类似于这个查找函数中给出的函数，它只返回质心。

编辑：开始 SPDF：

这是从函数示例修改而来的，有望成为一个好的开始：

```
library(sp)
# really you have a 20x20 grid, counting the small ones.
# c(2.5,2.5) specifies the distance in any direction from the cell center
grd <- GridTopology(c(1,1), c(2.5,2.5), c(20,20)))
grd <- as.SpatialPolygons.GridTopology(grd)
# get centroids
coords <- coordinates(polys)
# make SPDF, with an extra column for your grid codes, taken from the above.
# you can add further columns to this data.frame(), using polys@data
polys <- SpatialPolygonsDataFrame(grd, 
  data=data.frame(x=coords[,1], y=coords[,2], my.ID = as.vector(my.grid), 
  row.names=getSpPPolygonsIDSlots(grd))) 
```

# .net - 我们可以从 dll 而不是 exe 启动 Windows 服务吗？

> ID：12117118
> 
> 赞同：3
> 
> 时间：2012-08-24T21:52:00.037
> 
> 标签：.net, windows-services, window

只是想知道，是否可以从 .net 3.5 dll 而不是 exe 启动 Windows 服务？

是否有任何解决方法可以帮助您做到这一点？

在这种情况下如何指定一个入口点？

谢谢，

公斤

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T23:14:00.083

没有“官方方式”将 .net dll 作为 Windows 服务运行。它需要 svchost.exe 加载 DLL 并绑定到启动/停止导出。但是，MS 没有提供有关此类主题的文档。

在[msdn 文档](http://msdn.microsoft.com/en-us/library/d56de412.aspx "文件")中，使用的术语是“服务应用程序”或“服务可执行文件”，因此也没有“dll 方式”。

编辑：

刚刚发现这种将 dll 作为服务运行的尝试（痛苦！）：http: [//forum.sysinternals.com/topic11974.html](http://forum.sysinternals.com/topic11974.html)

# c# - 根据位置在wpf中创建动态文本框

> ID：12117119
> 
> 赞同：0
> 
> 时间：2012-08-24T21:52:03.997
> 
> 标签：c#, wpf, dynamic, textbox, controls

我正在尝试在 WPF 中创建动态文本框。非常重要的是，我将能够灵活地确定文本框的位置 - 以像素级别为单位。我找到了许多使用 stackpanel 创建“运行时”文本框的答案 - 但找不到如何根据指定位置构建它。

文本框必须是“自动换行”，我正在使用按钮单击事件来创建文本框

这是现在的代码，我真的不知道哪些方法或属性会有帮助。谢谢 ：）

```
 private void button1_Click(object sender, RoutedEventArgs e)
        {
            TextBox x = new TextBox();
            x.Name = "new_textbox";
            x.TextWrapping= TextWrapping.Wrap;
            x.VerticalScrollBarVisibility=ScrollBarVisibility.Visible;
            x.AcceptsReturn = true;
            x.Margin = new Thickness(5, 10, 0, 0);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:51:42.370

```
 TextBox x = new TextBox();
 x.Name = "new_textbox";
 x.TextWrapping= TextWrapping.Wrap;
 x.VerticalScrollBarVisibility=ScrollBarVisibility.Visible;
 x.AcceptsReturn = true;
 x.Margin = new Thickness(5, 10, 0, 0);
 HouseCanvas.Children.Add(x);
 Canvas.SetLeft(x, 20);
 Canvas.SetTop(x, 20); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:49:43.370

如果您关心文本框本身的像素位置，您可能希望将其放置在 Canvas 中。您需要使用 x.SetValue(Canvas.LeftProperty, pixelX) [和 .RightProperty, etc...] 来获得完全正确的位置。我自己没有这样做，我猜你需要将画布放在正确的 Z 顺序（在顶部），并使其透明。事件也可能存在问题，具体取决于 z 顺序。祝你好运！

-凯夫

# linux - 将主脚本变量传递到 Perl 模块

> ID：12117120
> 
> 赞同：-1
> 
> 时间：2012-08-24T21:52:26.557
> 
> 标签：linux, perl, perl-module

我正在编写一个由用户运行的 Perl 脚本，并将当前 Linux 环境用作变量和其他变量。环境设置可能会发生变化，并且与原来的设置不同。

但是，我正在尝试使用自包含的 Perl 模块并且需要能够访问这些变量。这样做的最佳做法是什么？当我使用 Perl 模块创建对象时，我可以只传递 10 个变量，但这似乎太过分了......

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:00:12.233

`%ENV`可以从全局哈希中的任何位置访问环境变量：

```
print $ENV{HOME}; 
```

如果您正在创建对象，它们可能具有一些属性（作为对象哈希、数组甚至是内部对象......）只需将相关值存储到属性中，例如

```
my $obj = Some::Package->new( name    => 'Homer',
                              surname => 'Simpson',
                              city    => 'Springfield',
                              # ... 7 more
                            ); 
```

# google-analytics - 谷歌分析重复计算转化

> ID：12117121
> 
> 赞同：0
> 
> 时间：2012-08-24T21:52:34.197
> 
> 标签：google-analytics

我销售的 PDF 是在用于计算 Google Analytics（分析）中的转化次数的同一页面上交付的。GA 会计算几天内多次访问此页面的次数吗？例如，人们下载 PDF，几天后他们重新访问该页面并再次下载 pdf。他们只有一次转换，但多次访问。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T22:02:12.857

如果你在这里发布你的代码会更好。没有它，我无法确定。

可能是的，GA 会在您的客户每次访问下载页面时计算一次转化，因为您可能将其定义为转化目标，对吗？我认为避免这种情况的最简单方法是将另一个页面定义为您的目标或在其他地方提供后续下载。

无论如何，可以配置 GA 或您的页面来防止这种行为，但有必要了解更多关于您的页面...

# javascript - 获取带有 URL 的字符串的 Javascript 函数

> ID：12117130
> 
> 赞同：1
> 
> 时间：2012-08-24T21:53:10.393
> 
> 标签：javascript, jquery, regex

我有一个接收字符串的 Javascript 函数。该字符串中可能包含 URL，有或没有 http:// 或 http/s：

示例字符串：

> `This is an example string with www.cnn.com and http://microsoft.com"`

我的目的是获取该字符串并为 URL 注入锚标记，以便在将它们作为 HTML 注入到 html 文档时可以单击它们。

有什么我可以使用的吗？一些jQuery函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T21:56:05.370

## 没有本机 jQuery 函数，但正则表达式可以做到这一点

让我给你指出[这篇博文](http://blog.mattheworiordan.com/post/13174566389/url-regular-expression-for-links-with-or-without-the)，它将帮助你入门。它拥有的是一个正则表达式（可能看起来相当复杂和复杂，但并没有那么多），它可以检测字符串中的链接和电子邮件，因此您将能够找到它们并将它们替换为指向提取的 URL 的链接。

[也许Stackoverflow 自己的 Jeff Atwood 已经发布了](http://www.codinghorror.com/blog/2008/10/the-problem-with-urls.html)一个更好的表达方式（我知道我过去使用过）。他还非常详细地描述了整个 URL 情况，因此您可以决定这是否适用于您的问题以及适用程度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:16:10.217

如果仍然需要正则表达式：

```
/((www|http:\/\/)\S*)/ig 
```

这匹配`www.cnn.com`并`http://www.microsoft.com`来自以下示例：

```
This is an example string with www.cnn.com and http://www.microsoft.com 
```

如果您使用`<a href="$1">$1</a>`替换，您将获得：

```
<a href="www.cnn.com">www.cnn.com</a>
<a href="http://www.microsoft.com">http://www.microsoft.com</a> 
```

请记住，此正则表达式不会验证 url 地址。它只是搜索`www`or`http://`然后获取之后的所有内容，直到出现*空格*。

# jquery - 无法使用 jQuery 解析 JSON 数据

> ID：12117131
> 
> 赞同：0
> 
> 时间：2012-08-24T21:53:11.210
> 
> 标签：jquery, json

我正在尝试从 JSON 格式解析数据，但我得到第一个警报，即 (insdie 1: object Object)，然后我没有得到第二个警报。我不确定我做错了什么。

**JS**

```
$.getJSON("http://localhost:8080/JsoupPrj/JasonGen?url="+url
                    ,function(data){
                var imageData = [];
                alert("inside 1 :" + data);
                $.each(data.items,function(i, item){
                    alert("insdie 2");
                    alert(item);
                    }); 
```

**JSON数据**

```
{
  "title" : "x",
  "Description" : "rrr.",
  "images" : [ "http://1.jpg", "http://2.jpg", "http://3.jpg" ]
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T21:55:37.020

您的 JSON 数据没有名为 的属性`items`，因此`data.items`未定义。请尝试`data.images`：

```
$.each(data.images,function(i, item){ 
```

# java - 用内部类注释类

> ID：12117132
> 
> 赞同：6
> 
> 时间：2012-08-24T21:53:14.357
> 
> 标签：java, reflection, annotations

我通过**反射**创建我的**枚举**，为此我向每个枚举添加一个实现**抽象工厂**的内部类。现在我想访问这个内部类以调用该方法：

 ****```
@Factory(FooFactory.class)
public enum Foo {

     FOO, BAR;

     public class FooFactory implements AbstractFactory<Foo> {

          public Foo create(String value) {
               return valueOf(value.toUpperCase());
          }
     }
} 
```

的定义`@Factory`是：

```
@Retention(RetentionPolicy.RUNTIME)
public @interface Factory {

        Class<?> value();
} 
```

但是，有了这个，我收到以下**错误**：

> 类无法解析为 FooFactory.java 类型

当我尝试时，`@Factory(Foo$FooFactory.class)`我收到**错误**：

> 嵌套的 Foo$FooFactory 不能使用其二进制名称来引用。

那么甚至可以引用嵌套类吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-24T22:07:59.780

从评论中......显然

```
@Factory(Foo.FooFactory.class) 
```

需要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-24T21:57:38.037

您正在使用一个非静态嵌套类，它的作用域是枚举的各个实例。

相反，您需要一个静态嵌套类，如下所示：

```
public static class FooFactory implements AbstractFactory<Foo> {

      public static Foo create(String value) {
           return valueOf(value.toUpperCase());
      }
 } 
```

然而，所有这些都是多余的：你可以简单地调用`Foo.valueOf(value)`来实现这个目标。我在这里看不到任何附加值（没有双关语）。

工厂.java

```
import java.lang.annotation.*;
@Retention(RetentionPolicy.RUNTIME)
public @interface Factory {
        Class<?> value();
} 
```

FooEnum.java

```
@Factory(FooEnum.FooFactory.class)
public enum FooEnum {
    FOO, BAR;
    public static class FooFactory  {

          public static FooEnum create(String value) {
               return valueOf(value.toUpperCase());
          }
     }
} 
```

FooEnumMain.java

```
public class FooEnumMain {
    public static void main(String[] args) {
        FooEnum f = FooEnum.FooFactory.create("foo");
        System.out.println(f);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-24T22:03:09.860

在出现注释时，FooFactory 未定义，因此需要指定完整路径：

```
@Factory(Foo.FooFactory.class) 
```****

# objective-c - 从现有控制器创建 UIPopoverController

> ID：12117138
> 
> 赞同：0
> 
> 时间：2012-08-24T21:53:50.833
> 
> 标签：objective-c, ios, view, uipopovercontroller

我想在我的应用程序中使用 UIPopoverController 并尝试[此示例。](http://blog.blackwhale.at/?p=487)问题是该示例中的视图和控制器是从代码创建的。

```
 UIViewController* popoverContent = [[UIViewController alloc]
                  init];
   UIView* popoverView = [[UIView alloc]
                  initWithFrame:CGRectMake(0, 0, 200, 300)];
   popoverView.backgroundColor = [UIColor greenColor];
   popoverContent.view = popoverView; 
```

我想将现有控制器与它的 xib 文件一起用于弹出窗口。如何将弹出窗口链接到现有控制器？我是否需要以某种特殊的方式创建控制器的视图以匹配弹出窗口的尺寸？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:06:57.953

是的你可以：

```
 MyUIViewController* content = [[MyUIViewController alloc] initWithNibName:@"myNib" bundle: nil];
    // additional initialization in loadView

    UIPopoverController* aPopover = [[UIPopoverController alloc]
                                     initWithContentViewController:content]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:06:10.863

如果您想使用现有的 xib，只需使用该`nitWithNibName:bundle:`方法初始化您的 viewController。当您使用 xib 初始化时，将为您实例化 viewController 的视图层次结构。

```
UIViewController* popoverContent = [[UIViewController alloc] initWithNibName:@"yourXibName" bundle:nil]; 
```

初始化时不必担心视图的大小 - 在`contentSizeForViewInPopover`设置属性时，视图会在您在下一行引用的示例代码中调整大小。

# android - Android 自定义按钮按下状态

> ID：12117143
> 
> 赞同：4
> 
> 时间：2012-08-24T21:54:25.913
> 
> 标签：android, custom-controls

我正在尝试更改 Android 按钮的外观，但无法使其正常工作。我在“custom_button.xml”中使用此代码来处理按钮的绘制：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >
<item
    android:drawable="@drawable/btn_normal"

   />

<item  android:drawable="@drawable/btn_over" 
    android:state_pressed="true"/> 
```

在我的布局文件中，我将按钮的背景设置为 custom_button 可绘制对象。正常状态有效（第一个出现的状态），但是当按下按钮时，图像不会改变。我仔细检查以确保我使用的是不同的图像并且我是。有谁知道为什么这不起作用？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T22:30:48.800

切换项目的顺序（先按，然后按中性）。按下与否，最上面的项目总是正确的。

# opencl - 全局 ID 较大的工作项能否在全局 ID 较小的工作项之前执行？

> ID：12117144
> 
> 赞同：0
> 
> 时间：2012-08-24T21:54:27.673
> 
> 标签：opencl

我阅读了 OpenCL 规范，但没有找到全局 id 的分配方式。它是在 EnQueue 时间分配的，还是在运行时间分配的？

如果稍后，很容易看出具有较小 id 的工作项总是较早执行或与具有较大 id 的工作项同时（如果在同一个 warp 中）执行。如果在EnQueue时间分配，能保证执行顺序和全局id一致吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:26:05.107

OpenCL 不能保证工作组的执行顺序，因此您的算法不应依赖于此。

为了给你一个具体的例子来说明这种假设是如何失败的，想象一个内核中有一个依赖于数据的分支。在一个工作组中，可能需要占用分支的两侧，而在另一个工作组中，只需要占用一侧。后一个工作组将首先完成，即使它可能与前一个工作组同时开始。

# jquery - 使 jQuery 数据表在搜索/排序时保持分配的行号

> ID：12117145
> 
> 赞同：1
> 
> 时间：2012-08-24T21:54:29.130
> 
> 标签：jquery, datatables

我有以下代码在 jQuery Datatables 中创建行号：

```
"fnRowCallback": function(nRow, aData, iDisplayIndex, iDisplayIndexFull){ 
        var index = iDisplayIndexFull + 1; 
        $('td:eq(0)', nRow).html(index); 
        return nRow;
     }, 
```

但是，当我搜索某个值时，行号会更新。这是意料之中的。我的问题是，有没有办法让行号在最初创建后保持不变？

例子：

```
 Initial output
 1     Team1
 2     Team2
 3     Team3
 4     Team4
 5     Team5

 After Searching
 2     Team2
 5     Team5 
```

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-30T06:11:38.500

```
"fnDrawCallback": function ( oSettings ) {
 /* Need to redo the counters if filtered or sorted */
 if ( oSettings.bSorted || oSettings.bFiltered )
 {
 for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )
 {
 $('td:eq(0)', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( i+1 );
 }
 }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:06:24.057

您可以将原始 id 存储在`aData`：

```
aData.index = iDisplayIndexFull + 1; 
```

然后，您可以稍后通过以下方式访问它：

```
var index = oTable.fnGetData(your_row).index; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T22:01:24.243

我`data`最初会在行上设置一个属性，如下所示：

```
"fnRowCallback": function(nRow, aData, iDisplayIndex, iDisplayIndexFull){ 
        var index = iDisplayIndexFull + 1; 
        $('td:eq(0)', nRow).attr('data-index',$('td:eq(0)', nRow).attr('data-index')||index);
        $('td:eq(0)', nRow).html($('td:eq(0)', nRow).attr('data-index',index));
        return nRow;
     }, 
```

# java - 在 Java 中终止控制台应用程序

> ID：12117160
> 
> 赞同：1
> 
> 时间：2012-08-24T21:56:37.413
> 
> 标签：java

是否有终止控制台应用程序的命令，例如我们在 Swing 中的 System.exit(0)？谢谢。

S。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-24T21:58:11.633

`System.exit(0)`工作相同。

# javascript - 背景的/JavaScript 在本地显示/工作，而不是在服务器上

> ID：12117161
> 
> 赞同：0
> 
> 时间：2012-08-24T21:56:46.857
> 
> 标签：javascript, jquery, html, background, local

当我检查本地存储在我的计算机上的页面时，一切正常，但是当我将其上传到我的服务器时，背景/幻灯片转换的东西不起作用，它们甚至没有出现。这是我的代码：

```
<!doctype html>

<html lang="en-us">
<head>
<meta charset="utf-8">
<title>blah</title>
<meta name="description" content="Add Site Description Here">
<meta name="keywords" content="Add Keywords Here">

<link rel="stylesheet" href="style.css" media="all">
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
<script src="js/jquery-1.7.1.min.js"></script>
<script src="js/smooth-scroll.js"></script>
<script src="js/Easy_Background.js"></script>
<script src="js/jquery.easing.1.3.js"></script>
<script src="js/jquery.prettyPhoto.js"></script>

<!-- Fullsscreen Background -->
<script type="text/javascript">
      jQuery(document).ready(function($) {
        var background = new Easy_Background({
          background_color: "none",
          pattern: "img/patterns/pattern-4.png",
          autoplay: "true",
          autoplayTime: 5,

          images:["img/fullscreen/1.jpg", 
                  "img/fullscreen/2.jpg",
                  "img/fullscreen/3.jpg", 
                  "img/fullscreen/4.jpg",
                  "img/fullscreen/5.jpg",
                  "img/fullscreen/6.jpg", 
                  "img/fullscreen/7.jpg"],
          images_sizing: "fill", // fill || adjust || stretch || repeat

          animationIn: { attribute:["y", "alpha"], // x || y || alpha 
                value:  ["1px", 0],
                easing: ["easeOutCubic", "swing"],
                time: [0.7, 1.5],
                delay:  0 },
          animationOut: { attribute:[],
                 value:   [],
                 easing:  [],
                 time:  [],
                 delay: 0 }
        });
        $('body').click(background.next);
      });
    </script>
<script type="text/javascript">
  $(document).ready(function(){
    $("a[rel^='prettyPhoto']").prettyPhoto();
  });
</script>
</head> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:01:39.550

使用网络浏览器（我更喜欢 Chrome），按 F12（这会在 Chrome 和其他浏览器中打开网络检查器）。寻找“控制台”选项卡并将错误减少到零。

事实上，我认为你错过了上传一些文件。

顺便说一句，没有 JAVA 代码。你的意思是Javascript。那是完全不同的东西。

**更新** 您链接的 javascript 资源：

```
<script src="js/jquery-1.7.1.min.js"></script>
<script src="js/smooth-scroll.js"></script>
<script src="js/Easy_Background.js"></script>
<script src="js/jquery.easing.1.3.js"></script>
<script src="js/jquery.prettyPhoto.js"></script> 
```

但是你兄弟比我更清楚这一点。

# mysql - 将列数据转换为列并按该列分组

> ID：12117166
> 
> 赞同：0
> 
> 时间：2012-08-24T21:57:13.730
> 
> 标签：mysql

我有这张桌子：

```
Month    Type
JAN        A
JAN        A
FEB        B
FEB        B
FEB        A
FEB        A 
```

我想运行一个按月分组的查询，并计算该月某个类型的出现次数。
所以对于上表，输出应该是：

```
 A     B
JAN     2     0
FEB     2     2 
```

这可能是不可能的，但我想我会试一试。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:29:33.613

不幸的是 MySQL 没有一个`PIVOT`基本上是你想要做的功能。因此，您需要使用带有`CASE`语句的聚合函数：

```
SELECT Month,
  SUM(case when type = 'A' then 1 ELSE 0 END) as A,
  SUM(case when type = 'B' then 1 ELSE 0 END) as B
FROM yourTable
GROUP BY month 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/b8181/1)

现在，如果您想动态执行此操作，这意味着您事先不知道要转置的列，那么您应该查看以下文章：

[动态数据透视表（将行转换为列）](http://buysql.com/mysql/14-how-to-automate-pivot-tables.html)

您的代码如下所示：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'SUM(case when type = ''',
      type,
      ''' then 1 ELSE 0 END) AS ',
      type
    )
  ) INTO @sql
FROM test;

SET @sql = CONCAT('SELECT month, ', @sql, ' FROM test GROUP BY month');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/b8181/7)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:13:28.607

您不能仅使用 SQL 本身指定可变数量的列。您可以对查询做的最好的事情是分组`Month`，然后`Type`：

```
SELECT COUNT(*)
FROM table
GROUP BY Month, Type 
```

这样你最终会得到：

```
JAN   A   2
JAN   B   0
FEB   A   2
FEB   B   2 
```

可以在任何编程语言中以最小的努力将其转换为或视为数据透视表（如您的示例）。

# facebook-graph-api - MVC 4 oAuth With Facebook 不返回电子邮件地址

> ID：12117167
> 
> 赞同：3
> 
> 时间：2012-08-24T21:57:16.830
> 
> 标签：facebook-graph-api, asp.net-mvc-4, oauth-2.0, facebook-oauth

我正在试验本月发布的 MVC 4 oAuth。谁能指出我可以在哪里添加电子邮件地址，以便我可以将其与用户属性一起存储？

我需要能够发送欢迎电子邮件，但不知道从哪里开始使用开箱即用的 MVC 4 oAuth。

理想情况下，成功登录后，我希望在我的控制器中接收来自 Facebook 的用户信息并将其放入表中，以便离线进程可以发送欢迎电子邮件。

谢谢，维克多

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-14T15:53:38.247

这是因为 Facebook 允许其用户指定与第三方身份验证服务共享哪些数据，例如您的网站 Victor。默认情况下，我相信电子邮件地址（是的，您可以添加多个到 facebook 帐户）默认不共享。用户必须进入并明确与第三方共享他们的电子邮件地址——我认为没有人使用过。

Facebook 强制共享的唯一“强制性”共享数据是全名（例如“Eric Duncan”）。其他所有内容都是可选的供用户共享。

例如，我有我的 Facebook 设置只分享我的生日，但不分享出生年份。我也有我的 Facebook 设置来分享我的兴趣，但不是我的电子邮件。

因此，您必须为保证的内容编写代码——Facebook 的显示名称（在 MVC 4.0 OAuth 中称为“用户名”）。其他一切都无法保证。

我在我的 OAuth 应用程序（包括 Facebook 连接）中所做的是在成功通过第 3 方身份验证后，在回调 url 页面（例如 MVC 4.0 中的 ExternalLoginConfirmation.cshtml）上，我会要求用户输入他们的显示名称、电子邮件地址，生日等，并使用自定义视图模型上的标准数据注释使这些字段成为必需。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-09T00:53:16.397

为了让 Facebook 返回电子邮件，您必须在范围中指定它。例如，使用 JS SDK 你会做类似的事情......

```
return FB.login(function(response) {
    if (response.authResponse) {
      return window.location = '/auth/facebook/callback';
    }
  }, {scope: 'email,user_likes'}
); 
```

# asp.net - 当文本框位于 ListView 内时，如何捕获 textchanged 事件？

> ID：12117168
> 
> 赞同：2
> 
> 时间：2012-08-24T21:57:21.203
> 
> 标签：asp.net, listview

我在列表视图中有一系列文本框，其中包含员工的小时和分钟。我希望在任何文本框失去焦点时计算输入的值。我已经[从 MSDM 尝试过这个例子](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textbox.textchanged.aspx)。对于按钮和链接按钮，我可以使用**OnItemCommand**，对于 DDl 和列表框，我可以使用**OnSelectedIndexChanged**。

我的 texboxes 的 Textchanged 怎么样？我看不到他们有任何活动。在 MSDN 中，唯一类似的方法是**TextBox.TextChanged Event**。但它在那页上说：“**此 API 支持 .NET Framework 基础结构，不打算直接从您的代码中使用**。”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T22:34:28.550

`TextBoxes`它们在（`ItemTemplate`或 EditItemTemplate）中，不是吗？如果他们有`AutoPostBack=true`，他们会在文本更改并且焦点丢失后立即发回。和外面一样`ListView`。

在 aspx 上：

```
<ItemTemplate>
  <tr runat="server">
    <td>
      <asp:TextBox OnTextChanged="TextBox1_TextChanged" AutoPostBack="true"
            ID="Textbox1" runat="Server" Text="here is text"  />
    </td>
    <td>
  </tr>
</ItemTemplate> 
```

在代码隐藏中：

```
protected void TextBox1_TextChanged(object sender, EventArgs e)
{
   TextBox TextBox1 = (TextBox) sender;
} 
```

# javascript - 多行下划线模板和_.each

> ID：12117175
> 
> 赞同：3
> 
> 时间：2012-08-24T21:58:23.737
> 
> 标签：javascript, templates, loops, each, underscore.js

尝试解析存储为多行字符串的下划线模板时出现错误：

```
{{ _.each(records, function(record, index) { }}\
    <tr>\
        {{ record.get("hours") }}\
    </tr>\
{{ }) }}\ 
```

错误：

> Uncaught SyntaxError: Unexpected token )

在第 1 行（_.each 行）。

根据下划线的[文档](http://underscorejs.org)，语法对我来说是正确的。

编辑：我应该注意我在我的模板中使用 {{ 而不是 <%= 并且改回 <%= 并不能解决问题。

编辑：这是我用于评估的正则表达式：

```
// Underscore templates should use {{ variable_name }} instead of <%= variable_name =%>
_.templateSettings = {
    interpolate: /\{\{(.+?)\}\}/g
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T22:02:24.800

您需要使用`{[`, 进行评估。

假设您首先[定义了一个正则表达式](http://underscorejs.org/#template)来更改 underscore.js 用于评估的默认符号，例如

```
 _.templateSettings = {
       evaluate: /\{\[([\s\S]+?)\]\}/g,
       interpolate: /\{\{([\s\S]+?)\}\}/g, 
       escape: /\{\{-([\s\S]+?)\}\}/g
 }; 
```

然后你可以做类似的事情

```
{[ _.each(records, function(record, index) { ]}
    <tr>
        {{ record.get("hours") }}
    </tr>
{[ },this); ]} 
```

# php - 如何从另一个执行 php 脚本？

> ID：12117177
> 
> 赞同：2
> 
> 时间：2012-08-24T21:58:40.133
> 
> 标签：php, apache, exec, exe

如何从另一个执行 php 脚本？

我想从我的 php 文件中执行 3 个 php 脚本，而无需等待 3 个脚本完成。换句话说，这 3 个 php 文件需要一次全部执行（并行）而不是一个接一个（顺序执行）。

这 3 个脚本位于我的主 php 文件（脚本）的同一文件夹中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:03:13.937

如果您不想等待它们完成，请运行它们

```
exec('php script.php &> /dev/null &');
shell_exec('php script.php &> /dev/null &');
system('php script.php &> /dev/null &');
`php script.php &> /dev/null &` 
```

其中任何一个都应该完成这项工作，具体取决于您的 PHP 配置。尽管它们是不同的函数，但它们的行为应该相似，因为所有输出都被重定向到 /dev/null 并且进程会立即分离。

我在生产环境中使用第一个解决方案，其中客户端启动一个 bash SMS 发送脚本，该脚本可能需要 10 分钟才能完成，它从未失败过。

更多信息在： http: [//php.net/exec](http://php.net/exec) · [http://php.net/shell_exec](http://php.net/shell_exec) · [http://php.net/system](http://php.net/system)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:05:12.483

您需要将它们作为独立作业运行，这并不容易 - 或可移植。通常的解决方案是使用`nohup`或执行脚本，并将 stdout 和 stderr 重定向到 /dev/null（或 Windows 中的 NUL），但这通常会出现问题。

如果可能，将这三个脚本作为 Web 服务器上的脚本提供，并通过*异步*cURL 函数访问它们。这还具有能够通过浏览器测试脚本并为您提供脚本输出的优势。

其他方法包括使用`popen()`，或者如果在 Linux 下，使用`at`or`batch`实用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T22:07:31.200

取自[http://board.phpbuilder.com/showthread.php?10351142-How-can-I-exec%28%29-in-a-non-blocking-fashion](http://board.phpbuilder.com/showthread.php?10351142-How-can-I-exec%28%29-in-a-non-blocking-fashion)：

> 为了执行一个命令，让它在运行时不挂起你的 php 脚本，你运行的程序一定不能输出回 php。为此，请将 stdout 和 stderr 都重定向到 /dev/null，然后将其作为背景。

```
> /dev/null 2>&1 & 
```

> 为了执行一个命令并让它作为另一个不依赖于 apache 线程的进程继续运行（如果有人取消页面不会死）运行这个：

```
exec('bash -c "exec nohup setsid your_command > /dev/null 2>&1 &"'); 
```

对于 Windows [http://www.php.net/manual/en/function.exec.php](http://www.php.net/manual/en/function.exec.php)：

```
function execInBackground($path, $exe, $args = "") {
global $conf;

if (file_exists($path . $exe)) {
    chdir($path);
    if (substr(php_uname(), 0, 7) == "Windows"){
        pclose(popen("start \"bla\" \"" . $exe . "\" " . escapeshellarg($args), "r"));   
    } else {
        exec("./" . $exe . " " . escapeshellarg($args) . " > /dev/null &");   
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T22:30:59.113

在 shell_exec 中添加 '/B' 参数，这允许您一次运行多个可执行文件。请参阅我对这个问题的回答：[Windows 机器上的 PHP；在后台启动进程](https://stackoverflow.com/questions/2067900/php-on-a-windows-machine-start-process-in-background-then-kill-process/10898943#10898943)

一样的。

> shell_exec('start /B "C:\Path\to\program.exe"); /B 参数是这里的关键。我试图再次为您找到主题，但我似乎再也找不到了。这对我有用。

我希望这可以为您解决问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-24T22:00:29.657

如何使用`exec("php yourscript.php")`

请考虑使用排队系统来存储您的 php 脚本名称和工作人员以从队列中获取数据并执行例如[beanstalkd](http://kr.github.com/beanstalkd/)

# javascript - 编写 JavaScript 库：如何授权方法？

> ID：12117181
> 
> 赞同：0
> 
> 时间：2012-08-24T21:59:01.997
> 
> 标签：javascript, rest, authorization

好吧，这个话题的标题真的很愚蠢——但我无法用比这更好的方式来总结它。所以这是我的问题的更详细版本：

我正在创建一个小型 JavaScript 库，使开发人员能够将自定义事件的字符串发送到专用服务器（库中定义的 url）。假设该库称为“testLib”，使用该库的开发人员可以编写如下内容：

```
function success() {
   testLib.send("Everything OK");
} 
```

因此，每次调用此成功函数时，都会对库中定义的服务器进行 REST 调用（POST 请求）。到目前为止，这没有问题。

但丑陋的是，每个有 firebug 或类似的人也可以调用这些“testLib.send()”方法。这真的很难看，因为这个库背后的漏洞是**只**跟踪开发人员定义的事件。当然，服务器会负责基本的验证（来源检查、API 密钥等），但仍然：可以启动 firebug 并调用“testLib.send”方法。

有没有机会建立一个授权机制来防止“萤火虫用户”通过预定义的库方法发送休息调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:01:27.897

没有什么实用的。

该库在客户端的计算机上运行。你无法控制它。他们可以根据自己的喜好编辑 JS。如果他们愿意，他们可以完全绕过它并发送手工制作的 HTTP 请求（或者编写一个快速脚本来用请求轰炸服务器）。

您实施的任何真正的保护都必须在服务器上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T22:05:00.650

编写 Javascript 就像编写开源代码一样。FireBug 只是插件之一，它可以进入你的脚本，动态修改它，调用方法，访问变量等。事实上，你不必走那么远：大多数浏览器中的 Javascript 控制台包含一个快速评估输入框。因为 Javascript 是一个解释器，所以任何人都可以进入并为所欲为。

您有两个选择可能会使它变得更加困难（尽管肯定不是不可逾越的）：

1）当你完成后，混淆和/或打包脚本——尽管大多数混淆器很容易被绕过 2）让你的方法检查谁调用了它们——看看 arguments.callee.caller 。也就是说，这在严格模式下可能会遇到问题。

正如您所说，您最好的选择是在服务器端重复任何验证。如果服务器端验证失败 - 这实际上告诉你一些事情：有人故意绕过你的 Javascript，你可以相应地处理他。

希望这可以帮助

TG

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-24T22:08:01.447

## 验证用户

如果您的应用程序在页面加载时对用户进行身份验证，那么来自客户端的每个请求都会附带身份验证 cookie，因此基本上您将能够检测到发件人是谁。

## 混淆和私有闭包

但是，如果您想阻止以编程方式访问该特定功能，那么您最好的选择是函数闭包以使该功能私有且不可访问，并进行一些代码混淆以防止人们明显地重写整个内容。一个很好的混淆是启用了 Base62的[Javascript打包程序。](http://dean.edwards.name/packer/)

但是这种事情当然会混淆你的库，但公开访问的功能仍然可以访问。

## 防止匿名用户

然而。如果您希望匿名用户阻止向您的服务器发送内容，您实际上无法做到这一点，但是您可以通过让您的函数要求您的开发人员（真实用户）需要的某种注册密钥来识别未经授权的请求有，但匿名者不会。

也许在[Google](https://www.google.com/search?q=javascript+authentication)上找到的其他一些资源可能会有所帮助。只是为了刮擦表面。例如，XHR 允许用户发送用户名和密码来验证请求，这可能正是您所追求的。但是您应该知道得更多，因为您拥有图书馆设计而不是我们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T22:01:17.800

不会。因为 javascript 在客户端运行，所以您无法阻止他人读取客户端正在执行的内容并自行执行。你可以做一些事情来混淆你的电话，但这是[通过默默无闻的安全](http://en.wikipedia.org/wiki/Security_through_obscurity)- 不应该依赖。如果您想确保只有开发人员调用您的 API，他们需要在服务器端进行。

# django - Django 另一个优化 save()

> ID：12117183
> 
> 赞同：2
> 
> 时间：2012-08-24T21:59:15.570
> 
> 标签：django, django-models, query-optimization

在我的应用程序中优化查询的过程中，我注意到了一些奇怪的事情。在给定的代码部分中，我将获取对象，更新一些值，然后保存。理论上，这应该执行 2 个查询。但实际上它执行了 3 个查询。1 获取对象时选择查询，2 保存对象时选择查询（另一个选择然后更新！）。删除一个查询可能看起来很愚蠢。在这个特定的方法中，我更新了许多对象，因此我保存的每个查询对数据库的命中减少了 1 次，并且应该加快该方法的速度。

通过检查查询，两个选择查询不同，第一个得到很多东西，执行的选择很简单。

这是示例代码：

```
 myobject = room.myobjects.get(id=myobject_id) # one query executed here
            myobject.color = color
            myobject.shape = shape
            myobject.place = place
            myobject.save() # two queries executed here 
```

查询：

```
 1) "SELECT `rooms_object`.`id`, `rooms_object`.`room_id`, ......FROM `rooms_object` WHERE (`rooms_object`.`id` = %s AND `rooms_object`.`room_id` = %s )"

   2) "SELECT (1) AS `a` FROM `rooms_object` WHERE `rooms_object`.`id` = %s LIMIT 1"

   3) "UPDATE ......this ones obvious" 
```

我希望保存方法能够识别它已经在内存中拥有该对象，并且不需要再次获取它......如果这甚至可能......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T22:28:19.923

第二个查询实际上并没有再次拉下对象。`id`它在执行查询之前对“存在”进行了极快的检查`UPDATE`。从该查询返回的所有内容都是一个`1`，并且该字段已编入索引，因此它应该非常有效。

他们选择以这种方式设计 ORM 的原因是，他们首先查看您的对象以查看它当前是否具有 ID。如果是这样，他们会`SELECT`确保它确实仍然存在于数据库中。如果是，他们执行更新。如果不知何故该记录不存在，他们将执行`INSERT`. 您可以通过创建对象来测试这一点，然后在 django 不知道的情况下从数据库中手动删除该行。然后打电话`save()`

这就是确保 django 保持一致性的工作方式。

如果它是一个新对象，您只会得到一个`INSERT`查询，因为它知道该对象现在没有`id`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-09T16:49:51.283

这是通过 force_update 参数管理的

```
Model.save([force_insert=False, force_update=False, using=DEFAULT_DB_ALIAS, update_fields=None]) 
```

将 force_update 设置为 True 以禁用存在检查（“SELECT (1) AS `a`FROM...”）。

[https://docs.djangoproject.com/en/dev/ref/models/instances/](https://docs.djangoproject.com/en/dev/ref/models/instances/)

# c# - 是否可以从另一个控件触发器更改控件可见性

> ID：12117187
> 
> 赞同：1
> 
> 时间：2012-08-24T22:00:03.907
> 
> 标签：c#, wpf, xaml, triggers, styles

我有这种样式并触发组合框的 IsMouseOver 属性（变成菜单）。我想在触发此触发器时更改另一个对象的可见性（当鼠标悬停在项目上时）这可能吗？目前我只是在发生这种情况时设置前景，但我认为它们一定是一种方式。

```
<Style x:Key="HeaderMenuButtonStyle" TargetType="TextBlock">
    <Setter Property="Margin" Value="0,0,20,5" />
    <Setter Property="Foreground" Value="{StaticResource HeaderMenuButtonColorBrush}" />
    <Setter Property="FontSize" Value="24" />
    <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
            <Setter Property="Foreground" Value="{StaticResource HeaderMenuButtonHoverColorBrush}" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:05:03.977

您可以通过在受影响的控件上放置触发器来反转逻辑，但是您需要一种方法来定位应用此样式的控件。

例如

```
<DataTrigger Binding="{Binding IsMouseOver, ElementName=ThatMenuItem}" ...> 
```

使用`Interactivity`（Blend SDK）中的触发器和操作，您可能会影响其他控件，但您需要恢复您的操作，因为这些操作是必要的（即触发器也打开，执行必要的操作以恢复在-trigger`false`中所做的操作） `true`.

# sql - 结合使用 HAVING 和 MIN 时如何提高查询性能

> ID：12117188
> 
> 赞同：1
> 
> 时间：2012-08-24T22:00:06.527
> 
> 标签：sql, oracle, comparison

我有一个非常缓慢和简单的查询，我正在尝试改进，它的目的是获取第一次失败的单元的日期，如下所示：

```
select unit_id, min(fail_Date) fail_Date
    from failures
  having min(fail_date) between '24-aug-2012' and '25-aug-2012'
   group by unit_id 
```

您可能会猜到 Unit_id 不是唯一的，它是标识失败单元的外键，在此表中，如果同一单元多次失败，我有多个记录。

我知道这不是最好的方法，但我无法控制表格，我必须照原样处理它们。

该表具有fail_date 和unit_id 的索引。

尽管如此，这个查询需要 10 秒，我想问一下，我怎样才能让它更快？但后来我用这种方式查询值，只需要 0.03 秒：

```
with fail_dates as
 (select unit_id, fail_date
    from failures
   where fail_date between '24-aug-2012' and '25-aug-2012')
select f.unit_id, min(f.fail_Date) fail_Date
  from fail_dates
 inner join failures f
    on fail_dates.unit_id= f.unit_id
 group by f.unit_id,fail_dates.fail_date
 having  min(f.fail_Date) = fail_dates.fail_date 
```

它们都返回完全相同的记录，但是第二个记录要快 10 倍，现在我的问题是，这两个查询真的等效吗？为什么第二个要快得多？

谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T00:15:13.043

*我的结论已经改变，这个答案在很大程度上被重写了。*

起初我以为你的 2 个查询是不同的，但在阅读了你的评论并重新检查了第二个查询后，我意识到它确实会给出相同的结果。两个查询都只返回最早失败在 2 天范围内的单元。

您的第一个查询很慢，因为它在逻辑上必须查看每个单元的所有故障日期。它可能正在执行全表（或索引）扫描。

您的第二个查询要快得多，因为它只计算在目标日期范围内发生故障的单元的最短故障日期。我猜想它是使用前缘上带有失败日期的索引来识别在目标范围内失败的单元。然后它可以使用前缘上带有单元 id 的索引来查找相关单元的最小故障日期。

以下查询应该等同于您的查询，并且它有可能比您的第二个查询快一点，尽管我不会指望它。我说它可能会更快，因为此查询可以在找到任何具有早期失败日期的记录后立即消除一个单元，而您的第二个查询必须在逻辑上查看该单元的所有失败日期。只要这个查询不比你的第二个查询慢，我会选择这个，因为我认为逻辑更直接，更容易理解。

```
select unit_id,
       min(fail_Date) fail_Date
  from failures f
 where fail_date between '24-aug-2012' and '25-aug-2012'
   and not exists (
          select 1
            from failures f2
           where f2.unit_id=f1.unit_id
             and f2.fail_date < '24-aug-2012'
       )
 group by unit_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T22:13:18.200

我认为如果您将原始查询重写为

```
select unit_id, min(fail_Date) fail_Date
  from failures
  where fail_date between '24-aug-2012' and '25-aug-2012'
  group by unit_id 
```

我希望这与您的第二个查询一样好。此查询和您的第二个查询运行得更快的原因是因为您首先通过仅选择那些在所需范围内具有 FAIL_DATE 的记录来子集表 - 这可能允许使用索引。原始查询必须扫描整个表，因为没有 WHERE 子句来帮助它只挑选出感兴趣的记录。

您可能想查看这两个查询的 EXPLAIN PLAN 输出，以了解它们是如何被评估的。

分享和享受。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T22:12:15.253

如果不仔细观察它们，我会说它们是等效的，因为现在它们返回相同的行。不要指望它继续。

但是第二个版本中的公用表表达式（CTE）有一个非常严格的 WHERE 子句，只能选择两天的行。那个限制性的 WHERE 子句应该大大减少 GROUP BY 和 HAVING 必须做的工作。

您应该能够通过查看[执行计划](http://www.oracle.com/technetwork/database/focus-areas/bi-datawarehousing/twp-explain-the-explain-plan-052011-393674.pdf)（pdf，白皮书）来确定。

# html - 仅使用 CSS 的砌体式布局

> ID：12117195
> 
> 赞同：12
> 
> 时间：2012-08-24T22:01:06.617
> 
> 标签：html, css

正如您在图像中看到的，每个盒子都有不同的高度，并且有些盒子的宽度是双倍的。

![布局](../Images/523fd9ae0aa1a59c1ad2d3b9e67d8763.png)

是否可以仅使用 CSS 创建砖石风格的布局？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-24T22:09:57.780

使用 css3 支持，您可以这样做：

[http://jsfiddle.net/huAxS/2/](http://jsfiddle.net/huAxS/2/)

```
.container {
    -moz-column-count: 2;
    -moz-column-gap: 10px;
    -webkit-column-count: 2;
    -webkit-column-gap: 10px;
    column-count: 2;
    column-gap: 10px;
    width: 360px;
}

.container div {
    display: inline-block;
    width: 100%;
    background-color: red;
}​ 
```

没有css3支持，不幸的是你不得不求助于js。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T17:24:52.917

我现在正在一个具有相同布局的站点上工作，两列偶尔有双宽框。我所做的只是将双宽与其他内容分开。例如：

```
<div class="two-columns">
    <div></div>
    <div></div>
    <div></div>
    <div></div>
</div>
<div class="double-wide">
</div>
<div class="two-columns">
    <div></div>
    <div></div>
    <div></div>
    <div></div>
</div> 
```

然后，您可以将 CSS3 列解决方案应用于`two-columns`该类。如果您需要支持 IE9，您很遗憾需要添加[JavaScript fallback](http://sickdesigner.com/masonry-css-getting-awesome-with-css3/)。

# ios - Alpha 通道掩盖了 Cocos2d for iOS 上的其他精灵

> ID：12117197
> 
> 赞同：1
> 
> 时间：2012-08-24T22:01:15.687
> 
> 标签：ios, cocos2d-iphone, alpha, mask

我的精灵的 alpha 通道（有时）掩盖了其他精灵。

这是它的样子： ![截屏](../Images/ceee2cd4668a982f0e7efbf35f36e8e3.png)

如您所见，它不会一直发生，这里的所有头像都使用相同的纹理文件。以前有人遇到过这个问题吗？

顺便说一句，我使用 TexturePacker 导出精灵。我也在使用 Cocos2d 2.0，这就是我初始化它的方式：

```
CCGLView *glView = [CCGLView viewWithFrame:[window_ bounds] pixelFormat:kEAGLColorFormatRGBA8 depthFormat:GL_DEPTH_COMPONENT24_OES preserveBackbuffer:NO sharegroup:nil multiSampling:NO numberOfSamples:0];
[director_ setProjection:kCCDirectorProjection2D];
[CCTexture2D setDefaultAlphaPixelFormat:kCCTexture2DPixelFormat_RGBA4444];
[CCTexture2D PVRImagesHavePremultipliedAlpha:YES]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:50:15.577

当您将其加载为测试时，请尝试将您的 CCTexture2DPiexelFormat 设置为更高的规格：

```
[CCTexture2D setDefaultAlphaPixelFormat:kTexture2DPixelFormat_RGB5A1]; 
```

看看有没有帮助？我记得，RGBA4444 的位深度要低得多，但确实提供了改进的性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T01:13:03.853

在尝试了很多不同的事情之后，我发现让它工作的只是在节点上设置着色器程序：

`node.shaderProgram = [[CCShaderCache sharedShaderCache] programForKey:kCCShader_PositionTextureColorAlphaTest];`

# ios - iOS sqlite3_exec 中的 SQLite 失败

> ID：12117199
> 
> 赞同：0
> 
> 时间：2012-08-24T22:01:21.827
> 
> 标签：ios, sqlite

我有代码：

```
if (sqlite3_open([dbPath UTF8String], &db) == SQLITE_OK)
    {
        const char *sql_stmt = "create table contacts (id integer primary key autoincrement, name text, address text, phone text);";

        if (sqlite3_exec(db, sql_stmt, NULL, NULL, NULL) == SQLITE_OK)
        {
            av = [[UIAlertView alloc] initWithTitle:@"Success!!!" message:nil delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
        }
        else
        {
            av = [[UIAlertView alloc] initWithTitle:@"Error3" message:nil delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
        }
} else {
        av = [[UIAlertView alloc] initWithTitle:@"Error2" message:nil delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
    } 
```

我到达 sqlite3_exec 但它返回退出代码 26：打开的文件不是数据库文件。如果是这种情况，为什么 if 语句会执行呢？

提前致谢。

# enterprise-library - ExecuteNonQuery：连接属性尚未初始化

> ID：12117202
> 
> 赞同：3
> 
> 时间：2012-08-24T22:01:29.643
> 
> 标签：enterprise-library, executenonquery

我以前在这里看到过这个问题，但在使用企业库时从未见过。我以前使用过类似下面的代码，它工作正常。这次有什么问题？我在最后一行得到错误：

```
 Database db = new SqlDatabase(MyConfiguration.Current.ConnectionString);
    DbCommand cmd = db.GetStoredProcCommand("AddWorkListItem");

    db.AddInParameter(cmd, "@PartNumber", DbType.String, partNumber);
    db.AddInParameter(cmd, "@Quantity", DbType.Int32, qty);
    db.AddInParameter(cmd, "@WorkListTypeCode", DbType.String, code);
    db.AddInParameter(cmd, "@UserKey", DbType.Int32, userKey);

    return cmd.ExecuteNonQuery(); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-24T22:05:32.620

天哪，已经有一段时间了，但我很确定你打电话`db.ExecuteNonQuery(cmd)`而不是打电话`cmd.ExecuteNonQuery()`。你试过吗？

# sql - 如何制作可重复的索引脚本？

> ID：12117206
> 
> 赞同：5
> 
> 时间：2012-08-24T22:01:56.863
> 
> 标签：sql, firebird

我正在尝试构建一个 Firebird 脚本，以确保某个索引存在并正确创建。经过一番谷歌搜索，我得到了似乎正确的语法：

```
SET TERM ^ ;
execute block as begin
IF (EXISTS(SELECT RDB$INDEX_NAME
  FROM RDB$INDICES
 WHERE RDB$RELATION_NAME='TABLE_NAME'
 and RDB$INDEX_NAME = 'INDEX_NAME')) THEN
execute statement 'drop index INDEX_NAME';
end
SET TERM ; ^

CREATE UNIQUE INDEX INDEX_NAME
  ON TABLE_NAME
  (FIELD1, FIELD2, FIELD3); 
```

这将运行一次，并且工作正常。但是，如果我再次尝试运行它，我会收到“索引已存在”错误，这表明该`execute statement`部件实际上并未运行。

我错过了什么？如何使此脚本正常工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-25T12:31:46.653

使用**WITH AUTONOMOUS TRANSACTION**子句。以下代码适用于我：

```
EXECUTE BLOCK
AS BEGIN
  IF (EXISTS(SELECT RDB$INDEX_NAME FROM RDB$INDICES
    WHERE RDB$RELATION_NAME = '<relation_name>'
      AND RDB$INDEX_NAME = '<index_name>')) THEN
  BEGIN 
    EXECUTE STATEMENT 'drop index <index_name>'
      with autonomous transaction;
  END

  EXECUTE STATEMENT 'create index <index_name> on ...'
    with autonomous transaction;
END 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-24T23:59:04.240

你*提交*交易了吗？

大多数关系数据库默认在事务中运行。直到您`commit`或`rollback`交易未决。你需要

```
drop index foo

commit -- some implementations use 'commit work' others 'commit transaction'

create index foo on bar ( col_1 , ... , col_n )

commit -- some implementations use 'commit work' others 'commit transaction' 
```

# c++ - 这个“<>”在模板类函数中是什么意思？

> ID：12117210
> 
> 赞同：7
> 
> 时间：2012-08-24T22:02:30.860
> 
> 标签：c++, templates

有这样的代码。

```
const std::string DeviceTypeStrings[] ={ "A", "B", "C", "D", "E" };

enum DeviceTypes { A = 0, B, C, D, E };

template <DeviceTypes T> class DeviceType;
template <DeviceTypes T> std::ostream& operator<< (std::ostream& output, const DeviceType<T>& dev);

template <DeviceTypes T> class DeviceType {
    public:
         static const int value = T;
         static const std::string string;
         friend std::ostream & operator<< <>(std::ostream & output, const DeviceType<T> & deviceType );
};
template <DeviceTypes T> const std::string DeviceType<T>::string = DeviceTypeStrings[T];
template <DeviceTypes T> std::ostream & operator<< (std::ostream & output, const DeviceType<T> & deviceType ){
    if ( DeviceType<T>::string.find(' ') != std::string::npos ){
        return output << "\"" << DeviceType<T>::string << "\""; 
    } else {
        return output << DeviceType<T>::string;
    }   
}

int main () {
    DeviceType<A> myType;
    std::cout << myType << std::endl;
    return 0;    
} 
```

注意类DeviceType里面的operator<<后面有个“<>”，“<>”是什么意思？如果可以，为什么它必须在那里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T22:47:09.250

它只是意味着朋友声明是指*函数模板* `operator <<`的特定特化（先前声明的），而不是一些尚未声明的普通非模板函数 `operator <<`。

这个友元声明所指的特化是由参数推导机制决定的，即实际的模板参数是从友元声明中使用的参数类型隐式派生的。由于这个原因，不需要显式指定模板参数，但仍然需要`<>`一对空的。`<>`

换句话说，代码的作者本可以明确说明

```
friend std::ostream & operator<< <T>(std::ostream & output, 
                                     const DeviceType<T> & deviceType ); 
```

（注意 中的显式`T`）`<T>`。但是，由于编译器可以自己计算出来（从第二个参数的类型派生出来），所以完全可以只放一个空的对`<>`。

现在，如果代码刚刚说

```
friend std::ostream & operator<<(std::ostream & output, 
                                 const DeviceType<T> & deviceType ); 
```

（即根本没有`<>`），它会成为一个*普通*的（非模板）函数`operator <<`，这不是作者想要的。

在这个友元声明中起作用的重载解析功能可以通过以下简单示例在没有任何友元声明的情况下进行说明

```
void foo(int);
template <typename T> void foo(T);

int main() {
  foo(42);      // calls non-template function
  foo<int>(42); // calls template function, explicit template argument given
  foo<>(42);    // calls template function, template argument deduced by compiler
} 
```

当您想告诉编译器您特别想引用函数的模板版本时，您必须在引用中包含三角括号，即使它们之间没有任何内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-24T22:12:26.617

编译器检查`<`after`operator<<`是否是模板类的友元函数。它被认为是模板参数列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T22:52:18.643

与此[链接](http://www.cplusplus.com/doc/tutorial/templates/)相同。请参阅“模板专业化”一章。

```
// template specialization
#include <iostream>
using namespace std;

// class template:
template <class T>
class mycontainer {
    T element;
  public:
    mycontainer (T arg) {element=arg;}
    T increase () {return ++element;}
};

// class template specialization:
template <>
class mycontainer <char> {
    char element;
  public:
    mycontainer (char arg) {element=arg;}
    char uppercase ()
    {
      if ((element>='a')&&(element<='z'))
      element+='A'-'a';
      return element;
    }
};

int main () {
  mycontainer<int> myint (7);
  mycontainer<char> mychar ('j');
  cout << myint.increase() << endl;
  cout << mychar.uppercase() << endl;
  return 0;
} 
```

这就是您引用已定义的模板对象（或函数）的方式。

# python - Python Unicode 字符串替换：u、r 或无

> ID：12117211
> 
> 赞同：2
> 
> 时间：2012-08-24T22:02:39.837
> 
> 标签：python, unicode, ascii

您好，请看一下 Python 2.7 上的以下代码片段：

```
# -*- coding: utf-8 -*-
content = u"<p>和製英語とかカタカナ英語、&lt;br/>ジャパングリッシュなどと呼ばれる英語っぽいけど実は英語じゃない言葉があります。&lt;/p>"
#print content
print content.replace(u"<p>",u"<div>").replace(u"</p>",u"</div>").replace(u"<br/>",u"")
print content.replace("<p>","<div>").replace("</p>","</div>").replace("<br/>","")
print content.replace(r"<p>",r"<div>").replace(r"</p>",r"</div>").replace(r"<br/>",r"") 
```

结果是一样的：

```
<div>和製英語とかカタカナ英語、ジャパングリッシュなどと呼ばれる英語っぽいけど実は英語じゃない言葉があります。&lt;/div> 
```

我的问题是：三个“替换”语句之间有什么区别吗？(u, r or none?) 哪一个是最好的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:28:37.180

第一个是最好的。后两个选项必须将它们的字节字符串隐式转换为 Unicode，以对 Unicode 内容字符串进行替换。否则，使用提供的字符串，结果恰好是相同的。如果替换字符串包含非 ASCII 字符，则后两个会出现 UnicodeDecodeError，因为转换的默认编解码器`ascii`在 Python 2.X 上。

还要注意速度差异：

```
C:\>python -m timeit -s "content=u'<p>blah<br/>blah</p>'" "content.replace(u'<p>',u'<div>').replace(u'</p>',u'</div>').replace(u'<br/>',u'')"
1000000 loops, best of 3: 1.09 usec per loop

C:\>python -m timeit -s "content=u'<p>blah<br/>blah</p>'" "content.replace('<p>','<div>').replace('</p>','</div>').replace('<br/>','')"
1000000 loops, best of 3: 1.76 usec per loop

C:\>python -m timeit -s "content=u'<p>blah<br/>blah</p>'" "content.replace(r'<p>',r'<div>').replace(r'</p>',r'</div>').replace(r'<br/>',r'')"
1000000 loops, best of 3: 1.75 usec per loop 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:11:38.193

在这种情况下，没有区别，因为这些字符串是纯 ASCII。所以 u" " 与 r" " 和 " `<div>`" 是一样的——它是五个字节，.`<div>``<div>``<` `d` `i` `v` `>`

UTF8 将 ASCII 字符（低于 0x80）编码为......低于 0x80 的相同 ASCII 字符。所以 ASCII 中的 'd' 由字节 0x64 编码，其 UTF8 编码又是 0x64。直到没有国际字符（或者更好的是 00..7F 十六进制范围之外的字符），没有区别。

只要使用一个非ASCII 字符，就会出现差异。例如，在意大利语中，“Pero”是四个字符，编码为四个字节 Pero，而“Però”是四个字符，我认为编码为五个字节（或者是六个字节？），Per-0x80-0xF2 或类似的东西。

有人可能会争论（我也这样做）应该始终使用“u”前缀：如果不需要它没有区别，如果需要它会保存您的数据（UTF8 编码背后的原因是确切地促进这种类型的向后兼容性：请参阅[http://en.wikipedia.org/wiki/UTF-8](http://en.wikipedia.org/wiki/UTF-8)）。

# javascript - 用数组中的项目替换值

> ID：12117212
> 
> 赞同：0
> 
> 时间：2012-08-24T22:02:42.543
> 
> 标签：javascript, arrays, map

我真的不确定如何解释我想要实现的目标，但是做这样的事情的最简单方法是什么（在 javascript 中）：

```
function switchItUp(i){
    ...
}

old_values = [1, 2, 3, 4];
new_values = ['a', 'b', 'c', 'd'];

switchItUp(3); // returns "c" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:06:24.947

```
function switchItUp(i) {
    return new_values[old_values.indexOf(i)];
} 
```

请记住 indexOf 函数在 IE8 和更早版本中不起作用。如果您想在这些浏览器中获得支持，您可能想尝试 jQuery 的[inArray 函数](http://api.jquery.com/jQuery.inArray/)或 Underscore.js 的[indexOf 函数](http://underscorejs.org/#indexOf)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:19:16.240

循环遍历第一个数组直到找到值，使用循环变量索引到第二个数组：

```
function switchItUp(i) {
    var j, l = old_values.length;
    for (j = 0; j < l; j += 1) {
        if (old_values[j] === i) {
            return new_values[j];
        }
    }
} 
```

# wpf - 如何在 XAML 中构建控件网格？

> ID：12117219
> 
> 赞同：2
> 
> 时间：2012-08-24T22:03:56.203
> 
> 标签：wpf, xaml

我正在尝试在 WPF 中构建一个符合规范的 UI。UI 用于编辑项目集合。每个项目都有一个可编辑的字符串属性，以及 UI 需要显示的可变数量的只读字符串。它可能看起来像这样：

                                  ![在此处输入图像描述](../Images/bed954a2ac995328afee73facd562bd6.png)

或者，根据数据，可能有不同数量的文本标签列：

                                      ![在此处输入图像描述](../Images/9b1c0b25f3b16e980ec0507677637d96.png)

**文本列的数量是完全可变的，可以从一到“很多”不等。**规范要求调整列的大小以适应最长的条目（它们总是很短），整个东西应该看起来像一个网格。这个网格将包含在一个窗口中，水平拉伸文本框以适应窗口。

重要的是，文本框可以包含多行文本，并且会自动增长以适应文本。如果发生这种情况，需要将下面的行推开。

**问题**：在 WPF 中这样做的好方法是什么？

来自 WinForms 背景，我正在考虑一个`TableLayoutPanel`，它直接由我编写的代码填充。但是，我需要在 WPF 中执行此操作。虽然我仍然可以自己获取 a`Grid`并在代码中填充它，但我真的更喜欢一种更符合 WPF 中的完成方式的方式：即定义一个 ViewModel，填充它，然后完全在 XAML 中描述视图. 但是，我想不出在 XAML 中描述这种视图的方法。

使用 MVVM 和 XAML 最接近的方法是使用`ItemsControl`每行一个项目，并使用数据模板，该数据模板反过来使用另一个`ItemsControl`（这次水平堆叠）用于可变数量的标签，然后是文本盒子。不幸的是，这不能像规范要求的那样以网格模式垂直对齐。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:51:13.040

您可以创建自己的`Panel`，然后决定您希望布局逻辑如何为放入其中的子级工作。

看看这个以获得灵感：

*   [http://www.nbdtech.com/Blog/archive/2010/07/27/easy-form-layout-in-wpf-part-1-ndash-introducing-formpanel.aspx](http://www.nbdtech.com/Blog/archive/2010/07/27/easy-form-layout-in-wpf-part-1-ndash-introducing-formpanel.aspx)

您可以有一个“ColumnCount”属性，然后在`MeassureOverride`and中使用它`ArrangeOverride`来决定何时包装一个孩子。

* * *

或者您可以修改这段代码（我知道它是 Silverlight 代码，但它在 WPF 中应该接近相同）。

*   [http://blogs.planetsoftware.com.au/paul/archive/2010/04/30/autogrid-ndash-part-1.aspx](http://blogs.planetsoftware.com.au/paul/archive/2010/04/30/autogrid-ndash-part-1.aspx)

您可以添加一个 List/Collection 属性来记录所需大小的不同列宽，然后`AutoGrid_LayoutUpdated`使用这些宽度来生成`ColumnDefinition`值，而不是让所有列的宽度都相同（默认值为 1 星“*”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T12:25:08.947

在代码隐藏中执行它实际上不是 WPFish（wpf 方式）。在这里，我为您提供我的解决方案，看起来不错。

0) 在开始之前，你需要 GridHelpers。这些确保您可以动态更改行/列。你可以用一点谷歌找到它：

[如何将 RowDefinition 动态添加到 ItemsPanelTemplate 中的网格？](https://stackoverflow.com/questions/9000549/how-can-i-dynamically-add-a-rowdefinition-to-a-grid-in-an-itemspaneltemplate)

在实际实现某些东西之前，您需要稍微重构一下您的程序。您需要新结构“CustomCollection”，它将具有：

*   RowCount - 有多少行（使用 INotifyPropertyChanged 实现）
*   ColumnCount - 有多少列（使用 INotifyPropertyChanged 实现）
*   ActualItems - 您自己的“行/项目”集合（ObservableCollection）

1) 首先创建一个包含 Grid 的 ItemsControl。确保 Grid RowDefinitions/ColumnDefinitions 是动态的。应用 ItemContainerStyle。

```
 <ItemsControl 
      ItemsSource="{Binding Collection.ActualItems, 
        Converter={StaticResource presentationConverter}">
      <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
          <Grid
             local:GridHelpers.RowCount="{Binding Collection.RowCount}"
             local:GridHelpers.StarColumns="{Binding Collection.ColumnCount, 
               Converter={StaticResource subtractOneConverter}"
             local:GridHelpers.ColumnCount="{Binding Collection.ColumnCount}" />
        </ItemsPanelTemplate>
      </ItemsControl.ItemsPanel>
      <ItemsControl.ItemContainerStyle>
         <Style TargetType="{x:Type FrameworkElement}">
           <Setter Property="Grid.Row" Value="{Binding RowIndex}"/>
           <Setter Property="Grid.Column" Value="{Binding ColumnIndex}"/>
         </Style>
     </ItemsControl.ItemContainerStyle>
    </ItemsControl> 
```

剩下要做的唯一一件事是：实现将您的 Viewmodel 演示文稿转换为 View 演示文稿的presentationConverter。（阅读：[http](http://wpftutorial.net/ValueConverters.html) ://wpftutorial.net/ValueConverters.html ）

转换器应该返回一组项目，其中每个“标签”或“文本框”都是一个单独的实体。每个实体都应该有 RowIndex 和 ColumnIndex。

这是实体类：

```
public class SingleEntity
{
   ..RowIndex property..
   ..ColumnIndex property..
   ..ContentProperty..  <-- This will either hold label string or TextBox binded property.
   ..ContentType..
} 
```

请注意，ContentType 是一个枚举，您将在 ItemsTemplate 中绑定它来决定您是否应该创建 TextBox 或 Label。

这似乎是一个相当冗长的解决方案，但实际上它很好，原因如下：

*   ViewModel 不知道发生了什么。这纯粹是视图问题。
*   一切都是动态的。一旦您在 ViewModel 中添加/或删除某些内容（假设一切都已正确实现），您的 ItemsControl 将重新触发转换器并再次绑定。如果不是这种情况，您可以设置 ActualItems=null 然后返回。

如果您有任何问题，请告诉我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T22:41:15.863

这并不能很好地映射，您可能可以使用 a[`DataGrid`](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.aspx)并将其重新[模板化](http://msdn.microsoft.com/en-us/library/system.windows.controls.control.template.aspx)，使其看起来像这样。在其他方法中，您可能需要强制添加列等以正确完成布局。

（您可以挂钩[`AutoGeneratingColumn`](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.autogeneratingcolumn.aspx)以将该可写列的宽度设置为`*`）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T23:54:00.370

您已经提出了很多要求，以下代码显示了如何使用所需大小的控件构建网格，以及设置绑定：

```
 public void BuildListTemplate(IEnumerable<Class1> myData, int numLabelCols)
    {
        var myGrid = new Grid();

        for (int i = 0; i < myData.Count(); i++)
        {
            myGrid.RowDefinitions.Add(new RowDefinition() { Height= new GridLength(0, GridUnitType.Auto)});
        }
        for (int i = 0; i < numLabelCols; i++)
        {
            myGrid.ColumnDefinitions.Add(new ColumnDefinition() { Width = new GridLength(0, GridUnitType.Auto) });
        }
        myGrid.ColumnDefinitions.Add(new ColumnDefinition() { Width = new GridLength(1, GridUnitType.Star) });
        for (int i = 0; i < myData.Count(); i++)
        {
            for (int j = 0; j < numLabelCols; j++)
            {
                var tb = new TextBlock();
                tb.SetBinding(TextBlock.TextProperty, new Binding("[" + i + "].labels[" + j + "]"));
                tb.SetValue(Grid.RowProperty, i);
                tb.SetValue(Grid.ColumnProperty, j);
                tb.Margin = new Thickness(0, 0, 20, 0);
                myGrid.Children.Add(tb);
            }
            var edit = new TextBox();
            edit.SetBinding(TextBox.TextProperty, new Binding("[" + i + "].MyEditString"));
            edit.SetValue(Grid.RowProperty, i);
            edit.SetValue(Grid.ColumnProperty, numLabelCols);
            edit.AcceptsReturn = true;
            edit.TextWrapping = TextWrapping.Wrap;
            edit.Margin = new Thickness(0, 0, 20, 6);
            myGrid.Children.Add(edit);
        }
       contentPresenter1.Content = myGrid;
    } 
```

**上面的快速解释**它所做的就是创建网格，定义网格的行；以及一系列自动调整内容大小的网格列。

然后它只是为每个数据点生成控件，设置绑定路径，并分配各种其他显示属性以及为控件设置正确的行/列。

最后，它将网格放入已在窗口 xaml 中定义的 contentPresenter 中以显示它。

现在您需要做的就是创建一个具有以下属性的类，并将 contentPresenter1 的数据上下文设置为该对象的列表：

```
public class Class1
{
    public string[] labels { get; set; }
    public string MyEditString { get; set; }
} 
```

只是为了完整起见，这里是窗口 xaml 和构造函数，以显示将其全部连接起来：

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
<ContentPresenter Name="contentPresenter1"></ContentPresenter>
</Window>

    public MainWindow()
    {
        InitializeComponent();

        var data = new List<Class1>();

        data.Add(new Class1() { labels = new string[] {"the first", "the second", "the third"}, MyEditString = "starting text"});
        data.Add(new Class1() { labels = new string[] { "col a", "col b" }, MyEditString = "<Nothing>" });

        BuildListTemplate(data, 3);
        DataContext = data;
    } 
```

您当然可以使用其他方法，例如列表视图并为其构建网格视图（如果您有大量行，我会这样做）或其他一些此类控件，但考虑到您的特定布局要求，您可能会想要这个方法用网格。

**编辑**：刚刚发现您正在寻找一种在 xaml 中做事的方式 - 我只能说我不认为您想要的功能太可行。如果您不需要将内容与单独的行上的动态大小的内容对齐，那将更可行......但我还要说，不要害怕后面的代码，它在创建 ui 时就有它的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-24T22:07:45.213

好吧，简单但不是很高级的方法是在代码隐藏中动态填充 UI。这似乎是最简单的解决方案，它或多或少符合您的 winforms 体验。

如果您想以 MVVM 方式执行此操作，您或许应该使用`ItemsControl`，将项目集合设置为其`ItemsSource`，并为您的集合项目类型定义 a `DataTemplate`。

我会有`DataTemplate`类似的东西：

```
<Window x:Class="SharedSG.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:app="clr-namespace:SharedSG"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <DataTemplate DataType="{x:Type app:LabelVM}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition SharedSizeGroup="G1"/>
                    <ColumnDefinition SharedSizeGroup="G2"/>
                    <ColumnDefinition MinWidth="40" Width="*"/>
                </Grid.ColumnDefinitions>
                <Label Content="{Binding L1}" Grid.Column="0"/>
                <Label Content="{Binding L2}" Grid.Column="1"/>
                <TextBox Grid.Column="2"/>
            </Grid>
        </DataTemplate>
    </Window.Resources>
    <Grid Grid.IsSharedSizeScope="True">
        <ItemsControl ItemsSource="{Binding}"/>
    </Grid>
</Window> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-20T18:52:39.223

你可能已经解决了这个问题，但我最近遇到了一个类似的问题，我让它在 xaml 中运行得非常好，所以我想我会分享我的解决方案。

主要的缺点是您必须愿意为“大量”标签的含义设置上限。如果手数可能意味着 100 个，那么这是行不通的。如果批次肯定少于您愿意键入 Ctrl+V 的次数，那么您也许可以让它工作。您还必须愿意将所有标签放入视图模型中的单个 ObservableCollection 属性中。在你的问题中，我觉得你已经尝试过了。

我利用`AlternationIndex`获取标签的索引并将其分配给列。[想我是从这里](https://stackoverflow.com/questions/11462229/styling-a-listboxitem-depending-on-its-index-in-the-listbox)学到的。如果一个项目有 < x 标签，则额外的列不会妨碍。如果一个项目有 > x 个标签，标签将开始堆叠在一起。

```
<!-- Increase AlternationCount and RowDefinitions if this template breaks -->
<ItemsControl ItemsSource="{Binding Labels}" IsTabStop="False" AlternationCount="5">
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                 <TextBlock Text="{Binding}"/>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
        <ItemsControl.ItemContainerStyle>
            <Style TargetType="{x:Type ContentPresenter}">
                <Setter Property="Grid.Column" 
                        Value="{Binding RelativeSource={RelativeSource Self}, 
                                        Path=(ItemsControl.AlternationIndex)}"/>
            </Style>
        </ItemsControl.ItemContainerStyle>
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <Grid IsItemsHost="True">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition SharedSizeGroup="A"/>
                        <ColumnDefinition SharedSizeGroup="B"/>
                        <ColumnDefinition SharedSizeGroup="C"/>
                        <ColumnDefinition SharedSizeGroup="D"/>
                        <ColumnDefinition SharedSizeGroup="E"/>
                    </Grid.ColumnDefinitions>
                </Grid>
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
    </ItemsControl> 
```

# jquery - jQuery函数需要两次点击

> ID：12117221
> 
> 赞同：1
> 
> 时间：2012-08-24T22:04:04.777
> 
> 标签：jquery, click

如果存在特定类（“当前”），我需要在单击选项卡时调整一个元素的 CSS。单击选项卡时会添加“当前”类。我的代码有效，但需要单击两次-我认为是因为在第一次单击时，添加了类，然后在第二次单击时，jQuery 检测到它。这是jquery代码：

```
 $('ul.tabs a').click(function() {
     if($('a#tab5').hasClass('current')) {
        $('#rightCorner').css("top","1px");
     } else {
        $('#rightCorner').css("top","7px");
     };
}) 
```

有没有办法让它一键工作？

谢谢 - 乔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:08:35.527

你能把添加`current`类的代码和这个监控tab5的点击处理程序结合起来吗？这允许您添加类，然后执行检查。在您的情况下，操作顺序出错。

```
$('ul.tabs a').click(function() {     
     $('ul.tabs a').removeClass('current');
     $(this).addClass('current');
     if (this.id == 'tab5') {
          $('#rightCorner').css("top","1px");
     }
     else {
          $('#rightCorner').css("top","7px");
     }
}) 
```

更新：

使用 CSS 而不是 if 语句可能更容易处理选项卡 5。

```
ul.tabs a#tab5 { top: 7px; }
ul.tabs a#tab5.current { top 1px; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:14:39.590

在`else`分支中，您可能需要添加

```
$('a#tab5').addClass('current'); 
```

# r - 从字符向量创建函数列表

> ID：12117223
> 
> 赞同：7
> 
> 时间：2012-08-24T22:04:14.417
> 
> 标签：r, user-defined-functions

在此先感谢，如果这个问题之前已经回答过，我很抱歉 - 我已经看过很多了。我有一个数据集，其中包含一行连接信息，特别是：名称、颜色代码、一些函数表达式。例如，一个值可能是：

成本#FF0033@log(x)+6。

我拥有提取信息的所有代码，最后得到一个表达式向量，我想将其转换为实际函数列表。

例如：

```
func.list <- list()
test.func <- c("x","x+1","x+2","x+3","x+4") 
```

其中 test.func 是表达式的向量。我想要的是：

```
func.list[[3]] 
```

相当于

```
function(x){x+3} 
```

我知道我可以使用以下方法创建一个函数：

```
somefunc <- function(x){eval(parse(text="x+1"))} 
```

将字符值转换为函数。当我尝试循环创建多个功能时，问题就来了。对于我尝试过但不起作用的示例：

```
for(i in 1:length(test.func)){
  temp <- test.func[i]
  f <- assign(function(x){eval(expr=parse(text=temp))})
  func.list[[i]] <- f
} 
```

基于另一篇文章（http://stats.stackexchange.com/questions/3836/how-to-create-a-vector-of-functions）我也试过这个：

```
makefunc <- function(y){y;function(x){y}}
for(i in 1:length(test.func)){
   func.list[[i]] <-  assign(x=paste("f",i,sep=""),value=makefunc(eval(parse(text=test.func[i]))))
 } 
```

这给出了以下错误： eval 中的错误（expr，envir，enclos）：找不到对象'x'

最终目标是获取函数列表并将第 j 个函数应用于 data.frame 的第 j 列，以便脚本用户可以指定如何规范化列标题给出的连接信息中的每一列。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T22:19:19.327

也许用一个通用函数初始化您的列表，然后使用以下方法更新它们：

```
foo <- function(x){x+3}
> body(foo) <- quote(x+4)
> foo
function (x) 
x + 4 
```

更具体地说，从一个角色开始，您可能会执行以下操作：

```
body(foo) <- parse(text = "x+5") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T14:34:55.070

只是为了添加到 joran 的答案，这就是最终奏效的方法：

```
test.data <- matrix(data=rep(1,25),5,5)
test.data <- data.frame(test.data)

test.func <- c("x","x+1","x+2","x+3","x+4")
func.list <- list()

for(i in 1:length(test.func)){
  func.list[[i]] <- function(x){}
  body(func.list[[i]]) <- parse(text=test.func[i])
}

processed <- mapply(do.call,func.list,lapply(test.data,list)) 
```

再次感谢，乔兰。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-20T02:23:54.283

这就是我所做的：

```
f <- list(identity="x",plus1 = "x+1", square= "x^2")
funCreator <- function(snippet){
  txt <- snippet
  function(x){
    exprs <- parse(text = txt)
    eval(exprs)   
  }
}
listOfFunctions <- lapply(setNames(f,names(f)),function(x){funCreator(x)}) # I like to have some control of the names of the functions
listOfFunctions[[1]] # try to see what the actual function looks like?
library(pryr)
unenclose(listOfFunctions[[3]]) # good way to see the actual function http://adv-r.had.co.nz/Functional-programming.html
# Call your funcions
listOfFunctions[[2]](3) # 3+1 = 4
do.call(listOfFunctions[[3]],list(3)) # 3^2 = 9
attach(listOfFunctions) # you can also attach your list of functions and call them by name
square(3)  # 3^2 = 9
identity(7) # 7 ## masked object identity, better detach it now!
detach(listOfFunctions) 
```

# firefox - 在 Firefox 和 Chrome 上，带有边框的图像的边框半径不同

> ID：12117224
> 
> 赞同：0
> 
> 时间：2012-08-24T22:04:17.577
> 
> 标签：firefox, google-chrome, border, css

这最好用图像来解释。

火狐，对：![在此处输入图像描述](../Images/616d044909d7a4c35f02c5c6ef774d4c.png)

铬，错误：![在此处输入图像描述](../Images/ce08b95f7d637f7567a7d9e745dd2f6d.png)

[jsfiddle](http://jsfiddle.net/Camilo/7cxBE/)。

这是一个（全绿色）图像，具有 2px（红色）边框和 6px 边框半径。在我的设计中，边框几乎看不到，所以图像在 Chrome 中看起来完全是方形的。

是否可以在没有额外标记或 javascript 的情况下在 Chrome 中获得正确的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:11:46.733

我不相信你可以用 Chrome 做到这一点。图像将超出 的范围`border-radius`，我认为这是预期的行为（否则他们只是没有注意到）。

例如，当[使用 a`div`](http://jsfiddle.net/eaZjX/)时，您可以看到背景的行为应有尽有。您可以考虑[使用 a`div`而不是`img`](http://jsfiddle.net/gau7M/)，并将源图像用作背景（并强制其宽度和高度）。

简单地说：在 Chrome 中，似乎没有办法强制您的图像被自身（甚至其容器）的边框隐藏，除非它被设置为背景。事实上，这个问题[之前已经被问过](https://stackoverflow.com/questions/8705249/css-border-radius-not-trimming-image-on-webkit)，并且[在博客](http://css-tricks.com/forums/discussion/11249/chrome-webkit-border-radius-bug/p1)上也被问过（事实上，*patrickzdb*的评论可能会对你有所帮助）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:29:53.763

显然这是chrome中的一个错误..

我通常为 chrome 应用 box-shadow 而不是边框​​。

所以，如果你不介意在没有 javascript 的情况下应用 css hack 来解决它：http: [//jsfiddle.net/3cuHU/](http://jsfiddle.net/3cuHU/)

# c - Linux内核：等待其他线程完成

> ID：12117227
> 
> 赞同：1
> 
> 时间：2012-08-24T22:04:31.897
> 
> 标签：c, multithreading, linux-kernel

我有一个 linux 内核模块，我必须实现一个 TCP 服务器和多个客户端来发送一些流量。我有一个问题，

现在在服务器端，我有一个 main-kthread，一旦它看到等待接受的 TCP 连接就会产生另一个 kthread。现在在主 kthread 产生后说几个 kthreads 我如何将 main-kthread 置于等待状态以确保其他 kthreads 在 main-kthread 可以退出之前退出。

我正在寻找类似于 phtread-join 语义的东西，但我在 Linux 内核空间中需要它。

我找不到这样的 kthread_join，我正在寻找替代方案。我确实读过关于等待队列的内容。因此正在查看interruptible_sleep_on() 和wake_up()。但我无法弄清楚如何使用这些 API。
例如，
在主线程中，我做了一个interruptible_sleep_on，那么谁来唤醒他呢？所有其他线程，还是最后一个线程？我如何确定谁是最后一个退出的线程？还有如何确保当这个 main-kthread 被唤醒时，其他线程已经退出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:40:51.110

等待队列是正确的工具。[*Linux Device Drivers* (LDD)](http://lwn.net/Kernel/LDD3/) [第 6 章](http://lwn.net/images/pdf/LDD3/ch06.pdf)中有很好的描述。这是您的代码可能看起来如何的草图：

*   维护一个服务器线程计数器。
*   在生成服务器线程之前增加计数器。
*   当服务器线程存在时，减少计数器。
*   在主线程中，退出时，在等待队列中等待，直到计数器值为 0。
*   在服务器线程中，在减少计数器之后，通过等待队列上的信号通知主线程。

[警告：未经测试的代码，这只是一个骨架。]

```
struct global_data {
    wait_queue_head_t wq;
    atomic_t thread_count;
};

main_thread () {
    global_data gd = {0};
    init_wait_queue_head(&gd.wq);
    while (serving) {
        …
        atomic_inc(&server_threads);
        if (IS_ERR_OR_NULL(kthread_create(server_thread, &gd)) {
            atomic_dec(&server_threads);
        }
    }
    wait_event_interruptible(&gd.wq, atomic_read(gd.thread_count) == 0);
    /* final cleanup */
}

server_thread (global_data *gd) {
    …
    atomic_dec(&gd->server_threads);
    wake_up(&gd->wq);
} 
```

# javascript - 未选中复选框时启用悬停并在选中复选框后禁用它

> ID：12117230
> 
> 赞同：0
> 
> 时间：2012-08-24T22:04:48.220
> 
> 标签：javascript, jquery, css, class

我正在尝试在未选中复选框时启用悬停（添加'.add_link_twitter_hover'类）并在选中复选框后禁用它（删除'.add_link_twitter_hover'类），就像Pinterest对Twitter/Facebook复选框一样用户添加了一个 pin： ![在此处输入图像描述](../Images/ab40be380811e73c411a06063bc443ea.png)

我试过这个，但是一旦鼠标指针离开，它就不会禁用悬停（不会删除'.add_link_twitter_hover'类）：

```
 var hoverTwitter = "add_link_twitter_hover";
$(postTwitter + " input").click(function(e) {
            $(this).parent().removeClass(hoverTwitter);
    $(this).parent().toggleClass(activePostTwitter);
});

$("label.add_link_twitter").hover(function(e) {
    if($("input.publish_to_twitter").is(":checked")) {
          $(this).removeClass(hoverTwitter);
      return;
    }
    $(this).addClass(hoverTwitter);
}); 
```

知道如何在未选中复选框时启用悬停并在选中复选框后禁用它？提前致谢！

这是jQuery：

```
var postTwitter = ".add_link_twitter"; 
var activePostTwitter = "active"; 
$(postTwitter + " input").click(function(e) {
    $(this).parent().toggleClass(activePostTwitter);
}); 
```

这是html：

```
<label class="add_link_twitter">
<input type="checkbox" name="publish_to_twitter" class="publish_to_twitter"><span>Share on Twitter</span>
</label> 
```

这是CSS：

```
.add_link_twitter{
    position:absolute;
    left:15px;
    bottom:16px;
    color: #a19486;
    border: 2px solid transparent;
    border-color: #F0EDE8;
    border-radius: 4px;
    font-size: 13px;
    font-weight: bold;
    cursor: pointer;
    padding: 7px;
    padding-top: 5px;
    padding-bottom: 5px;
}

.active {
    border-color: #468BD0;
    color: #468BD0;
    background-color: whiteSmoke;
}

.add_link_twitter_hover
{
    color: #A19486;
    border: 2px solid transparent;
    border-color: #C2B1A2;
    border-radius: 4px;
    background-color: white;
    padding: 7px;
    padding-top: 5px;
    padding-bottom: 5px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:10:21.337

试试这个：

```
$("label.add_link_twitter").hover(function(e) {
    if(!$("input.publish_to_twitter").is(":checked"))
          $(this).addClass(hoverTwitter);
}, function() {
    $(this).removeClass(hoverTwitter);
}); 
```

使用该方法的常用[`.hover()`方法](http://api.jquery.com/hover/)是提供*两个*函数：第一个函数在鼠标移到相关元素上时调用，第二个函数在鼠标移出时调用。

所以我上面所做的是在第一个函数（mouseenter）中，如果未选中复选框，我已经添加了你的类。在第二个函数（mouseleave）中，我只是删除了这个类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:42:08.780

这可以在没有任何 javascript 的情况下完成。如果您希望始终拥有“publish_to_twitter”类，只需使用伪类将两个状态分开：

```
.publish_to_twitter:hover{
width:50px;
}
input.publish_to_twitter:checked{
width:500px;
} 
```

我在选择器中添加了输入元素，以确保选中的样式优先。只需确保对于您使用 :hover 设置的每种样式，您在 :checked 中都有相同的样式。

# java - 开发既可在 Web 上运行又可作为 Android 应用程序运行的 Java 应用程序？

> ID：12117239
> 
> 赞同：4
> 
> 时间：2012-08-24T22:05:23.773
> 
> 标签：java, android

我正在开发一款游戏，它既可以作为小程序在网络上运行，也可以作为应用程序在 Android 手机上运行。

是否可以这样做，如果可以，我需要注意什么才能使其正常工作（即，如果有任何设置我不应该硬编码，而是在游戏运行时根据用户的设备确定它们，或任何我不应该使用的 java 库？）。

此外，游戏需要接受触摸屏作为 Android 应用程序的输入。是否可以构建到同样作为小程序运行的同一个游戏中？可能是在运行时，小程序在运行时决定是使用鼠标还是触摸屏进行输入？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T22:13:08.140

尽管 Android 应用程序是用 Java 编写的，但围绕应用程序的框架与围绕小程序的框架非常不同。您将无法拥有一个 .jar 文件，您可以将其作为小程序包含在 Android 设备上，因为这不是它的工作方式。

然而，您可能能够创建所有游戏逻辑和对象，并将它们与小程序代码和 Android 应用程序共享。您甚至可以将它们放在一个存储库和项目中（尽管它可能必须是一个 Android 项目，然后您将其嵌入您的应用程序构建脚本中）。

为了处理游戏的不同控件，您可能必须抽象出输入，并让您的游戏/关卡对象有一个像 userHasPoked(int x, int y) 这样的回调，然后让小程序调用该方法单击鼠标，Android 应用程序在触摸时调用它（奇怪的是仍然称为 onClick）。

我认为这将是一条漫长的道路，但比重写整个事情要容易得多。前面可能看起来还有很多工作要做，但是一旦你完成了将代码嵌入到小程序和 Android 应用程序中，你可能“永远”不必再次接触该代码并且可以继续添加到游戏中.

我不会低估这项任务，但这听起来像是一个非常有趣的编程练习。祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T22:19:59.103

你开发什么样的游戏？这可能是开发 Javascript 游戏的更好方法。

可以使用[phonegap](http://phonegap.com) (cordova) 将其安装到 android 设备上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T09:35:50.890

让我为你打破这个......

`Model`- 业务逻辑和数据

`View`- 模型输出的显示

`Controller`- 执行操作的位置。

使用这种`MVC`架构的优点是，您可以保持**相同的模型**并**不断更改 Views**。

所以记住这个想法，你可以为 Web App 和 Android App 拥有相同的模型，然后分别实现彼此的 Views 到它。

# python - python中的PCA并将前2个组件相互绘制

> ID：12117241
> 
> 赞同：0
> 
> 时间：2012-08-24T22:05:42.203
> 
> 标签：python, pca

我试图在矩阵 (C) 上执行 PCA，其中每一列代表不同的时间点，每一行代表一个特征，我试图找到顶部的主成分并将它们相互绘制。我正在使用 mdp 模块，如果该模块返回矩阵，其中每一行代表一个主成分，其中最重要的成分按降序排列，我会感到困惑。

```
import mdp
C=mdp.pca(C)
print C

import matplotlib.pyplot as plt

plt.plot(C[2,:C.shape[1]], C[1,:C.shape[1]], 'r*')
plt.show() 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:12:55.903

来自[mdp.pca 上](http://mdp-toolkit.sourceforge.net/api/mdp-module.html#pca)的 mdp 文档：

> pca(x, **kwargs) 通过其主成分过滤多维输入数据。
> 
> **相同变量的观察值存储在行上，不同的变量存储在列上。**
> 
> 这是对应节点nodes.PCANode的快捷函数。如果指定了任何关键字参数，则将它们传递给其构造函数。
> 
> 这相当于 mdp.nodes.PCANode(**kwargs)(x)

为了打破这一点，这意味着您将关键字参数发送到`PCANode`以设置构造函数，然后使用它的`__call__`方法，根据`PCANode`文档，该方法实际上调用了它的[`execute`方法](http://mdp-toolkit.sourceforge.net/api/mdp.nodes.PCANode-class.html#execute)，它执行以下操作：

> 执行（自我，x，n=无）
> 
> 将输入投影到前“n”个主成分上。如果未设置“n”，则使用所有可用组件。

所以你得到一个投影矩阵，如上所述（行上相同变量的观察，列上不同变量的观察）

# c++ - cocos2d-x中如何设置图层的背景颜色？

> ID：12117250
> 
> 赞同：15
> 
> 时间：2012-08-24T22:06:33.043
> 
> 标签：c++, cocos2d-iphone, cocos2d-x, cclayer

我一直在使用 cocos2d-x 编写游戏，但遇到了更改背景颜色的问题。我在 cocos2d 中找到了一个[示例](http://www.raywenderlich.com/352/how-to-make-a-simple-iphone-game-with-cocos2d-tutorial)，但显然这只适用于用 Obj-c 编写的 cocos2d。基本上这个想法是使用 CCLayerColor 而不是 CCLayer，并且在构造函数被触发时设置颜色。

有谁知道如何更改 cocos2d-x 中的背景颜色？似乎这很简单，我很确定我错过了一些明显的东西。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-25T12:58:12.637

**2.X或以下**

扩展[`CCLayerColor`](http://www.cocos2d-x.org/reference/native-cpp/V2.2/da/d2c/classcocos2d_1_1_c_c_layer_color.html)而不是[`CCLayer`](http://www.cocos2d-x.org/reference/native-cpp/V2.2/da/d2c/classcocos2d_1_1_c_c_layer_color.html#ad6797e9d96ccfc5736e93e94e09fc74a). 例如，

```
class CommonScene : public cocos2d::CCLayerColor
{
public:
...
} 
```

使用以下代码进行初始化：

```
bool CommonScene::init()
{
    //////////////////////////////
    // 1\. super init first
    if( !CCLayerColor::initWithColor(ccc4(255, 255, 255, 255)) ) //RGBA
    {
        return false;
    }
    ...
} 
```

如果要更改背景，请[`setColor`](http://www.cocos2d-x.org/reference/native-cpp/V2.2/da/d2c/classcocos2d_1_1_c_c_layer_color.html#ad6797e9d96ccfc5736e93e94e09fc74a)使用`CCLayerColor`. 例如，

```
this->setColor(ccc3(255, 255, 255)); 
```

**3.0或以上**

像这样修改上面的代码：

头文件 (.h)

```
class CommonScene : public cocos2d::LayerColor 
```

源文件 (.cpp)

```
if( !LayerColor::initWithColor(Color4B(255,255,255,255)) ) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-09-11T09:47:49.553

在 cocos2d-x v.3.x 中，您可以在 init 方法中添加一个 LayerColor，如下所示：

```
auto bg = cocos2d::LayerColor::create(Color4B(53, 53, 53, 255));
this->addChild(bg); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-05-31T05:38:19.960

我可以找到不影响性能的最简单方法是简单地执行以下操作：

```
glClearColor(1.0,1.0,1.0,1.0); 
```

在您的场景 init() 函数中的某个位置。这样您就不必更改为 LayerColor 并且性能也不受影响。干杯!

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-07-11T05:37:41.903

**Cocos2d-x v3.0**

在 *.h

```
class PlayScene : public cocos2d::LayerColor 
```

在 *.cpp 中

```
bool PlayScene::init()
{
    if ( !LayerColor::initWithColor(Color4B(255, 255, 255, 255) )) {
        return false;
    }

    return true;
} 
```

# java - Spring RestTemplate：获取可为空的参数

> ID：12117252
> 
> 赞同：0
> 
> 时间：2012-08-24T22:07:02.323
> 
> 标签：java, spring, rest, spring-mvc, resttemplate

我正在尝试提供真正的 RestFull 服务并遵守文档。但是，我现在遇到了一个我看不到明确答案的问题。我想使用过滤器从 web 服务中查询一些数据。webservice的控制器上定义了如下路径

```
@RequestMapping(value="/rest/postalcode/list/filter?lang={lang}&postalcode={postalcode}&country={country}&city={city}", method = RequestMethod.GET, produces="application/json")
public @ResponseBody JsonPostalCodeList findFilteredPostalCodes(@PathVariable("lang") String lang, @PathVariable("postalcode") String postalcode, @PathVariable("country") Long country, @PathVariable("city") String city, Model model) throws Exception {
} 
```

然后我尝试在客户端使用以下方法调用它

```
public JsonPostalCodeList findPostalCodes(
        JsonPostalCodeSelectorData selectorData) {
    String url = getWebserviceLocation()+"/rest/postalcode/list/filter?lang={lang}&postalcode={postalcode}&country={country}&city={city}";
    MbaLog.debugLog(logger,"Calling webservice with url: " + url);
    return getRestTemplate().getForObject(url, JsonPostalCodeList.class, selectorData.getContactLanguage(), selectorData.getPostalCode(), selectorData.getCountry(), selectorData.getCity());       
} 
```

现在 selectorData.getPostalCode() 可以为空，例如，因为用户没有填写要过滤的邮政编码。国家和城市也是如此（总是填写 lang）。但是每次我运行它时，我都会得到一个 IOException not found （可能是由于 null 的原因）。我试过一次，把所有的东西都填满了，我在服务端的方法很完美。那么你如何处理这样的问题呢？

我可以通过将 GET 扔出窗口来解决它，只需将所有内容作为与 Jackson 映射的 JSONobject 放在 POST 正文中即可解决问题。但是后来我使用 POST 来获取数据，而 GET 应该在纯 REST 中使用来获取数据。

那么 RestTemplate 和带有可变数据的查询服务怎么办呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T19:54:10.293

刚洗了个冷水澡，我自己发现了：）

我不必使用路径变量，我可以使用请求参数。

```
@RequestMapping(value="/rest/postalcode/list/filter", method = RequestMethod.GET, produces="application/json")
public @ResponseBody JsonPostalCodeList findFilteredPostalCodes(@RequestParam("lang") String lang, @RequestParam("postalcode") String postalcode, @RequestParam("country") Long country, @RequestParam("city") String city, Model model) throws Exception {
} 
```

并用

```
@Override
public JsonPostalCodeList findPostalCodes(
        JsonPostalCodeSelectorData selectorData) {
    String url = getWebserviceLocation()+"/rest/postalcode/list/filter?lang={lang}&postalcode={postalcode}&country={country}&city={city}";
    MbaLog.debugLog(logger,"Calling webservice with url: " + url);
    return getRestTemplate().getForObject(url, JsonPostalCodeList.class, selectorData.getContactLanguage(), selectorData.getPostalCode(), selectorData.getCountry(), selectorData.getCity());       
} 
```

# php - 在命名空间中组织 PHPUnit 测试

> ID：12117254
> 
> 赞同：40
> 
> 时间：2012-08-24T22:07:17.653
> 
> 标签：php, unit-testing, phpunit

我看到了将 PHPUnit 单元测试组织到命名空间层次结构中的两个选项。这两种方法的优点/缺点是什么？是否有任何我没有考虑过的明显缺陷会使一个明显更好的选择？

考虑一个示例类，例如`\SomeFramework\Utilities\AwesomeClass`：

*   **方法 1：**将每个 TestCase 类放入与被覆盖类相同的命名空间中。

    ```
    \SomeFramework\Utilities\AwesomeClassTest 
    ```

    *   **优点**
        *   与编写 PHPUnit 测试的传统方法一致。
    *   **缺点**
        *   灵活性较低。
        *   似乎打破了使用命名空间背后的原则——不相关的测试被分组到同一个命名空间中。

*   **方法 2：**将每个 TestCase 放在以覆盖类命名的命名空间中。

    ```
    \SomeFramework\Utilities\AwesomeClass\Test 
    ```

    *   **优点**
        *   提供一种非常简单/明显的方式来将多个相关的 TestCase 类组合在一起，例如针对不同的测试套件。
    *   **缺点**
        *   可能会导致更深、更复杂的层次结构。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-27T12:02:11.687

我提出的解决方案及其背后的原因：

### 文件夹布局：

```
.
├── src
│   ├── bar
│   │   └── BarAwesomeClass.php
│   └── foo
│       └── FooAwesomeClass.php
└── tests
    ├── helpers
    │   └── ProjectBaseTestClassWithHelperMethods.php
    ├── integration
    │   ├── BarModuleTest.php
    │   └── FooModuleTest.php
    └── unit
        ├── bar
        │   └── BarAwesomeClassTest.php
        └── foo
            └── FooAwesomeClassTest.php 
```

该`helpers/`文件夹包含不是测试但仅在测试上下文中使用的类。通常该文件夹包含一个 BaseTestClass 可能包含项目特定的辅助方法和几个易于重用的存根类，因此您不需要那么多模拟。

该`integration/`文件夹包含跨越更多类和测试系统“更大”部分的测试。您没有那么多，但没有 1:1 映射到生产类。

该`unit/`文件夹将 1:1 映射到`src/`. 因此，对于每个生产类，都有一个类包含该类的所有**单元**测试。

## 命名空间

> 方法 1：将每个 TestCase 类放入与被覆盖类相同的命名空间中。

这种文件夹方法应该可以解决您使用**方法 1**的一个缺点。您仍然可以灵活地进行比纯 1:1 映射所能提供的更多测试，但一切都已安排妥当。

> 似乎打破了使用命名空间背后的原则——不相关的测试被分组到同一个命名空间中。

如果测试感觉“不相关”，可能生产代码有同样的问题？

确实，这些测试并不相互依赖，但它们可能会使用它们的“关闭”类作为模拟，或者在 DTO 或值对象的情况下使用真实的类。所以我会说有联系。

> 方法 2：将每个 TestCase 放在以覆盖类命名的命名空间中。

有几个项目可以做到这一点，但通常它们的结构略有不同：

不是`\SomeFramework\Utilities\AwesomeClass\Test`，但`\SomeFramework\Tests\Utilities\AwesomeClassTest`他们仍然保持 1:1 映射，但添加了额外的测试命名空间。

## 额外的测试命名空间

我个人的看法是，我不喜欢有单独的测试命名空间，我会尝试找到一些支持和反对该选择的论据：

### 测试应该作为如何使用类的文档

当真正的类在另一个命名空间中时，测试显示如何在它自己的模块之外使用该类。

当真正的类在同一个命名空间中时，测试显示了如何从该模块内部使用该类。

差异很小（通常是几个“使用”语句或完全限定的路径）

当我们有可能`$this->getMock(AwesomeClass::CLASS)`在 PHP 5.5 中说而不是`$this->getMock('\SomeFramework\Utilities\AwesomeClass')`每个 mock 都需要一个 use 语句。

对我来说，模块内的使用对大多数类来说更有价值

### 污染“生产”命名空间

当您说`new \SomeFramework\Utilities\A`自动完成可能会向您展示时`AwesomeClass`，`AwesomeClassTest`有些人不希望这样。对于外部使用，或者在运送您的源代码时，这当然不是问题，因为测试没有运送，但可能需要考虑。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-01-07T09:55:37.437

我使用了第三个选项，它非常适合作曲家自动加载：`Test`在层次结构的第一步之后插入命名空间。在你的情况下，命名空间是`\SomeFramework\Tests\Utilities\`，你的类是`\SomeFramework\Tests\Utilities\AwesomeClassTest`.

然后，您可以将测试与目录中的其他类放在一起`\SomeFramework\Test`，或者将它们放在单独的目录中。您的自动加载信息`composer.json`可能如下所示：

```
{
    "autoload": {
        "psr-0": { 
            "SomeFramework\\": "src/",
        }
    },
    "autoload-dev": {
        "psr-0": { 
            "SomeFramework\\Tests\\": "tests/"
        }
    }
} 
```

第三种方法的优点是：

*   测试和生产代码分离
*   测试和生产类的类似文件夹层次结构
*   轻松自动加载

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-25T19:13:20.990

我更喜欢第一种方法来保持一致性——使用 PHPUnit 实践和我们的其他项目。此外，我只为每个被测类创建一个测试用例。将每个都放在自己的命名空间中似乎有点过分了。正如 KingCrunch 所说，测试是相关的，因为它们测试的类是相关的。

每隔一段时间，测试用例就需要支持文件，例如固定装置，但这些文件很容易组织到为该类命名的子目录/命名空间中，并且通常在多个测试用例之间共享。

第二种方法的一大缺点是每个测试用例的名称`Test`都会有几个后果：

*   多个打开的测试窗口都将具有相同的名称。
*   您的 IDE 的“按名称打开类型”功能（NetBeans 中的 CTRL-O）对测试毫无用处。
*   您的 IDE 的“去测试”快捷键（NetBeans 中的 CTRL-SHIFT-T）也可能会失败。

# mysql - mysql 中派生表上的自连接 - 我需要重复子查询吗？

> ID：12117255
> 
> 赞同：6
> 
> 时间：2012-08-24T22:07:23.310
> 
> 标签：mysql, sql

我必须在 mysql 的派生表上执行一个自连接的 sql 语句。派生表涉及一个毛茸茸的子查询，我想知道是否有任何替代方法可以实际编写和执行它两次-

```
SELECT a.* FROM (my hairy subquery) AS a
  LEFT JOIN (my hairy subquery) AS a2 
    ON a.groupname = a2.groupname etc.. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T22:09:26.470

对此的标准解决方案是使用 CTE，但 MySQL 尚不支持这些。替代方案是：

*   您可以将子查询放在视图中并自行加入视图。
*   您可以创建一个临时表并使用子查询的结果填充它。

**有关的**

*   [如何在 MySQL 中使用“WITH”子句？](https://stackoverflow.com/questions/1382573/how-do-you-use-the-with-clause-in-mysql)

# fluent-nhibernate - Fluent NHibernate 是否提供 iSeries 数据提供程序？

> ID：12117256
> 
> 赞同：2
> 
> 时间：2012-08-24T22:07:23.977
> 
> 标签：fluent-nhibernate, db2-400

我正在尝试使用 Fluent NHibernate 连接到我们的 AS/400 iSeries DB2 服务器。我有以下代码：

```
private static ISessionFactory CreateSessionFactory()
{
    return Fluently.Configure()
        .Database(DB2Configuration.Standard.ConnectionString("DataSource=MyServer;UserID=MyUser;Password=password;"))
        .Mappings(m => m.FluentMappings.AddFromAssembly(Assembly.GetExecutingAssembly()))
        .BuildSessionFactory();
} 
```

我正在运行 nhprof，但出现错误：无法加载文件或程序集“IBM.Data.DB2”或其依赖项之一。系统找不到指定的文件。无法加载类型 IBM.Data.DB2.DB2Command、IBM.Data.DB2。

我知道 IBM.Data.DB2.dll 是 iSeries 的不正确的 .dll。它应该加载 IBM.Data.DB2.iSeries.dll，它位于我的 bin 文件夹中。

NHibernate 有一种加载 iSeries dll 的方法。我如何告诉 Fluent 加载它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T03:26:32.917

我想通了，以防万一其他人为此苦苦挣扎。

我取出了 nhibernate.cfg.xml 文件并在代码中完成了它。此代码似乎有效：

```
private static ISessionFactory CreateSessionFactory()
{
    ISessionFactory factory = null;

    var cfg = new Configuration();
    cfg.DataBaseIntegration(x =>
    {
        x.ConnectionString = "DataSource=MyServer;UserID=MyUser;Password=password; DataCompression=True;";
        x.Dialect<DB2400Dialect>();
        x.Driver<DB2400Driver>();
    });

    factory = Fluently.Configure(cfg)
        .Mappings(m => m.FluentMappings.AddFromAssembly(Assembly.GetExecutingAssembly()))
        .BuildSessionFactory();

    return factory;
} 
```

# google-chrome - 如何在 Chrome 的不同物理屏幕中打开弹出窗口？

> ID：12117265
> 
> 赞同：1
> 
> 时间：2012-08-24T22:08:14.863
> 
> 标签：google-chrome, popup, screen, window.open

有没有办法打开一个弹出窗口（使用`window.open`）并将其放置在不同的物理屏幕上？

这在 Firefox 中是可能的：

```
window.open(location, '', 'width=200,height=200,left=-1052') 
```

但是 Chrome 会阻止您将子弹出窗口移动到母版页屏幕之外。

我认为他们这样做是为了防止恶意网站创建隐藏的弹出窗口，但在我确实有两个屏幕并希望该弹出窗口始终在我的第二个屏幕上打开的情况下，这对我来说没有意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T18:02:35.737

这是 Chrome 中的一个已知问题，请为该问题加注星标以便查看

[http://code.google.com/p/chromium/issues/detail?id=137681](http://code.google.com/p/chromium/issues/detail?id=137681)

# php - php文件可写但不能删除

> ID：12117266
> 
> 赞同：2
> 
> 时间：2012-08-24T22:08:32.820
> 
> 标签：php, unlink

我正在使用这个功能。is_file 和 is_writable 返回 true，但是当我取消链接时，它给出了错误。这是在 Windows 服务器上。

```
if(is_file($fileToDelete)) {
  if(is_writable($fileToDelete)) {
    unlink($fileToDelete);
  }
} 
```

该文件是我打开的 PDF 文档。我认为 is_writable 在这种情况下会返回 false，但事实并非如此。

那么如何判断一个文件是否可以删除呢？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T22:17:43.747

反过来做呢？只是尝试删除文件并检查它是否真的消失了？

```
@unlink($fileToDelete);

if(is_file($fileToDelete)) {
   // file was locked (or permissions error)
} 
```

虽然不确定这在您的特定情况下是否可行，但从您问题中的代码来看，这应该是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:13:30.667

你在使用文件吗？我的意思是，你是通过 fopen($file) 打开它吗？

在尝试删除文件之前执行 fclose($file)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-26T07:01:45.547

对于那些不想在检查前删除文件的人来说，解决方案在这里：

```
$file = "test.pdf";

if (!is_file($file)) {
    print "File doesn't exist.";
} else {
    $fh = @fopen($file, "r+");
    if ($fh) {
        print "File is not opened and seems able to be deleted.";
        fclose($fh);
    } else {
        print "File seems to be opened somewhere and can't be deleted.";
    }
} 
```

简单，高效。

# java - 遍历列表并允许它同时删除一个项目（NOT ITERATOR）

> ID：12117273
> 
> 赞同：2
> 
> 时间：2012-08-24T22:09:10.277
> 
> 标签：java, algorithm, list, data-structures, collections

**注意：**我不知道 doSomething 是否会删除该元素。这是我的数据结构需要处理的例外情况。

我的问题很简单：

```
int size = list.size();
for(int i = 0; i < size; i++) {
   MyObj mo = list.get(i);
   mo.doSomething();
} 
```

现在如果 doSomething() 从列表中删除 mo，我最终会得到一个 ArrayIndexOutOfBounds 因为列表现在已经缩小了。

我应该使用什么数据结构来允许迭代并有可能删除？我不能在这里使用迭代器，换句话说，我不能让 doSomething 返回一个布尔值并调用 iterator.remove()。数据结构必须以某种方式处理这种情况并继续迭代仍然存在的其余元素。

**编辑：**我不知道 doSomething 是否会删除该元素。这是我的数据结构需要处理的例外情况。

**第二部分**=>[制作一个智能监听器通知器以避免到处重复代码](https://stackoverflow.com/questions/12117636/making-a-smart-listeners-notifier-to-avoid-code-duplication-everywhere)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:11:05.283

`ArrayList`例如，只要在删除某些内容时更新索引和大小，就可以使用。

```
List<MyObj> list = new ArrayList<MyObj>();
int size = list.size();
for(int i = 0; i < size; i++) {
    MyObj mo = list.get(i);
    mo.doSomething();
    if (size > list.size()) {
        size = list.size();
        i--;
    }
} 
```

这仅在删除的项目是最后检查的项目时才有效。对于列表的其他更改，您将不得不有更复杂的逻辑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T22:17:47.967

> 我应该使用什么数据结构来允许迭代并有可能删除？

*最简单的*选择是获取列表的副本并对其进行迭代：

```
List<MyObj> copy = new ArrayList<MyObj>(list);
for (MyObj mo : copy) {
    mo.doSomething();
} 
```

现在，是否有任何东西从原始列表中删除了一个想法并不重要——这不会改变列表的副本。

另一种选择是使用[`CopyOnWriteArrayList`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/CopyOnWriteArrayList.html). 然后，您可以随意迭代并删除或添加项目：

> “快照”样式的迭代器方法使用对创建迭代器时数组状态的引用。这个数组在迭代器的生命周期内永远不会改变，所以干扰是不可能的，并且迭代器保证不会抛出 ConcurrentModificationException。自创建迭代器以来，迭代器不会反映对列表的添加、删除或更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T22:25:56.967

我认为你应该改变你`doSomething()`。如果可以从中`mo.doSomething()`删除，你必须知道你的。`mo``l``mo``l`

您可以像这样更改代码：

在您的 MyObj 中创建一个有效标志。仅在有效时才收听。

```
while(list.hasNext()) {
   MyObj mo = list.next()
   if(mo.isValid()){
       mo.doSomething();
   } else {
       list.remove();
   }
} 
```

# ruby-on-rails - Rails 3 + jQuery Mobile Themeroller = 无效的 CSS

> ID：12117274
> 
> 赞同：0
> 
> 时间：2012-08-24T22:09:11.250
> 
> 标签：ruby-on-rails, jquery-mobile, themeroller

使用通过 Themeroller 创建的自定义 jQuery Mobile 主题可以很好地与 Rails 一起用于本地开发。但是，运行：

```
rake 资产：预编译
```

在生产服务器上导致此错误：

```
“...渐变（线性”：预期的“）”之后的无效 CSS，是“，左上，左...”
```

custom-theme.min.css 中的那行代码是：

```
背景图像：-webkit-gradient（线性，左上，左下，从（#333333），到（#333333））；
```

自定义主题包含在 application.css 中：

```
 *= require_self
 *= require_tree .
 *= require jquery.mobile.structure-1.1.1.min
 *= require custom-theme.min
 *= require jquery-mobile-fluid960.min 
```

我相信生成的 Themeroller 语法是有效的......它与 css/sass/scss 组合有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T16:44:30.213

原来 jQuery Mobile Themeroller 可能有点问题。如果未设置渐变和边框（即省略十六进制颜色代码），它仍会生成 # 标签但不生成颜色代码，或者将“NaN”附加到渐变颜色的末尾。`border:1px solid # ;`在 Themeroller 中设置所有颜色，然后在生成的 *.min.css 文件上进行简单的搜索和替换，即可清除此问题。

# elasticsearch - 如何在 Elasticsearch 中匹配前缀

> ID：12117275
> 
> 赞同：18
> 
> 时间：2012-08-24T22:09:16.970
> 
> 标签：elasticsearch

假设在我的弹性搜索索引中，我有一个名为“dots”的字段，其中包含一串标点符号分隔的单词（例如“first.second.third”）。

我需要搜索例如“first.second”，然后获取其“dots”字段包含正好是“first.second”或以“first.second.”开头的字符串的所有条目。

我无法理解文本查询的工作原理，至少我无法创建一个可以完成这项工作的查询。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-26T01:46:40.203

Elasticsearch 具有专为此类用例创建的[Path Hierarchy Tokenizer 。](http://www.elasticsearch.org/guide/reference/index-modules/analysis/pathhierarchy-tokenizer.html)以下是如何为您的索引设置它的示例：

```
# Create a new index with custom path_hierarchy analyzer 
# See http://www.elasticsearch.org/guide/reference/index-modules/analysis/pathhierarchy-tokenizer.html
curl -XPUT "localhost:9200/prefix-test" -d '{
    "settings": {
        "analysis": {
            "analyzer": {
                "prefix-test-analyzer": {
                    "type": "custom",
                    "tokenizer": "prefix-test-tokenizer"
                }
            },
            "tokenizer": {
                "prefix-test-tokenizer": {
                    "type": "path_hierarchy",
                    "delimiter": "."
                }
            }
        }
    },
    "mappings": {
        "doc": {
            "properties": {
                "dots": {
                    "type": "string",
                    "analyzer": "prefix-test-analyzer",
                    //"index_analyzer": "prefix-test-analyzer", //deprecated
                    "search_analyzer": "keyword"
                }
            }
        }
    }
}'
echo
# Put some test data
curl -XPUT "localhost:9200/prefix-test/doc/1" -d '{"dots": "first.second.third"}'
curl -XPUT "localhost:9200/prefix-test/doc/2" -d '{"dots": "first.second.foo-bar"}'
curl -XPUT "localhost:9200/prefix-test/doc/3" -d '{"dots": "first.baz.something"}'
curl -XPOST "localhost:9200/prefix-test/_refresh"
echo
# Test searches. 
curl -XPOST "localhost:9200/prefix-test/doc/_search?pretty=true" -d '{
    "query": {
        "term": {
            "dots": "first"
        }
    }
}'
echo
curl -XPOST "localhost:9200/prefix-test/doc/_search?pretty=true" -d '{
    "query": {
        "term": {
            "dots": "first.second"
        }
    }
}'
echo
curl -XPOST "localhost:9200/prefix-test/doc/_search?pretty=true" -d '{
    "query": {
        "term": {
            "dots": "first.second.foo-bar"
        }
    }
}'
echo
curl -XPOST "localhost:9200/prefix-test/doc/_search?pretty=true&q=dots:first.second"
echo 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-14T16:20:15.213

[正如 elasticsearch文档](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl-text-query.html#_text_phrase_prefix)中所指出的，还有一种更简单的方法：

只需使用：

```
{
    "text_phrase_prefix" : {
        "fieldname" : "yourprefix"
    }
} 
```

或从 0.19.9 开始：

```
{
    "match_phrase_prefix" : {
        "fieldname" : "yourprefix"
    }
} 
```

代替：

```
{   
    "prefix" : { 
        "fieldname" : "yourprefix" 
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-24T23:04:06.283

看看[前缀查询](http://www.elasticsearch.org/guide/reference/query-dsl/prefix-query.html)。

```
$ curl -XGET 'http://localhost:9200/index/type/_search' -d '{
    "query" : {
        "prefix" : { "dots" : "first.second" }
    }
}' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T22:23:26.403

您应该使用 commodin chars 进行查询，如下所示：

```
$ curl -XGET http://localhost:9200/myapp/index -d '{
    "dots": "first.second*"
}' 
```

有关语法的更多示例：http: [//lucene.apache.org/core/old_versioned_docs/versions/2_9_1/queryparsersyntax.html](http://lucene.apache.org/core/old_versioned_docs/versions/2_9_1/queryparsersyntax.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-15T16:34:48.053

我一直在寻找类似的解决方案 - 但只匹配一个前缀。我发现@imtov 的[答案](https://stackoverflow.com/a/12127065/3508719)让我几乎到了那里，但有一个变化 - 切换分析器：

```
"mappings": {
    "doc": {
        "properties": {
            "dots": {
                "type": "string",
                "analyzer": "keyword",
                "search_analyzer": "prefix-test-analyzer"
            }
        }
    }
} 
```

代替

```
"mappings": {
    "doc": {
        "properties": {
            "dots": {
                "type": "string",
                "index_analyzer": "prefix-test-analyzer",
                "search_analyzer": "keyword"
            }
        }
    }
} 
```

这种方式添加：

```
'{"dots": "first.second"}'
'{"dots": "first.third"}' 
```

将仅添加这些完整令牌，而不存储`first`, `second`,`third`令​​牌。

然而寻找任何一个

```
first.second.anyotherstring
first.second 
```

将仅正确返回第一个条目：

```
'{"dots": "first.second"}' 
```

不完全是您要求的，但不知何故相关，所以我认为可以帮助某人。

# linux - 未找到 FFMPEG 预设？Linux 美分操作系统 6

> ID：12117277
> 
> 赞同：1
> 
> 时间：2012-08-24T22:09:24.460
> 
> 标签：linux, ffmpeg

我运行了这个命令

```
ffmpeg -i v-16418145218d8d7abdaabec46beb22ecffd2f5d1625.flv -y -acodec aac -ac 2 -ab 160k -vcodec libx264 -vpre iPod640 -vpre slow -f mp4 -threads 0 OUTPUT.mp4 
```

得到了这样的回应：

```
[flv @ 0x10ff670]Estimating duration from bitrate, this may be inaccurate

Seems stream 0 codec frame rate differs from container frame rate: 1000.00 (1000/1) -> 25.00 (25/1)
Input #0, flv, from 'v-16418145218d8d7abdaabec46beb22ecffd2f5d1625.flv':
  Metadata:
    duration        : 14
    width           : 320
    height          : 240
    videodatarate   : 500
    framerate       : 25
    videocodecid    : 2
    audiodatarate   : 0
    audiosamplerate : 22050
    audiosamplesize : 16
    stereo          : true
    audiocodecid    : 2
    filesize        : 912970
  Duration: 00:00:13.92, start: 0.000000, bitrate: 576 kb/s
    Stream #0.0: Video: flv, yuv420p, 320x240, 512 kb/s, 25 tbr, 1k tbn, 1k tbc
    Stream #0.1: Audio: mp3, 22050 Hz, 2 channels, s16, 64 kb/s
File for preset 'iPod640' not found 
```

但是在做了一个find之后，这就是我发现的。

```
/usr/share/ffmpeg/libx264-ipod320.ffpreset
/usr/share/ffmpeg/libx264-ipod640.ffpreset **** ITS HERE ******
/usr/share/ffmpeg/libx264-lossless_fast.ffpreset
/usr/share/ffmpeg/libx264-lossless_max.ffpreset
/usr/share/ffmpeg/libx264-lossless_medium.ffpreset
/usr/share/ffmpeg/libx264-lossless_slow.ffpreset
/usr/share/ffmpeg/libx264-lossless_slower.ffpreset
/usr/share/ffmpeg/libx264-lossless_ultrafast.ffpreset
/usr/share/ffmpeg/libx264-main.ffpreset
/usr/share/ffmpeg/libx264-max.ffpreset
/usr/share/ffmpeg/libx264-medium.ffpreset
/usr/share/ffmpeg/libx264-medium_firstpass.ffpreset
/usr/share/ffmpeg/libx264-normal.ffpreset
/usr/share/ffmpeg/libx264-placebo.ffpreset
/usr/share/ffmpeg/libx264-placebo_firstpass.ffpreset
/usr/share/ffmpeg/libx264-slow.ffpreset
/usr/share/ffmpeg/libx264-slow_firstpass.ffpreset
/usr/share/ffmpeg/libx264-slower.ffpreset 
```

我也尝试使用 -vpre libx264-ipod640 ，但仍然没有运气。我得到预设 libx264-ipod640 is not found.... 我必须以某种方式启用预设吗？ffmpeg - 启用预设？或者其他的东西？

** 编辑：我的 ffmpeg 版本信息 **

```
FFmpeg version 0.6.5, Copyright (c) 2000-2010 the FFmpeg developers
  built on Jan 29 2012 17:52:15 with gcc 4.4.5 20110214 (Red Hat 4.4.5-6)
  configuration: --prefix=/usr --libdir=/usr/lib64 --shlibdir=/usr/lib64 --mandir=/usr/share/man --incdir=/usr/include --disable-avisynth --extra-cflags='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -fPIC' --enable-avfilter --enable-avfilter-lavf --enable-libdc1394 --enable-libdirac --enable-libfaac --enable-libfaad --enable-libfaadbin --enable-libgsm --enable-libmp3lame --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-librtmp --enable-libschroedinger --enable-libspeex --enable-libtheora --enable-libx264 --enable-gpl --enable-nonfree --enable-postproc --enable-pthreads --enable-shared --enable-swscale --enable-vdpau --enable-version3 --enable-x11grab
  libavutil     50.15\. 1 / 50.15\. 1
  libavcodec    52.72\. 2 / 52.72\. 2
  libavformat   52.64\. 2 / 52.64\. 2
  libavdevice   52\. 2\. 0 / 52\. 2\. 0
  libavfilter    1.19\. 0 /  1.19\. 0
  libswscale     0.11\. 0 /  0.11\. 0
  libpostproc   51\. 2\. 0 / 51\. 2\. 0
FFmpeg 0.6.5
libavutil     50.15\. 1 / 50.15\. 1
libavcodec    52.72\. 2 / 52.72\. 2
libavformat   52.64\. 2 / 52.64\. 2
libavdevice   52\. 2\. 0 / 52\. 2\. 0
libavfilter    1.19\. 0 /  1.19\. 0
libswscale     0.11\. 0 /  0.11\. 0
libpostproc   51\. 2\. 0 / 51\. 2\. 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:26:37.773

在实验中找到了解决方案。我的预设顺序错误。它必须是 -vcodec 然后 -vpre (速度) -vpre (presetprofile [aka ipod640])

# ruby - “工头开始”导致“在...中找不到捆绑程序（> = 0）”错误

> ID：12117281
> 
> 赞同：0
> 
> 时间：2012-08-24T22:09:50.900
> 
> 标签：ruby, sinatra, rack, rbenv, foreman

我从 heroku 的文档中复制了一个示例 Procfile，并尝试使用工头在本地运行 Sinatra 应用程序。

每当我尝试`foreman start`时，我都会得到这个：

```
~/Repos/website ➜ foreman start
14:04:43 web.1  | started with pid 2916
14:04:44 web.1  | /usr/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find bundler (>= 0) amongst [bigdecimal-1.1.0, daemons-1.1.9, eventmachine-0.12.10, io-console-0.3, json-1.5.4, minitest-2.5.1, rack-1.4.1, rack-protection-1.2.0, rake-0.9.2.2, rdoc-3.9.4, rubygems-update-1.8.24, sinatra-1.3.3, thin-1.4.1, tilt-1.3.3, yard-0.8.2.1] (Gem::LoadError)
14:04:44 web.1  |   from /usr/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:256:in `to_spec'
14:04:44 web.1  |   from /usr/lib/ruby/site_ruby/1.9.1/rubygems.rb:1231:in `gem'
14:04:44 web.1  |   from /home/nicolas/.gem/ruby/1.9.1/bin/bundle:22:in `<main>'
14:04:44 web.1  | exited with code 1
14:04:44 system | sending SIGTERM to all processes
SIGTERM received 
```

这些是我的 Procfile 的内容：

```
web: bundle exec thin start -R config.ru -e $RACK_ENV -p $PORT 
```

我在有和没有 rbenv 的情况下都试过了。我目前通过 Arch 的包管理器 pacman 安装了 Ruby。我也安装了捆绑器。我已经尝试过[此处](https://stackoverflow.com/questions/6166081/could-not-find-bundler-error/)和[此处](https://stackoverflow.com/questions/6466494/could-not-find-rubygem-bundler)列出的答案。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T08:40:14.440

等了一会儿，更新 gems，然后再试一次，当 Procfile 包含以下内容时，我现在让它工作：

`web: bundle exec rackup`

# ruby-on-rails-3 - 在 routes.rb 中为某些路由添加 HTTP 基本身份验证

> ID：12117282
> 
> 赞同：12
> 
> 时间：2012-08-24T22:09:54.910
> 
> 标签：ruby-on-rails-3, authentication

我想将 HTTP 基本身份验证添加到我的`routes.rb`文件中的一些路由。

我从[http://asciicasts.com/episodes/271-resque得到了这个想法](http://asciicasts.com/episodes/271-resque)

`routes.rb`

```
Coderbits::Application.routes.draw do  
  resources :snippets  
  root :to => "snippets#new"  
  authenticate :admin do  
    mount Resque::Server, :at => "/resque"  
  end  
end 
```

`config/initializers/resque_auth.rb`

```
Resque::Server.use(Rack::Auth::Basic) do |user, password|  
  password == "secret"  
end 
```

如果我只想保护我的 rails 应用程序中的路线，我应该在初始化文件中放入什么？

我现在的工作是在我的应用程序控制器中添加一个前置过滤器，如果请求不是针对我已列入白名单的控制器：

```
authenticate_or_request_with_http_basic do |user, password|
  user == ENV["ADMIN_USER"] && password == ENV["ADMIN_PASS"]
end 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-07-31T17:19:15.243

我只是把

```
 http_basic_authenticate_with :name => "admin", :password => "secret" 
```

在我的控制器里面

# .net - ActiveDirectoryMembershipProvider 随机错误

> ID：12117285
> 
> 赞同：2
> 
> 时间：2012-08-24T22:10:01.103
> 
> 标签：.net, active-directory, connection

我有一个 Web 应用程序，它使用 ActiveDirectoryMembershipProvider 类针对安全的 LDAP 系统创建/更新/验证用户。除了我们得到随机的“服务器不可用”之外，一切似乎都运行良好。例外。当用户收到此错误时，他们可以立即重试并且它可以工作。

我让我们的网络人员监控流量，我们注意到 Membership 对象创建了 2 个到 LDAP 的安全 TCP 连接（我们将它们称为 con1 和 con2）。两个连接似乎都保持打开状态，但只有 con2 接收到任何通信。最终 con1 会从 ldap 服务器发送一个关闭请求。此请求似乎是随机发生的。当我们看到错误时，我们通常会在错误发生之前（毫秒之前）立即看到 con1 关闭请求。

我已经阅读了 MSDN 文档，但无法弄清楚为什么它会打开 2 个连接以及为什么它不关闭它们或发送通知消息它仍在运行。有谁知道这些答案？

我的第二个问题是我能做些什么来解决这个问题？我知道我可以重新请求验证，但我不希望我必须这样做。下面是示例代码。

配置

```
<add name="ADConnectionString" connectionString="LDAP://FullyQualifiedServerName:636/OU=XXX,DC=XXX,DC=XXX" />
<add name="ADMembershipProvider"    
type="System.Web.Security.ActiveDirectoryMembershipProvider, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" 
 connectionStringName="ADConnectionString" 
 connectionUsername="CN=XXX,OU=XXX,DC=XXX,DC=XXX" connectionPassword="XXXXXX" 
 connectionProtection="Secure" enableSearchMethods="true" enablePasswordReset="true" 
 requiresQuestionAndAnswer="true" applicationName="XXXX" 
 description="Default AD connection" requiresUniqueEmail="false" 
 clientSearchTimeout="30" serverSearchTimeout="30" attributeMapPasswordQuestion="xxx" 
 attributeMapPasswordAnswer="xxxx" attributeMapFailedPasswordAnswerCount="xxxx" 
 attributeMapFailedPasswordAnswerTime="xxxx" 
 attributeMapFailedPasswordAnswerLockoutTime="xxxx" attributeMapEmail="mail" 
 attributeMapUsername="userPrincipalName" maxInvalidPasswordAttempts="7" 
 passwordAttemptWindow="1" passwordAnswerAttemptLockoutDuration="5" 
 minRequiredPasswordLength="8" minRequiredNonalphanumericCharacters="0" 
 passwordStrengthRegularExpression="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?!.*\s).{8,20}$" /> 
```

代码

```
return Membership.Providers["ADMembershipProvider"].ValidateUser(userName, userPassword); 
```

环境：Windows Server 2008、IIS 7.0、.NET 4.0 ***注意***我们目前的服务量非常低，因为我们处于一个小的 beta 窗口中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-18T15:33:52.990

这似乎是 ActiveDirectoryMembershipProvider 类中的一个错误。我们最终切换到 Common.LdapAuth.LdapAuthProvider 类来验证用户。

# performance - 当我每帧写入单个顶点缓冲区数千次时，如何提高 Direct3D 的性能？

> ID：12117287
> 
> 赞同：5
> 
> 时间：2012-08-24T22:10:20.177
> 
> 标签：performance, graphics, direct3d, direct3d11

我正在尝试编写一个 OpenGL 包装器，它允许我使用所有现有的图形代码（为 OpenGL 编写的）并将 OpenGL 调用路由到 Direct3D 等效项。到目前为止，这种方法的效果出奇的好，只是性能变成了一个相当大的问题。

现在，我承认我很可能以从未设计过的方式使用 D3D。我在每个渲染循环中更新了数千次单个顶点缓冲区。每次我绘制一个“精灵”时，我都会使用纹理坐标等向 GPU 发送 4 个顶点，当屏幕上的“精灵”数量一次达到 1k 到 1.5k 左右时，我的应用程序的 FPS 下降到低于 10 帧/秒。

使用 VS2012 性能分析（这很棒，顺便说一句），我可以看到 ID3D11DeviceContext->Draw 方法占用了大部分时间： [Screenshot Here](http://i.imgur.com/hoFiQ.png)

在设置顶点缓冲区或绘制方法期间，是否有一些设置我没有正确使用？为我的所有精灵使用相同的顶点缓冲区真的非常糟糕吗？如果是这样，我还有哪些其他选项不会彻底改变我现有图形代码库的架构（围绕 OpenGL 范例构建......每帧都将所有内容发送到 GPU！）

我游戏中最大的 FPS 杀手是当我在屏幕上显示大量文本时。每个字符都是一个带纹理的四边形，每个字符都需要单独更新顶点缓冲区并单独调用 Draw。如果 D3D 或硬件不喜欢多次调用 Draw，那么你怎么能一次在屏幕上绘制大量文本呢？

如果您想查看更多代码来帮助我诊断此问题，请告诉我。

谢谢！

这是我正在运行的硬件：

*   酷睿 i7 @ 3.5GHz
*   16 GB RAM
*   GeForce GTX 560 钛

这是我正在运行的软件：

*   Windows 8 发布预览
*   对比 2012
*   直连 11

这是绘制方法：

```
void OpenGL::Draw(const std::vector<OpenGLVertex>& vertices)
{
   auto matrix = *_matrices.top();
   _constantBufferData.view = DirectX::XMMatrixTranspose(matrix);
   _context->UpdateSubresource(_constantBuffer, 0, NULL, &_constantBufferData, 0, 0);

   _context->IASetInputLayout(_inputLayout);
   _context->VSSetShader(_vertexShader, nullptr, 0);
   _context->VSSetConstantBuffers(0, 1, &_constantBuffer);

   D3D11_PRIMITIVE_TOPOLOGY topology = D3D11_PRIMITIVE_TOPOLOGY_TRIANGLESTRIP;
   ID3D11ShaderResourceView* texture = _textures[_currentTextureId];

   // Set shader texture resource in the pixel shader.
   _context->PSSetShader(_pixelShaderTexture, nullptr, 0);
   _context->PSSetShaderResources(0, 1, &texture);

   D3D11_MAPPED_SUBRESOURCE mappedResource;
   D3D11_MAP mapType = D3D11_MAP::D3D11_MAP_WRITE_DISCARD;
   auto hr = _context->Map(_vertexBuffer, 0, mapType, 0, &mappedResource);
   if (SUCCEEDED(hr))
   {
      OpenGLVertex *pData = reinterpret_cast<OpenGLVertex *>(mappedResource.pData);
      memcpy(&(pData[_currentVertex]), &vertices[0], sizeof(OpenGLVertex) * vertices.size());
      _context->Unmap(_vertexBuffer, 0);
   }

   UINT stride = sizeof(OpenGLVertex);
   UINT offset = 0;
   _context->IASetVertexBuffers(0, 1, &_vertexBuffer, &stride, &offset);
   _context->IASetPrimitiveTopology(topology);
   _context->Draw(vertices.size(), _currentVertex);
   _currentVertex += (int)vertices.size();
} 
```

这是创建顶点缓冲区的方法：

```
void OpenGL::CreateVertexBuffer()
{
   D3D11_BUFFER_DESC bd;
   ZeroMemory(&bd, sizeof(bd));
   bd.Usage = D3D11_USAGE_DYNAMIC;
   bd.ByteWidth = _maxVertices * sizeof(OpenGLVertex);
   bd.BindFlags = D3D11_BIND_VERTEX_BUFFER;
   bd.CPUAccessFlags = D3D11_CPU_ACCESS_FLAG::D3D11_CPU_ACCESS_WRITE;
   bd.MiscFlags = 0;
   bd.StructureByteStride = 0;
   D3D11_SUBRESOURCE_DATA initData;
   ZeroMemory(&initData, sizeof(initData));
   _device->CreateBuffer(&bd, NULL, &_vertexBuffer);
} 
```

这是我的顶点着色器代码：

```
cbuffer ModelViewProjectionConstantBuffer : register(b0)
{
    matrix model;
    matrix view;
    matrix projection;
};

struct VertexShaderInput
{
    float3 pos : POSITION;
    float4 color : COLOR0;
    float2 tex : TEXCOORD0;
};

struct VertexShaderOutput
{
    float4 pos : SV_POSITION;
    float4 color : COLOR0;
    float2 tex : TEXCOORD0;
};

VertexShaderOutput main(VertexShaderInput input)
{
    VertexShaderOutput output;
    float4 pos = float4(input.pos, 1.0f);

    // Transform the vertex position into projected space.
    pos = mul(pos, model);
    pos = mul(pos, view);
    pos = mul(pos, projection);
    output.pos = pos;

    // Pass through the color without modification.
    output.color = input.color;
    output.tex = input.tex;

    return output;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T14:58:35.957

您需要做的是尽可能积极地批处理顶点，然后绘制大块。我很幸运地将它改装到旧的即时模式 OpenGL 游戏中。不幸的是，这样做有点痛苦。

最简单的概念解决方案是使用某种设备状态（您可能已经在跟踪）为一组特定的顶点创建一个唯一的标记。混合模式和绑定纹理之类的东西是一个很好的集合。如果你能找到一个快速的散列算法在其中的结构上运行，你可以非常有效地存储它。

接下来，您需要进行顶点缓存。有两种方法可以解决这个问题，两者都有优势。最激进，最复杂，并且在许多具有相似属性的顶点集的情况下，最有效的是制作设备状态的结构，分配一个大的（比如 4KB）缓冲区，然后继续存储具有匹配状态的顶点。大批。然后，您可以将整个数组转储到帧末尾的顶点缓冲区中，并绘制缓冲区的块（以重新创建原始顺序）。然而，跟踪所有缓冲区、状态和顺序是很困难的。

更简单的方法可以在良好的情况下提供良好的缓存，将顶点缓存在一个大缓冲区中，直到设备状态发生变化。此时，*在实际更改 state 之前*，将数组转储到顶点缓冲区并绘制。然后重置数组索引，提交状态更改，然后重新开始。

如果您的应用程序有大量相似的顶点，这很可能与精灵一起使用（纹理坐标和颜色可能会改变，但好的精灵将使用单个纹理图集和很少的混合模式），即使是第二种方法也可以提供一些性能提升。

这里的技巧是在系统内存中建立一个缓存，最好是一大块预先分配的内存，然后在绘图之前将其转储到视频内存中。这允许您对视频内存和绘图调用执行更少的写入，这往往是昂贵的（尤其是在一起）。正如您所看到的，您拨打的电话数量变得很慢，而批处理很有可能帮助解决这个问题。诀窍是如果你能帮助它，不要在每帧分配内存，批量处理足够大的块是值得的，并为每次绘制保持正确的设备状态和顺序。

# mysql - 从 mysql 表中选择除最新的 100 个以外的所有结果

> ID：12117292
> 
> 赞同：-1
> 
> 时间：2012-08-24T22:10:45.043
> 
> 标签：mysql, phpmyadmin

> **可能重复：**
> [如何从表中选择除最后 100 条之外的所有记录](https://stackoverflow.com/questions/12116036/how-to-select-all-records-from-table-apart-from-the-last-100)

我希望运行一个 cron 作业来清除一些客户信息。我有一个存储客户信息的表，我只是在测试 SQL 查询以确保它能够正常工作。我有这个问题：

```
$result = mysql_query("SELECT * from order-table WHERE order_id NOT IN (
SELECT order_id
from order-table
ORDER BY order_id desc) LIMIT 50");

while($row = mysql_fetch_array($result)){

echo $row['order_id'];

echo "<br />";
} 
```

问题是我收到一个错误：mysql_fetch_array() 期望参数 1 是资源，给定的布尔值

如果我直接在 SQL 中尝试查询，我会收到一条消息，即子查询不支持 LIMIT，所以我希望有人可以帮助我以另一种方式实现这一目标？感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:15:49.657

检索 50 行，跳过前 100 行：

```
SELECT * FROM order_table ORDER BY order_id DESC LIMIT 100,50 
```

[http://dev.mysql.com/doc/refman/5.5/en/select.html](http://dev.mysql.com/doc/refman/5.5/en/select.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:19:39.453

你不能`LIMIT`在一个`IN`或`NOT IN`子查询中。但是你可以在子查询中的`FROM`or`WHERE`子句中。诀窍是让子查询仅返回 1 行，然后使用`<`或`<=`比较该值。

这将显示除 (ordered by `order_id`) 最后 50 行之外的所有行：

```
SELECT ot.* 
FROM order-table AS ot 
  JOIN 
    ( SELECT order_id
      FROM order-table
      ORDER BY order_id DESC
        LIMIT 1 OFFSET 50
    ) AS lim
    ON ot.order_id <= lim.order_id ; 
```

# java - 如何筛选特定类型的文件/响应的 URL？

> ID：12117293
> 
> 赞同：2
> 
> 时间：2012-08-24T22:10:45.060
> 
> 标签：java, file, url, download, web-scraping

我有一个指向可下载文件的链接的网页。例如：

[http://www.mysite.com/download.php?FILE=downloads/programming/various/ebook.pdf](http://www.mysite.com/download.php?FILE=downloads/programming/various/ebook.pdf)

但它也可以有如下导航链接：

[http://www.mysite.com/index.php](http://www.mysite.com/index.php)

[http://www.mysite.com/index.php?category=programming](http://www.mysite.com/index.php?category=programming)

[http://www.mysite.com/index.php?section=programming&category=various](http://www.mysite.com/index.php?section=programming&category=various)

如何确定 URL 是否指向第一个链接中的文件？或者反过来，过滤掉不适合的 URL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:13:27.563

带着你编辑的问题去：如果你想过滤掉文件，

> 筛选`Content-Type`标题。

[这是常见 mime 类型的非正式列表](https://github.com/akitaonrails/cookbooks/blob/master/nginx/files/default/mime.types)

您可以检查响应标头以确定响应是否符合，例如，`application/pdf` 但您不能仅从 URL / URI 本身做出此决定。

事实上，我可以构建一个 Web 应用程序，它会使用 JPG 的 `http://myapp.com/test.pdf`标题和数据来响应 URL。`Content-Type: image/jpeg`

此外，我真的可以通过发送*PDF*`Content-Type: image/jpeg`的标题和数据来打破常规。

 ** * *

假设它不是故意破坏的（如上所述），那么您可以依赖响应。

**请注意**，如果内容本身偏离`Content-Type`标头，那么您可能会发生漏洞利用。这就是 iPhone 越狱的方式：通过处理格式错误的 PDF 数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:13:56.800

寻找类似文件名的参数？

*任何*URL 都可以在请求时以文件*响应。*

在您请求之前，您无法知道 URL 会响应什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T22:23:56.217

在 HTTP 中，URL 永远不会指向文件。它们识别资源，当您“取消引用”该 URL（即发出 GET 请求）时，您将获得一个表示。

用户代理是否选择将该表示存储为文件是它自己的选择。内容类型指导如何处理表示。

您可以使用`HEAD`请求获取内容类型。应该使用 PDF 文档，`application/pdf`但还有许多其他类型。默认情况下，大多数浏览器倾向于另存`application/octet-stream`为文件。（内容类型协商也有一些微妙之处。）

在 Java 中，您可以使用如下方式发出 HEAD 请求：

```
HttpURLConnection connection = (HttpURLConnection) url.openConnection();
connection.setRequestMethod("HEAD");
// Check connection.getContentType(); 
```*

# python - 仅删除 pyplot 中的一层

> ID：12117301
> 
> 赞同：0
> 
> 时间：2012-08-24T22:11:53.620
> 
> 标签：python, matplotlib, matplotlib-basemap

我正在使用 matplotlibs 底图在多天内使用循环在 pcolor 顶部绘制一些风倒钩。我可以通过使用轻松更改 pcolor，`set_data()`但现在我不确定如何更换倒钩。

有没有办法在不清除整个图形的情况下去除倒钩？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:26:06.170

创建 barbs 对象时，保存它返回的引用，并`remove`在完成后使用它的函数。强制画布在没有倒钩的`draw`情况下重新绘制。假设这`m`是`basemap`对象。

```
 barbs1,barbs2 = m.barbs(...)
 # some code
 barbs1.remove()
 barbs2.remove()
 plt.draw() 
```

# internet-explorer - 让IE玩好，测试一下

> ID：12117305
> 
> 赞同：0
> 
> 时间：2012-08-24T22:12:19.027
> 
> 标签：internet-explorer, debugging, testing, internet-explorer-7, internet-explorer-6

我不想排除 Internet Explorer 用户。我想为他们提供类似于其他浏览器的体验。周围有各种兼容性垫片，我想知道什么是“镇上的新手”，并且做得对。我不想去黑客方面。

以下是我发现的一些：

*   html5shiv：[http ://code.google.com/p/html5shiv/](http://code.google.com/p/html5shiv/)
*   html5.js：[http: //remysharp.com/2009/01/07/html5-enabling-script/](http://remysharp.com/2009/01/07/html5-enabling-script/)
*   IE7：[http ://code.google.com/p/ie7-js/](http://code.google.com/p/ie7-js/)

还有其他我错过了吗？我想包含一个文件，并消除 90% 的 IE 错误。我的问题是：截至 2012 年，哪个 .js 文件可以解决问题？

鉴于此，我如何在 Mac 上正确测试它？

提前致谢。

后续：我发现并测试了：[https](https://saucelabs.com/) ://saucelabs.com/ ；它看起来不错……和我电脑上的 vnc 一样好。

# javascript - 单击页面上的任意位置时关闭 div

> ID：12117309
> 
> 赞同：2
> 
> 时间：2012-08-24T22:12:29.043
> 
> 标签：javascript, jquery, ajax, html

我有一个搜索框，可以选择用户并将他们发送到我页面上的一个 div 中，该页面显然会随脚本一起打开。但是，如果用户在我的网站页面上的任何位置单击 div 之外，我希望该框关闭。我已经尝试了一些想法，但没有得到我想要的东西。

**HTML**

```
<input type="text" id="search_txt" placeholder="Search for friends" class="blog_input_field" onKeyUp="dosearch(document.getElementById('search_txt').value,'ajaxsearch_results');"><hr>
<div class="searchresults" id="ajaxsearch_results"> 
```

**请求功能**

```
function dosearch(text,containerid){
    if (window.XMLHttpRequest) {
        xmlhttp=new XMLHttpRequest();

    } else {
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlhttp.onreadystatechange=function() {
        if (xmlhttp.readyState==4) {
            //alert(xmlhttp.responseText);
            document.getElementById(containerid).innerHTML=xmlhttp.responseText;
        }
    }
    xmlhttp.open("GET","include/search.people.php?t="+text,true);
    xmlhttp.send();

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-24T22:20:47.200

在 jquery 中你可以这样做：

```
$(document).click(function(){
   $('.searchresults').hide();   
});

$('.searchresults').click(function(e){
    e.stopPropagation();
}); 
```

​</p>

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-24T22:18:48.220

这可以用原始 JS 完成，不需要 Jquery。您将 onmousedown 或 on click 挂钩，并利用 JS 事件冒泡的事实，最终（除非被阻止）到文档。所以：

```
document.onmousedown (or onclick) = function (e) {

  if (!e) e = window.event; // for browser compatibility

  target = (e.target ) ? e.target : e.srcElement; // again for browser compat..

  // note - could be child of div, too: see fine print    
  if (e.target.id != "divIDgoesHere")
      document.getElementById('divIDgoesHere').style.display = "none" ;
      // or other hide
} 
```

精美的印刷品：

*   如果您在 div 内部单击，则目标可能是 div 的某个内部子级。在这种情况下，您可以遍历 parentNode 直到到达搜索 div，然后忽略这些请求。

*   您也可以完全删除 div (div.parentNode.removeChild(div))。

*   您需要对代码进行一些调整。没什么大不了的。

希望这可以帮助

TG

# python - 从python调用第三方c函数

> ID：12117310
> 
> 赞同：0
> 
> 时间：2012-08-24T22:12:29.700
> 
> 标签：python, python-c-api, python-c-extension

我需要从 python 内部调用第三方 c 函数。为此，我创建了 ac api，它具有所有 python 特定的 c 代码（使用 METH_VARARGS）来调用第三方函数。我将此代码 liba.so 与 3 方库 libb.so 链接在我的 python 文件中，我正在做：

```
import liba * 
```

Python 现在抱怨 libb.so not found。我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:24:47.247

你必须包含`liba.so`在你的 PATH 中，否则 Python 将不知道在哪里寻找它。

试试下面的代码，如果它可以从PATH中找到它就会加载库，否则它会尝试从加载脚本的目录加载它

```
from ctypes import *
from ctypes.util import find_library
import os

if find_library('a'):
    liba = CDLL(find_library('a'))
else:
    # library is not in your path, try loading it from the current directory
    print 'liba not found in system path, trying to load it from the current directory'
    print '%s/%s'%(os.path.dirname(__file__),'liba.so')
    liba = CDLL(os.path.join(os.path.dirname(__file__),'liba.so')) 
```

[http://docs.python.org/library/ctypes.html#finding-shared-libraries](http://docs.python.org/library/ctypes.html#finding-shared-libraries)

**更新：**我想知道您为什么创建一个本地库 ( `liba`) 来访问本地 3rd 方库 ( `libb`)。您可以使用将第三方 c 库直接导入 python`ctypes`并为`libb`. 例如调用标准的 c lib`time`你会做

```
>>> from ctypes import *
>>> lib_c = CDLL("libc.so.6")
>>> print lib_c.time(None)
1150640792 
```

对于 libb

```
>>> from ctypes import *
>>> lib_b = CDLL("libb")
>>> lib_b.hello_world(None) 
```

# android - 使用 XML 布局作为视图子类的视图？

> ID：12117323
> 
> 赞同：9
> 
> 时间：2012-08-24T22:14:02.367
> 
> 标签：android, android-layout, android-view

我觉得好像我以前知道如何做到这一点，但我目前正在画一个空白。我有一个从 View ( `Card`) 扩展的类，我用 XML 为它编写了一个布局。我想要做的是`Card`在构造函数中将 View 设置为 XML View，这样我就可以使用`Card`set中的方法等等`TextView`。有什么建议么？下面的代码：

Card.java ：（我有`View.inflate(context, R.layout.card_layout, null);`一个我想做的例子，但它不起作用。我基本上希望该类成为视图的接口，为了做到这一点，我需要以某种方式分配 XML 布局到视图。我是否使用类似的东西`setContentView(View view)`？类中没有这样的方法`View`，但是有类似的东西吗？）

```
public class Card extends View {

    TextView tv;

    public Card(Context context) {
        super(context);
        View.inflate(context, R.layout.card_layout, null);
        tv = (TextView) findViewById(R.id.tv);
    }

    public Card(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        View.inflate(context, R.layout.card_layout, null);
        tv = (TextView) findViewById(R.id.tv);
    }

    public Card(Context context, AttributeSet attrs) {
        super(context, attrs);
        View.inflate(context, R.layout.card_layout, null);
        tv = (TextView) findViewById(R.id.tv);
    }

    public void setText(String text) {
        tv.setText(text);
    }

} 
```

card_layout.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="336dp"
    android:layout_height="280dp"
    android:layout_gravity="center"
    android:background="@drawable/card_bg"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/tv"
        android:layout_height="fill_parent"
        android:layout_width="wrap_content"
        android:textSize="24dp"
    />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-25T05:39:45.673

当前设置无法执行您尝试执行的操作。A `View`（或它的直接子类）代表一个**单一**的视图，它没有子视图的概念，你正在尝试做什么。`LayoutInflater`不能与 simple 一起使用，因为`View`simple`View`类没有实际添加子类的方法（如`addView()`方法）。

另一方面，能够生孩子的正确类是`ViewGroup`（或直接子类之一，如`LinearLayout`等） ，通过提供方法`FrameLayout`接受添加`Views`或其他。最后你的课应该是：`ViewGroups``addView`

```
public class Card extends ViewGroup {

    TextView tv;

    public Card(Context context) {
        super(context);
        View.inflate(context, R.layout.card_layout, this);
        tv = (TextView) findViewById(R.id.tv);
    }

    public Card(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        View.inflate(context, R.layout.card_layout, this);
        tv = (TextView) findViewById(R.id.tv);
    }

    public Card(Context context, AttributeSet attrs) {
        super(context, attrs);
        View.inflate(context, R.layout.card_layout, this);
        tv = (TextView) findViewById(R.id.tv);
    }

    public void setText(String text) {
        tv.setText(text);
    }

} 
```

`onLayout`如果我记得如果你扩展你必须覆盖`ViewGroup`，所以相反（并且因为你的布局文件），你应该看看扩展并用标签`LinearLayout`替换`LinearLayout`来自 xml 布局的。`merge`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-24T22:39:47.993

您应该能够在布局中使用您的类名。就像是：

```
<your.package.name.Card 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="336dp"
    android:layout_height="280dp"
    ... 
```

只需致电`findViewById`以获取孩子的意见。

要使用您的 Card 类，您可以使用 inflator 获取实例，然后将其附加到父视图。

```
LayoutInflater inflater = (LayoutInflater) getSystemService(LAYOUT_INFLATER_SERVICE);
Card card = (Card) inflater.inflate(R.layout.card_layout, null);
parentView.addView(card); 
```

[查看文档以获取更多信息。](http://developer.android.com/guide/topics/ui/custom-components.html)

# php - 使用 PHP mail() 发送 multipart/alternative

> ID：12117324
> 
> 赞同：6
> 
> 时间：2012-08-24T22:14:23.973
> 
> 标签：php, html-email, multipart-alternative

所以我正在尝试使用 PHP 发送一个相当简单的 HTML 电子邮件。过去三天我一直在尝试找到一个好的解决方案，并认为我找到了一个，但是当我测试它时，它无法正确发送。我从我引用的一个教程中借用了这段代码。测试代码如下：

```
<?php
//define the receiver of the email
$to = 'myemail@gmail.com';
//define the subject of the email
$subject = 'Test HTML email'; 
//create a boundary string. It must be unique 
//so we use the MD5 algorithm to generate a random hash
$random_hash = md5(date('r', time())); 
//define the headers we want passed. Note that they are separated with \r\n
$headers = "From: webmaster@example.com\r\nReply-To: webmaster@example.com";
//add boundary string and mime type specification
$headers .= "\r\nContent-Type: multipart/alternative; boundary=\"".$random_hash."\""; 
//define the body of the message.
ob_start(); //Turn on output buffering
?>
--<?php echo $random_hash; ?>  
Content-Type: text/plain; charset="iso-8859-1" 
Content-Transfer-Encoding: 7bit

Hello World!!! 
This is simple text email message. 

--<?php echo $random_hash; ?>  
Content-Type: text/html; charset="iso-8859-1" 
Content-Transfer-Encoding: 7bit

<h2>Hello World!</h2>
<p>This is something with <b>HTML</b> formatting.</p> 

--<?php echo $random_hash; ?>--
<?
//copy current buffer contents into $message variable and delete current output buffer
$message = ob_get_clean();
//send the email
$mail_sent = @mail( $to, $subject, $message, $headers );
//if the message is sent successfully print "Mail sent". Otherwise print "Mail failed" 
echo $mail_sent ? "Mail sent" : "Mail failed";
?> 
```

问题是，虽然它发送电子邮件很好，但它要么以纯文本形式发送，要么在 Gmail 中发送空白消息。任何想法为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T23:23:35.273

我当然应该告诉你为此使用库，例如​​ swift，但我认为这是一个很好的练习，所以我会告诉你它有什么问题:)

这是因为你的行尾是错误的。除非另有说明，否则电子邮件中的行结尾是 CRLF ( `\r\n`)，而您的`ob_start()`块可能只有 LF ( `\n`) 作为行分隔符。

这会导致 GMail 误解电子邮件消息，而不会显示任何内容。在我的情况下，它显示一个空的下载文件；）

# java - 为什么不工作的java代码？

> ID：12117325
> 
> 赞同：0
> 
> 时间：2012-08-24T22:14:38.590
> 
> 标签：java

```
package mainData;

public class Hello{
    public void Hello(String sData, int ... nAges){
        for(int x : nAges){
            System.out.println(sData + " " + x);
        }
    }

    public static void main(String args[]){
        Hello ages = new Hello("Age: ", 5, 6, 7, 8);
    }
} 
```

当我更改**构造函数**（Hello > Hello2）时，此代码运行没有问题。但是为什么这段代码不起作用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-24T22:15:52.580

您正在定义一个名为`Hello`return type的方法`void`。**[构造函数](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)**没有返回*类型*；改用以下内容：

```
public Hello(String sData, int ... nAges) {
    for (int x : nAges) {
        System.out.println(sData + " " + x);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T22:16:34.447

`void`从您的构造函数中删除，它[应该可以工作](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)。[如果你给出一个返回类型](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.8)，那么你是在创建一个方法，而不是一个构造函数。

*我*怀疑当您重命名`Hello`为`Hello2`. 它可以编译和执行，但不会打印出`nAges`参数。请注意，编译不是正确性的充分测试。

# python - 使用 CUDA 或 OpenCL 在 python 中进行多维 FFT

> ID：12117327
> 
> 赞同：4
> 
> 时间：2012-08-24T22:15:02.397
> 
> 标签：python, cuda, opencl, fft

我一直在浏览对 FFT 进行编程以在我的显卡上工作的简单方法（这是最近支持 CUDA 3.s​​omething 的 NVIDIA）。我目前的选择是学习 C，然后是 CUDA 的特殊 C 版本，或者使用一些 python CUDA 函数。我宁愿不学习 C，因为我只用高级语言编程。我查看了 pyCUDA 和其他在 python 中使用我的图形卡的方法，但我找不到任何只能与 python 代码一起使用的 FFT 库。一些库/项目似乎处理类似的项目（CUDAmat，Theano），但遗憾的是我没有发现 FFT。

`numpy.fft.fft2()`是否存在可以使用我的图形卡执行相同操作的功能？

编辑：开源解决方案的奖励点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-15T14:17:32.840

有[PyFFT](http://packages.python.org/pyfft)，它是[开源的](http://github.com/Manticore/pyfft)，基于 Apple 的（有些有限的）[实现](http://developer.apple.com/library/mac/#samplecode/OpenCL_FFT/Introduction/Intro.html)。免责声明：我在 PyFFT 上工作 :)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-24T23:33:44.470

是的，ArrayFire 有一个[用于 Python 的二维 FFT](http://www.accelereyes.com/arrayfire/python/group__fft.htm)。

免责声明：我在 ArrayFire 上工作。

# php - 防止在php中重复插入sql

> ID：12117328
> 
> 赞同：0
> 
> 时间：2012-08-24T22:15:05.990
> 
> 标签：php, sql

> **可能的重复：**
> [防止重复的 SQL 条目](https://stackoverflow.com/questions/5412669/prevent-duplicate-sql-entries)

我只是在寻找一种简单的方法来告诉我记录是否已经存在，如果存在，则不要将其插入表中。无论它是否存在，下面的代码都会插入......我只是不知道为什么。

```
<?php
$FirstName = $_POST["FirstName"];
$LastName = $_POST["LastName"];

$conn = sqlsrv_connect( $hostname, $connectionInfo)

$dup = sqlsrv_query($conn, "SELECT * FROM contact WHERE (FirstName='$FirstName') AND (LastName='$LastName')");
if(sqlsrv_num_rows($dup) > 0)
{
    echo "Already Exists";
}
else
{
    $query = "INSERT INTO contact (FirstName, LastName) VALUES ('$FirstName', '$LastName')";
    sqlsrv_query( $conn, $query );
} 
```

编辑：

最终，改变`sqlsrv_num_rows($dup) > 0`以`sqlsrv_has_rows($dup)`解决问题。以下是我更新的代码：

```
$params = array($_POST['FirstName'], $_POST['LastName']);
$conn = sqlsrv_connect( $hostname, $connectionInfo)
$sql = "SELECT * FROM contact WHERE FirstName = ? AND LastName = ?";
$dup = sqlsrv_query($conn, $sql, $params);
if(sqlsrv_has_rows($dup)) 
{
    echo "Already Exists";
}
else
{
    $query = "INSERT INTO contact (FirstName, LastName) VALUES (?, ?)";
    sqlsrv_query( $conn, $query, $params );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:40:28.087

首先，您需要确定您的主键。这通常是某种 ID 字段。我可能会建议不要使用 FirstName LastName 的配对，因为有很多很多人的名字和姓氏相同的实例。“Kevin Kline”既是演员又是 SQL Server MVP（可能还有很多很多）。

如果您只想盲目地将 FirstName LastName 插入到表中，那么与 RDBMS 无关的查询更像

```
INSERT INTO contact (FirstName, LastName) VALUES ($FirstName, $LastName) WHERE NOT EXISTS 
(SELECT 1 FROM contact where FirstName = $FirstName and LastName = $LastName); 
```

（免责声明：我知道我没有根据您在帖子中的内容对其进行格式化，这是由于以下原因）

**然而：**

您的代码也容易受到 SQL 注入攻击。请阅读 PHP 方法[`sqlsrv_query`](http://www.php.net/manual/en/function.sqlsrv-query.php)，特别注意“params”参数。

此外，回到“Kevin Kline”示例，这只会插入第一个“Kevin Kline”。我想如果您将“Kevin Kline”添加为星型模式中的维度，该维度将与事实表中的专业等其他维度相关联，我想这很好。但是，如果这不是您的应用程序域，那么我强烈建议您确定要用作表键的内容，以便准确跟踪适当的数据。

# .htaccess - modrewrite - 将所有 php 文件转换为 html，它对 SEO 友好且双向工作

> ID：12117329
> 
> 赞同：2
> 
> 时间：2012-08-24T22:15:10.857
> 
> 标签：.htaccess, mod-rewrite, seo

我是这个 modrewrite 野兽的新手。我设法让它工作，我可以正常加载 index.php 作为 index.html 例如。

问题是当我尝试导航到 index2.html 并收到错误 404 错误时，`The requested URL /index2.php was not found on this server.`

我的 .htaccess 中有这段代码：

```
Options +FollowSymlinks
RewriteEngine on
RewriteRule ^(.*)\.html$ $1.php [nc] 
```

我尝试了几件事，但我只是陷入了困境。

基本上我想从 PHP 重写为 HTML，但我想看到实际上是 HTML 的文件也能正常工作。

我的第二个问题，也许最重要的是，在 SEO 方面有多好，它是正常的还是使用这种重写规则有什么缺点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:24:27.463

尝试添加条件`-f`

```
Options +FollowSymlinks 
RewriteEngine on 
RewriteCond %{REQUEST_URI} ^/(.*)\.html$
RewriteCond %{DOCUMENT_ROOT}/%1.php -f
RewriteRule ^(.*)\.html$ $1.php [nc] 
```

在重写之前检查以确保文件作为 php 存在

至于您的第二个问题，无论扩展是html还是php，这两种方式都没有太大区别。主要是因为您似乎在提供静态内容。

# c - 是否可以在 C 中显示数组？

> ID：12117334
> 
> 赞同：-2
> 
> 时间：2012-08-24T22:15:45.110
> 
> 标签：c, arrays

我想做一些战舰，但我不知道是否可以为操场显示二维阵列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:28:28.380

```
char arr[SIZE][SIZE];

int i,j;

for(i = 0; i < SIZE; i++){

   for(j = 0; j < SIZE; j++){

      arr[i][j] = 'O'; //initalizes

      printf(" %c ",arr[i][j]); //prints

   }
   purchar('\n'); //to break every row

} 
```

当它被击中时将点更新为 X，并在没有初始化行的情况下再次打印

抱歉，代码很奇怪，但它基本上是一个嵌套的 for 循环，每个循环都计算到游戏板的预定义大小，可以从 0 开始索引，SIZE-1 可能使它成为一个 char 数组并使用 O 和 X 以及其他字符来绘制船停了，老实说，我会让船八，等于等于和大写D，但选择是你的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:25:22.513

您可能正在寻找[for 循环](https://en.wikipedia.org/wiki/For_loop#C)。他们通常采取这样的方式：

```
size_t i; // size_t is an unsigned int large enough to hold a string's length
for(i = 0; i < size_of_my_array; ++i) {
    // do stuff with my_array[i]
} 
```

例如，单独打印字符串中的字符（不一定是最有效的方式）：

```
char* name = "Brendan";
size_t i; // size_t is an unsigned int large enough to hold a string's length
for(i = 0; i < strlen(name); ++i) {
    printf("%c", name[i]);
} 
```

循环其他类型的数组也是类似的。

# c# - 添加/删除项目时如何保持listboxitem的位置？

> ID：12117335
> 
> 赞同：0
> 
> 时间：2012-08-24T22:15:44.937
> 
> 标签：c#, windows-phone-7, listbox, scroll

我有一个包含 20-50 个项目的列表框。所有项目必须按唯一 ID 排序。应用排序后，我的列表框在顶部滚动。如何防止这种情况？排序功能

```
public static void Sort<TSource, TValue>(IList<TSource> source, Func<TSource, TValue> selector) {
      for (int i = source.Count - 1; i >= 0; i--) {
        for (int j = 1; j <= i; j++) {
          TSource o1 = source.ElementAt(j - 1);
          TSource o2 = source.ElementAt(j);
          TValue x = selector(o1);
          TValue y = selector(o2);
          var comparer = Comparer<TValue>.Default;
          if (comparer.Compare(x, y) > 0) {
            source.Remove(o1);
            source.Insert(j, o1);
          }
        }
      }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:25:12.773

要将 ListBox 焦点设置到列表中的最后一项，请使用以下表达式。

```
this.ListBox1.SelectedIndex = this.ListBox1.Items.Count - 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:26:11.040

这适用于 Windows 7。我没有 WP7 来测试它。

```
// Finds the last item on the screen
int index = listBox1.IndexFromPoint(1, listBox1.Height - 5);

// Sorting stuff...

// Set the selected index to the one we saved, this causes the box to scroll it into view
listBox1.SelectedIndex = index;
// Clear the selection
listBox1.ClearSelected(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T07:36:13.517

使用此函数从列表框中提取滚动查看器

```
 public ScrollViewer FindScrollViewer(DependencyObject parent)
    {
        var childCount = VisualTreeHelper.GetChildrenCount(parent);
        for (var i = 0; i < childCount; i++)
        {
            var elt = VisualTreeHelper.GetChild(parent, i);
            if (elt is ScrollViewer) return (ScrollViewer)elt;
            var result = FindScrollViewer(elt);
            if (result != null) return result;
        }
        return null;
    } 
```

使用此功能滚动到列表中的新项目：

```
 private void ScrollToOnFreshLoad()
    {
        ScrollViewer scroll = FindScrollViewer(listBox);
        Int32 offset = Convert.ToInt32(scroll.VerticalOffset);

        //load new list box here

        //then do this
        listBox.ScrollIntoView(listItems[offset]);
    } 
```

注意：使用偏移值直到获得所需的结果。希望能帮助到你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T10:41:09.803

只有这个有帮助

```
void loadItems(){
//load
    var t = new DispatcherTimer { Interval = TimeSpan.FromMilliseconds(1000) };
            t.Tick += delegate {
              _ScrollViewer.UpdateLayout();
              SomethingLoading = false;
              listmy.ScrollIntoView(listmy.Items[listmy.Items.Count - 10]);
            };
            t.Start();
} 
```

# php - 当我回显我的变量时，特殊的 html 字符以原始形式出现

> ID：12117338
> 
> 赞同：0
> 
> 时间：2012-08-24T22:15:47.347
> 
> 标签：php

我从 XML 文件中导入一些文本，然后修剪并替换多个空格。

```
$var = $myxmltext;
$var = trim($var);
$var = preg_replace('/\s+/',' ',$var); 
```

出于某种原因，当我回显它时，我会得到这样的“原始 html”：

```
quot; or IÂ’ve instead of I've 
```

任何想法为什么？

这是我的修剪功能：

```
function mytrim($mytrim){
    $mytrim = utf8_decode($mytrim); 
    $mytrim = trim($mytrim);
    $rule1 = array(
        ",",    // virgula
        ".",    // punct
        "~",    // ~
        "_",    // underscore
        "-",    // liniuta
        ")",    // paranteza inchidere
        ":",    // doua puncte
        ">",    // mai mare
        "<",    // mai mic
        "!",
        "?",
        "*",
        "&"
    );
    $rule2 = array(
        ", ",   // virgula
        ". ",   // punct
        " ~ ",  // ~
        " ",    // underscore
        " - ",  // liniuta
        ") ",   // paranteza inchidere
        ": ",   // doua puncte
        " > ",  // mai mare
        " < ",  // mai mic
        "! ",
        "? ",   
        "* ",
        " & "
    );
    $mytrim = str_replace($rule1, $rule2, $mytrim);
    $rule3 = array(
        " .",   // punct
        " ,",   // virgula
        " ?",   // question mark
        " !",
        " *",
        " )"
    );
    $rule4 = array(
        ".",    // punct
        ",",    // virgula
        "?",    // question mark
        "!",
        "*",
        ")"
    );
    $mytrim = str_replace($rule3, $rule4, $mytrim);
    $mytrim = preg_replace('/\s+/',' ',$mytrim);
    return $mytrim;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:43:39.767

在我看来，这是一个编码问题，XML 文件默认使用 UTF-8，尝试在 trim() 和 preg_replace() 之前使用 utf8_decode()

```
$var = utf8_decode($myxmltext);
$var = trim($var);
$var = preg_replace('/\s+/',' ',$var); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:46:22.037

在你做你的东西之前试试这个正则表达式：

```
preg_replace('/(&)\s+(\w+;)/', '$1$2', $text); 
```

然后做你的事，让我们看看那个 HTML 是否现在编码。

因此，这将通过更改所有内容来解决您的 HTML 编码的主要问题：

```
& quote; 
```

到：

```
&quote; 
```

请注意：这可能无法完全按预期工作，因此请进行测试。

当然，正如其他人所说，您也可以使用 utf8_decode/encode 来摆脱那些 umlet 字符。

## 编辑

要解决与号问题，请尝试：

```
preg_replace('/&(?!\w+;)/', ' & ', $text); 
```

因此，这将替换所有不在表格中的 & 并在`&quote;`两边留出空间。

和正常一样，先测试一下。

# c - LAPACK dgetrf 输入和输出是否应该转置？

> ID：12117346
> 
> 赞同：3
> 
> 时间：2012-08-24T22:16:53.197
> 
> 标签：c, lapack, blas, atlas

我`dgetrf`通过 LAPACK 在行主矩阵上调用`clapack.h`。

我有矩阵`A = [4,9,2; 3,5,7; 8,1,6]`。

如果我调用 dgetrf，结果是`[9.0, 0.222222, 0.444444; 5.0, 5.888888, 0.132075; 1.0, 5.777777, 6.792453]`. 但是，结果*应该*是`[8.0, 1.0, 6.0; 0.5, 8.5, -1.0; 0.375, 0.544118, 5.294118]`。

如果我在调用之前转置 A `dgetrf`，然后再次转置输出，我会得到正确的结果。

我正在使用的调用是：`clapack_dgetrf(CblasRowMajor, 3, 3, A, 3, ipiv);` `ipiv`当然，是一个大小为 3 的整数数组，而 A 是一个双精度数组，大小为 9: `[4,9,2,3,5,7,8,1,6]`。

我已经尝试将 order 参数切换为`CblasColMajor`，以防万一我疯了，但这也不能按预期工作。

这是应该的吗？

# android - 布局中的按钮未显示

> ID：12117347
> 
> 赞同：0
> 
> 时间：2012-08-24T22:17:01.350
> 
> 标签：android, xml, android-layout, layout

我试图在 .xml 文件布局中的图像视图下放置一个按钮，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<TextView 
    android:id="@+id/name"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Name: " />

<LinearLayout 
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="horizontal">
            <TextView
                android:id="@+id/divider01"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Meeting Point Position"
                android:paddingLeft="100dp"
                android:textColor="@android:color/black"
                android:textSize="9dp"
                android:background="@drawable/t_505_12">
            </TextView>
</LinearLayout>

<TextView 
    android:id="@+id/lat"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="LAT: " />

<TextView 
    android:id="@+id/lng"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="LNG: " />

<LinearLayout 
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="horizontal">
            <TextView
                android:id="@+id/divider01"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Date/Time"
                android:paddingLeft="120dp"
                android:textColor="@android:color/black"
                android:textSize="9dp"
                android:background="@drawable/t_505_12">
            </TextView>
</LinearLayout>

<TextView 
    android:id="@+id/date"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Date: " />

<TextView 
    android:id="@+id/time"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Time: " />

<LinearLayout 
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="horizontal">
            <TextView
                android:id="@+id/divider01"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Navigation Arrow"
                android:paddingLeft="120dp"
                android:textColor="@android:color/black"
                android:textSize="9dp"
                android:background="@drawable/t_505_12">
            </TextView>
</LinearLayout>

<LinearLayout 
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="vertical">

    <ImageView
    android:id="@+id/iv01"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"/>

<Button
    android:id="@+id/bt01"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="90sp"
    android:layout_marginTop="190sp"       
    android:text="Navigate" />
    </LinearLayout> 
```

但问题是：只有图像视图出现，按钮没有显示。关于如何解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T04:42:26.613

只需尝试将您的代码放入`ScrollView`

```
 <ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/scrollView1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

    <!--   
           Here Goes your whole Layoout
        -->

  </ScrollView> 
```

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:34:27.613

它们是否包含在 LinearLayout 中？

您始终可以通过 android:drawableTop 属性设置 Button 的可绘制顶部

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T22:34:29.383

您的 ImageView 可能会迫使您的按钮离开屏幕。你的图片有多大？您能否尝试缩小图像尺寸并将其放回 ImageView 以查看您的按钮是否出现？我假设您正在使用类似 LinearLayout 的东西。如果您使用的是相对布局，那么我认为您应该放置一个 layout_below 标签或类似的东西。此外，您可以尝试将您的 Button 放在 xml 文件中的 ImageView 上方，这样图像就会位于您的按钮下方，如果您的按钮当时没有显示，那么一定有另一个问题。

# mysql - SQL SELECT 最后一个条目没有限制

> ID：12117349
> 
> 赞同：3
> 
> 时间：2012-08-24T22:17:08.267
> 
> 标签：mysql, sql, postgresql, limit

我有一个包含 3 个字段的表：

```
id
note
created_at 
```

在 SQL 语言中，特别是 Postgres 有没有一种方法可以让我选择最后一个值`note`而不必这样做`LIMIT 1`？

普通查询：

```
select note from table order by created_at desc limit 1 
```

我对避免限制的东西感兴趣，因为我需要它作为子查询。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-25T01:18:29.543

### [带有EXISTS 半连接的](http://www.postgresql.org/docs/current/interactive/functions-subquery.html#FUNCTIONS-SUBQUERY-EXISTS)简单版本：

```
SELECT note FROM tbl t
WHERE  NOT EXISTS
    (SELECT 1 FROM tbl t1 WHERE t1.created_at > t.created_at); 
```

“查找以后没有创建其他笔记的笔记。”

这分享了@Hogan 版本的弱点，如果不是，它可以返回**多行**- 就像@Ollie 已经指出的那样。与@Hogan 的查询（仅针对简单类型定义）不同，这个查询可以很容易地改进：`created_at``UNIQUE``max()`

### 比较行类型

```
SELECT note FROM tbl t
WHERE  NOT EXISTS
   (SELECT 1 FROM tbl t1
    WHERE  **(t1.created_at, t1.id) > (t.created_at, t.id)**); 
```

假设您想要最大`id`的，以防与`created_at`, 和`id`是主键，因此是唯一的。这适用于 PostgreSQL 和 MySQL。

[SQL小提琴。](http://sqlfiddle.com/#!2/26117/1)

### 窗口功能

**PostgreSQL**中的[窗口函数](http://www.postgresql.org/docs/current/interactive/functions-window.html)也可以实现相同的目的：

 **```
SELECT note
FROM  (
    SELECT note, row_number() OVER (ORDER BY created_at DESC, id DESC) AS rn
    FROM   tbl t 
    ) x
WHERE  rn = 1; 
```

**MySQL**缺乏对窗口函数的支持。您可以用这样的变量替换：

```
SELECT note
FROM  (
    SELECT note, @rownum := @rownum + 1 AS rn
    FROM   tbl t 
         ,(SELECT @rownum := 0) r
    ORDER  BY created_at DESC, id DESC
    ) x
WHERE  rn = 1; 
```

`(SELECT @rownum := 0) r``SET`在没有显式命令的情况下使用 0 初始化变量。

[SQL小提琴。](http://sqlfiddle.com/#!2/26117/5)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-24T23:22:16.297

如果您的 id 列是一个自动递增的主键字段，这很容易。这假设最新的笔记具有最高的 id。（这可能不是真的；只有你知道！）

```
select *
  from note
 where id = (select max(id) from note) 
```

它在这里： [http](http://sqlfiddle.com/#!2/7478a/1/0) ://sqlfiddle.com/#!2/7478a/1/0用于 MySQL，这里[http://sqlfiddle.com/#!1/6597d/1/0](http://sqlfiddle.com/#!1/6597d/1/0)用于 postgreSQL。相同的 SQL。

如果你的 id 列没有设置，所以最新的笔记有最高的 id，但仍然是一个主键（也就是说，每行仍然有唯一的值），它有点难。我们必须消除相同日期的歧义；我们将通过任意选择最高 id 来做到这一点。

```
select *
  from note
  where id = (
              select max(id)
                from note where created_at = 
                   (select max(created_at) 
                      from note
                   )
              ) 
```

这是一个示例：[http](http://sqlfiddle.com/#!2/1f802/4/0) ://sqlfiddle.com/#!2/1f802/4/0用于 MySQL。这是postgreSQL（SQL是一样的，耶！）[http://sqlfiddle.com/#!1/bca8c/1/0](http://sqlfiddle.com/#!1/bca8c/1/0)

另一种可能性：如果它们都是在同一时间创建的，那么您可能希望*两个*音符一起显示在一行中。再说一次，只有你知道。

```
select group_concat(note separator '; ') 
  from note 
 where created_at = (select max(created_at) from note) 
```

在 postgreSQL 9+ 中，它是

```
 select string_agg(note, '; ') 
   from note 
  where created_at = (select max(created_at) from note) 
```

如果您确实有可能重复 created_at 时间和重复的 id 值，并且您不希望 group_concat 效果，那么您很遗憾被 LIMIT 困住了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-24T22:21:33.127

我不是 100% 使用 Postgres （实际上从未使用过它），但你可以用这样的东西获得相同的效果 - 如果`created_at`是唯一的......（或任何唯一的列）：

```
SELECT note FROM table WHERE created_at = (
    SELECT MAX(created_at) FROM table
) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-10-18T15:01:59.957

我可能不知道如何在这个平台上回答，但我的建议是有效的

```
SELECT * FROM table GROUP BY field ORDER BY max(field) DESC; 
```

可以不受限制地获取字段的最后一个值，通常在JOINED查询中我们会通过这种方式获取最后更新时间而不限制输出，例如没有限制的最后消息时间。**

# winforms - 通过 Visual Studio 中的 URL 语音转文本

> ID：12117351
> 
> 赞同：0
> 
> 时间：2012-08-24T22:17:27.197
> 
> 标签：winforms, visual-studio, speech-recognition

我做了很多研究并想出了下面的代码。它使用麦克风成功地将语音转换为文本。

我的网络服务器上有一个文件，通过 mp3 流式传输音频。它只是一个 mp3 文件的链接。我需要把它翻译成文本。

我试图找出最好的方法来做到这一点。那么，您可以选择音频输入作为计算机音频（即在网络浏览器中播放音频）吗？或者您可以将音频直接传输给翻译人员吗？我想我需要使用[SetInputToWaveStream](http://msdn.microsoft.com/en-us/library/system.speech.recognition.speechrecognitionengine.setinputtowavestream)方法，但不明白如何使用它。

```
Private Sub InitializeRecognizerSynthesizer()
Dim selectedRecognizer = ( _
    Where e.Culture.Equals(Thread.CurrentThread.CurrentCulture)).FirstOrDefault()
recognizer = New SpeechRecognitionEngine(selectedRecognizer)
recognizer.AudioStateChanged += New EventHandler(Of AudioStateChangedEventArgs)(recognizer_AudioStateChanged)
recognizer.SpeechHypothesized += New EventHandler(Of SpeechHypothesizedEventArgs)(recognizer_SpeechHypothesized)
recognizer.SpeechRecognized += New EventHandler(Of SpeechRecognizedEventArgs)(recognizer_SpeechRecognized)

synthesizer = New SpeechSynthesizer()
End Sub

Private Function SelectInputDevice() As Boolean
Dim proceedLoading As Boolean = True

If IsOscompatible() Then
    Try

        recognizer.SetInputToDefaultAudioDevice()
    Catch
            'no audio input device
        proceedLoading = False
    End Try
Else
    ThreadPool.QueueUserWorkItem(InitSpeechRecogniser)
End If
Return proceedLoading
End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T15:33:41.573

识别器.SetInputToWaveFile(file) - 将从文件系统中的文件读取音频输入。

识别器.SetInputToAudioStream - 将从流中读取音频输入。一个简短的例子：

```
FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read);
SpeechAudioFormatInfo format = new SpeechAudioFormatInfo(8000, AudioBitsPerSample.Sixteen, AudioChannel.Mono);
recognizer.SetInputToAudioStream(fs, format); 
```

从流或文件中读取时，您必须小心确保音频数据采用受支持的格式。例如，我知道在我的机器上工作的一种格式是：

*   每个样本 8 位
*   单声道单声道
*   每秒 22,050 个样本
*   PCM编码

有关音频格式的详细信息，请参阅[SAPI v5.1 SpeechRecognitionEngine 的帮助始终使用 C# 给出相同的错误结果。](https://stackoverflow.com/questions/6193874/help-with-sapi-v5-1-speechrecognitionengine-always-gives-same-wrong-result-with/6203533#6203533)

如果您的问题是如何从 Web 服务器获取资源并将其作为流处理，请参阅 HttpWebResponse.GetResponseStream - [http://msdn.microsoft.com/en-us/library/system.net.httpwebresponse.getresponsestream(v =vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.net.httpwebresponse.getresponsestream(v=vs.100).aspx)

# javascript - javascript正则表达式提取最后一个指定字符之后的第一个字符

> ID：12117357
> 
> 赞同：0
> 
> 时间：2012-08-24T22:18:21.833
> 
> 标签：javascript, regex

我试图提取字符串中最后一个下划线之后的第一个字符，字符串中的“_”数量未知，但在我的情况下，总会有一个字符，因为我在流程的另一个步骤中添加了它。

我尝试的是这个。我也尝试了正则表达式本身从名称中提取，但我的结果是空的。

```
var s = "XXXX-XXXX_XX_DigitalF.pdf"

var string = match(/[^_]*$/)[1]

string.charAt(0) 
```

所以最终想要的结果是'D'。如果 RegEx 只能让我知道最后一个 '_' 后面的内容，那很好，因为我知道我可以像当前显示的那样使用 charAt。但是，如果正则表达式可以完成整个事情，那就更好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:22:09.450

如果你知道总会有至少一个下划线，你可以这样做：

```
var s = "XXXX-XXXX_XX_DigitalF.pdf"

var firstCharAfterUnderscore = s.charAt(s.lastIndexOf("_") + 1);

// OR, with regex

var firstCharAfterUnderscore = s.match(/_([^_])[^_]*$/)[1] 
```

使用正则表达式，您可以通过使用括号来捕获匹配的那部分来仅提取一个字母。但我认为该`.lastIndexOf()`版本更易于阅读。

无论哪种方式，如果输入中可能没有下划线，您都需要添加一些额外的逻辑。

# jquery - 带有身份验证用户名的 jQuery 导航栏

> ID：12117358
> 
> 赞同：0
> 
> 时间：2012-08-24T22:18:30.500
> 
> 标签：jquery, css, ajax, twitter-bootstrap

我想在我所有页面的顶部添加一个导航栏（使用 twitter bootstrap）

导航栏需要包含经过身份验证的用户的全名。

我有一个用于 GET 的 REST 服务 /auth/rest/user/fullname ，它将以纯文本形式返回“Jane Doe”。

我有多个页面，所以我正在寻找一种解决方案，我可以在每个页面上添加最少量的样板代码。页面顶部是这样的：

```
<div id="banner"></div> 
```

这在底部：

```
<script>
    addBanner();
</script> 
```

任何建议/想法

我使用以下方法从banner.html文件加载横幅：

```
function addBanner() {
    $('body').css("padding-top", "50px");
    $("#banner").load("/banner.html");
    // how to replace the <span id="fullname">&nbsp;</span> with Jane Doe?
} 
```

编辑：我需要从 banner.html 文件中加载横幅的 HTML。该文件有一个 ID=fullname 的跨度，需要从 ajax GET 更新，并且整个 html“块”插入到 id=banner 的 div 中。我不能让这两部分都工作。我让 ajax 返回我的全名，我可以从静态文件加载，但是如何加载、修改通过 ajax 加载的内容然后插入到 DOM 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:22:27.220

您可以使用 jquery 的[`html()`](http://api.jquery.com/html/)或[`text()`](http://api.jquery.com/text/)方法。虽然`text()`速度稍微快一点，但我更喜欢使用`.html()`，因为如果您决定使用要插入的文本添加任何 html，它将无法按预期使用`text()`.

```
$('#fullname').html('Jane Doe');
// OR
$('#fullname').text('Jane Doe'); 
```

这将导致同样的事情：

```
<span id="fullname">Jane Doe</span>
// which displays as
Jane Doe 
```

但是，如果您想包含 html 内容，例如`<h1>Jane Doe</h1>`结果将是：

```
<span id="fullname"><h1>Jane Doe</h1></span>
// but with html() it will display the text
Jane Doe
// whereas with text() it will display the text
<h1>Jane Doe</h1> 
```

[Difference-between-jquery-text-and-html](http://jquerybyexample.blogspot.com/2011/02/difference-between-jquery-text-and-html.html)是一篇很好的博文，很好地解释了这一点。

[现场演示](http://jsfiddle.net/K5Zd8/1/)

关于您的编辑，您应该只加载横幅并在横幅更新后更新用户信息。您的添加横幅功能如下所示：

```
function addBanner() {
    $('body').css("padding-top", "50px");
    $("#banner").load("/banner.html", function() {
        $('#fullname').html('Jane Doe');
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:32:41.657

我和这个一起去了：

```
<script type="text/javascript">
    $(function() {
        $("#banner").load("banner.html");
        $('body').css("padding-top", "50px");
        $.ajax({
            url : "/auth/rest/user/fullname",
            cache : false
        }).done(function(html) {
            $('#fullname').html(html);
        });
    });
</script> 
```

# apache - 远程调试在本地工作，但不能在远程工作（在 iPhone Safari 上）

> ID：12117361
> 
> 赞同：0
> 
> 时间：2012-08-24T22:18:51.663
> 
> 标签：apache, .htaccess, mod-rewrite, requirejs, remote-debugging

我正在尝试从我的手机调试我的本地移动网站。我的移动网站使用来自我的主网站的文件，因此每当请求这些文件时，我都会将请求重定向到主网站。

这适用于我 Mac 上的 Chrome/Safari，但我在 iPhone 的 Safari 中收到以下错误：

```
JavaScript: Error
undefined
Error: Script error
http://requirejs.org/docs/errors.html#scripterror 
```

这是我`.htaccess`进行重写的代码：

```
# models/collections/helpers/objects/libs
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l
RewriteCond %{HTTP_HOST} ^(10\.172\.71\.125|localhost)$ [NC]
RewriteRule ^js/(models|collections|helpers|objects|libs)/(.*?)$ http://local.mysite.co/js/$1/$2 [L,QSA,R=302] 
```

因此，它会检查是否可以在当前文档根目录（即`/mobile`我的主站点内的文件夹）中找到该文件，当它发现找不到该文件时，它会从我的主网站（`local.mysite.co`我已在 Apache 中设置位于`/`）。

我的猜测是错误给出了 requirejs 链接，因为我使用 requirejs 来加载我的文件，并且由于找不到它们（在我的 iPhone 的 Safari 上），它会引发该错误。

我`http://10.172.71.125/`用作我的 URL（在我的笔记本电脑和 iPhone 上），它只适用于我的笔记本电脑。

我在这里没有想法:(有人可以帮助我吗？在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T01:19:52.737

我最终使用主 IP 作为我的主站点，并设置了一个指向移动子域的端口——这样移动站点仍然可以通过简单地删除端口来向主站点的文件发送请求。

# cocos2d-iphone - Cocos2D+Box2D：堆叠不会掉落的物体？

> ID：12117369
> 
> 赞同：1
> 
> 时间：2012-08-24T22:19:38.930
> 
> 标签：cocos2d-iphone, box2d-iphone

**编辑2：问题解决了！我不能保证它会在不同的设置下工作，但是通过将我的块体密度设置为 0，当添加新块时，块堆栈不会下降。**

我很抱歉这个问题的标题很糟糕，我会在这里更详细地解释我的问题：

因此，我使用 Box2D 和 cocos2D 设置了一个简单的项目，其中两个盒子堆叠在一起（我计划扩展到 8-10 个盒子）。现在，在每个盒子上使用 10.0f 的摩擦力，顶部的盒子仍然会移动一点。如果我要添加更多的盒子，“塔”就会倒塌，我不希望这样。

我希望盒子利用重力向下移动，但我从不希望它们从 x 值开始改变。那么，我怎样才能防止我的盒子塔倒塌或防止我的盒子在 x 方向上移动呢？

编辑：发布一些代码 此代码创建一个框，另一个只有一个不同的 sprite 文件。

```
CCSprite *block = [CCSprite spriteWithFile:@"red.png"];
block.position = ccp(200,380);
[self addChild:block];
//Body definition
b2BodyDef blockDef;
blockDef.type = b2_dynamicBody;
blockDef.position.Set(200/PTM_RATIO, 200/PTM_RATIO);
blockDef.userData = block;
b2Body *blockBody = _world->CreateBody(&blockDef);
//Create the shape
b2PolygonShape blockShape;
blockShape.SetAsBox(block.contentSize.width/PTM_RATIO/2, block.contentSize.height/PTM_RATIO/2);
//Fixture defintion
b2FixtureDef blockFixtureDef;
blockFixtureDef.shape = &blockShape;
blockFixtureDef.restitution = 0.0f;
blockFixtureDef.density = 10.0f;
blockFixtureDef.friction = 10.0f;
_redBlockFixture = blockBody->CreateFixture(&blockFixtureDef); 
```

没有什么花哨。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T21:28:22.907

您可以在 box2D 的左右两侧设置 2 个（1 像素宽）墙。这是左墙的一些示例代码。要创建正确的墙，只需复制并粘贴代码并更改变量名称和 BodyDef 的位置。

```
// Constant you'll need to define
float wallHeight;

// Create wall body
b2BodyDef wallBodyDef;
wallBodyDef.type = b2_dynamicBody;
wallBodyDef.position.Set(200 - block.contentSize.width/PTM_RATIO/2, 0);
b2Body *wallBody = _world->CreateBody(&wallBodyDef);

// Create wall shape
b2PolygonShape wallShape;
wallShape.SetAsBox(1, wallHeight);

// Create shape definition and add to body
b2FixtureDef wallShapeDef;
wallShapeDef.shape = &wallShape;
wallShapeDef.density = 100.0f;
wallShapeDef.friction = 0.0f;
wallShapeDef.restitution = 0.0f;
b2Fixture *wallFixture = wallBody->CreateFixture(&wallShapeDef); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-13T11:12:21.410

我通过调整堆叠块的静态表面的恢复（反弹）解决了这个问题。例如，如果地板的复原力为 0.2，则一叠五个积木看起来像是相互挤压，并最终倒塌： ![块开始](../Images/b6e375ae1bd1389b0c3f568f32a41aae.png)

将地板的恢复原状设置为 0，积木会按照您期望的方式堆叠： ![块保持堆叠](../Images/5900cb96807fd3c1a33561f4fa803b6a.png)

# django - Django文件大小检查不起作用

> ID：12117371
> 
> 赞同：2
> 
> 时间：2012-08-24T22:19:45.053
> 
> 标签：django, django-forms

我写了一个小函数来检查文件是否大于设定值。但不知何故它不起作用。我已经设置了 50 MB 的限制，但即使尝试上传 100 MB 的数据，它仍然让它上传。这是我的 forms.py 类和函数

```
from django.template.defaultfilters import filesizeformat

class ScribbleSaveForm(forms.Form):
    title=forms.CharField(
      label=u'Title',
      required=False,
      widget=forms.TextInput(attrs={'size':120})
    )
    media=forms.FileField(
      label=u'add file',
      required=False,
      widget=forms.FileInput()
    )
    body=forms.CharField(
      label=u'description',
      widget=forms.Textarea()
    )
    tags=forms.CharField(
      label=u'Tags',
      required=False,
      widget=forms.TextInput(attrs={'size':64})
    )
    def file_size(self):
            media=self.cleaned_data.get('media',False)
            if media:
                if media._size > 50*1024*1024 :
                    raise forms.ValidationError('Please keep filesize under 50MB.')
                return media
            else:
                raise forms.ValidationError('Could not read uploaded file.') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T00:24:19.090

您走在正确的轨道上，您应该将 file_size 重命名为 clean_media。请参阅[https://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-a-specific-field-attribute](https://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-a-specific-field-attribute)

此外，请确保您始终返回您正在清洁、验证或不验证的内容。

# .net - 如何检查 TcpClient 是否已连接？

> ID：12117373
> 
> 赞同：2
> 
> 时间：2012-08-24T22:19:54.930
> 
> 标签：.net, tcpclient

当我的客户端应用程序关闭套接字甚至终止时，我的服务器仍然认为它还活着。我什至检查[了 TcpClient.Connected](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient.connected%28v=vs.90%29.aspx)然后我看到了这个。我加粗了重要的部分

> 如果客户端套接字在**最近一次操作时连接到远程资源，**则为 true ；否则为假。

我怎么知道套接字是否关闭？目前我必须做一个操作并得到一个异常来发现它是打开还是关闭

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:06:07.687

有很多事情可以破坏套接字上的通信，其中许多完全超出您的控制范围，最好保持简单。

目前，您拥有一个完全可以接受的检测机制，非常简单且成本低。

您可以进行心跳，每隔 X 次从客户端发送一条“我在这里”消息，然后让服务器运行并查看是否没有针对 X * 小提琴因子间隔的消息。虽然使用处理器时间和带宽。

另一种选择取决于您的客户端检测到它不再连接并请求新连接。如果您在 request 中有一个唯一标识符，您可以为它运行现有的连接，如果它在那里，则将其杀死，然后开始然后正常继续。

我知道异常感觉不对，但是如果您不断失去连接，这才是真正的问题，如果您是这样的话，您的努力会更好地解决这个问题。

# shell - Shell 脚本 - io 重定向 - 运算符的优先级

> ID：12117375
> 
> 赞同：1
> 
> 时间：2012-08-24T22:20:08.580
> 
> 标签：shell, operator-keyword, operator-precedence

有人可以解释这两个代码之间的区别吗？

```
bad_command 2>&  >> file.out 
```

和

```
bad_command >> file.out 2>& 
```

手册上说这两个代码是不同的，第一个命令不会向file.out输出任何内容。

**所以，这是我的问题。**

1/这是什么原因？

2/ 是否有描述运算符优先级如何在 shell 中工作的文档？shell 如何解析并使其成为语法树。

3/它的正确语法和顺序是什么？

- 提前致谢 -

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:46:38.173

两者在语法上都是错误的。我想你的意思是

```
bad_command 2>&1  >> file.out 
```

和

```
bad_command >> file.out 2>&1 
```

反而。

这之间，是有区别的。重定向是命令式语句，从左到右执行。重定向对进程的**文件描述符 (fds)**进行操作。您可能听说过标准文件描述符#0（标准输入/stdin）、#1（标准输出/stdout）、#2（标准错误/stderr）。

第一个命令行的重定向读取：“使 fd 2 成为 fd 1 的副本，但随后将 fd 1 更改为附加到 'file.out'”（第二个重定向对 fd 2 无效，它仍然是 fd 1 的副本是在开始）

秒读：“更改 fd 1 以附加到 'file.out'，然后使 fd 2 成为 fd 1 的副本”（第一次重定向对第二次重定向有效，bot fds 现在相同）

# c# - c# Codedom 将程序设置写入生成的文件

> ID：12117381
> 
> 赞同：0
> 
> 时间：2012-08-24T22:21:14.430
> 
> 标签：c#, settings

我会问它是否可以`Codedom` [像这样使用设置](http://msdn.microsoft.com/en-us/library/aa730869%28v=vs.80%29.aspx)

示例：将设置写入新鲜生成的`Executable`文件，比如`Resources`或类似的东西。

我在msdn上搜索过，但没有找到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:30:40.360

不直接使用 CodeDom。顾名思义，**Code** Dom 是关于代码以及你可以用它做什么。理论上，您可以通过 CodeDom 生成程序集，然后使用其他库对其进行操作以将资源嵌入其中。

# lua - 让 Lua 覆盖全局变量

> ID：12117383
> 
> 赞同：3
> 
> 时间：2012-08-24T22:21:31.020
> 
> 标签：lua

我使用 Lua 作为配置语言。众所周知，配置应该有系统范围的和用户的。

我刚刚发现 Lua 会保留原始值而不是覆盖它们。

例如，这是第一个源文件，

```
-- a.lua
var=1 
```

和第二个源文件

```
-- b.lua
var=2 
```

结果如下：

```
> lua-5.1 
Lua 5.1.5  Copyright (C) 1994-2012 Lua.org, PUC-Rio
> dofile ("a.lua")
> dofile ("b.lua")
> print(var)
1 
```

是的。`var`未被覆盖。这会使用户自己的配置不起作用。任何人都知道如何让 Lua 概览默认具有相同变量名的变量？非常感谢。（上面的来源只是例如，实际上我正在使用 Lua 和 C）

**PS：**我再次检查了上面的测试并且它有效。请参阅尼科尔回答下的评论。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T02:31:12.460

通常的做法是有一个`table`系统参数和一个`table`用户参数。例如，

a.lua

```
sys = { var = 1; a = 3 } 
```

b.lua

```
usr = { a = 5; b = 7 } 
```

配置管理器会

```
setmetatable(usr,{__index = sys}) 
```

测试：

```
> =usr.a
5
> =usr.var
1
> =usr.b
7
> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T10:28:05.313

我试图重现您的错误，但它完全按照您的预期工作。因此，如果你得到了这个，那几乎可以肯定是你在某处你没有提到的地方做的事情。您确定这些文件包含您所说的内容吗？

# c - 有一个用全局变量编写的完整项目，我应该用引用传递替换吗？

> ID：12117386
> 
> 赞同：0
> 
> 时间：2012-08-24T22:21:42.557
> 
> 标签：c, pass-by-reference, global

我已经完成了一个严重依赖于 C 中的字符串操作的项目。问题是我应该将全局变量更改为通过引用传递吗？代码超过 300 行，全局变量似乎运行良好。我读过 pbr 可以提高可读性的其他帖子。

我有大约 6 个全局变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:37:59.730

您应该始终致力于使您的状态尽可能小。拥有大状态（粗略地说：在代码中的任何一点，可访问（可靠）变量的数量都很高）意味着在每个点上更多的责任，更难维护，更不直观的阅读。

所以是的，全局变量只有在你无法忍受将它们传递给每个小函数的情况下。

如果你有一个一次性程序，全局状态显然是可以的，但是你通常不会首先从 C 开始。

6个全局变量听起来不多，但不能一概而论。

# c - 是否有任何操作系统允许应用程序程序员从 thunk 中创建指针？

> ID：12117388
> 
> 赞同：-1
> 
> 时间：2012-08-24T22:21:48.577
> 
> 标签：c, pointers, memory-mapped-files, memory-mapping, thunk

许多操作系统允许存储映射文件，并懒惰地读取它们。如果操作系统可以做到这一点，那么它就有能力从 thunk 中创建常规指针。

是否有任何操作系统允许应用程序程序员从他自己的 thunk 中创建指针？

我知道操作系统在一定程度上已经支持此功能，因为可以创建一个管道，将其映射到内存中，并将一个进程连接到管道以完成我正在谈论的一些事情，所以这个功能似乎不太不可能或不合理。

这个特性的一个简单例子是一个指针，它计算它被取消引用的次数。以下程序将输出零，然后输出一。

```
static void setter(void* environment, void* input) {
 /* You can't set the counter */
}

static void getter(void* environment, void* output) {
  *((int*)output) = *((int*)environment)++;
}

int main(int argc, char** argv) {
 volatile int counter = 0;
 volatile int * const x = map_special_voodoo_magic(getter, setter, sizeof(*x),
                                                   &counter);

 printf("%i\n", *x);
 printf("%i\n", *x);

 unmap_special_voodoo_magic(x);
} 
```

PS 需要一个 volatile 限定符，因为 x 指向的值会意外更改，对吧？同样，编译器没有理由认为取消引用 x 会改变计数器，所以那里也需要一个 volatile 对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T23:19:10.500

以下代码没有错误检查，也不是完整的实现。但是，以下代码确实说明了如何将 thunk 转换为指针的基本思想。特别是，值 4 是按需计算的，而不是更早分配给内存的。

```
#include <stdlib.h>
#include <stdio.h>
#include <sys/mman.h>
#include <signal.h>

void * value;

static void catch_function(int signal, siginfo_t* siginfo,
                 void* context) {
    if (value != siginfo->si_addr) {
        puts("ERROR: Wrong address!");
        exit(1);
    }

    mmap(value, sizeof(int), PROT_READ | PROT_WRITE, MAP_FIXED | MAP_SHARED
                        | MAP_ANON, -1, 0);

    *((int*)value) = 2 * 2;
}

int main(void) {
    struct sigaction new_action;

    value = mmap(NULL, sizeof(int), PROT_NONE, MAP_ANON | MAP_SHARED, -1,
                    0);

    sigemptyset(&new_action.sa_mask);

    new_action.sa_sigaction = catch_function;
    new_action.sa_flags = SA_SIGINFO;

    sigaction(SIGBUS, &new_action, NULL);

    printf("The square of 2 is: %i\n", *((int*)value));

    munmap(value, sizeof(int)); 

    return 0;
} 
```

# google-maps-api-3 - 在 Google Maps 电子表格映射器 (KML) 位置气球中隐藏损坏的图像图标/链接

> ID：12117390
> 
> 赞同：0
> 
> 时间：2012-08-24T22:22:11.857
> 
> 标签：google-maps-api-3, kml, brokenimage

我被这个不寻常的问题难住了：我正在使用 Google Maps v3 API 来显示电子表格映射器 KML 数据，并且我们在 KML 中引用了一些自定义图像，这些图像出现在位置/地点气球中。Google 似乎不允许在其气球层中引用 Javascript（具有讽刺意味，对吗？），因此基于未找到图像或 src 不存在来隐藏损坏的图像链接似乎是不可能的。

非技术人员营销人员将通过将气球图像通过 FTP 传输到文件夹来逐渐填充图像，但这将逐渐发生并且需要独立于 KML 立即显示。因此，KML 仅具有与需要创建的图像名称相对应的帐号引用。

对于那些尚未上传的图像，我们不希望出现损坏的图像图标，但如果没有 Javascript 访问或对象标签（也不可用），这似乎几乎是不可能的。Firefox 有一个关闭损坏图像的设置，但它不是一个选项（IE 似乎有最好的“捏合和缩放”支持，这被用于大型触摸屏显示器。

气球 HTML 在 KML 文件中显示如下：

`<table width="{static_Balloon_Width}"><tr> <td colspan="2"> <span style="font-size:{static_Title_Font_Size};"><b>{unique_Title}</b></span><br> <br> <span style="font-size:{static_Subtitle_Font_Size};"><b>{unique_Subtitle}</b> </span><br> <img src="images/location/{unique_Paragraph1_Text}.jpg" alt=" "><br> <br> {unique_Paragraph2_Text}<br> <a href="{unique_Link_URL}">{unique_Link_Text}</a> <hr> </td> </tr> <tr> <td align="left"><a href="{static_Footer_Link_URL}">{static_Footer_Link_Text}</a> </td> <td align="right"><span style="color:{static_Footer_Text_Color};"> {static_Footer_Text}</span></td> </tr></table>`

如果您对避免显示损坏的图像链接有任何想法，请告诉我！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:38:32.093

您可以在加载 KmlLayer 的页面中处理信息窗口的内容。

1.  在构造函数中设置 suppressInfoWindows:true
2.  创建一个单击侦听器，该侦听器访问单击事件的 infoWindowHtml 属性，对其进行处理以删除图像（或根据需要进行处理），然后打开信息窗口。

注意：我看到了不抑制 infoWindows 的代码，添加了一个修改 infoWindowHtml 内容的点击侦听器并且似乎可以工作，但我不知道我是否信任它。

这里是一个[使用 FusionTablesLayer 的例子](http://www.geocodezip.com/www_satpacktravel_com_api_v5b.html)，点击事件略有不同，但原理是一样的。

# networking - Elastic beanstalk 使用唯一 ip 访问外部数据中心

> ID：12117396
> 
> 赞同：1
> 
> 时间：2012-08-24T22:22:58.350
> 
> 标签：networking, proxy, amazon-web-services, amazon-elastic-beanstalk

我有以下情况：

*   具有 N 个实例的弹性 beantalk
*   ELB 用于 EBS 的负载均衡
*   具有 IP 过滤的外部数据中心

由于我无法按名称（fqdn）过滤，也无法过滤单个 IP，有没有办法让来自 AWS 机器的所有请求只有一个 IP，或者使用第三台机器作为代理 AWS 机器的调用，然后在其上附加 EIP。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T17:15:42.233

并不真地。或者至少，如果有办法做到这一点，我很想听听。beantalk 的最大问题之一是它要求存在于 VPC 之外，因此存在于任意 Amazon IP 空间中。在与 AWS 工程师交谈后，我发现的唯一解决方法是将来自他们的流量转发到堡垒服务器之类的东西，并允许堡垒服务器与您的数据中心防火墙进行通信。也许我遗漏了一些东西，但我知道没有其他方法可以让它在 beantalk 实例和数据中心之间没有一些服务器的情况下工作；如果服务器的IP很重要，则不是。

# javascript - 从 XML 字符串将 KML 添加到矢量图层

> ID：12117398
> 
> 赞同：2
> 
> 时间：2012-08-24T22:23:13.807
> 
> 标签：javascript, grails, openlayers

我在服务器上有一个 XML 字符串。我需要让 Open Layers 获取、阅读并显示它。它连接到 Grails。我知道它会得到它，因为我让它用字符串提醒我。我尝试了这个解决方案：[https ://gis.stackexchange.com/questions/16629/how-to-add-kml-data-but-from-variable-not-from-url](https://gis.stackexchange.com/questions/16629/how-to-add-kml-data-but-from-variable-not-from-url)

但无法显示。我的 JS 控制台中没有错误。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-22T14:49:53.650

您可能需要检查两件事：

*   `yourLayer.features`它包含一些东西吗？
*   如果您的图层包含要素。检查该`yourLayer.style`属性是否定义为一个有效的 Style（意味着一个 Style 实例具有该类型特征的渲染器）。更多关于造型的[信息在这里](http://docs.openlayers.org/library/feature_styling.html)

# vba - 根据访问中的组合框隐藏/显示多列

> ID：12117402
> 
> 赞同：2
> 
> 时间：2012-08-24T22:23:44.687
> 
> 标签：vba, ms-access, subform

我有一个包含多达 100 列的子表单的表单，但是我每次只需要查看其中的 5 列。我需要查看的列始终是名字和姓氏以及基于主窗体中所做选择的其他三列（列具有标签，例如 HT001、HT002 等）。可用的三个组合框各有一列。我到处寻找解决方案并不断寻找

我！[mycontrol].columnhidden = false

我可以看到它对于一两列是如何工作的，但是如果每一列都需要这个，我的代码将需要非常长。除了大量的列之外，我还有 12 个不同的子表单，这些子表单是从使用选择案例过程中选择的。我正在寻找一个简单的解决方案，因为我仍在学习 VBA。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:25:08.133

如果您使用的是数据表，则可以根据所做的选择动态设置记录源。

```
 Me.RecordSource = "SELECT HT001, HT002 FROM MyTable" 
```

您可以在构建 sql 时参考组合框：

```
 Me.RecordSource = "SELECT HT001, " & Me.Combo1 & " FROM MyTable" 
```

**关于使用带有表中的字段列表的列表框的一些注意事项。**

您可以将行源类型设置为字段列表，将行源设置为表名：

```
RowSource:  Table1 
RowSourceType:  Field List 
```

为了选择多个字段，设置 multiselect 属性很重要：

```
MultiSelect : Simple 
```

您可以遍历代码中的选定项目并构建一个字段列表以在您的 sql 中使用：

```
For Each itm In Me.List0.ItemsSelected
  strSelect = strSelect & "," & Me.List0.Column(0, itm)
Next

strSelect = Mid(strSelect, 2)
sSQL = "SELECT " & strSelect & " FROM Table1" 
```

# jquery-mobile - 就 UI 而言，jQuery Mobile 和 Sencha Touch 哪个更可定制？

> ID：12117405
> 
> 赞同：0
> 
> 时间：2012-08-24T22:24:00.410
> 
> 标签：jquery-mobile, sencha-touch

我是一名经验丰富的 iOS 开发人员，经过大量决策后，我们得出结论，将 phoneGap 用于我们的下一个项目，该项目应该是一个多平台应用程序。现在的问题是在PhoneGap、Sencha 和jQuery Mobile 中使用什么？

我访问了 SO、Quora 和很多博客上的旧帖子，得出的结论是，jQuery Mobile 非常适合入门和学习，但 Sencha 在控件、客户端上的 MVC 和可扩展性方面要强大得多。

我过去使用过 jquery、jquery 插件和 ExtJS，我对他们的任何一个移动设备都很好。

所以说到重点，我们的应用程序将由一个不知道我们将使用什么来制作应用程序的设计师设计。

他将为我们提供应用程序的线框图和用于放置在按钮、标签栏等上的图像的切片。

这就是我们标准 iOS 设计流程的工作方式。那么这两个框架中哪一个适合这种开发风格，我将能够复制设计师给出的 UI。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T14:45:17.280

Coming from iOS, Sencha Touch might be a little closer to what you're used to. Having had a little iOS experience, I feel like ST has a much closer layout system. jQuery Mobile would be best if the implementor is used to building things for the browser.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T17:39:24.407

I think both are equally customizable. Having that said ST provides more built in components and hooks whereas jqm wants you to do more on your own. Both frameworks differ extremely in their approach. Jqm uses a declarative designer friendly approach whereas ST uses an OOP programmer friendly approach.

# c# - 如何使用 BackgroundWorker 而不是 Application.DoEvent 来防止应用程序挂起

> ID：12117406
> 
> 赞同：1
> 
> 时间：2012-08-24T22:24:01.180
> 
> 标签：c#, .net, backgroundworker, doevents

我是 c#/.net 的初学者，所以请告诉我如何使用 BackgroundWorker 而不是 Application.DoEvent。

这是我的代码：

```
while (webBrowser1.ReadyState!= WebBrowserReadyState.Complete)
{
  Application.DoEvents(); //how to use "BackgroundWorker" here 
  if (webBrowser1.ReadyState == WebBrowserReadyState.Complete)
  {                            
    listBox1.Items.RemoveAt(listBox1.SelectedIndex);
    listBox1.SelectedIndex = 0;

    var num = listBox1.Items.Count;
    string str = Convert.ToString(num);
    label2.Text = str;                            
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:31:43.263

你不需要BackgroundWorker。只需使用`DocumentCompleted`事件。

```
 webBrowser1.DocumentCompleted += webBrowser1_DocumentCompleted;

void webBrowser1_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
{
     //Do your work   
} 
```

# c# - 从 C 结构生成 C# 结构

> ID：12117407
> 
> 赞同：3
> 
> 时间：2012-08-24T22:24:09.557
> 
> 标签：c#, code-generation

我有几十个 C 结构，我需要在 C# 中使用它们。典型的 C 结构如下所示：

```
typedef struct _UM_EVENT
{
   ULONG32 Id;
   ULONG32 Orgin;          
   ULONG32 OperationType;  
   ULONG32 Size;           
   LARGE_INTEGER Time;     
   HANDLE ProcessId;
   HANDLE ThreadId;
} UM_EVENT, *PUM_EVENT; 
```

为了在 C# 中使用这个结构，我在 C# 中声明它，然后进行编组，大致可以这样完成：

```
public struct UM_EVENT
{
   public UInt32 Id;             
   public UInt32 Orgin;          
   public UInt32 OperationType;  
   public UInt32 Size;           
   public UInt64 Time;           
   public IntPtr ProcessId;      
   public IntPtr ThreadId;       
}

private void Load(IntPtr event) {

   unsafe
   {
       UM_EVENT header = *(UM_EVENT*)event;
   }
} 
```

恕我直言，如果代码被多次编写，这种方法有以下缺点：

1.  编码速度不快，不需要太多思考
2.  该代码可能包含许多可能长时间未被发现的错误
3.  代码不是很可维护，因为 C 结构的更改需要 C# 结构的相同更改

那么，有没有人知道一个工具可以自动从给定的 C 结构生成呈现的 C# 代码？或者是否有一种完全不同的方式可以在 C# 中舒适地使用大量 C 结构？

# excel - 使用 Excel 宏更改数据透视表外部数据源路径

> ID：12117408
> 
> 赞同：0
> 
> 时间：2012-08-24T22:24:13.283
> 
> 标签：excel, vba, connection, relative-path

我正在 MS Excel 中处理一个项目，其中有几个数据透视表，它们使用 Microsoft 文本驱动程序从制表符分隔的文本文件中读取数据，第一行中的列名（与 Excel 文件位于同一目录中）。我遇到了一个问题，当我将文本和 Excel 文件复制到新目录并尝试刷新数据时，它说找不到文本文件。不幸的是，似乎没有办法告诉 Excel 我希望文本文件的路径是相对的，而不是绝对的。所有的数据透视表都使用相同的数据连接，所以我认为编写一个宏来更新数据连接以引用正确的文本文件并有一个链接到宏的按钮来更新文件路径并为我刷新数据。

我对 VBA 并不太熟悉，而且在线文档似乎很糟糕，所以我无法让它工作——我可以创建正确的文件路径并刷新数据，但我还没有能够弄清楚如何更新连接以使用新文件路径但保留其所有旧的导入/文件解析设置。我也尝试过在手动更新数据源时录制宏，但由于某种原因，这总是会给我带来中断录制的错误，所以这没有帮助。

以下是连接当前使用的连接字符串和命令文本，但没有关于如何解析/导入数据（文件以制表符分隔或在第一列中有标题等），所以我不确定如何确保连接保留该数据。

连接字符串：

```
DefaultDir=C:/directoryPath;Driver={Microsoft Text Driver (*.txt; *.csv)};
  DriverId=27;FIL=text;MaxBufferSize=2048;MaxScanRows=8;PageTimeout=5;
  SafeTransactions=0;Threads=3;UserCommitSync=Yes; 
```

命令文本：

```
SELECT *
FROM tableName.txt tableName 
```

如果有人知道如何编写一个宏来更新与文本文件的连接路径，请分享代码，或者如果你知道如何使路径相对也很好。任何帮助将不胜感激！

**编辑：**

我一直在搞乱它，我能够更改连接字符串以使用新路径。但是，当我去刷新数据透视表时，它将所有数据作为文本导入，而不是猜测它是否应该是数字等（尽管它确实从文本文件的第一行获取列标题，至少）。关于如何告诉它猜测数据类型（或只保留旧数据类型）的任何想法？我现在使用的代码是：

```
Public Sub Test()
    Dim wb As Excel.Workbook
    Dim pc As PivotCache
    Dim path As String

    Set wb = ActiveWorkbook
    path = wb.path

    For Each pc In wb.PivotCaches
        'Debug.Print pc.Connection
        pc.Connection = "ODBC;DBQ=" & path & ";DefaultDir=" & path & ";Driver={Microsoft Text Driver (*.txt; *.csv)};DriverId=27;FIL=text;MaxBufferSize=2048;MaxScanRows=8;PageTimeout=5;SafeTransactions=0;Threads=3;UserCommitSync=Yes"

    Next
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T01:35:07.893

好的，所以我让它工作并认为我会分享。我循环浏览了工作簿中的每个连接，并将其路径更改为文本文件的新路径（通过获取活动工作簿的路径并附加文本文件目录的名称来创建）。此外，为了确保每次我需要在导入信息中包含一个“schema.ini”文件时它正确导入文本文件（与文本文件位于同一目录中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T02:52:07.847

我并不完全熟悉以这种方式创建数据透视表，但通常您可以通过查看 QueryTable 对象来获取数据透视表的信息，例如 Connection。看看这个例子：

```
Option Explicit

Public Sub UpdatePivotTableConnections()
    Dim ws As Excel.Worksheet
    Dim qt As Excel.QueryTable
    Dim fileName As String

    For Each ws In ThisWorkbook.Worksheets
        For Each qt In ws.QueryTables
            fileName = GetFileName(qt)
            MsgBox "The file name for PivotTable '" & qt.Name & "' is: " & fileName
        Next
    Next
End Sub

Public Function GetFileName(ByRef qt As QueryTable) As String
    Dim s() As String
    s = Split(qt.Connection, "\")
    GetFileName = s(UBound(s))
End Function 
```

这不是一个完整的答案，但它是一个开始（我不喜欢发布不完整的答案，但这是向您展示代码示例的唯一方法。）如果您可以从那里访问信息，请查看您从该信息中获得的信息，尝试查看 QueryTable.Connection 字符串，看看如何解析它并为每个数据透视表替换它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-27T20:15:55.870

我发现了这一点，并且有许多相同的属性..

```
 With ActiveSheet.QueryTables.Add(Connection:= _
    "TEXT;\\Path\To\CSV\Folder\CSV_Data.csv" _
    , Destination:=Range("$A$1"))
    .CommandType = 0
    .Name = "Book1"
    .FieldNames = True
    .RowNumbers = False
    .FillAdjacentFormulas = False
    .PreserveFormatting = True
    .RefreshOnFileOpen = False
    .RefreshStyle = xlInsertDeleteCells
    .SavePassword = False
    .SaveData = True
    .AdjustColumnWidth = True
    .RefreshPeriod = 0
    .TextFilePromptOnRefresh = False
    .TextFilePlatform = 437
    .TextFileStartRow = 1
    .TextFileParseType = xlDelimited
    .TextFileTextQualifier = xlTextQualifierDoubleQuote
    .TextFileConsecutiveDelimiter = False
    .TextFileTabDelimiter = True
    .TextFileSemicolonDelimiter = True
    .TextFileCommaDelimiter = False
    .TextFileSpaceDelimiter = False
    .TextFileColumnDataTypes = Array(1, 1, 1)
    .TextFileTrailingMinusNumbers = True
    .Refresh BackgroundQuery:=False
    End With
    End Sub 
```

# javascript - JavaScript：直接代码与 CPS 样式生成的代码性能比较

> ID：12117412
> 
> 赞同：2
> 
> 时间：2012-08-24T22:24:50.180
> 
> 标签：javascript, node.js, continuation-passing

在我的应用程序中，我正在生成遵循 CPS 样式的 JavaScript 代码。我“不”使用任何“延续”。没有异步行为，没有暂停和恢复，没有回调。

只是代码遵循了一种[延续传递](http://en.wikipedia.org/wiki/Continuation-passing_style)的编程风格。

功能有许多阶段，每个阶段都进行处理并将结果传递给其延续。

我发现 CPS 样式代码的性能很差。以直接样式编写的代码几乎比 CPS 样式代码快 150 倍。

请检查以下代码。
下面的两个代码都等价于

```
var res = data.store.bookshelf.book.author; 
```

**直接样式代码：**

```
var data = { store : { bookshelf : {book : {author:"Douglas Crockford"}}}};
var t1 = new Date().getTime();
for(var i = 0; i < 1000*1000*100; i+=1){      
  var temp0 = data;
  var temp1 = temp0.store;
  var temp2 = temp1.bookshelf;
  var temp3 = temp2.book;
  var temp4 = temp3.author;
  var res = temp4;
}
var t2 = new Date().getTime();
console.log(t2-t1); 
```

上面的代码运行了将近 95 毫秒。

**CPS 样式代码：**

```
var data = { store : { bookshelf : {book : {author:"Douglas Crockford"}}}};

// return the variable to the continuation
function cps_VARREF(x,f){
  return f(x);
}
// get the value of the property from the variable and pass it to the continuation
function cps_CHILD(x,child,f){
  return f(x[child]);
}
// simply return the input value, essentially closing the continuation chain
function ret_(x){
  return x;
}

var t1 = new Date().getTime();
for(var i = 0; i < 1000*1000*100; i+=1){
 var res = function(c_){
    return cps_VARREF(data,function(x1){
    return cps_CHILD(x1,"store",function(x2){
    return cps_CHILD(x2,"bookshelf",function(x3){
    return cps_CHILD(x3,"book",function(x4){
    return cps_CHILD(x4,"author",c_);});});});});}(ret_);
}
var t2 = new Date().getTime();
console.log(t2-t1); 
```

上述 CPS 风格的代码运行时间为 15000 毫秒

我能做些什么来改进 CPS 风格的代码吗？或者 JavaScript 天生不适合 CPS 样式的代码？

以上测试是在node.js 0.6.12版本上完成的

有人可以对这个问题有所了解吗？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:35:21.073

急剧放缓至少有两个潜在原因。首先是您正在用动态查找替换“本机”属性查找。

V8 尽可能优化对象，因此访问属性更快。它不是使用哈希表按名称查找属性，而是跟踪内部“类”，以便它可以从已知地址查找属性。所以`data.store`只是一个快速的指针比较，以确保对象是预期的类型和索引指针加载。

但是在`cps_CHILD`函数中，它不能进行优化，因为它不知道将要提前访问什么属性（并且每次调用它都会改变）。动态查找强制 V8 回退到哈希表查找，这比优化的静态查找要慢。

另一个问题是函数调用的开销。每次将嵌套函数传递给下一个函数时，都必须重新创建每个嵌套函数。它们不应该每次都编译，但仍然需要在新的上下文中创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T23:10:03.417

你应该知道有些东西是在运行时解析的，比如你在循环中输入的那些匿名函数。在每个新的“i”上，将再次创建新的“构造函数”及其每个匿名函数的原型。这就是为什么它更慢。这是新的测试。尝试为每个匿名函数定义实际函数，将它们嵌套在循环之外，它应该可以提高程序的性能。

这是代码，它与您的 CPS 样式代码一样深入，但仅在定义函数后

```
var data = { store : { bookshelf : {book : {author:"Douglas Crockford"}}}};

function getValueFrom(data){
    return data;
}

function getAuthorFrom(data){
    return getValueFrom(data);
}

function getBookFrom(data){
    return getAuthorFrom(data["book"]);
}

function getBookShelfFrom(data){
    return getBookFrom(data["bookshelf"]);
}

function getStoreFrom(data){
    return getBookShelfFrom(data["store"]);
}

function getAuthor(data){
    return getAuthor(data);
}

var t1 = new Date().getTime();
for(var i = 0; i < 1000*1000*100; i+=1){
 var res = getStoreFrom(data);
}
var t2 = new Date().getTime();
console.log(t2-t1); 
```

它的运行速度提高了 4-5 倍。由于 JS 引擎需要寻找函数原型，因此速度仍然较慢，因此可以将其放在堆上执行。在第一种情况下（非 CSP 样式），当您使用点访问属性 JS 引擎时，仅通过键（JS 对象属性）查询哈希以获取其值。它工作得更快，因为它只需要处理内存引用。

# java - 如何将相同的侦听器添加到 NetBeans GUI Builder 中的多个组件

> ID：12117414
> 
> 赞同：1
> 
> 时间：2012-08-24T22:24:54.170
> 
> 标签：java, user-interface, netbeans

我正在使用 NetBeans GUI Builder 创建一个小型应用程序。首先，我只想说我可以手动编写所有代码并立即解决这个问题。但是，我想学习如何使用 GUI Builder。这是我的警告，所有不使用它的建议都会被否决。

话虽如此，我目前的情况是，`JFormattedTextField`如果用户输入的数据格式无效，我想在其中显示一条错误消息。在每种情况下，逻辑都是相同的。唯一的区别是根据预期的确切格式（即四位数年份、正整数等）显示不同的错误消息。我想简单地编写一个可以重复用于每个文本字段的侦听器。我为第一个文本框编写了以下方法：

```
private void formattedTextFieldFocustLost(java.awt.event.FocusEvent evt) {
    JFormattedTextField source = (JFormattedTextField)evt.getComponent();

    if (!source.isEditValid()) {
        // TODO: Need a better error message.
        JOptionPane.showMessageDialog(this, "Invalid input.", "Input Error", JOptionPane.ERROR_MESSAGE);
        source.requestFocusInWindow();
    }
} 
```

方法签名由 NetBeans 生成，并从扩展的匿名内部类的生成中调用`FocusAdapter`。现在，当我转到 NetBeans 中的“设计”视图并单击`focusLost`另一个组件事件的组合框时，该方法名称不会出现。

我还尝试创建一个扩展的命名内部类`FocusAdapter`。这也不会出现在事件处理程序组合框中。

我该怎么做才能为我的所有文本字段创建一个方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-18T04:48:02.500

如果您已经编写了处理程序，例如 btnActionPerformed，请复制名称。

在设计视图中，右键单击要附加处理程序的组件 > 属性 > 事件 > “...”按钮 > 添加 > 将现有处理程序名称粘贴到空白字段中，然后单击确定。

（网豆 7.3.1）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:27:14.597

创建自己的方法，例如 validate()：

```
private void validate(JFormattedTextField source) {
    if (!source.isEditValid()) {
        // TODO: Need a better error message.
        JOptionPane.showMessageDialog(this, "Invalid input.", "Input Error", JOptionPane.ERROR_MESSAGE);
        source.requestFocusInWindow();
    }
} 
```

然后从您通过 GUI 编辑器定义的各个侦听器调用此方法：

```
private void formattedTextFieldFocustLost(java.awt.event.FocusEvent evt) {
    JFormattedTextField source = (JFormattedTextField)evt.getComponent();
    validate(source);
} 
```

# java - 纹理仅显示在 Java 的第一行

> ID：12117415
> 
> 赞同：0
> 
> 时间：2012-08-24T22:24:55.927
> 
> 标签：java, eclipse

我正在尝试使用 Java，我有一个游戏读取的保存文件，其组成如下；![在此处输入图像描述](../Images/95bc7c8f4483dadb27647b3e2be5baf8.png)

0 是草纹理（这有效），但是当我将 0 更改为 1 以将草更改为石头时，它在第一个之后不起作用，就像我可以将它们更改为 1 一样，它可以正常工作，但其余部分不行。我坐了一会儿，试图找出问题所在，但找不到。我会更新更多信息。

处理块类型的代码是这样的；

```
public class Value {
    public static int groundGrass = 0;
    public static int groundRoad = 1;

    public static int airAir = -1;
} 
```

这处理文件保存；

```
import java.io.*;
import java.util.*;

public class Save {
    public void loadSave(File loadPath){
        try{
            Scanner loadScanner = new Scanner(loadPath);

            while(loadScanner.hasNext()){
                for(int y=0;y<Screen.room.block.length;y++){
                    for(int x=0;x<Screen.room.block[0].length;x++){
                        Screen.room.block[y][x].groundID = loadScanner.nextInt();
                    }
                }

                for(int y=0;y<Screen.room.block.length;y++){
                    for(int x=0;x<Screen.room.block[0].length;x++){
                        Screen.room.block[y][x].airID = loadScanner.nextInt();
                    }
                }
            }

            loadScanner.close();
        } catch(Exception e) { }
    }
} 
```

这处理不同的块类型；

```
import java.awt.*;

public class Block extends Rectangle{
    public int groundID;
    public int airID;

    public Block(int x, int y, int width, int height, int groundID, int airID){
        setBounds(x, y, width, height);
        this.groundID = groundID;
        this.airID = airID;
    }

    public void draw(Graphics g){
        g.drawImage(Screen.tileset_ground[groundID], x, y, width, height, null);

        if(airID !=Value.airAir){
            g.drawImage(Screen.tileset_ground[airID], x, y, width, height, null);
        }
    }
} 
```

这应该是重要的部分。

我添加了 e.printStackTrace(); （在正确的地方？）

并在控制台中得到了这个；

```
java.lang.NullPointerException
    at com.humans.vs.technology.Save.loadSave(Save.java:14)
    at com.humans.vs.technology.Screen.define(Screen.java:39)
    at com.humans.vs.technology.Screen.paintComponent(Screen.java:47)
    at javax.swing.JComponent.paint(Unknown Source)
    at javax.swing.JComponent.paintChildren(Unknown Source)
    at javax.swing.JComponent.paint(Unknown Source)
    at javax.swing.JComponent.paintChildren(Unknown Source)
    at javax.swing.JComponent.paint(Unknown Source)
    at javax.swing.JLayeredPane.paint(Unknown Source)
    at javax.swing.JComponent.paintChildren(Unknown Source)
    at javax.swing.JComponent.paintToOffscreen(Unknown Source)
    at javax.swing.RepaintManager$PaintManager.paintDoubleBuffered(Unknown Source)
    at javax.swing.RepaintManager$PaintManager.paint(Unknown Source)
    at javax.swing.RepaintManager.paint(Unknown Source)
    at javax.swing.JComponent.paint(Unknown Source)
    at java.awt.GraphicsCallback$PaintCallback.run(Unknown Source)
    at sun.awt.SunGraphicsCallback.runOneComponent(Unknown Source)
    at sun.awt.SunGraphicsCallback.runComponents(Unknown Source)
    at java.awt.Container.paint(Unknown Source)
    at java.awt.Window.paint(Unknown Source)
    at javax.swing.RepaintManager.paintDirtyRegions(Unknown Source)
    at javax.swing.RepaintManager.paintDirtyRegions(Unknown Source)
    at javax.swing.RepaintManager.prePaintDirtyRegions(Unknown Source)
    at javax.swing.RepaintManager.access$700(Unknown Source)
    at javax.swing.RepaintManager$ProcessingRunnable.run(Unknown Source)
    at java.awt.event.InvocationEvent.dispatch(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$000(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source) 
```

如果有帮助，请下载完整代码 - [https://dl.dropbox.com/u/3531994/HvsT.zip](https://dl.dropbox.com/u/3531994/HvsT.zip)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:13:28.687

添加`e.printStackTrace`到 中的异常处理程序`loadSave`，它产生以下输出：

> ```
> java.lang.NullPointerException
>           at com.humans.vs.technology.Save.loadSave(Save.java:14)
>           at com.humans.vs.technology.Screen.define(Screen.java:39)
>           at com.humans.vs.technology.Screen.paintComponent(Screen.java:47)
>           ... 
> ```

有问题的行是：

```
Screen.room.block[y][x].groundID = loadScanner.nextInt(); 
```

由于我们知道`loadScanner`之前没有`null`并且`null`之前没有（因为它在上面几行清楚地初始化，并且**前 8 个地砖正确加载**），我们认为异常可能是从`Scene.room.block[y][x].groundID`.

我们可以使用与我们过去作为候选人排除相同的逻辑来排除`Screen.room`和`Screen.room.block`排除参考。看来有些是。搜索 的初始化，我们发现，如下所示。`null``loadScanner``block[y][x]``null``Room.block``Room.define`

```
public void define(){
    block = new Block[worldHeight][worldWidth];

    for(int y=0;y<block.length;y++){
        for(int x=0;x<block.length;x++){
            block[y][x] = new Block((Screen.myWidth/2) - ((worldWidth * blockSize)/2) + (x * blockSize), y * blockSize, blockSize, blockSize, Value.groundGrass, Value.airAir);
        }
    }
} 
```

我希望你注意到，你的循环覆盖`x`,`y`在区间*[0, `block.length`]* ; `block.length`对应`worldHeight`，问题就清楚了：**这个循环只初始化了block的前8x8**。一旦我们尝试读取`Screen.room.block[y][x].groundID`块 @ 0, 8，我们发现它是默认值，`null`. A`NullPointerException`被抛出，它被您的异常处理程序捕获，并且保存文件的其余部分未被读取。初始化的 8x8 部分`blocks`保留**为**`groundID`默认值，`0`对应于草：

> ```
>  public static int groundGrass = 0; 
> ```

起初，我怀疑这也会导致房间第一行仅前 8 个块的未完成渲染，因为循环`Room.draw`调用`block[y][x].draw(g)`......但是，您的循环条件在这里也同样被破坏。

* * *

现在，解决方案很简单。`Room.define`更正and中的循环条件`Room.draw`，例如

```
 for(int y=0;y<worldHeight;y++){
        for(int x=0;x<worldWidth;x++){
            block[y][x] = new Block((Screen.myWidth/2) - ((worldWidth * blockSize)/2) + (x * blockSize), y * blockSize, blockSize, blockSize, Value.groundGrass, Value.airAir);
        }
    } 
```

对于`Room.define`，以及以下对于`Room.draw`。

```
 for(int y=0;y<worldHeight;y++){
        for(int x=0;x<worldWidth;x++){
            block[y][x].draw(g);
        }
    } 
```

您的代码现在生成以下内容： [http](http://puu.sh/YvAJ) ://puu.sh/YvAJ 不客气 :-)

# java - 键盘在 ubuntu 的 eclipse ide 中无法正常工作

> ID：12117419
> 
> 赞同：1
> 
> 时间：2012-08-24T22:25:49.817
> 
> 标签：java, eclipse, ubuntu

我不知道为什么我的 juno (eclipse 4.2) IDE 开始表现得很奇怪。按下 file2 中的删除按钮会删除 file1 中的内容。我试图恢复所有设置和键绑定，但它的行为仍然相同。如果有人遇到此问题并解决了它，请帮助我。

```
-startup
plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar
--launcher.library
plugins/org.eclipse.equinox.launcher.gtk.linux.x86_64_1.1.200.v20120522-1813
-product
org.eclipse.epp.package.rcp.product
--launcher.defaultAction
openFile
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256m
--launcher.defaultAction
openFile
-vmargs
-Djava.net.preferIPv4Stack=true
-Dosgi.requiredJavaVersion=1.5
-Dhelp.lucene.tokenizer=standard
-XX:MaxPermSize=256m
-Xms1024m
-Xmx2046m
-XX:-UseParallelGC 
-XX:+AggressiveOpts 
-XX:-UseConcMarkSweepGC 
-XX:+UseFastAccessorMethods 
```

从日志文件中添加错误：

```
!MESSAGE A conflict occurred for ALT+SHIFT+D R:
Binding(ALT+SHIFT+D R,
    ParameterizedCommand(Command(org.eclipse.rap.ui.launch.RAPLaunchShortcut.debug,Debug RAP Application,
        Debug RAP Application,
        Category(org.eclipse.debug.ui.category.run,Run/Debug,Run/Debug command category,true),
        org.eclipse.ui.internal.MakeHandlersGo@655538e5,
        ,,true),null),
    org.eclipse.ui.defaultAcceleratorConfiguration,
    org.eclipse.ui.contexts.window,,,system)
Binding(ALT+SHIFT+D R,
    ParameterizedCommand(Command(org.eclipse.wst.server.launchShortcut.debug,Debug on Server,
        Debug the current selection on a server,
        Category(org.eclipse.debug.ui.category.run,Run/Debug,Run/Debug command category,true),
        org.eclipse.ui.internal.MakeHandlersGo@3e0a765c,
        ,,true),null),
    org.eclipse.ui.defaultAcceleratorConfiguration,
    org.eclipse.ui.contexts.window,,,system)
!SUBENTRY 1 org.eclipse.jface 2 0 2012-08-27 09:51:34.156
!MESSAGE A conflict occurred for ALT+SHIFT+X R:
Binding(ALT+SHIFT+X R,
    ParameterizedCommand(Command(org.eclipse.rap.ui.launch.RAPLaunchShortcut.run,Run RAP Application,
        Run RAP Application,
        Category(org.eclipse.debug.ui.category.run,Run/Debug,Run/Debug command category,true),
        org.eclipse.ui.internal.MakeHandlersGo@20e0b1d6,
        ,,true),null),
    org.eclipse.ui.defaultAcceleratorConfiguration,
    org.eclipse.ui.contexts.window,,,system)
Binding(ALT+SHIFT+X R,
    ParameterizedCommand(Command(org.eclipse.wst.server.launchShortcut.run,Run on Server,
        Run the current selection on a server,
        Category(org.eclipse.debug.ui.category.run,Run/Debug,Run/Debug command category,true),
        org.eclipse.ui.internal.MakeHandlersGo@7fbb6976,
        ,,true),null),
    org.eclipse.ui.defaultAcceleratorConfiguration,
    org.eclipse.ui.contexts.window,,,system) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:15:13.880

老实说，我不知道如何解决这个问题，但我不会因为这类问题而浪费时间，并且：

*   创建新工作区
*   安装您喜欢的插件
*   导入现有项目/重新创建它们

我认为那里存在真正的挑战，您的时间值得合理利用。

否则，您可能会陷入无法使用的 IDE 的恼人行为中

对我来说，大多数时候，当我遇到太多麻烦时，没有其他人面临这种​​方法（可能是最后的选择）有效:)

# node.js - 如何在zombie.js中使用browser.wait()？

> ID：12117423
> 
> 赞同：16
> 
> 时间：2012-08-24T22:26:09.843
> 
> 标签：node.js, zombie.js

我有一个 Web 应用程序，它使用 Ajax 请求不断地从服务器轮询数据。我想使用[zombie.js](http://zombie.labnotes.org/)对其进行集成测试。

我要做的是等到 Ajax 轮询循环从服务器接收到数据。数据应该在 20 秒后收到，所以我`browser.wait(done, callback)`用来检查数据是否存在，并将`waitFor`最大超时设置为一分钟。

然而，`browser.wait()`总是几乎立即返回，即使我的`done`回调返回 false。

在[僵尸 API 文档](http://zombie.labnotes.org/API)中，我阅读了以下内容`browser.wait()`：

> ...它不能永远等待，尤其是对于可能重复触发的计时器（例如检查页面状态、长轮询）。

我想这就是我看到的行为的原因，但我真的不明白发生了什么。为什么我不能等待一分钟，直到我的轮询循环从服务器接收到数据？为什么不能`browser.wait()`等待可能重复触发的计时器？我需要做什么来实施我的测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T20:36:45.600

Zombie.js 默认会等到页面上的所有脚本都已加载并执行（如果它们正在等待文档准备好）。

如果我理解正确，您的脚本将在文档准备好 20 秒后才会执行。在这种情况下，Zombie 有一个函数可以让您在浏览器的上下文中评估 javascript，因此如果它在计时器上，您可以更快地启动您的 ajax 代码，并且您不想等待它。

看着[`browser.evaluate(expr)`](http://zombie.labnotes.org/API)

另一种选择是简单地使用正常的 JavaScript 超时等待 20 秒，然后查看 DOM 以了解您期望的更改。

```
setTimeout(function(){
  browser.document.query("#interestingElement")
}, 20*1000); 
```

# php - PHP If 条件与 XML

> ID：12117424
> 
> 赞同：0
> 
> 时间：2012-08-24T22:26:22.360
> 
> 标签：php, xml, if-statement

我正在尝试构建一个 PHP if 表达式。

在英语中，这是 IF 为真的条件：

能见度 < 5000m

或者

BKN/OVC < 1500 英尺

现在，我必须使用的变量是：

对于可见性：$visibility 和对于 BKN/OVC：它有点复杂。

该数据在

```
$xml->data->METAR[0]->sky_condition 
```

数据本身是从 XML 文件中提取的，相关信息如下所示：

```
<sky_condition sky_cover="BKN" cloud_base_ft_agl="600"/>
<sky_condition sky_cover="SCT" cloud_base_ft_agl="1100"/> 
```

关于如何通过 sky_condition->sky_cover 整理相关信息并将其提供给 IF 的任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:40:56.870

您可以使用数组语法而不是箭头运算符来访问 XML 的属性。

```
if((string)$xml->data->METAR[0]->sky_condition[0]['sky_cover']==='???') {

} 
```

这是你的问题吗？

# android - Android - Sencha Touch 2 PhoneGap 4.0.x 问题

> ID：12117428
> 
> 赞同：61
> 
> 时间：2012-08-24T22:27:04.650
> 
> 标签：android, caching, cordova, chromium, web-based

我有一个 Android HTC Amaze 和一个 Android HTC Desire。我的由 PhoneGap 包装的 Sencha Touch 2 应用程序非常适合 Desire，但它们拒绝在 HTC Amaze 4.0.3 上加载。我在日志中收到这种错误-

```
08-24 17:08:37.577: E/chromium(16106): external/chromium/net/disk_cache/stat_hub.cc:190: [0824/170837:ERROR:stat_hub.cc(190)] StatHub::Init - App "appname" isn't supported. 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-03-07T02:05:16.327

尝试将科尔多瓦版本更新为最新版本。

```
cordova -v
npm install -g cordova 
```

当前最新的科尔多瓦版本是 8.x。请检查安装了哪些cordova插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-29T05:06:06.477

PhoneGap 在为生产构建编译时会出错。而不是 PhoneGap 使用 IONIC 框架，它在后台运行不同的 PhoneGap 库但不返回此类错误。

[https://ionicframework.com/](https://ionicframework.com/)

如果您的应用程序在 javascript 中，请使用 IONIC 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-11T10:43:22.150

**如果您在应用程序中使用 WebView 机制**，请尝试更改为[Crosswalk](https://crosswalk-project.org/blog/what-is-crosswalk.html)。
在我的情况下，用[人行横道](https://crosswalk-project.org/documentation/cordova.html)**替换**与**android.webkit.WebView**的交互解决了这个问题。

我真的不明白为什么，但 Crosswalk 以“*跨所有设备的统一运行时而闻名，因此您不必处理运行不同版本操作系统的不同设备上的运行时差异。* ”

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-11-19T13:01:59.943

尝试更新您的云构建并在您的 Android 4.0 上重新安装它。

似乎需要重新安装才能让 Android 操作系统注意到新的权限。

# java - 用安卓模拟器测试触摸屏？

> ID：12117430
> 
> 赞同：0
> 
> 时间：2012-08-24T22:27:27.897
> 
> 标签：java, android, android-emulator, touchscreen

是否可以使用 Android Emulator 模拟或测试触摸屏输入？

我正在做一个需要支持触摸屏输入的项目，但我自己没有安卓手机。但是，如果我可以使用鼠标在我的应用程序中模拟/测试触摸屏支持，那将是完美的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:30:12.077

是的，您可以实现 OnTouchListener，然后在模拟器上使用鼠标。

这里有一个小教程

[http://www.mybringback.com/tutorial-series/3279/android-the-basics-32-androids-ontouchlistener-and-motionevent/](http://www.mybringback.com/tutorial-series/3279/android-the-basics-32-androids-ontouchlistener-and-motionevent/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:48:53.647

理论上是可以的。但迄今为止，多点触控支持需要真正的 Android 4.0 设备才能将多点触控输入发送到模拟器。但是，在这种情况下，您不需要模拟器，可以直接在物理设备上进行测试。

[您可以在此处](http://tools.android.com/tips/hardware-emulation)阅读有关多点触控支持的最新信息。

# c# - 这是否适合类或结构（速度比内存更重要）？

> ID：12117433
> 
> 赞同：3
> 
> 时间：2012-08-24T22:28:10.577
> 
> 标签：c#, .net, class, struct

通常，我永远不必问自己给定的场景是否更适合结构或类，坦率地说，在这种情况下，我在上课之前没有问过这个问题。现在我正在优化，事情变得有点混乱。

我正在编写一个数字处理应用程序，该应用程序处理包含数百万个 Base10 数字的极大数字。这些数字是 2D 空间中的 (x,y) 坐标。`Cell`主要算法是非常连续的，并且在任何给定时间，内存中的类实例（如下所列）不超过 200 个。该类的每个实例占用大约 5MB 的内存，导致应用程序的总峰值内存不超过 1GB。成品将在 16 核机器上运行，具有 20GB 的 RAM，并且没有其他应用程序占用资源。

这是课程：

```
// Inheritance is convenient but not absolutely necessary here.
public sealed class Cell: CellBase
{
    // Will contain numbers with millions of digits (512KB on average).
    public System.Numerics.BigInteger X = 0;
    // Will contain numbers with millions of digits (512KB on average).
    public System.Numerics.BigInteger Y = 0;

    public double XLogD = 0D;
    // Size of the array is roughly Base2Log(this.X).
    public byte [] XBytes = null;

    public double YLogD = 0D;
    // Size of the array is roughly Base2Log(this.Y).
    public byte [] YBytes = null;

    // Tons of other properties for scientific calculations on X and Y.
    // NOTE: 90% of the other fields and properties are structs (similar to BigInteger).

    public Cell (System.Numerics.BigInteger x, System.Numerics.BigInteger y)
    {
        this.X = x;
        this.XLogD = System.Numerics.BigInteger.Log(x, 2);
        this.XBytes = x.ToByteArray();

        this.Y = y;
        this.YLogD = System.Numerics.BigInteger.Log(y, 2);
        this.YBytes = y.ToByteArray();
    }
} 
```

我选择使用类而不是结构只是因为它“感觉”更自然。字段、方法和内存的数量都本能地指向类而不是结构。我进一步证明，通过考虑临时分配调用会有多少开销，因为底层的主对象是 BigInteger 的实例，它本身就是一个结构。

问题是，考虑到速度效率是这种情况下的最终目标，我是否明智地选择了这里？

这里有一些关于算法的信息，以防万一。在每次迭代中：

1.  对所有 200 个实例执行一次排序。20% 的执行时间。
2.  计算感兴趣的相邻 (x,y) 坐标。60% 的执行时间。
3.  上述第 2 点的并行/线程开销。10% 的执行时间。
4.  分支开销。10% 的执行时间。
5.  最昂贵的函数：BigInteger.ToByteArray() [（实现）](https://stackoverflow.com/a/11819552/938668)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T22:34:30.140

由于许多原因，这将更适合作为一个班级，包括

*   它在逻辑上不代表单个值
*   它大于 16 个字节
*   它是可变的

有关详细信息，请参阅[在类和结构之间进行选择](http://msdn.microsoft.com/en-us/library/ms229017%28v=vs.100%29.aspx)。

此外，我还建议它更适合给定的课程：

*   它包含引用类型（数组）。包含类的结构很少是一个好的设计理念。

但是，鉴于您正在做的事情，这一点尤其正确。如果要使用 a `struct`，排序将需要整个结构的副本，而不仅仅是引用的副本。方法调用（除非通过 ref 传递）也会产生巨大的开销，因为您将复制所有数据。

集合中项目的并行化也可能会产生巨大的开销，因为对结构的任何数组的边界检查（即：如果它保存在 a`List<Cell>`或类似中）会导致错误的错误共享，因为对列表的所有访问都会访问内存在列表的开头。

我建议将其保留为一个类，此外，我建议尝试将字段移动到属性中，并使该类尽可能不可变。这将有助于保持您的设计简洁，并且在多线程时不太可能出现问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T22:34:49.313

根据您编写的内容很难判断（`Cell`例如，我们不知道您最终复制类型值的频率），但我*强烈*希望 a`class`在这里是正确的方法。

*类中的方法*数量无关紧要，但如果它有很多字段，则需要考虑在将值传递给另一个方法（等）时复制所有这些字段的影响。

从根本上说，它不像*是*一种价值类型——但我知道，如果性能特别重要，那么哲学方面对你来说可能就不那么有趣了。

所以是的，我认为你做出了正确的决定，我认为目前没有理由相信其他任何事情 - 但当然，如果你可以轻松地改变决定并将其作为结构*进行测试*，那将比猜测要好。性能非常难以准确预测。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T22:34:07.807

由于您的类确实包含消耗大部分内存的数组，并且您只有 200 个单元实例围绕类本身的内存消耗不是问题。你说得对，一门课感觉更自然，这确实是正确的选择。我的猜测是 XByte[] 和 XYBytes[] 的比较确实限制了您的排序时间。这完全取决于您的数组有多大以及您如何执行比较。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T23:29:01.617

让我们开始忽略性能问题，并努力解决它们。

结构是值类型，值类型是值类型。Integer's 和`DateTime`'s 是值类型和很好的比较。谈论一个人与另一个人的相同或`1`不同`1`，或者一个人`2010-02-03T12:45:23.321Z`与另一个人的相同或不同是没有意义的`2010-02-03T12:45:23.321Z`。它们在不同的用途中可能具有不同的意义，但是 1 == 1 和 1 != 2 以及 2010-02-03T12:45:23.321Z == 2010-02-03T12:45:23.321Z 和 2010-02-03T12 :45:23.321Z != 2931-03-05T09:21:29.43Z 是整数和日期时间的本质所固有的，这就是使它们成为值类型的原因。

这是最纯粹的思考方式。如果它与上面的匹配，它是一个值类型，如果它不匹配，它是一个引用类型。没有其他东西进入它。

扩展 1：如果一个 X 可以有一个 X，那么它必须是一个引用类型。这是否从上面所说的逻辑上得出是有争议的，但是无论您对此事有何看法，在实践中，您都不能拥有一个结构，该结构具有自身的另一个实例作为成员（直接或间接），就是这样。

扩展2：有人说可变结构带来的困难来自上述，而有些人则不然。不过，无论您对此事有何看法，都存在实际困难。可变结构在少数情况下可能很有用，但它们会引起足够的混乱，以至于它们应该被限制在私有情况下作为优化，而不是作为理所当然的公共情况。

**性能位来了...**

值类型和引用类型在不同情况下具有不同的特性，它们会影响速度、内存使用以及内存使用对垃圾收集的影响方式，这些方式在性能方面各有不同的优缺点。我们对此付出了多少关注，取决于我们需要多少才能达到那个水平。现在值得说的是，如果您遵循上述关于在 struct 和 class 之间做出决定的规则，那么它们的不同方式往往会取得平衡，因此如果我们开始考虑这一点，那么我们至少接近于优化领域。

优化级别 1。

如果一个值类型实例每个实例包含超过 16 个字节，则可能应该将其作为一个引用。这有时甚至被称为“自然”差异，而不是优化之一。严格来说，“值类型”中没有任何内容需要“16 个或更少字节”，但它确实倾向于以这种方式平衡。

远离简单的“16 字节”规则，它越小复制速度越快，反之亦然，因此为 20 字节实例弯曲它比为 200 字节实例弯曲它的影响更小。

您需要大量装箱和拆箱吗？自从引入泛型以来，我们已经能够避免很多使用 1.0 和 1.1 装箱和拆箱的情况，所以这不像以前那么重要，但如果这样做会损害性能。

优化级别 2。

事实上，值类型可以放置在堆栈上，直接放置在数组中（而不是引用它们）并且是结构或类的直接字段（再次，而不是引用它们）可以访问它们及其领域更快。

如果您要创建它们的数组，**并且**如果全零值对您来说是一个有用的起点，那么您会立即得到它，而对于引用类型，您会得到一个空数组。这可以使结构更快。

**编辑：**从上面延伸出来的东西，如果你要快速迭代数组，那么除了直接访问提供了比参考更重要的提升之外，你将加载几个实例到 CPU 缓存中时间（当前 x86-32 或 x86-64/amd 上 64 字节，ia-64 上 128 字节）。它必须是一个非常紧密的循环，但在某些情况下确实如此。

几乎大多数“我选择 struct 而不是 class 以获得性能”归结为第一点，或者第一点与第二点相结合。

优化级别 3。

如果您遇到的情况是您关心的某些值彼此重复，并且它们的大小很大，那么对于不可变实例（或一旦开始执行以下操作就永远不会改变的可变实例），您可以故意别名不同的引用，以便您节省大量内存，因为您的例如 20 个 2kiB 大小的重复对象实际上是同一个对象，因此在这种情况下节省 26kiB。它还可以使比较更快，因为您可以在身份上捷径的情况更加频繁。这只能通过引用类型来完成。

优化级别 4。

具有数组的结构虽然对包含的数组起别名，但可以在内部使用上述技术，平衡这一点，尽管它涉及更多。

优化级别 X。

如果实际测量结果会得出不同的结果，那么对这些利弊的思考多少会得出一个特定的答案，这并不重要。由于有利有弊，因此总是有可能出错。

在考虑 1 到 4 时，除了这些优化问题之外，除了值类型和引用类型之间的差异之外，我认为您应该选择一个类。

如果您的实际测试证明我错了，那么在考虑 XI 级时不会感到惊讶。最好的一点是，如果从 class 更改为 struct 很困难（您大量使用别名或 null 值的可能性），那么您可以确信这样做是失败的。如果它不费力，那么你可以这样做并测量！我强烈建议测量一个涉及实际运行 10,000 次的测试 - 如果您在实际中多执行 20 次不同的操作，谁会在乎您是否可以在几秒钟内执行给定的操作 10,000 次？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-25T22:34:46.513

一个结构只能在以下情况下安全地包含一个数组类型字段：（1）结构的状态取决于数组的标识而不是它的内容（就像 的情况一样`ArraySegment`），或者（2）没有对数组的引用永远被任何可能试图改变它的东西持有（通常，这意味着数组字段将是私有的，并且结构本身将创建数组并执行将对其进行的所有修改，然后将引用存储在场地）。

我提倡比这里的其他人更普遍地使用结构，但是您的数据存储事物将具有两个数组类型字段这一事实似乎是反对使用结构的有力论据。

# .net - .Net Reg Ex 完全匹配

> ID：12117435
> 
> 赞同：0
> 
> 时间：2012-08-24T22:28:20.583
> 
> 标签：.net, regex

RegEx 让我头疼，谁能帮我解决这个问题？

在 c# 中，我正在调用以下内容并期待正确，我必须承认我在正则表达式方面非常周到。

还简要解释了 ( ) 和 & 之前的 \ 的影响。

```
var isValid = Regex.IsMatch(
     "from=20100101&to=20121231",
     "^(from=)([0-9]{6})\\&to=([0-9]{6})$"
); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:33:49.693

试试这个：

```
^from=(\d{8})&to=(\d{8})$ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T22:33:21.800

这将返回 true

```
var isValid = Regex.IsMatch("from=20100101&to=20121231",@"^from=[0-9]{8}&to=[0-9]{8}$"); 
```

`\`用于转义其他特殊字符。So 是按其字面值处理的，而不是按其在正则表达式语言中的含义处理。例如`\.`，表示匹配一个点，而 a`.`本身是通配符，表示“匹配除 \n 之外的任何单个字符”。

这`(subexpression)`称为分组并捕获与内部子表达式匹配的所有内容并为其分配一个从零开始的序数。可以使用使用此语法分配的序号来引用此匹配`\0`
。参数很广泛并且有很多变化。
你可以从[MSDN 上的这个参考开始](http://msdn.microsoft.com/en-US/library/az24scfc%28v=vs.90%29)

笔记。我已经更正了您的模式，删除了分组、\&（与号不是特殊字符）并将匹配的数字扩展为 8 位数字（如果您的日期仅由 6 位数字组成，那么您可以设置 {6,8} 表示 min 6 , 最多 8 位数字）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T22:34:04.947

您使用 {6} 要求输入 6 个连续数字。但是，您确实在寻找 8，yyyymmdd。

# sql-server - RowNumber() 和 Partition By 性能需要帮助

> ID：12117441
> 
> 赞同：0
> 
> 时间：2012-08-24T22:28:51.923
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-r2, query-performance

我有一张股票市场移动平均值表，我试图在一天内比较两个值，然后将该值与前一天的相同计算值进行比较。我的 sql 如下所示...当我注释掉定义结果集的最后一个 select 语句并运行显示为结果集的最后一个 cte 时，我在大约 15 分钟内取回了我的数据。长，但易于管理，因为它会在一夜之间作为插入 sproc 运行。当我如图所示运行它时，我在任何结果开始出现之前的 40 分钟。有什么想法吗？它从有点慢到爆炸，可能是加上`ROW_NUMBER() OVER (PARTITION BY)`BTW 我仍在处理逻辑，这在这个性能问题上目前是不可能的。提前致谢..

编辑：我按照下面的建议修复了我的分区。

```
with initialSmas as
(
    select TradeDate, Symbol, Period, Value
    from tblDailySMA
),

smaComparisonsByPer as
(
    select i.TradeDate, i.Symbol, i.Period FastPer, i.Value FastVal, 
        i2.Period SlowPer, i2.Value SlowVal, (i.Value-i2.Value) FastMinusSlow
    from initialSmas i join initialSmas as i2 on i.Symbol = i2.Symbol 
        and i.TradeDate = i2.TradeDate and i2.Period > i.Period
),

smaComparisonsByPerPartitioned as
(
    select ROW_NUMBER() OVER (PARTITION BY sma.Symbol, sma.FastPer, sma.SlowPer
    ORDER BY sma.TradeDate) as RowNum, sma.TradeDate, sma.Symbol, sma.FastPer,
    sma.FastVal, sma.SlowPer, sma.SlowVal, sma.FastMinusSlow
    from smaComparisonsByPer sma
)

select scp.TradeDate as LatestDate, scp.FastPer, scp.FastVal, scp.SlowPer, scp.SlowVal,
    scp.FastMinusSlow, scp2.TradeDate as LatestDate, scp2.FastPer, scp2.FastVal, scp2.SlowPer, 
    scp2.SlowVal, scp2.FastMinusSlow, (scp.FastMinusSlow * scp2.FastMinusSlow) as Comparison
from smaComparisonsByPerPartitioned scp join smaComparisonsByPerPartitioned scp2
on scp.Symbol = scp2.Symbol and scp.RowNum = (scp2.RowNum - 1) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T08:26:48.597

1）您在 Partition By 和 Order By 子句中都有一些字段。这是没有意义的，因为每个（sma.FastPer、sma.SlowPer）只有一个值。您可以从窗口函数的 Order By 部分安全地删除这些字段。

2）假设您已经在“initialSmas i join initialSmas”中拥有足够性能的索引，并且您已经拥有和索引（initialSmas.Symbol，initialSmas.Period，initialSmas.TradeDate），您可以做的最好的是将 smaComparisonsByPer 复制到您可以在其中创建索引的临时表 (sma.Symbol, sma.FastPer, sma.SlowPer, sma.TradeDate)

# java - 运行时错误 - 跳过一行用户输入（扫描仪）

> ID：12117448
> 
> 赞同：0
> 
> 时间：2012-08-24T22:29:34.557
> 
> 标签：java, java.util.scanner

在我的测试程序文件中，我试图从用户那里接收 3 个输入，但是只收到了 2 个输入，并且似乎程序正在跳过 in.nextLine() 代码行。这是我的代码：

```
import java.util.Scanner;

public class IngredientTester
{
   public static void main(String[] args) {

        Scanner in = new Scanner(System.in);
        /*These 3 inputs work */
        System.out.println("Please enter Ingredient name.");
        String inputName = in.nextLine();
        System.out.println("Please enter Ingredient measurement type.");
        String inputType = in.nextLine();
        System.out.println("Please enter Ingredient amount");
        double inputAmount = in.nextDouble();

        Ingredient inputIngredient = new Ingredient(inputName,inputType,inputAmount);
        System.out.println(inputIngredient.getName() + "- " + inputIngredient.getAmount() + " " + inputIngredient.getMeasurement());

        System.out.println("Please enter Ingredient name.");
        inputName = in.nextLine();
                /* ^ the input above does not work, but the ones below do work */
        System.out.println("Please enter Ingredient measurement type.");
        inputType = in.nextLine();
        System.out.println("Please enter Ingredient amount");
        inputAmount = in.nextDouble();

        inputIngredient.setAmount(inputAmount); 
        inputIngredient.setName(inputName); 
        inputIngredient.setMeasurement(inputType);
        System.out.println(inputIngredient.getName() + "- " + inputIngredient.getAmount() + " " + inputIngredient.getMeasurement());
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:59:12.747

问题是您正在使用：

```
double inputAmount = in.nextDouble(); 
```

它不仅会读取您的第一个输入金额，还会将回车符传递给下一条`readLine`语句。

解决方法是先消耗回车：

```
double inputAmount = Double.parseDouble(in.nextLine()); 
```

# asp.net - 使用 ASP.NET 和 Visual Studio 2008 的 Web 服务器的 HTTP 动词 POST 到文件夹“不允许”

> ID：12117450
> 
> 赞同：1
> 
> 时间：2012-08-24T22:29:53.467
> 
> 标签：asp.net, visual-studio-2008, post

我的情况类似于 Q 1851155:
[The HTTP verb POST used to access path '/' is not allowed](https://stackoverflow.com/questions/1851155/the-http-verb-post-used-to-access-path-is-not-allowed)
(但那是 IIS 7；我使用的是 VS 2008 的内置 Web 服务器。如果是 IIS 6 或 7 下面引擎盖，我不知道如何配置它。）

我的情况可能类似于 Q 758780:
[The HTTP verb POST used to access path '/Membership/user/' is not allowed](https://stackoverflow.com/questions/758780/the-http-verb-post-used-to-access-path-membership-user-is-not-allowed)
(这表明链接重新配置。但同样，我不知道这与 VS 2008's built -in web 服务器，而不是显式的 IIS 6 或 7 配置。）

我的情况与 Q 5238080 完全不同：
[不允许使用 HTTP 动词 POST 访问路径](https://stackoverflow.com/questions/5238080/the-http-verb-post-used-to-access-path-is-not-allowed)
（我明确使用 POST；该问题与通过 LinkBut​​ton 的间接使用有关，并且似乎不是此路径问题。）

来自 .aspx 页面的有问题的代码片段，位于具有虚拟路径“/”的网站中：

```
    <form id="login" method="post" action="/login/">
    ...
    </form>

```

产生的错误页面：

```
    “/”应用程序中的服务器错误。
    不允许使用用于访问路径“/login/”的 HTTP 动词 POST。
    ...

```

这是在最新的 Windows 7 64 位和 Visual Studio 2008 SP（版本 9.0.30729.1 SP）上，调试时使用 VS 的内置 Web 服务器。

这种情况下会出现错误：
* 当从 VS 2008 开始“开始调试”时，使用路径“/login/”。
该文件夹包含单个文件“Default.aspx”。

以下两种情况正常工作：
* 当从 VS 2008 开始“不调试”时，使用路径“/login/”。
* 当“开始调试”时，使用路径“/login/Default.aspx”。

因此，当我指定文件夹并要求 Web 服务器推断引用是对该文件夹的 Default.aspx 页面时，我遇到了问题。但是，仅在 VS 2008 下调试时才会出现问题。（从 VS 2008 应用程序启动，加载我的 asp.net 网站解决方案。）

问题：
* VS 2008 的内置 Web 服务器实际上是 IIS 6 还是 7？如果是这样，我该如何配置它？
* 如果没有，在指定文件夹而不是文件时，有没有办法告诉 VS 2008 的内置 Web 服务器正常工作？
* 如果没有，是否有可以下载的替代解决方案（我没有更新我的开发人员许可证，因此我目前无法下载 Microsoft 订阅内容）。
* 更新我的许可证并升级到 VS 2010 有帮助吗？如果是这样，我具体需要做什么才能使该解决方案发挥作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:44:26.157

VS 2008 的内置 Web 服务器不是 IIS，它是一个叫做 Cassini 的东西。它的行为肯定是不同的——我们完全停止使用它已经够奇怪了，或者至少在认为它是一个错误之前会在另一个平台上确认任何 HTTP 错误。差异很大，以至于微软创建了[IIS Express](http://learn.iis.net/page.aspx/868/iis-express-overview/)来帮助改进本地开发故事。在浪费任何时间处理 Cassini 上的 HTTP 问题之前，您应该升级到该版本并查看是否可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:36:23.787

据我所知，您只能直接发布到页面。没有办法只发布到一个目录。Web 服务器不够智能，无法知道您打算转到`Index.aspx`或`Default.aspx`。您必须指定页面的完整 URL。

您是否有不想使用完整网址的原因？

# windows - 双启动到 Xen 云平台和 windows

> ID：12117457
> 
> 赞同：-1
> 
> 时间：2012-08-24T22:31:12.193
> 
> 标签：windows, cloud, boot, xen

在我的系统中，我的一个硬盘驱动器上有 Windows，我在另一个硬盘上安装了 Xen 云平台。现在安装完成了，但我不知道如何在重新启动后加载 Xen？在启动菜单中，我没有选择应该加载哪个硬盘的选项！谁能帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T19:23:25.080

现在我按 f2 进入 BIOS，然后关闭上面有 Windows 的硬盘驱动器，然后系统自动启动到 XCP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T16:49:18.383

我不是大师，我还没有尝试过这个（我希望尽快测试类似的设置），但我会尝试给你一些方向......

这家伙在两个驱动器上为两个 Windows 版本进行双重引导，但我认为类似的过程可以用于您的情况：

[http://atagunov.blogspot.hk/2012/04/installing-grub2-without-linux.html](http://atagunov.blogspot.hk/2012/04/installing-grub2-without-linux.html)

基本上，您需要做的是运行 gparted 在其中一个驱动器的开头创建一个 128MB 的小分区，以便您可以将 grub2 引导加载程序安装到该分区。

配置 grub2 以将 xen 和 windows 作为选项列出，使用 grub2 提供的“make-config”脚本创建 grub.cfg 文件。

最后，在启动时按 f2 进入 teh bios abd 更改启动设备顺序，以便第一个选择是安装了 grub2 的那个。

# java - 日历返回错误时间

> ID：12117459
> 
> 赞同：0
> 
> 时间：2012-08-24T22:31:22.893
> 
> 标签：java, android, date, time, calendar

我在我的应用程序中使用日历作为闹钟，但如果我使用日历，timeInMillis 是错误的。
我给你看一个例子：

```
// Get Current Time
Calendar calNow = Calendar.getInstance();
calNow.setTimeInMillis(System.currentTimeMillis());
calNow.add(Calendar.HOUR, calNow.get(Calendar.HOUR_OF_DAY));
calNow.add(Calendar.MINUTE, calNow.get(Calendar.MINUTE));
long now = calNow.getTimeInMillis(); 
```

长`now`返回例如：`1345848049917`
`now`必须与 相同`System.currentTimeMillis()`，但不是，`system`返回`1345846849921`

`now`在我的时区：`25.08.2012 - 00:40:49`
`System.currentTimeMillis()`是：`25.08.2012 - 00:20:49`

整整 20 分钟后，但为什么呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:33:16.727

我不太确定您要做什么，但是这些行

```
calNow.add(Calendar.HOUR, calNow.get(Calendar.HOUR_OF_DAY));
calNow.add(Calendar.MINUTE, calNow.get(Calendar.MINUTE)); 
```

将一天中的小时和分钟翻倍，`00:20:49`变成`00:40:49`.

# java - 如何将我的计算机变成网络服务器并使用使用 Netbeans 创建的 Java webapp

> ID：12117463
> 
> 赞同：0
> 
> 时间：2012-08-24T22:32:00.210
> 
> 标签：java, webserver

我使用 Netbeans 创建了一个 Java Web 应用程序，单击构建后我只有一个 .war 文件，我不知道下一步是什么，我怎样才能成为服务器并允许我的朋友使用这个 .war 文件或应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T22:41:42.173

您需要像[Apache Tomcat](http://tomcat.apache.org/)、[Jetty](http://jetty.codehaus.org/jetty/)或[Glassfish](http://glassfish.java.net/)这样的应用程序服务器来部署您的应用程序。每个都有其优点和缺点，以及不同的配置选项。

一些应用程序服务器可以嵌入到您的应用程序中，也可以单独使用，只需将您的 .war 文件放入其中即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:36:05.740

您可能需要考虑寻找支持 Java EE 的免费 Web 托管服务。这比尝试在您自己的机器上设置安全的 Web 服务器要容易和安全得多。

# mvvm - 选择 RibbonTabItem 时导航到视图。[MVVM,PRISM]

> ID：12117464
> 
> 赞同：0
> 
> 时间：2012-08-24T22:32:01.543
> 
> 标签：mvvm, navigation, prism, ribbon

我每个`Module`人都有一个`RibbonTabItem`。选择功能区选项卡时，我想导航到模块的 MainView。我试图将功能区的 SelectedTabItem 属性绑定到 ShellViewModel 中的一个属性，但是当我单击选项卡时，没有到达该属性。似乎数据绑定不起作用。
- 如果这是一个好方法，我该如何解决这个问题，或者什么是达到这个要求的好方法？

# ruby-on-rails - content_tag 使用 concat 处理多个部分

> ID：12117466
> 
> 赞同：1
> 
> 时间：2012-08-24T22:32:13.707
> 
> 标签：ruby-on-rails, ruby-on-rails-3, helpers

我正在使用 Rails 3。我正在尝试在助手中执行此操作：

```
def headers collection
  collection.each do |col|
     content_tag(:th, col.short_name)
  end
end 
```

如您所见，这个想法是执行 content_tag 来`<th>`为集合中的每个元素生成一个标签。这不起作用，因为 HTML 是由 Rails 提供的安全的，这使得它不能作为 HTML 工作。

如果我将其更改为：

```
def headers collection
  collection.each do |col|
    concat (content_tag(:th, col.short_name))
  end
end 
```

这效果更好。我在 HTML 中得到了正确的标记，但在此之前我得到了所有标记 HTML 安全。所以我认为我很接近。

我知道还有其他方法可以做到这一点，但我想尝试以正确优雅的方式做到这一点。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:43:38.857

您可以使用注入并以 html_safe 空字符串开头。

```
def headers collection
  collection.inject("".html_safe) do |content, col|
    content + (content_tag(:th, col.short_name))
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-25T09:48:53.397

聚会迟到了，但我今天遇到了这个问题并用 解决了它`safe_join`，所以：

```
def headers_collection 
  safe_join(collection.map { |item| content_tag(:th, item.short_name) })
end 
```

# python - 如何将文件传递给具有全局和特定路径的脚本，如果路径不存在则出错？

> ID：12117467
> 
> 赞同：1
> 
> 时间：2012-08-24T22:32:53.027
> 
> 标签：python, glob

我有一个通常需要执行以下两个任务之一的脚本：

1）处理一堆文件，其路径从通配符扩展扩展而来。
2）处理具有明确路径的特定文件。

我一直在使用 glob 来处理通配符扩展，但这引发了一个问题。因为 glob 只返回实际存在的路径，所以如果用户给出了不存在文件的特定路径，则代码不会产生错误。

下面是代码的最小工作示例 (MWE)。MWE 愉快地处理从通配符扩展的现有文件，但不会生成所需的错误消息，因为 glob 只返回现有路径。

```
#!/usr/bin/env python3

import argparse, glob, sys, os

parser = argparse.ArgumentParser()
parser.add_argument("src_path", metavar="path", type=str,
    help="Path to files to be merged; enclose in quotes, accepts * as wildcard for directories or filenames")

args = parser.parse_args()
files = glob.iglob(args.src_path)

for file in files:
    try:    
        with open(file, 'r') as f:
            sys.stdout.write('File exists: ' + file + '\n') 
    except IOError:
        sys.stderr.write('File does not exist: ' + file + '\n') 
```

如何修改它以使其行为符合要求？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T23:46:03.280

如果你想坚持使用 glob.iglob：

```
#!/usr/bin/env python3

import argparse, glob, sys, itertools

parser = argparse.ArgumentParser()
parser.add_argument("src_path", metavar="path", type=str,
    help="Path to files to be merged; enclose in quotes, accepts * as wildcard for directories or filenames")

args = parser.parse_args()
files = glob.iglob(args.src_path)

try:
    first_file = files.next()
except StopIteration:
    print('File does not exist: ' + args.src_path, file=sys.stderr)
    sys.exit(1)
for file in itertools.chain([first_file], files):
    print('File exists: ' + file) 
```

如果 glob.glob 是可以接受的：

```
#!/usr/bin/env python3

import argparse, glob, sys

parser = argparse.ArgumentParser()
parser.add_argument("src_path", metavar="path", type=str,
    help="Path to files to be merged; enclose in quotes, accepts * as wildcard for directories or filenames")

args = parser.parse_args()
files = glob.glob(args.src_path)

if not files:
    print('File does not exist: ' + args.src_path, file=sys.stderr)
for file in files:
    print('File exists: ' + file) 
```

# php - 我怎样才能只允许在一天中的某些时间访问网页？

> ID：12117472
> 
> 赞同：1
> 
> 时间：2012-08-24T22:33:25.787
> 
> 标签：php

我正在创建一个网站，人们可以在其中在线订购外卖。我怎样才能只允许在一天中的某些时间访问网页？例如下午 5 点到 12 点等...

**更新：**

我想出了一个适用于多个答案的解决方案：

```
<?php
    if (date('G')>17) {
        header('Location: /closed.php');
        exit();
    }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:39:00.710

我建议您只需将此检查构建到页面本身中。这样，如果超出时间，您可以返回一个页面，告诉用户在这些特定时间之间返回。这是执行此操作的一种方法：

```
if(date('G') > 17 and date('G') < 24)
    //return the real page -- look into 'header' for redirecting
else
    //return a come back later message 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:47:13.990

我建议尝试这段代码：

```
$time = localtime();
if($time['tm_hour']<17)
{
    echo 'Our business is currently closed, come back later!';
    exit;
} 
```

如果当地时间不在 17:00 和 00:00 之间，脚本将显示一条消息并退出。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-24T22:36:58.247

最简单的方法是使用 .htaccess 文件，该文件将每个页面/文件夹从根目录重定向到根文件夹的 index.php。这样您就可以在 index.php 中放置一个简单的 date() 并检查当前日期是否高于/低于您的限制。

但除此之外，你为什么愿意这样做？看起来对 SEO 很不友好，对用户也不友好。

另外，请确保正确读取时区，我在 +1 中，但其他人可能在 -6 中。这是一个非常大的区别！

# php - 在没有 POST 或 AJAX 的 PHP 中使用 Javascript 对象

> ID：12117480
> 
> 赞同：0
> 
> 时间：2012-08-24T22:34:13.867
> 
> 标签：php, javascript

有没有办法将 JSON 对象直接传递给 PHP 并使用它？

像这样的东西：

```
<script>
 var gridData = {"id":100,"level":"B","Zone":"Entry"}; 
</script>
<?php
echo "Your grid Information is:". [**How to get the gridData displayed here**]
?> 
```

我知道我可以使用 AJAX 传递到后端，获取结果并将其显示在一个 div 中，但是有没有更简单的方法，因为我已经在这个页面中并且我已经有了 Javascript 中的数据？

另请注意：我正在处理一些非常旧的遗留代码，这些代码是我在自定义 JavaScript 平台中通过大量业务逻辑计算继承而来的，所以请耐心等待整个架构有点奇怪:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:44:22.450

**无法**将Javascript 与 PHP 结合使用。

您在这里处理两种完全不同类型的语言：**客户端**和**服务器端**。

**服务器端**语言（如 PHP）在 Web 服务器上执行。它们用于动态生成正在显示的页面。他们所做的一切都在网络服务器上执行。一旦 PHP 脚本完成运行并生成页面，它就会被发送到用户的 Web 浏览器。

**客户端**语言（如 Javascript）在浏览器的本地机器上完全执行。他们对服务器上发生的事情一无所知。他们所知道的只是在静态网页被发送到浏览器后对其 DOM 元素进行操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:36:00.090

不，你不能那样做。

在php*在服务器上完全执行完***之后**， Javascript*在客户端上* 执行。

 **** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T22:39:26.010

你为什么不把它转过来，用 PHP 定义你的 JSON，然后发出 Javascript？所以你可以有这样的东西：

```
<?php
    $json = '{"id":100,"level":"B","Zone":"Entry"}';
?>
<script>
    var gridData = <?php echo $json ?>;
</script>
<?php
    echo "Your grid Information is:". $json
?> 
```***

# javascript - 在 JavaScript 中，是否不赞成使用 '==' 运算符？

> ID：12117487
> 
> 赞同：2
> 
> 时间：2012-08-24T22:34:55.303
> 
> 标签：javascript

> **可能重复：**
> [JavaScript === vs ==：我使用哪个“相等”运算符有关系吗？](https://stackoverflow.com/questions/359494/javascript-vs-does-it-matter-which-equal-operator-i-use)

注意到这一点

> == 不好。永远不要使用它。关于语言的其他一切，你会遇到不同的意见。

...在阅读我在 Hacker News 上找到的一篇文章时：http: [//duruk.net/some-web-development-tips/](http://duruk.net/some-web-development-tips/)

为什么会对此不屑一顾？有哪些替代方案？这有错吗...

```
if (foo == bar) {
    //do something
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T22:38:16.120

一般来说，最好使用`===`and `!==`。这些比较类型和值并且不进行类型转换。

而`==`将对一个进行类型转换以匹配另一个，然后进行比较，因此它可能会报告不完全相同的事物的相等性。

例如：

```
"0" == 0   // true
"0" === 0  // false 
```

# php - 如何删除日期

> ID：12117488
> 
> 赞同：0
> 
> 时间：2012-08-24T22:34:54.803
> 
> 标签：php, regex

我正在制作一个脚本来解析一些报告。在每一页的末尾都有打印日期，格式如下：

```
Printed on Jun 12, 2012 at 10:04 PM 
```

我想删除该文本，但由于我的正则表达式知识非常基础，我不知道如何继续。它还应该涵盖上午/下午。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:39:23.350

```
$text = preg_replace('~Printed on.*?(AM|PM)~', '', $text); 
```

它将删除从“打印在”到上午或下午的所有内容

# regex - Drools 与负前瞻匹配

> ID：12117491
> 
> 赞同：1
> 
> 时间：2012-08-24T22:35:21.967
> 
> 标签：regex, drools

我希望我的条件之一是断言的字符串不在字符串列表中。

我正在使用决策表，在我的条件单元格中我有

```
firstName matches("?!($param)") 
```

在我的参数单元格中

```
Billy|Joe|Bob 
```

出于某种原因，当我有一个像 Sally 这样的名字时，它不符合该规则。如果我从它匹配的参数单元格中删除“Billy|Joe|Bob”。

我可能应该提到我正在使用 drools 3.0.6 我看到提到了在 drools 4 中添加的不匹配但由于我不会进入的原因我无法升级。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:40:07.763

The best solution I've found is to split this into multiple conditions. I wish I could place these all in one condition but to do that I'm pretty sure I'd need to go up to at least drools 4.

```
| firstName!="$param" | firstName!="$param" | firstName!="$param" |
|Billy                |Joe                  |Bob                  | 
```

Note: The use of pipes in the original question was to be treated as an "or" whereas here I'm using pipes to denote cells in the table.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T01:04:47.310

你的前括号不合适。

否定前瞻的语法是：

```
(?!$param) 
```

但是，仅此更改是不够的。您需要锚定正则表达式：

```
^(?!.*$param) 
```

这个正则表达式说“匹配任何*不*包含`$param`”的输入。

因此，使用您的示例，`^(?!.*Billy|Joe|Bob)`将匹配任何不包含的输入`Bill`，`Joe`或`Bob`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T00:41:27.090

否定前瞻与否定表达式完全不同，我认为这就是您要寻找的。

我不太记得 Drools 3，但您可能必须使用 eval 表达式来否定它。所以你的决策表单元格看起来像

```
eval( ! getFirstName().matches("($param)") ) 
```

基本上，您调用的是纯 java 表达式，而不是使用提供的匹配运算符。

# r - 根据另一列替换一列中的 NA 值

> ID：12117500
> 
> 赞同：-1
> 
> 时间：2012-08-24T22:36:29.123
> 
> 标签：r, missing-data

```
 Id         authId          sessionId                         
139 "56763313.wrpy" "4233a31b52f92c6fe8af4f04f2116657"
123 "221156400"     "ae04ddacadaa3429ca77dab674a008bf"
126 "221156400"     "ae04ddacadaa3429ca77dab674a008bf"
144 "221156400"     "ae04ddacadaa3429ca77dab674a008bf"
143 "221156400"     "ae04ddacadaa3429ca77dab674a008bf"
118 NA              "ae04ddacadaa3429ca77dab674a008bf"
121 NA              "ae04ddacadaa3429ca77dab674a008bf"
122 NA              "ae04ddacadaa3429ca77dab674a008bf"
75  "5676614888888" "ca673b5e60a6f70963bf3017e3cb0780"
276 "56711325.cc79" "f6075188c0f479d7a423744f6c8655b3"
256 "56711325.cc79" "f6075188c0f479d7a423744f6c8655b3"
275 "56711325.cc79" "f6075188c0f479d7a423744f6c8655b3"
152 NA              "f6075188c0f479d7a423744f6c8655b3"
158 NA              "f6075188c0f479d7a423744f6c8655b3"
28  "221124184"     "fc71064548bb35d05293bd67d55f1693"
31  "221124184"     "fc71064548bb35d05293bd67d55f1693" 
```

我想`authId`根据`sessionId`. 我试图在不使用循环的情况下做到这一点。例如：

```
143 "221156400"     "ae04ddacadaa3429ca77dab674a008bf"
118 "221156400"     "ae04ddacadaa3429ca77dab674a008bf" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:15:07.890

`authId`首先创建一个具有和的独特组合的数据框`sessionId`。然后找到`sessionId`任何`authId`是的`NA`。使用唯一表查找`sessionId`相关的`authId`：

```
df <- read.table(text="Id         authId          sessionId                         
139 56763313.wrpy 4233a31b52f92c6fe8af4f04f2116657
123 221156400     ae04ddacadaa3429ca77dab674a008bf
126 221156400     ae04ddacadaa3429ca77dab674a008bf
144 221156400     ae04ddacadaa3429ca77dab674a008bf
143 221156400     ae04ddacadaa3429ca77dab674a008bf
118 NA              ae04ddacadaa3429ca77dab674a008bf
121 NA              ae04ddacadaa3429ca77dab674a008bf
122 NA              ae04ddacadaa3429ca77dab674a008bf
75  5676614888888 ca673b5e60a6f70963bf3017e3cb0780
276 56711325.cc79 f6075188c0f479d7a423744f6c8655b3
256 56711325.cc79 f6075188c0f479d7a423744f6c8655b3
275 56711325.cc79 f6075188c0f479d7a423744f6c8655b3
152 NA              f6075188c0f479d7a423744f6c8655b3
158 NA              f6075188c0f479d7a423744f6c8655b3
28  221124184     fc71064548bb35d05293bd67d55f1693
31  221124184     fc71064548bb35d05293bd67d55f1693", header=T)

# find unique combinations of authId and sessionID, but not when authId is NA
uniques <- unique(df[c("authId", "sessionId")])
uniques <- uniques[!is.na(uniques$authId),]

# replace authID's that are NA with the unique authId associated with the sessionId
na.authId <- which(is.na(df$authId))
na.sessionId <- df$sessionId[na.authId]
df$authId[na.indices] <- uniques$authId[match(na.sessionId, uniques$sessionId)]

#     Id        authId                        sessionId
# 1  139 56763313.wrpy 4233a31b52f92c6fe8af4f04f2116657
# 2  123     221156400 ae04ddacadaa3429ca77dab674a008bf
# 3  126     221156400 ae04ddacadaa3429ca77dab674a008bf
# 4  144     221156400 ae04ddacadaa3429ca77dab674a008bf
# 5  143     221156400 ae04ddacadaa3429ca77dab674a008bf
# 6  118     221156400 ae04ddacadaa3429ca77dab674a008bf
# 7  121     221156400 ae04ddacadaa3429ca77dab674a008bf
# 8  122     221156400 ae04ddacadaa3429ca77dab674a008bf
# 9   75 5676614888888 ca673b5e60a6f70963bf3017e3cb0780
# 10 276 56711325.cc79 f6075188c0f479d7a423744f6c8655b3
# 11 256 56711325.cc79 f6075188c0f479d7a423744f6c8655b3
# 12 275 56711325.cc79 f6075188c0f479d7a423744f6c8655b3
# 13 152 56711325.cc79 f6075188c0f479d7a423744f6c8655b3
# 14 158 56711325.cc79 f6075188c0f479d7a423744f6c8655b3
# 15  28     221124184 fc71064548bb35d05293bd67d55f1693
# 16  31     221124184 fc71064548bb35d05293bd67d55f1693 
```

# javascript - 浏览器关闭时不会触发 onunload

> ID：12117503
> 
> 赞同：2
> 
> 时间：2012-08-24T22:36:55.863
> 
> 标签：javascript, browser, onunload

在 onunload 和 onbeforeunload 上遇到问题。当用户离开页面或关闭浏览器时，我需要执行一些代码。onunload 适用于导航，但在浏览器关闭时不起作用。我不能使用onbeforeunload，因为我将脚本注入现有网站，并且在离开时有确认，所以在询问用户是否要离开之前触发onb​​eforeunload，所以我不能依赖它。

我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:50:04.460

onbeforeunload 将是您在页面关闭之前需要用来执行任何操作的事件。如果您可以点击该确认框，那么您可以在他们确认页面关闭时触发您的功能。

您的下一个最佳机会是轮询会话服务端以检测用户何时离开页面。

# jquery - jquery.li-scroller.1.0.js 从左到右滚动

> ID：12117518
> 
> 赞同：0
> 
> 时间：2012-08-24T22:38:57.780
> 
> 标签：jquery, scroll

我开发了新闻网站，我用它`jquery.li-scroller.1.0.js`来查看我的突发新闻，但是这个脚本从右到左滚动新闻。我想从左到右滚动新闻，因为我使用阿拉伯语。

剧本：

```
jQuery.fn.liScroll = function(settings) {
    settings = jQuery.extend({
        travelocity: 0.07
    }, settings);        
    return this.each(function(){
        var $strip = jQuery(this);
        $strip.addClass("newsticker")
        var stripWidth = 1;
        $strip.find("li").each(function(i){
            stripWidth += jQuery(this, i).outerWidth(true); // thanks to Michael Haszprunar and Fabien Volpi
        });
        var $mask = $strip.wrap("<div class='mask'></div>");
        var $tickercontainer = $strip.parent().wrap("<div class='tickercontainer'></div>");                                
        var containerWidth = $strip.parent().parent().width();    //a.k.a. 'mask' width     
        $strip.width(stripWidth);            
        var totalTravel = stripWidth+containerWidth;
        var defTiming = totalTravel/settings.travelocity;    // thanks to Scott Waye        
        function scrollnews(spazio, tempo) {
            $strip.animate({left: '-='+ spazio}, tempo, "linear", function(){$strip.css("left", containerWidth); scrollnews(totalTravel, defTiming);});
        }
        scrollnews(totalTravel, defTiming);                
        $strip.hover(function(){
            jQuery(this).stop();
        },
        function(){
            var offset = jQuery(this).offset();
            var residualSpace = offset.left + stripWidth;
            var residualTime = residualSpace/settings.travelocity;
            scrollnews(residualSpace, residualTime);
        });            
    });    
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T11:41:05.003

您应该更改脚本和 CSS。通知我已将此代码用于宽度 = 880

您可以在此站点中查看工作示例：[arabic.tasnimnews.com](http://arabic.tasnimnews.com)

**现在，它是您的 .js 文件：**

```
jQuery.fn.liScroll = function (settings) {
settings = jQuery.extend({
    travelocity: 0.07
}, settings);
return this.each(function () {
    var $strip = jQuery(this);
    $strip.addClass("newsticker")
    var stripWidth = 1;
    $strip.find("li").each(function (i) {
        stripWidth += jQuery(this, i).outerWidth(true);
    });
    var $mask = $strip.wrap("<div class='mask'></div>");
    var $tickercontainer = $strip.parent().wrap("<div class='tickercontainer'></div>");
    var containerWidth = $strip.parent().parent().width();
    $strip.width(stripWidth);
    var totalTravel = stripWidth + containerWidth;
    var defTiming = totalTravel / settings.travelocity;
    function scrollnews(spazio, tempo) {
        $strip.animate({ right: '-=' + spazio }, tempo, "linear", function () { $strip.css("right", containerWidth); scrollnews(totalTravel, defTiming); });
    }
    scrollnews(totalTravel, defTiming);
    $strip.hover(function () {
        jQuery(this).stop();
    },
    function () {
        var offset = jQuery(this).offset();
        var residualSpace = offset.left + stripWidth;
        var residualTime = residualSpace / settings.travelocity;
        scrollnews(residualSpace, residualTime);
    });
}); }; 
```

**并将您的 CSS 文件的 ul.newsticker 块更改为：**

```
ul.newsticker { /* that's your list */
position: relative;
left: -880px;
list-style-type: none;
margin: 0;
padding: 0; } 
```

# sql - SQL：按最接近的值比较排序

> ID：12117528
> 
> 赞同：0
> 
> 时间：2012-08-24T22:40:00.053
> 
> 标签：sql

我有一个包含信息的数据库：

```
----------------------------------------------
| HighValue | LowValue | CurrentValue | Code |
----------------------------------------------
|  20       |    6     |      19      | GHI  |
|  10       |    2     |      3       | ABC  |
|  8        |    8     |      8       | JKL  |
|  15       |    8     |      9       | DEF  |
---------------------------------------------- 
```

我想找出当前值最接近最低值的代码： 可能按顺序排列，如下所示：

```
----------------------------------------------
| HighValue | LowValue | CurrentValue | Code |
----------------------------------------------
|  8        |    8     |      8       | JKL  |
|  10       |    2     |      3       | ABC  |
|  15       |    8     |      9       | DEF  |
|  20       |    6     |      19      | GHI  |
---------------------------------------------- 
```

如何将一列与另一列进行比较？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:41:47.197

```
Select * 
FROM yourtable
ORDER BY ABS(CurrentValue-LowValue) 
```

# javascript - jQuery 插件，获取原始元素的 .data()

> ID：12117531
> 
> 赞同：2
> 
> 时间：2012-08-24T22:40:14.553
> 
> 标签：javascript, jquery, jquery-plugins

我创建了一个下拉 jquery 插件。这隐藏了一个常规的 html 选择并添加了一个 div 和一些子 div 作为选项来显示。

按照一般经验法则，我正在初始化插件，如下所示：

```
$.fn.dropdown = function (options) {
    return this.each(function() {
        if (undefined === $(this).data('dropdown')) {
            var dropdown = new $.dropdown(this, options);
            $(this).data('dropdown', dropdown);
        }
    });
}; 
```

我还将给选择元素的任何类复制到替换 div

当试图通过使用类作为选择器来获取元素的数据时，选择器显然是在元素数组中返回生成的 div。

这会导致 div 出现“未定义数据”错误。

我应该从插件中更改某些内容，还是期望使用插件的人通过使用 id 而不是类在初始化后选择元素来获取数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-24T10:16:59.407

好吧，您在这里真的没有太多选择。在您的`$.dropdown`构造函数内部，只需再创建一个对`this`实例的数据引用。无论如何它都很便宜，因为它只是一个对象引用：

```
$.dropdown = function(element, options) {
    // ... newElement is what replaces original select
    newElement.data('dropdown', this);
}; 
```

# jquery - 将两个随机单词组合在数组中，然后将单词连接成一个单词

> ID：12117536
> 
> 赞同：0
> 
> 时间：2012-08-24T22:40:45.620
> 
> 标签：jquery, arrays, string, random

我有一个数组中的单词列表，我试图输出单词来组成一个单词，

示例是我的数组中的单词“一”、“二”、“三”、“四”，我会

希望输出可能是：

onethree或fourtwo，或onefour等...

任何帮助都是极好的！这是我到目前为止所拥有的，但可以让它正确执行

```
$(document).ready( function() {
var randomtxt = [
"ONE","TWO","THREE",
    "FOUR","FIVE","SIX","SEVEN"
];

var randomIndex = Math.floor(Math.random() * randomtxt.length); 
var randomElement = randomtxt[randomIndex];
$('#text-content').text(randomElement + randomtxt.join(", "));

}); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T16:24:33.233

如果我正确理解了您的问题，那么您应该使用以下内容：

```
var words = [ "one", "two", "three", "four", "five", "six", "seven" ];
$( "#text-content" ).text( createNewWord( words ) );

function getRandomWord( wordsArray ) {
    var index = Math.floor( Math.random() * wordsArray.length );
    return wordsArray[index];
}

function createNewWord( wordsArray ) {

    var newWordPart1 = getRandomWord( wordsArray );
    var newWordPart2 = getRandomWord( wordsArray );

    // this will prevent new words like oneone twotwo, etc.
    // if you want the repeated words, just remove this while entirely
    while ( newWordPart2 == newWordPart1 ) {
        newWordPart2 = getRandomWord( wordsArray );
    }

    return newWordPart1 + newWordPart2;

} 
```

jsFiddle：http: [//jsfiddle.net/davidbuzatto/UwXHT/](http://jsfiddle.net/davidbuzatto/UwXHT/)

# python - python，通用函数

> ID：12117539
> 
> 赞同：1
> 
> 时间：2012-08-24T22:41:01.703
> 
> 标签：python

如何在python中创建通用堆栈？我在 python 中的堆栈实现：

```
class Node(object):
    def __init__(self, d):
        self.data = d
        self.nextNode = None

class Stack(object):
    def __init__(self):
        self.top = None

    def push(self, item):
        newNode = Node(item)
        newNode.nextNode = self.top
        self.top = newNode

    def pop(self):
        if self.top == None:
            return None
        item = self.top.data
        self.top = self.top.nextNode
        return item 
```

现在我正在放置类 Node 的对象，但是如何实现泛型 Stack 以便我可以放置任何东西。例如，如果我想创建新类型的节点

```
class NodeWithMin:
    def __init__(self, value, minval):
        self.data = value
        self.minval = minval 
```

并且能够基于这些类型的节点创建堆栈，所以它应该是这样的（当然它不起作用）：

```
class StackWithMin(qs.Stack):
    def push(self, val):
        if self.peek() != None:
            minval = min(self.peek().value, val)
        else:
            minval = val
        qs.Stack.push(NodeWithMinV2(val, minval)) 
```

任何的想法？

编辑：它不起作用，因为我有下一个错误：

```
unbound method push() must be called with Stack instance as first argument (got NodeWithMinV2 instance instead) 
```

我错过了`self`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:53:34.693

你可以只使用一个列表，但我完全理解你可能想要更好地抽象一些东西。

您还可以在集合模块中使用双端队列。它可以从任一端添加或删除，并且比列表更好地抽象。

你所拥有的看起来不错。如果您想在其中放入最小值，只需创建一个新类，并将它的实例作为 item 参数传递到您的 push 方法中。

我在这里有点猜测，但是如果您想要的是优先级队列，您可以在其中弹出价值最小的节点，而不仅仅是通过推送年表来弹出给定端的东西，您可以查看 heapq 模块。它也不是非常抽象，但它可以工作，而且速度很快，没有什么可以阻止你自己更好地抽象它。

# json - 将 JSON 端点添加到 WCF Silverlight RIA 服务后出错

> ID：12117540
> 
> 赞同：0
> 
> 时间：2012-08-24T22:41:02.633
> 
> 标签：json, silverlight, wcf-ria-services

我正在尝试使用此处找到的信息将 json 端点添加到现有的 WCF RIA Silverlight 服务：

[http://blogs.msdn.com/b/deepm/archive/2010/05/14/silverlight-tv-episode-26-exposing-soap-json-and-odata-endpoints-from-ria-services.aspx](http://blogs.msdn.com/b/deepm/archive/2010/05/14/silverlight-tv-episode-26-exposing-soap-json-and-odata-endpoints-from-ria-services.aspx)

但是，当我在调试中启动项目时，我得到一个

> 远程服务器返回错误：NotFound。

Silverlight 中的错误。

WCF 跟踪说：

> System.ServiceModel.ServiceActivationException：由于编译期间出现异常，无法激活服务“/Services/CTCT-KronosNameManagement-Web-Services-BPAuthenticationDomainService.svc”。异常消息是：无法加载文件或程序集 'Microsoft.ServiceModel.DomainServices.Hosting, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' 或其依赖项之一。系统找不到指定的文件.. ---> System.IO.FileNotFoundException：无法加载文件或程序集“Microsoft.ServiceModel.DomainServices.Hosting，Version=4.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。该系统找不到指定的文件。在 System.RuntimeTypeHandle.GetTypeByName（字符串名称，布尔 throwOnError，

如果我在网络配置中删除端点，繁荣：它再次工作......当然除了 json。

```
 <system.serviceModel>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
    <domainServices>
      <endpoints>
        <add name="JSON" type="Microsoft.ServiceModel.DomainServices.Hosting.JsonEndpointFactory, Microsoft.ServiceModel.DomainServices.Hosting, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
      </endpoints>
    </domainServices>
</system.serviceModel> 
```

我确实安装了 WCF Ria Services Toolkit。System.ServiceModel.DomainServices.Hosting.dll 版本为 4.1.61829.0

任何建议都会非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T12:26:38.020

尽管 Deepesh 明确表示您需要在文章中添加参考`Microsoft.ServiceModel.DomainServices.Hosting.dll`，但我认为视频中没有提到这一点，当我进行故障排除时，我看到我有参考`System.ServiceModel.DomainServices.Hosting.dll`但没有注意到他之间的区别两个DLL。添加对第一个固定所有内容的引用。

# php - 用 PHP 替换文本

> ID：12117541
> 
> 赞同：0
> 
> 时间：2012-08-24T22:41:10.823
> 
> 标签：php, replace

我在 PHP 中有一个数组：

```
$wxCode = array(
    'VC' => 'nearby',
    'MI' => 'shallow',
    'PR' => 'partial',
    'BC' => 'patches of',
    'DR' => 'low drifting',
    'BL' => 'blowing',
    'SH' => 'showers',
    'TS' => 'thunderstorm',
    'FZ' => 'freezing',
    'DZ' => 'drizzle',
    'RA' => 'rain',
    'SN' => 'snow',
    'SG' => 'snow grains',
    'IC' => 'ice crystals',
    'PE' => 'ice pellets',
    'GR' => 'hail',
    'GS' => 'small hail',  // and/or snow pellets
    'UP' => 'unknown',
    'BR' => 'mist',
    'FG' => 'fog',
    'FU' => 'smoke',
    'VA' => 'volcanic ash',
    'DU' => 'widespread dust',
    'SA' => 'sand',
    'HZ' => 'haze',
    'PY' => 'spray',
    'PO' => 'well-developed dust/sand whirls',
    'SQ' => 'squalls',
    'FC' => 'funnel cloud, tornado, or waterspout',
    'SS' => 'sandstorm/duststorm'); 
```

如果在这里，我有一点：

```
 if (substr($part,0,1) == '-') {
        $prefix = 'light ';
        $part = substr($part,1);
    }
    elseif (substr($part,0,1) == '+') {
        $prefix = 'heavy ';
        $part = substr($part,1);
    }
    else $prefix = ''; 
```

但是，我想编写一个函数，根据数组和 if: light rain 将以下字符串：-RA 转换为以下文本。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:45:21.400

你几乎就在那里。只需用作数组`$part`的键：`$wxCode`

```
$wxCode[$part] 
```

如果您没有前缀或：

```
$wxCode[substr($part, 1)] 
```

如果你这样做。您可能需要使用`strtoupper()`以确保两个字母的代码全部大写

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:55:32.100

```
$str = str_replace(array('-', '+'), array('light ', 'heavy '), $str);
$str = str_replace(array_keys($wxCode), array_values($wxCode), $str); 
```

# asp.net-mvc-3 - 如何获取 WebClient 的请求以使用原始请求中的相同 Session？

> ID：12117544
> 
> 赞同：2
> 
> 时间：2012-08-24T22:41:19.823
> 
> 标签：asp.net-mvc-3, httpwebrequest, umbraco, httpcookie, cookiecontainer

因此向 ASP.net MVC 控制器/操作发出请求。这有一个关联的会话。我们实例化 WebClient 对象并调用同一站点上的资源的部分操作。

然而，尽管它是同一个站点，同一个应用程序池，因为 WebClient 创建了一个新请求，它具有不同的会话。（我知道你的想法，如果它在同一个应用程序池、同一个站点上，为什么需要 WebClient）。我已将这些细节遗漏了以免弄脏水，但是 WebClient 是有原因的。

我的理解是，如果可以为 WebClient 分配原始 Request.Cookies 集合中的 cookie，那么 ASP.net 将能够根据现有的 cookie 查找现有的 Session。

所以我想有2个问题：

1.  这是正确的吗，如果我要（以某种方式）将 cookie 分配给 WebClient，那么由 WebClient 创建的请求最终会获取原始请求的会话。
2.  如何将当前的 Request.Cookies 分配给 WebClient？

**更新**

我已经查看并尝试了[使用带有 WebClient 类的 CookieContainer](https://stackoverflow.com/questions/1777221/using-cookiecontainer-with-webclient-class)以及[使用 HttpCookieCollection 和 CookieContainer 发送 cookie](https://stackoverflow.com/questions/1214387/sending-cookies-using-httpcookiecollection-and-cookiecontainer)，但我还没有找到可行的解决方案。

我们有 Umbraco 和 asp.net MVC 的捆绑解决方案，我们正在使用 webclient 向 Umbraco 发出页面请求。在我的研究中，我还发现可能有其他事实可能导致 cookie 无法像我上面描述的那样工作。所以我想首先要找出关于cookies的全部内容是否允许获取原始会话？或者是否有更好的方法来处理我们正在做的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:51:37.537

也许您可以尝试此处显示的实现：

[使用 HttpCookieCollection 和 CookieContainer 发送 cookie](https://stackoverflow.com/questions/1214387/sending-cookies-using-httpcookiecollection-and-cookiecontainer)

它将传入的 cookie 复制到传出的外部请求。但是，该实现是用于使用`HttpWebRequest`. 如果您确实需要使用 WebClient ，那么这可能会很有用： [Using CookieContainer with WebClient class](https://stackoverflow.com/questions/1777221/using-cookiecontainer-with-webclient-class)

# java - Java：return 在这里做什么？

> ID：12117545
> 
> 赞同：0
> 
> 时间：2012-08-24T22:41:36.010
> 
> 标签：java, sorting, queue, comparator

[我在网上](http://www.algorithmbase.com/258/java-priority-queue-example/)创建了这段代码。打扰一下，如果在这里问，但我不只明白一件事。究竟是什么***返回人口2 - 人口1;*** ? 它通过每次相互比较（**o1**和**o2**）来对项目进行排序，通过在冒号后面没有任何最终空格（前导和结尾）的部分，所以数字，并按...排序？

```
import java.util.Comparator;
import java.util.PriorityQueue;
public class Main {
 public static void main(String[] args) {
  PriorityQueue<String> queue = new PriorityQueue<String>(11,
  new Comparator<String>() {
   public int compare(String o1, String o2) {
   int population1 = Integer.parseInt(o1.split(":")[1].trim());
   int population2 = Integer.parseInt(o2.split(":")[1].trim());
   return population2 - population1;
   }
  });
queue.add("United States: 307006550");
queue.add("Brazil: 193733800");
queue.offer("Russia: 141850000");
queue.offer("India: 1155347700");
queue.offer("China: 1331460000");
System.out.println("Countries in database: " + queue.size());
while (!queue.isEmpty()) {
  System.out.println(queue.poll());
}
System.out.println("Countries in database: " + queue.size());
 }
} 
```

如果我尝试更改，例如将代码更改为：

```
return population1 - population2; 
```

它将数字排序为：

```
United States: 307006550
Russia: 141850000
Brazil: 193733800
India: 1155347700
China: 1331460000 
```

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:47:17.590

Comparator.compare 的文档说`Compares its two arguments for order. Returns a negative integer, zero, or a positive integer as the first argument is less than, equal to, or greater than the second.`

因此，他们使用减法来确定第一个数字是大于、等于还是小于第二个数字，并且该值坚持比较合约。即，如果第一个是 5，第二个是 10，那么 10-5=-5。负返回值表示第一个参数小于第二个。

请注意，当您反转它时（我假设您的意思是您正在更改`return population1 - population2;`而不是您编写的内容，这与代码示例相同），您的总体排序也被反转了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T22:49:11.450

查看. [_](http://docs.oracle.com/javase/6/docs/api/) _`Comparator`

简而言之，当第一个对象大于第二个对象时，`Comparator` `compare(T o1,T o2)`方法应该返回负数`Integer`，如果它们相等则返回零，如果第二个对象大于第一个对象，则返回正值。

所以`return population2 - population1;`只是指出哪个对象更大。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-24T22:51:30.500

进行比较的方法是将一个值与另一个值进行比较。然而，因为比较结果是三个可能的答案而不是两个，所以我们需要一种方便的方法让排序器知道第一个元素是小于、等于还是大于第二个元素。最简单的方法是，如果元素一小于元素二，则返回负数，如果相等则返回 0，如果第一个元素大于元素，则返回正数。

我们可以在代码中手动编写

```
if(population1 < population2)
    return -1;
else if(population1 > population2)
    return 1;
return 0; 
```

但是，排序器只检查负值和正值，因此结果的大小无关紧要，只要负数表示小于，正数表示大于即可。现在，因为我们要比较的两个值是数字，并且我们想按降序对它们进行排序，所以我们可以这样做`population1 - popultaion2`。如果population1小于population2，这将返回一个负值，如果它们相同，则返回0，如果population1大于population2，则返回一个正值。这只是一种方便。如果您想要相反的效果（按升序排序），只需反转语句（如您已经显示的那样）。

关于 sleax 的最新评论，Java 使用了经过修改的[合并排序](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Collections.html#sort%28java.util.List%29)，它使用了从`compareTo(..)`函数返回的信息。[您可以在Wikipedia](http://en.wikipedia.org/wiki/Merge_Sort)上了解合并排序的工作原理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T22:49:11.663

我建议您查看有关 PriorityQueue 类的文档。第二个参数是接收一个“比较器”类，它的方法 compare 将在 o1 == 02 时返回 0，如果 o1 > o2 则返回 < 0，如果 o1 < 02 则返回 > 0（非常常见的成语）然后在内部调用此方法PriorityQueue 作为排序算法的一部分。

# .net - 学习正则表达式模式的算法

> ID：12117551
> 
> 赞同：2
> 
> 时间：2012-08-24T22:42:08.983
> 
> 标签：.net, regex, vb.net, algorithm

好吧......所以这可能是一个延伸。我想将一个 TextStrings 列表提供给一个函数，然后它将正则表达式语法返回给我。我正在使用要跟踪的项目的标签或标签模式。我希望能够检测到所有可能存在的模式。我认为可以总结它的正则表达式会很棒。

这是以前做过的事情吗。

我在 VB.NET C# 中工作，建议很好。

也许这是一个糟糕的编程设计。但最想现在从哪里开始搜索？我什至会在谷歌下查找什么？

或者你能给我一些关于如何设计这样一个功能的指导吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:52:33.673

非常有趣的问题。不确定是否有一个好的答案，但这是首先想到的：

```
Loop through each target string
    Loop through each character in each target string
       Categorize that character as precisely as possible.  7 = \d, f=[a-z] etc
       Create a list of the categories for each character in order.
       Add that list of categories to a list of lists
    End character loop
End target string loop 
```

尝试使用您的类别列表列表来确定将匹配所有目标字符串的正则表达式。例如，如果您的类别列表列表如下所示：

```
\d,\d,\d,[a-z],[a-z]
\d,\d,\d,[a-z],[a-z]
\d,\d,[a-z],[a-z] 
```

您可能能够确定您的正则表达式需要匹配两到三位数字，后跟两个小写字母。不是很多东西可以去，但也许是一个开始的地方？我很想看看你是否想出了一个可行的解决方案......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T23:32:34.713

虽然这`.*`是一个有趣的评论，但如果您添加一个约束，即它是一个接受所有数据但不接受其他数据的最小正则表达式（对于每个运算符的某些成本指标），这个问题就会变得更加有趣。

这导致了下一个问题：您的数据可能并未反映所有示例，因此您*真正*要寻找的是按类（字符、数字、符号）划分数据。即便如此，这也很困难：如果你在一个实例中真正关心字符大小写，但在另一个实例中不关心字符大小写怎么办。如果某些符号是定界符，而另一些是分隔符，还有一些是数据的一部分，该怎么办。

换句话说，如果有足够的限制，您可以先对可能的正则表达式进行广度搜索（在您有限的语法中），当您找到一个有效的时，您可以停止。如果这在您的特定用例中是现实的，那么在很大程度上取决于这些限制......在一般正则表达式的不受限制的情况下是不现实的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T18:16:15.480

我对此事的看法：

**问题陈述**

给定一个有限字符串 S1..Sn 的有限集合 S，找到一个正则表达式与这些字符串完全匹配，而不是其他字符串，避免平凡解 ^S1|S2|S3|..|Sn$

**观察**

我们不能有'.' 字符类或“+”、“*”或“{x,}”量词，因为它们将允许匹配输入集之外的字符串。

**算法**

```
# strings and collections indexed from 1

regex := "^" + make_regex(S) + "$"

function make_regex(Ss)

    # string -> length
    Ls := { length Ss[i] | 1 <= i <= n } 

    # set of starting characters
    Cs := unique { Ss[i][1] | i in 1..n L[i] >= 1 } 
    cl := last in Cs

    ret := "("
    For c in Cs

        # substrings of all non-empty strings that start with c
        Scs := { S[i][2..] | i in 1..n, L[i] >= 1, S[i][j] = c }
        ret := ret + c + make_regex(Scs) 

        If c != cl
            ret := ret + "|"
        End

    End

    If Ss contains ""
        ret := ret + "|()"

    End
    ret := ret + ")"
    return ret
End 
```

**输入**

```
abc
abcd
cde
cef 
```

**结果**

```
^(a(b(c(d|())))|c(d(e)|e(f)))$ 
```

我相信这是 O(n*Lmax) 因为找到唯一字符串的正则表达式与其长度成线性关系。但是，输入集中的常见前缀越多，它就越接近 O(Lmax)，因此将与结果匹配 - 比 ^S1|S2|..|Sn$ 快得多，即 O(n*最大）。

# java - Java返回类型中的错误

> ID：12117552
> 
> 赞同：1
> 
> 时间：2012-08-24T22:42:23.337
> 
> 标签：java, return

我有这个代码：

```
public int Bol(int x, int y){
    if(x > y){
        return (x / y);
    }else if(x < y){
        return (y / x);
    }
} 
```

引发此错误：“此方法必须返回 int 类型的结果”。为什么必须呢？

**我知道当我改成`else if`这个`else`问题时就解决了。但是，当我使用 else-if 时，为什么会出现这个错误？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T22:45:01.617

如果不满足任何条件（即，何时`x == y`）会发生什么？该方法将返回什么？所以你需要返回一个默认值：

```
public int Bol(int x, int y){
    if(x > y){
        return (x / y);
    }else if(x < y){
        return (y / x);
    }

    return 0; // or whatever default value you need
} 
```

使用单个也很有帮助`return`：

```
public int Bol(int x, int y){

    int result = 0; //whatever default value you want

    if(x > y) {
        result = (x / y);
    } else if(x < y) {
        result = (y / x);
    }

    return result;
} 
```

> “我知道当我将 else if 更改为 else 时，这个问题就解决了。但是为什么当我使用 else-if 时，会出现这个错误？”

首先，我建议您复习一下`if`、`else`和`else if`工作原理，因为了解分支如何工作是编写正确运行代码所需的核心知识。

使用时它不起作用的原因是，只有当块的布尔表达式评估为真时，块`else if`内的代码`else if`才会执行​​。`else if`因此，Java 编译器会看到*没有任何*块被执行的情况（因此 the`if`和`else if`块都没有被执行）。这意味着存在没有`return`执行任何语句的情况。这违反了方法的签名，即该方法*总是*返回一个`int`. 现在，当您将 the 更改`else if`为 an时，您的代码可以工作，`else`因为如果前面的（或s）块没有运行，an 中的代码`else`将*始终运行。*`if``else if`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T22:44:35.143

那么当 x == y 时会发生什么？你回什么？

您的方法被定义为返回一个 int。但是当 x == y 时它没有返回任何东西。

你可以写

```
if (x > y) {
    return x/y;
} else if (x < y) {
    return y/x;
} else {
    return 1;  // x == y therefore x/y is 1.
} 
```

此外，请注意 x 或 y 何时为 zeor。假设 x=1 和 y=0。你认为会发生什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T22:45:36.927

有时您的代码没有返回值。IE 如果 if 或`else if`条件都不满足。因此，编译器会标记错误。

如果你有 a`else`而不是`else if`，编译器肯定在这两种情况下你都会返回一个值。这就是为什么它很好。

**另请注意**- “涵盖所有情况”是不够的。例如，如果您将 else if 更改为

```
else if ( x <= y ) {
....
} 
```

然后在技术上涵盖所有情况（同时修改除外）。尽管如此，编译器要知道这一点并不容易，它会标记一个错误。

编译器确定您有返回值的唯一方法是**if 条件**之外的a`else`或 a 。`return`

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T22:47:54.477

了解您的代码逻辑。会不会有两个`if`条件都不满足的情况？是的，这是可能的（即 when `x==y`），在这种情况下，函数不会返回任何内容。对于这种情况，您需要在函数中具有默认返回值，您错过了它并且编译器正在抱怨。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-24T22:47:02.370

现在有可能你的函数没有返回任何东西。例如，如果 x = y，那么既不成立`(x > y)`也不 `(x < y)`成立。因为您的函数只有在 x > y 和 y > x 时定义的返回语句，所以它不会在所有情况下都返回。

解决此问题的一种方法是在 if 语句之后添加默认 return 语句：

```
public int Bol(int x, int y){
    if(x > y){
        return (x / y);
    }else if(x < y){
        return (y / x);
    }
    return 1;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-24T22:47:11.573

此时其他响应者都没有注意到您的方法签名需要返回类型：

```
public int Bol(int x, int y){ 
```

`int`after`public`表示返回类型。您必须从此方法返回该类型的内容，因为 Java 是一种[强类型语言](http://en.wikipedia.org/wiki/Strong_typing)。当您`else`在 an 中使用时`if`，它将捕获其他条件未捕获的所有情况。

```
public int Bol(int x, int y){
    if(x > y){
        return (x / y);//returns a double, which can be cast to an int
    }else if(x < y){
        return (y / x); //returns a double, which can be cast to an int
    }
}    //if this line is reached, nothing is being returned, so the compiler throws an error. 
```**

# visual-studio-2010 - .Net 程序集版权文本以菱形显示问号，而不是 (c) 版权字符。怎么修？

> ID：12117558
> 
> 赞同：1
> 
> 时间：2012-08-24T22:43:42.743
> 
> 标签：visual-studio-2010, msbuild, .net-assembly

y 解决方案包含一个 Visual Studio 扩展。它包括两个项目，其程序集在构建时签名，由集中式构建服务器管理。

当我右键单击这两个项目的服务器构建程序集并查看“详细信息”选项卡时，版权文本显示：Copyright (?) CompanyName 2012。“(?)”是黑色菱形内的问号. 它应该是版权字符，©。

解决方案中的其他服务器构建程序集没有此问题。此外，在 bin/Debug 文件夹中本地构建的完全相同的程序集也不存在此问题。

为什么服务器构建的版本不同？感谢任何建议。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:17:15.820

听起来服务器上使用的编译器没有正确解释源代码中的非 ASCII 字符。Visual Studio 2010 的编译器 csc.exe 具有可用于指定编码的[/codepage参数。](http://msdn.microsoft.com/en-us/library/w0kyekyh%28v=vs.100%29.aspx)[这在MSBuild](http://msdn.microsoft.com/en-us/library/bb629394%28v=vs.100%29.aspx)中也可以作为`CodePage`.

# c++ - 是否可以将具有不同值的“相同”常量（从 C++）暴露给多个 Lua 协程？

> ID：12117559
> 
> 赞同：0
> 
> 时间：2012-08-24T22:43:55.090
> 
> 标签：c++, c, multithreading, lua, coroutine

我正在编写一个名为 LuaVM 的库来管理 Lua 脚本和我自己使用 Lua 库的项目之间的交互。

我正在寻找一种方法来*公开一些“本地”协程变量*。*所以我可以使用相同的“变量名”*从不同的协程访问不同的值。但是你可能知道协程与其 lua_State 父级共享相同的全局环境，以及从相同 lua_State 发出的所有其他协程。

例如，我想将`thisItem`全局暴露给每个协程，以便每个脚本（每个脚本都有自己的协程）可以调用`thisItem`并获得不同的值，即使它们使用相同的 lua_State 父级并且是嵌套的。

所以我尝试了不同的方法，例如使用堆栈公开/取消公开值，但没有一个确实是“线程”证明。

我的最后一次尝试是将全局`thisItem`与一个元表关联，其中`__index`和/或`__call`键被修改以调用一个函数，该函数又试图返回正确的值。

这是我公开它的方式

```
//-- Define a callback function
int LuaVM::DEBUGFUNCTION(lua_State *L)
{
    //-- Do stuff to return the right value
    return 1;
}

//-- Create callback metatable in the constructor
LuaVM::LuaVM()
{
    //--Init Lua
    mState = luaL_newstate();
    luaL_openlibs(mState);
    /* etc...*/

    //-- Define the callback metatable
    luaL_newmetatable(mState, "ThreadLocalMT");
    lua_pushstring(mState, "__call");
    lua_pushcclosure(mState, DEBUGFUNCTION,0);
    lua_settable(mState, -3);
}

//-- Then define the exposeInstance function
template <class C>
bool LuaVM::exposeInstance(C* _ptr, /*other stuff*/ )
{
    LuaObject<C>* ret = (LuaObject<C>*)lua_newuserdata(mState, sizeof(LuaObject<C>));
    ret->ptr = _ptr;

    luaL_getmetatable(mState, "ThreadLocalMT");
    lua_setmetatable(mState, -2);
    lua_setglobal(mState,"thisItem");

    /* other stuff */
    return true;
} 
```

但这并不是我真正想要的......（我需要调用`thisItem()`而不是变量`thisItem`）并且我想知道是否有一种方法可以创建一个表来存储所有值并使用 less “返回正确的值棘手”的解决方案。

我不习惯线程和 Lua C-api，所以我需要你的帮助。在多线程环境中可能有更好的方法来管理这个问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:03:35.150

如果您使用的是 Lua 5.1.x，那么您可以使用来设置协程的环境（如此[处](http://www.lua.org/manual/5.1/manual.html#pdf-setfenv)[`lua_setfenv`](http://www.lua.org/manual/5.1/manual.html#lua_setfenv)所述）。使用带有您想要的全局绑定的表，并且可以选择使用带有通常 globals的元表。[Lua 5.1 参考手册第2.9 节环境](http://www.lua.org/manual/5.1/manual.html#2.9)中描述了这种机制`__index``_G`

Lua 5.2 中的事情有点复杂（对于这个用例）；相关参考手册部分是[2.2 – 环境和全球环境](http://www.lua.org/manual/5.2/manual.html#2.2)

# c# - 如何在 LINQ 中插入表时关联表？

> ID：12117569
> 
> 赞同：0
> 
> 时间：2012-08-24T22:45:17.623
> 
> 标签：c#, .net, linq

假设我在客户和产品之间有 1:1 的关系。所以我要为两者添加一个表。在我的 LINQ to SQL 文件中，我用 .dbml 中的键和关联正确设置了所有内容。

现在我插入两个应该关联的表：

```
 CustomerDataContext dc = new CustomerDataContext();
    Table<Customer> customers = dc.GetTable<Customer>();
    Table<Product> products= dc.GetTable<Product>();

    Customer newCustomer = new Customer ();
    Product newProduct   = new Product();

    customers.InsertOnSubmit(newCustomer);
    products.InsertOnSubmit(newProduct);
    customers.Context.SubmitChanges(); 
```

那么此时我该如何建立关联呢？因此，当我查询此客户表时，我可以调用关联的产品，例如 Customer.Product？

这甚至可能吗？

打招呼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:07:08.803

```
CustomerDataContext dc = new CustomerDataContext();
Table<Customer> customers = dc.GetTable<Customer>();
Table<Product> products= dc.GetTable<Product>();
Table<ProductConsumer> ProductConsumers= dc.GetTable<ProductConsumer>();

Customer newCustomer = new Customer ();
Product newProduct   = new Product();

customers.InsertOnSubmit(newCustomer);
products.InsertOnSubmit(newProduct);
customers.Context.SubmitChanges();
products.Context.SubmitChanges();

//Now insert associations
ProductConsumer= new ProductConsumer();
ProductConsumer.Consumer= newCustomer ;
ProductConsumer.Product= newProduct  ;

ProductConsumers.InsertOnSubmit(ProductConsumer)
ProductConsumers.Context.SubmitChanges(); 
```

# c++ - 每个 C++ 开发人员都应该知道的关于链接的知识

> ID：12117572
> 
> 赞同：6
> 
> 时间：2012-08-24T22:45:30.937
> 
> 标签：c++, linker

# 问题

关于链接如何详细工作的信息很少。此外，IDE 隐藏了编译的细节，当您的项目遇到一些与链接相关的问题时，这真的很痛苦。

通常 C++ 书籍会告诉我

```
C++ code --> preprocessed c++ code --> object code 
```

但是，尽管事实上链接错误很常见，但他们并没有详细说明普通开发人员应该了解的链接知识。一个新的 C++ 程序员应该如何知道如何处理如下错误？

```
XmlRpcSocket.o:XmlRpcSocket.cpp:(.text+0x48b): undefined reference to `WSAGetLastError@0' 
```

但是这个问题并不是专门针对这个问题的（-lwsock32 解决了它）。问题是缺乏关于链接的一般知识。我的大学 C++ 讲师谈到了在一张幻灯片上链接一些黑盒的时间。

此外，关于链接如何工作的资源很少，我认识的大多数人仍然认为链接是一种黑盒操作。我对链接的了解是通过实验获得的，并且有点“一路走来”，但这种方法的问题在于它提出的问题多于回答的问题。

例如：我知道 .LIB 文件是库文件，它们是目标文件的捆绑包。现在，应该如何构建和使用 .LIB 文件？什么时候需要使用 .LIB 文件？何时构建静态 .LIB 文件或引用 DLL 的文件？当我将 .LIB 文件与我的目标文件链接时，是否会复制所有内容，或者只是我使用的目标文件？我什么时候应该构建 DLL/so 文件而不是静态链接？我是否必须了解目标文件的内部结构才能解决常见问题？关于姓名修饰，我必须了解什么？什么时候相关？如果其中一个 dll 加载旧的 msvcrt，我可以将几个不同的标准库链接到我的项目吗？等等

# 问题

显然，我不希望一口气回答上面列出的所有问题。我只需要知道从哪里开始。有没有像“每个程序员应该知道的关于内存的知识”这样的资源，它谈到了链接？因此，我需要学习资源以及您对我应该从哪个方向学习链接过程的见解。

每个开发人员都应该了解链接的哪些内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:50:41.863

有大量*的*资源。

我想这对于“初学者”来说可能是压倒性的；）

就“Windows”而言，您可能比从这里开始做得更糟：

*   [Windows 体系结构概述](http://blogs.technet.com/b/askperf/archive/2007/04/10/windows-architecture-the-basics.aspx)

*   [链接器初学者指南](http://www.lurklurk.org/linkers/linkers.html)

我也推荐这个：

*   [从头开始编程](http://savannah.nongnu.org/projects/pgubook/)

'希望有帮助:)

PS：

作为澄清：

*   你想知道你已经“编译”（变成机器代码）的位是如何通过“链接”组合在一起的。一个完全公平的问题:)

*   它还有助于了解该机器代码与“正在运行的程序”的关系......

*   ...以及“正在运行的程序”如何使用（静态）.exe 中的一些位，以及来自动态运行时（.dll 或“动态链接库）的其他位。

*   所有这些细节通常完全是特定于平台和操作系统的

*   因此（不同的）链接。

再次，我希望所有这些对您*最初*的问题有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T02:16:39.050

我强烈推荐阅读 John Levine 的[“Linkers & Loaders”](http://linker.iecc.com)。这本书的大部分内容都[可以在这里在线获得，](http://www.iecc.com/linker/)但你应该购买这本书并支持作者。这本书教会了我很多关于如何真正深入研究二进制文件的知识。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T22:59:13.637

如果您从编程/C++ 开始，我将首先对静态和动态库的工作原理有一个很好的理解，并制作一些教程来制作 .dll 和 .lib。谷歌是你最好的朋友：我只是找到这个，例如： http: [//www.bogotobogo.com/cplusplus/libraries.php](http://www.bogotobogo.com/cplusplus/libraries.php)。

请注意，您制作库的方式取决于您的 C++ 编译器。我头上的那些是像 Visual Studio 或 gnu C++ 编译器这样的集成开发环境 (IDE)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T02:28:41.750

您应该了解的一点是 ODR，尤其是它对`inline`符号的含义。

维基[百科条目](http://en.wikipedia.org/wiki/One_definition_rule)可能是一个好的开始。

# php - 简单的单用户登录页面

> ID：12117574
> 
> 赞同：2
> 
> 时间：2012-08-24T22:45:36.547
> 
> 标签：php, authentication, post, login, get

假设我想为单个用户制作一个超级简单的页面，在 php 中限制访问。假设授权用户知道页面的目录和 url，他是否可以通过`get`url 栏中的方法手动传递用户名和密码（他会知道），并根据脚本自动检查，其中的值的用户名和密码将被硬编码？该脚本有一个`if statement`如果不是真的，就不会显示内容。可能有什么缺陷？

网址

```
http://example.com/admin.php?user=admin&password=1324 
```

管理员.php

```
<?php if($_GET['user'] == 'admin' && $_GET['password'] == '1324')){
// display content here
}else{
echo "You're not authorized to visit this page";
} ?> 
```

场景二：`post`方法

与上述场景类似，在这种情况下，授权用户将在表单中键入用户名、密码，这些表单将在实际`admin.php`文件中进行处理。将使用类似`if statement`的方法，`$_POST[]`这次使用超全局变量来检查输入。

```
<?php if($_POST['user'] == 'admin' && $_POST['password'] == '1324'){
  // display content here
}else{
  echo "You're not authorized to visit this page";
} ?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T23:05:51.297

两者都有缺陷。

如果您使用方法 1，您最终会将传递给页眉的变量保存在页面历史记录中，这意味着任何有权访问 PC 的人都可以搜索并找到它们，从而在此过程中获得访问权限。搜索引擎也可以获取并保存链接，使其向世界开放。

如果您使用方法 2，则*每次*访问安全页面时都需要重新发送 POST 数据，这意味着您最终会得到一堆按钮和表单，而链接可能就足够了。然而，它确实消除了第一种方法的问题。

更好的方法是使用 $_SESSION 变量。这基本上允许将数据存储在服务器端，同时为用户提供一个“密钥”，可用于控制对数据的访问 - 默认情况下，此密钥存储在 cookie 中。

一个示例用法是：

```
//Say the user is "admin", and the password is "1234"
//This data could be used to 'log in' via post.
//First of all we start the session, and check to see if the user is logged in
//If the user has the session active, they'll have a cookie on their PC which links to it
session_start();
if ($_SESSION['login']==true || ($_POST['user']=="admin" && $_POST['pass']=="1234")) {
    //If they already have a session, give them access.
    //If not, check for posted UN & PW and if correct, give access.
    $_SESSION['login']=true; //Set login to true in case they got in via UN & PW
    //Do stuff for when logged in
}
else { //Not already logged in, not sent a password

    //Give the user a login form redirecting to this page.

} 
```

这样做的好处是：

*   用户端没有存储密码
*   关闭浏览器时过期的会话密钥
*   密码只能通过互联网传递一次

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:51:33.260

是的，它可以，`GET`必须`POST`从表单传递。由于许多原因，这不是一种安全的方式。

但是，是的，根据您的需要，它可以通过`GET`. 只需一个 URL，他就可以跳入禁区。

顺便说一句，当您检查用户名和密码时：

```
if($_GET['user'] == 'admin' && $_GET['password'] == '1324' && $_GET['password'] != '' && $_GET['username'] != '') 
```

您可以排除最后一部分，因为您已经在验证数据

```
if($_GET['user'] == 'admin' && $_GET['password'] == '1324') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T23:44:25.900

像这样的东西

```
if (!isset($_SERVER['PHP_AUTH_USER'])) {
    header('WWW-Authenticate: Basic realm="My Realm"');
    header('HTTP/1.0 401 Unauthorized');
    echo 'Text to send if user hits Cancel button';
    exit;
} else {
    $expectdUsername = 'username';
    $expectedPassword =  'secret';

    if($_SERVER['PHP_AUTH_USER'] != $expectdUsername || 
        $_SERVER['PHP_AUTH_PW'] != $expectedPassword) {
        echo 'Invalid username/password';
        exit;
    }

    //Add a cookie, set a flag on session or something
    //display the page
} 
```

它可以被调用

[http://用户名:secret@thepage.com](http://username:secret@thepage.com)

# python - 如何在python中计算文件中的词频

> ID：12117576
> 
> 赞同：3
> 
> 时间：2012-08-24T22:46:03.753
> 
> 标签：python

我有一个具有以下格式的 .txt 文件，

```
C
V
EH
A
IRQ
C
C
H
IRG
V 
```

虽然显然它比那个大得多，但本质上就是这样。基本上我试图总结每个单独的字符串在文件中的次数（每个字母/字符串在单独的行上，所以从技术上讲，文件是 C\nV \nEH\n 等等。但是，当我尝试将这些文件转换为列表，然后使用 count 函数时，它会分离出字母，以便 'IRQ' 等字符串为 ['\n'I','R' ,'Q','\n'] 所以当我计算它时，我会得到每个字母的频率，而不是字符串的频率。

这是我到目前为止编写的代码，

```
def countf():
    fh = open("C:/x.txt","r")
    fh2 = open("C:/y.txt","w")
    s = []
    for line in fh:
        s += line
    for x in s:
        fh2.write("{:<s} - {:<d}".format(x,s.count(x)) 
```

我想要结束的是一个看起来像这样的输出文件

```
C  10
V  32
EH 7
A  1
IRQ  9
H 8 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T22:51:28.120

使用[`Counter()`](http://docs.python.org/dev/library/collections#collections.Counter)，并使用`strip()`删除`\n`：

```
from collections import Counter
with open('x.txt') as f1,open('y.txt','w') as f2:
    c=Counter(x.strip() for x in f1)
    for x in c:
        print x,c[x]   #do f2.write() here if you want to write them to f2 
```

**输出：**

```
A 1
C 3
EH 1
IRQ 1
V 2
H 1
IRG 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T22:49:44.500

更改`s += line`为`s.extend(line.split())`。该`+=`运算符用于将两个序列相加，并将字符串视为字符序列。您可以使用`list.append`（例如，`s.append(line)`）将整行添加为列表中的单个条目，也可以使用`list.extend`添加字符串列表。

在这种情况下，我曾经`line.split()`将行拆分为单个单词，然后将单词列表添加到当前列表中。如果每一行只包含一个单词，那么您可以`s.append(line)`改用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T23:02:54.813

如果您有 Python`2.7`或`3.1`，`2.6`但`3.0`没有`collections.Counter`.

对于这些旧版本的可移植性，您最好使用[`collections.defaultdict(int)`](http://docs.python.org/library/collections.html#defaultdict-objects).

# google-apps-script - 如何使用谷歌表单上传 csv 文件并使用应用程序脚本将数据插入电子表格模板或 mysql 数据库

> ID：12117580
> 
> 赞同：0
> 
> 时间：2012-08-24T22:46:37.503
> 
> 标签：google-apps-script

如何使用应用程序脚本上传 csv 文件并读取数据并将其插入电子表格模板或 MySql 数据库

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:53:40.320

你看过这个主题的[教程吗？](https://developers.google.com/apps-script/articles/docslist_tutorial#section2)也许它会满足你的要求。

# ruby-on-rails-3 - /Users/wayneeseguin 是如何进入我的路径的？

> ID：12117590
> 
> 赞同：1
> 
> 时间：2012-08-24T22:47:15.940
> 
> 标签：ruby-on-rails-3

我将我的新 Mac 配置为与 Rails 一起使用，并在 OS X 10.8 下的 Mac 上安装最新版本的 rvm，最后得到了这个 PATH：

> echo $PATH
> /Users/rickc/.rvm/gems/ruby-1.9.3-p194/bin:/Users/rickc/.rvm/gems/ruby-1.9.3-p194@global/bin:/Users/rickc/ .rvm/rubies/ruby-1.9.3-p194/bin:/Users/rickc/.rvm/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr /local/git/bin:/Users/wayneeseguin/.sm/bin:/Users/wayneeseguin/.sm/pkg/active/bin:/Users/wayneeseguin/.sm/pkg/active/sbin:/Users/rickc/ .rvm/bin

虽然它没有造成任何困难（还没有？），但我不明白 /Users/wayneeseguin... 是如何进入我的道路的。我查看了 bash shell 的所有启动文件，但在任何地方都找不到。令人沮丧的神秘；如果有人有想法，请告诉我！

谢谢，
里克斯特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T17:11:03.097

您可能通过安装 rvm 得到它。

寻找一条线

```
source /etc/profile.d/sm.sh 
```

在 /etc/profile 文件中。

/etc/profile.d/sm.sh 实际上是把它放在那里的。

# php - 将 AS3 分数变量发送到 PHP 文件

> ID：12117592
> 
> 赞同：1
> 
> 时间：2012-08-24T22:47:19.980
> 
> 标签：php, actionscript-3, variables

我的 Flash 游戏中有一个名为 score 的变量，我想将 Flash 游戏中的分数发布到一个名为 test.php 的 php 文件中；游戏结束时 AS3 代码的最后一部分是：

```
function gameFinished(){
gameOver.play();
stage.removeEventListener(MouseEvent.CLICK, kick);
stage.removeEventListener(MouseEvent.MOUSE_MOVE, dragCursor);
Mouse.show();
again_btn.addEventListener(MouseEvent.MOUSE_DOWN, playAgain);
} 
```

这是我想将我的分数 var 发布到 php 文件的地方，以便我可以在排行榜中使用它；我已经阅读了很多教程，但真的很难。你能指导我一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T23:03:40.533

AS3：

```
function gameFinished(){
   ...
   again_btn.addEventListener(MouseEvent.MOUSE_DOWN, playAgain);

   var urlLoader:URLLoader = new URLLoader();
   var req:URLrequest = new URLRequest("test.php");
   var requestVars:URLVariables = new URLVariables();
   requestVars.score = 150; //your scroe here
   req.data = requestVars;
   req.method = URLRequestMethod.POST;
   urlLoader.load(req);
   urlLoader.addEventListener(Event.COMPLETE, scoreSent);
}

function scoreSent(e:Event){
  trace("score sent to php");
} 
```

php:

```
if(isset($_POST["score"])){
  //submit the score;
} 
```

# php - 如何在if语句中将字体颜色从红色更改为绿色

> ID：12117594
> 
> 赞同：1
> 
> 时间：2012-08-24T22:47:35.200
> 
> 标签：php, html, css

我有一个表格行，其中包含一个 ID，如下所示：

```
 <td id='errormsg'>$errormsg</td> 
```

在 css 页面中，`#errormsg' id 将文本颜色变为红色，如下所示，在单独的 css 文件中：

```
#errormsg{
    color:red;  
} 
```

但是我有一点情况。我在这里有一个 if 语句：

```
if(mail($getemail, $subject, $message, $headers)){
$errormsg = "You have been Registered. You must Activate your Account from the Activation Link sent to <b>$getemail</b>";
                                                } 
```

现在我想要发生的是，如果满足这个 if 语句，我希望 $errormsg 将字体颜色从红色更改为绿色。这真的可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:50:28.200

试试这个：

```
$color = "red";

if(mail($getemail, $subject, $message, $headers)){
    $color = "green";
    $errormsg = "You have been Registered. You must Activate your Account from the Activation Link sent to <b>$getemail</b>";
}
....
echo "<td style='color:$color;' id='errormsg'>$errormsg</td>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:54:35.527

```
<?php
$extraErrorClass = '';
if(mail($getemail, $subject, $message, $headers)) {
    $errormsg = "You have been Registered. You must Activate your Account from the Activation Link sent to <b>$getemail</b>";
    $extraErrorClass = ' class="error-green"';
}

echo "<td id='errormsg'$extraErrorClass>$errormsg</td>";
?> 
```

或者也许更好的可读性：

```
echo '<td id="errormsg"', $extraErrorClass, '>', $errormsg, '</td>'; 
```

只需将额外的类添加到您的 CSS 中：

```
#errormsg.error-green {
    color: green;  
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T22:50:42.260

```
if (mail($getemail, $subject, $message, $headers)) {
  $errormsg = "<span style='color: green'>You have been Registered. You must Activate your Account from the Activation Link sent to <b>$getemail</b></span>";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T22:55:22.443

是的。

**PHP：**

```
<?php
// ...
$result = mail($getemail, $subject, $message, $headers);
if($result) {
?>
<div class="message message-success">You have been registered. Please activate your account from the activation link sent to <strong><?php echo $getemail; ?></strong>.
<?php
} else {
?>
<div class="message message-fail">Sorry, an error occurred when sending the activation email to <strong><?php echo $getemail; ?></strong>.
<?php
}
// ...
?> 
```

**CSS：**

```
.message {
    text-align: center;
    padding: 20px;
    border: 1px solid #888
}
.message-success {
    background: #afa;
    color: #040
}
.message-fail {
    background: #faa;
    color: #400
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-24T22:58:17.850

```
#errormsg{
    color:red;  
}

#okmsg{
    color:green;  
} 
```

```
 $status = "errormsg";
  if(mail($getemail, $subject, $message, $headers)){
    $msg = "You have been Registered. You must Activate your Account from the Activation Link sent to <b>$getemail</b>";
    $status = "okmsg";
  } 
```

```
<td id="$status">$msg</td> 
```

# php - AJAX 获取未定义的 PHP 变量

> ID：12117597
> 
> 赞同：0
> 
> 时间：2012-08-24T22:48:01.367
> 
> 标签：php, jquery, mysql, ajax

嘿伙计们，我手头有一个特定的问题非常困难。我正在尝试创建一个使用 AJAX 获取帖子的数据库驱动的聊天室。但是，当调用使用 AJAX 获取数据时，我收到未定义索引警告。我使用 setinterval() 函数来调用包含 AJAX 的 javascript 函数。当达到 setinverval() 函数的时间时，我收到此警告。我该如何编码，以便当该变量为空并且达到 setinterval() 函数时，我停止收到警告？提前感谢所有愿意提供帮助的人。顺便说一句，这是我的第一篇文章，所以如果需要更多信息，请告诉我。再次感谢！！

这是chatRoom.php 文件

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org
/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Chat - Customer Module</title>
<link type="text/css" rel="stylesheet" href="style.css" />

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery
/1.3/jquery.min.js"></script>
<script type="text/javascript">
// jQuery Document
$(document).ready(function(){
//If user submits the form
$("#submitmsg").click(function(){   
    var clientmsg = $("#usermsg").val();
    $.post("post.php", {text: clientmsg});              
    $("#usermsg").attr("value", "");
    return false;
});

//Load the file containing the chat log
function loadLog(){     
    var oldscrollHeight = $("#chatbox").attr("scrollHeight") - 20;
    $.ajax({
        url: "log.php",
        cache: false,
        success: function(html){        
            $("#chatbox").html(html);
                    //Insert chat log into the#chatboxdiv               
            var newscrollHeight = $("#chatbox").attr("scrollHeight")
   - 20;
            if(newscrollHeight > oldscrollHeight){
$("#chatbox").animate({scrollTop:newscrollHeight},'normal');
   //Autoscroll to  bottom of div
            }               
        }
    });
}
setInterval (loadLog, 1500);    //Reload file every 2.5 seconds

//If user wants to end session
$("#exit").click(function(){
    var exit = confirm("Are you sure you want to end the session?");
    if(exit==true){window.location = 'index.php?logout=true';}      
});
});
</script>

</head>
<?php
    include('functions.php'); 
    session_start();
?>

<div id="wrapper">
<div id="menu">
    <p class="welcome">Welcome, <b><?php echo $_SESSION['user']; ?></b></p>
    <p class="logout"><a id="exit" href="#">Exit Chat</a></p>
    <div style="clear:both"></div>
</div>  
<div id="chatbox">
        <?php
            loadPosts();
        ?>
    </div>

<form name="message" action="">
    <input name="usermsg" type="text" id="usermsg" size="63" />
    <input name="submitmsg" type="submit"  id="submitmsg" value="Send" />
</form>
</div>
</body>
</html> 
```

这是 php.post 文件

```
<?
include('functions.php');
session_start();
if(isset($_SESSION['user'])){
$text = $_POST['text'];

    $uName = $_SESSION['user'];
    $time = date("h:i A");

    postComment($time, $uName, $text);
}       
?> 
```

函数.php 文件

```
<?php
include('connect.php');
function loadPosts(){

    $query = mysql_query("SELECT * FROM chat") or die(mysql_error());

    if(mysql_num_rows($query) == 0){
        echo "No Posts Were Found";
    }

    while($post = mysql_fetch_assoc($query))
    {
        echo "(" . $post['time'] . ") <b>" . $post['user'] . "</b>: " . $post['text']
. "<br />";
    }

}

function postComment($time, $userN, $userMessage){
    mysql_query("INSERT INTO chat 
Values(null, '$time', '$userN', '$userMessage')") or die(mysql_error());
}

function exitChat(){
    header("Location: index.php");
}

?> 
```

最后是新文件 log.php

```
<?php
include('functions.php');
session_start();
if(isset($_SESSION['user']))
    loadPosts();    
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:34:00.320

我假设这一行是您收到未定义索引通知的地方：

```
$userPost = $_POST['userPost']; 
```

由于您的轮询代码在没有发布数据的情况下访问此文件，因此`$_POST`没有`userPost`索引。

删除该行并执行以下操作：

```
if (!empty($_POST['userPost']))
  postComment($time, $userN, $_POST['userPost']); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T01:11:09.830

嘿伙计们我想通了！！哇，我花了将近一个月的时间才弄清楚！显然，我被迫将 postComment() 和 loadPosts() 函数分离到它们自己的文件中。我将 postComment() 留在 post.php 页面内，但将 loadPosts() 放在另一个页面中。我不太确定为什么会这样，但确实如此。它没有给我一个索引错误或删除所有聊天内容。如果有人有兴趣检查它，我会发布代码！顺便说一句，我要感谢所有为这篇文章做出贡献并尝试提供帮助的人。谢谢！！

# security - SecurityComponent 黑洞我的控制器测试用例

> ID：12117598
> 
> 赞同：6
> 
> 时间：2012-08-24T22:48:04.803
> 
> 标签：security, unit-testing, cakephp, phpunit

这是我的**UsersController**测试用例：

```
<?php
App::uses('UsersController', 'Controller');

class TestUsersController extends UsersController {

    public $autoRender = false;

    public function redirect($url, $status = null, $exit = true) {
        $this->redirectUrl = $url;
    }

    public function render($action = null, $layout = null, $file = null) {
        $this->renderedAction = $action;
    }

    public function _stop($status = 0) {
        $this->stopped = $status;
    }
}

class UsersControllerTestCase extends ControllerTestCase {

    public $fixtures = array('app.user');

    public function setUp() {
        parent::setUp();
        $this->Users = new TestUsersController();
        $this->Users->constructClasses();
    }

    public function tearDown() {
        unset($this->Users);

        parent::tearDown();
    }

    public function testAdminSearchStudents() {
        $data = array('User' => array('search' => 'Ipsum'));
        $result = $this->testAction('/admin', array('return' => 'vars', 'method' => 'post', 'data' => $data));
        $this->assertCount(1, $result['users']);
    }

} 
```

我的 UsersController 没有什么特别之处，但它使用了 SecurityComponent（继承自 AppController）。

当我运行测试时，我得到了臭名昭著的：

> 请求已被黑洞测试用例：UsersControllerTestCase(testAdminSearchStudents)

我认为这是因为我正在伪造一个没有 CSRF 令牌和引用的 POST 请求？

我应该怎么做才能在不从控制器**中删除安全组件的情况下完成这项工作？**

我不确定这是否会有所帮助，但这是堆栈跟踪的重要部分：

```
/var/www/source/cakephp/lib/Cake/Controller/Component/SecurityComponent.php : 230
SecurityComponent::startup
/var/www/source/cakephp/lib/Cake/Utility/ObjectCollection.php : 130
ObjectCollection::trigger
/var/www/source/cakephp/lib/Cake/Event/CakeEventManager.php : 246
/var/www/source/cakephp/lib/Cake/Controller/Controller.php : 671
/var/www/source/cakephp/lib/Cake/Routing/Dispatcher.php : 183
/var/www/source/cakephp/lib/Cake/Routing/Dispatcher.php : 161
/var/www/source/cakephp/lib/Cake/TestSuite/ControllerTestCase.php : 271
ControllerTestCase::_testAction
/var/www/source/cakephp/lib/Cake/TestSuite/ControllerTestCase.php : 189 
```

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T15:30:28.873

我解决了**模拟**该`SecurityComponent::_validatePost`方法的问题：

```
$this->Users = $this->generate('Users', array(
    'components' => array(
        'Security' => array('_validatePost'),
    )
)); 
```

灵感来自[在 CakePHP 2 测试用例中处理安全组件](https://stackoverflow.com/questions/8183396/dealing-with-security-component-in-a-cakephp-2-test-case?rq=1)

# regex - 编号的正则表达式捕获的最大数量是多少？

> ID：12117599
> 
> 赞同：12
> 
> 时间：2012-08-24T22:48:12.863
> 
> 标签：regex, perl

我正在维护一些通过串行无线电读取值并将它们解压缩到 Perl 数据结构中的代码：

```
# Don't yell at me, I didn't write this
if ($command_string =~
    /^.(.)(.).(..)(.)(..)(.)(....)(....)(....)(....)
        (..)(..)(.)(.)(.)(.)(..)(..)(..)(..)(..)(..)(.)(.).......
            (.)........(.)(.).*/sx) {

    $config->{sequence}      = hex(unpack('H2', $1));
    $config->{radio_id}      = hex(unpack('H2', $2));
    ...
    $config->{radio_type}    = hex(unpack('H2', $26));
    $config->{radio_channel} = hex(unpack('H2', $27));
} 
```

这个笨拙的捕获正则表达式让我想知道：Perl 中编号捕获变量的上限是多少？它一直到`$MAXINT`吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-24T22:57:20.753

这个脚本至少可以工作`$N=5000000`。之后，它会耗尽内存。

```
$N = $ARGV[0] || 5000;
$q = '(.)' x $N;
$regex = qr/$q/;
("x" x $N) =~ $regex;
print eval "\$$N"; 
```

# google-app-engine - GAE：访问被拒绝异常导致持久性提供程序出错

> ID：12117601
> 
> 赞同：4
> 
> 时间：2012-08-24T22:48:45.700
> 
> 标签：google-app-engine, jpa, datanucleus

我刚刚升级到 GAE SDK 1.7.1，现在我正在尝试在我的 [前] 功能项目中使用 JPA 2。当我尝试使用实体管理器时，它会引发以下异常：

```
java.lang.ExceptionInInitializerError
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:169)
    at com.google.appengine.tools.development.agent.runtime.RuntimeHelper.checkRestricted(RuntimeHelper.java:69)
    at com.google.appengine.tools.development.agent.runtime.Runtime.checkRestricted(Runtime.java:64)
    at com.olympya.futweb.ServicesServlet.doPost(ServicesServlet.java:39)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at com.google.appengine.tools.appstats.AppstatsFilter.doFilter(AppstatsFilter.java:141)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:35)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:60)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:125)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:94)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:370)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:938)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
Caused by: javax.persistence.PersistenceException: Explicit persistence provider error(s) occurred for "transactions-optional" after trying the following discovered implementations: org.datanucleus.api.jpa.PersistenceProviderImpl from provider: org.datanucleus.api.jpa.PersistenceProviderImpl
    at javax.persistence.Persistence.createPersistenceException(Persistence.java:242)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:184)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:70)
    at com.olympya.futweb.datamodel.EMHelper.<clinit>(EMHelper.java:49)
    ... 38 more
Caused by: org.datanucleus.exceptions.NucleusUserException: Errors were encountered when loading the MetaData for the persistence-unit "transactions-optional". See the nested exceptions for details
    at org.datanucleus.metadata.MetaDataManager.loadPersistenceUnit(MetaDataManager.java:979)
    at org.datanucleus.api.jpa.JPAEntityManagerFactory.initialiseNucleusContext(JPAEntityManagerFactory.java:754)
    at org.datanucleus.api.jpa.JPAEntityManagerFactory.initialise(JPAEntityManagerFactory.java:417)
    at org.datanucleus.api.jpa.JPAEntityManagerFactory.<init>(JPAEntityManagerFactory.java:380)
    at org.datanucleus.api.jpa.PersistenceProviderImpl.createEntityManagerFactory(PersistenceProviderImpl.java:91)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:150)
    ... 40 more
Caused by: java.security.AccessControlException: access denied (java.lang.RuntimePermission accessClassInPackage.sun.reflect.generics.reflectiveObjects)
    at java.security.AccessControlContext.checkPermission(AccessControlContext.java:374)
    at java.security.AccessController.checkPermission(AccessController.java:546)
    at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)
    at com.google.appengine.tools.development.DevAppServerFactory$CustomSecurityManager.checkPermission(DevAppServerFactory.java:283)
    at java.lang.SecurityManager.checkPackageAccess(SecurityManager.java:1512)
    at java.lang.ClassLoader$1.run(ClassLoader.java:330)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.lang.ClassLoader.checkPackageAccess(ClassLoader.java:328)
    at java.lang.Class.getDeclaredMethods0(Native Method)
    at java.lang.Class.privateGetDeclaredMethods(Class.java:2427)
    at java.lang.Class.getDeclaredMethods(Class.java:1791)
    at org.datanucleus.metadata.annotations.AbstractAnnotationReader.getJavaBeanAccessorAnnotationsForClass(AbstractAnnotationReader.java:310)
    at org.datanucleus.metadata.annotations.AbstractAnnotationReader.getMetaDataForClass(AbstractAnnotationReader.java:146)
    at org.datanucleus.metadata.annotations.AnnotationManagerImpl.getMetaDataForClass(AnnotationManagerImpl.java:171)
    at org.datanucleus.metadata.MetaDataManager.loadAnnotationsForClass(MetaDataManager.java:2650)
    at org.datanucleus.metadata.MetaDataManager.loadPersistenceUnit(MetaDataManager.java:955)
    ... 45 more 
```

我的 persistence.xml 是这样的：

```
<?xml version="1.0" encoding="UTF-8" ?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence
        http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd" version="1.0">

    <persistence-unit name="transactions-optional">
        <provider>org.datanucleus.api.jpa.PersistenceProviderImpl</provider>
        <properties>
            <property name="datanucleus.NontransactionalRead" value="true"/>
            <property name="datanucleus.NontransactionalWrite" value="true"/>
            <property name="datanucleus.ConnectionURL" value="appengine"/>
            <property name="datanucleus.appengine.multipleRelationsOfSameTypeAreErrors" value="false"/>
            <property name="datanucleus.DetachAllOnCommit" value="false"/>
            <property name="datanucleus.DetachOnClose" value="true"/>
            <property name="datanucleus.appengine.datastoreEnableXGTransactions" value="true"/>
        </properties>
    </persistence-unit> 

</persistence> 
```

我的助手是这样的：

```
 public final class EMHelper
{
    private static final EMHelper emhInstance = new EMHelper();
    private static final EntityManagerFactory emfInstance = 
            Persistence.createEntityManagerFactory("transactions-optional");

    private EMHelper()
    {
    }

    public static EMHelper getInstance()
    {
        return emhInstance;
    }

    public static EntityManager getEntityManager()
    {
        return emfInstance.createEntityManager();
    }
        ... 
```

# jquery - 如何以编程方式单击 jQuery 导航手风琴中的项目

> ID：12117613
> 
> 赞同：0
> 
> 时间：2012-08-24T22:50:27.217
> 
> 标签：jquery, jquery-ui, asp.net-mvc-4

我已经花了我分配的时间来寻找关于 SO 的答案，所以就这样吧。鉴于此代码在 js 中创建导航手风琴

```
$("#accordion").accordion({
    fillSpace: true,
    collapsible: false,
    navigation: true
}); 
```

在我看来，这是为了填充它（为了清楚起见，大部分都被删除了）

```
 <h2>
    <a href="#">Messages</a></h2>
<ul class="menulist" id="messagesNavItems">
    @Html.MenuItem("Messaging", "InterOffice", "Message", "selected")
    @Html.MenuItem("Outbox", "Outbox", "Message", "selected")
    @Html.MenuItem("Inbox", "Inbox", "Message", "selected")
</ul> 
```

呈现

```
<ul id="messagesNavItems" class="bunch of classes" role="tabpanel">
    <li>
        <a href="/Buyer/Message/InterOffice">Messaging</a>
    </li>
    <li>
        <a href="/Buyer/Message/Inbox">Inbox</a>
    <li>
    <li>
        <a href="/Buyer/Message/Outbox">Outbox</a>
    <li>
</ul> 
```

如何模拟从页面的其他部分点击到发件箱？

我可以让“标题”弹出

```
var accordionindex = 5; /*Messages*/
$("#accordion").accordion('activate', accordionindex); 
```

但我需要将其提升到下一个级别并“单击”该项目，然后该项目将导致浏览器导航。

谢谢你，斯蒂芬

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:55:18.020

未经测试的代码：

```
$("#messagesNavItems a[href$='Outbox']").click(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T18:01:34.933

好吧，我必须在应得的地方给予一些功劳，感谢 kannix，他建议在选择器上使用 click 方法，但在我的情况下，无论出于何种原因，它仍然没有激活链接并导致导航发生。

我最终要做的是首先将点击事件绑定到锚点

```
 $("#messagesNavItems a[href$='Inbox']").on('click', function() {
        alert('Inbox was clicked');
        window.location.href = $(this).attr("href");
    }); 
```

它确实响应了来自 jQuery Accordion 外部的程序化点击。

这是首先设置要打开的右侧面板的所有相关代码，然后单击并点击链接。

```
$(function () {

    $("#messagesNavItems a[href$='Inbox']").on('click', function() {
        window.location.href = $(this).attr("href");
    });

    $('iframe').load(function () {

        $(this).contents().find("a[href='messages/list.asp?pjid=&box=in&sf=mesibox']").click(function (event) {
            event.preventDefault(); /* the frame link we are clicking shound not navigate */
            var accordionindex = 5; /*Messages*/
            $("#accordion").accordion('activate', accordionindex);
            $("#messagesNavItems a[href$='Inbox']").click();
        });
    });    
}); 
```

# jquery - Primefaces UI 组件需要从 jQuery 获取值，而不是从服务器（托管 bean）获取

> ID：12117616
> 
> 赞同：0
> 
> 时间：2012-08-24T22:50:42.947
> 
> 标签：jquery, jsf, jsf-2, primefaces

我想知道primefaces UI是否可以使用jQuery中的值。例如，我已将值数组放入“imgArray”中，现在我想将其显示在 p:datalist 中。

**jQuery**

```
$.getJSON("http://xxxx?url="+ url,function(data){
    var imageArray=[];
    imageArray=data.images;
      $("formId:dataTable).html(imageArray); 
```

**用户界面**

```
<p:datalist id="dataTable" value= /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:54:44.543

我相信这是不可能的。JSF 页面呈现在服务器端。`values`必须引用元素集合。

使用基于 Java 的解决方案来创建所提供 JSON 的集合。

# ruby - 机械化和提交文本区域的问题

> ID：12117619
> 
> 赞同：0
> 
> 时间：2012-08-24T22:51:11.333
> 
> 标签：ruby, mechanize, www-mechanize, mechanize-ruby

因此，我正在尝试提交一个简单的表单，该表单具有一个与此类似的文本区域

```
"Lots of stuff that doesn't matter
a couple of lines later
agent => A5656,,5665" 
```

我正在尝试做的是与代理断开连接。顺便说一句，这个文件中有很多“代理”行，这并不重要。无论如何，这是我的代码：

```
new_agent = @elastix.get https://#{@elastix_ip}/index.phpmenu=file_editor&action=edit&file=agent.conf                                                                                                                                      
   new_agent_form = new_agent.forms.first                                                            
   settings = new_agent_form['content']                                                              
   new_agent_form['content'] = settings.gsub(/agent => #{options[:ext]},,#{options[:UserID]}/,'')                                                               
   new_agent_form.encoding = "utf-8"                                                                
   @elastix.submit(new_agent_form,new_agent_form.button_with(:name => "Guardar")) 
```

没有抛出错误，如果我`"raise new_agent_form.content.inspect"`在提交之前显示文本区域不包含我想要的条目。出于某种原因，要么这不起作用，要么我错过了一些东西。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:08:07.563

问题已解决。这与有许多名称 = 名称的 div 标签有关。他们这样做的原因是什么，我不知道。但是您可以放心，mechanize 可以正常工作。

# ruby - 山狮的 RVM 问题

> ID：12117626
> 
> 赞同：3
> 
> 时间：2012-08-24T22:51:38.293
> 
> 标签：ruby, rvm

我可以在运行 Mountain Lion 的 Mac 上安装任何 Ruby 版本

我已经确保 Brew Doctor 一切正常。

当我运行 ie rvm intall 1.9.3-head 时，我得到以下信息。

```
From git://github.com/ruby/ruby
 * branch            ruby_1_9_3 -> FETCH_HEAD
Already up-to-date.
Copying from repo to src path...
ruby-1.9.3-head - #autoreconf
ruby-1.9.3-head - #configuring 
ruby-1.9.3-head - #compiling 
Error running 'make', please read /Users/lee/.rvm/log/ruby-1.9.3-head/make.log
There has been an error while running make. Halting the installation.
lee$ mate /Users/lee/.rvm/log/ruby-1.9.3-head/make.log 
```

这是 make.log [http://pastie.org/private/wt48jlhlng9tgbdgqap8q](http://pastie.org/private/wt48jlhlng9tgbdgqap8q)

请任何人都可以建议。看起来MD5是问题？？我不是命令行专家，所以任何帮助都会很棒。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T00:02:49.273

检查这个答案[https://stackoverflow.com/a/10540282/497756](https://stackoverflow.com/a/10540282/497756)

要点是：

```
rvm pkg install openssl 
```

进而：

```
rvm reinstall 1.9.3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T23:16:42.590

尝试以下操作：

*   更新 Xcode，获取适用于 Lion 的版本并再次运行该命令。

*   使用安装：

    > rvm 安装 1.9.3 --with-gcc=clang

*   安装 GCC 4.2 并尝试：

    > rvm 安装 1.9.3 --with-gcc=gcc-4.2

希望其中之一能奏效。

# css - 在 CSS ID 命名约定中混合下划线和破折号（连字符）可以吗？

> ID：12117628
> 
> 赞同：3
> 
> 时间：2012-08-24T22:51:47.557
> 
> 标签：css, html, naming-conventions

我已向我的团队建议我们使用破折号（连字符）作为我们的类名，但对于 ID，使用下划线将元素标签与 ID 名称的其余部分分开，并且 ID 名称应该是#element_class-name，所以： `<div id="div_generic-name" class="generic-name">Stuff</div>` 这个方法有错误吗？如果我们混合使用下划线和连字符，会发生什么坏事？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T03:32:48.697

是的，这没问题。根据[W3C](http://www.w3.org/TR/CSS21/syndata.html#characters)，命名 CSS 类的前两条规则是：

*   除了不受 CSS 控制的部分之外，所有 CSS 语法在 ASCII 范围内都不区分大小写（即 [az] 和 [AZ] 是等效的）。例如，HTML 属性“id”和“class”、字体名称和 URI 的值的大小写敏感性超出了本规范的范围。请特别注意，元素名称在 HTML 中不区分大小写，但在 XML 中区分大小写。
*   在 CSS 中，标识符（包括选择器中的元素名称、类和 ID）只能包含字符 [a-zA-Z0-9] 和 ISO 10646 字符 U+00A0 及更高，加上连字符 (-) 和下划线 ( _); 它们不能以数字、两个连字符或一个连字符后跟一个数字开头。标识符还可以包含转义字符和任何 ISO 10646 字符作为数字代码（请参阅下一项）。例如，标识符“B&W？” 可以写成“B\&W\?” 或“B\26 W\3F”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T03:29:33.383

做你想做的事没有问题。引号之间的任何内容都不会被浏览器解析，只会被视为字符串并且不会被解释。

# r - 使用 xlsx 包保存 data.frame 时如何避免写入 row.names 列

> ID：12117629
> 
> 赞同：18
> 
> 时间：2012-08-24T22:52:16.973
> 
> 标签：r, dataframe, xlsx

我有一个像下面这样的数据框，当我使用 xlsx 包将其导出到 excel 文件时，我真的想删除行名。

```
bd <- data.frame(id = 1:200, A = c(rep("One", 100), rep("Two", 100)), 
             B = c(rep(1,50), rep(0, 50), rep(1, 50), rep(0, 50))) 
```

我已经尝试使用下面的命令，但它将它们保留在 excel 文件的第一列中。

```
bd <- data.frame(id = 1:200, A = c(rep("One", 100), rep("Two", 100)), 
             B = c(rep(1,50), rep(0, 50), rep(1, 50), rep(0, 50)), row.names=NULL) 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-24T22:59:14.323

将行名设置为`NULL`以删除它们：

```
rownames(bd) <- NULL 
```

此外，来自 xlsx 文档：

```
write.xlsx(x, file, sheetName="Sheet1",
           col.names=TRUE, row.names=TRUE, append=FALSE) 
```

将 row.names 设置为`FALSE`以避免第一列是行名。

# c++ - 为什么我不能将 unique_ptr 与函数返回的 unique_ptr 交换？

> ID：12117630
> 
> 赞同：2
> 
> 时间：2012-08-24T22:52:17.543
> 
> 标签：c++, visual-studio-2012, unique-ptr

以下代码将引发警告：

警告 C4239：使用了非标准扩展：'argument'：从 'std::unique_ptr<_Ty>' 转换为 'std::unique_ptr<_Ty> &'

```
std::unique_ptr<T> foo() { return std::unique_ptr<T>( new T ); }
std::unique_ptr<T> myVar;
myVar.swap(foo()); 
```

我想知道处理这种情况的正确方法是什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-24T22:54:13.810

的`swap`成员函数`std::unique_ptr`采用非常量左值引用，表达式`foo()`是右值，作为`foo`返回对象的函数（与引用相反）。您不能将右值绑定到非常量左值引用。

请注意，您可以通过其他方式进行交换：

```
foo().swap(myVar); 
```

更简单的做法是直接初始化：

```
std::unique_ptr<T> myVar(foo()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:54:48.463

`std::unique_ptr::swap`对另一个指针进行非`const`引用。您不能将 r 值绑定到非常量引用，尽管 VC++ 通过非标准扩展允许这样做。因此发出警告。

要消除警告，请将 的返回值存储`foo`在变量中然后交换，或者颠倒交换的顺序。

```
foo().swap( myVar ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T22:55:08.333

你正试图换成临时的。你可以试试这个：

```
std::unique_ptr<T> foo() { return std::unique_ptr<T>( new T ); }
std::unique_ptr<T> myVar1;
std::unique_ptr<T> myVar2 = foo();
myVar1.swap(myVar2); 
```

**请注意**，这不是特定于`std::unique_ptr`. 出于同样的原因，以下内容将是非法的：

```
void foo(std::string& s) { .... }
std::string bar() { .... }

foo(bar()); 
```

# java - 制作一个聪明的监听器通知器以避免到处重复代码

> ID：12117636
> 
> 赞同：2
> 
> 时间：2012-08-24T22:52:40.227
> 
> 标签：java, algorithm, data-structures, collections, arraylist

**注意：**代码是线程安全的，换句话说，是单线程的。只有我可以将自己从听众名单中删除。

我有 1000 个不同的 ArrayLists 侦听器，我必须使用如下代码通知它们：

```
protected void onFlushed() {
    int size = listeners.size();
    for (int i = 0; i < size; i++) {
        listeners.get(i).onFlushed();
        int newSize = listeners.size();
        if (newSize == size - 1) {
            size--;
            i--;
        } else if (newSize != size) {
            throw new ConcurrentModificationException("List was altered while iterating! oldSize=" + size + " newSize=" + newSize);
        }
    }
} 
```

有没有一种聪明的方法来创建一个 Notifier 类，它可以采用任何 ArrayList 的侦听器以及任何侦听器方法并为我执行下面的逻辑，或者我必须为每个侦听器方法在任何地方复制上面的代码？

我对 Java 的要求太多了吗？:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:18:59.440

首先，我有点担心大部分代码似乎都在以一种不太安全的方式处理并发问题。考虑对访问相同侦听器列表的任何代码进行一些锁定。这样，您可以将此代码简化为：

```
protected void onFlushed() {
    synchronized(listeners) {
        for (FlushListener listener : listeners) {
            listener.onFlushed();
        }
    }
} 
```

在您的代码周围重复这并不是太糟糕。话虽如此，如果出于某种原因您需要那里的逻辑，您可以创建一个类似这样的类：

```
import java.util.ArrayList;
import java.util.ConcurrentModificationException;

public class Notifier<T> {
    public static interface NotificationRunnable<T> {
        public void notify(T t);
    }

    private ArrayList<T> listeners;
    public Notifier() {
        listeners = new ArrayList<T>();
    }

    public void addListener(T t) {
        listeners.add(t);
    }

    public void notifyAll(NotificationRunnable<T> nr) {
        int size = listeners.size();
        for (int i = 0; i < size; i++) {
            nr.notify(listeners.get(i));
            int newSize = listeners.size();
            if (newSize == size - 1) {
                size--;
                i--;
            } else if (newSize != size) {
                throw new ConcurrentModificationException("List was altered while iterating! oldSize=" + size + " newSize=" + newSize);
            }
        }
    }
} 
```

然后调用它的代码如下所示：

```
Notifier<FlushListener> notifier = new Notifier();
notifier.addListener(new FlushListener());

public void onFlushed() {
    notifier.notifyAll(new NotificationRunnable<FlushListener>(){
        public void notify(FlushListener t) {
            t.onFlushed();
        }
    });
} 
```

甚至在实际方法中将其简化为一行：

```
NotificationRunnable<FlushListener> flushRunnable = new NotificationRunnable<FlushListener>(){
    public void notify(FlushListener t) {
        t.onFlushed();
    }
}

public void onFlushed() {
    notifier.notifyAll(flushRunnable);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T23:21:23.800

在当前的 Java 中，无法像在函数式语言中那样传递方法，但是您可以创建`Function<Domain, Range>`接口并传递实现该接口的对象。

您可能会考虑使用[Guava](http://code.google.com/p/guava-libraries/)，它提供了一些类似于功能习语和列表理解的东西。

# spring-mvc - 从视图中省略 ModelAttribute

> ID：12117637
> 
> 赞同：3
> 
> 时间：2012-08-24T22:52:42.800
> 
> 标签：spring-mvc, modelattribute

我有一个返回 json/xml 的休息应用程序。我使用 jackson 和 jaxb 进行转换。有些方法需要接受一个 query_string。我已经使用 @ModelAttribute 将 query_string 映射到一个对象中，但这会强制该对象进入我的视图。我不希望对象出现在视图中。

我想我需要使用@ModelAttribute 以外的东西，但我不知道如何进行绑定，但不修改视图。如果我省略了@ModelAttribute 注释，该对象将作为变量名出现在视图中（例如：“sourceBundleRequest”）。

示例网址：

```
http://localhost:8080/rest/sourcebundles/?updateDate=20100501&label=urgent 
```

控制器方法：

```
@RequestMapping(value = {"", "/"}, method = RequestMethod.GET)
public String getAll(@ModelAttribute("form") SourceBundleRequest sourceBundleRequest, BindingResult result, ModelMap model) throws ApiException {
    // Detect and report errors.
    if (result.hasErrors()) {
       // (omitted for clarity)
    }

    // Fetch matching data.
    PaginatedResponse<SourceBundle> sourceBundleResponse = null;
    try {
        int clientId = getRequestClientId();
        sourceBundleResponse = sourceBundleService.get(clientId, sourceBundleRequest);
    } catch (ApiServiceException e) {
        throw new ApiException(ApiErrorType.INTERNAL_ERROR, "sourceBundle fetch failed");
    }

    // Return the response.
    RestResponse<PaginatedResponse> restResponse = new RestResponse<PaginatedResponse>(200, "OK");
    restResponse.setData(sourceBundleResponse);
    model.addAttribute("resp", restResponse);
    // XXX - how do I prevent "form" from appearing in the view?
    return "restResponse";
} 
```

示例输出：

```
"form": {
    "label": "urgent",
    "updateDate": 1272697200000,
    "sort": null,
    "results": 5,
    "skip": 0
},
"resp": {
    "code": 200,
    "status": "OK",
    "data": {
        "totalAvailable": 0,
        "resultList": [ ]
    }
} 
```

期望的输出：

```
"resp": {
    "code": 200,
    "status": "OK",
    "data": {
        "totalAvailable": 0,
        "resultList": [ ]
    }
} 
```

**省略 @ModelAttribute("form")**

如果我简单地省略 @ModelAttribute("form")，我仍然会得到不希望的响应，但传入的表单是由对象名称命名的。响应如下所示：

```
"resp": {
    "code": 200,
    "status": "OK",
    "data": {
        "totalAvailable": 0,
        "resultList": [ ]
    }
},
"sourceBundleRequest": {
    "label": "urgent",
    "updateDate": 1272697200000,
    "sort": null,
    "results": 5,
    "skip": 0
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T02:49:35.963

如果您不希望表单返回视图，则`SourceBundleRequest`无需使用 @ModelAttribute 注释表单，即使没有 @ModelAttribute 注释，它也会干净利落地绑定。

现在，使用 Spring MVC 返回 JSON/XML 响应的标准方法是直接返回类型（在您的情况下为`PaginatedResponse`），然后使用 注释该方法`@ResponseBody`，然后底层`HttpMessageConverter`将基于 Accept 将响应转换为 XML/JSON来自客户端的标头。

```
@ResponseBody
public RestResponse<PaginatedResponse> getAll(SourceBundleRequest sourceBundleRequest, BindingResult result, ModelMap model)
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T21:41:44.240

不知何故，我错过了解决此问题的最明显方法。我专注于属性，忘记了我可以只修改底层地图。

```
 // Remove the form object from the model map.
  model.remove("form"); 
```

按照 Biju 的建议，省略 @ModelAttribute 然后删除 sourceBundleRequest 对象可能会更有效一些。我怀疑 @ModelAttribute 有一些额外的开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-27T20:04:52.120

使用@JsonIgnore 怎么样？

```
@ModelAttribute("foo")
@JsonIgnore
public Bar getBar(){} 
```

没有测试过这个

# html - Selenium WebDriver 不适用于 Html5 拖放

> ID：12117640
> 
> 赞同：0
> 
> 时间：2012-08-24T22:53:05.197
> 
> 标签：html, drag-and-drop, webdriver

下面是我正在使用的代码，它将访问一个使用 Html5 编写的公共网站，该代码试图将“One”拖到垃圾箱，但它没有做任何事情。有什么解决方法可以让它工作吗？提前致谢！

```
 FirefoxProfile profile = new FirefoxProfile();
    profile.setEnableNativeEvents(true);
    WebDriver driver = new FirefoxDriver(profile);
    driver.get("http://html5demos.com/drag");

    WebElement draggable = driver.findElement(By.id("one"));
    WebElement droppable = driver.findElement(By.id("bin"));

    new Actions(driver).dragAndDrop(draggable, droppable).build().perform(); 
```

附加信息是：

Selenium 版本：2.25.0 操作系统：Mac OS Lion 浏览器：Firefox 浏览器版本：10.0.2 和 14.0.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T12:11:09.407

我会冒险说这是某种兼容性问题。[我在http://jqueryui.com/demos/draggable/](http://jqueryui.com/demos/draggable/)上使用了以下代码

```
System.setProperty("webdriver.ie.driver","C:\\IEDriverServer.exe");
WebDriver driver = new InternetExplorerDriver();
driver.get("http://jqueryui.com/demos/draggable/");
WebElement draggable = driver.findElement(By.id("draggable"));
new Actions(driver).dragAndDropBy(draggable, 200, 10).build().perform(); 
```

它在 IE9 上就像一个魅力。但是它不适用于我的 Firefox 14，这可能是“新的”。

您还可以尝试使用 JavaScriptExecutor 的一些解决方法，如下所述：[HTML5 Drag and Drop using Selenium Webdriver for Ruby](https://stackoverflow.com/questions/9797462/html5-drag-and-drop-using-selenium-webdriver-for-ruby)

# vim - 如果我没有输入与插入的自动标签一致的任何内容，Vim 会删除自动标签

> ID：12117641
> 
> 赞同：3
> 
> 时间：2012-08-24T22:53:07.673
> 
> 标签：vim

一个很简单的例子：我想写一个函数，已经有好几级缩进（“函数”这个词之前的制表符）。我先写：

```
1     function doCoolStuff() {
2 
3     } 
```

然后从第 3 行上升到第 2 行并开始输入函数的内容。但是，vim 不允许我在第 3 行键入括号并向上移动一行后删除第 2 行的自动插入选项卡。因此，每次编写新函数时，我都必须手动插入选项卡。事情是这样的：

当我输入函数的头部并按回车时，它看起来像这样：

```
1     function doCoolStuff() {
2     ▊
3 
```

Vim 在第 2 行正确插入自动制表符。

**但！**

然后我按 Enter 键，键入右括号并向上移动一行。**我希望它是这样的：**

```
1     function doCoolStuff() {
2     ▊
3     } 
```

**但结果是这样的，第 2 行没有任何选项卡：**

```
1     function doCoolStuff() {
2 ▊
3     } 
```

似乎是 vim 看到有一行完全由制表符组成并删除了制表符。如何禁止 vim 删除尾随制表符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T23:08:50.407

答案是在该行输入一些内容并再次删除它，因为在这种情况下 ViM*不会*自动删除制表符：

```
:inoremap <CR> <CR>x<BS> 
```

做这项工作。有关更多信息，请参阅[此](https://stackoverflow.com/a/7413117/589206)线程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-24T23:19:42.450

您所看到的很可能是某种[autoindent 或 cindent](http://vim.wikia.com/wiki/Indenting_source_code#Methods_for_automatic_indentation)的结果。在您输入内容之前，那里实际上没有任何选项卡或空格。因此，当您离开该行时，它实际上并没有剥离制表符或空格，因为它一开始就不存在。

我通常做的是向上移动到我要开始输入的行，然后按下`o`以在下一行开始编辑（并且自动缩进会正确处理定位）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T07:55:46.913

您可以在类似问题上使用 DelimitMate 或其他一些自动配对脚本或类似[我的这个答案。](https://stackoverflow.com/a/12112286/546861)

# android - 为 OCR 校正和过滤图像

> ID：12117644
> 
> 赞同：3
> 
> 时间：2012-08-24T22:53:32.933
> 
> 标签：android, ocr, tesseract

我做了很多研究，但没有找到合适的解决方案。我正在编写一个 Android OCR 应用程序。我已经成功加载了 Tesseract 和 Leptonica，并且我正在成功地拍摄和处理图像，并使用 OCR 将它们转换为文本。但是，识别准确率不是很好。

经过多次调整后，我们发现我们没有对图像进行足够的过滤、清理和/或纠偏以帮助 Tesseract 进行 OCR 处理。因此，我在互联网上寻找任何对我有用的库或代码，但在 Android 上使用它却无济于事。

有谁知道图书馆或可以为我提供一些代码来帮助我完成这项工作？我想要的只是获取一张位图，将其转换为黑白，去偏斜和/或执行一些过滤任务，然后将其交给 Tesseract，让它使用 OCR 将其转换为文本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T00:55:14.287

ImageMagick 可以做到这一点。命令行：

```
convert                              \
    input.{png,pdf,tif,jpeg,gif,...} \
   -colorspace grayscale             \
   -threshold 50%                    \
   -deskew                           \
    output.{png,pdf,tif,jpeg,gif,...} 
```

**`-colorspace grayscale`**: 也有助于处理彩色输入。
**`-threshold 50%`**：玩百分比值——但基本上它只转换为黑+白。
**`-deskews`**: 歪斜

但是，我不确定为 Android 平台构建 ImageMagick 的难易程度。它适用于 Linux、Mac OS X、Windows、Solaris、HP-UX，......所以：无论如何，它都是多平台设计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-31T09:54:16.950

我使用下面的方法将我的图像转换为黑白图像，这极大地帮助我提高了准确性。

```
 private Bitmap GetBinaryBitmap(Bitmap bitmap_src) {
    Bitmap bitmap_new = bitmap_src.copy(bitmap_src.getConfig(), true);

    for (int x = 0; x < bitmap_new.getWidth(); x++) {
        for (int y = 0; y < bitmap_new.getHeight(); y++) {
            int color = bitmap_new.getPixel(x, y);
            color = GetNewColor(color);
            bitmap_new.setPixel(x, y, color);
        }
    }

    return bitmap_new;
}

private double GetColorDistance(int c1, int c2) {
    int db = Color.blue(c1) - Color.blue(c2);
    int dg = Color.green(c1) - Color.green(c2);
    int dr = Color.red(c1) - Color.red(c2);

    double d = Math.sqrt(Math.pow(db, 2) + Math.pow(dg, 2) + Math.pow(dr, 2));
    return d;
}

private int GetNewColor(int c) {
    double dwhite = GetColorDistance(c, Color.WHITE);
    double dblack = GetColorDistance(c, Color.BLACK);

    if (dwhite <= dblack) {
        return Color.WHITE;

    } else {
        return Color.BLACK;
    }
} 
```

希望能帮助到你。

# git - Git - 删除提交

> ID：12117650
> 
> 赞同：1
> 
> 时间：2012-08-24T22:54:18.090
> 
> 标签：git, github, revert

几个月前，我在 Github 上创建了一个 repo，并提交了 3 次。我想向原始项目提交包含一些错误修复的拉取请求，但其中一个提交有一些不适用于他们的更改。

我到底该如何解决这个问题？我来自 svn 背景，所以大多数术语等具有我所期望的非常不同的含义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:01:33.503

创建一个只包含您想要的更改的新分支，并从该分支而不是您的主分支提交拉取请求。Doing`git branch origin my-new-branch-name`将创建一个新的分支，您可以在没有对工作进行任何更改的情况下进行工作。然后`git checkout my-new-branch-name`将开始工作。然后使用例如应用您的更改`git cherry-pick my_commit_id_1 my_commit_id_1`。最后`git push ssh://remote.host/path/to/repo my-new-branch-name`将其推送到您可以从中发出拉取请求的服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T23:07:55.713

要摆脱提交，您可以执行以下操作。

*   运行`git log`以获取您想要摆脱的提交的哈希值
*   运行`git rebase --interactive abc123^`，其中 abc123 是错误提交的哈希
*   从编辑器中弹出的列表中删除错误提交（删除包含该提交的行：保留其他行）
*   保存并关闭编辑器，Git 会将所有后续提交重新定位到错误提交的父级

# python - GAE / Python / jinja2 / 如何在join语句中引用子目录

> ID：12117658
> 
> 赞同：1
> 
> 时间：2012-08-24T22:55:16.803
> 
> 标签：python, google-app-engine, django-templates, jinja2

我的根目录的子目录“static”中有一个 html 文件“listagem.html”。我想使用“listagem.html”作为 jinja2 的模板。

我尝试了这 3 个连接公式：

第一的：

```
jinja_environment = jinja2.Environment(
    autoescape = True, 
    loader =  jinja2.FileSystemLoader(os.path.join(os.path.dirname(__file__), 'static'))) 
```

第二：

```
jinja_environment = jinja2.Environment(
    autoescape = True, 
    loader =  jinja2.FileSystemLoader(os.path.join(os.path.dirname(__file__), 'static/'))) 
```

第三：

```
jinja_environment = jinja2.Environment(
    loader = jinja2.FileSystemLoader(os.path.join(os.path.dirname(__file__), '/static')))
        template = jinja_environment.get_template('listagem.html')
        self.response.out.write(template.render(template_values)) 
```

并收到此错误：

```
file not accessible: 'C:\\Users\\Me\\AppEngine\\MyAppRoot\\static\\listagem.html' 
```

我究竟做错了什么？

坦克寻求帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T23:41:26.340

您可能已经`static_dir`在文件中添加了一个 url 处理程序，`app.yaml`并将您`static`的目录（模板所在的位置）设置为`static_dir`.

这会使您的文件无法访问，因为[静态文件在应用程序的文件系统中不可用](https://developers.google.com/appengine/docs/python/config/appconfig#Static_File_Handlers)。

`static_dir`从文件中删除`app.yaml`并在您的项目文件夹中添加一个静态模板文件夹。

创建一个jinja环境如下：

```
jinja_environment = jinja2.Environment(autoescape=True,
    loader=jinja2.FileSystemLoader(os.path.join(os.path.dirname(__file__), 'static'))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-19T16:28:20.783

you have a mistake. 1\. in your appengine config file, you need same code like that:

```
application: yourapp
version: 1
runtime: python27
api_version: 1
threadsafe: yes

handlers:
- url: /favicon\.ico
  static_files: favicon.ico
  upload: favicon\.ico
- url: /js
  static_dir: static/js
- url: /css
  static_dir: static/css
- url: /img
  static_dir: static/img  
- url: .*
  script: main.app

libraries:
- name: webapp2
  version: latest
- name: jinja2
  version: latest 
```

look that "- url items"... this is for your static content( js css img ) for your html template, you need a subfolder template son of your root-app, in my case is myapp/template and inside put your template( templates content, html )

your main app look like that. main.py

```
import os
import webapp2
import jinja2

jinja_environment = jinja2.Environment(autoescape=True,
    loader=jinja2.FileSystemLoader(os.path.join(os.path.dirname(__file__), 'templates')))

class MainHandler(webapp2.RequestHandler):
    def get(self):
        template_values = {
            'name': 'nombre',
            'verb': 'programando'
        }

        template = jinja_environment.get_template('index.html')
        self.response.out.write(template.render(template_values))    

app = webapp2.WSGIApplication([
    ('/', MainHandler)
], debug=True) 
```

# java - 如何轻松打印数组？

> ID：12117665
> 
> 赞同：4
> 
> 时间：2012-08-24T22:56:04.483
> 
> 标签：java, arrays

我目前正在使用数组，每次我需要打印一个时，我都会执行一个 for 循环。

```
System.out.print("[");
for(int i = 0; i < arr.length; i++){
    System.out.print(arr[i] + ", ");
}
System.out.println("]"); 
```

这似乎是一个将内置到 java 中的功能（我正在使用 java）。是否有内置的方法来打印数组？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-24T22:58:05.030

您可以使用： `Arrays.toString(arr)` 用于普通数组和/或 `Arrays.deepToString(arr)` 数组中的数组。这两种方法都返回数组的字符串表示形式。

有关更多信息，请参阅[数组文档](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-24T22:57:59.527

```
System.out.println(Arrays.toString(arr)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T23:44:36.690

您也可以编写自己的方法来做同样的事情`Arrays.toString()`：

```
/** Converts an array into a CSV string. */

public static <T> String arrayToCsv(T[] someArray) {

    if (someArray == null || someArray.length == 0) {
        return "";
    }

    StringBuilder csv = new StringBuilder();

    for (T thisT : someArray) {
        String val = (thisT == null) ? "null" : thisT.toString();
        csv.append(val).append(", ");
    }

    return csv.toString();
} 
```

测试它：

```
Double[] doubleArray = { 2.4, 3.6, 6.5 };
String[] stringArray = { "foo", "bar", "baz" };

System.out.println(arrayToCsv(doubleArray));
System.out.println(arrayToCsv(stringArray)); 
```

# php - php页面全白

> ID：12117668
> 
> 赞同：1
> 
> 时间：2012-08-24T22:56:36.880
> 
> 标签：php

> **可能重复：**
> [如何在 PHP 中获取有用的错误消息？](https://stackoverflow.com/questions/845021/how-to-get-useful-error-messages-in-php)

我正在研究一个网站的 PHP，每次我将任何 PHP 放入代码中时，整个页面都是白色的并且拒绝编译。

现在我做了我能想象的最基本的事情，在这个页面上：[http ://www.trulyscience.com/test/PDO.php](http://www.trulyscience.com/test/PDO.php)

```
<?php
phpinfo();
?> 
```

我认为它必须是服务器端问题，（以前从未在此域上运行过 php）但我的主机只是告诉我我必须有代码错误。

所以我的问题是，有什么办法可以查看发生了什么？（遗憾的是，phpinfo 不是一个选项）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T23:41:13.930

因此，当人们偶然发现这个问题时，它不会被埋没在评论中：

这就是为什么给你一个空白页，主机禁用它和错误报告。他们的 PHP 似乎运行良好。他们只是有一个非常偏执的设置。

PHP不仅具有关闭错误报告的能力，还具有抑制特定功能运行的能力。一个很好的绝对最小的代码来测试`<?php echo 'Hi'; ?>`

您可以使用`ini_set('display_errors', true); error_reporting(E_ALL);`. 当然，有了这个，一些编译错误的页面可能会给你一个空白页。您可以要求您的主机打开错误报告，或者让他们将您指向一个解释如何打开它的页面，例如 via，`.htaccess`因为您使用的是 Apache。如果你真的需要`phpinfo`，你可以问同样的问题。

# python - python从arduino读取串行输出

> ID：12117669
> 
> 赞同：4
> 
> 时间：2012-08-24T22:57:01.660
> 
> 标签：python, python-2.7, serial-port

我有一个连接了 2 个`DS18B20`温度传感器的 Arduino。我对python非常（非常）新。我正在寻找一种读取串行输入并将其解析为 sqlite 数据库的方法，但这超出了我自己。为什么在尝试将我的串行端口定义为变量时出现错误？

第一件事`sys.version`

```
2.7.1 (r271:86832, Jul 31 2011, 19:30:53) 
[GCC 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00)] 
```

我的当前，只是从串行连接程序中读取输入。

```
from serial import serial
import time

# open serial port
ser = serial.Serial('/dev/tty.usbmodem621',9600,timeout=2) 
ser.open()

while True:
    print('dev 0' + ser.read())     
    pass

ser.close() 
```

我目前无法编译它。我发现的这个错误的大多数结果都告诉 add `from serial import serial`，但在这种情况下它没有工作。

错误。

```
$ python ser.py
Traceback (most recent call last):
  File "ser.py", line 1, in <module>
    from serial import serial
  File "/Users/frankwiebenga/serial.py", line 8, in <module>
AttributeError: 'module' object has no attribute 'Serial' 
```

另外，如果我只是使用`import serial`我会得到同样的错误

```
$ python ser.py
Traceback (most recent call last):
  File "ser.py", line 1, in <module>
    import serial
  File "/Users/frankwiebenga/serial.py", line 8, in <module>
AttributeError: 'module' object has no attribute 'Serial' 
```

另外，根据评论。创建了名为的新文件`something.py`，但无论使用`import serial`or ，仍然会出现相同的错误`from serial import serial`。

```
$ python something.py 
Traceback (most recent call last):
  File "something.py", line 1, in <module>
    from serial import serial
ImportError: No module named serial 
```

运行我的 bash 脚本时，我得到一个有效的输出，所以我知道它不是 Arduino 代码。

输出：

```
Requesting temperatures...DONE
Device 0: 25.62
Device 1: 25.75
Requesting temperatures...DONE
Device 0: 25.62
Device 1: 25.81 
```

重击：

```
while true  # loop forever
do
   inputline="" # clear input

   # Loop until we get a valid reading from AVR
   until inputline=$(echo $inputline | grep -e "^temp: ")
   do
      inputline=$(head -n 1 < /dev/tty.usbmodem621)
   done
   echo "$inputline"
done 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T23:22:04.300

你可以这样做：

```
from serial import Serial

s = Serial(...) 
```

或者：

```
import serial

s = serial.Serial(...) 
```

选一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T23:02:28.353

你需要使用`import serial`. `serial`是模块的名称，它不包含带有 name 的属性`serial`。

[http://pyserial.sourceforge.net/shortintro.html#opening-serial-ports](http://pyserial.sourceforge.net/shortintro.html#opening-serial-ports)

# objective-c - 使用 respondsToSelector 的性能损失

> ID：12117670
> 
> 赞同：3
> 
> 时间：2012-08-24T22:57:14.970
> 
> 标签：objective-c, ios, xcode, performance, respondstoselector

当 JSON 响应具有无效值时，我将重构许多旧代码，以使客户端对错误的服务器响应和日志异常更加健壮，并且我正在考虑使用 respondsToSelector 检查每个节点的有效性（数据类型）。

我正在检查响应中的数据类型（int、bool 等）

```
[[json objectForKey: @"feature_enabled"] boolValue], 
```

如果 @"feature_enabled" 节点的值不是 0 或 1，则应用程序会崩溃

为了解决这个问题，我会这样做

```
if ([[json objectForKey: @"feature_enabled"] respondsToSelector: @selector(boolValue)]){
          BOOL featureEnabled = [[json objectForKey: @"feature_enabled"] boolValue];
}else{
          Log Exception
} 
```

我没有对此代码进行任何类型的性能分析，但我想知道是否有人可以建议如果我要检查对我打算解析的每个 JSON 响应的选择器的响应，我应该期望什么样的性能损失.

任何指向信息来源的指针表示赞赏！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-25T01:34:13.213

`respondsToSelector:`检查为零。它不是空的，它调用[IMP lookUpMethod(Class cls, SEL sel, BOOL initialize, BOOL cache, id inst)](http://www.opensource.apple.com/source/objc4/objc4-532/runtime/objc-class.mm)从 IMP 缓存中返回方法（使用[CacheLookup](http://www.opensource.apple.com/source/objc4/objc4-437.1/runtime/Messengers.subproj/objc-msg-x86_64.s)宏）。如果没有找到，它会尝试填充缓存，在类本身中查找方法，这涉及对超类重复操作。如果失败，它将运行[转发机制](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtForwarding.html#//apple_ref/doc/uid/TP40008048-CH105-SW2)。

`isKindOfClass:` compares the isa pointers of both classes. If that fails, it repeats with the superclass, which is just the field 'super_class' in the [struct objc_class](http://www.opensource.apple.com/source/objc4/objc4-532/runtime/runtime.h).

So the proper way to distinguish between two objects is `isKindOfClass:`.

Note that processing your JSON data will be gazillion times slower than everything above. Not finding a selector doesn't bring the system to a halt or anything.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-24T23:05:42.727

您可能需要考虑使用 isKindOfClass 我认为这是最好的性能：

if([[yourDictionary objectForKey:@"yourKey"] isKindOfClass:[NSArray class]]) { //假设它是一个数组并处理它 }

# java - GAE：关于目标“enhance_war”中的“api”属性

> ID：12117672
> 
> 赞同：1
> 
> 时间：2012-08-24T22:57:23.800
> 
> 标签：java, google-app-engine, datanucleus

[JPA 2.0](https://developers.google.com/appengine/docs/java/datastore/jpa/overview-dn2#Setting_Up_JPA_2_0)的GAE 文档指出`enhance_war`ant 文件的目标应该是：

```
 <target name="datanucleusenhance" depends="compile"
  description="Performs enhancement on compiled data classes.">
  <enhance_war war="war">
          <args>
          <arg value="-enhancerVersion"/>
          <arg value="v2"/>
      </args>
  </enhance_war> 
```

但是，我们可以在以下位置找到`ant-macros.xml`：

```
<attribute name="api" description="persistence api, JDO or JPA" default="JDO"/> 
```

这是正确的，即我们不应该指定 JPA 的用法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T18:59:54.307

有趣的是，在 Ant 部分查看[DataNucleus 文档](http://www.datanucleus.org/products/datanucleus/enhancer.html)，我读到：

`api Optional. Defines the API to be used when enhancing JDO, JPA`

并且 JDO 是默认设置，我会在需要时将其指定为 JPA，即使它似乎仍然可以工作。

在我看来，宏并没有增加很多价值，所以我决定直接在我的配置中集成增强任务，所以我只能选择以 Entity 结尾的类，而不是让 datanucleus 检查每个类。

```
<target name="-datanucleusenhance" depends="compile"
        description="Performs enhancement on compiled data classes">
    <enhance failonerror="true" api="JPA">
        <arg value="-enhancerVersion"/>
        <arg value="v2"/>
        <classpath>
            <pathelement path="${main.classes.dir}"/>
            <pathelement path="${sdk.dir}/lib/appengine-tools-api.jar"/>                
        </classpath>
        <fileset dir="${war.dir}/WEB-INF/classes" includes="**/*Entity.class"/>
    </enhance>
</target> 
```

让我知道你在此期间发现了什么！

# django - django模型清理方法属于什么

> ID：12117673
> 
> 赞同：2
> 
> 时间：2012-08-24T22:57:41.337
> 
> 标签：django, django-models

我想知道在我的模型的 clean() 方法中放入什么合适的东西。

对模型的属性进行所有验证和操作以确保其有效（即业务逻辑）是否有意义？在我的情况下有很多这样的情况，我想知道每次保存模型时都执行它是否有意义。

例如，我正在执行以下操作： - 如果视频被标记为私有，请删除其在 playlsts 中的所有引用 - 确保视频的标题相对于用户其他视频是唯一的 - 等等。

我正在做的一些事情只需要在创建新视频时完成 - 所以每次保存模型时检查/设置它们似乎也过分了。

这是 clean() 方法的正确使用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T00:37:37.053

清除关系可能最好由信号处理。要验证您的信号是否正常工作，您可以编写一个单元测试。

验证标题是否唯一肯定属于表单/模型验证器。对我来说，这似乎是一个更好的关注点分离。

# java - 在 JFC 中模拟 JDialog 拖放

> ID：12117677
> 
> 赞同：0
> 
> 时间：2012-08-24T22:58:18.647
> 
> 标签：java, awt

我希望在我的 JFC 中的 JXTreeTable 上模拟从一个位置到另一个位置的 JDialog 拖放。

```
TestHelper().enterDragAndLeave(
    new MouseEventData(this, myDialog.getRootPane()),
    new MouseEventData(this, treeTable),
    1
); 
```

但是，这对我不起作用。谁能帮我这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T11:42:42.487

我会尝试：

```
java.awt.Robot 
```

正如 Javadocs 所描述的那样（在[http://docs.oracle.com/javase/6/docs/api/java/awt/Robot.html](http://docs.oracle.com/javase/6/docs/api/java/awt/Robot.html)上）：
“此类用于生成本机系统输入事件以实现测试自动化、自运行演示和其他需要控制鼠标和键盘的应用程序。Robot 的主要目的是促进 Java 平台实现的自动化测试。

以下顺序应该起作用：

```
mouseMove(int x, int y) 
mousePress(InputEvent.BUTTON1_MASK) 
mouseMove(int x, int y) 
mouseRelease(InputEvent.BUTTON1_MASK) 
```

如果您不确定获取特定目标位置的坐标，并且如果它是 中的一个单元格`JXTreeTable`，那么我昨天的回答应该会有所帮助：[Getting location of cell in JXTreeTable](https://stackoverflow.com/questions/12097619/getting-location-of-cell-in-jxtreetable/12097951#12097951)

# c - 内存分配**p

> ID：12117679
> 
> 赞同：-1
> 
> 时间：2012-08-24T22:58:29.463
> 
> 标签：c, pointers, heap-memory

对于`int ** p = NULL;`C 中的语句，请讨论关于`p`, `*p`, `**p`?的内存分配。它将在堆栈上还是在空位置或其他地方？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:03:20.930

`p`将是`int **`堆栈上的指针，并将包含 value `NULL`。

尝试评估`*p`将导致运行时错误，因为您将尝试取消引用`NULL`. 但如果它不会导致运行时错误，它将是内存位置的值`0`。

尝试评估`**p`是不可能达到的，因为`*p`是不可能评估的（将导致运行时错误）。但是，如果`*p`没有导致运行时错误，那么`**p`将是内存位置的值所指向的内存位置的值`0`。

编辑：`*p`并且`**p`没有分配到任何地方，因为它们不作为单独的变量存在。内存中只有一个变量，`p`，并且存储在堆栈中。这就像问，如果我这样做`int i = 10;`，`i * 5`存储在哪里？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T23:16:02.037

*   `p`只是一个指向某处的变量。
*   它的类型是`int**`这意味着它可以指向一个指向`int`.
*   由于您没有编写任何分配内存的代码，因此不会发生内存分配..
*   ..当然除了`p`自己的内存分配：假设一个32位地址空间，4字节的内存分配在堆栈上，该内存地址的值为0（NULL）。

# java - java包不存在且源文件错误

> ID：12117680
> 
> 赞同：1
> 
> 时间：2012-08-24T22:58:29.163
> 
> 标签：java, packages

所以我创建了一个名为 util 的文件夹，并在其中放置了四个类以及名为 unit10Assignment 的程序。我创建了一个包 util 并在每个类代码的顶部键入“package util;”，如下所示：

```
package util;

public class Employee 
```

然后我写道：

```
import util.*;
import javax.swing.JOptionPane;

public class unit10Assignment 
```

在程序之上。但是，当我编译它时，它会告诉我。有谁知道为什么？我试着玩弄它，当我输入 import java.util*; 时它消失了。相反，但我不确定我的老师想要的作为她的例子的东西前面没有java。

它还说“错误的源文件”“包不包含 Employee 类” 但是，在我输入包语句之前，所有的东西都编译并运行得很好，从那以后我没有对代码进行任何更改。如果我从员工类中删除了包语句，则会出现相同的消息，但它会说另一个类不存在。

感谢您的帮助注意：无论我放 java.util 还是只放 util，仍然会出现这个错误来源的问题。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:39:26.910

我将假设您的项目设置如下：

```
util/
    Employee.java
    unit10Assignment.java
bin/ 
```

（如果不是，那很好 - 只要它们在*某个*文件夹中。 `bin/`不过应该存在。）

包的工作方式是它们是硬盘驱动器上的文件夹 - 您要导入的包要求您希望导入的文件夹和类都存在*于该特定文件夹*中。这就是为什么包很方便——你可以命名两个类`Employee`，并让它们位于完全不同的位置。^*

以下是如何在不使用 IDE 的情况下将它们编译成类似包的结构。将 $HOME 替换为 Java 类文件夹的完整路径。

```
javac -sourcepath $HOME/util -d $HOME/bin *.java 
```

以下是您运行主课程的方式：

```
java -cp $HOME/bin util.$MAIN_CLASS 
```

这些标志的含义细分：

*   `-sourcepath`指示 javac 在此特定目录中查找源文件。
*   `-d`为您的 .class 文件指定一个输出目录。
*   `-cp`指示 java 将此文件夹添加到其类路径中。

^(*：非常非常大的项目通常可以使用与其他类相同的名称；如果您想使用特定的类名，则必须为其使用[完全限定的类名](https://stackoverflow.com/a/11778101/1079354)。)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T23:09:20.780

确保：

*   文件名与类名匹配（例如`Employee.java`，对于 class `Employee`）
*   文件根据其包位于相应的文件夹中（即`util`）

你在使用任何 IDE 吗？如果没有，使用一个真的对这类事情有很大帮助。

# php - jQuery自动保存运行成功功能，但不更新MySQL

> ID：12117681
> 
> 赞同：0
> 
> 时间：2012-08-24T22:58:29.580
> 
> 标签：php, jquery, mysql, ajax

我的 jQuery 自动保存正在运行成功功能，但没有更新 MySQL 数据库。我做错了什么？

**jQuery：**

```
function autosave() {
    var t = setTimeout("autosave()", 5000);

    var translation = $("#doc-translation").val();

    if (translation.length > 0) {
        $.ajax({
            type: "POST",
            url: "update-draft-submission.php",
            data: translation,
            cache: false,
            success: function() {   
                         $(".autosaved").empty().append("saved");
            }
        });
    }
} 
```

**PHP：**

```
<?php
session_start();
//retrieve our data
$iddoc = $_GET['iddoc'];
$trans = translation;
$transowner = $_SESSION['userid'];
$true = 1;
include "../dbconnect.php";
$query = "UPDATE translations
          SET trans='$trans'
          WHERE iddoc='$iddoc'
          AND transowner='$transowner'";
mysqli_query($query);
mysqli_close();

echo "Saved";
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:15:47.043

您没有正确获取 PHP 中的数据：

```
$iddoc = $_GET['iddoc'];
$trans = translation; 
```

*   iddoc 不作为 GET 参数在任何地方传递
*   “翻译”不是一个变量（我也不认为它是一个常数）

如果在查询中没有获得所需的值，您的 SQL 将中断。

更新您的javascript，以便：

```
$.ajax(
 {
   type: "POST",
   url: "update-draft-submission.php",
   data: data: {translation:translation,iddoc:"XXX"},
   cache: false,
   success: function()
   {   
     $(".autosaved").empty().append("saved");
   }
 }); 
```

将**XXX**替换为您的`iddoc`值。

然后在 PHP 中获取它们：

```
$iddoc = $_POST['iddoc'];
$trans = $_POST['translation']; 
```

# c++ - libevent：查询解析分段错误

> ID：12117691
> 
> 赞同：0
> 
> 时间：2012-08-24T22:59:58.183
> 
> 标签：c++, parsing, segmentation-fault, libevent

尝试解析从 uri 获得的查询时出现分段错误。这是干净地表示它的pastebin[链接。](http://pastebin.com/hyM2jBwz)

# android - 当我尝试在 FragmentActivity 中获取 Extras 时出现 NullPointerException

> ID：12117692
> 
> 赞同：0
> 
> 时间：2012-08-24T23:00:08.733
> 
> 标签：android, android-intent, android-activity, android-fragments

我在 Activity 和 FragmentActivity 之间传递额外内容时遇到问题。

下一个代码创建 Intent 以启动新的 Activity：

```
Intent fichaSerie = new Intent(getActivity(),ActividadSerie.class);
NotificacionSerie serie = (NotificacionSerie) adaptador.getItem(position);
fichaSerie.putExtra("serie", serie.getID());
getActivity().startActivity(fichaSerie); 
```

当我试图在 Fragment Activity 中获取 Extras 时，我得到一个 NullPointerException：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.serie);
String extra = getIntent().getExtras().getString("serie") //NullPointerException
} 
```

有人知道我在代码中犯了什么错误吗？

非常感谢大家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T11:44:12.473

谢谢你们所有的帮助，我用这个电话解决了我的问题：

```
getIntent().getStringExtra("serie") 
```

我将此问题标记为已解决。

再次感谢你们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T08:15:37.640

首先，Java 区分大小写，因此`.getID()`与`.getId()`. 如果您尝试获取对象的 ID，请使用`.getId()`. 这通常会返回一个`Integer`值

`type`正如 Michal 所说（字符串或整数或其他任何内容） ，请注意您正在投入的额外内容

```
Intent fichaSerie = new Intent(getApplicationContext(), ActividadSerie.class);
NotificacionSerie serie = (NotificacionSerie) adaptador.getItem(position);
fichaSerie.putExtra("serie", serie.getId()); //presuming this id is an Integer or long int ... You could change this to string if it is still usable then (serie.getId().toString())... but you have to get an intent with myIntent.getStringExtra(...), but I think you will not be doing this.
startActivityForResult(fichaSerie, 0); 
```

从 ActividadSerie.java 获得额外收益

```
@Override
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.serie);
Intent myIntent = getIntent();
String extra = myIntent.getStringExtra("serie"); //try diferent gets... getIntExtra(), getStringExtra()..
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T09:57:45.977

您被输入一个`Integer`值并将其放入该`String`值中，以便它获得一个`NullPointerException`.

# javascript - jquery ui动态图标

> ID：12117693
> 
> 赞同：0
> 
> 时间：2012-08-24T23:00:33.263
> 
> 标签：javascript, jquery, jquery-ui, button

我有一组按钮，我试图代替为它们设置单独的图标，而是使用属性和一体式功能来设置它们的图标。这是我的按钮示例：

```
<button title="New Project" id="New" class="Nx button" type="document"></button> 
```

这是我想要实现的目标：

```
$('.button').button({
   icons: { primary:'ui-icon-'+$(this).attr("type") },
   text:false
}); 
```

但它不起作用。所以我非常想对元素的“类型”属性有一个内部引用，以便能够设置图标

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:48:46.433

这是我将如何进行的演示。我还提供了下面的代码。需要帮助请叫我。

代码：

```
$(document).ready(function(){
    $("button").each(function(index,element){
       $(element).button({
            icons: {
                primary: "ui-icon-" + $(this).attr('type')
            },
                text:false
            })
    });
}); 
```

演示：http: [//jsfiddle.net/sZdd8/11/](http://jsfiddle.net/sZdd8/11/)

# php - 使用 SWFupload 或 Uploadify 时，是否需要编辑我的 php.ini 设置？

> ID：12117694
> 
> 赞同：0
> 
> 时间：2012-08-24T23:00:33.297
> 
> 标签：php, jquery, linux, uploadify, swfupload

我需要上传 100-200 MB 的文件，我发现的解决方案是使用 Uploadify 或 SWFupload。（任何使用哪个更好？）。

现在我要设置它，但是知道我的服务器只接受通过常规发布文件的 3MB 以下的文件，我是否需要更改 php.ini 设置才能上传这些大文件，或者闪存上传器会处理这个问题为了我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:02:04.610

任何客户端脚本背后的过程都是在服务器端处理的。如果您使用的是 PHP，那么是的，您必须更改配置`php.ini`以接受更大的文件大小。

`SWFUpload`并且`Uploadify`是客户端 - 这意味着它在客户端浏览器上运行并将数据发送到文件处理器，在这种情况下`PHP`，该文件实际上是上传文件而不是 SWFUpload 或 Uploadify。

# php - 使用 usort 忽略

> ID：12117697
> 
> 赞同：0
> 
> 时间：2012-08-24T23:00:43.653
> 
> 标签：php, usort

我试图组织这种数组

```
array
  0 => 
    array
      'id' => '19'
      'nome' => 'Lorem ipsum'
      'order' => '0'
  1 => 
    array
      'id' => '23'
      'nome' => 'Lorem ipsum'
      'order' => '2'
  2 => 
    array
      'id' => '45'
      'nome' => 'Lorem ipsum'
      'order' => '0'
  3 => 
    array
      'id' => '6'
      'nome' => 'Lorem ipsum'
      'order' => '0'
  4 => 
    array
      'id' => '23'
      'nome' => 'Lorem ipsum'
      'order' => '1'
  5 => 
    array
      'id' => '12'
      'nome' => 'Lorem ipsum'
      'order' => '0' 
```

因此，我必须将零值按顺序放在数组的末尾，并使用其他顺序值对数组进行正确排序。

```
array
  0 => 
    array
      'id' => '23'
      'nome' => 'Lorem ipsum'
      'order' => '1'
  1 => 
    array
      'id' => '23'
      'nome' => 'Lorem ipsum'
      'order' => '2'
  2 => 
    array
      'id' => '19'
      'nome' => 'Lorem ipsum'
      'order' => '0'
  3 => 
    array
      'id' => '45'
      'nome' => 'Lorem ipsum'
      'order' => '0'
  4 => 
    array
      'id' => '6'
      'nome' => 'Lorem ipsum'
      'order' => '0'
  5 => 
    array
      'id' => '12'
      'nome' => 'Lorem ipsum'
      'order' => '0' 
```

我尝试像这样使用 usort，但结果不正确：

```
 usort($items, function() {
        if ($a['uf_order'] == 0) return 0;
        return ($a['uf_order'] > $b['uf_order']) ? -1 : 1;
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:04:18.383

您必须在函数中传递`$a`和：`$b`

```
usort($items, function($a, $b) {
    if ($a['uf_order'] == 0) return 0;
    return ($a['uf_order'] > $b['uf_order']) ? -1 : 1;
}); 
```

`uf_order`您的数组中也没有调用键。

正如[NomikOS](https://stackoverflow.com/questions/12117697/using-usort-ignore/12117721#comment16201775_12117721)在他的评论中正确指出的那样。这仅适用于 PHP 5.3+。如果你有旧版本的 PHP，你可以这样做：

```
usort($items, 'cmp');

function cmp ($a, $b) {
    if ($a['uf_order'] == 0) return 0;
    return ($a['uf_order'] > $b['uf_order']) ? -1 : 1;
} 
```

# jquery - jquery 灯箱 iframe

> ID：12117700
> 
> 赞同：0
> 
> 时间：2012-08-24T23:00:55.417
> 
> 标签：jquery, fancybox, lightbox

多年来我一直在使用 Fancybox，但似乎有些网站阻止将其内容加载到 iframe 中，情况发生了变化。例如，google circles、linkedin、github .. 是一些不会加载到 fancybox（或 iframe）中的。

我想知道是否有人知道一种解决方法，或者一种在不使用 iframe 的情况下将灯箱用于外部 url 的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:25:58.520

您指的是：[https](https://developer.mozilla.org/en-US/docs/The_X-FRAME-OPTIONS_response_header) ://developer.mozilla.org/en-US/docs/The_X-FRAME-OPTIONS_response_header站点使用它来防止劫持。

由于 javascript 的跨域安全性，不能只使用 JS。您需要使用一些服务器脚本。 [加载外部网站的内容](https://stackoverflow.com/questions/6326297/load-external-sites-content)

# c# - 登录参数不正确。网

> ID：12117703
> 
> 赞同：0
> 
> 时间：2012-08-24T23:01:53.217
> 
> 标签：c#, asp.net, crystal-reports

这是我的代码

```
 ReportDocument rpt = new ReportDocument();
                rpt.Load(Server.MapPath("Reports/report.rpt"));
                rpt.PrintToPrinter(1, true, 0, 0); 
```

第二行向我抛出 "[CrystalDecisions.CrystalReports.Engine.LogOnException] = {"\rError in File C:\Users\Prince\AppData\Local\Temp\report {1D0F4138-EB7B-4725-8B41-DCF38019B2C9}.rpt： \n无法连接：登录参数不正确。"}" 。有什么我错过的吗...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:30:26.593

不要在您的路径中设置报告

```
ReportDocument rpt = new ReportDocument();
                rpt.Load(Server.MapPath("/report.rpt"));
                rpt.PrintToPrinter(1, true, 0, 0); 
```

# php - 根据用户在一个共享站点结构中的位置提供独特的内容（不是翻译）。(PHP/MySQL )

> ID：12117705
> 
> 赞同：1
> 
> 时间：2012-08-24T23:02:21.553
> 
> 标签：php, mysql, localization, internationalization

**一些背景：**
我们目前有 5 个版本的网站（美国、英国、加拿大、澳大利亚、新加坡），每个版本都有 TLD。我们刚刚决定将其扩展到 10-12 个站点，代表 4 或 5 种语言（我们当前的站点只有英语）。

我们将使用每个国家/地区的 TLD（即 www.domain.fr）以及路径中带有国家和语言的“.com”（即 www.domain.com/fr/fr）都指向同一个站点/文件，甚至希望使用相同的 CSS 文件。

我认为我们已经解决了如何根据用户区域设置（zend_translate 或者可能是 GetText）提供不同的文本内容。但是，某些位置还需要在已建立的结构内托管独特的图像或其他特定于位置的内容（假设有 3 个块/div，我们根据用户的位置在其中放置不同的“广告”）。

**问题：**
是否有特定于 PHP/MySQL 的“最佳方式”来根据用户的位置提供一些独特的内容——所有这些都在一个共享的站点结构中？（请注意，这不是关于翻译，而是关于特定位置的内容）

**示例：**
我们想要实现的一个非常好的示例是 ikea.com、ikea.pl、ikea.com/pl/pl

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:12:34.357

假设没有`PHP`/`MySQL`特定的**最佳方式**。

最好的方法是思考它的方法，这完全取决于您的需求。对于您的小**广告**问题，如果您没有使用任何可以定位客户位置的 HUGE ADS 公司，您可以使用`MySQL`并为每个区域创建`block`特定区域`TLD`，这样您就可以在该数据块中的每个域中运行不同的内容。

如果图像具有唯一的名称，图像可以托管在同一个位置、同一个目录中，并且您可以再次使用 MySQL 来跟踪您拥有的内容和位置。

例如：

```
$myTLD = $_SERVER['SERVER_NAME']; // get host
$myTLD = preg_replace('#^www\.(.+\.)#i', '$1', $myTLD); // remove www if exists
switch ($myTLD) {
    case 'example.org':
        include 'banners_for_org.php';
        break;
    case 'example.net':
        include 'banners_for_net.php';
        break;
    default:
        include 'banners_general.php';
} 
```

（PS：我没有看到任何类似的东西`ikea.pl`，`ikea.com`甚至没有标志）

# jquery - 模态花式框下出现的工具提示

> ID：12117707
> 
> 赞同：2
> 
> 时间：2012-08-24T23:02:33.707
> 
> 标签：jquery, css, wordpress, fancybox, modal-dialog

我在我的网站上有一个联系表，这样人们就可以写推荐信。联系表单会在模型框中弹出，并且它具有在某些字段中悬停时弹出的工具提示。工具提示确实有效，但它会弹出模型框后面而不是前面。示例网站是：

[http://www.leadcomm.net/testimonials/](http://www.leadcomm.net/testimonials/)

单击“撰写评论”图像时会弹出模式。工具提示确实会弹出，但您看不到它们。如果您将鼠标悬停在单选框上，您会看到它。

我尝试添加一个 zindex，但没有奏效。

```
$j(".ccf-tooltip-field").tooltip({
  position: "center right",
  offset: [-2, 10],
  effect: "fade",
  opacity: 0.7,
  tipClass: 'ccf-tooltip',
  zIndex: '100100',
}); 
```

任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T23:12:07.737

您的模态的 z-index 为 111102。

您的工具提示类的 z-index 为 1020。

如果我给 .tooltip 一个 z-index 111103 它工作正常。

# objective-c - 格式指定类型“无符号短”，但参数的类型为“int”

> ID：12117709
> 
> 赞同：2
> 
> 时间：2012-08-24T23:02:48.400
> 
> 标签：objective-c, xcode

我有一个扫描字符串的方法，将任何新行转换`<br>`为 HTML。有问题的行是：

```
NSCharacterSet *newLineCharacters = [NSCharacterSet characterSetWithCharactersInString:
          [NSString stringWithFormat:@"\n\r%C%C%C%C", 0x0085, 0x000C, 0x2028, 0x2029]]; 
```

Xcode 在这里给我一个警告：

```
Format specifies type 'unsigned short' but the argument has type 'int' 
```

建议我将 all 更改`%C`为`%d`，但事实证明这会破坏该功能。这样做的正确方法是什么，为什么 Xcode 会推荐错误的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T23:04:41.267

一种选择是将您的论点转换为无符号短：即`(unsigned short)0x0085`等

但是如果你正在寻找换行符，你应该只使用换行符字符集。这是“符合 Unicode 的”：`[ NSCharacterSet newlineCharacterSet ]`

**编辑**

重新审视这个问题：如果您尝试通过换行符分隔 NSString/CFString，您可能应该使用`-[ NSString getLineStart:end:contentsEnd:forRange:]`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T23:31:21.563

正如@nielsbot 所建议的那样，使用罐装字符集绝对是当有一个符合您应用程序需求的字符集时要走的路。

但就在其中编写带有 Unicode 代码点的字符串文字而言，您不需要`-stringWithFormat:`，您可以只使用 Unicode 转义：

```
NSCharacterSet *aCharSet = [NSCharacterSet
  characterSetWithCharactersInString:@"\u2704\u2710\u2764"]; 
```

# c++ - 读取文件，数据损坏

> ID：12117720
> 
> 赞同：1
> 
> 时间：2012-08-24T23:04:17.733
> 
> 标签：c++, linux, opengl, glsl, glfw

看来我无法编译我的**GLSL 着色器。**偶尔（主要是在编辑文件之后），编译时出现以下错误：

```
----- SRC ----- (150 B)
#version 330 core

uniform mat4 mvpMatrix;

in vec4 vertexPosition_modelspace;

void main() {
    gl_Position = mvpMatrix * vertexPosition_modelspace;
}
gp!
----- END -----
SimpleTransform.vertexshader:Vertex shader failed to compile with the following errors:
ERROR: 0:10: error(#132) Syntax error: 'gp' parse error
ERROR: error(#273) 1 compilation errors.  No code generated 
```

这很奇怪，因为我发誓文件不包含那个尴尬的`gp!`部分。尽管如此，我还是用*猫调查了它*

```
#version 330 core

uniform mat4 mvpMatrix;

in vec4 vertexPosition_modelspace;

void main() {
    gl_Position = mvpMatrix * vertexPosition_modelspace;
} 
```

*更少*_

 *```
#version 330 core

uniform mat4 mvpMatrix;

in vec4 vertexPosition_modelspace;

void main() {
    gl_Position = mvpMatrix * vertexPosition_modelspace;
} 
```

他们都证明了我是对的。

我想知道是什么导致了这种奇怪的行为。

这是[我的项目](https://dl.dropbox.com/u/90959340/project.tar.xz)的链接。您应该能够通过输入*src*目录并键入`make`（仅限*Linux*）轻松编译它。它需要 GLFW、GLEW、GLM 和 GL3。

和代码本身：

加载着色器文件

```
GLuint shader_load(GLenum type, const char filename[]) {
    if ((type != GL_VERTEX_SHADER && type != GL_FRAGMENT_SHADER) || !filename) return 0;

    /* wczytywanie pliku shadera */
    FILE *file = fopen(filename, "rb"); 

    //okreslenie rozmiaru pliku
    fseek(file, 0, SEEK_END);   
    uint32 iFileSize = ftell(file);
    fseek(file, 0, SEEK_SET);

    //wczytywanie
    char *tmp = new char[iFileSize];
    memset(tmp, 0, sizeof(tmp));
    uint32 iBytes = (uint32) fread(tmp, sizeof(char), iFileSize, file); 
    fclose(file);   
    if (iBytes != iFileSize) printf("Warning: reading error possible!\n");

    #ifdef _DEBUG_
    printf("----- SRC ----- (%d B)\n%s\n----- END -----\n", iBytes, tmp);
    #endif

    /* przygotowanie shadera */
    GLuint shader = glCreateShader(type);
    glShaderSource(shader, 1, const_cast<const GLchar**>(&tmp), NULL);
    delete[] tmp;
    glCompileShader(shader); //kompilacja shadera

    /* sprawdzenie statusu kompilacji */
    int status = GL_FALSE; 
    glGetShaderiv(shader, GL_COMPILE_STATUS, &status);  
    int logsize = 0;
    glGetShaderiv(shader, GL_INFO_LOG_LENGTH, &logsize);
    char *log = new char[logsize];
    glGetShaderInfoLog(shader, logsize, NULL, log);
    printf("%s:%s", filename, log);         
    delete[] log;
    if (status != GL_TRUE)  return 0;

    return shader;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T23:25:53.363

> **首先关闭**切换到 C++ 而不是 C-with-a-cpp 扩展名以避免像这样的沉船。

分析：

* * *

在 valgrind 下运行显示

```
==15579== Invalid read of size 1
==15579==    at 0x5B95C65: vfprintf (vfprintf.c:1623)
==15579==    by 0x5B9E768: printf (printf.c:35)
==15579==    by 0x4019C1: shader_load(unsigned int, char const*) (shaders.cpp:88)
==15579==    by 0x401B30: program_create(char const*, char const*) (shaders.cpp:120)
==15579==    by 0x401D65: main (in /tmp/ogl-jg-3/test)
==15579==  Address 0xb3018a6 is 0 bytes after a block of size 150 alloc'd
==15579==    at 0x4C2864B: operator new[](unsigned long) (vg_replace_malloc.c:305)
==15579==    by 0x401961: shader_load(unsigned int, char const*) (shaders.cpp:81)
==15579==    by 0x401B30: program_create(char const*, char const*) (shaders.cpp:120)
==15579==    by 0x401D65: main (in /tmp/ogl-jg-3/test) 
```

它准确地告诉您它试图读取超出第`tmp`81 行分配的缓冲区的末尾。您似乎以某种方式假设它是空终止的。它不是。补充一点：

```
//wczytywanie
char *tmp = new char[iFileSize+1];
memset(tmp, 0, (iFileSize+1)*sizeof(char));
uint32 iBytes = (uint32) fread(tmp, sizeof(char), iFileSize, file); 
fclose(file);   
if (iBytes != iFileSize) printf("Warning: reading error possible!\n");

#ifdef _DEBUG_
    printf("----- SRC ----- (%d B)\n%s\n----- END -----\n", iBytes, tmp);
#endif 
```

我得到了半体面的输出。但是 GL 窗口保持空白

## **更新**

为了更清楚地说明我***切换到 C++***的意思，这里的想法是：

```
GLuint shader_load(GLenum type, const char filename[]) {
    if ((type != GL_VERTEX_SHADER && type != GL_FRAGMENT_SHADER) || !filename) return 0;

    GLuint shader = glCreateShader(type);
    std::string src;
    {
        /* wczytywanie pliku shadera */
        std::ifstream ifs(filename, std::ios::binary);
        if (!std::getline(ifs, src, '\0'))
            std::cerr << "Warning: reading error possible!\n";
    }

#ifdef _DEBUG_
    std::cout << "----- SRC ----- " << src.size() << " B \n" << src << "\n----- END -----\n";
#endif

    /* przygotowanie shadera */
    const GLchar* sources[] = { src.c_str() };
    glShaderSource(shader, 1, sources, NULL);
    glCompileShader(shader); //kompilacja shadera 
```*

# php - 用户点击激活链接后如何激活账户？

> ID：12117723
> 
> 赞同：0
> 
> 时间：2012-08-24T23:04:51.027
> 
> 标签：php, mysqli

感谢[Nickfrosty](https://www.youtube.com/watch?v=Y2NYbEjTzE8)提供的关于能够在 php 中创建适当的注册系统的 youtube 教程，我已经能够将他的代码从[mysql](https://www.mysql.com/)转换为[mysqli](http://php.net/manual/en/book.mysqli.php)，并且能够在用户注册后通过电子邮件发送激活链接。

下面是在数据库中插入注册详细信息并在用户注册后将消息和激活链接发送到用户电子邮件的代码。

```
$code = md5(rand());

$insertsql = "
INSERT INTO Teacher
(TeacherForename, TeacherSurname, TeacherEmail, TeacherAlias, TeacherUsername, TeacherPassword, Code)
VALUES
(?, ?, ?, ?, ?, ?, ?)
";
if (!$insert = $mysqli->prepare($insertsql)) {
// Handle errors with prepare operation here
}                                           

$insert->bind_param("sssssss", $getfirstname, $getsurname,
$getemail, $getid, $getuser,
$teacherpassword, $code);

$insert->execute();

if ($insert->errno) {
// Handle query error here
}

$insert->close();

$site = "http://helios.hud.ac.uk/......../Mobile_app";
$webmaster = "Mayur Patel <.......@hud.ac.uk>";
$headers = "From: $webmaster";
$subject = "Activate Your Account";
$message = "Thanks for Registering. Click the link below to Acivate your Account. \n";
$message .= "$site/activate.php?user=$getuser&code=$code\n";
$message .= "You must Activate your Account to Login";

if(mail($getemail, $subject, $message, $headers)){
$errormsg = "You have been Registered. You must Activate your Account from the Activation Link sent to <b>$getemail</b>";
$getfirstname = "";
$getsurname = "";
$getid = "";
$getuser = "";
$getemail = "";
} 
```

但我现在有一个问题。如果我单击该链接，它会将用户导航到该`activate.php`页面。

我的问题是：用户点击激活链接后，如何激活用户的账户？我需要它能够通过在上面的 php 中查找它来识别用户的用户名和激活码`$message .= "$site/activate.php?user=$getuser&code=$code\n";`，然后在数据库中我需要它`Active`从`0 to`1` 更新该用户的列，以便用户现在处于活动状态。下面的说法是否正确：

```
"UPDATE Teacher SET Active='1' WHERE TeacherUsername = '$getuser'"
"SELECT * FROM Teacher WHERE TeacherUsername='$getuser' AND Active='1'" 
```

该`activate.php`页面仅显示一条消息，说明该帐户已激活。如果用户已经被激活，那么我希望它显示用户已经被激活的消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:35:15.943

我建议您不要使用 TeacherUserName 来选择您的老师。

你的表应该包含一列 TEACHER_ID (int, auto_increment) ：想象一下如果两位老师有相同的名字？

假设老师有不同的名字，您可以使用 hash_hmac 函数创建一个安全代码：

```
$code = hash_hmac('sha1', 'username', 'YOUR_SECRET_KEY'); 
```

你可以 ：

1.  发送电子邮件时生成此代码（name='Tom', code='ARI3428UZE'）

2.  当用户点击链接时，您只需要获取用户名 (name = 'Tom')，使用 hash_mac 再次创建代码 (newcode = 'ARI3428UZE')

3.  你测试代码 == newcode

4.  如果两个代码相同，您可以按照您的建议更新您的表格

最好的方法是使用 TEACHER_ID 而不是 TEACHERNAME。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T01:07:42.553

注册时：

创建一个变量 $random = rand(1,9); <-- 获取随机数。使用其他值（例如“教师 Alies”、“教师姓氏”）注册时，将其插入表中。

向他的电子邮件地址发送电子邮件。将代码附在他的电子邮件链接中。

```
www.yourdomain.com/activate.php?username=teachername&code=randomcodehere 
```

把它放在activate.php

```
$user_to_be_activated       =   $_GET['username'];
$code_to_be_matched     =   $_GET['codehere'];

$query      =   mysql_query("SELECT * FROM Teacher WHERE teachername='$user_to_be_activated' AND activecode='$code_to_be_matched'");
$counting   =   mysql_num_rows($query);

if($counting    ==  '1')
{
    mysql_query("UPDATE Teacher SET accountactive='1'"); <-- Set this to 0 when registering
}
else
{
    echo"The code and Username doesn't match!";
} 
```

所以当他点击验证邮件时，您的网站会检查用户名和数据库中的代码，如果它们正确，则将激活设置为 1。我知道那里有很多代码错误，需要更正和修改，但是我是一名新开发人员，这应该给你提示，谢谢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T07:54:11.900

这就是我编写 activate.php 的方式：

代码 ：

```
$sUser = $_GET['username'];
$sCode = $_GET['code'];

//MYPRIVATEKEY defined on a conf.php or else
$sEncodedUser = hash_hmac('sha1', $sUser, 'MYPRIVATEKEY');

if($sEncodedUser == $sUser) {
    $sQuery = "UPDATE USER SET activated=1 WHERE USERNAME = " . escape($sUser);
    //RUN $sQuery;
    echo 'Account activated !';
} else {
    echo 'Problem when activating your account';
} 
```

# html - 带有填充的div滚动？

> ID：12117724
> 
> 赞同：3
> 
> 时间：2012-08-24T23:04:53.313
> 
> 标签：html, text, scroll, padding

我是 html / css 的新手，还在学习一些东西，目前我正在尝试创建一个简单的聊天样式框，如下所示：

[http://jsfiddle.net/29n3w/](http://jsfiddle.net/29n3w/)

有没有办法重新编写此代码，以便 div 内的文本尊重填充并从顶部和底部的边界切断 9px，而不是在井的边界处被切断？我还想保持滚动条现在的样子。

我已经搜索了一段时间，但似乎无法为此设计解决方案。

理想情况下，这就是我的目标：http: [//img839.imageshack.us/img839/3889/examplejt.png](http://img839.imageshack.us/img839/3889/examplejt.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:41:18.480

您需要将文本包装在另一个 div 中并使新的 div 可滚动。然后你把填充放在你的`well`..检查一下：http: [//jsfiddle.net/kdaker/La9Jn/7/](http://jsfiddle.net/kdaker/La9Jn/7/)

# ios - UIImageWriteToSavedPhotosAlbum - 无法为保存的照片编码图像

> ID：12117728
> 
> 赞同：0
> 
> 时间：2012-08-24T23:05:37.277
> 
> 标签：ios, uiimage

在我的主 ViewController 中，我从`UIGraphicsGetImageFromCurrentImageContext()`. 该图像被分配给一个 UIImage，我已经通过在主视图中放置一个 UIImageView 对其进行了测试，因此我可以看到它。工作得很好。但是，当我点击一个我指定保存它的按钮时，我收到错误：`-3304 "Failed to encode image for saved photos."`

截图代码：

```
 CGSize mySize = CGSizeMake(530, 350);
 UIGraphicsBeginImageContext(mySize);
 CGContextRef context = UIGraphicsGetCurrentContext();
 CGContextTranslateCTM(context, -444, -313);
 [self.view.layer renderInContext:UIGraphicsGetCurrentContext()];
 // self.screenshot is a UIImage declared in .h
 self.screenshot = UIGraphicsGetImageFromCurrentImageContext();
 UIGraphicsEndImageContext(); 
```

保存代码：

```
UIImageWriteToSavedPhotosAlbum(screenshot, self, @selector(imageWasSavedSuccessfully:didSaveWithError:contextInfo:), NULL); 
```

不确定我是否不符合相机胶卷图像的要求，或者该方法是否只能与 UIPickerController 类结合使用。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T13:16:31.957

对于后代，问题是要保存的图像为零。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-25T01:07:01.853

尝试像这样保存您的图像：

```
UIImageWriteToSavedPhotosAlbum(screenshot, nil, nil, nil); 
```

或许

```
UIImageWriteToSavedPhotosAlbum(self.screenshot, nil, nil, nil); 
```

甚至可能

```
UIImageWriteToSavedPhotosAlbum(screenshot, self, nil, nil); 
```

# image - Actionscript 3\. 当 mp3 可用或不可用时显示替代图像（使用条件）

> ID：12117732
> 
> 赞同：1
> 
> 时间：2012-08-24T23:06:11.760
> 
> 标签：image, actionscript-3, audio, conditional-statements

我想知道处理这个问题的最佳方法

我成功地从 XML 文件加载声音（audioMP3）并使用 EventListener 处理 IO 错误。

我想在有 MP3 时在舞台上显示图像，或者在没有 MP3 时显示替代图像。

我一直在尝试访问 IO 错误并在条件中使用它来选择图像，例如，如果存在 IO 错误，则显示 btnAudioNo 否则显示 btnAudioYes

这是 eventListemer：

```
audioMP3.addEventListener(IOErrorEvent.IO_ERROR, onSoundIOError, false, 0, true);
function onSoundIOError (e:IOErrorEvent){
    trace(e.text);
    removeEventListener(IOErrorEvent.IO_ERROR, onSoundIOError)
} 
```

而我狡猾的有条件的尝试：

```
var btnAudioYes:Bitmap = new Bitmap(new(getDefinitionByName("btnAudioYes")) (0,0) );
var btnAudioNo:Bitmap = new Bitmap(new(getDefinitionByName("btnAudioNo")) (0,0) );
if(ioError = false){
    addChild(btnAudioYes);
}
else {
    addChild(btnAudioNo);
} 
```

我的问题是，我怎样才能让它工作，有没有更好的方法来确定是否有可用的 MP3 文件（在 XML 文件中）并显示适当的图像？

非常感谢您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:25:12.583

ProgressEvent 的侦听器（除了 IOErrorEvent），如果您获得进度，则文件存在，您可以取消（关闭）加载程序。除非您希望此时加载整个音频文件，否则请改为侦听完整事件。

```
loader:Loader = new Loader();

loader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, onSoundProgress, false, 0, true);
loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onSoundLoadComplete); //use this only if you want to load the entire audio file at this point
loader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR, onSoundIOError, false, 0, true);

loader.load("your file");

function onSoundIOError (e:IOErrorEvent){
    //this function will only run if the file does not exist
    loader = null;
    var btnAudioNo:Bitmap = new Bitmap(new(getDefinitionByName("btnAudioNo")) (0, 0) );
    addChild(btnAudioNo);
}

function onSoundProgress(e:ProgressEvent) {
    //this function will only run if the file DOES exist

    loader.contentLoaderInfo.removeEventListener(ProgressEvent.PROGRESS, onSoundProgress); //we don't want this firing again

    var btnAudioYes:Bitmap = new Bitmap(new(getDefinitionByName("btnAudioYes")) (0,0) );
    addChild(btnAudioYes);

    //if you you don't want to actually load the audio file, do this to cancel the load
    loader.close(); //close the loader to keep from loading the rest of the file
    loader.contentLoaderInfo.unloadAndStop(true);
    loader = null;
}

//use this only if you want to load the entire audio file at this point
function onSoundComplete(e:Event):void {
    //do whatever you need to do with the sound...
} 
```

# asp.net-mvc-4 - MVC 4 如何处理每个页面上的 url 参数，基本控制器？

> ID：12117734
> 
> 赞同：2
> 
> 时间：2012-08-24T23:06:17.590
> 
> 标签：asp.net-mvc-4

在设计我的新 MVC 4 应用程序时寻找一些指导。

我想`s=2011`在应用程序的每个页面上都有一个 url 参数，让我知道我正在使用哪一年的数据。显然，用户将有办法根据需要更改该参数。

我将在每个控制器中都需要该参数，并想知道执行此操作的最佳方法。我正在考虑创建一个基本控制器来读取`Request.QueryString`年份并将其放入公共财产中。但是，考虑到 MVC 中的所有可扩展性点，我想知道是否有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:27:49.353

这在很大程度上取决于您的应用程序的设计，但只是给您两种选择

**`IActionFilter`**

如果您为每个请求执行数据上下文，则可以使用全局`IActionFilter`挂钩全局执行操作前执行，并将查询过滤器应用于幕后的数据上下文。

这样做的主要缺点是，要测试控制器，您需要设置完整的 MVC 管道，以便正确应用 actionfilter。

**依赖注入**

您可以使用依赖注入，而不是使用子类化（如您所说的基本控制器）。让事情变得更松散将允许您从查询字符串、cookie、数据库中的用户设置或其他任何内容中提取过滤器 - 无需您的控制器知道它来自哪里。

这是一些伪代码，如果我使用实体框架或 Nhibernate 之类的东西，我会怎么做（我也肯定适用于其他技术）

```
public Car
{
    public string Year { get; set; }
}

public class CarsDataContext : DbContext
{
    private IQuerable<Cars> _cars = null;
    private Func<Car, bool> _carsFilter = null;

    public IQuerable<Car> Cars {
        get {
            if (_carsFitler != null)
                return _cars.Where(_carsFitler);

            return _cars;
        } 
        set { _cars = value; }
    }

    public void ApplyCarsFilter(Func<Car, bool> predicate)
    {
        _carsFilter = predicate;
    }
} 
```

假设您已经有依赖注入设置（NInject 或任何其他框架），您可以配置如何初始化上下文

```
Bind<CarsDataContext>().ToMethod(() => {
    string yearFilter = GetYearFilter(); // can be coming from anywhere

    CarsDataContext dataContext = new CarsDataContext();
    dataContext.Applyfilter(car => car.Year == yearFilter);
    return dataContext;
}).InRequestScope(); 
```

然后我的控制器对数据过滤一无所知，我可以轻松地对其进行测试：

```
class MyController : Controller
{
    public MyController(CarsDataContext dataContext)
    {
    }
    ...
} 
```

但是，我只会过滤跨许多控制器和我软件的重要部分的数据集。否则就是纯粹的过度设计。

# antlr - 是一种存储和重新处理 AST 子图的方法吗？

> ID：12117735
> 
> 赞同：1
> 
> 时间：2012-08-24T23:06:19.413
> 
> 标签：antlr

我正在设计一种声明性语言。在我的语言中是可以在以后重用的“节点”的定义。把它们想象成原型或模板。您可以根据需要创建它们的副本。我有一个解释器版本，可以在定义阶段生成适当的 Java 对象。直到最近，我一直在使用深拷贝库来创建节点的 Java 表示的副本以创建节点的实例。由于我发现的大多数深度复制库的局限性，以及我不想为系统中的每个对象编写复制构造函数，我想采用不同的方法。我的语言的一部分指定了 GUI Java Swing 对象，这会导致深层复制库出现问题。

有没有办法可以为我的对象声明保存 AST 子图并在我想创建节点的实例时重新处理它？我问的是关于 ANTLR AST 的问题，但是如果您有语言实现建议，我也欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:46:08.453

在 ANTLR 解析器/词法分析器语法中，您可以访问`$ruleName.tree`. 该规则属性是对解析过程中生成的 AST 子树的引用。使用`@after`字段和`@members`字段，您可以存储子树。让我演示给你看。

```
@members{
private List<CommonTree> defs = new ArrayList<CommonTree>();

public List<CommonTree> getDefs(){
    return defs;
}

} 
```

在你的语法下面

```
ruleName 
@after{
    defs.add($ruleName.tree);
}
: IDENT ; 
```

这将创建所有 ruleName AST 子树的列表。这些树可以转换为 CommonTreeNodeStream 并与您的树语法代码一起使用。

```
CommonTree defTree = Parser.getDefs().get(0); // just getting the first tree for example
CommonTreeNodeStream defStream = new CommonTreeNodeStream(defTree);
TreeWalker walker = new TreeWalker(defStream);
//assuming that I have a tree grammar that has been defined to return a list of nodes 
```

有关从 ANTLR 语法规则返回数据的更多信息，请参阅[此问题。](https://stackoverflow.com/questions/11909007/how-can-i-get-information-out-of-a-tree-parser-using-the-antlr-tree-grammar-synt?rq=1)

```
List<Node> nodes = walker.topRule() 
```

这将允许您通过重新处理保存的 AST 子图来创建节点实例。您可以创建 TreeNodeStream 并在需要创建实例时调用 walker。

# javascript - Gridview：防止行在标题行上方移动

> ID：12117736
> 
> 赞同：0
> 
> 时间：2012-08-24T23:06:29.313
> 
> 标签：javascript, jquery, jquery-ui, gridview

我正在使用 jQuery 来允许用户一一移动行并拖放。我想出了如何防止拖放移动到标题行上方，但找不到其他选项的解决方案。

我使用的代码来自这篇文章： [How to move table row in jQuery?](https://stackoverflow.com/questions/1569889/jquery-move-table-row)

我还在这里创建了一个带有标题行的演示：http: [//jsfiddle.net/vaDkF/](http://jsfiddle.net/vaDkF/)

是否可以找出单击的行上方是否有一行？例如，标题索引为零，因此在其下方单击的行将不允许向上移动。

请问有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:18:13.483

将标题行放在`<thead>`标签中，将其余行放在标签中即可`<tbody>`实现此目的。您可以在 gridview 上轻松执行此操作，我认为您必须在数据绑定后执行此操作。

```
GridView1.HeaderRow.TableSection = TableRowSection.TableHeader; 
```

# java - 如何在 Netbeans 之外运行我的 Java+Glassfish+JavaDB webapp

> ID：12117737
> 
> 赞同：0
> 
> 时间：2012-08-24T23:06:46.027
> 
> 标签：java, netbeans, glassfish, javadb

每次我需要运行我的应用程序时，我都需要从 Netbeans 运行它，因为它会自动运行 Glassfish 服务器和 JavaDB，但是 Netbeans 会消耗大量内存，我想在 Netbeans 之外运行我的 webapp（JSP 文件），我该如何做这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:43:52.283

`asadmin.bat`在您的玻璃鱼安装文件夹\bin 中打开文件。

当加载类型`start-domain your_domain_name`

然后，您可以从管理控制台访问 glassfish 服务器。

默认为`http://your_server_name:4848`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T03:44:37.387

启动 glass fish 服务器。将 war 文件部署到此服务器并在浏览器中访问您的应用程序。

# sql-server-2008 - 如何将 2 行从 txt 或 EXCEL 导入 SQL Server 中的同一行

> ID：12117738
> 
> 赞同：1
> 
> 时间：2012-08-24T23:06:51.020
> 
> 标签：sql-server-2008, excel, tsql, text, import

我需要从我可以访问的页面中提取信息。

就在这个模块中，我没有办法导出，只能复制粘贴信息

在同一个 l 中看起来像这样

```
1\. MANUF MODEL YEAR MFG SERIAL REG OS DATE DESC LISTED
```

```
1\. 年 DLV                    
```

```
2\. 怪物 4r25 1988 23547248 Waka001 7/23/2012 出售 7/22/2009
```

```
2\. 1989                 
```

```
3\. 福特 12SE 1994 6262552 DBZRLZ0 7/26/2012 出售 7/9/2009
```

```
3\. 1994                  
```

我正在逐行获取数据，但年份 mfg 和年份 dlv 在一行中的两行（或同一字段中的两行）。当粘贴在 excel 上时，它首先制作 2 行，其中包含行中的所有数据，包括年份 mng 和仅用于年份 dlv 的第二行（在同一列中）。

我可以通过添加额外的列并处理该额外的字段并删除空白等来在 excel 中解析这些信息。但是我想省略 excel 部分并从 TXT 文件中导入它，该文件在粘贴时也会每行创建 2 行，并使用制表符作为分隔符（如 txt 文本制表符分隔）。

当我使用批量插入导入时，它会导入两倍的行，但我无法想象将第二行解析为新列的方法。

有人可以帮忙吗？在 t-sql 中（每一行只有一行信息，但在 year mfg /year dlv 列中，有两行）。或者指出我要阅读什么或哪种方法更好？也许一次导入 2 行 ETC。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T09:12:55.013

您可以将文本文件中的数据集导入到包含空白行的临时表中。这将为您提供具有 2 种记录类型的 SQL 数据集。1\. 包含交货日期以外的所有数据的记录。2\. 只有交货日期而没有其他字段的记录。（添加唯一的自动增量键）

因为相关的记录会分开一条记录，所以Record N和Records N+1实际上是同一条记录。

然后一个选择查询通过 RecID = RecId+1 将临时表连接到其自身将给出包含所有字段的完整记录

SELECT * FROM tmpTable AS MainRecord
INNER JOIN tmpTable AS MissingField
ON MainRecord.RecId = MissingField.RecId +1

从这个数据集中，您可以插入到您的主要数据中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T02:05:32.713

你知道如何使用VBA吗？在 TSQL 中使用此代码之前，您可以在 Excel 中运行此代码 (FixData())，从而修复额外的行问题。希望这可以帮助

```
Option Explicit

Public Sub FixData()
    Dim ws As Excel.Worksheet
    Dim iCurRow As Long
    Dim iLastRow As Long

    Set ws = ActiveSheet
    iLastRow = ws.Cells.SpecialCells(xlCellTypeLastCell).Row

    ' move through the spreadsheet from bottom to top
    For iCurRow = iLastRow To 1 Step -1
        If (isCurrentRowMessedUp(ws, iCurRow) = True) Then
            Call AppendDataToPreviousRow(ws, iCurRow)

            ' delete the row since we moved the data out of there
            ws.Rows(iCurRow).EntireRow.Delete
        End If
    Next
End Sub

Private Sub AppendDataToPreviousRow(ByRef ws As Excel.Worksheet, ByVal currentRow As Long)
    Dim firstCellInRow As Excel.Range
    Dim lastCellInRow As Excel.Range
    Dim previousRowRangeToPaste As Excel.Range

    ' check if first column has data in it, otherwise find the first column that has data
    If (ws.Cells(currentRow, 1).Value = vbNullString) Then
        Set firstCellInRow = ws.Cells(currentRow, 1).End(xlToRight)
    Else
        Set firstCellInRow = ws.Cells(currentRow, 1)
    End If

    Set lastCellInRow = ws.Cells(currentRow, ws.Columns.Count).End(xlToLeft)
    Set previousRowRangeToPaste = ws.Cells(currentRow - 1, getNextColumnAvailableInPreviousRow(ws, currentRow))

    ws.Range(firstCellInRow, lastCellInRow).Cut previousRowRangeToPaste
End Sub

Private Function isCurrentRowMessedUp(ByRef ws As Excel.Worksheet, ByVal currentRow As Long) As Boolean
    Dim cellCountInRow As Long
    Dim firstCellInRow As Excel.Range
    Dim lastCellInRow As Excel.Range

    Set firstCellInRow = ws.Cells(currentRow, 1)
    Set lastCellInRow = ws.Cells(currentRow, ws.Columns.Count).End(xlToLeft)

    cellCountInRow = Application.WorksheetFunction.CountA(ws.Range(firstCellInRow, lastCellInRow))

    If (cellCountInRow <= 1) Then
        isCurrentRowMessedUp = True
    Else
        isCurrentRowMessedUp = False
    End If
End Function

Private Function getLastColumnInPreviousRow(ByRef ws As Excel.Worksheet, ByVal currentRow As Long) As Long
    Dim rng As Excel.Range
    Set rng = ws.Cells(currentRow - 1, 1).End(xlToRight)

    getLastColumnInPreviousRow = rng.Column
End Function

Private Function getNextColumnAvailableInPreviousRow(ByRef ws As Excel.Worksheet, ByVal currentRow As Long) As Long
    getNextColumnAvailableInPreviousRow = getLastColumnInPreviousRow(ws, currentRow) + 1
End Function 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-25T04:32:19.200

您可以使用`SQL Server Integration Service (SSIS)`将数据从任何源数据（如 excel）转换为任何目标数据（如 SQL Server）

![在此处输入图像描述](../Images/f6515c67147f63a8837e30861ecf0a6f.png)

# php - 我如何在文件上写两个字并避免数据注入？

> ID：12117742
> 
> 赞同：-1
> 
> 时间：2012-08-24T23:07:19.037
> 
> 标签：php, ajax, security, code-injection

问题很简单。我制作了一个小型 HTML5 游戏，因为我的一些朋友对此非常兴奋，所以我想建立一个名人堂。这个想法只是一个简单的csv，比如

```
Name,Points,Date
AAA,15,2012-08-25 
```

ETC。; 我该怎么做呢？我的想法是通过 ajax 请求将内容发送到 php 文件，该文件依次解析并写入 csv，但我无法想象如何在不被注意的情况下将数据发送到 php 文件（允许人们输入假分数）。

此外，这必须非常简单，所以，没有 node.js 等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T23:29:47.820

没有简单的方法可以做到这一点，因为没有服务器端验证，它仍然可以被伪造——这就是你看到的大多数 Flash 游戏都有可笑的高分的原因。

您可以使用的一种方法是基于时间的加密。这并不能使它万无一失，但是确实使手动伪造变得非常烦人和繁琐。

例如，您可以加密分数，使用 MS 中的当前时间戳作为密钥，并将哈希和时间发送到服务器。在服务器端，您可以使用时间作为密钥解密哈希。如果时间与当前服务器时间相差太远（考虑发送分数的时间），则丢弃分数。

一个示例请求是：

```
page.php?t={timestamp}&name={name}&h={encryptedscore} 
```

`t`MS中的时间是哪里，`name`是用户的名字，`h`是时间和分数的哈希。

这不是完全安全的，但是对于没有能力实时编辑脚本的任何人来说，它都会变得更难伪造。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T23:19:13.940

如果这是一个直接的 AJAX 调用，那么没有什么可以阻止任何人打开 Fiddler 并修改其中的 http 帖子。只需验证您从客户端收到的输入。确保数字是数字并且日期是有效日期。

你甚至在使用 SQL 吗？SQL 注入是人们从客户端获取输入并将其直接连接到 SQL 查询中的地方。

# .net - 由于 LayoutTransform，防止 WPF TextBlock 扩展文本

> ID：12117743
> 
> 赞同：1
> 
> 时间：2012-08-24T23:07:29.460
> 
> 标签：.net, wpf, xaml

我有一个应用程序，我在其中动态地将各种实例添加到 Canvas，并且底层 Canvas 具有缩放 LayoutTransform。这对于像矩形这样的视觉效果非常有用，它们正确地保持固定的笔划宽度，但随着画布使用 LayoutTransform 进行“缩放”，形状宽度/高度会扩大。然而，对于 TextBlock 实例，布局转换实际上是缩放文本的呈现，使字体有效地变大。我希望发生的事情是让 TextBlock 的左上角原点与布局转换一起翻译，文本保持相同的大小。

这是创建画布的 ItemsControl 的 XAML：

```
 <ItemsControl ItemsSource="{Binding Annotations}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <Canvas />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemContainerStyle>
                    <Style>
                        <Setter Property="Canvas.Left" Value="{Binding StartX}"/>
                        <Setter Property="Canvas.Top" Value="{Binding StartY}"/>                            
                    </Style>
                </ItemsControl.ItemContainerStyle>
                <ItemsControl.LayoutTransform>
                    <TransformGroup>
                        <ScaleTransform ScaleX="{Binding ZoomScale}" ScaleY="{Binding ZoomScale}" 
                                        CenterX="0.5" CenterY="0.5"/>
                    </TransformGroup>
                </ItemsControl.LayoutTransform>
            </ItemsControl> 
```

以下是一些从绑定集合呈现注释的数据模板：

```
 <DataTemplate DataType="{x:Type Annotations:RectangleAnnotation}">
        <Rectangle Width="{Binding Width}" Height="{Binding Height}" Stroke="Blue" IsHitTestVisible="False"/>
    </DataTemplate>

    <DataTemplate DataType="{x:Type Annotations:TextAnnotation}">
        <TextBlock Text="{Binding Text}" Foreground="Orange" IsHitTestVisible="False"/>
    </DataTemplate> 
```

Annotation 实例本身是简单的 INotifyPropertyChanged 实现，具有相关的绑定属性（TextAnnotation 的 StartX、StartY 和 Text。）

我还没有找到任何简单的方法来防止文本的布局缩放。但是，在我开始破解解决方案之前，我想我会检查一下：有人知道解决这个问题的干净方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T07:40:43.477

每个 Transform 都有一个 Inverse 属性，可以取消其效果。因此，您可以将 TextBlock 的 RenderTransform 绑定到缩放 Canvas 的 Transform 的 Inverse，这应该会撤消其对文本渲染的影响。

左上角通常是缩放的原点，所以如果一切都是默认的，文本应该按照您的指定移动到左上角。但是，如果您在画布上使用组合变换或不同的缩放中心，您可能需要稍微调整一下参数，但编写一个仅采用变换的比例因子的转换器应该很容易为了在不移动缩放中心的情况下创建反比例变换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T14:41:47.703

正如@hbarck 建议的那样，我无法绑定到 Inverse，因为这是 GeneralTransform 而不是 Transform。我通过按元素名称绑定到 ScaleTransform 并使用值转换器来反转缩放来解决这个问题：

```
 <Controls:InvertConverter x:Key="Invert"/>
    <DataTemplate DataType="{x:Type Annotations:TextAnnotation}">
        <TextBlock Text="{Binding Text}" Foreground="Orange" IsHitTestVisible="False">
            <TextBlock.RenderTransform>
                <ScaleTransform ScaleX="{Binding ScaleX, ElementName=AnnotationScale, Converter={StaticResource Invert}}"
                                ScaleY="{Binding ScaleY, ElementName=AnnotationScale, Converter={StaticResource Invert}}"/>
            </TextBlock.RenderTransform>
        </TextBlock>
    </DataTemplate> 
```

以及下面的转换器代码：

```
public sealed class InvertConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value == null || value.GetType() != typeof(double) || targetType != typeof(double))
            return null;

        return 1/(double)value;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value == null || value.GetType() != typeof(double) || targetType != typeof(double))
            return null;

        return 1 / (double)value;
    }
} 
```

# ruby-on-rails-3 - 升级到 Ruby 1.9.3 后 AWS Couchbase 集群上的客户端超时

> ID：12117746
> 
> 赞同：0
> 
> 时间：2012-08-24T23:08:13.213
> 
> 标签：ruby-on-rails-3, amazon-web-services, couchbase

在我们使用 Ruby 1.9.3（从 1.8.7）升级到 Rails 3.2.8 后，我们的 Couchbase 客户端无法再访问我们的 AWS 集群（Couchbase 1.8 社区版）。

```
1.9.3p194 :011 > c = Couchbase.new("http://ec2-184-169-237-63.us-west-1.compute.amazonaws.com:8091")
=> #<Couchbase::Bucket:0x007fe12d9e6c98 "http://ec2-184-169-237-63.us-west-1.compute.amazonaws.com:8091/pools/default/buckets/default/" default_format=:document, default_flags=0x0, quiet=false, connected=true, timeout=2500000> 

1.9.3p194 :012 > c.get("hello")
Couchbase::Error::Timeout: failed to get value (key="hello", error=0x16)
    from (irb):12:in `get'
    from (irb):12
    from /Users/playmeshinc/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands/console.rb:47:in `start'
    from /Users/playmeshinc/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands/console.rb:8:in `start'
    from /Users/playmeshinc/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

在管理面板上，我们甚至看不到任何请求到达服务器。

但是，如果我们在端口 11211 上使用 memcache 协议，则一切正常。如果我们在本地 couchbase 集群 (OSX) 上尝试相同的代码和相同的调用，一切正常。

知道可能发生了什么吗？是因为 Ruby Couchbase 客户端与 AWS 或 Ruby 1.9.3 不兼容吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T23:25:05.097

实际上我想通了，那是因为 AWS 上的 moxi 客户端会返回外部机器无法访问的内部 ip，这就是为什么当我从外部测试时它超时的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T23:46:01.393

Gem 绝对兼容 EC2 和 1.9.3。您使用的是什么版本的 couchbase gem？什么版本的libcouchbase？听起来罪魁祸首可能是 rvm 或其他东西。我建议尝试 gem 卸载，然后重新安装。还要确保 libcouchbase 是最新的。

# javascript - Jslint 改进 | url 的字符集

> ID：12117749
> 
> 赞同：2
> 
> 时间：2012-08-24T23:08:28.467
> 
> 标签：javascript, regex

对于这个原型 url 检查器。请注意，我现在要做的就是检查长度。

```
url:            /:\/\/(www\.)?.{1,200}\..{1,1800}/, 
```

Jslint.com 给出错误

```
Insecure '.' 
```

[我在这个SO 帖子](https://stackoverflow.com/questions/12100745/the-inverse-of-regualar-expression-improvment)上的这个否定字符集也有类似的错误。

鉴于这种背景，我认为很明显 jslint 不喜欢允许全部或几乎全部作为测试模式。

所以，我只需要更换 . 具有域的有效字符集和域之后的部分。

对于我可以简化为的域

```
[a-zA-Z0-9\-] 
```

域之后的部分的字符集是什么...ieafter foo.com/

所以有

```
// 
```

其次是

```
www.(optional) 
```

其次是

```
foo.boo.moo.(note it matched up until the last .) ( this character set is listed above) 
```

其次是

```
X 
```

我如何将所有 X 放在一起：

```
http://www.foo.X 
```

我不关心提取端口或查询信息，我只需要域之后所有内容的字符集，以使正则表达式根据 jslint “安全”。

请注意，我只是在尝试逐步改进。

JavaScript, The Good Parts 在正则表达式章节中有一个很好的 URL 检查器，但不是我现在需要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-03T02:28:41.680

您可以在 StackOverflow和[RFC 3986上的](http://www.ietf.org/rfc/rfc3986.txt)[这个答案](https://stackoverflow.com/a/8968450/406712)中找到您要查找的正则表达式详细信息

“主机”的具体字符和表达式是：`[a-z0-9\-._~%]+`

您可能要记住，有效的 URL 可以是 IP 地址（IPv4、IPv6 和 IPvFuture）的形式，请查看链接的 RegEx 了解详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-07T11:55:51.423

您无需更改正则表达式。

如果问题只是 JSLint 抱怨它，您可以禁用该选项。

要在[jslint.com](http://www.jslint.com/)上对其进行测试，请在“**选项**”部分查看：

```
[default]  . and [^...] in /RegExp/ 
```

并单击它以将其设置为`[true]`。

然后 JSLint 将接受您的正则表达式。

或者，您可以使用特殊注释来禁用检查。如果您将此测试代码粘贴到 JSLint 中，它将接受它，而无需手动更改选项设置：

```
/*jslint regexp: true */
var test = /:\/\/(www\.)?.{1,200}\..{1,1800}/; 
```

这是此选项的[文档](http://www.jslint.com/lint.html)：

> 容忍`.`和`[^...]`。在 /RegExp/
> 
> `true`如果`.`并且`[^...]`应该在 RegExp 文字中被允许。它们匹配的材料比预期的要多，从而使攻击者能够混淆应用程序。在安全应用程序中进行验证时，不应使用这些表单。

您在正则表达式中使用的方式似乎不太可能有任何“不安全” `.`，所以我会继续并覆盖 JSLint 设置。

（我现在看到这是一个非常古老的问题，但也许这个答案对其他人有用。）

# git - 可以发送有关 Git 中（特定）更改文件的警告吗？

> ID：12117752
> 
> 赞同：0
> 
> 时间：2012-08-24T23:09:12.597
> 
> 标签：git, ignore, gitignore

我有一个文件，它需要生产服务器的某些行（并且这些行要在备份服务器和个人框上注释掉）。由于 Git 似乎不可能从文件中排除某些行，有没有办法向用户发出某种警告，通知他们在推送到生产服务器时需要取消注释某些行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:53:44.433

是的，`pre-receive`钩子可能是你想要的。它们只是可执行文件，退出非零以取消推送。看[`git help hooks`](http://www.kernel.org/pub/software/scm/git/docs/githooks.html)

这似乎是最适合预提交挂钩的类型，但是对于每个新克隆都需要一些手动设置（*至少*一个符号链接）。如果这不是问题，那么最好让人们在他们忘记时重写提交，或者通过对这些行的更改使您的历史变得混乱。

# c# - 使用鼠标在 DevExpress gridview 中增加和减小字体大小

> ID：12117755
> 
> 赞同：0
> 
> 时间：2012-08-24T23:09:31.340
> 
> 标签：c#, events, gridview, devexpress

我正在尝试增加减小 DevExpress GridView 单元格中字体的大小。我知道该事件可能是

```
private void gridView1_MouseWheel(object sender, MouseEventArgs e) {} 
```

有没有人有实现此功能的经验？

我在谷歌上环顾四周，发现了这个： http: [//www.devexpress.com/Support/Center/p/Q20861.aspx](http://www.devexpress.com/Support/Center/p/Q20861.aspx)

但是，当我将此代码添加到我的解决方案时，我收到有关 Point、GridView 和 Font 缺少引用和使用指令的错误。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T11:13:58.213

从您在[页面](http://www.devexpress.com/Support/Center/p/Q20861.aspx)中提到的代码中，我做了一个小的修改，它对我有用。

```
GridView v = sender as GridView; 
```

对于 GridView 你必须添加这个，

```
using DevExpress.XtraGrid.Views.Grid; 
```

使用此代码，您无需使用`Point`类使用鼠标位置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T06:10:09.387

在属性中单击 Columns 属性，如果它有列，db-单击列`s name and select`CellStyle `and change`Font `property such you can change`HeaderStyle` 等等

# android - ANDROID：什么是颜色和色调的等效混合模式（porter duff）

> ID：12117756
> 
> 赞同：0
> 
> 时间：2012-08-24T23:09:34.603
> 
> 标签：android, graphics, android-canvas

我正在尝试创建我在 IOS 应用程序中看到的效果，其中他们使用颜色的混合模式和色调之一，但我在 PorterDuff.modes 枚举中找不到这些混合模式。你知道android中是否有等效的模式？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T23:44:03.553

这完全取决于您要做什么；根据使用的颜色，您可以使用`PorterDuff.Mode.MULTIPLY`或`SRC_OVER`; 色调稍微复杂一些。

如果没有一种模式适合您的需要（因为，不，没有默认的颜色/色调 PorterDuff 模式），[这个答案](https://stackoverflow.com/a/7917978/1438733)可能会让您觉得很有趣。它基本上是调整 a 的色调，[`ColorMatrix`](http://developer.android.com/reference/android/graphics/ColorMatrix.html)然后可以将其应用于 a `Drawable`。（该过程在前面的答案的 OP 中有详细说明。）

# c# - 处理锁定数据库的 SQLite 异常

> ID：12117759
> 
> 赞同：3
> 
> 时间：2012-08-24T23:10:06.463
> 
> 标签：c#, sqlite

我正在使用 SQLite 数据库文件，我注意到在使用数据库文件时，我看到它打印“SQLite 错误：数据库已锁定”。我曾尝试将 SQLiteException 与 try.catch 一起使用，但这不起作用。我想知道的是，如何在错误重复之前捕获错误并向用户显示消息？换句话说，我要做的是为连接设置默认重试\超时，以便我的应用程序在重试时不会出现无响应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T09:58:41.147

要解决此问题，只需重命名文件并将其复制回原来的名称和位置。

```
mv mydata.db temp.db
cp temp.db mydata.db 
```

您的问题类似于查询[“如何解锁 SQLite 数据库？”](https://stackoverflow.com/questions/151026/how-do-i-unlock-a-sqlite-database) 我认为为这个问题提供的答案将帮助您非常轻松地解决您的问题。

# objective-c - 使用 sqlite3 语句从 tableview 中删除

> ID：12117763
> 
> 赞同：1
> 
> 时间：2012-08-24T23:10:40.593
> 
> 标签：objective-c, xcode, uitableview, fmdb, delete-row

我正在尝试删除从 SQL 数据库填充的 UITableView 中的一行。

我使用的 sql 语句来自一个名为`databaseHanderClass`. 该方法采用一个整数，该整数是要删除数据库中的一行的 id - 主键。

```
-(BOOL) deleteFromDatabase: (NSInteger)delete_id
{
   FMDatabase *dbHandler = [FMDatabase databaseWithPath: [Utility getDatabasePath]];
   BOOL success;
   @try 
   {
        [dbHandler open];        
        success = [dbHandler executeUpdate:@"DELETE FROM inputs WHERE id=%d", delete_id];
        [dbHandler close];
   }
   @catch (NSException *exception) 
   {
       NSLog(@"fejl...%@", exception);
   }
   @finally 
   {
       return success;
   }
} 
```

我在 UITableView 中用于删除的方法如下。

```
- (void)tableView:(UITableView *)tableView commitEditingStyle (UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath 
{
    if (editingStyle == UITableViewCellEditingStyleDelete) 
    {
        [tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationFade];            

    }   
    else if (editingStyle == UITableViewCellEditingStyleInsert) 
    {
         //statement
    }   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:19:16.483

在`commitEditingStyle`中，您需要一次删除数据并删除行。否则您的表可能处于不一致的状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T12:35:34.927

您需要实现以下方法：**这应该有效**

对于您的数据库代码，请尝试：

```
-(BOOL) deleteFromDatabase: (NSInteger)delete_id
{
    FMDatabase *dbHandler = [FMDatabase databaseWithPath: [Utility getDatabasePath]];
    BOOL success = NO;

    if(![dbHandler open])
    {
        NSLog(@"Could not open DB");
        return NO; 
    }

    [dbHandler beginTransaction];
    success = [dbHandler executeUpdate:@"DELETE FROM inputs WHERE id = ?", 
    [NSNumber numberWithInt:delete_id]];

    [dbHandler commit]; 
    [dbHandler close];
    return success;
} 
```

对于“commitEditingStyle”方法，请尝试以下操作：

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath 
{
      if (editingStyle == UITableViewCellEditingStyleDelete) {
      NSInteger row_number_to_be_deleted = indexPath.row;
      //call method to delete from database
      [DatabaseHandler deleteFromDatabase:row_number_to_be_deleted];

      //now, fetch all details from Database
      self.dataSource = [DatabaseHandler getAllData];
      [tableView reloadData];
} 
```

对于“NumberOfRowsInSection”：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [self.dataSource count];
} 
```

对于“canEditRowAtIndexPath”：

```
-(BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    return YES;
} 
```

对于“editingStyleForRowAtIndexPath”：

```
- (UITableViewCellEditingStyle)tableView:(UITableView *)tableView
       editingStyleForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"Editing Style-DELETE %i", [indexPath row]);
    return UITableViewCellEditingStyleDelete;
} 
```

对于“commitEditingStyle”：

```
 - (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath 
 {

     if (editingStyle == UITableViewCellEditingStyleDelete) 
     {
         // Do whatever data deletion you need to do...
         // Delete the row from the data source
         /* This HAS to be changed by YOU */ 
         Employee* emp = [self.dataSource objectAtIndex:[indexPath row]]; 
         NSLog(@"Delete row %i", [indexPath row]);
         [DataEngine removeData:emp];
         [self.dataSource removeObjectAtIndex:[indexPath row]];
     } 
     [self.tableView reloadData];
} 
```

# java - 用于引用 s3 jar 文件的弹性 MapReduce libjars 参数

> ID：12117765
> 
> 赞同：0
> 
> 时间：2012-08-24T23:10:59.910
> 
> 标签：java, hadoop, amazon-s3, mapreduce, amazon-emr

我正在尝试在 Amazon 上运行自定义 jar EMR 作业，并且在我的 jar 文件中引用了 lucene jar 文件。我在 s3 的 lib 目录中有 jar 文件，我的 Jar 参数如下所示：

```
MyMainClass -libjars s3n://mybucket/lib/lucene-core-3.6.1.jar s3n://mybucket/myinput s3n://mybucket/myoutput 
```

作业失败，我不断收到以下错误：

> java.lang.NoClassDefFoundError: org/apache/lucene/analysis/Analyzer at java.lang.Class.forName0(Native Method) at java.lang.Class.forName(Class.java:247) at org.apache.hadoop.conf .Configuration.getClassByName(Configuration.java:861) 在 org.apache.hadoop.conf.Configuration.getClass(Configuration.java:906) 在 org.apache.hadoop.conf.Configuration.getClass(Configuration.java:932) 在org.apache.hadoop.mapred.JobConf.getMapperClass(JobConf.java:959) at org.apache.hadoop.mapred.MapRunner.configure(MapRunner.java:34) ... 14 更多原因：java.lang.ClassNotFoundException : org.apache.lucene.analysis.Analyzer at java.net.URLClassLoader$1.run(URLClassLoader.java:202) at java.security.AccessController.doPrivileged(Native Method) at java.net.URLClassLoader.findClass(URLClassLoader.java :190) 在 java.lang。ClassLoader.loadClass(ClassLoader.java:306) at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301) at java.lang.ClassLoader.loadClass(ClassLoader.java:247) ... 21 更多

它似乎没有找到 lucene jar 文件......我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T10:12:38.397

如果您的 runner 类实现了 Tool 接口，那么 Hadoop 将`GenericOptionsParser`在后台调用，它会`-libjars`自动获取您的参数。

# php - Mysql connect = 没有选择数据库？然后拒绝访问

> ID：12117770
> 
> 赞同：-1
> 
> 时间：2012-08-24T23:12:14.453
> 
> 标签：php, mysql

我正在研究一个 php mysql 连接脚本。我希望它使用函数，这样我就可以跟踪什么是什么，所以 Mysql connect 有一个函数。当我运行它时，我首先得到“未选择数据库”，当我手动指定它时，它显示“@ localhost 的访问被拒绝”。

代码

```
<?php
/* Mysql Data */
$MySqlUser = "root";
$MySqlPass = "**********";
$MySqlHost = "localhost";
$MySqlDataBase = "serveradmin";
/* End Mysql Data */
function MySqlConnect() {
    $Connect = mysql_connect($MySqlHost, $MySqlUser, $MySqlPass);
    $Database = mysql_select_db($MySqlDataBase);
    if (!$Connect | !$Database) {
        die("Cannot connect ".mysql_error());
    }
}
MySqlConnect()
?> 
```

那么问题来了，是什么原因造成的呢？我希望脚本干净整洁，并且不确定 function() 是否会导致它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:30:47.010

这将解决它，但请查看[PDO](http://www.php.net/manual/en/book.pdo.php)或[mysqli](http://www.php.net/manual/en/mysqli.construct.php)

```
<?php
/* Mysql Data */
$MySqlUser = "root";
$MySqlPass = "**********";
$MySqlHost = "localhost";
$MySqlDataBase = "serveradmin";
/* End Mysql Data */
function MySqlConnect($MySqlUser, $MySqlPass, $MySqlHost, $MySqlDataBase ) {
    $Connect = mysql_connect($MySqlHost, $MySqlUser, $MySqlPass);
    $Database = mysql_select_db($MySqlDataBase);
    if (!$Connect | !$Database) {
        die("Cannot connect ".mysql_error());
    }
    return $Database;
}
$Database = MySqlConnect($MySqlUser, $MySqlPass, $MySqlHost, $MySqlDataBase );
?> 
```

# iphone - OpenGL ES 2.0 和 GLKit：从 GLKBaseEffect 着色器到 OpenGL

> ID：12117772
> 
> 赞同：2
> 
> 时间：2012-08-24T23:12:26.563
> 
> 标签：iphone, objective-c, ios, opengl-es, opengl-es-2.0

我正在使用 OpenGL ES 2.0 和 GLKit 编写 2D 游戏。我的架构基于 Ian Terrel 的 Games 教程。

我最近发现 GLKBaseEffect（提供简单的着色器 mgmt）泄漏并且有时使我的应用程序崩溃。我现在正在使用我自己的着色器文件（基于 Ray Wenderlich 教程），但此时，我刚刚成功显示了 openGl 背景颜色。我的形状颜色和纹理不再显示。

**重要提示**：我错误地设置了当前上下文，现在 openGL 说无效的 Drawable。

这是我的 shape.m 代码的一部分：

```
@implementation P3Shape

const GLushort indices[] = {
    0,1,2,3
};

typedef struct {
    float Position[2];
    float Color[4];
    float TexCoord[2];
} Vertex;

//testing
const Vertex Vertices[] = {
    // Front
    {{10, -15}, {1, 0, 0, 1}, {1, 0}},
    {{10, 15}, {0, 1, 0, 1}, {1, 0}},
    {{-10, 10}, {0, 0, 1, 1}, {0, 0}},
    {{-10, -1}, {0, 0, 0, 1}, {0, 1}},
};

- (id)initWithLayer:(CAEAGLLayer *)layer {
    self = [super init];
    if (self) {
        [...]
        _currentContext = [P3SessionState currentContext];
        _eaglLayer = layer;
        _eaglLayer.opaque = YES;
        [self setupRenderBuffer];        
        [self setupFrameBuffer]; 
        [self addToProgram];
        [self createBuffers];
    }
    return self;
}

- (int)numVertices {
    return 0;
}

- (void) addToProgram {
    // setted before in the gamemanager
    GLuint programHandle = [P3SessionState programHandle];

    _positionSlot = glGetAttribLocation(programHandle, "Position");
    _colorSlot = glGetAttribLocation(programHandle, "SourceColor");

    _projectionUniform = glGetUniformLocation(programHandle, "Projection");
    _modelViewUniform = glGetUniformLocation(programHandle, "Modelview");

    _texCoordSlot = glGetAttribLocation(programHandle, "TexCoordIn");
    _textureUniform = glGetUniformLocation(programHandle, "Texture");
}

- (void)setupRenderBuffer {
    glGenRenderbuffers(1, &_colorRenderBuffer);
    glBindRenderbuffer(GL_RENDERBUFFER, _colorRenderBuffer);        
    [_currentContext renderbufferStorage:GL_RENDERBUFFER fromDrawable:_eaglLayer];    
}

- (void)setupFrameBuffer {    
    GLuint framebuffer;
    glGenFramebuffers(1, &framebuffer);
    glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);   
    glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, _colorRenderBuffer);
    glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, _depthRenderBuffer);
}

- (void)createBuffers {
    // Static index data
    glGenBuffers(1, &indexBuffer);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, indexBuffer);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);

    glGenBuffers(1, &vertexBuffer);
    glBindBuffer(GL_ARRAY_BUFFER, vertexBuffer);
    glBufferData(GL_ARRAY_BUFFER, sizeof(Vertices), Vertices, GL_STATIC_DRAW);
}

// initialize the vertex data

- (GLKVector2 *)vertices {
    if (vertexData == nil) {
        vertexData = [NSMutableData dataWithLength:sizeof(GLKVector2)*self.numVertices];
    }
    return [vertexData mutableBytes];
}

// set a textureImage, allocate a glname and enable the GL_TEXTURE_2D and all
- (void)setTextureImage:(UIImage *)image {
    CGImageRef spriteImage = image.CGImage;
    if (!spriteImage) {
        NSLog(@"Failed to load image %@", image);
        exit(1);
    }

    size_t width = CGImageGetWidth(spriteImage);
    size_t height = CGImageGetHeight(spriteImage);

    GLubyte * spriteData = (GLubyte *) calloc(width*height*4, sizeof(GLubyte));

    CGContextRef spriteContext = CGBitmapContextCreate(spriteData, width, height, 8, width*4, CGImageGetColorSpace(spriteImage), kCGImageAlphaPremultipliedLast);    

    CGContextDrawImage(spriteContext, CGRectMake(0, 0, width, height), spriteImage);

    CGContextRelease(spriteContext);

    GLuint texName;
    glGenTextures(1, &texName);
    glBindTexture(GL_TEXTURE_2D, texName);

    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST); 

    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, width, height, 0, GL_RGBA, GL_UNSIGNED_BYTE, spriteData);

    free(spriteData);        
    _imageTexture = texName;
}    

- (GLKVector2 *)textureCoordinates {
    if (textureCoordinateData == nil)
        textureCoordinateData = [NSMutableData dataWithLength:sizeof(GLKVector2)*self.numVertices];
    return [textureCoordinateData mutableBytes];
}

- (void)render {

    glEnable(GL_BLEND);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

    glClearColor(0, 104.0/255.0, 55.0/255.0, 1.0);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glUniformMatrix4fv(_modelViewUniform, 1, 0, modelview.m);
    glUniformMatrix4fv(_projectionUniform, 1, 0, projectionMatrix.m);

    glEnableVertexAttribArray(_positionSlot);

    glEnableVertexAttribArray(_colorSlot);
    glBindBuffer(GL_ARRAY_BUFFER, vertexBuffer);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, indexBuffer);

    glVertexAttribPointer(_positionSlot, 2, GL_FLOAT, GL_FALSE, sizeof(Vertex), 0);
    glVertexAttribPointer(_colorSlot, 4, GL_FLOAT, GL_FALSE, sizeof(Vertex), (GLvoid*) (sizeof(float) * 3));
    if(texture != nil) {
        glEnableVertexAttribArray(_texCoordSlot);
        glActiveTexture(GL_TEXTURE0); // unneccc in practice
        glBindTexture(GL_TEXTURE_2D, _imageTexture);
        glUniform1i(_textureUniform, 0); // unnecc in practice
        glVertexAttribPointer(_texCoordSlot, 2, GL_FLOAT, GL_FALSE, sizeof(Vertex), (GLvoid*) (sizeof(float) * 7));
    }

        glDrawElements(GL_TRIANGLE_FAN, sizeof(indices)/sizeof(GLushort), GL_UNSIGNED_SHORT, (void*)0);
    }
    //is cleanup code that tells the shader that we’re done using vertex position data.
    glDisableVertexAttribArray(GLKVertexAttribPosition);

    if (texture != nil)
        glDisableVertexAttribArray(GLKVertexAttribTexCoord0);

    [_currentContext presentRenderbuffer:GL_RENDERBUFFER];

    glDisable(GL_BLEND);
}

// draw the shape in the selected scene
- (void)renderInScene:(P3Scene *)theScene {

    projectionMatrix = [theScene projectionMatrix];

    modelview = GLKMatrix4Multiply(GLKMatrix4MakeTranslation(0, 0, 0), GLKMatrix4MakeRotation(0, 0, 0, 1));
    modelview = GLKMatrix4Multiply(modelview, GLKMatrix4MakeScale(scale.x, scale.y, 1));

    [self render];
}

-(void)update:(NSTimeInterval)dt {
    if(self.toDraw)
        [spriteAnimation update:dt];
}

@end 
```

如您所见，我正在使用 Vertices 数组和基本颜色进行测试，但没有区别。OpenGL 似乎设置正确，因为*glClearColor(0, 104.0/255.0, 55.0/255.0, 1.0);我的视图是绿色的* 在渲染函数中。

这里是 pastebin 上的文件：

[粘贴箱上的 P3Shape.m](http://pastebin.com/QymUWQef)

以及创建 ogl 程序的经理

[pastebin 上的 P3GameManager.m](http://pastebin.com/3n5iwYy2)

有任何想法吗 ？

编辑：也许我的着色器有问题？

顶点：

```
attribute vec4 Position; 
attribute vec4 SourceColor; 

varying vec4 DestinationColor; 

uniform mat4 Projection;
uniform mat4 Modelview;

attribute vec2 TexCoordIn; // New
varying vec2 TexCoordOut; // New

void main(void) { 
    DestinationColor = SourceColor; 
    gl_Position = Projection * Modelview * Position;
    TexCoordOut = TexCoordIn; // New
} 
```

和片段：

```
varying lowp vec4 DestinationColor;

varying lowp vec2 TexCoordOut; // New
uniform sampler2D Texture; // New

void main(void) {
    gl_FragColor = DestinationColor * texture2D(Texture, TexCoordOut); // New
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:04:21.597

我推荐使用 GLKViewController 和 GLKView 来简化你的设置。同样，将纹理加载替换为 GLKTextureLoader。

我没有看到 GLKBaseEffect 泄漏内存并导致崩溃的任何问题。我建议发布一个关于这个特定问题的新问题，如果您不需要自定义着色器（看起来您不需要），则返回使用 GLKBaseEffect。将使您的代码更易于管理和调试。

# svn - .SVN 并确定本地文件与其在存储库中的路径的关系？

> ID：12117774
> 
> 赞同：1
> 
> 时间：2012-08-24T23:13:22.453
> 
> 标签：svn, eclipse-plugin

我正在尝试确定本地文件与其在存储库中的绝对路径的映射。理想情况下，我实际上正在寻找相反的方法。我有一个 API 可以远程向我提供存储库中文件的完整路径。我想获取该信息并查看本地某处并找到其本地副本。我认为 .svn 文件夹将是这些信息所在的位置。但是，当我查看此文件时，我看到两个文件夹 pristine 和 tmp。此外，还有文件条目、格式和 wc.db。根据我的研究，我可以看出这就是新的 SVN 1.7 存储数据的方式。而不是在每个目录中都有 .SVN 文件夹，而只是在根目录中。对于我的一生，我找不到在哪里可以找到该信息。

最终的最终目标是能够快速进行 API 调用以远程获取文件的位置。然后在本地查看某个文件以查看该文件在本地映射到的位置。然后使用 Eclipse 插件，我知道该本地文件所在的位置，并且可以作为回报为用户打开它。有什么想法可以让我完成这项工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-27T05:58:34.690

**获取修订和相对路径：**

```
./sqlite3.exe wc.db  "select changed_revision, repos_path from NODES order by changed_revision desc limit 1" > xx.txt 
```

**获取根路径：**

```
./sqlite3.exe wc.db  "select root from REPOSITORY;" 
```

希望这两个会有所帮助。

# windows - 指定编译器 NVCC 用于编译主机代码

> ID：12117779
> 
> 赞同：4
> 
> 时间：2012-08-24T23:13:53.210
> 
> 标签：windows, compiler-construction, cuda, nvcc

运行 nvcc 时，它始终使用 Visual C++ 编译器 ( `cl.exe`)。我怎样才能让它使用 GCC 编译器？

将`CC`环境变量设置为`gcc`并没有解决它。我在可执行文件帮助输出中也找不到任何选项。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T03:25:49.760

在 Windows 上，NVCC 仅支持 Visual C++ 编译器 (cl.exe) 进行主机编译。

您当然可以使用 GCC 编译 .cpp（非 CUDA）代码并将对象与 nvcc 生成的对象链接。

# mvvm - 我可以从 IoC 容器访问 Messenger 吗？

> ID：12117784
> 
> 赞同：0
> 
> 时间：2012-08-24T23:14:25.710
> 
> 标签：mvvm, inversion-of-control, ioc-container, messenger

我是 IoC 的新手，我正在尝试遵循最佳实践来应用它。我有一个 ListViewModel，我想从中创建一个新的 EditViewModel，它接受必须修改的对象的注入。

我认为解决方案可能是将包含此对象的消息发送到 IoC 容器，然后将其传递给 EditViewModel。

我可以做吗？有没有更好的办法？

非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T15:06:40.940

如果您希望您的视图模型创建其他视图模型，那么您需要创建一个视图模型工厂。您`ListViewModel`会将此视图模型工厂作为依赖项（例如通过构造函数注入），然后当它想要创建编辑视图模型时，它可以执行以下操作：

```
var editViewModel = this.EditViewModelFactory.Create(modelToEdit); 
```

或者

```
var editViewModel = this.EditViewModelFactory.Create();
editViewModel.SetModel(modelToEdit); 
```

您希望通过 IoC 容器解析编辑视图模型工厂。Castle Windsor 和 Ninject 等容器允许自动工厂注册。在这种情况下，您只需为工厂定义接口，容器实际上会为您实例化一个实现该接口的类型。

您当然不希望您的应用程序通过中介与您的容器通信。

# java - java重绘阻止jbutton

> ID：12117785
> 
> 赞同：0
> 
> 时间：2012-08-24T23:14:34.847
> 
> 标签：java, swing, graphics, jbutton, jcomponent

在我的paintComponent() 方法中，我有一个绘制jpanel 背景的drawRect()。但是因为在调用paintComponent() 方法之前jbutton 是在屏幕上绘制的，所以jbutton 被drawRect 挡住了。有谁知道如何解决这一问题？我的猜测是在调用 repaint 之前添加 jbutton，但我不知道该怎么做？

一些代码：

```
public Frame(){
  add(new JButton());
}

public void paintComponent(Graphics g){
  super.paintComponent(g);
  g.drawRect(0,0,screenwidth,screenheight); //paints the background with a color 
                                            //but blocks out the jbutton.
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T23:46:23.860

现在，首先，我会告诉你你在这里做错了什么——`JFrame`不是 a `JComponent`，并且没有`paintComponent`你可以覆盖。您的代码可能永远不会被调用。除此之外，`drawRect`仅绘制一个矩形 - 它不会*填充*一个。

* * *

但是，我相信有一种适当的方法可以做到这一点。

由于您使用的是，因此您应该通过.`JFrame`来利用容器的*分层窗格*[`JFrame.getLayeredPane`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JFrame.html#getLayeredPane())。

> 分层窗格是一个具有深度的容器，这样重叠的组件可以一个在另一个之上。有关分层窗格的一般信息在[如何使用分层窗格](http://docs.oracle.com/javase/tutorial/uiswing/components/layeredpane.html)中。本节讨论根窗格如何使用分层窗格的细节。

![](../Images/7605e82a56ab0dc0e29d910e5678e42d.png)

*Java 教程的一部分[如何使用根](http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html)*窗格*中介绍了根窗格。分层窗格是根窗格的子窗格，而`JFrame`作为顶级容器的`JRootPane`.*

 *无论如何，由于您对创建背景感兴趣，请参阅下图了解分层窗格通常在顶级容器中的外观：

![](../Images/fa9192c7831e7362480c56f93c50bd23.png)

> 下表描述了每一层的预期用途，并列出了对应于每一层的 JLayeredPane 常量：
> 
> **图层名称**-**值**-**描述**
> 
> `FRAME_CONTENT_LAYER` - `new Integer(-30000)`- 根窗格在此深度将菜单栏和内容窗格添加到其分层窗格。

由于我们要指定我们的背景在内容的后面，所以我们首先将其添加到同一层（[`JLayeredPane.FRAME_CONTENT_LAYER`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JLayeredPane.html#FRAME_CONTENT_LAYER)），如下：

```
final JComponent background = new JComponent() {

  private final Dimension size = new Dimension(screenwidth, screenheight);

  private Dimension determineSize() {
    Insets insets = super.getInsets();
    return size = new Dimension(screenwidth + insets.left + insets.right,
        screenheight + insets.bottom + insets.top);
  }

  public Dimension getPreferredSize() {
    return size == null ? determineSize() : size;
  }

  public Dimension getMinimumSize() {
    return size == null ? determineSize() : size;
  }

  protected void paintComponent(final Graphics g) {
    g.setColor(Color.BLACK);
    g.fillRect(0, 0, screenwidth, screenheight);
  }
};
final JLayeredPane layeredPane = frame.getLayeredPane();
layeredPane.add(background, JLayeredPane.FRAME_CONTENT_LAYER); 
```

现在，为了确保我们在内容之前绘制背景，我们使用[`JLayeredPane.moveToBack`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JLayeredPane.html#moveToBack(java.awt.Component))：

```
layeredPane.moveToBack(background); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-24T23:38:07.953

我做了这个非常快速的测试。正如 HovercraftFullOfEels 指出的那样。JFrame 没有 a `paintComponent`，所以我用 a`JPanel`代替。

![你可以看到我吗](../Images/b92122e92cae527a46417980fa5bf3cc.png)

这是由这段代码产生的

```
public class PanelTest extends JPanel {

    private JButton button;

    public PanelTest() {

        setLayout(new GridBagLayout());

        button = new JButton("Can you see me ?");
        add(button);

    }

    @Override
    protected void paintComponent(Graphics g) {

        super.paintComponent(g);

        Rectangle bounds = button.getBounds();
        bounds.x -= 10;
        bounds.y -= 10;
        bounds.width += 20;
        bounds.height += 20;

        g.setColor(Color.RED);
        ((Graphics2D)g).fill(bounds);

    }

} 
```

我已经尝试通过`paintComponents`在 上使用来复制问题`JFrame`，但我没有看到矩形。即使我`paint`在 上覆盖`JFrame`，矩形仍然绘制在按钮下方（我也不建议这样做）。

问题是，你没有给我们足够的代码来知道出了什么问题

ps -`drawRect`不会“填充”任何东西

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-25T08:29:31.430

我以前遇到过这种情况，尽管不是专门针对 jframe 的，也不是您所拥有的那种场景。试试这个代码，

```
 this.getContentPane.repaint(); 
```

在你的 jframe 上。我不确定这一点，但试一试。*

# c# - 使用 Linq 使用 ObservableCollection 属性填充对象

> ID：12117790
> 
> 赞同：1
> 
> 时间：2012-08-24T23:15:32.417
> 
> 标签：c#, linq

我喜欢 Linq，但很喜欢它，我似乎总是忘记如何使用它。我搜索但似乎找不到合适的答案。这是我的问题

我有两个表 table_2 有 table_1 的外键

```
table_1
----------
 - userID 
 - Name

tabel_2
----------
 - userID
 - ownID
 - codeKey 
```

现在我有一个对象（用户），我想用 userId 和 name 以及`ObservableCollection`table_2 中的所有 userID 行填充

对象样本：

```
public class User
{
    public string Name { get; set; }
    public long UserID { get; set; }

    public ObservableCollection<Message> Messages { get; set; }
}

public class Message
{
    public string CodeKey { get; set; }      
    public  long OwnID { get; set; }
    public  long UserID { get; set; }
} 
```

我尝试执行以下操作；它有效，但不确定它是否是正确的做法：

```
var request = from tb1 in db.table_1
              select new User()
              {
                  Name = tb1.Name,                                  
                  UserID = tb1.UserID,

                  Messages = new ObservableCollection<Message>(
                             from tb2 in db.table_2
                             where tb2.UserID == tb1.UserID
                             select new SmsMessage()
                             {
                                 CodeKey=tb2.CodeKey,
                                 OwnID = tb2.ownID,                                                    
                                 UserID = tb2.UserID
                             })
              };
return new ObservableCollection<User>(request); 
```

感谢您的帮助和时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T15:07:30.540

你可以用更简单的方法来做。如果您的实体是使用这些关系创建的，您应该能够执行以下操作：

```
var query = from tb1 in db.table_1.Include("table_2")
            select tb1; 
```

查询将是一个带有对象列表的 IEnumerable，每个对象都将包含 table_1 数据和一个属性及其对应的 table_2 对象。

因此，您可以通过简单的 foreach 循环填充您的用户集合。

如果您只想使用 linq 查询来执行此操作，则可以尝试使用以下方法：

```
var request = from tb1 in db.table_1.Include("table_2")
                      select new User()
                          {
                              Name = tb1.Name,                                  
                              UserID = tb1.UserID,

                              Messages = tb1.table_2;
                          };

     return new ObservableCollection<User>(request); 
```

从未尝试过，所以我不确定这个解决方案 8-)

# android - viewpager 页面中 mapview 的手势问题

> ID：12117791
> 
> 赞同：22
> 
> 时间：2012-08-24T23:15:44.803
> 
> 标签：android, google-maps, android-viewpager

我的应用程序的主界面是一个viewpager，用户只需水平滑动页面即可到达各个页面。其中一页有一个谷歌地图视图（粘贴在下面）。我的问题是，如果用户在地图页面上并使用水平滑动手势，页面会滑动到下一页而不是地图横向移动。就好像 viewpager 在地图之前获取手势一样。

如果用户很聪明并开始沿对角线或垂直方向滑动地图，则地图开始移动，然后手势可以水平继续。但我更喜欢地图移动而不是简单的水平滑动手势上的页面。页面始终可以使用 textview 滑动。

有什么办法可以做到这一点？
谢谢，加里

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/ContentPanel"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

 <TextView
    android:id="@+id/tvMAP"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="Map"
    style="@style/bigtype" />

<com.google.android.maps.MapView
    android:id="@+id/mapview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:apiKey="mykeygoeshere"
    android:clickable="true" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-08-24T23:28:09.107

当然有：

```
public class CustomViewPager extends ViewPager {

    public CustomViewPager(Context context) {
        super(context);
    }

    public CustomViewPager(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    protected boolean canScroll(View v, boolean checkV, int dx, int x, int y) {
        if(v instanceof MapView){
            return true;
        }
        return super.canScroll(v, checkV, dx, x, y);
    }

} 
```

这将使地图忽略地图内的所有幻灯片，而只关心地图外的幻灯片/拖动。希望能帮助到你。（我现在为具有水平滚动的 webview 执行此操作）

**编辑：**忘了提到你需要在你的布局中使用 CustomViewPager 而不是 ViewPager。

```
<com.yourpackage.CustomViewPager
            android:id="@+id/viewpager"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" 
        /> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-24T23:16:00.857

如果使用 Google Maps V2，请使用

**scrollingView.getClass().getPackage().getName().startsWith("maps.")** 在**canScroll**方法中：

```
@Override
protected boolean canScroll(View scrollingView, boolean checkV, int dx, int x, int y) {
    if (scrollingView.getClass().getPackage().getName().startsWith("maps.")) {
        return true;
    }
    return super.canScroll(scrollingView, checkV, dx, x, y);
} 
```

**因为**使用 maps v2 时**scrollingView**是maps.jb。

 **同样在我的代码中，使用了这些类：

```
import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.SupportMapFragment; 
```**

# android - Android 解析 JSON 与 JSON 覆盖

> ID：12117793
> 
> 赞同：0
> 
> 时间：2012-08-24T23:15:54.237
> 
> 标签：android, json, parsing, overlay

我想知道人们如何看待将 JSON 解析为 POJO 与使用 JSON 覆盖对象的优缺点。

用例：返回 Person JSON 文档的 REST 调用。

例如

[{"name":"name1"}, {"name":"name2}, ...]

解决方案1：

使用 GSON、Jackson、JSONObject/JSONArray（手动）等将所有传入的 JSON 解析为 POJO。

结果：

```
class Person {

    String name;

    public String getName() {

        return name;
    }
} 
```

解决方案2：

创建使用 JSONObject 访问方法的覆盖类。

结果：

```
class Person {

    JSONObject json;

    public String getName() {

        json.getString("name");
    }
} 
```

特别是，我对 Android 上有限的系统资源感兴趣。我是要预先产生解析成本并使用更多内存，还是要在数据访问期间产生解析成本，例如在 ListView 中。

有关系吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T00:00:13.290

我通常更喜欢解决方案 1。

1.  作为单个异步任务下载和解析非常简单。与从 Web 下载相比，解析应该相当快。
2.  解析完成后，可以从内存中删除 JSON 数据，此时所需的内存较低。
3.  访问数据比在解决方案 2 中更快 - 如果您想在 UI 线程中使用它来例如更新`ListView`.

但是在某些情况下，解决方案 2 应该会产生更好的结果。就像当有成千上万的人或者数据的变化比你解析它的速度快时一样。A`ListView`仅请求当前可见的数据，因此解析将仅按需进行，并且或多或少独立于不可见项目的数据量。

如果解析单个项目需要很长时间，解决方案 2 也可以与异步方法一起使用，例如与`ListView`s 一起使用的异步图像加载器。在这种情况下，我会使用类似下面的东西，因为这样可以防止需要一直对同一个对象重复解析。

```
class Person {

    boolean parsed;
    String name;
    JSONObject json;

    public String getName() {
        if (!parsed) {
            name = json.getString("name");
            json = null;
            parsed = true;
        }
        return name;
    }
} 
```

# php - 在 PHP 中，include() 究竟是如何工作的？

> ID：12117796
> 
> 赞同：8
> 
> 时间：2012-08-24T23:16:18.720
> 
> 标签：php

如何`include('./code.php');`工作？我知道这相当于将代码直接“粘贴”在包含发生的位置，但是，例如：

如果我有两个页面，`page1.php`并且`page2.php`我需要在其中操作不同的变量和函数`./code.php`，是否会`include()`创建一个副本`./code.php`，或者它是否本质上链接回实际页面`./code.php`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T23:24:22.293

[请参阅手册](http://php.net/manual/en/function.include.php)。

如果您`include`是文本文件，它将在文档中显示为文本。

`include`不像复制粘贴**：**

**测试.php**

```
<?php
echo '**';
$test = 'test';
include 'test.txt';
echo '**';
?> 
```

**测试.txt**

```
echo $test; 
```

上面的示例将输出：

```
**echo $test;** 
```

如果你要包含 PHP 文件，你仍然需要 PHP 标签`<?php`和`?>`.

此外，通常括号不会放在 之后`include`，如下所示：

```
include 'test.php'; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-24T23:32:17.233

基本上，当解释器遇到一个`include 'foo.php';`语句时，它会打开指定的文件，读取其所有内容，用另一个文件中的代码替换“include”位并继续解释：

```
<?php
echo "hello";

include('foo.php');

echo "world"; 
```

变成（理论上的）

```
<?php
echo "hello";

?>
{CONTENT OF foo.php}
<?php

echo "world"; 
```

然而，这一切只发生在内存中，而不是磁盘上。没有文件被更改或任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T00:03:06.870

这取决于您如何包含`code.php`文件。如果您将 code.php 文件包含到 page1.php 然后 page2.php 那么您将可以访问它的 vars 并且它实际上只是“复制和粘贴”（注意这只是用来使其更容易理解，因为实际上面解释了它的动态）但是如果你像这样链接文件：

```
[code.php]
include('page1.php');
include('page2.php'); 
```

然后 code.php 将可以访问 page1.php 中的所有变量，但是：

*   page1.php 将无法访问 code.php 中的变量
*   page2.php 将无法访问 code.php 中的变量

因此，为了`inherit`code.php 的功能`page1.php`，`page2.php`请务必执行以下操作：

```
[page1.php]
include('code.php');

[page2.php]
include('code.php'); 
```

然后它将按您的预期工作。所以只是一些要记住的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-08T23:59:20.707

包含的行为不像复制粘贴。

这是使用 PHP 严格类型声明的演示

```
<?php

// function.php (file)

declare (strict_types = 1);

function sum(int $a, int $b)
{
  return $a + $b;
}

/**
 * This will throw TypeError: 
 */

// echo sum(5.2, 5); 
```

但是，如果我从外部文件调用此函数

```
<?php

// caller.php (file)

require_once 'function.php';

/**
 * This will Work instead of throwing a TypeError:
 */

echo sum(5.2, 5); 
```

为添加声明语句的文件启用严格类型 (function.php)

它不适用于从外部文件 (caller.php) 进行的任何函数调用，
因为 PHP 在评估严格类型时总是会服从调用者。

Require 不像复制/粘贴那样工作

为了进一步理解，
[关于如何执行 PHP 脚本的简短回答以及](https://stackoverflow.com/questions/2720488/how-exactly-is-a-php-script-executed/2720501#2720501)关于 include /
[require 在 php 中的真正作用的更易于理解的解释](https://stackoverflow.com/questions/34671230/what-does-require-really-do-in-php/34673238#34673238)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-24T23:23:20.123

```
include('./code.php'); // The Same As Pasting The Code From Code.PHP. 
```

在任何情况下它都不会重定向到 Code.php。

# ruby - 如何使用 FactoryBot 定义关联的工厂？

> ID：12117797
> 
> 赞同：10
> 
> 时间：2012-08-24T23:16:32.463
> 
> 标签：ruby, ruby-on-rails-3, rspec, factory-bot

给定两个模型，Alert 和 Zipcode，其中一个 Alert 必须有 1 个或多个 Zipcode：

```
class Alert < ActiveRecord::Base
  attr_accessible :descr, :zipcode

  has_many :zipcode
  validates :zipcode, :length => { :minimum => 1 }
end

class Zipcode < ActiveRecord::Base
  attr_accessible :zip
  belongs_to :alert
end 
```

我如何编写我的 FactoryBot 工厂，以便：

*   邮政编码工厂在他们自己的文件中定义
*   警报工厂在它们自己的文件中定义
*   Alert 可以依赖 Zipcode 定义的工厂吗？

我阅读的所有文档和示例都希望您在父工厂文件中定义包含的类，将它们全部放在一起，或者做出其他妥协或解决方法。没有一种干净的方法可以将规范工厂分开吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-24T23:16:32.463

诀窍是确保容器类，即定义中有 has_many 语句的容器类，在 FactoryBot 中将包含的类创建为数组。例如：

在您的 spec/factories/zipcodes.rb 中：

```
FactoryBot.define do
  factory :zipcode do
    zip { 78701 + rand(99) } 
  end
end 
```

在 spec/factories/alerts.rb 中：

```
FactoryBot.define do
  factory :alert do
    zipcode { Array.new(3) { FactoryBot.build(:zipcode) } }
  end
end 
```

# java - spring mvc ajax表单后期处理，可能的方法及其优缺点

> ID：12117799
> 
> 赞同：6
> 
> 时间：2012-08-24T23:16:37.923
> 
> 标签：java, spring, jquery, spring-mvc

我目前正在学习使用 Spring MVC。**在开发过程中，我使用了四种不同类型的Ajax 和 jQuery**表单处理。现在，我想知道每种方法的优点和缺点是什么。还有其他人吗？

假设我们有一个非常简单的表单，只有 2 个输入

```
<input id="name" type="text" value"Name">
<input id="active" type="checkbox">
<input type="button" onclick="submitForm()"> 
```

假设我们没有在客户端和服务器站点上验证数据。我们还将省略处理返回的数据。我只是对向服务器发送数据感兴趣。现在我们如何处理提交？我的解决方案是：

**1.基于PathVariable的请求**

JS 发送请求看起来像这样：

```
function submitForm() {
    var name = jQuery("#name").val();
    var active = jQuery("#active").is("checked");

    jQuery.ajax("/Submit/Name/" + name + "/Active/"+ active + "/",
    {
        type:"POST"
    });   
} 
```

还有控制器：

```
 @RequestMapping(value="/Submit/Name/{name}/Active/{active}/",method=RequestMethod.POST)
 publis void submitForm(@PathVariable String name, @PathVariable Boolean active)
 { //something not important here } 
```

我认为的优点

*   在控制器中接收数据的快速方法，简单的注释使其工作
*   基本数据类型的类型处理（字符串、布尔值、数字）

缺点

*   请求地址随所需数据而增长
*   url中的特殊字符有问题吗？不确定这个，但我记得我的队友`/`在发送到服务器的数据中用作字符时遇到问题

**2\. 带数据的请求**

我不知道如何命名它，但这是 JS 文件中的想法：

```
function submitForm() {
    var name = jQuery("#name").val();
    var active = jQuery("#active").is("checked");

    var object = {name:name,active:active};

    jQuery.ajax("/Submit/",
    {
        type:"POST",
        data: object
    });   
} 
```

和控制器：

```
 @RequestMapping(value="/Submit/",method=RequestMethod.POST)
 publis void submitForm(@RequestParam(value="name") String name, @RequestParam(value="active") Boolean active)
 { //something not important here } 
```

在我看来，与第一种方法没有太大区别，但是：

优点

*   较短的请求地址

缺点

*   带有许多参数的方法声明可能很大

**3.将 JSON 作为 PathVariable 发送到服务器**

在 JS 文件中：

```
function submitForm() {
    var name = jQuery("#name").val();
    var active = jQuery("#active").is("checked");

    var object = {name:name,active:active};

    jQuery.ajax("/Submit/" + JSON.stringify(object),
    {
        type:"POST"
    });   
} 
```

和控制器

```
 @RequestMapping(value="/Submit/{json}",method=RequestMethod.POST)
 publis void submitForm(@RequestParam(value="name") String name, @RequestParam(value="active") Boolean active)
 { 
    //now we are actually doing sth important here, cause we need to parse JSON
 } 
```

优点

*   短请求地址
*   简短的方法声明

缺点

*   我自己解析JSON

**4.JSON 作为 RequestBody 与类映射**

我最喜欢的方法，但并不总是可行的，因为我们需要编写多个类来包装发送的数据，JS：

```
function submitForm() {
    var name = jQuery("#name").val();
    var active = jQuery("#active").is("checked");

    var object = {name:name,active:active};

    jQuery.ajax("/Submit/",
    {
        type:"POST",
        data:JSON.stringify(object)
    }); 
```

和Java代码：

```
public class Wrapper {
    private String name;
    private Boolean active;    
    //getters and setters
}

 @RequestMapping(value="/Submit/",method=RequestMethod.POST)
 publis void submitForm(@RequestBody Wrapper wrapper)
 { 
    //all data available with Wrapper class
 } 
```

优点

*   映射到所需对象
*   快速简单

缺点

*   我们需要为发送到服务器的每个数据编写包装器

这就是我目前所知道的。我将不胜感激和批评，提出更好的解决方案或任何建议。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T01:45:56.613

我主要做1、2和4。

Spring Roo 将自动生成 1、2 和 4 的代码。

1、2 和 4 很大程度上取决于您是否执行`POST`, `GET`, `PUT`, `DELETE`（分别为 CRUD）。

**数字 1 - 路径变量**

几乎总是`GET`针对单个项目。它是 CRUD 中的 READ。

**数字 2 - 请求参数**

对于真正的 REST，这应该用于*可选*参数，例如分页列表或使用`GET`. 不应有请求正文。

因为`POST`它也用于老式的 REST，最重要的是用于传统的 HTML 表单（又名`application/x-www-form-urlencoded`.

这很重要，因为人们做这个（＃2）`POST`比＃4容易得多。

**3 号 - 不要这样做。**

其他人已经说明了原因。

**数字 4 - JSON 请求正文**

这几乎总是针对 a`POST`和`PUT`（也就是 CRUD 的 C 和 U）完成。它通常与 a 结合`PathVariable`以指定哪些项目。

这很难在浏览器中进行测试，并且需要您的客户知道有效的格式才能进行更新。IE。名称值对比 JSON/XML 模式更容易记录和理解。

**我所做的**

最近我一直在做#2，这样我就可以支持[单页应用程序的 HTML 完整加载或 JSON 的仅数据加载](http://duganchen.ca/single-page-web-app-architecture-done-right/)。

我通过自定义视图解析器来完成，这样我就不必为每个请求编写两种方法。

否则，您必须为每个请求创建两种方法（`application/json`一种用于 HTML，另一种用于 HTML）。

```
@RequestMapping(method = RequestMethod.POST, headers = "Accept=application/json")
public Object doJson() {}

@RequestMapping(method = RequestMethod.POST)
public Object doHtml() { //after processing redirect. } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T05:37:02.403

我经常使用 (2) 和 (4) 方法。(2) 因为它的灵活性。(4) 当我需要高耦合数据并想要轻松验证输入时，即`@Valid`添加注释到控制器的方法参数中，我用来绑定发送的数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-24T23:33:42.030

> (1) 基于PathVariable的请求

正如您所说，您会遇到特殊字符（例如`/`）的问题。如果保持简短，基于路径的 URL 是最易读的。例如，`/hotel/{h}/room/{r}`。有时，`path`和`request`参数的组合用于表示`mandatory`vs`optional`参数。

> (2) 带数据的请求

这将是一种很好的方法，让您可以灵活地轻松添加/删除`Request Parameters`以及管理不同的参数组合。

> (3) 将 JSON 作为 PathVariable 发送到服务器

我认为这种方法存在与`(1)`. 如果没有适当的转义（并且在撰写本文时 Spring 无法`/`以任何形式处理），此选项是不可行的。`(4)` **是**这样做的方法。

> (4) JSON 作为 RequestBody 与类映射

对于复杂的对象，这将是更可取的。通常，spring 可以帮助您将 json 直接映射到 Java 对象。权衡是它不能从浏览器中轻松测试。我相信这是 RESTful 服务中的一种常见模式，尽管它不一定规定传输技术。

* * *

总之，

*   使用查询参数很简单，用户可以直接从浏览器地址栏测试服务。

*   在请求正文中使用对象有助于灵活处理复杂数据，但不能从浏览器轻松测试。

`/`除非提交了没有特殊字符的格式良好的数据，否则路径变量选项与 spring 不匹配。

# python - 一种在python中存储素数的方法（即有一个检查元素是否存在的列表，并且可以按顺序输出元素）

> ID：12117802
> 
> 赞同：1
> 
> 时间：2012-08-24T23:16:50.570
> 
> 标签：python

我想存储一个素数列表，以一种既允许我迭代它（按顺序）又可以快速检查给定素数是否存在的方式。

什么是最好的方法 ？

我应该只使用列表吗？在这种情况下，我想有一个用于二进制搜索的内置函数。它是什么 ？

我应该同时使用 list 和 set 吗？我知道从效率的角度来看这是可行的，但我想要一种不那么混乱的方式......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:35:00.237

如果有序集对于加倍存储来说听起来太过分了，您可以保留该列表并使用该[`bisect`](http://docs.python.org/library/bisect.html)模块进行 O(log n) 查找。它对排序列表进行二进制搜索。

# jquery - Chrome/Opera jQuery CSS 定位不起作用

> ID：12117805
> 
> 赞同：2
> 
> 时间：2012-08-24T23:17:36.240
> 
> 标签：jquery, css, google-chrome, opera

我有以下代码在 IE 和 Firefox 中运行良好，但在 Opera 或 Chrome 中无法正常运行。该代码基本上创建了一个直接在输入之后插入的 DIV。在 IE 和 Firefox 中，新的 div 将与输入重叠。但是在 Opera 和 Chrome 中，div 将出现在输入的右下角旁边，定位不正确。有什么建议么？

编辑：我已经包含了我希望它看起来像的图像，它在 Chrome 和 Opera 中没有这样做。重叠是故意的。在 Chrome/Opera 中，绿色 div 位于右下角，这是一个起始位置，但位置 CSS 类应该修改它。

[![正常工作](../Images/97e3eeaafff9f7e8a5182f1ced029775.png)](https://i.stack.imgur.com/WcJPP.jpg)
[（来源：[aspadvice.com](http://aspadvice.com/photos/images_to_go_with_what_ive_learned/images/86290/original.aspx)）]

```
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title></title>
        <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.2.min.js " type="text/javascript"></script>
        <script type="text/javascript">
            jQuery.fn.makeDiv = function () {
                $(this).each(function () {
                    var className = "wFWn";

                    $(this).after("<div class='" + className + "'>The Div</div>");
                    var c = $(this).next("." + className);

                    var topStartPosition = $(this).outerHeight();
                    var leftStartPosition = $(this).outerWidth();
                    c.addClass('green');
                    c.addClass('position');
                    var pos = $(this).offset();
                    var iTopOffset = 0;
                    if (c.css("top") != "auto")
                        iTopOffset = parseInt(c.css("top").substring(0, c.css("top").indexOf("px")));
                    var iLeftOffset = 0;
                    if (c.css("left") != "auto")
                        iLeftOffset = parseInt(c.css("left").substring(0, c.css("left").indexOf("px")));
                    c.offset({ top: pos.top + topStartPosition + iTopOffset, left: pos.left + leftStartPosition + iLeftOffset });
                    c.css("position", "relative");
                });
                return this;
            };
            $(document).ready(function () {
                $("#txtTest2").makeDiv();
            });
        </script>
        <style type="text/css">
            .position {top: -4px; left: -100px; width: 140px; font-size: 11px; }
            .green { background-color: lime; border: solid 1px black;}
        </style>
    </head>
    <body>
        <div id="two">
            <input name="txtTest2" type="text" maxlength="10" id="txtTest2" /><br />
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T11:44:24.007

使用`.appendTo()`函数代替`.after()`

```
$("<div class='" + className + "'>The Div</div>").appendTo($(MainDiv)); 
```

-*编辑*修正了一个错字-

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T00:37:37.870

问题是覆盖 CSS 中“位置”类中的顶部和左侧

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.2.min.js " type="text/javascript"></script>
    <script type="text/javascript">
        jQuery.fn.makeDiv = function () {
            $(this).each(function () {
                var className = "wFWn";

                $(this).after("<div class='" + className + "'>The Div</div>");
                var c = $(this).next("." + className);

                var topStartPosition = $(this).outerHeight();
                var leftStartPosition = $(this).outerWidth();
                c.addClass('green');
                c.addClass('position');
                var pos = $(this).offset(); 
```

在这里你可以把顶部而不是CSS样式

```
 var iTopOffset = -4;
                if (c.css("top") != "auto")
                    iTopOffset = parseInt(c.css("top").substring(0, c.css("top").indexOf("px"))); 
```

在这里你可以把左边而不是 CSS 样式

```
 var iLeftOffset = -100;
                if (c.css("left") != "auto")
                    iLeftOffset = parseInt(c.css("left").substring(0, c.css("left").indexOf("px")));
                c.offset({ top: pos.top + topStartPosition + iTopOffset, left: pos.left + leftStartPosition + iLeftOffset });
                c.css("position", "relative");
            });
            return this;
        };
        $(document).ready(function () {
            $("#txtTest2").makeDiv();
        });
    </script>
    <style type="text/css"> 
```

这里有一个变化“顶部：-4px；左侧：-100px；” 从“.position {}”中删除

```
 .position { width: 140px; font-size: 11px; }
        .green { background-color: lime; border: solid 1px black;}
    </style>
</head>
<body>
    <div id="two">
        <input name="txtTest2" type="text" maxlength="10" id="txtTest2" /><br />
    </div>
</body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T04:53:59.567

甚至

```
jQuery('#someelementid').css('left', '155'); 
```

不适`position:relative`用于 Chrome 中的元素（在 IE 中有效），因此这可能是您问题的根本原因。

**jQuery 的 .offset()**对我来说适用于所有浏览器，不过：

```
//jQuery('#ProgressIcon').css('left', '155');       // didn't work in chrome
var position = jQuery('#ProgressIcon').offset();
position.left += 133;       //155 210
jQuery('#ProgressIcon').offset(position); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-18T22:41:57.747

是的，即使在 2015 年 10 月，JQuery CSS 方法在 Chrome 中也无法正常工作，但在 IE 中可以正常工作（无论如何，在我的情况下。）

所以对我来说，使用 Razor CSHTML/MVC，Chrome 在使用 JQuery 时忽略了“顶级样式”属性，因为它没有在相关元素的 html 样式中设置。所以这在 Chrome 中不能正常工作：

```
$("#@tileid").css({ "top": top, "left": left  }); 
```

出于某种原因，Chrome 会承认左侧设置但忽略顶部设置。

我的解决方法是直接攻击 html，这在 IE 和 Chrome 中都有效：

```
 <div id="@tileid" class="tile" style="clear:both;top:@toppx; position:absolute;left:@leftpx;"> 
```

当然，我使用的是 CSHTML 变量，这让我可以解决这个问题。如果您不使用 CSHTML/MVC，那么至少您知道直接设置 HTML 是一种可以尝试的解决方法。

我简直不敢相信 Chrome 在 2015 年不能正确处理这样一个基本的 JQuery CSS 方法。

# php - 在 Codeigniter 中通过电子邮件发送单选按钮值时遇到问题

> ID：12117812
> 
> 赞同：0
> 
> 时间：2012-08-24T23:18:57.280
> 
> 标签：php, html, forms, validation, codeigniter

当我去发送电子邮件时，我正在尝试通过电子邮件发送一个带有单选按钮的表单。我得到的返回值只是“on”。我已正确设置名称“值”并将其绑定到 form_validation 代码，这一切似乎都“工作”，但值设置不正确或电子邮件发送不正确。代码如下。

控制器文件：

公共函数contact_email()

```
{
        $this->load->helper(array('form', 'url'));
        $this->load->library('form_validation');
        $this->load->library('email');

        $this->form_validation->set_rules('name', 'Name', 'required|xss_clean');
        $this->form_validation->set_rules('email', 'Email', 'required|valid_email|xss_clean');
        $this->form_validation->set_rules('phone', 'Phone', 'is_numeric|xss_clean');
        $this->form_validation->set_rules('comments', 'Comments', 'xss_clean');

        if ($this->form_validation->run() == FALSE) {

            $data["messages"] = "";
            $this->load->view('engage_header');
            $this->load->view('engage_nav');
            $this->load->view('contact/content_form', $data);
            $this->load->view('engage_footer');

        } else {

            $data["messages"] = "The Email has successfully been sent";

            $this->email->from(set_value("email"), set_value("name"));
            $this->email->to('test@test.com');

             $this->email->subject('Contact Request');

            $message  = "Name: " . $this->input->post('name') . "\n";
            $message .= "Email: " . $this->input->post('email') . "\n";
            $message .= "phone: " . $this->input->post('phone') . "\n\n";
            $message .= "Comments: " . $this->input->post('comments') . "\n";
            $message .= "Favorite Drink:" . $this->input->post('drinks') . "\n";

            $this->email->message($message);  

            $this->email->send();

            echo $this->email->print_debugger();

            $this->load->view('engage_header');
            $this->load->view('engage_nav');
            $this->load->view('contact/content_form', $data);
            $this->load->view('engage_footer');
        }   
    } 
```

查看文件

```
<div class="form_wrapper">
        <div class="head_left">
        <p class="heading"><img src="/resources/css/images/mail_icon.png" width="32px" height="32px" class="mail_icon">Contact Us</p>
        </div>
        <div class="borders"></div>

        <div class="form_container_left">

        <?php echo form_open('/index.php/site/contact_email')?>
        <label for="name">Your Name:</label>
        <input type="text" name="name" id="name" required/>
        <br/>
        <br/>
        <br/>
        <label for="email">Email:</label>
        <input type="text" name="email" id="email" required/>
        <br/>
        <br/>
        <br/>
        <label for="phone">Phone:</label>
        <input type="text" name="phone" id="phone"/>
        <br/>
        <br/>
        <br/>
        <label for="messages">How Can We Help?:</label>
        <textarea rows="" cols="" id="messages" name="comments"></textarea>
        <br/>
        <br/>
        <br/>
        <input type="reset" name="Reset" id="reset_bar">
        <input type="submit" name="Submit" id="submit_bar" value="Submit"> 

        </div>
        <div class="form_container_right">
            <p  class="optional_heading">Your Favorite Drink (optional):</p>
            <div class="soda_container">
            <img src="/resources/css/images/Soda.png" width="64px" height="64px">
            <center><p id="soda_text">Soda</p></center>
            <br/>
            <center><input type="radio" name="drinks" id="soda" value="soda"></center>
            </div>
            <div class="coffee_container">
            <img src="/resources/css/images/coffee.png" width="64px" height="64px">
            <center><p id="coffee_text">Coffee</p></center>
            <br/>
            <center><input type="radio" name="drinks" id="coffee" value="coffee"></center>
            </div>
            <div class="water_container">
            <img src="/resources/css/images/water.png" width="64px" height="64px">
            <center><p id="water_text">Water</p></center>
            <br/>
            <center><input type="radio" name="drinks" id="water" value="water"></center>
            </div>
            <div class="beer_container">
            <img src="/resources/css/images/beer.png" width="64px" height="64px">
            <center><p id="beer_text">Beer</p></center>
            <br/>
            <center><input type="radio" name="drinks" id="beer" value="beer"></center>
            </div>
            <div class="wine_container">
            <img src="/resources/css/images/wine.png" width="64px" height="64px">
            <center><p id="wine_text">Wine</p></center>
            <br/>
            <center><input type="radio" name="drinks" id="wine" value="wine"></center>
            </div>
        </div>  
        <?php echo form_close()?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T21:43:38.910

为了通过电子邮件发送单选按钮值，它们首先必须通过`set_radio`在 value 参数中声明嵌套来设置。像这样

```
<input type="radio" name="drinks" id="water" value="water" <?=set_radio('drinks','water') ?>> 
```

有很多方法可以将这些信息召回给你的“控制器”，我只是用了一个简单的方法`$this->input->post('$variable')`。

这就是我将其称为消息的方式，并且对我有用。

```
 $message  = "Name: " . $this->input->post('name') . "\n";
    $message .= "Email: " . $this->input->post('email') . "\n";
    $message .= "Phone: " . $this->input->post('phone') . "\n\n";
    $message .= "Favorite Drink: " . $this->input->post('drinks') . "\n";
    $message .= "Comments: " . $this->input->post('comments') . "\n"; 
```

视图中设置的名称“值”必须与控制器`$this->input->post('')`参数中传递的值相关。

感谢大家对此的帮助！！迪伦

# c++ - 判断 unicode 点是否为“字母”而不是标点符号数量的 C++ 函数

> ID：12117816
> 
> 赞同：2
> 
> 时间：2012-08-24T23:19:14.430
> 
> 标签：c++, unicode

是否有`C++`可用的函数来确定给定的 Unicode 点是否是字母？我的意思是通常`\p{L}`在正则表达式中描述的内容。因此，它可以是拉丁文、希腊文、西里尔文或其他字母，而不是标点符号、数字等，在 unicode 中也可以由其他几个大代码点范围表示。

所以我要求的功能类似于：

```
bool isUnicodeLetter(int32 codepoint); 
```

也许在 boost 或 ICU 库中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:53:15.063

在 ICU4C 中，该函数被调用[`u_isalpha()`](http://www.icu-project.org/apiref/icu4c/uchar_8h.html#a86cc4f937e33bcea3772c6faf3e293c1)：

> ```
> UBool u_isalpha(UChar32 c) 
> ```
> 
> 确定指定的代码点是否为字母字符。
> 
> 适用于一般类别“L”（字母）。

但是使用时要小心，因为它很容易被误用。`u_isalpha()`中的其他函数`uchar.h`仅旨在提供对 Unicode 字符数据的低级访问。

# android - Phonegap Android 到其他设备

> ID：12117823
> 
> 赞同：0
> 
> 时间：2012-08-24T23:20:40.087
> 
> 标签：android, ios, cordova, mobile

如果我构建一个 Phonegap Android 应用程序，我如何将它部署到 iPhone 和 Blackberry？是像单击按钮一样简单，还是我需要电话和黑莓 SDK 并且必须手动移动 webview 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:39:44.160

您不需要再次重写应用程序，您只需安装 iOS SDK 并创建一个新项目，然后添加 Phonegap 的 .jar 文件。然后复制并粘贴您的应用程序文件（HTML、Javascript 和 CSS 文件到您构建的新项目）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T07:13:03.520

确实很简单。但不像点击按钮那么简单！

如果你为 android 开发了它，你将有一个 www 目录，其中包含你的 index.html 文件以及你的 js 和图像等。

对于 android，您将使用 js (cordova.js/phonegap-android.js/similar)，您可以通过它访问您的 android 设备特定的东西（如按钮、相机、gps 等）。

如果您正在为 Blackberry 开发相同的应用程序，则需要将 cordova.js 替换为与 blackberry 相同的应用程序（您可以从 phonegap 网站下载）

你需要设置一些东西。这很容易。[看到这个链接](http://phonegap.pbworks.com/w/page/25653281/Getting%20Started%20with%20PhoneGap-BlackBerry%20with%20the%20Latest%20Environment)

而对于 iOs ，您需要一台 mac 机器，因为您只能通过 Xcode 进行开发。

# matlab - 如何使用已知的相机参数在 Matlab 中使图像不失真？

> ID：12117825
> 
> 赞同：8
> 
> 时间：2012-08-24T23:21:21.827
> 
> 标签：matlab, computer-vision, camera-calibration, matlab-cvst

[这在OpenCV](http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html)中很容易做到，但是我想要一个相当高效且可以轻松更改的原生 Matlab 实现。该方法应该能够采用上述链接中指定的相机参数。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-24T23:21:21.827

进行 undistort（也称为 unwarp 或补偿镜头失真）的最简单和最常见的方法是对选定的输出照片尺寸进行正向失真，然后使用双线性插值进行反向映射。

这是我为执行此操作而编写的代码：

```
function I = undistort(Idistorted, params)
fx = params.fx;
fy = params.fy;
cx = params.cx;
cy = params.cy;
k1 = params.k1;
k2 = params.k2;
k3 = params.k3;
p1 = params.p1;
p2 = params.p2;

K = [fx 0 cx; 0 fy cy; 0 0 1];

I = zeros(size(Idistorted));
[i j] = find(~isnan(I));

% Xp = the xyz vals of points on the z plane
Xp = inv(K)*[j i ones(length(i),1)]';

% Now we calculate how those points distort i.e forward map them through the distortion
r2 = Xp(1,:).^2+Xp(2,:).^2;
x = Xp(1,:);
y = Xp(2,:);

x = x.*(1+k1*r2 + k2*r2.^2) + 2*p1.*x.*y + p2*(r2 + 2*x.^2);
y = y.*(1+k1*r2 + k2*r2.^2) + 2*p2.*x.*y + p1*(r2 + 2*y.^2);

% u and v are now the distorted cooridnates
u = reshape(fx*x + cx,size(I));
v = reshape(fy*y + cy,size(I));

% Now we perform a backward mapping in order to undistort the warped image coordinates
I = interp2(Idistorted, u, v); 
```

要使用它，需要知道正在使用的相机的相机参数。我目前正在使用 PMD CamboardNano，根据 Cayim.com 论坛的说法，这里使用的参数如下：

```
params = struct('fx',104.119, 'fy', 103.588, 'cx', 81.9494, 'cy', 59.4392, 'k1', -0.222609, 'k2', 0.063022, 'k3', 0, 'p1', 0.002865, 'p2', -0.001446);

I = undistort(Idistorted, params);

subplot(121); imagesc(Idistorted);
subplot(122); imagesc(I); 
```

这是 Camboard Nano 的输出示例。注意：我人为地添加了边界线，以查看靠近边缘的失真的效果（它更加明显）： ![在此处输入图像描述](../Images/27c3518b33219bcc6230d8e7b186f11d.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-14T04:50:01.260

您现在可以使用计算机视觉系统工具箱从 R2013B 版本开始执行此操作。有一个名为[Camera Calibrator](http://www.mathworks.com/help/vision/ug/single-camera-calibrator-app.html)的 GUI 应用程序和一个函数[undistortImage](http://www.mathworks.com/help/vision/ref/undistortimage.html)。

# javascript - 无法集中精力在 FF 中工作

> ID：12117830
> 
> 赞同：0
> 
> 时间：2012-08-24T23:22:15.437
> 
> 标签：javascript, dom, timeout, focus, dom-manipulation

它在 IE 中运行良好，但在 FF 中没有任何作用。

这是我正在使用它的代码。该代码为 proboards.com 做了一些事情。我认为在这种情况下，代码的解释是无关紧要的。如果没有，请告诉我。

但是重点部分只是将重点放在单个元素上。

这是代码：

```
<script>
var TitleBarGuestMessage="Hello Guest!";
var TitleBarMemberMessage="Welcome Back "+pb_displayname+"!";
var i,table,LTPI,LTPItable,titlerow,titlerowcell1,LTPIrow,LTPIrowcell1,shortcutA,shortcutB,shortcutC,
td=document.getElementsByTagName("td");LTPItable= document.getElementById("rectangle_table");LTPI=document.getElementById("rectangle_right_side");LTPItable.style.width="100%";
shortcutA=LTPI.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
shortcutB=shortcutA.previousSibling.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;shortcutC=shortcutA.firstChild;
shortcutA.previousSibling.parentNode.parentNode.cellSpacing="0";
shortcutA.previousSibling.style.display="none";
shortcutB.className="";
shortcutB.bgColor="transparent";
shortcutC.align="center";
shortcutC.style.backgroundColor="transparent";
shortcutC.className="";
LTPI.style.display="none";
for(i=0;i<td.length;i++){
if(td[i].className=="titlebg" && td[i].colSpan=="2"){
td[i].parentNode.parentNode.parentNode.id="forum";}}
table=document.getElementById("forum");
if(pb_action=="home"){
setTimeout(function(){table.focus();}, 2000)};
titlerow=table.insertRow(0);
titlerowcell1=titlerow.insertCell(0);
titlerowcell1.className="titlebg";
titlerowcell1.colSpan="5";
titlerowcell1.id="LTPI_titlebar";
LTPIrow=table.insertRow(1);
LTPIrowcell1=LTPIrow.insertCell(0);
LTPIrowcell1.colSpan="5";
LTPIrowcell1.innerHTML=LTPI.innerHTML;
LTPIrowcell1.id="LTPI_row";
if(pb_username=="Guest"){
titlerowcell1.innerHTML=TitleBarGuestMessage}
else{titlerowcell1.innerHTML=TitleBarMemberMessage}
</script> 
```

这是脚本的重点部分：

```
if(pb_action=="home"){
    setTimeout(function(){table.focus();}, 2000)}; 
```

我也试过：

```
setTimeout("table.focus();",2000); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:51:23.113

这是因为 DOM 表格元素没有`focus`方法（虽然它是在 IE 中实现的）。我假设您需要滚动到该元素，因此您可以这样做：

```
window.scrollTo(0,table.scrollHeight); 
```

或者在您的确切代码中：

```
if(pb_action=="home"){
    setTimeout(function(){window.scrollTo(0,table.scrollHeight)}, 2000)}; 
```

# sql - 创建表，并从 csv 或 txt 文件中导入数据

> ID：12117833
> 
> 赞同：1
> 
> 时间：2012-08-24T23:22:50.383
> 
> 标签：sql, import-from-csv

我有一个包含股票报价的 CSV 文件。当谈到 SQL 时，我是新手，但我做了很多研究并提出了一个我认为应该可以工作的代码。但事实并非如此。我一直得到错误....

```
USE ShakeOut 
GO
CREATE TABLE CSVTest1
(Ticker varchar(10),
dateval smalldatetime),
timevale time(),
Openval varchar(10),
Highval varchar(10),
Lowval varchar(10),
Closeval varchar(10),
Volume varchar(10),
)
GO

BULK
INSERT CSVTest1
FROM 'c:\TEST.txt'
WITH
(
FIELDTERMINATOR = ',',
ROWTERMINATOR = '\n'
)
GO
--Check the content of the table.
SELECT *
FROM CSVTest1
GO
--Drop the table to clean up database.
DROP TABLE CSVTest1
GO 
```

我的 CSV 文件的时间值为 03:15:00 PM，我不确定如何在表格中进行设置。我认为其他值是正确的，这是我的 csv 文件的示例：

```
5/1/2009,9:30:00 AM,18.21,18.45,18.21,18.32,32163
5/1/2009,9:35:00 AM,18.33,18.34,18.27,18.29,36951
5/1/2009,9:40:00 AM,18.29,18.38,18.25,18.37,53198
5/1/2009,9:45:00 AM,18.38,18.4,18.28,18.285,49491 
```

这是我在 SQL Management Studio 中的错误消息：

```
Msg 102, Level 15, State 1, Line 4 Incorrect syntax near ','. Msg 208,
Level 16, State 82, Line 3 Invalid object name 'CSVTest1'. Msg 208,
Level 16, State 1, Line 3 Invalid object name 'CSVTest1'. Msg 3701,
Level 11, State 5, Line 3 Cannot drop the table 'CSVTest1', because it
does not exist or you do not have permission. 
```

我真的很感谢这里的帮助，经过这么多小时没有任何进展，我的头快要爆炸了。我也尝试过 MySQL，也没有在那里工作。

由于我是新人，我可能需要详细解释它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:30:24.427

声明中似乎有一个多余的逗号`CREATE TABLE`。在结束括号之前的最后一列后面有一个逗号。也许它在某些实现中是有效的，但您可以尝试删除它。将其更改为：

```
Volume varchar(10) 
```

啊 - 在第二列定义中似乎有一个无关的关闭父级。将其更改为：

```
dateval smalldatetime, 
```

和时间栏：

```
timevale time, 
```

最终，您似乎应该尝试使 CREATE TABLE 语句语法正确，然后开始添加其他部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T23:59:53.337

最后一列定义后不需要逗号：`Volume varchar(10),`.

我认为`timevale`应该是`timeval`。

`time()`应该只是`time`。

另外，我可能很挑剔，但您已将除前两个之外的所有列名的第一个字母大写 - 不会导致错误，但可能更好地使用一致的命名约定。我会将 val 中的“v”大写并写下整个单词。

CSV 数据也需要修改 - 您需要指定每一列，即使它为空。请参阅我的示例数据（每行末尾的新行仅用于说明目的）。

```
1234567890,2012-08-25,22:15,anytext,ornum,for,varchar,columns <-new line
abcd123456,2010-05-20,00:01,anything,in,these,varchar,columns <-new line
abcd123456,2010-05-20,00:01,anything,in,,,columns             <-new line 
```

这有效：

```
CREATE TABLE CSVTest1 (
    Ticker varchar(10) NULL,
    DateValue smalldatetime NULL,
    TimeValue time NULL,
    OpenValue varchar(10) NULL,
    HighValue varchar(10) NULL,
    LowValue varchar(10) NULL,
    CloseValue varchar(10) NULL,
    Volume varchar(10) NULL)
GO

BULK INSERT CSVTest1
FROM 'C:\TEST.txt'
WITH (FIELDTERMINATOR = ',', ROWTERMINATOR = '\n')
GO 
```

您的 CSV 文件需要为您要插入的每条记录添加一个新行，由 指定，`ROWTERMINATOR = '\n'`每个字段之间的逗号由 指定`FIELDTERMINATOR = ','`。

编辑：

顺便说一句，如果您使用的是 SQL Server Management Studio (SSMS)，您可以通过用户界面创建表，然后：

*   右键单击表格
*   脚本表为
*   创建到
*   新的查询编辑器窗口

# c# - 如何在应用程序的多个实例上拥有 1 个 notifyIcon？

> ID：12117837
> 
> 赞同：0
> 
> 时间：2012-08-24T23:23:47.707
> 
> 标签：c#, contextmenu, notifyicon

我在我的 C# 应用程序中创建了一个 notifyIcon，我对它很满意。基本上，我的应用程序是其他应用程序（记事本、firefox 等）的包装器。所以现在，当我运行我的应用程序（“MyApp firefox.exe”）时，它会加载 firefox，当我将鼠标悬停在任务栏中的图标上时，它会显示“firefox.exe”......非常简单。

如果我运行我的应用程序的 2 个实例（使用不同的参数），我会得到 2 个图标，一个鼠标悬停是“firefox.exe”，另一个是“notepad.exe”。

我真正想要的是有 1 个图标，我可以在其中创建一个 ContextMenuStrip，将所有应用程序名称添加为 MenuItems，因此当我右键单击时，有 2 个可选项目。

有没有办法在不将我的应用程序包装在另一个应用程序包装器中的情况下做到这一点？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:45:42.717

对不起，如果这是一个可怕的答案......

创建互斥体的方式与在第一个应用程序启动时仅创建应用程序的单个实例相同...

而不是阻止您的应用程序启动设置标志如下

```
Mutex firstAppToStart = new System.Threading.Mutex(false, "Mutex...");
if (firstAppToStart.WaitOne(0, false)) {
    // set flag to allow notifyicon to be loaded
    CreateNotificationIcon();
} else {
    // The mutex is not ours, therefore we do not create a notify icon
}
// Subsequent messages will be posted to the first application to use 
// the notify icon on the first application 
```

现在使用 windows 消息在应用程序之间发布，所以现在你有一个 notifyicon - 其他应用程序使用 windows 消息向它发布消息

这确实意味着当第一个应用程序运行时，notifyicon 也会消失，但您可以通过防止第一个应用程序关闭（如果它是第一个应用程序），保存应用程序列表，然后在每个应用程序关闭时发布一条 Windows 消息来解决此问题，当他们都走了时，第一个应用程序可以自行关闭......

# jquery - jQuery POST 到 Sinatra API 同源策略？

> ID：12117838
> 
> 赞同：0
> 
> 时间：2012-08-24T23:23:59.623
> 
> 标签：jquery, ruby, json, sinatra

我已经开发了一个应用程序，使用 Sinatra 作为 API，使用 jQuery/HTML5/Phonegap 作为客户端。

我从一个简单的 HTML5 测试我的应用程序时遇到问题，该 HTML5 基本上使用 JSON 数据向我的 Sinatra API 发布请求。

我听说过 JSONP，但我认为它不会解决我的问题，因为我使用的是 POST 而不是 GET。

还有其他我应该寻找的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T06:36:21.227

您可以尝试[跨域 XHR](http://en.wikipedia.org/wiki/XMLHttpRequest#Cross-domain_requests)。要使用它，您需要发送响应标头，这将允许交互。最简单的情况是：

```
Access-Control-Allow-Origin: * 
```

使用 Sinatra，您应该编写如下内容：

```
headers 'Access-Control-Allow-Origin' => '*' 
```

这种方法的一个缺点 - 目前并非所有浏览器都支持跨域 XHR，例如 Opera 不支持。

# c# - 如何判断是否已在 Outlook 中发送会议邀请？

> ID：12117841
> 
> 赞同：2
> 
> 时间：2012-08-24T23:24:14.677
> 
> 标签：c#, outlook-addin, outlook-2007

我正在使用 C# 为 Outlook 编写一个 COM 加载项。如果保存了会议但未发送邀请，Outlook 会在表单顶部显示一条消息，说明尚未发送邀请。如何以编程方式确定尚未发送会议邀请？

我尝试检查每个`Recipient`并检查`MeetingResponseStatus`. 我希望它是`OlResponseNone`如果邀请尚未发送，但`OlResponseNotResponded`如果邀请已发送但未收到回复。但是，我总是会收到`OlResponseNone`未收到邀请或已回复但尚未回复的收件人。因此，我无法区分没有发出邀请但没有人回复的会议。

我在 Outlook 2007 中完成了大部分测试，但我相信 2003 年和 2010 年也是如此，我需要支持所有这些。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:31:42.953

[我在这篇文章](http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/f3daa63c-19ed-45ea-b8e3-8531e1764a01/)中找到了部分答案。我需要阅读 DASL 属性“http://schemas.microsoft.com/mapi/id/{00020329-0000-0000-C000-000000000046}/80BE0102”。在 Outlook 2007 和 leter 中，您可以使用 PropertyAccessor 执行此操作，如下所示：

```
appointment.PropertyAccessor.GetProperty("http://schemas.microsoft.com/mapi/id/{00020329-0000-0000-C000-000000000046}/80BE0102"); 
```

但是，我还需要支持 Outlook 2003，并且在 Outlook 2007 中添加了 PropertyAccessor 属性。因此，我能够通过以下代码使用[Redemption 的 RDOMail 对象（省略了错误处理）。](http://www.dimastr.com/redemption/RDOMail.htm)

```
var _session = New RDOSession();
_session.Logon();
var _message = _session.GetMessageFromID(appointment.EntryID, ((Outlook.MAPIFolder)appointment.Parent).StoreID);
return (bool)_message.Fields["http://schemas.microsoft.com/mapi/id/{00062002-0000-0000-C000-000000000046}/8229000B"];
Marshal.ReleaseComObject(_message);
_session.Logoff();
Marshal.ReleaseComObject(_session); 
```

# java - Node.js：这个长轮询实现是否泄漏：

> ID：12117844
> 
> 赞同：1
> 
> 时间：2012-08-24T23:24:25.147
> 
> 标签：java, node.js, push-notification, long-polling

我正在评估 Node.js 是否可以替代我当前在 Java Web 应用程序上的推送功能。我编写了一个简单的长轮询服务器，它就像客户端和 Java 后端之间的中介一样工作。客户端发出订阅请求，然后 Java 服务器可以通过调用 Node.js 通知订阅的客户端。到目前为止它似乎工作正常，但我收到以下消息，指出内存泄漏：

```
 (node) warning: possible EventEmitter memory leak detected. 11 listeners added.
Use emitter.setMaxListeners() to increase limit.
Trace
    at EventEmitter.addListener (events.js:168:15)
    at EventEmitter.once (events.js:189:8)
    at route (C:\Users\Juan Pablo\pushserver.js:42:12)
    at Server.onRequest (C:\Users\Juan Pablo\pushserver.js:32:3)
    at Server.EventEmitter.emit (events.js:91:17)
    at HTTPParser.parser.onIncoming (http.js:1793:12)
    at HTTPParser.parserOnHeadersComplete [as onHeadersComplete] (http.js:111:23
)
    at Socket.socket.ondata (http.js:1690:22)
    at TCP.onread (net.js:402:27) 
```

我有一行代码在发出通知事件时记录现有的侦听器。我已经让它运行了一段时间，它显示每个订阅的客户端只有一个侦听器（应该是这样），但是当我收到警告消息时，这条线不在代码上。代码完全一样，除了那条线很难。

这是推送服务器的代码（有点初级，因为我还在学习 Node.js）：

```
var http = require('http');
var url = require("url");
var qs = require("querystring");
var events = require('events');
var util = require('util');

var emitter = new events.EventEmitter;

function onRequest(request, response)
{
    var pathname = url.parse(request.url).pathname;
    console.log("Request for " + pathname + " received.");
    request.setEncoding("utf8");

    if (request.method == 'POST')
    {
        var postData = "";
        request.addListener("data", function(postDataChunk)
        {
            postData += postDataChunk;
            console.log("Received POST data chunk '"+ postDataChunk + "'.");
        });

        request.addListener("end", function()
        {
            route(pathname, response, postData);
        });
    }
    else if (request.method=='GET')
    {
        var urlParts = url.parse(request.url, true);
        route(pathname, response, urlParts.query);
    }
}

function route(pathname, response, data)
{
    switch (pathname)
    {
        case "/subscription":

            emitter.once("event:notify", function(ids)
            {
                response.writeHead(200, {"Content-Type": "text/html", "Access-Control-Allow-Origin": "*"});
                response.write(JSON.stringify(ids));
                response.end();
            });

            break;

        case "/notification":

            //show how many listeners exist
            console.log(util.inspect(emitter.listeners('event:notify'));

            emitter.emit("event:notify", data.ids);

            response.writeHead(200, {"Content-Type": "text/html", "Access-Control-Allow-Origin": "*"});
            response.write(JSON.stringify(true));
            response.end();
            break;

        default:

            console.log("No request handler found for " + pathname);
            response.writeHead(404, {"Content-Type": "text/plain", "Access-Control-Allow-Origin": "*"});
            response.write("404 - Not found");
            response.end();
            break;
    }
}

http.createServer(onRequest).listen(8888);

console.log('Server running at http://127.0.0.1:8888/'); 
```

我的印象是使用emitter.once 会在使用后自动删除事件监听器，所以我不知道如果只连接一个客户端，如何添加11 个监听器。我在想，如果客户端在等待通知时断开连接，那么相关的连接资源就不会被释放。

我想知道我是否必须手动处理断开连接，以及那里是否确实存在泄漏。欢迎任何建议。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T22:30:22.570

如果有人感兴趣，上面的代码确实会泄漏。当客户端在发送通知之前断开连接时，就会发生泄漏。要解决此问题，需要在客户端突然断开连接时移除事件侦听器，例如：

```
case "/subscription":

        var notify = function(ids)
        {
            response.writeHead(200, {"Content-Type": "text/html", "Access-Control-Allow-Origin": "*"});
            response.write(JSON.stringify(ids));
            response.end();
        }

        emitter.once("event:notify", notify);

        //event will be removed when connection is closed
        request.on("close", function()
        {
            emitter.removeListener("event:notify", notify);
        });
        break; 
```

# html - 隐藏在 twitter/google 社交按钮后面的 Facebook 评论栏

> ID：12117846
> 
> 赞同：0
> 
> 时间：2012-08-24T23:25:05.753
> 
> 标签：html, css, facebook, magento

跳槽有人可以帮助解决这个问题。

当有人在我们的某个产品页面上点击“喜欢”时，下拉的评论部分会位于 twitter/google 社交按钮的后面，我似乎无法准确指出问题所在。我尝试将溢出设置为可见/自动并且没有运气，但是当我更改高度时它看起来没问题（尽管我不想更改高度而是它出现在顶部）。

facebook按钮周围的代码如下：

```
<div class="product-link">

    <iframe src="http://www.facebook.com/plugins/like.php?href=http://foscam-uk.com/indoor-ip-cameras/foscam-fi8918e-black-wired-ip-camera.html&send=false&layout=standard&width=450&show_faces=true&action=like&colorscheme=light&appId=317980981630590"

        scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:auto; width:450px; height:30px">" </iframe>

<a href="https://twitter.com/share" class="twitter-share-button" data-via="FoscamUK">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script><g:plusone size="medium"></g:plusone></div>

        </div> 
```

也是产品页面的链接（可能更有用）： http: [//foscam-uk.com/foscam-fi8910w.html](http://foscam-uk.com/foscam-fi8910w.html)

非常感谢你的帮助。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T13:18:28.057

iframe 上的高度和溢出的组合似乎不像您预期​​的那样工作。

我的建议：将 iframe 嵌入到 DIV 元素中，并将该 DIV 元素格式化如下：

```
<div id="foobar"><iframe …&gt;</div>

#foobar {
  height:   30px:
  overflow: hidden;
  position: relative;
  z-index: 1;
}
#foobar:hover {
  overflow: visible;
} 
```

之后，评论栏应该出现在 twitter/g+ 按钮上。

但是，已经喜欢您页面的用户的“面孔”随后会显示在 twitter/g+ 按钮上。我建议您`&show_faces=true`从 iframe 的 URL 中删除该参数，因为显示面孔不会真正适合您要使用的页面布局。

# java - 如何摆脱 iReport/Jasper 中多余的饼图？

> ID：12117849
> 
> 赞同：2
> 
> 时间：2012-08-24T23:25:36.210
> 
> 标签：java, charts, jasper-reports

我使用 iReport 生成了一个饼图，当我进入预览模式时，它吐出了许多无用的饼图（即 4 个类别中的 1 个图表，下一个图表 4 个类别中的 2 个，依此类推......直到共达到 3 个图表）。我的查询完全没问题。当我在数据库（也是数据源）上测试查询时，它给了我：

```
category count

A     2

B     1

C     3

D     3 
```

我需要做什么才能获得包含所有 4 个类别的正确饼图>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:41:04.937

此页面有我的答案，除了此处列出的内容之外，还必须正确设置增量和重置设置：

[在 iReport (4.6.0) 中创建饼图](https://stackoverflow.com/questions/11461704/creating-pie-chart-in-ireport-4-6-0?rq=1)

# jquery - 使用 CSS 查找特定子元素

> ID：12117850
> 
> 赞同：2
> 
> 时间：2012-08-24T23:25:45.707
> 
> 标签：jquery, css

当具有该类的元素`.parent`悬停在其上时，它会定位具有该类的子元素`.child`并将 CSS 应用于它们。

[这是jsFiddle](http://jsfiddle.net/92HzD/)

是否可以纯粹用CSS来实现这个效果？

**html:**

```
<div class="parent" style="background:red;margin:20px;padding:20px;">
    <div class="child" style="background:blue;margin:20px;padding:20px;"></div>
</div>

<div class="parent" style="background:red;margin:20px;padding:20px;">
    <div class="child" style="background:blue;margin:20px;padding:20px;"></div>
</div>​ 
```

**jQuery：**

```
$('.parent').hover(
  function () {
    $(this).find('.child').css('background','yellow');
  }, 
  function () {
    $(this).find('.child').css('background','blue');
  }
);​ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T23:28:04.310

删除内联样式并将以下内容放入样式表中：

```
/* CSS */
.parent { background: red; margin: 20px; padding: 20px; }
.child {background blue; margin: 20px; padding: 20px;}
.parent:hover > .child { background: yellow; } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T23:29:07.913

是的。

```
.parent .child {
    background: blue;
}

.parent:hover .child {
    background: yellow;
} 
```

这复制了您的 jQuery 的效果。如果您的字面意思是“孩子”（而不是后代，这是您实际找到的），那么您需要以下内容：

```
.parent > .child {
    background: blue;
}

.parent:hover > .child {
    background: yellow;
} 
```

正如[@hobbs 所说](https://stackoverflow.com/a/12117871/20578)，这在 IE 6 中不起作用，因为[`:hover`仅在 IE 6 中的链接上受支持](http://www.browsersupport.net/CSS/%3Ahover)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-24T23:29:37.697

是的，但是您也应该将内联样式移到类中，这样您就不必使用`!important`声明（否则内联样式将始终覆盖样式表）。

```
<div class="parent">
    <div class="child"></div>
</div>

<div class="parent">
    <div class="child"></div>
</div>​ 
```

```
.parent {
    background: red;
    margin: 20px;
    padding: 20px;
}
.child {
    background: blue;
    margin: 20px;
    padding: 20px;
}
.parent:hover .child {
    background: yellow;
} 
```

[请参阅 jsFiddle。](http://jsfiddle.net/w5WgQ/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T23:28:34.577

```
.parent .child {
    background: blue;
}

.parent:hover .child {
    background: yellow;
} 
```

应该做这项工作，除了`:hover`只适用于`A`元素的 IE 版本（jQuery 可以解决这个问题；CSS 不能。）

# ios - 使用 Amazon Cloudfront 将视频分发到 iPhone，具有固定的内容编程

> ID：12117857
> 
> 赞同：0
> 
> 时间：2012-08-24T23:26:07.973
> 
> 标签：ios, video-streaming, amazon-cloudfront

我想设置一个可扩展的视频分发服务器/基础设施，用于将视频流式传输到 iOS 设备。客户将对预先制作的内容进行一些编程，例如将播放 6 个小时，然后从头开始重复。应该可以在视频开始时输入确切的时间表，也可以在不同日期的不同时间开始。

有人指出我使用 Amazon CloudFront 提供了来自 Amazon 的 Live Smooth Streaming 服务。

所以我的问题是：这是否支持我需要的功能，以及如何正确设置它。我已经在[http://awsdocs.s3.amazonaws.com/CF/latest/cf_dg.pdf](http://awsdocs.s3.amazonaws.com/CF/latest/cf_dg.pdf)上查看了他们的文档，但这并没有涵盖我想要的用例，即设置一些编程方案。我已经看到了对用于直播的 Cloudformation 模板的引用，但也有 s.th。类似于进行固定编程，或者它也可以用于此？

谢谢你的时间！

弗洛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T16:56:20.867

你的问题有点混乱。iOS 设备需要 HLS 协议内容。您只需要以 HLS 形式 [ts 文件与 .m3u8] 创建您的内容并存储在 S3 存储桶中并将您的云端链接到它。

既然你提到了预先制作的内容，我猜这意味着它是预先可用的，而不是实时生成的。

然后，您的程序应该指向正确的 .m3u8 文件以选择并可以适当地更新 .m3u8 文件。您控制对 m3u8 的访问的程序（当它可用时应该可以播放等）独立于 s3/cloudfront 中的存储。

您还可以实时生成内容，但除了动态创建内容之外没有任何变化。您控制 .m3u8 的程序将控制客户端可以访问的内容。

如果不是 iOS 设备而是其他设备，同样适用。将您的内容保存在 S3 存储桶上并链接到 CF。您需要设备所需格式的内容。让您的网络服务器程序控制对内容的访问。记住CF不是球员。CF 也提供对闪存服务器的支持，您也可以使用它。

# c# - 在 .NET 网络浏览器中对谷歌的阿拉伯语查询

> ID：12117858
> 
> 赞同：0
> 
> 时间：2012-08-24T23:26:19.527
> 
> 标签：c#, character-encoding, browser, arabic

我有一个 .NET 网络浏览器，我用它在 Google 中以这种格式搜索查询：

```
webbrowser1.Navigate("www.google.com/search?q="+Query); 
```

它适用于英语查询，但是当我使用阿拉伯语查询时，我看到问号字符，例如：??????

我尝试了这段代码，但没有帮助：

```
ASCIIEncoding ascii = new ASCIIEncoding();
byte[] byteArray = Encoding.UTF8.GetBytes(inputString);
byte[] asciiArray = Encoding.Convert(Encoding.UTF8, Encoding.ASCII, byteArray);
string finalString = ascii.GetString(asciiArray); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:38:49.487

我用谷歌翻译找到了一个阿拉伯语单词。我希望它真的意味着“测试”:)

```
string query = "اختبار";
webBrowser1.Navigate("http://www.google.com/search?q="+ HttpUtility.UrlEncode(query)); 
```

# c++ - c ++未定义对静态变量的引用

> ID：12117859
> 
> 赞同：8
> 
> 时间：2012-08-24T23:26:31.570
> 
> 标签：c++, reference, linker, sdl, undefined

我不知道为什么这段代码不起作用。所有源文件都会编译，但是当我尝试链接它们时，编译器会以未定义的引用错误对我大喊大叫。这是代码：

主.cpp：

```
#include "SDL/SDL.h"
#include "Initilize.cpp"

int main(int argc, char* args[]) 
{
    //Keeps the program looping
    bool quit = false;
    SDL_Event exit;
    //Initilizes, checks for errors
    if(Initilize::Start() == -1) 
    {
        SDL_Quit();
    }
    //main program loop
    while(quit == false) 
    {
        //checks for events
        while(SDL_PollEvent(&exit)) 
        {
            //checks for type of event;
            switch(exit.type) 
            {
                case SDL_QUIT:
                quit = true;
                break;
            }
        }
    }
    return 0;
} 
```

初始化.h：

```
#ifndef INITILIZE_H
#define INITILIZE_H
#include "SDL/SDL.h"

/* Declares surface screen, its attributes, and Start(); */
class Initilize {
protected:
    static SDL_Surface* screen;
private:
    static int SCREEN_WIDTH, SCREEN_HEIGHT, SCREEN_BPP;
public:
    static int Start();
};

#endif 
```

初始化.cpp：

```
#include "Initilize.h"
#include "SDL/SDL.h"

/* Initilizes SDL subsystems, sets the screen, and checks for errors */
int Initilize::Start() 
{
    //screen attributes
    SCREEN_WIDTH = 640;
    SCREEN_HEIGHT = 480;
    //Bits per pixel
    SCREEN_BPP = 32;
    //Inits all subsystems, if there's an error, return 1   
    if(SDL_Init(SDL_INIT_EVERYTHING) == -1) {
            return 1;
    }
    //sets screen
    screen = SDL_SetVideoMode(SCREEN_WIDTH, SCREEN_HEIGHT, SCREEN_BPP, SDL_SWSURFACE);
    //Returns 1 if there was in error with setting the screen
    if(screen == NULL) {
            return 1;
    }
    SDL_WM_SetCaption("Game", NULL);
    return 0;
} 
```

抱歉，如果代码的格式很奇怪，在代码块中插入四个空格会使事情变得有点混乱。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-24T23:41:09.033

将以下内容添加到您的 cpp 文件中：

```
SDL_Surface* Initilize::screen = 0; // or nullptr
int Initilize::SCREEN_WIDTH = 640;
int Initilize::SCREEN_HEIGHT = 480;
int Initilize::SCREEN_BPP = 32; 
```

此外，如果这些值永远不会改变，那么制作它们会很好`const`。您需要将以上内容添加到您的 cpp 文件的原因是因为静态成员变量需要在类之外定义。`static SDL_Surface* screen;`等在你的类中*只是*一个声明，而不是一个定义。`static`成员被认为是特殊的，并且与全局变量非常相似。

这是因为静态成员在类的所有实例之间共享。这意味着它们只能定义*一次*，并且允许在类内定义会导致出现多个定义，因此 C++ 标准强制您在类外定义它（并且还暗示您应该将定义放在 cpp 文件中）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T23:44:20.467

在`Initialize.cpp`做

```
#include "Initialize.h"
#include "SDL/SDL.h"

// this is the new line to insert
SDL_Surface* Initialize::screen = 0;
int Initialize::SCREEN_WIDTH=...; // whatever you want to set it to
int Initialize::SCREEN_HEIGHT=...; // whatever you want to set it to
int Initialize::SCREEN_BPP=...; // whatever you want to set it to 
```

并删除`#include "Initialize.cpp"`main.cpp 中的行

而是做

```
#include "Initialize.hpp" 
```

如果你使用 gcc，编译使用

```
g++ -o <output-file> main.cpp Initialize.cpp <include flags like -I> <lib flags like -L> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T23:29:05.500

看来您从未初始化过变量。您在 Initialize start 方法中分配它们，但没有初始化它们。在源文件中分配它之前尝试添加，`int SCREENWIDTH;`而不仅仅是头文件

# mysql - MySQL按“每天的关系”排序

> ID：12117860
> 
> 赞同：0
> 
> 时间：2012-08-24T23:26:33.210
> 
> 标签：mysql, sorting

我需要为我的项目创建一个 mysql 查询，这对我的范围来说有点太复杂了......

所以，我有一个带有 id 和时间戳列的图像表，以及元数据列

我还有一个“loves”表，其中包含 id、imageid、userid 和 timestamp 列

（用户 ID 在这里并不重要）

目前，我正在使用 LEFT JOIN 按喜欢的总数对图像进行排序

相反，我现在想做的是按图像的每日平均喜欢对图像进行排序。

因此，今天创建的具有 5 个相关联的赞的图像应该位于 5 天前创建的具有 20 个相关联的图像之前。

甚至不知道如何开始处理这个问题，你们中的任何一位 SQL 大师有什么想法吗？干杯。

编辑：

使用此查询

```
SELECT images.*, 
COUNT(loves.id) AS num_loves 
FROM images 
JOIN loves ON (images.id = loves.imageid) 
GROUP BY images.id 
ORDER BY num_loves/DATEDIFF(images.timestamp,CURDATE()) 
DESC LIMIT 0 , 24 
```

收到此错误

`Reference 'num_loves' not supported (reference to group function)`

仍在掌握 MySQL 语法...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:50:42.803

您可以使用任何有效的表达式作为您的`ORDER BY`子句。这意味着我们只需要回忆一点代数：

```
SELECT 
  images.url,
  images.date_added
FROM IMAGES
JOIN image_likes ON image_likes.image_id = images.id
GROUP BY images.id
ORDER BY count(image_likes.id)/DATEDIFF(CURDATE(), images.date_added) 
```

# c# - 具有相同列的相同表的数据建模

> ID：12117861
> 
> 赞同：2
> 
> 时间：2012-08-24T23:26:33.870
> 
> 标签：c#, sql-server, database, sql-server-2008, database-design

我有许多表具有相同数量的列和名称，因为它们都是查找表。例如，有 LabelType 和 TaskType 表。LabelType 和 TaskType 表具有 TypeID 和 TypeName 列。它们将在其他表中用作外键，例如带有 shippingLog 表的 LabelType 表和带有 EmployeeTask 表的 TaskType 表。

```
LabelType Table
TypeID TypeName
1      Fedex
2      UPS
3      USPS

TaskType Table
TypeID TypeName
1      Receiving
2      Pickup
3      Shipping 
```

到目前为止，我有 20 多张桌子，我预计它会继续增加。我对此没有任何问题，但我只是想知道是否有更好或更智能的方式来使用表格。我什至考虑将所有这些表合并为一个查找类型表，并通过从查找表中添加外键来区分它们。查找表可能有标签、任务等数据。然后我只需要一个或两个表来存储所有这些查找数据。

如果您有更好或更智能的数据建模方式，请告诉我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-25T19:01:50.420

仅仅因为数据具有相似的结构并不意味着它具有相同的含义或相同的约束。将您的查找表分开。这使**外键**保持独立，因此数据库可以保护自己免于引用错误类型的查找数据。¹

我希望关系 DBMS 支持继承，您可以在父表中定义基本结构，并在子表中添加特定的 FK。就目前而言，您需要在 DDL 中忍受一些重复......

注意：“保持查找表分开”规则的一个例外可能是当您的系统需要是动态的（即能够添加新类型的查找数据而无需在数据库中实际创建新的物理表），但看起来并非如此从你的问题来看。

* * *

*¹对于一个大查找表，仅 FK 不会阻止（例如）该`ShippingLog`表引用该表的行`EmployeeTask`。通过使用识别关系和迁移 PK，您可以保护自己免受这种情况的影响，但并非没有引入一些冗余并需要一些仔细的约束。简单地做正确的事情并保持查找表分开会更清洁并且可能更高效。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T23:49:15.820

将您的查找表分开。查找时速度更快，并且您将在添加新查找表的时间之间进行数百万次查找。

很多表不是一个大问题。

# objective-c - 如何在 Objective-C OpenGL 中正确使用 InitWindow？

> ID：12117862
> 
> 赞同：0
> 
> 时间：2012-08-24T23:27:00.150
> 
> 标签：objective-c, c, opengl, freebsd

做错了什么？我正在尝试学习 OpenGL 和 Objective-C，我正在将它的代码从 C 移植到 Objective-C。

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <GL/glew.h>
#include <GL/freeglut.h>
#define WINDOW_TITLE_PREFIX "Chapter 1"

int CurrentWidth = 800,
    CurrentHeight = 600,
    WindowHandle = 0;

void Initialize(int, char*[]);
void InitWindow(int, char*[]);
void ResizeFunction(int, int);
void RenderFunction(void);

int main(int argc, char* argv[])
{
    Initialize(argc, argv);

    glutMainLoop();

    exit(EXIT_SUCCESS);
}

void Initialize(int argc, char* argv[])
{
    InitWindow(argc, argv);

    fprintf(
        stdout,
        "INFO: OpenGL Version: %s\n",
        glGetString(GL_VERSION)
    );

    glClearColor(0.0f, 0.0f, 0.0f, 0.0f);
}

void InitWindow(int argc, char* argv[])
{
    glutInit(&argc, argv);

    glutInitContextVersion(4, 0);
    glutInitContextFlags(GLUT_FORWARD_COMPATIBLE);
    glutInitContextProfile(GLUT_CORE_PROFILE);

    glutSetOption(
        GLUT_ACTION_ON_WINDOW_CLOSE,
        GLUT_ACTION_GLUTMAINLOOP_RETURNS
    );

    glutInitWindowSize(CurrentWidth, CurrentHeight);

    glutInitDisplayMode(GLUT_DEPTH | GLUT_DOUBLE | GLUT_RGBA);

    WindowHandle = glutCreateWindow(WINDOW_TITLE_PREFIX);

    if(WindowHandle < 1) {
        fprintf(
            stderr,
            "ERROR: Could not create a new rendering window.\n"
        );
        exit(EXIT_FAILURE);
    }

    glutReshapeFunc(ResizeFunction);
    glutDisplayFunc(RenderFunction);
}

void ResizeFunction(int Width, int Height)
{
    CurrentWidth = Width;
    CurrentHeight = Height;
    glViewport(0, 0, CurrentWidth, CurrentHeight);
}

void RenderFunction(void)
{
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glutSwapBuffers();
    glutPostRedisplay();
} 
```

我从 [http://openglbook.com/the-book/chapter-1-getting-started/得到了这段代码](http://openglbook.com/the-book/chapter-1-getting-started/)

我已经这样做了，但我不确定我认为问题出在指针的错误是什么。

头文件.h

```
#import <Foundation/Foundation.h>
#import <stdio.h>
#import <string.h>
#import <GL/glew.h>
#import <GL/freeglut.h>
#define WINDOW_TITLE_PREFIX "test gl objective c"

@interface princ : NSObject {
    int CurrentWidth;
    int CurrentHeight;
    int WindowHandle;

}

-(void)InitValues;
-(void)ResizeFunction;
-(void)RenderFunction;
-(void)InitWindow: (int)argc: (char*[])argv:(void*)FoundRZ:(void*)FoundRD;
-(void)Initialize: (int)argc: (char*[])argv;

@end

@implementation princ 

-(void)InitValues {

    CurrentWidth = 800;
    CurrentHeight = 600;
    WindowHandle = 0;
}

-(void)ResizeFunction {

    int Width = 0;
    int Height = 0;
    CurrentWidth = Width;
    CurrentHeight = Height;
    glViewport(0, 0, CurrentWidth, CurrentHeight);

}

-(void)RenderFunction { 

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glutSwapBuffers();
    glutPostRedisplay();

    }

-(void)InitWindow: (int)argc: (char*[])argv:(void*)FoundRZ:(void*)FoundRD {

    glutInit(&argc, argv);

    glutInitContextVersion(4, 0);
    glutInitContextFlags(GLUT_FORWARD_COMPATIBLE);
    glutInitContextProfile(GLUT_CORE_PROFILE);

    glutSetOption ( 
      GLUT_ACTION_ON_WINDOW_CLOSE,
      GLUT_ACTION_GLUTMAINLOOP_RETURNS
    );

    glutInitWindowSize(CurrentWidth, CurrentHeight);
    WindowHandle = glutCreateWindow(WINDOW_TITLE_PREFIX);

    if(WindowHandle < 1) {
        fprintf(
              stderr, "ERROR: Could not create a new rendering window.\n" 
              );
        exit(EXIT_FAILURE);
    }

    glutReshapeFunc(FoundRZ);
    glutDisplayFunc(FoundRD);

    }

-(void)Initialize: (int)argc: (char*[])argv {

    fprintf(stdout, "INFO: OpenGL Version: %s\n", glGetString(GL_VERSION));

}

@end 
```

1米

```
#import "header.h"

int main (int argc, char *argv[]) {
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

    NSLog(@"hello");

    princ *GLMAIN = [[princ alloc] init];

    [GLMAIN InitValues];
    [GLMAIN InitWindow:argc:argv:[GLMAIN ResizeFunction]:[GLMAIN RenderFunction]];
    [GLMAIN Initialize:argc:argv];

    [pool drain];
    return 0;

} 
```

错误 ：

```
$ clang -ObjC 1.m -o 1  `gnustep-config --objc-flags` -I/usr/local/lib/gcc42/gcc/x86_64-portbld-freebsd9.0/4.2.5/include -fconstant-string-class=NSConstantString  -I/usr/local/GNUstep/System/Library/Headers -L/usr/local/GNUstep/System/Library/Libraries -L/usr/local/lib -lgnustep-base -I/usr/local/include -L/usr/local/lib -lglut -lGL
1.m:12:31: error: sending 'void' to parameter of incompatible type 'void *';
        [GLMAIN InitWindow:argc:argv:[GLMAIN ResizeFunction]:[GLMAIN RenderFunction]];
                                     ^~~~~~~~~~~~~~~~~~~~~~~
./header.h:18:52: note: passing argument to parameter 'FoundRZ' here
-(void)InitWindow: (int)argc: (char*[])argv:(void*)FoundRZ:(void*)FoundRD;
                                                   ^
1.m:12:55: error: sending 'void' to parameter of incompatible type 'void *';
        [GLMAIN InitWindow:argc:argv:[GLMAIN ResizeFunction]:[GLMAIN RenderFunction]];
                                                             ^~~~~~~~~~~~~~~~~~~~~~~
./header.h:18:67: note: passing argument to parameter 'FoundRD' here
-(void)InitWindow: (int)argc: (char*[])argv:(void*)FoundRZ:(void*)FoundRD;
                                                                  ^
2 errors generated. 
```

我没有使用 mac，我使用的是 FreeBSD，但我希望任何苹果开发人员都可以帮助解决这个小问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T00:14:35.357

我认为这是您的 initWindow 方法。您正在传递一个方法，该方法将 void 返回给采用 void* 的参数。这里的主要问题是 glut 不支持 Objective-C 方法调用，而是需要 C 函数，所以将你的 resizeFunction 和 renderFunction 更改为 C 函数，然后传递它，它应该可以工作。

# mysql - mysqldump 过滤器？

> ID：12117864
> 
> 赞同：1
> 
> 时间：2012-08-24T23:27:35.127
> 
> 标签：mysql, mysqldump

我必须从服务器转储数据库，将 .sql 传输到不同的服务器，然后运行以下脚本以使用以下语法删除某些行：

```
DELETE wp_posts
FROM wp_posts
INNER JOIN wp_postmeta ON wp_postmeta.post_id = wp_posts.ID
WHERE (wp_postmeta.meta_key = 'InternalOnly' AND wp_postmeta.meta_value IS NOT NULL); 
```

有没有办法可以在转储帖子之前过滤帖子？我不想在原始服务器上删除它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T13:29:40.583

在要转储的 MySQL 数据库中，运行以下查询：

```
CREATE TABLE wp_posts_copy LIKE wp_posts;
INSERT INTO wp_posts_copy
SELECT wp_posts.*
FROM wp_posts
INNER JOIN wp_postmeta ON wp_postmeta.post_id = wp_posts.ID
WHERE NOT(wp_postmeta.meta_key = 'InternalOnly' AND wp_postmeta.meta_value IS NOT NULL); 
```

它将创建`wp_posts_copy`具有与 相同结构的表`wp_posts`，然后将要保留的行插入到这个新表中。

用于`mysqldump`导出数据时，请[从转储中](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html#option_mysqldump_ignore-table)[排除原始`wp_posts`](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html#option_mysqldump_ignore-table)表：

```
mysqldump -u username -p database --ignore-table=your_database.wp_posts > backup.sql 
```

将备份导入新服务器后，不要忘记重命名表：

```
ALTER TABLE wp_posts_copy RENAME TO wp_posts; 
```

# php - 作为浏览器输出

> ID：12117865
> 
> 赞同：1
> 
> 时间：2012-08-24T23:27:37.577
> 
> 标签：php, mongodb, symfony

我在 Mongo DB GridFS 中存储了一些图像。我现在正在尝试显示图像，但遇到了严峻的挑战。我所看到的只是`<Mongo Binary Data>`输出。我玩过设置标题，但似乎没有任何工作正常。我所看到的只是`<Mongo Binary Data>`。我尝试发送图像标题（jpeg/png 等），但图像显示为空。为什么 ？

这是我显示图像的代码：

```
public function someAction($imageID)
    {
   $dm = $this->get('doctrine.odm.mongodb.document_manager');

         $image = $dm->createQueryBuilder('Mybundle:Asset')
                     ->field('id')->equals($imageID)
                     ->getQuery()
                     ->getSingleResult();

  return new Response($image->getFile()->getBytes(), 200, array('Content-Type' => 'image/jpeg'));

} 
```

当我尝试将内容类型更改为文本时，我又得到`<Mongo Binary Data>`了。

这是我的路由文件：

```
my_route:
    pattern:  /showimage/{imageID}
    defaults: { _controller: MyBundle:someController:someAction}
    requirements:
        _method:  GET 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-15T01:08:51.037

`"<Mongo Binary Data>"`是从[MongoBinData::__toString()](http://php.net/manual/en/mongobindata.tostring.php)返回的字符串。这种行为可以追溯到几年前，但我认为它是为了避免在将 MongoBinData 转换为字符串时无意中生成大量输出或回显不可打印的字符。

在您的情况下，我假设`$image->getFile()`对应于一个`Doctrine\MongoDB\GridFSFile`对象。我会在那里开始调试，看看是否`getBytes()`返回对象的内部`$bytes`属性、一些文件内容或链接到[MongoGridFSFile::getBytes()](http://php.net/manual/en/mongogridfsfile.getbytes.php)。

此外，共享资产类的模型/映射信息以及同一查询返回的非水合数据可能会有所帮助。添加`->hydrate(false)`到查询构建器链将完成后者。

# php - 我的 CSS 代码在 TinyMCE 中没有正确读取

> ID：12117878
> 
> 赞同：4
> 
> 时间：2012-08-24T23:29:17.657
> 
> 标签：php, html, css, image, tinymce

几个月前，我发布了一个关于如何在将鼠标悬停在图像上时显示标题的问题。

这是线程：

[不明白悬停图像时如何显示标题](https://stackoverflow.com/questions/11057056/dont-understand-how-to-show-the-caption-when-hovering-image)

问题是当我使用 TinyMce 编辑标题时，它不会显示标题悬停。相反，它不显示任何标题，它只是悬停。

这是编辑端（我缩短了它）：

```
 <script language="javascript" type="text/javascript">//<![CDATA[
  tinyMCE.init({
        // General options
        mode: "textareas",
        elements : "ajaxfilemanager",
        theme : "advanced",
});
//]]</script> 
```

这是输出：

```
<html> 
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
</head>
<body>

<style>
#caption { display: none;font:12px Times New Roman;}
img:hover + #caption { position: absolute; display: block;}
.caption { display:none; text-decoration: none; font:12px Times New Roman;}
.image-with-caption:hover .caption {display: block; text-decoration: none;}
a:hover { text-decoration: none; } 
</style>

<table width="100%">
<tr>
<td>
<?php echo(stripslashes($_POST['content'])); ?>
</td>
</tr>
</table>

</body>
</html> 
```

这是我将代码复制并粘贴到 TinyMCE 中的输入：

```
 <table width="100%">
 <tr>
 <td>
 <div class="image-with-caption">
 <a href="images/artistc.php">
 <img src="images/imagec08.jpg" style="width:209px" />
 <p id="caption">Caption 3</p>
 </a>  
 </div>
 </td>
 <td>
 <div class="image-with-caption">
 <a href="images/artistb.php">
 <img src="images/imageb12.jpg" style="width:195px" />
 <p id="caption">Caption 5</p> 
 </a>
 </div>
 </td>
 <td>
 <div class="image-with-caption">
 <a href="images/artista.php">
 <img src="images/imagea02.jpg" style="width:260px" />
 <p id="caption">Caption 4</p>
 </a> 
 </div>
 </td>
 </tr>
 </table> 
```

任何建议和意见将不胜感激。我只是想知道为什么它不显示标题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T03:15:10.397

I don't completely understand your question, but I see you have several tags with same id. That is not allowed. Maybe if you fix that, it helps to fix the issue. You should replace the `id="caption"` by `class="caption"` (or anything else), and then, modify your css replacing `#caption` by `.caption`

# delphi - 带 Dephi 的 SAPI：异步语音不起作用

> ID：12117883
> 
> 赞同：5
> 
> 时间：2012-08-24T23:30:24.093
> 
> 标签：delphi, delphi-7, sapi, text-to-speech

以下工作完美（Delphi 7）：

```
procedure TMainForm.SayIt(s:string); // s is the string to be spoken
var
voice: OLEVariant;
begin
  memo1.setfocus;
  voice := CreateOLEObject ('SAPI.SpVoice');
  voice.Voice := voice.GetVoices.Item(combobox1.ItemIndex); // current voice selected
  voice.volume := tbVolume.position;
  voice.rate := tbRate.position;
  voice.Speak (s, SVSFDefault);
end; 
```

以上在“同步”模式下工作（**SVSFDefault**标志），但如果我将标志更改为**SVSFlagsAsync**以尝试在异步模式下播放声音，则不会产生声音。没有给出错误消息，但扬声器上没有播放任何内容。

问题可能是什么？我在 Delphi 的 Imports 文件夹中有 SpeechLib_TLB 单元。

**编辑：**这是在 Windows XP 中

谢谢，布鲁诺。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-25T17:52:41.227

当您使用[SVSFlagsAsync](http://msdn.microsoft.com/en-us/library/ms720892%28v=vs.85%29)标志时，语音流在内部缓冲区中排队等待语音服务执行，所以我认为您发出的问题与语音对象的生命周期有关，因为是一个局部变量，实例在执行声音之前被销毁。

作为解决方法，您可以等待声音，使用[`WaitUntilDone`](http://msdn.microsoft.com/en-us/library/ms723616%28v=vs.85%29)方法

```
 voice.Speak (s, SVSFlagsAsync);
  repeat  Sleep(100); until  voice.WaitUntilDone(10); 
```

或`voice`在表单定义中声明变量。

```
 TMainForm = class(TForm)
    Button1: TButton;
    procedure Button1Click(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
   voice: OLEVariant;
   procedure SayIt(const s:string);
  end;

var
  MainForm: TMainForm;

implementation

uses
   ComObj;

{$R *.dfm}
procedure TMainForm.SayIt(const s:string); // s is the string to be spoken
const
  SVSFDefault = 0;
  SVSFlagsAsync = 1;
  SVSFPurgeBeforeSpeak= 2;
begin
  memo1.setfocus;
  voice.Voice := voice.GetVoices.Item(combobox1.ItemIndex); // current voice selected
  voice.volume := tbVolume.position;
  voice.rate := tbRate.position;
  voice.Speak (s, SVSFlagsAsync {or SVSFPurgeBeforeSpeak});
end;

procedure TMainForm.Button1Click(Sender: TObject);
begin
  SayIt('Hello');
end;

procedure TMainForm.FormCreate(Sender: TObject);
begin
  voice := CreateOLEObject('SAPI.SpVoice');
end;

procedure TMainForm.FormDestroy(Sender: TObject);
begin
  voice  := Unassigned;
end;

end. 
```

另外请注意，由于您使用的是后期绑定，因此您不需要 SpeechLib_TLB 单元。

# mysql - MySQL 按逻辑顺序显示事件

> ID：12117884
> 
> 赞同：2
> 
> 时间：2012-08-24T23:30:26.120
> 
> 标签：mysql, sql, date

希望组织以下日期（假设今天是 2012 年 8 月 24 日）：

> 2012 年 12 月 1 日 2012 年
> 11 月 1 日 2012 年
> 6 月 1 日 2012 年
> 6 月 30 日

通过以下方式：

> 2012 年 11 月 1 日 2012 年
> 12 月 1 日 2012 年
> 6 月 30 日 2012 年
> 6 月 1 日

**这是这样一种方式，它首先**显示尚未发生的事件，从最快到最远，然后显示过去的事件，从最近到最远。

您可以假设表结构是：

```
ID   name    event_date
1    Test    1351742400  # All dates are Unix Time
2    Test2   1354338000 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:33:49.537

```
SELECT ID, name, event_date
FROM yourtable
ORDER BY event_date < UNIX_TIMESTAMP(), ABS(UNIX_TIMESTAMP() - event_date) 
```

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!2/e1c1c/1)

# jquery - 无法重新创建简单的 jQuery 即兴对话

> ID：12117888
> 
> 赞同：0
> 
> 时间：2012-08-24T23:31:00.847
> 
> 标签：jquery, jquery-plugins, impromptu

我从[Trent Richardson 的即兴示例 10](http://trentrichardson.com/Impromptu/)中几乎逐字复制了这个，但我无法让它工作。出于某种原因，示例 8 和 9 对我不起作用。我猜这很明显，但我无法弄清楚。

**头：**

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js" type="text/javascript"></script>
<script src="jquery-impromptu.4.0.min.js" type="text/javascript"></script>
<!--<script src="common.js" type="text/javascript"></script>-->
<link rel="stylesheet" media="screen and (min-device-width: 1050px)" type="text/css"     href="example.css">

<script type="text/javascript">
  var txt = 'Try submitting an empty field:<br /> 
  input type="text" id="alertName" 
  name = "myname" value="" />';

  function mysubmitfunc(e,v,m,f){
    an = m.children('#alertName');
    if(f.alertName == ""){
        an.css("border","solid #ff0000 1px");
        return false;
    }
    return true;
  }
</script> 
```

**身体：**

```
<button onclick="$.prompt(txt,{ submit: mysubmitfunc, buttons: { Ok:true } })" title="Example 10">Example 10</button> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T23:45:46.123

HTML：

```
<button id="example10">Example 10</button> 
```

JavaScript：

```
var text = 'Try submitting an empty field:<br><input type="text" id="alertName" name="myname" value="">';

$( '#example10' ).on( 'click', function () {      
    $.prompt( text, { submit: function ( e, val, $elem ) {
        var input = $elem.children( '#alertName' )[0];
        if ( input.value === '' ) {
            $( input ).css({ border: '1px solid red' });
            return false;
        }
        return true;
    }, buttons: { Ok: true } });    
}); 
```

**现场演示：http:** [//jsfiddle.net/NcDEh/2/](http://jsfiddle.net/NcDEh/2/)

# c# - 程序集 'SomeAssembly，使用 'System.Web.Mvc，版本 = 4.0.0.0，其版本高于引用的程序集 'System.Web.Mvc，版本 3.0.0.0

> ID：12117889
> 
> 赞同：14
> 
> 时间：2012-08-24T23:31:07.057
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, visual-studio-2010, visual-studio-2012

在 VS 2012 RTM 中打开并编译我的 VS 2010 .net 4.0 MVC3 项目后，出现以下错误。如何在不升级到 MVC4 的情况下解决此问题？

我并排安装了 VS 2010 和 VS 2012。

> 错误 1 ​​程序集 'SomeAssembly，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null' 使用 'System.Web.Mvc，Version=4.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35'，其版本高于引用的程序集'System.Web.Mvc，版本 = 3.0.0.0，文化 = 中性，PublicKeyToken = 31bf3856ad364e35'

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-26T17:24:22.620

要检查的另一件事是您没有测试项目仍在解决方案中引用 mvc3 程序集。这就是我的原因。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-01T17:53:53.803

检查您的`web.config`. `system.web/assemblies`即使您的项目引用 4.0，也有 3.0 版。

对我来说就是这样。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-26T08:08:18.277

转到参考，检查 System.web.mvc 的当前版本（我猜它仍然指向 mvc3）。删除它们并再次添加引用，但这次是 System.Web.Mvc 4.0..！如果您在单个解决方案中使用多个项目，那么.. 例如，您有两个项目 ProjA（MVC4）和 ProjB（仍在 MVC3 中），如果 ProjA 有 ProjB 的引用或使用 ProjB，那么它最有可能给出上述内容提到的错误。您可能必须在两个项目中更改 MVC 版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-08-27T12:51:12.413

如果您使用的是 Visual Studio，则可以检查 NuGet 包的更新，无需手动使用 Web.config 即可进行更新。选择工具 -> 库包管理器 -> 管理解决方案的 NuGet 包。通过在左侧面板中选择更新来检查您是否使用最新版本的 MVC，然后在更新列表中查找 MVC 并单击更新。更新完成后，单击构建并构建解决方案。这就是我解决 MVC 和 Fluent Validation NuGet 包之间的问题的方法。它会自动更新 Web.config。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-03T02:50:23.583

使用 asp.net 4.5 并有类似的问题。右键单击**References**并转到**Manage NuGet Packages**。检查是否有版本过时的软件包的更新。可能会要求覆盖文件，但没关系。

# java - 代码对于 try 语句来说太大，对于主要错误 Java 来说代码太大

> ID：12117891
> 
> 赞同：0
> 
> 时间：2012-08-24T23:31:31.753
> 
> 标签：java

> **可能重复：**
> [java中的“代码太大”编译错误](https://stackoverflow.com/questions/2407912/code-too-large-compilation-error-in-java)

我有一个 5147 行的 java 代码。但是，我无法运行它，因为它给出了错误，

```
code too large for try statement 
```

和

```
code too large for main 
```

谁能帮我解决这个问题？

# linux - “参数列表太长”只有 2 个参数？

> ID：12117894
> 
> 赞同：7
> 
> 时间：2012-08-24T23:32:15.517
> 
> 标签：linux, bash

我正在调试别人的代码，我遇到了一种情况，如果我试图故意编写它，我将不知道如何产生。它来自一个非常大的 Bash 脚本，由 Bash 4.1.2 在 CentOS 6 机器上运行。虽然整个程序非常庞大，但错误始终出现在以下函数中：

```
get_las() {
    echo "Getting LAS..."
    pushd ${ferret_workdir} >& /dev/null
    #Download:
    if [ ! -e ${las_dist_file} ] || ((force_install)) ; then
        echo "Don't see LAS tar file ${las_dist_file}"
        echo "Downloading LAS from ${las_dist_file} -to-> $(pwd)/${las_dist_file}"

        echo "wget -O '${las_dist_file}' '${las_tar_url}'"
        wget -O "${las_dist_file}" "${las_tar_url}"
        [ $? != 0 ] && echo " ERROR: Could not download LAS:${las_dist_file}" && popd >/dev/null && checked_done 1
    fi
    popd >& /dev/null
    return 0
} 
```

如果我允许脚本在原始环境中从头开始运行，则在到达此部分时，它将吐出以下错误并死掉：

```
Don't see LAS tar file las-esg-v7.3.9.tar.gz
Downloading LAS from las-esg-v7.3.9.tar.gz -to-> /usr/local/src/esgf/workbench/esg/ferret/7.3.9/las-esg-v7.3.9.tar.gz
wget -O 'las-esg-v7.3.9.tar.gz' 'ftp://ftp.pmel.noaa.gov/pub/las/las-esg-v7.3.9.tar.gz'
/usr/local/bin/esg-product-server: line 428: /usr/bin/wget: Argument list too long
 ERROR: Could not download LAS:las-esg-v7.3.9.tar.gz 
```

请注意，我什至在其中有一个调试回显，以证明参数只是两个小字符串。

如果我在上面的点让程序出错，然后立即从同一个期望脚本重新运行它，唯一的变化是它已经完成了这个之前的所有阶段并且正在检测并跳过它们，这个部分将正常执行而没有错误。这种行为在我的测试盒上是 100% 可重现的——如果我清除运行代码留下的所有痕迹，那么此后的第一次运行会在此时爆炸，随后的运行会很好。

我唯一能想到的是我在 Bash 本身中遇到了一些晦涩难懂的错误，它以某种方式导致它无形地泄漏 MAX_ARG_PAGES 内存，但我什至想不出任何理论上的方法来实现这一点，所以我在这里问。

到底是怎么回事，我该如何让它停止（没有极端措施，比如重新编译内核以增加内存）？

**更新：**要回答评论中的问题，第 428 行是

```
wget -O "${las_dist_file}" "${las_tar_url}" 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-24T23:44:03.523

错误`E2BIG`是指环境中的字节和 argv 列表的总和。脚本是否导出了大量（或大量）变量？跑`printenv`在前面`wget`看看发生了什么。

# email - 将查询中的电子邮件结果发送到结果中的所有电子邮件

> ID：12117900
> 
> 赞同：0
> 
> 时间：2012-08-24T23:33:00.237
> 
> 标签：email, proc

我有一个我认为是一个简单的问题，但在几个月内无法解决，所以就这样吧！！！

环境：微软 SQL 2008

我有一个每天晚上运行的 qyery，并为我提供了所有没有批准代码的订单的列表：

询问 ：

从 Approval 为 Null 的订单中选择 OrderId、First、Last、Email

结果：

## **OrderID 前 后 电子邮件**

第4565章

第3423章

很好，因为现在我知道哪些订单没有获得批准，但我想做的是让查询自动通过电子邮件向他们发送类似

***期望的结果*** 亲爱的汤姆，

您的订单没有批准代码，如果未输入代码，将在接下来的 48 小时内取消。

***** 期望的结果* *******

 **在任何给定时间，我都可能订购了 30 个这样的查询，因此查询只需要运行并生成一封电子邮件给每个人。如果一个人有多个订单，如果他们分别收到每个订单的电子邮件，那很好。请帮忙！！并且通过帮助我的意思是请让我看看如何实现这一目标的示例代码，因为我不知道如何。谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:59:46.113

您可以使用 SQL Server 中的电子邮件功能来发送电子邮件。

配置 SQL Server 后（[点击此链接](http://blog.sqlauthority.com/2008/08/23/sql-server-2008-configure-database-mail-send-email-from-sql-database/)）；您可以简单地循环浏览每封电子邮件，如下所示：

```
USE msdb
GO
EXEC sp_send_dbmail @profile_name='PinalProfile',
@recipients='tomcruise@Example.com',
@subject='Your Order',
@body='Hi there.' 
```

**更新**

这是一个如何遍历记录的示例：

```
declare @temp as table
(
Id int identity,
OrderId int, 
First varchar(255), 
Last varchar(255),
Email varchar(512)

)

insert into @temp
Select OrderId, First , Last ,Email from Orders where Approval is Null

declare @email varchar(512)
       , @index int=1 
       , @upper_bound int
       , @subject varchar(500)

select @upper_bound=max(Id) from @temp

while(@index<=@upper_bound)
BEGIN
select @email=email,@subject='Your order number '+OrderID from @temp where Id=@index

EXEC msdb.dbo.sp_send_dbmail @profile_name='profile',
@recipients=N@email,
@subject=@subject,
@body='Whatever you want to say here.'

select @index=@index+1

END

-- You are done 
```**

# json - 如何处理大型 JSON 文件的加载

> ID：12117901
> 
> 赞同：5
> 
> 时间：2012-08-24T23:33:09.103
> 
> 标签：json, large-files

我一直在开发一个 WebGL 应用程序，它需要大量的点数据才能绘制到屏幕上。目前，该点和表面数据存储在我正在使用的网络服务器上，并且浏览器在页面加载时正在下载所有 120MB 的 JSON。这在我的网络上需要一分钟多的时间，这不是最佳的。我想知道是否有人对加载这么大的数据有任何经验/提示。我已经尝试尽可能多地消除空格，但这几乎不会影响文件大小。

有什么方法可以极大地压缩这个文件，或者有更好的方法来下载如此大量的数据？任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T23:48:44.823

如果您控制发送数据的 Web 服务器，您可以尝试启用 json 数据压缩。

这是通过在 `applicationhost.config`(IIS 7) 中添加以下内容来完成的：

```
<system.webServer>
    <urlCompression doDynamicCompression="true" />
    <httpCompression>
      <dynamicTypes>
        <add mimeType="application/json" enabled="true" />
        <add mimeType="application/json; charset=utf-8" enabled="true" />        
      </dynamicTypes>
    </httpCompression>
</system.webServer> 
```

然后，您需要为您的应用重新启动应用程序池。

[资源](http://forums.iis.net/p/1155809/1895877.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T23:43:00.577

JSON 非常冗余，因此它可以很好地压缩，然后在客户端解压缩。

[Gzip 的 JavaScript 实现](https://stackoverflow.com/questions/294297/javascript-implementation-of-gzip)

或者，您可以将数据分成 1 MB 的块，一次发送一个以上。此外，用户可能无法一次与 120 MB 的数据进行交互，所以也许可以实现某种详细程度的系统？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-09T00:10:39.490

I had an issue sort of like the one you had, so I've decide to use binary numbers instead of strings so when the user create request to my server I answer with a numbers.

For ex' lets say the user is a table in a restaurant so instead of sending a string like 'burger,orange juice, water,etc...' I can send the number 15 and translate into binary 8,4,2,1.

when the user ask for multiple thing, lets say 4 burgers it will be hard to follow so you can add two numbers of an array with the binary. I found it very useful and more secure.

If you decide doing it, I suggest on dev' mode use string when you deploy translate into binary.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T23:44:33.733

您可能会考虑以下几点：

1.  您的服务器是否在发送前压缩文件？

2.  这些数据是否经常变化？如果没有，您可以将 expires 标头设置为很长的时间，以便浏览器可以将其保存在缓存中。它对第一个页面访问没有帮助，但在随后的页面访问中，文件不必再次加载。

3.  你的 json 文件中有很多重复的东西吗？例如，如果您的对象键很长，您可以用较短的键替换它们，发送，然后在浏览器中再次替换。如果文件被压缩（参见第 1 项），好处不会那么大，但根据您的文件，它可能会有所帮助。

4.  浏览器会一次性消耗所有这些数据吗？如果不是，您可以尝试将其分解为更小的部分，并在其他部分加载时开始处理第一部分。

但最重要的是：您确定 JSON 是适合这项工作的工具吗？通用压缩工具只能做到这一点，但如果您探索数据的特定特征，您可能能够获得更好的结果。如果您提供有关您使用的格式的更多详细信息，我们可能会为您提供更多帮助。

# javascript - 只执行一次函数

> ID：12117902
> 
> 赞同：2
> 
> 时间：2012-08-24T23:33:27.757
> 
> 标签：javascript, greasemonkey

我正在编写一个greasemonkey 脚本，并且只想在页面加载后调用一次*启动*函数——它是针对facebook 的。首先，我从以下代码开始：

```
function start(){
    alert("hello");
}

start(); 
```

start() 函数执行了不止一次。所以我将代码更改为以下内容：

```
jQuery.noConflict();
window.stoop = 0;
jQuery(document).ready(function(){
    if(window.stoop == 0){
        start();
    }
    window.stoop = 55;
    //or window.stoop++;
});

function start(){
    alert("hello");
} 
```

问题是 window.stoop 值不会改变。

我试过了

```
var stoop = 0;
stoop++; 
```

和

```
var obj = {};
obj.stoop = 0;
obj.stoop++; 
```

也是，但这些方法都不起作用。

我究竟做错了什么？我现在在欧洲——现在是晚上，所以我稍后会回答你的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T01:59:34.470

问题是您的整个 Greasemonkey 脚本执行了不止一次。Greasemonkey 将在 iframe 上运行，就像它们是主页一样 - 如果 iframe 与脚本的`@include`、`@exclude`和`@match`指令匹配。

尝试像这样跟踪状态是没有意义的，该函数只会在每次脚本执行时运行一次，除非您故意多次调用它（问题中没有显示）。并且脚本通常不能在执行实例之间共享信息（这里也不需要）。

此外，没有必要使用`jQuery(document).ready()`，因为除非您将脚本注入目标页面，否则`document.ready`默认情况下会触发 Greasemonkey。

要解决多次运行问题：

1.  调整您的`@include`、`@exclude`和`@match`指令，以尽可能多地消除不需要的 iframe。
2.  在脚本顶部附近添加这样的代码：

    ```
    if (window.top != window.self)  //-- Don't run on frames or iframes.
        return; 
    ```

# c# - 检测控制台何时关闭？

> ID：12117906
> 
> 赞同：0
> 
> 时间：2012-08-24T23:33:51.967
> 
> 标签：c#, .net, console

我用谷歌搜索并发现`Console.CancelKeyPress`它很有用，但很多次我都是通过关闭窗口来关闭我的控制台。使用右上角的 X。`Console.CancelKeyPress`检测到 ctrl+c，如何通过单击 X 来检测关闭？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T23:46:22.643

试试这个：

```
class Program
{
    static void Main( string[] args )
    {
        AppDomain.CurrentDomain.ProcessExit += ProcessExitHandler ;
    }

    static void ProcessExitHandler( object sender , EventArgs e )
    {
        throw new NotImplementedException("You can't shut me down. I quit!" ) ;
    }
} 
```

**编辑注意：**显然，Windows 7 中的 WRT 控制台应用程序已经消失了该技术和大多数其他技术。当窗口关闭时，控制台应用程序被强制终止，因此该应用程序永远不会收到信号。谢谢女士！

[http://social.msdn.microsoft.com/Forums/en/windowscompatibility/thread/abf09824-4e4c-4f2c-ae1e-5981f06c9c6e](http://social.msdn.microsoft.com/Forums/en/windowscompatibility/thread/abf09824-4e4c-4f2c-ae1e-5981f06c9c6e)

解决方案似乎是（请参见上面的 URL）使您的控制台应用程序成为具有处理消息的不可见窗口的 Windows 应用程序`WM_ENDSESSION`，该处理程序将在关闭之前有 5 秒的时间终止。

# c++ - 使用模板参数添加/删除数据成员？

> ID：12117912
> 
> 赞同：33
> 
> 时间：2012-08-24T23:34:46.687
> 
> 标签：c++, templates, c++11, metaprogramming, enable-if

考虑以下代码：

```
template<bool AddMembers> class MyClass
{
    public:
        void myFunction();
        template<class = typename std::enable_if<AddMembers>::type> void addedFunction();

    protected:
        double myVariable;
        /* SOMETHING */ addedVariable;
}; 
```

在这段代码中，模板参数`AddMembers`允许在类中添加一个函数`true`。为此，我们使用`std::enable_if`.

我的问题是：数据成员变量是否相同（可能有技巧）？（以这样的方式，`MyClass<false>`将有 1 个数据成员 ( `myVariable`) 并且`MyClass<true>`将有 2 个数据成员 (`myVariable`和`addedVariable`)？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-24T23:38:06.607

可以使用条件基类：

```
struct BaseWithVariable    { int addedVariable; };
struct BaseWithoutVariable { };

template <bool AddMembers> class MyClass
    : std::conditional<AddMembers, BaseWithVariable, BaseWithoutVariable>::type
{
    // etc.
}; 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-08-24T23:40:52.080

首先，您的代码不会为`MyClass<false>`. 该`enable_if`特征对*推导*参数有用，而不是类模板参数。

其次，您可以通过以下方式控制成员：

```
template <bool> struct Members { };

template <> struct Members<true> { int x; };

template <bool B> struct Foo : Members<B>
{
    double y;
}; 
```

# java - 如何让 Maven 多模块程序集将战争文件与 jar 文件放在单独的子目录中？

> ID：12117916
> 
> 赞同：1
> 
> 时间：2012-08-24T23:35:34.203
> 
> 标签：java, maven, maven-2, maven-3, maven-assembly-plugin

使用 Maven 3.0.4

我有一个多模块 maven 项目，其中一些模块产生 war 文件，而一些产生 jar 文件，正如它们各自的 pom 中所声明的那样

我想创建一个分发存档，其中 jar 工件和依赖项进入一个子目录，而 webapp 工件（无依赖项）进入另一个子目录。

就像是

```
project.tar/lib     <-- module jars and deps here
project.tar/webapp  <-- wars here 
```

让程序集将所有内容转储到一个目录中很简单。

这是我尝试过的：

```
<assembly>
    <id>bin</id>
    <formats>
        <format>tar.gz</format>
    </formats>

    <moduleSets>
        <moduleSet>
            <includes>
                <include>${module.groupId}:${module.artifactId}:war:${module.version}</include>
            </includes>
            <binaries>
                <includeDependencies>false</includeDependencies>
                <outputDirectory>webapp</outputDirectory>
            </binaries>
        </moduleSet>
        <moduleSet>
            <includes>
                <include>${module.groupId}:${module.artifactId}:jar:${module.version}</include>
            </includes>
            <binaries>
                <includeDependencies>true</includeDependencies>
                <outputDirectory>lib</outputDirectory>
            </binaries>
        </moduleSet>
    </moduleSets>
</assembly> 
```

现在，当我运行它时，我收到以下警告：

```
[INFO] Reading assembly descriptor: assembly.xml
[WARNING] The following patterns were never triggered in this artifact inclusion filter:
o  '${module.groupId}:${module.artifactId}:war:${module.version}'

[WARNING] The following patterns were never triggered in this artifact inclusion filter:
o  '${module.groupId}:${module.artifactId}:jar:${module.version}'

[WARNING] The following patterns were never triggered in this artifact inclusion filter:
o  '${module.groupId}:${module.artifactId}:war:${module.version}'

[WARNING] NOTE: Currently, inclusion of module dependencies may produce unpredictable results if a version conflict occurs.
[WARNING] The following patterns were never triggered in this artifact inclusion filter:
o  '${module.groupId}:${module.artifactId}:jar:${module.version}' 
```

不知道我做错了什么。我的包含遵循 maven 网页上指定的“group:artifact:version”模式。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:42:36.353

这似乎有效。不过，不确定这是否是最好的方法。Maven 似乎不尊重 ${module.whatever} 变量。

```
<dependencySets>
    <dependencySet>
        <includes>
            <include>${project.groupId}:*:war:${project.version}</include>
        </includes>
        <useProjectArtifact>true</useProjectArtifact>
        <outputDirectory>webapp</outputDirectory>
        <unpack>false</unpack>
    </dependencySet>
    <dependencySet>
        <excludes>
            <exclude>${project.groupId}:*:war:${project.version}</exclude>
        </excludes>
        <useProjectArtifact>true</useProjectArtifact>
        <outputDirectory>lib</outputDirectory>
        <unpack>false</unpack>
    </dependencySet>
</dependencySets> 
```

# android - Android ListView 不会随着适配器的更改而更新

> ID：12117920
> 
> 赞同：0
> 
> 时间：2012-08-24T23:36:29.920
> 
> 标签：android, listview, android-arrayadapter

我在更新 ListView 中的 ArrayAdapter 中的数据时遇到问题，甚至在 listAdapter.notifyDataSetChanged() 上，更改也没有反映在 ListView 中。

有趣的是初始加载很好，我得到了在 ListView 中呈现的完整数据列表。这是当我第二次加载活动时，缓存的 ArrayList 被传递给 setDataList() 方法没有被渲染。生成的 ListView 仅包含 onCreate() 方法中的单个默认条目设置。

我已经调试了代码并逐步完成了可运行文件，它似乎按我的预期运行，只是没有最终结果。

如果有人可以提供帮助，我将不胜感激，我已经用谷歌搜索了它！

我的代码片段：

```
public class CriteriaOriginIncludeActivity extends Activity {   

private CriteriaOriginIncludeController m_controller;
private CriteriaOriginIncludesAdapter m_listAdapter;
private ArrayList<OriginRowData> m_listData;
private ListView m_originList;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.criteria_origin_includes);      
    ArrayList<OriginRowData> list = new ArrayList<OriginRowData>();
    list.add(new OriginRowData(new Origin(0,""), false));

    m_listAdapter = new CriteriaOriginIncludesAdapter(this,
                                                                R.layout.origin_include_list_row,
                                                                R.id.lst_origin_include,
                                                                list);

    m_originList = (ListView) this.findViewById(R.id.lst_origin_include);
    m_originList.setAdapter(m_listAdapter);

    m_controller = new CriteriaOriginIncludeController(this);

}

public void setOriginList(ArrayList<OriginRowData> list) {

    if (list != null && list.size() > 0) {
        m_listData = list;
    } else {
        m_listData = new ArrayList<OriginRowData>();
    }

    runOnUiThread(returnRes);
}

private Runnable returnRes = new Runnable() {

public void run() {

    m_listAdapter.clear();
    if(m_listData != null && m_listData.size() > 0){
        m_listAdapter.notifyDataSetChanged();
        for(int i=0;i<m_listData.size();i++)
            m_listAdapter.add(m_listData.get(i));
    }
    m_listAdapter.notifyDataSetChanged();
}
};
} 
```

和适配器：

```
public class CriteriaOriginIncludesAdapter extends ArrayAdapter<OriginRowData> {
private ArrayList<OriginRowData> m_items;
    private Context m_context;

    public CriteriaOriginIncludesAdapter(Context context, int resourceId, int           textViewResourceId, ArrayList<OriginRowData> list) {
      super(context, resourceId, textViewResourceId, list);
      this.m_context = context;
      m_items = list;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
      View v = convertView;
      if (v == null) {
        LayoutInflater vi = (LayoutInflater)m_context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = vi.inflate(R.layout.origin_include_list_row, null);
      }
      OriginRowData o = m_items.get(position);
      if (o != null) {
        TextView txtName = (TextView) v.findViewById(R.id.txt_origin_include_name);
        TextView txtId = (TextView) v.findViewById(R.id.txt_origin_include_id);
        CheckBox chkOrigin = (CheckBox) v.findViewById(R.id.chk_origin);

        if (txtName != null) {
          txtName.setText(o.getOrigin().getOrigin());                            
        }
        if (txtId != null) {
          txtId.setText(Integer.toString(o.getOrigin().getId()));                            
        }
        if (chkOrigin != null) {
          chkOrigin.setChecked(o.getInclude());

          chkOrigin.setOnClickListener(new OriginIncludeOnClickListener(position));
        }

      }

      return v;
   }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T10:55:23.430

您需要覆盖`ArrayAdapter`的`Add()`方法。

由于您使用自己的 private `private ArrayList<OriginRowData> m_items;`，默认`Add()`方法不知道它必须将数据添加到此数组列表中。

在您的 getView 中，您使用的是`m_items`数组，因此需要更新。默认`Add()`方法会将项目添加到 ArrayAdapter 的内置

# c# - 如何在启动时在其 Form_Load 中使用 SQl 数据库运行应用程序

> ID：12117923
> 
> 赞同：0
> 
> 时间：2012-08-24T23:36:42.853
> 
> 标签：c#, sql, startup

我在 Visual Studio 2010 和 SQL Server 2008 上使用 C# 开发了一个应用程序。我的应用程序就像一个通知程序，当窗口在应用程序的启动`Form_Load`事件中启动时出现，它连接到 SQL 数据库，如下所示

```
da = new SqlDataAdapter("select info_id,info_text,cat_id from info " + cat, a.GetConnectionStringByName());
SqlCommandBuilder br = new SqlCommandBuilder(da);
ds = new DataSet();
da.Fill(ds, "em");
richTextBox1.Text = "";
txt = "";
DataRow dr = GetRow();
if (dr != null)
{
    richTextBox1.Text = dr["info_text"].ToString();
    txt = richTextBox1.Text;
} 
```

这是我的连接字符串

```
<add name="Info_Bank_Project.Properties.Settings.KBankConnectionString" connectionString="Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\KBank.mdf;Integrated Security=True;User Instance=True" providerName="System.Data.SqlClient" /> 
```

当应用程序在系统启动时在启动时运行时，它会出现一个异常，上面写着“有`connection timed out` 没有人知道该异常的原因以及如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T23:41:58.553

[当您尝试建立与数据库的连接并且数据库在 15 秒内](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.connectiontimeout%28v=vs.100%29.aspx)没有响应（默认值）时发生连接超时。

如果您遇到此类问题，是因为您的数据库服务器可能没有在侦听连接，或者您的连接字符串错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T00:34:36.620

我还没有看到以 .\SQLEXPRESS 作为源的 SQL 连接字符串。我猜它指向本地主机？如果您在 Windows 启动时运行此程序，您确定 SQL 已启动并在此应用程序启动之前侦听其端口吗？正如 Icarus 提到的，如果 SQL 花费的时间太长（默认 15 秒），您可以使用连接字符串（[连接字符串 MSDN](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.connectionstring%28v=vs.71%29.aspx) ）中的 Connection Timeout 字段更改它。我认为更好的方法是在连接之前添加一些逻辑尝试在继续之前检查是否有东西正在侦听 SQL 端口。

[在 C# 中，如何检查 TCP 端口是否可用](https://stackoverflow.com/questions/570098/in-c-how-to-check-if-a-tcp-port-is-available)的最佳答案？展示了如何在 C# 中执行此操作，将其转换为 VB 应该相当简单。您只需将其放在一个循环中，该循环会休眠 3 秒并再次尝试，直到端口被使用（因此与此示例相反）最多 20 次（1 分钟）或您想要放弃之前的任意时间。

# python - 将嵌套 dict 转换为 DHTML TreeGrid 控件的嵌套 XML

> ID：12117924
> 
> 赞同：0
> 
> 时间：2012-08-24T23:36:46.623
> 
> 标签：python, dhtmlx

我有一个嵌套的 python 字典，如下所示，我需要支持任意级别的嵌套。

```
{
'2012-08-07': {'17': ['30']}, 
'2012-08-24': {'3': ['70']}
} 
```

但我需要转换为如下所示的 xml 格式：

```
xml = """<?xml version="1.0" ?>
        <rows id="start">
            <row id="1">
                <cell> 2012-08-07 </cell>
                <cell></cell>
                <row id="2">
                    <cell> 17 </cell>
                    <cell>30</cell>
                </row>
            </row>
              <row id="3">
                <cell> 2012-08-24 </cell>
                <cell></cell>
                <row id="4">
                    <cell> 3 </cell>
                    <cell>70</cell>
                </row>
            </row> 
        </rows>""" 
```

这是为了使用 DHTMLX 为 treegrid 控件创建 XML。dict 的键将用于树级别，而叶列表是值。

这是我使用的由defaultdict生成的实际dict：

```
defaultdict(<functools.partial object at 0x30768e8>, {'2012-08-07': defaultdict(<functools.partial object at 0x3076890>, {'17': ['30']}), '2012-08-24': defaultdict(<functools.partial object at 0x3076890>, {'3': ['70']})}) 
```

# asp.net-mvc-3 - 谷歌地图 + asp .net mvc 3 不工作

> ID：12117931
> 
> 赞同：1
> 
> 时间：2012-08-24T23:38:03.823
> 
> 标签：asp.net-mvc-3, google-maps

我正在自学asp .net mvc 3。我阅读了本教程： http: [//www.codeproject.com/Articles/148949/ASP-NET-MVC-3-the-Razor-View-Engine-and-Google-Map](http://www.codeproject.com/Articles/148949/ASP-NET-MVC-3-the-Razor-View-Engine-and-Google-Map)和其他几个这样的帖子。但是，我无法在我的应用程序上运行谷歌地图。我究竟做错了什么？

看法：

```
 @section Scripts_head {
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> 
    }

    <script type="text/javascript">
        function initialize() {
            var latlng = new google.maps.LatLng(40.716948, -74.003563);
            var options = { zoom: 14, center: latlng, mapTypeId: google.maps.MapTypeId.ROADMAP };
            var map = new google.maps.Map(document.getElementById("map"), options);
        }

        $(function () {
            initialize();
        });
    </script>
<div id="map" style="width:80%; height:80%"></div> 
```

我也尝试将 div 放在 script 标签上。

布局页面：

```
<head>
    ...
    @RenderSection("Scripts_head", false)
</head> 
```

控制器：

```
public class MapController : Controller
{
    //
    // GET: /Map/

    public ActionResult Index()
    {
        return View();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:08:07.327

如果您没有错误，那么它可能是您的 div“地图”的大小。这是您在 JsFiddle 中提取和工作的代码：http: [//jsfiddle.net/GNwU8/3/](http://jsfiddle.net/GNwU8/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T08:32:21.010

给你地图 div 一个绝对大小。你有：

```
<div id="map" style="width:80%; height:80%"></div> 
```

...但那是什么的 80%？

而是尝试：

```
<div id="map" style="width:400px; height:300px"></div> 
```

# eclipse - 如何让 jenkins 和 m2eclipse 共享同一个 maven 存储库

> ID：12117934
> 
> 赞同：0
> 
> 时间：2012-08-24T23:38:08.613
> 
> 标签：eclipse, maven, ssh, jenkins

如何配置 m2eclipse（用于 eclipse 的 maven 插件）以使用 jenkins 中也使用的集中式 maven 存储库。

m2eclipse 中的默认用户设置类似于“home/user/.m2”我们如何执行“ssh user@192.168.1.200:/var/lib/jenkins/.m2”之类的操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T23:46:41.483

一个简洁而简单的方法是使用存储库管理器。Sonatype 的[Nexus](http://www.sonatype.org/nexus/)似乎是最受欢迎的，但还有其他的（例如 JFrog Artifactory 和 Apache Archiva）。它们作为 HTTP 服务器运行，您可以更改 Maven 配置（本地和 Jenkins）以将其用作任何 Maven 存储库（例如 Central Maven 存储库）[的镜像，或使用它来托管您自己的存储库。](http://www.sonatype.com/books/nexus-book/reference/maven-sect-single-group.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T09:05:21.240

没有必要这样做。您的 POM 文件列出了依赖项，它们列出了存储库。然后，Maven 将解决您对所有已知存储库的依赖关系（列出的存储库和“内置”存储库，如 Maven 中心）。

当运行 Maven 构建时，Maven 将在 m2eclipse 中执行此操作。在 Jenkins 上运行构建时，Maven 也会这样做。因此，如果两台机器都可以连接到您的 POM 文件中列出的所有存储库，那么它们都将检索相同的工件并且都将执行相同的构建。

您真的不应该尝试共享工件的本地副本。这就像我和你尝试使用网络共享来共享我们的 Maven 工件一样糟糕。Maven 旨在查找和管理这些工件，您正在尝试解决*这个*问题。

# javascript - AMD 加载程序如何在后台工作？

> ID：12117935
> 
> 赞同：15
> 
> 时间：2012-08-24T23:38:20.390
> 
> 标签：javascript, amd

所以我现在一直在使用 require.js，但我意识到我实际上不知道它是如何工作的。它说它是一个 AMD 加载程序。

我确实理解 CommonJS 是同步的，这意味着它在加载时会阻止其他代码的执行。另一方面，AMD 是异步的。这就是我感到困惑的地方。

当我定义一个模块时，它必须加载 a,b,c 才能执行回调。异步在这里如何工作？

1.  当它必须首先加载这三个依赖项时，它不是同步的吗？
2.  这是否意味着AMD异步加载a，b，c然后检查这些文件是否已加载（不关心顺序）然后执行回调？

```
define("name",["a","b","c"], function(a,b,c){

}); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-24T23:48:03.487

如您所知，“AMD”（异步模块定义（AMD））是一个特定的 API。有许多与 AMD 兼容的“加载器”，包括 RequireJS、curl.js 和 Dojo（以及其他）。

就像 JQuery 和 Dojo 这样的框架为您提供了一个基于原始 Javascript 的 API；使用 AMD 的程序：

1) 需要一个与 AMD 兼容的 .js 库，

2) 要求一定的编程“规则”和“约定”，以及

3) 最终位于 Javascript 的“顶部”，它在您的“Javascript 引擎”（无论是 IE、Chrome、Firefox - 什么）上运行。

以下是我发现有用的几个链接：

*   [https://www.ibm.com/developerworks/mydeveloperworks/blogs/94e7fded-7162-445e-8ceb-97a2140866a9/entry/loading_jquery_with_dojo_1_7_amd_loader2?lang=en](https://www.ibm.com/developerworks/mydeveloperworks/blogs/94e7fded-7162-445e-8ceb-97a2140866a9/entry/loading_jquery_with_dojo_1_7_amd_loader2?lang=en)

*   [http://dojotoolkit.org/reference-guide/1.8/loader/amd.html](http://dojotoolkit.org/reference-guide/1.8/loader/amd.html)

*   [http://blog.millermedeiros.com/amd-is-better-for-the-web-than-commonjs-modules/](http://blog.millermedeiros.com/amd-is-better-for-the-web-than-commonjs-modules/)

*   [http://addyosmani.com/writing-modular-js/](http://addyosmani.com/writing-modular-js/)

PS：为了回答您的直接问题，后一个链接对“require（）”和“dynamically_loaded dependencies”进行了一些讨论。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-09-18T09:12:37.477

由于我写了一个 AMD loader，所以我将尝试直接回答问题：

> 当它必须首先加载这三个依赖项时，它不是同步的吗？

根据定义，Javascript 是单线程的。这意味着您在其中运行的任何内容始终按顺序运行。您可以在浏览器中做的唯一事情是在脚本标签上使用“async”参数包含脚本，这将使加载脚本的顺序未定义（异步）。一旦脚本执行，它将是该时间点唯一执行的脚本。

> 这是否意味着AMD异步加载a，b，c然后检查这些文件是否已加载（不关心顺序）然后执行回调？

正确的。AMD-define() 允许您以您希望的任何顺序加载所有脚本（即最终您让浏览器掷骰子并在它认为合适的任何时间以它认为合适的任何顺序加载它们）。

然后，任何时候调用 define()，AMD 加载器都会检查当前定义的依赖项列表是否已经满足。如果是，它将立即调用当前回调，然后，它将检查是否也可以调用之前注册的任何定义回调（因为它们的所有依赖项都已满足）。如果尚未完全满足此回调的依赖关系，则将回调添加到队列中以稍后解决。

这最终导致以正确的依赖顺序调用所有回调，而不管脚本首先加载/执行的顺序如何。

# excel - Excel vlookup() 使用正确的函数？

> ID：12117936
> 
> 赞同：1
> 
> 时间：2012-08-24T23:38:34.187
> 
> 标签：excel, excel-formula, vlookup

我不确定是否`VLOOKUP()`是我正在寻找的功能，但这是我正在处理的电子表格：[https ://docs.google.com/spreadsheet/ccc?key=0Ap96QeCBYRNtdDlpX0lONDg1YThLN1M5YkNlT1FBeFE](https://docs.google.com/spreadsheet/ccc?key=0Ap96QeCBYRNtdDlpX0lONDg1YThLN1M5YkNlT1FBeFE)

我基本上想做的是使用单元格**E18:P18**中的值来确定是否应该替换单元格**E4:P7中的值。**如果该范围内有非**0**的值，则应从**E13:P16**范围内的相应列中获取值并将它们替换为相应的项目。

因此，对于本示例，我们将替换项目值 1（武器 #1）、3（副手）、4（掌舵）和 5（肩部）。可以在电子表格上看到预期的结果，这些是我想在装备项目中显示的值。有没有办法通过excel公式轻松实现这一点？如果是这样，最好的使用方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T01:25:58.503

经过我们的讨论，这就是我认为你应该做的事情。

在预期结果表中，在单元格 E31 中尝试以下公式：

```
=IFERROR(INDEX($E$17:$P$20,ROWS($1:1),MATCH(VLOOKUP(E$30,$A$4:$B$17,2,FALSE),$E$22:$P$22,0)),E4) 
```

粘贴后，您可以复制下来，公式将相应调整。

这是根据您的信息显示的预期结果图片： ![在此处输入图像描述](../Images/6fc2b7217349615ad67e53f9c4e86a55.png)

请让我知道这是否是预期的结果:)

# git - git-http-backend 返回错误 502

> ID：12117942
> 
> 赞同：1
> 
> 时间：2012-08-24T23:39:31.440
> 
> 标签：git, gitolite, gitweb

我在我的服务器上运行 gitweb 和 gitolite：http: [//git.jshawl.com/](http://git.jshawl.com/)

我在设置`git-http-backend`允许匿名克隆时遇到问题。

这是我的虚拟主机文件 ( `/etc/apache2/extra/httpd-vhosts.conf`) 的样子：

```
<VirtualHost *:80>
DocumentRoot "/Users/git/repositories"
ServerName git.jshawl.com
 <Directory "/Users/git/repositories">
    Options ExecCGI +FollowSymLinks +SymLinksIfOwnerMatch
    AllowOverride All
    order allow,deny
    Allow from all
    AddHandler cgi-script cgi
    DirectoryIndex gitweb.cgi
</Directory>

<LocationMatch "^/.*/git-receive-pack$">
    AuthType Basic
    AuthName "Git Access"
    Require group committers
</LocationMatch

SetEnv GIT_PROJECT_ROOT /Users/git/repositories
SetEnv GIT_HTTP_EXPORT_ALL
ScriptAliasMatch \
    "(?x)^/(.*/(HEAD | \
        info/refs | \
            objects/(info/[^/]+ | \
                [0-9a-f]{2}/[0-9a-f]{38} | \
                    pack/pack-[0-9a-f]{40}\.(pack|idx)) | \
            git-(upload|receive)-pack))$" \
    /usr/libexec/git-core/git-http-backend/$1

ScriptAlias / /Users/git/repositories/gitweb.cgi/ 
```

`

我按照这里的指示进行操作：http: [//www.kernel.org/pub/software/scm/git/docs/git-http-backend.html](http://www.kernel.org/pub/software/scm/git/docs/git-http-backend.html)，但一直面临着 502 错误。

我的 apache 错误日志说：`[Fri Aug 24 19:29:32 2012] [error] [client 198.228.200.148] client denied by server configuration: /usr/libexec/git-core/git-http-backend`

此外，添加所有这些已经取消了我的 gitweb 安装（以前位于[http://git.jshawl.com](http://git.jshawl.com)）

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T00:11:02.667

这是[另一种方法，`httpd.conf`](https://github.com/VonC/compileEverything/blob/master/apache/env.conf.tpl#L49-84)它适用于克隆/推送/拉取，但**它不调用 gitweb.cgi**：

GitWeb 是用来浏览的，不是用来克隆的

（小摘录，删除 Auth 详细信息和 SSL 详细信息）

```
# GitHttp on @PORT_HTTP_HGIT@
Listen @PORT_HTTP_HGIT@
<VirtualHost @FQN@:@PORT_HTTP_HGIT@>
  ServerName @FQN@
  ServerAlias @HOSTNAME@
  SetEnv GIT_PROJECT_ROOT @H@/repositories
  SetEnv GIT_HTTP_EXPORT_ALL
  SetEnv GITOLITE_HTTP_HOME @H@
  ScriptAlias /hgit/ @H@/gitolite/bin/gitolite-shell/
  SetEnv GIT_HTTP_BACKEND "@H@/usr/local/apps/git/libexec/git-core/git-http-backend"
  <FilesMatch "\.(cgi|shtml|phtml|php)$">
    SSLOptions +StdEnvVars
  </FilesMatch>
  <Location /hgit>
    AddHandler cgi-script cgi
  </Location>
</VirtualHost> 
```

换句话说：

*   `git-http-backend`由变量引用 `GIT_HTTP_BACKEND`，但**如果您使用 Gitolite V3，则不需要它**。
*   **[`gitolite-shell`](https://github.com/sitaramc/gitolite/blob/master/src/gitolite-shell)**当您`/hgit/`在克隆地址中使用时调用：theat GitoliteV3 脚本将检查您是否有权克隆 repo，如果是，将调用脚本后面的命令`git-http-backend`：' `git-receive-pack`'（用于推送）或' `git-upload-pack`'（用于克隆/pull/fetch)，直接来自 git 源本身[`http-backend.c`](https://github.com/git/git/blob/master/http-backend.c#L518-533)。

所以：

```
git clone https://yourServer/hgit/yourRepo 
```

将调用 gitolite，它将调用 ' `git-receive-pack`' 或 ' `git-upload-pack`'。
它将首先通过调用来分析http请求[`sub http_simulate_ssh_connection()`](https://github.com/sitaramc/gitolite/blob/master/src/gitolite-shell#L200-L221)

```
sub http_simulate_ssh_connection {
    # these patterns indicate normal git usage; see "services[]" in
    # http-backend.c for how I got that. Also note that "info" is overloaded;
    # git uses "info/refs...", while gitolite uses "info" or "info?...". So
    # there's a "/" after info in the list below
    if ( $ENV{PATH_INFO} =~ m(^/(.*)/(HEAD$|info/refs$|objects/|git-(?:upload|receive)-pack$)) ) {
        my $repo = $1;
        my $verb = ( $ENV{REQUEST_URI} =~ /git-receive-pack/ ) ? 'git-receive-pack' : 'git-upload-pack';
        $ENV{SSH_ORIGINAL_COMMAND} = "$verb '$repo'";
    } else {
        # this is one of our custom commands; could be anything really,
        # because of the adc feature
        my ($verb) = ( $ENV{PATH_INFO} =~ m(^/(\S+)) );
        my $args = $ENV{QUERY_STRING};
        $args =~ s/\+/ /g;
        $args =~ s/%([0-9A-Fa-f]{2})/chr(hex($1))/eg;
        $ENV{SSH_ORIGINAL_COMMAND} = $verb;
        $ENV{SSH_ORIGINAL_COMMAND} .= " $args" if $args;
        http_print_headers(); # in preparation for the eventual output!
    }
    $ENV{SSH_CONNECTION} = "$ENV{REMOTE_ADDR} $ENV{REMOTE_PORT} $ENV{SERVER_ADDR} $ENV{SERVER_PORT}";
} 
```

# android - onDestroy 被调用但服务没有结束

> ID：12117946
> 
> 赞同：4
> 
> 时间：2012-08-24T23:39:58.423
> 
> 标签：android, android-service

我正在关注“Beginning Android 4 Development”一书，并且正在使用按钮的以下功能控制服务：

```
public void startService(View view) {
    startService(new Intent(getBaseContext(), QOLService.class));
}

public void stopService(View view) {
    stopService(new Intent(getBaseContext(), QOLService.class));
} 
```

QOLService.java 包括

```
public class QOLService extends Service {

    int counter = 0;

    @Override
    public IBinder onBind(Intent arg0) {
        return null;
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        //Keep running service until stopped, so return sticky
        Timer timer=new Timer();
        TimerTask tt =new TimerTask() {
            @Override
            public void run() {
                Log.d("QOLService", String.valueOf(++counter));
                }
        };

        timer.scheduleAtFixedRate(tt, 0, 1000);

        Toast.makeText(this, "Service started", Toast.LENGTH_LONG).show();
        return START_STICKY;
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        Toast.makeText(this, "Service destroyed", Toast.LENGTH_LONG).show();
    } 
```

正如预期的那样，在按下开始按钮时，我得到了“服务启动”toast，在 logcat 中，我每秒都会收到一条递增的消息。即使在应用程序关闭时，这种情况也会按预期继续。

当我单击 stopservice 按钮时，我也会收到预期的“服务已损坏”消息，但计时器仍然存在！如果我关闭应用程序，它仍然会继续运行。如果我再次单击 stopservice 按钮，它不会给出服务销毁消息，就好像它第一次被成功销毁一样。

我是否不恰当地调用我的计时器？如果是这样，我似乎完全按照书中的建议去做了！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T23:59:20.647

> 我是否不恰当地调用我的计时器？

你永远不会停止计时器。因此，它将继续运行，直到进程终止。您应该在`onDestroy()`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-25T03:03:47.530

我同意 CommonsWare，你没有在代码中停止你的计时器。建议你走这条路

```
public class QOLService extends Service {

    int counter = 0;
    Timer timer;
    TimerTask tt;

    @Override
    public IBinder onBind(Intent arg0) {
        return null;
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        //Keep running service until stopped, so return sticky
        timer=new Timer();
        tt =new TimerTask() {
            @Override
            public void run() {
                Log.d("QOLService", String.valueOf(++counter));
                }
        };

        timer.scheduleAtFixedRate(tt, 0, 1000);

        Toast.makeText(this, "Service started", Toast.LENGTH_LONG).show();
        return START_STICKY;
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        Toast.makeText(this, "Service destroyed", Toast.LENGTH_LONG).show();
        tt.cancel();
        timer.cancel();
    }
} 
```

cancel() 方法也会停止你的 Timer。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T23:58:46.017

这可能是因为系统正在尝试重新启动您的服务，因为您正在`START_STICKY`从`onStartCommand`. 尝试返回`START_NOT_STICKY`。

# javascript - 如何让一个 div 在 HTML 页面上移动而不进入下一层

> ID：12117953
> 
> 赞同：0
> 
> 时间：2012-08-24T23:40:54.330
> 
> 标签：javascript, jquery, html, css

我在一行上创建了一个 div，现在当我缩放它们时，以下 div 会在页面上向下移动。我不希望它们移动到下一个级别，而是希望 HTML 宽度应该增加并且它们应该保持在同一级别。我找到了一个 jsfiddle 用于我为我的练习创建的东西。如果您单击图像，它们会被缩放，并且经过一些缩放后，右侧图像会向下移动到下一个级别。对我来说，这不应该发生。这该怎么做？

jsFiddle 的链接是：http: [//jsfiddle.net/bq6Ju/14/](http://jsfiddle.net/bq6Ju/14/) 下面的代码是由堆栈溢出学者之一编写的，这是我在我的测试应用程序中有类似的东西

```
 .flower {
display: block;
float: left;
margin: 10px;
width: 100px;
height: 100px;
overflow: hidden;
border: 1px solid red;
}

.flower img {
width: 100%;
height: 100%;
}
.flower div {
width: 200px;
height: 200px;
position: relative;
}

.chunk2 div {
left: -100px;
}
.chunk3 div {
top: -100px;
}
.chunk4 div {
top: -100px;
left: -100px;
} 
```

HTML代码是

![](../Images/45ec7e3770f13b46f70aaf3737979913.png) ![](../Images/45ec7e3770f13b46f70aaf3737979913.png) ![](../Images/45ec7e3770f13b46f70aaf3737979913.png) ![](../Images/45ec7e3770f13b46f70aaf3737979913.png)

Javascript/Jquery 代码是

```
$('div.flower').click(function(){

var resize = 1.30;

var $this = $(this);
var $inner = $this.find('div');

$this.animate({          
    'width': $this.width() * resize,
    'height': $this.width() * resize,   
});

var p = {
    top: parseInt($inner.css('top')),
    left: parseInt($inner.css('left'))
}
console.log(p);
$inner.animate({
    'width': $inner.width() * resize,
    'height': $inner.width() * resize,
    'top': p.top*resize,
    'left': p.left*resize,        
});   

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:59:54.837

您可以在图像周围添加一个容器并防止包装并通过溢出属性添加滚动条：

```
.container { overflow: auto; white-space: nowrap; } 
```

并不是为了让这个工作我已经删除了`float`，因为这会阻止你 AFAIK 做你想做的事。我已将`display`属性更改为`inline-block`. 我还添加了该`vertical-align`属性以确保图像始终顶部对齐。

```
.flower {
    display: inline-block;
    margin: 10px;
    width: 100px;
    height: 100px;
    overflow: hidden;
    border: 1px solid red;
    vertical-align: top;
} 
```

你可以在这里看到演示：http: [//jsfiddle.net/bq6Ju/18/](http://jsfiddle.net/bq6Ju/18/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T00:23:26.913

添加一个浮动容器`nowrap`也可以。

[http://jsfiddle.net/bq6Ju/19/](http://jsfiddle.net/bq6Ju/19/)

```
.container {
    float: left;
    white-space: nowrap;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T05:43:22.027

演示：http: [//jsfiddle.net/bq6Ju/26/](http://jsfiddle.net/bq6Ju/26/)

**HTML：**

```
<div class="row">
<div class="row_wrapper">
  <div class="flower chunk1">
    <div>
      <img src="http://assets.freeprintable.com/images/item/thumb/lotus-flower.jpg"/>
    </div>
  </div>
  <div class="flower chunk2">
    <div>
      <img src="http://assets.freeprintable.com/images/item/thumb/lotus-flower.jpg"/>
    </div>
  </div>
  <div class="flower chunk3">
    <div>
      <img src="http://assets.freeprintable.com/images/item/thumb/lotus-flower.jpg"/>
    </div>
  </div>
  <div class="flower chunk4">
    <div>
      <img src="http://assets.freeprintable.com/images/item/thumb/lotus-flower.jpg"/>
    </div>
  </div>

  <div style="clear: both;"></div>
</div>
</div>

<!-- and here more rows --> 
```

**CSS：**

```
.row {
  overflow-x: scroll;
}

.row_wrapper {
  width: 500px; /* initial width */
}

/* other your css */ 
```

**JavaScript**

```
// in click handler

var total_width = 0;
var cur_outer = $(this).outerWidth(true) - $(this).width();
var cur_inner = resize * $(this).width();
var total_width = cur_outer + cur_inner;

$(this).parent().children('.flower').not(this).each(function () {
  total_width += $(this).outerWidth(true);
});

$(this).parent().width(total_width + 10); 
```

# ios - 为什么即使我从捆绑包中删除了图像，Xcode 仍会将图像复制到设备？

> ID：12117955
> 
> 赞同：0
> 
> 时间：2012-08-24T23:40:56.723
> 
> 标签：ios, xcode, debugging, device

我曾经在设备内的应用程序中存储一些图片，然后决定将它们移动到服务器上。但是，即使我从捆绑包中删除了它们，当我在设备上调试我的应用程序时，它们仍然会复制到我的设备上。

我确保将它们从“复制捆绑资源”构建阶段中删除。此外，没有图片的包大小为 20Mb，带图片的包大小约为 400Mb，存档大小也是如此。我可以确认，当我现在归档我的应用程序时，它按预期大小为 20Mb，但是当我将它安装到我的设备上时，它占用了 400Mb。

我很困惑。知道发生了什么吗？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T00:06:18.057

您可以确保通过执行以下步骤来解决此问题。

1.  Command-shift-k = 清除目标
2.  Command-option-shift-k = 清空缓存并清除所有目标
3.  从设备中删除应用程序
4.  重启 Xcode

如果这不这样做，什么都不会！

**注意：**为获得最佳结果，请在再次构建到设备之前执行所有这些步骤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T23:50:19.970

我遇到了这种情况，我不得不从设备中删除该应用程序并重新构建它并将其放回以修复它。这可能对你有用。

# jquery - 在 javascript 中创建函数与以 jQuery.fn 形式创建插件有什么区别？

> ID：12117956
> 
> 赞同：0
> 
> 时间：2012-08-24T23:41:00.397
> 
> 标签：jquery, function, plugins

我有一些用 jQuery 创建的可重复函数，我想重用。我可以将它们写在函数（）中，但我看到的另一个是插件形式

```
jQuery.fn = 
```

所以我不确定是应该写函数还是使用插件形式，有什么区别？我的函数中的代码相当大，我应该使用插件形式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:58:39.383

jquery 插件的主要优点是可移植性。它使您可以构建更易于使用和维护的结构。请参阅本文了解其他好处： http:
//james.padolsey.com/javascript/why-create-a-jquery-plugin
这取决于您正在构建的内容。例如，如果没有重复使用，您可能会考虑使用函数。
如果您需要一篇关于创建插件的好文章 - 请参考：http://james.padolsey.com/javascript/why-create-a-jquery-plugin。
请同时考虑其他选项。我喜欢使用 Microsoft Ajax 库并构建一组“对象”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T23:46:14.323

阅读此[http://docs.jquery.com/Plugins/Authoring](http://docs.jquery.com/Plugins/Authoring)以获取有关 jQuery 的 .fn 的更多信息。

在您的情况下，我猜您可以简单地使用普通的普通 JS 函数，因为您不编写插件；）

# git - 全局 git 文件位置 linux

> ID：12117957
> 
> 赞同：21
> 
> 时间：2012-08-24T23:41:05.100
> 
> 标签：git, centos

我正在使用 Centos 我正在寻找我的全局 git 配置文件 谁能告诉我在哪里可以找到该文件？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2014-04-17T13:41:41.337

您还可以查找/编辑运行命令的那些配置文件：

```
git config --global -e
git 配置 --system -e
git config --local -e

```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-08-25T00:16:54.233

打字`man git config`有一个名为 FILES 的部分，它列出了所有系统文件的位置。全局 Git 配置文件位于 . `~/.gitconfig`，但也有一个“系统”配置文件，通常位于`/etc/gitconfig`.

# video-encoding - 带有 mbtree 选项的 libx264 2 pass 编码，第一次通过失败

> ID：12117963
> 
> 赞同：0
> 
> 时间：2012-08-24T23:41:44.343
> 
> 标签：video-encoding, x264, libx264

我正在开发一个使用 libx264 的应用程序。在进行 2 遍编码时，如果启用了 mbtree 选项，则第 1 遍似乎不会将任何内容放入 stats 文件中：

```
 x264_1345845358591.L.mbtree.temp (size of 0)
    x264_1345845358591.L.temp

    $ cat x264_1345845358591.L.temp 
    #options: 288x162 fps=2997/100 timebase=100/2997 bitdepth=8 cabac=0 ref=3 
    deblock=1:0:0 analyse=0x1:0x111 me=hex subme=7 psy=1 psy_rd=1.00:0.00 
    mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=0 cqm=0 deadzone=21,11 
    fast_pskip=1 chroma_qp_offset=-2 threads=48 sliced_threads=0 nr=0 
    decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=0 
    weightp=0 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=40 
    rc=abr mbtree=1 bitrate=210 ratetol=1.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 
    ip_ratio=1.40 aq=1:1.00** 
```

当我为第二遍执行 x264_encoder_open() 时，我收到失败消息：

```
 x264 [error]: ratecontrol_init: can't open stats file
    x264 [error]: x264_encoder_open failed 
```

所以它似乎在第一次通过时失败了。如果我关闭 mbtree，2pass 工作正常。只要关闭mbtree，我就可以使用预设或调整参数运行它。什么参数（见上面的列表）可能使 mbtree 在第一次通过时失败？

# lua - Lua：如何检查字符串是否只包含数字和字母？

> ID：12117965
> 
> 赞同：4
> 
> 时间：2012-08-24T23:42:18.330
> 
> 标签：lua, pattern-matching, alphanumeric, non-alphanumeric

简单的问题可能有一个简单的答案，但我目前的解决方案似乎很糟糕。

```
local list = {'?', '!', '@', ... etc)
for i=1, #list do 
    if string.match(string, strf("%%%s+", list[i])) then
         -- string contains characters that are not alphanumeric.
    end
 end 
```

有没有更好的方法来做到这一点.. 也许用 string.gsub？

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-24T23:50:35.330

如果您要查看字符串是否仅包含字母数字字符，则只需将该字符串与所有*非字母数字*字符进行匹配：

```
if(str:match("%W")) then
  --Improper characters detected.
end 
```

该模式`%w`匹配字母数字字符。按照惯例，大写而不是小写的模式匹配反向字符集。所以`%W`匹配所有非字母数字字符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T02:03:32.807

您可以使用`[]`

```
local patt = "[?!@]"

if string.match ( mystr , patt ) then
    ....
end 
```

请注意，lua 中的字符类仅适用于单个字符（而不是单词）。有内置的类，`%W`匹配非字母数字，所以继续使用它作为快捷方式。

您还可以将内置类添加到您的集合中：

```
local patt = "[%Wxyz]" 
```

将匹配所有非字母数字 AND 字符`x`，`y`或`z`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-23T12:23:02.993

我使用这个 Lua 两线：

```
 local function envIsAlphaNum(sIn)
    return (string.match(sIn,"[^%w]") == nil) end 
```

当它检测到非字母数字时，它返回 false

# ruby-on-rails - 在rails上的身份验证ruby中处理不存在的cookie

> ID：12117966
> 
> 赞同：0
> 
> 时间：2012-08-24T23:42:24.913
> 
> 标签：ruby-on-rails, authentication, cookies, actiondispatch

我正在尝试在我的 ruby​​ on rails 应用程序中设置用户身份验证。我在 app/controllers/application_controller.rb 中有以下代码。当我尝试在设置之前引用 remember_token cookie 时，代码失败。我该如何解决？尝试使用 cookies.has_key(:remember_token) （见下文）失败，因为 cookies 不是哈希（我认为）。

```
 protect_from_forgery
include SessionsHelper
#before_filter :authenticate 

def authenticate
    @test={:email=>"dummy", :password=>"dummy"}
    @test=cookies.permanent.signed[:remember_token] if cookies.permanent.signed.has_key(:remember_token)==true

    if User.authenticate(@test[:email], @test[:password])[:allow]==false
        redirect_to :controller=>'sessions', :action=>'new'
    end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T00:12:12.763

你可以这样做：

```
@test=cookies.permanent.signed[:remember_token] unless cookies.permanent.signed[:remember_token].nil? 
```

# memory-management - 如何隔离 .NET 中的内存泄漏

> ID：12117967
> 
> 赞同：0
> 
> 时间：2012-08-24T23:42:25.733
> 
> 标签：memory-management, memory-leaks, garbage-collection, clr, memory-profiling

我知道以前有人问过这个问题，但是那里的很多信息似乎已经过时了。

是否可以将 .NET 应用程序中的内存泄漏隔离到对象类型或命名空间？有没有一个免费的、最新的工具可以做到这一点？

目前我正在使用*perfmon*来监视*私有字节*和堆中的内存使用情况，但我想隔离有问题的类或代码段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:02:09.083

[CLR Profiler](http://www.microsoft.com/en-us/download/details.aspx?id=16273) (microsoft.com) 为我完成了这项工作。将其附加到进程后，它可以显示堆中对象的快照图。

以下是我遵循的步骤：

1.  在控制台中运行*tasklist*以获取我的 Windows 服务的*进程 ID*
2.  将 CLR 分析器附加到进程
3.  点击“Show Heap Now”查看堆图

通过查看堆图，可以立即清楚地看出，[Sharepoint 客户端](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.client.aspx)吞噬了内存并且没有释放它。

# java - 无法使 Java GridBagConstraints 工作

> ID：12117970
> 
> 赞同：2
> 
> 时间：2012-08-24T23:43:15.070
> 
> 标签：java, graphics, awt, layout-manager, gridbaglayout

为此苦苦挣扎了一段时间。我的方法如下所示：

```
public Frame(){
            JFrame window = new JFrame();
            window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            window.setSize(800, 600);

            JPanel panel = new JPanel(new GridBagLayout());

            GridBagConstraints gbc = new GridBagConstraints();
              gbc.gridheight =3;
              gbc.gridwidth = 3;

            JButton upButt = new JButton();//Buttons.upButton();
              gbc.gridx = 1;
              gbc.gridy = 0;
              panel.add(upButt, gbc);

            JButton downButt = new JButton();
              gbc.gridx = 1;
              gbc.gridy = 2;
              panel.add(downButt, gbc);

            JButton leftButt = new JButton();//Buttons.leftButton();
              gbc.gridx=0;
              gbc.gridy = 1;
              panel.add(leftButt, gbc);

            JButton rightButt = new JButton();//Buttons.rightButton();
              gbc.gridx =2;
              gbc.gridy = 1;
              panel.add(rightButt, gbc);

            window.add(panel);
            window.setVisible(true);

           } 
```

据我了解 - 在阅读和重读 Java 文档之后。- 这应该给我 4 个十字形的按钮。然而，情况并非如此，按钮在窗口中心彼此堆叠。我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T23:46:04.450

为什么使用 3 的 gridheight 和 gridwidth？至少可以说这有点奇怪。

为了我的钱，我会简化事情并使用简单的 GridLayout：

```
import java.awt.GridLayout;
import javax.swing.*;

public class Foo003 {
   public static void main(String[] args) {
      JButton upButton = new JButton("Up");
      JButton downButton = new JButton("Down");
      JButton leftButton = new JButton("Left");
      JButton rightButton = new JButton("Right");
      JComponent[][] components = { 
            { new JLabel(), upButton, new JLabel() },
            { leftButton, new JLabel(), rightButton },
            { new JLabel(), downButton, new JLabel() } };

      JPanel panel = new JPanel(new GridLayout(components.length,
            components[0].length, 8, 8));
      for (int i = 0; i < components.length; i++) {
         for (int j = 0; j < components[i].length; j++) {
            panel.add(components[i][j]);
         }
      }

      int eb = 15;
      panel.setBorder(BorderFactory.createEmptyBorder(eb, eb, eb, eb));

      JFrame frame = new JFrame("Grid e.g.");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(panel);
      frame.pack();
      frame.setLocationRelativeTo(null);
      frame.setVisible(true);
   }
} 
```

![在此处输入图像描述](../Images/73535954871b212c5e0c17f5e8deafd3.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T23:54:26.950

你的意思是这样的：

![越过我的按钮](../Images/0ac74563d7d6413eb4884cfac344d69c.png)

我会摆脱`gridwidth`和`gridheight`

```
public class TestGridBagLayout extends JFrame {

    public TestGridBagLayout() {

        setTitle("Test");
        setLayout(new GridBagLayout());
        setSize(200, 200);
        setLocationRelativeTo(null);
        setDefaultCloseOperation(EXIT_ON_CLOSE);

        GridBagConstraints gbc = new GridBagConstraints();
        gbc.gridx = 1;
        gbc.gridy = 0;
        add(createButton(), gbc);

        gbc.gridy = 2;
        add(createButton(), gbc);

        gbc.gridx = 0;
        gbc.gridy = 1;
        add(createButton(), gbc);

        gbc.gridx = 2;
        add(createButton(), gbc);

        setVisible(true);

    }

    protected JButton createButton() {

        return new JButton("+");

    }

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {

        new TestGridBagLayout();

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T00:26:46.530

当您使用时`gridHeight`，`gridWidth`您所说的是“此组件应占用 3 行和 3 列”。

来自 Java 文档：

```
gridheight
Specifies the number of cells in a column for the component's display area.

gridwidth
Specifies the number of cells in a row for the component's display area. 
```

这里，“组件”是要添加到面板的组件。你的情况下的按钮。

正如其他海报所说的那样，删除 gridWidth 和 gridHeight 线，一切都应该没问题。

# html - 如何在 HTML 和 CSS 中制作标尺

> ID：12117974
> 
> 赞同：8
> 
> 时间：2012-08-24T23:43:48.453
> 
> 标签：html, css, rulers

我想用 HTML 和 CSS 画一些像这样简单的东西：

`|_____|_____|_____|_____|`

每个垂直条下方都有对齐的数字，例如`0, 1, 2, 3, 4`等。

我还想以编程方式调整条之间的空间。有什么我可以效仿的例子吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-25T02:12:10.893

以下是一些[CSS 屏幕标尺](http://jsfiddle.net/thirdender/kwcug/)：-p 可能有更好/更奇特的方法来设置间距，但我提供了一个简单的示例，它循环并调整显着值。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-25T00:42:48.143

我尝试从不宣扬使用表格来处理非表格数据，但您可以使用表格来做到这一点：

```
<table width=100% style='font-family: monospace;'>
    <tr style='border-bottom: 1px solid #000;'>
        <td>
            |
        </td><td>
            |
        </td><td>
            |
        </td><td>
            |
        </td><td width=1%>
            |
        </td>
    </tr>
    <tr>
        <td>
            0
        </td><td>
            1
        </td><td>
            2
        </td><td>
            3
        </td><td>
            4
        </td>
    </tr>
</table> 
```

一个小提琴：http: [//jsfiddle.net/ZH7Lx/](http://jsfiddle.net/ZH7Lx/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-08-09T06:26:38.320

这是一个很好的例子：

```
<label>0</label>
<label>100</label>
<label>200</label>
       ... 
```

[https://codepen.io/cfenzo/pen/jEGQGm](https://codepen.io/cfenzo/pen/jEGQGm)

或另一个例子

[https://codepen.io/pbweb/pen/grQKEK](https://codepen.io/pbweb/pen/grQKEK)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-11-19T08:32:17.453

这是我在标尺中使用的解决方案。**仅限 HTML 和 CSS！**

笔记：

*   这是部分的，因为我不需要添加数字，只需添加刻度标记。也许我稍后会改进它并添加数字。您可以从这里自由构建它；
*   它适用于缩放，这对我来说非常有用，因为我在时间刻度上使用它作为小时标记之间的分钟标记。在这里，我只包括4个标记，但可以有很多。不要忘记您需要比元素少 1 个标记（例如 10 毫米为 9 个标记）
*   它包括一个标尺中心线。
*   没有用于标记的 Javascript 和 html 元素（如果您有一个在拖动或放大时自动生成的无限标尺，则很有用）

解决方案：创建一个标尺单元格，为标记添加背景图像（可以使用线性渐变），为每个标记添加设置百分比位置。这只能在您的 css 中完成一次，如果您使用相同的图像，则该文件将只有一个请求，此外，如果您使用线性渐变，则意味着根本没有额外的请求。由于您设置了百分比位置，因此您可以随意拉伸标尺，它仍然看起来不错。

如果在某些情况下（例如在移动设备屏幕上，或者当您拉伸标尺以放大），您可能希望在标尺点之间动态创建更多标记。在这种情况下，只需使用 javascript 将 .big 之类的新类分配给您的标尺单元格，并为该类设置一组不同的标记背景。他们会很好地切换。

此外，由于我们使用非伪元素——真实的 div、真实的背景——这种模块化的标尺方法让您可以使用 javascript 动态更改它。

代码：

```
.comment{color:darkgreen}
.container{
  resize:horizontal;
  overflow:auto;
  width:60%;
  min-width:100px;
  margin:0px auto;
  border:1px solid black;
  padding:20px;
}
.ruler{
  margin:20px 0px;
  background-color:rgb(255, 255, 223);
  height:20px;
  width:100%;
  display:flex;
  justify-content:center
}
.ruler-cell{
  position:relative;
  height:100%;
  width:calc(100% - 20px);
  border-left:1px solid black;
  border-right:1px solid black;
  background-repeat:no-repeat;
  background-size:
    100% 1px,
    1px 8px,
    1px 8px,
    1px 8px,
    1px 8px;
  background-position:
    0% center,
    20% center,
    40% center,
    60% center,
    80% center;
  background-image:
    linear-gradient(gray, gray),
    linear-gradient(gray, gray),
    linear-gradient(gray, gray),
    linear-gradient(gray, gray),
    linear-gradient(gray, gray);
}
.ruler-cell span{
  position:absolute;
  top:-15px;
  font-size:12px;
  text-align:center;
}
.zero{
  left:0;
  transform:translateX(-50%);
  display:none;
}
.number{
  right:0px;
  transform:translateX(50%);
}
.ruler-cell:first-child .zero{
  display:block;
}
```

```
<div class="container">
  <p class="comment">#this container is resizeable! Try to resize it!</p>
  <div class="ruler">
    <div class="ruler-cell">
      <span class="zero">0</span>
      <span class="number">1</span>
    </div>
  </div>
</div>
```

jsfiddle：[https ://jsfiddle.net/w423gLuf/](https://jsfiddle.net/w423gLuf/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-25T00:28:01.433

静态答案：

```
<pre>
|____|____|____|____|
0    1    2    3    4
</pre> 
```

为了能够更改它，请使用 JavaScript。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-06-15T11:14:54.653

看看这个：http: [//jsfiddle.net/thirdender/kwcug/](http://jsfiddle.net/thirdender/kwcug/)

```
<ul class="ruler"><li>1</li><li>2</li><li>3</li><li>4</li></ul>

<div>
    <ul class="ruler" data-items="10"></ul>
</div> 
```

看起来更花哨，可以轻松定制。

# c# - 创建一个列表 从基类

> ID：12117980
> 
> 赞同：0
> 
> 时间：2012-08-24T23:44:27.743
> 
> 标签：c#, generics, inheritance, instantiation

我有一个名为 SCO 的基类，它继承了许多类。我最初只是想对集合进行排序，但根据一些建议，听起来我可以用一种方法对集合进行实例化和排序。

我有这个所有基类都继承的构造函数：

```
public SCO(SPListItem item, List<Vote> votes)
{
    UpVotes = voteMeta.UpVotes;
    DownVotes = voteMeta.DownVotes;
    VoteTotal = UpVotes - DownVotes;
    HotScore = Calculation.HotScore(Convert.ToInt32(UpVotes), Convert.ToInt32(DownVotes), Convert.ToDateTime(item["Created"]));
} 
```

这就是我卡住的地方。我无法实例化`<T>`.

```
public static List<T> SortedCollection<T>(SPListItemCollection items, ListSortType sortType, List<Vote> votes) where T : SCO
{
    var returnlist = new List<T>();
    for (int i = 0; i < items.Count; i++) { returnlist.Add(new T(items[i], votes)); }
    switch (sortType)
    {
        // Sort List based on passed ENUM
    }
    return returnlist;
} 
```

如果我可以用一种方法完成所有这些，我就可以避免一些昂贵的铸造和拳击。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T23:49:20.590

泛型中唯一允许的约束是`new()`，它仅在存在不带任何参数的构造函数时才有效。

> 我有这个所有基类都继承的构造函数：

问题是这是不可*强制执行*的。子类可以（并且应该）自由定义自己的构造函数，只要它们链接到这个构造函数。子类可以自由使用实例化该类所需的任何构造机制。

[您可以通过反射和Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/wcxyzt4d)解决此问题，这将允许您使用参数构造对象。然而，这相当“丑陋”（尽管考虑到使用[new() 约束仍然调用 Activator.CreateInstance ，](http://msmvps.com/blogs/jon_skeet/archive/2011/08/22/optimization-and-generics-part-1-the-new-constraint.aspx)*这*并不丑陋）：

```
Type genericType = typeof(T);
for (int i = 0; i < items.Count; i++) 
{ 
     returnlist.Add((T)Activator.CreateInstance(genericType, new object[] {items[i], votes})); 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T23:52:30.010

这里缺少的是比您实例化`T`对象的方法更通用的东西：

```
new T(items[i], votes) 
```

编译器不能保证每个 type 都存在这个构造函数`T`。您*可以*做的是让函数接受一些工厂方法类型的附加参数`Func<SPListItem, IList<Vote>, T>`，以便可以重写上面的内容：

```
returnlist.Add(factory(items[i], votes)) 
```

或者，您可以改为实现一个工厂*类*，该类有效地包含代码中派生自 的每种类型的此实例化逻辑`SCO`，例如：

```
class SCOFactory
{
    public T Create<T>(SPListItem item, IList<Vote> votes) where T : SCO
    {
        // Do your instantiation here.
    }
} 
```

你经常看到这种情况（它通常被称为“工厂模式”）；它作为一种方法（通常是一个巨大的声明）可能有点丑陋`switch`，但至少它在一个地方包含了丑陋，并允许您编写诸如问题中的函数之类的函数，而无需添加另一个参数并最终弄乱一个你的项目中有很多代码。

一个普遍的警告（当然要持保留态度）：过度泛化您的代码最终会导致令人头疼的问题，而不会产生太多切实的好处。在继续之前先问问自己，以这种通用方式编写此代码是否真的对您有益；如果是这样，上述任何一个建议都可能是一个不错的起点。如果不是，请考虑采用一种更简单的方法，这种方法在理论上可能不太灵活，但在实践中更容易使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T00:03:43.410

你*需要*在构造函数中传递这些值吗？

您可以在类型上创建那些可设置的属性，然后调用默认构造函数，在创建对象后，只需在...之后设置属性

# jquery - 如果使用 Jquery 存在样式属性，如何添加类

> ID：12117985
> 
> 赞同：4
> 
> 时间：2012-08-24T23:44:43.740
> 
> 标签：jquery, css

我提到了这个页面，但我一定做错了：[jQuery check if element has specific attribute](https://stackoverflow.com/questions/2333802/jquery-check-if-element-have-specific-attribute)

基本上，如果图像具有 style="float:left" 属性，我想添加一个“img-left”类，如果 style="float:right;" 则添加“img-right”类 我的 HTML 如下所示：

```
<img class="content-img" style="float: left;" src="/images/my-img.jpg"> 
```

我希望它看起来像这样：

```
<img class="content-img img-left" style="float: left;" src="/images/my-img.jpg"> 
```

这是我尝试过的：

```
if ($('.content-img').css('float' == 'left')) {
    $(this).addClass('img-left');
}
else {
    $(this).addClass('img-right');
} 
```

这会产生一个 JS 错误，但我无法弄清楚原因。任何帮助将不胜感激。

谢谢，沃恩

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T23:47:00.343

我建议将其简化为以下内容：

```
$('.content-img').addClass(
    function(){
        var floated = $(this).css('float');
        return floated ? 'img-' + floated : '';
    }); 
```

[JS Fiddle 概念证明](http://jsfiddle.net/davidThomas/K8gLa/)。

这将检索`float`属性，如果已设置（具有真实值），则返回`img-`与变量值连接的字符串`floated`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-24T23:46:33.627

没错，但`if`条件中有一个错字。应该是这样的：

```
if ($('.content-img').css('float') == 'left') {
    $('.content-img').addClass('img-left');
} 
```

# c# - MVC4 WebSecurity - 如何修改 cookie 数据？

> ID：12117986
> 
> 赞同：1
> 
> 时间：2012-08-24T23:44:44.400
> 
> 标签：c#, asp.net, cookies, membership

MVC4 似乎有一个新的成员数据库，首先使用 EF 代码自动生成的表。

我正在尝试将我的 MVC3 应用程序迁移到这个新的成员数据库。 **我不知道在使用 WebSecurity 时如何更改 cookie 中的用户数据。** 我使用它来提供额外的权限数据，以便我的应用程序可以提供更细粒度的访问，而不必一直访问数据库，此外还可以使用不针对它的 cookie。

在 MVC3 中，我使用了 FormsAuthentication，在其中使用自定义数据设置了 FormsAuthentication cookie。 **下面是我想在 MVC4 中使用 WebSecurity 实现的示例。如何？**

```
// Get the access details from the database so we can place it into the cookie
TicketUserData tud = new AuthorizationTicketData().BuildTicketUserDataFromDatabase(userName);

// Create the auth cookie
FormsAuthenticationTicket ticket = new FormsAuthenticationTicket(
                                                    1,
                                                    userName,
                                                    System.DateTime.Now,
                                                    System.DateTime.Now.AddMinutes(30),
                                                    false,
                                                    tud.ToString(),
                                                    FormsAuthentication.FormsCookiePath);

// Encrypt the ticket to protect the data (this will look at the web.config forms settings)
string encTicket = FormsAuthentication.Encrypt(ticket);

// Create the cookie
HttpContext.Current.Response.Cookies.Add(new HttpCookie(FormsAuthentication.FormsCookieName, encTicket)); 
```

谢谢！