# StackOverflow 问答 000353000-000353999

# java - 信任库是否需要 sub-ca 证书？

> ID：353010
> 
> 赞同：11
> 
> 时间：2008-12-09T14:59:23.460
> 
> 标签：java, ssl, certificate, certificate-authority

我正在尝试设置分层 PKI。我可以创建一个仅包含根 ca 证书的信任库，这是否意味着我的应用程序信任由子 ca 证书签名的证书，而该子证书又由根 ca 签名？

顺便说一句，您似乎必须提供整个证书链，包括根 ca 证书。当然，如果根 ca 受信任，则不需要发送证书？我们只想检查下一个证书是否由它签名。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-09T23:01:23.533

信任库应该只包含根 CA，而不是中间 CA。

身份存储应包含私钥，每个私钥都与其证书链相关联，根除外。

很多很多应用程序都配置错误，并且在尝试识别自己时（例如，使用 SSL 进行身份验证的服务器），它们只发送自己的证书，并且缺少中间体。错误地将根作为链的一部分发送的情况较少，但这危害较小。大多数证书路径构建者会忽略它，并从其受信任的密钥库中找到根路径。

原始问题中的假设是正确的。

# .net - 跨库的 ApplicationSettings

> ID：353013
> 
> 赞同：0
> 
> 时间：2008-12-09T14:59:45.393
> 
> 标签：.net, application-settings

我正在尝试将所有数据库代码抽象到一个单独的库中，然后在我的所有代码中使用该库。所有的数据库连接都是使用类型化的 TableAdapter 完成的，我在 VS2005 中通过拖放数据集创建，使用来自 appSettings 的连接字符串。

我无法解决的问题是 .Net 不会将库 appSettings 传播到正在使用它的其他项目。

简而言之，我有一个数据库层库 MyProgram.DbLayer，它被 MyProgram.Client 等其他项目使用。当我在 .Client 中拥有所有数据集时，connectionString 位于 MyProgram.Client.exe.config 中，这样我可以在构建后更改它。当我将它移到 MyProgram.DbLayer 中时，该设置在我构建二进制文件后对我不可用。

编辑：这似乎是 ApplicationSettings 的一个更普遍的问题。

我注意到的是，如果我手动添加仅在库中使用的设置，它将被正确读取。我现在唯一需要的是将设置也自动包含在 .config 文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T15:14:26.100

AppSettings/ConnectionStrings 将始终从当前运行的应用程序池中读取。

我的意思是：

如果我有`A.exe`哪个有类`DAL.cs`。DAL.cs 从配置中读取连接字符串，并按`"abc"`预期返回。

然后我将 DAL.cs 移到它自己的项目中，从而移到它自己的程序集中。我仍然可以让它从 app.config 调用连接字符串，但是，**我需要在正在运行的应用程序中“托管”程序集，并将连接字符串添加到该应用程序 app config**。因此，我创建了一个新的 app.config 并在其中指定连接字符串`"xyz"`，当它运行时，它按预期运行。

现在，如果我将`A.exe`项目中的引用更改为使用 new `DAL.dll`，您认为它将具有什么连接字符串？`"xyz"`? 没有！它将`"abc"`像以前一样使用 ，因为它仍然在应用程序配置文件中为`A.exe`.

**我知道这是可行的，因为我在许多 Windows和**Web 应用程序中使用了共享 DAL 代码。

如果其中任何一个不清楚，或者对您的问题没有帮助，请通过评论此答案让我知道。

### 更新来自 OP 的以下评论

“主机”是指调用公共代码的应用程序。这可以是 Windows 或 Web 应用程序，基本上它是应用程序上下文。

您需要在配置文件中为使用公共代码的每个应用程序创建条目。如果我误解了您最初的问题（完全有可能，这是漫长的一天！）并且您也希望集中配置，那么您需要：

*   创建某种形式的集中式存储（无论是 XML、DB 等）。
*   增强您的通用代码以使其具有默认值，以使其能够连接到集中式存储。
*   然后，代码可以从那里根据配置存储中的信息进行自我配置。

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T15:22:29.717

如果我正确理解您的问题，听起来您需要

1.) 所有数据访问调用的通用应用程序上下文

或者

2.) 访问配置设置的不同方式

1：将数据层包装在在单个上下文（IIS、Windows 服务等）下运行的服务中

2：不要使用提供给您的配置管理机制。而是使用特定位置的属性文件。

不要忘记配置设置是从不同级别级联的。例如...如果您在 machine.config 中添加一个设置，那么在该计算机上运行的每个应用程序都将使用该设置，除非它被替换为较低级别...这可能是在您的内部设置标准化设置的好方法配置文件。

# sql-server-2005 - 将 SQL Server 日期时间字段转换为仅比较日期部分，并使用索引查找

> ID：353014
> 
> 赞同：28
> 
> 时间：2008-12-09T14:59:53.193
> 
> 标签：sql-server-2005, datetime

我一直在`convert(varchar,datefield,112)`对我在 SQL Server 的“介于”查询中使用的每个日期字段进行分析，以确保我只考虑日期，而不是基于日期时间字段的时间部分丢失任何日期。

现在，我听说转换是不可索引的，并且在 SQL Server 2005 中有更好的方法来比较查询中日期时间的日期部分，以确定日期是否在一个范围内。

做这样的事情的最佳、可索引的方法是什么：

```
select * from appointments
where appointmentDate>='08-01-2008' and appointmentDate<'08-15-2008' 
```

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-12-09T15:07:58.887

去除日期时间字段的时间部分的最佳方法是使用 datediff 和 dateadd 函数。

```
 DateAdd(day, datediff(day,0, MydateValue), 0) 
```

这利用了 SQL Server 将日期存储为两个整数这一事实的优势，一个表示自第“0”天 - （1900 年 1 月 1 日）以来的天数，第二个表示***刻度***数（每个刻度约为 3.33 ms ) 自午夜（时间）*。

上面的公式只需要读取第一个整数。无需转换或处理，因此速度非常快。

要使您的查询使用索引...首先在输入过滤参数上使用此公式，或者在表日期时间字段的等号的“另一”侧使用此公式，以便查询优化器不必运行计算在表中的每个日期时间字段上确定哪些行满足过滤谓词。这使您的搜索参数“支持 SARG”（搜索参数）

```
Where MyDateTimeColumn > DateAdd(day, 
      datediff(day,0, @MydateParameter), 0)    -- SARG-able 
```

而不是

```
Where DateAdd(day, datediff(day,0, 
      MyDateTimeColumn ), 0) > @MydateParameter -- Not SARG-able 
```

* 笔记。在内部，第二个整数（时间部分）存储刻度。一天有 24 x 60 X 60 X 300 = 25,920,000 个滴答声（偶然地刚好低于 32 位整数可以容纳的最大值）。但是，在对日期时间进行算术修改时，您无需担心这一点......当从日期时间中添加或减去值时，您可以将该值视为一个分数，就好像它完全等于一天的小数部分一样，就好像完整的日期时间值是一个浮点数，由表示日期的整数部分和表示时间的小数部分组成）。IE，

```
`Declare @Dt DateTime  Set @Dt = getdate()  
 Set @Dt = @Dt + 1.0/24  -- Adds one hour  
 Select @Dt  
 Set @Dt = @Dt - .25 -- Moves back 6 hours  
 Select @Dt` 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-09T15:11:36.667

将数字类型转换为字符串值（一种拳击）并不是执行您正在寻找的最佳执行方法。它并不是真正的可索引，因为实际的列类型是日期时间。

如果您正在寻找查询日期的最佳方式，那么您的示例是正确的，但您可能需要考虑 MSSQL 中 3 毫秒的精度差异。这可能意味着一天的记录可以显示在另一天的结果中。

这

```
select * from appointments where appointmentDate>='08-01-2008' and appointmentDate<'08-15-2008' 
```

应该是这个

```
select * from appointments where appointmentDate>='08-01-2008' and appointmentDate<='08-14-2008 23:59:59.996' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-09T15:06:38.267

这是正确的 - 进行转换将为查询的每一行执行转换。最好将日期列保留为日期，并将 where 子句作为日期传递：

```
select * from appointments where appointmentdate between 
'08/01/2008' AND '08/16/2008' 
```

注意：省略时间意味着午夜 (00:00.000)，因此您将包括 08/01 的所有时间，以及 08/15 的所有时间，以及恰好是 08/16/2008 00:00:00 的所有时间

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T15:10:27.010

让计算的持久列计算您需要的表达式。如果列被计算和持久化，它们也可以被索引。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-28T12:31:06.453

还有在[http://www.stillnetstudios.com/comparing-dates-without-times-in-sql-server/中描述的方式](http://www.stillnetstudios.com/comparing-dates-without-times-in-sql-server/)

```
SELECT CAST(FLOOR(CAST( getdate() AS float )) AS datetime) 
```

# .net - 使用 TableAdapter 调用 Oracle SP 非常慢

> ID：353019
> 
> 赞同：3
> 
> 时间：2008-12-09T15:00:56.890
> 
> 标签：.net, oracle, strongly-typed-dataset, tableadapter

我有一个在 sql 编辑器（oracle）中执行时运行速度超快的查询：1ms。

由 DataSet-TableAdapter 执行相同的查询（作为存储过程）需要 2 秒。我只是检索20行。

由于我使用的是 TableAdapter，因此返回值存储在 ref 游标中。

如果我要获取 2'000 行，我可以理解构建 DataSet 需要一些时间，但仅 20 行的 2 秒对我来说似乎太多了。

有更好的方法在 oracle 上执行 SP，或者这是唯一的方法？我可以尝试做些什么来提高性能？

谢谢你的帮助！

* * *

在 google 中搜索，似乎问题出在 refcursor 上。其他人面临同样的性能问题，但没有提供解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T11:28:25.493

您使用哪个数据提供商？

您是参考 System.Data.OracleClient 还是使用 odp.net（Oracle 用于将 .NET 应用程序与 Oracle 连接的数据提供程序）还是使用 devart（以前称为 corelab）提供程序。

我在 odp.net 与 Oracle 9 结合方面有很好的经验。您可以在 oracle 网站上免费下载 odp.net。请参阅：[http ://www.oracle.com/technology/tech/windows/odpnet/index.html](http://www.oracle.com/technology/tech/windows/odpnet/index.html)

您可以使用最新版本 (11.1.0.6.20) 连接到 Oracle 9 数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T15:43:27.663

使用 datareader 而不是 TableAdaptor 需要多长时间？我会尝试数据阅读器。我从未遇到过数据读取器的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T07:42:37.383

确保将 设置`CommandType`为`CommandType.StoredProcedure`。

例如（来自[MSDN](http://msdn.microsoft.com/en-us/library/ms971506.aspx)）：

```
OracleCommand cmd = new OracleCommand();
cmd.Connection = conn;
cmd.CommandText = "COUNT_JOB_HISTORY";
cmd.CommandType = CommandType.StoredProcedure; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T10:45:27.450

行。我发现了问题所在。

一开始我以为是DataProvided的问题，其实不是。我在 SQLServer 2000 中发现了同样的问题......

在谷歌搜索我发现了一些关于执行计划的信息。采用这种方式，我将查询性能提升了 50%。

问题的简要介绍是，当通过代码执行 SP 时，DBMS 的执行计划有一些问题，并且不使用索引......

更好的答案在这篇文章 [中：SQL Server 中的参数嗅探（或欺骗）](https://stackoverflow.com/questions/211355/parameter-sniffing-or-spoofing-in-sql-server)

我希望这能帮到您。

# sql - SQL - 临时表：将所有列存储在临时表中，而不是只存储主键

> ID：353020
> 
> 赞同：2
> 
> 时间：2008-12-09T15:01:07.263
> 
> 标签：sql, sql-server, sql-server-2005

我需要为分页目的创建一个临时表。我会将所有记录选择到临时表中，然后对其进行进一步处理。

我想知道以下哪个是更好的方法：

1）将我的主表的所有列选择到临时表中，然后能够选择我需要的行

或者

2）只选择主表的主键进入临时表，然后再加入主表？

使用方法 1 与方法 2 时是否有任何尺寸考虑？

[编辑]

我之所以问，是因为我会使用第一种方法，但是查看 ASP.NET 成员资格中包含的 PROCEDURE [dbo].[aspnet_Membership_FindUsersByName]，他们正在使用方法 2

[编辑2]

对于无法访问存储过程的人：

```
 -- Insert into our temp table
INSERT INTO #PageIndexForUsers (UserId)
    SELECT u.UserId
    FROM   dbo.aspnet_Users u, dbo.aspnet_Membership m
    WHERE  u.ApplicationId = @ApplicationId AND m.UserId = u.UserId AND u.LoweredUserName LIKE LOWER(@UserNameToMatch)
    ORDER BY u.UserName

SELECT  u.UserName, m.Email, m.PasswordQuestion, m.Comment, m.IsApproved,
        m.CreateDate,
        m.LastLoginDate,
        u.LastActivityDate,
        m.LastPasswordChangedDate,
        u.UserId, m.IsLockedOut,
        m.LastLockoutDate
FROM   dbo.aspnet_Membership m, dbo.aspnet_Users u, #PageIndexForUsers p
WHERE  u.UserId = p.UserId AND u.UserId = m.UserId AND
       p.IndexId >= @PageLowerBound AND p.IndexId <= @PageUpperBound
ORDER BY u.UserName 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T15:15:54.987

如果您的行数非常多（超过 100 行），那么表变量的性能通常会比等效的临时表差。但测试它以确保。

选项 2 将使用更少的资源，因为数据重复更少。

托尼关于这是一个肮脏的阅读的观点确实是你应该考虑的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T15:04:57.320

使用方法 1，临时表中的数据可能与真实数据不一致，即如果其他会话对真实数据进行了更改。如果您只是查看在某个时间点拍摄的数据的快照，这可能没问题，但如果您还根据对临时副本所做的更改来更新真实表，这将是危险的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T15:43:33.917

这正是我在服务器上用于分页的方法，

仅使用键值创建一个表变量（为什么会产生事务日志的开销？）。（使用自动编号标识列主键创建表 - 这将是 RowNum。）

根据用户排序/过滤标准将键插入表中。标识列现在是可用于分页的行号。

从表变量中选择连接到需要真实数据的其他表，加入键值，

```
Where RowNum Between ((PageNumber-1) * PageSize) + 1 And PageNumber * PageSize 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T20:49:14.317

这样想吧。假设您的查询将返回足够的记录来填充 1000 页。您认为有多少用户会真正查看所有这些页面？通过仅返回 ID，您不会返回很多您可能需要或不需要查看的信息。所以它应该节省网络和服务器资源。如果他们真的浏览了很多页面，那么数据细节可能确实需要刷新需要足够的时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-09T08:40:45.283

寻呼的替代方法（我公司的做法）是使用 CTE。

[从http://softscenario.blogspot.com/2007/11/sql-2005-server-side-paging-using-cte.html](http://softscenario.blogspot.com/2007/11/sql-2005-server-side-paging-using-cte.html)查看这个例子

```
CREATE PROC GetPagedEmployees (@NumbersOnPage INT=25,@PageNumb INT = 1)
AS BEGIN

WITH AllEmployees AS
(SELECT ROW_NUMBER() OVER (Order by [Person].[Contact].[LastName]) AS RowID,
[FirstName],[MiddleName],[LastName],[EmailAddress] FROM [Person].[Contact])

SELECT [FirstName],[MiddleName],[LastName],[EmailAddress]
FROM AllEmployees WHERE RowID BETWEEN
((@PageNumb - 1) * @NumbersOnPage) + 1 AND @PageNumb * NumbersOnPage
ORDER BY RowID 
```

# xml - MFC 存档到 xml

> ID：353024
> 
> 赞同：2
> 
> 时间：2008-12-09T15:02:14.843
> 
> 标签：xml, serialization, mfc

我们有一个使用 MFC 的 CArchive 的旧版应用程序。我正在研究将数据保存为 XML 与二进制。我查看了几个库，例如：

*   促进
*   [http://www.codeproject.com/KB/XML/xmlize.aspx](http://www.codeproject.com/KB/XML/xmlize.aspx)
*   [http://www.ucancode.net/faq/Visual-C-MFC-XML-Example.htm](http://www.ucancode.net/faq/Visual-C-MFC-XML-Example.htm)
*   [http://www.codeguru.com/cpp/data/data-misc/xml/article.php/c4567](http://www.codeguru.com/cpp/data/data-misc/xml/article.php/c4567)

它们很好，并且提供了许多超越 MFC 的 CArchive 的优势。

这项工作的主要目标（除了 XML 存储）是尽量减少对这个遗留应用程序的代码更改。对于这个项目，我不需要新的/改进的序列化功能，理想情况下，我可以将一些 CArchive 对象更改为 CXmlArchive，就像一缕橙烟一样，存储是 XML。

您知道满足上述要求的现有库吗？

# java - Java和C#中的尾调用？

> ID：353028
> 
> 赞同：1
> 
> 时间：2008-12-09T15:03:02.330
> 
> 标签：java, c#, clojure, tail-call

我正在阅读有关 Clojure 的内容，发现在当前版本中 Java 不支持尾调用的讨论，并且人们正在抛出异常来模拟 JVM 中的尾调用，无论如何听起来人们正在做一些疯狂的事情。所以这让我想知道 C# 的尾调用，同样的问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-09T15:12:12.780

CLR 代码在某些情况下会尾随调用，但在其他情况下不会——这取决于 JIT。

请参阅[David Broman 的博客条目](https://web.archive.org/web/20190114032303/https://blogs.msdn.microsoft.com/davbr/2007/06/20/tail-call-jit-conditions)和[Shri Borde 的](http://blogs.msdn.com/shrib/archive/2005/01/25/360370.aspx)博客条目。

C# 编译器当前不发出尾调用 IL，但有时 JIT 无论如何都会这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T15:30:52.743

在某些情况下，JVM 上可以进行尾递归。例如，Scala 要求基本尾递归的有效实现（请参阅此博客文章，查找[Language Trivia #8](http://www.willarson.com/blog/?p=15)，仅引用我现在能找到的）。有关于添加更多支持的讨论和研究，与 Invoke Dynamic 和其他专门用于非 Java 语言的特性一样。

[Java Posse](http://javaposse.com/)上也经常讨论这类问题。

是的，我知道这完全不是你问题的答案......

# c++ - _endthreadex(0) 挂起

> ID：353038
> 
> 赞同：2
> 
> 时间：2008-12-09T15:05:21.327
> 
> 标签：c++, multithreading

我有一些我最初没有创建的代码使用_beginthreadex 和_endthreadex。出于某种原因，当它调用 _endthreadex(0) 时，调用只是挂起并且永远不会返回。关于通常会导致此呼叫挂起的任何想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T20:10:28.747

我的回答为时已晚，但仍然有人会使用它。

就我而言，当我卸载 dll 并删除一些全局对象时，_endthreadex 挂起。其中一个全局对象内部有另一个线程，该线程也执行线程退出。这导致了死锁，因为 DLLMain 已经锁定了 crt 内存映射。阅读 DLLMain 帮助，发现在 DLLMain 调用期间不允许对其他线程或进程执行任何其他操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-09T15:14:17.567

_endthreadex 结束线程，所以它不能返回。这就是调用它的全部意义所在。

编辑：调用_endthreadex 有点不寻常，通常你只是让线程启动过程返回，运行时为你调用_endthreadex。在我们提供帮助之前，您可能需要再解释一下您想要做什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-09T15:54:22.680

您是否错误地调用[_endthreadex()](http://msdn.microsoft.com/en-us/library/hw264s73(VS.80).aspx)来尝试从主线程结束线程？

函数[_endthreadex()](http://msdn.microsoft.com/en-us/library/hw264s73(VS.80).aspx)旨在在要终止的线程内调用以报告返回值，并正确“恢复为线程分配的资源”。您不需要在主线程的析构函数中调用它。您可以在析构函数中通过事件（请参阅从主线程调用的[SetEvent](http://msdn.microsoft.com/en-us/library/ms686211(VS.85).aspx)）向线程发出信号，表明线程应尽快退出，然后作为最后一条语句退出的线程将调用[_endthreadex()](http://msdn.microsoft.com/en-us/library/hw264s73(VS.80).aspx) .

在主线程中调用[_endthreadex()](http://msdn.microsoft.com/en-us/library/hw264s73(VS.80).aspx)会导致进程挂起，因为您已经终止了主线程，但您仍然希望终止的原始线程仍在运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T15:18:21.287

好的....好吧，endthreadex通过“删除类实例”在我的类的解构函数中被调用......并且那个解构函数调用永远不会返回......所以整个事情都挂了

# c++ - 如何对图像进行高质量缩放？

> ID：353039
> 
> 赞同：18
> 
> 时间：2008-12-09T15:05:50.173
> 
> 标签：c++, c, image, image-manipulation, image-scaling

我正在编写一些代码来在 C/C++ 中缩放 32 位 RGBA 图像。我写了一些尝试，有些成功，但速度很慢，最重要的是，大小图像的质量是不可接受的。

我比较了由 OpenGL（即我的视频卡）和我的例程缩放的相同图像，它的质量相差甚远。我已经用 Google 代码搜索过所有我认为会有所启发的东西（SDL、Allegro、wxWidgets、CxImage、GD、ImageMagick 等）的源代码树，但通常它们的代码要么错综复杂，要么分散在各处，要么充满汇编程序和很少或没有评论。我还阅读了维基百科和其他地方的多篇文章，但我只是没有找到关于我需要什么的明确解释。我了解插值和采样的基本概念，但我正在努力使算法正确。我不想在一个例程中依赖外部库，并且必须转换为它们的图像格式并返回。此外，无论如何我想知道如何自己做。:)

我以前看过一个关于堆栈溢出的类似问题，但并没有真正以这种方式回答，但我希望有人可以帮助我朝着正确的方向前进。也许指向我一些文章或伪代码......任何可以帮助我学习和做的事情。

这就是我要找的东西：

1.  没有汇编程序（我正在为多种处理器类型编写非常便携的代码）。
2.  不依赖外部库。
3.  我主要关心的是缩小，但以后还需要编写一个放大例程。
4.  结果的质量和算法的清晰度是最重要的（我可以稍后对其进行优化）。

我的例程基本上采用以下形式：

```
DrawScaled(uint32 *src, uint32 *dst, 
      src_x, src_y, src_w, src_h, 
      dst_x, dst_y, dst_w, dst_h ); 
```

谢谢！

**更新：**为了澄清，我需要比框重采样更先进的东西来缩小图像，这会使图像过于模糊。我怀疑我想要的是某种双三次（或其他）滤波器，它有点与双三次放大算法相反（即每个目标像素都是从所有贡献的源像素中计算出来的，并结合一个保持清晰的加权算法。

## 例子

这是我从 wxWidgets BoxResample 算法得到的结果与我想要的 256x256 位图缩放到 55x55 的示例。

*   www.free_image_hosting.net/uploads/1a25434e0b.png

最后：

*   www.free_image_hosting.net/uploads/eec3065e2f.png

原始 256x256 图像

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T15:18:05.497

我发现 wxWidgets 实现相当简单，可以根据需要进行修改。都是 C++，所以那里的可移植性没有问题。唯一的区别是它们的实现适用于 unsigned char 数组（无论如何我发现这是处理图像的最简单方法），RGB 的字节顺序和单独的数组中的 alpha 分量。

如果您参考 wxWidgets 源代码树中的“src/common/image.cpp”文件，则有一个使用框采样方法“wxImage::ResampleBox”的下采样器函数和一个称为“wxImage::重新采样双三次”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T15:21:09.453

对图像进行重新采样的一种相当简单且体面的算法是[双三次插值](http://en.wikipedia.org/wiki/Bicubic_interpolation)，仅维基百科就拥有实现此功能所需的所有信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-09T18:00:02.300

OpenGL是否有可能在矢量域中进行缩放？如果是这样，任何基于像素的缩放都无法在质量上接近它。这是基于矢量的图像的一大优势。

双三次算法可以针对清晰度与伪影进行调整 - 我正在尝试找到一个链接，我会在我这样做时对其进行编辑。

编辑：这是我正在考虑的 Mitchell-Netravali 作品，在此链接的底部引用：

[http://www.cg.tuwien.ac.at/~theussl/DA/node11.html](http://www.cg.tuwien.ac.at/~theussl/DA/node11.html)

您也可以考虑将[Lanczos 重采样](http://en.wikipedia.org/wiki/Lanczos_resampling)作为双三次的替代方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-10T03:20:53.200

现在我看到了您的原始图像，我认为 OpenGL 正在使用最近邻算法。它不仅是调整大小的最简单方法，而且也是最快的。唯一的缺点是，如果您的原始图像中有任何细节，它看起来会非常粗糙。

这个想法是从原始图像中获取均匀间隔的样本；在您的情况下，256 个中有 55 个，或每 4.6545 个中有 1 个。只需将数字四舍五入即可选择像素。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-09T15:44:42.497

如果您想要一些准备好的东西而不仅仅是算法，请尝试使用**Adob​​e 通用图像库**( [http://opensource.adobe.com/wiki/display/gil/Downloads )。](http://opensource.adobe.com/wiki/display/gil/Downloads)

* * *

摘自： http: [//www.catenary.com/howto/enlarge.html#c](http://www.catenary.com/howto/enlarge.html#c)

放大或缩小 - C 源代码需要用于 32 位 Windows v 5.3 或更高版本的 Victor 图像处理库。

```
 int enlarge_or_reduce(imgdes *image1)
{
   imgdes timage;
   int dx, dy, rcode, pct = 83; // 83% percent of original size

   // Allocate space for the new image
   dx = (int)(((long)(image1->endx - image1->stx + 1)) * pct / 100);
   dy = (int)(((long)(image1->endy - image1->sty + 1)) * pct / 100);
   if((rcode = allocimage(&timage, dx, dy,
      image1->bmh->biBitCount)) == NO_ERROR) {
      // Resize Image into timage
      if((rcode = resizeex(image1, &timage, 1)) == NO_ERROR) {
         // Success, free source image
         freeimage(image1);
         // Assign timage to image1
         copyimgdes(&timage, image1);
         }
      else // Error in resizing image, release timage memory
         freeimage(&timage);
      }
   return(rcode);
} 
```

此示例调整图像区域的大小并用新图像替换原始图像。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-09T16:12:16.183

我们心爱的主持人的一篇通用文章：[更好的图像调整](http://blog.codinghorror.com/better-image-resizing/)，讨论各种算法的相对质量（并链接到另一篇 CodeProject 文章）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-09T16:33:58.357

英特尔拥有 IPP 库，可提供针对英特尔系列处理器优化的高速插值算法。它非常好，但它不是免费的。看看下面的链接：

[英特尔 IPP](http://www.intel.com/cd/software/products/asmo-na/eng/302910.htm)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-09T19:41:03.033

听起来您真正难以理解的是正确重新采样图像所涉及的离散->连续->离散流。[Alvy Ray Smith 的A Pixel Is *Not* A Little Square](http://alvyray.com/Memos/CG/Microsoft/6_pixel.pdf)是一份很好的技术报告，可以帮助您深入了解您需要的内容。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-09T17:57:35.957

看看[ImageMagick](http://www.imagemagick.org)，它执行各种重新缩放过滤器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-09T20:07:28.817

作为后续，Jeremy Rudd 在上面发布了[这篇文章](http://www.codeproject.com/KB/GDI-plus/imgresizoutperfgdiplus.aspx)。它实现了过滤后的两遍调整大小。源代码是 C#，但它看起来很清楚，我可以移植它来试一试。昨天我发现非常相似的 C 代码更难理解（非常糟糕的变量名）。我把它搞定了，但它很慢，没有产生好的结果，这让我相信我的适应有错误。以此作为参考，我可能会更幸运地从头开始编写它，我会尝试的。

但是考虑到两遍算法的工作原理，我想知道是否没有更快的方法来做到这一点，甚至可能一次通过？

# sql - SQL 查询（排序依据）

> ID：353040
> 
> 赞同：1
> 
> 时间：2008-12-09T15:05:52.823
> 
> 标签：sql, sorting

我想列出（排序列表）我的表/关系客户中名为 streetNames 的属性中的所有条目。例如。我想实现以下顺序：

Street_1A
Street_1B
Street_2A
Street_2B
Street_12A
Street_12B

streetNames 的简单顺序将进行词法比较，然后 Street_12A 和 B 将出现在 Street_2A/B 之前，这是不正确的。是否可以通过纯 SQL 来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T15:10:08.323

通过 udf_getStreetNumber(street_name) 从 tablex 订单中选择 street_name

在您的 udf_getStreetNumber 中 - 编写您的业务规则以剥离数字

编辑

我认为您现在可以在 SQL Server 中使用正则表达式功能。我只是从输入中删除所有非数字字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T16:11:29.290

记录一下：它被称为**Natural Sort Order**，主题中有一篇[Coding 恐怖文章](https://blog.codinghorror.com/sorting-for-humans-natural-sort-order/) 。

我想您可以使用此处显示的一些代码在 SQL 中执行此操作，但始终会根据具体情况进行处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T15:15:30.247

我相信您可以通过将 streetName 字段拆分为不同的部分，例如 substr(streetName, 1, find(" ",streetName)) 仅用于街道等。但这将非常混乱，它必须处理各种特殊情况（没有门牌号，没有添加的门牌号）或国际问题（在美国，地址通常像 1 街）。

但是如果你想按照你描述的排序并且这是一个重要的要求，最好将你的街道名称建模为三个部分，即街道（例如“街道”）、房屋编号（例如 1、2、12）、房屋编号添加（例如“A”、“B”）。然后排序在 SQL 中变得微不足道。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T15:27:56.307

如果您对数据库具有写访问权限，我真的建议您将其全部转换为使用 3 个单独的字段，然后适当地使用它们。这样你甚至可以在 PHP 中完成（是的，这需要一些时间，但只会发生一次）。如果你有一个大的代码库，这可能会有些痛苦，必须检查这个表的所有查询，但它最终会在以后得到回报。例如，它将使按地址搜索更容易。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-09T15:13:55.943

是的，这是可能的！但绝对没有兴趣！如果你发现有人在这里准备花几个小时写下来并测试将你的 streetNames 拆分为 streetName + streetNumber 组合的 SP，请告诉我他的名字：我将向他提交一些我认为必须付费才能获得的问题完成的工作。

顺便说一句，您不能将您的数据分成 2 个字段，一个只有街道名称的“streetName”和一个新的“buildingNumber”字段吗？（避免将其命名为“streetNumber”，因为在某些国家/城市，街道被赋予了数字）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-09T15:35:22.873

如果 streetNames 列中的所有值都遵循模式 StreetName-space - StreetNumber

其中 StreetName 可以包含其他空格，但 StreetNumber 不能，那么这将起作用：

```
Declare @T Table (streetName VarChar(50))
Insert @T(streetName) Values('Street 1A')
Insert @T(streetName) Values('Street 2A')
Insert @T(streetName) Values('Street 2B')
Insert @T(streetName) Values('Street 12A')
Insert @T(streetName) Values('Another Street 1A')
Insert @T(streetName) Values('Another Street 4A')
Insert @T(streetName) Values('a third Street 12B')
Insert @T(streetName) Values('a third Street 1C')

Select * From @T 
Order By Substring(StreetName, 0, 1 + len(StreetName) - charIndex(' ', reverse(StreetName))),
       Cast(Substring(StreetName, 2 + len(StreetName) - charIndex(' ', reverse(StreetName)),  
        Case When IsNumeric(Substring(StreetName, 2 + len(StreetName) - charIndex(' ', reverse(StreetName)), 5)) = 1  Then 5
             When IsNumeric(Substring(StreetName, 2 + len(StreetName) - charIndex(' ', reverse(StreetName)), 4)) = 1  Then 4
             When IsNumeric(Substring(StreetName, 2 + len(StreetName) - charIndex(' ', reverse(StreetName)), 3)) = 1  Then 3
             When IsNumeric(Substring(StreetName, 2 + len(StreetName) - charIndex(' ', reverse(StreetName)), 2)) = 1  Then 2
             When IsNumeric(Substring(StreetName, 2 + len(StreetName) - charIndex(' ', reverse(StreetName)), 1)) = 1  Then 1
                End) as Integer),
        Substring(StreetName, len(StreetName) - charIndex(' ', reverse(StreetName)) +
            Case When IsNumeric(Substring(StreetName, 2 + len(StreetName) - charIndex(' ', reverse(StreetName)), 5)) = 1  Then 5
             When IsNumeric(Substring(StreetName, 2 + len(StreetName) - charIndex(' ', reverse(StreetName)), 4)) = 1  Then 6
             When IsNumeric(Substring(StreetName, 2 + len(StreetName) - charIndex(' ', reverse(StreetName)), 3)) = 1  Then 5
             When IsNumeric(Substring(StreetName, 2 + len(StreetName) - charIndex(' ', reverse(StreetName)), 2)) = 1  Then 4
             When IsNumeric(Substring(StreetName, 2 + len(StreetName) - charIndex(' ', reverse(StreetName)), 1)) = 1  Then 3
                End, Len(StreetName)) 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-12-09T15:29:34.337

做到这一点的可靠方法（在“正确排序数据”而不是“解决一般问题”方面是可靠的）是将数据拆分为街道名称和门牌号码，并自行对它们进行排序。但这需要知道门牌号从哪里开始。这是棘手的部分 - 使假设最适合您的数据。

您应该使用以下内容来重构您的数据，并从现在开始将门牌号存储在一个单独的字段中。在对大型数据集进行排序时，所有这些字符串杂耍都不会表现得很好。

假设它是街道名称中的最后一件事，并且它包含一个数字：

```
DECLARE @test TABLE
(
  street VARCHAR(100)
)

INSERT INTO @test (street) VALUES('Street')
INSERT INTO @test (street) VALUES('Street 1A')
INSERT INTO @test (street) VALUES('Street1 12B')
INSERT INTO @test (street) VALUES('Street 22A')
INSERT INTO @test (street) VALUES('Street1 200B-8a')
INSERT INTO @test (street) VALUES('')
INSERT INTO @test (street) VALUES(NULL)

SELECT
  street,
  CASE 
    WHEN LEN(street) > 0 AND CHARINDEX(' ', REVERSE(street)) > 0
    THEN CASE
      WHEN RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1) LIKE '%[0-9]%'
      THEN LEFT(street, LEN(street) - CHARINDEX(' ', REVERSE(street)))
    END
  END street_part,
  CASE 
    WHEN LEN(street) > 0 AND CHARINDEX(' ', REVERSE(street)) > 0
    THEN CASE 
      WHEN RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1) LIKE '%[0-9]%'
      THEN RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1)
    END
  END house_part,
  CASE 
    WHEN LEN(street) > 0 AND CHARINDEX(' ', REVERSE(street)) > 0
    THEN CASE 
      WHEN RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1) LIKE '%[0-9]%'
      THEN CASE
        WHEN PATINDEX('%[a-z]%', LOWER(RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1))) > 0
        THEN CONVERT(INT, LEFT(RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1), PATINDEX('%[^0-9]%', LOWER(RIGHT(street, CHARINDEX(' ', REVERSE(street)) - 1))) - 1))
      END
    END
  END house_part_num
FROM
  @test 
ORDER BY
  street_part,
  house_part_num,
  house_part 
```

这假设以下条件：

*   街道地址*可以*有门牌号
*   门牌号*必须*是街道地址中的最后一件事（不是“525 Monroe Av.”）
*   门牌号*应*以数字开头，以便正确排序
*   门牌号*可以*是一个范围（“200-205”），这将排序在 200 以下
*   门牌号*不得*包含空格或识别失败（当您查看数据时，您可以应用诸如`REPLACE(street, ' - ', '-')`预先清理常见模式之类的东西。）
*   整个事情仍然是一个近似值，肯定会偏离电话簿中的样子，例如

# .net - 如何让 GridView 控件在更新面板内使用回传进行分页？

> ID：353071
> 
> 赞同：0
> 
> 时间：2008-12-09T15:14:25.350
> 
> 标签：.net, asp.net, gridview, ajaxcontroltoolkit

我有一个 GridView 控件，其他功能必须在更新面板内。该站点正在使用 Ajax 控件工具包，并且 Grid 上的“EnableSortingAndPagingCallbacks”属性设置为 false。但是，当我执行分页调用时，它仍然是作为回调而不是回发。如何解决此问题并让寻呼调用作为回发触发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T17:04:22.460

You can specify in the triggers collection of the update panel to create a trigger for your gridview that is a full postback instead of asynchronous. This is especially useful when there are some update panels inside others that you might only want to update at certain times but not others. You can also change the code-behind to tell it when to do the update.

# c# - WCF 中的超时异常

> ID：353078
> 
> 赞同：0
> 
> 时间：2008-12-09T15:17:01.337
> 
> 标签：c#, .net, wcf

修改 WCF 服务时遇到问题。

原来的服务方法是这样的：

```
[OperationContract(IsOneWay = true, IsInitiating = true, IsTerminating = false)]
void Login(string userName, string password); 
```

这种方法有效。

问题是，当我将其更改为：

```
[OperationContract(IsOneWay = false, IsInitiating = true, IsTerminating = false)]
bool Login(string userName, string password); 
```

它停止工作并超时。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T16:51:14.000

Does tracing on the service show any exceptions? I've run into problems where a client will time out after running into some type of contract based issue within the service.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T17:13:24.143

After modifying the web service did you update the client proxy ([svcutil.exe](http://msdn.microsoft.com/en-us/library/aa347733.aspx))?

# linux - 从 QTreeWidgetItem 继承的类中获取数据

> ID：353082
> 
> 赞同：1
> 
> 时间：2008-12-09T15:17:52.877
> 
> 标签：linux, qt, kde, treewidget

我有一个继承自 QTreeWidgetItem 的类，我拦截了点击事件。

当我单击树行时，我需要从 MY QTreeWidgetItem 中获取另一个对象，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T15:51:26.773

您创建并添加项目：

```
newItem = new QTreeWidgetItem(myExplorer); 
```

设置数据：

```
newItem->setData(myListWidgetItem::idType, 1234); 
```

并且有一个插槽可以接受单击的项目（在树上），您可以从以下位置读取数据：

```
connect( myExplorer, SIGNAL( itemClicked (QTreeWidgetItem *, int) ), this, SLOT( slotFillListWidget(QTreeWidgetItem *, int) ) ); 
```

# jquery - jQuery，改变图像

> ID：353093
> 
> 赞同：1
> 
> 时间：2008-12-09T15:21:17.800
> 
> 标签：jquery

我知道我可以使用 $('#myId').load('aPage.html'); 要将页面加载到元素中，我该如何使用它来更改图像？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-09T15:23:10.887

```
$("selectorforyourimage").attr("src","newimagelocation"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T18:03:16.880

请注意，图像将在加载之前加载，因此您可能需要**预加载**它。

为此，您可以使用[此插件](http://plugins.jquery.com/project/Preload)或[此迷你插件](http://www.mattfarina.com/2007/02/01/preloading_images_with_jquery)

# javafx - JavaFX 1.0 发布。你觉得呢？你有没有什么想法？

> ID：353097
> 
> 赞同：6
> 
> 时间：2008-12-09T15:22:35.160
> 
> 标签：javafx

**[JavaFX 1.0](http://www.javafx.com/)**于 12 月 4 日星期四发布。

作为开发人员，您如何看待 JavaFX？在您的工作场所，您是否有任何计划推进基于 JavaFX 的应用程序或网站？您有学习 JavaFX 的近期计划吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T15:48:56.527

JavaFX 是唯一开放的 RIA 平台，所以我相信它迟早会赶上竞争对手。

1.0版本看起来还不错。演示有据可查，并提供了我需要的一切。

当然也有一些问题。Java 小程序似乎有所改进，但仍然落后。加载时间长，CPU 负载高。它没有显示任何进展，就像通常的 Flash 应用程序一样，所以用户无法确定他的互联网是否很慢，小程序很大还是 java 很慢。我还必须接受证书，在某些演示中甚至不止一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T15:42:28.337

我当然认为值得一看，因为看起来 RIA 会继续存在，而且平台/选择越多越好。尽管考虑到 Micrsoft 在与 Siliverlight 的比赛中迟到并且仍然领先于 Sun，但 Sun 肯定落后了。如果不出意外，我想看看 Sun 在实施与 Adob​​e 和 Microsoft 时有何不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T15:58:36.587

还有一件事要学，我想学，我没时间学。

看起来很有希望，但我同意其他人的观点。这是一场艰苦的战斗，我怀疑它是否会在长期内占上风。Java FX 的优点之一是它可以延长我对 Java 语言的职业投资。

它还可能会鼓励更多的 RIA 平台出现在 JVM 上——因此，虽然 Java 可能会衰落，但 JVM 可以继续存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T15:54:35.783

我喜欢 JavaFX 的概念，但还没有机会用它做任何事情。我通常不做互联网应用程序，所以我必须竭尽全力尝试最新的平台。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-09T15:25:45.483

据我所知，JavaFX 的面目全非。我查看了演示和示例源代码，并没有留下深刻的印象。JavaFX 与已经存在一段时间的 Adob​​e 和 Silverlight 竞争是一场艰苦的战斗。请注意，我是一名长期的 Java 开发人员。

# jquery - IE中的jQuery淡入淡出效果

> ID：353100
> 
> 赞同：4
> 
> 时间：2008-12-09T15:23:14.847
> 
> 标签：jquery, cross-browser

下面的[fadeIn](http://docs.jquery.com/Effects/fadeIn)，[fadeOut](http://docs.jquery.com/Effects/fadeOut)效果在 Firefox 3.0 中工作正常，但在 IE 7 中不起作用……这是什么原因，有什么诀窍？这个想法当然是为了获得“眨眼”效果并将用户的注意力吸引到表格中的特定行。

```
function highLightErrorsAndWarnings() {
            $(".status-error").fadeIn(100).fadeOut(300).fadeIn(300).fadeOut(300).fadeIn(300).fadeOut(300).fadeIn(300);
            $(".status-warning").fadeIn(100).fadeOut(300).fadeIn(300).fadeOut(300).fadeIn(300).fadeOut(300).fadeIn(300);
        } 
```

**更新：**发现愚蠢的问题......“.status-error”指向一个tr元素。可以在 Firefox 的 tr 上设置背景颜色并将其淡化，但在 IE 中则不行。将“CSS 指针”更改为“.status-error ***td*** ”使其指向 tr 下方的 td，并且在所有浏览器中一切正常。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-09T16:59:31.160

Weird.. couldn't tell you why you're getting that problem, but maybe try the pulsate effect plugin? [http://docs.jquery.com/UI/Effects/Pulsate](http://docs.jquery.com/UI/Effects/Pulsate)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-31T04:20:33.680

好吧，我已经尝试了各种方法来解决这个问题。我使用的`down and dirty`方法是检测文本上的背景和前景色，然后`div/span/etc`用颜色变化来制作动画。

此片段将“脉动”文本一次（您可以通过以下方式创建一个执行更多次的函数：

```
$.fn.crossBrowserPulsate = function() {
    var startColor = $(this).css("background-color");
    var endColor = $(this).css("color");

    $(this).animate({color:startColor},500,
     function() {
      $(this).animate({color:endColor},500,
       ...
      )}
    );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-24T17:16:30.597

我有类似的问题，但由于各种原因我无法选择 td。

如果您也受到影响，您可以尝试使用 show 而不是 fadeIn。由于我使用的是类似损坏的 fadeTo，所以这对我也没有帮助:(

这里打开了一个 jQuery 错误 - [http://dev.jquery.com/ticket/5451](http://dev.jquery.com/ticket/5451)

如果您受到影响，请在门票上发表评论。

# sql-server - 引用标识符打开？

> ID：353105
> 
> 赞同：0
> 
> 时间：2008-12-09T15:24:25.547
> 
> 标签：sql-server, quoted-identifier

我们的一个程序出错了，因为存储过程是“使用 QUOTED_IDENTIFIER 选项创建的”。这是 Microsoft SQL Server (8)。

昨天发生的一切是：存储过程被编辑。创建了一个表。

我已删除编辑。我已经删除了表。错误仍在出现。

是否有查询（或其他东西），所以我可以找出导致问题的存储过程？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T15:31:50.573

运行分析器并捕获错误事件和 SP:Starting 和 SP:Completed 事件

# fxcop - 从 FxCop 代码分析中排除完整的命名空间？

> ID：353110
> 
> 赞同：23
> 
> 时间：2008-12-09T15:26:28.680
> 
> 标签：fxcop

是否可以从所有 FxCop 分析中排除完整的命名空间，同时仍使用`SuppressMessageAttribute`?

在我目前的情况下，我有一堆由 LINQ to SQL 生成的类，它们会导致很多 FxCop 问题，显然，我不会修改所有这些以匹配 FxCop 标准，因为如果我这样做，很多这些修改都会消失重新生成类。

我知道 FxCop 有一个项目选项来禁止对生成的代码进行分析，但它似乎无法将 LINQ 2 SQL 创建的实体和上下文类识别为生成的代码。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-09-01T14:32:41.107

如果您使用该`[GeneratedCode]`属性标记您的类，则可以将 /ignoregeneratedcode 标志与 FxCop 一起使用，如此 MSDN 帖子中所述：

[常见问题解答：如何防止 FxCop 对生成的代码发出警告](http://blogs.msdn.com/b/codeanalysis/archive/2008/02/28/faq-how-do-i-prevent-fxcop-1-36-from-firing-warnings-against-generated-code.aspx)

您可能必须添加一个新代码文件并在那里实现新的部分类以将属性添加到类中：

```
[GeneratedCode]
public partial class MainDataContext { } 
```

只需确保在创建新文件时将所有内容添加到正确的命名空间即可。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-09-01T14:32:07.267

在类中添加一个[`[GeneratedCode] attribute`](http://msdn.microsoft.com/en-us/library/system.codedom.compiler.generatedcodeattribute.aspx)。
**编辑**：我的意思是部分具有相同名称的类，正如另一个答案所解释的那样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T15:34:54.263

使用生成的代码属性，这是代码分析团队关于该主题的[博客文章](http://blogs.msdn.com/fxcop/archive/2007/04/27/correct-usage-of-the-compilergeneratedattribute-and-the-generatedcodeattribute.aspx)。

这在命名空间的顶部应该可以解决问题：

```
[GeneratedCodeAttribute("Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator", "9.0.0.0")] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-08T21:33:50.500

```
<Assembly: SuppressMessage("Microsoft.Design", _
    "CA1020:AvoidNamespacesWithFewTypes", _
    Scope:="namespace", _
    Target:="Missico.IO")> 
```

将语句放在`GlobalSuppressions.vb`项目的根目录中。

我所拥有的只是 VB 示例。

# asp.net - 经典的 ASP 错误捕获 - 可以直接使用 ASP.Net 页面来完成吗？

> ID：353125
> 
> 赞同：2
> 
> 时间：2008-12-09T15:29:51.607
> 
> 标签：asp.net, iis, asp-classic, vbscript, error-handling

是否有可能在 ASP.Net 中捕获 ASP 错误（在 IIS 中设置自定义错误页面）并以某种方式访问​​ Err oject 或类似的东西，就像您在 VBScript 中使用 server.GetLastError() 一样？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T16:36:42.970

据我所知，不是直接的，但是您可以拥有一个经典的 asp 错误页面，将您需要的 err 对象值加载到不同的字段中。然后您可以重定向到一个 asp.net 页面，该页面将可以访问这些字段。

# c# - C# - 一个列表中的多个泛型类型

> ID：353126
> 
> 赞同：168
> 
> 时间：2008-12-09T15:29:58.143
> 
> 标签：c#, generics

这可能是不可能的，但我有这个类：

```
public class Metadata<DataType> where DataType : struct
{
    private DataType mDataType;
} 
```

还有更多，但让我们保持简单。泛型类型（DataType）被 where 语句限制为值类型。我想要做的是列出这些不同类型的元数据对象（DataType）。如：

```
List<Metadata> metadataObjects;
metadataObjects.Add(new Metadata<int>());
metadataObjects.Add(new Metadata<bool>());
metadataObjects.Add(new Metadata<double>()); 
```

这甚至可能吗？

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2008-12-09T15:31:56.953

```
public abstract class Metadata
{
}

// extend abstract Metadata class
public class Metadata<DataType> : Metadata where DataType : struct
{
    private DataType mDataType;
} 
```

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2008-12-09T15:41:16.683

按照leppie的回答，为什么不做`MetaData`一个界面：

```
public interface IMetaData { }

public class Metadata<DataType> : IMetaData where DataType : struct
{
    private DataType mDataType;
} 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2008-12-09T16:14:38.817

我还使用了非通用版本，使用`new`关键字：

```
public interface IMetadata
{
    Type DataType { get; }

    object Data { get; }
}

public interface IMetadata<TData> : IMetadata
{
    new TData Data { get; }
} 
```

显式接口实现用于允许两个`Data`成员：

```
public class Metadata<TData> : IMetadata<TData>
{
    public Metadata(TData data)
    {
       Data = data;
    }

    public Type DataType
    {
        get { return typeof(TData); }
    }

    object IMetadata.Data
    {
        get { return Data; }
    }

    public TData Data { get; private set; }
} 
```

您可以派生针对值类型的版本：

```
public interface IValueTypeMetadata : IMetadata
{

}

public interface IValueTypeMetadata<TData> : IMetadata<TData>, IValueTypeMetadata where TData : struct
{

}

public class ValueTypeMetadata<TData> : Metadata<TData>, IValueTypeMetadata<TData> where TData : struct
{
    public ValueTypeMetadata(TData data) : base(data)
    {}
} 
```

这可以扩展到任何类型的通用约束。

# vb.net - 在 VB.NET 中将变量名存储在字符串中

> ID：353131
> 
> 赞同：3
> 
> 时间：2008-12-09T15:31:12.600
> 
> 标签：vb.net, string, variables

我正在尝试将一些变量的名称存储在字符串中。例如：

```
Dim Foo1 as Integer
Dim Foo1Name as String

' -- Do something to set Foo1Name to the name of the other variable --

MessageBox.Show(Foo1Name & " is the variable you are looking for.")
' Outputs:
' Foo1 is the variable you are looking for. 
```

这将有助于我正在进行的一些调试。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-09T15:36:49.627

好吧，您显然可以设置 Foo1Name = "Foo1" - 但我强烈怀疑这不是您所追求的。

你怎么知道你试图找到哪个变量的名字？更大的图景是什么？如果我们谈论的是非局部变量，你想要的*可能通过反射实现，但我怀疑它要么**不可行*，要么首先有更好的方法来解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T15:44:28.363

[这个](http://msdn.microsoft.com/en-us/library/system.reflection.localvariableinfo.aspx)来自 msdn 的示例使用反射有帮助吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T15:45:12.010

一种解决方案是使用关联数组来存储变量。曾经，我在 .Net 中做过这个，但我想我写了一个自定义类来做这个。

```
myArray("foo1Name") = "foo1" 
```

然后，您可以只存储变量名称列表，或者您可以将其包装在同一个类中。

```
if( myArray(variableName(x)) == whatImLookingFor ) print variableName(x) & "is it" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T15:55:13.817

我认为这实际上取决于您要调试的内容。两个可能的东西是[Reflection](http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace(VS.71).aspx)和[StackTrace](http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace(VS.71).aspx)类。也就是说，当您的程序被编译时，编译器和运行时不保证这些名称需要与原始程序一致。

调试与发布版本的情况尤其如此。调试版本中的 .PDB 文件（符号）的重点是包含有关原始程序的更多信息。对于本机 C/C++ 应用程序，强烈建议您为应用程序的每个构建（调试+发布）生成符号以帮助调试。在 .NET 中，这不是一个问题，因为有反射之类的功能。IIRC [John Robbins](https://rads.stackoverflow.com/amzn/click/com/0735615365)建议您也始终为 .NET 项目生成符号。

您可能还会发现 Mike Stall 的[博客和](http://blogs.msdn.com/jmstall/)[托管调试器](http://www.microsoft.com/downloads/details.aspx?familyid=38449A42-6B7A-4E28-80CE-C55645AB1310&displaylang=en)示例很有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-09T15:46:30.200

要查找变量名，请参阅：[查找传递给函数的变量名](https://stackoverflow.com/questions/72121/finding-the-variable-name-passed-to-a-function-in-c)

这也适用于 VB.Net。

# c# - 如何检查 NOT NULL 约束是否存在

> ID：353132
> 
> 赞同：2
> 
> 时间：2008-12-09T15:31:17.110
> 
> 标签：c#, sql-server

我正在通过 C# 代码修改 SQL 表，如果存在 NOT NULL 约束，我需要删除它。如何首先检查它是否存在？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-09T15:37:34.740

```
select is_nullable 
from   sys.columns
where  object_id = OBJECT_ID('tablename')  
and    name = 'columnname'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T15:37:57.017

那么，你可以检查`syscolumns.isnullable`标志？或者最近：

```
COLUMNPROPERTY(@tableId, 'ColumnName', 'AllowsNull') 
```

其中@tableId 是 OBJECT_ID('TableName')

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T15:40:34.890

执行这条 SQL 语句：

```
select * from information_schema.columns c
inner join information_schema.tables t on c.table_catalog = t.table_catalog and t.table_schema = c.table_schema and t.table_name = c.table_name
where c.table_name = 'Categories' and c.Is_nullable = 'NO' 
```

然后执行删除“not null”约束的 ALTER 语句

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T15:35:06.697

我不确定您的业务规则，所以我可能是错的，但是您提出的建议听起来是个坏主意。

如果 NOT NULL 约束不应该存在，则将其从数据库中删除。如果它应该存在，请围绕它进行编程。

如果您确实需要实现 DDL 来更改表，我会编写一个存储过程来执行并从 C# 调用存储过程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-09T15:40:23.503

您可以使用[COLUMNPROPERTY](http://msdn.microsoft.com/en-us/library/ms174968.aspx)：

SELECT COLUMNPROPERTY（OBJECT_ID（'schemaName.TableName'），'ColumnName'，'AllowsNull'）

# c# - 如何使用 sqlmetal 生成内部（非公共）数据上下文

> ID：353142
> 
> 赞同：4
> 
> 时间：2008-12-09T15:34:23.563
> 
> 标签：c#, linq-to-sql, sql-server-2008, dbml, sqlmetal

我想使用 sqlmetal 为我的项目生成 dbml 数据上下文，但是创建的数据上下文和所有类都标记为`public`. 由于这应该是一个 API 层，我想将其中许多类或至少将上下文本身标记为`internal`. 有没有办法在 sqlmetal 或其他工具中执行此操作，而无需手动编辑 dbml？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T15:45:03.727

我相信这是您无法直接在命令行中执行的选项之一。您可能确实需要编辑 dbml。但是，这不是一个棘手的更改，因此您应该能够使用基本的命令行工具将其自动化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T06:00:45.840

您可以尝试使用我的[LINQ to SQL 模板](http://damieng.com/blog/2008/09/14/linq-to-sql-template-for-visual-studio-2008)，该模板为您可以完全自定义的 DBML 到 C#/VB.NET 代码生成过程提供了替代品。

[]亚眠

# .net - 无法从 COM 添加引用

> ID：353143
> 
> 赞同：0
> 
> 时间：2008-12-09T15:34:24.403
> 
> 标签：.net, excel, com-interop

我无法从我的窗口/程序集目录中选择 Microsoft.Office.Interop.Excel。我可以看到有一个，但它没有让我选择引用它。我该如何选择它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T15:44:08.177

查看 COM 选项卡并搜索 Microsoft Excel 12.0 / 11.0 对象库。

添加此 COM 引用将使您的项目使用应该已安装到 GAC 的 Excel 的主要互操作程序集。

只需确保选择正确的版本，Excel 2003 为 11.0，Excel 2007 为 12.0。

# python - 使 Python 默认为安装在共享主机上的另一个版本

> ID：353148
> 
> 赞同：1
> 
> 时间：2008-12-09T15:35:15.883
> 
> 标签：python, linux

我在共享主机上，无法将符号链接更改为 Python2.4，默认为 2.3。我尝试在我将处理到 2.4 的 Director 中创建一个符号链接，但似乎 /usr/bin/python 下的“全局”python 解释器占主导地位，除非我将它作为 ./python 运行。有什么替代方法可以覆盖这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T15:47:16.220

如果您在 shell 中工作，则可以按照建议创建符号链接并更新 .profile 中的路径。这在上一篇文章中有描述。

如果这些是您仅在共享主机上运行的 CGI/任何脚本，您可以更改脚本顶部的 shebang 行，该行告诉系统运行脚本的解释器。

即改变

```
#!/usr/bin/env python 
```

到

```
#!/whatever/the/path/to/your/version/python 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T15:37:31.747

创建一个符号链接并将路径添加到 PATH 变量：

```
ln -s /usr/bin/python2.4 $HOME/bin/python
export PATH="$HOME/bin:$PATH" 
```

# python - 如何在 Python 中处理很长的字符串？

> ID：353152
> 
> 赞同：5
> 
> 时间：2008-12-09T15:35:58.847
> 
> 标签：python

我正在解决项目 euler 的[问题 220](http://projecteuler.net/index.php?section=problems&id=220)（看起来很容易，与其他一些问题相比 - 我想我会尝试一个更高编号的来改变！）

到目前为止，我有：

```
D = "Fa"

def iterate(D,num):
    for i in range (0,num):
        D = D.replace("a","A")
        D = D.replace("b","B")
        D = D.replace("A","aRbFR")
        D = D.replace("B","LFaLb")
    return D

instructions = iterate("Fa",50)

print instructions 
```

现在，这适用于低值，但是当你把它重复得更高时，你只会得到一个“内存错误”。任何人都可以建议一种方法来克服这个问题吗？我真的想要一个包含下一步说明的字符串/文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T15:57:07.120

诀窍在于注意在每次迭代中运行字符串时出现的模式。尝试评估`iterate(D,n)`1 到 10 之间的 n，看看你是否能发现它们。还要通过一个计算结束位置和步数的函数来输入字符串，并在那里寻找模式。

然后，您可以使用这些知识将算法简化为根本不使用这些字符串的算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T15:51:50.687

如果您考虑在 D(0)、D(1) 等中有多少个“a”和“b”字符，您会发现字符串很快变得非常长。计算 D(50) 中有多少个字符，然后再考虑将这么多数据存储在哪里。我将其设为 4.5*10^15 个字符，即 4500 TB，每个字符一个字节。

想想看，你不必计算 - 问题告诉你至少有 10^12 个步骤，这是一个 TB 的数据，每个字符一个字节，或者如果你使用技巧来降低数据的四分之一每个字符 2 位。我认为这会导致我可以访问的任何类型的存储介质的一分钟时间限制出现问题:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-09T17:42:22.820

Python 字符串不会成为这个问题的答案。字符串存储为不可变数组，因此每个替换都会在内存中创建一个全新的字符串。更不用说，10^12 步后的指令集如果将它们存储为字符（并且进行一些小的压缩），其大小将至少为 1TB。

理想情况下，应该有一种方法可以在数学上（提示，有）即时生成答案，这样您就不需要存储序列。

只需使用字符串作为指导来确定创建路径的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T15:56:53.673

由于您无法实现字符串，因此您必须生成它。如果你产生单个字符而不是返回整个字符串，你可能会让它工作。

```
def repl220( string ):
    for c in string:
        if c == 'a': yield "aRbFR"
        elif c == 'b': yield "LFaLb"
        else yield c 
```

类似的东西会在不创建新字符串的情况下进行替换。

现在，当然，您需要递归调用它，并达到适当的深度。所以，每个收益不仅仅是一个收益，它是一个更复杂的东西。

尽量不为你解决这个问题，所以我会留在那里。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-08T20:02:58.743

就像警告一样，在使用 replace() 函数时要小心。如果您的字符串非常大（在我的情况下约为 5e6 个字符），则替换函数将返回字符串的子集（大约 4e6 个字符）而不会引发任何错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-09T16:40:18.250

您可以将 D 视为字节流文件。

就像是：-

种子文件=打开（'D1.txt'，'w'）；seedfile.write("发"); 种子文件.close(); n = 0 而 (n

警告完全未经测试

# windows - 如何从命令行测试服务是否正在运行

> ID：353161
> 
> 赞同：65
> 
> 时间：2008-12-09T15:37:37.800
> 
> 标签：windows, batch-file

我希望能够从 Windows 批处理文件中查询服务是否正在运行。我知道我可以使用：

> sc 查询“服务名称”

但是，这会输出一些文本。我真正想要的是它设置`errorlevel`环境变量，以便我可以对此采取行动。

你知道我可以做到这一点的简单方法吗？

**更新**
感谢到目前为止的答案。我担心解析文本的解决方案可能无法在非英语操作系统上运行。有没有人知道解决这个问题的方法，或者我将不得不硬着头皮写一个控制台程序来解决这个问题。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2008-12-09T15:46:14.910

```
sc query "ServiceName" | find "RUNNING" 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-03-23T14:22:24.213

让我们回到 Windows 上批处理编程的老派

```
net start | find "Service Name" 
```

这将在任何地方工作......

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-09T15:48:15.937

如果您不介意将 net 命令与 grep 结合使用，则可以使用以下脚本。

```
@echo off
net start | grep -x "Service"
if %ERRORLEVEL% == 2 goto trouble
if %ERRORLEVEL% == 1 goto stopped
if %ERRORLEVEL% == 0 goto started
echo unknown status
goto end
:trouble
echo trouble
goto end
:started
echo started
goto end
:stopped
echo stopped
goto end
:end 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-28T19:05:08.227

您可以将 wmic 与[/locale](http://technet.microsoft.com/en-us/library/cc787035.aspx)选项一起使用

```
call wmic /locale:ms_409 service where (name="wsearch") get state /value | findstr State=Running
if %ErrorLevel% EQU 0 (
    echo Running
) else (
    echo Not running
) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-07-20T20:48:57.557

在这里跳出框框思考一下，我将建议 powershell 可能是最新 XP/2003 机器上的答案，当然也适用于 Vista/2008 和更新版本（而不是 .bat/.cmd）。任何有一些 Perl 背景的人都应该很快感到宾至如归。

```
 $serviceName = "ServiceName";
$serviceStatus = (get-service "$serviceName").Status;

if ($serviceStatus -eq "Running") {
    echo "Service is Running";
}
else {
    #Could be Stopped, Stopping, Paused, or even Starting...
    echo "Service is $serviceStatus";
} 
```

另一种方法是，如果您对批处理进行了大量投资，则将 PS 脚本作为单行运行，返回退出代码。

```
 @ECHO off
SET PS=powershell -nologo -command
%PS% "& {if((get-service SvcName).Status -eq 'Running'){exit 1}}"

ECHO.%ERRORLEVEL% 
```

作为单线运行也可以绕过默认的 PS 代码签名策略，但会以混乱为代价。要将 PS 命令放在 .ps1 文件中并像`powershell myCode.ps1`您可能会发现签署您的 powershell 脚本一样运行以自动方式运行它们（取决于您的环境）。有关详细信息，请参阅[http://www.hanselman.com/blog/SigningPowerShellScripts.aspx](http://www.hanselman.com/blog/SigningPowerShellScripts.aspx)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-12-23T02:42:33.653

```
@ECHO OFF
REM testing at cmd : sc query "MSSQLSERVER" | findstr RUNNING
REM "MSSQLSERVER" is the name of Service for sample
sc query "MSSQLSERVER" %1 | findstr RUNNING
if %ERRORLEVEL% == 2 goto trouble
if %ERRORLEVEL% == 1 goto stopped
if %ERRORLEVEL% == 0 goto started
echo unknown status
goto end
:trouble
echo Oh noooo.. trouble mas bro
goto end
:started
echo "SQL Server (MSSQLSERVER)" is started
goto end
:stopped
echo "SQL Server (MSSQLSERVER)" is stopped
echo Starting service
net start "MSSQLSERVER"
goto end
:erro
echo Error please check your command.. mas bro 
goto end

:end 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-12-14T20:27:28.580

我会建议 `WMIC Service WHERE "Name = 'SericeName'" GET Started`

或`WMIC Service WHERE "Name = 'ServiceName'" GET ProcessId`（如果服务未启动，ProcessId 将为零）

您可以根据前者返回“TRUE”还是后者返回非零来设置错误级别

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-09T15:47:25.597

尝试

```
sc query state= all 
```

获取服务列表以及它们是否正在运行。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-09T15:48:23.753

我发现了这个：

```
 sc query "ServiceName" | findstr RUNNING 
```

似乎做了大致正确的事情。但是，我担心这不足以在非英语操作系统上工作。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-12-01T05:08:22.247

```
sc 查询“服务名称”| 查找状态
```

例如：

```
sc 查询 "wuauserv" | 查找状态
```

报告 Windows 更新服务正在做什么、运行/暂停等。
这也适用于 Windows 10。稍后谢谢我。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-08-04T09:07:16.777

如果您使用的是 Powershell，只需添加到列表中。

```
sc.exe query "ServiceName" | findstr RUNNING 
```

下面的命令不起作用，因为`sc`它是 Powershell 中 Set-Content 的别名。

```
sc query "ServiceName" | findstr RUNNING 
```

`find`由于我不知道的某种原因，它也不适用于 Powershell。

```
sc.exe query "ServiceName" | find RUNNING 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-12-05T18:53:17.823

```
SERVICO.BAT
@echo off
echo Servico: %1
if "%1"=="" goto erro
sc query %1 | findstr RUNNING
if %ERRORLEVEL% == 2 goto trouble
if %ERRORLEVEL% == 1 goto stopped
if %ERRORLEVEL% == 0 goto started
echo unknown status
goto end
:trouble
echo trouble
goto end
:started
echo started
goto end
:stopped
echo stopped
goto end
:erro
echo sintaxe: servico NOMESERVICO
goto end

:end 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-12-18T08:02:02.387

将[Cygwin](https://www.cygwin.com/) Bash 用于：

```
sc query "SomeService" |grep -qo RUNNING && echo "SomeService is running." || echo "SomeService is not running!" 
```

（确保你`sc.exe`的路径中有。）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-02-13T05:45:16.600

`find`我注意到在使用基于/`findstr`的答案时没有人提到使用正则表达式。对于类似命名的服务，这可能是有问题的。

假设您有两个服务，`CDPUserSvc`并且`CDPUserSvc_54530`

到目前为止，如果您在此处使用大多数基于`find`/的答案，则仅在运行时`findstr`您会得到查询的误报。`CDPUserSvc``CDPUserSvc_54530`

`/r`和`/c`开关可以帮助我们处理该`findstr`用例，以及指示行尾的特殊字符，`$`

此查询只会验证`CDPUserSvc`服务的运行情况而忽略`CDPUserSvc_54530`

`sc query|findstr /r /c:"CDPUserSvc$"`

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2021-11-01T15:52:33.810

我已经从上面创建了一个，但会显示该服务是否首先安装，然后获取它是否正在运行。

```
sc query "YourService" | find /i "failed" 2>&1>nul && echo.'YourService Not Installed' || (sc query "YourService"| find /i "running" 2>&1>nul && echo.Yes || echo.No) 
```

# asp.net - 在 ASP.NET 中将虚拟路径转换为实际 Web 路径

> ID：353165
> 
> 赞同：35
> 
> 时间：2008-12-09T15:38:26.707
> 
> 标签：asp.net

我有一个虚拟路径（例如：“~/Images/Banner.jpg”），我想将其设为绝对 Web 路径（例如：“/ApplicationRoot/Images/Banner.jpg”）。有一种方法可以做到这一点，我相信一个名为 HTTPUtility 或类似名称的类。虽然每次我需要这种方法，我都需要几个小时才能找到它。如果有人可以发布正确的方法来执行此操作，我们将不胜感激，这样我就可以收藏它以便将来轻松访问。

非常感谢你。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-12-09T15:43:57.613

```
System.Web.VirtualPathUtility.ToAbsolute("yourRelativePath"); 
```

你去吧:)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-09-09T00:39:42.597

ASP.NET 中有多种方法可以用来解析绝对 URL 的相对路径 -

1) Request.ApplicationPath
2) System.Web.VirtualPathUtility
3) Page.ResolveUrl
4) Page.ResolveClientUrl

这是一篇文章，解释了在 ASP.NET 中解析路径的各种方法之间的区别 -

[在 ASP.NET 中解析 URL 的不同方法](http://refactoringaspnet.blogspot.com/2009/09/different-approaches-for-resolving-urls.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-09T15:44:05.117

```
Control.ResolveClientUrl(url) 
```

或者

```
Control.ResolveUrl(url) 
```

无论您需要哪一个（老实说，我不知道有什么区别，因为两者似乎都返回大致相同，也许有人可以照亮我:)）。

# c++ - 如何找到调用函数的名称？

> ID：353180
> 
> 赞同：52
> 
> 时间：2008-12-09T15:43:06.133
> 
> 标签：c++, debugging

我一直在使用 PRETTY_FUNCTION 来输出当前函数名，但是我重新实现了一些函数，并想找出哪些函数正在调用它们。

在 C++ 中，如何获取调用例程的函数名？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-12-18T15:22:21.183

这是您可以经常使用的解决方案。它的优点是不需要更改实际的函数代码（*无需添加对 stackwalk 函数的调用、更改参数以传入函数名称或链接到额外的库。*）。为了让它工作，你只需要使用一些预处理器魔法：

## 简单示例

```
// orignal function name was 'FunctionName'
void FunctionNameReal(...)
{
  // Do Something
}

#undef FunctionName
#define FunctionName printf("Calling FunctionName from %s\n",__FUNCTION__);FunctionNameReal 
```

您必须暂时重命名您的函数，但请参阅下面的注释以获取更多建议。这将导致在`printf()`调用函数的每个点都有一个语句。*显然，如果您正在调用成员函数，或者需要捕获返回值（例如将函数调用传递给* `__FUNCTION__` *返回相同类型的自定义函数......* ） ，您必须做出一些安排，但基本技术是相同的。根据您拥有的编译器，您可能想要使用`__LINE__`and或其他一些预处理器宏。`__FILE__`（此示例专门针对 MS VC++，但可能适用于其他示例。）

此外，您可能希望在标头中放置类似这样的内容，由`#ifdef`守卫包围以有条件地打开它，这也可以为您重命名实际功能。

# 更新 [2012-06-21]

我收到了扩展答案的请求。事实证明，我上面的例子有点简单。以下是一些使用 C++ 处理此问题的完整编译示例。

## 带返回值的完整源代码示例

使用`class`with`operator()`使这非常简单。第一种技术适用于有和没有返回值的独立函数。 `operator()`只需要反映与相关函数相同的返回值，并具有匹配的参数。

您可以将其编译`g++ -o test test.cpp`为非报告版本和`g++ -o test test.cpp -DREPORT`显示调用者信息的版本。

```
#include <iostream>

int FunctionName(int one, int two)
{
  static int calls=0;
  return (++calls+one)*two;
}

#ifdef REPORT
  // class to capture the caller and print it.  
  class Reporter
  {
    public:
      Reporter(std::string Caller, std::string File, int Line)
        : caller_(Caller)
        , file_(File)
        , line_(Line)
      {}

      int operator()(int one, int two)
      {
        std::cout
          << "Reporter: FunctionName() is being called by "
          << caller_ << "() in " << file_ << ":" << line_ << std::endl;
        // can use the original name here, as it is still defined
        return FunctionName(one,two);
      }
    private:
      std::string   caller_;
      std::string   file_;
      int           line_;

  };

// remove the symbol for the function, then define a new version that instead
// creates a stack temporary instance of Reporter initialized with the caller
#  undef FunctionName
#  define FunctionName Reporter(__FUNCTION__,__FILE__,__LINE__)
#endif

void Caller1()
{
  int val = FunctionName(7,9);  // <-- works for captured return value
  std::cout << "Mystery Function got " << val << std::endl;
}

void Caller2()
{
  // Works for inline as well.
  std::cout << "Mystery Function got " << FunctionName(11,13) << std::endl;
}

int main(int argc, char** argv)
{
  Caller1();
  Caller2();
  return 0;
} 
```

*样本输出（报告）*

```
Reporter: FunctionName() is being called by Caller1() in test.cpp:44
Mystery Function got 72
Reporter: FunctionName() is being called by Caller2() in test.cpp:51
Mystery Function got 169 
```

基本上，在任何`FunctionName`发生的地方，它都会将其替换为`Reporter(__FUNCTION__,__FILE__,__LINE__)`，其净效果是预处理器编写一些对象实例化并立即调用该`operator()`函数。您可以使用 . 查看预处理器替换的结果（在 gcc 中）`g++ -E -DREPORT test.cpp`。Caller2() 变成这样：

```
void Caller2()
{
  std::cout << "Mystery Function got " << Reporter(__FUNCTION__,"test.cpp",51)(11,13) << std::endl;
} 
```

您可以看到`__LINE__`并`__FILE__`已被替换。（老实说，我不确定为什么`__FUNCTION__`仍然在输出中显示，但编译后的版本报告了正确的功能，所以它可能与多通道预处理或 gcc 错误有关。）

## 具有类成员函数的完整源代码示例

这有点复杂，但与前面的示例非常相似。我们不仅替换了对函数的调用，还替换了类。

与上面的示例一样，您可以将其编译`g++ -o test test.cpp`为非报告版本和`g++ -o test test.cpp -DREPORT`显示调用者信息的版本。

```
#include <iostream>

class ClassName
{
  public:
    explicit ClassName(int Member)
      : member_(Member)
      {}

    int FunctionName(int one, int two)
    {
      return (++member_+one)*two;
    }

  private:
    int member_;
};

#ifdef REPORT
  // class to capture the caller and print it.  
  class ClassNameDecorator
  {
    public:
      ClassNameDecorator( int Member)
        : className_(Member)
      {}

      ClassNameDecorator& FunctionName(std::string Caller, std::string File, int Line)
      {
        std::cout
          << "Reporter: ClassName::FunctionName() is being called by "
          << Caller << "() in " << File << ":" << Line << std::endl;
        return *this;
      }
      int operator()(int one, int two)
      {
        return className_.FunctionName(one,two);
      }
    private:
      ClassName className_;
  };

// remove the symbol for the function, then define a new version that instead
// creates a stack temporary instance of ClassNameDecorator.
// FunctionName is then replaced with a version that takes the caller information
// and uses Method Chaining to allow operator() to be invoked with the original
// parameters.
#  undef ClassName
#  define ClassName ClassNameDecorator
#  undef FunctionName
#  define FunctionName FunctionName(__FUNCTION__,__FILE__,__LINE__)
#endif

void Caller1()
{
  ClassName foo(21);
  int val = foo.FunctionName(7,9);  // <-- works for captured return value
  std::cout << "Mystery Function got " << val << std::endl;
}

void Caller2()
{
  ClassName foo(42);
  // Works for inline as well.
  std::cout << "Mystery Function got " << foo.FunctionName(11,13) << std::endl;
}

int main(int argc, char** argv)
{
  Caller1();
  Caller2();
  return 0;
} 
```

这是示例输出：

```
Reporter: ClassName::FunctionName() is being called by Caller1() in test.cpp:56
Mystery Function got 261
Reporter: ClassName::FunctionName() is being called by Caller2() in test.cpp:64
Mystery Function got 702 
```

这个版本的亮点是一个装饰原始类的类，以及一个返回对类实例的引用的替换函数，允许`operator()`执行实际的函数调用。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-12-09T15:50:59.097

这里有两个选项：

1.  [您可以使用带有GNU 回溯功能](http://www.gnu.org/software/libc/manual/html_node/Backtraces.html)的最新版本的 glibc 获得完整的堆栈跟踪（包括调用函数的名称、模块和偏移量）。有关详细信息，请参阅[我的答案](https://stackoverflow.com/questions/77005/how-to-generate-a-stacktrace-when-my-gcc-c-app-crashes/77336#77336)。这可能是最简单的事情。

2.  如果这不是您想要的，那么您可能会尝试[libunwind](http://www.hpl.hp.com/research/linux/libunwind/)，但这将涉及更多工作。

请记住，这不是您可以静态知道的（与 PRETTY_FUNCTION 一样）；您实际上必须遍历堆栈才能找出调用您的函数。所以这不是在普通的调试 printfs 中真正值得做的事情。但是，如果您想进行更认真的调试或分析，那么这可能对您有用。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2017-05-15T02:30:44.633

对于 GCC 版本 ≥ 4.8，您可以使用`__builtin_FUNCTION`（不要混淆`__FUNCTION__`和类似）它似乎有点晦涩难懂。

例子：

```
#include <cstdio>

void foobar(const char* str = __builtin_FUNCTION()){
    std::printf("called by %s\n", str);
}

int main(){
    foobar();
    return 0;
} 
```

输出：

```
called by main 
```

[WandBox 上的示例](https://wandbox.org/permlink/fXtTuwQN8RDMVW7r)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-21T17:48:02.333

除非问题比您明确提出的要多，否则只需重命名函数并让编译器/链接器告诉您调用它的位置。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-11-17T16:13:42.177

[亚伦](https://stackoverflow.com/users/28950)答案的变化。我不确定这个答案是否有这个问题，但是当你做 a 时`#define function`，它变成了一个全局变量，那么，如果你的项目有几个具有相同成员类函数名的类，所有类的函数名都会重新定义为相同功能。

```
#include <iostream>

struct ClassName {
    int member;
    ClassName(int member) : member(member) { }

    int secretFunctionName(
              int one, int two, const char* caller, const char* file, int line) 
    {
        std::cout << "Reporter: ClassName::function_name() is being called by "
                << caller << "() in " << file << ":" << line << std::endl;

        return (++member+one)*two;
    }
};

#define unique_global_function_name(first, second) \
        secretFunctionName(first, second, __FUNCTION__,__FILE__,__LINE__)

void caller1() {
    ClassName foo(21);
    int val = foo.unique_global_function_name(7, 9);
    std::cout << "Mystery Function got " << val << std::endl;
}

void caller2() {
    ClassName foo(42);
    int val = foo.unique_global_function_name(11, 13);
    std::cout << "Mystery Function got " << val << std::endl;
}

int main(int argc, char** argv) {
    caller1();
    caller2();
    return 0;
} 
```

结果：

```
Reporter: ClassName::function_name() is being called by caller1() in D:\test.cpp:26
Mystery Function got 261
Reporter: ClassName::function_name() is being called by caller2() in D:\test.cpp:33
Mystery Function got 702 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-09T15:54:41.947

您可能想要所有可能调用它们的函数的名称。这基本上是调用图中的一组边。[doxygen](http://www.doxygen.nl/manual/diagrams.html)可以生成调用图，然后只需查看函数节点的传入边缘即可。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-09T16:18:55.610

在第一个近似值中，只需 grep 函数名称的代码库。然后是 Doxygen，然后是动态日志（其他人都讨论过）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-05-22T00:34:23.390

您可以使用此代码来跟踪程序中最后 n 个点的控制位点。用法：见下面的主要功能。

```
// What: Track last few lines in loci of control, gpl/moshahmed_at_gmail
// Test: gcc -Wall -g -lm -std=c11 track.c
#include <stdio.h>
#include <string.h>

#define _DEBUG
#ifdef _DEBUG
#define lsize 255 /* const int lsize=255; -- C++ */
struct locs {
  int   line[lsize];
  char *file[lsize];
  char *func[lsize];
  int  cur; /* cur=0; C++ */
} locs;

#define track do {\
      locs.line[locs.cur]=__LINE__ ;\
      locs.file[locs.cur]=(char*)__FILE__ ;\
      locs.func[locs.cur]=(char*) __builtin_FUNCTION() /* __PRETTY_FUNCTION__ -- C++ */ ;\
      locs.cur=(locs.cur+1) % lsize;\
  } while(0);

void track_start(){
  memset(&locs,0, sizeof locs);
}

void track_print(){
  int i, k;
  for (i=0; i<lsize; i++){
    k = (locs.cur+i) % lsize;
    if (locs.file[k]){
      fprintf(stderr,"%d: %s:%d %s\n",
        k, locs.file[k],
        locs.line[k], locs.func[k]);
    }
  }
}
#else
#define track       do {} while(0)
#define track_start() (void)0
#define track_print() (void)0
#endif

// Sample usage.
void bar(){ track ; }
void foo(){ track ; bar(); }

int main(){
  int k;
  track_start();
  for (k=0;k<2;k++)
    foo();
  track;
  track_print();
  return 0;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-04-19T02:25:19.617

结合[__builtin_return_address](https://gcc.gnu.org/onlinedocs/gcc/Return-Address.html)和[dladdr](https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man3/dladdr.3.html)在 C++、C、Objective-C 和 Objective-C++ 中工作：

```
#include <dlfcn.h> 
```

```
Dl_info info;
if (dladdr(__builtin_return_address(0), &info)) {
    printf("%s called by %s", __builtin_FUNCTION(), info.dli_sname);
} 
```

请注意，`dladdr`需要一个动态链接的程序：要动态链接您的程序，您可能需要添加`-rdynamic`或`-Wl,--export-dynamic`作为选项（[source](https://stackoverflow.com/q/11731229/1033581)）。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2019-07-23T14:17:17.703

**Cflow**可用于获取用 C/C++ 编写的源代码的调用图。你可以解析这个调用图来得到你想要的。

# asp.net - 有没有办法在不破坏 ASP.Net 回发的情况下修改查询字符串？

> ID：353187
> 
> 赞同：1
> 
> 时间：2008-12-09T15:44:23.307
> 
> 标签：asp.net, javascript, jquery, html, asp.net-2.0

从这里和网上阅读，我接近假设答案是“不”，但是......

假设我有一个有时具有查询字符串参数的 ASP.Net 页面。如果页面有查询字符串参数，我想在回发之前、期间或之后将其剥离。该页面已经有很多客户端脚本（纯 JavaScript 和 jQuery）。

例如，假设我加载：

```
http://myPage.aspx?QS=ABC 
```

QS 参数是控制页面首次加载时显示的内容所必需的，并且由“调用”它的页面设置。`myPage.aspx`具有需要填写的表单元素，并具有执行回发的提交按钮。当页面完成回发时，我需要返回的 URL 为：

```
http://myPage.aspx 
```

为了避免出现查询字符串时调用的客户端代码。换句话说，在提交之后，我不希望触发与查询字符串参数关联的客户端操作。我知道我可以将表单内容作为查询字符串参数本身附加到 URL，然后重定向到新 URL 并避免提交/回发，但这需要对代码隐藏进行更多类型检查，以避免错误数据和随意欺骗。我想我也可以在代码隐藏中设置一个隐藏字段，并与查询字符串一起查看它，以在我从回发回来时取消客户端行为，但这仍然使查询字符串基本上永远完好无损，我想要在初始页面加载后摆脱它。

有什么想法或最佳实践吗？

PS - 我可以用不会破坏回发行为的 Form.Action 属性做些什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T16:42:46.873

我会使用[**HTTPModule**](http://msdn.microsoft.com/en-us/library/ms972974.aspx)来拦截和重写 URL 和查询。我不是 100%，但我不相信这对视图状态有任何影响。

这听起来（看起来）很复杂，但实际上它相当微不足道，并且可以进行大量的改进和扩展（通常按照 .NET）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T15:47:34.130

这可能是不好的做法，但在这些情况下（我只需要“重置”页面），我只需执行 Response.Redirect 到同一页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T16:34:46.123

我不确定这是您要查找的内容，但如果理解正确，您可以这样做：

-在页面加载时检查 QS 值，如果不存在，则使用隐藏的输入字段。

- 首次使用 QS 加载页面时，进行正常处理并将 QS 值存储在隐藏的输入字段中。

- 如果没有 QS 则使用隐藏的输入值

- 回发后，您可以重定向到同一页面，此时您可以使用 Request.Form[] 来检索隐藏的输入字段，仍然可以正确加载数据但摆脱 QS。

它在我的脑海中是有道理的，我现在不确定它是否有道理，但我会让你决定。

# c# - 如何在实体框架中用枚举替换 Int 属性？

> ID：353190
> 
> 赞同：11
> 
> 时间：2008-12-09T15:44:46.053
> 
> 标签：c#, .net, entity-framework

我有一个实体类，它的属性具有数据类型 Int 的基础 db 列，但实际上我希望这个属性是一个枚举。有没有办法指定这个属性返回一个枚举？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-09T15:46:06.597

间接的，像[这样](http://weblogs.asp.net/alexeyzakharov/archive/2008/09/18/enum-in-ado-net-entity-framework-v1.aspx)。

就个人而言，我将 storage int 保留为公共的（例如 as `DbFoo`，其中 enum 属性是`Foo`） - 这样我仍然可以针对列编写 lambdas 以在数据库中执行，例如：

```
where row.DbFoo == SomeConstant 
```

如果您不公开存储值，则无法干净地执行此操作。您同样可以将其保留在内部，并在上下文中使用一些方法来进行过滤......这是我今天早些时候写的一个：

```
public IOrderedQueryable<User> Administrators
{
    get { return Users.Where(x => x.DbUserType == User.UserTypeAdmin)
             .OrderBy(x => x.Name);
} 
```

`User.UserTypeAdmin`我的内部常数在哪里。在这种情况下，我不能使用可区分的子类，因为它会干扰 ADO.NET 数据服务。

# testing - 测试命令行工具的最佳方法？

> ID：353198
> 
> 赞同：25
> 
> 时间：2008-12-09T15:46:50.637
> 
> 标签：testing, command-line, automation

我们有大量我们自己编写并经常使用的命令行实用程序。目前，测试它们非常麻烦，因此，我们没有做尽可能多的测试。

我想知道是否有人可以提出好的技术或工具来做好这类事情。

这是 UNIX。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-10T02:36:41.290

我建议对命令行工具的代码进行结构化，以便命令行实用程序成为函数和/或类库的客户端。

不要简单地使用 std::cout 来打印输出，而是让库函数采用默认为 std::cout 的 ostream 引用。在测试时，提供一个 std::stringstream 来收集输出。

最后，只需使用您最喜欢的单元测试框架将您的实用程序的输出与预期结果进行比较。

（我为 C++ 的具体示例道歉......我确信也有其他语言可以做类似的事情）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-07-02T19:34:12.670

[您可以使用Cram](https://bitheap.org/cram/)编写类似于交互式 shell 会话的测试。它具有灵活的测试规范格式，允许您使用 Perl 正则表达式或类似 shell 的通配符匹配输出。Cram 将重放测试中的命令，将输出与参考进行比较，并报告差异。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-02-28T04:56:47.670

[Aruba](https://github.com/cucumber/aruba)是一个[Cucumber](http://cukes.info)扩展，用于测试以任何编程语言编写的命令行应用程序。

要使用它，您将需要 ruby​​ 来运行测试，但 aruba 的目的是提供一个预定义步骤定义的库，这样您就不需要编写任何 ruby​​ 代码来制作一个可行的测试套件。（虽然在某些时候你可能会想写一点 ruby​​ 来做一些自定义步骤。）

您可以在此处查看使用 aruba 测试的命令行工具的复杂示例：[jingweno/gh](https://github.com/jingweno/gh/tree/master/features)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-09T15:52:59.063

您应该能够从 shell 脚本（批处理文件，在 MS 操作系统上）调用它们，将输出重定向到文件，然后以编程方式扫描文件以确保它具有正确的输出。我不知道有一个测试框架可以为您自动执行此操作，但您自己设置它应该是相当简单的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-04-17T10:44:35.840

[Sam Stephenson 的Bats（Bash 自动测试系统）](https://github.com/sstephenson/bats)。它很小，纯粹用 shell 编写，并且有一组很好的特性。

之前建议的 Aruba 看起来很有趣，但在某些情况下，就依赖项（ruby、cucumber）而言，它可能会显得过大

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-09T16:02:08.373

我做了一点这个（很久以前，呵呵）使用[Expect](http://en.wikipedia.org/wiki/Expect)来检查发生的事情是我，嗯，预期的

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-27T14:40:25.020

我已经开发了一个“完全”工具 [https://github.com/emilkarlen/exactly](https://github.com/emilkarlen/exactly)

它在临时沙箱目录中执行要测试的东西。自述文件包含许多示例。

对假设程序“classify-files-by-moving-to-appropriate-dir”的测试可能如下所示：

```
[setup]

dir input
dir output/good
dir output/bad

file input/a.txt = <<EOF
GOOD contents
EOF

file input/b.txt = <<EOF
bad contents
EOF

[act]

classify-files-by-moving-to-appropriate-dir GOOD input/ output/

[assert]

dir-contents input empty

exists output/good/a.txt : type file
dir-contents output/good num-files == 1

exists output/bad/b.txt : type file
dir-contents output/bad num-files == 1 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-09T15:54:39.293

您可以从批处理文件或 windows 脚本主机执行此操作。

但我保证会使用像 ( [http://www.splinterware.com/products/wincron.htm](http://www.splinterware.com/products/wincron.htm) ) 这样的任务调度程序或其他免费/专业软件。

当您想测试您的软件大约 100 次时，您可以轻松复制/粘贴您应该更改的命令行参数？！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-15T19:19:42.413

您可以将 perl 与[Test::more](http://search.cpan.org/~exodist/Test-Simple-1.001014/lib/Test/More.pm)库一起使用，它为测试 CLI 提供了一个很好的框架。虽然主要设计用于单元测试，但您可以将其扩展为测试用户工作流程。

一些方法：

```
 # Various ways to say "ok"
  ok($got eq $expected, $test_name);
  is  ($got, $expected, $test_name);
  isnt($got, $expected, $test_name);

  # Rather than print STDERR "# here's what went wrong\n"
  diag("here's what went wrong");

  like  ($got, qr/expected/, $test_name);
  unlike($got, qr/expected/, $test_name);

  cmp_ok($got, '==', $expected, $test_name); 
```

[命令行](/questions/tagged/command-line "显示标记为“命令行”的问题")[自动化](/questions/tagged/automation "显示标记为“自动化”的问题")[测试](/questions/tagged/testing "显示标记为“测试”的问题")[perl-testing](/questions/tagged/perl-testing "显示标记为“perl 测试”的问题")

# jsp - 使用 UrlRewrite 在 JSP 中替换 URL 字符

> ID：353207
> 
> 赞同：1
> 
> 时间：2008-12-09T15:48:35.530
> 
> 标签：jsp, jboss, url-rewriting

我在**JBoss**上的**JSP**项目中使用**[UrlRewrite](http://tuckey.org/urlrewrite/)**。我已经配置了一些规则，这样的东西：

 ****```
http://mysite/参数
```

读作：

```
http://mysite/index.jsp?parameter=parameter
```

等等。

现在，我想知道是否有办法将用户在 URL 中提交的某些字符替换为其他字符。类似于维基百科所做的事情。当您在 WikiPedia 中的 URL 中使用空格时，它会被替换为“-”。

UrlRewrite 是正确的工具吗？我周围也有一些过滤器，但我想我应该能够使用 UrlRewrite 或类似工具来完成此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-17T13:38:37.867

如果有人需要做同样的事情，我[发现可以使用 Servlet](https://stackoverflow.com/questions/359147/mask-urls-in-jsp)过滤 URL、response.sendRedirect() 和 request.getRequestDispatcher().forward()。

# java - 警告符号未签名的 Java 小程序

> ID：353211
> 
> 赞同：1
> 
> 时间：2008-12-09T15:49:08.027
> 
> 标签：java, applet

在最近更新的 java (6.10) [http://java.sun.com/javase/6/webnotes/6u10.html](http://java.sun.com/javase/6/webnotes/6u10.html)[链接文本](http://java.sun.com/javase/6/webnotes/6u10.html)中，更改了未签名小程序的方式。现在显示警告。是否可以在不签署您的小程序的情况下将其关闭？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T15:53:40.403

如果您可以以编程方式禁用它，那么这种警告的意义何在？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T11:12:42.850

没有办法禁用它。

这是一个垃圾更新。它破坏了标准的 Window 功能，并让所有支持任何小程序的人都头疼。一些程序员试图不必要地添加新的噱头的恶臭。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T19:02:28.407

有一种方法可以禁用它。请执行下列操作：

1.  打开 C:\Program Files\Java\jre6\bin 并运行 policytool.exe。
2.  在 Policy Tool 窗口中单击 File -> Open 并从 C:\Program Files\Java\jre6\lib\security 中选择文件 java.policy。
3.  单击“CodeBase ALL”，然后单击“编辑策略条目”按钮。
4.  在“策略条目”窗口中单击“添加权限”。
5.  在权限窗口中，从“权限：”组合框中选择“AWTPermission”，从“目标名称：”组合框中选择“showWindowWithoutWarningBanner”。然后单击“确定”。
6.  返回策略条目窗口，单击“完成”。
7.  返回策略工具窗口，单击文件 -> 保存。
8.  重新启动浏览器。
9.  享受您的无警告小程序:)。

# erlang - 你如何在 Erlang 中做模数或余数？

> ID：353224
> 
> 赞同：47
> 
> 时间：2008-12-09T15:52:40.233
> 
> 标签：erlang, modulo

我是 Erlang 的新手。你如何做模（得到除法的余数）？在大多数类 C 语言中它是 %，但它在 Erlang 中指定了一个注释。

有几个人用 rem 回答，在大多数情况下都可以。但是我正在重新讨论这个问题，因为现在我需要使用负数，而 rem 会为您提供除法的余数，这与负数的模数不同。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-13T15:30:02.593

在 Erlang 中，`5 rem 3.`给`2`和`-5 rem 3.`给`-2`。如果我理解你的问题，你会想`-5 rem 3.`给 1，因为`-5 = -2 * 3 + 1.`

这是做你想做的吗？

```
mod(X,Y) when X > 0 -> X rem Y;
mod(X,Y) when X < 0 -> Y + X rem Y;
mod(0,Y) -> 0. 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-12-09T15:57:08.337

erlang 模运算符是`rem`

```
Eshell V5.6.4  (abort with ^G)
1> 97 rem 10.
7 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-12-06T22:31:54.293

我在长生不老药中使用了以下内容：

```
defp mod(x,y) when x > 0, do: rem(x, y);
defp mod(x,y) when x < 0, do: rem(x, y) + y;
defp mod(0,_y), do: 0 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-09T15:56:52.223

根据[这篇博文](http://jjinux.blogspot.com/2007/05/erlang-amazingly-funky-and-amazingly.html)，它是`rem`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-03-05T11:40:22.247

上面的 Y + X rem Y 似乎是错误的： (Y + X) rem Y 或 Y + (X rem Y) 产生不正确的结果。例如：让 Y=3。如果 X=-4，第一种形式返回 -1，如果 X=-3，第二种形式返回 3，它们都不在 [0;3[ 中。

我改用这个：

```
% Returns the positive remainder of the division of X by Y, in [0;Y[. 
% In Erlang, -5 rem 3 is -2, whereas this function will return 1,  
% since -5 =-2 * 3 + 1.

modulo(X,Y) when X > 0 ->   
   X rem Y;

modulo(X,Y) when X < 0 ->   
    K = (-X div Y)+1,
    PositiveX = X + K*Y,
    PositiveX rem Y;

modulo(0,_Y) -> 
    0. 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T15:07:44.360

Erlang 余数不适用于负数，因此您必须为负参数编写自己的函数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-20T20:19:37.880

```
mod(A, B) when A > 0 -> A rem B;
mod(A, B) when A < 0 -> mod(A+B, B); 
mod(0, _) -> 0.

% console:
3> my:mod(-13, 5).
2 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-06-01T16:58:40.673

接受的答案是错误的。

`rem`行为与现代 C 中的运算符完全相同`%`。它使用截断除法。

对于 X<0 和 Y<0，接受的答案失败。考虑`mod(-5,-3)`：

```
C:                     -5 % -3 == -2
rem:                 -5 rem -3 == -2
Y + X rem Y:    -3 + -5 rem -3 == -5 !! wrong !! 
```

模运算符的替代实现使用地板除法和欧几里得除法。结果是

```
flooring division:   -5 mod -3 == -2
euclidean division:  -5 mod -3 == 1 
```

所以

```
Y + X rem Y 
```

不会为 X < 0 和 Y < 0 重现任何模运算符。

并且`rem`按预期工作 - 它使用截断除法。

# c# - 人脸识别/合并软件

> ID：353226
> 
> 赞同：17
> 
> 时间：2008-12-09T15:52:58.377
> 
> 标签：c#, java, c++, algorithm, face-recognition

谁能指出一些面部识别库和算法的正确方向？我试过搜索/谷歌搜索，但我主要找到论文和很少的真正软件。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-09T16:09:49.090

[特征脸](http://www.owlnet.rice.edu/~elec301/Projects99/faces/index.html)怎么样？利用简单的数学来存储人脸的可识别特征向量并使用多个向量重建人脸。

代码也都在 Python 中[可用](http://www.owlnet.rice.edu/~elec301/Projects99/faces/code.html)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-09T22:45:49.353

[OpenCV](http://opencv.willowgarage.com/wiki/)是一个很棒的计算机视觉库。

这是[关于人脸识别的 OpenCV wiki 页面](http://opencv.willowgarage.com/wiki/FaceRecognition)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-31T19:06:09.843

除了 Eigenfaces，我还会看 Fisherfaces。这是一篇学术论文，比较了两种算法[Eigenfaces 与 Fisherfaces](http://www1.cs.columbia.edu/~belhumeur/journal/fisherface-pami97.pdf)的性能。它使用 Fisherfaces 显示出更好的性能。我也同意 tfinniga 的观点，OpenCV 值得你花时间，我以前用它来进行人脸检测。

最后你应该更具体。您是要检测图片中何时有人脸，然后识别哪里，还是要检测图片中的特定人脸？此处列出的解决方案是针对后一个问题的。如果您想解决前一个问题，我建议您在文献中搜索 adaboost 和 haar 特征。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-09T15:59:57.613

您可能不会找到太多完成的人脸识别软件。如果你想这样做，你最好的机会是实现某人论文中的内容。

大约 4 年前，我相信 CMU 的某个人写了一个算法，这是我见过的最成功的人脸识别算法……我会尽力为你找到它，除非其他人知道我在说什么。

如果您以前从未实现过计算机视觉代码，那么您可以通过将其分解为更简单的问题来解决问题。你要找多少人？如果是一小群人，颜色空间识别算法可以工作吗？如果人们有不同的肤色和不同的头发颜色，那么您也许可以使用基本的色彩空间识别来获得良好的结果。

否则，您将面临一个大项目。

编辑：[这是一些 CMU 文章的列表，它们可能会为您指明正确的方向](http://www.ri.cmu.edu/research_center_detail.html?type=publications&center_id=4&menu_id=262)

如果我是你，我会阅读其中一些文章，并跟进参考资料。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-09T16:00:14.103

这种任务通常使用神经网络来完成。这是你看的主要方向。还有一些更具体的网络供您查看是 Kohonen 神经网络。它是最简单的图像识别网络，也可以用于人脸识别任务。仅使用这种网络不会取得任何好的结果，但将它们中的几个连接在一起。我无法提供更详细的信息，因为我只在理论上知道这一点，但在这方面没有实际技能。

顺便说一句，我认为您不会找到任何用于该任务的库，就像您通常拥有这样的库一样 - 为什么不制作产品并出售它？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-02-16T12:41:56.083

[在 CodeProject 和不同的语言中有一大堆它们。](http://www.codeproject.com/info/search.aspx?q=face+recognition)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-11-01T16:43:55.233

我用免费的源代码编写了一个完整的教程和演示程序，用于从网络摄像头实时执行人脸检测和人脸识别（基于 OpenCV 中的特征脸）：

[http://www.shervinemami.co.cc/faceRecognition.html](http://www.shervinemami.co.cc/faceRecognition.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-03-31T09:23:22.657

我发现[Luxand Facesdk](http://www.luxand.com/)最适合人脸识别和识别。

# sharepoint - ApplyWebConfigModifications 在农场中不起作用

> ID：353232
> 
> 赞同：1
> 
> 时间：2008-12-09T15:53:43.820
> 
> 标签：sharepoint, web-config

因此，我正在尝试部署一个使用 WebConfigModifications 集合更新 web.config 的 Web 应用程序功能。有很多关于执行此操作的信息，包括您遇到的所有问题，因此我对代码非常有信心，但无论我尝试什么，配置元素都不会添加到 Web 配置中。这在开发单服务器环境中工作正常，但在 Farm 中不会更新。

没有错误，没有日志信息，没有事件消息....没有任何指向为什么它不会更新：

> SPWebConfigModification appSettingModification = new SPWebConfigModification();
> appSettingModification.Name = "添加[@key=\"Key\"][@value=\"Value\"]";
> appSettingModification.Path = "配置/应用设置";
> appSettingModification.Owner = "所有者";
> appSettingModification.Type = SPWebConfigModification.SPWebConfigModificationType.EnsureChildNode；
> appSettingModification.Value = __appSettingResource;
> 
> if (removeModification)
> {
> app.WebConfigModifications.Remove(appSettingModification);
> }
> else
> {
> app.WebConfigModifications.Add(appSettingModification);
> }
> app.Update();
> app.Farm.Services.GetValue<SPWebService>()。

===============================

# 编辑

我想根据 drax 的建议添加此内容以反映 ApplyWebModifications 方法。此方法位于 Microsoft.SharePoint 程序集的 Microsoft.SharePoint.Administration 命名空间中的 SPWebService 上。

使用此方法的问题之一是所有 web.config 文件都在场中更新，即使实际上没有应用任何修改。即使您不打算更新 Web 配置，这也会导致应用程序池被回收。反思表明为什么会发生这种情况，这很烦人。

该方法内部是一个简短的 foreach 循环：

> foreach（this.WebApplications 中的 SPWebApplication 应用程序）
> {
> application.ApplyWebConfigModifications();
> }

它循环遍历每个 Web 应用程序并在 Web 应用程序对象上调用**INTERNAL** ApplyWebConfigModifications 方法。如果他们只是将此方法公开，那么我们将能够单独调用该方法，而不会影响不受我们更新影响的 Web 应用程序上的应用程序池回收。只是在说'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-09T16:30:59.267

问题可能在于您调用 ApplyWebCONfigModifications() 而不是：

app.Farm.Services.GetValue().ApplyWebConfigModifications();

采用：

app.Farm.Servers.GetValue `<SPWebService`>().ApplyWebConfigModifications();

第二个代码实际上调用了负责更新 web.config 文件的服务。

**旁注：** 此代码实际上将打开服务器/农场上安装的所有 web 应用程序中的所有 webconfig 文件 :) 但它会更新正确的文件。如果您将使用反射器扫描此方法，您将看到一些使用 foreach 循环的好例子：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-25T00:44:54.507

这个问题是bug。我认为。

```
SPWebService.ApplyWebConfigModifications()

public void ApplyWebConfigModifications()
{
  if (base.Farm.TimerService.Instances.Count > 1)
  {
    SPWebConfigJobDefinition definition = new SPWebConfigJobDefinition(this);
    definition.Schedule = new SPOneTimeSchedule(DateTime.Now);
    try
    {
      definition.Update();
      return;
    }
    catch (Exception exception)
    {
      if (exception is SPDuplicateObjectException)
      {
        throw new InvalidOperationException(SPResource.GetString("WebconfigModificationAlreadyRunning", new object[0]), exception);
      }
      throw;
    }
  }
  string strMessage = string.Empty;
  **foreach (SPWebApplication application in this.WebApplications)**
  {
    ULS.SendTraceTag(0x38386866, ULSCat.msoulscat_WSS_Topology, ULSTraceLevel.Medium, "Apply web config modifications to web app {0} ", new object[] { application.GetResponseUri(SPUrlZone.Default).ToString() });
    try
    {
      application.ApplyWebConfigModifications(); 
```

# database - SQL Server 2005 触发器 - 如何安全地确定是由 UPDATE 还是 DELETE 触发？

> ID：353233
> 
> 赞同：1
> 
> 时间：2008-12-09T15:53:55.677
> 
> 标签：database, sql-server-2005, triggers

我在 SQL Server 2005 触发器中有以下代码：

```
在 [myTable] 上创建触发器 [myTrigger]
更新，删除
作为
开始

声明 @OperationType VARCHAR(6)
如果存在（从插入中选择 1）
开始
    SET @OperationType='更新'
结尾
别的
开始
    SET @OperationType='删除'
结尾

```

我的问题：是否存在未正确填充 @OperationType 的情况？EG：表中的数据被一堆UPDATE/DELETE语句改变了，但是触发器不是每个都触发一次？

您是否有更好的方法来确定触发器是由 UPDATE 还是 DELETE 语句触发的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-09T16:00:54.303

为什么不创建两个单独的触发器？

```
CREATE TRIGGER [myUpdateTrigger] ON [myTable]
FOR UPDATE
AS
BEGIN

END

CREATE TRIGGER [myDeleteTrigger] ON [myTable]
FOR DELETE
AS
BEGIN

END 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-09T16:02:46.080

简单的回答：不，不会出现触发器无法正确检测到的情况（除非没有更改的行）。

触发器将为每个语句触发一次，因此这是不可能的，它会正常工作，但关键是，如果你真的想为`UPDATE`and执行不同的任务`DELETE`，你最好使用几个触发器。

# dll - ActiveX 组件无法创建对象 (comReport)

> ID：353240
> 
> 赞同：0
> 
> 时间：2008-12-09T15:56:24.470
> 
> 标签：dll, asp-classic, activex

我正在尝试打印 pdf 报告，但它没有打印并给出此错误。错误类型：ComReport (0x800A01AD) ActiveX 组件无法创建对象

我已经在我的操作系统中注册了 ComReport.dll。

这在我们的开发和生产服务器上运行良好，但在我的机器上本地运行不正常。而且我需要它在我的本地工作，这样我就可以调试一些东西并查看正在运行的查询。我要调试的页面是 .net 2003 中的经典 asp。我用谷歌搜索了一些东西，他们只是说要确保浏览器启用了 ActiveX ......确实如此！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-09T16:11:03.037

也许这是一个缺失的参考。您可以使用“Depends.exe”（随 Visual Studio 提供）来确定缺少的库。

# emacs - 如何使用文件局部变量设置 Emacs 缓冲区名称？

> ID：353246
> 
> 赞同：10
> 
> 时间：2008-12-09T15:57:29.553
> 
> 标签：emacs

我希望我的 emacs 缓冲区的名称与文件名不同。我不想每次都手动设置，而是希望根据文件内容自动发生这种情况，例如：

// 局部变量：
// 缓冲区名称： MyName
// 结束：

但这不起作用，因为 buffer-name 是一个函数，而不是一个变量。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-09T16:30:45.303

你可以说：

```
// Local Variables:
// eval: (rename-buffer "my-buffer-name-here")
// end: 
```

虽然这是一个技巧。

否则，您可以`find-file-hook`在您的程序中编写一个挂钩，`.emacs`将缓冲区重命名为特定的局部变量内容。就像是：

```
(defvar pdp-buffer-name nil)

(defun pdp-rename-buffer-if-necessary ()
  "Rename the current buffer according to the value of variable"
  (interactive)
  (if (and pdp-buffer-name (stringp pdp-buffer-name))
      (rename-buffer pdp-buffer-name)))

(add-hook 'find-file-hook 'pdp-rename-buffer-if-necessary) 
```

然后在您的特定文件中

```
// Local Variables:
// pdp-buffer-name: "pierre" 
// end: 
```

有了更多的脑力，你可以有一个更好的解决方案。

请注意，可能已经存在满足您需要的扩展。查看[Emacs wiki](http://www.emacswiki.org)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T19:20:03.513

谢谢皮埃尔。您的 pdp-buffer-name elisp 示例运行良好。

我做了一项改进，因为我注意到 emacs 将局部变量视为“不安全”，即总是提示询问是否应该应用该值。由于我希望它可以处理许多不同的值，而不会用“安全”值列表弄乱我的 .emacs，所以我添加了一条建议。使用前面示例的命名法，它看起来像这样：

```
;; allow all values for "pdp-buffer-name"  
(defadvice safe-local-variable-p (after allow-pdp-buffer-name (sym val) activate)  
  (if (eq sym 'pdp-buffer-name)    
      (setq ad-return-value t))  
  ) 
```

# php - 用 php 在 mysqldb 中搜索

> ID：353252
> 
> 赞同：2
> 
> 时间：2008-12-09T15:59:24.510
> 
> 标签：php, mysql, search

如何在 mysqldb 中实现出色的搜索 - 如果我使用 '...Like %bla%.... 使用 soundex 进行搜索会很棒 - 但如果我阅读手册，我必须创建一个 soundex 索引来搜索 soundex 值？

所以问题是在简单的列“标题”或其他内容中编写一个好的 db-search 或关键字的“最佳实践”是什么。

再见

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-09T01:09:10.903

如果您不适合安装和使用 Sphinx，那么您可以尝试使用 MySQL 的一些内置全文搜索功能，例如“MATCH”

这使您可以进行全文搜索，甚至可以使用相关性分数对结果进行排名。您可以编写如下查询：

```
SELECT id, col1, col2, MATCH(col1, col2) AGAINST('some text' IN NATURAL LANGUAGE MODE) AS relevance FROM table1; 
```

您甚至可以使用查询扩展来了解其他密切相关的术语。例如，如果用户搜索“数据库”并且最相关的结果包含“mysql”，那么 mysql 也会搜索“mysql”，因为它已确定“mysql”术语与“数据库”密切相关用户搜索的术语。

[http://dev.mysql.com/doc/refman/5.1/en/fulltext-query-expansion.html](http://dev.mysql.com/doc/refman/5.1/en/fulltext-query-expansion.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T16:04:34.080

对于文本搜索，除了使用 LIKE 子句 - [FULLTEXT](http://dev.mysql.com/doc/refman/5.1/en/fulltext-search.html)索引（这意味着使用 MyISAM）或使用特定的索引引擎（例如[Lucene](http://lucene.apache.org/java/docs/)或[Sphinx](http://www.sphinxsearch.com/) ）之外，您还有两个选择。

我个人建议使用 Sphinx，它与 MySQL 和 PHP 具有出色的集成，并且对于文本搜索（以及其他查询）非常快。

# system.net.mail - System.Net.Mail.MailMessage 字段字典

> ID：353253
> 
> 赞同：2
> 
> 时间：2008-12-09T15:59:29.330
> 
> 标签：system.net.mail, system.web.mail

我们目前正在更新应用程序的电子邮件发送部分，以用 System.Net.Mail 类替换 System.Web.Mail 下已弃用的一组类。

更改相当简单，但我们今天遇到了一个障碍，因为我们试图移植 System.Web.Mail.MailMessage.Fields 字典（包含映射到 CDO 字段的对象）的内容，但我们看不到等效的在 System.Net.Mail.MailMessage 类上。

有谁知道将 CDO 字段映射到 System.Net.Mail 类中的新类/属性的任何文档？（这是[**命名空间**](http://msdn.microsoft.com/en-us/library/ms872853.aspx)中的字段）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T16:32:08.000

看看这个网站[http://www.systemnetmail.com/](http://www.systemnetmail.com/)

它应该涵盖您需要映射的所有 SMTP 相关字段，例如 ssl、sendusing

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T16:28:33.517

您要保留哪些 cdo 字段？

我知道我们使用的一些 CDO 字段现在映射到 SmtpClient 对象中的一些属性。

# database - 面向对象的数据库还在使用吗？

> ID：353258
> 
> 赞同：16
> 
> 时间：2008-12-09T16:00:25.913
> 
> 标签：database, oop, object-oriented-database

很久以前，我听说过对象数据库。很酷的概念等等。现在，随着 ORM 事件无处不在，还有人使用任何面向对象的数据库系统吗？它们是否相关？它们实用吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-09T16:55:00.653

OO 数据库从未脱离利基市场。它们适用于某些应用程序——在这些应用程序中，数据结构适合用对象图表示——但从未拥有超过 RDBMS 以跨越鸿沟的引人注目的优势。OODBMS 产品的主要优势是与宿主语言的紧密集成——没有对象/关系阻抗不匹配。

但是，仍然有一些 OODBMS 供应商，例如[Gemstone](http://www.gemstone.com)、[Versant](http://www.versant.com/)或[Cardinal](http://www.jadeworld.com/)，他们的产品做得很好。该技术对某些类型的数据结构很有用，并且比 RDBMS 更有效，但与现代 SQL 方言相比，对于即席查询往往较弱。

正如其他[许多](https://stackoverflow.com/questions/353258/are-object-oriented-databases-still-in-use#353655) [人](https://stackoverflow.com/questions/353258/are-object-oriented-databases-still-in-use#354508)所指出的那样，Gemstone 由于支持[Seaside](http://www.seaside.st/)和[Maglev](http://ruby.gemstone.com/)（一个[Ruby](http://www.ruby-lang.org/en/)端口到 Gemstone VM 并在其上运行[Rails ）而受到关注。](http://www.rubyonrails.org/)我们可能会发现这让 Gemstone 的好人得到了一些关注，并因此对 OODBMS 范式有了更多的关注。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-11T12:30:08.910

> 事实上，数据库系统是真正难以进行根本性改变的领域之一。数十亿美元用于关系数据库系统，并且运行良好。

在现实生活中，这根本不是真的。我们的数据库问题的一个主要原因（我看到所有数据库行中有 30% 包含错误）是在 SQL 中使用非常原始的类型和验证。此外，即使它们被命名为关系，它们在处理关系方面也很糟糕。结果是非规范化的数据模型和导致的更新错误。

企业喜欢关系数据库的原因是它们非常可预测。他们必须在他们身上花很多钱，他们需要很多开发人员和维护人员来做大部分日常工作。他们没有看到可以消除的重复数量是一种优势。例行的工作让开发人员承担了艰巨工作的风险。切换到 OODB 将保留不太可预测的工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-09T16:09:46.207

查看[db4o](http://www.db4o.com/)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-09T16:10:10.587

事实上，数据库系统是真正难以进行根本性改变的领域之一。数十亿美元用于关系数据库系统，并且运行良好。它们是经过验证的技术，并且足够灵活，可以满足大多数需求（例如，如您所说，使用 ORM）。对象数据库确实存在，甚至在学术界之外。但是不要指望很快就会在该领域看到像 SQL Server 或 Oracle 这样大的东西。它们确实作为一种理论存在，也作为小型的、特定于应用程序的数据库和各种产品存在。基本上，我预测关系数据库将来会变得更加面向对象，以更好地处理需求。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-09T17:58:41.260

我最近开始使用宝石。GLASS（带有 Seaside（smalltalk web 框架）的 Linux（或 OS-X）上的 Gemstone）可能是复杂应用程序的最佳 web 开发环境。Smalltalk 正在复兴，成为“真正的红宝石”。

对模式更改和查询的支持远远优于 RDBMS。

一个重要的区别是，这次它们是负担得起的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-09T16:04:54.420

我们在我从事的产品中使用[Versant 对象数据库。](http://www.versant.com/en_US/products/objectdatabase)（以前的 FastObjects，以前的 Poet 数据库）。它是一个对象数据库，我们发现它在我们产品的某些方面工作得比关系模型好得多，主要是存储配置对象，与 Java 代码交互。

另请参阅这个先前提出的问题：[https ://stackoverflow.com/questions/52144/object-oriented-database-experiences](https://stackoverflow.com/questions/52144/object-oriented-database-experiences)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-09-03T07:01:21.647

因为他们的软件成本不容易查明。

我查看了Objectivity、db4o、versant，并且没有一个在他们的网站上预先列出软件的价格。

正因为如此，我已经几乎失去了兴趣。

有谁知道在哪里有所有这些不同 oodb 的定价和许可证比较？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-09T22:39:27.137

将 GemStone 用于大型业务应用程序。这很棒而且非常实用。我们已经使用它几年了，在那段时间里，它使我们能够用很少的资源做很多事情。不幸的是，关于对象数据库存在许多误解，我认为这使得它们在商业世界中的相关性降低。希望像 GLASS（GemStone、Linux 和 Seaside Smalltalk）这样的东西会在未来改变这种情况。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-16T07:24:53.777

到目前为止，对象数据库是一个很酷的概念。但是，实现存在可扩展性和稳定性问题。现在有了解决这两个野兽的正确化身，等式可能会改变。

我的想法是，数据引擎（不一定是对象数据库）和 RDBMS 可以真正并存，事实上，数据引擎在中间层、嵌入式应用程序/系统中是一个很好的地方，......还有，数据引擎的正确实现将允许在低级别和更高级别支持对象持久性，RDBMS/SQL 构造。这意味着您的应用程序可以选择使用对象，将数据引擎用于对象持久性，并通过 RDBMS 接口将对象作为表的行/列提供。

这是理想的设置。我们将这两种技术连接起来，并为开发人员提供在他们喜欢的界面中编程的替代方案。有人可能会争辩说我们现在有了这个，例如 - SQL Server 支持托管 CLR 对象，但是当前的实现受到阻抗减慢的影响。即 - 在数据路径中有很多转换/翻译为对象！= 二维数据，因此当您处理对象的应用程序将它们保存到数据库时，解决方案必须将它们转换/翻译为表中的行数据。

但是如果我们扭转这种情况，即数据引擎在对象上运行，那么就不会有阻抗不匹配。添加二维数据投影只不过是对象集合的接口实现，因此当对象作为表的数据行公开时，实际上并没有发生映射/转换。这是我的理论。

因此，该领域的下一波技术可能是数据引擎，它将允许对象作为低级接口和位于其之上的 RDBMS 接口。而且这项技术现在可用！

B-Tree Gold 4.0 Scalable Object Persistence 以此为主要设计目标。它实现了以下特性，因此非常适合作为下一个 RDBMS 的首选数据引擎，后者基本上是它之上的一层。它的两个主要关键点是： 可扩展性：在配备普通/普通笔记本电脑的 17 小时内插入 1 亿次。稳定性：工业强度的事务，将确保数据库不会损坏并且可以回滚到先前提交的状态。

为此，数据引擎必须满足 RDBMS 服务器所需的可扩展性和稳定性。一项非常艰巨的任务，但并非不可能。B-Tree Gold 4.0 版 SOP 已经满足了这个要求，因此，我们真的准备好实施这种解决方案，而不是把它放在我们的脖子上，因为 SOP 让您可以自由选择如何使用它。它可以用在很多方面，例如 - 作为中间层缓存站的补充 RDBMS 服务器，在客户端嵌入 DB 等等......更不用说作为 RDBMS 服务器本身的低级数据引擎！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-09T16:03:04.253

至少从我的角度来看，他们几乎已经死了。但话又说回来，我主要从事商业软件工作。也许在学术领域，它们仍在某处使用。

# .net - 如何在 finally 块中检测到 ThreadAbortException？（。网）

> ID：353270
> 
> 赞同：8
> 
> 时间：2008-12-09T16:02:40.400
> 
> 标签：.net, multithreading

我在 finally 块中有一些关键逻辑（带有一个空的 try 块），因为我想保证即使线程被中止，代码也会被执行。但是，我还想检测 ThreadAbortException。我发现将关键的 try/finally 块包装在 try/catch 中不会捕获 ThreadAbortException。有什么方法可以检测到吗？

```
尝试 {
    尝试 { }
    最后 {
        // 关键逻辑
    }
} 捕捉（异常前）{
    // 这里没有捕获到ThreadAbortException，而是抛出了异常
    // 从关键逻辑内部是
}

```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-03-03T18:02:55.427

这是一个奇怪的问题。

您发布的代码*应该可以*工作。似乎正在进行某种优化，决定不调用您的 catch 处理程序。

所以，我想用这个来检测异常：

```
bool threadAborted = true;
try {
  try { }
  finally { /* critical code */ }
  threadAborted = false;
}
finally {
  Console.WriteLine("Thread aborted? {0}", threadAborted);
}
Console.WriteLine("Done"); 
```

（我的实际代码只是睡在那个关键代码部分，所以我可以确定它最终会中止。）

它打印：

> 线程中止？错误的

嗯，确实很奇怪！

所以我想在那里做更多的工作，以欺骗任何“智能”优化：

```
bool threadAborted = true;
try {
  try { }
  finally { /* critical code */ }
  threadAborted = AmIEvil();
}
finally {
  Console.WriteLine("Thread aborted? {0}", threadAborted);
}
Console.WriteLine("Done"); 
```

刚刚在哪里`AmIEvil`：

```
[MethodImpl(MethodImplOptions.NoInlining)]
static bool AmIEvil() {
  return false;
} 
```

最后打印出来：

> 线程中止？真的

你有它。在您的代码中使用它：

```
try {
  try { }
  finally { /* critical code */ }
  NoOp();
}
catch (Exception ex) {
  // ThreadAbortException is caught here now!
} 
```

刚刚在哪里`NoOp`：

```
[MethodImpl(MethodImplOptions.NoInlining)]
static void NoOp() { } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T16:07:06.337

对于 ThreadAbortException，您实际上可以在 catch 语句中执行代码。问题是一旦执行离开 catch 块，异常将被重新抛出。

如果你想真正阻止异常继续，你可以调用 Thread.ResetAbort()。但这确实需要完全信任，除非您有特定的场景，否则几乎可以肯定这是错误的做法。

[线程中止异常](http://msdn.microsoft.com/en-us/library/system.threading.threadabortexception.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-09T16:04:39.337

阅读[受约束的执行区域](http://msdn.microsoft.com/en-us/library/ms228973.aspx)。

具体来说，[RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup 方法](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.runtimehelpers.executecodewithguaranteedcleanup.aspx)在这里很有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-09T16:22:00.080

我不认为这是可能的。

为什么首先需要处理*ThreadAbortException*？调用*thread.Abort()*通常是糟糕设计的标志。有一个标志变量，当设置为 true 时将简单地*返回；*从线程函数，当然经过适当的清理。

这样你就不用担心异常了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-11-18T21:23:07.103

如果调用 Thread.Abort 是不好的设计，为什么 SQL Server 会在运行用户代码的线程上调用它？因为这正是查询取消的处理方式，它会导致噩梦。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T10:43:57.173

我同意阿鲁尔。调用 Thread.Abort() 是糟糕设计的标志。

让我引用[MSDN 中的 Peter Ritchie：Thread.Abort](http://msdn.microsoft.com/en-us/library/ty8d3wta.aspx "MSDN：Thread.Abort()")（重点是我的）：

> **不使用 Thread.Abort 和 ThreadAbortException 的原因有很多**
> 
> 在某些平台（如 x64 和 IA64）上，可能会在 Monitor.Enter 和 try 块之前发生中止（即使使用 lock/SyncLock），从而使监视器处于孤立状态。ThreadAbortException 可能发生在未编写用于处理线程中止的第 3 方代码中。在 .NET 1.x 中处理 finally 块时可以中止线程 将异常用于正常控制流逻辑。异步异常可以中断分片状态或资源的修改，使它们损坏。
> 
> 有关更多详细信息，请参阅： http:
> [//msmvps.com/blogs/peterritchie/archive/2007/08/22/thead-abort-is-a-sign-of-a-poorly-design-program.aspx](http://msmvps.com/blogs/peterritchie/archive/2007/08/22/thead-abort-is-a-sign-of-a-poorly-designed-program.aspx)
> [http:// www.bluebytesoftware.com/blog/2007/01/30/MonitorEnterThreadAbortsAndOrphanedLocks.aspx](http://www.bluebytesoftware.com/blog/2007/01/30/MonitorEnterThreadAbortsAndOrphanedLocks.aspx)
> [http://blogs.msdn.com/ericlippert/archive/2007/08/17/subtleties-of-c-il-codegen.aspx](http://blogs.msdn.com/ericlippert/archive/2007/08/17/subtleties-of-c-il-codegen.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T15:15:26.810

你有没有尝试过这样的事情？

```
try {
    try { }
    catch (ThreadAbortException)
    {
      ThreadAbortExceptionBool = true;
    }
    finally {
        // critical logic
        if (ThreadAbortExceptionBool)
          // Whatever
    }
} 
catch(Exception ex) {
    // ThreadAbortException is not caught here, but exceptions thrown
    // from within the critical logic are
} 
```

# c# - 实体框架中的类和接口层次结构？

> ID：353284
> 
> 赞同：11
> 
> 时间：2008-12-09T16:05:16.527
> 
> 标签：c#, entity-framework, class-hierarchy

我有两个相关的类，它们共享一个公共接口，并且都存储在同一个底层数据库表中。但是，Entity Framework 生成一个公共类，我确实需要两个不同的类。我该如何解决这个问题？最好使用基类而不是接口吗？如何更改 EF 模型以提供映射在一张表上的两个类？

**编辑：** AccountType 属性确定类的类型；用户或组。

一些简单的代码：

```
public interface IAccount
{
    string Name { get; set; }
    AccountType AccountType { get; set; }
}

public class GroupAccount : IAccount
{
    public string Name { get; set; }
    public GroupType GroupType { get; set; }
    public AccountType AccountType { get; set; }
}

public class UserAccount : IAccount
{
    public string Username { get; set; }
    public string Password { get; set; }
    public string Name { get; set; }
    public AccountType AccountType { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-09T16:09:32.697

这些数据有区别吗？即 AccountType 是否定义了它是哪种类型？如果是这样的话：

*   EF 应该从存储中创建 Account 实体
*   然后创建 2 个子类（UserAccount 和 GroupAccount）
*   在 Account 的映射中，指定谓词“添加条件”
    *   让它映射到 AccountType（存储）字段为 1（或其他）的 UserAccount
    *   让它映射到 GroupAccount，其中 AccountType（存储）字段为 2（或其他）

然后帐户类型应该从帐户对象中完全消失（如果没有，则取消映射）。要仅获取 UserAccount 记录，请使用

```
 .Accounts.OfType<UserAccount>()... 
```

Account 类在这个模型中应该是抽象的。接口的东西可以通过部分类添加 - 即在一个单独的文件中，定义：

```
partial class Account : IAccount {
   // extra code here
} 
```

ETC

一个合理的演练在[这里](http://weblogs.asp.net/zeeshanhirani/archive/2008/08/16/single-table-inheritance-in-entity-framework.aspx)。

# ado.net - ADO.NET 数据服务“Astoria”和缓存

> ID：353288
> 
> 赞同：1
> 
> 时间：2008-12-09T16:05:59.893
> 
> 标签：ado.net, caching, wcf-data-services

我刚开始为一个项目深入研究 ADO.NET 数据服务，但很快就遇到了问题。起初我对性能感到惊讶，但后来我意识到数据被缓存了。我的项目依赖于实时数据，我喜欢使用 ADO.NET 数据服务 REST 查询语法（无需使用 WCF 或 SOAP），但无需缓存。

我在 ADO.NET 数据服务介绍页面（[此处](http://msdn.microsoft.com/en-us/library/cc907912.aspx)）上看到，他们还没有 API 支持来管理缓存持续时间或类似的东西。

任何人都对如何完成此操作或关闭缓存有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T22:47:23.193

我们最近发表了一篇关于如何使用 ETags 控制从数据服务返回的数据的缓存策略的帖子，[http://blogs.msdn.com/astoriateam/archive/2008/04/22/optimistic-concurrency-data-services .aspx](http://blogs.msdn.com/astoriateam/archive/2008/04/22/optimistic-concurrency-data-services.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-06T13:39:50.470

默认情况下，数据上下文的 MergeOption 设置为 AppendOnly。这意味着重新请求只会添加新实体而不会更新现有实体。尝试将 MergeOption 设置为 OverwriteChanges：

```
this.context.MergeOption = MergeOption.OverwriteChanges; 
```

当我注意到这一点时，这对我有用！如果您使用的是实时数据，那么您可能希望使用 NoTracking 选项完全关闭更改跟踪。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T23:46:23.603

该链接很有帮助，但它并没有真正谈论 ETags 和缓存，它只是提到 ETags 可*用于*缓存。你有一个例子吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-15T14:34:27.087

[ETag](http://msdn.microsoft.com/en-us/library/dd541486(PROT.10).aspx)的详细信息

# iphone - 双 UIView 导航栏

> ID：353295
> 
> 赞同：2
> 
> 时间：2008-12-09T16:09:01.403
> 
> 标签：iphone, cocoa-touch, interface-builder

我使用带有取消和保存按钮的顶栏的界面生成器制作了一个 UIView。但是当视图显示在模拟器中时，它在我特意设计的导航栏下方有一个额外的导航栏。额外的栏上没有按钮。任何人都知道我可以在哪里摆脱额外的导航栏？

**更新：**在尝试删除我的“自定义”导航栏并再次添加时，发生了一些变化。我现在在我的自定义导航栏顶部有一个额外的导航栏，它有一个带有前一个视图标题的后退按钮。不知道这有多重要，但我想我应该提一下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T16:44:35.590

您正在将 UIVIew 的控制器推送到已经存在的 UINavigationController（带有自己的导航栏）上。

您需要做的是摆脱视图“顶部栏”并访问当前控制器的导航项。使用 leftBarButtonItem 和 rightBarButtonItem 设置关闭/保存按钮，甚至可能是 titleView。

# c++ - 原位删除元素的最佳方法

> ID：353296
> 
> 赞同：2
> 
> 时间：2008-12-09T16:09:12.057
> 
> 标签：c++, stl, set

我有一组要迭代的对象，但是我可能会在迭代期间决定现在需要删除这些对象中的一个（或多个）。

我的代码如下：

```
if( ! m_Container.empty() )
    {
        for(  typedefedcontainer::iterator it = m_Container.begin();
              it != m_Container.end(); 
              ++it  )
        {
            if( ! ( SomeFunction( (*it), "test", "TEST!", false ))  )
            {
            // If function returns false, delete object.
                m_Container.erase( it );
                AsyncResponseStore::iterator it = m_asyncResponses.begin();
            }

        }

    } 
```

但是，当然，当我擦除一个对象时，我得到一个错误：“映射/设置迭代器不可增加”。有人可以提出更好的方法吗？

请参阅： [如果在从头到尾迭代时在地图元素上调用 erase() 会发生什么？](https://stackoverflow.com/questions/263945/what-happens-if-you-call-erase-on-a-map-element-while-iterating-from-begin-to-e)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-09T16:18:08.920

这取决于容器。列表容器通过从代表列表中下一项的擦除方法返回一个新的迭代器来支持枚举期间的删除。地图不支持这个。

map 的一种简单方法是将要擦除的项目累积在一个单独的列表中，然后在完成处理映射以从映射中擦除项目时迭代该列表。这假设您可以推迟删除，直到迭代完成。如果没有，那么您别无选择，只能为每次删除重新启动迭代。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-09T16:39:51.433

如果容器支持它（我怀疑你的不支持，但问题标题是通用的，所以如果不是你，这可能对其他人有用）：

```
struct SomePredicate {
    bool operator()(typedefedcontainer::value_type thing) {
        return ! SomeFunction(thing, "test", "TEST", false);
    }
};

typedefedcontainer::iterator it;
it = std::remove_if(m_Container.begin(), m_Container.end(), SomePredicate());
m_Container.erase(it, m_Container.end()); 
```

m_Container 必须有一个擦除范围方法，它包括任何序列或关联容器。不过，它确实必须有一个可变迭代器，我只是注意到我最初误读了错误消息：它说“map / set iterator not incrementable”。所以我猜你的容器是一张地图或一套。

请注意，最后三个可能是一个真正了不起的单行，但这个边距太窄而无法包含它。

此外，SomePredicate 可以有一个带有参数的构造函数来将附加参数存储到 SomeFunction，因为在现实生活中我猜它们是非常量的。

如果你使用 boost:bind 来构造函子，你实际上可以完全摆脱 SomePredicate 。然后，您的单线将非常庞大。

[编辑：Rob Walker 在他的回答中正确地指出了我在这里所做的假设并且问题没有说明，即所有擦除都可以推迟到迭代和测试完成之后。如果 SomeFunction 通过隐藏路由（例如全局，或者因为 SomeFunction 实际上是 this 的成员函数）访问 m_Container，并且其结果取决于容器的内容，那么我的代码可能不等同于提问者的代码。但我认为我的代码是“除非有理由不”默认。]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T16:30:45.400

通过以下方式修复：

```
for(  typedefedcontainer::iterator it = m_Container.begin();
      it != m_Container.end(); 
        )
{
    if( ! ( SomeFunction( (*it), "test", "TEST!", false ))  )
    {
    // If function returns false, delete object.
        m_Container.erase( it++ );
    }
    else
    { 
        ++i;
    } 

} 
```

当一个元素被删除时，所有指向它的指针都会失效。因此，通过使用 it++，我们可以绕过它。感谢那些发布建议的人。

# python - 如何将绘制的圆圈与pygame混合

> ID：353297
> 
> 赞同：4
> 
> 时间：2008-12-09T16:09:12.650
> 
> 标签：python, pygame

我正在尝试创建一个像这里这样的应用程序：

[http://www.eigenfaces.com/](http://www.eigenfaces.com/)

基本上很多用pygame绘制的重叠圆圈。我无法弄清楚如何混合圆圈以使它们半透明。那就是让重叠的颜色显示出来。到目前为止，我的代码是这样的：

```
import sys, random, time
import pygame
from pygame.locals import *
from pygame import draw

rand = random.randint

pygame.init( )

W = 320
H = 320
size = (W, H)

screen = pygame.display.set_mode(size)

run = True
while 1:

    for event in pygame.event.get():
        if event.type == pygame.KEYDOWN: 
            if event.key == pygame.K_SPACE :
                run = not run
            else:
                sys.exit()
    if run:
        xc = rand(1, W)
        yc = rand(1, H)
        rc = rand(1, 25)

        red = rand(1, 255)
        grn = rand(1, 255)
        blu = rand(1, 255)

        draw.circle(screen, (red, grn, blu, 200), (xc, yc), rc, 0)

        pygame.display.flip() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-09T18:17:24.357

我通过绘制到一个不是显示器的表面并结合 set colorkey 和 set alpha 函数来让它工作。

```
import pygame
from pygame.locals import *

TRANSPARENT = (255,0,255)
pygame.init()
screen = pygame.display.set_mode((500,500))

surf1 = pygame.Surface((200,200))
surf1.fill(TRANSPARENT)
surf1.set_colorkey(TRANSPARENT)
pygame.draw.circle(surf1, (0,0,200,100),(100,100), 100)

surf2 = pygame.Surface((200,200))
surf2.fill(TRANSPARENT)
surf2.set_colorkey(TRANSPARENT)
pygame.draw.circle(surf2, (200,0,0,100),(100,100), 100)

surf1.set_alpha(100)
surf2.set_alpha(100)

while True:
    screen.fill((255,255,255))

    for event in pygame.event.get():
            if event.type == QUIT:
            pygame.quit()

    screen.blit(surf1, (100,100,100,100))
    screen.blit(surf2, (200,200,100,100))
    pygame.display.flip() 
```

PS 还有可以放入 blit() 参数中的混合标志： [Pygame.org - Surface.blit](http://www.pygame.org/docs/ref/surface.html#Surface.blit)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T22:32:49.363

我是戴夫。eigenfaces.com 上图像的创建者。祝你的实验好运。我在这里发布了代码：

[http://www.eigenfaces.com/](http://www.eigenfaces.com/)

让我知道它是否有用。

顺便说一句..我也尝试过电影...这里大约有 20 帧，每帧大约 1000 代：

[http://www.eigenfaces.com/img/morphs/anim-100x20.gif](http://www.eigenfaces.com/img/morphs/anim-100x20.gif)

# javascript - 我可以直接从 GreaseMonkey 脚本中保存页面图片吗

> ID：353308
> 
> 赞同：0
> 
> 时间：2008-12-09T16:10:32.273
> 
> 标签：javascript, greasemonkey, filesystem-access

我可以将 GreaseMonkey 脚本中的页面图片直接保存到我的硬盘吗？

是最简单的方法吗 - 设置我的服务器并使用**GM_xmlhttpRequest**将图片网址转换为它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T16:29:59.520

不，你不能。GreaseMonkey 仍然在浏览器沙箱中，这意味着您无法访问任何系统资源。无论如何，（浏览器集成的）JavaScript 中没有 FileSystem API。

也许[DownThemAll！](https://addons.mozilla.org/en-US/firefox/addon/201)帮助你。

# regex - 正则表达式获取标签内的文本

> ID：353309
> 
> 赞同：2
> 
> 时间：2008-12-09T16:10:38.183
> 
> 标签：regex, string

我需要一个[正则表达式](http://www.codeproject.com/KB/dotnet/regextutorial.aspx)来获取 2 个标签内的文本。

假设我想要返回一个数组，其中包含**> 和** **> 标记中的****任何文本。`<data``</data`****或“（”和“）”标签中的** 任何文本。

 **如何使用 C# 中的 RegEx 来做到这一点？

* * *

一个高级问题是：

1.  输入字符串是**“color=rgb(50,20,30)”**
2.  如何在 C# 中的 RegEx 处理器返回 3 个单独的数组插槽中的 3 个数字？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T16:13:42.500

Perl 正则表达式将是

```
$string =~ /color=rgb\((\d+),(\d+),(\d+)\)/;
@array = ($1,$2,$3); 
```

但是您可能需要更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T17:29:48.260

既然你特别提到了 C#，这就是我如何进行精确解析：

```
private static readonly Regex RgbValuePattern = new Regex(@"(?<r>\d{1,3}) ?, ?(?<g>\d{1,3}) ?, ?(?<b>\d{1,3})",
                                                          RegexOptions.Compiled | RegexOptions.ExplicitCapture); 
```

然后后来...

```
var match = RgbValuePattern.Match(value);

if (match.Success)
{
    int r = Int32.Parse(match.Groups["r"].Value, NumberFormatInfo.InvariantInfo);
    int g = Int32.Parse(match.Groups["g"].Value, NumberFormatInfo.InvariantInfo);
    int b = Int32.Parse(match.Groups["b"].Value, NumberFormatInfo.InvariantInfo);
    return Color.FromArgb(r, g, b);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T16:54:40.030

这个类似的问题的答案将有所帮助：

*   **[正则表达式：从两个标签之间的字符串中提取一个部分](https://stackoverflow.com/questions/1237/regex-to-pull-out-a-section-a-substing-from-a-string-between-two-tags)**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-14T00:03:11.987

使用 Regex 解析 XML 通常是一个非常糟糕的主意。看到[这个答案](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-09T16:35:05.843

我相信当你想要解析嵌套结构时会出现真正的问题。例如，当您想像这样检查 XML `<data><data>123</data><data>456</data></data>` 以提取包含在最外层`<data>`标签中的数据时，仅使用一个 RegEx 是不够的。只是警告您不要在存在更多（强大和特定）方法的地方使用 RegEx。在对 XML 执行更复杂的任务时，应考虑使用真正的 XML 解析器。我的2美分...

# oracle - 从 Sybase 连接到 Oracle

> ID：353322
> 
> 赞同：0
> 
> 时间：2008-12-09T16:15:11.593
> 
> 标签：oracle, sybase

由于复杂的原因（并非总是如此），我需要从 Sybase 视图中查询 Oracle 表。关于我该怎么做的任何想法？

示例 oracle con 详细信息：数据库：dta@mydomain.com 架构：dta 密码：123

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T21:51:29.823

如果您需要实时获取数据，则需要一个网关。[Oracle 数据库网关](http://www.oracle.com/technology/products/gateways/index.html)

如果可能存在延迟，您最好进行定期数据导出，然后使用外部表。[Oracle 外部表](http://www.oracle.com/technology/products/oracle9i/daily/sept19.html)

# ruby-on-rails - Ruby 1.8 和 UTF-8 字符串 case 语句比较

> ID：353326
> 
> 赞同：2
> 
> 时间：2008-12-09T16:16:01.153
> 
> 标签：ruby-on-rails, ruby, utf-8, ruby-1.8

我有一个 Rake 任务（在 lib/tasks 目录中），我在共享虚拟主机上使用 cron 运行。问题是我想使用 case 语句比较 UTF-8 字符串，但我的源代码不是 UTF-8 编码的。如果我将源代码保存为 UTF-8，当我尝试启动它时会出现错误:(

我必须做什么？

可以从外部 UTF-8 txt 文件中读取此字符串吗？

PS我正在使用Ruby 1.8

PS我的意思是这样比较：

```
result = case utf8string
   when 'АБВ': 1
   when 'ГДИ': 2
   when 'ЙКЛ': 3
   when 'МНО': 4
   else 5
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T08:34:27.077

我发现我的问题不是案例陈述

问题是当我以 UTF-8 格式保存源代码时，我的文本编辑器在开头添加 3 个字节 (BOM) 以指示编码为 UTF-8。

> **问：什么是 BOM？**
> 
> **答：**字节顺序标记（BOM）由数据流开头的字符代码 U+FEFF 组成，它可以用作定义字节顺序和编码形式的签名，主要用于未标记的纯文本文件。在某些更高级别的协议下，在该协议中定义的 Unicode 数据流中可能强制（或禁止）使用 BOM。

[UTF-8、UTF-16、UTF-32 和 BOM](http://unicode.org/faq/utf_bom.html#BOM)

我得到的错误是：

```
1: Invalid char `\357' in expression
1: Invalid char `\273' in expression
1: Invalid char `\277' in expression 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T09:57:48.687

我会说您需要更改文本编辑器，因为 UTF-8 不需要*BOM 。*UTF-8 不依赖于字节顺序。有关详细信息，请参阅[链接文本](http://en.wikipedia.org/wiki/UTF-8#Byte-order_mark)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T21:18:39.920

尝试使用`mb_chars`Rails 的[ActiveSupport](http://api.rubyonrails.org/classes/ActiveSupport/Multibyte/Chars.html)框架中的方法：

```
result = case utf8string.mb_chars
   when 'АБВ': 1
   when 'ГДИ': 2
   when 'ЙКЛ': 3
   when 'МНО': 4
   else 5
end 
```

# linq-to-sql - linq2sql 幕后是否等于 Entity Framework

> ID：353333
> 
> 赞同：2
> 
> 时间：2008-12-09T16:18:08.140
> 
> 标签：linq-to-sql, entity-framework

我知道它是一个新事物，更强大并且添加了更多选项，但是 linq2sql 是新 EF 的一部分吗？

如果不是，这两个框架之间的主要区别是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T17:02:47.173

我写了几篇关于 LINQ-to-Entities 及其与 LINQ-to-SQL 的关系的观点文章：

[http://www.hackification.com/2008/12/03/linq-to-entities-the-blackberry-storm-of-orms/](http://www.hackification.com/2008/12/03/linq-to-entities-the-blackberry-storm-of-orms/) [http://www.hackification.com/2008/12/04/linq-到实体跟进/](http://www.hackification.com/2008/12/04/linq-to-entities-follow-up/)

摘要：LINQ-to-SQL 与 LINQ-to-Entities 不同。L2S 有一个小的功能集，但它的功能非常好。L2E 旨在涵盖更广泛的功能集，但当前版本似乎有一些明显的遗漏（例如延迟加载）。L2E的v2应该要好得多；当前版本（恕我直言）感觉更像是一个测试版。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T16:36:12.017

根据我所阅读和被告知的内容（反复=）），linq 2 sql 正在退役，有利于 Linq to EF。

请参阅此处[https://stackoverflow.com/questions/253263/has-microsoft-really-killed-linq-to-sql](https://stackoverflow.com/questions/253263/has-microsoft-really-killed-linq-to-sql)和此处[LINQ to SQL 死了还是活着？](https://stackoverflow.com/questions/252683/is-linq-to-sql-doa)

EF 将允许您使用更通用的后备存储，这对于非 MSSQL 后备存储的用户来说更好。

# java - ivy:publish 是如何工作的？

> ID：353336
> 
> 赞同：26
> 
> 时间：2008-12-09T16:18:24.800
> 
> 标签：java, ant, build-process, build-automation, ivy

我完全不知道蚂蚁任务 ivy:publish 应该如何工作。

我希望我进行正常的构建，这会创建一堆 jar 文件，然后我会将这些 jar 推送到（本地）存储库。

我如何指定从哪里检索构建的 jar，以及这些 jar 将如何在存储库中结束？

**更新：**

```
<target name="publish-local" description="--> Publish Local">
    <ivy:retrieve />
    <ivy:publish resolver="local" pubrevision="${release.version}" status="release" update="true" overwrite="true">
        <artifacts pattern="${dist.dir}/[organisation]-[module].[ext]" />
    </ivy:publish>
</target> 
```

这实际上有效，我之前没有包括检索。

但是我仍然有一些问题，假设我想发布 3 个 jar，openscada-utils.jar，openscada-utils-sources.jar 和 openscada-utils-javadocs.jar 作为 openscada-utils-0.9.2.jar，openscada-utils -0.9.2-sources.jar 和 openscada-utils-0.9.2-javadocs.jar

我并不完全清楚实际名称是如何组合的，以及我可以在哪里指定它们应该获得哪些名称。（使用上面的片段，jar 总是只被称为 utils.jar）。

**更新1：**

我让它工作（有点），但它仍然感觉不对。不知何故，所有教程都关注来自 3rd 方项目的依赖关系，但对我来说同样重要的一点是处理项目特定的依赖关系。

我有一堆以各种方式相互依赖的子项目。考虑到 ivy:publish 我不清楚如何开始。

1.  我如何处理第一个版本？我对所有子项目都有一个共同的版本号，以表明它们属于一起（比如说 0.9）。因此第一个修订版应该是 0.9.0，但到目前为止，我的存储库中没有任何项目。如何让 Ivy 分配此修订号。

2.  在开发过程中，我想再次发布构建的文件，到目前为止不更改修订号。

3.  如果我完成了我的工作，我想将其推送到共享存储库（并将修订号从 0.9.0 增加到 0.9.1），推荐的方法是什么？

4.  对于实际版本，我想制作具有依赖关系的发行版，而没有，不知何故我想我可以为此使用不同的配置。我怎样才能利用它来发挥我的优势？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-09T16:30:17.303

您需要指定“解析器”。就像是：

```
<ivy:publish resolver="local" pubrevision="1.0"/> 
```

它由模式控制。这个[页面](http://ant.apache.org/ivy/history/latest-milestone/concept.html#patterns)很好地涵盖了它。看起来你希望你的成为：

```
<artifacts pattern="${dist.dir}/[organisation]-[module]-[revision]-[type].[ext]" /> 
```

您需要将这三个 jar 标识为 ivy.xml 文件中的工件。像这样的东西：

```
<publications>
    <artifact name="utils"/>
    <artifact name="utils" type="source"/>
    <artifact name="utils" type="javadocs"/>
</publications> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-01-13T16:28:00.813

首先，您需要一个 ivy.xml 文件。

```
<ivy-module version="2.0">
    <info organisation="com.example.code" module="MyProject"
         revision="${project.revision}"/>
    <configurations>
        <conf name="runtime" description="" />
        ... other config elements here...
    </configurations>

    <publications defaultconf="runtime">
        <artifact name="MyProject" type="jar" ext="jar" conf="runtime" />
    </publications>

    <dependencies>
        ...
    </dependencies>
</ivy-module> 
```

ivy.xml 中的 info 元素和 Publications 元素允许您跳过 build.xml 中 ivy 元素的各种属性。

注意 ivy.xml 中的 ${project.revision}。该属性在 build.xml 中被赋予了值，但这似乎工作得很好。然后，修订版可以轻松获得所需的任何值（例如，每晚构建与本地构建）。

这是一个如何设置 build.xml 文件的示例

```
<property name="project.revision" value="1.0.0"/>

...

<target name="ivy">
    <ivy:resolve />

    <!-- Possible ivy:report, ivy:retrieve and other
    elements for managing your dependencies go here -->

    <ivy:deliver conf="*(public)"/> 
</target>

<target name="publish" depends="clean, ivy, jar">
    <ivy:publish resolver="local">
        <!-- possible artifacts elements if your artifacts
        are not in standard location -->
    </ivy:publish>
</target>

... 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-28T18:07:11.983

您应该先运行`<ivy:deliver/>`任务。这将创建一个 ivy.xml 文件，可供 Ivy 存储库使用。

使用时，您可以通过在参数`<ivy:publish>`中指定要发布到的存储库来指定它。`resolver`这需要与`ivy.settings.xml`文件中的解析器名称相匹配。

您并没有真正指定工件，而是在哪里找到要发布的工件的模式。`<artifacts>`您可以通过任务上的子任务指定这一点`<ivy:publish>`。例如，如果您`${basedir}/target/archive`像我们一样在目录下构建所有内容，则可以将其指定为：

```
<ivy:publish resolver="public">
   <artifacts path="target/archive/[artifact].[ext]"/>
</ivy:publish> 
```

如果要更改文件的修订号，可以使用任务的*pubrevision*参数`<ivy:publish>`。这不会更新`ivy.xml`，但会将您的 jars/wars 发布到正确的修订版。我更喜欢使用任务的*pubrevision*参数`<ivy:deliver>`并让它创建正确的`ivy.xml`文件。然后，`<ivy:publish>`将使用我`ivy.xml`文件中的修订。

你不需要做`<ivy:retrieve>`。毕竟，您正在运行构建以创建新的 jar，它们应该在您的构建中的某个位置。否则，如果您不创建 jar 或 war，您想将什么发布到您的 Ivy 存储库中？而且，您当然不想为了重新发布它而检索您的 Ivy 存储库中已经存在的东西。

* * *

我的理念一直是发布是一项 CM 任务，不应该作为构建过程的一部分来完成。因此，我们不使用`<ivy:deliver>`or `<ivy:publish>`。

我们使用 Artifactory 作为我们的 Ivy 存储库（和我们的 Maven 存储库）。我们使用[Jenkins](http://jenkins-ci.org)作为我们的持续构建服务器。

我所做的是让开发人员通过任务`pom.xml`从他们的文件中创建一个文件。这和构建 jars/wars 在 Jenkins 中保存为存档工件。`ivy.xml``<ivy:makepom>`

当我们对特定构建感到满意并希望它在我们的公共存储库中时，我使用 Jenkins 的提升构建任务将带有 pom.xml 的特定 jar/war 提升到我们的 Artifactory 存储库。我们使用`mvn deploy:deploy-file`任务来做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T06:10:26.540

了解常春藤在这里做什么很重要。它不仅仅是将您的工件 jar 复制到 ivy 存储库 - 它还生成相关的“.ivy.xml”文件，这些文件指定每个工件的所有依赖项。

在幕后，该`ivy:retrieve`任务实际上也在触发一个`ivy:resolve`. 当 ivy:resolve 发生时，一个文件被写入本地 ivy 缓存（在 中的`.ivy`文件夹中`user.home`），该文件指定解析是如何发生的（需要哪些模块的哪些修订来完成解析。）`ivy:publish`遇到时，该解析记录是从缓存中检索并用于为您的工件生成 ivy.xml。

我发现这样做的最大缺陷是要求`ivy:resolve`和`ivy:publish`任务在由 ant 执行时都由同一个类加载器加载。确保发生这种情况的最简单方法是在 taskdef 任务上使用 loaderRef。例如（注意匹配的 loaderRef 标签）：

```
<taskdef name="ivy-retrieve" 
     classname="org.apache.ivy.ant.IvyRetrieve" 
     classpathref="ivy.lib" 
     loaderRef="ivy.loader"/>
<taskdef name="ivy-publish" 
     classname="org.apache.ivy.ant.IvyPublish" 
     classpathref="ivy.lib" 
     loaderRef="ivy.loader"/> 
```

# apache-flex - Flex - 如何对在标题中使用项目渲染器的数据网格列进行排序？

> ID：353341
> 
> 赞同：1
> 
> 时间：2008-12-09T16:20:13.080
> 
> 标签：apache-flex, sorting, datagrid

我正在使用一个高级数据网格，它为列标题使用自定义项目渲染器，现在排序不起作用。如果我取出自定义渲染器，它可以正常工作，但我需要它与渲染器一起使用。有谁知道如何做到这一点？我是 Flex 和 ActionScript 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-02T19:58:02.150

您需要为 DataGrid 列实现一个 sortCompareFunction：

例如：

```
<mx:DataGridColumn headerText="Foo" dataField="bar" sortCompareFunction="compareTypes"> 
```

让我们假设这个 DataGridColumn 作为一个内联项渲染器......

然后函数定义如下：

```
public static function compareTypes(typeOne:Object, typeTwo:Object):int
{
    return ObjectUtil.stringCompare(String(typeOne.foo), String(typeTwo.foo));
} 
```

# c# - Object.GetType() 的性能

> ID：353342
> 
> 赞同：57
> 
> 时间：2008-12-09T16:20:25.857
> 
> 标签：c#, .net, performance

我们的应用程序中有很多日志记录调用。我们的记录器接受一个 System.Type 参数，因此它可以显示哪个组件创建了调用。有时，当我们被打扰时，我们会做类似的事情：

```
class Foo
{
  private static readonly Type myType = typeof(Foo);

  void SomeMethod()
  {
     Logger.Log(myType, "SomeMethod started...");
  }
 } 
```

因为这只需要获取一次 Type 对象。但是，我们对此没有任何实际指标。任何人都知道每次我们登录时调用 this.GetType() 可以节省多少？

（我意识到我自己可以毫无问题地做这些指标，但是，嘿，StackOverflow 有什么用？）

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2008-12-09T16:45:55.650

我强烈怀疑 GetType() 将花费比任何实际日志记录更少的时间。当然，您对 Logger.Log 的调用可能不会执行任何实际的 IO ......我仍然怀疑差异将是无关紧要的。

编辑：基准代码在底部。结果：

```
typeof(Test): 2756ms
TestType (field): 1175ms
test.GetType(): 3734ms 
```

这就是调用该方法 1*亿*次 - 优化获得了几秒钟左右的时间。我怀疑真正的日志记录方法还有很多工作要做，调用这 1 亿次总共会花费超过 4 秒的时间，即使它没有写出任何内容。（当然，我可能是错的 - 你必须自己尝试。）

换句话说，像往常一样，我会使用最易读的代码而不是微优化。

```
using System;
using System.Diagnostics;
using System.Runtime.CompilerServices;

class Test
{
    const int Iterations = 100000000;

    private static readonly Type TestType = typeof(Test);

    static void Main()
    {
        int total = 0;
        // Make sure it's JIT-compiled
        Log(typeof(Test)); 

        Stopwatch sw = Stopwatch.StartNew();
        for (int i = 0; i < Iterations; i++)
        {
            total += Log(typeof(Test));
        }
        sw.Stop();
        Console.WriteLine("typeof(Test): {0}ms", sw.ElapsedMilliseconds);

        sw = Stopwatch.StartNew();
        for (int i = 0; i < Iterations; i++)
        {
            total += Log(TestType);
        }
        sw.Stop();
        Console.WriteLine("TestType (field): {0}ms", sw.ElapsedMilliseconds);

        Test test = new Test();
        sw = Stopwatch.StartNew();
        for (int i = 0; i < Iterations; i++)
        {
            total += Log(test.GetType());
        }
        sw.Stop();
        Console.WriteLine("test.GetType(): {0}ms", sw.ElapsedMilliseconds);
    }

    // I suspect your real Log method won't be inlined,
    // so let's mimic that here
    [MethodImpl(MethodImplOptions.NoInlining)]
    static int Log(Type type)
    {
        return 1;
    }
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-12-09T16:46:08.177

该`GetType()`函数标有特殊属性`[MethodImpl(MethodImplOptions.InternalCall)]`。这意味着它的方法体不包含 IL，而是一个挂钩到 .NET CLR 的内部。在这种情况下，它查看对象元数据的二进制结构并`System.Type`围绕它构造一个对象。

**编辑：**我想我错了……

我说过：“因为`GetType()`需要构建一个新对象”，但这似乎是不正确的。不知何故，CLR 缓存`Type`并始终返回相同的对象，因此它不需要构建新的 Type 对象。

我基于以下测试：

```
Object o1 = new Object();
Type t1 = o1.GetType();
Type t2 = o1.GetType();
if (object.ReferenceEquals(t1,t2))
    Console.WriteLine("same reference"); 
```

因此，我不希望您的实施获得太多收益。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-09T16:46:53.090

我怀疑你会从 SO 那里得到一个令人满意的答案。原因是性能，尤其是这种类型的场景，是高度特定于应用程序的。

有人可能会发回一个快速秒表示例，就原始毫秒而言，该示例会更快。但坦率地说，这对您的应用程序没有任何意义。为什么？这在很大程度上取决于围绕该特定场景的使用模式。例如 ...

1.  你有几种类型？
2.  你的方法有多大？
3.  你是对每种方法都这样做，还是只对大方法这样做？

这些只是将极大地改变直接时间基准的相关性的几个问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-09-11T06:42:00.123

您是否考虑过使用[nameof](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/nameof)运算符？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-09T16:47:26.037

就应用程序性能而言，差异可能可以忽略不计。但是缓存类型的第一种方法应该更快。我们去测试一下。

此代码将向您展示差异：

```
using System;

namespace ConsoleApplicationTest {
    class Program {
        static void Main(string[] args) {

            int loopCount = 100000000;

            System.Diagnostics.Stopwatch timer1 = new System.Diagnostics.Stopwatch();
            timer1.Start();
            Foo foo = new Foo();
            for (int i = 0; i < loopCount; i++) {
                bar.SomeMethod();
            }
            timer1.Stop();
            Console.WriteLine(timer1.ElapsedMilliseconds);

            System.Diagnostics.Stopwatch timer2 = new System.Diagnostics.Stopwatch();
            timer2.Start();
            Bar bar = new Bar();
            for (int i = 0; i < loopCount; i++) {
                foo.SomeMethod();
            }
            timer2.Stop();
            Console.WriteLine(timer2.ElapsedMilliseconds);

            Console.ReadLine();
        }
    }

    public class Bar {
        public void SomeMethod() {
            Logger.Log(this.GetType(), "SomeMethod started...");
        }
    }

    public class Foo {
        private static readonly Type myType = typeof(Foo); 
        public void SomeMethod() { 
            Logger.Log(myType, "SomeMethod started..."); 
        }
    }

    public class Logger {
        public static void Log(Type type, string text) {
        }
    }
} 
```

在我的机器上，这给出了大约的结果。第一种方法需要 1500 毫秒，大约需要 1500 毫秒。秒为 2200 毫秒。

（代码和时间已更正 - 哦！）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-30T14:45:32.413

使用字段是最好的方法，它避免了由 typeof() 和 GetType() 引起的内部字典锁定，以保持唯一的引用。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2019-04-23T00:32:48.980

我得到非常不同的结果。
为此，我在另一个项目中创建了一个新的控制台应用程序，并使用了一个具有继承的类。

我创建了一个空循环来退出结果，以便进行清晰的比较。
我为循环创建了一个 const 和一个 static（手动切换要使用的）。
发生了一件非常有趣的事情。

使用 const 时，空循环会变慢，但缓冲的 var 测试会稍微快一些。
一个不应该影响或所有测试的更改，只影响 2.

每个测试的周期：100000000

使用静态周期：

```
对象.GetType：1316
类型（类）：1589
类型变量：987
空循环：799

清洁概述：
对象.GetType：517
类型（类）：790
类型变量：188

```

使用 const 循环：

```
对象.GetType：1316
类型（类）：1583
类型变量：853
空循环：1061

清洁概述：
对象.GetType：255
类型（类）：522
类型变量：-208

```

我多次运行这些，并进行了一些小的更改，并且循环次数增加了 10 倍，以降低后台进程影响结果的风险。结果与上述 2 几乎相同。

看起来确实`Object.GetType()`是`typeof(class)`.
缓冲的 var 似乎是`Object.GetType()`.

我是正确的应用程序，这不仅仅是微优化。
如果你在这里和那里牺牲一些小东西，它们的速度很容易比你制造的一件大东西快 30% 还要慢。

正如 JaredPar 所回答的那样，正如我们在这里所证明的那样，这些测试对于讲述您的特定应用程序是不可靠的。
我们所有的测试给出了完全不同的结果，以及看似与手头代码无关的东西，都会影响性能。

考试：

```
.NetCore 2.1
```

```
namespace ConsoleApp1
{
    class Program
    {
        public const int Cycles = 100000000;
        public static int Cycles2 = 100000000;
        public static QSData TestObject = new QSData();
        public static Type TestObjectType;

        static void Main(string[] args)
        {
            TestObjectType = TestObject.GetType();
            Console.WriteLine("Repeated cycles for each test : " + Cycles.ToString());

            var test1 = TestGetType();
            Console.WriteLine("Object.GetType : " + test1.ToString());
            var test2 = TestTypeOf();
            Console.WriteLine("TypeOf(Class)  : " + test2.ToString());
            var test3 = TestVar();
            Console.WriteLine("Type var       : " + test3.ToString());
            var test4 = TestEmptyLoop();
            Console.WriteLine("Empty Loop     : " + test4.ToString());

            Console.WriteLine("\r\nClean overview:");
            Console.WriteLine("Object.GetType : " + (test1 - test4).ToString());
            Console.WriteLine("TypeOf(Class)  : " + (test2 - test4).ToString());
            Console.WriteLine("Type var       : " + (test3 - test4).ToString());

            Console.WriteLine("\n\rPush a button to exit");
            String input = Console.ReadLine();
        }

        static long TestGetType()
        {
            var stopwatch = new Stopwatch();
            stopwatch.Start();
            for (int i = 0; i < Cycles; i++)
            {
                Type aType = TestObject.GetType();
            }
            stopwatch.Stop();
            return stopwatch.ElapsedMilliseconds;
        }

        static long TestTypeOf()
        {
            var stopwatch = new Stopwatch();
            stopwatch.Start();
            for (int i = 0; i < Cycles; i++)
            {
                Type aType = typeof(QSData);
            }
            stopwatch.Stop();
            return stopwatch.ElapsedMilliseconds;
        }

        static long TestVar()
        {
            var stopwatch = new Stopwatch();
            stopwatch.Start();
            for (int i = 0; i < Cycles; i++)
            {
                Type aType = TestObjectType;
            }
            stopwatch.Stop();
            return stopwatch.ElapsedMilliseconds;
        }

        static long TestEmptyLoop()
        {
            var stopwatch = new Stopwatch();
            stopwatch.Start();
            for (int i = 0; i < Cycles; i++)
            {
                Type aType;
            }
            stopwatch.Stop();
            return stopwatch.ElapsedMilliseconds;
        }
    }
} 
```

# xml - 解析多个xml文件，JDOM

> ID：353343
> 
> 赞同：0
> 
> 时间：2008-12-09T16:21:11.207
> 
> 标签：xml, dom

我正在创建一个 java 类，它将在目录中搜索 XML 文件。如果存在一些，它将使用 JDOM 来解析这些并创建由 XSLT 概述的简化输出。然后将其输出到另一个目录，同时保留原始 XML 的名称（即输入 XML 是“sample.xml”，输出 XML 也是“sample.xml”。

目前我可以读取指定的 XML 并将结果发送到指定的 XML，但是这对我将来没有太大/任何用处。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T19:19:56.307

将目录参数传递给程序，而不是文件参数。然后验证传递的参数是否真的是一个目录，列出所有文件，并处理每个文件。例如：

```
import java.io.File;
import java.io.FilenameFilter;

public class FileDemo {
    public static void main(String[] args) throws Exception {
        if (args.length != 1) {
            // print usage error
            System.exit(1);
        }

        File dir = new File(args[0]);
        if (!dir.isDirectory()) {
            // print usage error
            System.exit(1);
        }

        File[] files = dir.listFiles(new FilenameFilter() {
            public boolean accept(File dir, String name) {
                return name.toLowerCase().endsWith(".xml");
            }
        });

        for (File file : files) {
            // process file
            System.out.println("File: " + file.getAbsolutePath());
        }
    }
} 
```

# .net - .NET 提交在 Javascript onKeypress 之前触发

> ID：353353
> 
> 赞同：0
> 
> 时间：2008-12-09T16:26:56.983
> 
> 标签：.net, javascript, onkeypress

如果按下输入按钮，我正在尝试在输入类型 =“文本”控件上使用 onkeypress 来触发一些 javascript。它适用于大多数页面，但我也有一些带有自定义 .NET 控件的页面。

问题是 .NET 提交在 onkeypress 之前触发。有没有人知道如何让 onkeypress 首先触发？

如果有帮助，这是我的 javascript：

```
 function SearchSiteSubmit(myfield, e)
{
    var keycode;
    if (window.event)
        keycode = window.event.keyCode;
    else if (e)
        keycode = e.which;
    else 
        return true;
    if (keycode == 13)
    {
        SearchSite();
        return false;
    }
    else 
        return true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-09T16:31:01.327

Javascript`OnKeyPress`总是会首先触发，这更多的是在页面回发之前它是否已完成操作的情况。

我会说重新考虑发生了什么以及在哪里......服务器端发生了什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T16:39:09.407

这不是一个很明确的问题，所以我试一试——

看起来您在这里寻找“输入”的按键。问题似乎是“enter”键通常由浏览器自动绑定到表单上的提交按钮，这意味着当用户按下 enter 时，您提交表单，而不是运行您在此处拥有的 javascript。您应该做的是创建一个全局事件处理程序，检查“MyField”是否在按下回车按钮时具有焦点，如果是，则触发 javascript，而不是提交表单。我希望我理解你的问题！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T17:14:33.297

你是如何分配javascript的？

它应该看起来像：

```
<input id="TextID" type="text" onkeypress="return SearchSiteSubmit('TextID', event)" /> 
```

# sql-server - 为什么 DBCC SHRINKFILE 在数据库作业中工作不一致？

> ID：353354
> 
> 赞同：1
> 
> 时间：2008-12-09T16:27:40.100
> 
> 标签：sql-server, sql-server-2005, sql-agent-job, log-files

`DBCC SHRINKFILE`当我在日志文件上手动运行它时，它总是有效，即使我收到以下消息：

```
'Cannot shrink log file 2 (Claim_Log) because all logical log files are in use.' 
```

但是，当我从作业中运行它时，它只会将日志缩小大约三分之一的时间。其他时候，它仍然很大（大约 150Gb）。除了上面列出的错误之外，从来没有任何错误。这是我使用的语句：

```
DBCC SHRINKFILE (N'Claim_log' , 0, TRUNCATEONLY) 
```

我在作业步骤上启用了“在历史记录中包含步骤输出”。我还能做些什么来获得更多关于为什么这不起作用的信息？

编辑：这是日志中的完整消息：

```
'Executed as user: *. Cannot shrink log file 2 (Claim_Log) because all logical
log files are in use. [SQLSTATE 01000] (Message 9008)  DBCC execution completed. 
If DBCC printed error messages, contact your system administrator. [SQLSTATE 01000]
(Message 2528).  The step succeeded.' 
```

我已经尝试将用户踢出数据库并将其设置为单用户模式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-07-06T04:10:53.997

我最近解决了一个类似的问题，我发现在 sys.databases 中，log_reuse_wait_desc 等于“复制”。显然，这意味着 SQL Server 会等待复制任务完成，然后才能重用日志空间。

然而，复制从未在我们的数据库或我们的服务器上使用过。您应该能够通过运行“sp_removedbreplication”来清除状态；但是对我来说，“sp_removedbreplication”并没有解决问题。相反，SQL 只是返回说数据库不是复制的一部分......

我在这里找到了答案：

*   [http://www.sql-server-performance.com/forum/threads/log-file-fails-to-truncate.25410/](http://www.sql-server-performance.com/forum/threads/log-file-fails-to-truncate.25410/)
*   [http://blogs.msdn.com/b/sqlserverfaq/archive/2009/06/01/size-of-the-transaction-log-increasing-and-cannot-be-truncated-or-shrinked-due-to-快照复制.aspx](http://blogs.msdn.com/b/sqlserverfaq/archive/2009/06/01/size-of-the-transaction-log-increasing-and-cannot-be-truncated-or-shrinked-due-to-snapshot-replication.aspx)

基本上我必须创建一个复制，将所有复制指针重置为零；然后删除我刚刚进行的复制。IE

```
Execute SP_ReplicationDbOption {DBName},Publish,true,1
GO
Execute sp_repldone @xactid = NULL, @xact_segno = NULL, @numtrans = 0, @time = 0, @reset = 1
GO
DBCC ShrinkFile({LogFileName},0)
GO
Execute SP_ReplicationDbOption {DBName},Publish,false,1
GO 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T17:01:49.237

尝试先发出**CHECKPOINT**命令，然后缩小日志

取自 BOL ( [http://msdn.microsoft.com/en-us/library/aa226036(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa226036(SQL.80).aspx) )

强制将当前数据库的所有脏页写入磁盘。脏页是数据或日志页进入缓冲区缓存后被修改，但修改尚未写入磁盘。有关日志截断的更多信息，请参阅截断事务日志。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-29T05:18:05.290

表示当前日志文件正在使用并发出检查点，其中检查点将写入未从事务日志文件（脏页）写入数据文件的 datfile。检查是否有任何当前活动正在进行或没有，

检查使用 2005 年的活动交易 SELECT * FROM sys.dm_tran_session_transactions

2000 DBCC 登录

制定好计划=> 1.创建维护计划以备份日志（制定计划）。

# c# - .NET Winforms：运行时可以从我下面处理表单的句柄吗？

> ID：353355
> 
> 赞同：14
> 
> 时间：2008-12-09T16:27:54.937
> 
> 标签：c#, .net, windows, winforms, winapi

目前在[PInvoke.net上的](http://www.pinvoke.net/default.aspx/user32.SendMessage)[SendMessage](http://msdn.microsoft.com/en-us/library/ms644950(VS.85).aspx)声明是：

```
[DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = false)]
static extern IntPtr SendMessage(HandleRef hWnd, uint Msg, 
      IntPtr wParam, IntPtr lParam); 
```

**注意：** hWnd 不再是**IntPtr**，并且已替换为**HandleRef**。给出了对更改的非常宽松的解释：

> 您可以将“hWnd”替换为“IntPtr”而不是“HandleRef”。但是，您这样做是有风险的——它可能会导致您的代码在竞争条件下崩溃。.NET 运行时可以并且将会从您的消息下方处理您的窗口句柄 - 导致各种令人讨厌的问题！

有人 wiki 提出了一个后续问题：

> **问题：**最后一个问题不能用编组处理，特别是固定吗？

有人回答：

> **答：**您可以在 SendMessage() 之后使用 GC.KeepAlive()，并将 Form 对象作为 KeepAlive() 的参数。

所有这些“把你的表格放在你下面”对我来说似乎很奇怪。SendMessage 是一个*同步*调用。直到发送的消息被处理后才会返回。

这意味着可以随时销毁表单*句柄*。例如：

```
private void DoStuff()
{
   //get the handle
   IntPtr myHwnd = this.Handle;

   //Is the handle still valid to use?
   DoSomethingWithTheHandle(myHwnd); //handle might not be valid???

   //fall off the function
} 
```

这意味着窗口句柄在我使用它和方法结束之间可能会变得无效？

* * *

## 更新一

我理解一旦表单超出范围，它的句柄就无效的概念。例如：

```
private IntPtr theHandle = IntPtr.Zero;

private void DoStuff()
{
   MyForm frm = new MyForm())

   theHandle = frm.Handle;

   //Note i didn't dispose of the form.
   //But since it will be unreferenced once this method ends
   //it will get garbage collected,
   //making the handle invalid
} 
```

对我来说很明显，一旦 DoStuff 返回，表单的句柄就无效了。无论采用何种技术，情况都是如此 - 如果表单不在某个范围内，则使用无效。

我不同意（todo link guy），因为在收到所有发送消息之前，表单会一直存在。CLR 不知道谁可能获得了我的窗体的窗口句柄，也无法知道将来谁*可能*调用 SendMessage()。

换句话说，我无法想象这样的呼唤：

```
IntPtr hWnd = this.Handle; 
```

现在将防止*它*被垃圾收集。

* * *

## 更新二

我无法想象有一个窗口句柄可以防止表单被垃圾收集。IE：

```
Clipboard.AsText = this.Handle.ToString();
IntPtr theHandle = (IntPtr)(int)Clipboard.AsText; 
```

* * *

## 回答

但这些都是无关紧要的——最初的问题仍然是：

> 运行时可以从我下面处理表单的句柄吗？

事实证明，答案是否定的。运行时不会从我下面处理表单。它将处理未引用*的*表单-但未引用的表单不​​在我的范围内。“在我之下”意味着我有对表格的引用。

另一方面，一个 Form 对象的底层 Windows 窗口句柄可以从我下面被销毁（真的怎么可能不 - 窗口句柄不被引用计数 - 也不应该）：

```
IntPtr hwnd = this.Handle;
this.RightToLeft = RightToLeft.Yes;
//hwnd is now invalid 
```

同样重要的是要注意 HandleRef 不会帮助防止在 Windows 窗口句柄周围创建对象包装器所导致的问题：

**原因 1** 如果一个表单对象被销毁是因为你没有对它的引用——那么你只是愚蠢地试图与一个按权利不应该存在的表单交谈。仅仅因为 GC 还没有解决它并不能让你变得聪明——它会让你幸运。HandleRef 是一种保持对表单的引用的技巧。而不是使用：

```
HandleRef hr = new HandleRef(this, this.Handle);
DoSomethingWithHandle(this.Handle); 
```

您可以轻松使用：

```
Object o = this;
DoSomethingWithHandle(this.Handle); 
```

**原因 2** HandleRef 不会阻止表单重新创建它的底层窗口句柄，例如：

```
HandleRef hr = new HandleRef(this, this.Handle);
this.RightToLeft = RightToLeft.Yes;
//hr.Hande is now invalid 
```

因此，虽然 P/Invoke 上的 SendMessage 的原始修饰符确实指出了一个问题，但他的解决方案并不是解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T16:48:09.967

通常，当您调用时`SendMessage`，您是从另一个线程或至少另一个与您的 Form 分开的组件中调用的。我假设要提出的观点是，仅仅因为您有一个 IntPtr 曾经包含一个有效的窗口句柄，您不能假设它仍然是有效的。

假设你有这门课：

```
class MyClass {
   IntPtr hwnd;
   public MyClass(IntPtr hwnd) {
      this.hwnd = hwnd;
   }
   ...

   private void DoStuff()
   {
       //n.b. we don't necessarily know if the handle is still valid
       DoSomethingWithTheHandle(hwnd);
   }
} 
```

和其他地方：

```
 private void DoOtherStuff() {
     Form f = new Form();
     mc = new MyClass(f.Handle);
 } 
```

然后因为`f`已经超出范围，它`Dispose`最终会被 GC 终结器调用。这就是为什么您可能需要`Gc.KeepAlive`在这种情况下使用。`f`必须保持活动状态`mc`，直到手柄完成。

# iphone - iPhone 上的应用程序设置有多安全？

> ID：353361
> 
> 赞同：1
> 
> 时间：2008-12-09T16:29:08.537
> 
> 标签：iphone, cocoa-touch, configuration

似乎每个应用程序都可以访问自己的配置设置，这些设置可以在应用程序关闭后保留。我想知道是否可以从其他应用程序访问一个应用程序的配置设置。

我应该将密码等敏感数据保存到应用程序配置中吗？

有没有更好的办法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-09T16:50:18.323

钥匙串是保存密码或其他敏感信息的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T00:53:35.230

Buzz Andersen 的代码可以在模拟器和 iPhone 上正确获取和设置钥匙串密码：[SFHFKeychainUtils](http://log.scifihifi.com/post/55837387/simple-iphone-keychain-code)。

# memory - -XX:+HeapDumpOnOutOfMemoryError 选项是否适用于 Oracle 应用服务器？

> ID：353371
> 
> 赞同：2
> 
> 时间：2008-12-09T16:30:55.913
> 
> 标签：memory, jakarta-ee, profiling, oc4j

我们有时会在生产中遇到 OutOfMemoryError，我希望能够分析导致问题的原因，或者至少分析发生问题时发生的情况。似乎我应该能够通过使用 -XX:+HeapDumpOnOutOfMemoryError 选项来获得 HProf 配置文件，但我已经读到这是特定于 JVM 的。

是否有人成功将此选项与 Oracle 应用服务器 v10.1.2.0.2 一起使用？如果是这样，您对如何分析生成的文件有任何提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-08T21:57:41.407

Oracle OC4J 已通过 Sun JVM 1.3.1 和 1.4.2 认证（请参阅[此 PDF](http://www.oracle.com/technology/tech/java/oc4j/1012/collateral/OC4J-FAQ-101202.pdf)）。

-XX:+HeapDumpOnOutOfMemoryError 选项是在 Java 6 中引入的，并向后移植到 Java 5.0 更新 7 和 Java 1.4.2 更新 2。因此，为了使用此选项，您应该在其中一个 JVM 上运行 OC4J。

要分析 hprof 内存转储，您可以使用大量工具，例如 Eclipse Memory Analyzer（包含在 Eclipse 3.5 Galileo 中）、VisualVM 或 NetBeans。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T09:14:52.330

此选项特定于 SUN/SAP/HP JVM，如果您使用 JRockit VM，我怀疑它是否会起作用。JRockit 也可能根本不支持 hprof 格式，因为它不是 Java 规范所要求的。

您可能想检查一下[Yourkit](http://www.yourkit.com/faq/index.jsp#jrockit)，这是我知道的唯一一个接近[Eclipse Memory Analyzer](http://www.eclipse.org/mat) for [memory usage analysis](http://kohlerm.blogspot.com/search/label/memory)的工具。它似乎支持JRockit。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T11:25:34.787

是的，这取决于您的 JVM 版本。一些 JVM 似乎不支持 -XX:+HeapDumpOnOutOfMemoryError 参数。

# java - 如何从struts form beans创建值对象？

> ID：353376
> 
> 赞同：0
> 
> 时间：2008-12-09T16:32:20.373
> 
> 标签：java, struts

我需要从 struts form beans 创建值对象。使用 Bean Utils 或手动创建 VO 是个好主意吗？

有人遇到过bean utils的任何问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T20:47:56.520

值对象不是由开发者创建的，而是由struts框架软件自动创建的，表单bean类在其中扮演创建它的角色。

****定义：****当大量数据从一层传输到另一层时，可以作为多个编号的单个值传输。次。建议将所有这些值组合成一个值对象，然后转移到另一层，可以存储多个值的单个对象的特殊类称为值对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T07:13:03.247

I have never faced any issues in using BeanUtils. It is always a good idea to use BeanUtils to get this job done as we can avoid rewriting code for this.

# php - 如何从PHP中的URL获取多个同名参数

> ID：353379
> 
> 赞同：47
> 
> 时间：2008-12-09T16:33:12.540
> 
> 标签：php, url, parameters

我有一个 PHP 应用程序，有时必须处理 URL 中多个参数具有相同名称的 URL。有没有一种简单的方法可以检索给定键的所有值？PHP $_GET 只返回最后一个值。

具体来说，我的应用程序是一个 OpenURL 解析器，并且可能会获取如下 URL 参数：

```
ctx_ver=Z39.88-2004
&rft_id=info:oclcnum/1903126
&rft_id=http://www.biodiversitylibrary.org/bibliography/4323
&rft_val_fmt=info:ofi/fmt:kev:mtx:book
&rft.genre=book
&rft.btitle=At last: a Christmas in the West Indies. 
&rft.place=London,
&rft.pub=Macmillan and co.,
&rft.aufirst=Charles
&rft.aulast=Kingsley
&rft.au=Kingsley, Charles,
&rft.pages=1-352
&rft.tpages=352
&rft.date=1871 
```

（是的，我知道这很丑，欢迎来到我的世界）。请注意，键“rft_id”出现了两次：

1.  `rft_id=info:oclcnum/1903126`
2.  `rft_id=http://www.biodiversitylibrary.org/bibliography/4323`

`$_GET`将返回 just `http://www.biodiversitylibrary.org/bibliography/4323`，较早的值 ( `info:oclcnum/1903126`) 已被覆盖。

我想访问这两个值。这在PHP中可能吗？如果没有，关于如何处理这个问题的任何想法？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-12-09T16:46:20.717

就像是：

```
$query  = explode('&', $_SERVER['QUERY_STRING']);
$params = array();

foreach( $query as $param )
{
  // prevent notice on explode() if $param has no '='
  if (strpos($param, '=') === false) $param += '=';

  list($name, $value) = explode('=', $param, 2);
  $params[urldecode($name)][] = urldecode($value);
} 
```

给你：

```
array(
  'ctx_ver'     => array('Z39.88-2004'),
  'rft_id'      => array('info:oclcnum/1903126', 'http://www.biodiversitylibrary.org/bibliography/4323'),
  'rft_val_fmt' => array('info:ofi/fmt:kev:mtx:book'),
  'rft.genre'   => array('book'),
  'rft.btitle'  => array('At last: a Christmas in the West Indies.'),
  'rft.place'   => array('London'),
  'rft.pub'     => array('Macmillan and co.'),
  'rft.aufirst' => array('Charles'),
  'rft.aulast'  => array('Kingsley'),
  'rft.au'      => array('Kingsley, Charles'),
  'rft.pages'   => array('1-352'),
  'rft.tpages'  => array('352'),
  'rft.date'    => array('1871')
) 
```

由于总是有可能重复一个 URL 参数，因此最好始终使用数组，而不是仅针对您预期的那些参数。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-12-09T16:41:02.960

对您不起作用，因为您似乎无法控制查询字符串，但另一个有效答案是：您可以将“[]”添加到名称的末尾，而不是解析查询字符串，然后 PHP 将创建一个数组项目。

IE：

```
someurl.php?name[]=aaa&name[]=bbb 
```

会给你一个 $_GET 看起来像：

```
array(0=>'aaa', 1=>'bbb') 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-09T16:37:55.790

我认为您必须`$_SERVER['QUERY_STRING']`手动解析。

类似（未经测试）：

```
$query = $_SERVER['QUERY_STRING'];
$vars = array();
foreach (explode('&', $query) as $pair) {
    list($key, $value) = explode('=', $pair);
    $vars[] = array(urldecode($key), urldecode($value));
} 
```

这应该给你一个数组`$vars`：

```
array(
    array('ctx_ver'     => 'Z39.88-2004'),
    array('rft_id'      => 'info:oclcnum/1903126'),
    array('rft_id'      => 'http://www.biodiversitylibrary.org/bibliography/4323'),
    array('rft_val_fmt' => 'info:ofi/fmt:kev:mtx:book'),
    array('rft.genre'   => 'book'),
    array('rft.btitle'  => 'At last: a Christmas in the West Indies.'),
    array('rft.place'   => 'London'),
    array('rft.pub'     => 'Macmillan and co.'),
    array('rft.aufirst' => 'Charles'),
    array('rft.aulast'  => 'Kingsley'),
    array('rft.au'      => 'Kingsley, Charles'),
    array('rft.pages'   => '1-352'),
    array('rft.tpages'  => '352'),
    array('rft.date'    => '1871')
) 
```

* * *

在看到[Tomalak 的](https://stackoverflow.com/questions/353379/how-to-get-multiple-parameters-with-same-name-from-a-url-in-php#353437)回答后，我更喜欢他的结果数组的数据格式，因为它可以通过名称访问特定的键。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-09-21T17:34:13.097

无需为此使用`explode`解决方法。一个简单的正则表达式可以更容易地纠正具有多个同名参数的 QUERY_STRING：

```
// Replace `&x=1&x=2` into `x[]=1&x[]=2`
$qs = preg_replace("/(?<=^|&)(\w+)(?==)/", "$1[]", $_SERVER["QUERY_STRING"]); 
```

然后它就像使用一样简单[`parse_str`](http://php.net/parse_str)：

```
parse_str($qs, $new_GET); 
```

其优点是可以`%xy`立即正确解码 URL 转义。

如果您只想将单个或几个特定参数提取为数组，请在正则表达式中使用`(id|name)`而不是。`(\w+)`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-09T16:38:55.303

AFAIK 无法获取重复值，`$_GET`因为第二个值将覆盖第一个值

要绕过它，您可以使用访问原始查询字符串`$_SERVER['QUERY_STRING']`，然后自己解析它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-04T16:18:47.773

假设你有一个这样的查询字符串：

> param1=2549&appname=appName1&appname=appName2&appname=appName3&appname=appName4&appname=appName5&apptype=thetype&idsess=1231324567980147dzeze55sd4&action=myaction

你可以这样做 ：

```
public static function getMultipleParameters()
    {
        $query = $_SERVER['QUERY_STRING'];
        $vars = array();
        $second = array();
        foreach (explode('&', $query) as $pair) {
            list($key, $value) = explode('=', $pair);
            if('' == trim($value)){
                continue;
            }

            if (array_key_exists($key, $vars)) {
                if (!array_key_exists($key, $second))
                    $second[$key][] .= $vars[$key];
                $second[$key][] = $value;
            } else {
                $vars[$key] = urldecode($value);
            }
        }
        return array_merge($vars, $second);
    } 
```

这给出了：

```
array (
  'param1' => '2549',
  'appname' => 
      array (
        0 => 'appName1',
        1 => 'appName2',
        2 => 'appName3',
        3 => 'appName4',
        4 => 'appName5',
  ),
  'apptype' => 'thetype',
  'idsess' => '1231324567980147dzeze55sd4',
  'action' => 'myaction',
); 
```

希望有帮助；）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-05-09T14:21:47.817

分享我的这个函数的版本

```
function parse_mstr($query_string,&$query=array()){
    $query = $query? $query: array();
    $params  = explode('&', $query_string);
    foreach( $params as $param ){
        $k = $param;
        $v = '';
        if(strpos($param,'=')){
            list($name, $value) = explode('=', $param);
            $k = rawurldecode($name);
            $v = rawurldecode($value);
        }
        if(array_key_exists($k, $query)){
            if(is_array($query[$k])){
                $query[$k][] = $v;
            }else{
                $query[$k] = array($query[$k],$v);
            }
        }else{
            $query[$k] = $v;
        }
    }
}

// usage
parse_mstr('a=1&a=2&b=3', $arr);

// resulting array
$arr = [
    'a' => ['1', '2'],
    'b' => '3'
] 
```

# lines-of-code - 有没有一种标准的方法来计算代码行数？

> ID：353380
> 
> 赞同：14
> 
> 时间：2008-12-09T16:33:44.923
> 
> 标签：lines-of-code

我意识到这个问题没有绝对“正确”的答案，但是当人们谈论代码行时，它们是什么意思？例如，在 C++ 中，你计算空行吗？评论？只有开括号或闭括号的行？

我知道有些人使用代码行作为生产力衡量标准，我想知道这里是否有标准约定。另外，我认为有一种方法可以让各种编译器计算代码行数——那里有标准约定吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-09T16:38:31.593

不，没有标准约定，每个计算它们的工具都会略有不同。

这可能会让您问：“那我为什么要使用 LOC 作为生产力衡量标准呢？” 答案是，因为你如何计算一行代码并不重要，只要你一致地计算它们，你就可以对一个项目相对于其他项目的总体规模有所了解。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-09T16:40:31.043

查看[Wikipedia 文章](http://en.wikipedia.org/wiki/Source_lines_of_code)，尤其是“[测量 SLOC](http://en.wikipedia.org/wiki/Source_lines_of_code#Measuring_SLOC) ”部分：

> 有两种主要类型的 SLOC 度量：物理 SLOC 和逻辑 SLOC。这两种度量的具体定义各不相同，但物理 SLOC 最常见的定义是程序源代码文本中的行数，包括注释行。除非一节中的代码行包含超过 25% 的空行，否则空行也包括在内。在这种情况下，超过 25% 的空白行不计入代码行数。
> 
> 逻辑 SLOC 度量试图度量“语句”的数量，但它们的具体定义与特定的计算机语言相关（对于类 C 编程语言的一个简单的逻辑 SLOC 度量是语句终止分号的数量）。创建测量物理 SLOC 的工具要容易得多，并且物理 SLOC 定义更容易解释。但是，物理 SLOC 度量对逻辑上不相关的格式和样式约定敏感，而逻辑 SLOC 对格式和样式约定不太敏感。不幸的是，SLOC 度量通常在没有给出定义的情况下被陈述，并且逻辑 SLOC 通常与物理 SLOC 有很大不同。
> 
> 考虑以下 C 代码片段作为确定 SLOC 时遇到的歧义的示例：
> 
> ```
> for (i=0; i<100; ++i) printf("hello");   /* How many lines of code is this? */ 
> ```
> 
> 在这个例子中，我们有：
> 
> *   1 物理代码行 LOC
> *   2 逻辑代码行 lLOC（for 语句和 printf 语句）
> *   1 条评论行
> 
> [...]

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-09T16:37:03.047

我会说

*   评论数
*   空行很重要，因为它们对可读性很重要，但连续不超过一个
*   带大括号的行也算，但应用与空行相同的规则 - 即 5 个嵌套大括号之间没有代码算作一行。

我还谦虚地建议，任何实际上依赖于 LoC 值的生产力衡量标准都是愚蠢的 :)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-09T16:36:23.077

无论“wc -l”返回什么都是我的号码。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-09T20:54:22.543

任何一天我可以用更少的代码行结束，但有更多或更多的工作功能......是美好的一天。能够删除数百行代码并最终得到功能相同且更易于维护的东西，这是一件很棒的事情。

话虽如此，除非您的团队中有非常严格的编码准则，否则物理代码行数是无用的统计数据。逻辑代码行仍然没有用，但至少它不会产生危险的误导。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-09T16:42:35.203

“代码行”应包括您必须维护的任何内容。这包括注释，但不包括空格。

如果您将此用作生产力指标，请确保您进行了合理的比较。一行 C++ 与一行 Ruby 不同。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-09T16:50:45.593

如果你使用 LOC 作为生产力的衡量标准，你会突然发现你的程序员写得更加冗长以“玩弄系统”。这是一个愚蠢的措施，只有愚蠢的人才会用它来炫耀。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-09T19:19:36.010

1 行 = 4 秒的阅读时间。如果需要更多的时间来弄清楚我在那条线上所说的话，那这条线就太长了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-09T16:52:35.137

LOC 是一个出了名的模棱两可的指标。对于详细的比较，它仅在比较由同一团队以相同语言、相同风格编写的代码时才有效。

但是，当从数量级的想法来看时，它确实提供了一定的复杂性概念。10000 行程序比 100 行程序复杂得多。

LOC 的优点是 wc -l 返回它，与许多其他软件指标不同，在理解或计算它时没有真正的花哨。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-09T17:17:27.003

没有正确的答案。

对于非正式的估计，我使用 wc -l。

如果我需要严格衡量某些东西，我会衡量可执行语句。几乎所有带有语句终止符（通常是分号）或以块结尾的东西。对于复合语句，我会计算每个子语句。

所以：

```
int i = 7;                  # one statement terminator; one (1) statement
if (r == 9)                # count the if as one (1) statement
  output("Yes");      # one statement terminator; one (1) statement; total (2) for the if
while (n <= 14) {    # count the while as one (1) statement
  output("n = ", n);  # one statement terminator; one (1) statement
  do_something();   # one statement terminator; one (1) statement
  n++                       # count this one, one statement (1), even though it doesn't need a statement terminator in some languages
}                              # brace doesn't count; total (4) for the while 
```

如果我在 Scheme 或 Lisp 中做这件事，我会计算表达式。

正如其他人所说，最重要的是您的计数是一致的。您将其用于什么也很重要。如果您只想让潜在的新员工知道您的项目有多大，请使用 wc -l。如果你想做计划和估计，那么你可能想要更正式一些。在任何情况下，您都不应该使用 LOC 来作为程序员薪酬的基础。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-09T17:25:14.337

您应该考虑“*花费*的代码行”，而不是“*产生*的代码行”。

事情应该尽可能简单，因此基于行数创建一个积极的基准会鼓励糟糕的代码。

此外，一些非常困难的事情最终可以用很少的代码解决，而一些非常容易的事情（例如 getter 和 setter 的样板代码）可以在很短的时间内添加很多行。

至于最初的问题，如果我要计算行数，我会包括连续空行以外的每一行。我也会包含评论，因为它们（希望）是有用的文档。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-09T20:12:06.590

LOC 的概念是尝试量化代码量。正如其他答案中所指出的，只要您保持一致，您具体调用代码行的内容并不重要。直观地说，似乎一个 10 行程序小于一个 100 行程序，它小于一个 1000 行程序等等。您会期望创建、调试和维护 100 行程序比 1000 行程序花费更少的时间。至少非正式地，您可以使用 LOC 大致了解创建、调试和维护特定大小的程序所需的工作量。

当然，也有不成立的地方。例如，用 1000 行呈现的复杂算法可能比使用 2500 行的简单数据库程序更难开发。

因此，LOC 是一种粗粒度的代码量度量，它使管理人员能够合理地了解问题的大小。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-09T16:38:12.980

1.  **LOCphy：**物理线
2.  **LOCbl:** Blanklines Kommentarblocks werden 饰演 Kommentarzeile gezählt
3.  **LOCpro：**编程线（声明、定义、指令和代码）
4.  **LOCcom：**评论行

许多可用的工具都提供了填充线的百分比等信息。

你只需要看看它，但不要只指望它。

LOC 在项目开始时大幅增长，并且在审查后经常减少；）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-09T16:39:13.603

我认为它是一个单一的可处理语句。例如

(1 行)

```
Dim obj as Object 
```

(5 行)

```
If _amount > 0 Then
  _amount += 5
Else
  _amount -= 5
End If 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-09T19:09:24.643

我同意那些说它以多种方式报告并且不是重要指标的帖子。看到这个[ever-hear-of-developers-getting-paid-paid-per-line-of-code](https://stackoverflow.com/questions/299647/ever-hear-of-developers-getting-paid-per-line-of-code)。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-09T19:59:15.697

我同意 Craig H 接受的答案，但是我想补充一点，在学校里，我被教导说，在衡量代码行数时，不应将空格、注释和声明算作“代码行数”由程序员出于生产力目的而制作 - 即“每天 15 行”规则。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-21T23:44:28.120

我`wc -l`用于快速估计工作空间的复杂性。但是，作为生产力指标 LOC 是***最差的***。如果我的 LOC 计数下降，我通常认为这是非常有成效的一天。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-19T22:15:14.503

> 我知道有些人使用 LoC 作为生产力衡量标准

你能告诉我他们是谁，这样我就不会意外地和他们一起工作（或者更糟的是，*为*他们工作）吗？

如果我可以使用 Haskell 在 1400 行中实现我也可以使用 C 在 2800 行中实现，那么我在 C 或 Haskell 中的效率更高吗？哪个需要更长的时间？哪个会有更多的错误（提示：它在 LOC 计数中是线性的）？

程序员的价值在于他的代码更改（包括从空字符串更改或更改为空字符串）增加了您的底线数字。我知道没有好的方法来衡量或近似它。但我知道任何可以合理衡量的指标都可以被玩弄，并不能反映你真正想要的。所以不要使用它。

话虽如此，您如何计算 LOC？很简单，用`wc -l`。为什么这是正确的工具？好吧，您可能不关心任何特定的数字，而是关心总体总体趋势（上升或下降，以及多少）、个别趋势（上升或下降、改变方向的速度……）以及除了数字 82,763 之外，几乎所有内容。

工具测量的内容之间的差异可能并不有趣。*除非您有证据表明您的工具（并且只有*该工具）吐出的数字与有趣的事物相关，否则将其用作粗略的大致数字；除了单调性之外，任何东西都应该不仅与一粒谷物一起服用，还应与一桶盐一起服用。

计算发生了多少次`'\n'`。其他有趣的字符可能是`';'`,`'{'`和`'/'`。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-12-12T18:12:58.137

**在 .NET 世界**中，似乎有一个全球性的协议，即**一行代码 (LoC) 是一个调试序列点**。序列点是一个调试单元，它是放置断点时以深红色突出显示的代码部分。使用序列点，我们可以谈论**逻辑 LoC**，并且可以在各种 .NET 语言之间比较该指标。大多数 .NET 工具都支持逻辑 LoC 代码度量，包括 VisualStudio 代码度量、NDepend 或 NCover。

一种 8 LoC 方法（不考虑开始和结束括号序列点）：

![替代文字](https://i.stack.imgur.com/56GAg.jpg)

与物理 LoC（仅计算源文件中的行数）相反，逻辑 LoC 具有不依赖于编码风格的巨大优势。我们都同意，编码风格可以使物理 LoC 计数从一个开发人员到另一个开发人员变化一个数量级。我写了一篇关于这个主题的更详细的博客文章：[你如何计算你的代码行数（LOC）？](http://codebetter.com/blogs/patricksmacchia/archive/2007/10/03/how-do-you-count-your-number-of-lines-of-code-loc.aspx)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-09-02T00:40:11.133

用 LOC 来衡量一个程序员的表现，就像是根据一幅画的大小来判断一幅画的好坏。就我而言，LOC 的唯一“价值”是给您的客户留下深刻印象并吓跑您的竞争对手。

也就是说，我认为编译指令的数量是最不模糊的。尽管如此，糟糕的程序员的优势在于他们倾向于编写不必要的冗长代码。我记得曾经用 28 行代码替换了 800 多行非常糟糕的代码。这会让我变得懒惰吗？

任何使用 LOC 作为主要性能指标的项目经理都是白痴，应该得到糟糕的程序员。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-12-21T12:38:49.317

我强烈推荐 cloc 工具来完成这项工作。它计算了许多语言的行数。

[https://github.com/AlDanial/cloc#quick-start-](https://github.com/AlDanial/cloc#quick-start-)

我为我们公司使用过并且喜欢这个工具。我将分享来自输出的 ss；

[![从时钟输出](https://i.stack.imgur.com/aiiJg.png)](https://i.stack.imgur.com/aiiJg.png)

# c# - 初学者 WCF 问题 - 可消耗的异步服务

> ID：353383
> 
> 赞同：4
> 
> 时间：2008-12-09T16:34:21.053
> 
> 标签：c#, .net, wcf, soa

这是一个更多的“可以完成”而不是“如何完成”的问题。我正在考虑构建一个服务（中间层，.net，提供数据抽象和一些业务逻辑），供不同平台上的多个内部客户端系统使用。例如，一个客户端可能是一个网站，另一个客户端一些 java 代码，另一个客户端 C# 等。

我想在我的服务中提供同步和异步 API，例如 GetData、BeginGetData、EndGetData 方法。我还希望客户能够注册新“数据”被添加到系统的通知。过去，我使用带有 Tibco EMS 通道的 Web 服务来实现这一点。

我的问题是：我能否通过公开 WCF 服务来实现这三个要求（同步、异步和发布/订阅）？非 WCF 客户端可以使用此服务吗？

原谅这个问题含糊不清 - 我可以根据需要详细说明。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T18:25:29.410

默认情况下，方法是同步的。要使它们异步，您需要添加此属性 [OperationContract(AsyncPattern=true)] 并返回一个 IAsynchResult，就像您使用 Winform 执行 BeginIvoke() 一样。（在这里阅读更多[http://msdn.microsoft.com/en-us/library/ms734701.aspx](http://msdn.microsoft.com/en-us/library/ms734701.aspx)）

您可以使用称为回调合同的东西进行发布/订阅（尽管我不确定在其他平台上实现此功能）我对这些没有太多经验，但它们似乎并不十分复杂（您可以在此处阅读更多信息[http： //dotnetaddict.dotnetdevelopersjournal.com/wcf_alarmclock.htm](http://dotnetaddict.dotnetdevelopersjournal.com/wcf_alarmclock.htm) )

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T15:47:33.957

在您的 WCF 服务上设置异步操作可以通过设置 AsyncPattern=true 来像 Ninja 发布的那样完成，也可以通过设置正确的命令行参数或通过检查“生成”告诉 svcutil 生成异步端点来在客户端完成svcutil 的 GUI 版本中的“异步操作”选项。生成异步仍然会生成同步操作。

客户端异步选项的问题是您需要在 Java 中复制代码。Svcutil 确实会按照您的指定导出 VB 或 C# 代码，因此您很可能无需太多工作就可以将 C# 代码转换为 Java。

对于 Pub/Sub，客户端回调是您想要操作的方式。我正在使用它们，它们工作得很好。在根级别，它们是.Net Remoting 并使用事件将数据传递给客户端（我的理解）。我无法确认这可以跨平台使用，但应该进行一些工作。

# glassfish - 如何使用 jtracert 分析在 Glassfish 上运行的应用程序？

> ID：353392
> 
> 赞同：0
> 
> 时间：2008-12-09T16:36:06.697
> 
> 标签：glassfish, sequence-diagram, jtracert

我想使用[jtracert](http://code.google.com/p/jtracert/)生成正在运行的 java ee 应用程序的序列图。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T08:52:39.370

项目主页上有“快速入门”一章：[http ://code.google.com/p/jtracert/](http://code.google.com/p/jtracert/)

简而言之： 1\. 安装 SDEdit（完全免费）[http://sdedit.sourceforge.net/](http://sdedit.sourceforge.net/) 2\. 打开 SDEdit 3\. 在菜单 Extras 中选择 Item Start/stop RT server 4\. 输入您喜欢的任何端口，然后按 ok 5\. 将以下参数添加到您的应用程序启动中： -DanalyzerOutput=sdEditRtClient -DsdEditHost=127.0.0.1 -DsdEditPort=60001 -javaagent:jTracert.jar

您应该指定这些参数的位置取决于您的应用程序服务器。

下面举几个例子。请注意，您应该将 jTracert.jar 替换为真实的 jar 名称，例如 jTracert-0.0.3.jar！

**网络逻辑 9+**

视窗

文件：%DOMAIN_HOME%\bin\startWeblogic.cmd。添加以下行：

设置 JAVA_OPTIONS=-DanalyzerOutput=sdEditRtClient -DsdEditHost=127.0.0.1 -DsdEditPort=60001 -javaagent:jTracert.jar %JAVA_OPTIONS%

Linux

文件：$DOMAIN_HOME\bin\startWeblogic.sh。添加以下行：

JAVA_OPTIONS="-DanalyzerOutput=sdEditRtClient -DsdEditHost=127.0.0.1 -DsdEditPort=60001 -javaagent:jTracert.jar $JAVA_OPTIONS"

**玻璃鱼 V2**

视窗和 Linux

文件：%DOMAIN_HOME%\config\domain.xml

搜索 jvm-options 元素并添加元素 -DanalyzerOutput=sdEditRtClient -DsdEditHost=127.0.0.1 -DsdEditPort=60001 -javaagent:jTracert.jar 照常启动域。

# .net - 用户是否需要特殊权限才能使用 LoadFromSqlServer 调用包？

> ID：353398
> 
> 赞同：1
> 
> 时间：2008-12-09T16:37:13.687
> 
> 标签：.net, sql-server, ssis

使用 LoadFromSqlServer 调用 SSIS 包（C# 应用程序）时，用户帐户是否必须对数据库或服务器具有任何特殊权限？

我目前似乎无法在 EM 中查看包裹...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T08:21:30.460

您需要向需要运行 SSIS 包的用户授予一些权限。

[此页面](http://sqljunkies.com/WebLog/knight_reign/archive/2006/01/05/17769.aspx)应提供您需要的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T18:51:07.627

我不知道确切的答案，但是从哪里运行 SSIS 包很重要。如果我从 Visual Studio 运行它，它会使用我的帐户和权限。如果我将它加载到服务器并尝试直接运行包，它正在使用其他东西（并且通常会失败，因为我们的服务器设置方式）。如果我从服务器上的作业运行它，它将使用服务器 SQA 帐户，并具有该帐户的权限。

# c# - 必须单击两次才能在 ASP.NET 中展开 DropDownList

> ID：353414
> 
> 赞同：2
> 
> 时间：2008-12-09T16:39:35.787
> 
> 标签：c#, .net, asp.net, drop-down-menu

我继承了一个 ASP.NET 2.0 项目，我注意到的一件事是用户必须单击`dropdownlist`两次才能展开它 - 为什么会这样？

**事件顺序**

1.  第一次单击赋予控件焦点，第二次单击将展开它。
2.  该应用程序使用 Master/Content 页面并且启用了 Ajax。

看起来这在 IE6 中没有发生，但在 IE7 中确实发生了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T11:53:36.800

找到它并对其进行排序（暂时）。

问题是由用户控件插入的 Javascript 函数引起的，该函数正在向 DropDownLists 添加样式。为什么这不是在 CSS 中完成的，我不知道（但很快就会），但注释掉以下函数解决了我的问题：

```
 function inputOnFocus(objInput)
    {
        objInput.style.backgroundColor = sHighLightBgColor;
        objInput.style.border = sBorderHighlight;

        //objInput.className = "inputOnFocus";
        sIDWithFocus = objInput.id;
    } 
```

我不太确定如何/为什么将其应用于某些 DDL 而不是其他 DDL，但目前（即将推出客户演示）我并不在乎 - 我会在有机会时深入研究。

感谢@LFSR Consulting、@Scott Evernden 和@kogus 的意见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T17:02:04.493

dunno if this is the best solution and haven't tried it .. but how about setfocus at onload() to the control in question ?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T17:17:15.600

If you're using IE7 and using the onFocus event for those drop downs take a look at this:

[http://forums.asp.net/p/1049119/1479078.aspx#1479078](http://forums.asp.net/p/1049119/1479078.aspx#1479078)

Otherwise might I suggest taking a look at:

*   is a call being made to the server onFocus, wherein IsPostBack is not handled properly on the Page_Load?*   draws a blank for any other ideas...

    Can you throw some code up so we can take a look?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-29T20:13:03.843

我知道我在旧帖子上发帖；但是，我想在这方面分享我的两分钱，因为它可能会在未来对任何人有所帮助。

我最近在做一个快速表单，想用黄色突出显示用户会去的所有字段，当焦点丢失时显然会变回白色。

没有进入代码，因为我没有使用 ASP.NET，只是 javascript 部分......我为解决这个问题所做的就是为 onmousedown 创建另一个事件。通过仅使用 onfocus 部分，我不得不在下拉框中单击两次。一次设置焦点，另一次单击并列出项目。通过添加 onmousedown 功能，它允许我在单击以及选项卡或其他形式的焦点转移时发生颜色变化。

当然，不需要有对应物，因为 onblur 会处理它（onfocus 的对应物）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-09T17:19:08.983

Is the drop-down data being populated in the on-drop-down event? If so, an easy fix would be to set the DroppedDown state to True at the end of the data load.

# .net - 在 XML 注释中链接到我的项目未引用的类型？

> ID：353415
> 
> 赞同：1
> 
> 时间：2008-12-09T16:39:44.943
> 
> 标签：.net, xml-comments

我以前遇到过几次这种情况。我希望在我的 XML 注释中引用一个类型，但该类型包含在我的项目未引用的程序集中。

在 A.Dll（参考 B.DLL）中：

```
using B;
///<summary>Hai I'm SomeClass and I use <seealso cref="B.LoserClass"/> to do my work</summary>
public class SomeClass {/*...*/} 
```

在 B.DLL 中（不引用 A.DLL）：

```
///<summary> I can't <seealso cref="A.SomeClass"/> in this summary </summary>
public class LoserClass {/*...*/} 
```

在`LoserClass`我需要参考的评论中，`SomeClass`但由于 B.DLL 不参考 A.DLL（循环参考），我不能。

是否有某种方法可以将程序集信息包含在`LoserClass`代码文档中的 cref 中，以便`A.SomeClass`XML 文档生成器可以解决？

（顺便说一句，你不能总是通过移动类来解决这个问题，因为它会在其他地方导致循环依赖）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T12:06:37.630

我不知道如何做到这一点，我相信它不存在。问题是，出于什么原因，您希望在组件 B 到 A 的注释中提及？B对A一无所知，对吧？A 使用 B，所以对我来说，注释也反映了这种依赖关系。但反过来对我来说毫无意义。

这只是我的拙见，

普伦森

# c# - 获取“源文件与构建模块时不同。”

> ID：353421
> 
> 赞同：7
> 
> 时间：2008-12-09T16:40:33.087
> 
> 标签：c#, .net, asp.net, compiler-construction

我正在尝试调试收到的 ASP.Net Web 项目。我修改了一个类`"Apps_LocalResources"`文件夹中的一个类。

当我调试并且代码尝试进入该类时，我得到

> “源文件与构建模块时不同。”。

我重建了解决方案，没有得到任何改变。我什至将它发布到不同的位置，并且 bin 文件夹中的 pdb 和 dll 没有改变，所以我没有将它们复制过来。

想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T16:45:02.780

如果要附加到 asp.net 工作进程，则终止该进程，启动网站并重新附加调试器。

如果您使用的是内置的 Web 服务器，请确保停止项目和与之关联的 WebDev.WebServer.Exe。

如果一切都失败了，请右键单击断点并选择位置。然后启用底部的“允许代码不同...”复选框。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-11-15T11:01:56.253

Just delete Obj file from application root and rebuild

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-20T16:44:40.877

删除 (4ex) 下的文件夹根目录：C:\Windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root

然后在 VS2005 中：工具->选项->调试->常规并取消选中需要源文件以完全匹配原始版本

这就是我的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-15T06:08:08.093

对于我的情况，我使用 try catch 依赖项目文件。它抛出异常，因此文件无法更新。当避免异常时，它工作正常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-25T20:56:09.953

单击解决方案资源管理器中的刷新按钮。这为我解决了这个问题。

编辑 2013 年 7 月 8 日：还要检查您的项目之间是否没有同一个 dll 的多个版本。如果这样做，请将最新的保存在项目解决方案中，其余的保存在项目范围之外的文件夹中。我确实建议您有一个 Libraries 文件夹来放置所有 dll，这样您就没有多个文件夹中的 dll。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-19T10:21:32.477

假设您正在引用一个 .dll，它是由您正在修改的副项目以及您的主项目构建的。

如果您的 Reference 设置为由 Release -Configuration 构建的 .dll 文件**（** .dll 的引用路径类似于*bin\Release\YOURDLL.dll*），请检查您是否真的在构建副项目在配置管理器中使用`Release`-configuration。

![配置管理器](https://i.stack.imgur.com/BGDQw.jpg)

此外，请确保您的项目依赖项和构建顺序设置正确，因此您的主项目所依赖的副项目将在您的主项目构建**之前**重新构建。

![项目依赖和构建顺序](https://i.stack.imgur.com/MN1Yd.jpg)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-04T15:23:47.687

重新启动 Visual Studio 对我有用。

# sql - 带有 SQL 的文件中的源成员列表

> ID：353424
> 
> 赞同：9
> 
> 时间：2008-12-09T16:42:05.143
> 
> 标签：sql, ibm-midrange

是否可以使用 SQL 生成 iSeries 源文件中所有源成员的列表？

可能类似于从 SYSTABLES 和 SYSCOLUMNS 获取表定义，但到目前为止我找不到任何东西。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-01-21T18:37:45.373

自从提出其他答案以来，更多的表和视图已添加到系统目录中。现在，您可以获得给定文件（又名表）的成员列表（在 SQL 用语中也称为“分区”），如下所示：

```
SELECT TABLE_PARTITION FROM SYSPARTITIONSTAT
WHERE TABLE_NAME = myfile AND TABLE_SCHEMA = mylib 
```

您还可以从中获取其他信息，`SYSPARTITIONSTAT`例如每个成员中的行数，以及上次更改、保存、恢复或使用的时间戳。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T11:56:49.137

遗憾的是，SQL 对成员一无所知，因此您可以从 qsys2.syscolumns 获得的所有源文件信息都是，它们由三列组成。

您需要成员信息，我建议将 qshell( STRQSH ) 与对 qsys2.systables 的查询一起使用，因为那里特别标记了源文件。

```
select table_schema , table_name from qsys2.systables where File_type = 'S' 
```

我拼凑了一个 qshell one-liner 用于复制和粘贴目的..

```
db2 -S "select '/QSYS.LIB/' concat table_schema concat '.LIB/' concat table_name concat '.FILE' from qsys2.systables where File_type = 'S'" | grep '/' | xargs -n1 find >/home/myuser/myfile 
```

它将找到的每个成员都通过管道传输到 IFS 目录 /home/myuser/myfile 你也可以指定一个 Sourcefile 成员。随时根据您的需要进行修改。

PS：它会为直接位于/QSYS.LIB 中的源文件引发错误，但我认为你无论如何都不想要这些。

小心！:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-10T08:48:44.690

您可以编写一个使用 DSPFD 命令检索成员列表的 CL 程序。也许您可以从存储过程中调用该程序？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-19T13:12:39.763

刚用过，效果不错。

```
DSPFD FILE(Libname/Filename)
      TYPE(*MBRLIST)         
      OUTPUT(*OUTFILE)       
      OUTFILE(QTEMP/MBRLIST) 
```

然后在 SQL

```
SELECT MLNAME FROM MBRLIST 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-07T20:57:43.410

与@john-y 的回答类似，您还可以像这样获取源物理文件成员的列表：

```
SELECT SYSTEM_TABLE_MEMBER, SOURCE_TYPE FROM QSYS2/SYSPARTITIONSTAT WHERE
SYSTEM_TABLE_SCHEMA = 'MYLIB' AND SYSTEM_TABLE_NAME = 'QRPGLESRC' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-02T20:50:53.247

基本上，对于库和源文件：

```
SELECT sys_dname, sys_tname    
FROM qsys2/systables         
ORDER BY sys_dname, sys_tname 
```

[然而，为了更详细，本讨论](https://groups.google.com/forum/#!topic/comp.sys.ibm.as400.misc/nThciz0QS58)中概述了一个过程。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-08T01:53:59.483

我需要它来查找特定源成员的位置，RPGLE 程序具有 /COPY #IFSIO_H，但它不符合哪个源文件。因此，我必须编写一个快速的 QSH 来在所有库中查找特定的源成员，从 QSYS.LIB 开始：这只有在成员中有字符串时才有效。

```
find '/QSYS.LIB/' -name '*.MBR' -exec  grep -rins  '#IFSIO_H'  {} \; 
```

需要时间，grep和find都提交到batch

# sql - SQL 条件式 Where

> ID：353425
> 
> 赞同：8
> 
> 时间：2008-12-09T16:42:18.307
> 
> 标签：sql, conditional, where

我有一个名为 spGetOrders 的存储过程，它接受几个参数：@startdate 和@enddate。这将查询“订单”表。表中的一列称为“ClosedDate”。如果订单尚未关闭，则此列将保留 NULL，如果已关闭，则保留日期值。我想添加一个 @Closed 参数，它会取一点值。在一个简单的世界里，我可以做..

```
select * from orders o
where o.orderdate between @startdate AND @enddate
and (if @Closed = 1 then o.ClosedDate IS NULL else o.ClosedDate IS NOT NULL) 
```

显然，这是行不通的。我也在研究动态 sql，这是我最后的手段，但开始看起来像答案。

请帮忙..

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-09T16:48:05.440

试试这个：

```
select * from orders o
where o.orderdate between @startdate AND @enddate
and ((@Closed = 1 And o.ClosedDate IS NULL) Or (@Closed = 0 And o.ClosedDate IS NOT NULL)) 
```

在 where 子句中混合 AND 和 OR 时要小心谨慎。这样做时，控制评估顺序的括号非常重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T16:46:56.363

SQL 语句：

```
SELECT *  
FROM orders  
WHERE orderdate BETWEEN @startdate AND @enddate  
AND (@Closed = 1 OR CLosedDate IS NOT NULL) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T16:48:32.773

或这个：

```
select * from orders o
where o.orderdate between @startdate AND @enddate
and (  (@Closed = 1 AND o.ClosedDate IS NULL)
     OR (ISNULL(@Closed, 0) <> 1 AND o.ClosedDate IS NOT NULL)
     ) 
```

看起来您想要两个日期之间的所有订单具有不一致的关闭信息。其他建议可能一样好（或更好），但我很确定这可行并且对我来说是可读的（大多数其他建议在我打字时出现）。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T16:50:01.133

基本上，写出来。

```
select * from orders o
where o.orderdate between @startdate AND @enddate
and ((@Closed = 1 and o.ClosedDate IS NULL)
    or (@Closed != 1 and o.ClosedDate IS NOT NULL)) 
```

双，可拆

# c# - 从类型集合中获取公共基类的最简单方法

> ID：353430
> 
> 赞同：5
> 
> 时间：2008-12-09T16:44:01.067
> 
> 标签：c#, .net, linq, reflection

我正在构建一个自定义属性网格，用于显示集合中项目的属性。我想要做的是只显示网格中每个项目共有的属性。我假设最好的方法是找到集合中每种类型的公共基类并显示它的属性。有没有更简单的方法？你能给我一个最好的方法的代码示例吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T17:13:20.977

您可以使用不断检查公共基类的方法来做到这一点。我使用 Type 类的 BaseClass 特性快速地写了这个。您不必使用数组、列表或其他 IEnumerable 可以对它进行小的修改。

我用以下方法对其进行了测试：

```
static void Main(string[] args)
{
    Console.WriteLine("Common Types: " + GetCommonBaseClass(new Type[] {typeof(OleDbCommand), typeof(OdbcCommand), typeof(SqlCommand)}).ToString());   
} 
```

并得到了 DbCommand 的正确答案。这是我的代码。

```
 static Type GetCommonBaseClass(Type[] types)
    {
        if (types.Length == 0)
            return (typeof(object));
        else if (types.Length == 1)
            return (types[0]);

        // Copy the parameter so we can substitute base class types in the array without messing up the caller
        Type[] temp = new Type[types.Length];

        for (int i = 0; i < types.Length; i++)
        {
            temp[i] = types[i];
        }

        bool checkPass = false;

        Type tested = null;

        while (!checkPass)
        {
            tested = temp[0];

            checkPass = true;

            for (int i = 1; i < temp.Length; i++)
            {
                if (tested.Equals(temp[i]))
                    continue;
                else
                {
                    // If the tested common basetype (current) is the indexed type's base type
                    // then we can continue with the test by making the indexed type to be its base type
                    if (tested.Equals(temp[i].BaseType))
                    {
                        temp[i] = temp[i].BaseType;
                        continue;
                    }
                    // If the tested type is the indexed type's base type, then we need to change all indexed types
                    // before the current type (which are all identical) to be that base type and restart this loop
                    else if (tested.BaseType.Equals(temp[i]))
                    {
                        for (int j = 0; j <= i - 1; j++)
                        {
                            temp[j] = temp[j].BaseType;
                        }

                        checkPass = false;
                        break;
                    }
                    // The indexed type and the tested type are not related
                    // So make everything from index 0 up to and including the current indexed type to be their base type
                    // because the common base type must be further back
                    else
                    {
                        for (int j = 0; j <= i; j++)
                        {
                            temp[j] = temp[j].BaseType;
                        }

                        checkPass = false;
                        break;
                    }
                }
            }

            // If execution has reached here and checkPass is true, we have found our common base type, 
            // if checkPass is false, the process starts over with the modified types
        }

        // There's always at least object
        return tested;
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T16:26:05.150

为获取一组类型的最具体的公共基础而发布的代码存在一些问题。特别是，当我将 typeof(object) 作为其中一种类型传递时，它会中断。我相信以下内容更简单且（更好）正确。

```
public static Type GetCommonBaseClass (params Type[] types)
{
    if (types.Length == 0)
        return typeof(object);

    Type ret = types[0];

    for (int i = 1; i < types.Length; ++i)
    {
        if (types[i].IsAssignableFrom(ret))
            ret = types[i];
        else
        {
            // This will always terminate when ret == typeof(object)
            while (!ret.IsAssignableFrom(types[i]))
                ret = ret.BaseType;
        }
    }

    return ret;
} 
```

我还测试了：

```
Type t = GetCommonBaseClass(typeof(OleDbCommand),
                            typeof(OdbcCommand),
                            typeof(SqlCommand)); 
```

并得到`typeof(DbCommand)`. 与：

```
Type t = GetCommonBaseClass(typeof(OleDbCommand),
                            typeof(OdbcCommand),
                            typeof(SqlCommand),
                            typeof(Component)); 
```

并得到`typeof(Compoment)`. 与：

```
Type t = GetCommonBaseClass(typeof(OleDbCommand),
                            typeof(OdbcCommand),
                            typeof(SqlCommand),
                            typeof(Component),
                            typeof(Component).BaseType); 
```

并得到`typeof(MarshalByRefObject)`. 与

```
Type t = GetCommonBaseClass(typeof(OleDbCommand),
                            typeof(OdbcCommand),
                            typeof(SqlCommand),
                            typeof(Component),
                            typeof(Component).BaseType,
                            typeof(int)); 
```

并得到`typeof(object)`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-09T18:27:34.103

要从对象集合中获取公共属性，可以使用如下方法：

```
public static String[] GetCommonPropertiesByName(Object[] objs)
{
    List<Type> typeList = new List<Type>(Type.GetTypeArray(objs));
    List<String> propertyList = new List<String>();
    List<String> individualPropertyList = new List<String>();

    foreach (Type type in typeList)
    {
        foreach (PropertyInfo property in type.GetProperties())
        {
            propertyList.Add(property.Name);
        }
    }

    propertyList = propertyList.Distinct().ToList();

    foreach (Type type in typeList)
    {
        individualPropertyList.Clear();

        foreach (PropertyInfo property in type.GetProperties())
        {
            individualPropertyList.Add(property.Name);
        }

        propertyList = propertyList.Intersect(individualPropertyList).ToList();
    }

    return propertyList.ToArray();
} 
```

然后，一旦您有了要处理的属性的字符串，就可以获取集合中的任何对象并使用反射通过其字符串名称调用该属性。

```
PropertyInfo p = t.GetType().GetProperty("some Property String Name");
p.GetValue(t, null);
p.SetValue(t, someNewValue, null); 
```

同理，`GetCommonPropertiesByName`可以修改方法中的代码，获取常用的成员、方法、嵌套类型、字段等...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T17:00:58.927

好，

您可以在类似于 IComparable 的接口中创建，而是将其称为 IPropertyComparable 之类的东西，然后让实现它的类使用反射来比较它们的属性名称......

```
public int Compare(T x, T y)
{
     PropertyInfo[] props = x.GetType().GetProperties();

     foreach(PropertyInfo info in props)
     {
          if(info.name == y.GetType().Name)
          ....
     }

     ... 
```

我会让你弄清楚其余的。无论如何，它可能会更优雅一点，也许使用 LINQ ......

*   马特

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-09T18:02:37.430

这是一种从类型列表中获取通用属性集的方法：

```
class TypeHandler
{
    public static List<string> GetCommonProperties(Type[] types)
    {
        Dictionary<string, int> propertyCounts = new Dictionary<string, int>();

        foreach (Type type in types)
        {
            foreach (PropertyInfo info in type.GetProperties())
            {
                string name = info.Name;
                if (!propertyCounts.ContainsKey(name)) propertyCounts.Add(name, 0);
                propertyCounts[name]++;
            }
        }

        List<string> propertyNames = new List<string>();

        foreach (string name in propertyCounts.Keys)
        {
            if (propertyCounts[name] == types.Length) propertyNames.Add(name);
        }

        return propertyNames;
    }
} 
```

这将遍历所有类型中的所有属性，并且仅以出现次数等于类型数量的那些属性结束。

如果您更喜欢紧凑的 LINQ 查询，可以使用以下等效表达式：

```
return (from t in types
              from p in t.GetProperties()
              group p by p.Name into pg
              where pg.Count() == types.Length
              select pg.Key).ToList(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T11:50:28.023

我使用这样的东西，但托尼的回答可能更好：

```
internal class BaseFinder
{
    public static Type FindBase(params Type[] types)
    {
        if (types == null)
            return null;

        if (types.Length == 0)
            return null;

        Dictionary<Type, IList<Type>> baseTypeMap = new Dictionary<Type,IList<Type>>();

        // get all the base types and note the one with the longest base tree
        int maxBaseCount = 0;
        Type typeWithLongestBaseTree = null;
        foreach (Type type in types)
        {
            IList<Type> baseTypes = GetBaseTree(type);
            if (baseTypes.Count > maxBaseCount)
            {
                typeWithLongestBaseTree = type;
                maxBaseCount = baseTypes.Count;
            }
            baseTypeMap.Add(type, baseTypes);
        }

        // walk down the tree until we get to a common base type
        IList<Type> longestBaseTree = baseTypeMap[typeWithLongestBaseTree];
        for (int baseIndex = 0; baseIndex < longestBaseTree.Count;baseIndex++)
        {
            int commonBaseCount = 0;
            foreach (Type type in types)
            {
                IList<Type> baseTypes = baseTypeMap[type];
                if (!baseTypes.Contains(longestBaseTree[baseIndex]))
                    break;
                commonBaseCount++;
            }
            if (commonBaseCount == types.Length)
                return longestBaseTree[baseIndex];
        }
        return null;
    }

    private static IList<Type> GetBaseTree(Type type)
    {
        List<Type> result = new List<Type>();
        Type baseType = type.BaseType;
        do
        {
            result.Add(baseType);
            baseType = baseType.BaseType;
        } while (baseType != typeof(object));
        return result;
    }
} 
```

# stored-procedures - 是否可以编写脚本来轻松部署 clr 存储过程？

> ID：353439
> 
> 赞同：2
> 
> 时间：2008-12-09T16:46:49.593
> 
> 标签：stored-procedures, powershell, clr

我想在我们的部署脚本（目前是 powershell）中包含 CLR 存储过程部署，但是我想不出一个自动执行此操作的好方法。

我原以为会有一个不错的命令行选项来执行与 Visual Studio 中的右键单击部署相同的操作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T00:15:58.300

好吧，PowerShell 本身不会为您提供太多额外帮助。你没有提到哪个版本的 SQL，所以我会有点笼统。

真的，你需要做的就是让你的脚本文件为你的 CLR 存储过程复制必要的 DLL——PowerShell 可以像疯子一样复制文件，所以没有问题。然后您需要在 SQL 中执行 CREATE ASSEMBLY 语句。PowerShell 本身无法解决此问题。如果您使用的是 SQL 2008，您的脚本可以在 SQL cmdlet 提供程序中添加 PSSnap，这将为您提供一个能够执行 SQL 查询的 cmdlet - 这样您就可以获得 CREATE 语句。

如果您没有 2008，则必须编写一个简短的 .NET 例程来创建 SqlConnection 和 SqlCommand - 不难，而且完全可能在 PowerShell 中。

接下来，使用相同的技术执行您的 CREATE PROC 语句，以使用上述程序集实际创建存储过程。

扎特帮助？可惜没有什么比自动化更自动化了，真的。我不认为 MS 并没有花很多精力来简化这种性质的复杂 SQL 部署的东西，而且 CLR 的东西增加了一些额外的趣味，因为你必须使程序集可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-11T12:51:42.450

可以使用[http://msdn.microsoft.com/en-us/library/ms345099.aspx](http://msdn.microsoft.com/en-us/library/ms345099.aspx)中描述的技术从 SSMS 生成部署脚本。至少这解决了生成大量 CREATE PROCEDURE 语句的繁琐部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T22:26:46.140

SQL Server 发布向导可以将 CLR 存储过程脚本编写为文本。看起来它将 CLR 存储过程的二进制源转换为某种十六进制编码文本。

# php - 为 GD Lib imagerotate 和 imagecopy 设置背景颜色

> ID：353458
> 
> 赞同：1
> 
> 时间：2008-12-09T16:50:43.470
> 
> 标签：php, graphics, gdlib

我正在使用 PHP 5 GD Lib 进行一些图形操作，但是当您旋转图像或将图像复制到另一个（更大的）图像时，我找不到解决黑色背景的方法。

假设我正在使用一个当然不透明的 JPEG 文件，我如何使用 GD Lib 旋转图像并最终得到白色背景/画布，而不是黑色背景？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T17:08:42.110

This comment is from the PHP documentation and credit goes to "weareexit at yahoo dot co dot uk"

*"If you want to place an image on a larger canvas you've previously created with imagecreatetruecolor(), but you don't want the default black background to surround it: use imagefill() AFTER imagecopyresampled()."*

# .net - 托管 C++ 中的逐字字面量？（就像 C# 的 @"blah"）

> ID：353464
> 
> 赞同：8
> 
> 时间：2008-12-09T16:52:33.653
> 
> 标签：.net, c++, .net-2.0, string, managed-c++

有没有办法在托管 C++ 中使用逐字字符串文字？类似于 C# 的

```
String Docs = @"c:\documents and settings\" 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-04T12:20:03.127

在 C++11 中，有原始字符串文字：

```
cout<<R"((\"ddd\aa)\n)"<<endl;
cout<<R"delimiter((\"ddd\aa)\n)delimiter"<<endl; 
```

输出是：

```
(\"ddd\aa)\n
(\"ddd\aa)\n 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-09T17:12:26.140

目前这是不可能的。托管 C++ 字符串文字具有与普通 C++ 字符串几乎完全相同的规则。托管 C++ 规范实际上只是 ANSI C++ 标准的扩充。

目前在 C++（托管与否）中不支持 C# 样式文字语法。您必须手动转义每个字符。

有关更多详细信息，请参阅 C++/CLI 规范中的第 9.1.3.3 节。（[规格链接）](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-372.pdf)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-09T17:55:37.497

虽然不像 '@' C# 逐字字符串文字那样简洁，但以下内容确实编译 /Clr:pure，因此您可以将 C++ Raw String Literals 用于纯 MSIL 和类似的结果：

```
String^ f = gcnew String(R"(C:\foo\bar.txt)"); 
```

原始字符串文字也可以在常规 C++ 中使用：

```
char *x = R"(C:\foo\bar.txt)"; 
```

谷歌“msdn C++ 字符串文字”了解更多信息

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-20T17:57:33.253

snip .. 对于 .NET 编程，Visual Studio 2017 中的 Visual C++ 支持使用 /clr（公共语言运行时编译）编译器选项创建混合程序集。/clr:pure 和 clr:safe 选项在 Visual Studio 2015 中已弃用，在 Visual Studio 2017 中不受支持。如果您的代码需要安全或可验证，那么我们建议您将其移植到 C#。

# vb.net - Monitoring a Custom Service

> ID：353467
> 
> 赞同：0
> 
> 时间：2008-12-09T16:53:22.980
> 
> 标签：vb.net

I've created a service for one of my apps. How do i create a system tray component in VB.net that can be used to monitor the progress of the service? Is there a way to have this installed via tcpip on multiple client machines such as those that are for our employees?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T12:16:31.637

我们在这里就是这样做的，服务器在一个单独线程上的可配置端口上运行一个非常基本的 HTTP 服务器，该线程以 XML 格式返回状态（仅此而已）——客户端只使用 Web 请求来获取 XML , 在解析它并适当地显示它之前。

这种方法还允许未来的可扩展性（详细状态、发送服务控制命令、将关联添加到其他地方的 XSLT 文件以与普通 Web 浏览器一起使用等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T00:35:33.720

您可以为此使用 WCF。使用 WCF，您的服务将打开一个 EndPoint，它将向调用者公开状态信息。然后，您可以构建一个可以部署到员工工作站的托盘图标应用程序。托盘图标应用程序可以定期轮询您的 Windows 服务托管的 WCF 服务并获取状态信息。我知道@Johan 已经提到过远程处理，这是一种类似的方法。我会推荐 WCF，因为编程 API 更简单，恕我直言，WCF 将在网络传输等方面为您提供更大的灵活性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T17:12:36.127

I guess your question is not about how to actually do the "traybar"-thing, but how to communicate with the service to get the information you want to show in the monitor/traybar-program?

It can be done in many ways, API is one way, use sendmessage/postmessage/getmessage is one way to make 2 running programs communicate with each other without having to store anything in files or databases first.

DDE is another way. If it needs to do the stuff via net then there is something called NetDDE, but I havent done anything with NetDDE I cant help anything there.

But about the API and DDE, feel free to ask more questions if you want some clarification.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T17:13:15.330

I'll take the second question: Is there a way to remotely install software on client machines?

Yes. However it is very dependent on your environment. For example, if you have an Active Directory domain, you can use group policy to force installation of software on the client boxes.

If you don't like that or if you aren't on active directory, you can buy something like Altiris to push installs down.

Another option would be to use login scripts which would run a custom program to detect if your program is installed and take appropriate action. But then you are probably better off buying Altiris.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T10:52:22.063

对于通信部分，我以前使用过远程处理，效果很好。通过一些配置，您甚至可以让它在另一台机器上工作。

# flash - LocalConnection 连接到 actionscript 1 swf 的问题

> ID：353474
> 
> 赞同：0
> 
> 时间：2008-12-09T16:56:02.757
> 
> 标签：flash, actionscript-3, actionscript

我正在构建一个 shell 应用程序，它将根据用户所在的章节和部分在其中加载其他 swf。shell 是用 actionscript 3 编写的，它在其中加载各种 AS3、AS2 和 AS1 swf。在加载 AS2 和 AS1 swf 后，我使用 LocalConnection 为 flash 设置正确的变量，以找到要为该章节/swf 加载的正确 XML 文件。到目前为止，我在加载 AS2 swfs 方面没有任何问题，但我所拥有的 2 或 3 个 AS1 swfs 似乎根本没有设置和加载。除了调试或配置旧代码之外，我过去对 AS1 所做的工作很少，所以我想知道我是否遗漏了一些非常明显的东西？

下面是从 AS3 加载和连接到 AS1 swf 的代码：

```
AS1SWF = evt.target.content;
sendSwf_lc = new LocalConnection();
addChild(AS1SWF);
stopPlayback(fileID);

private function stopPlayback(fileID:String):void {
sendSwf_lc.send("LocalConnection", "init", fileID, "English");
} 
```

这是 AS1 应用程序中用于接收该 LocalConnection 调用的代码。

```
var conn:LocalConnection;
conn = new LocalConnection();
conn.connect("LocalConnection");

conn.init = function(chapter, language) {

drillFile = "matching/xml/"+chapter+".xml";
drill = new XML();
drill.ignoreWhite = true;
drill.onload = getDrillXML;
drill.load(drillFile);
this.close();
}

function getDrillXML() {
trace("Application is starting now!");
//Rest of code
} 
```

我显然遗漏了一些东西，但这就是 swf 的目标......它将正确加载 AS1 swf 并发送正确的变量并触发 init 函数。它不会命中 onLoad 事件的 getDrillXML 函数。我已经用正常运行的 XML 和非正常运行的 XML 对此进行了测试，如果 XML 路径不正确，它肯定会抛出错误加载消息，所以当我正确执行时，它肯定会加载正确的 XML。我在 getDrillXML 函数的最顶部有一个跟踪语句，它从未出现，所以它必须是涉及 AS1 中的 XML 类的东西，它没有正确加载 XML 文件，完成加载，然后继续指定函数完成后。

我已经在没有 LocalConnection 的情况下对此进行了测试，只是使用本地 swf 对其中的变量进行了硬编码，它工作得很好，一切都加载了，应用程序按预期工作。

以前有没有其他人遇到过这种情况？这是范围问题吗？我是否遗漏了 AS1 版本的 LocalConnection 或 XML 类中的某些内容？该文件发布到 Flash Player 6 swf。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T17:47:42.497

*叹*

我没有为 AS1 应用程序编写代码，我不知道为什么当 SWF 是一个独立的应用程序时它会起作用，但是为什么当它加载到 AS3 shell 应用程序中时它不起作用，但是 xml onLoad 事件在原始 swf 中拼写错误为 onload。我不敢相信我把所有的时间都浪费在了这么微不足道的事情上，哈哈，伙计……有时候编码会让人沮丧。

感谢任何阅读本文的人，让我下一个头痛！

# jquery - jQuery验证插件清除IE中的文件输入值

> ID：353475
> 
> 赞同：3
> 
> 时间：2008-12-09T16:56:08.843
> 
> 标签：jquery, validation, forms, jquery-validate

我目前正在使用这个 jQuery[验证](http://bassistance.de/2008/01/30/jquery-validation-plugin-overview/)插件，并且在 IE 中遇到问题，它在验证表单的其余部分时删除了文件输入字段的值。

在我看来，这似乎是一个焦点问题，我选择一个要上传的文件，单击另一个输入字段并清除该值 - 这也仅发生在文件输入字段上，表单中的任何其他类型的输入保持其值正常。我一直在玩插件文件，似乎没有什么能改变它清除领域的事实，也看了一下谷歌并且找不到任何帮助。

我已经在其他浏览器上测试过这个问题并且值仍然存在，所以它只是在 IE 中。

有没有其他人使用过这个插件并且有同样的问题？

任何帮助都会很棒，谢谢:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-26T23:29:29.387

我已经有一段时间没有使用 IE 文件 INPUT 元素了，但我想我仍然记得足够有帮助。

我记得，IE 会清除任何不是由 IE 本身设置的文件 INPUT。我认为他们的逻辑是“文件输入应该只具有用户想要的有效路径，因此如果文件输入是由 JavaScript 设置的，则假定它是恶意的并清除输入”。

因此，如果您的验证逻辑包含任何类似的`$("INPUT[type='file']").val(something)`东西，那将解释您看到的行为。希望有帮助。

# html - 使用 CSS 堆叠 div

> ID：353481
> 
> 赞同：0
> 
> 时间：2008-12-09T16:57:23.690
> 
> 标签：html, css

我知道这对于 CSS 和当前的浏览器集特别困难，但我仍然有这个要求。

我需要能够在一列中有 3 个 div。每个 div 应该能够占据一定比例的垂直空间（例如 33%）。每个 div 的内容最终*可能会*大于可用空间，因此 div 应该能够溢出并为用户提供滚动条。

我的问题是我无法弄清楚如何为每个面板提供垂直高度。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-09T17:11:25.037

也许我错过了一些东西，但给出：

```
 <div id="column">
    <div id="a" class="cell">A</div>
    <div id="b" class="cell">B</div>
    <div id="c" class="cell">C</div>
  </div> 
```

有什么问题：

```
 #column
    {
        height: 100%;
        width: 20%;
    }

    #column .cell
    {
        height: 31%;
        margin: 1%;
        background-color: green;
        overflow: auto;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T17:11:18.250

既然我已经修复了 CSS 中的愚蠢错误，以下内容可以在 IE7、Firefox 3 和 Google Chrome 上正确呈现：

```
<html>
<head>
<style type="text/css">
#one {height: 33%; overflow: auto;}
#two {height: 33%; overflow: auto;}
#three {height: 33%; overflow: auto;}
</style>
</head>

<body>

<p id="one">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec eget pede et eros adipiscing ornare. Sed ipsum dui, pulvinar eget, iaculis at, fermentum ac, lorem. Phasellus bibendum diam a nibh. In turpis lacus, condimentum id, faucibus ut, rhoncus id, enim. Quisque nec nunc at lacus placerat facilisis. Etiam mi lectus, placerat sit amet, ultricies at, tempus in, augue. Nunc in ante et erat ullamcorper pulvinar. Etiam turpis sapien, consequat vel, dignissim in, porttitor at, lectus. Integer dictum, massa eu scelerisque pretium, magna ligula auctor sapien, et tincidunt sem libero ac arcu. In at metus. Quisque quis diam at ipsum eleifend volutpat. Mauris tempor rutrum lectus. Proin fermentum nisi eu sem. Nulla eu eros. Donec velit metus, tristique tincidunt, egestas sed, tincidunt fermentum, nibh. In hac habitasse platea dictumst. Vivamus porta. Proin rhoncus ullamcorper leo. Nulla viverra, eros a dictum interdum, ante diam luctus metus, non placerat tellus metus ac lacus.</p>

<p id="two">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec eget pede et eros adipiscing ornare. Sed ipsum dui, pulvinar eget, iaculis at, fermentum ac, lorem. Phasellus bibendum diam a nibh. In turpis lacus, condimentum id, faucibus ut, rhoncus id, enim. Quisque nec nunc at lacus placerat facilisis. Etiam mi lectus, placerat sit amet, ultricies at, tempus in, augue. Nunc in ante et erat ullamcorper pulvinar. Etiam turpis sapien, consequat vel, dignissim in, porttitor at, lectus. Integer dictum, massa eu scelerisque pretium, magna ligula auctor sapien, et tincidunt sem libero ac arcu. In at metus. Quisque quis diam at ipsum eleifend volutpat. Mauris tempor rutrum lectus. Proin fermentum nisi eu sem. Nulla eu eros. Donec velit metus, tristique tincidunt, egestas sed, tincidunt fermentum, nibh. In hac habitasse platea dictumst. Vivamus porta. Proin rhoncus ullamcorper leo. Nulla viverra, eros a dictum interdum, ante diam luctus metus, non placerat tellus metus ac lacus.</p>

<p id="three">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec eget pede et eros adipiscing ornare. Sed ipsum dui, pulvinar eget, iaculis at, fermentum ac, lorem. Phasellus bibendum diam a nibh. In turpis lacus, condimentum id, faucibus ut, rhoncus id, enim. Quisque nec nunc at lacus placerat facilisis. Etiam mi lectus, placerat sit amet, ultricies at, tempus in, augue. Nunc in ante et erat ullamcorper pulvinar. Etiam turpis sapien, consequat vel, dignissim in, porttitor at, lectus. Integer dictum, massa eu scelerisque pretium, magna ligula auctor sapien, et tincidunt sem libero ac arcu. In at metus. Quisque quis diam at ipsum eleifend volutpat. Mauris tempor rutrum lectus. Proin fermentum nisi eu sem. Nulla eu eros. Donec velit metus, tristique tincidunt, egestas sed, tincidunt fermentum, nibh. In hac habitasse platea dictumst. Vivamus porta. Proin rhoncus ullamcorper leo. Nulla viverra, eros a dictum interdum, ante diam luctus metus, non placerat tellus metus ac lacus.</p>

</body>

</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T18:17:01.187

我不会直接回答你的问题，但我希望你不要因此而对我投反对票！！

我在这里看到的能够很好地堆叠 div 的最伟大的框架是很棒的[http://960.gs](http://960.gs)

它允许您为不适合下面布局的 div 和反弹 div 设置固定大小。那里的 css 技术，包括 Meyer 的 Reset.css 非常出色。

即使您只是窃取 css 并且不使用网格，它也保证了每个人的学习。

# apache-flex - Shockwave、Flash 和 Flex 之间有什么区别？

> ID：353482
> 
> 赞同：9
> 
> 时间：2008-12-09T16:57:42.287
> 
> 标签：apache-flex, flash, shockwave

它们是一样的吗？如果不是，有什么区别？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-09T17:27:00.120

Adobe Shockwave 是一个媒体播放器（以前由 Macromedia 开发），可用于运行 Adob​​e Director 应用程序（通常在 Web 浏览器中作为插件）。它已在很大程度上被 Adob​​e Flash（最初也是由 Macromedia）取代。IIRC，Flash 最初只是 Shockwave 的一个新奇特版本，通常被称为 Shockwave Flash（这是它令人困惑的地方）。这就是为什么大多数 Flash 对象都具有 SWF 扩展名的原因。

Flex 建立在 Flash 之上，旨在简化 Flash 的一些方面。将 Flex 视为 Flash 的工具包（如 Qt 和 GTK）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-10T10:03:11.280

补充一点：最初，Shockwave 播放器是用于 CD-ROM 接口之类的重型播放器，而 Flash 是用于基于 Web 的接口的更轻量级的播放器。尽管 SW 近来不那么流行，但这仍然大致正确 - 就功能而言，Shockwave“取代”了 Flash，因为它可以播放 Flash 内容，以及做 Flash 不能做的事情（比如渲染硬件加速的 3D） .

话虽如此，虽然功能列表不同，但 Flash 和 Shockwave 是等效的技术。它们都是可以独立运行或作为浏览器插件运行的内容播放器。

有关 Flex 的更多信息，请参阅[此类似问题](https://stackoverflow.com/questions/59083/what-is-adobe-flex-is-it-just-flash-ii#69694)。

# sharepoint - 如何在共享点设计器中插入查询值作为参数？

> ID：353485
> 
> 赞同：0
> 
> 时间：2008-12-09T16:58:50.223
> 
> 标签：sharepoint, moss, wss, sharepoint-designer, xmlnode

我正在尝试在 SharePoint Designer 中创建一个通过 XML Web 服务连接到 SharePoint 列表的数据源。我已经创建了数据源并连接到有问题的列表。我可以使用 GetListItems 查看所有数据，并且我想使用查询参数对其进行过滤。

查询参数需要一个 XmlNode，当我把它作为值时，我得到一个错误：

```
<Query>
    <Where>
        <Eq>
            <FieldRef Name="Title" />
            <Value Type="Text">Foo</Value>
        </Eq>
    </Where>
</Query> 
```

当然，我没有输入任何选项卡或换行符，因为我在 SharePoint Designer 中只有一个输入字段。我收到此查询的错误：

> 尝试从数据源获取数据时，服务器返回了一个非特定错误。检查查询的格式和内容，然后重试。如果问题仍然存在，请联系服务器管理员。

我只是想将列表项结果集过滤为标题字段为“Foo”的列表项。这可以在 SharePoint Designer 中完成吗？

* * *

更新：以这种方式转义 < 和 > 也会失败：

```
&lt;Query&gt;&lt;Where&gt;&lt;Eq&gt;&lt;FieldRef Name=&quot;Title&quot; /&gt;&lt;Value Type=&quot;Text&quot;&gt;Foo&lt;/Value&gt;&lt;/Eq&gt;&lt;/Where&gt;&lt;/Query&gt; 
```

* * *

更新：这似乎是SoapDataSource 组件和 SOAP 调用的一个[已知问题。](http://blogs.msdn.com/sharepointdesigner/archive/2008/06/20/data-source-issues-and-workarounds.aspx)显然，他们在提交之前对 <'s 和 >'s 进行了过度编码。给出的解决方法是在没有查询参数的情况下保存数据源，然后将其添加到页面并在 Common Data View Tasks 对话框中创建过滤器。我能够使用以下过滤器字符串使其工作：

```
[@ows_Title = 'Foo'] 
```

不幸的是，这对我没有多大帮助，因为我正在添加一个数据视图（显示数据）而不是一个数据源，我可以使用它来将其他控件指向（如下拉列表）。

我仍在寻找一个好的解决方案，让我可以使用 SharePoint Designer 放置数据源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T19:18:24.303

SharePoint Designer 中存在错误。您不能像这样将 Query 对象传递给 SOAPDataSource - XML 被过度编码。除了使用 Visual Studio 之外，您无法修复它。

如果有可用的修补程序，我会通知您。

如果有人想在新答案中引用此答案，我会接受该答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T20:00:41.620

您是否对查询进行了 XML 编码？我相信您需要对 <、> 和 " 等字符进行编码，使其成为有效的 XML，例如：

```
&lt;Query&gt;&lt;Where&gt; 
```

和

```
&lt;FieldRef Name=&quot;Title&quot; /&gt; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-26T05:27:15.287

[这](http://sharethelearning.blogspot.com/2009/03/building-query-web-service-call.html)显示了如何使用变量来解决类似的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T21:18:10.077

使用列表标题字段后，除非我使用“包含”，否则它不会为我返回值。

但是，这可能无法解决您的错误。

# asp.net-mvc - ASP.NET 中基于帐户的查找

> ID：353486
> 
> 赞同：5
> 
> 时间：2008-12-09T16:59:22.360
> 
> 标签：asp.net-mvc, saas

我正在考虑将 ASP.NET 用于新的 SaaS 服务，但出于对我的爱，我似乎无法弄清楚如何像大多数 SaaS 应用程序（例如 37Signals）那样基于子域进行帐户查找。

例如，如果我提供 yourname.mysite.com，那么我将如何使用 ASP.NET（特别是 MVC）来提取子域，以便我可以加载正确的模板（显示您公司的名称等）？可以通过常规路由完成吗？

这在 SaaS 中似乎很常见，因此在 ASP.NET 中必须有一种简单的方法来实现；我知道有一些插件可以用于其他框架，如 Ruby on Rails。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T14:22:05.313

这对我有用：

```
 //--------------------------------------------------------------------------------------------------------------------------
    public string GetSubDomain()
    {
        string SubDomain = "";

        if (Request.Url.HostNameType == UriHostNameType.Dns)
            SubDomain = Regex.Replace(Request.Url.Host, "((.*)(\\..*){2})|(.*)", "$2");
        if (SubDomain.Length == 0)
            SubDomain = "www";
        return SubDomain;
    } 
```

我假设您希望在同一个 Web 应用程序中处理多个帐户，而不是使用 IIS 中的工具构建单独的站点。在我们的工作中，我们开始为每个子域创建一个新网站，但发现这种方法不能很好地扩展 - 特别是当您发布更新然后必须修改数十个网站时！因此，我确实推荐这种方法，而不是上面建议的面向服务器的技术，基于几年的经验，完全按照你的建议去做。

上面的代码只是确保这是一个完整的 URL（而不是 IP 地址）并返回子域。在相当大容量的环境中，它对我们来说效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T17:22:54.607

您应该能够从[ServerVariables](http://msdn.microsoft.com/en-us/library/ms524602.aspx)集合中选择它，但首先您需要配置 IIS 和 DNS 才能正常工作。所以您知道 37Signals 可能使用 Apache 或其他开源的 unix Web 服务器。在 Apache 上，这称为[VirtualHosting](http://httpd.apache.org/docs/2.0/vhosts/mass.html)。

要使用 IIS 执行此操作，您需要为在 IIS (application.mysite.com) 中指向您的应用程序的每个域创建一个新的 DNS 条目（创建一个 CNAME yourname.mysite.com 到 application.mysite.com）。

然后，您[在 IIS 应用程序 (application.mysite.com) 中创建一个主机头条目，该条目](http://support.microsoft.com/kb/190008)将接受标头 yourname.mysite.com。用户实际上会点击 application.mysite,com 但地址是自定义子域。然后，您访问 ServerVariables 集合以获取值以决定如何自定义站点。

注意：根据要求，您可以遵循几种替代实现。

*   在硬件负载平衡器上处理主机标头处理（37Signals 更可能这样做，而不是依赖 Web 服务器），并创建自定义 HTTP 标头以传递给 Web 应用程序。
*   为每个单独的应用程序创建一个新的 Web 应用程序和主机标头。对于大量用户来说，这可能是一种低效的实现，但可以为某些人提供更好的隔离和安全性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T22:36:56.520

您需要配置 DNS 以支持通配符子域。可以通过添加指向您的 IP 地址的 A 记录来完成，如下所示：

```
* A 1.2.3.4 
```

完成后，您在域之前键入的任何内容都将发送到您的根域，您可以通过拆分 HTTP_HOST 服务器变量来获得，就像上面的用户 buggs 所说：

```
 string user = HttpContext.Request.ServerVariables["HTTP_HOST"].Split(".")

//use the user variable to query the database for specific data 
```

PS。如果您使用的是共享主机，您可能必须使用他们的唯一 IP 插件，因为通配符域必须正常工作。如果您使用的是专用主机，则您已经拥有自己的 IP。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T14:19:16.443

我的做法是使用 HttpContext.Request.ServerVariables["HTTP_HOST"].Split(".")。

如果您需要更多帮助，请告诉我。

# python - 在 Django 中查询动态列数的更简洁方法？

> ID：353489
> 
> 赞同：0
> 
> 时间：2008-12-09T17:00:26.150
> 
> 标签：python, django

就我而言，我有许多来自表单的列名。我想过滤以确保它们都是真实的。这是我目前的做法：

```
for op in self.cleaned_data['options']:
    cars = cars.filter((op, True)) 
```

现在它*可以工作*了，但是可能有大约 40 列要测试，因此继续查询似乎不是很有效。

有没有办法可以将其浓缩为一个过滤器查询？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-09T17:37:46.713

将查询构建为字典并使用 ** 运算符将选项解压缩为过滤器方法的关键字参数。

```
op_kwargs = {}
for op in self.cleaned_data['options']:
    op_kwargs[op] = True
cars = CarModel.objects.filter(**op_kwargs) 
```

这在[django 文档](http://docs.djangoproject.com/en/dev/topics/db/queries/#retrieving-all-objects)中进行了介绍，并且在[SO](https://stackoverflow.com/questions/310732/in-django-how-does-one-filter-a-queryset-with-dynamic-field-lookups)中也进行了介绍。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T20:57:51.913

Django 的查询集是惰性的，因此您当前所做的实际上非常有效。除非您尝试访问 QuerySet 中的某个字段，否则数据库不会被命中...假设，也就是说，您没有编辑掉一些代码，它实际上是这样的：

```
cars = CarModel.objects.all()
for op in self.cleaned_data['options']:
    cars = cars.filter((op, True)) 
```

更多信息[在这里](http://docs.djangoproject.com/en/dev/topics/db/queries/#id3)。

# c# - Extending both sides of a Visitor/Bridge pattern

> ID：353491
> 
> 赞同：4
> 
> 时间：2008-12-09T17:00:48.053
> 
> 标签：c#, design-patterns, visitor-pattern, bridge

Say I have a hierarchy of classes, let's use the classic `Shape` examples:

`abstract class Shape`
`Circle : Shape`
`Square : Shape`

I have a second hierarchy of renderer classes that handle the rendering of shapes in different ways:

`abstract class ShapeRenderer`
`HtmlShapeRenderer : ShapeRenderer`
`WindowsFormsShapeRenderer : ShapeRenderer`

Allowing these to vary independently would traditionally involve using the Bridge pattern. Allowing the rendering actions to be extended without modifying the `Shape` classes would traditionally involve the Visitor pattern.

However, both of these focus exclusively on extending the implementation side and not the abstraction side. Say I wanted to add a new `Shape`, say `Triangle` - I want to be able to support rendering the `Triangle` as well. Since both the Visitor and the Bridge pattern rely on "flattening" the abstraction hierarchy into a set of methods, e.g.:

```
public abstract class ShapeRenderer
{
     public abstract void RenderCircle(Circle c);
     public abstract void RenderSquare(Square s);
} 
```

The only way to extend the `Shape` hierarchy is to modify the code of the base `ShapeRenderer` class, which is a breaking change.

Jon, to clarify: Using the Bridge or Visitor allows clients to provide alternative rendering implementations, but requires them to know about all potential Shapes. What I'd like to be able to do is allow clients to *also* be able to extend the `Shape` class and *require* them to provide a rendering implementation for their new class. This way, existing code can work with any type of `Shape`, without worrying about the particulars of rendering them.

Is there a common solution to this sort of problem usable in C#?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T17:17:45.600

I think it *should* be a breaking change. If you add a shape, the existing renderers clearly aren't going to be able to cope - they'll need to be changed.

You could change ShapeRenderer to add RenderTriangle() as a virtual (non-abstract) method which just logs the fact that it can't render appropriately, and then fix up the renderers one at a time, but fundamentally you're not going to be able to render the new type without more code.

What kind of non-breaking change are you really hoping to achieve?

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T03:50:34.450

[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)如何？策略是对 RenderEngine 实现的引用。当你想添加一个新的形状时，你创建一个新的渲染引擎实现，它知道新的形状实现并实现相应的渲染功能。您向 Shape 添加了一个虚拟函数，该函数充当帮助函数来选择正确的形状渲染函数 - 即 Circle 对象调用 renderCircle() 函数等。

在 C++ 中，可能看起来像：

```
class Triangle : public Shape
{
  public:
      Triangle( const RenderEngine& whichRenderEngine );
      void render( void ) { renderStrategy->renderTriangle( *this );

  private:
      RenderEngine* renderStrategy;
};

class TriangleRender : HTMLShapeRender
{
   public:
      // if inheriting from concrete class, all other rendering functions 
      // already exist... otherwise re-implement them here.

      void renderTriangle( const Triangle& t ) { /* impl */ }
};

HTMLRenderer r; // doesn't know about Triangles.
Circle c( &r );
c.render();

Square s( &r );
s.render();

// Now we add Triangle
TriangleRenderer tr;
Triangle t( &tr );
t.render();

Square s2( &tr );  // tr still knows how to render squares... 
s2.render(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T17:22:06.933

Design to an interface not an implementation.

Hey - I get to use the same answer twice today (i guess it's arguable that Renderer is an implementation)...

I'm not sure I'd go with the ShapeRenderer class. What about an IRenderHTML, IRenderWindows that are implemented by the shape classes?

You get extensibility with the Shapes as well as with the Renderings.

I think it may be better OO to say hey circle go render yourself, than to pass the circle to a utility class for rendering. You could readily add new shapes and new renderings by letting the shapes do the rendering themselves.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T17:58:57.747

我的解决方案几乎肯定是使用抽象工厂，在这种情况下，我将加载一个按类型键入的 ShapeRenderers 字典，其中类型是 Shape 的子类，并让工厂提供每个 Shape 所需的 ShapeRenderer（以及可能是平台，例如 Window、Web、iPhone）。

这样做意味着添加新形状只需要更改配置存储，因此工厂知道哪些渲染器要映射到哪些形状，以及包含具体实现的新程序集。

# ruby-on-rails - Gettings started with Ruby on Rails 2.0 for Windows

> ID：353497
> 
> 赞同：2
> 
> 时间：2008-12-09T17:02:12.277
> 
> 标签：ruby-on-rails, windows, ruby

So like many people, I'm excited about Ruby on Rails. Being a Windows user, I downloaded InstantRails, got it going, and followed along with the screencast on how to make a blog with RoR 2.0 in fifteen minutes. I used Notepad++ as my text editor, because that's what I've traditionally used for writing the PHP-based websites I've done in the past. I was a little envious of Mac users and how they get the really attractive-looking TextMate, but I managed to follow through the entire screencast and get everything working smoothly.

However, I was lost most of the time.

I know plenty of programming and scripting languages over the years - C++, JavaScript, PHP, HTML, and Lua just to name a few. I don't know Ruby, but I understand a lot of how it works, as far as the syntax is concerned, but I don't understand a lot of the logic behind why certain files do certain things, and that sort of thing.

Also, I tried Aptana with RadRails, but found it difficult to set up. Is there any concrete tutorial for getting it set up and working fully with Ruby on Rails 2.0?

Should I maybe just wait for more RoR 2.0 tutorials to come out before attempting to learn RoR? Or should I just plow on through and experiment until I figure it out?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T18:06:50.947

Also you may want to look into NetBeans, it has great support for ruby and rails. They also provide several focused tutorials and even viedos.

[http://www.netbeans.org/kb/trails/ruby.html](http://www.netbeans.org/kb/trails/ruby.html)

Another excelent source of focused tutorials is [http://railscasts.com/](http://railscasts.com/) by Ryan Bates.

On the ruby side, I strongly recommend The Ruby Way, and if you are into screencasts, the Pragmatic Programmers have some cheap and excelent ones on ruby object model and metaprogramming by Dave Thomas.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T17:27:00.200

Pragmatic Programmer's [Agile Web Development with Rails](http://pragprog.com/titles/rails2/agile-web-development-with-rails) is an excellent book to get started with.

There is a [RoR 2.0 BETA book](http://pragprog.com/titles/rails3/agile-web-development-with-rails-third-edition) available as well.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T19:21:20.077

The Rails Way is also a good book. I use it everyday as a reference book.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T21:06:11.537

You could always check out the awesome Peepcode screencast series:

[Rails 2 from scratch part I](https://peepcode.com/products/rails-from-scratch-part-i)

[Rails 2 from scratch part II](https://peepcode.com/products/rails-from-scratch-part-ii)

You'll be off and running in no time after watching those. I would also recommend [Railscasts](http://www.railscasts.com), a (free) weekly screencast on Rails, usually focusing on a single feature or implementing a concept in a wonderfully produced manner.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-09T21:32:15.400

If you are really serious about learning Rails, my advice is to **get a good book and read it** (I know.. programmers don't read books, but you should!). A "*good book on Rails*" usually contain a chapter on Ruby, but there are plenty of resources on the web to get you going.

According to [Ruby on Rails guides](http://guides.rubyonrails.org/getting_started.html):

> It is highly recommended that you **familiarize yourself with Ruby before diving into Rails**. You will find it much easier to follow what's going on with a Rails application if you understand basic Ruby syntax. Rails isn't going to magically revolutionize the way you write web applications if you have no experience with the language it uses.

I'm personally using [Simply Rails 2](http://www.sitepoint.com/books/rails2/), which uses (surprise, surprise) Rails 2\. It walks you through the development of a Digg clone.

If you still don't wanna use a book, you should check out [Ruby on Rails guides](http://guides.rubyonrails.org/) and the [Ruby on Rails Wiki](http://wiki.rubyonrails.org/rails). AFAIK, They are being regularly updated to keep up with new releases of Rails.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-09T19:23:22.850

From what I've read, though, it looks like many of these books and such are now at least partially outdated with the advent of Rails 2.0\. Is this true?

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-08-01T12:56:32.637

InstantRails has not been updated for a while, check out [Rubystack](http://bitnami.org/stack/rubystack), which is a similar project but we also include a bunch of other tools: Apache, MySQL,Imagemagick, etc.

# java - 如何让 JEditorPane 突出显示一行的全宽（不仅仅是文本）？

> ID：353505
> 
> 赞同：4
> 
> 时间：2008-12-09T17:03:44.833
> 
> 标签：java, line, highlighting, jeditorpane

我正在尝试让 JEditorPane 突出显示显示行的整个宽度。我尝试过的所有示例仅突出显示文本内容。例如，如果我有这样的内容：

```
 ---------------------------------
|Here is some text                |
|some more text                   |
 --------------------------------- 
```

在由上面的框表示的 JEditorPane 中，然后突出显示第一行仅突出显示“这里是一些文本”（表示在下面的 [ 和 ] 之间）。

```
 ---------------------------------
[Here is some text]               |
|some more text                   |
 --------------------------------- 
```

我希望它突出显示 JEditorPane 的整个宽度，如下所示：

```
 ---------------------------------
[Here is some text                ]
|some more text                   |
 --------------------------------- 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T21:23:08.100

这似乎并不太复杂。我会做一点[**代码挑战**](https://stackoverflow.com/questions/172184)。

只需创建您自己的自定义荧光笔，扩展 DefaultHighlighter。

覆盖该`paint()`方法，并简单地保持矩形绘制的宽度不变：它将是面板的宽度。

您将在**[DZone Snippets 中找到一个完整的示例](http://snippets.dzone.com/posts/show/6688)**：复制并运行它。告诉我这是否是你所追求的。它包括`textPane.setSelectionColor(new Color(1.0f, 1.0f, 1.0f, 0.0f));`您在回答中提到的添加内容。

[替代文字 http://www.freeimagehosting.net/uploads/94a3a990e4.png](http://www.freeimagehosting.net/uploads/94a3a990e4.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T15:52:38.203

为了防止选择突出显示干扰 VonC 的解决方案，我在 TextHighlight 构造函数中添加了以下行（本质上使选择突出显示不可见）：

```
textPane.setSelectionColor(new Color(1.0f, 1.0f, 1.0f, 0.0f)); 
```

# c# - C# 中的冗余、可靠性和容错——在哪里寻找示例？

> ID：353519
> 
> 赞同：4
> 
> 时间：2008-12-09T17:09:18.627
> 
> 标签：c#, reliability, redundancy

我想学习如何在 .net 中创建**真正**健壮的应用程序——具有容错能力并且能够承受意外情况的应用程序。我在哪里可以找到关于这个主题的文献/指南？到目前为止，我的运气并不好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T17:16:55.680

我知道至少有几个资源。首先，MSDN 上有一篇非常有用的文章，标题[为使用 .NET Framework 的可靠性特性保持代码运行](http://msdn.microsoft.com/en-us/magazine/cc163716.aspx)。

在设计可靠性功能时，Chris Brumme 也有一篇[关于托管的帖子。](http://blogs.msdn.com/cbrumme/archive/2004/02/21/77595.aspx)这可以提供一些有用的背景信息

您可能会发现有用的搜索词包括“高可用性”“CER”和“受约束的执行区域”。

祝你好运！真正可用的代码是相当棘手的事情。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T17:14:07.557

如果您从软件实现的角度来看，那么可能值得研究[按合同设计 (DbC)](http://en.wikipedia.org/wiki/Design_by_contract)

根据[此消息来源](http://archive.eiffel.com/doc/manuals/technology/contract/)，按合同设计的好处包括：

*   更好地理解面向对象的方法，更普遍地理解软件构造。
*   一种构建无错误的面向对象系统的系统方法。
*   用于调试、测试以及更普遍的质量保证的有效框架。
*   一种记录软件组件的方法。
*   更好地理解和控制继承机制。
*   一种处理异常情况的技术，为异常处理提供了一种安全有效的语言结构。

此外，我主张研究一种[测试驱动开发 (TDD)](http://en.wikipedia.org/wiki/Test-driven_development)方法，它应该有助于推动更健壮的设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-29T20:16:53.210

就我个人而言，我发现 Stephen Toub 的文章是有关受限执行区域的最佳来源：[使用 .NET Framework 的可靠性特性](http://msdn.microsoft.com/en-us/magazine/cc163716.aspx#S2)。最后，CER 是任何容错代码的基础，因此本文包含了您需要了解的几乎所有内容，并以清晰简洁的方式进行了解释。

话虽如此，您宁愿选择更激进的设计，在这种设计中立即诉诸应用程序域的破坏（或者在托管 CLR 时依赖于这种模式）。例如，您可以查看隔板模式（如果您对此模式感兴趣并面临复杂的数据流，则可能是[反应式宣言）。](http://www.reactivemanifesto.org/)

话虽如此，如果您在此之后无法完全恢复，“让它失败”的方法可能会适得其反，正如[Ariane V 所证明的那样](https://www.ima.umn.edu/~arnold/disasters/ariane5rep.html)。

# facebook - Facebook 分享者，发表评论？

> ID：353520
> 
> 赞同：24
> 
> 时间：2008-12-09T17:10:37.207
> 
> 标签：facebook, share

是否可以将描述/评论变量发布到 facebook 共享者 url？据我所知，只有 url 和 title 才有可能。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-06-01T21:01:15.137

您可以传递给实际的参数`sharer.php`是“u”和“t”，它们是`url`和`title`。您可以将`meta`标签添加到您的页面以获取更多信息以显示在共享器中。引用[文档](http://www.facebook.com/share_partners.php)（确保单击高级合作伙伴链接）：

> 为了确保始终正确填充预览，您应该将下面显示的标签添加到您的 html 中。一个示例新闻故事可能有以下内容：
> 
> ```
> <meta name="title" 
>       content="Smith hails 'unique' Wable legacy">
> <meta name="description" 
>       content="John Smith claims beautiful football ..." />
> <link rel="image_src" 
>       href="http://www.onjd.com/design05/images/PH2/WableAFC205.jpg" /> 
> ```
> 
> 如图所示，title 包含预览标题，description 包含预览摘要，image_src 包含预览图像。请确保没有任何内容字段包含任何 html 标记，因为它将被删除。为保持一致性，请使用 <meta> 标签为预览提供文本数据，并使用 <link> 标签为任何源 URL。
> 
> 标题和摘要标签是任何预览的最低要求，因此请确保包含这两个标签。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-26T17:46:05.300

您实际上可以使用以下方式传递自定义标题、网址、图像和评论/描述：

```
http://www.facebook.com/sharer.php?s=100&p[title]=titlehere&p[url]=http://www.yoururlhere.com&p[summary]=yoursummaryhere&p[images][0]=http://www.urltoyourimage.com 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-16T16:54:31.080

如图所示，title 包含预览标题，description 包含预览摘要，image_src 包含预览图像。请确保没有任何内容字段包含任何 html 标记，因为它将被删除。为了一致性起见，请使用`<meta>`标签提供文本数据以供预览，并使用`<link>`标签提供任何源网址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T18:29:56.210

Facebook 分享者使用描述`meta`标签在您的帖子中为图片添加描述。我真的不知道它是如何工作的，但我认为它在你的标题中使用了这个标签：

```
<link rel='image_src' href='http://www.yourwebsite/dir1/dir2/picture.jpg' /> 
```

# sql-server - 使用 @@identity 而不是 scope_identity 的原因

> ID：353526
> 
> 赞同：11
> 
> 时间：2008-12-09T17:11:59.277
> 
> 标签：sql-server, sql-server-2005

在 SQL Server 2005 数据库上，我们的一位远程开发人员刚刚签入了对将“select scope_identity”更改为“select @@identity”的存储过程的更改。您知道为什么要使用 @@identity 而不是 scope_identity 吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-09T17:17:19.143

`@@IDENTITY`将返回当前会话发出的最后一个标识值。`SCOPE_IDENTITY()`返回当前会话和相同范围中的最后一个标识值。它们通常是相同的，但假设调用了一个触发器，它在当前语句之前的某个地方插入了一些东西。`@@IDENTITY`将通过触发器的语句返回标识值`INSERT`，而不是块的插入语句。除非他知道自己在做什么，否则这通常是一个错误。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-09T17:20:42.990

这是[一个](http://blog.sqlauthority.com/2007/03/25/sql-server-identity-vs-scope_identity-vs-ident_current-retrieve-last-inserted-identity-of-record/)可能有助于区分它们的链接

好像：

*   **IDENTITY** - 连接上的最后一个身份
*   **SCOPE_IDENTITY** - 您明确创建的最后一个身份（不包括触发器）
*   **IDENT_CURRENT('tablename')** - 表中的最后一个身份，无论范围或连接如何。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-09T17:16:25.523

我想不出任何，除非有一个触发器然后插入了一行（或类似的），我真的很想要那个触发器插入的行的 id，而不是我物理更改的行。

换句话说，不，不是真的。

*   免责声明：不是 T-SQL 专家 :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T20:48:06.363

也许您应该询问开发人员进行更改的理由。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-09T20:44:16.073

如果您想要使用触发器，您可以添加另一个触发器，这是我能想到的唯一原因。即使那样它也很危险，因为可能会添加另一个触发器，并且您会再次获得错误的身份。我怀疑开发人员不知道他在做什么。但老实说，最好的办法是问他为什么做出改变。您可以将其更改回来，但开发人员需要知道不要再次这样做，除非他需要触发器身份，因为您下次可能无法捕捉到它。

# c# - IIS7、RewritePath 和 IIS 日志文件

> ID：353541
> 
> 赞同：10
> 
> 时间：2008-12-09T17:15:27.070
> 
> 标签：c#, asp.net, iis-7, url-rewriting, logging

我在 IIS7 上运行的 ASP.NET 3.5 应用程序中使用 Context.RewritePath()。

我在应用程序 BeginRequest 事件中执行此操作，并且一切正常文件。

/sports 的请求被正确地重写为 default.aspx?id=1，依此类推。

问题是在我的 IIS 日志中，我看到 /Default.aspx?id=1 的 GET 请求，而不是 /sports 的 GET 请求。

这种代码在 IIS6 下完美运行。

由于必须实现一些业务逻辑，因此不能选择使用 Microsoft Rewrite 模块。

谢谢。

编辑：

似乎我的处理程序在管道中为时过早，但是如果我将逻辑移到以后的事件中，那么整个重写的事情就不起作用了（为时已晚，StaticFileHandler 接受了我的请求）。

我用谷歌搜索和谷歌搜索，四处询问，不敢相信没有人有这个问题？

编辑：

哎呀！这是我在 IIS 论坛上找到的内容：

“这是因为在集成模式下，IIS 和 asp.net 共享一个公共管道，并且现在 IIS 可以看到 RewritePath，而在 IIS6 中，IIS 甚至都看不到它 - 您可以使用经典模式来解决这个问题，其行为类似于IIS6。”

**最终更新**：请看[下面我的回答](https://stackoverflow.com/questions/353541/iis7-rewritepath-and-iis-log-files/579141#579141)，我在生产环境中使用了一年多后更新了结果。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T20:15:10.610

经过一番研究，我终于找到了解决问题的方法。

**我已经用新的（在 ASP.NET 3.5 中引入） Context.Server.TransferRequest()**方法替换了对 Context.RewritePath() 方法的调用。

现在看起来很明显，但 IIS 核心团队的高级开发工程师没有想到这一点。

我已经针对会话、身份验证、回发、查询字符串等问题对其进行了测试，但没有发现任何问题。

明天我会将更改部署到一个流量非常大的站点，我们很快就会知道它是如何工作的。:)

我会回来更新的。

**更新：**该解决方案仍然不完全在我的生产服务器上，但它已经过测试并且确实有效，据我所知，它是我的问题的解决方案。如果我在生产中发现任何其他内容，我将发布更新。

**最后更新：**我在生产中使用了这个解决方案一年多了，它已被证明是一个良好且稳定的解决方案，没有任何问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T18:14:37.280

您可以在处理请求之后但在 IIS 日志记录模块写入日志条目之前将路径设置回原始值。

例如，此模块重写路径 on`BeginRequest`然后将其设置回原始值 on `EndRequest`。使用此模块时，原始路径会出现在 IIS 日志文件中：

```
public class RewriteModule : IHttpModule
{
    public void Init(HttpApplication context)
    {
        context.BeginRequest += OnBeginRequest;
        context.EndRequest += OnEndRequest;
    }

    static void OnBeginRequest(object sender, EventArgs e)
    {
        var app = (HttpApplication)sender;
        app.Context.Items["OriginalPath"] = app.Context.Request.Path;
        app.Context.RewritePath("Default.aspx?id=1");
    }

    static void OnEndRequest(object sender, EventArgs e)
    {
        var app = (HttpApplication)sender;
        var originalPath = app.Context.Items["OriginalPath"] as string;
        if (originalPath != null)
        {
            app.Context.RewritePath(originalPath);
        }
    }

    public void Dispose()
    {

    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T18:34:12.693

我遇到了完全相同的问题。解决此问题的一种方法是使用 Server.Transfer 而不是 Context.RewritePath。Server.Transfer 不会重新启动整个页面生命周期，因此仍会记录原始 URL。确保为“preserveForm”参数传递“true”，以便 QueryString 和 Form 集合可用于第二页。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T09:54:09.787

老问题，但是当我执行以下操作时，我发现我没有遇到您的问题：

a) web.config 中的重写规则将所有请求定向到 /default.aspx，例如：

```
 <rule name="all" patternSyntax="Wildcard" stopProcessing="true">
      <match url="*"/>
      <action type="Rewrite" url="/default.aspx"/>
    </rule> 
```

b) 在 default.aspx 事件中调用 RewritePath，`Page_PreInit`将 URL 和查询字符串重写为请求中传递的内容（即不存在的位置）。

例如，我请求“/somepage/?x=y”（不存在）。

a) Web.config 规则将其映射到 /default.aspx

b) Page_PreInit 将其重写回“/somepage/?x=y”。

结果，在 IIS 7（Express 和生产）中，服务器日志反映了存根的“/somepage”和查询的“x=y”，并且所有请求对象属性都反映了请求的（不存在的）URL（这就是我想要的）。

唯一奇怪的效果是，在 IIS Express 中，日志项被写入了两次。但是，这不会在生产中发生（Windows Server 2008 R2）。

# windows - Automate burning of 100+ .ISO DVD images

> ID：353544
> 
> 赞同：1
> 
> 时间：2008-12-09T17:17:02.233
> 
> 标签：windows, dvd, dvd-burning

Suppose I have a directory of 100 .ISO files. Do you know how I could automate burning them to DVDs? I'd basically like to send them to a DVD burner with a hopper of DVDs similar to how you can print sheets of paper on a printer.

Any ideas on how to do this on Windows?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T20:30:05.523

[http://www.imgburn.com/](http://www.imgburn.com/)

“当您刻录多个图像时，有一个图像队列系统（如果您有多个驱动器，您可以在多个驱动器之间自动共享）”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T20:00:18.720

在 Linux 上，编写一个使用 cdrecord 的简单 bash 脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T20:56:12.307

笠美[http://www.rimage.com/products/software/rimage-system-software.html](http://www.rimage.com/products/software/rimage-system-software.html)有带有软件和 SDK 的复制塔，可为您提供批量写入大量不同光盘所需的硬件和软件.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T20:19:43.503

在 Mac OS 上，您可能会使用 Toast 和 AppleScript。

顺便说一句，“漏斗”是什么意思？你不会想出一种机制来为你交换媒体，是吗？有这样的机器，但这与编程无关，它们带有用于此类任务的软件。

# .net - How to use same database and same program for two different locales in .NET

> ID：353545
> 
> 赞同：3
> 
> 时间：2008-12-09T17:17:09.453
> 
> 标签：.net, localization

I have a C# program which uses a SQL Server database.I am already using it in a country that uses . as decimal separator. Now I want to use it in another country that uses , as decimal separator.

in C# is there some application level setting that I can change or write some code so that I can use the same database and the same program ? or do I have to change my entire code to handle this new decimal separator?

I dont know how this works.Basically I think there would be problems in My Sql Queries. example say one of my existing statements is

```
insert into tblproducts(productId,Price) values('A12',24.10) 
```

now in new country it will become

```
insert into tblproducts(productId,Price) values('A12',24,10) 
```

this will raise an error

so do I have to change whole code to handle this situation ?

Thank you

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T17:46:46.557

如果您使用字符串连接构建查询，请改用参数。所以不要写：

```
 var query = "insert into tblproducts(productId,Price) values('" + article + "','"
    + price + ')'; 
```

使用[OleDbParameters](http://msdn.microsoft.com/library/yy6y35y8.aspx)：

```
 var query = "insert into tblproducts(productId,Price) values(?,?)"
 var cmd = new OleDbCommand(query, connection);
 cmd.Parameters.Add("@article", OleDbType.VarChar).Value = article;
 cmd.Parameters.Add("@price", OleDbType.Single).Value = price; 
```

这将为您省去很多麻烦，包括本地化问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T17:44:53.847

你可以做几件事来解决这个问题。

首先，如果您从界面中获取值，那么您将这些值转换为小数。Decimal.parse 是一个依赖于文化的函数，将使用当前文化来解析值。因此，如果 CurrentCulture 使用逗号作为小数分隔符，那么您的演员表将正常工作。然后，当您从变量输出值时，您可以指定 decimal.ToString 格式以始终使用句点作为分隔符输出。

哦，忘记补充了。您还可以更改解析以指示货币，它允许逗号和 $ 符号。例如：decimal.parse(amount, NumberStyles.Currency)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T17:46:19.957

在 global.asax.vb 文件中，您可以设置当前页面加载的文化：

```
Thread.CurrentThread.CurrentCulture = System.Globalization.CultureInfo.CreateSpecificCulture("en-US")
Thread.CurrentThread.CurrentUICulture = Thread.CurrentThread.CurrentCulture 
```

这将使所有文化感知功能都能很好地工作。例如， (5000.25).ToString() 将使用逗号与句点，具体取决于您设置的文化。此外，将用户的输入读入数字类型将根据其文化规则进行解析。日期将正确显示（12/9/08 与 9/12/08）。您基本上免费获得所有这些。

这显然会在与其他期望同一文化中的一切的系统交谈时引起问题。为了解决这个问题，您使用不变的文化编写查询：

```
(5000.25).ToString(CultureInfo.InvariantCulture) 
```

这会将输出显式设置为 Mysql 可以处理的内容。

注意：如果你有一个合适的数据层并且你将数字类型传递给它，你可能可以避免很多这样的混乱。

# c++ - 防止创建成员函数都是静态的类

> ID：353550
> 
> 赞同：9
> 
> 时间：2008-12-09T17:17:54.820
> 
> 标签：c++, static, constructor, namespaces

我的 ClassA 类中的所有成员变量和成员函数都是静态的。

如果用户尝试（错误地）创建该类的对象，他会收到警告：“ClassA，从未引用局部变量”，因为所有函数都是静态的，因此永远不会引用该对象。因此，我想阻止用户尝试创建此类的对象。

创建一个私有默认（无变量）构造函数就足够了吗？或者我是否还必须创建私有复制构造函数和私有赋值运算符（以防止使用默认构造函数）？如果我也必须创建它们，也许只创建一些虚拟的纯虚函数会更好，这会阻止用户创建对象？

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-09T17:28:04.923

与其使用具有所有静态方法的类，不如在单独的命名空间中使这些方法成为独立的函数。调用语法是一样的：

`namespace::function()`代替`classname::function()`

而且您不需要与试图实例化您的类的人打交道。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-09T17:19:54.097

创建一个私有的默认构造函数就足够了。其他两个默认构造（复制构造函数和赋值）都依赖于实例才能正常工作。如果没有默认构造函数，则无法创建实例，因此无法实际进入复制构造部分。

尽管将所有 3 个定义为私有且未实现，但它可能会为您省去一些麻烦。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-09T17:54:26.477

就像其他人所说，命名空间是您应该使用的。如果您想保留您的类，请创建一个具有私有构造函数并从中派生的类，以使您的意图显而易见：

```
class NonConstructible { 
    NonConstructible();
};

class SuperUtils: NonConstructible {
    static void foo();
    // ...
    static std::vector<int> globalIDs;
    // ...
}; 
```

* * *

好的，现在让我们看看命名空间，这是唯一的方法：

```
namespace SuperUtils {
    void foo() {
        // ....
    }

    std::vector<int> globalIDs;
}; 
```

在这两种情况下都可以调用 using `SuperUtils::foo();`，但命名空间的优势在于，在作用域中，您可以使用命名空间声明和指令将某些或所有成员带入当前作用域，这样您就可以在不使用 using 的情况下引用它们`SuperUtils::`：

```
void superFunction() {
    using namespace SuperUtils;
    foo();
} 
```

虽然通常应该避免这种情况，但当该方法专门使用 SuperUtils 中的很多东西时，它会很有帮助，这样可以提高代码的可读性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-09T17:20:00.790

为了使用复制构造函数，你必须有一个要复制的对象，所以如果你锁定了默认构造函数，你应该是安全的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T08:35:36.823

防止创建非堆对象的最佳方法是将析构函数设为私有。然后编译器无法在超出范围时破坏对象并且它会抱怨。然而，这不会阻止任何人做新的事情。

# c# - Create pointer to parent object in deserialization process in C#

> ID：353558
> 
> 赞同：6
> 
> 时间：2008-12-09T17:20:24.970
> 
> 标签：c#, reference, serialization, parent-child

I have a classes like:

```
[Serializable]
public class child {
     public Parent parent;
}

[Serializable]
public class Parent {
  public List<child> children;
} 
```

When I deserialize Parent, I want each of each children to have a reference to it's parent. Question is, where in the deserialization process can I set the child's "parent" pointer? I can't seem to use a custom constructor for child, because deserialization always uses the default constructor. If I implement ISerializable, then it seems that the child objects have already been created by the time the parent is created. Is there another way to achieve this?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-03-16T19:37:48.430

`BinaryFormatter`对于,`XmlSerializer`和，循环引用的处理方式不同`DataContractSerializer`。

默认情况下[`BinaryFormatter`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatters.binary.binaryformatter.aspx)支持循环引用，无需任何工作：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Runtime.Serialization;
using System.Runtime.Serialization.Formatters.Binary;

[Serializable]
public class Child
{
    public Guid Id { get; set; }

    public Parent parent;
}

[Serializable]
public class Parent
{
    public Guid Id;

    public List<Child> Children;
}

class Program
{
    static void Main(string[] args)
    {
        Child c1 = new Child { Id = Guid.NewGuid() };
        Child c2 = new Child { Id = Guid.NewGuid() };

        Parent p = new Parent { Id = Guid.NewGuid(), Children = new List<Child> { c1, c2 } };

        c1.parent = p;
        c2.parent = p;

        using (var stream1 = new MemoryStream())
        {
            BinaryFormatter formatter = new BinaryFormatter();
            formatter.Serialize(stream1, p);
            stream1.Position = 0;

            var deserializedParent = formatter.Deserialize(stream1) as Parent;
            foreach (var child in deserializedParent.Children)
            {
                Console.WriteLine("Child Id: {0}, Parent Id: {1}", child.Id, child.parent.Id);
            }
        }

        Console.ReadLine();
    }
} 
```

使用 时[`XmlSerializer`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)，通过不序列化子级对父级的引用来避免循环引用，并确保在反序列化过程中关系是固定的。这是通过实现[`IXmlSerializable`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)接口和处理序列化和反序列化来完成的。

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Runtime.Serialization;
using System.Runtime.Serialization.Formatters.Binary;
using System.Text;
using System.Threading.Tasks;
using System.Xml;
using System.Xml.Linq;
using System.Xml.Serialization;

namespace XmlSerialization
{

    [Serializable]
    public class Child
    {
        public Guid Id { get; set; }

        [XmlIgnore] // Don't serialize the reference to the parent
        public Parent parent;
    }

    [Serializable]
    public class Parent : IXmlSerializable
    {
        public List<Child> Children;

        public Guid Id;

        public System.Xml.Schema.XmlSchema GetSchema()
        {
            return null;
        }

        public void ReadXml(System.Xml.XmlReader reader)
        {
            XElement xml = XElement.ReadFrom(reader) as XElement;
            if (xml != null)
            {
                // Deserialize Children
                Children = 
                    xml.Descendants("Child")
                       .Select(x => new Child() { Id = Guid.Parse(x.Element("Id").Value), parent = this })
                       .ToList();

                // Deserialize Id
                Id = Guid.Parse(xml.Attribute("Id").Value); 
            }
        }

        public void WriteXml(System.Xml.XmlWriter writer)
        {
            // Serialize Id
            writer.WriteAttributeString("Id", Id.ToString());

            // Serialize Children
            XmlSerializer childSerializer = new XmlSerializer(typeof(Child));
            foreach (Child child in Children)
            {
                childSerializer.Serialize(writer, child);
            }
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            Child c1 = new Child { Id = Guid.NewGuid() };
            Child c2 = new Child { Id = Guid.NewGuid() };

            Parent p = new Parent { Id = Guid.NewGuid(), Children = new List<Child> { c1, c2 } };

            c1.parent = p;
            c2.parent = p;

            using (var stream1 = new MemoryStream())
            {
                XmlSerializer formatter = new XmlSerializer(typeof(Parent), new Type[] { typeof(Child) }) ;
                formatter.Serialize(stream1, p);
                stream1.Position = 0;

                stream1.Position = 0;

                var deserializedParent = formatter.Deserialize(stream1) as Parent;
                foreach (var child in deserializedParent.Children)
                {
                    Console.WriteLine(string.Format("Child Id: {0}, Parent Id: {1}", child.Id,  child.parent.Id ));
                }
            }

            Console.ReadLine();
        }

    }
} 
```

使用时[`DataContractSerializer`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.aspx)，在序列化和反序列化 DataContract 时使用特性的[IsReference](http://msdn.microsoft.com/en-us/library/hh241056.aspx)属性`DataContract`启用引用跟踪。

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Runtime.Serialization;
using System.Runtime.Serialization.Formatters.Binary;

[DataContract(IsReference = true)]
public class Child
{
    [DataMember]
    public Guid Id { get; set; }

    [DataMember]
    public Parent parent;
}

[DataContract(IsReference = true)]
public class Parent
{
    [DataMember]
    public Guid Id;

    [DataMember]
    public List<Child> Children;
}

class Program
{
    static void Main(string[] args)
    {
        Child c1 = new Child { Id = Guid.NewGuid() };
        Child c2 = new Child { Id = Guid.NewGuid() };

        Parent p = new Parent { Id = Guid.NewGuid(), Children = new List<Child> { c1, c2 } };

        c1.parent = p;
        c2.parent = p;

        using (var stream1 = new MemoryStream())
        {
            DataContractSerializer formatter = new DataContractSerializer(typeof(Parent));
            formatter.WriteObject(stream1, p);
            stream1.Position = 0;

            var deserializedParent = formatter.ReadObject(stream1) as Parent;
            foreach (var child in deserializedParent.Children)
            {
                Console.WriteLine("Child Id: {0}, Parent Id: {1}", child.Id, child.parent.Id);
            }
        }

        Console.ReadLine();
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T17:28:10.400

如果您不理会它，让 Parent 成为 Child 类的公共读/写属性，.NET 自动序列化过程将正确处理它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-03-16T18:52:50.963

如果自动反序列化不起作用，您可以让您的 Parent 类实现[IDeserializationCallback 接口](http://msdn.microsoft.com/en-us/library/7y2ty1t2.aspx)，并在[OnDeserialization 方法](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.ideserializationcallback.ondeserialization.aspx)中更新子类。

```
[Serializable]
class Parent : IDeserializationCallback 
{
  public List<child> children;

  void IDeserializationCallback.OnDeserialization(Object sender) 
  {
    if (null != children)
    {
      children.ForEach(c => c.parent = this);
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T17:31:24.450

我通过覆盖子对象的集合类中的 Add 方法来完成这个（某种程度上），用父对象的唯一标识符在子类中“设置”一个属性值

```
 public class Connections: List<Connection>
    {       public new void Add(Connection connection)
        {
            connection.ApplicationName = ApplicationName;
            base.Add(connection);
        }
    } 
```

# c# - How to create a C# Winforms Control that hovers

> ID：353561
> 
> 赞同：10
> 
> 时间：2008-12-09T17:21:23.300
> 
> 标签：c#, .net, winforms, user-controls, user-interface

How can you create a C# Winforms control which goes out of the bounds of its region? Such as a drop down box. Kind of like if you had a DropDownBox in a Small Sized Panel.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-09T21:41:00.577

Windows 窗体不能很好地支持这样的窗口，它与设计器根本不兼容。这里有一些代码可以帮助您入门。您不能在设计器中使用此控件，它必须在运行时创建。您还必须自己调用它的 Dispose() 方法。

```
using System;
using System.Drawing;
using System.ComponentModel;
using System.Windows.Forms;

public class MyListBox : ListBox {
  private Control mParent;
  private Point mPos;
  private bool mInitialized;

  public MyListBox(Control parent) {
    mParent = parent;
    mInitialized = true;
    this.SetTopLevel(true);
    parent.LocationChanged += new EventHandler(parent_LocationChanged);
    mPos = mParent.Location;
  }

  public new Point Location {
    get { return mParent.PointToClient(this.Location); }
    set { 
      Point zero = mParent.PointToScreen(Point.Empty);
      base.Location = new Point(zero.X + value.X, zero.Y + value.Y);
    }
  }

  protected override Size DefaultSize {
    get {
      return mInitialized ? base.DefaultSize : Size.Empty;
    }
  }

  protected override void SetBoundsCore(int x, int y, int width, int height, BoundsSpecified specified) {
    if (this.mInitialized)
      base.SetBoundsCore(x, y, width, height, specified);
  }

  void parent_LocationChanged(object sender, EventArgs e) {
    base.Location = new Point(base.Left + mParent.Left - mPos.X, base.Top + mParent.Top - mPos.Y);
    mPos = mParent.Location;
  }

  protected override CreateParams CreateParams {
    get {
      CreateParams cp = base.CreateParams;
      if (mParent != null && !DesignMode) {
        cp.Style = (int)(((long)cp.Style & 0xffff) | 0x90200000);
        cp.Parent = mParent.Handle;
        Point pos = mParent.PointToScreen(Point.Empty);
        cp.X = pos.X;
        cp.Y = pos.Y;
        cp.Width = base.DefaultSize.Width;
        cp.Height = base.DefaultSize.Height;
      }
      return cp;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T19:08:00.697

我最近做了类似的事情，我使用了一个 ListBox。对列表框的一个很酷的想法是，您可以在任何您想要的地方显示它，甚至超出您的控制范围。这样，当您通过按钮单击或其他方式检测到您需要显示所需的 DropDown 时，只需填充 ListBox 并将其显示在您想要的任何位置。我从这里得到了这个想法：

[http://msdn.microsoft.com/en-us/library/aa480727.aspx](http://msdn.microsoft.com/en-us/library/aa480727.aspx)

他们展示了如何使用过滤构建自定义 DataGridView，为了显示过滤器值，他们在标题单元格下放置了一个 ListBox。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T01:47:01.280

这里有一篇很好的文章：

[http://www.vbaccelerator.com/home/NET/Code/Controls/Popup_Windows/Popup_Windows/article.asp](http://www.vbaccelerator.com/home/NET/Code/Controls/Popup_Windows/Popup_Windows/article.asp)

这有一个类可以处理使其正常工作的一些棘手方面，例如保持应用程序窗口标题栏处于活动状态、处理 Alt-Tab 和通过鼠标单击取消。

# c# - 什么是 String.CopyTo？

> ID：353569
> 
> 赞同：2
> 
> 时间：2008-12-09T17:25:03.307
> 
> 标签：c#

谁能解释为什么这段代码的输出只是“你好”以及这段代码的含义？

```
( 0, characterArray, 0, characterArray.Length ); 
```

输出显示：

```
字符数组为：你好
```

代码如下：

```
string string1 = "hello there";
char[] characterArray = new char[ 5 ];

string1.CopyTo( 0, characterArray, 0, characterArray.Length );
Console.Write( "\nThe character array is: " );

for ( int i = 0; i < characterArray.Length; i++ )
    Console.Write( characterArray[ i ] ); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-09T17:28:19.900

这是因为您的数组仅设置为 5 个字符。将其扩展到 11，它将起作用。

Copyto 是这样的：

```
public void CopyTo(
    int sourceIndex,
    char[] destination,
    int destinationIndex,
    int count
) 
```

```
参数
源索引
类型：系统..::.Int32
本例中的字符位置。

目的地
类型：数组[]()[]
Unicode 字符数组。

目的地索引
类型：系统..::.Int32
目标中的数组元素。

数数
类型：系统..::.Int32
此实例中要复制到目标的字符数。

```

取自：http: [//msdn.microsoft.com/en-us/library/system.string.copyto.aspx](http://msdn.microsoft.com/en-us/library/system.string.copyto.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T17:28:36.500

它只显示“你好”，因为您的字符数组只有 5 个字符长。至于 CopyTo 的参数，请阅读[http://msdn.microsoft.com/en-us/library/system.string.copyto.aspx](http://msdn.microsoft.com/en-us/library/system.string.copyto.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T17:31:31.033

那是因为你的字符数组大小只有 5。如果你想把整个字符串作为一个数组，你可以用 string.ToCharArray 代替

# python - 初学者：试图了解应用程序在 Django 中的交互方式

> ID：353571
> 
> 赞同：29
> 
> 时间：2008-12-09T17:25:23.993
> 
> 标签：python, django, django-models, django-apps

我刚刚完成了第二次 Django 教程的工作，现在我对事情的理解更加清楚了。但是，我仍然不清楚站点内的应用程序如何相互交互。

例如，假设我正在编写一个博客应用程序（显然是一个相当流行的活动）。博客文章和评论往往会一起出现，但它们又足够不同，以至于它们应该被构建到单独的应用程序中，这也是 Djano 开发的一般理念。

考虑以下示例。实际上，我实际上不会自己编写评论应用程序，因为网络上已经存在很好的代码，但这是出于演示/实践目的：

**我的网站/博客/models.py**

```
from django.db import models

class post(models.Model):
    title = models.CharField(max_length=200)
    author = models.CharField(max_length=200)
    content = models.TextField() 
```

**我的网站/评论/models.py**

```
from django.db import models
from mysite.blog.models import post

class comment(models.Model):
    id = models.AutoField()
    post = models.ForeignKey(post)
    author = models.CharField(max_length=200)
    text = models.TextField() 
```

是我上面写的，从另一个应用程序导入模型并将其设置为外键，Django 应用程序如何交互？或者是否有不同/更好的方法让组成网站的应用程序进行交互？

**更新**
根据一个回复中的建议，我正在阅读 contrib.contenttypes 的文档。如果我没看错，我可以像这样重写我的示例评论应用程序：

```
from django.db import models  
from django.contrib.contenttypes.models import ContentType
from django.contrib.contentypes import generic

class comment(models.Model):  
    id = models.AutoField()  
    author = models.CharField(max_length=200)  
    text = models.TextField()  
    content_type = models.ForeignKey(ContentType)  
    content_object = generic.GenericForeignKey(content_type, id) 
```

这是正确的吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-09T18:01:25.200

看看 django 内置的[contenttypes 框架](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#ref-contrib-contenttypes)：

`django.contrib.contenttypes`

它允许您将应用程序开发为独立单元。这是 django 开发人员用来允许 django 的内置[评论框架](http://docs.djangoproject.com/en/dev/ref/contrib/comments/#ref-contrib-comments-index)将评论附加到项目中的任何模型的方法。

例如，如果您有一些内容对象要“附加”到其他不同类型的内容对象上，例如允许每个用户在博客文章、图像或用户个人资料上留下“最喜欢”的星标，您可以创建一个`Favorite`具有[通用关系字段](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#generic-relations)的模型，如下所示：

```
from django.db import models
from django.contrib.auth.models import User
from django.contrib.contenttypes.models import ContentType
from django.contrib.contenttypes import generic

class Favorite(models.Model):
    user = models.ForeignKey(User)
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    content_object = generic.GenericForeignKey('content_type', 'object_id') 
```

通过这种方式，您可以将`Favorite`来自任何用户的星添加到项目中的任何模型。如果您想通过接收者模型类添加 API 访问，您可以在接收者模型上添加一个[反向通用关系字段](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#reverse-generic-relations)（尽管这将“耦合”这两个模型，您说过要避免），或者进行查找通过带有接收者实例的和的`Favorite`模型，请参阅[官方文档](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#reverse-generic-relations)以获取示例。`content_type``object_id`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-09T18:06:38.637

“是我上面写的，从另一个应用程序导入模型并将其设置为外键，Django 应用程序如何交互？”

是的。为我工作。

我们有大约 10 个应用程序在它们之间来回借用。

这导致了我们的单元测试脚本中的一种依赖。

它看起来像这样。

*   “所有权”。我们有一个简单的数据所有权应用程序，它定义了其他应用程序所依赖的一些核心所有权概念。这里有一些简单的表格。

*   “事物”。[不是真实姓名]。我们的事物应用程序具有不同用户组拥有的数据元素。这个应用程序的模型实际上有几个复杂的表。这取决于“所有权”。

*   “表”。[不是真实姓名]。我们的一些用户创建了相当复杂的离线模型（可能使用电子表格）并将该建模的结果上传到“表格”中。这有一组相当复杂的表。这取决于“所有权”。

*   “结果”。[不是真实姓名]。我们的结果基于拥有所有者的事物。结果基于事物和表格，并且是对客户请求的响应。这并不太复杂，可能只有两三个核心表。这取决于“事物”和“桌子”。不，它并不完全独立。但是，与它所依赖的其他事物相比，它会发生更多的变化。这就是为什么它是分开的。

*   “加工”。我们安排和监控大批量作业。这是在这个应用程序中。它非常通用，可以以多种方式使用。它完全独立。

*   “欢迎”。我们有一个“欢迎”应用程序，它展示了一堆大部分是静态的页面。这没有太多的桌子。但它是第二个化身，因为第一个太复杂了。它完全独立。

依赖应用程序之间的唯一关系是一些表名。只要我们保留这些表（及其键），我们就可以按照我们认为合适的方式重新排列其他应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-09T18:35:09.047

使某些应用程序依赖于另一个应用程序没有任何问题（恕我直言）。毕竟，应用程序只是对一组模型的操作。您只需要始终了解哪个应用程序依赖于哪个应用程序（我想您可以将其称为依赖关系图）。

您可以使用 contenttypes 框架实现松散耦合。它允许应用程序真正可移植/可插入，但仍与其他应用程序集成。

我写了一个评论应用程序（是的，我重新发明了轮子），它可以集成到任何其他应用程序中，在应该发布评论的页面模板中有几行（使用自定义标签）。

假设您希望模型“线程”可以插入任何其他模型。这个想法是创建一个通用外键（参见 django 文档），并编写一个小函数，该函数接受任何对象并返回与其对应的“线程”（或在必要时创建一个），并编写一个自定义模板标签使用该功能，例如`{% get_thread for arbitrary_object as thread %}`. 所有帖子都与一个线程相关，该线程与对象相关，可以是任何类型。

您可以将“线程”对象视为一种代理，因此帖子不会与某个“文章”或“博客文章”相关，而只是与线程相关，这在某种意义上是抽象的，什么*是*线程？这只是一个帖子的集合。然后，线程允许自己与任何对象相关，而不管其类型如何。（虽然它做的不止这些，它还可以保存额外的信息，例如允许/禁止匿名发帖、关闭/打开页面上的评论等..）

**编辑**

以下是使用内容类型框架创建通用外键的方法：

```
from django.contrib.contenttypes import generic
from django.contrib.contenttypes.models import ContentType

class Thread( models.Model ):
    object_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    object = generic.GenericForeignKey('object_type', 'object_id') 
```

您可以通过利用 django 假定所有对象都实现的隐式“通用”接口使其更加“透明”。

```
 #inside the Thread class:
    def __unicode__(self):
        return unicode(self.object)
    def get_absolute_url(self):
        return self.object.get_absolute_url() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-09T17:45:34.750

您的代码似乎正确。不过，我会将帖子和评论保留在**博客**应用程序中。我不是说这是*Django 的*方式，但这些模型足够接近，可以在同一个应用程序中。

### 如何划分项目

如果出现以下情况，我会分开一个应用程序；

*   我计划将其设计为可重复使用的。（并尝试松散耦合）
*   （对于大型项目）它由项目的主要部分组成。

另一方面; 拥有许多小型应用程序（例如具有单个模型和两个视图的应用程序）很难阅读和维护恕我直言。

### 应用程序应如何交互

这又取决于项目的类型和应用程序的类型。例如，如果一个应用程序隐式依赖于另一个应用程序（即非通用），那么导入和使用来自另一个应用程序的引用是可以接受的。在这种情况下，可能会单独安装第二个应用程序，但第一个应用程序需要第二个应用程序的存在。

如果您想让应用程序具有高度可重用性和通用性，例如评论应用程序，您可能需要集成一些设置机制。也许一些新设置或额外的 URL 配置，或模型上的特殊指令/方法......`django.contrib.admin`就是一个很好的例子。

如果没有必要，应用程序不应交互。设计应用程序以避免不必要的耦合非常有用。它提高了您的应用程序的灵活性并使其更易于维护（但可能需要更高的集成成本）。

# windows - 第三方应用程序的 Windows 集中配置？

> ID：353582
> 
> 赞同：2
> 
> 时间：2008-12-09T17:28:11.007
> 
> 标签：windows, configuration, centralized

我们正在寻找一种配置应用程序各种“端点”的标准方法。我们的应用程序是一个带有 Windows 桌面应用程序、Windows Server“服务”和数据库的分布式系统。我们目前使用 XML 文件配置每个部分。当我们与可以拥有数十台服务器运行我们的应用程序和数百个桌面客户端的大客户合作时，这有点失控了。

谁能推荐一种 Microsoft 技术或第三方，使我们能够集中所有配置信息并在一个地方为我们的所有应用程序管理它？任何更改都将被“推送”到感兴趣的端点。

例如，如果我们要更改其中一个数据库的登录名，我们将在数据库上进行该更改，然后将该更改反映在我们的集中式系统中。在最后一步之后，任何需要连接到数据库的服务都会收到更改通知（并可能接收新数据）。每个端点如何以及如何处理该信息超出了系统的范围。

我们的主要业务不是“集中配置服务”。我们是一家 GIS 公司，为全球各种公用事业提供解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-15T21:27:48.780

多年来，我做了几件事来赋予自己这个功能。我构建了可以分布在许多服务器上的企业应用程序。我不想将配置设置隐藏在每个服务配置文件或每个 Web 服务器的 web.config 文件中。对于特定于应用程序的东西，我通常在应用程序的数据库中创建一个应用程序设置表。该表只有两个字段。设置名称和设置值。然后我编写了一个 web 或 wcf 服务，它的唯一功能是检索这些设置。我编写了一个名为 GetSetting 的函数，您可以在其中传递“SettingName”，如果找不到您的设置，它会返回 SettingValue 或空字符串。这样，我可以将应用程序所有组件的所有应用程序设置存储在一个位置。维护和故障排除真的很容易，我'

对于更大规模的应用程序，我可能会创建一个单独的 AppSettings 数据库，在上面提到的表中添加一个新字段。应用名称。我的这种方法的 web 或 wcf 服务仅在此范围内具有相同的方法调用 (GetSetting)，我传递 ApplicationName 和 SettingName，它返回 SettingValue 或空字符串。

执行这些操作中的任何一个都可以让您集中所有应用程序设置，适用于任何规模的应用程序或 IT 商店。它对我们来说非常有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T22:06:57.890

您可以将 RSS 与 BitTorrent 一起使用来分发更改。参见[维基百科](http://en.wikipedia.org/wiki/Rss#BitTorrent_and_RSS)。然而，它不是特定于 MS 的，但应该提供您需要的灵活性 - 配置服务器保存配置并提供配置客户端和可能的服务器所需的提要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T17:55:06.087

任何通过安全通道的 VCS？

例如，通过 ssh 的 git（在 cygwin 中都可用）。

我认为第一步是拥有安全通道（如果您想要推送能力，拉动可能会有所不同）。

至于管理不同“分支”中的“版本”，有什么比版本控制系统更好的呢？

就 Microsoft 的要求而言，该领域中存在的 Microsoft 软件在您的情况下会非常糟糕（因为这不是该工作的最佳工具）。

# clickonce - 如何使用 MSBuild 将 ClickOnce 构建发布到 CD

> ID：353592
> 
> 赞同：1
> 
> 时间：2008-12-09T17:31:37.693
> 
> 标签：clickonce

有谁知道如何使用 MSBuild 中的发布任务为 CD 创建 ClickOnce 发布？

VS2008 有一个“发布向导”，带有一个发布到 CD 单选按钮选项。一旦安装到适合刻录到 CD 的本地文件夹，它就会发布单击。

我们正在按照计划的 MSBuild 进行后处理步骤，在这些步骤中我们对其进行配置并将其安装到给定的环境中，并且我们希望有一种可编写脚本的方式来生成 ClickOnce 输出的 CD。

我已经能够使此过程适用于 Web 安装和文件共享安装，但似乎“发布向导”执行了一些我无法发现的隐藏步骤。

我想将发布对话框、发布向导、msbuild 发布目标、mage.exe 和 mageui.exe 中的各种属性关联起来。有些项目具有相同的名称，有些在对话框和属性之间有所不同，有些可以在一个区域中设置，但不能在另一个区域中设置。

我可以看到自动化 ClickOnce 是可以做到的，但总的来说，它似乎是一种 GUI 技术，而编写脚本似乎违背了它的原则。

账单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T18:12:14.820

好吧，我已经回答了我自己的问题。

这是Http编码的问题！

发布应用程序时，您最终会得到如下文件夹结构：C:\myApp\Application Files\version 1

当您更改已发布应用程序的内容时（就像您想要替换配置文件时所做的那样），您必须重新签署应用程序和部署清单。

当你这样做时，MageUi.exe HttpEncodes 应用程序清单的“位置”。

所以现在，部署清单表明您的应用程序清单的本地文件路径类似于：Application%20Files\myApp_version\myApp.exe.manifest

并且由于该路径不存在，因此它会导致所谓的基于 CD 的安装从 http: 更新服务器实际安装（如果存在），如果不存在则失败

我们的解决方法是将“Application Files”重命名为“ApplicationFiles”。

难以置信的...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T23:41:52.953

除此之外，它似乎与在发布步骤的输出上运行 MageUi 有关。

如果我从命令行使用 MSBuild 发布，则如下所示：

```
msbuild  C:\myapp.vbproj /target:publish `
/property:PublishDir=c:\ClickOnce\ `
/property:SolutionDir=C:\trunk\myapp\ `
/property:TargetZone=LocalIntranet `
/property:MapFileExtensions=True `
/property:PublisherName='my publisher' `
/property:ProductName='myProduct' `
/property:BootstrapperEnabled=True `
/property:IsWebBootstrapper=False `
/property:GenerateManifests=True `
/property:ApplicationVersion=1.2.3.4 `
/property:Configuration=Debug `
/property:UpdateUrl=http://localhost/ClickOnce/ `
/property:UpdateEnabled=True `
/property:Install=True 
```

然后我创建一个可从 CD 安装的文件夹。

当我操作配置文件，并将来自另一个进程的附加输出添加到发布文件夹，然后使用 MageUI 重新生成应用程序和部署清单时，我创建了一个基于文件的安装，该安装实际上是从 updateURL 安装的。如果我断开与 Internet 的连接，我会收到“无法连接到远程服务器”异常，因此它不仅要检查更新，还要坚持从 Web 服务器安装。

# silverlight - 我可以使用适当的 crossdomain.xml 文件从 Silverlight 跨域访问 ADO .Net 数据服务，而无需依赖 ADO .Net Silverlight 客户端吗？

> ID：353595
> 
> 赞同：0
> 
> 时间：2008-12-09T17:33:00.657
> 
> 标签：silverlight, wcf-data-services

如果我创建 ADO .Net 数据服务，只要我不使用 ADO .Net Silverlight 客户端帮助程序并且我有适当的 crossdomain.xml 文件，我是否可以跨域从 Silverlight 访问它？（我基本上只是获取原始 xml 并自己解析它）

换一种方式问，是不允许跨域调用的 ADO .Net 数据服务 Silverlight 客户端组件，还是 ADO .Net 数据服务本身？

我认为它是客户端组件，但需要一些确认。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T22:45:44.837

我写过关于使用服务器端代理来制作 Silverlight 客户端库以及托管在不同域上的 DataServices 的文章。 [http://blogs.msdn.com/phaniraj/archive/2008/10/21/accessing-cross-domain-ado-net-data-services-from-the-silverlight-client-library.aspx](http://blogs.msdn.com/phaniraj/archive/2008/10/21/accessing-cross-domain-ado-net-data-services-from-the-silverlight-client-library.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T13:59:18.113

经过进一步调查，我发现正如我所怀疑的那样，ADO .Net 数据服务**Silverlight 客户端**将通信限制为来自同一域的调用。（不是 ADO .Net 数据服务本身）

这显然将在 Silverlight 的未来版本中得到解决。

# xml - 错误：只能生成类或数据集之一

> ID：353596
> 
> 赞同：6
> 
> 时间：2008-12-09T17:33:51.370
> 
> 标签：xml, visual-studio, visual-studio-2008, xsd.exe

我已将数据集从一个 csproj 复制到另一个，新项目收到以下编译警告：“自定义工具 'MSDataSetGenerator' 在处理文件 'Client.xsd' 时失败。”

在研究这个警告时，我发现如果我打开 VS cmd 提示符并直接在 xsd 文件上运行 XSD.exe，我会得到更多信息。它说：“错误：只能生成类或数据集之一。”

修复此问题的命令行标志是运行：XSD /d {xsdfilename}

如果我在 cmd 行上运行它，它会生成数据集代码就好了。但我不知道如何让 Visual Studio 做到这一点。有人知道吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T15:57:13.267

我发现的技巧是删除（或重命名为临时文件以确保安全）与 DataSet 关联的 Client.vb 或 Client.cs 文件的名称。这样，当您将文件添加到项目时，它将检测适当的 XML 相关数据并为您生成一个新类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T15:54:44.643

我遇到了同样的问题，并为此找到了手动解决方法。

1.  打开项目中 XSD 文件的属性。
2.  从自定义工具属性中删除 MSDataSetGenerator 条目。
3.  为自定义工具属性重新添加 MSDataSetGenerator 值。

当您将 MSDataSetGenerator 值粘贴回并按 Enter 键时，它将重新生成所需的文件。

当我找到更好的解决方案时，我一定会在这里发帖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-12T13:11:18.413

如果您右键单击项目中的 XSD 文件，则会出现“运行自定义工具”选项。如果 XSD 的自定义工具属性设置为 MSDataSetGenerator，这将重新生成该类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-29T16:52:24.883

就我而言，这个错误：

```
Error: Can only generate one of classes or datasets. 
```

是因为我忘记在 xsd 命令中添加**/c参数：**

```
"C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.6.1 Tools\xsd.exe" /c myfile.cs 
```

# c# - 使用 C# 捕获 nslookup shell 输出

> ID：353601
> 
> 赞同：7
> 
> 时间：2008-12-09T17:37:21.333
> 
> 标签：c#, shell, .net-2.0, nslookup

我有一个命令行过程，我想在 C# 中自动化和捕获。

在命令行中，我键入：

```
nslookup 
```

这会启动一个 shell，它给我一个 > 提示。在提示符下，我然后键入：

```
ls -a mydomain.local 
```

这将返回来自我的主 DNS 服务器的本地 CNAME 列表以及它们所连接的物理计算机。

我想做的是从 C# 自动化这个过程。如果这是一个简单的命令，我将只使用 Process.StartInfo.RedirectStandardOutput = true，但第二步的要求让我很受挫。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-09T17:48:23.260

```
ProcessStartInfo si = new ProcessStartInfo("nslookup");
si.RedirectStandardInput = true;
si.RedirectStandardOutput = true;
Process nslookup = new Process(si);
nslookup.Start();
nslookup.StandardInput.WriteLine("ls -a mydomain.local");
nslookup.StandardInput.Flush();
// use nslookup.StandardOutput stream to read the result. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T18:27:33.557

不是你问的，但我曾经写过一个应用程序来做你正在做的事情。我最终转而使用 .NET 库进行 DNS 查找，结果证明速度要快得多。

我很确定我使用了 CodeProject 网站上的[这个库](http://www.codeproject.com/KB/IP/DNS_NET_Resolver.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-06T14:14:44.270

我知道这是一个旧的，但仍然喜欢贡献。我使用“NsLookup Hostname Server”的 shell 输出从我们域中的计算机名中获取 IPv4 地址，并删除任何其他信息，如 DNS 服务器/ipv6 地址。

这有点快，但它有效，如果 shell 失败，您将使用 C# 中的内置 nslookup 方法，还会添加一个故障转移。

它相当长，但它让我可以在不使用外部库或不使用内置 nslookup 函数的情况下从 shell 读取 ipv4，因为它确实允许选择 dns 服务器。

如果您想知道中间的 if 循环，可能会有更优雅的解决方案，但对于我个人而言，效果很好，我们域中的大多数主机返回 2 个 ipv6 和 2 个 ipv4，因此，它最多测试 4 次.

希望这可以帮助..

```
 private void button1_Click(object sender, EventArgs e)
    {
        IPAddress[] ips = NsLookup(computername, dnsserver);

        txtResult.Text = string.Empty;
        if (ips != null)
        {
            txtResult.Text = ips[0].ToString();
            txtResult.Text += Environment.NewLine;
            if (ips[1] != null)
            {
                txtResult.Text += ips[1].ToString();
            }
            else
            {

            }
        }
        else
        {
            txtResult.Text = "No IP found";
        }

    }

    public IPAddress[] NsLookup(string computername, string domaincontroller)
    {

        IPAddress[] ips = new IPAddress[2];

        try
        {
            // Creating streamreaders to read the output and the errors
            StreamReader outputReader = null;
            StreamReader errorReader = null;

            string nslookup = @"C:\Windows\System32\Nslookup.exe";

            try
            {
                // Setting process startupinfo
                ProcessStartInfo processStartInfo = new ProcessStartInfo(nslookup, computername + " " + domaincontroller);
                processStartInfo.ErrorDialog = false;
                processStartInfo.UseShellExecute = false;
                processStartInfo.RedirectStandardError = true;
                processStartInfo.RedirectStandardInput = true;
                processStartInfo.RedirectStandardOutput = true;
                processStartInfo.WindowStyle = ProcessWindowStyle.Minimized;

                // Starting Process
                Process process = new Process();
                process.StartInfo = processStartInfo;
                bool processStarted = process.Start();

                if (processStarted)
                {
                    // Catching the output streams
                    outputReader = process.StandardOutput;
                    errorReader = process.StandardError;

                    string errorresult = errorReader.ReadLine();

                    errorReader.Close();

                    if (errorresult != null)
                    {
                       // Failure got thrown in NsLookup Streamreading, try build-in Method
                       try
                       {
                            ips = Dns.GetHostAddresses(computername);
                            return ips;
                       }
                       catch
                       {
                            return null;
                       }
                }
                else
                {
                    // Clearing out all the values before the addresses.
                    outputReader.ReadLine();
                    outputReader.ReadLine();
                    outputReader.ReadLine();
                    outputReader.ReadLine();

                    // Reading and Verifying the first outputline (the address is found after "Addresses:  ") - 2 part of the array is taken (after second space)
                    string outputline = outputReader.ReadLine();
                    string[] outputlineaftersplit = outputline.Split(' ');
                    string ipfortesting = outputlineaftersplit[2].Trim();

                    if (verifyIP(ipfortesting) != null)      // First entry is ipv4
                    {
                        ips[0] = verifyIP(ipfortesting);

                        outputline = outputReader.ReadLine();
                        ipfortesting = outputline.Trim();

                        if (verifyIP(ipfortesting) != null) // First and second entry are ipv4
                        {
                            ips[1] = verifyIP(ipfortesting);
                            return ips;
                        }
                        else
                        {
                            return ips;
                        }
                    }
                    else
                    {
                        outputline = outputReader.ReadLine();
                        ipfortesting = outputline.Trim();

                        if (verifyIP(ipfortesting) != null)
                        {
                            ips[0] = verifyIP(ipfortesting);

                            outputline = outputReader.ReadLine();
                            ipfortesting = outputline.Trim();

                            if (verifyIP(ipfortesting) != null)
                            {
                                ips[0] = verifyIP(ipfortesting);

                                outputline = outputReader.ReadLine();
                                ipfortesting = outputline.Trim();

                                if (verifyIP(ipfortesting) != null)
                                {
                                    ips[1] = verifyIP(ipfortesting);
                                    return ips;
                                }
                                else
                                {
                                    return ips;
                                }

                            }
                            else
                            {
                                return ips;
                            }
                        }
                        else
                        {
                            outputline = outputReader.ReadLine();
                            ipfortesting = outputline.Trim();

                            if (verifyIP(ipfortesting) != null)
                            {

                                ips[0] = verifyIP(ipfortesting);

                                outputline = outputReader.ReadToEnd();
                                ipfortesting = outputline.Trim();

                                if (verifyIP(ipfortesting) != null)
                                {
                                    ips[1] = verifyIP(ipfortesting);
                                    return ips;
                                }
                                else
                                {
                                    return ips;
                                }

                            }
                            else
                            {
                                ips = null;
                                return ips;
                            }
                        }
                    }
                }
                }

                else
                {
                    // Failure got thrown in NsLookup Streamreading, try build-in Method
                    try
                    {
                        ips = Dns.GetHostAddresses(computername);
                        return ips;
                    }
                    catch
                    {
                        return null;
                    }
                }
            }
            catch
            {
                System.Windows.Forms.MessageBox.Show("ERROR 1");
                // Failure got thrown in NsLookup Streamreading, try build-in Method
                try
                {
                    ips = Dns.GetHostAddresses(computername);
                    return ips;
                }
                catch
                {
                    return null;
                }
            }
            finally
            {
                if (outputReader != null)
                {
                    outputReader.Close();
                }
            }
        }
        catch
        {
            System.Windows.Forms.MessageBox.Show("ERROR 2");
            // Failure got thrown in NsLookup Streamreading, try build-in Method
            try
            {
                ips = Dns.GetHostAddresses(computername);
                return ips;
            }
            catch
            {
                return null;
            }
        }

    }

    public IPAddress verifyIP(string ipfromreader)
    {
        IPAddress ipresult = null;
        bool isIP = IPAddress.TryParse(ipfromreader, out ipresult);

        if (isIP && (ipresult.AddressFamily != AddressFamily.InterNetworkV6))
        {
            return ipresult;
        }
        else
        {
            return null;
        }
    }

} 
```

}

# .net - Oxite：你打算用它做什么？

> ID：353605
> 
> 赞同：4
> 
> 时间：2008-12-09T17:41:12.480
> 
> 标签：.net, asp.net-mvc, content-management-system, oxite

微软发布了[Oxite](http://www.codeplex.com/oxite/Release/ProjectReleases.aspx?ReleaseId=20210)的源代码，他们的博客引擎旨在帮助 .NET 开发人员学习 ASP.NET MVC。他们还发布了使用 Oxite 构建的[Mix站点的源代码。](http://visitmix.com/)

微软表示，开发人员可以使用 Oxite 构建应用程序，因为它具有许多内置功能，如引用、pingback 和 RSS 支持。

你打算使用 Oxite 来学习 ASP.NET MVC 吗？你认为你可以用它做任何有用的事情吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-18T12:42:26.340

我会远离它。这是一个非常糟糕的例子。我不明白为什么微软把它放在互联网上。首先是安全原因，但是代码对于新开发人员来说很难阅读。我从预览版 2 开始使用 asp.net mvc，但仍然很难阅读该代码，因为它很糟糕。在堆栈溢出中可以找到或使用许多更好的示例。我个人建议在 Rob Connery 的网站或[Autumnofagile上观看截屏视频](http://www.autumnofagile.net)

[Karl Seguin 花时间总结了这一切](http://codebetter.com/blogs/karlseguin/archive/2008/12/15/oxite-oh-dear-lord-why.aspx)

[Rob Connery 为微软工作，但也不喜欢它](http://blog.wekeroad.com/blog/some-thoughts-on-oxite/)

[一个新词以它命名：Oxitis](http://frickinsweet.com/ryanlanciaux.com/post/Do-you-have-this-condition.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T15:57:24.747

我强烈建议不要将 Oxite 作为如何编写 ASP.NET MVC 应用程序的示例。以目前的形式，它存在根本性的缺陷，而且弊大于利。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T12:34:19.023

首先，当前形式的 Oxite 是博客引擎，而不是 CMS。您可以添加页面，但这几乎不是 CMS。其次，我将等着看本周会发生什么，因为 Rob Conery 正在对其进行一些严重的重构。迫切需要的重构。我认为凭借他的投入和团队的持续努力，它将克服许多人最初遇到的问题。所以我想我可能会采用它作为我的博客平台，并希望将它与我的 CMS 集成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T20:07:46.803

我以前没见过这个。看起来很有趣。

> 你打算用它做什么？

如果有人希望我编写一个 CMS 并指定我必须使用 .NET，那么我会将 oxite 视为 DotNetNuke 之类的可能替代方案。我对他们中的任何一个都不了解:-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T05:04:17.287

我下载了源代码，但在 Rob 重构它之前，我认为我无法对它做任何事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-12T21:18:38.473

我很好奇这个应用程序的意见是否有任何变化？我可能想试一试，尽管我也想将其视为使用 ASP.Net MVC 进行 MVC 开发的模型（可以这么说）。如果这不是一个很好的代码示例，是否有人对使用 ASP.Net MVC 堆栈的功能相对丰富并采用良好编码实践的替代应用程序提出建议？谢谢。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-09T19:30:46.597

我在 Mix 网站上读到，Oxite 源代码已经足够“组件化”，WebForms 开发人员也可以利用它。由于我还没有准备好为我的项目使用 ASP.NET MVC，Oxite 可能是我弄清楚如何从 WebForms 应用程序转换到 ASP.NET MVC 应用程序的好方法。

# sql-server - 帮助设置 Sql server 2005 安全性

> ID：353609
> 
> 赞同：0
> 
> 时间：2008-12-09T17:43:17.700
> 
> 标签：sql-server, sql-server-2005, security

我是 SQL Server 的新手，我的任务是在远程服务器上设置权限。我需要做的是限制域管理员访问特定服务器上的任何数据库。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T17:53:47.040

从 SA 组中删除 BUILTIN/Administrators。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T21:56:12.557

**重要的！**在您执行此操作之前，请确保您拥有：

*   “sa”帐户的密码或
*   您的域帐户是 sysadmin 服务器角色的成员

否则，您可能会发现自己被锁定在服务器之外.. 并不是说​​这曾经发生在我身上.. ;-)

# html - 如何使 LINQ to XML 和 HTML 一起工作？

> ID：353610
> 
> 赞同：1
> 
> 时间：2008-12-09T17:43:56.233
> 
> 标签：html, xml, linq-to-xml, parsing

我有一个 html 表

```
 <table border="0" width="100%">
        <tr class="headerbg">
            <th width="5%">
                No
            </th>
            <th width="30%">
                Name
            </th>
            <th width="20%">
                Department or Division
            </th>
            <th width="25%">
                Email
            </th>
            <th width="20%">
                Staff/Student
            </th>
        </tr>
        <tr class="bg2">
            <td>
                1
            </td>
            <td>
                <strong><a class="searchLink2" href="tel_search.php?fore=Dave&amp;sur=Rumber">Dave Rumber</a></strong>
            </td>
            <td>
                Medical School
            </td>
            <td>
                <a class="searchLink2" href="mailto:Dave.Rumber@Home.com">Dave.Rumber@Home.com</a>
            </td>
            <td>
                Student&nbsp;
            </td>
        </tr>
    </table> 
```

有时会出现不止一排人的结果。我希望能够遍历每一行并提取姓名和电子邮件信息并进行其他处理。将数据放入数据网格中，并可能放入数据库中。

我想我的问题是我该怎么做？

```
 string table = GetContents(buffer);

  table = table.Replace("&nbsp;", "");
  table = table.Replace("&", "&amp;");

  XElement inters = XElement.Parse(table); 
```

我可以将它放入 XElement，但我不太确定从这里去哪里！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T17:46:03.437

您实际上可以使用 HTML 表作为 OLE DB 的数据源：

[http://connectionstrings.com/html-table](http://connectionstrings.com/html-table)

完全披露：我实际上并没有尝试过这个 - 但我猜它会比尝试从 HTML 中解析 XML 容易得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T19:46:03.727

这是一些可以帮助您入门的手绘代码。不要在生产中这样做，这只是一个教育演示。

```
List<XElement> rows = inters
  .Descendants
  .Where(x => x.Name == "tr")
  .Skip(1) //header
  .ToList();
//
// and now to turn rows into people
List<Person> people = rows
  //filter to anchor.  should be two.
  .Select(r => r.Descendants.Where(a => a.Name = "a"))
  //Project each anchor pair into a Person
  .Select(g => new Person()
  {
    Name = g.First().Value,
    Email = g.Skip(1).First().Value
  })
  .ToList(); 
```

# c - printf/scanf 系列中的 %n 格式是否有任何实际应用？

> ID：353614
> 
> 赞同：17
> 
> 时间：2008-12-09T17:45:29.600
> 
> 标签：c, printf, scanf

```
int x;
printf("hello %n World\n", &x);
printf("%d\n", x); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-09T18:02:57.117

它对 不太有用`printf()`，但对 非常有用`sscanf()`，尤其是当您在多次迭代中解析字符串时。 `fscanf()`并`scanf()`根据读取的输入量自动推进其内部指针，但`sscanf()`不会。例如：

```
char stringToParse[256];
...
char *curPosInString = stringToParse;  // start parsing at the beginning
int bytesRead;
while(needsParsing())
{
    sscanf(curPosInString, "(format string)%n", ..., &bytesRead);  // check the return value here
    curPosInString += bytesRead;  // Advance read pointer
    ...
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-09T18:08:57.307

它可以用来[做恶事](http://en.wikipedia.org/wiki/Format_string_vulnerability)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-09T18:02:43.043

看你说的实用是什么意思。总是有其他方法可以完成它（例如，使用 s[n]printf 打印到字符串缓冲区并计算长度）。

然而

```
int len;
char *thing = "label of unknown length";
char *value = "value value value"
char *value2="second line of value";
printf ("%s other stuff: %n", thing, &len);
printf ("%s\n%*s, value, len, value2); 
```

应该产生

```
label of unknown length other stuff: value value value
                                     second line of value 
```

（虽然未经测试，但我不在 C 编译器附近）

作为一种对齐方式，这几乎是实用的，但我不想在代码中看到它。有更好的方法来做到这一点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-09T17:53:55.340

这是相当深奥的。如果您稍后需要在生成的字符串中替换占位符，您可能需要记住字符串中间的索引，这样您就不必保存原始 printf 参数或解析字符串。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-09T17:57:16.237

它可能被用作获取各种子字符串长度的快速方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-09T19:19:49.783

```
#include <stdio.h>
int main(int argc, char* argv[])
{
    int col10 = (10 - 1);
    int col25 = (25 - 1);

    int pos1 = 0;
    int pos2 = 0;

    printf("    5    10   15   20   25   30\n");

    printf("%s%n%*s%n%*s\n",                     "fried", 
                            &pos1, col10 - pos1, "green",   
                            &pos2, col25 - pos2, "tomatos");

    printf("    ^    ^    ^    ^    ^    ^\n");

    printf("%d %d\n", pos1, pos2);
    printf("%d %d\n", col10 - pos1, col25 - pos2);

    return 0;
} 
```

我肯定在这里遗漏了一些东西。西红柿太靠右了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-09T18:46:58.713

这是来自 VS2005 CRT 代码的内容：

```
/* if %n is disabled, we skip an arg and print 'n' */
if ( !_get_printf_count_output() )
{
   _VALIDATE_RETURN(("'n' format specifier disabled", 0), EINVAL, -1);
   break;
} 
```

这带来了这个：

[替代文字 http://www.shiny.co.il/shooshx/printfn.png](http://www.shiny.co.il/shooshx/printfn.png)

对于以下行：

```
 printf ("%s other stuff: %n", thing, &len); 
```

我猜这主要是为了避免@eJames所说的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-27T13:02:37.577

你可以打电话

```
int _get_printf_count_output(); 
```

查看是否启用了 %n 支持，或使用

```
int _set_printf_count_output( int enable ); 
```

启用或禁用对 %n 格式的支持。

来自 MSDN VS2008

# visual-studio - Visual Studio 如何确定使用多项目解决方案将哪些内容复制到输出目录？

> ID：353617
> 
> 赞同：30
> 
> 时间：2008-12-09T17:46:16.730
> 
> 标签：visual-studio, msbuild, assemblies

假设我们有一个具有以下结构的解决方案：

*   Project.DAL - 数据访问层，依赖于较低级别的库，例如 Oracle.DataAccess w/copy local = true
*   Project.BLL - 业务逻辑层，引用 Project.DAL 作为项目
*   Project.UI - UI 层，编译为可执行文件，引用 Project.BLL，默认项目

编译 Project.UI 时，VS 足够聪明，可以将 Project.DAL.dll 复制到输出目录，但它不够聪明，无法弄清楚我希望将 Oracle.DataAccess 复制到输出目录以及分发给客户端.

谁能解释为什么会这样？是因为它在 GAC 中看到 Oracle.DataAccess 并假设客户端也会在 GAC 中拥有它吗？

这没什么大不了的，但是每次我添加一个新的程序集引用时，我都必须记住将它设置为复制本地并添加一个项目以在我的构建脚本中复制它，这有点烦人。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2010-02-14T17:36:31.907

还有一件事。

当您**根本不在代码中使用引用的 DLL**时，它将忽略 CopyLocal 并且**不会将其复制**到您的输出目录。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-02T16:49:14.863

是的，Visual Studio 将在以下两种情况中的任何一种情况下将 DLL 复制到输出路径：

1.  DLL 使用 CopyLocal = true 显式引用
2.  DLL 在没有 CopyLocal 的情况下被引用或通过其他一些引用的 DLL 隐式引用**，并且不在 GAC 中**

当文件在 GAC 中时它不会复制本地的原因是，在解析程序集名称时 GAC 具有最高优先级，即即使您有（不同的）本地副本，也将使用 GAC 的版本。

我建议您设置一个库目录，在其中放置所有引用的外部程序集。然后，您在没有 Oracle 文件 gac'ed（也没有为此安装 Visual Studio）的计算机（或 VM）上设置一个自动 MSBuild 脚本。这样，文件将被复制到构建中，与使用 VS 时相比，您可以更好地控制所做的事情。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2010-05-13T15:47:19.390

我有一个奇怪的情况，即使程序集是一个项目引用并且在引用属性窗口中显示为“True”的“复制本地”被引用，DLL 没有被复制到输出目录。我在 GAC 中有一个早期版本的 DLL，但我不明白为什么这会阻止 DLL 被复制。

我发现通过卸载项目并手动编辑项目引用 XML 如下：

```
<ProjectReference Include="..\SomeProject.csproj">
  <Project>{11111111-1111-1111-1111-111111111111}</Project>
  <Name>Some Project Name</Name>
  <Private>True</Private>
</ProjectReference> 
```

DLL 已按预期复制到输出目录。我发现仅在属性窗口中将 Copy Local 设置为 True 意味着该`<Private>`元素完全丢失，但在将其设置为 false 的情况下，它的值为“False”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-11-28T23:06:32.973

@RenniePet 这是一个博客链接，该链接描述了上面评论中描述的 RenniePet 方法（如果您不想像 @Shaun 建议的那样手动编辑项目文件）：

[http://blogs.msdn.com/b/jjameson/archive/2009/11/18/the-copy-local-bug-in-visual-studio.aspx](http://blogs.msdn.com/b/jjameson/archive/2009/11/18/the-copy-local-bug-in-visual-studio.aspx)

# asp.net - 提高 ASP.net WebForm 性能

> ID：353621
> 
> 赞同：6
> 
> 时间：2008-12-09T17:47:37.177
> 
> 标签：asp.net, performance, webforms

在设计 ASP.net WebForm 应用程序时，需要采取哪些重要步骤（或者如果您喜欢使用该术语，可以采取一些技巧）以确保最佳性能（在速度、稳定性和可伸缩性方面）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-09T17:50:47.577

你有大量的材料，直接来自微软[这里](http://msdn.microsoft.com/en-us/library/ms998549.aspx)。如果您想要简明信息，还可以使用[清单。](http://msdn.microsoft.com/en-us/library/ms998596.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-09T17:52:32.737

这是微软编写的一个很好的最佳实践。第 6 章专门针对 ASP.NET，但整个文档一般都是 .NET。

*   [http://msdn.microsoft.com/en-us/library/ms998530.aspx](http://msdn.microsoft.com/en-us/library/ms998530.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-09T19:21:19.703

只是一对夫妇，除了已经给出的好建议，

1.  不要把每一个页面都放在一个 web 表单中，并不是所有的东西都需要它——VS 的默认行为是给你一个母版页，它包含一个表单，很多人似乎都坚持这一点。根据我的经验，一些控件可以在 web 表单之外渲染 30% 的速度，所以如果你只是解析查询字符串然后从数据库中读取一些东西，如果可以的话，把表单留在家里。即使让您的导航脱离表单也会有所帮助。
2.  当普通的旧 HTML 可以使用时，不要使用服务器控件 - 是否真的需要一个 asp:linkbutton 或 asp:hyperlink 才能转到 FAQ 页面等。普通超链接在 asp.net 中工作得很好，但有些人似乎陷入对所有事情都使用 runat="server" 的想法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-09T18:01:16.807

雅虎的一位员工史蒂夫·苏德斯 (Steve Souders ) 有一[本](https://rads.stackoverflow.com/amzn/click/com/0596529309)关于这个主题的非凡著作。它教会了我很多。

或者你可以只看[这个视频。](http://video.yahoo.com/watch/1040890/3880720)这是对相同信息的高级概述 - 通过观看此内容，您可以在 45 分钟内学到很多东西。

注意：此内容不是特定于 WebForms 的。这是网络的一般最佳实践，如果您尝试推出高性能网站，这也是您所需要的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-09T18:12:51.433

大 #1 提示：关闭 web.config 中的视图状态。这应该是默认设置，如果您需要它进行控制，请在逐个控制的基础上打开它。

我的另一条建议是远离 *view 控件。使用中继器并找到一个好的第 3 方网格控件。与 asp 一起提供的真正“神奇”的控件往往是性能猪，而且总的来说不是一个好主意（ListView 可能例外）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-09T19:37:13.197

1 - 在 iis 上打开内容压缩

2 - 尽可能缓存所有内容

这适用于大多数网络应用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-06T01:03:20.187

当内容涉及 html 和 js 做 ajax 东西时，我不确定内容压缩。有时通过 ajax 交换的数据块很小，在这种情况下（如果这被认为是内容）压缩通常会带来伤害而不是帮助。例如，一个四字节的数据块会产生一个超过 100 字节的压缩块。

# artificial-intelligence - AI Bot 编程环境

> ID：353626
> 
> 赞同：5
> 
> 时间：2008-12-09T17:49:48.657
> 
> 标签：artificial-intelligence, bots

我刚刚完成了一门人工智能课程，作为作业的一部分，我能够在多人环境（[BZFlags](http://bzflag.org/)）中编写机器人程序。我能够做的是对机器人进行编程，使其与世界交互，并与其他机器人甚至人类对战。

我想知道的是，**还有哪些其他环境可以让我做同样的事情（为游戏编程机器人或在专业环境中）？**

我之所以能够使用 BZFlags 做到这一点，是因为它们提供了一个 API，以便我可以向我的机器人发送命令并查找有关它们周围世界的信息。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-09T18:07:15.033

有[Robocode](http://robocode.sourceforge.net/)和[NRobot](http://home.gna.org/nrobot/)。

在 RoboCode 中，您使用 Java 对机器人的 AI 进行编程，然后让他与其他机器人对抗，看看他的表现如何。NRobot 是一个非常相似的想法的 .NET 版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-09T17:53:40.893

[RobotBASIC](http://www.robotbasic.org/)类似。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-25T20:00:26.037

另一个可能有趣的东西是[SoccerFun](http://www.cs.ru.nl/P.Achten/SoccerFun/SoccerFun.html)，但它在 Haskell 中，它是关于编程协作机器人

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T18:09:02.830

[我如何构建一个工作的扑克机器人](http://www.codingthewheel.com/archives/how-i-built-a-working-poker-bot)描述了一些构建扑克机器人的过程。作者说“**如果我能建造一个，那么。任何人都可以建造一个。** ”我通过[这篇文章](https://stackoverflow.com/questions/118919/what-is-the-strangestweirdest-program-youve-ever-made#119447)找到了这个。

# c++ - 为什么使用 = 来初始化 C++ 中的原始类型？

> ID：353632
> 
> 赞同：8
> 
> 时间：2008-12-09T17:52:07.497
> 
> 标签：c++, coding-style, c++03

在我工作的地方，人们大多认为最好使用 C++ 风格的构造（带括号）初始化对象，而应该使用 = 运算符初始化原始类型：

```
std::string strFoo( "Foo" );
int nBar = 5; 
```

不过，似乎没有人能够解释为什么他们更喜欢这种方式。我可以看到这`std::string = "Foo";`将是低效的，因为它会涉及额外的副本，但是`=`完全消除运算符并在任何地方使用括号有什么问题？

这是一个共同的约定吗？背后的想法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-09T17:57:42.883

使用 = 运算符或使用构造函数调用初始化变量在语义上是相同的，只是样式问题。我更喜欢 = 运算符，因为它读起来更自然。

使用 = 运算符*通常*不会生成额外的副本——它只是调用普通的构造函数。但是请注意，对于非原始类型，这仅适用于与声明同时发生的初始化。比较：

```
std::string strFooA("Foo");  // Calls std::string(const char*) constructor
std::string strFoo = "Foo";  // Calls std::string(const char*) constructor
                             // This is a valid (and standard) compiler optimization.

std::string strFoo;  // Calls std::string() default constructor
strFoo = "Foo";      // Calls std::string::operator = (const char*) 
```

当您有非平凡的默认构造函数时，后一种构造可能会稍微低效。

[C++ 标准](http://www.parashift.com/c++-faq-lite/big-picture.html#faq-6.13)，第8.5 节，第 14 段指出：

> 否则（即，对于剩余的复制初始化情况），创建一个临时的。枚举了可以从源类型转换为目标类型或其派生类的用户定义的转换序列（13.3.1.4），并通过重载决议（13.3）选择最佳的转换序列。调用如此选择的用户定义转换将初始化表达式转换为临时类型，其类型是调用用户定义转换函数返回的类型，带有目标类型的 cv 限定符。如果转换无法完成或不明确，则初始化格式错误。然后根据上述规则从临时对象中直接初始化正在初始化的对象。^(87) )**在某些情况下，允许实现通过直接初始化对象来消除临时性；见 12.2。**

第 12.2 节的一部分规定：

> 即使避免创建临时对象，也必须遵守所有语义限制，就像创建临时对象一样。[示例：即使不调用复制构造函数，也应满足所有语义限制，例如可访问性（11）。]

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-09T18:21:34.147

我只是觉得需要另一个愚蠢的 litb 帖子。

```
string str1 = "foo"; 
```

被称为**copy-initialization**，因为如果编译器没有省略任何临时文件，编译器所做的是：

```
string str1(string("foo")); 
```

除了检查使用的转换构造函数是隐式的。事实上，所有隐式转换都是由标准根据复制初始化定义的。据说从 U 类型到 T 类型的隐式转换是有效的，如果

```
T t = u; // u of type U 
```

已验证。

相比之下，

```
string str1("foo"); 
```

正在执行所写的操作，称为**直接初始化**。它也适用于显式构造函数。

顺便说一句，您可以使用 -fno-elide-constructors 禁用临时对象的省略：

```
-fno-elide-constructors
    The C++ standard allows an implementation to omit creating a temporary which 
    is only used to initialize another object of the same type. Specifying this 
    option disables that optimization, and forces G++ to call the copy constructor 
    in all cases. 
```

* * *

标准说两者之间几乎没有区别

```
T a = u; 
```

和

```
T a(u); 
```

如果 T 和 u 的类型是原始类型。所以你可以使用这两种形式。我认为正是它的风格使人们使用第一种形式而不是第二种形式。

* * *

有些人可能会在某些情况下使用第一个，因为他们想消除声明的歧义：

```
T u(v(a)); 
```

可能会将某人视为变量的定义，该变量`u`是使用临时类型初始化的，该类型`v`为其构造函数获取参数，称为`a`. 但实际上，编译器的作用是这样的：

```
T u(v a); 
```

它创建一个函数声明，该声明接受一个类型为`v`的参数，并带有一个名为 的参数`a`。所以人们这样做

```
T u = v(a); 
```

消除歧义，即使他们本可以做到

```
T u((v(a))); 
```

同样，因为函数参数周围从来没有括号，编译器也会将其作为变量定义而不是函数声明来读取:)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-09T17:59:16.937

除非您已经证明它对性能很重要，否则我不会担心在您的示例 ( `std::string foo = "Foo";`) 中使用赋值运算符会产生额外的副本。一旦您查看优化的代码，如果该副本甚至存在，我会感到非常惊讶，我相信它实际上会调用适当的参数化构造函数。

在回答您的问题时，是的，我会说这是一个非常普遍的约定。传统上，人们使用赋值来初始化内置类型，并且没有令人信服的理由来改变传统。鉴于它对最终代码的影响很小，可读性和习惯是这种约定的完全正当理由。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-09T17:57:58.920

你可能会发现这样的代码

```
std::string strFoo = "Foo"; 
```

将避免进行额外的复制并编译为与带括号的代码相同的代码（调用单参数构造函数）。

另一方面，在某些情况下*必须*使用括号，例如构造函数成员初始化列表。

我认为使用 = 或括号来构造局部变量在很大程度上是个人选择的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-09T17:58:06.017

好吧，谁知道*他们*的想法，但我也更喜欢原始类型的 =，主要是因为它们不是对象，而且因为这是初始化它们的“通常”方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-09T17:57:05.100

这是风格问题。即使是“std::string = "Foo"; 的声明也会效率低下，因为它会涉及额外的副本”是不正确的。编译器会删除此“额外副本”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-09T17:59:23.723

我相信这更像是一种习惯，很少有对象可以使用 = 来初始化，字符串就是其中之一。这也是一种做你所说的“在任何地方使用括号（语言允许你使用它）”的方式

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-09T18:36:15.910

人们可以提出的一种论点：

std::string foo("bar");

即使参数计数发生变化，它是否保持不变，即：

std::string foo("bar", 5);

不适用于“=”符号。

另一件事是，对于许多对象来说，'=' 感觉不自然，例如，假设您有一个 Array 类，其中参数给出了长度：

数组 arr = 5;

感觉不太好，因为我们没有构造一个值为 5 而是长度为 5 的 Array：

数组 arr(5);

感觉更自然，因为您正在使用给定参数构造一个对象，而不仅仅是复制一个值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-09T18:44:33.460

但是为了让您更加困惑，您使用对象语法在初始化列表中初始化原语。

```
foo::foo()   
  ,anInt(0)   
  ,aFloat(0.0)   
{   
} 
```

# c++ - 使用 UPX 压缩 Windows 可执行文件有什么缺点吗？

> ID：353634
> 
> 赞同：40
> 
> 时间：2008-12-09T17:53:39.617
> 
> 标签：c++, delphi, winapi, compression, upx

我以前使用[UPX](http://upx.sourceforge.net/)来减小我的 Windows 可执行文件的大小，但我必须承认我对这可能产生的任何负面影响都很天真。所有这些打包/拆包的缺点是什么？

是否有人会建议不要对可执行文件进行 UPX 处理（例如，在编写 DLL、Windows 服务或针对 Vista 或 Win7 时）？我的大部分代码都是用 Delphi 编写的，但我也使用 UPX 来压缩 C/C++ 可执行文件。

附带说明一下，我**没有**运行 UPX 以试图保护我的 exe 免受反汇编程序的攻击，只是为了减小可执行文件的大小并防止粗略的篡改。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-12-09T18:11:41.623

> 原因是使用 EXE 压缩器有缺点。最为显着地：
> 
> 在启动压缩的 EXE/DLL 时，所有代码都会一次性从磁盘映像解压缩到内存中，如果系统内存不足并被迫访问交换文件，这可能会导致磁盘抖动。相反，对于未压缩的 EXE/DLL，操作系统根据需要（即在执行它们时）为代码页分配内存。
> 
> 压缩 EXE/DLL 的多个实例在内存中创建代码的多个实例。如果您有一个包含 1 MB 代码（压缩前）的压缩 EXE，并且用户启动了 5 个它的实例，则浪费了大约 4 MB 的内存。同样，如果您有一个 1 MB 的 DLL，并且它被 5 个正在运行的应用程序使用，那么大约会浪费 4 MB 的内存。使用未压缩的 EXE/DLL，代码仅在内存中存储一​​次，并在实例之间共享。

[http://www.jrsoftware.org/striprlc.php#execomp](http://www.jrsoftware.org/striprlc.php#execomp)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-10T10:04:54.663

我很惊讶这还没有被提及，但是使用 UPX 打包的可执行文件也会增加启发式防病毒软件产生误报的风险，因为从统计数据来看，很多恶意软件也使用 UPX。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-11T13:22:17.447

有三个缺点：

1.  整个代码将在虚拟内存中完全解压缩，而在常规 EXE 或 DLL 中，仅将实际使用的代码加载到内存中。如果每次运行时只使用 EXE/DLL 中的一小部分代码，这一点尤其重要。
2.  如果您的 DLL 和 EXE 有多个实例在运行，则它们的代码无法在这些实例之间共享，因此您将使用更多内存。
3.  如果您的 EXE/DLL 已经在缓存中，或者在非常快的存储介质上，或者如果您正在运行的 CPU 很慢，您将体验到启动速度降低，因为仍然必须进行解压缩，并且您不会受益于缩小的尺寸。对于将被重复调用多次的 EXE 尤其如此。

因此，如果您的 EXE 或 DLL 包含大量资源，则上述缺点会成为一个更大的问题，但除此之外，考虑到可执行文件的相对大小和可用内存，除非您在谈论 DLL，否则它们在实践中可能不是一个重要因素许多可执行文件（如系统 DLL）使用。

要消除其他答案中的一些不正确信息：

*   UPX 不会影响您在受 DEP 保护的机器上运行的能力。
*   UPX 不会影响主流杀毒软件的能力，因为它们支持 UPX 压缩的可执行文件（以及其他可执行压缩格式）。
*   UPX 已经能够使用 LZMA 压缩有一段时间了（7zip 的压缩算法），使用 --lzma 开关。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-12-09T18:39:38.227

唯一重要的时间大小是在从 Internet 下载期间。如果您使用的是 UPX，那么您实际上会获得比使用[7-zip](http://www.7-zip.org/)更差的性能（根据我的测试，7-Zip 的性能是 UPX 的两倍）。然后，当它实际上在目标计算机上被压缩时，您的性能就会降低（请参阅 Lars 的回答）。所以UPX不是文件大小的好解决方案。只需 7zip 即可。

就防止篡改而言，它也是***失败***的。UPX 也支持解压缩。如果有人想修改 EXE，他们会看到它是用 UPX 压缩的，然后解压缩。您可能放慢速度的可能破解程序的百分比并不能证明努力和性能损失是合理的。

更好的解决方案是使用二进制签名或至少只是一个哈希。一个简单的哈希验证系统是获取二进制文件的哈希值和一个秘密值（通常是一个 guid）。只有您的 EXE 知道秘密值，因此当它重新计算哈希以进行验证时，它可以再次使用它。这并不完美（可以检索秘密值）。理想的情况是使用证书和签名。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-09T18:05:52.553

如今，磁盘上可执行文件的最终大小在很大程度上无关紧要。您的程序加载速度可能会快几毫秒，但一旦开始运行，差异就无法区分了。

有些人可能对您的可执行文件更加怀疑，因为它是用 UPX 压缩的。根据您的最终用户，这可能是也可能不是重要的考虑因素。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-09T18:00:26.310

上次我尝试在托管程序集上使用它时，它的表现非常糟糕，以至于运行时拒绝加载它。这是我唯一一次想到你不想使用它（而且，真的，我已经很久没有尝试过了，现在情况可能会更好）。我过去曾在所有类型的非托管二进制文件中广泛使用它，并且从未遇到过问题。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-09T21:32:35.600

如果您唯一感兴趣的是减小可执行文件的大小，那么您是否尝试过比较带有和不带有运行时包的可执行文件的大小？当然，您还必须包括整个包的大小以及您的可执行文件，但如果您有多个使用相同基本包的可执行文件，那么您的节省会相当高。

要查看的另一件事是您在程序中使用的图形/字形。您可以通过将它们合并到包含在全局数据模块中的单个 Timagelist 中来节省相当多的空间，而不是在每个表单上重复它们。我相信每个图像都以十六进制形式存储在表单资源中，因此这意味着每个字节占用两个字节......您可以通过使用 TResourceStream 从 RCData 资源加载图像来缩小这一点。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-10-21T18:24:16.803

没有缺点。

但仅供参考，对于 UPX 存在一个非常普遍的误解，即——

## 资源不只是被压缩

本质上，您正在构建一个具有“加载器”职责的新可执行文件，并且“真正的”可执行文件正在被分段和压缩，放置为加载器可执行文件的二进制数据资源（无论资源类型在原始可执行文件）。

出于教育目的或*其他*目的使用逆向工程方法和[工具](http://www.exeinfo.xwp.pl/)将向您显示有关“加载程序可执行文件”的信息，而不是有关原始可执行文件的可变信息。

 *[![由 UPX 解压缩的可执行文件](https://i.stack.imgur.com/CptR8.jpg)](https://i.stack.imgur.com/CptR8.jpg)

[![由UPX压缩的可执行文件](https://i.stack.imgur.com/KbFO2.jpg)](https://i.stack.imgur.com/KbFO2.jpg)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-25T22:32:21.940

恕我直言，常规的 UPXing 是没有意义的，但原因如上所述，主要是内存比磁盘贵。

Erik：LZMA 存根可能更大。即使算法更好，也并不总是净加成。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-02T00:47:14.437

寻找“未知”病毒的病毒扫描程序可以将 UPX 压缩的可执行文件标记为有病毒。有人告诉我这是因为一些病毒使用 UPX 来隐藏自己。我在软件上使用了 UPX，McAfee 会将文件标记为病毒。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-09-26T16:34:14.673

UPX 有这么多误报的原因是它的开放许可允许恶意软件作者使用和修改它而不受惩罚。当然，这个问题是行业固有的，但遗憾的是，伟大的 UPX 项目被这个问题所困扰。

更新：请注意，随着 Taggant 项目的完成，假设 UPX 支持它，使用 UPX（或其他任何东西）而不会导致误报的能力将得到增强。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-09T18:48:26.057

我相信它可能无法在打开了[DEP](http://en.wikipedia.org/wiki/Data_Execution_Prevention)（数据执行保护）的计算机上运行。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-04-22T16:17:56.917

当 Windows 加载二进制文件时，它所做的第一件事称为导入/导出表解析。即，无论导入表中指示的 API 和 DLL 是什么，它都会首先将 DLL 加载到随机生成的基地址中。并且在 DLL 的函数中使用基地址加上偏移量，这些信息将被更新到 Import Table。

EXE 没有导出表。

所有这些甚至在跳转到原始入口点执行之前就发生了。

然后在它从入口点开始执行之后，EXE 会在开始解压算法之前运行一小段代码。这段小代码也意味着所需的 Windows API 将非常小，导致导入表很小。

但是在解压二进制文件后，如果它开始使用之前未解析的任何 Windows API，那么它很可能会崩溃。因此，解压缩例程必须在执行解压缩代码之前解析和更新解压缩代码中所有引用的 Window API 的导入表。

参考：

[![在此处输入图像描述](https://i.stack.imgur.com/XXfjr.png)](https://i.stack.imgur.com/XXfjr.png)

[https://malwaretips.com/threads/malware-analysis-2-pe-imports-static-analysis.62135/](https://malwaretips.com/threads/malware-analysis-2-pe-imports-static-analysis.62135/)

# windows - 如何创建一个文件夹来监听更改的文件或新文件

> ID：353643
> 
> 赞同：1
> 
> 时间：2008-12-09T17:55:57.007
> 
> 标签：windows, service, extract

我有一个创建许多 swc 文件的要求（swc 文件类似于 zip 或 jar 文件）。我想要这样，每当我创建一个新的 swc 文件并将其添加到“特定文件夹”中时，这些文件应该会自动被提取（类似于 Apache Tomcat webapps 文件夹中发生的情况）。请帮助我如何在 Windows 中执行此操作。[注意：我知道我可以编写一个 ant/rake/gradle 脚本来为我做这件事，但只是为了在 Windows 中探索更多如何实现这一点]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T17:58:19.387

如果您使用的是 .NET，请使用 FileSystemWatcher 类。（[这里](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-6165137.html)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T18:07:53.970

如果您不使用 .NET，则可以使用[FindFirstChangeNotification](http://msdn.microsoft.com/en-us/library/aa364417(VS.85).aspx)函数来侦听文件系统更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T18:01:35.433

如果您想以 Windows 脚本方式执行此操作，您将使用 WMI 事件观察器。 [http://technet.microsoft.com/en-us/library/ms141130.aspx](http://technet.microsoft.com/en-us/library/ms141130.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T04:46:43.707

FileSystemWatcher 是 .Net 中的明显选择。

恕我直言，它不是一个好的组件。很多时候，它会引发文件更改的双重事件，而我无法使用 FileSystemWatcher 进行简洁的实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-09T17:58:38.873

您可以使用 .NET FileSystemWatcher 来执行此任务。（来自 withing c#、vb.net 等）使用 FileSystemWatcher，您可以观察文件的创建、删除和修改并对这些事件做出反应。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-09T18:06:56.670

不要使用 .NET（针对儿童）使用 Win32 api 通知（8 行代码）

# cocoa - Apple Cocoa 框架的设计模式：MVC、MVP、Passive View……Apple 将走向何方？

> ID：353646
> 
> 赞同：12
> 
> 时间：2008-12-09T17:57:13.243
> 
> 标签：cocoa, design-patterns

为了为这个问题打下基础，我将声明我从以下内容中获得了 MVC、MVP 和被动视图的定义：

[模型视图控制器 (MVC)](http://en.wikipedia.org/wiki/Model-view-controller)
[模型视图展示器 (MVP)](http://en.wikipedia.org/wiki/Model_View_Presenter)
[被动视图 (PV)](http://www.martinfowler.com/eaaDev/PassiveScreen.html)

Apple 一直声称它使用 MVC 设计模式，但我注意到在 OS X 10.5 中我们获得了 NSViewController、KVO、绑定等对象，这些对象的行为似乎更像被动视图设计模式。这是苹果希望我们去的地方吗？我想以一种尽可能与 Apple 选择的设计模式配合使用的方式来规划我的代码，这就是为什么我想知道 Apple 的发展方向。有人有线索吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-10T18:22:27.093

任何复杂的代码都有很多地方可以应用不同的模式。MVC 在 Cocoa 文档中很突出，因为它解释了您的功能代码（模型）、您的 UI 代码或 IB 设计（视图）以及将它们联系在一起的 Cocoa 服务（控制器）之间的关系。这是值得强调的，尤其是在介绍性的 dox 中，因为你需要一点“警钟”来停止认为你必须自己编写它，并开始考虑如何设计你独特的部分，并相信框架来完成它水暖工作。

MVC 的变体定义具有传奇色彩，值得指出的是，规范的“四人帮”书籍“设计模式”中没有描述 MVC。同样值得承认的是，Cocoa 的“MVC”模型与 SmallTalk 80 MVC（术语起源于该模型）不同。

可能还值得指出的是，“GoF”实际上使用“模式”一词来表示一种特定的文档风格，而不是模式所描述的设计代码的抽象方式。太糟糕了，这种用法在很大程度上已经丢失了。如果我们都这样理解这个词，那么我可以说“如果有人真的为 Cocoa 的 MVC 编写一个模式，那将非常有用。” 那我们就不会这么糊涂了！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-09T22:41:32.827

Cocoa*基于*MVC（[Apple 定义它](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaDesignPatterns/CocoaDesignPatterns.html%23//apple_ref/doc/uid/TP40002974-CH6-SW1 "可可基础指南：可可设计模式")），并且一直处于为你做更多事情的趋势。这是目前的情况。

*   视图层：NSView、NSWindow、NSCell、它们的子类、CALayer
*   控制器层（从 10.3 开始）：NSController 和子类（主要是 NSArrayController）
*   模型层：传统上，你必须完全自己做这件事，但从 10.4 开始，你也许可以使用 Core Data。

绑定由 KVO（和 KVC）提供支持，是将三层绑定在一起的粘合剂。您将视图绑定到控制器，将控制器绑定到模型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-09T18:13:36.017

我不会说 Cocoa 遵循那里描述的被动视图模式。意思是控制器完成了准备视图和发送更改通知的所有工作。在 Cocoa 中，视图对象通常会响应来自模型的 KVO 通知（通过绑定），从绑定的控制器刷新数据，通过数据格式化程序或值转换器进行准备，最后将其显示在屏幕上。

Cocoa 很好地遵循 MVC，尽管“控制器”方面通常分为视图控制器和模型控制器。[您可以在此处](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaDesignPatterns/chapter_5_section_4.html)阅读有关此内容的更多信息。如果你有任何关于你感到困惑的具体例子，也许我可以提供更多关于 Cocoa 做事方式的细节。

在同一指南中，[本节](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaDesignPatterns/chapter_5_section_3.html#//apple_ref/doc/uid/TP40002974-CH6-SW5)解释了一些您可能会发现有用的其他设计模式。以我自己的经验，虽然在完成了一些项目之后，Cocoa 中的 MVC 往往会很自然地出现，我不会太担心它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-08T14:29:14.310

苹果文档实际上比我读过的任何东西都更好地解释了 MVC。基本上与 MVC 相关的混淆是因为它是一种复合模式。它由许多基本模式组成。*尽管四人帮在**设计模式*中没有讨论 MVC ，但基本模式是。

 *> 我认为的主要区别在于，在 Apple 世界中，除了通常的情况外，Controller 还是一种中介模式。
> 
> 因此，与 Apple 世界中的传统方法模型不同，它不会通知变化的观点。他们实际上并没有通知任何人。如果你想改变一个模型，你必须通过控制器来确保每个人都收到更改通知。

我认为这种方法比传统方法要好得多。它对模型对象没有任何限制。他们不必实现任何特定的接口。他们只需要解决特定领域的问题。因此，您可以非常轻松地在其他应用程序中重用它们。

在这种方法中，主要是必须重写的控制器对象。当然，Apple 通过绑定改变了这一点。但是如果你不使用绑定，那么控制器是特定于应用程序的。

## 在 C++ 中使用 Apple MVC

在使用 Qt 编写 C++ 应用程序时，我实际上遵循了 Apple 的设计。视图是 QWidget 的。我将所有与外观有关的代码放在 QWidget 子类中。然后我让我的控制器成为 QObject 子类并让它创建视图对象并将来自 QWidgets 的信号连接到我的 QObject 控制器中的插槽。我的模型类是一个常规类，它不从 Qt 继承任何东西并实现业务逻辑。它被控制器插槽修改。

或者，QWidgets 可以在控制器之外创建，因此您可以将控制器重用于其他类型的视图。

不确定这是否对任何人有帮助，但我认为有时用 C++ 来考虑 Cocoa 模式更容易，因为我们习惯于用 C++ 和 Java 等静态类型语言来解释模式。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-09T18:37:38.090

我认为 Cocoa/OpenStep 并没有真正遵循 MVC，例如[SmallTalk 80](http://st-www.cs.uiuc.edu/users/smarch/st-docs/mvc.html)中所描述的那样。SmallTalk 控制器实际上是负责解释用户与 View 的交互，在 Cocoa 的情况下，由 NSControl 处理，因此由 View 层处理（也许它在框架内以这种方式分解，但我们不应该这样做窥视内部；这就是抽象的全部内容:-)。关于您的这些链接，Cocoa 中的 Controller 层确实属于 Presenter 旗帜，特别是在考虑 Cocoa Bindings 中的各种 NS*Controller 类时。这些确实是视图层和模型之间的穿梭。

在我自己的应用程序中，我倾向于有四个不同的层，即使在它们没有明确分开的地方也是如此；视图、演示者、服务和模型。那么“presenter controllers”和“service controllers”有完全不同的目的；逻辑和流程在服务中，工作流和用例在视图控制器中。在打包方面，如果你喜欢这种事情，服务和模型一起代表一个抽象的“对事物做的事情”，它可以是上下文无关的。演示者和视图代表“这就是 Mac OS X 应用程序的用户想要使用它的方式”，它依赖于较低的包，并封装了 AppKit 特定（和 AHIG 特定）的类和行为。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-09T18:46:17.747

哦哦。MVC = 有史以来最错误引用的模式。我已经阅读了至少 5 种不同的定义。

您可能想阅读[Martin Fowler的这篇文章](http://martinfowler.com/eaaDev/uiArchs.html)

# git - 支持 Git 的开源 IDE

> ID：353670
> 
> 赞同：11
> 
> 时间：2008-12-09T18:02:10.550
> 
> 标签：git, open-source, ide

我很难找到支持 Git 的开源 IDE。你有什么可以指点或推荐的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T19:25:46.293

有一个[Eclipse 插件正在进行中](http://www.eclipse.org/egit/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T18:07:03.333

用于 NetBeans的[nbgit](http://code.google.com/p/nbgit/)正在开发中，但还不稳定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-09T18:10:18.427

如果您只想要 git 的 GUI，请尝试[QGit](http://sourceforge.net/projects/qgit)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-09T19:04:25.790

我不知道这样的东西是否以稳定的形式存在，但开始搜索的好地方是：

[http://git.or.cz/gitwiki/InterfacesFrontendsAndTools](http://git.or.cz/gitwiki/InterfacesFrontendsAndTools)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-17T15:14:31.400

我使用带有[vcscommand](http://www.vim.org/scripts/script.php?script_id=90)插件的 Vim。尽管该插件支持许多版本控制系统，但我专门将它用于 Git。

使用 VCSCommand，您可以（几乎）直接在 vim 中完成 git 公开的所有主要功能。

VCSVimDiff 命令是 VCSCommand 插件的最佳功能之一。您可以直接从 Vim 内部查看彩色差异！

还有什么 Vim 和 VCSCommand 都是开源的 :)

**旁注：**
*Vim 与 NERD_Tree.vim、xml.vim、surround.vim 和其他一些插件一起，使它成为一个完整的 IDE，与 git 一起工作得很好（至少对我来说）。在 vim.org（或 Google ！！）中搜索适合您要求或口味的插件。*

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-28T22:59:23.187

伟大的[Aptana Studio](http://www.aptana.com/studio)支持（通过插件） SVN、CVS 和 Git（通过[这个插件](http://git.or.cz/gitwiki/EclipsePlugin)）。我仍然是 Aptana 的菜鸟，我还没有使用过 Git，但它看起来很有希望。

# sql-server - 从 SQL 2000 更新到 AS400

> ID：353673
> 
> 赞同：0
> 
> 时间：2008-12-09T18:02:39.270
> 
> 标签：sql-server, ibm-midrange, openquery

我正在尝试通过 openquery 从 sql server 2000 更新 AS400 中的某些内容，如下所示。

```
UPDATE
OPENQUERY(odbcname, 'SELECT * FROM "libname"."filename" WITH NC')
SET NBFLAG01=1
WHERE NBFLAG01 <> 1 
```

这是我得到的错误。

```
"OLE DB provider 'MSDASQL' reported an error.  
[OLE/DB provider returned message: Insufficient base table information for updating or refreshing.]
OLE DB error trace [OLE/DB Provider 'MSDASQL' IRowsetChange::SetData returned 0x80004005:   ]. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T19:24:51.133

尝试在选择中列出您的字段。如果有什么可以消除它作为一个问题。

# wpf - WPF 中嵌套 ListView 的分层数据绑定

> ID：353678
> 
> 赞同：1
> 
> 时间：2008-12-09T18:03:20.297
> 
> 标签：wpf, data-binding, .net-3.5, listview

我有一些包含详细信息表的数据。我希望数据显示在 ListView 中。当您在原始列表中选择一个项目时，我希望详细数据显示为嵌套的 ListView。我似乎无法弄清楚如何让数据绑定工作。

这是我到目前为止所拥有的，（问题是`{Binding Path=FK_History_HistoryItems}`）：

```
<ListView Name="lstHistory" ItemsSource="{Binding Source={StaticResource History}}" SelectionChanged="lstHistory_SelectionChanged">
    <ListView.View>
        <GridView>
            <GridViewColumn DisplayMemberBinding="{Binding Path=Name}" Header="Name" Width="100" />
            <GridViewColumn DisplayMemberBinding="{Binding Path=Description}" Header="Description" Width="150" />
            <GridViewColumn DisplayMemberBinding="{Binding Path=Total, Converter={StaticResource moneyConvert}}" Header="Total" Width="100" />
            <GridViewColumn DisplayMemberBinding="{Binding Converter={StaticResource categoryAggregate}}" Header="Categories" Width="100" />
        </GridView>
    </ListView.View>
    <ListView.Resources>
        <Style TargetType="{x:Type ListViewItem}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ListViewItem}">
                        <Border>
                            <StackPanel>
                                <Border Name="presenter"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        Padding="{TemplateBinding Padding}">
                                    <GridViewRowPresenter />
                                </Border>
                                <Border Name="details" Visibility="Collapsed" Margin="5"
                                        BorderBrush="Black" BorderThickness="2">
                                    <StackPanel Margin="5">
                                        <ListView ItemsSource="{Binding Path=FK_History_HistoryItems}">
                                            <ListView.View>
                                                <GridView>
                                                    <GridViewColumn DisplayMemberBinding="{Binding Path=Ammount}" Header="Ammount" Width="100" />
                                                    <GridViewColumn DisplayMemberBinding="{Binding Path=Category}" Header="Category" Width="100" />
                                                </GridView>
                                            </ListView.View>
                                        </ListView>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="details" Property="Visibility" Value="Visible" />
                                <Setter TargetName="presenter" Property="Background" Value="Navy"/>
                                <Setter TargetName="presenter" Property="TextElement.Foreground" Value="White" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </ListView.Resources>
</ListView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T19:27:44.480

如果我正确理解您的问题，您需要绑定到原始列表的 SelectedItem：

```
<ListView ItemsSource="{Binding ElementName=lstHistory, Path=SelectedItem}"> 
```

然后根据需要设置数据模板/视图。如果您不想使用 ElementName 进行绑定，您也可以使用 RelativeSource 但我发现 ElementName 更易于阅读和理解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T23:33:54.190

您需要将问题行更改为以下内容：

```
<ListView ItemsSource="{Binding FK_History_HistoryItems}"> 
```

通过这种更改，控件可以很好地工作。我一直在做类似的事情，但无济于事。我真的很喜欢你在这方面的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-07T14:50:21.863

为了让触发器工作，您需要设置 ControlTemplate TargetType：

```
<ControlTemplate TargetType="{x:Type ListViewItem}"> 
```

如果没有指定 TargetType（作为 Selectable 类型），XAML 呈现将被混淆......

# math - 确定多个点的质心

> ID：353684
> 
> 赞同：6
> 
> 时间：2008-12-09T18:06:34.893
> 
> 标签：math, google-maps, geometry, geolocation

我正在编写一个用 python 编写的映射应用程序，我需要获取 N 个点的纬度/经度质心。假设我有两个位置

```
a.lat = 101
a.lon = 230

b.lat = 146
b.lon = 200 
```

使用欧几里得公式很容易获得两点的中心。我希望能够做到两点以上。

从根本上说，我想做一些类似[http://a.placebetween.us/](http://a.placebetween.us/)的事情，一个人可以输入多个地址并找到一个对每个人都等距的地点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-09T18:44:20.840

看看下面链接的 pdf 文档。它解释了如何应用[Bill the Lizard](https://stackoverflow.com/questions/353684/determine-the-centroid-of-multiple-points#353718)提到的平面图形算法，但在球体的表面上。

[海报缩略图和一些细节 http://img51.imageshack.us/img51/4093/centroidspostersummary.jpg](http://img51.imageshack.us/img51/4093/centroidspostersummary.jpg)
来源： http: [//www.jennessent.com/arcgis/shapes_poster.htm](http://www.jennessent.com/arcgis/shapes_poster.htm)
还有一个[25 MB 全尺寸 PDF](http://www.jennessent.com/downloads/graphics_shapes_poster_full.pdf)可用下载。[感谢 mixdev](https://stackoverflow.com/users/6109/mixdev)
找到原始来源的链接，当然还有 Jenness Enterprises 提供的信息。注意：我与本材料的作者没有任何关系。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T18:20:18.407

添加到安德鲁罗林斯的答案。

您还需要确保如果您在 0/360 经线的任一侧有点，您正在“正确的方向”测量

```
Is the center of (0,359) and (0, 1) at (0,0) or (0,180)? 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-09T18:56:24.667

如果您正在平均角度并且必须处理它们穿过 0/360，那么将每个值的 sin 和 cos 相加然后 Average = atan2(sum of sines,sum of cosine) 会更安全
（注意参数顺序在您的 atan2 函数中）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T18:17:21.127

[如果这些点形成一个平面图形](http://en.wikipedia.org/wiki/Centroid)，则数学非常简单。但是，不能保证一组经纬度就这么简单，因此可能首先需要找到这些点的[凸包](http://en.wikipedia.org/wiki/Convex_hull)。

编辑：正如[eJames](https://stackoverflow.com/questions/353684/determine-the-centroid-of-multiple-points#353782)指出的那样，您必须对球体的表面进行校正。我的错是假设（不假思索地）这是被理解的。给他+1。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-11T21:38:11.110

下面的 PDF 比 Jenness Enterprises 的海报更详细。它还处理两个方向的转换以及球体（例如地球）而不是完美球体的转换。

[在 3-D 笛卡尔和椭球纬度、经度和高度坐标之间转换](http://www.ordnancesurvey.co.uk/oswebsite/gps/docs/convertingcoordinates3D.pdf)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-12-09T20:34:36.467

分别平均纬度和经度。

# c++ - 如何将 QVariant 转换为自定义类？

> ID：353694
> 
> 赞同：2
> 
> 时间：2008-12-09T18:07:57.403
> 
> 标签：c++, linux, qt, casting

我在 QTreeWidgetItem 中有一个 QVariant 对象，如何将其转换为我自己的对象？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-09T18:18:45.757

您需要在`.h`文件中的某处声明以下内容：

```
Q_DECLARE_METATYPE(MyStruct) 
```

然后你可以使用：

```
MyStruct s;
QVariant var;
var.setValue(s); // copy s into the variant

// retrieve the value
MyStruct s2 = var.value<MyStruct>(); 
```

[在这里查看文档](http://doc.trolltech.com/4.3/qmetatype.html)

# cocoa - 以编程方式或通过脚本更改 Mac OS X 用户密码

> ID：353698
> 
> 赞同：2
> 
> 时间：2008-12-09T18:09:27.757
> 
> 标签：cocoa, macos, passwords

我需要能够从 cron 任务或 ssh 会话中更改用户的密码。有没有一种简单的方法可以使用 bash 脚本来做到这一点？如果不是，那么在 Cocoa 中最简单的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-06-21T18:23:32.183

Apple 在 Mac OS 10.5 中引入了允许更改密码的[CSIdentitySetPassword](https://developer.apple.com/documentation/coreservices/1443568-csidentitysetpassword?language=objc) API，如下所示：

```
#import <Collaboration/Collaboration.h>

    AuthorizationRef authRef = NULL; // You have to initialize authRef

    CBIdentityAuthority *authority = [CBIdentityAuthority defaultIdentityAuthority];
    CSIdentityRef identity = [CBIdentity identityWithName:user authority:authority].CSIdentity;
    if (CSIdentityGetClass(identity) == kCSIdentityClassUser) {
        CSIdentitySetPassword(identity, (__bridge CFStringRef)newPassword);
        CSIdentityCommit(identity, authRef, NULL);
    } 
```

AuthenticationRef 可以像 int[这个](https://stackoverflow.com/a/34810104/4797324)响应一样被初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T18:11:29.737

使用`passwd`外壳命令。

# javascript - 构建 jQuery UI 插件

> ID：353706
> 
> 赞同：5
> 
> 时间：2008-12-09T18:11:45.803
> 
> 标签：javascript, jquery, jquery-plugins, jquery-ui-plugins

除了官方文档之外，是否有任何推荐的资源来学习构建 jQuery 插件。我对为 UI 库构建插件特别感兴趣。

我一直在寻找一些官方的来源，但我发现它们看起来都完全不同。许多没有很好的评论，很难分辨哪些代码块是基本结构的一部分以及特定插件的特定内容。

如果还没有任何好的资源，任何人都可以告诉我从头开始编写插件时应该从什么基本结构开始？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T20:14:55.743

## “学习 jQuery”教程

[Learning jQuery](http://www.learningjquery.com)是一个非常有用的网站，并且有一个[很棒的插件创作教程](http://www.learningjquery.com/2007/10/a-plugin-development-pattern)。

我真正喜欢的一个原则是：**创建用户可以覆盖的默认设置**。

所以也许你可以说 $(this).highlight() 并且默认情况下它会突出显示蓝色。或者你可以说 $(this).highlight("green") 它会突出显示绿色。

但你也应该可以说：

```
 $(this).highlight({
    foreground: 'red'
    }); 
```

...默认情况下，它将**从那时起突出显示红色。**

## 其他好资源

*   [为您的编码文章加油](http://fuelyourcoding.com/jquery-plugin-design-patterns-part-i/)
*   [Starter](http://starter.pixelgraphics.us/) - 用于启动插件的工具

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T19:44:31.343

您是否尝试过 Manning Publications 关于 jQuery、[jQuery In Action](http://www.manning.com/bibeault/)的书？[目录](http://www.manning.com/bibeault/excerpt_contents.html)表明编写自己的插件有很好的材料。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T19:44:35.100

[JQuery in Action](https://rads.stackoverflow.com/amzn/click/com/1933988355)的第 7 章是“使用自定义插件扩展 JQuery”，应该为您提供所需的信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T20:02:02.180

试试[这个](http://blog.jeremymartin.name/2008/02/building-your-first-jquery-plugin-that.html)。本教程将带您逐步创建自己的插件。

# jframe - 在不使用 close(X) 按钮和终止 JVM 的情况下关闭我的 jframe

> ID：353715
> 
> 赞同：2
> 
> 时间：2008-12-09T18:16:52.377
> 
> 标签：jframe

我有一个实例化另一个帧的帧，但我不想在实例化的帧上使用 close(x) 按钮。所以我创建了一个按钮。我如何编写此按钮可用于在不退出 JVM 的情况下关闭实例化框架的代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-10T08:55:57.837

拥有自己的关闭按钮是奇怪的 UI，应该避免。

要在单击您自己的按钮时摆脱框架，您可以执行以下操作：

```
jFrame.setVisible(false); 
```

或者

```
jFrame.dispose(); 
```

如果你想完全摆脱它。

在您不想在单击关闭按钮时退出 JVM 的帧上指定：

```
jFrame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE); 
```

或者

```
jFrame.setDefaultCloseOperation(JFrame.HIDE_ON_CLOSE); 
```

取决于您想要哪种行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-16T09:53:38.227

您可以尝试 setVisible() 或 dispose() 函数

对于您的主要课程...

```
 public class Main {

/**
 * @param args
 */
public static void main(String[] args) {
    // TODO Auto-generated method stub
    //new DemoTryCatch()
    new Frame1();
}

} 
```

对于您的第一个框架类...

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;

public class Frame1 extends JFrame{
JButton newFrame=new JButton("Frame 2");
public Frame1() {
    // TODO Auto-generated constructor stub
    super("Frame 1");
    add(newFrame);
    setVisible(true);
    setDefaultCloseOperation(EXIT_ON_CLOSE);
    setSize(300,300);
    newFrame.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent arg0) {
            // TODO Auto-generated method stub
            new Frame2();\\instantiating your new Frame
        }
    });
}
} 
```

对于实例化的框架...

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;

public class Frame2 extends JFrame{

JButton CloseFrame2=new JButton("CloseFrame2");
public Frame2() {
    // TODO Auto-generated constructor stub
    super("Frame 1");
    add(CloseFrame2);
    setVisible(true);
    setDefaultCloseOperation(DISPOSE_ON_CLOSE);
    setSize(300,300);
    CloseFrame2.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent e) {
            // TODO Auto-generated method stub
            setVisible(false);\\You could also use dispose()
        }
    });
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-31T14:16:06.767

我同意汤姆的观点，我认为在您写下的代码中：

```
[framename].setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
```

`EXIT_ON_CLOSE`意味着它将完全退出应用程序。

您可以使用以下命令单击其 X 按钮来关闭窗口：

```
[framename].setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE); 
```

这是一个示例代码：

```
package answers;

import javax.swing.JFrame;

public class Answers {

    public static void main(String[] args) {

        //frame 1
        JFrame frame1 = new JFrame("this is frame 1");
        frame1.setSize(500, 500);
        frame1.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        frame1.setLocationRelativeTo(null); // ignore this its just to place frame 1 on the center

        //now this is the code for frame2
        //frame 2
        JFrame frame2 = new JFrame("this is frame 2");
        frame2.setSize(500, 500);
        frame2.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        frame1.setVisible(true);
        frame2.setVisible(true);

    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-22T00:52:46.283

您可以使用`setVisible(false)`为了从视图中隐藏实例化的 JFrame

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-16T15:46:03.883

用这个：

```
jFrame.setUndecorated(true);
jFrame.getRootPane().setWindowDecorationStyle(JRootPane.NONE); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-07-11T23:05:23.487

我不确定我是否正确，但你可以打电话`dispose()`。javadoc 建议您可以使用`show()`.

# asp.net - 部署项目 dll 导致“类型 x 存在于两者中”错误

> ID：353721
> 
> 赞同：4
> 
> 时间：2008-12-09T18:17:34.717
> 
> 标签：asp.net, web-deployment-project

我有一个用于 Web 应用程序的 WebApplication 项目、一个业务逻辑项目和一个 WebDeployment 项目。

当我构建解决方案时，部署“发布”bin 包含每个项目的 1 个 dll - 所以我为 MyWeb.dll、MyWebBusiness.dll 和 MyWebDeploy.dll 获得一个。

当我尝试运行该站点时，它会在 MyWeb.dll 和 MyWebDeploy.dll 中看到相同的类型，并且会阻塞。

错误消息：CS0433：类型 'AV' 存在于两个 'c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\53d45622\6c032bd2\assembly\dl3\33f3c6b2\abc9430a_285ac901\MyWeb .DLL' 和 'c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\53d45622\6c032bd2\assembly\dl3\631e5302\0231160d_285ac901\MyWebDeploy.DLL'

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-09T18:36:41.277

我能想到的一些原因：

*   您的项目中有一个*App_Code*目录
*   您在某些页面标记中有一个*CodeFile*页面指令，而不是*CodeBehind*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-09T07:53:34.430

有一个很棒的论坛帖子：[http ://forums.asp.net/t/980517.aspx](http://forums.asp.net/t/980517.aspx)

似乎只需要 Web 应用程序项目中的正确代码，并且 VS 说“哦，这是一个网站项目，所以我最好自动编译它”，然后当它发现它已经被编译为一个 DLL 也是如此。

上面 Darin 列出的原因是罪魁祸首。

请注意，意外地有两个对同一个程序集的引用、在 web.config 程序集部分中的双重引用或意外地将代码文件的重复副本放入项目中的文件夹中，可能会出现类似的错误，但这些通常会如果您在 web.config 中打开了调试，则非常明显，并且错误消息应提及 Web App 程序集 {WebAppName}.dll 和自动编译的程序集 App_Web_{number}.dll 以外的程序集

有很多人说（在引用的线程中）事件处理程序导致了问题，但我认为只是代码中有一些奇怪的东西被解释为需要自动编译。我在同一条船上，我已经将一大堆示例代码剪切并粘贴到我的 Web 应用程序中，并检查了以上所有内容。但是，许多页面背后的代码已经包含“Web 表单设计器生成”代码，因此当我在解决方案资源管理器上右键单击应用程序并选择“转换为 Web 应用程序”时，什么也没有发生。旧代码保留在那里，双重编译继续进行。

因此，除了这些帖子之外，我还要说：如果代码已被剪切和粘贴并且转换器不喜欢某些东西，它不会转换它并且双重编译将继续。唯一的解决方案是将有问题的页面添加为新项目，复制标记和代码（如有必要，一点一点），然后删除旧版本。

就我而言，我只是去了一个项目的网站，因为我不会被打扰，而且它只是一个演示项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-16T21:49:02.847

我将我的项目从网站转换为 Web 应用程序，并且在所有页面中都有 CodeFile 而不是 CodeBehind，即使我使用了 VS“转换为 WebApp”选项。手动用 CodeBehind 替换 Codefile 确实解决了我的问题。添加了这个，以便它可以帮助任何其他人转换为 webapp。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T11:14:02.443

将 batch="false" 添加到 web.config 文件

为您的文件提供主要用于母版页的修复名称

```
<compilation ... batch="false"/>

  ... 
```

# asp.net - MVC + IIS7 = CSS 问题

> ID：353726
> 
> 赞同：11
> 
> 时间：2008-12-09T18:19:22.183
> 
> 标签：asp.net, asp.net-mvc, iis-7

我有一个通过 IIS7 在 Vista 上运行的网站。该站点在端口 88 上运行，因此[http://localhost:88](http://localhost:88)应该呈现默认的 /Home/Index 视图。

与所有其他视图一样，这可以正常工作。

然而，一个问题是居民。我的脚本路径指向 /Scripts/[FILE]，我的 CSS 路径指向 /Content/[FILE]。我的假设是 /Content 或 /Scripts 文件夹将始终位于站点的根目录，因为我无意在虚拟目录设置中运行此站点。每当页面呈现时，它们都没有 CSS 或脚本！所以一切看起来都很不稳定，脚本显然不起作用，因此很多视图也不起作用。

这是一个非常奇怪的问题，我敢肯定是因为我缺乏在 IIS7 下托管事物的知识。任何人都可以提供任何帮助，我将不胜感激。非常感谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-10T02:29:16.050

我希望这个线程的继续传达一种意愿，以确保这个问题不会把任何人推下悬崖。在各种论坛中有很多关于在 Vista 上解决此问题的文档，但我找不到任何类似的 2K8 文章。如本[论坛帖子](http://forums.iis.net/p/1143592/1849083.aspx#1849083)所示，我能够在 Vista 机器上解决此问题。唉，类似的执行未能解决 2K8 上的问题。

我已经验证了 StaticFileHandler 已包含在 web.config[中，正如 apijunkie.com 上的这篇博客文章中所建议的那样](http://www.apijunkie.com/APIJunkie/blog/post/2007/11/Breaking-changes-in-ASPNet-20-HTTP-Handlers-when-moving-from-IIS5-on-Windows-2000-to-IIS6-on-Windows-2003.aspx)。尽管如此，还是没有运气。

在这里澄清*没有运气*- 我的服务器端功能非常完美。所有 MVC 路线都像冠军一样工作。只是所有的 CSS 和 JS 渲染都失败了。当浏览器直接指向 CSS 或 JS 文件时，结果页面是 ASP.NET 404 而不是*传统*的404 错误页面。

所以我进入 IIS7 管理器并进入 Handler Mappings 对话框。我添加了一个新的处理程序，它指定了 System.Web.StaticFileHandler 类型并给它一个 *.CSS 的扩展名。然后我对 *.JS、*.PNG 和 *.GIF 文件重复了此操作。当我在浏览器中刷新网站时，一切都完美呈现。下面的屏幕截图演示了这个过程。

处理程序映射窗口：

[![处理程序映射](https://i.stack.imgur.com/NYXjk.png)](https://i.stack.imgur.com/NYXjk.png)
[（来源：[windows.net](https://bradygstorage.blob.core.windows.net/images/managed-handler.png)）]

添加新的托管处理程序

[![替代文字](https://i.stack.imgur.com/5JJ8b.png)](https://i.stack.imgur.com/5JJ8b.png)
[（来源：[windows.net](https://bradygstorage.blob.core.windows.net/images/add-managed-handler.png)）]

这解决了问题，现在我在 W2K 中托管了一个运行良好的 MVC 应用程序。是时候喝吉尼斯了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-11-30T05:23:45.233

在控制面板中，打开或关闭 Windows 功能，然后检查 IIS 子子节点中的静态内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-09T19:00:13.990

问题在于我创建应用程序的方式。根据[位于此处的论坛主题](http://dev.communityserver.com/forums/t/485290.aspx)，我需要选择“Classic .NET AppPool”来解决我的问题。一定要爱进步！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T01:19:48.310

事实证明这不是 Windows 2008 上的修复程序。如果有人对如何解决此问题有任何想法，将不胜感激。

详细问题：

Windows 2K8 服务器，IIS7。打开管道并安装静态文件支持。MVC 工作，但 CSS 不呈现。

有没有搞错？

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-12-23T23:27:09.433

问题不在于授权/身份验证，而在于现在管理 IIS 的模块。在 system.webServer 中，您应该将**runAllManagedModulesForAllRequests**设置为**false**，这样您就可以显示所有图像/css 而不会出现身份验证问题。

在 ASP.NET 网站中，之前必须将**runAllManagedModulesForAllRequests的值设置为 true 以支持路由。**但是，一旦**使用 Service Pack 更新了 IIS 7** ，在使用 ASP.NET 路由时， **runAllManagedModulesForAllRequests**的值可以设置为**false或省略。**

参考。[http://www.iis.net/configreference/system.webserver/modules](http://www.iis.net/configreference/system.webserver/modules)

PS 不要忘记将以下行添加到我的 web.config 文件的 AppSettings 部分：

< add key="autoFormsAuthentication" value="false" />

< add key="enableSimpleMembership" value="false"/>

# openid - Microsoft Passport 和 OpenID 有什么区别？

> ID：353727
> 
> 赞同：2
> 
> 时间：2008-12-09T18:19:31.513
> 
> 标签：openid

*   OpenId 是开源的，任何人都可以实现。
*   在这两种情况下，我的凭据都保存在第三方服务器上。
*   我能想到的使用 Microsoft Passport 的唯一优势是 Microsoft 的可靠性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T18:20:27.207

OpenID 是一个去中心化的身份验证系统，而 Passport 是中心化的。

如果您使用 OpenID，您将不会依赖任何可以关闭服务或充当老大哥的第三方提供商，或者......因为您*使用的是分布式身份验证机制*。

由于所有主要提供商（包括 Microsoft）都将在不久的将来支持 OpenID，因此您可以让更多用户轻松登录。您不会强迫用户在任何 OpenID 提供商上创建帐户。如果他们愿意，他们可以运行自己的身份验证服务器来登录您的站点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-09T18:32:42.703

如果您使用 OpenID，您可以选择您的后端身份验证提供者是谁并随意更改。如果您有自己的网页，那么顶部的一些代码可以指向您的身份验证提供程序。如果你不再喜欢那个，就换成别的。

此外，如果您愿意，您可以运行*自己的*OpenID 身份验证提供程序。那么您的身份验证凭据根本不会被其他任何人持有。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T18:31:37.137

Passport 与一个供应商绑定，开放 ID 在我看来是一场等待发生的网络钓鱼噩梦。

我会说在安全性不重要的地方（博客/论坛/等）使用开放 ID 进行单点登录，在安全性更重要的地方（电子商务）使用更像 microsoft cardspace 的东西

[http://dotnetslackers.com/articles/security/microsoft_cardspace_getting_started.aspx](http://dotnetslackers.com/articles/security/microsoft_cardspace_getting_started.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T04:55:35.643

Microsoft Passport 仅支持用户名/密码身份验证。许多 OpenID 提供商支持 Cardspace 登录、X509 或其他网络钓鱼防护手段。这意味着您的 OpenID 实际上可以比 MS Passport*更安全。*

# asp.net - 面向多个开发人员的 .NET Web 服务最佳实践

> ID：353730
> 
> 赞同：1
> 
> 时间：2008-12-09T18:20:06.253
> 
> 标签：asp.net, web-services, change-management

我们有一个包含数百个报告的大型 ASP.NET 项目。我们正在将所有 SQL 查询（针对 Oracle 数据库运行）移动到三个 Web 服务中。Web 服务按命令、选择和报告查询分类。我们必须使用 SQL*Server 后端将项目的子集部署到与 Internet 断开连接的多个位置。因此，在 Web 服务中拥有与数据库的所有连接和查询使应用程序易于管理，我们可以提取报告的子集而无需修改代码。该项目使用 Serena ChangeMan 软件进行源代码控制。

问题是我们有几个程序员，他们都需要检查 Web 服务文件来处理他们的项目。我们刚刚实现了分支，但它正在慢慢变成一场噩梦。我们有每月的生产交付，有时应该进入每月构建的项目被推迟到下个月。合并已成为手动过程。

我进行了 Internet 搜索，但我很惊讶我无法找到任何好的“最佳实践”Web 服务架构白页。有许多大公司一定面临过这些问题。

大多数大型开发小组都使用分支吗？我确实读过 Visual Studio Team System Database Edition 可以提供允许应用程序连接到不同数据库的标准代码。购买 Team System 会是最好的方法吗？或者有谁知道我在哪里可以找到可以帮助我们解决这些问题的文档？

谢谢你，洛里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T18:34:56.037

这个问题似乎与软件的目的完全无关。这里的问题是您每天都有多个开发人员将使用的文件数量有限。除了玩弄它之外，我没有使用 Serena ChangeMan 软件或 TFS 的经验。我确实有使用合并/提交模型的几个版本控制系统的经验：**[CVS](http://en.wikipedia.org/wiki/Concurrent_Versions_System)**和**[Subversion](http://en.wikipedia.org/wiki/Subversion_(software))**。这些都是被广泛使用的优秀、免费的版本控制系统。

如果您不熟悉合并/提交模型，这里的想法是没有一个开发人员可以“签出”并锁定文件以进行更改。每个人都可以下载和更改任何文件。当需要将这些更改提交到源代码数据库时，如果其他开发人员对文件进行了其他更改，存储库软件将阻止提交。然后下载新版本，在大多数情况下，更改会自动与您的更改合并。您重新测试，然后提交该版本。这个模型非常成功并且非常可扩展。

说了这么多，即使是合并/提交模型也无法解决拥有少量文件而大量开发人员对所述文件进行更改的痛苦。我建议将您的功能拆分为更多的 Web 服务。也许您可以创建三组相关的 Web 服务，而不是三个单一的 Web 服务。我认为这一点，再加上使用带有合并/提交的版本控制系统将解决您的问题。

CVS 和 Subversion 服务器在 Windows、Mac 和 Linux 上运行。每个都有许多客户端，可在许多操作系统上使用。其中包括独立客户端、Visual Studio 插件和 shell 插件。另一个优点是 CVS 和 Subversion 都可以从命令行获得，这使得脚本（想想自动构建）相当容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T21:05:27.590

为什么不将您的逻辑分割成每个开发人员都可以签出的单独的类文件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T18:27:51.963

我们使用 SOA，但我们也使用更面向合并的 SVN。也许考虑一个不同的源代码控制系统？

# javascript - 您如何处理 AJAX 站点中的繁忙图标？

> ID：353746
> 
> 赞同：2
> 
> 时间：2008-12-09T18:28:33.680
> 
> 标签：javascript, jquery, ajax, concurrency, callback

此问题涉及并发问题，有关如何显示忙碌图标的建议，请参阅此问题：[Javascript - loading/busy indicator or transparent div over page on event click](https://stackoverflow.com/questions/205631/javascript-loadingbusy-indicator-or-transparent-div-over-page-on-event-click)

当用户在页面上发起 AJAX 请求时，显示某种“工作”或忙碌图标或进度指示器很有用。如果只有一个长时间运行的进程，则可以以相对简单的方式处理：

```
function do_action() {
   show_busy_icon();       

   long_running_asynchronous_process(function() {
      // Callback function run when process finishes
      hide_busy_icon();
   });
} 
```

但是，如果页面上正在运行多个异步进程，则使用 on/off 方法将不起作用。即使有其他进程正在运行，第一个完成的进程也会关闭图标。

那么，**您如何处理在网页上显示一个指示器，即当有一个或多个进程在运行时打开，当没有进程在运行时关闭？**

我想有可能保持对正在运行的进程数的计数。`hide_busy_icon()`仅当进程计数为 0 时才隐藏图标。这似乎有点容易失败。也许我没有看到更好/更简单的方法。

感谢您的想法和建议！

编辑：在标记答案中使用解决方案一段时间后，我很高兴地说它运行良好。我遇到的唯一问题是我自己的脚本调用我无法控制的脚本函数的情况。除非这些函数允许提供回调，否则无法在它们开始和结束时更新进程计数。

可能发生这种情况的一个示例是向 Google 地图添加一组标记。一旦我的脚本调用 Google 地图功能，忙碌图标就会消失，而标记仍在加载中。

我不确定处理这个问题的好方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-09T18:47:24.843

如果您希望所有操作都使用相同的忙碌指示器，请使用计数器。

代替“show_busy_icon()”，执行“increment_busy_count()”，如果忙计数从0变为1，则调用“show_busy_icon()”。代替“hide_busy_icon()”，执行“decrement_busy_count()”，它调用如果忙计数从 1 变为 0，则为“hide_busy_icon()”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T18:40:39.817

我认为问题在于您只使用了一个指标。为每个需要的操作设置一个指标可能会更容易。

因此，如果您在一个页面上有多个搜索，每个搜索区域都会有它自己的独立指示器，在相应的 javascript 函数中显示或隐藏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T20:34:18.277

[原型](http://prototypejs.org)有这个内置的；一个名为的属性`Ajax.activeRequestCount`跟踪在任何给定时间有多少请求处于活动状态。它还允许您设置全局 Ajax 响应程序以确定是隐藏还是显示“忙碌”图标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T18:40:33.110

请在此处查看我的答案：

[如何在网站内容加载时显示加载屏幕](https://stackoverflow.com/questions/244183/how-to-display-a-loading-screen-while-site-content-loads#244190)

我给出了一个小的、有效的 JavaScript 示例来说明如何做到这一点，希望对您有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T09:03:41.120

我提出了一个不同的解决方案。这不是经过测试的代码，可能无法正常工作，但只是对概念的说明。

我假设相同的精确操作不会在多个实例中运行。我这样做是为了确保通信中的超时或类似问题不会挂起指示器，而是允许在重新建立通信时解决指示器

```
 var actionRegister = new Array();

 function register_action(actionId)
 {
     show_busy_icon();       
     if(blockedTile.indexOf(actionId) != -1)
     {  // element already registered
        return;
     }
     actionRegister.push(actionId)
}

function unregister_action(actionId)
{
    var idx = blockedTile.indexOf(actionId);
    if(idx  != -1)
    {  
        actionRegister.splice(idx,1);
    }

    if(actionRegister.length < 1)
    {
       hide_busy_icon();
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-31T09:18:03.570

我们都以错误的方式看待它。Ajax 调用用于使用 XHR 加载内容。这意味着在加载内容的整个 DOM 中必须有一些预定义的元素。假设我们有一个这种类型的 html：

```
<html>
<body>
   <div id="content_1">
   </div>
   <div id="content_2">
   </div>
</body>
</html> 
```

使用 jQuery，假设我们要分别从 content_1.php 和 content_2.php 加载到 content_1 和 content_2。

使用以下脚本来处理 ajax::

```
$("content_1").html("<img src='loading.gif'>").load("http://samplesite.com/content_1.php");

$("content_2").html("<img src='loading.gif'>").load("http://samplesite.com/content_2.php"); 
```

这将在相应的 div 中放置一个加载 gif，该 gif 稍后将被从 php.ini 加载的内容替换。简单的一行脚本。无需计数器。

要求：任何最新版本的 jQuery。

# lucene - 冒泡更新的记录

> ID：353755
> 
> 赞同：1
> 
> 时间：2008-12-09T18:33:26.790
> 
> 标签：lucene

是否可以在 lucene 搜索结果中冒泡更新的记录？即。我希望 Lucene 对更接近今天日期的记录给予更高的分数。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-24T00:43:08.703

我只通过 Solr 使用过 Lucene，但它非常支持根据[用户提供的功能](http://wiki.apache.org/solr/FunctionQuery#head-fc54f81a2fe06839c65b8216a8c8b37fbf201548)提升任意文档。

在你的情况下，我会使用类似的东西：

```
recip(rord(created_when),1,1000,500) 
```

作为升压功能。我意识到这并不能回答您具体的 Lucene 问题，但如果您可以使用 Solr QueryHandler 来完成，那么您绝对可以在 Lucene 应用程序中完成！

# svn - 这听起来是个好主意吗？(svn/版本控制/webdev/部署)

> ID：353757
> 
> 赞同：2
> 
> 时间：2008-12-09T18:33:50.360
> 
> 标签：svn, version-control, deployment

我最近在我工作的公司负责设计和实施源代码版本控制、测试和部署方案。

就我个人而言，我已经在自己的项目中使用 Subversion 工作了几年。但我从来没有处理过这么大的规模。因此，我想我会在这里问是否有人对我设备的以下设置有任何意见或建议：

*   主干被用作主要的开发树，因为它应该是
*   远程服务器（测试和生产）从 SVN 存储库中签出代码。
    *   测试服务器检查主干。
    *   生产服务器检查“生产”分支。
*   一旦主干被认为准备好投入生产，它就会合并成两个分支，“稳定”和“生产”。
*   稳定分支是生产分支的垫脚石。如果新代码在生产服务器上运行后发现错误，则稳定分支用于修复错误，并测试错误修复。
*   一旦修复，更改将合并到生产分支中，并返回到主干中，在那里开发继续像正常一样添加新功能以及独立于所需的任何错误修复的任何内容。

这样，只要有生产版本，开发就不必在主干上停止，因为错误修复不依赖于主干。此外，始终有一个“只读”分支，其中提供最新的稳定和大多数无错误代码，即使在大量错误修复中也是如此。

如果有人有任何建议、意见或其他方面，我将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T19:38:38.890

我会看一下[使用 Subversion 的实用版本控制](http://www.pragprog.com/titles/svn/pragmatic-version-control-using-subversion)一书。他们为组织存储库本身以及处理标记、分支和关于发布、错误修复、新功能、实验等的主干提供了一个非常好的结构。他们为所有以及 SVN 命令处理每个的“食谱”。

这是一个相当快的阅读，他们为你做了很多思考和繁重的工作，包括你还没有想到的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T18:43:17.613

查看[持续集成](http://www.martinfowler.com/articles/continuousIntegration.html)和[巡航](http://cruisecontrol.sourceforge.net/)[控制](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)/CruiseControl.NET 。您可以在 CC 下设置“项目”以自动（每分钟）或按需签出。对于主干，您希望将其自动化，对于稳定的分支，您将按需进行。

一旦项目变得更大并且主干成为需要保护的东西，您可能希望偶尔建立一个 TRY 分支来进行重大更改或前沿/实验/未来开发。

# jquery - jQuery - 使隐藏所有/显示此 div 图像更通用

> ID：353772
> 
> 赞同：1
> 
> 时间：2008-12-09T18:39:57.633
> 
> 标签：jquery, effects

我有以下 jquery 代码。

基本上我将有几个重叠的 div 和所有这些重叠 div 右侧的链接列表。将鼠标悬停在链接上时，链接分配的 div 将淡入。

我有以下代码并且它可以工作（它使用默认窗口的示例图片），但如果有人能想到一种优化它或使其通用的方法，我将不胜感激。

```
<html>
<head>
    <script type="text/javascript" src="jquery-1.2.6.min.js"></script>

    <script type="text/javascript">
       $(document).ready(function() {

          $("#trigger1").mouseover(function() {

            $(".contentdiv").addClass("inactive");
            $("#divsunset").removeClass("inactive");
            $(".inactive").fadeOut(500);
            $("#divsunset").fadeIn(500);
          });

          $("#trigger2").mouseover(function() {

            $(".contentdiv").addClass("inactive");
            $("#divwinter").removeClass("inactive");
            $(".inactive").fadeOut(500);
            $("#divwinter").fadeIn(500);

          });

          $("#trigger3").mouseover(function() {

            $(".contentdiv").addClass("inactive");
            $("#divbh").removeClass("inactive");
            $(".inactive").fadeOut(500);
            $("#divbh").fadeIn(500);

          });

          $("#trigger4").mouseover(function() {

            $(".contentdiv").addClass("inactive");
            $("#divwl").removeClass("inactive");
            $(".inactive").fadeOut(500);
            $("#divwl").fadeIn(500);

          });

        });

    </script>

    <style>
        #divsunset
        {
          position: absolute;
          top: 5px;
          left: 5px;
        }
        #divwinter
        {
          position: absolute;
          top: 5px;
          left: 5px;
        }
        #divbh
        {
          position: absolute;
          top: 5px;
          left: 5px;
        }
        #divwl
        {
          position: absolute;
          top: 5px;
          left: 5px;
        }
        #links
        {
          position: absolute;
          top: 800px;
          left: 700px;
        }
        .inactive
        {
        }
    </style>
</head>
<body>

<div id="divsunset" class="contentdiv">
    <img src="Sunset.jpg" />
</div>

<div id="divwinter" class="contentdiv">
    <img src="Winter.jpg" />
</div>

<div id="divbh" class="contentdiv">
    <img src="bh.jpg" />
</div>

<div id="divwl" class="contentdiv">
    <img src="wl.jpg" />
</div>

<br />
<div id="links">
    <a href="#" id="trigger1">Show Sunset</a>
    <a href="#" id="trigger2">Show Winter</a>
    <a href="#" id="trigger3">Show Blue Hills</a>
    <a href="#" id="trigger4">Show Waterlillies</a>
</div>

</body>
</html> 
```

* * *

谢谢 Matt、TM 和 kRON，您的回复真的很有帮助。

我觉得我没有完全解释自己，但 TM 提供了我正在寻找的答案。

我想关注 DRY，这次 TM 提供的代码对我的帮助最大，因为它不需要我更改我的标记，只需要更改 jQuery 代码。

再次，非常感谢。我得到答案的速度之快令人惊讶。继续伟大的工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-09T18:52:34.380

你可以做的第一件事就是让它更干净，用更通用的东西替换所有这些类似的调用。

（注意：假设所有这些都在里面`document.ready()`）

```
$('#trigger1').data('target', '#divsunset');
$('#trigger2').data('target', '#divwinter');
$('#trigger3').data('target', '#divbh');
$('#trigger4').data('target', '#divwl');
$('#trigger1,#trigger2,#trigger3,#trigger4').mouseover(function() {
    var selector = $(this).data('target');
    $(".contentdiv").addClass("inactive");
    $(selector).removeClass("inactive");
    $(".inactive").fadeOut(500);
    $(selector).fadeIn(500);
}); 
```

使用逗号分隔的选择器是遵循 jQuery 的 DRY 的好方法。

我`$(element).data()`用来设置和检索元素上的一些数据，在这种情况下，选择器用于更新适当的元素。

`$(document).ready()`此外，为了更清晰的视觉外观，如果您愿意，可以使用以下内容代替。这是完全相同的东西，只是语法不同。

```
$(function() {
   //DOM ready
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T19:06:24.850

几个月前我回答了一个类似的问题[jQuery Swapping Elements](https://stackoverflow.com/questions/233936/jquery-swapping-elements#234022)如果有帮助的话。

马特

澄清，我有 {id:'1'} 你应该交换你想要显示的 div 的 id 并在其他 DIV 上创建一个通用类名来隐藏它们。

请记住，您可以将多个类应用于一个元素：

```
<Div class="name1 name2"></div> 
```

如果您将样式规则附加到原始 div，这可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T19:01:23.613

这很好，但是您需要一种更通用的方法来处理您分配的 id。

想到的最快解决方案是将淡入的重叠 div 包裹在父 div“#wrapped”下。获取所有链接并为其分配 CSS 类“触发器名称”，其中“名称”是“日落”、“冬季”等。然后您可以执行以下操作：

```
 $(document).ready(function() {

      $(".trigger").mouseover(function() {

                $(".contentdiv").addClass("inactive");
                $("#wrapper ." + $(this).attr('class')[1]).removeClass("inactive");
                $(".inactive").fadeOut(500);
        $("#wrapper ." + $(this).attr('class')[1]).fadeIn(500);
      }); 

```

这不是最好的解决方案，但希望它能给你一个想法。

# c# - 如何确定在按钮单击期间何时按住控制键

> ID：353773
> 
> 赞同：14
> 
> 时间：2008-12-09T18:40:11.423
> 
> 标签：c#, windows

如何确定在 C# Windows 程序中单击按钮时按住控制键的时间？我希望对 Ctrl/Click 执行一项操作，而对 Click 执行另一项操作。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-09T18:58:45.490

还有一点：

```
private void button1_Click ( object sender, EventArgs e )
{           
    if( (ModifierKeys  & Keys.Control) == Keys.Control )
    {
        ControlClickMethod();    
    }
    else
    {
        ClickMethod();
    }
}

private void ControlClickMethod()
{
    MessageBox.Show( "Control is pressed" );
}

private void ClickMethod()
{
    MessageBox.Show ( "Control is not pressed" );
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-09T18:55:00.473

假设 WinForms，使用 Control.ModifierKeys，例如：

```
private void button1_Click(object sender, EventArgs e) {
    MessageBox.Show(Control.ModifierKeys.ToString());
} 
```

假设 WPF，使用 Keyboard.Modifiers，例如：

```
private void Button_Click(object sender, RoutedEventArgs e) {
    MessageBox.Show(Keyboard.Modifiers.ToString());
} 
```

# actionscript - 如何从 AIR 应用程序访问浏览器信息？

> ID：353777
> 
> 赞同：1
> 
> 时间：2008-12-09T18:40:50.160
> 
> 标签：actionscript, browser, air

我正在尝试构建一个将在 Linux/Mac OS/Windows 上运行的 Adob​​e AIR 应用程序，它监视用户的浏览历史记录。

我的 AIR 应用程序如何找出安装了哪些浏览器？换句话说，要监控的浏览器历史列表。

还有什么方法可以知道浏览器在运行时是否正在运行？

至于历史文件，我有一些关于 Firefox 的信息，所以任何关于读取/解析 IE/Safari/Opera/Chrome 历史文件的信息/链接将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-09T23:35:18.613

1.  没有 API 可以做到这一点。我认为你最好的选择是查看它们的安装位置，即 Windows、Mac 等上的“程序文件”或“应用程序”。如果你绝对需要找到浏览器，你可以遍历整个文件系统寻找二进制文件，尽管这显然会影响性能。

2.  AIR 基本上不提供与操作系统的集成，因此没有真正的方法来确定哪些正在运行，哪些没有运行。如果任何浏览器在运行时创建临时文件，您可以检查它们是否存在。

# javascript - 初学者：Javascript必须在标题上才能运行？函数的声明顺序重要吗？

> ID：353786
> 
> 赞同：0
> 
> 时间：2008-12-09T18:45:01.837
> 
> 标签：javascript

我脑子里有这个功能：

```
<head>
      window.onload = function(){
         var x = new Array(0,2,3,4,5,6,7,8);
         var y = new Array(20,10,40,30,60,50,70,10);  
         drawGraph(y,x);
      }
</head> 
```

我可以在正文的某处声明函数 drawGraph() 吗？我需要在调用它之前声明它吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-09T18:50:44.883

顺序确实很重要。您需要在调用之前声明 drawGraph() 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T21:27:41.400

请记住，许多 Web 平台已经使用了 window.onload 方法，并且由于 window.onload 只能调用一次，您可能会遇到脚本冲突。您可能会考虑使用不同的方法来加载构建 window.onload 或等待页面加载完成的脚本。

不使用 JQuery 等 JavaScript 框架的示例如下所示：

```
function addLoadEvent(func) {
    var oldonload = window.onload;
    if (typeof window.onload != 'function') {
      window.onload = func;
    } 
    else {
      window.onload = function() {
        oldonload();

        var x = new Array(0,2,3,4,5,6,7,8);
        var y = new Array(20,10,40,30,60,50,70,10);  
        drawGraph(y,x);
      }
    }
} 
```

使用 JQuery 的示例如下所示：

```
 $(document).ready(function() {
    var x = new Array(0,2,3,4,5,6,7,8);
    var y = new Array(20,10,40,30,60,50,70,10);  
    drawGraph(y,x);         
  }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-29T18:58:57.010

您应该能够`drawGraph`在文档中的任何位置使用该函数，因为在文档完全加载之前不会调用它。这意味着任何`<script>`标签都应该已经被解析和执行。

虽然顺序很重要，但如何声明函数也很重要。如果使用声明语法，...

`function identifier ( arglist ) { body }`

...然后它会在脚本执行之前就存在，无论您在脚本中的哪个位置声明它（我不确定这是否是所有解释器的标准，但它似乎适用于 Firefox、Chrome 和 Internet Explorer） . 但是，这只适用于单个`<script>`标签。在解析这些脚本之前，其他脚本标签中的声明将不存在，这是在前面的脚本执行之后。

```
<html>
    <head>
        <script type="text/javascript">
            function check_existance()
            {
                if(!check_existance.i)
                    check_existance.i = 0;

                document.write("<h5>Call : " + ++check_existance.i + "</h5>" +
                      "func1 : " + typeof func1 + "<br />" +
                      "func2 : " + typeof func2 + "<br />" +
                      "func3 : " + typeof func3 + "<br />" +
                      "func4 : " + typeof func4 + "<br />");
            }
        </script>
        <script type="text/javascript">
            check_existance();

            func1 = function()
                    {
                        alert("func1");
                    };

            check_existance();

            function func2()
            {
                alert("func2");
            }
        </script>
    </head>
    <body>
        <script type="text/javascript">
            check_existance();

            func3 = function()
                    {
                        alert("func3");
                    };

            check_existance();

            function func4()
            {
                alert("func4");
            }
        </script>
    </body>
</html> 
```

输出：

**调用：1**
func1：未定义
func2：函数
func3：未定义
func4：未定义

**调用：2**
func1：函数
func2：函数
func3：未定义
func4：未定义

**调用：3**
func1：函数
func2：函数
func3：未定义
func4：函数

**调用：4**
func1：函数
func2：函数
func3：函数
func4：函数

我相信 YSlow 建议`<script>`将标签放在文档的底部（我猜在结束`</body>`标签之前），因为它们在浏览器中的加载方式。

# properties - 如何在 Java 中获取 JDK 目录的位置？

> ID：353788
> 
> 赞同：1
> 
> 时间：2008-12-09T18:45:46.123
> 
> 标签：properties, java

是否有类似 System.getProperty("java.home") 的属性将返回 JDK 目录而不是 JRE 目录？我查看了[https://docs.oracle.com/javase/1.5.0/docs/api/java/lang/System.html#getProperties()](https://docs.oracle.com/javase/1.5.0/docs/api/java/lang/System.html#getProperties())，JDK 似乎没有任何内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T18:48:35.527

一种方法是设置一个系统环境变量，如“JAVA_HOME”并使用它。

它可能不是最好的解决方案，但它会起作用，这是其他需要 JDK 而不是 JRE（如 CruiseControl）的应用程序在设置它们时要求您执行的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T19:08:16.517

没有类似于`java.home`JDK 的属性。有一些经验法则可以帮助检测您正在运行的 JRE 是否是 JDK 的一部分。例如，查找“${java.home}/../lib/tools.jar”。换句话说，在某些情况下，您可能会建议一个默认值，但一般来说，用户应该告诉您使用哪个 JDK。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T19:07:39.403

另一种方法是通过属性文件定义 JDK 的路径。这可以是系统环境变量的补充，以允许覆盖。

根据您的用例，您可以将此属性文件放在主目录中或与您的应用程序一起打包。

# sql-server - 在 MSSQL 中查询返回特定数据库的 .mdf 和 .ldf 文件名/位置？

> ID：353793
> 
> 赞同：9
> 
> 时间：2008-12-09T18:47:03.220
> 
> 标签：sql-server

我可以在 MSSQL 中使用查询来获取特定数据库的 .mdf 和 .ldf 文件名/位置吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-09T18:51:40.870

SELECT * FROM [sys.database_files](http://msdn.microsoft.com/en-us/library/ms174397(SQL.90).aspx) (SQL 2005+)

选择 * 从 dbo.sysfiles (SQL 2000)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-26T09:32:43.420

您可以使用：

```
exec sp_helpfile 
```

将返回一个查询，其中包含有关当前数据库文件的信息。

这适用于任何 SQL 服务器版本。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-09T18:52:18.797

```
SELECT * FROM sys.master_files 
```

...将为您提供有关数据库所在位置的基本视图。它可能无法很好地处理文件组等。

# php - 继承了PHP的噩梦，从哪里开始？

> ID：353795
> 
> 赞同：40
> 
> 时间：2008-12-09T18:48:18.100
> 
> 标签：php, maintenance

我继承了一个 PHP 项目，结果证明它是一场噩梦。以下是要点：

1.  所有原始开发人员都已离开
2.  代码没有版本控制
3.  通过重命名和编辑 PHP 文件，所有开发和测试都在实时服务器上完成。每个文件 index.php、index2.php、index3.php 等都有多个副本，不清楚哪些文件真正被使用
4.  每个文件中有多个包含到包含其他文件的文件中包含其他文件等的文件。
5.  该项目有多个开发人员，每个人都有自己的做事方式。例如，有一个大杂烩的 JavaScript 框架，一些数据库查询使用 SQL，另一些使用 XML 接口，还有一些调用数据库中的过程函数。

由于所有这些问题，发展缓慢得令人沮丧。除了向 Stack Overflow 发泄我的挫败感之外，还有什么关于如何开始处理这个烂摊子的建议吗？我自己对 PHP 开发还很陌生，但是第一步似乎是设置某种开发环境以便可以在不破坏实时服务器的情况下测试更改。关于如何从这里开始的任何提示？进行测试的典型方法是什么？在我的桌面上设置站点的本地版本似乎需要做很多工作（服务器是 Linux，但这里的桌面是 Windows）。我可以在实时服务器上创建一个子目录进行测试，或者..？数据库呢？

其次，是否可以启用某种分析来跟踪服务器上实际使用了哪些文件？我想删除实际上未包含的内容的重命名副本。更好的是，有没有办法判断文件的哪些部分没有被执行？有很多复制的功能和垃圾，我怀疑它们也没有被使用。同样，对于包含的内容，有任何关于整理混乱的提示吗？

好吧，我将停止在这里发泄，并让自己听从这里的每个人的摆布。:)

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-12-09T18:58:41.903

1.  首先，按原样获取版本控制中的文件。**在完成之前不要继续通过#1。**
2.  建立测试环境。
3.  清理文件

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-12-09T19:25:33.113

我已经做到了。你有我的同情。如果您的护照不是最新的或由于某些其他原因您无法避免这样做，我会这样做：

零步是将其纳入版本控制，无论它多么糟糕。如果它甚至可以工作，并且您破坏了某些东西，您需要能够回到工作状态 - 或者至少将您的更改与它进行比较以找出问题所在。在重构时进行频繁的小规模签入，当事情莫名其妙地出错时，您将有更少的代码可以回滚。（事情会莫名其妙地出错。）

之后，我将从数据库开始。确保所有内容都相对规范化，列名称清晰，等等。

接下来执行 PHP 代码。如果代码真的是拼凑而成，我会继续将其安装到框架中。看看[CakePHP](http://cakephp.org/ "CakePHP")或[Symfony——](http://www.symfony-project.org/ "Symfony")他们的 Rails 式分离关注点的方式提出了一个问题：“这段代码应该去哪里？” 容易回答。这不是一项小任务，但一旦你完成了它，你可能比拥有一个构建良好的应用程序的一半要好。此外，一个好的 Web 框架的内置测试工具使重构 FAR 变得更容易——在更改现有功能之前编写一个测试来覆盖现有功能，并且您将知道更改后是否破坏了任何东西。

一旦对数据库进行了排序并在模型中包含模型代码，在控制器中包含控制器代码，那么您就可以担心表示级别的事情，例如标准化单个 JS/AJAX 库、清理 CSS 等。

至于开发环境：您绝对应该设置本地开发环境。那里有交钥匙 WAMP 包，或者您可以安装到 Linux 机器/VM（我推荐使用[VirtualBox](http://www.virtualbox.org/ "虚拟盒子")进行虚拟化）。您还应该有一个模拟实时服务器的单独集成测试环境。只有实时代码应该在实时服务器上运行。

至于调试/分析工具，我知道 Symfony 带有一组非常漂亮的工具，包括在您的页面上出现的一个小 JS 工具栏（仅在调试模式下），带有日志记录和分析信息。

祝你好运。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-12-09T19:23:36.593

嗯，第一件事。我遇到过你的情况，很糟糕。我认为您希望建立并运行一个开发环境，这在正确的轨道上。

## 开发环境

这将包括一个 Web 服务器/脚本引擎/数据库引擎堆栈，以及最有可能的 IDE。

对于**[LAMP](http://en.wikipedia.org/wiki/LAMP_(software_bundle))堆栈安装程序**，我建议使用以下之一：

*   [http://www.apachefriends.org/en/xampp-windows.html](http://www.apachefriends.org/en/xampp-windows.html)
*   [http://www.easyphp.org/](http://www.easyphp.org/)
*   [http://www.nucleex.com/nucserv/](http://www.nucleex.com/nucserv/)

进一步阅读 LAMP 堆栈：

[O'Reilly 的 OnLamp 网站](http://www.onlamp.com/)

对于一个好的**PHP IDE**，我建议使用以下之一：

*   [禅德工作室](http://www.zend.com/en/products/studio/)
*   [ActiveState 科莫多](http://www.activestate.com/Products/komodo_ide/index.mhtml)
*   [Jetbrains PhpStorm](http://www.jetbrains.com/phpstorm/)

[IBM 开发人员网站上](http://www.ibm.com/developerworks/opensource/library/os-php-ide/index.html)比较几种 IDE 的文章

对于**源代码控制**，您可以使用 Team Foundation Server、SVN 或 Git — 只需使用您知道的东西。我建议首先将所有内容都放在源代码控制中（对于您可能需要的任何紧急维护），然后计划进行相当大的检修。

## 大修

您提到您甚至不知道正在使用哪些文件，并且他们使用文件命名约定作为伪版本控制。一旦您的开发环境启动并运行，您可能希望在那里开始大修。有几件事可以帮助您：

*   您的应用客户/用户
*   细致而有条理的笔记
*   一个好的日志框架

**您的客户/用户很重要**，因为听起来您是该项目的新手，他们会知道应用程序应该如何表现得比您更好（很可能）。

**细致的笔记很重要**，因为您将基本上从头开始重写任何需求/设计/最终用户文档。如果你要这样做，你需要了解内部结构。而且，如果您要了解有关此系统的任何内容，则需要自己写下来（或者您现在正在阅读预制文档而不是阅读 Stack Overflow）;-)

最后，**日志框架很重要**，因为您需要修复问题，而您无法修复您不知道已损坏的内容。日志框架使您可以查看应用程序中没有任何明显 UI 的部分。将其插入应用程序的各个部分，然后查看日志，您可以很好地了解代码何时执行以及执行顺序。

您需要专注于捕获（在纸上）应用程序应该如何工作，然后慢慢删除不必要的文件，同时尽量不破坏任何东西。密切关注日志以帮助调试。确保您的客户没有尖叫某件东西坏了。确保您的笔记与记录的内容和客户所说的内容一致。

## 防止将来发生这种情况

**重新检查一切回到源代码控制**。希望此时您已经获得了一个更新、更健全、更好的目录结构。

**建立一个测试结构**。即使这只是意味着建立一个基本的单元测试框架并在每次部署后进行一些基本的冒烟测试，总比没有好。理想情况下，您应该有一位测试工程师或一位知识渊博且值得信赖的客户，他们可以在每次部署后花时间进行测试。

**如果您培养了多个开发人员，请制定**部署流程。**控制对生产环境的更改应该是您的首要任务。（你最不想做的就是再次经历这个，对吗？）你应该有一个清晰而简单的过程来在环境边界之间移动（比如开发 -> 测试然后测试 -> 生产）。**

 *** * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-12-09T22:56:58.333

大多数情况下，您可以使用 grep 判断文件是否正在使用。

```
grep -r "index2.php" * 
```

您还可以使用 PHP 解析器来帮助您进行清理。这是一个示例脚本，它打印出声明的函数和函数调用：

```
#!/usr/bin/php
<?php
class Token {
    public $type;
    public $contents;

    public function __construct($rawToken) {
        if (is_array($rawToken)) {
            $this->type = $rawToken[0];
            $this->contents = $rawToken[1];
        } else {
            $this->type = -1;
            $this->contents = $rawToken;
        }
    }
}

$file = $argv[1];
$code = file_get_contents($file);

$rawTokens = token_get_all($code);
$tokens = array();
foreach ($rawTokens as $rawToken) {
    $tokens[] = new Token($rawToken);
}

function skipWhitespace(&$tokens, &$i) {
    global $lineNo;
    $i++;
    $token = $tokens[$i];
    while ($token->type == T_WHITESPACE) {
        $lineNo += substr($token->contents, "\n");
        $i++;
        $token = $tokens[$i];
    }
}

function nextToken(&$j) {
    global $tokens, $i;
    $j = $i;
    do {
        $j++;
        $token = $tokens[$j];
    } while ($token->type == T_WHITESPACE);
    return $token;
}

for ($i = 0, $n = count($tokens); $i < $n; $i++) {
    $token = $tokens[$i];
    if ($token->type == T_FUNCTION) {
        skipWhitespace($tokens, $i);
        $functionName = $tokens[$i]->contents;
        echo 'Function: ' . $functionName . "\n";
    } elseif ($token->type == T_STRING) {
        skipWhitespace($tokens, $i);
        $nextToken = $tokens[$i];
        if ($nextToken->contents == '(') {
            echo 'Call: ' . $token->contents . "\n";
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-12-09T23:24:31.820

如果这是最坏的情况，代码全部被打乱，所有显示都与逻辑和数据库调用混合在一起，你可能会做我在一个 PHP 项目中必须做的事情。

我给了它三个尝试重构方法的开始。这就像骑着摩托车爬山，每次都走完 10% 的路程。所以我采取了另一种方法，结果效果更好。

1.  我以用户身份登录，
2.  并研究了我能找到的每个屏幕和每个用例。
3.  我将html保存到静态文件，
4.  并记录程序操作和明显的业务规则。

我这样做了整整 3 天，然后做笔记并与利益相关者进行了长时间的交谈。

在初步达成一致意见后，我使用良好一致的设计和抽象正确地重新实现了所有 html UI。滚动后，我每天可以做几个屏幕。

然后我将结果返回给利益相关者，并浏览了一堆用例。（利益相关者对第 1 步和第 2 步非常满意，因为他们根本不喜欢第一个实现（惊喜），现在看起来有改进的希望，而不仅仅是恢复正常的旧应用程序。

结果证明这是辛勤工作的结束（也是利益相关者感知到的项目风险的结束。）

原来，第一批工作人员被他们自己的错误意大利面缠住了，以至于工作内容实际上相对较少，所以复制它的范围比每个人都想象的要小。

但关键的决定是原始代码，无论是内容还是结构，都是不可重构的，我需要从一个完全外部的角度使用一个设计合理的新框架来工作。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-12-09T18:57:02.780

1.  设置一个开发服务器（正如 Greg Hewgill 提到的，VirtualBox 和 Virtual PC 是很好的选择）。

2.  将当前站点文件（包括相关的 Web 服务器和 PHP 配置！）放入版本控制中。

3.  找出正在使用的文件 - 使用您的开发服务器设置通过删除所有 fooN.php 文件进行测试，看看它是否仍然有效。

4.  祈祷...很多（好吧，这不是必需的，但听起来你会需要它）。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-12-09T19:38:46.330

您可能会考虑的一件事是在开发环境中安装 PHP“xdebug”扩展，将其设置为跟踪所有函数调用，然后尽可能充分地（可能通过自动化 UI 测试）运行整个应用程序。然后，您将能够分析/解析 xdebug 跟踪文件以查找应用程序使用的所有文件/函数。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-12-09T20:29:04.857

这个线程上的其他人有很好的建议。我也遇到过这种情况。可能每个人在他们的职业生涯中都有一次进入一个看起来像是被龙卷风袭击的项目。

我要补充的一个建议是，在您进行其他人描述的任何清理工作之前，您需要获得管理层的支持。

*   根据此线程上的建议制定计划。
*   描述创建开发和测试环境所需的任何新硬件或软件，并为它们定价。
*   找出需要培训哪些新技能才能设置和使用开发和测试环境。估计您获得这些技能所需的时间和费用。例如书籍或付费培训。
*   估算一个工作时间表，让您进行清理工作。将代码置于源代码控制下需要多长时间？多长时间了解数据库？多长时间了解 PHP 和 javascript 代码？
*   将此呈现给您的经理，并根据对他的底线的好处来表达目标。例如，一旦一切都清理干净，进行更改或推出新功能将更快，调试错误将更可预测，并且增加新员工将更容易。

当然，您需要继续处理当前的混乱，因为它是一个实时站点。管理实时站点具有优先权，因此清理工作必须是后台任务。这意味着它将需要更长的时间。我清理一个中等规模的项目作为后台任务的经验通常需要六到十二个月。由于该站点将在此期间继续发展，您完成的一些清理任务可能需要修改或重新完成。确保你的经理也明白这一切。

如果经理拒绝你清理这个烂摊子的计划，或者不重视清理它，那么至少你会知道为什么所有其他开发人员都离开了这家公司！

我有一些关于如何进行的具体建议：

*   除了所有其他很好的建议之外，我建议使用[Joel 测试](http://www.joelonsoftware.com/articles/fog0000000043.html)作为基准。你的清理计划应该会产生一个在 Joel 测试中得分很高的工作环境。
*   [阅读我对“了解不熟悉的数据库的最佳方法是什么？](https://stackoverflow.com/questions/278430/what-are-the-best-ways-to-understand-an-unfamiliar-database#278458) ”的回答。
*   在网站上启用日志记录，以便您可以分析实际调用了哪些 PHP 页面。至少这告诉您 index2.php、index3.php、index4.php 等中的哪一个是真正过时的。
*   PHP 有一个函数[`get_included_files()`](http://php.net/manual/en/function.get-included-files.php)可以返回当前请求中包含的所有文件的数组。通过记录此信息，您可以找出正在使用的 PHP 文件，即使它们没有显示在 Web 服务器日志中。
*   您确实需要一个与您的生产服务器相匹配的测试和开发环境。在 Windows 上测试并在 Linux 上部署是没有好处的。在开发过程中使用 MySQL 5.0 而在生产中使用 MySQL 4.0 是不好的。您可能可以使用更适中（尽管兼容）的硬件平台。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-12-12T01:45:50.237

您可以通过将其放在页面底部附近来查看所有包含/必需文件的列表：

```
<?php var_dump(get_included_files()); ?> 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-12-09T19:09:19.480

我会：

1.  坐下来深呼吸；
2.  确定这是否真的是您想要工作的地方；
3.  假设是的，那么我会卷起我的袖子，一次挑一个烂摊子去工作，然后开始工作。

我知道我们不能一次只完成一项任务。但是，您可以将工作限制在一次解决一个烂摊子上，同时处理出现的日常任务。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-12-10T00:02:56.687

## 考虑重写并使用旧站点作为功能规范

令人惊讶的是，据我所知，甚至没有人*提到*这一点，但还有另一种选择：**放弃代码，只使用网站本身的功能作为新的功能集规范**（即，这是有史以来的第一个项目），然后基于这些功能，使用已建立的框架（例如 Symfony、Laravel 或 Drupal）重新构建站点。

是的，有些人会对*重写*这个邪恶的词感到畏缩......但在*某些*情况下，这实际上是一个更好的方法，你暗示了一些原因：

*   你自己对 PHP 开发还很陌生
*   你可能会更好地从一些*干净*的东西而不是你继承的纯废代码开始
*   归根结底，*大多数用户根本不在乎源代码*，如果它看起来对他们“有效”，如果你试图告诉他们某些事情是非常错误的，他们可能会认为你疯了
*   如果您在一个统一的框架内学习源代码修订控制和数据库设计的实践，您将获得更多乐趣并活得更久

当然，这个职位的每个人以前都必须使用这样的代码，但有时已经足够了，最好放弃意大利面并从一个新盘子开始。

如果您阅读[Joel](http://www.joelonsoftware.com/articles/fog0000000069.html)关于为什么重写是不好的文章，您会注意到他引用的几乎所有情况都不适用于您。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-12-09T23:06:56.567

1.  现在备份代码。

2.  版本控制。

3.  创建一个测试站点。该站点是否在 Apache 下运行？您甚至可以在自己的计算机上安装 Apache+ PHP + MySQL，并使用它进行测试。

4.  处理安全问题。确保站点受到保护，免受 sql 注入和电子邮件注入。至少，您可以搜索数据库调用并添加调用`mysql_real_escape_string()`（好吧，如果它使用 MySQL 数据库）......一旦您更好地理解代码，您可以稍后进行真正的修复。对于电子邮件注入...编写一个过滤器函数来过滤垃圾邮件发送者代码，并确保过滤电子邮件中使用的所有表单字段。（是的，它添加了更多的意大利面条代码，但在您准备好对代码进行重大重构之前需要一段时间。）

5.  之后，我建议增量升级。你是新手，代码是一团糟，所以需要一段时间才能理解这一切......并完全理解领域。因此，只需稍微完成您的工作，修复需要修复的内容，添加需要添加的内容。当你这样做时，你正在学习系统是如何组合在一起的。一旦您更好地了解代码的组织方式（或未组织方式），您就可以开始计划对系统进行重大重构/重写。希望您可以逐个组件地完成它，这样您就总能获得一个新的里程碑。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-12-09T19:24:04.317

我认为您的所有 5 点都针对我继承的一些经典 ASP 项目，还有一个 PHP 项目......

我完全同意其他人的观点，即尽快将其纳入源代码控制并使用 VMWare、VirtualBox 等作为测试环境。

确保也对数据库进行版本控制，特别是如果过程中有额外的逻辑（不仅仅是直接插入、更新、删除）。数据库版本控制比 php 页面更受关注。您需要将所有对象生成为 sql 脚本并将这些脚本放入源代码管理中。然后，当您更改数据库结构、程序等时，您需要更新脚本，以便您也拥有这些更改的历史记录。

至于弄清楚在数据库方面使用了什么，我建议查看[ApexSQL Clean](http://www.apexsql.com/sql_tools_clean.asp)。我在一个包含数百个 ASP 文件、200 多个表和大约 400 个存储过程的项目中使用了它。我能够识别出大约 20 个未使用的表和大约 25% 的存储过程。使用 ApexSQL Clean，您可以将所有 php 文件与表、视图和存储过程一起添加到依赖项检查中。获取 30 天试用版并检查一下，它将为您节省大量时间。

对于网站使用的文件，我有上个月的网络服务器日志，并对它们进行搜索以查找我不确定的任何内容。我也喜欢 Aistina 建议修改文件以在访问时记录的变化。也许让它进入您设置的数据库中的一个表，该表是文件名和访问计数，并且每次加载该文件时它都会增加计数。然后在一段时间后，您可以查看计数并确定可以执行的操作。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-12-09T19:30:09.890

这里有一些想法：

*   PHP 和 Apache 在 Windows 上也可以正常工作。也许您毕竟可以进行全 Windows 安装？
*   尝试`grep`在所有 PHP 文件中使用“include”和“require”（或某些 Windows 替代方案）。然后列出所有找到的包含文件。将列表与文件夹中的文件进行比较。您应该能够摆脱至少一些未引用的文件。
*   或者，列出所有文件名并搜索所有文件。你可以制作像这样的依赖图。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-12-09T19:31:19.933

这确实是一团糟。但是开始创造性地在哪里切断这个东西的一些触角：

1.  获取版本控制。我推荐 Git。
2.  设置本地开发服务器。查找 WAMP、LAMP 或 MAMP 包以帮助您入门，因为您是新手。
3.  找到入口点（index.php 等）。检查您的服务器访问日志以查看它们是什么。
4.  在一些正则表达式黑魔法上卷起你的袖子，并在所有文件上转储一个包含/要求树。但要注意任何 include( $filename ) 动态包含。如果您有任何这些，您需要在 $filename 上进行一些登录以找出可能包含的内容，尽管它周围的代码应该为您提供线索。运气好的话，您可以通过这种方式剔除所有未使用的文件。
5.  使用更多的正则表达式黑魔法来检查代码库中其他地方是否引用了函数和方法。可能有一个 IDE 可以帮助您解决这个问题。试试 NetBeans（我曾经用它来帮助我重构一个 C++ 项目，所以在这里可能会有所帮助。）
6.  正如其他人回答的那样，“如有必要，找出是否使用了某些类而没有使用某些类，您可以将 get_declared_classes 与 get_defined_vars 和 gettype 结合使用来查看正在实例化哪些类型。” 您也可以只编写一些代码来查找代码库中的所有新语句。
7.  等等……想想你怎么能削弱这个怪物。并尝试在可能的地方重新组织代码。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-12-09T18:50:25.490

我要做的第一件事是使用某种虚拟机建立一个测试环境。VirtualBox 或 Virtual PC 将是不错的选择。这样你就可以开始改变事情而不必担心破坏生产环境。无论这看起来有多少工作（使用数据库和 Web 服务器以及所有东西），最终它都是值得的。最大的好处之一是，如果您发现需要帮助，您可以复制 VM 并将其提供给其他人。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-12-09T18:53:52.083

你肯定需要一个开发环境。如果您不想在 Windows 机器上运行该站点，您可以获取一些 Linux 发行版的 VMWare 映像。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-12-09T19:01:50.837

第一步当然是将其置于版本控制之下。这样至少你可以回到原来的工作版本。其次，覆盖 include、require 等函数可能是个好主意，例如，将包含的文件的文件名写入某个日志文件，这样您就可以找出实际包含哪些文件（因此希望排除了很多index2.php、index3.php等。

如有必要，要查明是否使用了某些类而未使用某些类，您可以将 get_declared_classes 与 get_defined_vars 和 gettype 结合使用，以查看正在实例化哪些类型。

至于第 4 和第 5 题，这些可能更难解决，但这应该会让你有希望地开始。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-12-10T04:31:47.813

关于如何处理这个问题的很多有用的帖子。

不想重复其他人所说的话：

1.  获取运行的 prod 环境的副本。它可以是虚拟机，也可以是另一台真机。但你需要成为上帝。如果产品数据库在另一个盒子上，你也需要一个开发版本。
2.  将其全部投入版本控制。在另一个盒子上。至少每周备份一次。
3.  确保您知道分支在您的版本控制应用程序中是如何工作的。你可能会需要它。
4.  锁定 prod 服务器。您不希望对其进行任何不超出版本控制的进一步更改。
5.  创建将代码从版本控制发布到产品服务器的指令。可发布更改的最小单位应该是整个代码库。

接下来的步骤取决于用户对它的依附程度。如果由于某种原因不能改变太多，您将需要一种渐进的方法。如果仍然需要进行开发和维护，那么这可能是您唯一的选择。请记住使用该分支功能将此类模块与您的重写工作分开。

为了使结构有意义，您必须基本上在现有结构旁边创建一个新结构。一个新的 DB 处理程序通常是一个很好的起点，它包含在每个页面都应该加载的通用包含文件中。这里的目标是创建一个可以在以后扩展的最小包含结构，而无需告诉每个页面加载其他文件。

现在您需要开始将功能转移到新的包含文件中。您将需要一种同时打开多个文件的方法，例如多文件编辑器或 screen+vi（或 emacs）。从在不同地方重复的实用功能和代码块开始。尽量不要因为一次修复很多事情而分心。当其他问题得到解决时，某些类型的问题将不得不移动位置。你稍后会回到他们身边。

不要觉得你需要添加第三方框架。快速添加这样的东西会导致完全重写。在这一点上，这将比仅仅驯服它的包含结构要多得多的工作。所以先整理一下。

当您移动功能时，您需要让文件使用新的包含文件。您为您执行此操作的前几个文件将在一段时间内追逐冲突。这会让人感到沮丧和毫无意义，但这可能是最难的部分。几个文件后，它会变得更容易。有时您可以通过将十几个包含替换为一个来将半打页面迁移到新的包含文件。该操作的另一面是您可以删除一些文件。

如果您坚持下去，您最终会达到所有包含文件都是您编写的文件的地步，并且您将跨越整个包含布局。到那时，进行更具侵入性的更改将变得容易得多，例如放入第三方框架。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-12-09T22:09:39.957

我知道你的感受。我继承了这样一个项目的发展。它陪伴了我一年，老实说，它让我成为了今天的开发者。没有比埋头苦干更好的个人晋升机会了。

以下是对我帮助最大的事情：

*   识别哪些是系统的关键文件。您会找到它们，因为您的大部分工作都将在它们中完成
*   创建项目的本地版本（包括数据库）并将其置于版本控制之下
*   仅适用于少量更改的文件
*   在彻底测试之前不要在生产版本中放入任何东西，然后准备好放回旧版本
*   了解系统用户的处理方式（会话、cookies）。创建一个超级用户，然后当您需要在系统上实时测试您的代码时，将其放在如下块中：

    ```
    if($_POST['your_registered_user_name']{
       //Your live code being tested, which will be visible only to you when you are logged in
    } 
    ```

    其他用户将无法感受到这些变化。当我无法替换本地机器上的系统状态时，这种技术帮助了我很多

*   编写测试，并为您编写的所有代码遵循严格的工程指南

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-03-02T17:50:19.167

1.  **将其置于修订控制之下。**

2.  **决定命名约定和文件/目录结构。**

3.  **确保你有像样的工具/IDE。**

4.  **如果您还没有设置单独的开发/测试环境**

然后 ...

5.  不幸的是，您需要筛选所有这 1、2、3 个文件并确定哪些正在使用，哪些可以丢弃。除了一个文件一个文件的蛮力碾压之外别无他法。

6.  即使我有一个 RCS，我仍然经常将我认为未使用的脚本移动到一个隐藏的位置，比如 .mausoleum，然后让 RCS 忽略该位置。很高兴能够在不返回 repo 的情况下在本地查看。

7.  **尽可能将 HTML 和 PHP 分开**。我不能强调这一点！如果在每个文件中都这样做，那很好。只要您有单独的 PHP 和 HTML 块。当然，HTML 会到处出现回声，但请尝试将所有测试、开关和其他所有内容移出 HTML 块并移入 PHP 块。在解决问题时，仅此一项就可能是*巨大*的。

8.  如果代码主要是程序性的——我假设在你的情况下是——最好先做一些清理，然后再进行任何严重的重构或重构到类中。

9.  当您找到可以逻辑组合的文件/脚本时，请这样做。（我见过的项目——可能与你的不同——幸存文件的总数大约是我们开始时的 1/4）。

一旦你走到这一步，你就可以开始适当的重构或重构为类。

好机会！

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-01-11T19:55:53.323

是的，版本控制绝对是第 0 步。

我还推荐一个好的**代码搜索工具**。

*Agent Ransack*非常好（假设你在 Windows 上） [http://www.mythicsoft.com/agenttransack/Page.aspx?page=download](http://www.mythicsoft.com/agentransack/Page.aspx?page=download)

如果没有代码搜索，我会盲目飞行。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-12-11T02:29:24.160

我自己*刚刚*经历了这个。

我的第一条建议是不要在第一天尝试改变一切。如果你真的想解决这个问题，你需要朋友。在你建议如何改变他们几个月（几年？）所做的一切之前，你需要尊重你的同事。

首先，尽快将代码置于版本控制之下。如果这对您来说不容易，至少开始每天备份，即使这意味着只是压缩文件并用日期命名 zip 文件。如果那里没有人知道版本控制，请购买有关 CVS 或 SVN 的实用程序员书籍，然后自己进行设置。这些书可以在一天内读完，您可以快速启动并运行。如果没有其他人想使用版本控制，您可以自己使用它......然后当有人丢失文件时，您可以使用您的存储库中的副本来节省一天的时间。其他人迟早会看到版本控制的智慧。

其次，尽可能地深入研究代码。生活它并呼吸它一个月。向在场的人表明您将学习他们的代码。

第三，当你浏览代码时，做大量的笔记。写下所有困扰你的关于代码的事情。把你的想法写在纸上。您可以在第一个月之后组织它。

第四，安装代码分析器（例如 xdebug）。这将告诉您在每个页面上调用了哪些文件和函数，以及每段代码运行多长时间。您可以使用它来找出包含问题，并找到缓慢的代码。先优化那些。

经过一个月的辛勤工作，筛选代码并做笔记，将您的笔记变成适当的文档。不同的部分可以从安全、缓存、架构到其他任何困扰你的东西。对于你提出的每一个批评，提供一个更好的解决方案，并估计修复需要多长时间。这是您摆脱所有竞争性 javascript 框架等的地方。

**尽可能多地修改本文档。** 我怎么强调都不过分。

确保您的听众可以告诉您这样做是为了公司的利益，而不仅仅是您的个人喜好。

亲自将其呈现给您的老板。约个时间讨论一下。

他们可能会因为你写了它而解雇你。如果他们这样做了，没有他们你会过得更好，因为他们不想进步，你的职业生涯就会停滞不前。

他们可能想要实施您的所有建议。这不太可能，但有可能。然后你会很高兴（除非你的建议失败）。

他们很可能会想要实施您的一些建议，这总比没有好。至少，这将有助于缓解您的担忧。

至于测试，请在 Apache 中设置另一个“虚拟主机”（Windows 和 Linux 都支持）。虚拟主机允许您在单个服务器上运行多个站点。大多数大型站点至少有 3 个虚拟主机（或实际服务器）：dev.domain.com（用于日常开发）、staging.domain.com（供 QA 人员在发布前进行测试）和 www.domain。 com（您的生产服务器）。您还应该使用不同的登录名和密码设置数据库的开发、暂存和生产版本，以免意外混淆它们。

另一种解决方案是在 Linux 服务器上为每个开发人员提供自己的虚拟主机，他们可以通过 FTP/SCP 或使用 samba 的网络共享工作。

祝你好运！

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2010-12-02T07:54:46.387

1.  开始在项目中使用版本控制（我推荐 git）
2.  为所有代码编写单元测试
3.  开始使用 ORM（我强烈推荐学说）
4.  开始使用一些框架（我推荐 symfony/nette）
5.  开始重构 php 代码

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-12-09T19:29:07.660

照哈珀谢尔比所说的去做...

但是，我还要补充一点，如果您没有得到管理层的支持来清理它，您可能希望接受这样一个事实，即这可能是有原因的。... 只是在说。;-)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-12-09T18:58:24.040

尝试在网站上获取详细的统计数据，并找出入口和出口点的位置。一种很好的方式来找出哪些文件被击中（然后查看这些文件以查看哪些包含被拉出）。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-12-11T02:35:54.863

除了其他人所说的很棒的东西之外，为了首先了解正在使用的文件，您可以在您的开发服务器（甚至是生产服务器，这不会破坏）上安装操作码缓存，如 APC 或 eaccelerator任何事物）。然后，在您的开发服务器上单击 Web 应用程序（或让用户在您的生产服务器上执行此操作）。

现在查看缓存管理页面中的缓存文件列表。如果文件没有被您的操作码缓存列为缓存，则很有可能它没有被任何东西加载。

这不是一个完整的解决方案，但如果每个目录有 10 个 index.php 文件（例如 index.php、index2.php 等），至少您会知道您的应用程序正在使用哪个文件。

# security - 存储库模式和分层。我在哪里应用安全性？

> ID：353799
> 
> 赞同：10
> 
> 时间：2008-12-09T18:49:30.237
> 
> 标签：security, repository-pattern, separation-of-concerns

我正在尽我所能设计我的 web 应用程序，并在层之间进行良好的分离。我正在使用存储库模式，因此有一个由我的 Web 前端调用的 ObjectService 调用的 SQLObjectRepository。

在我的对象模型中，用户与一个或多个区域相关联，这些区域应该过滤他们应该有权访问的对象。我的问题是，当我查询对象时，我是将代码放在服务中以设置对象的权限，还是该代码应该在存储库中？如果用户是 2 个区域的成员，我应该将用户作为参数传递给服务，还是应该将用户的区域传递给服务？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T21:56:47.643

我会：

*   以可以在您喜欢的任何地方应用的方式编写安全检查。通过这种方式，您可以随着需求的变化进行重构。

*   如果安全检查确实*总是*适用，请将其放置在存储库层（或者更好，如果您的语言支持它，则在一个方面），以便多个服务在使用相同存储库时共享共同的安全性。否则将其放在服务中（或作用于服务的方面）。

*   将整个用户对象传递给安全检查机制：

    *   如果以后安全检查变得更复杂（取决于用户的其他属性），API 不会改变；
    *   它更具语义意义 - 您正在检查用户是否有权做某事，而不是国家列表。

# c# - 在 ASP.NET 视图状态中存储对象数组是最好的解决方案吗？

> ID：353800
> 
> 赞同：2
> 
> 时间：2008-12-09T18:49:50.483
> 
> 标签：c#, asp.net

我想知道将数据存储在视图状态中对于这个给定的问题是否是一个好主意。他是我想要实现的一个简化示例，首先我们有一个中继器控件：

```
<asp:Repeater id="Repeater1" runat="server">
<ItemTemplate>
<asp:TextBox id="Name" runat="server" />
<asp:TextBox id="Age" runat="server" />
</ItemTemplate>
</asp:Repeater>
<asp:TextBox id="NewPersonName" runat="server" />
<asp:TextBox id="NewPersonAge" runat="server" />
<asp:Buttin id="Button1" runat="server" Text="Add" OnClick"Button1_Click"/> 
```

为了简单起见，我将放弃数据绑定代码，因为它正在工作，它会加载到当前的人员和年龄列表中并完美绑定。

问题在于底部的 3 个控件，我希望用户能够输入新条目，单击添加按钮，然后将其添加到中继器中，但不会保留到数据库中。

用户应该能够将多个名称添加到列表中，然后单击“保存”按钮以一次单击提交所有新名称，而不是为每个条目提交。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T18:58:50.047

您是在视图状态中保留数据库中的整个列表还是仅保留未提交的添加？

如果只是添加，那么这是对视图状态的很好使用。

如果数据库中的列表不是很大或不稳定，那么我想这也可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T18:59:26.613

我会使用 DataTable 对象并将其存储在用户的会话中。这样，您可以在每次添加/修改/删除时快速绑定数据，并且您可以在处理完成后简单地将其从会话中清除。此外，如果认为有必要，您可以在单独的页面上轻松访问用户列表。

编辑：另一个警告是，如有必要，您可以轻松地将 DataView 放在此之上，您需要对用户列表进行一些快速排序/过滤。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T19:01:52.333

我会使用 javascript 并将其存储在对象数组中。然后，客户端将引用 javascript 数组来构建 UI。

你可以看看一些 javascript 框架，如 yahoo yui、script.aculo.us、jQuery 等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T19:10:09.210

我会以两种方式之一来处理这个问题。第一个是 JS 数组，并在客户端添加到转发器/查看机制。

另一种选择是在我的数据库中有一个表，我在其中存储这些未提交的添加，然后将它们查询出来。

事实上，我可能会将两者结合起来。在我为显示构建新节点时，使用 AJAX 将数据异步发送到未提交的列表表。

在 SAVE/COMMIT 按钮上，我会将提交命令异步发送到服务器，这会将用户的项目从未提交的表移动到已提交的表。

# php - 在 PHP 脚本完成时重定向到指定的 URL？

> ID：353803
> 
> 赞同：40
> 
> 时间：2008-12-09T18:50:46.317
> 
> 标签：php, url

如何让 PHP 函数在运行完成后转到特定网站？

例如：

```
<?php
  //SOMETHING DONE
  GOTO(http://example.com/thankyou.php);
?> 
```

我真的很想要以下...

```
<?php
  //SOMETHING DONE
  GOTO($url);
?> 
```

我想做这样的事情：

```
<?php
  //SOMETHING DONE THAT SETS $url
  header('Location: $url');  
?> 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-12-09T19:05:23.840

```
<?
ob_start(); // ensures anything dumped out will be caught

// do stuff here
$url = 'http://example.com/thankyou.php'; // this can be set based on whatever

// clear out the output buffer
while (ob_get_status()) 
{
    ob_end_clean();
}

// no redirect
header( "Location: $url" );
?> 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-12-10T04:44:54.777

您总是可以只使用标签来刷新页面 - 或者只是将必要的 javascript 放入页面末尾，这会导致页面重定向。您甚至可以将其放入 onload 函数中，因此一旦完成，页面就会被重定向

```
<?php

  echo $htmlHeader;
  while($stuff){
    echo $stuff;
  }
  echo "<script>window.location = 'http://www.yourdomain.com'</script>";
?> 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-09T19:02:41.207

如果“SOMETHING DONE”不涉及通过 echo/print/etc 的任何输出，则：

```
<?php
   // SOMETHING DONE

   header('Location: http://stackoverflow.com');
?> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-09T19:40:22.130

请注意，这不起作用：

```
header('Location: $url'); 
```

您需要这样做（用于变量扩展）：

```
header("Location: $url"); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-06-11T14:22:17.483

不要忘记在调用后放置一个“死”，以在页面上的其余代码运行之前进行重定向。一种。如果您在页面下方有标题功能，它们将覆盖代码上方的标题功能。

b：我假设您不希望页面上的其余代码运行，这就是为什么您首先放置此重定向的原因 [也许]。

例子：

```
<?php

// do something here

header("Location: http://example.com/thankyou.php");
die();

//code down here now wont get run

?> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-09T19:03:03.733

```
<?php

// do something here

header("Location: http://example.com/thankyou.php");
?> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-21T09:43:07.977

这是“标头已发送”问题的解决方案。假设您正在验证并通过电子邮件发送表单。确保 php 代码是您页面上的第一件事……在任何 doctype 和 head 标签以及所有爵士乐之前。然后，当 POST 回到页面时，php 代码将首先出现，并且不会遇到已发送标头的问题。

# sql - 冲突的 CASCADE 和 RESTRICT 外键要求？

> ID：353804
> 
> 赞同：2
> 
> 时间：2008-12-09T18:51:01.480
> 
> 标签：sql, database, database-design, firebird

我正在开发一个跟踪项目中文件和依赖项的数据库。简而言之，我有两个主表；PROJECTS 表列出项目名称和其他属性，FILES 表列出文件。每个文件条目都指向一个项目作为设置为 CASCADE 的外键，所以如果我从数据库中删除项目记录，所有文件记录也会消失。到现在为止还挺好。

现在我有一个额外的 DEPENDENCIES 表。依赖表中的每条记录都是两个文件，指定第一个文件依赖于第二个文件。同样，这些是外键，第一个设置为 CASCADE（因此，如果我删除一个文件条目，则该记录将被删除），但第二个设置为 RESTRICT（因此，如果有任何其他文件依赖，我不允许删除文件条目在上面）。再一次，一切似乎都很好。

不幸的是，我似乎不能再用一条 SQL 删除语句来删除项目了！删除尝试级联删除文件，但如果其中任何一个出现在 DEPENDENCIES 表中，则 RESTRICT 外键会阻止删除（即使依赖表中的该记录将被删除，因为另一列是 CASCADE）。我唯一的解决方法是计算删除文件的确切顺序，因此不会违反任何依赖记录约束，并在尝试删除项目之前一次删除文件记录。

有什么方法可以设置我的数据库模式，以便从项目表中删除单个 SQL 将正确地级联其他删除？我正在使用 Firebird 2.1，但我不知道这是否有什么不同 - 似乎应该有一种方法可以使这项工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T19:24:31.383

您无法通过级联外键控制删除顺序，但您可以设计一个触发器`PROJECTS`来删除`FILES`属于该项目的行并且也列为`DEPENDENCIES`依赖于其他`FILES`. 使其成为`BEFORE DELETE`触发器，因此它应该在级联效果之前执行。

像这样的东西：

```
CREATE TRIGGER Del_Child_Files FOR PROJECTS
BEFORE INSERT
AS BEGIN
  FOR SELECT F.FILE_ID FROM FILES F JOIN DEPENDENCIES D 
      ON F.FILE_ID = D.CHILD_ID
    WHERE F.PROJECT_ID = OLD.PROJECT_ID
    INTO :file_id
  DO
    DELETE FROM FILES WHERE FILE_ID = :file_id;
  DONE
END 
```

因此，当您删除项目时，这会删除项目中依赖于其他文件的所有“子”文件，并且这会级联删除行，`DEPENDENCIES`因此所有剩余文件都没有依赖关系。您对项目的删除现在可以级联删除这些文件。

我还没有对此进行测试，我的 Firebird 语法可能会生锈，但也许它会让你开始。

显然，请在您的数据副本上进行测试，而不是实时数据！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T19:11:08.587

系统是否支持延迟约束，其中约束检查可以推迟到提交点？

也许这只是甲骨文的事情。

# objective-c - 实现 WebView 数据库配额委托

> ID：353808
> 
> 赞同：3
> 
> 时间：2008-12-09T18:52:34.100
> 
> 标签：objective-c, cocoa, webkit

如何实现此方法（见下文）？我是 Objective-C 的新手，我只是没有做对。

来自： http: [//lists.apple.com/archives/Webkitsdk-dev/2008/Apr/msg00027.html](http://lists.apple.com/archives/Webkitsdk-dev/2008/Apr/msg00027.html)

> 默认情况下，数据库的配额为 0；在将任何数据库存储在磁盘上之前，必须增加此配额。
> 
> **WebKit 客户端应该实现 WebUIDelegate 方法`- webView:frame:exceededDatabaseQuotaForSecurityOrigin:database:`并在调用该方法时根据需要增加配额。**此方法在 WebUIDelegatePrivate.h 中定义。它在上一个发布周期中添加得太晚，无法使其成为非私有标头。提交一个关于将此调用移动到 WebUIDelegate.h 的错误是值得的，以便它成为官方 API 的一部分。

约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T21:21:04.283

在您定义为 WebView 的委托的任何类中，您需要实现该方法，如下所示：

```
- (void)webView:(WebView *)sender frame:(WebFrame *)frame exceededDatabaseQuotaForSecurityOrigin:(WebSecurityOrigin *)origin database:(NSString *)databaseIdentifier {
    unsigned long long newQuotaBytes = 10 * 1024 * 1024;
    [origin setQuota:newQuotaBytes];

    // origin also responds to -usage method to return current size for all databases in this origin
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T21:12:43.177

从讨论区获得了一些帮助：

WebKit 的 WebKitTools 中的公共 SVN 中似乎包含此方法的实现。（该类名为 UIDelegate）。 [http://trac.webkit.org/browser/trunk/WebKitTools/DumpRenderTree/mac/U](http://trac.webkit.org/browser/trunk/WebKitTools/DumpRenderTree/mac/U) ...

我假设你已经为你的 WebKit 视图创建了一个委托。在该委托类中，使用签名创建一个方法：

```
- (void)webView:(WebView *)sender frame:(WebFrame *)frame
exceededDatabaseQuotaForSecurityOrigin:(WebSecurityOrigin *)origin
database:(NSString *)databaseIdentifier; 
```

您可能可以使用 UIDelegate 实现的修改版本：

```
- (void)webView:(WebView *)sender frame:(WebFrame *)frame
exceededDatabaseQuotaForSecurityOrigin:(WebSecurityOrigin *)origin
database:(NSString *)databaseIdentifier
{
    static const unsigned long long defaultQuota = 5 * 1024 * 1024;
    [origin setQuota:defaultQuota];
} 
```

我没试过这个，所以YMMV。

乔恩

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T06:11:30.157

这是最终的答案。

我正在使用 MiniBrowser 示例应用程序。

在 MyDocument.m 我添加了这个函数：

```
- (void)webView:(WebView *)sender frame:(WebFrame *)frame exceededDatabaseQuotaForSecurityOrigin:(id)origin database:(NSString *)databaseIdentifier
{
    static const unsigned long long defaultQuota = 5 * 1024 * 1024;
    if ([origin respondsToSelector: @selector(setQuota:)]) {
        [origin setQuota: defaultQuota];
    } else { 
        NSLog(@"could not increase quota for %@", defaultQuota); 
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-23T16:34:12.367

这对我有用：[https](https://stackoverflow.com/a/8975014/146099) ://stackoverflow.com/a/8975014/146099 - 这与杰夫的回答略有不同。

# php - 自动 htaccess 登录 - 从一个登录访问多个受保护的目录

> ID：353815
> 
> 赞同：0
> 
> 时间：2008-12-09T18:54:39.790
> 
> 标签：php, .htaccess

我正在尝试制作一个允许用户访问多个 .htaccess 受保护页面（在 apache 服务器上）的 php 登录页面。因此，用户将在第 1 页的表单中输入密码，根据他们提供的登录名，他们将被发送到一个或另一个目录，但我希望登录自动发生在后续页面（仅在页面上需要登录1）。如果在引用页面上提供了正确的凭据，如何自动登录到 htaccess 页面？我不想在 url ?user=user&pass=pass 中附加凭据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T20:45:27.443

如果您使用多个 .htaccess 文件，请务必将 AuthName 设置为相同。这告诉浏览器应该为该“领域”提供相同的缓存 uid/密码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T19:51:38.550

如果其他页面位于同一目录或以下，如果您对所有文件/目录具有相同的 .htaccess-rules，大多数浏览器将继续为后续请求发送相同的凭据。

传递 ?user=user&pass=pass 的另一种替代方法是使用 POST 而不是 GET 来发送此请求（如果您从一个表单传递）。

# c++ - 每个类都应该有一个虚拟析构函数吗？

> ID：353817
> 
> 赞同：54
> 
> 时间：2008-12-09T18:56:10.270
> 
> 标签：c++, virtual-destructor

Java 和 C# 支持不能使用 `final`and`sealed`关键字作为基类的类的概念。然而，在 C++ 中，没有很好的方法来防止派生一个类，这让类的作者陷入两难境地，每个类都应该有一个虚拟析构函数吗？

* * *

**编辑：**由于 C++11 这不再是真的，你可以指定一个类是[`final`](http://en.cppreference.com/w/cpp/language/final).

* * *

一方面，给一个对象一个虚拟析构函数意味着它将有一个`vtable`，因此每个对象会消耗 4 个（或 64 位机器上的 8 个）额外字节`vptr`。

另一方面，如果后来有人从这个类派生并通过指向基类的指针删除派生类，则程序将是错误定义的（由于没有虚拟析构函数），坦率地说，为每个对象优化一个指针是荒谬的。

在具有虚拟析构函数的[抓手上（可以说）表明这种类型旨在以多态方式使用。](http://en.wikipedia.org/wiki/Gripping_hand)

有些人认为你需要一个明确的理由不使用虚拟析构函数（这是[这个问题](https://stackoverflow.com/questions/300986)的潜台词），而另一些人则说只有当你有理由相信你的类将派生自你时才应该使用它们，你是*什么*思考？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-12-09T19:06:36.300

每个抽象类都应该有一个，

*   受保护的析构函数，或者，
*   虚拟析构函数。

如果您有一个公共的非虚拟析构函数，那就不好了，因为它允许用户通过该指针删除派生对象。众所周知，这是未定义的行为。

对于抽象类，您已经需要对象中的虚拟表指针，因此使析构函数`virtual`（据我所知）在空间或运行时性能方面不会产生高成本。它的好处是派生类自动拥有它们的析构函数`virtual`（参见@Aconcagua 的评论）。当然，你也可以`protected virtual`为这种情况制作析构函数。

对于不打算通过指向它的指针删除的非抽象类，我认为没有充分的理由使用虚拟析构函数。它会浪费资源，但更重要的是它会给用户一个错误的提示。想想给`std::iterator`一个虚拟析构函数会有什么奇怪的意义。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-12-09T19:18:58.647

问题真的是，你想*强制执行*关于你的类应该如何使用的规则吗？为什么？如果一个类没有虚拟析构函数，那么任何使用该类的人都知道它不打算派生自该类，并且如果您尝试使用它会有哪些限制。这还不够好吗？

或者如果有人*敢做*你没有预料到的事情，你是否需要编译器抛出一个硬错误？

如果您打算让人们从中派生，请给该类一个虚拟析构函数。否则不要，并假设使用您的代码的任何人都足够聪明，可以正确使用您的代码。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-09T19:04:09.597

不！仅当通过基类指针删除派生类的对象时，才使用虚拟析构函数。如果您的类不打算在这种情况下用作基础，请不要将析构函数设为虚拟 - 您将发送错误消息。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-10T13:08:24.947

查看[Herb Sutter 的这篇文章](http://www.gotw.ca/publications/mill18.htm)：

准则 #4：基类析构函数应该是公共的和虚拟的，或者是受保护的和非虚拟的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-09T18:58:23.977

对于一般性问题，我会“不”。不是*每个*班级都需要一个。如果您知道永远不应该继承该类，那么就没有必要产生较小的开销。但是，如果有机会，请保持安全并在其中放一个。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-05-12T20:04:36.073

当基类至少包含一个纯虚函数时，它就变成了抽象类。如果 Base 没有虚拟析构函数而 Derived（从 Base 派生）有，那么您可以通过 Derived 对象指针而不是通过 Base 对象指针安全地销毁 Derived 对象。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-09T19:14:19.827

我要补充一点，当我在父类或子类中忘记了虚拟时，我曾一度为没有调用析构函数而挠头。我想我现在知道要找那个了。:)

有人可能会争辩说，有时父类在其析构函数中做了一些孩子不应该做的事情……但这可能表明你的继承结构有问题。

# silverlight - 从自定义属性绑定

> ID：353841
> 
> 赞同：0
> 
> 时间：2008-12-09T19:03:39.287
> 
> 标签：silverlight

我是论坛的新手，对silverlight 也很陌生。我和我的同事正在开发一个自定义应用程序。我们正在构建一个菜单系统，该系统仅在该用户处于指定角色时才显示按钮。创建了一个新属性以允许定义角色，出于测试目的，我们只是尝试将该值（一个字符串）分配给文本块的文本属性。附上一些代码。

这是要添加到集合中的项目之一。allowedroles 属性正在传递字符串，这可以通过调试器看到。

```
<MenuButton:VerticalButtonCollection x:Key="VerticalButtonsDS" d:IsDataSource="True">

<MenuButton:VerticalButton AllowedRoles="test, test2"> 
<TextBlock Text="{Binding AllowedRoles}"></TextBlock>

</MenuButton:VerticalButton>

</MenuButton:VerticalButtonCollection>

Code for the allowed roles property  
Public Shared ReadOnly AllowedRolesProperty As DependencyProperty = DependencyProperty.Register("AllowedRoles", GetType(String), GetType(mButton), New PropertyMetadata(New PropertyChangedCallback(AddressOf onAllowedRolesChanged)))

Public Shared Sub onAllowedRolesChanged(ByVal d As DependencyObject, ByVal args As DependencyPropertyChangedEventArgs) 
     Dim sender As mButton = CType(d, mButton)
     sender.AllowedRoles = CStr(args.NewValue)
End Sub 
```

项目显示在列表框中，没有错误，但绑定不起作用。我什至尝试在列表框的数据模板中进行绑定。如果这令人困惑，我深表歉意，我不知道如何以易于理解的方式发布这样的内容。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-09T22:46:11.570

当您使用绑定语法时，您将绑定到对象的 DataContext。所以你的绑定：

```
<MenuButton:VerticalButton AllowedRoles="test, test2"> 
  <TextBlock Text="{Binding AllowedRoles}"></TextBlock>
</MenuButton:VerticalButton> 
```

基本上是说让我在我的 DataContext 上获得属性“AllowedRoles”。由于数据上下文可能为空（没有看到它被设置），您在文本块中没有得到任何值。

您可能想要做的是为您的 MenuButton 定义一个模板，然后在模板中您可以说：

```
<TextBlock Text="{TemplateBinding AllowedRoles}"></TextBlock> 
```

当您将模板应用于项目时，将设置哪个。

以下是我在另一个线程中发布的关于理解模板和 generic.xaml 的一些链接：

*   控制定制
*   可换肤自定义控件
*   调整默认样式
*   generic.xaml 上的 3 个很好的链接

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T13:58:26.827

```
<MenuButton:VerticalButton AllowedRoles="test, test2"> 
```

上面的行是分配 allowedroles 值的地方。那时我正在创建一个按钮的新实例。

我试图将允许的角色绑定到文本块的地方可能是完全错误的，但即使它是在列表框的数据模板中完成的，它也不起作用。

```
<DataTemplate x:Key="VerticalMenuItemTemplate">
            <Canvas>
            <TextBlock Text="{Binding AllowedRoles}">
            </TextBlock>
            <Rectangle Height="500" Width="500" Fill="Blue"></Rectangle></Canvas>
        </DataTemplate> 
```

事实上，正如您从这个小片段中看到的那样，我有一个矩形设置和画布。我没有看到 rect，它仅用于测试目的，所以几乎就像我的模板被忽略了一样。我将列表框设置为如下

```
<ListBox x:Name="VerticalContainer" Width="81" Height="Auto" HorizontalAlignment="Center" DataContext="{Binding Mode=OneWay, Source={StaticResource VerticalButtonCollectionDS}}" Padding="0,0,0,0" Canvas.Top="-14" ItemTemplate="{StaticResource VerticalMenuItemTemplate}"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T20:56:45.860

这是我们正在尝试做的一个小例子。我可以获取“VerticalButton”的内容并很好地显示它，但是我们需要能够获取模板中的“AllowedRoles”依赖属性，因为最终目标是将项目的可见性绑定到该属性（之后创建一个 IValueConverter）。我们似乎无法理解如何从列表框的 ItemTemplate 获取 AllowedRoles 模板。

这是 Page.xaml：

```
<UserControl x:Class="AnnexAMapTool.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:mt="clr-namespace:AnnexAMapTool;assembly=AnnexAMapTool"
    Width="400" Height="300">
    <UserControl.Resources>

        <mt:VerticalButtonCollection x:Key="TestCollection">
            <mt:VerticalButton AllowedRoles="Test1, Test2" Content="VBContent"></mt:VerticalButton>
        </mt:VerticalButtonCollection>

        <Style x:Key="ListItemStyle" TargetType="ListBoxItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>
                        <StackPanel x:Name="Root" Orientation="Horizontal">
                            <TextBlock Foreground="Red" Text="{Binding AllowedRoles}"></TextBlock>
                            <Ellipse Width="20" Height="20" Fill="Blue"></Ellipse>
                            <ContentPresenter Content="{TemplateBinding Content}" Margin="5,5,5,5"/>
                        </StackPanel>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ListStyle" TargetType="ListBox">
            <Setter Property="ItemContainerStyle" Value="{StaticResource ListItemStyle}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBox">
                        <Grid x:Name="Root">
                            <ItemsPresenter></ItemsPresenter>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>
    <Grid x:Name="LayoutRoot" Background="White">
        <ListBox Style="{StaticResource ListStyle}" ItemsSource="{StaticResource TestCollection}" />
    </Grid>
</UserControl> 
```

这是类代码。非常基本.. 派生自 ButtonBase 并定义了一个 DP。还要注意底部的集合类。

```
Imports System.Windows.Controls.Primitives
Imports System.Collections.ObjectModel

Public Class VerticalButton
    Inherits ButtonBase

    Public Property AllowedRoles() As String
        Get
            Return GetValue(AllowedRolesProperty)
        End Get
        Set(ByVal value As String)
            SetValue(AllowedRolesProperty, value)
        End Set
    End Property

    Public Shared ReadOnly AllowedRolesProperty As DependencyProperty = DependencyProperty.Register("AllowedRoles", GetType(String), GetType(VerticalButton), New PropertyMetadata(New PropertyChangedCallback(AddressOf OnAllowedRolesChanged)))

    Public Shared Sub OnAllowedRolesChanged(ByVal d As DependencyObject, ByVal args As DependencyPropertyChangedEventArgs)
        Dim sender As VerticalButton = CType(d, VerticalButton)
        sender.AllowedRoles = CStr(args.NewValue)
    End Sub

End Class

Public Class VerticalButtonCollection
    Inherits ObservableCollection(Of VerticalButton)

End Class 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T15:12:15.310

最终通过执行以下操作来完成这项工作。技巧之一是您不能在模板绑定上使用转换器，因此您可以使用模板绑定绑定对象的 DataContext，然后使用常规绑定来访问它。

```
<UserControl.Resources>
    <mt:AllowedRolesConverter x:Key="RolesConverter"></mt:AllowedRolesConverter>

    <Style x:Key="VerticalButton1Style" TargetType="mt:VerticalButton">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="mt:VerticalButton">
                    <Grid x:Name="RootGrid" DataContext="{TemplateBinding AllowedRoles}" Visibility="{Binding Converter={StaticResource RolesConverter}}">

                        <Border x:Name="border" BorderThickness="1">
                            <Border.BorderBrush>
                                <SolidColorBrush x:Name="borderBrush" Opacity="0" Color="Blue"/>
                            </Border.BorderBrush>
                            <ContentPresenter x:Name="VBContent"
                                              ContentTemplate="{TemplateBinding ContentTemplate}" 
                                              >

                            </ContentPresenter>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <mt:VerticalButtonCollection x:Key="TestCollection">
        <mt:VerticalButton AllowedRoles="Test1" 
                           Style="{StaticResource VerticalButton1Style}" 
                           Click="VerticalButton_Click"
                           >
            <TextBlock Text="Test Button"></TextBlock>
        </mt:VerticalButton>
        <mt:VerticalButton AllowedRoles="Test1" 
                           Style="{StaticResource VerticalButton1Style}" Click="VerticalButton_Click_1">
            <Ellipse Width="50" Height="50" Fill="Blue"></Ellipse>
        </mt:VerticalButton>
    </mt:VerticalButtonCollection>

    <Style x:Key="ListItemStyle" TargetType="ListBoxItem">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <StackPanel x:Name="Root" Orientation="Horizontal">
                        <ContentPresenter Margin="5,5,5,5"/>
                    </StackPanel>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="ListStyle" TargetType="ListBox">
        <Setter Property="ItemContainerStyle" Value="{StaticResource ListItemStyle}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListBox">
                    <Grid x:Name="Root">
                        <ItemsPresenter></ItemsPresenter>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</UserControl.Resources>
<Grid x:Name="LayoutRoot" Background="White">
    <ListBox Style="{StaticResource ListStyle}" ItemsSource="{StaticResource TestCollection}" />
</Grid>

    Public Class VerticalButton
    Inherits Button
    Implements INotifyPropertyChanged

    Public Property AllowedRoles() As String
        Get
            Return CStr(GetValue(AllowedRolesProperty))
        End Get
        Set(ByVal value As String)
            SetValue(AllowedRolesProperty, value)
        End Set
    End Property

    Public Shared ReadOnly AllowedRolesProperty As DependencyProperty = DependencyProperty.Register("AllowedRoles", GetType(String), GetType(VerticalButton), New PropertyMetadata(New PropertyChangedCallback(AddressOf OnAllowedRolesChanged)))

    Public Shared Sub OnAllowedRolesChanged(ByVal d As DependencyObject, ByVal args As DependencyPropertyChangedEventArgs)
        Dim sender As VerticalButton = CType(d, VerticalButton)
        sender.AllowedRoles = CStr(args.NewValue)
    End Sub

    Public Event PropertyChanged(ByVal sender As Object, ByVal e As System.ComponentModel.PropertyChangedEventArgs) Implements System.ComponentModel.INotifyPropertyChanged.PropertyChanged
End Class

Public Class VerticalButtonCollection
    Inherits ObservableCollection(Of VerticalButton)

End Class 
```

# c# - 用于在 C# 中附加集合的 StringBuilder 扩展方法

> ID：353842
> 
> 赞同：6
> 
> 时间：2008-12-09T19:03:54.153
> 
> 标签：c#, generics, lambda, stringbuilder

在 C# 中，我正在尝试为 StringBuilder 构建一个名为 AppendCollection() 的扩展方法，它可以让我这样做：

```
var sb1 = new StringBuilder();
var sb2 = new StringBuilder();
var people = new List<Person>() { ...init people here... };
var orders = new List<Orders>() { ...init orders here... };

sb1.AppendCollection(people, p => p.ToString());
sb2.AppendCollection(orders, o => o.ToString());

string stringPeople = sb1.ToString();
string stringOrders = sb2.ToString(); 
```

stringPeople 最终会为列表中的每个人加上一行。每一行都是 p.ToString() 的结果。对于 stringOrders 也是如此。我不太确定如何编写代码以使 lambda 与泛型一起使用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-09T19:08:26.407

使用`Func<T,string>`委托。

```
public static void AppendCollection<T>(this StringBuilder sb, 
                                       IEnumerable<T> collection, Func<T, string> method) {
   foreach(T x in collection) 
       sb.AppendLine(method(x));
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-09T19:14:29.827

```
 public static void AppendCollection<T>(this StringBuilder builder, IEnumerable<T> list, Func<T,string> func)
        {
            foreach (var item in list)
            {
                builder.AppendLine(func(item));
            }
        } 
```

我不会返回一个字符串，我只会将它附加到传入的原始 Stringbuilder 中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-09T19:09:03.987

我不确定你是否需要那么努力：

```
 public static void AppendCollection( this StringBuilder builder,
                                      ICollection collection )
 {
     foreach (var item in collection)
     {
        builder.AppendLine( Convert.ToString( item ) );
     }
 } 
```

用作

```
 List<Person> people = ...

 StringBuilder builder = new StringBuilder();
 builder.AppendCollection( people );
 var s = builder.ToString(); 
```

当然，Person 需要重写 ToString() 来为 Person 对象生成正确的输出。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-09T19:09:40.040

就像是：

```
 public static void AppendCollection<TItem>(this StringBuilder builder, IEnumerable<TItem> items, Func<TItem, string> valueSelector)
  {
       foreach(TItem item in items)
       {  
            builder.Append(valueSelector(item));
       }
  } 
```

我会添加一个有用的默认值，以在 90% 的情况下保存指定 lambda...

```
 public static void AppendCollection<TItem>(this StringBuilder builder, IEnumerable<TItem> items)
  {
      AppendCollection(builder, items, x=>x.ToString());
   } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-09T19:29:09.970

我的版本：

```
 public static string AppendCollection<T>(this StringBuilder sb, IEnumerable<T> enumerable, Func<T, string> method)
    {
        List<T> l = new List<T>(enumerable);
        l.ForEach(item => sb.AppendLine(method(item)));
        return sb.ToString();
    } 
```

但在这种情况下你不应该返回一个字符串。我更喜欢以下内容：

```
 public static void AppendCollection<T>(this StringBuilder sb, IEnumerable<T> enumerable, Func<T, string> method)
    {
        List<T> l = new List<T>(enumerable);
        l.ForEach(item => sb.AppendLine(method(item)));
    } 
```

像这样使用：

```
 sb.AppendCollection(people, p => p.ToString());
        sb.AppendCollection(orders, o => o.ToString());
        Console.WriteLine(sb.ToString()); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-09T19:07:45.113

这个方法应该返回什么？我可以看到一个字符串，但是如果您要附加到 StringBuilder，为什么？

您尝试做的事情相当简单，但您需要准确地解释您想要什么。

**更新：**

这是我的看法。如果您只是要传入一个新的 StringBuilder 并返回一个字符串，那么为此使用扩展方法是愚蠢且毫无意义的。

**更新 2：**

既然我看到了这种用法，那么您所做的就是不好的做法。理想情况下，您应该做的是：

```
public static string Print<T>(this IEnumerable<T> col, Func<T,string> printer)
{
  var sb = new StringBuilder();
  foreach (T t in col)
  {
    sb.AppendLine(printer(t));
  }
  return sb.ToString();
}

string[] col = { "Foo" , "Bar" };
string lines = col.Print( s => s); 
```

**更新 3：**

进一步澄清后：

```
public static void AppendCollection<T>(this StringBuilder sb, 
   List<T> col, Func<T,string> printer)
{
  col.ForEach( o => sb.AppendLine(printer(o)));
} 
```

（这与布鲁诺康德所说的相同）

现在你真的不再需要它了:)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-09T19:11:54.590

```
static class SBExtention
{
  static string AppendCollection<T>(this StringBuilder sb, 
                                    IEnumerable<T> coll, 
                                    Func<T,string> action)
  {
       foreach(T t in coll)
       {
          sb.Append(action(t));
          sb.Append("\n");
       }
       return sb.ToString();

  }
} 
```

但是，我认为让它返回 StringBuilder 会更好。这样你就可以链接它：

```
 static StringBuilder AppendCollection<T>(this StringBuilder sb, 
                                    IEnumerable<T> coll, 
                                    Func<T,string> action)
  {
       // same
       return sb;

  } 
```

字符串 peopleAndOrders = sb.AppendCollection(people, p => p.ToString()) .AppendCollection(orders, o => o.ToString()).ToString();

我同意 Jennifer 关于默认情况的观点：

```
 public static StringBuilder AppendCollection<TItem>(
                  this StringBuilder builder, 
                  IEnumerable<TItem> items)
  {
      return AppendCollection(builder, items, x=>x.ToString());
   } 
```

字符串 peopleAndOrders = sb.AppendCollection(people).AppendCollection(orders).ToString();

# xml - 通过 XML 中的多个属性查找

> ID：353843
> 
> 赞同：8
> 
> 时间：2008-12-09T19:04:07.570
> 
> 标签：xml, search, xml-attribute

我正在尝试在 XML 中搜索多个属性：

```
<APIS>
  <API Key="00001">
    <field Username="username1" UserPassword="password1" FileName="Filename1.xml"/>
    <field Username="username2" UserPassword="password2" FileName="Filename2.xml"/>
    <field Username="username3" UserPassword="password3" FileName="Filename3.xml"/>
  </API>
</APIS> 
```

我需要检查“字段”中的用户名和用户密码值是否都是我正在与我的数据集值进行比较的值，有没有一种方法可以检查多个属性（和条件）而无需编写我自己的使用标志和破坏的逻辑出循环。

是否有 XMLDoc 的内置功能可以做到这一点？任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-09T19:32:04.860

要在您提供的 XML 片段中搜索您想要的内容，您需要以下 XPath 表达式：

```
/APIS/API/field[@Username='username1' and @UserPassword='password1'] 
```

如果用户名和密码匹配，这将返回一些东西 - 如果不匹配，则不返回。

当然，XPath 表达式只是一个字符串 - 例如，您可以使用输入到表单字段中的值动态构建它。

如果您说出您所处的语言/环境，那么此处发布的代码示例可能会更加具体。

这是在 C# 中执行此操作的一种方法（VB.NET 类似）：

```
// make sure the following line is included in your class
using System.Xml;

XmlDocument xmldoc = new XmlDocument();
xmldoc.Load("your XML string or file");

string xpath = "/APIS/API/field[@Username='{0}' and @UserPassword='{1}']";
string username = "username1";
string password = "password1";

xpath = String.Format(xpath, username, password);
XmlNode userNode = xmldoc.SelectSingleNode(xpath);

if (userNode != null)
{
  // found something with given user name and password
}
else
{
  // username or password incorrect
} 
```

请注意，用户名和密码都不能包含单引号，否则上面的示例将失败。这是[有关此特性的一些信息](http://kushalm.com/the-perils-of-xpath-expressions-specifically-escaping-quotes)。

Microsoft 还提供了一个 How-To：[如何：使用 System.Xml.XmlDocument 类在 Visual C# .NET 中执行 XPath 查询](http://support.microsoft.com/kb/318499)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T19:16:36.187

搜索 XML 是[XPath](http://www.w3.org/TR/xpath)的用途。您没有指定您使用的是什么语言，但[这里有一篇](http://www.ibm.com/developerworks/xml/library/x-domjava/)关于在 Java 中使用 XPath 处理 XML 的文章，还有[一篇](http://support.microsoft.com/kb/308333)使用 C# 的文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T02:37:32.537

**这是关于[XPath](http://www.w3.org/TR/xpath)表达式**的常见问题解答。

一个或多个 XPath 表达式（其评估类型为布尔值）可以使用[**布尔运算符**](http://www.w3.org/TR/xpath#booleans)“and”和“or”以及使用 XPath 函数[**not()**](http://www.w3.org/TR/xpath#function-not)连接在一起。

**请注意，这些名称都是小写的**。XPath 区分大小写，并且这些名称的任何其他大写形式（例如“AND”）都不会被识别为逻辑运算符的名称。

因此，在这种特殊情况下，所需的 XPath 表达式将如下所示：

**`/*/*/field[@Username = your-ds-username and @UserPassword = your-ds-UserPassword]`**

where`your-ds-username`和 `your-ds-UserPassword`应该用您要从数据集中使用的相应值替换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-04T12:23:33.653

要在 XML 标签的情况下搜索多个属性，我们可以使用以下 XPATH /APIS/API/field[@Username='username1'][@UserPassword='password1']

# .net-3.5 - Microsoft.CompactFramework.VisualBasic.targets 文件来自哪里？

> ID：353879
> 
> 赞同：16
> 
> 时间：2008-12-09T19:15:35.363
> 
> 标签：.net-3.5, compact-framework

我有一个 Pocket PC 2003 解决方案，由三个项目组成，它是在 Visual Studio 2005 中创建的。我在 Visual Studio 2008 中打开该解决方案，其中两个项目由于以下错误而无法转换：

无法读取项目文件“PDA.vbproj”。D:\PDA.vbproj(121,61)：未找到导入的项目“C:\WINDOWS\Microsoft.NET\Framework\v3.5\Microsoft.CompactFramework.VisualBasic.targets”。确认声明中的路径正确，并且该文件存在于磁盘上。

此文件存在于 v2.0.50727 目录下

C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Microsoft.CompactFramework.VisualBasic.targets

但不在 v3.5 目录中。我查看了另一台开发计算机，文件在那里。我重新安装了 .NET Framework 和 Compact Framework 的 v3.5，但这并没有恢复文件。它从何而来？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2015-07-28T06:42:14.253

> 未找到 Microsoft.CompactFramework.CSharp.targets...

在安装新的 Windows 10 版本后或从 Windows 8 升级到 Windows 8.1 后尝试将智能设备项目加载到 Visual Studio 时，您可能会遇到类似上述错误消息。此错误是由于在安装新版本时删除了以下文件。

*   Microsoft.CompactFramework.Common.targets

*   Microsoft.CompactFramework.CSharp.targets

*   Microsoft.CompactFramework.VisualBasic.targets

要解决此问题，只需安装适用于 .NET Compact Framework 的 Power Toys，它将这些丢失的文件放回它们所属的位置。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-09T19:18:47.697

它是 MSBuild 目标文件之一，将与 Visual Studio 一起安装。

[http://msdn.microsoft.com/en-us/library/ms164312.aspx](http://msdn.microsoft.com/en-us/library/ms164312.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-03T14:13:27.790

对于在 framework 2.0 文件夹中搜索它的项目，您应该复制这四个文件：

1.  Microsoft.CompactFramework.VisualBasic.targets，
2.  Microsoft.CompactFramework.CSharp.targets，
3.  Microsoft.CompactFramework.Common.targets，
4.  Microsoft.CompactFramework.Build.Tasks.dll

从 framework 3.5 文件夹到 framework 2.0，在我的电脑中：从**C:\Windows\Microsoft.NET\Framework\v3.5**到**C:\Windows\Microsoft.NET\Framework\v2.0.50727**

它对我有用

# authentication - OpenID 身份验证如何工作？

> ID：353880
> 
> 赞同：99
> 
> 时间：2008-12-09T19:16:31.837
> 
> 标签：authentication, openid

我有点想知道 OpenID 身份验证的工作原理。

OpenID 身份验证与站点专用于自己的身份验证之间有什么区别吗？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2008-12-09T19:19:42.810

## 什么是 OpenID？

> OpenID 是一个开放的、**分散**的、**免费**的以用户为中心的数字身份框架。OpenID 利用现有的互联网技术（URI、HTTP、SSL、Diffie-Hellman）并意识到人们已经在为自己创建身份，无论是在他们的博客、照片流、个人资料页面等。使用 OpenID，您可以轻松地转换一个将这些现有 URI 合并到一个帐户中，该帐户可在支持 OpenID 登录的站点上使用。

[开放ID](http://openid.net/what/)

## OpenID和常规认证形式的区别？

不同之处在于标识将分散到外部站点（例如 Wordpress、Yahoo、...）。网站会知道识别是否OK，让你登录。传统的网站身份验证会与私人数据库中保存的数据进行比较，因此您的用户名和密码只能用于登录本网站。使用 OpenID，您可以在多个网站上使用相同的凭据。

## 这个怎么运作？

*   [您可以在此处查看操作流程（图片）](http://openid.net/pres/protocolflow-1.1.png)
*   [一步一步的活动在这里](http://www.windley.com/archives/2006/04/how_does_openid.shtml)
*   [此处的分步活动（其他博客）](http://tinisles.blogspot.com/2008/02/how-does-openid-work.html)

# 脚步

1.  用户连接到启用 OpenID 的网站。
2.  用户输入凭证信息。
3.  使用 BASE64 进行 POST（网站到提供商）
4.  构建了一个答案（包含过期）
5.  该网站将用户重定向到提供商以登录。
6.  用户输入密码并提交。
7.  验证完成。
8.  登录！

# asp.net - 验证 RadioButtonGroup 客户端

> ID：353882
> 
> 赞同：1
> 
> 时间：2008-12-09T19:16:38.387
> 
> 标签：asp.net, javascript

```
<asp:RadioButton GroupName="EndorsementType" runat="server" ID="rdoAddProperty" Text="Add Property to TIV" />
<asp:RadioButton GroupName="EndorsementType" runat="server" ID="rdoRemoveProperty" Text="Remove Property from TIV" />
<asp:RadioButton GroupName="EndorsementType" runat="server" ID="rdoChangeProperty" Text="Change Property Values" /> 
```

我正在考虑实现自定义`validator`，并使用客户端`JavaScript`函数来引用 RadioButton ID，（我使用的是 Web 表单，而不是 mvc），

```
something like.. 
 if(document.getElementById(<%= rdoAddProperty.ClientId %>).checked == true) && ... 
```

任何人都知道不知道clientId的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T19:25:27.777

如果您的收音机包含在 DIV 之类的东西中，并且因为您的 asp:RadioButtons 将呈现为 HTML 输入，您可以执行以下操作：

```
<script type="text/javascript" language="javascript">
    function Validate()
    {
        var l_elemsRadios = document.getElementById("MyRadios").getElementsByTagName("input");

        if (l_elemsRadios == null)
            return;

        for (var i = 0; i < l_elemsRadios; i++)
        {
            // validate l_elemsRadios[i] through l_elemsRadios[n]
        }
    }
</script>

<div id="MyRadios">
    <input type="radio" name="EndorsementType" value="Remove Property from TIV" >Remove Property from TIV
    .
    .
    .
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T19:22:08.003

您必须将您的客户端 ID 放到表单中，与 INamingContainer 一样，您的 ID 可以相对于存储在服务器上的其他信息进行更改。

# c# - C# sln 中的 csproj.user 文件

> ID：353898
> 
> 赞同：6
> 
> 时间：2008-12-09T19:21:18.457
> 
> 标签：c#, .net, csproj-user

由于我公司的网络应用了补丁，我的机器自动重启了，我看到的最后一个错误报告了 csproj.user 文件的内容。现在每次我尝试启动我的解决方案时，它都会打开，然后显示对话框以将报告发送给 MS。如果我在事件查看器中查看错误日志，它会显示这个

EventType clr20r3、P1 devenv.exe、P2 8.0.50727.762、P3 45716759、P4 系统、P5 2.0.0.0、P6 4889de7a、P7 5a2、P8 0、P9 system.io.filenotfoundexception、P10 NIL。

EventType clr20r3、P1 devenv.exe、P2 8.0.50727.762、P3 45716759、P4 系统、P5 2.0.0.0、P6 4889de7a、P7 5a2、P8 0、P9 system.io.filenotfoundexception、P10 NIL。

.NET 运行时版本 2.0.50727.3053 - 致命的执行引擎错误 (7A2E0F92) (0)

有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-09T19:37:19.780

我相信 .user 文件只有您的个人 IDE 设置，因此当您重新打开 VS 时可以恢复它们。显然，您的 .user 文件已损坏。删除它应该不会有任何伤害，除非您会丢失 IDE 中的任何个人设置并不得不重做它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T19:23:27.373

删除 .user 文件。它应该被重新创建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T01:56:06.740

这就是我所做的，其中之一帮助了我：

1.  将系统恢复到最后一个已知的好点。

2.  打开 csproj 文件而不是 sln 文件，一切都很顺利。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T19:59:13.387

嗯，有些文件被删除了。我希望它是您项目的一部分，而不是 .net 框架文件。尝试重新创建您的项目和解决方案并将您的文件复制回其中。

希望当您创建新的解决方案或项目时不会发生这种情况。如果是，您可能需要重新安装 Visual Studio。

# c# - .NET 通用集？

> ID：353901
> 
> 赞同：11
> 
> 时间：2008-12-09T19:21:36.303
> 
> 标签：c#, .net, generics, collections, set

.NET 中是否有实现“设置”行为的通用容器？

我知道我可以只使用 a `Dictionary<T, Object>`（并且可能添加`nulls`为值），因为它的键充当一个集合，但我很好奇是否有现成的东西。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-09T19:27:24.700

`HashSet<T>`在 .NET 3.5 中

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T19:31:01.620

我使用 Iesi.Collections。NHibernate 附带的命名空间（[此处](http://monogis.org/monogis_doc/html/Iesi.Collections.html)的文档） - 如果您在 .NET < 3.5 中，可能值得考虑

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-02T16:06:54.867

在 .NET 3.5 中引入：（ [`HashSet<T>`](http://msdn.microsoft.com/en-us/library/bb359438%28v=vs.90%29.aspx)见下文）。

在 .NET 4.0 中引入[`ISet<T>`](http://msdn.microsoft.com/en-us/library/dd412081.aspx)：

> 为集合的抽象提供基本接口。该接口提供了实现集合的方法，集合是具有独特元素和特定操作的集合。

该接口在 .NET 4+ BCL 中有两个实现：

*   [`HashSet<T>`](http://msdn.microsoft.com/en-us/library/bb359438.aspx)：

    > ...提供高性能的集合操作。集合是不包含重复元素且其元素没有特定顺序的集合

*   [`SortedSet<T>`](http://msdn.microsoft.com/en-us/library/dd412070.aspx)：

    > 表示按排序顺序维护的对象集合。SortedSet(Of T) 在插入和删除元素时保持排序顺序，而不会影响性能。不允许重复元素。

FWIW：命名空间下还有一个。 它的唯一目的似乎是在.**`internal`** `class TreeSet<T>: SortedSet<T>``System.Collections.Generic`
[`SortedDictionary<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)

# language-agnostic - 函数式编程：状态与重新分配

> ID：353912
> 
> 赞同：13
> 
> 时间：2008-12-09T19:24:24.783
> 
> 标签：language-agnostic, oop, functional-programming, comparison, immutability

我需要帮助来了解我当前的 OOP 状态概念与使用 Haskell 或 Clojure 等函数式语言的方式之间的差异。

举一个陈腐的例子，假设我们正在处理简化的银行账户对象/结构/任何东西。在 OOP 语言中，我将有一些类持有对 BankAccount 的引用，该类将具有用于利率之类的实例变量，以及诸如 setInterestRate() 之类的方法，它们会更改对象的状态并且通常不返回任何内容。比如说 Clojure，我有一个银行账户结构（一个美化的哈希图），以及接受银行账户参数和其他信息并返回一个新结构的特殊函数。因此，我现在没有更改原始对象的状态，而是返回了一个带有所需修改的新对象。

那么......我该怎么办？覆盖引用旧银行帐户的任何变量？如果是这样，这是否比改变状态的 OOP 方法具有优势？最后，在这两种情况下，似乎都有一个变量引用了具有必要更改的对象。尽管我很迟钝，但我对正在发生的事情只有一个模糊的概念。

我希望这是有道理的，感谢您的帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-09T20:10:23.600

在纯函数式风格中，您永远不会覆盖任何变量。

一个类比是物理学中的时空。如果您将世界视为 3d，那么对象没有固定的位置 - 它们会随着时间移动。为了将数学应用于物理世界，我们因此添加了时间维度并考虑特定时间各种属性的值。在这样做的过程中，我们已经将我们研究的对象变成了常量。类似地，在编程中，使用不可变值可以简化概念。现实世界中具有身份的对象可以建模为一系列不可变值（对象在递增时间的状态），而不是一个变化的值。

当然，如何将值序列与“对象标识”相关联的细节可能有点麻烦。Haskell 有[Monads](http://en.wikipedia.org/wiki/Monad_(functional_programming))可以让你模拟状态。 [函数式反应式编程](http://en.wikipedia.org/wiki/Functional_reactive_programming)是一种更直接的尝试，它通过纯函数更新来建模世界上的对象，我认为这是一个非常有前途的编程方向。

我会注意到，与 Haskell 不同，Clojure 不是纯粹的，您可以按照您的建议更新变量。如果您只是在高层次上更新几个变量，您可能仍然会享受函数式编程的许多概念上的简单性好处。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-10T03:57:40.393

大概在 OO 世界中，您有一个循环，并且为了响应请求而一遍又一遍地修改这些银行帐户。假设您有一个完整的账户组合，并且这些账户的类型为 Portfolio。然后在 Haskell 中你会写一个纯函数

```
updatePortfolio :: Request -> Portfolio -> Portfolio 
```

您的主循环可能会从标准输入读取请求并保持您的投资组合是最新的。（除非您也可以编写投资组合，否则该示例没有多大用处，但它更简单。）

```
readRequest :: IO Request  -- an action that, when performed, reads a Request with side effects

main :: Portfolio -> IO ()  -- a completely useless program that updates a Portfolio in response to a stream of Requests

main portfolio = do req <- readRequest
                    main (updatePortfolio req) 
```

现在我希望你看看你的可变状态发生了什么：在一个典型的函数式程序中，变化的状态作为参数传递给一个函数。当状态改变时，你会调用一个新的函数。该调用位于尾部位置（您可以查找“正确的尾部调用”），因此它不使用任何额外的资源，事实上，当编译器生成汇编代码时，它会生成一个循环，它会保留指向寄存器中不断变化的投资组合。

这是一个非常玩具的例子，但我希望它能给你一点函数式语言的味道。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-09T19:58:18.960

*那么......我该怎么办？覆盖引用旧银行帐户的任何变量？*

是的

*如果是这样，这是否比改变状态的 OOP 方法具有优势？*

假设您在该结构上执行的任何操作的计算需要很长时间，并且中途发生了一些事情，您需要恢复到原始结构或计算引发错误。根据您向我提供的对 OO 的解释（使用参考，因为您可以拥有不可变的 OO 语言），数据可能已损坏——除非从失败的函数调用中提供足够的信息，否则它是未知的，并建议它失败很糟糕。在函数式方法中，您可以确定您的原始数据结构是正确的——因为您最初制作了一个副本。

在多线程应用程序中扩展此场景。我们可以确保没有其他人在使用我们现在的数据结构，因为我们都有自己的版本。

此外，我们可以通过使用我们从中复制的其他结构中的数据来节省空间。一个经典的例子是在列表的头部添加一个元素。如果我们有一个指向第二个元素的指针和一个指向第一个元素的指针，我们可以仅使用第一个元素的大小来引用这两个列表（见下文）。没有不变性，我们无法保证这一点。

```
 b__
           |  
a -> [6|] -+-> [5|] -> [4|] -> [3|] -> [2|] -> [1|x] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T21:29:16.483

看看 Haskell，它是一种纯函数式语言——它没有任何重新赋值，也没有其他副作用：为了进行 IO，在*[IO monad](http://www.haskell.org/haskellwiki/IO_inside#Welcome_to_the_RealWorld.2C_baby_:.29)*构造中，它实际上用一个新的实例替换了**RealWorld**例如，在控制台中显示新文本的世界。

# c# - 这是什么“var1 = Math.Ceiling(hours / (40.00M * 4.3M));”

> ID：353926
> 
> 赞同：1
> 
> 时间：2008-12-09T19:28:06.507
> 
> 标签：c#

有人知道 C#“M”语法是什么意思吗？

```
var1 = Math.Ceiling(hours / (40.00M * 4.3M)); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-09T19:31:19.217

这意味着数字是一种`decimal`类型。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-09T19:31:53.847

M 是小数的后缀。我认为代表“钱”。

[http://msdn.microsoft.com/en-us/library/364x0z75(VS.71).aspx](http://msdn.microsoft.com/en-us/library/364x0z75(VS.71).aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-09T19:32:44.017

40.00 的默认解释将是值为 40.00 的 double，就像 40 的默认解释是 int 一样。

如果您想要一个小数或长整数，则添加可以附加 M（十进制）和 L 后缀（长整数）。

# jasper-reports - JasperReports：子报表不使用 positionType='Float'

> ID：353928
> 
> 赞同：4
> 
> 时间：2008-12-09T19:28:50.797
> 
> 标签：jasper-reports

在这个例子中子报表重叠——我做错了什么？第二个应该“浮动”在第一个之下，它的 'y' 属性被忽略，但事实并非如此。

谢谢 ！！

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report name" pageWidth="595" pageHeight="842" columnWidth="535" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
    <parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
        <defaultValueExpression><![CDATA["C:\\reportFolder\\"]]></defaultValueExpression>
    </parameter>
    <background>
        <band/>
    </background>
    <detail>
        <band height="200">
            <subreport>
                <reportElement positionType="FixRelativeToTop" x="19" y="0" width="200" height="50"/>
                <dataSourceExpression><![CDATA[new net.sf.jasperreports.engine.JREmptyDataSource()]]></dataSourceExpression>
                <subreportExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_DIR} + "report1.jasper"]]></subreportExpression>
            </subreport>
            <subreport>
                <reportElement positionType="Float" mode="Transparent" x="19" y="20" width="200" height="50" backcolor="#FFFF66"/>
                <dataSourceExpression><![CDATA[new net.sf.jasperreports.engine.JREmptyDataSource()]]></dataSourceExpression>
                <subreportExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_DIR} + "report1.jasper"]]></subreportExpression>
            </subreport>
        </band>
    </detail>
</jasperReport> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-11T11:54:07.873

I got the answer! (I'm the one who asked, different IP I guess) According to the documentation, the floating element would have its y attribute ignored. I had taken that literally, tried arbitrary values for y and saw that everytime the element was placed at the specified position.

But no, you need to set y to position the element right below the previous one, **according to that element's declared y and height**, even though its actual height could be stretched when filled with data. In my sample code, the second subreport should have had y="50".

Furthermore, I see that the declared height of an element is taken as a minimum height. If the actual subreport is shorter than the height, the enclosing element won't be shrunk, so it would be a good idea to set the minimum expected height for elements that could be stretched.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-05T07:20:10.780

你是对的，但你需要更多。您需要从子报表中删除边距。

*   从菜单 -> 格式 -> 从菜单中删除报表边距

*   格式 -> 页面格式 -> 使页边距为 0

# asp.net - ASP.Net 服务器数量估计

> ID：353932
> 
> 赞同：0
> 
> 时间：2008-12-09T19:29:15.290
> 
> 标签：asp.net, performance-estimation, server-load

假设我们的平均页面权重为 P KBytes，并且我们每单位时间（比方说，每小时）有 N 次访问。我们如何估计在合理的响应时间内支持这种负载所需的服务器数量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T19:35:43.183

服务器性能有很多因素（CPU、RAM、I/O、缓存、本地或外部数据库、网络等），您甚至无法猜测给定项目所需的服务器数量。

我发现任何试图弄清楚这一点的人都走上了错误的道路，因为他们经常有一些不切实际的想法，即他们将使其变得非常受欢迎的网站。

我的建议是，只需构建您的应用程序并使用 1 台服务器，假设您可能需要一个服务器场，因此请根据此构建您的软件（这在 .NET 中几乎意味着您没有做任何不同的事情）。只有当你有实际需要时才购买更多的服务器，预期购买/租用服务器总是会导致浪费金钱，你不是亚马逊也不是谷歌，你不能准确地假设未来的扩张，直到你有当前的数据。

我想你会发现 1 台好的服务器速度惊人，可以处理很多用户。请记住 StackOverflow（我上次看到的）仅在 2 台服务器上运行；一个网络服务器和一个数据库服务器......就是这样。

# asp.net - ADO.NET 实体数据模型允许循环外键引用

> ID：353945
> 
> 赞同：1
> 
> 时间：2008-12-09T19:32:42.020
> 
> 标签：asp.net, entity-framework, dynamic-data

我在一个简单的数据库上使用新的 ADO.NET 实体数据模型。我有一个表/实体，它有一个主键 (PageID) 和一个 ParentID 外键，它在 PageID 上为父/子“0..1 到多”关系引用回自身。在 ASP.Net 页面上，我使用带有 asp:DynamicControl 的 FormView 将其表示为控件。除了一个关键细节外，该部分工作正常：当页面呈现时，可能的父项列表包括其自身，并且将项目设置为具有自身的父项不会导致错误并保存到数据库中。显然，分层对象不应该有自己的父对象，那么我该如何限制这种行为呢？

据我所知，我的选择是：

*   以某种方式更改`_`DynamicData FieldTemplates 中的 ForeignKey edit.ascx。这是有问题的，因为我看不到如何获取对当前实体*主*键的引用以将其从可能的*外*键选择中删除。另外，这可能会在键碰巧发生碰撞的情况下处理任何非分层 fkey refs 用法。

*   在页面上做一些 PreRender jiggery-pokery 尝试从渲染的 DropDownList 中删除 ListItem。这似乎不是正确的方法，因为它只为相关页面修复它。编辑：这就是我目前解决它的方式。

*   某种插入/更新触发器强制 ParentID 为空，如果它匹配自己。这不好，因为从用户的角度来看，它会默默地失败。

有没有人有更好的方法？另外，如果我需要提供更多细节，请告诉我。

-凯利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-17T21:06:58.467

我最终将层次结构移动到组装表，因为我必须存储的不仅仅是父/子关系。这样做还意味着我可以转储 DynamicData 控件并使用更直观的 TreeView 和拖放服务器端事件 (ComponentArt)。由于控件的性质，没有项目可以是它自己的父项，因此问题没有实际意义。哇，在我第一次使用 Entity Framework 时，7 个月是很长的时间了 :)

# sql - SQL 中多个字段的汇总查询

> ID：353948
> 
> 赞同：1
> 
> 时间：2008-12-09T19:32:47.077
> 
> 标签：sql, mysql, count

数据表结构为：
id1,id2,id3,id4,...（其他一些字段）。
我想创建摘要查询以找出每列中使用某个 ID 值的次数。

数据
1,2,3,4,2008
2,3,5,1,2008
1,3,2,5,2007
1,2,3,6,2007
3,1,2,5,2007

对于值 1，结果应为
1,0,0,1,2008
2,1,0,0,2007

如何通过一个查询（在 MySQL 中）完成此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T19:43:30.300

使用特征或 delta 函数：

```
DECLARE @look_for AS int
SET @look_for = 1

SELECT SUM(CASE WHEN id1 = @look_for THEN 1 ELSE 0 END) AS id1_count
    ,SUM(CASE WHEN id2 = @look_for THEN 1 ELSE 0 END) AS id2_count
    ,SUM(CASE WHEN id3 = @look_for THEN 1 ELSE 0 END) AS id3_count
    ,SUM(CASE WHEN id4 = @look_for THEN 1 ELSE 0 END) AS id4_count
FROM tbl 
```

有一些方法可以根据您的表和不同的 ID 值生成此代码（也是一种在 SQL Server 中使用 PIVOT 和 UNPIVOT 的技术，它不是 ANSI）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T20:22:42.483

这似乎是最好的解决方案（来自[Wiki](http://en.wikibooks.org/wiki/Programming:MySQL/Pivot_table)）：

```
select years,
sum(1*(1-abs(sign(id1-56)))) as id1,
sum(1*(1-abs(sign(id2-56)))) as id2,
sum(1*(1-abs(sign(id3-56)))) as id3,
sum(1*(1-abs(sign(id4-56)))) as id4,
from mytable
group by years 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T19:47:47.200

选择

（从 t1 中选择 count(id1)，其中 id1 = @param) 作为 id1，

(select count(id2) from t2 where id2 = @param) as id2

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-09T19:43:31.593

如果 X 是你正在寻找的 id 值，你会这样做。

```
select (select count(*) where id1 = X) as countid1 ... etc 
```

# asp.net - 通过 MSBUILD 设置 ASP.NET 版本

> ID：353953
> 
> 赞同：1
> 
> 时间：2008-12-09T19:36:54.570
> 
> 标签：asp.net, msbuild

我正在尝试通过 msbuild 在远程服务器上创建一个新网站（我喜欢将其称为“msdeploy”）。我已经下载并使用了 SDC 任务、MSBuildExtension 任务和 MSBuildCommunity 任务，但我根本无法正确使用。

我认为 WebDirectorySetting（来自 MSBuild.Community.Tasks.IIS）是我最好的选择，但我找不到正确的 SettingName 来传递。

我想使用某种 MSBuild 任务来完成此任务，但也许它根本不存在。自定义 VBS 或 WMI 是我最后的选择......

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-09-24T20:02:34.920

在 IIS7 上，您可以使用 MSBuild Extension Pack 做到这一点：

```
<MSBuild.ExtensionPack.Web.Iis7AppPool TaskAction="Create"
              Name="$(AppPool)"
              IdentityType="SpecificUser"                  
              PipelineMode="Integrated"
              ManagedRuntimeVersion="v4.0"
              PoolIdentity="$(UserName)"
              IdentityPassword="$(UserPassword)" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T21:23:05.480

我已经尝试做同样的事情一段时间，但最终意识到我们基本上使用 2.0 版本来处理所有事情，所以我在我部署到的机器上使用 aspnet_regiis 将其设为默认值。

如果您可以在远程服务器上运行 shell 命令，您可以使用带有 -sn 的 aspnet_regiis.exe 将特定的 asp.net 版本注册到应用程序。

[http://msdn.microsoft.com/en-us/library/k6h9cz8h(VS.80).aspx](http://msdn.microsoft.com/en-us/library/k6h9cz8h(VS.80).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T21:56:14.260

从带有 Exec 标记的 msbuild 任务中运行 aspnet_regiis 工具。它不像“干净”，但它有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T01:23:04.293

感谢您的回复。我玩弄了这两个建议，但都不是“完全”我想要的——即使它完成了工作。我也看不到我们会回到 1.1，所以我们最终将其设为默认值，但我仍然希望在某些任务上有一个神奇的设置可以做到这一点。

再次感谢

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-22T03:45:44.437

这一切都不像以下几行那样简单：

首先，创建网站目录：

```
<WebDirectoryCreate
    ServerName="$(DeployServerName)"        
    VirtualDirectoryName="MyVirualSiteName" /> 
```

其次，应用你想要的 ASP.NET 版本：

```
<InstallAspNet 
    Path="W3SVC/1/Root/MyVirualSiteName" 
    Version="Version20" /> 
```

尽我所能，

# javascript - 有没有办法在 jQuery 中执行“作用域”add()？

> ID：353959
> 
> 赞同：1
> 
> 时间：2008-12-09T19:39:36.110
> 
> 标签：javascript, jquery

主 jQuery 方法采用第二个可选参数来为搜索提供上下文。例如

```
$(".setA", ancestorOfSetsA); 
```

但是，jQuery`add()`方法不接受此上下文参数。我想要完成的是：

```
$(".setA", ancestorOfSetsA).add(".setB", ancestorOfSetsB); 
```

我正在通过一个会重载该`add()`方法的插件来尝试此操作，但我不知道如何将两个 jQuery 对象组合成一个 jQuery 对象。

我想找到一种方法来`add()`使用 jQuery 进行作用域，但是如果我能找到一种方法来合并到 jQuery 对象，我会自己写一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T20:53:49.517

您可以将 jQuery 集合传递到`add`选择器字符串中：

```
$(".setA", ancestorOfSetsA).add( $(".setB", ancestorOfSetsB) ); 
```

如果你想超载，`add`那么你需要小心支持它的所有行为。某人（您可能正在使用的插件）可能会这样做：

```
$( selector ).add('<div>new element</div>').appendTo( somethere ); 
```

**更新：**

这是 jQuery 中的当前添加函数，修改为采用上下文参数：

```
jQuery.fn.add = function( selector, context ) {
    return this.pushStack( jQuery.unique( jQuery.merge(
        this.get(),
        typeof selector == 'string' ?
            jQuery( selector, context ) :
            jQuery.makeArray( selector )
    )));
} 
```

# linq - 一个关于 Linq To Sql 的新手问题

> ID：353963
> 
> 赞同：1
> 
> 时间：2008-12-09T19:40:27.327
> 
> 标签：linq, linq-to-sql

当我手动执行此操作时

```
public class AdventureWorks : DataContext
{
    public AdventureWorks(string connection) : base(connection) { }
    public Table<Contact> Contacts;
}

[Table(Name = "Person.Contact")]
public class Contact
{

    [Column(DbType = "int not null", IsPrimaryKey = true, IsDbGenerated = true)]
    public int ContactID;

    [Column(DbType = "nvarchar(8) not null")]
    public string Title;

    [Column(DbType = "nvarchar(50) not null")]
    public string FirstName;

    [Column(DbType = "nvarchar(50) not null")]
    public string MiddleName;

    [Column(DbType = "nvarchar(50) not null")]
    public string LastName;

    [Column(DbType = "nvarchar(50) not null")]
    public string EmailAddress;

    [Column(DbType = "int")]
    public int EmailPromotion;

    [Column(DbType = "bit")]
    public byte NameStyle;

    [Column(DbType = "varchar(40)")]
    public string PasswordHash;

    [Column(DbType = "varchar(40)")]
    public string PasswordSalt;

} 
```

我可以使用这样的东西

```
AdventureWorks db = new AdventureWorks("Integrated Security=sspi");
Contact cont = db.Contacts.Single(c => c.ContactID == 1280); 
```

但是如果我依靠LINQ表面（设计师），在dbml文件上拖放联系人表，我可以看到db.Contacts，但看不到“db.Contacts.Single”方法。

与 dbml 属性配置有什么关系？

请指教。

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T19:46:22.213

你在“使用”这两个命名空间吗？

```
using System.Data.Linq;
using System.Linq; 
```

# .net - Understanding .NET's "SecurityAction" parameter for permissions

> ID：353968
> 
> 赞同：6
> 
> 时间：2008-12-09T19:42:40.660
> 
> 标签：.net, security, permissions

Can anyone explain the meaning of and purposes of the values for the SecurityAction enum?

The MSDN page is not terribly clear. It says LinkDemand occurs at just-in-time compilation whereas Demand occurs at runtime.

Why the distinction and in what situations would I use LinkDemand as opposed to Demand?

Likewise, what are the use cases of the other interesting values like InheritenceDemand, Assert and PermitOnly.

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-09T21:56:38.970

LinkDemand basically requires the calling code to have the specified permission. Demand, on the other hand, requires not only the calling code to have the specified permission, but also the code that called the calling code, and the code that called that, and so on, all the way up the stack (or until an Assert is found; see below).

LinkDemand can be enforced at JIT compile time, because if the JIT compiler hits a statement that calls a method with a LinkDemand, it can determine immediately if the calling code has the permission or not. Demand has to be enforced at runtime every time a call is made to the method, because it is not possible at compile time to know what will be on the stack during any given call. As such, LinkDemand is much more efficient. However, the tradeoff for that efficiency is less security. With LinkDemand, you are trusting that the calling code is not going to let ITS calling code (which may or may not have the permission) use it for nefarious purposes. (In other words, you are trusting that there are no security holes in the calling code that its callers can exploit to gain access indirectly to the method with the LinkDemand.) With Demand, you know that everybody on the stack absolutely has permission (at least up until an Assert is found), so there is no risk from untrusted callers.

Assert is basically a short-circuit for Demand. The security checking that happens with Demand stops if a caller on the stack has an active Assert (in other words, only the callers in the stack up to the Assert have to have the permission). So, like LinkDemand, you have to trust that the code with the Assert cannot be exploited by its callers.

Deny is also a short-circuit for Demand, but instead of asserting a permission it cancels out a permission that a caller might have. You would use this to help prevent possible security holes by ensuring that no extraneous permissions are in effect during a call that might be exploitable.

PermitOnly is like Deny, except instead of denying a specific permission it denies every permission EXCEPT the one specified.

InheritanceDemand, unlike the others, is not directly related to method calls, but says that a class that does not have the permission cannot inherit from the class with the InheritanceDemand. This could be used, for instance, to stop untrusted code from gaining access to protected members of the class that would otherwise be accessible to descendant classes.

# web-services - 如果标准支持 SOAP 信封有什么好处

> ID：353982
> 
> 赞同：1
> 
> 时间：2008-12-09T19:46:24.507
> 
> 标签：web-services, soap

[因为我读到WS-Discovery](http://en.wikipedia.org/wiki/WS-Discovery)的优点之一是它“支持 SOAP 1.1 和 SOAP 1.2 信封”，那又如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T10:28:14.990

我想我终于找到了我的问题的答案，如果一个标准支持 SOAP 信封，这使它受益于所有 SOAP 优势。喜欢在不同的操作系统上运行，使用不同的技术和编程语言，以及使用大量可用于 SOAP 的开发工具

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-01T09:10:50.823

在两种不同的 SOAP 标准下生成的消息之间存在一些细微的差异 - 两者都受支持的事实增加了能够与在不同工具堆栈/平台上创建的服务进行互操作的机会

# svn - svn:ignore 的模式匹配字符

> ID：353992
> 
> 赞同：6
> 
> 时间：2008-12-09T19:49:18.510
> 
> 标签：svn

回应网络上的一个问题：

> svn:ignore 模式的语法是否记录在某处？我可以在 SVN 书籍中的“svn:ignore”下找到的唯一模式匹配字符是“*”。

[颠覆书：'svn:ignore'](http://svnbook.red-bean.com/en/1.0/ch07s02.html#svn-ch-7-sect-2.3.3)

特别是我想匹配一个 32 个字符的字符串（md5 哈希命名目录）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-09T20:05:29.270

它似乎记录[在这里](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.advanced.props.special.ignore)。

编辑：......并回答您的具体问题，您可以使用“？” 匹配单个字符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T20:17:26.330

从我在您链接的页面和[通过 cvsignore](http://www.cvsnt.org/manual/html/cvsignore.html "通过 cvsignore 忽略文件")页面忽略文件中看到的内容来看，它似乎只理解 glob 语法，即。* 对于任何字符串和 ? 为一个字符。

如果您需要匹配 32 个字符的字符串，可能的解决方案可能是放置 32 ? 一起签...**********